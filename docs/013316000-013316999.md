# StackOverflow 问答 13316000-13316999

# r - 根据缺失的变量数计算观测值

> ID：13316002
> 
> 赞同：2
> 
> 时间：2012-11-09T21:04:16.487
> 
> 标签：r

我想根据缺少的变量数来计算数据框的行数。因此，例如在下面的数据框中，我希望代码返回列表：

```
3, 5, 1, 1, 0 
```

因为有 3 行没有缺失变量，5 行有 1 个缺失变量，1 行有 2 个缺失变量，1 行有 3 个缺失变量，0 行有 4 个缺失变量：

```
 v1 v2 v3 v4
1   1  1  1  1
2  NA NA  1  1
3   1  1 NA  1
4   1  1  1  1
5  NA  1  1  1
6  NA  1  1  1
7   1  1  1 NA
8  NA  1  1  1
9   1  1  1  1
10  1 NA NA NA 
```

这是可以在 R 中加载的示例数据：

```
dt <- structure(list(v1 = c(1, NA, 1, 1, NA, NA, 1, NA, 1, 1), v2 = c(1, NA, 1, 1, 1, 1, 1, 1, 1, NA), v3 = c(1, 1, NA, 1, 1, 1, 1, 1, 1, NA), v4 = c(1, 1, 1, 1, 1, 1, NA, 1, 1, NA)), .Names = c("v1", "v2", "v3", "v4"), row.names = c(NA, -10L), class = "data.frame") 
```

我已经可以通过逐行循环遍历数据帧并增加缺少变量数量的计数器来做到这一点，但是在大数据帧上它非常慢所以我希望有一种巧妙的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:08:54.630

```
table(rowSums(is.na(dt)))
#0 1 2 3 
#3 5 1 1 
```

如果你真的需要最后一个 0（四个`NA`s）：

```
tabulate(factor(rowSums(is.na(dt))), nbins = ncol(dt)+1)
#[1] 3 5 1 1 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-26T13:20:08.667

这样做的一种更潮的方式是：

```
library(tidyverse)

dt <- structure(list(v1 = c(1, NA, 1 , 1, NA, NA, 1 , NA, 1, 1 ), 
                     v2 = c(1, NA, 1 , 1, 1 , 1 , 1 , 1 , 1, NA), 
                     v3 = c(1, 1 , NA, 1, 1 , 1 , 1 , 1 , 1, NA), 
                     v4 = c(1, 1 , 1 , 1, 1 ,  1, NA, 1 , 1, NA)
                     ),
                 .Names = c("v1", "v2", "v3", "v4"), row.names = c(NA, -10L), class = "data.frame")

dt <- as_tibble(dt) 
```

使用 drop_na()，tidyverse-y 的方式

```
dt %>% 
  drop_na() 
```

使用“stats”包仅过滤“完整案例/行”

```
dt %>% 
  filter(complete.cases(v1, v2, v3, v4)) 
```

使用“na.omit”（不是 tidyverse 函数）

```
dt %>% 
  na.omit() 
```

# syntax - PHP Parse 错误：语法错误，意外的 T_IF

> ID：13316003
> 
> 赞同：0
> 
> 时间：2012-11-09T21:04:24.750
> 
> 标签：syntax, if-statement, php

我查看了许多其他问题，但我无法在其中找到自己的答案。这是我的语法错误（意外的 T_IF）：

```
while(($rij1 = mysql_fetch_object($result1))
and( if ($voornaam=NULL) {
            $rij2 = ' ';}
elseif($voornaam!=NULL){
            $rij2 = mysql_fetch_object($result2);}) 
```

我查看了语法之前的那行，但找不到问题所在……有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:06:34.773

尝试将您的代码重写为：

```
while ($rij1 = mysql_fetch_object($result1))
{
    if ($voornaam === NULL) 
    {
        $rij2 = ' ';
    } 
    else
    {
        $rij2 = mysql_fetch_object($result2);
    }
} 
```

编辑：在第一个中更正了你的条件`if`，因为@andrewsi 发现 -`=`是一个赋值运算符，所以之前你的代码正在更改`$voornaam`为`NULL`，然后检查结果是否评估为`true`（当然，它永远不会 - 所以第二个块总是执行）

在您的原始代码中，您正在使用该`and`运算符 - 大概已经看到它在一些含义良好但编码不佳的示例中使用，例如`mysql_connect(...) or die('an error occurred');`.

该示例中发生的情况是第一个语句的结果 - `mysql_connect()`- 被检查。如果它的计算结果为真，则第二条语句永远不会执行，但如果它的计算结果为假，那么第二条语句 - `die('an error occurred');`- 将被执行。正如您刚刚发现的那样，这种模式令人困惑，最好避免。

# css - 剪切背景以露出下面的图层

> ID：13316013
> 
> 赞同：2
> 
> 时间：2012-11-09T21:05:07.597
> 
> 标签：css, webkit

有没有办法剪切 div 背景以暴露下面的图层？，就像这样：

![在此处输入图像描述](../Images/60b14370316c0c262bbe19109d3deaa5.png)

对此：

![在此处输入图像描述](../Images/16d1a80192b29eeef92845041b3ce916.png)

欢迎任何最前沿的 CSS 规则！

**更新**

好的，我做了一个示例代码：http: [//jsfiddle.net/coma/9ae7g/1/](http://jsfiddle.net/coma/9ae7g/1/)

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Menu</title>
        <style type="text/css">
            @charset 'UTF-8';

            body {
                padding: 0;
                margin: 0;
                font-family: "Lucida Grande", "Lucida Sans Unicode", Tahoma, Verdana, Arial, sans-serif;
                font-size: 12px;
                background: #fff url("http://colourlovers.com.s3.amazonaws.com/images/patterns/1762/1762793.png?1314797062");
            }

            a {
                text-decoration: none;
            }

            #menu {
                position: fixed;
                top: 0;
                left: 0;
                bottom: 0;
                width: 250px;
            }

            body.wide>#menu {
                width: 0;
            }

            #menu * {
                line-height: 1em;
            }

            #menu:after {
                content: '';
                position: absolute;
                top: 0;
                right: 0;
                width: 5px;
                height: 100%;
                border-right: 1px solid #666;
                pointer-events: none;
                background: -moz-linear-gradient(left,  rgba(0,0,0,0) 0%, rgba(0,0,0,0.25) 100%);
                background: -webkit-linear-gradient(left,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.25) 100%);
                background: -o-linear-gradient(left,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.25) 100%);
                background: -ms-linear-gradient(left,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.25) 100%);
                background: linear-gradient(to right,  rgba(0,0,0,0) 0%,rgba(0,0,0,0.25) 100%);
            }

            #menu ul, #menu li {
                padding: 0;
                margin: 0;
                list-style: none;
                background-color: #fafafb;
            }

            #menu li {
                position: relative;
            }

            #menu>a {
                position: absolute;
                left: 100%;
                top: 50%;
                z-index: 1;
                display: block;
                width: 10px;
                height: 20px;
                margin: -10px 0 0 0;
                text-indent: -100em;
                overflow: hidden;
                border-radius: 0 2px 2px 0;
                background-color: #666;
                transition: background-color .3s ease-out;
                -moz-transition: background-color .3s ease-out;
                -webkit-transition: background-color .3s ease-out;
                -o-transition: background-color .3s ease-out;
                -ms-transition: background-color .3s ease-out;
            }

            #menu>a:before {
                position: absolute;
                top: 5px;
                right: 4px;
                display: block;
                content: '';
                border-width: 5px 6px 5px 0;
                border-style: solid;
                border-color: transparent #fff transparent transparent;
            }

            body.wide>#menu>a:before {
                right: 2px;
                border-width: 5px 0 5px 6px;
                border-color: transparent transparent transparent #fff;
            }

            #menu>ul {
                height: 100%;
                background-color: #888;
                overflow: hidden;
            }

            #menu>ul span, #menu>ul a {
                display: block;
                padding: .4em;
                color: #666;
                font-weight: bold;
                border-bottom: 1px solid #999;
            }

            #menu>ul a {
                border-top: 1px solid #fff;
                border-bottom: 1px solid #e9ecee;
            }

            #menu>ul>li>span {
                font-size: 1.25em;
                font-weight: bold;
                color: #666;
                text-shadow: 0 1px 1px #fff;
                background-color: #eee;
                background-image: -moz-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
                background-image: -webkit-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
                background-image: -o-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
                background-image: -ms-linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
                background-image: linear-gradient(top, rgba(0,0,0,0) 0%, rgba(0,0,0,0.2) 100%);
                cursor: pointer;
                transition: background-color .4s;
                -moz-transition: background-color .4s;
                -webkit-transition: background-color .4s;
                -o-transition: background-color .4s;
                -ms-transition: background-color .4s;
            }

            #menu>ul>li>span:hover {
                background-color: #fff;
            }

            #menu>ul>li>ul {
                display: none;
            }

            #menu>ul>li.opened>ul, #menu>ul>li.current_ancestor>ul {
                display: block;
            }

            #menu>ul>li>ul>li>a {
                font-size: 1.2em;
                color: #4183c4;
                transition: background-color .4s;
                -moz-transition: background-color .4s;
                -webkit-transition: background-color .4s;
                -o-transition: background-color .4s;
                -ms-transition: background-color .4s;
            }

            #menu>ul>li>ul>li.current>a, #menu>ul>li>ul>li.current>a:hover {
                color: #fff;
                background-color: #39f;
                border-color: #39f;
            }

            #menu>ul>li>ul>li.current:after {
                content: '';
                position: absolute;
                right: -1px;
                top: 50%;
                margin: -9px 0 0 0;
                display: block;
                border-width: 10px 10px 10px 0;
                border-style: solid;
                border-color: transparent #fff transparent transparent;
                z-index: 1;
            }

            #menu>ul>li>ul>li>a:hover {
                background: #fff;
            }

            #menu>ul>li>ul>li:last-child {
                border-bottom: 1px solid #aaa;
            }

            #menu>ul>li>ul>li[data-count]:after {
                position: absolute;
                top: 50%;
                right: 14px;
                display: block;
                content: attr(data-count);
                padding: .26em .5em;
                background-color: #fff;
                border-radius: 8px;
                font-size: 12px;
                margin: -9px 0 0 0;
                color: #777;
                border-top: 1px solid #ccc;
            }

            #section {
                height: 2000px;
            }
        </style>
    </head>
    <body>      
        <div id="menu">
            <a title="cerrar o abrir el menú" href="#">toggle</a>
            <ul>
                <li class="first opened">
                    <span>Usuario</span>
                    <ul class="menu_level_1">
                        <li class="first">
                            <a href="/logout">Logout</a>
                        </li>
                        <li class="current">
                            <a href="/">Home</a>
                        </li>
                        <li>
                            <a href="/user/">Usuarios</a>
                        </li>
                        <li class="last">
                            <a href="/discount/">Descuentos</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <span>Artistas</span>
                    <ul class="menu_level_1">
                        <li class="first">
                            <a href="/artist/">Artistas</a>
                        </li>
                        <li class="last">
                            <a href="/artists/top10">Top 10 (3)</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <span>Obras</span>
                    <ul class="menu_level_1">
                        <li class="first">
                            <a href="/artwork/">Obras</a>
                        </li>
                        <li>
                            <a href="/artworks/destacadas">Destacadas (4)</a>
                        </li>
                        <li class="last">
                            <a href="/artworks/ofertas">Ofertas (3)</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <span>Pedidos</span>
                    <ul class="menu_level_1">
                        <li class="first last">
                            <a href="/order/">Pedidos</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <span>Blog</span>
                    <ul class="menu_level_1">
                        <li class="first">
                            <a href="/article/">Artículos</a>
                        </li>
                        <li class="last">
                            <a href="/category/">Categorías</a>
                        </li>
                    </ul>
                </li>
                <li class="last">
                    <span>Newsletter</span>
                    <ul class="menu_level_1">
                        <li class="first last">
                            <a href="/newsletter/">Emails</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="section"></div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {

                var style = {
                    opened: 'opened',
                    wide: 'wide',
                    currentAncestor: 'current_ancestor'
                };

                var menu = $('#menu');
                var items = $('#menu>ul>li');
                var body = $('body');

                items.filter('.' + style.currentAncestor)
                .removeClass(style.currentAncestor)
                .first()
                .addClass(style.opened);

                items.children('span').click(function(event) {

                    event.preventDefault();

                    var group = $(this).parent();

                    if(!group.hasClass(style.opened)) {

                        items.filter('.' + style.opened).removeClass(style.opened);
                        group.addClass(style.opened);

                    }

                });

                menu.children('a').click(function(event) {

                    event.preventDefault();

                    body.toggleClass(style.wide);

                });

            });
        </script>
    </body>
</html> 
```

小鸟背景和高度为 2000px 的#section 仅用于通过移动内容进行测试。

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:03:57.723

如果一个元素及其所有子元素都是透明的（否`background-color`，否`background-image`），则该元素将是透明的。

为了完成您的要求，这就是我要做的：

1.  避免在该组元素的容器上设置背景样式。
2.  通过单个图像对这些单独的导航元素进行所有背景样式设置，即使您必须对其进行剪辑以使其具有灵活性。
3.  对于活动导航元素，将背景图像交换为具有所需透明缩进的背景图像。

请参阅此 JSFiddle，从您的代码中分叉：http: [//jsfiddle.net/2XSd5/](http://jsfiddle.net/2XSd5/)。这演示了我描述的方法：使所有背景透明，并使用背景图像进行剪切。这是我修改的代码：

```
#menu:after { background: none; }

#menu > ul > li > ul > li.current:after { content: none; }

#menu ul, #menu li { background-color: transparent; }

#menu > ul { background-color: transparent; }

#menu > ul > li > ul > li > a, #menu > ul > li > ul > li > a {
    background-color: white;
    }

#menu > ul > li > ul > li.current > a, #menu > ul > li > ul > li.current > a:hover {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAAyCAYAAADm1uYqAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAV5JREFUeNrs21FKw0AUQNEZcQluR91EVXSFQnUN1f3oEjROSwQrcYyl4HvhHHjQhHzl4yZtZ+rQFIAETtwCQLAABAsQLADBAhAsQLAABAtAsADBAhAsAMECFh+sYRyAFMEqogVEd9qmjp+r2wEE9DIVLICIsbr6GiyAyLF6+jzhX0IgRawEC0gTK8ECIsbqeipWggVE8tqLlWABkWJ10+a5d5FgARFidTvGqrvzRrCA/3bXZtPm/bcLrcNavu3Tqv5wfMh2LAuNOba3MnOLoDes3CGaM6VzLExEcN/mfM4DVLDyxukvb0K17O8ZnTOlcx6O6azNeoyWYC1APWDKRGQEh8jRemxzIVjAIqIlWECaaAkWEDVal4IFZInWw/do1aFxb4CgtpuhV4IFZIrWjpXuQIavhzt+wwLSECxAsAAECxAsAMECECxAsAAEC0CwAMECECwAwQIECyCEDwEGAGnvSNs6OT13AAAAAElFTkSuQmCC) right center no-repeat;
    color: grey;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T06:59:21.087

将Z-index添加到右侧菜单，然后它就可以工作了

# sql - 选择三个字符长度的纯字母字符串

> ID：13316016
> 
> 赞同：2
> 
> 时间：2012-11-09T21:05:19.137
> 
> 标签：sql, regex, database, oracle

我的表中有一个字段是 varchar，包含字母、数字和混合字母数字值。

我只想从该字段中选择长度为 3 个字符且仅按字母顺序排列的值。

我正在使用甲骨文。

样本数据：

```
AAA
BBB
12345
CCC25
DDDDD 
```

选择语句应该只返回：

```
AAA
BBB 
```

我尝试了以下方法，但没有成功。这没有返回任何东西。

```
select name from MyTable where name like '[a-Z][a-Z][a-Z]'; 
```

然后我尝试了以下想法，它会返回所有 3 个字符的长结果，它只返回所有内容：

```
select name from MyTable where name like '%%%'; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T21:09:32.043

您可以使用该`regexp_like`功能

```
SQL> with x as (
  2    select 'aaa' str from dual union all
  3    select 'bbb' from dual union all
  4    select '12345' from dual union all
  5    select 'CCC25' from dual union all
  6    select 'DDDDD' from dual
  7  )
  8  select *
  9    from x
 10   where regexp_like( str, '^[[:alpha:]]{3}$' );

STR
-----
aaa
bbb 
```

# c - C 创建文件路径

> ID：13316021
> 
> 赞同：-2
> 
> 时间：2012-11-09T21:05:54.820
> 
> 标签：c, arrays, fopen, filepath

我有这个目录树：

```
xy@xy:/test# find .
.
./2
./2/Asd
./2/Asd/qwe
./2/Asd/qwe/txt.txt
./1 
```

在“test”文件夹中可以有更多的目录，如 4、5、6，但 asd、Asd、ASD、qwe、Qwe、QWE 是不变的。目的是计算所有可能的路径，如下所示：

```
/test/1/ASD/QWE/txt.txt
/test/2/asd/qwe/txt.txt
/test/2/Asd/Qwe/txt.txt 
```

然后读取文件（txt.txt）

我创建了（复制并粘贴在一起......）以下内容，它正在工作一段时间。我标记了我有问题的行。

```
#include <stdio.h>
#include <string.h>
#include <dirent.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <time.h>
#include <stdlib.h>

char *filetosearch="txt.txt";
char *test="/test/";
char *slash="/";
char *directory[3][3] = {{"asd", "Asd", "ASD"}, {"qwe","Qwe","QWE"}};
int dircounter1=0;
int dircounter2=0;
FILE *filetosf;
char **dirpatharr=NULL;
int dirpathcount=0;
char **hdarr=NULL;
int hdarrcount=0;
char **fullpath=NULL;
int count,size;
char *dirname;
DIR  *d;
struct dirent *dir;
int main(void)
{
    d = opendir(test);
    if (d)
    {
        while ((dir = readdir(d)) != NULL)
        {
            if( dir->d_type==DT_DIR )
            {
                dirname=dir->d_name;
                if((strcmp( dirname, ".." ) == 0) || (strcmp( dirname, "." ) == 0) )
                {
                }
                else
                {
                    hdarr=(char **)realloc(hdarr,(hdarrcount+1)*sizeof(dirname));
                    hdarr[hdarrcount]=dirname;
                    hdarrcount++;
                }
            }
            else
            {
            }
        }
    }

    closedir(d);

    for (count=0; count<hdarrcount; count++ )
    {
        for (dircounter1 = 0; dircounter1 < 3; dircounter1++ )
        {
            for (dircounter2 = 0; dircounter2 < 3; dircounter2++ )
            {
                fullpath = malloc ( strlen(test) + strlen(hdarr[count]) + strlen(slash) + strlen(directory[0][dircounter2]) + strlen(slash) + strlen(directory[1][dircounter1]) + strlen(slash) + strlen(filetosearch)+1);
                strcpy (fullpath,test);
                strcat (fullpath,hdarr[count]);
                strcat (fullpath,slash);
                strcat (fullpath,directory[0][dircounter2]);
                strcat (fullpath,slash);
                strcat (fullpath,directory[1][dircounter1]);
                strcat (fullpath,slash);
                strcat (fullpath,filetosearch);

                printf("fullpath:%s\n",fullpath);
                //    filetosf = fopen(fullpath,"r");  //THIS WILL BE THE PROBLEM!!!!

                if (filetosf){
                    fseek (filetosf, 0L, SEEK_END);
                    size=ftell(filetosf);
                    fclose(fullpath);
                    printf("file exist:%s\n",fullpath);
                }
                free (fullpath);
            }
        }
    }
} 
```

- - - -剪这里 - - - - - - - - - -

它有这个输出（就像我想要的那样）：

```
fullpath:/test/2/asd/qwe/txt.txt
fullpath:/test/2/Asd/qwe/txt.txt
fullpath:/test/2/ASD/qwe/txt.txt
fullpath:/test/2/asd/Qwe/txt.txt
fullpath:/test/2/Asd/Qwe/txt.txt
fullpath:/test/2/ASD/Qwe/txt.txt
fullpath:/test/2/asd/QWE/txt.txt
fullpath:/test/2/Asd/QWE/txt.txt
fullpath:/test/2/ASD/QWE/txt.txt
fullpath:/test/1/asd/qwe/txt.txt
fullpath:/test/1/Asd/qwe/txt.txt
fullpath:/test/1/ASD/qwe/txt.txt
fullpath:/test/1/asd/Qwe/txt.txt
fullpath:/test/1/Asd/Qwe/txt.txt
fullpath:/test/1/ASD/Qwe/txt.txt
fullpath:/test/1/asd/QWE/txt.txt
fullpath:/test/1/Asd/QWE/txt.txt
fullpath:/test/1/ASD/QWE/txt.txt 
```

但是当我删除备注符号并激活文件打开部分`filetosf = fopen(fullpath,"r");` 时，我无法读取文件。当我检查输出时，我得到了这个：

```
fullpath:/test/2/asd/qwe/txt.txt
fullpath:/test//Asd/qwe/txt.txt
fullpath:/test//ASD/qwe/txt.txt
fullpath:/test//asd/Qwe/txt.txt
fullpath:/test//Asd/Qwe/txt.txt
fullpath:/test//ASD/Qwe/txt.txt
fullpath:/test//asd/QWE/txt.txt
fullpath:/test//Asd/QWE/txt.txt
fullpath:/test//ASD/QWE/txt.txt
fullpath:/test//asd/qwe/txt.txt
fullpath:/test//Asd/qwe/txt.txt
fullpath:/test//ASD/qwe/txt.txt
fullpath:/test//asd/Qwe/txt.txt
fullpath:/test//ASD/Qwe/txt.txt
fullpath:/test//asd/QWE/txt.txt
fullpath:/test//Asd/QWE/txt.txt
fullpath:/test//ASD/QWE/txt.txt 
```

如果我在推荐之前打印出这些行，甚至会发生这种情况`fopen`。为什么会这样？

我不是一个经验丰富的程序员，所以请尽量简单地解释一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:29:59.657

在这段代码中的*许多*奇怪之处中，明显的直接错误是：

```
fullpath = malloc ( strlen(test) + strlen(hdarr[count]) + strlen(slash) + strlen(directory[0][dircounter2]) + strlen(slash) + strlen(directory[1][dircounter1]) + strlen(slash) + strlen(filetosearch)+1); 
```

然后是一堆字符串副本，例如：

```
strcpy (fullpath,test); 
```

注意：`fullpath`声明如下：

```
char **fullpath = NULL; 
```

其中声明了一个指向字符指针的指针；**不是**指向字符的指针。尝试打开警告，然后在正确声明此变量后重新检查使用此变量的每个地方：

```
char *fullpath = NULL; 
```

* * *

接下来，您*保存*（我松散地使用该术语）您正在构建的目录名称：

```
dirname=dir->d_name;
...
hdarr[hdarrcount]=dirname; 
```

但这只是将 d_name 地址保存到 hdarr 动态数组中的新插槽中。一旦您再次调用 readdir()（或 closedir()），该地址就无效了。从`readdir()`文档中：

“ **readdir() 返回的数据可能会被后续对同一目录流的 readdir() 调用覆盖。** ”

因此，您存储的所有这些指针都在实现拥有的内存中，它可以在任何时候/以任何方式认为合适的时候完全自由地爆炸。如果你想保留它们，你需要制作它们的副本（当然，当你完成时 free() 这些副本）。

如何解决此问题：

我通常不推荐这个，但在你的情况下，我会：在目录名上使用 strdup() 。这是一个穷人“为我分配一个大小与该缓冲区相同的字符串缓冲区，包括空项的空间，复制字符串，并将指针返回给我。所以你的代码将如下所示：

```
else
{
    char **pp = realloc(hdarr,(hdarrcount+1)*sizeof(*pp));
    if (pp)
    {
        hdaerr = pp;
        hdarr[hdarrcount++] = strdup(dir->d_name);
    }
    else
    {   // panic ensues
        exit(EXIT_FAILURE);
    }
} 
```

不要忘记正确释放它。hdarr 中的每个字符串指针都是动态分配的。确保释放它们，然后释放阵列本身。代码的尾部（就在退出之前）应如下所示：

```
for (i=0;i<hdarrcount;i++)
    free(hdarr[i]);
free(hdarr); 
```

* * *

次要但重要：

**永远**不要这样做：

```
hdarr=(char **)realloc(hdarr,(hdarrcount+1)*sizeof(dirname)); 
```

如果`realloc()`失败，它将返回 NULL 并且您只是丢失（并因此泄漏）您是原始数据指针。改为这样做：

```
char **pp = realloc(hdarr,(hdarrcount+1)*sizeof(*pp));
if (pp)
{
    hdaerr = pp;
    // .. continue with the rest of your assignment code
}
else
{   // allocation error, but at least you still have the 
    // old hdaerr so you can free it.
} 
```

* * *

接下来，正如其他人指出的那样：

```
fclose(fullpath); 
```

这是完全错误的。`fclose()`期望 a `FILE *`，而不是 char **。将您之前打开的 filetosf 传递给它（通过打开，我的意思是在取消注释您当前取出的问题行之后。一旦您这样做了：

```
fclose(filetosf); 
```

注意：在您这样做之前，通过 fclose() 代码行注释掉**所有**fopen。因为他们击中 NULL 文件指针是再一次与我们说它... **undefined**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:09:42.303

这是错误的：

```
fclose(fullpath); 
```

# mvvm - Knockoutjs--调用 valueHasMutated 太频繁？

> ID：13316034
> 
> 赞同：2
> 
> 时间：2012-11-09T21:06:42.113
> 
> 标签：mvvm, knockout.js

因此，我的应用程序中有一个页面，它使用相当标准的嵌套模型实现，符合标准 Customer -> Order -> OrderLineItems 类型。对我而言，不同之处在于 OrderLineItems 的模型非常复杂。

在我的代码中，无论是可观察数组还是可观察对象，为了正确更新我的视图，我发现我经常调用“myObservable.valueHasMutated()”。

不得不手动执行此操作并不像应有的那样，这是一种直觉 - 但我不确定在哪里查看可能需要更改的内容。所以有几个问题：

1.  这对于“深/大”模型来说是正常的吗？
2.  我可能会寻找一些明显的东西来解决这个问题吗？
3.  网络上是否有使用 KO 实现的复杂模型的示例？

我的视图模型中的一个示例：

```
self.projectsVisible = ko.observable(false);
self.toggleProjectVisibility = function () {
    self.projectsVisible(!self.projectsVisible());
    self.projectsVisible.valueHasMutated();
}; 
```

这与按钮元素和 DIV 相关联：

```
<div data-bind="visible: projectsVisible">
    <table>
        <thead data-bind="template: {name: 'projectHeader'}"></thead>
        <tbody data-bind="template: {name: 'project', foreach: projects}"></tbody>
    </table>
</div>
<button type="button" data-bind="click: toggleProjectVisibility">
  Toggle Projects On/Off
</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-01T21:49:46.107

我`valueHasMutated`主要用于 observableArray 的变化。

在您的示例中，`self.projectsVisible(!self.projectsVisible());`已经通知订阅者，因为该值总是在变化。因此，呼叫`valueHasMutated`会再次通知订阅者相同的值更改。

你可以检查这个小提琴：http: [//jsfiddle.net/5RU7n/](http://jsfiddle.net/5RU7n/)

`write`如果即使值保持不变，您也想通知订阅者对可观察对象的操作，您可以使用`.extend({ notify: 'always' })`扩展器（请参阅[http://knockoutjs.com/documentation/observables.html](http://knockoutjs.com/documentation/observables.html)）。

最后，我认为你可以尝试列举你调用的情况`valueHasMutated`，你最终可能会发现自己多余的调用。

# jquery - Div 未在 FireFox 中正确定位

> ID：13316037
> 
> 赞同：0
> 
> 时间：2012-11-09T21:06:53.700
> 
> 标签：jquery, css, firefox, html

我在定位`div`. 这是`div`：

```
<div class="facebookHoverDiv" style="position: absolute; top: 0; left: 0; z-index: 15000; display: none">
<div class="calendar-hover-top"></div>
<div class="calendar-hover-middle">
    <div class="post-image"></div>
    <div class="facebook-icon">Facebook</div>
    <div class="post-content"><span id="facebook-text">content</span>
        <div class="post-date">This will be the date.</div>
    </div>
</div>
<div class="calendar-hover-bottom"></div>
</div>

<div class="twitterHoverDiv" style="position: absolute; top: 0; left: 0; z-index: 15000; display: none">
<div class="calendar-hover-top"></div>
<div class="calendar-hover-middle">
    <div class="twitter-icon">Twitter</div>
    <div class="post-content"><span id="twitter-text">content</span>
        <div class="post-date">This will be the date.</div>
    </div>
</div>
<div class="calendar-hover-bottom"></div>
</div> 
```

我正在使用以下 jQuery 函数来显示工具提示：

```
 function ShowToolTip(event, postType, postMessage, scheduleDate, customPostId, postId) {
        if (postType == 'Twitter') {
            $('.twitterHoverDiv .post-content #twitter-text').text(postMessage);
            $('.twitterHoverDiv .post-content .post-date').text(scheduleDate);
            $('.twitterHoverDiv').css("left", event.x - 65);
            $('.twitterHoverDiv').css("top", event.y - $('.twitterHoverDiv').height());

            $('.facebookHoverDiv').hide();
            $('.twitterHoverDiv').show();
        } else {
            $('.facebookHoverDiv .post-content #facebook-text').text(postMessage);
            var url = "http://host.mmm.dev.webedge.mcmurry.com/Media/Image.ashx?articleid=" + postId + "&custompostid=" + customPostId;
            //url = url.replace("undefined", "0");
            $('.facebookHoverDiv .post-image').css("background-image", "url('" + url + "')");
            $('.facebookHoverDiv .post-image').css("background-size", "100%");
            $('.facebookHoverDiv .post-content .post-date').text(scheduleDate);
            $('.facebookHoverDiv').css("left", event.x - 65);
            $('.facebookHoverDiv').css("top", event.y - $('.facebookHoverDiv').height());

            $('.twitterHoverDiv').hide();
            $('.facebookHoverDiv').show();
        }
    } 
```

如果我在 Google Chrome 中运行它，它会完美运行。但是，如果我在 FireFox 中运行它，工具提示会显示在屏幕的左上角。问题似乎出`$('.facebookHoverDiv').css("left", event.x - 65);`在`$('.facebookHoverDiv').css("top", event.y - $('.facebookHoverDiv').height());`电话中。

我需要为 FireFox 做一些特定的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:40:15.457

我想到了。以防万一其他人遇到这个问题。该问题是由使用`event.x`and`event.y`属性引起的。这些属性存在于 Chrome 中，但在其他浏览器中它们被称为`event.clientX`和`event.clientY`。将属性更改为此解决了我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:17:35.207

设置单位

```
.css("left", (event.x - 65) + "px"); 
```

用 top 做同样的事情

# ios - 自定义 UITableViewCell 适用于模拟器但不适用于设备

> ID：13316041
> 
> 赞同：1
> 
> 时间：2012-11-09T21:07:31.940
> 
> 标签：ios, uitableview, xib

在模拟器上，带有自定义表格视图的视图加载正常..但在设备上它抛出了这个错误

*** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“无法在包中加载 NIB：“NSBundle（已加载）”，名称为“MyCustomCELL”***

xib 在“显示文件检查器”中的“目标成员资格”中也存在于“构建阶段”“复制捆绑资源”中

我的测试设备是 ipod touch 3rd gen ..

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:35:23.693

通常文件未找到错误是文件名不匹配 osx HFS 不区分大小写 ios 区分大小写

# java - 如何获取类的实例？

> ID：13316042
> 
> 赞同：0
> 
> 时间：2012-11-09T21:07:36.720
> 
> 标签：java, class

我有以下代码

```
class driver{
        static BankAccount GetAccount(Customer customer, char c) {
            BankAccount accSrc = customer.S;
            // savings account
            if (c =='S') {
                accSrc = customer.S;
            // loan account
            } else if (c =='L') {
                accSrc = customer.L;
            // checking account
            } else if (c =='C') {
                accSrc = customer.C;
            // auto loan account
            } else if (c =='A') {
                accSrc = customer.A;
            }
            return accSrc;
        }
        public static void main(String[] args) {
            // TODO Auto-generated method stub
            Customer forrest = new Customer("Forrest Gump", 1, "42 New Street, New York, New York"); // me
            Customer random = new Customer("Random Name", 2, "44 New Street, New York, New York"); // imaginary partner
            //try{
                String input = JOptionPane.showInputDialog("Please enter your transaction information: ");
                Scanner s = new Scanner(input);
                int id  = Integer.parseInt(s.next());
                char action = Character.toUpperCase((s.next().charAt(0)));
                char accSrc = ' ';
                char accDest = ' ';
                double amount = 0;

                if(action == 'T'){
                    amount = s.nextDouble();
                    accSrc = s.next().charAt(0);
                    accDest = s.next().charAt(0);
                }else if(action == 'G' || action == 'I'){
                    accSrc = s.next().charAt(0);
                }else{
                    //if D,W
                    amount = s.nextDouble();
                    accSrc = s.next().charAt(0);
                }

            //}catch (IOException e){

            //}
                if(id==1){
                    return forrest;
                }else if(id == 2){
                    return random;
                }
                BankAccount src = GetAccount(forrest,  accSrc);
                System.out.print(src.getOwner().name);
                if(action == 'T'){
                    BankAccount dst = GetAccount(forrest, accDest);
                    src.transfer(amount, dst);
.

    ..
    }

    class Customer{
        protected String name;
        protected int id;
        protected String address;
        protected BankAccount C = new BankAccount(id, this, 0);
        protected BankAccount S = new BankAccount(id, this, 0);
        protected BankAccount A = new BankAccount(id, this, 0);
        protected BankAccount L = new BankAccount(id, this, 0);
    ...
    } 
```

目前我正在硬编码 BankAccount`src = GetAccount(forrest, accSrc);`我如何继续编写代码，以便它返回一个给定 ID 号的客户实例（比如 1 给定返回 forrest，2 给定返回随机）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:15:02.103

把你的课程放在一个`Map`例如

```
 Map<Integer, Customer> classMap = new HashMap<Integer, Customer>();
 Customer forrest =
        new Customer("Forrest Stallings", 1, "42 New Street, New York, New York"); 
 classMap.put(1, forrest );

 Customer random = 
        new Customer("Random Name", 2, "44 New Street, New York, New York");
 classMap.put(2, random ); 
```

然后只需将您的课程设置为：

```
Customer forrest= classMap.get(1); 
Customer random = classMap.get(2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:13:06.397

您需要将您的东西存储在[列表](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/List.html)中，然后通过其索引检索列表项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T23:32:34.907

更好

```
Customer customers[] = { forrest, random }; 
```

我可以用`customer[id]`

# opengl - OpenGL 显示简单的 3DS 对象

> ID：13316043
> 
> 赞同：1
> 
> 时间：2012-11-09T21:08:06.310
> 
> 标签：opengl

我正在用 opengl 简单地展示一个 3d 模型。问题是它显示不正确。我在这段代码上工作了几天，当我开始时，我遇到了完全相同的问题，但我修复了它，后来又把它弄坏了，现在我完全不记得解决方案了，这让我很沮丧。如果我不太注意的话，这可能是一件愚蠢的事情。

我唯一记得它与视口和相机有关，我更改的唯一代码如下。

我真的很感激有人像我一样很久没有看这段代码。也许有人会注意到我做错了什么，谢谢。

[生成的图像](http://imgur.com/dq9yc)如下所示：

```
 #include <windows.h>    // for timeGetTime()
#include <mmsystem.h>   // ditto
#include <iostream>     // I/O
#include <glut.h>   // GLUT
//#include <gl/glu.h>       // for gluPerspective & gluLookAt
#include "model3DS.h" // 3DS model support

model3DS *teddyModel;
model3DS *mush;

void setupScene();
void updateScene();
void renderScene();
void exitScene();
void keypress(unsigned char key, int x, int y);
void setViewport(int width, int height);

int         tetrahedronAngle=0;
bool        wireframe=false;
int         windowId;
int         win_width=1024, win_height = 768;
GLuint      textureId;
DWORD       lastTickCount;
GLfloat white_light[] = {1.0, 1.0, 1.0, 1.0};
GLfloat left_light_position[] = {1500,1500,1500, 1.0}; 
GLfloat right_light_position[] = {-1500,-1500,-1500, 1.0};

void renderScene(){

    // Clear framebuffer & depth buffer
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    //glEnable(GL_LIGHTING);

    // Reset Modelview matrix       
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    // Set view position & direction
    // (Camera at (0,0,5) looking down the negative Z-axis)
    gluLookAt(0,0,5,  0,0,-1,  0,1,0);

    // Draw textured tetrahedron
    glEnable(GL_TEXTURE_2D);
    glBindTexture(GL_TEXTURE_2D,textureId);

    glPushMatrix();
        glTranslatef(0.0,0.0,-1000.0);
        glRotatef(-1*tetrahedronAngle/2.f,0,1,0);
        teddyModel->draw();
    glPopMatrix();

    glPushMatrix();
        glTranslatef(-300.0,0.0,-1000.0);
        glRotatef(-1*tetrahedronAngle/2.f,0,1,0);
        mush->draw();
    glPopMatrix();

    glDisable(GL_TEXTURE_2D);
    // Swap double buffer for flicker-free animation
    glutSwapBuffers();

}

void updateScene(){

    // Wait until at least 16ms passed since start of last frame
    // Effectively caps framerate at ~60fps
    while(timeGetTime()-lastTickCount<16);
    lastTickCount=timeGetTime();

    // Increment angle for next frame
    tetrahedronAngle+=2;

    // Do any other updates here

    // Draw the next frame
    glutPostRedisplay();

}

void keypress(unsigned char key, int x, int y){

    // Test if user pressed ESCAPE (ascii 27)
    // If so, exit the program
    if(key==27){
        exitScene();
    }

    if(key == 'w' || key == 'W'){
        wireframe=!wireframe;
        if(wireframe){
            glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);
        }
        else glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
    }
    // Other possible keypresses go here
    //if(key == 'a'){...}
}

void setupScene(){

    std::cout<<"Initializing scene..."<<std::endl;

    //Set up Lighting Stuff
    glLightfv(GL_LIGHT0, GL_POSITION, left_light_position);
    glLightfv(GL_LIGHT0, GL_SPECULAR, white_light);
    glLightfv(GL_LIGHT1, GL_POSITION, right_light_position);
    glLightfv(GL_LIGHT1, GL_SPECULAR, white_light);
    glEnable(GL_LIGHT0);
    glEnable(GL_LIGHT1);
    glLightfv(GL_LIGHT0, GL_DIFFUSE, white_light);
    glLightfv(GL_LIGHT1, GL_DIFFUSE, white_light);
    glShadeModel(GL_SMOOTH);

    glEnable(GL_DEPTH_TEST);

    //Load the teddy model
    teddyModel = new model3DS("teddy\\teddy.3ds", 2);
    mush = new model3DS("mushfat\\mushroom.3ds", 2);

}

void exitScene(){

    std::cout<<"Exiting scene..."<<std::endl;

    // Close window
    glutDestroyWindow(windowId);

    // Free any allocated memory

    // Exit program
    exit(0);
}

void setViewport(int width, int height) {

    // Work out window ratio, avoid divide-by-zero
    if(height==0)height=1;
    float ratio = float(width)/float(height);

    // Reset projection matrix
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    // Fill screen with viewport
    glViewport(0, 0, width, height);

    // Set a 45 degree perspective
    gluPerspective(45, ratio, .1, 2000);

}

int main(int argc, char *argv[]){

    // Initialise OpenGL
    glutInit(&argc, argv); 

    // Set window position, size & create window
    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE | GLUT_DEPTH);
    glutInitWindowPosition(50,50);
    glutInitWindowSize(win_width,win_height);
    windowId = glutCreateWindow("Lab 4: Loading a textured model");

    // Set GLUT callback functions
    glutReshapeFunc(setViewport);
    glutDisplayFunc(renderScene);
    glutIdleFunc(updateScene);
    glutKeyboardFunc(keypress);

    // Setup OpenGL state & scene resources (models, textures etc)
    setupScene();

    // Show window & start update loop
    glutMainLoop();    

    return 0;

} 
```

# python - Long int 太大而无法转换为浮点数

> ID：13316045
> 
> 赞同：2
> 
> 时间：2012-11-09T21:08:23.420
> 
> 标签：python, casting

假设我有一个具有该功能的程序

```
def fakultaet(x):
    if x>1:
        return(x* fakultaet(x-1)) 
    else:
        return(1) 
```

返回给定数字的阶乘，我需要计算

```
1.0/fakultaet(200) 
```

但我得到一个溢出错误：`long int too large to convert to float`。

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T21:13:07.623

你可以试试这个：

```
from decimal import Decimal

def fakultaet(x):  # as you have it currently
    if x>1:
        return(x * fakultaet(x-1)) 
    else:
        return(1)

print Decimal(1.0) / fakultaet(200) 
```

输出：

```
1.267976953480962421753016371E-375 
```

* * *

哦，而且，模块中已经有一个`factorial`函数，只需在文件顶部包含即可访问它。`math``from math import factorial`

# plsql - PL/SQL 将 SELECT 嵌入到函数中

> ID：13316065
> 
> 赞同：0
> 
> 时间：2012-11-09T21:09:52.730
> 
> 标签：plsql

我正在尝试在存储函数中嵌入一个简单的 SELECT 语句，但它似乎抛出了这些错误：

> 忽略 SQL 语句（第 9 行）

和

> 缺少左括号（第 12 行）

首先，为什么它忽略了我的选择语句？其次，我在第 12 行没有括号，所以我不明白这个错误是如何被抛出的。

但这是我存储的功能代码：

```
CREATE OR REPLACE FUNCTION tax_calc_sf
(p_basketid IN NUMBER)
RETURN NUMBER
IS
  lv_taxamt_num NUMBER;
  lv_subtotal_num bb_basket.subtotal%TYPE;
  lv_taxrate_num bb_tax.taxrate%TYPE;
BEGIN
  SELECT bb.subtotal, bt.taxrate
  INTO lv_subtotal_num, lv_taxrate_num
  FROM bb_basket bb
  JOIN bb_tax bt USING bt.state = bb.shipstate
  WHERE bb.idbasket = p_basketid;

  lv_taxamt_num := lv_subtotal_num*lv_taxrate_num;
  RETURN lv_taxamt_num;

EXCEPTION
  WHEN NO_DATA_FOUND THEN
    RETURN 0;
END;
/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:12:47.463

尝试

```
ON bt.state = bb.shipstate 
```

代替

```
USING bt.state = bb.shipstate 
```

*正是因为*没有括号`Missing left parantheses`而引发错误。该子句需要括号。它还要求连接列在两个表中的名称相同。由于您的表中不是这种情况，因此您必须使用该子句。*`USING``ON`*

# knockout.js - 升级到 knockout.js 2.2.0 会导致 foreach 模板不再呈现

> ID：13316078
> 
> 赞同：1
> 
> 时间：2012-11-09T21:10:54.003
> 
> 标签：knockout.js

我刚刚升级到 knockout.js 2.2.0，并且 foreach 语句不再适用于计算的 observable。如果我切换回 2.1 它可以工作。计算出的 observable不会在下面的 html 中`updatedValues`重新填充。`foreach`请记住，下面的 html 是动态插入到单个 ajax 页面上的 dom 并应用绑定的。

```
ko.bindingHandlers.fields = {
        init: function (element, valueAccessor) {

            var value = ko.utils.unwrapObservable(valueAccessor());

            app.viewModel.members.meta = {
                values: ko.observableArray(value.values),
                remove: function () {
                    app.viewModel.members.meta.values.remove(this);
                    return false;
                },
                add: function () {
                    app.viewModel.members.meta.values.push({ Name: '', Value: '', Index: ko.observable(app.viewModel.members.meta.values().length) });
                    return false;
                },
                max: value.max
            };

            app.viewModel.members.meta.updatedValues = ko.computed(function () {
                if (this.values()) {
                    for (var i = 0; i < this.values().length; i++) {
                        if (this.values()[i].Index)
                            this.values()[i].Index(i);
                        else
                            this.values()[i].Index = ko.observable(i);
                    }
                }

                return this.values;
            }, app.viewModel.members.meta);
        }
    };

<div class="control-group">
    @Html.LabelFor(q => q, "Custom Fields") 
    <div class="controls">
        <div class="meta" data-bind="fields: { values: @Model.Meta.OrderBy(q => q.Name).ToJSON(), max: @Model.MaxCount }">
            <div data-bind="foreach: members.meta.updatedValues">
                <div class="form-inline">
                    <div class="input-prepend">
                        <span class="add-on">Name</span>
                        @Html.TextBox("Key", string.Empty, new { maxvalue = "100", data_bind = "value: Name, attr: { name: '" + Model.PropertyName + "[' + Index() + '].Name', id: '" + Model.PropertyName + "[' + Index() + '].Name' }" })
                    </div>
                    @if(!Model.HideValues)
                    {
                        <div class="input-prepend">
                            <span class="add-on">Value</span>
                            @Html.TextBox("Value", string.Empty, new {data_bind = "value: Value, attr: { name: '" + Model.PropertyName + "[' + Index() + '].Value', id: '" + Model.PropertyName + "[' + Index() + '].Value' }"})
                        </div>
                    }
                    <a href="#" class="btn btn-mini btn-danger" title="Remove Field" data-bind="click: $parent.members.meta.remove"><i class="icon-minus icon-white"></i></a>
                </div>
            </div>
            <div class="control-group">
                @Html.Button("New Field", new { type="button", @class="btn", data_bind = "click: members.meta.add, visible: members.meta.max >= members.meta.values().length" })
                @Html.Partial(MVC.Shared.Views.Controls.Help, new HelpModel { Url = Url.Action(Model.ActionResult ?? MVC.Members.Dashboard.CustomFieldsHelp()), Title = Model.Title ?? "Custom Fields" })
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:22:36.770

看看这里完成的更新[Knockout 2.2.0 发布](http://blog.stevensanderson.com/2012/10/29/knockout-2-2-0-released/)。

**foreach 和模板增强**

> 当一个函数用于模板名称时，它现在接收绑定上下文作为第二个参数。
> 
> foreach 功能现在尽最大努力理解被移动的项目并移动它们的内容，而不是重新渲染它们。
> 
> 现在可以在使用 foreach 功能时配置 beforeMove 和 afterMove 回调。
> 
> foreach 和模板绑定现在接受 as 选项来给 $data 一个别名。
> 
> afterRender、beforeRemove、afterAdd、beforeMove 和 afterMove 回调将不再导致依赖。

我认为 computed 应该返回一个普通数组，因此将其更改为，`values: []` 因为在**Knockout 2.2**中，使用`foreach()`.

您可以随时在此处记录问题：[https ://github.com/SteveSanderson/knockout/issues](https://github.com/SteveSanderson/knockout/issues)

# jquery - 点击功能的Javascript在一页上不起作用

> ID：13316079
> 
> 赞同：0
> 
> 时间：2012-11-09T21:10:56.647
> 
> 标签：jquery

这里的想法是，每当用户单击图像时，他或她都可以在上面的框中查看有关该人的信息。它以前工作过，然后突然停止了。这是我正在谈论的页面的链接和我的代码。

[http://www.team3550.org/team/](http://www.team3550.org/team/)

代码：

```
 <script type="text/javascript">
        jQuery(document).ready(function($){
            $('#team_pics img, #team_pics2 img').click(function(){
                $('#team_description').html('<img src="' + $(this).attr('src') + '" />' + $(this).next().html());
            });
        });
    </script>
        <div id="team_description">     
            <h1>Click on a picture below to learn more about a team member</h1>
        </div>
        <div id="team_container">
            <div id="team_pics">
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_chase.png" width="100px" height="100px" style="padding: 30px;"/>
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Chase Schweitzer</b></span><br>-Third year in FTC<br>-Designer, builder, webmaster<br>-Interests: programming (HTML, CSS, BASIC, Javascript, etc.), web design, music, writing<br>-Plays the guitar and violin</p></div>
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_annie.png" width="100px" height="100px" style="padding: 30px;"/>
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Annie Howard</b></span><br>-Second year in FTC<br>-Designer, builder, writer<br>-Interests: music, writing, history, anthropology<br>-Plays the ukelele, sings</p></div>
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_tanvi.png" width="100px"height="100px" style="padding: 30px;"/>
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Tanvi Yenna</b></span><br>-Second year in FTC<br>-Designer, builder, engineering notebook organizer<br>-Interests: designing, music, writing, and acting<br>-Plays the piano, guitar and ukelele; sings</p></div>
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_jordan.png" width="100px" height="100px" style="padding: 30px;"/>                
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Jordan Burklund</b></span><br>-Fourth year in FTC, two years in FLL<br>-Designer, builder, programmer<br>-Interests: robotics/mechatronics engineering, aviation, and music<br>-CLAD certified</p></div>              
            </div>
            <div id="team_pics2">                   
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_saketh.png" width="100px" height="100px" style="padding: 0px 30px;"/>        
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Saketh Undurty</b></span><br>-Fourth year in FTC, two years in FLL<br>-Designer, builder<br>-Interests: 3D modeling/design, architecture, and music<br>-Plays trumpet in concert band and jazz orchestra</p></div>
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_daniel.png" width="100px" height="100px" style="padding: 0px 30px;"/>
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Daniel Miller</b></span><br>-Third year in FTC<br>-Designer, builder, promotions<br>-Interests: architecture, graphic design, music<br>-Viola player, mime, and thespian</p></div>
                <img src="<? bloginfo('stylesheet_directory'); ?>/images/pixel_sidd.png" width="100px" height="100px" style="padding: 0px 30px;"/>
                <div class="caption"><p class="caption_paragraph"><span class="caption_header"><b>Sidd Somayajula</b></span><br>-Third year in FTC<br>-Designer, builder, webmaster<br>-Interests: medicine, math, web design, programming (HTML, CSS, BASIC, Javascript, etc.)<br>-Plays tennis</p></div>
            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:15:18.907

您确实看到第 202 行是如何抛出 TypeError 的，对吗？

```
var top = $('#blog_right').offset().top - parseFloat($('#blog_right').css('margin-top').replace(/auto/,0)); 
```

未捕获的类型错误：无法读取未定义的属性“顶部”

我在此页面上没有看到任何以 blog_right 作为 ID 的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:27:47.147

在调用时在代码中放置断点`jQuery(document).ready(function($){`甚至不会停止。

# php - 带循环的 Fgetcsv 并获得正确的值

> ID：13316081
> 
> 赞同：0
> 
> 时间：2012-11-09T21:11:06.177
> 
> 标签：php, mysql

我有一个 txt 文件，我需要将它上传到我的 mysql 数据库中。所以我在 php.net 中找到了这段代码：

```
$row = 1;
if (($handle = fopen("test.csv", "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        echo "<p> $num fields in line $row: <br /></p>\n";
        $row++;
        for ($c=0; $c < $num; $c++) {
            echo $data[$c] . "<br />\n";
        }
    }
    fclose($handle);
} 
```

有效。当我给出一个'print_r'时，我有这个：

```
PAGE:1
ANUALDATA
Ver:1.651.A
Site data ou www.sitedata.com
COUNT:3758-3 NAME:USER NAME IDUS: 262.911.258-62
PLACE:030 IDCUS:11003 
DATE 31/12/2011
VALUE................................U$ 200,00
PROCESS DATE 31/12/2011
VALUE NEEDED.....................U$ 3,45
PAID VALUE..........U$ 50,00
PAGE:2
ANUALDATA
Ver:1.651.A
Site data ou www.sitedata.com
COUNT:3758-3 NAME:USER NAME IDUS: 262.911.258-62
PLACE:030 IDCUS:11003 
DATE 31/12/2011
VALUE................................U$ 200,00
PROCESS DATE 31/12/2011
VALUE NEEDED.....................U$ 3,45
PAID VALUE..........U$ 50,00
PAGE:3
ANUALDATA
Ver:1.651.A
Site data ou www.sitedata.com
COUNT:3758-3 NAME:USER NAME IDUS: 262.911.258-62
PLACE:030 IDCUS:11003 
DATE 31/12/2011
VALUE................................U$ 200,00
PROCESS DATE 31/12/2011
VALUE NEEDED.....................U$ 3,45
PAID VALUE..........U$ 50,00 
```

现在我的问题来了。我看到了其他示例，但确实可以将其用于我的案例。我需要做一些事情，比如在 $key = $val 中转换每一行，比如

```
[VALUE] => 200,00
[PROCESS DATE] =>31/12/2011 
```

你会注意到那是页面，我需要刹车才能有这样的东西

```
[0]
    [VALUE] => 200,00
    [PROCESS DATE] =>31/12/2011
[1]
    [VALUE] => 200,00
    [PROCESS DATE] =>31/12/2011 
```

因此，我将在 db 的每一行中插入这些数据。有办法吗？如果我只能得到 de $value 那也可以。

编辑

它不是 CSV，而是另一个系统创建的 TXT，我无法控制它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:38:04.163

如果您只想将其加载到 MySQL 中，您是否查看过 LOAD DATA INFILE？

[http://dev.mysql.com/doc/refman/5.5/en/load-data.html](http://dev.mysql.com/doc/refman/5.5/en/load-data.html)

```
LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:30:09.110

不知道这是否是代码片段的结果，我看不到`echo "<p> $num fields in line $row: <br /></p>\n";`. 此外，分隔符似乎是“：”（假设它没有出现在文本中的其他任何地方）。也就是说，试试这个...

```
$row = 1;
$res = array();
if (($handle = fopen("test.csv", "r")) !== FALSE) {
    while (($data = fgetcsv($handle, 1000, ",")) !== FALSE) {
        $num = count($data);
        $row++;
        $tmpArr = array();
        for ($c=0; $c < $num; $c++) {
            list($key, $val) = explode(":", $data[$c]);
            $tmpArr[$key] = $val;
        }
        $res[] = $tmpArr;
    }
    fclose($handle);
}
print_r($res); 
```

# r - R在显示或打印命名向量时抑制名称

> ID：13316082
> 
> 赞同：16
> 
> 时间：2012-11-09T21:11:09.280
> 
> 标签：r

我想知道，给定一个命名向量，是否可以只打印（或在 R 控制台中显示）向量的值而不删除名称。

```
# EXAMPLE
v <- (1:5)
names(v) <- LETTERS[1:5]

print(v)
# RESULT: 
#  A B C D E 
#  1 2 3 4 5 

# RESULT I AM SEEKING 
#  [1] 1 2 3 4 5 
```

我能够使用以下函数获得我正在寻找的结果。但是，是否有更好或更直接的方法来仅打印命名向量的值？

```
print.n <- function (obj) {
  names(obj) <- NULL
  print(obj)
}

print.n(v)
#  [1] 1 2 3 4 5 
```

谢谢。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-09T21:12:05.253

尝试`unname()`：

```
R> v <- (1:5); names(v) <- LETTERS[1:5]
R> print(v)
A B C D E 
1 2 3 4 5 
R> print(unname(v))
[1] 1 2 3 4 5
R> 
```

# php - 放置在子目录中的 PHP 文件不执行

> ID：13316087
> 
> 赞同：2
> 
> 时间：2012-11-09T21:11:19.530
> 
> 标签：php, wordpress, modx

我正在尝试将 Wordpress 网站转移到客户端的服务器中。客户端的现有网站在 MODX（基于 php 的 CMS）中运行。我在根目录中创建了一个名为“new”的子目录，并将我的 Wordpress 文件放在那里，这样我就可以先将它安装在那里，如果一切看起来都不错，请将其移至根目录。

但是，问题是我无法从该子目录运行 php 文件。每次我导航到一个文件时，浏览器都会下载文件而不是运行它。我可以从根目录运行文件就好了。

有人知道问题可能是什么吗？.htaccess 中的某些内容可以阻止文件从子目录运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:16:13.523

是的，该`.htaccess`文件可能会阻止您子目录中的 PHP 文件的正确操作/访问。尝试完全删除`.htaccess`文件并报告结果。

`.htaccess`我已经看到了伪造文件的这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-11T02:20:47.953

不要重命名`.htaccess`或删除它。最好的方法是[在这里](https://wordpress.stackexchange.com/questions/20152/cannot-access-non-wordpress-subdirectories-as-wordpress-overrides-them-with-a-40)建议在`.htaccess`文件中进行编辑。

# c# - 我可以使用 Node.js 调用 C# 方法吗？

> ID：13316088
> 
> 赞同：2
> 
> 时间：2012-11-09T21:11:20.727
> 
> 标签：c#, node.js, iisnode

我正在开发一个 Webforms 项目，并且正在研究实现 node.js 和 issnode。我们正在使用：

*   网络表格
*   IIS
*   C＃
*   实体框架
*   SQL 服务器

我们有一个页面需要一段时间才能加载，并且正在寻找提高其速度的方法。页面上显示了一些有用的计数，但会导致页面加载缓慢。（我们正在显示任务总数、组中的人数和组数）。

我在想我可以直接从 node.js 文件中调用我的 c# 代码。从我看到的例子和我读过的例子来看，这似乎不是我应该寻找的解决方案。由于我们使用的是 EF 并且我没有编写 SQL 查询，因此看起来我应该与服务进行交互。

所以我的问题是，我可以使用 Node.js 来调用我的 C# 方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-05-28T20:28:34.457

是的，您现在可以通过[Edge.js](http://tjanczuk.github.io/edge/#/)执行此操作。

来自[http://www.infoq.com/articles/the_edge_of_net_and_node](http://www.infoq.com/articles/the_edge_of_net_and_node)：

## 为什么使用 Edge.js？

> 虽然许多应用程序可以专门用 Node.js 编写，但有些情况需要结合使用 Node.js 和 .NET 或从中受益。出于多种原因，您可能希望在应用程序中使用 .NET 和 Node.js。.NET 框架和 NuGet 包提供了丰富的功能生态系统，可补充 Node.js 和 NPM 模块的功能。您可能希望在 Node.js 应用程序中重用预先存在的 .NET 组件。您可能希望使用多线程 CLR 来运行不太适合单线程 Node.js 的 CPU 密集型计算。或者，您可能更喜欢使用 .NET Framework 和 C#，而不是使用 C/C++ 编写本机 Node.js 扩展来访问尚未通过 Node.js 公开的特定于操作系统的机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:28:51.903

您的问题有点晦涩，所以我将提出我认为的要点：

> 我在想我可以直接从 node.js 文件中调用我的 c# 代码。

老实说，我不知道这是否可能，我对此表示怀疑，但我并不好奇想弄清楚，因为这是一个坏主意。

> 从我看到的例子和我读过的例子来看，这似乎不是我应该寻找的解决方案。由于我们使用的是 EF 并且我没有编写 SQL 查询，因此看起来我应该与服务进行交互。

绝对，除了 EF 或 SQL 与你为什么不应该这样做完全无关。我知道这可能是一种心理转变，尤其是在 .Net 领域，但 Node 在鼓励和授权使用处理非常具体的任务（想想地理编码、分析、时间码查找、索引、搜索、通知）的微应用程序方面做得非常好等）然后可以通过服务调用或其他机制合并在一起。

> 我们有一个页面需要一段时间才能加载，并且正在寻找提高其速度的方法。页面上显示了一些有用的计数，但会导致页面加载缓慢。（我们正在显示任务总数、组中的人数和组数）。

我已经很长时间没有使用过 .Net 或 EF 了，但如果我猜的话，我建议你先分析一下。我几乎愿意打赌你有一个 N+1（或更糟）的问题，可以很容易地解决。

# asp.net - 找不到包含取自 SharePoint .aspx 页面的特定文本的资源文件

> ID：13316090
> 
> 赞同：2
> 
> 时间：2012-11-09T21:11:29.697
> 
> 标签：asp.net, sharepoint-2010

我们在 14 hive 中有一个站点，具体来说：

```
Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\LAYOUTS\SubNew.aspx 
```

此页面中的大部分标签都取自 Resources 文件，例如 [第 150 行]：

```
Description="<%$Resources:wss,subnew_alerttitle_desc%>" 
```

但是有一些文本以某种方式出现在此页面上，例如：

```
All changes 
New items are added 
Existing items are modified 
Items are deleted 
```

而且我不知道它们是从哪里获取的或它们是如何生成的。我尝试使用 Notepad++“在文件中查找”功能搜索整个“14”文件夹，但它没有返回单个匹配项。

在代码 (SubNew.aspx) 中，最接近显示文本的位置是：

```
<Template_Control>
    <asp:RadioButtonList id="RadioBtnEventType" CssClass="ms-authoringcontrols" Runat="server" />
</Template_Control> 
```

但我不明白单选按钮是如何生成的以及文本来自哪里。

有没有我应该在其中查找可能存储文本的资源文件的位置？

是否有可能在没有实际存储在资源文件中的情况下即时生成文本？如果是这样，它们是在哪里生成的？

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T00:09:34.740

文本被硬编码到 14/ISAPI/Microsoft.SharePoint.dll

使用[反射器](http://www.reflector.net/)检索代码。

# python - 如何检索缩略图并将其显示为 QListwidget 项目？

> ID：13316091
> 
> 赞同：1
> 
> 时间：2012-11-09T21:11:41.210
> 
> 标签：python, pyqt, pyqt4

**我正在尝试直接从[http://i.ytimg.com/](http://i.ytimg.com/)读取缩略图，而不使用 google gdata 服务。谁能帮我？**

```
`enter code here`

#!/usr/bin/env python
#_*_ encoding: UTF-8 _*_

from PyQt4.QtGui import QImageReader

from PyQt4.QtNetwork import (QNetworkRequest, QNetworkReply, QNetworkAccessManager)

from PyQt4.QtCore import QUrl

def getThumbnails(self,numTitles):

     thumbs = []
     thumbs[:]= []

     nam = QNetworkAccessManager()

     for i in xrange(numTitles):
         url = QUrl("http://i.ytimg.com/vi/" + self.tubeLinks[i] + "/default.jpg")
         request = QNetworkRequest(url)
         reply = nam.get(request)
         image_reader = QImageReader(reply)
         thumbs.append(image_reader.read())

     return thumbs 
```

**我的定义是：**

1.- 如何测试拇指是否被成功读取？

2.- 如何使用像素图将它们添加到 QListWidget 项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T05:09:02.340

我可能会使用 2 个对象来解决它：

1.- QListWidgetItem 的子类，包含您想要的图像，如何将图像加载为 QPixmap 的逻辑等。这应该是您应该插入到列表中的项目。

2.- 定义 QListWidget 中的项目如何绘制的 QItemDelegate。在这里，您可以处理项目（QListWidgetItem 对象）具有空图像并显示默认图标的情况。

这是关于项目代表的额外文档。祝你好运

[http://doc.qt.digia.com/qt/qabstractitemview.html#setItemDelegate](http://doc.qt.digia.com/qt/qabstractitemview.html#setItemDelegate)

[http://doc.qt.digia.com/qt/model-view-programming.html#delegate-classes](http://doc.qt.digia.com/qt/model-view-programming.html#delegate-classes)

# java - 假人的通用模板 ADT

> ID：13316102
> 
> 赞同：0
> 
> 时间：2012-11-09T21:12:21.010
> 
> 标签：java

我需要在二叉搜索树上编写一个排序集，问题是，我不知道如何使用抽象类型并在上下文中比较这两个对象，因为我需要声明自己的比较器。

我到目前为止，但不知何故我被卡住了，因为我认为 Comparable 类型是不可能的，因为我自己的比较器方法。

静态节点类：

```
static class  BinaryNode<ElementType> {
    ElementType element;
    BinaryNode <ElementType> right;
    BinaryNode <ElementType> left;

    public BinaryNode(ElementType elm) {
        ElementType element = elm;
        right=left=null;
    }
} 
```

我感到困惑的方法示例：

```
 private BinaryNode find( ElementType x, BinaryNode t ) {
        while( t != null ) {
            if( x.compareTo( t.element ) < 0 )
                t = t.left;
            else if( x.compareTo( t.element ) > 0 ) // is done with overrite of the comparable method, any Ideas please?
                t = t.right;
            else
                return t;    // Match
        }

        return null;         // Not found
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:19:09.420

您需要使用通配符

```
class  BinaryTree <ElementType extends Comparable<ElementType>> { 
    private class  BinaryNode <ElementType extends Comparable<ElementType>> { 
           BinaryNode<ElementType> left,right;
           ElementType value;
           public BinaryNode(ElementType value, BinaryNode<ElementType> left ,  BinaryNode<ElementType> right) {
                  this.value = value;
                  this.left = left;
                  this.right = right;
            }
     }
} 
```

我也相信你实际上可以在内部类 BinaryNode 中完全省略泛型类型参数。

# python - 获取填充字典的大小

> ID：13316113
> 
> 赞同：3
> 
> 时间：2012-11-09T21:13:39.127
> 
> 标签：python, dictionary, sizeof, content-length

我想在 python 中获取已填充字典的大小。我试过这个：

```
>>> dict = {'1':1}
>>> import sys
>>> print dict
{'1': 1}
>>> sys.getsizeof(dict)
140 
```

但这显然不会这样做。我期望的返回值为 2（字节）。我会有一本字典，内容如下：

```
{'L\xa3\x93': '\x15\x015\x02\x00\x00\x00\x01\x02\x02\x04\x1f\x01=\x00\x9d\x00^\x00e\x04\x00\x0b', '\\\xe7\xe6': '\x15\x01=\x02\x00\x00\x00\x01\x02\x02\x04\x1f\x01B\x00\xa1\x00_\x00c\x04\x02\x17', '\\\xe8"': '\x15\xff\x1d\x02\x00\x00\x00\x01\x02\x02\x04\x1f\x01:\x00\x98\x00Z\x00_\x04\x02\x0b', '\\\xe6@': '\x15\x014\x02\x00\x00\x00\x01\x02\x02\x04\x1f\x01@\x00\x9c\x00\\\x00b\x04\x00\x0b'} 
```

我想知道我需要发送多少字节的数据。我的索引是 6 字节，但内容有多长？我知道这里每个索引是 46Bytes，所以我想知道我需要传输 4*(6+46) Bytes.... 我怎样才能做到最好？

谢谢，罗恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:49:15.187

那么，当我需要逐字节传输内容时，只有这给了我真正的长度吗？

```
#non_mem_macs is my dictionary
for idx in non_mem_macs:
    non_mem_macs_len += len(hexlify(idx))
    non_mem_macs_len += len(hexlify(non_mem_macs[idx])) 
```

# solr - Solr 4.0 fq Join 与 q Join

> ID：13316116
> 
> 赞同：3
> 
> 时间：2012-11-09T21:13:56.860
> 
> 标签：solr

我是 Solr 的新手，在连接各种文档（包含在 solr 包中）时遇到了困难。以下网址：-

```
http://localhost:8983/solr/collection1/select?q={!join+from=id+to=manu_id_s+cache=false}id:* 
```

与以下网址相比，正在生成不同的响应：-

```
http://localhost:8983/solr/collection1/select?fq={!join+from=id+to=manu_id_s+cache=false}id:* 
```

我在 wiki 上查找了 join 的文档。但是，他们仅将连接与主查询一起使用。您能否让我知道是否可以使用过滤器查询进行连接，或者是否需要提供一些其他参数以便使用过滤器查询进行连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T02:14:28.563

一般情况下，如果只指定了过滤查询（`fq`），则不会返回任何结果。（更准确地说，如果未`q`指定参数，则默认为“匹配无文档”查询。）

将`q`参数设置为`[* TO *]`匹配默认字段中的所有值（现在似乎`*`会做同样的事情），因此如果您将第二个查询修改为是：

```
http://localhost:8983/solr/collection1/select?fq={!join+from=id+to=manu_id_s+cache=false}id:*&q=[*+TO+*] 
```

`fq`不影响候选者的分数，但会影响候选者的子集`q`和各种提升查询的分数。

# validation - GWT 编辑器验证 HasEditorErrors 始终为空

> ID：13316120
> 
> 赞同：0
> 
> 时间：2012-11-09T21:14:25.447
> 
> 标签：validation, gwt

我正在使用 GWT 编辑器和 javax 验证。

我有一个带有像这样的子 bean 的模型 bean ->

```
public interface BeanA {

    @Valid
    BeanB getBeanB();

    void setBeanB(BeanB b);
}

public interface BeanB {

    @NotEmpty
    public String getValue();

    public void setValue(String value);

} 
```

有一个实现 LeafValueEditor、HasEditorErrors 接口的 Widget。

该值似乎毫无问题地具有约束力。

```
 public class MyWidget extends Composite implements 
                                 LeafValueEditor<String>, HasEditorErrors<String>{
    ...

    @Override
    public void showErrors(List<EditorError> errors) {
           // Even though the error is flagged 
           // the errors collection does not contain it.    
           }
} 
```

当我调用 validate 并且小部件 getValue 返回 null 时，ConstraintViolation 集合包含错误，但是当调用 showErrors 时，List 为空。

知道为什么发现违规但没有出现在小部件 showErrors 中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T09:46:21.527

如果您使用 GWT 编辑器，您将拥有`SimpleBeanEditorDriver`由 GWT.create(...) 创建的界面。这个接口有一个方法`setConstraintViolations(violations)`可以让你违反约束。当您验证您的模型时，您会遇到`Set<ConstraintViolation<E>>`违规行为，然后您会将其传递给您的编辑器驱动程序。例如

```
Set<ConstraintViolation<E>> violations = getValidator().validate(model,
            groups);
getEditorDriver().setConstraintViolations(violations) 
```

在此之后，您将在小部件的`showErrors(List<EditorError> errors)`方法上收到特定于小部件的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T19:38:54.940

这似乎是 GWT 2.4 问题。我在 GWT 2.5 中做了同样的例子，路径设置正确，错误收集正确。

# sql - 从 MySQL 迁移到 PostgreSQL 时的 SQL 问题

> ID：13316122
> 
> 赞同：3
> 
> 时间：2012-11-09T21:14:38.087
> 
> 标签：sql, ruby-on-rails, postgresql, heroku, group-by

我有一个 Ruby on Rails 2.3.x 应用程序，我正在尝试从我自己的 VPS 迁移到 Heroku，包括从 SQLite（开发）和 MySQL（生产）移植到 Postgres。

这是我正在使用的典型 Rails 调用：

```
spots = Spot.paginate(:all, :include => [:thing, :user, :store, {:thing => :tags}, {:thing => :brand}], :group => :thing_id, :order => order, :conditions => conditions, :page => page, :per_page => per_page) 
```

**问题 1：**我收到很多错误，例如`PG::Error: ERROR: column "spots.id" must appear in the GROUP BY clause or be used in an aggregate function`. SQLite/MySQL 显然在这里更宽容。当然，我可以通过将指定字段添加到我的`:group`参数来轻松解决这些问题，但我觉得我的代码搞砸了。有没有更好的办法？

**问题 2：**如果我输入 Postgres 缺少的所有 GROUP BY 列，我最终会得到以下语句（仅`:group`已更改）：

```
spots = Spot.paginate(:all, :include => [:thing, :user, :store, {:thing => :tags}, {:thing => :brand}], :group => 'thing_id,things.id,users.id,spots.id', :order => order, :conditions => conditions, :page => page, :per_page => per_page) 
```

这又会产生以下 SQL 代码：

```
SELECT * FROM (SELECT DISTINCT ON ("spots".id) "spots".id, spots.created_at AS alias_0 FROM "spots"  
LEFT OUTER JOIN "things" ON "things".id = "spots".thing_id 
WHERE (spots.recommended_to_user_id = 1 OR spots.user_id IN (1) OR things.is_featured = 't')  
GROUP BY thing_id,things.id,users.id,spots.id) AS id_list 
ORDER BY id_list.alias_0 DESC LIMIT 16 OFFSET 0; 
```

...产生错误`PG::Error: ERROR: missing FROM-clause entry for table "users"`。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T04:28:30.757

### 问题一：

...有没有更好的办法？

是的。`GROUP BY`从 PostgreSQL 9.1 开始，表的主键在逻辑上涵盖了子句中表的所有列。我引用了[9.1 版的发行说明](http://www.postgresql.org/docs/9.1/interactive/release-9-1.html)：

> 当在 GROUP BY 子句中指定主键时，允许查询目标列表中的非 GROUP BY 列 (Peter Eisentraut)

### 问题2：

以下语句...产生错误

> PG::Error: 错误：缺少表“用户”的 FROM 子句条目

我该如何解决这个问题？

首先（一如既往！），我对您的查询进行了格式化以使其更易于理解。罪魁祸首大胆强调：

```
SELECT *
FROM  (
   SELECT DISTINCT ON (spots.id)
          spots.id, spots.created_at AS alias_0
   FROM   spots  
   LEFT   JOIN things ON things.id = spots.thing_id 
   WHERE (spots.recommended_to_user_id = 1 OR
          spots.user_id IN (1) OR
          things.is_featured = 't')  
   GROUP  BY thing_id, things.id, **users**.id, spots.id
   ) id_list 
ORDER  BY id_list.alias_0 DESC
LIMIT  16
OFFSET 0;
```

现在一切都很明显了，对吧？
好吧，不是*全部*。还有很多。`DISTINCT ON`在同`GROUP BY`一个查询中，它有它的用途，但不是在这里。**从根本上简化**为：

```
SELECT s.id, s.created_at AS alias_0
FROM   spots s
WHERE  s.recommended_to_user_id = 1 OR
       s.user_id = 1 OR
       EXISTS (
          SELECT 1 FROM things t
          WHERE  t.id = s.thing_id
          AND    t.is_featured = 't')
ORDER  BY s.created_at DESC
LIMIT  16; 
```

[`EXISTS`](http://www.postgresql.org/docs/current/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)半连接避免了后期需要先验`GROUP BY`。如果我对丢失表定义的假设成立，这应该会快得多（除了正确之外）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T15:33:56.297

走“纯 SQL”路线为我打开了一罐蠕虫，所以我尝试保留 will_paginate gem 并调整`Spot.paginate`参数。事实证明，该`:joins`参数非常有用。

这目前对我有用：

```
spots = Spot.paginate(:all, :include => [:thing, {:thing => :tags}, {:thing => :brand}], :joins => [:user, :store, :thing], :group => 'thing_id,things.id,users.id,spots.id', :order => order, :conditions => conditions, :page => page, :per_page => per_page) 
```

# matlab - Matlab - 在不使用神经网络工具箱的情况下创建 RBF 网络

> ID：13316124
> 
> 赞同：0
> 
> 时间：2012-11-09T21:14:42.460
> 
> 标签：matlab, neural-network, gaussian

在讲座中我们只提到了如何用高斯函数训练RBF网络以及如何使用Matlab中的“newrb”工具箱。但是在assignemnet中，我需要创建自己的RBF网络，禁止使用NN工具箱。基本上我什至不知道如何开始，我们的教授也不愿意提供任何信息。

有了一些技巧，我编写了自己的程序，但性能很差，我想知道是否有人可以给我一些有用的教程或指南，说明如何在不使用 NN 工具箱的情况下使用高斯函数创建 RBF 网络。

我已经使用k-means来获得中心和高斯函数来计算权重，主要问题是我不知道如何设计将输入矩阵转换为RBF矩阵的方法。希望你能帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:30:46.480

这显然是作业，不清楚你的问题是什么。但我想你想知道如何创建 Gram 矩阵。如果是这样，请参阅：

[http://en.wikipedia.org/wiki/Gramian_matrix](http://en.wikipedia.org/wiki/Gramian_matrix)

您应该知道如何在教科书和/或笔记中执行每个步骤。

# php - 在 MySQL 中使用 UTF-8

> ID：13316125
> 
> 赞同：0
> 
> 时间：2012-11-09T21:14:49.657
> 
> 标签：php, mysql, unicode

我使用 MySQL 和 PHP 将数据存储在 Android 应用程序中。我想在我的数据库和表格中使用 UTF-8，因为数据是英文和波斯文的。此查询用于创建表：

```
CREATE TABLE IF NOT EXISTS `tbl_notes` (
  `user_id` int(11) NOT NULL,
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `note_subject` varchar(22) NOT NULL,
  `note_date` text NOT NULL,
  `note_content` varchar(21000) NOT NULL,
  `note_deleted` tinyint(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ; 
```

我在连接到数据库之前使用此代码：

```
$con = mysql_connect(DB_SERVER, DB_USER, DB_PASSWORD) or die(mysql_error());
$db = mysql_select_db(DB_DATABASE) or die(mysql_error());
mysql_query("SET CHARACTER SET 'UTF8'", $con);
mysql_query("SET NAMES utf8_general_ci", $con); 
```

我的问题是当我将数据保存到**note_content**和**note_subject**时，数据显示为“???????”。当我再次将数据检索到我的 android 应用程序时，数据为“??????????”。

我该如何解决这个错误？

# javascript - Titanium Appcelerator 按钮栏是否可以有多种颜色？Titanium.UI.createButtonBar

> ID：13316127
> 
> 赞同：0
> 
> 时间：2012-11-09T21:14:59.770
> 
> 标签：javascript, titanium, titanium-mobile

到目前为止，这是我的代码。我有一个带有两个选项的按钮栏。我想更改第二个选项的颜色。我不太确定如何做到这一点。我可以通过检查索引来设置点击功能，但尝试更改颜色失败。

```
var headerEmail = Titanium.UI.createButtonBar({ 
  labels:['cory@gmail.com', 'Logout'], 
  backgroundColor:(labels[0] == 0) ? '#000' : '#fff'

});

headerEmail.addEventListener('click', function(e){
  //alert(e.index);
  if(e.index == 1){
    var LoginWindow = require('/ui/LoginWindow')();      
    LoginWindow.open();
    TabContainer.close(); 
  }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T05:36:15.127

已经尝试使用 headerEmail.children[1]，我的意思是你可以这样尝试，

```
var headerEmail = Titanium.UI.createButtonBar({ 
  labels:['cory@gmail.com', 'Logout'], 
  backgroundColor:(labels[0] == 0) ? '#000' : '#fff'

});

headerEmail.children[1].setbackgroundColor('#fff'); 
```

# imagemagick - 如何使用 node-imagemagick 进行裁剪，缓冲区作为输入，stdout 作为输出？

> ID：13316133
> 
> 赞同：2
> 
> 时间：2012-11-09T21:15:28.687
> 
> 标签：imagemagick, imagemagick-convert, node-imagemagick

我第一次使用 node-imagemagick。免责声明：我从未使用过 imagemagick，也不是一个 javascript 人。大多数经验是 C/C++、Objective-C。

我正在为需要获取输入缓冲区的服务器端进程编写一个片段，将其裁剪到任意范围，然后将其输出到标准输出中。

目前，我的代码如下所示：

```
var im = require('imagemagick');
...
im.convert([
    binaryDataBlock,
    '-crop',
     cropStr], function(err, stdout, stderr) {.... 
```

我知道我的输入很好......我已经用 imagemagick 的“调整大小”例程完成了这个。“cropStr”是一个字符串，“100x100+10+10”——任何任意值都放在这里。

但我仍然在标准错误中得到错误：

> ```
>  "result" : "convert: unable to open image `ï¿½ï¿½ï¿½ï¿½':  @ error/blob.c/OpenBlob/2587.\nconvert: no decode delegate for this 
> ```
> 
> 图像格式`ï¿½ï¿½ï¿½ï¿½' @ error/constitute.c/ReadImage/532.\nconvert: option requires an argument`-crop' @error/convert.c/ConvertImageCommand/1081.\n"

我尝试输入一个“-format”参数，我认为它会设置输出格式。但随后它抱怨这个论点。

我觉得我在这里遗漏了一些明显的东西。裁剪到图像中的任意矩形应该不难。

任何帮助将不胜感激。

# python - 长时间执行的 Python Paramiko 超时，需要完整输出

> ID：13316134
> 
> 赞同：5
> 
> 时间：2012-11-09T21:15:36.623
> 
> 标签：python, ssh, timeout, paramiko

标题的一部分涉及很多话题，但没有什么能完全满足整个事情。我正在远程服务器上推送一个命令，并且在很长的执行时间（比如 5 分钟左右）后需要完整的输出。使用通道我可以设置超时，但是当我读回标准输出时，我只得到了一小部分输出。解决方案似乎是等待 channel.exit_status_ready()。这适用于成功的呼叫，但失败的呼叫永远不会触发通道超时。查看文档后，我推测这是因为超时仅适用于读取操作，并且等待退出状态不符合条件。这是尝试：

```
channel = ssh.get_transport().open_session()
channel.settimeout(timeout)
channel.exec_command(cmd)  # return on this is not reliable
while True:
    try:
        if channel.exit_status_ready():
            if channel.recv_ready():  # so use recv instead...
                output = channel.recv(1048576)
                break
        if channel.recv_stderr_ready():  # then check error
            error = channel.recv_stderr(1048576)
            break
    except socket.timeout:
        print("SSH channel timeout exceeded.")
        break
    except Exception:
        traceback.print_exc()
        break 
```

漂亮，不是吗？希望它奏效。

我第一次尝试解决方案是使用 time.time() 开始，然后检查 start - time.time() > timeout。这看起来很简单，但在我目前的版本中，我输出 start - time.time() 具有应该触发中断的固定超时......并看到超时时间的两倍和三倍而没有发生中断的差异。为了节省篇幅，我会提到我的第三次尝试，我已经将它卷起来了。我在这里阅读了有关使用 select.select 等待输出的信息，并在文档中指出那里也有超时。正如您将从下面的代码中看到的那样，我混合了所有三种方法——通道超时、time.time 超时和选择超时——但仍然必须终止进程。这是弗兰肯代码：

```
channel = ssh.get_transport().open_session()
channel.settimeout(timeout)
channel.exec_command(cmd)  # return on this is not reliable
print("{0}".format(cmd))
start = time.time()
while True:
    try:
        rlist, wlist, elist = select([channel], [], [],
            float(timeout))
        print("{0}, {1}, {2}".format(rlist, wlist, elist))
        if rlist is not None and len(rlist) > 0:
            if channel.exit_status_ready():
                if channel.recv_ready():  # so use recv instead...
                    output = channel.recv(1048576)
                    break
        elif elist is not None and len(elist) > 0:
            if channel.recv_stderr_ready():  # then check error
                error = channel.recv_stderr(1048576)
                break
        print("{0} - {1} = {2}".format(
            time.time(), start, time.time() - start))
        if time.time() - start > timeout:
            break
    except socket.timeout:
        print("SSH channel timeout exceeded.")
        break
    except Exception:
        traceback.print_exc()
        break 
```

这是一些典型的输出：

```
[<paramiko.Channel 3 (open) window=515488 -> <paramiko.Transport at 0x888414cL (cipher aes128-ctr, 128 bits) (active; 1 open channel(s))>>], [], []
1352494558.42 - 1352494554.69 = 3.73274183273 
```

最上面一行是 select 中的 [rlist, wlist, elist]，最下面一行是 time.time() - start = (time.time() - start)。通过计算迭代次数并在循环 1000 次后在尝试的底部中断，我让这次运行中断。在示例运行中超时设置为 3。这证明我们通过了尝试，但显然，应该超时的三种方式都不起作用。

如果我从根本上误解了某些内容，请随意翻阅代码。我希望这是超级 Pythonic 并且仍在学习。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T21:49:22.833

尽管我仍在测试中，但这可能会有所帮助。在与各种类型的超时（包括 Python 的包罗万象的超时）作斗争之后，并意识到真正的问题是不能信任服务器来终止进程，我这样做了：

```
chan = ssh.get_transport().open_session()

cmd = "timeout {0} {1}\n".format(timeouttime, cmd)

chan.exec_command(cmd) 
```

`timeouttime`如果没有早点退出，服务器就会超时`cmd`，正如我所希望的那样，并且终止的命令会杀死通道。唯一的问题是 GNU coreutils 必须存在于服务器上。没有其他选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T15:22:56.460

我有同样的问题。我认为我们可以通过信号来处理它。[http://docs.python.org/2/library/signal.html](http://docs.python.org/2/library/signal.html)

这是一个简单的例子来展示它是如何工作的。

```
import signal, time                          

def handler(signum, frame):                  
    pass                                     

# Set the signal handler and a 2-second alarm
signal.signal(signal.SIGALRM, handler)       
signal.alarm(2)                              

# This is where your operation that might hang goes
time.sleep(10)                               

# Disable the alarm                          
signal.alarm(0) 
```

所以在这里，闹钟设置为 2 秒。Time.sleep 在 10 秒内被调用。当然，闹钟会在睡眠结束之前触发。如果你在 time.sleep 之后输入一些输出，你会看到程序执行在那里恢复。

如果您希望控件在其他地方继续，请将您的挂起调用包装在 try/except 中，并让您的处理程序函数引发异常。

尽管我很确定它会起作用，但我还没有通过 paramiko 调用对其进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-20T00:50:57.467

我从通道调用 exec_command 时遇到很多问题，而是直接使用 ssh 连接中的 exec_command 并调用 std 输出的通道，对我有用的代码就像**myexec**：

```
#!/usr/bin/env python
import paramiko
import select

def myexec(ssh, cmd, timeout):
  stdin, stdout, stderr = ssh.exec_command(cmd)
  channel = stdout.channel
  stdin.close() #As I don't need stdin
  channel.shutdown_write() #As I will not write to this channel

  stdout_chunks = []
  stdout_chunks.append(stdout.channel.recv(len(stdout.channel.in_buffer)))

  # chunked read to prevent stalls
  while not channel.closed or channel.recv_ready()
        or channel.recv_stderr_ready():

    # stop if channel was closed prematurely,
    # and there is no data in the buffers.
    got_chunk = False
    readq, _, _ = select.select([stdout.channel], [], [], timeout)
    for c in readq:
      if c.recv_ready():
        stdout_chunks.append(stdout.channel.recv(len(c.in_buffer)))
        got_chunk = True
      if c.recv_stderr_ready():
        # make sure to read stderr to prevent stall
        stderr.channel.recv_stderr(len(c.in_stderr_buffer))
        got_chunk = True
    if not got_chunk \
           and stdout.channel.exit_status_ready() \
           and not stderr.channel.recv_stderr_ready() \
           and not stdout.channel.recv_ready():
      # indicate that we're not going to read from this channel anymore
      stdout.channel.shutdown_read() # close the channel
      stdout.channel.close()
      break    # exit as remote side is finished and our bufferes are empty

  # close all the pseudofiles
  stdout.close()
  stderr.close()
  return (''.join(stdout_chunks), stdout.channel.recv_exit_status())

ssh = paramiko.SSHClient()
ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
ssh.connect('remotehost', username='remoteuser', password='remotepassword')
rtrval = myexec(ssh, 'remotecomand', 5*60)
ssh.close()
print rtrval 
```

我使用 Debian 8 和 Python 2.7.13，祝你好运。

# jquery - LI 项和 jQuery 的奇怪 DOM 缓存/刷新问题

> ID：13316136
> 
> 赞同：0
> 
> 时间：2012-11-09T21:15:42.123
> 
> 标签：jquery, caching, refresh, html-lists

我有一个动态注入`<li>`的项目，第一个项目被标记为“.current”类。我在 DOM 中也有“下一个”按钮，它从列表中带有“.current”类的项目加载下一个项目。但是，当我动态重新填充列表时，“下一步”按钮将加载列表中的所有其他项目。如果我再次重新填充列表，下一个按钮将加载列表中的每 3 个项目。List 通过 $.ajax 填充，是一个 json 数据类型。每次我重新填充时，我都会删除所有列表项，如下所示：

```
 $('#playlist').children().remove(); 
```

下一个按钮找到下一个项目，如下所示：

```
 $('#playlist ul').find(".current").nextAll().first().children('a'); 
```

**关于为什么加载列表中的“下一项”会不一致的任何想法/建议？**显然，它也与重新填充列表有关。我在填充列表的 $.ajax 调用中设置了 "cache":false ......

当这种不一致发生时，行为似乎是下一个项目从先前加载的列表中的项目（类“.current”）开始。

小提琴： http: [//jsfiddle.net/unA6h/7/](http://jsfiddle.net/unA6h/7/) （不是我拥有的完整代码，而是让我头疼的部分；列表从 ajax call..json 等填充。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:27:12.913

you are calling `.nextAll()` on the anchor tag which doesn't have any siblings, so `.nextAll()` doesn't get any elements. you need to add `.parent()` before `.nextAll()`. I also made a small optimization below, no point in getting teh id and selecting by id when you already have the element.

```
var next_item = $('#playlist ul').find('.current').parent().nextAll('li[role="normal_item"]').first().children('a');
setItemAsCurrent(next_item); 
```

[http://jsfiddle.net/unA6h/16/](http://jsfiddle.net/unA6h/16/)

# php - 读取或复制文件的多个请求冲突时间

> ID：13316137
> 
> 赞同：0
> 
> 时间：2012-11-09T21:15:49.607
> 
> 标签：php, copy, file-exists

**细节：**

*   PHP版本：5.3.0
*   阿帕奇 2.2.37
*   视窗 XP SP3

我在**TXT**`php error`中创建系统备份错误（和`custom error`），而不是用户数据，而是动态生成的页面。如果您已经生成了**LOG** ，则其他用户不需要像以往那样生成。

 ****我模拟了 10 个并发连接/请求，有时会出现这个错误： **没有这样的文件**

代码：

```
<?php
$p = 'errs/'.$arqErr;
$o = 'temp/'.$arqErr;
if(file_exists($o) && is_readable($o) && is_writable($o)){
    if(!copy($o,$p)){
        echo 'Error copy "',$p,'" to "',$o,'"';
    }
    if(file_exists($o) && is_readable($o) && is_writable($o)){
        unlink($o);
    }
}
?> 
```

有时会发生错误： `Warning: Unable to open 'temp/6039dd66559c9431004109202d279557.php' for reading: No such file or directory`

有时会发生错误： `Warning: Unlink failed (No such file or directory)`

是 PHP_5.3.0 的 bug 吗？

注意：在带有 PHP5.3.4 的 Windows 7 中，不会发生此故障。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:25:39.403

问题似乎是有多个并发用户试图访问相同的文件，这似乎不是与 PHP 相关的问题。

尝试考虑不同的日志记录方案，也许使用[`error_log()`](http://php.net/manual/en/function.error-log.php)可以让 PHP 为您管理并发访问问题的功能。

```
<?php
error_log('Log message', 3, "md5(address of the page).LOG.txt");
?> 
```****

# nodatime - 如何使用 Noda Time 解析多种格式？

> ID：13316142
> 
> 赞同：9
> 
> 时间：2012-11-09T21:16:30.517
> 
> 标签：nodatime

`*Pattern`我喜欢 Noda Time 使用命名空间中的各种类型来处理格式化和解析值`NodaTime.Text`。但是，用户输入通常不像单一格式那样规则。例如，我们的应用程序使用时间格式`"h:mm tt"`，但我们希望能够解析以下任何格式的用户输入：

*   `h:mm tt`
*   `h:mmtt`（没有空间）
*   `h:mm t`
*   `h:mmt`（没有空间）
*   `h tt`
*   `hh:mm`
*   等等...

有没有办法使用 Noda Time 来解析可能是多种格式的输入？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T21:06:21.773

（抱歉这么久才回复。）

令人讨厌的是，看起来我们还没有暴露这一点。

它*出现*在[`CompositePattern`](https://code.google.com/p/noda-time/source/browse/src/NodaTime/Text/Patterns/CompositePattern.cs)课堂上的野田时间。不幸的是，这目前是内部的。我已经提出了[问题 147](https://code.google.com/p/noda-time/issues/detail?id=147)来解决这个问题（可能在 1.1 的时间范围内）。

目前，使用相同的代码可能是最简单的`CompositePattern`——你不需要为此创建自己的`IPattern<T>`实现，因为它只是真正`Parse`有用的方法。（实际上，您甚至可以将它写为 上的扩展方法`IEnumerable<IPattern<T>>`，尽管我不确定我们是否已经提供了足够的可见性来创建相同类型的失败结果。）

# python - Python：为什么 str.join(iterable) 而不是 str.join(*strings)

> ID：13316143
> 
> 赞同：3
> 
> 时间：2012-11-09T21:16:36.450
> 
> 标签：python

我不断地将我的 str.join() 参数包装在一个列表中，例如

```
'.'.join([str_one, str_two]) 
```

额外的列表包装对我来说总是多余的。我想做...

```
'.'.join(str_one, str_two, str_three, ...) 
```

...或者如果我有一个清单...

```
'.'.join(*list_of_strings) 
```

是的，我是一个极简主义者，是的，我很挑剔，但大多数时候我只是对这里的历史感到好奇，或者我是否遗漏了什么。也许在splats之前有一段时间？

编辑：

我只想指出 max() 处理两个版本：

最大值（可迭代[，键]）最大值（arg1，arg2，*args[，键]）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:35:32.027

对于简短的列表，这无关紧要，只需输入 2 个字符即可。但最常见的用例（我认为）`str.join()`如下：

```
''.join(process(x) for x in some_input) 
# or
result = []
for x in some_input:
    result.append(process(x))
''.join(result) 
```

其中 input_data 可以有数千个条目，您只想有效地生成输出字符串。

如果加入接受的变量参数而不是可迭代的，则必须拼写为：

```
''.join(*(process(x) for x in some_input))
# or
''.join(*result) 
```

这将创建一个（可能很长）元组，只是将其作为`*args`.

因此，在短情况下这是 2 个字符，而在大数据情况下是浪费的。

## 历史记录

（第二次编辑：基于[历史](http://svn.python.org/projects/python/trunk/Misc/HISTORY)文件，其中包含所有版本中缺少的版本。谢谢唐。）

`*args`in 函数定义是很久以前在 Python 中添加的：

> ==> 0.9.8 版（1993 年 1 月 9 日）<==
> 
> 需要案例 (a) 来容纳可变长度的参数列表；现在有一个明确的“可变参数”功能（在最后一个参数之前有一个'*'）。为了与旧的类定义兼容，需要案例 (b)：直到 0.9.4 版本，必须将具有多个参数的方法声明为 "def meth(self, (arg1, arg2, ...)): .. ."。

将列表传递给此类函数的正确方法是使用内置函数`apply(callable, sequence)`。（注意，这并没有提到`**kwargs`哪个可以在[1.4 版本的文档中](http://docs.python.org/release/1.4/ref/ref7.html#REF27502)首先看到）。

`*`在 1.6 的发行说明中首次提到了使用语法调用函数的能力：

> 现在可以使用特殊语法代替 apply() 函数。f(*args, **kwds) 等价于 apply(f, args, kwds)。您还可以使用变体 f(a1, a2, *args, **kwds)，并且可以省略其中一个：f( *args), f(* *kwds)。

但是直到[2.2 版的](http://docs.python.org/release/2.2/ref/calls.html#calls)[语法文档中都缺少](http://docs.python.org/release/1.6/ref/calls.html#calls)它。

在 2.0 之前`str.join()`甚至不存在，您必须这样做`from string import join`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T21:21:02.830

您必须编写自己的函数才能做到这一点。

```
>>> def my_join(separator, *args):
        return separator.join(args)

>>> my_join('.', '1', '2', '3')
'1.2.3' 
```

请注意，这并不能避免创建额外的对象，它只是*隐藏*了正在创建的额外对象。如果您检查 args 的类型，您会发现它是一个`tuple`.

如果你不想创建一个函数并且你有一个固定的字符串列表，那么可以使用 format 而不是 join：

```
'{}.{}.{}.{}'.format(str_one, str_two, str_three, str_four) 
```

最好还是坚持`'.'.join((a, b, c))`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T21:43:52.270

啊，现在这是一个很难的问题！尝试争论哪种风格更简约......很难在没有太主观的情况下给出一个好的答案，因为这都是关于惯例的。

问题是：**我们有一个接受有序集合的函数；它应该接受它作为单个参数还是可变长度参数列表？**

* * *

Python 通常会回答：单参数；VLAL 如果你真的有理由这样做。让我们看看 Python 库如何反映这一点：

标准库有几个 VLAL 示例，最值得注意的是：

*   当可以使用**任意数量的单独序列**调用函数时- 如`zip`or`map`或`itertools.chain`,
*   当有一个序列要传递时，但您并不真正期望调用者将整个序列作为单个变量。这似乎很合适`str.format`。

使用单个参数的常见情况：

*   当您想对单个序列进行一些通用数据处理时。这适合函数式三重奏（`map`*、`reduce`、`filter`）和它们的特殊衍生，如`sum`or `str.join`。还有像`enumerate`.
    *   模式是“使用一个可交互对象，给出另一个可迭代对象”或“使用一个可迭代对象，给出一个结果”。

希望这能回答你的问题。

* * *

*注意：`map`从技术上讲是 var-arg，但常见的用例是与and`map(func, sequence) -> sequence`放在一个桶中。`reduce``filter`*

*这个晦涩的案例`map(func, *sequences)`在概念上类似于`map(func, izip_longest(sequences))`- `zip`s 遵循 var-arg 约定的原因之前已解释过。

我希望你在这里遵循我的想法；毕竟这都是编程风格的问题，我只是指出 Python 库函数中的一些模式。

# objective-c - objective-c：变量不是CFString，如何正确地将字符串值分配给对象的属性？

> ID：13316144
> 
> 赞同：-1
> 
> 时间：2012-11-09T21:16:38.927
> 
> 标签：objective-c, ios

```
- (IBAction)start:(UIButton *)sender {
  NSString *t=@"123";   // line 1
  self.detailDescriptionLabel.text=t;
} 
```

语法检查是正确的，但是当我在 iphone 上构建和运行它时，它在第 1 行中断并发送错误消息，如“变量不是 CFString”

如何解决这个问题呢？

当我写这个时它正在工作：

```
- (IBAction)start:(UIButton *)sender {
  self.detailDescriptionLabel.text=nil;
} 
```

我真的认为问题在于如何正确地将字符串常量分配给 UILabel 的文本属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:23:23.840

好吧，这很愚蠢......我错误地按下了shotcut键和一个断点......所以实际上代码中没有错误，只是我在XCode IDE中的错误。

# javascript - 使用 Dojox/Standby 时如何从叠加层中删除透明度？

> ID：13316147
> 
> 赞同：1
> 
> 时间：2012-11-09T21:16:54.727
> 
> 标签：javascript, dojo

当我要去后端获取一些数据时，我正在显示一个微调器图像。微调器小部件的默认行为是在任何控件上创建半透明覆盖 - 是否可以删除半透明以便我只看到微调器而不是字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T21:52:28.330

查看`dojo/widget/Standby` [源代码](https://github.com/dojo/dojox/blob/master/widget/Standby.js)v1.8。有一个不透明度选项。默认值为 0.75。

此属性不影响加载图像。

用法：

```
require(["dojox/widget/Standby"], function (Standby) {
    var standby = new Standby({
          target: 'targetDiv',
          color: '#333',
          opacity: 1 //change opacity to 1 for no transparency
        });

        document.body.appendChild(standby.domNode);
        standby.startup();
        standby.show();
 }); 
```

# python - Python Requests - 根据给定的 curl 请求格式化数据

> ID：13316154
> 
> 赞同：0
> 
> 时间：2012-11-09T21:17:49.850
> 
> 标签：python, http, curl, httprequest, python-requests

```
 $ curl -F myfile=@myfilename -F 'data={"title":"some title","otherinfo" : "aabcdef"}' https://someurl 
```

以上是从终端做的工作和正确的方法。

我尝试以这种方式使用请求在python中实现这一点：

```
files = {'myfile': open('myfilename', 'rb')}
data = {}

data['data'] = {
    'title' : 'some title',
    'otherinfo' : 'other info'
}

r = requests.post(url, files=files, data=data, auth=auth) 
```

在这里，数据没有正确到达目的地，我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:29:12.463

当您使用`-F`参数 curl 发送数据时`Content-Type`set to`multipart/form-data`而当您使用`data`参数 Requests 时使用`Content-Type`set to `application/x-www-form-urlencoded`。您应该指示 Requests 以正确的方式发送数据`Content-Type`。请参阅[如何在 python 中发送带有请求的“multipart/form-data”？](https://stackoverflow.com/q/12385179/95735)这该怎么做。

# php - 在 Wordpress 中出现 500 服务器错误

> ID：13316155
> 
> 赞同：-1
> 
> 时间：2012-11-09T21:17:51.170
> 
> 标签：php, wordpress

我正在尝试为我的下一个 wordpress 主题创建选项，但在这个主题中，我使用选项树插件，几乎 80% 的选项都是 css，所以我创建了一个`style.php`文件并将其添加到标题中，就像其他 css 文件一样。

但我收到 500 服务器错误，如果我直接运行文件，我会收到此错误并出现 500 服务器错误：

> 未声明 HTML 文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。页面的字符编码必须在文档或传输协议中声明。

我的 style.php 文件的代码：

```
<?php ob_start();
    header("Content-type: text/css");
    include("../../../wp-load.php");
    header("HTTP/1.0 200 OK");
?>
<?php
    if(function_exists('ot_get_option')){
?>
body{
    <?php 
        $option = ot_get_option('website_width'); 
        if(isset($option[0]) && isset($option[1])){
            echo "width:".$option[0].$option[1];
        }
    ?>;
}

.span8{
    <?php 
        $option = ot_get_option('width_with_sidebar'); 
        if(isset($option[0]) && isset($option[1])){
            echo "width:".$option[0].$option[1];
        }
    ?>;
}

.span6{
    <?php 
        $option = ot_get_option('content_width_with_two_sidebar'); 
        if(isset($option[0]) && isset($option[1])){
            echo "width:".$option[0].$option[1];
        }
    ?>;
}

.span12{
    <?php 
        $option = ot_get_option('content_width_for_full_width'); 
        if(isset($option[0]) && isset($option[1])){
            echo "width:".$option[0].$option[1];
        }
    ?>;
}

.span6,.span8,.span12{
    <?php 
        $option = ot_get_option('content_margins'); 
        if(isset($option[0]) && isset($option[1])){
            echo "margin:".$option[0].$option[1];
        }
    ?>;
    <?php 
        $option = ot_get_option('content_padding'); 
        if(isset($option[0]) && isset($option[1])){
            echo "padding:".$option[0].$option[1];
        }
    ?>;
}

body{
    <?php
        $option = ot_get_option('style');
        if(isset($option)){
            if($option=='full_width'){
                echo "width:100% !important";
            }
        }
    ?>;
}

#site-title{
    <?php
        $option = ot_get_option('site_title')
        if(isset($option)){
            if(isset($option['font-color'])){
                echo "color:".$option['font-color'].";";
            }
            if(isset($option['font-family'])){
                echo "font-family:".$option['font-family'].";";
            }
            if(isset($option['font-size'])){
                echo "font-size:".$option['font-size'].";";
            }
            if(isset($option['font-variant'])){
                echo "font-variant:".$option['font-variant'].";";
            }
            if(isset($option['font-weight'])){
                echo "font-weight:".$option['font-weight'].";";
            }
            if(isset($option['letter-spacing'])){
                echo "letter-spacing:".$option['letter-spacing'].";";
            }
            if(isset($option['line-height'])){
                echo "line-height:".$option['line-height'].";";
            }
            if(isset($option['text-decoration'])){
                echo "text-decoration:".$option['text-decoration'].";";
            }
            if(isset($option['text-transform'])){
                echo "text-transform:".$option['text-transform'].";";
            }
        }
    ?>
}
<?php
    }
header("HTTP/1.0 200 OK");
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T04:46:28.897

我得到了自己的答案 我在代码中有语法错误，但没有在浏览器中显示，只是显示 500 内部服务器错误

当我改变

```
 $option = ot_get_option('site_title') 
```

到

```
 $option = ot_get_option('site_title'); 
```

它完美无缺

# jquery - 当我只选择子 DIV 时选择父 DIV

> ID：13316160
> 
> 赞同：0
> 
> 时间：2012-11-09T21:18:08.947
> 
> 标签：jquery, html

我有两个 div，一个在另一个里面：

```
<div id="parent">
    <div id="children">
        Click me
    </div>
</div> 
```

​</p>

当我使用 jquery 单击子 div 时，父级也被单击。

```
$(function() {
   $("div").click(function(){
       alert("The id of the selected item is: " + $(this).attr("id"));
   });
});​ 
```

我能做些什么来避免这种情况？这是我的 jsfiddle：http: [//jsfiddle.net/gzpPB/1/](http://jsfiddle.net/gzpPB/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:19:20.327

在您的选择器中更具体：

```
$("#children") instead of $("div") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:16:50.330

最强大的解决方案是简单地给所有点击接受的 DIV 元素一个特定的类。这样，无论它们嵌套在何处或嵌套多深，都只会触发具有“按钮”类的元素。

新代码：

```
<div id="parent">
    <div id="children" class="button">
        Click me
    </div>
</div>

$(function() {
   $(".button").click(function(){
       alert("The id of the selected item is: " + $(this).attr("id"));
   });
});​ 
```

如果您使用的是 jQuery 1.8 或更高版本，则需要这样做：

```
$(function() {
       $(document).on('click', ".button", function(){
           alert("The id of the selected item is: " + $(this).attr("id"));
       });
    });​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:19:40.607

因为您只是针对页面上的 div 元素。

用于`e.target`定位特定的 div。还`e.stopPropagation()`

```
$(function() {
       $("div").click(function(e){
           if( e.target.id == 'children'){
               e.stopPropagation();
               alert("The id of the selected item is: " + $(this).attr("id"));
           }
        });
    }); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/v5CJr/)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T21:20:37.167

像这样使用`.stopPropagation()`：

```
$(function() {
   $("div").click(function(e){
       e.stopPropagation();
       alert("The id of the selected item is: " + $(this).attr("id"));
   });
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/gzpPB/5/)**

[由于冒泡](http://www.w3.org/TR/DOM-Level-3-Events/#dom-event-architecture)，当您单击子 div 时，您的代码会为两个 div 发出警报。对子项的单击会到达父项，然后再次触发 laert，因为您的 jQuery 是针对所有 div，而不是特定 div。您*只能*使用`$("#children")`. 但是，您也可以停止冒泡`stopPropagation()`，当您单击任何 div 而不仅仅是特定的 div 时，这将使您的警报起作用。

# html - 在没有显示表属性的情况下使 div 高度相等

> ID：13316169
> 
> 赞同：0
> 
> 时间：2012-11-09T21:18:45.453
> 
> 标签：html, css

在以下代码中，左侧的两个 div 具有不同的高度（不固定）。`table`有没有办法在不使用 CSS属性或 javascript的情况下使高度较小的 div 的高度等于高度较高的 div 的高度？

PS。没有理由不使用表属性，我只想知道是否有其他选择。

```
<div class="wrap">
    <div class="left">less content</div>
    <div class="right">more content</div>
</div> 
```

**CSS：**

```
.wrap{
    overflow: hidden;
    background: green;
    width: 100px;
    margin: 30px 100px;
}
.left{
    background: yellow;
    width: 50px;  
    float:left;
    overflow: hidden;
}
.right{
    background: brown;
    width: 50px;
    float:left;  
    overflow: hidden;    
} 
```

JSFiddle：http: [//jsfiddle.net/Vv2Ue/](http://jsfiddle.net/Vv2Ue/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:21:30.397

我今天刚刚解决了这个问题。查看以下资源：[http ://www.vanseodesign.com/css/equal-height-columns/](http://www.vanseodesign.com/css/equal-height-columns/)

我喜欢最后一个建议，它基本上创造了等高的错觉。

**html**

```
<div id="container-outer">
    <div id="container-inner">

        <div id="sidebar">
            <p>Sidebar</p>
        </div>

        <div id="content">
            <p>Main content</p>
        </div>

    </div>
</div> 
```

**CSS**

```
#container-outer {
        float:left;
        overflow: hidden;
        background: #eee;
    }

    #container-inner {
        float:left;
        background: #555;
        position: relative;
        right:75%;
    }

    #sidebar {
        float: left;
        width: 25%;
        position: relative;
        left: 75%;
    }

    #content {
        float: left;
        width: 75%;
        position: relative;
        left: 75%   
    } 
```

# browser - 为网页提供本地文件

> ID：13316176
> 
> 赞同：0
> 
> 时间：2012-11-09T21:19:18.450
> 
> 标签：browser, proxy

有一段时间，我无法使用来自 Google 的 CDN 的 jQuery。例如，StackOverflow 网站无法在我的 PC 上运行。谷歌或我的网络已阻止它。`.js`每当浏览器看到该 URL 时，我正在寻找一种从本地副本（或 Microsoft 的 CDN）提供文件的方法。（有点像代理）。我使用谷歌浏览器作为我的主要浏览器，但任何其他浏览器都可以。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:40:06.177

我最终使用了[Fiddler2](http://www.fiddler2.com/fiddler2/)的`Autoresponder`功能。刚刚添加了一个简单的正则表达式，并要求它为我的本地 jQuery 副本提供服务。

# c# - 为什么这会给出该字典类在当前上下文中不存在的预编译错误？

> ID：13316179
> 
> 赞同：0
> 
> 时间：2012-11-09T21:19:22.230
> 
> 标签：c#, compiler-errors

为什么这会给出该字典类在当前上下文中不存在的预编译错误？

![[IMG]http://i67.photobucket.com/albums/h292/Athono/programming/doesnotexistincontext.png[/IMG]](../Images/f23e91d5d239db26333ee3f3c196735a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:20:37.197

C# 区分大小写。变量名为`levelContent`not `levelcontent`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T21:21:18.383

C# 区分大小写

```
 levelcontent != levelContent 
```

# python - 在 Django 模板 {% block %} 标签中使用变量

> ID：13316180
> 
> 赞同：2
> 
> 时间：2012-11-09T21:19:25.343
> 
> 标签：python, django, templates, block

主要问题是我如何以编程方式选择将一些内容放入哪个块。以下是在不同的项目中工作，但在一个新项目中，由于某种原因这不起作用。我在同一台机器上为两个项目使用相同的（默认）模板上下文处理器。

我有一个类似这样的基本模板

```
...
{% block Title %}<h1>Whoo</h1>{% endblock %}

{% block Content %}<p>Hi there</p>{% endblock %}
... 
```

还有一个像这样的扩展模板

```
{% extends "base.html" %}
...
{% block myblock.name %} <p> {{ myblock.content }} </p> {% endblock %}

<p> {{ myblock.name }} </br> {{ myblock.content }} </p>
... 
```

并像这样渲染

```
myblock = { 'name': 'Title', 'content': 'stuff' }
return render_to_response( 'extended.html', {'myblock': myblock}, context_instance=RequestContext(request) ) 
```

我希望得到并开始第一个项目：

```
...
<p> stuff <p>
<p>Hi there</p>
<p> Title </br> stuff </p>
... 
```

但是在我得到的第二个项目中

```
...
<h1>Whoo</h1>
<p>Hi there</p>
<p> Title </br> stuff </p>
... 
```

所以在第二个项目中，myblock dict 由模板传递和处理，但似乎 {% block myblock.name %} 中的 myblock.name 被解释为文字而不是变量。关于如何强制 Django 评估 {% block %} 标签内的变量的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:09:34.747

您应该再看一下关于[模板继承](https://docs.djangoproject.com/en/dev/topics/templates/#template-inheritance)的文档。

> ...块标签定义了子模板可以填充的[...]块。块标签所做的只是告诉模板引擎子模板可以覆盖模板的那些部分。

但是您不会像您尝试做的那样直接在视图中将变量分配给块。

而且 `{% block myblock.name %}`看起来也很奇怪。

要收到您期望的结果，我会说模板应该看起来像这样

```
{% extends "base.html" %}
{% block Title %}<p>{{ myblock.content }}</p>{% endblock %} 
```

* * *

假设您使用的是最新版本的 Django，您甚至可以使用[`render`](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render)视图中的快捷方式来简化操作：

```
return render(request, 'extended.html', {'name': 'Title', 'content': 'stuff'}) 
```

这将导致这样的模板：

```
{% extends "base.html" %}
{% block Title %}<p>{{ content }}</p>{% endblock %} 
```

# java - 如何将公共数据从不同的模式插入到临时表中？

> ID：13316181
> 
> 赞同：1
> 
> 时间：2012-11-09T21:19:26.887
> 
> 标签：java, postgresql

我不知道如何解决这个问题：

我们从各种在线供应商（亚马逊、新蛋等）导入订单信息。每个供应商都有自己的特定术语和订单结构，我们已将其镜像到数据库中。我们的数据毫无问题地导入数据库，但是我面临的问题是编写一个方法，该方法将从数据库中提取所需的字段，而不管模式如何。

例如假设我们有以下结构：

**新蛋结构：**

```
"OrderNumber" integer NOT NULL, -- The Order Number
"InvoiceNumber" integer, -- The invoice number
"OrderDate" timestamp without time zone, -- Create date. 
```

**亚马逊结构：**

```
"amazonOrderId" character varying(25) NOT NULL, -- Amazon's unique, displayable identifier for an order.
"merchant-order-id" integer DEFAULT 0, -- A unique identifier optionally supplied for the order by the Merchant.
"purchase-date" timestamp with time zone, -- The date the order was placed. 
```

**如何选择这些项目并将它们放入临时表中供我查询？**

临时表可能如下所示：

```
"OrderNumber" character varying(25) NOT NULL,
"TransactionId" integer,
"PurchaseDate" timestamp with time zone 
```

我知道一些数据库代表一个带有整数的订单号，而另一些则代表一个不同的字符；为了处理这个问题，我计划将数据类型转换为字符串值。

有没有人建议我阅读这将帮助我解决这个问题？

**我不需要一个确切的答案，只是朝着正确的方向轻推。**

这些数据将由 Java 使用，因此如果有任何特定的 Java 类有帮助，请随时提出建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T00:28:30.700

首先，您可以创建一个[`VIEW`](http://www.postgresql.org/docs/current/interactive/sql-createview.html)来提供此功能：

```
CREATE VIEW orders AS
SELECT '1'::int            AS source -- or any other tag to identify source
      ,"OrderNumber"::text AS order_nr
      ,"InvoiceNumber"     AS tansaction_id -- no cast .. is int already
      ,"OrderDate" AT TIME ZONE 'UTC' AS purchase_date -- !! see explanation
FROM   tbl_newegg

UNION  ALL  -- not UNION!
SELECT 2
       "amazonOrderId"
      ,"merchant-order-id"
      ,"purchase-date"
FROM   tbl_amazon; 
```

您可以像查询任何其他表一样查询此视图：

```
SELECT * FROM orders WHERE order_nr = 123 AND source = 2; 
```

*   如果不是唯一的，`source`则 是必需的。`order_nr`您还如何保证不同来源的唯一订单号？

*   A`timestamp without time zone`在全球范围内是模棱两可的。它仅与时区有关。如果您混合`timestamp`and `timestamptz`，您需要将`timestamp`与构造一起放置在某个时区`AT TIME ZONE`以使其工作。有关更多解释，请阅读[此相关答案](https://stackoverflow.com/questions/9571392/ignoring-timezones-altogether-in-rails-and-postgresql/9576170#9576170)。

    我使用 UTC 作为时区，您可能想提供一个不同的时区。一个简单的演员`"OrderDate"::timestamptz`将假定您当前的时区。`AT TIME ZONE`应用于 中的`timestamp`结果`timestamptz`。这就是为什么我没有添加其他演员。

*   虽然*可以，但我建议**永远*不要在 PostgreSQL 中使用驼峰式标识符。避免了多种可能的混淆。请注意我提供的小写标识符（没有现在不必要的双引号）。

*   不要`varchar(25)`用作`order_nr`. `text`如果它必须是一个字符串，只需使用不带任意长度修饰符。如果所有订单号仅由数字组成，`integer`或者`bigint`会更快。

### 表现

实现这一速度的一种方法是将视图具体化。即，将结果写入（临时）表：

```
CREATE TEMP TABLE tmp_orders AS
SELECT * FROM orders;

ANALYZE tmp_orders; -- temp tables are not auto-analyzed!

ALTER TABLE tmp_orders
ADD constraint orders_pk PRIMARY KEY (order_nr, source); 
```

你*需要*一个索引。在我的示例中，主键约束自动提供索引。

如果您的表很大，请确保在创建临时表*之前*在 RAM 中有足够的*临时缓冲区来处理它。*否则它实际上会减慢你的速度。

 *```
SET temp_buffers = 1000MB; 
```

必须是会话中对临时对象的第一次调用。不要在全局范围内将其设置为高，仅用于您的会话。无论如何，临时表会在会话结束时自动删除。

要估算您需要多少 RAM，请创建一次表并测量：

```
SELECT pg_size_pretty(pg_total_relation_size('tmp_orders')); 
```

[在 dba.SE 上](https://dba.stackexchange.com/q/23879/3684)的这个相关问题下有更多关于对象大小的信息。

仅当您必须在一个会话中处理多个查询时，所有开销才会支付。对于其他用例，还有其他解决方案。如果您在查询时知道源表，那么将查询定向到源表会快得多。如果你不这样做，我会再次质疑你的独特性`order_nr`。事实上，如果它保证是唯一的，您可以删除`source`我介绍的列。

对于只有一个或几个查询，使用视图而不是物化视图可能更快。

我还会考虑一个**plpgsql 函数**，它一个接一个地查询一个表，直到找到记录。考虑到开销，对于几个查询可能会更便宜。当然需要的每个表的索引。

另外，如果你坚持`text`或`varchar`为你的`order_nr`，考虑[`COLLATE "C"`](http://www.postgresql.org/docs/current/interactive/sql-expressions.html#SQL-SYNTAX-COLLATE-EXPRS)一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T23:42:40.830

听起来您需要创建一个抽象类来定义与数据交互的基础知识，然后为您需要访问的每个数据库模式派生一个类。这将允许核心代码对单个对象类型进行操作，然后每个实现都可以以特定于该数据库模式的形式指定查询。

就像是：

```
public class Order
{
    private String orderNumber;
    private BigDecimal orderTotal;
    ... etc ...
}

public abstract class AbstractOrderInformation
{
  public abstract ArrayList<Order> getOrders();
  ...
} 
```

使用新蛋类：

```
public class NeweggOrderInformation extends AbstractOrderInformation
{
   public ArrayList<Order> getOrders() {
      ... do the work of getting the newegg order
   }
 ...
} 
```

然后您可以拥有任意数量的格式，当您需要信息时，您可以遍历所有实现并从每个实现中获取订单。*

# r - R将邮政编码或纬度/经度转换为县

> ID：13316185
> 
> 赞同：29
> 
> 时间：2012-11-09T21:19:41.383
> 
> 标签：r, geolocation, geocoding

我有一个位置列表，其中包含每个位置的城市、州、邮编、纬度和经度。

我单独有一份县级经济指标清单。我玩过`zipcode`包、`ggmap`包和其他几个免费的地理编码网站，包括 US Gazeteer 文件，但似乎找不到匹配这两个部分的方法。

目前是否有任何软件包或其他来源可以做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-20T13:36:45.470

我最终使用了`JoshO'Brien`上面提到的建议并在[此处](https://stackoverflow.com/questions/8751497/latitude-longitude-coordinates-to-state-code-in-r/8751965#8751965)找到。

`state`我把他的代码改成`county`如下所示：

```
library(sp)
library(maps)
library(maptools)

# The single argument to this function, pointsDF, is a data.frame in which:
#   - column 1 contains the longitude in degrees (negative in the US)
#   - column 2 contains the latitude in degrees

latlong2county <- function(pointsDF) {
    # Prepare SpatialPolygons object with one SpatialPolygon
    # per county
    counties <- map('county', fill=TRUE, col="transparent", plot=FALSE)
    IDs <- sapply(strsplit(counties$names, ":"), function(x) x[1])
    counties_sp <- map2SpatialPolygons(counties, IDs=IDs,
                     proj4string=CRS("+proj=longlat +datum=WGS84"))

    # Convert pointsDF to a SpatialPoints object 
    pointsSP <- SpatialPoints(pointsDF, 
                    proj4string=CRS("+proj=longlat +datum=WGS84"))

    # Use 'over' to get _indices_ of the Polygons object containing each point 
    indices <- over(pointsSP, counties_sp)

    # Return the county names of the Polygons object containing each point
    countyNames <- sapply(counties_sp@polygons, function(x) x@ID)
    countyNames[indices]
}

# Test the function using points in Wisconsin and Oregon.
testPoints <- data.frame(x = c(-90, -120), y = c(44, 44))

latlong2county(testPoints)
[1] "wisconsin,juneau" "oregon,crook" # IT WORKS 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-09T22:19:01.303

将邮政编码与县匹配是困难的。（某些邮政编码跨越多个县，有时跨越一个州。例如 30165）

我不知道任何可以为您匹配这些的特定 R 包。

但是，您可以从密苏里人口普查数据中心获得一张漂亮的表格。
您可以使用以下内容进行数据提取：[http ://bit.ly/S63LNU](http://bit.ly/S63LNU)

示例输出可能如下所示：

```
 state,zcta5,ZIPName,County,County2
    01,30165,"Rome, GA",Cherokee AL,
    01,31905,"Fort Benning, GA",Russell AL,
    01,35004,"Moody, AL",St. Clair AL,
    01,35005,"Adamsville, AL",Jefferson AL,
    01,35006,"Adger, AL",Jefferson AL,Walker AL
    ... 
```

注意县2。元数据解释可以在[这里](http://mcdc.missouri.edu/pub/data/georef/zcta_master.Metadata.html)找到。

```
 county 
    The county in which the ZCTA is all or mostly contained. Over 90% of ZCTAs fall entirely within a single county.

    county2 
    The "secondary" county for the ZCTA, i.e. the county which has the 2nd largest intersection with it. Over 90% of the time this value will be blank. 
```

另见 ANSI 县代码 [http://www.census.gov/geo/www/ansi/ansi.html](http://www.census.gov/geo/www/ansi/ansi.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-12-01T21:37:02.700

I think the package "noncensus" is helpful.

corresponding is what I use to match zipcode with county

```
### code for get county based on zipcode

library(noncensus)
data(zip_codes)
data(counties)

state_fips  = as.numeric(as.character(counties$state_fips))
county_fips = as.numeric(as.character(counties$county_fips))    
counties$fips = state_fips*1000+county_fips    
zip_codes$fips =  as.numeric(as.character(zip_codes$fips))

# test
temp = subset(zip_codes, zip == "30329")    
subset(counties, fips == temp$fips) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-21T20:56:44.803

一个简单的选项是使用`geocode()`函数 in `ggmap`, 与选项`output="more"`或`output="all`。

这可以采用灵活的输入，例如地址或纬度/经度，并将地址、城市、县、州、国家、邮政编码等作为列表返回。

```
require("ggmap")
address <- geocode("Yankee Stadium", output="more")

str(address)
$ lon                        : num -73.9
$ lat                        : num 40.8
$ type                       : Factor w/ 1 level "stadium": 1
$ loctype                    : Factor w/ 1 level "approximate": 1
$ address                    : Factor w/ 1 level "yankee stadium, 1 east 161st street, bronx, ny 10451, usa": 1
$ north                      : num 40.8
$ south                      : num 40.8
$ east                       : num -73.9
$ west                       : num -73.9
$ postal_code                : chr "10451"
$ country                    : chr "united states"
$ administrative_area_level_2: chr "bronx"
$ administrative_area_level_1: chr "ny"
$ locality                   : chr "new york"
$ street                     : chr "east 161st street"
$ streetNo                   : num 1
$ point_of_interest          : chr "yankee stadium"
$ query                      : chr "Yankee Stadium" 
```

Another solution is to use a census shapefile, and the same `over()` command from the question. I ran into a problem using the maptools base map: because it uses the WGS84 datum, in North America, points that were within a few miles of the coast were mapped incorrectly and about 5% of my data set did not match up.

try this, using the `sp` package and Census TIGERLine shape files

```
counties <- readShapeSpatial("maps/tl_2013_us_county.shp", proj4string=CRS("+proj=longlat +datum=NAD83"))

# Convert pointsDF to a SpatialPoints object 
pointsSP <- SpatialPoints(pointsDF, proj4string=CRS("+proj=longlat +datum=NAD83"))

countynames <- over(pointsSP, counties)
countynames <- countynames$NAMELSAD 
```

# ruby-on-rails - rails 3.0 routing - 重定向全局路由

> ID：13316187
> 
> 赞同：1
> 
> 时间：2012-11-09T21:19:58.257
> 
> 标签：ruby-on-rails, routes

在我的路由文件中，我们最初设置了这个路由：

```
 match '/search/*tag' => 'search#search' 
```

我们现在要从 url 中删除单词“search”。所以我添加了一条新路线：

```
match '/*tag' => 'search#search' 
```

这一切都很好。我们想更新旧路线以重定向到新路线，以保持 seo 和书签正常工作。

```
 match '/search/*tag' => redirect {|params| "/#{params[:tag]}"} 
```

然而，这是该术语的复数形式。

```
Input url: www.fubar.com/search/work
Becomes:   www.fubar.com/works 
```

是什么导致了这种情况，我如何阻止它使标签复数？

可能相关：我们需要使用 /*tag 而不是 /:tag 因为我们有时有一个标签列表。即 www.fubar.com/work/web/video

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:29:00.103

事实证明，一旦我清除了缓存，一切正常。浏览器记得 301 重定向（我忘记了这一点，显然一直在为之前损坏的重定向提供服务。

```
match '/search/*tag' => redirect { |params| "/#{params[:tag]}" }
match '/*tag' => 'search#search' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:50:42.560

我所能推荐的就是在块内填充 Rails.logger.debug{ params.inspect } 以进行重定向。这至少会让你开始调试它。当您偏离快乐的道路时，Rails 路由可能会变得棘手和脆弱，并且知道问题是在识别中（即 *tags 的匹配是复数形式）还是在路由中（重定向的结果是复数形式）将是第一个看的地方。

# php - PHP形式的蜜罐被打败了

> ID：13316188
> 
> 赞同：0
> 
> 时间：2012-11-09T21:20:06.870
> 
> 标签：php, forms, honeypot

所以我有一个基本的 PHP 表单蜜罐。看起来像 ..

```
$honeypot = $_POST['honeypot'];    
if($honeypot)
     $error = "You are a bot";
else{ 
```

并且输入蜜罐是显示：隐藏。从技术上讲，它有效，已经工作了一年多，但最近垃圾邮件机器人已经开始击败它。我的猜测是机器人意识到它是一个隐藏的领域，我知道还有其他一些方法可以做到这一点。我可以使该字段可见但很小，与背景颜色相同，将其放置在页面之外。但我想获得一些关于其他人关于什么是最有效的经验的意见。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T21:22:16.210

您可以通过使用 JavaScript 完全删除该字段来实现相同的效果。

不管你做什么，它都可以被机器人打败。如果有人花 5 分钟手动调整他们的机器人以适应您的表单，则尤其如此。此外，越来越多的机器人运行完整的 webkit 浏览器实例，它们将像“真实”用户一样执行 JavaScript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T21:27:24.573

除了使用`display: hidden`，您可以尝试使用类似的东西来隐藏输入`position: absolute; top: 100%`，或者甚至只是删除边框并将其混合到背景中。我也会考虑从 更改名称`honeypot`，因为这是一个已知术语。

一些复杂的机器人可能仍然能够绕过它，但基本上在所有情况下都是如此。如果您不收到垃圾邮件至关重要，您可以使用验证码（我讨厌验证码并且不会向用户推荐它们——在我看来它们太侵入性了），但有些机器人甚至可以击败验证码。如果您收到很多提交，您可能不得不容忍一点垃圾邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-26T21:37:57.347

您可以尝试使用标签标记该字段以供机器人使用，使该字段完全可见。不幸的是，这对于真实用户来说有些不便。我还没有理由尝试这个。错误可能会说“谢谢，但不允许机器人输入”（注意很好的“谢谢”;-)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-09T21:22:41.310

最好使用验证码（尽管我讨厌它们）。

如果这只是一个联系表格，请尝试使用`$_POST['password'];`. 机器人会将其检测为正常、有效的字段并填写。蜜罐太明显了。

# ruby-on-rails - carrierwave：在虚拟属性上挂载上传器

> ID：13316189
> 
> 赞同：2
> 
> 时间：2012-11-09T21:20:12.557
> 
> 标签：ruby-on-rails, ruby, attributes, carrierwave, uploader

我正在使用具有两个属性的或多或少的通用属性模型：key 和：value。该值是一个字符串属性，可以用作依赖于父对象的上传者。如何使用该属性作为普通字符串属性安装上传器？我试图创建这样的东西：

```
def imagelink 
  self.value
end

def imagelink=(value)
 self.value=value
end

mount_uploader :imagelink, MyUploaderClass 
```

但这最终会导致 active_record 错误，因为 imagelink-property 不是真正的 active_record 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:04:12.880

在尝试使用 rails_admin gem 时，我必须使其他几个属性可访问，以使通用上传功能正常工作， :img_small_cache 和 :remove_img_small 虚拟属性也是因为只有 :img_small 将文件字符串存储在数据库中

```
mount_uploader :img_small, ProductImgSmallUploader
attr_accessible :img_small, :img_small_cache, :remove_img_small 
```

也许它有助于找到答案

# jquery - Jquery Mobile AutoComplete POST 添加参数

> ID：13316191
> 
> 赞同：4
> 
> 时间：2012-11-09T21:20:25.057
> 
> 标签：jquery, jquery-mobile

我正在尝试对[此处](https://github.com/commadelimited/autoComplete.js)找到的 jquery mobile 使用 Andy Matthews 自动完成功能。我的客户端服务有一个使用参数的方法。我不确定如何更改客户端调用以接受参数？

这是我的客户端调用：

```
 //WHERE DO I PUT INPUT PARAMETERS??

   $("#searchBox").autocomplete({
                method: 'POST',
                target: $('#suggestions'),
                source: "ClientService.svc/REST/GetStates",
                link: 'target.html?term=',
                minLength: 1

            }); 
```

这是我的服务：

```
 [OperationContract]
        [WebInvoke(Method = "POST", RequestFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest, ResponseFormat = WebMessageFormat.Json)]
        public List<string> GetStates(string y)
        {
            List<string> x= GetData(y);
            return x;

        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T17:20:05.160

查看[源代码](https://github.com/commadelimited/autoComplete.js/blob/master/jqm.autoComplete-1.4.3.js)后，该插件似乎不允许传递自定义`POST`参数。用户在框中输入的内容是在一个名为 的参数中发送的`term`，但是如果您无法修改您的服务，我会做的是修改以下代码部分：

```
...
} else {
$.ajax({
    type: settings.method,
    url: settings.source,
    // Change the following line
    // data: { term: text },
    // for:
    data: { y: text },
... 
```

它很容易找到，因为`$.ajax`整个插件中只有一个调用。

# ios - UIScrollView 在进入 UIPageViewController 时不滚动

> ID：13316195
> 
> 赞同：2
> 
> 时间：2012-11-09T21:20:42.000
> 
> 标签：ios, uigesturerecognizer, uipageviewcontroller

我正在尝试使用 UIScrollView 作为 PageViewController 的内容视图，我已经配置了 Page 控制器，因为它在 xcode 的示例项目中。

问题是内容有一个滚动视图，但它根本不滚动，我已经设置了滚动视图的内容大小和属性。我猜它配置正确。

```
- (UIScrollView *)scrollView
{
    if (_scrollView == NULL) {
        _scrollView = [[UIScrollView alloc] init];
        _scrollView.backgroundColor      = [UIColor whiteColor];
        _scrollView.scrollEnabled        = TRUE;
        _scrollView.alwaysBounceVertical = TRUE;
    }
    return _scrollView;
} 
```

然后，我将视图的手势附加到 UIPageViewController 手势数组中，这会阻止导航栏正常运行，因此我对以下内容进行了验证：

```
gestureRecognizerShouldBegin: 
```

现在可以了。

我不知道如何解决这个问题：S

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:54:54.753

试试这个

```
 [scrollmngmt setScrollEnabled:YES];
 [scrollmngmt setContentSize:CGSizeMake(320, 1200)];

 [self setScrollmngmt:nil]; 
```

# .net - 有没有办法将 DBCommand.Connection 传递给 SQLConnection？

> ID：13316196
> 
> 赞同：0
> 
> 时间：2012-11-09T21:20:46.993
> 
> 标签：.net, sqlconnection

我正在处理一个对象，该对象以 DBCommand.Connection 的形式连接到数据库，另一个对象以 SQLConnection 的形式连接到数据库。

持久安全性已关闭，因此我无法创建新的 SQLConnection，因为密码已被剥离，有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:29:07.313

如果我正确理解您的问题，您是在问如何将[`DbCommand.Connection`](http://msdn.microsoft.com/en-us/library/system.data.common.dbcommand.connection.aspx)属性（类型为`DbConnection`）转换为`SqlConnection`.

由于您[`SqlConnection`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)的继承`DbConnection`可以简单地相应地转换它：

```
SqlConnection con = (SqlConnection) dbCommand.Connection; 
```

当然，这假设 the`DbConnection`实际上是一个`SqlConnection`.

# android - 编译 C++ 源代码以将 .off 文件转换为 Android OpenGL ES 可读的 XML 的问题

> ID：13316198
> 
> 赞同：1
> 
> 时间：2012-11-09T21:20:54.353
> 
> 标签：android, c++, c, opengl-es

我在 Stackoverflow 上找到了一种将 3D 模型导入 Android OpenGL 的方法：

[有没有办法将 3D 模型导入 Android？](https://stackoverflow.com/questions/204363/is-there-a-way-to-import-a-3d-model-into-android)

尝试按照说明复制源代码并尝试编译程序。我得到了大量的错误，这里只是一个小样本：

```
 /tmp/ccPavSpL.o:OFF-OpenGL_loader.cc:(.text+0xd): undefined reference to `std::basic_string<char,
    std::char_traits<char>, std::allocator<char> >::size() const' 
```

我认为问题是我没有向程序传递参数，所以我尝试像这样传递参数：

```
 $  gcc OFF-OpenGL_loader.cc circle.off output.xml 
```

（我的 .off 文件与其他源文件位于同一目录中，并且 output.xml 也在同一文件中。）我收到了这些错误

```
 /usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld:circle.off: file format not recognized;
    treating as linker script
    /usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld:circle.off:2: syntax error
    collect2: ld returned 1 exit status 
```

无论如何，所以我觉得我不应该有一个 output.xml 文件，但是当我没有一个时，它给了我一个找不到文件的错误。

开源文件不在实际文件中，所以我觉得我应该向您展示我所有的文件，并且我觉得将其他人的源代码上传到 github 存储库很奇怪，所以这里是源文件的快速共享链接：

[http://d01.megashares.com/dl/2YylIbE/SourceCodeAnd.offFile.zip](http://d01.megashares.com/dl/2YylIbE/SourceCodeAnd.offFile.zip)

我觉得像这样共享文件很奇怪^^但我真的没有看到任何其他选择。它只包含我的 .off 文件和 .xml 文件以及 C 和 C++ 文件。

任何帮助将不胜感激，过去几天我一直坚持这一点。谢谢！

**编辑**

所以我用 g++ 运行它，没有参数，结果如下：

```
 $  g++ OFF-OpenGL_loader.cc
     /tmp/ccNFneYn.o:OFF-OpenGL_loader.cc:(.text+0x1aa): undefined reference to  
     `ReadFile::getExtension(char*)'/tmp/ccNFneYn.o:
    OFF-OpenGL_loader.cc:(.text+0x2f8): undefined reference to 
    operator>>(std::basic_ifstream<char, std::
    char_traits<char> >&, ReadFile&)'/tmp/ccNFneYn.o:OFF-
    OpenGL_loader.cc:(.text+0x6de): undefined reference to `ReadFile::ReadFile()'/tmp/ccNFneYn.o:OFF-
    OpenGL_loader.cc:(.text+0x6f9): undefined reference to `ReadFile::~ReadFile()'/usr/lib/gcc/i686-pc-
    cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: 
    /tmp/ccNFneYn.o: bad reloc address 0x1c in section 
    `.gcc_except_table'/usr/lib/gcc/i686-pc-cygwin/3.4.4/.
    ./../../../i686-pc-cygwin/bin/ld: final link failed: 
    Invalid operationcollect2: ld returned 1 exit status 
```

我在寻找什么样的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T00:37:46.753

问题是当我在 Visual Studio 中运行我的程序时，它会编译和运行程序，并且因为源需要运行参数，所以会出现运行时错误。

然后因为我不知道如何将参数传递给 Visual Studio 中的程序，我尝试使用 Cygwin，它给了我错误，可能是因为它没有正确配置。不太确定为什么会发生这些错误。

因此，为了解决这整个问题，我刚刚使用 Visual Studio 构建了我的程序，导航到它在编译时创建的 .exe 文件，然后在命令行中运行该 .exe。

**所以这个故事的寓意是：**永远记住，当你点击那个绿色的播放按钮时，它会编译和运行程序。因此，如果您的错误与您运行程序的环境有关，即使您的代码非常好，您也可能会出错。

感谢 Bo Persson 帮助我获得了这个想法！

# jquery - jquery列表，保持活动突出显示

> ID：13316199
> 
> 赞同：0
> 
> 时间：2012-11-09T21:20:58.520
> 
> 标签：jquery, css, listview, drop-down-menu

我想出了一个新的方法来做我的清单，但是有几个问题......这是代码：http: [//jsfiddle.net/mstngsal67/GuE99/5/](http://jsfiddle.net/mstngsal67/GuE99/5/) 我试图理解为什么左边的菜单项目，当点击时，只有当我将鼠标悬停在它上面时才会保持粗体......如果我移开，它会变回来。我在css中尝试了很多不同的东西，但没有任何效果......我需要在js中做这个吗？？？这是我的代码的一部分，但去 jsfiddle 有一切......

```
<ul class="mainMenus"> 
<li onclick='showSubMenu("sm_item1")'>education 
      <ul class="subMenus" id="sm_item1" style="top:0px"> 
             <li><a href="careers.html"class="text7">careers</a></li> 
             <li><a href="careers.html"class="text7">careers</a></li> 
             <li><a href="careers.html"class="text7">careers</a></li> 
             <li><a href="careers.html"class="text7">careers</a></li> 
      </ul> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:28:49.757

您可以创建另一个 CSS 类，并在 li 元素处于活动状态时打开和关闭它（使用 jQuery）。

试试看这里：

[单击链接jquery时更改活动li](https://stackoverflow.com/questions/1343178/change-active-li-when-clicking-a-link-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:30:27.427

由于此行，顶级列表项（例如 Education）在悬停时显示为粗体：

```
.mainMenus li:hover { 
    font-size: 14px;
    font-weight: bold;
    color: #5e883c;
    font-family: arial;
} 
```

列表项是否被点击并不重要——只要你的鼠标悬停在元素上，它就会保持绿色和粗体。此外，由于您的子菜单位于顶级列表项中，因此当您将鼠标悬停在子菜单上时，您也将鼠标悬停在顶级列表项上。

如果您希望顶级列表项在单击后显示为粗体，则需要在 showSubMenu 函数的顶级列表项中添加一个类名。

# java - 试图弄清楚如何将对象从 jEditable 数据表插件发送到我的 Java Servlet

> ID：13316209
> 
> 赞同：1
> 
> 时间：2012-11-09T21:21:32.443
> 
> 标签：java, javascript, post, datatables, jeditable

我创建了一个数据表，我正在使用 jeditable 插件来编辑单元格以推回数据。我可以编辑单元格，但是当我按 Enter 并将其发送回我的 URL Rest 端点（我只有一个 System.out.println 来查看数据）时，我从 firebug 收到此错误

> “NetworkError: 415 Unsupported Media Type -**我的休息端点 url** ”

我的端点期待 JSON 中的对象，jeditable 仅发送一些字符串参数。所以我需要把它包起来。让我发布我的数据表初始化以及 jeditable init。

```
var computerTable = $("#table_computerTable ").dataTable({
           "bProcessing": true,
           "bServerSide": true,
           "bInfo":false,
           "bAutoWidth":false,
           "bScrollInfinite":true,
           "sAjaxSource": ApiUrl(),
           "aoColumns":[       // Maps <th> elements in html to JSON data
               {"mData": "id"},
               {"mData": "description","sClass" : "read_only"},
               {"mData": "serial"},
               {"mData": "daily"}
             ],
           "aoColumnDefs":[
               {"sName":"id","bVisible":false, "aTargets": [0]},
               {"sWidth": "55%","aTargets": [1]},
               {"sName":"serial","bVisible":false, "aTargets": [2]},
               {"sName":"daily","aTargets":[3]}
             ],
            "fnServerData": function ( sSource, aoData, fnCallback ) {
                   $.getJSON( sSource, aoData, function (json) { 
                       map = {};
                       map["aaData"] = json;
                       fnCallback(map);
                   });
            },
            "fnRowCallback": function(nRow, aData, iDisplayIndex ){
                $(nRow).attr("id",aData["id"]); // Change row ID attribute to match database row id
                return nRow;
            }
        }).makeEditable({
            sUpdateURL: getApiUrl() + "cpu/save",
            sReadOnlyCellClass: "read_only",
            ajaxoptions:{
                dataType: "json",
                type: 'POST'
            }
        }); 
```

这是我发送 POST 时返回的数据（从萤火虫读取）

```
columnId    3
columnName  daily
columnPosition  2
id  24
rowId   0
value   50 
```

我想做的是初始化一个对象，然后发回我想要的所有数据。ID / Serial / Hourly（新值）

我不知道足够的 jquery，javascript 知道从哪里开始修改。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T11:54:31.030

像这样编辑您的 makeEditable：

```
makeEditable(
{
  sUpdateURL: function(value, settings)
  {
    var sentObject = {}
    var rowId = oTable.fnGetPosition(this)[0];
    var columnPosition = oTable.fnGetPosition(this)[1];
    var columnId = oTable.fnGetPosition(this)[2];
    var sColumnTitle = oTable.fnSettings().aoColumns[columnId].sTitle; 
    sentObject["rowid"]= rowId
    sentObject["columnpos"]= columnPosition
    sentObject["columnId"]= columnId
    sentObject["sColumnName"]= sColumnTitle
    sentObject["valueOfCell"]=value
    sentObject["Serial"]="serialnumber"
    sentObject["Hourly"]="somevalue"
    $.ajax({
    type: "POST",
    url: "url",
    data: "sentObj="+JSON.stringify(sentObject)
    })
    return value;
  },
  sSuccessResponse: "IGNORE"
 }
); 
```

这就像更新单元格的 ajax 请求的自定义。

# android - SOAP 过时了吗？

> ID：13316213
> 
> 赞同：3
> 
> 时间：2012-11-09T21:21:43.220
> 
> 标签：android, ios, web-services, soap, windows-8

我希望向 Android、iOS 和 Windows 8/Windows Phone 开放我的 PHP 网站。

我一直在查看 PHP SOAP 库，我已经开始工作了。

虽然我已经这样做了，但我看到人们在网上发布 SOAP 已经“过时”。

是吗，如果是的话，有什么替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:27:14.560

SOAP 在设计和使用时通常非常“繁重”，并且它基于 XML。对于更轻量级的方法，您可能希望查看更易于实现、采用并且可以纯粹基于 JSON 的 REST 样式 API，这使得通过 Javascript/客户端技术使用这些服务变得容易：

[https://en.wikipedia.org/wiki/REST](https://en.wikipedia.org/wiki/REST)

尽管 SOAP 可能有很好的用例 - 但我认为您会发现这些主要用于重型企业应用程序。

# ember.js - Ember.js 数组属性更改未带来所需的模板更新

> ID：13316222
> 
> 赞同：2
> 
> 时间：2012-11-09T21:22:22.573
> 
> 标签：ember.js

不要介意这段代码使用完整路径和其他东西。那些会改变的！

我有这个控制器代码：

```
App.ProductsOneController.reopenClass({
    product: {
        images: []
    }
}); 
```

然后是一个在其模板中有这个的视图：

```
{{#each image in App.ProductsOneController.product.images}}
    <li class="small-image">
        <img src="{{unbound image}}-small.png" />
    </li>
{{/each}} 
```

我想要做的是显示根据图像数组的内容更新的图像列表。

当我做这样的事情时：

```
imageUrl = response.data.folder + response.data.imagedId;
tempImages = Ember.get(App.ProductsOneController, "product.images");
tempImages.unshift(imageUrl);
Ember.set(App.ProductsOneController, "product.images", tempImages); 
```

什么都没发生。视图未更新。

如果我离开，然后返回到相同的状态（我们在这里只讨论 pushstate），则视图会更新。

我试图从控制台更改值。当我将其设置为 时`[]`，所有图像都会根据需要消失。如果我尝试将它设置为非空数组，有时它会起作用，有时它会给我一个类型错误，提到一个未定义的 childView。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T15:28:16.913

正如@sly7_7 所指出的，您错误地使用了 Ember。您需要将您绑定`srcBinding`到控制器的实例，而不是类。

`reopenClass`用于在类对象上设置函数或数据。使用它对你来说没有意义。为了使绑定起作用，您希望与实例而不是类进行交互。

```
// We are treating App.Controller is a class
App.Controller = Ember.Controller.extend();

// We are treating App.controller as an instance
App.controller = App.Controller.create(); 
```

所以你的代码应该是这样的。

```
App.controller = Ember.Controller.create({ image: 'blah' }); 
```

接着

```
{{view App.ImageView srcBinding="App.controller.image"}} 
```

现在，当您更改 App.controller.image 时，绑定将更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T11:28:09.957

我一直在挖掘很多东西，并发现了一些关于我做错了什么的事情。

一是绑定。首先，我在那里有一个未绑定的东西，这使得事情没有得到更新。其次，我应该使用 ImageView。

我开始这样做，将它与 srcBinding 一起使用。但它仍然不起作用。我不知道我是否仍然做错了什么，或者这是一个错误。

```
App.ImageView = Ember.View.extend({
    tagName: 'img',
    attributeBindings: ['src']
});

{{view App.ImageView srcBinding="App.ProductsOneController.firstImage"}} 
```

但是更新仍然没有发生。实际上，一切都以相同的方式工作：当我更改 firstImage 属性时，什么也没有发生。如果我离开并返回相同的状态，那么我可以看到代码中的变化。

# ajax - 为什么无法通过 ajax 上传文件

> ID：13316223
> 
> 赞同：0
> 
> 时间：2012-11-09T21:22:26.040
> 
> 标签：ajax, http, file-upload

我试图了解为什么 fileupload 不适用于 ajax，必须有任何方法可以在不刷新页面的情况下异步上传文件。刷新页面并不总是需要的。有时，我在这里需要的东西也是其他人非常需要的，我看到了很多关于这个问题的问题，我只是出于好奇而询问文件上传无法在 ajax 中工作**的原因。**

有人可以解释一下为什么以及其他选择是什么？

感谢阅读

# sql-server - sql server 2012 上的 invoke_ascmd

> ID：13316229
> 
> 赞同：2
> 
> 时间：2012-11-09T21:22:56.493
> 
> 标签：sql-server, sql-server-2012

我正在尝试通过 SSIS 任务创建一个本地多维数据集。使用早期版本的 sql server 我使用`ascmd`. 我找不到`ascmd`sql server 2012，所以我使用`invoke-ascmd`. 但是，当我使用 -Server 选项指向本地多维数据集时，它会出错并显示以下消息：

> 警告WarningCode="-1055653884" Description="metadata管理器出错。ID为''的数据库在ID为'\LocalCube'的服务器中不存在，或者用户没有访问权限物体。” 来源="Microsoft SQL Server 2012 分析服务"

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T13:30:32.370

这似乎仅在我从 sql server 2008 迁移项目时发生。仅迁移分析服务器项目，并更改数据源中的连接字符串值、构建、部署和重新创建 xmla 脚本似乎还不够。我实际上需要去分析服务器项目删除多维数据集、数据源等并重新创建它们，然后重新创建 xmla 脚本。

# python-3.x - 如何将二进制字符串转换为其数值等价物？

> ID：13316231
> 
> 赞同：-1
> 
> 时间：2012-11-09T21:23:03.477
> 
> 标签：python-3.x

我`toBase10(101)`想吐出来`5`。我还需要它来处理除 101 之外的数字，我知道 python 中内置了一个二进制转换器，但我无法弄清楚。

现在我有

```
def toBase10(x):
    int( 'x' , 2 ) == x
    return x 
```

我得到错误无法转换具有显式基数的非字符串。为什么我不能在这里使用 x ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:33:10.083

```
def toBase10(x):
    return int(x, 2) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-05T18:59:11.823

我将整数转换为字符串，然后转换为二进制，我可以轻松地将其转换为整数：

```
def binaryconvert(x): 
    x = str(x) 
    binarynumber = int(x, base=2)
    convertnumber = int(binarynumber)
return convertnumber

print(binaryconvert(101))
#the answer would be 5 
```

如果您的输入已经是二进制的，还有另一种方法：

```
def binaryconvert(x):
    convertnumber = int(x)
    return convertnumber

x = int(input("Input: "),2)
print(binaryconvert(x)) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T21:34:36.813

尝试

```
def toBase10(item):
     return int(str(item),2) 
```

那么你可以传递字符串或整数

```
 print toBase10(101)
    print toBase10('101') 
```

我认为 int cast 错误是因为您传入的是数字而不是字符串，尽管这看起来很奇怪 --> "int( x , 2 ) == x"

# perl - Perl Term::ReadLine::Gnu 信号处理困难

> ID：13316232
> 
> 赞同：5
> 
> 时间：2012-11-09T21:23:12.960
> 
> 标签：perl, readline, signal-handling

我正在使用 Term::ReadLine::Gnu 并且遇到了信号处理问题。给定下面的脚本和发送到脚本的 TERM 信号，TERM 信号的处理程序直到按下回车键*后才会触发。*使用 Term::ReadLine:Perl 不会发生这种情况。

我读过 Term::ReadLine::Gnu 有自己的内部信号处理程序，但坦率地说，我不知道如何使用它们。

我已经查看了[http://search.cpan.org/~hayashi/Term-ReadLine-Gnu-1.20/Gnu.pm#Term::ReadLine::Gnu_Variables](http://search.cpan.org/~hayashi/Term-ReadLine-Gnu-1.20/Gnu.pm#Term::ReadLine::Gnu_Variables)尝试将 rl_catch_signals 变量设置为 0，但这没有帮助. 理想情况下，我想使用 Gnu 信号处理程序，但我也会满足于禁用它们。

具体来说，我需要在收到信号后触发 TERM 处理程序，而不是等待按下回车键。

任何帮助或建议当然不胜感激！

```
#!/usr/bin/perl

use strict;
use warnings;
use Term::ReadLine;

$SIG{TERM} = sub { print "I got a TERM\n"; exit; };

my $term = Term::ReadLine->new('Term1');
$term->ornaments(0);
my $prompt = 'cmd> ';
while ( defined (my $cmd = $term->readline($prompt)) ) {
    $term->addhistory($cmd) if $cmd !~ /\S||\n/;
    chomp($cmd);
    if ($cmd =~ /^help$/) {
        print "Help Menu\n";
    }
    else {
        print "Nothing\n";
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T20:26:57.560

这是由于 perl 对信号的默认偏执处理 - 在幕后，perl 在开始`readline`调用之前阻止 SIGTERM 并在结束时恢复它。有关详细信息，请参阅[perlipc](http://perldoc.perl.org/perlipc.html#Deferred-Signals-%28Safe-Signals%29)中的延迟信号。

`Term::ReadLine::Perl`使用 perl 的 IO，它知道这些问题并处理它们，所以你看不到这个 bug。 `Term::ReadLine::Gnu`使用 C 库，它没有，所以你这样做。

您可以使用以下两种方法之一解决此问题：

1.  `unsafe`在运行脚本之前将环境变量 PERL_SIGNALS 设置为，如下所示：

    ```
    bash$ PERL_SIGNALS=unsafe perl readline-test.pl 
    ```

    注意，`BEGIN { $ENV{PERL_SIGNALS} = "unsafe"; }`这还不够，它需要在 perl 本身启动之前设置。

2.  使用`POSIX`信号函数：

    ```
    #~ $SIG{TERM} = sub { print "I got a TERM\n"; exit; };
    use POSIX;
    sigaction SIGTERM, new POSIX::SigAction sub { print "I got a TERM\n"; exit; }; 
    ```

    以上两种方法似乎都适用于 Linux；不能代表 Windows 或其他 unices。此外，上述两种情况都存在风险 - 有关详细信息，请参阅 perlipc。

# matlab - 使用 Matlab 在多个数组中查找具有相同标题的行并删除所有其他行

> ID：13316235
> 
> 赞同：1
> 
> 时间：2012-11-09T21:23:39.767
> 
> 标签：matlab

在 Matlab 中，我有几个已加载并转换为矩阵的 txt 文件。这些矩阵代表了世界各地不同城市的温度数据。每个矩阵的第一列是一年。每个文件跨越不同的年份范围，但它们都重叠了其中的几年。我想找到重叠的位置，然后提取（或删除不重叠的年份），这样当我绘制数据时，每个数据集都使用相同的年份跨度。该代码应该能够摄取未知数量的这些 txt 文件。我曾尝试使用“相交”功能，但这将在逐个元素的基础上起作用。我想要重叠年份的所有数据，因此元素（标题除外）会有所不同。

当前代码示例：

```
clear all 
files = dir('.txt'); 
num_files = length(files); 
mintersect(files); 
for i=1:num_files 
    eval(['load ' files(i).name ' -ascii']); 
    vals{i} = load(files(i).name); 
    matrix = vals{i}; 
    station = (files(i).name(1:end-4)); 
    matrix(matrix == 999.9) = NaN; 
    matrix(matrix == -99.0) = NaN; 
    years = matrix(:,1); 
    months = matrix(:,2:13)'; 
    figure, hold on 
    plot(years, months,''); 
    ylabel('Temp.'); 
    xlabel('Years'); 
    grid on; 
    title(sprintf('Mean Monthly Temperature for %s Station',station)); 
end 
```

# ruby - 正则表达式拆分逗号分隔的字符串

> ID：13316236
> 
> 赞同：1
> 
> 时间：2012-11-09T21:23:41.680
> 
> 标签：ruby, regex

如何按以下字段拆分（这是 sql 格式）？以前我只用'，'分割，如果该字符序列在引号内，它会失败。不幸的是，我也不能用引号分割，因为数字没有。

```
mystring = "(1, 'data, ', 'data_two, ', 'Test 34', '', 'gb', 1, '1')"
mystring.split(', ') 
```

我需要得到

```
'1'
'data'
'data_two, '
'Test 34'
''
'gb'
'1'
'1' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:10:27.393

`CSV`如果你去掉括号，你可以使用with 选项强制它成为可解析的。

```
CSV.parse_line(mystring[1..-2], {:col_sep=>", ", :quote_char=>"'"})

 => ["1", "data, ", "data_two, ", "Test 34", "", "gb", "1", "1"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T02:25:27.837

这可能会有所帮助：

```
irb(main):001:0> mystring
=> "(1, 'data, ', 'data_two, ', 'Test 34', '', 'gb', 1, '1')"
irb(main):002:0> mystring.scan(/(?:'(?:\\.|[^'])*'|[^,' ])+/)
=> ["(1", "'data, '", "'data_two, '", "'Test 34'", "''", "'gb'", "1", "'1')"] 
```

或者，如果您需要删除引号和大括号，则：

```
irb(main):003:0> mystring.scan(/([^', ()]+)|'([^']*)'/).flatten.compact
=> ["1", "data, ", "data_two, ", "Test 34", "", "gb", "1", "1"] 
```

这将匹配任何非引号/大括号/逗号/空格字符，或单个“引号”内的任何内容。（请注意，`\x`与第一个示例不同，第二个示例中没有考虑转义序列（）。但可能是您不需要这样的复杂性。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:29:08.800

```
mystring.split(/,/).map{|x| x.gsub(/[()\']/,'').strip}
 => ["1", "data", "", "data_two", "", "Test 34", "", "gb", "1", "1"] 
```

# asp.net - 将复选框定义为在 checkboxlist 中选中

> ID：13316237
> 
> 赞同：0
> 
> 时间：2012-11-09T21:23:46.877
> 
> 标签：asp.net, vb.net

我不知道如何在页面加载期间在复选框列表中设置某些复选框的“选中”值。到目前为止，我有这个，但它不起作用。

```
 For Each DataRow As DataRow In groupDataset().Tables(0).Rows
        Dim i As Integer
        For i = 0 To cblGroups.Items.Count - 1
            Response.Write(cblGroups.DataValueField)
            If DataRow("memberID").ToString = cblGroups.DataValueField Then
                cblGroups.Items(i).Selected = True
            End If
        Next
    Next 
```

这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:54:11.460

尝试这个。您需要查看复选框列表中的每个项目，而不是组本身的数据值字段。

```
 For Each DataRow As DataRow In groupDataset().Tables(0).Rows
    Dim i As Integer
    For i = 0 To cblGroups.Items.Count - 1
      Response.Write(cblGroups.Items(i).Value)
      If DataRow("memberID").ToString = cblGroups.Items(i).Value Then
    cblGroups.Items(i).Selected = True
      End If
    Next
  Next 
```

# c++ - 在 C++ 中使用 opengl 旋转魔方面的问题

> ID：13316239
> 
> 赞同：2
> 
> 时间：2012-11-09T21:23:47.417
> 
> 标签：c++, opengl, 3d, rotation, rubiks-cube

作为作业的一部分，我必须设计**功能**性魔方。我没有直接使用openGL，而是提供了一个框架。（**所有不属于 openGL 且未在此处列出其主体的函数都将被假定为正确的**）

功能：如果通过按键选择所有面，则需要旋转。整个立方体必须旋转。

**整个立方体的旋转是正确的，并没有成为这个问题的主题。**

为了做到这一点，我从 27 个较小的立方体（立方体大小为 3）和一个三维数组创建了魔方。包含小型多维数据集索引的多维数据集副本。为了更好地理解这一点：

如果最初的一张脸是：

```
0 1 2
3 4 5
6 7 8 
```

旋转后应该是：

```
6 3 0
7 4 1
8 5 2 
```

我可以相对于 X 轴或 Y 轴无限次旋转立方体，并且效果很好。但是，如果我组合旋转（以随机方式交替 X 旋转和 Y 旋转），就会出现立方体变形的情况。由于这种情况不一致，我很难找到原因。

这就是我创建立方体的方式：

```
int count = 0;

for (int i = -1; i < 2; i++)
    for(int j = -1; j < 2; j++)
        for(int k = -1; k < 2; k++)  {
            RubikCube.push_back(drawCube());
            RubikCube.at(count)->translate(4*i,4*j,4*k);
            CubIndici[j+1][k+1][i+1] = count;

            count++;
        } 
```

函数 drawCube() 有效地绘制了一个中心位于原点的大小为 4 的立方体。CubIndici 是我用来存储立方体位置的 3D 数组。

这是我用来旋转 3D 数组中的矩阵的函数。（我已经仔细检查过它应该是正确的，但也许我遗漏了一些东西）。

```
void rotateMatrix(int face_index, int axis) {
    if (axis == 0 ) 
    {
            for ( int i = 0; i < 3; i++)
                for( int j = i; j < 3; j++) 
                 {
                      swap(&CubIndici[i][j][face_index],&CubIndici[j][i][face_index]);
                 }
            for (int i = 0; i < 3; i++)
                for(int  j = i; j < 3; j++) 
                 {
                     swap(&CubIndici[i][j][face_index],&CubIndici[2-i][j][face_index]);
                 }
    }

        if (axis == 1 ) 
    {
            for ( int i = 0; i < 3; i++)
                for( int j = i; j < 3; j++) 
                 {
                      swap(&CubIndici[face_index][i][j],&CubIndici[face_index][j][i]);
                 }
            for (int i = 0; i < 3; i++)
                for(int  j = i; j < 3; j++) 
                 {
                     swap(&CubIndici[face_index][i][j],&CubIndici[face_index][2-i][j]);
                 }
    }
} 
```

CubIndici 3d 数组是全局的，所以我需要轴参数来确定要执行哪种旋转（相对于 X、Y 或 Z）

在按下 w 键时，我应该围绕轴 X 旋转一个（硬编码，现在）面

```
for (int i = 0; i < 3; i++)
                for(int j = 0; j < 3; j++)
                    RubikCube.at(CubIndici[i][j][1])->rotateXRelativeToPoint(
                                          RubikCube.at(CubIndici[1][1][1])->axiscenter, 1.57079633);
            rotateMatrix(1,0); 
```

CubIndici [1](https://i.stack.imgur.com/HkxIw.jpg) [1](https://i.stack.imgur.com/HkxIw.jpg)应始终包含位于面 CubIndici[*][*] [1](https://i.stack.imgur.com/HkxIw.jpg)中心的立方体。

相似地，

```
 for (int i = 0; i < 3; i++)
            for(int j = 0; j < 3; j++)
                RubikCube.at(CubIndici[2][i][j])->rotateYRelativeToPoint(
                                          RubikCube.at(CubIndici[2][1][1])->axiscenter, 1.57079633);
        rotateMatrix(2,1); 
```

用于在 Y 轴上旋转。

**1.57079633 是相当于 90 度的弧度**

为了更好地理解，我添加了在 X 轴上旋转左面和在 Y 轴上自上而下旋转的详细显示。

[![图像](../Images/d5e53167828e2042458763db98fd89d5.png)](https://i.stack.imgur.com/HkxIw.jpg)

第一个坐标块是初始立方体面。（CubIndici 索引矩阵未修改）

预旋转 - 面部每个立方体的坐标和索引。post rotatie - 旋转对象后的坐标和索引。（未触及矩阵）旋转矩阵后 - 在旋转矩阵之后。如果你比较“pre rotatie”和“post rotatie matrice”的索引，你会注意到 90 度旋转。

这是第一次旋转（围绕 X 旋转左脸），它是完全正确的。

然而，在下一次旋转中，应该包含在自上而下的面（以及左侧）中的立方体应该是 2、5、8。但是，它们显示为 2,5,6。如果您查看第一个“旋转后矩阵”，则 2、5、8 确实是第一行。

这是使立方体变形的问题，我不知道是什么原因造成的。

如果有任何不清楚的地方，请告诉我，我会编辑帖子或回复评论！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:29:59.293

`<x;y>`对于立方体切片中某个位置的单元格，PI/2 顺时针旋转的公式是：

```
 x' = 2 - y
  y' = x 
```

同样，对于逆时针旋转：

```
 x' = y
  y' = 2 - x 
```

但这些是轮换，你想对你的数组进行就地修改。我们可以用 2 个镜像对称性的组合来代替旋转。

顺时针：

```
 <x;y>  ->  <y;x> 
  <x;y>  ->  <2-x;y> 
```

而逆时针是这些功能的相反组成。

给定这些公式，您可以像这样编写旋转函数：

```
 void rotateMatrix_X_CW(int face_index) {
     int i,j;  
     for ( i = 0; i < 2; i++)
         for( j = i; j < 3; j++) 
         {
             swap(CubIndici[i][j][face_index],CubIndici[2-i][j][face_index]);
         }
     for ( i = 0; i < 2; i++)
         for( j = i; j < 3; j++) 
         {
             swap(CubIndici[i][j][face_index],CubIndici[j][i][face_index]);
         }
 }

 void rotateMatrix_X_CCW(int face_index) {
     int i,j;  
     for ( i = 0; i < 2; i++)
         for( j = i; j < 3; j++) 
         {
             swap(CubIndici[i][j][face_index],CubIndici[j][i][face_index]);
         }
     for ( i = 0; i < 2; i++)
         for( j = i; j < 3; j++) 
         {
             swap(CubIndici[i][j][face_index],CubIndici[2-i][j][face_index]);
         }
 } 
```

您应该能够从那里实现其他轴。

# jquery - jQuery 验证——在输入用户输入并且字段至少模糊一次之前不验证

> ID：13316242
> 
> 赞同：2
> 
> 时间：2012-11-09T21:24:05.270
> 
> 标签：jquery, jquery-validate

如果您查看此表单： [http ://docs.jquery.com/Plugins/Validation#Example](http://docs.jquery.com/Plugins/Validation#Example)

您会注意到一个问题：在您在任何文本框中输入单个按键后，它会立即触发字段验证。例如，如果您开始在电子邮件字段中输入内容，在一次击键后您将收到验证错误。

这似乎与示例表单下方的描述性文本直接矛盾，该文本说：

> 在字段被标记为无效之前，验证是懒惰的：在第一次提交表单之前，用户可以在字段之间切换而不会收到烦人的消息 - 在他有机会实际输入正确值之前他不会被窃听
> 
> 一旦一个字段被标记为无效，它就会被急切地验证：一旦用户输入了必要的值，错误消息就会被删除
> 
> 如果用户在未标记的字段中输入了某些内容，并且标签/点击远离它（模糊字段），则它被验证 - 显然用户有意输入某些内容，但未能输入正确的值

这描述了所需的行为——在用户 a) 提交表单或 b) 将数据输入字段并模糊该字段之前，没有“烦人的错误消息”。但演示中实际发生的是验证是在第一次击键后触发的，而不是在字段模糊后触发的。因此，用户会被“烦人的错误消息”轰炸，这会分散他的注意力。我们想要快乐的用户，而不是烦恼的用户 :-)

如何获得文本中描述的行为，而不是演示中的行为？

谢谢！

-乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:32:54.860

默认行为是进行实时验证。要覆盖它，只需添加一个参数

onkeyup:false 像这样

```
 $(document).ready(function(){
    $("#commentForm").validate({
      "onkeyup":false
      });
  }); 
```

这是[演示](http://jsfiddle.net/tCVky/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T18:02:06.417

就我而言，只要您“输入”输入字段，我就不必做任何事情来阻止消息。

我正在使用表单验证 jQuery 插件。

这是我的代码示例，它仅在您在输入中写入内容时验证。如果您写了一些东西然后将其删除，那么在这种情况下，“必填信息”字段将出现：

**js片段**

```
 form2.validate({
                 rules: {
                    name: {
                      required: true,
                      minlength: 2,
                      maxlength: 50,
                    },

                    lastname: {
                      required: true,
                      minlength: 2,
                      maxlength: 50,
                    },
                        }
                  },

            highlight: function (element) { // hightlight error inputs
                $(element)
                    .closest('.help-inline').removeClass('ok'); // display OK icon
                $(element)
                    .closest('.control-group').removeClass('success').addClass('error'); // set error class to the control group
            },

            unhighlight: function (element) { // revert the change done by hightlight
                $(element)
                    .closest('.control-group').removeClass('error'); // set error class to the control group
            },
 }); 
```

然后，如果您想在输入中“着陆”后立即显示消息，则可以对焦点进行验证：[就像在这个 jsfiddle 示例中一样](http://jsfiddle.net/ZfLrk/2/)

**片段**

```
 onfocusout: function (element) {
       $(element).valid();
    }, 
```

# objective-c - (void(^)(id) 在 Objective-C 中代表什么？

> ID：13316247
> 
> 赞同：1
> 
> 时间：2012-11-09T21:24:31.697
> 
> 标签：objective-c, syntax

我是 Objective-C 的新手，看到该方法有一个类似的参数

```
onArgument:(void(^)(id)) argument 
```

你能帮我解释一下吗`(void(^)(id))`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:26:08.977

这是一个代码块。[在这里检查](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxGettingStarted.html#//apple_ref/doc/uid/TP40007502-CH7-SW1)

简单地说，这意味着您可以编写小代码并将其传递给该函数。例如，这是一个记录对象类的简单块：

```
void (^myBlock)(id) = ^(id) {
    NSLog(@"class: %@", [id class]);
}; 
```

括号中的 id 表示，您的块将接收一个 id 作为参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T21:26:37.700

`void(^)(id)`是一个[块](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)。您可以在[文档](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/00_Introduction.html)中阅读所有相关信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T21:32:59.960

一个 VOID 类型的块，带有一个 ID 类型的参数

# php - 向特定数量的用户显示某些内容并跳过其他一些内容

> ID：13316248
> 
> 赞同：0
> 
> 时间：2012-11-09T21:24:38.167
> 
> 标签：php, math, if-statement, for-loop

我在设置一些东西时遇到了一点问题。假设我有这个简单的页面：

```
<html>
<body>
<?php echo "hello"; ?>
</body>
</html> 
```

在我的数据库中，我有一个带有访客计数器的表格，现在该计数器归零。

我想要做的是，仅向某些访问者显示此 Hello 消息，更准确地说，使用如下规则：

> 显示 5 人，跳过​​ 3 人，然后显示下 5 人，再跳过下 3 人...

并继续走这条路。抱歉愚蠢，但我想我可以用多个数字做一些事情，我只是在设置 if、foreach 等时遇到问题......

好吧，如果有人可以帮助我，我会很高兴的。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:36:31.063

好的，接缝你开始学习，所以我会在伪 php 代码中给你一个提示，你可以做什么：

```
<?php
  $countFromDb = getCoundFromDB();
  if ($countFromDb % 8 != 0 && $countFromDb % 8 != 7 && $countFromDb % 8 != 6) {
    echo "hello";
  }
  increaseCoundFromDB();
?> 
```

比你需要使用像[mySQL](http://www.mysql.de/)或[SQLite](http://www.sqlite.org/)这样的数据库来存储值。

*   mySQL： http: [//php.net/manual/de/book.mysql.php](http://php.net/manual/de/book.mysql.php)
*   SQLite： http: [//php.net/manual/de/book.sqlite.php](http://php.net/manual/de/book.sqlite.php)
*   PostgreSQL： http: [//php.net/manual/de/book.pgsql.php](http://php.net/manual/de/book.pgsql.php)

*您应该关心的是，如果用户刷新页面，这不会再次使用 cookie 或存储客户端 IP。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:53:17.347

不需要foreach。

第一步，设置一个计数器$i。每次加载页面时，都会增加此计数器。然后 ：

```
$i++
If ($i < 5) {
  echo "hello";
} else if ($i > 8) {
  $i = 0;
} 
```

第二步，更进一步……尝试检测会话 ID 或 IP 地址。然后，每次您检测到不同的会话时，都会像上面一样增加计数器。

希望对你有帮助！如果您需要更多详细信息，请告诉我。

# sql - 可选参数值被忽略

> ID：13316250
> 
> 赞同：3
> 
> 时间：2012-11-09T21:24:59.243
> 
> 标签：sql, sql-server

遇到这个问题，不知道为什么不行。

我有一个具有可选第二个参数的存储过程。

```
PROCEDURE [dbo].[gsp_MyProC] @Account_Number VARCHAR(10), @Referral_Type VARCHAR(5) ='1' 
```

现在，`@Referral_Type`在 SQL 语句中使用，目前从未被传递到过程中（遗留代码，不要问）。但是，有时它不会设置为 1，它只是留给`null`（通过返回参数进行验证）。

如果我使用：

```
SET @Referral_Type = 1 
```

在存储过程中，它总是被设置（正如预期的那样）。

但是有谁知道为什么默认值不会设置为 1？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:41:18.413

不提供参数和为参数提供值是有区别`NULL`的...

```
EXEC dbo.gsp_MyProC 'AccountNumber', NULL 
```

会导致`@Referral_Type = NULL`

然而...

```
EXEC dbo.gsp_MyProC 'AccountNumber' 
```

会导致`@Referral_Type = '1'`

您的客户端库很可能提供了一个`NULL`价值，而不是根本不提供任何价值。

作为一种解决方法...如果`@Referral_Type`永远不应该`NULL`，您可以`SET @Referral_Type = ISNULL(@Referral_Type, '1')`在存储过程的开头添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:27:36.647

请记住，如果要更改参数，则必须在 SP 的定义中使用 OUTPUT 修饰符。此外，您在调用的定义中创建了一个输出参数。

* * *

您的回答没有任何意义——

```
 SET @Referral_Type = 1 
```

应该是非法的，因为常量 1 不是字符串。

正如您在问题中所描述的那样，我希望它永远不会设置为`1`- 它始终会设置为`'1'`

也许您总是在查看结果的“第一个”元素数组（或`s[1]`）？这将始终为 null，因为字符串在 c、c++ 和 C# 中以 null 结尾

# session - 会话状态在此上下文中不可用 - 在 Global.asax

> ID：13316252
> 
> 赞同：13
> 
> 时间：2012-11-09T21:25:12.087
> 
> 标签：session, state, global-asax

我收到“在此上下文中不可用的会话状态”错误。

![在此处输入图像描述](../Images/400782e8c36a6f33a7062da1b6c1a8dd.png)

该错误嵌套在 Global.asax 文件中许多方法的 sender 参数中：

*   Application_BeginRequest
*   Application_AuthenticateRequest
*   会话开始
*   应用程序错误

该错误发生在第一个页面加载（以及之后的所有页面加载）上。

我在项目中添加了一个全新的空白页面 WebForm1.aspx，并将其作为我的起始页面。

**您会认为在空白页面**上不会出错。据我所知，在加载空页面时，没有执行我的代码。但我仍然收到会话状态错误。

我的项目工作得很好。不显示错误页面。任何时候都没有不正确的行为。

但是这个会话错误出现在我当前项目的 sender 参数中的事实让我感到不安。此错误**不会**在空白的新项目中生成。

我当前项目中出现此错误的原因可能是什么？

如何追踪错误发生的位置？我无法在底层的 ASP.NET 代码中设置*断点*。或者我可以吗？

这是我的会话配置：

```
<pages enableSessionState="true" />
<sessionState mode="InProc" cookieless="false" timeout="20" /> 
```

**更新：**

我刚刚发现一个全新的空白项目在 sender 对象中也有这个错误。它在 Application_BeginRequest 和 Application_AuthenticateRequest 方法中可见。但是空白项目没有像我的其他项目一样生成 Application_Error 事件。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-09T21:29:04.820

您在周期中过早地请求会话状态。您需要在**Application_AcquireRequestState中进行**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-09T21:30:47.173

“如果一棵树倒在森林里而周围没有人听到它，它会发出声音吗？”

不要在它不可用的时候观看 Session 属性。

# android - android - 用户在默认录音机中点击停止后返回活动

> ID：13316262
> 
> 赞同：1
> 
> 时间：2012-11-09T21:26:00.567
> 
> 标签：android, audio, android-intent

我使用以下命令启动默认录音机：

```
Intent intent = new Intent(MediaStore.Audio.Media.RECORD_SOUND_ACTION);
            startActivityForResult(intent, soundVal); 
```

这很好用，但是当用户点击停止按钮时，系统会提示他们播放声音，然后允许录制更多声音。我希望录音机在用户按下停止按钮后立即关闭并返回到我的活动，以便我可以使用已创建的声音文件做我需要的事情。这甚至可能吗？如果没有，那么我想我需要构建自己的自定义记录器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:41:30.517

我认为您是对的，您可能需要编写自己的自定义记录器，或者扫描 SDCard 以查看是否可以找到文件（有风险）。

要编写自己的自定义记录器，您有多种选择：

1.  根据许可证找到一个开源的，作为库包含在您的应用程序中
2.  从头开始编写自己的（可能需要一段时间，并且有你没有想到的错误）
3.  使用 Eclipse、反编译器和 dex2jar 对现有的进行逆向工程

您可以尝试做的另一个选择是监控 SDCard，如果最近添加了任何新的声音文件，您会知道它很可能来自默认的录音机......但是，这种方法有点受限因为有些设备不会将他们的语音文件写入 SDCard（尽管我认为大多数设备都会这样做）。

# php - PDO 未获取行结果

> ID：13316265
> 
> 赞同：-2
> 
> 时间：2012-11-09T21:26:18.897
> 
> 标签：php, mysql, pdo

我使用了旧的 mysql 脚本并尝试将其转换为更安全的 PDO 格式。在我的旧脚本中，我运行了一个**SELECT field FROM table**语句，然后将其放入变量 $Product = $row['product']; 并运行 IF 和 ELSE 语句。如果用户产品 = 索尼我想回应“你可能也对这些感兴趣”这是我下面的示例代码

```
<?php
$connect = mysql_connect("host","username","password");
mysql_select_db("dbname");

$username = $_SESSION['username'];

$q = "SELECT product FROM users WHERE username = ('$username')";

$r       = mysql_query($q);
$row     = mysql_fetch_assoc($r);
$Product = $row['product'];

if($Product == "sony")
{
  echo "You may be interested in these as well"; 
}
?> 
```

现在使用 PDO 语句，您似乎无法像以前那样轻松运行相同类型的语句。我尝试将变量分配给我的查询从中选择的行产品，但出现错误：

> 不能将 PDOStatement 类型的对象用作数组

这是我的代码

```
<?php
session_start();

$db = new PDO('mysql:host=host;dbname=dbname;charset=UTF-8', 'username', 'password');

$username = $_SESSION['username'];
$getProduct = $db->query("SELECT product FROM users  WHERE username = '$username'");
$getProduct->execute();

$Product = $getProduct['product'];

if($Product == "sony")
{
  echo "You may be interested in these as well"; 
}

?> 
```

如何将我选择的表中的“产品”字段传递给带有 PDO 的变量，并且**如果产品 =“索尼”回显“消息”；** ?

我也尝试用这个替换语句，但没有成功。

```
<?php
$query = $db->query("SELECT product FROM users  WHERE username = '$username'");
$query->execute();

$Product = $query ->fetchAll(PDO::FETCH_ASSOC);

$Product = $getProduct['product'];

if($Product == "sony")
{
    echo "You may be interested in these as well"; 
}

?> 
```

该手册在将旧语句转换为更新和安全的语句方面不是很友好，所以我很感激这方面的任何指导，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:32:52.617

采用

```
$query->fetch(PDO::FETCH_ASSOC); 
```

得到 1 行和

```
$query->fetchAll(PDO::FETCH_ASSOC); 
```

获取所有行

你期待一排，所以使用第一排。

# javascript - 冲突的 jQuery 插件

> ID：13316266
> 
> 赞同：2
> 
> 时间：2012-11-09T21:26:18.777
> 
> 标签：javascript, jquery, hover, mosaic

我首先想说的是，这个网站对我非常有用，因为我在业余时间一直在学习网络编码。我决定注册，因为我有一个具体的问题想问。

我正在开发我的新网站和一个特定的测试页面 ( [www.owenprescott.com/home.html](http://www.owenprescott.com/home.html) )。我遇到了一个问题，希望有人可以帮助我。我有一个 jQuery 插件，它在我的缩略图图像上创建悬停效果，并且内联代码导致问题 (jquery.dirinline.js)，该函数针对我的 (li) 框并说... *$('.da-拇指 > li').hoverdir();*

问题是我有几个白框，项目信息包含在 (li) 标签中。我不希望上面的 jQuery 函数影响白框。如果您访问我的网站，当您将鼠标悬停在白框上时，您会看到问题所在。对于某些输入，我会非常满意，要么我需要更改 jQuery 函数，要么从白色信息框中删除 (li) 标签，但是我不确定如何让它们以任何一种方式正确显示。

我希望我没有让这个问题变得混乱，并提前感谢您的任何建议。此外，如果您对改进我的代码有任何建议，请随时告诉我，这将是我的模板页面，我知道我仍然需要删除默认的 Dreamweaver 信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:35:06.993

您的 JS 可以更改为：

```
$('.da-thumbs > li > a').parent().hoverdir(); 
```

它应该按原样与 HTML 一起工作。您要排除的那些将匹配`li>div`，但不是`li>a`，因此获取锚点然后选择它们的父项将仅获得您需要的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:31:39.600

因此，将它们从匹配集中排除。用于`not()`删除它们。

```
$('.da-thumbs > li').not(".someClassInfoThingy").hoverdir(); 
```

或者检查那些信息块是否永远不会有链接，你可以做

```
$('.da-thumbs > li:has(a)').hoverdir(); 
```

# html - 可以使用表格进行帖子格式化吗？

> ID：13316268
> 
> 赞同：-1
> 
> 时间：2012-11-09T21:26:33.473
> 
> 标签：html, css

基本上我正在制作一个在我的网站上发布的功能，我只是想要你们的意见：你认为使用表格来格式化帖子是否可以（对齐个人资料图片和帖子？如果不是，你怎么办？推荐？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:27:34.073

如果不是表格数据，则**没有**. 如果它可以用 div 来完成，那么用 div 来做 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T21:28:56.870

除了表格数据之外，表格永远不应该用于任何事情。

我建议阅读 inline-block

# magento - magento：如何从首页的常规选项卡自动显示自定义属性

> ID：13316273
> 
> 赞同：1
> 
> 时间：2012-11-09T21:26:58.340
> 
> 标签：magento

当我们上传一个产品时，有一个默认属性设置为“默认”，在常规选项卡中，有许多默认属性，如下图所示： ![在此处输入图像描述](../Images/ffa0467976b2fef629d0687a1f82adfd.png)

好吧，我添加了一个名为“size”的自定义属性，当我将“size”拖到左侧的常规选项卡时，这意味着产品还有一个属性。如果我想在前端页面的产品视图页面中显示尺寸属性，我必须输入代码：“$_product->getAttributeText('size')”，如果我添加了很多自定义属性，我必须输入很多代码是手动的。所以，我的问题是如何自动显示所有自定义属性，而不是手动一一添加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:42:10.113

这已经由 magento 完成。将您的属性标记为在前端可见，仅此而已。

查看路径 app/design/frontend/yourtheme/default/template/catalog/product/view 中的模板 attributes.phtml

```
<?php if($_additional = $this->getAdditionalData()): ?>
<!--h2><?php echo $this->__('Additional Information') ?></h2-->
<div class="data-table accordion" id="product-attribute-specs-table">
    <?php foreach ($_additional as $_data): ?>
    <?php $_attribute = $_product->getResource()->getAttribute($_data['code']);
    if  (!is_null($_product->getData($_attribute->getAttributeCode()))  &&  ((string)$_attribute->getFrontend()->getValue($_product) != '')) {  ?>
    <div class="clearer <?php echo $this->htmlEscape($this->__($_data['label'])) ?>">
        <div class="trigger"><?php echo $this->htmlEscape($this->__($_data['label'])) ?></div>
        <div class="triggerContent" style="display: none;"><span><?php echo $_helper->productAttribute($_product, $_data['value'], $_data['code']) ?></span></div>
    </div>
<?php } ?> 
```

```
</div>
<script type="text/javascript">decorateTable('product-attribute-specs-table')</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-28T07:22:17.240

您需要将默认文件从 /app/design/frontend/base/default/template/catalog/product/view 复制到您的主题目录

/public_html/app/design/frontend/default/yourtheme/template/catalog/product/view

# php - 从另一个类中调用 PHP 类？

> ID：13316282
> 
> 赞同：2
> 
> 时间：2012-11-09T21:27:30.237
> 
> 标签：php, oop

我正在构建小型MVC，并且有一些疑问想要解决。

我有调度程序类，该类需要 HTTP 请求、HTTP 响应和路由器类。

我可以使用依赖注入来做到这一点，例如：

```
$dispatcher = new Dispatcher($request, $response, $router); 
```

现在可以说我不喜欢这种方法，并且想在 Dispatcher 类中使用这样的类：

```
class Dispatcher()
{
    protected $request;
    protected $response;
    protected $router;

    public function __construct()
    {
        $this->request = new Request();
        $this->response = new Response();
        $this->router = new Router();
    }
} 
```

2方法有什么问题吗？我是否在阻止一些 OOP 原则？还是以这种方式使用它就可以了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:31:42.907

很难说一种方法或另一种方法有什么*问题*。只有当它不符合要求的规格时，它才是错误的。

第一种方法优于第二种方法的原因是因为它允许您灵活地选择可以注入的内容。例如：

```
class Dispatcher {
   private $req;
   public function __construct(IRequest $req) {
      $this->req = $req;
   }
}
interface IRequest {}
class Request implements IRequest {}
class MockRequest implements IRequest {}

//PRODUCTION
new Dispatcher(new Request);
//TESTING
new Dispatcher(new MockRequest); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:01:47.003

第二个示例应该使用*Factory*后缀调用，因为它会创建其他对象。

在这两个示例中，您最终都会得到一个高耦合的 Dispatcher 对象（[依赖反转](http://en.wikipedia.org/wiki/Dependency_inversion_principle)）

Dispatcher 应该能够只请求其他对象实现/注册到的接口或服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:47:27.430

第二个示例导致`Dispatcher`该类与其使用的所有 3 个类之间的紧密耦合。如果您正在寻找违反此规定的特定法律或原则，那将是[开放/封闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)。

> [**PS：**你确定你使用的是事件驱动架构吗？因为这是我发现*Dispatcher*提到的唯一[上下文。](http://martinfowler.com/eaaDev/AgreementDispatcher.html)]

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T21:37:44.313

您应该使用 DI 是有原因的：依赖注入从您的代码**中删除**依赖项并将它们抽象给调用者。这也使得对代码进行单元测试变得更加容易，因为代码本身并不需要外部依赖来运行。

这在一个例子中得到了最好的证明。想象一下，如果您的课程需要数据库连接：

```
class Dispatcher()
{
    protected $db

    public function __construct() {
        $this->db = new MysqlDB();
    }
} 
```

现在，你只是强迫每个人都使用 MySQL 数据库。但是，如果你使用了 DI，你可以抽象出数据库的细节，只依赖一些代表数据库对象的类：

```
class Dispatcher()
{
    protected $db

    public function __construct( Database $db) {
        $this->db = $db;
    }
} 
```

然后，定义一些代表不同数据库连接的对象：

```
interface Database {
    public function query( $sql);
}

class MySQLDB implements Database {
    public function query( $sql) { // Stuff for MySQL 
    }
}

class OracleDB implements Database {
    public function query( $sql) { // Stuff for Oracle 
    }
} 
```

现在，您的用户是否这样做：

```
$dispatcher = new Dispatcher( new MysqlDB()); 
```

或者：

```
$dispatcher = new Dispatcher( new OracleDB()); 
```

没关系 - 两个数据库都可以重用同一个类。*

# splunk - Splunk java sdk 返回 XML

> ID：13316285
> 
> 赞同：0
> 
> 时间：2012-11-09T21:27:39.533
> 
> 标签：splunk

我正在对 Splunk 进行 REST 调用，现在需要如何从 ResultsReaderXml 获取完整的 XML

```
InputStream results = jobSavedSearch.getResults();
ResultsReaderXml resultsReader = new ResultsReaderXml(results); 
```

我可以将读者推送到散列并打印，但我想要完整的 XML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:39:14.553

结果阅读器旨在将 XML 标记为键值对。如果您想要原始 XML，只需直接从流中提取数据。例如：

```
InputStream results = jobSavedSearch.getResults();
InputStreamReader reader = new InputStreamReader(results, "UTF8"); 
```

现在您可以直接从流阅读器中读取——此时它只是一个文本流。

# c# - WPF 和缩略图

> ID：13316287
> 
> 赞同：0
> 
> 时间：2012-11-09T21:27:51.343
> 
> 标签：c#, wpf

我对这个概念很陌生，但我相信应该有解决方案。我将设计（一系列线条和形状）存储为 XML，也可以将绘图保存/加载到 XML 文件中。现在，新的想法是：

1）如何显示绘图的缩略图，例如可以放在工具栏或面板上（作为工具箱）

2）通过将此缩略图拖放到画布上，它将打开并显示绘图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:32:23.943

您应该更多地了解`"ViewBox"`它是为缩略图制作的，它还有许多其他用途。你可以给它任何 WPF 内容，它会通过一些特定的选项来做缩略图。

干杯

# c# - 在 winform 网络浏览器控件中使用 Google 进行 OAuth

> ID：13316288
> 
> 赞同：3
> 
> 时间：2012-11-09T21:28:01.643
> 
> 标签：c#, winforms, browser, oauth-2.0

我想使用 C# winform 中内置的 webbrowser 控件来使用 Google 的 OAuth 对用户进行身份验证。我能够找到的所有内容都要求用户通过网络浏览器中的登录过程来获取访问令牌，然后将该令牌粘贴到我的应用程序中。如何自动获取该访问令牌，以便用户无需复制/粘贴？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T06:53:20.037

Jon，通常情况下，Bearer 令牌作为 JSON 文档在 html 响应正文中发送回。例如，从规范。

```
 HTTP/1.1 200 OK
  Content-Type: application/json;charset=UTF-8
  Cache-Control: no-store
  Pragma: no-cache

  {
    "access_token":"mF_9.B5f-4.1JqM",
    "token_type":"Bearer",
    "expires_in":3600,
    "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA"
  } 
```

如果是这种情况，您可以使用 WebBrowser.DocumentCompleted 事件获取响应，然后使用 JavaScriptSerializer 捕获 JSON

```
JavaScriptSerializer jss = new JavaScriptSerializer();
String json = webbrowser.DocumentText
TokenResponse token = jss.Deserialize<TokenResponse>(json);

   public class TokenResponse
    {
        public string access_token { get; set; }
        public string token_type { get; set; }
        public string expires_in { get; set; }
        public string refresh_token { get; set; }
    } 
```

# .net - 如何使用 rx 验证用户输入

> ID：13316290
> 
> 赞同：0
> 
> 时间：2012-11-09T21:28:09.767
> 
> 标签：.net, wpf, system.reactive

这是我想要实现的目标（在 .Net 4 WPF 客户端中）：

1.  用户在文本框中键入一些文本
2.  半秒后不再打字，文本被异步发送到服务器进行验证
3.  向用户显示验证结果（这只是绑定到文本块的文本）
4.  如果用户在验证过程中输入更多文本（这需要几秒钟），来自服务器的结果将被忽略，而是发送一个新的验证请求

从我读过的内容来看，反应式扩展非常适合这个，但我遇到了麻烦，特别是第 4 步。

其次，我使用的是 mvvm，那么如何在视图中订阅 TextBox.TextChanged 时将此逻辑放入视图模型中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T22:59:58.283

一些运算符在这里非常方便（特别是`Throttle`2 和`Switch`4）。您的视图模型将类似于：

```
Class ViewModel
    Implements INotifyPropertyChanged
    Implements IDisposable 'to clean up subscription

    Public Sub New()
        _subscription = Observable.FromEventPattern(Of PropertyChangedEventHandler, PropertyChangedEventArgs)(
                            Sub(h) AddHandler Me.PropertyChanged, h,
                            Sub(h) RemoveHandler Me.PropertyChanged, h) _
                        .Where(Function(ep) String.Equals(ep.EventArgs.PropertyName, "Input", StringComparison.Ordinal)) _
                        .Throttle(TimeSpan.FromSeconds(0.5)) _
                        .Select(Function(ep) Validate(Me.Input)) _
                        .Switch() _
                        .ObserveOnDispatcher() _
                        .Subscribe(Sub(v) Me.Output = v)
    End Sub

    Private ReadOnly _subscription As IDisposable

    'put in actual code to notify on change
    Public Property Input As String
    Public Property Output As ValidationResult

    Private Function Validate(toValidate As String) As IObservable(Of ValidationResult)
        'start validation
    End Function

    Public Event PropertyChanged(sender As Object, e As PropertyChangedEventArgs) Implements INotifyPropertyChanged.PropertyChanged
End Class 
```

从视图中，将文本框绑定到 Input，并将绑定模式设置为 PropertyChanged（而不是默认的 LostFocus）。然后结果块可以绑定到输出。

# python - 请求一个 html 文件

> ID：13316292
> 
> 赞同：1
> 
> 时间：2012-11-09T21:28:23.293
> 
> 标签：python, http, python-3.x

这个[链接](http://www.uniprot.org/uniprot/?query=reviewed%3ayes+AND+organism:9606&random=yes)让我从数据库中获取一个随机项目。但是，我想使用 Python 自动检索项目。这是我的代码：

```
import sys
from urllib.parse import urlencode
from urllib.request import urlopen

# parameters
data = {}
data["query"] = "reviewd:yes+AND+organism:9606"
data["random"] = "yes"

url_values = urlencode(data)
url = "http://www.uniprot.org/uniprot/"
full_url = url + '?' + url_values
data = urlopen(full_url)
out = open("1.html", 'w')
out.write(str(data.read())) 
```

但是，我无法获得所需的页面。有人知道我的代码有什么问题吗？我正在使用 Python 3.x。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:05:17.293

你有几个问题：

1.  `reviewd`拼写错误，应该是`reviewed`
2.  基本网址需要`/uniprot/`在末尾
3.  您需要`+`在查询字符串中使用空格而不是

这就是它的样子：

```
import sys
from urllib.parse import urlencode
from urllib.request import urlopen

# parameters
data = {}
data["query"] = "reviewed:yes AND organism:9606"
data["random"] = "yes"

url_values = urlencode(data)
url = "http://www.uniprot.org/uniprot/"
full_url = url + '?' + url_values
data = urlopen(full_url)
out = open("1.html", 'w')
out.write(str(data.read())) 
```

这会产生以下 URL：

```
http://www.uniprot.org/uniprot/?query=reviewed%3Ayes+AND+organism%3A9606&random=yes 
```

# php - 我的 csv 导出显示 html，如何摆脱？

> ID：13316293
> 
> 赞同：2
> 
> 时间：2012-11-09T21:28:25.077
> 
> 标签：php, mysql, csv, export-to-csv

我以前见过这个问题，在尝试了多种解决方案后我无法让它正常工作。问题是我无法将数据正确导出为 csv 格式。在我添加我的 ob_end_clean 之前，它会导出到带有 html 的 csv，现在它没有给我一个 csv，只是文本。

这是我在所需文件上的代码。

```
if (isset($_POST["hidden"])) {

$list = array (
    array('aaa', 'bbb', 'ccc', 'dddd'),
    array('123', '456', '789'),
    array('"aaa"', '"bbb"')
);

    $fp = fopen('php://output','w');

    foreach ($list as $row) {
        ob_end_clean();
        fputcsv($fp, $row);
    }

    header('Content-Type: text/csv; charset=utf-8');
    header('Content-Disposition: attachment; filename=data.csv');

} 
```

现在，当我进行导出时，数据会以类似于 var_dump() 的方式重新显示在屏幕上。我只是想让它转到一个 csv 文件，而不是整个 html。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-09T22:16:18.507

得到它的工作！

我在页面上的任何内容之前调用了我的 csv 代码。:) 然后我连接到我的桌子，然后为我的代码做了我的逻辑。我的主文件上没有 ob_start 或 ob_flush ，这有很大的不同。我在while循环之前有ob_clean，然后在声明标题后我做了一个exit()。希望这能很好地解释它。

这是我的代码。

```
if (isset($_POST["hidden"])) {
    $sql = "SELECT * FROM `newsletter`";
    $result = mysql_query($sql);

    ob_end_clean();

    $fp = fopen('php://output','w');

    while ($list = mysql_fetch_assoc($result)) {
        fputcsv($fp, $list);
    }

    header('Content-Type: text/csv; charset=utf-8');
    header('Content-Disposition: attachment; filename=data.csv');

    exit();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-16T18:10:02.750

地点，ob_end_clean(); 在输出 csv 之前。

ob_end_clean() 含义：“清理（擦除）输出缓冲区并关闭输出缓冲” - PHP 手册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-03T07:43:21.180

它工作的逻辑是构建您的 php 脚本，以便它：

1.  首先回显所有用于浏览器页面的 html/javascript... 内容`echo "<html...>;"`（这已经在幕后使用了 php 的输出缓冲区）
2.  之后，到目前为止清理了 php 的输出缓冲区，使用`ob_end_clean()`（取决于 ob_start() 的调用方式，这可能会阻止先前的导出）或者`ob_clean()`只是将内容发送到浏览器并清理缓冲区而不将其关闭。
3.  最后再次使用这个干净的输出缓冲区将任何进一步的内容（在我们的例子中作为可下载的 csv）导出到浏览器，如 wowzuzz 所示。因此，如果此后脚本回显了任何 html，它也将包含在 csv 中。

# java - 将 JList 与模型一起使用？

> ID：13316294
> 
> 赞同：1
> 
> 时间：2012-11-09T21:28:27.580
> 
> 标签：java, swing, file-io, jlist, defaultlistmodel

我正在制作一个应用程序，允许您添加文件然后压缩它们，但是如何从我的硬盘驱动器或任何硬盘驱动器中获取文件到我的应用程序中？我可以通过文件阅读器获取文件，但如何将其放入我的 GUI 中？

我读到 defaultListModel 是要走的路，但我不确定。

```
public class LockNCompressWindow
{
    public static void main(String[] args)
    { 
        LockFrame w = new LockFrame();  
        w.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        w.setSize(500,500);
        w.setResizable(false);
        w.setVisible(true);
    }
}

class LockFrame extends JFrame implements ActionListener
{
    //Declaring MenuBar and components 
    JMenuBar menuBar = new JMenuBar(); 
    JMenu menu = new JMenu("File");
    JMenuItem MenuItemClose = new JMenuItem("Close"); 

    //Declaring Panels 
    JPanel PanelNorth = new JPanel(); 
    JPanel PanelCenter = new JPanel();
    JPanel PanelSouth = new JPanel(); 

    //Declaring Buttons 
    JButton ButtonAddFile = new JButton("Add File");
    JButton ButtonDeleteFile = new JButton("Delete File"); 
    JButton ButtonLock = new JButton("Lock");
    JButton ButtonUnlock = new JButton("Unlock");

    //Declaring FileChooser
    JFileChooser chooser = new JFileChooser(); 

    public LockFrame()
    {
        //Title of the frame
        super("Lock and Zip");

        //Creating Menu bar
        super.setJMenuBar(menuBar);

        //Creating the Menu Tab 
        menuBar.add(menu);

        //Creating a Menu Item
        menu.add(MenuItemClose);

        //Adding North Panel 
        PanelNorth.setBorder(BorderFactory.createEtchedBorder());

        super.add(PanelNorth);

        PanelNorth.add(ButtonAddFile); 
        PanelNorth.add(ButtonDeleteFile);
        add(PanelNorth,BorderLayout.NORTH);

        //Adding Center Panel to Frame
        super.add(PanelCenter);

        //Adding Scroll Pane 
        JScrollPane listScroller = new JScrollPane();
        listScroller.setPreferredSize(new Dimension(400,360));

        PanelCenter.add(listScroller);
        add(PanelCenter, BorderLayout.CENTER);

        //Adding South Panel
        PanelSouth.setBorder(BorderFactory.createEtchedBorder());

        super.add(PanelCenter);

        PanelSouth.add(ButtonLock); 
        PanelSouth.add(ButtonUnlock);
        PanelSouth.add(ButtonPassword);
        add(PanelSouth,BorderLayout.SOUTH);

        //Action Listeners
        ButtonAddFile.addActionListener(this);
        ButtonPassword.addActionListener(this);
    }

    public void actionPerformed(ActionEvent e)
    {
        Object Source = e.getSource();
        int ReturnValue;

        if (Source == ButtonAddFile)
        {
            ReturnValue = chooser.showOpenDialog(LockFrame.this);
            if (ReturnValue == JFileChooser.APPROVE_OPTION()) 
            {
                File file = chooser.getSelectedFile();
                //Add the file to you center panel
            } 
        }

        if (Source == ButtonDeleteFile)
        {

        }

        if (Source == ButtonLock)
        {

        }

        if (Source == ButtonUnlock)
        {

        }

        if (Source == ButtonPassword)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:18:01.893

您可能想阅读[如何使用列表](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)以了解更多详细信息，但基本概念相当简单。

创造你自己`ListModel`。在这个例子中，我自定义了自己的，你可以很容易地使用 a `DefaultListModel`，并添加你想要的对象。

创建你自己`JList`并将你的模型应用于它，嗯，就是这样......

```
public class FileAdder {

    public static void main(String[] args) {
        new FileAdder();
    }

    public FileAdder() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new FileAdderPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class FileAdderPane extends JPanel {

        private JList fileList;
        private JFileChooser chooser;

        public FileAdderPane() {
            setLayout(new BorderLayout());

            fileList = new JList(new MyFileListModel());
            JButton addMore = new JButton("Add More");
            addMore.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if (chooser == null) {
                        chooser = new JFileChooser();
                        chooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
                        chooser.setMultiSelectionEnabled(true);
                    }
                    switch (chooser.showOpenDialog(FileAdderPane.this)) {
                        case JFileChooser.APPROVE_OPTION:
                            File[] files = chooser.getSelectedFiles();
                            if (files != null && files.length > 0) {
                                MyFileListModel model = (MyFileListModel) fileList.getModel();
                                for (File file : files) {
                                    model.add(file);
                                }
                            }
                            break;
                    }
                }
            });

            add(new JScrollPane(fileList));
            add(addMore, BorderLayout.SOUTH);
        }
    }

    public class MyFileListModel extends AbstractListModel {

        private List<File> files = new ArrayList<File>(25);

        @Override
        public int getSize() {
            return files.size();
        }

        @Override
        public Object getElementAt(int index) {
            return files.get(index);
        }

        public void add(File file) {
            files.add(file);
            fireIntervalAdded(this, files.size() - 1, files.size() - 1);
        }

        public void remove(File file) {
            int index = files.indexOf(file);
            files.remove(file);
            fireIntervalRemoved(this, index, index);
        }
    }
} 
```

# wpf - ItemsSource 上的 WPF Datagrid ValidationRules

> ID：13316296
> 
> 赞同：0
> 
> 时间：2012-11-09T21:28:33.760
> 
> 标签：wpf, validation, datagrid

当 DataGrid 没有行时，我想在 DataGrid 周围放置一个红色边框（我正在绑定到 ItemsSource）。

因此，我遵循了 WPF 验证指南：

[http://www.codeproject.com/Articles/15239/Validation-in-Windows-Presentation-Foundation](http://www.codeproject.com/Articles/15239/Validation-in-Windows-Presentation-Foundation)

无论如何，在以下情况下使文本框出现这样的错误很简单`Text = ""`：

![空文本框错误](../Images/1a53f786f100e59146f41aa2385d1833.png)

甚至自定义错误：

![绿色](../Images/6aa58809bce7693a2b1f7ccfe2b2ddcb.png)

我尝试调试，并且绑定在我的 ItemsSource 中的 ValidationRules 永远不会被调用。

```
<DataGrid ...>
 <DataGrid.ItemsSource>
   <Binding Path="Lines" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged">
       <Binding.ValidationRules>
         <DataGridValidationRule
               MiniumRows="1"
               MaximumRows="100"
               ErrorMessage="must have between 1 and 100 rows">
         </DataGridValidationRule>
       </Binding.ValidationRules>
     </Binding>
 </DataGrid.ItemsSource>
</DataGrid> 
```

然后 DataGridValidtionRule 类看起来像这样：

```
public class  public class StringRangeValidationRule : ValidationRule
{
    private int _minimumRows = -1;
    private int _maximumRows = -1;
    private string _errorMessage;

    public int MinimumRows
    {
        get { return _minimumRows ; }
        set { _minimumRows  = value; }
    }

    public int MaximumRows
    {
        get { return _maximumLength; }
        set { _maximumLength = value; }
    }

    public string ErrorMessage
    {
        get { return _errorMessage; }
        set { _errorMessage = value; }
    }

    public override ValidationResult Validate(object value, 
        CultureInfo cultureInfo)
    {
        ValidationResult result = new ValidationResult(true, null);
        ObservableCollection<Lines> lines = (ObservableCollection<Lines>) value;
        if (lines.Count < this.MinimumRows||
               (this.MaximumRows> 0 &&
                lines.Count > this.MaximumRows))
        {
            result = new ValidationResult(false, this.ErrorMessage);
        }
        return result;
    } 
```

还有“线条”类

```
 public class Line
  {
    public Line(string f, string b)
    {
      foo = f;
      bar = b;
    }
   public string Foo {get; set;}
   public string Bar {get; set;}
  } 
```

编辑：

事实证明，我的数据网格的“删除行”按钮是从实际的DataGrid 中删除`ObservableCollection`但不是通过实际的 DataGrid（它在 ViewModel 上删除）......并且由于某种原因，这会阻止调用 Validation 调用。

所以再次查看：

```
<DataGrid Name="mygrid">
 <DataGrid.ItemsSource>
   <Binding Path="Lines" Mode="TwoWay" UpdateSourceTrigger="PropertyChanged">
       <Binding.ValidationRules>
         <DataGridValidationRule
               MiniumRows="1"
               MaximumRows="100"
               ErrorMessage="must have between 1 and 100 rows">
         </DataGridValidationRule>
       </Binding.ValidationRules>
     </Binding>
 </DataGrid.ItemsSource>
</DataGrid> 
```

所以如果我在 ViewModel 中有：

```
void delete(Line l)
{
  Lines.Remove(l); //if you delete everything (grid empty) there won't be any error shown.
} 
```

错误边框和图标不会出现在数据网格周围。

但是，如果我改为放置一个直接更改 ItemsSource 的事件，如下所示：

```
 void delete(Line l)
    {
      Lines.Remove(l);
      myView.mygrid.ItemsSource = Lines; // this magically fixes everything... even though it was already bound to Lines... though i hate to directly access the View from within the ViewModel.
    } 
```

我不知道究竟为什么......但这解决了它。关于如何将视图与 VM 分开的任何想法？我真的不喜欢这个修复。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-10T02:19:46.087

尝试将数据网格放在边框中并在其上附加触发器以使其在数据网格为空时变为红色

```
<Border Margin="20" >
    <Border.Style>
        <Style TargetType="Border">
            <Style.Triggers>
                <DataTrigger  Binding="{Binding ISEmpty}" Value="True">
                    <Setter Property="BorderThickness" Value="2" />
                    <Setter Property="BorderBrush" Value="Red" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Border.Style>
    <DataGrid  Name="myGrid" AutoGenerateColumns="True"  ItemsSource="{Binding Path=Lecturers}" >

    </DataGrid>
</Border> 
```

清除网格时将 IsEmpty 属性设置为 true

```
private bool iSEmpty;

public bool ISEmpty
{
    get { return iSEmpty; }
    set
    {
        iSEmpty = value;
        NotifyPropertyChanged("ISEmpty");
    }
} 
```

清除您的项目来源集合

```
viewmodel.Lecturers.Clear();
this.viewmodel.ISEmpty = true; 
```

未来的工作。您可以将触发器绑定到数据网格控件。

# mysql - 一个月内每天的帖子数

> ID：13316303
> 
> 赞同：0
> 
> 时间：2012-11-09T21:29:02.437
> 
> 标签：mysql, count

我的数据库中有一个表`Post`，其中包含不同用户的帖子。我想做的是创建一个 sql 查询，该查询将根据各自的月份返回每天发布的帖子数。请让我知道如何在一个查询中一般地做到这一点，我可以为所有天创建多个查询，但这是最坏的情况。所以我需要专家的解决方案。谢谢

**预期输出：（** 查询计算各月所有天的帖子数）

天 : 帖子数

1 : 20

2 : 25

3 : 10

4 : 17

…………………………………………………………………………………………………………

30 : 6

表结构： `ID | postid | post | date`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:32:50.570

```
select DAYOFMONTH(date) as Day , count(*) as Number_of_posts
from table
group by DAYOFMONTH(date) 
```

您应该知道，如果表包含来自不同月份的数据，则帖子数将是错误的。
所以分组依据应该是按日期，你应该使用选定的日期而不是月份的日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T21:34:31.740

```
SELECT DAYOFMONTH(date), count(*) FROM Post
GROUP BY DAYOFMONTH(date)
ORDER BY DAYOFMONTH(date) ASC; 
```

如果您想查询特定月份（例如二月），请使用以下命令：

```
SELECT DAYOFMONTH(date), count(*) FROM Post
WHERE MONTH(date) = '2'
GROUP BY DAYOFMONTH(date)
ORDER BY DAYOFMONTH(date) ASC; 
```

注意：月份以数字形式返回，其中使用了[MONTH()](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_month)函数。

**编辑**：如果您希望返回给定月份中每一天的计数，那么我会将您推到这里 - 一个类似问题的公认答案：[如何获取一个月中每一天的值](https://stackoverflow.com/questions/2274777/how-to-get-values-for-every-day-in-a-month)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T21:32:59.597

```
SELECT date, COUNT(id) as number_of_posts FROM table_name GROUP BY date. 
```

# permissions - 授予 Windows 8 应用程序阻止另一个应用程序的权限

> ID：13316312
> 
> 赞同：0
> 
> 时间：2012-11-09T21:29:49.527
> 
> 标签：permissions, windows-8, block

我试图让我的 Windows 8 应用程序阻止另一个应用程序启动或根据用户设置启动另一个应用程序。例如，阻止浏览器打开并启动媒体播放器。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:36:58.487

不，Windows 应用商店应用程序在沙盒环境中运行，您绝对不能阻止任何应用程序被其他应用程序使用。

# c - 忽略 fscanf 或 fgets 的空白？

> ID：13316313
> 
> 赞同：3
> 
> 时间：2012-11-09T21:29:50.240
> 
> 标签：c, fgets, scanf

我想知道是否有任何方法可以使用 fscanf 或 fgets 函数忽略空格。我的文本文件每行有两个字符，可能会或可能不会被空格分隔。我需要读取这两个字符并将每个字符放在不同的数组中。

```
file = fopen(argv[1], "r");
if ((file = fopen(argv[1], "r")) == NULL) {
    printf("\nError opening file");
}
while (fscanf(file, "%s", str) != EOF) {
    printf("\n%s", str);
    vertexArray[i].label = str[0];
    dirc[i] = str[1];
    i += 1;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T22:27:27.703

在 fscanf 格式中使用空格 ( `" "`) 会导致它读取并丢弃输入上的空白，直到找到非空白字符，将输入上的非空白字符作为下一个要读取的字符。因此，您可以执行以下操作：

```
fscanf(file, " "); // skip whitespace
getc(file);        // get the non-whitespace character
fscanf(file, " "); // skip whitespace
getc(file);        // get the non-whitespace character 
```

或者

```
fscanf(file, " %c %c", &char1, &char2); // read 2 non-whitespace characters, skipping any whitespace before each 
```

# actionscript-3 - Actionscript 3：有没有办法使用 AS3 TextField 重新创建 Flash Textarea 组件的外观？

> ID：13316322
> 
> 赞同：0
> 
> 时间：2012-11-09T21:30:50.973
> 
> 标签：actionscript-3, flash, textfield

我想知道是否有办法使用 AS3 的 TextField 重新创建 Flash 的 Textarea 组件或接近它？

如果没有，那么是否有办法更改 AS3 TextField 的各个边框颜色，例如顶部、左侧、右侧和底部边框颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:31:13.167

Flash Pro 的组件源代码可从您的安装处获得：

**Mac**：/Applications/Adobe Flash CS5.5/Common/Configuration/Component Source/ActionScript 3.0/User Interface

**PC** : C:\Program Files (x86)\Adobe\Adobe Flash CS5.5\Common\Configuration\Component Source\ActionScript 3.0\User Interface

没有蒙皮，a`TextArea`只是一个`TextField`with：

```
textField.type = (enabled && _editable) ? TextFieldType.INPUT : TextFieldType.DYNAMIC;
textField.selectable = enabled;
textField.wordWrap = _wordWrap;
textField.multiline = true; 
```

对焦后，添加浅蓝色发光滤镜。

来自 Flash Pro `fl.controls.TextArea`：

```
// Copyright 2007\. Adobe Systems Incorporated. All Rights Reserved.
/**
 * @private (protected)
 *
 * @langversion 3.0
 * @playerversion Flash 9.0.28.0
 */
override protected function configUI():void {
    super.configUI();
    tabChildren = true;

    textField = new TextField();
    addChild(textField);
    updateTextFieldType();

    _verticalScrollBar = new UIScrollBar();
    _verticalScrollBar.name = "V";
    _verticalScrollBar.visible = false;
    _verticalScrollBar.focusEnabled = false;
    copyStylesToChild(_verticalScrollBar, SCROLL_BAR_STYLES);
    _verticalScrollBar.addEventListener(ScrollEvent.SCROLL,handleScroll,false,0,true);
    addChild(_verticalScrollBar);

    _horizontalScrollBar = new UIScrollBar();
    _horizontalScrollBar.name = "H";
    _horizontalScrollBar.visible = false;
    _horizontalScrollBar.focusEnabled = false;
    _horizontalScrollBar.direction = ScrollBarDirection.HORIZONTAL;
    copyStylesToChild(_horizontalScrollBar, SCROLL_BAR_STYLES);
    _horizontalScrollBar.addEventListener(ScrollEvent.SCROLL,handleScroll,false,0,true);
    addChild(_horizontalScrollBar);

    textField.addEventListener(TextEvent.TEXT_INPUT, handleTextInput, false, 0, true);
    textField.addEventListener(Event.CHANGE, handleChange, false, 0, true);
    textField.addEventListener(KeyboardEvent.KEY_DOWN, handleKeyDown, false, 0, true);

    _horizontalScrollBar.scrollTarget = textField;
    _verticalScrollBar.scrollTarget = textField;
    addEventListener(MouseEvent.MOUSE_WHEEL, handleWheel, false, 0, true);
} 
```

# ios - ios xcode 4.5通过wifi

> ID：13316325
> 
> 赞同：0
> 
> 时间：2012-11-09T21:31:31.817
> 
> 标签：ios, xcode, jailbreak

我是 iOS 开发的新手，到目前为止我做得还不错，但是我仍在尝试找到一种通过 wifi 将应用程序发送到设备的方法。我的设备已越狱，iTunes 可以通过 wifi 同步，但我无法让 xcode 看到它。

我可以通过wifi上传和调试吗？我不想手动发送带有 ssh 的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:33:24.083

也许这可以帮助你一点。看看这个类似的帖子：

[如何在没有加入 iPhone 开发者计划的情况下在越狱的 iPhone 上构建和安装应用程序？](https://stackoverflow.com/questions/2708444/how-do-i-build-and-install-applications-on-a-jailbroken-iphone-without-being-in)

但我认为通过 wifi 在 xcode 中运行和调试是不可能的！

# php - PHP Mysql 按条件排序

> ID：13316326
> 
> 赞同：0
> 
> 时间：2012-11-09T21:31:33.320
> 
> 标签：php, mysql, sql-order-by

我想订购配置良好的活动，我面临的是，

我订购我的活动，如果它们可以出售，我会先展示它们，然后我会展示那些可以预订但不能出售的活动，但是当人们预订时，我会为他们打开我的活动 3-4 天只有预订的人才能购买该活动，

我想要的很简单，我想展示他们已经预订的活动，并且活动只对预订的人开放出售；首先是对所有人开放的，然后是因为仅供预订而无法购买的

例如，A 是对所有人开放的活动，B 是开放预订的，C 只能由预订的人购买，

我的查询返回的是：A - B - C

我想要的是：C-A-B

我试图更改查询，但我知道我在那里犯了一个错误

这是我的代码：

```
try
{
$event_query = "SELECT * FROM `events` ORDER BY `reservation` ASC, `eventdate` ASC";
$event_query_check = $db->prepare($event_query);
$event_query_check->execute();
$ac = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
while($fetch = $event_query_check->fetch (PDO::FETCH_ASSOC) ){ 

// fetching the info exc in here

try {
$q = "SELECT * FROM `event_reservation` WHERE `attendee_id` = :attendee_id AND `event_id` = :event_id";
$check_query = $db->prepare($q);
$check_query->bindParam(':attendee_id', $userid, PDO::PARAM_INT);
$check_query->bindParam(':event_id', $event_id, PDO::PARAM_INT);
$check_query->execute();
$n2 = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
}
catch(PDOException $e) {
$log->logError($e." - ".basename(__FILE__));
}

// not working part of the code

 if($n2){
$event_query = "SELECT * FROM `members` ORDER BY `reservation_open_to_sell` DESC, `reservation` ASC, `eventdate` ASC";
}

// ends here

} // end of while
} // end of try
catch(PDOException $e) {
$log->logError($e." - ".basename(__FILE__));
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:39:43.990

你可以这样做：

```
order by case when reservation='c' then 1 
              when reservation='a' then 2
              when reservation='b' then 3 end 
```

# sql - 验证 T-SQL 查询的方法？

> ID：13316328
> 
> 赞同：3
> 
> 时间：2012-11-09T21:31:40.480
> 
> 标签：sql, sql-server, tsql, syntax

我可以访问 Access 数据库，并且在该数据库中填充了 TSQL 查询的字段。这些查询由服务器上的 T-SQL 处理。因此，当我编写这些 SQL 查询并将它们放入一个字段以供最终服务器使用时，我无法验证语法/等。我可以在那个 Access 数据库中创建一个临时查询，但它不是同一种查询语言。例如，Access 会正确使用`IIF`，但 TSQL 不会（而是会`CASE`）。

我无法使用 TSQL 直接访问此服务器，有没有办法可以验证我的 T-SQL 查询（用于语法等）？也许是在线网络工具？

我应该注意我无权访问 SQL 服务器。只有Access db，仅此而已。我知道它不会验证表名等，我不希望它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T21:51:41.413

实际上，MattMc3 的答案和 FremenFreedom 的答案的组合应该有效。

下载 SQL Express。

然后，声明以下存储过程：

```
create procedure IsValidSQL (@sql varchar(max)) as
begin
    begin try
        set @sql = 'set parseonly on;'+@sql;
        exec(@sql);
    end try
    begin catch
        return(1);
    end catch;
    return(0);
end; -- IsValidSQL 
```

您可以使用以下方法对其进行测试：

```
declare @retval int;
exec @retval = IsValidSQL 'select iif(val, 0, 1) from t';
select @retval 
```

或与：

```
declare @retval int;
exec @retval = IsValidSQL 'select val from t';
select @retval 
```

注意：这将捕获 IIF() 问题。它*不会*捕获与表结构或列结构相关的任何内容。您将需要架构和稍微不同的方法（“select top 0 * from () t”）会做到这一点。

您也许可以在线使用 SQL Fiddle 做一些事情。但是，我建议拥有数据库的本地副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T21:39:27.777

您可以解析 T-SQL 以检查有效语法，方法是在 SQL Server 机器上执行它，并将 a`SET PARSEONLY ON`作为脚本的第一行。它不会验证表或字段名称，但会为您提供任何语法错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T21:46:06.973

Data Dude (Gert Drapers) 在此处描述了如何在您的应用程序中使用内置的 SQL Server T-SQL 解析器：

*   [前往皇冠珠宝](http://blogs.msdn.com/b/gertd/archive/2008/08/21/getting-to-the-crown-jewels.aspx)

如果您只想检查您拥有的 SQL 语句的有效性 - 这可能是一个不错的方法，并且它不需要在您运行单元测试的地方安装 SQL Server 本身。

这是一种基于 .NET 的方法，如果您不使用实时数据库，它当然无法验证数据库中的对象名称，但它*可以*捕获 T-SQL 语句中的语法错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-28T12:36:03.550

您可以使用以下[`NOEXEC`选项](http://msdn.microsoft.com/en-us/library/ms188394.aspx)：

```
SET NOEXEC ON

SELECT 1 AS Test

SET NOEXEC OFF 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-09T21:36:41.483

SQL Server Management Studio Express（免费下载）是否能够连接到常规 SQL Server 实例？如果是这样，也许您可​​以在那里测试查询。即使您无法连接到实际服务器，您也可以在 Express 中创建数据库的测试版本，这至少可以让您发现语法和命名问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-09T22:08:27.217

如果它们是相当静态的，请将它们转换为 Sql 数据库中的存储过程，然后从访问中调用它们。

# android - Android 模拟器无法使用 HttpURLConeectioin 连接本地 tomcat 服务器

> ID：13316347
> 
> 赞同：0
> 
> 时间：2012-11-09T21:33:01.120
> 
> 标签：android, tomcat, httpurlconnection

我正在做一个将 Android 与本地 Tomcat 服务器连接的项目。但现在我面临一个大约 1 周的问题。谁能帮助我..非常感谢！

我使用最新的 android API 和 Tomcat 7.0。当我启动 Tomcat 服务器时。我可以通过带有 url:(http://10.0.2.2:8080) 的模拟器浏览器访问 Tomcat 主页。但是当我在代码中使用 HttpUrlConnection 时。我无法成功连接。我还使用 httpurlconnection 访问 www.google.com 和 www.android.com。我也无法连接它们。我使用 HttpURLConnection.HTTP_OK 来查看它是否成功连接。我还看到我创建的 HttpURLConnection 实例的 Connected 是错误的。

顺便说一句，我还在标签之前的 AndroidManifest.xml 中添加了它的互联网访问权限。

非常感谢！帮我。这是紧急情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-26T15:56:07.503

我最近遇到了这个问题。如上所述，（在 Windows 上）启动 cmd，并使用 ipconfig 查找 PC 的 IP 地址。此外，由于我的 Eclipse/Tomcat 配置，我需要在 URL 中包含我的 Eclipse 项目名称。我使用的 URL 是这样的：http: [//192.168.1.2/myEclipseProject/ServletName](http://192.168.1.2/myEclipseProject/ServletName)

此外，如果您的 Tomcat 仍然具有默认配置，您可能需要将端口添加到 ip 地址：192.168.1.2:8080

# angularjs - 为 $resource 提供参数

> ID：13316352
> 
> 赞同：1
> 
> 时间：2012-11-09T21:33:45.537
> 
> 标签：angularjs

假设我有

```
angular.factory('Service', [
  '$resource', function ($resource) {
      return $resource('/path/:id', {id: '@id'});
  }]) 
```

如果在我的控制器中我这样做

```
var s = new Service({id: 123});
s.$query(); 
```

它向 发送请求`/path`，但我希望它向 发送请求`/path/123`。为什么这样做以及如何设置参数？

我不想向`$query()`. 我想设置“默认”。用 表示的那个`@id`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:51:58.760

`$query`用于获取记录列表。你想要的是`$get`

```
var s = Service.get({id :123}, function optionalFn(){}); 
```

[在这里](http://docs.angularjs.org/api/ngResource.%24resource)查看更多

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-09T16:19:23.720

我认为这里的示例控制器实际上是将 id 参数发送给工厂本身，工厂不需要。通过这种设置方式，您需要在 query() 中发送一个参数，或者您可以选择将工厂代码中的资源路径 id 值从“@id”更改为 123。我相信“@id”告诉它在查询（{id:123}）之类的调用中查找 id 参数。

# javascript - 改进 Javascript 浏览器检测功能

> ID：13316353
> 
> 赞同：-4
> 
> 时间：2012-11-09T21:33:46.750
> 
> 标签：javascript

我已经编写了一个 Javascript 浏览器检测功能，但我想用其他人的知识来改进它。

问题：

您会注意到我假设“Chrome 18”必须是“Maxthon 3”，但当然不一定如此！

我们如何区分 Chrome 18 和傲游 3？

同样，我们如何区分 Firefox 和 Sea Monkey？

那么月球呢？我们还可以通过 navigator.userAgent 检测到该浏览器吗？

还有其他我忘记的流行浏览器吗？

请仅提供纯 Javascript 解决方案/建议！

```
 <!DOCTYPE html>

 <script type="text/javascript">

 function GetBrowser(){
 var browser="";
 var version=0;

 if (/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
  version=new Number(RegExp.$1);
  browser="FireFox";} else {

  if (/MSIE (\d+\.\d+);/.test(navigator.userAgent)){
   version=new Number(RegExp.$1);
   browser="Internet Explorer";} else {

   if (/Opera[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
    version=new Number(RegExp.$1);
    browser="Opera";} else {

    if (/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
     version=new Number(RegExp.$1);
     if (version==18) {version=3; browser="Maxthon";} else {browser="Google Chrome"}} else {version=0; browser="Undetermined";}
 }}}
 return browser+' '+version;}

 document.write(GetBrowser());
 </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:41:45.073

[Modernizr http://modernizr.com/](http://modernizr.com/)中实现了一个不错的浏览器/功能检测，它也被一些 CDN 支持，如 CDNjs [http://cdnjs.com/](http://cdnjs.com/)

我想弄清楚的是您可以检测到一些浏览器支持的功能，因此您可以通过微小的差异简单地检测浏览器。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-11-09T23:31:07.873

这就是我需要的。我更正了 Opera 和 Safari 版本检测中的错误并添加了 SeaMonkey。

```
 <!DOCTYPE html>

 <script type="text/javascript">

 function GetBrowser(){
 var browser="";
 var version=0;

 if (/SeaMonkey[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
  version=new Number(RegExp.$1);
  browser="SeaMonkey";} else {

  if (/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
   version=new Number(RegExp.$1);
   browser="Mozilla FireFox";} else {

   if (/MSIE (\d+\.\d+);/.test(navigator.userAgent)){
    version=new Number(RegExp.$1);
    browser="Internet Explorer";} else {

    if (/Opera/.test(navigator.userAgent)){
     if (/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent)){version=new Number(RegExp.$1);}
     browser="Opera";} else {

     if (/Maxthon[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
      version=new Number(RegExp.$1);
      browser="Maxthon";} else {

      if (/Chrome[\/\s](\d+\.\d+)/.test(navigator.userAgent)){
       version=new Number(RegExp.$1);
       browser="Google Chrome";} else {

       if (/Safari/.test(navigator.userAgent)){
        if (/Version[\/\s](\d+\.\d+)/.test(navigator.userAgent)){version=new Number(RegExp.$1);}
        browser="Safari";} else {browser="Unknown";}

 }}}}}}
 return browser+' '+version;}

 document.write(GetBrowser());

 </script> 
```

# animation - 基于 SVG 帧的动画

> ID：13316354
> 
> 赞同：2
> 
> 时间：2012-11-09T21:33:50.713
> 
> 标签：animation, svg

任何人都可以建议基于 JPEG 在 svg 中实现基于帧的动画的最佳方法是什么？

我发现的一个例子是：

```
<svg version="1.1" baseProfile="tiny" id="svg-root"
  width="100%" height="100%" viewBox="0 0 480 360"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">

   <image width="320" height="240" xlink:href="test1.jpg">
      <animate id='frame_0' attributeName='display' values='inline;none'
               dur='0.5s' fill='freeze' begin="0s" repeatCount="indefinite"/>
   </image>

   <image width="320" height="240" xlink:href="test2.jpg">
      <animate id='frame_1' attributeName='display' values='none;inline'
               dur='0.5s' fill='freeze' begin="0.5s" repeatCount="indefinite" />
   </image>

</svg> 
```

它适用于 2 帧，但不能真正缩放。我想要一些可以处理 100 帧甚至更多帧的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:07:27.167

这要容易得多：

```
<svg version="1.1" baseProfile="tiny" id="svg-root"
  width="100%" height="100%" viewBox="0 0 480 360"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">

  <image width="320" height="240" xlink:href="test1.jpg">
    <animate attributeName="xlink:href" 
      values="test1.jpg;test2.jpg" 
      begin="0s" repeatCount="indefinite" dur="1s"/>
  </image>

</svg> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-12T20:38:00.563

另一种方法，

如果您的动画正在运行，但只是制作过多而无法设置文件，则可以使用模板来生成 SVG。

使用[Grunt.Js](http://gruntjs.com/)之类的东西来读取目录中的所有图像，然后使用下划线模板构建 SVG 帧，就像您已经从文件路径数组中设置它们一样。

这些代码片段可能无法开箱即用，但非常接近。

这里 grunt 文件抓取文件夹中的文件，检查它们是否是图像，然后将它们推送到数组中。

```
// gruntfile.js //

var fs = require('fs');
var path = require('path');
var _ = require("underscore");

grunt.registerTask('Build Animated SVG', function () {

    var template = grunt.file.read("/path to SVG underscore template/");    //see SVG section below.

        var frames = [];
        var pathtoframes = "mypath";
        var mySVG = "mysvg.svg";

        fs.readdirSync(path.resolve(pathtoframes)).forEach(function (file) {

            if (filetype == "svg" || filetype == "png" || filetype == "jpg" || filetype == "gif") {
                var frame = {};
                frame.src = pathtoframes + "/" + file;
                frames.push(frame);
            }
        });

var compiledSVG = _.template(template, {frames:frames});

grunt.file.write(path.resolve(pathtoframes) + "/compiled_" + mySVG, compiledSVG);

}); 
```

该模板将被 grunt 文件读入，下划线将遍历每个文件并将其写入一个大字符串。然后 Grunt 将其保存为可以加载的 SVG。

```
<!-- SVG underscore template -->
    <svg version="1.1" baseProfile="tiny" id="svg-root"
          width="100%" height="100%" viewBox="0 0 480 360"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">

          <% _.each(frames, function(frame, index){ %>
             <image width="320" height="240" xlink:href="<%= frame.src %>">
                <animate 
                         id='frame_<%= index %>' 
                         attributeName='display' 
                         values='none;inline'
                         dur='0.5s' 
                         fill='freeze' 
                         begin="0.5s" 
                         repeatCount="indefinite" 
                         />
            </image>
        <% } %>
    </svg> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-27T02:59:02.703

[https://michaelsboost.github.io/SVGAnimFrames/](https://michaelsboost.github.io/SVGAnimFrames/)

为此，您可以轻松地使用我的库[SVGAnimFrames](https://michaelsboost.github.io/SVGAnimFrames/)。只需调用 1 行代码...

```
SVGAnimFrames("#bounce svg", "repeat", "40", "0"); 
```

[![在此处输入图像描述](../Images/eb9ab4dc467ecbfbd7b54edc8fe31e60.png)](https://i.stack.imgur.com/3ORV6.gif)

请参阅[Github 存储库](https://github.com/michaelsboost/SVGAnimFrames)以了解如何使用它。

理想情况下，您最好的选择是使用 spritesheet 并逐帧制作动画，从而最大限度地减少不必要的 http 请求。

# nginx - Nginx 将静态文件重写为 index.html

> ID：13316355
> 
> 赞同：1
> 
> 时间：2012-11-09T21:33:52.943
> 
> 标签：nginx

我正在尝试在单页应用程序上工作 - 我需要将所有 url 重写为 index.html，但允许现有静态文件（.css 和 .js）像通常在浏览器中一样提供。

这是我试图用来重写的代码，但它也为我的静态文件提供重写服务

```
if (!-e $request_filename)
{
    rewrite ^/(.*)$ /?/$1 last;
    break;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:58:14.357

这应该有效：

```
server {
    listen          1.2.3.4:80;
    server_name     domain.eu;
    root            /usr/local/www/domain.eu/public;

    try_files       $uri @rewrites;

    location @rewrites {
        rewrite   ^/favicon.ico$   /pictures/favicon.ico   last;
        rewrite   ^                /index.html             last;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T00:45:35.477

你实际上不需要在 nginx 中重写，只需像这样使用 try_files ：

```
location / {
  try_files $uri /index.html;
} 
```

这适用于所有网址：

1.  尝试精确的静态文件名匹配，如果存在则提供它
2.  如果 1 没有提供任何服务，则改为 server /index.html

见[http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files](http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files)

# rest - How to deal with timed out POST requests

> ID：13316357
> 
> 赞同：14
> 
> 时间：2012-11-09T21:34:09.920
> 
> 标签：rest, timeout, http-post, soa

In a RESTful SOA, suppose I issue a POST request via AJAX but I don't get a response before the request times out. Further suppose a re-submission of the request would be harmful. POST is not idempotent. For example, maybe I am posting a bank transfer of money. If I don't get a response, I don't know if the server processed the request.

What is the best practice to deal with this, assuming I have control over the client-side and the services side?

My initial thought is to include a nonce (i.e. a pseudo-id; some sort of unique identifier) with each POST request; e.g. perhaps a value in the If-None-Match header. With this approach, the client-side can programmatically re-issue a timed out request with the same pseudo-id and the server can reject it if it contains a repeat value.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-12T11:54:46.740

There are a number of ways I've heard of to try to solve this

1.  Get the current state.

    Design the service so that if a POST fails, the client can issue a GET on the same resource and based on the data returned, they can determine if the POST was successful of not.

    The problem with this approach is in cases where the POST creates a new item in a collection, it could be difficult for the client to determine if the post was successful or not (i.e., did my post add that item or did someone else's?)

2.  If-Match

    Use the `If-Match` header to prevent the POST from being repeated. e.g., if the POST is adding an item to a collection, and the collection currently has a `ETag` of `737060cd8c284d8af7ad3082f209582d`. If `If-Match` of `737060cd8c284d8af7ad3082f209582d` is used on the POST, then the POST will only succeed if the collection's `ETag` is still `737060cd8c284d8af7ad3082f209582d`, which will add the item and result in a new `ETag` for the collection. Repeating the POST at this stage will just return `412 Precondition Failed`.

    The problem with this approach is the when you get a `412 Precondition Failed`, you can't be sure if your POST modified the collection or someone else's.

3.  POST then PUT

    Design your service to never persist data from a POST. Instead the POST creates a temporary resource with the POST content, which is in a "Pending" state. This temporary resource is then "committed" with a PUT. With this approach you don't care if your POST time's out, just request the POST again and this time you'll hopefully get your temporary resource. If the PUT to commit the resource time's out, you don't care either, because the PUT is idempotent.

    The only real downside of this approach is the extra work required to manage the temporary resources and the extra effort required in the client.

    **Update**

4.  Nonce

    The use of a nonce (a.k.a Message ID, Transaction ID, Request ID, Correlation ID) in the request is a common approach for solving this problem; however it can have scalability issues. If you commit to rejecting all POSTs that use a previous nonce, you then need to scan the existing POST records to determine if the nonce has been used before. Not a problem when you have only a few thousand POSTs, but it can become problematic when you have millions (especially if you haven't stored the nonces in a way that is fast to query).

    You can mitigate this by reducing your commitment to rejecting all POSTs that use a previous nonce within a certain timeframe (e.g., last 24hrs), but if the first POST times out and the client is disconnected for that timeframe, then they are back in the same old position, where they don't know if the first POST was successful and have no way to determine if they should rePOST or not.

# php - 重新运行 PHP 脚本而不会丢失存储在变量中的值

> ID：13316359
> 
> 赞同：0
> 
> 时间：2012-11-09T21:34:13.753
> 
> 标签：php, html

如何使用第一次运行 PHP 变量时存储的相同值再次执行 PHP 脚本？

例如：
HTML：

```
<html>
<body>
<form method="post" action="php\test.php">
<input type="text" name="length" />
<input type="submit" value="Run again!" />
</form>
</body>
</html> 
```

php\test.php：

```
<html>
<body>
<?php
$length = $_POST['length'];
echo $length;
?>
<form method="POST" action="php\test.php">
<input type="submit" value="Run again!" />
</form>
</body>
</html> 
```

如何使按钮再次运行脚本而不会丢失在文本框中输入的“长度”值？当我单击按钮时，我收到一条错误消息，提示找不到“长度”。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:36:54.363

将变量放入隐藏输入中：

```
<input type="hidden" name="myvariable" value="value-from-first-run"> 
```

或使用会话来。

PS：修复你的`action`. 即使在 Windows 上，您也应该使用`/`not 。`\`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T21:38:10.583

您需要做的就是在输入 HTML 字段中打印长度参数的值：

```
php\test.php:
<html>
<body>
<?php
$length = $_POST['length'];
echo $length;
?>
<form method="POST" action="php\test.php">
<input type="submit" value="Run again!" />
<input type="text" value="<?php echo $length?>" name="length" />
</form>
</body>
</html> 
```

理想情况下，您应该验证发布数据以确保您不会得到任何令人讨厌的惊喜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:36:35.077

我建议将它们存储在`$_SESSION`. 如果这不起作用我将它们存储在数据库中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T21:39:23.083

将变量放在隐藏的输入字段中：

```
<input type="hidden"
       name="length"
       value="<?php echo htmlspecialchars($_POST['length']); ?>"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-09T21:59:59.530

您将长度存储在 $_SESSION 中。像这样：

```
<html>
<body>
<?php
session_start();

//  First form
$form1 = '<form method="post" action="">
<input type="text" name="length" />
<input type="submit" value="Run again!" />
</form>';

// Resend form
$form2 = '<form method="POST" action="">
<input type="submit" value="Run again!" />
</form>';

if (isset($_POST['length'])) {
    $length = $_SESSION['length'] = $_POST['length'];
    print $length . '<br>';
    print $form2;
} else if (isset($_SESSION['length'])){
    $length = $_SESSION['length'];
    print $length . '<br>';
    print $form2;
} else {
    print $form1;
}
?>
</body>
</html> 
```

# jsf - CSS样式在JSF页面上闪烁和消失

> ID：13316364
> 
> 赞同：0
> 
> 时间：2012-11-09T21:34:56.977
> 
> 标签：jsf, primefaces

我在 jsf 文件上有 primeface p:panel。我在模板页面 (anasayfa.xhtml) 上应用以下样式的背景颜色。

```
<h:head>
    <style type="text/css">
.bos{background-color:red;}
</style>
</h:head> 
```

我的带有 viewscoped 支持 bean 的 Jsf 页面：

```
<ui:composition template="/anasayfa.xhtml">
    <ui:define name="ortaAlan">
...

<p:panel styleClass="bos">
...
</p:panel>

</ui:define>
</ui:composition> 
```

当我加载页面时，很快就会看到背景颜色，然后变得透明。CTRL+F5 具有相同的效果。

这里有什么问题？提前感谢您的帮助

![面板的选择器和计算样式](../Images/5375186a41b59d2bddb4220d36a6e531.png)

* * *

jsf页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="/anasayfa.xhtml">
    <ui:define name="ortaAlan">
    <p:panel id="rezerveleriniz">
            <h:outputText value="#{rezervasyonBean.bugun.time}">
                <f:convertDateTime pattern="dd/MM/yyyy" />
            </h:outputText> : Rezervasyon Saatleri <br/>

    <ui:repeat var="r" value="#{rezervasyonBean.kullaniciRezervasyonSaatleri}">
    #{r.saatAraligi}<br/>
    </ui:repeat>

    </p:panel>

        <h:form id="aaa">

<p:panel>
<p:panel style="float:left;">
            <h:panelGrid columns="1">
            <ui:repeat var="rs" value="#{rezervasyonBean.rezervasyonSaatleriListesi}">

**// !!!!!!!!!!!! Problem is here !!!!!!!!**

                <p:panel styleClass="#{rezervasyonBean.isRezervasyonOnThisDay(rs) ? 'dolu' : 'bos' }">
                    #{rs.saatAraligi}
                    <h:commandButton action="#{rezervasyonBean.sec(rs,'1')}" value="+" update=":rezerveleriniz" disabled="#{rezervasyonBean.isRezervasyonOnThisDay(rs)}" />
                </p:panel>
            </ui:repeat>
            </h:panelGrid>

            <h:commandButton action="#{rezervasyonBean.kaydet()}" value="Kaydet" />
</p:panel>

<div style="clear:both;"></div>
</p:panel>
        </h:form>
    </ui:define>
</ui:composition>
</html> 
```

模板：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <title>Görev Takip Sistemi</title>
    <style type="text/css">
        .ui-widget,.ui-widget .ui-widget {
            font-size: 12px !important;
            font-family:Arial;
        }

.bos{
background-color:red;
}
.dolu{
background-color:yellow;
}

        #topPanel {z-index:2 !important; }
        #topPanel div{overflow:visible;}

        .colStyle_panelGridForGorev{
            width:225px;
        }
        .colStyle_panelGridForProfil{
            width:100px;
        }
    </style>

</h:head>
<body>  

    <p:growl for="growlForAnasayfa" showDetail="true" life="3000" autoUpdate="true"/>

    <h:form>
        <p:idleMonitor timeout="900000">  
            <p:ajax event="idle" listener="#{anasayfaBean.indirectLogout}"/>  
        </p:idleMonitor>  
    </h:form>

    <p:ajaxStatus onstart="statusDialog.show();" onsuccess="statusDialog.hide();" />  

    <p:dialog modal="true" widgetVar="statusDialog" header="Status"   
            draggable="false" closable="false">  
        <p:graphicImage value="/images/statusBar.gif" />  
    </p:dialog> 

    <p:layout fullPage="true">

        <p:layoutUnit position="north" size="50"  id="topPanel" style="border:0px">
            <h:form id="formAnaSayfaToolbar">
                <p:toolbar>
                    <p:toolbarGroup align="left">
                        <p:commandButton type="submit" value="#{anasayfaBean.kullanici.kullaniciAdi} #{anasayfaBean.kullanici.kullaniciSoyadi}" 
                            style="margin-left:200px;" action="/profil.xhtml?faces-redirect=true" ajax="false"/>
                        <p:commandButton type="submit" value="Gruplarım" 
                            action="/kullanici/gruplarim.xhtml?faces-redirect=true" ajax="false" rendered="#{!anasayfaBean.daireBaskani}"/>
                        <p:commandButton type="submit" value="Görevlerim" 
                            action="/gorevListele.xhtml?faces-redirect=true" ajax="false" rendered="#{!anasayfaBean.daireBaskani}"/>

                        <p:commandButton type="submit" value="Kullanıcı İşlemleri" 
                            action="/daireBaskani/kullanici.xhtml?faces-redirect=true" ajax="false" rendered="#{anasayfaBean.daireBaskani}"/>
                        <p:commandButton type="submit" value="Grup İşlemleri" 
                            action="/daireBaskani/grup.xhtml?faces-redirect=true" ajax="false" rendered="#{anasayfaBean.daireBaskani}"/>

                        <p:menuButton value="Görev İşlemleri" rendered="#{anasayfaBean.daireBaskani}">
                            <p:menuitem value="Yeni Görev Ekle" url="/daireBaskani/gorevEkle.btk" />  
                            <p:menuitem value="Gorevleri Listele" url="/gorevListele.btk" />  
                        </p:menuButton>

                        <p:menuButton value="Admin Paneli" rendered="#{anasayfaBean.admin}"> 
                            <p:menuitem value="Birim İşlemleri" url="/admin/birim.btk" />  
                            <p:menuitem value="Ünvan İşlemleri" url="/admin/unvan.btk" />  
                        </p:menuButton>

                    </p:toolbarGroup>
                    <p:toolbarGroup align="right">
                        <p:commandButton type="submit" value="Çıkış" icon="ui-icon-close" 
                            action="#{anasayfaBean.logout}" ajax="false"  style="margin-right:200px;"/>
                    </p:toolbarGroup>
                </p:toolbar> 
            </h:form>
        </p:layoutUnit>

        <p:layoutUnit position="center">
            <ui:insert name="ortaAlan">
                <h:outputText value="Yukarıdaki menüden yapmak istediğiniz işlemi seçiniz." />
            </ui:insert>
        </p:layoutUnit>

        <p:layoutUnit position="south" size="30" resizable="true" style="border-width:0px;">
            <h:form style="text-align:center; font-size:13px;">
                <h:outputText value="Bilişim Sistemleri Dairesi © 2012" />
            </h:form>
        </p:layoutUnit>

        <p:layoutUnit position="east" size="200"  id="eastPanel" style="border:0px">
        </p:layoutUnit>
        <p:layoutUnit position="west" size="200"  id="westPanel" style="border:0px">
        </p:layoutUnit>

    </p:layout>

</body>
</html> 
```

# maven - Netbeans RCP 项目的 IntelliJ 运行配置

> ID：13316369
> 
> 赞同：2
> 
> 时间：2012-11-09T21:35:39.417
> 
> 标签：maven, netbeans, intellij-idea, netbeans-platform, run-configuration

我正在与一个团队 ( [BUMMEL](https://github.com/Uko/BUMMEL "布梅尔") ) 合作一个项目，我们已经将它的构建工具从 Ant 迁移到 Maven，使其与 IDE 无关，现在我可以将它作为 Maven 项目打开到 IntelliJ 中，但我遇到了麻烦为其创建运行配置。

谁能建议我如何创建运行配置？此外，对于在 IntelliJ 上运行基于 NetBeans-RCP maven 的项目的任何其他建议表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T23:50:43.007

看起来你应该去`Edit Configurations...`添加**新**的 Maven 配置。

然后放入*工作目录：*为您的应用程序模块输入路径，对我来说它`application/`位于项目根目录中。

并在*命令行中：* field put `nbm:cluster-app nbm:run-platform`。

现在，您可以通过选择新创建的配置并按下绿色的“播放”箭头来运行您的应用程序。

# javascript - javascript用逗号分割字符串忽略引号内

> ID：13316370
> 
> 赞同：1
> 
> 时间：2012-11-09T21:35:39.530
> 
> 标签：javascript, regex

> **可能重复：**
> [用于解析 CSV 数据的 Javascript 代码](https://stackoverflow.com/questions/1293147/javascript-code-to-parse-csv-data)

我有这个字符串：

`"display, Name" <test@test.com>, display" Name <test@test.com>, test@test.com`

我想把这个字符串分成一个数组

```
array[0] = "\"display, Name\" <test@test.com>"
array[1] = "display\" Name <test@test.com>"
array[2] = "test@test.com" 
```

这是我的代码：

```
var comma = inQuotes = false;
for(var i=0;i<str.length;i++) {
            if (str[i] == '"') inQuotes = !inQuotes;
            comma = (str[i] == "," && !inQuotes)  ? true : false;
            item += (!comma) ? str[i] : "";
            if(comma || i == str.length-1) {  
                items.push(item);
                item = "";
            }    
        } 
```

我的问题是，如果您有一个双引号，而字符串中没有更近的

我感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:50:28.777

我试过这个，它适用于上面的字符串[jsfiddle](http://jsfiddle.net/jtZd6/4/)

```
var a = '"display, Name" <test@test.com>, display" Name <test@test.com>, test@test.com';
var aa = a.match(/"(.*?)"(.*?),|(.*?),|(.*?)$/g); 
aa.pop();
aa // [""display, Name" <test@test.com>,", " display" Name <test@test.com>,", " test@test.com"] 
```

# iphone - 带有手势识别器的 UIImageView Xcode Ios

> ID：13316372
> 
> 赞同：0
> 
> 时间：2012-11-09T21:35:56.787
> 
> 标签：iphone, xcode, uiimageview, gestures

我有一个`UIImageView`手势识别器（缩放、旋转、翻译）。

但使用后，手势不起作用。

而我`UIImageview`的改变大小和位置。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T03:52:29.220

默认情况下，UIImageViews 没有启用用户交互。尝试将 UIImageView 的用户交互设置为“YES”：

```
[myImageView setUserInteractionEnabled:YES]; 
```

# knockout.js - Knockout.js 映射插件不调用对象中数组的“创建”或“更新”属性

> ID：13316375
> 
> 赞同：1
> 
> 时间：2012-11-09T21:36:07.787
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-2.0

如果数组嵌套在对象中，则不会调用 Knockout.js 映射插件的“创建”和“更新”回调。特别是，人们会期望调用`view_model.mappedCreate({})`会触发回调。

这是一个示例，给定这样的数据结构和映射：

```
var data = {
    Test: {
        Items: [
            { Name: "Red", Count: 0},
            { Name: "Green"}
        ]
    },
    NewItem: ""
},
    counter = 0;

var vm = ko.mapping.fromJS(data, {
    Test: {
        Items: {
            create: function(options) {
                options.data.Count = ++counter;
                console.log("Data:", options.data);
                return ko.mapping.fromJS(options.data);
            },
            update: function(options) {
                options.data.Count = ++counter;
                console.log("Data:", options.data);
                return ko.mapping.fromJS(options.data);
            }
        }
    }
}); 
```

从[这个 jsFiddle](http://jsfiddle.net/bmh_ca/NmHrL/)可以看出，上面的输出是：

```
{
  "Test": {
    "Items": [
      {
        "Name": "Red",
        "Count": 0
      },
      {
        "Name": "Green"
      }
    ]
  },
  "NewItem": ""
} 
```

此外，这些`console.log`语句永远不会被调用。

人们会期望的第二个元素`Items`是`{"Name": "Green", "Count": 1 }`（并且执行 console.log 语句）。

当`Items`没有嵌套时，它按预期工作 - 正如您在[这个 jsFiddle](http://jsfiddle.net/bmh_ca/4anau/)中看到的那样。

我可能忽略了一些明显的事情，但无论如何我都会感谢有关如何解决这个问题的见解和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:53:38.700

答案似乎是使数组名称的映射成为顶级，如下所示：

```
var vm = ko.mapping.fromJS(data, {
        Items: {
            create: function(options) {
                options.data.Count = ++counter;
                console.log("Create:", options.data);
                return ko.mapping.fromJS(options.data);
            },
            update: function(options) {
                options.data.Count = ++counter;
                console.log("Update:", options.data);
                return ko.mapping.fromJS(options.data);
            }
        }
}); 
```

根据[这个 jsFiddle](http://jsfiddle.net/bmh_ca/NmHrL/1/)。

我在其他地方的代码中仍然遇到问题，但显然上面说明的问题不是它。

# time - SSIS如何比较时间字段

> ID：13316376
> 
> 赞同：1
> 
> 时间：2012-11-09T21:36:09.220
> 
> 标签：time, ssis, compare

我得到一个 DT_DBTime 类型的时间列。（例如 05:00:21.0000000）。现在我需要将此时间列与特定时间段进行比较。但是，当我以这种方式编写时，它会显示错误：

```
[Time]>="05:00:00.0000000"&&[Time]<="05:01:00.0000000" 
```

有什么方法可以比较时间值而不转换为字符串类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:18:49.227

您应该能够转换您的字符串并以这种方式进行比较：

```
[Time] >= (DT_DBTime)"05:00:00.0000000" && [Time] <= (DT_DBTime)"05:01:00.0000000" 
```

如果这不起作用，请尝试使用 CONVERT：

```
[Time] >= CONVERT(DATETIME,"05:00:00.0000000") && [Time] <= CONVERT(DATETIME,"05:01:00.0000000") 
```

# fortran - Fortran：整数到字符串示例

> ID：13316378
> 
> 赞同：2
> 
> 时间：2012-11-09T21:36:25.097
> 
> 标签：fortran

我正在尝试编写一个简单的 Fortran 代码，用于练习。它应该将某个范围内的数字相乘。每次，结果产品都被转换成一个字符串，因为我想看看它是否由相同的数字组成。

我测试了将整数转换为字符串并键入字符串的组件的方式，一切正常。然后，我需要比较字符串的组成部分，为此我使用 string(number:number)。但我无法让代码正确执行此操作。

这是代码和输出：

```
program test
implicit none
character(10) myString
character(1) a,b,c,d,e,f
integer::i,j,k
do i=900,901,1
        j=900
        k=i*j
        write(*,*)'k =', k
        write(myString,'(i10)') k
        write(*,*)'myString = ', myString
        a=myString(1:1)
        b=myString(2:2)
        c=myString(3:3)
        d=myString(4:4)
        e=myString(5:5)
        f=myString(6:6)
        print*,a,b,c,d,e,f
        if (d==f) then
            print*,'hobla'
        else
            print*,'fobla'
        end if
end do

stop
end program test 
```

所以我定义了字符：a,b,c,d,e,f 来包含字符串的组成部分。并使用 myString(i:i) 定位每个组件并将其存储在字符 a、b、c、d、e、f 之一中。但似乎只有前两个工作正常，其余的没有被存储！

输出：

```
 k =      810000
 myString =     810000
     81
 fobla
 k =      810900
 myString =     810900
     81
 fobla 
```

注意 81。这应该是第一次给出 810000，并打印“hobla”。并第二次给810900并打印“fobla”。但这并没有发生！

谁能告诉我如何让 myString 接受零作为字符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T22:10:30.487

这个说法

```
write(myString,'(i10)') k 
```

将 k 的值写入 10 个字符的字段。由于 k 只有 6 个有效数字，因此其中的前 4 个字符`myString`用空格填充。然后将前 6 个字符`myString`（即 4 个空格和数字 8 和 1）分配给变量`a,b,c,d,e,f`并打印出来——4 个空格和 2 个数字。

尝试打印出位置的其他字符，`7..10`您`myString`应该会看到“丢失”的数字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-09T22:11:42.433

好的，所以我发现了问题所在。考虑对您的代码进行以下修改：

```
program test
implicit none
character(10) myString
character(1) a,b,c,d,e,f
integer::i,j,k
do i=900,901,1
   j=900
   k=i*j
   write(*,*)'k =', k
   write(myString,'(i10)') k
   write(*,*)'myString = ', myString
   a=myString(1:1)
   b=myString(2:2)
   c=myString(3:3)
   d=myString(4:4)
   e=myString(5:5)
   f=myString(6:6)
   write(*,*) a
   write(*,*) b
   write(*,*) c
   write(*,*) d
   write(*,*) e
   write(*,*) f
   if (d==f) then
       print*,'hobla'
   else
       print*,'fobla'
   end if
end do

stop
end program test 
```

结果输出是：

```
 k =      810000
 myString =     810000

 8
 1
 fobla
 k =      810900
 myString =     810900

 8
 1
 fobla 
```

发生这种情况是因为`I`格式在打印时右对齐数字。所以有一堆前导空格，因为你的数字只有 6 位，而你正在写入的字符串是 10。所以你得到 4 个前导空格。

如果您更改格式字符串，您将拥有：

```
write(myString,'(i10.10)') k 
```

然后不是用空格填充，而是用 0 填充。这样，如果您愿意，您总是可以有数字进行比较。

# javascript - 在 IE8 中扩展 Element.prototype 时出现“对象不支持方法”错误

> ID：13316379
> 
> 赞同：1
> 
> 时间：2012-11-09T21:36:29.873
> 
> 标签：javascript, dom, prototype, extend, chain

我了解 IE8 支持`Element`对象的扩展。我尝试了一个简单的示例，它适用于 Google Chrome，但不适用于 IE8。这是我的代码，[**这是查看我的代码的 jsfiddle**](http://jsfiddle.net/eJsbZ/)：

**HTML**

```
<div id='test'>Hi</div> 
```

**JavaScript**

```
Element.prototype.test = function(){
  alert('yup');
}

document.getElementById('test').test(); 
```

**错误**

```
//jsfiddle.net => Object doesn't support property or method 'test'
//local test => 'Element' is undefined 
```

我究竟做错了什么？

* * *

**更新**

好的，至于本地错误，似乎IE8不喜欢我的`<!DOCTYPE>`标签。于是我又找了一个。=p IE8 对这样的事情非常严格。如果一个元素不是有效的 HTML，IE8 将不会在诸如`document.getElementsByTagName()`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:00:59.670

MooTools 覆盖了基线`Element`。

查看

```
var e = document.getElementById('test');
console.log(e instanceof Element); 
```

使用 MooTools 返回 false，使用除 MooTools 以外的任何内容都应返回 true。

# entity-framework - 优化 LINQ To Entities 查询

> ID：13316387
> 
> 赞同：0
> 
> 时间：2012-11-09T21:37:22.240
> 
> 标签：entity-framework, linq-to-entities

好的，假设我有两个实体，A 和 B。对于每个用户，可能有 0 个或多个 A，具有 UserId（外键）、GroupName 和 Name 属性的唯一组合。实体 A 还具有“值”属性。同样对于每个用户，可能有 0 个或多个 B，具有 UserID（同样是外键）和“Occurred”属性。

我的任务是找到所有 B 具有超过 7 天前的 Occurred 属性或具有超过现在的 Occurred 属性 - 特定 A 属性中的小时数。这段代码似乎完美地工作：

```
DateTime now = DateTime.UtcNow;
DateTime expired = now - TimeSpan.FromDays(7d);

using (DatabaseContext context = DatabaseContext.Create())
{
  IQueryable<A> aQ = context.As.Where(a => a.GroupName == "Notifications" && s.Name == "Retention");

  IQueryable<B> bQ = context.Bs.Where(
    n => aQ.Any(a => a.UserId == b.UserId) ?
      b.Occurred < EntityFunctions.AddHours(now, -aQ.FirstOrDefault(a => a.UserId == b.UserId).Value) : 
      b.Occurred < expired);

  IList<B> bs = bQ.ToList();
  // ...
} 
```

这会产生一个 SQL 查询，如下所示：

```
SELECT 
[Extent1].[ID] AS [ID], 
[Extent1].[OCCURRED] AS [OCCURRED], 
[Extent1].[USERID] AS [USERID], 
FROM [dbo].[B] AS [Extent1]
OUTER APPLY  (SELECT TOP (1) 
  [Extent2].[GROUPNAME] AS [GROUPNAME], 
  [Extent2].[NAME] AS [NAME], 
  [Extent2].[USERID] AS [USERID], 
  [Extent2].[VALUE] AS [VALUE], 
  FROM [dbo].[A] AS [Extent2]
  WHERE (N'Notifications' = [Extent2].[GROUPNAME]) AND (N'Retention' = [Extent2].[NAME]) AND ([Extent2].[USERID] = [Extent1].[USERID]) ) AS [Element1]
  OUTER APPLY  (SELECT TOP (1) 
    [Extent3].[GROUPNAME] AS [GROUPNAME], 
    [Extent3].[NAME] AS [NAME], 
    [Extent3].[USERID] AS [USERID], 
    [Extent3].[VALUE] AS [VALUE], 
    FROM [dbo].[A] AS [Extent3]
    WHERE (N'Notifications' = [Extent3].[GROUPNAME]) AND (N'Retention' = [Extent3].[NAME]) AND ([Extent3].[USERID] = [Extent1].[USERID]) ) AS [Element2]
  WHERE (CASE WHEN ( EXISTS (SELECT 
    1 AS [C1]
    FROM [dbo].[A] AS [Extent4]
    WHERE (N'Notifications' = [Extent4].[GROUPNAME]) AND (N'Retention' = [Extent4].[NAME]) AND ([Extent4].[USERID] = [Extent1].[USERID])
  )) THEN CASE WHEN ( CAST( [Extent1].[OCCURRED] AS datetime2) < (DATEADD (hours,  -([Element1].[VALUE]), @p__linq__0))) THEN cast(1 as bit) WHEN ( NOT ( CAST( [Extent1].[OCCURRED] AS datetime2) < (DATEADD (hours,  -([Element2].[VALUE]), @p__linq__0)))) THEN cast(0 as bit) END WHEN ([Extent1].[OCCURRED] < @p__linq__1) THEN cast(1 as bit) WHEN ( NOT ([Extent1].[OCCURRED] < @p__linq__1)) THEN cast(0 as bit) END) = 1 
```

请注意，我已经从实际的东西中破解了代码和 SQL 查询，所以这可能不是完美的表示。但我希望它明白这一点：这看起来有点毛茸茸，至少在查询重复检查 A 以匹配组名、名称和用户的方式上。但我不是数据库专家。我所知道的是，一个观察到的执行运行了大约 2.5 秒。

有没有更好的方法来解决这个问题？

感谢您的任何意见！

- - 解决方案 - -

感谢格特。

代码的查询结果如下：

```
var bQ =
  from b in context.Bs
  let offset = aQ.FirstOrDefault(a => a.UserId == b.UserId)
  let expiration = (null != offset) ? EntityFunctions.AddHours(now, -offset.Value) : expired
  where b.Occurred < expiration
  select b; 
```

这几乎正​​是格特所建议的。新的 SQL 查询如下所示：

```
SELECT 
[Extent1].[ID] AS [ID], 
[Extent1].[OCCURRED] AS [OCCURRED], 
[Extent1].[USERID] AS [USERID]
FROM  [dbo].[B] AS [Extent1]
OUTER APPLY  (SELECT TOP (1)
  [Extent2].[GROUPNAME] AS [GROUPNAME], 
  [Extent2].[NAME] AS [NAME], 
  [Extent2].[USERID] AS [USERID], 
  [Extent2].[VALUE] AS [VALUE]
  FROM [dbo].[A] AS [Extent2]
  WHERE (N'Notifications' = [Extent2].[GROUPNAME]) AND (N'Retention' = [Extent2].[NAME]) AND ([Extent2].[USERID] = [Extent1].[USERID]) ) AS [Element1]
  WHERE CAST( [Extent1].[OCCURRED] AS datetime2) < (CASE WHEN ([Element1].[ID] IS NOT NULL) THEN DATEADD (hour, -([Element1].[VALUE]), @p__linq__0) ELSE @p__linq__1 END) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T16:15:11.330

我认为这只会查询`A`一次表：

```
from b in context.Bs
    let offset = aQ.FirstOrDefault(a => a.UserId == b.UserId).Value
    let dd = offset.HasValue
        ? EntityFunctions.AddHours(now, -offset)
        : expired
where b.Occurred < dd 
```

# android - ScheduledExecutorService vs Timer vs Handler

> ID：13316392
> 
> 赞同：17
> 
> 时间：2012-11-09T21:37:56.797
> 
> 标签：android, concurrency, timer, java.util.concurrent

`ScheduledExecutorService`使用/ `Timer`/的优缺点是 `Handler`什么？正如我在 Android 中所理解的那样，`Timer`它不是需要使用的`Handler`，但是呢`ScheduledExecutorService`？

据我了解`Handler`，`ScheduledExecutorService`仅适用于相对时间，对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-20T16:19:22.417

这三个都允许您在不同的（例如非主）线程上执行任务。[Handler](https://developer.android.com/reference/android/os/Handler.html)允许您使用消息传递 Actor 模式在线程之间进行安全通信。它不允许您进行计时/延迟/等。

[ScheduledExecutorService](https://developer.android.com/reference/java/util/concurrent/ScheduledExecutorService.html)是一个非常通用的线程管理解决方案。你用一定数量的工作线程初始化它，然后给它工作单元。您可以延迟/计时和重复工作单元。

[Timer](https://developer.android.com/reference/java/util/Timer.html)类有一个类似于 ScheduledExecutorService的简单 API，用于一次性、单线程使用。官方 API 建议不要使用此类，而是使用您自己的 ScheduledExecutor。

# google-maps-api-3 - 谷歌自定义街景全景与自定义图像地图类型地图没有地理参考

> ID：13316393
> 
> 赞同：0
> 
> 时间：2012-11-09T21:37:56.700
> 
> 标签：google-maps-api-3

我正在开发一个没有地理参考的自定义图像地图类型地图，即我的地图的纬度与那个地方的实际纬度无关。现在，我还在该地图中创建了某些建筑物和地点的自定义街景全景图。

问题是无法将这些自定义街景全景图与我的自定义图像地图集成。

以下是查看发生了什么的链接：

[http://cdi.astateweb.org/virtual_tour/](http://cdi.astateweb.org/virtual_tour/)

第一种方法：现在地图上有两个标记。当您单击它们时，会弹出一个小的信息气泡。现在，当您单击虚拟游览链接时，会出现一个对话框。我想在该对话框中加载自定义街景全景图。我尝试了几件事，但无济于事。我正在尝试为两个标记重用相同的对话框。我尝试在 jquery ui 对话框打开功能中初始化全景图。它适用于第一个，但是当您关闭对话框并再次打开它时，它会因来自 google apis 的一些 cbk 错误而失败。

第二种方法：我尝试使用默认的街景街景小人，这样当街景小人被放到某个具有全景的建筑物或地方时，街景就会像普通的谷歌地图一样出现。这也不起作用。

有人可以指出我正确的方向。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T06:25:33.167

好的，试试这样：

**在第 41 行更改**

```
from
'<a href="#" id="virtual-tour" data="delta">Virtual Tour</a>'
to
'<a href="#" id="virtual-tour" data="arch">Virtual Tour</a>' 
```

**在第 96 行更改**

```
 $("#dialog").dialog({
        autoOpen: false,
        width: 650,
        open: function() {
          console.log($("#" + virtualTour.currentPano));
          $("#" + virtualTour.currentPano).appendTo("#dialog").css("display", "block");
        },
        close: function() {
          $("#" + virtualTour.currentPano).appendTo("body").css("display", "none");
        }

    }); 
```

并将以下代码添加到“ **createMarker** ”函数中。

```
 //After this line.
    virtualTour.hotspotArray.push(marker);      

    //Add this code.
    setTimeout(function(){
      document.getElementById(pano).style.display = "none";
    }, 100); 
```

![在此处输入图像描述](../Images/7756d84170b795b8bddeb8311c9b4437.png)

# python - Matplotlib-Animation “没有可用的 MovieWriters”

> ID：13316397
> 
> 赞同：69
> 
> 时间：2012-11-09T21:38:31.320
> 
> 标签：python, linux, animation, matplotlib, runtime-error

在Linux下，我一直在检查matplotlib的动画类，它似乎可以工作，只是我无法初始化电影作者来写出电影。

使用任一示例：

*   [http://matplotlib.org/examples/animation/moviewriter.html](http://matplotlib.org/examples/animation/moviewriter.html)
*   [http://matplotlib.org/examples/animation/basic_example_writer.html](http://matplotlib.org/examples/animation/basic_example_writer.html)

导致错误“ **RuntimeError: No MovieWriters available!** ”

我使用 matplotlib 1.3.x 版并安装（希望）所有编解码器。

有人可以建议我为什么会收到此错误吗？如果是编解码器问题，我应该安装哪些编解码器（+版本）？如果它的其他东西坏了，是否有在 python 中创建动画的替代方法？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2017-06-11T11:05:59.313

对于使用 Anaconda 的谷歌同事，请安装[ffmpeg](https://anaconda.org/search?q=%20ffmpeg%20)包：

```
conda install -c conda-forge ffmpeg 
```

这也适用于 Windows。

（原始答案使用`menpo`包所有者，但正如@harsh 所提到的，他们的版本在撰写本文时有点落后）

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-01-29T02:53:47.307

有同样的问题....设法让它在一段时间后工作。

要做的是按照安装 FFmpeg 的说明进行操作 - 这是（至少在 Windows 上）您需要在环境变量中设置路径的可执行文件包

[http://www.wikihow.com/Install-FFmpeg-on-Windows](http://www.wikihow.com/Install-FFmpeg-on-Windows)

[从 ffmpeg.org 下载](https://ffmpeg.org/download.html)

希望这对某人有所帮助 - 即使在问题之后一段时间 - 祝你好运

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-10-20T13:05:37.013

我知道这个问题是关于 Linux 的，但如果有人像我在这里所做的那样在 Mac 上偶然发现这个问题，那就是解决方案。我在 Mac 上遇到了完全相同的问题，因为`ffmpeg`默认情况下显然没有安装，所以我可以使用以下方法解决它：

```
brew install yasm
brew install ffmpeg 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-09-05T08:12:57.813

在Linux下也有同样的问题。默认情况下， animate.save 方法使用的是 ffmpeg，但它似乎已被弃用。 [https://askubuntu.com/questions/432542/is-ffmpeg-missing-from-the-official-repositories-in-14-04](https://askubuntu.com/questions/432542/is-ffmpeg-missing-from-the-official-repositories-in-14-04)

解决方案：安装一些编码器，如 avconv 或 mencoder。在调用中提供替代编码器：

```
ani.save('the_movie.mp4', writer = 'mencoder', fps=15) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-08-13T17:34:57.510

如果您使用的是 Ubuntu 14.04 `ffmpeg`，则不可用。您可以使用[https://www.ffmpeg.org/download.html](https://www.ffmpeg.org/download.html)中的说明直接安装它。

简而言之，您必须：

```
sudo add-apt-repository ppa:mc3man/trusty-media
sudo apt-get update
sudo apt-get install ffmpeg gstreamer0.10-ffmpeg 
```

如果这不起作用，可以尝试使用`sudo apt-get dist-upgrade`，但这可能会破坏系统中的东西。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-05-24T07:31:36.670

运行单元时出现以下错误。 [![在此处输入图像描述](../Images/aa1c2aa3b4d8ffc6251db8fe92517094.png)](https://i.stack.imgur.com/rSbF3.png)

这可能是由于`ffmpeg`您的系统中没有。在终端中尝试以下命令。

```
sudo apt install ffmpeg 
```

这对我有用。我希望它也适合你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-10-11T20:16:13.593

我正在运行 Ubuntu 20，我遇到了类似的问题

安装了ffmpeg

`pip install ffmpeg`

然后

`sudo apt install ffmpeg`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-18T22:55:32.227

（请务必遵循上面关于正确 ffmpeg 下载的 JPH 反馈）不知道为什么，但在我的情况下，这是一个有效的方法（在我的情况下是在 Windows 上）。

初始化一个作家：

```
import matplotlib.pyplot as plt
import matplotlib.animation as animation
Writer = animation.FFMpegWriter(fps=30, codec='libx264')  #or 
Writer = animation.FFMpegWriter(fps=20, metadata=dict(artist='Me'), bitrate=1800) ==> This is WORKED FINE ^_^ 
```

Writer = animation.writers['ffmpeg'] ==> GIVES ERROR ""RuntimeError: Requested MovieWriter (ffmpeg) not available""

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-06T16:11:16.147

如果出现错误“MovieWriter imagemagick 不可用；请改用 Pillow。” 弹出，尝试通过以下方式显式导入 PillowWriter 以另存为 mp4-File：

```
from matplotlib.animation import FuncAnimation, PillowWriter 
```

# php - PHP：在创建选择框时重复，只需要最高值的 INT

> ID：13316400
> 
> 赞同：0
> 
> 时间：2012-11-09T21:38:58.777
> 
> 标签：php, zend-framework, code-duplication

我在这里遇到了一些重复问题，我相信只要我的重复值的返回值仍然是最大的 int 值，我就可以在任何时候剪辑重复值。

这是一个代码戳：

```
 $unitList = Base_Client_Model::getBusinessUnitList(false, $selectedMarket, false, true);
    $marketListBox = $marketOptions = '';
    $marketList = array();

    for ($x = 1; $x <= $unitList['NUMBER_OF_BUSINESS_UNITS']; $x++) {
    $unitStr = 'BUSINESS_UNIT_' . $x . '_';

        $businessUnit = Base_Client_Model::getBusinessUnit($unitList[$unitStr . 'ID']);
        if ($unitList[$unitStr . 'ID'] && $unitList[$unitStr . 'ID'] != 42) {
            $marketListBox = "<option value='" . $unitList[$unitStr . 'ID'] . "'";
            if($selectedMarket == $unitList[$unitStr . 'ID']) {
                $marketListBox .= ' selected';
                $selectedMarket = 0;
            }

            $marketListBox .= ">&nbsp;&nbsp;&nbsp;" . preg_replace('/-Wimax/i', '', $unitList[$unitStr . 'NAME']) . "</option>\n";
            $marketList[$businessUnit->getElement('STATE')][] = $marketListBox;
        }
    }

    ksort($marketList);
    foreach($marketList as $key => $val) {
        $marketOptions .= "<option disabled='disabled'>&nbsp;</option><option disabled='disabled'>{$key}&#172;</option>\n" . implode($val);
    }

    $this->view->marketOptions = $marketOptions; 
```

这是一个示例返回：

```
<option disabled="disabled">&nbsp;</option><option disabled="disabled">WA¬</option>
<option value="56">&nbsp;&nbsp;&nbsp;Aberdeen</option>
<option value="82">&nbsp;&nbsp;&nbsp;Bellingham</option>
<option value="106">&nbsp;&nbsp;&nbsp;Everett</option>
<option value="109">&nbsp;&nbsp;&nbsp;Kitsap County</option>
<option value="102">&nbsp;&nbsp;&nbsp;Seattle</option>
<option value="105">&nbsp;&nbsp;&nbsp;Tacoma</option>
<option value="20">&nbsp;&nbsp;&nbsp;Tri-Cities</option>
<option value="173">&nbsp;&nbsp;&nbsp;Tri-Cities</option>
<option value="64">&nbsp;&nbsp;&nbsp;Wenatchee</option>
<option value="65">&nbsp;&nbsp;&nbsp;Yakima</option>
<option value="162">&nbsp;&nbsp;&nbsp;Yakima</option> 
```

这是预期的输出：

```
<option disabled="disabled">&nbsp;</option><option disabled="disabled">WA¬</option>
<option value="56">&nbsp;&nbsp;&nbsp;Aberdeen</option>
<option value="82">&nbsp;&nbsp;&nbsp;Bellingham</option>
<option value="106">&nbsp;&nbsp;&nbsp;Everett</option>
<option value="109">&nbsp;&nbsp;&nbsp;Kitsap County</option>
<option value="102">&nbsp;&nbsp;&nbsp;Seattle</option>
<option value="105">&nbsp;&nbsp;&nbsp;Tacoma</option>
<option value="173">&nbsp;&nbsp;&nbsp;Tri-Cities</option>
<option value="64">&nbsp;&nbsp;&nbsp;Wenatchee</option>
<option value="162">&nbsp;&nbsp;&nbsp;Yakima</option> 
```

我相信答案与此类似

`$unitList['BUSINESS_UNIT_' . $x . '_NAME'] != $unitList['BUSINESS_UNIT_' . $x + 1 . '_NAME']`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:45:56.660

需要比较 Wimax 和非 Wimax 市场，其中 Wimax 优先

```
 if ($unitList['BUSINESS_UNIT_' . $x . '_NAME'] .'-Wimax' != $unitList['BUSINESS_UNIT_' . ($x + 1) . '_NAME']) {
                $marketListBox = "<option value='" . $unitList[$unitStr . 'ID'] . "'";
                if($selectedMarket == $unitList[$unitStr . 'ID']) {
                    $marketListBox .= ' selected';
                    $selectedMarket = 0;
                }

                $marketListBox .= ">&nbsp;&nbsp;&nbsp;" . preg_replace('/-Wimax/i', '', $unitList[$unitStr . 'NAME']) . "</option>\n";
                $marketListArray[$businessUnit->getElement('STATE')][] = $marketListBox;
            } 
```

# html - 输入的宽度是否比其他元素占用更多空间？

> ID：13316405
> 
> 赞同：0
> 
> 时间：2012-11-09T21:39:27.087
> 
> 标签：html, css, input, width

我对如何提出这个问题并不积极，但如果你看一下[这个 jsfiddle](http://jsfiddle.net/5ay3J/)，你可以看出我的跨度的宽度与我的输入的宽度是不同的，尽管它们都表示为 14% 500px 父元素。(7 x 14% = 98%)。

HTML：

```
<div class="timesheet-subheader-weekdays-div">
    <span id="timesheet-subheader-monday" class="timesheet-subheader-weekday">Mon<br /></span>
    <span id="timesheet-subheader-tuesday" class="timesheet-subheader-weekday">Tue<br /></span>
    <span id="timesheet-subheader-wednesday" class="timesheet-subheader-weekday">Wed<br /></span>
    <span id="timesheet-subheader-thursday" class="timesheet-subheader-weekday">Thu<br /></span>
    <span id="timesheet-subheader-friday" class="timesheet-subheader-weekday">Fri<br /></span>
    <span id="timesheet-subheader-saturday" class="timesheet-subheader-weekday">Sat<br /></span>
    <span id="timesheet-subheader-sunday" class="timesheet-subheader-weekday">Sun<br /></span>
</div>
<div class="timesheet-daily-entry-fields-container">
    <input id="TimesheetMondayHours" class="timesheet-daily-input timesheet-monday-hours"/>
    <input id="TimesheetTuesdayHours" class="timesheet-daily-input timesheet-tuesday-hours"/>
    <input id="TimesheetWednesdayHours" class="timesheet-daily-input timesheet-wednesday-hours"/>
    <input id="TimesheetThursdayHours" class="timesheet-daily-input timesheet-thursday-hours"/>
    <input id="TimesheetFridayHours" class="timesheet-daily-input timesheet-friday-hours">
    <input id="TimesheetSaturdayHours" class="timesheet-daily-input timesheet-saturday-hours"/>
    <input id="TimesheetSundayHours" class="timesheet-daily-input timesheet-sunday-hours"/>
</div>​ 
```

CSS：

```
.timesheet-subheader-weekdays-div {    
    position:relative;
    float:left;
    width:500px;
}
.timesheet-subheader-weekday {
    position:relative;
    float:left;
    width:14%;
    text-align:center;
    line-height:15px;
    font-size:11px;
}
.timesheet-daily-entry-fields-container {
    position:relative;
    float:left;
    width:500px;
}
.timesheet-daily-input {
    position:relative;
    float:left;
    width:14%;
    text-align:center;
}​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T21:43:59.777

这是因为输入框上的边框。输入的边框默认为 1px。因此，边框添加的额外宽度导致您的最后一个元素低于其余元素。

更新了您的小提琴，因此您可以通过删除边框来看到它们按您想要的方式流动。

[更新了 jsFiddle](http://jsfiddle.net/5ay3J/2/)

```
.timesheet-daily-input {
    position:relative;
    float:left;
    width:14%;
    text-align:center;

    // Added these
    border: none;
    background: red;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:45:47.713

输入框的宽度没有每个浏览器在它们周围绘制的边框（它们是使它们可见的唯一实际事物）。当您在跨度元素周围放置一个 1px 纯黑色边框时，您可以看到这一点。这就是[CSS 盒子模型](http://www.w3.org/TR/CSS2/box.html)的工作原理，简单表示如下：

> | <边距> | (边框) <填充> | <宽度> | <填充>（边框）| <边距> |

此外，如果您放置`border:none`文本框，当背景颜色与容器的颜色匹配时，它们似乎会消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:48:36.367

假设你的身体 bg 是白色的，保持 width:14% 工作的最简单方法是给你的跨度一个 1px 边框#fff。

jsfiddle.net/5ay3J/11/

# php - 将 Python 计算器转换为 PHP

> ID：13316407
> 
> 赞同：-8
> 
> 时间：2012-11-09T21:39:29.677
> 
> 标签：php, python, calculator

只是为了好玩，我正在尝试将下面编写的 python 计算器程序转换为 PHP。

谁能帮帮我/这可能吗？

该程序在下面，我想通过 PHP 获得相同的输出。

```
#!/usr/bin/env python
#
#title: calculator.py
#author: Samuel Peppard
#purpose:
#

# 1 equates a loop, everything else does not.
loop = 1 

# Contains the player's choice
choice = 0 

while loop == 1:

# Print what options you have
print " "
print "Basic Calculator Program!"

print " "
print "Select your function by typing its designated number..."

print " "
print "1) Addition"
print "2) Subtraction"
print "3) Multiplication"
print "4) Division"
print "5) Quit"
print " "

# allows for raw input to be read
choice = int(raw_input("Choose your option: ").strip())

if choice == 1:
    add1 = input("Add this amount: ")
    add2 = input("to this amount: ")
    print " "
    print add1, "+", add2, "=", add1 + add2

elif choice == 2:
    sub2 = input("Subtract this amount: ")
    sub1 = input("from this amount: ")
    print " "
    print sub1, "-", sub2, "=", sub1 - sub2

elif choice == 3:
    mul1 = input("Multiply this amount: ")
    mul2 = input("with this amount: ")
    print " "
    print mul1, "*", mul2, "=", mul1 * mul2

elif choice == 4:
    div1 = input("Divide this amount: ")
    div2 = input("by this amount: ")
    print " "
    print div1, "/", div2, "=", div1 / div2

elif choice == 5:
    loop = 0

print "Goodbye for now!" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:42:01.183

回答你的第二个问题：

> 这可能吗？

当然是的。PHP 和 python 都是图灵完备的，都可以接受控制台输入。

# jquery - jquery 滑块导航

> ID：13316408
> 
> 赞同：0
> 
> 时间：2012-11-09T21:39:31.490
> 
> 标签：jquery, animation, slider

我正在创建一个网页，它使用水平滑块和动画来滚动到隐藏的 div。当我单击主页时，我希望它转到第一个滑动面板 div，无论它在哪个滑动面板或 mainContent div 上。我一直在搞乱scrollTo，它只是向上滚动到滑动面板，但我不知道如何让它回到第一个面板。有任何想法吗？

```
$(function() {  
  $('#contact').click(function() {      
   $('#contactDiv').show();
   $.scrollTo( '#contactDiv', 800, {easing:'swing', offset:{top:-130}} );
   if (currPanel != 1)      
   /*???? idk what to do here but i want it to scroll and slide to the first slide-panel                          
 });
}); 
```

请参阅 jsFiddle 以获取完整代码：http: [//jsfiddle.net/mU9Nu/](http://jsfiddle.net/mU9Nu/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:13:25.587

也许这对您来说是一个很好的解决方案：

```
$('#home').click(function() {
    $('.slide-panel').removeClass('active');
    $( $('.slide-panel')[0] ).addClass('active');
}); 
```

`$( $('.classname')[i] )`指的是`.classname`' 就像一个数组。

# python - MySQLdb / Python：无法在数据库中插入某些字符

> ID：13316411
> 
> 赞同：2
> 
> 时间：2012-11-09T21:39:47.887
> 
> 标签：python, mysql, unicode, utf-8, mysql-python

```
#!/usr/bin/env python
# -*- coding: utf-8 -*- 

import MySQLdb

conn = MySQLdb.connect('localhost', 'django_user', 'haha123', 'mydb')
cur = conn.cursor()

f = open('/home/kave/projects/cb/database/country_code_drupal_nov_2011.txt')

cur.execute("INSERT INTO myapp_app_currency (currency) VALUES ('USD - $'),('EUR - €'), ('GBP - £'), ('CAD - $'), ('AUD - $'), ('BRL - R$');") 
```

出于某种原因，我可以成功地将这些数据插入到我的数据库中，但是有两个条目被损坏。

```
EUR - € becomes EUR - â‚¬
GBP - £ becomes GBP - Â£ 
```

我以为我已经将它设置为 utf8 并且它应该滚动，为什么只有这两个字符有问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:47:43.863

连接数据库时尝试设置字符集：

```
conn = MySQLdb.connect('host', 'usr', 'pass', 'db', charset='utf8') 
```

当你`# -*- coding: utf-8 -*-`在文档中使用时，它只适用于源代码文档，*而不*适用于它执行的内容。

# c# - 从 sqlite 表 windows 8 应用程序中读取列名

> ID：13316412
> 
> 赞同：0
> 
> 时间：2012-11-09T21:39:59.880
> 
> 标签：c#, windows, sqlite

我正在将 SQLite 用于我正在开发的数据输入 Windows 8 应用程序。我可以创建数据库、插入数据、检索列数和读取数据，但无法获取列名。

底层框架来自这篇[文章](http://wp.qmatteoq.com/using-sqlite-in-your-windows-8-metro-style-applications/)。

我阅读了有关该`PRAGMA table_info(table_name);`命令的信息，但似乎无法正确发送和读回此查询。我已经在谷歌上搜索了 3 天！

MainPage.xaml.cs：

```
using SQLite;
using SqlLiteTest.Model;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using Windows.Storage;
using Windows.UI.Popups;
using Windows.UI.Xaml;
using Windows.UI.Xaml.Controls;

namespace SqlLiteTest
{
    public sealed partial class MainPage : Page
    {
        public MainPage()
        {
            this.InitializeComponent();
            txtPath.Text = ApplicationData.Current.LocalFolder.Path;
        }

        private async void createDB(object sender, RoutedEventArgs e)
        {
            // access local folder
            var qvLocalFolder = Windows.Storage.ApplicationData.Current.LocalFolder;

            try
            {
                //Create a blank carrier file
                StorageFile qvLocalFileCarrier = await qvLocalFolder.CreateFileAsync("qvdbLocal.db", CreationCollisionOption.FailIfExists);

                //Write the blank carrier file
                await FileIO.WriteTextAsync(qvLocalFileCarrier, "");
            }
            catch { }

            // connect
            var path = Windows.Storage.ApplicationData.Current.LocalFolder.Path + @"\qvdbLocal.db";
            var db = new SQLiteAsyncConnection(path);

            // create table
            await db.CreateTableAsync<qvdb>();

            // insert data
            var insertRecords = new List<qvdb>()
            {
                new qvdb
                {
                            qvdbRecord = 1,
                            qvdbNotes = "Notes1",
                            qvdb001 = "Variable 1.1",
                            qvdb002  = "Variable 2.1"
                    },
                    new qvdb
                    {
                            qvdbRecord = 1,
                            qvdbNotes = "Notes1",
                            qvdb001 = "Variable 1.1",
                            qvdb002  = "Variable 2.1"
                    },
                    new qvdb
                    {
                            qvdbRecord = 1,
                            qvdbNotes = "Notes1",
                            qvdb001 = "Variable 1.1",
                            qvdb002  = "Variable 2.1"
                    },
            };

            await db.InsertAllAsync(insertRecords);

            // read count
            var allUsers = await db.QueryAsync<qvdb>("SELECT * FROM qvdb");
            var count = allUsers.Any() ? allUsers.Count : 0;

            Debug.WriteLine(count);
        }

        private async void updateDB(object sender, RoutedEventArgs e)
        {
            var path = Windows.Storage.ApplicationData.Current.LocalFolder.Path + @"\qvdbLocal.db";
            var db = new SQLiteAsyncConnection(path);

            var tempCell = db.QueryAsync<qvdb>("UPDATE qvdb SET qvdbNotes ='!@#$%$%^^&*()+)(*&^%$#@!{:L<>?' WHERE qvdbRecord = 10");
            await db.UpdateAsync(tempCell);
        }

        private async void readDB(object sender, RoutedEventArgs e)
        {
            var path = Windows.Storage.ApplicationData.Current.LocalFolder.Path + @"\qvdbLocal.db";
            var db = new SQLiteAsyncConnection(path);

            var query = db.Table<qvdb>();
            var result = await query.ToListAsync();
            foreach (var item in result)
            {
                MessageDialog dialog = new MessageDialog(string.Format("{0} {1} {2}", item.qvdbRecord, item.qvdbNotes, item.qvdb001));
                await dialog.ShowAsync();
            }
        }

        private void readColNames(object sender, RoutedEventArgs e)
        {
        }
    }
} 
```

qvdb.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using SQLite;

namespace SqlLiteTest.Model
{
    public class qvdb
    {
        [PrimaryKey, AutoIncrement]
        public int qvdbRecord { get; set; }

        [MaxLength(3000)]
        public string qvdbNotes { get; set; }

        [MaxLength(1000)]
        public string qvdb001 { get; set; }

        [MaxLength(1000)]
        public string qvdb002 { get; set; }

    }
} 
```

感谢 CL 提供的信息。我添加了课程，但仍然不知道如何访问它们。还有一些代码...

```
 // this works
    // read record count
    var allRecords = await db.QueryAsync<qvdb>("SELECT * FROM qvdb");
    var countRecords = allRecords.Any() ? allRecords.Count : 0;
    this.textboxLog.Text = this.textboxLog.Text + Environment.NewLine + "There are " + countRecords + " records.";

    // ??
    // read column names
    var allColumns = await db.QueryAsync<qvdb>("PRAGMA table_info(qvdb)");
    foreach (var item in allColumns) {
       //read name
        this.textboxLog.Text = this.textboxLog.Text + Environment.NewLine + "columbn names";
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T11:23:26.847

返回的记录[`PRAGMA table_info`](http://www.sqlite.org/pragma.html#pragma_table_info)如下所示：

```
public class table_info_record
{
    public int    cid        { get; set; }
    public string name       { get; set; }
    public string type       { get; set; }
    public int    notnull    { get; set; }
    public string dflt_value { get; set; }
    public int    pk         { get; set; }
} 
```

像这样使用它：

```
db.QueryAsync<table_info_record>("PRAGMA table_info(...)"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:00:16.600

o 根据 CL 的建议结束循环，此代码成功读取列名：

```
 // read column names
           var query = await db.QueryAsync<table_info_record>("PRAGMA table_info(MY_TABLE_NAME_HERE)");

            foreach (var item in query)
            {
                Debug.WriteLine(string.Format("{0}", item.name) + " is a column.");
            } 
```

# mysql - 为避免拼写错误，如何在创建新过程时让 MySql sql 编译器检查表定义？

> ID：13316414
> 
> 赞同：1
> 
> 时间：2012-11-09T21:40:29.663
> 
> 标签：mysql, sql

在 MySql 5.5.x 中有以下 DDL。

```
create table if not exists t1 (col1 int); 
```

和

```
CREATE PROCEDURE my_proc()
BEGIN
      select inexistent_column from t1;       
END; 
```

为什么创建过程没有错误？我希望它会抛出 inexistent_column 未知或不存在。如何让 MySql sql 编译器检查表定义？

**更新：改写**

我只是想要一种方法来避免在开发时在列中出现拼写错误，这意味着创建一个全新的程序。有没有办法做到这一点？也许这应该是从一开始就问的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:45:52.997

服务器只会进行语法检查，但您可以自己检查列的存在。所有现有的表和列都在`information_schema`.

您可以使用这样的查询来检查您的列是否存在：

```
SELECT * 
FROM information_schema.COLUMNS 
WHERE 
    TABLE_SCHEMA = 'your_database_name' 
AND TABLE_NAME   = 'your_table_name' 
AND COLUMN_NAME  = 'some_column' 
```

# tabs - Flexslider - 在刷新页面加载之前，第一个缩略图在屏幕上闪烁

> ID：13316417
> 
> 赞同：2
> 
> 时间：2012-11-09T21:40:44.347
> 
> 标签：tabs, icons, onload, page-refresh, flexslider

我是一个尝试在客户网站上使用 Flexslider 的 jQuery noobe。该节目运行良好，除了在加载或页面刷新时，第一个缩略图在屏幕上飞溅非常大且像素化。只有一瞬间，幻灯片才起作用。

该网站位于：[幻灯片示例](http://www.dev.ronmclegg.com/gallery_1.php)

# javascript - 在维护委托事件的同时复制存储的 jQuery 对象

> ID：13316421
> 
> 赞同：1
> 
> 时间：2012-11-09T21:41:19.760
> 
> 标签：javascript, jquery

我有一个动态表，用户可以在其中添加和删除行。当用户单击按钮添加行时，我想将存储的 jQuery 对象插入到 DOM 中，该对象是初始表行的副本`.baseRow`。在这一行中，我还希望有一个委托的单击事件，该事件对于将来添加的行保持活动状态。

但是，我当前的实现（在 Chrome/IE 中测试）出现了两个问题。第一个是点击处理程序在第一个事件被触发后中断。我可以通过链接`.html()`after来解决这个问题`.clone()`，但是当我这样做时，克隆被莫名其妙地剥离了父`tr`元素并被缩减为仅子元素。

有关问题的示例，请参[见此 js fiddle ，或在下面查看代码示例：](http://jsfiddle.net/YxB9J/3/)

**JS**

```
$('document').ready(function(){
    var $baseRow = $('.baseRow').clone(true,true); 
    $('table').delegate('.addRow','click',function(){
        $('tbody').append($baseRow);
    });
});​ 
```

**HTML**

```
<table>
    <thead>
        <tr>
            <th>Add Row</th>
            <th>Header 1</th>
            <th>Header 2</th>
        </tr>
    </thead>
    <tbody>
        <tr class="baseRow">
            <td class="addRow">+</td>
            <td>Body 1</td>
            <td>Body 2</td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:46:25.850

您克隆一次，然后一遍又一遍地附加该克隆的元素。由于只有一个克隆，因此您永远不会拥有两个以上的元素（原始 + 克隆）。相反，单击时克隆，以便克隆的数量等于点击的数量：http: [//jsfiddle.net/YxB9J/5/](http://jsfiddle.net/YxB9J/5/)。

```
$(document).ready(function(){
    var $baseRow = $('.baseRow'); 
    $('table').delegate('.addRow','click',function(){
        $('tbody').append($baseRow.clone(true, true));
    });
}); 
```

# jquery - 反转垂直新闻代码的方向

> ID：13316422
> 
> 赞同：0
> 
> 时间：2012-11-09T21:41:26.440
> 
> 标签：jquery, ticker, news-ticker

我以以下小提琴为例： http: [//jsfiddle.net/GR7pg/](http://jsfiddle.net/GR7pg/)但需要它向下移动而不是向上移动。

基本上发生的事情是我做了这一切几周，然后当我交付给客户时，他们现在希望股票代码向下移动而不是向上移动。

我能够让顶部的项目向下移动然后消失，但其余的项目仍然向上移动。我希望更熟悉 jquery 的人可以轻松更改这一点？但是我尝试了各种导致奇怪行为的调整。

非常感谢任何帮助！谢谢

```
(function ($) {
    $.fn.extend({
        vscroller: function (options) {
            var settings = $.extend({ speed: 1000, stay: 4000, newsfeed: '', cache: true }, options);

        return this.each(function () {
            var interval = null;
            var mouseIn = false;
            var totalElements;
            var isScrolling = false;
            var h;
            var t;
            var wrapper = $('.news-wrapper');
                    var newsContents = $('.news-contents');

                    var i = 0;
                    totalElements = $.find('.news').length;

                    h = parseFloat($('.news:eq(0)').outerHeight());
                    $('.news', wrapper).each(function () {
                        $(this).css({ top: i++ * h });
                    });
                    t = (totalElements - 1) * h;
                    newsContents.mouseenter(function () {
                        mouseIn = true;
                        if (!isScrolling) {
                            $('.news').stop(true, false);
                            clearTimeout(interval);
                        }
                    });
                    newsContents.mouseleave(function () {
                        mouseIn = false;
                        interval = setTimeout(scroll, settings.stay);
                    });
                    interval = setTimeout(scroll, 1);

            function scroll() {
                if (!mouseIn && !isScrolling) {
                    isScrolling = true;
                    $('.news:eq(0)').stop(true, false).animate({ top: -h }, settings.speed, function () {

                        clearTimeout(interval);
                        var current = $('.news:eq(0)').clone(true);
                        current.css({ top: t });
                        $('.news-contents').append(current);
                        $('.news:eq(0)').remove();
                        isScrolling = false;
                        interval = setTimeout(scroll, settings.stay);

                    });
                    $('.news:gt(0)').stop(true, false).animate({ top: '-=' + h }, settings.speed);
                }
            }

        });
    }
});
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:57:42.463

它主要包括将一些s 更改`top`为`bottom`s 并将增量更改为减量等。

这应该这样做[http://jsfiddle.net/GR7pg/16/](http://jsfiddle.net/GR7pg/16/)

# emacs - 有没有办法在不先打开 emacs 并使用 Mx 等的情况下启动 emacs 合并？

> ID：13316426
> 
> 赞同：2
> 
> 时间：2012-11-09T21:41:41.537
> 
> 标签：emacs

我有时想合并多对文件，假设我想合并fileA.old和fileA.new，以及fileB.old和fileB.new..等等。目前我必须打开emacs。输入第一个文件的名称，返回键，第二个文件的名称，返回键..并在合并模式下输入...有没有`M-x ediff-merge-files`办法以文件名作为参数启动 emacs 并进入合并模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:45:13.593

您可以通过命令行将 Lisp 代码传递给 Emacs：

```
emacs --eval '(ediff-merge-files "path/to/file1" "path/to/file2")' 
```

当然，这可以包装在脚本中，以便更方便地调用。例如，在 bourne shell 中，您可以执行如下简单版本：

```
#!/bin/sh

# check correct invocation
if [ $# != 2 ]; then
   echo "USAGE: $(basename "${0}") <file1> <file2>"
   exit 1
fi

# check that file1 exists and is readable
if [ -f "${1}" ]; then
    if [ ! -r "${1}" ]; then
        echo "Cannot open '${1}', access denied."
        exit 3
    fi
else
    echo "File not found: '${1}'"
    exit 2
fi

# check that file2 exists and is readable
if [ -f "${2}" ]; then
    if [ ! -r "${2}" ]; then
        echo "Cannot open '${2}', access denied."
        exit 5
    fi
else
    echo "File not found: '${2}'"
    exit 4
fi

# invoke emacs
emacs --eval "(ediff-merge-files \"${1}\" \"${2}\")" 
```

如果你把它保存在`ediff`你的文件中`$PATH`，你可以简单地写：

```
ediff file1 file2 
```

在命令行上，Emacs 会弹出两个给定的文件`ediff-mode`。

# android - 移动网站文本在 Android 设备上混乱

> ID：13316427
> 
> 赞同：0
> 
> 时间：2012-11-09T21:41:42.150
> 
> 标签：android, mobile-website

我的移动网站上的文字向左“挤压”。网站的其余部分按预期填充页面。文本被包裹在 div 元素中，但不管我把它们放在 div 还是段落中，结果都是一样的。当我在每个元素上设置一个高度时，它会纠正问题，但我试图避免这种情况，因为有很多段落并且它们都是不同的大小，更不用说未来的可用性了。

[这是](http://m.charleskrug.com/1861.php)一个示例和屏幕截图：

![](../Images/6e6ecd978a941b09eb2c4ac7dd9c6c6d.png)

在所有文本元素上，都会发生这种情况，无论是 ul、div、p 还是标题标签……

此外，它在较旧的 Android 和 iPhone 上看起来还不错......

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T15:37:34.903

我解决了这个问题。我没有在 head 标签的 name="viewport" 标签中设置“initial-scale”。

解决问题的最后一个标签是

```
<meta name="viewport" content="width=630px; height=device-height; initial-scale=0.5;" /> 
```

感谢所有的投入！

# c# - 按下 F1 后不显示帮助

> ID：13316432
> 
> 赞同：-1
> 
> 时间：2012-11-09T21:42:17.347
> 
> 标签：c#, windows, forms

我不明白为什么按 F1 键后我没有收到帮助消息。例如，当在 Windows 窗体上时，我得到一个按钮并且它具有焦点，消息按预期显示（按 F1 后），但是当我得到一个空窗体时，这不会发生。我想默认情况下，一个空表单将设置焦点。（我读到这个事件将在按下 F1 以获得焦点的控件后引发）

这是正确的行为，还是我遗漏了空表单上的“HelpRequested”事件？这是基于焦点引发事件的正确方法，还是可以将其配置为在另一个事件（类似于 onMouseOver）上引发？我可以创建自己的活动并提出吗？（我不想只为帮助添加特殊按钮，例如按下此按钮并显示帮助，帮助应仅在按下 F1 后显示）。

这是代码：

```
 private void Form1_Load(object sender, EventArgs e)
        {
           Form1.ActiveForm.HelpRequested += new HelpEventHandler(helpReq);

           //button1.HelpRequested += new HelpEventHandler(helpReq);
        }

        private void helpReq(object sender, HelpEventArgs hlpevent)
        {
          MessageBox.Show(((Control)sender).Text);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:25:02.787

*   `Form1.ActiveForm`不推荐使用, 。将其更改为`this`
*   没有`Text`与 关联的属性`Control`。你的意思是`Tag`？
*   执行帮助事件后，您应该将 设置`HelpEventArgs.Handled`为 true
*   而不是使用事件，您可以`OnHelpRequested`在表单中覆盖。

我会做这样的事情：

```
 protected override void OnHelpRequested(object sender, HelpEventArgs e)
 {
    MessageBox.Show((Control) sender).Tag);
    e.Handled = true;

    base.OnHelpRequested(sender, e);
 } 
```

# java - Java/数据库项目自动化

> ID：13316433
> 
> 赞同：1
> 
> 时间：2012-11-09T21:42:19.730
> 
> 标签：java, jdbc, automation, scheduled-tasks, derby

我在 Netbeans 中有一个 Java/Database 项目，我想在设定的时间每天运行一次。我正在使用 Derby 作为数据库驱动程序。我正在尝试自动化一个过程。

1.  如何“安排”该程序在指定时间运行？
2.  如何自定义它以继续运行，直到满足特定条件？

假设我的标准是它必须在数据库中填充 500 行。（所以说在它运行的预定时间它只能填充 400 行，然后可能 2 小时后它再次尝试运行以填充最后 100 行）

1.  最后，自动化和计划任务的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:01:54.037

如何“安排”该程序在指定时间运行？

这可以通过以下两种方式之一完成，具体取决于您的操作系统 - 编写一个在您需要的时间间隔启动 java 程序的作业。然后，您可以连接要在启动时启动的作业。

在 Linux 中，您可以通过一个 cron 作业左右来完成此操作。在 Windows 上，您可以参考此[http://support.microsoft.com/kb/308569](http://support.microsoft.com/kb/308569)。

您还可以使用[http://quartz-scheduler.org](http://quartz-scheduler.org)或[http://www.sauronsoftware.it/projects/cron4j/](http://www.sauronsoftware.it/projects/cron4j/)将调度程序编程到您的 java 程序中。

如何自定义它以继续运行，直到满足特定条件？

这可能最好在您的程序中建立，尽管如果没有太多信息很难给您指示。

最后，自动化和计划任务的最佳实践是什么？

根据您的应用程序架构，调度和自动化可以在应用程序内处理，也可以从操作系统获得支持。标准取决于应用程序需要多少控制，哪个平台使调度变得容易等。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:04:34.380

[Quartz](http://quartz-scheduler.org/)是 Java 的调度项目。我在很多项目中都使用过它，发现它非常直观。

对于您的追求，它可能有点过头了，但无论如何都值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T23:07:32.297

您可以使用 Timer 来安排事件，并且必须使用 TimerTask 来实现事件/任务

# objective-c - 达到最大事务数时，Nuance DragonMobile 文本转语音返回的错误

> ID：13316434
> 
> 赞同：1
> 
> 时间：2012-11-09T21:42:25.743
> 
> 标签：objective-c, ios, speech

我即将在使用 Nuance Dragon Mobile SDK 的 IOS 上发布我的应用程序。我注册了“白银”计划，该计划允许我每天进行 20 次交易。

我的问题是，有谁知道 Nuance 在超出限制时返回了什么错误？我很担心，因为我正在过滤掉：

```
error.code == 5 // Because this fires whenever I interrupt running speech
error.code == 1 // Because after interrupting speech, the first time I restart, it cuts off
            // before finished, so I automatically start again, so as not to trouble the user to do so 
```

我想如果 Nuance 返回的错误与这些不同，我将允许它通过，并能够提醒用户他们已达到每日限制。

我认为以下给出了可能的错误：

```
extern NSString * const SKSpeechErrorDomain;

enum {
    SKServerConnectionError = 1,
    SKServerRetryError = 2,
    SKRecognizerError = 3,
    SKVocalizerError = 4,
SKCancelledError = 5,
}; 
```

在我看来，可能会被解雇的是 SKServerConnectionError 。在那种情况下，我需要想出一个不同的策略。如果我能弄清楚重启问题发生了什么，我就不必过滤掉那个错误。另外，当我自动重新启动这些错误启动时，我可能会增加我的事务计数，这是不幸的。

有人对 Nuance SDK for IOS 这方面有经验吗？

# bash - 从特定行开始在文件中插入行

> ID：13316437
> 
> 赞同：54
> 
> 时间：2012-11-09T21:42:58.247
> 
> 标签：bash, sed

我想从特定行开始在 bash 中的文件中插入行。

每行都是一个字符串，它是数组的一个元素

```
line[0]="foo"
line[1]="bar"
... 
```

并且具体的行是'fields'

```
file="$(cat $myfile)"
for p in $file; do
    if [ "$p" = 'fields' ]
        then insertlines()     #<- here
    fi
done 
```

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-11-09T21:51:17.767

这可以通过 sed 来完成：`sed 's/fields/fields\nNew Inserted Line/'`

```
$ cat file.txt 
line 1
line 2 
fields
line 3
another line 
fields
dkhs

$ sed 's/fields/fields\nNew Inserted Line/' file.txt 
line 1
line 2 
fields
New Inserted Line
line 3
another line 
fields
New Inserted Line
dkhs 
```

用于`-i`就地保存而不是打印到`stdout`

`sed -i 's/fields/fields\nNew Inserted Line/'`

作为 bash 脚本：

```
#!/bin/bash

match='fields'
insert='New Inserted Line'
file='file.txt'

sed -i "s/$match/$match\n$insert/" $file 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-11-18T01:38:35.040

或者另一个例子`sed`：

准备一个`test.txt`文件：

```
echo -e "line 1\nline 2\nline 3\nline 4" > /tmp/test.txt

cat /tmp/test.txt
line 1
line 2
line 3
line 4 
```

在文件中添加新行`test.txt`：

```
sed -i '2 a line 2.5' /tmp/test.txt
# sed for in-place editing (-i) of the file: 'LINE_NUMBER a-ppend TEXT_TO_ADD'

cat /tmp/test.txt
line 1
line 2
line 2.5
line 3
line 4 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-09T22:11:16.267

这绝对是您想要使用`sed`（或`awk`或`perl`）之类的东西而不是在shell循环中一次读取一行的情况。这不是 shell 做得好的或有效的事情。

您可能会发现编写可重用函数很方便。这是一个简单的，虽然它不适用于完全任意的文本（斜杠或正则表达式元字符会混淆事物）：

```
function insertAfter # file line newText
{
   local file="$1" line="$2" newText="$3"
   sed -i -e "/^$line$/a"$'\\\n'"$newText"$'\n' "$file"
} 
```

例子：

```
$ cat foo.txt
Now is the time for all good men to come to the aid of their party.
The quick brown fox jumps over a lazy dog.
$ insertAfter foo.txt \
   "Now is the time for all good men to come to the aid of their party." \
   "The previous line is missing 'bjkquvxz.'"
$ cat foo.txt
Now is the time for all good men to come to the aid of their party.
The previous line is missing 'bjkquvxz.'
The quick brown fox jumps over a lazy dog.
$ 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-09T21:51:12.757

sed 是你的朋友：

```
:~$ cat text.txt 
foo
bar
baz
~$ 

~$ sed '/^bar/\na this is the new line/' text.txt > new_text.txt
~$ cat new_text.txt 
foo
bar
this is the new line
baz
~$ 
```

# javascript - 过滤 json 数据中的多个值以在 D3 中使用

> ID：13316438
> 
> 赞同：1
> 
> 时间：2012-11-09T21:43:00.960
> 
> 标签：javascript, json, d3.js

我有一个复选框列表，我将所有选中的值保存在一个数组中-> selected_prospect_array。

我正在尝试过滤 json 对象数组以仅返回 selected_prospect_array 中的值。

我想使用过滤后的 json 生成 D3 圆圈。

这就是我最初设置循环的方式：遍历 selected_prospect_array -> d3 中的过滤器 -> 绘制气泡并再次开始该过程。

唯一的问题是它只绘制了第一个气泡；它似乎在绘制第一个气泡后停止循环。

我的代码如下所示：

```
for (i = 0; i < selected_prospect_array.length; i++) {
              var tempdata;

               var val = selected_prospect_array[i];

                tempdata = filteredjson.filter(function (d) { return d.ProspectName == val; });

              g.selectAll("circle").data(tempdata).enter().append("circle")
      .attr("cx", function (d) { return x_scale(d.PercentageComplete * 100) })
      .attr("cy", function (d) { return y_scale(d.GPoS * 100) })
      .attr("r", "30")
      .attr("stroke", "blue")
     .attr("stroke-width", 1)
      .attr("opacity", 0.6)
      .attr("fill", "red");

      } 
```

还有其他方法可以做到这一点吗？我可以直接过滤json文件吗？

# java - 包括项目中的jar。并包括 Android Library 项目

> ID：13316439
> 
> 赞同：2
> 
> 时间：2012-11-09T21:43:08.513
> 
> 标签：java, android, jar, android-library

我想在我的项目中包含一个 jar 库，但是这个库真的很大。

我没有使用该库中的所有类，所以当我编译我的项目时，所有的 jar 内容将被放入已编译的项目中还是只放入我正在使用的文件（类等）？

关于 Android 库项目的同样问题：如果我在我的项目中包含 Android 库项目并且我没有使用所有 lib 资源，编译器会将所有 Lib 项目资源放入我的项目中**还是只放入我使用过的资源**？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:53:06.320

如果我不理解这个问题，我深表歉意，但也许您正在寻找的是：

[在 JAR 中选择性地包含依赖项](https://stackoverflow.com/questions/7366974/selectively-include-dependencies-in-jar)

所以这是插件

[https://github.com/nuttycom/sbt-proguard-plugin](https://github.com/nuttycom/sbt-proguard-plugin)

sbt proguard 看起来会减少不必要的类，这样你的项目就不会“沉重”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T21:51:25.613

尽管您可能没有直接使用 JAR 中的类，但您可以间接使用它们。因此，从 jar 中删除这些类可能是不安全的——除非你 100% 确定它们没有被你*正在*使用的类间接使用。

# c# - 为什么是 在任何 .csproj 文件中都找不到？

> ID：13316440
> 
> 赞同：11
> 
> 时间：2012-11-09T21:43:34.640
> 
> 标签：c#, visual-studio, msbuild

只是好奇-每当我看到 .csproj 的 xml 时，它都会以开头，`DefaultTargets="Build"`因此我认为它`<Target Name="Build">`应该存在；但是，我从未在任何`.csproj`文件中找到此默认目标。

VS 是在编译之前注入此目标还是默认情况下 msbuild 构建它。内部会发生什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-09T21:52:34.943

在文件底部附近你会看到这个；`<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />`导入标准目标，“构建”就是其中之一。导入会根据项目文件中可用的其他数据以动态方式生成“构建”目标。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-09T21:52:25.873

csproj 通常有这个：

```
 <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" /> 
```

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms164312.aspx)，它还导入 Microsoft.Common.targets，这是定义该目标的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T21:47:01.977

项目文件中有一个或多个 <Import ...> 导入其他应该具有该目标的文件...

# c# - 如何创建自己的自定义按钮？

> ID：13316441
> 
> 赞同：0
> 
> 时间：2012-11-09T21:43:38.017
> 
> 标签：c#, xaml, gdi+, kendo-ui

我是一个相当新的程序员；半调味。但我仍然需要大量学习。所以我专注于几种语言。C# 是最重要的。

现在我知道 Visual Studio 可以让您直接从工具箱中拉出一个按钮。您现在有了控制权；操纵那个对象。

例如，我想深入研究一个按钮的编程。创建我自己的自定义按钮；我可以在其中绘制形状、大小、渐变、悬停效果、玻璃效果、下拉菜单，真正深入了解创建这些可重复使用的动态装饰控件的具体细节。

最好的起点是什么？有什么经验丰富的开发人员可以与我分享的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:52:50.110

将**xaml** `"UserControl"`添加到您的项目中，并使 WPF 内容成为您想要在`"Template"`属性中的控件上呈现的内容。然后你应该使用一些 Binding 表达式来加载内容和处理事件。这样做非常简单，并且可以在 WPF 中制作您需要的任何自定义内容。不需要像 .NET 2 那样绘制东西。

干杯

# jquery - 使用 jQuery-ui 滑块按比例缩放图像

> ID：13316468
> 
> 赞同：0
> 
> 时间：2012-11-09T21:45:51.163
> 
> 标签：jquery, jquery-ui, jquery-slider

我正在尝试使用滑块按比例缩放图像。我有眼镜图像（`in css: width: 150px height: auto`）我需要那个图像大小，ui滑动手柄在中间（范围75px - 300px）。这是我得到的：

```
<script>
                jQuery("#slider").slider({
                    step: 1,
                    max: 300,
                    slide: function(e,ui){
                        var sliderValue =  jQuery("#slider").slider("value");
                        jQuery(".over_image").width(sliderValue * 1.5);
                        jQuery(".over_image").height(sliderValue );

                    }
                })
</script>
        <div class="wraper">
            <div id="output" class="foto-frame">
      <img class="over_image" src="1.png" alt="img3" />
            </div>
            <div id="progressbox"><div id="progressbar"></div ></div>
            <div class="nav-buttons">
                <div id="slider"></div>
            </div>
        </div> 
```

我得到方形图像，任何建议如何保存纵横比？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:04:52.270

两个建议：

不要改变高度。

从75开始

```
var over_image = jQuery(".over_image");
jQuery("#slider").slider({
    step: 1,
    max: 300 - 75,
    slide: function(e, ui) {
        var sliderValue = jQuery("#slider").slider("value");
        over_image.width(sliderValue + 75);
    }
});​ 
```

# domain-driven-design - UML 组合与 SQL 外键

> ID：13316472
> 
> 赞同：1
> 
> 时间：2012-11-09T21:46:03.080
> 
> 标签：domain-driven-design, uml

下面的图像（即不可导航的组合关系）在域模型的早期 UML 类图中是否有意义？

![班级](../Images/8542d15810b61f7ff02c170a5ecf725d.png)

我想表达的是不可能这样做`Company.Accounts`，但是如果 Company 对象被销毁，所有 Accounts 也将被销毁。我的动机是避免类成为[本问题](https://stackoverflow.com/questions/2896848/how-to-avoid-having-very-large-objects-with-domain-driven-design)`Company`中讨论的某种上帝对象反模式。用数据库术语：有一个外键来自. 在实际的应用程序中，几乎所有东西都归公司所有，出于性能原因，我不想让懒惰/急切地加载公司的所有子集合。`Account --> Company`

我想最终的图表可能会有一个`IAccountRepository`（见下图），但我发现将所有内容放在那里会给类图带来负担。想象一下为每个子集合添加额外的*基础设施*类。类图将变得不可读！

![类图2](../Images/c3cf5e0cf445391d635d77bc2def8501.png)

您如何在领域模型中传达加载将是“间接”的**想法？**它甚至去那里吗？

对此有任何参考或行业标准吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T09:54:38.347

您正在将行为建模与静态模型混合。如果**从不**直接访问，您在`Company`和之间设置的关系是可以的，但是如果您在该访问中有函数，那么您的模型是错误的。`Account``Company` **`Account``Company``Account`**

 **据我所知，无法模拟一方面`Company`是由哪些帐户组成，`Accounts`但帐户实际上存储在另一个地方。您的第二个图表不正确，因为如果`Company`由 组成`Accounts`，则`IAccountRepository`应该通过`Company`而不是直接访问它们。

恕我直言，`Account`应该具有从 to 的组合，从to`IAccountRepository`的`Account`关联，并且在删除公司时的序列图中，它的所有帐户都将被删除。`Company``Account``ICompanyRepository.deleteCompany`**

# c++ - 根据鼠标位置放大窗口

> ID：13316481
> 
> 赞同：6
> 
> 时间：2012-11-09T21:46:34.540
> 
> 标签：c++, winapi

嗨，我现在正在用 C++ 编写一个 win32 应用程序，但我真的很难放大窗口的内容。这是我开始完成缩放的伪代码：

```
// point One
int XPointOne = -200;
int YPointTwo = 0;

// point Two
int XPointTwo = 200;
int YPointTwo = 0;

// Draw point function.
DrawPoint(XCoordinate * ScalingFactor, YCoordinate * ScalingFactor) {
    ....
} 
```

我的坐标系设置为使其原点位于窗口的中心。我想在使用鼠标滚轮时进行缩放。上述解决方案的问题是缩放总是从窗口的中心发生。当您的鼠标不在窗口的中心时，这有点难看。我想放大鼠标所在的区域，但我找不到合适的算法来计算 x 和 y 方向的偏移量。例如，如果鼠标具有坐标 (-200, 0)，则点 1 应具有坐标 (-200, 0)，点 2 应具有坐标 (600, 0)，且比例因子为 2。我已经尝试了很多东西，但没有让它工作，尤其是当鼠标在缩放之间移动到其他位置时，一切都搞砸了。任何人都知道如何解决这个问题？

这是我的应用程序的一些示例代码。第一个片段是我处理 WM_MOUSEWHEEL 消息的回调函数。

```
VOID OnMouseWheel(WPARAM const& WParam, LPARAM const& LParam) {
    if(GET_WHEEL_DELTA_WPARAM(WParam) > 0)
    {
        // Zoom in
        Draw.ScaleFactor += 0.1;
    }
    else
    {
         // Zoom out
    }
} 
```

Draw 只是一个包装 GDI 函数的类。它有一个比例因子成员。下面的代码片段是我的 Draw 对象的 DrawCircle 成员函数，它使用比例因子在屏幕上正确显示圆。

```
VOID DrawCircle(DOUBLE const& XCoordinate, DOUBLE const& YCoordinate, DOUBLE const& Radius, COLORREF const& Color) {
    HBRUSH Brush = CreateSolidBrush(Color);
    HBRUSH OldBrush = (HBRUSH)SelectObject(this->MemoryDC, Brush);

    Ellipse(this->MemoryDC, (INT) ((XCoordinate - Radius) * this->ScaleFactor), 
        -(INT)((YCoordinate + Radius) * this->ScaleFactor), 
         (INT)((XCoordinate + Radius) * this->ScaleFactor), 
        -(INT)((YCoordinate - Radius) * this->ScaleFactor)); 
    SelectObject(this->MemoryDC, OldBrush);
    DeleteObject(Brush);
 } 
```

如您所见，我的 DrawCircle 函数在应用当前比例因子时没有考虑鼠标位置。

**编辑**

好的，我更接近解决方案这里是我的鼠标回调函数的更新版本。

```
VOID OnMouseWheel(WPARAM const& WParam, LPARAM const& LParam) {
    // Get Mouse position in real coordinates and not window coordinates.
    INT XOffset = (Window.GetClientWidth() / -2) + XMousePos;
    INT YOffset = (Window.GetClientHeight() / 2) - YMousePos;

    if(GET_WHEEL_DELTA_WPARAM(WParam) > 0)
    {
        Draw.ScaleFactor += 0.1;
        Draw.XOffsetScale = -XOffset * (Draw.ScaleFactor - 1.0);
        Draw.YOffsetScale = YOffset * (Draw.ScaleFactor - 1.0);
    }
    else
    {
        // ...
    }
} 
```

这是绘制圆圈的函数。

```
VOID DrawCircle(DOUBLE const& XCoordinate, DOUBLE const& YCoordinate, DOUBLE const& Radius, COLORREF const& Color) {
        HBRUSH Brush = CreateSolidBrush(Color);
        HBRUSH OldBrush = (HBRUSH)SelectObject(this->MemoryDC, Brush);

        Ellipse(this->MemoryDC, (INT) ((XCoordinate - Radius) * this->ScaleFactor + XOffsetScale) , 
            -(INT)((YCoordinate + Radius) * this->ScaleFactor - YOffsetScale), 
            (INT)((XCoordinate + Radius) * this->ScaleFactor + XOffsetScale), 
            -(INT)((YCoordinate - Radius) * this->ScaleFactor - YOffsetScale)); 
        SelectObject(this->MemoryDC, OldBrush);
        DeleteObject(Brush);
 } 
```

只要我将鼠标保持在同一位置，这确实有效，但是当我移动到另一个位置时，它不会按预期缩放一次，然后它会再次正确缩放。也许这有点帮助。

提前致谢！

**解决了**

好的，我现在解决了我的问题。我只是根据鼠标位置乘以缩放因子移动了坐标系的原点。感谢您的回答。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-09T23:15:28.010

最“通用”的解决方案使用矩阵变换，但这里有一个简化的解释。以下伪代码可能会对您有所帮助：

```
/*
    VARIABLES (all in space coordinates, not pixel coordinates):

      input:
        viewRect = rectangle of the viewed area
        zoomFactor = factor of zoom relative to viewRect, ex 1.1
        mousePos = position of the mouse

      output:
        zoomedRect = viexRect after zoom
*/

/*
    A little schema:

      viewRect
    *-----------------------------------------------------------------------*
    |                       ^                                               |
    |                       | d_up                                          |
    |        zoomedRect     v                                               |
    |      *-----------------------------------------*                      |
    |d_left|                                         |       d_right        |
    |<---->|                mousePos                 |<-------------------->|
    |      |                    +                    |                      |
    |      |                                         |                      |
    |      |                                         |                      |
    |      *-----------------------------------------*                      |
    |                       ^                                               |
    |                       |                                               |
    |                       |                                               |
    |                       | d_down                                        |
    |                       |                                               |
    |                       v                                               |
    *-----------------------------------------------------------------------*

    dX = d_left + d_right
    dY = d_up + d_down
    The origin of rects is the upper left corner.
*/

/*
    First, find differences of size between zoomed rect and original rect
    Here, 1 / zoomFactor is used, because computations are made relative to the
    original view area, not the final rect):
*/
dX = viewRect.width * (1 - 1 / zoomFactor)
dY = viewRect.height * (1 - 1 / zoomFactor)

/*
    Second, find d_* using the position of the mouse.
    pX = position of the mouse along X axis, relative to viewRect (percentage)
    pY = position of the mouse along Y axis, relative to viewRect (percentage)
    The value of d_right and d_down is not computed because is not directly needed
    in the final result.
*/
pX = (mousePos.X - viewRect.X) / viewRect.width
pY = (mousePos.Y - viewRect.Y) / viewRect.height

d_left = pX * dX
d_up = pY * dY

/*
    Third and last, compute the output rect
*/
zoomedRect = viewRect
zoomedRect.X += d_left
zoomedRect.Y += d_up
zoomedRect.width -= dX
zoomedRect.height -= dY

// That's it! 
```

对于您的问题，您需要将视图（您的窗口）与场景（绘制的对象）分开。您应该有一个绘制部分（或全部）场景的函数：

```
void drawScene(Rect viewArea); 
```

和一个缩放区域的函数（使用前面介绍的算法）：

```
Rect zoomArea(Rect rectToZoom, Point zoomCenter, double factor); 
```

现在，您的回调要简单得多：

```
VOID OnMouseWheel(WPARAM const& WParam, LPARAM const& LParam)
{
    // Get the position of the mouse relative to the window (in percent)
    double XMouseRel = XMousePos / double(Window.GetClientWidth());
    double YMouseRel = YMousePos / double(Window.GetClientHeight());

    // Get Mouse position in scene coordinates and not window coordinates.
    // viewArea is in scene coordinates
    // window = your window or your draw information on the scene
    // The following assumes that you're using a scene with X left-to-right and
    // Y top-to-bottom.
    double XMouse = window.viewArea.width * XMouseRel + window.viewArea.upperleft.X;
    double YMouse = window.viewArea.height * YMouseRel + window.viewArea.upperleft.Y;

    // Zoom parameters
    double zFactor = 0.1 * GET_WHEEL_DELTA_WPARAM(WParam);
    Rect viewArea = getViewArea(); // or something like this
    Point zCenter(XMouse,YMouse);

    // Zoom
    Rect zoomedRect = zoomArea(viewArea,zCenter,zFactor);
    drawScene(zoomedRect);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-10T00:57:26.480

您正在尝试在平面中实现仿射变换的子集。在您的情况下，您只需要结合绘图平面的平移和缩放（缩放）。平面中仿射变换的全部可能性涉及使用 3 维矩阵，但现在我只给出您的问题所需的最小值。随意在网上查找完整的主题，这方面的文献很多。

首先，我们将声明一个 2D 向量和一些运算符：

```
 class vector2D {
  protected:
      /* here your class implementation details */
  public:
      vector2D(const vector2D &v);
      vector2D(float x, float y) { /* ... */ }
      vector2D operator +(const vector2D &v) const { /* ... */ }
      vector2D operator -(const vector2D &v) const { /* ... */ }
      vector2D operator *(float v) const { /* ... */ }
      bool operator ==(const vector2D &v) const { /* ... */ }
      const vector2D &operator = (const vector2D &v) { /* ... */ }
  }; 
```

我会让你填空，或者如果你有自己的班级的话。请注意，此接口可能不是最佳的，但我想专注于算法，而不是性能。

现在，让我们介绍一下显示转换：

我们将`zf`缩放因子、`trans`转换的平移部分和`origin`原点称为窗口中的视图。您提到您的坐标系统位于窗口的中心，因此原点将是窗口屏幕的中心。从视图系统到窗口坐标的转换可以分解为两个独立的阶段：一个是显示对象的缩放和平移，我们称之为*modelview*，一个是从视图坐标到窗口坐标，我们称之为*投影*。如果您熟悉 3D 渲染，则可以将其视为类似于 OpenGL 中使用的机制。

*投影*可以描述为从窗口左上角到`origin`视图左上角的简单转换。

```
 vector2D project(const vector2D &v){
      return v + origin;
  } 
```

*模型视图*结合了平移和缩放（此时，UI 代码将只处理任意点的缩放）。

```
 vector2D modelview(const vector2D &v){
      return trans + (v * zf);
  } 
```

我会让你以最方便的方式组织这些函数和相关数据（ `zf`, `centre`, ）。`trans`

接下来，让我们看看 UI 应该如何修改不同的数据。

基本上，您需要将点坐标从放置在视图中心的坐标系更改为以缩放点为中心的系统，然后缩放它们的新坐标，然后返回视图中心。您要绘制的每个对象都必须经历这种转换。

那么公式是：

*v' = (v + zp) * s - zp*

其中*zp*是缩放点，*s*是缩放因子，*v*是系统中要转换的点的坐标，因此*v'*是生成的缩放点。

如果要在不同的地方进行链式缩放，则需要考虑到前面的缩放因子和中心：

如果*c*是新的缩放中心，*t*是当前的平移，*z*是当前的缩放因子，*z2*是新的缩放因子，那么我们可以计算新的全局变换：

*t' = t + c * (1 - z2)* *z' = z * z2*

这些是通过将坐标系移动到缩放中心、对变换应用缩放并返回原点而得出的。

关于缩放中心，您必须注意鼠标输入将在窗口坐标系中，因此必须转换回您的视图系统（以 为中心`origin`）。以下`unproject`函数正是这样做的：

```
 vector2D unproject(const vector2D &v){
     return v - origin;
 } 
```

最后，让我们有一个根据新输入转换模型视图转换的函数的简单实现：

```
 void onMouseWheel(float mouseX, float mouseY, bool zoom_in){
     float z2 = zoom_in? 1.1 : 1/1.1;
     vector2D m(mouseX,mouseY);
     if (! (m == origin)) { // this is very likely
         trans = trans + unproject(m) * (1.0 - z2);
     }
     zf *= z2;
     // here perhaps have a redraw event fired
 } 
```

如您所见，我提供了或多或少的通用代码，您必须适应 Win32 API 的特殊性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T23:22:53.887

您要做的是平移坐标，使鼠标点位于 (0,0)，缩放坐标，然后将 (0,0) 偏移回鼠标坐标。

```
Ellipse(this->MemoryDC, (INT) (((XCoordinate - XMouse) - Radius) * this->ScaleFactor) + XMouse, 
    -(INT)(((YCoordinate - YMouse) + Radius) * this->ScaleFactor) + YMouse, 
     (INT)(((XCoordinate - XMouse) + Radius) * this->ScaleFactor) + XMouse, 
    -(INT)(((YCoordinate - YMouse) - Radius) * this->ScaleFactor) + YMouse); 
```

# mysql - 如果条件大于返回值，则选择上一条记录

> ID：13316484
> 
> 赞同：1
> 
> 时间：2012-11-09T21:46:39.157
> 
> 标签：mysql, select

我正在尝试进行时间点查询以返回该时间点最后记录的数量。

基本上我有一个这样格式化的表格

```
id | other_id | quantity | created
 1     1           5       20
 2     1           2       22
 3     1           1       25
 4     1           8       90 
```

如果创建的查询是 60，我想返回 25 或更高的创建数量，或者从查询创建以来最近已知的数量。

```
SELECT * FROM table
WHERE created >= 60
AND other_id = 1
ORDER BY ID ASC 
```

返回 ID:4 但我希望在 60 创建 ID:3 但如果查询的创建是 25 我想返回 25 或更大

脑筋急转弯，想不出正确的解决办法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:49:58.957

此查询选择您想要的值之前的值：

```
SELECT MAX(created)
FROM yourtable
WHERE other_id = 1
AND created <= 60 
```

然后，您可以将其用作主查询中的子查询：

```
SELECT *
FROM yourtable
WHERE created >=
(
    SELECT IFNULL(MAX(created), -1)
    FROM yourtable
    WHERE other_id = 1
    AND created <= 60
)
AND other_id = 1
ORDER BY ID ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T21:51:43.513

```
SELECT * FROM table
WHERE id >= (
  SELECT id FROM table WHERE created <= 60
  AND other_id = 1
  ORDER BY id DESC LIMIT 1
)
AND other_id = 1
ORDER BY id ASC 
```

# php - 错误：尝试追加到数组时，字符串不支持 [] 运算符

> ID：13316485
> 
> 赞同：1
> 
> 时间：2012-11-09T21:46:41.287
> 
> 标签：php, arrays

所以我有一个脚本，那是一些`if-else`陈述。如果某处出现错误，它将向数组附加一条消息。因为无论哪种情况都可能存在大量错误。我将它们转储到这个数组中，以便稍后将它们列出给用户。

```
$outputMsg = array();

$outputMsg[] = "State not selected"; 
```

直到今天，这一切都很好，我随机开始收到此错误。

```
[] operator not supported for strings 
```

我想不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T21:52:41.137

正如评论中所指出的..在对我的代码进行更深入的检查后，事实证明我的数组正在被转换为字符串，尽管这个概念仍在继续，一旦遇到另一个错误以附加到数组中，那个错误发生。

我很感激帮助。但现在它已经解决了，我相信，如果没有，我知道我现在在寻找什么。问题是从状态错误所在的位置开始大约 100 行，有人为一个新字段添加了一个新错误，并且没有以类似的方式将其附加到数组中，他们只是将其设为一个字符串。

# python - PYTHON在每组中选择最低分

> ID：13316487
> 
> 赞同：0
> 
> 时间：2012-11-09T21:46:57.503
> 
> 标签：python

我的数据库中有一个名为“item”的对象，我想写一些python，它会从每组student_id中选择最低分……我是一个python菜鸟……我该怎么做?

```
{u'student_id': 197, u'_id': ObjectId('50906d7fa3c412bb040eb88d'), u'type': u'homework', u'score': 10.90872422518918}
{u'student_id': 197, u'_id': ObjectId('50906d7fa3c412bb040eb88e'), u'type': u'homework', u'score': 88.3871242475841}
{u'student_id': 198, u'_id': ObjectId('50906d7fa3c412bb040eb892'), u'type': u'homework', u'score': 17.46279901047208}
{u'student_id': 198, u'_id': ObjectId('50906d7fa3c412bb040eb891'), u'type': u'homework', u'score': 76.18366499496366}
{u'student_id': 199, u'_id': ObjectId('50906d7fa3c412bb040eb895'), u'type': u'homework', u'score': 49.34223066136407}
{u'student_id': 199, u'_id': ObjectId('50906d7fa3c412bb040eb896'), u'type': u'homework', u'score': 58.09608083191365} 
```

更新：

运行我的代码时遇到问题...我可以完成一些健全性检查吗？我收到这个错误...

```
NameError: name 'getResultFromDatabase' is not defined 
```

谢谢你的麻烦......这是我的代码......

```
import pymongo

from itertools import groupby
from pymongo import Connection

data = getResultFromDatabase()
connection = Connection('localhost', 27017)

db = connection.students

item = db.grades.find({'type' : 'homework'}).sort([('student_id',pymongo.ASCENDING),('score',pymongo.ASCENDING)])

for id, items in groupby(data, lambda s: s['student_id']):
    lowest_score = min(i['score'] for i in items)

    print lowest_score 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:49:43.823

[`groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)做你想做的事：

```
from itertools import groupby

data = getResultFromDatabase()

for id, items in groupby(data, lambda s: s['student_id']):
    lowest_score_entry = min(items, key=lambda i: i['score'])
    print lowest_score_entry['score'], lowest_score_entry['_id'] 
```

# c++ - 遇到 C++ 整数和数学问题

> ID：13316490
> 
> 赞同：1
> 
> 时间：2012-11-09T21:47:01.783
> 
> 标签：c++, console-application

所以它是一个星期五，我一直在使用这个应用程序，我的头快要爆炸了。我在任何地方都找不到问题！！！我是初学者，所以我希望 stackoverflow 的大神可以指导我正确的方向或提供一些反馈！:]

这个控制台应用程序只是一张简单的停车时间票。代码符合正常，没有错误。但是我的数学一团糟！

这是一个示例结果：时间输入为 3:50，出口为 5:29，车辆为 T。

```
 TIME-IN          -858993460:858993460
 TIME-OUT                -858933460:-858993460

 PARKING TIME             0:-858993460

 TOTAL CHARGE             -214748352.00 
```

这是我的代码

```
 #include <iostream>   //used for cout/cin
 #include <iomanip>   //used to manipulate data 

 void getData(int* ehour, int* emin, int* exhour, int* exmin);
 void rate(int exhour, int exmin, int ehour, int emin, int* thour, int* tmin, int* round);
 void charge(char* vehic, float* rate1, float* rate2, int ehour);
 void result(int exhour, int exmin, int ehour, int emin, int thour, float rate1, float rate2, int round, float total);

 int main(void)
 {
   char vehic;
   int ehour;
   int emin;
   int exhour;
   int exmin;
   int thour;
   int tmin;
   int round;

   float rate1;
   float rate2;
   float total;

   getData(&ehour, &emin, &exhour, &exmin);
   rate(exhour, exmin, ehour, emin, &thour, &tmin, &round);
   charge(&vehic, &rate1, &rate2, ehour);
   total= rate1 + rate2;
   result( exhour, exmin, ehour, emin, thour, rate1, rate2, round, total);
   return 0;
 }

  void getData(int* ehour, int* emin, int* exhour, int* exmin)
 {
   char v;
   printf("Enter C for car, B for bus, T for truck: ");
   scanf("%c", &v);
   printf("\nHour vehicle entered 0-24: ");
   scanf("%d", &ehour);
   printf("\nMinute vehicle entered 0-60: ");
   scanf("%d", &emin);
   printf("\nHour vehicle exited 0-24: ");
   scanf("%d", &exhour);
   printf("\nMinute vehicle exited 0-60: ");
   scanf("%d", &exmin);
   return;
 }
 void rate(int exhour, int exmin, int ehour, int emin, int* thour, int* tmin, int* round)
 {
   if(emin < exmin)
   {
          emin= emin + 60;
          exhour= exhour - 1;
   }
   *thour = ehour - exhour;
   *tmin = emin - exmin;
   if ((*tmin > 0 && *tmin <= 60))
   {
          *thour = *thour + 1;
          *round = *tmin * 0;
   }
   return;
 }
 void charge(char* vehic, float* rate1, float* rate2, int ehour)
 {
   switch (*vehic)
   {
   case 'c': if (ehour <= 3)
                   {
                         *rate1 = 0.00;
                         if (ehour > 3)
                              *rate2 = 1.25 * (ehour - 3);
                   }
                   break;

   case 'b': if (ehour <= 2)
                   {
                         *rate1 = 2.00 * ehour;
                         if (ehour > 2)
                                *rate2 = 2.50 * (ehour - 2);
                   }
                   break;
   case 't': if (ehour <= 1)
                   {
                         *rate1 = 3.75 * ehour;
                         if (ehour > 1)
                         *rate2 = 4.50 * (ehour - 1);
                   }
                   break;
   }
   return;
 }
 void result(int exhour, int exmin, int ehour, int emin, int thour, float rate1, float rate2, int round, float total)
 {
   printf("\n\t\t PARKING LOT CHARGE \t\t\n");
   printf("\nType of vehicle: Car or Bus or Truck");
   printf("\nTIME-IN\t\t %d:%d", ehour, emin);
   printf("\nTIME-OUT\t\t %d:%d", exhour, exmin);
   printf("\n\t\t\t --------");
   printf("\nPARKING TIME\t\t %d:%d", thour, round);
   printf("\n\t\t\t --------");
   total= rate1 + rate2;
   printf("\nTOTAL CHARGE\t\t %4.2f\n\n", total);

   return;
   } 
```

对不起，这是很多代码！我简直太疑惑了！！！我的整数格式不正确吗？数学错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T21:51:46.020

```
char v;
printf("Enter C for car, B for bus, T for truck: ");
scanf("%c", &v);
printf("\nHour vehicle entered 0-24: ");
scanf("%d", ehour);
printf("\nMinute vehicle entered 0-60: ");
scanf("%d", emin);
printf("\nHour vehicle exited 0-24: ");
scanf("%d", exhour);
printf("\nMinute vehicle exited 0-60: ");
scanf("%d", exmin); 
```

您获取了参数的地址，这些地址*已经是指针*。

* * *

作为一般的手指练习，您可以使用更典型的 C++ 风格进行以下操作：

```
/////////////////////////////////////
// timepoint classes (booking.hpp)

struct timepoint
{
    int hour, minute;

    timepoint normalized()                     const; 
    int totalMinutes    ()                     const; 
    int roundedHours    ()                     const; 
    timepoint operator- (timepoint const& rhs) const; 
};

struct booking_t
{
    char vehicle;
    timepoint enter, exit;

    timepoint parked() const { return exit - enter; }
};

/////////////////////////////////////
// main program (main.cpp)
booking_t inputData();
void displayBill(booking_t const& booking);

int main(void)
{
    auto booking = inputData();
    displayBill(booking);
}

/////////////////////////////////////
// timepoint methods (booking.cpp)

timepoint timepoint::normalized() const
{
    timepoint tmp { (hour + minute/60) % 24, minute % 60 };
    while (tmp.minute < 0) tmp.hour--, tmp.minute+=60;
    while (tmp.hour   < 0) tmp.hour+=24;
    return tmp;
}

int timepoint::roundedHours() const
{
    return (totalMinutes()-1) / 60 + 1; // TODO check rounding logic
}

int timepoint::totalMinutes() const
{
    return hour*60 + minute;
}

timepoint timepoint::operator-(timepoint const& rhs) const
{
    return timepoint { 0, totalMinutes() - rhs.totalMinutes() } .normalized();
}

#include <iostream>   //used for cout/cin

timepoint getTime(std::string label)
{
    int hour, minute;
    std::cout  << "\nHour "   << label << " 0-24: ";
    std::cin >> hour;
    std::cout  << "\nMinute " << label << " 0-60: ";
    std::cin >> minute;
    return { hour, minute };
}

/////////////////////////////////////
// global functions - input
booking_t inputData()
{
    std::cout << "Enter C for car, B for bus, T for truck: ";
    char v;
    std::cin >> v;
    auto entered = getTime("vehicle entered");
    auto exited  = getTime("vehicle exited");
    return { v, entered.normalized(), exited.normalized() };
}

/////////////////////////////////////
// calculation + billing
#include <sstream>
#include <iomanip>   //used to manipulate data 
#include <map>

static std::ostream& operator <<(std::ostream& os, timepoint const& tp)
{
    std::ostringstream oss;
    oss << std::setw(2) << std::setfill('0') << tp.hour << ':' 
        << std::setw(2) << std::setfill('0') << tp.minute;
    return os << oss.str();
}

std::pair<float,float> charge(booking_t const& booking)
{
    struct tariff_t { int threshold; float rate1, rate2; };
    const static auto tariffs = std::map<char, tariff_t> {
        { 'c', { 3, 0   , 1.25 } },
        { 'b', { 2, 2\.  , 2.5  } },
        { 't', { 1, 3.75, 4.5 } } ,
    };

    auto& tariff = tariffs.at(std::tolower(booking.vehicle));
    auto  parked = booking.parked().roundedHours();

    return std::make_pair(
            tariff.rate1 * std::min(tariff.threshold, parked)    ,
            tariff.rate2 * std::max(0, parked - tariff.threshold));
}

void displayBill(booking_t const& booking)
{
    std::cout << "\n\n    PARKING LOT CHARGE\n";
    std::cout << "Type of vehicle: Car or Bus or Truck\n";
    std::cout << "TIME-IN         " << booking.enter << "\n";
    std::cout << "TIME-OUT        " << booking.exit  << "\n";
    std::cout << "                " << "--------\n";
    std::cout << "PARKING TIME    " << booking.parked() << "\n";
    std::cout << "        ROUNDED " << booking.parked().roundedHours() << "\n";
    std::cout << "                " << "--------\n";

    auto  rates = charge(booking);
    float total = rates.first + rates.second;
    std::cout << "TOTAL CHARGE    " << std::fixed << std::setw(7) << std::setprecision(2) << total << "\n\n";
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T22:00:22.387

对于您的原始代码，我找不到太多可取之处，因此这本身并不是一个答案，但也许您会发现我如何用“纯 C++”为您的问题编写代码很有趣：

```
#include <string>
#include <iostream>
#include <sstream>

bool parse_time(std::string const & s, int & t)
{
    int h, m;
    char c;

    std::istringstream iss(s);

    if (iss >> h >> c >> m >> std::ws && c == ':' && iss.get() == EOF)
    {
        t = 60 * h + m;
        return true;
    }

    return false;
}

int main()
{
    int t_in, t_out;
    std::string line;

    if (!(std::cout << "Enter arrival time: "   &&
          std::getline(std::cin, line)          &&
          parse_time(line, t_in)                &&
          std::cout << "Enter departure time: " &&
          std::getline(std::cin, line)          &&
          parse_time(line, t_out)))
    {
        std::cerr << "Input error! Aborting.\n";
        return 0;
    }

    std::cout << "You spent " << t_out - t_in << " minutes.\n";
} 
```

这是一个典型的会话：

```
Enter arrival time: 5:14
Enter departure time: 8:41
You spent 207 minutes. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T22:32:09.007

规则 1：在您首次使用它们的位置附近声明变量。并在创建它们时初始化所有变量：

```
int main(void)
{
  int ehour = 0;
  int emin = 0;
  int exhour = 0;
  int exmin = 0;
  getData(&ehour, &emin, &exhour, &exmin);

  int thour = 0;
  int tmin = 0;
  int round = 0;
  rate(exhour, exmin, ehour, emin, &thour, &tmin, &round);

  char vehic = 0;
  float rate1 = 0;
  float rate2 = 0;
  charge(&vehic, &rate1, &rate2, ehour);

  float total = 0;
  total= rate1 + rate2;
  result( exhour, exmin, ehour, emin, thour, rate1, rate2, round, total);
  return 0;
} 
```

现在看到了`float total`吗？将变量的声明和初始化移到同一行：

```
 float total = rate1 + rate2; 
```

规则 2：如果不需要，不要使用指针。如果您有一个整数要传入和传出函数，请将参数设置为引用参数，如下所示：

```
 void getData(int& ehour, int& emin, int& exhour, int& exmin) 
```

主要：

```
 getData(ehour, emin, exhour, exmin); 
```

在获取数据中：

```
void getData(int& ehour, int& emin, int& exhour, int& exmin)
{
  char v;
  printf("Enter C for car, B for bus, T for truck: ");
  scanf("%c", &v);
  printf("\nHour vehicle entered 0-24: ");
  scanf("%d", &ehour);
  printf("\nMinute vehicle entered 0-60: ");
  scanf("%d", &emin);
  printf("\nHour vehicle exited 0-24: ");
  scanf("%d", &exhour);
  printf("\nMinute vehicle exited 0-60: ");
  scanf("%d", &exmin);
  return;
} 
```

现在，我发现了你的第一个错误。您不是在阅读整数，而是阅读指向整数的指针。现在我已经对它们进行了引用（想想“别名”或传入的变量），`&`操作符得到一个指向整数的指针，而不是指向整数指针的指针！

接下来要做的就是不要使用 scanf。Scanf 很难使用。为什么要用难用的东西？

第 3 步：您的程序应该帮助您调试它。

当您从输入中读取某些内容时，请重复一遍以确保您正确阅读。即，在您调用 getData 之后，您应该做的下一件事就是重复您阅读的内容。最终，当您的代码可靠时，您可以删除“重复它”，但是在开发程序时，这种反馈是必不可少的。

请参阅 Kerrek SB 以获得更好的阅读方式，而不是使用`scanf`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-09T21:49:43.777

我注意到一件事——你传递`&ehour`和朋友，它是一个指向你的`scanf`调用的指针（你可以`&`从`scanf`调用 when `ehour`is 中删除`int*`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-09T21:52:04.420

取出scanf中的&！他们已经是指针！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-09T21:59:22.843

代码中的另一个错误是变量`vehic`永远不会得到值。看起来你打算给它一个价值，`getData`但不知何故搞砸了。

# scala - Scala主要演员与反应块中的案例不匹配

> ID：13316492
> 
> 赞同：2
> 
> 时间：2012-11-09T21:47:14.210
> 
> 标签：scala, actor

在这段代码中，主角的 act 方法中的 case 永远不会匹配，所以我的 wrapUp 方法永远不会被调用。

```
import java.net.Socket
import scala.actors._
import Actor._
import scala.collection.mutable.ArrayBuffer

object LowPortScanner {

  var lastPort = 0
  var openPorts = ArrayBuffer[Int]()
  var longestRunTime = 00.00
  var results = List[Tuple3[Int, Range, Long]]()

  val host = "localhost"
  val numProcs = 1 to Runtime.getRuntime().availableProcessors()
  val portsPerProc = 1024 / numProcs.size
  val caller = self
  val procPortRanges = numProcs.foldLeft(List[Tuple2[Int, Range]]()) { (portRanges, proc) =>
    val tuple2 = (proc.toInt, (lastPort + 1) to (lastPort + portsPerProc))
    lastPort += portsPerProc
    tuple2 :: portRanges
  }

  def main(args: Array[String]): Unit = {

    //spawn an actor for each processor that scans a given port range
    procPortRanges.foreach { proc =>
      actor {
        caller ! scan(proc._1, proc._2)
      } //end inner actors
    } //end numProcs.foreach  

    //catch results from the processor actors above
    def act {
      loop {
        reactWithin(100) {
          //update the list of results returned from scan
          case scanResult: Tuple3[Int, Range, Long] =>
            println("Processor " + scanResult._1 + " completed scan of ports " + scanResult._2.first + " through " + scanResult._2.last)
            results = results ::: List(scanResult)

          //check if results have been returned for each actor
          case TIMEOUT =>
            println("Main actor timed out")
            if (results.size == numProcs.size) wrapUp

          case _ =>
            println("got back something weird from one of the port scan actors!")
            wrapUp
        }
      }
    }    

    //Attempt to open a socket on each port in the given range
    //returns a Tuple3[procID: Int, ports: Range, time: Long
    def scan(proc: Int, ports: Range) = {
      val startTime = System.nanoTime()
      ports.foreach { n =>
        try {
          //println("Processor " + proc + " is checking port " + n)
          print(".")

          val socket = new Socket(host, n)

          //println("Found open port: " + n)
          openPorts += n

          socket.close
        } catch {
          case e: Exception =>
          //println("While scanning port " + n + " caught Exception: " + e)
        }
      }
      (proc, ports, startTime - System.nanoTime())
    }

    //output results and kill the main actor
    def wrapUp {
      println("These are the open ports in the range 1-1024:")
      openPorts.foreach { port => println(port) }
      results.foreach { result => if (result._3 > longestRunTime) { longestRunTime = result._3 } }
      println("Time to scan ports 1 through 1024 is: %3.3f".format(longestRunTime / 1000))
      caller ! exit
    }
  }
} 
```

为每个处理器生成参与者的代码工作正常，扫描方法为每个端口范围正确调用，我已经确认扫描了 1024 个端口。
我的期望是这条线：

```
caller ! scan(proc._1, proc._2) 
```

应该将包含 (Int, Range, Long) 的消息发送回主要参与者。然后主要参与者的 act 方法应该捕获该消息并执行：

```
 case scanResult: Tuple3[Int, Range, Long] =>
            println("Processor " + scanResult._1 + " completed scan of ports " + scanResult._2.first + " through " + scanResult._2.last)
            results = results ::: List(scanResult) 
```

然而，这并没有发生。事实上，据我所知，我的任何信息都没有返回给主角。我不清楚我错过了什么或做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T23:06:40.333

您注意到的问题是没有收到正在发送的消息。这是因为创建的`actor {caller ! scan(proc._1, proc._2)}`参与者没有`act`与之关联的定义。该`def act{...}`方法与创建的actor无关，因为它是一个方法`LowPortScanner`而不是actor。

保持代码的精神，您可以定义要由参与者执行的主体， `actor{...}`并将其分配给一个值并向其发送消息。

```
 //spawn an actor for each processor that scans a given port range
 procPortRanges.foreach { proc =>
   val myactor = actor {
     //catch results from the processor actors above
       loop {
         reactWithin(100) {
         //update the list of results returned from scan
         case scanResult: Tuple3[Int, Range, Long] =>
           println("Processor " + scanResult._1 + " completed scan of ports " + scanResult._2.first + " through " + scanResult._2.last)
           results = results ::: List(scanResult)

         //check if results have been returned for each actor
         case TIMEOUT =>
           println("Main actor timed out")
           if (results.size == numProcs.size) wrapUp

         case _ =>
           println("got back something weird from one of the port scan actors!")
           wrapUp
        }
      }
     //catch results from the processor actors above
   } //end inner actors
     myactor ! scan(proc._1, proc._2)
 } //end numProcs.foreach 
```

另一种方法是扩展 Actor 特征。这样，`def act{...}`将处理参与者收到的消息`LowPortScanner`。我还做了一些小的重构，包括使用`this`而不是`self`. Actor 也必须以`this.start()`.

```
import java.net.Socket
import scala.actors._
import Actor._
import scala.collection.mutable.ArrayBuffer

object LowPortScanner extends Actor {

  var lastPort = 0
  var openPorts = ArrayBuffer[Int]()
  var longestRunTime = 00.00
  var results = List[Tuple3[Int, Range, Long]]()

  val host = "localhost"
  val numProcs = 1 to Runtime.getRuntime().availableProcessors()
  val portsPerProc = 1024 / numProcs.size

  val procPortRanges = numProcs.foldLeft(List[Tuple2[Int, Range]]()) { (portRanges, proc) =>
    val tuple2 = (proc.toInt, (lastPort + 1) to (lastPort + portsPerProc))
    lastPort += portsPerProc
    tuple2 :: portRanges
  }
    //catch results from the processor actors above
    def act {
      loop {
        reactWithin(100) {
          //update the list of results returned from scan
          case scanResult: Tuple3[Int, Range, Long] =>
            println("Processor " + scanResult._1 + " completed scan of ports " + scanResult._2.first + " through " + scanResult._2.last)
            results = results ::: List(scanResult)

          //check if results have been returned for each actor
          case TIMEOUT =>
            println("Main actor timed out")
            if (results.size == numProcs.size) wrapUp

          case _ =>
            println("got back something weird from one of the port scan actors!")
            wrapUp
        }
      }
    }

    //Attempt to open a socket on each port in the given range
    //returns a Tuple3[procID: Int, ports: Range, time: Long
    def scan(proc: Int, ports: Range) = {
      val startTime = System.nanoTime()
      ports.foreach { n =>
        try {
          //println("Processor " + proc + " is checking port " + n)
          print(".")

          val socket = new Socket(host, n)

          //println("Found open port: " + n)
          openPorts += n

          socket.close
        } catch {
          case e: Exception =>
          //println("While scanning port " + n + " caught Exception: " + e)
        }
      }
      (proc, ports, startTime - System.nanoTime())
    }

    //output results and kill the main actor
    def wrapUp {
      println("These are the open ports in the range 1-1024:")
      openPorts.foreach { port => println(port) }
      results.foreach { result => if (result._3 > longestRunTime) { longestRunTime = result._3 } }
      println("Time to scan ports 1 through 1024 is: %3.3f".format(longestRunTime / 1000))
      this ! exit
    }

  def main(args: Array[String]): Unit = {

    //spawn an actor for each processor that scans a given port range
    this.start()
    procPortRanges.foreach { proc =>
      actor {
        this ! scan(proc._1, proc._2)
      } //end inner actors
    } //end numProcs.foreach  
  }

} 
```

以下是运行的结果：

```
scala> LowPortScanner.main(Array[String]())

scala> ...Processor 6 completed scan of ports 641 through 768
...Processor 5 completed scan of ports 513 through 640
...Processor 4 completed scan of ports 385 through 512
...Processor 3 completed scan of ports 257 through 384
...Processor 1 completed scan of ports 1 through 128
...Processor 7 completed scan of ports 769 through 896
...Processor 2 completed scan of ports 129 through 256
...Processor 8 completed scan of ports 897 through 1024
Main actor timed out
These are the open ports in the range 1-1024:
139
22
445
591
631
111
Time to scan ports 1 through 1024 is: 0.000

scala> LowPortScanner.results
res2: List[(Int, Range, Long)] = List((6,Range(641, 642, 643,... 
```

# sql-server - 对只选择 newid() 的视图使用锁定提示或顶部子句？

> ID：13316493
> 
> 赞同：1
> 
> 时间：2012-11-09T21:47:15.183
> 
> 标签：sql-server, view, locking, guid, user-defined-functions

为了`newid()`在 UDF 中使用，我创建了一个可以帮助我的视图：

```
create view RandomUUID as select newid() as UUID 
```

通过这种方式，UDF 现在可以访问 newid()。[酷](https://stackoverflow.com/questions/2186692/creating-function-using-newid)。

但是，我的问题是选择它的最佳方法是什么？在我的 UDF 中的查询中添加`TOP 1`or是否有意义？`(nolock)`如：

```
select UUID from RandomUUID 
```

对比

```
select top 1 UUID from RandomUUID (nolock) -- Or any other combo of query modifiers 
```

更新：

这个[SqlFiddle](http://www.sqlfiddle.com/#!3/b0452/1)演示了它是如何被使用的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:50:00.440

没有理由添加（nolock），因为没有涉及锁定的记录！作为记录，`(NOLOCK)`应该`WITH (nolock)`从 SQL Server 2008 开始编写（或者是 2005 年）。

`TOP (1)`将在此处添加一个无关紧要的 SORT 运算符，因为只创建了一行。

* * *

您可以像这样创建它：

```
create view RandomUUID as select newid() as UUID;
GO

create function give_me_a_new_id ()
returns uniqueidentifier as
begin
return (select UUID from RandomUUID);
end;
GO 
```

注意：`(nolock)`将被优化掉，但`TOP(1)`会添加一个 SORT 操作，如此处所示[（](http://sqlfiddle.com/#!3/c4a39/3/1)展开执行计划）。

# emacs - 如何在 Emacs 中跟踪 *Messages* 缓冲区的结尾？

> ID：13316494
> 
> 赞同：0
> 
> 时间：2012-11-09T21:47:23.757
> 
> 标签：emacs, elisp

> **可能重复：**
> [在 emacs 中，我可以设置 *Messages* 缓冲区以使其拖尾吗？](https://stackoverflow.com/questions/4682033/in-emacs-can-i-set-up-the-messages-buffer-so-that-it-tails)

我正在玩 Elisp，我发现让***Messages***缓冲区始终在我的框架中的窗口中打开很方便。

我最近发现有时缓冲区会在文件的最后一行之后停止。如果我想查看此缓冲区中最后附加的行，我需要进入缓冲区并手动跳转到末尾，使用`M->`. 这很烦人和破坏性。

我正在尝试在缓冲区中重现“tail -f”命令行。当然`'auto-revert-tail-mode`会抱怨***Messages***不是访问过的文件......因此，这种模式不想工作。但它让我想到了在修改缓冲区时添加一个函数挂钩。`(point-max)`每次修改该缓冲区时，该函数都会跳转到。

这是我自己的尝试，从***Messages***缓冲区调用，使用`M-:`：
`(add-hook 'after-change-functions (lambda (s e l) (goto-char (point-max)) nil) nil t)`

但它不起作用。当`(point)`我看到缓冲区正在增长时，它们仍然在同一个地方...... lambda 函数不会产生任何错误，否则它会从`'after-change-functions`钩子中删除并`C-h k` `'after-change-functions`显示它存在。

有更好的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T08:32:48.720

无论如何修改点位置`after-change-functions`是非常危险的，因为它可能会破坏对缓冲区的某些类型的编辑（例如，Emacs 压缩具有相同内容的多个连续消息）。但是，出于您的目的，这`post-command-hook`已经绰绰有余而且更安全，因此您可以使用它：

```
(add-hook 'post-command-hook
          (lambda ()
            (let ((messages (get-buffer "*Messages*")))
              (unless (eq (current-buffer) messages)
                (with-current-buffer messages
                  (goto-char (point-max))))))) 
```

除非您当前正在编辑缓冲区本身，否则钩子将确保`*Messages*`在每个命令之后指向缓冲区的末尾。`*Messages`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T16:15:58.060

好吧，我已经用`set-window-point`.

```
(defun tail-f-msgs ()
  "Go to the end of Messages buffer."
  (let ((msg-window (get-buffer-window "*Messages*")))
    (if msg-window
        (with-current-buffer (window-buffer msg-window)
          (set-window-point msg-window (point-max))))))

;; Make the Messages buffer stick to the end.
(add-hook 'post-command-hook 'tail-f-msgs) 
```

# c - 读到行尾

> ID：13316497
> 
> 赞同：2
> 
> 时间：2012-11-09T21:47:31.550
> 
> 标签：c, file

作为我项目的一部分，我正在尝试从 C 中的文件中读取。

我的目的是将文件中的单词（由空格、逗号、分号或换行符分隔）解析为标记。

为此，我**必须逐字**阅读。

```
do {

    do {

        tempChar = fgetc(asmCode);
        strcpy(&tempToken[i], &tempChar);

        i++;

    } while (tempChar != ' ' || tempChar != ':' || tempChar != ';' || tempChar != ',' || tempChar != '\n');//reading until the given parameters

    i = 0;

    //some other code with some other purpose

} while (tempChar != EOF);//reading until the end of the file 
```

即使下面的代码从文件中读取，它也不会停止读取，因为它不会在 while 中应用条件。

我在这里做错了什么？

PS tempChar 和 tempToken 都定义为 char 变量。还有另一个

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T15:56:42.683

我猜这行代码出了点问题：

`while (tempChar != ' ' || tempChar != ':' || tempChar != ';' || tempChar != ',' || tempChar != '\n');`

由于您使用了||，因此条件始终为真，使其成为无限循环。试试这个，这可能有效：

`while (tempChar != ' ' && tempChar != ':' && tempChar != ';' && tempChar != ',' && tempChar != '\n');`

另外，我更`if(feof(asmCode))`喜欢`if (tempChar == EOF)`. 如果 tempChar 的值与 EOF 相同，`if (tempChar == EOF)`则将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:07:37.477

正如我在您的代码中看到的那样，类型`tempchar`是 char：`char tempchar`

你不能`strcpy(&tempToken[i], &tempChar);`用来复制字符。strcpy 将字符串复制到 sting 缓冲区。

尝试以下固定代码

```
do {

    do {

        tempChar = fgetc(asmCode);

        if (tempChar == EOF)
            break;
        tempToken[i]= tempChar;

        i++;

    } while (tempChar != ' ' || tempChar != ':' || tempChar != ';' || tempChar != ',' || tempChar != '\n');//reading until the given parameters
    tempToken[i]='0';
    i = 0;  // this will erase the old content of tempToken !!! what are you trying to do here ?

    //some other code with some other purpose

} while (tempChar != EOF);//reading until the end of the file 
```

# entity-framework-4 - Entity Framework 5 Code First 迁移：获取数据库脚本

> ID：13316498
> 
> 赞同：1
> 
> 时间：2012-11-09T21:47:32.727
> 
> 标签：entity-framework-4, entity-framework-4.1, entity-framework-5, entity-framework-migrations

我有一个遵循[John Papa 关于 SPA](http://www.johnpapa.net/building-single-page-apps-with-knockout-jquery-and-web-api-ndash-the-story-begins)的课程的项目。所以，我的架构如下：

```
**proj.Data.Data**
    /Configuration     
      Mappings of the entities with Fluent
    ProjContext.cs
    ProjInitializer.cs
    EFRepository.cs
    /Migrations folder

**proj.Data.Model**
    Pocos (Entity Framework 5 Code First)
    No reference to Entity Framework

**proj.Data.Contracts**
    Interface for IRepository and IProjContext

**proj.UI.Web**
    MVC 4/WebApi project 
```

我有一个现有的数据库，我运行了实体框架的逆向工程来获取实体并将上下文与实体分离（在两个不同的项目中，如上所示）

然后我跑了（从 PackageManager 控制台下拉菜单中选择 proj.Data.Data）：

```
Enable-Migrations -force -StartupProjectName "Proj.Data.Data"
add-migration InitialSchema
Update-Database
Update-Database -Script -SourceMigration $InitialDatabase 
```

我只在 proj.Data.Data 项目的 Migrations 文件夹中看到一个名为 201211091944388_InitialSchema 的文件，其中 up 和 down 方法为空。未创建 MigrationHistory 表。

我需要运行什么来获取 sql 脚本以使用我从实体中获得的所有表从头开始生成数据库？

谢谢！吉列尔莫。

**注意：**我在一个名为 Data 的解决方案文件夹中有 .Data 项目，在一个名为 UI 的解决方案文件夹中有 Web 项目，我应该因此采取任何额外的步骤吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T20:43:23.740

我不知道为什么它不适用于逆向工程，但是我按照所有约定再次制作了模型并且它起作用了。

顺便说一句，如果我们在现有数据库上运行 enable-migrations 命令，它不会创建 __MigrationHistory 表或 Initial 脚本。这是为了避免更改现有数据库而设计的。不管怎么说，多谢拉。

# java - 在jsp中获取属性未找到异常

> ID：13316502
> 
> 赞同：3
> 
> 时间：2012-11-09T21:48:08.747
> 
> 标签：java, jsp, google-cloud-datastore, jstl

我试图显示实体列表，但出现此错误：

```
javax.el.PropertyNotFoundException: Could not find property drug in class com.google.appengine.api.datastore.Entity 
```

显示属性的方式是这样的：

```
 <c:forEach items="${drugtargets}" var="drugtarget">
<tr>
  <td>${drugtarget.drug}</td>
  <td>${drugtarget.target}</td>
</tr> 
```

我检查了我的数据存储和实体属性，但没有看到任何错误。我的属性是药物和目标。你能告诉我我应该怎么做吗？谢谢。

```
Key drugKey = KeyFactory.createKey("DrugTarget", drug);

Entity drugtarget = new Entity("DrugTarget",drugKey);
drugtarget.setProperty("drug", drug);
drugtarget.setProperty("target", target); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T21:51:47.163

我不做 GAE，但根据该类的[javadoc](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/Entity)，`Entity`它告诉有一个[`getProperties()`方法返回 a`Map<String, Object>`所有属性](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/PropertyContainer#getProperties%28%29)，那么您应该能够访问各个属性，如下所示：

```
<td>${drugtarget.properties.drug}</td>
<td>${drugtarget.properties.target}</td> 
```

### 也可以看看：

*   [我们的 EL 维基页面](https://stackoverflow.com/tags/el/info)

* * *

**与具体问题无关**，如果这涉及用户控制的数据，请记住这会形成潜在的 XSS 攻击漏洞。您应该使用[JSTL](https://stackoverflow.com/tags/jstl/info) `<c:out>`或`fn:escapeXml()`.

```
<td><c:out value="${drugtarget.properties.drug}" /></td>
<td><c:out value="${drugtarget.properties.target}" /></td> 
```

# apache-flex - flex - 克隆的 ComboBox 类 - 向下箭头消失（试图修复屏幕底部的下降）

> ID：13316504
> 
> 赞同：0
> 
> 时间：2012-11-09T21:48:18.973
> 
> 标签：apache-flex

我克隆了 ComboBox 类，以解决选项卡底部的 ComboBox 向下扩展并从屏幕底部消失的问题。我这样做是为了应用来自[http://craiggrummitt.wordpress.com/tag/combobox/](http://craiggrummitt.wordpress.com/tag/combobox/)的补丁。我不得不将“../styles/FocusStyles.as”等复制到项目文件夹中。我也将 ComboBox.png 复制到项目文件夹中。

ComboBox 现在确实向上打开，但显示的组合上没有箭头按钮。如果我将 [IconFile("ComboBox.png")] 重命名为 [IconFile("Garbage.png")] 我没有收到错误并且代码仍然运行。没有 Garbage.png。这是否意味着问题在于 ComboBox.png 显示箭头按钮并且新类无法找到该文件，或者这只是一个红鲱鱼？蒂亚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T00:11:11.343

[IconFile 元数据](http://livedocs.adobe.com/flex/3/html/help.html?content=metadata_3.html)由 Flash Builder 使用，与组件的运行时元素无关。我将引用文档：

> 标识代表 Adob​​e Flex Builder 插入栏中的组件的图标的文件名。有关详细信息，请参阅 IconFile 元数据标记。

如果 ComboBox 上没有箭头按钮；听起来您可能不正确地设置了皮肤，或者我们的扩展程序以某种方式干扰了功能。您必须分享一些代码以供我们进一步帮助。

# sql - SQL ALTER 属性

> ID：13316510
> 
> 赞同：-5
> 
> 时间：2012-11-09T21:48:39.983
> 
> 标签：sql, oracle

获取所有喜剧或恐怖电影的电影标题，将输出属性名称重命名为“Happily Scared”</p>

```
SELECT comedy,horror 
FROM movie 
ALTER TABLE comedy,horror RENAME TO Happily Scared 
```

我在 sql 查询中不断收到错误。它出什么问题了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T21:55:24.037

我猜你想要`UPDATE`你的桌子。没有看到你的表结构，你会想要这样的东西：

```
update movie
set title = 'Happily Scared'
where genre in ('comedy', 'horror') 
```

更新语法：

```
UPDATE table_name
SET column1=value, column2=value2,...
WHERE some_column=some_value 
```

# php - 解析错误：语法错误，意外的 '}'，期待 T_STRING client.php 在第 137 行

> ID：13316512
> 
> 赞同：0
> 
> 时间：2012-11-09T21:48:46.703
> 
> 标签：php, parse-error

这是代码，我找不到任何未括起来的单引号或双引号 - 但是在执行时它会返回

> 解析错误：语法错误，意外的 '}'，期待 T_STRING client.php 在第 137 行

：

```
 <?php
/**
 * An API client for Dropbox
 */
class DropboxClient
{
    protected $Session = null;

    /**
     * Common API URL
     * @var
     */
    protected $dropboxAPIURL = "https://api.dropbox.com/1";

    /**
     * Content-related API URL
     * @var
     */
    protected $dropboxContentAPIURL = "https://api-content.dropbox.com/1";

    /**
     * Constructor
     *
     * Initialize the client wit a valid session
     *
     * @param  object  $session
     * @return void
     */
    function __construct( DropboxSession $session) {
        $this->Session = $session;
        $this->accessType = $this->Session->getAccessType();
    }

    /**
     * Retrieve information from the user's account
     *
     * @return string
     */
    public function accountInfo() {
        $response = $this->Session->fetch("GET", $this->dropboxAPIURL, "/account/info");
        return $response["body"];
    }

    /**
     * Fetch metadata for a file or folder
     *
     * The path is relative to a root (ex /<root>/<path>) that can be 'sandbox' or 'dropbox'
     *
     * @param  string   $path             The path of the resource to fetch
     * @param  boolean  $list             Whether to list all contained files (applies only to folders)
     * @param  int      $fileLimit        Max items returned with the listing mode
     * @param  string   $hash             Hash value for a previous call
     * @param  string   $revision         Specific revision for the object
     * @param  bool     $includeDeleted   Whether to include deleted files and folders
     * @return string
     */
    public function metadata($path, $list = true, $fileLimit = 10000, $hash = null, $revision = null, $includeDeleted = false) {
        // Prepare argument list
        $args = array(
            "file_limit" => $fileLimit,
            "hash" => $hash,
            "list" => (int) $list,
            "include_deleted" => (int) $includeDeleted,
            "rev" => $revision
        );

        // Prepend the right access string to the desired path
        if ("dropbox" == $this->accessType) {
            $path = "dropbox" . $path;
        }
        else {
            $path = "sandbox" . $path;
        }

        // Execute
        $response = $this->Session->fetch("GET", $this->dropboxAPIURL, "/metadata/" . $path, $args);
        return $response["body"];
    }

    /**
     * Downloads a file from the user's Dropbox
     *
     * The path is relative to a root (ex /<root>/<path>) that can be 'sandbox' or 'dropbox'
     *
     * @param  string   $path             The path of the resource to fetch
     * @param  string   $outFile          The download path for the file
     * @param  string   $revision         Specific revision for the object
     * @return array
     */
    public function getFile($path, $outFile = null, $revision = null) {

        $args = array();
        if (!empty($revision)) {
            $args["rev"] = $revision;
        }

        // Prepend the right access string to the desired path
        if ("dropbox" == $this->accessType) {
            $path = "dropbox" . $path;
        }
        else {
            $path = "sandbox" . $path;
        }

        // Get the raw response body
        $response = $this->Session->fetch("GET", $this->dropboxContentAPIURL, "/files/" . $path, $args, true);

        if ($outFile != null) {
            if (file_put_contents($outFile, $response["body"]) === false) {
                throw new Exception("Unable to write file '$outfile'");
            }
        }

        return array(
            "name" => ($outFile) ? $outFile : basename($path),
            "mime" => $response["headers"]["content-type"],
            "meta" => json_decode($response["headers"]["x-dropbox-metadata"]),
            "data" => $response["body"]
        );
    }

    /**
     * Upload a file to the user's Dropbox
     *
     * The path is relative to a root (ex /<root>/<path>) that can be 'sandbox' or 'dropbox'
     *
     * @param  string   $file       The full path of the file to upload
     * @param  string   $path       The destination path (default = root)
     * @param  string   $name       Specifies a different name for the uploaded file
     * @param  boolean  $overwrite  Overwrite any existing file
     * @return array
     */
    public function putFile($file, $path = "/", $name = null, $overwrite = true) {
        // Check for file existence before
        if (!file_exists($file)) {
            throw new Exception("Local file '" . $file . "' does not exist");\
        }

        // Dropbox has a 150MB limit upload for the API
        if (filesize($file) > 157286400) {
            throw new Exception("File exceeds 150MB upload limit");
        }

        $args = array(
            "overwrite" => (int) $overwrite,
            "inputfile" => $file
        );

        // Prepend the right access string to the desired path
        if ("dropbox" == $this->accessType) {
            $path = "dropbox" . $path;
        }
        else {
            $path = "sandbox" . $path;
        }

        // Determine the full path
        if (!empty($name)) {
            $path = dirname($path) . "/" . $name;
        }
        else {
            $path .= basename($file);
        }

        // Get the raw response body
        $response = $this->Session->fetch("PUT", $this->dropboxContentAPIURL, "/files_put/" . $path, $args);

        return $response["body"];
    }
} 
```

我找不到任何可能导致第 137 行或更高行错误的代码部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:50:57.333

第 136 行的代码中有一个反斜杠：

```
throw new Exception("Local file '" . $file . "' does not exist");\
                                                                 ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T21:52:21.560

在这里，你有一个不必要的反斜杠，

```
throw new Exception("Local file '" . $file . "' does not exist");\ 
```

**注意：**请使用 IDE 来检测此类微不足道的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:55:09.483

这条线的末尾是否有反斜杠？

```
Exception("Local file '" . $file . "' does not exist");\ 
```

# cuda - CUDA 共享内存占用的空间是所需空间的两倍

> ID：13316513
> 
> 赞同：5
> 
> 时间：2012-11-09T21:48:48.307
> 
> 标签：cuda, shared-memory

我刚刚注意到我的 CUDA 内核使用的空间恰好是“理论”计算的空间的两倍。例如

```
__global__ void foo( )
{
    __shared__ double t;
    t = 1;
} 
```

PTX 信息显示：
ptxas 信息：_Z3foov 的函数属性，0 字节堆栈帧，0 字节溢出存储，0 字节溢出加载
ptxas 信息：使用 4 个寄存器，16 字节 smem，32 字节 cmem[0]

但是双倍的大小只有 8。

更多示例：

```
__global__ void foo( )
{
    __shared__ int t[1024];
    t[0] = 1;
} 
```

ptxas 信息：使用了 3 个寄存器，8192 字节 smem，32 字节 cmem[0]

有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T17:31:45.443

似乎问题已经出现在当前的 CUDA 编译器中。

```
__shared__ int a[1024]; 
```

使用命令 'nvcc -m64 -Xptxas -v -ccbin /opt/gcc-4.6.3/bin/g++-4.6.3 shmem.cu' 编译给出

```
ptxas info    : Used 1 registers, 4112 bytes smem, 4 bytes cmem[1] 
```

在这种情况下会有一些共享内存开销，但使用量并没有翻倍。

# php - 网络浏览器中的网络浏览器

> ID：13316514
> 
> 赞同：0
> 
> 时间：2012-11-09T21:49:08.183
> 
> 标签：php, javascript, html, iframe, proxy

网络浏览器中是否可以有网络浏览器？

例如：我想在我的网站上有一个可以输入网址的搜索栏，它可以在我所在的当前页面中加载网页。（我知道，盗梦空间）但这可能吗？

你可以使用 iframe 或其他一些吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:53:04.490

您将必须对地址栏进行编码，然后使用 jquery 进行后退、前进、刷新。一旦您拥有这些功能，是的，使用 iFrame 并通过 jquery 相应地加载内容。

# c++ - 计算两个向量之间共享元素数量的最快方法

> ID：13316515
> 
> 赞同：0
> 
> 时间：2012-11-09T21:49:10.943
> 
> 标签：c++, boost, vector, comparison, intersection

假设我有两个大小相同的向量，`vector< pair<float, NodeDataID> > v1, v2;`我想计算 v1 和 v2 中有多少元素具有相同的 NodeDataID。例如 if `v1 = {<3.7, 22>, <2.22, 64>, <1.9, 29>, <0.8, 7>}`, and `v2 = {<1.66, 7>, <0.03, 9>, <5.65, 64>, <4.9, 11>}`, 那么我想返回**2**因为 v1 和 v2 中有两个元素共享相同的 NodeDataID：7 和 64。

在 C++ 中最快的方法是什么？

仅供参考，请注意类型`NodeDataIDs`是在我使用 boost 时定义的：

```
typedef adjacency_list<setS, setS, undirectedS, NodeData, EdgeData> myGraph;
typedef myGraph::vertex_descriptor NodeDataID; 
```

但这并不重要，因为我们可以使用运算符 == 来比较两个 NodeDataID（也就是说，可以做`v1[i].second == v2[j].second`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T21:52:04.023

将第一个向量的元素放入哈希表中。遍历第二个向量，测试每个元素是否在哈希表中。

哈希表的优点是可以在恒定时间内完成插入和查找。这意味着，可以在线性时间内找到交点。这是最优的，因为无论算法如何，您都必须至少查看每个向量元素一次。

Boost 有[boost::intrusive::hashtable](http://www.boost.org/doc/libs/1_52_0/doc/html/boost/intrusive/hashtable.html)，但它（顾名思义）是侵入性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:57:50.347

最简单的解决方案是将第一个向量的元素放入一个集合中，然后对于第二个向量，我们将每个元素插入该集合中 (ret = myset.insert(an_id))，如果 ret.second 为假，则该元素存在，因此我们增加了一个计数器。

```
set<NodeDataID> myset;
int counter = 0;

for(int i = 0; i < v1.size(); ++i)
   myset.insert(v1[i].second);

for(int i = 0; i < v2.size(); ++i)
{
   pair<set<NodeDataID>::iterator,bool> ret = myset.insert(v2[i].second);
   if(ret.second == false)
      ++counter;
} 
```

# jquery-mobile - 在jquery mobile中实现动态详细视图

> ID：13316518
> 
> 赞同：0
> 
> 时间：2012-11-09T21:49:23.953
> 
> 标签：jquery-mobile

所以我有一个包含多个项目的列表视图，所以当每个项目被单击时，它会转到一个详细信息页面，但是我如何用动态内容填写详细信息视图？具体来说，如何获取key，也就是被点击的item的内部html，在查询一些动态内容的时候，如何放到detail view中呢？我尝试的方法包括1）对每个项目使用点击事件，但事件没有触发，这正常吗？2）我在详细视图页面上尝试了使用 pagebeforeshow 的实时事件，但它也没有触发。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:17:03.177

有许多方法可以做到这一点。这是一个可以帮助您的想法：

在您`listview`的 中，为列表项中的每个超链接指定一个数据 ID。定义可能如下所示：

```
<li><a data-id="some-identifier">My Title</a></li> 
```

对于`<li>`列表中的所有项目，您将拥有一个单击处理程序，它将使用`data-id`初始化详细信息页面。点击处理程序看起来像这样（如果数据不足，我深表歉意，我最近没有使用过 jQuery Mobile，所以可能会有更新的更好的方法）：

```
$('#my-listview-id').delegate('a', 'vclick', function () {
     alert ('user selected something: ' +  $(this).attr('data-id'));
}); 
```

警报将向您显示用户选择的 ID。因此，在单击处理程序中，您可以更新详细信息页面。

# java - 在java中转义引号

> ID：13316520
> 
> 赞同：0
> 
> 时间：2012-11-09T21:49:34.657
> 
> 标签：java, string, http, escaping

我正在尝试在必须通过的地方进行网络服务调用

```
login.php?message=[{"email":"mikeymike@mouse.com","password":"tiger"}] 
```

我已经使用反斜杠来转义这样的双引号

```
String weblink = "login.php?message=[{\"email\":\"mikeymike@mouse.com\",\"password\":\"tiger\"}]"; 
```

但我仍然遇到错误。我尝试过调用其他不需要带有任何双引号的数据的 web 服务，它们工作正常，所以我很确定问题出在这个问题上。我也得到一个 java.lang 异常说

```
java.lang.Exception  Indicates a serious configuration error.DateParseException An exception to indicate an error parsing a date string.  DestroyFailedException Signals that the destroy() method failed 
```

编辑：我尝试使用 URLEncoder 和 JSON 对象，但仍然出现错误

这是其余的代码

```
String HOST = "http://62.285.107.329/disaster/webservices/";

 String weblink = "login.php?message=[{\"email\":\"mikeymike@mouse.com\",\"password\":\"tiger\"}]";
String result = callWebservice(weblink);

 public String callWebservice(String weblink) {
    String result = "";
    try {

        HttpParams httpParameters = new BasicHttpParams();
        int timeoutConnection = 7500;
        HttpConnectionParams.setConnectionTimeout(httpParameters,
                timeoutConnection);
        int timeoutSocket = 7500;
        HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);
        HttpClient client = new DefaultHttpClient(httpParameters);
        HttpGet request = new HttpGet();
        URI link = new URI(HOST + weblink);
        request.setURI(link);
        HttpResponse response = client.execute(request);

        BufferedReader rd = new BufferedReader(new InputStreamReader(
                response.getEntity().getContent()));
        result = rd.readLine();

    } catch (Exception e1) {
        e1.printStackTrace();
        result = "timeout";
    }
    return result;
} 
```

Web 服务还返回一个 JSON 对象，所以这也可能是错误的原因吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T21:59:48.363

与其手动尝试并得到错误，不如使用[JSONObject](http://www.json.org/javadoc/org/json/JSONObject.html)类和 UrlEncoder 的组合。

```
 JSONObject json = new JSONObject();
 json.put("email","mikeymike@mouse.com" );
 json.put("password", "tiger");
 String s = "login.php?message=" + UrlEncoder.encode(json.toString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T20:52:39.167

向所有人道歉，但问题似乎是我试图以错误的方式使用 Web 服务，因为它返回一个 JSON 对象。

对于可能遇到此问题的任何人，正确的方法是在下面的代码中

```
String str="url";
try{
    URL url=new URL(str);
    URLConnection urlc=url.openConnection();
    BufferedReader bfr=new BufferedReader(new InputStreamReader(urlc.getInputStream()));
    String line;
    while((line=bfr.readLine())!=null)
    {
    JSONArray jsa=new JSONArray(line);
    for(int i=0;i<jsa.length();i++)
       {
       JSONObject jo=(JSONObject)jsa.get(i);
                    title=jo.getString("deal_title");  //tag name "deal_title",will return value that we save in title string
                des=jo.getString("deal_description");
   }
}
catch(Exeption e){
} 
```

这个答案来自

[如何通过android调用json webservice](https://stackoverflow.com/questions/7076576/how-to-call-a-json-webservice-through-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:58:52.327

您必须`%22`在以下位置使用`"`：`login.php?message=[{%22email%22:%22mikeymike@mouse.com%22,%22password%22:%22tiger%22}]`

`"`不是 URL 中的有效字符。

更通用的解决方案是使用`URLEncoder.encode("login.php?message=[{\"email\":\"mikeymike@mouse.com\",\"password\":\"tiger\"}]", "UTF8")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T22:05:06.140

当您与 Web 服务通信时，您需要对数据进行[URL 编码](http://en.wikipedia.org/wiki/Percent-encoding)。在您的情况下，url 编码将替换`"`为`%22`，但如果您要添加其他特殊字符，例如`%`，编码也会捕获这些。为此，JDK 中有一个 java 类，称为[URLEncoder](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)。

因此，基本上，您要做的是使用 准备字符串`URLEncoder.encode()`，如下所示：

```
String weblink = URLEncoder.encode("login.php?message=[{\"email\":\"mikeymike@mouse.com\",\"password\":\"tiger\"}]"); 
```

现在字符串已编码，您应该能够将其发送到服务器并让它理解您的意思。

# sql-server - 导入平面文件时如何让 SSIS 检测记录长度？

> ID：13316524
> 
> 赞同：2
> 
> 时间：2012-11-09T21:49:42.827
> 
> 标签：sql-server, ssis

我编写了一个 SSIS 包，它将数据从固定记录长度的平面文件导入到 SQL 表中。在单个文件中，记录长度是恒定的，但不同的文件可能有不同的记录长度。每条记录都以 CR/LF 结尾。如何让它检测记录的结尾在哪里，并在导入时使用该长度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:16:46.597

您可以使用脚本任务。将 ReadWriteVariable 传递给脚本任务。我们将 ReadWriteVariable 称为 intLineLength。在脚本任务代码中，检测 CR/LF 的位置并将其写入 intLineLength。在以下包步骤中使用 intLineLength ReadWriteVariable 导入数据。

这是一篇带有一些很好示例的文章：[script-task-to-dynamically-build-package-variables](http://www.mssqltips.com/sqlservertip/1443/integration-services-script-task-to-dynamically-build-package-variables/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T16:34:41.420

这可能不适用于所有人，但我最终所做的只是将其设置为带分隔符的平面文件并将 CR/LF 设置为行分隔符，并将列分隔符和文本限定符留空。如果您实际上需要在导入中拆分列，这将不起作用，但我已经使用派生列任务来执行实际的列拆分，因为我的列位置是可变的，所以它工作得很好。

# opacity - 不透明背景上的图像也在增加不透明度

> ID：13316528
> 
> 赞同：0
> 
> 时间：2012-11-09T21:49:54.447
> 
> 标签：opacity

我使网站的容器具有不透明度：0.8，然后当我在此容器中添加照片时，实际上任何东西，它也显示为相同的不透明度。我想将图像保持在 100% 且不透明。我不确定这实际上将如何解决。我已经尝试专门更改图像 z-index 和不透明度，但这没有用。任何帮助都会很棒。请参阅下面的示例。

[查看样品](http://www.birdbathgroup.com/template-happenings.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T13:43:53.060

请阅读说明，例如[http://css-tricks.com/rgba-browser-support/](http://css-tricks.com/rgba-browser-support/)：

> 我们早就有 opacity 属性，它是类似的，但是 opacity 迫使所有后裔元素也变得透明，没有办法对抗它

所以你必须使用例如：

```
background: rgba(200, 54, 54, 0.5); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:05:43.503

我认为您最好将这些元素的背景设置为半透明，而不是为整个容器添加透明度。这不会影响照片，并使文本和按钮更易于阅读。

# properties - Ember 多个属性更改但想触发单个事件

> ID：13316538
> 
> 赞同：10
> 
> 时间：2012-11-09T21:50:43.953
> 
> 标签：properties, ember.js

我有一个用于日期选择器的ArrayController，其属性**为****.** **现在，当用户从**UI 中选择新的日期范围时，无论**是**值更改还是值更改。

 **因此，对于日期范围的一次更改**，**观察者往返的函数**会触发两次。**

我想在每个日期范围更改时仅触发一次该功能。任何关于如何使用 ember 的建议

```
 app = Ember.Application.create();

    app.Time = Ember.ArrayController.create({

        to: null,
        from: null,
        rootElement: "#time",

        debug1: function() {
            this.set('to', 1);
            this.set('from', 2);
        },

        debug2: function() {
            this.setProperties( {
                'to': 3,
                'from': 4
            });
        },

        debug3: function() {
            this.beginPropertyChanges();
            this.set('to', 5);
            this.set('from', 6);
            this.endPropertyChanges();
        },

        search: function() {
            alert('called');
        }.observes('to', 'from')
    }); 
```

[在 JS Fiddle 中查看](http://jsfiddle.net/zf2q3/)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-09T22:48:52.103

`from`也许您可以在and上引入一个计算属性`to`，然后将观察者插入该属性。由于默认情况下会缓存 CP，因此我认为观察者只会被触发一次。

```
date: function(){
 // return the computed date
}.property('from', 'to')

dateDidChange: function(){

}.observes('date') 
```

**编辑**感谢您的小提琴，它似乎可以使用 setProperties 或开始/结束 propertyChanges [http://jsfiddle.net/Sly7/zf2q3/1/](http://jsfiddle.net/Sly7/zf2q3/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T16:58:39.643

您可以将观察者包装在`Em.run.once`

```
_dateDidChange: function(){
  Ember.run.once(this, 'dateDidChange');
}.observes('from', 'to'),

dateDidChange: function() {
  // should be called only once
} 
```**

# python - 如何捕获所有错误并参考抛出的内容？

> ID：13316540
> 
> 赞同：2
> 
> 时间：2012-11-09T21:50:48.117
> 
> 标签：python, exception

我已经两次阅读这篇文章[http://docs.python.org/2/tutorial/errors.html以确保。](http://docs.python.org/2/tutorial/errors.html)它完全避开了这个话题。

1.  我尝试抛出不是`Exception`or`ExceptionBase`的东西，解释器告诉我我只能抛出`ExceptionBase`-esque 和老式类的对象。
2.  所以我尝试抛出旧式类的对象：

* * *

```
>>> class Foo():
...     pass
... 
>>> try:
...     raise Foo()
... except Exception as foo:
...     print 'foo %s' % foo
... except:
...     print 'not an exception'
... else:
...     print 'it\'s all good'
... 
not an exception
>>> 
```

惊喜......那么，我如何捕捉所有这些并检查捕捉到了什么？

编辑：

动机。

1.  过度防御性的编码从来都不是一个坏习惯。假设我正在编写一个守护程序，我为什么不尝试通过做一些其他标准微不足道的事情来尽可能多地防止潜在的危险呢？
2.  程序并不总是在友好的环境中运行，有时其他程序会试图破坏您的程序，在这种情况下，您确实需要防止各种错误。有时它是有道理的。例如，考虑一个 CGI 实现——如果某个租用其中一部分的白痴在其中放置了一个脚本，从而引发了这个“意外”错误，您是否希望您的整个服务器停机？
3.  一些框架已经为您捕获了所有错误，因此从框架代码层下获取消息并不容易。抛出框架代码没有捕捉到的东西可能是绕过它的好策略（这不仅仅是一个理论案例，我之前做过）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:58:07.227

 ~~~~```
import types

try:
    raise Foo()
except (Exception, types.InstanceType) as foo:
    print 'foo %s' % foo
else:
    print 'it\'s all good' 
```~~  ~~## 编辑：

虽然感觉它应该工作，但它没有。这是一个hacky方式：

```
import sys

try:
    raise Foo()
except:
    etype, foo, traceback = sys.exc_info()
    print 'foo %s' % foo
else:
    print 'it\'s all good' 
```~~~~

# algorithm - 分辨率推理规则算法

> ID：13316541
> 
> 赞同：0
> 
> 时间：2012-11-09T21:50:49.697
> 
> 标签：algorithm, logic, artificial-intelligence

我对决议推理规则有以下疑问。

1* 在`for each Ci, Cj in clauses do`中，每个 Ci 和 Cj 是否必然包含互补符号（例如，一个包含 A，另一个包含 ~A）？

2* 在上面的示例中，如果两个子句具有相同的符号（例如 A 和 A）怎么办。我应该考虑推论吗？如果是这样，它返回什么结果？

3* 什么时候`if new ⊆ clauses then return false`运行？在所有条款都被探索过之后？

4* 有什么用`if new ⊆ clauses then return false`？

5* 有什么用`if new ⊆ clauses then return false`？

```
 function PL-RESOLUTION(KB,α) returns true or false
     inputs: KB, the knowledge base, a sentence α in propositional logic, 
             the query, a sentence in propositional logic 
     clauses <--- the set of clauses in the CNF representation of KB ∧ ¬α
     new <--- {}
     loop do
        for each Ci, Cj in clauses do
            resolvents <----- PL-RESOLVE(Ci, Cj)
            if resolvents contains the empty clause then return true
            new <--- new ∪ resolvents
        if new ⊆ clauses then return false
        clauses <---- clauses  ∪ new 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T13:35:14.677

1.  Yes.
2.  No, you can't apply resolution in that case.
3.  Well, why shouldn't it happen?
4.  I guess it's to avoid infinite loops (in that case you return to the conditions at the previous iteration)
5.  Same question?

More about 1 and 2\. The idea for resolution is that if you have (A v B) ^ (not A v C) then you can safely infer that B or C are true (informally because A is either true or false). If you have (A v B) ^ (A v C) you can't apply the same reasoning.

# powershell - Powershell v3 中的 Export-csv - 输出不同于 PS v2

> ID：13316542
> 
> 赞同：0
> 
> 时间：2012-11-09T21:50:50.017
> 
> 标签：powershell, powershell-2.0, powershell-3.0

这是一个奇怪的问题。每当我尝试使用 export-csv 将某些内容导出到 csv 时，.csv 中的唯一数据就是长度属性。这是为什么？例如：

```
$boogers = "string data"
$boogers | export-csv c:\script\boogers.csv -notypeinformation 
```

现在输出将如下所示：

```
Length
11 
```

是什么赋予了？也许这只是我，但我似乎无法在谷歌机器上找到关于这个 cmdlet 的非常好的信息。按照 Microsoft 的传统，get-help 文件没有多大帮助。

你们能给我的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:07:41.303

在 Powershell v2 中也是如此。

`Export-Csv`将为输入对象的每个公共属性创建 CSV 列。这正是（非常有用和详细的，IMO）[文档](http://technet.microsoft.com/en-us/library/hh849932.aspx)所说的。 `System.String`只有 1 个公共财产 - `Length`。

也许您想要一个名为`Value`或类似的列？你可以这样做：

```
'boogers' | select *, @{N='Value'; E={$_}} | Export-Csv C:\boogers.csv 
```

# windows - Windows 中的 Perl kill(0, $pid) 总是返回 1

> ID：13316547
> 
> 赞同：2
> 
> 时间：2012-11-09T21:51:01.363
> 
> 标签：windows, perl, process

我正在尝试制作一个将在 Windows 中运行一组其他程序的 Perl 脚本。我需要能够捕获进程的标准输出、标准错误和退出代码，并且我需要能够查看进程是否超过了分配的执行时间。现在，我的代码的相关部分如下所示：

```
...
        $pid = open3($wtr, $stdout, $stderr, $command);
        if($time < 0){
            waitpid($pid, 0);
            $return = $? >> 8;
            $death_sig = $? & 127;
            $core_dump = $? & 128;
        }
        else{
            # Do timeout stuff, currently not working as planned
            print "pid: $pid\n";
            my $elapsed = 0;
            #THIS LOOP ONLY TERMINATES WHEN $time > $elapsed ...?
            while(kill 0, $pid and $time > $elapsed){
                Time::HiRes::usleep(1000);  # sleep for milliseconds
                $elapsed += 1;
                $return = $? >> 8;
                $death_sig = $? & 127;
                $core_dump = $? & 128;
            }
            if($elapsed >= $time){
                $status = "FAIL";
                print $log "TIME LIMIT EXCEEDED\n";
            }
        }
        #these lines are needed to grab the stdout and stderr in arrays so 
        #  I may reuse them in multiple logs
        if(fileno $stdout){
            @stdout = <$stdout>;
        }
        if(fileno $stderr){
            @stderr = <$stderr>;
        }
... 
```

`$time = -1`如果（不需要超时）一切正常，但系统认为它`kill 0, $pid`始终为 1。这使得我的循环在允许的整个时间内运行。

一些额外的细节只是为了清楚起见：

*   这是在 Windows 上运行的。
*   我知道我的进程确实终止了，因为我已经获得了所有预期的输出。
*   Perl 版本：这是为 MSWin32-x86-multi-thread 构建的 perl，v5.10.1（带有 2 个注册补丁，有关更多详细信息，请参见 perl -V）版权所有 1987-2009，Larry Wall Binary build 1007 [291969] 由 ActiveState [http提供://www.ActiveState.com](http://www.ActiveState.com) 建于 2010 年 1 月 26 日 23:15:11
*   感谢您的帮助：D

*对于可能有类似问题的未来人，* 我让代码工作，这里是修改后的代码部分：

```
 $pid = open3($wtr, $stdout, $stderr, $command);
        close($wtr);
        if($time < 0){
            waitpid($pid, 0);
        }
        else{
            print "pid: $pid\n";
            my $elapsed = 0;
            while(waitpid($pid, WNOHANG) <= 0 and $time > $elapsed){
                Time::HiRes::usleep(1000);  # sleep for milliseconds
                $elapsed += 1;
            }

            if($elapsed >= $time){
                $status = "FAIL";
                print $log "TIME LIMIT EXCEEDED\n";
            }
        }
        $return = $? >> 8;
        $death_sig = $? & 127;
        $core_dump = $? & 128;
        if(fileno $stdout){
            @stdout = <$stdout>;
        }
        if(fileno $stderr){
            @stderr = <$stderr>;
        }
        close($stdout);
        close($stderr); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T22:34:16.117

而不是`kill 0`，使用[`waitpid $pid, WNOHANG`](http://perldoc.perl.org/functions/waitpid.html)：

```
use POSIX qw( WHOHANG );

if (waitpid($pid, WNOHANG) > 0) {
   # Process has ended. $? is set.
   ...
} 
```

# ruby-on-rails - 如何使用 Rails 将实例变量 DRY 保存在控制器助手中？

> ID：13316548
> 
> 赞同：0
> 
> 时间：2012-11-09T21:51:01.027
> 
> 标签：ruby-on-rails, filter, module, dry

我正在编写这个将包含在站点的单个页面中的小部件，所以我看不到有理由声明我在 ApplicationController 中所做的事情。然而，这个新的小部件确实有相当多的复杂性，所以我想把它与通常处理这个页面的控制器分开，因为那个控制器已经有相当多的复杂性了。我最初认为在我的设计中，我可以为控制器制作一个辅助模块，并将大部分小部件逻辑保留在那里。

我正在尝试编写此帮助程序模块，但后来我意识到我需要能够从单个位置初始化一个特定的数组，但是需要多个方法来访问它，并且需要确保它在任何之前被初始化其他方法调用此数组。有没有办法在这样的模块中做类似于 before_filter 的事情，我可以确保在使用之前初始化这个变量，或者有没有更好的整体方法来接近这个，那就是“Rails 方式”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:58:47.740

我认为您可以创建一个新类并在 before_filter 或您的控制器中实例化它。不知道你想达到什么，但一个例子可能是：

```
class MyArrayBuilder
  def initialize(some, param)
    #something
  end

  def get_array
    return my_array
  end
end

class SomethingsController < ApplicationController

  before_filter :build_array

  def build_array
    @array = MyArrayBuilder.new(some, param).get_array
  end
end 
```

然后你将`@array`变量传递给你的助手。

我不确定是否有一种“Rails 方式”来做你想做的事：Rails 作为很多惯例，但是当你开始非常关心设计和 DRY 时，我相信最好从 Oriented 的良好实践方面考虑对象编程比 Rails 约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:03:27.187

你可能需要一个好的主持人。[在ruby​​ 工具箱](https://www.ruby-toolbox.com/categories/rails_presenters)中寻找它。

演示者是控制器和视图之间的中间地带。它可以访问数据，并处理与表示相关的复杂逻辑，而不是数据操作。它可以做很多干净简单的事情。看看吧，也许它对你的问题有好处。

[布草教程](http://railscasts.com/episodes/286-draper)。

# java - 使用monit监控java程序

> ID：13316553
> 
> 赞同：4
> 
> 时间：2012-11-09T21:51:15.947
> 
> 标签：java, monit

我写信是为了获得一些关于通过 Monit 启动我的 java 程序的帮助。我写了一个启动脚本program.sh。monit 代码和 scipt 代码随此帖子提供。

问题是我无法使用通过 monit 执行的脚本文件来启动和停止程序。如果我使用终端启动它，我可以监控该过程，但我无法使用 monit 启动/停止它。monit 的日志显示“启动失败”

但是，我可以从 monit 轻松启动和停止 ssh 之类的程序。监视器在 sudo 下运行，我正在从具有管理权限的帐户运行脚本。如果有人帮助我解决这个问题，那将非常有帮助谢谢

监控文件

```
#++++++++++#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#Monit settings
set daemon 10 with start delay 2            # check services at 2-minute intervals
set logfile syslog facility log_daemon                      
set logfile /var/log/monit.log
set idfile /var/lib/monit/id
set statefile /var/lib/monit/state
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Mail Server
set mailserver smtp.gmail.com port 587
    username "monit.abc123@gmail.com" password "password"
    using tlsv1 with timeout 30 seconds

set eventqueue
      basedir /var/lib/monit/events # set the base directory where events will be stored
      slots 100                     # optionally limit the queue size

set alert abc123@gmail.com                       # receive all alerts
set alert abc123@gmail.com only on { timeout }   # receive just service-
#                                                # timeout alert
#set alert foo@bar { nonexist, timeout, resource, icmp, connection }
#set alert security@bar on { checksum, permission, uid, gid }
# setup the email for the SMS thing over here.......................
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
set httpd port 2813 and
#     use address localhost  # only accept connection from localhost
     allow localhost        # allow localhost to connect to the server and
     allow 0.0.0.0/0.0.0.0
     allow admin:monit      # require user 'admin' with password 'monit'
#    allow @monit           # allow users of group 'monit' to connect (rw)
#    allow @users readonly  # allow users of group 'users' to connect readonly
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
set mail-format {
    from: monit@$HOST
    subject: Monit Alert --  $EVENT $SERVICE
    message: $EVENT Service $SERVICE
                 Date:        $DATE
                 Action:      $ACTION
                 Host:        $HOST
                 Description: $DESCRIPTION

            Your faithful employee,
            Monit
}
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#***********************************************************************************************
#Computer Resources check
check system myhost.mydomain.tld
    if loadavg (1min) > 4 for 5 cycles then alert
    if loadavg (5min) > 2 for 5 cycles then alert
    if memory usage > 75% for 3 cycles then alert
    if swap usage > 25% for 5 cycles then alert
    if cpu usage (user) > 70% for 5 cycles then alert
    if cpu usage (system) > 70% for 5 cycles then alert
    if cpu usage (wait) > 20% for 5 cycles then alert
#***********************************************************************************************

################################################################################################
#Monitoring SSH Service

check process ssh123 with pidfile /var/run/sshd.pid
start program = "/etc/init.d/ssh start"
stop program = "/etc/init.d/ssh stop"
if cpu > 50% for 5 cycles then alert
if totalmem > 200 MB for 5 cycles then alert
if children > 2 then alert
#if loadavg(5min) greater than 10 for 8 cycles then stop
#if 5 restarts within 5 cycles then timeout

################################################################################################
#Monitoring Prorgam in Java

check process javaprg with pidfile /home/user/Desktop/Binaries/javaprg.pid
start program = "/home/user/Desktop/Binaries/javaprg.sh start"
stop program = "/home/user/Desktop/Binaries/javaprg.sh stop"  
if cpu > 50% for 5 cycles then alert
if totalmem > 1500 MB for 5 cycles then alert
if children > 2 then alert
#if loadavg(5min) greater than 10 for 8 cycles then stop
#if 5 restarts within 5 cycles then timeout 
```

启动/停止脚本

```
#!/bin/bash
 case $1 in
    start)
       echo $$ > javaprg.pid;
       exec /usr/bin/java -jar javaprg.jar
       ;;
     stop) 
       kill $(cat javaprg.pid);
       rm javaprg.pid
       ;;
     *) 
       echo "usage: javaprg {start|stop}" ;;
 esac
 exit 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:39:13.467

您应该在启动停止脚本中设置绝对路径。

您可以尝试使用 root shell 启动它`sudo -s`。

您应该考虑使用该`/etc/monit/conf.d`文件夹来放置您的 conf 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T15:31:26.697

当我尝试在 Monit 下配置 shell 脚本时，我遇到了同样的问题。解决问题的方法是在程序本身之前使用 /bin/sh 。

尝试使用：

`start program = "/home/user/Desktop/Binaries/javaprg.sh start"`

`stop program = "/home/user/Desktop/Binaries/javaprg.sh stop"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-08T19:24:57.807

我在使用你的脚本时遇到了同样的问题，这是因为启动脚本没有指定保存 PID 的位置。它将 javaprg.pid 保存到 / 而不是主文件夹。将启动脚本更改为`'echo $$ > /home/usr/binaries/javaprg.pid'`，它将起作用。

# android - push-link.com 如何执行其更新 NINJA（静默更新）和 Status_Bar（从通知栏更新）？

> ID：13316556
> 
> 赞同：0
> 
> 时间：2012-11-09T21:51:29.997
> 
> 标签：android

我正在调查[推送链接](http://www.push-link.com/index.html)升级使这些类型的应用程序，我找不到信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T00:20:35.010

有一个开源替代[AutoUpdateAPK](http://code.google.com/p/auto-update-apk-client/)，请随意下载源代码并查看它是如何工作的。

# c# - 异常：找不到程序集 Mynamespace，Version=0.0.0.0，Culture=neutral，PublicKeyToken=null

> ID：13316557
> 
> 赞同：2
> 
> 时间：2012-11-09T21:51:31.353
> 
> 标签：c#, .net-assembly, binary-deserialization

我尝试通过@TCP将图像对象作为序列化文件从客户端发送到服务器并得到这个异常

![图像异常](../Images/21aa0f10fa547fb0e1516183f761500d.png)

服务器代码

```
 namespace Receiver
  {
 [Serializable()]
   public class ImageSerial : ISerializable
   {
    public Image img = null;

    public ImageSerial(SerializationInfo info, StreamingContext ctxt)
    {
        img = (Image)info.GetValue("OMG", typeof(Image));
    }
    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("OMG", img);
    }
}

public class ObjSerial
{
    private Stream stream;
    private BinaryFormatter bformatter;
    private string FILENAME = "m.bin";
    ImageSerial mp = new ImageSerial();

    public Image getImgFromBin()
    {

        stream = File.Open(FILENAME, FileMode.Open);
        bformatter = new BinaryFormatter();

        mp = (ImageSerial)bformatter.Deserialize(stream);
        stream.Close();
        return mp.img;
    } 
```

客户端代码

```
 namespace WindowsFormsApplication5
    {
   [Serializable()]
     class ImageSerial :ISerializable
    {
    public Image img = null;
    public ImageSerial() { }

    public ImageSerial(SerializationInfo info, StreamingContext ctxt)
      { 
           img = (Image)info.GetValue("OMG", typeof(Image));
      }
    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
       info.AddValue("OMG",img);
    }
}

public class ObjSerial
{
   private string FILENAME = "m.bin";
   private TcpClient tcpClient;
   private FileStream fstFile;
   private NetworkStream strRemote;
   private string SERVERIP = "10.102.239.207";
   private int SERVERPort = 5051;

    public  void start(Image ims)
    {

        ImageSerial mp = new ImageSerial();
        mp.img = ims;

        Stream stream = File.Open(FILENAME, FileMode.Create);
        BinaryFormatter bformatter = new BinaryFormatter(); 

        bformatter.Serialize(stream, mp);
        stream.Close();

        //Clear mp for further usage.
        sendFile();

       }
       private void ConnectToServer(string ServerIP, int ServerPort)
       {  
        tcpClient = new TcpClient();
        try
        { 
            tcpClient.Connect(ServerIP, ServerPort);
        }
        catch (Exception exMessage)
        {
            // Display any possible error
        }
    }

    private void sendFile()
    {

        ConnectToServer(SERVERIP, SERVERPort);
        if (tcpClient.Connected == false)
        { 
            ConnectToServer(SERVERIP, SERVERPort);
        } 
        strRemote = tcpClient.GetStream();
        fstFile = new FileStream(FILENAME, FileMode.Open, FileAccess.Read);

        int bytesSize = 0; 
        byte[] downBuffer = new byte[2048];

        while ((bytesSize = fstFile.Read(downBuffer, 0, downBuffer.Length)) > 0)
        {
             strRemote.Write(downBuffer, 0, bytesSize);
        }
        tcpClient.Close();
        strRemote.Close();
        fstFile.Close();

    }
    } 
```

我已经阅读了很多关于这个例外的话题，他们都谈到了两个解决方案

*   格式化程序.Binder
*   AppDomain.CurrentDomain.AssemblyResolve

但还是不行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T21:56:24.167

当然，服务器端不会找到客户端程序集。它不应该。您的客户端代码不得存在于服务器端。这里的问题是您定义了您的`ImageSerial`类两次，一次在服务器中，一次在客户端中。如果你控制双方，那是完全错误的。创建一个客户端和服务器都引用的公共程序集，并将您的公共类放在那里。

此外，删除从服务器到客户端的所有引用。如果您愿意，它应该是另一种绑定方式，或者使用 WCF 等中间服务层。

# c# - 即使使用 autopostback=true 也不会触发 OnSelectedIndexChange

> ID：13316565
> 
> 赞同：2
> 
> 时间：2012-11-09T21:51:48.520
> 
> 标签：c#, jquery, asp.net, postback

好的，我在这里有点难过。我在页面上有一个 asp:Dropdownlist。它通过这样的 Web 服务调用填充：

```
Ajax.GetSubDevelopments(developmentId, function (results) {
    var subDevelopments = $j("#<%=ddlMinorAssociation.ClientID %>");
    subDevelopments.empty();
    $j('<option />', { value: "-1", text: "Select a sub association" }).appendTo(subDevelopments);
        $j.each(results, function (index, value) {
            $j('<option />', { value: value.SubDevelopmentID, text: value.Name }).appendTo(subDevelopments);
        });
        subDevelopments.show();
    }); 
```

实际的控件本身如下所示：

```
<asp:DropDownList ID="ddlMinorAssociation" 
   OnSelectedIndexChanged="ddlMinorAssociation_SelectedIndexChanged" 
   AutoPostBack="true" runat="server" CssClass="hidden">
</asp:DropDownList> 
```

目的是当用户选择一个子开发时，它将回发然后绑定一个结果数据列表。现在页面正在回发，Page.Request.Params.Get("__EVENTTARGET") 甚至说由于下拉列表它正在回发。但是，我的 ddlMinorAssociation_SelectedIndexChanged 函数中的任何代码都没有运行。这是该代码：

```
protected void ddlMinorAssociation_SelectedIndexChanged(object sender, EventArgs e)
{
    Response.Write("hi");
} 
```

谁能提供一些关于发生了什么的见解？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:07:10.223

服务器端，您的下拉列表没有任何项目。它不能触发 OnSelectedIndexChanged 事件，因为它的索引没有改变 - 它没有任何项目可以给它一个有意义的当前索引值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:10:16.413

我认为这个问题与页面加载时下拉列表中没有元素并且 ViewState 没有任何选定项的信息有关；因此，当它回发时，它确定没有任何 IndexChanged 事件要触发。

它回发的事实只是因为 Autoposback 属性设置为 true，这基本上会触发正常的表单提交。

如果您希望它起作用，请将 AutoPostback 属性更改为 false 并将代码挂钩到 onchange 事件，然后将另一个 Ajax 请求触发到您需要在服务器端执行的任何方法并在客户端绑定数据。

# delphi - 使用 Chromium Embedded 以编程方式登录

> ID：13316575
> 
> 赞同：1
> 
> 时间：2012-11-09T21:52:28.220
> 
> 标签：delphi, chromium-embedded

如何以编程方式登录到嵌入 Chromium 的网站？
例如，具有登录表单的网站，如 facebook、gmail、yahoo 等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T05:47:58.907

用于`TChromium.MainFrame.ExecuteJavaScript()`执行一些 JavaScript 以使用您拥有的登录信息填写表单，然后提交表单。

# javascript - 使用 function.apply(this, arguments) 时，参数的顺序变得混合

> ID：13316587
> 
> 赞同：0
> 
> 时间：2012-11-09T21:52:59.673
> 
> 标签：javascript

所以我试图以某种方式“继承”参数，我遇到了使用

`function.apply(this, arguments)`

它完成了这项工作......在大多数情况下都很好。我得到的是，当我从父对象调用函数时，父函数的参数位于其他函数的前面，而当我从继承者调用函数时，它们不会。

这是我的代码：

```
function Human(name, gender, tel, address){
    this.name = name;
    this.gender = gender;
    this.address = address;
    this.tel = tel;
}

Human.prototype.introduce = function(){
    console.log("Hi I'm " + this.name + " a " + this.gender + " from " + this.address + 
    ". My number is " + this.tel);
}

    Student.prototype = new Human; 
    Student.prototype.constructor = Student;

function Student(school,marks){
    Human.apply(this, arguments);
    this.school = school;
    this.marks = marks;

}

Student.prototype.average = function(){
    this.total = 0;
    this.average = 0;
    this.markslength = this.marks.length;
    for(var i = 0; i<this.markslength; i++){
        this.total = this.total + this.marks[i]
    }
    this.average = (this.total)/(this.markslength);

    var marks3 = [6,6,2]
    var Nasko = new Student('Nasko', 'Male', 14421687, 'Sofia', 'FELS', marks3); 
```

当我这样做时：`console.log(Nasko.name);`没关系。但是当我这样做时，`console.log(Nasko.average());`它给了我 NaN。所以我的问题是 - 如何真正“修复”它

抱歉，如果我问了一个已经问过的问题，但我真的想不出如何简短地问它，欢迎重定向到另一个类似的帖子。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T21:56:16.320

您将前两个参数用于学校和实际名称和性别的标记。

您可以使用参数来读取最后一个值

```
function Student(){
    Human.apply(this, arguments);
     var len = arguments.length;
    this.school = arguments[arguments.length-2]; // second last argument is school
    this.marks =  arguments[arguments.length-1]; // last argument is mark.

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:00:11.853

`"school"`构造函数中名为and`"marks"`的两个参数的值`"Student"`将是“Nasko”和“Male”，在`"Human"`类中，您将“Nasko”作为传递`"name"`，“Male”作为传递`"gender"`。我认为你对 apply 和传递参数有点困惑。当然，初始化后的代码标记是一个字符串值“男性”，你不能得到平均结果。

希望能帮助到你。

干杯

# javascript - 如何在我的网页之外创建一个链接，目的是在锚点中打开我的网页，然后加载 iframe？

> ID：13316588
> 
> 赞同：2
> 
> 时间：2012-11-09T21:53:03.243
> 
> 标签：javascript, html

我尝试使用此代码，但没有奏效。

`<a href="http://altodesign.pt/#portfolio" onClick="loadintoIframe('myframe,'portfolio/mmteam.html');">`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:16:44.717

我**永远不会使用javascript** ...

我查看了您的网页（有很多要学习的内容，例如在页面末尾添加脚本，创建一个全局 javascript 对象来保存所有网站操作等......但这不是问题）

我可以看到，即使你跳到`#CONTACTOS`你根本没有使用哈希......你应该！

使用哈希可以让您执行以下操作：

```
http://altodesign.pt/#portfolio-cooptaxis 
```

这将跳转到`portfolio`锚点并将其加载`cooptaxis.html`到 iframe 中并且您`javascript:loadintoIframe('myframe', 'portfolio/mmteam.html')`完全停止使用，因为这将导致谷歌分析和爬虫不跟进您的链接，例如...

您的方法可能很简单，例如

```
$(function() {

    // let's see if we have an hash on the page
    var hash = document.location.hash;

    if(hash.length > 0) {
        if(hash.instr('-') >= 0) {
           // supposing will have only one char '-'
           var img = hash.split('-')[1]; 

           // let's remove the frame info from the hash
           hash = hash.split('-')[0]; 

           // there's a call to load into the iframe, let's load it
           $("#myframe").attr("src", "portfolio/" + img + ".html")
        }

        // let's fly
        jumpTo(hash);
    }

    // let's disable the anchor links by default and use the hash
    $("a[href^=#]").click(function() {
        // for all links that start with the hash, let's...
        document.location.hash = $(this).attr("href");
        return false;
    });

    $(window).bind('hashchange', function() {
        // everytime the hash changes let's fly
        jumpTo(document.location.hash);
    });
});

function jumpTo(anchor) {
    var a = $("a[name='" + anchor.replace('#','') + "']"),
        pos = 0;
    if(a.length > 0) {
        // we have found the anchor, let's grab it's top position
        pos = a.position().top;
    }

    // if we got here and pos === 0, we did not found the anchor
    // for the given hash... maybe the user is playing around ...

    // and we shall fly
    $('body,html').animate({
        scrollTop: pos
    }, 800);
} 
```

justthis 将允许您避免使用 javascript 来跳转链接，因为它们现在所拥有的一切都很简单：`<a href="#PORTFOLIO">Portfolio</a>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:30:31.943

假设您有 page1.html，其中有一个指向 page2.html 的链接，您希望它在 page1.html 的 iframe 中打开

```
in page1.html
<a href="page2.html" target="iframe-name">link</a>
<iframe name="iframe-name"></iframe> 
```

然后你可以添加任何你想要的锚。只需命名您的 iframe，然后在链接中定位它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T21:55:33.347

你可以试试这样的

a href="javavcipt:document.getElementById('myframe').src = 'portfolio/mmteam.html';"

# java - 以编程方式更改列表视图行中对象的顺序

> ID：13316605
> 
> 赞同：0
> 
> 时间：2012-11-09T21:54:46.923
> 
> 标签：java, android

目前我有：

```
 <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="15:22:33 \nApr 13 1999"
                        android:textColor="#FFFFFFFF" 

        android:textAppearance="?android:attr/textAppearanceSmall" />

    <TextView
        android:id="@+id/comment"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_margin="5dip"
        android:background="@drawable/incoming_message_buble"
        android:paddingLeft="10dip"
        android:text="Hello bubbles!"
        android:textColor="@android:color/primary_text_light" /> 
```

它工作正常。

这是适配器代码：

```
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    if (row == null) {
        LayoutInflater inflater = (LayoutInflater) this.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        row = inflater.inflate(R.layout.activity_sms_row_layout, parent, false);
    }

    wrapper = (LinearLayout) row.findViewById(R.id.wrapper);

    OneComment coment = getItem(position);

    countryName = (TextView) row.findViewById(R.id.comment);

    countryName.setText(coment.comment);

    countryName.setBackgroundResource(coment.left ? R.drawable.incoming_message_buble : R.drawable.outgoing_message_buble);
    wrapper.setGravity(coment.left ? Gravity.LEFT : Gravity.RIGHT);

    return row;
} 
```

我必须更改顺序，对于左重力，我需要首先显示 textview 注释，然后为重力右显示 textView1，保持 xml 设置。

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:06:29.983

我建议使用多个布局，而不是不断地重新组织每一行的布局。覆盖这两个方法：

```
@Override
public int getItemViewType(int position) {
    return getItem(position).left ? 0 : 1;
}

@Override
public int getViewTypeCount() {
    return 2;
} 
```

并修改您的`getView()`：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if(getItemViewType == 0) {
        // Use the left layout
    } else {
        // Use the right layout
    }
} 
```

# java - Maven 错误信息 Artifact has no file

> ID：13316606
> 
> 赞同：12
> 
> 时间：2012-11-09T21:55:04.240
> 
> 标签：java, maven, maven-3

我在构建中收到大量这些错误消息。但是，它似乎对通过或失败构建没有影响。有谁知道这是从哪里来的？

编辑 -> 它似乎与报告插件有关。这就是我报告部分的全部内容

```
<reporting>
    <plugins>
        <plugin>
            <!-- use mvn cobertura:cobertura to generate cobertura reports -->
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
            <version>2.5.2</version>
            <configuration>
                <formats>
                    <format>html</format>
                    <format>xml</format>
                </formats>
                <check/>
            </configuration>
        </plugin>
    </plugins>
</reporting> 
```

这是我拥有的插件

```
<plugins>
    <!-- fixes bug running coverage for jdk 1.7 -->
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.12</version>
        <configuration>
            <argLine>-XX:-UseSplitVerifier</argLine>
        </configuration>
    </plugin>
    <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <inherited>true</inherited>
        <configuration>
            <source>1.7</source>
            <target>1.7</target>
            <encoding>UTF-8</encoding>
        </configuration>
    </plugin>
    <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>cobertura-maven-plugin</artifactId>
        <version>2.4</version>
        <configuration>
            <check>
                <branchRate>100</branchRate>
                <lineRate>100</lineRate>
                <haltOnFailure>true</haltOnFailure>
                <totalBranchRate>100</totalBranchRate>
                <totalLineRate>100</totalLineRate>
                <packageLineRate>100</packageLineRate>
                <packageBranchRate>100</packageBranchRate>
                <!--<regexes>-->
                <!--<regex>-->
                <!--<pattern>com.example.reallyimportant.*</pattern>-->
                <!--<branchRate>90</branchRate>-->
                <!--<lineRate>80</lineRate>-->
                <!--</regex>-->
                <!--<regex>-->
                <!--<pattern>com.example.boringcode.*</pattern>-->
                <!--<branchRate>40</branchRate>-->
                <!--<lineRate>30</lineRate>-->
                <!--</regex>-->
                <!--</regexes>-->
            </check>
        </configuration>
        <executions>
            <execution>
                <id>clean</id>
                <phase>clean</phase>
                <goals>
                    <goal>clean</goal>
                </goals>
            </execution>
            <execution>
                <id>package</id>
                <phase>package</phase>
                <goals>
                    <goal>check</goal>
                </goals>
            </execution>
        </executions>
    </plugin>

    <plugin>
        <inherited>true</inherited>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-enforcer-plugin</artifactId>
        <version>1.1.1</version>
        <executions>
            <execution>
                <id>enforce-maven-3</id>
                <goals>
                    <goal>enforce</goal>
                </goals>
                <configuration>
                    <rules>
                        <requireMavenVersion>
                            <version>3.0.4</version>
                        </requireMavenVersion>
                    </rules>
                    <fail>true</fail>
                </configuration>
            </execution>
            <execution>
                <id>enforce-logging-deps</id>
                <goals>
                    <goal>enforce</goal>
                </goals>
                <configuration>
                    <rules>
                        <bannedDependencies>
                            <excludes>
                                <exclude>commons-logging:commons-logging</exclude>
                            </excludes>
                        </bannedDependencies>
                    </rules>
                    <fail>true</fail>
                </configuration>
            </execution>
        </executions>
    </plugin>

    <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>exec-maven-plugin</artifactId>
        <version>1.1</version>
        <executions>
            <execution>
                <id>PhantomJS Unit Testing</id>
                <phase>test</phase>
                <goals>
                    <goal>exec</goal>
                </goals>
            </execution>
        </executions>
        <configuration>
            <executable>${project.basedir}/src/test/resources/phantomjs/1.7.0/phantomjs</executable>
            <workingDirectory>${project.basedir}/src/test/js</workingDirectory>
            <arguments>
                <argument>${project.basedir}/src/test/resources/phantomjs/runner.js</argument>
                <argument>qunit-require-tests.html</argument>
                <!-- surefire report output -->
                <argument>${project.build.testOutputDirectory}/qunit</argument>
            </arguments>
        </configuration>
    </plugin>

    <plugin>
        <groupId>com.github.timurstrekalov</groupId>
        <artifactId>saga-maven-plugin</artifactId>
        <version>1.3.0</version>
        <executions>
            <execution>
                <phase>verify</phase>
                <goals>
                    <goal>coverage</goal>
                </goals>
            </execution>
        </executions>
        <configuration>
            <baseDir>${project.basedir}</baseDir>
            <includes>src/test/js/qunit-require-tests.html</includes>
            <noInstrumentPatterns>
                <pattern>.+\/libs\/.+js</pattern>
                <pattern>.+\/test\/.+js</pattern>
            </noInstrumentPatterns>
            <sourcesToPreload>
                src/main/webapp/resources/js/c*/**/*.js,
                src/main/webapp/resources/js/f*/**/*.js,
                src/main/webapp/resources/js/m*/**/*.js,
                src/main/webapp/resources/js/r*/**/*.js,
                src/main/webapp/resources/js/t*/**/*.js,
                src/main/webapp/resources/js/u*/**/*.js,
                src/main/webapp/resources/js/v*/**/*.js,
                src/main/webapp/resources/js/w*/**/*.js,
                src/main/webapp/resources/js/*.js
            </sourcesToPreload>
            <outputStrategy>BOTH</outputStrategy>
            <outputDir>${project.build.directory}/saga</outputDir>
        </configuration>
    </plugin>

</plugins> 
```

然后输出

```
[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.
[INFO] configuring report plugin org.apache.maven.plugins:maven-project-info-reports-plugin:2.6
[WARNING] No project URL defined - decoration links will not be relativized!
[INFO] Rendering site with org.apache.maven.skins:maven-default-skin:jar:1.0 skin.
[INFO] Generating "About" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Project Team" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Dependency Information" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Project Plugins" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Continuous Integration" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Issue Tracking" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Source Repository" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Dependency Convergence" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Project License" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Plugin Management" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Distribution Management" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Project Summary" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Mailing Lists" report    --- maven-project-info-reports-plugin:2.6
[INFO] Generating "Dependencies" report    --- maven-project-info-reports-plugin:2.6
[ERROR] Artifact: commons-codec:commons-codec:jar:1.6 has no file.
[ERROR] Artifact: commons-io:commons-io:jar:2.4 has no file.
[ERROR] Artifact: commons-lang:commons-lang:jar:2.6 has no file.
[ERROR] Artifact: dom4j:dom4j:jar:1.6.1 has no file.
[ERROR] Artifact: javassist:javassist:jar:3.12.1.GA has no file.
[ERROR] Artifact: javax.servlet:javax.servlet-api:jar:3.0.1 has no file.
[ERROR] Artifact: javax.validation:validation-api:jar:1.0.0.GA has no file.
[ERROR] Artifact: joda-time:joda-time:jar:2.1 has no file.
[ERROR] Artifact: junit:junit-dep:jar:4.10 has no file.
[ERROR] Artifact: log4j:log4j:jar:1.2.17 has no file.
[ERROR] Artifact: org.apache.commons:commons-proxy:jar:1.0 has no file.
[ERROR] Artifact: org.apache.httpcomponents:httpclient:jar:4.2.1 has no file.
[ERROR] Artifact: org.apache.httpcomponents:httpcore:jar:4.2.2 has no file.
[ERROR] Artifact: org.aspectj:aspectjrt:jar:1.7.0 has no file.
[ERROR] Artifact: org.aspectj:aspectjweaver:jar:1.7.0 has no file.
[ERROR] Artifact: org.codehaus.jackson:jackson-core-asl:jar:1.9.9 has no file.
[ERROR] Artifact: org.codehaus.jackson:jackson-mapper-asl:jar:1.9.9 has no file.
[ERROR] Artifact: org.hamcrest:hamcrest-core:jar:1.3.RC2 has no file.
[ERROR] Artifact: org.hibernate:hibernate-core:jar:4.1.4.Final has no file.
[ERROR] Artifact: org.hibernate:hibernate-entitymanager:jar:4.1.4.Final has no file.
[ERROR] Artifact: org.hibernate:hibernate-validator:jar:4.3.0.Final has no file.
[ERROR] Artifact: org.hibernate.common:hibernate-commons-annotations:jar:4.0.1.Final has no file.
[ERROR] Artifact: org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.0.Final has no file.
[ERROR] Artifact: org.javassist:javassist:jar:3.15.0-GA has no file.
[ERROR] Artifact: org.jboss.logging:jboss-logging:jar:3.1.0.CR2 has no file.
[ERROR] Artifact: org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec:jar:1.0.0.Final has no file.
[ERROR] Artifact: org.mockito:mockito-core:jar:1.9.0 has no file.
[ERROR] Artifact: org.objenesis:objenesis:jar:1.0 has no file.
[ERROR] Artifact: org.reflections:reflections:jar:0.9.8 has no file.
[ERROR] Artifact: org.slf4j:jcl-over-slf4j:jar:1.6.1 has no file.
[ERROR] Artifact: org.slf4j:slf4j-api:jar:1.6.4 has no file.
[ERROR] Artifact: org.slf4j:slf4j-log4j12:jar:1.7.1 has no file.
[ERROR] Artifact: org.springframework:spring-aop:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-asm:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-beans:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-context:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-context-support:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-core:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-expression:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-jdbc:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-orm:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-test:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-tx:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-web:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework:spring-webmvc:jar:3.1.3.RELEASE has no file.
[ERROR] Artifact: org.springframework.data:spring-data-commons-core:jar:1.3.0.RELEASE has no file.
[ERROR] Artifact: org.springframework.data:spring-data-jpa:jar:1.1.0.RELEASE has no file.
[ERROR] Artifact: wlec:wlec-client-web-conf:jar:1.0-SNAPSHOT has no file.
[ERROR] Artifact: wlec:wlec-client-webservice:jar:1.0-SNAPSHOT has no file.
[ERROR] Artifact: wlec:wlec-data:jar:1.0-SNAPSHOT has no file.
[ERROR] Artifact: wlec:wlec-service:jar:1.0-SNAPSHOT has no file.
[ERROR] Artifact: xml-apis:xml-apis:jar:1.0.b2 has no file. 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-07-10T02:06:36.250

可能是因为插件 'Maven Project Info Reports Plugin' 的问题，我在 jira 上发现了问题：[在此处输入链接描述](https://jira.codehaus.org/browse/MPIR-251)

按照建议，尝试

```
<reporting>
    <plugins> ...
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-project-info-reports-plugin</artifactId>
            <version>2.6</version>
            <configuration>
                <dependencyDetailsEnabled>false</dependencyDetailsEnabled>
                <dependencyLocationsEnabled>false</dependencyLocationsEnabled>
            </configuration>
        </plugin>
                    ...
    </plugins>
</reporting> 
```

该插件不在您的配置中，可能已被其他插件引用。

# xaml - 具有大量行和列的 Silverlight 网格

> ID：13316609
> 
> 赞同：0
> 
> 时间：2012-11-09T21:55:20.663
> 
> 标签：xaml, grid

我想知道设计包含许多控件的 Silverlight 页面的推荐方法是什么，例如 lob 应用程序。我觉得会比较简单，特别是如果要制作很多页面的话，就是制作一个包含大量相同维度的行和列的模板页面，这样我就可以直观地将每个控件放入网格中。这样，每个控件将具有绝对坐标，以及行跨度和列跨度。

这不是最简单的设计方法吗？我认为这样的布局也更容易修改，因为如果我想将文本框从屏幕的左侧移动到右侧，我只需要更改它的 Grid.Column 属性，而无需考虑与堆栈面板的所有交互和右侧的网格，就像我在许多由许多网格和堆栈面板组织的布局中看到的那样。

拥有大量行和列的事实会降低性能吗？

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:01:12.710

如果要进行绝对定位，可以使用 Canvas 控件。

# javascript - 在 javascript 中，在 for 循环中创建一个类实例

> ID：13316614
> 
> 赞同：0
> 
> 时间：2012-11-09T21:55:40.507
> 
> 标签：javascript, oop

我有以下类，我希望为其创建一系列实例：

```
function rashnik(size, name) {
    var img = document.createElement('img');
    img.src = "pics/"+name+".jpg";
    img.height = size;
    img.width = size;
    img.id = name;
    d = 300-size;
    img.style.marginBottom = d/2;
    img.style.marginLeft = 50;
    var gal = document.getElementById("gallery");
    gal.appendChild(img);
}; 
```

现在，我创建了这个函数来创建实例：

```
function creater(names) {// the argument "names" would be a two-dimensional array 
    for (var a = 0; a < names.length; a++){
        var names[a][0] = new rashnik(names[a][1], names[a][0]); // right here is where I get the error
    }
} 
```

这就是我尝试调用它的方式：

```
var friends = [["adi","300"],["tom","200"],["sleg","100"],["dorc","50"],["dork","25"]];
creater(friends); 
```

问题是，这`var names[a][0]`部分给我带来了一个错误，我完全理解；我想创建一个名称与存储在 中的字符串相同的对象`names[a][0]`，但是，它只是不能那样工作。有没有人知道我可以做些什么来实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:03:36.613

清理干净了。我认为这是在做你想做的事：

*   在循环中创建一个新的类实例，所以它是一个对象
*   在那个物体里放*一些东西。*我以img为例。
*   使用名称作为返回对象的“键”。我通过使用在下面的代码中的警报中访问它，`resultsView['adi']`但也可以这样做`resultsView.Adi`

[http://jsfiddle.net/w7wKW/](http://jsfiddle.net/w7wKW/)

```
function rashnik(size, name)
{
var img=document.createElement('img');
img.src = "pics/"+name+".jpg";
img.height = size;
img.width = size;
img.id = name;
d = 300-size;
img.style.marginBottom = d/2;
img.style.marginLeft = 50;
var gal = document.getElementById("gallery");
gal.appendChild(img);

    this.img = img;
    return this;
};

function creater(names)
{//the argument "names" would be a two-dimensional array
    var results = { };
for(var a=0; a<names.length; a++)
{
results[names[a][0]] = new rashnik(names[a][1], names[a][0]);
}

    return results;
}

var friends = [["adi","300"],["tom","200"],["sleg","100"],["dorc","50"],["dork","25"]];
var resultsValue = creater(friends);

alert(resultsValue['adi'].img.src); 
```

# node.js - 在 Internet Explorer 中无法访问 Windows azure 模拟器 127.0.0.1:81

> ID：13316616
> 
> 赞同：0
> 
> 时间：2012-11-09T21:55:43.657
> 
> 标签：node.js, azure, socket.io

我正在使用一些示例代码[http://www.windowsazure.com/en-us/develop/nodejs/tutorials/app-using-socketio/](http://www.windowsazure.com/en-us/develop/nodejs/tutorials/app-using-socketio/)来使用 WorkerRole 创建一个基本的 socket.io 应用程序。启动模拟器后，我访问：127.0.0.1:81，但 IE 不会加载页面说它不可访问。

这是powershell的输出

```
PS Y:\Project\WorkerRole1> Start-AzureEmulator -launch
Creating local package...
Starting Emulator...
Role is running at tcp://127.0.0.1:81
Role is running at tcp://127.0.0.1:8
Started 
```

编辑：另一个注意事项，我在 OSX 10.8.2 上使用 Parallels VM 和 Windows 8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T05:58:49.743

请检查它的值，`process.env.port`看看它是 80 还是 81。这可能是因为您正在侦听 80，但本地模拟器使用 81。

# vb6 - 数据报告和分组（形状追加）

> ID：13316617
> 
> 赞同：1
> 
> 时间：2012-11-09T21:55:45.090
> 
> 标签：vb6

我对数据报告的 DataMember 和 Datafields 进行了硬编码（我没有使用 DataEnviroment，也不知道如何使用。我宁愿亲自编写代码）但是我检查代码越多，我就无法解决这东西。

我收到的错误消息是：

> 错误“8526”找不到数据字段“Omisions.Date”

在这部分代码中：

> rpt.刷新

就在我`rpt.Show`在代码末尾做 a 之前。`rpt`是我目前的数据报告。以下是相关代码：

```
 sql = "Shape {exec Usp_HoraExtra_Rut 1} As Normal " _
  & "Append ({exec Usp_HoraExtra_Rut 2} As Omisions " _
  & "Relate Nit To Nit)"
  rptrs.Open sql, db, adOpenStatic, adLockReadOnly 
```

由于查询量很大，我使用了两个存储过程。

然后我添加 DataMember：

```
.Sections("Section1").Controls.Item("t_fecha").DataMember = "Omisions" 
```

然后是数据字段：

```
.Sections("Section1").Controls.Item("t_fecha").DataField = "date" 
```

进而：

```
rpt.Refresh
rpt.Show 
```

如果有人可以帮我一把，将不胜感激。

编辑：错字，清理代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T14:21:23.910

对于任何可能阅读此内容的人...我通过从存储过程切换到视图解决了这个问题。出于某种原因，SHAPE 不适用于 sotred procs，我拒绝编写大型 SQL 查询。我刚刚在我的数据库上创建了一个视图并对其进行了查询。

此外，连接字符串需要更改。总而言之，硬核。

# app-store-connect - iTunes Connect iAd 的

> ID：13316624
> 
> 赞同：8
> 
> 时间：2012-11-09T21:56:34.560
> 
> 标签：app-store-connect, iad

我遇到了 iTunes Connect 的问题，它说 iAd 网络暂时不可用。

> 没有权限
> 
> 您没有执行此操作所需的权限。

我是开发帐户的所有者，那么其他人是否有访问它的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T10:12:51.480

退出，然后登录。

它会正常工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T13:06:30.727

对我来说有些问题，我使用 Chrome 修复它：

1.  搁笔
2.  ctrl + f5
3.  ctrl + iad 链接

为我工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T12:21:20.897

这里同样的问题。我想是因为收入太高导致系统过载，但我很确定这只是一个技术错误......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-13T14:55:40.190

如果出现问题，Apple 现在会向用户发送支持电子邮件。

# javascript - 重新创建 Facebook 评论按钮。提交一个ajax表单

> ID：13316625
> 
> 赞同：0
> 
> 时间：2012-11-09T21:56:38.663
> 
> 标签：javascript, jquery, ajax, facebook

我正在尝试重新创建 Facebook 评论按钮。目前，Facebook 评论只能通过按 Enter 提交。我已经成功地为每个文本区域添加了一个评论按钮，但现在我无法提交表单。这是我的代码：

```
$('.UFILikeLink').after(' · <span><a class="submitbtn">Submit</a></span>');

$('.submitbtn').live('click', function(){       
    $(this).parents('form:first').submit();
}); 
```

表单提交到一个打算用 AJAX 调用的页面，给我一个错误。

# python - 在 xlrd 中如何获取原始单元格值？

> ID：13316627
> 
> 赞同：2
> 
> 时间：2012-11-09T21:57:02.620
> 
> 标签：python, excel, xlrd

> **可能重复：**
> [excel文件中的整数变成浮点数？](https://stackoverflow.com/questions/8825681/integers-from-excel-files-become-floats)

我有一个包含 的 excel 电子表格，`1984`xlrd 将其作为一种`number`类型处理，因此将值返回为 float `1984.0`。我想获取电子表格中显示的原始值，作为字符串`"1984"`。我怎么得到这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:27:09.887

So internally in Excel, that 1984 is stored as a decimal number, so 1984.0 is correct. You could have changed the number formatting to show it as 1984.00, or whatever.

So are you asking how to query the cell formatting to tell that the number format is no decimals? If so you might look into using the formatting_info=True parameter of open_workbook

sheet = open_workbook( 'types.xls',formatting_info=True ).sheet_by_index(0)

Have you come across the python-excel.pdf document from [http://www.python-excel.org/](http://www.python-excel.org/) ? It is pretty good tutorial for learning to use xlrd and xlwt. Unfortunately, they say:

We've already seen that open_workbook has a parameter to load formatting information from Excel files. When this is done, all the formatting information is available, but the details of how it is presented are beyond the scope of this tutorial.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:09:37.987

如果 cell.ctype==xlrd.XL_CELL_NUMBER

然后 excel 将 1984 存储为浮点数，您需要在 python 中转换为字符串

在excel中

="1984" 将是一个字符串 '1984 将是一个字符串，注意 ' 不显示 1984 是一个 #

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T22:07:33.077

唯一的数字是浮点数。附加到单元格的格式确定它是表示日期、小数还是整数。查找格式字符串，希望它能让您辨别数字的显示方式。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-09T22:03:26.423

使用字符串格式：

```
"%d" % mynumber 
```

```
>>> "%d" % 1984.0
'1984' 
```

# java - 根据给定条件从 ArrayList 中删除对象

> ID：13316629
> 
> 赞同：15
> 
> 时间：2012-11-09T21:57:07.923
> 
> 标签：java, arraylist

`ArrayList`如果满足特定条件，我想从 Java 中删除一个元素。

IE：

```
for (Pulse p : pulseArray) {
    if (p.getCurrent() == null) {
        pulseArray.remove(p);
    }
} 
```

我可以理解为什么这不起作用，但是有什么好的方法呢？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2017-12-15T13:53:35.050

您可以使用[Collection::removeIf(Predicate filter)](https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-)（从 Java8 开始可用），这是一个简单的示例：

```
final Collection<Integer> list = new ArrayList<>(Arrays.asList(1, 2));
list.removeIf(value -> value < 2);
System.out.println(list); // outputs "[2]" 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-11-09T21:57:49.420

您必须使用 an`Iterator`进行迭代和`remove`迭代器的功能（不是列表）：

```
Iterator<Pulse> iter = pulseArray.iterator();
while (iter.hasNext()) {
  Pulse p = iter.next();
  if (p.getCurrent()==null) iter.remove();
} 
```

请注意，[Iterator#remove](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)函数据说是可选的，但它*是*由 ArrayList 的迭代器实现的。

这是 ArrayList.java 中这个具体函数的代码：

```
765         public void remove() {
766             if (lastRet < 0)
767                 throw new IllegalStateException();
768             checkForComodification();
769 
770             try {
771                 ArrayList.this.remove(lastRet);
772                 cursor = lastRet;
773                 lastRet = -1;
774                 expectedModCount = modCount;
775             } catch (IndexOutOfBoundsException ex) {
776                 throw new ConcurrentModificationException();
777             }
778         }
779 
780         final void checkForComodification() {
781             if (modCount != expectedModCount)
782                 throw new ConcurrentModificationException();
783         }
784     } 
```

这`expectedModCount = modCount;`就是为什么在迭代时使用它时它不会抛出异常的原因。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-10-10T14:32:56.777

无需使用迭代器。使用**Java 8**（流和过滤功能以及 lambdas），您可以使用一行来完成它。例如。执行您指定的操作所需的代码将是：

```
pulseArray = pulseArray.stream().filter(pulse -> pulse != null).collect(Collectors.toList()); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-09T22:02:17.950

当您从**同一个列表中****删除元素**时，索引会受到干扰。尝试如下：

 **```
 for (int i=0; i < pulseArray.size(); i++) {
     Pulse p = (Pulse)pulseArray.get(i);
     if (p.getCurrent() == null) {
        pulseArray.remove(p);
        i--;//decrease the counter by one
     }
  } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-09T23:11:14.770

作为使用迭代器的替代方法，您可以使用[Guava](http://code.google.com/p/guava-libraries/)集合库。这具有更[实用](http://en.wikipedia.org/wiki/Functional_programming)的优点（如果你喜欢那种东西）：

```
Predicate<Pulse> hasCurrent = new Predicate<Pulse>() {
  @Override public boolean apply(Pulse input) {
    return (input.getCurrent() != null);
  }
};

pulseArray = Lists.newArrayList(Collections2.filter(pulseArray, hasCurrent)); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-21T12:30:19.537

您可以实现接口 Predicate 覆盖抽象方法*boolean test(T);*

使用*removeIf(Predicate p)*方法从列表中删除所有匹配的元素。

例如：

```
List<Book> bookList = new ArrayList<>();
bookList.add(new Book(101, "bookname1"));
bookList.add(new Book(102, "booknamelong2"));
bookList.removeIf(new LongBookNames())

public class LongBookNames implements Predicate<Book> {

  @Override
  public boolean test(Book book) {
    return book.getBookName.length() >10;
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-09T21:59:41.547

您不能使用集合上的方法更改正在迭代的集合。但是，一些迭代器（包括`ArrayList`s 上的迭代器）支持一种`remove()`方法，该方法允许您按照迭代的顺序删除方法。

```
Iterator<Pulse> iterator = pulseArray.iterator();
while (iterator.hasNext()) {
  Pulse p = iterator.next();
  if (p.getCurrent() == null) {
    iterator.remove();
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-28T11:05:28.417

当 Single ArrayList 有多种类型 Objects 并且一个对象的 count == 0 时使用下面的一个，然后它从*pulseArray中删除*

> **常量.java**

```
public class ViewType {
    public static final int PULSE = 101;
    public static final int HEARTBEAT = 102;
} 
```

> **BaseModel.java**（这是基本模型）

```
public interface BaseModel {
    int getViewType();
} 
```

> **PulseModel.java**（使用 BaseModel 实现）

```
public class PulseModel implements BaseModel {

    @Override
    public int getViewType() {
        return Constants.ViewType.PULSE;
    }

    @SerializedName("PulseId")
    @Expose
    private String pulseId;
    @SerializedName("Count")
    @Expose
    private String count;
} 
```

> **从Count = 0的*pulseArray*中删除 PulseModel 对象**

```
pulseArray.removeIf(
     (BaseModel model) -> {
         boolean remove = false;
         if (model instanceof PulseModel) {
              remove = (((PulseModel) model).getCount() == 0);
              if (remove) {
                 //Success
              }
         }
         return remove;
      }); 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2012-11-09T22:39:55.123

使用 Iterator 可以让您在遍历 arraylist 时修改列表**

# android - 将文件发送到另一个应用程序

> ID：13316630
> 
> 赞同：2
> 
> 时间：2012-11-09T21:57:10.513
> 
> 标签：android, android-intent

我正在尝试将一个文件从我的应用程序发送到另一个文件。我不想使用“应用程序选择器”，我只想“强制”该应用程序打开我想要的文件。

我试过了：

```
Uri data = Uri.fromFile( file );
PackageManager pm = getApplicationContext().getPackageManager();
Intent ic = pm.getLaunchIntentForPackage("org.ais.archidroid");
ic.setAction(Intent.ACTION_SEND);
ic.setData(data);
ic.putExtra(Intent.EXTRA_STREAM, data);
startActivity(ic); 
```

但这只会打开没有该文件的其他应用程序。我尝试了几种组合并用谷歌搜索并没有找到任何东西。也许它不受支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:44:52.233

我建议尝试 ACTION_VIEW 而不是 ACTION_SEND。像这样的东西：

```
Uri data = Uri.fromFile( file );
PackageManager pm = getApplicationContext().getPackageManager();
Intent ic = pm.getLaunchIntentForPackage("org.ais.archidroid");
ic.setAction(Intent.ACTION_VIEW);
ic.setData(data);
startActivity(ic); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:51:24.807

尝试设置您寻找的应用程序的启动器活动：

```
Intent intent= new Intent("org.ais.archidroid.launcheractivity");
intent.setClassName("org.ais.archidroid", "launcheractivity");
intent.setData(Uri.parse(yourdata));
startActivity(intent); 
```

但是请确保您输入了它的 packageName 和 className 正确...希望这会有所帮助。

# android - 最新的 IntelliJ IDEA 12 Preview 构建了 ActionBarSherlock 的中断渲染

> ID：13316631
> 
> 赞同：2
> 
> 时间：2012-11-09T21:57:11.637
> 
> 标签：android, intellij-idea, actionbarsherlock

**编辑：**我一发布这个，我就收到了一个关于修复问题的新预览版本的通知！看起来原始的源错误是：

[http://youtrack.jetbrains.com/issue/IDEA-94147](http://youtrack.jetbrains.com/issue/IDEA-94147)

从 122.745 开始，它是固定的！

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ~~~~~~~~

从 Intellij IDEA Preview build 122.694（即将发布的 v12 版本）开始，构建 ActionBarSherlock 似乎会产生损坏的渲染。

我正在跟进 IntelliJ 和 ABS 人员，但我想在此处发布此内容以进行更广泛的曝光，以防万一有人遇到此问题。

如果您使用以前版本的 IntelliJ 构建 ABS，效果会很好。但是在（最近发布的）122.694 预览版中，操作栏无法在比 v4.0 更早的 Android 版本上正确呈现。您会得到损坏的渲染，如随附的屏幕截图。

![在此处输入图像描述](../Images/d5d1a35326d02ed925c8c324d998398e.png)

ActionBarSherlock 的作者表示，他实际上（很少）在 IntelliJ 的过去版本中看到过这种情况。但在我的实验中，从 122.694 开始，它现在是 100% 的复制品。所以我想知道某处是否存在一些模糊的构建时竞争条件，现在正在加剧。

以下是相关组的线程：

[https://groups.google.com/forum/?fromgroups=#!topic/actionbarsherlock/sKn3GowjGkg](https://groups.google.com/forum/?fromgroups=#!topic/actionbarsherlock/sKn3GowjGkg)

[http://youtrack.jetbrains.com/issue/IDEA-94417](http://youtrack.jetbrains.com/issue/IDEA-94417)

ABS 作者建议的一种解决方法是在外部构建库（通过 Maven 等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T18:52:40.347

IntelliJ 的优秀人员已将其修复为 122.745！

# spring - Jmeter 在 Amazon 实例中被杀死而没有任何错误通知

> ID：13316639
> 
> 赞同：0
> 
> 时间：2012-11-09T21:58:06.583
> 
> 标签：spring, jmeter, load-testing

我正在为我的应用程序运行 Jmeter 负载测试。我可以成功地为 500 名用户运行测试以登录搜索注销，并增加 150。我无法为任何更多的用户运行测试（800 名用户使用 240 名用户或 1000 名用户使用 300）我也尝试增加加速时间。我没有看到任何系统错误，也没有看到任何连接池错误。即使是 Jmeter 日志看起来也很正常。但是，在达到多个用户后，我的测试被终止（对于 800 个用户，测试终止于 800 ）。关于我可以检查什么的任何建议？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T17:43:25.927

正如 CodeChimp 所提到的并且您已经尝试过，首先要检查的是堆大小。并且还与较少数量的用户进行验证。

您也可以尝试启动两个 jmeter 实例（可能具有不同的用户 ID 范围？）而不是一个。

如果问题仍然存在，可能有两种可能： 1\. 无法从客户端发送这么多请求。2\. 服务器（正在测试）无法处理那么多请求。

要验证问题是否与客户端有关：

1.  检查亚马逊实例上的 ulimit 值。“ulimit -a”。具体来说，检查 nproc 值 (ulimit -n) 是否高于您尝试从亚马逊实例连接的最大线程数（用户）。
2.  检查客户端是否增加了所需的用户数：（在 jmeter 的情况下，线程数与用户数相同。） ps uH p | wc -l （这应该等于您在脚本中给出的用户数）
3.  jmeter 脚本本身可能会在其他用户启动时注销用户。最好通过在循环中运行线程组来验证。（可能永远循环？）。
4.  确保您的脚本配置为在发生错误后“继续”。我认为这可以在线程组级别进行配置。

# python - 随机生成一个与给定正则表达式不匹配的字符串

> ID：13316644
> 
> 赞同：7
> 
> 时间：2012-11-09T21:58:40.077
> 
> 标签：python, regex

为了对我正在处理的项目进行测试，如果给定正则表达式，我需要随机生成一个无法**与之**匹配的字符串。例如，如果给我这个正则表达式：

```
^[abcd]d+ 
```

然后我应该能够生成字符串，例如：

```
hnbbad
uduebbaef
9f8;djfew
skjcc98332f 
```

...每个都不匹配正则表达式，但不生成：

```
addr32
bdfd09usdj
cdddddd-9fdssee 
```

...每个都可以。换句话说，我想要一个像反 Xeger 这样的东西。

是否存在这样的库，最好是在 Python 中（如果我能理解理论，如果需要，我很可能将其转换为 Python）？我考虑了如何编写这个，但考虑到正则表达式的范围，这似乎比 Xeger 可以解决的问题要困难得多。我还四处寻找一个预制库来执行此操作，但要么我没有使用正确的关键字进行搜索，要么以前没有人遇到过这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T22:04:13.753

我最初的直觉是，不，这样的图书馆不存在，因为它是不可能的。您不能确定是否可以在合理的时间内为任意正则表达式找到有效输入。

例如，证明一个数是否是素数被认为是一个难以解决的数学问题。以下正则表达式匹配任何长度至少为 10000 个字符且总长度为质数的字符串：

```
(?!(..+)\1+$).{10000} 
```

我怀疑是否存在任何可以在合理时间内找到此正则表达式的有效输入的库。这是一个非常简单的示例，具有简单的解决方案，例如`'x' * 10007`会起作用。可能会想出其他更难找到有效输入的正则表达式。

我认为你要解决这个问题的唯一方法是将自己限制在所有可能的正则表达式的某个子集。

* * *

但是话虽如此，*如果*您有一个神奇的库来生成与任意正则表达式匹配的文本，*那么*您需要做的就是生成一个正则表达式来匹配所有与原始表达式*不匹配的字符串。*

幸运的是，这可以使用负前瞻：

```
^(?![\s\S]*(?:^[abcd]d+)) 
```

* * *

如果您愿意将要求更改为仅允许有限的正则表达式子集，那么您可以使用布尔逻辑来否定正则表达式。例如，如果`^[abcd]d+`变成`^[^abcd]|^[abcd][^d]`. 然后可以在合理的时间内为这个正则表达式找到一个有效的输入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T22:06:47.573

我会做一个循环，生成随机长度的随机组合，并测试是否匹配正则表达式。重复循环，直到达到不匹配的情况。

显然，这将是低效的。你确定你不能反转正则表达式并在反转的正则表达式上生成匹配吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-10T06:28:31.033

不，这是不可能的。有无数个正则表达式可以匹配已知宇宙中的每个字符串。例如：

`/^/`
`/.*/`
`/[^"\\]*(\\.[^"\\]*)*$/`

等等

这是因为所有这些正则表达式都不能匹配*任何内容*（这是所有字符串都有的！）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T14:27:13.920

我们可以通过限制从给定字符集生成字符串来减少无限的可能性吗？

比如我可以定义字符集，`[QWERTYUIOP!@#$%^%^&*))_]`我随机生成的所有字符串都应该是从这个集合中诞生的。这样我们可以减少这个问题的无限性吗？

事实上，即使我也在寻找这样的实用程序，最好是在 Python 中。

# java - Java 银行利息/储蓄计算器

> ID：13316652
> 
> 赞同：1
> 
> 时间：2012-11-09T21:59:24.367
> 
> 标签：java, calculator

我对 Java 很陌生，正在尝试创建一个银行储蓄和利息计算器。我已经创建了基本的计算器，但是在向这个计算器添加了一些新功能后，我似乎把它搞砸了，它不再执行以前的任何任务。

我想用这个计算器完成一些事情： 1\. 选择您的帐户类型（储蓄、CD 或支票）并传递给我的扩展 JFrame 的帐户对象。

1.  提示用户原始余额、利率和期限长度。将这些值传递给 Account 对象（这是我无法弄清楚的部分）。

2.  单击计算按钮后打印最终余额。

3.  询问用户“想开设新帐户吗？是/否”如果是，则循环返回。如果没有，退出。

我缺乏一些基本的 Java 知识，这就是我现在陷入困境的原因。任何帮助表示赞赏！

账户.java

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Account extends JFrame {

private int period;
private int balance;
private int rate;
private String printstring;

@Override
public String toString() {
    return String.format("Period: " + period + ", Balance: " + balance);
}

public int getPeriod() {
    return period;
}

public void setPeriod(int period) {
    this.period = period;
}

public int getBalance() {
    return balance;
}

public void setBalance(int balance) {
    this.balance = balance;
}

public int getRate() {
    return rate;
}

public void setRate(int rate) {
    this.rate = rate;
}

public String getPrintstring() {
    return printstring;
}

public void setPrintString(String printstring) {
    this.printstring = printstring;
}

public void calculate() {
    for ( int i = 0; i<period; i++)
{
    balance = (balance * rate) + balance;

}
}
} 
```

银行家.java

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Banker {

// Array for type of bank account

private static void createAndShowGUI() {

    // Declare strings for period, balance, rate
    String period;
    String balance;
    String rate;

    // Prompt user for input
    period = JOptionPane.showInputDialog(null, "Number of periods (length):");
    balance = JOptionPane.showInputDialog(null, "Beginning balance:");
    rate = JOptionPane.showInputDialog(null, "Interest rate (use decimal, example: .05     = 5%):");

    // Make Calculate button
    JButton calculate = new JButton("Calculate");

    // Make 3 Labels
    JLabel blabel = new JLabel("Period: " + period);
    JLabel plabel = new JLabel("Balance: " + balance);
    JLabel flabel = new JLabel("Final Balance: " + balance);

    // Setup window with flow layout and exit on close
    JFrame frame = new JFrame("Interest Savings Calculator Plus");
    frame.setLayout(new FlowLayout());
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    // Add combo box, calc button and labels
    frame.add(calculate);
    frame.add(plabel);
    frame.add(blabel);
    frame.add(flabel);
    frame.pack();
    frame.setVisible(true);

    //Display the window.
    frame.pack();
    frame.setVisible(true);
}

public static void main(String[] args) {

String[] accttype = { "Checking", "Savings", "CD" }; // Array of bank acct types
String input = (String) JOptionPane.showInputDialog(null, "Choose account...",
    "Choose bank account type", JOptionPane.QUESTION_MESSAGE, null,
    accttype, // Array of acct types
    accttype[0]); // First choice
System.out.println(input);

    //Schedule a job for the event-dispatching thread:
    //creating and showing this application's GUI.
            createAndShowGUI();
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T09:54:25.287

我只是给你一个一般性的建议......

您正在使用 Money，请不要使用`float`和/或`double`作为数据类型。

在`float`和`double`类型中，不可能将 0.1（或任何其他十的负幂）表示为 a`float`或`double`精确。

例如，假设您有 1.03 欧元，您花了 0.42 欧元，您还剩下多少钱？

System.out.println(1.03 - .42); 打印出 0.6100000000000001。

解决这个问题的正确方法是使用[BigDecimal](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html)作为数据类型，它具有 add、divide 等所有方法。一个陷阱`BigDecimal`是不可变的，当您进行计算时不要忘记这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:22:45.287

正如您提示帐户类型一样，您需要提示并捕获所需值的输入：

```
String input = JOptionPane.showInputDialog("Question:"); 
```

这为您提供了一个字符串，您需要将其转换为数字：

```
double value;
try {
  value = Double.parseDouble(input);
} catch (NumberFormatException e) {
  //Handle the exception
} 
```

您可以对所有需要的输入执行此操作。之后将它们传递给您的 Account 对象。

```
Account account = new Account();
account.setBalance(value); 
```

我希望你能从那里推断出你的需求！祝你好运。

# java - 如何在 Java 中使文件读取平台独立

> ID：13316653
> 
> 赞同：0
> 
> 时间：2012-11-09T21:59:28.723
> 
> 标签：java, maven, file-io, jar, file-handling

您好我正在使用 Maven 使用 Java 进行 Selenium 自动化测试。我正在使用 Excel 表读取数据以填写注册表。现在它是一个正常的 Maven 原型。

```
src
--main
  --java
    --mypackage for coding goes here.
  --resources
    --data
      -- the excel sheet
--test
  -- some stuff here under java 
```

目前，如果我想读取一个文件，我正在编写 src/main/resources/data/theexcelsheet.xlsx 但是当我分享这个 jar 时，我认为这会破坏，如果我打包这个 jar，我不希望它破坏。

如何使其平台或格式独立。

如果您正在考虑我如何阅读文件，我正在使用 APACHE POI Api。

有人阅读让我知道我可以使用 MANIFEST 文件来执行此操作，但我不确定，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:05:44.033

如果你使用 getResource() 指向你的文件，路径的语法总是`/`用来分隔组件，`\`所以你不必担心。

通常，在 jar 之外，例如，如果要将应用程序设置保存在文件夹中，则必须使用特定于操作系统的分隔符 - 您可以通过以下方式获取它：

`System.out.println("my" + File.separator + "dir");`

`my\dir`在 Win 和`my/dir`Linux 上返回

当然，这还不够，因为您不能使用像“c:”驱动器这样的硬编码路径，但是您可以获得读取 System 类属性的最常见路径，例如：

```
System.out.println(System.getProperty("user.home")); 
```

`C:\Users\piero`在 Windows7 和`/home/piero`Linux 中返回

# mongodb - 如何在 mongodb 查询结果中获取标签计数？

> ID：13316657
> 
> 赞同：3
> 
> 时间：2012-11-09T21:59:53.037
> 
> 标签：mongodb, mongodb-query

我正在尝试在 mongodb 中搜索基于标签的文章：

```
> use test;
> db.articles.save( { name: "article1", tags: ['one', 'two', 'three'] } );
> db.articles.save( { name: "article2", tags: ['two', 'three'] } );
> db.articles.save( { name: "article3", tags: ['one', 'three'] } );
> db.articles.save( { name: "article4", tags: ['one', 'two', 'four'] } );
> db.articles.save( { name: "article5", tags: ['four', 'five'] } );
> db.articles.ensureIndex( { tags: 1 } );
> db.articles.find( { $or : [ { tags: 'four' }, { tags: 'five' } ] } )

{ "_id" : ObjectId("509d7b555bff77729a26a232"), "name" : "article4", "tags" : [ "one", "two", "four" ] }
{ "_id" : ObjectId("509d7b555bff77729a26a233"), "name" : "article5", "tags" : [ "four", "five" ] } 
```

如您所见，查询查找“四”或“五”，但我希望按“最佳匹配”排序结果（匹配的两个标签优于匹配的一个标签）。

我怎样才能完成这项工作？地图缩小？

提前致谢：

夏比

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:51:00.303

真的很抱歉让你失望了，但 mongo 现在无能为力。唯一的选择是在应用程序端实现排序。我知道这可能效率太低，但没有其他选择。

我唯一能帮你的就是建议替换

```
$or : [ { tags: 'four' }, { tags: 'five' } ] 
```

到

```
tags:{$in:['four','five']} 
```

这对您的查询没有帮助（我的意思是订购结果），但如果有很多不同的标签，您在服务器上创建它会更容易。

# android - 在 Android 中，如何注册接收耳机插头广播？

> ID：13316658
> 
> 赞同：4
> 
> 时间：2012-11-09T21:59:58.033
> 
> 标签：android, android-intent, broadcastreceiver, android-manifest

我在 Android 2.1 中工作，我想检测耳机何时插入/取出。我对安卓很陌生。

我认为这样做的方法是使用广播接收器。我对此进行了细分，并将以下内容放入我的 AndroidManifest.xml 中。但是您是否必须在其他地方注册接收器，例如在活动中？我知道这方面有很多线程，但我真的不明白他们在说什么。另外，在 AndroidManifest.xml 中注册与在活动中动态注册有什么区别？

```
<receiver android:enabled="true" android:name="AudioJackReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.HEADSET_PLUG" >
            </action>
        </intent-filter>
    </receiver> 
```

这是类的实现（加上导入）

```
public class AudioJackReceiver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    Log.w("DEBUG", "headset state received");
} 
```

}

我只是想看看它是否有效，但是当我在运行应用程序时拔下/插入耳机时没有任何显示。

编辑：文档没有说这一点，但是如果在清单中注册，这个可能不起作用吗？当我在我的一个应用程序中注册接收器时，我能够让它响应（或者你必须这样做吗？）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-08-01T15:20:59.377

只是补充格雷格的答案，这里是您需要分为两部分的代码

1.  在第一个 Activity 中注册服务（这里称为`MainActivity.java`）。

2.  切换中的`ACTION_HEADSET_PLUG`动作结果`BroadCastReceiver`。

它是这样的：

```
public class MainActivity extends Activity  {
private static final String TAG = "MainActivity";
private MusicIntentReceiver myReceiver;

@Override protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    myReceiver = new MusicIntentReceiver();
}

@Override public void onResume() {
    IntentFilter filter = new IntentFilter(Intent.ACTION_HEADSET_PLUG);
    registerReceiver(myReceiver, filter);
    super.onResume();
}

private class MusicIntentReceiver extends BroadcastReceiver {
    @Override public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_HEADSET_PLUG)) {
            int state = intent.getIntExtra("state", -1);
            switch (state) {
            case 0:
                Log.d(TAG, "Headset is unplugged");
                break;
            case 1:
                Log.d(TAG, "Headset is plugged");
                break;
            default:
                Log.d(TAG, "I have no idea what the headset state is");
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T19:42:35.870

这里有两个网站可能有助于更详细地解释它：

*   [http://www.grokkingandroid.com/android-tutorial-broadcastreceiver/](http://www.grokkingandroid.com/android-tutorial-broadcastreceiver/)
*   [http://www.vogella.com/articles/AndroidBroadcastReceiver/article.html](http://www.vogella.com/articles/AndroidBroadcastReceiver/article.html)

你必须定义你的意图；否则将无法访问系统功能。广播接收器；将提醒您的应用程序您想收听的更改。

每个接收器都需要子类化；它必须包括一个`onReceive()`. 要实现它，`onReceive()`您需要创建一个包含两个项目的方法：**Context**和**Intent**。

更有可能的服务是理想的；但是您将创建一个服务并通过它定义您的上下文。在上下文中; 你会定义你的意图。

一个例子：

```
context.startService
      (new Intent(context, YourService.class)); 
```

非常基本的例子。然而; 您的特定目标是利用系统范围的广播。您希望您的应用程序收到通知`Intent.ACTION_HEADSET_PLUG`。

如何通过 manifest 订阅：

```
<receiver
    android:name="AudioJackReceiver"
    android:enabled="true"
    android:exported="true" >
    <intent-filter>
        <action android:name="android.intent.action.HEADSET_PLUG" />
    </intent-filter>
</receiver> 
```

或者您可以简单地通过您的应用程序定义；但。您的特定要求；如果您打算检测蓝牙，则需要用户权限`MODIFY_AUDIO_SETTINGS`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-11T00:34:07.503

您需要[启用广播接收器](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestReceiver)并将`exported`属性设置为`true`：

```
<receiver
    android:name="AudioJackReceiver"
    android:enabled="true"
    android:exported="true" >
    <intent-filter>
        <action android:name="android.intent.action.HEADSET_PLUG" />
    </intent-filter>
</receiver> 
```

# javascript - 整个页面的Javascript循环滚动

> ID：13316668
> 
> 赞同：1
> 
> 时间：2012-11-09T22:00:53.570
> 
> 标签：javascript, jquery, html, css

我想创建以下效果，但不知道是否可以按照我设想的方式实现。

我想要一个比屏幕大 2 或 3 倍且可滚动的 html 页面（本身没什么特别的）。但是当你到达底部时，我希望它自动无缝地回到顶部。

我想要的最终结果是，如果您按住向下箭头按钮，页面将继续循环并向下滚动。

我希望它是连续的，而不仅仅是跳回顶部并重新开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:15:37.060

您需要制作第二份内容副本并将其粘贴在原始内容之后。当第二个副本的“第一帧”到达屏幕边缘时，将定位重置为零。这样，它看起来就像一个无缝循环。

# erlang - erlang SSHA ldap

> ID：13316670
> 
> 赞同：3
> 
> 时间：2012-11-09T22:01:04.920
> 
> 标签：erlang, ldap, sha1

给定存储在 SHA-1/{SSHA} 中的 LDAP 密码，我将如何在 erlang 中验证它。

例如 - 给定以下 {SSHA}：

```
% slappasswd -s myPassword
{SSHA}GEH5kMEQZHYHS95dgr6KmFdg0a4BicBP
% 
```

我将如何（在 erlang 中）验证明文“myPassword”与“{SSHA}GEH5kMEQZHYHS95dgr6KmFdg0a4BicBP”的散列值匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T10:45:42.293

[使用BIND](https://www.rfc-editor.org/rfc/rfc4511#section-4.2)操作验证存储在目录服务器中的密码。正确配置和安全的目录服务器将不允许访问密码数据；因此，不能对 LDAP 客户端进行编码，期望密码数据可用，无论是加密的还是散列的。LDAP 客户端必须使用 BIND 操作来验证密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T14:35:46.703

在其他人的帮助下，我想出了一个在 Erlang 中执行此操作的例程。在这里跟大家分享。

首先 - 这个链接（在另一篇文章中找到）提供了其他语言的功能做我想要的：

*   [http://www.openldap.org/faq/data/cache/347.html](http://www.openldap.org/faq/data/cache/347.html)

诀窍是“ldap {SSHA}”编码是一个加盐SHA1哈希，也是base64编码的。所以 - 您必须对其进行解码，提取盐，然后在“清除密码”的重新编码中使用它进行比较。

这是一个简短的 Erlang 例程，它执行此操作：

```
validatessha(ClearPassword, SshaHash) ->
    D64 = base64:decode(lists:nthtail(6, SshaHash)),
    {HashedData, Salt} = lists:split(20, binary_to_list(D64)),
    NewHash = crypto:sha(list_to_binary(ClearPassword ++ Salt)),
    string:equal(binary_to_list(NewHash), HashedData). 
```

鉴于我原始帖子中的数据 - 这是输出：

```
67> run:validatessha("myPassword", "{SSHA}GEH5kMEQZHYHS95dgr6KmFdg0a4BicBP").
true
68> 
```

谢谢大家。

*麦克风*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T23:17:29.953

我的二郎很生锈，所以这不是很漂亮，但无论如何它可能让我的想法顺利。

```
run() ->
  Password = "myPassword",
  HashRaw = os:cmd("slappasswd -s " ++ Password),
  Hash1 = lists:nthtail(6, HashRaw),
  Hash2 = lists:concat ([integer_to_list(X, 16) || X <- binary_to_list(crypto:sha(Password))]),
  string:equal(string:to_lower(Hash1), 
               string:to_lower(Hash2)). 
```

我的想法是你：

*   运行您有兴趣验证其输出的命令（slappasswd），保存输出并修剪掉散列之前的额外装饰。
*   `crypto:sha()`从 erlang 库运行。从中获取二进制输出，并将其转换为整数列表，然后将每个整数转换为十六进制字符串，然后将其连接起来，从而创建 Hash2。
*   将命令的输出与`crypto:sha()`

编辑：我没有你正在使用的这个命令，所以我不能真正彻底地尝试这个。但它适用于`sha1sum`. 我希望他们是一样的！

# android - 带有部分分隔符和复杂列表项的 Android ListView。奇怪地滚动和奇怪地绘制

> ID：13316672
> 
> 赞同：0
> 
> 时间：2012-11-09T22:01:10.120
> 
> 标签：android, listview, layout, convertview

**此问题已被第二次编辑：要查看原始问题，请向下滚动到显示“原始问题”的位置 - 对于之后的任何编辑 - 请向下滚动到“编辑 #”部分。**

**编辑二：**

此编辑是为了响应 Luksprog 的请求，以查看我在 getView() 中设置所需元素的位置 - 在检查 convertView 是否为空之后。

注意：请理解此代码是半模块化的。

**代码：**

*使用的持有人模式：*

```
public static class HeaderHolder
{
    public TextView textView;
}
public static class CommandHolder
{
    public TextView textView;
    public Button[] buttonHolder;
    public OnClickListener[] clickHolder;
} 
```

*getView() 方法 - 设置发生的位置：*

```
 switch(type)
    {
        case 0: // Is a header
            String temp = commandLabel.replace("Section:", "");
            headerHolder.textView.setText(temp);
            break;
        case 1:// Is a command
            commandHolder.textView.setText(commandLabel);
            ArrayList<String[]> commands = commandCreator.getCommands();

            // Initially set the visibility of buttons to GONE
            for (int i = 0; i <commandHolder.buttonHolder.length; i++)
            {
                commandHolder.buttonHolder[i].setVisibility(View.GONE);
            }
            // Only show buttons based on how many commands there are
            for (int i = 0; i < commands.size(); i++)
            {
                pos = i;
                commandHolder.buttonHolder[i].setVisibility(View.VISIBLE);

                drawable_normal = commands.get(i)[1];
                drawable_pressed = commands.get(i)[1] + "_pressed";

                buttonStates = new StateListDrawable();
                buttonStates.addState(new int[]{statePressed}, ApplicationConstants.moduleImageLoader.findImageByName(drawable_pressed));
                buttonStates.addState(new int[]{-statePressed}, ApplicationConstants.moduleImageLoader.findImageByName(drawable_normal));
                buttonStates.addState(new int[]{}, ApplicationConstants.moduleImageLoader.findImageByName(drawable_normal));
                commandHolder.buttonHolder[i].setBackgroundDrawable(buttonStates);

                // Retrieve the intent and parameter from the current command
                String parameter = commands.get(i)[2];
                String intentName = commands.get(i)[0];

                if(intentName.contains("Call Phone"))
                {
                    commandHolder.clickHolder[i] = new OnClickListener()
                    {
                        public void onClick(View arg0)
                        {
                            //con.startActivity(call_phone);
                        }
                    };
                }
                else if(intentName.contains("Cell"))
                {
                    commandHolder.clickHolder[i] = new OnClickListener()
                    {
                        public void onClick(View arg0)
                        {
                            //con.startActivity(call_cell);
                        }
                    };
                }
                else if(intentName.contains("Map"))
                {
                    commandHolder.clickHolder[i] = new OnClickListener()
                    {
                        public void onClick(View arg0)
                        {
                            //con.startActivity(load_map);
                        }
                    };
                }
                else if(intentName.contains("Email"))
                {
                    commandHolder.clickHolder[i] = new OnClickListener()
                    {
                        public void onClick(View arg0)
                        {
                            //con.startActivity(send_email); 
                        }};
                }
                commandHolder.buttonHolder[i].setOnClickListener(commandHolder.clickHolder[i]);
            }
            convertView.setOnClickListener(new OnClickListener()
            {
                public void onClick(View arg0)
                {
                    Dialog dialog = new Dialog(ApplicationConstants.ref_currentActivity);
                    dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
                    LinearLayout listDialogBoxlayout = new ListDialogBox(con, commandType, commandLabel, commandInfo);
                    dialog.setContentView(listDialogBoxlayout);
                    dialog.setCancelable(true);
                    dialog.show();
                }
            });
            break;
    }
    return convertView; 
```

问题：以视觉方式查看问题的发生。请向下滚动到 EDIT ONE 并查看屏幕截图。

如果有人有任何问题或需要澄清，请发表评论，我会尽快回复您。

**编辑一：** Made Changes ，但仍然是相同的行为

下面是使用 getItemViewType() 的 getView() 方法的新实现： 我做了以下检查：

```
if(convertView == null)
{
   switch type
      case header:
        convertView = inflate a header
        headerHolder.textView = convertView.findViewById(headerTextId);
        convertView.setTag(headerHolder);
      break;
      case command:
        convertView = inflate a command
        // Use CommandHolder to initialize all the necessary elements   
        commandHolder.textView = convertView.findViewById(commandLabel);
        . 
        .
        convertView.setTag(commandHolder);
      break;
}
else
{
   switch(type)
      case header : 
         headerHolder = convertView.getTag(); 
      break;
      case command : 
         commandHolder = convertView.getTag();
         break;

}
// set the actual elements
switch(type)
   case:header
      //set all elements in header
   break;
   case: command
      //set all elements in command
   break;
 return convertView; 
```

**发生了什么：**

我是一个视觉型的人，所以我认为这会有所帮助：这是一些屏幕截图：没有滚动 - 一切看起来都很棒

![在此处输入图像描述](../Images/8920bc195a9b0c6e64014f140ac968c9.png)

用鼠标滚动，一切看起来都还不错

![在此处输入图像描述](../Images/988d84f2219cc15d730cf08ec0ede639.png)

通过单击列表并向下拖动来滚动 - 请注意 canam 现在位于底部，Linda 应该在哪里？

![在此处输入图像描述](../Images/3273f6ff95a89baae9f8214beb0f9e89.png)

通过单击列表并向上拖动来滚动 - 请注意 peter 在 canam 应该位于的顶部的位置？

![在此处输入图像描述](../Images/ae8fa9ee5a7c20272886975d88e952dc.png)

应该有的清单：

1.  地址头
2.  卡南
3.  员工页眉
4.  戴夫
5.  布伦特
6.  斯蒂芬
7.  莫阿希尔
8.  彼得
9.  琳达

即使视图搞砸了——单击视图会弹出正确的对话框——如上所示。

**这是没有发生的事情：**

1.  无重复视图
2.  没有在错误的地方绘制节标题
3.  没有部分标题被绘制为命令（可以是地址或联系人）。

我觉得我就在那里，伙计们.. **我会错过什么？**

* * *

**原始问题：**

这就是我目前正在做的事情：*我已经简化了情况，实际上只是用 convertView 提出我的问题，而不会将人们与我的其他 ViewCreators 混淆。*

**我的 ListViewAdapter 具有的方法：**

```
getItemViewType(...)

getViewTypeCount(...)

getView(int position, View convertView, ViewGroup parent)
{
    int type = getItemViewType(position);
    if(listItem is section)
    {    
          if(convertView == null)
          {  
              ViewGroup viewGroup = inflate a view
              Holder.textView = textview;
              viewgroup.setTag(holder);
              view = viewGroup;
          }
          else
          {
              holder = (HeaderHolder) convertView.getTag();
              view = convertView;
          }
     }
     else 
     // different layout. Complicated list item in the form: 
     //|TextView  Button1 Button2 Button3| , where buttons only appear based on 
     //a CommandCreator. If john(TextView) has a phone and email - it displays:
     // |John PhoneButton EmailButton| 
     {
           if(convertView == null)
           {
               // inflate view
               // make buttons 
               // make onclicks null
               // set different holder
               viewgroup.setTag(holder)
               view = viewgroup;
           }
           else
           {
               view = convertView;
               holder = (CommandHolder) convertView.getTag(); 
           }
           // set the buttons to show based on commands
           // set the onclick listeners to the buttons to call certain intents based on  the command
     }
     return view;
 } 
```

}

**问题：** 我应该如何使用 getItemViewType 和 getViewTypeCount？以及如何使用 Viewgroups 和我当前的持有者？下面的工作吗？

```
 getView
  {
       type = getItemViewType;
       if(convertView == null)
       {
           switch(type)
              case: header
                  convertView = inflate header view
                  intialize HeaderHolder
                  break;
              case: command
                  convertView = inflate command view
                  initialize CommandHolder
                  break;
       }
       else
       {
            switch(type)
                case: header
                       //Actually set all the HeaderHolder Stuff
                   String temp = commandLabel.replace("Section:", "");
                   holder.textView.setText(temp);
                   LinearLayout.LayoutParams textViewParams = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT);
                   holder.textView.setLayoutParams(textViewParams);
                   return view;
                               QUESTION : But how do I use Viewgroups, and my holder. and what am I returning?
                      break;
                case: command
                     Actually set all the commandHolder stuff
                     QUESTION : Same as above.
                     break;
        }
        return convertView?
  } 
```

这是我现在的处理程序：

```
public static class HeaderHolder
{
    public TextView textView;
}
public static class CommandHolder
{
    public TextView textView;
    public Button[] buttonHolder;
    public OnClickListener[] clickHolder;
} 
```

感谢您提前提供的所有帮助！我会回答你可能有的任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T18:46:41.617

试试这个代码可能会帮助你......

```
if(convertView == null)
{
   switch type
      case header:
        convertView = inflate a header
        headerHolder.textView = convertView.findViewById(headerTextId);
        convertView.setTag(headerHolder);
      break;
      case command:
        convertView = inflate a command
        // Use CommandHolder to initialize all the necessary elements   
        commandHolder.textView = convertView.findViewById(commandLabel);
        . 
        .
        convertView.setTag(commandHolder);
      break;
}
else
{
   switch(type)
      case header : {
         if(convertView.getTag() instanceOf HeaderHolder){
             headerHolder = convertView.getTag(); 
         } else {
             headerHolder = inflate a header
             convertView.setTag(headerHolder);
         }
      }
      break;
      case command : {
         commandHolder = convertView.getTag();
         if(convertView.getTag() instanceOf CommandHolder){
             commandHolder = convertView.getTag(); 
         } else {
             commandHolder = inflate a command
             convertView.setTag(commandHolder );
         }
      }
      break;

}
// set the actual elements
switch(type)
   case:header
      //set all elements in header
   break;
   case: command
      //set all elements in command
   break;
 return convertView; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-11T18:38:03.813

关于这两种方法：

*   **getViewTypeCount()**返回布局类型的数量，在您的情况下为 2

*   **getItemViewType()**基于`int`您提供的参数返回`0`（例如对于标题布局）或`1`（对于正常行布局）。这实际上取决于您的数据以及您如何设置列表中的标题和普通行。

关于您上次的编辑，您可能没有像应有的那样在行布局上设置数据，尤其是当您引用了那些`OnClickListeners`. 您应该发布此块的完整代码：

```
// set the actual elements
switch(type)
   case:header
      //set all elements in header
   break;
   case: command
      //set all elements in command
   break; 
```

[这](https://gist.github.com/4001523)是我编写的示例代码，其中包含实现多种`ViewHolders`不同行布局类型的示例（如果您在适配器的这方面有问题）。

# git - 将子模块更新为最近的提交

> ID：13316673
> 
> 赞同：2
> 
> 时间：2012-11-09T22:01:10.983
> 
> 标签：git, bash, version-control, git-submodules

我在我的 xcode 项目中添加了几个子模块。如何升级这些库？现在我这样做的方式是转到我的第三方文件夹，里面说我有 AFNetworking，我只是从那里拉。不确定这是否是最有效的方法。还有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:52:17.253

这是正确的做法。您需要在存储库中进行更新。由于在子模块中开发是完全有效的，git 不会以这种方式从外部存储库中混淆它。

你想要

```
cd mysubprojectpath && git pull --ff-only && cd - && git add mysubprojectpath 
```

你会在你的历史中有这个。每次您想这样做时，您所要做的就是点击`ctrl-R`并开始输入`mysubprojectpath`以再次执行此操作。一旦从历史中获得正确的行，就点击进入。

# php - Windows CMD.exe“系统找不到指定的路径。”

> ID：13316682
> 
> 赞同：21
> 
> 时间：2012-11-09T22:01:49.110
> 
> 标签：php, windows, cmd, system, exec

# 通过将 Windows 恢复到以前的状态来解决

## 消息（系统找不到指定的路径。）显示...

1) 当我打开新的 CMD (Win+R => cmd)。它从介绍开始。（在第 3 行）

```
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.
The system cannot find the path specified.

C:\Users\ViliamKopecky> 
```

2）当我执行一些命令时`cmd /C dir`（或`cmd /C php -v`或其他）（在第 2 行）

```
C:\Users\ViliamKopecky>cmd /C dir
The system cannot find the path specified.
 Volume in drive C is Windows7_OS
 Volume Serial Number is 8230-1246
...

C:\Windows\System32>cmd /C php -v
The system cannot find the path specified.
PHP 5.4.8 (cli) (built: Oct 16 2012 22:30:23)
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2012 Zend Technologies 
```

3）（最烦人的）当我`exec`从 PHP 或 Node.js 或任何脚本语言运行函数时。（可能是从内部运行的`cmd /C <command>`）

## 消息不显示...

1）当我直接从cmd（或mingw，...）执行命令时

```
C:\Users\ViliamKopecky>dir
 Volume in drive C is Windows7_OS
 Volume Serial Number is 8230-1246

 Directory of C:\Users\ViliamKopecky 
```

* * *

让我们从 cmd 的简单命令开始。

`php -r "exec('dir', $stdout, $stderr); print(implode(\"\n\", $stdout), $stderr);"`

结果是这样*的（目录 test 是空的 - 这是正确的）*：

```
E:\test>php -r "exec('dir', $stdout, $stderr); print(implode(\"\n\", $stdout), $stderr);"
The system cannot find the path specified.
 Volume in drive E is www
 Volume Serial Number is 0C99-95EC

 Directory of E:\test

09.11.2012  22:42    <DIR>          .
09.11.2012  22:42    <DIR>          ..
               0 File(s)              0 bytes
               2 Dir(s)  13 495 296 000 bytes free
int(1) 
```

这表明该命令`dir`已从 php 正确执行。唯一错误的是第二行 -**系统找不到指定的路径。**- 那不应该在那里。

此消息由 exec 从**PHP**输出（也从**Node.js** as输出`require('child_process').exec("dir", function(err, stdout, stderr) {console.log(stderr)});`）

当我直接从 cmd（或 mingw 等）执行命令时，它会在没有消息的情况下正确执行。环境变量 PATH 似乎没问题。问题只是通过`exec`函数从脚本环境执行。

**如何摆脱那个烦人的消息？**谢谢

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-11-12T12:00:20.190

The problem is that some program has been set to autorun when you run cmd.exe. In my case it was ANSICON that was installed... and then I moved the file without properly uninstalling.

I found a solution in this blog post:

[http://carol-nichols.com/2011/03/17/the-system-cannot-find-the-path-specified/](http://carol-nichols.com/2011/03/17/the-system-cannot-find-the-path-specified/)

The short version is to find

HKCU\Software\Microsoft\Command Processor\AutoRun

and clear the value.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:48:38.030

This actually looks like a startup error with PHP, not with your code. Does

`php -r "echo 1;"`

also throw the same error? If so, your php.ini file or an include may be pathed incorrectly.

`php -i`

should give you more info.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-30T10:53:30.120

此消息可能意味着`PATH`环境变量中的路径不存在。

以下 PowerShell 命令将打印缺少的路径。

```
($env:path).Trim(";").Split(";") | ? {-not (test-path $_)} 
```

例如

```
> ($env:path).Trim(";").Split(";") | ? {-not (test-path $_)}
C:\Program Files\CMake\bin
C:\Program Files\SDCC\bin
C:\Users\wjbr\AppData\Local\Programs\Microsoft VS Code\bin 
```

参考

*   [http://carol-nichols.com/2011/03/17/the-system-cannot-find-the-path-specified/](http://carol-nichols.com/2011/03/17/the-system-cannot-find-the-path-specified/)
*   [https://javarevisited.blogspot.com/2017/01/the-system-cannot-find-path-specified-error-in-command-prompt.html](https://javarevisited.blogspot.com/2017/01/the-system-cannot-find-path-specified-error-in-command-prompt.html)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-12-30T05:38:49.117

我想你应该试试这个！我遇到了同样的问题并像这样解决了它：

ok type : cd\windows\system32 之后你会看到这个： System32/: Type what you want (ex:ipconfig): System32: ipconfig 然后就可以了！:)

# api - Bazaarvoice API V5.3

> ID：13316687
> 
> 赞同：0
> 
> 时间：2012-11-09T22:02:16.937
> 
> 标签：api

这里有熟悉[Bazaarvoice 和他们的 5.3 api 的](http://developer.bazaarvoice.com/)人吗？我试图弄清楚如何根据帮助字段获得产品评论。我找不到任何关于在任何地方使用此字段的参考，以及它正在寻找的参数值可能是什么（真、假、是、否等）。

```
http://reviews.apitestcustomer.bazaarvoice.com/bvstaging/data/reviews.json?apiversion=5.3&passkey=kuy3zj9pr3n7i0wxajrzj04xo&filter=AdditionalField_Helpfulness:eq:yes 
```

我还想知道您是否可以使用多个搜索词而不是一个搜索词进行搜索。

```
http://reviews.apitestcustomer.bazaarvoice.com/bvstaging/data/reviews.json?apiversion=5.3&passkey=kuy3zj9pr3n7i0wxajrzj04xo&search=dress 
```

如果有人对此有任何经验或有可以分享的联系方式，那就太棒了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:47:18.460

APITestCustomer 数据集中的评论都没有与之相关的帮助/反馈投票，因此很难找到第一个问题的答案。

您可以通过以下方式验证这一点

```
filter=TotalFeedbackCount:gt:0 
```

并看到你没有得到任何结果。如果有反馈投票，我希望有用性字段是浮点数，您可以根据它对评论进行排序以找到最有帮助的评论。

对于搜索文本，您可以通过用空格列出它们来 OR 值（URL 编码）

```
search=really%20love 
```

并要求他们在一个短语中

```
search="really%20love" 
```

如果您对它们进行正确的 URL 编码，许多典型的搜索运算符应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-25T00:31:53.787

我知道这是旧的，但对于任何新发现这个的人：

```
TotalFeedbackCount:gt:0

TotalPositiveFeedbackCount:gt:0 

TotalNegotiveFeedbackCount:gt:0 
```

# diazo - 如何使用重氮规则计算 href 值

> ID：13316690
> 
> 赞同：2
> 
> 时间：2012-11-09T22:02:23.783
> 
> 标签：diazo

我试图通过使用我从内容中选择的值计算 URL 来更改主题`href`中某些元素的 s 。`<a>`但是，我根本不知道如何更改 href 属性。似乎规则`attributes`中没有理解该属性`<replace>`。

最终，我希望能够做类似的事情：

```
<replace css:theme="a.languageswitcher" attributes="href">
  <!-- use some XSL logic here to stitch together the new href -->
</replace> 
```

所以以下规则有效，但对我没用：

```
<copy attributes="href" css:theme="a.languageswitcher" css:content="#portal-logo" />

<merge attributes="href" css:theme="a.languageswitcher" css:content="#portal-logo" /> 
```

但是这个已经不起作用了`attributes="href"`，所以这个规则被忽略了。

```
<replace attributes="href" css:theme="a.languageswitcher" css:content="#portal-logo" /> 
```

另一方面，如果我尝试`<a>`从头开始重建元素，那么我会遇到@ross-patterson 在他的问题中描述的错误：[Diazo - Conditionally add a class to a theme element](https://stackoverflow.com/questions/10131092/diazo-conditionally-add-a-class-to-a-theme-element)：

```
 <replace theme="//a[@class='languageswitcher']">
      <a class="languageswitcher">
        <xsl:attribute name='href'>
          foo
        </xsl:attribute>
      </a>
    </replace> 
```

产生错误：

```
XSLTApplyError: xsl:attribute: Cannot add attributes to an element if children have been already added to the element. 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-29T15:01:14.203

像这样的东西应该可以工作：

```
<replace css:theme="a.languageswitcher">
    <xsl:for-each css:select="a.languageswitcher">
        <xsl:variable name="link">
            http://example.com
        </xsl:variable>
        <a href="{$link}"><xsl:copy-of select="." /></a>
    </xsl:for-each>
</replace> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T07:06:21.850

在一个主题中我使用了这个规则

```
<replace css:content-children="#hptoolbar-cerca"><xsl:attribute name="href">
<xsl:value-of select="//li[@id='portaltab-catalog']//a/@href" /></xsl:attribute><xsl:apply-templates select="node()"/></replace> 
```

使用内容中另一个元素的 href 修改 #hptoolbar-cerca 的 href。

也许这对你有用。

维托

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-19T00:49:45.657

我的情况类似。我对我的主题代码很满意，只想“替换”它的`href`值。在 Chrome 检查器中复制 XPath 后，最简单的规则如下所示：

```
<copy attributes="href"
       theme="/html/body/div[2]/div[1]/div/div[1]/a"
     content="//*[@id='portal-logo']" /> 
```

我希望成功地将这个技巧应用于所有`href`值，但有些不起作用。我发现这些`<a>`元素在 JavaScript 操作的代码块中，用于实现幻灯片效果。我删除了所有相关的 JavaScript 代码，并再次复制了它的“真实”XPath，最后一切正常。希望这有帮助。

# javascript - jQuery 代码行为错误

> ID：13316692
> 
> 赞同：-1
> 
> 时间：2012-11-09T22:02:41.057
> 
> 标签：javascript, jquery, html, jquery-plugins

jQuery 没有按应有的方式工作，并且完全忽略了逻辑。

如果我单击一个链接，它会显示给定的描述，并淡化其他菜单。
如果我再次单击相同的链接，它应该隐藏该描述，并淡入其他链接。

但相反，它只是隐藏了文本，并没有将它们淡入。
从控制台单独运行代码并单击段落旁边的空白时，它工作得很好。

[参考网站](http://hunpony.hu/today/hu/faq/)

jQuery：

```
 $('a[class]').click(function(){
    var clas = $(this).attr('class');
        $('#'+clas.substring(0,2)).fadeTo('fast',1).removeClass('faded');
        $('p:not(#'+clas.substring(0,2)+')').fadeTo('fast',0.3);
        $('.ans:visible').toggle('slow');
        $('#'+clas.substring(0,2)+'a'+':hidden').fadeIn('slow');
        $('p:not(#'+clas.substring(0,2)+')').addClass('faded');
        return false;
    });
    $('p:not(p.faded)').click(function(){
        $('.ans:visible').toggle('slow');
        $('p[class="faded"]').fadeTo('fast',1).removeClass('faded');
    }); 
```

HTML：

```
 <p id="q1">1\. <a class="q1">Nem látom a kedvenc karakterem, hozzá tudod adni?</a>
    <br>
    <span id="q1a" style="display:none;" class="ans">
        Persze. Írj egy e-mail-t a <a href="mailto:djdavid98+mlptoday@gmail.com?subject=MLP Today Karakterkérés" target="_blank">djdavid98@gmail.com</a> címre a karakter nevével.
        <br>
        <span style="color:red">OC-kat és fillyket NEM adok hozzá.</span>
    </span>
    </p>

    <p id="q2">2\. <a class="q2">Hogyan tudok karaktert választani?</a>
    <br>
    <span id="q2a" style="display:none;" class="ans">
        Látogass el a <a href="../../img/?from=faq_hu">Karakterválasztás</a> oldalra, ahol kiválaszthatod a kedvenced.
        <br>
        Haználhatod továbbá a "<i>Véletlenszerű karakter</i>" linket is.
    </span>
    </p>

    <p id="q3">3\. <a class="q3">Mi ennek az oldalnak a célja/alapötlete?</a>
    <br>
    <span id="q3a" style="display:none;" class="ans">
        Eredetileg a <a href="http://milyennapvanma.hu/" target="_blank">milyennapvanma.hu</a> weboldal pónisított változataként indult,
        <br>
        de azóta már nagy mértékben továbbfejlődött az oldal.
    </span>
    </p> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T22:42:16.403

我很佩服你的自信：你的代码不起作用，所以你认为问题出在 jQuery 上。

在您的代码中，此语句：

```
$('p:not(p.faded)').click(function(){ 
```

*...将点击处理程序绑定到当时*没有`"faded"`该类的任何元素。这将是所有元素，因为最初没有褪色。如果您希望它仅适用于以后没有添加该类的元素，您需要使用您通过分配的委托处理程序（或者如果使用早于 1.7 的 jQuery，或者如果使用可笑的旧 jQuery）：*`.on()``.delegate()``.live()`*

 *```
$(document).on('click', 'p:not(p.faded)'), function() { 
```

理想情况下，您不会将处理程序绑定到`document`，您将使用相关段落的最接近的祖先，但由于您没有显示太多标记，我将把这部分留给您。

但是，您还可以`return false;`从锚元素上的单击处理程序中获取，这会阻止单击事件传播到段落。

但是，我认为你让整个事情变得比你需要的更复杂。以下代码完成了工作：

```
var $questions = $('p'); // add class selectors here

$questions.click(function(){
   var $this = $(this),
       isOpen = $this.hasClass('open');

   $this.fadeTo('fast',1).toggleClass('open',!isOpen)
        .find('span.ans').toggle('slow');
   $questions.not(this).fadeTo('fast', isOpen ? 1 : 0.2)
                       .removeClass('open')
                       .find('span.ans').hide('slow');
}); 
```

​ 即当任何段落被点击时，判断它是否已经打开了答案。然后确保点击的那个是可见的，并切换它的答案。然后取其所有同级段落并酌情将它们淡入或淡出并隐藏它们的答案。

在我放置注释“在此处添加类选择器”的地方，最好添加一个类来识别文档中的哪些段落是问题。

演示：http: [//jsfiddle.net/DxFDP/2](http://jsfiddle.net/DxFDP/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:55:31.163

我**永远不会使用 jQuery 将样式**应用于代码，但简单的添加和删除类......

**它会变得混乱**，有时我们可以简化而不是复杂化。

这是一个**简单的例子**：http: [//jsbin.com/amiloc/1/](http://jsbin.com/amiloc/1/)

相同，但没有`<li>`'s：http: [//jsbin.com/amiloc/3/](http://jsbin.com/amiloc/3/)

添加了颜色，因此我们知道“引擎盖下”发生了什么，让您自己判断。*

# java - 带有 Powermockito 的 TestNG 对静态方法失败

> ID：13316693
> 
> 赞同：2
> 
> 时间：2012-11-09T22:02:48.907
> 
> 标签：java, unit-testing, mockito, testng, powermock

我正在尝试使用 TestNG 和 Powermockito 将单元测试添加到遗留报告生成代码中。

```
import static org.testng.AssertJUnit.assertTrue;
import static org.powermock.api.support.membermodification.MemberModifier.stub;
import org.testng.annotations.Test;
import org.mockito.Matchers;
import org.mockito.Mockito;
import org.powermock.api.mockito.PowerMockito;
import org.powermock.core.classloader.annotations.PrepareForTest;

@PrepareForTest(ConfigReader.class)
public class defTest{
    @Test
    public void testGetPartsSuccessful() throws Exception {
        TrendsReportData reportGenerator = new TrendsReportData();

        TreeMap<Calendar, String> t = new TreeMap<Calendar, String>();
        Calendar c = Calendar.getInstance();
        String b = "234";
        t.put(c, b);
        Properties properties = new Properties();

       properties.load(Thread.currentThread().getContextClassLoader().getResourceAsStream("MetricTest.properties"));
        MetricDAO dao = Mockito.mock(MetricDAO.class);
        Mockito.when(
                          dao.getMetricData(Matchers.anyString(), Matchers.anyString(),
                                          Matchers.anyString(), Matchers.any(Calendar.class),
                                          Matchers.any(Calendar.class))).thenReturn(t);
        //stub (PowerMockito.method(ConfigReader.class, "readFile")).toReturn(properties);//line 36
        PowerMockito.mockStatic(ConfigReader.class); //line 37
        Mockito.when(ConfigReader.readFile(Matchers.anyString())).thenReturn(properties);//line 38
        reportGenerator.setMetricDao(dao);
        reportGenerator.prepareMonthStats();
        //assert file here
    }
} 
```

此代码产生以下输出：

```
[testng] org.mockito.exceptions.misusing.InvalidUseOfMatchersException: 
[testng] Misplaced argument matcher detected here:
[testng] -> at .....defTest.testGetPartsSuccessful(defTest.java:38)
[testng] You cannot use argument matchers outside of verification or stubbing.
.
.
.
[testng]    at myclasspackage.myclassname(class_name.java:38)
[testng]    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[testng]    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
[testng]    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
[testng]    at java.lang.reflect.Method.invoke(Method.java:597)
[testng]    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
[testng]    at org.testng.internal.Invoker.invokeMethod(Invoker.java:691)
[testng]    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:883)
[testng]    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1208)
[testng]    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)
[testng]    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
[testng]    at org.testng.TestRunner.privateRun(TestRunner.java:753)
[testng]    at org.testng.TestRunner.run(TestRunner.java:613)
[testng]    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
[testng]    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
[testng]    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
[testng]    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
[testng]    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
[testng]    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
[testng]    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1137)
[testng]    at org.testng.TestNG.runSuitesLocally(TestNG.java:1062)
[testng]    at org.testng.TestNG.run(TestNG.java:974)
[testng]    at org.testng.TestNG.privateMain(TestNG.java:1282)
[testng]    at org.testng.TestNG.main(TestNG.java:1246) 
```

如果我注释掉第 37 和 38 行并改用第 36 行，它可以正常工作，但不会产生所需的输出，即它不是在模拟 ConfigReader 的静态方法，而是在模拟 MetricDAO 的非静态方法。

我已经查看了其他类似问题的答案，但没有一个有效。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T23:03:09.517

根据[PowerMock](http://code.google.com/p/powermock/wiki/TestNG_usage)文档，您的测试类应该从`PowerMockTestCase`. 还提到将此方法添加到您的测试类：

```
 @ObjectFactory
 public IObjectFactory getObjectFactory() {
     return new org.powermock.modules.testng.PowerMockObjectFactory();
 } 
```

但是这些更改都没有对我有用:(

因此，我切换到了 JMockit，它就像一个魅力一样工作。用 Mockito 编写的模拟与 JMockit 对静态方法的部分模拟一起工作得很好。

# javascript - Bootstrap Popover 父级？

> ID：13316699
> 
> 赞同：4
> 
> 时间：2012-11-09T22:03:24.083
> 
> 标签：javascript, twitter-bootstrap

我正在尝试将弹出框插入到特定元素中，因为目前，弹出框正在直接插入`<body>`（并且我需要它相对于其他一些元素）。但是，我似乎找不到如何将弹出框插入到某个元素中？我怎样才能触发这个？

编辑：我发现在放置选项中使用“内部”会将其插入到触发它的元素中。这很接近，但我需要一种方法将它插入到 DOM 中更高的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T09:29:22.527

您可以将您的 tooltip.js 更新到此文件 -[我的 tooltip.js](https://github.com/Yohn/bootstrap/blob/06811f84d4ac766c3297c5ecfe82333bdb4db326/js/bootstrap-tooltip.js)，然后通过添加`data-container=".element"`或使用 javascript选择要附加到弹出窗口的元素

`$(element).popover({ container: '.popover-holder' })`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T11:42:26.537

引导部分悬停选项的另一个脚本

[https://github.com/sja87/bootstrap-tooltip-parent](https://github.com/sja87/bootstrap-tooltip-parent)

# java - java增加数组的维数

> ID：13316711
> 
> 赞同：0
> 
> 时间：2012-11-09T22:04:09.063
> 
> 标签：java, multidimensional-array, arraylist, dimensions

制作动态多维数组是否可能（我相信它是）并且不太复杂，如果需要，它会增加维度？

```
// Array[] 1 has 2 dimensions
if(blah=blah)
{
   Array[] 1 gets second dimension and is now Array[][]
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T22:09:06.303

不，这是不可能的：数组的维数是数组*类型*的属性，而不是数组*对象*的属性，所以你不能用内置的 Java 数组来做到这一点。

为了模拟可以在运行时更改维数的数组，您需要构建自己的类。您可以将该类基于数组或`ArrayList`，但会有一个限制：您将无法在模拟数组上使用下标运算符。

还有一个“丑陋”的解决方案：您可以在没有类型的情况下存储数组 - 本质上，作为无类型的`Object`. 您可以将具有任意维数的数组分配给 type 的变量`Object`，如下所示：

```
Object a = new int[10];
a = new int[10][2];
a = new int[10][2][5]; 
```

问题是如果不执行强制转换，您将无法访问此类数组的元素：

```
a[2][1][0] = 7; // Will not compile 
```

这将编译并工作，但构造相当不可读：

```
((int[][][])a)[2][1][0] = 7; 
```

另请注意，数组的先前内容将在重新分配时丢失，除非您对其进行复制。

# c# - 设计师不会接受我的方法鼠标按下

> ID：13316716
> 
> 赞同：0
> 
> 时间：2012-11-09T22:04:53.767
> 
> 标签：c#

我尝试从单击图像的位置获取 Heu 值，但是我做错了，我不确定它是什么，它与设计器文件以及我如何调用图像的函数 _mousedown 有关。

在我的 main.designer.cs 文件中，我有：

```
// pictureBox1
// 
this.pictureBox1.Location = new System.Drawing.Point(146, 30);
this.pictureBox1.Name = "pictureBox1";
this.pictureBox1.Size = new System.Drawing.Size(640, 480);
this.pictureBox1.TabIndex = 1;
this.pictureBox1.TabStop = false;

//line below is not accepted ??  

this.pictureBox1.MouseDown += new System.EventHandler(this.pictureBox1_MouseDown); 
```

在我的主程序中，我有：

```
private void pictureBox1_MouseDown(object sender, System.Windows.Forms.MouseEventArgs e)
    {
        System.Drawing.Point Cursor = new System.Drawing.Point(e.X, e.Y);
        Color pixel = myImage.GetPixel(Cursor.X, Cursor.Y);
        textBoxH.Text =pixel.GetHue().ToString();
     } 
```

我得到的错误是：

*“System.Windows.Forms.PictureBox”不包含“pictureBox1_MouseDown”的定义，并且找不到接受“System.Windows.Forms.PictureBox”类型的第一个参数的扩展方法“pictureBox1_MouseDown”

您是否缺少 using 指令或程序集引用？）

C:\projects\visual studio 2010\Projects\image\Main.Designer.cs**

请注意，我已将`using System;`上述内容包含在我的主程序中。

***更新*** 编译后我现在得到一个不同的错误（没有更改代码）

错误 1 ​​'pictureBox1_MouseDown' 没有重载匹配委托 'System.EventHandler'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:20:00.610

在我看来，您手动对设计器文件进行了更改。如果您这样做了，请停止这样做：不应触摸设计器生成的代码，因为 VS 会搞砸它。

无论如何，这不是鼠标按下事件的正确定义。

以下：

```
this.pictureBox1.MouseDown += new System.EventHandler(this.pictureBox1_MouseDown); 
```

应该：

```
this.pictureBox1.MouseDown += new System.Windows.Forms.MouseEventHandler(this.pictureBox1_MouseDown); 
```

# c# - 使用 LINQ 的 .Cast() 运算符时，显式/隐式转换运算符失败

> ID：13316718
> 
> 赞同：36
> 
> 时间：2012-11-09T22:05:09.693
> 
> 标签：c#, linq, exception, casting

我正在尝试使用具有显式（但也因隐式失败）强制转换运算符的类，该运算符在使用 LINQ`Cast<T>()`函数时失败。这是两个类的定义

```
public class DatabaseInfoElement : ConfigurationElement
{
    [ConfigurationProperty("AllowedServer", IsRequired = true)]
    public string AllowedServer { get { return (string)base["AllowedServer"]; } }

    [ConfigurationProperty("DatabaseName", IsRequired = true)]
    public string DatabaseName { get { return (string)base["DatabaseName"]; } }

    [ConfigurationProperty("SqlInstance", IsRequired = true)]
    public string SqlInstance { get { return (string)base["SqlInstance"]; } }

    public static explicit operator DatabaseInfo(DatabaseInfoElement element)
    {
        return new DatabaseInfo(element.AllowedServer, element.DatabaseName, element.SqlInstance);
    }

}

public class DatabaseInfo
{
    public DatabaseInfo(string allowedServer, string sqlInstance, string databaseName)
    {
        AllowedServer = allowedServer;
        SqlInstance = sqlInstance;
        DatabaseName = databaseName;
    }

    public string AllowedServer { get; set; }
    public string SqlInstance { get; set; }
    public string DatabaseName { get; set; }
} 
```

这是我用来测试它的代码。

```
//Gets the ConfigurationSection that contains the collection "Databases"
var section = DatabaseInfoConfig.GetSection();

//This line works perfectly.
DatabaseInfo test = (DatabaseInfo)section.Databases[0];

//This line throws a execption
var test2 = new List<DatabaseInfo>(section.Databases.Cast<DatabaseInfo>()); 
```

这是我得到的例外

```
System.InvalidCastException 未被用户代码处理
  H结果=-2147467262
  消息=无法将“Server.Config.DatabaseInfoElement”类型的对象转换为“Server.DatabaseInfo”类型。
  源=System.Core
  堆栈跟踪：
       在 System.Linq.Enumerable.d__b1`1.MoveNext()
       在 System.Collections.Generic.List`1..ctor（IEnumerable`1 集合）
       在 E:\Code\Sandbox\Program.cs:line 82 中的 Sandbox.Main()
  内部异常：

```

我在选角时做错了什么以使其按我想要的方式工作？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-11-09T22:07:41.737

当您定义显式/隐式转换运算符时，它们在编译时绑定在调用站点。这就是第一行有效的原因：编译器可以计算出所有需要的类型信息，因此它可以用您自定义的显式转换运算符替换默认的。

然而，由于`Cast<T>`只是执行一个泛型转换，编译器不知道你的操作符，因此它被忽略了。结果：无效的强制转换异常。

您可以通过执行`.Select(x => (DatabaseInfo)x)`. 或者，您可以添加一个名为 的方法`ToDatabaseInfo()`，这样您就不会隐藏实际发生的事情。

# java - 如何使用非 ISO 3166 国家/地区（如 en_UK）创建货币实例？

> ID：13316719
> 
> 赞同：6
> 
> 时间：2012-11-09T22:05:12.803
> 
> 标签：java, android, locale

在我的应用程序中，我使用获取用户的默认语言环境`Locale.getDefault()`，然后将其传递给`Currency.getInstance(Locale)`. 它主要工作，但我已经开始从用户那里获得报告，这些报告`IllegalArgumentException`在堆栈跟踪中显示以下内容：

> 原因：java.lang.IllegalArgumentException：不受支持的 ISO 3166 国家：在 org.java.util.Currency.getInstance(Currency.java:81) 的 en_UK。

我希望 Android 只返回有效的语言环境，但显然情况并非如此。

如何处理此类情况以确保我只获得有效的 ISO 3166 语言环境？简单的方法是处理这种特殊情况，但如果有的话，我宁愿使用通用解决方案。

有人有这方面的经验吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-10T12:18:25.320

[ISO 3166](http://userpage.chemie.fu-berlin.de/diverse/doc/ISO_3166.html)英国的两个字母缩写不是`UK`，正确的 id 是`GB`。 `UK`是否出于兼容性原因（过去犯的错误）。

我确实寻找了其他例外，但没有找到任何例外，所以现在我只处理特殊情况。

```
Locale loc = new Locale("en","UK"); // test code

if(loc.getCountry().equals("UK")){
    loc = new Locale(loc.getLanguage(), "GB");
    }
Currency cur = Currency.getInstance(loc); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-03T15:01:41.267

`Currency.getInstance(...)`需要格式为“en_US”的语言环境，但是，`Locale.getDefault()`并不总是返回这种格式的语言环境。

为了防止您的应用程序崩溃，您可以使用以下内容：

```
public static String getCurrencySymbol(){
    String cursym;
    try {
        cursym = Currency.getInstance(Locale.getDefault()).getSymbol();
    } catch (IllegalArgumentException e) {
        cursym = "?"; // default symbol
    }
    return cursym;
} 
```

您可以尝试找出一种更好的方法来获得最合适的符号，或者让用户选择一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-21T08:39:29.900

您的用户（启用了开发设置）或测试人员手动设置了一个奇怪且无效的国家/地区。这个错误发生在我们身上，但事实证明我们的测试人员已经将 Appium 配置为将设备区域设置为`en-UK`:)。

普通用户不能选择 en-UK 或任何其他无效的语言环境。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-02T07:08:34.943

```
String symbolLocale ="";
int localeLength = mLocale.split("-").length;

if (localeLength == 2) {
    symbolLocale = new Locale(
        mLocale.split("-", 2)[0], 
        mLocale.split("-", 2)[1]
    );
} else if (localeLength == 3) {
    symbolLocale = new Locale(
        mLocale.split("-", 3)[0] + "-" + 
        mLocale.split("-", 3)[1], 
        mLocale.split("-", 3)[2]
    );
}

symbolString = Currency.getInstance(symbolLocale).getSymbol(symbolLocale); 
```

# c# - 从 C# 中的列表视图中选择项目

> ID：13316723
> 
> 赞同：0
> 
> 时间：2012-11-09T22:05:40.447
> 
> 标签：c#

我正在尝试从列表视图中选择一个项目，当我选择它时，它应该在文本框中显示每个项目。我可以选择并获取第一项，但是当我选择第二项时出现错误，

“参数超出范围异常未处理，InvalidArgument='0' 的值对 'index' 无效。”

我有下面的代码，请帮助我..

```
public partial class Form2 : Form
{
  List<Person> people = new List<Person>();
}

class Person
{
  public string Name{ get; set; }

  private void button2_Click(Object sender, EventArgs e)
  {
    Person p = new Person();
    p.Name = textBox1.Text;
    people.Add(p);
    listBox1.Items.Add(p.Name);
  }

  private void listView1_SelectedIndexChanged(object sender, EventArgs e)
  {
    textBox1.Text = people[listView1.SelectedItems[0].Index].Name;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:09:12.000

```
 private void listView1_SelectedIndexChanged(object sender, EventArgs e)
 {
   if(listView1.SelectedItems.Count > 0)
     textBox1.Text = people[listView1.SelectedItems[0].Index].Name;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:08:53.593

有一小段时间没有选择项目：就在第一个被取消选择之后和新的被选择之前。如果有一个项目被选中，你应该在你做任何你想做的事情之前检查你的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T22:10:28.613

我建议您只检查`"Items"`ListBox 对象属性中的数据并将其与`"people"`您拥有的变量进行比较。确保它们在触发`"SelectedIndexChanged"`事件时不同步。

希望能帮助到你

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T22:27:52.633

如果您想列出您的人员并删除列出人员，您需要执行以下操作：

- 添加到将返回Person.Name的Person函数ToString()，ListBox可以保留任何对象，但显示的文本是object.ToString()

```
public override string ToString() 
{
  return Name;
} 
```

- 在按钮单击时，您必须将人员添加到 listView1，而不是人名：

```
private void button2_Click(object sender, EventArgs e)
{
    Person p = new Person();
    p.Name = textBox1.Text;

    people.Add(p);
    listBox1.Items.Add(p);
} 
```

- 现在你可以得到你的人，因为 listView 现在保留**Person**，而不是**String**：

```
private void listView1_SelectedIndexChanged(object sender, EventArgs e)
{
  textBox1.Text = ((Person)listView1.SelectedItems[0]).Name;
} 
```

# c++ - 使用限定类型实例化的模板内函数的名称解析

> ID：13316727
> 
> 赞同：7
> 
> 时间：2012-11-09T22:06:04.737
> 
> 标签：c++, templates, namespaces, overloading, name-lookup

考虑以下 C++ 代码示例：

```
namespace n
{
    struct A {};
}

struct B {};

void foo(int) {}

template<typename T>
void quux()
{
    foo(T());
}

void foo(n::A) {}
void foo(B) {}

int main()
{
    quux<n::A>(); // Error (but works if you comment out the foo(int) declaration)
    quux<B>();    // Works

    return 0;
} 
```

如注释中所示，模板实例化`quux<n::A>()`会导致编译器错误（在 GCC 4.6.3 上）：

```
foo.cpp: In function ‘void quux() [with T = n::A]’:
foo.cpp:22:16:   instantiated from here
foo.cpp:13:5: error: cannot convert ‘n::A’ to ‘int’ for argument ‘1’ to ‘void foo(int)’ 
```

有人可以向我解释发生了什么吗？我本来希望它与`quux<B>()`. 它必须与何时`foo`被视为依赖有关。不幸的是，我的 C++ foo 还不够好。当`foo(int)`声明不存在时，该示例编译得很好，这也让我感到惊讶。

欢迎任何提示、解释和解决方法。

**更新1：**

我不想（读不能）`foo(n::A)`在定义之前移动声明`quux`（这将避免错误）。

**更新 2：**

感谢 David 指出相关问题[Template function call 被在 template 之前声明的签名错误的函数混淆](https://stackoverflow.com/questions/13223278/template-function-call-confused-by-function-with-wrong-signature-declared-before)。Johannes Schaub 接受的答案 - litb 提出了一个包装类解决方案，在我的情况下也可以作为一种解决方法。但是，我对它并不是 100% 满意。

**更新 3：**

我通过将 in 的定义`foo(n::A)`放入 namespace解决了这个问题`n`。感谢 Jesse Good 和 bames53 的有用回答，他们不仅指出了标准的相关部分，还提供了替代解决方案。感谢 David Rodríguez - dribeas 在我没有正确理解所提出的解决方案时的解释以及所有其他贡献者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:17:27.870

我认为规则是 14.6.4.2p1：

> 对于依赖于模板参数的函数调用，使用通常的查找规则（3.4.1、3.4.2、3.4.3）找到候选函数，除了：
> 
> — 对于使用非限定名称查找 (3.4.1) 或限定名称查找 (3.4.3) 的查找部分，仅找到来自模板定义上下文的函数声明。
> 
> — 对于使用关联命名空间 (3.4.2) 的查找部分，仅找到在模板定义上下文或模板实例化上下文中找到的函数声明。

`void foo(n::A) {}`在模板定义上下文中**不可见**，因为它位于 . 之后`foo`且不在同一个命名空间中`n::A`。所以它需要在模板定义*之前*可见或包含在同一个命名空间中，如下所示：

```
namespace n
{
    void foo(n::A) {}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T15:35:33.847

我的编译器给出的错误是：

```
main.cpp:11:5: error: call to function 'foo' that is neither visible in the template definition nor found by argument-dependent lookup
    foo(T());
    ^
main.cpp:18:5: note: in instantiation of function template specialization 'quux<n::A>' requested here
    quux<n::A>(); // Error (but works if you comment out the foo(int) declaration)
    ^
main.cpp:14:6: note: 'foo' should be declared prior to the call site or in namespace 'n'
void foo(n::A) {}
     ^ 
```

这清楚地表明了问题所在。

但是，注释掉`void foo(int)` *并不能*使它起作用；这只是编译器中的错误/扩展。

您提到您`void foo(n::A)`之前无法定义`quux()`，但是当您在评论中说您无法在 namespace`n`中定义它时，您给出的原因似乎并不适用。这应该可以解决问题而没有您提到的其他问题。

```
template<typename T>
void quux()
{
    foo(T());
}

namespace n {
    void foo(n::A) {}
}
using n::foo; // in case there's any other code that depends on getting foo(n::A) from the global namespace

void foo(B) {} // this stays in the global namespace 
```

* * *

如果您无法`void foo(n::A)`通过适当的两阶段查找（同样，在 namespace之前`quux()` *或*`n`内部）将定义移动到它的工作位置，那么有一种可能对您有用的 hacky 解决方案：前向声明`foo()` *inside* `quux()`的正确重载。

```
template<typename T>
void quux()
{
    void foo(T);
    foo(T());
} 
```

该函数最终必须在相同的命名空间中定义，`quux()`并且它必须与“通用”前向声明相匹配。

* * *

或者还有另一种选择。直到最近，大多数 C++ 编译器才开始提供正确的两阶段名称查找，因此有很多代码不正确，但编译器希望支持这些代码。如果您无法更改代码，那么它可能是启用兼容性编译器选项的好选择；我的编译器使用该标志`-fdelayed-template-parsing`来禁用两阶段名称查找，而是始终在实例化上下文中查找名称。

# python - 循环遍历文件并跳过数据并在此之后读取会出错

> ID：13316728
> 
> 赞同：0
> 
> 时间：2012-11-09T22:06:15.937
> 
> 标签：python, file-io, iterator

我有多个目录和每个目录中的许多文件，我想遍历它们中的每一个。我还想只读取`5th`每个文件的行，因此忽略前四行。当我运行脚本而不忽略尝试忽略第一`4`行时，它运行良好。这是代码：

```
import os

#find the present working directory
pwd=os.path.dirname(os.path.abspath(__file__))

#find all the folders in the present working directory.
dirs = [f for f in os.listdir('.') if os.path.isdir(f)]

for directory in dirs:
        os.chdir(os.path.join(pwd, directory));
        chd_dir = os.path.dirname(os.path.abspath(__file__))
        files = [ fl for fl in os.listdir('.') if os.path.isfile(fl) ]
        print files
        for f in files:
                f_obj = open(os.path.join(chd_dir, f), 'r')
                for i in xrange(0,4): #ignore the first 4 lines
                        f_obj.next()
                s=f_obj.readline()
                print s
                f_obj.close() 
```

此脚本给出以下错误： `ValueError: Mixing iteration and read methods would lose data`

我不明白为什么 python 认为我会丢失一些数据，我也想知道修复它的工作以及为什么修复它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:07:44.270

您可以使用以下方法重复第 5 行`.next()`：

```
s = f_obj.next() 
```

文件迭代方法使用缓冲来保持效率，并且该缓冲区不与`.readline()`文件对象的 the 和其他读取方法共享。因此，在混合迭代和读取方法时，您会错过数据。

从[`.next()`方法文档](http://docs.python.org/2/library/stdtypes.html#bltin-file-objects)：

> 为了使 for 循环成为循环文件行的最有效方式（一种非常常见的操作），该`next()`方法使用隐藏的预读缓冲区。作为使用预读缓冲区的结果，`next()`与其他文件方法（如`readline()`）组合不能正常工作。

您也可以用呼叫替换`.next()`呼叫`.readline()`，只要保持一致并使用其中一个即可。

# javascript - 在 ASP.MVC3 视图中使用 ie9 的 jQuery UI 自动完成错误

> ID：13316739
> 
> 赞同：1
> 
> 时间：2012-11-09T22:07:31.427
> 
> 标签：javascript, jquery, asp.net-mvc-3, jquery-plugins, jquery-ui-autocomplete

您好我在 ASP.MVC3 Web 应用程序中使用 jQuery UI Autocomplete 1.8.11。

在视图中，我有以下 javascript 代码：

```
 $("#textUsername" + UserNameCounter).autocomplete({
        minLength: 2,
        source: function (request, response) {
            var params = {
                q: 5,
                term: request.term
            };
            var jsonData = JSON.stringify(params, null, 2);
            $.ajax({
                url: '@Url.Action("GetUsernames", "Controller")', type: "POST", dataType: "json",
                contentType: 'application/json; charset=utf-8',
                data: jsonData,
                success: function (data) {
                    response($.map(data, function (item) {
                        return {
                            id: item.id,
                            label: item.label,
                            value: item.value
                        }
                    }));
                }
            });
        }
    }); 
```

这在 Chrome 和 FF 中工作得很好，但在 IE9 中表现得很奇怪：当我开始输入单词并且自动完成显示结果时，它只是删除结果并且文本框中的焦点丢失了。

在谷歌搜索时，我意识到这个插件应该在 IE9 中工作，并且论坛上的大多数问题都与我的完全不同，并且主要与语法错误或类似的东西有关。有谁知道为什么插件在我正在处理的视图上表现得这样？

先谢谢了。

# msbuild - 在 MSBuild 中，您可以一次为所有文件设置每个文件的属性吗？

> ID：13316741
> 
> 赞同：0
> 
> 时间：2012-11-09T22:07:32.970
> 
> 标签：msbuild

我正在尝试为 VS2010/MSBuild 构建设置一个简单的规则，以减少项目管理。它与“ExcludedFromBuild”属性有关。

规则是，如果文件名中没有平台名称，则 ExcludedFromBuild = true。

IE-

我有 Win32Math.cpp 和 Win64Math.cpp。我只希望在构建 Win32 平台时编译 Win32Math。Win64 类似。

为每个文件设置这个很容易，但有点乏味。我们有 4 个目标平台，每次添加文件时，我们都必须更新每个目标的属性。我希望规则是全局的，所以每次添加平台文件时，我都不必每次都进行设置。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T12:47:02.537

It is possible, but you can't test intrinsic item metadata in `<ItemDefinitionGroup>`s. The only known way is to use a target.

```
<Target Name="RemoveNonPlatformItems" BeforeTargets="ClCompile">
    <ItemGroup>
        <ClCompile>
            <ExcludedFromBuild Condition="!$([System.String]::Copy(%(FileName)).Contains($(Platform)))">true</ExcludedFromBuild>
        </ClCompile>
    </ItemGroup>
</Target> 
```

Or even better:

```
<Target Name="RemoveNonPlatformItems" BeforeTargets="ClCompile">
    <ItemGroup>
        <ClCompile Remove="%(Identity)" Condition="!$([System.String]::Copy(%(FileName)).Contains($(Platform)))" />
    </ItemGroup>
</Target> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:56:32.720

您可以为这种事情使用项目定义组[http://msdn.microsoft.com/en-us/library/bb629392.aspx](http://msdn.microsoft.com/en-us/library/bb629392.aspx)，但我不太了解您的具体情况。您可能需要根据与平台匹配的项目文件名来设置元数据。

这显示了如何将属性函数与项目元数据一起使用。[对元数据值使用 Item 函数](https://stackoverflow.com/questions/9512577/using-item-functions-on-metadata-values)

# java - SWT UI 线程没有响应 - 打印错误

> ID：13316743
> 
> 赞同：2
> 
> 时间：2012-11-09T22:07:38.423
> 
> 标签：java, swt, awt

![在此处输入图像描述](../Images/7b520a6b6aba13663c707603eb838777.png)

我的 SWT TitleAreaDialog 中有一个打印按钮。

```
viewPDFButton.addSelectionListener(new SelectionAdapter() {
     public void widgetSelected(SelectionEvent e) {
        try {

           startPdfPrintOperation();
        }
        catch (Exception e1) {
           // TODO Auto-generated catch block
           e1.printStackTrace();
        }
     }
  }); 
```

我从表中的用户选择中获取现有的 PDF 文件名和路径。然后我希望将 pdf 文件打印到本地打印机。需要允许用户选择本地打印机。

```
public void startPdfPrintOperation() throws Exception {
  File file = new File(getPDFFileName());
  RandomAccessFile raf;
  raf = new RandomAccessFile(file, "r");
  FileChannel channel = raf.getChannel();
  ByteBuffer buf = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel.size());
  pdfFile = new PDFFile(buf);
  PDFPrintPage pages = new PDFPrintPage(pdfFile);

  // Create Print Job
  pjob = PrinterJob.getPrinterJob();
  pjob.setPrintable(new MyPrintable());
  final HashPrintRequestAttributeSet attset;
  attset = new HashPrintRequestAttributeSet ();
  attset.add (new PageRanges (1, pdfFile.getNumPages ()));
  if (pjob.printDialog (attset)) {
      try {
           pjob.print (attset);
      }
      catch (PrinterException e) {
           e.printStackTrace();
      }
  }             
}
class MyPrintable implements Printable {
  public int print (Graphics g, PageFormat format, int index) throws PrinterException {
     int pagenum = index+1;
        if (pagenum < 1 || pagenum > pdfFile.getNumPages ())
            return NO_SUCH_PAGE;

        Graphics2D g2d = (Graphics2D) g;
        AffineTransform at = g2d.getTransform ();
        PDFPage pdfPage = pdfFile.getPage (pagenum);

        Dimension dim;
        dim = pdfPage.getUnstretchedSize ((int) format.getImageableWidth (),
                                       (int) format.getImageableHeight (),
                                       pdfPage.getBBox ());

        Rectangle bounds = new Rectangle ((int) format.getImageableX (),
                                       (int) format.getImageableY (),
                                       dim.width,
                                       dim.height);

        PDFRenderer rend = new PDFRenderer (pdfPage, (Graphics2D) g, bounds, null, null);

        try
        {
           pdfPage.waitForFinish ();
           rend.run ();
        }
        catch (InterruptedException ie)
        {
           MessageDialog.openError(null, "PDF Error Message", "Needs");
        }
        g2d.setTransform (at);
        g2d.draw (new Rectangle2D.Double (format.getImageableX (),
                                       format.getImageableY (),
                                       format.getImageableWidth (),
                                       format.getImageableHeight ()));
     return PAGE_EXISTS;
  }
} 
```

我从第 315 行收到上述错误

```
if (pjob.printDialog (attset)) { 
```

打印机对话框打开整个应用程序被冻结并且没有响应。然后在大约 30 秒内，我收到上述错误。

我曾尝试 `Display.getDefault().asyncExec(new Runnable() )`在多个地方使用，但没有帮助。

可能是因为基本对话框是 SWT 而打印机对话框是 AWT？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T11:46:15.260

由于您没有定义“在多个位置”，我建议您在其自己的类中重构打印作业，扩展`Thread`并实现在`run`方法中启动打印作业。
我对上面代码中的所有类都不熟悉，你可以尝试简单地启动这个线程，它将与 SWT 线程并行运行。尝试避免共享资源，这可能有助于解决您的僵局。如果您想从该线程获得 UI 响应，您可以将例如 SWT 消息框（“打印完成！”）包装在对`Display.getDefault().asyncExec(new Runnable() { ... }`.
此外，请测试没有UI代码的打印代码是否产生相同的异常。如果是这样，则环境可能配置错误。

# web-applications - 从自定义 URL 协议运行 Mac 应用程序

> ID：13316744
> 
> 赞同：2
> 
> 时间：2012-11-09T22:07:38.430
> 
> 标签：web-applications, url-protocol

我正在尝试创建一种防白痴方法来激活我在 Automator 中构建的应用程序。该应用程序本质上是拍摄图像，将它们裁剪为 4x6 并将它们发送到打印机。

我正在尝试创建一个 html 页面（本地托管），其中包含一个在单击时将运行此应用程序的链接。

我已尝试按照此处提供的说明进行操作：[如何将自定义协议映射到 Mac 上的应用程序？](https://stackoverflow.com/questions/471581/how-to-map-a-custom-protocol-to-an-application-on-the-mac)

但我无法弄清楚如何完成这个。我需要知道在访问自定义 URL 时如何让应用程序“X”运行。

我几乎没有使用 Applescript 或任何其他编程语言的经验。谁能指导我如何为此应用程序创建自定义 URL 处理程序？

谢谢！

# vb6 - 尝试使用 VB6 在文件夹中查找文件的最新日期时遇到问题

> ID：13316749
> 
> 赞同：0
> 
> 时间：2012-11-09T22:07:57.433
> 
> 标签：vb6

我需要在给定目录中找到具有最新日期的文件。我*不是*VB6 的初学者，这就是我需要用于一些旧代码的东西。在下面整天杀死谷歌之后，我到目前为止所拥有的。但它没有找到正确的文件。有人可以帮忙吗？谢谢

```
Dim sFile1  As String
Dim sFile2 As String
Dim dFile1Date As Date
Dim dFile2Date As Date

sFile1 = Dir("c:\test\*.*", vbNormal)

Do
    sFile2 = Dir
    If sFile1 <> "" Then dFile1Date = FileDateTime("c:\test\" & sFile1)
    If sFile2 <> "" Then dFile2Date = FileDateTime("c:\test\" & sFile2)

    If dFile1Date > dFile2Date Then sFile2 = sFile1

Loop Until sFile2 = ""

FormVersionDate = sFile1
Call MsgBox(FormVersionDate, vbExclamation, App.Title) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T00:25:37.903

如果您单步执行您的代码，您会发现`sFile1`无论您的逻辑结果如何，它都不会被重新分配，因此在最后调用它的值会使您的所有 do 循环无关紧要。此外，它看起来`FormVersionDate`可能应该是一个日期，但您却为它分配了一个字符串。

我用嵌套循环重写了你的代码，以避免与过多评论无关的逻辑：

```
Dim sFile1  As String
Dim sFile2 As String
Dim dFile1Date As Date
Dim dFile2Date As Date

'Get first File
sFile1 = Dir("c:\test\*.*", vbNormal)
'Make sure file exists
If sFile1 <> "" Then
    'Since file exists retrieve DateTime for file
    dFile1Date = FileDateTime("c:\test\" & sFile1)
    'begin loop for other files
    Do
        'Retrieve new file
        sFile2 = Dir
        'Make sure file exists
        If sFile2 <> "" Then
            'Retrieve DateTime for file
            dFile2Date = FileDateTime("c:\test\" & sFile2)
            'If old DateTime is older than new DateTime
            If dFile1Date < dFile2Date Then
                'Overwrite first file variables with newer file info
                sFile1 = sFile2
                dFile1Date = dFile2Date
            End If
        End If
        'Loop until new file doesn't exist
    Loop Until sFile2 = ""
End If
'If you actually want the date, you should use dFile1Date instead of sFile1.
FormVersionDate = sFile1
Call MsgBox(FormVersionDate, vbExclamation, App.Title) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T19:32:19.397

尝试通过变量名进行通信有很多话要说。结果通常比添加大量补偿性评论要清晰得多，尤其是在较短的程序中。

```
Dim Directory As String
Dim CurrFile As String
Dim CurrDate As Date
Dim NewestDate As Date
Dim NewestFile As String

Directory = "c:\test\"
CurrFile = Dir$(Directory & "*.*", vbNormal)
Do While Len(CurrFile) > 0
    CurrDate = FileDateTime(Directory & CurrFile)
    If CurrDate > NewestDate Then
        NewestDate = CurrDate
        NewestFile = CurrFile
    End If
    CurrFile = Dir$()
Loop
MsgBox CStr(NewestDate) & vbNewLine & NewestFile 
```

请注意，这不会检测并警告其中没有可见文件的目录。不过，您可以只寻找一个空的 ("") `NewestFile`。

# java - Android OpenGL ES 2.0 上的间歇性慢帧

> ID：13316750
> 
> 赞同：4
> 
> 时间：2012-11-09T22:08:10.007
> 
> 标签：java, android, opengl-es-2.0

我在 Android 上使用 OpenGL ES 2.0 得到一些慢帧。足以使它们在渲染中引起口吃。我已经输入了一些输出到 System.err 这两条信息的行：

1.  过去 60 帧的平均绘制时间（“平均绘制时间：2”）
2.  一帧绘制时间超过 10 毫秒，g = GUI 绘制时间，w = 世界绘制时间（“慢帧！！！（29，g=27，w=2）”）

我在这个问题下面发布了一些示例输出，显示随机慢帧。

即使场景中没有任何变化，也会发生这种情况。什么可能导致这些间歇性慢帧？如果我更深入地了解时间，看看是否有任何东西一直在减慢速度，我什么也看不到。这似乎是随机的。垃圾回收在这个示例输出中只发生了两次，所以我认为 GC 不会是问题。还有什么可能导致这些帧不时花费这么长时间？

```
11-09 13:42:53.768: W/System.err(25924): Avg draw time: 2
11-09 13:42:54.839: W/System.err(25924): Avg draw time: 2
11-09 13:42:55.860: W/System.err(25924): Avg draw time: 2
11-09 13:42:56.881: W/System.err(25924): Avg draw time: 2
11-09 13:42:57.442: D/dalvikvm(25924): GC_CONCURRENT freed 1715K, 62% free 3619K/9379K, paused 1ms+2ms
11-09 13:42:57.912: W/System.err(25924): Avg draw time: 2
11-09 13:42:58.273: W/System.err(25924): Slow frame!!! (29, g=27, w=2)
11-09 13:42:58.924: W/System.err(25924): Avg draw time: 3
11-09 13:42:59.014: W/System.err(25924): Slow frame!!! (19, g=2, w=17)
11-09 13:42:59.955: W/System.err(25924): Avg draw time: 4
11-09 13:43:00.075: W/System.err(25924): Slow frame!!! (28, g=25, w=3)
11-09 13:43:00.445: W/System.err(25924): Slow frame!!! (20, g=9, w=11)
11-09 13:43:01.026: W/System.err(25924): Avg draw time: 4
11-09 13:43:02.037: W/System.err(25924): Avg draw time: 4
11-09 13:43:02.197: W/System.err(25924): Slow frame!!! (16, g=14, w=2)
11-09 13:43:02.227: W/System.err(25924): Slow frame!!! (16, g=4, w=12)
11-09 13:43:03.088: W/System.err(25924): Avg draw time: 5
11-09 13:43:03.218: W/System.err(25924): Slow frame!!! (13, g=8, w=5)
11-09 13:43:03.308: W/System.err(25924): Slow frame!!! (22, g=16, w=6)
11-09 13:43:03.318: W/System.err(25924): Slow frame!!! (14, g=10, w=4)
11-09 13:43:03.348: W/System.err(25924): Slow frame!!! (11, g=8, w=3)
11-09 13:43:04.109: W/System.err(25924): Avg draw time: 4
11-09 13:43:05.030: W/System.err(25924): Slow frame!!! (31, g=29, w=2)
11-09 13:43:05.060: W/System.err(25924): Slow frame!!! (11, g=3, w=8)
11-09 13:43:05.070: W/System.err(25924): Slow frame!!! (15, g=11, w=3)
11-09 13:43:05.150: W/System.err(25924): Avg draw time: 4
11-09 13:43:06.191: W/System.err(25924): Avg draw time: 2
11-09 13:43:07.202: W/System.err(25924): Avg draw time: 1
11-09 13:43:08.243: W/System.err(25924): Avg draw time: 3
11-09 13:43:09.275: W/System.err(25924): Avg draw time: 4
11-09 13:43:09.965: W/System.err(25924): Slow frame!!! (29, g=28, w=1)
11-09 13:43:10.025: D/dalvikvm(25924): GC_CONCURRENT freed 1721K, 62% free 3625K/9379K, paused 3ms+4ms
11-09 13:43:10.296: W/System.err(25924): Avg draw time: 4
11-09 13:43:10.736: W/System.err(25924): Slow frame!!! (14, g=11, w=2)
11-09 13:43:10.756: W/System.err(25924): Slow frame!!! (14, g=3, w=11)
11-09 13:43:10.776: W/System.err(25924): Slow frame!!! (14, g=1, w=13)
11-09 13:43:11.307: W/System.err(25924): Avg draw time: 4
11-09 13:43:11.337: W/System.err(25924): Slow frame!!! (17, g=3, w=14)
11-09 13:43:11.357: W/System.err(25924): Slow frame!!! (14, g=3, w=11)
11-09 13:43:11.387: W/System.err(25924): Slow frame!!! (12, g=2, w=10)
11-09 13:43:11.797: W/System.err(25924): Slow frame!!! (17, g=14, w=3)
11-09 13:43:12.328: W/System.err(25924): Avg draw time: 3
11-09 13:43:13.319: W/System.err(25924): Slow frame!!! (19, g=3, w=16)
11-09 13:43:13.349: W/System.err(25924): Avg draw time: 5
11-09 13:43:13.379: W/System.err(25924): Slow frame!!! (14, g=10, w=4)
11-09 13:43:13.970: W/System.err(25924): Slow frame!!! (14, g=11, w=3)
11-09 13:43:14.410: W/System.err(25924): Avg draw time: 4
11-09 13:43:15.061: W/System.err(25924): Slow frame!!! (12, g=9, w=2)
11-09 13:43:15.081: W/System.err(25924): Slow frame!!! (13, g=3, w=10)
11-09 13:43:15.111: W/System.err(25924): Slow frame!!! (23, g=16, w=6)
11-09 13:43:15.461: W/System.err(25924): Avg draw time: 5
11-09 13:43:16.142: W/System.err(25924): Slow frame!!! (18, g=3, w=15)
11-09 13:43:16.162: W/System.err(25924): Slow frame!!! (14, g=11, w=3)
11-09 13:43:16.482: W/System.err(25924): Avg draw time: 5
11-09 13:43:17.223: W/System.err(25924): Slow frame!!! (17, g=14, w=3)
11-09 13:43:17.243: W/System.err(25924): Slow frame!!! (15, g=4, w=11)
11-09 13:43:17.503: W/System.err(25924): Avg draw time: 5
11-09 13:43:18.054: W/System.err(25924): Slow frame!!! (17, g=9, w=8) 
```

# c# - Visual Studio 2012 中的 Foreach 循环很慢

> ID：13316760
> 
> 赞同：0
> 
> 时间：2012-11-09T22:09:32.703
> 
> 标签：c#, performance, loops, foreach, visual-studio-2012

当我向上迁移时，我遇到了以下循环的性能问题。它最初是用 VS2003 编写的。这个循环在 VS2003 中运行大约需要 20 秒。在 VS2005、VS2008、VS2010 和 VS2012 中，同样的循环需要 5 个小时才能运行。没有代码更改，所有版本都在同一台 PC 上运行。在尝试在 Visual Studio 中向上迁移时，是否有人遇到过这样的性能问题？我已经在以下版本的 Visual Studio 中运行了这个循环，这是我的 h/mm/ss 格式的结果。

```
VS2003    VS2005    VS2008     VS2010    VS2012
0:00:20   9:50:15   20:15:02   8:42:08   4:58:09

//dstPrvTbleSeq has 114881 rows
//dstPrvTbl has 104070 rows                                                             

foreach (DataRow dr in drSeq)
{   // in query PrvLocID is selected as PrvID to match with extract requirements
    DataRow[] drSelect = dstPrvTbl.Tables[0].Select("PrvID=" + dr["PrvID"].ToString() + " and TermDate is null");
    if (drSelect.Length > 0)
    {
        dr.Delete();
    }
    else
    {
        //delete duplicate term record with different fee schedule, only the first sequence fee schedule should show up as term
        DataRow[] drSelect2 = dstPrvTbl.Tables[0].Select("PrvID=" + dr["PrvID"].ToString() + " and TermDate is not null");
        if (drSelect2.Length > 0)
        {
            if (dr["TermDate"].ToString() != "")//if a term record for provider location id is already there and a new term record for another plan code comes across then delete the new one from file
                dr.Delete();
            else if (sPrvFileName.Trim().ToUpper() == "NEPTUNE.TXT" || sPrvFileName.Trim().ToUpper() == "PROV.TXT") //if Neptune file then remove the previous old term record and keep the new active record
            {
                drSelect2[0].Delete();//delete the old term record for neptune file
                dstPrvTbl.AcceptChanges();
            }

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:14:55.020

绝对您的问题与 Microsoft Visual Studio 的版本无关。即使是这样，20秒和2小时之间也存在巨大差异！这根本没有任何意义。我建议您使用探查器等工具检查代码、数据库连接和数据操作，找出真正的问题所在。

希望能帮助到你

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:33:51.767

应该没有那么大的区别。确保您未处于调试模式。发布模式而不是调试运行应该比 VS 中的调试模式更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T22:54:45.903

我认为您使用的 IDE 版本无关紧要。我认为这是您所针对的 .Net Framework 版本的问题。确保您的目标至少是 2.0。1.1 现在已经完全弃用了，天知道你能在其中找到什么样的奇怪错误。

此外，我认为他们没有检查 Visual Studio 2010 或 2012 是否真的可以使用这些古老版本的框架。

# deployment - JBoss AS 7.1.1 将 Web 应用程序部署到 / 时出错

> ID：13316766
> 
> 赞同：2
> 
> 时间：2012-11-09T22:10:15.487
> 
> 标签：deployment, jboss

我开发了一个使用 Mysql 5.1 数据库、Hibernate 4 以及 Servlet 和 JSP 的小型 Web 应用程序。我正在使用 jboss 7.1.1 final 将应用程序部署到。我使用 eclipse 来管理项目和部署。只要我部署到，一切正常，`http://localhost:8080/TimeTracker`但我想尝试部署到“/”而不是 /TimeTracker。所以我禁用了standalone.xml 中的欢迎内容，并在我的WEB-INF 目录中添加了一个jboss-web.xml。这是我的 jboss-web.xml：

```
<jboss-web>
<context-root>/</context-root>
</jboss-web> 
```

这是我的standalone.xml：

```
<?xml version='1.0' encoding='UTF-8'?>

<server xmlns="urn:jboss:domain:1.2">

    <extensions>
        <extension module="org.jboss.as.clustering.infinispan"/>
        <extension module="org.jboss.as.configadmin"/>
        <extension module="org.jboss.as.connector"/>
        <extension module="org.jboss.as.deployment-scanner"/>
        <extension module="org.jboss.as.ee"/>
        <extension module="org.jboss.as.ejb3"/>
        <extension module="org.jboss.as.jaxrs"/>
        <extension module="org.jboss.as.jdr"/>
        <extension module="org.jboss.as.jmx"/>
        <extension module="org.jboss.as.jpa"/>
        <extension module="org.jboss.as.logging"/>
        <extension module="org.jboss.as.mail"/>
        <extension module="org.jboss.as.naming"/>
        <extension module="org.jboss.as.osgi"/>
        <extension module="org.jboss.as.pojo"/>
        <extension module="org.jboss.as.remoting"/>
        <extension module="org.jboss.as.sar"/>
        <extension module="org.jboss.as.security"/>
        <extension module="org.jboss.as.threads"/>
        <extension module="org.jboss.as.transactions"/>
        <extension module="org.jboss.as.web"/>
        <extension module="org.jboss.as.webservices"/>
        <extension module="org.jboss.as.weld"/>
    </extensions>

    <management>
        <security-realms>
            <security-realm name="ManagementRealm">
                <authentication>
                    <properties path="mgmt-users.properties" relative-to="jboss.server.config.dir"/>
                </authentication>
            </security-realm>
            <security-realm name="ApplicationRealm">
                <authentication>
                    <properties path="application-users.properties" relative-to="jboss.server.config.dir"/>
                </authentication>
            </security-realm>
        </security-realms>
        <management-interfaces>
            <native-interface security-realm="ManagementRealm">
                <socket-binding native="management-native"/>
            </native-interface>
            <http-interface security-realm="ManagementRealm">
                <socket-binding http="management-http"/>
            </http-interface>
        </management-interfaces>
    </management>

    <profile>
        <subsystem xmlns="urn:jboss:domain:logging:1.1">
            <console-handler name="CONSOLE">
                <level name="INFO"/>
                <formatter>
                    <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
                </formatter>
            </console-handler>
            <periodic-rotating-file-handler name="FILE">
                <formatter>
                    <pattern-formatter pattern="%d{HH:mm:ss,SSS} %-5p [%c] (%t) %s%E%n"/>
                </formatter>
                <file relative-to="jboss.server.log.dir" path="server.log"/>
                <suffix value=".yyyy-MM-dd"/>
                <append value="true"/>
            </periodic-rotating-file-handler>
            <logger category="com.arjuna">
                <level name="WARN"/>
            </logger>
            <logger category="org.apache.tomcat.util.modeler">
                <level name="WARN"/>
            </logger>
            <logger category="sun.rmi">
                <level name="WARN"/>
            </logger>
            <logger category="jacorb">
                <level name="WARN"/>
            </logger>
            <logger category="jacorb.config">
                <level name="ERROR"/>
            </logger>
            <root-logger>
                <level name="INFO"/>
                <handlers>
                    <handler name="CONSOLE"/>
                    <handler name="FILE"/>
                </handlers>
            </root-logger>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:configadmin:1.0"/>
        <subsystem xmlns="urn:jboss:domain:datasources:1.0">
            <datasources>
                <datasource jndi-name="java:jboss/datasources/ExampleDS" pool-name="ExampleDS" enabled="true" use-java-context="true">
                    <connection-url>jdbc:h2:mem:test;DB_CLOSE_DELAY=-1</connection-url>
                    <driver>h2</driver>
                    <security>
                        <user-name>sa</user-name>
                        <password>sa</password>
                    </security>
                </datasource>
                <drivers>
                    <driver name="h2" module="com.h2database.h2">
                        <xa-datasource-class>org.h2.jdbcx.JdbcDataSource</xa-datasource-class>
                    </driver>
                </drivers>
            </datasources>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:deployment-scanner:1.1">
            <deployment-scanner path="deployments" relative-to="jboss.server.base.dir" scan-interval="5000"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:ee:1.0"/>
        <subsystem xmlns="urn:jboss:domain:ejb3:1.2">
            <session-bean>
                <stateless>
                    <bean-instance-pool-ref pool-name="slsb-strict-max-pool"/>
                </stateless>
                <stateful default-access-timeout="5000" cache-ref="simple"/>
                <singleton default-access-timeout="5000"/>
            </session-bean>
            <pools>
                <bean-instance-pools>
                    <strict-max-pool name="slsb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/>
                    <strict-max-pool name="mdb-strict-max-pool" max-pool-size="20" instance-acquisition-timeout="5" instance-acquisition-timeout-unit="MINUTES"/>
                </bean-instance-pools>
            </pools>
            <caches>
                <cache name="simple" aliases="NoPassivationCache"/>
                <cache name="passivating" passivation-store-ref="file" aliases="SimpleStatefulCache"/>
            </caches>
            <passivation-stores>
                <file-passivation-store name="file"/>
            </passivation-stores>
            <async thread-pool-name="default"/>
            <timer-service thread-pool-name="default">
                <data-store path="timer-service-data" relative-to="jboss.server.data.dir"/>
            </timer-service>
            <remote connector-ref="remoting-connector" thread-pool-name="default"/>
            <thread-pools>
                <thread-pool name="default">
                    <max-threads count="10"/>
                    <keepalive-time time="100" unit="milliseconds"/>
                </thread-pool>
            </thread-pools>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:infinispan:1.2" default-cache-container="hibernate">
            <cache-container name="hibernate" default-cache="local-query">
                <local-cache name="entity">
                    <transaction mode="NON_XA"/>
                    <eviction strategy="LRU" max-entries="10000"/>
                    <expiration max-idle="100000"/>
                </local-cache>
                <local-cache name="local-query">
                    <transaction mode="NONE"/>
                    <eviction strategy="LRU" max-entries="10000"/>
                    <expiration max-idle="100000"/>
                </local-cache>
                <local-cache name="timestamps">
                    <transaction mode="NONE"/>
                    <eviction strategy="NONE"/>
                </local-cache>
            </cache-container>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jaxrs:1.0"/>
        <subsystem xmlns="urn:jboss:domain:jca:1.1">
            <archive-validation enabled="true" fail-on-error="true" fail-on-warn="false"/>
            <bean-validation enabled="true"/>
            <default-workmanager>
                <short-running-threads>
                    <core-threads count="50"/>
                    <queue-length count="50"/>
                    <max-threads count="50"/>
                    <keepalive-time time="10" unit="seconds"/>
                </short-running-threads>
                <long-running-threads>
                    <core-threads count="50"/>
                    <queue-length count="50"/>
                    <max-threads count="50"/>
                    <keepalive-time time="10" unit="seconds"/>
                </long-running-threads>
            </default-workmanager>
            <cached-connection-manager/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jdr:1.0"/>
        <subsystem xmlns="urn:jboss:domain:jmx:1.1">
            <show-model value="true"/>
            <remoting-connector/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:jpa:1.0">
            <jpa default-datasource=""/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:mail:1.0">
            <mail-session jndi-name="java:jboss/mail/Default">
                <smtp-server outbound-socket-binding-ref="mail-smtp"/>
            </mail-session>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:naming:1.1"/>
        <subsystem xmlns="urn:jboss:domain:osgi:1.2" activation="lazy">
            <properties>
                <property name="org.osgi.framework.startlevel.beginning">
                    1
                </property>
            </properties>
            <capabilities>
                <capability name="javax.servlet.api:v25"/>
                <capability name="javax.transaction.api"/>
                <capability name="org.apache.felix.log" startlevel="1"/>
                <capability name="org.jboss.osgi.logging" startlevel="1"/>
                <capability name="org.apache.felix.configadmin" startlevel="1"/>
                <capability name="org.jboss.as.osgi.configadmin" startlevel="1"/>
            </capabilities>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:pojo:1.0"/>
        <subsystem xmlns="urn:jboss:domain:remoting:1.1">
            <connector name="remoting-connector" socket-binding="remoting" security-realm="ApplicationRealm"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:resource-adapters:1.0"/>
        <subsystem xmlns="urn:jboss:domain:sar:1.0"/>
        <subsystem xmlns="urn:jboss:domain:security:1.1">
            <security-domains>
                <security-domain name="other" cache-type="default">
                    <authentication>
                        <login-module code="Remoting" flag="optional">
                            <module-option name="password-stacking" value="useFirstPass"/>
                        </login-module>
                        <login-module code="RealmUsersRoles" flag="required">
                            <module-option name="usersProperties" value="${jboss.server.config.dir}/application-users.properties"/>
                            <module-option name="rolesProperties" value="${jboss.server.config.dir}/application-roles.properties"/>
                            <module-option name="realm" value="ApplicationRealm"/>
                            <module-option name="password-stacking" value="useFirstPass"/>
                        </login-module>
                    </authentication>
                </security-domain>
                <security-domain name="jboss-web-policy" cache-type="default">
                    <authorization>
                        <policy-module code="Delegating" flag="required"/>
                    </authorization>
                </security-domain>
                <security-domain name="jboss-ejb-policy" cache-type="default">
                    <authorization>
                        <policy-module code="Delegating" flag="required"/>
                    </authorization>
                </security-domain>
            </security-domains>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:threads:1.1"/>
        <subsystem xmlns="urn:jboss:domain:transactions:1.1">
            <core-environment>
                <process-id>
                    <uuid/>
                </process-id>
            </core-environment>
            <recovery-environment socket-binding="txn-recovery-environment" status-socket-binding="txn-status-manager"/>
            <coordinator-environment default-timeout="300"/>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:web:1.1" default-virtual-server="default-host" native="false">
            <connector name="http" protocol="HTTP/1.1" scheme="http" socket-binding="http"/>
            <virtual-server name="localhost" enable-welcome-root="false">
                <alias name="example.com"/>
            </virtual-server>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:webservices:1.1">
            <modify-wsdl-address>true</modify-wsdl-address>
            <wsdl-host>${jboss.bind.address:127.0.0.1}</wsdl-host>
            <endpoint-config name="Standard-Endpoint-Config"/>
            <endpoint-config name="Recording-Endpoint-Config">
                <pre-handler-chain name="recording-handlers" protocol-bindings="##SOAP11_HTTP ##SOAP11_HTTP_MTOM ##SOAP12_HTTP ##SOAP12_HTTP_MTOM">
                    <handler name="RecordingHandler" class="org.jboss.ws.common.invocation.RecordingServerHandler"/>
                </pre-handler-chain>
            </endpoint-config>
        </subsystem>
        <subsystem xmlns="urn:jboss:domain:weld:1.0"/>
    </profile>

    <interfaces>
        <interface name="management">
            <inet-address value="${jboss.bind.address.management:127.0.0.1}"/>
        </interface>
        <interface name="public">
            <inet-address value="${jboss.bind.address:127.0.0.1}"/>
        </interface>
        <interface name="unsecure">
            <inet-address value="${jboss.bind.address.unsecure:127.0.0.1}"/>
        </interface>
    </interfaces>

    <socket-binding-group name="standard-sockets" default-interface="public" port-offset="${jboss.socket.binding.port-offset:0}">
        <socket-binding name="management-native" interface="management" port="${jboss.management.native.port:9999}"/>
        <socket-binding name="management-http" interface="management" port="${jboss.management.http.port:9990}"/>
        <socket-binding name="management-https" interface="management" port="${jboss.management.https.port:9443}"/>
        <socket-binding name="ajp" port="8009"/>
        <socket-binding name="http" port="8080"/>
        <socket-binding name="https" port="8443"/>
        <socket-binding name="osgi-http" interface="management" port="8090"/>
        <socket-binding name="remoting" port="4447"/>
        <socket-binding name="txn-recovery-environment" port="4712"/>
        <socket-binding name="txn-status-manager" port="4713"/>
        <outbound-socket-binding name="mail-smtp">
            <remote-destination host="localhost" port="25"/>
        </outbound-socket-binding>
    </socket-binding-group>

</server> 
```

我没有改变任何其他东西。现在，我无法将我的战争部署到 jboss。我收到以下错误（这实际上是一个完整的控制台输出）：

```
13:44:52,031 INFO  [org.jboss.modules] JBoss Modules version 1.1.1.GA
13:44:52,272 INFO  [org.jboss.msc] JBoss MSC version 1.0.2.GA
13:44:52,337 INFO  [org.jboss.as] JBAS015899: JBoss AS 7.1.1.Final "Brontes" starting
13:44:53,365 INFO  [org.xnio] XNIO Version 3.0.3.GA
13:44:53,367 INFO  [org.jboss.as.server] JBAS015888: Creating http management service using socket-binding (management-http)
13:44:53,381 INFO  [org.xnio.nio] XNIO NIO Implementation Version 3.0.3.GA
13:44:53,395 INFO  [org.jboss.remoting] JBoss Remoting version 3.2.3.GA
13:44:53,437 INFO  [org.jboss.as.logging] JBAS011502: Removing bootstrap log handlers
13:44:53,440 INFO  [org.jboss.as.configadmin] (ServerService Thread Pool -- 26) JBAS016200: Activating ConfigAdmin Subsystem
13:44:53,445 INFO  [org.jboss.as.naming] (ServerService Thread Pool -- 38) JBAS011800: Activating Naming Subsystem
13:44:53,449 INFO  [org.jboss.as.security] (ServerService Thread Pool -- 44) JBAS013101: Activating Security Subsystem
13:44:53,450 INFO  [org.jboss.as.clustering.infinispan] (ServerService Thread Pool -- 31) JBAS010280: Activating Infinispan subsystem.
13:44:53,459 INFO  [org.jboss.as.osgi] (ServerService Thread Pool -- 39) JBAS011940: Activating OSGi Subsystem
13:44:53,487 INFO  [org.jboss.as.webservices] (ServerService Thread Pool -- 48) JBAS015537: Activating WebServices Extension
13:44:53,509 INFO  [org.jboss.as.security] (MSC service thread 1-10) JBAS013100: Current PicketBox version=4.0.7.Final
13:44:53,520 INFO  [org.jboss.as.naming] (MSC service thread 1-13) JBAS011802: Starting Naming Service
13:44:53,536 INFO  [org.jboss.as.connector] (MSC service thread 1-12) JBAS010408: Starting JCA Subsystem (JBoss IronJacamar 1.0.9.Final)
13:44:53,688 INFO  [org.jboss.as.mail.extension] (MSC service thread 1-6) JBAS015400: Bound mail session [java:jboss/mail/Default]
13:44:53,741 INFO  [org.jboss.as.connector.subsystems.datasources] (ServerService Thread Pool -- 27) JBAS010403: Deploying JDBC-compliant driver class org.h2.Driver (version 1.3)
13:44:53,765 INFO  [org.jboss.ws.common.management.AbstractServerConfig] (MSC service thread 1-16) JBoss Web Services - Stack CXF Server 4.0.2.GA
13:44:54,157 INFO  [org.jboss.as.server.deployment.scanner] (MSC service thread 1-13) JBAS015012: Started FileSystemDeploymentService for directory C:\jboss-as-7.1.1.Final\standalone\deployments
13:44:54,160 INFO  [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS015014: Re-attempting failed deployment TimeTracker.war
13:44:54,193 INFO  [org.jboss.as.remoting] (MSC service thread 1-16) JBAS017100: Listening on localhost/127.0.0.1:4447
13:44:54,206 INFO  [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) JBAS015003: Found TimeTracker.war in deployment directory. To trigger deployment create a file called TimeTracker.war.dodeploy
13:44:54,208 INFO  [org.jboss.as.remoting] (MSC service thread 1-10) JBAS017100: Listening on /127.0.0.1:9999
13:44:54,216 INFO  [org.apache.coyote.http11.Http11Protocol] (MSC service thread 1-9) Starting Coyote HTTP/1.1 on http-localhost-127.0.0.1-8080
13:44:54,351 INFO  [org.jboss.as.connector.subsystems.datasources] (MSC service thread 1-6) JBAS010400: Bound data source [java:jboss/datasources/ExampleDS]
13:44:54,373 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-4) JBAS015876: Starting deployment of "TimeTracker.war"
13:44:56,558 INFO  [org.jboss.as.connector.deployers.jdbc] (MSC service thread 1-15) JBAS010404: Deploying non-JDBC-compliant driver class com.mysql.jdbc.Driver (version 5.1)
13:44:56,639 INFO  [org.jboss.as] (MSC service thread 1-13) JBAS015951: Admin console listening on http://127.0.0.1:9990
13:44:56,641 ERROR [org.jboss.as] (MSC service thread 1-13) JBAS015875: JBoss AS 7.1.1.Final "Brontes" started (with errors) in 4922ms - Started 344 of 423 services (2 services failed or missing dependencies, 76 services are passive or on-demand)
13:44:56,841 INFO  [org.jboss.as.server] (DeploymentScanner-threads - 2) JBAS015870: Deploy of deployment "TimeTracker.war" was rolled back with failure message {"JBAS014771: Services with missing/unavailable dependencies" => ["jboss.web.deployment.default-host./jboss.web.host.default-hostMissing[jboss.web.deployment.default-host./jboss.web.host.default-host]"]}
13:44:56,957 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-3) JBAS015877: Stopped deployment TimeTracker.war in 115ms
13:44:56,959 INFO  [org.jboss.as.controller] (DeploymentScanner-threads - 2) JBAS014774: Service status report
JBAS014775:    New missing/unsatisfied dependencies:
      service jboss.web.host.default-host (missing) dependents: [service jboss.web.deployment.default-host./] 

13:44:56,964 ERROR [org.jboss.as.server.deployment.scanner] (DeploymentScanner-threads - 1) {"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014771: Services with missing/unavailable dependencies" => ["jboss.web.deployment.default-host./jboss.web.host.default-hostMissing[jboss.web.deployment.default-host./jboss.web.host.default-host]"]}}} 
```

你能帮我解决这个问题吗？

PS：抱歉问了一个很长的问题。我想提供尽可能多的细节。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-12T11:38:14.693

默认虚拟服务器定义存在问题。你有

```
default-virtual-server="default-host" 
```

但是您只有一个定义为“localhost：

```
virtual-server name="localhost" 
```

两者应该是一样的。尝试：

```
<subsystem xmlns="urn:jboss:domain:web:1.1" default-virtual-server="default-host" native="false">
    <connector name="http" protocol="HTTP/1.1" scheme="http" socket-binding="http"/>
    <virtual-server name="default-host" enable-welcome-root="false">
        <alias name="localhost"/>
        <alias name="example.com"/>
    </virtual-server>
</subsystem> 
```

# sql - 有没有办法在 PostgreSQL 查询中定义一个命名常量？

> ID：13316773
> 
> 赞同：60
> 
> 时间：2012-11-09T22:10:34.223
> 
> 标签：sql, postgresql

有没有办法在 PostgreSQL 查询中定义一个命名常量？例如：

```
MY_ID = 5;
SELECT * FROM users WHERE id = MY_ID; 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-11-09T22:58:43.310

这个问题之前已经问过（[How do you use script variables in PostgreSQL?](https://stackoverflow.com/questions/36959/how-do-you-use-script-variables-in-postgresql)）。但是，有时我会使用一个技巧进行查询：

```
with const as (
    select 1 as val
)
select . . .
from const cross join
     <more tables> 
```

也就是说，我定义了一个名为 const 的 CTE，其中定义了常量。然后我可以将它交叉加入到我的查询中，在任何级别上任意次数。当我处理日期并且需要跨许多子查询处理日期常量时，我​​发现这特别有用。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-11-09T23:40:48.960

PostgreSQL 没有内置方法来定义（全局）变量，如 MySQL 或 Oracle。（使用[“自定义选项”](https://www.postgresql.org/docs/current/runtime-config-custom.html)的解决方法有限）。根据您的确切需求，还有其他方法：

### 对于*一个*查询

[您可以在CTE](https://www.postgresql.org/docs/current/queries-with.html)中的查询顶部提供值，例如[@Gordon already provided](https://stackoverflow.com/a/13317274/939860)。

### 全局的、持久的常量：

您可以为此创建一个简单的`IMMUTABLE`函数：

```
CREATE FUNCTION public.f_myid()
  RETURNS int LANGUAGE sql IMMUTABLE PARALLEL SAFE AS
'SELECT 5'; 
```

（[并行安全](https://www.postgresql.org/docs/current/parallel-safety.html)设置仅适用于 Postgres 9.6 或更高版本。）

它必须存在于当前用户*可见*的模式中，即在各自的`search_path`. 就像 schema 一样`public`，默认情况下。如果安全是一个问题，请确保它是`search_path`您的调用中的第一个架构或架构限定它：

```
SELECT public.f_myid(); 
```

对数据库中的所有用户可见（允许访问 schema `public`）。

### *当前会话*的多个值：

```
CREATE TEMP TABLE val (val_id int PRIMARY KEY, val text);
INSERT INTO val(val_id, val) VALUES
  (  1, 'foo')
, (  2, 'bar')
, (317, 'baz');

CREATE FUNCTION f_val(_id int)
  RETURNS text LANGUAGE sql STABLE PARALLEL RESTRICTED AS
'SELECT val FROM val WHERE val_id = $1';

SELECT f_val(2);  -- returns 'baz' 
```

由于 plpgsql 在创建时检查表的存在，因此您需要在创建`val`函数之前创建一个（临时）表 - 即使在会话结束时删除了临时表而函数仍然存在。如果在调用时未找到基础表，该函数将引发异常。

`search_path`临时对象的当前模式在您默认的其余部分之前- 如果没有明确指示。您不能从 中*排除*临时架构`search_path`，但可以先放置其他架构。
夜晚的邪恶生物（具有必要的特权）可能会修补`search_path`并将另一个同名对象放在前面：

```
CREATE TABLE myschema.val (val_id int PRIMARY KEY, val text);
INSERT INTO val(val_id, val) VALUES (2, 'wrong');

SET search_path = myschema, pg_temp;

SELECT f_val(2);  -- returns 'wrong' 
```

这不是什么大威胁，因为只有特权用户才能更改全局设置。其他用户只能为自己的会话执行此操作。考虑手册中有关[使用`SECURITY DEFINER`](https://www.postgresql.org/docs/current/sql-createfunction.html#SQL-CREATEFUNCTION-SECURITY).

硬连线模式通常更简单、更快：

```
CREATE FUNCTION f_val(_id int)
  RETURNS text LANGUAGE sql STABLE PARALLEL RESTRICTED AS
'SELECT val FROM **pg_temp.**val WHERE val_id = $1';
```

更多选项的相关答案：

*   [如何在 Postgres 查询窗口中使用参数测试我的 ad-hoc SQL](https://stackoverflow.com/questions/30179441/how-to-test-my-ad-hoc-sql-with-parameters-in-postgres-query-window/30179814#30179814)

*   [将用户 ID 传递给 PostgreSQL 触发器](https://stackoverflow.com/questions/13172524/passing-user-id-to-postgresql-triggers/13172964#13172964)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-10T03:07:33.650

除了 Gordon 和 Erwin 已经提到的明智选项（临时表、常量返回函数、CTE 等），您还可以（ab）使用 PostgreSQL GUC 机制来创建全局、会话和事务级别的变量。

请参阅[此之前的帖子](https://stackoverflow.com/a/13172964/398670)，其中详细显示了该方法。

我不建议将其用于一般用途，但它在链接问题中提到的狭窄情况下可能很有用，在这种情况下，发帖人想要一种方法来为触发器和函数提供应用程序级用户名。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-05-04T14:27:18.313

我找到了这个解决方案：

```
with vars as (
    SELECT * FROM (values(5)) as t(MY_ID)
)
SELECT * FROM users WHERE id = (SELECT MY_ID FROM vars) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-01-23T08:18:36.843

我发现混合可用的方法是最好的：

*   将变量存储在表中：

```
CREATE TABLE vars (
  id INT NOT NULL PRIMARY KEY DEFAULT 1,
  zipcode INT NOT NULL DEFAULT 90210,
  -- etc..
  CHECK (id = 1)
); 
```

*   创建一个动态函数，它加载表的内容，并使用它来：
    *   重新/创建另一个单独的静态不可变 getter 函数。

```
CREATE FUNCTION generate_var_getter()
RETURNS VOID AS $$
DECLARE
  var_name TEXT;
  var_value TEXT;
  new_rows TEXT[];
  new_sql TEXT;
BEGIN
  FOR var_name IN (
    SELECT columns.column_name
    FROM information_schema.columns
    WHERE columns.table_schema = 'public'
      AND columns.table_name = 'vars'
    ORDER BY columns.ordinal_position ASC
  ) LOOP
    EXECUTE
      FORMAT('SELECT %I FROM vars LIMIT 1', var_name)
      INTO var_value;

    new_rows := ARRAY_APPEND(
      new_rows,
      FORMAT('(''%s'', %s)', var_name, var_value)
    );
  END LOOP;

  new_sql := FORMAT($sql$
    CREATE OR REPLACE FUNCTION var_get(key_in TEXT)
    RETURNS TEXT AS $config$
    DECLARE
      result NUMERIC;
    BEGIN
      result := (
        SELECT value FROM (VALUES %s)
        AS vars_tmp (key, value)
        WHERE key = key_in
      );
      RETURN result;
    END;
    $config$ LANGUAGE plpgsql IMMUTABLE;
  $sql$, ARRAY_TO_STRING(new_rows, ','));

  EXECUTE new_sql;
  RETURN;
END;
$$ LANGUAGE plpgsql; 
```

*   向您的表添加一个更新触发器，以便在您更改其中一个变量后`generate_var_getter()`调用，并`var_get()`重新创建不可变函数。

```
CREATE FUNCTION vars_regenerate_update()
RETURNS TRIGGER AS $$
BEGIN
  PERFORM generate_var_getter();
  RETURN NULL;
END;
$$ LANGUAGE plpgsql; 
```

```
CREATE TRIGGER trigger_vars_regenerate_change
  AFTER INSERT OR UPDATE ON vars
  EXECUTE FUNCTION vars_regenerate_update(); 
```

现在，您可以轻松地将变量保存在表格中，而且还可以获得对它们的极快的不可变访问。两全其美的：

```
INSERT INTO vars DEFAULT VALUES;
-- INSERT 0 1

SELECT var_get('zipcode')::INT; 
-- 90210

UPDATE vars SET zipcode = 84111;
-- UPDATE 1

SELECT var_get('zipcode')::INT;
-- 84111 
```

# c - udp客户端服务器程序c

> ID：13316775
> 
> 赞同：3
> 
> 时间：2012-11-09T22:10:35.073
> 
> 标签：c, sockets, udp

我正在用 C 编写一个简单的客户端和服务器程序。我能够将日期从客户端发送到服务器。但是，我无法从服务器向客户端发送确认。

```
/*******************udpserver.c*****************/
int main(int argc, char *argv[])
{
    /* Variable and structure definitions. */
    int sd, rc;
    struct sockaddr_in serveraddr, clientaddr;
    clientaddrlen = sizeof(clientaddr);
    int serveraddrlen = sizeof(serveraddr);
    char buffer[100];
    char *bufptr = buffer;
    int buflen = sizeof(buffer);

    if((sd = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
        perror("UDP server - socket() error");
        exit(-1);
    }

    printf("UDP server - socket() is OK\n");

    memset(&serveraddr, 0x00, serveraddrlen);
    serveraddr.sin_family = AF_INET;
    serveraddr.sin_port = htons(0);
    serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);
    if((rc = bind(sd, (struct sockaddr *)&serveraddr, serveraddrlen)) < 0) {
        perror("UDP server - bind() error");
        close(sd);
        exit(-1);
    }

    int addr_len = sizeof(serveraddr);
    if (getsockname(sd, (struct sockaddr *) &serveraddr, &addr_len)<0) {
        perror("Error getting socket name.\n");
        return -1;
    }
    printf("Using IP %s and port %d\n", inet_ntoa(serveraddr.sin_addr), ntohs(serveraddr.sin_port));
    printf("UDP server - Listening...\n");

    rc = recvfrom(sd, bufptr, buflen, 0, (struct sockaddr *)&clientaddr, &clientaddrlen);
    if(rc < 0) {
        perror("UDP Server - recvfrom() error");
        close(sd);
        exit(-1);
    }

   printf("UDP Server received the following:\n \"%s\" message\n", bufptr);

   printf("UDP Server replying to the UDP client...\n");
   rc = sendto(sd, bufptr, buflen, 0, (struct sockaddr *)&clientaddr, clientaddrlen);
   if(rc < 0) {
       perror("UDP server - sendto() error");
       close(sd);
       exit(-1);
   }
   printf("UDP Server - sendto() is OK...\n");

   close(sd);
   exit(0);
} 
```

我的 UDPClient 程序：

```
/****************udpclient.c********************/
int main(int argc, char *argv[])
{
    /* Variable and structure definitions. */
    int sd, rc;
    struct sockaddr_in serveraddr, clientaddr;
    int serveraddrlen = sizeof(serveraddr);
    char server[255];
    char buffer[100];
    char *bufptr = buffer;
    int buflen = sizeof(buffer);
    struct hostent *hostp;
    memset(buffer, 0x00, sizeof(buffer));
    /* 36 characters + terminating NULL */
    memcpy(buffer, "Hello! A client request message lol!", 37);

    if((sd = socket(AF_INET, SOCK_DGRAM, 0)) < 0) {
        perror("UDP Client - socket() error");
        exit(-1);
    }
    else
        printf("UDP Client - socket() is OK!\n");

    if(argc != 3) {
        /*Use default hostname or IP*/
        printf("UDP Client - Usage <Server hostname or IP>\n");
        exit(0);
    }

    memset(&serveraddr, 0x00, sizeof(struct sockaddr_in));
    serveraddr.sin_family = AF_INET;
    serveraddr.sin_port = htons(atoi(argv[2]));

    hostp = gethostbyname(argv[1]);
    if(hostp == (struct hostent *)NULL) {
        printf("HOST NOT FOUND --> ");
        printf("h_errno = %d\n", h_errno);
        exit(-1);
    }
    else {
        printf("UDP Client - gethostname() of the server is OK... \n");
        printf("Connected to UDP server\n");
    }
    memcpy(&serveraddr.sin_addr, hostp->h_addr, sizeof(serveraddr.sin_addr));

    rc = sendto(sd, bufptr, buflen, 0, (struct sockaddr *)&serveraddr, sizeof(serveraddr));
    if(rc < 0) {
        perror("UDP Client - sendto() error");
        close(sd);
        exit(-1);
    }
    else
        printf("UDP Client - sendto() is OK!\n");

    printf("Waiting a reply from UDP server...\n");

    rc = recvfrom(sd, bufptr, buflen, 0, (struct sockaddr *)&serveraddr, &serveraddrlen);

    if(rc < 0) {
        perror("UDP Client - recvfrom() error");
        close(sd);
        exit(-1);
    } else {
        printf("UDP client received the following: \"%s\" message\n", bufptr);
    }

    close(sd);
    exit(0);
} 
```

运行这两个程序时，我得到以下输出：

UDP服务器：

```
$ ./UdpServer
UDP server - socket() is OK
Using IP 0.0.0.0 and port 49932
UDP server - Listening...
UDP Server received the following:
"Hello! A client request message lol!" message
UDP Server replying to the UDP client...
UDP Server - sendto() is OK... 
```

UDP客户端：

```
$ ./UdpClient MyPC 49932 
UDP Client - socket() is OK!
UDP Client - gethostname() of the server is OK...
Connected to UDP server
UDP Client - sendto() is OK!
Waiting a reply from UDP server... 
```

UdpClient 程序卡在这一点上。谁能解释一下问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:18:27.610

如果服务器和客户端在同一台机器上运行，请给出

`$ ./UdpClient localhost 49932`

代替

`$ ./UdpClient MyPC 49932`

别的
`$ ./UdpClient <server-IP-address> 49932`

同样在服务器代码中，

`clientaddrlen = sizeof(clientaddr);`
应该
`int clientaddrlen = sizeof(clientaddr);`

但我想这只是一个复制粘贴错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T08:54:46.680

您可能希望使用`select()`使该过程等到数据可供读取：

```
...
{
  fd_set rfds;
  int retval;

  FD_ZERO(&rfds);
  FD_SET(sd, &rfds);

  retval = select(sd+1, &rfds, NULL, NULL, NULL);
  if (retval == -1)
    perror("select()");
  else
    printf("Data is available for reading now.\n");

  ...
}
... 
```

# apache-zookeeper - Zookeeper 连接错误

> ID：13316776
> 
> 赞同：38
> 
> 时间：2012-11-09T22:10:44.403
> 
> 标签：apache-zookeeper

我们在开发机器上有一个独立的 Zookeeper 设置。它适用于除这台 testdev 机器之外的所有其他开发机器。

尝试通过 testdev 连接到 zookeeper 时，我们一遍又一遍地收到此错误：

```
2012-11-09 14:06:53,909 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@947] - Socket connection established to zk01.dev.bunchball.net/192.168.8.58:2181, initiating session
2012-11-09 14:06:53,911 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@1183] - Unable to read additional data from server sessionid 0x0, likely server has closed socket, closing socket connection and attempting reconnect
2012-11-09 14:06:55,366 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@1058] - Opening socket connection to server zk01.dev.bunchball.net/192.168.8.58:2181
2012-11-09 14:06:55,368 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@947] - Socket connection established to zk01.dev.bunchball.net/192.168.8.58:2181, initiating session
2012-11-09 14:06:55,368 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@1183] - Unable to read additional data from server sessionid 0x0, likely server has closed socket, closing socket connection and attempting reconnect
2012-11-09 14:06:57,271 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@1058] - Opening socket connection to server zk01.dev.bunchball.net/192.168.8.58:2181
2012-11-09 14:06:57,274 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@947] - Socket connection established to zk01.dev.bunchball.net/192.168.8.58:2181, initiating session
2012-11-09 14:06:57,275 - INFO  [main-SendThread(zk01.dev.bunchball.net:2181):ClientCnxn$SendThread@1183] - Unable to read additional data from server sessionid 0x0, likely server has closed socket, closing socket connection and attempting reconnect 
```

我们尝试重新启动测试开发机器，并重新启动 Zookeeper 主机，但没有任何效果。我们完全困惑为什么它可以与除这台以外的其他机器完美配合。这可能是什么原因？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-22T14:10:29.093

我的情况和你一样，我刚刚解决了这个问题。

这是您配置偶数个zookeeper直接导致此问题的原因，尝试将您的zookeeper节点数更改为奇数。

例如我的zookeeper集群的原始状态是由4个节点组成，然后只删除其中一个，导致节点数为3，现在可以启动zookeeper集群了

下面是成功连接到 Zookeeper 服务器的输出

```
2013-04-22 22:07:05,654 [myid:] - INFO  [main:ZooKeeper@438] - Initiating client connection, connectString=localhost:2181 sessionTimeout=30000 watcher=org.apache.zookeeper.ZooKeeperMain$MyWatcher@1321ed6
Welcome to ZooKeeper!
2013-04-22 22:07:05,704 [myid:] - INFO  [main-SendThread(localhost:2181):ClientCnxn$SendThread@966] - Opening socket connection to server localhost/127.0.0.1:2181\. Will not attempt to authenticate using SASL (unknown error)
JLine support is enabled
2013-04-22 22:07:05,727 [myid:] - INFO  [main-SendThread(localhost:2181):ClientCnxn$SendThread@849] - Socket connection established to localhost/127.0.0.1:2181, initiating session
[zk: localhost:2181(CONNECTING) 0] 2013-04-22 22:07:05,846 [myid:] - INFO  [main-SendThread(localhost:2181):ClientCnxn$SendThread@1207] - Session establishment complete on server localhost/127.0.0.1:2181, sessionid = 0x13e3211c06e0000, negotiated timeout = 30000 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-11-07T05:39:16.283

我遇到了同样的问题，发现这是由于 Zookeeper 集群节点需要打开端口才能相互通信。

```
server.1=xx.xx.xx.xx:2888:3888

server.2=xx.xx.xx.xx:2888:3888

server.3=xx.xx.xx.xx:2888:3888 
```

一旦我通过 aws 安全组允许这些端口并重新启动。一切对我来说都很好

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-29T01:55:44.973

I have just solved the problem. I am using centos 7\. And the trouble-maker is firewall.Using "systemctl stop firewalld" to shut it all down in each server can simply solve the problem.Or you can use command like

```
firewall-cmd --zone=public --add-port=2181/udp --add-port=2181/tcp --permanent" to configure all three ports ,include 2181,2888,3888 in each server.And then "firewall-cmd --reload 
```

Finally use

```
zkServer.sh restart 
```

to restart your servers and problem solved.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-30T01:16:54.057

就我而言，我像这样配置 zoo.cfg：

```
server.1=host-1:2888:3888
server.2=host-2:2888:3888
server.3=host-3:2888:3888 
```

但是，在 host-1 中，我在 /etc/hosts 中将 host-1 解析为 127.0.0.1：

```
127.0.0.1   localhost host-1 
```

这可能会导致其他主机无法与其通信。将 host-1 解析为其真实 ip 解决了这个问题。

希望这能有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-07T17:12:29.003

在 2 节点集群上设置期间出现相同的错误。我发现我混淆了 myid 文件的内容与 server.id=HOST_IP:port 条目。

本质上，如果您有两台服务器（SERVER1 和 SERVER2），您在 dataDir 中为 zookeeper 创建了“myid”文件，如下所示

```
SERVER1 (myid)
1

SERVER2 (myid)
2 
```

确保您的 zoo.cfg 文件中的条目对应于其中的每一个，即 server.1 应使用 SERVER1 主机名，server.2 应使用 SERVER2 主机名后跟端口，如下所示

```
SERVER1 (zoo.cfg)
... (other config omitted)
server.1=SERVER1:2888:3888
server.2=SERVER2:2888:3888

SERVER2 (zoo.cfg)
... (other config omitted)
server.1=SERVER1:2888:3888
server.2=SERVER2:2888:3888 
```

为了确保，我还删除了 dataDir 中的 version-* 文件夹，然后重新启动 Zookeeper 以使其正常工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-07T22:46:59.707

我也遇到了这个问题，结果我告诉zookeeper连接到错误的端口。您是否验证过 Zookeeper 确实在开发机器上的 2181 端口上运行？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-09-12T21:43:19.020

当我尝试使用 A 记录指向 Zookeeper IP 将代理与 Zookeeper 集成连接时，我遇到了同样的错误。问题出在我的动物园管理员身上。我的动物园管理员无法绑定到端口 2181，因为我将 A 记录指向公共 IP。这阻止了 zookeeper 集合选择领导者并相互通信。将 A 记录指向私有 IP 使 zookeeper 集群能够选择领导者，并且集群变得活跃。在此之后，当我尝试将我的一个经纪人连接到合奏时，它连接成功。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-05T11:57:20.863

我的情况和你一样，我刚刚解决了这个问题。

我`conf/zoo.cfg`就是这样：

```
server.1=10.194.236.32:2888:3888
server.2=10.194.236.33:2888:3888
server.3=10.208.177.15:2888:3888
server.4=10.210.154.23:2888:3888
server.5=10.210.154.22:2888:3888 
```

然后我`data/myid`像这样设置文件内容：

```
1      //at host  10.194.236.32
2      //at host  10.194.236.33
3      //at host  10.208.177.15
4      //at host  10.210.154.23
5      //at host  10.210.154.22 
```

最后重启zookeeper

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-06-13T20:53:10.257

还要检查本地防火墙、 **服务防火墙状态**

如果它正在运行，只需停止它 **service firewalld stop**

然后试一试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-05-07T14:15:02.250

我也有这个问题，我发现我只需要重新启动zookeeper，然后重新启动tomcat，这样我的webapp就可以很好地连接了

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-05-28T03:53:04.110

我能够从 zookeeper 和 kafka 开始，每个节点都有 2 个节点。我收到错误是因为我使用 ./zkServer.sh 而不是 kafka 包装器 bin/zookeeper-server-start.sh config/zookeeper.properties 启动了 zookeeper

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-07-31T08:53:46.330

确保所有必需的服务都在运行

**第 1 步：检查 hbase-master 是否正在运行**

```
sudo /etc/init.d/hbase-master status 
```

如果没有，那就开始吧`sudo /etc/init.d/hbase-master start`

**第 2 步：检查 hbase-regionserver 是否正在运行**

```
sudo /etc/init.d/hbase-regionserver status 
```

如果没有，那就开始吧`sudo /etc/init.d/hbase-regionserver start`

**第 3 步：检查 zookeeper-server 是否正在运行**

```
sudo /etc/init.d/zookeeper-server status 
```

如果没有，那就开始吧`sudo /etc/init.d/zookeeper-server start`

**或者干脆连续运行这 3 个命令。**

```
sudo /etc/init.d/hbase-master restart
sudo /etc/init.d/hbase-regionserver restart
sudo /etc/init.d/zookeeper-server restart 
```

之后不要忘记检查状态

```
sudo /etc/init.d/hbase-master status
sudo /etc/init.d/hbase-regionserver status
sudo /etc/init.d/zookeeper-server status 
```

你可能会发现 zookeeper 仍然没有运行：那么你可以运行 zookeeper

```
sudo /usr/lib/zookeeper/bin/zkServer.sh stop
sudo /usr/lib/zookeeper/bin/zkServer.sh start 
```

之后再次检查状态并确保其正在运行

```
sudo /etc/init.d/zookeeper-server status 
```

这应该有效。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-11-19T12:22:49.950

我在我的机器上启动独立实例，并遇到同样的问题。最后，我将ip“127.0.0.1”更改为“localhost”，问题就消失了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-08-03T15:32:42.913

检查 zookeeper 日志（/var/log/zookeeper）。看起来已经建立了连接，这应该意味着有它的记录。

我遇到了同样的情况，这是因为一个进程打开了连接但未能关闭它们。这最终超过了每台主机的连接限制，我的日志充满了

```
2016-08-03 15:21:13,201 [myid:] - WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181:NIOServerCnxnFactory@188] - Too many connections from /172.31.38.64 - max is 50 
```

假设 zookeeper 在通常的端口上，您可以通过以下方式进行检查：

```
lsof -i -P | grep 2181 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-04-04T14:49:14.527

我上周也遇到了这个问题，现在已经设法解决了。我从@gukoff 分享的回复中得到了解决这个问题的想法。

我的要求和情况与迄今为止分享的略有不同，但问题基本相同，所以我想在这个线程上分享它。

我实际上是在尝试从我的应用程序中查询 zookeeper quorum（每 30 秒后）以获取一些信息，并且为此目的使用了[Curator 框架（](https://curator.apache.org/) [LeaderLatch](https://curator.apache.org/apidocs/org/apache/curator/framework/recipes/leader/LeaderLatch.html)类中可用的方法）。所以，基本上我正在启动一个[CuratorFramework](https://curator.apache.org/apidocs/org/apache/curator/framework/package-summary.html)客户端并将其提供给[LeaderLatch](https://curator.apache.org/apidocs/org/apache/curator/framework/recipes/leader/LeaderLatch.html)对象。

只有在我遇到这个线程中提到的错误之后 - 我才意识到我没有关闭在我的应用程序中建立的 zookeeper 客户端连接。该`maxClientCnxns`属性的值为 60，一旦连接数（所有这些都是过时的连接）达到 60，我的应用程序就开始抱怨此错误。

我通过以下方式了解了打开的连接数：

1.  检查 Zookeeper 日志，其中有警告消息指出“来自 {IP 地址的主机} 的连接太多”

2.  `netstat`从运行我的应用程序的上述日志中提到的同一主机运行以下命令：

> 网络统计-否 | grep :2181 | wc -l

**注意**：2181 端口是 zookeeper 的默认端口，作为 grep 中的参数提供以匹配 zookeeper 连接。

为了解决这个问题，我手动清除了所有这些陈旧的连接，然后在我的应用程序中添加了用于优雅地关闭 zookeeper 客户端连接的代码。

我希望这有帮助！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-08-28T12:17:48.510

如果打开的连接太多，就会发生这种情况。

尝试增加`maxClientCnxns`设置。

从[文档](https://zookeeper.apache.org/doc/r3.2.2/zookeeperAdmin.html)：

> maxClientCnxns（无 Java 系统属性）
> 
> 限制由 IP 地址标识的单个客户端可以与 ZooKeeper 集合的单个成员建立的并发连接数（在套接字级别）。这用于防止某些类别的 DoS 攻击，包括文件描述符耗尽。将此设置为 0 或完全忽略它会消除对并发连接的限制。

您可以在配置文件中编辑设置。很可能可以在`/etc/zookeeper/conf/zoo.cfg`.

在现代 ZooKeeper 版本中，默认值为 60。您可以通过`maxClientCnxns=4096`在配置文件末尾添加该行来增加它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-09-02T10:50:12.943

我也遇到了同样的问题。就我而言，问题在于 iptables 规则。

为了与zookeeper节点通信，2181端口必须接受传入请求，对于zookeeper节点之间的内部通信，2888,3888端口必须为传入请求打开。

```
iptables -t nat -I PREROUTING -p tcp -s 10.0.0.0/24 --dport 2181 -j DNAT --to-destination serverIp:2181
iptables -t nat -I PREROUTING -p udp -s 10.0.0.0/24 --dport 2181 -j DNAT --to-destination serverIp:2181

iptables -t nat -I PREROUTING -p tcp -s 10.0.0.0/24 --dport 2888 -j DNAT --to-destination serverIp:2888
iptables -t nat -I PREROUTING -p udp -s 10.0.0.0/24 --dport 2888 -j DNAT --to-destination serverIp:2888

iptables -t nat -I PREROUTING -p tcp -s 10.0.0.0/24 --dport 3888 -j DNAT --to-destination serverIp:3888
iptables -t nat -I PREROUTING -p udp -s 10.0.0.0/24 --dport 3888 -j DNAT --to-destination serverIp:3888

sudo service iptables save 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-03-19T04:16:31.087

在 /etc/hosts 文件中只为您的主机 IP 留下一个条目，它已解决。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-08-20T03:41:12.560

当我启动复制的 zk 时，我也遇到了同样的错误，其中一个 zkClient 无法连接到 localhost:2181，我检查了 apache-zookeeper-3.5.5-bin/logs 目录下的日志文件，发现了这个：

> 2019-08-20 11:30:39,763 [myid:5] - WARN [QuorumPeermyid=5(secure=disabled):QuorumCnxManager@677] - 无法在选举地址/xxxx:3888 java.net.SocketTimeoutException 处打开通道 3：在 java.net 的 java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206) 的 java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) 的 java.net.PlainSocketImpl.socketConnect(Native Method) 连接超时。 AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392) at java.net.Socket.connect(Socket.java:589) at org.apache.zookeeper.server.quorum .QuorumCnxManager.connectOne(QuorumCnxManager.java:648) 在 org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:705) 在 org.org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:910) 在 org.apache.zookeeper.server.quorum 的 apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:733)。 QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,768 [myid:5] - 警告 [QuorumPeermyid=5(secure=disabled):QuorumCnxManager@677] - 无法在选举地址打开通道 4 /xxxxxx:3888 java.net.SocketTimeoutException: 在 java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350) 在 java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl) 的 java.net.PlainSocketImpl.socketConnect(Native Method) 连接超时.java:206) 在 java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188) 在 java.net.SocksSocketImpl。在 org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:648) 在 org.apache.zookeeper 的 java.net.Socket.connect(Socket.java:589) 连接(SocksSocketImpl.java:392) .server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:705) 在 org.apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:733) 在 org.apache.zookeeper.server.quorum.FastLeaderElection.lookForLeader (FastLeaderElection.java:910) at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,769 [myid:5] - 信息 [QuorumPeermyid=5(安全=禁用）：FastLeaderElection@919] - 通知超时：51200648) 在 org.apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:733) 在 org.apache.zookeeper .server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:910) at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,769 [myid:5 ] - 信息 [QuorumPeermyid=5(secure=disabled):FastLeaderElection@919] - 通知超时：51200648) 在 org.apache.zookeeper.server.quorum.QuorumCnxManager.connectAll(QuorumCnxManager.java:733) 在 org.apache.zookeeper .server.quorum.FastLeaderElection.lookForLeader(FastLeaderElection.java:910) at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,769 [myid:5 ] - 信息 [QuorumPeermyid=5(secure=disabled):FastLeaderElection@919] - 通知超时：51200zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,769 [myid:5] - 信息 [QuorumPeermyid=5(secure=disabled):FastLeaderElection@919] - 通知时间出：51200zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:1247) 2019-08-20 11:30:44,769 [myid:5] - 信息 [QuorumPeermyid=5(secure=disabled):FastLeaderElection@919] - 通知时间出：51200

这意味着这个zk服务器无法连接到其他服务器，我发现这个服务器ping其他服务器失败，从副本中删除这个服务器后，问题解决了。

希望这会有所帮助。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-11-30T00:13:13.807

如果 Zookeeper 服务器未运行或不再运行（即它在您启动后崩溃），这是一个常见问题。

因此，首先，检查您是否正在运行 Zookeeper 服务器。一个简单的检查方法是 grep 正在运行的进程：

```
# ps -ef | grep zookeeper 
```

（运行几次以查看相同的进程 ID 是否仍然存在。它可能会继续使用新的进程 ID 重新启动。或者，如果您的 Linux 发行版支持 systemd，您可以使用“systemctl status zookeeper”）

您应该看到该进程作为 java 进程运行：

```
# ps -ef | grep zookeeper
root       492     0  0 00:01 pts/1    00:00:00 java -Dzookeeper.log.dir=. -Dzookeeper.root.logger=INFO,CONSOLE -cp /root/zookeeper-3.5.0-alpha/bin/../build/classes:/root/zookeeper-3.5.0-alpha/bin/../build/lib/*.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/slf4j-log4j12-1.7.5.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/slf4j-api-1.7.5.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/servlet-api-2.5-20081211.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/netty-3.7.0.Final.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/log4j-1.2.16.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/jline-2.11.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/jetty-util-6.1.26.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/jetty-6.1.26.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/javacc.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/jackson-mapper-asl-1.9.11.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/jackson-core-asl-1.9.11.jar:/root/zookeeper-3.5.0-alpha/bin/../lib/commons-cli-1.2.jar:/root/zookeeper-3.5.0-alpha/bin/../zookeeper-3.5.0-alpha.jar:/root/zookeeper-3.5.0-alpha/bin/../src/java/lib/*.jar:/root/zookeeper-3.5.0-alpha/bin/../conf: -Xmx1000m -Xmx1000m -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false org.apache.zookeeper.server.quorum.QuorumPeerMain /root/zookeeper-3.5.0-alpha/bin/../conf/zoo.cfg 
```

如果它不存在，那么 zookeeper 日志文件中可能有一些东西表明了这个问题。

要查找 zookeeper 日志文件，您应该首先确定其配置日志的位置。在我的情况下，我在我的根目录下安装了 zookeeper（不建议你安装它）：

```
[root@centos6_zookeeper conf]# pwd
/root/zookeeper-3.5.0-alpha/conf 
```

您可以在此文件中找到日志设置：

```
[root@centos6_zookeeper conf]# grep "zookeeper.log" log4j.properties 
zookeeper.log.dir=/var/log
zookeeper.log.file=zookeeper.log
zookeeper.log.threshold=INFO
zookeeper.log.maxfilesize=256MB
zookeeper.log.maxbackupindex=20 
```

所以 Zookeeper 被配置为在 /var/log 下登录。

然后通常有一个 zookeeper.log 和/或 zookeeper.out 文件，它应该指示您的启动错误。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-01-27T16:41:45.680

如果一个或多个 ZooKeeper 磁盘**空间不足，**即使 ZooKeeper 服务器启动并运行并且套接字打开并接受连接，也会发生这种情况。如果从不清理旧的 ZK 快照和日志文件，则很容易发生这种情况：

> ZooKeeper 服务器创建快照和日志文件，但从不删除它们。数据和日志文件的保留策略在 ZooKeeper 服务器之外实现。服务器本身只需要最新的完整模糊快照、它之后的所有日志文件以及它之前的最后一个日志文件。后一个要求是必要的，以包括在此快照启动后发生但当时进入现有日志文件的更新。这是可能的，因为在 ZooKeeper 中，日志的快照和翻转在某种程度上是独立进行的。有关设置保留策略和维护 ZooKeeper 存储的更多详细信息，请参阅本文档中的维护部分。

可以运行维护作业来清理旧快照和日志文件：请参阅[https://zookeeper.apache.org/doc/r3.4.12/zookeeperAdmin.html#sc_maintenance](https://zookeeper.apache.org/doc/r3.4.12/zookeeperAdmin.html#sc_maintenance)。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-04-10T08:10:32.553

无法从服务器 sessionid 0x0 读取其他数据，可能服务器已关闭套接字、关闭套接字连接并尝试重新连接 (org.apache.zookeeper.ClientCnxn)

我只更改了 zoo.cfg 文件中的 broker 数量并重新启动 zookeeper 和 kafka 服务

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-06-30T14:01:12.663

我遇到了同样的问题，我使用的是 Windows 10。在我的 zookeeper 属性文件中添加以下提到的行后，我的问题得到了解决。

```
tickTime=2000
initLimit=5
syncLimit=2 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2017-05-19T08:18:03.523

刚才我解决了同样的问题并发表了[一篇博客](http://www.cnblogs.com/elsonwe/p/6879015.html)。

简而言之，如果 xx 的 zoo.cfg 像：

```
server.1=xx:2888:3888
server.2=yy:2888:3888
server.3=zz:2888:3888 
```

那么xx的myid=1是必须的

# r - R for循环中的变量

> ID：13316778
> 
> 赞同：0
> 
> 时间：2012-11-09T22:11:02.887
> 
> 标签：r, for-loop

我在 R 中运行一个循环来查找向量的索引，当它的元素等于参考向量的元素时。

据我所知，我需要在 for 循环之前声明变量，但在这种情况下，我不知道索引向量的最终长度（参见下面的代码）。如何创建允许 R 在 for 循环期间更改其大小的变量？

我的代码摘录：

```
k <- 1
for(i in 1:length(Lid.time)){
  ind <- which(Net.time==Lid.time[i])
  if(length(ind)>0){
    ind.Net[k] <- ind
    k <- k+1
  }
} 
```

关于代码的注释： Lid.time 是一个与 Net.time 长度不同的向量。我需要找到一个索引数组来告诉我 Net.time 等于 Lid.time 的位置。事先不知道ind.Net这个向量会有多长，那么如何声明这个向量ind.Net呢？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:26:34.100

As Dason stated, `match` will work just fine for that specific task:

```
>a <- seq(2,20,2)
   #[1]  2  4  6  8 10 12 14 16 18 20
>b <- c(4,14,18)
>match(b,a)
   #[1] 2 7 9  # The indices!
>a %in% b #shorthand logical version of match
   #[1] FALSE  TRUE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE 
```

But to answer your question of a vector of unknown length within a loop:

```
Vector <- c()
for(i in sample(1:100,20)) {
    if(i<50) {Vector <- append(Vector, i)}
    }
length(HowLongIsThisVector) 
```

It will be different every time you run it because of `sample`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:14:15.650

不需要循环，因为它听起来像`match`你想要的。

```
a <- 1:10
b <- c(2, 7, 9)
match(a, b)
# [1] NA  1 NA NA NA NA  2 NA  3 NA 
```

# spring-security - 将 Google API 与 spring-security-oauth2.0 一起使用

> ID：13316783
> 
> 赞同：5
> 
> 时间：2012-11-09T22:11:25.587
> 
> 标签：spring-security, google-api, oauth-2.0, google-calendar-api

我在这里搜索了一下，但找不到我的问题的答案。

我使用**spring-sec-oAuth 2.0** (1.0.0.RC2a) 实现 oAuth 客户端。正确设置 beans.xml 后，我很高兴得到一个有效的令牌，一切看起来都很好。然后，我想使用日历 API——我不确定如何调用来获取日历对象。

我的（相关）设置：（spring-servlet.xml）

```
<!--apply the oauth client context-->
<oauth:client   id="oauth2ClientFilter" />

<oauth:resource id="google" 
    type="authorization_code" 
    client-id="<my client id>" 
    client-secret="<my client secret>"
    access-token-uri="https://accounts.google.com/o/oauth2/token" 
    user-authorization-uri="https://accounts.google.com/o/oauth2/auth"
    scope="https://www.googleapis.com/auth/calendar"
    client-authentication-scheme="form"
    pre-established-redirect-uri="https://ohad.sealdoc.com/oauth2-client/hello" />

<bean id="googleClientService" class="com...GoogleClientServiceImpl">
    <property name="butkeDemoRestTemplate">
        <oauth:rest-template resource="google" />
    </property> 
```

和实现类：

```
public class GoogleClientServiceImpl implements DemoService 
{
    private RestOperations butkeDemoRestTemplate;

    @Override
    public String getTrustedMessage() 
    {
        String dataUri = "https://www.googleapis.com/calendar/v3/users/me/calendarList?minAccessRole=writer";

        Calendar service = butkeDemoRestTemplate.getForObject(dataUri, Calendar.class);
        return "demo";
    }

} 
```

这样做的结果是：

> 请求处理失败；嵌套异常是 error="invalid_request", error_description="{errors=[{domain=usageLimits, reason=accessNotConfigured, message=Access Not Configured}], code=403, message=Access Not Configured}"

毫无疑问，我在“getTrustedMessage()”中做错了，所以我听说要咨询专家……我确实想使用 OAuth2RestTemplate，但我怎么知道我应该使用的 URI？搜索（谷歌）后，我只找到了谷歌代码的例子，他们使用谷歌 oAuth（我不想使用 - 我宁愿为我的客户使用 Spring 实现）

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T18:30:13.357

**知道了！**

我已经解决了这个问题（得到“403，消息=访问未配置”的事情），只需[在“服务”下的 Google API 控制台](https://code.google.com/apis/console/#project:996986975307%3aservices)中启用特定服务......

# google-chrome - Highcharts - 工具提示和系列名称不在 chrome 中

> ID：13316784
> 
> 赞同：2
> 
> 时间：2012-11-09T22:11:28.180
> 
> 标签：google-chrome, highcharts

我正在使用 highcharts 2.3.3，并使用以下代码来描述图表的工具提示。

```
tooltip: {
    formatter: function() {
        return '<b>' + Highcharts.dateFormat('%b %e, %Y', this.x) + '</b><br/>'+ this.y;
    }
}, 
```

工具提示在 Firefox 中没有问题，但在 chrome 中，文本显示在工具提示框中。我也有这个系列名称的问题。这个名字是开箱即用的。有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T08:15:08.787

如果它不起作用，您可以将工具提示的 useHTML 属性设置为 ture，

```
 tooltip:{
      useHTML:true
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-10T07:04:04.607

实际上问题在于我的 html 文件是从右到左的。我在图表 div 中添加了从左到右的类和方向，现在一切正常。

# python - .get 函数上的 Python tkinker 3.0 NoneType 错误

> ID：13316786
> 
> 赞同：1
> 
> 时间：2012-11-09T22:11:41.490
> 
> 标签：python, nonetype

我一直在调查`tkinker`。每当我使用该`get()`函数从文本框中获取信息时，都会出现错误。当我使用该`focus_set()`功能时，我也会遇到同样的错误。

这是我的代码：

```
from tkinter import *

root = Tk()
root.title("Super Awsome Mega Pi")

Label(root, text="What's Your Name?", fg="red").pack()

def destroy():
root.destroy()

def button2():
    name = str(input1.get())
    print(name)

n = Button(root, text="Enter", command = button2).pack(side=LEFT)

input1 = Entry(root).pack(side=LEFT)

q = Button(root, text="Quit", command = destroy).pack(side=LEFT)

input1.focus_set()

def color():
    root["bg"] = input1.get()

c = Button(root, text="Change Color", command = color).pack()

root.mainloop() 
```

任何帮助都会很棒。我知道这是我编写的代码，而不是其他任何东西。如果有帮助，这是它抛出的错误：

```
Exception in Tkinter callback
Traceback (most recent call last):
  File "C:\Python33\lib\tkinter\__init__.py", line 1442, in __call__
    return self.func(*args)
  File "C:/Users/Kie/Documents/Computing/tkinter test.py", line 12, in button2
    name = str(input1.get())
AttributeError: 'NoneType' object has no attribute 'get' 
```

# php - 将文本插入和更新到 sql

> ID：13316791
> 
> 赞同：0
> 
> 时间：2012-11-09T22:12:14.403
> 
> 标签：php, mysql, sql-update

除了将新文本更新到数据库之外，我的页面似乎工作正常。每次我点击提交它只是把它带回原始数据。请让我知道成功查询旧数据和更新新数据缺少什么。

```
if (isset($_POST["submit"]) && $_POST["submit"] == "Update Load")
{
    for ($count = 1; $count <= 6; $count++)
    {
        $fields[$count] = "";
        if (isset($_POST["field" . $count . ""]))
        {
            $fields[$count] = trim($_POST["field" . $count . ""]);
            //echo $fields[$count] . "<br />";
        }
    }

    $con = mysql_connect("", "", "");
    mysql_select_db("", $con);

    $carriername = mysql_real_escape_string($_POST['carriername']);
    $contact = mysql_real_escape_string($_POST['contact']);
    $phone = mysql_real_escape_string($_POST['phone']);
    $rating = mysql_real_escape_string($_POST['rating']);
    $info = mysql_real_escape_string($_POST['info']);

    $insert = "UPDATE carrierinfo Set `carriername` = '$carriername', `contact` = '$contact', `phone` = '$phone', `rating` = '$rating', `info` = '$info'  WHERE `id` = '$id';";
    mysql_query($insert) or die(mysql_error());

    $select = "SELECT `carriername` ,`contact` ,`phone` ,`rating` ,`info` ,`id` FROM `carrierinfo` ORDER BY `carriername` DESC;";
    $result = mysql_query($select) or die(mysql_error());
}
 if ($rating == "")
    {
    $rating = "3";
    }
if (isset($_GET["id"]))
{
    $con = mysql_connect("", "", "");
    mysql_select_db("", $con);
    $id = mysql_real_escape_string($_GET["id"]);
    $select = "SELECT * FROM `carrierinfo` WHERE `id` = '$id'";
    $result = mysql_query($select) or die(mysql_error());
    $fields = mysql_fetch_array($result, MYSQL_BOTH);
    mysql_close($con);
}
else
{
    header("Location:board.php");
}
?>
</script>
<style ="text-align: center; margin-left: auto; margin-right: auto;"></style>
</head>
<body>
<div
 style="border: 2px solid rgb(0, 0, 0); margin: 16px 20px 20px; width: 400px; background-color: rgb(236, 233, 216); text-align: center; float: left;">
<form action="" method="post";">
  <div
  style="margin: 8px auto auto; width: 300px; font-family: arial; text-align: left;"><br>
  <table style="font-weight: normal; width: 100%; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
   <table
 style="font-weight: normal; width: 100%; text-align: right; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
    <tbody>
      <tr>
              <td style="width: 35%;">Carrier Name:</td><td><input id="carriername" name="carriername" maxlength="50" style="width: 100%;" type="text" value="<?php echo $fields[carriername]; ?>">
                    </tr>
        <tr>
              <td style="width: 35%;">Contact:</td><td><input id="contact" name="contact" maxlength="50" style="width: 100%;" type="text" value="<?php echo $fields[contact]; ?>">
                    </tr>
        <tr>
              <td style="width: 35%;">Phone:</td><td><input id="phone" name="phone" maxlength="50" style="width: 100%;" type="text" value="<?php echo $fields[phone]; ?>">
                    </tr>
                    <tr>
      <td style="width: 10%;">Carrier Rating:</td><td>
              <select id="rating" name="rating">
              <option value=""></option>
              <option <?php if($fields[rating] == "1") echo "selected"; ?> value="1">1</option>
              <option <?php if($fields[rating] == "2") echo "selected"; ?> value="2">2</option>
              <option <?php if($fields[rating] == "3") echo "selected"; ?> value="3">3</option>
              <option <?php if($fields[rating] == "4") echo "selected"; ?> value="4">4</option>
              <option <?php if($fields[rating] == "5") echo "selected"; ?> value="5">5</option>
              </select>
              </td>
        </tr>
        <tr>
      <td style="width: 10%;">Carrier Info:</td><td style="text-align: center;" colspan="2"><textarea name="info" maxlength="65535"  style="width: 100%; height: 4em;"><?php echo $fields[info]; ?></textarea></td>
      </tr>
     </tbody>
  </table>
  <p style="text-align: center;"><input name="submit" value="Update"
 class="submit" type="submit"></p>
  </div>
</form>
<input type="button" onclick="window.location.href='test3.php';" value="Back" />
</div>
<p style="margin-bottom: -20px;">&nbsp;</p>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:15:24.413

```
$insert = "UPDATE carrierinfo Set `carriername` = '$carriername', `contact` = '$contact', `phone` = '$phone', `rating` = '$rating', `info` = '$info'  **WHERE `id` = '$id';**"; 
```

在运行 UPDATE 查询之前，您尚未声明 $id 应该是什么，因此没有更新任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:19:07.210

你正在寻找

```
$_POST["submit"] == "Update Load" 
```

但是您提交按钮的值是“更新”，而不是“更新加载”。

# php - 使用 jquery 获取多个不同的输入/选择框值以使用数组中的 .ajax() 提交

> ID：13316792
> 
> 赞同：0
> 
> 时间：2012-11-09T22:12:19.987
> 
> 标签：php, javascript, jquery, html

我有一个表单，每次使用 PHP 都会动态生成，并且在访问者与之交互时也会使用 jQuery .appendTo() 进行更新。我遇到的问题是我想获取输入文本的每一个值并从当前表单中选择框并使用 POST 在数组中提交它们。到目前为止，我已经做了以下（一个例子）：

```
 <div>
        <input type="text" class="dynamicTags" name="dynamicTags1" value="Web Design"/>
        <select class="val_tag" name="val_tag1">                                               
               <option value="1" >Newbie</option>
               <option value="2" >Amateur</option>
               <option value="3" selected="selected" >Rockstar</option>
        </select>
    </div>                            
    <div>
        <input type="text" class="dynamicTags" name="dynamicTags2" value="Programming"/>
        <select class="val_tag" name="val_tag2">                                               
               <option value="1" >Newbie</option>
               <option value="2" selected="selected" >Amateur</option>
               <option value="3" >Rockstar</option>
        </select>
    </div>
    <div>
        <input type="text" class="dynamicTags" name="dynamicTags6" value="Java"/>
        <select class="val_tag" name="val_tag6">                                               
               <option value="1" >Newbie</option>
               <option value="2" >Amateur</option>
               <option value="3" selected="selected" >Rockstar</option>
        </select>
    </div>
    <div>
        <input type="text" class="dynamicTags" name="dynamicTags13" value="Photoshop"/>
        <select class="val_tag" name="val_tag13">                                               
               <option value="1" >Newbie</option>
               <option value="2" selected="selected" >Amateur</option>
               <option value="3" >Rockstar</option>
        </select>
    </div> 
```

每个输入文本和选择框的名称是动态生成的。课程是一样的。使用 jQuery，我设法将来自文本框和选择框（我以前知道）的简单变量传递给我的脚本，但我无法让它与**数组**一起使用。我努力了

```
data: {valTags: $('.val_tag').val(), dynTags: $('.dynamicTags').val()} 
```

在 $.ajax() 函数内，但没有任何运气。当然，我在这里遗漏了一些重要的东西，但我找不到正确的方法。我必须以某种方式使用 .each() 函数吗？

最后，我想在我的**$_POST 变量中有两个**这样的数组：

```
dynamicTags[] = ([0] => 'Web Design', [1] => 'Programming', [2] => 'Java' ...etc....)

val_tag[] = ([0] => 1, [1] => 0, [2] => 0 ...etc....) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T03:45:05.823

您是否尝试过您的数据

```
 Data: serialize( $('#formID') ), 
```

它会将您的所有表单值发送到 post 数组中，php 可以根据需要进行 json_decode 和迭代

# .net - 计算列是否可索引和跟进

> ID：13316795
> 
> 赞同：2
> 
> 时间：2012-11-09T22:12:54.867
> 
> 标签：.net, sharepoint-2010, indexing, formula, calculated-columns

SharePoint 2010 中的计算列是否可编入索引？无论哪种方式，我都没有找到明确的答案，但似乎有人支持“是”。

一个后续问题：如何有问题地（在 C# 中而不是在 XML 中）表示包含字符串的列的公式？

不确定哪些引号应该是双引号 ( `"`)、单引号 ( `'`) 或转义 (`/"`或`/'`) 或其他。

例子：

```
myCalculatedColumn.Formula = "=IF([colA]='somestring', 'thenThisString', 'elseThisString')" 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T17:55:28.197

以下是我的发现：是的，计算的列对于 SharePoint 搜索是可索引的（注意：虽然没有亲自尝试过）。它也可用于 FAST 搜索。FAST 中的警告是，当将其用作搜索优化器时，计算的列会被有趣地拉回。

即假设计算的列具有字符串值“FooBar”。在 FAST 中用作搜索优化器时，它会显示类似“string;#FooBar”或“string;%FooBar”的内容。还没有找到解决这个问题的方法，甚至尝试操作显示用于 FAST 搜索的 XML。（注意：`<customfilters MappingType="ValueMapping" ... />`由于 ValueMapping，FAST 搜索失败。）

它与计算的列值在 SharePoint 中的存储、检索和显示方式有关。可能是对 FAST 搜索到 SharePoint 的未完善集成过程的疏忽。

后续问题无解。

# uiview - 如何将 UIView 与 CCLayer cocos2d 一起使用？

> ID：13316797
> 
> 赞同：6
> 
> 时间：2012-11-09T22:13:27.890
> 
> 标签：uiview, cocos2d-iphone, cclayer, ccvideoplayer

我正在 cocos2d 中使用 CCVideoPlayer 播放一个短视频，最后我正在捕获视频的最后一帧，并使用 UIView 在屏幕上显示它，因为尝试在 CCLayer 上绘制它会使图像显示出来颜色略有不同。我想这是因为在 cocos2d 中绘制事物的方式与在 UIView 上绘制的方式不同。所以我需要一些方法来使用 UIView 将图像保留在屏幕上，并且我需要能够在这个视图之上绘制精灵等。所以我的问题是，有没有办法让 CCLayer 透明，以便仍然可以看到包含图像的 UIView，然后使用 CCLayer 在图像顶部绘制？（PS我用的是cocos2d v1.1.0-beta2b）

# javascript - Knockout-Sortable 水平列表在拖动项目时垂直推送项目

> ID：13316798
> 
> 赞同：3
> 
> 时间：2012-11-09T22:13:30.317
> 
> 标签：javascript, knockout.js, knockout-sortable

我正在使用 knockout.js 创建一个应用程序，使用 knockout-sortable 进行拖放可排序列表。有一个垂直列表，每个项目内部都有一个水平列表。垂直列表表现得很好，但是每当我尝试在水平列表中拖动一个项目时，它会相对于被拖动的项目向上或向下推动该列表中的其余项目。水平列表定义如下：

```
<div style="float: left" data-bind="sortable: { template: 'levelTmpl', data: $data.levels, beforeMove: $root.verifyMove, afterAdd: showLevel, beforeRemove: hideLevel, options: { containment: 'parent' } }"></div>
<script id="levelTmpl" type="text/html">
    <div class="container item" style="display: inline-block">
    <div style="float: right"><span class="ui-button" data-bind="click: $parent.removeLevel">[x]</span></div>
    <input data-bind="value: name"/><br/>
    <div style="clear: both"></div>
    <textarea cols="35" rows="4" data-bind="value: description"> </textarea><br/>
    <textarea cols="35" rows="4" data-bind="value: canned"> </textarea>
    </div>
</script> 
```

您可以在此处查看完整的应用程序：
**链接不再存在**

我已经尝试了我找到的所有建议，包括[http://bugs.jqueryui.com/ticket/6702](http://bugs.jqueryui.com/ticket/6702)上的建议，但到目前为止，没有任何效果。我真的很想让水平可排序列表工作，所以如果有人有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T18:52:33.537

仅供参考[https://github.com/rniemeyer/knockout-sortable](https://github.com/rniemeyer/knockout-sortable)只是 jquery ui 可排序的包装器。

为了不混淆列表，请在可排序元素上使用 connectClass。

# python - Python字典和数据结构有什么区别？

> ID：13316799
> 
> 赞同：1
> 
> 时间：2012-11-09T22:13:33.497
> 
> 标签：python, dictionary, data-structures

只是为一个项目研究python中的数据结构，无法找出字典和这种形式的数据结构的区别：

```
￼class Address:

    def __init__(self, house_number, house_street, house_city,
                 house_county, house_postcode):
        self.number = house_number
        self.street = house_street
        self.city = house_city
        self.county = house_county
        self.postcode = house_postcode

    def __repr__(self):
        return ('<Class: \'Address\', '+ str(self.number) + ' ' +
                self.street + ' ' + self.city + ' ' +
                self.county + ' ' + self.postcode + '>')

## Creates an object Address and assign it to a variable
my_address = Address(1, 'abc', 'def', 'ghi', 'jkl')

## Print the object My_address
print 'Address object:', my_address

print 'house number:', my_address.number

## change house number
my_address.number = 555

print 'NEW house number:', my_address.number 
```

代码示例是从约克大学讲座中给出的示例代码修改而来的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:16:26.197

python`dict`是一个高度优化的[哈希表](http://en.wikipedia.org/wiki/Hash_table)，它是一种数据结构。

因此，换句话说，python`dict`是数据结构的一个例子。`set`,`list`和类型`string`也是如此。`unicode`自定义类又是另一种数据结构，可以根据您的应用程序需求高度自定义。

来自维基百科关于[*数据结构*](http://en.wikipedia.org/wiki/Data_structure)[的条目](http://en.wikipedia.org/wiki/Data_structure)*：*

 *> 在计算机科学中，数据结构是一种在计算机中存储和组织数据的特殊方式，以便可以有效地使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:18:32.177

python 中的数据结构可以有列表、字典的形式，甚至对于只使用 pass 关键字的 emtpy 类也是如此。它们就像 C 中的结构。它们是那些实际上可以按某种顺序或不按某种顺序存储某些数据的对象。*

# delphi - 同步多个应用程序

> ID：13316800
> 
> 赞同：0
> 
> 时间：2012-11-09T22:13:37.150
> 
> 标签：delphi, synchronization

我有多个服务处理一些文件。每个服务在处理时都必须拥有对文件的独占访问权限。不久前，我通过创建一个使用一些临时文件的全局互斥锁解决了这个问题，如下所示：

```
function AppLocked: boolean;
begin
  result := FileExists(GetTempDir + '__MUTEX__' + LockExt);
end;

procedure AppLock;
var
  F: TextFile;
begin
  if FileExists(GetTempDir + '__MUTEX__' + LockExt) then
    exit
  else
  try
    AssignFile(F, GetTempDir + '__MUTEX__' + LockExt);
    Rewrite(F);
    Writeln(F, DateTimeToStr(Now));
    CloseFile(F);
  except
  end;
end;

procedure AppUnLock;
begin
  if FileExists(GetTempDir + '__MUTEX__' + LockExt) then
    SysUtils.DeleteFile(GetTempDir + '__MUTEX__' + LockExt);
end; 
```

这工作得很好，我不想修复一些有效的东西，但我只是想知道，有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T22:16:20.477

实际的 Mutex（如在 win32 Mutex 中）是首选方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T03:09:40.400

如果应用程序终止并且您错过了解锁，您的解决方案就有问题。这可能发生在异常终止时。最好创建一个文件，如果应用程序终止，该文件会自动擦除。

所有的魔法都由[FILE_FLAG_DELETE_ON_CLOSE完成](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)

```
unit uAppLock;

interface

function AppLocked : Boolean;
function AppLock : Boolean;
procedure AppUnlock;

implementation

uses
  Windows, SysUtils, Classes;

var
  // unit global variable 
  LockFileHandle : THandle;

// function to build the filename
function GetLockFileName : string;
begin
  // You have to point out, where to get these informations
  Result := GetTempDir + '__MUTEX__' + LockExt;
end;

function AppLocked : Boolean;
begin
  Result := FileExists( GetLockFileName );
end;

function AppLock : Boolean;
var
  LFileName :       string;
  LLockFileStream : TStream;
  LInfoStream :     TStringStream;
begin
  Result := False;

  if AppLock
  then
    Exit;

  LFileName := GetLockFileName;

  // Retrieve the handle of the LockFile
  LockFileHandle := CreateFile( PChar( LFileName ), GENERIC_READ or GENERIC_WRITE, FILE_SHARE_READ or FILE_SHARE_DELETE,
    nil, CREATE_NEW, FILE_FLAG_DELETE_ON_CLOSE or FILE_ATTRIBUTE_TEMPORARY, 0 );

  if LockFileHandle <> INVALID_HANDLE_VALUE
  then
    begin

      Result := True;

      LInfoStream     := nil;
      LLockFileStream := nil;
      try

        LInfoStream := TStringStream.Create;
        LInfoStream.WriteString( DateTimeToStr( Now ) );
        LInfoStream.Seek( 0, soFromBeginning );

        LLockFileStream := THandleStream.Create( LockFileHandle );
        LLockFileStream.CopyFrom( LInfoStream, LInfoStream.Size );

      finally
        LInfoStream.Free;
        LLockFileStream.Free;
      end;

    end;

end;

procedure AppUnlock;
begin
  // Just close the handle and the file will be deleted
  CloseHandle( LockFileHandle );
end;

end. 
```

顺便说一句：**GetTempDir**看起来是一个目录，但您将它用作路径。所以最好将它重命名为**GetTempPath** :o)

# xslt-1.0 - 平面结构到多层嵌套结构的 XSLT 转换

> ID：13316801
> 
> 赞同：1
> 
> 时间：2012-11-09T22:13:41.930
> 
> 标签：xslt-1.0

我对 XML/XLST 处理相当陌生，并且在必须使用版本 1 处理的环境中工作。我有一个从 Excel 电子表格导出的 XML 文件。该文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<TmData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Version="10"
Date="2012-11-07T10:11:09.017242-05:00" Format="1" Author="System" Description="Import"
Culture="en-US">
<DocumentElement>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Human Resources</FOLDER2>
        <RISK_x0020_FOLDER>Knowledge and People</RISK_x0020_FOLDER>
        <TITLE>Insufficient investment in training</TITLE>
        <CODE>code001</CODE>
        <RISKCATEGORY1>Securtiy</RISKCATEGORY1>
        <RISKCATEGORY2>Indirect Assertion</RISKCATEGORY2>
        <RISKNUMBERICVALUE1>32.5</RISKNUMBERICVALUE1>
        <RISKYESNO1>1</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>6</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Human Resources</FOLDER2>
        <RISK_x0020_FOLDER>Knowledge and People</RISK_x0020_FOLDER>
        <TITLE>Over-reliance on one or a few key employees</TITLE>
        <CODE>code002</CODE>
        <RISKCATEGORY3>Securtity</RISKCATEGORY3>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>1</RISKYESNO2>
        <WEIGHT>323.5</WEIGHT>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>7</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Human Resources</FOLDER2>
        <RISK_x0020_FOLDER>Knowledge and People</RISK_x0020_FOLDER>
        <TITLE>Inability to recruit / retain staff</TITLE>
        <CODE>code003</CODE>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>8</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Human Resources</FOLDER2>
        <RISK_x0020_FOLDER>Knowledge and People</RISK_x0020_FOLDER>
        <TITLE>Unexpected / unbudgeted cost increases</TITLE>
        <CODE>code004</CODE>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>9</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Financial</FOLDER2>
        <RISK_x0020_FOLDER>Financial Div</RISK_x0020_FOLDER>
        <TITLE>Failure to achieve margins</TITLE>
        <CODE>code005</CODE>
        <RISKNUMBERICVALUE1>232.5</RISKNUMBERICVALUE1>
        <RISKYESNO1>1</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>12</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER/>
        <FOLDER1>Management</FOLDER1>
        <FOLDER2>Financial</FOLDER2>
        <RISK_x0020_FOLDER>Financial Div</RISK_x0020_FOLDER>
        <TITLE>Adverse impact of exchange rate fluctuations</TITLE>
        <CODE>code006</CODE>
        <RISKYESNO1>1</RISKYESNO1>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>13</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1/>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Strategic / Vision</RISK_x0020_FOLDER>
        <TITLE>Strategy is not implemented</TITLE>
        <CODE>code008</CODE>
        <RISKNUMBERICVALUE1>0</RISKNUMBERICVALUE1>
        <RISKYESNO2>0</RISKYESNO2>
        <WEIGHT>10000000000.58</WEIGHT>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>16</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1/>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Strategic / Vision</RISK_x0020_FOLDER>
        <TITLE>Failure to have and execute R&amp;D plans</TITLE>
        <CODE>code009</CODE>
        <RISKYESNO1>1</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>17</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1/>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Strategic / Vision</RISK_x0020_FOLDER>
        <TITLE>Risk management practices do not exist</TITLE>
        <CODE>code010</CODE>
        <RISKYESNO1>1</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>18</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Environment</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Environment Div</RISK_x0020_FOLDER>
        <TITLE>Community involvement objectives are not clearly articulated</TITLE>
        <CODE>code011</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>21</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Environment</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Environment Div</RISK_x0020_FOLDER>
        <TITLE>Time off for community involvement is no adequately controlled</TITLE>
        <CODE>code012</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>0</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>22</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Market</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Market Div</RISK_x0020_FOLDER>
        <TITLE>Brand / reputation damage by company environmental failure</TITLE>
        <CODE>Ad.358</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>1</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>25</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Market</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Market Div</RISK_x0020_FOLDER>
        <TITLE>Supply of raw materials affected by environmental failure</TITLE>
        <CODE>CK.324</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>1</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>26</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Market</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Market Div</RISK_x0020_FOLDER>
        <TITLE>Loss of business through unattractive product / service offerings</TITLE>
        <CODE>AABB01</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>1</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>27</_RowNumber>
    </Risks>
    <Risks>
        <FOLDER>ACME Manufacturing</FOLDER>
        <FOLDER1>Market</FOLDER1>
        <FOLDER2/>
        <RISK_x0020_FOLDER>Market Div</RISK_x0020_FOLDER>
        <TITLE>Natural disaster</TITLE>
        <CODE>CCDD03</CODE>
        <RISKYESNO1>0</RISKYESNO1>
        <RISKYESNO2>1</RISKYESNO2>
        <_SheetName>C:\Users\Hugh.Manning\AppData\Local\Temp\CDEA67E1F7034E89B86DD770700A7B19\82F56919D18640DA9EC54FE569B6A3F8.xls
            [Risks]</_SheetName>
        <_RowNumber>28</_RowNumber>
    </Risks>
</DocumentElement>
</TmData> 
```

我需要输出如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<TmData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
Version="10"
Date="2012-10-31T09:35:28.9068981-04:00" Format="1" Author="System" Description="Import"
Culture="en-US"><FOLDERS>
<FOLDER>
  <Title/>
  <FOLDERS>
    <FOLDER>
      <Title>Management</Title>
      <FOLDERS>
        <FOLDER>
          <Title>Human Resources</Title>
          <FOLDERS>
            <FOLDER>
              <Title>Knowledge and People</Title>
              <Risk>
                <TITLE>Insufficient investment in training</TITLE>
                <CODE>code001</CODE>
                <RISKCATEGORY1>Security</RISKCATEGORY1>
                <RISKCATEGORY2>Indirect Assertion</RISKCATEGORY2>
                <RISKNUMBERICVALUE1>32.5</RISKNUMBERICVALUE1>
                <RISKYESNO1>1</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>Over-reliance on one or a few key employees</TITLE>
                <CODE>code002</CODE>
                <RISKCATEGORY3>Security</RISKCATEGORY3>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>Inability to recruit / retain staff</TITLE>
                <CODE>code003</CODE>
              </Risk>
              <Risk>
                <TITLE>
                  Unexpected / unbudgeted cost
                  increases
                </TITLE>
                <CODE>code004</CODE>
              </Risk>
            </FOLDER>
          </FOLDERS>
        </FOLDER>
        <FOLDER>
          <Title>Financial</Title>
          <FOLDERS>
            <FOLDER>
              <Title>Financial Div</Title>
              <Risk>
                <TITLE>Failure to achieve margins</TITLE>
                <CODE>code005</CODE>
                <RISKNUMBERICVALUE1>232.5</RISKNUMBERICVALUE1>
                <RISKYESNO1>1</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>
                  Adverse impact of exchange rate
                  fluctuations
                </TITLE>
                <CODE>code006</CODE>
                <RISKYESNO1>1</RISKYESNO1>
              </Risk>
            </FOLDER>
          </FOLDERS>
        </FOLDER>
      </FOLDERS>
    </FOLDER>
  </FOLDERS>
</FOLDER>
<FOLDER>
  <Title>ACME Manufacturing</Title>
  <FOLDERS>
    <FOLDER>
      <Title/>
      <FOLDERS>
        <FOLDER>
          <Title/>
          <FOLDERS>
            <FOLDER>
              <Title>Strategic / Vision</Title>
              <Risk>
                <TITLE>Strategy is not implemented</TITLE>
                <CODE>code008</CODE>
                <RISKNUMBERICVALUE1>0</RISKNUMBERICVALUE1>
                <RISKYESNO2>0</RISKYESNO2>
                <WEIGHT>10000000000.58</WEIGHT>
              </Risk>
              <Risk>
                <TITLE>Failure to have and execute R&amp;D plans</TITLE>
                <CODE>code009</CODE>
                <RISKYESNO1>1</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>Risk management practices do not exist</TITLE>
                <CODE>code010</CODE>
                <RISKYESNO1>1</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
            </FOLDER>
          </FOLDERS>
        </FOLDER>
      </FOLDERS>
    </FOLDER>
    <FOLDER>
      <Title>Environment</Title>
      <FOLDERS>
        <FOLDER>
          <Title/>
          <FOLDERS>
            <FOLDER>
              <Title>Environment Div</Title>
              <Risk>
                <TITLE>
                  Community involvement objectives are not
                  clearly articulated
                </TITLE>
                <CODE>code011</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>
                  Time off for community involvement is no
                  adequately controlled
                </TITLE>
                <CODE>code012</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>0</RISKYESNO2>
              </Risk>
            </FOLDER>
          </FOLDERS>
        </FOLDER>
      </FOLDERS>
    </FOLDER>
    <FOLDER>
      <Title>Market</Title>
      <FOLDERS>
        <FOLDER>
          <Title/>
          <FOLDERS>
            <FOLDER>
              <Title>Market Div</Title>
              <Risk>
                <TITLE>
                  Brand / reputation damage by company
                  environmental failure
                </TITLE>
                <CODE>Ad.358</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>
                  Supply of raw materials affected by
                  environmental failure
                </TITLE>
                <CODE>CK.324</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>
                  Loss of business through unattractive
                  product / service offerings
                </TITLE>
                <CODE>AABB01</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
              <Risk>
                <TITLE>Natural disaster</TITLE>
                <CODE>CCDD03</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
            </FOLDER>
            <FOLDER>
              <Title>Sales Div</Title>
              <Risk>
                <TITLE>Failure to achieve sales quota</TITLE>
                <CODE>S.001</CODE>
                <RISKYESNO1>0</RISKYESNO1>
                <RISKYESNO2>1</RISKYESNO2>
              </Risk>
            </FOLDER>
          </FOLDERS>
        </FOLDER>
      </FOLDERS>
    </FOLDER>
  </FOLDERS>
</FOLDER>
</FOLDERS>
</TmData> 
```

我已经处理了以下 XSLT 文件，它将让我大部分时间到达那里，但我无法弄清楚如何防止 FLODERS 节点的重复。XSLT 看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>

<xsl:output method="xml" indent="yes"/>
<xsl:param name="rowSelector" select="local-name(//DocumentElement/*[1])"/>   

<xsl:template match="/TmData">
    <xsl:copy>
        <xsl:copy-of select="@*"/>
        <xsl:apply-templates select="DocumentElement"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="DocumentElement">
    <FOLDERS>
        <xsl:apply-templates mode="Elements"/>
    </FOLDERS>
</xsl:template>

<xsl:template name="Risks">       
  <xsl:apply-templates />      
</xsl:template>

<xsl:template match="@* | node()">
    <xsl:if test="not(starts-with(name(),'_'))">
        <xsl:copy>
            <xsl:apply-templates/>
        </xsl:copy>
    </xsl:if>
</xsl:template>

<xsl:template match="RISK_x0020_FOLDER">
    <FOLDER>
        <Title>
            <xsl:value-of select="."/>
        </Title>        
        <xsl:call-template name="RiskTemplate">
            <xsl:with-param name="RiskFolderName" select ="."/>
        </xsl:call-template>
    </FOLDER>
</xsl:template>

<xsl:template match="FOLDER |FOLDER1 |FOLDER2 |FOLDER3">
    <xsl:param name="folderName"/>
    <xsl:param name="folderValue"/>
    <FOLDER>
        <Title>
            <xsl:value-of select="."/>
        </Title>
        <FOLDERS>
            <xsl:choose>
                <xsl:when test="starts-with(local-name(following-sibling::*[1]),'FOLDER')">
                    <xsl:apply-templates select="following-sibling::*[1]"/>                        
                </xsl:when>
            </xsl:choose>
            <xsl:choose>
                <xsl:when test="starts-with(local-name(following-sibling::*[1]),'RISK_x')">
                    <xsl:apply-templates select="following-sibling::*[1]"/>
                </xsl:when>
            </xsl:choose>
            </FOLDERS>
    </FOLDER>
</xsl:template>

<xsl:template name="RiskTemplate">
    <xsl:param name="RiskFolderName"/>
    <xsl:for-each select="//Risks[RISK_x0020_FOLDER=$RiskFolderName]">
        <Risk>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates select="TITLE"/>
        <xsl:apply-templates select="CODE"/>            
        <xsl:apply-templates select="TYPE"/>
        <xsl:apply-templates select="DESCRIPTION"/>
        <xsl:apply-templates select="NOTES"/>
        <xsl:apply-templates select="RISKCATEGORY1"/>
        <xsl:apply-templates select="RISKCATEGORY2"/>
        <xsl:apply-templates select="RISKCATEGORY3"/>
        <xsl:apply-templates select="RISKCATEGORY4"/>
        <xsl:apply-templates select="RISKMULTISELECTCATEGORY"/>
        <xsl:apply-templates select="RISKNUMBERICVALUE1"/>
        <xsl:apply-templates select="RISKYESNO1"/>
        <xsl:apply-templates select="RISKYESNO2"/>
        <xsl:apply-templates select="WEIGHT"/>
        </Risk>
    </xsl:for-each>
</xsl:template>

<xsl:template match="node()" mode="Elements">
    <xsl:choose>
        <xsl:when test="local-name() = $rowSelector">
            <xsl:call-template name="Risks"/>
        </xsl:when>
    </xsl:choose>
</xsl:template>
</xsl:stylesheet> 
```

我从转换中获得的输出具有嵌套正确的第一个块，但我无法弄清楚如何防止转换查看它已经处理的节点。有很多重复，这是我试图消除的。一个多星期以来，我一直在尝试解决这个问题，并且真的可以使用一些帮助。在此先感谢所有 XML/XSLT 专家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T08:36:44.073

这个模板应该可以解决您的问题。

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:msxsl="urn:schemas-microsoft-com:xslt"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  version="1.0"
  exclude-result-prefixes="msxsl">
  <xsl:output method="xml" indent="yes"/>

  <!--
    Initial template.
    -->
  <xsl:template match="/TmData">
    <xsl:copy>
      <xsl:copy-of select="@*"/>
      <xsl:call-template name="folders">
        <xsl:with-param name="depth" select="0"/>
        <xsl:with-param name="risks" select="DocumentElement/Risks"/>
      </xsl:call-template>
    </xsl:copy>
  </xsl:template>

  <!--
    This template is applied to <Risks/>, once the folder for the risk
    has been built.
    -->
  <xsl:template match="Risks" mode="folder-content">
    <Risk>
      <xsl:copy-of select="@*|element()[not(starts-with(local-name(), '_') or contains(local-name(), 'FOLDER'))]"/>
    </Risk>
  </xsl:template>

  <!--
    Called to build out the folders at a given depth.
    params:
      depth: the current folder depth.
      risks: the risks that are in this folder.
    -->
  <xsl:template name="folders">
    <xsl:param name="depth"/>
    <xsl:param name="risks"/>
    <FOLDERS>
      <xsl:call-template name="folder">
        <xsl:with-param name="depth" select="$depth"/>
        <xsl:with-param name="risks" select="$risks"/>
      </xsl:call-template>
    </FOLDERS>
  </xsl:template>

  <!--
    Called to build a folder.  This template builds the folder for the first risk
    in the risks parameter.  It then creates the nested folders for that risk, by
    calling the folders template with the risks that are in the folder.  Finally,
    the template creates more folders at the same depth, by calling itself with
    the risks that were not in this folder.

    params:
      depth: the current folder depth.
      risks: the risks that are in this folder.
    -->
  <xsl:template name="folder">
    <xsl:param name="depth"/>
    <xsl:param name="risks"/>
    <xsl:if test="$risks">
      <xsl:variable name="element-name">
        <xsl:choose>
          <xsl:when test="$depth=0">FOLDER</xsl:when>
          <xsl:when test="$risks[1]/*[local-name()=concat('FOLDER', $depth)]">
            <xsl:value-of select="concat('FOLDER', $depth)"/>
          </xsl:when>
          <xsl:otherwise>RISK_x0020_FOLDER</xsl:otherwise>
        </xsl:choose>
      </xsl:variable>

      <!-- Build the folder for $risks[1] -->
      <FOLDER>
        <TITLE>
          <xsl:value-of select="$risks[1]/*[local-name()=$element-name]"/>
        </TITLE>
        <xsl:choose>
          <xsl:when test="$element-name='RISK_x0020_FOLDER'">
            <xsl:apply-templates select="$risks" mode="folder-content"/>
          </xsl:when>
          <xsl:otherwise>
            <!-- Build nested folders for all of the risks in the same folder as $risks[1]. -->
            <xsl:call-template name="folders">
              <xsl:with-param name="depth" select="$depth+1"/>
              <xsl:with-param name="risks" select="$risks[*[local-name()=$element-name]=$risks[1]/*[local-name()=$element-name]]"/>
            </xsl:call-template>
          </xsl:otherwise>
        </xsl:choose>
      </FOLDER>

      <!-- Build sibling folders for the risks that are not in the same folder as $risks[1] -->
      <xsl:call-template name="folder">
        <xsl:with-param name="depth" select="$depth"/>
        <xsl:with-param name="risks"
          select="$risks[not(*[local-name()=$element-name]=$risks[1]/*[local-name()=$element-name])]"/>
      </xsl:call-template>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

对于这样的情况，我会避免应用模板。创建一组要处理的事物然后使用递归调用模板进行处理要容易得多。

# oracle - 交易死锁 TX

> ID：13316806
> 
> 赞同：3
> 
> 时间：2012-11-09T22:14:16.177
> 
> 标签：oracle, deadlock

有一个批处理和一个更新同一个表的常规应用程序。我的批处理有多个线程在多个会话上运行。我的批处理 Tomcat 中出现以下错误：

```
2012-09-10 11:30:17,043 [SyncDataThread567] ERROR org.springframework.batch.core.step.AbstractStep - Encountered an error executing the step
aaa.bbb.ccc.framework.orm.DAOException:   
--- The error occurred in abc.xml.  
--- The error occurred while applying a parameter map.  
--- Check the ear.updateServiceTimeParamMap.  
--- Check the statement (update procedure failed).  
--- Cause: java.sql.SQLException: ORA-20011: FUNC_UPDATESERVICETIME : Error occured  ORA-00060: deadlock detected while waiting for resource
ORA-06512: at "ER.FUNC_UPDATESERVICETIME", line 154
ORA-06512: at line 1

    at aaa.bbb.ccc.ddd.eee.Sss.updateServiceTimes(ServiceOrderDAOImpl.java:76)
    at sun.reflect.GeneratedMethodAccessor352.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
    at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)
    at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
    at $Proxy6.updateServiceTimes(Unknown Source)
    at aaa.bbb.ccc.ddd.eeee.Inbddd.updateServiceTimes(InbDataWriter.java:144)
    at aaa.bbb.ccc.ddd.eeee.Inbddd.write(InbDataWriter.java:74)
    at sun.reflect.GeneratedMethodAccessor270.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
    at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:131)
    at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:119)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
    at $Proxy7.write(Unknown Source)
    at org.springframework.batch.core.step.item.SimpleChunkProcessor.writeItems(SimpleChunkProcessor.java:171)
    at org.springframework.batch.core.step.item.SimpleChunkProcessor.doWrite(SimpleChunkProcessor.java:150)
    at org.springframework.batch.core.step.item.SimpleChunkProcessor.write(SimpleChunkProcessor.java:268)
    at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:194)
    at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:74)
    at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:386)
    at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:128)
    at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:264)
    at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:76)
    at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:367)
    at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:214)
    at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:143)
    at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:250)
    at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:195)
    at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:109)
    at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler$1.call(TaskExecutorPartitionHandler.java:107)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at org.springframework.core.task.SimpleAsyncTaskExecutor$ConcurrencyThrottlingRunnable.run(SimpleAsyncTaskExecutor.java:192)
    at java.lang.Thread.run(Thread.java:619)
Caused by: com.ibatis.common.jdbc.exception.NestedSQLException:   
--- The error occurred in ael.xml.  
--- The error occurred while applying a parameter map.  
--- Check the eraa.updateServiceTimeParamMap.  
--- Check the statement (update procedure failed).  
--- Cause: java.sql.SQLException: ORA-20011: FUNC_UPDATESERVICETIME : Error occured  ORA-00060: deadlock detected while waiting for resource
ORA-06512: at "ER.FUNC_UPDATESERVICETIME", line 154
ORA-06512: at line 1

    at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryWithCallback(MappedStatement.java:201)
    at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryForObject(MappedStatement.java:120)
    at com.ibatis.sqlmap.engine.impl.SqlMapExecutorDelegate.queryForObject(SqlMapExecutorDelegate.java:518)
    at com.ibatis.sqlmap.engine.impl.SqlMapExecutorDelegate.queryForObject(SqlMapExecutorDelegate.java:493)
    at com.ibatis.sqlmap.engine.impl.SqlMapSessionImpl.queryForObject(SqlMapSessionImpl.java:106)
    at com.iit.integration.erl.orm.ServiceOrderDAOImpl.updateServiceTimes(ServiceOrderDAOImpl.java:71)
    ... 44 more
Caused by: java.sql.SQLException: ORA-20011: FUNC_UPDATESERVICETIME : Error occured  ORA-00060: deadlock detected while waiting for resource
ORA-06512: at "ER.FUNC_IIT_UPDATESERVICETIME", line 154
ORA-06512: at line 1

    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)
    at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:743)
    at oracle.jdbc.driver.T4CCallableStatement.doOall8(T4CCallableStatement.java:215)
    at oracle.jdbc.driver.T4CCallableStatement.executeForRows(T4CCallableStatement.java:954)
    at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1168)
    at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3285)
    at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3390)
    at oracle.jdbc.driver.OracleCallableStatement.execute(OracleCallableStatement.java:4223)
    at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169)
    at com.ibatis.sqlmap.engine.execution.SqlExecutor.executeQueryProcedure(SqlExecutor.java:278)
    at com.ibatis.sqlmap.engine.mapping.statement.ProcedureStatement.sqlExecuteQuery(ProcedureStatement.java:39)
    at com.ibatis.sqlmap.engine.mapping.statement.MappedStatement.executeQueryWithCallback(MappedStatement.java:189)
    ... 49 more 
```

* * *

这是我的 oracle 跟踪文件：

```
Redo thread mounted by this instance: 1

Oracle process number: 63

Windows thread id: 2464, image: ORACLE.EXE (SHAD)

*** 2012-09-10 11:30:12.384
*** SERVICE NAME:(SYS$USERS) 2012-09-10 11:30:12.244
*** SESSION ID:(411.3766) 2012-09-10 11:30:12.244
DEADLOCK DETECTED
[Transaction Deadlock]
Current SQL statement for this session:
UPDATE SP SET SRVC_TM = :B4 , MODIFICATION_DTM=SYSDATE WHERE OPERATION_AREA_CD = :B3 AND ROUTE_TYP = :B2 AND OBJECTID = :B1 
----- PL/SQL Call Stack -----
  object      line  object
  handle    number  name
000000057D9B52E8       134  function ER.FUNC_UPDATESERVICETIME
000000057C3A5848         1  anonymous block
The following deadlock is not an ORACLE error. It is a
deadlock due to user error in the design of an application
or from issuing incorrect ad-hoc SQL. The following
information may aid in determining the deadlock:
Deadlock graph:
                       ---------Blocker(s)--------  ---------Waiter(s)---------
Resource Name          process session holds waits  process session holds waits
TX-00040020-0017465b        63     411     X             94     364           X
TX-00020020-00166804        94     364     X             63     411           X
session 411: DID 0001-003F-00000033 session 364: DID 0001-005E-00000016
session 364: DID 0001-005E-00000016 session 411: DID 0001-003F-00000033
Rows waited on:
Session 364: obj - rowid = 0000CC64 - AAAMxkAA2AAA1q2AAY
  (dictionary objn - 52324, file - 54, block - 219830, slot - 24)
Session 411: obj - rowid = 0000CC64 - AAAMxkAA2AAA1q2AAR
  (dictionary objn - 52324, file - 54, block - 219830, slot - 17)
Information on the OTHER waiting sessions:
Session 364:
  pid=94 serial=6104 audsid=693767 user: 57/ER
  O/S info: user: , term: , ospid: 1234, machine: abc
            program: 
  Current SQL Statement:

UPDATE SP SET ORIG_NO='751' ,ORIG_SEQ_NO=0,SP_ROUTING_STATUS='A', USER_ID='XXXX', MODIFICATION_DTM=SYSDATE  WHERE OBJECTID IN ('104883389','104883404','104883407','104883440','104883443','104883455','104883467','104883509','104883545','104883764','104883788','104883806','104883812','104883821','104883836','104883854','104883863','104883893','104883899','104883931','104883937','104883964','104884084','104884117','104884120','104884138','104884141','104885439','104883386','104883422','104883560','104883587','104883767','104883785','104883809','104883824','104883845','104883851','104883884','104883890','104883955','104883958','104884012','104884093','104884114','104885412','104885436','104885442','104885445','104883383','104883395','104883413','104883419','104883464','104883494','104883524','104883773','104883842','104883917','104883920','104883943','104883949','104883967','104883997','104884051','104884105','104884108','104885451','104883437','104883461','104883476','104883497','104883500','104883503','104883566','104883584','104883614','104883794','104883800','104883815','104883830','104883857','104883869','104883923','104883952','104884048','104884057','104884063','104884066','104884081','104884087','104884102','104884111','104884135','104885415','104885424','104885427','104886297','104886308','104883398','104883410','104883458','104883473','104883512','104883515','104883527','104883530','104883536','104883554','104883596','104883770','104883782','104883803','104883827','104883833','104883839','104883848','104883866','104883875','104883878','104883896','104883902','104883914','104883970','104883976','104884060','104884069','104884072','104884123','104884132','104885409','104885430','104883425','104883431','104883446','104883449','104883452','104883482','104883506','104883518','104883539','104883548','104883569','104883575','104883578','104883623','104883779','104883797','104883818','104883860','104883925','104883934','104883940','104883946','104883973','104883979','104883982','104884078','104884090','104884096','104885421','104885448','104885454','104883392','104883416','104883428','104883479','104883491','104883521','104883542','104883551','104883557','104883563','104883872','104883911','104883928','104883961','104883994','104884018','104884054','104884099','104884129','104886299','104883401','104883434','104883470','104883485','104883533','104883572','104883581','104883776','104883791','104883881','104883887','104883905','104883908','104884075','104884126','104885418','104885433') 
End of information on OTHER waiting sessions.
===================================================
PROCESS STATE
-------------
Process global information:
     process: 000000057B3343D8, call: 0000000574FCBF78, xact: 0000000576A07F60, curses: 000000057E48D858, usrses: 000000057E48D858
  ----------------------------------------
  SO: 000000057B3343D8, type: 2, owner: 0000000000000000, flag: INIT/-/-/0x00
  (process) Oracle pid=63, calls cur/top: 0000000574FCBF78/0000000574FD4C48, flag: (0) -
            int error: 0, call error: 0, sess error: 0, txn error 0
  (post info) last post received: 108 0 4
              last post received-location: aaa
              last process to post me: 7e31d890 1 6
              last post sent: 0 0 112
              last post sent-location: bbb
              last process posted by me: 7b334c00 3 0
    (latch info) wait_event=0 bits=10
      holding    (efd=19) 4745310 Parent+children enqueue hash chains level=4 
        Location from where latch is held: cmi: gpl: 
        Context saved from call: 0
        state=busy, wlstate=free
          recovery area:
Dump of memory from 0x000000057E300810 to 0x000000057E300830
57E300810 00000000 00000000 00000000 00000000  [............... 
```

* * *

过去几天我一直在研究这个问题。从我看到的很少有人说它是一个索引问题，很少有人说它的 INITRANS ......我不确定......但是这种死锁很少发生。但每当它发生时，它就是一个大问题。

所以请帮帮我..寻找什么..以及如何解决这个问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T19:03:17.737

查看您的两个`UPDATE`语句并尝试理解为什么它们会请求同一行，但顺序不同。几乎所有的死锁都是这样发生的。

有几种可能的方法可以避免此错误：

1）以相同的顺序更新行。您可以通过提示强制执行全表扫描或索引来执行此操作。（我不能 100% 确定使用相同的访问方法总是可以避免这个问题，但实际上它似乎可以解决这个问题。当访问方法相同时，请参阅我的旧[问题](https://stackoverflow.com/q/9216150/409172)，了解有关死锁的痛苦讨论。）

2）不要同时运行你的两个进程。

3）处理异常。例如，像这样：

```
declare
    deadlock exception;
    pragma exception_init(deadlock, -00060);
begin
    <code>
    exception when deadlock then
        <do something about it here, such as re-try>
end;
/ 
```

您需要将异常处理添加到两个代码块中。并且死锁仍然会生成一个跟踪文件，这可能会减慢速度并占用很多没有人预料到的空间。

# javascript - 带有 for/in 循环的坏 juju

> ID：13316807
> 
> 赞同：0
> 
> 时间：2012-11-09T22:14:18.377
> 
> 标签：javascript

我有一个看起来像这样的小脚本：

```
hideElements = arguments.shift().split ( ',' );
for ( iterator in hideElements ) { 
    console.log ('  --> hiding ' + hideElements[iterator] );
    lg_transitions ( {kind:"slide-up"} , { target : hideElements[iterator] } );
} 
```

当我在调试器中运行它时，所有事情都非常合理地开始。我在上面列出的第一行放置了一个断点。按下“跳过下一个函数调用”按钮后，将“hideElements”变量初始化为以下内容：

![在此处输入图像描述](../Images/7bca68f40b4163ca56b0fe452a4b06cf.png)

这是我所期望的，但是在完成第一次（并且应该是唯一的）迭代之后，它又回到了循环的头部，并且从 0 开始的“迭代器”现在奇怪地变成了“删除” . 嗯？不知道那是从哪里来的。但在随后的 console.log 消息中可能会有提示......它将以下内容打印到控制台：

![在此处输入图像描述](../Images/ebc2f097be998c806d5344b2e2e7ae37.png)

这是一个叫做——你猜对了——“remove”的函数。这是我最近出于不同原因添加的一个函数，但它没有被直接或间接调用，所以我不知道为什么会在这里使用它。对于任何对“删除”的完整代码感兴趣的人，这里是：

```
// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
   var rest = this.slice((to || from) + 1 || this.length);
   this.length = from < 0 ? this.length + from : from;
   return this.push.apply(this, rest);
} 
```

添加：

我之前忽略添加的代码是参数数组的初始化。这是我所拥有的（注意我已经将名称改为“args”而不是参数）：

```
function ConditionalFormatting ( key , eventObject , setOfRules ) {
console.log ("Entering conditional formatting: key is " + key + ", eventObject is " + eventObject.attr('id') + ", setOfRules is " + setOfRules );
var ruleStrings = [];
ruleStrings = setOfRules.split (';');
var targetOverride = false;
jQuery.each ( ruleStrings , function ( i , ruleString ) {
    // There is a rule, now let's find out which one
    var targetElement;
    var args = [];
    args = ruleString.split('::');
    var rule = args.shift(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:21:48.863

@Yoshi 是对的：`for in`将列出对象中的所有字段——这就是数组的实际情况。

尝试使用[hasOwnProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)方法：

```
hideElements = arguments.shift().split ( ',' );
for (iterator in hideElements ) { 
    if (hideElements.hasOwnProperty(iterator))
    {
        console.log ('  --> hiding ' + hideElements[iterator] );
        lg_transitions ( {kind:"slide-up"} , { target : hideElements[iterator] } );
    }
} 
```

这就是为什么您通常应该避免使用`for in`to 遍历数组而使用普通`for`循环来代替。jsHint/ [jsLint](http://www.jslint.com/)将为您发布的代码提供如下消息：

```
The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype. 
```

* * *

边注：

`for (iterator in hideElements )`将创建一个全局变量`iterator`，而`for (var iterator in hideElements )`不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:24:53.923

该`arguments`对象不是实际的数组。因此它没有这个`shift()`功能。如果您想要数组中的第一个对象，请获取索引 0 处的元素（第一个对象）。此外，使用常规 for 循环遍历 arguments 对象。

```
hideElements = arguments[0].split(',');

for ( var i = 0; i < hideElements.length; i++ ) {
    ...
} 
```

`arguments`不是真正的数组，但是，如果您希望像使用数组一样使用它，请使用`Array.prototype.slice.call( arguments );`：

```
if ( arguments.length > 0)
    hideElements = Array.prototype.slice.call( arguments ).shift(); 
```

从那里你可以使用 hideElements 作为一个数组。

# php - jRating：如何通过 xml 更新星值或通过选项给它一个默认值。

> ID：13316808
> 
> 赞同：1
> 
> 时间：2012-11-09T22:14:22.813
> 
> 标签：php, html, jquery, jquery-plugins

我正在使用 jRating 在 [http://www.myjqueryplugins.com/jquery-plugin/jrating上找到的星级](http://www.myjqueryplugins.com/jquery-plugin/jrating)

在同一页面上，它们具有您可以随意配置的选项。除了我正在寻找的一个。

我喜欢为某些图像设置一个默认值，比如 1、2 或 5 星评级。我怎么能这样做？我正在使用 jQuery 和 ajax 或 xml 从服务器获取数据并将其分配给我找不到的选项。我对php一无所知，所以他们的例子根本没有帮助。任何帮助都会很棒。谢谢你。

```
<script type="text/javascript">
    $(document).ready(function(){
        $(".exemple2").jRating({
            rateMax: 5,
            showRateInfo: false,
            isDisabled:true,
            value: 3,<----------- option like this is not available how can I can do this 
            length : 5 // nb of stars
        });
    });
</scrip>

<!-- basic exemple -->
<div class="exemple">
    <!-- in this exemple, 12 is the average and 1 is the id of the line to update in DB -->
   <div class="exemple2" id="12_1"></div>
    <!-- in this other exemple, 8 is the average and 2 is the id of the line to update     in DB -->
   <div class="exemple2" id="8_2"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:58:59.057

根据我从[示例](http://demos.myjqueryplugins.com/jrating/)和[源代码](https://github.com/alpixel/jRating/blob/master/jquery/jRating.jquery.js)中了解到的情况，您需要命名设置评分组件的 div 的 id，使其类似于 x_y。其中 x 是您想要给出的评分比例。

例如，如果您希望系统中总共有 5 颗星（长度 = 5）。例子：

*   如果您希望默认评分为 2.5，则 x 将为 10 [as 5*(10/20) = 2.5]。该 div 的 ID 可以命名为“10_2”。
*   如果您想要 4 的评级，那么 x 将是 16 [as 5*(16/20) = 4]。该 div 的 ID 可以命名为“16_5”。

[分数从20开始计算。星数可配置]

您可以以任何您喜欢的方式获取数据，但是，在创建用于评级的 div 时，您必须遵循此命名约定才能使用此插件 [据我了解]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-19T04:21:24.973

这不是一个选择。您必须修改 jRating.jquery.js

```
 var startWidth = 0;
        if($(this).data('rating')){
            rating = $(this).data('rating');
            rating = parseFloat(rating);
            startWidth = rating/opts.rateMax*widthRatingContainer; // Width of the color Container
            ratingWidth = startWidth;
        } 
```

前

```
average = $('<div>', {
            'class' : 'jRatingAverage',
            css:{
                width: 0,
                top:- starHeight
            }
        }).appendTo($(this)), 
```

并将 0 更改为 startWidth，然后将 data-rating 属性设置为默认值。

```
<div id="star_rating" data-rating="3"></div> 
```

# c# - 用于 TypeScript 代码生成器的 Roslyn vs Reflection

> ID：13316810
> 
> 赞同：10
> 
> 时间：2012-11-09T22:14:43.693
> 
> 标签：c#, .net, reflection, typescript, roslyn

我正在开发一个 TypeScript 代码生成器，它将使用 C# 类的自定义属性来生成 TypeScript 定义和代码文件。

我正在考虑 TypeScript 代码生成/源文件分析的两个选项：

*   对编译程序集的反思
*   罗斯林 CTP

该工具将使用属性和方法上的自定义属性来生成 TypeScript 文件。现在我不打算将 C# 方法体转换为 JavaScript，但将来可能会这样做。因此，出于这个原因，我正在认真考虑罗斯林。然而，为了简单地生成我的 TypeScript 类的大纲，我认为我可以使用反射和自定义属性。

我想知道：

a) Roslyn 是否提供了反射无法实现的功能？我的理解是我无法通过反射获得方法体。

b) Roslyn CTP 许可证会阻止我在开源许可证下分发该工具吗？[阅读许可证后](http://msdn.microsoft.com/en-us/vstudio/jj150688)我不清楚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-01T02:17:15.947

我只是按照这些思路做了一些事情——非常适合从你的 c# 类在 Typescript 中创建你的数据模型。我构建它是为了生成一个具有模拟模型基本数据的接口的单个​​ AMD 模块。还支持泛型，并创建一个具有 Knockout 属性的类，包括一个 toJS() 方法和一个 update(data:Interface) 方法来更新你的类。

整个事情只是一个 T4 模板。如果有人发现并感兴趣： [http ://spabuilder.wordpress.com/2014/07/31/generating-typescript-from-c/](http://spabuilder.wordpress.com/2014/07/31/generating-typescript-from-c/)

如果您使用数据注解，还支持数据模型的 [KeyAttribute] 和 [Timespan] 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-10T21:18:24.767

我一直在搞乱生成js，我发现反射是一个更好的工具。我基本上将我的生成器指向元数据来自的项目的 bin 文件夹。加载所有需要的程序集可能会遇到一些困难，并且需要注意 bin 文件夹中的程序集版本以及生成器项目引用的相同程序集的版本。但是一旦你克服了所有这些，我以最小的难度完成了，Reflection 更容易使用，也更可靠。

使用 Roslyn，您基本上只是在解析 c#。Roslyn 在这方面做得很好，但我犹豫要不要从 Reflection 切换到它。通过反射，您可以获得更可靠的元数据。

假设您想要装饰控制器类的 RoutePrefixAttribute 的 Prefix 属性。如果你正在解析 c#，你可能有：[RoutePrefix("stringliteral")] 或 [RoutePrefix(constantString)]。因此，您必须担心它是文字还是常量表达式，然后找出如何获取常量表达式的值，担心可以将参数传递给属性的所有不同方式（例如，这破坏你的代码：[RoutePrefix(Prefix="literal")]...

一旦您使用反射处理实际的运行时对象，一切都会变得更容易。你有一个很好的 RoutePrefixAttribute 对象，你可以去 routePrefix.Prefix 可靠地获取前缀的值。

这只是使用反射做事更容易的一个例子。这是以类型安全的方式从一组 c# 对象中收集元数据与从 c# 代码中抓取数据之间的区别，尽管它使用了一个非常好的抓取工具。

编辑：自从写了这个答案后，我咬紧牙关转而使用 Roslyn。一旦你掌握了它，它就会变得相当强大，而且我确实发现了一个很大的优势：你可以从 Visual Studio 插件中获得对工作区的引用，并轻松地在插件中做各种事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-21T16:16:22.053

许可证不是仅禁止您个人分发二进制文件吗？它并不禁止您将 NuGet 包中的依赖项添加到 Rosyln CTP NuGet 包。您个人无法交付这些位，但您可以让 NuGet 自动拉入 Roslyn。

因此，请避免将 Rosyln 源代码或二进制文件检查到您的版本控制中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-19T14:15:49.583

**2018 年 11 月更新**

接受的[答案](https://stackoverflow.com/a/15821256/3142139)是有效的，因为它的日期是 2013 年 4 月

现在[roslyn在](https://github.com/dotnet/roslyn)[Apache License](https://github.com/dotnet/roslyn/blob/master/License.txt) Version 2.0 下分发

许可证摘录：

> 重新分配。
> 
> 您可以在任何媒介中复制和分发作品或其衍生作品的副本，无论是否经过修改，并且以源或对象形式，只要您满足以下条件：...

Roslyn 有许多[nuget 包](https://www.nuget.org/profiles/RoslynTeam)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-09T22:48:48.507

# 更新 - 2015 年 7 月

Roslyn 仍在 CTP 中，但他们[在 GitHub 上的常见问题解答](https://github.com/dotnet/roslyn/wiki/FAQ#can-i-redistribute-the-roslyn-dlls-with-my-samples-or-code-on-my-blog)更重要：

> 出于示例代码或学习目的，重新分发 Roslyn DLL 的推荐方法是使用 Roslyn NuGet 包：[url:Microsoft.CodeAnalysis| [http://www.nuget.org/packages/Microsoft.CodeAnalysis]](http://www.nuget.org/packages/Microsoft.CodeAnalysis])。

因此，您似乎仍然无法在成品中重新分发 DLL。该项目需要开源，解决方案需要引用 NuGet 包。

# 原始答案（2012 年 11 月）

我不相信你可以在开源下分发。

> 6.**可分发代码**。如果您遵守以下条款，该软件包含您被允许在您开发的程序中分发的代码。
> 
> 6.c**分发限制**您不得修改或分发任何可分发代码的源代码，以使其任何部分受排除许可的约束。排除许可是一种要求，作为使用、修改或分发的条件，
> 
> *   代码以源代码形式公开或分发；或项目
> *   其他人有权对其进行修改。

起初，如果您只包含 Roslyn 二进制文件，听起来您可以做到这一点，但可*分发代码*定义明确指出“软件包含代码......”，我相信这就是后面的所有内容。

对于您的另一个问题，Roslyn 尚未完全完成，仍处于测试阶段。我不确切知道它当前是否处于允许它处理您的需求的状态。这就是你可能只想花几个小时修补的东西。我认为它的功能不会超过 .NET 当前允许的功能。[您可以在此处](http://social.msdn.microsoft.com/Forums/en-US/roslyn/thread/5a56122b-d6e5-40e0-8912-60eba3fc9a01)查看他们最近在 9 月添加的内容以及当前未[在此处](http://social.msdn.microsoft.com/Forums/en-US/roslyn/thread/f5adeaf0-49d0-42dc-861b-0f6ffd731825)实施的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T20:39:22.260

Roslyn 网站没有明确指出：

> 当前许可证仅用于评估和预览目的，不允许重新分发 Roslyn 二进制文件。允许共享基于 Roslyn API 构建的示例项目，但示例用户必须安装 Roslyn CTP 或 Roslyn NuGet 包才能构建和运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-21T16:23:43.650

我不会使用当前的 Roslyn CTP - 仅仅是因为 2014 年会有新版本，而这些肯定会带来许多重大变化。因此，您最终可能会得到完全弃用的代码。

（最近有一个 MS 团队成员的博客文章，但恐怕我目前手头没有链接。）

**编辑**
Roslyn 很有可能会获得一个也允许用于商业用途的许可证......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-30T08:44:19.693

根据我使用基于反射的 T4 生成的经验，就像 TypeLite 所做的那样，在某种程度上更简单，但也有一些缺点，比如一旦项目依赖于已生成的类，通过重大更改（重命名类）重新生成它们将导致非编译项目，因此再次运行模板将输出一个空白文件，用户将很难再次编译所有内容。

所以，有同样的需求，我开始用Roslyn做实验，看起来很有希望，但我对如何正确使用它有很多疑问......

你可以看看我在做什么，也许可以在这里帮助我：[https ://github.com/TrabacchinLuigi/RoslynExporter](https://github.com/TrabacchinLuigi/RoslynExporter)

# ipad - 输入字段焦点后的移动 Safari 文本选择 iOS 5 vs iOS 6

> ID：13316811
> 
> 赞同：1
> 
> 时间：2012-11-09T22:14:50.573
> 
> 标签：ipad, focus, textarea, textselection

我有一些旧版 html 需要在新旧浏览器（低至 IE7）以及 iPad 上运行。iPad 是最大的问题，因为文本选择的处理方式。在页面上有一个文本区域以及一些文本说明。说明在 a`<div>`中，用户需要能够选择说明。

问题是一旦将焦点放在文本区域中，用户就无法随后选择`<div>`. 这是因为文本无法获得焦点。

根据 Safari Web 内容指南：处理事件（尤其是“使元素可点击”），您可以将 onclick 事件处理程序添加到要获得焦点的 div 中。

此解决方案在 iOS 6x 中有效（尽管并不理想），但在 iOS 5x 中无效。

问题是，如何在输入控件获得焦点后选择页面上的文本。这需要在 iOS 5.1+ 上工作

这是显示问题的示例代码。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script src="http://code.jquery.com/jquery-1.8.2.js"></script>

<!--
Resources:
    Safari Web Content Guide: Handling Events (especially, "Making Elements Clickable")
    https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/HandlingEvents/HandlingEvents.html#//apple_ref/doc/uid/TP40006511-SW1
 -->
 </head>
<body>
<div style="width:550">
    <div onclick='console.debug("Click!"); void(0);'>
        <p>On the iPad, I want to be able to select this text after the textarea has had focus.</p>
    </div>
    <textarea rows="20" cols="80">After focus is in the textarea, can you select the text above?</textarea>

</div>
</body>
</html> 
```

# solr - 如何让 Solr 拼写检查一直有效？

> ID：13316813
> 
> 赞同：3
> 
> 时间：2012-11-09T22:15:04.393
> 
> 标签：solr, spell-checking

我想使用 Solr 拼写检查来查找相似的单词。但是，当我输入 Solr '已知'的单词时，拼写检查不会返回任何内容。即使找到完全匹配的单词，有没有办法进行拼写检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:32:03.823

最接近您正在寻找的东西可能是将[onlyMorePopular](http://wiki.apache.org/solr/SpellCheckComponent#spellcheck.onlyMorePopular)设置为 true。

# spring - 何时使用 Spring WebMVC 的 Views 和/或 MessageConverters？

> ID：13316817
> 
> 赞同：0
> 
> 时间：2012-11-09T22:15:12.507
> 
> 标签：spring, rest, spring-mvc

我正在使用 Spring 3.1.3 编写一个内部应用程序，该应用程序带有 UI，供人类使用 VelocityView 和一个将响应实体序列化为 JSON 或 XML 的 REST API。

现在，除了视图和消息转换器。什么时候会使用其中一篇论文？我假设视图是针对人类的一般规则和用于 M2M 通信的消息转换器。为什么会有 JsonView、XmlView 等 View 存在？无论如何，这些输出不适合人类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T13:34:38.917

您基本上是对的 - 视图是将内部模型转换为“可查看”格式 - 无论是 html、json、xml 等，因此 MappingJackJsonView、更新的 Marshalling View 等，如果用作视图，则采用模型中设置的所有元素并将它们转换为 xml。

`MessageConverters`另一方面，做一些不同的事情，它不适用于模型属性，而是适用于响应主体 - 根据请求的 ACCEPT 标头将响应主体转换为适当的格式。

# google-chrome - 在与 Chrome 的 div 背景切换之间暂停

> ID：13316821
> 
> 赞同：0
> 
> 时间：2012-11-09T22:15:41.493
> 
> 标签：google-chrome, background, switching

当我在两个 div 或锚点背景之间切换时，似乎我没有正确更改背景，无论是直接在 JS 中还是使用 jQuery，与 Chrome。

跨浏览器测试如下：

Opera 12 - OK
FF 15.01 - OK
IE8 - OK！
Safari 5.1.7 - 好的
Chrome 22.0.1229.94 - 不工作

每当我在脚本中或直接使用控制台切换背景时，总会有 200-500 毫秒的停顿，根本没有背景，所以我的网站看起来很丑。我的顶部菜单鼠标悬停/鼠标离开效果很丑，我的展开/折叠的树效果看起来很丑，等等。

我使用的两种方法是：

```
[JS]     => element.style.backgroundImage = "url(siteimgs/image.png)";
[jQuery] => $('#element').css({ 'background': 'url(siteimgs/image.png)' }); 
```

我已经为 IE8 读过它：

```
filter: expression(document.execCommand("BackgroundImageCache", false, true)); 
```

我是否应该更改一些服务器端设置，以便在 http 响应中接收到带有更多刷新信息的图像？

[编辑]

奇怪，我摆弄它，它就像一个魅力：http: [//jsfiddle.net/2wVND/6/](http://jsfiddle.net/2wVND/6/)

[编辑 2]

我测试了很多插件，发现 Chrome 中没有任何预加载方法。

[编辑 3]

我终于在另一个线程中读到我需要在我的响应标头中使用它以避免这个 Chrome 错误：缓存控制：公共；最大年龄=31536000

但我 - 真的 - 不想在每次调试我的网站时修改服务器中的这种行为。

[编辑 4]

行。不需要任何预加载方法或标题修改的临时解决方案：在相邻放置的两个状态图像之间切换可见性。非常干净，仍然非常适合旧浏览器。

例子：

```
<div id="element172635">
    <div id="collapsed172635" style="background: url(collapsed.png); display: inline-block;"></div>
    <div id="expanded172635" style="background: url(expanded.png); display: none;"></div>
</div>

<script>
function toggle(state)
{
    var c = '';
    var e = '';
    if (state == 'expand')
    {
        e = '';
        c = 'none';
    } else
    {
        e = 'none';
        c = '';
    }

    collapsed172635.style.display = c;
    expanded172635.style.display = e;            
}
</script> 
```

这很脏，但跨浏览器兼容，并且比在元素上切换图像的时间更长。我在具有 100 个元素/子元素的树中使用它，并且在任何浏览器中都没有闪烁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T01:02:13.370

我将发布我的解决方法作为答案。

这是一种在两种状态之间切换时在**没有任何插件或服务器端设置**的情况下防止 Chrome 中背景闪烁的肮脏方法。

```
<div id="element172635">
    <div id="collapsed172635" style="background: url(collapsed.png); display: inline-            block;">
    </div>
    <div id="expanded172635" style="background: url(expanded.png); display: none;">
    </div>
</div>

<script>
function toggle(state)
{
    var c = '';
    var e = '';
    if (state == 'expand')
    {
        e = '';
        c = 'none';
    } else
    {
        e = 'none';
        c = '';
    }

    collapsed172635.style.display = c;
    expanded172635.style.display = e;            
}
</script> 
```

# com - 在 .NET 中创建 C++ ATL COM 嵌套命名空间，如 System 命名空间

> ID：13316823
> 
> 赞同：0
> 
> 时间：2012-11-09T22:15:55.627
> 
> 标签：com, namespaces, nested, atl, idl

我有几个 ATL COM 服务，并希望它们中的每一个都有自己的命名空间，但位于一个基本命名空间下，就像 .NET 中的系统命名空间一样。

例如，如果 C# 项目要包含这些 COM 对象，则所有对象都将位于相同的基本命名空间下：

```
using MyCompanyName.Terminator;
using MyCompanyName.Superman;
using MyCompanyName.Thor; 
```

...相反，我目前拥有的是：

```
using Terminator;
using Superman;
using Thor; 
```

...这是我不想要的。我希望能够在该基础下拥有一个基本命名空间和子命名空间。我不知道在创建 ATL 服务时如何执行此操作以及我需要修改什么来执行此操作。是我在 IDL 文件中修改的内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:45:36.340

如果您的目标是托管客户端，则可以为它们提供命名空间！但是，由于 COM 与语言无关，因此您无法使用接口描述（类型库）提供命名空间。但是，无论何时创建托管包装程序集（实际上由客户端引用），它们都可以具有命名空间来寻址 RCW 对象。您要查找的关键字是[Primary Interop Assemblies](http://msdn.microsoft.com/en-us/library/vstudio/aax7sdch.aspx)。这些是您作为原始库的供应商提供给客户参考的程序集。为了简化这一点：您正在做这项工作，当您添加对 COM 库的引用时，Visual Studio 会为您完成这项工作。您正在创建[互操作程序集](http://msdn.microsoft.com/en-us/library/vstudio/dwe56e27.aspx)，客户没有引用类型库，而是您生成的程序集。使用[tlbimp.exe](http://msdn.microsoft.com/en-us/library/vstudio/tt0cf3sx.aspx)工具可以使用`/namespace`参数将 RCW 类型封装在命名空间内。

# android - checkWakeLocks 捕获异常 java.io.FileNotFoundException

> ID：13316834
> 
> 赞同：1
> 
> 时间：2012-11-09T22:16:53.483
> 
> 标签：android, sleep, runtime-error, wakelock

我有一个应用程序从下面的接收器调用一个类。当手机处于唤醒状态时它工作正常，但是一旦它进入睡眠状态，它就会从 logcat 返回以下错误： E/DeepSleepService(745): checkWakeLocks 捕获异常 java.io.FileNotFoundException: /sys/power/active_wake_lock:打开失败：ENOENT（没有这样的文件或目录）

我正在 Android 4.0.4 上进行测试；DROID RAZR Build/6.7.2-180_DHD-16_M4-31

这是接收器类：

```
 import android.content.BroadcastReceiver;
    import android.content.Context;
    import android.content.Intent;
    import android.os.PowerManager;
    import android.util.Log;

    public class OnAlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        //Tried this alone, which is supposed to handle the wakelock:
        //AlarmAlertWakeLock.acquireCpuWakeLock(context);

        //Also tried manually acquiring and releasing:
        PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);
        PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "wakelock");
        wl.acquire();
        //Results were the same for either code

        context.startService(new Intent(context, Track.class));

        wl.release();

    }

} 
```

这是 AlarmAlertWakeLock 类：

```
 import android.content.Context;
    import android.os.PowerManager;
    import android.util.Log;

    class AlarmAlertWakeLock {
        private static PowerManager.WakeLock sCpuWakeLock;

        static void acquireCpuWakeLock(Context context) {
            if (sCpuWakeLock != null) {
                return;
            }
            PowerManager pm = (PowerManager) context.getSystemService(Context.POWER_SERVICE);

            sCpuWakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "AlarmAlertWakeLock");
            sCpuWakeLock.acquire();
        }

        static void releaseCpuLock() {
            if (sCpuWakeLock != null) {
                sCpuWakeLock.release();
                sCpuWakeLock = null;
            }
        }
    } 
```

我已经注册了接收者并在我的清单中添加了权限：

```
<uses-permission android:name="android.permission.WAKE_LOCK" />

<receiver android:name="com.myApp.OnAlarmReceiver" 
    android:enabled="true" 
    android:exported="false"
    android:label="OnAlarmReceiver">
</receiver> 
```

日志猫：

```
11-09 18:29:09.718: E/LSApp_App(21784): Sending Message to Handler (com.motorola.contextual.virtualsensor.locationsensor.LocationDetection$MessageHandler) {4142d448}: msg :1010003
11-09 18:29:09.797: E/RulePersistence(21784): getActiveRulesString(): move to first failed
11-09 18:29:10.742: E/ConditionBuilderService(21784): vSensorCreation string is null
11-09 18:29:10.765: E/ConditionBuilderService(21784): Condition sensor table cursor closed
11-09 18:29:10.836: E/ConditionBuilderService(21784): Condition sensor table cursor closed
11-09 18:29:11.031: E/ConditionBuilderService(21784): Condition sensor table cursor closed
11-09 18:29:20.320: E/ExternalAccountType(759): Unsupported attribute readOnly
11-09 18:29:21.812: E/SPYPHONE_DEBUG: Activity onCreate() start(21961): SPYPHONE_DEBUG: Activity onCreate() start
11-09 18:29:21.890: E/SPYPHONE_DEBUG: Activity onCreate() end(21961): SPYPHONE_DEBUG: Activity onCreate() end
11-09 18:29:25.883: E/SPYPHONE_DEBUG: Activity initSpyService() start(21961): SPYPHONE_DEBUG: Activity initSpyService() start
11-09 18:29:25.890: E/SPYPHONE_DEBUG: Activity initSpyService() end(21961): SPYPHONE_DEBUG: Activity initSpyService() end
11-09 18:29:52.906: E/SPYPHONE_DEBUG: DoInBackground-inputs(21961): mm@mm.com-qqaazzxx
11-09 18:29:52.906: E/SPYPHONE_DEBUG: authenticateInfo() start(21961): SPYPHONE_DEBUG: authenticateInfo() start
11-09 18:29:54.601: E/response:(21961): {"d":"userPassMatch"}
11-09 18:29:54.601: E/response:(21961): disconnected
11-09 18:29:54.601: E/SPYPHONE_DEBUG: DoInBackground-result(21961): userPassMatch
11-09 18:29:54.664: E/SPYPHONE_DEBUG: BroadcastReceiver onReceive() start(21961): SPYPHONE_DEBUG: BroadcastReceiver onReceive() start
11-09 18:29:54.664: E/SPYPHONE_DEBUG: BroadcastReceiver onReceive() with the auto-boot load intent(21961): SPYPHONE_DEBUG: BroadcastReceiver onReceive() with the auto-boot load intent
11-09 18:29:54.672: E/SPYPHONE_DEBUG: initGPS() start(21961): SPYPHONE_DEBUG: initGPS() start
11-09 18:29:54.703: E/SPYPHONE_DEBUG: initGPS() end(21961): SPYPHONE_DEBUG: initGPS() end
11-09 18:29:54.703: E/SPYPHONE_DEBUG: BroadcastReceiver onReceive() eulaTest passed, continue..(21961): SPYPHONE_DEBUG: BroadcastReceiver onReceive() eulaTest passed, continue..
11-09 18:29:54.703: E/SPYPHONE_DEBUG: BroadcastReceiver onReceive() end(21961): SPYPHONE_DEBUG: BroadcastReceiver onReceive() end
11-09 18:29:54.789: E/SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener(21961): SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener
11-09 18:29:54.789: E/SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0(21961): SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0
11-09 18:29:56.750: E/SPYPHONE_DEBUG: Acquiring cpu wake lock(21961): SPYPHONE_DEBUG: Acquiring cpu wake lock
11-09 18:29:56.750: E/SPYPHONE_DEBUG: sCpuWakeLock is null(21961): SPYPHONE_DEBUG: sCpuWakeLock is null
11-09 18:29:56.804: E/SPYPHONE_DEBUG: onStartCommand() start(21961): SPYPHONE_DEBUG: onStartCommand() start
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLatestTimestampValues() start(21961): SPYPHONE_DEBUG: getLatestTimestampValues() start
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLastKnownLocation() gps 401(21961): SPYPHONE_DEBUG: getLastKnownLocation() gps 401
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822
11-09 18:29:56.804: E/SPYPHONE_DEBUG: getLastKnownLocation() 1.2(21961): SPYPHONE_DEBUG: getLastKnownLocation() 1.2
11-09 18:29:56.812: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): Before
11-09 18:29:57.187: E/response:(21961): {"d":"1352320124198|1352043411304|1352481165115|1352477440841"}
11-09 18:29:57.187: E/response:(21961): disconnected
11-09 18:29:57.187: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): after
11-09 18:29:57.195: E/SPYPHONE_DEBUG: result length: 1(21961): SPYPHONE_DEBUG: result length: 1
11-09 18:29:57.195: E/SPYPHONE_DEBUG: getAllPhoneData() start(21961): SPYPHONE_DEBUG: getAllPhoneData() start
11-09 18:29:57.195: E/SPYPHONE_DEBUG: getAllPhoneData(): getting the call_log/calls URI(21961): SPYPHONE_DEBUG: getAllPhoneData(): getting the call_log/calls URI
11-09 18:29:57.195: E/SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor(21961): SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor
11-09 18:29:57.195: E/SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor(21961): [ 11-09 18:29:57.195 21961:0x55c9 E/SPYPHONE_DEBUG: getPhoneData() exception - Permission Denial: opening provider com.android.SPYPHONE_DEBUG: getPhoneData() exception - Permission Denial: opening provider com.android.providers.contacts.CallLogProvider from ProcessRecord{414967a8 21961:com.spyphone1/10006} (pid=21961, uid=10006) requires android.permission.READ_CONTACTS or android.permission.WRITE_CONTACTS
11-09 18:29:57.195: E/SPYPHONE_DEBUG: 6 routine end(21961): SPYPHONE_DEBUG: 6 routine end
11-09 18:29:57.195: E/SPYPHONE_DEBUG: getAllSMSData() start(21961): SPYPHONE_DEBUG: getAllSMSData() start
11-09 18:29:57.203: E/SPYPHONE_DEBUG: getWebBrowserHistoryData() start(21961): SPYPHONE_DEBUG: getWebBrowserHistoryData() start
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getWebBrowserHistoryData() end(21961): SPYPHONE_DEBUG: getWebBrowserHistoryData() end
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getGPSData() start(21961): SPYPHONE_DEBUG: getGPSData() start
11-09 18:29:57.258: E/SPYPHONE_DEBUG: gps 400(21961): SPYPHONE_DEBUG: gps 400
11-09 18:29:57.258: E/SPYPHONE_DEBUG: gps 401(21961): SPYPHONE_DEBUG: gps 401
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getLastKnownLocation() gps 401(21961): SPYPHONE_DEBUG: getLastKnownLocation() gps 401
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getLastKnownLocation() 1.2(21961): SPYPHONE_DEBUG: getLastKnownLocation() 1.2
11-09 18:29:57.258: E/SPYPHONE_DEBUG: gps 4(21961): SPYPHONE_DEBUG: gps 4
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getGPSData() currentLatitude: 39.2077425(21961): SPYPHONE_DEBUG: getGPSData() currentLatitude: 39.2077425
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getGPSData() currentLongitude: -77.7477822(21961): SPYPHONE_DEBUG: getGPSData() currentLongitude: -77.7477822
11-09 18:29:57.258: E/SPYPHONE_DEBUG: getGPSData() time: 1352503794731(21961): SPYPHONE_DEBUG: getGPSData() time: 1352503794731
11-09 18:29:57.258: E/SPYPHONE_DEBUG: initGPS() start(21961): SPYPHONE_DEBUG: initGPS() start
11-09 18:29:57.265: E/SPYPHONE_DEBUG: initGPS() end(21961): SPYPHONE_DEBUG: initGPS() end
11-09 18:29:57.265: E/SPYPHONE_DEBUG: getGPSData() end(21961): SPYPHONE_DEBUG: getGPSData() end
11-09 18:29:57.265: E/SPYPHONE_DEBUG: processTrackingData() start(21961): SPYPHONE_DEBUG: processTrackingData() start
11-09 18:29:57.273: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): Before
11-09 18:29:57.375: E/response:(21961): {"d":"{success}"}
11-09 18:29:57.375: E/response:(21961): disconnected
11-09 18:29:57.375: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): after
11-09 18:29:57.375: E/SPYPHONE_DEBUG: getLatestTimestampValues() end(21961): SPYPHONE_DEBUG: getLatestTimestampValues() end
11-09 18:29:57.375: E/SPYPHONE_DEBUG: onStartCommand() end(21961): SPYPHONE_DEBUG: onStartCommand() end
11-09 18:29:57.383: E/SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener(21961): SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener
11-09 18:29:57.383: E/SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0(21961): SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0
11-09 18:29:57.781: E/libgps(375): recv_command_status() : fix returned error code 9
11-09 18:29:57.781: E/libgps(375): numsats histogram: 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
11-09 18:29:57.781: E/libgps(375): sats histogram: 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
11-09 18:29:59.461: E/SPYPHONE_DEBUG: initGPS() locationChanged listener(21961): SPYPHONE_DEBUG: initGPS() locationChanged listener
11-09 18:29:59.461: E/SPYPHONE_DEBUG: initGPS() locationChanged listener(21961): [ 11-09 18:29:59.468 21961:0x55c9 E/SPYPHONE_DEBUG: initGPS() locationChanged done. within 20 meters of current working fix. acSPYPHONE_DEBUG: initGPS() locationChanged done. within 20 meters of current working fix. accuracy - 16.0
11-09 18:30:56.726: E/SPYPHONE_DEBUG: Acquiring cpu wake lock(21961): SPYPHONE_DEBUG: Acquiring cpu wake lock
11-09 18:30:56.726: E/SPYPHONE_DEBUG: sCpuWakeLock != null(21961): SPYPHONE_DEBUG: sCpuWakeLock != null
11-09 18:30:56.726: E/SPYPHONE_DEBUG: onStartCommand() start(21961): SPYPHONE_DEBUG: onStartCommand() start
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLatestTimestampValues() start(21961): SPYPHONE_DEBUG: getLatestTimestampValues() start
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() gps 401(21961): SPYPHONE_DEBUG: getLastKnownLocation() gps 401
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation: 16.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation: 16.0
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation lat: 39.14668123333333(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation lat: 39.14668123333333
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation long: -77.7596563(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation long: -77.7596563
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822
11-09 18:30:56.726: E/SPYPHONE_DEBUG: getLastKnownLocation() 1(21961): SPYPHONE_DEBUG: getLastKnownLocation() 1
11-09 18:30:56.734: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): Before
11-09 18:30:57.343: E/response:(21961): {"d":"1352320124198|1352043411304|1352503794731|1352477440841"}
11-09 18:30:57.343: E/response:(21961): disconnected
11-09 18:30:57.343: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): after
11-09 18:30:57.343: E/SPYPHONE_DEBUG: result length: 1(21961): SPYPHONE_DEBUG: result length: 1
11-09 18:30:57.343: E/SPYPHONE_DEBUG: getAllPhoneData() start(21961): SPYPHONE_DEBUG: getAllPhoneData() start
11-09 18:30:57.343: E/SPYPHONE_DEBUG: getAllPhoneData(): getting the call_log/calls URI(21961): SPYPHONE_DEBUG: getAllPhoneData(): getting the call_log/calls URI
11-09 18:30:57.343: E/SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor(21961): SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor
11-09 18:30:57.343: E/SPYPHONE_DEBUG: getAllPhoneData(): query the calls cursor(21961): [ 11-09 18:30:57.343 21961:0x55c9 E/SPYPHONE_DEBUG: getPhoneData() exception - Permission Denial: opening provider com.android.SPYPHONE_DEBUG: getPhoneData() exception - Permission Denial: opening provider com.android.providers.contacts.CallLogProvider from ProcessRecord{414967a8 21961:com.spyphone1/10006} (pid=21961, uid=10006) requires android.permission.READ_CONTACTS or android.permission.WRITE_CONTACTS
11-09 18:30:57.343: E/SPYPHONE_DEBUG: 6 routine end(21961): SPYPHONE_DEBUG: 6 routine end
11-09 18:30:57.343: E/SPYPHONE_DEBUG: getAllSMSData() start(21961): SPYPHONE_DEBUG: getAllSMSData() start
11-09 18:30:57.351: E/SPYPHONE_DEBUG: getWebBrowserHistoryData() start(21961): SPYPHONE_DEBUG: getWebBrowserHistoryData() start
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getWebBrowserHistoryData() end(21961): SPYPHONE_DEBUG: getWebBrowserHistoryData() end
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getGPSData() start(21961): SPYPHONE_DEBUG: getGPSData() start
11-09 18:30:57.398: E/SPYPHONE_DEBUG: gps 400(21961): SPYPHONE_DEBUG: gps 400
11-09 18:30:57.398: E/SPYPHONE_DEBUG: gps 401(21961): SPYPHONE_DEBUG: gps 401
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() gps 401(21961): SPYPHONE_DEBUG: getLastKnownLocation() gps 401
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation: 16.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation: 16.0
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation lat: 39.14668123333333(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation lat: 39.14668123333333
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() curLocation long: -77.7596563(21961): SPYPHONE_DEBUG: getLastKnownLocation() curLocation long: -77.7596563
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation: 3948.0
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation lat: 39.2077425
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822(21961): SPYPHONE_DEBUG: getLastKnownLocation() NETWORK curLocation long: -77.7477822
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getLastKnownLocation() 1(21961): SPYPHONE_DEBUG: getLastKnownLocation() 1
11-09 18:30:57.398: E/SPYPHONE_DEBUG: gps 4(21961): SPYPHONE_DEBUG: gps 4
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getGPSData() currentLatitude: 39.14668123333333(21961): SPYPHONE_DEBUG: getGPSData() currentLatitude: 39.14668123333333
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getGPSData() currentLongitude: -77.7596563(21961): SPYPHONE_DEBUG: getGPSData() currentLongitude: -77.7596563
11-09 18:30:57.398: E/SPYPHONE_DEBUG: getGPSData() time: 1352503783000(21961): SPYPHONE_DEBUG: getGPSData() time: 1352503783000
11-09 18:30:57.398: E/SPYPHONE_DEBUG: initGPS() start(21961): SPYPHONE_DEBUG: initGPS() start
11-09 18:30:57.406: E/SPYPHONE_DEBUG: initGPS() end(21961): SPYPHONE_DEBUG: initGPS() end
11-09 18:30:57.406: E/SPYPHONE_DEBUG: getGPSData() end(21961): SPYPHONE_DEBUG: getGPSData() end
11-09 18:30:57.406: E/SPYPHONE_DEBUG: processTrackingData() start(21961): SPYPHONE_DEBUG: processTrackingData() start
11-09 18:30:57.414: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): Before
11-09 18:30:57.562: E/response:(21961): {"d":"{success}"}
11-09 18:30:57.562: E/response:(21961): disconnected
11-09 18:30:57.562: E/SPYPHONE_DEBUG: GetLatestTimestamp(21961): after
11-09 18:30:57.562: E/SPYPHONE_DEBUG: getLatestTimestampValues() end(21961): SPYPHONE_DEBUG: getLatestTimestampValues() end
11-09 18:30:57.562: E/SPYPHONE_DEBUG: onStartCommand() end(21961): SPYPHONE_DEBUG: onStartCommand() end
11-09 18:30:57.570: E/SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener(21961): SPYPHONE_DEBUG: initGPS() locationChanged NETWORKlistener
11-09 18:30:57.570: E/SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0(21961): SPYPHONE_DEBUG: initGPS() NETWORK locationChanged still listening... accuracy: 3948.0
11-09 18:31:02.453: E/SPYPHONE_DEBUG: initGPS() locationChanged listener(21961): SPYPHONE_DEBUG: initGPS() locationChanged listener
11-09 18:31:02.453: E/SPYPHONE_DEBUG: initGPS() locationChanged still listening... accuracy: 48.0(21961): SPYPHONE_DEBUG: initGPS() locationChanged still listening... accuracy: 48.0
11-09 18:31:07.023: E/BluetoothService.cpp(375): setBluetoothTetheringNative false
11-09 18:31:07.031: E/BluetoothService(375): FTP is not supported
11-09 18:31:07.031: E/BluetoothService(375): DUN is not supported
11-09 18:31:07.031: E/BluetoothService(375): SAP is not supported
11-09 18:31:07.578: E/DeepSleepService(745): checkWakeLocks caught Exception java.io.FileNotFoundException: /sys/power/active_wake_lock: open failed: ENOENT (No such file or directory)
11-09 18:31:07.593: E/RDS(375): RdsReadSvrMsg: READ HEADER FAIL 0 32 0
11-09 18:31:07.601: E/DeepSleepService(745): checkWakeLocks caught Exception java.io.FileNotFoundException: /sys/power/active_wake_lock: open failed: ENOENT (No such file or directory)
11-09 18:31:07.601: E/power(375): Failed setting last user activity: g_error=0
11-09 18:31:08.211: E/AudioHardwareMot(165): Error:Unsupported key = screen_state=off
11-09 18:31:08.554: E/SecondaryTablController(159): ip route del failed: /system/bin/ip route del fe80::1:2:3:4/128 via :: dev rmnet0 table 60
11-09 18:31:08.554: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet0 secondary fe80::1:2:3:4 128 ::} failed with code 400 : {ip route modification failed (No such device)}
11-09 18:31:08.586: E/SecondaryTablController(159): ip route del failed: /system/bin/ip route del ::/0 via fe80::1:2:3:4 dev rmnet0 table 60
11-09 18:31:08.593: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet0 secondary :: 0 fe80::1:2:3:4} failed with code 400 : {ip route modification failed (No such device)}
11-09 18:31:08.601: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet0 default 2001:4888:2:fffe:a0:d:0:3 128 fe80::1:2:3:4} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:08.609: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet0 default 2001:4888:3:fffe:c0:d:0:3 128 fe80::1:2:3:4} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:08.656: E/IMSCNative(785): There is no UnRegistration success or fail received before operation completed.
11-09 18:31:08.679: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet1 default 10.168.113.229 32 0.0.0.0} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:08.687: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet1 default 0.0.0.0 0 10.168.113.229} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:08.734: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet1 default fe80::2:2:3:4 128 ::} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:08.734: E/ConnectivityService(375): Exception trying to remove a route: java.lang.IllegalStateException: Unable to communicate with native dameon to add routes - com.android.server.NativeDaemonConnectorException: Cmd {interface route remove rmnet1 default :: 0 fe80::2:2:3:4} failed with code 400 : {Failed to remove route from default table (No such device)}
11-09 18:31:09.218: E/IMSService(669): on handleMessage with 2 event
11-09 18:31:11.656: E/Tethering(375): Can't get networkInfo
11-09 18:31:11.679: E/Tethering(375): Can't get networkInfo
11-09 18:31:11.804: E/Tethering(375): Can't get networkInfo
11-09 18:31:12.211: E/PolicyLoader(22161): Couldn't find or open policies file moto_policies.xml
11-09 18:31:12.531: E/C2DMRegistrar(842): [C2DMReg] handleRequest caught org.apache.http.conn.HttpHostConnectException: Connection to https://android.clients.google.com refused
11-09 18:31:12.961: E/PacketReader(686): Error parsing packet: 
11-09 18:31:12.961: E/PacketReader(686): java.io.EOFException: no more data available - expected end tag </stream:stream> to close start tag <stream:stream> from line 1, parser stopped on END_TAG seen ...</query></iq><iq type="result" id="vb43G-85"/>... @1:519
11-09 18:31:12.961: E/PacketReader(686):    at org.xmlpull.mxp1.MXParser.fillBuf(MXParser.java:3044)
11-09 18:31:12.961: E/PacketReader(686):    at org.xmlpull.mxp1.MXParser.more(MXParser.java:3055)
11-09 18:31:12.961: E/PacketReader(686):    at org.xmlpull.mxp1.MXParser.nextImpl(MXParser.java:1153)
11-09 18:31:12.961: E/PacketReader(686):    at org.xmlpull.mxp1.MXParser.next(MXParser.java:1102)
11-09 18:31:12.961: E/PacketReader(686):    at org.jivesoftware.smack.PacketReader.parseXMPPPacket(PacketReader.java:503)
11-09 18:31:12.961: E/PacketReader(686):    at org.jivesoftware.smack.PacketReader.parsePackets(PacketReader.java:338)
11-09 18:31:12.961: E/PacketReader(686):    at org.jivesoftware.smack.PacketReader.access$000(PacketReader.java:62)
11-09 18:31:12.961: E/PacketReader(686):    at org.jivesoftware.smack.PacketReader$1.run(PacketReader.java:99)
11-09 18:31:13.336: E/MCDashboardWidgetProvider(22311):  intent false android.net.conn.CONNECTIVITY_CHANGE mMotoConnectActivated - false
11-09 18:31:13.343: E/MCDashboardWidgetProvider(22311): N/W connectivity = false
11-09 18:31:13.398: E/MCDashboardWidgetProvider(22311): Service Connected
11-09 18:31:13.453: E/MCDashboardWidgetProvider(22311): MCSvc isUserSetup, isAuthenticated, ready ->false false true
11-09 18:31:13.453: E/MCDashboardWidgetProvider(22311): Not Activated
11-09 18:31:13.664: E/IMSCNetwork(785): isImsModeValid, IMSCConfReader is not started
11-09 18:31:14.672: E/MCDashboardWidgetProvider(22311):  intent false android.net.conn.CONNECTIVITY_CHANGE mMotoConnectActivated - false
11-09 18:31:14.672: E/MCDashboardWidgetProvider(22311): N/W connectivity = false
11-09 18:31:15.797: E/MCDashboardWidgetProvider(22311):  intent false android.net.conn.CONNECTIVITY_CHANGE mMotoConnectActivated - false
11-09 18:31:15.797: E/MCDashboardWidgetProvider(22311): N/W connectivity = true 
```

知道手机进入睡眠状态时导致此错误的原因是什么，以及如何解决？

# c# - 协方差问题

> ID：13316838
> 
> 赞同：0
> 
> 时间：2012-11-09T22:17:22.687
> 
> 标签：c#, generics

我在以下铸造方面遇到了一些问题：

```
 class A 
    { 
    }

    class B : A 
    {
    }

    class C<T> where T : A
    {
        protected T property { get; set; }
    }

    class D : C<B> 
    {
    }

    class MainClass
    {
        public static void Main (string[] args)
        {
            C<A> x = new D();
            // Error CS0029: Cannot implicitly convert type `SampleApp.D' to `SampleApp.C<SampleApp.A>' (CS0029) (SampleApp)
        }
    } 
```

我不明白为什么这会失败，因为它`D`比`C<A>`实现`C<B>`, 和`B : A`. 任何解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:34:37.927

如果可以使用 C# 4.0，则可以编写以下代码。

```
class A { }
class B : A {}

interface IC<out T> {}
class C<T> :IC<T> where T : A { protected T property { get; set; }  }

class D : C<B> {}

class MainClass {
    public static void Main()
    {
        IC<A> x = new D();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:28:10.977

让我们将您的类命名`Animal`为 for `A`、`Barker`for`B`和`Dog`for `D`。

其实`C<Animal>`比`Dog : C<Barker>`. 假设您有可能`Me`的类型`T`和赋值的公共属性：

```
C<Animal> a = new Dog();
a.Me = Elephant; // where Elephant inherited from Animal 
```

哎呀！`Dog`用 参数化`Barker`。你见过吠叫的大象吗？

您需要声明一些协变接口，以允许将使用更多派生类型参数实例化的类分配`C<Barker>`给使用较少派生类型参数实例化的对象`C<Animal>`。您可以使用空接口，如@NickW 建议的那样，但您将无法对该接口的实例执行某些操作（它是空的！）。所以，让我们做这样的事情：

```
interface IC<out T>
    where T : Animal
{
    IEnumerable<T> Parents(); // IEnumerable is covariant
    T Me { get; } // no setter
}

class C<T> : IC<T>
    where T: Animal
{
    // implementation
}

class D : C<Barker>
{
    // implementation
} 
```

上述情况仍然是不可能的，但现在你可以

```
IC<Animal> a = new Dog();
foreach(var parent in a.Parents)
     Console.WriteLine(parent);

Console.WriteLine(a.Me); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T22:22:13.620

你不能这样做，因为泛型实际上是模板，它们的行为不像你想用它们做的那样。让我通过这个来告诉你：

当您说它`"C<A>"`意味着 a 的泛型类`"parameter"`时`"A"`。但是当你说它`"D"`的意思时`"D"`！

因此，通过 A 的参数，D 不等于泛型类。您可以在两种类型的 ToString 函数的结果中简单地看到它（通过使用 typeof）。

希望能帮助到你

干杯

# php - PHP / SQL 和模块化

> ID：13316840
> 
> 赞同：2
> 
> 时间：2012-11-09T22:17:29.947
> 
> 标签：php, sql, module, procedure

我目前正在开发一个小型的自制 PHP 框架。

我希望它能够自动管理用户连接、用户组以及用户和组的访问权限等内容。

然而，有些网站可能不需要这些东西。例如，博客和展示网站可能不需要组或页面访问管理。

为了避免在框架中包含未使用的东西，我想把它分成 3 个独立的模块（下一个可能更多）。这些模块中的每一个都有自己的 SQL 安装脚本，该脚本将创建模块自己的表，并更改它们依赖的其他表（添加列、外键等）。

假设我们有 3 个模块：“用户”、“组”、“访问”。

现在让我们假设所有 3 个模块都包含在内，数据库将如下所示：

```
user :
- id
- login
- password

group :
- id
- label

right :
- id
- label

user_group :
- userId
- groupId

user_right :
- userId
- rightId

group_right :
- groupId
- rightId 
```

用户模块 SQL 脚本将创建用户表。

group 模块 SQL 脚本将创建 group 和 user_group 表。

访问模块 SQL 脚本将创建正确的表，并且...这就是我的问题所在：它还会创建 user_right 和 group_right 表吗？为了确定我需要检查访问模块安装 SQL 脚本内部是否包含其他两个模块（或者至少是组模块，因为没有用户就没有权限）。

有没有办法做类似的事情：

```
if table exists 'group' create table 'group_right' ... 
```

如果可能的话，我也希望这是跨数据库。

我也可以使用 PHP 脚本而不是 SQL 脚本来测试模块文件夹是否存在，并使用 PDO 执行正确的查询，但这看起来有点脏。

欢迎任何关于我如何做到这一点的建议:) 感谢您的阅读。

# sql - 如何将带时区的日期时间插入 SQLite？

> ID：13316845
> 
> 赞同：17
> 
> 时间：2012-11-09T22:18:12.313
> 
> 标签：sql, sqlite, datetime, timezone, timestamp

我知道要插入日期时间，`yyyy-mm-dd hh:mm:ss`应该使用这种格式。

但是，我的数据集有一个类似于 的时间戳字段`yyyy-mm-dd hh:mm:ss +/-0X:00`，其中`X`可以采用许多值，并且与我计算机的本地时区不同。

将具有此类时区信息的日期时间字段插入 SQLite 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-10T11:51:07.953

[SQLite 的内置日期和时间函数](https://www.sqlite.org/lang_datefunc.html)理解这些字符串中的时区规范，但是对于不同的时区，对这些字符串的任何其他操作（甚至搜索和比较）都将无法正常工作。

如果你想处理时区，你必须要么

*   将所有时间戳转换为一个特定的时区 (UTC)，以便您可以使用它们进行排序和搜索；或者
*   将时区信息保留在其中，但不要在 SQL 中而是在您的应用程序中进行所有搜索、排序和其他计算。

# c# - WinForms 应用程序中的 StructureMap 缓存

> ID：13316846
> 
> 赞同：0
> 
> 时间：2012-11-09T22:18:24.127
> 
> 标签：c#, asp.net, winforms, structuremap, web-to-winforms

我们一直在 WebApps (MVC) 中使用结构图，它很棒。

我在我的 winForms 应用程序中也使用了我们在 WebApps 中使用的相同库，它在整个过程中都有结构图。我有明显的内存泄漏问题，我希望我可以通过结构映射中的缓存来解决它。

以下是可用的类型。

PerRequest - 默认操作。将为每个请求创建一个新实例。Singleton - 单个实例将在所有请求之间共享 ThreadLocal - 将为每个请求线程创建一个实例。使用 ThreadLocalStorage 缓存实例。HttpContext - 将为每个 HttpContext 创建一个实例。缓存 HttpContext.Items 集合中的实例。HttpSession - 将为每个 HttpSession 创建一个实例。缓存 HttpContext.Session 集合中的实例。谨慎使用。混合 - 如果存在则使用 HttpContext 存储，否则使用 ThreadLocal 存储。

不用说，除了单例和本地线程之外，它们看起来非常特定于网络。

如果我想让实例消失，有什么方法可以做到，而我想做的每个“事情”都没有一个线程，并完全序列化它们？

我知道结构图和 using 子句不能很好地相互配合，但我现在坚持使用它。有一个已知的技巧可以让他们玩得很好吗？

谢谢，

卡尔-

# ruby-on-rails-3 - 在模型rails 3中搜索多个列

> ID：13316855
> 
> 赞同：2
> 
> 时间：2012-11-09T22:18:58.617
> 
> 标签：ruby-on-rails-3

我有一个搜索表单，可以在其中搜索我的食谱模型中的一列

```
@countrysearch = Recipe.where(:dish_name => params[:search]).all 
```

因此，当我搜索一道菜时说千层面我得到了一个结果，但是我希望能够在食谱模型中搜索另外 3 列，即 country_of_origin、难度和 preperation_time。

我试过这个

```
@countrysearch = Recipe.where({:dish_name => params[:search], :country_of_origin => params[:search], :difficulty => params[:search], :preperation_time => params[:search]}).all 
```

但这似乎也不起作用

任何人都可以提供建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:24:05.423

您的代码使用`AND`但您希望`OR`我认为：

```
@countrysearch = Recipe.where("dish_name = ? OR country_of_origin = ? OR difficulty = ? OR preperation_time = ?",
    params[:search],
    params[:search],
    params[:search],
    params[:search]
) 
```

如果您不想使用 SQL 字符串，可以使用`arel_table`：

```
at             = Recipe.arel_table
search         = params[:search]
@countrysearch = Recipe.where(at[:dish_name].eq(search).or(at[:country_of_origin].eq(search)).or(at[:difficulty].eq(search)).or(at[:preperation_time].eq(search))) 
```

但是对于当前版本的 Rails，我更喜欢第一种方法，因为这样可读性更好。在 Rails 5 中，您将有更好的方法来处理此类查询。（如果可用，我会更新这篇文章。）

# php - 如何在vim中生成块注释

> ID：13316858
> 
> 赞同：4
> 
> 时间：2012-11-09T22:19:05.640
> 
> 标签：php, javascript, vim, vi

我想使用 vim 为文档自动生成块注释。

就像是：

```
/**
 * comment
 */ 
```

有什么插件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T01:30:15.347

Vim 内置了这个功能。详情请参阅`:help format-comments`。基本上，如果您`filetype plugin on`在 ~/.vimrc 中使用括号语言（如 C、C++、Java、javascript 等），您可以键入`/**<cr>`并将其扩展为：

```
/**
 * _ 
```

`_`光标位置在哪里。当您完成评论块时，只需点击`/`即可结束它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T23:34:59.037

使用 C 或 Java 样式的块注释来简化 Vimmer 生活的一种低成本方法是将以下映射添加到`.vimrc`.

```
autocmd FileType c,java inoreabbrev <buffer> /** /**<CR>/<Up> 
```

这样，每当您输入`/**<Enter>`C 或 Java 源代码时，它将扩展为以下内容，光标位于`_`：

```
/**
 * _
 */ 
```

**编辑：**正如@Conner 提到的，你需要`filetype plugin indent on`在你的 vimrc 中才能完成这项工作。

# android - 是否有推荐的将文件保存在 SD 卡上的路径？

> ID：13316864
> 
> 赞同：0
> 
> 时间：2012-11-09T22:20:12.933
> 
> 标签：android

我在 sd 卡中看到所有应用程序的文件，所以似乎没有 android 标准。但是在外部保存应用程序相关文件时，是否有推荐的目录路径或通用做法？

IE。(sdcard)/myapp/ 或 (sdcard)/apps/myapp/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:21:50.063

你应该首先使用：

```
Environment.getExternalStorageDirectory(); 
```

找出SD卡的位置。从那里通常只是您的应用程序名称作为存储任何文件的文件夹。或者这似乎是查看我手机的标准。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:24:36.007

我会这样做：

```
Environment.getExternalStorageDirectory() + "Android/data/" + yourpackagename; 
```

如果你检查这个文件，你可以在这里看到很多应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T22:28:34.457

只需[`Environment#getExternalStoragePublicDirectory(String type)`](http://developer.android.com/reference/android/os/Environment.html#getExternalStoragePublicDirectory%28java.lang.String%29)与特定文件夹的各种字符串类型一起使用。

这会在`.../sdcard/Android/data/my.package.name/<type>`.

来自[开发者指南](http://developer.android.com/guide/topics/data/data-storage.html#filesExternal)：

> 在 API 级别 8 或更高版本中，使用 getExternalStoragePublicDirectory()，将您想要的公共目录类型传递给它，例如 DIRECTORY_MUSIC、DIRECTORY_PICTURES、DIRECTORY_RINGTONES 或其他。如有必要，此方法将创建适当的目录。
> 
> 如果您使用 API 级别 7 或更低，请使用 getExternalStorageDirectory() ...

# mysql - mysql将另一列更新为主键值

> ID：13316866
> 
> 赞同：2
> 
> 时间：2012-11-09T22:20:27.430
> 
> 标签：mysql, sql

有没有办法将另一列的值设置为主键（自动增量）？

基本上我想要实现的是这个

```
ID     Stuff
----   ------
1      1
2      324
3      64
4      94
5      ... 
```

现在，当我使用如下查询添加第五行时

```
INSERT into TABLE values(NULL, NULL); 
```

所以当第二个值是`NULL`我希望它等于 ID 时。

我尝试了 INSERT 触发器，但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:36:28.237

我认为您无法一步完成，但您可以先插入然后更新...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T08:39:17.027

尝试这个：

```
INSERT INTO `TABLE` (`ID`,`Stuff`) VALUES(NULL, `ID`); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T22:43:00.577

一种可能性是公开一个存储过程，当 Stuff 参数为空时，使用 LAST_INSERT_ID() 更新插入，否则将非空值传递给插入。

# c# - 为什么 C# SerializedAttribute 是密封的？

> ID：13316868
> 
> 赞同：1
> 
> 时间：2012-11-09T22:21:05.240
> 
> 标签：c#

我试图创建一个暗示的属性，`[Serializable]`但我注意到这个`SerializableAttribute`类是密封的。

在 Java 中，可以创建一个从interface`MyInterface`继承的接口（比如`Serializable``MyInterface`

假设我正在创建一个 ORM，并且我希望客户将他们的实体类注释为，`[DatabaseEntity]`但为了确保实体是可序列化的，我还需要要求他们为他们的类赋予额外的属性，`[Serializable]`这看起来不太紧凑和整洁。

我想知道为什么`SerializableAttribute`class 是**`sealed`**以及为什么有**`Inherited=false`**这意味着除非明确说明，否则可序列化类的子类将不可序列化。这些设计选择背后的动机是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T22:38:01.860

SerializableAttribute 仅由 BinaryFormatter 使用。如果您正在编写自己的序列化程序，请不要担心。

`sealed`关键字应用于属性而不是与属性关联的类。这是说 SerializableAttribute 不能被子类化。

使用`BinaryFormatter`选择加入模型。任何类（或子类）都必须指定它是可序列化的。这就是为什么`Inherited=false`使用 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T10:49:00.817

[根据 Microsoft](http://msdn.microsoft.com/en-us/library/ms182267%28v=vs.80%29.aspx)的建议，最好的做法是密封*所有*.Net 属性：

> .NET Framework 类库提供检索自定义属性的方法。默认情况下，这些方法搜索属性继承层次结构；例如`System.Attribute.GetCustomAttribute`搜索指定的属性类型，或扩展指定属性类型的任何属性类型。**密封属性**消除了通过继承层次结构的搜索，并且**可以提高性能**。[我的重点]

所以`[Serializable]`是密封的，因为 .Net 反射检查属性更快。代价是你不能继承和扩展`SerializableAttribute`。

如果需要，您可以创建自己的未密封属性（尽管您会收到代码分析警告）。

这有点让人困惑，属性是如何在继承中用于它们所应用的类的。最好使用一个例子：

```
[Serializable]
public class A
{
    public int SimpleSerialisableProperty { get; set;}
}

public class B : A
{
    public C ComplexReferenceProperty { get; set; }
}

[Serializable]
public class D : A
{
    public bool AnotherSerialisableProperty { get; set;}
} 
```

你问为什么`SerializableAttribute.Inherited = false`，这就是为什么：

*   类`A`被标记为`[Serializable]`，它是。

*   但是，类`B`继承`A`并使用不可序列化的属性扩展它。如果 .Net 尝试序列化`B`，它将遇到错误。

*   这`Inherited = false`告诉 .Net 仅仅因为`A`已被标记为`[Serializable]`并非每个继承它的类也都是可序列化的。

*   现在类`D`继承`A`并且是可序列化的，所以它有自己的`[Serializable]`属性。

最后，就设计而言，属性是*扩展*行为的好方法（属性网格中的漂亮 UI 编辑器等）。然而，他们在*执行*方面很糟糕。如果您需要您的客户以特定方式实现他们的实体类，那么`abstract`基类或 an`interface`是一种更好的方法。如果你把它作为一个属性，那么你基本上是让他们知道这`[Serializable]`是一个你可以处理任何一种方式的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T22:51:33.590

序列化不是一件神奇的事情，你不需要任何属性来序列化一个对象。这是一个将你的类的属性和字段写入流的过程（属性只是序列化程序关于在输出对象时如何表现的指令）。

请参阅这个过度简化的序列化程序代码，它完全忽略了所有属性，包括`NonSerializable`

```
object obj = yourObject;

var props = obj.GetType()
               .GetProperties()
               .ToDictionary(p => p.Name, p => p.GetValue(obj, null));

string serializedText = String.Join("\n",
              props.Select(kv => kv.Key + "=" + kv.Value ?? kv.Value.ToString())); 
```

例如，上面的代码会给

```
IsEmpty=False
X=3
Y=5 
```

为了`object obj = new Point(3,5);`

反序列化过程将读取这些值并相应地设置属性。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-09T22:39:52.973

将 [Serializable] 属性放在要序列化的类的顶部。序列化是选择加入的过程。您必须为要序列化的每个类手动执行此操作。还有一堆其他的关键字。

# jquery - 使用 jquery 选择第一个 div

> ID：13316869
> 
> 赞同：2
> 
> 时间：2012-11-09T22:21:05.273
> 
> 标签：jquery, html, selection

我们如何使用 jquery 选择页面的第一个 div ？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-09T22:22:30.233

jQuery 优先选择： [http ://api.jquery.com/first-selector/](http://api.jquery.com/first-selector/)

> :first 伪类等价于 :eq(0)。它也可以写成:lt(1)。虽然这仅匹配一个元素，但 :first-child 可以匹配多个：每个父元素一个。

样本：

```
var div = $('div:first'); 
```

提琴手示例：http: [//jsfiddle.net/wBQfm/](http://jsfiddle.net/wBQfm/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:22:23.257

获得第一个使用这个：

```
var first_div = $( $('div')[0] ); 
```

# jquery - 类的最后一个子元素

> ID：13316870
> 
> 赞同：1
> 
> 时间：2012-11-09T22:21:08.333
> 
> 标签：jquery, html, css

给定这个 html

```
 <div class="my_div">a</div>
    <div class="my_div">b</div>
    <div class="my_div">c</div> 
    <div>other</div> 
```

我想选择所有`.my_div`元素，但不是这个类的最后一个元素，这不正确

```
 $(".my_div:not(:last-child)").css({
                color: "#090"
            }); 
```

如何从某个类中选择所有元素，除了最后一个元素？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-09T22:22:52.823

`:last-child`正是这样，**最后一个孩子**，而不是给定标签的最后一个孩子。

jQuery 提供了[`:last`selector](http://api.jquery.com/last-selector/)，它可以做你想做的事，但代价是 jQuery 做的事情而不是浏览器做的事情。因此：

```
$("div.my_div:not(:last)").css({
    color: "#090"
}); 
```

[实例](http://jsbin.com/ewowax/1)| [来源](http://jsbin.com/ewowax/1/edit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:25:13.417

或许是这样的：

```
$(".my_div").each(function(ind,el){
 if(el == $(".my_div:last")[0]) return true;//continue;
 $(el).css({color: "#090"});
}); 
```

[http://jsfiddle.net/mys3k/1/](http://jsfiddle.net/mys3k/1/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T22:26:49.443

如果您使用带有 jQ​​uery 的 css 类来解决这个问题，可能是最简单的：

```
// add .nostlasts class to all .my_div divs
$('.my_div').addClass('notlasts');
// remove .nostlasts class from last .my_div
$( $('.my_div')[ $('.my_div').length ] ).removeClass('notlasts'); 
```

# python - Python odict：重新排序键

> ID：13316871
> 
> 赞同：0
> 
> 时间：2012-11-09T22:21:12.963
> 
> 标签：python

我想重新排序 Python odict 中的键（不是 2.7 OrderedDict）。

[https://github.com/bluedynamics/odict](https://github.com/bluedynamics/odict)

我如何实现 moveAfter() 和 moveBefore() 函数，以便我可以随机播放键？通过一些 Python 魔法是否已经存在任何类似的辅助函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T21:01:11.177

重新排序行为在这里实现：

[https://github.com/bluedynamics/node/blob/master/src/node/behaviors/order.py#L11](https://github.com/bluedynamics/node/blob/master/src/node/behaviors/order.py#L11)

业务逻辑作用于底层的 odict 数据结构。
将等效代码向上游移动到 odict 的计划已经有一段时间了。

# linux - Linux TTY 和驱动程序

> ID：13316872
> 
> 赞同：0
> 
> 时间：2012-11-09T22:21:21.293
> 
> 标签：linux, serial-port, driver

对于一个项目，我们在一个定制硬件上有几个 FTDI 串行到 USB 转换器。其中一些串行到 USB 转换器具有需要设置的特殊参数（即它们从何处获取数据）。现在，设置它的正常方法是使用 FTD2XX 库，这将允许我们直接在 USB 到串行转换器上设置数据。但是D2XX驱动不能和标准的ftdi_sio驱动同时使用，也就是说我们不能像普通设备一样使用串口。

我在这里有三个基本选择：

1.  修改标准驱动程序以使用新的 IOCTL。由于我们有一个非常具体的目标环境，我会很好，但是我不确定是否有可能处理 USB 转换器在不同模式下工作时可能出现的所有细微差别.

2.  让一切都使用 D2XX 驱动程序。这并不理想，因为如果我们需要使用另一个 FTDI USB 到串行转换器，任何需要使用该串行转换器的程序也必须使用 D2XX 驱动程序，这在我们想要使用不同的 USB 到串行转换器之前会很好（因为我们会像往常一样打开 /dev/ttyUSBX）

3.  制作一个假的 TTY，例如 /dev/serialX，然后将信息传递给 D2XX 驱动程序。这样，我们仍然可以正常打开串口，但我们可以添加新功能来做更多高级选项。命名类似于我们现在所做的，即使用 udev 创建指向正确端口的符号链接。

选项#3 可能是这里最好的选择，但我不确定具体该怎么做。我研究了[openpty](http://linux.die.net/man/3/openpty)功能，但这似乎并没有完全符合我的要求，主要是能够在假串口上设置 TTY 设置并在真实串口上设置相同的设置。我猜 mknod/mkdev 会以某种方式在这里使用，但我不知道具体如何。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:46:19.503

执行此操作的正常方法是利用 FTDI 芯片可以使用附加的小型 EEPROM 来加载配置设置这一事实。因此，您无需使用 D2XX 设置自定义参数，而是烧录 EEPROM，FTDI 将自行自动配置。然后，您只需使用 noraml 串行端口驱动程序。

# ios - 在不启动 App Store 的情况下显示 App Store 网页

> ID：13316878
> 
> 赞同：2
> 
> 时间：2012-11-09T22:21:53.853
> 
> 标签：ios

在我的 iPad 应用程序中，我想在我自己的 UIWebView 中显示一个 iTunes 应用程序网页。但以下代码总是启动 App Store 并离开我的应用程序：

```
NSURL *url = [NSURL urlWithString:@"https://itunes.apple.com/us/app/facebook/id284882215?mt=8"];
[self.webView loadRequest:[NSURLRequest requestWithURL:_URL]]; 
```

有没有办法在不启动 App Store 的情况下在我的应用程序中显示此网页？

# mysql - 从 MySQL 中选择并显示营业时间

> ID：13316879
> 
> 赞同：2
> 
> 时间：2012-11-09T22:21:55.723
> 
> 标签：mysql

我不需要检查业务是开放还是关闭，但我需要按天显示营业时间。

有一些选项：

1 - 一天营业一次（示例 - 从 10:00 到 18:30） - 表中的一行 2 - 一天营业两次（示例 - 从 10:00 到 14:00 和 15:00 到 18： 30) - 表 3 中的两行 - 业务可能已关闭（未插入行）

这是我的 MySql 小时存储表。在此示例中，企业**(affiliate_id)**在 0 到 4 天内开放两次，在第 5 天开放一次，在第 6 天关闭（这一天没有记录）

[http://postimage.org/image/yplj4rumj/](http://postimage.org/image/yplj4rumj/)

我需要在网站上显示的内容（根据此数据库示例：

0,1,2,3,4 - 打开 10:00-14:00 和 15:00-18:30 5 - 打开 10:00-12:00 6 - 关闭

我如何得到如下结果：

[http://postimage.org/image/toe53en63/](http://postimage.org/image/toe53en63/)

?

我尝试在 a.day=b.day 上使用 GROUPֹ_CONCAT 和 LEFT JOIN 查询同一张表，但没有运气:(

我的查询有样本（这是错误的）

```
SELECT GROUP_CONCAT( DISTINCT CAST( a.day AS CHAR ) 
ORDER BY a.day ) AS days, DATE_FORMAT( a.time_from,  '%H:%i' ) AS f_time_from, DATE_FORMAT( a.time_to,  '%H:%i' ) AS f_time_to, DATE_FORMAT( b.time_from, '%H:%i' ) AS f_time_from_s, DATE_FORMAT( b.time_to,  '%H:%i' ) AS f_time_to_s
FROM business_affiliate_hours AS a LEFT 
JOIN business_affiliate_hours AS b ON a.day = b.day
WHERE a.affiliate_id =57

GROUP BY a.time_from, a.time_to, b.time_from, b.time_to

 ORDER BY a.id ASC 
```

这是我的桌子：

```
CREATE TABLE IF NOT EXISTS `business_affiliate_hours` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `affiliate_id` int(10) unsigned NOT NULL DEFAULT '0',
  `time_from` time NOT NULL,
  `time_to` time NOT NULL,
  `day` tinyint(1) unsigned NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM;

INSERT INTO `business_affiliate_hours` (`id`, `affiliate_id`, `time_from`, `time_to`, `day`) VALUES
(53, 57, '10:00:00', '12:00:00', 5),
(52, 57, '15:00:00', '18:30:00', 4),
(51, 57, '10:00:00', '14:00:00', 4),
(50, 57, '15:00:00', '18:30:00', 3),
(49, 57, '10:00:00', '14:00:00', 3),
(48, 57, '15:00:00', '18:30:00', 2),
(47, 57, '10:00:00', '14:00:00', 2),
(46, 57, '15:00:00', '18:30:00', 1),
(45, 57, '10:00:00', '14:00:00', 1),
(44, 57, '15:00:00', '18:30:00', 0),
(43, 57, '10:00:00', '14:00:00', 0); 
```

每天的营业时间可能不同，所以我想按相同的营业时间分组，并获取所有独特的营业时间顺序的天数列表。

需要你的帮助！

对不起图片链接，我不能上传图片到这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:53:01.063

首先建立一个每天合并时间的具体化表，然后对其进行分组：

```
SELECT   GROUP_CONCAT(day ORDER BY day) AS days,
         DATE_FORMAT(f1, '%H:%i') AS f_time_from,
         DATE_FORMAT(t1, '%H:%i') AS f_time_to,
         DATE_FORMAT(f2, '%H:%i') AS f_time_from_s,
         DATE_FORMAT(t2, '%H:%i') AS f_time_to_s
FROM (
  SELECT   day,
           MIN(time_from) AS f1,
           MIN(time_to  ) AS t1,
           IF(COUNT(*) > 1, MAX(time_from), NULL) AS f2,
           IF(COUNT(*) > 1, MAX(time_to  ), NULL) AS t2
  FROM     business_affiliate_hours
  WHERE    affiliate_id = 57
  GROUP BY day
) t
GROUP BY f1, t1, f2, t2
ORDER BY days 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/3e65e/1/0)上查看。

# c# - 在下一页显示 ASP.NET MVC SelectList 的文本值

> ID：13316881
> 
> 赞同：0
> 
> 时间：2012-11-09T22:22:06.503
> 
> 标签：c#, asp.net-mvc

我正在开发一个允许人们注册活动的网站。在注册页面上，我有一个捕获数据的表单，在 MVC 控制器中进行验证，在视图之间保留它，然后应该显示一个预览页面。

下面是我正在尝试做的一个简化示例。

人视图模型

```
 public class Person{
        public int TitleId {get; set;}
        public SelectList Titles {get; set;}
    } 
```

注册控制器

```
 public class RegisterController:Controller
    {
        [HttpGet]
        public ActionResult Register(){
            return View(new Person());
        }

        [HttpPost]
        public ActionResult Register(Person person){
            if(ModelState.IsValid){
                TempData["Person"] = person
                RepopulateSelectLists(); //Gets the data for the select list again
                return RedirectToAction("Preview");
            }
            return View();
        }

        [HttpGet]
        public Actionresult Preview(){
            Person person = (Person)TempData["Person"];

        }
    } 
```

预览视图

```
 @Html.DisplayFor(m => m.TitleId);  //Will display int, not selected value 
```

假设我的 SelectList 具有所有值，并且我在上一页中选择了值的键/ID，我如何仅重新显示他们选择的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:28:22.147

它不是那样工作的。在您的 Preview() 页面中，您将获取给定的 ID 并找到其关联名称。在这种情况下，您可能希望构建一个自定义视图模型 (VM)，以将 ID 和名称保留在 VM 中。

此外，在预览页面上按 F5 的那一刻，一切都将消失。TempData 不会持续存在，任何刷新页面都会丢失数据。

相反，我建议在成功回发时，您只需根据初始发布数据返回不同的视图。例如：

```
 [HttpPost]
    public ActionResult Register(Person person){
        if(ModelState.IsValid){
            RepopulateSelectLists(); //Gets the data for the select list again
            var previewVM = new PreviewVM();
            // populate it with the model or whatever else you need for the preview
            return View("Preview", previewVM);
        }
        return View();
    } 
```

一个人的示例 VM

```
public class Person { public int TitleId { get; set; } }
public class PersonVM : Person { public string TitleName { get; set; } }
// ... then in your Register method
var previewVM = new PersonVM { TitleId = person.TitleId, TitleName = GetTitle(person.TitleId) }; 
```

假设 GetTitle 基于 TitleID 进行查找。这是非常粗略的代码，但我希望你能理解它的要点。然后你会使用`Html.DisplayFor(m => m.Title);` 如果你的预览有一个到下一页的帖子，你会想要`Html.HiddenFor(m => m.TitleId)`确保价值传递，但即使使用当前的方法，你也必须这样做。或者，您可以将标题存储在`ViewBag`（或`ViewData -- same thing) and simply not use`DisplayFor `to display the value and pass in the value from the`ViewBag`

请注意，我完全废弃了该`"Preview"`方法。这样，如果您此时按 F5，它只会使用您用于访问预览页面的相同数据*重新发布。*并且假设您没有保存（我看不到您在哪里），那么回发也没有什么坏处。有道理？

# java - 在字段中定位对象的最快算法

> ID：13316890
> 
> 赞同：0
> 
> 时间：2012-11-09T22:23:09.687
> 
> 标签：java, algorithm, lejos-nxj

就在场中定位对象的速度而言，最好的算法是什么？

该场地由 18 x 18 个正方形组成，边长为 30.48 厘米。机器人放置在正方形 (0,0) 中，它的工作是在避开沿途障碍物的同时到达光源。为了定位光源，机器人进行 360 度转动以找到具有最高光读数的角度，然后向光源行进。它可以可靠地检测 100 厘米以外的光源。

我目前实现这一点的方式是将有关每个图块的信息存储在 2x2 数组中。瓦片的可能值是未探索（默认）、阻塞（有障碍物）、空（那里什么都没有）。我正在考虑使用 DFS 算法，其中孩子位于 (i+3,j) 或 (i,j+3) 位置。但是，考虑到我将进行旋转以定位每个孩子的最高光读数的角度，我认为可能有一种算法可以比 DFS 更快地定位光源。此外，我只会在 x 和 y 方向上行驶，因为机器人将使用地板上的网格线来修正它的 x 和 y 位置。

如果可以建议一种快速可靠的算法来完成这项任务，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:55:30.640

这是一个非常广泛的问题，我不是专家，所以我的回答是基于“第一原则”的思维而不是该领域的经验。

（我假设您的机器人通常具有无障碍的视线和运动；即它是一个有分散障碍物的开放区域，而不是在迷宫中。）

问题在于解释您从 360 度扫描中获得的信息。

*   如果机器人看到光源，那么穿过通往光源的路线要么是微不足道的，要么是“简单”的迷宫行走任务。

*   困难在于你看不到源头。这可能意味着源不在可见范围内。但这也可能意味着光线在障碍物后面。不幸的是，像您描述的简单传感器无法区分这两种情况。

如果您的传感器系统允许您看到障碍物，您可以绘制“阴影”区域（障碍物后面的区域）的位置，并使用它来跟踪需要搜索的位置。因此，您的策略是访问少数几个位置并在每个位置进行扫描，然后有条不紊地“整理”少数处于阴影中的区域。

但是由于您无法轻易分辨出阴影区域的位置，因此您需要一种（最终）到处搜索的算法。DFS 是一种在任何地方搜索的通用策略，但它通过（实际上）首先查看角落和缝隙来做到这一点。更好的策略是广度优先搜索，如果大规模扫描没有找到光源，则只访问角落和缝隙。

* * *

> 如果可以建议一种快速可靠的算法来完成这项任务，我将不胜感激。

我认为您将需要自己开发一个。（这不是问题/任务/竞争的重点吗？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T00:25:02.463

虽然它可能看起来不像，但这看起来更像是一个迷宫跟踪问题。我想这是某种挑战或竞赛情况，从开始到目标总是有一条路径，但假设暂时没有。机器人导航完全被障碍物包围的信标的成功结果之一将是一份报告，其中描述了信号周围障碍物的封闭路径。如果没有这样封闭的路径，那么你可以在某个地方找到一个洞；这就是为什么看起来像迷宫一样。

所以我选择的基本算法是从一个螺旋向内的横向开始，扫出一条足够窄的路径，这样你肯定会看到一个信标，如果存在的话。如果没有障碍物（退化情况），这会在最短的时间内找到目标。（提示：每转一圈都会减少传感器每步可定位的单元数。）

以螺旋遍历为逆时针方向。您所拥有的与通过将右手放在墙上并遵循生成的路径来解决迷宫的规则有关。在这种情况下，您会遇到复杂情况，虽然迷宫的起点在边界上，但终点可能不在。在这种情况下，右手触摸路径可能会失败。检测这种情况需要在与墙壁相邻的区域中寻找“空洞”。

# c++ - 将节点指针设置为空

> ID：13316891
> 
> 赞同：0
> 
> 时间：2012-11-09T22:23:15.997
> 
> 标签：c++, linked-list, nodes

首先。感谢各位的帮助！

这是问题。尝试将列表的边缘之一设置为空

```
list[i].getAttachedNode(j) = 0; 
```

这是错误。

```
Prj3.cpp:165:34: error: lvalue required as left operand of assignment 
```

这是我的清单声明。

```
Node list[47]; 
```

这是 attachNode 实现。

```
Node* Node::getAttachedNode(int direction) {return attachedNode[direction];} 
```

[b]这是它包含的块。

```
for(int i = 0; i<48; i++)
      {
        for(int j = 0; j<6; j++)
        {  
        string info = g.returnInfo(i,j);

            switch(j)
                {
            case 0:
            list[i].setNodeName(info);
            break;
            case 1:
            if(info.compare(null) == 0)
            {list[i].getAttachedNode(j) = 0;}
            break;
                }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:26:52.730

错误很明显：

```
list[i].getAttachedNode(j) 
```

是一个 r 值，因此不能分配给它。只需`getAttachedNode`返回一个参考：

```
Node*& Node::getAttachedNode(int direction) {return attachedNode[direction];} 
```

# jquery - 如何对记录集进行分页

> ID：13316892
> 
> 赞同：0
> 
> 时间：2012-11-09T22:23:16.267
> 
> 标签：jquery, mysql, json

我正在从 MySQL 中提取一个记录集，编码为 json 并将其发送回另一个页面上的 DIV。我对这种数据格式有点陌生，所以我想知道如何使用分页系统？我是对 MySQL 结果进行分页还是使用 jquery 对 json 进行分页？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:32:23.907

我会在数据库层对数据进行分页。根据数据的大小，如果您选择其他方法，您最终可能会在客户端上获得相当多的数据，这会影响性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:31:18.573

大多数分页系统基于无序列表 ( `ul`)，其他分页系统基于`table`元素。[也许您会在这里](http://www.jquery4u.com/plugins/10-jquery-pagination-plugins/)获得一些有用的信息和插件。

# php - 在保存在 cURL CookieJar 文件中的重定向中设置请求 Cookie

> ID：13316897
> 
> 赞同：0
> 
> 时间：2012-11-09T22:23:45.150
> 
> 标签：php, redirect, cookies, curl, redirectwithcookies

我正在做一个项目，我正在使用 api 与单独站点上的电子商务商店进行交互。我可以通过 api 将项目添加到购物篮，并使用 cURLS CookieJar 来保存状态。要结帐，我只想链接到主要电子商务网站上的实际结帐流程。但是，我需要能够将存储在 CookieJar 中的 cookie 与重定向请求一起发送。

我尝试使用 cURL 来获取 cookie，然后进行重定向，但我误解了它的工作原理。它不是重定向浏览器，而是基于 302 重定向发出一个新的 cURL 请求。

```
$curlopt = array(
    CURLOPT_COOKIEJAR => xxx, // this is the path to the cookie file
    CURLOPT_COOKIEFILE => xxx, // this is the path to the cookie file
    CURLOPT_FOLLOWLOCATION => true,
    CURLOPT_AUTOREFERER => true,
    CURLOPT_URL => 'http://mydomain.com/redirect_to_ecommerce_checkout.php'
);

$ch = curl_init(); // run curl
curl_setopt_array($ch, $curlopt);
curl_exec($ch);
curl_close($ch); 
```

这似乎确实将正确的 cookie 发送到电子商务页面，问题是浏览器没有重定向，而是从我的域上的主要电子商务站点呈现 HTML。

如何设置请求 cookie 并实际执行重定向？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T21:44:15.637

我认为你只需要告诉 CURL 给你标题而不是遵循重定向。然后，您可以解析“位置：”标题。像这样的东西：

```
$curlopt = array(
    CURLOPT_COOKIEJAR => xxx, // this is the path to the cookie file
    CURLOPT_COOKIEFILE => xxx, // this is the path to the cookie file
    CURLOPT_FOLLOWLOCATION => false, // <--- change to false so curl does not follow redirect
    CURLOPT_AUTOREFERER => true,
    CURLOPT_URL => 'http://mydomain.com/redirect_to_ecommerce_checkout.php',
    CURLOPT_HEADER => true,
    CURLOPT_RETURNTRANSFER => true // Return transfer string instead of outputting directly
);

$ch = curl_init($url);
curl_setopt_array($ch, $curlopt);
$response = curl_exec($ch); // save response to a variable
curl_close($ch);

// try to find Location header in $response
preg_match_all('/^Location:(.*)$/mi', $response, $matches);

if (!empty($matches[1])) {
    header("Location: " . trim($matches[1][0]) );
    exit;
}
else {
    echo 'No redirect found';
} 
```

请注意，我设置了 CURLOPT_FOLLOWLOCATION => false、CURLOPT_HEADER => true 和 CURLOPT_RETURNTRANSFER => true，然后检查了我保存在 $response 中的 curl_exec() 响应。

你也可以试试：

```
header("Location: " . curl_getinfo($ch, CURLINFO_EFFECTIVE_URL); 
```

# entity-framework - Entity Framework外键码第一次迁移报错

> ID：13316899
> 
> 赞同：3
> 
> 时间：2012-11-09T22:23:48.717
> 
> 标签：entity-framework

我有一个实体框架类，其中有两个引用回另一个对象

```
public class Review
{
    [Key]
    public int Id
    {get;set;}

    public int? FeatureId {get;set;}

    public Feature Feature {get;set;}
}

public class Feature
{
    [Key]
    public int Id
    {get;set;}

    public ICollection<Review> Reviews {get;set;}

} 
```

当我使用生成迁移时，这工作正常`Add-Migration`

现在，我添加了第二个条目

```
public class Review
{
    [Key]
    public int Id
    {get;set;}

    public int? FeatureId {get;set;}

    public Feature Feature {get;set;}

    public int? CompareToFeatureId {get;set;}

    public Feature CompareToFeature {get;set;}
} 
```

当我运行迁移时，它会做一些奇怪的事情，比如重命名原始列。

```
 RenameColumn(table: "dbo.Reviews", name: "FeatureId", newName: "Feature_Id");
   AddColumn("dbo.Reviews", "CompareToFeatureId", c => c.Int());
   AddForeignKey("dbo.Reviews", "FeatureId", "dbo.Features", "Id");
   AddForeignKey("dbo.Reviews", "CompareToFeatureId", "dbo.Features", "Id");
   CreateIndex("dbo.Reviews", "FeatureId");
   CreateIndex("dbo.Reviews", "CompareToFeatureId"); 
```

那很好，但是当我运行时迁移失败`update-database`

```
Applying code-based migrations: [201211092218271_Test2].
Applying code-based migration: 201211092218271_Test2.
System.Data.SqlClient.SqlException (0x80131904): Foreign key 'FK_dbo.Reviews_dbo.Features_FeatureId' references invalid column 'FeatureId' in referencing table 'Reviews'.
Could not create constraint. See previous errors.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Entity.Migrations.DbMigrator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteOperations(String migrationId, XDocument targetModel, IEnumerable`1 operations, Boolean downgrading, Boolean auto)
   at System.Data.Entity.Migrations.DbMigrator.ApplyMigration(DbMigration migration, DbMigration lastMigration)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ApplyMigration(DbMigration migration, DbMigration lastMigration)
   at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration)
   at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.RunCore()
   at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run()
ClientConnectionId:f1573dba-4658-462f-969a-9afbf1e4374a
Foreign key 'FK_dbo.Reviews_dbo.Features_FeatureId' references invalid column 'FeatureId' in referencing table 'Reviews'.
Could not create constraint. See previous errors. 
```

不知道在这里做什么。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T22:30:33.643

由于您没有遵循约定（Feature_ID），因此您需要提供一些帮助：在 FeatureId 属性上放置一个属性 [ForeignKey("Feature")]

```
[ForeignKey("Feature")]
public int? FeatureId { get; set; }

public Feature Feature { get; set; } 
```

# php - 如何从网络调用执行 php 命令行脚本

> ID：13316900
> 
> 赞同：0
> 
> 时间：2012-11-09T22:23:49.483
> 
> 标签：php

> **可能重复：**
> [php exec() 函数和不同的主机](https://stackoverflow.com/questions/10431938/php-exec-function-and-different-hosts)

我有一个网络应用程序，当单击保存按钮时，它会对 save.php 进行 ajax 调用。我希望能够对仅命令行的 php 脚本进行命令行调用，以便从 save.php 文件内部运行。

前任。

```
some code to make a db call and update db

exec('PathToPHP /path/to/file/refresh.php'); 
```

我已经尝试过了，但它不起作用。

有没有人有好的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:30:52.170

如果这个过程需要很长时间并且客户端没有等待它完成并在运行时导航离开，那么 apache 将终止处理这个的线程。我敢肯定。还没有在 nginx 下的 fastcgi 模式下测试过这个，但我很确定这也会是这种情况。

# javascript - Window.Location 刷新而不是重定向

> ID：13316901
> 
> 赞同：1
> 
> 时间：2012-11-09T22:23:53.620
> 
> 标签：javascript, jquery, asp.net

我有一个 JQUERY 函数如下

```
this.getURL = function()
{
    var name = getName();
    alert("Menu.aspx?name"+name);
    //window.location = "Menu.aspx?name"+name;
} 
```

当我提醒我尝试访问的 URL 时，它是正确的。但是，当我在该字符串上调用 window.location 时，页面只是刷新而不去任何地方。

我在使用 window.location 的地方有类似的代码，它可以工作。我在浏览器中输入了网址，它也可以正常工作。

在最坏的情况下（即使 URL 错误），我希望它只会将我重定向到某个 URL。但是，除了刷新当前页面之外，我无法让它做任何事情。

还要澄清一下，调用此函数的页面不是 Menu.aspx

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:33:40.767

根据我的经验，很难让这样的重定向正常工作。我不得不使用`window.location.replace(<url>)`. 如果你只是改变一个锚标签，那就更难了。您必须执行以下操作才能使其在所有浏览器中工作：

```
window.location.replace(<url>);
window.location=<url>;
window.open(<url>,'_self');
window.location.reload(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:47:41.800

如果您使用的是相对路径，请尝试设置`window.location.pathname`，否则设置`window.location.href`为完整路径。

您可能还想尝试`self.location.href`

# jquery - 为什么Opera字体加粗

> ID：13316904
> 
> 赞同：-3
> 
> 时间：2012-11-09T22:24:07.920
> 
> 标签：jquery, css, browser

[链接](http://impactweb.pl/operafont/)- 我不明白。我不包含任何其他字体，我已经重置了 css，我已经禁用了粗体标题，每个浏览器都将其显示为漂亮的细字母，但 Opera 只是将其显示为粗体。

![在此处输入图像描述](../Images/1511d11111ecf0ae4d1f832e6c7f4f0f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T22:27:02.213

It may be that opera bolds `h1` elements by default. (Although you said you tried un-bolding it)

Try this first:

```
h1 {
    font-weight: normal;
} 
```

if that doesn't work, then maybe opera has a different definition of normal. In which case you should do something like this:

```
h1 {
    font-weight: lighter;
} 
```

or if you wan't even a little more control you could do something like:

```
h1 {
    font-weight: 100;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:29:18.853

既不是`font-weight: light`也不`font-style: light`是有效的 CSS。首先验证您的 HTML 和 CSS。

# jboss - 从 JBoss 迁移 Tomee / OpenEJB

> ID：13316905
> 
> 赞同：0
> 
> 时间：2012-11-09T22:24:17.477
> 
> 标签：jboss, openejb

我是 TomEE+ 的新手。我只是尝试从 JBoss 部署我现有的 EJB（大约 100 个 jar 的大型应用程序），只是在 webapps 中复制。它似乎可以工作，但是当我启动我的客户端时，它会尝试调用我的 ejb 并由于端口错误而失败：

客户端配置：java.naming.factory.initial=org.jnp.interfaces.NamingContextFactory java.naming.factory.url.pkgs=org.jboss.naming:org.jnp.interfaces java.naming.provider.url=localhost:1099

如何更改 openejb 端口监听？将 JBoss 切换到 TomEE 有很多变化吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:25:50.133

您如何从客户端调用 EJB？TommEE 不是经过完整配置文件认证的 Java EE6 服务器，因此如果您使用的是 Web 配置文件中没有的东西，那么它可能还没有实现。

# c++ - c++大数据成员只用于测试

> ID：13316919
> 
> 赞同：0
> 
> 时间：2012-11-09T22:25:41.030
> 
> 标签：c++, templates

我有一个类的大数据成员，仅用于测试：

```
template <bool testing>
class foo {
  int testbuf[1000];
} 
```

我怎样才能做到这一点？仅当`testing`是`true`，包括`testbuf[]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:27:48.577

Specialize:

```
template <bool> class foo { };

template <> class foo<true>
{
    // everything needed for testing
}; 
```

* * *

**Update:** To clarify some points raised in the comments: You would write one such "testing" template per individual *item* that you want to specialize, so that there's no code duplication. Imagine your real class template is actually `bar`:

```
template <bool Testing>
class bar
: private foo<Testing>          // specializable base
{
    // common stuff

    Widget<Testing> widget;     // specializable member

    Gadget          gadget;     // unconditional member
}; 
```

You can also use composition rather than inheritance; whichever fits best. If you go with inheritance, make sure to spell out `this->testbuf`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T22:28:29.307

you can use ifdef stuff

```
#define DEBUG_MODE

class Foo{
  #ifdef DEBUG_MODE
      int testbuf[1000];
  #else
      int testbuf[10];
  #endif
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T22:28:15.097

```
template <bool testing>
class foo {
} 
```

and

```
template <>
class foo <true>{
  int testbuf[1000];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T22:40:27.763

我会假设这`testing`不仅仅是用来保持那个buff。

```
template <bool testing>
struct foobuf
{};
template <>
struct foobuf<true>
{
  enum {testbuf_size = 1000};
  int testbuf[testbuf_size];
  foobuf() { std::fill_n( &testbuff[0], testbuf_size, int() ); }
};

template <bool testing>
class foo : public foobuf<testing> {
  // ...
}; 
```

更进一步，您可以在 foobuf 中包含一个 dotest 函数，其工作原理如下：

```
template<bool>
struct foobuf
{
  template<typename Func>
  void doTest( Func const& unused );
};
template<>
struct foobuf<true>
{
  enum {testbuf_size = 1000};
  int testbuf[testbuf_size];
  foobuf() { std::fill_n( &testbuf[0], testbuf_size, int() ); }
  template<typename Func>
  void doTest( Func const& f )
  {
    f( testbuf, testbuf_size );
  }
}; 
```

你会在 foo 中这样使用它：

```
void foo::some_function(...)
{
  // some code
  doTest( [&]( int* buf, size_t length )
  {
    // the code in here only runs if we test was true in foo
    // and if so, it has access to the test buff via the buf* parameter
    // oh, and it will be almost certainly inlined if test was true in foo
    // and thrown away and never created if it was false.
  });
} 
```

但是，这只是我。

# javascript - Visual Studio 2012：将更多 TypeScript 文件编译为一个 JavaScript 文件

> ID：13316922
> 
> 赞同：4
> 
> 时间：2012-11-09T22:25:59.890
> 
> 标签：javascript, visual-studio, typescript

是否可以设置“编译器”选项以将一个项目中的更多 TypeScript 文件编译为一个 JavaScript 文件？我能找到的唯一解决方案是手动将多个文件传递给“tsc”，但我想使用 IDE Visual Studio 2012 的功能。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-09T22:36:42.020

我在 ASP.NET 中使用捆绑来执行此操作。您可以将捆绑与 MVC 或 Web 表单一起使用。

如果您使用的是 Web Essentials，您将已经获得 a`.js`和 a`.min.js`并且捆绑非常聪明，可以`.js`在调试时使用文件并在生产中使用缩小版本 - 因此您可以轻松调试但在实时获得较小的文件。

您可以在 ASP.NET 站点上阅读有关[捆绑和缩小的](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)所有信息。

但是，如果您希望 TypeScript 捆绑文件（它不会缩小文件），您只需要使用以下标志：

```
tsc --out combined.js app.ts 
```

TypeScript 将遍历依赖项并为您整理排序，因此您需要担心的只是缩小组合文件。

# javascript - 数字货币格式问题

> ID：13316923
> 
> 赞同：0
> 
> 时间：2012-11-09T22:26:03.360
> 
> 标签：javascript

> **可能重复：**
> [如何在 JavaScript 中将数字格式化为货币？](https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript)

这是我正在使用的当前代码：

```
f[0].update(parseFloat($('tier').getValue().replace('$','').replace(',',''))*parseFloat(text.replace('$','').replace(',',''))); 
```

我遇到的问题是价格显示没有`$`正确的货币。例如，应显示为的内容`$29.50`显示为`29.5`或应显示为的内容`$5.00`显示为`5`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:29:52.767

看看[accounting.js](http://josscrowcroft.github.com/accounting.js/)`toFixed()`中的方法。这将解决您的舍入错误并正确格式化资金

```
 toFixed() - better rounding for floating point numbers

        /**
* Implementation of toFixed() that treats floats more like decimals
*
* Fixes binary rounding issues (eg. (0.615).toFixed(2) === "0.61") that present
* problems for accounting- and finance-related software.
*/
var toFixed = lib.toFixed = function(value, precision) {
precision = checkPrecision(precision, lib.settings.number.precision);
var power = Math.pow(10, precision);

// Multiply up by precision, round accurately, then divide and use native toFixed():
return (Math.round(lib.unformat(value) * power) / power).toFixed(precision);
}; 
```

链接：http: [//josscrowcroft.github.com/accounting.js/#methods](http://josscrowcroft.github.com/accounting.js/#methods)

# javascript - 传单（geojson）多边形上的简单标签

> ID：13316925
> 
> 赞同：33
> 
> 时间：2012-11-09T22:26:19.147
> 
> 标签：javascript, mapping, openlayers, leaflet

我正在尝试使用传单多面体对象进行我想象的相当常见的用例。

我使用geojson创建了MultiPolygon：

```
var layer = L.GeoJSON(g, style_opts); 
```

我想要在每个多边形的中心放置一个简单的文本标签。（例如，将州名放在每个州的中心）。

我看过： [https ://groups.google.com/forum/?fromgroups=#!topic/leaflet-js/sA2HnU5W9Fw](https://groups.google.com/forum/?fromgroups=#!topic/leaflet-js/sA2HnU5W9Fw)

它实际上覆盖了文本，但是当我添加一堆多边形时，它似乎以奇怪的方式使标签偏离中心，我目前无法找到问题所在。

我也看过：[https ://github.com/jacobtoye/Leaflet.label](https://github.com/jacobtoye/Leaflet.label)

但这似乎只会在您将鼠标悬停在多边形上时将标签放在多边形上，并且不会静态停留在多边形上。

我认为我最好的做法是使用第一个链接，并找出它改变位置的原因，但与此同时，如果有人知道在传单中的多边形上放置标签的快速简便的方法，我会非常感激。

另外，如果我对上述两个链接有任何错误的假设，请随时纠正我。

首先十分感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-13T22:09:32.283

传单标签插件还允许使用静态标签，请参阅[演示](http://leaflet.github.io/Leaflet.label/)。折线标签不是静态的唯一原因是当您沿着折线移动时它会四处移动。

您可能会做得比这更好，通过覆盖多边形的 bindLabel() 但这是一种将静态标签添加到多边形中心的简单方法：

```
label = new L.Label()
label.setContent("static label")
label.setLatLng(polygon.getBounds().getCenter())
map.showLabel(label); 
```

[http://jsfiddle.net/CrqkR/6/](http://jsfiddle.net/CrqkR/6/)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-09-15T11:14:41.337

您可以使用`onEachFeature`选项为每个多边形`L.geoJson`创建一个新的。`L.divIcon`

```
L.geoJson(geoJsonData, {
  onEachFeature: function(feature, layer) {
    var label = L.marker(layer.getBounds().getCenter(), {
      icon: L.divIcon({
        className: 'label',
        html: feature.properties.NAME,
        iconSize: [100, 40]
      })
    }).addTo(map);
  }
); 
```

# sql - Optimizing sql query with subselect list in clause

> ID：13316931
> 
> 赞同：2
> 
> 时间：2012-11-09T22:26:58.933
> 
> 标签：sql, oracle

I'm using oracle 11g and trying to optimize a query.

The basic structure of the query is:

```
SELECT val1, val2, val3,
FROM 
table_name
WHERE
val1 in (subselect statement is here, it selects a list of possible values for 
    val1 from another table) 
and val5>=X and val5<=Y
group by val1
order by val2 desc; 
```

My issue is that when I use a subselect, the cost is 3130. If I fill in the results of the subselect by hand - so, for example

```
field1 in (1, 2, 3, 4, 5, 6) 
```

Where (1, 2, 3, 4, 5, 6) is the results of the subselect, which in this case is all possible values of field 1, the cost of the query is 14, and oracle uses an "inlist iterator" for the group by part of the query. The results of the two queries are identical.

My question is how to mimic the behaviour of manually listing the possible values of field1 with a subselect statement. The reason I don't list those values in the query is that the possible values change based on one of the other fields, so the subselect is pulling the possible values of field1 from a 2nd table based on, say, field2\.

I have an index of val1, val5, so it isn't doing any full table scans - it does do a range scan in both cases, but in the subselect case the range scan is much more expensive. However it isn't the most expensive part of the subselect query. The most expensive part is the group by, which is a HASH.

Edit - Yes, the query isn't syntactically correct - I didn't want to put up anything too specific. The actual query is fine - the selects use valid group by functions.

The subselect returns 6 values, but it can be anywhere from 1-50 or so based on the other value.

Edit2 - What I ended up doing was 2 separate queries so I could generate the list used in the subselect. I actually tried a similar test in sqlite, and it does the same thing, so this isn't just Oracle.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T23:30:49.983

您所看到的是 IN () bieng 受绑定变量窥视的结果。当您有直方图时，您编写一个查询，例如“where a = 'a'”，oracle 将使用直方图来猜测将返回多少行（与 inlist 运算符相同的想法，它对每个项目进行迭代并聚合行）。如果没有直方图，它将以行/不同值的形式进行猜测。在子查询中，oracle 不会这样做（在大多数情况下......它有一个独特的情况）。

例如：

```
SQL> create table test
  2  (val1 number, val2 varchar2(20), val3 number);

Table created.

Elapsed: 00:00:00.02
SQL>
SQL> insert into test select 1, 'aaaaaaaaaa', mod(rownum, 5) from dual connect by level <= 100;

100 rows created.

Elapsed: 00:00:00.01
SQL> insert into test select 2, 'aaaaaaaaaa', mod(rownum, 5) from dual connect by level <= 1000;

1000 rows created.

Elapsed: 00:00:00.02
SQL> insert into test select 3, 'aaaaaaaaaa', mod(rownum, 5) from dual connect by level <= 100;

100 rows created.

Elapsed: 00:00:00.00
SQL> insert into test select 4, 'aaaaaaaaaa', mod(rownum, 5) from dual connect by level <= 100000;

100000 rows created. 
```

所以我有一张有 101200 行的表。对于 VAL1 ，100 是“1”，1000 是“2”，100 是“3”，100k 是“4”。

现在如果收集直方图（在这种情况下我们确实想要它们）

```
SQL> exec dbms_stats.gather_table_stats(user , 'test', degree=>4, method_opt=>'for all indexed columns size 4', estimate_percent=>100);

SQL> exec dbms_stats.gather_table_stats(user , 'lookup', degree=>4, method_opt =>'for all indexed columns size 3', estimate_percent=>100); 
```

我们看到以下内容：

```
SQL> explain plan for select * from test where val1 in (1, 2, 3) ;

Explained.

SQL> @explain ""

Plan hash value: 3165434153

--------------------------------------------------------------------------------------
| Id  | Operation                    | Name  | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |       |  1200 | 19200 |    23   (0)| 00:00:01 |
|   1 |  INLIST ITERATOR             |       |       |       |            |          |
|   2 |   TABLE ACCESS BY INDEX ROWID| TEST  |  1200 | 19200 |    23   (0)| 00:00:01 |
|*  3 |    INDEX RANGE SCAN          | TEST1 |  1200 |       |     4   (0)| 00:00:01 |
-------------------------------------------------------------------------------------- 
```

对比

```
SQL> explain plan for select * from test where val1 in (select id from lookup where str = 'A') ;

Explained.

SQL> @explain ""

Plan hash value: 441162525

----------------------------------------------------------------------------------------
| Id  | Operation                    | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |         | 25300 |   518K|   106   (3)| 00:00:02 |
|   1 |  NESTED LOOPS                |         | 25300 |   518K|   106   (3)| 00:00:02 |
|   2 |   TABLE ACCESS BY INDEX ROWID| LOOKUP  |     1 |     5 |     1   (0)| 00:00:01 |
|*  3 |    INDEX UNIQUE SCAN         | LOOKUP1 |     1 |       |     0   (0)| 00:00:01 |
|*  4 |   TABLE ACCESS FULL          | TEST    | 25300 |   395K|   105   (3)| 00:00:02 |
---------------------------------------------------------------------------------------- 
```

查找表在哪里

```
SQL> select * From lookup;

        ID STR
---------- ----------
         1 A
         2 B
         3 C
         4 D 
```

（str 是唯一索引并具有直方图）。

注意 inlist 的基数为 1200 和一个好的计划，但在子查询中却非常不准确？Oracle 没有计算连接条件的直方图，而是说“看，我不知道 id 会是什么，所以我猜总行数（100k+1000+100+100）/不同值（4）=25300 并使用那。因此，它选择了全表扫描。

这一切都很好，但如何解决呢？如果您知道此子查询将匹配少量行（我们会）。那么你必须提示外部查询以尝试让它使用索引。喜欢：

```
SQL> explain plan for select /*+ index(t) */ * from test t where val1 in (select id from lookup where str = 'A') ;

Explained.

SQL> @explain

Plan hash value: 702117913

----------------------------------------------------------------------------------------
| Id  | Operation                    | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |         | 25300 |   518K|   456   (1)| 00:00:06 |
|   1 |  NESTED LOOPS                |         | 25300 |   518K|   456   (1)| 00:00:06 |
|   2 |   TABLE ACCESS BY INDEX ROWID| LOOKUP  |     1 |     5 |     1   (0)| 00:00:01 |
|*  3 |    INDEX UNIQUE SCAN         | LOOKUP1 |     1 |       |     0   (0)| 00:00:01 |
|   4 |   TABLE ACCESS BY INDEX ROWID| TEST    | 25300 |   395K|   455   (1)| 00:00:06 |
|*  5 |    INDEX RANGE SCAN          | TEST1   | 25300 |       |    61   (2)| 00:00:01 |
---------------------------------------------------------------------------------------- 
```

另一件事是在我的特殊情况下。由于 val1=4 是表的大部分，假设我有我的标准查询： `select * from test t where val1 in (select id from lookup where str = :B1);`

对于可能的`:B1`输入。如果我知道传入的有效值是 A、B 和 C（即不是映射到 id=4 的 D）。我可以添加这个技巧：

```
SQL> explain plan for select  * from test t where val1 in (select id from lookup where str = :b1 and id in (1, 2, 3)) ;

Explained.

SQL> @explain ""

Plan hash value: 771376936

--------------------------------------------------------------------------------------------------
| Id  | Operation                     | Name             | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT              |                  |   250 |  5250 |    24   (5)| 00:00:01 |
|*  1 |  HASH JOIN                    |                  |   250 |  5250 |    24   (5)| 00:00:01 |
|*  2 |   VIEW                        | index$_join$_002 |     1 |     5 |     1 (100)| 00:00:01 |
|*  3 |    HASH JOIN                  |                  |       |       |            |          |
|*  4 |     INDEX RANGE SCAN          | LOOKUP1          |     1 |     5 |     0   (0)| 00:00:01 |
|   5 |     INLIST ITERATOR           |                  |       |       |            |          |
|*  6 |      INDEX UNIQUE SCAN        | SYS_C002917051   |     1 |     5 |     0   (0)| 00:00:01 |
|   7 |   INLIST ITERATOR             |                  |       |       |            |          |
|   8 |    TABLE ACCESS BY INDEX ROWID| TEST             |  1200 | 19200 |    23   (0)| 00:00:01 |
|*  9 |     INDEX RANGE SCAN          | TEST1            |  1200 |       |     4   (0)| 00:00:01 |
-------------------------------------------------------------------------------------------------- 
```

现在注意 oracle 有一张合理的卡片（它把 1,2,3 推到 TEST 表上并得到 1200..不是 100% 准确，因为我只过滤了它们中的任何一个，但我告诉 orce 肯定不是 4！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T23:05:53.640

我做了一些研究，我认为这里解释了一切：[oracle docs](http://docs.oracle.com/cd/B10500_01/server.920/a96533/opt_ops.htm)。
只需查看“CBO 如何评估 IN-List 迭代器”并将其与“CBO 如何评估 IN 运算符”进行比较。

您使用“field1 in (1, 2, 3, 4, 5, 6)”的查询与第一种情况匹配，但使用 subselect 的查询由 Oracle 重写。

因此，每个带有 subselect 或 join 的查询都将具有与您相似的成本，除非您找到非常棘手的方法将子查询的返回作为参数。

您始终可以尝试为排序设置更多内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T22:34:18.160

您可以通过在子选择上添加索引来修复该语句。但是，您必须发布查询和执行计划才能理解这一点。顺便问一下，子选择本身需要多长时间？

您可以尝试以下两个版本之一：

```
select val1, val2, val3
from table_name join
     (select distinct val from (subselect here)) t
     on table_name.val1 = t.val
where val5>=X and val5<=Y
group by val1, val2, val3
order by val2 desc; 
```

或者：

```
select val1, val2, val3
from table_name
where val5>=X and val5<=Y and
      exists (select 1 from (subselect here) t where t.val = table_name.val1)
group by val1, val2, val3
order by val2 desc; 
```

这些在语义上是等效的，其中之一可能会更好地优化。

另一种可能可行的方法是在分组*后*进行过滤。就像是：

```
select t.*
from (select val1, val2, val3
      from table_name
      where val5>=X and val5<=Y and
      group by val1, val2, val3
     ) t
where val1 in (subselect here)
order by val2 desc; 
```

# networking - Clojure (aleph) detecting when server disconnects

> ID：13316935
> 
> 赞同：6
> 
> 时间：2012-11-09T22:27:08.517
> 
> 标签：networking, tcp, clojure

I have the following code:

```
(ns alephtest.core             
    (:use lamina.core aleph.tcp aleph.formats))

(defn connection-established [socket] 
    (println "Socket connection established")
    (on-closed socket #(println "closed"))
    (doseq [line (line-seq (java.io.BufferedReader. *in*))]
        (enqueue socket line)))

(defn -main [] 
    (on-realized (tcp-client {:host "localhost" :port 9000}) 
        connection-established 
        #(println "error:" %))) 
```

All it does right now is connects to a local server and then passes data from stdin through to the server. This works fine, except for the `(on-closed socket #(println "closed"))` portion. If I kill the server while the client is still going I should get a message saying "closed" to the console, but I never do.

My end-goal here is to create some kind of recovery code, so that if the server goes down the client will queue up messages while it waits for the server to come back, and when the server does come back it'll reconnect and send everything that was queued.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-11T02:06:07.877

看起来您正在阻塞会通知您套接字关闭的线程`(doseq ...)`。把它包起来`(future ...)`，看看是否不能解决它。

# javascript - Jittery animation using animationFrame

> ID：13316944
> 
> 赞同：1
> 
> 时间：2012-11-09T22:27:34.197
> 
> 标签：javascript, requestanimationframe

I whipped up a simple little spinner widget based on the Windows 8 loading animation, and I haven't been able to figure out why each dot appears to jitter slightly. I've tried various things to normalize the values and haven't found anything that has smoothed it out.

[http://jsbin.com/ilafov/16](http://jsbin.com/ilafov/16)

What am I doing wrong?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T22:33:49.577

我有一种预感，并确定了屏幕截图。您的动画似乎没有做任何亚像素动画。

为了让动画真正流畅，逐个像素地移动，你不只是从一个跳到另一个，你想象它按平均移动。像素慢慢地移出一个空间并进入下一个空间。您可以通过像素在另一个淡入时逐渐淡出来模拟这一点。

当我对您的动画进行屏幕截图时，我看到所有点都没有亚像素动画的迹象。

如果您查看我的业务页面：[http](http://matthewrconsultancy.co.uk/start) : //matthewrconsultancy.co.uk/start，如果您使用 Chrome 之类的东西，您会看到齿轮在移动。它使用 SVG 和 SMIL 动画，但是如果您放大它，您会发现动画是在亚像素级别上发生的。恐怕我还没有时间弄清楚如何为您解决它，但我可以直接回答您的主要问题，即出了什么问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:28:04.643

一些选项：

1）尝试使用画布为圆圈设置动画。在初始化期间，您可以在屏幕外画布上绘制一个圆圈并将其 imageData（使用 getImageData）保存到一个易于访问的变量中。在动画的每一帧中，将 putImageData 用于您在主动画画布上各自坐标中的尽可能多的圆圈。请记住在每个新帧中清除它。

2) 将您的圆圈保存为与分辨率无关的图像（SVG、CSS 样式或带有 API 的画布，该 API 根据用户的屏幕 DPI 和浏览器自己的像素显示来更新其上下文）。然后，您可以尝试使用 transform: translate3d(x, y, z) 移动圆。这可能会提供更平滑的结果，尽管我听说此转换启用的硬件加速确实会阻止浏览器在某些元素上使用亚像素抗锯齿。还要记住，转换属性使用供应商前缀。

希望这可以帮助！

# scheme - Defining a Scheme function

> ID：13316948
> 
> 赞同：4
> 
> 时间：2012-11-09T22:27:49.390
> 
> 标签：scheme

So i have been stuck trying to learn this Scheme language that i heard about from a friend of mines. What he said i should do is start small and work my way up to truly understanding it. So after reading a textbook that he had that discusses Scheme programming briefly, i am a little puzzled myself on how it works.

So pretty much what i am trying to ask is that if i wanted to add a definition to a function called, let's say 'evens' from a couple of list i have define:

```
(DEFINE list0 (LIST 'j 'k 'l 'm 'n 'o 'j) )
(DEFINE list1 (LIST 'a 'b 'c 'd 'e 'f 'g) )
(DEFINE list2 (LIST 's 't 'u 'v 'w 'x 'y 'z) )
(DEFINE list3 (LIST 'j 'k 'l 'm 'l 'k 'j) )
(DEFINE list4 (LIST 'n 'o 'p 'q 'q 'p 'o 'n) )
(DEFINE list5 '((a b) c (d e d) c (a b) )
(DEFINE list6 '((h i) (j k) l (m n)) )
(DEFINE list7 (f (a b) c (d e d) (b a) f) ) 
```

such that it does like the task below: evens

which I have already created a adder function which i believe is to be:

```
(DEFINE (adder lis)
    (COND
        ((NULL? lis) 0)
        (ELSE (+ (CAR lis) (adder (CDR lis))))
)) 
```

**what might the definition for even be if i would want it to do like the task below:**

EVENS: (evens 1st) should return a new list, formed from the the even numbered elements taken 1st.

```
(evens '(a b c d e f g))
which would/should return:
(b d f) 
```

and:

```
(evens (LIST 's 't 'u 'v 'w 'x 'y 'z))
which would/should return:
(t v x z) 
```

and:

```
(evens '(f (a b) c (d e d) (b a) f) )
which would return:
((a b) (d e d) f) 
```

and both (evens '()) and (evens '(a))

would return the empty list.

I have been going through trail in error to practice but i am totally lost. Thanks in advance

Okay, I think that i have come up with a recursive function to my example that i have been trying to work out:

```
 (define mylist '(1 2 3 4 5 6 7))
 (define (evens lst)
 (define (do-evens lst odd)
     (if (null? lst)
 lst
     (if odd
         (do-evens (cdr lst) #f)
         (cons (car lst) (do-evens (cdr lst) #t)))))
         (do-evens lst #t)) 
```

any thoughts?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:34:03.797

首先，`adder`功能与您的问题无关，对吗？

想想`evens`功能。您已经说过，`(evens '())`应该`(evens '(a))`返回空列表。应该`(evens '(a b))`返回什么？怎么样`(evens '(a b ...))`？你知道如何设置递归吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-11T06:45:29.337

好的，所以要做一个遍历列表的递归函数，选择一些元素返回而不是其他元素，基本模式将是

```
(define (recur l)
  (cond
    ((null l) '())
    ((??????) (cons (car l) (recur (cdr l))))
    (else (recur (cdr l))))) 
```

那是什么

1.  列表是否为空？返回空值。
2.  如果列表不为空，我们是否应该保留列表中的第一项？好的，让我们保留它并将其添加到任何`(recur (cdr l))`返回
3.  否则，只返回任何`recur (cdr l)`返回。

我希望这清楚的是，一个简单的递归列表函数只查看列表的第一个元素，确定如何处理它，然后用列表的其余部分再次调用自己。从某种意义上说，递归是一种简化计算的方法，它只处理数据的第一部分，让另一个函数来处理其余数据（*另一个*函数实际上与您第一次调用的函数相同，但是尽量不要担心）。例如，仅返回偶数项的递归函数可能如下所示：

```
(define (even-numbers l)
  (cond
    ((null? l) '())
    ((even? (car l)) (cons (car l) (even-numbers (cdr l))))
    (else (even-numbers (cdr l))))) 
```

也就是说，您的情况稍微复杂一些；您需要删除第一个元素，然后在每次连续调用该函数时，执行与上次调用相反的操作。

一种方法是传递一个布尔状态，每次都翻转它。请注意，由于**events**函数不获取状态，因此您必须定义一个不同的内部函数并在其上重复：

```
(define (evens l)
  (let loop ((lst l) (keep #f))
      (cond
         ((null? lst) '())
         ((eq? keep #t) (???????)
         (else (loop (cdr l) #t))))) 
```

`(???????)`鉴于前面的示例，您应该能够弄清楚自己需要做什么。我想，我为你做了太多的工作。

另一种方法是使用相互递归的函数*evens*和*odds*。考虑到

1.  **evens**是一个函数，它丢弃第一个元素，然后遍历列表，每次都执行与上次相反的操作（保留或丢弃）。
2.  **几率**是一个函数，它保留第一个元素，然后遍历列表，每次都与上次相反（保留或丢弃）。

这意味着您可以定义

1.  **evens**作为一个忽略第一个元素并简单地调用列表其余部分的**奇数的函数。**
2.  **赔率**作为保留第一个元素的函数，在列表的其余部分调用**evens并将第一个元素****cons** -es 到结果的开头。

那看起来像

```
(define (evens l)
  (cond
    ((null? l) '())
    (else (odds (??????)))))

(define (odds l)
  (cond
    ((null? l) '())
    (else (cons (car l) (evens (??????)))))) 
```

希望这是有道理的。

如果您真的想了解 Scheme 中的递归，请购买一本《The Little Schemer》并开始学习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-17T12:43:57.657

那这个呢：

```
(define (evens l)
  (cond
   ((null? l) '())
   ((null? (cdr l)) '())
   (else (cons (cadr l) (evens (cddr l)))))) 
```

但我喜欢偶数和赔率的答案！

# c# - Json.NET preserving native types

> ID：13316962
> 
> 赞同：2
> 
> 时间：2012-11-09T22:28:40.357
> 
> 标签：c#, .net, json, json.net

I'm using Json.NET ([http://james.newtonking.com/projects/json/help/](http://james.newtonking.com/projects/json/help/)) as a way to serialize and deserialize JSON from a server. Let's say I have the following JSON object:

```
{
    "user" : {
         "name" : "Bob",
         "age" : 35
    },
    "location" : "California"
} 
```

The only way that I can find to deserialize this in to native types is to use a custom DTO as follows:

```
string jsonString = ""; // json string from above
Response result = JsonConvert.DeserializeObject<Response> (jsonString); 
```

where the Response class looks something like:

```
public class Response
{
    [JsonProperty("user")]
    public UserResponse User { get; set; }

    [JsonProperty("location")]
    public string Location { get; set; }
}

public class UserResponse
{
    [JsonProperty("name")]
    public string Name { get; set; }

    [JsonProperty("age")]
    public int Age { get; set; }
} 
```

I want to deserialize this in to native types but I'm in an environment where I don't always know what the JSON string will look like... so it's hard to use custom DTO's when I don't know exactly what I'm getting down the pipe. If I don't pass any class in to JsonConvert.DeserializeObject(), then I end up with Json.NET types instead of native types like strings, ints, etc. Any suggestions on how to get around this? Should I be using a different JSON library instead?

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:24:48.277

这不会解决您所有的问题（这是不可能的），但这里有一个解决方案，可以让您使用有限的返回信息来解析 json。

在外层，您创建一个对象，称为 Vehicle。这包含汽车、船和飞机。您正在请求一些车辆，但您不知道它是汽车、船还是飞机（请注意，这可以很容易地扩展为处理一系列车辆或许多其他更复杂的响应）。在架构中，您有一些选项，例如；

```
"id": "vehicle.schema.json",
"type": "object",
"required": true,
"additionalProperties": false,
"properties": {
    "Car": {
        "type": "object",
        "required": false
        //other properties
    },
              "Boat": {
        "type": "object",
        "required": false
        //other properties
    },
            "Plane": {
        "type": "object",
        "required": false
        //other properties
    } 
```

以上是您将添加到项目中的架构文件。如果您想拥有其中的几个，只需将更多元组添加到下面的 _schemaTypes 数组中。

```
 // code to set up your schema
  // Associate types to their JsonSchemas.  Order matters here.
  // After each parse, the schema is added to resolver, which is used in subsequent parses.
        _schemaTypes = new[]
        {
            Tuple.Create(typeof(Vehicle), "vehicle.schema.json"),
        }
        .ToDictionary(
            x => x.Item1,
            x => JsonSchema.Parse(
                File.ReadAllText(
                    Path.Combine(AppDomain.CurrentDomain.RelativeSearchPath ?? "",  @"Serialization\Schemas\") + x.Item2),
                    resolver));

 //method to return your deserialized object
 public T Deserialize<T>(IRestResponse response)
    {
        var schema = _schemaTypes[typeof(T)];

        T result = _serializer.Deserialize<T>(
                new JsonValidatingReader(
                    new JsonTextReader(
                        new StringReader(response.Content)))
                {
                    Schema = schema
                });
        return result;
    } 
```

现在，在您解析响应后，您将拥有一个更通用的对象，您可以从那里编写一些代码来确定返回的更具体的对象是什么。我正在使用这种类型的方法来解析 json，其中它具有多个级别的嵌套对象和对象数组，并且相当有效。

# jsp - loop not running in dynamic java web project

> ID：13316963
> 
> 赞同：1
> 
> 时间：2012-11-09T22:28:51.867
> 
> 标签：jsp

Whenever I try to iterate though my model object on the jsp UI using the `</c:forEach>` iterator I get the following error:

```
HTTP ERROR 500
Problem accessing /SelfService2.0/app/agenda/data. Reason: 

javax/el/ValueExpression 
```

Is this to do with library mismatch?

Also I am running my project on J2EE preview on the eclipse.

My WEB-INF/lib does have the relevant libraries .

Thanks

```
 <c:if test="${empty agendaList}">
                    <div style="float: left!important; margin: 10px;">No Data Please use Upload Functionality</div>
                    </c:if>
                    <input type="button" class="eventBtn uploadData" value="Import Master.xlsx >>"
                        style="float: right; margin: 10px; background-color: #88b3da" />
                    <div class="clearBoth"></div>
                    <div id="accordion">
                        <c:forEach var="agenda" items="${agendaList}" varStatus="rowCnt">
                            <input id="agendaName${agenda.agendaDetail.agendaId}" type="hidden"  value="${agenda.agendaDetail.agendaName}"/>
                            <div id="agendaItem${agenda.agendaDetail.agendaId}" class="agendaItem">
                                <div class="accHead">
                                    <div class="agendaTime">${agenda.agendaDetail.startTime}<br />${agenda.agendaDetail.endTime}</div>
                                    <div class="agendaName">${agenda.agendaDetail.agendaName}</div>
                                    <div style="padding-top: 5px;">
                                        <a href="javascript:void(0)" class="orangeLink accEdit">Edit</a>
                                        <span class="openCloseImg"></span>
                                    </div>
                                </div>
                                <div class="accBody">
                                    <table>
                                        <tr>
                                            <td class="leftTD">Date</td>
                                            <td style="padding: 10px 0;">
                                                    <input id="datepicker${agenda.agendaDetail.agendaId}" type="text"  value="${agenda.agendaDetail.startDate}" disabled="disabled"/>
                                                    <script>
                                                    var cntd=${agenda.agendaDetail.agendaId};
                                                    initialiseDatepick(cntd);
                                                    </script>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD">Start Time</td>
                                            <td style="padding: 10px 0;">
                                                <input id="startTime${agenda.agendaDetail.agendaId}"  type="text" value="${agenda.agendaDetail.startTime}" disabled="disabled"/>

                                                <span class="leftTD">End Time</span>

                                                <input id="endTime${agenda.agendaDetail.agendaId}"  type="text" value="${agenda.agendaDetail.endTime}" disabled="disabled"/>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD vAlignTop">Description</td>
                                            <td style="padding: 10px 0;">
                                                <textarea id="description${agenda.agendaDetail.agendaId}"  class="demo">${agenda.agendaDetail.description}</textarea>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD vAlignTop">Speaker(s)</td>
                                            <%-- <td style="padding: 10px 0;">
                                                <c:forEach var="speaker" items="${agenda.speakerList}" varStatus="rowCnt">
                                                    ${speaker.firstName} ${speaker.lastName}<br/>
                                                </c:forEach>
                                                <a href="#" class="addAnother orangeLink">+ Add another</a>
                                            </td> --%>
                                            <td style="padding: 10px 0;">
                                                <table class="alternate" id="spkrTbl${agenda.agendaDetail.agendaId}">
                                                    <tr>
                                                        <th style="width: 35%;">Name</th>
                                                        <th style="width: 25%;">Firm</th>
                                                        <th style="width: 20%;">Role</th>
                                                        <th style="width: 20%;">Remove</th>
                                                    </tr>
                                                    <c:forEach var="speaker" items="${agenda.speakerList}" varStatus="rowCnt">
                                                        <tr>
                                                            <td>${speaker.firstName} ${speaker.lastName}</td>
                                                            <td>${speaker.firm}</td>
                                                            <td>${speaker.type}</td>
                                                            <td valign="middle">
                                                                <img src="../../images/trash.jpg" alt="Delete" onclick="deleteRow(${agenda.agendaDetail.agendaId}, ${speaker.attendeeId}, 'Speaker', this)"/>
                                                            </td>
                                                        </tr>
                                                    </c:forEach>
                                                </table>
                                                <div class="addNew"><a href="javascript:void(0);" class="addAnother orangeLink">+ Add another</a></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD">Location</td>
                                            <td style="padding: 10px 0;">
                                                <input id="location${agenda.agendaDetail.agendaId}" type="text" value="${agenda.agendaDetail.location}" disabled="disabled" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD vAlignTop">Breakout Materials</td>
                                            <td style="padding: 10px 0;">
                                                <table class="alternate" id="mtrlTbl${agenda.agendaDetail.agendaId}">
                                                    <tr>
                                                        <th style="width: 35%;">Asset Name</th>
                                                        <th style="width: 45%;">Asset Type</th>
                                                        <th style="width: 20%;">Remove</th>
                                                    </tr>
                                                    <c:forEach var="material" items="${agenda.agendaMaterialList}" varStatus="rowCnt">
                                                        <tr>
                                                            <td>${material.materialDisplayName}</td>
                                                            <td>${material.assetType}</td>
                                                            <td valign="middle">
                                                                <img src="../../images/trash.jpg" alt="Delete" onclick="deleteRow(${agenda.agendaDetail.agendaId}, ${material.materialId}, 'Material', this)"/>
                                                            </td>
                                                        </tr>
                                                    </c:forEach>
                                                </table>
                                                <div class="addNew"><a href="javascript:void(0)" class="orangeLink addMaterial">+ Add New</a></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD vAlignTop">Activity Feedback</td>
                                            <td style="padding: 10px 0;">
                                                <table class="alternate">
                                                    <tr>
                                                        <th style="width: 35%;">Survey Names</th>
                                                        <th style="width: 45%;">Responses</th>
                                                        <th style="width: 20%;">Remove</th>
                                                    </tr>
                                                    <tr>
                                                        <td>Rate the Speaker</td>
                                                        <td>7-star</td>
                                                        <td valign="middle">
                                                            <img src="../../images/trash.jpg" alt="Delete"/>
                                                        </td>
                                                    </tr>
                                                </table>
                                                <div class="addNew"><a href="javascript:void(0)" class="orangeLink">+ Add New</a></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="leftTD vAlignTop">Participants</td>
                                            <td style="padding: 10px 0;">
                                                <table class="alternate">
                                                    <tr>
                                                        <th style="width: 35%;">Name</th>
                                                        <th style="width: 25%;">Firm</th>
                                                        <th style="width: 20%;">Role</th>
                                                        <th style="width: 20%;">Remove</th>
                                                    </tr>
                                                    <c:forEach var="participant" items="${agenda.participantList}" varStatus="rowCnt">
                                                        <tr>
                                                            <td>${participant.firstName} ${participant.lastName}</td>
                                                            <td>${participant.firm}</td>
                                                            <td>${participant.type}</td>
                                                            <td valign="middle">
                                                                <img src="../../images/trash.jpg" alt="Delete" onclick="deleteRow(${agenda.agendaDetail.agendaId}, ${participant.attendeeId}, 'Attendee', this)"/>
                                                            </td>
                                                        </tr>
                                                    </c:forEach>
                                                </table>
                                                <div class="addNew"><a href="javascript:void(0)" class="orangeLink addParticipant">+ Add New</a></div>
                                                </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </c:forEach>
                        <hr />
                        <c:if test="${fn:length(agendaList) > 0}">
                        <input type="button" class="eventBtn"
                            style="margin: 10px; background-color: #88b3da" value="Save" onclick="saveAgenda(${fn:length(agendaList)})"/>
                        <input type="button" class="eventBtn"
                            style="margin: 10px; background-color: #88b3da" value="Save and Add New" />
                        </c:if>

...................................exception......................................
HTTP ERROR 500
Problem accessing /SelfService2.0/app/agenda/data. Reason: 

    javax/el/ValueExpression

Caused by:
java.lang.NoClassDefFoundError: javax/el/ValueExpression
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)
    at java.lang.Class.getDeclaredMethods(Class.java:1791)
    at java.beans.Introspector$1.run(Introspector.java:1287)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.beans.Introspector.getPublicDeclaredMethods(Introspector.java:1285)
    at java.beans.Introspector.getTargetMethodInfo(Introspector.java:1151)
    at java.beans.Introspector.getBeanInfo(Introspector.java:402)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at java.beans.Introspector.getBeanInfo(Introspector.java:229)
    at java.beans.Introspector.(Introspector.java:383)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at java.beans.Introspector.getBeanInfo(Introspector.java:229)
    at java.beans.Introspector.(Introspector.java:383)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at org.apache.jasper.compiler.Generator$TagHandlerInfo.(Generator.java:3713)
    at org.apache.jasper.compiler.Generator$GenerateVisitor.getTagHandlerInfo(Generator.java:2120)
    at org.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1599)
    at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)
    at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)
    at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)
    at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219)
    at org.apache.jasper.compiler.Node$Root.accept(Node.java:456)
    at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)
    at org.apache.jasper.compiler.Generator.generate(Generator.java:3305)
    at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:198)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)
    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:563)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:303)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:380)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)
    at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:334)
    at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1047)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:817)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1148)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1139)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:378)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)
    at org.mortbay.jetty.handler.HandlerList.handle(HandlerList.java:49)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:324)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:535)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:865)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:540)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:213)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:520)
Caused by: java.lang.ClassNotFoundException: javax.el.ValueExpression
    at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
    at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:401)
    at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:363)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    ... 71 more

Caused by:
java.lang.ClassNotFoundException: javax.el.ValueExpression
    at java.net.URLClassLoader$1.run(URLClassLoader.java:200)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:188)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:307)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:252)
    at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:401)
    at org.mortbay.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:363)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)
    at java.lang.Class.getDeclaredMethods(Class.java:1791)
    at java.beans.Introspector$1.run(Introspector.java:1287)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.beans.Introspector.getPublicDeclaredMethods(Introspector.java:1285)
    at java.beans.Introspector.getTargetMethodInfo(Introspector.java:1151)
    at java.beans.Introspector.getBeanInfo(Introspector.java:402)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at java.beans.Introspector.getBeanInfo(Introspector.java:229)
    at java.beans.Introspector.(Introspector.java:383)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at java.beans.Introspector.getBeanInfo(Introspector.java:229)
    at java.beans.Introspector.(Introspector.java:383)
    at java.beans.Introspector.getBeanInfo(Introspector.java:168)
    at org.apache.jasper.compiler.Generator$TagHandlerInfo.(Generator.java:3713)
    at org.apache.jasper.compiler.Generator$GenerateVisitor.getTagHandlerInfo(Generator.java:2120)
    at org.apache.jasper.compiler.Generator$GenerateVisitor.visit(Generator.java:1599)
    at org.apache.jasper.compiler.Node$CustomTag.accept(Node.java:1441)
    at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)
    at org.apache.jasper.compiler.Node$Visitor.visitBody(Node.java:2213)
    at org.apache.jasper.compiler.Node$Visitor.visit(Node.java:2219)
    at org.apache.jasper.compiler.Node$Root.accept(Node.java:456)
    at org.apache.jasper.compiler.Node$Nodes.visit(Node.java:2163)
    at org.apache.jasper.compiler.Generator.generate(Generator.java:3305)
    at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:198)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)
    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:563)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:303)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:380)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)
    at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:334)
    at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
    at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)
    at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1047)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:817)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
    at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1148)
    at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1139)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:378)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:417)
    at org.mortbay.jetty.handler.HandlerList.handle(HandlerList.java:49)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:324)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:535)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:865)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:540)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:213)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:520) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T16:30:16.167

```
Caused by: java.lang.NoClassDefFoundError: javax/el/ValueExpression 
```

有根本原因。该类是[EL 2.1](http://docs.oracle.com/javaee/5/api/javax/el/ValueExpression.html)的一部分，它应该*已经*是理智的 Servlet 2.5 / JSP 2.1 兼容容器的一部分。

`/WEB-INF/lib`如果您在 web 应用程序中乱扔了单独下载的任意 servletcontainer 的不同和旧版本的 EL 库，那么它将失败。

您需要确保 webapp**仅**`/WEB-INF/lib`包含您的 webapp 所需的库，而不是 servletcontainer 本身已经提供的库（例如 Servlet、JSP 和 EL 库）。从那里删除任何特定于容器的库，例如,等。**`el-api.jar``el-impl.jar`**

# c# - 从页面读取的 Windows 8 应用程序

> ID：13316964
> 
> 赞同：0
> 
> 时间：2012-11-09T22:28:58.533
> 
> 标签：c#, windows, windows-8

我需要使用 Windows 8 Metro 应用程序从网页中读取文本吗？我尝试了一些示例，但它们似乎都不起作用......我想我使用了 httpwebresponse 类。有人可以解释一下它是如何工作的或提供一个可行的教程吗？

我正在使用 C# 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T22:38:28.373

查看 MSDN 中的 HttpRequest、HttpReponse、HttpWebRequest.GetReponse() 函数和类。

# css - 输入在标签内时的CSS复选框和单选按钮？

> ID：13316966
> 
> 赞同：36
> 
> 时间：2012-11-09T22:29:08.673
> 
> 标签：css, input, checkbox, radio-button, label

我在这里广泛搜索了这个问题的答案，但还没有完全找到我正在寻找的东西。找到这个[CSS - 如何为选定的单选按钮标签设置样式？](https://stackoverflow.com/questions/4641752/css-how-to-style-a-selected-radio-buttons-label)但答案涉及更改标记，这是我想避免的事情，我将在下面解释。

我正在尝试将自定义 css3 复选框和单选按钮添加到我的 XenForo 论坛主题中，并且我在此阅读的所有教程在输入后都有标签：

```
<input type="checkbox" id="c1" name="cc" />
<label for="c1">Check Box 1</label> 
```

然而，在 XenForo 的标记中，输入位于标签内：

```
<label for="ctrl_enable_rte">
<input type="checkbox" name="enable_rte" value="1" id="ctrl_enable_rte" {xen:checked "{$visitor.enable_rte}"} />
{xen:phrase use_rich_text_editor_to_create_and_edit_messages}
</label> 
```

我调查了为什么会这样，但是当标记是这种方式时，没有找到与自定义 CSS 复选框/单选按钮相关的任何内容。我想避免更改标记，因为我在这里处理的是一个论坛系统，这将涉及编辑一堆核心模板......然后我必须在每次论坛软件时更新标记发布更新（假设模板已更改）。

我试图创建适用于这种类型标记的 CSS 规则，但到目前为止我还没有成功。我对 CSS 不太熟悉，没有记住每个选择器，而且伪类对我来说仍然很陌生，所以我希望这里有人能说明这是否可行，如果可以，我是如何做到的可能会去做。我已经准备好我的精灵了，我只需要弄清楚 CSS。

我的主要问题是我不知道如何选择标签（当然只有与这些输入相关的标签）。通常像

```
input[type="checkbox"] + label 
```

已使用，但是当标签不在输入之后而是在输入之外/之前...我该如何选择它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-09T22:56:39.790

如果您可以编辑标记以包装实际的标签文本，例如：

```
<label>
    <input type="checkbox">
    <span>One</span>
</label>
<label>
    <input type="checkbox">
    <span>Two</span>
</label>
<label>
    <input type="checkbox" disabled>
    <span>Three</span>
</label> 
```

你可以使用 CSS 实现一些技巧：

```
label {
    position:relative;   
    cursor:pointer;
}
label [type="checkbox"] {
    display:none; /* use your custom sprites instead as background on the span */
}
[type="checkbox"] + span {
    display:inline-block;
    padding:1em;
}
:checked + span {
    background:#0f0;
}
[type="checkbox"][disabled] + span {
    background:#f00;  
}​ 
```

演示：

```
label {
  position: relative;
  cursor: pointer;
}

label [type="checkbox"] {
  display: none;
}

[type="checkbox"]+span {
  display: inline-block;
  padding: 1em;
}

:checked+span {
  background: #0f0;
  display: inline-block;
}

[type="checkbox"][disabled]+span {
  background: #f00;
}
```

```
<label>
    <input type="checkbox">
    <span>One</span>
</label>
<label>
    <input type="checkbox">
    <span>Two</span>
</label>
<label>
    <input type="checkbox" disabled>
    <span>Three</span>
</label>
```

[http://jsfiddle.net/dMhDM/1/](http://jsfiddle.net/dMhDM/1/)

请记住，如果浏览器不支持，这将失败`:checked`。

这与其他解决方案基本相同，但样式是在跨度而不是标签上完成的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-12-31T18:19:36.527

恕我直言，在不弄乱 PURE CSS 的 html 的情况下做到这一点的最佳方法是

```
 input[type="checkbox"] {
     position: relative;
     cursor: pointer;
     padding: 0;
     margin-right: 10px;
}
 input[type="checkbox"]:before {
     content: '';
     margin-right: 10px;
     display: inline-block;
     margin-top: -2px;
     width: 20px;
     height: 20px;
     background: #fcfcfc;
     border: 1px solid #aaa;
     border-radius: 2px;
}
 input[type="checkbox"]:hover:before {
     background: #f5821f;
}
 input[type="checkbox"]:focus:before {
     box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.12);
}
 input[type="checkbox"]:checked:before {
     background: #f5821f;
     border-color: #f5821f;
}
 input[type="checkbox"]:disabled {
     color: #b8b8b8;
     cursor: auto;
}
 input[type="checkbox"]:disabled:before {
     box-shadow: none;
     background: #ddd;
}
 input[type="checkbox"]:checked:after {
     content: '';
     position: absolute;
     left: 5px;
     top: 8px;
     background: white;
     width: 2px;
     height: 2px;
     box-shadow: 2px 0 0 white, 4px 0 0 white, 4px -2px 0 white, 4px -4px 0 white, 4px -6px 0 white, 4px -8px 0 white;
     transform: rotate(45deg);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-09T22:53:57.353

Unfortunately CSS doesn't allow the styling of parent elements based on child elements which would be the easy way example:

```
div.a < div { border: solid 3px red; } 
```

The opposite of selecting a child based on parent:

```
div.a > div { border: solid 3px red; } 
```

What you are wanting to do can be achieved using jQuery.

Check out [this](https://stackoverflow.com/questions/2326499/apply-css-styles-to-an-element-depending-on-its-child-elements) post.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-09T22:53:59.997

Very interesting question. Truth be told, I'm pretty sure that's just not possible with CSS alone.

If there's some sort of pattern to the label's for attribute (`ctrl_enable_rte`), there's hope for you. For example, if all checkbox labels end with `rte`, you could use

```
label[for$=rte] { ... } 
```

If there is no such pattern, and the checkbox IDs are chosen arbitrarily, you'll have to resort to JavaScript.

# wordpress - 在 Ubuntu 12.10 上安装 WordPress

> ID：13316969
> 
> 赞同：2
> 
> 时间：2012-11-09T22:29:23.393
> 
> 标签：wordpress, ubuntu

我是 Ubuntu 的新手。最近我正在使用 Ubuntu 12.10。当我使用 windows xp 时，我在 XAMPP 中使用了 WordPress。在XAMPP 上windows xp 中WordPress 的安装方式非常简单，只需将下载的WordPress 文件复制到'htdocs' 文件夹并修改一些'wpconfig.php' 即可使用。现在在 Ubuntu 12.10 中，我使用 LAMPP，执行与 windows xp 相同的过程，但不起作用。

任何建议...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T23:08:46.113

1）运行应用程序“终端”

键入以下内容：

```
cd /var/www 
```

您现在处于`htdocs`XAMP 以前的状态

2）现在输入以下内容：

```
sudo wget http://wordpress.org/latest.tar.gz 
```

您应该能够观看 Ubuntu 连接和下载 wordpress。

3）下载后输入：

```
ls 
```

您应该会在其中看到一个名为的文件`latest.tar.gz`。

4) 键入以下内容：

```
tar -xzvf latest.tar.gz 
```

此命令将解压缩您刚刚下载的压缩文件。

5）再次输入：

```
ls 
```

您应该看到一个名为“wordpress”的目录。

您现在可以通过以下方式访问您的 wordpress 安装

```
http://localhost/wordpress/wp-admin/install.php 
```

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T18:55:59.890

## 首先复制下载的 WordPress 文件并将其粘贴到桌面。下载的文件名假定为“latest.tar.gz”

## 然后打开“终端”并写入

```
 cd Desktop 
```

## 现在输入

```
sudo tar -xzvf latest.tar.gz 
```

将下载的文件解压缩为原始文件

## 现在输入

```
sudo mv wordpress /opt/lampp/htdocs 
```

将“wordpress”文件移动到 /opt/lampp/htdocs

## 现在我们完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-15T21:05:52.590

[我在这里http://development.solepop.com/setting-up-wordpress-on-ubuntu/](http://development.solepop.com/setting-up-wordpress-on-ubuntu/)找到了一个很好的关于在 Ubuntu 服务器上安装 WordPress 的教程。

先决条件：

您应该拥有来自您选择的托管服务提供商的准系统 Ubuntu 服务器，并具有 root 访问权限。您还应该通过 DNS 将您的域映射到服务器的 IP 地址。

步骤 1\. 确保您的盒子安装了灯组。在您的服务器框中以 root 用户身份登录，并首先使用以下命令更新软件包：

```
sudo apt-get update 
```

然后安装灯服务器：

```
sudo apt-get install lamp-server^ 
```

** 确保最后有 (^)

系统将提示您为 root 用户提供 mysql 密码。继续输入并在下一个屏幕中确认密码。

步骤 2\. 设置你的 mysql 数据库

```
mysql -u root -p 
```

系统将提示您提供密码。插入您在步骤 1 中指定的密码。然后您将可以访问 MySQL 命令行，您可以在其中创建 MySQL 数据库和用户：

```
CREATE DATABASE wordpressblog;
CREATE USER wordpressblog@localhost IDENTIFIED BY '<set a password for the new database user>';
GRANT ALL PRIVILEGES ON wordpressblog.* TO wordpressblog@localhost;
FLUSH PRIVILEGES;
exit 
```

第 3 步。按顺序输入以下内容（确保替换为您的域地址，在我们的例子中是 solepop.com）：

```
mkdir -p /srv/www/<your domain>/src/
mkdir -p /srv/www/<your domain>/public_html/
cd /srv/www/<your domain>/src/
wget http://wordpress.org/latest.tar.gz
tar -zxvf /srv/www/<your domain>/src/latest.tar.gz
cp -R /srv/www/<your domain>/src/wordpress/* /srv/www/<your domain>/public_html/
rm -rf /srv/www/<your domain>/src/wordpress/
sudo chown -R www-data:www-data /srv/www/<your domain>/public_html 
```

我们在这里所做的几乎就是创建了一个 src 文件夹，我们在其中下载了最新版本的 WordPress。在我们的 src 文件夹中解压缩安装后，我们将 src 文件夹中的所有内容复制到我们的 public_html 文件夹中。复制完所有内容后，我们从 src 文件夹中删除了下载的 WordPress 文件。最后，我们将 public_html 文件夹的所有权交给了 apache。

步骤 4\. 授予 public_html 文件夹和文件适当的权限：

```
find /srv/www/<your domain>/public_html -type d -exec chmod 755 {} +
find /srv/www/<your domain>/public_html -type f -exec chmod 644 {} + 
```

步骤 5\. 转到 apache2 中启用站点的文件夹。

```
cd /etc/apache2/sites-enabled 
```

步骤 6\. 删除 000-default.conf 文件中的所有内容并键入以下内容（为所有区域插入您的域名）：

```
<VirtualHost *:80>

# The ServerName directive sets the request scheme, hostname and port that

# the server uses to identify itself. This is used when creating

# redirection URLs. In the context of virtual hosts, the ServerName

# specifies what hostname must appear in the request's Host: header to

# match this virtual host. For the default virtual host (this file) this

# value is not decisive as it is used as a last resort host regardless.

# However, you must set it for any further virtual host explicitly.

ServerName <your domain>

<Directory />
 AllowOverride all
 Require all granted
</Directory>

DocumentRoot /srv/www/<your domain>/public_html/

# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,

# error, crit, alert, emerg.

# It is also possible to configure the loglevel for particular

# modules, e.g.

#LogLevel info ssl:warn

ErrorLog ${APACHE_LOG_DIR}/error.log

CustomLog ${APACHE_LOG_DIR}/access.log combined

# For most configuration files from conf-available/, which are

# enabled or disabled at a global level, it is possible to

# include a line for only one particular virtual host. For example the

# following line enables the CGI configuration for this host only

# after it has been globally disabled with "a2disconf".

#Include conf-available/serve-cgi-bin.conf

</VirtualHost> 
```

步骤 7\. 启用 mod rewrite（对于永久链接工作很重要）并重新启动 apache。

```
 a2enmod rewrite
 service apache2 restart 
```

步骤 8\. 从浏览器转到您的域。

点击走吧

[第 1 步 http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.37.52-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.37.52-PM.png)

填写步骤 2 中的数据库信息。

[第 2 步 http://www.solepop.com/wp-content/uploads/2015/01/Screenii-Shot-2015-01-12-at-4.42.06-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screenii-Shot-2015-01-12-at-4.42.06-PM.png)

单击运行安装。

[第 3 步 http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.42.24-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.42.24-PM.png)

填写有关您博客的基本信息。

[第 4 步 http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.42.39-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-4.42.39-PM.png)

安装完成……</p>

[第 5 步 http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-8.27.38-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-8.27.38-PM.png)

安装后，在浏览器上访问您的域，您应该会看到您的 WordPress 博客。

[第 6 步 http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-8.27.53-PM.png](http://www.solepop.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-12-at-8.27.53-PM.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-19T07:39:56.363

如果您想在 Ubuntu 上安装 wordpress，可以点击以下链接：

*   [手动](https://rbgeek.wordpress.com/2012/09/19/how-to-install-wordpress-in-ubuntu-server-12-04-lts/)
*   [外壳脚本](https://rbgeek.wordpress.com/2014/08/07/automated-installation-of-lamp-stack-on-ubuntu-server/)
*   [Ansible](https://rbgeek.wordpress.com/2015/02/25/installing-the-wordpress-on-ubuntu-using-ansible/)

希望这会对您有所帮助。谢谢

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-10-13T12:17:26.017

[在 Ubuntu 中安装 WordPress 的过程](https://www.znetlive.com/blog/how-to-install-wordpress-in-ubuntu/)：

> 1.  安装网络服务器：网络服务器是我们用来在网络浏览器上提供网页的前端。我们将在我们的服务器上安装 Apache2 作为网络服务器。
>     
>     
> 2.  设置 MySQL 服务： MySQL 是用于存储我们数据的数据库。另一种选择是使用 Maria DB。但是既然我们选择了MySQL。
>     
>     
> 3.  安装 PHP 及其模块 安装完上述所有服务器和软件包后，Ubuntu 服务器现在已准备好托管 WordPress。
>     
>     
> 4.  在 /var/www/html/ 中下载 WordPress 并解压。
>     
>     
> 5.  这是配置 WordPress 的最后一步。

# xml - XSLT：使用多个或模板匹配来应用模板

> ID：13316970
> 
> 赞同：16
> 
> 时间：2012-11-09T22:29:26.170
> 
> 标签：xml, xslt, xpath

我有一个包含多个节点的 XML，每个节点都有相似的数据。我想从每个节点（用户：IPADDRESS）中删除一个特定属性。我已经想出了如何使用 ors 将多个元素链接在一起，只需省略 User="{@User}" 匹配项，因此它不会出现在结果中：

XSL 代码段：

```
<xsl:template match="Creation | Test | Assignment | Modification | Repair | Termination">
<Creation CommitID="{@CommitID}" Date="{@Date}" BoardID="{@BoardID}">
<xsl:apply-templates/>
</Creation>
</xsl:template> 
```

不出所料，“Creation”之后的所有节点名称都被重命名为 Creation，因为这就是我告诉它要做的事情。我如何传递各种匹配项，以便在结果中以正确的顺序应用它们？我知道我可以为各种匹配中的每一个使用相同的 XSL 语句做一个蛮力的方式（这就是我第一次这样做的方式），但必须有一个更优雅的方法，它只是在逃避我。我有数百万行 XML 需要处理，而这只是我要做的许多转换中的第一个。

如果有任何后果，我在 Win7 机器上使用 msxsl V4.0 进行转换。

XML:

```
<?xml version="1.0"?>
<BoardDatabase>
<Board_Data BoardID="1035">
    <Creation CommitID="12b" Date="2007-12-07T15:43:51" BoardID="1035" User="CSAGAN:192.168.1.177">
        <BoardDrawing>3B</BoardDrawing>
        <AssemblyDrawing>2010F</AssemblyDrawing>
        <Notes>PO Num 1959</Notes>
    </Creation>
    <Test CommitID="117" Date="2007-12-10T10:39:43" BoardID="1035" User="CSAGAN:192.168.1.183">
        <ElectricalTestData Result="FAIL" Version="IMM STD REVF">
            <AutomatedTest ReportVersion="1.0">
                <TestSetup>
                    <TestAppBuildDate>Dec 07 2007</TestAppBuildDate>
                    <VersionPath>c:\tests\versions\v12.txt</VersionPath>
                    <VersionNumber>1.2</VersionNumber>
                    <OperatorName>CSAGAN</OperatorName>
                    <StationID>PC-191-NDGrasse</StationID>
                    <JigSN>12345</JigSN>
                    <JigAssembly>42</JigAssembly>
                    <TestStartTime>2007-12-10 10:34:17</TestStartTime>
                </TestSetup>
            </AutomatedTest>
        </ElectricalTestData>
    </Test>
    <Assignment CommitID="1c1f" User="JRandi:192.168.1.162" Date="2008-09-30T07:36:52" BoardID="1035">
        <Notes>Boardset failed etest twice, no problem log entry/repair attempts made.</Notes>
    </Assignment>
    <Modification CommitID="2bb7" User="JRandi:192.168.1.162" Date="2009-03-11T13:31:21" BoardID="1035">
        <AssemblyDrawing>2001G</AssemblyDrawing>
        <Notes>Cornelius upgraded boardset to rev. G</Notes>
    </Modification>
</Board_Data>
</BoardDatabase> 
```

XSL：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

<xsl:template match="Creation | Test | Assignment | Modification | Repair | Termination">
<Creation CommitID="{@CommitID}" Date="{@Date}" BoardID="{@BoardID}">
<xsl:apply-templates/>
</Creation>
</xsl:template>

<xsl:template match="@*|node()">
<xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
</xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

最新的 XSL 使用 @DevNull 的解决方案，将原始文件的大小翻倍：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

<!-- Answer from Stack Overflow that only strips out the IP Address from the User attribute. -->
<xsl:template match="@User">
  <xsl:attribute name="User">
    <xsl:value-of select="substring-before(.,':')"/>
  </xsl:attribute>
</xsl:template>

<xsl:template match="@*|node()">
<xsl:copy>
    <xsl:apply-templates select="@*|node()"/>
</xsl:copy>
</xsl:template>
</xsl:stylesheet> 
```

@Dimitre 解决方案的最新 XSL 需要很长时间才能处理（超过 30 分钟后仍在运行，但文件仍在增长）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

<xsl:template match="node()|@*">
  <xsl:copy>
     <xsl:apply-templates select="node()|@*"/>
   </xsl:copy>
 </xsl:template>

 <xsl:template match=
  "*[contains('|Creation|Test|Assignment|Modification|Repair|Termination|',concat('|', name(), '|'))
]/@user"/>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-09T23:03:38.540

尝试将您的模板更改为：

```
<xsl:template match="Creation|Test|Assignment|Modification|Repair|Termination">
    <xsl:copy>
        <xsl:apply-templates select="@*[not(name()='User')]|node()"/>
    </xsl:copy>
</xsl:template> 
```

您会注意到它看起来很像您的身份模板，其中添加了谓词`@*`。

此外，如果您想剥离所有`User`属性，无论元素是什么，您都可以使用此模板：

```
<xsl:template match="@User"/> 
```

`Creation`这是另一种方式（为了简洁起见，仅剥离`Test`）

```
<xsl:template match="@User[..[self::Creation or self::Test]]"/> 
```

* * *

**回复评论**

请改用此模板：

```
<xsl:template match="@User">
    <xsl:attribute name="User">
        <xsl:value-of select="substring-before(.,':')"/>
    </xsl:attribute>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T16:09:11.323

**我会使用我认为更好的解决方案：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match=
 "*[contains('|Creation|Test|Assignment|Modification|Repair|Termination|',
             concat('|', name(), '|'))
   ]/@user"/>
</xsl:stylesheet> 
```

**请注意**：

1.  我们只使用一个覆盖身份规则的模板。它的身体是空的。

2.  元素名称列表以竖线分隔的字符串表示，对于长列表，这可以节省大量空间——此外，这样的字符串可以作为外部参数传递给转换，从而使其具有最大的通用性。

3.  这种转变完全是“推式”。

# java - OpenGL - 在多个位置绘制 VBO

> ID：13316971
> 
> 赞同：0
> 
> 时间：2012-11-09T22:29:33.157
> 
> 标签：java, opengl, render, lwjgl, vbo

所以，在过去的几天里，我开始获得一些 OpenGL 3D 编程的经验。我正在为 Java 使用 LWJGL。我创建了一个带有 fps-movement 的 3d 相机类。我还用 VBO 创建了一个立方体。我可以毫无问题地渲染它。

现在，我怎样才能在另一个位置上绘制相同的 VBO？现在我的立方体在 (0, 0, 0) 上，然后转到 (5, 5, 5)。如果我想在 (10, 10, 10) 到 (15, 15, 15) 处绘制同一个立方体怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T23:36:15.573

将立方体的位置向量作为`uniform vec3`变量传递给顶点着色器。在那里，将它添加到每个顶点的位置。

如果要绘制数百个，可以使用实例化来节省一些性能。为顶点位置设置一个每个顶点属性，`glVertexAttribDivisor`为每个实例的平移设置一个每个实例属性（via = 1）。有关详细信息，请参阅[此 wiki 条目](http://www.opengl.org/wiki/Vertex_Specification#Instanced_arrays)。

# user-interface - Visual Studio 2012 工具栏

> ID：13316973
> 
> 赞同：2
> 
> 时间：2012-11-09T22:29:55.427
> 
> 标签：user-interface, layout, visual-studio-2012, toolbar

有谁知道在 VS2012 中将工具栏移动到菜单栏旁边的方法？
我的设置目前如下所示：

![Visual Studio 2012 菜单和工具栏](../Images/2220e321bb953426f502ebc40914ced9.png)

我喜欢最大化代码空间，但发现工具栏很有用 - 所以与其隐藏它们，我更愿意将它们提升到菜单栏旁边，和/或取消标题栏。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T23:03:50.603

这是一种选择，不完全是您所要求的，但它确实实现了节省房地产的目标。

它是一个 Visual Studio 扩展，允许您在不使用时隐藏主菜单：

[http://visualstudiogallery.msdn.microsoft.com/bdbcffca-32a6-4034-8e89-c31b86ad4813](http://visualstudiogallery.msdn.microsoft.com/bdbcffca-32a6-4034-8e89-c31b86ad4813)

# xcode - Lua 与 Cocos2D 和 Box2D 给出编译错误

> ID：13316977
> 
> 赞同：3
> 
> 时间：2012-11-09T22:30:30.723
> 
> 标签：xcode, cocos2d-iphone, lua, box2d

[按照这篇非常有用的帖子](http://blog.stokedsoftware.com/blog/2012/02/05/scripting-ios-games-with-lua-part-ii/)中描述的过程，我已成功地将 Lua 添加到默认 Xcode 模板项目中，并获得了“Hello, world”。文字印刷。

然而，当我尝试将 Lua 添加到我现有的 Cocos2D/Box2d 项目时，按照完全相同的过程，我得到一个编译错误：

> 架构 i386 的未定义符号：
> 
> “luaL_newstate()”，引用自...

我对这个错误的搜索结果是指这些可能的问题之一，我认为在我的情况下是可以的：

*   目标的 Build Phases -> Compile Sources - 但相同的 Lua.c 文件在默认模板项目和我的 Cocos2D/Box2d 项目中
*   我将默认项目的标题搜索路径设置为与 Cocos2D/Box2d 项目中的匹配，并且模板仍然可以正常编译。
*   模板项目使用的所有框架也在我的 Cocos2D/Box2d 项目中。

我错过了什么？

任何帮助将非常感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-10T01:07:42.010

我最近完成了这个集成，你遇到的问题是 Lua 文件是用 C 编写的，而 Box2D 是 C++。

您将需要像这样包装 Lua 包括：

```
#ifdef __cplusplus
extern "C" {
#include "lua.h"
#include "lualib.h"
#include "lauxlib.h"
}
#endif 
```

如果没有对您遇到的错误发表评论，那应该可以解决问题。

# sql-server - 可能比全文搜索更快？

> ID：13316985
> 
> 赞同：0
> 
> 时间：2012-11-09T22:30:59.660
> 
> 标签：sql-server, tsql

> **可能重复：**
> [SQL 异步多个查询合并结果 - 最大结果（顶部 XYZ）](https://stackoverflow.com/questions/13310177/sql-async-multiple-queries-combine-results-maximum-results-top-xyz)

我有成千上万的表，基本上是这样命名的：

```
Table_key1_key2_key3 
```

结构如下：

```
ID
TextColumn 
```

text列上有全文索引，每个表都有自己的全文目录。

当用户传入一堆 (key1,key2,key3) 元组和搜索文本时，我有一个为这些表生成查询的存储过程。我启动了一堆异步查询，它们搜索`TextColumn`s 并将结果写入表。一旦他们都完成了，我会选择前 1000 个匹配结果。（我还添加了代码，每次完成 100 次时，我都会检查结果表，如果结果超过 1000 个，我会返回）

这样做的问题是它仍然太慢，特别是当匹配很少甚至没有时......）。我们有*很多很多*行，用户通常会选择大约 5,000 个 (key1,key2,key3) 元组进行搜索。有什么好方法可以让我进一步加快速度吗？我可以完全访问整个表结构等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T05:33:05.557

不要将 RDBMS 用于这样的事情。您最好部署一个分布式解决方案，例如 ElasticSearch 或 Solr，它允许您使用比全文搜索提供的方法更灵活的方法来搜索海量文档存储库。

# math - 证明只存在 4 个因数？

> ID：13316986
> 
> 赞同：1
> 
> 时间：2012-11-09T22:31:03.130
> 
> 标签：math, numbers, factorial

我很难理解为什么 40585 是存在的最大因子。为什么不能有一个更大的？

[维基百科](http://en.wikipedia.org/wiki/Factorion)说，“这在 d ≥ 8 时不成立。” 换句话说，任何因子都不能超过 7 位。

但这是怎么知道的？如何证明？对于非常非常大的数字，也许还没有经过测试的数字呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T22:49:07.890

对于*d* =7 你有

> 10 ⁶ = 1,000,000 ≤ *n* ≤ 2,540,160 = 9!∙7

存在一些满足这个不等式的*n*，即使它们实际上都不是一个因式。对于*d* =8 你得到

> 10 ⁷ = 10,000,000 ≤ *n* ≤ 2,903,040 = 9!∙8

由于左侧已经大于右侧，*n*的值不可能同时满足这两个不等式。随着左手边在*d*中呈指数增长，而右手边只是线性增长，问题只会变得更加严重，因为左手边的增长速度将比右手边快得多。

这两个界限的原因很简单：数字必须至少有*d*位，而具有这么多位的最小数字是 10 ^(*d* -1)。另一方面，它必须是*d*阶乘的总和，每个阶乘代表一位数，而您可以通过这种方式获得的最大阶乘是 9！。因此不等式。

# java - 如何使用 Hibernate Criteria 查询嵌套表？

> ID：13316992
> 
> 赞同：3
> 
> 时间：2012-11-09T22:31:23.393
> 
> 标签：java, hibernate, associations, criteria

我已经查看了 SO 和 Google，但我想我没有使用正确的搜索词或其他东西。

无论如何，假设我有三张桌子：

```
Companies
-----------------------------------------
id
name
user_id

Users
-----------------------------------------
id
username
usertype_id

UserTypes
-----------------------------------------
id
typeofuser 
```

一家公司也是如此`ACME`，它将有一个用户`Moe`，而 Moe 将是`Stooge`.

在 SQL 中，我会执行以下操作：

```
select
    *
from companies c
    join users u on (u.id = c.user_id)
    join usertypes ut on (ut.id = u.usertype_id)
where
    ut.typeofuser = 'Stooge' 
```

但我似乎无法弄清楚如何在标准中做到这一点。我试过了：

```
Criteria crit = io.getSession().createCriteria(Company.class);
List<Company> list = 
    crit.createCriteria("users")
        .createCriteria("usertypes")
            .add(Restriction.eq("typeofuser", "Stooge").list(); 
```

但是我得到的记录太多了。结果甚至不接近准确。

我也试过：

```
Criteria crit = io.getSession().createCriteria(Company.class);
List<Company> list = 
    crit.createAlias("users", "u")
        .createAlias("u.usertypes", "ut")
            .add(Restriction.eq("ut.typeofuser", "Stooge").list(); 
```

似乎带回了完全相同的结果集。我实际上已经阅读了用户手册。当我只嵌套一层时（即，用户搜索很好）但是当我得到两层时，我就不太明白了。手册没有帮助。我只是无法将猫和小猫与商业对象联系起来。也许他们应该使用猫、小猫和跳蚤？：-/

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T22:49:42.727

虽然您的查询应该有效，但以下是另一种变体：

```
 Criteria crit = io.getSession().createCriteria(Company.class);
 List<Company> list = 
       crit.createAlias("users", "u")
       .createAlias("u.usertypes", "ut", Criteria.INNER_JOIN, 
                         Restrictions.eq("ut.typeofuser", "Stooge")
       .list(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:50:30.563

没关系。我一直都做对了。我在其他地方出错了。

随意删除这个问题。

# html - 将内容调整为窗口大小

> ID：13316996
> 
> 赞同：1
> 
> 时间：2012-11-09T22:32:01.547
> 
> 标签：html, css

我正在设计一个新网站（现在它远非任何东西），但我正在努力将其中的内容调整为实际的窗口大小。图片讲一千个字。第一张图片是正确的方式，下面是我调整窗口大小时的方式。

![在此处输入图像描述](../Images/9e27ca050dd3070687d55390f920ffc1.png)

![在此处输入图像描述](../Images/86069108d55cc47a628ac2bde6a030ee.png)

```
<div class="header">
<div class="hdrmast-topbar">
    <div class="container">
        <span>Test :: Link 1 | Link 2</span>
    </div>
</div> 
```

我将在标题部分有两个栏，其中之一是代码中的 hdrmast-topbar。父级将被固定并随着滚动而移动。但是，我希望内容随窗口调整大小，例如：http: [//incu.ro/](http://incub.ro/)

目前，标题处于相对位置状态，因为我正在尝试这个问题。

```
/* Header */

.header { min-width: 100%; position: relative; }
.hdrmast-topbar { background-color: #000; width: 100%; max-height: 25px; font-size:   11px; color: #fff; font-weight: bold; text-align: right; padding-top: 5px; padding-bottom: 5px; }
.hdrmast-topbar span { margin: 0; padding: 0; }

/* Global */

.container { width: 1120px; margin: 0 auto; } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T22:41:14.570

只需删除

```
.container { width: 1120px; 
```

改用`width: 100%;`...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T22:54:01.980

您可以为容器提供 1120 像素的最大宽度和 100% 的宽度。

```
​.container{
    margin: 0 auto;
    background:blue;
    max-width:1120px;
    width:100%;
}​ 
```

JsFiddle：http: [//jsfiddle.net/tDjA9/2/embedded/result/](http://jsfiddle.net/tDjA9/2/embedded/result/)

希望这会有所帮助，并且我已经正确理解了您的问题.. :-)

编辑 -

为了获得与您发布的网站相同的效果，您应该正确地使用 position:fixed 。

我创建了一个新的 jsfiddle 来展示这一点。[http://jsfiddle.net/tDjA9/6/embedded/result/](http://jsfiddle.net/tDjA9/6/embedded/result/) :-)