# StackOverflow 问答 12884000-12884999

# iphone - 及时在 ios 上进行应用内购买

> ID：12884003
> 
> 赞同：0
> 
> 时间：2012-10-14T16:06:53.700
> 
> 标签：iphone, objective-c, ios, in-app-purchase

我们是否能够在任何时间段（如 1 天甚至 1 小时）内打开任何及时的应用内（作为消耗品）？苹果对这种应用内的反应是什么？

如果我能够做到，并且我不希望它成为应用内订阅类型（不重复），我的应用内类型是什么？它应该是消耗品还是订阅？

任何有关在 iOS 上及时进行应用内购买的文章和提示，包括 Apple 的行为，都将受到重视。

可能的例子：

*   1小时超级力量
*   1 天隐形

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:15:56.923

这是消耗品的典型用途。您可能希望在首次使用而不是购买时开始适用的时间范围。

请记住，您需要自己跟踪购买和使用情况，如果它与用户可以在多个设备或平台上玩的应用程序绑定，它可能涉及您自己的服务器。

# android - 如何在我的 android 应用程序中打开一个 ServerSocket？

> ID：12884012
> 
> 赞同：3
> 
> 时间：2012-10-14T16:07:52.347
> 
> 标签：android, serversocket

好的，所以我正在做一些看起来应该很容易的事情。我基本上是在尝试打开一个 ServerSocket 连接，然后等待客户端连接。

这是我的代码。

```
ServerSocket serverSocket = new ServerSocket(6543);
Socket clientSocket = serverSocket.accept(); 
```

每当我的代码命中 serverSocket.accept(); 时，我都会抛出以下异常。

```
bind failed: EADDRINUSE (Address already in use) 
```

所以很明显我的下一步是检查另一个端口是否可以工作，但它没有。接下来我重新启动设备并尝试运行该应用程序，我得到了同样的异常。我已授予我的应用程序 INTERNET 权限，并且设备已植根。

这是我显示的网络接口。

```
lo: ::1%1
lo: 127.0.0.1
eth0: //IPV6 address 
eth0: 192.168.1.127 
```

编辑 1

这是我在调试时得到的 serverSocket 对象信息。

```
ServerSocket[addr=192.168.1.121/192.168.1.121,port=0,localport=1234] 
```

编辑 2

我的 ServerSocket 中有以下可用的构造函数

```
new ServerSocket(int port)
new ServerSocket(int port, int backlog)
new ServerSocket(int port, int backlog, InetAddress localAddress) 
```

我尝试使用第三个构造函数和相同的异常。

```
new ServerSocket(4567, 0, InetAddress.getLocalHost()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T23:07:04.730

好吧，所以我终于弄清楚了为什么我的应用程序会抛出异常，以及是否有人对此有一些反馈或想提供关于为什么会发生这种情况的答案。我将不胜感激。

因此，在我创建的线程中，我需要回发到主线程，以根据服务器连接发生的情况更新一些 TextView。好吧，因为我无法从我自己创建的线程中更新主线程，所以我需要向该线程添加一个 Handler 对象以更新 UI。完全删除该处理程序使我的应用程序能够成功创建 ServerSocket 而不会引发异常。

处理程序是否以某种方式预先运行代码或这里发生了什么？

编码。

```
RemoteServerRunnable test = new RemoteServerRunnable();
Handler handler = new Handler();
handler.post(test);
test.start(); 
```

# jquery - jquery 值用户名和电子邮件区分

> ID：12884013
> 
> 赞同：-1
> 
> 时间：2012-10-14T16:08:03.453
> 
> 标签：jquery, string

我正在制作一个表格，我需要用户名与电子邮件地址完全不同。下面的例子：

电子邮件：leonsmitthes@hotmail.com 用户名：leonsmitthes 上述内容不应通过，因此用户必须输入完全不同的用户名，如本泽马或有人可以帮忙吗？ps 一个足够简单的 jquery 代码，因为我是新手。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:11:30.483

只需检查一下

```
email.indexOf(username) == -1 
```

这将检查电子邮件字符串中的用户名

# backbone.js - Backbone.Marionette 1.0.0-beta1 的事件处理发生了什么变化？

> ID：12884020
> 
> 赞同：1
> 
> 时间：2012-10-14T16:08:43.200
> 
> 标签：backbone.js, marionette, backbone-events

我刚刚在我现有的项目中尝试了新的 Marionette 1.0.0-beta。在摆弄了几个小时之后，我必须说改变的事件处理让我感到困惑。

*   事件似乎火了两倍。可能是新的 triggerMethod() 调用的工件？
*   CollectionViews 中的事件冒泡似乎不适用于“item:rendered”等标准事件。那些在 ItemViews 内触发，但不是父 CollectionView。这是故意的吗？
*   不同的事件处理方法是用来做什么的？EventAggregator、EventBinder、Wreqr、本机主干事件……？

太好了，如果你能把事情弄清楚。如果您可以将现有文档标记为适用于 Marionette 的哪些版本，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T21:18:22.270

Regarding the event bubbling in CollectionViews, there is a [pull request](https://github.com/marionettejs/backbone.marionette/pull/281) to fix this as it is a bug

# oracle - 表为空时更新记录 - CF 挂起

> ID：12884022
> 
> 赞同：0
> 
> 时间：2012-10-14T16:08:56.103
> 
> 标签：oracle, coldfusion, oracle10g, sql-update, coldfusion-9

昨天我遇到了一些事情，我花了一段时间才弄清楚。在此代码中，当正在更新的表中不存在任何记录时，服务器会挂起，并且不会给出超时错误或任何错误。使用第二个表中的记录，代码可以正常工作。

```
<cfquery name="getSomething">
    SELECT one, two
    FROM some_table
    WHERE conditions = 'my conditions'
</cfquery>
<cfloop query="getSomething">
    <cfquery name="updateSomethingElse">
        UPDATE other_table
        SET three = 'my value'
        WHERE four = #getSomething.one#
        AND five = #getSomething.two#
    </cfquery>
    <!--- always run an insert --->
    <cfquery name="insertSomething">
        INSERT INTO other_table
        (columns)
        VALUES
        (values)
    </cfquery>
</cfloop> 
```

我认为这是一个 CF 问题，因为在 Toad 中运行更新查询会在没有记录时完成人们所期望的 - 什么都没有。

我通过首先运行查询以获取第二个表中的记录计数来修复它，并且仅在记录计数大于 0 时才运行更新查询。

这是使用带有修补程序的 Oracle 10、CF 9.02。

注：select查询返回2K/20K记录之间；当第二个表中有现有记录时，更新和插入查询都可以正确运行；删除更新查询允许插入查询运行，而不管第二个表中是否有记录。

编辑：我将探索将更新和插入查询移出循环，如下所示。我仍然认为最初的问题（为什么服务器在第二个表中没有记录的情况下挂起）尚未得到回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:36:28.480

如果没有返回记录，服务器将不会挂在 UPDATE 上，因为它永远不会到达 UPDATE 语句。我建议在没有返回记录时删除您的 UPDATE 查询并在循环中仅输出“记录”。服务器应该仍然挂起，所以你可以排除你的 UPDATE 是问题

但是，为什么不添加记录检查呢？

```
<cfquery name="getSomething">
SELECT one, two
FROM some_table
WHERE conditions = 'my conditions'
</cfquery>

<cfloop query="getSomething">
 <cfif getSomething.RecordCount>
  <cfquery name="updateSomethingElse">
  UPDATE other_table
  SET three = 'my value'
  WHERE conditions = 'other conditions'
  </cfquery>
 </cfif>
 <cfquery>
 INSERT
 </cfquery>
</cfloop> 
```

我还建议使用将两个表连接在一起的 UPDATE 语句。如果您使用 12,000 次更新来访问您的数据库，这可能需要至少十分钟，而运行下面的代码将花费更少的时间。

```
<cfquery name="updateSomethingElse">
UPDATE other_table
SET three = 'my value'
FROM some_table, other_table
WHERE some_table.id = other_table.id
AND some_table.conditions = 'my conditions'
AND other_table.conditions = 'other conditions'
</cfquery>
<cfquery name="getSomething">
INSERT INTO other_table (one, two)
SELECT one, two
FROM some_table
WHERE conditions = 'my conditions'
</cfquery> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:48:24.880

至于为什么挂起，是对数据库进行调用还是在评估第二个查询时挂起[我猜你的意思是第二个表是空的]。我似乎记得像这样的问题，我只能使用您注意到的相同方法来解决，但是 - 第二个 cfquery 并不是绝对必要的，因为您可以使用子选择并在选择时更新。如果您在更新中的条件是从第一个查询生成的，则可能会创建一个笛卡尔积，从而导致运行时间过长的查询（取决于您的超时设置实际上不会超时）。

我会对完整查询感兴趣，因为另一种方法是消除循环的必要性，让数据库做数据库所做的事情。Oracle 允许基于 select 进行更新，因此您将拥有：

```
UPDATE other_table OT
SET OT.three = ( SELECT one 
                 FROM some_table ST
                 INNER JOIN OT
                      ON OT.whatever = ST.stuff
                 WHERE conditions = 'conditions')
WHERE other_conditions = 'other conditions' 
```

鉴于您已明确声明您需要能够从初始表中进行选择，然后进行更新或删除，因此您可以使用合并命令，合并的操作实际上是插入或更新（有时称为 upsert）。Wikipedia 链接实际上非常清楚如何构建语法。

[http://en.wikipedia.org/wiki/Merge_(SQL](http://en.wikipedia.org/wiki/Merge_(SQL) )

# ruby-on-rails - 给定一个 Facebook 页面 URL，在 Rails 中保存为 ID

> ID：12884024
> 
> 赞同：0
> 
> 时间：2012-10-14T16:08:58.353
> 
> 标签：ruby-on-rails, facebook-graph-api, twitter

tl;dr：在 Rails 中，采用一种输入形式（在本例中为 URL）并在保存之前将其转换为其他形式（在本例中为使用其图形 API 的 Facebook ID）的推荐方法是什么？

我正在创建一个（非常简单的）网站来跟踪一些 Facebook 和 Twitter 帐户。在这两种情况下，我都希望用户在表单中输入 URL，但为了保持一致性和面向未来，我想在保存到数据库之前将该 URL 转换为（Facebook 或 Twitter）ID。

我对 Rails 的体验非常有限（刚刚完成 Michael Hartl 的 RailsTutorial），而且我不确定如何设置我的表单以在保存之前对输入执行一些操作。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T22:04:41.267

常见的模式是在 before_save 回调中进行（参见[http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)）。但是，由于这些操作有时需要非常显着的时间，因此最好使用 DelayedJob、Resque、Sidekiq 或至少使用 girl_friday 在后台进行。作业的排队仍然可以进入 before_save 回调。你可能想在那里检查 id 是否已知，所以它不需要再次获取它。

# objective-c - 如何正确使用 NSUserDefaults 类绕过视图？

> ID：12884025
> 
> 赞同：0
> 
> 时间：2012-10-14T16:08:58.963
> 
> 标签：objective-c, ios, xcode

我在 xcode 中有一个使用情节提要的项目。加载的第一个视图是“接受条款和条件”视图，其中用户必须单击接受按钮才能继续。单击它后，它会转到下一个视图。在程序第一次启动时用户单击接受后，我不再希望他们再次看到该视图 - 我希望它直接进入下一个视图。我有一些代码，但它不工作。这就是我所拥有的：

在应用程序委托中：（在 applicationDidFinishLaunchingWithOptions 内）

```
if([[NSUserDefaults standardUserDefaults] boolForKey:@"TermsAccepted"]!=YES)
{
    [[NSUserDefaults standardUserDefaults] setBool:NO forKey:@"TermsAccepted"];
} 
```

内部接受条款和条件视图实现：（viewDidLoad）

```
 if ([[NSUserDefaults standardUserDefaults] boolForKey:@"TermsAccepted"]){
    [self.navigationController pushViewController: self animated:YES];
    //I want it to go to the next screen
}
    else {
        //I want to show this screen, but I don't know what goes here
} 
```

同样在接受条款和条件视图实现中（在接受按钮中）

```
 - (IBAction)acceptButton:(id)sender {
 [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"TermsAccepted"];
} 
```

我运行它并得到错误：'不支持多次推送同一个视图控制器实例'。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:24:21.803

1.  在您的第一个代码片段中，您基本上说“如果 TermsAccepted 不是 YES（所以它是 NO），则将其设置为 NO。这没有意义
2.  在您的第二个代码片段中，您编写了`[self.navigationController pushViewController:self animated:YES];`. 所以基本上你要求 current `UIViewController`( `self`) 把自己推到它自己的 navigationController 上……这也没有意义。

这就是为什么你有这个错误。您尝试推送当前的 viewController `self`，而它已经在您的 navigationController 的屏幕上。所以你尝试在`self`同一个 navigationController 上推送同一个实例 ( ) 两次。

You obviously meant to push another viewController (probably an instance of a `TermsAndConditionViewController` or something that shows the terms and conditions of your app) on the navigation controller, and not the current viewController itself, which doesn't make sense.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T20:46:14.160

First, you want to have the next view controller, the one you always want to show, be the root view controller of your window. In that controller's viewDidLoad method, put your if clause to show the accept terms and conditions controller -- you can show that one using presentModalViewController. The if clase can be like this:

```
If([[NSUserDefaults standardUserDefaults] BoolForKey:@"TermsAccepted"] !=YES) {
    // instantiate your terms and conditions controller here
    // present the controller
} 
```

Then, in the method where you dismiss the terms and conditions controller, set the value of that key to YES.

# ipad - 如何将网站设置为在 ipad 中不旋转

> ID：12884030
> 
> 赞同：0
> 
> 时间：2012-10-14T16:09:46.350
> 
> 标签：ipad, web, rotation

我有一个简单的问题......我已经用谷歌搜索了它，但没有发现任何可以帮助我的东西。我有一个正在创建的网站，我不希望它在 ipad 中旋转。有没有办法做到这一点？我只是希望它保持水平。提前感谢您对此问题的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:23:37.973

我不认为会有，轮换基于 iPad 的 iOS。也许通知用户打开旋转锁？

# mysql - 使用多个连接和求和函数进行查询，给出错误的总数或总和

> ID：12884035
> 
> 赞同：3
> 
> 时间：2012-10-14T16:10:13.617
> 
> 标签：mysql, join, sum

已发布查询检索所有相关字段，但**`SUM(af_py_commission)`**导致问题的函数如 in 并且它只是在末尾添加一个额外的零，然后在右端添加一个额外的零。

例如，如果答案是 45，它将给出 450，并且该字段的数据格式是浮点数，否则此查询工作完美....

我在同一个字段上尝试了一个具有相同功能但没有连接的简单查询，因此它工作正常并给出正确的答案。谁能帮助我在这方面做错了什么>？

```
SELECT f.af_id AS af_if
   , aff_cust_tbl.af_id AS cu_af_id
   , aff_payment_tbl.af_cust_id AS pym_cus_id
   , SUM(af_py_commission)
FROM aff_tbl AS f
INNER JOIN aff_tbl ON f.af_id = 2
INNER JOIN aff_cust_tbl ON aff_cust_tbl.af_id = 2
INNER JOIN aff_payment_tbl ON aff_payment_tbl.af_id = 2; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:21:30.773

内连接有错误

尝试这个：

```
SELECT
f.af_id                    AS af_if,
aff_cust_tbl.af_id         AS cu_af_id,
aff_payment_tbl.af_cust_id AS pym_cus_id,
SUM(af_py_commission)
FROM aff_tbl AS f
INNER JOIN aff_tbl as f2
ON f.af_id = 2 AND f2.af_id=2
INNER JOIN aff_cust_tbl
ON aff_cust_tbl.af_id = 2
INNER JOIN aff_payment_tbl
ON aff_payment_tbl.af_id = 2; 
```

编辑的行是

```
 INNER JOIN aff_tbl as f2
 ON f.af_id = 2 AND f2.af_id=2 
```

尝试这个：

```
SELECT f.af_id                    AS af_if, 
       aff_cust_tbl.af_id         AS cu_af_id, 
       aff_payment_tbl.af_cust_id AS pym_cus_id, 
       Sum(af_py_commission) 
FROM   aff_tbl AS f 
       INNER JOIN aff_cust_tbl 
               ON f.af_id = aff_cust_tbl.af_id 
       INNER JOIN aff_payment_tbl 
               ON aff_payment_tbl.af_id = aff_cust_tbl.af_id 
WHERE  f.af_id = 2; 
```

如果它没有给出正确的结果，请尝试在此处不进行总和和后分析...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:21:15.183

`GROUP BY`如果使用聚合函数，您可能会错过所需的子句。尝试这个：

```
SELECT
f.af_id                    AS af_if,
aff_cust_tbl.af_id         AS cu_af_id,
aff_payment_tbl.af_cust_id AS pym_cus_id,
SUM(af_py_commission)
FROM aff_tbl AS f
INNER JOIN aff_tbl
ON f.af_id = 2
INNER JOIN aff_cust_tbl
ON aff_cust_tbl.af_id = 2
INNER JOIN aff_payment_tbl
ON aff_payment_tbl.af_id = 2;
GROUP BY f.af_id 
```

# apache-flex - 如何根据选定的数组集合推送视图？（Flash Builder 4.6，Flex）

> ID：12884041
> 
> 赞同：0
> 
> 时间：2012-10-14T16:11:08.963
> 
> 标签：apache-flex, list, pushviewcontroller, flash-builder, arraycollection

我有一个具有计算器名称数组集合的应用程序。选择后，我想为该项目推送计算器的实际视图。

这是我的代码，有人可以帮我编写一个允许我这样做的函数吗？

```
<?xml version="1.0" encoding="utf-8"?>
    <s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
title="iCalculate"
xmlns:s="library://ns.adobe.com/flex/spark"
xmlns:mx="library://ns.adobe.com/flex/mx"
creationComplete="creationCompleted(event)"
width="100%" height="100%">

       <s:layout>   
    <s:VerticalLayout paddingTop="10"/>
   </s:layout>
<fx:Script>
    <![CDATA[
        import com.Watts.collections.filter.Evaluator;
        import com.Watts.demo.Album;

        import mx.collections.ArrayCollection;
        import mx.events.CollectionEvent;
        import mx.events.FlexEvent;
        import mx.rpc.http.Operation;

        import spark.components.Image;
        import spark.components.ViewMenu;
        import spark.components.gridClasses.GridColumn;
        import spark.events.IndexChangeEvent;
        import spark.events.TextOperationEvent;

// Everything Below this line holds information specifically relating to Beta 2

// Below this line is the coding for the search bar or filter bar 
        private var _collection:ArrayCollection;
        private var _evaluator:Evaluator = new Evaluator();

        private function creationCompleted(event:FlexEvent):void
        {
            _collection = Album.collection;
            _collection.filterFunction = filterCollection;

            _evaluator.synonyms["four"] = new ArrayCollection(["4"]);

            grid.dataProvider = _collection;
        }

        private function filterChanged(event:Event):void
        {
            update();

        }

        private function update():void
        {
            _evaluator.prepare(filter.text);
            _collection.refresh();

            formula.text = (_evaluator.tree) ?                              _evaluator.tree.toString() : "";

        }

        private function filterCollection(data:Object):Boolean
        {
            var labels:ArrayCollection = new ArrayCollection();
            for (var i:int; i < grid.columns.length; i++)
            {
                labels.addItem((grid.columns.getItemAt(i) as GridColumn).itemToLabel(data));
            }   
            return _evaluator.evaluate(labels);
        }

    ]]>
</fx:Script>

    <s:VGroup left="5" right="-9" top="5" bottom="5" width="100%" height="100%" textAlign="center">
    <s:TextInput id="filter" width="100%" change="filterChanged(event)"/>
    <s:DataGrid id="grid" width="100%" height="100%" textAlign="left">
    </s:DataGrid>
    <s:Label id="formula" />
    </s:VGroup>
    <s:Label id="lblWattsMessage" click="navigator.pushView(views.CompanyDetail)" color="#1021C7"
         fontFamily="_typewriter" fontSize="12" text="Powered by WATTS Professionals"
         textAlign="center" verticalAlign="middle"/>

</s:View> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T06:54:51.437

这是我用来解决此问题的代码。在 flex 应用程序中有一个可以使用的 navigator.pushView 组件。我遇到的问题是我没有为每个计算器分配视图 ID。这必须在 ArrayCollection 容器中完成。

navigator.pushview( *ViewID* )

# asp.net-mvc-4 - MultipartFormDataStreamProvider 上传 mime 文件和表单数据

> ID：12884042
> 
> 赞同：4
> 
> 时间：2012-10-14T16:11:16.387
> 
> 标签：asp.net-mvc-4

使用 RTM 版本，由于 Azure 要求代码，Framework 4 在 Azure 模拟器上正常工作 - 我怀疑问题与路径/环境变量有关。Azure Web 角色失败并出现 404 错误

这是控制器代码：

```
 [ValidateInput(false)]
  public HttpResponseMessage Post()
  {
      try
      {
          if (!Request.Content.IsMimeMultipartContent("form-data"))
          {
              throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
          }
          string tempPath = RoleEnvironment.GetLocalResource("tempStorage").RootPath;
          Environment.SetEnvironmentVariable("TEMP", tempPath);
          Environment.SetEnvironmentVariable("TMP", tempPath);

          string Host = "test";
          string StorageConnection = "credentials here";
          string Product = "Product";
          string CompanyID = "Company";
          DocStorage docStorage = new DocStorage(Host, Product, CompanyID, StorageConnection);
          var multipartStreamProvider = new AzureBlobStorageMultipartProvider(docStorage.BlobContainer, tempPath);
          Stream reqStream = Request.Content.ReadAsStreamAsync().Result;
          if (reqStream.CanSeek)
          {
              reqStream.Position = 0;
          }

          Request.Content.ReadAsMultipartAsync<AzureBlobStorageMultipartProvider>(multipartStreamProvider).ContinueWith<List<FileDetails>>(t =>
          {
              if (t.IsFaulted)
              {
                  throw t.Exception;
              }
              AzureBlobStorageMultipartProvider provider = t.Result;

              foreach (var fileData in provider.FileData)
              {
                  string fileName = Path.GetFileName(fileData.Headers.ContentDisposition.FileName.Trim('"'));
                  string fileNameBlob = Path.GetFileName(fileData.LocalFileName.Trim('"'));
                  CloudBlob blob = docStorage.BlobContainer.GetBlobReference(fileNameBlob);

                     if (!string.IsNullOrEmpty(provider.FormData["company"])) 
                        blob.Metadata[AriettDocStorage.FileNameFileLocation] = provider.FormData["company"];
                  blob.SetMetadata();
              }
              return provider.Files;
          });
          return new HttpResponseMessage(HttpStatusCode.OK);
      }
      catch
      {
          return new HttpResponseMessage(HttpStatusCode.NotFound);
      }
  } 
```

这是覆盖

```
public class AzureBlobStorageMultipartProvider : MultipartFormDataStreamProvider
{
    public CloudBlobContainer Container;
    public AzureBlobStorageMultipartProvider(CloudBlobContainer container, string tempPath)
        : base(tempPath)
    {
        Container = container;
    }
    public override Task ExecutePostProcessingAsync()
    {
        // Upload the files to azure blob storage and remove them from local disk 
        foreach (var fileData in this.FileData)
        {
            string fileName = Path.GetFileName(fileData.Headers.ContentDisposition.FileName.Trim('"'));

            // Retrieve reference to a blob 
            string fileNameBlob = Path.GetFileName(fileData.LocalFileName.Trim('"'));

            CloudBlob blob = Container.GetBlobReference(fileNameBlob);
            blob.Properties.ContentType = fileData.Headers.ContentType.MediaType;
            blob.UploadFile(fileData.LocalFileName);
            blob.SetProperties();
            File.Delete(fileData.LocalFileName);
            Files.Add(new FileDetails
            {
                ContentType = blob.Properties.ContentType,
                Name = blob.Name,
                Size = blob.Properties.Length,
                Location = blob.Uri.AbsoluteUri
            });
        }

        return base.ExecutePostProcessingAsync();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T19:07:18.423

我解决了这个问题，它是一些与路径无关的小事情，它已正确完成。

# html - 使用 div 在块中显示复选框

> ID：12884046
> 
> 赞同：2
> 
> 时间：2012-10-14T16:11:35.133
> 
> 标签：html, css, checkbox

我正在尝试在一个块中显示复选框，如下所示。

```
<div style="overflow: auto; width: 145px; background-color: #FFF; height: 80px; border: 1px double #336699; padding-left: 2px;">
    <label for="chk1"><input type="checkbox" id="chk1" name="chk_param">xxxx</label><br/>
    <label for="chk2"><input type="checkbox" id="chk2" name="chk_param">aaaa</label><br/>
    <label for="chk3"><input type="checkbox" id="chk3" name="chk_param">aaaa</label><br/>
    <label for="chk4"><input type="checkbox" id="chk4" name="chk_param">aaaa</label><br/>
    <label for="chk5"><input type="checkbox" id="chk5" name="chk_param">aaaa</label><br/>
    <label for="chk6"><input type="checkbox" id="chk6" name="chk_param">aaaa</label><br/>
    <label for="chk7"><input type="checkbox" id="chk7" name="chk_param">aaaa</label><br/>
    <label for="chk8"><input type="checkbox" id="chk8" name="chk_param">aaaa</label><br/>
</div> 
```

它会显示预期的内容，如以下[快照](https://i.stack.imgur.com/TGbZc.png)所示。

![在此处输入图像描述](../Images/11c13b1eb98219fc2d5be985ed4b82b2.png)

当任何一个（或多个）复选框标签长于指定宽度时，会出现一个水平滚动条，这是预期的，但它会在复选框下方显示*复选框标签文本*，如下面的[快照](https://i.stack.imgur.com/DulSl.png)所示。

![在此处输入图像描述](../Images/277920d2d835b24418e6923d687cf4b8.png)

在这种情况下，一个（或多个）复选框标签非常长，如下所示。

```
<label for="chk1">
  <input type="checkbox" id="chk1" name="chk_param">xxxxxxxxxxxxxxxxxxxxxxxxxxxx
</label><br/> 
```

解决方案是什么？无论标签文本有多长，每个带有标签的复选框都应**在块内**以直线显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:14:33.350

`white-space: nowrap;`使用像[**My Fiddle**](http://jsfiddle.net/wZNtm/)这样的CSS 属性[](http://jsfiddle.net/wZNtm/)

 **预览

![在此处输入图像描述](../Images/aec8992c48532f86693d784a1a9afd88.png)

HTML

```
<div style="overflow: auto; width: 145px; background-color: #FFF; height: 80px; border: 1px double #336699; padding-left: 2px;">
    <label for="chk1"><input type="checkbox" id="chk1" name="chk_param">xxxxxxxxxxxxxxxxxxxxxxxxxx</label><br/>
    <label for="chk2"><input type="checkbox" id="chk2" name="chk_param">aaaa</label><br/>
    <label for="chk3"><input type="checkbox" id="chk3" name="chk_param">aaaa</label><br/>
    <label for="chk4"><input type="checkbox" id="chk4" name="chk_param">aaaa</label><br/>
    <label for="chk5"><input type="checkbox" id="chk5" name="chk_param">aaaa</label><br/>
    <label for="chk6"><input type="checkbox" id="chk6" name="chk_param">aaaa</label><br/>
    <label for="chk7"><input type="checkbox" id="chk7" name="chk_param">aaaa</label><br/>
    <label for="chk8"><input type="checkbox" id="chk8" name="chk_param">aaaa</label><br/>
</div>​ 
```

CSS

```
label {
   white-space:nowrap;
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:16:28.590

您可以将这 5 个 css 属性添加到标签中：

```
label {
    display: inline-block;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    width: 100%;
} 
```

[http://jsfiddle.net/USDKK/](http://jsfiddle.net/USdKK/)

![截屏](../Images/2d97269db6370b78c9c25ee2ad838cb9.png)**

# java - ajax请求时ui：repeat的值方法（带参数）不起作用吗？

> ID：12884049
> 
> 赞同：0
> 
> 时间：2012-10-14T16:11:54.617
> 
> 标签：java, jsf-2

第一次`mypage.xhtml`加载时，`#{DashBoard.getResvDataModelList(date, meetingRoom)}`工作良好。当 ajax 请求时 ， `h:commandLink`实例为空。这就是为什么，我进入我的方法。`date``meetingRoom``NullPointerException``getResvDataModelList(Date date, MeetingRoom meetingRoom)`

我怎么解决这个问题？`page parameter`我的情况是我必须`ui:repeat`使用价值方法。你能提供另一种解决方案吗？

* * *

如果我删除`<ui:repeat value="#{DashBoard.getResvDataModelList(date, meetingRoom)}" var="model" >`，我的页面可以很好地处理 ajax 请求。

* * *

原因 ：

```
Caused by: javax.faces.el.EvaluationException: java.lang.NullPointerException
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102) [jboss-jsf-api_2.1_spec-2.0.5.Final.jar:2.0.5.Final]
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102) [jsf-impl-2.1.7-jbossorg-2.jar:]
    ... 38 more 
```

我的方法

```
public List<ResvDataModel> getResvDataModelList(Date date, MeetingRoom meetingRoom) {
    logger.debug("getResvDataModelList() ====> " + formatter.format(date) + " : " + meetingRoom.getName());
} 
```

我的页面.xhtml

```
<h:commandLink action="#{DashBoard.increase()}" value="NextWeek" immediate="true" >
    <f:ajax execute="@this" render="dashboard" />
</h:commandLink>

<h:panelGroup id="dashboard">
    <table style="margin-top:-1px;" class="dashboard">
        <ui:repeat value="#{DashBoard.dateList}" var="date">
            <tr>
                <td style="background:#DBEAF9;">
                    <h:outputText value="#{date}" style="color:#333333;font-size:13px;">
                        <f:convertDateTime type="date" pattern="EEE, yyyy-MM-dd"/>
                    </h:outputText>
                </td>
                <ui:repeat value="#{DashBoard.timeSlot}" var="timeSlot" >
                    <td style="background:#DBEAF9;text-align: center;width:70px;">
                        <h:outputText value="#{timeSlot}" style="font-size:12px;"/>
                    </td>
                </ui:repeat>
            </tr>
            <ui:repeat value="#{DashBoard.resourceList}" var="meetingRoom">
                <tr>
                    <td>
                        <h:outputText value="#{meetingRoom.name}" style="font-size:12px;"/>
                    </td>
                    <ui:repeat value="#{DashBoard.getResvDataModelList(date, meetingRoom)}" var="model" >
                        <td>
                            <h:outputText value="#{model.id}" style="font-size:11px;"/>
                        </td>
                    </ui:repeat>
                </tr>
            </ui:repeat>
        </ui:repeat>
    </table>
</h:panelGroup> 
```

# android - IntentService 在将数据插入 SQLite 后停止，并在第二次插入时给出 NULLPOINTER EXCEPTION

> ID：12884050
> 
> 赞同：0
> 
> 时间：2012-10-14T16:11:55.413
> 
> 标签：android, sqlite, service, intentservice

我正在开发一个应用程序，当没有移动信号的覆盖区域时，将数据保存到数据库中。当服务返回时，它将从数据库中获取所有数据并上传到服务器。

现在我有两个问题。

1.  当第一次将数据插入数据库时​​，IntentService 停止。（当网络服务返回时，它还会在服务器上上传数据，为了检查网络连接，我使用了计时器。）我不想停止服务。
2.  当我第二次启动它再次创建的服务并给出 Nullpointerexception 时。因为数据库中没有数据，所以它也给出了一些关于数据检索的其他错误。

我的代码有什么问题？我只希望当用户启动服务时它会一直运行到数据库中的最后一个数据，然后它会停止。我在 intentservice 中使用了线程，因为之前我的应用程序崩溃了。

LogCat 错误

```
10-14 20:44:02.135: E/Service(10042): Service Created.. 
10-14 20:44:02.505: E/Service Started(10042): Successful
10-14 20:44:03.585: E/Service Network(10042): Network is offline
10-14 20:44:08.656: E/Service Network(10042): Network is offline
10-14 20:44:13.616: E/Service Network(10042): Network is offline
10-14 20:44:18.646: E/Service Network(10042): Network is offline
10-14 20:44:23.595: E/Service Network(10042): Network is offline
10-14 20:44:29.526: E/Service Network(10042): Network is online
10-14 20:44:31.256: E/Data Sent(10042): Response 200
10-14 20:44:33.599: E/Service Network(10042): Network is online
10-14 20:44:34.446: E/Data Sent(10042): Response 200
10-14 20:44:38.646: E/Service Network(10042): Network is online
10-14 20:44:40.616: E/Data Sent(10042): Response 200
10-14 20:44:43.625: E/Service Network(10042): Network is offline
10-14 20:44:48.595: E/Service Network(10042): Network is offline
10-14 20:44:53.586: E/Service Network(10042): Network is offline
10-14 20:45:20.486: E/Service(10042): Service Created.. 
10-14 20:45:20.587: E/Service Started(10042): Successful
10-14 20:45:20.627: E/Insertion(10042): java.lang.NullPointerException
10-14 20:45:21.666: E/Service Network(10042): Network is offline
10-14 20:45:23.616: E/Service Network(10042): Network is offline
10-14 20:45:36.645: E/Service Network(10042): Network is offline
10-14 20:45:38.585: E/Service Network(10042): Network is offline
10-14 20:45:41.786: E/Service Network(10042): Network is online
10-14 20:45:42.026: E/AndroidRuntime(10042): FATAL EXCEPTION: Timer-1
10-14 20:45:42.026: E/AndroidRuntime(10042): java.lang.NullPointerException
10-14 20:45:42.026: E/AndroidRuntime(10042):    at com.remote.synchronizer.haris.SQLiteAdapter.getAllContacts(SQLiteAdapter.java:93)
10-14 20:45:42.026: E/AndroidRuntime(10042):    at com.remote.synchronizer.haris.OfflineDataService$1$1.run(OfflineDataService.java:80)
10-14 20:45:42.026: E/AndroidRuntime(10042):    at java.util.Timer$TimerImpl.run(Timer.java:284)
10-14 20:45:43.646: E/Service Network(10042): Network is online
10-14 20:45:44.266: E/Data Sent(10042): Response 200 
```

SQLiteAdapter.java

```
package com.remote.synchronizer.haris;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class SQLiteAdapter extends SQLiteOpenHelper {

    public static final String DATABASE_NAME = "Product";
    public static final String TABLE_NAME = "Orders";
    public static final int DATABASE_VERSION = 1;
    public static final String KEY_ID = " _id";  //
    public static final String KEY_NAME = "name";
    public static final String KEY_SHOP = "shop";
    private static final String KEY_CITY = "city";
    private static final String KEY_DATE = "datee";
    private static final String KEY_ORDER = "orderr";

    private SQLiteDatabase sqLiteDatabase;
    private SQLiteAdapter sqLiteHelper=this;

    private static final String CREATE_TABLE =
            "CREATE TABLE " + TABLE_NAME + " ("
                    + KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                    + KEY_NAME + " VARCHAR,"
                    + KEY_SHOP + " VARCHAR," + KEY_CITY + " VARCHAR, " + KEY_DATE + " VARCHAR, " + KEY_ORDER + " VARCHAR" +");";

    public SQLiteAdapter(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);  
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(CREATE_TABLE);
        sqLiteDatabase=db;
    }

    /*public void close(){
        sqLiteHelper.close();
    }
     */
    public void insert(String name, String shop, String city, String datee, String orderr){

        try
        {
            ContentValues contentValues = new ContentValues();
            contentValues.put(KEY_NAME, name);
            contentValues.put(KEY_SHOP, shop);
            contentValues.put(KEY_CITY, city);
            contentValues.put(KEY_DATE, datee);
            contentValues.put(KEY_ORDER, orderr);
            sqLiteDatabase.insertOrThrow(TABLE_NAME, KEY_ID, contentValues);
            //sqLiteDatabase.close();
        }
        catch(Exception e)
        {
            e.printStackTrace();
            Log.e("Insertion", e.toString());
        }
    }

    public void deleteAll(){
        sqLiteDatabase.delete(TABLE_NAME, null, null);
    }

    public void delete_byID(int id){
        sqLiteDatabase.delete(TABLE_NAME, KEY_ID+"="+id, null);
    }

    /*public Cursor queueAll(){
        String[] columns = new String[]{KEY_ID, KEY_NAME, KEY_SHOP, KEY_CITY,  KEY_DATE, KEY_ORDER};
        Cursor cursor = sqLiteDatabase.query(TABLE_NAME, columns, 
                null, null, null, null, null);

        return cursor;
    }*/

    public List<NameValuePair> getAllContacts() {
        List<NameValuePair> postParameters = new ArrayList<NameValuePair>();

        String selectQuery = "SELECT  * FROM " + TABLE_NAME;
        sqLiteHelper.getReadableDatabase();
        Cursor cursor = sqLiteDatabase.rawQuery(selectQuery, null);

        if(cursor.moveToFirst()){
            while(!cursor.isAfterLast())
            {
                postParameters.add(new BasicNameValuePair("User", cursor.getString(cursor.getColumnIndex(KEY_NAME))));
                postParameters.add(new BasicNameValuePair("ShopName", cursor.getString(cursor.getColumnIndex(KEY_SHOP))));
                postParameters.add(new BasicNameValuePair("city", cursor.getString(cursor.getColumnIndex(KEY_CITY))));
                postParameters.add(new BasicNameValuePair("OrderDate", cursor.getString(cursor.getColumnIndex(KEY_DATE))));
                postParameters.add(new BasicNameValuePair("OrderDetail", cursor.getString(cursor.getColumnIndex(KEY_ORDER))));
                cursor.moveToNext();
            }

        }
        //cursor.close();
        return postParameters;
    };

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(SQLiteAdapter.class.getName(),
                "Upgrading database from version " + oldVersion + " to "
                        + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + CREATE_TABLE);
        onCreate(db);
    }

} 
```

离线数据服务.java

```
package com.remote.synchronizer.haris;

import java.util.ArrayList;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;
import org.apache.http.NameValuePair;

import android.app.IntentService;
import android.content.Intent;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.os.Handler;
import android.os.HandlerThread;
import android.util.Log;

public class OfflineDataService extends IntentService {

    boolean wifi,edge;
    private Timer timer= new Timer();
    SQLiteDatabase db;
    String un,shop,city,date,order;
    private SQLiteAdapter mySQLiteAdapter;
    Cursor cursor;

    public OfflineDataService() {
        super("OfflineDataService");
    }

    @Override   
    public void onCreate() {

        super.onCreate();

        Log.e("Service", "Service Created.. ");

        mySQLiteAdapter = new SQLiteAdapter(this);
        mySQLiteAdapter.getWritableDatabase();

    }   

    @Override
    protected void onHandleIntent(final Intent intent) {

        final Handler threadHandler;  
        threadHandler = new Handler();

        new Thread(new Runnable(){

            @Override
            public void run() {

                Bundle bundle=intent.getExtras();
                un=bundle.getString("un");
                shop=bundle.getString("shop");
                city=bundle.getString("city");
                date=bundle.getString("date");
                order=bundle.getString("order");

                Log.e("Service Started", "Successful");

                //Inserting New Record
                mySQLiteAdapter.insert(un,shop,city,date,order);

                timer.scheduleAtFixedRate(new TimerTask(){

                    @Override
                    public void run() {

                        //Checking network connectivity
                        wifi=NetworkInfo.Wifi(OfflineDataService.this);
                        edge=NetworkInfo.EDGE(OfflineDataService.this);

                        if(wifi==true||edge==true)
                        {
                            Log.e("Service Network", "Network is online");
                            List<NameValuePair> contacts=new ArrayList<NameValuePair>();

                            contacts=mySQLiteAdapter.getAllContacts();

                            String url="http://10.0.2.2:3325/Product/Create?"; 

                            int response = 0;

                            try 
                            {
                                response = CustomHttpClient.executeHttpPost(url, contacts);

                                if(response==200)
                                {
                                    Log.e("Data Sent", "Response 200");
                                }

                                else{

                                    Log.e("Service Data", "Faield to upload data" );
                                }

                            }
                            catch (Exception e)
                            {
                                Log.e("Data Sending", e.toString());
                                e.printStackTrace();
                            }
                        }
                        else
                        {
                            Log.e("Service Network", "Network is offline");
                        }
                    }

                }, 1000, 5000);

            }

        }).start();
    }

    /*@Override
    public void onDestroy() {

        super.onDestroy();
      //  mySQLiteAdapter.deleteAll();
        Log.e("Service Destroy", "Successful");

    }*/
} 
```

我需要使用 onStartCommand 而不是 onHandleIntent 还是需要使用 service 而不是 IntentService 来控制它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:46:33.357

这可能是问题所在，我看不到您将可读数据库保存在哪里...更改此：

```
sqLiteHelper.getReadableDatabase();
Cursor cursor = sqLiteDatabase.rawQuery(selectQuery, null); 
```

对此：

```
if(sqLiteDatabase == null || !sqLiteDatabase.isOpen()) {
    sqLiteDatabase = sqLiteHelper.getReadableDatabase();
}
Cursor cursor = sqLiteDatabase.rawQuery(selectQuery, null); 
```

* * *

**添加**

对于 SQLiteOpenHelper，`onCreate()`仅在创建*新数据库**时才*调用，而不仅仅是打开现有数据库...将构造函数更改为：

 *```
public SQLiteAdapter(Context context) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);  
    sqLiteDatabase = this.getWritableDatabase();
} 
```

`sqLiteDatabase=db`（并从中删除`onCreate()`）

另外，我忘记了这是一个两部分的问题。IntentServices 不是为无限期运行而设计的，您应该使用 Service 来代替（或切换到使用 ContentProvider）。*

# c# - 如何将列表项添加到 RichTextBox？

> ID：12884052
> 
> 赞同：1
> 
> 时间：2012-10-14T16:12:18.143
> 
> 标签：c#

我正在尝试的代码不起作用：

```
private void clearRichtextBox()
        {
            richTextBox2.Clear();
            foreach (KeyValuePair<string, List<string>> kvp in LocalyKeyWords)
            {
                richTextBox2.AppendText("Url: " + kvp.Key + " --- " + "Localy KeyWord: " + kvp.Value);
            }

        } 
```

LocalyKeyWords 是一个 List > 类型的 Dictionary。其中字符串是键，列表是值。

[例如， http://www.google.com](http://www.google.com)是键，而 google 是值。

现在在这种情况下，LocalyKeywords 包含 3 个索引，每个索引都有一个 Key 和一个 Value。我希望在清除richTextBox2 后，以如下格式将所有键和值从列表中添加到richTextBox：

```
Url: http://www.google.com --- Localy Keyword: google
Url: http://www.cnet.com --- Localy Keyword: cnet
Url: http://www.microsoft.com --- Localy Keyword: microsoft 
```

但我没有像我那样做。

我该怎么做 ？foreach 出了点问题，我更喜欢用 FOR 而不是 foreach。

该列表构建为 Key,Value 在我的硬盘 fhr 格式的文本文件中是这样的：

```
http://www.cnet.com,cnet 
```

然后在构造函数中，我从文本文件中读取它并将键和值放回列表中，如下所示：

```
private void richTextBoxLoadKeys(Dictionary<string, List<string>> dictionary, string FileName)
        {
            string line = System.String.Empty;
            using (StreamReader sr = new StreamReader(keywords))
            {
                while ((line = sr.ReadLine()) != null)
                {
                    string[] tokens = line.Split(',');
                    dictionary.Add(tokens[0], tokens.Skip(1).ToList());
                    richTextBox2.AppendText("Url: " + tokens[0] + " --- " + "Localy KeyWord: " + tokens[1]);
                }
                sr.Close();
            }
        } 
```

在构造函数中加载键和值并在列表上使用断点后，我看到：

![在此处输入图像描述](../Images/c60e4d040bae022c1a75c94912ac7f39.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:10:01.727

您应该遍历 kvp.Value，它也是一个列表，因此您必须将列表中的每个项目添加到 Richtextbox 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:09:13.697

您需要遍历 Value 中的字符串，或者只报告 Value 中的第一个字符串。你得到的是一个列表的 ToString() 。我很好奇您是否真的需要一个 List 作为值，因为您的示例每个键只有一个本地关键字。也许您应该改为创建字典。

# c# - 如何只在应用程序中保留一个窗口？

> ID：12884053
> 
> 赞同：1
> 
> 时间：2012-10-14T16:12:22.163
> 
> 标签：c#, .net, wpf, window, mdi

我正在编写一个 WPF 应用程序，它有一个主画布区域，用户可以在其中打开多个窗口，拖放它们，并且通常在应用程序中随意移动它们。

到目前为止，我所做的基本上是使用该`Show()`方法打开窗口，并且我已将它们从任务栏中隐藏。但是，当主应用程序最小化时，已经打开的小窗口都出现在桌面上。我所寻找的基本上是一种将窗口包含在应用程序中的方法。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:25:51.007

是的，但您需要设计一些基础设施来取代 MDI 过去所做的事情（尽管通常很糟糕）

因此，当您在应用程序中打开一个新窗口时，请将其添加到列表中。当它关闭时，将其取出当您的主应用程序最小化时，将列表中的所有窗口也最小化。

您还可以捕获子窗口移动事件并将它们保持在界限内，当主应用程序移动时带上孩子。对接、级联、平铺……

关键点它以获取此托管子窗口列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:15:55.890

您要做的就是称为[MDI](http://www.c-sharpcorner.com/UploadFile/ggaganesh/DevelopingMDIAppplicationsinCSharp11272005225843PM/DevelopingMDIAppplicationsinCSharp.aspx)。

[WPF MDI](http://wpfmdi.codeplex.com/)

# servlets - 通过浏览器访问时不会反映对 tomcat 页面的任何更新

> ID：12884056
> 
> 赞同：0
> 
> 时间：2012-10-14T16:12:47.580
> 
> 标签：servlets, tomcat7

> **可能重复：**
> [如何停用 jsp 页面内的缓存](https://stackoverflow.com/questions/161937/howto-deactivate-caching-inside-a-jsp-page)

今天开始学习servlet，遇到了一个奇怪的问题。无论我对文件进行什么更改，当我访问 Firefox 上的页面时，都不会反映该更改。我什至删除了有问题的页面，但我仍然可以看到它。

我尝试重新启动tomcat，但这没有用。同样奇怪的是我无法`localhost:8080`在任何其他浏览器上访问。

任何进一步的信息，你所要做的就是询问。

* * *

### 编辑：

重新启动计算机后，更改开始得到答复。然后我写了一个servlet，编译它并映射它。但是当我尝试加载它时，它只是进入了一个无限循环。然后我就无法访问服务器上的任何页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T01:49:28.500

好吧，我想答案是这样的。我删除了与 tomcat7 相关的所有内容并重新安装了它。这使一切正常。我想我可能对我拥有的不同tomcat有安装冲突。

感谢大家的帮助。

# objective-c - 如何在ios开发中从mp3文件中提取元数据

> ID：12884067
> 
> 赞同：7
> 
> 时间：2012-10-14T16:13:42.807
> 
> 标签：objective-c, ios, metadata, avasset, avmetadataitem

我正在开发带有云存储的 ios 音乐播放器。

我需要提取音乐信息，如标题、艺术家、艺术品。

我有一个名为 playit 的动作，它可以播放和暂停 mp3 文件。它还应该使用与 mp3 文件关联的元数据填充一些 UILables 和 UIImage。问题是我无法从超过 25 个不同的 mp3 文件中提取元数据。这是我的代码：

文件 url 是正确的，因为音频播放器能够找到并播放它，但我不知道为什么 avmetadataitem 无法获取元数据。

```
- (IBAction)playIt:(id)sender {
AVAudioPlayer *audioPlayer;
AVAsset *assest;

NSString * applicationPath = [[NSBundle mainBundle] resourcePath]; 
NSString *secondParentPath = [applicationPath stringByDeletingLastPathComponent];
NSString *soundFilePath = [[secondParentPath stringByAppendingPathComponent:@"fisal1407"] stringByAppendingPathComponent:[musicFiles objectForKey:@"show_id"] ];

NSURL *fileURL = [NSURL URLWithString:[soundFilePath stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding]];

assest = [AVURLAsset URLAssetWithURL:fileURL options:nil];
NSArray *metadata = [assest commonMetadata];
for (NSString *format in metadata) {
    for (AVMetadataItem *item in [assest metadataForFormat:format]) {
        if ([[item commonKey] isEqualToString:@"title"]) {
            filename.text = (NSString *)[item value];
            NSLog(@" title : %@", (NSString *)[item value]);
        } 
        if ([[item commonKey] isEqualToString:@"artist"]) {
            show_id.text = (NSString *)[item value];
        }
        if ([[item commonKey] isEqualToString:@"albumName"]) {
          //  _albumName = (NSString *)[item value];
        }
        if ([[item commonKey] isEqualToString:@"artwork"]) {
            NSData *data = [(NSDictionary *)[item value] objectForKey:@"data"];
            UIImage *img = [UIImage imageWithData:data]  ;
            imageView.image = img;
            continue;
         }
    }
 }

   if (audioPlayer == nil) {

    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:fileURL error:&error];
    audioPlayer.numberOfLoops = -1;

   [audioPlayer play];
    [sender setImage:[UIImage imageNamed:@"player_044.gif"] forState:UIControlStateNormal];
   }
else
   {
    if (audioPlayer.isPlaying)
    {
        [sender setImage:[UIImage imageNamed:@"player_04.gif"] forState:UIControlStateNormal];
        [audioPlayer pause];
    } else {
        [sender setImage:[UIImage imageNamed:@"player_044.gif"] forState:UIControlStateNormal];
        [audioPlayer play];
    }
 }  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T09:59:02.710

尝试

```
for (NSString *format in [asset availableMetadataFormats]) 
```

代替

```
NSArray *metadata = [assest commonMetadata];
for (NSString *format in metadata) { 
```

# php - 如何确保字符串包含有效/格式正确的 url？

> ID：12884068
> 
> 赞同：0
> 
> 时间：2012-10-14T16:13:55.053
> 
> 标签：php, validation, url

如何确保字符串包含有效/格式正确的 url？

我需要确保字符串中的 url 格式正确。

它必须包含`http://`或`https://`

和`.com`或`.org`或`.net`或`any other valid extension`

我尝试了在 SO 中找到的一些答案，但所有人都接受“www.google.com”为有效。

在我的情况下，有效的 url 需要是`http://`www.google.com 或`https://`www.google.com。

这`www.`部分不是义务，因为有些网址不使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:18:41.397

看看这里的答案： [PHP regex for url validation, filter_var is too permissive](https://stackoverflow.com/questions/3653884/php-regex-for-url-validation-filter-var-is-too-permisive)

`filter_var()`可能对您来说很好，但是如果您需要更强大的功能，则必须使用正则表达式。

此外，使用[此处](http://php.net/manual/en/function.preg-match.php)的代码，您可以分入任何适合您需要的正则表达式：

```
<?php 
    $regex = "((https?|ftp)\:\/\/)?"; // SCHEME 
    $regex .= "([a-z0-9+!*(),;?&=\$_.-]+(\:[a-z0-9+!*(),;?&=\$_.-]+)?@)?"; // User and Pass 
    $regex .= "([a-z0-9-.]*)\.([a-z]{2,3})"; // Host or IP 
    $regex .= "(\:[0-9]{2,5})?"; // Port 
    $regex .= "(\/([a-z0-9+\$_-]\.?)+)*\/?"; // Path 
    $regex .= "(\?[a-z+&\$_.-][a-z0-9;:@&%=+\/\$_.-]*)?"; // GET Query 
    $regex .= "(#[a-z_.-][a-z0-9+\$_.-]*)?"; // Anchor 
?> 

Then, the correct way to check against the regex list as follows: 

<?php 
       if(preg_match("/^$regex$/", $url)) 
       { 
               return true; 
       } 
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:18:02.320

你可以通过使用 php`filter_var`函数来做到这一点

```
$valid=filter_var($url, FILTER_VALIDATE_URL)

if($valid){
//your code
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T16:20:56.210

有一个 curl 解决方案：

```
function url_exists($url) {
    if (!$fp = curl_init($url)) return false;
    return true;
} 
```

并且有一个 fopen 解决方案（如果你没有

```
function url_exists($url) {
    $fp = @fopen('http://example.com', 'r'); // @suppresses all error messages
    if ($fp) {
        // connection was made to server at domain example.com
        fclose($fp);
        return true;
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T16:23:24.383

`filter_var($url, FILTER_VALIDATE_URL)`可以首先用于确保您正在处理有效的 URL。

然后，您可以通过假设 URL 确实对[parse_url](http://php.net/manual/en/function.parse-url.php)有效来测试更多条件：

```
$res = parse_url($url);
return ($res['scheme'] == 'http' || $ret['scheme'] == 'https') && $res['host'] != 'localhost'); 
```

# eclipse - 启动 Eclipse 时出错

> ID：12884072
> 
> 赞同：0
> 
> 时间：2012-10-14T16:15:21.477
> 
> 标签：eclipse, java-native-interface

打开 Eclipse (Juno) 时出现以下错误

```
Failed to load the JNI shared library “C:\Program Files
(x86)\Java\jdkl.6.0_11\jre\bin\client\jvmdll”. 
```

闪屏出现，上面的错误信息出现在一个对话框中，没有别的。

我还安装了 Eclipse Ganymede，它可以毫无问题地打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:18:43.570

您可能在 os、java 和 eclipse 之间有 64 位与 32 位的错误组合，如下所示：[Failed to load the JNI shared Library (JDK)](https://stackoverflow.com/questions/7352493/failed-to-load-the-jni-shared-library-jdk)

# documentation - 弹性搜索/：我如何过滤没有特定字段的文档

> ID：12884078
> 
> 赞同：0
> 
> 时间：2012-10-14T16:15:54.270
> 
> 标签：documentation, field, elasticsearch

我通过 Java API 使用 queryString "datefield:[2012-09-12T12:00:00Z TO 2012-10-12T12:00:00Z]" 进行搜索。但它的响应包含一些没有字段 datefield 的文档。如何过滤没有 datefield 的文档？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:14:12.663

我是否可以建议您构建一个[boolFilter](http://www.elasticsearch.org/guide/reference/query-dsl/bool-filter.html)，其中包含一个 must 子句，在 datefield 上包含两个日期的[范围过滤器，以及一个在 dateField 上](http://www.elasticsearch.org/guide/reference/query-dsl/range-filter.html)[缺少过滤器](http://www.elasticsearch.org/guide/reference/query-dsl/missing-filter.html)的 must_not 子句？

它有效吗？

# android - Android NewBie - setAdapter ListView 面临的问题

> ID：12884084
> 
> 赞同：2
> 
> 时间：2012-10-14T16:16:18.610
> 
> 标签：android, android-listview, android-fragments

我对 Android 完全陌生，第一次尝试使用 Fragments。我使用了我在片段中转换的 ListView 活动。但不知何故，由 findViewById() 检索到的 ListView 元素给了我 null。谁能帮我解决这个问题。？

这是 ListView Fragment 的代码，在调用 setAdapter 方法后出现错误。日志值显示 timeTrackerListView 为 null。我不知道为什么。！！:(

```
 package ray.kaushik.nasaapp;

import android.app.Fragment;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ListView;

public class TimeTracker extends Fragment{
    private Time_Tracker_Adapter timeTrackerAdapter;
    private String TAG = "TimeTracker";
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        timeTrackerAdapter = new Time_Tracker_Adapter();

    }

    public View onCreateView(LayoutInflater inflater,ViewGroup container, Bundle savedInstanceState){
            return inflater.inflate(R.layout.time__tracker_layout, container, false);
    }

    public void onActivityCreated(Bundle savedInstanceState){
        super.onActivityCreated(savedInstanceState);
        ListView timeTrackerListView = (ListView) getActivity().findViewById(R.id.time_tracker_List);
        Log.i(TAG, "timeTrackerListView-->" + timeTrackerListView);
        timeTrackerListView.setAdapter(timeTrackerAdapter);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:20:35.357

`onCreate()`之前被调用`onCreateView()`。ListView 还没有膨胀，这就是为什么你找不到它......

只需将当前`onCreate()`代码移入`onCreateView()`or `onActivityCreated()`。

* * *

`onCreateView()`通过保存对膨胀视图的引用，您应该能够轻松地设置您的 ListView ：

```
public View onCreateView(LayoutInflater inflater,ViewGroup container, Bundle savedInstanceState){
    View view = inflater.inflate(R.layout.time__tracker_layout, container, false);
    ListView timeTrackerListView = (ListView) view.findViewById(R.id.time_tracker_List);
    timeTrackerAdapter = new Time_Tracker_Adapter();
    timeTrackerListView.setAdapter(timeTrackerAdapter);
    return view;
} 
```

* * *

[开发人员指南](http://developer.android.com/guide/components/fragments.html)中的图表：

[![片段生命周期](../Images/26542533731c4baf98257afe05368029.png "我喜欢图表！")](http://developer.android.com/guide/components/fragments.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T16:23:09.207

您的问题是您试图在设置视图之前获取列表视图（`onCreate`之前调用过`onCreateView`）......您需要移动它

```
ListView timeTrackerListView = (ListView) getActivity().findViewById(R.id.time_tracker_List); 
```

以及任何引用该`onCreateView`方法的内容。

# html - 你的代码中有更多标记有什么缺点？

> ID：12884088
> 
> 赞同：0
> 
> 时间：2012-10-14T16:16:50.020
> 
> 标签：html

我在某处读到有关如何制作 dropcap 的教程

这是代码

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">

<style>
h1, h2, h3, h4, p, ul, li, address, blockquote {
    margin: 0;
    padding: 0;
}

body {
    width: 720px;

    font: 90%/1.6 Arial, Helvetica, sans-serif;

    padding: 25px;
}

.dropcap p:first-of-type:first-letter {
    float: left;
    font-family: Georgia, Times, serif;
    font-size: 4em;
    margin: 0 5px 0 0;
    line-height: .7;
}

</style>
</head>
<body>

<section class="dropcap">

<p>You can use floats to create dropcaps as well. Simply float the first letter of the desired paragraph and set the margins of the float to control spacing. If you want to drop cap a range of letters, simply use a span tag around the letters you want to drop. You can use relative positioning or top margins to help position the cap relative to the paragraph. Because the construct for float elements is a little different in earlier versions of Internet Explorer, if you're targeting versions prior to IE 8 you may need to feed slightly different margin values through conditional comments to have consistent styling. Firefox does NOT allow the dropcap to calculate its own line-height, forcing it to inherit it from the parent paragraph. WebKit based browsers will. This means that in order to have dropcaps line up consistently in WebKit based browsers and Firefox, you'll need to apply a line-height equal to the height of the cap (start at around .8, although you'll need to experiment  with it based on the font you're using).</p>
</section>

</body>
</html> 
```

他说这比使用**跨度标签**然后定位您要删除的字母要好

这是我的问题，代码中更多标记标签的缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:28:34.377

好吧，代码中更多标记的明显缺点是它的可读性较差，向文件大小添加了更多字节，并向代码添加了更多变量，因此可能出现更多错误。

在 section 元素上使用 CSS 样式的缺点是不太容易定位您想要的字母。是的，如果您想定位第一个字母，那就太简单了。但是，如果您想针对第七个字母怎么办？IMO，在这种情况下 span 会更好，但我从来没有遇到过使用 dropcase :p 来定位段落的第七个字母的用例。

# javascript - Javascript：编写 if/else 语句的更好方法？也许使用数组？

> ID：12884089
> 
> 赞同：2
> 
> 时间：2012-10-14T16:17:01.617
> 
> 标签：javascript, arrays, if-statement

> **可能重复：**
> [一百万个 IF 语句的替代方案](https://stackoverflow.com/questions/10029089/alternative-to-a-million-if-statements)

我是编程新手，所以我知道的很少。（抱歉发布新手问题）

这是我的问题。

我已经使用“if，else”语句来根据用户的国家/地区重定向用户，就像这样。

```
if (country == 'US') {
  window.location=us
}  
else {
  if (country == 'GR') {  
    window.location=gr
  }
  else {
    // (repeated this for 5 times/5 different countries)
  }
} 
```

好吧，现在，我需要将访问者重定向到他们的州（即加利福尼亚州、亚利桑那州等）。

问题是，如果我继续使用 if/else 语句，我知道我必须重复 50 次，而 javascript 代码最终会看起来很荒谬。

我知道有更好的方法来做到这一点。

谁能展示如何将多个 if/else 语句替换为数组？在这种情况下应该使用数组吗？我对么？

如果我错了，你能纠正我并告诉我应该使用什么其他语句吗？

谢谢你，我再次为提出这样一个新手问题而道歉。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-14T16:19:50.617

一种可能性是创建地图：

```
var countries = {
    US: us,
    GR: gr
};

window.location = countries[country]; 
```

这是有效的，因为您可以使用字符串获取对象的属性。例如，如果您有一个具有 foo 属性的对象：

```
var myObject = {};
myObject.foo = 4; 
```

然后你也可以`foo`这样：

```
var foosValue = myObject['foo']; 
```

这基本上是一个非常原始的hashmap，是编程中常见的数据结构。这种模式在 JavaScript 中很常见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:33:53.533

```
var redirect = { "US": "http:this", "GR" : "http:that };

window.location = redirect[country] || alert("what are you trying to achieve?"); 
```

# php - 检测布局强制换行 标记和可视化

> ID：12884090
> 
> 赞同：1
> 
> 时间：2012-10-14T16:17:10.183
> 
> 标签：php, javascript, html, css

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:28:17.710

Are you using a fixed-width font? If so, you could count how many characters fit on one line, and if a given line is longer than that, step back through the characters until you hit a space, and split it there.

Even with a flexible layout, you could calculate how many characters can currently fit: Create a hidden `<div>` with the same font, and add characters to it until its height increases.

# java - System.in.read() 没有返回静态块内的确切值

> ID：12884092
> 
> 赞同：-2
> 
> 时间：2012-10-14T16:17:42.697
> 
> 标签：java

由于静态块用于以动态方式初始化静态数据成员，因此我有以下代码：

```
class Temp {
    static int x;

    static {
        try {
            x = System.in.read();
        } catch (Exception e) {
            //Do nothing
        }
    }
}

class Temp1 {
    public static void main(String args[]) {
        System.out.println(Temp.x);
    }
}

class Temp2 {
    public static void main(String args[]) {
        System.out.println(Temp.x);
    }
} 
```

在运行 Temp1、Temp2 时，x 的正常值应该是我从键盘输入的值，但无论我从键盘输入什么，我总是得到 49 和 50。

我已经看到了 inputstream 类的 read() 方法，它应该返回相同的结果。为什么它在每种情况下都返回 49 和 50？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T16:36:50.690

你问的直接问题并不是你应该在这里被告知的第一件事，因为你所采取的方法是非常错误的：

1.  永远不要使用类初始化器从键盘读取。根本没有充分的理由这样做。
2.  不要吞下例外：你是在踢自己的脚。如果有错误，您将无法诊断。
3.  您可能希望在键盘上**解析一个整数输入；**您实际上只是从标准输入中读取一个字节（`System.in`是一个*字节流*）并将其存储为`int`.
4.  您有两个相同的类，其中有两个相同`main`的方法。这是没有意义的：该代码不会以任何形式“完成两次”。

这个列表绝不是详尽的，这只是我现在想到的。

总而言之，您应该首先重新设计您的代码，以使基本方法合理，然后才尝试使其工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T16:32:38.587

我认为您对 java 类型以及输入流如何工作感到困惑。输入流的方法`read()`读取下一个字节并返回它。字节不是文本或字符串。例如，如果您键入`1`它会返回 49 - 字符的 ASCII 码`1`。输入字符`2`会导致它返回 50 等。

如果您输入任意数量的字符，方法`read()`仍将返回第一个字符的 ASCII 码。从您的角度来看，我认为这就是这种“奇怪”行为的原因。

您可能应该将输入流包装到`BufferedInputStream`然后使用`readLine()`方法，即

```
BufferedInputStream bis = new BufferedInputStream(in);
String s = bis.readLine(); 
```

# javascript - Jquery getScript 缓存

> ID：12884097
> 
> 赞同：34
> 
> 时间：2012-10-14T16:18:08.263
> 
> 标签：javascript, jquery, getscript

默认情况下 $.getScript() 禁用缓存，您可以使用 $.ajaxSetup 并将缓存设置为 true。在测试脚本是否实际使用 Firebug 缓存时，大多数情况下脚本返回 200（这意味着脚本是新副本），可能有 20 或 30 次返回 304（意味着它使用了缓存版本）。为什么它在绝大多数时间都得到一个新副本？

```
$.ajaxSetup({
    cache: true
 });

 $.getScript( scriptFile ); 
```

getScript 检索的文件尚未被编辑，请求是分开的页面更改。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-14T19:08:24.117

首先让我们澄清一下 jQuery 禁用缓存是什么意思。

当 jQuery**禁用缓存**时，意味着浏览器会通过某种技巧**强制文件再次加载，例如在 url 末尾添加一个额外的随机数作为参数。**

当 jQuery**启用缓存**时，**不会强制执行任何操作，而是让您在**此文件的标题上设置的缓存。这意味着如果您没有设置文件头参数以将其保留在浏览器缓存中，浏览器将尝试通过某些方法再次加载它。

因此，通过 jQuery 启用缓存，您还必须在静态文件上设置正确的缓存标头以保留在浏览器缓存中，否则浏览器可能会尝试再次加载它们。

对于浏览器在标题上看到创建日期的文件，然后连接到服务器再次询问标题，比较它，如果没有更改，则不再加载它，而是向服务器发出一次调用。

对于您设置了最大年龄的文件，并且在该日期之前不询问服务器，如果他找到它，浏览器会直接从缓存中加载它。

**总结一下**：让浏览器
根据`cache:true`您发送的标头决定是否缓存此文件。
这`cache:false`是强制文件再次加载。

一些与缓存相关的问题：
[缓存 JavaScript 文件](https://stackoverflow.com/questions/311062/caching-javascript-files)
[IIS7 Cache-Control](https://stackoverflow.com/questions/642954/iis7-cache-control)

**里面**
的代码`getScript()`调用`jQuery.get()`女巫是Ajax的简写[函数](http://api.jquery.com/jQuery.get/)

```
$.ajax({
  url: url,
  data: data,
  success: success,
  dataType: dataType
}); 
```

因此，通过调用`getScript()`您进行 ajax 调用，如果这是您最初的想法，那么 jQuery 不会保留任何类型的文件缓存。

**加载 sripts 的自定义函数**
如果您没有创建全局缓存：true，并且您只需要使用缓存：true 加载一些文件，则可以将自定义函数设置为：

```
function getScriptCcd(url, callback)
{
    jQuery.ajax({
            type: "GET",
            url: url,
            success: callback,
            dataType: "script",
            cache: true
    });
}; 
```

这不受全局缓存参数的影响，加载脚本文件时不添加任何非缓存参数。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-05-13T01:57:09.847

自发布此问题之日起出现错误，Firefox 和 Chrome 都会声明脚本没有从缓存中加载，而实际上它确实是。截至本答案发布之日，此问题仍然存在。最简单的测试方法是使用 console.log 并发送一个版本号。

要缓存动态加载的脚本，只需使用以下代码即可完成。

```
function onDemandScript ( url, callback ) {
    callback = (typeof callback != 'undefined') ? callback : {};

    $.ajax({
         type: "GET",
         url: url,
         success: callback,
         dataType: "script",
         cache: true
     });    
} 
```

对于开发，您应该注释掉 cache: true。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-14T07:21:25.367

> 默认情况下，$.getScript() 将缓存设置为 false。这会将时间戳查询参数附加到请求 URL，以确保浏览器在每次请求时下载脚本。

jQuery doc 站点有一个很好的扩展，可以不向请求附加时间戳并绕过缓存：

```
jQuery.cachedScript = function( url, options ) {

  // Allow user to set any option except for dataType, cache, and url
  options = $.extend( options || {}, {
    dataType: "script",
    cache: true,
    url: url
  });

  // Use $.ajax() since it is more flexible than $.getScript
  // Return the jqXHR object so we can chain callbacks
  return jQuery.ajax( options );
};

// Usage
$.cachedScript( "ajax/test.js" ).done(function( script, textStatus ) {
  console.log( textStatus );
}); 
```

[**来源**](https://api.jquery.com/jquery.getscript/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-08T19:39:30.253

实际上有一个更好的选择，您可以为某些请求打开缓存，例如：

```
$.ajaxPrefilter(function( options ) {
  if ( options.type==='GET' && options.dataType ==='script' ) {
      options.cache=true;
  }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-11T05:10:14.553

我知道这是一篇旧帖子，现有的答案是真正的答案，但谈到 Iscariot 的担忧，它真的是在缓存（至少有点像）。这只是firefox的一个怪癖。也许这对那些被这个怪癖弄糊涂的其他人证明是有用的。

我用一个非常大的 javascript 文件测试了这个概念，该文件根据数万个纬度的数组定义了爱达荷州 DOT 区边界的谷歌地图多边形（未压缩的文件大小为 2,806,257，但我通过压缩过程运行它）。使用以下 javascript

```
// Grab polys if not already loaded
if (typeof(defaults.data.polys) === 'undefined') {
    /*$.getScript('/Scripts/ScriptMaster.php?file=Districts', function () {});*/
    $.ajax({
        type: "GET",
        url: '/Scripts/ScriptMaster.php?file=Districts',
        success: function() {
            defaults.data.polys = getPolys();
            data.polys = defaults.data.polys;
        },
        dataType: "script",
        cache: true
    });
} 
```

你可以看到相关的 php（你不希望实际的 Districts.js 文件在这篇文章中占用太多空间，所以这里是 ScriptMaster.php）

```
<?php
require_once('../settings.php');

if (!isset($_GET['file'])) die();
$file = $_GET['file'];
$doCache = $file == 'Districts';

header('Content-type: application/x-javascript');
if ($doCache) {
    // This is a luxury for loading Districts.js into cache to improve speed
    //  It is at the top because firefox still checks the server for
    //  headers even when it's already cached
    $expires = 7 * 60 * 60 * 24; // set cache control to expire in a week (this is not likely to change)
    header('Cache-Control: max-age='.$expires.', must-revalidate');
    header('Last-modified: Fri, 3 May 2013 10:12:37 GMT');
    header('Expires: '.gmdate('D, d M Y H:i:s', time() + $expires).'GMT');
    header('Pragma: public');
}

ob_start("compress");
require_once($file.".js");
ob_end_flush();

function compress($buffer) {
    global $doCache;
    if (DEV_MODE && !$doCache) return $buffer;
    /* remove comments */
        $buffer = preg_replace('/\/\/.+?$/m', '', preg_replace('!/\*[^*]*\*+([^/][^*]*\*+)*/!', '', $buffer));
    /* remove tabs, spaces, new lines, etc. */
        $buffer = str_replace(array("\r\n", "\r", "\n", "\t", '  ', '    ', '    '), '', $buffer);
    /* remove unnecessary spaces */
        $buffer = str_replace(': ', ':', $buffer);
        $buffer = str_replace(' :', ':', $buffer);
        $buffer = str_replace(', ', ',', $buffer);
        $buffer = str_replace(' ,', ',', $buffer);
        $buffer = str_replace('; ', ';', $buffer);
        $buffer = str_replace(' ;', ';', $buffer);
        $buffer = str_replace('{ ', '{', $buffer);
        $buffer = str_replace(' {', '{', $buffer);
        $buffer = str_replace('} ', '}', $buffer);
        $buffer = str_replace(' }', '}', $buffer);

    if ($doCache) { header('Content-Length: '.strlen($buffer)); }

    return $buffer;
}
?> 
```

重要的是要注意，在脚本之前调用 php 的标头函数甚至会执行您要打印的字符串，这与 chrome 不同，并且可能（可能，我懒得检查）其他浏览器 firefox 似乎会对服务器进行 ping在使用缓存之前检查标头。也许通过更多的研究，您可以确定这是否与 ajax 中的元素一样（可能不是）。

所以我做了五次测试运行，显示了这个脚本的加载时间，如 firebug 中所述。这是结果

```
#results loading the script after clearing cache (yes those are seconds, not ms)
200 OK      4.89s
200 OK      4.9s
200 OK      5.11s
200 OK      5.78s
200 OK      5.14s

#results loading the page with control+r
200 OK      101ms
200 OK      214ms
200 OK      24ms
200 OK      196ms
200 OK      99ms
200 OK      109ms

#results loading the page again by navigating (not refreshing)
200 OK      18ms
200 OK      222ms
200 OK      117ms
200 OK      204ms
200 OK      19ms
200 OK      20ms 
```

如您所见，我的 localhost 服务器到 Web 客户端的连接不是最一致的，而且我的笔记本电脑规格有点破旧（单核处理器等等，它也有几年历史了）但重点是负载*显着*下降缓存加载后的时间。

[此外，如果有人对没有压缩脚本感到好奇（不像制表符、空格或新行被浪费，它必须仍然可读）需要 7-8 秒才能加载，但我不会这样做 5次]

所以不要害怕，它真的是缓存。老实说，对于只需要 ms 加载的较小脚本，您可能不会注意到 firefox 的差异；仅仅因为它检查来自服务器的标头。我之所以知道这一点，是因为从将这些标头函数从脚本末尾移动到开头的加载时间发生了变化。如果您在 php 遍历字符串之后拥有这些函数，则加载时间会更长。

希望这可以帮助！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-10T19:21:52.107

您可能正在寻找的是一个`getScriptOnce`函数，基本上，如果它知道文件已经成功加载，则在调用此类函数时不会再次加载此类文件。

我写了这样的功能。您可以使用Firebug 或 Chrome 开发工具中的**网络选项卡进行测试。**这只会加载同一个文件一次。您只需要将`getScriptOnce`函数和全局数组复制到您的文件中`ScriptArray`

```
var getScriptOnce = (function(url, callback) {
  var scriptArray = []; //array of urls
  return function (url, callback) {
      //the array doesn't have such url
      if (scriptArray.indexOf(url) === -1){
          if (typeof callback === 'function') {
              return $.getScript(url, function(script, textStatus, jqXHR) {
                  scriptArray.push(url);
                  callback(script, textStatus, jqXHR);
              });
          } else {
              return $.getScript(url, function(){
                  scriptArray.push(url);
              });
          }
      }
      //the file is already there, it does nothing
      //to support as of jQuery 1.5 methods .done().fail()
      else{
          return {
              done: function () {
                  return {
                      fail: function () {}
                  };
              }
          };
      }
  }
}());

/*#####################################################################*/
/*#####################################################################*/

//TEST - tries to load the same jQuery file twice
var jQueryURL = "https://code.jquery.com/jquery-3.2.1.js";
console.log("Tries to load #1");
getScriptOnce(jQueryURL, function(){
  console.log("Loaded successfully #1")
});

//waits 2 seconds and tries to load again
window.setTimeout(function(){
  console.log("Tries to load #2");
  getScriptOnce(jQueryURL, function(){
    console.log("Loaded successfully #2");
  });
}, 2000);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
```

# mobile - 如何从 Web 应用程序启动 WinRT 应用程序？

> ID：12884103
> 
> 赞同：6
> 
> 时间：2012-10-14T16:18:40.923
> 
> 标签：mobile, windows-8, microsoft-metro, windows-runtime

假设我有一个视频托管网站，比如 youtube。当用户点击网站上的链接时，我想打开一个 WinRT 应用程序以获得更好的观看体验，我该怎么做？

如何将参数传递到 WinRT 应用程序，让它知道应该流式传输哪些视频？我需要能够来回走动，所以我假设我可以引入一个超链接以从应用程序返回到该站点。

另一种可能性是将应用程序嵌入网站本身。那将如何运作？你还能在网站本身上内联小程序样式的应用程序（例如 flash/silverlight）吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-14T18:42:57.777

如果您知道与该应用程序关联的 URI 方案，则可以启动 Windows 应用商店应用程序。例如，游戏应用程序具有与之关联的**xboxgames:。**如果您插入带有该 URI 方案的链接，shell 会将其作为内部参考。[在此处](http://msdn.microsoft.com/en-us/library/windows/apps/hh452686.aspx)阅读更多详细信息。

![在此处输入图像描述](../Images/d77082e2e81f5b35b0ffc8a226691015.png)

[您可能还有兴趣在此处](http://msdn.microsoft.com/en-us/library/ie/hh781489%28v=vs.85%29.aspx#switch)阅读有关如何将您的网站连接到 Windows 应用商店应用程序的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:05:47.103

**编辑**：有可能有一个关联的网址：见 Den Delimarsky 接受的答案。

或者，Windows 应用商店应用可以声明文件类型关联。因此，您可以让用户下载一个文件（例如“video.customExtension”），该文件可能包含信息，例如应用程序应该播放的视频。下载会议文件以开始会议时，它与 Office Live Meeting 的工作方式相同。

如果用户从您的网站下载了该类文件，并且没有安装相应的应用程序，则会提示他在商店中寻找可以打开该文件的应用程序，然后他会找到您的应用程序。

最后，不，您不能在网页中嵌入 Windows 8 应用商店应用程序。

# python - C代码的Python翻译不起作用

> ID：12884106
> 
> 赞同：0
> 
> 时间：2012-10-14T16:18:54.987
> 
> 标签：python, c, algorithm, divide-and-conquer

`O(log N)`我想使用分而治之的方法及时找到数组中的最大元素。[我在planet-source-code](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=12673&lngWId=3)找到了一个工作代码。我将它翻译成 Python 如下：

```
def largest(arr,i,j):
    global max1
    global max2
    if i == j:
        max1 = arr[i]
    else:
        if i == j-1:
           max1 = arr[i] if arr[i] > arr[j] else arr[j]
        else:
              mid = (i+j)/2
              largest(arr,i,mid)
              max2 = max1
              largest(arr,mid+1,j)
              if max2 > max1:
             max1 = max2 
```

当我使用数组`[98,5,4,3,2,76,78,92]`并将代码称为

```
max1 = arr[0]
largest(arr,1,8) 
```

我收到超出范围的列表索引错误。但是 C 代码返回正确的结果 98。任何人都可以发现我在做什么错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:44:19.350

对于一般未排序的数组，您永远无法`max`在小于 O(n) 的时间内找到 。非常简单的证明：如果你在少于 O(n) 的时间内完成，那么对于一个足够大的数组，你没有足够的时间来检查每个元素。因此，对手可以将最大值放在您不检查的元素中，从而使您的算法不正确。

原始代码的优点是使用少于 2n 次比较同时找到最大值和最小值（就像天真的实现所做的那样）——它使用大约 1.5n 次比较，因为当有两个元素时它只执行一次比较*。*使用它只能找到最大值并没有任何好处：最好`max(arr)`在 Python 中使用（这也会更快，因为它没有函数调用开销）。

原始代码将值存储在`a[1]`through`a[n]`中，这需要一个 size 数组`n+1`。因此，您应该在第一个位置放置一个虚拟元素。

但是，更成问题的是，您的翻译不正确。原始使用全局变量来实现多值返回（这是一种非常骇人听闻的方法），并使用局部变量来保存旧的全局变量。由于您将两者都`max1`设为`max2`全局，因此该函数无论如何都不会产生正确的答案。

对 Python 的正确翻译将使用带元组的直接多值返回：

```
def minmax(arr, i, j):
    if i==j:
        return arr[i], arr[i]
    elif i==j-1:
        if arr[i] < arr[j]:
            return arr[i], arr[j]
        else:
            return arr[j], arr[i]
    else:
        mid = (i+j)//2
        min1, max1 = minmax(arr, i, mid)
        min2, max2 = minmax(arr, mid+1, j)
        if min2 < min1: min1 = min2
        if max2 > max1: max1 = max2
        return min1, max1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:30:38.667

你最终会得到一个函数调用

```
largest(arr, 7,8) 
```

然后你的代码

```
max1 = arr[i] if arr[i] > arr[j] else arr[j] 
```

将尝试对超出范围的 arr[j] = arr[8] 进行索引，因为 Python 从 0-7 枚举向量，而不是 1-8。

顺便说一句，我认为您没有 O(log N) 算法，因为所有元素必须至少扫描一次才能找到最大元素，从而导致 O(N)。

# android - Android TextView 文本仅在 Gingerbread 中被截断

> ID：12884109
> 
> 赞同：1
> 
> 时间：2012-10-14T16:19:07.797
> 
> 标签：android, layout, textview, scrollview, android-2.3-gingerbread

我的应用程序中的布局是使用 SDK 16 构建的，我已经测试并确认它们在 ICS 和 JB 上运行良好，但 GB 存在以下问题：

在下面的代码中，我只是想创建一个只有文本的简单布局。但是，在第一行末尾的 Gingerbread 上，文本一直被截断，而不是继续到下一行。我试过将singeLine设置为false，玩弄线条、maxLines、marquee、layoutWeight，将layoutHeight和layoutWidth更改为每个可以想象的组合等等。这个问题真的让我很困惑。

代码：-

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content">

<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical">

<TextView
    android:id="@+id/textView7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Text keeps overflowing"
    android:textAppearance="?android:attr/textAppearanceMedium"
    android:textColor="#33B5E5"
    android:paddingTop="6dp"
    />

<TextView
    android:id="@+id/textView8"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Text gets cut off when I input a long string like this one"
    android:textAppearance="?android:attr/textAppearanceMedium"
    android:textColor="#FFFFFF"
    />

</LinearLayout>

</ScrollView> 
```

此外，如果我将布局的主题更改为 Gingerbread，我会收到错误消息：

```
Failed to find style 'scrollViewStyle' in current theme
Failed to find style 'textViewStyle' in current theme
android.content.res.Resources$NotFoundException 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:21:33.097

自己修好了。无法找出它发生的原因，但我通过在 TextViews 的代码中添加以下几行来修复它：-

```
 android:ellipsize="none"
        android:maxLines="10"
        android:scrollHorizontally="false" 
```

# scheme - OCaml 中是否存在与“设置！”相同的功能？在计划？

> ID：12884123
> 
> 赞同：0
> 
> 时间：2012-10-14T16:20:33.203
> 
> 标签：scheme, ocaml, assignment-operator

我正在尝试创建一个函数，该函数定义一个向量，该向量根据函数的输入而变化，并设置！在 Scheme 中非常适用。在 OCaml 中是否有等效的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T16:51:56.887

我同意 sepp2k 你应该扩展你的问题，并给出更详细的例子。

也许您需要的是*参考资料*。

作为粗略的近似，您可以将它们视为可以分配的变量：

```
let a = ref 5;;
!a;; (* This evaluates to 5 *)
a := 42;;
!a;; (* This evaluates to 42 *) 
```

* * *

[这是来自http://caml.inria.fr/pub/docs/u3-ocaml/ocaml-core.html](http://caml.inria.fr/pub/docs/u3-ocaml/ocaml-core.html)的更详细的解释：

到目前为止我们描述的语言是纯粹的函数式的。也就是说，对同一个表达式的多次评估总是会产生相同的答案。例如，这可以防止实现其接口是单个函数的计数器，该函数`next : unit -> int`递增计数器并返回其新值。重复调用此函数应返回一系列连续整数——每次都有不同的答案。

实际上，计数器需要通过读/写访问来记住它在某个特定位置的状态，但首先，必须在两次调用 next 之间共享一些信息。解决方案是使用可变存储并通过所谓的副作用与存储进行交互。

在 OCaml 中，计数器可以定义如下：

```
let new_count =
  let r = ref 0 in
  let next () = r := !r+1; !r in
  next;; 
```

另一个可能更具体的可变存储示例是银行帐户。在 OCaml 中，记录字段可以声明为可变的，以便以后可以为它们分配新值。因此，银行账户可以是一个包含两个字段的记录，即其编号和余额，其中余额是可变的。

```
type account = { number : int; mutable balance : float }
let retrieve account requested =
  let s = min account.balance requested in
  account.balance <- account.balance -. s; s;; 
```

事实上，在 OCaml 中，引用不是原始的：它们是可变记录的特例。例如，可以定义：

```
type 'a ref = { mutable content : 'a }
let ref x = { content = x }
let deref r = r.content
let assign r x = r.content <- x; x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T18:29:51.223

`set!`在 Scheme 中分配给一个变量。您根本无法分配给 OCaml 中的变量。（所以“变量”并不是真正的“变量”。）所以没有等价物。

但是 OCaml 不是一种纯粹的函数式语言。它具有可变的数据结构。可以分配以下内容：

*   数组元素
*   字符串元素
*   记录的可变字段
*   对象的可变字段

在这些情况下，`<-`语法用于赋值。

@jrouquie 提到的`ref`类型是一种简单的内置可变记录类型，它充当一个事物的可变容器。OCaml 还提供了`!`与s一起使用的`:=`运算符。`ref`

# php - 如何将我的表单放入另一个表单并使用一个提交按钮？

> ID：12884125
> 
> 赞同：0
> 
> 时间：2012-10-14T16:20:40.333
> 
> 标签：php, html, forms

```
 <form action="<?php $self ?>" method="post"> 
            <h2>LundaBlogg</h2>
            <div class="fname"><label for="name"><p>Namn:</p></label><input name="name" type="text" cols="20" onkeyup="EnforceMaximumLength(this,12)"/></div>
            <div class="femail"><label for="email"><p>Epost:</p></label><input name="email" type="text" cols="20"/></div>
            <div class="where"><label for="lund"><p>Skriv ditt blogg ämne:</p></label><input name="lund" type="text" cols="20" onkeyup="EnforceMaximumLength(this,40)"/></div>
            <p>Starta tråden med att posta något:</p><textarea name="post" rows="5" cols="40" onkeyup="EnforceMaximumLength(this,110)"></textarea>
            </br>
                <!-- <form action="uploadImage/upload_file.php" method="post" enctype="multipart/form-data"> -->  
                <label for="file">Ladda upp en bild med ditt inlägg:</label>
                <input type="file" name="file" id="file" />
                <!-- <input type="submit" name="submit" value="Submit"/> -->
                <!-- </form> --> 
            </select><br/>
                <p>Välj kategori som du vill lägga din post i:</p>
                <!-- Skapar en dropdown meny med tre värden/value. --> 
                <select name="LundaBlogg" size="1"> <!--  Namnet på dropdown menyn + size = hur många rader som ska visas. -->
                <option value="Lund">Lund</option>
                <option value="Cyklar">Cyklar</option>
                <option value="Kultur">Kultur</option>
            </select>
            <input name="send" type="hidden"/>
            <p><input type="submit" value="skicka"/></p> 
        </form> 
```

* * *

我希望能够使用一个提交按钮`input type="submit" value="skicka"`并且我想要我的（代码）

```
form action="uploadImage/upload_file.php" method="post" enctype="multipart/form-data" 
label for="file"Ladda upp en bild med ditt inlägg:/label 
input type="file" name="file" id="file" 
```

形式

在我的其他形式中，如上面的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:23:55.180

你不能。表单不能嵌套在 HTML 文档中。

您需要*将所有数据提交到单个 URI*（这是最简单的选项），**或者**：

1.  让第一个表单提交到一个 URI
2.  从该 URI 返回一个包含新表单的 HTML 文档
3.  让用户在输入数据后手动提交第二个表单

**或者**，使用 JavaScript（带有 XMLHttpRequest 对象）提交您的表单数据（这是最后一个可靠的选项）。

# magento - Magento 1.7 如何使用类别作为过滤器？

> ID：12884131
> 
> 赞同：2
> 
> 时间：2012-10-14T16:21:30.987
> 
> 标签：magento, filter, navigation, magento-1.7, layered

对不起，我的英语不好。

我试图找到如何使用现有类别作为过滤器，但没有成功。因此，它可以按产品所属的所有类别过滤产品。

例如，我有 3 个类别：“品牌”、“运动”和“类别”。

我有一个棒球出现在这 3 个类别中。

在 ：

品牌——我的品牌

运动---棒球

类别 --- 球

我想这样，例如，如果我在“我的品牌”猫中，我可以按“球”过滤，这样我就可以浏览这个品牌的球。

我知道我可以通过属性来实现这一点，但我不喜欢属性的排序方式，我希望我能找到一种方法来保持类别树。

事实上，我想要与我们进行研究时完全相同的过滤器（所有类别和属性）。

在此先感谢您提供帮助的灯！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T16:26:10.913

您可以按类别过滤产品：

```
->addCategoryFilter($cat) 
```

或者

```
->addAttributeToFilter('category_id', array('in' => $catIDs)) 
```

# php - 过多的空格和新行是否会使 PHP 代码运行速度变慢？

> ID：12884132
> 
> 赞同：3
> 
> 时间：2012-10-14T16:21:41.637
> 
> 标签：php, execution-time

对我来说写起来更舒服

```
<?php

$a = true;

if(true) {

    $a = false;

}

?> 
```

下一个代码会执行得更快吗：

```
<?php
$a = true;
if(true) {
    $a = false;
}
?> 
```

**UPD**

即使 PHP 忽略了空格字符，在解析 .php 文件时，PHP 每次遇到空格时都应该思考（“我是否应该忽略这个字符”）。它会增加执行时间吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:26:04.360

额外的空格对性能几乎没有影响，除了技术上在解析时还有更多的字符需要爬过。我们在这里谈论的是几分之一秒，因为空格在被解析时被简单地忽略了。

同样使用像[APC](http://php.net/manual/en/book.apc.php)这样的 OPCODE 缓存，对同一文件的后续请求将不会导致重新解析同一文件（一般来说）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T16:24:01.300

不，不是。

字节码解析器会忽略所有空格，如果您正在运行任何类型的加速器（xcache、apc 等），您的代码实际上是从字节码缓存而不是文件运行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-14T16:24:10.783

不，它根本不会明显（甚至可能无法测量）更快。也许如果您在每行代码之间有页面和空白页面，您会看到不同之处。但总的来说没有，没有性能提升。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T16:40:00.700

PHP 不解析空格。

# c++ - (OpenMP) 如何在 1 个线程中启动每个函数 1 次

> ID：12884133
> 
> 赞同：0
> 
> 时间：2012-10-14T16:21:58.607
> 
> 标签：c++, multithreading, function, openmp

我有 4 个线程，我想一次性启动 3 个函数。每个函数占用一个线程。
但是这段代码启动了每个函数 4 次

```
#pragma omp parallel
    {
        Func1();
        Func2();
        Func3();
    } 
```

我有这个结果：

功能* *1* * 开始

功能* *1* * 开始

功能* *1* * 开始

功能* *1* * 开始

功能* *1* * 完成

功能* *1* * 完成

功能* *1* * 完成

功能* *1* * 完成

Func* *2* * 开始

Func* *2* * 开始

Func* *2* * 开始

Func* *2* * 开始

功能* *2* * 完成

功能* *2* * 完成

功能* *2* * 完成

功能* *2* * 完成

...

我应该如何更改代码以显示如下内容：

功能* *1* * 开始

Func* *2* * 开始

Func* *3* * 开始

功能* *2* * 完成

功能* *1* * 完成

功能* *3* * 完成

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T16:32:21.037

您正在寻找的是`sections`工作共享结构。语法应如下所示：

```
#pragma omp parallel
{
#pragma omp sections
  {
#pragma omp section
    Func1();
#pragma omp section
    Func2();
#pragma omp section
    Func3();
  }
} 
```

我建议您参考其中的[规范](http://www.openmp.org/mp-documents/OpenMP3.1.pdf)和示例，以获取有关此构造如何工作的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T21:08:33.297

As already answered by Massimiliano, the easiest way to achieve what you want is to use the `sections` construct:

```
#pragma omp parallel sections
{
    #pragma omp section
    Func1();
    #pragma omp section
    Func2();
    #pragma omp section
    Func3();
} 
```

(when the `sections` construct is the only thing nested inside a `parallel` region, both pragmas can be combined as shown)

Each `section` scopes the statement or block immediately following it. E.g. if you'd like to include some more code in a section, you should put it inside a block:

```
#pragma omp section
{
    Func1();
    SomeOtherFunc1();
} 
```

A more general way to control what each thread does is to examine the thread ID as returned by `omp_get_thread_num()` and to branch in accordance. This resembles the way MPI programs are written:

```
#pragma omp parallel
{
    switch (omp_get_thread_num())
    {
        case 0:
            Func1();
            break;
        case 1:
            Func2();
            break;
        case 2:
            Func3();
            break;
        default:
            // Do nothing
     }
} 
```

One obvious disadvantage is that it would only work unless there are at least 3 threads in the team that executes the parallel region, i.e. code that relies on thread IDs becomes somewhat non-portable. In contrast, the `sections` directive works with any number of threads, e.g. if there is only one thread, all sections would be executed sequentially.

# scala - 具有 <: 和多个特征的 Scala 泛型

> ID：12884135
> 
> 赞同：10
> 
> 时间：2012-10-14T16:22:11.750
> 
> 标签：scala, generics, traits

Java 的一个几乎不为人知的特性是这种泛型语法：

```
public class Baz<T extends Foo & Bar> {} 
```

我想在 Scala 中做同样的事情，但我不知道该怎么做，有人可以给我语法吗？

我以前有：

```
class MongoObject[T <: CaseClass] 
```

现在我需要：

```
class MongoObject[T <: IdentifiableModel & CaseClass] 
```

或者至少类似的东西

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-14T16:24:03.987

您可以`with`像在 extends 子句中一样使用关键字：

```
class MongoObject[T <: IdentifiableModel with CaseClass] 
```

这意味着 that`T`必须是`IdentifiableModel`and的子类型`CaseClass`。

# python - Matplotlib 图卡住（灰色窗口）

> ID：12884137
> 
> 赞同：1
> 
> 时间：2012-10-14T16:22:17.507
> 
> 标签：python, matplotlib

自从我开始使用 python 以来，我一直在使用 matplotlib 时遇到一些问题。当我使用交互模式时，我必须运行 ipython --pylab --wthread 来获取绘图（如果我不使用 --wthread 命令，它不会绘制任何东西）。到目前为止，这还不是问题。

现在，我想：

1.  输入一个循环
2.  策划一些事情。这个情节是一个有两个子情节的大情节。
3.  之后，显示一个带有easygui的按钮面板，让用户根据他在情节上看到的内容来决定
4.  关闭情节
5.  重复要在我的列表中绘制的每一件事。

我现在发现了几个困难：

1）如果我尝试使用 run script.py 命令以交互方式运行脚本，那么它不会绘制任何东西，而是直接跳转到按钮面板的东西。但是，如果我停止脚本，情节就会出现。我很确定正在发生的事情是“运行”命令在使用 for 循环完成脚本之前不会显示绘图。但我需要这些图出现在按钮之前。

2）经过一些尝试，我发现这段代码可以工作（出于某种神秘的原因……）。我尝试了其他方法，但删除任何 show() 或 draw() 命令只会使脚本不起作用

```
fig=plt.figure(figsize=(16,8))

plt.show()

ax1=fig.add_subplot(121)

ax2.things...

ax2=fig.add_subplot(122)

ax2.things

plt.draw()

plt.show()

plt.draw()

showthebuttonsthing... 
```

即使这是有效的，matplotlib 似乎也不能很好地处理循环，并且在 5 秒内没有按下任何按钮只是等待之后，我的 matplotlib 窗口变灰了。这可能听起来很愚蠢，但颜色对于我希望用户做出的决定很重要......

3）如果我在 ipython 之外运行 python 脚本，我找不到让 python 脚本显示情节的方法......

我想我的 matplotlib 配置确实有问题，但是找不到使这项工作正常进行的方法……有人可以帮我解决这个问题吗？

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T16:54:37.770

看起来您几乎已经完成了，但请尝试按以下顺序执行操作：

```
fig = plt.figure(figsize=(16,8))
ax = [fig.add_subplot(121),fig.add_subplot(122)]

ax[0].things
ax[1].things

plt.show()

#show the button panel 
```

However, the best method may be to integrate the plot into your GUI. I am not familiar with EasyGUI, but it seems to be based on tk. This [example](http://matplotlib.org/examples/user_interfaces/embedding_in_tk.html) should help you with embedding the figure into a tk window.

# php - Facebook PHP SDK - 发布更新时的正确方法

> ID：12884138
> 
> 赞同：0
> 
> 时间：2012-10-14T16:22:31.553
> 
> 标签：php, facebook, facebook-graph-api

从 PHP SDK 在用户时间线/墙上发布更新的最佳方法是什么？在我通过 connect 捕获 FB id 然后存储在数据库中的那一刻，我们还存储了用户访问令牌。我的问题是如何发布到用户墙上，我知道我在应用程序中使用了 api，但我不知道我是否只是循环遍历用户 ID 并为每个人发布。

有谁知道 id Facebook 在向 Facebook 发帖时包含速率限制。

任何建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T03:00:00.817

Facebook[平台政策](https://developers.facebook.com/policy/)建议以下阈值：-

> (>5M MAU) 或 (>100M API 调用/天) 或 (>50M 印象/天)。

因此可以安全地假设展示次数限制可能是应用程序上的帖子限制，所以我认为你应该保持你的帖子每天 <= 50M，如果你认为你可能会超过它，那么使用Facebook 平台政策中的[联系表](https://www.facebook.com/help/contact/?id=206103619499608).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:57:37.557

没有限制，一切都与您的帖子投诉量有关。当您的投诉向 facebook 管理员发出时，他们会将您的应用程序视为垃圾邮件，然后将其删除

# python - Django-postman 获取邮件列表

> ID：12884140
> 
> 赞同：0
> 
> 时间：2012-10-14T16:22:34.793
> 
> 标签：python, django

我已`django-postman`根据此[文档](http://django-postman.readthedocs.org/en/latest/index.html)进行安装和配置。

一切都好。现在我想在模板中获取经过身份验证的用户的消息列表（未读和未删除的消息列表），但这听起来只是一个完整显示它的收件箱视图（包含收件箱、垃圾箱、已发送、已接收消息），而我只需要一个消息列表。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:32:55.273

这是我的解决方案：

在`views.py`：

```
unread_messages=request.user.received_messages.filter(read_at__isnull=True,sender_deleted_at__isnull=True) 
```

在`template`：

```
{% for m in unread_messages %}
   <!--do stuff-->
{% endfor %} 
```

# php - 如果没有被引号包裹，正则表达式会得到一个单词

> ID：12884141
> 
> 赞同：2
> 
> 时间：2012-10-14T16:22:35.157
> 
> 标签：php, regex

如果我们有：

```
$text = 'Jame is sleeping but pretend that is "studying"'; 
```

现在我需要 a`regex`来获取所有单词，`is`但如果没有被双引号或单引号包裹。

结果应该是公正`sleeping`而不是`studying`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T16:31:56.607

这实际上很简单：

```
is\s(\w+) 
```

你可以让它更自由一点：

```
is\s([^\s"']+) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T16:30:39.727

尝试这个：

```
is (\w+) 
```

**[工作示例](http://regex101.com/r/bA4rA2)**

# iphone - glDrawArrays 在每一帧上分配内存

> ID：12884143
> 
> 赞同：3
> 
> 时间：2012-10-14T16:22:43.670
> 
> 标签：iphone, ios, opengl-es, glsl

我最近发现 glDrawArrays 在每一帧上分配和释放大量内存。我怀疑它与 openGL 分析器报告的“在初始化之外编译的着色器”问题有关。这发生在每一帧！它应该只有一次，并且在着色器编译后消失吗？

编辑：我还仔细检查了我的顶点是否正确对齐。所以我真的很困惑内存驱动程序需要在每一帧上分配什么。

编辑#2：我正在使用 VBO 和退化的三角形条来渲染精灵和 . 我在每一帧（GL_STREAM_DRAW）上传递几何图形。

![在此处输入图像描述](../Images/c337320413314c3aa72a5d5e6cd10983.png)

编辑#3：

我想我已经接近问题但仍然无法解决它。**如果我将相同的纹理 id 值传递给着色器，问题就会消失（参见源代码注释）。不知何故，这个问题与我认为的片段着色器有关。**

在我的精灵批次中，我有精灵列表，并通过纹理 ID 和 FIFO 队列渲染它们。

这是我的精灵批处理类的源代码：

```
void spriteBatch::renderInRange(shader& prog, int start, int count){

int curTexture = textures[start];
int startFrom = start;

//Looping through all vertexes and rendering them by texture id's
for(int i=start;i<start+count;++i){
    if(textures[i] != curTexture || i == (start + count) -1){

        //Problem occurs after decommenting this line
       // prog.setUniform("texture", curTexture-1);

         prog.setUniform("texture", 0); // if I pass same texture id everything is OK

        int startVertex = startFrom * vertexesPerSprite;
        int cnt = ((i - startFrom) * vertexesPerSprite);

        //If last one has same texture we just adding it
        //to last render call

        if(i == (start + count) - 1 && textures[i] == curTexture)
            cnt = ((i + 1) - startFrom) * vertexesPerSprite;

        render(vbo, GL_TRIANGLE_STRIP, startVertex+1, cnt-1);

        //if last element has different texture
        //we need to render it separately

        if(i == (start + count) - 1 && textures[i] != curTexture){

         //   prog.setUniform("texture", textures[i]-1);
            render(vbo, GL_TRIANGLE_STRIP, (i * vertexesPerSprite) + 1, 5);
        }

        curTexture = textures[i];
        startFrom = i;
    }
} 
```

}

```
inline GLint getUniformLocation(GLuint shaderID, const string& name) {
    GLint iLocation = glGetUniformLocation(shaderID, name.data());
    if(iLocation == -1){ // shader variable not found
        stringstream errorText;
        errorText << "Uniform \"" << name << " was not found!";
        throw logic_error(errorText.str());
    }
    return iLocation;
}

void shader::setUniform(const string& name, const matrix& value) {
    GLint location = getUniformLocation(this->programID, name.data());
    glUniformMatrix4fv(location, 1, GL_FALSE, &(value[0]));
}

void shader::setUniform(const string& name, int value) {
    GLint iLocation = getUniformLocation(this->programID, name.data());
            //GLenum error =  glGetError();
    glUniform1i(iLocation, value);
            //    error =  glGetError();
} 
```

编辑#4：我试图在 IOS 6 和 Iphone5 上分析应用程序，并且分配要大得多。但是在这种情况下方法是不同的。我附上了新的截图。

![在此处输入图像描述](../Images/5e6cd4f17800b803b15e9d68830a4a50.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T18:20:09.343

**通过为每个纹理创建单独的着色器来**解决问题。它看起来像所有 IOS 设备上确实发生的驱动程序实现中的错误（我在 IOS 5/6 上测试过）。然而，在更高的 iPhone 型号上，它并不那么明显。

在 iPhone4 上，从 60 FPS 到 38 FPS 的性能影响非常显着！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-18T16:08:16.020

尝试只查询一次纹理统一（在初始化中）并缓存它。在一帧中过多调用“glGetUniformLocation”会影响性能（取决于精灵数量）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-17T17:07:04.303

更多代码会有所帮助，但您是否检查过所涉及的内存量是否与您正在更新的几何体量相当？（尽管这看起来像很多几何图形！）看起来 GL 将您的更新保留到 glDrawArrays，当它可以被拉入内部 GL 状态时释放它。

如果您可以在 MacOS 应用程序中运行代码，则 OpenGL Profiler 工具可能能够进一步隔离条件。（如果您不熟悉此工具，请查看 XCode 文档以获取更多信息）。考虑到所涉及的内存量，我还建议查看纹理使用。

最简单的做法可能是有条件地中断 malloc() 以进行大分配，记下地址，并检查那里加载了什么。

# vb.net - 使用嵌套命名空间而不是 Partial Public NotInheritable Classes 是否有优势

> ID：12884144
> 
> 赞同：0
> 
> 时间：2012-10-14T16:22:52.583
> 
> 标签：vb.net, class, namespaces, shared

似乎使用`Partial` `NotInheritable` `Class`的优点是可以在其中声明/实现共享方法。

这是一个代码示例，以帮助可视化问题。

```
Namespace MyNamespace.Utility
    ' Cannot Declare Shared Function
    Public NotInheritable Class Document
        ' Can Declare Shared Function        
    End Class
End Namespace 
```

这反对

```
Namespace MyNamespace
    Partial Public NotInheritable Class Utility
        ' Can Declare Shared Function
        Partial Public NotInheritable Class Document
            ' Can Declare Shared Function
        End Class
    End Class
End Namespace 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:02:23.213

实用程序应该是命名空间，因为它充当逻辑分组。 [Microsoft .NET Framework 嵌套类型指南](http://msdn.microsoft.com/en-us/library/vstudio/ms229027%28v=vs.100%29.aspx)

我不同意您的说法，即密封类的优点是您可以定义静态方法，任何类都可以这样做。

# ravendb - 匿名类型的属性与静态索引映射属性上的数组

> ID：12884146
> 
> 赞同：1
> 
> 时间：2012-10-14T16:23:00.320
> 
> 标签：ravendb

我有一个实体如下：

```
public class WdiAndGdi
{
    public string CountryName { get; set; }

    public string CountryCode { get; set; }

    public string IndicatorName { get; set; }

    public string IndicatorCode { get; set; }

    public Decimal? Year1960 { get; set; }
    public Decimal? Year1961 { get; set; }

    public Decimal? Year1962 { get; set; }
    public Decimal? Year1963 { get; set; }
    public Decimal? Year1964 { get; set; }
    public Decimal? Year1965 { get; set; }
    public Decimal? Year1966 { get; set; }
    public Decimal? Year1967 { get; set; }
    public Decimal? Year1968 { get; set; }
} 
```

而且，我想创建一个索引如下（仅显示 Map 属性）：

```
Map = indicators => from indicator in indicators
                            select new
                                       {
                                           indicator.CountryName,
                                           indicator.IndicatorName,
                                           Statistics = new[] { indicator.Year1960, indicator.Year1961,... },
                                           Min = 0.0m,
                                           Max = 0.0m,
                                           DataPresentForYears = 0
                                       }; 
```

但是，当我尝试执行此索引时，出现以下错误：

```
{
"Url": "/indexes/IndexByIndicator",
 "Error": "System.InvalidOperationException: Could not understand query: \r\n-- line 2       col139: invalid NewExpression\r\n-- line 2 col 179: Can't parse double .0.0 at ..... 
```

这是请求的提琴手跟踪：

```
{"Name":null,"Map":"docs.WdiAndGdis\r\n\t.Select(indicator => new {CountryName =     indicator.CountryName, IndicatorName = indicator.IndicatorName, Statistics = new  System.Nullable`1[[System.Decimal, mscorlib, Version=4.0.0.0, Culture=neutral,   PublicKeyToken=b77a5c561934e089]] []{((decimal?)indicator.Year1960), ((decimal?)indicator.Year1961)}, Min = 0.0M, Max = 0.0M, DataPresentForYears = 0})","Maps":["docs.WdiAndGdis\r\n\t.Select(indicator => new {CountryName = indicator.CountryName, IndicatorName = indicator.IndicatorName, Statistics = new System.Nullable`1[[System.Decimal, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] []{((decimal?)indicator.Year1960), ((decimal?)indicator.Year1961)}, Min = 0.0M, Max = 0.0M, DataPresentForYears = 0})"],"Reduce":"results\r\n\t.GroupBy(result => new {CountryName = result.CountryName, IndicatorName = result.IndicatorName})\r\n\t.Select(g => new {Country = g.Key.CountryName, IndicatorName = g.Key.IndicatorName, Max = Enumerable.Max(g, x => ((System.Nullable`1[[System.Decimal, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]][])(x.Statistics))), Min = Enumerable.Min(g, x => ((System.Nullable`1[[System.Decimal, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]][])(x.Statistics))), DataPresentForYears = g\r\n\t.SelectMany(x => x.Statistics).Count(s => s.HasValue)})","TransformResults":null,"IsMapReduce":true,"IsCompiled":false,"IsTemp":false,"Stores":{},"Indexes":{},"SortOptions":{},"Analyzers":{},"Fields":[],"Type":"MapReduce"} 
```

# iphone - 将照片保存到相册

> ID：12884151
> 
> 赞同：0
> 
> 时间：2012-10-14T16:23:25.087
> 
> 标签：iphone, uiscrollview, uiimageview, ios6

如果我在我的应用程序中显示多个这样的图像

```
UIScrollView *imageScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
imageScrollView.pagingEnabled = YES;
NSInteger numberOfPhotos = 61;

for (int i = 0; i < numberOfPhotos; i++) {
    CGFloat xOrigin = i * self.view.frame.size.width;

NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];
    UIImage *image = [UIImage imageNamed:imageName];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    _imageView.tag = 122;
    imageView.frame = CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height); 
```

编辑：

```
 imageView.image = [UIImage imageNamed:imageName]; 
```

将上述语句添加到代码后仍然无法正常工作。

```
 UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc]
                                                       initWithTarget:self
                                                       action:@selector(handleLongPress:)];

    imageScrollView.userInteractionEnabled = YES;
    [imageScrollView addGestureRecognizer:gestureRecognizer];
    gestureRecognizer.delegate = self;
imageScrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfPhotos, self.view.frame.size.height); 
```

现在在滚动视图中显示图像后，如果长按滚动视图中的任何图像，将显示带有保存照片按钮的操作表

```
- (void)handleLongPress:(UILongPressGestureRecognizer*)gestureRecognizer{
if (gestureRecognizer.state == UIGestureRecognizerStateBegan){
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Save Photo", nil];
    actionSheet.actionSheetStyle = UIActionSheetStyleBlackTranslucent;
    [actionSheet showInView:self.view];
    [actionSheet release];

}}

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
switch (buttonIndex) {
    case 0:

        [self savePhoto];

       break;

    default:
        break;

}} 
```

按下保存照片按钮时

```
-(void)savePhoto{

  UIImageWriteToSavedPhotosAlbum(_imageView.image, self, @selector(image: didFinishSavingWithError:contextInfo:), nil);
  } 
```

但是在执行应用程序时，它不会将任何照片保存到相册。我是否错过了一些重要的信息来放入代码以使其工作。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:45:40.803

imageView 和 _imageView 是两个不同的变量。您正在设置 imageView 的图像，但是当您尝试获取它时，您正在向 _imageView 发送消息，您从未设置过它的图像属性。

编辑：这更简单。只需将手势识别器直接分配给图像视图，然后在 handleLongPress: 中获取您的图像视图。在 selectedImageView 属性中存储对该视图的引用，然后在保存时获取该图像视图上的图像属性。请参阅我对您的代码的编辑。

```
Declare 

//a property to store a reference to the image view that the user selected
@property (strong, nonatomic) UIImageView *selectedImageView;

in viewDidLoad: self.imageViews = [[NSMutableArray alloc] init];

UIScrollView *imageScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
imageScrollView.pagingEnabled = YES;
NSInteger numberOfPhotos = 61;

for (int i = 0; i < numberOfPhotos; i++) {
    CGFloat xOrigin = i * self.view.frame.size.width;

NSString *imageName = [NSString stringWithFormat:@"image%d.png", i];
    UIImage *image = [UIImage imageNamed:imageName];
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];

    //make tag an incremented variable to ensure that all of the imageViews have a different tag
    _imageView.tag = i;

    imageView.frame = CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height);

    UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc]
                                                       initWithTarget:self
                                                       action:@selector(handleLongPress:)];

    //I would add the gesture recognizer directly to the image view at this point. 
    imageView.userInteractionEnabled = YES;
    [imageView addGestureRecognizer:gestureRecognizer];
    gestureRecognizer.delegate = self;

imageScrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfPhotos, self.view.frame.size.height);
}

- (void)handleLongPress:(UILongPressGestureRecognizer*)gestureRecognizer{
if (gestureRecognizer.state == UIGestureRecognizerStateBegan){
//get the image view that the user selected and save it as your selectedImageView property
UIImageView *pressedImageView = (UIImageView *)gestureRecognizer.view;
self.selectedImageView = pressedImageView;

    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:nil delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Save Photo", nil];
    actionSheet.actionSheetStyle = UIActionSheetStyleBlackTranslucent;
    [actionSheet showInView:self.view];
    [actionSheet release];

}}

-(void)actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex {
switch (buttonIndex) {
    case 0:

        [self savePhoto];

       break;

    default:
        break;

}}

-(void)savePhoto{

//get the image from the imageView that you stored a reference to when the user selected it
  UIImageWriteToSavedPhotosAlbum(self.selectedImageView.image, self, @selector(image: didFinishSavingWithError:contextInfo:), nil);
  } 
```

# xml - 如何正确使用 Lua-XML 解析器 (lua expat / LuaXml)

> ID：12884163
> 
> 赞同：2
> 
> 时间：2012-10-14T16:24:32.200
> 
> 标签：xml, xml-parsing, lua, luaxml

我在 Visual Studio 中有我执行的 C++ 代码，这最终会`.lua`用我的 Lua 代码执行我的文件。我的目标是为 Lua 提供一个 XML 文件。经过一些研究，我现在知道我需要为此使用解析器。

两个好的解析器似乎是：

*   [lua 外籍人士](http://matthewwild.co.uk/projects/luaexpat/)
*   [LuaXML](http://viremo.eludi.net/LuaXML/)

问题是，我不知道如何使用这些。是的，这听起来很简单，但我对这整件事很陌生，不理解这些解析器的描述。所以我的问题是：

1.  如何使用/安装解析器，更准确地说，哪些文件必须放在哪里？
2.  在那之后我到底要做什么才能使 XML 文件可用于 Lua？
3.  解析后的数据会在不同的文件中还是直接在我的 Lua 代码中可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:42:39.853

我使用 LuaXML 来满足我的要求，因为它是搜索的第一个结果，并且在[lua-users.org](http://lua-users.org/wiki/LuaXml)上记录了一些非常好的示例。

您还可以在他们的[项目网站](http://matthewwild.co.uk/projects/luaexpat/examples.html)上查看 lua eXpat 的示例。

# 安装

如果你是 Windows 所有者，你可以看看[lua For Windows](http://code.google.com/p/luaforwindows/)。正如他们所说，它还有许多其他“电池”。:)

对于 Linux，安装说明在其各自的网站上有很好的记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:39:21.220

LuaXML 和 LuaExpat 都包含一个 C 库和一个 Lua 胶水文件。

C 文件可以在 Windows 上编译成 DLL，并且 DLL 必须放在`package.cpath`. 如果您在 Visual Studio 中从源代码编译 Lua，一个可能的替代方法是`LuaXML_lib.c`与 Lua 文件一起编译（假设 LuaXML）并添加`luaopen_LuaXML_lib`到`linit.c`.

Lua 库文件`LuaXml.lua`必须放在`package.path`.

如果您不知道系统上的路径，请尝试运行：

```
print("C path:", package.cpath)
print("Lua path:", package.path) 
```

# c# - C# 中的加速器是什么以及如何使用它们？

> ID：12884165
> 
> 赞同：4
> 
> 时间：2012-10-14T16:25:01.180
> 
> 标签：c#, winforms, accelerator

在我的在线课程中，我被要求`lblQuestion`在表单上放置一个标签（带加速键）和 ComboBox。

在 VS 2010 中，在表单上放置标签和组合框非常简单，但我不确定加速器是什么以及如何使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T16:30:46.897

要设置加速器，您将在标签字母前使用 & 字符，您需要将其用作加速器。请参阅此处： http: [//blog.csharphelper.com/2012/05/30/use-accelerators-on-labels-and-buttons-in-c.aspx](http://blog.csharphelper.com/2012/05/30/use-accelerators-on-labels-and-buttons-in-c.aspx)了解更多详情。

# c - 如何枚举内核中指定进程的所有打开句柄（Windows）

> ID：12884166
> 
> 赞同：1
> 
> 时间：2012-10-14T16:25:03.417
> 
> 标签：c, windows, kernel, handle

我有一个内核驱动程序。如何枚举内核驱动程序中指定进程的所有打开句柄？我想关闭这些句柄。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T20:26:43.960

> 我想关闭这些句柄。

对于它的价值，仅仅因为某事可以做，并不意味着它应该做。这是一个坏主意。

也就是说，可以使用信息类对[Zw/NtQuerySystemInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724509%28v=vs.85%29.aspx)的未记录调用来枚举所有进程的所有句柄`SystemHandleInformation`。使用这些术语进行网络搜索将产生您想要的结果。

# sql - SQL 与 sum 连接

> ID：12884168
> 
> 赞同：0
> 
> 时间：2012-10-14T16:25:07.457
> 
> 标签：sql, sql-server-2008-r2, sum

您好，我有以下 SQL 查询，它产生以下结果

```
SELECT * FROM
     (
     Select
        catalogid, numitems, allitems - numitems ignoreditems
     from
         ( 
             select
                 i.catalogid,
                 case
                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)
                     when Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) AND odate is not null AND NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) then sum(i.numitems)
                 else 0 end numitems,
                 sum(numitems) allitems 
             from 
                 "orders o
             inner join
                 "oitems i 
             on 
                 "i.orderid=o.orderid
             inner join
                 "products T1
             on 
                 "T1.catalogid = i.catalogid
             group by 
                 "i.catalogid, ocardtype, odate,o.orderid
         ) A
     ) B
     INNER JOIN
     (
         SELECT 
             catalogId, 
             ProcessedSucssessfully = 
                STUFF((SELECT ', ' + CAST( b.orderid as varchar(10))
                       FROM oitems b JOIN orders o ON b.orderid = o.orderid 
                       WHERE b.catalogId = a.catalogId 
                       AND  NOT EXISTS(SELECT booked FROM bookedordersids m where CAST(m.booked AS int)=o.orderid) AND (Exists(select paymentodate from payentmethodvalidation q where q.paymentnoodate = o.ocardtype) OR Exists(select paymentodate from payentmethodvalidation q where q.paymentodate = o.ocardtype) and o.odate is not null)
                       FOR XML PATH('')), 1, 2, ''), 
                           "NotProcessed = 
                 STUFF((SELECT ', ' + CAST( c.orderid as varchar(10))
                        FROM oitems c JOIN orders o ON c.orderId = o.orderid
                        WHERE c.catalogid = a.catalogid 
                        AND (o.ocardtype in ('mastercard') OR o.ocardtype is null) and o.odate is null
                        FOR XML PATH('')), 1, 2, '') 
         FROM 
             oitems a 
         GROUP BY 
             a.catalogid 
     )C
         ON 
             B.catalogid = C.catalogid 
```

您可以在下图中看到此查询的结果 ![在此处输入图像描述](../Images/33ef2d7f039426983c19a54564ce69a8.png)

您会看到那 2 个带圆圈的行，我希望它们位于一行中，仅对 numitems 进行求和，处理成功的值和所有其他值对于共享目录 ID 的记录将始终相同，因此它们没有问题。

基本上，结果行应该具有所有具有相同目录 ID 的行中的 numitem 值的总和

那么我该如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T16:27:44.267

如果，正如您所提到的，所有其余的值都相同，则解决方案很简单：

```
SELECT CATALOGID, 
       Sum(NUMITEMS), 
       ALLITEMS - NUMITEMS ignoreditems 
FROM   (SELECT CATALOGID, 
               NUMITEMS, 
               ALLITEMS - NUMITEMS ignoreditems 
        FROM   (SELECT i.CATALOGID, 
                       CASE 
                         WHEN EXISTS(SELECT PAYMENTODATE 
                                     FROM   PAYENTMETHODVALIDATION q 
                                     WHERE  q.PAYMENTNOODATE = o.OCARDTYPE) 
                              AND NOT EXISTS(SELECT BOOKED 
                                             FROM   BOOKEDORDERSIDS m 
                                             WHERE  Cast(m.BOOKED AS 
                                                    INT) = o.ORDERID) 
                       THEN 
                         Sum(i.NUMITEMS) 
                         WHEN EXISTS(SELECT PAYMENTODATE 
                                     FROM   PAYENTMETHODVALIDATION q 
                                     WHERE  q.PAYMENTODATE = o.OCARDTYPE) 
                              AND ODATE IS NOT NULL 
                              AND NOT EXISTS(SELECT BOOKED 
                                             FROM   BOOKEDORDERSIDS m 
                                             WHERE  Cast(m.BOOKED AS 
                                                    INT) = o.ORDERID) 
                       THEN 
                         Sum(i.NUMITEMS) 
                         ELSE 0 
                       END           numitems, 
                       Sum(NUMITEMS) allitems 
                FROM   ORDERS o 
                       INNER JOIN OITEMS i 
                               ON i.ORDERID = o.ORDERID 
                       INNER JOIN PRODUCTS T1 
                               ON T1.CATALOGID = i.CATALOGID 
                GROUP  BY i.CATALOGID, 
                          OCARDTYPE, 
                          ODATE, 
                          o.ORDERID) A) B 
       INNER JOIN (SELECT CATALOGID, 
                          ProcessedSucssessfully = Stuff( 
                          (SELECT ', ' + Cast( b.ORDERID 
                                  AS VARCHAR 
                                  (10)) 
                           FROM   OITEMS b 
                                  JOIN ORDERS o 
                                    ON 
                          b.ORDERID = o.ORDERID 
                           WHERE  b.CATALOGID = 
                                  a.CATALOGID 
                                  AND NOT 
                          EXISTS(SELECT BOOKED 
                                 FROM   BOOKEDORDERSIDS 
                                        m 
                                 WHERE 
                          Cast( 
                                m.BOOKED AS 
                          INT) = o.ORDERID) 
                                  AND ( EXISTS 
                                  (SELECT PAYMENTODATE 
                                   FROM 
                                        PAYENTMETHODVALIDATION q 
                                               WHERE 
                                  q.PAYMENTNOODATE = 
                                  o.OCARDTYPE) 
                                         OR EXISTS 
                                        (SELECT 
                                            PAYMENTODATE 
                                                   FROM 
                                            PAYENTMETHODVALIDATION 
                                            q 
                                                   WHERE 
                                        q.PAYMENTODATE = 
                  o.OCARDTYPE) 
                  AND o.ODATE IS NOT NULL ) 
                  FOR XML PATH('')), 1, 2, ''), 
                  NotProcessed = Stuff((SELECT ', ' + Cast( c.ORDERID AS VARCHAR 
                                               (10)) 
                  FROM   OITEMS c 
                  JOIN ORDERS o 
                  ON c.ORDERID = o.ORDERID 
                  WHERE  c.CATALOGID = a.CATALOGID 
                  AND ( o.OCARDTYPE IN ( 'mastercard' ) 
                  OR o.OCARDTYPE IS NULL ) 
                  AND o.ODATE IS NULL 
                  FOR XML PATH('')), 1, 2, '') 
                   FROM   OITEMS a 
                   GROUP  BY a.CATALOGID)C 
               ON B.CATALOGID = C.CATALOGID 
GROUP  BY CATALOGID, 
          ALLITEMS - NUMITEMS 
```

# c# - Neo4jClient C#如何获取所有节点

> ID：12884172
> 
> 赞同：2
> 
> 时间：2012-10-14T16:25:25.983
> 
> 标签：c#, neo4jclient

我在 C# 中使用 Neo4jClient 和 Neo4j 图形数据库，我想知道如何使用 Neo4jClient 检索所有节点。

这是检索与“KNOWS”有关系的所有节点的密码查询，与关系方向无关：

```
start n =node(*) match n-[r:KNOWS]-(friend) return friend; 
```

这是带有 Neo4jClient 的 C# 代码：

```
var client = new GraphClient(new Uri("http://localhost:7474/db/data"));
client.Connect();

var cypherFluentQueryReturned = client.RootNode
                .StartCypher("n")
                .Match("n-[:KNOWS]->friend")
                .Return<Node<Person>>("friend"); 
```

但是 Neo4jClient 不允许从 * 中检索所有节点，而只能从起点检索，这里是根节点。
我怎么能用 Neo4jClient 来检索所有节点，而不仅仅是连接到根节点的节点？

似乎没有办法通过 Neo4jClient.GraphClient 从 * 查询节点。

但是我可以通过使用 RawGraphClient 执行查询来做到这一点：

```
CypherQuery query = new CypherQuery("start n=node(*) match n-[KNOWS]-(person) return person", new Dictionary<string, object>(), CypherResultMode.Set);
var persons = ((IRawGraphClient)client).ExecuteGetCypherResults<Person>(query).ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T04:41:15.510

使用`Node<T>.StartCypher(identity)`是创建查询并一次性启动它的快捷方式。

相反，只需直接从客户端创建查询：

```
client
    .Cypher
    .Start(new { n = All.Nodes })
    .Return<object>("n") 
```

然后，您可以完全控制该`START`子句。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-06T21:34:57.143

I certainly think that the issue is because it has not yet been implemented in the NEO4JClient library, furthermore, the problem now is that the Neo4JClient team obscured ExecuteGetCypherResults, so now we will have to either implement IRawGraphClient directly or just plain using HttpWebRequest. :-/ At least that is what I concluded after seeing some info in their repository in bitbucker.

# iphone - 在 .csv 文件中搜索

> ID：12884182
> 
> 赞同：-2
> 
> 时间：2012-10-14T16:26:42.597
> 
> 标签：iphone, objective-c, xcode, search, csv

我有一个大约 10.000 行的 .csv 文件。现在我有一个文本字段，用户在其中输入值而不是单击按钮。现在这个值应该在 .csv 中搜索，然后在这个 Linie 中所有值都应该显示在标签中

例如

.csv：

PLZ, 名称, 代码 47158, Neuss, DE005116 46356, Moers, DE006151

视图控制器：

文本字段搜索：47158 标签1：Neuss 标签2：DE005116

感谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:44:35.700

1 谷歌搜索会让你开心 ;)

[http://www.macresearch.org/cocoa-scientists-part-xxvi-parsing-csv-data](http://www.macresearch.org/cocoa-scientists-part-xxvi-parsing-csv-data)

**编辑**在下面回答您的问题。

```
while ([scanner scanFloat:&myVariable] && [scanner scanFloat:&myVariable2] && [scanner scanFloat:&myVariable3]) {
   [NSMutableDictionary dictionaryWithObjectsAndKeys:
                [NSNumber numberWithFloat:myVariable], @"theKeyInTheCSV",
                [NSNumber numberWithFloat:myVariable2], @"theKeyInTheCSV2",
                [NSNumber numberWithFloat:myVariable3], @"theKeyInTheCSV3",
                nil]];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T15:10:36.473

她是我的代码：

```
-(IBAction)Zollamtsname:(id)sender{

    NSString *filePath = [[NSBundle mainBundle] pathForResource:@"Zollämter Access" ofType:@"csv"];
    NSString *myText = [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil ];
    NSLog(@"%@", [NSString stringWithContentsOfFile:filePath encoding:NSUTF8StringEncoding error:nil]);
    if ( nil == mytext ) return NO;
    NSScanner *scanner = [NSScanner scannerWithString:myText];
    [scanner setCharactersToBeSkipped:
     [NSCharacterSet characterSetWithCharactersInString:@"\n, "]];
    NSMutableArray *newPoints = [NSMutableArray array];
    float test1, test2;
    while ( [scanner scanFloat:&test1] && [scanner scanFloat:&test2] ) {
        [newPoints addObject:
         [NSMutableDictionary dictionaryWithObjectsAndKeys:
          [NSNumber numberWithFloat:test1], @"test1",
          [NSNumber numberWithFloat:test2], @"test2",
          nil]];
    }
    [self setPoints:newPoints];
    return YES;
}

//[self.Zollamzsnummer setText:@"test"]; 
```

}

我得到 4 个错误，我不知道如何解决它们 :( 1."return NO" = void 方法不应返回值 2."return YES" = void 方法不应返回值 3\. [self setPoints:newPoints]; = 不可见 @interface for 'ViewController_suche' 声明选择器 setPoints

我说 serach 值在文本字段中的是谁？

# ruby-on-rails - rails db 不会将字符串保存为 m/d/y 格式的日期？

> ID：12884196
> 
> 赞同：4
> 
> 时间：2012-10-14T16:28:43.550
> 
> 标签：ruby-on-rails, ruby-on-rails-3, date

将字符串作为日期保存到我的数据库并产生一些奇怪的结果

如果日期格式如下，

dd/mm/yy 它将保存

如果日期格式如下，

mm/dd/yy 将无法静默保存

如果我去，在我的控制台中

```
'20/10/2012'.to_date 
 => Sat, 20 Oct 2012 
```

有用

如果我走

```
'10/20/2012'.to_date
=> ArgumentError: invalid date ... 
```

它打破了

我使用初始化程序将我的默认日期格式设置为 %m/%d/%Y，您可以看到它准确地反映在我的 DATE_FORMATS 哈希中。

```
Date::DATE_FORMATS
=> {:short=>"%e %b", :long=>"%B %e, %Y", :db=>"%Y-%m-%d", :number=>"%Y%m%d", :long_ordinal=>#<Proc:0x007f8663f1aae0@/Users/ian/.rvm/gems/ruby-1.9.3-p0@rails-3.2/gems/activesupport-3.2.1/lib/active_support/core_ext/date/conversions.rb:12 (lambda)>, :rfc822=>"%e %b %Y", :default=>"%m/%d/%Y"} 
```

不确定这里问题的原因是什么，因为事情似乎配置正确。如何解决？

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:19:11.283

尝试：

```
DateTime.strptime('20/10/2012', '%d/%m/%Y') 
```

或者，如果您不需要相关时间，只需使用 Date ：

```
Date.strptime('20/10/2012', '%d/%m/%Y') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-09T09:54:59.557

使用 gem [American_date](https://github.com/jeremyevans/ruby-american_date)

在 gem 文件中 gem 'american_date'

现在它将保存 mm/dd/yyyy 日期格式。

# javascript - 以十六进制更改不透明度不起作用-热图停止渐变-

> ID：12884197
> 
> 赞同：1
> 
> 时间：2012-10-14T16:29:04.783
> 
> 标签：javascript, html5-canvas, opacity, rgba, hex

我有各种十六进制 RRGGBBAA 颜色作为热图渐变中的停止值，但我注意到为某些停止设置不同的 Alpha 值不会改变我的代码中的不透明度，我总是得到相同的视图 - 尽管设置了最后两个由于某种原因，00 的 alpha 位作为 0.0 不透明度起作用-。RRGGBBAA 值是这样写的：

`0xaa00007f` （最后两位，7f应该是0.5不透明度）

`0xaa0000ff` （ff 是 1.0 的不透明度）

采用停止值的 setGradientStops 函数是这样的 - 这是来自热图库，而不是我的代码 -

```
setGradientStops: function(stops) {

var ctx = document.createElement('canvas').getContext('2d');
var grd = ctx.createLinearGradient(0, 0, 256, 0);

for (var i in stops) {
  grd.addColorStop(i, 'rgba(' +
    ((stops[i] >> 24) & 0xFF) + ',' +
    ((stops[i] >> 16) & 0xFF) + ',' +
    ((stops[i] >>  8) & 0x7F) + ',' +
    ((stops[i] >>  0) & 0x7F) + ')');
}

ctx.fillStyle = grd;
ctx.fillRect(0, 0, 256, 1);
this.gradient = ctx.getImageData(0, 0, 256, 1).data;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:44:17.287

问题是 opacity 需要一个 0 - 1 范围内的值，而你输出的值在 0 - 127 范围内。我会尝试......

```
grd.addColorStop(i, 'rgba(' +
((stops[i] >> 24) & 0xFF) + ',' +
((stops[i] >> 16) & 0xFF) + ',' +
((stops[i] >>  8) & 0xFF) + ',' +
(((stops[i] >>  0) & 0xFF) / 255) + ')'); 
```

因此，它通过在 0xFF 而不是 0x7F 上使用 & 位运算符从表示 alpha 的部分（全部而不是几乎全部）中获取位。所以...

```
0xFF (11111111) & 0xFF (11111111) = 0xFF (11111111) = 255 
```

而不是...

```
0xFF (11111111) & 0x7F (01111111) = 0x7F (01111111) = 127 
```

然后你的值在 0 - 255 的范围内，除以 255 得到所需的范围。

```
0xFF / 255 = 1, 0x7F / 255 = 0.498, 0x00 / 255 = 0 
```

那么对于`0xaa00007f`,`grd.addColorStop`将给出字符串`'rgba(170,0,0,0.498)'`

# php - win32_query_Service_status

> ID：12884199
> 
> 赞同：2
> 
> 时间：2012-10-14T16:29:38.870
> 
> 标签：php

我正在尝试使用我从下面的 php.net 遇到的 PHP 脚本连接到远程服务器 Win 2003，并返回错误 5，即权限，当我查询 localhost 时代码运行良好。

有没有人遇到过这个问题或知道解决方法？一旦我知道我可以连接，我计划监控服务，然后能够使用监控脚本重新启动它们。

```
$servicename ="crmskidata"; 
$machine ="crm2011"; 
//print_r (win32_query_Service_status($servicename,$machine)); 

echo  $servicename; 

$sray = win32_query_Service_status($servicename,$machine); 

echo "<br>"; 

print_r ($sray); 

echo "<ul>"; 
echo "<li>Service Type: " .$sray[ServiceType] . "</li>"; 
echo "<li>CurrentState: " .$sray[CurrentState] . "</li>"; 
echo "<li>Controls Accpeted: " .$sray[ControlsAccepted] . "</li>"; 
echo "<li>Win32 Exit Code: " .$sray[Win32ExitCode] . "</li>"; 
echo "<li>Service Specific Exit Code: " .$sray[ServiceSpecificExitCode] . "</li>"; 
echo "<li>Check Point: " .$sray[CheckPoint] . "</li>"; 
echo "<li>Wait Hint: " .$sray[WaitHint] . "</li>"; 
echo "<li>Process Id: " .$sray[ProcessId] . "</li>"; 
echo "<li>Service Flags: " .$sray[ServiceFlags] . "</li>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T18:49:40.717

将 webservers mavhine 名称添加到我尝试连接的机器上的本地管理员组中。

# java - 使用 XML 文件在 hibernate 的类中设置嵌入的 id

> ID：12884203
> 
> 赞同：2
> 
> 时间：2012-10-14T16:30:02.613
> 
> 标签：java, hibernate-mapping

我想知道我们如何设置没有注释的嵌入式主键，这意味着使用休眠的映射影子文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:39:18.680

对于 Hibernate 版本 4.1：在[文档](http://docs.jboss.org/hibernate/orm/4.1/manual/en-US/html/ch05.html#mapping-declaration-id)中，您可以找到所需的示例。XML 和注解彼此相邻放置。

*   **5.1.2.1.3。具有专用标识符类型的多个 id 属性**：@IdClass 和相应的 XML 映射
*   **5.1.2.1.1。id 作为使用组件类型的属性**：@EmbeddedId 和相应的 XML 映射

# java - Java 扩展标签给出“未找到符号”错误

> ID：12884206
> 
> 赞同：0
> 
> 时间：2012-10-14T16:30:30.833
> 
> 标签：java, extend, symbols

我目前有一个带有功能 Java 类的 Java 程序。我已经创建了该类的实例来操作它们并打印它们没有任何问题，但是当我尝试从 main 方法扩展该类时，我得到一个未找到符号的错误。

```
public class Project3 extends StringInstrument{ 
```

主类是 Project3.java，另一个类是 StringInstrument.java，所以我不确定为什么 netbeans 知道 StringInstrument.java 文件在哪里创建和操作其中的实例，但找不到它来“扩展”它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:32:07.353

我的猜测是你需要找到 StringInstrument.java 所在的包。并导入它。

```
import stringInstrumentPackage.StringInstrument; 
```

# javascript - 如何使用 Javascript 和/或 jQuery 从父窗口访问 iframe 文档事件鼠标位置

> ID：12884219
> 
> 赞同：2
> 
> 时间：2012-10-14T16:32:03.283
> 
> 标签：javascript, jquery, iframe, jquery-events, mousemove

我在父窗口中有一个 iframe，iframe src 和父窗口都位于同一个域中。为了使 iframe 文档中没有 Javascript，我希望能够在父窗口中使用一个函数来获取 iframe 内的鼠标位置。

到目前为止，我在这方面的尝试包括：

```
<iframe id="iframe1" src="test.html" style="position:relative; width:500px; height:500px"></iframe>
<div id="result" style="border:1px solid black"></div>

<script>
$(document).bind("mousemove", function(e){
    $("#result").html("x:" + e.pageX + ", y:" + e.pageY);
});

$("#iframe1").contents().find(document).bind("mousemove", function(e){
$("#result", window.parent.document).html("x:" + e.pageX + ", y:" + e.pageY);
});
</script> 
```

第一个`mousemove`事件正常工作，在结果 div 中显示鼠标位置，但第二个事件（我试图绑定到 iframe 文档）没有响应。​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:49:11.577

[这](http://jsfiddle.net/sWfYm/2/)有效，除了权限部分。

**JS：**

```
$(document).bind("mousemove", function(e) {
    $("#result").html("x:" + e.pageX + ", y:" + e.pageY);
});

$($("#iframe1").contents()[0], window).bind("mousemove", function(e) {
    $("#result").html("x:" + (e.pageX) + ", y:" + e.pageY);
}); 
```

问题出在`.find()`. 我只是在内容返回的数组上使用了第一个索引，因为 iframe 应该只包含一个文档。

更新了一个更好的例子。

# xcode - 如何在 Cmake 生成的库的头文件中使用定义？

> ID：12884223
> 
> 赞同：0
> 
> 时间：2012-10-14T16:32:19.647
> 
> 标签：xcode, cmake, include, static-libraries

我有一个 Xcode 项目“App”，它引用了另一个 Xcode 项目“Lib”。

“Lib”项目由 Cmake 生成。我使用“add_definitions(-DMYDEFINE)”来设置定义。这个定义在我的 lib 项目中的一个`.h`和一个文件中使用。`.cpp`

问题出在头`.h`文件 ( ) 上。如果我在 Lib 项目中使用它，我的定义就设置好了。如果我使用我的 App 项目中的文件，则未设置定义（lib 的头文件在我的包含路径中）。

此设置/未设置同时发生，尽管头文件由“#pragma once”保护。

* * *

我需要在头文件中定义这个。有没有办法组织事物，以便我只能在 Lib 项目中使用 Cmake 设置定义？

# php - 带有 & 符号的 GDownloadUrl 作为输入字符的一部分

> ID：12884226
> 
> 赞同：0
> 
> 时间：2012-10-14T16:32:35.513
> 
> 标签：php

我有一个页面将数据发送到 .php 页面以将其插入数据库。代码如下。

```
var stringInput = "gName="+gName+"&gDescription="+gDescription+"&gPreference="+gPreference;
GDownloadUrl("insertPage.php", checkSaveGeoFenceData,stringInput,"application/x-www-form-urlencoded"); 
```

我们现在面临的唯一问题是，例如 gName 本身具有 & 签名作为信息的一部分，并且只有 & 之前的部分进入数据库。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:36:24.793

你需要`urlencode()`像这样使用

```
$gName = urlencode($gName); 
```

在`decode it afterward`你的 php 中

```
$gName = urldecode($gName); 
```

编辑

如果这是在javascript中，那么

```
var stringInput = "gName="+gName+"&gDescription="+gDescription+"&gPreference="+gPreference;

stringInput = encodeURIComponent(stringInput); 
```

# c - UNIX C 中的 gcc -lcrypt 标志错误 - 未定义对 crypt() 的引用

> ID：12884229
> 
> 赞同：3
> 
> 时间：2012-10-14T16:32:45.960
> 
> 标签：c, unix

我使用`crypt()`函数和命名`-lcrypt`问题的编译标志是编译器说未定义的引用`crypt()`。谁能告诉我我做错了什么？

**生成文件**

```
 CC = gcc
    CFLAGS=-Wall -lm -lcrypt
    OBJS = get_passwords_hashed.o
    PROG = get_passwords_hashed.exe

    #adicionar or mudar o OBJS se tiver outras files para o programa

    #GENERIC

    all:    ${PROG}

    clean:
            rm ${OBJS} *~ ${PROG}

    ${PROG}: ${OBJS}
            ${CC} ${OBJS} -o $@

    .c.o:
            ${CC} $< -c -o $@
    # $@ - turns .c into .o 
    ###################################
    #dependencias
    so_final.o: get_passwords_hashed.c get_passwords_hashed.h 
```

**主程序**

```
#include <stdio.h>
#include <string.h>
#include <crypt.h>

int testar_pass(char ant[],char (*pointer_hashes)[max_chars_string]){ // ponteiro para array de chars - char ** ant
     char * password ;
     char * encrypted;
     password = malloc(strlen(ant)*sizeof(char)); //password calculada recebida anteriror
     encrypted = malloc(strlen(ant)*sizeof(char));//hash
     strcpy(password,ant);
     encrypted = crypt(password,"10");
     if(strcmp(*pointer_hashes,encrypted) == 0){
         return 1;
         }
     else return 0;// devolve erro
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-14T16:35:12.497

`-lm -lcrypt`在编译行的末尾传递。

```
LIBS=-lm -lcrypt

${CC} ${OBJS} -o $@ ${LIBS} 
```

**编辑：**

`gcc` [从手册](https://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)中解释为什么它会有所不同（如评论中所要求的）：

> -图书馆
> 
> [...]
> 
> 在命令中编写此选项的位置有所不同；链接器按照指定的顺序搜索和处理库和目标文件。
> 
> 因此，“foo.o -lz bar.o”在文件“foo.o”之后但在“bar.o”之前搜索库“z”。如果“bar.o”引用“z”中的函数，则可能不会加载这些函数。

# caching - 当加载执行时调用无效时，google Guava LoadingCache 会做什么？

> ID：12884232
> 
> 赞同：7
> 
> 时间：2012-10-14T16:33:04.853
> 
> 标签：caching, concurrency, guava

我有一个谷歌番石榴缓存，它从数据库加载数据并使用主键缓存它。我最终从数据库创建的对象是不可变的，构建一个对象需要访问多个表。在以下情况下会发生什么：

*   线程 1：调用 cache.load(10) 并根据值为 10 的数据库主键填充缓存
*   线程 2：使用主键 10 更新数据库行，因此它调用 cache.invalidate(10) 在 cache.load(10) 完成之前调用 invalidate。

在 load(x) 执行时调用 invalidate(x) 时 Guava Loading Cache 会做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-15T08:12:42.233

当前在[Javadoc](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/cache/LoadingCache.html#get(K))中指定“在加载完成之前，不会修改与此缓存关联的可观察状态”。加载的语义进一步指定为“加载`Cache.asMap().putIfAbsent`完成后使用新加载的值添加到缓存中”。

您还可以阅读[代码](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?r=79821ec75ca4f431331acbd10b095ed0d38e52f8#3146)以查看调用 invalidate 或 remove 时忽略加载条目的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-15T08:13:27.007

你可以有两种情况：

*   线程 1 首先到达实际加载点（[`LocalCache.Segment.lockedGetOrLoad()`](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?name=v13.0.1#2266)在 13.0.1 中），并[获得](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?name=v13.0.1#2273)了段锁：在这种情况下，加载完成，[释放](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?name=v13.0.1#2327)锁并将计算值返回给调用者，但它将是线程 2 在运行 ( [`LocalCache.Segment.remove()`](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?name=v13.0.1#3117)) 并且可以[获取](http://code.google.com/p/guava-libraries/source/browse/guava/src/com/google/common/cache/LocalCache.java?name=v13.0.1#3118)锁时使其失效。

*   线程 2 在线程 1 实际开始加载之前获得了锁：失效实际上并没有做任何事情，因为条目还没有，然后线程 1 加载最新的值。

# java - 删除对可编辑 jtable 单元格的关注

> ID：12884234
> 
> 赞同：3
> 
> 时间：2012-10-14T16:33:17.803
> 
> 标签：java, swing, user-interface, jtable, tablecelleditor

当双击 jtable 的可编辑单元格时，如下所示。

![跟随](../Images/3183391e86832cfa71400146f2d5fa2d.png)

我需要的是，如果用户在输入值之前在按下按钮的表外单击鼠标，则应自动输入现有值，输出应显示如下。

![后](../Images/0cdea424bd48889cebb573498f56b586.png)

任何帮助或建议将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-14T17:30:31.867

1.  对于 DefaultTableModel 默认工作`myJTable.putClientProperty("terminateEditOnFocusLost", Boolean.TRUE)`；

2.  覆盖`stopCellEditing()`

    一种）`public boolean stopCellEditing()`

    b)`myJTable.getCellEditor().stopCellEditing();`

    C）`myJTable.getCellEditor(row, col).stopCellEditing();`

# javascript - 通过 Javascript 在 Chrome 和 Safari 中访问 SVG DOM

> ID：12884236
> 
> 赞同：2
> 
> 时间：2012-10-14T16:33:53.110
> 
> 标签：javascript, svg, webkit

我正在尝试显示缩放到对象大小的 SVG，以便缩放 600x600 svg 以适应 500x500 对象或 300x300 任何东西。这一切在 FireFox 中都可以正常工作，但 Safari 和 Chrome (Webkit) 只是裁剪 SVG

```
<div class="svg">
<object id="diagram" type="image/svg+xml" class="emb-diag" data="my.svg">
</object>
</div>

// Class method 
setViewBox : function(objectSVG, containerSize, viewboxSize)
{
    objectSVG.setAttribute("width", containerSize);
    objectSVG.setAttribute("height", containerSize);

    var svgDoc;
    if ( typeof objectSVG.getSVGDocument != 'undefined')
    {
        svgDoc = objectSVG.getSVGDocument();
        if (svgDoc == null)
        {
            svgDoc = objectSVG.contentDocument;
            if (svgDoc == null)
            {
                return;
            }
        }
    }
    else
    {
        svgDoc = objectSVG.contentDocument;
        if (svgDoc == null)
        {
            return;
        }
    }

    var svgElem = svgDoc.documentElement;
    if (svgElem)
    {
        svgElem.setAttribute("viewBox", "0 0 " + viewboxSize + " " + viewboxSize);
        svgElem.setAttribute("preserveAspectRatio", "xMinYMin meet");
    }
},

TheClass.setViewBox(document.getElementById("diagram"), 500, 600); 
```

在 Safari 中调试此行时

```
var svgElem = svgDoc.documentElement; 
```

像 Chrome 一样将 svgElem 变量解释为 HTMLHtmlElement

```
svgDoc: HTMLDocument
svgElem: **HTMLHtmlElement**
accessKey: ""
attributes: NamedNodeMap
baseURI: "about:blank"
childElementCount: 2
childNodes: NodeList[2]
children: HTMLCollection[2]
classList: DOMTokenList
className: ""
clientHeight: 500
clientLeft: 0
clientTop: 0
clientWidth: 500
contentEditable: "inherit"
dataset: DOMStringMap
dir: "" 
```

...

Chrome 确实报告了以下内容

```
Resource interpreted as Document but transferred with MIME type image/svg+xml:
"file:///my.svg". jquery.min.js:2
(anonymous function) jquery.min.js:2
f.Callbacks.o jquery.min.js:2
f.Callbacks.p.fireWith jquery.min.js:2
e.extend.ready jquery.min.js:2
c.addEventListener.B 
```

但我明白了——但为什么呢？我的谷歌搜索活动没有说明这个问题。

FireFox 将其解释为：作为正确的 SVG DOM，整个 SVG 文件可以按照您的期望进行扩展

只是先发制人，我已经走上了这条路线，更糟糕的是，这两行都返回 null svgDoc = objectSVG.getSVGDocument(); svgDoc = objectSVG.contentDocument;

FireFox 很好 Safari 和 Chrome 无法缩放

我可以通过缩放工作来做到这一点，但 svgDoc 仍然为空，但无法访问 SVG DOM，这就是我想要的。

我没有测试过 SVG 内联变体，但如果可能的话，我真的不想走那条路。

如果有人在我之前走过这条路，一路穿过灌木丛，那么您的见解将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T11:41:32.383

You shouldn't try to access the contentDocument until the onload event of the `<object>` element has fired. Try moving the TheClass.setViewBox call into the onload handler e.g.

```
<object onload="TheClass.setViewBox..." 
```

# .net - 为什么浏览器要保留这个空间？

> ID：12884242
> 
> 赞同：0
> 
> 时间：2012-10-14T16:34:52.390
> 
> 标签：.net, postback, panel

我有一点输出网格的html。就这么简单：

```
<ul>
    <li>
    </li>
    <li>
    </li>
</ul> 
```

内部 li 使用 inline-block 并排设置样式。两者都是 220px 宽，左边距为 20px；

但是我在 li 上应用了第一个子过滤器，因此总宽度将为 460px，（220 + 20 + 220）。

我想通过在其上放置 460px 的宽度来限制 ul 父级的宽度，但是当我这样做时，li 没有足够的空间来并排坐着并在彼此下方渲染。

有什么技术可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T15:00:18.517

这个问题是一个内联块问题。

它的渲染方式留下了一个空间，该空间转换为 margin-right:4px;

一种解决方法是应用负边距。

# java - JavaServer Faces 2.0 中的模板

> ID：12884244
> 
> 赞同：2
> 
> 时间：2012-10-14T16:35:01.967
> 
> 标签：java, templates, jsf-2

我第一次尝试在 Eclipse 中使用带有 JSF 2.0 的模板，但我遇到了问题。

原始`index.xhtml`页面工作正常，当我点击一个按钮时，一切正常。但是，如果我更改索引页面以使其使用模板文件，它将不再正常工作。修改后的`index.xhtml`页面在这里：

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  template="/templates/main-template.xhtml">
  <ui:define name="title">
    Simulator using JSF 2.0 - Test Version 2
  </ui:define> 
  <ui:define name="header">      
    Home Page of the Simulator using JSF 2.0 - Test Version 2
  </ui:define>
  <ui:define name="body">
    Click on the button to select the required option
    <h:outputText value="and login" rendered="#{!login.loggedIn}"/>
    <h:form prependId="false">   
      <h:commandButton value="Option 1" action="#{login.option1}"/>
      <h:commandButton value="Option 2" action="#{login.option2}"/>
      <h:commandButton value="Option 3" action="#{login.option3}"/>
      <h:commandButton value="Logout" disabled="#{!login.loggedIn}" action="#{login.logout}"/>
    </h:form>   
  </ui:define>
</ui:composition> 
```

模板文件 ,`main.template.xhtml`位于子文件夹 templates 中，在这里：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html">
  <h:head>
    <title>
      <ui:insert name="title">Title</ui:insert>
    </title>
  </h:head>      
  <h:body>
    <ui:insert name="header">Header</ui:insert>
    <br/>
    We are in template.xhtml
    <br/>
    <ui:insert name="body">Body</ui:insert>
  </h:body>
</html> 
```

如果我删除 index.xhtml 中带有“h”标签的所有代码，该文件会正确提取 templates/main-template.xhtml 中的代码，因此路径是正确的。但是，如果我在此处包含带有“h”标签的代码，Eclipse 会抱怨无法识别标签并且页面失败。

如果我`xmlns:h="http://java.sun.com/jsf/html"`在顶部包含该行，则 Eclipse 识别出“h”标签并且页面正确呈现，但是当我单击按钮时应用程序失败，并返回错误：

> javax.servlet.ServletException: javax.el.PropertyNotFoundException: /index.xhtml @15,68 action="#{login.option1}": Target Unreachable, identifier 'login' resolve to null

也许`xmlns:h="http://java.sun.com/jsf/html"`模板文件中的那一行搞砸了，但模板的整个想法是在模板文件中包含尽可能多的通用代码。

有谁知道发生了什么，解决方案是什么？

`web.xml`和是标准的`faces-config.xml`，不要认为必须对它们做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:55:57.937

您对模板应该如何工作的想法似乎是正确的，但是我们应该澄清一些要点。也许这会帮助你：

**命名空间**

关于命名空间，每当您在页面中使用标签库时，您都应该声明它是命名空间。即使您正在使用模板并且您已经在模板中声明了它们。如果有帮助，您可以认为命名空间声明不是继承的。

在这种情况下，我看到您`index.xhtml`的页面正在使用`h:commandButton`但尚未声明其命名空间。

**豆子**

对于要找到的 bean，`EL`您应该具有以下内容：

使用从包中`@ManagedBean`导入注释的类，如下所示：`javax.faces.bean.ManagedBean`

```
import javax.faces.bean.ManagedBean;

@ManagedBean
@ViewScoped
public class Login 
{
    // ...
} 
```

在这种情况下，按照约定，您的 bean 应该`EL`通过 name找到。`login`（将班级名称的第一个字母大写）

或者你可以给它一个名字：

```
import javax.faces.bean.ManagedBean;

@ManagedBean(name="login")
@ViewScoped
public class MyLoginBean
{
    // ...
} 
```

在这种情况下，按照惯例，它会被调用`myLoginBean`，但我们给了它一个名字，在这种情况下`login`，`EL`应该通过 name 找到它`login`。

如果你想使用 CDI 而不是普通的 JSF，你可以使用`@Named`注解来定义你的 bean 应该如何被找到`EL`，遵循相同的命名约定。

```
import javax.inject.Named;
import javax.enterprise.context.RequestScoped;

@Named(value="login")
@RequestScoped
public class MyLoginBean
{
    // ...
} 
```

请记住，您要`EL`查找和更改的数据必须具有正确的 getter 和 setter。

**暗示**

我建议您创建更简单的代码以测试功能。在这种情况下，您可以先测试模板，然后再测试 bean、动作等...

我希望它有所帮助。

# android - Android 中 ScrollView 中的 MotionEvent 处理

> ID：12884250
> 
> 赞同：5
> 
> 时间：2012-10-14T16:35:26.197
> 
> 标签：android, touch, scrollview, motionevent

我一直试图弄清楚 Android 中 ScrollViews 中 MotionEvents 的行为，但有些东西我无法弄清楚。

作为一个例子，我制作了一个 Activity，里面有一个 ScrollView，而 ScrollView 里面有一个 LinearLayout。我实现了自己的类来控制与触摸相关的功能：

```
 public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        MyInnerLayout inner = new MyInnerLayout(getApplicationContext());
        MyLayout layout = new MyLayout(getApplicationContext());

        layout.addView(inner,new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT));
        setContentView(layout);

    }

    @Override
    public boolean dispatchTouchEvent(MotionEvent ev) {
        Log.i("scrollview","activity dispatchTouchEvent "+ev.getAction());
        return super.dispatchTouchEvent(ev);
    };

    @Override
    public boolean onTouchEvent(MotionEvent ev) {
        Log.i("scrollview","activity on touch "+ev.getAction());
        return super.onTouchEvent(ev);
    }

    public class MyLayout extends ScrollView {

        public MyLayout(Context context) {
            super(context);
        }

        @Override
        public boolean dispatchKeyEvent(KeyEvent ev) {
            Log.i("scrollview","layout dispatchKeyEvent "+ev.getAction());
            return super.dispatchKeyEvent(ev);
        }

        @Override
        public boolean onInterceptTouchEvent(MotionEvent ev) {
            Log.i("scrollview","layout onInterceptTouchEvent "+ev.getAction());
            return false;
        }

        @Override
        public boolean onTouchEvent(MotionEvent ev) {
            Log.i("scrollview","layout on touch "+ev.getAction());
            return false;
        }

    }

    public class MyInnerLayout extends LinearLayout{

        public MyInnerLayout(Context context) {
            super(context);
        }

        @Override
        public boolean dispatchTouchEvent(MotionEvent ev) {
            Log.i("scrollview","inner layout dispatchTouchEvent "+ev.getAction());
            return true;
        }

        @Override
        public boolean onInterceptTouchEvent(MotionEvent ev) {
            Log.i("scrollview","inner layout onInterceptTouchEvent "+ev.getAction());
            return true;
        }

        @Override
        public boolean onTouchEvent(MotionEvent ev) {
            Log.i("scrollview","inner layout on touch "+ev.getAction());
            return true;
        }

    }

} 
```

当我单击屏幕上的任意位置时，我会收到以下日志：

```
10-14 18:11:48.631: I/scrollview(14906): activity dispatchTouchEvent 0
10-14 18:11:48.631: I/scrollview(14906): layout onInterceptTouchEvent 0
10-14 18:11:48.631: I/scrollview(14906): layout on touch 0
10-14 18:11:48.631: I/scrollview(14906): activity on touch 0
10-14 18:11:48.647: I/scrollview(14906): activity dispatchTouchEvent 1
10-14 18:11:48.647: I/scrollview(14906): activity on touch 1 
```

这意味着触摸事件没有进入滚动视图内的内部布局。但是，当我将 ScrollView 更改为 LinearLayout 时（只需在扩展中更改它），事件就会下降到内部布局：

```
10-14 18:24:08.975: I/scrollview(15115): activity dispatchTouchEvent 0
10-14 18:24:08.975: I/scrollview(15115): layout onInterceptTouchEvent 0
10-14 18:24:08.975: I/scrollview(15115): inner layout dispatchTouchEvent 0
10-14 18:24:09.045: I/scrollview(15115): activity dispatchTouchEvent 1
10-14 18:24:09.045: I/scrollview(15115): layout onInterceptTouchEvent 1
10-14 18:24:09.045: I/scrollview(15115): inner layout dispatchTouchEvent 1 
```

我查看[了 ScrollView 类的源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/widget/ScrollView.java)，它覆盖的唯一与触摸相关的方法是我自己覆盖的方法。所以我不明白 LinearLayout 和 ScrollView 的行为有什么区别。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-29T15:06:35.273

也许您已经弄清楚了上述行为的原因，但以防万一，原因如下。

**概述**

这`onInterceptTouchEvent()`被称为自上而下（从父级到子级），使一个视图能够在被子级处理之前拦截运动事件。

它们被`onTouchEvent()`称为自下而上（从子级到父级），直到其中一个消耗它并且循环结束。

A`ScrollView`拦截`MotionEvent`以检查它是否应该在将视图传递给孩子之前滚动视图。如果应该执行滚动，则消耗事件并且子视图什么也看不到。

在 的情况下`LinearLayout`，没有理由在 期间消耗事件`onInterceptTouchEvent()`，并​​且总是传递给子视图。

**您的代码中发生了什么**

因为`MyInnerLayout`是空的`ScrollView`，总是在消耗`MotionEvent`。

例如，如果您像这样设置内部布局背景：

```
 MyInnerLayout inner = new MyInnerLayout(getApplicationContext());
    inner.setBackground(getResources().getDrawable(R.drawable.ic_launcher));
    MyLayout layout = new MyLayout(getApplicationContext()); 
```

您会看到，如果您触摸背景图像，该事件将传递给孩子。如果您在背景图像之外触摸，该事件将被`ScrollView`.

希望这可以帮助。

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T16:15:09.657

我在滚动视图上有带有动画的视图。动画strat 和stop 等于运动事件（DOWN 和UP）。我修复了相同的解决方案：

```
public class RootActivity extends Activity implements OnTouchListener {

private View tochedView = null;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_root); 

    ((View) findViewById(R.id.btnOther)).setOnTouchListener(this);

    ScrollView scroll = (ScrollView) findViewById(R.id.scrollView);
    scroll.setOnTouchListener(new OnTouchListener() {
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if (event.getAction() == MotionEvent.ACTION_UP && tochedView != null) {
                Log.i("Touche", "ScrollView ACTION_UP");
                Animation upAnim = AnimationUtils.loadAnimation(RootActivity.this, R.anim.btn_up_anim);
                tochedView.startAnimation(upAnim);
                tochedView = null;
                return true;
            }
            return false;
        }
    });
}

private void animateView(View v, MotionEvent event) {
    if (event.getAction() == MotionEvent.ACTION_DOWN) {
        Log.i("Touche", "ACTION_DOWN");
        Animation downAnim = AnimationUtils.loadAnimation(this, R.anim.btn_down_anim);
        v.startAnimation(downAnim);
        tochedView = v;
    }
    if (event.getAction() == MotionEvent.ACTION_UP && tochedView != null) {
        Log.i("Touche", "ACTION_UP");
        Animation upAnim = AnimationUtils.loadAnimation(this, R.anim.btn_up_anim);
        v.startAnimation(upAnim);
        tochedView = null;
    }

}

@Override
public boolean onTouch(View v, MotionEvent event) {
        animateView(v, event);
} 
```

}

# assembly - 使用堆栈时组件不断出现段错误

> ID：12884251
> 
> 赞同：2
> 
> 时间：2012-10-14T16:23:44.777
> 
> 标签：assembly, x86, stack

我正在尝试学习汇编，并发现在尝试从堆栈中推送/弹出数据时，我不断收到段错误。我已经阅读了一些指南并且知道堆栈是如何工作的以及如何使用堆栈；但不知道为什么我不断收到错误。

有人可以帮忙吗？

```
segment .data
        myvar: db "hello world", 0xA0, 0
        myvarL: equ $-myvar

segment .text
        global _start

_start:
        push ebp
        mov ebp, esp
        push myvarL
        push myvar
        call _hworld

        mov eax, 1
        mov ebx, 0
        int 0x80

_hworld:
        mov eax, 4
        mov ebx, 1
        mov ecx, [ebp+4]
        mov edx, [ebp+8]
        pop ebp
        int 0x80
        ret 
```

我假设 +4 是 32 位，然后 +8 是 64 位。我不太清楚为什么在我读过的一些指南上会这样做。我会假设这`myvar`是13个字节？

这是错误：

```
$ ./pushpop 
Segmentation fault 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:00:02.173

只是一个想法

```
segment .data
    myvar: db "hello world", 0xA0, 0
    myvarL: equ $-myvar
segment .text
    global _start
_start:
    push ebp
    mov ebp, esp
    push myvarL
    push myvar
    call _hworld
    pop  ebp          // 
 //
    mov eax,1
    mov ebx,0
    int 80h  ; // exit

_hworld:
    mov eax, 4
    mov ebx, 1
    mov ecx, [ebp+4]
    mov edx, [ebp+8]
//  pop ebp               <-- this will pop the return address
    int 0x80
    ret 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:01:33.207

```
_start:
        push ebp
        mov ebp, esp ; ebp points to its old value on the stack
                     ; ebp + 4 points to the return address from _start
                     ; ebp + 8 points to 1st on-stack parameter to _start

        push myvarL ; ebp - 4 points to myvarL on stack
        push myvar ; ebp - 8 points to myvar on stack
        call _hworld

;       are we going to now execute _hworld without a call???
;       vvvv

_hworld:
        mov eax, 4
        mov ebx, 1
        mov ecx, [ebp+4] ; ebp + 4 points to return address from _start
        mov edx, [ebp+8] ; ebp + 8 points to 1st on-stack parameter to _start
;                  ^^^^ why??? 
```

顺便说一句，我不确定冒号是否在这里：`myvarL: equ $-myvar`，当然，除非`push myvarL`结果是`push 13`.

哦，还有这一行：

```
 pop ebp 
```

将从中窃取返回地址`_hworld`，因此以下`ret`将从堆栈中获取`myvar`作为返回地址并尝试`myvar`作为代码执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T23:26:09.830

我的代码出现段错误的原因是因为我在进入`_hworld`段时没有保存 esp 并且在离开时没有恢复它。

这是新的工作代码：

```
segment .data
    myvar: db "hello world", 0x0A, 0
    myvarL: equ $-myvar
    myvar2: db "super bad test", 0x0A, 0
    myvar2L: equ $-myvar2

segment .text
    global _start

_start:
    push myvarL ; store myvarL on the stack
    push myvar  ; store myvar on the stack
    call _hworld

    push myvar2L    ; store myvar2L on the stack
    push myvar2 ; store myvar2 on the stack
    call _hworld2

    mov eax, 1
    mov ebx, 0
    int 0x80

_hworld:
    push ebp    ; store the current value of ebp on the stack (hence +8)
    mov ebp, esp    ; store current esp in ebp

    mov eax, 4
    mov ebx, 1
    mov ecx, [ebp+8]    ; +4 is old ebp
    mov edx, [ebp+12]
    int 0x80

    mov esp, ebp    ; restore ebp to esp
    pop ebp     ; restore ebp
    ret

_hworld2:
    push ebp    ; store old ebp on the stack
    mov ebp, esp    ; store esp in ebp

    mov eax, 4
    mov ebx, 1
    mov ecx, [ebp +8]   ; +4 is old ebp
    mov edx, [ebp +12]
    int 0x80

    mov esp, ebp    ; restore ebp to esp
    pop ebp     ; restore ebp
    ret 
```

# android - Android 编程：如何在不同的显示器上保持图像大小？

> ID：12884252
> 
> 赞同：2
> 
> 时间：2012-10-14T16:35:41.077
> 
> 标签：android, android-layout

例如，我希望给定的位图（100x200px）始终具有以下大小：

```
 height = 1/10 of the screens height
 length = 1/20 of the screens length, 
```

无论屏幕有多大，分辨率如何。如何在不为每个可绘制文件夹创建位图版本的情况下做到这一点（我已经看到所有图片仅存储在“可绘制”文件夹中的示例，因此必须在不创建每张图片的 4 个实例的情况下使用)?

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T11:02:43.087

将您的位图加载到 ImageView 并将 ImageView 的 ScaleType 设置为“FIT_XY”，它会将您的图像缩放到您的 ImageView 的任何大小。您可以通过从 WindowManager 获取屏幕尺寸来将 ImageView 尺寸设置为相对于您的屏幕尺寸

例如：-

```
int screenWidth = getWindowManager().getDefaultDisplay().getWidth();
int screenHeight = getWindowManager().getDefaultDisplay().getHeight();

float newWidth = 0.05f * screenWidth; 
float newHeight = 0.10f * screenHeight;

imageview.setScaleType( ImageView.ScaleType.FIT_XY ); 
imageview.setLayoutParams(new LinearLayout.LayoutParams( (int)newWidth, (int)newHeight )); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:57:32.937

最终 int 宽度 = getWindowManager().getDefaultDisplay().getWidth();

最终 int 高度 = getWindowManager().getDefaultDisplay().getHeight();

然后使用 bitmapfactory 缩放图像

# asp.net - 网格视图中每一行的更新面板

> ID：12884253
> 
> 赞同：0
> 
> 时间：2012-10-14T16:35:52.937
> 
> 标签：asp.net, datagridview

我有一个包含文本框和按钮的 asp 网格视图。我为文本框设置了一个必填字段验证器。但是在单击按钮时，我单击的按钮的文本框没有显示必填字段验证器（当文本框为空时）。是否有根据我单击的按钮显示文本框的验证器？同样，当我单击按钮时，即使文本框为空，为按钮设置的命令也会执行。我还把项目模板放在更新面板中，这样页面就不会引用。

# mysql - MySQL 在大数据上的查询速度非常慢

> ID：12884263
> 
> 赞同：2
> 
> 时间：2012-10-14T16:36:46.587
> 
> 标签：mysql, pdo

我不是 MySQL 高手，但我明白了，我刚刚继承了一个非常大的表（600,000 行和大约 90 列（请杀了我......））并且我创建了一个较小的表来链接它一个类别表。

我正在尝试使用左连接查询所述表，因此我将两组数据都放在一个对象中，但运行速度非常慢，而且我还不够热，无法对其进行排序；对于它为什么这么慢，我真的很感激一些指导和解释。

```
SELECT 
    `products`.`Product_number`,
    `products`.`Price`,
    `products`.`Previous_Price_1`,
    `products`.`Previous_Price_2`,
    `products`.`Product_number`,
    `products`.`AverageOverallRating`,
    `products`.`Name`,
    `products`.`Brand_description`
FROM `product_categories`
LEFT OUTER JOIN `products`
ON `products`.`product_id`= `product_categories`.`product_id`
WHERE COALESCE(product_categories.cat4, product_categories.cat3,
product_categories.cat2, product_categories.cat1) = '123456'
AND `product_categories`.`product_id` != 0 
```

这两个表是 MyISAM，products 表在 Product_number 和 Brand_Description 上有索引，product_categories 表在所有组合列上都有唯一索引；如果此信息有任何帮助。

继承了这个系统后，我需要尽快让这个系统正常工作，然后才能正确地操作它，所以现在的任何帮助都会为您赢得我最大的尊重！

[编辑] 这是解释扩展的输出：

```
+----+-------------+--------------------+-------+---------------+------+---------+------+---------+----------+--------------------------+
| id | select_type | table              | type  | possible_keys | key  | key_len | ref  | rows    | filtered | Extra                    |
+----+-------------+--------------------+-------+---------------+------+---------+------+---------+----------+--------------------------+
|  1 | SIMPLE      | product_categories | index | NULL          | cat1 | 23      | NULL | 1224419 |   100.00 | Using where; Using index |
|  1 | SIMPLE      | products           | ALL   | Product_id    | NULL | NULL    | NULL |  512376 |   100.00 |                          |
+----+-------------+--------------------+-------+---------------+------+---------+------+---------+----------+--------------------------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:04:10.550

## 优化表

要建立基线，我首先建议[`OPTIMIZE TABLE`](http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html)在两个表上运行一个命令。请注意，这可能需要一些时间。从[文档](http://dev.mysql.com/doc/refman/5.1/en/optimize-table.html)：

> `OPTIMIZE TABLE`如果您删除了表的大部分，或者您对具有可变长度行的表（具有`VARCHAR, VARBINARY, BLOB`或`TEXT`列的表）进行了许多更改，则应该使用。删除的行保存在链表中，后续`INSERT` 操作重用旧的行位置。您可以使用它`OPTIMIZE TABLE`来回收未使用的空间并对数据文件进行碎片整理。在对表进行大量更改后，**此语句还可以提高使用该表的语句的性能，有时会显着提高。**
> 
> [...]
> 
> 对于 MyISAM 表，`OPTIMIZE TABLE`工作方式如下：
> 
> 1.  如果表已删除或拆分行，请修复表。
>     
>     
> 2.  如果索引页未排序，请对其进行排序。
>     
>     
> 3.  如果表的统计信息不是最新的（并且无法通过对索引进行排序来完成修复），请更新它们。

## 索引

[如果空间和索引](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)管理不是问题，您可以尝试在

```
product_categories.cat4, product_categories.cat3, product_categories.cat2, product_categories.cat1 
```

如果您在查询中**经常**使用这些列的最左侧子集，则会建议您这样做。查询计划表明它可以使用 的`cat1`索引`product_categories`。这很可能只包括该`cat1`列。通过将所有四个类别列添加到索引中，它可以更有效地查找所需的行。从[文档](http://dev.mysql.com/doc/refman/5.0/en/multiple-column-indexes.html)：

> MySQL 可以将多列索引用于测试索引中所有列的查询，或者只测试第一列、前两列、前三列等的查询。如果在索引定义中以正确的顺序指定列，则单个复合索引可以加快对同 一张表**的多种查询。**

## 结构

此外，鉴于您的表有**90 列**，您还应该知道[更宽的表会导致查询性能变慢](http://www.mysqlperformanceblog.com/2006/06/09/why-mysql-could-be-slow-with-large-tables/)。您可能需要考虑将表[垂直分区](http://apheliondynamics.com/blog/2010/02/11/database-optimization-vertical-partitioning-in-mysql/)为多个表：

> 列过多会使您的记录大小膨胀，进而导致更多的内存块被读入和读出内存，从而导致更高的 I/O。这可能会损害性能。解决此问题的一种方法是将您的表拆分为更小、更独立的表，其基数比原始表更小。这现在应该允许更好的阻塞因子（如上定义），这意味着**更少的 I/O 和更快的性能**。像这样拆分表的过程称为*Vertical Partition*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T19:39:22.677

您查询的意思似乎是“查找所有类别为 '123456' 的产品”。那是对的吗？

`COALESCE`是一个在`WHERE`语句中使用的非常昂贵的函数，因为它对索引敌对的 NULL 值进行操作。您的解释结果表明您的查询对您的 product_categories 表不是很有选择性。在 MySQL 中，如果您想利用索引来加快查询速度，则需要完全避免 WHERE 语句中的函数。

其他人所说的关于 90 列表有害的事情也是正确的。但是你被它困住了，所以让我们处理它。

我们可以修改您的查询以摆脱基于函数的查询`WHERE`吗？让我们试试这个。

```
SELECT  /* some columns from the products table */
  FROM products
 WHERE product_id IN 
 (
     SELECT DISTINCT product_id 
                FROM product_categories
               WHERE product_id <> 0
                 AND (   cat1='123456'
                      OR cat2='123456'
                      OR cat3='123456'
                      OR cat4='123456')
 ) 
```

为此，您需要在四个 cat 列上创建单独的索引。复合唯一索引（“在所有列上组合”）对您没有帮助。它仍然可能不是那么好。

更好的解决方案可能是在布尔模式下进行全文搜索。您正在使用 MyISAM 访问方法，因此这是可能的。这绝对值得一试。它确实可能非常快。

```
SELECT  /* some columns from the products table */
  FROM products
 WHERE product_id IN 
 (
     SELECT product_id 
       FROM product_categories
      WHERE MATCH(cat1,cat2,cat3,cat4) 
            AGAINST('123456' IN BOOLEAN MODE)
        AND product_id <> 0

 ) 
```

为此，您需要像这样创建一个 FULLTEXT 索引。

```
 CREATE FULLTEXT INDEX cat_lookup 
                    ON product_categories (cat1, cat2, cat3, cat4) 
```

请注意，这些建议的查询都不会产生与您的查询完全相同的结果`COALESCE`。您的`COALESCE`查询设置方式，某些组合将不匹配将匹配这些查询。例如。

```
 cat1     cat2     cat3     cat4   
  123451   123453   123455   123456      matches your and my queries
  123456   123455   123454   123452      matches my queries but not yours 
```

但我的查询很可能会产生有用的产品列表，即使它在您的产品中有更多项目。

您可以通过使用 product_categories 上的内部查询来调试这些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:08:17.797

有什么奇怪的。该表是否`product_categories`确实有一`product_id`列？`from`和子句不应该`where`是这样的：

```
FROM `product_categories` pc 
LEFT OUTER JOIN `products` p ON p.category_id = pc.id
WHERE 
    COALESCE(product_categories.cat4, product_categories.cat3,product_categories.cat2, product_categories.cat1) = '123456'
    AND pc.id != 0 
```

# c# - 在模型中获取嵌套列表

> ID：12884267
> 
> 赞同：0
> 
> 时间：2012-10-14T16:36:54.823
> 
> 标签：c#

我有两个看起来像这样的对象模型：

```
public class MyObject
{
   public List<SomeOtherObject> TheListOfSomeOtherObjects { get; set; }
}

public class SomeOtherObject
{
   long SomeOtherObjectID { get; set; }
} 
```

我有一个`MyObjects`被调用列表`ListOfMyObjects`，我想从中提取`SomeOtherObjectID`列表中的所有内容`TheListOfSomeOtherObjects`

我想写这样的东西：

```
var ListOfAllSomeOtherObjectID = (from l in ListOfMyObjects
                           select l.SomeOtherObject.SomeOtherObjectID ).ToList(); 
```

由于语法，它不起作用。如何获取嵌套列表的列表？

感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:42:05.817

您正在尝试展平嵌套列表：

```
var allChildren = myObjects.SelectMany(o => o.ChildObjects).ToList(); 
```

如果你想获得这些对象的属性，你需要一个单独的`Select()`调用：

```
var allChildren = myObjects.SelectMany(o => o.ChildObjects)
                           .Select(c => c.SomeProperty)
                           .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:48:33.633

您可以执行以下操作：

```
var ids = l.SelectMany(o => o.TheListOfSomeOtherObjects).Select(o => o.SomeOtherObjectID); 
```

从列表列表中`SelectMany`创建一个扁平列表。

`ToList()`如果需要列表，请添加。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-14T16:48:24.760

尝试一下

```
var listSOOIds = listOfMyObjects.TheListOfSomeOtherObjects.Select(s => s.SomeOtherObjectID).ToList(); 
```

# c# - 使用datagridview C#更新数据库中的数据

> ID：12884271
> 
> 赞同：1
> 
> 时间：2012-10-14T16:37:09.377
> 
> 标签：c#, database, insert, updates

我的代码在使用`DataGridView`.

我有一个错误`da.update(dt);`它说，

> *对于不返回任何键列信息的 SelectCommand，不支持为 UpdateCommand 生成动态 SQL。*

当我将 更改为`SELECT`时，`UPDATE/INSERT`出现错误`da.fill(dt);`。

我的代码有什么问题？

这是我的代码：

```
private void btnEdit_Click(object sender, EventArgs e) > {
    con.Open();
    DataTable dt = new DataTable();
    SqlDataAdapter da = new SqlDataAdapter("SELECT * FROM RegistrationTable", con);
    da.Fill(dt);
    dt.Rows[dgvREGtable.CurrentRow.Index].BeginEdit();
    dt.Rows[dgvREGtable.CurrentRow.Index][0] = tbFirstname.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index][1] = tbLastname.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index][2] = tbEmail.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index][3] = tbContacts.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index][4] = tbUsername.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index][5] = tbPassword.Text;
    dt.Rows[dgvREGtable.CurrentRow.Index].EndEdit();
    SqlCommandBuilder cb = new SqlCommandBuilder(da);
    da.Update(dt);
    displayrecords();
    con.Close();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T16:47:20.013

您的选择查询需要返回表的主键。如果您的表没有主键，则需要设置一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T16:47:49.373

在我看来，实现这一点的最简单方法是将 DataGridView 实际绑定到您的数据集，然后绑定将为您处理所有丑陋的东西。例如：

```
DataSet mydata = new DataSet();
// populate your dataset however you like
DataBindingSource mybindingsource = new DataBindingSource(typeof(DataSet));
mybindingsource.DataSource = mydata;
DataGridView mydatagridview = new DataGridView();
mydatagridview.DataSource = mybindingsource; 
```

这就是本质的方式，但设计师更容易实现这一点。

# wordpress - Bootstrap 浏览器的区别

> ID：12884273
> 
> 赞同：0
> 
> 时间：2012-10-14T16:37:30.190
> 
> 标签：wordpress, twitter-bootstrap

我正在制作一个带有 wordpress [Roots 主题的网站（Twitter Bootstrap）](http://demo.rootstheme.com/)

但是，我在标题方面遇到了一些问题。在 chrome、firefox、opera、safari 中，首页如下所示：

![在此处输入图像描述](../Images/cd1ebba7297720424068e59acbfea436.png)

页脚和页眉之间也存在阴影差异，它们都应该有#ff7300。

在 IE 上看起来像这样

![在此处输入图像描述](../Images/9dc9c3860b545aea2d91c7ec14fedeeb.png) 标题根本没有橙色，我想知道为什么。我很确定它有背景图像或其他东西，但我没有运气删除它。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:49:49.963

该规则`filter:...`在 bootstrap.css 中有一个。`.navbar-inner`这仅在 IE 中运行，它负责将顶部的橙色更改为您仅在 IE 中看到的浅灰色。

我可以看到颜色差异，但我无法隔离它。奇怪的。

# jquery - 禁用 jquery 移动表单按钮操作

> ID：12884275
> 
> 赞同：0
> 
> 时间：2012-10-14T16:37:39.797
> 
> 标签：jquery, jquery-mobile

> **可能重复：**
> [jQuery Mobile 中的 AJAX 表单提交](https://stackoverflow.com/questions/8012751/ajax-form-submission-in-jquery-mobile)

我有一个表单，我使用 jQuery 来检查和验证表单，这样，如果表单为空，它不会提交表单，只会提示“请填写所有字段”。

```
function doShowError( eForm, sField, iInd, sError ) {
    var $Field = $( "[name='" + sField + "']", eForm ); // single (system) field
    if( !$Field.length ) // couple field
        $Field = $( "[name='" + sField + '[' + iInd + ']' + "']", eForm );
    if( !$Field.length ) // couple multi-select
        $Field = $( "[name='" + sField + '[' + iInd + '][]' + "']", eForm );
    if( !$Field.length ) // couple range (two fields)
        $Field = $( "[name='" + sField + '[' + iInd + '][0]' + "'],[name='" + sField + '[' + iInd + '][1]' + "']", eForm );

    //alert( sField + ' ' + $Field.length );

    $Field.parents('div:first').addClass( 'error' );

    $Field
    .parents('div:first')
        .addClass( 'error' )
        .children( 'img.warn' )
            .attr('float_info', sError)
            //.show()
            ;
} 
```

现在，问题是，每当我点击提交按钮时，我都会被重定向到页面（应该是 user-panel ），其中只有一条文字：

> 不明确的

如何禁用默认情况下 jQuery 按钮的功能？

**编辑：** 我的事件触发并且消息显示，但我仍然被重定向到表单属性中定义的 URL `action`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T22:24:38.880

在您验证表单字段的函数中（应在`submit`事件中调用），您需要`true`在验证成功的情况下返回，`false`否则。

这样，您可以防止表单`action`在验证失败时导航到属性中定义的 URL。

你可以尝试这样的事情：

```
$(function() {
    $("#your_form").submit(function() {
        // Define `sField`
        var sField = // SOMETHING

        // Define `iInd`
        var iInd = // SOMETHING

        // Define `sError`
        var sError = // SOMETHING

        return doShowError($(this), sField, iInd, sError);
    });
}); 
```

where`#your_form`是表单的 ID，`doShowError()`是验证表单输入的函数，`true`如果所有字段都正常则返回，`else`反之亦然。

在这种情况下，您可能需要修改您的函数`doShowError`以使其返回`true`或`false`如上所述。你可以把它改成这样：

```
function doShowError( eForm, sField, iInd, sError ) {

    // `haserror`: boolean output which will equal `true` 
    // if all the fields are correct, and `else` otherwise
    var haserror = true;

    var $Field = $( "[name='" + sField + "']", eForm ); // single (system) field
    if( !$Field.length ) { // couple field
        $Field = $( "[name='" + sField + '[' + iInd + ']' + "']", eForm );
        haserror = false;
    }
    if( !$Field.length ) { // couple multi-select
        $Field = $( "[name='" + sField + '[' + iInd + '][]' + "']", eForm );
        haserror = false;
    }
    if( !$Field.length ) { // couple range (two fields)
        $Field = $( "[name='" + sField + '[' + iInd + '][0]' + "'],[name='" + sField + '[' + iInd + '][1]' + "']", eForm );
        haserror = false;
    }

    //alert( sField + ' ' + $Field.length );

    $Field.parents('div:first').addClass( 'error' );

    $Field.parents('div:first')
        .addClass( 'error' )
        .children( 'img.warn' )
            .attr('float_info', sError)
            //.show()
            ;

    return haserror;
} 
```

# ssis - 导入 varbinary 数据

> ID：12884276
> 
> 赞同：0
> 
> 时间：2012-10-14T16:37:41.607
> 
> 标签：ssis

在我们使用导出列 comp.( [https://stackoverflow.com/questions/12712632/export-varbinarymax-column-with-ssis](https://stackoverflow.com/questions/12884276/import-varbinary-data) ) 后，我们要将平面文件导入数据库。当我尝试导入 varbinary 列（甚至到带有 varbinary 列的测试表）时，一个 FF 字符被无缘无故地添加到 varbinary 数据中（最后）。为了导入我在平面文件属性中选择的文件，下一个选项：unicode，未签名第一个数据行和列选项卡中的列名，我添加了一个 {|}{@}{|} 行分隔符以获得一行一列。当我运行packg时。in 在末尾插入带有 FF 尾随的 varbinary 数据，当然细节是无效的。你知道这些角色是从哪里出现的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T21:08:30.350

Unless I'm misunderstanding the layout of your file (all the data is in a single file) and 1 file = 1 row in the target table. With that assumption in place, you'll want to do much as I described in this answer on [insert XML file in SQL via SSIS](https://stackoverflow.com/questions/12817099/insert-xml-file-in-sql-via-ssis)

In the section where I note "Make note of the ID here" change the data type from NTEXT to IMAGE and everything else should work the same.

# php - 如何获取父子类别项目计数？

> ID：12884277
> 
> 赞同：1
> 
> 时间：2012-10-14T16:37:44.897
> 
> 标签：php, mysql, codeigniter

我基本上是在尝试制作一个类别列表，其中包含一系列类别及其子类别。

我目前的查询是：

```
SELECT category.lc_name AS name,COUNT(listings.ls_cat_id) AS post_count
FROM listings_categories AS category
LEFT JOIN listings ON listings.ls_cat_id = category.lc_id 
GROUP BY category.lc_id ORDER BY name ASC 
```

它工作得很好，但是我希望将子类别项目或帖子计数添加到其父类别中。

例如：

```
id | category | parent | Count
1      Auto        0       3
2      Auto A      1       1
3      Auto B      1       1
4      Auto C      1       1 
```

我只能使用一个查询在 mysql 中执行此操作吗？

表结构

```
listings - ls_id,ls_cat_id,ls_title
listings_categories - lc_id,lc_parent,lc_name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T02:59:15.907

我刚刚找到了正确的答案。

```
SELECT category.lc_name AS name,

COUNT(listings.ls_cat_id) + (

    SELECT COUNT(listings.ls_cat_id) FROM listings_categories AS subcategory
    LEFT JOIN listings ON listings.ls_cat_id = subcategory.lc_id
    WHERE category.lc_id = subcategory.lc_parent
) AS count

FROM listings_categories AS category
LEFT JOIN listings ON listings.ls_cat_id = category.lc_id
GROUP BY category.lc_id ORDER BY name ASC 
```

我刚刚将当前计数添加到另一个将当前类别 id 匹配到新选择语句的父类别 id 的 select 语句中。

```
"name"  "count"
"auto detailing"    "0"
"auto insurance"    "1"
"auto mechanic" "1"
"auto painting" "0"
"auto sales and parts"  "0"
"automotive"    "3"
"business"  "0"
"dental clinics"    "0"
"fashion"   "0"
"health and medicine"   "0"
"health insurance"  "0"
"home and garden"   "0"
"hospital"  "0"
"jobs and employment"   "0" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T11:57:13.387

ok, i've made a number of assumptions here, which may or may not be true and depend on your schema and data, but something like this should work:

```
select numListings, lc_name from
(
    SELECT
    IF(lc_parent = 0, lc_id, lc_parent) AS lc_parent_id, COUNT(ls_id) as numListings
    FROM listings_categories
    LEFT JOIN listings ON listings.ls_cat_id = listings_categories.lc_id
    group by lc_parent_id
) catList
inner join listings_categories on catList.lc_parent_id = listings_categories.lc_id; 
```

this assumes:

*   if a category has no parent, the lc_parent column value is 0
*   there are only 2 levels of categories - ie. parents & children, no grandchildren
*   you only want to show results for parent categories

let me know if any of these assumptions are incorrect and i can adjust the query.

# visual-studio-2010 - 从 Visual Studio 外部使用 NuGet PowerShell 命令行开关

> ID：12884282
> 
> 赞同：36
> 
> 时间：2012-10-14T16:38:55.477
> 
> 标签：visual-studio-2010, powershell, nuget

我试图在 Visual Studio 2010 的包管理器控制台中使用我最喜欢的源代码控制。我遇到了另一个[主题](https://stackoverflow.com/questions/12862891/using-git-from-package-manager-console-in-visual-studio)中描述的问题。目前最好的答案是将所有命令行内容从 Visual Studio 移动到裸 PowerShell。

但在这种情况下，Visual Studio 相关的命令行开关不起作用。例如，最关键的一个 - 我无法从[Entity Framework](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)`Update-Database`运行命令。

是否可以在 PowerShell 中以某种方式为当前项目注册 Visual Studio 特定的命令行开关？或者让 PowerShell 自动从`packages`子文件夹中获取当前项目上下文？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-15T06:57:55.413

NuGet PowerShell 命令依赖于在 Visual Studio 中运行，因此无法在从命令行运行的普通 PowerShell 中运行。

但是，您可以使用EntityFramework NuGet 包附带的[migrate.exe](http://msdn.microsoft.com/en-us/data/jj618307.aspx)并从命令行使用它来更新您的数据库。

作为原型，我整理了一种[使用 SharpDevelop 从普通 PowerShell 命令行中使用 NuGet PowerShell 命令的方法](http://community.sharpdevelop.net/blogs/mattward/archive/2011/06/12/InstallingNuGetPackagesOutsideVisualStudio.aspx)。不幸的是，EntityFramework NuGet 包目前不适用于 SharpDevelop。

另一个有趣的项目是[StudioShell](http://studioshell.codeplex.com/)，它在 Visual Studio 中提供了一个新的 DTE：驱动器，但也可以在命令行之外使用。我不相信它支持从普通 PowerShell 命令行运行的 NuGet PowerShell 命令。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-07T17:30:10.843

我可以在以下位置找到 NuGet.psd1 文件：

`C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\Extensions\5ttpefif.3mk\Modules\NuGet\NuGet.psd1.`

但是，当您尝试加载它时：

```
PS> Import-Module $pathToNuGetPsd1 -Force -NoClobber -Scope Global
Import-Module : The name of the current Windows PowerShell host is: 'ConsoleHost'.
The module 'C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\
Extensions\5ttpefif.3mk\Modules\NuGet\NuGet.psd1' requires the following Windows
PowerShell host: 'Package Manager Host'. 
```

我认为我们不走运。它必须从包管理器主机运行，并且需要来自 Visual Studio 的东西，如 Matt 所述。

为了解决我的问题，我使用 Chocolatey 安装 NuGet.CommandLine，然后使用 NuGet.bat 来完成我需要的操作。它需要做更多的工作，并且可能并非在所有情况下都有效，具体取决于您要执行的操作。

巧克力：[https ://github.com/chocolatey/chocolatey/wiki/Installation](https://github.com/chocolatey/chocolatey/wiki/Installation)

NuGet.命令行：

```
PS> cinst NuGet.CommandLine 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-14T18:12:54.560

我对 Visual Studio cmdlet 不是很熟悉，但您可以使用`Import-Module -Name <ModuleName>`. 您可以使用“Get-Module -ListAvailable”列出可用的（又名“已安装”）PowerShell 模块。

我的猜测是 Visual Studio cmdlet 包含在它自己的 PowerShell 模块中，但很可能它没有“安装”到`$env:PSModulePath`. 如果是这种情况，那么您可能需要找到模块目录并直接导入 .psd1 或 .psm1 文件，并将其传递到：`Import-Module -Name <FullPathToModuleFile>`。

作为上述示例，请注意 Windows Azure PowerShell 模块的位置：[http ://trevorsullivan.net/2012/06/07/introducing-microsofts-official-windows-azure-powershell-module/](http://trevorsullivan.net/2012/06/07/introducing-microsofts-official-windows-azure-powershell-module/)

它位于 Program Files 目录下，并且不能立即用于 PowerShell，除非您从其完全限定路径（.psd1 模块清单文件）导入模块。

希望这可以帮助。

# javascript - 使用 javascript 遍历图像文件夹并将结果添加到 HTML

> ID：12884284
> 
> 赞同：2
> 
> 时间：2012-10-14T16:39:15.947
> 
> 标签：javascript, html

嘿，我正在想办法给我的网页添加一些媒体（图像和视频）。我有一个部分，我只添加图像和视频，它是基于 HTML 的所以我想我可以找到一种方法来为每个部分创建一个文件夹，在该文件夹中添加所有媒体，然后让 Javascript 完成工作. 这是我到目前为止想出的脚本。

**Javascript**

```
var files = {'jpg':4};
var pageName = "Wimoveh";
for (var ext in files){
for (var i = 0; i < files[ext]; i++){
    var src = "Images/GalleryOne" + pageName + "-" + (i+1) + "." + ext;}
} 
```

此脚本在文件夹 GalleryOne 中查找名称为 Wimoveh 且以“-”作为分隔符的图片，然后遍历与该名称和扩展名匹配的所有内容。我不知道如何在我的 HTML 中输出结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:42:51.293

在你的循环内：

```
var img = new Image(); 
img.src = src;
containerElement.appendChild(img); 
```

其中 containerElement 是对要添加图像的 html 元素的引用。（请注意，您需要延迟到 dom 加载后才能这样做）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-20T09:42:09.863

正如 Generalhenry 在他的帖子中所说：

> 其中 containerElement 是对要添加图像的 html 元素的引用。（请注意，您需要延迟到 dom 加载后才能这样做）

containerElement 是您想要的任何 HTML 元素。例如：

```
<HTML>
<BODY>
    <div class="photos">
        Your images would populate here.
    </div>
</BODY>
</HTML> 
```

当代码到达 photos.appendChild(IMG) 时，每次循环通过您的脚本，您的页面都会将图像添加到该 div 类。

# android - 不同的振动强度：VIBE 应用程序是如何做到的？

> ID：12884286
> 
> 赞同：0
> 
> 时间：2012-10-14T16:39:48.160
> 
> 标签：android, vibration, android-vibration

我知道，鉴于振动是如何实现的，改变强度的唯一方法是控制电机的 RPM。我可以看到[振动器类](http://developer.android.com/reference/android/os/Vibrator.html)不允许这样做，但是，VIBE 应用程序[（请参阅此视频）](http://youtu.be/TNGE0PEDcA4)似乎正在实现这一点。在视频中，大约在 0:35，“创造自己的氛围”被简要展示。我测试了它，老天，它似乎在改变强度。难道他们正在使用 NDK 进行直接电机控制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T17:26:23.117

ViBe 使用[Immersion Haptic SDK](http://www.immersion.com/products/haptic-sdk/)来控制设备振动。Immersion 自己在内部使用 Android NDK。

# javascript - 从日期获取整周

> ID：12884291
> 
> 赞同：2
> 
> 时间：2012-10-14T16:40:26.103
> 
> 标签：javascript, date

我正在尝试查找基于单个日期形成一整周的所有日期。

因此，如果日期位于一周的中间（如星期三），它将返回星期日、星期一，直到星期六。

这是一个例子：

所以假设我有**Wed 10 Oct 2012**。

我会将此日期对象传递给函数并且函数将返回`['2012-10-07', '2012-10-08', '2012-10-09', '2012-10-10', '2012-10-11', '2012-10-12', '2012-10-13']`（我不想要字符串，但日期对象，字符串只是为了示例^^

我已经尝试过自己，但是我创建的方法很长而且很笨，无论如何：[https ://gist.github.com/3889121](https://gist.github.com/3889121)

但我在这里主要寻找的是说明。用什么，有没有更简单的方法？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:07:46.250

这是一个函数，它返回从给定日期之前的第一个星期日到下一个星期日的 Date 实例数组：

```
function getWeek(fromDate){
 var sunday = new Date(fromDate.setDate(fromDate.getDate()-fromDate.getDay()))
    ,result = [new Date(sunday)];
 while (sunday.setDate(sunday.getDate()+1) && sunday.getDay()!==0) {
  result.push(new Date(sunday));
 }
 return result;
}
// usage
var week = getWeek(new Date('2012/10/10'));
console.log(week[0]); //=> Sun Oct 07 2012 00:00:00
console.log(week[6]); //=> Sat Oct 13 2012 00:00:00 
```

只是为了好玩，一个较短的版本（oneliner）使用`Array.map`, 作为`Date.prototype`

```
Date.prototype.getWeek = function(){
 return [new Date(this.setDate(this.getDate()-this.getDay()))]
          .concat(
            String(Array(6)).split(',')
               .map ( function(){
                       return new Date(this.setDate(this.getDate()+1));
                     }, this )
          );
}
// usage 
new Date('2012/10/10').getWeek(); //=> [07/10/2012, ... ,13/10/2012] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T16:51:46.357

尝试这个：

```
 var date = new Date('2012/06/25');
 var day = date.getDay();
 var array = []
 for(var i=0;i<7;i++){
    if(i-day!=0){
      var days = i-day;
      var newDate =   new Date(date.getTime()+(days * 24 * 60 * 60 * 1000));
      array.push(newDate);
 }
    else 
    array.push(date);
 }
 alert(array);​ 
```

**[工作小提琴](http://jsfiddle.net/sazn8/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T16:56:19.360

使用 Date.js 库[http://www.datejs.com](http://www.datejs.com) 你可以这样做

```
someDate.next().sunday() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-18T18:13:21.057

这可能对你有帮助，你可以输入 yeat:int、month:int 和 day:int，它会找到最近的最后一个星期天然后加上 7 天。最后它将返回一个日期范围。您可能需要修改输出以满足您的需要。如果您的月份 int 数组从 1 变为 12，请保留 _monthint - 1 否则您可以将其删除。

```
var moment = require('moment');

let getDatesSundayTo7DaysAheadFromADay = function( _yearint, _monthint, _dayint ){
    var input = new Date(_yearint, _monthint - 1, _dayint)
    let getLastSunday = function (d) {
        var t = new Date(d);
        t.setDate(t.getDate() - t.getDay());
        return t;
      }
    let lastsunday = getLastSunday(input)
    let addDays = function(dateObj, numDays) {
        var newdate = JSON.parse(JSON.stringify(dateObj));
        for(var i = 1; i < numDays ; i++){
            newdate =  moment(newdate).add(1, 'days')
        }
        return newdate
      }
    let sevendaysahead = addDays(lastsunday, 7)
    function getDates(startDate, stopDate) {
        var dateArray = [];
        var currentDate = moment(startDate);
        var stopDate = moment(stopDate);
        while (currentDate <= stopDate) {
            dateArray.push( moment(currentDate).format('YYYY-MM-DD') )
            currentDate = moment(currentDate).add(1, 'days');
        }
        return dateArray;
    }
    return getDates(lastsunday, sevendaysahead);
} 
```

# ruby-on-rails - Mongoid 中的父/母/子关系？

> ID：12884292
> 
> 赞同：1
> 
> 时间：2012-10-14T16:40:29.783
> 
> 标签：ruby-on-rails, many-to-many, self-reference, mongoid3

我有与这里描述的相同的问题[has_many ：通过多个 has_one 关系？](https://stackoverflow.com/questions/4987541/has-many-through-multiple-has-one-relationships)

但我使用 Mongoid 而不是 ActiveRecord。而且我在关系 has_one 方面有问题，因为他们没有 :through。

如何解决这个问题呢？还是拒绝上述解决方案？

PS：我使用的是 rails 3.2.8 和 mongoid 3。

谢谢

# java - 项目流程

> ID：12884294
> 
> 赞同：2
> 
> 时间：2012-10-14T16:40:44.160
> 
> 标签：java, jakarta-ee, architecture, flow

我目前正在从事java项目。我一次处理许多项目。我使用`eclipse IDE`这些应用程序来编写涉及 spring、hibernate、flex 技术的应用程序。每次我在一个新项目中工作时，我都必须花一些时间分析代码流（这是一项乏味且耗时的任务）。`repo`当我们从本地系统检查并配置代码库时，是否有一个工具可以创建一个文档或流程图来说明它的内聚和耦合（只是它的架构） ？

你的想法会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:44:32.463

您可能想在 Eclipse 中试用 TPTP 分析器。如果您在分析模式下启动应用程序并使用它一段时间，分析器插件将为您绘制在您使用应用程序时发生的类之间的交互。

# c++ - 如何关闭所有选项卡但在 Qt4（QTabWidget）中处于活动状态

> ID：12884296
> 
> 赞同：2
> 
> 时间：2012-10-14T16:40:59.823
> 
> 标签：c++, c, qt, qt4

`QTabWidget`当我知道活动选项卡索引和选项卡计数时，如何关闭所有选项卡但处于活动状态？关闭所有标签的功能是`tabwidget->clear();`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:49:40.293

你试过这个吗？

```
// remove all tabs after current
for (int i = tabWidget.count() - 1; i > tabWidget.currentIndex(); --i) {
   tabWidget.removeTab(i);
}

// current tab is now the last, therefore remove all but the last
for (int i = tabWidget.count(); i > 1; --i) {
   tabWidget.removeTab(0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-19T21:58:13.543

工作解决方案，这个来自的类继承了QTabWidget：

```
void closeOtherTabsRequested(int index)
{
    auto selectedWidget = widget(index);
    auto tabCount = mTabBar->count();
    for(auto i = tabCount - 1; i >= 0; i--) {
        auto currentWidget = widget(i);
        if(currentWidget != selectedWidget) {
            tabCloseRequested(i);
        }
    }
} 
```

# asp.net - 链接点击在 MVC4 jquery mobile 中没有一致地注册

> ID：12884298
> 
> 赞同：2
> 
> 时间：2012-10-14T16:41:11.250
> 
> 标签：asp.net, asp.net-mvc, jquery-mobile

我使用 MVC4 Mobile 模板创建了简单的网站。在 index.cshtml 上，我放置了以下链接`@Html.ActionLink("CC", "Process", "Home", new { id = "1" }, new { })`和另外两个具有不同 ID 的链接。

控制器进程链接和 RouteConfig 具有正确的路由。

当我测试页面时，如果我每次点击不同的链接它工作正常，但第二次点击同一个链接什么都不做。我怀疑某种缓存，但在这里不受欢迎。

让我知道该怎么做才能让它消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T23:05:34.133

可能是您的页面 div 都具有相同的 id。

```
<div data-role="page" id="foo"> 
```

jQuery mobile 不会获取它认为已经存在的页面。如果您需要保持相同的 id，您可以将 data-ajax=false 放在您的链接中以“强制”它重新加载页面。前任：

```
<a href="/foo2" data-ajax="false">Next Page</a> 
```

显然，您将无法仍然使用 Html.ActionLink 添加自定义数据属性，您将不得不编写自己的链接或自定义 Html 帮助程序。

但是，如果这样做，您可能会在 iOS 上以支持网络应用的模式运行网络应用时遇到麻烦，因为 iOS 会尝试启动 Safari，而不是停留在“应用”中。

# javascript - 如何根据值的百分比合并 Math.random？

> ID：12884300
> 
> 赞同：1
> 
> 时间：2012-10-14T16:41:26.913
> 
> 标签：javascript, game-development

我想在此代码中添加一个随机修饰符，该修饰符将根据基础值的 +-20% 范围增加或减少伤害。伤害会在结果的 80% 到结果的 120% 之间随机化。对于数字示例：

攻击者.力量(20) - 防御者.防御(10) = 结果

20 - 10 = 范围（8 到 12）

```
var Fight = function (attacker, defender) {
    var result;
    result = (attacker.Strength - defender.Defense);
    defender.HP = defender.HP - result;

    if(defender.HP >= 1) {
         return defender.Name + " has taken " + result + " damage!";
    } else {
         return defender.Name + " has been slain";
    }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:44:47.240

[`Math.random`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/random)返回一个介于 0 和 1 之间的数字。将此映射到您的范围 from `0.8`to `1.2`：

```
var factor = Math.random() * 0.4 + 0.8;
//                |           |     |
//              [0, 1[        |     |
//                    \      /      |
//                    [0, 0.4[     /
//                         \      /
//                        [0.8, 1,2[
var result = Math.round((attacker.Strength - defender.Defense) * factor); 
```

Not sure whether you want to round somewhere so that your player's health points are always natural numbers. If not, you should change your death condition to `defender.HP > 0`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T16:43:19.050

如`Math.random() * 0.4`?

```
result = (attacker.Strength - defender.Defense) * (0.8 + Math.random() * 0.4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T16:44:28.820

对于精确的 +/- 20%，`random`仅用于生成两个数字，即`0, 1`.

如果`0`，则将其视为`+`，如果`1`，则将其视为`-`如下：

```
 var randomNum = Math.round(Math.random()); //it will return 0 or 1
   if(randomNum ==0){
      //write +20% code here
      result = (attacker.Strength - defender.Defense)*1.2;
   }else{
      //write -20% code here
      result = (attacker.Strength - defender.Defense)*0.8;
   } 
```

编辑：对于基于范围的，它要简单得多。

```
 var factor = 0.8 + Math.random()*0.4;
  result = (attacker.Strength - defender.Defense)*factor ; 
```

# scala - Play 中的变量/自定义错误消息！2 框架scala形式

> ID：12884305
> 
> 赞同：1
> 
> 时间：2012-10-14T16:41:46.383
> 
> 标签：scala, playframework-2.0

我希望 Play 框架中的表单验证根据验证的附带结果生成可变错误消息。我怎样才能干净地做到这一点？

具体示例——假设我有一个这样定义的表单：

```
 val f = Form(
    "xml" -> text
      .verifying(
        "xml is incorrect",
        xml => validationError(xml) == None
      )
  )

  def validationError(xml: String): Option[String] 
```

我该怎么做才能将validationError返回的字符串显示为验证错误消息，而不是固定字符串“xml不正确”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:46:12.753

您可以创建[`Constraint`](http://www.playframework.org/documentation/api/2.0.4/scala/play/api/data/validation/Constraint.html)将处理它的实例。例如：

```
val xmlConstraint = Constraint[String](Some("xml.constraint"), Nil)( xml =>
  validationError(xml).map(msg => Invalid(ValidationError(msg))).getOrElse(Valid)
)

val f = Form("xml" -> text.verifying(xmlConstraint)) 
```

此外，对象还有另一种`apply`方法，[`Constraint`](http://www.playframework.org/documentation/api/2.0.4/scala/index.html#play.api.data.validation.Constraint%24)没有指定约束的名称。

# java - Java中PriorityQueue类的加法运算

> ID：12884308
> 
> 赞同：0
> 
> 时间：2012-10-14T16:42:20.080
> 
> 标签：java, eclipse, runtime-error, priority-queue, user-defined-types

我正在尝试在 Java 中实现 PriorityQueue。我有包含 PriorityQueue 和 TestPrinterQueue 类的 PrinterQueue 类来测试它。PrintJob 是此队列中的类型。构造函数是私有的，所以我使用反射来实现对象的实例。

问题发生在运行时，我不能将多个对象添加到队列中。队列的大小始终相同。没有编译错误。所有代码如下。谢谢...

```
PrinterQueue class:

import java.util.Comparator;
import java.util.PriorityQueue;

public class PrinterQueue{
   private static PrinterQueue queue;
   PriorityQueue<PrintJob> pqExample;
   Comparator<PrintJob> Comparator;
   int iQueueSize = 50;

   private PrinterQueue(){
      Comparator = new Priority();
      pqExample = new PriorityQueue<PrintJob>(iQueueSize,Comparator);
  }
   public static PrinterQueue getQueue(){
      if (queue==null) queue = new PrinterQueue();
     return queue;} 

   public void addJob (PrintJob job) {
       queue = new PrinterQueue();
       queue.pqExample.add(job);
     // Use the job’s getPriority method to check its priority. PRIORITY CLASSINDA KULLANILDI.
     System.out.println("Job " + job.getName() + " is added to the printer queue" + " Size: " + queue.pqExample.size());
     Print();
  }
  public boolean isEmpty(){
      if(queue.pqExample.isEmpty())
          return true;
      else
          return false;
  }
  public PrintJob removeJob(){
      //TODO –remove the highest priority job from the queue
      PrintJob job = queue.pqExample.remove();
      System.out.println("Job "+ job.getName()+ "has been printed");
      return job;

  }
  public boolean isFull(){
      if (queue.pqExample.size() == iQueueSize)
          return true;
      else
          return false;
  }
  private void Print() {

      PriorityQueue<PrintJob> pqTemp;
      pqTemp = queue.pqExample;

       while (pqTemp.size() != 0)
       {
           System.out.println(queue.pqExample.element());
           System.out.println("//");
           pqTemp.remove();
       }
  }
} 
```

TestPrinterQueue 类：

```
import java.lang.reflect.Constructor;
import java.util.Scanner;

public class TestPrinterQueue {

    public static void main (String[] args) throws Exception {

        Constructor<PrinterQueue> constructor = PrinterQueue.class.getDeclaredConstructor(new Class[0]);
        constructor.setAccessible(true);

        PrinterQueue pqTest = constructor.newInstance(new Object[0]);

        @SuppressWarnings("resource")
        Scanner scUserInput = new Scanner(System.in);

        while (true)
        {
             PrintJob pjWillbeAdded = new PrintJob();

             System.out.println("Enter the priority:");
             pjWillbeAdded.setPriority(scUserInput.nextInt());
             System.out.println("Enter the JobName:");
             pjWillbeAdded.setName(scUserInput.next());
             System.out.println("Enter the Number of Pages in PrintJob:");
             pjWillbeAdded.setiNoPJ(scUserInput.nextInt());

             pqTest.addJob(pjWillbeAdded);

             System.out.println("**** TEST SIZE : " + pqTest.pqExample.size() + "*****");
        }
    }
} 
```

我希望这些信息足以解释我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:51:27.540

在您的 addJob() 方法中，您每次都将队列分配给一个新的 PrinterQueue 对象。将其更改为“queue = getQueue()”应该可以解决这个问题。

# perl - 如何使用 perl 的 POE::Component::IRC 发出退出消息？

> ID：12884311
> 
> 赞同：1
> 
> 时间：2012-10-14T16:42:33.783
> 
> 标签：perl, irc

我有一个使用 POE::Component::IRC 的简单 IRC 机器人。只有当我试图通过退出一条有用的消息来让它优雅地处理 SIGINT 时，我才发现我根本无法让它退出任何消息，无论是作为信号处理程序的一部分还是只是正常调用退出。

假设我已经创建了这样的会话：

```
POE::会话->创建(
        inline_states => {
                irc_disconnected => \&bot_reconnect,
                irc_error => \&bot_reconnect,
                irc_socketerr => \&bot_reconnect,
                连接 => \&bot_reconnect,
.
.
.
        },
);

```

如果`bot_reconnect`出现任何问题，它将连接回 IRC：

```
sub bot_reconnect
{
        我的 ($kernel, $heap) = @_[KERNEL, HEAP];

        if (1 == $heap->{shutting_down}) {
                $heap->{irc}->yield(shutdown => 'blah');
        } 别的 {
                some_log_func("60 秒后重新连接");
                $内核延迟（连接=> 60）；
        }
}

```

如果在代码中的其他任何地方我设置`shutting_down`为 1 并告诉它退出（例如 `$irc->yield(quit => "bye!")`），它会立即退出 IRC，没有退出消息（“客户端退出”，显示 ircd）或“远程主机关闭连接”。

然后它接收到`irc_disconnected`将它带到 `bot_reconnect`上面的事件，在那里`shutdown`似乎什么都不做。事实上，如果我在那之后没有明确`exit 0`表示，`shutdown` 那么这个过程就会陷入困境，不再连接到 IRC。

这是应该发生的事情吗？

我发现：

[http://search.cpan.org/~bingos/POE-Component-IRC-6.79/lib/POE/Component/IRC/Cookbook/Disconnecting.pod](http://search.cpan.org/~bingos/POE-Component-IRC-6.79/lib/POE/Component/IRC/Cookbook/Disconnecting.pod)

说要使用`shutdown`. 如您所见，我试过了，但它似乎不起作用。

我还在另一个问题中找到了一些示例代码：

[如何正确关闭 Bot::BasicBot 机器人（基于 POE::Component::IRC）？](https://stackoverflow.com/questions/2471373/how-do-i-correctly-shutdown-a-botbasicbot-bot-based-on-poecomponentirc)

然而，这与我现在所拥有的非常相似，而且它的行为似乎也没有任何不同。

的包版本`libpoe-component-irc-perl`是 6.78+dfsg-1，所以应该大于 6.50，如上面的 URL 所说。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T18:10:33.293

事实证明，这是 ircd 的“错误”。

我还将此作为错误报告给 POE::Component::IRC 的请求跟踪器，Hinrik 回复，问我是否尝试在 Freenode 上执行此操作。Freenode 的 ircd 有一个功能，如果您很长时间没有连接，它会忽略您的退出消息。

我并没有尝试在 Freenode 上执行此操作，但事实证明我正在执行此操作的网络*确实*执行此操作。他们正在使用 Charybdis：

[https://github.com/atheme/charybdis/blob/master/modules/core/m_quit.c#L75](https://github.com/atheme/charybdis/blob/master/modules/core/m_quit.c#L75)

# javascript - Javascript 自动点击

> ID：12884318
> 
> 赞同：0
> 
> 时间：2012-10-14T16:42:51.717
> 
> 标签：javascript

我正在尝试自动单击网页上的一些链接

例如，在谷歌浏览器中，如果我输入`Javascript:setDisplayType('source');`，它会运行定义为的 html 中的函数

```
 <input type="radio" name="DisplayType" value="source" 
onclick="setDisplayType('source');"> 
```

到现在为止还挺好。但是，我不确定如何对以下内容执行相同操作

```
<td id="4124321351_U923" class="o bgc b" onclick="s(this,'329803656','40745906','9/2');b(this,'5.5','5.5');">5.5</td> 
```

我尝试了以下但没有成功

Javascript:s(this,'329803656','40745906','9/2');

Javascript:b(this,'5.5','5.5');

Javascript:s(this,'329803656','40745906','9/2');b(this,'5.5','5.5');

请有人可以解释为什么它不起作用以及如何使用类似的方法触发这个 onclick 事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:46:39.750

问题在于`this`参数，因为它不是从元素调用的，而是你在外面调用的。 `Javascript:s(this,'329803656','40745906','9/2');`

尝试证明这样的正确论点， `Javascript:s(document.getElementById('4124321351_U923'),'329803656','40745906','9/2');`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T16:47:00.470

如果你没有使用 JQuery 或类似的，那么类似：

```
document.getElementById("4124321351_U923").click(); 
```

可能会奏效。简而言之，您上面的示例不起作用，因为需要初始化“this”魔术变量以指向被单击的链接。您可以尝试在元素上启动*单击*事件（根据我的示例），也可以手动获取对链接的引用，并将其传递给而不是*this*

# database - mORMot 中的示例 SQL 查询

> ID：12884321
> 
> 赞同：5
> 
> 时间：2012-10-14T16:43:51.297
> 
> 标签：database, sqlite, delphi, delphi-7, mormot

我正在使用[Synopse mORMot](http://synopse.info/fossil/wiki?name=Downloads "mORMot 下载页面")从 Delphi 7 访问 SQLite 数据库。我希望建立连接并直接通过 SQL 查询数据库，而不使用 mORMot 的 ORM（对象关系映射）功能。

您能否提供不依赖 mORMot 的 ORM 功能来执行 SQL 查询的代码示例？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-14T23:28:28.180

简而言之：最好通过它的类使用该`SynDB.pas`层，因为它将允许您的代码在未来与任何可通过 OleDB / ODBC 甚至直接访问（例如 Oracle）访问的数据库一起工作。`SynSQLite3.pas``SynDBSQLite3.pas`

例如，使用一个变量来保存列数据：

```
procedure Test(Props: TSQLDBConnectionProperties);
var Customer: Variant;
begin
  with Props.Execute('select * from Customers where AccountNumber like ?',
    ['AW000001%'],@Customer) do
    while Step do
      assert(Copy(Customer.AccountNumber,1,8)='AW000001');
end;

var Props: TSQLDBConnectionProperties;

  Props := TSQLDBSQLite3ConnectionProperties.Create('databasefile.db3','','','');
  try
    Test(Props);
  finally
    Props.Free;
  end; 
```

*因此，对于您的问题，请阅读mORMot*文档中与 SynDB 相关的部分以及所有[相关的博客文章](http://blog.synopse.info/tag/SynDB)。这些类由 ORM 使用，但您可以在没有 ORM 的情况下使用这些类。

首先，有一个`TQuery`包装器`SynDB.pas`可以很好地与 SQLite3 配合使用，并允许“经典”代码级编程。

但是这些单元并没有 100% RAD 直接访问。只是一些 TClientDataSet “填充物”。这不是他们的目的：他们希望通过代码而不是通过 UI 管道快速直接地访问数据库。

# javascript - 在已经有 onclick 事件的情况下使用 Fancybox jquery

> ID：12884322
> 
> 赞同：2
> 
> 时间：2012-10-14T16:43:51.157
> 
> 标签：javascript, jquery, web, fancybox

我想点击**放大**链接打开我的fancybox。

![在此处输入图像描述](../Images/0a914efa6d48e5581f0203adc0254d2d.png)

到目前为止，我拥有的是一个 ajax 调用，因此我可以根据项目的 id 填充我的图像：

```
...
xmlhttp.open("GET", "desciptionImageHelper.aspx?id=" + id, true);
... 
```

在我的 deciptionImageHelper.aspx 上，我有一个查询，我可以在其中获取项目的所有图像：

```
while (reader.Read())
{
    litData.Text += "<a id='fancybox" + reader.GetInt32(0).ToString() + "' class='fancybox' rel='gallery1' onclick=\"javascript:imagePopup('" + reader.GetInt32(0).ToString() + "','" + reader.GetString(1) + "','" + reader.GetString(2) + "','" + reader.GetString(3) + "');\" ><img src=\"../helper/MediaImgHandler.ashx?imgid=" + reader.GetInt32(0).ToString() + "\"/></a>";
} 
```

这`while`变成：

```
<a id='fancybox4' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('4','Alululu Scetch','Photograph','Photoshop');" ><img src="../helper/MediaImgHandler.ashx?imgid=4"/></a>
<a id='fancybox13' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('13','Allalalala','Magazine article','PDF');" ><img src="../helper/MediaImgHandler.ashx?imgid=13"/></a>
<a id='fancybox22' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('22','PHOTOOO','Photograph','PDF');" ><img src="../helper/MediaImgHandler.ashx?imgid=22"/></a>
<a id='fancybox23' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('23','New Media','Journal article','Digital 3D Model');" ><img src="../helper/MediaImgHandler.ashx?imgid=23"/></a>
<a id='fancybox31' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('31','New media added on Aluminium','Film (cinema)','Digital Video');" ><img src="../helper/MediaImgHandler.ashx?imgid=31"/></a>
<a id='fancybox32' class='fancybox' rel='gallery1' title='asdsad' onclick="javascript:imagePopup('32','hahahaahha','Design development drawings','Digital Video');" ><img src="../helper/MediaImgHandler.ashx?imgid=32"/></a> 
```

左键单击图像，我得到了您在图片中看到的这个框。

代码是：

```
function imagePopup(id, title, media_type, format) {
        var popup = document.getElementById("imagePopup")
        popup.innerHTML = title + "<br /><span style='color:grey;margin-left:3px;'>" +
         media_type + " | " + format + "</span><br />" +
         "<a class='blueColor' onclick=\"javascript:getSummary(" + id + ",'m');" +
         "document.getElementById('projectNav').style.display = 'none';document.getElementById('left_right').style.display = 'none';displayMedia('" + title + "');$('#imagePopup').fadeOut('slow');\">SEE DETAILS</a><br />" +
         "<a id='enlarge' onclick=\"javascript:$('#fancybox" + id + "').attr('rel', 'gallery').fancybox();\" class='blueColor' >ENLARGE</a>";

        $('#imagePopup').css({ 'top': mouseY, 'left': mouseX }).fadeIn('slow');

    } 
```

但它不能用作**画廊**，而且当我查看图片（fancybox 打开）时，它会在我的页面上**消失。**

我不知道该怎么办。我的代码是不是一团糟？我应该遵循其他政策吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T21:24:03.173

我终于想出了一个想法，用 .fancybox 类隐藏链接并在点击 ENLARGE 时触发它。

```
while (reader.Read())
{
       litData.Text += "<a onclick=\"javascript:imagePopup('" + reader.GetInt32(0).ToString() + "','" + reader.GetString(1) + "','" + reader.GetString(2) + "','" + reader.GetString(3) + "');\" ><img src=\"../helper/MediaImgHandler.ashx?imgid=" + reader.GetInt32(0).ToString() + "\"/></a>";
       litData.Text += "<a style='display:none' id='fancybox" + reader.GetInt32(0).ToString() + "' class='fancybox' rel='gallery1' title='asdsad' href=\"../helper/MediaImgHandler.ashx?imgid=" + reader.GetInt32(0).ToString() + "\" ></a>";
} 
```

因此，在一个链接上，我有一个用于弹出窗口的 onclick 事件处理程序，而对于另一个链接，我有我的 href="../.ashx"。

```
 <a id='enlarge' onclick=\"javascript:$('#fancybox" + id + "').trigger('click');\" class='blueColor' >ENLARGE</a> 
```

但我必须解决的另一个问题是图像是通过 helper(.ashx) 显示的。我通过将属性`'type': 'image'`放在fancybox上解决了这个问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T22:47:52.953

这一行（在你的`imagePopup()`函数内）：

```
"<a id='enlarge' onclick=\"javascript:$('#fancybox" + id + "').attr('rel', 'gallery').fancybox();\" class='blueColor' >ENLARGE</a>"; 
```

可以很简单

```
"<a id='enlarge' rel='gallery' class='blueColor' >ENLARGE</a>"; 
```

（虽然我没有看到你希望它成为画廊的代码，因为你试图将 fancybox 绑定到`ID`一个元素，所以只允许一个元素）

...然后只需在您的代码中添加某处

```
$(document).ready(function(){
  $("#enlarge").fancybox();
}); 
```

# html - 滚动期间损坏的视觉效果 - flash cs3 as2.0

> ID：12884323
> 
> 赞同：1
> 
> 时间：2012-10-14T16:43:56.077
> 
> 标签：html, flash, actionscript-2

[Facebook 上](http://apps.facebook.com/turn_poker/)的我的 Flash CS3、ActionScript 2.0扑克游戏出现奇怪的视觉损坏。在游戏中，当您进行操作时（如滚动随附屏幕截图中的列表），屏幕上会出现黑块。在游戏画面中，时间一过，又出现了一些黑块。实际上，当某些事件发生（发牌动画）时，会出现黑色区域​​。

（黑色是我的背景颜色，我正在使用参数`name="wmode" value="transparent"`将 Flash 嵌入 HTML。我在 8 台计算机上更新了 Flash 播放器，但这种情况仍然在 6 台计算机上恢复。

我找不到与我的问题相关的原因或任何内容。

截图： http: [//postimage.org/image/4jeofdvg5](http://postimage.org/image/4jeofdvg5)

# java - 字符串不相等？测试我一直在做的 md5 散列操作，是的，我正在使用 .equals

> ID：12884324
> 
> 赞同：2
> 
> 时间：2012-10-14T16:43:56.053
> 
> 标签：java, string, hash, md5, equals

这是我的课程的代码：

```
 public class Md5tester {
private String licenseMd5 = "?jZ2$??f???%?";

public Md5tester(){
    System.out.println(isLicensed());
}
public static void main(String[] args){
    new Md5tester();
}
public boolean isLicensed(){
    File f = new File("C:\\Some\\Random\\Path\\toHash.txt");
    if (!f.exists()) {
        return false;
    }
    try {
        BufferedReader read = new BufferedReader(new InputStreamReader(new FileInputStream(f)));
        //get line from txt
        String line = read.readLine();
        //output what line is
        System.out.println("Line read: " + line);
        //get utf-8 bytes from line
        byte[] lineBytes = line.getBytes("UTF-8");
        //declare messagedigest for hashing
        MessageDigest md = MessageDigest.getInstance("MD5");
        //hash the bytes of the line read
        String hashed = new String(md.digest(lineBytes), "UTF-8");
        System.out.println("Hashed as string: " + hashed);
        System.out.println("LicenseMd5: " + licenseMd5);
        System.out.println("Hashed as bytes: " + hashed.getBytes("UTF-8"));
        System.out.println("LicenseMd5 as bytes: " + licenseMd5.getBytes("UTF-8"));
        if (hashed.equalsIgnoreCase(licenseMd5)){
            return true;
        }
        else{
            return false;
        }
    } catch (FileNotFoundException e) {
        return false;
    } catch (IOException e) {           
        return false;
    } catch (NoSuchAlgorithmException e) {  
        return false;
    }
} 

} 
```

这是我得到的输出：

> 行阅读：测试
> 
> 散列为字符串：?jZ2$??f???%?
> 
> LicenseMd5: ?jZ2$??f???%?
> 
> 散列为字节：[B@5fd1acd3
> 
> LicenseMd5 为字节：[B@3ea981ca
> 
> 错误的

我希望有人可以为我解决这个问题，因为我不知道问题是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:03:30.827

MD5 转换返回的A`byte[]`是任意的`byte[]`，因此您不能将其视为`String`某些编码中的有效表示。

特别是，`?`s in`?jZ2$??f???%?`对应于无法在输出编码中表示的字节。这意味着您的内容`licenseMd5`已经损坏，因此您无法将您的 MD5 哈希与它进行比较。

如果您想表示您的`byte[]`as`String`以进行进一步比较，您需要为任意`byte[]`s 选择适当的表示。例如，您可以使用[Base64](http://en.wikipedia.org/wiki/Base64)或十六进制字符串。

您可以`byte[]`按如下方式转换为十六进制字符串：

```
public static String toHex(byte[] in) {
    StringBuilder out = new StringBuilder(in.length * 2);
    for (byte b: in) {
        out.append(String.format("%02X", (byte) b));
    }
    return out.toString();
} 
```

另请注意，`byte[]`使用`toString()`. 它的结果（例如`[B@5fd1acd3`）与 的内容无关`byte[]`，因此在您的情况下它没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:00:54.510

`?`的打印表示中的符号不`hashed`​​是文字问号，它们是不可打印的字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:08:40.273

当您的 java 文件格式不是 UTF-8 编码而您使用 UTF-8 对字符串进行编码时，您会收到此错误，尝试删除 UTF-8 并且 md5 将输出另一个结果，您可以复制到字符串并查看结果为真。另一种方法是将文件编码设置为UTF-8，字符串编码也不同

# java - 使用最终静态列表中的默认值填充列表

> ID：12884325
> 
> 赞同：0
> 
> 时间：2012-10-14T16:44:01.583
> 
> 标签：java, list, map

标题可能不是最好的，我为此道歉。

我有几个最终静态列表用于定义数据库值的默认值。默认值列表永远不会更改，因此在填充它们时，我使用[Collections.nCopies(int,T)](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#nCopies(int,%20T))来获取不可变列表。这些列表然后用于使用默认值填充另一个类中的列表。这些列表中的值预计会发生变化。

默认类的伪代码：

```
public final class FooDefaults {
    public final static List<Integer> LIST_ONE;
    public final static List<String> LIST_TWO;
    //This map allows easier access to "column" values.
    public final static List<Map<String,String>> LIST_THREE;

    static {
        LIST_ONE = Collections.nCopies(7, 5);
        LIST_TWO = Collections.nCopies(10, "boo");
        Map<String, String> temp = new java.util.LinkedHashMap<>();
        for(int i=0;i<15;i++) {
            temp.put(("Param"+i),"foo");
        }
        LIST_THREE = Collections.nCopies(10, temp);
    }
} 
```

可编辑值类的伪代码：

```
public class Foo {
    //Keep the reference from changing.
    //Prevents an accidental new.
    private final List<Integer> listOne;
    private final List<String> listTwo;
    private final List<Map<String,String>> listThree;

    public Foo() {
        listOne = new java.util.ArrayList<>(FooDefaults.listOne);
        listTwo = new java.util.ArrayList<>(FooDefaults.listTwo);
        listThree = new java.util.ArrayList<>(FooDefaults.listThree);
    }
} 
```

我担心的是，当我对这些列表执行了浅拷贝时，Foo 中列表的更改将在 FooDefaults 中的列表中可见。

这篇文章：[https](https://stackoverflow.com/a/1685158/1391956) : //stackoverflow.com/a/1685158/1391956 建议由于字符串和整数是不可变的，我不必担心意外覆盖 FooDefaults.LIST_ONE 和 FooDefaults.LIST_TWO 中的值。

因此，我主要关心的是 FooDefaults.LIST_THREE 中的映射中包含的值。如果我在 Foo 的 listThree 中更改地图中的值，更改是否会在 FooDefaults 中可见？

如果是这样，处理这个问题的最有效方法是什么？类 Foo 可能会被实例化超过一千次并添加到另一个类的 List 中，因此速度可能会成为一个问题。

为了速度，我最初在 FooDefaults 中创建了最终的静态列表，因为我（可能不正确）假设在 FooDefaults 中创建这些列表并简单地复制数据会比每次实例化 Foo 时创建它们要快。

编辑：如果我必须执行深层复制，我计划使用类似于：

```
public static final List<Map<String, String>> getListThreeCopy() {
    Map<String,String> temp = new java.util.LinkedHashMap<>();
    for(Map.Entry<String, String> entry: LIST_THREE.get(0).entrySet()) {
        temp.put(entry.getKey(),entry.getValue());
    }

    List<Map<String,String>> rtnList = new java.util.ArrayList<>();
    for(int i=0;i<LIST_THREE.size();i++) {
        rtnList.add(temp);
    }
    return rtnList;
} 
```

会有更快的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T23:23:02.993

最后，我使用我帖子末尾提到的代码循环执行了 1,500 次 Deep Copy 并对其进行了计时。我对实例化代码做了同样的事情。

正如我所预料的那样，从头开始重新创建列表比深拷贝要快得多。

深度复制为 16 毫秒，而实例化为 0 毫秒。我使用 System.currentTimeMillis() 对其进行计时。

只要我只在静态函数中创建它，我就没有理由担心错误。

# c# - 如何禁用整个解决方案的特定警告？

> ID：12884331
> 
> 赞同：10
> 
> 时间：2012-10-14T16:44:21.887
> 
> 标签：c#, visual-studio

> **可能重复：**
> [全局禁止 c# 编译器警告](https://stackoverflow.com/questions/526443/globally-suppress-c-sharp-compiler-warnings)

不要在每个文件中添加如下行：

```
#pragma warning disable 1573 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-14T16:47:17.223

所有编译选项都在项目级别指定。MSBuild 存在于解决方案级别之下。

要为每个项目执行此操作，请转到 Project Properties 中的 Build 选项卡，然后在 Suppress Warnings 文本框中输入警告编号。

# java - 会话 servlet 和 href 标记

> ID：12884336
> 
> 赞同：0
> 
> 时间：2012-10-14T16:44:39.587
> 
> 标签：java, session, servlets, href

我想做的是相对简单
在我的webapp中有这两个servlet：（
我会写一些伪代码）

**servlet A 代码:** :

```
 HttpSession sess = req.getSession();

    String str = (String) sess.getAttribute("log");

    if(str == null)
    {
     // send html page with a form
     // to enter password and name 
     // data will be proceessed by servlet B
    }
    else
    {
     // send html page with a form
     // to enter only a name 
     //data will be proceessed by servlet B
    } 
```

**小服务程序 B 代码:** :

```
 HttpSession sess = req.getSession();

       String logged =  (String) sess.getAttribute("log");

       if(logged == null)
       {

        //check if password correct

            if(correct)
            {
             sess.setAttribute("log","ok");

             // print name 
             // and tell the user
             // that next time password
             // will not be requested
            }
            else
            {
             // print error message
            }

       }
       else
       {
       // print name
       } 
```

出于某种原因，在用户正确填写密码和名称之后第二次调用 servlet A 时 **str**为**空**，因此打印了**if部分。**

编辑：

我发现如果用户在输入密码并被重定向到 servletB 后自己写入 servletA 的 url 一切正常，但是当用户使用 servletA 创建的链接返回上一页时它不起作用：A HREF =\"http://localhost:8080/Blog/ServletA\" 返回

再次，任何建议为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:00:17.210

我相信它没有进入你的`if(correct)`街区，即`correct`条件没有得到满足。更正那里的条件并确保它`log`在`session`. 一旦将属性设置到会话中，它就会一直存在，直到会话过期或您将其删除。

# django - 如何使用 django sweetpie 的处理程序为 UserProfile 制作 api？

> ID：12884338
> 
> 赞同：0
> 
> 时间：2012-10-14T16:44:51.707
> 
> 标签：django, tastypie

```
class UserProfile(models.Model):
    """
    Extending the Django User.

    """

    user = models.OneToOneField(User,unique=True)
    image_id = models.CharField(max_length=50,blank=True)

    is_email_validated = models.BolleanField(default = False)

    followers_count = models.IntegerField(max_length=5,default=0,blank=True,null=True)

    following_users = ModelListField()
    follower_users = ModelListField()

    def __unicode__(self):
        return u"%s" % self.user.first_name

    def full_name(self):
        return u"%s" % self.user.first_name + '' + self.user.last_name

    def email(self):
        return self.user.email

    def username(self):
        return self.user.username

    def books_count(self):
        return len(self.user.get_profile().books)

    def create_user_profile(sender,instance,created,**kwargs):
        if created:
            UserProfile.objects.create(user=instance)
            action.send(type="create_user",actor=instance,target=instance)
    post_save.connect(create_user_profile,sender=User) 
```

因此，我如何用它制作一个 api？我必须编写处理程序吗？（在这种情况下 Django 美味派是如何工作的很困惑。）

我可以编写处理程序来为 GET /users//following 之类的 api 调用返回数据。但这就是美味派的做法吗？如果是，我如何将处理程序与 API 连接？

编辑：这样的事情可以在 django-piston 中完成，如下所示：

```
from piston.handler import BaseHandler
from piston.utils import rc

from app.apps.user.models import User, UserProfile

class UserHandler(BaseHandler):
    model = User

    def read(self, request, user_id=None, action=None):
        """
        GET /users/

        following - GET /users/<user_id>/following
        followers - GET /users/<user_id>/followers
        user profile - GET /users/<user_id>/        
        """

        if action =="following":
            return self.following(request, user_id)
        elif action == "followers":
            return self.followers(request, user_id)
        else:
            return self.get_user_profile(request, user_id)      

    def get_user_profile(self, request, user_id):
        """
        User Profile
        GET /users/<user_id>/
        """
        user = User.objects.get(pk=user_id)

        user_session = request.user
        user_session_following = user_session.get_profile().following_users

        if user.id in user_session_following:
            follow_status=True
        else:        
            follow_status=False

        return user_actions.get_user_profile(user, follow_status) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:37:03.080

放入你的 app/apps/user/api.py

```
from tastypie.resources import ModelResource
from django.contrib.auth.models import User

class UserResource(ModelResource):
    class Meta:
        queryset = User.objects.all()
        resource_name = 'user' 
```

在你的 urls.py

```
from django.conf.urls.defaults import * 
from app.apps.user.api import UserResource

v1_api = Api(api_name='v1') #api_name will be 'v1' in http://localhost:8000/v1/?format=json
v1_api.register(UserProfileResource())    

urlpatterns = patterns('',
    (r'^api/', include(v1_api.urls)), 
) 
```

我不想在这里粗鲁，但阅读文档，特别是[快速入门](http://django-tastypie.readthedocs.org/en/latest/tutorial.html#creating-resources)，会有所帮助。

您的 api 现在（在您的开发服务器中）暴露于

```
 http://localhost:8000/api/v1/?format=json 
```

就这样。您不必编写任何代码，例如

```
 - retrieve all users in json:
   http://localhost:8000/api/v1/user/?format=json

 - retrieve the entry in the user table with the key 1
   http://localhost:8000/api/v1/user/1/?format=json

 - retrieve the meta information about your UserResource
   http://localhost:8000/api/v1/user/schema/?format=json 
```

希望这对你有帮助！

# list - 在 Prolog 中使用递归创建数据列表

> ID：12884340
> 
> 赞同：2
> 
> 时间：2012-10-14T16:45:47.283
> 
> 标签：list, recursion, prolog

我正在尝试编写一个递归函数，将列表向下传递给自身，并在每个级别向该列表添加一个元素。最终列表应作为谓词的解决方案报告回来。但我无法弄清楚如何做到这一点。问题的形式基本上是这样的：

```
solve(List, NumberOfSteps) :- NumberOfSteps = 10 . //Stops after 10 recursive steps
solve(List, NumberOfSteps) :-
    append NumberOfSteps to List,
    NumberOfStepsIncremented is NumberOfSteps + 1,
    solve(List, NumberOfStepsIncremented) . 
```

所以我在这里我想调用solve(List, 1) 并让Prolog 返回一个看起来像这样的答案：

```
List = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] ;
true 
```

我可以让 Prolog 创建列表并在最后打印出来。我可以通过使用内置的预测 append(List, NumberOfSteps, List2) 然后通过递归传递 List2 并在最后打印它来做到这一点，但是 List 和 List2 在那里并没有统一，Prolog 给出的实际答案我是列表 = [] ; 真的

我有一种感觉，我可能以错误的方式处理问题，但我被卡住了！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:06:48.807

I figured it out. This is what it should have looked like:

```
solve(List, NumberOfSteps) :- NumberOfSteps = 10 . //Stops after 10 recursive steps
solve([LHead | LTail], NumberOfSteps) :-
    LHead = NumberOfSteps,
    NumberOfStepsIncremented is NumberOfSteps + 1,
    solve(LTail, NumberOfStepsIncremented) . 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T12:11:30.453

I'll extend the comment by Will Ness to your answer and will show the simpler correction:

```
solve([NumberOfSteps], NumberOfSteps) :-
    NumberOfSteps = 10, !. % Stops after 10 recursive steps
solve([LHead | LTail], NumberOfSteps) :-
    LHead = NumberOfSteps,
    NumberOfStepsIncremented is NumberOfSteps + 1,
    solve(LTail, NumberOfStepsIncremented) . 
```

# django - NoReverseMatch at /, u'opts|admin_urlname' 不是已注册的命名空间 Django 1.4.1

> ID：12884343
> 
> 赞同：3
> 
> 时间：2012-10-14T16:46:12.093
> 
> 标签：django, django-admin, django-urls

Django新手在这里。根据[文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#reversing-admin-urls)，我正在尝试以下操作以从我正在构建的公共站点的主页获取指向管理站点的链接：

```
{% load admin_urls %}
<p>Go to the <a href="{% url opts|admin_urlname:'add' %}">admin</a>.</p> 
```

我收到错误消息：

```
NoReverseMatch at /
u'opts|admin_urlname' is not a registered namespace 
```

我正确地包含了 URL：

```
 url(r'^admin/', include(admin.site.urls)), 
```

我的[模板加载器的顺序正确](https://stackoverflow.com/questions/9874192/admin-is-not-a-registered-namespace-in-django-1-4)。

我已经尝试了一些不同的变体，它们都抛出了命名空间错误。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T08:05:41.623

在一个屏幕上使用 Daniel Roseman / Django 文档并在另一个屏幕上使用我的代码 30 分钟后，我想出了这个简单的解决方案：

在您`views.py`的 _meta 中添加 opts 上下文和模型（包括必需的`app_label`和`model_name`）：

```
class YourModelDetailView(DetailView):
    def get_context_data(self, **kwargs):
        context = super(YourModelDetailView, self).get_context_data(**kwargs)
        context["opts"] = YourModel._meta
        return context 
```

在您的模板中：

```
{% url opts|admin_urlname:'change' object.pk %} 
```

**更改**可以是[反向管理 url](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#reversing-admin-urls)文档页面中的任何操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T13:54:08.887

虽然上述答案对我调用的代码很有帮助，但还有一种*更*简单的方法。我改用这个：

```
{% url 'admin:index' %} 
```

这也适用于自定义管理视图，例如：

```
{% url 'admin:myapp_mymodel_<keyword>' object.id %} 
```

where`keyword`来自[此处列出的命名参数](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#reversing-admin-urls)（即`add`, `change`, `delete`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T16:59:02.433

您几乎可以肯定使用的是已发布的 1.4 版本，而不是开发版本。正如该[版本的文档](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#reversing-admin-urls)所示，您需要先使用`{% load url from future %}`，然后才能使用该语法。

# c# - 迭代面板控制

> ID：12884345
> 
> 赞同：2
> 
> 时间：2012-10-14T16:46:21.097
> 
> 标签：c#, iteration, panel

我试图通过谷歌搜索找到答案，但没有运气。我设计了带有包含文本框的面板的表单，因此我可以遍历它的控件并将每个文本框保存在一个数组中（这样我就可以在我想要的时候迭代数组），问题是我找不到面板知道如何安排的属性迭代其中的控件的顺序，即第一个、第二个等。我想也许是按标签，但是当我根据自己的喜好更改它们时，它并没有改变任何东西。所以我想知道 - 你怎么能告诉面板迭代通过你喜欢的控件？您需要更改哪个属性？

```
private void CreateTxtArr()
{
     txts = new TextBox[8];
     for (int i = 0; i < pnlTxt.Controls.Count; i++)
        txts[i] = (TextBox)pnlTxt.Controls[i];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T16:49:10.703

您可以使用[**is**](http://msdn.microsoft.com/en-us/library/scekt9xw%28v=vs.71%29.aspx)运算符来检查`the child control`面板是否`is` `TextBox`

```
private void CreateTxtArr()
{
     txts = new TextBox[8];
     for (int i = 0; i < pnlTxt.Controls.Count; i++)
         if( pnlTxt.Controls[i] is TextBox)
               txts[i] = (TextBox)pnlTxt.Controls[i];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:51:07.613

如果您可以使用 .Net 3.5 或更高版本，则可以使用 Linq 轻松完成：

```
private void CreateTxtArray()
{
    // txts is an Array of TextBox
    var txts = (from Control ctrl in pnlTxt.Controls
                where ctrl is TextBox
                select ctrl as TextBox).ToArray();
} 
```

在所有情况下都是一种更简单的迭代方式

**编辑**：这是我忘记的旧答案，下面有一个更简单的方法来做到这一点

```
private void CreateTxtArray()
{
    // txts is an Array of TextBox
    var txts = pnlTxt.Controls.OfType<TextBox>().ToArray();
} 
```

# c# - WPF - 如何获取图像的 URI 源？

> ID：12884348
> 
> 赞同：0
> 
> 时间：2012-10-14T16:46:30.450
> 
> 标签：c#, wpf, image, uri, bitmapframe

我想获取在 XAML 中创建的图像的 URI 源。图像的来源是 BitmapFrame。我知道您可以将 BitmapImage.UriSource 用于 BitmapImages，但是 BitmapFrames 呢？

要获得我使用的 BitmapFrame：

```
 private void imgs_Loaded(object sender, MouseEventArgs e)
    {
        Image img = (Image)sender;
        BitmapFrame frame = (BitmapFrame)img.Source;
        //How to get frame's UriSource?
    } 
```

# c - Complement Multiply With Carry (CMWC) RNG C winmain@16 编译问题

> ID：12884351
> 
> 赞同：-1
> 
> 时间：2012-10-14T16:46:49.477
> 
> 标签：c, random, compilation

[http://en.wikipedia.org/wiki/Multiply-with-carry#Complementary-multiply-with-carry_RNGs](http://en.wikipedia.org/wiki/Multiply-with-carry#Complementary-multiply-with-carry_RNGs) 有一些 C 代码

我正在尝试编译它，但是当我这样做时，我收到此错误 c:\program files (x86)\codeblocks\mingw\bin..\lib\gcc\mingw32\4.4.1......\libmingw32 .a(main.o):main.c|| 未定义对“WinMain@16”的引用|

这是代码

我希望弄清楚如何实现它并使用它来代替 booster 的 mersenne twister。

正如有人指出的那样，我错过了我的主要功能，但现在有了它，我仍然无法让它运行。

```
#include <stdint.h>

#define PHI 0x9e3779b9

static uint32_t Q[4096], c = 362436;

int main
{
    init_rand(6);

    int c = rand_cmwc();
};

void init_rand(uint32_t x)
{
        int i;

        Q[0] = x;
        Q[1] = x + PHI;
        Q[2] = x + PHI + PHI;

        for (i = 3; i < 4096; i++)
                Q[i] = Q[i - 3] ^ Q[i - 2] ^ PHI ^ i;
}

uint32_t rand_cmwc(void)
{
        uint64_t t, a = 18782LL;
        static uint32_t i = 4095;
        uint32_t x, r = 0xfffffffe;
        i = (i + 1) & 4095;
        t = a * Q[i] + c;
        c = (t >> 32);
        x = t + c;
        if (x < c) {
                x++;
                c++;
        }
        return (Q[i] = r - x);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T22:39:04.547

好吧，我想通了。

我错过了我的主要功能。

然后我将代码实现为一个类，希望使其线程安全（允许多个种子）

```
#include <iostream>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define PHI 0x9e3779b9

using namespace std;

static uint32_t Q[4096], c = 362436;

class cmwc
{

  public:

    void init_rand(uint32_t x)
    {
        int i;

        Q[0] = x;
        Q[1] = x + PHI;
        Q[2] = x + PHI + PHI;

        for (i = 3; i < 4096; i++)
                Q[i] = Q[i - 3] ^ Q[i - 2] ^ PHI ^ i;
    }

    uint32_t rand_cmwc(void)
    {
        uint64_t t, a = 18782LL;
        static uint32_t i = 4095;
        uint32_t x, r = 0xfffffffe;
        i = (i + 1) & 4095;
        t = a * Q[i] + c;
        c = (t >> 32);
        x = t + c;
        if (x < c) {
                x++;
                c++;
        }
        return (Q[i] = r - x);
    }

    uint32_t random_num;

};

int main()
{
    cmwc rng1;

    rng1.init_rand(time(NULL));

    rng1.random_num = 1 + rng1.rand_cmwc()%6;

    //int r = rng1.rand_cmwc();

    cout << "die: " << rng1.random_num << endl;

    return 0;
} 
```

# unity3d - 函数 OnCollisionEnter() 无法统一工作

> ID：12884352
> 
> 赞同：0
> 
> 时间：2012-10-14T16:46:50.700
> 
> 标签：unity3d, collision-detection, unityscript

我正在使用 unityscript，我不知道为什么，但 OnCollisionEnter 函数从不调用，即使在 unity3d 中记录它也是如此。是否有替代方案或发生这种情况的原因？

顺便说一句，我正在尝试使用此碰撞检测功能来确定主摄像头是否正在接触墙壁或任何东西。完成

这正是我所做的：

1.  我创建了一个统一脚本文件。
2.  我只用以下内容替换了所有内容：

    ```
    function OnCollisionEnter(theCollision : Collision) {
         Debug.Log("Hit");
    } 
    ```

3.  现在，我将该文件（已保存）拖到主摄像机。

4.  在游戏中，我将主摄像机移动到墙壁或立方体对象上，但它没有记录“命中”。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T05:20:00.210

1.  首先检查脚本是否附加到游戏对象。
2.  然后检查是否有 RigidBody 组件附加到游戏对象（您在其上使用 OnCollisionEnter 附加脚本）

发布代码，以便我们更好地了解

# android - Android ActionMode 动态替换 Action Items

> ID：12884353
> 
> 赞同：3
> 
> 时间：2012-10-14T16:46:53.370
> 
> 标签：android, android-actionbar, actionbarsherlock

我已经通过 ActionBarSherlock 实现了一个 ActionMode（感谢 Jake Wharton 的 ABS！）。

无论如何，我 `mActionMode.invalidate();`每次单击 ListView 项目时都会调用它，这也会增加/减少一个checkedCounter。

然后在 public boolean`onPrepareActionMode(ActionMode mode, android.view.Menu menu)`中，我必须根据 checkedCounter 的值来设置 ActionMode 的内容。

onPrepareActionMode 的代码如下：

> ```
>  public boolean onPrepareActionMode(ActionMode mode,
>                 android.view.Menu menu) {
>             Log.d("ASDASD", "INSIDE ONPREPARE!");
>             if (mActionMode == null) {
>                 MenuInflater inflater = mode.getMenuInflater();
>                 inflater.inflate(R.menu.contextualmultiple, menu);
>                 return false;
>             }
>             if (checkedCount == 0) {
>                 mActionMode.finish();
>             } else if (checkedCount == 1 && mActionMode != null) {
>                 mActionMode.setTitle(checkedCount + " Message Selected");
>                 MenuInflater inflater = mode.getMenuInflater();
>                 inflater.inflate(R.menu.contextualmultiple, menu);
>                 return true;
>             } else if (checkedCount > 1) {
>                 mActionMode.setTitle(checkedCount + " Messages Selected");
>                 MenuInflater inflater = mode.getMenuInflater();
>                 inflater.inflate(R.menu.contextual, menu);
>                 return true;
>             }
>             return true;
>         } 
> ```

现在，问题是，当 checkCount 为 1 时，它会在菜单中增加 3 个项目。但是，当计数器增加到 2 时，它会用 1 个项目膨胀另一个菜单，但是会添加到先前膨胀的菜单上，而不会首先使内容无效。IE; 现在 ActionMode 在 Contextual ActionBar 中有 2 of previous + 1 of current ！

调用时如何更改我的代码以从 ActionMode 中删除以前存在的菜单项`mActionMode.invalidate()`？

PS：onCreateActionMode() 函数是空的，因为 onPrepareActionMode() 会做所有事情，包括当 mActionMode 为空并且第一次有菜单要膨胀时。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-15T06:37:45.550

哈哈！我为这个荒谬的问题找到了一个非常简单的解决方案！

对于可能遇到此问题的其他任何人，只需`menu.clear();`在所有 inflate() 语句之前添加一个语句，就是这样！

# ruby - 如何在 Ruby 中使用 before 和 after 包装方法？

> ID：12884360
> 
> 赞同：2
> 
> 时间：2012-10-14T16:47:48.037
> 
> 标签：ruby, metaprogramming, ruby-1.9.3

有没有更好的方法来实现以下目标？将方法列为符号似乎有点笨拙......

此代码为 4 种方法中的每一种运行`init`之前和`draw`之后。以下代码有效，但有没有更易读或惯用的方法呢？

```
Class DrawMap
  def draw_method_1
    ...
  end

  def draw_method_2
    ...
  end

  def draw_all
    [:draw_method_1, :draw_method_2, :draw_method_3, :draw_method_4].each do |method|
      init_draw
      send method
      @draw.draw
    end
  end

... 
```

Rails before 和 after 过滤器会做同样的事情，但这不是 Rails 应用程序。

红宝石 1.9.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:22:47.597

如果你只是想让上面的代码更简洁*一些*，你可以试试这个：

```
def draw_all
  (1..4).each do |n|
    init_draw
    send "draw_method_#{n}"
    @draw.draw 
  end
end 
```

[**否则，这里**](https://stackoverflow.com/questions/5513558/executing-code-for-every-method-call-in-a-ruby-module)有一个非常好的 SO 问题，可以真正帮助您。它涉及一些元编程，基本上重新定义方法并用一些额外的代码包装它们。`init_draw`在您的情况下，您将使用and包装`draw`。

# python - 来自正态分布的拉丁超立方体采样（Python）

> ID：12884361
> 
> 赞同：1
> 
> 时间：2012-10-14T16:47:59.487
> 
> 标签：python, random, python-2.7, random-sample

如何在 python 2.7 中使用拉丁超立方体采样技术从正态分布中生成 10 个随机数？随机数的范围应该是 5 到 14。

我试过以下

```
import random
from random import randint
iter = 10
segSize = 1 / iter
for i in range(iter):
segMin = i * segSize
point = segMin+ (random.normalvariate(7.5,1)*segSize)
pointValue = (point * (14 - 5)) + 4
print point
print pointValue 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:10:27.980

尝试这个：

```
def rand:
 import random
 from random import randint
 iter = 10
 segSize = 1/float(iter)
 for i in range(iter):
         segMin = float(i) * segSize
         point = segMin + (random.normalvariate(7.5,1) * segSize)
         pointValue = (point * (14 - 5)) + 4
         print point
         print pointValue 
```

您的问题似乎是整数乘法等，Python 在您的除法中将其截断为零。

当我运行它时，我得到：

```
0.686848045493
10.1816324094
0.871425699273
11.8428312935
1.08794202088
13.7914781879
1.08502172623
13.7651955361
1.24462345735
15.2016111161
1.10687801576
13.9619021418
1.1394488663
14.2550397967
1.37407532844
16.3666779559
1.54666717385
17.9200045647
1.6465869841
18.8192828569 
```

# numpy - vstack numpy 数组

> ID：12884362
> 
> 赞同：1
> 
> 时间：2012-10-14T16:48:04.040
> 
> 标签：numpy

如果我有两个 ndarray：

```
a.shape   # returns (200,300, 3)
b.shape   # returns (200, 300)

numpy.vstack((a,b))  # Gives error 
```

会打印出错误：ValueError: arrays must have the same number of dimensions

我试过做`vstack((a.reshape(-1,300), b)`哪种工作，但输出很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T16:59:45.760

你没有指定你真正想要的最终形状。如果是 (200, 300, 4)，则可以`dstack`改用：

```
>>> import numpy as np
>>> a = np.random.random((200,300,3))
>>> b = np.random.random((200,300))
>>> c = np.dstack((a,b)) 
>>> c.shape
(200, 300, 4) 
```

基本上，当您堆叠时，所有其他轴的长度必须一致。

[根据评论更新：]

如果你想要 (800, 300) 你可以尝试这样的事情：

```
>>> a = np.ones((2, 3, 3)) * np.array([1,2,3])
>>> b = np.ones((2, 3)) * 4
>>> c = np.dstack((a,b))
>>> c
array([[[ 1.,  2.,  3.,  4.],
        [ 1.,  2.,  3.,  4.],
        [ 1.,  2.,  3.,  4.]],

       [[ 1.,  2.,  3.,  4.],
        [ 1.,  2.,  3.,  4.],
        [ 1.,  2.,  3.,  4.]]])
>>> c.T.reshape(c.shape[0]*c.shape[-1], -1)
array([[ 1.,  1.,  1.],
       [ 1.,  1.,  1.],
       [ 2.,  2.,  2.],
       [ 2.,  2.,  2.],
       [ 3.,  3.,  3.],
       [ 3.,  3.,  3.],
       [ 4.,  4.,  4.],
       [ 4.,  4.,  4.]])
>>> c.T.reshape(c.shape[0]*c.shape[-1], -1).shape
(8, 3) 
```

# iphone - UISlider 根据设备改变宽度

> ID：12884363
> 
> 赞同：1
> 
> 时间：2012-10-14T16:48:11.287
> 
> 标签：iphone, ios, ipad, uitableview, uislider

我是 iOS 编程的初学者，我正在寻找我的问题的答案。

我在 UITableViewCell 中有一个 UISlider，我正在尝试获得这种配置：Label-Slider-DetailLabel(dynamic)。

这是我的代码：

```
cell = [tableView dequeueReusableCellWithIdentifier:@"SelectedMeetingCell"];
[cell.textLabel setText:@"Duration"];
[cell.detailTextLabel setText:[Utilities StringFromDuration:Agenda.InitialDuration.doubleValue]];

sliderCell = (SliderCell*)[[UIViewController alloc] initWithNibName:@"SliderCell" bundle:nil].view;
[sliderCell setDelegate:self];
[sliderCell.slider setValue:Agenda.InitialDuration.doubleValue];

[cell.contentView addSubview:sliderCell];

sliderCell.slider.frame = CGRectMake(100, 0, 500, 44); 
```

最后一行是我用来按我想要的方式放置滑块的方式。它适用于 iPad，但不适用于 iPhone 版本。有什么方法可以根据设备自动调整滑块的宽度吗？

（SliderCell 是带有 UISlider @property 的 UITableViewCell）

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:34:26.220

您可以获取容器视图宽度并将滑块宽度设置为它的百分比，而不是对值进行硬编码。

```
CGRect superViewFrame = slider.superView.frame;
CGRect sliderFrame = slider.frame;
sliderFrame.size.width = <your choice  for eg, superViewFrame.size.width * 0.3f>
sliderFrame.origin.x = <your choice for eg, superViewFrame.size.width * .2f>
slider.frame = sliderFrame; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T19:06:03.250

you can get the size of a device by calling `self.view`

`sliderCell.slider.frame = CGRectMake(100, 0, self.view.frame.size.width, self.view.frame.size. height);`

after you may want to subtract or divide depending on your view's size

# c++ - 如何从堆栈中找到代码的崩溃行？

> ID：12884368
> 
> 赞同：4
> 
> 时间：2012-10-14T16:48:34.680
> 
> 标签：c++, windows, exception, mfc

现在我有崩溃信息：

TestAPP 在 0023:5763c230 的模块 XCrashReportTest.exe 中导致访问冲突 (0xc0000005)。

```
Context:
EDI:    0x002aee0c  ESI: 0x002ad7f4  EAX:   0x00000000
EBX:    0x00000000  ECX: 0x57635670  EDX:   0x028c1d27
EIP:    0x5763c230  EBP: 0x002aee18  SegCs: 0x00000023
EFlags: 0x00010246  ESP: 0x002ad554  SegSs: 0x0000002b

Bytes at CS:EIP:                                                 
8b 08 52 50 8b 41 18 ff d0 8b 0d c8 e0 66 57 8b                  

Stack:                                                           
0x002ad554: 576504f7 002aee0c 002ad7f4 002ad570 ..eW..*...*.p.*. 
0x002ad564: 002aee0c 5763c201 002aee18 002ad59c ..*...cW..*...*. 
0x002ad574: 576490b1 5763c201 002aee0c 00000100 ..dW..cW..*..... 
0x002ad584: 002ad5f4 57648d9f 75785eaa 57668e70 ..*...dW.^xup.fW 
0x002ad594: 002aee0c 00000001 002ad604 5764d4d2 ..*.......*...dW 
0x002ad5a4: 002aee0c 57668e70 5763c201 00000000 ..*.p.fW..cW.... 
0x002ad5b4: 00000100 75785d2a 57668e5c 002aee0c ....*]xu\.fW..*. 
0x002ad5c4: 57668e4c 002add84 00000000 00000000 L.fW..*......... 
```

我指的是 XCrashReport[XCrashReport : 异常处理和崩溃报告 - 第 1 部分

但是我发现当我在同一台机器上运行相同的 *.exe 时，有时 EIP 会有所不同。所以，有时我无法将崩溃代码行与 EIP 匹配（XCrashReport 中描述的方法：异常处理和崩溃报告 - 第 1 部分。我不知道如何使用堆栈信息。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T18:49:37.853

唯一合理的方法是将故障转储加载到调试器中并提供符号，即 .pdb 文件。这可能很棘手，因为 pdb 文件可能没有足够的信息。像微软这样的公司提供的公共 PDB 文件没有关于本地变量名称和其他详细信息的信息。具有完整信息的 PDB 称为公共 PDB。

有时堆栈会损坏，这会导致“失去控制”。代码获取返回地址，即一些垃圾，将这个值加载到 EIP 并从那里开始执行指令。在这种情况下，在执行了几个“指令”之后，崩溃很快就会发生。

我的意思是你需要先弄清楚你的 EIP 是否指向任何代码。

# mysql - MySQL：当连接表有多个结果时，为什么这个选择查询找不到行？

> ID：12884372
> 
> 赞同：0
> 
> 时间：2012-10-14T16:49:07.150
> 
> 标签：mysql, join

标题可能比较混乱，不知道怎么写。这是我需要做的。我有两个表，cronjobs 和 cronjob_seeds。在将 cronjob 添加到数据库之前，我需要查看它是否存在。

考虑这些表：

定时任务：

```
-id-   -callback_model-         -callback_method-
1       movie_suggestion_model    fetch_similar_movies 
```

cronjob_seeds：

```
-cronjob_id-   -seed-
1               seed1
1               seed2 
```

在添加新的 cronjob 之前，我需要查看数据库中是否存在完全相同的 cronjob。我写了以下查询，但如果 cronjob 有多个种子，它就不起作用。如果它只有一个种子，它会很好用，但每次 cronjob 有多个种子时，它什么都不返回。

```
SELECT `id`
FROM (`cronjobs`)
INNER JOIN `cronjob_seeds` ON `cronjob_seeds`.`cronjob_id` = `cronjobs`.`id`
WHERE `cronjobs`.`callback_model` = 'movie_suggestion_model'
    AND `cronjobs`.`callback_method` = 'fetch_similar_movies'
    AND `cronjob_seeds`.`seed` = '1'
    AND `cronjob_seeds`.`seed` = 10 
```

我错过了什么吗？我应该使用其他类型的连接吗？

而且，题外话，但种子是回调方法的参数，我只是把它命名为有点奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T16:52:30.480

你应该使用 IN 子句

将您的查询更改为：

```
SELECT `id`
FROM (`cronjobs`)
INNER JOIN `cronjob_seeds` ON `cronjob_seeds`.`cronjob_id` = `cronjobs`.`id`
WHERE `cronjobs`.`callback_model` = 'movie_suggestion_model'
    AND `cronjobs`.`callback_method` = 'fetch_similar_movies'
    AND `cronjob_seeds`.`seed` IN ('seed1', 'seed2') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T16:55:31.137

仅检查 cron 条目是否存在，不需要加入，除非您需要检查它是否存在并且具有特定的种子。要仅检查是否存在 cron 条目，您需要执行以下操作：

```
SELECT `id`
FROM `cronjobs`
WHERE `cronjobs`.`callback_model` = 'movie_suggestion_model'
    AND `cronjobs`.`callback_method` = 'fetch_similar_movies' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:48:02.013

即使您有单行 _cronjob_seeds_ ，您的查询如何返回结果。导致最后两个 AND 条件相互冲突。您应该将其修改为：

```
 AND `cronjob_seeds`.`seed` BETWEEN  '1' AND '10' 
```

您是否还在质疑 cronjob_seed 或 cronjob 中是否存在记录？您的查询参数似乎不清楚。您是否正在尝试检查是否存在具有特定种子的特定 cronjob？提示：尝试用人类语言而不是 sql 编写查询

# python - 将 numpy/scipy 链接到串行 ATLAS

> ID：12884374
> 
> 赞同：1
> 
> 时间：2012-10-14T16:49:11.277
> 
> 标签：python, numpy, scipy

我的操作系统是 Fedora 16（尽管我在其他发行版上遇到过同样的问题）。

我想构建链接到串行 ATLAS（而不是线程）的 numpy/scipy。这似乎涉及在我的 site.cfg 文件中取消注释以下行：

```
[DEFAULT]
library_dirs = /usr/lib64/atlas
include_dirs = /usr/local/include
[blas_opt]
libraries = f77blas, cblas, atlas
[lapack_opt]
libraries = lapack, f77blas, cblas, atlas 
```

我已经这样做了，但是当我通过

```
python setup.py build 
```

它仍然链接到线程库，例如。

```
Setting PTATLAS=ATLAS
  FOUND:
    libraries = ['ptf77blas', 'ptcblas', 'atlas']
    library_dirs = ['/usr/lib64/atlas']
    language = c
    define_macros = [('ATLAS_INFO', '"\\"3.8.4\\""')] 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T07:15:17.247

我知道这已经一岁了，所以我写这个答案以防万一有人遇到同样的问题。

我可能会手动删除/重命名线程图集库。这有点难看，但它应该可以工作。

另一种解决方案可能是像这样配置 numpy：

```
[atlas]
library_dirs = /usr/lib64/atlas
atlas_libs = lapack, f77blas, cblas, atlas 
```

在 numpy中也有这个[提交](https://github.com/numpy/numpy/commit/ffd4332262ee0295cb942c94ed124f043d801eb6)说`{blas,lapack}_opt`实际上没有阅读部分。

# list - 错误：实例：Num (a -> b) 当我尝试获取列表元素的符号时

> ID：12884376
> 
> 赞同：0
> 
> 时间：2012-10-14T16:49:13.463
> 
> 标签：list, haskell

这就是我想要做的：

```
INPUT: [1,2,3,-1,-2,-3]
OUTPUT:[1,1,1,-1,-1,-1] 
```

我试过这个：

```
signNum (x:n) = map(if x>0 
            then 1 
            else -1)n 
```

谁能告诉我我在哪里犯了逻辑错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:02:44.023

第一个问题是`map`需要一个函数。因此，您必须将`if`语句包装在 lambda 中。但是，这仍然不会完全符合您的要求。而不是将列表分成头部和尾部，您真的希望将您的函数映射到整个列表。

请记住，`map`它只需要一个函数并将其应用于每个元素。由于您想将每个元素转换为`1`or `-1`，您只需要将适当的函数映射到您的列表。

所以最后，你得到：

```
sigNum ls = map (\ x -> if x > 0 then 1 else - 1) ls 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:13:04.677

在这种情况下，将函数分解为更小的部分可能更容易。

在最低级别，可以计算`signum`单个数字的 ，即：

```
signum :: (Num a, Ord a) => a -> a
signum x = if x > 0 then 1 else -1 
```

一旦你有了这个，你就可以在一个数字列表中使用它，就像你对任何函数一样：

```
signNum ls = map signum ls 
```

（ps 是什么`signum 0`意思？您当前的定义有`signum 0 = -1`.

如果您需要扩展功能以包含这种情况，最好使用警卫：

```
signum x | x < 0 = -1
         | x == 0 = 0
         | otherwise = 1 
```

或案例陈述：

```
signum x = case compare x 0 of 
             LT -> -1
             EQ -> 0
             GT -> 1 
```

)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T06:15:19.527

您的评论表明您希望能够通过理解来做到这一点。

## 如何使用理解

如果你确实想通过理解来做到这一点，你可以这样做

```
signNum ls = [ if x>0 then 1 else -1| x <- ls ] 
```

## 如何不使用理解

...但你不能把条件放在右手边

```
brokenSignNum ls = [ 1| x <- ls, x > 0 ] 
```

因为在右侧放置一个条件会删除任何不满足条件的东西 - 你所有的否定都会被忽略！这将缩短您的列表而不是替换元素。我们试试看

```
brokenSignNum2 ls = [ 1| x <- ls, x > 0 ] ++ [ -1| x <- ls, x <= 0 ] 
```

这与您的原始列表长度相同，但所有正面都在前面。

> 摘要：您必须将此条件表达式放在左侧，因为这是唯一可以发生替换的地方 - 在右侧它会删除。

## 零是负数吗？

请注意，您的 if 语句将 0 视为负数。你确定你想要那个吗？也许你会更好地单独定义一个数字的符号：

```
sign x | x == 0 = 0   -- if x is zero, use zero
       | x > 0 =  1   -- use 1 for positives
       | x < 0 = -1   -- use -1 for negatives

workingSignNum1 ls = [sign x | x <- ls] 
```

但是`sign`（几乎）与函数相同`signum`，所以我们不妨使用它

```
workingSignNum2 ls = [signum x | x <- ls] 
```

## 让它更整洁

现在，对于基本上意味着“替换`x`为`sign x`所有列表`ls`”的大量语法。我们经常做这种事情，所以我们可以写一个函数来做：

```
replaceUsing :: (a -> b) -> [a] -> [b]
replaceUsing f xs = [f x | x <- xs] 
```

但是已经有一个功能可以做到这一点！它被称为`map`。所以我们可以在列表中使用 map ：

```
quiteSlickSignNum :: Num a => [a] -> [a]
quiteSlickSignNum ls = map signum ls 
```

甚至更光滑：

```
slickSignNum :: Num a => [a] -> [a]
slickSignNum = map signum 
```

这就是我定义它的方式。

## 为什么说`sign`几乎*一样*`signum`？

`sign`接受一个数字并返回一个数字 , `1`, `0`or `-1`，但是 的类型是`1`什么？
好吧，`1`具有类型`Num a => a`，因此您可以将其与任何数字类型一起使用。这意味着 `sign`接受任何类型的数字并返回任何类型的数字，所以它的类型是

```
sign :: (Num a,Num b) => a -> b 
```

所以我的版本`sign`可以给你一个不同的类型。如果你尝试一下，你会发现`3 * sign 4.5`给你`3`，不是`3.0`，所以你可以从中得到一个整数，但如果你这样做`3.14 * sign 7.4`，你会得到`3.14`，所以你也可以得到一个小数类型。相比之下，

```
signum :: Num a => a -> a 
```

所以它只能把你给它的类型还给你——`3 * signum 4.5`给你`3.0`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T16:01:12.907

错误消息“no instance for `Num`”是新 Haskelers 最难破译的错误消息之一。首先，这是您尝试编写的函数的完全多态类型签名（我将其添加到源文件中以得到与您相同的错误）：

```
signNum :: (Ord a, Num a) => [a] -> [a] 
```

**发现错误**

现在，编译错误消息说：

> 无法从 prog.hs:3:17 处的文字 '1' 产生的上下文 (Ord a, Num a) 推断出 (Num (a -> a))

请注意，错误消息为我们提供了问题的位置。它说“文字 1”`file_name.hs:line_number:column_number`是问题所在。

```
signNum (x:n) = map(if x>0 
            then 1 -- <-- here's the problem! (according to that message)
            else -1)n 
```

**了解错误**

现在，错误消息还建议了一些可能的修复，但是每当您遇到“没有实例`Num`”时，建议的“可能修复”几乎总是错误的，因此请忽略它们。（我希望 GHC 能够为`Num`这样的相关内容提供更好的错误消息）。

回想一下错误消息所说的内容：

> 无法推断 (Num (a -> a)) ... 源自文字 '1' ...

这意味着您将文字`1`放在上下文预期类型的​​某处
`a -> a`。`1`显然不是函数，所以要么上下文错误，要么数字 1 错误。

那么字面量 1 的上下文是*什么？*

**找到错误（准确）**

```
(if x > 0
  then <<hole>>
  else -1) 
```

Haskell 中的 if 语句产生一个值。if 语句的分支必须具有相同的类型，if 语句的类型由分支的类型决定。

在这里，另一个分支的值为`-1`，它是一个数字。因此，我们期望`<<hole>>`具有相同的类型：数字。好吧，这显然不是问题（因为 1*是一个数字），所以让我们看一下**该*表达式的上下文。

```
map <<hole>> n 
```

该`map`函数需要一个函数作为它的第一个参数。但是，我们知道`<<hole>>`会产生一个数字。尤里卡！这是差异：我们`map`在它期望函数的地方给出了一个数字。

**纠正错误**

显而易见的解决方案——现在我们确切地知道问题出在哪里和在哪里——是给出`map`一个函数，而不是一个数字。有关详细信息，请参阅其他各种答案。

# c# - EF 5.0 Code First 向现有父级添加新子级

> ID：12884382
> 
> 赞同：2
> 
> 时间：2012-10-14T16:50:04.600
> 
> 标签：c#, entity-framework, ef-code-first

**概述：** 我正在使用 Code First 和 EF 5.0 开发 MVC ASP.Net 应用程序。我有两个表：Scripts 和 ScriptItems。一个脚本可以有多个 ScriptItem。ScriptItems 也是分层的。ScriptItems 可以选择性地属于彼此，但谢天谢地，这种关系只有 1 级深。这种关系由 ScriptItem.ParentId 指示。

**问题：** 使用 ScriptItems 创建一个新的脚本条目就可以了。当我尝试将 ScriptItems 添加到现有脚本时出现问题。如果我尝试添加没有 ParentId 的 ScriptItems，一切正常。一旦我尝试添加具有 ParentId 的 ScriptItems，我就会收到 FK 违规异常。

**细节：**

脚本类：

```
public class Script
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public string Type { get; set; }
    [ForeignKey("ProcessorId")]
    public Processor Processor { get; set; }
    public int ProcessorId { get; set; }
    public string Owner { get; set; }
    public DateTime Created { get; set; }
    public bool Public { get; set; }

    public List<ScriptItem> Items { get; set; }
    public List<ScriptRun> Runs { get; set; }

    public Script()
    {
        Items = new List<ScriptItem>();
        Created = DateTime.Now;
    }
} 
```

ScriptItem 类：（为简洁起见截断）

```
 public class ScriptItem
{
    [Key]
    public int Id { get; set; }

    [ForeignKey("ParentId")]
    public ScriptItem Parent { get; set; }
    public int? ParentId { get; set; }

    public Script Script { get; set; }
    [ForeignKey("Script")]
    public int ScriptId { get; set; } 
```

添加脚本项的函数：

```
private void addToScript(ScriptModel model, List<int> ids)
    {
        Script script = scriptRepository.GetScriptWithItems(model.ScriptId);
        List<History> historyItems = historyRespository.History.Where(h => ids.Contains(h.Id)).ToList();

        ScriptItem lastScriptItem = script.Items.OrderByDescending(item => item.SortIndex).FirstOrDefault();
        int topSortIndex = lastScriptItem == null ? 0 : lastScriptItem.SortIndex;

        if (script != null)
        {
            List<ScriptItem> newItems = new List<ScriptItem>();
            Mapper.CreateMap<History, ScriptItem>();
            foreach (History h in historyItems)
            {
                ScriptItem scriptItem = new ScriptItem();
                Mapper.Map(h, scriptItem); //Populate new ScriptItem from History entry
                scriptItem.SortIndex = ++topSortIndex;
                scriptItem.ScriptId = model.ScriptId;
                scriptItem.Script = script;

                //Only add an entry if it is NOT the parent of another entry. Otherwise, EF will duplicate the Parent entries
                if (!historyItems.Any(his => his.ParentId == h.Id))
                    newItems.Add(scriptItem);    
            }
            scriptRepository.AddScriptItems(newItems);
        }
    } 
```

最后是 scriptRepository.AddScripItems()：

```
public void AddScriptItems(List<ScriptItem> items)
    {
        items.ForEach(item => context.Entry(item).State = System.Data.EntityState.Added);
        context.SaveChanges();
    } 
```

考虑我将两个 ScriptItems A 和 B 添加到现有脚本的场景。A 是 B 的父级。当我运行 SQL Server 跟踪时，我看到尝试插入父记录 A，但 ScriptId 为 0，因此出现 FK 违规异常。不知道为什么 ScriptId 为 0。在 ScriptItems 上正确设置了 ScriptId，我用调试器验证了这一点。

我没有包含插入新脚本和项目的函数，因为它与上面的 addToScript 函数非常相似。它工作正常。但是如果有人想看，我也可以添加。

比我聪明的人有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T20:55:22.877

不知道是什么原因造成的。但我认为添加新`ScriptItem`的而`script.Items`不是设置他们的所有者脚本可能会有所帮助，即替换

```
scriptItem.ScriptId = model.ScriptId;
scriptItem.Script = script; 
```

经过

```
script.Items.Add(scriptItem); 
```

另一个优点是您不必再手动更改它们的状态：更改跟踪器知道何时将新项目添加到跟踪的集合中。我什至想知道在您的脚本中是否有必要这样做，因为设置`Script`也应该足够了。

也许设置`script` *和* 更改状态过多地干扰了 EF 自己的逻辑并使其偏离轨道`ScriptId` *。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T00:50:04.740

感谢 Gert Arnold 为我指明了正确的方向。这个问题最终源于我如何通过 AutoMapper 构建我的 ScriptItems。我无法解释确切的问题是什么，但这是我修改后的工作代码，以防有人发现它有用。

```
private void addToScript(ScriptModel model, List<int> ids)
    {
        Script script = scriptRepository.GetScriptWithItems(model.ScriptId);
        List<History> historyItems = historyRespository.History.Where(h => ids.Contains(h.Id)).ToList();

        ScriptItem lastScriptItem = script.Items.OrderByDescending(item => item.SortIndex).FirstOrDefault();
        int topSortIndex = lastScriptItem == null ? 0 : lastScriptItem.SortIndex;

        if (script != null)
        {
            Mapper.CreateMap<History, ScriptItem>();
            List<ScriptItem> Parents = new List<ScriptItem>();
            List<History> SourceParents = historyItems
                .Where(h => historyItems.Any(h2 => h2.ParentId == h.Id)).ToList();

            SourceParents.Each(h =>
            {
                ScriptItem parent = new ScriptItem();
                Mapper.Map(h, parent);
                parent.Script = script;
                Parents.Add(parent);
            });

            historyItems.Except(SourceParents).Each(h =>
            {
                ScriptItem child = new ScriptItem();
                Mapper.Map(h, child);
                child.Script = script;
                if (child.ParentId.HasValue)
                    child.Parent = Parents.SingleOrDefault(p => p.Id == child.ParentId);
                script.Items.Add(child);
            });

            //Todo: Get sortIndex "sorted" out

            scriptRepository.SaveScript(script);
        }
    } 
```

scriptRepository.SaveScript 只是将脚本的状态设置为已修改并调用 SaveChanges()。

# .htaccess - 控制器和路由

> ID：12884386
> 
> 赞同：0
> 
> 时间：2012-10-14T16:51:08.893
> 
> 标签：.htaccess, codeigniter, controller, routes

按照教程，可以通过application/controllers/pages.php处理所有静态页面的请求

```
class Pages extends CI_Controller {

    public function view($page = 'home')
    {
        if( ! file_exists('application/views/pages/'.$page.'.php'))
        {
            // Whoops, we don't have a page for that!
            show_404();
        }

        $data['title'] = ucfirst($page); // Capitalize the first letter

        $this->load->view('templates/header', $data);
        $this->load->view('templates/nav', $data);
        $this->load->view('pages/'.$page, $data);
        $this->load->view('templates/aside_right', $data);
        $this->load->view('templates/bottom', $data);
    }
} 
```

这适用于“主页”页面，但我似乎无法调用 view/pages/about 例如。

我试图为关于页面制作一个单独的控制器。它有效，但感觉有些不对劲。

应用程序/控制器/about.php

```
class About extends CI_Controller {

    public function index()
    {
        $this->load->view('templates/header');
        $this->load->view('templates/nav');
        $this->load->view('pages/about');
        $this->load->view('templates/aside_right');
        $this->load->view('templates/bottom');
    }
} 
```

我的 htaccess 文件或路由文件也有问题。使用上面编写的 About 控制器，我只能通过键入 domain.com/index.php/about 来访问该页面。我希望它是 domain.com/about 等。

这就是我的 routes.php 的样子：

```
$route['about'] = 'about';
$route['(:any)'] = 'pages/view/$1';
$route['default_controller'] = 'pages/view'; 
```

我的 Htaccess：

```
RewriteEngine on
RewriteBase /
# Hide the application and system directories by redirecting the request to index.php
RewriteRule ^(application|system|\.svn) index.php/$1 [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [QSA,L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:01:50.220

正如您已经说过的，您不需要为`about`页面使用另一个控制器。你的问题出在你的`routes.php`.

```
$route['about'] = 'about';
$route['(:any)'] = 'pages/view/$1';
$route['default_controller'] = 'pages/view'; 
```

这样，它将搜索一个名为“about”的控制器，但没有找到该控制器。如果删除第一行：

```
$route['(:any)'] = 'pages/view/$1';
$route['default_controller'] = 'pages/view'; 
```

它应该工作。在这种情况下，当您请求任何页面时，例如`about`它将调用`pages/view/about`，其中`pages`是控制器，`view`是函数，并且`about`是传递给函数的参数（替换默认值`$page = home`）。

我还发现了您的逻辑中的另一个错误。你写了

> 这适用于“主页”页面，但我似乎无法调用 view/pages/about 例如。

你不必打电话`view/pages/about`。你必须打电话`pages/view/about`。请记住，语法始终相同`Controller/Function/Variable1/Variable2/Variable3`。因此，如果您`about`的.`http://yourdomain.com/index.php/pages/view/about``http://yourdomain.com/about``$route['(:any)'] = pages/view/$1``routes.php`

# nsdictionary - 访问嵌套的 NSDictionary 10.8 SDK v 10.7 SDK

> ID：12884389
> 
> 赞同：0
> 
> 时间：2012-10-14T16:51:31.637
> 
> 标签：nsdictionary

我编写了一种方法来访问存储在 plist 中的嵌套字典。在 10.8 编译器上工作正常，但在 10.7 编译器上出现以下错误：

> 在对象类型“NSDictionary*”上找不到读取字典元素的预期方法

plist 具有以下结构：

```
<dict>
<key>15.144.15</key>
<dict>
    <key>Message</key>
    <string>15</string>
    <key>X</key>
    <real>484.8828125</real>
    <key>Y</key>
    <real>104</real>
</dict>
<key>15.144.17</key>
<dict>
    <key>Message</key>
    <string>17</string>
    <key>X</key>
    <real>612.91796875</real>
    <key>Y</key>
    <real>190.6484375</real>
</dict>
</dict> 
```

这是我用来访问 Message、X 和 Y 的嵌套值的代码：

```
NSString * value = [dictionaryFromPlist][parentKey][nestedKey]; 
```

我假设 10.8 SDK 以这种方式处理访问嵌套字典，但 10.7 没有。

有人知道与这两个 SDK 兼容的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T16:59:38.303

使用 10.8 SDK 编译并将部署目标设置为 10.7。这可以向后部署到 10.6。你的语法是错误的，寿。不要将变量名称括在括号中，只需将下标键括起来：

```
NSValue* value = dictionary[@"parentKey"][@"nestedKey"]; 
```

# jquery - 使用 JQuery ajax 将数据绑定到视图中的模型

> ID：12884394
> 
> 赞同：0
> 
> 时间：2012-10-14T16:52:21.310
> 
> 标签：jquery, asp.net-mvc, razor

在用 Razor 编写的 ASP.NET MVC 视图中，如何使用 JQuery 的 $.getJSON 或 $.ajax 将数据绑定到模型？

视图可以这样写吗？-

```
@model MyModel
$.getJSON('@Url.Action("MyAction","MyController")/', function (dataReturned) { 
    @model = dataReturned  //something like this? 
                           //how can you put the data into the Model?
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:19:19.843

您将客户端代码与服务器代码混合在一起，这将永远无法工作。你想做什么？创建对服务器的ajax请求并检索json？现在你的代码看起来很奇怪，在服务器上渲染 html，然后从客户端获取 json 数据并在客户端重新渲染服务器代码？

# javascript - 播放两次后不播放动态声音

> ID：12884401
> 
> 赞同：5
> 
> 时间：2012-10-14T16:53:13.320
> 
> 标签：javascript, jquery, html, audio

我有一个小的 html5 应用程序，您可以通过单击按钮来播放声音。

我有一个函数可以将`<audio>`标签添加到`<div>`id 为“正在播放”的 a 中。完成后声音会自行消失。

```
function sound(track){
$("#playing").append("<audio src=\"" + track + "\" autoplay onended=\"$(this).remove()\"></audio>");
} 
```

对于我有的按钮：

```
<button onclick="sound('sounds/tada.mp3')">Tada</button> 
```

当我单击按钮时，`<audio>`元素检查器中会短暂出现一个并在完成后消失，就像我想要的那样，但在触发它两次后，它至少在 Chrome 中停止工作。控制台中也没有错误。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:21:35.427

摆脱 HTML 中的 onclick/onend 并引用 js 中的按钮：

HTML

```
<button id='tada' sound_url='sounds/tada.mp3'>Tada</button> 
```

和 JS

```
var sound = function(track){
   $("#playing").append("<audio id='played_audio' src='\" + track + \"' autoplay='true'></audio>");
}

$('#tada').on('click', function () {
   var sound_url = $(this).attr('sound_url');
   sound(sound_url);
});

$('#playing').on('end', 'played_audio', function() {
   $(this).remove();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-24T09:00:38.407

好吧，让我们看看..

```
var audioURL = "http://soundbible.com/mp3/Canadian Geese-SoundBible.com-56609871.mp3";
var audioEl = null;

function removeAudio() {
  if (audioEl && audioEl.parentNode)
    audioEl.parentNode.removeChild(audioEl);
}

function sound() {
  removeAudio();
  audioEl = document.createElement("audio");
  audioEl.src = audioURL;
  audioEl.controls = true;
  audioEl.addEventListener("ended", removeAudio); // <-- Note it's ended, not end!
  document.getElementById("playing").appendChild(audioEl);
  audioEl.play();
}

document.getElementById("tada").addEventListener("click", sound);
```

```
<div id="playing">

</div>
<button id="tada">Tada</button>
```

我没有看到这个脚本有任何问题。

1.  决定audioURL，设置audioEl为null，后面会用到
2.  当点击带有 ID 的元素时`"tada"`，运行我们的`sound`函数。
    *   删除音频。
    *   创建音频元素。
    *   音频完成后，删除音频。
    *   将音频附加到 ID 的元素`"playing"`。
    *   播放音频。

需要注意的一点是，我使用的是`ended`事件，而不是`end`事件。

[（这个答案在这里是因为安德鲁真的希望我们回答它。）](https://scratch.mit.edu/discuss/post/1539340/)

# javascript - 自动调整图像大小以适应浏览器

> ID：12884402
> 
> 赞同：1
> 
> 时间：2012-10-14T16:53:21.557
> 
> 标签：javascript, html, image, autoresize

我有一个提供不同尺寸的“随机”图片的网站，如果不是大多数图片恰好不适合浏览器，所以我想知道一种方法来调整它的大小以适应浏览器视图而不滚动，那么为什么不堆栈溢出的家伙！

显然保持比例，我尝试了[https://github.com/gutierrezalex/photo-resize/](https://github.com/gutierrezalex/photo-resize/)但没有按预期工作。
所以它是一个带有一些文本的 html 页面，中间的图像和下面的一些其他文本。
我想要的只是滚动无法使用，因为图像应该缩小到足以这样做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-14T17:32:24.033

你不需要任何 JavaScript 或 hack 来实现这种图像缩放——简单的 CSS 和 HTML 就可以正常工作。（顺便说一句，iPad 和 iPhone 上也有。）

您可以只`img`使用 CSS 属性放置您的，`height:100%;`它将具有 DOM 树中父节点的高度。确保该节点（通常是 a `div`）将正确定位在浏览器窗口中。

尝试这样的事情：

```
<div style="position:fixed; height: 100%; width: 100%; top:0;left 0;">
  <img src='whatever.png' style="height: 100%" />
</div> 
```

查看此页面作为演示：[andrehelbig.fotograf.de](https://andrehelbig.fotograf.de)。在这里，背景图像将始终按比例缩放以填充整个浏览器窗口（不要被 JS 滚动激怒）。

希望能给一点帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-03T07:39:15.220

试试这个：

```
div {
  width:80vw;
  height:80vh;
  background:#ccc;
  display:table-cell;
  vertical-align:middle;
  text-align:center;
}
img {
  max-width:100%;
  height:auto;
  max-height:100%;
  }
```

```
<div>
  <img src="http://minisoft.com.bd/uploads/ourteam/rafiq.jpg">
</div>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T18:22:47.303

老问题，但对于未来的 googler，我编写了一个 jQuery 插件，它能够通过很多选项自动调整图像大小：

[https://github.com/GestiXi/image-scale](https://github.com/GestiXi/image-scale)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-05T01:06:24.627

我有一个简单的解决方案。

在图像中添加类，然后使用 jquery 自动调整图像大小。这里是代码：

```
<img src="" id="imgFitWindowResize"> 
```

现在使用 jquery 在客户端调整浏览器大小时初始化自动宽度：这里的代码：

```
<script type="text/javascript" language="JavaScript">
  function set_body_width() { // set body height = window height
    var wh = $(window).width();
    $(".imgFitWindowResize").width(wh);
  }
  $(document).ready(function() {
    set_body_width();
    $(window).bind('resize', function() { set_body_width(); });
  });
</script> 
```

我试试这个代码它的工作:)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-24T07:52:40.083

你能试试这个代码吗？将 image src 替换为您的图像源。

```
<html>
<head>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script>

$(document).ready(function() {
var h = $(window).height();
var w = $(window).width();
document.getElementById('img_canvas').style.height= h +'px';

});

</script>
</head>
<body>

<img id="img_canvas" src="images.jpg" style="width:100%;height:auto;">
</body>
</html> 
```

# c++ - C++ 从文件中读取整数和字符串

> ID：12884406
> 
> 赞同：0
> 
> 时间：2012-10-14T16:53:36.687
> 
> 标签：c++, string

我有一个看起来像的文件：

```
4
Sam Stone
2000
Freida Flass
100500
Tammy Flass
5000
Rich Raptor
55000 
```

我正在尝试从中读取，但 while 循环中的第一个 getline 始终不返回任何内容。int 4 被正确读取。

```
#include <iostream>
#include <fstream>
#include <cstdlib>
#include <vector>
#include <string>

using namespace std;

const int SIZE = 60;

struct person
{
    string name;
    double money;
};

int main()
{
    char filename[SIZE];
    string input;
    char inputs [50];
    int value;
    int count = 0;
    vector<person> Members;

    ifstream inFile;
    inFile.open("carinfo.txt");
    if (!inFile.is_open()){ cout << "Could not open fle"; }

    inFile >> value;
    Members.resize(value);

    while (inFile.good())
    {
        inFile.getline(inputs, SIZE); //getline(inFile, input, '\n');
        inFile >> value;

        count++;
    }
    cout << "Total lines = " << count;

    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T17:04:26.293

考虑使用`std::string`并`op>>(std::istream, person)`阅读元素，这对我有用

```
#include <string>
#include <vector>
#include <limits>
#include <fstream>
#include <iostream>
#include <iterator>

struct person
{
    std::string name;
    double money;
};

//read in 1 person
std::istream& operator>>(std::istream& is, person& p) {
    is >> p.money;
    is.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
    std::getline(is, p.name);
    return is;
}

int main() {
    //open stream
    std::ifstream file("fname");
    //create vector, let the stream operators do the hard work
    std::vector<person> v((std::istream_iterator<person>(file)),
                           std::istream_iterator<person>());

    std::cout << "count: " << v.size();
} 
```

[http://en.cppreference.com/w/cpp/iterator/istream_iterator](http://en.cppreference.com/w/cpp/iterator/istream_iterator)

# c++ - 在 C++ 中使用类指针维护范围

> ID：12884407
> 
> 赞同：0
> 
> 时间：2012-10-14T16:53:53.140
> 
> 标签：c++

我有一个类负责创建和初始化许多大对象，因为这些对象都是相同的类型，我不想为所有对象重复相同的初始化代码，我为每个对象调用一个 Init 方法对象，例如：

```
InitObject(objMember);

void Test::InitObject(LargeObject * obj)
{
    obj = new LargeObject;
    obj->Load();
    obj->SetSomeProperty(false);
} 
```

完成此操作后，我从公共方法调用一组方法来获取指向每个对象的指针：

```
//public
LargeObject * Test::GetObject()
{
    return objMember;
} 
```

问题是对象正在失去作用域，当调用 InitObject 时，对象被正确构造和填充，但是当我调用 GetObject 时，它失去了一切。

我可能遗漏了一些微不足道的东西，但我不明白为什么它会超出范围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:55:16.700

这是微不足道的，是的。您正在初始化原始指针的副本。您可能希望通过引用传递它：

```
void Test::InitObject(LargeObject*& obj) 
```

按值传递意味着您将返回分配给`new`指针的副本。函数外的那个`InitObject`保持不变。

还有一些事情 - 在构造后初始化对象应该小心。如果对象在构造后无效，则它是一个糟糕的设计（不包括一些极少数情况）。您可以通过从构造函数中抛出异常来发出无效初始化信号。

另外，考虑使用智能指针而不是原始指针。

# c# - 添加dll引用

> ID：12884408
> 
> 赞同：2
> 
> 时间：2012-10-14T16:53:57.290
> 
> 标签：c#, .net, wpf, dll, assemblies

我在添加 dll 引用时遇到了一个奇怪的问题。我有一个 WPF 应用程序并正在尝试使用 WPF MDI 库：[http ://wpfmdi.codeplex.com/](http://wpfmdi.codeplex.com/)

如说明中所述（非常模糊），我右键单击 VS2012 中的引用，单击`Add reference..`，单击`Browse..`并添加我下载的 dll。

接下来，我在窗口的 XAML 中添加了以下行：`xmlns:mdi="clr-namespace:WPF.MDI;assembly=WPF.MDI"`如说明中所述。

但是，在尝试添加 时`<mdi:MdiContainer>`，会显示以下错误消息：

`The type 'mdi:MdiContainer' was not found. Verify that you are not missing an assembly reference and that all referenced assemblies have been built.`

`The name "MdiContainer" does not exist in the namespace "clr-namespace:WPF.MDI;assembly=WPF.MDI".`

有任何想法吗？

**编辑：**

添加了我的 XAML 文件

```
<Window x:Name="..." x:Class="MyClass.MyClass"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mdi="clr-namespace:WPF.MDI;assembly=WPF.MDI"
        Title="" WindowState="Maximized">
    <Window.Resources>
        <Style TargetType="TreeView">
            <Setter Property="Padding" Value="0,0,20,0"/>
            <Setter Property="BorderBrush" Value="Gray"/>
            <Setter Property="BorderThickness" Value="0,0,5,0"/>
        </Style>
    </Window.Resources>
    <mdi:MdiContainer></mdi:MdiContainer>
</Window> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:37:00.347

[MDI Project](http://wpfmdi.codeplex.com/)的项目似乎使用 .Net 4 Client Profile。只需确保已使用 .Net Framework 4 运行时编译 WPF.MDI 项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:09:07.897

检查项目的 .NET Framework 设置。确保它未设置为*.NET Framework Client Profile*。因为根据我的经验，当框架设置不匹配时，通常会出现此错误。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-30T17:06:41.090

[从MDI 项目](http://wpfmdi.codeplex.com/ "MDI项目")下载 DLL 的源代码。重新编译到当前的 .net 版本，然后重新添加作为参考并重新编译您的项目。

# parsing - 水平标记化

> ID：12884411
> 
> 赞同：6
> 
> 时间：2012-10-14T16:54:36.737
> 
> 标签：parsing, tree, nlp, context-free-grammar

我必须实现水平标记化（NLP 概念），我在理解树的样子时遇到了一些麻烦。我一直在阅读[Klein 和 Manning 的论文](http://nlp.stanford.edu/~manning/papers/unlexicalized-parsing.pdf)，但他们没有解释具有 2 阶或 3 阶水平标记化的树会是什么样子。有人可以阐明算法以及树应该是什么样子吗？我对 NLP 比较陌生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-16T07:18:19.680

所以，假设你有一堆扁平的规则，比如：

```
NP 
    NNP
    NNP
    NNP
    NNP 
```

或者

```
VP
   V
   Det
   NP 
```

当您对这些进行二值化时，您希望保留上下文（即，这不仅仅是一个 Det，而是一个作为 VP 一部分的 Verb 之后的 Det）。为此，您通常使用如下注释：

```
NP 
    NNP
    NP->NNP
        NNP
        NP->NNP->NNP
            NNP
            NP->NNP->NNP->NNP
                NNP 
```

或者

```
VP
   V
   VP->V
       Det
       VP->V->Det
          NP 
```

您**需要**对树进行二值化，但这些注释并不总是很有意义。它们对于动词短语的例子可能有些意义，但你真正关心的只是名词短语可以是相当长的专有名词串（例如“Peter B. Lewis Building”或“Hope Memorial Bridge Project”周年纪念日”）。因此，使用水平马尔可夫化，您将稍微折叠一些注释，丢弃一些上下文。Markovization 的顺序是您要保留的上下文的数量。因此，使用普通注释，您基本上处于无限顺序：选择保留所有上下文并且不折叠任何内容。

Order 0 意味着你将删除所有的上下文，你会得到一棵没有花哨注释的树，如下所示：

```
NP 
    NNP
    NNP
        NNP
        NNP
            NNP
            NNP
                NNP 
```

订单 1 意味着您将只保留一个上下文术语，并且您会得到这样的树：

```
NP 
    NNP
    NP->...NNP  **one term: NP->**
        NNP
        NP->...NNP  **one term: NP->**
            NNP
            NP->...NNP  **one term: NP->**
                NNP 
```

订单 2 意味着您将保留两个上下文术语，并且您会得到这样的树：

```
NP 
    NNP
    NP->NNP  **two terms: NP->NNP**
        NNP
        NP->NNP->...NNP  **two terms: NP->NNP->**
            NNP
            NP->NNP->...NNP  **two terms: NP->NNP->**
                NNP 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T10:28:38.707

我相信这个想法是在估计规则概率时考虑垂直标记的父节点和水平的兄弟节点，并且顺序表明其中包括了多少。[这里](http://www.sfs.uni-tuebingen.de/~kuebler/esslli05/ext_pcfg.pdf)有一张很好的父注释图片。

另外，引用[http://www.timothytliu.com/files/NLPAssignment5.pdf](http://www.timothytliu.com/files/NLPAssignment5.pdf)：

> 为了接近词汇化，更多的信息被添加到每棵树的父节点上。这可以正确区分不同的附件以及是否向左分支或向右分支。水平马尔可夫化是通过在树被二值化时跟踪兄弟姐妹来完成的。垂直马尔可夫化是通过跟踪树中节点的父节点来完成的。这些创建了新的依赖关系，因为现在规则是深度和广度的组合。

# iphone - Objective-C iOS 上的协议

> ID：12884415
> 
> 赞同：0
> 
> 时间：2012-10-14T16:55:01.023
> 
> 标签：iphone, ios, delegates, protocols

我的应用程序和协议有问题。我无法发布图片（...），但我的 Storyboard 包含两个控制器。首先是带有 UIButton 的主菜单控制器。当用户按下按钮时，会出现一个表格视图，其控制器为“可用服务器控制器”。

好吧，主菜单控制器公开了以下协议：

```
#import <UIKit/UIKit.h>
#import "Client.h"
#import "MyRstAaAppDelegate.h"

@class MyRstAaClientViewController;

@protocol ClientNetworkDelegate <NSObject>
-(void)serverBecameAvaiable:(NSString *)peerID;
-(void)serverBecameUnavailable:(NSString *)peerID;
-(void)didConnectToServer:(NSString *)peerID;
-(void)didDisconnectFromServer:(NSString *)peerID;
@end

@interface MyRstAaClientViewController : UIViewController <ClientDelegate>

#pragma PROPERTIES
//Delegate property
@property (nonatomic, weak) id<ClientNetworkDelegate> delegate;

@end 
```

可用服务器表视图控制器实现协议的方法来重新加载表数据和做其他事情。这是它的代码：

```
#import <UIKit/UIKit.h>
#import "MyRstAaClientViewController.h"

@interface MyRstAaClientServerListTableViewController : UITableViewController <ClientNetworkDelegate>

@end 
```

……

还有他们

```
#import "MyRstAaClientServerListTableViewController.h"

@interface MyRstAaClientServerListTableViewController ()

//Client shared istance
@property (nonatomic, strong) Client *client;
@property (nonatomic, strong) MyRstAaClientViewController *mainController;
@end

@implementation MyRstAaClientServerListTableViewController

#pragma PROPERTIES
@synthesize client = _client;
@synthesize mainController = _mainController;

#pragma INITIALIZATION FUNCTIONS
- (void)viewDidLoad
{
    [super viewDidLoad];
    MyRstAaAppDelegate *appDelegate = (MyRstAaAppDelegate *)[[UIApplication sharedApplication]delegate];
    self.client = appDelegate.client;

    if(_mainController == nil)
        _mainController = [[MyRstAaClientViewController alloc]init];
    [self.mainController setDelegate:self];

    [self.tableView reloadData];
}

#pragma DELEGATES
-(void)serverBecameAvaiable:(NSString *)peerID;
{
    //Reload table data
    [self.tableView reloadData];

#ifdef DEBUG
    NSLog(@"CLIENT-SERVERLIST:: Server become Available");
#endif
}
-(void)serverBecameUnavailable:(NSString *)peerID;
{
    //Reload table data
    [self.tableView reloadData];

    #ifdef DEBUG
    NSLog(@"CLIENT-SERVERLIST:: Server become unavaiable");
    #endif
}
- (void)didConnectToServer:(NSString *)peerID
{
    #ifdef DEBUG
    NSLog(@"CLIENT-SERVERLIST:: Server become Available");
    #endif
}
- (void)didDisconnectFromServer:(NSString *)peerID
{
    #ifdef DEBUG
    NSLog(@"CLIENT-SERVERLIST:: did Disconnect From Server");
    #endif
} 
```

这是对我的应用程序的 MainMenu 控制器的 .m 文件进行委托调用的示例

```
#import "MyRstAaClientViewController.h"

@interface MyRstAaClientViewController ()

@property (nonatomic, strong) Client *client;

@end

@implementation MyRstAaClientViewController

#pragma PROPERTIES
@synthesize client = _client;
@synthesize delegate = _delegate;

-(void)Client:(Client *)client serverBecameUnavailable:(NSString *)peerID
{
#ifdef DEBUG
    NSLog(@"CLIENT-HOME:: Server become unavaiable");
#endif

    //Call delegate methodå
    [self.delegate serverBecameUnavailable:peerID];
} 
```

问题是，当我在 iPhone 上运行我的应用程序并进入“可用服务器”列表视图时，例如，我可以在输出中看到字符串：**CLIENT-HOME:: Server 变得不可用**，但相应的委托函数在表视图控制器中永远不会被调用。为什么？？

使用委托和协议模式有什么问题吗？

# codeigniter - PyroCMS CKEditor 格式化文本类型问题

> ID：12884418
> 
> 赞同：1
> 
> 时间：2012-10-14T16:55:35.967
> 
> 标签：codeigniter, ckeditor, pyrocms

PyroCMS v2.1

选择“格式化”文本类型时，在所见即所得（ckeditor）中添加新行/空白。有没有办法解决这个问题？

预期的代码如下所示：

```
class person {
    public $name;
    function __construct($persons_name) {
            $this->name = $persons_name;
    }

    function set_name($new_name) {
            $this->name = $new_name;
    }

    function get_name() {
            return $this->name;
   }

} 
```

但最终看起来像这样：

```
class person {

    public $name;

    function __construct($persons_name) {

            $this->name = $persons_name;

    }

    function set_name($new_name) {

            $this->name = $new_name;

    }

    function get_name() {

            return $this->name;

   } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T19:42:21.940

看起来像 CKEditor 3.4.2 的错误并在 3.5.1 中修复：

错误案例： [http ://dev.ckeditor.com/ticket/6630](http://dev.ckeditor.com/ticket/6630)

修复： [http ://dev.ckeditor.com/changeset/6321](http://dev.ckeditor.com/changeset/6321)

# android - Android 安全应用程序签名

> ID：12884424
> 
> 赞同：0
> 
> 时间：2012-10-14T16:56:13.703
> 
> 标签：android

如果我将签名的 apk 上传到 appmarket，任何其他开发人员都可以下载该 apk 并通过反向工程更改应用程序行为并以相同的名称和不同的符号上传。如果可能的话，有什么方法可以阻止它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:10:54.020

> 如果我将签名的 apk 上传到 appmarket，任何其他开发人员都可以下载该 apk 并通过反向工程更改应用程序行为并以相同的名称和不同的符号上传。

如果“同名”是指“相同的包”，则不。软件包只能通过创建其 Play 商店条目的同一 Google 帐户进行更新，并且该软件包必须使用相同的签名密钥进行签名。

如果“同名”是指“用户看到的相同标题或显示名称”，那么是的。

> 如果可能的话，有什么方法可以阻止它。

不要分发您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-04T02:11:39.657

您可以通过以下方式保护您的应用免受这种情况的影响：

*   在您的源代码中设置一些代码来检查应用程序的名称、包的名称。如果您检测到任何更改 -> 停止应用程序。

*   混淆您的来源以隐藏检查代码。您可以使用 Proguard（默认混淆器）或[Bg+ Anti Decompiler/Obfuscator](https://play.google.com/store/apps/details?id=com.bgplus.Anti.JavaDecompiler)（一种新的强大的混淆器）

# algorithm - 生成 1,000,000 个随机排列的样本

> ID：12884428
> 
> 赞同：3
> 
> 时间：2012-10-14T16:57:10.483
> 
> 标签：algorithm, language-agnostic, permutation, combinatorics, random-sample

我正在处理大量整数排列。每个排列中的元素数量为 K。元素大小为 1 字节。我需要生成 N 个唯一的随机排列。
约束：K <= 144，N <= 1,000,000。

我想出了以下简单的算法：

1.  生成 N 个随机排列的列表。将所有排列存储在 RAM 中。
2.  对列表进行排序并删除所有重复项（如果有）。重复的数量会相对较少。
3.  如果有任何重复，则将随机排列添加到列表中，直到有 N 个排列并返回到步骤 2。

有一个更好的方法吗？特别是，有没有办法不将所有排列存储在 RAM 中（在生成时将它们写入磁盘）？

**编辑**：最后，生成的排列需要顺序访问（一个接一个，不需要随机访问）。RAM 是更关键的因素（我不希望一次将所有排列存储在 RAM 中）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T17:41:41.370

一种可能的解决方案是使用**[布隆过滤器](http://en.wikipedia.org/wiki/Bloom_filter)**。

将排列存储在磁盘上（按顺序写入）并在 RAM 中维护一个布隆过滤器。
一旦你生成了一个排列——检查它是否存在于布隆过滤器中，如果布隆过滤器说它还没有写入磁盘——写它，布隆过滤器没有误报。
但是，如果布隆过滤器说它在磁盘上 - 它可能是错误的..

如果布隆过滤器说“排列已经存在”，你可以决定是否要退出这个候选并转到下一个而不检查它是否真的已经在集合中，或者你可以搜索磁盘以查看它是否在集合中真的在那里。 [如果您选择后者，您应该考虑为哈希表](http://en.wikipedia.org/wiki/Hash_table)或[B+ 树](http://en.wikipedia.org/wiki/B+_tree)
等排列维护一个智能 DS 。

布隆过滤器在这里是完美的匹配——它们被设计为代表一个易于阅读的集合，同时给出 0 个假阴性，这是这里最重要的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T20:01:40.413

我有点晚了，但我想我有一个尚未展示的方法。

我记得有一种算法，给定所有 K 个项目的起始顺序和一个整数索引，它会在大致与 K 成比例的时间内生成 K 个项目的第 index 个排列。知道它们的 K！（阶乘）K个项目的排列，只要你能随机生成一个零到K之间的整数！您可以使用该例程在内存中生成 N 个唯一随机索引，然后将相应的排列打印到磁盘。

这是算法的 Python 版本，其中 N 设置为 10，k 设置为 25，尽管我已成功使用 k = 144：

```
from math import factorial
from copy import copy
import random

def perm_at_index(items, index):
    '''
    >>> for i in range(10):
            print i, perm_at_index([1,2,3], i)

    0 [1, 2, 3]
    1 [1, 3, 2]
    2 [2, 1, 3]
    3 [2, 3, 1]
    4 [3, 1, 2]
    5 [3, 2, 1]
    6 [1, 2, 3]
    7 [1, 3, 2]
    8 [2, 1, 3]
    9 [2, 3, 1]
    '''

    itms, perm = items[:], []
    itmspop, lenitms, permappend = itms.pop, len(itms), perm.append
    thisfact = factorial(lenitms)
    thisindex = index % thisfact
    while itms:
        thisfact /= lenitms
        thischoice, thisindex = divmod(thisindex, thisfact)
        permappend(itmspop(thischoice))
        lenitms -= 1
    return perm

if __name__ == '__main__':
    N = 10      # Change to 1 million
    k = 25      # Change to 144
    K = ['K%03i' % j for j in range(k)] # ['K000', 'K001', 'K002', 'K003', ...]
    maxperm = factorial(k)              # You need arbitrary length integers for this!
    indices = set(random.randint(0, maxperm) for r in range(N))
    while len(indices) < N:
        indices |= set(random.randint(0, maxperm) for r in range(N - len(indices)))
    for index in indices:
        print (' '.join(perm_at_index(K, index))) 
```

其输出如下所示：

```
K008 K016 K024 K014 K003 K007 K015 K018 K009 K006 K021 K012 K017 K013 K022 K020 K005 K000 K010 K001 K011 K002 K019 K004 K023
K006 K001 K023 K008 K004 K017 K015 K009 K021 K020 K013 K000 K012 K014 K016 K002 K022 K007 K005 K018 K010 K019 K011 K003 K024
K004 K017 K008 K002 K009 K020 K001 K019 K018 K013 K000 K005 K023 K014 K021 K015 K010 K012 K016 K003 K024 K022 K011 K006 K007
K023 K013 K016 K022 K014 K024 K011 K019 K001 K004 K010 K017 K018 K002 K000 K008 K006 K009 K003 K021 K005 K020 K012 K015 K007
K007 K001 K013 K003 K023 K022 K016 K017 K014 K018 K020 K015 K006 K004 K011 K009 K000 K012 K002 K024 K008 K021 K005 K010 K019
K002 K023 K004 K005 K024 K001 K006 K007 K014 K021 K015 K012 K022 K013 K020 K011 K008 K003 K017 K016 K019 K010 K009 K000 K018
K001 K004 K007 K024 K011 K022 K017 K023 K002 K003 K006 K021 K010 K014 K013 K020 K012 K016 K019 K000 K015 K008 K018 K009 K005
K009 K003 K010 K008 K020 K024 K007 K018 K023 K013 K001 K019 K006 K002 K016 K000 K004 K017 K014 K011 K022 K021 K012 K005 K015
K006 K009 K018 K010 K015 K016 K011 K008 K001 K013 K003 K004 K002 K005 K022 K020 K021 K017 K000 K019 K024 K012 K023 K014 K007
K017 K006 K010 K015 K018 K004 K000 K022 K024 K020 K014 K001 K023 K016 K005 K011 K002 K007 K009 K013 K019 K012 K021 K003 K008 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:41:23.523

这是一种方法。

1) 生成前 N 个排列并将它们存储在磁盘上。

2）然后对排列运行随机化算法。

您可以使用 Divide and Conquer 进行优化，方法是仅从磁盘中选择第一个 X 元素，然后对其进行随机化，然后在下一次迭代中选择下一个 X 元素，依此类推……然后合并结果。

您可能不需要这里的磁盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-27T21:45:08.853

鉴于`10! ~= 3e6`即`K > ~15`如果你使用适当的 Fischer-Yates 或 Knuth 洗牌一百万次洗牌 K 个项目的列表，那么你很可能每次都得到一个独特的洗牌。

如果您可以将所有一百万个唯一排列保存在一个集合数据结构中的内存中，那么您可以打乱 K 个项目的列表并将它们添加到集合中，直到您拥有一百万个。

下面是一些 Python，它还显示了 shuffle 在为不同的 K 生成唯一烫发方面的效果：

```
>>> from math import factorial
>>> from random import shuffle
>>> 
>>> n = 1000000
>>> for k in range(16, 9, -1):
    perms = set()
    perm = list(range(k))
    trials = 0
    while len(perms) < n:
        trials += 1
        for i in range(n - len(perms)):
            shuffle(perm)
            perms.add(tuple(perm))
    print('N=%i, K=%i, trials=%i, K!//N= %i' % (n, k, trials, factorial(k)//n))

N=1000000, K=16, trials=1, K!//N= 20922789
N=1000000, K=15, trials=1, K!//N= 1307674
N=1000000, K=14, trials=2, K!//N= 87178
N=1000000, K=13, trials=2, K!//N= 6227
N=1000000, K=12, trials=3, K!//N= 479
N=1000000, K=11, trials=5, K!//N= 39
N=1000000, K=10, trials=11, K!//N= 3
>>> 
```

# php - 在不重新启动 HTTP 服务器的情况下安装 PHP 扩展

> ID：12884432
> 
> 赞同：1
> 
> 时间：2012-10-14T16:57:37.973
> 
> 标签：php, php-extension, httpserver

如何在不重新启动 HTTP 服务器的情况下安装 PHP 扩展？（在开发或生产环境中）

有什么办法可以防止任何服务器停机？

各大网站都是怎么做这样的改动的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T16:59:23.293

在 Apache 上而不是“重新启动”做“重新加载”。它将重新加载配置并且不会导致任何停机。

对于像 Nginx 或 lighttpd 这样的其他人，我不知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:20:18.967

> 各大网站都是怎么做这样的改动的？

主要网站拥有不止一台服务器——在 Facebook 或 Google 等情况下，有数十万台服务器。

这使得更新就像将负载平衡器设置为不将任何用户发送到需要升级的服务器、进行升级并将其重新投入使用一样简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T15:07:43.107

Apache 有`service httpd reload`- 它没有重新启动服务器，只是重新加载配置文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-14T17:15:26.037

在 linux 上，您可以使用*kill -1 < service name>*来更新配置。

# android - 即使父 Activity 暂停，admob AdView 使用的 WebViewCoreThread 也在使用高 CPU

> ID：12884433
> 
> 赞同：15
> 
> 时间：2012-10-14T16:57:49.070
> 
> 标签：android, android-webview, admob, adview

我正在使用 Google Admob SDK v6.1.0 (https://developers.google.com/mobile-ads-sdk/download)，并以编程方式（不在 XML 中）实例化 com.google.ads.AdView，并添加在我的 Activity 中动态地将它变成一个 LinearLayout。

我的一位用户报告说，当他们在我的 Activity 中单击 Home 按钮时（为了将其设置为背景），他们开始看到来自我的应用程序的高 CPU 使用率。我能够在 Jellybean 平台上重现这一点，并注意到高 CPU 使用率的来源是 WebViewCoreThread。

我的 Activity 根本不使用任何 WebView，但我能够逐步完成 Activity 的初始化，并注意到当我实例化 AdMob AdView 对象时，此 WebViewCoreThread 启动。正如 AdMob 引用中的状态，我在我的 Activity 的 onDestroy() 方法中对这个 AdView 调用了 destroy()。我也更改了我的代码，在我的 onPause() 方法中调用 AdView.onDestroy()。但似乎没有什么会导致 WebViewCoreThread 停止。我想，如果那个线程粘在我身边，我会没事的。但是如果我一遍又一遍地启动我的活动，这个线程开始使用我的 CPU 的 8% 到 25% 之间的任何地方，即使我的活动不在前台。

我注意到其他一些用户说您必须调用 WebView.onPause() 作为纠正措施。(http://stackoverflow.com/questions/2040963/webview-threads-never-stop-webviewcorethread-cookiesyncmanager-http0-3) 但这对我来说是不可能的，因为我的网络视图是由 AdMob 的 AdView 创建的。我还更改了我的代码，为 mt Admob AdView 的容器 LinearLayout 对象调用 .removeAllViews()，然后调用 System.gc() 强制垃圾收集，但似乎没有什么能杀死我的 WebViewCoreThread，最终它开始占用 CPU，直到我强制-杀死我的应用程序的进程。

AdMob为什么这样做的任何线索，以及我如何强制这个线程被杀死？

我正在附加一个我创建的类来封装 AdView 创建和销毁。我在我的活动初始化中调用了这个类的 getNewAd() 方法。我在我的 Activity 的 onPause() 和 onDestroy() 方法中调用这个类的 removeAd() ：

```
package com.shiprack.client;

import com.google.ads.AdRequest;
import com.google.ads.AdSize;
import com.google.ads.AdView;
import com.mobclix.android.sdk.Mobclix;
import com.mobclix.android.sdk.MobclixMMABannerXLAdView;

import android.app.Activity;
import android.view.Gravity;
import android.view.ViewGroup.LayoutParams;
import android.widget.LinearLayout;

public class AdManager {
    public AdManager(EventLog logger, LinearLayout container, Activity activity) {
        _container = container;
        _activity = activity;
        _eventLogger = logger;
    }

    public void setNetwork(int network) {
        _network = network;
    }

    public void getNewAd() {
        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT);
        params.gravity = Gravity.CENTER;
        switch (_network) {
            case TrackDatabase.AD_NETWORK_ADMOB: {
                _admobBanner = new AdView(_activity, AdSize.BANNER, "a14dc419375634c");
                _container.addView(_admobBanner, params);
                _admobBanner.loadAd(new AdRequest());
                break;
            }
            case TrackDatabase.AD_NETWORK_MOBCLIX: {
                Mobclix.onCreate(_activity);
                _mobclixBanner = new MobclixMMABannerXLAdView(_activity);
                _container.addView(_mobclixBanner, params);
                _mobclixBanner.getAd();
                break;
            }
        }
    }

    public void removeAd() {
        switch (_network) {
            case TrackDatabase.AD_NETWORK_ADMOB: {
                _admobBanner.destroy();
                break;
            }
            case TrackDatabase.AD_NETWORK_MOBCLIX: {
                _mobclixBanner.cancelAd();
                break;
            }
        }
        _container.removeAllViews();
    }

    private EventLog _eventLogger;
    private LinearLayout _container;
    private Activity _activity;
    private AdView _admobBanner;
    private MobclixMMABannerXLAdView _mobclixBanner;
    private int _network;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-08T06:43:13.723

不确定是否有人仍然需要这些信息，但我自己一直在寻找解决方案。显然 AdMob 仍然存在缺陷。

唯一的问题是，这将阻止所有 WebView 在后台运行。仅当您的应用程序依赖于此操作时才会出现问题。

添加到`onPause()`：

```
new WebView(this).pauseTimers(); 
```

并`onResume()`：

```
new WebView(this).resumeTimers(); 
```

这来自声称他们正在调查的 Google 员工： [https ://groups.google.com/d/msg/google-admob-ads-sdk/Qu4G19NFAuI/wcNkoV0AeDUJ](https://groups.google.com/d/msg/google-admob-ads-sdk/Qu4G19NFAuI/wcNkoV0AeDUJ)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-29T16:17:31.413

PZolee 在他的博客中发布了关于这个主题和建议的解决方案：[https ://pzoleeblogen.wordpress.com/2014/07/08/android-how-to-solve-adview-cpu-sumption/](https://pzoleeblogen.wordpress.com/2014/07/08/android-how-to-solve-adview-cpu-consuming/)

我对此进行了进一步调查（在博客文章的评论中记录了我的挣扎）并得出以下结论：

1.  事实上，只调用 adView.pause(); 即使应用处于后台且广告不可见，也不会阻止 Google Ads 组件消耗 CPU。
2.  在我们的 adView 中查找所有 WebView 并对其调用 onPause() 和 onResume() WevView 方法并不能解决不必要的 CPU 消耗问题。
3.  只有上述帖子的作者提出的对 WebView pauseTimers() 和 resumeTimers() 方法的调用才能停止不必要的 CPU 消耗。
4.  递归查找所有 WebView 并在所有 WebView 上调用 pauseTimers() 和 resumeTimers() 是不必要的，因为这样的调用“暂停（或恢复 - g.）所有 WebView 的所有布局、解析和 JavaScript 计时器。（在一个进程内 - g.）” - 请参阅 WebView 组件文档。
5.  如果您在应用程序的其他任何地方使用 WebView - 也许在其他活动中，您必须为它 resumeTimers() ，否则它将无法正常工作。另外，请注意，WevView 可能是临时构建的，并由您在项目中使用的某些库函数使用，而您并不明确知道它。例如，它可能是登录某个网站、社交网络等的提示。如果在您的进程中某处调用了 pauseTimers() 并且您没有恢复它们，则此类 WebView 可能再次无法正常工作。尽可能小心并进行测试。

真可惜，Google 和 AdMob 用他们的广告组件给我们带来了如此令人讨厌的惊喜（即使你在后台运行应用程序、隐藏他们的组件，甚至用他们自己的 API 调用 pause() 它也会持续消耗 CPU...</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-23T16:35:30.940

在对 admob AdView 对象调用 destroy() 之后，我现在将引用设置为 null，这会删除对 AdView 的所有引用，这可能会导致它被垃圾收集，从而避免任何 WebViewCoreThreads 无限期地运行。总的来说，我不喜欢这种方法——这种清理工作应该在 AdMob 销毁中处理。或者实际上，我什至不必调用 destroy() - 它会减慢我的 onPause 活动。

不过有很大的缺点：我的很多用户都抱怨在我的应用程序中按下后退或主页按钮时速度很慢。显然，这是因为在调用 admob destroy() 时花费了时间在 onPause() 方法中。长期的解决方案是使用 Fragments 和 ActionBar，而不必创建 Admob 横幅的多个副本（每个活动一个）

# iphone - 配置时未为参数“appIdName”提供值

> ID：12884434
> 
> 赞同：33
> 
> 时间：2012-10-14T16:57:51.767
> 
> 标签：iphone, ios, xcode, ios-provisioning

我刚刚注册了 Apple 的 iOS 开发者计划（帐户类型：个人）。

在我的 iPhone 4 设备上的 Xcode 管理器中，我单击“将设备添加到配置门户”=> Xcode 询问我的凭据 => 我输入它们 => 我看到“没有为参数 'appIdName' 提供值。” 对话窗口。

我错过了什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-03T07:48:52.543

Xcode 自动提交证书请求的部分过程是它寻找“通配符”应用程序 ID。如果您错过了这个（由于某种原因，它是在某些帐户上自动创建的，而不是在其他帐户上自动创建的？），这个自动化过程可能会失败。

要修复它，请尝试以下操作：

1）“撤销”您在开发者门户中可能拥有的任何现有证书

2）创建一个新的“App Id”；将其命名为“通配符”；并且只输入“*”（不带任何空格或引号）作为后缀。

3) 再次尝试从 Xcode 中的自动证书请求，它现在应该可以工作了

干杯!

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-15T09:29:44.270

我在 Xcode 中遇到了同样的问题。我认为这与 Xcode 为您创建的通配符应用程序 ID 有关。该过程似乎存在问题，然后取消了您尝试完成的设备添加过程。

您应该仍然可以通过[iOS 开发中心](https://developer.apple.com/devcenter/ios/index.action)添加设备。登录后，转到 Provisioning Portal，您可以在那里添加设备。

我知道并不完美，但应该允许您开始在您的设备上构建应用程序和测试，直到 Xcode 问题得到解决。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-20T17:10:06.693

您可以通过在 iOS 开发中心使用通配符 ID 制作 App ID 来避免此问题。

我猜主办方无法遵循 iOS Dev Center/Provisioning Portal 中与 App ID 相关的更新政策。

带有通配符（“*”）的 App ID 似乎在某些功能中受到限制，例如推送通知、游戏中心。并且开发人员似乎还需要确保应用程序的安全选项与应用程序 ID 相关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-16T15:21:18.987

实际上，我最初的目标是能够在 iPhone 设备上测试我的应用程序。单击“将设备添加到配置门户”仍然会导致主题错误，但无论如何我的 iPhone 设备已以某种方式添加到配置门户，现在我可以在 iPhone 上看到我的应用程序（我什至没有尝试通过 iOS Dev 添加它中心）。我的猜测是这个过程需要多个步骤才能完成，现在只有最后一个仍然失败，而其余的都成功了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-18T13:50:58.320

在我的情况下，该应用程序的配置文件**无效**，然后我执行了以下步骤：

1.  登录开发者门户
2.  单击证书、标识符和配置文件部分。
3.  转到 Provisioning Profiles，在列表中我意识到**我的应用配置文件无效**。
4.  单击以**编辑**它并选择相应的证书（全部）和设备（全部）。
5.  下载配置文件并取消运行。问题解决了。

# c - 随机数 C

> ID：12884435
> 
> 赞同：-3
> 
> 时间：2012-10-14T16:58:00.520
> 
> 标签：c, random

必须编写一个函数返回一个从 50 到 100 的平方数，不使用种子并且不带参数。

我知道如何生成一个固定范围内的随机数（例如 0 到 99）：

```
 int n;
   n=rand(100);  /* n is random number in range of 0 - 99 */ 
```

**编辑：** 顺便说一句，我使用`rand()`并且每次运行它都会给我相同的结果。我知道它是因为我的编译器，有没有办法改变它（记住不要使用种子）

任何想法都非常感谢！

***编辑 2：***好的，我想出了如何满足所有要求。谢谢你们！ ***Massimiliano*是第一个给我正确想法的人。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:00:16.893

这绝对是一个数学问题而不是编程问题，但答案就在问题中：

```
int n = random(51)+50;
return n*n; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:10:23.243

在 范围内选择一个随机数`50 to 100`。然后返回它的正方形。

```
int func(){
    int r = random(51); //to choose a random number from 0 to 50.
    r = r + 50; //to scale it to fit form 50 to 100
    return r*r;
} 
```

# android - 如何打开用户选择的文件（android-api-16）？

> ID：12884436
> 
> 赞同：0
> 
> 时间：2012-10-14T16:58:13.630
> 
> 标签：android, android-intent

当用户打开文本文件时，他会看到“打开方式”对话框，他在其中选择我的应用程序（并且可能选择“默认使用”）。从那里我如何获得用户选择的文件的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:09:22.583

`getIntent().getData()`将返回`Uri`与用户打开的任何内容相关联的内容。然后，您可以使用 a`ContentResolver`以流的形式获取该内容。

# php - php 发送文件附件 inbuild 脚本

> ID：12884451
> 
> 赞同：-1
> 
> 时间：2012-10-14T16:59:52.333
> 
> 标签：php, email-attachments

> **可能重复：**
> [如何使用 PHP 发送带附件的电子邮件？](https://stackoverflow.com/questions/2027069/how-to-send-email-with-attachment-using-php)

您好，我是 php 新手，请告诉我任何脚本或链接（用于发送带有文件多个附件的邮件的 php 脚本）以及 html 表单，以及如何连接此表单或任何内置脚本，以便我可以上传到我的服务器。我已经通过处理代码并粘贴它们并更改路径来尝试多种方式，但仍然会出现很多错误，所以请让我知道是否有内置脚本可以轻松上传到我的服务器

```
<?php
if($_GET['name']== '' || $_GET['email']=='' || $_GET['email']=='' || $_GET['Message']=='' )
{
?>

<form action="check3.php" method="get" name="frmPhone"> 
<fieldset> 
<legend style="color:#000">Contact    </legend>  
<table width="100%">
<tr>
<td width="29%">
<label for="name"     <?php     if(isset($_GET['Submit']) && $_GET['name']=='') echo "style='color:red'";    ?>>Name*    </label>     </td>    <td width="71%">
<input id="name" name="name" type="text" style="width:50%" value="    <?php echo $_GET['name'];    ?>"/>    </td>    </tr>    <tr>    <td>

<label for=" email"     <?php     if(isset($_GET['Submit']) && $_GET['email']=='') echo "style='color:red'";    ?>>Email*    </label>     </td>    <td>
<input id="email" name="email" type="text" style="width:50%" value="    <?php echo $_GET['email'];    ?>"/>     </td>    </tr>
</table>
</fieldset> 
<fieldset> 
<legend style="color:#000">Inquiry    </legend>  
<table width="100%">
  <tr>    <td width="41%" valign="top">

    <label for="Message"     <?php     if(isset($_GET['Submit']) && $_GET['Message']=='') echo "style='color:red'";    ?>>Message*</label>     </td>    <td width="59%">    <textarea name="Message" rows="5" style="width:90%" id="Message">    <?php echo $_GET['Message'];    ?>    </textarea> </td><div align="center">Photo
     <input name="photo" type="file" size="35" />
    </div></td>   
  </tr>
  <tr>

     <input name="Submit" type="submit" value="Submit" />
</form>    </td>    </td>

</form>

  </tr>

<?php
 }
else
{
$to      = 'abhi326@gmail.com';
$subject = 'Customer Information';
$message = '
Name: '.$_GET['name'].'
Email Address: '.$_GET['email'].'
Message: '.$_GET['Message'];

$headers = 'From:'.$_GET['email'];

mail($to, $subject, $message, $headers);

$connection=mysql_connect("db2173.perfora.net", "dbo311409166", "malani2002") or die(mysql_error());
 $query = mysql_query("INSERT INTO  `feedback` (  `name` ,  `email` , `Message` ,  `photo` ) VALUES ('".$_GET['name']."',  '".$_GET['email']."', '".$_GET['Message']."')");
define ("MAX_SIZE","75"); 
if(isset($_FILES['photo']['name']) && $_FILES['photo']['name']<>"")    {
$typ = $_FILES['photo']['type'];
    if($typ == "image/g    if" || $typ == "image/png" || $typ == "image/jpeg" || $typ == "image/pg    if" || $typ == "image/ppng" || $typ =="image/JPEG")
    {
    $uploaddir = "contacts/";
    $uploadimages = $uploaddir.basename($_FILES['photo']['name']);
        if(move_uploaded_file($_FILES['photo']['tmp_name'], $uploadimages))      {
        echo "File successfully copied";
        $sql="INSERT INTO contacts (Photo, Beschrijving)
        VALUES ('$uploadimages',
                            '$_POST[images]')";
            if (!mysql_query($sql,$con))    {
            die('Error: ' . mysql_error());
            mysql_close($con);
             }
         }
        else    {echo "Copy unsuccessful";     }
     }
    else    { 
    echo "Incorrect file type";
     }
 }
else    {
echo "No file selected";
 }
echo "Thank you! ";
 }
?> 
```

感谢和问候阿比

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:10:11.540

The script you're lookingfor is [phpMailer](http://code.google.com/a/apache-extras.org/p/phpmailer/).

This script can be downloaded and is easily added to your PHP programs. It makes sending emails from PHP extremely easy, including adding attachments.

Hope that helps.

# google-apps-script - 在电子表格中归档数据

> ID：12884456
> 
> 赞同：2
> 
> 时间：2012-10-14T17:00:28.773
> 
> 标签：google-apps-script, google-sheets, google-bigquery

我已经实现了一个基于用户填写的电子表格的时间预订系统，然后将其合并到一个中央（和大）电子表格中。

在经历了一些性能问题之后，整个应用程序现在已经完美运行了几个月。但是，我很快就会遇到电子表格的大小限制（400k 单元格）。

在合并的电子表格中，我基本上不需要比当前月份更多的数据。但是，出于统计目的，如果我能让域用户轻松访问数据，我将不胜感激。

基本上 BigQuery 服务是完美的，但我没有找到一个 API 可以从电子表格中写入数据。出于成本原因，我犹豫是否使用 Google 提供的 MySQL 数据库。

周围还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T12:45:56.647

有一个内置的 Google BigQuery API for Apps Scripts，您只需在`Resources > Use Google APIs`. 还有 Fusion Tables，它没有内置 API，但通过`UrlFetch`.

无论如何，如果是出于统计目的，您为什么不在另一个电子表格中“编译”数据呢？例如`month - amount of entries - total prices - avg etc - etc...`

# c++ - 迁移到 VS 2010 后 DoModal 无法正常工作

> ID：12884457
> 
> 赞同：0
> 
> 时间：2012-10-14T17:00:32.843
> 
> 标签：c++, visual-c++, mfc

我已将* *MFC* * 项目从**VC 6****迁移**到**VS 2010**项目。现在我们实现的**自定义对话框****使用 CDialog::DoModal**并且它不工作并且在这一行失败 **HRSRC hResource = ::FindResource(hInst, m_lpszTemplateName, RT_DIALOG)** 在**新项目**中它**返回 Null**而在**旧**项目中**得到一个值**。- 项目正常构建，所以我认为我不会忘记导入**资源**？- 我正在使用**丝带*************************在新项目中这是否与问题有关？- 我应该将自定义对话框的继承更改为**CDialogEx**吗？***********************

 *****更新了我创建了一个新的自定义对话框，它继承了 CDialog 和 DoModal 工作得很好问题出在 DoModal 中的那些行

```
hInst = AfxFindResourceHandle(m_lpszTemplateName, RT_DIALOG);
HRSRC hResource = ::FindResource(hInst, m_lpszTemplateName, RT_DIALOG);
hDialogTemplate = LoadResource(hInst, hResource); 
```

由于 hInst 无法正常返回，因此所有其他调用都失败了。该问题与使用另一个 dll 中的对话框和资源有关。我还是不明白为什么VS2010出现了这个问题，VS 6没有出现这个问题。而且这个问题怎么解决！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T00:39:51.847

好吧，它没有找到资源，所以有两种可能性：

1) 资源不在您的可执行文件中 2) 包含资源的模块不在 MFC 资源链中

首先，在 IDE 中打开您认为资源所在的 .exe 或 .dll 文件。当您在 IDE 中打开模块时，它将作为资源文件打开。搜索模块中的对话框并验证它是否确实在模块中。

如果您确实验证了资源是否在模块中，那么在调用 DoModal() 之前使用包含该资源的模块的 HINSTANCE 调用 AfxSetResourceHandle()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T09:25:31.403

尝试更改为您的`IDD_YOURDIALOG`. 也许它与 MFC 10.0 中的一些新资源冲突？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T13:28:06.303

缺少资源时出现问题。1- 将适当的 rc 文件添加到显示问题的项目中。2-解决了资源中的一些重复问题。

仍然不明白为什么它在旧项目中工作而在新项目中失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-11T21:20:59.227

可能为时已晚，但我发现这篇文章是因为我遇到了类似的问题。问题出在 Vista 对话框样式中，这是 VS2010 中的默认设置。我刚刚在基类初始化中添加了两个零，它开始像以前一样工作：

```
IMPLEMENT_DYNAMIC(LoadAscii_dlg, CFileDialog)

LoadAscii_dlg::LoadAscii_dlg(LPCTSTR lpszFileName) :
        CFileDialog( TRUE, "txt", lpszFileName, 
        OFN_OVERWRITEPROMPT | OFN_HIDEREADONLY | OFN_ENABLETEMPLATE | OFN_EXPLORER,
        "Text Files (*.txt)|*.txt|Comma Separated Values (*.csv)|*.csv|All Files (*.*)|*.*||", 0,**0,0** )

{
    m_ofn.lpTemplateName = MAKEINTRESOURCE( IDD_LOADASCII );
....
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-15T07:00:49.790

我认为您的 HINSTANCE 不正确。您可以按如下方式获得 HINSTANCE：

```
HINSTANCE hInstance = (HINSTANCE)GetModuleHandle( NULL ); 
```

因此，以下代码应该可以工作：

```
hInst = (HINSTANCE)GetModuleHandle( NULL );
HRSRC hResource = ::FindResource(hInst, m_lpszTemplateName, RT_DIALOG);
hDialogTemplate = LoadResource(hInst, hResource); 
```*****

# c# - 如何从 C# 函数的存储过程返回多个输出参数

> ID：12884461
> 
> 赞同：7
> 
> 时间：2012-10-14T17:00:45.850
> 
> 标签：c#, asp.net, sql-server, database

我正在使用输出参数从我的数据库中获取值。

这是我的存储过程：

```
ALTER PROCEDURE [dbo].[sp_GetCustomerMainData] 
    -- Add the parameters for the stored procedure here
        @Reference nvarchar(100),
        @SubscriptionPIN nvarchar(100) OUTPUT,
        @SignupDate nvarchar(100) OUTPUT,
        @ProductCount int OUTPUT
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    SET @SubscriptionPIN = 'N/A'
    SET @SignupDate = 'N/A'
    SET @ProductCount = 0

    -- Insert statements for procedure here
    IF EXISTS(SELECT [SubscriptionPIN] FROM [Norton].[dbo].[Customers] WHERE [Reference] = @Reference)
    BEGIN
        SELECT TOP 1 @SubscriptionPIN = [SubscriptionPIN], @SignupDate = SignUpDate  FROM [Norton].[dbo].[ProductList] WHERE [Reference] = @Reference
        SET @ProductCount = (SELECT COUNT(*) FROM [Norton].[dbo].[ProductList] WHERE [Reference] = @Reference)
    END

    RETURN (@SubscriptionPIN)
    RETURN (@SignupDate)
    RETURN (@ProductCount)
END 
```

我不确定最后的回报：

```
RETURN (@SubscriptionPIN)
RETURN (@SignupDate)
RETURN (@ProductCount) 
```

另一方面，这里是 c# 代码：

```
using (SqlConnection con = new SqlConnection(connectionInfo))
{
    using (SqlCommand cmd = new SqlCommand("sp_GetCustomerMainData", con) { CommandType = CommandType.StoredProcedure })
    {
        cmd.Parameters.Add("@Reference", SqlDbType.NVarChar).Value = CustomerReferenceID;

        SqlParameter SubscriptionPIN = new SqlParameter("@TheCustomerID", SqlDbType.NVarChar) { Direction = ParameterDirection.Output };
        cmd.Parameters.Add(SubscriptionPIN);

        SqlParameter SignupDate = new SqlParameter("@SignupDate", SqlDbType.NVarChar) { Direction = ParameterDirection.Output };
        cmd.Parameters.Add(SignupDate);

        SqlParameter ProductCount = new SqlParameter("@ProductCount", SqlDbType.Int) { Direction = ParameterDirection.Output };
        cmd.Parameters.Add(ProductCount);

        con.Open();

        try
        {
            cmd.ExecuteNonQuery();

            if (cmd.Parameters["@TheCustomerID"].Value.ToString() != "N/A")
            {
                aStatus.SubscriptionPIN = cmd.Parameters["@TheCustomerID"].Value.ToString();
                aStatus.SignupDate = cmd.Parameters["@SignupDate"].Value.ToString();
                aStatus.ProductCount = int.Parse(cmd.Parameters["@ProductCount"].Value.ToString());
                aStatus.Result = "0: Reference ID Found";
             }
             else
             {
                 aStatus.Result = "1: Reference ID does not exists";
                 return aStatus;
             }
          }
          catch (SqlException sqlExc)
          {
              foreach (SqlError error in sqlExc.Errors)
              {
                  aStatus.Result = string.Format("{0}: {1}", error.Number, error.Message);
                  return aStatus;
              }
          }
      }
} 
```

当我运行此代码时，出现错误：

> System.InvalidOperationException：字符串 [1]：Size 属性在 System.Data.SqlClient.SqlParameter.Validate(Int32 index, Boolean isCommandProc)处的大小属性为0.Data.SqlClient.SqlCommand.SetUpRPCParameters
> (_SqlRPC rpc, Int32 startCount, Boolean inSchema, SqlParameterCollection parameters)
> at System.Data.SqlClient.SqlCommand.BuildRPC(Boolean inSchema, SqlParameterCollection parameters, _SqlRPC& rpc)
> at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
> 在 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String 方法, DbAsyncResult 结果)
> 在 System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult 结果，字符串方法名，布尔 sendToPipe)
> 在 System.Data.SqlClient.SqlCommand.ExecuteNonQuery()

我不知道从存储过程发送许多输出参数的正确方法是什么，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:23:07.093

您需要指定`nvarchar`参数的最大长度：

```
SqlParameter SubscriptionPIN = new SqlParameter("@TheCustomerID", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
cmd.Parameters.Add(SubscriptionPIN);
SqlParameter SignupDate = new SqlParameter("@SignupDate", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
cmd.Parameters.Add(SignupDate); 
```

从存储过程中删除`return`语句。您无需为返回的输出参数执行任何操作。（此外，您只能使用一个`return`语句，并且只能返回整数值。您可以使用带方向的参数`ReturnValue`来获取该返回值。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:08:15.613

过程执行在您的第一个 RETURN 之后结束，它“无条件地从查询或过程中退出”。

考虑将两个值作为一个记录集返回

```
SELECT @SubscriptionPIN AS SubsPIN , @SignupDate AS SignUpDate, @ProductCount AS ProdCount 
```

在程序结束时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-16T05:44:28.830

这是我尝试过的，它工作正常

```
**Stored Procedures**

STORED PROCEDURE 1

create procedure spLoginCount
@userid nvarchar(50),
@password nvarchar(50),
@count int out
as 
Begin 
    select @count=count(userid) from users where userid=@userid and pswd=@password
End

**STORED PROCEDURE 2**

create procedure spLoginData
@userid nvarchar(50),
@usertype nvarchar(20) out,
@lastlogin nvarchar(100) out
as 
Begin 
    select @usertype=usertype,@lastlogin=lastlogin from users where userid=@userid
End

**ASP.NET code which will get values of two output Parameters**....

 protected void btnLogin_Click(object sender, EventArgs e)
    {
        string uid="", psw="";
        uid = txtUserName.Text;
        psw = txtPassword.Text;

         string cs = ConfigurationManager.ConnectionStrings["DBCS"].ConnectionString;
         using (SqlConnection scon = new SqlConnection(cs))
         {
             SqlCommand scmd = new SqlCommand("spLoginCount", scon);
             scmd.CommandType = System.Data.CommandType.StoredProcedure;
             scmd.Parameters.AddWithValue("@userid",uid);
             scmd.Parameters.AddWithValue("@password", psw);

             SqlParameter outparameter = new SqlParameter();
             outparameter.ParameterName = "@count";
             outparameter.SqlDbType = System.Data.SqlDbType.Int;
             outparameter.Direction = System.Data.ParameterDirection.Output;
             scmd.Parameters.Add(outparameter);

             scon.Open();
             scmd.ExecuteScalar();

             string count = outparameter.Value.ToString();
             if (count == "1")
             {
                 SqlCommand scmd1= new SqlCommand("spLoginData", scon);
                 scmd1.CommandType = System.Data.CommandType.StoredProcedure;
                 scmd1.Parameters.AddWithValue("@userid", uid);

                 /*SqlParameter outUserType = new SqlParameter();
                 outUserType.ParameterName = "@usertype";
                 outUserType.SqlDbType = System.Data.SqlDbType.NText;
                 outUserType.Direction = System.Data.ParameterDirection.Output;
                 scmd1.Parameters.Add(outUserType);
                 */
                 SqlParameter outUserType = new SqlParameter("@usertype", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
                 scmd1.Parameters.Add(outUserType);

                 SqlParameter outLastLogin = new SqlParameter("@lastlogin", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
                 scmd1.Parameters.Add(outLastLogin);

                 scmd1.ExecuteNonQuery();
                 scon.Close();

                 string usertype,lastlogin;
                 usertype = outUserType.Value.ToString();
                 lastlogin = outLastLogin.Value.ToString();
               }

             }
         } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-08T14:35:03.360

**>试试这个它对多输出参数的工作正常：**

```
using (SqlConnection sqlConnection = new SqlConnection(ConfigurationManager.ConnectionStrings["conStringEndicia"].ConnectionString)){

                using (var sqlCmd = new SqlCommand("endicia.credentialLookup", sqlConnection))
                { 

                    sqlCmd.CommandType = System.Data.CommandType.StoredProcedure;
                    sqlCmd.Parameters.AddWithValue("@accountNumber", accountNumber);
                    SqlParameter outLogin = new SqlParameter("@login", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
                    sqlCmd.Parameters.Add(outLogin);
                    SqlParameter outPassword = new SqlParameter("@password", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output };
                    sqlCmd.Parameters.Add(outPassword);
                    sqlConnection.Open();
                    sqlCmd.ExecuteNonQuery();
                    string login, password;
                    login = outLogin.Value.ToString();
                    password = outPassword.Value.ToString();                        
                }
            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-18T04:54:16.487

SqlParameter SubscriptionPIN = new SqlParameter("@TheCustomerID", SqlDbType.NVarChar, 100) { Direction = ParameterDirection.Output }; cmd.Parameters.Add(SubscriptionPIN); SqlParameter SignupDate = new SqlParameter("@SignupDate", **DbType.String, 100** ) { Direction = ParameterDirection.Output }; cmd.Parameters.Add(SignupDate);

必须给出类型和尺寸

# php - json数据中的正则表达式？

> ID：12884463
> 
> 赞同：1
> 
> 时间：2012-10-14T17:00:50.410
> 
> 标签：php, regex, json

我在 json 数据中有一个正则表达式，

```
$config = '{"regex": "/font-size:\s*(?:.*);/i"}'; 
```

我想将json数据转换为数组，

```
$config = json_decode($config,true);

var_dump($config); 
```

它`NULL`由于正则表达式而返回。

我怎样才能解决它？

所以我可以得到这个，

```
Array
(
    [regex] => "/font-size:\s*(?:.*);/i"
) 
```

是否可以？

**编辑：**

它返回，

```
array(1) {
  [0]=>
  string(37) '{"regex": "/font-size:\s*(?:.*);/i"}'
} 
```

应该...

```
array(1) {
  ["regex"]=>
  string(22) "/font-size:\s*(?:.*);/i"
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:02:54.557

你的 JSON 有`JSON_ERROR_SYNTAX`，所以你有错误

**选项 A** 你应该`stripslashes`先使用，但你会失去反斜杠`\`

```
$config = '{"regex": "/font-size:\s*(?:.*);/i"}';
$config = json_decode(stripslashes($config),true);
var_dump($config); 
```

输出

```
array
  'regex' => string '/font-size:s*(?:.*);/i' (length=22) 
```

**选项 B**创建自己的函数

```
$config = '{"regex": "/font-size:\s*(?:.*);/i"}';
var_dump(splitJSONObject($config)); 
```

输出

```
array
  'regex' => string '/font-size:\s*(?:.*);/i' (length=23) 
```

使用的函数（*仅拆分为数组*）

```
function splitJSONObject($json) {
    $json = str_replace(array("\\\\","\\\""), array("&#92;","&#34;"), $json);
    $parts = preg_split("@(\"[^\"]*\")|([\[\]\{\},:])|\s@is", $json, - 1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
    foreach ( $parts as $index => $part ) {
        if (strlen($part) == 1) {
            switch ($part) {
                case "[" :
                case "{" :
                    $parts[$index] = "array(";
                    break;
                case "]" :
                case "}" :
                    $parts[$index] = ")";
                    break;
                case ":" :
                    $parts[$index] = "=>";
                    break;
                case "," :
                    break;
                default :
                    return null;
            }
        } else {
            if ((substr($part, 0, 1) != "\"") || (substr($part, - 1, 1) != "\"")) {
                return null;
            }
        }
    }
    $json = str_replace(array("&#92;","&#34;","$"), array("\\\\","\\\"","\\$"), implode("", $parts));
    return eval("return $json;");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:11:42.530

用这个：

```
$config = '{"regex": "/font-size:\\\\s*(?:.*);/i"}'; 
```

注意四个反斜杠。

**理由：**即使在单引号字符串中，反斜杠也具有转义功能。`'\''`你有一个字符串（`'`仅限单引号）。因此，您还需要转义反斜杠。`'\\'`是字符串`\`（仅反斜杠）。

但是为什么要把反斜杠翻四倍呢？

分配变量`$config`时，您会丢失两个反斜杠。它们被“用完”了。

然后，JSON 本身需要剩余的两个反斜杠。

执行日志：

```
var_dump(json_decode('{"regex": "/font-size:\\\\s*(?:.*);/i"}'));

class stdClass#2 (1) {
  public $regex =>
  string(23) "/font-size:\\s*(?:.*);/i"
} 
```

您在 JSON 输出中看到双反斜杠了吗？他们必须留下，否则 JSON 将无效。

# c++ - 如何在我的 VS 2010 项目中包含 SDL 库？

> ID：12884472
> 
> 赞同：0
> 
> 时间：2012-10-14T17:01:52.700
> 
> 标签：c++, visual-studio-2010, sdl

我在 Visual Studio 2010 中链接和分发库时遇到了问题。我想要做什么：

*   将我的项目与 SDL 链接并使用其标题
*   将 SDL 保存在我的项目目录中的某个位置，因此当我从另一台机器上的源代码控制克隆它时，我不必安装任何额外的库。

到目前为止我的尝试：

*   谷歌指向这样的教程：[Lazy Foo Productions](http://lazyfoo.net/SDL_tutorials/lesson01/windows/msvsnet2010e/index.php)，但它没有做我想要的，因为 SDL 放在项目目录之外。
*   当我将 SDL 复制到解决方案目录并通过 Project->Properties->Linker.... 添加它时，它可以工作，但项目设置现在包含库目录的绝对路径，所以我猜它不会在其他机器上编译。

我该怎么办？SDL 在这里只是一个例子，我想知道如何用任何库解决这样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:09:21.027

您可以使用`Project->Properties->Linker->General->Additional Library Directories`指定链接器查找库的新目录（它可以使用相对路径）

您可以使用`Project->Properties->C++->General->Additional Include Directories`指定在哪里查找标题。

# c#-4.0 - 添加到字典c#

> ID：12884473
> 
> 赞同：1
> 
> 时间：2012-10-14T17:02:02.283
> 
> 标签：c#-4.0, dictionary

我有一本包含类的字典。但是，我有很多类要添加到字典中，我想删除一长串添加的列表，因为它开始看起来很乱。我正在考虑将所有数据放在一个文件中并将其加载到字典中，但后来我意识到每次我想创建和添加一个新类时，我都必须修改文件。我宁愿必须在我新创建的类中包含一些会自动将其添加到字典中的内容。我什至不确定这是可能的，所以我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:10:43.343

使字典成为某个类的静态字段，或使“将类添加到字典”成为静态方法。

然后，您可以使用*静态构造函数*将每个类添加到字典中：

```
class ClassDict {
    ...
    public static void AddClass(Type t) {
        ...
    }
}

class Foo {
    static Foo() {
        ClassDict.AddClass(typeof(Foo));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:15:16.023

尝试使用反射来动态定位所有需要的类。创建一个`Assembly`定义类的实例并尝试将它们过滤掉。下面的示例显示了如何找到名称以 . 结尾的所有类`Task`。

```
var assembly = Assembly.GetExecutingAssembly();
var taskTypes = assembly.GetTypes()
                        .Where(t => t.Name.EndsWith("Task") && t.IsClass);

Dictionary<string, object> instances =
    new Dictionary<string, object>(taskTypes.Count());

foreach (Type classType in taskTypes)
{
    object instance = Activator.CreateInstance(classType);
    instances.Add(classType.Name, instance);
    Console.WriteLine("Registered key {0} with object of type {1})",
                      classType.Name,
                      instance);
} 
```

我已经使用`Activator.CreateInstance`方法来创建你的类的实例，但在你的情况下这可能是不可能的，这取决于它们是否有无参数的构造函数等。

另一种选择可能是使用一个可用的 IoC 容器，如[autofac](http://code.google.com/p/autofac/)，但我需要更多关于您的问题的详细信息，然后才能就此提供适当的建议。

# c - x86-64 整数向量化优化

> ID：12884475
> 
> 赞同：3
> 
> 时间：2012-10-14T17:02:13.137
> 
> 标签：c, optimization, x86-64, sse, vectorization

我正在尝试将逻辑验证问题矢量化以在 Intel 64 上运行。

我将首先尝试描述问题：

我有一个`v[]`70 位整数的静态数组（其中大约 400,000 个），它们在编译时都是已知的。

生产者创建 70 位整数`a`，其中很多，非常快。

对于每个`a`我需要找出是否存在一个元素 from `v`which `v[i] & a == 0`。

到目前为止，我在 C 中的实现是这样的（简化的）：

```
for (; *v; v++) {
    if (!(a & *v))
        return FOUND;
}

// a had no matching element in v
return NOT_FOUND; 
```

我正在考虑使用 SSE/AVX 来优化这一点，以加快流程并并行执行更多这些测试。我尽可能地加载`a`并`*v`进入一个`XMM`寄存器并调用`PTEST`指令进行验证。

我想知道是否有办法扩展它以使用新`YMM`寄存器的所有 256 位？也许将 3x70 位打包到一个寄存器中？我不太清楚如何有效地打包/解包它们，以证明每个测试不仅仅使用一个寄存器。

关于输入的性质，我们知道几件事：

*   中的所有元素`v[]`都设置了很少的位
*   不可能以`v[]`任何方式置换/压缩以使其使用少于 70 位
*   平均检查大约 20% 后，该`FOUND`条件有望得到满足。`v[]`
*   `a`在批量检查它们之前，可以缓冲一个以上。
*   我不一定需要知道`v[]`匹配的哪个元素，只需要知道那个匹配或不匹配。
*   生产`a`只需要很少的内存，所以之前调用在 L1 中留下的任何东西都可能仍然存在。

生成的代码旨在在支持 SSE4.2、AVX 指令的最新一代英特尔至强处理器上运行。我很乐意接受使用英特尔 C 编译器或至少 GCC 编译的程序集或 C。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:40:18.760

听起来您真正需要的是更好的数据结构来存储 v[]，以便搜索花费的时间少于线性时间。

考虑如果`(v[0] & v[1]) & a`不为零，则既不`(v[0] & a)`也`(v[1] & a)`不可能为零。这意味着可以创建一个树结构，其中 v[] 是叶子，父节点是其子节点的 AND 组合。然后，如果`parentNode & a`给你一个非零值，你可以跳过看孩子。

但是，这不一定有帮助 - 父节点最终只测试子节点之间的共同位，因此如果只有其中的几个，您最终仍会测试大量离开节点。但是，如果您可以在数据集中找到集群并将许多相似的 v[] 分组到一个共同的父项下，这可能会大大减少您必须进行的比较次数。

另一方面，这样的树搜索涉及很多条件分支（昂贵），并且很难向量化。如果您可以仅使用两个级别，我将首先尝试：首先在集群父节点之间进行矢量化搜索，然后为每个匹配项搜索该集群中的条目。

* * *

实际上，这是另一个想法，以帮助解决 70 位不适合寄存器的事实：您可以将 v[] 拆分为 64 (=2^6) 个不同的数组。在原始 v[] 中的 70 位中，最高 6 位用于确定哪个数组将包含该值，并且只有剩余的 64 位实际存储在数组中。

通过针对数组索引测试掩码`a`，您将知道要搜索 64 个数组中的哪一个（在最坏的情况下，如果`a`没有设置任何 6 个最高位，那就是全部），以及每个人数组搜索仅处理每个元素 64 位（更容易打包）。

事实上，第二种方法也可以推广到树结构中，这会给你某种[trie](http://en.wikipedia.org/wiki/Trie)。

# binary - 为什么格雷码是二进制代码中位的异或位

> ID：12884486
> 
> 赞同：1
> 
> 时间：2012-10-14T17:03:09.467
> 
> 标签：binary, gray-code

我清楚地理解了格雷码的目的。 [EE Times：格雷码基础](http://www.eetimes.com/document.asp?doc_id=1278809)

但是我无法从概念上理解为什么可以如下生成格雷码

G [i] = B [i+1] ⊕ B [i] , i = n - 1, . . . , 0，其中 B [n]取为 0。

有人可以在概念上帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-29T11:44:09.710

在标准二进制文件中，如果您排除或小于`n**2`with的数字`n**2-1`，则您有效地颠倒了该计数的顺序：

```
x   x^11
00  11
01  10
10  01
11  00 
```

因此，对于两位数，如果我们将下一位与下一位异或：

```
x   x^(x>>1)
00  00
01  01
10  11
11  10 
```

我们交替反转底部位的计数顺序，具体取决于它上面的位是设置还是清除。这确保了当位 1 更改时，位 0 保持不变（否则它会回绕到零并重新开始计数）。

对于添加到计数器顶部的每个位，我们需要重复对下面位的计数的这种反映，以确保在新位被设置时它不会被清除。其余位遵循相同的模式，由它们上方的位反映，以便它们向后计数而不是环绕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:15:49.233

当您查看维基百科时，您会看到它是：

```
G0 = B0
Gi = Bi EXOR Gi-1 
```

这更有意义吗？检查您阅读的页面中给出的格雷码 - 您会看到它成立。

你想看看上面的证明，还是看例子就够了？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-28T19:38:57.030

我发现[Vovanium](https://stackoverflow.com/users/484743/vovanium)的[答案](https://stackoverflow.com/a/4166615/6780089)对于理解生成格雷码序列的公式非常有帮助。这个想法是我们想要生成一个序列，其中 G(n+1) 仅从 G(n) 更改一位，即 G(n+1) xor G(n) 仅设置了 1 位。[Vovanium](https://stackoverflow.com/users/484743/vovanium)的答案部分复制如下。

如果您查看二进制计数序列，您会注意到，相邻代码在最后几个位（没有孔）处不同，因此如果您对它们进行异或，则会出现几个尾随 1 的模式。此外，当您将数字右移时，xor 也会右移：(A xor B)>>N == A>>N xor B>>N。

```
 N                    N>>1                  gray
 0000           .        0000           .      0000           .
    | >xor = 0001             >xor = 0000           >xor = 0001
 0001          .         0000          .       0001          .
   || >xor = 0011           | >xor = 0001           >xor = 0010
 0010           .        0001           .      0011           .
    | >xor = 0001             >xor = 0000           >xor = 0001
 0011         .          0001         .        0010         .
  ||| >xor = 0111          || >xor = 0011           >xor = 0100
 0100                    0010                  0110 
```

原始异或结果和移位结果在单个位上有所不同（我在上面用点标记了它们）。这意味着如果您对它们进行异或，您将获得设置为 1 位的模式。所以，

`(A xor B) xor (A>>1 xor B>>1) == (A xor A>>1) xor (B xor B>>1) == gray (A) xor gray (B)`

# jsf - 如何将参数传递给 JSF dataTable 的 value 属性

> ID：12884487
> 
> 赞同：0
> 
> 时间：2012-10-14T17:03:16.963
> 
> 标签：jsf, jakarta-ee, primefaces, facelets

在 JSF 2.1 应用程序中，我需要构建一个`dataTable`仅显示属于登录用户的数据库记录的 JSF（使用 PrimeFaces）。

因此，我需要将用户名传递给与 dataTable 的`value`属性关联的 bean：

```
value="#{tableBuilder.records}" 
```

这是表bean：

```
@ManagedBean
@ViewScoped
public class TableBuilder {
    private List<MyRecord> records;
    private String username;
    // getters and setters
} 
```

知道应用程序由一个网页组成，并通过`LoginBean`SessionScoped ManagedBean 实现容器管理的身份验证，这很有用。这意味着在用户登录时通知 TableBuilder 的额外工作。

我想到的唯一方法是将 注入`LoginBean`到`TableBuilder`through`@ManagedProperty`注释中，并检查`getRecords`LoginBean 的用户名属性是否已更改的每个请求。

也许有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:17:41.713

如果您的环境支持 EL 2.2（您的问题历史确认 Java EE 6），那么“就这样做”：

```
<h:dataTable value="#{bean.getModel(user)}"> 
```

和

```
public List<Item> getModel(User user) {
    // ...
} 
```

无论是正确的方式还是有更好的方式，我都会中途离开。请记住，调用 getter 的次数与 EL 计算值表达式的次数一样多。

# java - 如何创建一个等待布尔变量变为真的线程？

> ID：12884488
> 
> 赞同：2
> 
> 时间：2012-10-14T17:03:24.710
> 
> 标签：java, multithreading

我有一个函数，一旦布尔变量为真，就需要调用它。我尝试在线程中使用 while 循环，但它不起作用。这是我尝试过的：

```
public class MyRunnable implements Runnable {

public void run() {
    while (true) {
         if (conditions == true) { 
             System.out.println("second");
             break;
         }
    }
}

public static void main(String args[]) {
    boolean condition = false;
    (new Thread(new MyRunnable())).start();
    System.out.println("first\n");
    // set conndition to true
    condition = true;

    }

} 
```

结果应该是：

```
first
second 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-14T17:08:17.650

**不要忙于等待**这种情况。使用阻塞习语。对于您的简单情况，您可以使用`new CountDownLatch(1)`. 首先，这是您的代码，但已按您期望的方式编译和运行：

```
public class MyRunnable implements Runnable {
  volatile boolean condition = false;

  public void run() {
    while (true) {
      if (condition) {
        System.out.println("second");
        break;
      }
    }
  }
  public static void main(String args[]) {
    final MyRunnable r = new MyRunnable();
    new Thread(r).start();
    System.out.println("first\n");
    r.condition = true;
  }
} 
```

为了比较，一个带有 的程序`CountDownLatch`：

```
public class MyRunnable implements Runnable {
  final CountDownLatch latch = new CountDownLatch(1);

  public void run() {
    try { latch.await(); } catch (InterruptedException e) {}
    System.out.println("second");
  }

  public static void main(String args[]) {
    final MyRunnable r = new MyRunnable();
    new Thread(r).start();
    System.out.println("first\n");
    r.latch.countDown();
  }
} 
```

要真正注意到差异，请在后面添加一个`Thread.sleep(20000)`，`println("first")`然后**听听**计算机风扇努力消耗第一个程序浪费的能量的声音的差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T17:14:09.720

这似乎是 java 的等待通知构造的地方。

```
public class MyRunnable implements Runnable {

  public run() {
    synchronized(this) {
      try {
        wait();
      } catch (InterruptedException e) {
      }
    }
    System.out.println("second");
  }

  public static void main(String args[]) {
    Runnable r = new MyRunnable();    
    Thread t = new Thread(r);
    t.start();
    System.out.println("first\n");
    synchronized (r) {
      r.notify();
    }
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:12:26.493

不要那样做。相反，您可以使用`Object`' 的内置方法`notify()`，`wait()`如下所示：

```
public class MyRunnable implements Runnable {

private final Object condition;

public MyRunnable(Object condition) {
    this.condition = condition;
}

public void run() {
    condition.wait();
    System.out.println("second");
}

public void go(String args[]) {
        Object condition = new Object();
        (new Thread(new MyRunnable(condition))).start();
        System.out.println("first\n");
        // set conndition to true
        condition.notify();
    }
} 
```

如果您想要更高级的通知方案，您还可以寻找`java.util.concurrent`更强大的方法让线程等待更有趣的条件。所有这些都将比仅旋转直到条件为真时的 CPU 效率要高得多，并且由于 Java 内存模型中的细微差别，它们不太可能引入并发错误。

# android - 地图上的点位置不固定 - Android

> ID：12884490
> 
> 赞同：0
> 
> 时间：2012-10-14T17:03:40.963
> 
> 标签：android, google-maps

我正在开发一个项目，该项目允许用户在地图上放置和命名一个点。问题是在放置点之后，如果用户缩小，点会随着地图移动。我有几个截图来说明这个问题。

[1：放置点之后](http://imageshack.us/scaled/landing/6/pointplaced.png)

[2：缩小](http://imageshack.us/scaled/landing/29/zoomedout.png)

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:24:08.430

您尚未为自定义图标设置适当的锚点（可能应该是图钉的点）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T17:05:00.243

似乎只是那个图标，尝试了另一个，它工作正常。

# vb.net - 当其他 2 个列值相同时，LINQ 对某列求和

> ID：12884491
> 
> 赞同：2
> 
> 时间：2012-10-14T17:03:46.193
> 
> 标签：vb.net, linq, sum

我有下表

```
+-------+--------+----------+
| catid |  name  | quantity |
+-------+--------+----------+
|     1 | table  |       10 |
|     2 | chair  |        5 |
|     2 | chair  |       10 |
|     1 | table  |       10 |
|     2 | chair  |       15 |
|     3 | pencil |       20 |
+-------+--------+----------+ 
```

使用 LINQ 我想对具有相同名称 catid 的行的数量求和并将其保存到同一个数据表中

所以结果就是这张表

```
+-------+--------+----------+
| catid |  name  | quantity |
+-------+--------+----------+
|     1 | table  |       20 |
|     2 | chair  |       30 |
|     3 | pencil |       20 |
+-------+--------+----------+ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:09:59.703

```
var result = (from row in YourTable
             group row by new {row.catid, row.name}
             into grp
                    select new
                    {
                        grp.Key.catid,
                        grp.Key.name,
                        Quantity = grp.Sum(row => row.Quantity)
                    }).ToList(); 
```

编辑：刚刚注意到它是 VB 标记的。对此感到抱歉。嗯，应该是这样的：

```
Dim result = From row In YourTable
    Group By Key = New With {row.catid, row.name} Into Group
Select New With 
{ 
.Catid = Key.catid, 
.Name =  Key.Name, 
.Quantity =  Group.Sum(Function(x) x.quantity)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T09:22:54.353

Artur Udod 的答案很好（并且具有额外的功能），但简单的 LINQ 答案是：

```
Dim result = From row In YourTable
             Group By row.catid, row.name Into Group
             Select catid, name, quantity = Sum(From g In group Select g.quantity) 
```

（未经测试）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T11:50:40.923

就我而言，马克的回答以这种形式成功：

```
Dim result = From row In YourTable
         Group By row.catid, row.name Into Group
         Select catid, name, quantity = (From g In group Select g.quantity).Sum 
```

# json - AS3 对象转 JSON

> ID：12884492
> 
> 赞同：2
> 
> 时间：2012-10-14T17:03:57.580
> 
> 标签：json, actionscript-3

我正在尝试将对象数组（嵌套）转换为 JSON 字符串。这是我的 JSON 输出：

```
[{
    "Width": 570,
    "SessionID": 2003404006158805,
    "Price": "69,90",
    "PageCount": 24,
    "Pages": [{
        "ID": 1,
        "TemplateID": 0,
        "PageType": "cover",
        "TextContainers": [],
        "ImageContainers": []
    }, {
        "ID": 2,
        "TemplateID": 1001,
        "PageType": "single",
        "TextContainers": [],
        "ImageContainers": []
    }, {
        "ID": 3,
        "TemplateID": 0,
        "PageType": "double",
        "TextContainers": [],
        "ImageContainers": [{
            "Width": 570,
            "IsBG": true,
            "Brightness": 0,
            "Contrast": 0,
            "PosX": null,
            "ScaleX": null,
            "Height": 284,
            "ID": -1,
            "BlackWhite": 0,
            "PosY": null,
            "HasPhoto": false,
            "ScaleY": null,
            "PhotoID": null
        }]
    }, {
        "ID": 4,
        "TemplateID": 0,
        "PageType": "double",
        "TextContainers": [],
        "ImageContainers": [{
            "Width": 570,
            "IsBG": true,
            "Brightness": 0,
            "Contrast": 0,
            "PosX": null,
            "ScaleX": null,
            "Height": 284,
            "ID": -1,
            "BlackWhite": 0,
            "PosY": null,
            "HasPhoto": false,
            "ScaleY": null,
            "PhotoID": null
        }]
    }],
    "ProductSubID": 0,
    "Height": 620,
    "ProductID": 0
}] 
```

当我尝试将此字符串转换为 XML（在服务器端）时，结果如下：

```
<?xml version="1.0" encoding="UTF-8" ?>
    <0>
        <Width>570</Width>
        <SessionID>2003404006158805</SessionID>
        <Price>69,90</Price>
        <PageCount>24</PageCount>
        <Pages>
            <ID>1</ID>
            <TemplateID>0</TemplateID>
            <PageType>cover</PageType>
        </Pages>
        <Pages>
            <ID>2</ID>
            <TemplateID>1001</TemplateID>
            <PageType>single</PageType>
        </Pages>
        <Pages>
            <ID>3</ID>
            <TemplateID>0</TemplateID>
            <PageType>double</PageType>
            <ImageContainers>
                <Width>570</Width>
                <IsBG>true</IsBG>
                <Brightness>0</Brightness>
                <Contrast>0</Contrast>
                <PosX />
                <ScaleX />
                <Height>284</Height>
                <ID>-1</ID>
                <BlackWhite>0</BlackWhite>
                <PosY />
                <HasPhoto>false</HasPhoto>
                <ScaleY />
                <PhotoID />
            </ImageContainers>
        </Pages>
        <Pages>
            <ID>4</ID>
            <TemplateID>0</TemplateID>
            <PageType>double</PageType>
            <ImageContainers>
                <Width>570</Width>
                <IsBG>true</IsBG>
                <Brightness>0</Brightness>
                <Contrast>0</Contrast>
                <PosX />
                <ScaleX />
                <Height>284</Height>
                <ID>-1</ID>
                <BlackWhite>0</BlackWhite>
                <PosY />
                <HasPhoto>false</HasPhoto>
                <ScaleY />
                <PhotoID />
            </ImageContainers>
        </Pages>
        <ProductSubID>0</ProductSubID>
        <Height>620</Height>
        <ProductID>0</ProductID>
    </0> 
```

但我需要它像：

```
<pages>
<page>
</page>
<page>
</page>
</pages> 
```

这是我将对象数组转换为 JSON 的 AS 代码

```
var Pages:Array = [];
            var Books:Array = [];
            var JBook:Object = new Object();

            JBook.Width = Global.BOOK_WIDTH;

            for(var i:Number = 0; i<Global.PAGES.length; i++)
            {
                var Page:PageVO = Global.PAGES[i] as PageVO;
                var JPage:Object = new Object();
                JPage.ID = Page.ID;

                var ImageContainers:Array = [];
                var TextContainers:Array = [];
                var Template:TemplateVO = Page.ACTIVE_TEMPLATE;

                for(var j:Number = 0; j<Template.IMAGE_CONTAINERS.length; j++)
                {
                    var ImageContainer:ImageContainerVO = Template.IMAGE_CONTAINERS[j] as ImageContainerVO;
                    var JImageContainer:Object = new Object();
                    JImageContainer.ID = ImageContainer.ID;
                    ImageContainers.push(JImageContainer);
                }

                for (var m:Number = 0; m<Template.TEXT_CONTAINERS.length; m++)
                {
                    var TextContainer:TextContainerVO = Template.TEXT_CONTAINERS[m] as TextContainerVO;
                    var JTextContainer:Object = new Object();
                    JTextContainer.ID = TextContainer.ID;
                }

                JPage.TextContainers = TextContainers;
                JPage.ImageContainers = ImageContainers;
                Pages.push(JPage);
            }

            var Photos:Array = [];
            for(var p:Number = 0; p<Global.PHOTOS.length; p++ )
            {
                var Photo:PhotoVO = Global.PHOTOS[p] as PhotoVO;
                var JPhoto:Object = new Object();
                JPhoto.BMP = ImageUtils.BitmapToBase64(Photo.BMP.bitmapData);
                JPhoto.UseCount = Photo.USE_COUNT;
                JPhoto.ID = Photo.ID;
                Photos.push(JPhoto);
            }

            //JBook.Photos = Photos;
            JBook.Pages = Pages;
        JSON   = com.adobe.serialization.json.JSON.encode(Books); 
```

知道为什么它会渲染 JSON 字符串，就像它们不在同一个节点中（每个页面项目的单独节点）吗？

希望我已经清楚了。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-14T21:31:43.487

从 AS3 对象转换为 JSON 字符串的最简单方法可能是使用[as3corelib 中的 JSON 类](https://github.com/mikechambers/as3corelib/tree/master/src/com/adobe/serialization/json)。

示例用法：

```
var jsonString:String = JSON.encode(myDataObject); 
```

最好不要编写自己的解析器，因为 as3corelib JSON 解析器已经被许多人研究和使用了一段时间。

**编辑：** @dpcao 提到您甚至不再需要外部库， Adobe在 FlashPlayer 11 中[引入了一个新的 JSON 类。](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/JSON.html)

示例用法：

```
var jsonString:String = JSON.stringify(myDataObject); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T05:25:16.557

您是否正在遍历本机对象？还是通过 XML 对象？因为如果您正在迭代 [XMLList][1]，您应该使用 length()，而不是 length（他们将其命名为函数以避免名称集合）

但老实说，在 Flash Player 10.3 或更高版本中使用 JSONLib 或 [natively][2]，在本机使用它。它模仿 javascript api，分别使用 JSON.parse 和 JSON.stringify。这不应该是 JSON 序列化的问题，您的序列化可能有服务器端或客户端的错误。我建议为每个对象添加一个 serialize() 函数——从长远来看，这使得维护起来更容易。IE：

```
class PageVO {
  function serialize():Object {
    return {
       ID: some_id,
       Template_ID: some_template_id,
       // add image containers here
    }
  }
} 
```

这将使调试单个对象以查看问题出在哪里变得更加容易。看起来，您的代码没有理由*不*工作。但是，actionscript 序列化类可能存在问题，并且没有添加变量节点：即序列化[]，而不是{“name”：value}。尝试使用本机序列化程序，看看会发生什么。（不要忘记-swf-version=16）

# azure - 从它自己的运行实例重新启动 Azure WebRole 实例

> ID：12884494
> 
> 赞同：2
> 
> 时间：2012-10-14T17:04:16.700
> 
> 标签：azure, azure-web-roles

我有 Azure WebRole，我必须动态更改其系统区域设置。`shutdown -r`为此，我尝试使用 Windows命令重新启动 WebRole 启动任务中的实例，它可以正常工作。

但重启后，我无法使用远程桌面连接到实例。（就像负载均衡器不起作用......）我想我需要使用一些 Azure 管理功能来正式重启。

在这种情况下，我应该采取哪种方式简单地重启自己？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:18:42.337

`shutdown -r`应该可以正常工作。我已经用过不少了。

我找不到适合您的代码片段，但韦德在他的启动任务中重新启动：[http ://www.wadewegner.com/2011/01/using-expression-encoder-4-in-a-windows -azure-worker-角色/](http://www.wadewegner.com/2011/01/using-expression-encoder-4-in-a-windows-azure-worker-role/)

该示例中的重新启动是他运行的另一个命令的效果，但它的工作方式相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T14:53:55.847

我已与 Microsoft Azure 支持团队确认这是 Windows 2008 SP2 实例中的一个错误。如果您可以升级到 Windows 2008 R2 (osFamily=2) 或 Windows 2012 (osFamily=3) 实例，则问题在这些操作系统版本中得到解决。

# mysql - MySQL：在插入之前使用 TRIGGER 更新列

> ID：12884496
> 
> 赞同：1
> 
> 时间：2012-10-14T17:04:37.957
> 
> 标签：mysql, triggers, sql-update

如果列 C 等于特定值，我有这个代码可以防止重复

```
DELIMITER $$

CREATE TRIGGER special_unique_test BEFORE INSERT ON myTable 
    FOR EACH ROW BEGIN
       IF NEW.C = 'x' AND EXISTS (
          SELECT * FROM myTable WHERE A = NEW.A AND B = NEW.B AND C = 'x'
       )THEN

          UPDATE myTable SET D = D + 1 WHERE A = NEW.A AND B = NEW.B AND C = 'x';

       END IF;
    END$$

DELIMITER ; 
```

除了不执行更新语句之外，一切正常。

**添加**

在 PhpMyAdmin 中试过这个，我得到了这个错误：

1442 - 无法更新存储函数/触发器中的表“myTable”，因为它已被调用此存储函数/触发器的语句使用。

我可以通过为 D 列制作一个单独的表来解决这个问题，但是将它放在同一个表中会很好。

额外问题：当我使用 mysqli 从我的网站插入内容时，如何显示此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T22:26:15.980

如[对存储程序的限制中所述](http://dev.mysql.com/doc/en/stored-program-restrictions.html)：

> 存储的函数或触发器不能修改已被调用函数或触发器的语句使用（用于读取或写入）的表。

如果您只想`D`在新插入的行中增加，您只需要`SET NEW.D = NEW.D + 1;`. 如果您希望`D`为每个“冲突”记录递增，则需要存储`D`在其他（相关）表中。例如，您*可以*将列存储`D`在单独的表中，并将 FK`(A, B, C)`重新存储到`myTable`.

然而，人们不禁想知道是否有更好的方法来实现您的总体目标：您试图通过此触发器解决的*业务问题到底是什么？*当心[XY 问题](https://meta.stackexchange.com/a/66378)。

# jquery - 如何获取页面上的所有 jQuery-portlet 数据？

> ID：12884499
> 
> 赞同：0
> 
> 时间：2012-10-14T17:04:47.377
> 
> 标签：jquery, html

我有一个包含所谓的 portlet (jQuery) 的页面。我想要一个按钮来打开一个包含所有 portlet 数据（包括包含它们的列的 ID）的对话框。

所以我希望对话框看起来像这样：

* * *

col1：

portlet 标题：Title1

portlet 内容：Title1 的内容..

portlet 标题：Title2

portlet 内容：Title2 的内容..

col2：

portlet 标题：TIIIIITLE

portlet 内容：TIIIIITLE 的内容

portlet 标题：TIIIIITLE22121

portlet 内容：TIIIIITLE2212 的内容

* * *

或类似的东西。重要的部分是如何访问 portlet 数据。

**编辑：**我添加了这个 jquery（以及下面的一些 html），它打开了一个带有 portlet 数据的对话框，只是它没有做我想要的。如果我有 2 个带有标题/内容 (a/1) 和 (b/2) 的 portlet 并打开对话框，我会得到：ab 12 ab 12。我想要：a 1 b 2。下面的行是需要的要更改，我想在每个语句中使用当前 portlet 的标题/内容。

```
allContent += $(".portlet-header").text() + '\n' + $(".portlet-content").text() + '\n\n'; 
```

更多新的 jQuery

```
$( "#dialog-form-html" ).dialog({
                autoOpen: false,
                height: 600,
                width: 400,
                modal: true,
                buttons: {
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                }
            });

            $( "#get-html" )
            .button()
            .click(function() {
                var allContent = "";
                $(".portlet").each(function(){
                    allContent += $(".portlet-header").text() + '\n' + $(".portlet-content").text() + '\n\n';                        
                });                    
                $( "#dialog-form-html" ).text(allContent);
                $( "#dialog-form-html" ).dialog( "open" );
            }); 
```

jQuery代码：

```
<script type="text/javascript">

        $(function() {
            var title = $( "#title" ),
            content = $( "#content" ), column = $( "#column" ); 

            $( "#dialog-form" ).dialog({
                autoOpen: false,
                height: 300,
                width: 350,
                modal: true,
                buttons: {
                    "Add content": function() {                            
                        if(column.val()=='col1'){
                            $( "#col1" ).append($('<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">' +
                                '<div class="portlet-header ui-widget-header ui-corner-all">' +
                                '<span class="ui-icon ui-icon-minusthick"></span>' + title.val() + '</div>' +
                                '<div class="portlet-content">' + content.val() + '</div></div>'))
                            $( this ).dialog( "close" );
                        }
                        else if(column.val()=='col2'){
                            $( "#col2" ).append($('<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">' +
                                '<div class="portlet-header ui-widget-header ui-corner-all">' +
                                '<span class="ui-icon ui-icon-minusthick"></span>' + title.val() + '</div>' +
                                '<div class="portlet-content">' + content.val() + '</div></div>'))
                            $( this ).dialog( "close" );
                        }
                        else if(column.val()=='col3'){
                            $( "#col3" ).append($('<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">' +
                                '<div class="portlet-header ui-widget-header ui-corner-all">' +
                                '<span class="ui-icon ui-icon-minusthick"></span>' + title.val() + '</div>' +
                                '<div class="portlet-content">' + content.val() + '</div></div>'))
                            $( this ).dialog( "close" );                                
                        }
                        else if(column.val()=='col4'){
                            $( "#col4" ).append($('<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">' +
                                '<div class="portlet-header ui-widget-header ui-corner-all">' +
                                '<span class="ui-icon ui-icon-minusthick"></span>' + title.val() + '</div>' +
                                '<div class="portlet-content">' + content.val() + '</div></div>'))
                            $( this ).dialog( "close" );                                
                        }                            
                        else{
                            $( "#tempcol" ).append($('<div class="portlet ui-widget ui-widget-content ui-helper-clearfix ui-corner-all">' +
                                '<div class="portlet-header ui-widget-header ui-corner-all">' +
                                '<span class="ui-icon ui-icon-minusthick"></span>' + title.val() + '</div>' +
                                '<div class="portlet-content">' + content.val() + '</div></div>'))
                            $( this ).dialog( "close" );                                
                        } 
                    },
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                    //test();
                }
            });

            $( "#add-content" )
            .button()
            .click(function() {
                $( "#dialog-form" ).dialog( "open" );
            });

            $( ".column" ).sortable({
                connectWith: ".column"
            });

            $( ".portlet" ).addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
            .find( ".portlet-header" )
            .addClass( "ui-widget-header ui-corner-all" )
            .prepend( "<span class='ui-icon ui-icon-minusthick'></span>")
            .end()
            .find( ".portlet-content" ); 

            $( ".column" ).disableSelection();

            $("#centered").on('click', ".portlet-header .ui-icon", function() {
                $( this ).toggleClass( "ui-icon-minusthick" ).toggleClass( "ui-icon-plusthick" );
                $( this ).parents( ".portlet:first" ).find( ".portlet-content" ).toggle();
            });
        });

    </script> 
```

**编辑：**我还为新对话框添加了这个 html：

```
<div id="dialog-form-html" title="Copy html into email">
                <p>
                    test
                </p>
            </div> 
```

HTML：

```
<body>

    <div id="centered">

        <div id="inset">
            <h1>HALLÅ EKONOMEN</h1>
            <div id="linear" style="padding: 20px"></div>
        </div>

        <div id="dialog-form" title="Create new user">
            <p class="validateTips">All form fields are required.</p>

            <form>
                <fieldset>
                    <label for="title">Title</label>
                    <input type="text" name="title" id="title" class="text ui-widget-content ui-corner-all" />
                    <label for="content">Content</label>
                    <input type="text" name="content" id="content" value="" class="text ui-widget-content ui-corner-all" />
                    <label for="column">Column</label>
                    <select name="column" id="column" class="ui-spinner-down ui-widget-content ui-corner-all">
                        <option value="col1">left sidebar</option>
                        <option value="col2">main</option>
                        <option value="col3">bottom left</option>
                        <option value="col4">bottom right</option>
                    </select>
                </fieldset>
            </form>
        </div>

        <button id="add-content" >Add Content</button>
        <div id="preview">
            <table>
                <tbody>
                    <tr>
                        <!--sidebar-->
                        <td>
                            <div id="col1" class="column">
                            </div>
                        </td>
                        <!--sidebar end-->   
                        <td>
                            <table>
                                <tbody>
                                    <!--main-->
                                    <tr>
                                        <div id="col2" class="column">
                                        </div>
                                    </tr>             
                                    <!--main end-->
                                    <!--bottom colums-->
                                    <tr>
                                        <td style="border-left: 0px; border-bottom: 0px">
                                            <div id="col3" class="column">
                                            </div>
                                        </td>
                                        <td style="border-right: 0px; border-bottom: 0px">
                                            <div id="col4" class="column">
                                            </div>
                                        </td>
                                    </tr>                                    
                                    <!--bottom colums end-->
                                </tbody>
                            </table>
                        </td>           
                    </tr>
                </tbody>
            </table>
            Trash column:<br /><br /><br />
            <div id="trashcol" class="column">
            </div>
        </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T12:15:40.377

我猜我的问题有点难以理解，但以防万一将来有人需要帮助，我会发布我自己问题的答案。

这个 jQuery 将首先在第 1 列中找到所有 portlet，并且对于其中的每一个，它将取出 header div 标签和 content div 标签的文本。这是针对所有 4 列完成的。在将所有 portlet 文本复制到变量 allContent 之后，我
使用 html(allContent) 设置对话框 html（因为我在 allContent 中添加了一些内容）。这会导致类似：

--Column 1--
header 1 : portlet 1 的内容
header 2- : portlet 2 的内容--Column 2-- header 3 : portlet 3 的内容

--Column 3-- (第 3 列中没有 portlet) --Column 4-- header 4 : portlet 4 的内容 header 5 : portlet 5 的内容 header 6 : portlet 6 的内容

**jQuery代码：**

```
/*Open dialog containing the html code*/

            $( "#dialog-form-html" ).dialog({
                autoOpen: false,
                height: 600,
                width: 400,
                modal: true,
                buttons: {
                    Cancel: function() {
                        $( this ).dialog( "close" );
                    }
                },
                close: function() {
                }
            });

            $( "#get-html" )
            .button()
            .click(function() {
                var allContent = "";
                allContent += "--Column 1-- <br />"
                $("#col1 .portlet").each(function(i,element){
                    allContent += $(this).find(".portlet-header").text() + ": " + $(this).find(".portlet-content").text() + "<br />";                          
                });
                allContent += "<br /><br />--Column 2-- <br />"
                $("#col2 .portlet").each(function(i,element){
                    allContent += $(this).find(".portlet-header").text() + ": " + $(this).find(".portlet-content").text() + "<br /><br />";                          
                });
                allContent += "<br /><br />--Column 3-- <br />"
                $("#col3 .portlet").each(function(i,element){
                    allContent += $(this).find(".portlet-header").text() + ": " + $(this).find(".portlet-content").text() + "<br /><br />";                          
                });
                allContent += "<br /><br />--Column 4-- <br />"
                $("#col4 .portlet").each(function(i,element){
                    allContent += $(this).find(".portlet-header").text() + ": " + $(this).find(".portlet-content").text() + "<br /><br />";                          
                });

                $( "#dialog-form-html" ).html(allContent);
                $( "#dialog-form-html" ).dialog( "open" );
            }); 
```

# r - 提取R中的一些列

> ID：12884500
> 
> 赞同：1
> 
> 时间：2012-10-14T17:04:49.490
> 
> 标签：r, dataframe, extract

我有以下示例数据框：

```
x<-c(1:4)
y<-c(9:12)
z<-c("a","b","c","d")
data<-data.frame(x,y,z) # as data: 

      x  y z
    1 1  9 a
    2 2 10 b
    3 3 11 c
    4 4 12 d 
```

我想使用函数提取第 2 列或第 3 列（注意：我使用的是列名来提取）。我的代码如下：

```
data_frame<-function(col){
cols<-c("y","z")
# column x is already there; it is not in a vector of col.
if (col %in% cols){
kk<-data[,c("x","col")] 
return (kk)}
} 
```

现在，我想要`data_frame("y")`. 但是，R 给了我以下错误：

```
data_frame("y")
Error in `[.data.frame`(data, , c("x", "col")) : 
  undefined columns selected. 
```

我想知道为什么 R 不接受我`col`在`y`这里的论点。我有点不高兴为什么 R 将参数解释`col`为列的名称。您在这方面的宝贵建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:08:53.530

这部分：`kk<-data[,c("x","col")]`应该是`kk<-data[,c("x",col)]`

# c - 执行 Lex 和 Yacc 的顺序？

> ID：12884501
> 
> 赞同：1
> 
> 时间：2012-10-14T17:04:56.053
> 
> 标签：c, ubuntu

我听我的老师说应该首先执行 Yacc 文件，因为它会创建 yy.tab.h 将在 Lex 文件中使用，反之亦然。我真的很困惑。我想知道执行这两个文件的正确顺序是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:48:29.430

Yacc 是解析器生成器，您首先需要它。然后必须执行 flex（词法分析器生成器）来生成依赖于生成的解析器的词法分析器。所以

1.  雅克
2.  柔性

这里有一个例子：[http ://www.usna.edu/Users/cs/lmcdowel/courses/si413/F10/labs/L04/calc1/ex1.html](http://www.usna.edu/Users/cs/lmcdowel/courses/si413/F10/labs/L04/calc1/ex1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:49:37.660

Lex 是一个词法分析器，可以将标识符或保留字或特殊字符等字符串转换为标记，而 yacc 是一个可以处理标记序列的解析器（如 IDENTIFIER EQUAL IDENTIFIER SEMICOLON）。我不确定如何在编译时执行它们的顺序，我想这没有什么区别（你可以尝试一下；），但是两者都必须在编译器运行之前运行。

显然，在运行时，lex 生成的代码在 yacc 生成的代码之前运行。

# r - R中的原型函数

> ID：12884502
> 
> 赞同：1
> 
> 时间：2012-10-14T17:05:01.427
> 
> 标签：r, function

我使用 notepad++ 作为我的 R 编辑器。我面临的一个困难是我并不总是记得我试图调用的函数的参数结构是什么样的。有没有办法在 .r 文件中列出函数的原型（如在 C++ 中）？这样我可以看到调用约定是什么。

# makefile - Makefile 不重建依赖项

> ID：12884503
> 
> 赞同：0
> 
> 时间：2012-10-14T17:05:02.563
> 
> 标签：makefile

我不熟悉使用 makefile 并尝试生成基本的 makefile 作为大学练习的一部分。我有两个源代码文件，chello.c 和 writeexit.s，它们必须被编译/汇编，然后链接以生成 chello。

这是我到目前为止的makefile代码：

```
chello: chello.o  writeexit.o
  ld -N chello.o writeexit.o -o chello

chello.o: chello.c
  gcc -c chello.c -o chello.o

writeexit.o: writeexit.s
  as writeexit.s -o writeexit.o 
```

ld、gcc 和 as 之前的空格都是制表符，所以我认为空格很好。当我调用“make makefile”时，它返回“make: Nothing to be done for `makefile'。” 但是，如果我更改了 chello 的依赖项，例如 chello.c，则会返回相同的消息，并且不会修改 chello 的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:18:01.337

来自`man make`：

> make 执行 makefile 中的命令以更新一个或多个目标名称，其中名称通常是一个程序。如果不存在 -f 选项，make 将按顺序查找 makefile GNUmakefile、makefile 和 Makefile。

`make makefile`实际上将执行您的“makefile”（因为它在手册页中的默认名称中列出）文件，尝试构建已经存在的“makefile”目标（因为您传递的参数）

您需要构建“chello”二进制文件，因此您必须输入：

`make chello`

或者：

`make -f makefile chello`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:17:53.527

此处的替代帐户，如果我只调用“make”而不是“make makefile”，它似乎工作正常。这个问题可以忽略。

# python - python代码故障排除

> ID：12884512
> 
> 赞同：4
> 
> 时间：2012-10-14T17:05:51.570
> 
> 标签：python, ssl, network-programming

我是学习python的第一步，请原谅我的问题。我想运行下面的代码（取自：[http](http://docs.python.org/library/ssl.html) ://docs.python.org/library/ssl.html ）：

```
import socket, ssl, pprint
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# require a certificate from the server
ssl_sock = ssl.wrap_socket(s,
                           ca_certs="F:/cert",
                           cert_reqs=ssl.CERT_REQUIRED)

ssl_sock.connect(('www.versign.com', 443))

print repr(ssl_sock.getpeername())
print ssl_sock.cipher()
print pprint.pformat(ssl_sock.getpeercert())

# Set a simple HTTP request -- use httplib in actual code.
ssl_sock.write("""GET / HTTP/1.0\r
Host: www.verisign.com\r\n\r\n""")

# Read a chunk of data.  Will not necessarily
# read all the data returned by the server.
data = ssl_sock.read()

# note that closing the SSLSocket will also close the underlying socket
ssl_sock.close() 
```

我收到以下错误：

> 回溯（最后一次调用）：文件“C:\Users\e\workspace\PythonTesting\source\HelloWorld.py”，第 38 行，在 ssl_sock.connect(('www.versign.com', 443))
> 
> 文件“C:\Python27\lib\ssl.py”，第 331 行，在连接中
> 
> ```
> self._real_connect(addr, False) 
> ```
> 
> _real_connect 中的文件“C:\Python27\lib\ssl.py”，第 314 行
> 
> self.ca_certs，self.ciphers）
> 
> ssl.SSLError: [Errno 185090050] _ssl.c:340: 错误:0B084002:x509 证书例程:X509_load_cert_crl_file:system lib

python 中的错误报告看起来并不指导找到问题的根源。我可能弄错了。谁能帮忙告诉我代码中的问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T19:51:24.167

这是已知 Python 标准库难以使用的领域之一。相反，您可能想要使用 requests 库。有关发送证书的文档，请访问：[http ://docs.python-requests.org/en/latest/user/advanced/#ssl-cert-verification](http://docs.python-requests.org/en/latest/user/advanced/#ssl-cert-verification)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:56:37.027

您的代码指的是驱动器“F:”（使用参数）上的证书*文件*`ca_certs`，该文件在执行期间未找到——有吗？

请参阅相关[文档](http://docs.python.org/library/ssl.html#ssl.wrap_socket)：

> ca_certs 文件包含一组串联的“认证机构”证书，用于验证从连接另一端传递的证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:01:02.287

引用的证书是否存在于您的文件系统中？我认为该错误是响应此代码中的无效证书：

ssl_sock = ssl.wrap_socket(s,ca_certs="F:/cert",cert_reqs=ssl.CERT_REQUIRED)

# .htaccess - 子目录创建运行时中的 URL 重写不起作用显示空白页

> ID：12884513
> 
> 赞同：0
> 
> 时间：2012-10-14T17:06:02.013
> 
> 标签：.htaccess, url-rewriting

我正在处理我的一些项目。我面临的主要问题是通过 .htaccess 重写 url 我只想 使用规则 `http://www.domain.com.au/servives.php?alphabet=a`写入`http://www.domain.com.au/cat/alphabet/a.htm``RewriteRule ^cat/alphabet/([^/]+)\.htm$ /services.php?alphabet=$1 [NC,PT]`

## 我的总 .htaccess 文件包含

```
Options +FollowSymlinks
RewriteEngine on
Options +Indexes
RewriteBase /

//commented// This rule to resolve cononicalization

RewriteCond %{HTTP_HOST} ^domain.com.au
RewriteRule (.*) http://www.domain.com.au/$1 [R=301,L]
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php\ HTTP/
RewriteRule ^index\.php$ http://www.domain.com.au/ [R=301,L]
RewriteRule ^cat/alphabet/([^/]+)\.htm$ /services.php?alphabet=$1 [NC,PT] 
```

但是，当我在浏览器中键入[http://www.domain.com.au/cat/alphabet/a.htm](http://www.domain.com.au/cat/alphabet/a.htm)时，这会打开一个空白页， 但会打开一个空白页，但它包含源代码显示没有错误但仍然是空白的。

如果我添加 [R] 的附加参数，那么它重定向到原始页面外部重定向工作正常。我花了至少一周的时间，很困惑。非常感谢您的帮助。它用这个重定向（带有额外的 R 标志）

`RewriteRule ^cat/alphabet/([^/]+)\.htm$ /services.php?alphabet=$1 [NC,R]`

为什么它不在内部重定向？

# apache - 在 Haskell 中使用 fastcgi 配置 apache

> ID：12884518
> 
> 赞同：1
> 
> 时间：2012-10-14T17:07:20.347
> 
> 标签：apache, haskell, centos, fastcgi

我正在尝试使用 apache（服务器版本：Apache/2.2.15（Cent OS 6））运行我的 Haskel fastcgi 程序，

以下是在 httpd.conf 中所做的更改

```
<IfModule fastcgi_module>
        AddHandle fastcgi-script .fcgi
</IfModule>

LoadModule fastcgi_module modules/mod_fastcgi.so

<VirtualHost *:80>

    ServerAdmin webmaster@<hostname>
    DocumentRoot /var/www
    ServerName <hostname>
    ErrorLog logs/<hostname>.com-error_log
    CustomLog logs/<hostname>-access_log common
    ScriptAlias /cgi-bin/ "/var/www/cgi-bin/"

        <Directory "/var/www/http">
                Options -Indexes FollowSymLinks +ExecCGI
                AllowOverride AuthConfig FileInfo
                AddHandler fastcgi-script .fcgi
                Order allow,deny
                Allow from all
        </Directory>
        <Directory "/var/www/cgi-bin">
                AllowOverride None
                Options None
                Order allow,deny
                Allow from all
        </Directory>
</VirtualHost> 
```

我按照[此处指定的所有说明进行操作](http://passingcuriosity.com/2009/haskell-fastcgi-with-apache/)

当我访问链接 curl --include http://hostname/cgi-bin/test.fcgi

我在 apache 服务器日志中收到错误

> [错误] 脚本头过早结束：test.fcgi

我该如何调试这个问题？

# objective-c - 从 UITextView 中的点击获取单词

> ID：12884520
> 
> 赞同：12
> 
> 时间：2012-10-14T17:07:42.537
> 
> 标签：objective-c, ios

我试图从水龙头里得到一个字。以下函数`sender`来自`UIGesture`on the `UITextView`, 句子。

```
- (IBAction)printWordSelected:(id)sender {
    NSLog(@"Clicked");

    CGPoint pos = [sender locationInView:self.view];
    UITextView *_tv = sentence;

    NSLog(@"Tap Gesture Coordinates: %.2f %.2f", pos.x, pos.y);

    //eliminate scroll offset
    pos.y += _tv.contentOffset.y;

    //get location in text from textposition at point
    UITextPosition *tapPos = [_tv closestPositionToPoint:pos];

    //fetch the word at this position (or nil, if not available)
    UITextRange * wr = [_tv.tokenizer rangeEnclosingPosition:tapPos withGranularity:UITextGranularityWord inDirection:UITextLayoutDirectionRight];

    NSLog(@"WORD: %@", [_tv textInRange:wr]);
} 
```

这是我已经拥有的，但它会将单词打印为 NULL

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-16T16:12:41.327

“尝试将 pos 更改为 pos = [sender locationInView:_tv]，然后删除 pos.y 调整。- rmaddy”

# javascript - 替换多重链接的硬编码锚部分

> ID：12884527
> 
> 赞同：1
> 
> 时间：2012-10-14T17:08:28.040
> 
> 标签：javascript, html, iis-7

[这个问题与使用 Jquery 在链接的锚部分中替换 http://](https://stackoverflow.com/questions/638488/replace-http-in-anchor-portion-of-links-using-jquery)类似（但有不同的转折）

我的目标是提出一个最佳解决方案来替换绝对路径/在网站中实现相对路径，可能使用脚本技术（jQuery 或 JsRender）或其他相关技术

有： - 每个页面中可能存在许多不同的硬编码服务器名称或 IP（甚至超过 10 个） - 超过 1000 多个 .htm、.html 页面要按摩

欢迎您提出建议（以及简短的操作方法！）

敏捷Q

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:33:15.703

以下是我如何制作 jQuery 解决方案：

```
$('a[href^="http"]').click(function(event){
    event.preventDefault();      
    var matches = $(this).attr('href').match(/http(s?):\/\/[^\/]+(\/.*)$/);
    window.location = matches[2];
}); 
```

注意：我没有对此进行测试，并且我的正则表达式模式可能存在缺陷。（我从来没有第一次把它们弄好，但我现在无法测试这个）

但关键是要捕获对指定 http 和域的链接的点击，然后在点击链接的 href 上使用 javascript 的 .match() ，为表示路径的 href 部分提供子匹配。然后重定向到那个。我会在正则表达式中使用正面的外观，但 JavaScript 不支持。

**更新**我刚刚在这里[http://jsfiddle.net/2wmaM/](http://jsfiddle.net/2wmaM/)测试了正则表达式，它似乎工作。

# python - 使用 Python 和 _winreg 从注册表中读取 DWORD 日期

> ID：12884534
> 
> 赞同：0
> 
> 时间：2012-10-14T17:09:13.717
> 
> 标签：python, python-2.7, dword, winreg

我正在尝试使用 Python 从 Windows 注册表中读取 DWORD 日期，但[`_winreg.QueryValueEx`](http://docs.python.org/library/_winreg.html?highlight=queryvalueex#_winreg.QueryValueEx)我无法获得正确的格式。

```
DWORD Value: 5116e300

Output using _winreg.QueryValueEx: 1360454400

Desired Output: 2/10/2013 
```

我可以[`datetime`](http://docs.python.org/library/datetime.html?highlight=datetime#datetime)以某种方式使用吗？

谢谢

* * *

编辑

[kindall 的解决方案](https://stackoverflow.com/a/12885031/1061279)在下面起作用。

使用的最后一行如下：

```
import time

t = 1360454400
print time.strftime("%m/%d/%y", time.gmtime(t)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:08:41.727

这将使您非常接近：

```
import time

t = 1360454400
print time.strftime("%m/%d/%y", time.gmtime(t)) 
```

要在没有前导零的情况下获得它：

```
t = time.gmtime(t)
print "%d/%d/%2d" % (t.tm_mon, t.tm_mday, t.tm_year % 100) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:22:39.150

奇怪的是 DWORD 的值`5116e300`实际上是`1360388864`而不是的值`1360454400`，但无论如何......

```
ts = datetime.fromtimestamp(1360454400)

print '{:%m/%d/%Y}'.format(ts) #
# '02/10/2013' 
```

或者：

```
print '{0.month}/{0.day}/{0.year}'.format(ts)
# '2/10/2013' 
```

# ruby - 当 RVM 明确安装并在环境中时，“/usr/bin/env ruby ”默认为 Ruby 1.8

> ID：12884536
> 
> 赞同：2
> 
> 时间：2012-10-14T17:09:29.920
> 
> 标签：ruby, rvm, osx-mountain-lion

我遇到了一个问题，我构建了一个脚本来通过 Boxcar 发送通知。该脚本已`#!/usr/bin/env ruby`设置在顶部，但是当 SABnzb 触发后处理脚本时，它会出现以下错误：

```
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- boxcar_api (LoadError) from
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems/custom_require.rb:31:in `require' from /Applications/Sick-Beard/autoProcessTV/sabnzb-notification.rb:4 
```

此外，当我从终端运行脚本时，它执行得很好。只有当 SABnzb 在后处理中执行它时。

如果我运行`which ruby`，它们都会输出正确版本`ruby -v`的`/usr/bin/env ruby -v`Ruby。

```
$ which ruby
/Users/ericc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby
$ ruby -v
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]
$ /usr/bin/env ruby -v
ruby 1.9.3p286 (2012-10-12 revision 37165) [x86_64-darwin12.2.0]
$ rvm -v
rvm 1.16.13 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/] 
```

~/.bash_profile

```
export PATH="/usr/local/bin:/usr/local/sbin:~/bin:$PATH"
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # Load RVM function 
```

任何人都知道为什么要加载 Ruby 1.8 而不是 RVM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:03:08.540

SABnzb 是在不知道您的 rvm 安装的环境中启动的。有几种方法可以解决这个问题：

1.  明确说明脚本正在调用的 ruby​​。（即-将shebang更改为`#!/Users/ericc/.rvm/rubies/ruby-1.9.3-p286/bin/ruby`）
2.  在调用脚本之前编写一个设置环境的包装器 shell 脚本。让 SABnzb 首先调用包装脚本。
3.  编辑启动 SABnzb 的 init 脚本并将 rvm 环境添加到其中。这仅在 SABnzb 以安装 rvm 的用户身份启动时才有效。
4.  如果 SABnzb 以与 rvm 安装不同的用户身份运行，则全局安装 rvm 或以运行 SABnzb 的同一用户身份安装，然后编辑 SABnzb 初始化脚本以具有 rvm 环境设置脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:28:16.457

对你有用`rvm use ruby-1.9.3-p286 --default`吗？

# java - Java中用户定义的符号是否区分大小写？

> ID：12884538
> 
> 赞同：-5
> 
> 时间：2012-10-14T17:09:42.673
> 
> 标签：java

> **可能重复：**
> [java 是否区分大小写？如果是，为什么？](https://stackoverflow.com/questions/2128459/is-java-case-sensitive-if-so-why)

在Java中，用户定义的符号是否区分大小写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:10:11.280

Java 中的所有内容都**区分大小写**。

# bash - Bash - 遍历两个（不相交）数组的联合

> ID：12884540
> 
> 赞同：1
> 
> 时间：2012-10-14T17:09:58.133
> 
> 标签：bash, solaris, opensolaris

我正在编写一个 bash 脚本（用于 Open Solaris 11 机器）。

我通过以下方式声明了两个数组：

```
rpool_fs=(
  "rpool"
  "rpool/ROOT"
  "rpool/ROOT/solaris"
  "rpool/export"
);

shares_fs=(
  "shares"
  "shares/svn"
); 
```

我可以通过以下方式迭代 rpool_fs 数组：

```
for i in "${rpool_fs[@]}"
do
  echo $i
done 
```

**我现在需要遍历 rpool_fs 和 share_fs 数组的联合。**请注意，数组是不相交的，例如，我实际上只需要遍历它们的串联。我怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:11:18.630

一个接一个地放：

```
for i in "${rpool_fs[@]}" "${shares_fs[@]}"
do
  echo $i
done 
```

# c# - 无法通过Paypal测试工具测试IPN（HTTP错误代码500）_Asp.net

> ID：12884549
> 
> 赞同：2
> 
> 时间：2012-10-14T17:11:20.673
> 
> 标签：c#, asp.net, paypal-ipn

美好的一天，我一直在尝试为 PayPal 运行 IPN 处理程序；我已遵循所有可能的说明（我希望如此），但是在 paypal IPN 测试工具上，我不断收到代码 500 的错误。我使用的代码是 johnmendez00 作为开源提供的代码；通过创建一个实例来调用该类

```
PPIPN objPP = new PPIPN("TEST");
objPP.FromEmail = "email@yourdomain.com";  
objPP.FromEmailPassword = "yourpassword";  
objPP.SmtpHost = "yourSMTPHost";
objPP.SmtpPort = "SMTPHostPort";
objPP.ToEmail = "youremailatPayPal@domain.com";/ 
objPP.MakeHttpPost();
objPP.CheckStatus(); 
```

实例的类如下：

```
/// <summary>
/// Project can be found in http://paypalipnclass.codeplex.com/
/// </summary>

using System.Net;
using System.Net.Mail;
using System.IO;
using System.Text;
using System.Web;
using System.Data;
using System.Data.SqlClient;
using System;
using System.Configuration;
public class PPIPN
 {

string _txnID, _txnType, _paymentStatus, _receiverEmail, _itemName, _itemNumber, _quantity, _invoice, _custom,
_paymentGross, _payerEmail, _pendingReason, _paymentDate, _paymentFee, _firstName, _lastName, _address,
_city, _state, _zip, _country, _countryCode, _addressStatus, _payerStatus, _payerID, _paymentType, _notifyVersion,
_verifySign, _response, _payerPhone, _payerBusinessName, _business, _receiverID, _memo, _tax, _qtyCartItems,
_shippingMethod, _shipping;

private string _postUrl = "";
private string _strRequest = "";
private string _smtpHost, _fromEmail, _toEmail, _fromEmailPassword, _smtpPort;

/// <summary>
/// valid strings are "TEST" for sandbox use 
/// "LIVE" for production use
/// "ELITE" for test use off of PayPal...avoid having to be logged into PayPal Developer
/// </summary>
/// <param name="mode"></param>
public PPIPN(string mode)
{
    if (mode.ToLower() == "test")
        this.PostUrl = "https://www.sandbox.paypal.com/cgi-bin/webscr";
    else if (mode.ToLower() == "live")
        this.PostUrl = "https://www.paypal.com/cgi-bin/webscr";
    else if (mode.ToLower() == "elite")
        this.PostUrl = "http://www.eliteweaver.co.uk/testing/ipntest.php";
    else
        this.PostUrl = "";

    //this.fillProperties();
}

#region "Properties"

private string PostUrl
{
    get { return _postUrl; }
    set { _postUrl = value; }
}

/// <summary>
/// This is the reponse back from the http post back to PayPal.
/// Possible values are "VERIFIED" or "INVALID"
/// </summary>
private string Response
{
    get { return _response; }
    set { _response = value; }
}

private string RequestLength
{
    get { return _strRequest; }
    set { _strRequest = value; }
}

/// <summary>
/// Provide your outgoing email server to use are your SMTP host
/// </summary>
public string SmtpHost
{
    get { return _smtpHost; }
    set { _smtpHost = value; }
}

/// <summary>
/// Provide the port your outgoing SMTP host uses
/// </summary>
public string SmtpPort
{
    get { return _smtpPort; }
    set { _smtpPort = value; }
}

/// <summary>
/// This is the email address that will show to the customer and you. This most likely
/// needs to be a valid email address that your SMTP server will accept
/// Examples would be something like no-reply@yourdomain.com
/// </summary>
public string FromEmail
{
    get { return _fromEmail; }
    set { _fromEmail = value; }
}

/// <summary>
/// This is the password that the FromEmail property will use. This needs to be the password
/// for the email account itself
/// </summary>
public string FromEmailPassword
{
    get { return _fromEmailPassword; }
    set { _fromEmailPassword = value; }
}

/// <summary>
/// This is the email address that you use for yourself. This should be set to
/// the email that is registered for your PayPal account.
/// </summary>
public string ToEmail
{
    get { return _toEmail; }
    set { _toEmail = value; }
}

/// <summary>
/// Email address or Account ID of the payment recipient.  This is equivalent
///  to the value of receiver_email if the payment is sent to the primary account
/// , which is most cases it is.  This value is that value of what is set in the button html
/// markup.  This value also get normalized to lowercase when coming back from PayPal
/// </summary>
private string Business
{
    get { return _business; }
    set { _business = value; }
}

/// <summary>
/// Unique transaction ID generated by PayPal. Helpful to use for checking
///  against fraud to make sure the transaction hasn't already occured.
/// </summary>
private string TXN_ID
{
    get { return _txnID; }
    set { _txnID = value; }
}

/// <summary>
/// Type of transaction from the customer. Possible values are
/// "cart", "express_checkout", "send_money", "virtual_terminal", "web-accept"
/// </summary>
private string TXN_Type
{
    get { return _txnType; }
    set { _txnType = value; }
}

/// <summary>
/// This is the status of the payment from the Customer.Possible values are: 
/// "Canceled_Reversal", "Completed", "Denied", "Expired", "Failed", "Pending",
///  "Processed", "Refunded", "Reversed", "Voided"
/// </summary>
private string PaymentStatus
{
    get { return _paymentStatus; }
    set { _paymentStatus = value; }
}

/// <summary>
/// Primary email address of you, the recipient, of the payment.
/// </summary>
private string ReceiverEmail
{
    get { return _receiverEmail; }
    set { _receiverEmail = value; }
}

/// <summary>
/// unique account ID of the payment recipient, which is most likely yourself.
/// </summary>
private string ReceiverID
{
    get { return _receiverID; }
    set { _receiverID = value; }
}

/// <summary>
/// This is the item name passed by yourself or if the customer if you let them enter in an item name
/// </summary>
private string ItemName
{
    get { return _itemName; }
    set { _itemName = value; }
}

/// <summary>
/// This is the item number you set for your own tracking purposes. It is not required by PayPal
/// so if you didn't set it most likely will come back blank.
/// </summary>
private string ItemNumber
{
    get { return _itemNumber; }
    set { _itemNumber = value; }
}

/// <summary>
/// Quantity of the item ordered by the customer
/// </summary>
private string Quantity
{
    get { return _quantity; }
    set { _quantity = value; }
}

/// <summary>
/// Quantity of the items in the shopping cart from the Customer
/// </summary>
private string QuantityCartItems
{
    get { return _qtyCartItems; }
    set { _qtyCartItems = value; }
}

/// <summary>
/// Invoice number passed by yourself, if you didn't pass it to PayPal then this is omitted.
/// </summary>
private string Invoice
{
    get { return _invoice; }
    set { _invoice = value; }
}

/// <summary>
/// Custom value passed by yourself with the item.
/// </summary>
private string Custom
{
    get { return _custom; }
    set { _custom = value; }
}

/// <summary>
/// Memo entered in by the customer on PayPal website note field
/// </summary>
private string Memo
{
    get { return _memo; }
    set { _memo = value; }
}

/// <summary>
/// Amount of tax charged on the payment
/// </summary>
private string Tax
{
    get { return _tax; }
    set { _tax = value; }
}

/// <summary>
/// Full USD amount of customer's payment before the PayPal fee is subtracted
/// </summary>
private string PaymentGross
{
    get { return _paymentGross; }
    set { _paymentGross = value; }
}

/// <summary>
/// Date Time stamp created by PayPal in the following format: 
/// HH:MM:SS DD Mmm YY, YYYY PST
/// </summary>
private string PaymentDate
{
    get { return _paymentDate; }
    set { _paymentDate = value; }
}

/// <summary>
/// PayPal's transaction fees associated with purchase.
/// </summary>
private string PaymentFee
{
    get { return _paymentFee; }
    set { _paymentFee = value; }
}

/// <summary>
/// This is the email that the customer used on PayPal or that
/// is registered with PayPal
/// </summary>
private string PayerEmail
{
    get { return _payerEmail; }
    set { _payerEmail = value; }
}

/// <summary>
/// Customer's phone number
/// </summary>
private string PayerPhone
{
    get { return _payerPhone; }
    set { _payerPhone = value; }
}

/// <summary>
/// Customer's company name if they represent a business
/// </summary>
private string PayerBusinessName
{
    get { return _payerBusinessName; }
    set { _payerBusinessName = value; }
}

/// <summary>
/// This variable is only set if the payment_status=Pending. Possible values are the following:
/// "address", "authorization", "echeck", "intl", "multi-currency", "unilateral", "upgrade",
///  "verify", other"
/// </summary>
private string PendingReason
{
    get { return _pendingReason; }
    set { _pendingReason = value; }
}

/// <summary>
/// This is indicated from what is set in your PayPal profile settings
/// </summary>
private string ShippingMethod
{
    get { return _shippingMethod; }
    set { _shippingMethod = value; }
}

/// <summary>
/// Shipping charges associated with the order.
/// </summary>
private string Shipping
{
    get { return _shipping; }
    set { _shipping = value; }
}

/// <summary>
/// Customer's First Name
/// </summary>
private string PayerFirstName
{
    get { return _firstName; }
    set { _firstName = value; }
}

/// <summary>
/// Customer's Last Name
/// </summary>
private string PayerLastName
{
    get { return _lastName; }
    set { _lastName = value; }
}

/// <summary>
/// Customer's street address
/// </summary>
private string PayerAddress
{
    get { return _address; }
    set { _address = value; }
}

/// <summary>
/// Customer's city
/// </summary>
private string PayerCity
{
    get { return _city; }
    set { _city = value; }
}

/// <summary>
/// Customer state of address
/// </summary>
private string PayerState
{
    get { return _state; }
    set { _state = value; }
}

/// <summary>
/// Zip code of customer's address
/// </summary>
private string PayerZipCode
{
    get { return _zip; }
    set { _zip = value; }
}

/// <summary>
/// Customer's country
/// </summary>
private string PayerCountry
{
    get { return _country; }
    set { _country = value; }
}

/// <summary>
/// Customer's 2 character country code
/// </summary>
private string PayerCountryCode
{
    get { return _countryCode; }
    set { _countryCode = value; }
}

/// <summary>
/// The the address provided is either confirmed or uncomfirmed from PayaPal. Possible values  from PayPal
/// are going to be "confirmed" or "unconfirmed"
/// </summary>
private string PayerAddressStatus
{
    get { return _addressStatus; }
    set { _addressStatus = value; }
}

/// <summary>
/// Customer either had a verified or unverified account with PayPal. 
/// Possible return values from PayPal are "verified" or "unverified"
/// </summary>
private string PayerStatus
{
    get { return _payerStatus; }
    set { _payerStatus = value; }
}

/// <summary>
/// Customer's unique ID
/// </summary>
private string PayerID
{
    get { return _payerID; }
    set { _payerID = value; }
}

/// <summary>
/// Type of payment from Customer. Possible values from PayPal are "echeck" and "instant"
/// </summary>
private string PaymentType
{
    get { return _paymentType; }
    set { _paymentType = value; }
}

/// <summary>
/// This is the version number of the IPN that makes the post.
/// </summary>
private string NotifyVersion
{
    get { return _notifyVersion; }
    set { _notifyVersion = value; }
}

/// <summary>
/// An encrypted string that is used to validate the transaction. You don't have to use this for anything
///  unless you want to keep it and store it for your records.
/// </summary>
private string VerifySign
{
    get { return _verifySign; }
    set { _verifySign = value; }
}

#endregion

#region "Make HTTP POST"

/// <summary>
/// This makes the post back to PayPal to verify the order.
/// </summary>
public void MakeHttpPost()
{
    HttpWebRequest req = (HttpWebRequest)WebRequest.Create(this.PostUrl);

    req.Method = "POST";
    req.ContentLength = this.RequestLength.Length + 21;
    req.ContentType = "application/x-www-form-urlencoded";
    byte[] param = HttpContext.Current.Request.BinaryRead(HttpContext.Current.Request.ContentLength);
    this.RequestLength = Encoding.ASCII.GetString(param);
    this.RequestLength += "&cmd=_notify-validate";
    req.ContentLength = this.RequestLength.Length;

    StreamWriter streamOut = new StreamWriter(req.GetRequestStream(), System.Text.Encoding.ASCII);
    streamOut.Write(this.RequestLength);
    streamOut.Close();
    StreamReader streamIn = new StreamReader(req.GetResponse().GetResponseStream());
    this.Response = streamIn.ReadToEnd();
    streamIn.Close();
}

#endregion

#region "Check Status of Order"

/// <summary>
/// This checks the status of the order and notifies you via email the status.
/// </summary>
public void CheckStatus()
{
    this.fillProperties();
    switch (this.Response)
    {
        case "VERIFIED":

            switch (this.PaymentStatus)
            {
                case "Completed": //If statement to check and verify the business email and that the script was triggered from the buy_now button.
                    if (this.ReceiverEmail == this.ToEmail)
                    {
                        switch (this.TXN_Type)
                        {
                            case "cart":
                                this.EmailUs("PayPal: Successful Order from Cart");
                                break;
                            case "express_checkout":
                                this.EmailUs("PayPal: Successful Order from Express Checkout");
                                break;
                            case "send_money":
                                this.EmailUs("PayPal: Successful Order from Send Money");
                                break;
                            case "virtual_terminal":
                                this.EmailUs("PayPal: Successful Order from Virtual Terminal");
                                break;
                            case "web_accept":
                                this.EmailUs("PayPal: Successful Order from Web_Accept");
                                break;
                            default:
                                this.EmailUs("PayPal: Order has been placed");
                                break;
                        }
                    }
                    else
                    {
                        this.EmailUs("PayPal: Unknown order...please check your paypal account");
                    }
                    break;
                case "Pending":
                    switch (this.PendingReason)
                    {
                        case "address":
                            this.EmailUs("PayPal: Pending Order because of address");
                            break;
                        case "authorization":
                            this.EmailUs("PayPal: Pending Order because of authorization");
                            break;
                        case "echeck":
                            this.EmailUs("PayPal: Pending Order because of echeck");
                            break;
                        case "intl":
                            this.EmailUs("PayPal: Pending Order because of non-US Acccount");
                            break;
                        case "multi-currency":
                            this.EmailUs("PayPal: Pending Order because of multi-currency");
                            break;
                        case "unilateral":
                            this.EmailUs("PayPal: Pending Order because of Unilateral");
                            break;
                        case "upgrade":
                            this.EmailUs("PayPal: Pending Order because of Upgrade");
                            break;
                        case "verify":
                            this.EmailUs("PayPal: Pending Order because of Verification needed");
                            break;
                        case "other":
                            this.EmailUs("PayPal: Pending Order because of other reason");
                            break;
                        default:
                            this.EmailUs(string.Format("PayPal: Pending Order because of unknown reason of {0}", this.PendingReason));
                            break;
                    }
                    break;
                case "Failed":
                    this.EmailUs("PayPal: Failed order");
                    break;
                case "Denied":
                    this.EmailUs("PayPal: Denied order");
                    break;
            }

            this.EmailBuyer("Order Received", "Your order has been received and will begin processing shortly.");

            break;
        case "INVALID":
            this.EmailUs("PayPal: Invalid order, please review and investigate");
            break;
        default:
            this.EmailUs("PayPal: ERROR, response is " + this.Response);
            break;
    }
}

#endregion

#region "Mail Company the Order"
/// <summary>
/// Email yourself/company the order. This requires a subject line. Make sure to set SMTP properties of the PayPal object 
/// and the FromEmail and ToEmail properties as well.
/// </summary>
/// <param name="subject"></param>
private void EmailUs(string subject)
{
    MailMessage mailObj = new MailMessage();
    mailObj.From = new MailAddress(this.FromEmail);
    mailObj.Subject = subject;
    mailObj.To.Add(new MailAddress(this.ToEmail));
    mailObj.IsBodyHtml = true;
    mailObj.Body = "<br />"
    + "Transaction ID: " + this.TXN_ID + "<br />"
    + "Transaction Type:" + this.TXN_Type + "<br />"
    + "Payment Type: " + this.PaymentType + "<br />"
    + "Payment Status: " + this.PaymentStatus + "<br />"
    + "Pending Reason: " + this.PendingReason + "<br />"
    + "Payment Date: " + this.PaymentDate + "<br />"
    + "Receiver Email: " + this.ReceiverEmail + "<br />"
    + "Invoice: " + this.Invoice + "<br />"
    + "Item Number: " + this.ItemNumber + "<br />"
    + "Item Name: " + this.ItemName + "<br />"
    + "Quantity: " + this.Quantity + "<br />"
    + "Custom: " + this.Custom + "<br />"
    + "Payment Gross: " + this.PaymentGross + "<br />"
    + "Payment Fee: " + this.PaymentFee + "<br />"
    + "Payer Email: " + this.PayerEmail + "<br />"
    + "First Name: " + this.PayerFirstName + "<br />"
    + "Last Name: " + this.PayerLastName + "<br />"
    + "Street Address: " + this.PayerAddress + "<br />"
    + "City: " + this.PayerCity + "<br />"
    + "State: " + this.PayerState + "<br />"
    + "Zip Code: " + this.PayerZipCode + "<br />"
    + "Country: " + this.PayerCountry + "<br />"
    + "Address Status: " + this.PayerAddressStatus + "<br />"
    + "Payer Status: " + this.PayerStatus + "<br />"
    + "Verify Sign: " + this.VerifySign + "<br />"
    + "Notify Version: " + this.NotifyVersion + "<br />";

    SmtpClient objSmtp = new SmtpClient();

    objSmtp.Host = this.SmtpHost;
    objSmtp.Port = System.Int32.Parse(this.SmtpPort);
    objSmtp.UseDefaultCredentials = false;
    objSmtp.Credentials = new System.Net.NetworkCredential(this.FromEmail, this.FromEmailPassword);
    objSmtp.DeliveryMethod = SmtpDeliveryMethod.Network;
    objSmtp.Send(mailObj);
}

#endregion

#region "Mail the Customer the Order details"

private void EmailBuyer(string subject, string message)
{
    MailMessage mailObj = new MailMessage();
    mailObj.From = new MailAddress(this.FromEmail);
    mailObj.Subject = subject;
    mailObj.Body = message;
    mailObj.To.Add(new MailAddress(this.PayerEmail));
    mailObj.IsBodyHtml = true;

    SmtpClient objSmtp = new SmtpClient();

    objSmtp.Host = this.SmtpHost;
    objSmtp.Port = System.Int32.Parse(this.SmtpPort);
    objSmtp.UseDefaultCredentials = false;
    objSmtp.Credentials = new System.Net.NetworkCredential(this.FromEmail, this.FromEmailPassword);
    objSmtp.DeliveryMethod = SmtpDeliveryMethod.Network;
    objSmtp.Send(mailObj);
}

#endregion

#region "Fill Properties"

private void fillProperties()
{
    this.RequestLength = HttpContext.Current.Request.Form.ToString();
    this.PayerCity = HttpContext.Current.Request.Form["address_city"];
    this.PayerCountry = HttpContext.Current.Request.Form["address_country"];
    this.PayerCountryCode = HttpContext.Current.Request.Form["address_country_code"];
    this.PayerState = HttpContext.Current.Request.Form["address_state"];
    this.PayerAddressStatus = HttpContext.Current.Request.Form["address_status"];
    this.PayerAddress = HttpContext.Current.Request.Form["address_street"];
    this.PayerZipCode = HttpContext.Current.Request.Form["address_zip"];
    this.PayerFirstName = HttpContext.Current.Request.Form["first_name"];
    this.PayerLastName = HttpContext.Current.Request.Form["last_name"];
    this.PayerBusinessName = HttpContext.Current.Request.Form["payer_business_name"];
    this.PayerEmail = HttpContext.Current.Request.Form["payer_email"];
    this.PayerID = HttpContext.Current.Request.Form["payer_id"];
    this.PayerStatus = HttpContext.Current.Request.Form["payer_status"];
   // this.PayerPhone = HttpContext.Current.Request.Form["contact_phone"];
    this.Business = HttpContext.Current.Request.Form["business"];
    this.ItemName = HttpContext.Current.Request.Form["item_name"];
    this.ItemNumber = HttpContext.Current.Request.Form["item_number"];
    this.Quantity = HttpContext.Current.Request.Form["quantity"];
    this.ReceiverEmail = HttpContext.Current.Request.Form["receiver_email"];
    this.ReceiverID = HttpContext.Current.Request.Form["receiver_id"];
    this.Custom = HttpContext.Current.Request.Form["custom"];
   // this.Memo = HttpContext.Current.Request.Form["memo"];
    this.Invoice = HttpContext.Current.Request.Form["invoice"];
    this.Tax = HttpContext.Current.Request.Form["tax"];
    this.QuantityCartItems = HttpContext.Current.Request.Form["num_cart_items"];
    this.PaymentDate = HttpContext.Current.Request.Form["payment_date"];
    this.PaymentStatus = HttpContext.Current.Request.Form["payment_status"];
    this.PaymentType = HttpContext.Current.Request.Form["payment_type"];
    this.PendingReason = HttpContext.Current.Request.Form["pending_reason"];
    this.TXN_ID = HttpContext.Current.Request.Form["txn_id"];
    this.TXN_Type = HttpContext.Current.Request.Form["txn_type"];
    this.PaymentFee = HttpContext.Current.Request.Form["mc_fee"];
    this.PaymentGross = HttpContext.Current.Request.Form["mc_gross"];
    this.NotifyVersion = HttpContext.Current.Request.Form["notify_version"];
   // this.VerifySign = HttpContext.Current.Request.Form["verify_sign"];
}

#endregion

} 
```

对这里可能出现的问题有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T19:26:15.520

来自 PayPal 站点的按钮 HTML 嵌入在表单标记中。ASP.NET 页面上只能有一个表单，而 ASP.NET 提供了它自己的表单。如果您有一个母版页，那么表单标签就在其中，当它们在运行时与母版合并时，它将应用于站点中的每个页面。

我在 Jeremy Schneider 的博客上找到了一个[优雅的解决方案](http://jerschneid.blogspot.com/2007/03/hide-form-tag-but-leave-content.html)，它包含一个自定义 HtmlForm 类，可以打开和关闭表单标签呈现。该类称为 GhostForm，并具有一个属性 RenderFormTag。当 RenderFormTag 设置为 false 时，它​​不会呈现开始或结束标签，但会呈现所有内容。引用自定义 GhostForm 类，并在放置按钮的表单的代码隐藏中，将以下内容放在 Page_Load 中以禁用母版页表单标记：

用法：

```
public partial class Products : System.Web.UI.Page
 {
     protected void Page_Load(object sender, EventArgs e)
     {
         GhostForm mainForm = new GhostForm();
         mainForm.RenderFormTag = false;
         .....     
     }
         // Send your data to PayPal :-)
     .....
 } 
```

**重要提示：**在发送此请求之前，请确保您已登录沙箱。

**更新：**查看这些教学视频：[http ://www.asp.net/mvc/videos/mvc-1/aspnet-mvc-storefront/aspnet-mvc-storefront-part-1-architectural-discussion-and-overview](http://www.asp.net/mvc/videos/mvc-1/aspnet-mvc-storefront/aspnet-mvc-storefront-part-1-architectural-discussion-and-overview)

和你一样，我使用了 John Mendez 的 IPN 代码。这是我从 PayPal 发送和接收的地方：

```
string strSandbox = "https://www.sandbox.paypal.com/cgi-bin/webscr";
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(strLive);

//Set values for the request back to PayPal
req.Method = "POST";
req.ContentType = "application/x-www-form-urlencoded";
byte[] param = Request.BinaryRead(HttpContext.Current.Request.ContentLength);
string strRequest = Encoding.ASCII.GetString(param);
strRequest += "&cmd=_notify-validate";
req.ContentLength = strRequest.Length;

//Send the request to PayPal 
StreamWriter streamOut = 
    new StreamWriter(req.GetRequestStream(), System.Text.Encoding.ASCII);
streamOut.Write(strRequest);
streamOut.Close();

// Get the response from PayPal
StreamReader streamIn = new StreamReader(req.GetResponse().GetResponseStream());
string strResponse = streamIn.ReadToEnd();
streamIn.Close(); 
```

希望这会有所帮助。500个错误可能是任何东西......

# haskell - Haskell monad 返回任意数据类型

> ID：12884551
> 
> 赞同：2
> 
> 时间：2012-10-14T17:11:40.020
> 
> 标签：haskell, return, monads

我无法通过自定义定义的递归数据类型定义返回。

数据类型如下：

数据 A a = B a | C (A一) (A一)

但是，我不知道如何定义 return 语句，因为我不知道何时返回 B 值以及何时递归返回 C。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-14T17:40:49.230

为这种类型定义`Monad`实例的一种方法是将其视为*自由*单子。实际上，这需要`A a`一种带有一个二元运算符的小语法，以及由构造函数嵌入`C`的类型值表示的变量。这使得构造函数、嵌入变量和执行替换的运算符。`a``B``return``B``>>=`

```
instance Monad A where
  return = B
  B x   >>= f = f x
  C l r >>= f = C (l >>= f) (r >>= f) 
```

不难看出`(>>= B)`执行身份替换，并且替换的组合是关联的。

另一种更“必要”的方式来看待这个 monad 是它捕捉了可以翻转硬币（或读取比特流或以其他方式访问一系列二进制选择）的计算概念。

```
data Coin = Heads | Tails 
```

任何可以翻转硬币的计算必须要么停止翻转并成为一个值（with `B`），要么翻转硬币并继续（with `C`），如果硬币出现`Heads`，另一种方式，如果`Tails`。抛硬币并告诉你发生了什么的一元操作是

```
coin :: A Coin
coin = C (B Heads) (B Tails) 
```

现在可以将`>>=`of`A`视为排序掷硬币计算，允许后续计算的选择取决于早期计算提供的值。

如果你有无限的硬币流，那么（除了你非凡的好运之外）你也很幸运能够运行任何`A`计算到它的值，如下所示

```
data Stream x = x :> Stream x   -- actually, I mean "codata"

flipping :: Stream Coin -> A v -> v
flipping _             (B v)    = v
flipping (Heads :> cs) (C h t)  = flipping cs h
flipping (Tails :> cs) (C h t)  = flipping cs t 
```

这种 monad 的一般模式是有一个构造函数用于返回一个值（`B`这里）和一堆其他的构造函数，它们表示可能的操作的选择以及在给定操作结果的情况下可以继续计算的不同方式。这里`C`没有非递归参数和两个子树，所以我可以说必须只有一个操作并且它必须只有两个可能的结果，因此掷硬币。

因此，它是用变量和一个二元运算符替换语法，或者它是一种排序计算的方式来翻转硬币。哪种观点更好？嗯...它们是同一枚硬币的两个面。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-14T17:32:58.230

一个好的经验法则`return`是让它成为最简单可行的东西（当然，任何满足单子定律的定义都可以，但通常你想要结构最小的东西）。在这种情况下，它就像`return = B`（现在写一个`(>>=)`匹配！）一样简单。

顺便说一句，这是一个[免费的 monad](http://hackage.haskell.org/packages/archive/free/latest/doc/html/Control-Monad-Free.html)的例子——事实上，它是文档中给出的例子，所以我会让文档自己说话。

# vb.net - Visual C++ 托管应用程序：找不到名为“添加”的入口点

> ID：12884555
> 
> 赞同：0
> 
> 时间：2012-10-14T17:11:54.527
> 
> 标签：vb.net, visual-c++

我按照下一页上的教程创建了一个 c++ DLL，并将其放在 System32 文件夹中：http: [//msdn.microsoft.com/en-us/library/ms235636%28v=vs.80%29。 .aspx](http://msdn.microsoft.com/en-us/library/ms235636%28v=vs.80%29.aspx) _ 我可以在 PC 上的任何地方运行 .exe。现在我希望能够从 VB.NET 应用程序中调用 Add，所以我添加了以下代码：

```
Imports System.Runtime.InteropServices

Public Class Form1

    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Try
            Dim Test As Integer
            Test = Add(1, 1)
            MsgBox(Test)
        Catch ex As Exception

        End Try
    End Sub

    <DllImport("MathFuncsDll.dll", EntryPoint:="Add", SetLastError:=True, CharSet:=CharSet.Ansi)> _
    Private Shared Function Add(ByVal a As Double, ByVal B As Double) As Double
    End Function

End Class 
```

我收到以下错误：无法在 DLL 'MathFuncsDll.dll 中找到名为 'Add' 的入口点。我相信这是因为命名空间。我对此进行了研究，一些网页说平台调用不允许命名空间，一些网页说它们是允许的。问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T18:13:54.310

入口点未命名为“添加”。从 Visual Studio 命令提示符运行`dumpbin /exports MathFuncsDll.dll`以查看导出的名称。要获得此声明：

```
<DllImport("MathFuncsDll.dll", EntryPoint:="?Add@MyMathFuncs@MathFuncs@@SANNN@Z", _
           CallingConvention:=CallingConvention.Cdecl)> _
Private Shared Function Add(ByVal a As Double, ByVal B As Double) As Double
End Function 
```

这个看起来很奇怪的名字是由 C++ 编译器产生的，这个特性叫做“名字修饰”。它支持函数重载。你可以把它放在`extern "C"`函数声明的前面来禁止它。如果你不这样做，实际上会更好。还要注意 SetLastError 不正确，代码实际上并没有调用 SetLastError() 来报告错误。而且 CharSet 不合适，这些函数不接受字符串。

您还需要对 Divide 函数做一些事情，在互操作场景中抛出 C++ 异常不会有好的结果，只有 C++ 代码可以捕获异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:43:01.663

不允许命名空间。PInvoke 像普通的 C 客户端一样工作。不要忘记将 MathFuncsDll 声明为 extern "C" 以防止 C++ 名称混淆。使用 Dependency Walker 或 dumpbin 查看从 MathFuncsDll 导出的函数列表。

# vba - 如何将不同工作簿中的单元格内容复制并附加到 Activework？

> ID：12884557
> 
> 赞同：0
> 
> 时间：2012-10-14T17:12:17.740
> 
> 标签：vba, excel

我有一个允许用户浏览和选择多个 Excel 文件的宏，在用户选择了多个 Excel 文件后，多个 Excel 文件中的内容应保存在当前活动工作簿上的一张纸上。内容将相互附加。

问题是当循环第二次运行时它抱怨范围，它说范围应该从“A1”开始。

下面是我的代码。

```
Sub Button3_Click()
Dim fileStr As Variant
Dim incount As Integer
Dim wbk1 As Workbook, wbk2 As Workbook

incount = 1

fileStr = Application.GetOpenFilename(FileFilter:="microsoft excel files (*.xlsx), *.xlsx", Title:="Get File", MultiSelect:=True)

    For i = 1 To UBound(fileStr)
        MsgBox fileStr(i), , GetFileName(CStr(fileStr(i)))
        Set wbk1 = ActiveWorkbook
        Set wbk2 = Workbooks.Open(fileStr(i))

        wbk2.Sheets(1).Cells.Copy wbk1.Worksheets("Sheet3").Cells(incount, 1)

        incount = Range("A" & Rows.Count).End(xlUp).Row

        wbk2.Close
    Next i

    MsgBox incount

End Sub
Function GetFileName(fileStr As String)
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    GetFileName = fso.GetFileName(fileStr)

End Function 
```

错误信息：

```
Run-time error '1004'

To paste all cells from an Excel worksheet into the current worksheet,
you must paste into the first cell(A1 or R1C1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:19:12.247

*cells.copy*将整个数据表复制到“incount”行，这意味着在已粘贴数据下方的“整个源表”的目标位置没有空间

试试下面的代码，它会删除 incount 并获取 UsedRange：

```
Sub Button3_Click()
Dim fileStr As Variant
Dim wbk1 As Workbook, wbk2 As Workbook
Dim ws1 As Worksheet

fileStr = Application.GetOpenFilename(FileFilter:="microsoft excel files (*.xlsx), *.xlsx", Title:="Get File", MultiSelect:=True)

Set wbk1 = ActiveWorkbook
Set ws1 = wbk1.Sheets("Sheet3")

For i = 1 To UBound(fileStr)
    MsgBox fileStr(i), , GetFileName(CStr(fileStr(i)))

    Set wbk2 = Workbooks.Open(fileStr(i))

    wbk2.Sheets(1).UsedRange.Copy ws1.Cells(ws1.Range("A" & Rows.Count).End(xlUp).Row + 1, 1)
    wbk2.Close
Next i

End Sub
Function GetFileName(fileStr As String)
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    GetFileName = fso.GetFileName(fileStr)
End Function 
```

# android - 编辑带有重音问题的文本

> ID：12884568
> 
> 赞同：1
> 
> 时间：2012-10-14T17:13:54.010
> 
> 标签：android

我正在编写一个 android 应用程序，但我遇到了编辑文本的问题。当用户添加带重音的文本时（sp：“Nous sommes en été”）；字符串不正确。我猜它会将我的重音符号转换为 utf-8。我该如何处理？

ps：我的应用程序是法语应用程序，我真的需要使用口音。

我的代码：

```
String description = ((EditText) findViewById(id.description)).getText().toString();
                Log.i("UTF8",description.toString());
                description = description.replace("\n", "");
                Log.i("UTF8",description.toString()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:59:06.563

应该没有问题。字符串表示在 java / android 中是 UTF-16 [1]。我在android上尝试了以下代码并让它正常工作。重音 é 正确显示。

```
EditText findViewById =(EditText) findViewById(R.id.test_text);
findViewById.setText("École. Nous sommes en été");
Editable text = findViewById.getText();
Log.d(TAG, text.toString()); 
```

您知道 Log.i() 代码中的第一个参数是标签吗？Log.i() 不接受编码类型作为参数。你能张贴那些声明打印的内容吗？

[1] - [http://docs.oracle.com/javase/7/docs/api/java/lang/String.html](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)

# android - ScrollView 滚动到不起作用

> ID：12884572
> 
> 赞同：7
> 
> 时间：2012-10-14T17:14:35.007
> 
> 标签：android, scrollview

与 ScrollView相同的问题[.scrollTo 不起作用？在旋转时保存 ScrollView 位置](https://stackoverflow.com/questions/3263259/scrollview-scrollto-not-working-saving-scrollview-position-on-rotation)

我在 onCreate 中动态地将项目添加到 scrollView。添加所有项目后，我尝试以下操作：

```
 // no effect
    ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);

    // no effect
    ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);
    mainScroll.post(new Runnable() {
        public void run(){
            ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);
            mainScroll.scrollTo(0, 0);
        } 
    });

    // works like a charm
    ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);
    mainScroll.postDelayed(new Runnable() {
        public void run(){
            ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);
            mainScroll.scrollTo(0, 0);
        } 
    }, 30); 
```

我得出结论，有一些事件，如“DOM-ready”？有回调吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-09-21T08:02:00.447

您不需要扩展 ScrollView 并根据[David Daudelin](https://stackoverflow.com/users/1276216/david-daudelin)为[this question](https://stackoverflow.com/questions/9753603/using-smoothscrollby-method-in-android-scrollview-class?rq=1)提供的答案创建自己的。

获取 的`ViewTreeObserver`并将`ScrollView`一个添加`OnGlobalLayoutListener`到`ViewTreeObserver`. 然后`ScrollView.scrollTo(x,y)`从 的`onGlobalLayout()`方法中调用方法`OnGlobalLayoutListener`。代码：

```
 ScrollView mainScroll = (ScrollView) findViewById(R.id.average_scroll_mainScroll);

 ViewTreeObserver vto = scrollView.getViewTreeObserver();
 vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
      public void onGlobalLayout() {
           mainScroll.scrollTo(0, 0);
      }
 }); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-03-09T08:19:30.670

这对我有用，替换`scrollView.scrollTo()`为

```
 scrollView.post(new Runnable() {
        @Override
        public void run() {
            scrollView.scrollTo(0, ScrollViewYPosition);//0 is x position
        }
    }); 
```

Vasily Kabunov 的回答帮助了我

[ScrollView .scrollTo 不工作？在旋转时保存 ScrollView 位置](https://stackoverflow.com/questions/3263259/scrollview-scrollto-not-working-saving-scrollview-position-on-rotation)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T22:06:36.843

当您对 ScrollView 进行一些更改时，它需要一段时间才能将布局更改复制到显示列表并通知 ScrollView 它确实可以滚动到某个位置。

我设法通过`ScrollView`使用我自己的 ScrollView 进行扩展，并添加一个`OnGlobalLayoutListener`根据需要添加（如 MH 建议的）并稍后滚动到那里的方法来使其工作。它比将其应用于您需要的每个案例要自动化一些（但是您需要使用 new `ScrollView`）。无论如何，这是相关的代码：

```
public class ZScrollView extends ScrollView {

    // Properties
    private int desiredScrollX = -1;
    private int desiredScrollY = -1;
    private OnGlobalLayoutListener gol;

    // ================================================================================================================
    // CONSTRUCTOR ----------------------------------------------------------------------------------------------------

    public ZScrollView(Context __context) {
        super(__context);
    }

    public ZScrollView(Context __context, AttributeSet __attrs) {
        super(__context, __attrs);
    }

    public ZScrollView(Context __context, AttributeSet __attrs, int __defStyle) {
        super(__context, __attrs, __defStyle);
    }

    // ================================================================================================================
    // PUBLIC INTERFACE -----------------------------------------------------------------------------------------------

    public void scrollToWithGuarantees(int __x, int __y) {
        // REALLY Scrolls to a position
        // When adding items to a scrollView, you can't immediately scroll to it - it takes a while
        // for the new addition to cycle back and update the scrollView's max scroll... so we have
        // to wait and re-set as necessary

        scrollTo(__x, __y);

        desiredScrollX = -1;
        desiredScrollY = -1;

        if (getScrollX() != __x || getScrollY() != __y) {
            // Didn't scroll properly: will create an event to try scrolling again later

            if (getScrollX() != __x) desiredScrollX = __x;
            if (getScrollY() != __y) desiredScrollY = __y;

            if (gol == null) {
                gol = new OnGlobalLayoutListener() {
                    @Override
                    public void onGlobalLayout() {
                        int nx = desiredScrollX == -1 ? getScrollX() : desiredScrollX;
                        int ny = desiredScrollY == -1 ? getScrollY() : desiredScrollY;
                        desiredScrollX = -1;
                        desiredScrollY = -1;
                        scrollTo(nx, ny);
                    }
                };

                getViewTreeObserver().addOnGlobalLayoutListener(gol);
            }
        }
    }
} 
```

对我来说非常有用，因为我想在添加后立即滚动到 ScrollView 内的给定视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-12T05:42:19.383

> **试试这个它的工作原理：（kotlin）**
> 
> ```
>  myScrollView.post(Runnable {
>                  myScrollView.scrollTo(0, scrollValue)
>              }) 
> ```

# java - 用除括号中的空格以外的所有空格分割字符串

> ID：12884573
> 
> 赞同：10
> 
> 时间：2012-10-14T17:14:47.020
> 
> 标签：java, regex

> **可能重复：**
> [根据正则表达式拆分字符串](https://stackoverflow.com/questions/12756651/split-a-string-based-on-regex)

我从来都不是正则表达式大师，所以我需要你的帮助！我有一个这样的字符串：

```
String s = "a [b c] d [e f g]"; 
```

我想使用空格作为分隔符来分割这个字符串——但我不想分割出现在`[]`括号内的空格。所以，从上面的例子中，我想要这个数组：

```
{"a", "[b c]", "d", "[e f g]"} 
```

关于可以结合使用什么正则表达式`split`来实现这一目标的任何建议？

* * *

这是另一个例子：

```
"[a b] c [[d e] f g]" 
```

变成

```
{"[a b]", "c", "[[d e] f g]"} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-14T17:22:26.457

我认为这应该可行，使用[负前瞻](http://www.regular-expressions.info/lookaround.html)- 它不匹配没有左括号的右括号之前的空格：

```
"a [b c] d [e f g]".split("\\s+(?![^\\[]*\\])"); 
```

对于嵌套括号，您将需要编写解析器，正则表达式无法承受无限级别，并且对于超过一两个级别来说过于复杂。例如，我的表达失败了

```
"[a b [c d] e] f g" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-14T17:35:26.613

您不能使用单个正则表达式来做到这一点，仅仅是因为它无法匹配打开/关闭大括号并处理嵌套大括号。

正则表达式不是图灵完备的，所以即使它*看起来*可以工作，也会有失败的情况。

所以我宁愿建议编写你自己的几行代码，这肯定会处理所有情况。

[您可以为JavaCC](http://javacc.java.net/)或[AntLR](http://www.antlr.org/)创建非常简单的语法，或者使用简单的基于堆栈的解析器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-14T17:39:10.737

正如在其他答案中所说，您需要一个解析器。这是一个与以前的正则表达式解决方案一起失败的字符串。

```
"[a b] c [a [d e] f g]" 
```

编辑：

```
public static List<String> split(String s){
    List<String> l = new LinkedList<String>();
    int depth=0;
    StringBuilder sb = new StringBuilder();
    for(int i=0; i<s.length(); i++){
        char c = s.charAt(i);
        if(c=='['){
            depth++;
        }else if(c==']'){
            depth--;
        }else if(c==' ' && depth==0){
            l.add(sb.toString());
            sb = new StringBuilder();
            continue;
        }
        sb.append(c);
    }
    l.add(sb.toString());

    return l;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T17:21:46.660

如果我正确理解了您的问题，那么答案可能是遵循规则 4。

```
rule1 -> ((a-z).(\w))*.(a-z)

rule2 -> ([).rule1.(])

rule3 -> ([).(rule1.(\w))*.rule2.((\w).rule1)*.(])

rule4 -> rule1 | rule3 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-14T17:27:47.297

**对于非嵌套**

```
\\s+(?![^\\[]*\\]) 
```

**FOR嵌套**（[]内[]）

```
(?<!\\[[^\\]]*)\\s+(?![^\\[]*\\]) 
```

# c# - 无法从类中调用方法

> ID：12884574
> 
> 赞同：0
> 
> 时间：2012-10-14T17:14:58.037
> 
> 标签：c#, class, methods

有人可以帮我吗？：我正在尝试从我的班级“数字”中调用一个方法，以显示如果输入的数字超过 50，则在按钮上单击一个消息框会显示“高”，但如果它低于 50 它显示“低”。我无法弄清楚我在这里做错了什么。这是我班上的代码：

```
 private int number; 
    private string getNumber(int num)
    {

        number = num;
        return number.ToString();
    }

        public int numProperty
    {
        get { return number; }
        set { number = value; }
    }

     public void isHighorlow()
        {    
            if (number >=50)
            {

            }
            else
            {
                return;
            }

        } 
```

注意： int "number" 也是从文本框中获取其值的属性。&这里是我的表格中的代码：

```
 numbers info = new numbers();
     private void Btn_Click(object sender, EventArgs e)
    { 
      info.numProperty = Convert.ToInt32(numberBOX.Text);
      info.isHighorlow = Messagebox.Show = ("High");
    } 
```

我知道我还没有添加“低”位，因为我仍在尝试看看它是如何工作的。对不起，如果我还在学习 c# 看起来很混乱。我收到错误消息：无法分配 isHighorlow，因为它是方法组的一部分。而且我也意识到，如果我只是在文本框上做一个 if 语句会容易得多，但我正在练习类和方法，所以我正在尝试这样做。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:19:47.087

我猜你想要这样的东西：

```
public string isHighorlow(int number)
{    
    if (number >=50)
    { 
         return "High";
    }
    else
    {
         return "Low";
    }
}

numbers info = new numbers();
private void Btn_Click(object sender, EventArgs e)
{ 
  Messagebox.Show(info.isHighorlow(Convert.ToInt32(numberBOX.Text)))
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:19:51.607

isHighorLow 是一种方法，而不是属性。

MessageBox.Show 是一种方法。

不确定您要做什么，但应该是：

```
 if(info.isHigh(Convert.ToInt32(numberBox.Text)))
   Messagebox.Show("High");
  else
    Messagebox.Show("Low"); 
```

这意味着你有一个方法 isHigh 像这样：

```
public bool isHigh()
{
   return number>=50
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-14T17:20:59.153

尝试以这种方式更改您的代码：

```
private int _number; 

private string GetNumber(int number)
{
    _number = number;
    return number .ToString();
}

public int Number
{
    get { return _number; }
    set { _number = value; }
}

public string IsHigh()
{   
    get { if (number >= 50) return true; }
}

numbers info = new numbers();
private void Btn_Click(object sender, EventArgs e)
{ 
    info.Number = Convert.ToInt32(numberBOX.Text);
    MessageBox.Show(info.IsHigh ? "High" : "Low");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-14T17:21:02.870

在您的班级中，您已经定义了`void isHighorlow()`.
这意味着您有一个不返回任何内容的方法。
当然，这种方法不能像您所做的那样用于表达式的左侧。

可能你想在课堂上写作

```
public bool isHighorlow() 
{     
    if (number >=50) 
    { 
        return true;
    } 
    else 
    { 
        return false; 
    } 
```

}

通过这种方式，您声明一个方法，如果内部值 >= 50 则返回 True，否则返回 false。
现在，在您的表单中，您可以以这种方式使用该方法

```
Messagebox.Show(info.isHighorlow() ? "High" : "Low"); 
```

但是，如果要求只是返回一个标志为真或假，最好使用只读属性以这种方式更改类代码

```
public bool isHighorlow() 
{     
    get
    {
        return (number >=50 ? true : false);
    } 
    // No set, read only
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-14T17:21:57.703

IsHighOrLow 应该如下

```
 public bool isHighorlow()
    {    
        if (number >=50)
        {

           return true;
        }
        else
        {
            return false;
        }

    } 
```

并在按钮单击

```
if (info.isHighorlow){
//say high
} else
{
// say low
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-14T17:24:15.690

（免责声明：仔细检查`boolean`每个 C# 的相关常量）

isHighOrLow 根本不做任何事情。也许这样会更好：

```
 public boolean isHigh()
        {    
            if (number >=50)
            {
                return true;
            }
            else
            {
                return false;
            }

        } 
```

或者，更简洁地说：

```
 public boolean isHigh()
        {    
            return number >=50;
        } 
```

当您调用它时，这可能更接近您的需要：

```
 numbers info = new numbers();
     private void Btn_Click(object sender, EventArgs e)
    { 
      info.numProperty = Convert.ToInt32(numberBOX.Text);
      if (info.isHigh())
      {
        Messagebox.Show("High");
      }
      else
      {
        Messagebox.Show("Low");
      }
    } 
```

# ruby - 调试基本的 ruby 递归

> ID：12884581
> 
> 赞同：1
> 
> 时间：2012-10-14T17:15:59.813
> 
> 标签：ruby, debugging, recursion

这段代码旨在获取一个整数硬币值数组、要进行的更改数量和一个用于收集答案的空数组，并且应该返回一组硬币，这些硬币可以产生正确的更改数量（假设问题是可能的）。

从 puts 语句看来，递归似乎表现良好并寻求正确答案，但返回的解决方案不是有效答案。有人可以让我知道我做错了什么吗？

我的代码：

```
 def brute_solver(coins,amount,answer)
        puts "Coins: #{coins}, Amount: #{amount}, Answer: #{answer}"
        return answer.sort! if amount == 0
        coins.each do |c|
            brute_solver(coins, amount - c, answer.dup << c) unless amount - c < 0
        end 
    end 
```

运行 brute_solver 的示例尝试：

```
 1.9.3p194 :001 > require './change_challenge.rb'
     => true 
    1.9.3p194 :002 > brute_solver([1,3,5],7,[])
    Coins: [1, 3, 5], Amount: 7, Answer: []
    Coins: [1, 3, 5], Amount: 6, Answer: [1]
    Coins: [1, 3, 5], Amount: 5, Answer: [1, 1]
    Coins: [1, 3, 5], Amount: 4, Answer: [1, 1, 1]
    Coins: [1, 3, 5], Amount: 3, Answer: [1, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 2, Answer: [1, 1, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 1, Answer: [1, 1, 1, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 1, 1, 1, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 1, 1, 1, 3]
    Coins: [1, 3, 5], Amount: 1, Answer: [1, 1, 1, 3]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 1, 1, 3, 1]
    Coins: [1, 3, 5], Amount: 2, Answer: [1, 1, 3]
    Coins: [1, 3, 5], Amount: 1, Answer: [1, 1, 3, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 1, 3, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 1, 5]
    Coins: [1, 3, 5], Amount: 3, Answer: [1, 3]
    Coins: [1, 3, 5], Amount: 2, Answer: [1, 3, 1]
    Coins: [1, 3, 5], Amount: 1, Answer: [1, 3, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 3, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 3, 3]
    Coins: [1, 3, 5], Amount: 1, Answer: [1, 5]
    Coins: [1, 3, 5], Amount: 0, Answer: [1, 5, 1]
    Coins: [1, 3, 5], Amount: 4, Answer: [3]
    Coins: [1, 3, 5], Amount: 3, Answer: [3, 1]
    Coins: [1, 3, 5], Amount: 2, Answer: [3, 1, 1]
    Coins: [1, 3, 5], Amount: 1, Answer: [3, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [3, 1, 1, 1, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [3, 1, 3]
    Coins: [1, 3, 5], Amount: 1, Answer: [3, 3]
    Coins: [1, 3, 5], Amount: 0, Answer: [3, 3, 1]
    Coins: [1, 3, 5], Amount: 2, Answer: [5]
    Coins: [1, 3, 5], Amount: 1, Answer: [5, 1]
    Coins: [1, 3, 5], Amount: 0, Answer: [5, 1, 1]
     => [1, 3, 5] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:26:39.997

```
def brute_solver(coins,amount,answer)

        puts "Coins: #{coins}, Amount: #{amount}, Answer: #{answer}"

        return answer.sort! if amount == 0

        coins.each do |c|
            if amount - c < 0
                break
            end
            result = brute_solver(coins, amount - c, answer.dup << c)
            if result != -1
                return result
            end
        end 
        return -1

end

puts brute_solver([5, 7],26,[]) 
```

这样，如果函数找到正确的解决方案，则返回一个数组，否则返回-1。当您进行递归调用时，您还会返回递归找到的解决方案（如果返回值不是 -1，则意味着它找到了解决方案）

Your code does not work because the return value for a function in ruby is the last statement executed, and your functions keeps executing commands even after it had found a valid combination of coins. Basically, your function returns the last combination of coins that it had checked to see if they are a solution.

# asp.net-mvc - 如何使用 MapHttpRoute 捕获所有 URL

> ID：12884584
> 
> 赞同：4
> 
> 时间：2012-10-14T17:17:02.913
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

除了所有定义的 api 路由之外，我还想在 LegacyUriRedirect 操作中处理任何其他 url。

我试图将 routeTemplate 留空，但它只捕获根 url 并忽略任何带有段的 url。

如何更改下面的代码，以便它捕获所有带有任何段的 url？

```
 config.Routes.MapHttpRoute(
                name: "LegacyUriRedirect",
                routeTemplate: "",
                defaults: new { controller = "URI", action = "LegacyUriRedirect" }
    ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T17:36:03.187

```
config.Routes.MapHttpRoute(
        name: "LegacyUriRedirect",
        routeTemplate: "{*catchall}",
        defaults: new { controller = "URI", action = "LegacyUriRedirect" }
    ); 
```

# css - 菜单看起来不像预期的那样

> ID：12884587
> 
> 赞同：1
> 
> 时间：2012-10-14T17:17:22.213
> 
> 标签：css

我有这个网站：[http](http://test.tamarawobben.nl) ://test.tamarawobben.nl 现在顶部的菜单看起来不太好。我必须看起来像这张图片：[http](http://test.tamarawobben.nl/screenshot.png) ://test.tamarawobben.nl/screenshot.png 。

谁能帮我弄清楚这里出了什么问题？

罗洛夫

编辑1：有没有办法让所有的子菜单都变大。现在宽度取决于文本。我知道我可以使用宽度，但我想我会破坏布局，因为它从不使用宽度。而且我不是反对者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:35:06.313

将此 CSS 用于 ul #nav；

```
#nav{
position:absolute;
top:0;
left:0;} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-14T17:20:03.227

### 给这个CSS：

```
#header ul li {
    padding: 0 1em;
    font-size: 10px;
} 
```

### 截屏：

![在此处输入图像描述](../Images/37775328897a0b0c9ef61bd751b2d009.png)

# android - 反转 SeekBar 值并使用对数/指数刻度

> ID：12884592
> 
> 赞同：2
> 
> 时间：2012-10-14T17:17:45.367
> 
> 标签：android, math, seekbar

我想要一个`SeekBar`满足以下要求的：

```
min = -655
half = -140
max = 0 
```

按照下一个[解释](http://van-uffelen.com/blog/?p=291)，我设法拥有

```
min = 0
half = 140
max = 655 
```

我到了一半，但我不知道如何将数字倒置..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T05:01:58.153

取您想出的表达式，并通过将 x 替换为 1-x 将其水平反映在 x=.5 周围。然后通过否定整个事物在 y=0 周围垂直反射它。

也就是说，你有 f(x)，但你想要 g(x)，其中 g(x) = -f(1-x)。

# tomcat - 为什么重新部署 Web 应用程序时内存使用量会增加？

> ID：12884597
> 
> 赞同：0
> 
> 时间：2012-10-14T17:18:11.433
> 
> 标签：tomcat

当我重新部署 Web 应用程序时，Tomcat 中的内存使用量是否会增加？我正在阅读它是因为类加载器及其创建的对象无法回收，它们存储在 JVM 的永久堆生成空间中。这是什么意思 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:20:29.920

你可以在这里找到类加载器泄漏的解释：

[http://code.google.com/p/arit/wiki/GettingStarted](http://code.google.com/p/arit/wiki/GettingStarted)

# haskell - Haskell：在没有实例的模块中使用类型类的函数

> ID：12884598
> 
> 赞同：1
> 
> 时间：2012-10-14T17:18:27.470
> 
> 标签：haskell, typeclass

我有一个定义和导出类型和类型类的模块，如下所示。问题是我似乎无法在此模块中使用该类的功能，因为还没有该类的实例。

这是 GHC 错误：“'aabb' 的类型签名缺少随附的绑定”

有没有办法解决这个问题？谢谢。

```
module AABB (
 AABB
,Boundable(..)
,aabb
,consume
) where

type AABB = (Vec3,Vec3)

class Boundable a where
aabb ∷  a → AABB

consume ∷  (Boundable a) ⇒ AABB → a → AABB
consume (v0,v1) x = (minV v0 v2, maxV v1 v3)
   where (v2,v3) = aabb x

maxV ∷  Vec3 → Vec3 → Vec3
maxV (Vec3 x0 y0 z0) (Vec3 x1 y1 z1) = Vec3 (max x0 x1) (max y0 y1) (max z0 z1)

minV ∷  Vec3 → Vec3 → Vec3
minV (Vec3 x0 y0 z0) (Vec3 x1 y1 z1) = Vec3 (min x0 x1) (min y0 y1) (min z0 z1) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-14T17:22:31.043

您需要缩进`aabb`.

```
class Boundable a where
    aabb ∷  a → AABB 
```

或者使用大括号：

```
class Boundable a where {
aabb ∷  a → AABB
} 
```

# c# - 如何在 C# 中更快地计算简单移动平均线？

> ID：12884600
> 
> 赞同：22
> 
> 时间：2012-10-14T17:18:51.070
> 
> 标签：c#, algorithm, financial, moving-average

计算简单移动平均线的最快库/算法是什么？我自己写了，但是在 330 000 个十进制数据集上花费的时间太长了。

*   周期/时间（毫秒）
*   20 / 300;
*   60 / 1500;
*   120 / 3500。

这是我的方法的代码：

```
public decimal MA_Simple(int period, int ii) {
    if (period != 0 && ii > period) {
        //stp.Start();
        decimal summ = 0;
        for (int i = ii; i > ii - period; i--) {
            summ = summ + Data.Close[i];
        }
        summ = summ / period;
        //stp.Stop();
        //if (ii == 1500) System.Windows.Forms.MessageBox.Show((stp.ElapsedTicks * 1000.0) / Stopwatch.Frequency + " ms");
        return summ;
    } else return -1;
} 
```

这`Data.Close[]`是一个固定大小（1 000 000）的十进制数组。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2017-06-01T22:55:04.907

```
 public class MovingAverage  
    {
        private Queue<Decimal> samples = new Queue<Decimal>();
        private int windowSize = 16;
        private Decimal sampleAccumulator;
        public Decimal Average { get; private set; }

        /// <summary>
        /// Computes a new windowed average each time a new sample arrives
        /// </summary>
        /// <param name="newSample"></param>
        public void ComputeAverage(Decimal newSample)
        {
            sampleAccumulator += newSample;
            samples.Enqueue(newSample);

            if (samples.Count > windowSize)
            {
                sampleAccumulator -= samples.Dequeue();
            }

            Average = sampleAccumulator / samples.Count;
        }
    } 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-10-14T21:44:00.373

您的主要问题是每次迭代都丢弃了太多信息。如果你想跑得这么快，你需要保持一个与帧长度相同大小的缓冲区。

此代码将为您的整个数据集运行移动平均线：

（不是真正的 C#，但你应该明白）

```
decimal buffer[] = new decimal[period];
decimal output[] = new decimal[data.Length];
current_index = 0;
for (int i=0; i<data.Length; i++)
    {
        buffer[current_index] = data[i]/period;
        decimal ma = 0.0;
        for (int j=0;j<period;j++)
            {
                ma += buffer[j];
            }
        output[i] = ma;
        current_index = (current_index + 1) % period;
    }
return output; 
```

请注意，保持运行的 cumsum 可能很诱人，而不是保留整个缓冲区并计算每次迭代的值，但这不适用于非常长的数据长度，因为您的累积和会增长得如此之大，以至于添加小的附加值会导致舍入错误。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-02-02T19:14:18.727

这些天来，[Math DotNet](https://numerics.mathdotnet.com/)库有一个名为的类[`RunningStatistics`](https://numerics.mathdotnet.com/api/MathNet.Numerics.Statistics/RunningStatistics.htm)，可以为您完成这项工作。如果您只想对最后的“X”项执行此操作，请[`MovingStatistics`](https://numerics.mathdotnet.com/api/MathNet.Numerics.Statistics/MovingStatistics.htm)改用。

两者都将计算运行平均值、方差和标准偏差，仅一次通过，无需存储额外的数据副本。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-14T17:37:10.907

如果数据是静态的，您可以对数组进行预处理以使移动平均查询非常快：

```
decimal[] GetCSum(decimal[] data) {
    decimal csum[] = new decimal[data.Length];
    decimal cursum = 0;
    for(int i=0; i<data.Length; i++) {
        cursum += data[i];
        csum[i] = cursum;
    }
    return csum;
} 
```

现在移动平均线的计算既简单又快速：

```
decimal CSumMovingAverage(decimal[] csum, int period, int ii) {
    if(period == 0 || ii <= period)
        return -1;
    return csum[ii] - csum[ii - period];
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-19T21:13:48.240

当前（已接受）解决方案包含一个内部循环。删除它也会更有效。你可以在这里看到这是如何实现的：

[如何有效地计算移动标准差](https://stackoverflow.com/questions/14635735/how-to-efficiently-calculate-a-moving-standard-deviation)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-06-16T21:10:47.730

您不需要保留正在运行的队列。只需选择窗口的最新条目并丢弃旧条目。请注意，这仅使用一个循环，除了总和之外没有额外的存储空间。

```
 // n is the window for your Simple Moving Average
  public List<double> GetMovingAverages(List<Price> prices, int n)
  {
    var movingAverages = new double[prices.Count];
    var runningTotal = 0.0d;       

    for (int i = 0; i < prices.Count; ++i)
    {
      runningTotal += prices[i].Value;
      if( i - n >= 0) {
        var lost = prices[i - n].Value;
        runningTotal -= lost;
        movingAverages[i] = runningTotal / n;
      }
    }
    return movingAverages.ToList();
  } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-07-31T19:42:26.717

我发现提供的答案有点记忆饥饿，而且速度慢，你要求快。添加 2 个字段，一个用于保持运行总计，另一个用于将值更改为平均值的时间是值列表的总和/计数。我添加了一个 Add 方法，但是您也可以只在方法中使用变量……。

```
public class Sample
{
    private decimal sum = 0;
    private uint count = 0;

    public void Add(decimal value)
    {
        sum += value;
        count++;
    }

    public decimal AverageMove => count > 0 ? sum / count : 0;
} 
```

使其线程安全：

```
public class ThreadSafeSample
{
private decimal sum = 0;
private uint count = 0;

private static object locker = new object();
public void Add(decimal value)
{
    lock (locker)
    {
        sum += value;
        count++;
    }
}

public decimal AverageMove => count > 0 ? sum / count : 0; 
```

}

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-21T09:12:57.763

```
// simple moving average
int moving_average(double *values, double *&averages, int size, int periods)
{
    double sum = 0;
    for (int i = 0; i < size; i ++)
        if (i < periods) {
            sum += values[i];
            averages[i] = (i == periods - 1) ? sum / (double)periods : 0;
        } else {
            sum = sum - values[i - periods] + values[i];
            averages[i] = sum / (double)periods;
        }
    return (size - periods + 1 > 0) ? size - periods + 1 : 0;
} 
```

一个 C 函数，13 行代码，简单的移动平均线。使用示例：

```
double *values = new double[10]; // the input
double *averages = new double[10]; // the output
values[0] = 55;
values[1] = 113;
values[2] = 92.6;
...
values[9] = 23;
moving_average(values, averages, 10, 5); // 5-day moving average 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-06-26T21:36:53.897

这是我在我的应用程序中使用的 MA。

```
double[] MovingAverage(int period, double[] source)
{
    var ma = new double[source.Length];

    double sum = 0;
    for (int bar = 0; bar < period; bar++)
        sum += source[bar];

    ma[period - 1] = sum/period;

    for (int bar = period; bar < source.Length; bar++)
        ma[bar] = ma[bar - 1] + source[bar]/period
                              - source[bar - period]/period;

    return ma;
} 
```

一旦你为整个数据系列计算了它，你就可以立即获取一个特定的值。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-19T21:06:26.293

这是我尝试过的方法。但是警告我是一个完全的业余爱好者，所以这可能是完全错误的。

```
List<decimal> MovingAverage(int period, decimal[] Data)
{
     decimal[] interval = new decimal[period];
     List<decimal> MAs = new List<decimal>();

     for (int i=0, i < Data.length, i++)
     {
          interval[i % period] = Data[i];
          if (i > period - 1)
          {
               MAs.Add(interval.Average());
          }
     }
     return MAs;
} 
```

应返回包含数据移动平均值的小数列表。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-01-18T14:36:32.210

```
/// <summary>
/// Fast low CPU usage moving average based on floating point math
/// Note: This algorithm algorithm compensates for floating point error by re-summing the buffer for every 1000 values
/// </summary>
public class FastMovingAverageDouble
{
    /// <summary>
    /// Adjust this as you see fit to suit the scenario
    /// </summary>
    const int MaximumWindowSize = 100;

    /// <summary>
    /// Adjust this as you see fit
    /// </summary>
    const int RecalculateEveryXValues = 1000;

    /// <summary>
    /// Initializes moving average for specified window size
    /// </summary>
    /// <param name="_WindowSize">Size of moving average window between 2 and MaximumWindowSize 
    /// Note: this value should not be too large and also bear in mind the possibility of overflow and floating point error as this class internally keeps a sum of the values within the window</param>
    public FastMovingAverageDouble(int _WindowSize)
    {
        if (_WindowSize < 2)
        {
            _WindowSize = 2;
        }
        else if (_WindowSize > MaximumWindowSize)
        {
            _WindowSize = MaximumWindowSize;
        }
        m_WindowSize = _WindowSize;
    }
    private object SyncRoot = new object();
    private Queue<double> Buffer = new Queue<double>();
    private int m_WindowSize;
    private double m_MovingAverage = 0d;
    private double MovingSum = 0d;
    private bool BufferFull;
    private int Counter = 0;

    /// <summary>
    /// Calculated moving average
    /// </summary>
    public double MovingAverage
    {
        get
        {
            lock (SyncRoot)
            {
                return m_MovingAverage;
            }
        }
    }

    /// <summary>
    /// Size of moving average window set by constructor during intialization
    /// </summary>
    public int WindowSize
    {
        get
        {
            return m_WindowSize;
        }
    }

    /// <summary>
    /// Add new value to sequence and recalculate moving average seee <see cref="MovingAverage"/>
    /// </summary>
    /// <param name="NewValue">New value to be added</param>
    public void AddValue(int NewValue)
    {
        lock (SyncRoot)
        {
            Buffer.Enqueue(NewValue);
            MovingSum += NewValue;
            if (!BufferFull)
            {
                int BufferSize = Buffer.Count;
                BufferFull = BufferSize == WindowSize;
                m_MovingAverage = MovingSum / BufferSize;
            }
            else
            {
                Counter += 1;
                if (Counter > RecalculateEveryXValues)
                {
                    MovingSum = 0;
                    foreach (double BufferValue in Buffer)
                    {
                        MovingSum += BufferValue;
                    }
                    Counter = 0;
                }
                MovingSum -= Buffer.Dequeue();
                m_MovingAverage = MovingSum / WindowSize;
            }
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-12-12T20:31:21.577

怎么样`Queue`？

```
using System.Collections.Generic;
using System.Linq;

public class MovingAverage
{
    private readonly Queue<decimal> _queue;
    private readonly int _period;

    public MovingAverage(int period)
    {
        _period = period;
        _queue = new Queue<decimal>(period);
    }

    public decimal Compute(decimal x)
    {
        if (_queue.Count >= _period)
        {
            _queue.Dequeue();
        }

        _queue.Enqueue(x);

        return _queue.Average();
    }
} 
```

用法：

```
MovingAverage ma = new MovingAverage(3);

foreach(var val in new decimal[] { 1,2,3,4,5,6,7,8,9 })
{
   Console.WriteLine(ma.Compute(val));
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-25T14:43:52.880

使用 Dotnet Core 3 和 Linq 测试：

```
int period = 20;
for(int k=0;data.Count()-period;k++){
   decimal summe = data.Skip(k).Take(period).Sum();
   summe /= (decimal)period;
} 
```

*它确实依赖于 Linq 及其内部优化*，没有计时。
使用 Skip() 和 Take() 作为[移动平均](https://en.wikipedia.org/wiki/Moving_average)的“rangeBetween”解决方案，然后将总和除以周期数量。
* **for 循环**设置上限以避免不完整的求和操作。
参考（C# Microsoft）：[Skip()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.skip?view=netcore-2.2)， [Take()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.take?view=netcore-2.2)，[Sum()](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.sum?view=netcore-2.2)；

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-06T17:42:59.950

我的`MovingAverage`课程实现是：

*   线程安全
*   无锁
*   仅限于`windowSize`那是二的力量

这是课程：

```
using System;
using System.Linq;
using System.Threading;

public class MovingAverage
{
    private readonly int _mask;
    private readonly double?[] _values;
    private int _nextIndex = -1;

    public MovingAverage(int windowSize)
    {
        _mask = windowSize - 1;
        if (windowSize == 0 || (windowSize & _mask) != 0)
        {
            throw new ArgumentException("Must be power of two", nameof(windowSize));
        }
        _values = new double?[windowSize];
    }

    public void Add(double newValue)
    {
        var index = Interlocked.Increment(ref _nextIndex) & _mask;
        _values[index] = newValue;
    }

    public double ComputeAverage()
    {
        return _values.TakeWhile(x => x.HasValue)
            .Select(x => x ?? 0)
            .DefaultIfEmpty(0)
            .Average();
    }
} 
```

这是 NUnit 测试

```
using NUnit.Framework;

public class MovingAverageTest
{
    [Test]
    public void Should_compute_average()
    {
        var sut = new MovingAverage(4);

        Assert.That(sut.ComputeAverage(), Is.EqualTo(0));
        sut.Add(2);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(2));
        sut.Add(4);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(3));
        sut.Add(0);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(2));
        sut.Add(6);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(3));
        sut.Add(6);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(4));
        sut.Add(0);
        sut.Add(0);
        sut.Add(0);
        sut.Add(0);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(0));
        sut.Add(10);
        sut.Add(10);
        sut.Add(10);
        sut.Add(10);
        Assert.That(sut.ComputeAverage(), Is.EqualTo(10));
    }

    [Test]
    public void Should_check_windowsize_param()
    {
        Assert.That(() => new MovingAverage(3), Throws.ArgumentException);
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-05-04T17:42:27.597

在实践中，这就是我发现即使对数百万个样本也有效的方法。它计算运行移动平均线，比我尝试过的任何其他方法都快。

```
public class Sma
  {
    decimal mult = 0;
    private decimal[] samples;
    private readonly int max;

    private decimal average;
    public Sma(int period)
    {
        mult = 1m / period; //cache to avoid expensive division on each step.
        samples = new decimal[period];
        max = period - 1;
    }
    public decimal ComputeAverage(decimal value)
    {
        average -= samples[max];
        var sample = value * mult;
        average += sample;
        Array.Copy(samples, 0, samples, 1, max);
        samples[0] = sample;
        return average = average - samples[0];
    }
} 
```

我发现我经常需要访问历史。我通过跟踪平均值来实现这一点：

```
public class Sma
{
    private readonly int max;
    private decimal[] history;
    public readonly int Period;
    public int Counter = -1;
    public SimpleSma RunningSma { get; }

    public Sma(int period, int maxSamples)
    {
        this.Period = period;
        this.RunningSma = new SimpleSma(period);
        max = maxSamples - 1;
        history = new decimal[maxSamples];
    }

    public decimal ComputeAverage(decimal value)
    {
        Counter++;
        Array.Copy(history, 0, history, 1, max);
        return history[0] = RunningSma.ComputeAverage(value);
    }

    public decimal Average => history[0];
    public decimal this[int index] => history[index];
    public int Length => history.Length;

} 
```

现在在实践中，您的用例听起来像我的，您需要跟踪多个时间范围：

```
public class MtfSma // MultiTimeFrame Sma
{
    public Dictionary<int, Sma> Smas { get; private set; }
    public MtfSma(int[] periods, int maxHistorySize = 100)
    {
        Smas = periods.ToDictionary(x=> x, x=> new Sma(x, maxHistorySize));
    }
}

A dictionary is no necessary, but is helpful to map an Sma to its period. 
```

这可以按如下方式使用：

```
IEnumerable<decimal> dataPoints = new List<Decimal>(); //330 000 data points.
foreach (var dataPoint in dataPoints)
{
    foreach (var kvp in Smas)
    {
        var sma = kvp.Value;
        var period = sma.Period;
        var average = sma.Average; // or sma[0];
        var lastAverage = sma[1];
        Console.WriteLine($"Sma{period} [{sma.Counter}]: Current {average.ToString("n2")}, Previous {lastAverage.ToString("n2")}");
    }
} 
```

另一点是您可以看到这是对十进制的强类型，这意味着对其他数据类型的完全重写。

为了处理这个问题，可以将类设为通用并使用接口来提供类型转换和所需的算术运算提供程序。

我有一个我使用的实际代码的完整工作示例，同样适用于数百万个数据点，以及在[Github](https://github.com/alexhiggins732/coinbasepro-csharp/blob/localdev/Utils/Statistics/Sma.cs)上的 CrossOver 检测等的实现。与此问答相关的代码：

```
public interface INumericOperationsProvider<TNumeric>
    where TNumeric : IConvertible
{
    TNumeric Divide(TNumeric dividend, TNumeric divisor);
    TNumeric Multiply(TNumeric multiplicand, TNumeric multiplier);
    TNumeric Add(TNumeric operandA, TNumeric operandB);
    TNumeric Subtract(TNumeric operandA, TNumeric operandB);

    bool IsLessThan(TNumeric operandA, TNumeric operandB);
    bool IsLessThanOrEqual(TNumeric operandA, TNumeric operandB);
    bool IsEqual(TNumeric operandA, TNumeric operandB);
    bool IsGreaterThanOrEqual(TNumeric operandA, TNumeric operandB);
    bool IsGreaterThan(TNumeric operandA, TNumeric operandB);

    TNumeric ToNumeric(sbyte value);
    TNumeric ToNumeric(short value);
    TNumeric ToNumeric(int value);
    TNumeric ToNumeric(long value);
    TNumeric ToNumeric(byte value);
    TNumeric ToNumeric(ushort value);
    TNumeric ToNumeric(uint value);
    TNumeric ToNumeric(ulong value);
    TNumeric ToNumeric(float value);
    TNumeric ToNumeric(double value);
    TNumeric ToNumeric(decimal value);
    TNumeric ToNumeric(IConvertible value);
}

public abstract class OperationsProviderBase<TNumeric>
    : INumericOperationsProvider<TNumeric>
    where TNumeric : IConvertible
{

    private static Type Type = typeof(TNumeric);
    public abstract TNumeric Divide(TNumeric dividend, TNumeric divisor);
    public abstract TNumeric Multiply(TNumeric multiplicand, TNumeric multiplier);
    public abstract TNumeric Add(TNumeric operandA, TNumeric operandB);
    public abstract TNumeric Subtract(TNumeric operandA, TNumeric operandB);

    public TNumeric ToNumeric(sbyte value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(short value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(int value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(long value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(byte value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(ushort value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(uint value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(ulong value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(float value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(double value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(decimal value) => (TNumeric)Convert.ChangeType(value, Type);
    public TNumeric ToNumeric(IConvertible value) => (TNumeric)Convert.ChangeType(value, Type);

    public bool IsLessThan(TNumeric operandA, TNumeric operandB)
        => ((IComparable<TNumeric>)operandA).CompareTo(operandB) < 0;

    public bool IsLessThanOrEqual(TNumeric operandA, TNumeric operandB)
        => ((IComparable<TNumeric>)operandA).CompareTo(operandB) <= 0;

    public bool IsEqual(TNumeric operandA, TNumeric operandB)
        => ((IComparable<TNumeric>)operandA).CompareTo(operandB) == 0;

    public bool IsGreaterThanOrEqual(TNumeric operandA, TNumeric operandB)
        => ((IComparable<TNumeric>)operandA).CompareTo(operandB) >= 0;

    public bool IsGreaterThan(TNumeric operandA, TNumeric operandB)
        => ((IComparable<TNumeric>)operandA).CompareTo(operandB) > 0;
}

public class OperationsProviderFactory
{
    public static OperationsProviderBase<TNumeric> GetProvider<TNumeric>()
        where TNumeric : IConvertible
    {
        var name = typeof(TNumeric).Name;
        switch (name)
        {
            case nameof(Decimal):
                return new DecimalOperationsProvider() as OperationsProviderBase<TNumeric>;
            case nameof(Single):
                return new FloatOperationsProvider() as OperationsProviderBase<TNumeric>;
            case nameof(Double):
                return new DoubleOperationsProvider() as OperationsProviderBase<TNumeric>;
            default:
                throw new NotImplementedException();
        }
    }
}
public class DecimalOperationsProvider : OperationsProviderBase<decimal>
{
    public override decimal Add(decimal a, decimal b)
        => a + b;

    public override decimal Divide(decimal dividend, decimal divisor)
        => dividend / divisor;

    public override decimal Multiply(decimal multiplicand, decimal multiplier)
        => multiplicand * multiplier;

    public override decimal Subtract(decimal a, decimal b)
       => a - b;
}

public class FloatOperationsProvider : OperationsProviderBase<float>
{
    public override float Add(float a, float b)
        => a + b;

    public override float Divide(float dividend, float divisor)
        => dividend / divisor;

    public override float Multiply(float multiplicand, float multiplier)
        => multiplicand * multiplier;

    public override float Subtract(float a, float b)
       => a - b;
}

public class DoubleOperationsProvider : OperationsProviderBase<double>
{
    public override double Add(double a, double b)
        => a + b;

    public override double Divide(double dividend, double divisor)
        => dividend / divisor;

    public override double Multiply(double multiplicand, double multiplier)
        => multiplicand * multiplier;

    public override double Subtract(double a, double b)
       => a - b;
}

public interface ISma<TNumeric>
{
    int Count { get; }
    void AddSample(TNumeric sample);
    void AddSample(IConvertible sample);
    TNumeric Average { get; }
    TNumeric[] History { get; }
}

public class SmaBase<T> : ISma<T>
    where T : IConvertible
{
    public int Count { get; private set; }
    private int maxLen;
    public T[] History { get; private set; }
    public T Average { get; private set; } = default(T);
    public INumericOperationsProvider<T> OperationsProvider { get; private set; }
    public T SampleRatio { get; private set; }
    public SmaBase(int count, INumericOperationsProvider<T> operationsProvider = null)
    {
        if (operationsProvider == null)
            operationsProvider = OperationsProviderFactory.GetProvider<T>();
        this.Count = count;
        this.maxLen = Count - 1;
        History = new T[count];
        this.OperationsProvider = operationsProvider;
        SampleRatio = OperationsProvider.Divide(OperationsProvider.ToNumeric(1), OperationsProvider.ToNumeric(count));
    }

    public void AddSample(T sample)
    {
        T sampleValue = OperationsProvider.Multiply(SampleRatio, sample);

        if (maxLen==0)
        {
            History[0] = sample;
            Average = sample;
        }
        else
        {
            var remValue = OperationsProvider.Multiply(SampleRatio, History[0]);
            Average = OperationsProvider.Subtract(Average, remValue);
            Average = OperationsProvider.Add(Average, sampleValue);
            Array.Copy(History, 1, History, 0, Count - 1);
            History[maxLen]= sample;
        }
    }

    public void AddSample(IConvertible sample)
        => AddSample(OperationsProvider.ToNumeric(sample));

}
public class SmaOfDecimal : SmaBase<decimal>
{

    public SmaOfDecimal(int count) : base(count)
    {

    }
}

public class MultiTimeFrameSma<TNumeric>
    where TNumeric : IConvertible
{
    public Dictionary<int, SmaBase<TNumeric>> SimpleMovingAverages;
    public Dictionary<int, int> SimpleMovingAverageIndexes;
    public int[] SimpleMovingAverageKeys;
    private List<Action<TNumeric>> SampleActions;
    public TNumeric[] Averages;
    public int TotalSamples = 0;
    public TNumeric LastSample;

    public TNumeric[] History { get; private set; }
    public int MaxSampleLength { get; private set; }
    private int maxLen;
    public MultiTimeFrameSma(int maximumMovingAverage) : this(Enumerable.Range(1, maximumMovingAverage))
    {

    }

    public MultiTimeFrameSma(IEnumerable<int> movingAverageSizes)
    {
        SimpleMovingAverages = new Dictionary<int, SmaBase<TNumeric>>();
        SimpleMovingAverageIndexes = new Dictionary<int, int>();
        SimpleMovingAverageKeys = movingAverageSizes.ToArray();

        MaxSampleLength = SimpleMovingAverageKeys.Max(x => x);
        maxLen = MaxSampleLength - 1;
        History = new TNumeric[MaxSampleLength];//new List<TNumeric>();
        this.SampleActions = new List<Action<TNumeric>>();
        var averages = new List<TNumeric>();
        int i = 0;
        foreach (var smaSize in movingAverageSizes.OrderBy(x => x))
        {
            var sma = new SmaBase<TNumeric>(smaSize);
            SampleActions.Add((x) => { sma.AddSample(x); Averages[SimpleMovingAverageIndexes[sma.Count]] = sma.Average; });
            SimpleMovingAverages.Add(smaSize, sma);
            SimpleMovingAverageIndexes.Add(smaSize, i++);
            averages.Add(sma.Average);
        }
        this.Averages = averages.ToArray();
    }
    public void AddSample(TNumeric value)
    {
        if (maxLen > 0)
        {
            Array.Copy(History, 1, History, 0, maxLen);
            History[maxLen] = value;
        }
        else
        {
            History[0] = value;
        }
        LastSample = value;
        SampleActions.ForEach(action => action(value));
        TotalSamples++;
    }

}

public class MultiTimeFrameCrossOver<TNumeric>
    where TNumeric : IConvertible
{
    public MultiTimeFrameSma<TNumeric> SimpleMovingAverages { get; }
    public TNumeric[] History => SimpleMovingAverages.History;
    public TNumeric[] Averages => SimpleMovingAverages.Averages;
    public int TotalSamples => SimpleMovingAverages.TotalSamples;
    public TNumeric LastSample => SimpleMovingAverages.LastSample;
    private bool[][] matrix;
    public MultiTimeFrameCrossOver(MultiTimeFrameSma<TNumeric> simpleMovingAverages)
    {
        this.SimpleMovingAverages = simpleMovingAverages;
        int length = this.SimpleMovingAverages.Averages.Length;
        this.matrix = SimpleMovingAverages.Averages.Select(avg => SimpleMovingAverages.Averages.Select(x => true).ToArray()).ToArray();

    }
    public void AddSample(TNumeric value)
    {
        SimpleMovingAverages.AddSample(value);
        int max = SimpleMovingAverages.Averages.Length;

        for (var maIndex = 0; maIndex < max; maIndex++)
        {
            IComparable<TNumeric> ma = (IComparable<TNumeric>)SimpleMovingAverages.Averages[maIndex];
            var row = matrix[maIndex];
            for (var otherIndex = 0; otherIndex < max; otherIndex++)
            {
                row[otherIndex] = ma.CompareTo(SimpleMovingAverages.Averages[otherIndex]) >= 0;
            }
        }
    }

    public bool[][] GetMatrix() => matrix;

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-06-18T12:20:00.343

由于没有显示我的方法会建议它。我认为 Linq 在大多数情况下会执行得足够快，而无需创建缓冲区或代码复杂性。考虑到金融 _originalDataserie OHLC 开盘高低收盘，我想要 sma 收盘价是`Ilist<double>`

```
 double[] smaSerie = new double[_originalDataSeries.Count];
      for (int i = 0; i < _originalDataSeries.Count;i++)
            {
                double sma = double.NaN;
                int period = 50;
              //  var rangeOfinterest = _originalDataSeries.CloseValues.AsParallel().Skip(i - period).Take(period).ToList();
                var rangeOfinterest = _originalDataSeries.CloseValues.Skip(i - period).Take(period).ToList();
                if (rangeOfinterest.Any())
                {
                    sma = rangeOfinterest.Average();                   
                }              
                 smaSerie[i] = sma;

            } 
```

Sma 计算 720 点：00:00:00.0075765

我不知道评论中的并行版本是否表现更好，因为它需要将平均值实现为并行并用于 _originalSerie 并处理空范围，但如果你有百万点来显示一个镜头，它可以通过这种方式改进。但在这种情况下我会去 GPU 计算，因为 sma 有资格参加这个 gpu 任务

# ruby - Ruby 从频繁重置的服务器中读取

> ID：12884605
> 
> 赞同：1
> 
> 时间：2012-10-14T17:19:24.637
> 
> 标签：ruby, sockets

我有一个经常断开连接的服务器

```
$echo "GET hosts" | nc localhost 323
a.host.com
b.host.com
c.host.com 
```

使用以下代码从 ruby​​ 读取相同内容时

```
s = TCPSocket.new(host,port)
s.puts "GET hosts\n\n\r\r"
data = ""
begin
  until s.closed?
    l = s.gets
    puts "Host:" + l
    data = data + l
  end
rescue Exception => e
  puts "pp" + e.message
end 
```

打印出来

```
Host:a.host.com
Host:b.host.com
Host:c.host.com
Host:Error reading from 3: Connection reset by peer 
```

并且应用程序以某种方式挂起。对此有任何注意吗？奇怪的是它没有进入异常处理程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:23:09.810

你可以试试这样抢救`rescue Errno::ECONNRESET => e`。

查看[How to catch error Connection reset by peer (Errno::ECONNRESET)](https://stackoverflow.com/questions/9204920/how-to-catch-error-connection-reset-by-peer-errnoeconnreset)，尤其是`retry`位。

# c# - 如何检查字符串是否包含从 a 到 z 的任何字母？

> ID：12884610
> 
> 赞同：58
> 
> 时间：2012-10-14T17:19:48.280
> 
> 标签：c#, windows, string, char

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-10-14T17:28:29.107

关于什么：

```
//true if it doesn't contain letters
bool result = hello.Any(x => !char.IsLetter(x)); 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2012-10-14T17:31:00.743

用这个替换你`for loop`的：

```
errorCounter = Regex.Matches(yourstring,@"[a-zA-Z]").Count; 
```

记得使用`Regex`类，你必须`using System.Text.RegularExpressions;`在你的导入

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-10-14T17:23:01.277

您可以使用正则表达式：

```
Regex.IsMatch(hello, @"^[a-zA-Z]+$"); 
```

如果你不喜欢这样，你可以使用 LINQ：

```
hello.All(Char.IsLetter); 
```

或者，您可以遍历字符，并使用 isAlpha：

```
Char.IsLetter(character); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-14T17:22:31.793

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-14T17:24:13.770

对于最小的变化：

```
for(int i=0; i<str.Length; i++ )
   if(str[i] >= 'a' && str[i] <= 'z' || str[i] >= 'A' && str[i] <= 'Z')
      errorCount++; 
```

您可以使用正则表达式，至少如果速度不是问题并且您并不真正需要实际的确切计数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-14T17:23:30.220

使用正则表达式无需将其转换为 char 数组

```
if(Regex.IsMatch("yourString",".*?[a-zA-Z].*?"))
{
errorCounter++;
} 
```

# php - 联系表格 PHP 重定向不起作用

> ID：12884612
> 
> 赞同：4
> 
> 时间：2012-10-14T17:19:51.680
> 
> 标签：php, forms, email, contact

在我的联系表单上提交消息后，我试图重定向到我的主页，表单发送电子邮件但我收到此消息：

```
Array
(
    [name] => Abdo
    [company] => Mediabyrån A&B
    [email] => a.el-madhoun@hotmail.com
    [content] => Hejsan
    [contact_to] => info@web.se
) 
```

> 警告：无法修改标头信息 - 标头已由 /customers/4/5/a/webelite 中的（输出开始于 /customers/4/5/a/webelite.se/httpd.www/kontakt.php:3）发送。 se/httpd.www/kontakt.php 在第 39 行

我的联系表格；

```
<form action="kontakt.php" method="post">
<p><input type="text" required="required" id="name" name="name" class="text_input" size="22"  />
<label for="name">Namn *</label></p>

<p><input type="text" required="required" id="company" name="company" class="text_input" size="22"  />
<label for="company">Företag *</label></p>

<p><input type="email" required="required" id="email" name="email" class="text_input"  size="22"  />
<label for="email">Epost *</label></p>

<p><textarea required="required" name="content" class="textarea" cols="30" rows="5"></textarea></p>

<p><button type="submit" class="button white"><span>Skicka</span></button></p>
<input type="hidden" value="info@web.se" name="contact_to"/>
</form> 
```

这是我的PHP：

```
<?php

echo $name = $_POST['name'];
echo $company = $_POST['company'];
echo $email =  $_POST['email'];
echo $content = $_POST['content'];

$mail_to = 'info@webelite.se';
$subject = 'Lilla form'.$name;

$body_message = 'From: '. $name . "\n"; 
$body_message .= 'company: '. $company . "\n";
$body_message .= 'E-mail: '. $email ."\n";
$body_message .= 'Message: '. $content;

$headers = 'From: '. $mail_name . "\r\n";
$headers .= 'Reply-To: '. $email ."\r\n";

$success = mail($mail_to, $subject, $body_message, $headers);

echo "<pre>";
print_r($_POST);

header('Location:mydomain');

?> 
```

我也尝试使用 if

```
($success){
print "<meta http-equiv=\"refresh\" content=\"0;URL=YOUR_PAGE_HERE.html\">"; 
```

这行得通，但在点击提交和被重定向之间我得到了一个丑陋的半秒闪现。

所有的帮助都得到了认可。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:22:32.460

在重定向之前，您无法将任何内容输出到屏幕上。

删除你所有的`echo`'es 和`print_r`'s，你应该没问题。

**编辑：**

同样正如@jhonraymos 提到的，一定要`header()`正确使用。也许您更改了此设置以隐藏您要重定向到的实际页面。添加具有正确路径定义的本地文件，或者如果重定向到其他域，则需要定义完整的 url。如有疑问，请参阅[统一资源定位器。](http://en.wikipedia.org/wiki/Uniform_resource_locator)

**另一个编辑：**

我看到你更新了你的问题。别再尝试印度魔法了，比如

```
if ($success){
    print "<meta http-equiv=\"refresh\" content=\"0;URL=YOUR_PAGE_HERE.html\">"; 
```

只要接受之前不要在屏幕上输出**任何东西**`headers()`的事实，你的灵魂就会永远安全。这不是混合 http-meta 的地方。PHP 可以很好地做到这一点。

这听起来可能首先是一个限制，但相信我，它不是。这是一种祝福。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-14T17:23:38.390

这是错误

```
print_r($_POST);

header('Location:mydomain'); 
```

您正在打印之前的东西`header("location: mydomain.com")`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-14T17:32:21.590

标头用于与客户端的浏览器进行通信。它们就像浏览器在收到时将执行的小命令。当您输出任何数据（文本、数字等）时，您的客户端浏览器将打印该数据。之后，浏览器将不再对您发送的任何标头感兴趣。

该`header()`函数是用于发送自定义标头的函数。因此，当调用此函数时，会将标头发送到客户端的浏览器。

现在您对您实际尝试做的事情有了一个非常简短的了解，您应该能够看到您的问题所在。

在发送这些自定义标头之前，您正在输出其他数据。这就是触发错误的原因。

所以这：

```
echo "<pre>";
print_r($_POST); 
```

不应该在此之前：

```
header('Location:mydomain'); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-14T17:28:33.867

`header` 是的，在尝试将其放在页面顶部之前，您不应该回显、打印任何内容：

```
<?php ob_start(); ?> 
```

然后在页面底部：

```
<?php ob_end_flush(); ?> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-14T17:30:04.753

这 `echo "<pre>"; print_r($_POST);` 是为了什么？

您的重定向可能发生在调用任何 echo 函数之前，不是吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-16T13:16:10.347

这是php中很常见的问题。一些整理方法：

1.  在页面顶部使用。

2.  检查您是否不小心在 php 打开标记之前或 php 关闭标记之后添加了一些空格。

3.  如果仍然无法解决，请使用 java-script window.location 而不是 header。

希望它有所帮助。编码快乐！！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-14T17:25:04.913

您收到此警告是因为您将变量的值输出到屏幕并`header`在此之后重定向。

打印**后****无法**发送标题( , ...)。为了修复它，请遵循以下代码：**`echo``print_r`**

 **```
$name = $_POST['name']; //no echo 
$company = $_POST['company'];//no echo 
$email =  $_POST['email'];//no echo 
$content = $_POST['content'];//no echo 

$mail_to = 'info@webelite.se';
$subject = 'Lilla form'.$name;

$body_message = 'From: '. $name . "\n"; 
$body_message .= 'company: '. $company . "\n";
$body_message .= 'E-mail: '. $email ."\n";
$body_message .= 'Message: '. $content;

$headers = 'From: '. $mail_name . "\r\n";
$headers .= 'Reply-To: '. $email ."\r\n";

$success = mail($mail_to, $subject, $body_message, $headers);

//echo "<pre>";
//print_r($_POST); 
```**

# android - Android 应用程序无法运行

> ID：12884614
> 
> 赞同：0
> 
> 时间：2012-10-14T17:20:06.317
> 
> 标签：android, android-layout, android-emulator, android-widget

请帮助我了解为什么我的应用程序没有运行。我想检查刷卡是否有效，但它甚至不会在模拟器上启动。由于我对 androing 编程非常陌生，因此我找不到错误所在，因为没有编译器错误。

活动代码：包 enn.ericsson.sitezoeker；

```
import android.app.Activity;
import android.os.Bundle;
import android.view.GestureDetector;
import android.view.GestureDetector.OnGestureListener;
import android.view.MotionEvent;
import android.view.View;
import android.view.animation.Animation;
import android.view.animation.AnimationUtils;
import android.widget.ViewFlipper;

public class MainActivity extends Activity {

    ViewFlipper viewFlipper = GlobalVars.viewFlipper;
    Animation slideLeftIn = GlobalVars.slideLeftIn;
    Animation slideLeftOut = GlobalVars.slideLeftOut;
    Animation slideRightIn = GlobalVars.slideRightIn;
    Animation slideRightOut = GlobalVars.slideRightOut;
    GestureDetector gestureDetector = GlobalVars.gestureDetector;
    View.OnTouchListener gestureListener = GlobalVars.gestureListener;

    public void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        viewFlipper = (ViewFlipper) findViewById(R.id.flipper);
        slideLeftIn = AnimationUtils.loadAnimation(this, R.anim.slide_left_in);
        slideLeftOut = AnimationUtils
                .loadAnimation(this, R.anim.slide_left_out);
        slideRightIn = AnimationUtils
                .loadAnimation(this, R.anim.slide_right_in);
        slideRightOut = AnimationUtils.loadAnimation(this,
                R.anim.slide_right_out);

        gestureListener = new View.OnTouchListener() {
            public boolean onTouch(View v, MotionEvent event) {
                if (gestureDetector.onTouchEvent(event)) {
                    return true;
                }
                return false;
            }
        };
        gestureDetector = new GestureDetector(this,
                (OnGestureListener) gestureListener);

    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (gestureDetector.onTouchEvent(event))
            return true;
        else
            return false;
    }

} 
```

GlobarVars.java：包 enn.ericsson.sitezoeker；

```
import android.app.Application;
import android.view.GestureDetector;
import android.view.View;
import android.view.animation.Animation;
import android.widget.ViewFlipper;

public class GlobalVars extends Application {

    private static GlobalVars vars;

    public static GlobalVars getInstance() {
        return vars;
    }

    @Override
    public void onCreate() {
        super.onCreate();
        vars = this;
    }

    public static GestureDetector gestureDetector;
    public static View.OnTouchListener gestureListener;
    public static Animation slideLeftIn;
    public static Animation slideLeftOut;
    public static Animation slideRightIn;
    public static Animation slideRightOut;
    public static ViewFlipper viewFlipper;

} 
```

MyGestureDetector 类：包 enn.ericsson.sitezoeker；

```
import android.view.MotionEvent;
import android.view.GestureDetector.SimpleOnGestureListener;
import android.view.animation.Animation;
import android.widget.ViewFlipper;

class MyGestureDetector extends SimpleOnGestureListener {

    ViewFlipper viewFlipper = GlobalVars.viewFlipper;
    Animation slideLeftIn = GlobalVars.slideLeftIn;
    Animation slideLeftOut = GlobalVars.slideLeftOut;
    Animation slideRightIn = GlobalVars.slideRightIn;
    Animation slideRightOut = GlobalVars.slideRightOut;

    private static final int SWIPE_MIN_DISTANCE = 120;
    private static final int SWIPE_MAX_OFF_PATH = 250;
    private static final int SWIPE_THRESHOLD_VELOCITY = 200;

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
            float velocityY) {
        try {

            if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                return false;
            // right to left swipe
            if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                viewFlipper.setInAnimation(slideLeftIn);
                viewFlipper.setOutAnimation(slideLeftOut);
                viewFlipper.showNext();
            } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                    && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                viewFlipper.setInAnimation(slideRightIn);
                viewFlipper.setOutAnimation(slideRightOut);
                viewFlipper.showPrevious();
            }
        } catch (Exception e) {
            // nothing
        }
        return false;
    }
} 
```

显现：

```
<?xml version="1.0" encoding="UTF-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    android:name=".GlobalVars"
    package="enn.ericsson.sitezoeker"
    android:installLocation="auto"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="me.user_interface.DisplayMessageActivity"/> 
    </application>

</manifest> 
```

布局：

```
 <ScrollView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/View1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:fillViewport="false" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/textView2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Provider:"
                    android:textAppearance="?android:attr/textAppearanceLarge" />

                <LinearLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:orientation="vertical" >

                    <RadioButton
                        android:id="@+id/rbKPN"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="KPN" />

                    <RadioButton
                        android:id="@+id/rbTMobile"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="T-Mobile" />

                    <RadioButton
                        android:id="@+id/rbVodafone"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:text="Vodafone" />
                </LinearLayout>
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >

                <TextView
                    android:id="@+id/textView1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Site number:"
                    android:textAppearance="?android:attr/textAppearanceLarge" />

                <EditText
                    android:id="@+id/txtSitenr"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:ems="10"
                    android:inputType="number" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <TableRow
                    android:layout_width="match_parent"
                    android:layout_height="10dp" >
                </TableRow>
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="80dp"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/textView3"
                    android:layout_width="72dp"
                    android:layout_height="wrap_content"
                    android:text="Address:"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/lblAddress"
                    android:layout_width="231dp"
                    android:layout_height="71dp"
                    android:background="@drawable/draw"
                    android:inputType="none"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textColor="#ffffff" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <TableRow
                    android:layout_width="match_parent"
                    android:layout_height="10dp" >
                </TableRow>
            </LinearLayout>

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/textView4"
                    android:layout_width="72dp"
                    android:layout_height="wrap_content"
                    android:text="City:"
                    android:textAppearance="?android:attr/textAppearanceMedium" />

                <TextView
                    android:id="@+id/lblCity"
                android:layout_width="231dp"
                android:layout_height="71dp"
                android:background="@drawable/draw"
                android:inputType="none"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="#ffffff" />
        </LinearLayout>
    </LinearLayout>
</ScrollView>

<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:fillViewport="false"
    android:id="@+id/View2" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="80dp"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/textView31"
                android:layout_width="72dp"
                android:layout_height="wrap_content"
                android:text="Site name:"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:id="@+id/lblSiteName"
                android:layout_width="231dp"
                android:layout_height="71dp"
                android:background="@drawable/draw"
                android:inputType="none"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="#ffffff" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="10dp" >
            </TableRow>
        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/textView41"
                android:layout_width="72dp"
                android:layout_height="wrap_content"
                android:text="Site type:"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <TextView
                android:id="@+id/lblSiteType"
                android:layout_width="231dp"
                android:layout_height="71dp"
                android:background="@drawable/draw"
                android:inputType="none"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="#ffffff" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent" >

            <TableRow
                android:layout_width="match_parent"
                android:layout_height="10dp" >
            </TableRow>
        </LinearLayout>
    </LinearLayout>

</ScrollView>

</ViewFlipper> 
```

rg，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:54:33.897

我只检查了几行代码，但我注意到您没有调用`super.onCreate()`（并且您的`onCreate`方法应该`public`不是`protected`）：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main); 
```

调用失败会`super.onCreate()`引发 SuperNotCalledException。从`onCreate`文档中：

> *派生类必须调用该方法的超类实现。如果他们不这样做，将引发异常。*

如果您仍需要帮助，则需要发布新的 LogCat 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-16T21:47:52.153

我设法让它工作。问题是 GestureDetector 的东西。它甚至没有调用该类，我已经删除了两者并使用了 TouchListener 方法。

它现在正在滑动，但只是一次，所以没有完全修复，但到达那里...... :-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:43:01.833

在主活动中更改`"public abstract class mainActivity"`为`"public class mainActivity"` 然后更改`"protected void onCreate"`为。您还应该在主活动的 onCreate 类中`"public void onCreate`包含。猜猜应该可以正常工作。`"super.onCreate(savedInstanceState);"`

# c++ - 即使宽度和高度不为零，QWidget 也不会被调用？

> ID：12884615
> 
> 赞同：0
> 
> 时间：2012-10-14T17:20:07.080
> 
> 标签：c++, qt

我正在尝试使滚动区域包含一个小部件，该小部件将用作我正在尝试构建的拖放编辑器的绘图区域。但是，我似乎无法将其绘制出来。

这是一张图片：http: [//i.imgur.com/rTBjg.png](http://i.imgur.com/rTBjg.png)

在右边的黑色空间应该是我的滚动区域

这是我的窗口类的构造函数（我正在使用 Qt-Creator）：

```
ModelWindow::ModelWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::ModelWindow)
{
    ui->setupUi(this);

    editor = new ModelEditorWidget(this);

    ui->scrollArea->setWidget(editor);
} 
```

模型编辑器小部件如下所示：

```
//header

class ModelEditorWidget : public QWidget
{
    Q_OBJECT
public:
    explicit ModelEditorWidget(QWidget *parent = 0);

signals:

public slots:

protected:
    virtual void paintEvent(QPaintEvent *e);

};

//.cpp file:

ModelEditorWidget::ModelEditorWidget(QWidget *parent) :
    QWidget(parent)
{
    this->setAcceptDrops(true);

    this->resize(1000, 1000);

    cout << this->rect().x() << " " << this->rect().width() << endl;

    this->update();
}

void ModelEditorWidget::paintEvent(QPaintEvent *e)
{
    cout << "painting";

    QWidget::paintEvent(e);

    QPainter painter(this);

    painter.setBrush(QBrush(Qt::green));
    painter.setPen(QPen(Qt::red));
    painter.drawRect(400, 400, 50, 50);
    painter.fillRect(e->rect(), Qt::SolidPattern);
} 
```

我认为这会将modeleditorwidget的大小设置为1000x1000，然后在小部件上绘制一个绿色或红色矩形。但是，在paintEvent 开头的cout 命令行中缺少“绘画”消息，这表明它没有被执行。我首先怀疑这是因为小部件上有 0 宽度和 0 高度。但是，构造函数中的 cout 告诉我小部件位于 x = 0 和宽度 = 1000 处，因此我假设因为这与我的调整大小语句相匹配，所以高度也是指定的 1000。

**编辑：**通过调用`cout.flush()`我得到了“绘画”输出。然而，这只会加深谜团，因为绘画事件看起来并不像是真的在绘画。我现在也在滚动区域和小部件上调用 show 。

有谁看到我在这里做错了什么？也许我没有正确地将 ModelEditorWidget 添加到滚动区域？

顺便说一句，我对 Qt 很陌生，这是我第一个使用它的主要 GUI 项目。我的大部分其他 GUI 内容都是使用 C# 中的 .NET 完成的，但由于我希望这是跨平台的，所以我决定远离 C#.NET 和单声道并使用 Qt。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:58:41.070

QScrollArea::setWidget() 的文档说：

> 如果添加小部件时滚动区域可见，则必须显式显示（）它。
> 
> 请注意，您必须在调用此函数之前添加小部件的布局；如果您稍后添加它，则该小部件将不可见 - 无论您何时显示（）滚动区域。在这种情况下，您也不能稍后显示（）小部件。

你试过吗？

# python - 如何使用 urlfetch 获取所有 cookie？

> ID：12884618
> 
> 赞同：3
> 
> 时间：2012-10-14T17:20:19.567
> 
> 标签：python, google-app-engine, cookies, urlfetch

根据[GAE 获取文档](https://developers.google.com/appengine/docs/python/urlfetch/fetchfunction)，cookie 不通过重定向处理：

> 重定向时不处理 Cookie。如果需要 cookie 处理，请将 follow_redirects 设置为 False 并手动处理 cookie 和重定向。

所以，我正在尝试实施手动解决方案：

```
page = urlfetch.Fetch(
    url = url,
    payload = form_data,
    method = urlfetch.POST,
    headers = headers,
    follow_redirects = False,
    deadline = 60)
cookies = ''
while page.status_code == 302:
    url = page.headers.get('location')
    if page.headers.get('set-cookie'):
        cookies = page.headers.get('set-cookie')
        headers['cookie'] = cookies
    page = urlfetch.Fetch(
        url = url,
        method = urlfetch.GET,
        headers = headers,
        follow_redirects = False,
        deadline = 60)
if page.status_code == 200 and page.content:
    self.response.out.write(page.content) 
```

但它没有按预期工作。看起来我缺少[一些 cookie](https://developers.google.com/appengine/docs/python/urlfetch/responseobjects)：

> header_msg 包含响应标头的 httplib.HTTPMessage 实例。如果可能有多个具有相同名称的标头（例如 Set-Cookie 标头），请调用 header_msg.get_headers(header_name) 以将值作为列表检索。

但是我应该如何使用那个*header_msg*？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-18T00:06:17.770

如果我理解这个问题，您想从每个响应中收集（并累积传递）cookie，但是带有 follow_redirects=True 的 URLFetch 仅返回来自最后一个响应的 cookie。此外，默认行为不会实现 cookie jar，这将导致后面的请求使用与先前响应`Cookie`中的 s 相对应的正确标头发送。`Set-Cookie`大概最初的 POST 是一个登录表单，它重定向到一个需要 cookie 的页面，这个方案不能满足这些限制。

为此，您的代码已关闭，但`cookies = page.headers.get('set-cookie')`会在每次请求后清除以前收集的 cookie。这应该会更好：

```
page = urlfetch.Fetch(
  url = url,
  headers = headers,
  follow_redirects = False)
cookies = []
while page.status_code == 302:
  url = page.headers.get('location')
  if page.headers.get('set-cookie'):
    cookies.extend(page.header_msg.getheaders('set-cookie'))
  headers['cookie'] = '; '.join(cookies)
  page = urlfetch.Fetch(
    url = url,
    method = urlfetch.GET,
    headers = headers,
    follow_redirects = False)
if page.status_code == 200 and page.content:
  self.response.out.write(page.content) 
```

一些警告：

*   如果`Location`是相对路径，则需要修复`url`.
*   如果任何`Set-Cookie`标头不只是键=值（例如，它有一个过期），您需要解析标头值，以便您可以只发送键/值对。有关解析的帮助，请参阅[Cookie库。](http://docs.python.org/library/cookie.html)
*   `Set-Cookie`如果针对特定键看到多个 cookie，则此代码将愉快地发送重复的 cookie 。
*   如果重定向在一个单独的域上结束，这将错误地从原始域发送 cookie。这可能是一个安全问题。正确的 cookie jar 实现可以推断域和路径限制，以确定何时接受和发出 cookie。您可能想要合并[cookielib.CookieJar](http://docs.python.org/library/cookielib.html#cookiejar-and-filecookiejar-objects)库。如果您希望请求序列位于同一个域上，那么如果您检测到切换，则中止可能就足够了。

# php - ISO8859_1中的Jquery AJAX传递变量

> ID：12884620
> 
> 赞同：1
> 
> 时间：2012-10-14T17:20:45.653
> 
> 标签：php, jquery, ajax, firebird, interbase

我有一个 php 代码，它从 URL 参数中捕获一个变量，并通过一个 html edditbale 文本字段将其传递给 Jquery/Ajax，然后再传递给一个将其传递给我的 Firebird DB 的外部 php 代码。问题是 jquery/ajax 正在将 ä 之类的字符更改为 Ã¤ 等等。

首先，我认为我必须使用 ISO8859_1（该表正在使用）位对 firebird SQl 更新进行编码，然后我发现它正在更改字符的 Jquery。

这是我的代码：

```
?>
    <div id="wrap">
        <h3>Comment</h3>
        <div id="status"></div>
        <div id="content">
        <div id="editable" contentEditable="true">
<?php
        echo $row[21];
        ?>
</div>  
        <button id="save">Save</button>
        </div>  
    </div>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
  <script>
    $(document).ready(function() {  
        $("#save").click(function (e) {         
            var content = $('#editable').html()
            var nr = <?php echo $s; ?>; 
            $.ajax({
                url: 'save.php',
                type: 'POST',
                data: {
                content: content,
                nr: nr
                },      
                success:function (data) {               
                    if (data == '1')
                    {
                        $("#status")
                        .addClass("success")
                        .html("Data saved successfully")
                        .fadeIn('fast')
                        .delay(3000)
                        .fadeOut('slow');   
                    }
                    else
                    {
                        $("#status")
                        .addClass("error")
                        .html("An error occured, the data could not be saved")
                        .fadeIn('fast')
                        .delay(3000)
                        .fadeOut('slow');   
                    }
                }
            });     
        });     
        $("#editable").click(function (e) {
            $("#save").show();
            e.stopPropagation();
        });
        $(document).click(function() {
            $("#save").hide();  
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T22:51:55.983

我在将值发送到数据库之前通过简单地使用 php 翻译解决了这个问题：

$content2 = utf8_decode($content);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:35:00.103

阅读[jQuery.ajax 文档](http://api.jquery.com/jQuery.ajax/)；

> 默认 [content-type] 是“application/x-www-form-urlencoded; charset=UTF-8”

换句话说，您发布到您的 PHP 页面的是一个*UTF-8 编码的字符串*。如果您想要其他任何东西（如 ISO-8859-1），则需要对其进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:00:14.863

**试试看**

```
$.ajax({
        data: parameters,
        type: "POST",
        url: ajax_url,
        timeout: 20000,
        contentType: "application/x-www-form-urlencoded;charset=ISO-8859-15",
        dataType: 'json',
        success: callback
}); 
```

您还必须在服务器上指定字符集。

```
<?php header('Content-Type: text/html; charset=ISO-8859-15'); ?> 
```

**发表评论后再次更新答案**

请参阅下面的 URL，我认为这对您非常重要。

**如何将 javascript 字符串转码为 iso-8859-1**

[如何将 Javascript 字符串转码为 ISO-8859-1？](https://stackoverflow.com/questions/2283829/how-do-i-transcode-a-javascript-string-to-iso-8859-1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T06:44:29.157

正如 Joachim Isaksson 所说，您不能以 UTF-8 以外的其他字符集提交数据。

我通常在我的前端控制器中使用这个函数来转换所有`$_POST`数组。

```
<?php
public function direct($POST)
{
          if (!empty($_POST)) {

            $flag_unicoded = false;

            if (strpos(strtolower($_SERVER['CONTENT_TYPE']), 'charset=utf-8') !== false) $flag_unicoded = true;
            if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && $_SERVER['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest' && strpos(strtolower($_SERVER['CONTENT_TYPE']), 'charset') === false) $flag_unicoded = true;

            if ($flag_unicoded) {
              function utf8_decode_recursive($input) {
                $return = array();
                foreach ($input as $key => $val) {
                  if (is_array($val)) $return[$key] = utf8_decode_recursive($val);
                  else $return[$key] = utf8_decode($val);
                }
                return $return;          
              }
              $_POST = utf8_decode_recursive($_POST);
            }
            return $_POST;
          }
}
?> 
```

**编辑**

未经测试，但你可以试试这个：

```
jQuery.ajaxSetup({'beforeSend' : function(xhr) {xhr.overrideMimeType('charset=ISO-8859-1'); }}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-23T13:03:24.627

我希望这不会显示为重复的答案。我在一个jsp应用程序中遇到了这个问题。该页面位于 iso-8859-1 中，但使用 jquery.serialize()，从 IE 发布时数据会损坏。我在上面看到了 Abid Hussain 的建议，但将其更改为

contentType: "application/x-www-form-urlencoded;charset=UTF-8",

例如。告诉服务器它是 UTF-8，而不是 iso-8859-1 这解决了我的问题。

```
 $("#caleditform").submit(function(){
 $.ajax(
 {
 url:$("#caleditform").attr('action'),
 type: "POST",
 contentType: "application/x-www-form-urlencoded;charset=UTF-8",
 data: $('#caleditform').serialize(),
 success:function(html){
   $('#projectdialog').html(html);
 }
 }
 );
 return false; 
```

});

谢谢

# code-analysis - 静态和动态代码分析

> ID：12884623
> 
> 赞同：6
> 
> 时间：2012-10-14T17:21:03.487
> 
> 标签：code-analysis, static-code-analysis, dynamic-analysis

我发现了几个关于这个主题的问题，所有这些问题都有很多参考资料，但我对此仍然没有一个清晰的概念，因为大多数参考资料都是关于具体的工具，而不是关于分析的一般概念。因此我有一些问题：

关于静态分析： 1\. 我想有一个参考，或者总结一下哪些技术是成功的，并且现在更具有相关性。2\. 他们真的能做些什么来发现错误，我们可以做一个总结还是取决于工具？

关于符号执行： 1\. 哪里可以附上符号执行？我想根据方法，我想知道它们是动态分析，还是静态和动态分析的混合是否可以确定。

我发现区分工具中两种不同技术的问题，即使我认为我知道理论上的区别。

我实际上正在使用 C 提前谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-14T17:42:02.820

我试图给出一个简短的答案：

静态分析着眼于代码的句法结构并得出有关程序行为的结论。这些结论不一定总是正确的。

静态分析的一个典型示例是数据流分析，您可以在其中为每个语句计算`used`,`read`等集合。`write`这将有助于找到例如未初始化的值。

您还可以分析有关代码模式的代码。这样，这些工具可用于检查您是否遵守特定的编码标准。一个突出的编码标准示例是 MISRA。该编码标准用于安全关键系统，并避免了 C 中有问题的构造。通过这种方式，您已经可以说很多关于您的应用程序对内存泄漏、悬空指针等的鲁棒性。

动态分析不仅仅查看语法，还考虑了状态信息。在符号执行中，您将关于所有变量的可能值的假设添加到语句中。

最昂贵和最强大的动态分析方法是模型检查，您可以在其中真正查看系统所有可能的执行状态。您可以将模型检查系统视为以 100% 覆盖率进行测试的系统 - 但当然有很多实际问题会阻止以这种方式检查真实系统。

这些方法非常强大，您可以从静态代码分析工具中获益良多，尤其是与良好的编码标准结合使用时。

我的软件团队发现真正令人印象深刻的一个功能是，例如，当具有虚拟方法的类没有虚拟析构函数时，它会在 C++ 中告诉您。实际上很容易检查，但确实很有帮助。

商业工具非常昂贵，但一旦您学会了如何使用它们，就物有所值。一开始的一个典型问题是你会得到很多误报，不知道从哪里寻找真正的问题。

请注意，现在 g++ 已经内置了一些这些东西，并且您可以使用免费的 pclint 之类的东西。

抱歉 - 这已经很长了......希望它很有趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-12T06:09:45.710

术语“静态分析”意味着分析实际上并不运行代码。另一方面，“动态分析”运行代码，也需要一些真实的测试输入。这就是定义。而已。

静态分析采用各种形式化方法，例如抽象解释、模型检查和符号执行。一般来说，抽象解释或模型检查适用于软件验证。符号执行更适合用于查找错误。

符号执行**分为**静态分析。但是，有一种称为 concolic 执行的混合方法，它同时使用符号执行和动态测试。

为赞恩的评论添加：

也许我的解释有点混乱。

软件验证和错误发现之间的区别在于分析是否合理。例如，当我们说缓冲区溢出分析器是健全的时，这意味着分析器必须报告**所有**可能的缓冲区溢出。如果分析器没有报告任何内容，则证明目标程序中没有缓冲区溢出。因为模型检查是保证健全性的方法，所以多用于软件验证。

另一方面，当今大多数商业静态分析器积极使用的符号执行并不能保证可靠性，因为声音分析固有地会产生大量的误报。为了发现错误，更重要的是减少误报，即使也丢失了一些真阳性。

总之，

*   健全性：没有假阴性

*   完整性：没有误报

*   软件验证：健全性比完整性更重要

*   错误发现：完整性比健全性更重要

# sql - 如何从外键表中获取前一条记录以及每个主键表记录？

> ID：12884630
> 
> 赞同：1
> 
> 时间：2012-10-14T17:22:24.960
> 
> 标签：sql

我有两张表**Forum**和**ForumCateory**。ForumCateoryId 是映射字段。

该`Forum`表包含以下字段：

```
ForumId, Title,Description and ForumCategoryId 
```

该`ForumCategory`表包含 `ForumCategoryId,ForumCategory`

我需要显示来自**ForumCategory**的所有记录以及**来自论坛的前 1 个标题和描述。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:32:53.800

尝试`top 1`在子查询中使用

```
select  *
from ForumCategory FC
join (select top 1 ForumId, Title,Description, ForumCategoryId
      from Forum 
      where F.ForumCategoryId = FC.ForumCategoryId 
     ) F 
```

或尝试在子查询中使用`aggregate function`（`min`例如）：

```
select  *
from ForumCategory FC
join Forum F on  F.ForumCategoryId = FC.ForumCategoryId
             and F.ForumId = ( select min(F2.ForumId)
                               from Forum F2
                               where F2.ForumCategoryId = F.ForumCategoryId        
                              ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:40:59.013

我假设您需要每个论坛类别的最后一个论坛，所以我按 ForumId 降序订购了论坛。

```
select
    FC.ForumCategoryId,
    FC.ForumCategory,
    F.Title as ForumTitle,
    F.Description as ForumDescription
from ForumCategory as FC
    outer apply
    (
        select top 1 TT.*
        from Forum as TT
        where TT.ForumCategoryId = FC.ForumCategoryId
        order by TT.ForumId desc
    ) as F 
```

你也可以试试这样的

```
select top 1 with ties
    FC.ForumCategoryId,
    FC.ForumCategory,
    F.Title as ForumTitle,
    F.Description as ForumDescription
from @ForumCategory as FC
    left outer join @Forum as F on F.ForumCategoryId = FC.ForumCategoryId
order by
    row_number() over (partition by FC.ForumCategoryId order by F.ForumId desc) 
```

# javascript - MooTools：点击/切换时输入框的动画大小

> ID：12884635
> 
> 赞同：2
> 
> 时间：2012-10-14T17:22:54.460
> 
> 标签：javascript, html, mootools

这里只能使用Mootools！

好的，所以我有一个基本的输入框：

```
<input id='input_box' value='Name' class="validate['required']" /> 
```

该类用于 MooTools 地板验证。

**所以我想到的是：**

1）输入框里面有值的文本。2）当用户点击输入框时，框左侧向内滑动（从左到右），所以现在显示：

姓名[输入框]

3) 如果用户在没有输入任何内容的情况下点击出框区域，则它会滑回到其原始位置，名称位于框区域内。

我正在考虑这样做：

将文本定位在输入框的后面，单击动画框的大小，然后淡入该位置的文本。但是，我的 Mootools 知识真的很糟糕，也许是这样的（作为起点）？

```
 function introFunction() {
        var input = new Fx.Style($('input_box'),'width':'200');
            input.start(200);
    } 
```

然后将其应用于 onlick，但它不起作用：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:46:59.367

我试了一下。[http://jsfiddle.net/fJjTN/1/](http://jsfiddle.net/fJjTN/1/)

我用`tween`而不是`Fx`. 我没有在输入字段上做效果，而是在标签上做。

*在评论反馈后编辑*
[http://jsfiddle.net/47CAH/1/](http://jsfiddle.net/47CAH/1/)

# c# - 使用动态类型

> ID：12884637
> 
> 赞同：2
> 
> 时间：2012-10-14T17:22:54.867
> 
> 标签：c#, wpf, c#-4.0

我正在使用 System.Window.Controls Webbrowser (WPF)，它在这里和那里抛出了一些异常。

通常，如果我想访问 Winforms 中的 webbrowser 文档并单击我将使用的元素

```
 HtmlDocument document = webNav.webBrowser1.Document;
       document.GetElementById("id_of_element").InvokeMember("Click"); 
```

但是，在 WPF 中它会抛出错误`Cannot implicitly convert type 'object' to 'System.Windows.Forms.HtmlDocument'. An explicit conversion exists (are you missing a cast?)`。

我可以通过使用来解决这个问题

```
 dynamic document = webNav.webBrowser1.Document;
       document.GetElementById("id_of_element").InvokeMember("Click"); 
```

是否有更好/首选的方法，或者这是动态类型的可接受使用？（是否有任何可接受使用动态类型的示例？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:23:51.963

就像错误所说的那样，您缺少显式演员表：

```
 HtmlDocument document = (HtmlDocument)webNav.webBrowser1.Document; 
```

*假设您`using System.Windows.Forms;`在文件的顶部（以使上面的代码更短）。*

因为这条线，我知道这一点，

> 存在显式转换（您是否缺少演员表？）

`dynamic`在这种情况下不需要使用。

# python - 仅选择未来日期 Django 表单

> ID：12884638
> 
> 赞同：3
> 
> 时间：2012-10-14T17:22:59.140
> 
> 标签：python, django, forms, date

我`SelectDateWidget`在我的表格中使用。

现在我想确保表单只允许未来的日期，小部件不应该设置过去的日期。有什么方法可以让小部件本身处理它，它应该从明天的日期开始。

表格.py

```
import datetime
from django.forms.extras.widgets import SelectDateWidget
class HmsDiagnosisForm(ModelForm):
    reconsultation_date = forms.DateField(widget=SelectDateWidget) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:55:05.327

`SelectDateWidget`不支持此功能。

您可以尝试扩展`SelectDateWidget`自己的功能，但我建议使用不同的小部件，例如[jQuery UI datepicker](http://jqueryui.com/datepicker/)。它确实允许您[限制日期范围](http://jqueryui.com/datepicker/#min-max)。

使用 Django 设置 datepicker 小部件非常简单，如果您遇到[问题，已经有几个关于堆栈溢出的问题。](https://stackoverflow.com/search?q=%5Bdjango%5D+datepicker)

请记住，在客户端限制日期很有用，但在服务器端验证模型表单中的数据也很重要。

# linux - 在 Linux 中从 CGI 启动进程

> ID：12884648
> 
> 赞同：1
> 
> 时间：2012-10-14T17:24:03.627
> 
> 标签：linux, process, cgi

我需要从终端启动服务器可执行文件。它们在后台运行 wine（因为这些可执行文件适用于 Windows）。如果我从终端正常启动它们，它们可以正常工作。

现在我正在尝试制作 CGI (bash) 脚本并从网站启动服务器，但脚本不会启动进程。我认为它与葡萄酒有关，但不，脚本根本不会启动任何进程。

我在 Ubuntu 12.04.1 LTS 上构建该系统，之后脚本将进入 Debian 服务器。

所以，问题是：甚至可以从 CGI 脚本运行后台进程吗？如果是，请您解释一下如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T19:27:58.437

[CGI](http://en.wikipedia.org/wiki/Common_Gateway_Interface)程序与任何其他程序一样，除了它应该快速运行并遵循 CGI 协议（特别是关于 stdout 输出）。

与任何其他 Linux 程序一样，您可以（受系统上的限制和权限）使用[系统调用](http://en.wikipedia.org/wiki/Syscall)（例如[fork(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/fork.2.html)、[execve(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/execve.2.html)等）运行进程。

我建议阅读一本好的 Unix 编程书籍，例如[Advanced Unix Programming](http://basepath.com/aup/) abd [Advanced Linux Programming](http://advancedlinuxprogramming.com/)。我们不能在几分钟内教完所有这些。

您还可以使用库[system(3)](http://linux.die.net/man/3/system)和[popen(3)](http://linux.die.net/man/3/popen)函数运行进程（当然这些函数是使用 GNU 内部的系统调用实现的`libc`）

不要忘记 CGI 的无状态属性；您可以考虑改用[FastCGI](http://en.wikipedia.org/wiki/Fastcgi)或 SCGI。

（通过`wine`CGI 启动的程序可能会失败，例如因为它没有可与之通信的[X11](http://en.wikipedia.org/wiki/X11) 服务器；对于 C# 程序，请考虑Linux 上的[Mono](http://mono-project.com/)）。

^(另一种可能性是在某些 VM 中运行 Windows，并让您的 CGI 与此类虚拟化 Windows 程序进行交互。不了解 Windows，我不知道这种方法的问题。)

# c# - 如何隐藏 WebBrowser 上下文菜单

> ID：12884651
> 
> 赞同：0
> 
> 时间：2012-10-14T17:24:09.403
> 
> 标签：c#, wpf, browser, contextmenu

我想在我的 WPF System.Windows.Controls.WebBrowser 中禁用上下文菜单。我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T17:34:29.527

将 oncontextmenu 属性添加到文档正文标记。

```
<body oncontextmenu="return false;"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-26T12:41:37.373

只需使用

```
// Disable the Context menu inside the web browser
webBrowser1.IsWebBrowserContextMenuEnabled = false; 
```

我在 Windows 应用程序中试过这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:54:43.023

一些有用的链接[在这里](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/7c283faf-16c8-4b4e-a362-f292e3032abb/ "这里")，[这里](https://stackoverflow.com/questions/5507734/disable-context-menu-on-webbrowser-in-wpf "这里")和[另一个](https://stackoverflow.com/questions/4412915/how-to-deactivate-right-click-on-wpf-webbrowser-control "另一个")。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T17:54:58.683

[WPF WebBrowser Control](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.aspx)有许多 Touch 事件，您可以捕获和处理这些事件，并可能阻止 ContextMenu 弹出。或者您可以提供自己的 ContextMenu 供浏览器使用。

预览事件位于页面下方，可用于拦截会导致上下文菜单弹出的事件。

[OnPreviewTouchDown](http://msdn.microsoft.com/en-us/library/system.windows.uielement.onpreviewtouchdown.aspx)

[OnPreviewTouchMove](http://msdn.microsoft.com/en-us/library/system.windows.uielement.onpreviewtouchmove.aspx)

[OnPreviewTouchUp](http://msdn.microsoft.com/en-us/library/system.windows.uielement.onpreviewtouchup.aspx)

# ios - 将 nsstring 添加到主包 ios 中的本地 html 文件

> ID：12884655
> 
> 赞同：1
> 
> 时间：2012-10-14T17:24:29.107
> 
> 标签：ios, xcode, uiwebview, nsstring

大家好，目前我不在家，所以我无法提供任何代码，所以我将尝试解释我的问题。在我的 ios 应用程序中，我正在尝试使用[photoswipe](http://www.photoswipe.com)实现一个图像库，这取决于在 uitableview 中选择的餐厅，将显示不同的图像。为了测试这一点，我在我的主包中导入了所有必要的 html、javascript、css 文件，然后我在我的 uiwebview 中加载了 index.html 文件。目前，由于 index.html 文件包含指向一些测试图像的静态 url 链接，所以画廊正在为每个选择的餐厅显示相同的图像，如下所示：

```
<!DOCTYPE html>
<html>
<head>
<title>PhotoSwipe</title>
<meta name="author" content="Ste Brennan - Code Computerlove -http://www.codecomputerlove.com/" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<link href="styles.css" type="text/css" rel="stylesheet" />

<link href="../photoswipe.css" type="text/css" rel="stylesheet" />

<script type="text/javascript" src="../lib/klass.min.js"></script>
<script type="text/javascript" src="../code.photoswipe-3.0.5.min.js"></script>

<script type="text/javascript">

    (function(window, PhotoSwipe){

        document.addEventListener('DOMContentLoaded', function(){

            var
                options = {},
                instance = PhotoSwipe.attach( window.document.querySelectorAll('#Gallery a'), options );

        }, false);

    }(window, window.Code.PhotoSwipe));

</script>

</head>
<body>

<div id="MainContent">

<ul id="Gallery" class="gallery">
    <!-- ---------------------------LOOK HERE------------ -->

    <li><a href="TEST IMAGE 1 URL"><img src="THUMBNAIL TEST IMAGE 1 URL" alt="Image 001" /></a></li>
    <li><a href="TEST IMAGE 2 URL"><img src="THUMBNAIL TEST IMAGE 2 URL" alt="Image 002" /></a></li>
</ul>

</div>  

</body>
</html> 
```

是否有向这个本地 html 文件注入一个 nsstring，其中包含指向所选相关餐厅的链接？

我尝试使用`stringByEvaluatingJavaScriptFromString`覆盖`<ul>`id 为“Gallery”的 html 内容，但这会减慢将图像输出到缩略图网格的过程。

有没有办法即时编辑本地 index.html 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T15:16:45.367

我需要从我的应用富文本编辑器中显示以前保存的 HTML。我尝试了几种 javascript 注入解决方案，但以下 NSString 替换解决方案是最流畅的。

在我的详细 viewDidLoad 中，我使用了一个模板 html 文件，当用户从主 uitableview 中选择文档时，我执行了一个简单的替换操作来放入一些以前保存的文本：

```
 NSString *path = [[NSBundle mainBundle] pathForResource:@"iosDemo1" ofType:@"html"];
    NSError *error = nil;

    NSString *html = [[NSString alloc] initWithContentsOfFile:path encoding:NSUTF8StringEncoding error:&error];

    NSLog(@" html %@",html);
    // Replace text "Marker" in the template with the previously saved rich text editor html 
    NSString* modifiedHtml = [html stringByReplacingOccurrencesOfString:@"Marker" withString:self.htmlDocumentText];

    // Tell the web view to load the modified Html
    [self.webView loadHTMLString:modifiedHtml baseURL:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:29:01.243

您可以使用 NSString 方法 `stringWithContentsOfFile:encoding:error:`来获取 html 文件的全部内容，对其进行编辑，然后使用`writeToFile:atomically:encoding:error:`. 或者也许使用 NSFileHandle 方法进行更底层的访问。

**编辑：**

获取文档目录：

```
NSString *documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0]; 
```

然后将您的文件名附加到它。

```
NSString *htmlFilePath = [documentsPath stringByAppendingPathComponent:@"index.html"]; 
```

并使用上述路径作为参数`writeToFile:atomically:encoding:error:`

# c++ - 即使有足够的空间，OpenCV 也拒绝分配内存

> ID：12884656
> 
> 赞同：1
> 
> 时间：2012-10-14T17:24:42.623
> 
> 标签：c++, visual-studio-2010, memory-management, opencv

> **可能重复：**
> [OpenCV 内存不足](https://stackoverflow.com/questions/5564966/opencv-insufficient-memory)

我有一个程序正在运行多次迭代。它在前几个上运行良好，但是当它通过它们时，由于 OpenCV 内存不足错误而崩溃。问题是，有足够的可用内存！我没有接近 RAM 限制，也没有接近磁盘空间限制。

这是导致错误的代码：

```
// ftrs is a vector of MyFeature objects.
// it has 289600 elements
// FEATURE_DIMENSIONALITY is 58
cv::Mat data_pts(ftrs.size(), FEATURE_DIMENSIONALITY, CV_32FC1); 
```

这是错误：

> OpenCV Error: Insufficient memory (Failed to allocate 70662404 bytes) in unknown function, file ......\src\opencv\modules\core\src\alloc.cpp, line 52

所以，这是一个非常奇特的错误。还有什么可能导致这种情况？重申一下，在那个时间点绝对有足够的可用 RAM，并且存在足够的磁盘空间。提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:28:29.947

如果您的进程是 32 位进程，则可用内存的数量实际上并没有那么多，实际上只有几 GB。所以你实际上可以达到 32 位进程的限制。尝试检查发生错误时正在使用的内存量。

# magento - Magento：如何在将产品添加到购物车时添加自定义属性？

> ID：12884657
> 
> 赞同：0
> 
> 时间：2012-10-14T17:24:52.150
> 
> 标签：magento, magento-1.7

我将“尺寸”作为产品的自定义属性。问题是，如何在将产品添加到购物车和结帐时添加尺寸数据，这样当管理员看到订单时，他就会知道这些信息？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T20:11:14.623

有两种可能的方式。

1.  使用自定义选项。因为`size`这不会正确应用（我将在下面解释原因），但对于某些类型的数据可能特别有用（例如，保存*徽标放置*或其他无法由物理项目表示的属性）。对于自定义选项教程，您可以使用[此链接](http://www.magentoadvisor.com/magento-backup/complex-magento-products-part-2-simple-products-with-custom-options/)。

2.  使用可配置产品。对于像这样的属性`size`，`colour`它是最好的选择。*与自定义选项*相比，它几乎没有什么好处-**选项**的自动库存管理，分配不同图片的能力，并且您不需要为不同的产品重新创建整套选项。这是官方教程->[教程](http://www.magentocommerce.com/knowledge-base/entry/tutorial-creating-a-configurable-product)。

# firefox - Greasemonkey 无法加载简单脚本

> ID：12884659
> 
> 赞同：0
> 
> 时间：2012-10-14T17:25:20.420
> 
> 标签：firefox, windows-7, greasemonkey

我已经在工作中成功使用 Greasemonkey 一周左右没有任何问题（在 MacOS 上） - 我将*Smultron*配置为我的默认编辑器，并且可以简单地将更改保存到脚本，重新加载页面并观察更改。一切都很好。

然而，在我家里的 Windows 7 机器上（FF 16 和 Greasemonkey 1.4），我完全无法运行一个简单的警报（“Hello World”）脚本。我已经卸载了 GM 和 FF，并回滚到 FF 14（我在工作中运行的版本）无济于事。

配置.xml：

```
<UserScriptConfig>
 <Script basedir="test" checkRemoteUpdates="1" dependhash="." description="a test
of the test" enabled="true" filename="test.user.js" installTime="." modified="." 
name="test" namespace="." runAt="document-end" updateAvailable="" uuid="." version="1" 
installurl="." updateurl=".">
 <Grant>none</Grant>
 <Include>*</Include>
 </Script>
</UserScriptConfig> 
```

test.user.js：

```
// ==UserScript==
// @name        test
// @namespace   www.test.com
// @description a test of the test
// @include     *
// @version     1
// ==/UserScript==

alert("fafdadfadfdaf"); 
```

该脚本位于正确的基本目录 (test/...) 中。今天早上，打开电脑后，我尝试运行一个类似的测试脚本，它突然起作用了，但是，当我修改它并保存它（即更改警告文本）时，Greasemonkey 继续运行旧版本的脚本。我什至删除了`config.xml`和有问题的脚本，并且在页面重新加载时，脚本继续愉快地触发。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:23:26.187

**更新：**在这种情况下，它似乎是 Firefox 配置文件损坏。让 OP 使用[Firefox 的*Profile Manager*](http://support.mozilla.org/en-US/kb/profile-manager-create-and-remove-firefox-profiles)创建一个新的配置文件，他报告说这解决了问题。请参阅下面的评论。

* * *

听起来您没有编辑正确的文件，或者编辑器没有将更改保存到正确的位置。

1.  按照[“如何找到我的个人资料？”中的说明确定您的实际个人资料文件夹。](http://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data#w_how-do-i-find-my-profile).
    Greasemonkey 脚本的活动副本将`gm_scripts`位于此配置文件文件夹的子文件夹中。

2.  看看 Greasemonkey 说你的脚本在哪里：

    1.  左键单击 Greasemonkey 菜单箭头：
        ![Greasemonkey 菜单箭头](../Images/1cf2060df83d5e30d47c141c627103e5.png)
    2.  右键单击要编辑的 Greasemonkey 脚本：
        ![rt-点击目标](../Images/485cc4869611b070566f577cbb31cdc6.png)
    3.  如果您的编辑器配置正确，它将打开文件的实时版本。
3.  确保编辑器将更改的文件保存到相同的位置（某些 Windows 编辑器并非总是如此）。

4.  不要编辑`config.xml`。这几乎没有必要，而且更改通常会被覆盖。

# java - 粒子堆算法

> ID：12884660
> 
> 赞同：4
> 
> 时间：2012-10-14T17:25:21.110
> 
> 标签：java, android, game-physics

我正在创建一个游戏，它有大约 3000 个粒子落入一堆。每个粒子都是一个像素，我只使用一个 boolean[][] 来设置和检查哪个像素是清晰的。现在我正在使用这段代码

```
if (!isFalling(m)) {
    if (isClear(getX() + 1, getY()) && isClear(getX() + 1, getY() - 1))
        setX(getX() + 1);
    else if (isClear(getX() - 1, getY()) && isClear(getX() - 1, getY() - 1)
        setX(getX() - 1);
} 
```

问题是这段代码给了我一个非常严格的金字塔形状，看起来不太自然。如果你把它倒进一堆，我希望它看起来像盐。我的问题是，有人知道模拟粒子堆的算法或更好的方法吗？任何帮助将不胜感激。

解决方案：我在[这里找到了一篇不错的文章](http://w-shadow.com/blog/2009/09/29/falling-sand-style-water-simulation/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:46:55.437

你承担了一项艰巨的任务:) 这不仅仅是如何计算和绘制粒子，而是描述它们应该如何移动的物理学。

首先看一下这个：

[http://www.daniweb.com/software-development/java/threads/426676/sand-game-problem-with-graphics](http://www.daniweb.com/software-development/java/threads/426676/sand-game-problem-with-graphics)

谷歌搜索时，尝试“粒子发生器”或“粒子发射器”。

另请参阅此问题：

[那些 java 沙子游戏是如何跟踪这么多粒子的？](https://stackoverflow.com/questions/3460849/how-do-those-java-sand-games-keep-track-of-so-many-particles)

您可能缺少的主要内容是将随机性（一些熵）添加到您的系统中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:58:05.160

因此，您的函数会查看已沉降到底部的粒子，并询问它们是否可以从侧面滑下，然后如果可以，则影响该运动。

你有这个循环吗？如果是这样，您可能正在考虑“自下而上”的粒子，而滑动运动可能发生在堆上的任何点。您可以在执行循环之前尝试改组粒子列表，或者反复从列表中选择随机元素，直到获得低沉降率。

在二维数组的情况下，您可以尝试从不同方向循环或寻找其他混合方式 - 再次随机选择像素可能不是一个坏选择。我想到了模拟退火。

或者，您可以在滑动条件中添加随机检查。粒子在它们的初始位置应该是半稳定的，所以它们可能只有 50% 的机会从侧面滑落。

希望这可以帮助！

# c# - 在特定索引处添加到列表

> ID：12884661
> 
> 赞同：2
> 
> 时间：2012-10-14T17:25:22.587
> 
> 标签：c#, arraylist

`Array`如果我想在指定索引之前添加项目之前在该索引之前添加项目，我是否必须使用，或者是否可以使用`List`？还是我必须先用虚拟数据填写列表，这样我才能在我想要的确切索引处添加？

即我创建了一个 List< int>(10) 并希望在索引为 5 处添加一个 int，然后再在 0-4 中添加任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:28:17.003

你必须有一个数组。

数组可以包含空元素，而列表不能。尽管在您使用整数的情况下，您需要使用特殊值（0、-1、-MaxInt 等）来指示空元素。

然而，一旦你有了一个列表，你就可以在任何位置将元素插入到列表中，尽管这会将所有其他元素“沿”推到列表中。

但是，我刚刚认为您可以将“null”元素添加到列表中，但是您必须替换元素而不是插入新元素。

# javascript - 查找使用 $lt 和 $gt 与 javascript 日期

> ID：12884662
> 
> 赞同：3
> 
> 时间：2012-10-14T17:25:30.323
> 
> 标签：javascript, node.js, mongodb

我正在尝试从 MongoDB 集合中获取结果。这是一个例子：

```
{ "entryDate" : "2012-10-14T00:00:00.000Z", "amount" : 1, "cardId" : "50786621e3b983f1078d0bc9", "_id" : ObjectId("507a17354c6cbd6a4b000001"), "addedDate" : "Sat Oct 13 2012 21:36:53 GMT-0400 (EDT)" }
{ "entryDate" : "2012-10-10T00:00:00.000Z", "amount" : 21, "cardId" : "50786639e3b983f1078d205e", "_id" : ObjectId("507a17394c6cbd6a4b000002"), "addedDate" : "Sat Oct 13 2012 21:36:57 GMT-0400 (EDT)" }
{ "entryDate" : "2012-10-09T00:00:00.000Z", "amount" : 1, "cardId" : "50786639e3b983f1078d205e", "_id" : ObjectId("507a25e46af510804c000002"), "addedDate" : "Sat Oct 13 2012 22:39:32 GMT-0400 (EDT)" }
{ "entryDate" : "2012-10-08T00:00:00.000Z", "amount" : 12, "cardId" : "50786621e3b983f1078d0bc9", "_id" : ObjectId("507a2603b7a095824c000003"), "addedDate" : "Sat Oct 13 2012 22:40:03 GMT-0400 (EDT)" }
{ "entryDate" : "2012-10-08T00:00:00.000Z", "amount" : 1, "cardId" : "507865e1e3b983f1078ceb3f", "_id" : ObjectId("507a2667b7a095824c000004"), "addedDate" : "Sat Oct 13 2012 22:41:43 GMT-0400 (EDT)" }
{ "entryDate" : "2012-10-15T00:00:00.000Z", "amount" : 2, "cardId" : "50786621e3b983f1078d0bc9", "_id" : ObjectId("507a48c170b1a26f4f000001"), "addedDate" : "Sun Oct 14 2012 01:08:17 GMT-0400 (EDT)" } 
```

这是我要执行的查询：（这是集合）

```
// (these are JS Date objects)
// start =  Sun Oct 7 2012 13:22:02 GMT-0400 (EDT)
// end =  Sat Oct 20 2012 13:22:02 GMT-0400 (EDT)

this.find({ cardId: cardId, entryDate: { $lt : start, $gt : end } }).toArray(function(err, entries) { console.log(err, entries) }); 
```

但不幸的是，它总是返回`[]`并且没有错误。

有任何想法吗？我肯定做错了什么，但我一直在寻找很长时间，所以我请求你的帮助。

非常感谢，祝您有美好的一天！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:29:13.100

尝试这个：

```
this.find({ cardId: cardId, entryDate: { $lt : start, $gt : end } }).toArray(function(err, entries) { console.log(err, entries) }); 
```

这是我测试它的方法。插入脚本看起来像这样：

```
db.samples.insert({ "entryDate" : new Date(2012, 10, 9), "amount" : 1, "cardId" : "50786639e3b983f1078d205e" }) 
```

查找查询是这个：

```
db.samples.find({ entryDate: { $gt : new Date(2012, 10, 7), $lt : new Date(2012, 10, 20) } }).count(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:50:03.467

您的日期范围向后。它应该是：

```
this.find({ cardId: cardId, entryDate: { $gt : start, $lt : end } })
    .toArray(function(err, entries) { 
        console.log(err, entries) 
    }
); 
```

# android - ADT 如何根据设备大小和方向选择布局 XML？

> ID：12884665
> 
> 赞同：0
> 
> 时间：2012-10-14T17:25:50.243
> 
> 标签：android, android-layout

我有一个包含许多布局（大约 40 个）的复杂项目，为了减少重复，我使用了很多包含。

我在 layout-xlarge-land 中有一个活动布局，其中包括另一个布局（布局 B），它本身只是 LinearLayout 中的一组更多内容。

我的模拟器设置为 XLARGE 和横向，果然，它选择了活动布局。我已经在布局中对活动标题进行了硬编码，因此我可以确认正在使用哪个活动标题。

问题是如果我将布局 B 放在 layout-xlarge-land 中，ADT 将不会预览我的布局并给出“无法渲染”错误。如果我将布局 B 移动到 res/layout（即没有限定符），它会起作用。

我的理解是Android会首先在合格文件夹中查找布局，然后，如果找不到，则使用不合格文件夹中的布局。

这是一个问题，因为布局 B 对于各种分辨率和方向应该是不同的。

我是不是误解了什么，或者这是 ADT/Android 的怪癖？如果是怪癖，有什么解决方法吗？

> 资源
> 
> ```
> layout
> 
> layout-xlarge-land
>     activity_layout.xml    <---- correctly loaded
>     layoutb.xml            <---- "cannot render" 
> ```
> 
> 资源
> 
> ```
> layout
>     layoutb.xml            <---- renders OK
> layout-xlarge-land
>     activity_layout.xml    <---- correctly loaded 
> ```

[编辑] 我正在使用 IDEA，但看不到与 IDE 的任何相关性。

[编辑] 来自 IDEA 日志

s.android.uipreview.RenderUtil - InflateException：您必须指定一个有效的布局参考。布局 ID @layout/data_panel_all_views 无效。

这证实了 ADT 正在寻找 res/layout。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:59:52.410

看看[Android 如何找到最佳匹配资源](http://developer.android.com/guide/topics/resources/providing-resources.html#BestMatch)，它告诉您可以提供多个限定符以及如何选择最佳布局，因此在您对限定符进行排序的情况下（看起来您正在这样做，`activity_layout`因为正确加载），尝试应用较少的限定符并查看它们`includes`是否有效。否则，您可以考虑最肮脏的解决方案：`layoutb`为每个分辨率创建不同的 's 并将它们存储在同一个文件夹中。这意味着每个`activity_layout`人都会加载它的正确文件。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T19:54:22.817

这很奇怪。我做的一件事是重新启动 IDEA，但没有解决任何问题。

我刚刚重新启动了我的电脑以安装一些更新，并且自从启动 IDEA 以来，它按预期工作。

我已经看到了一些布局问题，这些问题通过重新启动 Eclipse 得到了修复。常见的元素是 ADT，所以我怀疑那里有些脆弱。

# ruby-on-rails - 通过多种模型进行关联

> ID：12884667
> 
> 赞同：0
> 
> 时间：2012-10-14T17:25:56.137
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有以下型号：

```
class Song < ActiveRecord::Base

  belongs_to :albums

end

class Album < ActiveRecord::Base

  belongs_to :artist
  has_many :songs

end

class Artist < ActiveRecord::Base

  belongs_to :user
  has_many :albums

end 
```

我需要定期确定特定歌曲属于哪个用户。在 Song 模型中添加 belongs_to :user 关系还是每次都调用 song.album.artist.user 是更好的形式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:50:25.393

看来你违反[了得墨忒耳法则](http://devblog.avdi.org/2011/07/05/demeter-its-not-just-a-good-idea-its-the-law/)。考虑使用`delegate`：

```
class Song < ActiveRecord::Base

  belongs_to :albums
  delegate :user, :to => :album

end

class Album < ActiveRecord::Base

  belongs_to :artist
  has_many :songs
  delegate :user, :to => :artist

end

class Artist < ActiveRecord::Base

  belongs_to :user
  has_many :albums

end 
```

使用此方法，您现在可以调用`song.user`

这里的另一个好处是，如果模型的结构发生变化（它可能会发生变化），您可以重新定义或重新委托`Song#user`给其他东西，这样依赖调用的对象`song.user`就不会中断。

## 资源

*   [http://devblog.avdi.org/2011/07/05/demeter-its-not-just-a-good-idea-its-the-law/](http://devblog.avdi.org/2011/07/05/demeter-its-not-just-a-good-idea-its-the-law/)
*   [http://apidock.com/rails/Module/delegate](http://apidock.com/rails/Module/delegate)

# java - Logback JMSAppender 没有清理与 ActiveMQ 的连接

> ID：12884668
> 
> 赞同：4
> 
> 时间：2012-10-14T17:25:58.530
> 
> 标签：java, jms, activemq, logback

我正在尝试在 Logback 中使用 JMSAppenders。我尝试了一个简单的应用程序来做到这一点，并成功地将日志发送到 ActiveMQ 中的队列中。

```
package test;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class LoggerTest {
    public static void main(String[] args) {
        Logger logger = LoggerFactory.getLogger("test");
        logger.debug("debug");
        logger.info("info");
        logger.warn("warn");
        logger.error("error", new Exception(""));

    }
} 
```

一切运行良好，但即使 main 中的所有语句都已执行，此应用程序也不会终止。

经过一番摸索，我注意到在主线程结束后，有两个非守护线程活动 ActiveMQ Transport 和 DestroyJavaVM 我相信这个 DestoryJavaVM 线程是在主线程退出后形成的。

我认为这与会话/连接未关闭有关。如果我终止代理，应用程序也会退出。

JMSQueueAppender 中有一个`stop()`方法可以关闭会话，但它似乎从未调用过，显然`stop`其他附加程序也没有调用该方法——我在 RollingFileAppender 上尝试过。

我尝试了与 HornetQ 相同的设置，它工作正常，但不适用于 activeMQ

我正在使用 slf4j 1.6.4、logback 1.0.0 和 activemq 5.5.0

这是logback配置

```
<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
    <!-- encoders are by default assigned the type ch.qos.logback.classic.encoder.PatternLayoutEncoder -->
    <encoder>
        <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
        </pattern>
    </encoder>
</appender>

<appender name="Queue" class="ch.qos.logback.classic.net.JMSQueueAppender">
    <InitialContextFactoryName>
        org.apache.activemq.jndi.ActiveMQInitialContextFactory
    </InitialContextFactoryName>
    <ProviderURL>tcp://localhost:61616</ProviderURL>
    <QueueConnectionFactoryBindingName>
        ConnectionFactory
    </QueueConnectionFactoryBindingName>
    <QueueBindingName>dynamicQueues/MyQueue</QueueBindingName>
</appender>

<root level="debug">
    <appender-ref ref="Queue" />
    <appender-ref ref="STDOUT" />
</root>

<logger name="org.apache.activemq" additivity="false" level="DEBUG">
    <appender-ref ref="STDOUT" />
</logger>

</configuration> 
```

和 pom

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>LoggerTest</groupId>
    <artifactId>LoggerTest</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <dependencies>
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>1.0.0</version>
<!--            <scope>runtime</scope> -->
        </dependency>
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-core</artifactId>
            <version>1.0.0</version>
<!--            <scope>runtime</scope> -->
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>1.6.4</version>
        </dependency>
        <dependency>
            <groupId>org.apache.activemq</groupId>
            <artifactId>activemq-core</artifactId>
            <version>5.5.0</version>
            <exclusions>
                <exclusion>
                    <artifactId>slf4j-api</artifactId>
                    <groupId>org.slf4j</groupId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>
</project> 
```

谁能指出这个设置有什么问题。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-07T21:18:13.190

ActiveMQ 传输在被明确关闭之前一直保持活动状态，而 LogBack 显然不会自动关闭。

可以通过以下方式触发关闭：

```
ILoggerFactory loggerFactory = LoggerFactory.getILoggerFactory();
// Check for logback implementation of slf4j
if (loggerFactory instanceof LoggerContext) {
    LoggerContext context = (LoggerContext) loggerFactory;
    context.stop();
} 
```

取自这里：[使用 logback 关闭时是否需要刷新事件？](https://stackoverflow.com/q/3678755/492462)

通过 ActiveMQ 5.7.0、LogBack 1.1.2 验证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-12T17:12:57.970

从 1.1.10 版本开始，logback 负责在 web 应用程序停止或重新加载时停止当前的 logback-classic 上下文（以及所有附加程序）。尝试更新您的 logback 版本并检查一次。

这是更新的文档：[https ://logback.qos.ch/manual/configuration.html#webShutdownHook](https://logback.qos.ch/manual/configuration.html#webShutdownHook)

# xml - 我的 atristeer 模板中一直有上标

> ID：12884670
> 
> 赞同：1
> 
> 时间：2012-10-14T17:26:50.120
> 
> 标签：xml, subscript, superscript

我正在尝试与艺术家一起为我的博客制作模板。现在在我的设计中，我不断看到**上标和下标**线，它们位于普通文本之上。知道我应该做什么和不应该做什么吗？

# eclipse - 重新加载符号后刷新 Eclipse (gdb) 堆栈跟踪

> ID：12884672
> 
> 赞同：2
> 
> 时间：2012-10-14T17:27:06.210
> 
> 标签：eclipse, gdb, eclipse-cdt

我正在通过 Eclipse（使用 ADT 和 CDT）远程调试 Android NDK 应用程序。

由于某种原因，gdb 无法连接到 Android 链接器，因此加载库不会导致符号加载。发生崩溃时，某些符号可能尚未加载。

我`set solib-search-path obj/local/armeabi`在 Eclipse 控制台视图中执行，这会导致 GDB 重新加载符号。之后，我可以发出`bt`GDB 回溯，它可以工作。

如何使用正确的回溯信息使 Eclipse 调试视图刷新？步进不是一个选项，因为我正处于 SIGSEGV 处理的中间。

PS 根据 Android NDK 修订版 8b，现在已修复：

```
Fixed several issues in ndk-gdb:
...
* Updated tool to retrieve /system/bin/link information, so gdb on the host can set a breakpoint in __dl_rtld_db_dlactivity and be aware of linker activity (e.g., rescan solib symbols when dlopen() is called). 
```

![Eclipse 仅显示部分回溯](../Images/8d49775aa6453a129f68b63447b1ec07.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:31:17.123

一种可能的选择似乎是跳转到我所在的确切指令，即：

```
jump * 0x40102ab6 
```

我希望有一个更方便的选择:-)

# list - Haskell 模式匹配难题

> ID：12884674
> 
> 赞同：1
> 
> 时间：2012-10-14T17:27:36.053
> 
> 标签：list, haskell, pattern-matching, prepend

我试图搜索可能在某个任意位置包含元素（“$”，未定义）的对列表。我只想搜索那个特殊元素前面的列表部分，所以我尝试了这样的方法（已经打算将元素 n 和列表 xs 作为参数）：

```
checkNotSameScope :: Env -> VarName -> Expr -> Expr
checkNotSameScope (xs:("$", Undefined):_) n e = if alreadyThere n xs then BoolLit False
                                                   else BoolLit True 
```

但这不起作用；编译器似乎表明 (xs: ..) 仅处理在我的列表之前的 SINGLE 值。我不能使用 : 来表示列表的第一块；只有一个元素。回想起来，这是有道理的；否则，编译器怎么知道该怎么做？将“s”添加到“x”之类的东西不会神奇地产生多个元素！但是我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T17:34:13.677

不幸的是，即使使用智能编译器和语言，也无法避免一些编程......

在您的情况下，您似乎希望列表的一部分达到特定元素。更一般地说，要找到符合某些条件的列表，您可以使用标准库`takeWhile`函数。然后你可以`alreadyThere`在它上面运行：

```
checkNotSameScope :: Env -> VarName -> Expr -> Expr
checkNotSameScope xs n e = if alreadyThere n (takeWhile (/= ("$", Undefined)) xs)
                           then BoolLit False
                           else BoolLit True 
```

`("$", Undefined)`对于没有出现的列表，它可能不是您想要的，所以要小心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T17:52:03.863

与 Joachim 的回答类似，您可以使用[`break`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3abreak)，这将允许您检测何时`("$", Undefined)`不发生（如果有必要）。IE

```
checkNotSameScope xs n e = case break (== ("$", Undefined)) xs of
                             (_, [])  -> .. -- ("$", Undefined) didn't occur!
                             (xs', _) -> BoolLit . not $ alreadyThere n xs' 
```

（注意，您在此解决方案中失去了一些懒惰，因为必须遍历列表直到`("$", Undefined)`或结束，以检查第一种情况。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T19:46:49.433

Haskell 不能开箱即用地进行这种模式匹配，尽管有一些语言可以使用[active patterns ，例如](http://msdn.microsoft.com/en-us/library/dd233248.aspx)[CLIPS](http://en.wikipedia.org/wiki/CLIPS)或 F# 。

但是我们可以使用 Haskell 现有的模式匹配能力来获得类似的结果。让我们首先定义一个名为 deconstruct 的函数，定义如下：

```
deconstruct :: [a] -> [([a], a, [a])]
deconstruct [] = []
deconstruct [x] = [([], x, [])]
deconstruct (x:xs) = ([], x, xs) : [(x:ys1, y, ys2) | (ys1, y, ys2) <- deconstruct xs] 
```

这个函数所做的是将列表 xs 的所有分解为形式的三元组，`(ys1, y, ys2)`使得`ys1 ++ [y] ++ ys2 == xs`. 例如：

```
deconstruct [1..4] => [([],1,[2,3,4]),([1],2,[3,4]),([1,2],3,[4]),([1,2,3],4,[])] 
```

使用它，您可以按如下方式定义您的函数：

```
checkNotSameScope xs n e =
    case [ys | (ys, ("$", Undefined), _) <- deconstruct xs] of
        [ys] -> BoolLit $ not $ alreadyThere n xs
        _    -> -- handle the case when ("$", Undefined) doesn't occur at all or more than once 
```

我们可以使用[do-notation](http://www.haskell.org/haskellwiki/Monad#Special_notation)来获得更接近您正在寻找的东西：

```
checkNotSameScope xs n e = BoolLit $ not $ any (alreadyThere n) prefixes
    where
        prefixes = do
            (xs, ("$", Undefined), _) <- deconstruct xs
            return xs 
```

这里发生了几件事。首先，该`prefixes`变量将存储出现在该`("$", Undefined)`对之前的所有前缀列表 - 如果该对不在输入列表中，则没有`xs`。然后使用[any](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v%3aany)函数，我们正在检查是否`alreadyThere n`为任何前缀提供 True 。剩下的就是完成你的函数逻辑。

# javascript - 如何正确构建 KnockoutJS 应用程序

> ID：12884678
> 
> 赞同：7
> 
> 时间：2012-10-14T17:28:11.060
> 
> 标签：javascript, knockout.js

我想知道如何以正确的方式构建 KnockoutJS 应用程序。

*   官方文档几乎总是只使用**一个 ViewModel**！

在只实现了几个功能之后，我的代码变得非常混乱，并且来自面向对象的背景，我对这样的架构非常过敏。所以必须有更好的解决方案。

由于对 JavaScript 不是很有经验，我正在搜索 Stackoverflow 并找到[了这三个选项](https://stackoverflow.com/questions/8676988/example-of-knockoutjs-pattern-for-multi-view-applications)。所以我尝试了前两个选项，但我对它们不满意：

*   像[这里](http://blog.yojimbocorp.com/2012/02/14/multiple-view-models-with-knockout/)一样拥有**多个 ViewModel**。

我发现很难决定哪些 DOM 元素获得了哪些 ViewModel。还有几个从 DOM 元素外部调用的函数。也许我在这种架构中使用的 ViewModel 太少，但 ViewModel 之间的通信似乎有所不同，我希望不知何故应该没有必要。那么如何正确地做到这一点呢？

*   拥有**子视图**并利用**with 绑定**（[这三个](https://stackoverflow.com/questions/8676988/example-of-knockoutjs-pattern-for-multi-view-applications)选项中的第二个选项）。

这是我首选的架构类型，因为您可以从一个视图模型中进行文档范围的绑定，但您也可以将代码构造成子块，并使用 with 绑定将它们绑定到您想要的任何位置。此选项虽然需要对象文字而不是函数，如本[答案](https://stackoverflow.com/questions/9589419/difference-between-knockout-view-models-declared-as-object-literals-vs-functions)中所述，这些函数较差。

我没有尝试过方法三，因为它似乎有点矫枉过正并且还使用了对象文字。

**那么有没有一种方法可以在不使用对象文字的情况下构建我的代码并完全控制？**

我希望这不会太令人困惑:-P

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T17:56:30.713

对于您提到的任何选项，您不需要使用对象文字。示例只是使用它们来简化代码。您可以选择以您认为合适的任何方式创建单独的视图模型。

例如在 #3 中，您可以使用如下构造函数：http: [//jsfiddle.net/rniemeyer/PctJz/149/](http://jsfiddle.net/rniemeyer/PctJz/149/)。当然，实际数据将被传递到函数中，而不是静态的。与 #2 相同，您只需将其包装在“视图”对象中。

# c++ - C++/TCP 数据传输垃圾

> ID：12884681
> 
> 赞同：1
> 
> 时间：2012-10-14T17:28:21.170
> 
> 标签：c++, tcp

我是一个初学者 C++/TCP 程序员，我正在做一个在 C++/VS2010/Windows 7 中使用 TCP 进行文件传输的家庭作业。

我创建了一个客户端和一个服务器，可以监听网络上的多个客户端。当我向服务器发送请求文件的请求时，我收到了正确大小的文件，但是当我从服务器向客户端发送数据时，我得到了垃圾。

我很确定我在铸造的某个地方犯了一个愚蠢的错误，但无法确定在哪里。我正在`char*`逐字节发送并将它们保存到客户端上的文件中。

有什么想法有什么问题吗？

```
// client code: 
unsigned int packlen = 0;
unsigned int flength = 0;
char* data = NULL;
if((packlen = recv(sock, (char*) &flength, sizeof(unsigned int), 0)) == 
    sizeof(unsigned int))
{
    flength = (unsigned int) flength;
    data = new char[flength];
}
unsigned char current;
char* buffer;
unsigned int accumlength = 0;

for(unsigned int i = 0; i < flength; ++i)
{
    if((packlen = recv(sock, (char*) &current , sizeof(unsigned int), 0)) 
        != sizeof(unsigned int))
    {
        err_sys("Receiving packet transfer error., exit");
    }
    data[i] = current;
}
ofstream output(argv[2], ios::binary);
output.write(data, flength);
if(data)
{
    delete[] data;
    data = NULL;
}

// Server code:
char* data = NULL;
unsigned long length;
string fname; 

data = new char[stat_buf.st_size];
ifstream input(reqp->filename, ios::binary);
input.seekg(0, ios::end);
unsigned int length = input.tellg();
if(length != stat_buf.st_size)
{
    err_sys("Problems with file size");
}

send(cs, (char*) &length, sizeof(unsigned int), 0);
Sleep(1000);  // wait a bit

input.read(data, length); // read all file at once.
for(unsigned int i = 0; i < length; ++i)
{
    unsigned char current = data[i];
    send(cs, (char*) &current, sizeof(unsigned char), 0);
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:32:54.317

看起来您在读取循环期间丢弃了很多字节：

```
recv(sock, (char*) &current, sizeof(unsigned int), 0) 
```

unsigned char在哪里`current`，但您要求它读取`sizeof(unsigned int)`更多的字节。所以 recv() 会将其结果写入其他地方（因为它将写入 4 个字节`current`）

你可能应该写：

```
recv(sock, (char*) &current, 1, 0) 
```

即使这是非常低效的，它至少应该可以工作。

# php - 使用 PHP 中的刷新与标头重定向

> ID：12884687
> 
> 赞同：-2
> 
> 时间：2012-10-14T17:28:56.160
> 
> 标签：php, http, redirect, header

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我正在使用 header() 函数将用户重定向到某个相对 URI，例如：

```
header('Location:/Root/folder'); 
```

一切都很完美。但是，如果我添加 Refresh:0; 到 header() 参数的开头我得到奇怪的错误，我没有被重定向到请求的 URI。

我得到的错误是：我在带有 header() 的函数中使用的一些未定义的 POST 变量，以及以下参数：

```
Warning: Cannot modify header information - headers already sent by (output started at... 
```

问题是什么？即使在最后使用 ob_start() 和 ob_end_flush() 也不起作用...元标记也不起作用，我不会接受 PHP 脚本中的 JS 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:30:57.250

这就是问题

```
header('Location:/Root/folder'); 
```

php`header()`需要绝对路径

采用

```
 header('Location: http://www.domain.com/Root/folder/something.php'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:54:24.723

不要忘记http://

```
header('Location: http://www.domain.com/Root/folder/something.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:32:02.757

使用`die()`后`header()`功能。

# objective-c - -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 没有被调用的可能原因是什么？

> ID：12884691
> 
> 赞同：0
> 
> 时间：2012-10-14T17:29:40.510
> 
> 标签：objective-c

我遇到了一个非常奇怪的问题。

我的 tableView 设置了所有委托和数据源。

一切安好。

但是，单击行不会激活：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

我使用了自定义单元格。

在我单击并单击并单击并单击并单击后，有时它会通过。

我想知道什么可能导致这种情况？就好像 customCell 正在“吸收”触摸事件或其他什么？

这可能是为什么？如果是这样，如果我们要实现 customCell 并且希望 tableView 处理 touch up 事件，我们应该怎么做？

附加症状：

如果我从自定义单元格中删除启用的用户交互，那么问题就可以通过捕获来解决。

![在此处输入图像描述](../Images/bb5f5fc7b92b16f5c92c87ec59a58e0e.png)

但是，单击该按钮会以某种方式清除 customCell 中的所有标签文本。

![在此处输入图像描述](../Images/a5a0ce3065bfa71e211b0657091016d6.png)

自定义 Cell 的实现如下：

```
- (BGUIBusinessCellForDisplay *) initWithBiz: (Business *) biz
{
    if (self.biz == nil) //First time set up
    {
        self = [super init]; //If use dequeueReusableCellWithIdentifier then I shouldn't change the address self points to right
        NSString * className = NSStringFromClass([self class]);
        //PO (className);
        [[NSBundle mainBundle] loadNibNamed:className owner:self options:nil];
        self.frame =self.view.frame;
        [self addSubview:self.view]; //What is this for? self.view is of type BGCRBusinessForDisplay2\. That view should be self, not one of it's subview Things don't work without it though
    }
    if (biz==nil)
    {
        return self;
    }

    _biz = biz;

    self.prominentLabel.text = [NSString stringWithFormat:@"Isi: %@", biz.isiString];
    self.Title.text = biz.Title; //Let's set this one thing first
    self.Address.text=biz.ShortenedAddress;

    //if([self.distance isNotEmpty]){
    self.DistanceLabel.text=[NSString stringWithFormat:@"%dm",[biz.Distance intValue]];
    self.PinNumber.text =biz.StringPinLineAndNumber;
    NSString * URLString=nil;
    if(biz.Images.allObjects.count!=0){
        //self.boolImage=[NSNumber numberWithBool:true];
        Image * image=(biz.Images.allObjects)[0];
        URLString = image.URL;
        URLString = [NSString stringWithFormat:@"http://54.251.34.144/thumbnailer/Thumbnailer.ashx?imageURL=%@",URLString.UTF8Encode];
        //url=[NSURL URLWithString:image.URL];
    }else{
        float latitude = biz.getCllLocation.coordinate.latitude;
        float longitude = biz.getCllLocation.coordinate.longitude;
        URLString = [NSString stringWithFormat:@"http://maps.googleapis.com/maps/api/staticmap?&zoom=16&size=160x160&maptype=roadmap&sensor=true&center=%f,%f&markers=size:small|color:blue|%f,%f",latitude,longitude,latitude,longitude];
        URLString = URLString.UTF8Encode;

    }

    //Should add code and add loading indicator here
    [BGHPTools doBackground:^{
        UIImage * imageBiz = [BGMDImageCacherAndDownloader getImageFromURL:URLString];

        [BGHPTools doForeGround:^{
            self.Image.image=imageBiz;
            [self.Image makeRound];
        }];
    }];

    //self.view=self.view;

    /*if (self.tableViewCell == Nil)//Instantiate that tableviewCell
    {
        PO(self.tableViewCell);
    }
    self.tableViewCell.business = bis;
    self.pinLbl.text = bis.StringPinLineAndNumber;
    self.lblTitle.text=bis.Title;
    //self.pinLbl.text=bis.pinNumber;*/
    //}
    /*self.name=[dict objectForKey:@"Title"];
     self.address=[dict objectForKey:@"Street"];
     CLLocation * cll=[[CLLocation alloc]initWithLatitude:[[dict objectForKey:@"Latitude"] doubleValue] longitude:[[dict objectForKey:@"Longitude"] doubleValue]];
     self.distance=[NSNumber numberWithDouble:[cll distanceFromLocation:[cachedProperties currentLocation]]];*/

    return self; 
```

更新：我已经弄清楚为什么文本消失了。原来我的背景是白色的。当一行被选中时，文本突然变成白色。所以通过将选定的样式设置为蓝色，我有点得到“固定”。

但是，如果选择了基础 tableViewCell，我仍然看不到我在代码中的哪个位置指定所有标签文本都应该是白色的。

毕竟，选择的是单元格，而不是标签。该标签怎么知道它必须变白，这超出了我的理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:49:30.363

最有可能的是自定义单元格中的视图正在吸收触摸。有时这正是您想要的，例如，一个按钮可以做某事，而不是选择整个单元格。假设您不想要这个，那么只需将这些视图的 userInteractionEnabled 属性设置为 NO。

--自定义NIB加载的附加代码。

您所要做的就是在您的 viewDidLoad 例程中注册 NIB：

```
[tableView registerNib: [UINib nibWithNibName:@"yourCellNibName" bundle:nil] forCellReuseIdentifier:@"yourCellTypeID"] 
```

然后在你的 cellForRowAtIndexPath 中调用：

```
newCell = [tableView dequeueReusableCellWithIdentifier @"yourCellTypeID"];
...
return newCell; 
```

它会从您的 XIB 中加载一个单元格（或者从之前使用的队列中给您一个单元格）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T20:03:33.987

如果您使用 Storyboard 来处理界面，而不是使用：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

尝试使用

```
#pragma mark --- Push selectedObject to the detailView ---

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    RRAppDelegate *myAppDelegate = [[UIApplication sharedApplication]delegate];
    if ([[segue identifier] isEqualToString:@"PushObjectSegue"]) {
        NSIndexPath *selectedRowIndex = [self.tableView indexPathForSelectedRow];
        RRObjectViewController *detailViewController = [segue destinationViewController];
        detailViewController.selectedObject = [myAppDelegate.goals  objectAtIndex:selectedRowIndex.row];
    }
} 
```

我对您使用的方法遇到了同样的问题，而是使用了这个，它开始完美地工作。当然，您必须使代码适应您的应用程序的 viewControllers 和数据源，因为我使用我的 AppDelegate 作为数据源，而且我没有使用自定义单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T02:23:11.410

我只是想更新一下，我认为我已经弄清楚了问题所在，但仍然不能完全正确地解决这个问题。而且更新是全面的，所以我认为它应该是一个答案，尽管我希望它不是答案，因为仍然缺少一些谜题。

所有的问题都是相互关联的。

问题出在这一行：

```
[self addSubview:self.view]; 
```

我基本上把它变成：

基本上，我的自定义视图单元格有一个类型也是 tableViewCell 的视图。该视图覆盖了真正的 tableViewCell。

这就是为什么当启用用户交互时，该视图将吸收用户的交互。

这也是标签“消失”的原因。发生的事情是标签不会消失。标签突出显示并变为白色。但是，突出显示的是 tableViewCell 而不是不透明的视图。白色的不透明 self.view 仍然是白色的，而 tableCell 本身是蓝色的。所以标签在白色背景中间变成白色并且消失了。

我想我应该将 [self addSubview:self.view] 替换为 self=self.view

然而，这将意味着改变自我的价值。是的，它在初始化中。但这仍然很尴尬。如果有人有办法用 XIB 实现 UI 的自定义子类，那就太好了，因为我到目前为止还没有找到。

尴尬的。

我想知道我们是否可以绘制一个指向 XIB 的指针并指定出口是 self 本身。

如果失败，我会将 self 的背景设置为白色，将 self.view 的背景设置为透明。

经过大量错误并尝试我这样做：

self.contentView.backgroundColor = [UIColor whiteColor]; //self.view.backgroundColor = [UIColor redColor]; self.frame =self.view.frame;

```
/*PO(self.view.subviews);
PO(self.subviews);
PO(self.Title.superview);
PO(self.Title);
PO(self.view);
PO(self.Title.superview);
PO(self.view.contentView);*/
//Suck all the subviews from my minions
for (UIView* aSubView in self.view.contentView.subviews) {
    [self.contentView addSubview: aSubView];
    //[self.contentView add]
} 
```

基本上我将我的视图对象的所有子视图“移动”到我的自我对象。虽然有一个问题，当子类化 tableViewCell 时，我应该移动 contentView 的子视图。谁知道为什么。

最后我只是将 self.view 设置为 nil ，因为它不再需要并且我的程序按预期工作。

另外要设置tableViewCell的背景，你还需要设置self.contentView的背景而不是self.view。

您可以尝试的另一种方法是使用故事板。或者，您可以将 self.view 的 contentView 移动到 self。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-14T19:29:42.683

确保您正在实施该方法而不是

```
deselectRowAtIndexPath:animated 
```

# mysql - 如何从我的 MySQL 表中删除类似的行？

> ID：12884692
> 
> 赞同：1
> 
> 时间：2012-10-14T17:29:51.587
> 
> 标签：mysql, sql, drupal, delete-row

我想在我的一个 MySQL Drupal 表中执行清理以删除存储的重复值。这是结构：

```
NID  VID   DELTA   FIELD_VALUE
100  100   0       foobar
100  100   1       foobar
101  101   0       barbar
101  101   1       barbar
102  102   0       foofoo 
```

我的目标是删除具有更大`DELTA`s 的行，如果`NID, VID, FIELD_VALUE`存在具有相同的行且具有较小的 s `DELTA`。

我的第一次尝试是以下查询：

`delete from mytable a where a.delta=1 and 1=(select count(nid) from mytable b where b.nid=a.nid and b.vid=a.vid and b.delta=0 and b.field_value=a.field_value)`

不幸的是，数据库说：（MySQL 5.1.65-cll）

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'a where a.delta=1 and 1 = (select count from `field_value` b where' at line 1 
```

这对我不是很有帮助。

更新：

一个已删除的答案告诉我 MySQL 不支持删除语句中的别名，但删除别名并没有帮助。子查询没问题，单独检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:48:46.327

这个怎么样？

```
DELETE a
FROM mytable a
JOIN mytable b ON (a.nid = b.nid
                AND a.vid = b.vid
                AND a.field_value = b.field_value)
WHERE a.delta > b.delta 
```

（不要忘记备份您的数据）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:56:45.550

在三列 () 上将表连接到自身`NID, VID, FIELD_VALUE`并选择 MAX 值`DELTA`。

只要您不涉及任何其他列，这将起作用。

[这是一个很好的例子](https://stackoverflow.com/a/4192849/1709629)

# android - Linux 上的图像到 MPEG 工作，Android 上的相同代码 = 绿色视频

> ID：12884693
> 
> 赞同：3
> 
> 时间：2012-10-14T17:29:59.597
> 
> 标签：android, ffmpeg

**编辑**
我检查了执行，发现错误不是（还）在 swscale 点。我当前的问题是找不到 JPG 图像：
`No such file or directory` 当`avformat_open_input(&pFormatCtx, imageFileName, NULL, NULL);`
你告诉我我需要注册任何东西之前，我可以告诉我已经注册了（我更新了下面的代码）。
我还添加了访问外部存储的 Android 权限（我认为它与 Android 无关，因为我已经可以写入图像所在的 /mnt/sdcard/）
**END EDIT**

我已经阅读了几个教程（包括从 SO 发布的几个教程，即[http://dranger.com/ffmpeg/](http://dranger.com/ffmpeg/)，如何为 Android 编译 ffmpeg...，通过 dolphin-player 源代码）。这是我所拥有的：
。为 android 编译 ffmpeg
。运行基本教程，使用 NDK 在我的 android 设备上创建虚拟视频
。能够使用上面的虚拟视频代码的修改版本和大量谷歌搜索从 Ubuntu 上的图像生成 MPEG2 视频
。在 Android 设备上运行新代码会提供绿屏视频（无论我编码多少帧，持续时间为 1 秒）

我在类似情况下看到另一篇关于 iPhone 的帖子，其中提到 ARM 处理器优化可能是罪魁祸首。我尝试了一些 ldextra-flags（-arch armv7-a 和类似的）都没有成功。

我在最后包含了加载图像的代码。Android 和 linux 有什么不同吗？我的 ffmpeg 构建是否不适合 Android 视频编码？

```
void copyFrame(AVCodecContext *destContext, AVFrame* dest,
            AVCodecContext *srcContext, AVFrame* source) {
struct SwsContext *swsContext;
swsContext = sws_getContext(srcContext->width, srcContext->height, srcContext->pix_fmt,
                destContext->width, destContext->height, destContext->pix_fmt,
                SWS_FAST_BILINEAR, NULL, NULL, NULL);
sws_scale(swsContext, source->data, source->linesize, 0, srcContext->height, dest->data, dest->linesize);
sws_freeContext(swsContext);
}

int loadFromFile(const char* imageFileName, AVFrame* realPicture, AVCodecContext* videoContext) {
AVFormatContext *pFormatCtx = NULL;
avcodec_register_all();
av_register_all();

int ret = avformat_open_input(&pFormatCtx, imageFileName, NULL, NULL);
if (ret != 0) {
    // ERROR hapening here
    // Can't open image file. Use strerror(AVERROR(ret))) for details
    return ERR_CANNOT_OPEN_IMAGE;
}

AVCodecContext *pCodecCtx;

pCodecCtx = pFormatCtx->streams[0]->codec;
pCodecCtx->width = W_VIDEO;
pCodecCtx->height = H_VIDEO;
pCodecCtx->pix_fmt = PIX_FMT_YUV420P;

// Find the decoder for the video stream
AVCodec *pCodec = avcodec_find_decoder(pCodecCtx->codec_id);
if (!pCodec) {
    // Codec not found
    return ERR_CODEC_NOT_FOUND;
}

// Open codec
if (avcodec_open(pCodecCtx, pCodec) < 0) {
    // Could not open codec
    return ERR_CANNOT_OPEN_CODEC;
}

// 
AVFrame *pFrame;

pFrame = avcodec_alloc_frame();

if (!pFrame) {
    // Can't allocate memory for AVFrame
    return ERR_CANNOT_ALLOC_MEM;
}

int frameFinished;
int numBytes;

// Determine required buffer size and allocate buffer
numBytes = avpicture_get_size(PIX_FMT_YUV420P, pCodecCtx->width, pCodecCtx->height);
uint8_t *buffer = (uint8_t *) av_malloc(numBytes * sizeof (uint8_t));

avpicture_fill((AVPicture *) pFrame, buffer, PIX_FMT_YUV420P, pCodecCtx->width, pCodecCtx->height);
AVPacket packet;
int res = 0;
while (av_read_frame(pFormatCtx, &packet) >= 0) {
    if (packet.stream_index != 0)
        continue;

    ret = avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);
    if (ret > 0) {
        // now, load the useful info into realPicture
        copyFrame(videoContext, realPicture, pCodecCtx, pFrame);
        // Free the packet that was allocated by av_read_frame
        av_free_packet(&packet);
        return 0;
    } else {
        // Error decoding frame. Use strerror(AVERROR(ret))) for details
        res = ERR_DECODE_FRAME;
    }
}
av_free(pFrame);

// close codec
avcodec_close(pCodecCtx);

// Close the image file
av_close_input_file(pFormatCtx);

return res;
} 
```

一些 ./config 选项：
`--extra-cflags="-O3 -fpic -DANDROID -DHAVE_SYS_UIO_H=1 -Dipv6mr_interface=ipv6mr_ifindex -fasm -Wno-psabi -fno-short-enums -fno-strict-aliasing -finline-limit=300 -mfloat-abi=softfp -mfpu=vfp -marm -march=armv7-a -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE"`

`--extra-ldflags="-Wl,-rpath-link=$PLATFORM/usr/lib -L$PLATFORM/usr/lib -nostdlib -lc -lm -ldl -llog"`

`--arch=armv7-a --enable-armv5te --enable-armv6 --enable-armvfp --enable-memalign-hack`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T03:15:37.397

一些指向 github 'android-ffmpeg' 的链接...

[https://github.com/halfninja/android-ffmpeg-x264](https://github.com/halfninja/android-ffmpeg-x264)

[https://github.com/guardianproject/android-ffmpeg](https://github.com/guardianproject/android-ffmpeg)

[https://github.com/rowntreerob/android-ffmpeg](https://github.com/rowntreerob/android-ffmpeg)

使用单个图片或一组图片制作 mpeg 的 CLI 指令...

[http://ffmpeg.org/faq.html#How-do-I-encode-single-pictures-into-movies_003f](http://ffmpeg.org/faq.html#How-do-I-encode-single-pictures-into-movies_003f)

因此，如果您需要从 jpg 输入输出 mpeg / mp4，那么它并不复杂到需要您深入了解 libavcodec 或任何地方的所有详细方法调用。

您可以使用 NDK 和工具链简单地将 ffmpeg 构建为 android 可执行文件，然后在有根手机上测试 CLI 表达式，然后，如果它们有效，请在您的真实 android 应用程序中使用包装器库来简单地调用 ffmpeg.main，如监护人中所述项目。

您必须绕开 ffmpeg.main exit() 的调用方式，但它是一个非常小的 tweek。

SO上有很多关于 android-ffmpeg 中的 CLI 类型调用的线程。

除非您真的需要低级的东西，否则我看不到在 android 实现中参与该代码的好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:50:04.200

上面的代码实际上是有效的。我在其他设备（三星 Galaxy Tab 7）上试过，没问题。该问题可能是由于 cyanomodgen 或特定的 Android 版本造成的。

# r - 使用 R 折叠数据框中的行

> ID：12884695
> 
> 赞同：13
> 
> 时间：2012-10-14T17:30:06.203
> 
> 标签：r, dataframe

我在 R 中有一个数据框，定义如下：

数据框：

`col 1  ``col 2  ``col 3 ``col4 `
`200    ``AIG   ``8.5   ``12   `
`800    ``AIG   ``8.1   ``20.1   `
`500    ``A1B   ``20   ``50.5   `
`800    ``A1B   ``12   ``30   `
`120    ``A2M   ``1.6   ``8.5   `

```
dat <- structure(list(col1 = c(200, 800, 500, 800, 120), col2 = structure(c(3L, 
    3L, 1L, 1L, 2L), .Label = c("A1B", "A2M", "AIG"), class = "factor"), 
        col3 = c(8.5, 8.1, 20, 12, 1.6), col4 = c(12, 20.1, 50.5, 
        30, 8.5)), .Names = c("col1", "col2", "col3", "col4"), row.names = c(NA, 
    -5L), class = "data.frame") 
```

然后我想按 id 折叠行（在这种情况下，唯一的 id 是 A1G、A1B、A2M）。
Col 1，我想通过添加具有相同 ID 的行来折叠它。
Col 2，我想将其折叠为每个唯一的 id
Col 3，我想将其折叠如下，取 col1*col3，将它们相加，然后将它们除以 col1 的总和。
即A1G新行值应该是(8.5*20+8.1*80)/(80+20)。也就是第 3 列的加权平均值，由 col1 的值加权。
Col 4，我想取最大值。

生成的数据框应如下所示：

`column 1  ``column 2  ``column 3 ``column 4 `
`800+200=1000    ``AIG   ``(8.5*200+8.1*800)/1000=8.18   ``max(12,20.1)=20.1   `
`800+500=1300    ``AIB   ``(20*800+12*500)/1300=16.9   ``max(50.5, 30)=50.5   `
`120    ``A2M   ``1.6   ``8.5   `

有什么建议么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-14T17:48:33.067

这是一个 data.table 解决方案，可以很好地扩展大数据（速度和内存效率）

```
library(data.table)
DT <- data.table(dat, key="col2")
DT[, list(col1=sum(col1), 
          col3=sum(col1 * col3) / sum(col1), 
          col4=max(col4)), by=col2]
#   col2 col1     col3 col4
#1:  A1B 1300 15.07692 50.5
#2:  A2M  120  1.60000  8.5
#3:  AIG 1000  8.18000 20.1 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-14T18:00:18.603

基础解决方案：

```
dat2<-do.call(rbind,
  by(dat,dat$col2, function(x) 
    with (x,
     data.frame(
       col1 = sum(col1),
       col3 = sum(col1 * col3) / sum(col1),
       col4 = max(col4)
     )
    )
  )
)
dat2$col2<-rownames(dat2)

#     col1     col3 col4 col2
# A1B 1300 15.07692 50.5  A1B
# A2M  120  1.60000  8.5  A2M
# AIG 1000  8.18000 20.1  AIG 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-14T17:41:11.757

使用`plyr`包：

```
library(plyr)
ddply(df, "col2", summarize, col1 = sum(col1),
                             col3 = sum(col1 * col3) / sum(col1),
                             col4 = max(col4))
#   col2 col1     col3 col4
# 1  A1B 1300 15.07692 50.5
# 2  A2M  120  1.60000  8.5
# 3  AIG 1000  8.18000 20.1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-14T18:01:54.277

一个基本解决方案，但我喜欢 data.table 解决方案：

```
dat[, 2] <- factor(dat[, 2], levels=unique(dat[, 2])) #in case not already ordered
L1 <- split(dat, dat$col2)                            #split into list by col2

funny <- function(x){                                 #function to calculate stuff
    x <- data.frame(x)
    c(col1=sum(x[,1]), col2=as.character(x[1, 2]), 
        col3=sum((x[, 3]*x[, 1]))/sum(x[, 1]),
        col4=max(x[,4]))
}

#apply function and wrap it up into dataframe
dat2 <- data.frame(do.call(rbind, lapply(L1, funny)), row.names=NULL) 
dat2[, -2] <- apply(dat2[, -2], 2, as.numeric)       #reapply classes    
dat2

#> dat2
#  col1 col2     col3 col4
#1 1000  AIG  8.18000 20.1
#2 1300  A1B 15.07692 50.5
#3  120  A2M  1.60000  8.5 
```

# r - RStudio 通过 SecureCRT

> ID：12884696
> 
> 赞同：0
> 
> 时间：2012-10-14T17:30:24.800
> 
> 标签：r, rstudio

我想设置 RStudio，以便它使用我通过 secureCRT 连接的远程 R 会话（控制台）。有没有办法通过隧道命令将它们直接从 RStudio 发送到该远程会话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T07:44:38.450

我不知道有什么方法可以做到这一点，但如果你的目标是让 R 会话远程运行在某个地方，你可以从任何地方连接到，那么这确实可以使用 RStudio。

设置[RStudio 服务器](http://www.rstudio.com/ide/docs/server/getting_started)——它将启动一个将 RStudio IDE 用作 Web 应用程序的 Web 服务器。从那里，您可以从任何 Web 浏览器连接到您的 R 会话（和 IDE 会话）。

# java - Eclipse 3.7.2 不适用于 java 1.7.0_07

> ID：12884700
> 
> 赞同：0
> 
> 时间：2012-10-14T17:30:58.670
> 
> 标签：java, eclipse

> **可能重复：**
> [Eclipse 无法加载 SWT 库](https://stackoverflow.com/questions/10165693/eclipse-cannot-load-swt-libraries)

我有 ubuntu 12.04，默认 jdk 1.6.0_24 和 eclipse indigo 3.7.2。现在，出于学习原因，我必须使用新的 java jdk 1.7.0_07，所以我更新了 jdk，如下所示：

```
sudo add-apt-repository ppa:webupd8team/java
sudo apt-get update
sudo apt-get install oracle-java7-installer 
```

并且 java 在 1.7.0_07 正确更新。问题是现在 Eclipse 现在可以工作了。当我启动它时，我收到了这个错误：

```
An error has occurred. See the log file
/home/kira/.eclipse/org.eclipse.platform_3.7.0_155965261/configuration/1350235337372.log 
```

所以我不得不再次降级java 1.6.0_24。我也尝试通过从 oracle 下载源代码然后更改 PATH 变量来安装它，但结果是一样的。

为什么日食不再工作了？请帮帮我，我要开始一个项目，我必须使用新的 java。这是日志：

```
!SESSION 2012-10-14 19:25:10.631 -----------------------------------------------
eclipse.buildId=I20110613-1736
java.version=1.7.0_07
java.vendor=Oracle Corporation
BootLoader constants: OS=linux, ARCH=x86, WS=gtk, NL=it_IT
Command-line arguments:  -os linux -ws gtk -arch x86

!ENTRY org.eclipse.osgi 4 0 2012-10-14 19:25:14.472
!MESSAGE Application error
!STACK 1
java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
no swt-gtk-3740 in java.library.path
no swt-gtk in java.library.path
Can't load library: /home/kira/.swt/lib/linux/x86/libswt-gtk-3740.so
Can't load library: /home/kira/.swt/lib/linux/x86/libswt-gtk.so

at org.eclipse.swt.internal.Library.loadLibrary(Library.java:285)
at org.eclipse.swt.internal.Library.loadLibrary(Library.java:194)
at org.eclipse.swt.internal.C.<clinit>(C.java:21)
at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63)
at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54)
at org.eclipse.swt.widgets.Display.<clinit>(Display.java:132)
at org.eclipse.ui.internal.Workbench.createDisplay(Workbench.java:695)
at org.eclipse.ui.PlatformUI.createDisplay(PlatformUI.java:161)
at org.eclipse.ui.internal.ide.application.IDEApplication.createDisplay(IDEApplication.java:153)
at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:95)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at 
```

org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79) 中的 org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)。 core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344) 在 org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179) 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) at java.lang.reflect.Method.invoke(Method.java:601) at org.eclipse .equinox.launcher.Main.invokeFramework(Main.java:622) 在 org.eclipse.equinox.launcher.Main.basicRun(Main.java:577) 在 org.eclipse.equinox.launcher.Main。运行（Main.java:1410）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:23:17.967

Eclipse 可以为您的程序使用不同的 JVM，而不是它自己运行的 JVM（这是维护旧程序时非常有用的特性）。

您可以直接从 Oracle 下载适用于您平台的 Oracle Java（只是解压到一个目录，而不是打算由包管理器安装的那个），然后运行它以接受许可证并解压到一个目录。

然后，您可以将该目录添加到 Installed JRE 的首选项面板，并将其检查为默认 JVM。然后，您的应用程序将使用该 JVM 而不是用于运行 Eclipse 的 JVM 进行编译。

（错误消息的原因是因为 Eclipse 使用了与您的升级尝试不匹配的本机库（C 而不是 Java））

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:33:12.477

您可以使用 java 1.6 运行 eclipse，对于 eclipse 中的 java 项目，您可以将 jdk 配置为 java 1.7

将 java 7 添加到 eclipse jre 列表，preferences > java > installed jre > Add 并使其成为默认值

# c# - 多个变量的撤消/重做实现

> ID：12884703
> 
> 赞同：1
> 
> 时间：2012-10-14T17:31:58.090
> 
> 标签：c#, inheritance, command, undo-redo, memento

我正在尝试重构我拥有的撤消/重做实现，但不确定如何去做。

```
public class MyObject
{
    public int A;
    public int B;
    public int C;
}

public abstract class UndoRedoAction
{
    protected MyObject myobj;
    protected int oldValue;
    protected int newValue;

    public abstract void Undo();
    public abstract void Redo();
}

public class UndoRedoActionA : UndoRedoAction
{
    UndoRedoActionA(MyObject obj, int new)
    {
        myobj = obj;
        oldValue = myobj.A;
        newValue = new;
        myobj.A = newValue;
    }

    public override void Undo()
    {
        myobj.A = oldValue;
    }

    public override void Redo()
    {
        myobj.A = newValue;
    }    
}

public class UndoRedoActionB : UndoRedoAction
{
    UndoRedoActionB(MyObject obj, int new)
    {
        myobj = obj;
        oldValue = myobj.B;
        newValue = new;
        myobj.B = newValue;
    }

    public override void Undo()
    {
        myobj.B = oldValue;
    }

    public override void Redo()
    {
        myobj.B = newValue;
    }    
}

public class UndoRedoActionC : UndoRedoAction
{
    UndoRedoActionC(MyObject obj, int new)
    {
        myobj = obj;
        oldValue = myobj.C;
        newValue = new;
        myobj.C = newValue;
    }

    public override void Undo()
    {
        myobj.C = oldValue;
    }

    public override void Redo()
    {
        myobj.C = newValue;
    }    
} 
```

显然，每个 UndoRedoAction 子类在访问不同字段时都具有自定义功能，但它们在这些字段上执行的功能是相同的。是否有任何干净的方法，除了将这些整数转换为属性并传递属性名称（我宁愿不这样做，魔术字符串等），将它们组合成一个通用的 UndoRedoAction 而不是制作一堆所有执行的子类对不同变量执行完全相同的操作？

我确实考虑过使用 Memento 模式来解决这个问题，但是对于这么小的场景来说，这似乎有点矫枉过正，而且我没有需要担心的单向操作，这正是 Memento 模式真正有用的地方。

谢谢。

**澄清：**这些 UndoRedoAction 对象被放置在一个 Stack<UndoRedoAction> 中，该 Stack<UndoRedoAction> 用作撤消缓存。更具体地说，有两个堆栈，一个用于撤消，一个用于重做，从一个弹出的操作被推送到另一个。此外，针对 Zaid Masud 的回应，变量不一定都是整数，甚至不一定都是相同的对象类型。我的例子只是为了简单起见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T21:46:17.027

您可以通过使用动态方法或表达式来避免反射，以基于选择器表达式（如`x => x.SomeProperty`.

基本上你想做这样的事情：

```
public class PropertySetActionProvider<TObj, TProp>
{
    private Func<TObj, TProp> _getter;
    private Action<Tbj, TProp> _setter;

    public PropertySetActionProvider(Expression<Func<TObj, TProp>> propertySelector)
    {
        _getter = propertySelector.Compile();
        _setter = SetterExpressionFromGetterExpression(propertySelector).Compile(); 
    }

    public IUndoRedoAction CreateAction(TObj target, TProp newValue)
    {
        var oldValue = _getter(target);
        return new PropertySetAction<TObj, TProp>(_setter, target, oldValue, newValue);             
    }
}

public class PropertySetAction<TObj, TProp> : IUndoRedoAction 
{
   private Action<TObj, TProp> _setter;
   private TObj _target;
   private TProp _oldValue;
   private TProp _newValue;

   public PropertySetAction(Action<TObj, TProp> setter, TObj target, TProp oldValue, TProp newValue)
   {
        _setter = setter; 
        _target = target; 
        _oldValue = oldValue; 
        _newValue = newValue;
   }

   public void Do() 
   {
       _setter(_target, _newValue);
   }  

   public void Undo() 
   {
       _setter(_target, _oldValue);
   }   
} 
```

然后，您可以使用如下代码轻松创建新操作：

```
 // create the action providers once per property you'd like to change
  var actionProviderA = new PropertySetActionProvider<MyObject, int>(x => x.A);
  var actionProviderB = new PropertySetActionProvider<MyObject, string>(x => x.B);

  var someObject = new MyObject { A = 42, B = "spam" };
  actions.Push(actionProviderA.CreateAction(someObject, 43);
  actions.Push(actionProviderB.CreateAction(someObject, "eggs");
  actions.Push(actionProviderA.CreateAction(someObject, 44);
  actions.Push(actionProviderB.CreateAction(someObject, "sausage");

  // you get the point 
```

唯一困难的部分是从 getter 表达式（`SetterExpressionFromGetterExpression`上面的方法）创建一个 setter 表达式，但这是一个已知已解决的问题。有关如何执行此操作的问题，请参见[此处](https://stackoverflow.com/questions/7723744/expressionfunctmodel-string-to-expressionactiontmodel-getter-to-sette)和[此处](https://stackoverflow.com/questions/2823236/creating-a-property-setter-delegate)的示例。

在这种方法中，从表达式编译 getter/setter 委托的成本仅在您创建操作提供程序时发生一次，而不是每次您创建操作或调用`Redo`或`Undo`在一个操作时。

如果您想进一步优化，您可以`propertySelector`在操作构造函数中移动参数，并在后台按需创建操作提供程序并基于每个属性进行缓存。这将产生一些更容易使用的代码，但实现起来可能更棘手。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:54:09.910

对于这种问题，我更喜欢使用`Stack<T>`or`List<T>`并将我的整个对象复制到其中。这允许拥有比一个更多的撤消缓存，并且很简单。我使用此模型允许用户 10 撤消复杂对象。顺便说一句，这需要可序列化的类用法。这是我的代码，用于制作我的课程的精确副本：

```
 private T DeepCopy<T>(T obj)
    {
        object result = null;
        if (obj == null)
        {
            return (T)result;
        }
        using (var ms = new MemoryStream())
        {
            var formatter = new BinaryFormatter();
            formatter.Serialize(ms, obj);
            ms.Position = 0;

            result = (T)formatter.Deserialize(ms);
            ms.Close();
        }

        return (T)result;
    } 
```

编辑：对于 List 的简单用法

```
 List<MyClass> UndoCache = new List<MyClass>();
    MyClass myRealObject;
    int unDoCount = 10;
       void Undo()
    {
        myRealObject = UndoCache.Last();
        //remove this object from cache.
        UndoCache.RemoveAt(UndoCache.Count - 1);
    } 
```

//当你的对象改变时调用这个方法

```
 void ObjectChanged()
    {
        //remove the first item if we reach limit
        if (UndoCache.Count > unDoCount)
        {
            UndoCache.RemoveAt(0);
        }
        UndoCache.Add(DeepCopy<MyClass>(myRealObject));
    }
    public class MyClass { } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:41:30.320

我想如果其中的所有字段`MyObject`都`int`与您的代码示例中的一样，您可以将它们转换为固定长度的数组。代码示例（未编译）

```
public class MyObject
{
    public const int ARRAY_LENGTH = 3;
    public int[] Ints = new int[ARRAY_LENGTH]
}

public abstract class UndoRedoAction
{
    private MyObject myobj;
    private int oldValues = new int[MyObject.ARRAY_LENGTH];
    private int newValues = new int[MyObject.ARRAY_LENGTH];

    public UndoRedoAction(MyObject obj)
    {
        myobj = obj;
    }

    public void SetValue(int index, int newValue)
    {
        oldValues[index] = myObj.Ints[index];
        newValues[index] = newValue;
        myObj.Ints[index] = newValue;
    }

    public void Undo(int index)
    {
        myObj.Ints[index] = oldValues[index];
    }

    public void Redo(int index)
    {
        myObj.Ints[index] = newValues[index];
    }
} 
```

# ruby - 如何使用 Ruby 的邮件 gem 通过 smtp 发送电子邮件？

> ID：12884711
> 
> 赞同：41
> 
> 时间：2012-10-14T17:32:22.243
> 
> 标签：ruby, email, smtp

我正在为 Ruby [https://github.com/mikel/mail](https://github.com/mikel/mail)`mail`使用gem

如何通过 smtp 服务器发送电子邮件？如何指定地址和端口？我应该为 Gmail 使用哪些设置？

`README`github 上的仅给出本地服务器发送的示例。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2012-10-14T17:38:06.383

来自[http://lindsaar.net/2010/3/15/how_to_use_mail_and_actionmailer_3_with_gmail_smtp](http://lindsaar.net/2010/3/15/how_to_use_mail_and_actionmailer_3_with_gmail_smtp)

要通过 GMail 发送，您需要将`Mail::SMTP`类配置为具有正确的值，因此要尝试此操作，请打开 IRB 并键入以下内容：

```
require 'mail'

options = { :address              => "smtp.gmail.com",
            :port                 => 587,
            :domain               => 'your.host.name',
            :user_name            => '<username>',
            :password             => '<password>',
            :authentication       => 'plain',
            :enable_starttls_auto => true  }

Mail.defaults do
  delivery_method :smtp, options
end 
```

最后一个块调用`Mail.defaults`它允许我们为从现在开始创建的所有邮件对象设置全局传递方法。高级用户提示，您不必使用全局方法，您可以直接在任何单个`Mail::Message`对象上定义 delivery_method，并且每封电子邮件有不同的交付代理，如果您正在构建一个具有多个用户和不同服务器处理的应用程序，这很有用他们的电子邮件。

```
Mail.deliver do
       to 'mikel@test.lindsaar.net'
     from 'ada@test.lindsaar.net'
  subject 'testing sendmail'
     body 'testing sendmail'
end 
```

# c - 如何检查C中的array [index] ==“someString”？

> ID：12884718
> 
> 赞同：0
> 
> 时间：2012-10-14T17:32:48.590
> 
> 标签：c, arrays, fgets, strtok

> **可能重复：**
> [如何正确比较 C 中的字符串？](https://stackoverflow.com/questions/8004237/how-do-i-properly-compare-strings-in-c)

我昨天开始 C 编程，所以我对这门语言很陌生。我正在使用 fget() 接收用户输入，然后使用 strtok() 对输入进行标记。我正在尝试查看输入的第一个单词是否等于“exit”，此时程序将退出。由于某种原因，它不起作用。这是我的代码。

```
#include <stdio.h>
#include <string.h>

#define MAX_LINE 1024
#define MAX_TOKEN 64
#define SEPARATORS " \t\n"

main(){

    char line[MAX_LINE];
    char *token[MAX_TOKEN];
    int loop = 1;
    int i;

    while (loop != 0){
            fgets(line, sizeof(line), stdin);
                    token[0] = strtok(line, SEPARATORS);
                    printf("token[0] = %s\n", token[0]);

                    if (token[0] == "exit"){
                            printf("%s", "Beep Boop Boop Boop");
                            loop = 0;
                    }

                    for (i = 0; token[i] = strtok(NULL, SEPARATORS); i++){
                            printf("token[%d] = %s\n", i, token[i]);
                    }
    }
} 
```

以下代码无法正常工作。

```
if (token[0] == "exit"){
      printf("%s", "Beep Boop Boop Boop");
      loop = 0;  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:35:09.863

尝试这个 ：

```
if (strcmp(token[0],"exit")!=0){
  printf("%s", "Beep Boop Boop Boop");
  loop = 0;  
} 
```

# java - 叠加层中的 onTap 事件

> ID：12884727
> 
> 赞同：2
> 
> 时间：2012-10-14T17:33:39.480
> 
> 标签：java, android, google-maps

谁能帮助我使用此代码实现 ontap() 事件？下面的代码将在谷歌地图中显示用户的当前位置和酒吧位置。该代码工作正常。但我的问题是我不知道如何实现 ontap() 事件。即使我的覆盖在 oncreate 包之外，是否可以实现 onTap 事件？

```
 import java.util.ArrayList;
    import java.util.List;
    import org.apache.http.NameValuePair;
    import org.json.JSONArray;
    import org.json.JSONException;
    import org.json.JSONObject;
    import android.content.Context;
    import android.content.Intent;
    import android.graphics.Bitmap;
    import android.graphics.BitmapFactory;
    import android.graphics.Canvas;
    import android.graphics.Point;
    import android.location.Location;
    import android.location.LocationListener;
    import android.location.LocationManager;
    import android.os.AsyncTask;
    import android.os.Bundle;
    import android.util.Log;
    import android.view.Menu;
    import android.view.MenuInflater;
    import android.view.MenuItem;
    import android.widget.Button;
    import com.google.android.maps.GeoPoint;
    import com.google.android.maps.MapActivity;
    import com.google.android.maps.MapController;
    import com.google.android.maps.MapView;
    import com.google.android.maps.MyLocationOverlay;
    import com.google.android.maps.Overlay;
    import com.google.android.maps.OverlayItem;

    public class BarLocatorActivity extends MapActivity {
         Button map1,login1,menu1,power1;        
        // Creating JSON Parser object
        JSONNorman jNorman = new JSONNorman();

        private static String url_all_bar =
      "http://xxx.xxx.xxx.xxx/xampp/BARANDROID/get_all_bars.php";

        // JSON Node names
        private static final String TAG_SUCCESS = "success";
        private static final String TAG_BARS = "bars";
        private static final String TAG_BARLAT = "bar_lat";
        private static final String TAG_BARLONG = "bar_long";

        // bars JSONArray
        JSONArray bars = null;

        private MapController mapController;
        private MapView mapView;
        private LocationManager locationManager;
        private MyLocationOverlay myLocationOverlay;

        public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.map); // bind the layout to the activity

        // Configure the Map
        mapView = (MapView) findViewById(R.id.mapView);
        mapView.setBuiltInZoomControls(true);
        // enable Street view by default
        mapView.setStreetView(true);

       // mapView.setSatellite(true);

        // enable to show Traffic on map
        // mapView.setTraffic(true);
        mapController = mapView.getController();
        mapController.setZoom(15); // Zoon 1 is world view
        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0,
            0, new GeoUpdateHandler());

        myLocationOverlay = new MyLocationOverlay(this, mapView);
        mapView.getOverlays().add(myLocationOverlay);

        myLocationOverlay.runOnFirstFix(new Runnable() {
          public void run() {

            mapView.getController().animateTo(myLocationOverlay.getMyLocation());
          }
        });
        new LoadAllBars().execute();
      }

      /* Initiating Menu XML file (menu.xml) */
      @Override
      public boolean onCreateOptionsMenu(Menu menu)
      {
          MenuInflater menuInflater = getMenuInflater();
          menuInflater.inflate(R.layout.menu, menu);
          return true;
      }

      /**
       * Event Handling for Individual menu item selected
       * Identify single menu item by it's id
       * */
      @Override
      public boolean onOptionsItemSelected(MenuItem item)
      {

          switch (item.getItemId())
          {

          case R.id.view:
              BarLocatorActivity.this.finish();
              Intent intent1 = new Intent(getApplicationContext(), 
                   AllBarActivity.class);
              startActivity(intent1);
              android.os.Process.killProcess(android.os.Process.myPid());
                System.exit(0);
              return true;

          case R.id.map1:
              BarLocatorActivity.this.finish();
              Intent intent2 = new Intent(getApplicationContext(), BarLocatorActivity.class);
              startActivity(intent2);
              android.os.Process.killProcess(android.os.Process.myPid());
                System.exit(0);
              return true;

          case R.id.login:
              BarLocatorActivity.this.finish();
              Intent intent3 = new Intent(getApplicationContext(), 
                  SignInActivity.class);
                  startActivity(intent3);
                  android.os.Process.killProcess(android.os.Process.myPid());
                System.exit(0); 
                return true;

          case R.id.exit:                       
                        BarLocatorActivity.this.finish();   
                        // The following makes the Android Gods frown upon me
                        android.os.Process.killProcess(android.os.Process.myPid());
                        System.exit(0);         
              return true;
          default:
              return super.onOptionsItemSelected(item);
          }
      }

      @Override
      protected boolean isRouteDisplayed() {
        return false;
      }

      public class GeoUpdateHandler implements LocationListener {

        @Override
        public void onLocationChanged(Location location) {
          int lat = (int) (location.getLatitude() * 1E6);
          int lng = (int) (location.getLongitude() * 1E6);
          GeoPoint point = new GeoPoint(lat, lng);  
          mapController.animateTo(point); // mapController.setCenter(point);

        }

        @Override
        public void onProviderDisabled(String provider) {
        }

        @Override
        public void onProviderEnabled(String provider) {
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
        }
      }

      @Override
      protected void onResume() {
        super.onResume();
        myLocationOverlay.enableMyLocation();
        myLocationOverlay.enableCompass();
      }

      @Override
      protected void onPause() {
        super.onPause();
        myLocationOverlay.disableMyLocation();
        myLocationOverlay.disableCompass();
      }

    //bar location
      class LoadAllBars extends AsyncTask<String, String, String> {
          protected String doInBackground(String... args) {

              List<NameValuePair> params = new ArrayList<NameValuePair>();
              JSONObject json = jNorman.makeHttpRequest(url_all_bar, "GET", params);

              Log.d("All bars: ", json.toString());

              try {
                  // Checking for SUCCESS TAG
                  int success = json.getInt(TAG_SUCCESS);

                  if (success == 1) {
                      bars = json.getJSONArray(TAG_BARS);                   

                      for (int i = 0; i < bars.length(); i++) {                     
                          JSONObject c = bars.getJSONObject(i);
                          String bar_lat = c.getString(TAG_BARLAT);  
                          String bar_long = c.getString(TAG_BARLONG);  
                          double latt = Double.parseDouble(bar_lat);
                          double lngg = Double.parseDouble(bar_long);

                        GeoPoint points = new GeoPoint((int) (latt * 1E6),(int) (lngg * 
                        1E6));
                        MapOverlay mapOverlay = new MapOverlay();
                    mapOverlay.setPointToDraw(points);
                    List<Overlay> listOfOverlays = mapView.getOverlays();           
                    listOfOverlays.add(mapOverlay);
                          }                     
                  }     

              } catch (JSONException e) {
                  e.printStackTrace();
              }

              return null;
          }  
      }

      //end bar location

      //overlay

      class MapOverlay extends Overlay {
        private GeoPoint pointToDraw;

        public void setPointToDraw(GeoPoint points) {
            pointToDraw = points;
        }

        public GeoPoint getPointToDraw() {
            return pointToDraw;
        }

          @Override
          public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) {
              super.draw(canvas, mapView, shadow);                   

              // convert point to pixels
              Point screenPts = new Point();
              mapView.getProjection().toPixels(pointToDraw, screenPts);
              // add marker
              Bitmap bmp = BitmapFactory.decodeResource(getResources(), R.drawable.red);
              canvas.drawBitmap(bmp, screenPts.x, screenPts.y - 24, null);          
              return true;
          }  
      } 

    } 

    thanks in advance:) 
```

# wpf - EntLib 日志记录 - 无法将 TextFormatterData 类型的对象转换为 FormatterData 类型

> ID：12884730
> 
> 赞同：1
> 
> 时间：2012-10-14T17:33:54.490
> 
> 标签：wpf, logging, .net-4.0, configuration, enterprise-library

我正在尝试使用 Enterprise Library 5.0 为 WPF 应用程序设置日志记录，但出现以下错误：

```
System.Configuration.ConfigurationErrorsException was unhandled
  HResult=-2146232062
  Message=An error occurred creating the configuration section handler for loggingConfiguration: Unable to cast object of type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.TextFormatterData' to type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FormatterData'. (C:\Users\tomhu_000\Documents\GitHub\SourceLog\SourceLog.UI\bin\Debug\SourceLog.vshost.exe.Config line 16)
  Source=System.Configuration
  BareMessage=An error occurred creating the configuration section handler for loggingConfiguration: Unable to cast object of type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.TextFormatterData' to type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FormatterData'.
  Filename=C:\Users\tomhu_000\Documents\GitHub\SourceLog\SourceLog.UI\bin\Debug\SourceLog.vshost.exe.Config
  Line=16
  StackTrace:
       at System.Configuration.BaseConfigurationRecord.EvaluateOne(String[] keys, SectionInput input, Boolean isTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult)
       at System.Configuration.BaseConfigurationRecord.Evaluate(FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult, Boolean getLkg, Boolean getRuntimeObject, Object& result, Object& resultRuntimeObject)
       at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
       at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
       at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
       at System.Configuration.BaseConfigurationRecord.GetSection(String configKey)
       at System.Configuration.ClientConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String sectionName)
       at System.Configuration.ConfigurationManager.GetSection(String sectionName)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.SystemConfigurationSource.DoGetSection(String sectionName)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.FileBasedConfigurationSource.GetSection(String sectionName)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.ConfigSectionLocator.GetRegistrationsInternal(IConfigurationSource configurationSource, Func`3 registrationsAccessor)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.ConfigSectionLocator.GetRegistrations(IConfigurationSource configurationSource)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.CompositeTypeRegistrationsProviderLocator.<GetRegistrations>b__0(ITypeRegistrationsProvider l, IConfigurationSource cs)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.CompositeTypeRegistrationsProviderLocator.<>c__DisplayClass5.<GetRegistrationsInternal>b__4(ITypeRegistrationsProvider l)
       at System.Linq.Enumerable.<SelectManyIterator>d__14`2.MoveNext()
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.Unity.UnityContainerConfigurator.RegisterAllCore(IConfigurationSource configurationSource, ITypeRegistrationsProvider rootProvider)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.ContainerModel.ChangeTrackingContainerConfigurator.RegisterAll(IConfigurationSource configurationSource, ITypeRegistrationsProvider rootProvider)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.ConfigureContainer(ITypeRegistrationsProvider locator, IContainerConfigurator configurator, IConfigurationSource configSource)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.ConfigureContainer(IContainerConfigurator configurator, IConfigurationSource configSource)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.CreateDefaultContainer(IConfigurationSource configurationSource)
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.CreateDefaultContainer()
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.SetCurrentContainerIfNotSet()
       at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.EnterpriseLibraryContainer.get_Current()
       at Microsoft.Practices.EnterpriseLibrary.Logging.Logger.get_Writer()
       at Microsoft.Practices.EnterpriseLibrary.Logging.Logger.Write(LogEntry log)
       at SourceLog.Model.LogSubscription.LogProvider_LogProviderException(Object sender, LogProviderExceptionEventArgs e) in C:\Users\tomhu_000\Documents\GitHub\SourceLog\SourceLog.Model\LogSubscription.cs:line 73
       at SourceLog.Plugin.TeamFoundationServer2010.TeamFoundationServer2010Plugin.CheckForNewLogEntries(Object state) in C:\Users\tomhu_000\Documents\GitHub\SourceLog\SourceLog.Plugin.TeamFoundationServer2010\TeamFoundationServer2010Plugin.cs:line 123
       at System.Threading.TimerQueueTimer.CallCallbackInContext(Object state)
       at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
       at System.Threading.TimerQueueTimer.CallCallback()
       at System.Threading.TimerQueueTimer.Fire()
       at System.Threading.TimerQueue.FireNextTimers()
       at System.Threading.TimerQueue.AppDomainTimerCallback()
  InnerException: System.InvalidCastException
       HResult=-2147467262
       Message=Unable to cast object of type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.TextFormatterData' to type 'Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FormatterData'.
       Source=Microsoft.Practices.EnterpriseLibrary.Common
       StackTrace:
            at Microsoft.Practices.EnterpriseLibrary.Common.Configuration.PolymorphicConfigurationElementCollection`1.OnDeserializeUnrecognizedElement(String elementName, XmlReader reader)
            at System.Configuration.ConfigurationElement.DeserializeElement(XmlReader reader, Boolean serializeCollectionKey)
            at System.Configuration.ConfigurationElement.DeserializeElement(XmlReader reader, Boolean serializeCollectionKey)
            at System.Configuration.ConfigurationSection.DeserializeSection(XmlReader reader)
            at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.CreateSectionImpl(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)
            at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.CreateSectionWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)
            at System.Configuration.RuntimeConfigurationRecord.CreateSection(Boolean inputIsTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)
            at System.Configuration.BaseConfigurationRecord.CallCreateSection(Boolean inputIsTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader, String filename, Int32 line)
       InnerException: 
```

这是我的配置：

```
<loggingConfiguration name="" tracingEnabled="true" defaultCategory="General">
    <listeners>
        <add name="Event Log Listener" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.FormattedEventLogTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
         listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.FormattedEventLogTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
         source="Enterprise Library Logging" formatter="Text Formatter"
         log="" machineName="." traceOutputOptions="None" filter="Error" />
        <add name="Rolling Flat File Trace Listener" type="Microsoft.Practices.EnterpriseLibrary.Logging.TraceListeners.RollingFlatFileTraceListener, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
         listenerDataType="Microsoft.Practices.EnterpriseLibrary.Logging.Configuration.RollingFlatFileTraceListenerData, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
         fileName="app.log" formatter="Text Formatter" rollFileExistsBehavior="Increment"
         rollInterval="Midnight" maxArchivedFiles="14" traceOutputOptions="Callstack" />
    </listeners>
    <formatters>
        <add type="Microsoft.Practices.EnterpriseLibrary.Logging.Formatters.TextFormatter, Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.414.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
         template="Timestamp: {timestamp}{newline}&#xA;Message: {message}{newline}&#xA;Category: {category}{newline}&#xA;Priority: {priority}{newline}&#xA;EventId: {eventid}{newline}&#xA;Severity: {severity}{newline}&#xA;Title:{title}{newline}&#xA;Machine: {localMachine}{newline}&#xA;App Domain: {localAppDomain}{newline}&#xA;ProcessId: {localProcessId}{newline}&#xA;Process Name: {localProcessName}{newline}&#xA;Thread Name: {threadName}{newline}&#xA;Win32 ThreadId:{win32ThreadId}{newline}&#xA;Extended Properties: {dictionary({key} - {value}{newline})}"
         name="Text Formatter" />
    </formatters>
    <categorySources>
        <add switchValue="All" name="General">
            <listeners>
                <add name="Event Log Listener" />
            </listeners>
        </add>
    </categorySources>
    <specialSources>
        <allEvents switchValue="All" name="All Events">
            <listeners>
                <add name="Rolling Flat File Trace Listener" />
            </listeners>
        </allEvents>
        <notProcessed switchValue="All" name="Unprocessed Category" />
        <errors switchValue="All" name="Logging Errors &amp; Warnings">
            <listeners>
                <add name="Event Log Listener" />
            </listeners>
        </errors>
    </specialSources>
</loggingConfiguration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T20:20:33.133

配置部分中的程序集引用没有引用我拥有的 DLL 的正确版本。更新为

```
Microsoft.Practices.EnterpriseLibrary.Logging, Version=5.0.505.0 
```

它有效。

# visual-studio-2010 - 项目模板中的嵌套文件

> ID：12884732
> 
> 赞同：1
> 
> 时间：2012-10-14T17:34:20.270
> 
> 标签：visual-studio-2010, visual-studio

我正在尝试创建一个 Visual Studio 项目模板，该模板将创建一个 WPF 窗口，其中包含视图模型的附件

像下面这样

VMWindow.xaml ---VMWindow.xaml.cs ---VMWindow.vm.cs

我可以使用以下 .vstemplate 文件创建模板

```
<VSTemplate Type="Item" Version="2.0.0"
    xmlns="http://schemas.microsoft.com/developer/vstemplate/2005">
  <TemplateData>
    <Name>Viewmodel Dialog Box</Name>
    <Description>Viewmodel Dialog Box</Description>
    <Icon>Icon.ico</Icon>
    <ProjectType>CSharp</ProjectType>
    <DefaultName>VMDialog</DefaultName>
  </TemplateData>
  <TemplateContent>
    <ProjectItem TargetFileName="$fileinputname$.xaml" SubType="Window">ViewModelDialogTemplate.xaml</ProjectItem>
    <ProjectItem TargetFileName="$fileinputname$.xaml.cs">ViewModelDialogTemplate.xaml.cs</ProjectItem>
    <ProjectItem TargetFileName="$fileinputname$.vm.cs">ViewModelDialogTemplate.vm.cs</ProjectItem>
  </TemplateContent>
</VSTemplate> 
```

我希望模板在解决方案资源管理器中显示时使用嵌套在主窗口文件中的 .vm.cs 文件创建自己。

我找到了以下方法，但我在使用 Visual Studio 2010 时遇到了麻烦。这是2008年写的，现在还适用吗？

[代码项目文章](http://www.codeproject.com/Articles/23182/Create-Item-Templates-Which-Have-Nested-Items)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-09T17:41:56.427

其实很简单...

```
 <ProjectItem TargetFileName="$fileinputname$.xaml" SubType="Window">ViewModelDialogTemplate.xaml</ProjectItem>
    <ProjectItem TargetFileName="$fileinputname$.xaml/$fileinputname$.xaml.cs">ViewModelDialogTemplate.xaml.cs</ProjectItem>
    <ProjectItem TargetFileName="$fileinputname$.xaml/$fileinputname$.vm.cs">ViewModelDialogTemplate.vm.cs</ProjectItem> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-25T11:17:56.457

有一个更简单的方法。您可以引入 VS 用来构建复合项目的同一向导。为此，您可以在模板末尾的 <TemplateContent>... 之后添加一个元素。

```
<WizardExtension>
    <Assembly>Microsoft.VisualStudio.Web.Application, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a</Assembly>
    <FullClassName>Microsoft.VisualStudio.Web.Application.WATemplateWizard</FullClassName>
</WizardExtension> 
```

然后你需要告诉向导父级的扩展，以及子级的扩展......

```
<CustomParameters>
  <CustomParameter Name="$ParentExtension$" Value=".xaml"/>
  <CustomParameter Name="$ChildExtension$" Value=".cs"/>
</CustomParameters> 
```

该元素位于 <TemplateContent> 中。

此解决方案在 VS2012 中经过测试和工作，您可以在向导调用中看到硬编码的版本。如果您有版本问题，请查找文件 webform.vstemplate（Visual Studio 的 .aspx 模板），并启发自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T12:53:43.810

事实证明，相同的方法适用于 VS 2010。需要进行一些调整，但这篇[Code Project 文章](http://www.codeproject.com/Articles/23182/Create-Item-Templates-Which-Have-Nested-Items)涵盖了基本思想。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-04T18:00:23.577

您需要实现[Microsoft.VisualStudio.TemplateWizard.IWizard 接口](https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.templatewizard.iwizard.aspx)，并编写一些代码以从项目中删除新项并将其重新添加为另一个项的子项。这是来自 QueryFirst 的一个工作示例，它采用扩展名为 .gen.cs 的任何文件，并使其成为同名 .sql 文件的子文件...

```
 public void ProjectItemFinishedGenerating(ProjectItem
        item)
    {
        string path = item.FileNames[0];
        string parentPath = null;
        if (path.EndsWith(".gen.cs"))
            parentPath = path.Replace(".gen.cs", ".sql");
        if (path.EndsWith("Results.cs"))
            parentPath = path.Replace("Results.cs", ".sql");
        if (!string.IsNullOrEmpty(parentPath))
        {
            ProjectItem parent = item.DTE.Solution.FindProjectItem(parentPath);
            if (parent == null)
                return;
                item.Remove();
                parent.ProjectItems.AddFromFile(path);
        }

    } 
```

要将代码附加到模板，您需要在 .vstemplate 文件中添加类似内容...

```
<WizardExtension>
    <Assembly>QueryFirst, Version=1.0.0.0, Culture=neutral, PublicKeyToken=4688a60b10e39f04</Assembly>
    <FullClassName>QueryFirst.WizardImplementation</FullClassName>
</WizardExtension> 
```

# javascript - 如何从按钮数组中识别按钮点击

> ID：12884737
> 
> 赞同：1
> 
> 时间：2012-10-14T17:34:59.747
> 
> 标签：javascript, jquery

我有一个表格，每行有 1 个按钮，单击该行中显示的按钮税将应用于客户端，我需要向最终用户显示一些指示。为此，我想在单击时更改按钮 css(color, txt ect.)。下面是代码 -

```
<table class="data report_table">       
                        <tbody>
                        <c:forEach var="taxVO" items="${taxVo}" varStatus="item">
                        <tr class="${item.index % 2 == 0 ? 'odd gradeX' : 'even gradeC'}">                          
                            <td><c:out value="${taxVO.taxName}" /></td>
                            <td><input type="button" class="btn-icon" value="Apply" id="applyTaxButton" onClick="applyTax('${taxVO.taxId}');"></input>
                            </td>   
                        </tr>
                        </c:forEach>
                        </tbody>
                    </table> 
```

我正在使用的jquery是-

```
function applyTax(taxIdValue)   {
    $('#taxId').val(taxIdValue);
    $(this).$('#applyTaxButton').css("background-color","yellow");
} 
```

但我收到错误 - 未捕获的类型错误：对象 [对象对象] 没有方法“$”。有人可以让我知道如何解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:38:20.390

[***jsFiddle 演示***](http://jsfiddle.net/nbrooks/2z5zN/)

HTML ID 应该是唯一的，因此您***不***应该让所有按钮都具有相同的 ID。为此目的使用类属性。但是，要简单地更改选择的上下文，正确的语法是：

```
$(selector, context); 
```

**更好**的方法是完全删除该`onclick`属性，并在 jQuery 中完全处理事件：

```
$(function() {
    $('.report_table').on('click', '.btn-icon', function() {
        $(this).css('background-color', 'yellow');
        $('.btn-icon').not(this).css('background-color', 'transparent');
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:48:54.883

```
<input id="taxId" type="text" /><br />

<input onclick="applyTax(this, '1');" value="Apply" class="btn-icon btn-small btn-grey" type="button" />
<input onclick="applyTax(this, '2');" value="Apply" class="btn-icon btn-small btn-grey" type="button" />
<input onclick="applyTax(this, '3');" value="Apply" class="btn-icon btn-small btn-grey" type="button" />

<script>
function applyTax(btn, taxIdValue)   {
    $('#taxId').val(taxIdValue);
    $(btn).css("background-color","yellow");
}
</script> 
```

演示：http: [//jsfiddle.net/NFGkj/](http://jsfiddle.net/NFGkj/)

但最好使用jquery 事件绑定。

# database - MS Access 2007 表单到表单数据验证（数据类型：日期）

> ID：12884742
> 
> 赞同：0
> 
> 时间：2012-10-14T17:35:30.400
> 
> 标签：database, ms-access-2007

我认为我有前进的方向，但需要就我想做的最佳方法提供指导：

MS Access 2007 数据库

我有 2 个表，为此我创建了 2 个用户输入表单。

表格 1\. 站点位置：此表格中关注的字段是：找到站点的日期（使用日期数据类型）

表格 2\. 站点详细信息：表格中关注的字段是：工作日期开始（使用日期数据类型）

这个问题是我正在尝试创建一个表单以形成定义以下内容的验证规则：

工作日期开始必须 >= 比找到的日期站点。

我尝试了各种验证规则，所有这些规则都不起作用，例如：

[工作开始日期]>=[找到站点的日期]

> =[工作地点]！[找到网站的日期]

我开始工作的一条规则要求两种表格都打开，但我不希望那样。

但是，这是解决方案吗：

[willir (MIS) post re: 使用 <=Dlookup 的两个表单验证](http://www.tek-tips.com/viewthread.cfm?qid=991571)

或者是在更新事件之前/之后编写代码的最佳方式？还是有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:23:44.293

最简单的方法是查看表中的值，而不是另一种形式的值。[DLookup()](http://support.microsoft.com/kb/285866/EN-US)可让您查看另一个表中的值。

在您的情况下，如果您的表名为“站点位置”，则 DLookup() 本身可能看起来像这样。

```
DLookup("[Date Site Found]", "[Site Location]", "Your WHERE clause goes here") 
```

您可以通过指定表、列和键来访问 SQL 数据库中的数据。您的 WHERE 子句提供密钥。从你的描述中无法判断它应该是什么样子，但我会猜测一下。

```
'Using a literal number. Only useful for testing.
DLookup("[Date Site Found]", "[Site Location]", "[Site ID] = 32")

'Referring to another control on the same form.
DLookup("[Date Site Found]", "[Site Location]", "[Site ID] = Form![Site ID"]) 
```

链接的文章显示了 WHERE 子句的几种变体，每个变体都返回相同的结果。*这种*WHERE 子句不包含 where*一词*。这绊倒了很多人。

**使用 DLookup**

您的事件代码应如下所示。（我认为这应该在 [work start date] 控件的 BeforeUpdate 事件中。）

```
Dim date_found as Date
date_found = DLookup("[Date Site Found]", "[Site Location]", "[Site ID] = Form![Site ID"])
If ([work date start] >= date_found) Then
    'Good. Do nothing.
Else
    'Bad [work start date]. Throw the user a dialog box, and cancel this event.
    'Left as an exercise for the OP.
End If 
```

# ruby-on-rails - Rails在模型中设置默认布尔值

> ID：12884743
> 
> 赞同：4
> 
> 时间：2012-10-14T17:35:37.060
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, boolean, default

我正在用 Rails 3.2.8 版编写一个简单的博客应用程序。我已经为“帖子”资源搭建了如下脚手架：

```
rails g scaffold post title:string body:string islive:boolean 
```

我想在默认情况下将 islive 设置为 false，并且我正在尝试在我的模型中这样做。我还决定不希望它可用于批量分配，因此我将模型编码如下：

```
class Post < ActiveRecord::Base
  attr_accessible :body,  :title

  before_save :default_values

  def default_values
    self.islive = false
  end
end 
```

我还`islive`从表单中删除了该字段。问题是当我尝试使用上述模型创建新帖子时，它不会保存。控制台如下所示：

```
Started POST "/posts" for 127.0.0.1 at 2012-10-14 18:23:30 +0100
Processing by PostsController#create as HTML
  Parameters: {"utf8"=>"✓",
"authenticity_token"=>"/lNa21JBeBz/H2cYLqAsF8uWr1frLV88WsOVKzOqwb4=", "post"=>
 {"title"=>"sample title", "body"=>"the body"}, "commit"=>"Create Post"}
(0.1ms)  begin transaction
(0.0ms)  rollback transaction
Rendered posts/_form.html.erb (1.8ms)
Rendered posts/new.html.erb within layouts/application (2.5ms)
Completed 200 OK in 29ms (Views: 26.3ms | ActiveRecord: 0.1ms) 
```

什么都没有保存。我只是得到了`begin transaction` `rollback transaction`但是，如果我改成`default_values`这个：

```
def default_values
    self.islive = 'false'
end 
```

一切正常，保存良好，`falsey`价值为`islive`. 即使我只是做这样的事情：

```
def default_values
    self.islive = false
    Rails.logger.debug self.islive
end 
```

然后保存工作。

有人可以阐明为什么会这样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T17:49:34.443

`before_save`和其他回调在返回时终止保存`false`。这正是你所做的。如果你忘记它，它就是一个陷阱。你可以在最后一行放一些`true`（甚至）：`nil`

```
def default_values
  self.islive = false
  true
end 
```

# linux - ls /nosuchdir 2> error.file 在 unix/linux 中是什么意思？

> ID：12884747
> 
> 赞同：0
> 
> 时间：2012-10-14T17:36:01.460
> 
> 标签：linux, command

我了解 **ls**部分和重定向运算符 **>**。但是整体命令有什么作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:38:23.147

它将发送到`stderr`的任何错误消息放入文件中`error.file`

如果不显式重定向 stderr，默认情况下其输出将发送到控制台。

查看[有关重定向](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-3.html)和[BASH Shell 的全部内容：如何将 stderr 重定向到 stdout（将 stderr 重定向到文件）](http://www.cyberciti.biz/faq/redirecting-stderr-to-stdout/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:43:44.693

默认情况下，当您使用`>`它时会重定向`STDOUT`.

`STDOUT`由 标识`1`，因此，例如，以下两个命令的作用相同：

```
ls > error.file
ls 1> error.file 
```

可能您有时已经看到过这样的命令：

`command > error.file 2>&1`

这意味着：将默认频道（STDOUT）重定向到error.file并重定向`2`到同一个地方。那`2`代表`STDERR`.

在您的情况下，您只重定向`STDERR`.

# php - 获得我可以在 6/49 彩票上玩的所有可能组合

> ID：12884750
> 
> 赞同：2
> 
> 时间：2012-10-14T17:36:28.500
> 
> 标签：php, for-loop

这个想法是获得我可以在 6/49 彩票上玩的所有可能组合。对于前 2 个数字，它有效。什么时候，我添加第三个数字的条件，它说： `Undefined variable: b`。我不明白为什么。我在那里使用 echo 来检查程序是否正常工作。

这是代码。

```
for ($i=1 ; $i<50 ; $i++)
{
    $a=$i;
    for ($j=1 ; $j<50 ; $j++)
    {
        if ($i!=$j)
        {
            $b=$j;  
        }
        for ($k=1 ; $k<50 ; $k++)
        {

            if ($k!=$j && $k!=$i)
            {
                $c=$k;
                echo "$a $b $c<br>";
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:43:24.783

在第一次迭代`$i == $j`时， so`$b`永远不会被初始化。您可以通过扩展来修复它`if`以覆盖内部循环：

```
for ($i=1 ; $i<50 ; $i++)
{

  $a=$i;
  for ($j=1 ; $j<50 ; $j++)
  {

    if ($i!=$j)
    {
        $b=$j;

      for ($k=1 ; $k<50 ; $k++)

      {

        if ($k!=$j && $k!=$i)
        {
            $c=$k;
            echo "$a $b $c<br>";
        }
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:41:17.897

当 $i == $j 时 $b 未定义。我想你只想在 $i != $j 时运行内部 for 循环。请注意，此问题通常通过函数递归来解决（然后您无需对 6 个数字进行硬编码）。

希望有帮助，

*   约翰内斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:46:30.070

为什么不使用 6 个嵌套的 for 循环......

我不明白你使用的语言，所以我会把它放在一些伪代码中......

```
for (a=1; x<50-5; a++){
  for (b=a+1; x<50-4; b++){
    for (c=b+1; x<50-3; c++){
      for (d=c+1; x<50-2; d++){
        for (e=d+1; x<50-1; e++){
          for (f=e+1; x<50; f++){
            print (a,b,c,d,e,f);
          }
        }
      }
    }
  }
} 
```

# localization - UISegmentedControl 和本地化

> ID：12884751
> 
> 赞同：5
> 
> 时间：2012-10-14T17:36:36.617
> 
> 标签：localization, ios6, uisegmentedcontrol

我有一个`.xib`文件，附带`.strings`不同语言的文件。该`.xib`文件包含一个标签和一个`UISegmentedControl`.

当要求 IB 本地化`.xib`文件时，我得到以下`.strings`文件：

```
"6.segmentTitles[0]" = "title1";
// ...More strings related to the segmented control...
"11.text" = "bla"; 
```

'bla' 字符串属于标签。

更改“bla”字符串会反映在运行时，而更改“title1”字符串则不会。有谁知道为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:36:07.867

这个问题并不新鲜，但由于它仍然没有任何答案，我将添加我的解决方案，因为它可能对其他人有所帮助。

一般来说，正如上面提到的，UISegmentedControl 段标题不选择本地化字符串是一个开放的错误。

```
- (void)viewDidLoad
{
    ...

    // Locale will be picked automatically by NSBundle.
    NSString *resourcePath  =[[NSBundle mainBundle] pathForResource:@"MainStoryboard" ofType:@"strings"];
    NSDictionary *resourceDict = [NSDictionary dictionaryWithContentsOfFile:resourcePath];
    [self.segmentedControl setTitle:[resourceDict objectForKey:@"COo-BO-Ryl.segmentTitles[0]"] forSegmentAtIndex:0];
    [self.segmentedControl setTitle:[resourceDict objectForKey:@"COo-BO-Ryl.segmentTitles[1]"] forSegmentAtIndex:1];

} 
```

`COo-BO-Ryl`segmentedControl 的对象 ID在哪里。

不是很漂亮，但工作。

# c# - 将数据从数据库加载到类对象时出错

> ID：12884752
> 
> 赞同：1
> 
> 时间：2012-10-14T17:36:39.303
> 
> 标签：c#, ienumerable

我有一个班级客户。我正在尝试从 access db 数据库加载数据。

客户类结构如下：

```
public class Customer
    {
        public int CustomerId { get; set; }
        public string CustomerName { get; set; }
        public string CustAddress { get; set; }
        public string PnoneNo { get; set; }
        public string MobileNo { get; set; }
        public string CstNo { get; set; }
        public string DlNo { get; set; }
        public decimal BalAmt { get; set; }
            } 
```

我在db中的表结构如下：

![在此处输入图像描述](../Images/b3442059ea867aaba79349fa87195696.png)

现在，当我尝试在客户类中加载数据时，它会引发错误：

“指定的演员表无效。”

为了将数据加载到类中，我使用以下代码：

```
public static List<Customer> LoadListItems(string strTable, string strOrderBy)
        {
            List<Customer> lstCustomer=null;
            try
            {
                DataUtility objDataUtility = new DataUtility();
                DataTable objCustomerList = objDataUtility.LoadCustomerInfo(strTable, strOrderBy);

                lstCustomer= objCustomerList.AsEnumerable().Select(row =>
                        new Customer
                        {
                            CustomerId = row.Field<int>("CID"), //throwing error for this line
                            CustomerName = row.Field<string>("salPNm"),
                            CustAddress = row.Field<string>("cadd"),
                            MobileNo = row.Field<string>("cmbl"),
                            PnoneNo = row.Field<string>("cph"),
                            DlNo = row.Field<string>("cDlN"),
                            CstNo = row.Field<string>("cTin"),
                            BalAmt = row.Field<decimal>("cobal")
                        }).ToList();

            }
            catch (Exception ex)
            {
                throw ex;
            }
            return lstCustomer;

        } 
```

在上面的方法`CustomerId = row.Field<int>("CID"),`中，当我评论这一行时，它会引发错误，因为它工作正常。请帮助我如何从 iennumrable 列表中获取 int 值。

提前致谢。埃什维尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:50:09.270

尝试这个

```
public class Customer
{
    public Int64 CustomerId { get; set; }
    public string CustomerName { get; set; }
    public string CustAddress { get; set; }
    public string PnoneNo { get; set; }
    public string MobileNo { get; set; }
    public string CstNo { get; set; }
    public string DlNo { get; set; }
    public decimal BalAmt { get; set; }
} 
```

和

```
CustomerId = row.Field<Int64>("CID") 
```

我认为你的身份是一个长整数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:38:15.307

将其替换为 -

```
CustomerId = Convert.ToInt64(row.Field<int>("CID")); 
```

此外，通过`Quick Watch`在此行上应用来检查值 - `row.Field<int>("CID")`。看看它是否`not null`以及它返回的值是多少。

# iphone - NSURLConnection sendAsynchronousRequest - 与 HTTPS 通信

> ID：12884753
> 
> 赞同：0
> 
> 时间：2012-10-14T17:36:47.563
> 
> 标签：iphone, ios, cocoa-touch

我正在开发一个从 URL 获取图像的 iPhone 应用程序。我正在使用 'NSData dataWithContentsOfUrl] 并且效果很好。但是，正如您可能已经猜到的那样，请求是同步的。

我希望请求是异步的。所以，我尝试使用 NSURLConnection 的 sendAsynchronousRequest() 调用。但这会在方法 'didFailWithError' 中返回以下错误：

> 错误域=kCFErrorDomainCFNetwork 代码=310“与安全 Web 代理服务器 (HTTPS) 通信时出现问题。

有人可以帮忙吗？

这是我的 NSURLConnection 代码片段：

```
NSURL *url = [NSURL URLWithString:notePicUrl];

            NSURLRequest *urlRequest = [NSURLRequest  requestWithURL:url cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:100.0];
            //NSOperationQueue *queue = [[NSOperationQueue alloc] init];

            NSURLConnection* _connection = [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self startImmediately:NO];
            self.port = [NSPort port];                                                                                                       
            self.runLoop = [NSRunLoop currentRunLoop];                                                                                       
            [self.runLoop addPort:self.port forMode:NSDefaultRunLoopMode];
            [_connection scheduleInRunLoop:self.runLoop forMode:NSDefaultRunLoopMode];
            [_connection start];
            while (self.finished != YES ) {
                [self.runLoop runUntilDate:[NSDate dateWithTimeIntervalSinceNow: 0.1]]; 
            }
            [self.runLoop removePort:[self port] forMode:NSDefaultRunLoopMode];
            [_connection unscheduleFromRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode]; 
```

和 NSURLConnectionDelegate 方法（尚未实现；只是测试首先看看它是否有效）......

```
-(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)response
{
    NSLog(@"didReceiveResponse");
    //_data = [[NSMutableData alloc] init]; // _data being an ivar
}
-(void)connection:(NSURLConnection*)connection didReceiveData:(NSData*)data
{
    NSLog(@"didReceiveData");
    //[_data appendData:data];
}
-(void)connection:(NSURLConnection*)connection didFailWithError:(NSError*)error
{
    NSLog(@"didFailWithError %@", [error description]);
    // Handle the error properly
}
-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{
    NSLog(@"connectionDidFinishLoading");
    //[self handleDownloadedData]; // Deal with the data
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T13:04:26.630

我刚刚解决了这个问题；我尝试使用简单的代码行：

```
[[NSURLConnection alloc] initWithRequest:urlRequest delegate:self startImmediately:YES]; 
```

然后在 Delegate 方法中处理数据。早些时候，它试图在单独的线程中运行。这工作得很好并且是异步的。

# android - 如何在android中动态设置textview边框

> ID：12884754
> 
> 赞同：0
> 
> 时间：2012-10-14T17:36:48.453
> 
> 标签：android

我是 android 的新手，我正在开发一个应用程序，我想在其中动态设置 textview 的边框，即通过代码而不是通过 xml。我在谷歌上搜索了很多，但我到处都找到了 xml 的解决方案。我尝试了很多，但没有找到正确的方法来实现这一点。喜欢使用这个 url，但我无法得到结果 [How to drawborders for TextView created using Code not by XML in Android](https://stackoverflow.com/questions/3922571/how-to-draw-borders-for-textview-created-using-code-not-by-xml-in-android) 请建议我的想法，我怎么能做到这一点..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:01:57.793

您找不到太多关于非 XML 布局的文档的原因是大多数问题都可以通过布局解决。我建议至少在 XML 中定义文本视图，然后在代码中设置边框。例如：

*在 layout.xml 文件中：*

```
<TextView android:id="@+id/text"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:text="Hello, I am a TextView" /> 
```

*然后在您的代码中：*

```
TextView text = ((TextView)this.findViewById(R.id.text)); //use id to find view
ViewGroup.LayoutParams textLayout = text.getLayoutParams();
textLayout.topMargin = 10;
textLayout.bottomMargin = 10;
text.setLayoutParams(textLayout); 
```

您可以通过这种方式修改对象的任何属性。（使用[ViewGroup](http://developer.android.com/reference/android/view/ViewGroup.html)和[View](http://developer.android.com/reference/android/view/View.html)作为资源）

注意上面的例子只是例子（我面前没有编译器来检查语法和有效性）

# android - 弹出窗口内的 Listview 和 Viewpager，如 My Places（Maps Android 平板电脑）

> ID：12884757
> 
> 赞同：2
> 
> 时间：2012-10-14T17:37:05.493
> 
> 标签：android, listview, android-viewpager, popupwindow

你们能帮我一个忙吗？因为我需要你的帮助。你们可以在地图应用程序（android平板电脑）中的弹出窗口中做一个viewpager的例子吗？例如，单击菜单 -> 我的地点后，将出现我的地点弹出窗口，其中包含 viewpager 和 listView，例如 Offline、Recent 等

[单击此处预览示例图像](http://www.flickr.com/photos/88649068@N06/8086982650/in/photostream)

# wordpress - 如何使用自定义元信息将 1500 种产品导入 WP eCommerce？

> ID：12884761
> 
> 赞同：2
> 
> 时间：2012-10-14T17:37:22.023
> 
> 标签：wordpress, csv, import, custom-fields

我有一个需要导入自定义元信息的产品 CSV 文件，但据我所见，CSV 示例仅涵盖要导入的一些产品详细信息，而不是自定义元信息。

我研究了 Visser Labs 找到的一个插件，虽然它看起来像我需要的东西，但它非常昂贵，我希望有人以便宜得多的价格做过类似的事情？

否则，如果我忽略了什么并且有更简单的方法，请告诉我？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T00:29:55.627

此[LINK](http://www.analogrithems.com/rant/portfolio/wordpress-ecommerce-data-feeder/)描述了接受的导入类别，以及用于导入 CSV 用于电子商务的 Wordpress 插件。

此页面的最佳部分是对 WP eCommerce 可接受的导入字段的说明。

至于导入自定义元：

```
meta_* - Custom meta data can also be included by creating a column 
that has meta_ prefixed to it.  For example if you want to have a 
custom meta field called brand associated to your product you can 
create a column called meta_Brand. 
```

# c# - c#if语句总是返回false

> ID：12884763
> 
> 赞同：1
> 
> 时间：2012-10-14T17:37:55.657
> 
> 标签：c#, linux, if-statement, mono

我目前正在为个人项目开发一个小型服务器/客户端应用程序。服务器旨在在 Mono 下的 Linux 中运行，而客户端则从 Windows PC 运行。

我有一个问题，我将数据传递给服务器（在这种情况下，字符串值为“on”和“off”）但是 if 语句总是返回错误值。

来自服务器的代码如下

```
public void startServer() {
    TcpListener listen = new TcpListener(serverIP, 10000);
    listen.Start();

    Console.Clear();
    Console.WriteLine("IP Address = {0}", serverIP.ToString());
    Console.WriteLine("Server is listening for connection");

    Socket a = listen.AcceptSocket();

    Console.WriteLine("Connection from {0}", a.RemoteEndPoint);

    ASCIIEncoding respond = new ASCIIEncoding();
    a.Send(respond.GetBytes("You are connected to LED Control Server"));

    bool keepListening = true;

    while (keepListening) {
        byte[] b = new byte[1000];
        a.Receive(b);
        Console.WriteLine("Message Received from {0}, string: {1}", a.RemoteEndPoint, recData(b));
        string serverMsg = procIns(recData(b));
        a.Send(respond.GetBytes(serverMsg));
    }
}

private string recData(byte[] b) //receiving data from the client {
    int count = b.Length;
    string message = "";
    for (int a = 0; a < count; a++) {
        message += Convert.ToChar(b[a]);
    }
    return message;
}

private string procIns(string instruction) {
    string returnMsg;

    Console.WriteLine(instruction.ToLower());

    if (instruction.ToLower() == "on") {
        FileGPIO gpio = new FileGPIO();
        gpio.OutputPin(FileGPIO.enumPIN.gpio17, true);
        returnMsg = "GPIO 17 1";
    } else if (instruction.ToLower() == "off") {
        FileGPIO gpio = new FileGPIO();
        gpio.OutputPin(FileGPIO.enumPIN.gpio17, false);
        returnMsg = "GPIO 17 0";
    } else {
        returnMsg = "Invalid Command";
    }

    return returnMsg;
} 
```

procIns 方法中 if 语句返回 false 的原因使我无法理解，如果有人可以提供任何建议，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:48:23.880

我猜它必须是填充空间。试试这个...

```
if (instruction.Trim().ToLower() == "on") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:11:30.667

```
 while (keepListening) {
            byte[] b = new byte[1000];
            int bytesRcvd = a.Receive(b);
            Console.WriteLine("Message Received from {0}, string: {1}", a.RemoteEndPoint, recData(b));
            string serverMsg = procIns(recData(b, bytesRcvd ));
            a.Send(respond.GetBytes(serverMsg));
        } 
```

`a.Receive(b)`方法返回接收到的字节数。您可以将值存储在某个变量中并将变量传递给`recData`方法。

```
 private string recData(byte[] b, int bytesRcvd) {
    string message = "";
    for (int a = 0; a < bytesRcvd; a++) {
        message += Convert.ToChar(b[a]);
    }
    return message;
} 
```

接收到的字节数将有助于截断字节数组中的额外值。

# c++ - 递归/迭代函数

> ID：12884766
> 
> 赞同：2
> 
> 时间：2012-10-14T17:38:17.990
> 
> 标签：c++

我很难创建一个函数，使用迭代和递归来找到 1 和用户输入的数字之间的所有偶数的总和。程序指南需要一个函数来解决这三种方式：

1.  一个公式
2.  迭代
3.  递归

这是我到目前为止所拥有的：

```
#include <iostream>
#include <iomanip>
#include <cstdlib>

using namespace std;

void formulaEvenSum(int num, int& evenSum)
{
    evenSum = num / 2 * (num / 2 + 1);
    return;
}

void loopEvenSum(int num, int& evenSum2)
{

}

int main()
{
    int num, evenSum, evenSum2;

     cout << "Program to compute sum of even integers from 1 to num.";
     cout << endl << endl;

     cout << "Enter a positive integer (or 0 to exit): ";
     cin >> num;

     formulaEvenSum(num, evenSum);
     loopEvenSum(num, evenSum2);

     cout << "Formula result = " << evenSum << endl;
     cout << "Iterative result = " << evenSum2 << endl;

     system("PAUSE");
     return 0;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T18:04:10.867

Using iteration to find the sum of even number is as given below.

```
void loopEvenSum(int num, int &evenSum2)
{
    evenSum2=0;
    for (i=2;i<=num;i++)
    {
        if(i%2==0)
            evenSum2+=i;
    }
} 
```

The following code though not the most efficient can give you an idea how to write a recursive function.

```
void recursiveEvenSum(int num,int &evenSum3,int counter)
{
    if(counter==1)
        evenSum3=0;
    if(counter>num)
        return;
    if(counter%2==0)
        evenSum3+=counter;
    recursiveEvenSum(num,evenSum3,counter+1);
} 
```

Now you can call recursiveEvenSum(...) as

```
int evenSum3;
recursiveEvenSum(num,evenSum3,1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:55:38.183

如果返回 int 而不是 void，递归方法会简单得多

```
void iterEvenSum(int num, int& evenSum2)
{
    evenSum2 = 0;
    if (num < 2) return;
    for (int i = 0; i <= num; i+=2)
    evenSum2 += i;
}

int recurEvenSum(int num)
{
    if (num < 0)    return 0;
    if (num < 4)    return 2;
    return num - num%2 + recurEvenSum(num-2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:47:46.797

您应该能够使用`for`循环构建迭代解决方案而不会出现太多问题。

递归解决方案可能采用以下形式：

```
f(a)
  if(a>0)
    return a+f(a-1)
  else
    return 0

f(user_input) 
```

您必须区分“深入研究”的情况和提供不影响总数但开始爬出递归的答案的情况（尽管还有其他方法可以结束它）。

另一种解决方案是一种形式：

```
f(a,sum,total)
  if(a<=total)
    return f(a+1,sum+a,total)
  else
    return sum

f(0,0,user_input) 
```

第二种方法的优点是某些语言能够识别和优化所谓的“[尾递归](https://en.wikipedia.org/wiki/Tail_call)”。您将在第一种递归形式中看到，有必要为每个递归级别存储一个中间结果，但在第二种形式中这不是必需的，因为每次都会传递返回最终答案所需的所有信息。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-14T17:51:16.907

我想这样就行了别忘了在调用函数之前把evenSum1、evenSum2和evenSum3的值初始化为0

```
void loopEvenSum(int num, int& evenSum2)
{
    for(int i = num; i > 1; i--)
        if(i%2 == 0)
            evenSum2+=i;
}

void RecursiveEvenSum(int num, int & evenSum3)
{
    if(num == 2)
    {
        evenSum3 + num;
        return;
    }
    else
    {
        if(num%2 == 0)
            evenSum3+=num;
        num--;
        RecursiveEvenSum(num, evenSum3);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-14T17:53:00.870

```
void loopEvenSum(int num, int& evenSum2)
{
    eventSum2 = 0;
    for(int i = 1 ; i <= num; i++){
        (i%2 == 0) eventSum += i;
    }
}

void recurEvenSum(int num, int& evenSum3)
{
    if(num == 1) return;
    else if(num % 2 == 0) {
        eventSum3 += num;
        recurEvenSum(num-1, eventSum3);    
    }
    else recurEvenSum(num-1, eventSum3); 

} 
```

`evenSum`顺便说一句，您必须`0`在调用方法之前进行初始化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-25T08:48:27.840

要使用迭代方法获得集合 [1,num] 中所有可被 2 整除的数字的总和，您可以遍历该范围内的所有数字，从 num 开始直到达到 2，然后添加当前迭代的数字总和，如果这可以被二整除。

请注意，您必须在开始循环之前为 evenSum2 分配零，否则结果将与*formulaEvenSum()*不同。

```
void loopEvenSum(int num, int& evenSum2)
{
    assert(num > 0);
    evenSum2 = 0;
    for (int i=num; i>=2; --i) {
        if (0 == (i % 2)) {
            evenSum2 += i;
        }
    }
} 
```

为了通过使用递归方法获得相同的结果，而不是通过引用传递将保存总和的变量，我建议您在每次调用时返回总和；否则，您需要保存当前递归的计数器，或者更糟糕的是，在开始递归之前，您需要在调用者中将总和设置为零。

```
int recursiveEventSum(int num)
{
    assert(num > 0);
    if (num == 1) {
        return 0;
    } else {
        return ((num % 2) ? 0 : num) + recursiveEventSum(num-1);
    }
} 
```

请注意，由于只有从偶数中减去两个（不是一个）才能得到偶数，因此您可以通过仅对这些数字进行迭代来进行优化，如果 num 为奇数，则最终加上第一次迭代。

# git - 在 Ubuntu 上设置本地 git 存储库

> ID：12884769
> 
> 赞同：2
> 
> 时间：2012-10-14T17:38:47.503
> 
> 标签：git, ubuntu

我正在尝试在我的本地机器上设置一个 Git 存储库，用于在我的本地机器上完成的工作 - 没有远程任何东西。

我已经多次设置远程存储库，但似乎我在本地采取的步骤总是以错误告终。

我有 2 个目录： `/home/rico/project`和`/home/git/project_repo`

我创建了 git 用户来管理我所有的 git 存储库（我希望有几十个）。

作为用户`/home/rico/project`，`rico`我执行以下命令：

```
rico@verbal:~/project$ git init
Initialized empty Git repository in /home/rico/project/.git/ 
```

作为用户`/home/git/project_repo`，`git`我执行以下操作：

```
git@verbal:~/project_repo$ git --bare init
Initialized empty Git repository in /home/git/project_repo 
```

现在我回到我的项目并添加文件。

```
rico@verbal:~/project$ git status
# On branch master
#
# Initial commit
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#       .project
#       .pydevproject
#       inc/
#       manage.py
#       rocksolidbox/
#       rsb/
#       templates/
rico@verbal:~/project$ git add inc media rocksolidbox/ rsb/ templates/
rico@verbal:~/project$ git commit -a -m "Initialize the project." 
```

在这一点上，我得到了正常的提交消息 -`23 files changed, 989 insertions(+)`等等。

现在，我想把它推送到`project_repo`文件夹中。

```
rico@verbal:~/project$ git remote add origin /home/git/rocksolidbox/
rico@verbal:~/project$ git push -u /home/git/rocksolidbox/ master 
```

但收到以下错误：

```
Counting objects: 31, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (26/26), done.
error: insufficient permission for adding an object to repository database ./objects

fatal: failed to write object
Writing objects: 100% (31/31), 12.24 KiB, done.
Total 31 (delta 2), reused 0 (delta 0)
error: unpack failed: unpack-objects abnormal exit
To /home/git/project_repo/
 ! [remote rejected] master -> master (n/a (unpacker error))
error: failed to push some refs to '/home/git/project_repo/' 
```

显然这是一个权限错误。我试图做这样的推动：

```
rico@verbal:~/project$ git push -u git@verbal:/home/git/rocksolidbox/ master 
```

甚至使用我的本地 IP：

```
rico@verbal:~/project$ git push -u git@192.168.1.101:/home/git/rocksolidbox/ master 
```

它要求输入密码，我知道我提供的密码正确，并且我不断收到消息`Permission denied, please try again.`

我只是希望能够将我推`project`到我的`project_repo`. 我在这个设置中做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:06:33.677

不要做所有花哨的权限步法。你想要[gitolite](https://github.com/sitaramc/gitolite)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:52:19.983

好的，我已经找到了解决权限问题的方法。基本上这样做：

```
git@verbal:~/$ chmod -R 777 project_repo 
```

然后我可以用我的执行以下命令`project`：

```
rico@verbal:~/project$ git remote add origin /home/git/project_repo/
rico@verbal:~/project$ git push -u /home/git/project_repo/ master 
```

然后将项目克隆到其他地方，只需执行以下操作：

```
rico@verbal:~/some_other_location$ git clone /home/git/project_repo 
```

而你是金色的。

现在，我的问题仍然存在……这是处理权限问题的最佳方式吗？我真的不喜欢给予`777`任何东西的想法。我应该把`git`和`rico`放在同一个组中而`775`不是做吗？

有什么建议么？

EDIT1：将`git`和`rico`放在同一个组中并`775`没有帮助。它可以正常工作，`777`但我不喜欢这个解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T11:39:12.583

我被困在同一点上。到目前为止，“出了点问题”的信息量不是很大。在比较了几十个标题为“小菜一碟”的howtos之后，我发现了主要问题。大多数示例在同一主机上具有客户端和服务器。那不是我想要的。编辑 ~/.ssh/config 后，下面显示的方式就像一个魅力。

对于这个例子，服务器主机称为**gitolite**，在服务器上安装 gitolite 的专用帐户称为**git**，客户端上的用户名为**harrie**，/home/harrie/.ssh 中的密钥对由“ssh- keygen-t rsa -f harrie”。

~/.ssh/config

```
Host gitolite
        User git
        Hostname gitolite
        Port 22
        IdentityFile ~/.ssh/harrie 
```

# command-line - JIRA 主页配置

> ID：12884773
> 
> 赞同：2
> 
> 时间：2012-10-14T17:39:21.283
> 
> 标签：command-line, configuration, terminal, jira

我在配置 JIRA (Mac OSX 10.6.8) 时遇到了一些问题，特别是设置我的 JIRA 主目录。我运行了 JIRA 配置工具，并定义了我的路径。在我的本地主机上运行 JIRA 后，我收到消息：没有配置 jira.home。通过我的终端，我进入编辑我的 jira-application.properties 文件，它显示 jira.home = /Applications/MAMP/jira/htdocs。在这一点上，我不确定我做错了什么，因为似乎 jira.home 已定义。有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T07:37:01.440

查看[设置您的 JIRA 主目录](https://confluence.atlassian.com/display/JIRA/Setting+your+JIRA+Home+Directory)并确保您指向 Jira 主文件夹：

```
Edit the jira-application.properties file and set the value of the 'jira.home' 
property to the desired location for your JIRA Home Directory. If you are specifying 
this location's path on Windows, use double back-slashes ("\") between subdirectories.
 For example, X:\\path\\to\\JIRA\‌\Home 
```

要查找 Jira 主页的位置，请查看[JIRA 安装目录页面](https://confluence.atlassian.com/display/JIRA/JIRA+Installation+Directory)，该文件夹应包含日志、jss 和插件文件夹。

因此，例如，如果 Jira 安装在*`/var/atlassian/application-data/jira`*， *`jira-application.properties`*则应具有以下行：

```
jira.home = /var/atlassian/application-data/jira 
```

**请注意**- Jira 主目录是指数据目录而**不是**安装目录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-23T14:54:33.660

在 MacOS 上安装 Jira： [https ://confluence.atlassian.com/display/JIRA042/Installing+JIRA+Standalone+on+Mac+OS](https://confluence.atlassian.com/display/JIRA042/Installing+JIRA+Standalone+on+Mac+OS)

注意：将您的 Home（又名数据）目录设置为 /Applications/MAMP/jira/htdocs 意味着您的 Jira 安装位于您的 MAMP Web 根目录中......您确定这是安装 Jira 的位置吗？通常，在 Mac 上，主目录位于此处：/Applications/Jira/HOME

# php - 系统指令错误码126

> ID：12884784
> 
> 赞同：1
> 
> 时间：2012-10-14T17:40:37.913
> 
> 标签：php, ffmpeg, system

拜托，我正在尝试使用 ffmpeg 将 mpg 文件转换为 flv。我正在使用 php system() 命令来执行它。但是，我收到错误代码 126。知道这意味着什么吗？这是我的代码： `system($ffmpegPath. " -i ". $srcFile. " -b 4000k -maxrate 4000k -bufsize 1835k ". $destFile, $cmd_status)`

谢谢。我发现我指的是错误的 ffmpeg 二进制文件。但是，现在我指向正确的二进制文件，我得到一个错误 127。有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T19:55:46.437

从`bash(1)`手册页：

> 如果找到命令但不可执行，则返回状态为 126。

确保您可以执行给定的二进制文件。

# javascript - 特定电话号码安排的正则表达式

> ID：12884787
> 
> 赞同：1
> 
> 时间：2012-10-14T17:40:58.593
> 
> 标签：javascript, regex, verification, phone-number

我目前正在使用这个正则表达式

`"/^([0-9\(\)\/\+ \-]*)$/",`

这很好，但问题是我也在使用一个屏蔽脚本，它会自动生成这一行，

```
(___) ___-____ 
```

它弄乱了我的验证，什么正则表达式代码可以让我只验证来自使用的这种类型的输入

```
(999) 999-9999 
```

并且在输入时也不接受用户的“空白”输入字段。任何长度都可以，只要它只接受我上面提到的这个输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:49:21.167

这应该有效：

`^\(\d{3}\)\s{0,1}\d{3}-\d{3}$`

打破这个正则表达式：

`\(\d{3}\)`只匹配括号内的三个数字。

`\s{0,1}`仅匹配 0 或 1 个空格。

`\d{3}-\d{3}`仅匹配三个数字，后跟“-”，然后是其他三个数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:55:38.200

格式化和验证是两个非常不同的东西。如果你试图混合它们，你会失败。

话虽如此，在执行验证之前，您应该从字符串中删除所有格式字符，然后验证内容。

```
// remove everything that isn't a digit
var strippedNumber = value.replace(/\D/g, '');

if (strippedNumber.length === 10) {
    // valid phone number
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:00:51.617

首先，在询问正则表达式时，您应该始终说出您正在使用哪种语言或工具，因为这会影响可用的功能以及需要用反斜杠引用哪些字符。我假设您根据问题的标签询问 JavaScript。

你说任何长度都可以。我认为这意味着每个连续数字序列可以包含从一个到无穷大的任意数量的数字。我假设只有一个空格和一个破折号。在此基础上，您的 RE 为：

```
/^\(\d+\) \d+-\d+$/ 
```

如果更可能的是，您想限制数字序列的长度，您可以这样说：

```
/^\(\d{3,4}\) \d{3}-\d{1,10}$/ 
```

（三位数或四位数，正好三位数，一到十位数）。

我省略了任何捕获括号`(...)`，如果您要捕获整个字符串，这有点多余`^(....)$`。

这是 JavaScript 正则表达式语法的简明摘要： [http ://www.regextester.com/jssyntax.html](http://www.regextester.com/jssyntax.html)

# html - 谷歌美化行号和溢出

> ID：12884789
> 
> 赞同：2
> 
> 时间：2012-10-14T17:41:07.033
> 
> 标签：html, prettify, google-code-prettify

将溢出添加到 Google 美化元素时，行号会消失。

不变的CSS：

```
pre
{    
    font-size:11px;
    background-color:white;
}
/* Alternate shading for lines */     li.L1,
li.L3,
li.L5,
li.L7,
li.L9 { background: #eee; width:200%;} 
```

之前的 CSS 和图像：

```
pre.prettyprint { padding: 2px; border: 1px solid #888;} 
```

![在此处输入图像描述](../Images/ffccb4529bc00ff1c66f2e5f929bb1da.png)

之后的 CSS 和图像：

```
pre.prettyprint { padding: 2px; border: 1px solid #888; overflow:auto;} 
```

![在此处输入图像描述](../Images/0eacd44a7c7bf64aa6a6b71ac72db8d7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T00:33:06.367

显然这些数字在 pre.prettyprint 元素的填充中。如果我在溢出“打开”的情况下将左侧填充增加到 30 像素，我可以看到数字。我将不得不再梳理一下 CSS（它是继承的）

CSS 更改和结果输出：

```
pre.prettyprint { padding-left:30px; border: 1px solid #888; overflow: auto;} 
```

![在此处输入图像描述](../Images/e7fc74c49aa2cd3f514671d2abd42d1e.png)

# javascript - 将类应用于 id 在两个数字之间的对象

> ID：12884792
> 
> 赞同：-1
> 
> 时间：2012-10-14T17:41:14.177
> 
> 标签：javascript, jquery

是否有任何简单的方法可以将类应用于 id 在两个数字之间的所有元素：

例如：所有跨度都在 1000 到 2000 之间

我知道在 html5 数字作为 ID 之前不是一个好主意

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:45:13.287

尝试这个：

```
$( '#wrapper' ).find( 'span[id]' ).filter(function () {
    return +this.id > 1000 && +this.id < 2000;
}).addClass( 'yourClass' ); 
```

**现场演示：http:** [//jsfiddle.net/Q23xF/](http://jsfiddle.net/Q23xF/)

`wrapper`是包含所有 SPAN 的 DOM 元素。您仅在该包装器中搜索具有`id`属性的 SPAN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:47:06.407

```
$("span").each(function(
 if(this.id>1000||this.id<2000){
  $(this).addClass("class");
     }

)} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:44:38.317

您不能使用 DOM 选择器一次选择它们，您需要过滤它们：

```
$("span[id]").each(function() {
    var id = parseInt(this.id, 10);
    if (id > 1000 && id < 2000)
        $(this).addClass("inrange");
}); 
```

或者

```
$("span[id]").filter(function() {
    var id = parseInt(this.id, 10);
    return id > 1000 && id < 2000;
}).addClass("inrange"); 
```

# java - 具有网络操作的 Asynctask 和另一个 Asynctask 任务问题

> ID：12884800
> 
> 赞同：2
> 
> 时间：2012-10-14T17:42:03.337
> 
> 标签：java, android, multithreading, http, android-asynctask

我遇到的问题是关于两个单独的 Asynctask 类。第一个 asynctask 在 doInBackground 方法中使用网络操作

```
HttpResponse httpResponse = httpClient.execute(httpPost); 
```

而另一个是使用progressDialog加载图像的线程。

所以发生的情况是，如果我使用慢速互联网连接（这意味着第一个异步任务尚未完成）然后直接转到第二个异步任务，第二个类将等到第一个完成。

顺便说一句，在我调用第一个 asynctask 之后，我直接完成了活动并调用了另一个，这与什么有关吗？

tl;博士版本：

在第一个 asynctask 完成之前，第二个 asynctask 不会执行 doinbackground 进程

我知道这一点，因为进度对话框显示了很长时间（我在 preExecute 中显示它并在 postexecute 中将其关闭）

**编辑：**

第一个异步任务涉及等待来自网络的响应。因此，虽然没有响应，但第二个 asynctask 不会执行其 doinbackground 过程。

**编辑2：**

有没有办法让我正确使用这两个异步任务，这样第二个就不必等待第一个完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T20:16:25.300

我在我的应用程序中遇到了同样的问题 - 我需要在任何 Android 版本（从 2.1 到 4.2）中同时运行 4 个 AsyncTasks。但是在 Honeycomb 中，AsyncTasks 是串行运行的。

所以我写了 AsyncTaskExecutor - 它可以在任何 Android 版本上同时运行 AsyncTasks。

看一看：

## **[异步任务执行器](https://github.com/artem-zinnatullin/Android-AsyncTask-Executor)**

在任何 Android 操作系统版本上同时运行 AsyncTask 需要所有工作，最好使用：

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
    task.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);
} else {
    task.execute();
} 
```

因为 AsyncTask.THREAD_POOL_EXECUTOR 仅在 api >= 11 上可用；我正在使用自己的 threadPoolExecutor 实例

### 使用 AsyncTaskExecutor，您只需要编写：

```
AsyncTaskExecutor.executeConcurrently(task, params); 
```

### 仅此而已。Android 2.x、3.x 和 4.x 上没有错误

PS我很抱歉从其他问题中复制了我的答案，但我认为这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:59:19.350

在第一个 AsyncTask onPostExecute(String result) 方法中启动第二个 AsyncTask，然后在完成第一个 AsyncTask 后启动第二个 AsyncTask。

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-29T17:23:50.220

Google 更改了 Honeycomb (3.0) 中 AsyncTask 的行为。现在，一个进程的所有 AsyncTask 都是串行运行的——正如您所观察到的。

正如您所描述的那样，这肯定是一个问题。我认为您需要将其中一个异步任务转换为其他内容，例如 Runnable。

# php - json_decode 在 php 中返回 null

> ID：12884802
> 
> 赞同：1
> 
> 时间：2012-10-14T17:42:37.693
> 
> 标签：php, json

我正在尝试在 php 中使用 json_decode 解析 json。一个 url 失败了，谁能告诉我为什么它失败了，在 php 中是否有 json_decode 的替代方法？

这是我的代码

```
$url='https://espn.go.com/travel/sports/calendar/getList.json?&xhr=1&date=20121027&type=list&query=null&myTeams=';
$html = file_get_html($url);     
$json=json_decode($html,true); 
```

//json在这里为空

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T17:43:22.820

`file_get_html`是 [PHP Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/) `Not default PHP function` 应该是

```
 $html = file_get_contents($url); 
```

***另请注意，返回的 JSON 存在格式错误的 UTF-8 字符错误，可能编码不正确***

解决这个问题

```
$url = 'http://espn.go.com/travel/sports/calendar/getList.json?&xhr=1&date=20121027&type=list&query=null&myTeams=';
$html = file_get_contents($url);
$json = preg_replace('/,\s*([\]}])/m', '$1', utf8_encode($html));
$json = json_decode($json);
echo "<pre>";
print_r($json); 
```

输出

```
tdClass Object
(
    [nfb] => Array
        (
            [0] => stdClass Object
                (
                    [events] => Array
                        (
                            [0] => stdClass Object
                                (
                                    [id] => 265911
                                    [time] => 12:00 AM ET
                                    [sportId] => 23
                                    [link] => http://espn.go.com/ncf/team/_/name/
                                    [prevLink] => http://espn.go.com/ncf/preview?gameId=323010002
                                    [recapLink] => http://espn.go.com/ncf/recap?gameId=323010002
                                    [shortSport] => ncaa
                                    [homeId] => 2
                                    [awayId] => 245
                                    [homeScore] => -1

        ... So Many More 
```

[观看现场演示](http://codepad.viper-7.com/vSHdKG)

# html - 内容没有粘在浏览器的右边缘

> ID：12884803
> 
> 赞同：0
> 
> 时间：2012-10-14T17:42:44.080
> 
> 标签：html, css, responsive-design

当我调整它的大小时，我正在设计的其中一个站点会像这样中断。为什么它不粘在浏览器的边缘？我怎样才能做到这一点？

![分离的右边缘](../Images/67fc383a0000331c76618b666ae840e4.png)

我最初使用[CSS Layout Generator来生成布局。](http://csslayoutgenerator.com/)我使用了液体布局选项，因为我想让我的网站具有响应性。

其中`<body>`有一个包装器`<div>`，其样式如下：

```
min-width: 320px;
max-width: 100%;
margin: 0 auto;
min-height: 100%;
height: auto !important;
height: 100%; 
```

`wrapper`包含所有,并且继承自包装器的宽度`header`。他们设置为**1200px**并且**居中**。`middle-section``footer``max-width`

 ***** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:59:40.027

您需要删除左右填充的用户代理样式`body`：

```
body {
    padding: 0;
    min-width: 320px;
    max-width: 100%;
    margin: 0 auto;
    min-height: 100%;
    height: auto !important;
    height: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:43:54.383

看到[这个](http://jsfiddle.net/PrsHt/)小提琴。如果您将选择器更改`.incorrectruledisabled`为`.incorrectrule`，您应该会在附加图像中看到您获得的结果。

你不能给某个东西一个宽度的上限，也不能期望它无条件地占据整个宽度。如果我误解了您的问题，请告诉我。

编辑：[这](http://jsfiddle.net/PrsHt/2/)是一个示例，其中页眉、中间和页脚的**内容**使用 text-align 居中，但它们本身不是。****

# javascript - 无法代替 和

> ID：12884806
> 
> 赞同：0
> 
> 时间：2012-10-14T17:43:20.230
> 
> 标签：javascript, regex

使用本机 javascript 我无法`string.replace("<p> </p>", "<P>&nbsp;</p>");`正常工作，似乎找不到任何可以替换的东西。

当我得到outerHTML或innerHTML

它以标准空格字符“”返回的元素，我需要获取`"&nbsp;"`空格的版本。

我将如何去做这件事。我试图编写一个正则表达式来做到这一点，但似乎正则表达式也找不到任何可以替换的东西，而且我知道页面上至少有 3-4 个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T17:53:07.410

它确实有效，但它只取代了第一次出现。您必须使用带有*全局*标志 ( `/<p> <\/p>/g`) 的正则表达式 for [`replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)，但是将[html 与正则表达式匹配并不是一个好主意](https://stackoverflow.com/a/1732454/1048572)（尽管它可能适用于这种特定的简单情况）。

DOM 方式会更干净：

```
var paragraphs = document.getElementsByTagName("p");
for (var i=0; i<paragraps.length; i++)
    if (paragraphs[i].innerHTML == " ") // does not contain other empty elements
        paragraphs[i].innerText = "\uA0"; 
```

# html - :nth-child 是如何工作的？

> ID：12884812
> 
> 赞同：0
> 
> 时间：2012-10-14T17:44:20.180
> 
> 标签：html, css, css-selectors

我有以下代码：

```
div:nth-child(1) {
    background-color: red;  
}
```

```
<h1>Boxes</h1>
<div>1</div>
<div>2</div>
<div>3</div>
<div>4</div>
<div>5</div>
<div>6</div>
<div>7</div>
<div>8</div>
<div>9</div>
```

我希望选择`div`内容`1st`，但事实并非如此。但是，如果我删除了该`h1`元素，那么它会按预期工作。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-14T17:51:02.153

您遇到的问题是选择器本身`:nth-child()`：this 找到它所附加的元素，它`div`是其父元素的第 n 个子元素。

当您选择时：

```
div:nth-child(1) {
 /*...*/
} 
```

这不匹配任何东西；因为该`h1`元素是`:nth-child(1)`共享父项的第一个子项/。

要适应，您需要使用以下任一项：

```
div:nth-child(2) {
    background-color: red;  
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5GekP/)。

或者创建一个新的父级来包含`div`元素。

```
<h1>Boxes</h1>
<div>
    <div>1</div>
    <div>2</div>
    <div>3</div>
    <div>4</div>
    <div>5</div>
    <div>6</div>
    <div>7</div>
    <div>8</div>
    <div>9</div>
</div> 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5GekP/1/)。

在支持浏览器时，您还可以使用`:nth-of-type(1)`：

```
div:nth-of-type(1) {
    background-color: red;  
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/5GekP/2/)。

参考：

*   [`:nth-of-type()`](https://developer.mozilla.org/en-US/docs/CSS/%3anth-of-type).

# spring - 调用托管属性的 getter 时的 NPE

> ID：12884822
> 
> 赞同：3
> 
> 时间：2012-10-14T17:46:05.530
> 
> 标签：spring, jsf-2, nullpointerexception

我正在使用 Hibernate 学习 Spring，并正在使用 JSF 作为前端框架创建电影租赁应用程序。

我的注册 bean 中有一个应用程序范围的托管属性，它是视图范围的。在`register()`将用户详细信息插入数据库的方法中，我调用服务定位器实现 bean 以获取对所需服务实现的引用。但是，当我调用服务定位器属性的 getter 时，我得到了一个 NPE。

以下是我的托管豆...

**注册豆**

```
@ManagedBean
@ViewScoped
public class RegistrationBean extends BaseBean implements Serializable
{
   private static final long serialVersionUID = -6449858513581500971L;

   private String userID;
   private String password;
   private String firstName;
   private String lastName;
   private String email;
   private String addressLine1;
   private String addressLine2;
   private String city;
   private String state;
   private String pincode;

   public RegistrationBean() {
      super();
   }

   // getter / setters...

   public String register() 
   {
      String nextPage = null;
      try {
         RegistrationDetails userDetails = ModelBuilder.populateRegistrationData(this);

         // NPE at this line. getServiceLocator() returns null
         int registrationID = getServiceLocator().getUserService().registerUser(userDetails);

         nextPage = "success";
      }
      catch (RegistrationException e) {
         LOGGER.error(e.getMessage());
      }
      return nextPage;
   }
} 
```

**基豆**

```
public class BaseBean
{
   @ManagedProperty("#{serviceLocator}")
   protected IServiceLocator serviceLocator;

   protected IServiceLocator getServiceLocator() {
      return serviceLocator;
   }

   public void setServiceLocator(IServiceLocator serviceLocator) {
      this.serviceLocator = serviceLocator;
   }
} 
```

**服务定位器 Bean**

```
@ManagedBean
@ApplicationScoped
public class ServiceLocator implements IServiceLocator
{
   private static final String USER_SERVICE = "userService";

   public ServiceLocator() {
      super();
      final ServletContext sc = FacesUtils.getServletContext();
      this.webAppContext = WebApplicationContextUtils.getRequiredWebApplicationContext(sc);
      this.userService = (IUserService) webAppContext.getBean(USER_SERVICE);
   }

   private ApplicationContext webAppContext;

   private IUserService userService;

   @Override
   public IUserService getUserService() {
      return userService;
   }

   public ApplicationContext getWebAppContext() {
      return webAppContext;
   }
} 
```

**这是在我的 Eclipse 控制台中看到的堆栈跟踪**

```
Oct 14, 2012 10:28:39 PM com.sun.faces.lifecycle.InvokeApplicationPhase execute
WARNING: #{registrationBean.register}: java.lang.NullPointerException
javax.faces.FacesException: #{registrationBean.register}: java.lang.NullPointerException
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.faces.el.EvaluationException: java.lang.NullPointerException
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    ... 23 more
Caused by: java.lang.NullPointerException
    at com.clixflix.managedbeans.RegistrationBean.register(RegistrationBean.java:118)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.apache.el.parser.AstValue.invoke(AstValue.java:278)
    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:274)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    ... 24 more 
```

我在用

*   JSF 2.1 (莫哈拉)
*   休眠 4.1
*   春天 3.2
*   雄猫 7
*   日食 3.7

如果我错过了什么，有人可以指出吗？

**更新**：弹簧配置文件

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans 
       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

   <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
      <property name="configLocation" value="/WEB-INF/hibernate.cfg.xml" />
   </bean>

   <bean id="hibernateTemplate" class="org.springframework.orm.hibernate3.HibernateTemplate">
      <property name="sessionFactory" ref="sessionFactory" />
   </bean>

   <bean id="userDAO" class="com.clixflix.dao.impl.UserDAOImpl">
      <constructor-arg index="0" ref="hibernateTemplate" />
   </bean>

   <bean id="userService" class="com.clixflix.services.impl.UserService">
      <constructor-arg index="0" ref="userDAO" />
   </bean>

</beans> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T20:09:41.630

这篇文章帮助我使代码工作：[http ://www.javacodegeeks.com/2012/04/jsf-2-primefaces-3-spring-3-hibernate-4.html](http://www.javacodegeeks.com/2012/04/jsf-2-primefaces-3-spring-3-hibernate-4.html)

但是，如果我将注册 Bean 保留为`view scoped`. 任何人都可以帮我找出同样的原因吗？

更新：找到 ViewScope 问题的解决方案：http: [//blog.harezmi.com.tr/spring-view-scope-for-jsf-2-users/](http://blog.harezmi.com.tr/spring-view-scope-for-jsf-2-users/)

# node.js - 在 Node 中使用 Passport 中间件进行 Twitter 身份验证

> ID：12884825
> 
> 赞同：8
> 
> 时间：2012-10-14T17:46:15.113
> 
> 标签：node.js, twitter, oauth, express, passport-twitter

我正在使用 Node.js 开发一个网站（使用 Express 框架）。为了使用 Twitter 身份验证，我使用`passport`了模块 (http://passportjs.org)，他的 Twitter 包装器名为`passport-twitter`.

我的服务器端脚本是：

```
/**
 * Module dependencies.
 */

var express = require('express')
  , routes = require('./routes')
  , user = require('./routes/user')
  , http = require('http')
  , path = require('path')
  , passport = require('passport')
  , keys = require('./oauth/keys')
  , TwitterStrategy = require("passport-twitter").Strategy;

var app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('foo'));
  app.use(express.session());
  // Initialize Passport!  Also use passport.session() middleware, to support
  // persistent login sessions (recommended).
  app.use(passport.initialize());
  app.use(passport.session());
  app.use(app.router);
  app.use(require('less-middleware')({ src: __dirname + '/public' }));
  app.use(express.static(path.join(__dirname, 'public')));
});

app.configure('development', function(){
  app.use(express.errorHandler());
});

passport.serializeUser(function(user, done) {
  done(null, user.id);
});

passport.deserializeUser(function(id, done) {
  User.findById(id, function (err, user) {
    done(err, user);
  });
});

passport.use(new TwitterStrategy({
    consumerKey: keys.twitterConsumerKey,
    consumerSecret: keys.twitterConsumerSecret,
    callbackURL: "http://local.host:3000/auth/twitter/callback"
  },
  function(token, tokenSecret, profile, done) {
    User.findOrCreate({ twitterId: profile.id }, function (err, user) {
      if (err) { return done(err); }
      else { return done(null, user); }
    });
  }
));

app.get('/', routes.index);
app.get('/contacts', routes.contacts);
app.get('/cv', routes.cv);
app.get('/projects', routes.projects);
app.get('/users', user.list);

// Redirect the user to Twitter for authentication.
// When complete, Twitter will redirect the user back to the
// application at /auth/twitter/callback
app.get('/auth/twitter', passport.authenticate('twitter'));

// Twitter will redirect the user to this URL after approval.  Finish the
// authentication process by attempting to obtain an access token.  If
// access was granted, the user will be logged in.  Otherwise,
// authentication has failed.
app.get('/auth/twitter/callback', 
  passport.authenticate('twitter',
    {
      successRedirect: '/',
      failureRedirect: '/login'
    }
  )
);

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

与登录关联的 URI 是`http://local.host:3000/auth/twitter`；当我访问它时，Twitter 向我显示了将我的帐户与我自己的网站链接的身份验证表单，但是在此步骤之后，出现以下错误：

```
Express
500 ReferenceError: User is not defined 
```

我怎么解决这个问题？最好的问候，六。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-14T20:40:26.630

您必须在某处定义您的用户类型。看起来您希望这个东西`User`存在并具有功能`findOrCreate`and `findById`，但您从未在任何地方定义过。您在哪里“找到”这些用户？那些没有被发现的，它们在哪里被“创造”？你在使用数据库吗？你如何连接到数据库？我认为您忘记了“模型”步骤。你可能想看看[Mongoose Auth](https://github.com/bnoguchi/mongoose-auth)，它类似于 Passport，但它直接插入[Mongoose](http://mongoosejs.com/)，它连接到[Mongo](http://www.mongodb.org/)数据库

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-06T09:21:30.947

这就是我遇到相同的错误时所做的，即`User`未定义：

```
passport.use(new TwitterStrategy({
    consumerKey: keys.twitterConsumerKey,
    consumerSecret: keys.twitterConsumerSecret,
    callbackURL: "http://local.host:3000/auth/twitter/callback"
  },
  function(token, tokenSecret, profile, done) {
    done(null, profile);
  }
)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-07T19:26:40.347

在 Kraken 中集成 Passport 的 BeatsMusic OAuth2 策略时遇到了同样的问题。看起来各种 Kraken Passport 集成策略的示例使用相同的简单示例文档，该文档没有明确讨论 User 对象（可以理解）。

我发现（通过挖掘通过 @ [https://github.com/krakenjs/kraken-examples/tree/master/with.passport](https://github.com/krakenjs/kraken-examples/tree/master/with.passport)找到的护照策略示例）用户旨在成为基于猫鼬模型模式的模型并且还配置了[https://github.com/drudge/mongoose-findorcreate](https://github.com/drudge/mongoose-findorcreate)插件。

在我包含`User = require('../PATH_TO/user')`并将这个插件添加到用户模型之后，瞧！没有更多的错误:)

听起来您不需要数据库功能，因此您可能很适合删除身份验证检查。

希望这对其他有类似问题的人有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-12T15:22:43.773

我认为 api 还没有为不需要用户数据库集成的情况做好准备。我的解决方案是忽略该`done()`功能并重定向到成功页面。

```
passport.use(new TwitterStrategy({
    consumerKey: keys.twitterConsumerKey,
    consumerSecret: keys.twitterConsumerSecret,
    callbackURL: "http://local.host:3000/auth/twitter/callback"
  },
  function(token, tokenSecret, profile, done) {
    //done(null, profile);
    this.redirect('/auth/success');
  }
)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-25T20:27:58.497

进一步解释 Max 的回答：“你需要`User`自己创造”

[在这里阅读](https://scotch.io/tutorials/easy-node-authentication-setup-and-local#user-model)

TL:DR - 基本上你必须有一个用于设置用户和验证用户的用户模式，它需要一个 mongoose db 后端，实际上配置起来很简单。

本质上是创建这个中间件：

```
var mongoose = require('mongoose');
var bcrypt   = require('bcrypt-nodejs');

// define the schema for our user model
var userSchema = mongoose.Schema({

    local            : {
        email        : String,
        password     : String,
        group        : String,
    },
    facebook         : {
        id           : String,
        token        : String,
        email        : String,
        name         : String
    },
    twitter          : {
        id           : String,
        token        : String,
        displayName  : String,
        username     : String
    },
    google           : {
        id           : String,
        token        : String,
        email        : String,
        name         : String
    }

});

// methods ======================
// generating a hash
userSchema.methods.generateHash = function(password) {
    return bcrypt.hashSync(password, bcrypt.genSaltSync(8), null);
};

// checking if password is valid
userSchema.methods.validPassword = function(password) {
    return bcrypt.compareSync(password, this.local.password);
};

// create the model for users and expose it to our app
module.exports = mongoose.model('User', userSchema); 
```

# php - MySQL - 一个表中的一列与另一表中的另一列的总和

> ID：12884826
> 
> 赞同：3
> 
> 时间：2012-10-14T17:46:15.750
> 
> 标签：php, mysql, sum

我有两张桌子

表 1 是

```
 idno         marks
     1             12
     1             13
     1             22 
     2             32 
     2             35
     2             11  and so on 
```

表 2 是

```
 idno          marks
     1              16
     1              22 
     1              21 
     2              35 
     2              16
     2              22   and so on 
```

我正在为用户提供输入 idno 并提交的表单

如果用户在表单中输入“1”并提交，那么输出应该是

```
 Total Marks
            106 
```

即表1中Idno 1的所有分数之和+表2中Idno 1的所有分数之和

(12+13+22)+(16+22+21) = 106

我正在使用以下代码

```
<form id="form" action="sum.php" method="post">
<td><p align="center"> IDNO : <input type="text" name="id" id="id" maxlength="10"></p></td>
<input type="submit" id="submit" class='btnExample' value="Click here to get your Result"
</form>

<?PHP
$user_name = "admin";
$password = "123456";
$database = "demo";
$server = "localhost";
$db_handle = mysql_connect($server, $user_name, $password);
$db_found = mysql_select_db($database, $db_handle);

if ($db_found) {
$id = mysql_real_escape_string($_POST['id']);
$add = "SELECT htno, SUM(tech) 
FROM(SELECT htno, SUM(tm) AS tech FROM jbit WHERE htno='$id'
UNION ALL  
SELECT htno, SUM(tm1) AS tech  FROM hmm WHERE htno='$id') AS tech4 "; 
$result3 = mysql_query($add);
echo "
<center><table id='mytable' cellspacing='0'  border=3 align=center>
<tr>
<TH scope='col'>Total Marks</TH>
</tr><center>";
while ($row1 = mysql_fetch_assoc($result3)){
echo "<tr>";
echo "<td align=center>" . $row1['tech4']. "</td>";
echo "</tr>";
}
mysql_close($db_handle);
else {
print "Database NOT Found ";
mysql_close($db_handle);
} 
```

但输出为空白

请帮帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:48:07.793

```
WHERE htno='$id) AS tech4 "; 
               ^----here is the problem  should be htno='$id' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:55:25.083

在 WHERE 子句之后，您似乎在联合的两个部分都缺少**GROUP by htno 。**或者您可以考虑从联合的 SELECT 子句中删除*htno*字段。

```
 select sum(sm) from
   (select Sum(marks) sm from sums1 where idno=1
   union
   select Sum(marks) sm from sums2 where idno=1 ) ss 
```

在 mysql 上测试过，它可以工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T20:27:38.293

```
SELECT SUM(tech) AS tech4 FROM (
(SELECT SUM(tm) AS tech FROM jbit WHERE htno='$id')
UNION ALL
(SELECT SUM(tm) AS tech FROM hmm WHERE htno='$id')
) t1 
```

# sql-server - 使用 select 将不同的数据插入新表并同时计算总和

> ID：12884830
> 
> 赞同：0
> 
> 时间：2012-10-14T17:46:31.930
> 
> 标签：sql-server, select, sum, distinct

使用 MS SQL 我正在尝试以下操作：

我有一张包含游戏数据的表格。在此表中，玩家名称可能出现多次。我现在想创建一个汇总表，每个玩家都有一行。

使用以下语句，我可以填充汇总表的“玩家名”列。

```
INSERT INTO PLAYER_Summary (Playername)
SELECT DISTINCT [Playername]  
FROM ppPLAYER 
```

汇总表还包含玩家结果总和的列。

我如何填充我的汇总表，以便每个名称和相关的总和都在其中一次。

我需要类似的东西：

```
INSERT INTO PLAYER_Summary
(Playername, WinWhat )
SELECT DISTINCT [Playername] FROM ppPLAYER , SUM(WinWhat) FROM ppPLAYER 
```

我怎样才能完成这项工作并用他的总和解析唯一的玩家名？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:54:31.630

```
INSERT INTO PLAYER_Summary
(Playername, WinWhat )
SELECT Playername, SUM(WinWhat)
FROM ppPLAYER 
group by Playername 
```

# java - 如何从 Java 传递和访问 C 数据？

> ID：12884834
> 
> 赞同：0
> 
> 时间：2012-10-14T17:46:50.553
> 
> 标签：java, c

我一直在用 Java 和 C 做一些编程，但现在我需要同时使用两者。

情况就是这样，我使用 hadoop/Hbase 处理和存储大量数据，但我使用 C/Cuda 对数据进行数字运算。是否有一种稳定/成熟/通用的方式来获取 Java 中的数据（它基本上是一个日志文件）并将其传递给 C 程序，该 C 将其存储为链表的数据处理，然后由 Java 应用程序访问？

我可能没有在寻找正确的东西，但到目前为止，我找到了 JavaCPP，它很好，但似乎将两个程序结合在一起。因为 Java 处理数据流，而 C 处理数据处理，所以我认为最好将它们保留为可以相互通信的独立程序，而不是可能会变得混乱的单个程序。但我完全灵活，所以欢迎任何建议/解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:17:39.697

如果您将它们分开然后使用客户端-服务器方法，或者简单地选择一种通用文件格式并让后面的步骤轮询输出目录以处理新文件，您可能会发现更容易保持程序的可测试性和清晰性。

为了更轻松地定义跨不同语言的文件格式，请考虑使用[Apache Thrift](http://thrift.apache.org)或[Google Protocol Buffers](http://code.google.com/p/protobuf/)之类的包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:09:49.490

这里是我的头上 1\. 使用来自 java 应用程序的命令行运行 C 程序。2\. 使用 JNI/JNA 3\. 实现自己的“客户端-服务器”架构。这听起来很复杂，但在某些情况下，它可能是最好和最简单的解决方案。4\. 使用 Web 服务、SOAP、REST 等进行通信。

我希望这对开始有帮助。欢迎您提出更具体的问题。

# wpf - 禁用 Charms Bar 的场景

> ID：12884839
> 
> 赞同：0
> 
> 时间：2012-10-14T17:47:14.940
> 
> 标签：wpf, windows-8, charms-bar

当我有一个全屏运行的 wpf 应用程序时，我需要禁用超级按钮，有没有办法做到这一点？我需要禁用它，因为它是一个触摸屏应用程序，我不希望用户切换到其他应用程序谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:51:08.460

为此，您需要使用注册表，特别是转到：

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\ImmersiveShell 
```

创建一个名为 的键`EdgeUI`，然后添加一个名为 的**DWORD**值`DisableCharmsHint`，其值为 **1**。您可以在应用程序内或从应用程序外部进行注册表修改，因为它可能是某种信息亭。

# html - 如何让我的标题图像填充宽度，同时保持相同的高度和纵横比？

> ID：12884840
> 
> 赞同：0
> 
> 时间：2012-10-14T17:47:27.790
> 
> 标签：html, css, image

我有一个 1358 × 218 的标题图像。在较大的屏幕上，它不适合屏幕的宽度。我希望它缩放图像，保持纵横比，所以宽度总是填充浏览器宽度的 100%。这是我目前拥有的代码：

[http://jsfiddle.net/qD5n5/](http://jsfiddle.net/qD5n5/)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:55:07.293

您不能修改背景图像大小。你必须这样：

```
<div id="header" style="oveflow: hidden; height: 50px /*your fixed height*/">
  <img src="background.jpg" style="max-width: 100%" />
</div> 
```

这会将图像拉伸到 100%，保持纵横比和溢出：隐藏会让你保持固定的高度。

这是小提琴：http: [//jsfiddle.net/kumiau/qD5n5/1/](http://jsfiddle.net/kumiau/qD5n5/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:53:46.457

在现代浏览器（IE >= 9 和其他浏览器）上，您可以使用[`background-size: cover`](https://developer.mozilla.org/en-US/docs/CSS/background-size). 否则，您将需要更改标记，可能通过使用`<img>`标签而不是 CSS 背景来显示图像。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-14T17:53:13.423

只要去掉高度，如果你设置了宽度而不设置高度，浏览器将保持纵横比

```
 #header {
    background-image:url('http://i.imgur.com/RvQdH.jpg');
    width:100%;        
    margin-left:auto;
    margin-right:auto;
    background-position:center;
    background-repeat:no-repeat;
   }​ 
```

将这些 css 设置用于实际`<img>`标签，而不是用于浏览器正确调整大小的 div

# scala - 这两种方法定义有什么区别？

> ID：12884841
> 
> 赞同：2
> 
> 时间：2012-10-14T17:47:35.643
> 
> 标签：scala

> **可能重复：**
> [如果我们可以不使用括号来定义不需要任何参数的函数，为什么要在 Scala 中使用空括号？](https://stackoverflow.com/questions/3877953/why-to-use-empty-parentheses-in-scala-if-we-can-just-use-no-parentheses-to-defin)

考虑我们有一个`Foo`带有方法的类`bar`（它不接受任何参数并返回字符串`"bar"`）。实现bar有两种方式

第一个是

```
class Foo {
  def bar() = "bar"
} 
```

第二个是

```
class Foo {
  def bar = "bar"
} 
```

虽然两者的作用基本相同，但它们的名称需要不同，第一个像这样

```
someFoo.bar() 
```

第二个

```
someFoo.bar 
```

为什么我应该使用一个而不是另一个，根本区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:55:06.277

定义一个不带括号的参数的方法意味着该方法是*纯*的（它没有副作用并且不依赖于程序的状态）。此类方法不能用括号调用：

```
class Square(val side: Int) {
  def area = side * side
}

s = new Square(10);
s.area //ok
s.area() //compilation error 
```

调用不带括号的参数的方法意味着该方法有一些副作用和返回类型`Unit`。用空括号定义的方法可以在有或没有它们的情况下调用。

```
class Foo {
  def bar(): Unit = println("bar")
}

f = new Foo();
f.bar; //ok, bad style
f.bar(); // good 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:35:38.683

1.  它们都不需要用括号调用。Yet`def bar = "bar"`需要在没有括号的情况下被调用，因为括号将被暗示应用于它的结果，因此在这种情况下调用`bar()`将具有与 . 相同的效果`"bar"()`。

2.  这只是约定俗成的问题。在我的实践中，我看到了两个：

    *   标准（用于标准库和大多数第 3 方库）。当该方法没有产生副作用时，放弃括号。“纯”，即除了不引起任何副作用也不取决于状态，但是不是必需的。根据这一约定，您的第二个示例将是正确的示例。
    *   斯卡拉兹。只要方法没有参数，就去掉括号，即该方法可能会产生副作用。例如，他们拉皮条`print`不带括号的方法。

Bozhidar 提出了另一个约定，但老实说，这是我第一次接触它。

# linux - makefile 不生成可执行文件

> ID：12884845
> 
> 赞同：1
> 
> 时间：2012-10-14T17:47:59.123
> 
> 标签：linux, bash, makefile

我对makefile相当陌生。我正在尝试创建一个编译 yu.c 并链接 yu.c 以获取名为 yu 的可执行文件的 makefile。
下面是我的代码。我正在使用 make -f mymakefile 运行文件，每次运行时，只完成 gcc -c yuFile.c 。我哪里错了？

```
CC=gcc

yu.o: yuFile.c
    ${CC} -c yuFile.c
yu: yuFile.o
    ${CC} yu -o yuFile.o
run-c: yu
    ./yu
clean:
    rm -f "*.o" core 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:50:43.433

`make`没有指定目标使文件中的第一个目标，所以在你的情况下它相当于`make yu.o`.

通常，您创建第一个目标`all`，以便构建所有内容：

```
all: yu
.PHONY: all 
```

（请注意，如果已经有一个名为的文件，则`.PHONY`不会`make`执行任何操作`all`）。

值得指出的是：你的论点在`yu`目标中被颠倒了。它应该是

```
yu: yuFile.o
    ${CC} yuFile.o -o yu 
```

或更笼统地说

```
yu: yuFile.o
    ${CC} $^ -o $@ 
```

（`$^`表示所有先决条件，并`$@`表示目标，如[自动变量](http://www.gnu.org/software/make/manual/html_node/Automatic-Variables.html)中所述）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T17:51:30.413

第一个目标是未指定参数时选择的目标。标准是首先要有一个“全部”目标：

全体：于

此外，您的“yu”目标不正确。

```
yo: yufile.o
   $(CC) -o $@ $^ 
```

应该管用

# go - select 的奇怪行为（不允许其他 goroutine 运行）

> ID：12884849
> 
> 赞同：4
> 
> 时间：2012-10-14T17:48:08.117
> 
> 标签：go

我正在尝试使用[https://github.com/klkblake/Go-SDL](https://github.com/klkblake/Go-SDL)在 go 中编写 SDL 应用程序。
我创建了计时器来调用它的绘图功能：

```
render_timer := time.NewTicker(time.Second / 60) 
```

事件循环中的某处：

```
for running == true {
    [...]
    [process sdl events]
    [...]
    select {
    case <-render_timer.C:
        call_my_draw_function()
    default:
        some_default_actions()
    }
    [...]
} 
```

如果我在编译此代码后运行程序，则屏幕上不会绘制任何内容。但如果我只放置：

```
fmt.Println("default") 
```

在*select的**默认*分支中——代码开始按我的意愿工作（在窗口中绘制一些东西）；如果我再次删除 println 它就不会画任何东西。 我究竟做错了什么？为什么会有这样的*select*行为？

 *** * *

嗯...最简单的测试用例是：

```
package main

import (
"fmt"
"time"
)

func main() {

    rt := time.NewTicker(time.Second / 60)
    for {
        select {
        case <-rt.C:
            fmt.Println("time")
        default:
        }
    time.Sleep(1) // without this line 'case <-rt.C' is never executed
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-14T18:50:14.157

至于您的示例，您的循环是一个繁忙的循环，不断地遇到问题`default:`。go 中的调度程序是协作的，并且由于您处于忙碌的循环中，因此运行 Ticker 的 go 例程将永远不会被安排运行，因此永远不会在通道上发送任何内容。即使您的`default:`案例不为空，但会进行纯计算，情况也会如此 - 从不进行任何调用 schudler 的调用。

但是，当您执行以某种形式调用 go 调度程序的其他操作时，例如执行 I/O ，调度程序将给 Ticker 一个运行的机会。

您可以导入运行时包并执行

```
default:
    runtime.Gosched() 
```

使调度程序运行，这不会饿死 Ticker 去例程。

我不确定这如何导致您在运行 SDL 时遇到问题，因为这很可能涉及 I/O 或其他触发调度程序的东西

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-14T18:51:57.413

请参阅[golang：除非我添加了 fmt.Print()，否则带有 select 的 goroute 不会停止](https://stackoverflow.com/questions/12615955/golang-goroute-with-select-doesnt-stop-unless-i-added-a-fmt-print/12617389#comment17015918_12617389)

长话短说，由于默认情况，并且因为您的 GOMAXPROCS 可能设置为 1（默认值），它永远不会安排 goroutine 完成其工作。有很多选项可以解决这个问题，具体取决于您的需要（默认睡眠，选择而不是默认的 time.After() 通道，调用 runtime.Gosched() 等）。

添加 fmt.Print 使其工作，因为 - 我的猜测，不确定 - 它涉及 io 并在内部导致 Gosched() （或者类似 Phlip 在相关问题中的答案，我刚刚读过它）。**

# sql - SQL 当输出 COLUMN 顺序很重要时如何有效地使用动态 sql 查询

> ID：12884850
> 
> 赞同：0
> 
> 时间：2012-10-14T17:48:10.370
> 
> 标签：sql, sql-server, tsql, dynamic-sql

我的问题实际上是如何确保在使用动态查询获取数据时保持 OUTPUT 的 ORDER。我有几个正在使用的动态查询，我注意到当我在不同的机器上运行相同的查询时，我得到的输出顺序不同。目前，我将输出的数据存储到一个临时表中，该表假定输出的顺序与我本地机器上的顺序相同，但在生产中，它全部被打开。如何对此进行更多控制，以便**每次**运行查询时都保持输出顺序？

当我在动态查询中使用 Order BY 时，出现错误

**消息 1033，级别 15，状态 1，第 18 行 ORDER BY 子句在视图、内联函数、派生表、子查询和公用表表达式中无效，除非还指定了 TOP、OFFSET 或 FOR XML。**

```
 DECLARE @colsUnpivot AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX),
    @colsPivot as  NVARCHAR(MAX)

           IF EXISTS
                (
                            SELECT *
                            FROM tempdb.dbo.sysobjects
                            WHERE ID = OBJECT_ID(N'tempdb..#ibutes')
                )
                BEGIN
                            DROP TABLE #ibutes
                END
    Create table #ibutes
    (
                ProductID uniqueIdentifier,
            PAID uniqueidentifier, 
            Label nvarchar(50),
            Val nvarchar(3072),
            unit nvarchar(50) 
    )
    ;With Number
As
(
 Select 1 as rownum union all  Select 2 union all Select 3 union all Select 4 union all Select 5 union all Select 6 union all Select 7 union all Select 8 union all Select 9 union all Select 10 union all Select 11 union all Select 12 union all Select 13 union all Select 14 union all Select 15 union all Select 16 union all Select 17 union all Select 18 union all Select 19 union all Select 20 union all Select 21 
),
ProductDetail 
as 
(
   select P.ProdID, N.rownum from IDWProduct P cross join Number N
)
Insert into #ibutes
Select ProdID ,  PAVibuteID, COALESCE(PANAme,''), COALESCE(PAVValue,''), COALESCE(unitLabel,'') 
 from ProductDetail P
Left join 
(select Pr.*, PAName, row_number() over (partition by PAVProductID order by PAVID) as Rn from IDWProductibuteValues Pr  
inner join IDWibutes  on PAID = PAVibuteID Where PAIscustom = 0 AND PAIsManufacturerSpecific =0 AND PANAME NOT IN 
('Brand Name', 'Standard', 'Application', 'Sub Brand', 'Type', 'Special Features')) 
Pr ON rownum = Pr.Rn And PAVProductID = ProdID  
left join IDWUnitofMeasures on Pr.PAVunit = unitID 

--Select * from #ibutes

   select @colsUnpivot = stuff((select ','+quotename(C.name)
         from tempdb.sys.columns as C  
         where C.object_id = object_id('tempdb..#ibutes')  AND  C.name Not in ('ProductID')
         for xml path('')), 1, 1, '')

 --select @colsUnpivot

 select @colsPivot = STUFF((SELECT  ','  + quotename(c.name   + cast(t.rn as varchar(10)))
                    from
                    (
                      select row_number() over(partition by ProductID   order by ProductID) rn  from #ibutes
                    ) t
                     cross apply 
                      tempdb.sys.columns  as C
                   where C.object_id = object_id('tempdb..#ibutes')   AND  C.name Not in ('ProductID')
                   group by c.name, t.rn
                   order by t.rn
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

  --select @colsPivot
  set @query = 'select *
      from
      (
        select ProductID,
            col + cast(rn as varchar(10)) new_col,
            val
        from 
        (
          select   
           Cast (PAID as NVarchar(3072)) PAID
           ,Cast (ProductID as NVarchar(3072)) ProductID
           ,Cast (Label  as NVarchar(3072)) Label
           ,Cast (Val as NVarchar(3072)) Val
           ,Cast (unit as NVarchar(3072))  unit  
            ,row_number() over(partition by ProductID order by ProductID) rn
          from #ibutes

     ) x
        unpivot
        (
          val
          for col in ('+ @colsunpivot +')
        ) u
      ) x1
      pivot
      (
        max(val)
        for new_col in
          ('+ @colspivot +')
      ) p'

exec(@query) 
```

运行查询的结果

在我的本地/开发机器上

=========================

```
select *
      from
      (
        select ProductID,
            col + cast(rn as varchar(10)) new_col,
            val
        from 
        (
          select   
       Cast (PAID as NVarchar(3072)) PAID
       ,Cast (ProductID as NVarchar(3072)) ProductID
           ,Cast (Label  as NVarchar(3072)) Label
           ,Cast (Val as NVarchar(3072)) Val
           ,Cast (unit as NVarchar(3072))  unit  
            ,row_number() over(partition by ProductID order by ProductID) rn
          from #ibutes
     ) x
        unpivot
        (
          val
          for col in ([Label],[unit],[Val],[PAID])
        ) u
      ) x1
      pivot
      (
        max(val)
        for new_col in
          ([Label1],[unit1],[Val1],[PAID1],[Label2],[unit2],[Val2],[PAID2],[Label3],[unit3],[Val3],[PAID3],[Label4],[unit4],[Val4],[PAID4],[Label5],[unit5],[Val5],[PAID5],[Label6],[unit6],[Val6],[PAID6],[Label7],[unit7],[Val7],[PAID7],[Label8],[unit8],[Val8],[PAID8],[Label9],[unit9],[Val9],[PAID9],[Label10],[unit10],[Val10],[PAID10],[Label11],[unit11],[Val11],[PAID11],[Label12],[unit12],[Val12],[PAID12],[Label13],[unit13],[Val13],[PAID13],[Label14],[unit14],[Val14],[PAID14],[Label15],[unit15],[Val15],[PAID15],[Label16],[unit16],[Val16],[PAID16],[Label17],[unit17],[Val17],[PAID17],[Label18],[unit18],[Val18],[PAID18],[Label19],[unit19],[Val19],[PAID19],[Label20],[unit20],[Val20],[PAID20],[Label21],[unit21],[Val21],[PAID21])
      ) p 
```

## 在生产机器上，但它是不同的。请注意更改顺序

列

```
select *
      from
      (
        select ProductID,
            col + cast(rn as varchar(10)) new_col,
            val
        from 
        (
          select   
       Cast (PAID as NVarchar(3072)) PAID
       ,Cast (ProductID as NVarchar(3072)) ProductID
           ,Cast (Label  as NVarchar(3072)) Label
           ,Cast (Val as NVarchar(3072)) Val
           ,Cast (Unit as NVarchar(3072))  Unit  
            ,row_number() over(partition by ProductID order by ProductID) rn
          from #ibutes
     ) x
        unpivot
        (
          val
          for col in ([PAID],[Label],[Val],[Unit])
        ) u
      ) x1
      pivot
      (
        max(val)
        for new_col in
          ([PAID1],[Label1],[Val1],[Unit1],[PAID2],[Label2],[Val2],[Unit2],[PAID3],[Label3],[Val3],[Unit3],[PAID4],[Label4],[Val4],[Unit4],[PAID5],[Label5],[Val5],[Unit5],[PAID6],[Label6],[Val6],[Unit6],[PAID7],[Label7],[Val7],[Unit7],[PAID8],[Label8],[Val8],[Unit8],[PAID9],[Label9],[Val9],[Unit9],[PAID10],[Label10],[Val10],[Unit10],[PAID11],[Label11],[Val11],[Unit11],[PAID12],[Label12],[Val12],[Unit12],[PAID13],[Label13],[Val13],[Unit13],[PAID14],[Label14],[Val14],[Unit14],[PAID15],[Label15],[Val15],[Unit15],[PAID16],[Label16],[Val16],[Unit16],[PAID17],[Label17],[Val17],[Unit17],[PAID18],[Label18],[Val18],[Unit18],[PAID19],[Label19],[Val19],[Unit19],[PAID20],[Label20],[Val20],[Unit20],[PAID21],[Label21],[Val21],[Unit21])
      ) p 
```

请注意顺序似乎按字母顺序排列的本地机器的区别

**[标签 1]，[单位 1]，[Val1]，[PAID1]，[标签 2]，[单位 2]。** . . .

在生产机器上，它不是

**[PAID1],[Label1],[Val1],[Unit1],[PAID2],[Label2],[Val2],[Unit2],... . .**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:51:09.807

我认为只有一个显而易见的答案。在动态查询中使用该`order by`子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T17:51:16.130

简而言之，不保证所有查询（无论是否动态）在不同机器上的结果都是一样的！
如果结果的顺序对您很重要，请使用`ORDER BY`

例如：

```
SELECT *
FROM TBL
ORDER BY FIRSTNAME 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-14T17:51:45.080

如果您要订购，请使用 order by。
如果没有订单，则无法保证订单。
如果有平局，则不能保证排序会在平局上重复。
使用足够多的列没有平局。

看来您指的是列的顺序而不是行的顺序。

如果选择 *，您将按照在表中定义的顺序排列列。
如果您需要控制列的顺序，请不要使用 *.

```
select table1.col4, table1.col2 
from table1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-13T00:00:07.603

你可以试试下面的吗？

将以下顺序添加到第一个查询中

```
select @colsUnpivot = stuff((select ','+quotename(C.name)
     from tempdb.sys.columns as C  
     where C.object_id = object_id('tempdb..#ibutes')  AND  C.name Not in ('ProductID')

ORDER BY c.column_id --Add this

     for xml path('')), 1, 1, '') 
```

通过以下第二个查询更改顺序

```
select @colsPivot = STUFF((SELECT  ','  + quotename(c.name   + cast(t.rn as varchar(10)))
                from
                (
                  select row_number() over(partition by ProductID   order by ProductID) rn  from #ibutes
                ) t
                 cross apply 
                  tempdb.sys.columns  as C
               where C.object_id = object_id('tempdb..#ibutes')   AND  C.name Not in ('ProductID')
               group by c.name, t.rn

               ORDER BY c.column_id --Change this

        FOR XML PATH(''), TYPE
        ).value('.', 'NVARCHAR(MAX)') 
    ,1,1,'') 
```

希望有帮助...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-14T19:33:37.583

为什么不更改以下内容：

```
set @query = 'select *
      from 
```

类似于

```
set @query = 'select *
      into #x
      from 
```

您需要`#x`在动态 sql ie 之前显式创建

```
create table #x
(
blah int,
blah char(8)
) 
```

然后在`exec`语句之后有一个进一步的查询

```
select *
from #x
order by whatever 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-14T18:37:51.803

现在我们知道您在哪里添加 ORDER BY，答案就更清楚了。您正在尝试对其结果插入@colsPivot 的查询进行排序，这就是问题所在。

ORDER BY 主要用于对最终结果进行排序，因此应该在最终查询（动态查询）上。
例外情况是，如果它被用作“限制”查询的一部分（例如 TOP 10）。

尝试将 ORDER BY 添加到动态查询中，让我们知道它是否有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-14T18:21:29.900

也许你可以试试这个

```
'select *
  from
  (
    select ProductID,
        col + cast(rn as varchar(10)) new_col,
        val
    from 
    (
      select top 100 percent
       Cast (PAID as NVarchar(3072)) PAID
       ,Cast (ProductID as NVarchar(3072)) ProductID
       ,Cast (Label  as NVarchar(3072)) Label
       ,Cast (Val as NVarchar(3072)) Val
       ,Cast (unit as NVarchar(3072))  unit  
        ,row_number() over(partition by ProductID order by ProductID) rn
      from #ibutes
      order by row_number() over(partition by ProductID order by ProductID) asc
 ) x
    unpivot
    (
      val
      for col in ('+ @colsunpivot +')
    ) u
  ) x1
  pivot
  (
    max(val)
    for new_col in
      ('+ @colspivot +')
  ) p' 
```

# c - 使用回溯的 n 皇后算法的基本逻辑

> ID：12884865
> 
> 赞同：0
> 
> 时间：2012-10-14T17:50:29.730
> 
> 标签：c, algorithm, backtracking

这个 n-queens 程序使用了一种奇怪的回溯逻辑。我多次尝试跟踪代码，但我总是对此感到困惑。我真的对**Place(int pos)**函数感到困惑。

```
#include<stdio.h>
#include<conio.h>
int a[30],count=0;
int place(int pos)
{
    int i;
    for(i=1;i<pos;i++)
    {
        if( (a[i]==a[pos]) || ((abs(a[i]-a[pos])==abs(i-pos))) )
        {
            return 0;
        }
    }
    return 1;
}

void print_sol(int n)
{
    int i,j;
    count++;
    printf("\nSOLUTION #%d\n",count);
    for(i=1;i<=n;i++)
    {
        for(j=1;j<=n;j++)
        {
            if(a[i]==j)
                printf("Q\t");
            else
                printf("*\t");
        }
        printf("\n");
    }
}

void queen(n)
{
    int k=1;
    a[k]=0;
    while(k!=0)
    {
        a[k]++;
        while(a[k]<=n && !place(k))
            a[k]++;
        if(a[k]<=n)
        {
            if(k==n)
                print_sol(n);
            else
            {
                k++;
                a[k]=0;
            }
        }
        else
            k--;
    }
}

void main()
{
    int n;
    clrscr();
    printf("\nEnter the number of queens:");
    scanf("%d",&n);
    queen(n);
    getch();
} 
```

我只想知道它是如何自动回溯的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:04:13.987

`place`只检查 row 中的皇后是否`pos`可以放在 column 中`a[pos]`。

回溯在`queens`函数中，当试图将皇后放在 row 中`k`时，最初`a[k]`为 0，这不是皇后的有效位置

```
a[k]++;     // here, a[k] was not a valid position and no smaller was valid, so increment
while(a[k]<=n && !place(k))  // while the position is invalid, check next
    a[k]++;
if(a[k]<=n)  // if a valid column was found
{
    if(k==n) // that was the last row, done
        print_sol(n);
    else     // next row
    {
        k++;
        a[k]=0;
    }
}
else  // no possible column found (a[k] > n), so backtrack
k--;  // check for next possible column in previous row 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:00:37.447

所做`place`的只是确定皇后编号是否`pos`可以被任何编号小于 的皇后攻击`pos`。它通过检查皇后 #pos 是否依次与其他皇后在同一列或对角线上来做到这一点。因此，如果`place(pos)`返回`1`，则表示 的值`a[pos]`是可以合法放置皇后的列的从零开始的索引。

# eucalyptus - 负载均衡代码修改-桉树查询

> ID：12884868
> 
> 赞同：2
> 
> 时间：2012-10-14T17:50:50.023
> 
> 标签：eucalyptus

我正在做一个云项目。

我想修改 Eucalyptus 代码以实现云中的负载平衡。我有使用 Eclipse 配置的源代码。我想知道源代码中负载均衡器的依赖文件，我需要更改它们以在 Eucalyptus 中添加动态负载均衡器。谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T00:00:29.013

据我了解，ELB 正在积极讨论中，应该很快就会出现在 Eucalyptus 中。对于最初的问题，如果你想编写自己的 ELB 版本，你需要对 Eucalyptus 进行大量修改，从 API 开始（你想使用 AWS 版本吗？实现你自己的？），才能得到真正的工作完毕。在#eucalyptus-devel（freenode）上闲逛并开始在那里提问可能更容易。

# angularjs - AngularJS DOM 访问初始化

> ID：12884875
> 
> 赞同：2
> 
> 时间：2012-10-14T17:51:23.333
> 
> 标签：angularjs

我写了这个简单的 jsfiddle，在其中我（成功地）在 ng-repeat 的指令上做了一些基本的 addClass。

[http://jsfiddle.net/rv6u2/5/](http://jsfiddle.net/rv6u2/5/)

现在，我的问题是：哪个是进行此类 DOM 操作的最佳（*或预期）位置：*

**A. 在指令中？**

**B. 在控制器中？**

我的示例中显示了这两种可能性。

**代码：**

```
var TestApp = angular.module("TestApp", ['ngResource']);
TestApp.directive('onLoad', function() {
    return {
        restrict: 'A',
        link: function(scope, elm, attrs) {
            elm.addClass('loaded'); // A: DOM manipulation in directive
            scope.initMe(scope.$eval(attrs.onLoad2), elm); // B: DOM manipulation handled in controller
        }
    };
}); 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T18:57:08.780

**永远不要**操纵控制器内部的 dom。

控制器应该只使用服务并更新 $scope 的属性。所有 DOM 操作都应该由指令和（在某些情况下）服务（例如[$anchorScroll](http://docs.angularjs.org/api/ng.%24anchorScroll)）进行

[在这里](http://docs.angularjs.org/guide/concepts)查看 angularjs 的概念

**更新：**[此处](http://jsfiddle.net/rv6u2/8/)正确方法的示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-16T15:50:51.407

设置类loaded2的更“角度方式”如下（避免控制器内部的DOM操作）：

在 HTML 中，为类 (myClass) 声明一个模型：

```
<div ng-repeat="item in items" ng-model="item" on-load="initMe(item)" ng-class="myClass"> 
```

在链接函数中，只需调用控制器方法：

```
scope.initMe() 
```

在控制器中，操作 model/$scope 属性：

```
$scope.initMe = function() {
   $scope.myClass = "loaded2";
} 
```

更改模型/范围将自动更新视图。

如果您想在 HTML 中声明一个类由 $scope 属性 myClass 控制，则此方法很有用。但是，在链接函数中使用 elm.addClass() 更加独立且更易于维护（我更喜欢这种方法）。

# prolog - Prolog 简单程序

> ID：12884876
> 
> 赞同：0
> 
> 时间：2012-10-14T17:51:27.863
> 
> 标签：prolog, dcg

我正在编写一个小 Prolog 程序，预计将执行以下操作：

```
?-input([allan,is,a,name]).
 true.
?-input([Is,allan,a,name]).
 true. 
```

这是我的代码：

```
% Simple answering agent

input(Text) :-
phrase(sentence(S), Text), 
perform(S).

sentence(statement(S)) --> statement(S).

sentence(query(Q))     --> query(Q).

statement(Statement) --> 
    [Thing, 'is', 'a', Category],
    { Statement =.. [Category, Thing]}.

query(Query) --> 
   ['Is', Thing, 'a', Category],
   { Query =.. [Category, Thing]}.

perform(statement(S)) :- asserta(S).

perform(query(Q))     :- Q. 
```

该`input([allan,is,a,name]).`部分似乎工作正常，但查询部分有问题，如果我输入`input([Is,allan,a,name]).`，它会打印

```
Is = 'Is' 
```

谁能帮我看看这个问题，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:10:31.800

好吧，问题在于它`Is`是一个变量，因此 prolog 实例化它（使用`'Is'`）。确保列表的所有成员都是原子是一种很好的做法，但为了快速修复，您可以这样做：

```
query(Query) --> 
[_, Thing, 'a', Category],
{ Query =.. [Category, Thing]}. 
```

这样，`Is`不会被实例化，prolog 只会说真。唯一的问题是一个语句可以被解释为一个查询：

```
9 ?- input([allan, is, a, name]).
true ;                                   
false.                                   

10 ?- input([is, is, a, name]).       
true .                                   

11 ?- input([allan, is, a, name]).       
true ;                                   
true. 
```

可以通过一些削减来修复（或者说`Thing`应该不同于`'is'`- 如果可以接受的话）

编辑：对于更通用的解决方案：这实际上取决于您要解析的句子类型以及用户可以做出的妥协。例如，也许可以让他给你一些序言原子的词；如果请求以大写字母开头的单词，他将不得不使用`''`. 否则，最好将它们放在字符串/原子（`'Is allan a name'`或`"Is allan a name"`）中。将其分离为单个原子很容易：[使用 atomic_list_concat/3](http://www.swi-prolog.org/pldoc/doc_for?object=atomic_list_concat/3)。因为`what is allan`你仍然不需要做一些特别的事情；这是一个 3 个单词的句子，而其余的是 4 个单词，因此您可以立即将其分开。

# java - 在java中显示系统消息而不中断用户输入

> ID：12884880
> 
> 赞同：1
> 
> 时间：2012-10-14T17:51:49.200
> 
> 标签：java, shell

我正在用java编写一个shell程序，它提示我的用户输入输入（即“提示：”）

然而，监控活动的单独线程也会打印到 shell，例如：“客户端已连接！”

关于如何使它成为一个更加用户友好的环境的任何想法/提示，其中用户在返回之前的输入不会被系统消息中断，但仍然允许显示消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T18:05:39.273

Typical console applications print information to screen sequentially. Programs the print information while waiting response to user are interactive program that usually control where and how do they print information. As an example you can see how `top` works on Unix.

There is a way to implement such kind of applications in java. You have to implement escape sequences for each supported terminal, so that you can control where and how to print each character. Fortunately there is such library that already does this.

See for example this discussion: [What's a good Java, curses-like, library for terminal applications?](https://stackoverflow.com/questions/439799/whats-a-good-java-curses-like-library-for-terminal-applications)

# android - 从 android 上的谷歌驱动器打开自定义文件扩展名

> ID：12884881
> 
> 赞同：9
> 
> 时间：2012-10-14T17:51:50.167
> 
> 标签：android, mime-types, google-drive-api

我正在努力解决如何通过 google drive ui 在我的 android 应用程序中打开自定义文件扩展名。我的文件目前可以通过 Dropbox 或 android 文件资源管理器正常打开。谷歌驱动器似乎只考虑文件的 mime 类型。文件扩展名是我自己的（比如说.xyz），文件在里面是xml。我希望文件在我的应用程序中打开，而不仅仅是注册为打开 text/xml mime 类型的任何应用程序。我怎么能告诉谷歌驱动 .xyz 文件不被视为文本/xml。同样，我不希望我的应用程序被注册以打开所有文本/xml 文件。

所以最终用户的工作流程是这样的： 1) 打开 Google Drive 安卓应用。2）点击“somefile.xyz”->该文件将在我的应用程序中打开。目前它在 google drive xml 查看器中打开。3）点击“otherfile.xml”->该文件不会在我的应用程序中打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T23:27:26.107

原来这个问题的答案是你不能那样做。

使用名为 .xyz 的文件和内部的 xml 格式，您可以做的最好的事情是创建各种意图过滤器来处理其他应用程序识别文件的所有方式。例如，我将以下 mimeTypes 放在我的意图过滤器中。

*   Google 云端硬盘 - 文本/xml
*   ICS Gmail - 文本/纯文本
*   JellyBean Gmail - 应用程序/八位字节流

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:01:25.797

您可以将文件保存到应用程序的私有目录，然后任何其他应用程序都不会访问它

通过此链接查看如何做到这一点

[http://developer.android.com/training/basics/data-storage/files.html](http://developer.android.com/training/basics/data-storage/files.html)

Context.MODE_PRIVATE 和 getFilesDir() 可能对您有所帮助。

或者，如果您希望其他应用程序为您执行某些操作并将结果返回到您的应用程序，请执行此操作。

[http://developer.android.com/training/basics/intents/sending.html](http://developer.android.com/training/basics/intents/sending.html)

或者

[http://developer.android.com/training/basics/intents/filters.html](http://developer.android.com/training/basics/intents/filters.html)

# jquery - 如何在同一页面上获取多个版本的 jQuery，其中一个版本仅用于特定插件

> ID：12884887
> 
> 赞同：0
> 
> 时间：2012-10-14T17:52:25.663
> 
> 标签：jquery

我在使用时遇到问题`jQuery.noConflict(true)`

`var jq = $.noConflict(true);`

```
(function(jq) {
    var jq = $;
    console.log($);
})(_jQuery) 
```

但我不断收到未定义的错误。有什么东西可以帮助我将值传递给这个函数，以便我可以使用 jQuery 吗？

**编辑：**我正在尝试在自动执行功能中运行插件

```
(function($) {
console.log($); 

   (function($){

   })(jQuery)

})(jq) 
```

问题是函数不断地变得未定义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:56:55.390

我想也许你打算做这样的事情来删除所有 jQuery 全局变量，将主 jQuery 全局变量分配给你自己的变量`jq`，然后将它传递给一个自执行函数，该函数接受一个名为的参数`$`，这样你就可以`$`在自执行内部使用函数作为 jQuery 的名称，如下所示：

```
var jq = jQuery.noConflict(true);

(function($) {
    console.log($);
})(jq); 
```

如果您真正想做的是在同一页面上加载多个版本的 jQuery，您可以阅读这篇文章：[我可以在同一页面上使用多个版本的 jQuery 吗？](https://stackoverflow.com/questions/1566595/can-i-use-multiple-versions-of-jquery-on-the-same-page).

执行原理如下：

```
<!-- load jQuery 1.3.2 -->
<script type="text/javascript" src="http://example.com/jquery-1.3.2.js"></script>
<script type="text/javascript">
var jQuery_1_3_2 = $.noConflict(true);
</script>

<!-- load jQuery 1.8.2 -->
<script type="text/javascript" src="http://example.com/jquery-1.8.2.js"></script>
<script type="text/javascript">
var jQuery_1_8_2 = $.noConflict(true);
</script> 
```

然后，要为您的插件创建一个环境，您可以这样做：

```
(function(jQuery) {
    var $ = jQuery;
    // now both jQuery and $ refer to version jQuery 1.3.2 inside this closure
    // use your plugin that requires 1.3.2 here
})(jQuery_1_3_2); 
```

如果这是我的项目，我会花一些精力来弄清楚如何让我的所有代码使用相同版本的 jQuery，因为多个版本的 jQuery 会减慢页面的加载速度，消耗更多内存并使开发和故障排除复杂化. 这没什么好说的。

# mvvm - MVVM 使用 UI 的构造函数来传递模型

> ID：12884888
> 
> 赞同：0
> 
> 时间：2012-10-14T17:52:39.480
> 
> 标签：mvvm

我想太多了，让自己陷入了混乱，但无法理清头绪。

我是 WPF 的新手，我正在尝试熟悉 MVVM。我理解这个理论。我需要一个视图、一个模型和另一个模型（称为视图模型）。

但是，如果我的模型是由 View 的构造函数的参数构造的，会发生什么情况。

所以，假设我有一个完全空的项目，唯一的事情是我有一个重载的 MainWindow 构造函数，它采用模型：

```
public MainWindow(Logging.Logger logFile)
        {
            InitializeComponent();
            this.DataContext = logFile;
        } 
```

模型是日志文件。当我没有单独的 Model 类时，我还能实现 MVVM 吗？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T19:53:54.137

你多虑了。

MVVM 有几个组件：

看法：

该视图提供了一个关于数据的视图。视图从视图模型中获取数据

视图模型：

视图模型用于组织您的数据，以便您可以将一个或多个数据源组织成一个可以查看的连贯结构。视图模型还可以执行基本验证。ViewModel 不了解 UI，因此不应包含对控件、可见性等的引用。viewmodel 从服务中获取其数据。

服务：

服务提供来自外部来源的数据。这些可以是 WCF、Web 服务、MQ 等（你懂的）。服务返回的数据可能需要调整，以便可以在 UI 中显示。为此，您将从服务中获取原始数据并将其转换为一个或多个模型对象。

模型：

模型对象是已创建的对象，以便可以轻松地显示/使用 UI。

您可能会发现不需要对来自服务的数据进行整形（幸运的是），在这种情况下，无需创建模型对象。您可能还决定不希望您的服务直接与您的视图模型对话，而是让它们通过“中介”对象获取数据。这在某些情况下也很好（通常当您从一个源/多个源接收连续的数据流时）。

MVVM 有点像粥：您可以添加很多潜在的装饰物，但您不一定需要全部添加。或者想要。

这有帮助吗？

编辑：刚刚偶然发现：MVVM 是什么的更深入的表达：[Mvvm Standardization](https://stackoverflow.com/questions/2217404/mvvm-standardization)。这也可能有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T01:14:33.700

Model 是 ViewModel 知道的东西，但 View 不知道。如果您需要提供有关 Logger 的信息，您当然可以拥有一个了解 Logger 的 LoggerViewModel，然后 View 最终会了解 ViewModel。有几种方法可以做到这一点，在视图构造函数中设置 DC 就是其中之一。

在基本了解谁知道谁之后，真正构成 MVVM 架构模式 IMO 的是 ViewModel 通过数据绑定与 View 通信。不多也不少。很多好东西都由此产生，但这正是它与其他关注点分离模式（如表示模型、MVP 等）不同的症结所在

也就是说，您需要通过一些示例项目来感受它。当您遇到问题时，在 SO 上提问非常棒，但您必须意识到您的问题充其量只是有点模糊。此外，除非您真的希望在视图中显示日志记录信息，否则日志记录不是 MVVM 关注的问题。它很有趣，但不是 MVVM。

Google Josh Smith 在 MSDN 上的 MVVM 演示，这是一个非常丰富但平易近人的项目。并在他们出现时提出更多问题或在此处改进问题！

HTH，
绿柱石

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-15T08:18:45.383

忘记风景！至少在一开始;)

试着想想你想要什么，你需要什么。我的理解是你想处理一个日志文件。所以你需要一个视图模型。

```
public class LoggerViewmodel{} 
```

您可以将日志文件作为 vm ctor 的参数。现在你必须考虑你想用你的日志文件做什么？对于您想要在视图模型上创建属性（LastModified、LastRow 等）的所有内容。

顺便说一句，做 mvvm 有两种不同的方法，第一种是**view first**，另一种是**viewmodel first**。我在我的项目中都这样做，并采用更适合的方法（最先使用视图模型；））来满足我的需求。

请编辑您的问题并添加您想对日志文件执行的操作，然后我们可以为您提供更好的答案。

编辑：

> 当我没有单独的 Model 类时，我还能实现 MVVM 吗？

以简短的方式回答您的问题-是的，您可以。您必须将视图和视图模型分开并使用绑定将视图绑定到数据上下文（视图模型）。

# c++ - C ++ - 将表达式注册并在程序集中使用它

> ID：12884892
> 
> 赞同：0
> 
> 时间：2012-10-14T17:53:43.413
> 
> 标签：c++, visual-c++, inline-assembly

如何解析表达式并将其放入寄存器中，在内联汇编中使用它，甚至再次使用它并将其放在某个地方？

例如：

```
EAX=a[i]; //Any expression that valid in C++
__asm xor eax,0xFFFF //Do something with this
b[i]=EAX; //And then put it in some variable. 
```

顺便说一句，原因是性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:20:31.607

几个编译器有编译器特定的方法来完成这个。但这几乎不值得去做。

这几乎不值得做的原因有很多：

*   编译器通常会生成比您大多数时间编写的代码更好的代码。
*   即使不是这样，您也可以经常稍微调整您的代码，以说服编译器编写至少与您可以编写的代码一样好的代码，并且仍然让您的程序保持可移植性。
*   具有感知性能问题的代码实际上对性能并不重要，因为程序在那里花费了 0.01% 的时间。
*   你希望你的程序保持标准的 C++ 并且不想用大量的`#ifdef`守卫把它弄得乱七八糟。

您展示的示例不是很有说服力。

# algorithm - pagerank如何以分布式方式计算？

> ID：12884895
> 
> 赞同：11
> 
> 时间：2012-10-14T17:54:04.493
> 
> 标签：algorithm, graph, graph-theory, pagerank

我理解 pagerank 背后的想法并实现了它（在阅读“编程集体智慧”一书时）。

但我读到它可以分布在多个服务器上（我猜谷歌正在这样做）。我有点困惑，因为根据我的理解，您需要整个图表才能对其进行页面排名，因为每个排名都与其他排名相关。

我找到了[wiki 文章](http://en.wikipedia.org/wiki/PageRank#Distributed_Algorithm_for_PageRank_Computation)，但没有解释太多。

关于这怎么可能的任何建议？此外，还有一个额外的问题：进行分布式 pagerank 的技术是 pagerank 独有的，还是可以将所使用的方法应用于应用于图形的其他机器学习算法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-14T18:50:04.763

计算 PageRank 的最先进方法是使用 Google Pregel 框架。我很确定他们现在有更复杂的东西，但这是最新发布的成果。

您可以在[研究博客](http://googleresearch.blogspot.de/2009/06/large-scale-graph-computing-at-google.html)中阅读有关它的更多详细信息。[或者在这里](http://people.apache.org/~tjungblut/downloads/pregel_paper.pdf)阅读已发表的论文。

[我正在开发一个名为Apache Hama的](http://hama.apache.org/)[Bulk Synchronous Parallel](http://en.wikipedia.org/wiki/Bulk_synchronous_parallel)范例的开源版本。还有[Apache Giraph](http://giraph.apache.org/)，它只专注于图形用例和许多其他用例。

就像 mfrankli 提到的，还有 MapReduce 框架（例如 Apache Hadoop）可以用来计算 PageRank，但它对于迭代算法效率不高。

值得注意的是，这两种解决方案（MapReduce 和 BSP）都是批处理解决方案，因此它们可用于重新计算整个 webgraph 的 PageRank。由于 Google 更新比批处理算法快得多，因此您可以预期它们会频繁地重新计算子图上的 PageRank。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-14T03:29:44.317

让

```
| 0 0 0 1 0 |
| 0 0 0 1 0 |
| 0 0 0 1 1 |
| 1 1 1 0 0 |
| 0 0 1 0 0 | 
```

是邻接矩阵（或图）。那么PageRank中的转移矩阵`M`将是

```
| 0 0   0 1/3 0 |
| 0 0   0 1/3 0 |
| 0 0   0 1/3 1 |
| 1 1 1/2   0 0 |
| 0 0 1/2   0 0 | 
```

它是列随机的、不可约的和非周期性的。

MapReduce 从这里开始。映射器的序列化输入将类似于

```
1 -> 4
2 -> 4
3 -> 4 , 5
4 -> 1 , 2 , 3
5 -> 3 
```

映射器将发出以下内容：

```
< 1 , [4] >
< 4 , 1 >

< 2 , [4] >
< 4 , 1 >

< 3 , [4 , 5] >
< 4 , 1/2 >
< 5 , 1/2 >

< 4 , [1, 2, 3] >
< 1 , 1/3 >
< 2 , 1/3 >
< 3 , 1/3 >

< 5 , [3] >
< 3 , 1 > 
```

Mapper 输出将按 key 分组并由 reducer 获取。如果我们有 5 个减速器，它会是这样的：

```
R1 takes [4]       , 1/3           then computes 1/5*(1/3)           =  2/30
R2 takes [4]       , 1/3           then computes 1/5*(1/3)           =  2/30
R3 takes [4, 5]    , 1/3 , 1       then computes 1/5*(1/3 + 1)       =  8/30
R4 takes [1, 2, 3] ,   1 , 1 , 1/2 then computes 1/5*(  1 + 1 + 1/2) = 15/30
R5 takes [3]       , 1/2           then computes 1/5*(1/2)           =  3/30 
```

现在第一次（功率）迭代结束了。在以下 reduce 作业中，reducers 将像 mapper 一样发出，但是，将使用 PR 计算而不是 1：

```
< 1 , [4] >
< 4 , 2/30 >

< 2 , [4] >
< 4 , 2/30 >

< 3 , [4 , 5] >
< 4 , 4/30 >
< 5 , 4/30 >

< 4 , [1, 2, 3] >
< 1 , 5/30 >
< 2 , 5/30 >
< 3 , 5/30 >

< 5 , [3] >
< 3 , 3/30 > 
```

重复 reduce 工作，直到它足够收敛或您满意为止。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T17:56:52.180

[MapReduce](http://en.wikipedia.org/wiki/MapReduce)提供了一些有趣的背景，并且可能会弄清楚您将如何并行化此任务。

# bash - zsh 或 bash 是否有便于英文文本的引号？

> ID：12884902
> 
> 赞同：17
> 
> 时间：2012-10-14T17:54:35.127
> 
> 标签：bash, escaping, quotes, zsh

如果我使用单引号，带有撇号（“不要”）的单词会很烦人：

```
'Don'"'"'t do that' 
```

如果我使用双引号，美元符号和感叹号就会出错：

```
"It cost like \$1000\!" 
```

我可以使用另一种引用吗？

**编辑**：我还应该补充一点，我想直接将此字符串作为命令行参数传递，而不是将其存储在变量中。为此，我尝试使用 DigitalRoss 的解决方案，

```
$ echo "$(cat << \EOF 
Don't $worry be "happy".
EOF)" 
```

但得到

```
dquote cmdsubst> 
```

按回车后：/。所以此时 ZyX 的建议`setopt rcquotes`看起来是最方便的。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-14T19:10:13.150

With zsh you may do

```
setopt rcquotes 
```

. Then ASCII apostrophes are escaped just like this:

```
echo 'Don''t' 
```

. Or setup your keymap to be able to enter UTF apostrophes, they have no issues with any kind of quotes (including none) in any shell:

```
echo 'Don’t' 
```

. Third works both for zsh and bash:

```
echo $'Don\'t' 
```

.

Neither first nor third can narrow down quote to a single character, but they are still less verbose for non-lengthy strings then heredocs suggested above. With zsh you can do this by using custom accept-line widget that will replace constructs like `'Don't'` with `'Don'\''t'`. Requires rather tricky regex magic that I can write only in perl; and is probably not the best idea as I can’t pretend I can cover all possible cases before they will hit. It won’t in any case touch any scripts.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-14T18:19:56.780

我喜欢[Zsolt Botykai](https://stackoverflow.com/users/11621/zsolt-botykai)的发展方向。这是一个适用于任何 Posix shell 的示例。（我还验证了它在粘贴到 SO 服务器时仍然存在。）

```
$ read -r x << \EOF
Don't $worry be "happy".
EOF
$ echo $x
Don't $worry be "happy". 
```

使这项工作发挥作用的东西；

*   `-r`不会`\`变魔术
*   而`\EOF`不是只是`EOF`使`$`不是魔术

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-14T18:06:04.737

If you want to assign a quoted text to a variable, you still can use heredocs, like (and it can be a multiline text too):

```
read -r -d '' VAR <<'ENDOFVAR'
This "will be" a 'really well' escaped text. Or won't.
ENDOFVAR 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-28T12:50:17.277

Bash 语法`$'string'`是另一种引用机制，它允许类似 ANSI C 的转义序列并扩展为单引号版本。

```
$> echo $'Don\'t $worry be "happy".'
Don't $worry be "happy". 
```

有关更多详细信息，请参阅[https://stackoverflow.com/a/16605140/149221](https://stackoverflow.com/a/16605140/149221)。

# arrays - 条件下的分段错误

> ID：12884907
> 
> 赞同：0
> 
> 时间：2012-10-14T17:55:05.420
> 
> 标签：arrays, segmentation-fault, primes

我的程序的目的是找到用户输入指示的素数。我设置了一个数组来存储找到的素数。随着 p（被测整数）的增加和测试重新开始，仅通过除以数组中的元素来保存处理。直到第 44030 个素数为止，它都可以正常工作。我正在使用 GCC 进行编译。为什么它给我一个分段错误？

```
 //Prime Finder
#include <stdio.h>
#include <stdlib.h>
int main ()
{
int i=4;
int p=7;
int j=1;
int cap;
printf("\nWhich prime number would you like to see? ");
scanf("%i",&cap);
long *array=malloc(cap);
array[0]=1;
array[1]=2;
array[2]=3;
array[3]=5;
while(i<=cap)
{
if (array[j]>=p/2) // if true then p is prime
{
    j=1;
    array[i]=p;
    p++;
    i++;
}
else if (p%array[j]==0) // if true then p is not prime
{
    p++;
    j=1;
}
else // in this case p is still under test
    j++;
}
printf("\nHere it is! %i\n\n",array[cap]);
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T18:06:06.157

您在调用中分配`cap`字节而不是`cap*sizeof(long)`字节。`malloc()`所以你正在覆盖内存的其他部分；确切的时间取决于您为上限提供的价值。

# php - 将准备好的语句占位符括在单引号中

> ID：12884911
> 
> 赞同：1
> 
> 时间：2012-10-14T17:55:26.437
> 
> 标签：php, escaping, mysqli, prepared-statement

在中创建准备好的语句时`mysqli`，我应该用单引号将字符串值占位符括起来吗？

即我应该写：

```
 INSERT INTO Person (Name) VALUES ('?') 
```

或者

```
 INSERT INTO Person (Name) VALUES (?) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T17:56:03.253

```
INSERT INTO Person (Name) VALUES (?) 
```

将完美地工作

# windows-8 - Windows 应用认证工具包 - packagefullname bug W8 商店

> ID：12884916
> 
> 赞同：4
> 
> 时间：2012-10-14T17:55:38.860
> 
> 标签：windows-8, windows-store-apps, winrt-xaml, wack

当我想使用 Windows 应用程序认证工具包验证我的应用程序（Metro 应用程序）时，我单击商店，当 Windows 应用程序认证工具包启动时，它会进入准备验证应用程序，然后我收到错误消息：

> Windows 应用认证工具包在验证您的应用时遇到以下故障。

由于找不到指定的 Windows 应用商店，{0} 无法继续测试。请验证 packagefullname 是否正确”

packagefulname 怎么可能不正确，因为我不是输入它的人？我在 VS 2012 中使用 GUI。

在 power shell 中启动命令`Get-AppxPackage > out.txt`时，我可以看到我的应用程序有一个包全名，所以即使我尝试启动命令提示符

```
.\appcert.exe test -apptype metrostyle –packagefullname XXXXXXXXXX_neutral__823pgb98jhb94 -reportoutputpath c:\temp\MyWACKReport.xml 
```

它说必须指定包全名，所以我真的不明白。我该怎么做才能让我的应用程序通过 Windows 应用程序认证。

我的机器：Windows 8 Pro x64 with VS 2012 Ultimate

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T18:19:23.810

您是否在运行认证工具包之前安装了应用程序？

appcert.exe 不能自己安装包有点烦人。（这就是为什么我们开发了一些工具来为我们做这件事，希望我们能尽快将它开源......）

# c# - 以编程方式设置加速器

> ID：12884918
> 
> 赞同：1
> 
> 时间：2012-10-14T17:55:57.907
> 
> 标签：c#, mono, monodevelop, gtk#

我目前正在 Mono 中开发一个应用程序，我想通过代码将加速键设置为菜单（因为我想根据所选语言更改它们）。

我如何意识到这一点？我可以看到一个菜单项有一个属性“AccelPath”，但我该如何正确设置它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:19:11.033

我可以自己找出来。只需在标签前添加“_”即可获得加速器。

还有一件事是，如果你重新标记动作，这个加速器就会丢失。

# haskell - 条件 QuickCheck 属性

> ID：12884927
> 
> 赞同：15
> 
> 时间：2012-10-14T17:57:12.820
> 
> 标签：haskell, quickcheck

我为一个函数编写了一个 QuickCheck 属性，该函数将两个排序的输入合并到一个排序的输出中：

```
prop_merge xs ys =
    if (sorted xs && sorted ys) then (sorted (merge xs ys)) else True 
```

也就是说，当输入被排序时，输出也被排序。也可以写成：

```
prop_merge xs ys = not(sorted xs && sorted ys) || (sorted (merge xs ys)) 
```

但我真的不喜欢这两个版本。QuickCheck 中的“条件属性”是否有更好的语法？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-14T18:05:45.890

您可以使用[`==>`](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck.html#v:-61--61--62-)运算符将​​布尔条件附加到您的属性：

```
prop_merge xs ys = (sorted xs && sorted ys) ==> sorted (merge xs ys) 
```

这不仅是一种更好的语法，而且允许 QuickCheck 区分测试成功的测试用例和不满足先决条件的测试用例。在后一种情况下，测试不计算在内，QuickCheck 会生成新的输入。

但是，在大多数输入不满足条件的情况下，这将导致您的测试运行得更慢，或者，如果丢弃了足够多的输入，QuickCheck 最终将放弃。由于随机列表不太可能被排序，因此上面的示例很可能会发生这种情况：

```
> quickCheck (prop_merge :: [Int] -> [Int] -> Property)
*** Gave up! Passed only 15 tests. 
```

（请注意，使用标准布尔运算符而不是 using`==>`时，QuickCheck 将提升所有通过的测试，当大多数测试由于前置条件失败而无用时）

出于这个原因，通常最好只直接生成您需要的测试用例。对于简单的情况，该[`Test.QuickCheck.Modifiers`](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Modifiers.html)模块包含几个有用的新类型，它们修改了输入的生成方式。例如，[`OrderedList`](http://hackage.haskell.org/packages/archive/QuickCheck/latest/doc/html/Test-QuickCheck-Modifiers.html#t:OrderedList)修饰符将只生成排序列表，因此我们可以将您的属性简单地写为：

```
prop_merge (Ordered xs) (Ordered ys) = sorted (merge xs ys) 
```

# javascript - 获取正文中的特定标签元素

> ID：12884928
> 
> 赞同：0
> 
> 时间：2012-10-14T17:57:20.573
> 
> 标签：javascript, html

我正在尝试在正文中获取以下所有标签（INPUT、A 和 BUTTON）有没有一种方法可以做到这一点，而不必使用 javascript 遍历正文中的所有标签

```
var allInputTags = document.body.getElementsByTagName('*'); 
```

我正在考虑做类似的事情

```
var inputtags = document.body.getElementsByTagName('INPUT');
var atags = document.body.getElementsByTagName('A');
var buttontags = document.body.getElementsByTagName('BUTTON');

var allTags = inputtags + atags + buttontags; 
```

但我认为这样我不会按照它们出现在 Body 中的顺序获取元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T18:00:46.903

如果浏览器支持[`querySelectorAll` *^([MDN])*](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)，你可以这样做：

```
var allTags = document.querySelectorAll('input, a, button'); 
```

[元素按文档顺序返回](https://stackoverflow.com/questions/8203770/using-queryselectorall-is-the-result-returned-by-the-method-ordered)。有关支持的浏览器列表，请参见[caniuse.com](http://caniuse.com/#feat=queryselector)`querySelectorAll`。

在所有其他浏览器中，您必须使用`getElementsByTagName`，但我认为要按顺序排列元素将非常困难。

您还可以考虑使用选择器引擎，例如[Sizzle](http://sizzlejs.com/)（jQuery 使用的引擎）。或者如果你打算做复杂的 DOM 操作，[jQuery](http://jquery.com/)本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:00:11.270

您可以使用 Array.concat

```
var allTags = inputtags.concat(atags, buttontags); 
```

# python - 从 Python 脚本在 Finder 窗口中设置背景时的文件长度限制

> ID：12884929
> 
> 赞同：1
> 
> 时间：2012-10-14T17:57:19.760
> 
> 标签：python, macos, applescript

我有兴趣从 Python 在 MacOS X 上创建 dmg 磁盘映像，并遇到了以下解决方案：[如何使用命令行工具为 Mac OS X 创建漂亮的 DMG？](https://stackoverflow.com/questions/96882/how-do-i-create-a-nice-looking-dmg-for-mac-os-x-using-command-line-tools)

但是，我遇到了一个与路径长度相关的奇怪问题。以下脚本说明了我的问题：

```
import os
import Image

for NAME in ['works', 'doesnotwork']:

    if os.path.exists(NAME + '.dmg'):
        os.remove(NAME + '.dmg')

    if os.path.exists('/Volumes/' + NAME):
        raise Exception("Need to eject /Volumes/%s first" % NAME)

    nx = 256
    ny = 256

    image = Image.new("RGB", (nx, ny))

    for i in range(nx):
        for j in range(ny):
            image.putpixel((i, j), (i, 0, j))

    os.system('hdiutil create -volname %s -fs HFS+ -size 10m %s.dmg' % (NAME, NAME))
    os.system('hdiutil attach -readwrite -noverify -noautoopen %s.dmg' % NAME)

    os.mkdir('/Volumes/%s/.background' % NAME)
    image.save('/Volumes/%s/.background/background.png' % NAME, 'PNG')

    apple_script = """osascript<<END
    tell application "Finder"
       tell disk "%s"
           open
           set current view of container window to icon view
           set toolbar visible of container window to false
           set statusbar visible of container window to false
           set the bounds of container window to {{100, 100, 355, 355}}
           set theViewOptions to the icon view options of container window
           set the background picture of theViewOptions to file ".background:background.png"
           close
           open
       end tell
    end tell
    END""" % NAME

    os.system(apple_script) 
```

如果运行，背景将在名为“works”的磁盘映像中正确设置，而不是在名为“doesnotwork”的磁盘映像中。似乎我的卷名限制为 5 个字符。但是，如果我缩短用于存储背景的文件夹的名称，例如改为`.bkg`而不是`.background`，那么我可以使用更长的卷名，这表明这是与整个路径的长度有关的问题。有谁知道路径长度限制在什么级别？是否有允许任意长路径的解决方法？

编辑：我正在使用 MacOS 10.6 - 脚本似乎在 10.7 上正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T22:43:19.990

我相信你必须逃避你的报价。你不能在引号内加上引号而不转义它们。例如它应该是，告诉应用程序\"Finder\"。您有很多地方没有正确使用您的报价。如果您查看链接到该人的示例脚本，则巧妙地使用单引号和双引号来避免此问题。我的建议是你解决这个问题。

另外，您不能像这样引用applescript中的文件......“.background：background.png”。当路径以句点开头时，Applescript 不知道这意味着什么。applescript 中的路径以硬盘驱动器的名称开头，例如 Macintosh HD。您需要将整个路径以适当的 applescript 格式放在那里。这也需要用转义引号引用。

祝你好运。

# jsf - 在 Primefaces 中设置标签的值

> ID：12884932
> 
> 赞同：1
> 
> 时间：2012-10-14T17:57:40.043
> 
> 标签：jsf, primefaces

我的网络应用程序中有以下标签

```
<h:outputLabel id="yearLabel" value="?" style="font-weight:bold"/> 
```

在该页面的控制器中，我想将此标签的文本设置为某个值（在 Java 中）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:22:35.920

只需以通常的方式将其绑定到 bean 属性即可。

```
@ManagedBean
@RequestScoped
public class Bean {

    private String label;

    @PostConstruct
    public void init() {
        label = "Year"; 
    }

    // ...
} 
```

和

```
<h:outputLabel ... value="#{bean.label}" /> 
```

* * *

**与具体问题无关**，我不确定这一切的功能要求是什么，所以我不知道你是否朝着正确的方向前进，但你是否考虑过使用资源包?

# c++ - 对象/结构等的 C++ 内存布局是什么？

> ID：12884933
> 
> 赞同：3
> 
> 时间：2012-10-14T17:57:47.183
> 
> 标签：c++, compiler-construction

在 C++ 中，我认为 C++ 标准与数据成员在类中的排列方式无关，就内存布局而言？我认为这取决于所讨论的编译器是否正确？

我对学习如何在物理内存中表示对象和其他 C++ 实体（结构等）非常感兴趣（我知道列表是节点到节点，数组是连续内存 - 但语言的所有其他方面）。

**编辑：学习 x86 汇编器会对此有所帮助并更好地理解 C++ 吗？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-14T18:03:46.437

The C++ standard does specify a few things, but far from everything.

The main rules are these:

*   objects in an array are laid out contiguously, with no padding between them.
*   class member objects *not* separated by an access specifier (`public:`/`private:`/`protected:`) are laid out in memory in the order in which they're declared, but there may be an unspecified amount of padding between member objects.
*   for certain types (standard-layout structs, in standardese terminology), the first base class, or if none exists, the first member, is laid out at the same address that the class itself.

There are a few more bits and pieces specified by the standard, but on the whole, the remaining details are really down to the compiler.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T18:03:00.637

是的，标准没有说明对象在内存中的表示方式。要了解普通 C++ 对象是如何表示的，请阅读本书：[C++ 对象模型内部。](https://rads.stackoverflow.com/amzn/click/com/0201834545)

# c# - c#中日期和日期时间数据类型有什么区别

> ID：12884934
> 
> 赞同：2
> 
> 时间：2012-10-14T17:57:57.390
> 
> 标签：c#, date, datetime

示例：我通过一些查询（许多不同的查询）从数据库中获取 myDataTable，并希望将`Date`and`DateTime`字段更改为用户所需的演示文稿。

```
void dgv_DataSourceChanged(object sender, EventArgs e)
{
     for (int i = 0; i < dgv.Columns.Count; i++)
     {
          if (myDataTable.Columns[i].DataType == typeof(DateTime))
              dgv.Columns[i].DefaultCellStyle.Format = "yyyy-MM-dd HH:mm:ss";
          else
          {
              if (myDataTable.Columns[i].DataType == typeof(Date))
                  dgv.Columns[i].DefaultCellStyle.Format = "dd-MM-yyyy";
          }
     }
} 
```

您可以看到具有 DataType= 的列没有问题`DateTime``Date`，但是无论我当前的数据库查询如何，如何处理dataType ？日期在数据库中可用，但在 c# 中不可用。

**更新**：我可以通过检查日期值天气的结束来做到这一点，它是 12:00: AM 或 00:00:00。但这似乎是一个虚假的解决方案，真正的 DateTime 值也可以具有相同的值。此值不保证 DataType 是`Date`而不是 DateTime

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:09:44.750

```
foreach( DataRow dr in datatable.Rows)
{
    DateTime dt = DateTime.ParseExact(dr["YourDateTimeColumnName"], 
                              "MM/dd/yyyy hh:mm:ss tt", CultureInfo.InvariantCulture);
    string s = dt.ToString("dd/M/yyyy");
} 
```

现在您的 DateTime 已转换为 Date，您可以在 DataGridView 中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T13:16:35.583

也许你分不清。在这种特殊情况下你可以做的是

```
for (int i = 0; i < dgv.Columns.Count; i++)
{
    if (source.Columns[i].DataType == typeof(DateTime))
    {
        string val = source.Rows[0][i].ToString();
        if (val.EndsWith("12:00:00 AM") ||val.EndsWith("00:00:00"))
        {
            dgv.Columns[i].DefaultCellStyle.Format = "yyyy-MM-dd"; 
            //Your date Format
        }
        else
           dgv.Columns[i].DefaultCellStyle.Format = "yyyy-MM-dd HH:mm:ss";
           //Your date and Time Format
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:07:33.177

There is only *DateTime* datatype available in C# for *datetime*, *date* datatype of SQL Sever.

See the following datatype mapping table for reference: [SQL Server Data Type Mappings](http://msdn.microsoft.com/en-us/library/cc716729.aspx)

# java - 将一组分配给另一组，并在执行清除时。两组都被清除

> ID：12884937
> 
> 赞同：4
> 
> 时间：2012-10-14T17:58:27.340
> 
> 标签：java, set, hashset, set-operations

1.最初创建了两个集合。2.将元素添加到一组。3.将一组分配给另一组。4.如果对一组调用清除，则两组都被清除。

任何人都可以帮助解决问题吗？

```
import java.util.HashSet;
import java.util.Set;

public class SetOperation {

Set<Integer> a = new HashSet<Integer>();
Set<Integer> b = new HashSet<Integer>();

void assignAndClear(){

    a.add(3);
    a.add(7);
    a.add(5);
    a.add(19);
    a.add(99);

    System.out.println("a:" +a );
    System.out.println("b:" +b );

    b=a;

    System.out.println("After assigning");
    System.out.println("a:" +a );
    System.out.println("b:" +b );

    b.clear();

    System.out.println("after clearing");
    System.out.println("a:" +a );
    System.out.println("b:" +b );       
}
public static void main(String[] args) {

    SetOperation sd = new SetOperation();
    sd.assignAndClear();
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T18:00:07.030

当您将一个集合分配给另一个集合时，不会创建新集合，而是会创建一个指向现有集合的新引用。因此，您对 set 所做的任何更改都`a`将反映在`b`.

`any`可变对象也是如此。

但不适用于`Immutable`对象。

例如，考虑以下情况`String`： -

```
String s = "a";
String s1 = s; // Both `s` and `s1` points to `"a"`

s1 = "b";  // Only s1 will point to "b". `s` still points to "a". 
```

在上述情况下，更改不会反映到所有引用，因为`Strings`它们是不可变的。因此，您对 String 所做的任何更改都会创建一个`new object`.

但是，如果你有`mutable object`.: -

```
Set<String> set = new HashSet<String>();
Set<String> set3 = new HashSet<String>(); // A different set object
Set<String> set2 = set;   // Point to the same set object as "set"

set2.clear();  // Will clear the actual object. Pointed by "set"
// And thus both the reference pointing to that object, will see the change.

set3 = set; // Change reference `set3` to point to the `Set object` pointed by `set`

set3.add("a");  // Will change `set` also. 
```

如果您想创建 Set 的副本。像这样做： -

```
Set<String> set1 = new HashSet<String>();
Set<String> set3 = new HashSet<String>(set1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-14T18:00:27.453

您覆盖对原始哈希集内存位置的引用`b`。您需要将 的元素复制`a`到`b`不分配`a`给`b`。

尝试：

```
 b = new HashSet<Integer>(a); 
```

# ios - 将上下文保存在核心数据中后，我可以撤消操作吗？

> ID：12884940
> 
> 赞同：2
> 
> 时间：2012-10-14T17:58:43.600
> 
> 标签：ios, core-data, nsundomanager

我有一个通用的 iOS 核心数据应用程序。每次更改某些内容时，我都会从 NSManagedContext 调用 save，因此所有更改都会移动到数据库中。

据我了解，我只能撤消托管上下文中的更改，但不能撤消数据库中的更改。我对吗？

我想要的是立即将所有更改提交到数据库并能够撤消 las 操作。那可能吗？

我看到的唯一选择是不提交最后一次更改，也就是说，将最后一次更改保留在 NSManagedContext 中，这样我就可以撤消该更改。但是这个想法有一个问题，如果程序崩溃或用户进行了备份（使用 iTunes 或 iCloud），那么最后的更改就会消失。你是否同意我的观点？我怎样才能让我的数据始终提交到数据库中，同时有可能撤消最后一次更改？据我了解，使用 Core Data 是不可能的。我希望我错了。

好吧，我想知道你对此的看法。谢谢。

# php - 使用 PHP 和 MySQL 在 Google 地图上显示多个标记

> ID：12884942
> 
> 赞同：1
> 
> 时间：2012-10-14T17:58:45.113
> 
> 标签：php, mysql, google-maps, google-maps-api-3

我尝试使用 PHP 和 MySQL 在 Google 地图上显示多个标记，但由于地图未显示，它不起作用。请帮助我，不要忘记更改映射键。谢谢你。

这是我的代码：

```
 <%@ page language="java" contentType="text/html; charset=UTF-8"
      pageEncoding="UTF-8"%>
      <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

      <?php

      $connexion=mysql_connect("localhost", "root", "") or die(mysql_error());
      mysql_select_db("survey",$connexion) or die(mysql_error());

      //la requête pour obtenir la liste des points
      $result = mysql_query("SELECT latitude,longitude FROM appreciation order by id");

      //récupération de tous les points pour les mettre dans une table façon JavaScript

      $listeDesPoints='';
      while($row = mysql_fetch_array($result)){
      if($listeDesPoints!='') $listeDesPoints.=','; 
      $listeDesPoints.='['.$row['lattitude'].','.$row['longitude'].']';
      }
      //et voilà $listeDesPoints est prêt à être affiché dans le script

      //on ferme la connexion à la base de données
      mysql_close($connexion);
      ?>
      <html>
      <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Insert title here</title>
      <script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js? key=AIzaSyB3is760vHXhki9vS_LpiWAig8a33GP3CY&sensor=false">
      </script>

      <script type="text/javascript">
      function initialize(){
      var centreCarte = new google.maps.LatLng(34.02,-6.83);

      var optionsCarte = {
      zoom: 12,
      center: centreCarte,
      keyboardShortcuts: true,
      scrollwheel: true,
      panControl: false,
      mapTypeControl: true,
      overviewMapControl: true,
      rotateControl: true,
      scaleControl: true,
      streetViewControl: true,  
      zoomControl: true,        
      mapTypeId: google.maps.MapTypeId.HYBRID                                        
      }

      var map = new google.maps.Map(document.getElementById("map"), optionsCarte);

      var liste_des_points=[
      <?php echo $listeDesPoints; ?>
      ];

      var i=0,li=liste_des_points.length;
      while(i<li){
      new google.maps.Marker({
      position: new google.maps.LatLng(liste_des_points[i][0], liste_des_points[i][1]),
      map: Carte,
      title: "Marqueur-"+i,
           });
      i++;
 }

 }
      </script>
      </head>
      <body onload="initialize()">

      <div id="map" style="width:80%; height:80%" >
      </div>
      </body>
      </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T19:55:26.030

您将地图对象分配给变量地图，但将标记放置在不存在的地图“Carte”上。尝试 map: 在 Marker 对象中映射。

# objective-c - 重新加载 UITableView 数据而不是可见单元格

> ID：12884946
> 
> 赞同：1
> 
> 时间：2012-10-14T17:59:29.510
> 
> 标签：objective-c, ios, uitableview, nsfetchedresultscontroller, uirefreshcontrol

我正在开发一个应用程序，我想从远程 Web 服务中提取数据并填充 UITableView。当我获得新数据时，我希望保留当前可见的单元格并在其上方添加新数据，就像大多数 Twitter 客户端一样。我的加载方法目前如下所示：

```
- (void)loadPostsInBackground
{
    NSURL *url = [NSURL URLWithString:@"[URL]"];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    AFJSONRequestOperation *operation;
    operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id jsonObject) {

        [self createPostsFromDict:jsonObject];
        [self.refreshControl endRefreshing];
        [self.tableView reloadData];

    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id jsonObject) {

        NSLog(@"Received an HTTP %d", response.statusCode);
        NSLog(@"The error was: %@", error);

    }];

    [operation start];

} 
```

这可行，但它会使用新数据更新当前可见的单元格。所以我想要的是，获取新数据，将其添加到当前可见的单元格上方（或留在当前可见的单元格）。做这个的最好方式是什么？

注意：我需要 iOS6。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T18:01:30.120

而不是在表视图上调用**reloadData 。**您应该调用**insertRowsAtIndexPaths:withRowAnimation:**。在更新表视图的数据源使用的数据后执行此操作。

# javascript - 2月份的出生日期验证

> ID：12884955
> 
> 赞同：1
> 
> 时间：2012-10-14T18:00:19.710
> 
> 标签：javascript, validation, date

我为 DATE、MONTH 和 YEAR 保留了三个下拉框。我想要一个验证函数，如果输入的日期在 FEB 月份超过 29，它将返回 false。如果是闰年，则应接受 29 表示 FEB。我使用了以下 JavaScript。

即使我在日期字段中输入值 27,28，它也会提示。你能帮我解决这个问题吗？

这是JavaScript代码..

```
var myDayStr = document.UserReg.Date.value;
        var myMonthStr = document.UserReg.Month.value;
        var myYearStr = document.UserReg.Year.value;
        var myMonth = new Array('Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');
        var validMonthLength = ['',31,28,31,30,31,30,31,31,30,31,30,31];
        var myDateStr = myDayStr + ' ' + myMonthStr + ' ' + myYearStr;

        var myDate = new Date();
        myDate.setFullYear( myYearStr, myMonthStr, myDayStr );

        if ( myDate.getMonth() != myMonthStr ) {
          alert( ' sorry, but "' + myDateStr + '" is NOT a valid date of birth.' );
          return false;
        }
        var testDate = new Date(myYearStr,(myMonthStr-1),myDateStr);
         if ( (myMonthStr == '02') && (myDateStr != testDate.getDate()) ) {
           alert("There is no dates above 28 in February of "+myYearStr);
           return false;
          }
          if (myMonthStr != 2) {
           if (myDateStr > validMonthLength[myMonthStr])
           {
               alert("Invalid date for month chosen");
               return false; }
          } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:13:07.993

如果您输入的天数大于一个月中允许的天数，setFullYear 会自动重新调整月份。例如：

```
date = new Date();
date.setFullYear('2012','2','35');
date.getMonth(); //returns 3
date.getDay(); // returns 3 
```

因此，您所做的就是像您一样设置日期，然后进行直接比较。把事情简单化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T17:12:23.527

> **我手动创建你可以试试，它的工作**

```
function isleap(year) {
            var yr = year;
            if ((parseInt(yr) % 4) == 0) {
                if (parseInt(yr) % 100 == 0) {
                    if (parseInt(yr) % 400 != 0) {
                        //alert("Not Leap");
                        return false;
                    }
                    if (parseInt(yr) % 400 == 0) {
                        //alert("Leap");
                        return true;
                    }
                }
                if (parseInt(yr) % 100 != 0) {
                    //alert("Leap");
                    return true;
                }
            }
            if ((parseInt(yr) % 4) != 0) {
                //alert("Not Leap");
                return false;
            }
        }

    function dayChange() {
        var Year = document.getElementById('<%=ddlYear.ClientID %>');
        var Month = document.getElementById('<%=ddlMonth.ClientID %>');
        var Day = document.getElementById('<%=ddlDay.ClientID %>');
          if (Day.options[Day.selectedIndex].value == 0) {

            Day.style.border = '1px solid red';
        }
        else {

            Day.style.border = '1px solid green';

        }
    }

    function yearChange() {
        var Year = document.getElementById('<%=ddlYear.ClientID %>');
        var Month = document.getElementById('<%=ddlMonth.ClientID %>');
        var Day = document.getElementById('<%=ddlDay.ClientID %>');

        if (Year.options[Year.selectedIndex].value == 0) {

            Year.style.border = '1px solid red';
            Day.style.border = '1px solid red';
            Month.style.border = '1px solid red';

        }
        else {

            Year.style.border = '1px solid green';
            Day.style.border = '1px solid red';
            Month.style.border = '1px solid red';

        }

        Day.options[0].selected = true;
        Month.options[0].selected = true;

        if (Day.options.length == 30) {
            $('#ddlDay').append("<option >30</option>");
            $('#ddlDay').append("<option >31</option>");
        }
        else if (Day.options.length == 29) {
            $('#ddlDay').append("<option >29</option>");
            $('#ddlDay').append("<option >30</option>");
            $('#ddlDay').append("<option >31</option>");
        }

    }

    function monthChange() {

        var isLeap;
        var Day = document.getElementById('<%=ddlDay.ClientID %>');

        var Month = document.getElementById('<%=ddlMonth.ClientID %>');

        var Year = document.getElementById('<%=ddlYear.ClientID %>');

        Month.style.border = '1px solid red';

        Day.options[0].selected = true;
        Day.style.border = '1px solid red';

        if (Month.options[Month.selectedIndex].value == 0) {

            Month.style.border = '1px solid red';

            Day.options[0].selected = true;
            Day.style.border = '1px solid red';

        }

        else if (Month.options[Month.selectedIndex].value == 2) {
            Month.style.border = '1px solid green';

            if (isleap(Year.value) == true) {
                isLeap = 'true';
                Day.options['31'].remove();
                Day.options['30'].remove();

                Day.options[0].selected = true;
                Day.style.border = '1px solid red';
                Month.style.border = '1px solid green';

            }
            else {

                Day.options['31'].remove();
                Day.options['30'].remove();

                Day.options['29'].remove();
                Day.options[0].selected = true;
                Day.style.border = '1px solid red';
                Month.style.border = '1px solid green';

            }
            Day.options[0].selected = true;
            Day.style.border = '1px solid red';
            Month.style.border = '1px solid green';

        }
        else {

            if (Day.options.length == 29) {
                $('#ddlDay').append("<option >29</option>");
                $('#ddlDay').append("<option >30</option>");
                $('#ddlDay').append("<option >31</option>");
            }
            else if (Day.options.length == 30) {

                $('#ddlDay').append("<option >30</option>");
                $('#ddlDay').append("<option >31</option>");
            }
            Month.style.border = '1px solid green';
        }

    } 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-02-10T21:31:26.890

```
<form id="dob_form">
    <select name="Year" id="year">
        <option> Year</option>
        <option></option>
        <option value="2005">2005</option>
        <option value="2004">2004</option>
        <option value="2003">2003</option>
        <option value="2002">2002</option>
        <option value="2001">2001</option>
        <option value="2000">2000</option>
        <option value="1999">1999</option>
        <option value="1998">1998</option>
        <option value="1997">1997</option>
        <option value="1996">1996</option>
        <option value="1995">1995</option>
        <option value="1994">1994</option>
        <option value="1993">1993</option>
        <option value="1992">1992</option>
        <option value="1991">1991</option>
        <option value="1990">1990</option>
        <option value="1989">1989</option>
        <option value="1988">1988</option>
        <option value="1987">1987</option>
        <option value="1986">1986</option>
        <option value="1985">1985</option>
        <option value="1984">1984</option>
        <option value="1983">1983</option>
        <option value="1982">1982</option>
        <option value="1981">1981</option>
        <option value="1980">1980</option>
        <option value="1979">1979</option>
        <option value="1978">1978</option>
        <option value="1977">1977</option>
        <option value="1976">1976</option>
        <option value="1975">1975</option>
        <option value="1974">1974</option>
        <option value="1973">1973</option>
        <option value="1972">1972</option>
        <option value="1971">1971</option>
        <option value="1970">1970</option>
        <option value="1969">1969</option>
        <option value="1968">1968</option>
        <option value="1967">1967</option>
        <option value="1966">1966</option>
        <option value="1965">1965</option>
        <option value="1964">1964</option>
        <option value="1963">1963</option>
        <option value="1962">1962</option>
        <option value="1961">1961</option>
        <option value="1960">1960</option>
        <option value="1959">1959</option>
        <option value="1958">1958</option>
        <option value="1957">1957</option>
        <option value="1956">1956</option>
        <option value="1955">1955</option>
        <option value="1954">1954</option>
        <option value="1953">1953</option>
        <option value="1952">1952</option>
        <option value="1951">1951</option>
        <option value="1950">1950</option>
        <option value="1949">1949</option>
        <option value="1948">1948</option>
        <option value="1947">1947</option>
        <option value="1946">1946</option>
        <option value="1945">1945</option>
        <option value="1944">1944</option>
        <option value="1943">1943</option>
        <option value="1942">1942</option>
        <option value="1941">1941</option>
        <option value="1940">1940</option>
        <option value="1939">1939</option>
        <option value="1938">1938</option>
        <option value="1937">1937</option>
        <option value="1936">1936</option>
        <option value="1935">1935</option>
        <option value="1934">1934</option>
        <option value="1933">1933</option>
        <option value="1932">1932</option>
        <option value="1931">1931</option>
        <option value="1930">1930</option>
        <option value="1929">1929</option>
        <option value="1928">1928</option>
        <option value="1927">1927</option>
        <option value="1926">1926</option>
        <option value="1925">1925</option>
        <option value="1924">1924</option>
        <option value="1923">1923</option>
        <option value="1922">1922</option>
        <option value="1921">1921</option>
        <option value="1920">1920</option>
    </select>
    <select name="Month" id="month" disabled="disabled">
        <option></option>
        <option> Month</option>
        <option></option>
        <option value="January">January</option>
        <option value="Febuary">Febuary</option>
        <option value="March">March</option>
        <option value="April">April</option>
        <option value="May">May</option>
        <option value="June">June</option>
        <option value="July">July</option>
        <option value="August">August</option>
        <option value="September">September</option>
        <option value="October">October</option>
        <option value="November">November</option>
        <option value="December">December</option>
    </select>
    <select name="Day" id="day" disabled="disabled">
        <option></option>
        <option> Day</option>
        <option></option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
        <option value="14">14</option>
        <option value="15">15</option>
        <option value="16">16</option>
        <option value="17">17</option>
        <option value="18">18</option>
        <option value="19">19</option>
        <option value="20">20</option>
        <option value="21">21</option>
        <option value="22">22</option>
        <option value="23">23</option>
        <option value="24">24</option>
        <option value="25">25</option>
        <option value="26">26</option>
        <option value="27">27</option>
        <option value="28">28</option>
        <option id="29" value="29">29</option>
        <option id="30" value="30">30</option>
        <option id="31" value="31">31</option>
    </select>
</form>

$(document).ready(function(){

    $("#year").change(function(){
        var year = $("#year").val();

            if(year!="" && year!="Year"){
            $("#month").removeAttr('disabled');
            $("#month").val('Month');
            }
            else{
            $("#month").attr('disabled', true);
            $("#month").val('');
            $("#day").attr('disabled', true);
            $("#day").val('');
            }
    });

            $("#month").change(function(){
                var month = $("#month").val();
                var year = $("#year").val();

            if(month!="" && month!="Month"){
                $("#day").removeAttr('disabled');
                $("#day").val('Day');

                    if(month=="Febuary"){
                    var lastday = $("#day option").last().val();
                            $("#31").remove();
                            $("#30").remove();
                                if(year % 4 != 0){
                                    $("#29").remove();
                                }else if(lastday == 28){

                                $("#day").append("<option id='29' value='29'>29</option>");
                                }
                    }
                    else if(month == "April" ||
                    month == "June" ||
                    month == "November" ||
                    month == "September")
                    {

                            var lastday = $("#day option").last().val();
                                if(lastday == 31){
                                $("#31").remove();

                                } else if(lastday == 29){
                                $("#day").append("<option id='30' value='30'>30</option>");

                                }
                                 else if(lastday == 28){
                                $("#day").append("<option id='29' value='29'>29</option><option id='30' value='30'>30</option>");

                                }
                    }
                    else{
                    var lastday = $("#day option").last().val();
                                if(lastday == 30){
                                $("#day").append("<option id='31' value='31'>31</option>");

                                } else if(lastday == 29){
                                $("#day").append("<option id='30' value='30'>30</option><option id='31' value='31'>31</option>");

                                }
                                 else if(lastday == 28){
                                $("#day").append("<option id='29' value='29'>29</option><option id='30' value='30'>30</option><option id='31' value='31'>31</option>");

                                }

                    }

            }
            else{
            $("#day").attr('disabled', true);
            $("#day").val('');

            }
    });
}); 
```

# python - 显示项目列表 /w 相对于嵌套

> ID：12884959
> 
> 赞同：0
> 
> 时间：2012-10-14T18:00:44.270
> 
> 标签：python, recursion, tree, comments, structure

我有具有属性的评论列表：（`pk`主键），`parent_pk`（父键的主键）和其他...我想在嵌套方面显示它们 - 如果评论有孩子，显示评论，然后是缩进更多的孩子. 当评论与其他评论`pk`相同时，评论是其他评论的子评论`parent_pk`。

我最初将在我的 Django 博客中实现它，但首先我想学习如何做。这就是为什么为了简单起见，我创建了 CLI 应用程序。我知道那里有现成的解决方案，但我想学会自己做。:)

这是我现在的代码：

```
class Comment(object):
    def __init__(self, pk, parent_pk, content):
        self.pk = pk
        self.parent_pk = parent_pk
        self.content = content

    def has_children(self, comments):
        for comment in comments:
            if self.pk == comment.parent_pk:
                return True
        return False

    def get_children(self, comments):
        children = []
        for comment in comments:
            if self.pk == comment.parent_pk:
                children.append(comment)
        return children

def print_nested(comments, level=0):
    def to_whitespaces(level):
        if level == 0:
            return ""
        else:
            return " " * (level * 2)

    for comment in comments:
        print to_whitespaces(level) + comment.content
        if comment.has_children(comments):
            print_nested(comment.get_children(comments), level + 1)
            comments.pop(0)

comments = [
    Comment(1, None, "foo"),
    Comment(2, 1, "foo bar"),
    Comment(3, None, "spam"),
    Comment(4, 3, "spam cheese"),
    Comment(5, 4, "spam cheese monty"),
    Comment(6, None, "muse"),
]

print_nested(comments) 
```

[这是 Sprunge.us 上的内容（带语法）。](http://sprunge.us/AIVb?py)

预期结果：

```
foo
  foo bar
spam
  spam cheese
    spam cheese monty
muse 
```

实际结果：

```
foo
  foo bar
spam
  spam cheese
spam cheese monty
muse 
```

如您所见，`spam cheese monty`它根本没有缩进。任何想法为什么会这样？你将如何实施它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:25:34.720

当您递归调用时`print_nested`，您只能使用当前元素的子元素调用它。

所以文你呼唤`print_nested`的孩子`spam`，你得到的只是`spam cheese`。

这意味着当您调用`get_children`on时，您传递它`spam cheese`的列表中没有元素，因此不会缩进，因为它仅作为最外层调用的成员遇到。`comments``spam cheese monty``print_nested`

如果要保持脚本的当前结构，则需要进行`get_children`递归，因此它会无限查找子项的子项。

更好的方法是从评论中构建一个真正的树，您可以在其中实际查找父评论而无需进行列表遍历。

一种适用于您的示例的简单方法，可以轻松转换为使用树而不是列表：

```
class Comment(object):
    def __init__(self, pk, parent_pk, content):
        self.pk = pk
        self.parent_pk = parent_pk
        self.content = content

    def depth(self):
        depth = 0
        comment = self
        # this is just a recursive lookup converted to iterative
        while comment.parent_pk:
            # replace the array indexing with traversing up a tree
            comment = comments[comment.parent_pk - 1]
            depth += 1
        return depth

def print_nested(comments):
    for comment in comments:
        print comment.depth() * 2 * " " + comment.content

comments = [
    Comment(1, None, "foo"),
    Comment(2, 1, "foo bar"),
    Comment(3, None, "spam"),
    Comment(4, 3, "spam cheese"),
    Comment(5, 4, "spam cheese monty"),
    Comment(6, None, "muse"),
]

print_nested(comments) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:53:04.710

你只需要一个递归函数来检查孩子并打印它们：

```
class Comment(object):
    def __init__(self, pk, parent_pk, content):
        self.pk = pk
        self.parent_pk = parent_pk
        self.content = content

def print_nested(comments,pk=None,level=0):
    for comment in comments:
        if comment.parent_pk==pk:
            print ' ' * (level * 2), comment.content
            print_nested(comments,comment.pk,level+1)

comments = [
    Comment(101, None, "foo"),
    Comment(201, 101, "foo bar"),
    Comment(301, None, "spam"),
    Comment(415, 301, "spam cheese"),
    Comment(505, 415, "spam cheese monty"),
    Comment(622, None, "muse"),
]

print_nested(comments) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:10:32.300

在显示 Comment(4, 3, "spam cheese") 后，它作为 Comment(3, None, "spam") 的子级发生，您会从评论中弹出它。因此，当您处理 Comment(5, 4, "spam cheese monty") 时，缺少父“pk”，因此结果显示为 root

# java - 如何使用 HTML 设置 Jbutton 图像背景

> ID：12884971
> 
> 赞同：0
> 
> 时间：2012-10-14T18:02:10.697
> 
> 标签：java, html, image, swing, jbutton

我想使用图像作为 Jbutton 背景使用 HTML 和下面的代码：

```
JButton b = new JButton("<html><body><img src=\"file:///C|/Users/Joe/workspace/APPLET/img/2L.jpg \"></body></html>"); 
```

但是按钮中显示的图像仅显示在按钮的一半中，我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T19:38:00.023

在许多事情中，安德鲁试图说明的是，您没有考虑到边框和其他可能增加按钮大小的边界争用...

![在此处输入图像描述](../Images/5e1a0730536e7b80df3c381c9fa6890f.png)

左侧按钮的大小与图像大小相匹配，右侧的按钮考虑了组件`Insest`s ，允许内容适合按钮而不影响边框。

另外，我不认为 html 是您想要实现的最佳选择。

**更新**

当这件事在你面前爆发时，我没有告诉你；）

![在此处输入图像描述](../Images/84a317efa7f91b38198e9688e901158c.png)

```
URL url = getClass().getResource("/DukeWaveShadow48x48.png");
String text = "<html><table  border='0' width='48' height='48' cellpadding='0' cellspacing='1' background='" + url.toExternalForm() + "'><tr><td width='46' height='46' align='center'>Hello</td></tr></table></html>"; 
```

# java - Swing - 使用 UpdateUI 更改面板的内容

> ID：12884972
> 
> 赞同：1
> 
> 时间：2012-10-14T18:02:16.570
> 
> 标签：java, swing, user-interface, jframe, actionlistener

我正在浏览一个使用 Swing 的遗留应用程序，我正在努力弄清楚当用户单击按钮时屏幕是如何变化的。我无法弄清楚的原因之一是因为这是我第一次使用 Swing。我读过一本书并掌握了基础知识，但仍在苦苦挣扎。

基本上，我正在查看的屏幕有一个 JSplitPane，左侧有许多快捷按钮，右侧有一个空窗格。当我单击按钮时，右侧窗格会根据按下的按钮填充不同的屏幕。

通过代码，我期待在某个地方会根据按下的按钮调用 setVisible() 方法。

每个快捷按钮的 actionPerformed 方法如下所示：

```
void shortCutBtn_actionPerformed(ActionEvent e) {
   propertyChangeListeners.firePropertyChange("selectedShortCut", previousShortCutSel, currentShortCutSel);
   mainPanel.updateUI();
  } 
```

我浏览了大部分代码并得出结论，上面的代码是导致帧切换的原因，但我不明白这是怎么发生的。

每个屏幕由一个数字常量标识。在上面的代码示例中，previousShortCutSel 和 previousShortCutSel 指的是代表各个屏幕屏幕的数值。

我试图寻找有关 updateUI() 如何工作的文档，但我迷路了。以上如何导致 JSplitPanel 右侧面板的内容更新为新屏幕？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-14T18:45:38.307

这不适合使用`updateUI()`“将 UI 属性重置为当前外观的值”。由于示例本身可能不可靠，请考虑研究另一个示例。[`GoogleOlympiad`](https://sites.google.com/site/drjohnbmatthews/googleolympiad)，例如，使用（缓存的）图像设置标签的图标。

```
ImageIcon image = getImage(index);
imageLabel.setIcon(image); 
```

[![图片](../Images/e4e992486b95191c28973f856eda436b.png)](https://i.stack.imgur.com/x25yn.png)
[（来源：[sites.google.com 上的 drjohnbmatthews](https://sites.google.com/site/drjohnbmatthews/_/rsrc/1219654665541/googleolympiad/go1.png)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-14T20:57:41.440

根据 ziggy 的评论（很高兴它有帮助）

看看`PropertyChangeListener`似乎添加在代码中的 s。特别是该`propertyChange(PropertyChangeEvent e)`方法是更改​​内容的代码将出现的地方。

像往常一样为垃圾神+1好例子/建议

# jquery - 如何让两个垂直 div 一个挨着另一个，右边的一个溢出基于另一个的高度？

> ID：12884973
> 
> 赞同：0
> 
> 时间：2012-10-14T18:02:18.403
> 
> 标签：jquery, css, html, xhtml

我有两个 div，这两个 div 必须并排排列。基本上情况如下：

```
<div>
   <div id="divl" style="width:25%;height:100%;float:left;clear:none">Sidemenu</div>
   <div id="divr" style="width:75%;height:100%;clear:none">Content</div>
</div> 
```

好吧，我想要发生的是以下情况。我可以将它们并排放置，但我有一个问题。右侧 div 的高度应取决于左侧。我的意思是右 div 的内容不应导致右 div 的高度高于左 div。右 div 内容溢出。

总高度应由左侧 div 控制，右侧应相应调整。

这就对了！。这个怎么做？普通的xhtml是可能的吗？还是我需要 jQuery？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T18:19:04.860

作为替代方案，这很容易使用 jQuery 实现：

**示例标记**

```
 <div id="navigation">
    <ul>
      <li>Item 1</li>
      <li>Item 2</li>
      <li>Item 3</li>
      <li>Item 4</li>
      <li>Item 5</li>
    </ul>
  </div>

  <div id="content">Page content here!</div> 
```

**jQuery**

```
$('#content').height($('#navigation').height()); 
```

**编辑**

确保将上面的 jQuery 放入 DOM 就绪函数中，否则代码将永远不会被执行：

```
$(document).ready(function() {
  $('#content').height($('#navigation').height());
}); 
```

[这是一个小提琴](http://jsfiddle.net/25b97/17/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T18:08:10.183

[这里](http://css-tricks.com/fluid-width-equal-height-columns/)有一些很好的方法，以及它们的各种[演示](http://css-tricks.com/examples/FluidEqualHeightFauxColumns/)。这是取自 CSS-tricks 的示例：

```
<div id="one-true" class="group">
    <div class="col"><h3>I am listed first in source order.</h3><p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p></div>
    <div class="col"><p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.</p></div>
    <div class="col"><p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.</p></div>
</div>

#one-true { overflow: hidden; }
#one-true .col {
    width: 27%;
    padding: 30px 3.15% 0; 
    float: left;
    margin-bottom: -99999px;
    padding-bottom: 99999px;
}
#one-true .col:nth-child(1) { margin-left: 33.3%; background: #ccc; }
#one-true .col:nth-child(2) { margin-left: -66.3%; background: #eee; }
#one-true .col:nth-child(3) { left: 0; background: #eee; }
#one-true p { margin-bottom: 30px; } /* Bottom padding on col is busy */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:20:44.360

如果你只是控制父 div 的高度呢？通过仅控制父 div 的高度，这将给出匹配两个 div 的高度的外观。

[http://jsfiddle.net/ccLBy/](http://jsfiddle.net/ccLBy/)

# javascript - 基本 id 选择器的 jQuery 语法问题

> ID：12884978
> 
> 赞同：0
> 
> 时间：2012-10-14T18:02:46.570
> 
> 标签：javascript, jquery

```
 <div class="wpsc_buy_button_container">
    <input type="submit" value="<?php _e('Customize', 'wpsc'); ?>" name="Customize" 
      class="wpsc_customize_button" id="product_<?php echo wpsc_the_product_id(); ?>_customize_button"/>
  </div>

<script type="text/javascript">
  $("#product_<?php echo wpsc_the_product_id(); ?>_customize_button").click(function() {
    alert('product clicked');
  });
  alert('test click');
</script> 
```

查看-> 来源给出：

```
<script type="text/javascript">
  $("#product_53_customize_button").click(function() {
    alert('product clicked');
  });
  alert('test click');
</script> 
```

语法有问题吗，因为我没有看到我的警报。如果我删除单个 jQuery 行，则测试警报开始工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-14T18:11:15.577

这是你没有使用 jquery 事件

用这个

```
$(function(){
    $("#product_53_customize_button").click(function() {
        alert('product clicked');
      });

    }) 
```

或者

```
$(document).ready(function(){
        $("#product_53_customize_button").click(function() {
            alert('product clicked');
          });

        }) 
```

# performance - Theory : starting Pex Exploration and number of PUT generated

> ID：12884982
> 
> 赞同：0
> 
> 时间：2012-10-14T18:03:12.590
> 
> 标签：performance, pex

I read many papers about pex , I'm focus on the explorations strategies . I understand that the Fitnex strategy is default used but I don't understand how Pex create the first parametrized unit test .

Where I can find this information ?

By sperimental tests I think : - If parameter is "int" start with 0 - If parameter is "bool" start with false - If parameter is an object start with Null

Is it correct ?

Now about Fitnex strategy and solver constraints Z3 I think that it is able to solve only one constrain by iteration , sorry for my little English now I do an example :

Suppose to have the following method :

```
public void branchOverTests(bool a, bool b)
{
1   if (a)
    {
2       Console.WriteLine("B1");
    }
    else
    {
3       Console.WriteLine("B2");
    }
4   if (b)
    {
5       Console.WriteLine("B3");
    }
    else
    {
6       Console.WriteLine("B4");
    }
} 
```

Numbers are lines identify, Pex generate 3 tests :

```
--- Test 1
branchOverTests(a=false,b=false)
Path: 1F 3T 4F 6T
return target != (ClassMethod)null;
return target != (ClassMethod)null && a == false;
return target != (ClassMethod)null && a == false;
return target != (ClassMethod)null && a == false && b == false;

--- Test 2
branchOverTests(a=false,b=true)
Path: 1F 3T 4T 5T
return target != (ClassMethod)null;
return target != (ClassMethod)null && a == false;
return target != (ClassMethod)null && a == false;
return target != (ClassMethod)null && b != false && a == false;

Note: From Test 1 Flipped last branch: 
return target != (ClassMethod)null && a == false && b == false; 
-> return target != (ClassMethod)null && b != false && a == false; 
=> b = true

--- Test 3
branchOverTests(a=true,b=false)
Path: 1T 2T 4F 6T
return target != (ClassMethod)null;
return target != (ClassMethod)null && a != false;
return target != (ClassMethod)null && a != false;
return target != (ClassMethod)null && a != false && b == false;

Note: From Test 2 Resolve second condition of last branch:
return return target != (ClassMethod)null && b != false && a == false; 
-> return target != (ClassMethod)null && a != false && b == false; 
=> a = true
=> return target != (ClassMethod)null && a != false;
=> return target != (ClassMethod)null && a != false; 
```

But the most efficient set of parametrized tests is :

```
branchOverTests(a=false,b=false)
branchOverTests(a=true,b=true) 
```

After Test 1 :

```
return target != (ClassMethod)null && a == false;
-> return target != (ClassMethod)null && a != false;
=> a = true
=> return target != (ClassMethod)null && a != false && b != false;
=> b = true 
```

Ideal Test 2 :

```
branchOverTests(a=true,b=true)
Path: 1T 2T 4T 5T
return target != (ClassMethod)null;
return target != (ClassMethod)null && a != false;
return target != (ClassMethod)null && a != false;
return target != (ClassMethod)null && a != false && b != false; 
```

Is That I think correct ?

Thanks best regards.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T07:36:34.693

Pex 总是以默认值开始，就像你描述的那样。这是第一个测试用例。然后 Pex 探索执行路径的所有可能组合。（Fitnex 策略指导 Pex，但这对您的问题并不重要。）默认情况下，每当 Pex 发现增加分支覆盖率的新测试用例时，它都会发出另一个测试用例。Pex 以这种方式渴望，并且不能保证生成的测试套件是最小的，正如您发现的那样。但通常它非常接近。（在内部，Pex 最后还考虑了 (true,true)，但没有创建另一个测试用例，因为它不会增加分支覆盖率。）

# comments - 如何修复 DreamWeaver 的 javascript 注释突出显示？

> ID：12884984
> 
> 赞同：2
> 
> 时间：2012-10-14T18:03:18.363
> 
> 标签：comments, syntax-highlighting, dreamweaver

我有一个类似于以下的 JavaScript 行：

```
var a = (b / 2) + (c / 2); 
```

在 Dreamweaver 中，它将此段突出显示为注释，并按如下方式处理：

```
var a = (b /* 2 ) + (c */ 2); 
```

这是不正确的语法突出显示并且非常烦人。我在哪里可以找到语法高亮定义以及如何修改它们来纠正这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T17:54:47.063

您可以自己删除/修改正则表达式定义，方法是在 Dreamweaver 的配置路径中找到 CodeColoring.xml。对于 Windows 7 中的 CS6，默认值为：

```
C:\Program Files (x86)\Adobe\Adobe Dreamweaver CS6\configuration\ 
```

然后，您需要找到 JavaScript 方案：

```
<scheme MMString:name="JavaScript/scheme/name" id="JavaScript" ...> 
```

在其中，您会找到正则表达式定义：

```
<regexp name="RegExp" id="CodeColor_JavascriptRegexp" delimiter="/" escape="\\">
    <searchPattern><![CDATA[/\e+\\/]]></searchPattern>
</regexp> 
```

这可能可以细化，但我在大多数情况下不使用正则表达式，所以我只是删除了这一部分。重启 DW，瞧。

如果您想细化定义，StackOverflow 似乎将其正则表达式突出显示：

```
var regex = /a+b/;
var number = (window.innerWidth / window.innerHeight) / 2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T18:08:00.807

这篇文章解释了如何做到这一点：

**修改 Dreamweaver 的语法高亮**
[http://realworldz.wordpress.com/2007/10/04/modifying-dreamweavers-syntax-highlighting/](http://realworldz.wordpress.com/2007/10/04/modifying-dreamweavers-syntax-highlighting/)

它提供了一个示例，说明如何`new`为 VBScript 的关键字添加语法高亮：

1.  如果 Dreamweaver 已打开，请关闭它。
2.  去`C:\Documents and Settings\<YOUR USERNAME>\Application Data\Macromedia\Dreamweaver 8\Configuration\CodeColoring`
3.  在记事本中打开“ASP VBScript.xml”文件。
4.  查找标签，在“Mod”标签之后，添加一个新标签，名称为“New”，如下所示；`<keyword>New</keyword>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-14T18:14:05.283

我到处寻找，我同意上一个问题的答案：[Dreamweaver CS5 代码提示](https://stackoverflow.com/questions/9764365/dreamweaver-cs5-code-hinting)

对语法高亮没有太多控制。您可以使用 Robert's answer here 描述的方法添加更多保留字等。但编辑该文件不适用于更改 Dreamweaver 处理常量和运算符突出显示的方式。

这是一个合理的方法来改变你编写代码的方式，这样你的语法仍然会在这样的例子中突出显示。

```
<script>
            var a = 
               (b/2)         //Because the forward slashes are not on the same line,
              +(c/2);        //Dreamweaver will not stop highlighting the numbers 
                             //and operators   

    document.write(a);

</script> 
```

**注意**：在这个特定示例中，您的代码也可以简化为`var a = (b+c)/2;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-21T15:40:22.723

由于字符`/([{;,=!|&~^<>+-*%?:}`后面不能有除号，这就是我想出的：

`<searchPattern><![CDATA[/\s+/\e+\\/]]></searchPattern>`
（这个必须至少有一个空格字符以避免与行尾注释冲突）

`<searchPattern><![CDATA[(\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[[\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[{\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[;\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[,\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[=\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[!\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[|\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[&\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[~\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[^\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[<\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[>\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[+\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[-\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[*\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[%\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[?\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[:\s*/\e+\\/]]></searchPattern>`
`<searchPattern><![CDATA[}\s*/\e+\\/]]></searchPattern>`

对于类似的情况`if (x) /foo/.exec('bar')`，只需将 RegExp 放在括号中即可正确格式化。唯一的其他不良影响是前面的字符将被格式化为常规文本（不是粗体或彩色）。

# wpf - WPF borderless window on maximize exceeds window height and width

> ID：12884987
> 
> 赞同：1
> 
> 时间：2012-10-14T18:04:03.287
> 
> 标签：wpf, controltemplate, borderless

I have created a border-less window template so that all window look the same. The template code looks like this:

```
public abstract class WindowBase : Window
{
    static WindowBase()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(WindowBase), new FrameworkPropertyMetadata(typeof(WindowBase)));
    }
} 
```

And I have a style which looks like this:

```
 <Style TargetType="{x:Type WindowBase}">
        <!--<Setter Property="Topmost" Value="True" />-->
        <Setter Property="WindowStyle" Value="None" />
        <Setter Property="Background" Value="White"/>
        <Setter Property="ResizeMode" Value="CanResizeWithGrip" />
        <Setter Property="WindowState" Value="Maximized" />
        <Setter Property="AllowsTransparency" Value="True"/>
        <Setter Property="SnapsToDevicePixels" Value="true"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Window}">
                <Border Margin="0" BorderThickness="1">
                    <Grid>
                        <Grid Background="White" Visibility="Visible">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1.5*"/>
                                <RowDefinition Height="10*"/>
                            </Grid.RowDefinitions>
                            <ContentPresenter Grid.Row="0" Grid.RowSpan="2"/>
                        </Grid>
                        <ContentPresenter />
                        <ResizeGrip Name="ResizeGroup" VerticalAlignment="Bottom" HorizontalAlignment="Right" KeyboardNavigation.IsTabStop="False"/>
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="ResizeMode" Value="CanResizeWithGrip"/>
                            <Condition Property="WindowState" Value="Maximized"/>
                        </MultiTrigger.Conditions>
                        <Setter Property="Visibility" TargetName="ResizeGroup" Value="Collapsed"/>
                    </MultiTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

Now when the application runs in maximized state, what I have observed is the window exceeds the screen space. Assume I am in 1600 x 900, my maximum work area would be 1600 x 900, but the application takes something like this: 1614 x 914\. Also, using WPF Inspector, what I observed is the Top and Left position is in negative. It shows up as '-7' in my case.

I am not sure, where I am going wrong? Can someone help?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T21:58:20.967

将[ResizeMode](http://msdn.microsoft.com/en-us/library/system.windows.window.resizemode.aspx)设置为`NoResize`而不是`CanResizeWithGrip`. 这将删除调整大小的边框，这显然是在计算大小时考虑在内的，尽管不可见。

```
<Style TargetType="{x:Type WindowBase}">
    ...
    <Setter Property="ResizeMode" Value="NoResize" /> 
    ...
</Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-27T16:48:40.880

尝试 ：

```
 <ControlTemplate.Triggers>
                    <Trigger Property="IsActive" Value="True">
                        <Setter Property="BorderBrush" Value="{DynamicResource WindowBorderActive}" />
                    </Trigger>
                    <Trigger Property="WindowState" Value="Maximized">
                        <Setter TargetName="Maximize" Property="Visibility" Value="Collapsed" />
                        <Setter TargetName="Restore" Property="Visibility" Value="Visible" />
                        <Setter TargetName="LayoutRoot" Property="Margin" Value="7" />
                    </Trigger>
                    <Trigger Property="WindowState" Value="Normal">
                        <Setter TargetName="Maximize" Property="Visibility" Value="Visible" />
                        <Setter TargetName="Restore" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="ResizeMode" Value="CanResizeWithGrip" />
                            <Condition Property="WindowState" Value="Normal" />
                        </MultiTrigger.Conditions>
                        <Setter TargetName="ResizeGrip" Property="Visibility" Value="Visible" />
                    </MultiTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate> 
```

Margin=7 可以解决问题。:)

# php - 再次与乐透计划

> ID：12884994
> 
> 赞同：2
> 
> 时间：2012-10-14T18:05:09.590
> 
> 标签：php, variables, for-loop

我之前有一个小彩票程序的问题，该程序计算 6/49 的所有可能组合（在 PHP 中）。

这是我目前的问题。我使用条件，所以数字不会重复，但在下一个循环中，当第一个数字改变时，我有一个重复的组合。让我通过一个例子来解释：

我有这个组合：

```
1 2 3 4
1 2 3 5 
1 2 3 6
...
1 2 4 3
1 2 4 5
1 2 4 6 
```

所以我的彩票`1 2 3 4`是一样的`1 2 4 3`。

有任何想法如何解决它？我什么都想不出来...

这是代码（我只做到了 4/49 :D）

```
<?php

for ($i=1 ; $i<50 ; $i++)

{

    $a=$i;
    for ($j=1 ; $j<50 ; $j++)

    {

        if ($i!=$j)
        {
            $b=$j;

                for ($k=1 ; $k<50 ; $k++)

                {

                if ($k!=$j && $k!=$i)
                {
                    $c=$k;

                    for ($l=1 ; $l<50 ; $l++)

                    {

                        if ($l!=$i && $l!=$j && $l!=$k)
                        {
                            $d=$l;
                            echo "$a $b $c $d <br>";
                        }
                    }
                }
            }
        }
    }
 }

 ?>
 <br/><br/> 
```

**谢谢 ！**

更新：

代码如下所示：

```
< ?php

  for($a=1; $a<50; $a++)

  {

     for($b=$a+1; $b<50; $b++)

  {

    for($c=$b+1; $c<50; $c++)

    {

        for($d=$c+1; $d<50; $d++)

        {

            for($e=$d+1; $e<50; $e++)

            {

                for($f=$e+1; $f<50; $f++)

                {

                   $t=$t+1;
                }
            }

        }
    }
  }
 }
 echo "$t";

 ?> 
```

我确实得到了正确的答案，但我也得到了这个错误：“未定义的变量：t”任何想法为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-14T18:20:01.467

要获得所有组合，您应该将内部循环变量值初始化为父循环变量值 + 1 4/49 的示例

```
for($a=1; $a<50-3; $a++)
    for($b=$a+1; $b<50-2; $b++)
        for($c=$b+1; $c<50-1; $c++)
            for($d=$c+1; $d<50; $d++)
                echo "$a $b $c $d<br>"; 
```

作为奖励，您不再需要测试值是否都不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T14:10:10.210

当您直接使用 $t=$t+1 时，您得到了错误未定义变量 t。但是你没有初始化$t。所有其他变量都已初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T15:45:44.173

PEAR Combinatorics 类为您完成所有这些：http: [//pear.php.net/package/Math_Combinatorics/docs/latest/Combinatorics/_Math_Combinatorics-1.0.0---Combinatorics.php.html](http://pear.php.net/package/Math_Combinatorics/docs/latest/Combinatorics/_Math_Combinatorics-1.0.0---Combinatorics.php.html)

# java - Error while creating x.509 certificate

> ID：12884995
> 
> 赞同：2
> 
> 时间：2012-10-14T18:05:20.097
> 
> 标签：java, cryptography

I would like to create x.509 certificate, so I copy the following codes from Wrox, Beggining Cryptography with Java, chapter 6.

```
import java.io.OutputStreamWriter;
import java.math.BigInteger;
import java.security.KeyPair;
import java.security.cert.X509Certificate;
import java.util.Date;
import java.util.Enumeration;

import org.bouncycastle.asn1.ASN1Set;
import org.bouncycastle.asn1.DERObjectIdentifier;

import org.bouncycastle.asn1.pkcs.Attribute;
import org.bouncycastle.asn1.pkcs.PKCSObjectIdentifiers;
import org.bouncycastle.asn1.x509.BasicConstraints;
import org.bouncycastle.asn1.x509.ExtendedKeyUsage;
import org.bouncycastle.asn1.x509.KeyPurposeId;
import org.bouncycastle.asn1.x509.KeyUsage;
import org.bouncycastle.asn1.x509.X509Extension;
import org.bouncycastle.asn1.x509.X509Extensions;

import org.bouncycastle.jce.PKCS10CertificationRequest;
import org.bouncycastle.openssl.PEMWriter;
import org.bouncycastle.x509.X509V3CertificateGenerator;
import org.bouncycastle.x509.extension.AuthorityKeyIdentifierStructure;
import org.bouncycastle.x509.extension.SubjectKeyIdentifierStructure;

import chapter6.PKCS10ExtensionExample;
import chapter6.X509V1CreateExample;

//example of a basic CA

public class PKCS10CertCreateExample
{
    public static X509Certificate[] buildChain() throws Exception
    {
        //create the certification request
        KeyPair pair = chapter7.Utils.generateRSAKeyPair();
        PKCS10CertificationRequest request =      PKCS10ExtensionExample.generateRequest(pair);

    //create a root certificate
    KeyPair rootPair=chapter7.Utils.generateRSAKeyPair();
    X509Certificate rootCert = X509V1CreateExample.generateV1Certificate(rootPair);

    //validate the certification request
    if(!request.verify("BC"))
    {
        System.out.println("request failed to verify!");
        System.exit(1);
    }

    //create the certificate using the information in the request
    X509V3CertificateGenerator certGen = new X509V3CertificateGenerator();

    certGen.setSerialNumber(BigInteger.valueOf(System.currentTimeMillis()));
    certGen.setIssuerDN(rootCert.getSubjectX500Principal());
    certGen.setNotBefore(new Date(System.currentTimeMillis()));
    certGen.setNotAfter(new Date(System.currentTimeMillis()+50000));
    certGen.setSubjectDN(request.getCertificationRequestInfo().getSubject());
    certGen.setPublicKey(request.getPublicKey("BC"));
    certGen.setSignatureAlgorithm("SHA256WithRSAEncryption");

    certGen.addExtension(X509Extensions.AuthorityKeyIdentifier, false, new AuthorityKeyIdentifierStructure(rootCert));
    certGen.addExtension(X509Extensions.SubjectKeyIdentifier, false, new SubjectKeyIdentifierStructure(request.getPublicKey("BC")));
    certGen.addExtension(X509Extensions.BasicConstraints, true, new BasicConstraints(false));
    certGen.addExtension(X509Extensions.KeyUsage, true, new BasicConstraints(false));
    certGen.addExtension(X509Extensions.KeyUsage, true, new KeyUsage(KeyUsage.digitalSignature | KeyUsage.keyEncipherment));
    certGen.addExtension(X509Extensions.ExtendedKeyUsage, true, new ExtendedKeyUsage(KeyPurposeId.id_kp_serverAuth));

    //extract the extension request attribute
    ASN1Set attributes = request.getCertificationRequestInfo().getAttributes();

    for(int i=0;i!=attributes.size();i++)
    {
       Attribute attr = Attribute.getInstance(attributes.getObjectAt(i));

       //process extension request
       if(attr.getAttrType().equals(PKCSObjectIdentifiers.pkcs_9_at_extensionRequest))
       {
               X509Extensions extensions = X509Extensions.getInstance(attr.getAttrValues().getObjectAt(0));

               Enumeration<?> e = extensions.oids();
               while(e.hasMoreElements())
               {
                   DERObjectIdentifier oid = (DERObjectIdentifier)e.nextElement();
                   X509Extension ext = extensions.getExtension(oid);

                   certGen.addExtension(oid, ext.isCritical(), ext.getValue().getOctets());
               }   
           }       
       }
    X509Certificate issuedCert = certGen.generateX509Certificate(rootPair.getPrivate());
    return new X509Certificate[]{issuedCert, rootCert};
    }

    public static void main(String[] args) throws Exception
    {
        X509Certificate[] chain = buildChain();
        PEMWriter pemWrt = new PEMWriter(new OutputStreamWriter(System.out));
        pemWrt.writeObject(chain[0]);
        pemWrt.writeObject(chain[1]);

        pemWrt.close();
    }

} 
```

However, the codes shows errors as follows

Exception in thread "main" java.lang.IllegalArgumentException: extension 2.5.29.15 already added at org.bouncycastle.asn1.x509.X509ExtensionsGenerator.addExtension(Unknown Source) at org.bouncycastle.asn1.x509.X509ExtensionsGenerator.addExtension(Unknown Source) at org.bouncycastle.x509.X509V3CertificateGenerator.addExtension(Unknown Source) at PKCS10CertCreateExample.buildChain(PKCS10CertCreateExample.java:68) at PKCS10CertCreateExample.main(PKCS10CertCreateExample.java:100)

please, help me..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-15T02:06:16.147

谷歌搜索`extension 2.5.29.15`会告诉你指的是`KeyUsage`

谷歌搜索源代码`X509V3CertificateGenerator`显示如果已经添加了提供的扩展，`addExtension()`调用会引发异常。`X509ExtensionsGenerator.addExtension()`

您在上面提供的源代码就是这样做的，并引发了异常：

```
certGen.addExtension(X509Extensions.KeyUsage, true, new BasicConstraints(false));
certGen.addExtension(X509Extensions.KeyUsage, true, new KeyUsage(KeyUsage.digitalSignature | KeyUsage.keyEncipherment)); 
```

这是代码中的一个错误。您需要删除其中之一。我猜是第一个。