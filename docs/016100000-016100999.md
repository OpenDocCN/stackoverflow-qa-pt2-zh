# StackOverflow 问答 16100000-16100999

# drupal - 如何将 apc 限制为仅在虚拟服务器上安装一个 drupal

> ID：16100008
> 
> 赞同：1
> 
> 时间：2013-04-19T08:00:50.050
> 
> 标签：drupal, apache2, settings, apc

我有一台虚拟服务器，安装了 2 次 drupal。一种是用于测试目的。是否可以仅将 APC 的使用限制在某些目录中，这样测试页面就不会像生产站点那样占用相同数量的资源？我的文件安装在这样的服务器上：

```
 data/web/mydomain.com/web - I want to use apc here. 
 data/web/mydomain/sub/test - I do not want to use apc. 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T19:49:47.340

此外，在 drupal 的子站点级别，您可以通过在 settings.php 中添加以下行来实现此目的：

ini_set('apc.enabled', 1); // 1 启用 & 0 禁用子站点的 apc。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T18:11:53.750

回答您的具体问题：**是否可以将 APC 的使用仅限于某些目录？** *是的。*

使用文件[`apc.filters`](http://www.php.net/manual/en/apc.configuration.php#ini.apc.filters)中的指令`apc.ini`：

> POSIX 扩展正则表达式的逗号分隔列表。如果任何模式与源文件名匹配，则不会缓存该文件。请注意，用于匹配的文件名是传递给 include/require 的文件名，而不是绝对路径。如果表达式的第一个字符是 + 则表达式将是附加的，即任何与表达式匹配的文件都将被缓存，如果第一个字符是 - 那么任何匹配的文件都不会被缓存。- 大小写是默认值，因此可以省略。

因此，要排除测试目录，请将以下内容添加到您的 apc.ini 文件并重新启动 apache：

`apc.filters = "-/data/web/mydomain/sub/test/.*"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:06:19.010

默认情况下，您可以在全局 php.ini 中禁用 APC，并在相关文档根目录的自定义 php.ini 中专门启用它。这肯定取决于您的 httpd/php 配置，即 DSO/suPHp

# php - 提交后保留选定的动态下拉列表

> ID：16100013
> 
> 赞同：0
> 
> 时间：2013-04-19T08:01:21.327
> 
> 标签：php, javascript, jquery

下面是我填充动态列表的代码。

```
<?php
if(isSet($_POST['supplier'])) {

include 'db.php';

$stmt = $mysql->prepare("SELECT DISTINCT SupplierBrand FROM plastic WHERE HeadingNo='".$_POST['supplier']."' ORDER BY SupplierBrand");
$stmt->execute();
$stmt->bind_result($supplierBrand);
?>
<option value="All" width="100px">--ALL--</option>
<?php
while ($row = $stmt->fetch()) : ?>

<option value="<?php echo $supplierBrand; if($_POST['county'] == $supplierBrand) {echo "selected";} ?>" width="100px"><?php echo $supplierBrand; ?></option>

<?php endwhile; ?>

<?php } ?> 
```

我添加了代码 `if($_POST['county'] == $supplierBrand) {echo "selected";}` 以尝试保留我在提交时选择的值。此上下文中的此代码不起作用。调试后我注意到县值是未定义的。这是 chrome 调试的错误：

```
Notice&lt;/b&gt;:  Undefined index: county 
```

如何获取其在另一个页面上的值县，以及`$_POST['supplier']`通过使用 jquery 传递上述 php 脚本值。

下面是html代码：

```
<div id="county_drop_down">
                        <select id="county" name="county" >
                            <option value="" width="100px">Supplier...</option>
                        </select>
                        </div>
                            <span id="loading_county_drop_down">
                            <img src="css/loader.gif" width="16" height="16" align="absmiddle">&nbsp;Loading...</span>
                            <div id="no_county_drop_down">No lens type/design has been selected.</div> 
```

对于 javascript，请参阅此[链接](https://stackoverflow.com/questions/16056702/how-to-debug-using-firebug-and-show-the-value-of-radio-button/16057150?noredirect=1#16057150)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:14:49.410

您的代码中存在大量问题，这里首先要解决其中的一些问题。

`value="<?php echo $supplierBrand; if($_POST['county'] == $supplierBrand) {echo "selected";} ?>"`

将导致`value="(int) selected"`哪个是无效的 HTML 它应该是这个`value="<?php echo $supplierBrand;?>" <?php echo ($_POST['county'] == $supplierBrand) ? "selected=\"selected\"" : "" ; ?>` 记住有效的 html 是 selected="selected" 和 checked="checked" 等。

您在上面的代码中缺少您的选择打开我假设它在其他地方创建？

您的国家/地区值是从另一个页面发布的，因此您需要将其存储在本地，并在它重新发布给自己时通过此页面传回。我通常使用隐藏字段，因此如果 $_POST['country'] 是从该页面上的另一个页面传入的，我将使用`<input type="hidden" name="country" id="country" value="<?php echo $_POST['country'];?>" />` 这将确保它从上一页接收国家，并始终使用重新发布之前入站的任何内容重新填充此字段。

那么你上面的 if 语句将可以正常工作，因为 $_POST['country'] 将存在。

最后正如已经指出的那样 isSet() 应该都是小写 isset()

您是否也在使用自定义数据库类？它看起来像 mysqli 或 pdo，但准备列表看起来不应该是错误的`$mysqli->prepare()`吗？由于您也使用了准备，因此您应该进行参数绑定而不是将 $_POST['supplier'] 注入准备中，因为目前您的方式使准备变得毫无意义，并且还使您容易受到 sql 注入等的影响.

# css - css flexbox等高列不起作用

> ID：16100015
> 
> 赞同：0
> 
> 时间：2013-04-19T08:01:34.887
> 
> 标签：css, flexbox

我试图让 css3 flexbox 工作（第一次）以制作等高的列（对于那些支持它的浏览器）。

我在网上看到了各种例子，但我无法工作。

这是我的代码（后面是 jsfiddle 链接）

```
<div>
    <span><p>a</p><p>a</p><p>a</p><p>a</p><p>a</p></span>
    <span>col2</span>
    <span>col3</span>
</div>

div { background:red; float:left;
-webkit-display:flex;
-moz-display:flex;
display:flex;
}
span { display:block; background:yellow; float:left; width:100px; margin:0 10px;
-webkit-flex:1;
-moz-flex:1;
flex:1;
} 
```

[http://jsfiddle.net/38kbV/](http://jsfiddle.net/38kbV/)

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:33:17.047

浮动导致整个事情在 Firefox 中分崩离析。如果您需要它与其他内容内联显示，则需要使用内联显示属性（inline-flex、inline-flexbox、inline-box）。

当您遵循现代 Flexbox 草案时，您需要坚持属于该草案的所有属性。如果您尝试混合搭配，它们将无法按预期工作。在各种浏览器中实现了 3 种不同的草案，每种都有不同的属性名称*和*值（参见：[https](https://gist.github.com/cimmanon/727c9d558b374d27c5b6) ://gist.github.com/cimmanon/727c9d558b374d27c5b6 ）

[http://tinker.io/11122/2](http://tinker.io/11122/2)

```
div {
  background: red;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flexbox;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
}

span {
  display: block;
  background: yellow;
  float: left;
  width: 100px;
  margin: 0 10px;
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  flex: 1;
} 
```

# android - 当我将手机连接到笔记本电脑时，我的手机会重新启动

> ID：16100016
> 
> 赞同：0
> 
> 时间：2013-04-19T08:01:41.763
> 
> 标签：android, eclipse, debugging

我尝试在我的手机中调试android应用程序..

我已经安装了 Eclipse，我在 AVD 上顺利运行测试，现在我想在我的手机上调试，但是，当我将它连接到笔记本电脑的 USB 端口时，它重新启动而不允许我做任何事情。

我的手机是 LG Optimus One P500，带有 openOptimus build 2.202.1，版本 2.3.3 我的笔记本电脑有 ubuntu 13.04，虽然.. 我在 windows 上尝试过并且发生了同样的情况。

我认为我已经更改了手机上的 android 版本或进行了硬重置，但是..您对此有何看法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:10:37.403

I think this is a bug with your Custom rom. Maybe it wont allow you to connect to a PC or Laptop. Try switching to a different/stable/newer version of the same ROM or revert back to stock rom. If that solves the restart problem make sure you add your device vendor id to the rules file and keep the debugging mode ON. [http://developer.android.com/tools/device.html](http://developer.android.com/tools/device.html) It should work fine.

# python - itertools.combinations() 的输出

> ID：16100017
> 
> 赞同：4
> 
> 时间：2013-04-19T08:01:43.547
> 
> 标签：python, list

我是 python 编程的新手（嗯，一般的编程），所以我真的希望有人可以帮助我使用内置的 itertools.combinations 函数。

我正在尝试从 52 张卡片（即 52 C 7）列表中创建所有可能组合 7 卡片组合的列表。

所以我的代码看起来像

```
>>> import itertools
>>> deck = [1,2,3,4,5...,52]
>>> list_1 = list(itertools.combinations(deck,2))
>>> list_1[5]
(1, 7) 
```

工作到目前为止，直到我尝试 7 的组合

```
>>> all_possible_hands = list(itertools.combinations(deck,7))
Traceback (most recent call last):
  File "<pyshell#7>", line 1, in <module>
    all_possible_hands = list(itertools.combinations(deck,7))
MemoryError 
```

可以为较小的数据集（52 C 2）创建该列表，但是当数字变大时，我得到一个 MemoryError，可能是 RAM 不足。我用谷歌搜索了 combine() 函数的工作原理，显然它输出了一个对象，我将其转换为一个列表。

当我没有 list() 时，控制台返回了一个内存地址（我相信）。

```
>>> all_possible_hands = itertools.combinations(deck,7)
>>> all_possible_hands
<itertools.combinations object at 0x02E63180> 
```

我的问题是：内存地址是否包含我想要的数据，并且可以并且以某种方式将其转换为列表或其他东西，以便我可以访问列表中的各个元素？

谢谢你。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T08:07:59.517

一副 52 张牌中有 133784560 张七张牌组合，您正在尝试创建一个包含 133784560 个元素的列表。Python 没有足够的内存来执行此操作，因此它崩溃了。

`itertools.combinations`返回一个迭代器。这就像一个列表，只是它只根据需要一次给你一个元素，而不是一次创建所有元素。这样可以节省内存。您是否可以从该迭代器中获得您想要的东西取决于您想要做什么。如果你只想打印每一个，你可以很容易地做到这一点：

```
for item in itertools.combinations(deck, 7):
     print item 
```

你不能轻易做到的是得到一个特定的项目。没有直接等同`list_l[5]`于获得第五个元素的方法。您必须对迭代器进行 5 次迭代，或者使用`itertools`（如`islice`）中的其他工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:07:00.340

该对象是一个[*迭代器*](http://docs.python.org/2/library/stdtypes.html#typeiter)，由[生成器](http://docs.python.org/2/glossary.html#term-generator)函数返回`itertools.combinations`。您可以通过迭代此对象来访问每个组合：

```
for hand in all_possible_hands:
     print hand 
```

迭代器有助于避免一次将所有数据保存在内存中，但缺点是您只能访问每个项目一次。当你完成对对象的迭代时，它已经用尽了，你不能从中得到任何东西。此外，与通常的列表等不同，如果不迭代到最后，您将无法访问最后一项。

您也可以编写生成器函数。[`itertools`文档](http://docs.python.org/2/library/itertools.html)中有示例。生成器函数应该有一个或多个[`yield`statements](http://docs.python.org/2/reference/simple_stmts.html#the-yield-statement)而不是[`return`statements](http://docs.python.org/2/reference/simple_stmts.html#the-return-statement)。

# file - Powershell：删除具有不同父文件夹名称的文件夹中的文件

> ID：16100022
> 
> 赞同：1
> 
> 时间：2013-04-19T08:02:07.210
> 
> 标签：file, powershell, directory, get-childitem

我想使用此选项删除具有特定扩展名（在我的情况下为 .cfg）且文件夹名称不同的文件。例如，如果我有一个名为 MYFOLDER 的文件夹，并且在这两个文件 MYFOLDER.cfg 和 otherfile.cfg 中，则应该（递归地）删除 otherfile.cfg。

这就是我到目前为止所拥有的：

```
$folder = Get-ChildItem * -exclude *.* -name -recurse
$file = Get-ChildItem * -include *.cfg* -name -recurse | % { [IO.Path]::GetFileNameWithoutExtension($_) }
#$folder | ForEach-Object {Compare-Object $folder $file | <DELETE file with different name>} 
```

我怎样才能做最后一行？

提前致谢。问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:58:56.513

两班轮，但你可以把它变成一个单班轮；）

```
$FolderName = (Get-Location).Path.Split("\")[(Get-Location).Path.Split("\").Count -1]
$Files = Get-ChildItem | Where-Object {$_.Extension -ne ".cfg" -or $_.Name.Split(".")[0] -ne $FolderName} | Remove-Item -Recurse 
```

但是当文件的名称包含一个点（例如 File.Name.cfg）时，此代码以及 Musaab Al-Okaidi 的代码都没有处理这种情况

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:27:51.273

Remove -WhatIf 删除文件：

```
Get-ChildItem -Filter *.cfg -Recurse | 
Where-Object {$_.BaseName -ne $_.Directory.Name} | 
Remove-Item -WhatIf 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:38:22.763

这将为您完成：

```
Get-ChildItem -Recurse -Include *.cfg  | % { If ( $_.Name.Split(".")[0] -ne $_.Directory.Name ) {$_.Delete()}} 
```

# image - 使用 Go 处理水印图像

> ID：16100023
> 
> 赞同：16
> 
> 时间：2013-04-19T08:02:09.053
> 
> 标签：image, image-processing, go, watermark

我想找到一些关于制作水印图像示例的东西，用 Go 语言编写！

我需要一个 PNG 图像作为水印图像，它可以应用于其他格式 PNG、GIF、JPEG 等，

我希望你能给我一些实际的例子。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-19T14:05:14.817

如前所述，您可以使用 image/draw 包为图像添加水印。

这是一个快速实用的示例，将透明 png 图像添加到 jpeg 图像并保存为 jpeg：

```
package main

import (
    "image"
    "image/draw"
    "image/jpeg"
    "image/png"
    "os"
)

func main() {
    imgb, _ := os.Open("image.jpg")
    img, _ := jpeg.Decode(imgb)
    defer imgb.Close()

    wmb, _ := os.Open("watermark.png")
    watermark, _ := png.Decode(wmb)
    defer wmb.Close()

    offset := image.Pt(200, 200)
    b := img.Bounds()
    m := image.NewRGBA(b)
    draw.Draw(m, b, img, image.ZP, draw.Src)
    draw.Draw(m, watermark.Bounds().Add(offset), watermark, image.ZP, draw.Over)

    imgw, _ := os.Create("watermarked.jpg")
    jpeg.Encode(imgw, m, &jpeg.Options{jpeg.DefaultQuality})
    defer imgw.Close()
} 
```

图片.jpg：

![在此处输入图像描述](https://i.stack.imgur.com/hsNSA.jpg)

水印.png：

![在此处输入图像描述](https://i.stack.imgur.com/4X6E0.png)

结果：

![在此处输入图像描述](https://i.stack.imgur.com/plCd8.jpg)

# winapi - 对大文件大小的顺序 i/o 操作进行优化

> ID：16100024
> 
> 赞同：1
> 
> 时间：2013-04-19T08:02:23.430
> 
> 标签：winapi, optimization, fstream, large-files

```
编译器：Microsoft C++ 2005
硬件：AMD 64 位 (16 GB)

```

提交对 18GB 文件的顺序只读访问，具有以下时序、文件访问和文件结构特征：

18,184,359,164（文件长度）
11,240,476,672（ntfs 压缩文件长度）

```
时间文件方法盘
14:33？压缩的 fstream 固定磁盘
14:06 正常fstream固定盘
12:22 正常winapi固定盘
11:47 压缩winapi固定盘
11:29 压缩的 fstream ram 磁盘
10:37 压缩的 winapi ram 磁盘
 7:18 压缩 7z 存储解压到 ntfs 12gb ram 磁盘
 6:37 正常复制到同卷硬盘
```

fstream 构造函数和访问：

```
定义缓冲区大小 524288
    无符号整数兆字节 = 缓冲区大小；
    字符 * 数据缓冲区0；databuffer0 = (char*) malloc (mbytes);
    datafile.open("drv:/file.ext", ios::in | ios::binary );
    datafile.read (databuffer0, mbytes);

```

winapi构造函数和访问：

```
定义缓冲区大小 524288
    无符号整数兆字节 = 缓冲区大小；
    const TCHAR* const filex = _T("drv:/file.ext");
    字符 ReadBuffer[BUFFERSIZE] = {0};
    hFile = CreateFile(filex, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    如果（假 == ReadFile（hFile，ReadBuffer，BUFFERSIZE-1，&dwBytesRead，NULL））
    { ...
```

对于 fstream 方法，-> 16MB 缓冲区大小不会减少处理时间。对于 winapi 方法，超过 .5MB 的所有缓冲区大小均失败。哪些方法可以优化此实现与处理时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T21:45:24.917

尝试这个。

```
hf = CreateFile(..... FILE_FLAG_NO_BUFFERING | FILE_FLAG_OVERLAPPED ...) 
```

然后是阅读循环。在 iPad 上打字时省略了一些小细节......

```
int bufsize =4*1024*1024;
CEvent e1;
CEvent e2;
CEvent e3;
CEvent e4;
unsigned char* pbuffer1 = malloc(bufsize);
unsigned char* pbuffer2 = malloc(bufsize);
unsigned char* pbuffer3 = malloc(bufsize);
unsigned char* pbuffer4 = malloc(bufsize);
int CurOffset = 0;

do {
   OVERLAPPED r1;
   memset(&r1, 0, sizeof(OVERLAPPED));
   r1.Offset = CurOffset;
   CurOffset += bufsize;
   r1.hEvent = e1;
   if (! ReadFile(hf, pbuffer1, bufsize, bufsize, &r1)) {
       // check for error AND error_handle_eof (important)
   }

   OVERLAPPED r2;
   memset(&r2, 0, sizeof(OVERLAPPED));
   r2.Offset = CurOffset;
   CurOffset += bufsize;
   r2.hEvent = e2;
   if (! ReadFile(hf, pbuffer2, bufsize, bufsize, &r2)) {
       // check for error AND error_handle_eof (important)
   }

   OVERLAPPED r3;
   memset(&r3, 0, sizeof(OVERLAPPED));
   r3.Offset = CurOffset;
   CurOffset += bufsize;
   r3.hEvent = e3;
   if (! ReadFile(hf, pbuffer3, bufsize, bufsize, &r3)) {
       // check for error AND error_handle_eof (important)
   }

   OVERLAPPED r4;
   memset(&r4, 0, sizeof(OVERLAPPED));
   r4.Offset = CurOffset;
   CurOffset += bufsize;
   r4.hEvent = e4;
   if (! ReadFile(hf, pbuffer1, bufsize, bufsize, &r4)) {
       // check for error AND error_handle_eof (important)
   }

   // wait for events to indicate data present
   // send data to consuming threads
   // allocate new buffer
} while ( not eof, etc ) 
```

以上是您需要的骨骼。我们使用它来实现高 I/O 吞吐率，但您可能需要稍微改进它以实现最终性能。我们发现 4 个出色的 I/O 最适合我们使用，但这会因平台而异。每个 IO 读取不到 1Mb 对性能不利。读取缓冲区后，不要在读取循环中使用并使用它，发布到另一个线程并分配另一个缓冲区（但从重用队列中获取它们，不要继续使用 malloc）。上面的总体意图是尝试保持 4 个未完成的 IO 对磁盘开放，一旦你没有这个，整体性能就会下降。

此外，这在只读取文件的磁盘上效果最好。如果您同时开始在同一个磁盘上读取/写入不同的文件，性能会迅速下降，除非您有 SSD 磁盘！

不知道为什么您的 readfile 因 0.5Mb 缓冲区而失败，只需仔细检查一下，我们的实时产品代码正在使用 4Mb 缓冲区

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:08:16.147

您是否尝试过对文件进行内存映射？在我的测试中，这始终是读取大文件的最快方法。

**更新：**这是内存映射文件的旧但仍然准确的描述：http: [//msdn.microsoft.com/en-us/library/ms810613.aspx](http://msdn.microsoft.com/en-us/library/ms810613.aspx)

# sql - 我想将 3 个小数位值从 ASP.NET MVC 4 保存到 SQL Server 2005

> ID：16100026
> 
> 赞同：0
> 
> 时间：2013-04-19T08:02:27.433
> 
> 标签：sql, asp.net-mvc-4

我必须在 SQL Server 2005 中设置小数点后 3 位。我只能从模型部分设置它。但在 sql server 中设置的 Salary 数据类型是小数。

当我设置喜欢

```
public decimal Salary { get; set; } 
```

它想将数据库保存为 21000.000 而不是 21000。如果我输入 30000.75，那么它将保存到 30000.750。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:09:53.237

The easiest way to solve your problem is to set the `Salary` datatype to `decimal(18, 3)`. So even if you insert a value `30000.75123` only the first three decimal digits will be saved - `30000.750`. If you insert a whole number `21000` then the value in the database will be `21000.000`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:09:36.233

Even me faced this problem , one thing you can do with before sending to the database you will have to convert the value into 3 decimal places . you can do this by -

```
txtsalary.Text = String.Format("{0:0.000}", Salary); 
```

or

```
decimal Salary ;

if (Decimal.TryParse(txtsalary.Text, out Salary )) // Returns true on valid input, on top of converting your string to decimal.
{
    // ... code that is doing stuff with the decimal value ...

    txtsalary.Text = String.Format("{0:0.000}", Salary );
}
else
{
    // do your error handling here.
} 
```

# c# - WPF：画布吞噬 MouseDownEvent？

> ID：16100027
> 
> 赞同：2
> 
> 时间：2013-04-19T08:02:29.190
> 
> 标签：c#, wpf, canvas, scrollviewer, mousedown

谁能向我解释为什么在这个简单`MouseDown`的例子中事件没有达到？`ScrollViewer`

```
<Window x:Class="MouseDownTest.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <ScrollViewer Name="scrollViewer" Background="Green" MouseDown="ScrollViewer_MouseDown" PreviewMouseDown="ScrollViewer_PreviewMouseDown">
            <Canvas Name="canvas" Background="Beige" MouseDown="Canvas_MouseDown" PreviewMouseDown="Canvas_PreviewMouseDown">
            </Canvas>
        </ScrollViewer>
    </Grid>
</Window> 
```

后面的代码：

```
using System;
using System.Windows;
using System.Windows.Input;

namespace MouseDownTest
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            scrollViewer.AddHandler(MouseDownEvent, new RoutedEventHandler(ScrollViewer_Test));
        }

        private void ScrollViewer_Test(object sender, RoutedEventArgs routedEventArgs)
        {
            Console.WriteLine("ScrollViewer_Test");
        }

        private void Canvas_MouseDown(object sender, MouseButtonEventArgs e)
        {
            Console.WriteLine("Canvas_MouseDown");
        }

        private void Canvas_PreviewMouseDown(object sender, MouseButtonEventArgs e)
        {
            Console.WriteLine("Canvas_PreviewMouseDown");
        }

        private void ScrollViewer_MouseDown(object sender, MouseButtonEventArgs e)
        {
            Console.WriteLine("ScrollViewer_MouseDown");
        }

        private void ScrollViewer_PreviewMouseDown(object sender, MouseButtonEventArgs e)
        {
            Console.WriteLine("ScrollViewer_PreviewMouseDown");
        }
    }
} 
```

单击画布时的输出是

```
ScrollViewer_PreviewMouseDown
Canvas_PreviewMouseDown
Canvas_MouseDown 
```

为什么会`ScrollViewer_MouseDown`被省略？我已经查看了[这篇文章](http://warren.chinalle.com/2008/07/19/wpf-events-tunneling-and-bubbling/)，但那里给出的解决方案没有帮助（或者我做错了）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:27:50.960

您可能需要设置`Focusable="False"`允许`ScrollViewer`鼠标事件通过

```
 <ScrollViewer Name="scrollViewer" Focusable="False" Background="Green" /> 
```

**输出：**

```
ScrollViewer_PreviewMouseDown
Canvas_PreviewMouseDown
Canvas_MouseDown
ScrollViewer_MouseDown 
```

# ruby - Jekyll Asset Pipeline + YUI 压缩 JS 文件失败

> ID：16100028
> 
> 赞同：0
> 
> 时间：2013-04-19T08:02:32.187
> 
> 标签：ruby, yui, jekyll

我正在使用 Jekyll 和[Jekyll Asset Pipeline](https://github.com/matthodan/jekyll-asset-pipeline)构建站点，当我生成站点时出现以下错误：

```
Configuration from /home/liamzebedee/Documents/blog/_config.yml
Building site: /home/liamzebedee/Documents/blog -> /home/liamzebedee/Documents/blog/_site
Asset Pipeline: Processing 'css_asset_tag' manifest 'global'
Asset Pipeline: Saved 'global-209b6871f359105f20dc61685687e480.css' to '/home/liamzebedee/Documents/blog/_site/assets'
Asset Pipeline: Processing 'javascript_asset_tag' manifest 'global'
Asset Pipeline: Failed to compress 'global-31b4b6cd8ed5427ca98bb8f30ce0e75e.js' with 'JekyllAssetPipeline::JavaScriptCompressor'.
Liquid Exception: undefined method `exitstatus' for nil:NilClass in content
/var/lib/gems/1.9.1/gems/yui-compressor-0.9.6/lib/yui/compressor.rb:84:in `block in compress'
/var/lib/gems/1.9.1/gems/yui-compressor-0.9.6/lib/yui/compressor.rb:117:in `streamify'
/var/lib/gems/1.9.1/gems/yui-compressor-0.9.6/lib/yui/compressor.rb:66:in `compress' 
```

我真的不确定是什么原因造成的。这是我`compress.rb`使用 YUI 促进 JS 压缩的插件：

```
require 'jekyll_asset_pipeline'

module JekyllAssetPipeline
  class JavaScriptCompressor < JekyllAssetPipeline::Compressor
    require 'yui/compressor'

    def self.filetype
      '.js'
    end

    def compress
      return YUI::JavaScriptCompressor.new(munge: true).compress(@content)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T04:31:07.147

您的 compress 方法的参数中有错字，请在`new()`下面进行更正。

```
def compress
  return YUI::JavaScriptCompressor.new(:munge => true).compress(@content)
end 
```

我怀疑这是 jekyll-asset-pipeline 文档中的错误。

# python - 在python中删除列表中的重复项

> ID：16100033
> 
> 赞同：1
> 
> 时间：2013-04-19T08:02:44.887
> 
> 标签：python, list

假设我有一个清单

```
['a','man', 'and', 'a', 'woman'] 
```

如何删除重复的“a”，使其仅是：

```
['a','man', 'and', 'woman'] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T08:03:48.967

保持秩序：

```
>>> from collections import OrderedDict
>>> L = ['a','man', 'and', 'a', 'woman']
>>> list(OrderedDict.fromkeys(L))
['a', 'man', 'and', 'woman'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T08:05:14.113

如果顺序不重要，那么您可以这样做：

```
d = ['a', 'man', 'and', 'a', 'woman']
list(set(d)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:19:05.403

如果顺序很重要，类似于@jamylak 的建议是使用[这个](http://code.activestate.com/recipes/576694/) `OrderedSet`食谱。

```
list(OrderedSet(L)) 
```

# java - 如何解决 Java EE 不良实践：直接管理连接

> ID：16100034
> 
> 赞同：1
> 
> 时间：2013-04-19T08:02:46.310
> 
> 标签：java, jdbc, security, veracode

我将我的 Java 应用程序 EAR 提交给 Veracode 安全测试工具，并在以下代码中发现了 API 滥用 - 直接连接管理缺陷：

```
Connection con = DriverManager.getConnection (url, hsUserId, hsPassword); 
```

有人请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:27:52.163

您的错误消息非常清楚地说明了这一点：

> 连接缺陷的直接管理

所以在一个容器中，你永远不应该手动创建连接，而是让容器来做。

您说的是“J2EE”，还是指的是“Java EE”？（您应该添加相关标签！）

在第一种情况下，您必须进行 JNDI 查找：

```
InitialContext ctx = new InitialContext();
DataSource datasource = (DataSource) ctx.lookup("..");
Connection conn = datasource.getConnection(); 
```

在第二种情况下，您对其进行注释并让它注入：

```
@PersistenceContext
EntityManager em; 
```

# java - 中缀到后缀转换Java的括号错误检查

> ID：16100036
> 
> 赞同：1
> 
> 时间：2013-04-19T08:02:50.477
> 
> 标签：java, stack, infix-notation, postfix-notation

我一直在研究一个用于中缀到后缀转换的程序，并且一切正常，除了我无法弄清楚在哪里对丢失的左括号进行错误检查。基本上用户输入一个字符串，程序进入这个类并转换它，但我想确保他们输入了正确数量的括号。我尝试了多个地方，但不断提出 EmptyStackExceptions。

```
import java.util.*;

public class PostfixConversion {

   public static boolean precedence(char first, char second)
   {
      int v1 = 0, v2 = 0;
      //find value for first
      if(first == '-' || first == '+'){
         v1 = 1;
      }else if(first == '*' || first == '/'){
         v1 = 2;    
      }//end if

      //find value for second
      if(second == '-' || second == '+'){
         v2 = 1;
      }else if(second == '*' || second == '/'){
         v2 = 2;    
      }//end if

     if(v1 < v2){
        return false;
     }//end if

     return true;
  }//end precedence method

 //converts infix expression into postfix expression
 public static String convertToPostfix(String infixExp)
  {
     String postFix = "The Postfix Expression is: ";
     Stack<Character> stack = new Stack<Character>();
     char character = ' ';

     for(int i = 0; i < infixExp.length(); i++)
     {
         character = infixExp.charAt(i);

         //determine if character is an operator
         if(character == '*' || character == '-' || character == '/' || character == '+')
         {
             while(!stack.empty() && precedence(stack.peek(), character)){
                 postFix += stack.pop();
             }//end while
             stack.push(character);
         }
         else if(character == '(') //check for left parenthesis
         {
             stack.push(character);
         }
         else if (character == ')') 
         {
             while(!stack.peek().equals('(') && !stack.isEmpty()){ //add characters until left parenthesis
                 postFix += stack.pop();
             }//end while

             if(!stack.isEmpty() && stack.peek().equals('(')){
                 stack.pop(); // pop/remove left parenthesis
             }
         }
         else
         {
             postFix += character;
         }//end if
     }//end for
     while(!stack.empty()) //add the remaining elements of stack to postfix expression
     {
         if(stack.peek().equals('('))
         {
             postFix = "There is no matching right parenthesis.";
             return postFix;
         }
         postFix += stack.pop();
     }
         return postFix;
 }//end convertToPostfix
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:16:01.040

首先，您必须将`while`循环更改为这种形式：

```
while (!stack.empty() && precedence(stack.peek(), character)) {
    postFix += stack.pop();
} 
```

即更改检查中表达式的顺序`while`：`stack.empty()`检查应该是第一个。

第二个修复将在`"There is no matching left parenthesis."`此处添加错误消息：

```
if (!stack.isEmpty() && stack.peek().equals('(')) {
   stack.pop(); // pop/remove left parenthesis
} else {
   postFix = "There is no matching left parenthesis.";
   return postFix;
} 
```

# eclipse - 如何让 pkg-config 在 eclipse juno (Mac OS X) 中工作？

> ID：16100039
> 
> 赞同：0
> 
> 时间：2013-04-19T08:03:00.827
> 
> 标签：eclipse, macos, gtkmm, pkg-config

我尝试让 gtkmm 在 Eclipse 中运行。这是我的makefile（没有清理）：

```
all : main.cpp
@export PATH+=/opt/local/bin;
@echo PATH=$(PATH);

g++ -v `pkg-config gtkmm-2.4 --cflags` \
    -O0 -g3 -Wall -S \
    -o main.o main.cpp;
g++ -v -o main.exe main.o \
    `pkg-config gtkmm-2.4 \
    --libs` ; 
```

在控制台中我得到（在其他输出中）：

```
PATH=/usr/bin:/bin:/usr/sbin:/sbin
g++ -v `pkg-config gtkmm-2.4 --cflags` \
    -O0 -g3 -Wall -S \
    -o main.o main.cpp;
/bin/sh: pkg-config: command not found 
```

我做了：

```
ln -s /usr/bin/pkg-config /opt/local/bin/pkg-config 
```

当我输入

```
/usr/bin/pkg-config 
```

在终端中，我得到：

```
Must specify package names on the command line 
```

所以我假设 pkg-config 在“终端”中工作......但不是在 Eclipse 中。

我能做些什么？
谢谢！尼尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T09:03:06.797

我不知道究竟是什么解决了我的问题，因为现在它可以工作了。
我猜它是以下之一：

*   makefile 现在看起来像这样：

    ```
    all: main.cpp
        g++ -v `pkg-config gtkmm-2.4 --cflags`-O0 -g3 -Wall -c -o main.o main.cpp;
        g++ -v -o main.exe main.o `pkg-config gtkmm-2.4 --libs`
    clean:
        rm -f main.exe main.o 
    ```

*   我在 /bin 中有指向 pkg-config 的符号链接：

    ```
    sudo ln -s /opt/local/bin/pkg-config /bin/pkg-config 
    ```

*   我安装了 XQuartz

*   我更新了 MacPorts 和所有过时的端口：

    ```
    sudo port -v selfupdate
    sudo port upgrade outdated 
    ```

# vba - 解释移动平均线的 VBA 代码

> ID：16100043
> 
> 赞同：1
> 
> 时间：2013-04-19T08:03:17.593
> 
> 标签：vba, object, set, average

虽然我在写它的时候大致了解了我的编码，但我已经忘记了如何解释它的前几部分（粗体）。

1.  为什么“长”？我的理解是，当变量只取更大的整数值时使用它。由于份额值包含几个小数，我不知道为什么我选择这个而不是“双倍”。

2.  为什么/何时我们将变量调暗为“范围”，为什么我们要使用“设置”？我对 set 函数用途的有限理解是将值分配给“对象”变量。为什么“范围”是“对象”？

3.  我完全忘记了**Set stockValue = Range("B5:B" & lastStockprice) 行在**做什么，尤其是 & 符号。

4.  我不知道这里发生了什么：

**ReDim stockPrice(stockValue.Count - 1) For Each cell In stockValue stockPrice(cell.Row - 5) = cell.Value Next**

* * *

子移动平均（）

```
Dim CumulSum() As Double
Dim MovingAv() As Double

RowCountA = Range("StockPrice").Rows.Count
RowCountB = Range("MovingAv").Rows.Count

ReDim CumulSum(RowCountB)

Dim stockPrice As Variant
Dim lastStockprice **As Long**
    lastStockprice = Cells(Rows.Count, "B").End(xlUp).Row
Dim stockValue **As Range**
    **Set stockValue = Range("B5:B" & lastStockprice)**

**ReDim stockPrice(stockValue.Count - 1)
For Each cell In stockValue
stockPrice(cell.Row - 5) = cell.Value
Next**

    For i = 0 To RowCountB - 1
        For k = 0 To 9
            CumulSum(i) = CumulSum(i) + stockPrice(i + k)
        Next k
    Next i

    For i = 1 To RowCountB
        Range("MovingAv").Cells(i) = CumulSum(i - 1) / 10
    Next i 
```

结束子

* * *

如果有人可以为我解释粗体代码（我对 VBA 有非常基本的了解，可以扩展到矩阵乘法、基本函数和双数组），我将不胜感激。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:14:35.300

```
Dim lastStockprice **As Long**
lastStockprice = Cells(Rows.Count, "B").End(xlUp).Row 
```

这必须很长，因为我们试图找到 Col B 中的最后一行。这是为了使代码与 xl2007+ 兼容（*其中有 1048576 行*）。您可以查看有关如何获取最后一行的[链接。](https://stackoverflow.com/questions/11169445/error-finding-last-used-cell-in-vba)

* * *

```
Why is the 'range' an 'object'? 
```

请参阅此[链接](http://msdn.microsoft.com/en-us/library/office/aa223066%28v=office.11%29.aspx)。也看到[这个](http://msdn.microsoft.com/en-us/library/office/aa189754%28v=office.10%29.aspx)。

* * *

> 我完全忘记了 Set stockValue = Range("B5:B" & lastStockprice) 行在做什么，尤其是 & 符号。

如前所述，`lastStockprice`是最后一行，`&`用于连接，以便我们设置范围。假设最后一行是 20 那么上面的代码可以写成

```
Set stockValue = Range("B5:B" & 20)
'OR
Set stockValue = Range("B5:B20") 
```

* * *

> 我不知道这里发生了什么：ReDim stockPrice(stockValue.Count - 1)

代码试图做的是动态增加数组的大小，以便它可以存储更多的值。`REDIM (Re-Dimension)`我建议查看此[链接](http://www.cpearson.com/excel/vbaarrays.htm)

* * *

**跟进（来自评论）**

> 除了这一部分，我现在了解所有内容： For Each cell In stockValue stockPrice(cell.Row - 5) = cell.Value Next**

那段代码正在做的是遍历范围内的每个单元格，`stockvalue`然后将单元格值存储在数组中`stockPrice`

**例如**：假设我们有一个范围，`A1:B2`

当我们说时`For each cell in Range("A1:B2")`，我们是在告诉代码循环遍历该范围内的每个单元格（`A1`, `A2`, `B1`, `B2`）

# c - Resetting gcc's asm inline input

> ID：16100044
> 
> 赞同：2
> 
> 时间：2013-04-19T08:03:19.743
> 
> 标签：c, gcc, assembly, inline-assembly

How to ask gcc to reset an asm inline input value? `%0` in the following example is not reset to `42` after the first loop. So when i = 1, `%0` value is still `0`.

```
for (int i = 0; i < N; ++i)
  asm("label: substract_immediate_value %0,%0,1;"
      "compare_immediate_value %0,0;"
      "branch_not_equal label"
      : /* no outputs */
      : /* input */ "r" (42)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:20:27.190

I've not tried this, but it looks right:

```
for (int i = 0; i < N; ++i)
  {
    int n = 42;
    asm("label: substract_immediate_value %0,%0,1;"
        "compare_immediate_value %0,0;"
        "branch_not_equal label"
        :  "+r" (n));
  } 
```

I presume this is a simplified example, because I can't imagine why you wouldn't just code that in C. Indeed, it's a no-op.

# svg - 使用贝塞尔曲线或椭圆路径以编程方式绘制椭圆的一部分 - SVG 和 raphael.js

> ID：16100048
> 
> 赞同：2
> 
> 时间：2013-04-19T08:03:34.350
> 
> 标签：svg, raphael, bezier, ellipse, elliptic-curve

我正在尝试围绕具有给定边距的椭圆绘制贝塞尔曲线：

![围绕椭圆的贝塞尔路径](https://i.stack.imgur.com/wFRyq.png)

我想以编程方式实现这一点，所以如果我改变椭圆大小，曲线会跟随它。

目前我已经做了这个功能：

```
function bezierPathTopRounded(ellipse, margin) {
    var box = ellipse.paper.getBBox();

    var leftX = box.x - margin; 

    var rightX = box.x + margin + box.width;

    var y = box.y + box.height/2 - margin; 

    var p = "M "+ leftX  + ", "+ y
    + " C " //could be relative too
    + ( box.x - margin + (box.width/15)  )  + ", " + ( box.y + margin - (box.height/4.5)  ) + " "
    + ( box.x + margin + box.width - (box.width/15)  )  + ", " + ( box.y + margin - (box.height/4.5) ) + " "
    + rightX +", " + y;

    return p;   
} 
```

但我不知道如何计算这个方向点值，以便它适用于任何椭圆：

*   box.width/15
*   盒子高度/4.5

[这个例子](http://jsfiddle.net/kNVHA/)有一个小提琴。

我已经阅读了这个[stackoverflow问题](https://stackoverflow.com/questions/14169234/the-relation-of-the-bezier-curve-and-ellipse)，并在我的示例中尝试了相同的方法，但仍然无法找到一个简单的解决方案，它仍然是随机的......

**编辑**

现在我正在尝试使用椭圆`A`rc，结果比使用 Bezier Path 更糟糕：

![椭圆弧测试](https://i.stack.imgur.com/iNdoh.png)

有我正在使用的功能。如果我删除边距，它会完全按照我的椭圆...最后问题是我如何才能按照椭圆的边距？

```
function borderPath(ellipse, margin, flag) {
    var flag = flag == undefined ? 1 : 0;

    var box = ellipse.paper.getBBox();

    var leftX = box.x - margin;

    var rightX = box.x + margin + box.width;

    var y = box.y + box.height/2;
    y += (flag == 1) ? -margin : margin;

    var rx = box.width/2 + margin;
    var ry = box.height/2;

    var p = "M "+ leftX + ", "+ y
    + " A "
    + rx + " " + ry
    + " 0 0 "+ flag +" "
    + rightX +", " + y;

    return p;
} 
```

在此处查看[更新的小提琴](http://jsfiddle.net/kNVHA/2/)。

对于可怕的颜色真的很抱歉，这些是例如目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:07:32.197

如果你想用贝塞尔曲线做到这一点，你必须决定你希望它看起来有多“错误”。贝塞尔曲线不能表示圆形（并且通过扩展，椭圆形）曲线，它们只能非常接近，就像多边形一样，只是使用更少的部分来获得更高的精度。

我在我的贝塞尔曲线入门中分别使用贝塞尔曲线描述了圆近似和曲线偏移， http: [//pomax.github.io/bezierinfo/#circles_cubic](http://pomax.github.io/bezierinfo/#circles_cubic)和[http://pomax.github.io/bezierinfo/#offsetting](http://pomax.github.io/bezierinfo/#offsetting)，但是，如果您是从头开始编写代码，特别是如果您只需要在示例中描述的内容，那么偏移将是多余的。

相反，我建议启动 Inkscape 或 Illustrator，打开网格叠加，并在椭圆周围绘制贝塞尔曲线。让它看起来不错，然后检查坐标是什么，并将其用作在画布程序中实现的足够可靠的信息。您可能不需要在数学上严格正确，只要人们不去“看起来不对”，您就应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-26T07:59:49.163

我已经设法根据椭圆及其边距制作椭圆弧。比我简单地用矩形隐藏我不想要的部分。

这是功能：

```
function borderPath(ellipse, flag) {
    var flag = flag == undefined ? 1 : flag;

    var box = ellipse.paper.getBBox();

    var leftX = box.x;

    var rightX = box.x + box.width;

    var y = box.y + box.height/2;

    var rx = box.width/2;
    var ry = box.height/2;

    var p = "M "+ leftX + ", "+ y
    + " A "
    + rx + " " + ry
    + " 0 0 "+ flag +" "
    + rightX +", " + y;

    return p;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T07:59:08.307

使用贝塞尔曲线绘制椭圆路径可能会让您头疼。正如您在评论中所说，您正在使用与 RaphaelJS 配合良好的路径弧。

可以在[http://www.svgbasics.com/arcs.html](http://www.svgbasics.com/arcs.html)找到有关它所期望的所有值的文档，尤其是标志。

# doctrine-orm - 如何将 zend_form 刷新到多个实体

> ID：16100054
> 
> 赞同：0
> 
> 时间：2013-04-19T08:04:13.313
> 
> 标签：doctrine-orm, associations, zend-framework2, entities, flush

我正在努力将我的**zend_form 刷新**为 2 个实体。我总共有 3 个实体。用户、地址和国家。Country 并不有趣，因为它具有只有 ID 进入 Address 的标准值。我的添加操作效果很好（仅当我将地址/国家/地区保留为空时，它会在数据库中添加一条新记录，因此我必须解决此问题）。但是我的编辑只刷新了我最新的绑定。我的编辑动作：

```
/**
     * Edit action for single user
     * 
     * @return route zfcadmin/user/add
     * @return route zfcadmin/user
     * @return array(id, form, flashMessages)
*/
public function editAction()
{
    $id = (int)$this->getEvent()->getRouteMatch()->getParam('id');
    if (!$id) {
        return $this->redirect()->toRoute('zfcadmin/user/', array('action' => 'add'));
    }
    //Get user with the id (given in URL), and pick his address(es)
    $user = $this->getEntityManager()->find('User\Entity\User', $id);
    $addresses = $user->addresses;

    $form = new UserForm();

    //Set country values out of the entity
    $form = $this->fillCountrySelectbox($form);
    $form->bind($user);

    //Get addresses from the user, and bind it to the $form
    foreach($addresses as $address) {
        //If user has address, bind the addresses
        if(isset($address)) {
            $form->bind($address);
        }
    }

    $form->get('save_goback')->setAttribute('value', 'Save');
    $form->get('save')->setAttribute('value', 'Save & Stay');

    $request = $this->getRequest();
    if ($request->isPost()) {
        //Set the inputfilter on the input values
        $inputFilter = new InputFilter();

        //Set filters from different entities
        $inputFilter = $user->setFilters($inputFilter);
        $inputFilter = $address->setFilters($inputFilter);

        //Set the inputFilter on the form
        $form->setInputFilter($inputFilter);

        $form->setData($request->getPost());
        if ($form->isValid()) {
            $form->bindValues();

            //set complete country object in address entity.
            $country = $this->getEntityManager()->find('User\Entity\Country', $form->get('country')->getValue());
            $address->__set('country', $country);

            //Set country Null when no country was selected, otherwise it conflict with country entity (because no '' is set)
            if($address->country == '') {
                $address->country = NULL;
            }

            //Set modifier (current user)
            $address->__set('last_modifier_id', $this->zfcUserAuthentication()->getIdentity()->getId());

            $this->flashMessenger()->addMessage('User saved');

            $this->getEntityManager()->flush();

            if ($this->getRequest()->getPost('save_goback')) {
                return $this->redirect()->toRoute('zfcadmin/user');
            }
        }
    }

    return array(
        'id' => $id,
        'form' => $form,
        'flashMessages' => $this->flashMessenger()->getMessages()
    );
} 
```

当我不绑定地址时，它将刷新到用户实体，当我绑定地址时，它仅刷新到地址，因此我对用户的编辑将不起作用。如何通过保存用户和地址来编辑我的表单？

# jsf-2 - 如何从 JSF Web 应用程序有效地编辑多个数据库条目？

> ID：16100056
> 
> 赞同：1
> 
> 时间：2013-04-19T08:04:20.063
> 
> 标签：jsf-2, primefaces, java-ee-6

我有几个数据库表，用户应该能够从 Web 应用程序中添加、编辑和删除条目。此外，输入必须在持久化之前进行验证。

现在我可以简单地制作一个表格并将带标签的输入字段放在那里，但结果将远非 DRY 并且难以维护。复合组件使这更好一点。有没有我看不到的替代方法可以减少很多工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:39:58.833

如果我没有误解这个问题，您可能想要研究的一个概念是通用/生成的 CRUD。

Netbeans 有一个 primefaces CRUD 生成器[链接](http://sourceforge.net/projects/nbpfcrudgen/)

# android - 查看重力不工作

> ID：16100058
> 
> 赞同：0
> 
> 时间：2013-04-19T08:04:25.870
> 
> 标签：android

我覆盖了一个线性布局。布局包含一个按钮。按钮应该在线性布局的右上角。但重力似乎不起作用。

代码：在我的服务的 onCreate 方法中。

```
 final WindowManager.LayoutParams params3 = new WindowManager.LayoutParams(
           WindowManager.LayoutParams.TYPE_SYSTEM_ALERT,
           WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL  |   WindowManager.LayoutParams.FLAG_WATCH_OUTSIDE_TOUCH |              WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE,
            PixelFormat.TRANSLUCENT);

   LinearLayout ll=new LinearLayout(this);
   LinearLayout ll2=new LinearLayout(this);
   LinearLayout.LayoutParams lp=new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT,LinearLayout.LayoutParams.WRAP_CONTENT);
   lp.gravity=Gravity.RIGHT;
   lp.width=30;
   lp.height=30;

   b=new Button(this);
   b.setBackgroundResource(R.drawable.x);
   params3.gravity=Gravity.TOP;
   params3.height=200;
   params3.width=200;

   ll.addView(b, lp);
   wm.addView(ll, params3); 
```

线性布局 200X200 已创建并位于顶部。但按钮不在右上角。我尝试使用 b.setWidth 和 b.setHeight。不会有帮助的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:18:51.187

LinearLayout 默认是水平的 你不能在水平LinearLayout 中水平对齐（例如right、center_horizo​​ntal、left），你不能在垂直LinearLayout 中垂直对齐（例如top center_vertical、bottom）。

如果需要将其向右对齐，则必须将 LinearLayout 设置为垂直或使用不同的 ViewGroup，例如 FrameLayout。

```
LinearLayout ll = new LinearLayout(this);
ll.setOrientation(LinarLayout.VERTICAL); 
```

Ant the Buttom 将始终位于首位，因为它是第一项。为什么不在 xml 中做呢？更少的代码会容易得多。

编辑：要将按钮放在 VideoView 的右上角，您的布局将如下所示。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <VideoView
        android:id="@+id/videoView1"
        android:layout_width="200dp"
        android:layout_height="200dp" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="10dp"
        android:layout_marginRight="10dp"
        android:layout_alignTop="@+id/videoView1"
        android:layout_alignRight="@+id/videoView1"
        android:text="Button" />

</RelativeLayout> 
```

将此布局放在项目的布局 res 文件夹中。项目/res/layout/your_layout.xml

要将布局附加到 Activity 的窗口：

```
public final class YourActivity
        extends Activity
{
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.your_layout);

        // Get VideoView
        VideoView vv = (VideoView) findViewById(R.id.videoView1);

        //get Button reference
        View button = findViewById(R.id.button1);
    }
} 
```

# jquery - 无法理解此功能的工作原理

> ID：16100061
> 
> 赞同：-2
> 
> 时间：2013-04-19T08:04:41.863
> 
> 标签：jquery

检查天气元素是否存在我正在使用

```
 if($('#id').length)
       //statement 1
   else
      //statement 2 
```

它对我来说很好。但是 statement1 将在条件为真时执行，否则 statement2 将执行。但是当长度返回长度时它是如何工作的（它是一个像 1 , 2 ... 的数字）

我想如果长度为 0，那么它`false`就是`0`. 但是剩下的病例呢。我无法理解这里发生了什么。提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:06:28.437

如果来自[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/if...else)：

> 任何非 undefined、null、0、NaN 或空字符串 ("") 的值，以及任何对象，包括值为 false 的布尔对象，在传递给条件语句时计算结果为 true

这意味着当长度为`1`（或更大，但此选择器不会发生）时，它的计算结果为 true。

`id`因此，当找到具有 id 的元素时，将`statement 1`执行 。当长度为 时`0`，则`statement 2`执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T08:08:51.543

Here's some output from the chrome console, that might help you:

```
> Boolean(1) //The number 1
true

> Boolean(0) //The number 0
false

> Boolean(0.0000000000000000000000000000000000000000001) //A very close to 0 float
true

> Boolean(0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001) //This is where it starts rounding down to zero
false

> Boolean(false) //A boolean "false"
false

> Boolean(NaN) //Not a number
false

> Boolean(undefined) //Undefined
false

> Boolean("") //An empty string
false

> Boolean(-3) //A negative number
true

> Boolean("string") //A string that is not empty
true

> Boolean([]) //An empty array
true

> Boolean({}) //An empty object
true

> Boolean(2.5) //A float
true 
```

..hence, if length is 0 (as in; the element could not be found) then it does not evaluate to `true` and therefore chooses the `} else {` statement instead.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:07:07.823

Javascript 有一个[真/](http://www.sitepoint.com/javascript-truthy-falsy/)假的概念，其中像`0`, false`undefined`和`null`等值被认为是假的，而其他值被认为是真值。

如果长度为`0`假，则条件失败，否则如果长度！= 0，则认为该值为真，条件成功。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-19T08:08:01.633

是的，这就是javascript的工作方式

这里有一个解释

[在 JavaScript 中，为什么 "0" 等于 false，但是当通过 'if' 测试时，它本身不是 false？](https://stackoverflow.com/questions/7615214/in-javascript-why-is-0-equal-to-false-but-not-false-by-itself)

# android - 如何通过 Androguard 跟踪局部变量

> ID：16100063
> 
> 赞同：0
> 
> 时间：2013-04-19T08:04:50.363
> 
> 标签：android, security, static-analysis, androguard

我想跟踪所有 Intent 对象，但找不到 API。

我想知道一个组件在应用程序中从哪里开始另一个组件。此外，我想知道它是如何发生的，例如 Intent 是显式 Intent 还是具有 Data。

比如一个activity可以通过一个叫startActivity(Intent i)的方法来启动，我想知道“i”的详细信息，所以我需要定位它。

有人可以给我一些帮助吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T11:52:51.813

```
#!/usr/bin/env python

import sys,string
from androguard.core.bytecodes.dvm import DalvikVMFormat
from androguard.core.bytecodes.apk import APK
from androguard.core.analysis.analysis import uVMAnalysis
from androguard.core.analysis.ganalysis import GVMAnalysis

def join_names(items):
    arr = []
    for item in items:
        arr.append(item[0].class_name+"->"+item[0].name)
    return string.join(arr, ", ")

if len(sys.argv) > 2:
    filename = sys.argv[1]
    method_name = sys.argv[2]
    d = DalvikVMFormat(APK(filename, False).get_dex())
    d.create_python_export()
    dx = uVMAnalysis(d)
    gx = GVMAnalysis(dx, None)
    d.set_vmanalysis(dx)
    d.set_gvmanalysis(gx)
    d.create_xref()
    for m in d.get_methods():
        if m.name == method_name:
            print (m.class_name + "->" + m.name + " ----------------- XREFfrom: [" + join_names(m.XREFfrom.items) + "] XREFto: [" + join_names(m.XREFto.items) + "]") 
```

像这样运行它：

android@honeynet:~/tools/androguard$ ./xref.py your_apk.apk startActivity

# javascript - 使用 Knockout.JS 构建分页控件

> ID：16100068
> 
> 赞同：2
> 
> 时间：2013-04-19T08:05:31.123
> 
> 标签：javascript, knockout.js

我继承了一个使用 Knockout.JS 呈现帖子列表的项目。客户要求对这个列表进行分页，我想知道使用 Knockout.JS 是否可行且合适。我可以在纯 JavaScript 中轻松实现这一点，但我想使用 Knockout（如果合适的话）来保持一致性。

据我所知，该页面在页面的 HTML 中使用了本*机模板*。有一个 ViweModel 将帖子存储在一个`ko.ObservableArray()`和一个帖子模型中。

数据通过 jQuery ajax 调用加载，其中返回的 JSON 映射到后模型对象，然后传递到负责数据绑定的 ObservableArray。

是否可以修改 ViewModel 以绑定分页链接（在需要时包括“上一个”和“下一个”链接）或者我最好用纯 JS 编写它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:24:06.940

在淘汰赛中构建一个计算出的 observable 应该很容易，它显示了完整页面列表的“窗口”。例如添加到视图模型：

```
this.pageIndex = ko.observable(1);
this.pagedList = ko.computed(function() {
   var startIndex = (this.pageIndex()-1) * PAGE_SIZE;
   var endIndex = startIndex + PAGE_SIZE;
   return this.fullList().slice(startIndex, endIndex);
}, this); 
```

然后将显示记录的“foreach”绑定绑定到*pagedList*而不是完整列表，并且在前向和后向链接中，只需更改*pageIndex的值*的值。从那里开始，您应该能够使其更健壮/提供更多功能。

此外，这假设您无论如何都将所有数据预加载到客户端。也可以对上一个和下一个链接进行 JSON 调用，并使用返回的项目更新模型。“next”函数（要添加到视图模型原型中）可能如下所示：

```
ViewModel.prototype.next = function() {
   var self = this;
   this.pageIndex(this.pageIndex()+1);
   $.ajax("dataurl/page/" + this.pageIndex(), {
       success: function(data) {
          self.dataList(data);
       }
   });
} 
```

（为简洁起见，使用 jQuery 语法进行 ajax 调用，但任何方法都可以）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:27:14.340

在 KO 中编写特性总是倾向于生成更少的代码和更清晰的代码，而不是在“plain JS”、jQuery 或类似中编写相同的代码。所以去吧！

我用这样的分页实现了一个组合框

[https://github.com/AndersMalmgren/Knockout.Combobox/blob/master/src/knockout.combobox.js#L229](https://github.com/AndersMalmgren/Knockout.Combobox/blob/master/src/knockout.combobox.js#L229)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T08:27:35.223

在我的博客文章中，我已经非常详细地解释了如何做到这一点。你可以找到它（在这里[。http://contractnamespace.blogspot.com/2014/02/pagination-with-knockout-jquery.html](http://contractnamespace.blogspot.com/2014/02/pagination-with-knockout-jquery.html)）。它很容易实现，您可以使用一个简单的 JQuery 插件来实现。

基本上，我使用 AJAX 的普通敲除数据绑定，从服务器检索数据后，我调用插件。你可以在这里找到插件。它称为[简单分页](http://th3silverlining.com/2010/04/15/pajination-a-jquery-pagination-plugin/)。

# c++ - 将 unsigned char* 转换为 const unsigned char* 后删除 []

> ID：16100069
> 
> 赞同：8
> 
> 时间：2013-04-19T08:05:31.933
> 
> 标签：c++

粗略地说，我有一个包含 const unsigned char 数组的类。此类的对象由一个特殊的工厂函数创建，该函数还负责构造数组（在堆上）。在工厂函数中创建对象时，将为其提供指向数组的指针。数组不会被复制，对象只会使用给定的指针。在销毁时，它将释放数组占用的内存块。

```
class Foo
{
private:
    const unsigned char* array;
    size_t size;

public:
    Foo(const unsigned char* array, size_t size) : array(array), size(size) {}
    ~Foo() {delete [] array;}
};

Foo* factoryFunction(const void* data, size_t size)
{
    unsigned char* array = new unsigned char[size];
    memcpy(array, data, size);
    return new Foo(array, size);
} 
```

现在我想知道是否有任何副作用，因为`new []`返回`unsigned char *`，但`delete []`被要求`const unsigned char *`。我没有得到任何分段错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T08:27:19.653

这很好，标准中的非规范性文本暗示了同样的事情：

> `[C++11: 5.3.5/2]:`如果操作数具有类类型，则通过调用上述转换函数将操作数转换为指针类型，并在本节的其余部分中使用转换后的操作数代替原始操作数。在第一种选择（*delete object*）中，操作数的值可以是空指针值，指向由先前的*new-expression*`delete`创建的非数组对象的指针，或指向表示基的子对象（1.8）的指针此类对象的类别（第 10 条）。如果不是，则行为未定义。**在第二种选择（*****删除数组*****）中，操作数的值****可以是空指针值或由前一个数组*****new-expression*****产生的指针值。******`delete`*****如果不是，则行为未定义。*[注意：*这意味着*delete-expression*的语法必须与分配的对象的类型匹配`new`，而不是*new-expression*的语法。*—end note ]* ***[ 注意：*指向 const 类型的指针可以是*delete-expression*的操作数；*在将指针表达式用作delete-expression*的操作数之前，没有必要抛弃它的 constness (5.2.11) 。*——尾注]******

 *** * *

以下段落可能存在争议：

> `[C++11: 5.3.5/3]:`在第一种选择（*删除对象*）中，如果要删除的对象的静态类型与其动态类型不同，则静态类型应为要删除的对象的动态类型的基类，静态类型应具有虚拟析构函数或行为未定义。**在第二种选择（*删除数组*）中，如果要删除的对象的动态类型与其静态类型不同，则行为未定义。**

虽然在我看来，这一段的意图*只是*处理多态性，但结合以下段落，它可能被解释为，*严格来说*，您的代码实际上调用了未定义的行为：

> `[C++11: 3.9.3/1]:` *[..]*类型的 cv 限定或 cv 非限定版本是不同的类型；*[..]*

但是，我有理由相信这可以被视为标准中的措辞缺陷；我的意图似乎很清楚。

* * *

同样，这条规则甚至可能暗示程序不会编译：

> `[C++11: 12.5.4]:` *[..]*如果删除表达式以一元运算符开头`::`，则在全局范围内查找释放函数的名称。否则，如果*删除表达式*用于释放静态类型具有虚拟析构函数的类对象，则释放函数是在定义动态类型的虚拟析构函数时选择的函数（12.4）。否则，如果*delete-expression*用于释放类`T`或数组的对象**，则对象的静态和动态类型应相同**并且在 T 的范围内查找释放函数的名称。如果此查找未能找到该名称，则在全局范围内查找该名称。如果查找的结果不明确或不可访问，或者如果查找选择了一个放置解除分配函数，则程序是非良构的。

但同样，这不是规则的意图，它解决了在没有虚拟析构函数的情况下的多态性，以及跨多个类声明的真正歧义。

* * *

总而言之，在解释这些规则的措辞时，您最好的选择仍然是我们开始使用的非规范但非常清晰的注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:13:20.907

应该没有任何问题，因为“unsigned char”（或任何数据类型）上的“const”-ness 使其成为只读数据。

在 delete 中使用“[]”表示必须删除一个数组。

要了解“删除”与“删除 []”背后的含义，请阅读[此](http://web.archive.org/web/20080703153358/http://taossa.com/index.php/2007/01/03/attacking-delete-and-delete-in-c)内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T09:01:46.920

首先，您应该避免在 c++ 中使用这种类型的数组，`std::vector<unsigned char>`而应该使用这种数组。

关于`const`关键字。它只是告诉编译器和读取代码的人不应更改此成员/变量/参数。

使用指针，`const`关键字的位置很重要：

（**编辑**：找到[Greyson](https://stackoverflow.com/a/8091846/1960455)的答案，我借用了这部分）关键字
将`const`其左侧的部分标记为常量（如果它在开头，则它是在它之后的类型`const unsigned char`并且`unsigned char const`相等）

要将指针标记为 const，请执行以下操作（内容仍然可以更改）：

```
unsigned char * const aConstantPointerToAMutableContent; 
```

要将内容标记为 const，您将执行以下操作：

```
const unsigned char * aPointerToAConstantContentA;
unsigned char const * aPointerToAConstantContentB; 
```

要将两者都标记为常量：

```
const unsigned char * const aConstantPointerToAConstantContent; 
```

它是对编译器和用户的提示，以便清楚地知道对数据做了什么或不做什么。如果参数是，`const unsigned char *` 那么用户将知道如果传递该内容，则不会更改此内容。

因为`const`关键字只是一个标记，如果某些东西是可变的，它对大小本身没有影响，所以`delete`它不应该有影响。[（请参阅轨道中的 Lightness Races 的](https://stackoverflow.com/a/16100415/1960455)答案和评论以及“ [const_cast 安全吗？](https://stackoverflow.com/questions/357600/is-const-cast-safe) ”可能是为了兴趣）。

但是我不喜欢你的代码是构造函数是公共的。我可以直接调用它，但是因为参数是`const unsigned char* array`我不希望该类会更改内容或在销毁时将其删除。（我不希望直接创建对象会以与使用工厂不同的方式表现。）

所以我会将工厂方法作为`static`类的方法并制作构造函数`protected`。**

# java - 是JDK的bug吗？

> ID：16100082
> 
> 赞同：0
> 
> 时间：2013-04-19T08:06:45.993
> 
> 标签：java, runtime-error, indexoutofboundsexception

此代码抛出

> 线程“主”java.lang.ArrayIndexOutOfBoundsException 中的异常：1

在最后一行。是bug还是什么？(JDK 7)

```
int ar[] = {1,2,3};
List arList = Arrays.asList(ar);
arList.set(1,8); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T08:07:21.333

不，`Arrays.asList`期望`Integer []`，但你正在通过`int[]`。这应该解决它。

```
Integer ar[] = {1,2,3}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:17:53.257

这就是我的检查所说的关于使用需要 var-arg 类型的原始数组的内容。

> 报告对可变参数方法的任何调用，该方法在可变参数位置（例如`System.out.printf("%s", new int[]{1, 2, 3})`）中有一个原始数组。这样的原始数组参数可能会令人困惑，因为它将包装为单个元素数组，而不是像预期的那样将每个单独的元素装箱。

这意味着您拥有的是一个只有一个元素的列表。而这个元素就是你的`int[]`.

而且您无法访问`1`此列表中的位置，因为只有一个元素。从而`arList.set(1,8);`会抛出`ArrayIndexOutOfBoundsException`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:18:35.567

为了避免这种错误，永远不要使用原始类型，而是更喜欢泛型类型。你想要一个`List`整数？

尝试这个：

```
int ar[] = {1,2,3};
List<Integer> arList = Arrays.asList(ar); // here
arList.set(1,8); 
```

编译器会在我写注释的那一行显示一个错误，表示这行不通。When`ar`是一个原始数组，`int[]`在您的情况下，然后`Arrays.asList(ar)`将返回一个`List<int[]>`. `List<int[]>`并且`List<Integer>`不兼容。您现在拥有的是一个带有 1 个条目（在索引 0 处）的 of，作为您的数组`List`。`int[]`

如前所述，如果您从原始更改`int ar[] = {1,2,3};`为对象`Integer ar[] = {1,2,3};`，它将起作用，因为返回类型`Arrays.asList(ar)`将为`List<Integer>`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T08:17:30.643

Source [asList](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#asList%28T...%29) : 和 [Collection 不支持原始类型](https://stackoverflow.com/questions/2721546/why-dont-generics-support-primitive-types)

`Arrays.asList`只期望引用类型，就像在你的情况下它应该是 Integer 而不是`int`。

因此，您可以编写如下代码：

```
Integer ar[] = {1,2,3};
List<Integer> arList = Arrays.asList(ar);
arList.set(1,8); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T08:35:58.300

指定行为的原因很清楚，但是 Arrays.asList() 的 javadoc 中没有关于这种情况的任何内容，并且没有检查原始数组作为输入参数。所以，我认为这应该被视为一个错误。

方法javadoc：

返回由指定数组支持的固定大小的列表。（更改返回的列表“直写”到数组。）此方法充当基于数组和基于集合的 API 之间的桥梁，与 {@link Collection#toArray} 结合使用。返回的列表是可序列化的并实现了 {@link RandomAccess}。

此方法还提供了一种方便的方法来创建一个固定大小的列表，该列表已初始化为包含多个元素

# android - 从设备发送多部分 SMS 转换为 MMS

> ID：16100086
> 
> 赞同：2
> 
> 时间：2013-04-19T08:07:02.497
> 
> 标签：android, sms, multipart, samsung-mobile

在查看网站后，我无法找到任何解决此问题的方法。让我再解释一下：

我正在尝试从应用程序（以编程方式）发送多部分短信。它实际上可以在我的设备（Nexus 4）上运行，但我在 Galaxy Note 上进行了尝试，它将任何长尺寸的 SMS 转换为 MMS，并且该应用程序只发送短 SMS。有什么线索吗？三星 API 或其他东西是否会阻止执行 sendMultipartTextMessage() 方法？

在我的发送函数中，我有日志调试，它显示在屏幕上，所以对这个函数的调用做得很好..

谢谢你的帮助！

这是我使用的代码：

```
public static void sendSMS(final Activity a, String phoneNumber, String message)
{        
    try {
        SmsManager sms = SmsManager.getDefault();
        ArrayList<String> parts = sms.divideMessage(message); 

        ArrayList<PendingIntent> sendIntents = new ArrayList<PendingIntent>(parts.size());
        for (int i = 0; i < sendIntents.size(); i++)
        {
            Intent sendInt = new Intent("");
            PendingIntent sendResult = PendingIntent.getBroadcast(a.getApplicationContext(), 0, sendInt, PendingIntent.FLAG_ONE_SHOT);
            sendIntents.add(sendResult);
        }

        sms.sendMultipartTextMessage(phoneNumber, null, parts, null, null);
        ContentValues values = new ContentValues();

        values.put("address", phoneNumber);
        values.put("body", message); 

        a.getApplicationContext().getContentResolver().insert(Uri.parse("content://sms/sent"), values);
    } catch(Exception e) {
        e.printStackTrace(System.out);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:59:36.320

```
 public void sendSMS(String phoneNumber, String longMessage) {
    try {

        SmsManager sms = SmsManager.getDefault();
        ArrayList<String> parts = sms.divideMessage(longMessage);
        sms.sendMultipartTextMessage(phoneNumber, null, parts, null, null);

    } catch (Exception ex) {
        ex.printStackTrace();
    }
   } 
```

还添加此权限：

```
<uses-permission android:name="android.permission.SEND_SMS"/> 
```

以上代码适用于 Samsung Galaxy Note 2 (Android 4.1.1)、Micromax HD Canvas (Android 4.1.1)、Samsung Galaxy S3 (Android 4.1.1)、HTC One X (Android 4.0)。

所以这个功能在三星手机上对我来说不是阻塞的。

# c++ - 如何将 float * 中的图像值转换为 cvFindStereoCorrespondenceBM 可以处理的格式

> ID：16100089
> 
> 赞同：0
> 
> 时间：2013-04-19T08:07:10.153
> 
> 标签：c++, opencv

我从 2 个摄像头获得了灰度值，它们存储在 2 个单独的 float * 中（值在 range(0, 1) 内）。

在互联网上搜索后，我发现函数'cvFindStereoCorrespondenceBM'可以根据'左'和'右'视图生成深度。我的问题是如何将这 2 个 float * 图像转换为 cvFindStereoCorrespondenceBM 可以处理的格式，例如 IplImage 或其他。

我发现 cvFindStereoCorrespondenceBM 的前 2 个参数在 CvArr *.

谢谢

# c - 我们如何知道调用者函数的名称？

> ID：16100090
> 
> 赞同：36
> 
> 时间：2013-04-19T08:07:11.783
> 
> 标签：c

在C语言中，`__FUNCTION__`可以用来获取***当前***函数的名字。但是如果我定义了一个名为 a() 的函数并在 b() 中调用它，如下所示：

```
b()
{
    a();
} 
```

现在，在源代码中，有很多像 b() 这样调用 a() 的函数，例如 c()、d()、e()...

是否可以在 a() 中添加一些代码来检测调用 a() 的函数的名称？

**更远：**

1.  对不起，误导性的错字。我已经纠正了。
2.  我试图找出哪个函数调用 a() 以进行调试。不知道你遇到同样的情况怎么办？
3.  而且我的代码在vxWorks下，但我不确定它是否与C99或其他东西有关。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-19T08:18:05.387

没有什么你只能在a中做的。

但是，通过一个简单的标准宏技巧，您可以实现您想要的，IIUC 显示调用者的姓名。

```
void a()
{
    /* Your code */
}

void a_special( char const * caller_name )
{
    printf( "a was called from %s", caller_name );
    a();
}

#define a() a_special(__func__)

void b()
{
    a();
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2018-08-07T09:55:39.060

您可以使用内置的 gcc 来完成。

> [`void * __builtin_return_address(int level)`](http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html)

以下方式应打印函数 a() 的直接调用者。

例子：

```
a() {
    printf ("Caller name: %pS\n", __builtin_return_address(0));
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-19T08:22:11.897

如果您使用的是 Linux 系统，则可以使用该`backtrace()`功能。

有关更多详细信息和代码示例，请参见[手册页](http://man7.org/linux/man-pages/man3/backtrace.3.html)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-04-19T08:15:52.147

试试这个：

```
void a(<all param declarations to a()>);

#ifdef DEBUG
#  define a(<all params to a()>) a_debug(<all params a()>, __FUNCTION__)
void a_debug(<all params to a()>, const char * calledby);
#endif

void b(void)
{
  a(<all values to a()>);
}

#ifdef DEBUG
#  undef a
#endif

void a(<all param declarations to a()>)
{
  printf("'%s' called\n", __FUNCTION__);
}

#ifdef DEBUG
void a_debug(<all param declarations to a()>, const char * calledby)
{
  printf("'%s' calledby '%s'", __FUNCTION__, calledby);
  a(<all params to a()>);
}
#endif 
```

如果例如`<all param declarations to a()>`是`int i, double d, void * p`然后`<all params to a()>`是`i, d, p`。

* * *

或者（不那么邪恶 ;->> - 但更多的代码修改，因为每次调用 a() 都需要被触及）：

```
void a((<all params of normal a()>    
#ifdef DEBUG
  , const char * calledby
#endif
  );

void a((<all params of normal a()>    
#ifdef DEBUG
  , const char * calledby
#endif
  )
{
#ifdef DEBUG
  printf("'%s' calledby '%s', __FUNCTION__, calledby);
#endif
  ...
}

...

void b(void)
{
    a(<all params of normal a()>
#ifdef DEBUG
      , __FUNC__
#endif
    );
} 
```

* * *

`__FUNCTION__`在 GCC 上可用（至少？），如果使用不同的 C99 编译器将其替换为`__func__`.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-04-21T06:02:05.823

参考：[https ://www.gnu.org/software/libc/manual/html_node/Backtraces.html](https://www.gnu.org/software/libc/manual/html_node/Backtraces.html)

> 回溯是线程中当前处于活动状态的函数调用的列表。检查程序回溯的常用方法是使用外部调试器，例如 gdb。然而，有时以编程方式从程序中获取回溯是有用的，例如，出于日志记录或诊断的目的。
> 
> 头文件 execinfo.h 声明了三个函数，用于获取和操作当前线程的回溯。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-19T08:20:20.583

如果您只是在知道您在哪里进行日志记录/调试之后，您可以使用宏来避免`__func__`给出您的日志记录/调试函数的名称，而是给出调用它的函数的名称。

处于宏中不会导致更改，`__func__`但会“感觉”像使用函数。

例如

```
#define LOG(s, data...) log("%s: "s, __function__, ## data) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-19T08:38:29.163

如果你的平台是 Windows，你可以使用这个：[walking the callstack](http://www.codeproject.com/Articles/11132/Walking-the-callstack)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-19T08:14:12.347

您可以使用作为参数传递给**a()**的整数标识符标记调用**a()的每个函数，然后在****a()中使用****switch-case**构造来判断哪个函数调用 **了 a()** .A **printf()**如果您将其用作 a() 中 switch-case 构造的参数，将根据整数标识符值 告诉哪个函数调用**了****a()**

 ******```
#include<stdio.h>

void a(int);
void b();
void c();
void d();

int main(void)
{

b();
c();
d();

}

void b()
{

int x=1;
a(x);

}

void c()
{

int x=2;
a(x);

}

void d()
{

int x=3;
a(x);

}

void a(int x)
{

switch(x)
{
case 1:
printf("b called me\n");
break;
 case 2:
printf("c called me\n");
break;
case 3:
printf("d called me\n");
}

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-05T00:35:06.973

如果有问题的函数在不同的 c 文件中，你可以这样做

```
#define name_of_function(...) \
    printf("Function %s is parent\n", __FUNCTION__); \
    name_of_function(__VA_ARGS__); 
```

它位于 c 文件的顶部

```
#ifdef name_of_function
#undef name_of_function
#endif 
```

如果它们在同一个文件中，您可以将函数定义包装在第二个宏中，然后在最后重新定义第一个宏。它的可扩展性不是很强，因为您无法从其他定义中生成新定义，但是如果您尝试为特定功能追踪父级，它可以毫无意义地工作。

[https://godbolt.org/z/f2jKOm](https://godbolt.org/z/f2jKOm)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-04-25T20:06:25.410

```
#include <stdio.h>
#include <stdlib.h> 
```

#define FUNCTION_NAME( **FUNCTION** ) printf(" **FUNCTION** =%s \r\n", # **FUNCTION** );

```
int a() {
  printf("A function call");
}

int b() {
  printf("B function call");
}

int main(){
FUNCTION_NAME(a);
FUNCTION_NAME(b);
return 0; 
```

}******

# django - 我的网址是 url(r'^login/(?P \w+@\w+\.\w+)$', 'login'), 我怎样才能得到 /login 的 url

> ID：16100094
> 
> 赞同：0
> 
> 时间：2013-04-19T08:07:21.707
> 
> 标签：django, url, parameters

好吧，如果我的请求路径是`127.0.0.1:8000/admin/user/edit/10`，那么我想检查当前用户A是否有访问权限`/admin/user/edit`，当我使用时`url = request.path`，我得到的url为`/admin/user/edit/10`。

但我想得到。`url = '/admin/user/edit'`那么`url = '/admin/user/edit/10'`我怎样才能得到正确的网址呢？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:58:43.457

为什么不使用`permission_required`视图上方的装饰器？

```
@permission_required('app.edit_right') # Fill in your permission    
def edit_user(request):
    #do stuff here 
```

如果用户（或他所在的组）没有此权限，那么他将被重定向。查找有关[Django 文档的更多信息](https://docs.djangoproject.com/en/dev/topics/auth/default/#the-permission-required-decorator)

# java - 解析 jsonData 并获取图片的 urlStrings 以实现延迟加载

> ID：16100095
> 
> 赞同：0
> 
> 时间：2013-04-19T08:07:22.920
> 
> 标签：java, android, rest, httpclient, lazy-loading

我想在我的 ListView 中实现延迟加载图像。首先，我需要连接到一个 url 并获取属于一个对象的所有图像的 urlStrings。我得到一个 jsonString 然后解析：

```
String RESTUrl = new MasterdataDataProvider(mContext).getSyncServicePath() + "PhotoInfo/" + objectEntryID; 
List<String> urlStrings = new ArrayList<String>();
try {
    HttpGet httpGet = new HttpGet((RESTUrl + "/" + token));
    HttpParams httpParameters = new BasicHttpParams();
    DefaultHttpClient httpClient = new DefaultHttpClient(httpParameters);
    httpGet.addHeader("Accept", "application/json");
    httpGet.addHeader("Content-Type", "application/json");
    HttpResponse response = httpClient.execute(httpGet);
    String jsonData = EntityUtils.toString(response.getEntity());
    if (!jsonData.equals("[]")) {
        GsonPhotoInfo x = new GsonPhotoInfo(new GsonBuilder());
        PhotoInfo[] info = x.parseJSON(jsonData);
        for(PhotoInfo p : info) {
            System.out.println(p.getFileName());
            urlStrings.add(photoWebURL + objectDefID + "/" + objectEntryID + "/" + p.getFileName());
        }

   }
} catch(Exception e) {
        e.printStackTrace();
} 
```

正如您在这段代码中看到的那样，我获取`FileName from jsonData`.

然后我需要从 urlStrings 下载图像：

```
final Handler handler = new Handler() {
     @Override
     public void handleMessage(Message message) {
          ImagePagerAdapter adapter = new ImagePagerAdapter((Drawable[]) message.obj);
          viewPager.setAdapter(adapter); 
     }
};

     Thread thread = new Thread() {
     @Override
     public void run() {

         //PARSE THE JSON DATA and FETCH URLStrings (as you see in the piece of code at top)                       

         Drawable[] drawables = new Drawable[urlStrings.size()];
         for(int i=0; i< urlStrings.size(); i++) 
               drawables[i] = fetchDrawable(urlStrings.get(i));

               Message message = handler.obtainMessage(1, drawables);
               handler.sendMessage(message);
         }
    };
    thread.start(); 
```

获取图像的代码取自[James Wilson 的答案](https://stackoverflow.com/questions/541966/how-do-i-do-a-lazy-load-of-images-in-listview)。

所以你也可以看到，我必须再次使用 HTTPClient 来下载每个图像：

```
private InputStream fetch(String urlString) throws MalformedURLException, IOException {
    DefaultHttpClient httpClient = new DefaultHttpClient();
    HttpGet request = new HttpGet(urlString);
    HttpResponse response = httpClient.execute(request);
    return response.getEntity().getContent();
} 
```

问题是它在我的 listView 中不起作用。`The images are not loaded correctly in listView sometimes`，我只是想知道是不是因为这样：

1.  我从 jsonData 获取 urlStrings，然后
2.  一张一张地从 urlStrings 下载图片。

我的意思是我连接到 REST 两次。我也在使用 a`Handler`这可能不是一个好的选择，但实际上我用 a 测试了它`AsyncTask`并且我遇到了同样的问题。

我感谢任何可以解决我的问题的想法。

**附加物：**

当我快速滚动列表时，我发现图像加载不正确，否则很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:11:14.797

[从这里](https://github.com/nostra13/Android-Universal-Image-Loader)使用`UniversalImageLoader`库。它几乎没有错误。做内存处理，线程和所有其他的东西。

整合需要 2 分钟。试试看 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:15:20.783

好家伙！！每次下载图像时，您都在设置列表适配器。我建议您使用 androids 教程来使用列表视图，然后使用带有延迟图像加载的列表视图。

列表显示

[http://developer.android.com/training/improving-layouts/smooth-scrolling.html](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)

图像处理

[http://developer.android.com/training/displaying-bitmaps/load-bitmap.html](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T10:00:32.150

我通过为我的 ListView 实现 OnScrollListener 解决了我的问题，并在滚动处于空闲模式时下载图像。但我认为正确的方法是在延迟加载实现中不获取图片url，也许图片url需要包含在main Object中。

```
public static boolean scroll_is_idle = true;

mListView.setOnScrollListener(new OnScrollListener() {
    public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) { }

    public void onScrollStateChanged(AbsListView view, int scrollState) {
        switch (scrollState) {
                case OnScrollListener.SCROLL_STATE_IDLE:
                    scroll_is_idle = true;
                    mAdapter.notifyDataSetChanged();
                    break;
                case OnScrollListener.SCROLL_STATE_TOUCH_SCROLL: 
                    scroll_is_idle = false;
                    break;
                case OnScrollListener.SCROLL_STATE_FLING:
                    scroll_is_idle = false;
                    break;
        }
    }
}); 
```

# mysql - 如何通过mysql查询获得记录差异的总和

> ID：16100097
> 
> 赞同：1
> 
> 时间：2013-04-19T08:07:30.223
> 
> 标签：mysql

我有一张如下表

```
Value          Count
value1         55
value2         60
value3         65
value4         20
value5         25
value6         45
value7          5
value8         25 
```

我需要一个查询来获取两个连续计数之间的差异并将它们相加。一个条件是，如果下一个值小于前一个值，则考虑下一个值而不是差值。工作如下

```
Value          Count       Diff         Explanation
value1         55                       No diff as there is no previous value
value2         60            5          (60-55)
value3         75           15          (75-60) 
value4         20           20          (20 as 20 < 75)
value5         25            5          (25-20)
value6         45           20          (45-25)
value7          5            5          (5 as 5 < 45)
value8         25           20          (25-5) 
```

查询应该给出所有差异的总和，即`5+15+20+5+20+5+20 = 90`

提前感谢您为我制作的精彩查询:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:48:59.683

您可以使用此查询，假设您有一个表`tbl(v,c)`- **v**是值字段，**c**是计数字段。

```
SELECT t1.v, t1.c as cnt1,
    case 
      when t2.c is null then 0
      when t2.c > t1.c then t1.c
      else t1.c - t2.c
    end as diff
FROM TBL T1
left outer JOIN TBL T2 ON T1.v > T2.v
where not exists (
   SELECT * 
   FROM TBL T3 WHERE T3.V < T1.V AND T3.V > T2.V
) 
```

顺便说一句，您的结果**value3**应该是 65 而不是 75

我做了一个[小提琴](http://sqlfiddle.com/#!2/fca76/16)来测试它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:13:35.770

你可以`coalesce`用来解决这个问题

```
select a.Value,a.count
coalesce(a.count- 
    (select b.countfrom table_name b where b.count= a.count+ 1), a.count) as diff
from table_name  a 
```

但这解决了你的一半问题。我不知道第二个问题的答案

[看这里](https://stackoverflow.com/questions/919136/subtracting-one-row-of-data-from-another-in-sql)

# php - TCPDF 将数字签名添加到创建的 pdf

> ID：16100109
> 
> 赞同：8
> 
> 时间：2013-04-19T08:08:23.673
> 
> 标签：php, pdf, tcpdf

我有一个奇怪的问题。
一段时间以来，我一直在努力解决`pdf`数字签名问题，但它并没有像我预期的那样工作。实际上它根本不起作用。

我使用了与页面中发布的完全相同的代码`Examples 52`：

```
// set certificate file
$certificate = 'file://var/www/app/tcpdf/config/cert/tcpdf.crt';

// set additional information
$info = array(
    'Name' => 'TCPDF',
    'Location' => 'Office',
    'Reason' => 'Testing TCPDF',
    'ContactInfo' => 'http://www.tcpdf.org',
    );

// set document signature
$pdf->setSignature($certificate, $certificate, 'tcpdfdemo', '', 2, $info); 
```

第一个问题是关于

```
Warning: openssl_pkcs7_sign() [function.openssl-pkcs7-sign]: error getting private key in /var/www/app/tcpdf/tcpdf.php on line 7566 
```

这是因为我没有设置权限来执行`cert`目录。但是在我设置`777`魔法之后发生了。
从现在开始，我看不到错误是什么，也看不到错误轨迹，但是：

```
HTTP ERROR 324 (net::ERR_EMPTY_RESPONSE) 
```

谁能给我一些建议？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-26T18:18:41.520

据我所知，您收到的错误不是由您在问题中发布的代码引起的，因为该代码是直截了当的，并且与 TCPDF 文档中的代码完全相同。[您可以在TCPDF 文档](http://www.tcpdf.org/examples/example_052.phps)中找到发送签名 pdf 的示例

那里的代码如下：

```
require_once('../config/lang/eng.php');
require_once('../tcpdf.php');

// create new PDF document
$pdf = new TCPDF(PDF_PAGE_ORIENTATION, PDF_UNIT, PDF_PAGE_FORMAT, true, 'UTF-8', false);

// set document information
$pdf->SetCreator(PDF_CREATOR);
$pdf->SetAuthor('Nicola Asuni');
$pdf->SetTitle('TCPDF Example 052');
$pdf->SetSubject('TCPDF Tutorial');
$pdf->SetKeywords('TCPDF, PDF, example, test, guide');

// set default header data
$pdf->SetHeaderData(PDF_HEADER_LOGO, PDF_HEADER_LOGO_WIDTH, PDF_HEADER_TITLE.' 052', PDF_HEADER_STRING);

// set header and footer fonts
$pdf->setHeaderFont(Array(PDF_FONT_NAME_MAIN, '', PDF_FONT_SIZE_MAIN));
$pdf->setFooterFont(Array(PDF_FONT_NAME_DATA, '', PDF_FONT_SIZE_DATA));

// set default monospaced font
$pdf->SetDefaultMonospacedFont(PDF_FONT_MONOSPACED);

//set margins
$pdf->SetMargins(PDF_MARGIN_LEFT, PDF_MARGIN_TOP, PDF_MARGIN_RIGHT);
$pdf->SetHeaderMargin(PDF_MARGIN_HEADER);
$pdf->SetFooterMargin(PDF_MARGIN_FOOTER);

//set auto page breaks
$pdf->SetAutoPageBreak(TRUE, PDF_MARGIN_BOTTOM);

//set image scale factor
$pdf->setImageScale(PDF_IMAGE_SCALE_RATIO);

//set some language-dependent strings
$pdf->setLanguageArray($l);

// ---------------------------------------------------------

/*
NOTES:
 - To create self-signed signature: openssl req -x509 -nodes -days 365000 -newkey rsa:1024 -keyout tcpdf.crt -out tcpdf.crt
 - To export crt to p12: openssl pkcs12 -export -in tcpdf.crt -out tcpdf.p12
 - To convert pfx certificate to pem: openssl pkcs12 -in tcpdf.pfx -out tcpdf.crt -nodes
*/

// set certificate file
$certificate = 'file://../config/cert/tcpdf.crt';

// set additional information
$info = array(
    'Name' => 'TCPDF',
    'Location' => 'Office',
    'Reason' => 'Testing TCPDF',
    'ContactInfo' => 'http://www.tcpdf.org',
    );

// set document signature
$pdf->setSignature($certificate, $certificate, 'tcpdfdemo', '', 2, $info);

// set font
$pdf->SetFont('helvetica', '', 12);

// add a page
$pdf->AddPage();

// print a line of text
$text = 'This is a <b color="#FF0000">digitally signed document</b> using the default (example) <b>tcpdf.crt</b> certificate.<br />To validate this signature you have to load the <b color="#006600">tcpdf.fdf</b> on the Arobat Reader to add the certificate to <i>List of Trusted Identities</i>.<br /><br />For more information check the source code of this example and the source code documentation for the <i>setSignature()</i> method.<br /><br /><a href="http://www.tcpdf.org">www.tcpdf.org</a>';
$pdf->writeHTML($text, true, 0, true, 0);

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// *** set signature appearance ***

// create content for signature (image and/or text)
$pdf->Image('../images/tcpdf_signature.png', 180, 60, 15, 15, 'PNG');

// define active area for signature appearance
$pdf->setSignatureAppearance(180, 60, 15, 15);

// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

// *** set an empty signature appearance ***
$pdf->addEmptySignatureAppearance(180, 80, 15, 15);

// ---------------------------------------------------------

//Close and output PDF document
$pdf->Output('example_052.pdf', 'I'); 
```

请注意，您需要将页面添加到文档中，然后调用 Output() 函数才能实际获取发送到浏览器的任何输出。否则，服务器将没有任何数据要发送，因此会给您一个空响应，从而导致此错误。

如果您在服务器上创建文件并将其保存在您的脚本没有权限访问和输出到浏览器的文件夹中，也可能导致此错误。

如果您使用 Google Chrome 查看您的 pdf，您可能需要在此处查看有关此错误的信息[Chrome Empty Response Errors Group](http://productforums.google.com/forum/#!topic/chrome/2EDWkwK2Go8)

此外，有报告称此错误是由错误配置的 Zend Optimizer/Zend Guardian 设置引起的。如果上述两种情况都不是，我会确保这些都已停用以继续进行故障排除。

如您所见，此错误有点不具体，因此很难排除故障。

# c# - CoreDispatcher.HasThreadAccess “重大变化”

> ID：16100110
> 
> 赞同：0
> 
> 时间：2013-04-19T08:08:25.693
> 
> 标签：c#, windows-runtime, mvvmcross

我正在接管使用 MvvmCross.vNext 开发的应用程序。
在尝试使用 MvvmCross.V3 对其进行更新时，我发现了以下重大更改：在 MainViewModel 的构造函数中，我们显示了 LoginViewModel (ShowViewModel())。它在 vNext 中运行良好。
但是在 V3 中，LoginView 不显示。
经过**长时间**的搜索，我发现在**MvxStoreMainThreadDispatcher.RequestMainThreadAction**中添加了以下代码：

```
 if (_uiDispatcher.HasThreadAccess)
        {
            action();
            return true;
        } 
```

对我的麻烦负责。
如果我将其注释掉，我的应用程序会像以前一样工作，但我想这段代码是出于某种原因......
你有什么建议吗？
我可以在不更改 MvvmCross 源代码的情况下强制以前的行为吗？
我应该重构代码以不同方式处理 LoginView 吗？
提前感谢您的评论。
菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:25:21.500

> 在尝试使用 MvvmCross.V3 对其进行更新时，我发现了以下重大更改：在 MainViewModel 的构造函数中，我们显示了 LoginViewModel (ShowViewModel())。它在 vNext 中运行良好。

我认为您的构造函数导航会在任何 MvvmCross 版本的多个平台上中断。老实说，我认为你很幸运它以前工作过。

问题是 ViewModel 是在 View 事件期间构建（或定位）的，例如`ViewDidLoad`、`OnNavigatedTo`和`OnCreate`- 并且这些事件通常在“页面转换”期间调用

要解决此问题，您**需要**将登录导航移出构造函数。

你如何做到这一点取决于你的应用程序

*   如果您确实需要 Home->Login backstack，那么您可以触发一些异步或时间延迟，或者您可以触发一些其他 View 事件，例如`ViewDidAppear`

*   如果你不需要那个backstack，那么我通常实现这种事情的方式是使用自定义`IMvxAppStart`——比如：

    ```
    public class AppStart
        : MvxNavigatingObject
        , IMvxAppStart      
    {
        public void Start(object hint = null)
        {
            var authService = Mvx.Resolve<IMySerice>();
            if (authService.IsLoggedIn)
            {
                ShowViewModel<HomeViewModel>();
            }
            else
            {
                ShowViewModel<LoginViewModel>();
            }
        }
    } 
    ```

    [（您可以在https://github.com/slodge/MvvmCross/blob/v3/Sample%20-%20CirriousConference/Cirrious.Conference.Core/ApplicationObjects/AppStart.cs](https://github.com/slodge/MvvmCross/blob/v3/Sample%20-%20CirriousConference/Cirrious.Conference.Core/ApplicationObjects/AppStart.cs)中看到另一个示例）

    这可以使用以下方法在 App.cs 启动中注册：

    ```
    RegisterAppStart(new AppStart()); 
    ```

# google-sheets - 谷歌电子表格行更新

> ID：16100111
> 
> 赞同：1
> 
> 时间：2013-04-19T08:08:27.353
> 
> 标签：google-sheets

我需要每 3 分钟更新一行函数`=importxml()`以刷新 MAP 小工具。

我将功能 redROWs 设置为每 3 分钟触发一次，但它不起作用。任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-26T10:19:50.950

importXML() 每 2 小时自行更新一次，您无法从脚本中触发它。然后你必须将函数写入你的脚本..

我发现的最佳解决方案是将 GoogleClock() 添加到 URL。它使 ImportXML 每分钟自动更新一次。此外，当电子表格未打开时。

像这样： ImportXML("URL"&GoogleClock(),"div...")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:34:38.033

getActiveSheet() 仅在您打开电子表格时有效 - 使用 openById

[https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app#openById(String)](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app#openById(String))

触发 =importxml ，在工作表上写一些东西。

# django - 将变量从Django中的下拉列表传递到模板

> ID：16100113
> 
> 赞同：1
> 
> 时间：2013-04-19T08:08:30.540
> 
> 标签：django, templates, variables, drop-down-menu, views

我在 Django 中进行了一个小项目（仍在学习它和 Python），并且对在 Django 中传递变量有一些疑问。

例如，用户输入一些数据，项目对其进行处理，然后计算一些简单的统计数据。我想通过下拉按钮传递一个“年份”变量，以便用户可以选择应该生成报告的年份。

部分代码：

模型.py：

```
class Fms(models.Model):
...
date = models.DateField()
department = models.CharField(max_length=255, verbose_name='Department') 
```

视图.py：

```
def raport(request):
raport = Fms.objects.filter(date__year='2013').extra(select={'month': "EXTRACT(month FROM date)"}).values('month', 'department').order_by('month').annotate(Count('department'))
return render_to_response ('fmstat/raport.html',
                           {'raport': raport},
                           context_instance=RequestContext(request)) 
```

测试按钮：

```
<div class="bs-docs-example">
    <ul class="nav nav-pills">
        <li class="dropdown">
            <a class="dropdown-toggle" id="drop4" role="button" data-toggle="dropdown" href="#">Select year for report <b class="caret"></b></a>
            <ul id="menu1" class="dropdown-menu" role="menu" aria-labelledby="drop4">
                <li role="presentation"><a role="menuitem" tabindex="-1" href="{% url 'fmstat.views.raport' %}">2012</a></li> 
```

那么我该怎么做呢？通过 URL 传递它还是有另一种更简单的方法？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T09:06:53.650

更新您的 url 模式以捕获年份，更新您的视图以将年份作为参数，并更新您的模板以使用年份构建 url：

```
# urls.py
urlpatterns = ('',
   url(r'^raport/(?<year>\d{4})/?', "fmstat.views.raport"),
   # ...
   )

# views.py 
def raport(request, year):
    raport = Fms.objects.filter(date__year=year).extra(...)
    # ...

# template.html
 (...)
 <li role="presentation">
    <a role="menuitem" tabindex="-1" 
        href="{% url 'fmstat.views.raport' '2012' %}">2012</a>
 </li> 
```

# javascript - Embed Javascript Widget In Meteor Template

> ID：16100123
> 
> 赞同：4
> 
> 时间：2013-04-19T08:09:33.417
> 
> 标签：javascript, meteor, handlebars.js

I'm building my first [Meteor](http://meteor.com) app and am bumping into an issue embedding Javascript widgets.

So my app is basic single page landing page and I'm trying to embed the Twitter timeline widget with the following code...

```
<a class="twitter-timeline" href="https://twitter.com/abrudtkuhl" data-widget-id="325157935250546688">Tweets by @abrudtkuhl</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

The script tag is never executed and it only renders the a tag. I'm not quite sure if this is a [Handlebars](http://handlebarsjs.com/) *(the default template engine for Meteor)* issue or Meteor issue as I'm relatively new to both frameworks.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-19T08:33:14.073

一般来说，当您构建 Meteor 应用程序时，您希望将 Javascript 与模板分开。尝试这个：

我假设`<a class="twitter-timeline"...`在一个名为“twitter”的模板中（例如`<template name="twitter">`。将您的 javascript 放在一个名为 twitter.js 的文件中，并在模板呈现后调用。

```
Template.twitter.rendered = function () {
  ! function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
      js = d.createElement(s);
      js.id = id;
      js.src = "//platform.twitter.com/widgets.js";
      fjs.parentNode.insertBefore(js, fjs);
    }
  }(document, "script", "twitter-wjs");
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-28T21:49:36.183

尽管@emgee 的答案是绝对正确的，但在某些情况下这还不够。

当 JavaScript 只是插入一个新元素时，下次显示模板时，不会重新插入 JS（它已经存在），并且不会再次调用它的初始化。

大多数社交小部件都是如此，您需要手动强制这些小部件重新解析页面。这不仅是 Meteor 问题，而且对于任何在 AJAX 中加载包含小部件的内容的站点都是如此。

例如，对于 twitter 小部件，您需要调用`twttr.widgets.load(rootElement)`.

例如，在 pijs.io 的主页上，要重新处理嵌入的推文和“关注”按钮，我有：

```
Template.home.rendered = function() {
  setTimeout(function() { 
    twttr.widgets.load(this.firstNode);;
    FB.XFBML.parse(this.firstNode);
  }, 0);
} 
```

参考：

*   推特：[https ://dev.twitter.com/discussions/890](https://dev.twitter.com/discussions/890)
*   脸书：[https ://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)

# sql-server - 用于将数据从服务器导出到服务器的命令行工具

> ID：16100126
> 
> 赞同：1
> 
> 时间：2013-04-19T08:09:38.233
> 
> 标签：sql-server, command-line, batch-file

在 SqlServer Management Studio 中，如果我们单击数据数据库，则会出现菜单任务 > 导出数据。这有助于我将此数据库导出到另一台服务器。

但是，我需要运行此向导来完成此任务，并且每次我想使用它时都需要指定源和目标服务器信息。

我认为如果我可以使用命令行来执行相同的任务并编写批处理文件来自动化它会很方便。

请您帮我提供一些建议或向我介绍一个可以执行此任务的命令行程序，因为我用谷歌搜索但没有找到任何有用的信息。

太感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:23:00.620

你可以使用[BCP](http://msdn.microsoft.com/en-us/library/ms162802.aspx)实用程序

```
BCP Out 
BCP server.schema.TableName out c:\TableName.txt -c -t -T –SServerName -UUsername -Password

BCP In 
BCP server.schema.TableName In c:\TableName.txt -c -t -T –SServerName -UUsername -Password 
```

第一条语句是`export`将数据转换为 csv 文件，`BCP IN`用于将数据从 csv 文件导入`Destination`表

这里 `-T`代表受信任的连接并`-t`代表字段分隔符

您可以在批处理文件中编写这些 BCP 命令

或者您可以创建一个简单的`ssis`包来导出数据

# math - Similarity measure of vectors

> ID：16100130
> 
> 赞同：-1
> 
> 时间：2013-04-19T08:09:59.503
> 
> 标签：math, similarity

I want to discuss with you which similarity measure which meets my requirements. My vectors could be look like that:

```
A = (-4,0,4,null)
B = (-2,null,-4,null)
C = (4,4,4,4)
D = (0,0,0,0)
E = (null,null,null,null)
F = (-4,-4,-4,-4) 
```

The values are activity values in a range from -5 to +5\. The value of 0 stand for an non active value and values near -5 and +5 stand for an high active value. So i am searching for the right similarity measure.

I want to get the similarity between all combinations of the these vectors. I think the similarity between C and F must be 1 and the similarity between C and D must be 0:

```
C:E = 0
C:F = 1
C:D = 0
A:B = i think something over 0.5 
```

I hope you unterstand my requirements. My question is now: which similarity measure could meet my requirements?

EDIT:

*   0 is not the same as null. null is really not defined
*   The similarity measure needs only to calculate the similarity between two vectors

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:16:00.167

这相当复杂，首先要使 C 和 F 相似，您要从取绝对值开始。同样，看起来 null 应该被翻译成 0。

这将导致向量的元素仅在 0..5 范围内，这稍微简化了问题。

然后问题是你想怎么做，从组件明智的差异开始可能是一个好的开始，然后问题是如何将它们加权在一起，随机猜测可能只是线性组合，也可能是二次组合。

确实，在最后一步中说任何有用的东西在很大程度上取决于您的用例，但我认为如果您可以从将所有元素都置于 0..5 范围内开始，就会收获很多。

# web-services - DDD with webservices DTO as value object: how to handle them?

> ID：16100132
> 
> 赞同：0
> 
> 时间：2013-04-19T08:10:09.050
> 
> 标签：web-services, model, domain-driven-design, dto, value-objects

I have a "**MyUnits**" application that let's manage Units (like meters, kilograms, pounds, miles, km/h...). The model is complex, it supports unit compatibilities, operations, conversions, etc.

I have another application (**MyApp**) that will need to use "units", so I want to make it use my "Units" application.

What I thought is to have a "Units" service (webservice) `UnitService` that consumes and returns a Unit DTO `UnitDTO`.

In MyApp, I have this model:

```
Operand
    value: float
    unit: UnitDTO
OperationAdd
    operand1: Operand
    operand2: Operand
    execute() 
```

**The problem**: in `OperationAdd.execute()`, I need to check that units are compatibles (for example).

So either:

*   `UnitDTO` has a method that will call `UnitService::areCompatible`, but that is wrong! How a DTO (that should only contain data) knows UnitService which is a webservice! It shouldn't

*   `OperationAdd.execute()` calls `UnitService::areCompatible`, but that is wrong! How OperationAdd (an entity) knows UnitService which is a webservice! It shouldn't

*   or I have a `OperationService` that does the work (and that can call services) **but** my `Operation` entities would be like data containers, entities with no methods, and that's not really what DDD is about

I don't want anemic entities, but in the case where I have an entity that uses a service, how can I do?

And: am I wrong thinking that UnitDTO can be used as a VO?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:59:58.637

一个单元应该“宣传”它的兼容性。我不知道您使用的语言是否支持泛型，但我会这样做。

首先，UnitDto 包含某个 Unit 的状态。使用 UniDto 创建具体的 Unit（顺便说一句，它是一个 VO）。每个 Unit 都应该知道它的兼容性。UnitDTO 应该只是一个 DTO，创建其他可以完成工作的 VO。

C＃

```
public class UnitBase
{
    public virtual bool IsCompatible(UnitBase unit)
    {
        return false;
    }
}

public interface ICompatible<T>
{
     bool IsCompatible(T unit);
}
public class UnitFeet {}
public class UnitMeter:UnitBase,ICompatible<UnitFeet>
{
    bool IsCompatible(UnitFeet unit) { return true;}
 }
 public override bool IsCompatible(UnitBase unit)
 {
    return IsCompatible((UnitFeet)unit);

 } 
```

编译器应根据比较的单元选择正确的重载。ICompatbile 接口也可以具有从一个单元到另一个单元的转换方法。但是让我们假设你想要更抽象的东西

```
public class OperandValue:ICompatbile<OperandValue>
{ 
     public decimal Value {get;set;}
     public UnitBase Unit {get;set;}
     public bool IsCompatbile(OperandValue other)
     {
        return Unit.IsCompatbile(other.Unit);
     }

     public static OperandValue FromDto(Operand data)
      {
         return new OperandValue(data.Value,UnitBase.FromDto(data.Unit));
       }
}

 OperandValue first=OperandValue.FromDto(operand1);
 OperandValue second=OperandValue.FromDto(operand2);

if (first.IsCompatbile(second)){
    OperationService.Add(first,second)
  } 
```

所以你不需要 UnitService::AreCompatbile 方法，只需要大量的多态性和仔细的对象设计。

# import - Control data import from Outlook to CRM2011 - is it possible?

> ID：16100133
> 
> 赞同：1
> 
> 时间：2013-04-19T08:10:09.863
> 
> 标签：import, outlook, dynamics-crm-2011

For now, I faced with problem of importing contacts from Outlook to CRM: field "Business Phone 2" is not transferred. I've created test contact in Outlook, defined "Business phone 2" as 111 22 5555555 and import the one into CRM and - number has not been transferred. Moreover, I set "Business phone 2" in CRM as 222 33 6666666 and this change has not been transferred to Outlook as well. I suppose that this field is not mapped between Outlook contact and CRM contact entities at all. So, I'm interested in handling this import process with plugin and control the process with my own code. So far, I can fire my plugin on contact Create and Update, but I cannot see the pre data to be imported from Outlook. I'm sure that some of you have already faced with this issue and knows the solution or possible approach. What is the possible approach could be? Any thoughts are appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:47:00.607

[http://blogs.msdn.com/b/crm/archive/2006/07/03/655714.aspx](http://blogs.msdn.com/b/crm/archive/2006/07/03/655714.aspx) 这是字段映射。如您所见，映射中不存在商务电话 2

# asp.net - Asp.Net UpdatePanel error

> ID：16100143
> 
> 赞同：2
> 
> 时间：2013-04-19T08:10:53.863
> 
> 标签：asp.net, scriptmanager, updatepanel

I use UpdatePanel in my aspx page and DropDownList with `onselectedindexchanged` method.

When run first time `onselectedindexchanged` method is working. But change selected again it return an error like that;

> Uncaught Sys.WebForms.PageRequestManagerServerErrorException: Sys.WebForms.PageRequestManagerServerErrorException: The state information is invalid for this page and might be corrupted.

```
 <asp:ScriptManager ID="ScriptManager1" runat="server" EnableViewState="False" EnableScriptGlobalization="true" >
</asp:ScriptManager>

<%@ Page Title="" Language="C#" AutoEventWireup="true" 
EnableEventValidation="false" ...  %> 
```

Not : I have to Partial Rendering so i cant add `EnablePartialRendering="false"` to ScriptManager.

How can i solve this problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-13T03:49:51.210

根据上面@Aristos 的评论，通过我的`Telerik`解决方案，我不得不暂时删除`telerik:RadAjaxManager`以查看潜在错误。这类似于暂时删除`UpdatePanel`.

就我而言，错误是：`TypeLoadException: Could not load type 'System.Data.Entity.DynamicProxies.RepricingApproval_40D472CCAE59DB7A70B40FC6B029B430955A5ED87A7670652AA5B4D9D96A9A38' from assembly 'EntityFrameworkDynamicProxies-Data, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'.]`

（顺便说一句，上面的修复是设置`EnableFlattening`为假）。

# python - 如何根据标准将列表转换为三个列表并放入字典

> ID：16100149
> 
> 赞同：1
> 
> 时间：2013-04-19T08:11:48.033
> 
> 标签：python, list

我有这样的清单

```
mylist = [student_number , student_age , student_marks , subject_name , subject_marks, subject_date , ass_name , ass_number] 
```

我想要类似的东西

```
 list_student = [student_number , student_age , student_marks]
   list_subject = [subject_name , subject_marks, subject_date]
   list_ass     = [ass_name , ass_number] 
```

以便它与下划线之前的文本匹配，将其作为字典的键

我想将其转换为字典，以便我可以访问类似

```
 for a AllList['student']:
           Student stuff 
```

编辑：列表元素可以按任何顺序排列

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:19:00.797

我会这样做：

```
# Build dictionary with prefix:list pairs
targets = {
    'student_': [],
    'subject_': [],
    'ass_': []
}

for i in mylist:
    # Try to find matching prefix
    for prefix in targets:
        if i.startswith(prefix):
            targets[prefix].append(i)
            break 
```

这将很容易让您添加更多前缀并且不关心顺序。

假设（这些值是字符串）：

```
mylist = ['student_number', 'student_age', 'student_marks', 'subject_name',
          'subject_marks', 'subject_date' , 'ass_name' , 'ass_number' ] 
```

你会得到这样的结果：

```
>>> for i in targets: print( i, targets[i])
...
ass_ ['ass_name', 'ass_number']
student_ ['student_number', 'student_age', 'student_marks']
subject_ ['subject_name', 'subject_marks', 'subject_date'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:33:50.280

作为替代方案，您可以使用[collections.defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict

mylist = ['student_number', 'student_age', 'student_marks', 'subject_name',
      'subject_marks', 'subject_date' , 'ass_name' , 'ass_number' ]

d = defaultdict(list)
for v in myList:
    k = v.split('_')[0]
    d[k].append(v) 
```

它会给你：

```
>>>print d
defaultdict(<type 'list'>, {'ass': ['ass_name', 'ass_number'], 'student': ['student_number', 'student_age', 'student_marks'], 'subject': ['subject_name', 'subject_marks', 'subject_date']}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:51:14.600

这是我的解决方案：

```
>>> mylist = ['student_number', 'student_age', 'student_marks', 'subject_name',
...           'subject_marks', 'subject_date' , 'ass_name' , 'ass_number' ]
>>> import itertools
>>> m = {k:list(v) for k,v in itertools.groupby(mylist, lambda s: s.split('_')[0])}
>>> m
{'ass': ['ass_name', 'ass_number'], 'student': ['student_number', 'student_age', 'student_marks'], '
subject': ['subject_name', 'subject_marks', 'subject_date']} 
```

# java - Android: creating two linearlayout in single relative layout with on click button

> ID：16100151
> 
> 赞同：1
> 
> 时间：2013-04-19T08:11:56.963
> 
> 标签：java, android, xml, android-linearlayout, android-relativelayout

In my single screen android project(using only one XML file) when i press button1 then linerlayout1 is open and when i press button2 then linearlayout2 is open.my button1 and button2 is placed in linearlayout3.can it works??if yes then how?? thanks in advance.

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
       android:id="@+id/relativeLayout1"
       android:layout_width="fill_parent"
       android:layout_height="fill_parent" >

       <LinearLayout
       android:id="@+id/linearLayout1"
       android:layout_width="fill_parent"
       android:layout_height="50dp"
       android:layout_above="@+id/linearLayout3"
       android:layout_alignParentLeft="true"
       android:layout_alignParentRight="true"
       android:layout_alignParentTop="true"
       android:orientation="vertical" >

      <RadioButton
      android:id="@+id/radioButton3"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/linearLayout1" />

     <RadioButton
      android:id="@+id/radioButton4"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:text="@string/linearLayout1" />

     </LinearLayout>

     <LinearLayout
     android:id="@+id/linearLayout3"
     android:layout_width="fill_parent"
     android:layout_height="50dp"
     android:layout_alignParentBottom="true"
     android:layout_alignParentRight="true" >

    <Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/Button1" />

    <Button
    android:id="@+id/button2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/Button2" />

   </LinearLayout>

   <LinearLayout
   android:id="@+id/linearLayout2"
   android:layout_width="fill_parent"
   android:layout_height="50dp"
   android:layout_alignParentBottom="true"
   android:layout_alignParentLeft="true"
   android:orientation="vertical" >

    <RadioButton
    android:id="@+id/radioButton13"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/linearLayout2" />

    <RadioButton
    android:id="@+id/radioButton14"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/linearLayout2" />

        </LinearLayout>

        </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:17:55.573

是的，这很简单：

最初使用`android:Visibility`XML 标记，当按下每个相应的按钮时，您将获得对`LinearLayout`s 的引用，并将它们的可见性设置为`VISIBLE`或`GONE`在代码中。

注意：你想使用`GONE`而不是`INVISIBILE`as`INVISIBILE`仍然会占用屏幕空间，所以以前会有一大块空白空间，而我假设你希望它们相互替换

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:20:15.723

在线性布局1和2的布局xml中，使用

```
android:visibility="gone" 
```

从代码

```
LinearLayout l1 = (LinearLayout) findViewById(R.id.linearLayout2); 
```

您可以使用以下内容使其可见

```
l1.setVisibility(View.VISIBLE); 
```

并隐藏它

```
l1\. setVisibility(View.GONE): 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:21:09.437

您可以使用布局的“setVisibility”属性。在“onCreate()”方法中，你可以做这样的事情

```
LinearLayout layout1 = (LinearLayout) view.findViewById(R.id.linearLayout1);
layout1.setVisibility(View.GONE); 
```

然后按下按钮

```
layout1.setVisibility(View.VISIBLE); 
```

# .net - 在 Entity Framework 5 中更新实体关联

> ID：16100155
> 
> 赞同：2
> 
> 时间：2013-04-19T08:12:18.150
> 
> 标签：.net, database, entity-framework

我目前遇到了一个问题，我搜索了堆栈溢出的高低，似乎没有解决方案。我觉得我一定做错了什么，但希望有人能帮忙。

无论如何，我有以下型号：

```
public abstract class IDObject
{
    [Key]
    public Guid ID { get; set; }
}

public class TV : IDObject
{
    public TV()
    {
        this.Channels = new List<Channel>();
    }
    public string Name { get; set; }
    public virtual IList<Channel> Channels { get; set; } 
}

public class Channel : IDObject
{
    public string Name { get; set; }
    public int Number { get; set; }
    [Navigational]
    public virtual IList<TV> TVs { get; set; }  
} 
```

电视 - 频道应该是多对多的关系。

现在基本上我希望能够将电视和频道添加到数据库中，处理上下文，让电视引用之前添加的频道，然后更新数据库实体。

就像是：

```
TV someTV = new TV() { ID = Guid.NewGuid(), Name = "myBigTV" };
Channel chan1 = new Channel() { ID = Guid.NewGuid(), Name = "CBC", Number = 3};

using (ReferenceContext context = new ReferenceContext())
{
    context.TVs.Add(someTV);
    context.Channels.Add(chan1);
    context.SaveChanges();
}

someTV.Name = "myBigTV updated";
someTV.Channels.Add(chan1);

using (ReferenceContext context = new ReferenceContext())
{
    context.TVs.Attach(someTV);
    context.Entry(someTV).State = EntityState.Modified;
    *** some code here ***
    context.SaveChanges();
} 
```

当我这样做时，我的 someTV 实体会更新，但是当我在数据库中进行“查找”调用时，它仍然没有对 Channels 的引用。

现在我已经在 DbCollectionEntry 上为 Channels 尝试了 .Load()。我尝试在上下文中从 someTV 中删除所有对频道的引用，然后重新添加它们。我尝试将我从 someTV 引用的频道上的 EntityState 更改为 Modified ......似乎没有任何效果。

我首先使用代码，数据库正在为我创建以下表格：

```
Channels
ChannelTVs
TVs 
```

频道和电视看起来都不错，但无论我做什么，我的连接表“ChannelTVs”总是空的。

**问题一：在这种情况下更新关联的标准方法是什么。我不需要自己更新频道，只需从连接表中添加/删除实体即可。我是否需要向 fluent API 添加一些内容来为我获取这些更改？**

**问题二：有没有办法以通用的方式做到这一点？我当前的更新看起来像：**

```
void Update<TDatabase>(IDatabaseContext context, TDatabase item)
{
    IDbSet<TDatabase> dbSet = context.GetDbSet<TDatabase>();
    dbSet.Attach(item);
    context.Entry(item).State = EntityState.Modified;
    context.SaveChanges();
} 
```

我知道以前有人问过这样的问题，但似乎没有一个解决方案有效。这可能是我做错了什么，或者只是一个特殊情况......

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:11:41.067

如果有人发现这个并且很好奇......我设法找到了一个通用的解决方案。虽然不漂亮，但它确实有效。

```
update()
{
    using (ReferenceContext context = new ReferenceContext())
    {
        TV newTV = context.TVs.Single(x => x.ID == someTV.ID);
        DbEntityEntry entityEntry = context.Entry(newTV);
        entityEntry.CurrentValues.SetValues(someTV);
        UpdateReferences(context, entityEntry, someTV);
        context.SaveChanges();
    }
}

private static void UpdateReferences(ReferenceContext context, DbEntityEntry entityEntry, IDObject someObject)
{
    List<PropertyInfo> properties = someObject.GetType().GetProperties().Where(prop => !prop.IsDefined(typeof(NavigationalAttribute), false) && prop.PropertyType.GetInterfaces().Any(type => type == typeof(IEnumerable)) && prop.PropertyType.GetGenericArguments().Any()).ToList();

    foreach (PropertyInfo property in properties)
    {
        IList references = (IList)property.GetValue(someObject, null);
        DbCollectionEntry newCollection = entityEntry.Collection(property.Name);

        var method = typeof(TestEF).GetMethod("Wrapped", BindingFlags.NonPublic | BindingFlags.Static).MakeGenericMethod(property.PropertyType.GetGenericArguments()[0]);

        method.Invoke(null, new object[] { context, newCollection.CurrentValue, references });
    }
}

private static void Wrapped<T>(ReferenceContext context, IList<T> container, IEnumerable<T> references) where T : IDObject
{
    container.Clear();
    var dbSet = context.GetDbSet<T>();
    foreach (var referencedObject in references)
    {
        T item = dbSet.Find(referencedObject.ID);
        container.Add(item);
    }
} 
```

# c# - 使用 C# 中的配置文件为 SNC 配置 SAP .NET 连接器

> ID：16100161
> 
> 赞同：2
> 
> 时间：2013-04-19T08:13:00.583
> 
> 标签：c#, configuration, sap, sap-dotnet-connector

我们有许多用 C# 开发的应用程序，它们使用 SAP .NET 连接器 3.0 与 SAP 交互。我对此非常熟悉，最近有人要求我通过使用 SNC（安全网络通信）选项来保护这个接口，我也能够配置并开始工作。

但是，我想完全通过配置文件而不是以编程方式配置我的 SNC 目的地。要指定*不安全*的连接，我可以在配置文件中指定以下目标：

```
<SAP.Middleware.Connector>
    <ClientSettings>
      <DestinationConfiguration>
        <destinations>          
          <add NAME="MySAPName" USER="MyUser" PASSWD="orly" CLIENT="100" LANG="EN" ASHOST="mysapname.mydomain.com" SYSNR="70" MAX_POOL_SIZE="20" IDLE_TIMEOUT="10"/>          
        </destinations>
      </DestinationConfiguration>
    </ClientSettings>
</SAP.Middleware.Connector> 
```

但是，为了创建一个*安全*的SNC 连接，到目前为止，我只是想出了如何通过以编程方式配置目标来做到这一点，例如：

```
 Params.Add(RfcConfigParameters.AppServerHost, "mysapname.mydomain.com");
  Params.Add(RfcConfigParameters.Name, "MySAPName"); 
  Params.Add(RfcConfigParameters.SystemNumber, "70");                                              
  Params.Add(RfcConfigParameters.Language, "EN");
  Params.Add(RfcConfigParameters.Client, "100");
  Params.Add(RfcConfigParameters.User,"MyUser");
  Params.Add(RfcConfigParameters.Password, "orly");                    

  // Additional Params for SNC, not settable in config?
  Params.Add(RfcConfigParameters.SncMode, "8");                    
  Params.Add(RfcConfigParameters.SncPartnerName, "p:CN=RemovedForConfidentiality, OU=, O=, L=,C=GB");                                                            
  Params.Add(RfcConfigParameters.SncMyName, "p:CN=MyRemovedPartnerName, C=GB, O=, OU=");
  Params.Add(RfcConfigParameters.SncQOP, "8");
  Params.Add(RfcConfigParameters.Trace, "2"); 
```

因此，鉴于这种情况，我的问题是：我可以仅使用配置文件配置基于 SNC 的 SAP 目标吗？如果是这样，怎么做？

我意识到我可以将 SncPartnerName 等存储在 AppSettings 中，但如果可以在 DestinationConfiguration 部分指定它会更好。但是，我似乎找不到任何关于此的文档。我应该注意我知道 SAP SCN 网站，并且在那里查看过没有成果[，](http://help.sap.com/saphelp_crm700_ehp02/helpdata/EN/5b/617bcd479b46a1829ac0d7886903fb/content.htm)尽管我无法访问 SAP Service Marketplace。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T08:20:57.707

我的一位同事设法找到了解决方案。SNC 所需参数的示例配置文件如下：

```
<SAP.Middleware.Connector>
    <ClientSettings>
      <DestinationConfiguration>
        <destinations>          
          <add NAME="MySAPName" USER="MyUser" PASSWD="orly" CLIENT="100" LANG="EN"
                ASHOST="mysapname.mydomain.com" SYSNR="70" MAX_POOL_SIZE="20" IDLE_TIMEOUT="10"
                SNC_PARTNERNAME="p:CN=mycn.com, OU=A, O=B, L=C, C=GB" 
                SNC_MYNAME="p:CN=myname.com, C=GB, O=A, OU=B" 
                SNC_QOP="8" SNC_MODE="8" TRACE="2"/>          
        </destinations>
      </DestinationConfiguration>
    </ClientSettings>
</SAP.Middleware.Connector> 
```

# asp.net-mvc - MVC4 返回一个 Amazon S3 mp3 文件

> ID：16100164
> 
> 赞同：0
> 
> 时间：2013-04-19T08:13:11.640
> 
> 标签：asp.net-mvc, amazon-web-services, amazon-s3, download, mp3

我有一个包含大量 mp3 的网络应用程序可供下载。我在每个 mp3 旁边都有下载链接供下载。我想记录下载了哪些谈话，所以下载链接转到控制器操作。

```
public ActionResult DownloadTalk(int talkId) 
```

然后该操作调用一个存储库来增加该谈话已被下载。谈话存储在 Amazon S3 上，ACL 可以通过 URL 公开访问这些谈话内容。

我希望能够强制下载文件。目前我只是重定向到 url，这有时会导致文件被下载，有时会导致 mp3 文件在浏览器中打开（我不想要）。

```
 return Redirect(talk.Url); 
```

我知道如何`MemoryStream`使用 SDK 从 S3 获取媒体，但是如何根据`MemoryStream`url 或 url 强制下载（返回 FileActionResult）？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T16:31:07.637

```
public ActionResult DownloadTalk(int talkId)
{
    var talk = GetTalk(talkId);
    IncrementTalkCount(talk);
    var stream = GetStreamFromTalk(talk);
    return File(stream, "contentType", "fileName");
} 
```

# ruby-on-rails - 自定义回形针验证错误消息

> ID：16100171
> 
> 赞同：2
> 
> 时间：2013-04-19T08:13:36.103
> 
> 标签：ruby-on-rails, paperclip, paperclip-validation

我对内容类型进行了此验证：

```
validates_attachment_content_type :photo, :content_type => /^image\/(jpg|jpeg|pjpeg|png|x-png|gif)$/, :message => 'file type is not allowed (only jpeg/png/gif images)' 
```

我只想显示上面的消息，但它说

```
 Photos photo content type file type is not allowed (only jpeg/png/gif images) 
```

因为它是照片模型和附件照片。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:45:29.180

```
> Not a real solution but a Easy one is to skip paperclip validation and
> write custom one
>     validate :check_content_type
>     
>       def check_content_type
>        if !['image/jpeg', 'image/gif','image/png'].include?(self.image_content_type)
>         errors.add_to_base("File '#{self.image_file_name}' is not a valid image type") # or errors.add
>        end
>       end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-06T18:41:14.160

我参加这个聚会迟到了。

```
validates_attachment_size :image, :in => 0.megabytes..2.megabytes,  message: " is too large, try less than 2mb  or for help" 
```

让你：

应该让您离家更近，输出为：

“图像文件太大，请尝试小于 2mb”

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-04-19T08:56:02.710

您好，请 d 验证回形针 avtar 图像

```
attr_accessible :avatar

has_attached_file :avatar, :styles => { :small => "60x60>", :thumb => "60x60>" }

validates_attachment :avatar, :presence => true, 
:content_type => { :content_type => "image/jpg" }, 
:size => { :in => 0..1000.kilobytes } 
```

# mysql - 带有选定列的 Symfony 1.4 选择查询不起作用

> ID：16100173
> 
> 赞同：2
> 
> 时间：2013-04-19T08:13:56.537
> 
> 标签：mysql, sql, symfony1, doctrine, symfony-1.4

我想在 symfony 学说中运行以下查询。

```
SELECT p.id AS id FROM skiChaletPrice p WHERE ski_chalet_id = ? AND month = ? 
```

我写了我的学说查询如下。

```
 $q = Doctrine_Query::create()
                ->select('p.id AS id')
                ->from('skiChaletPrice p')
                ->andWhere('ski_chalet_id = ?', $chaletId)
                ->andWhere('month = ?', $from);      

 $result = $q->fetchOne();
 if ($result->count() > 0) {            
     return $result->toArray();
 } else {
     return null;
 } 
```

但我的结果总是包括表中的所有列。什么问题？请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:59:55.510

问题是`fetchOne()`它将返回一个 Doctrine 对象，该对象隐式包含表中的所有列。 `$result->toArray()`正在将该教义对象转换为数组，这就是您获得所有列的原因。

如果您只想要列的子集，请不要水合对象，而是执行以下操作：

```
$q = Doctrine_Query::create()
            ->select('p.id AS id')
            ->from('skiChaletPrice p')
            ->andWhere('ski_chalet_id = ?', $chaletId)
            ->andWhere('month = ?', $from);  

$results = $q->execute(array(), Doctrine::HYDRATE_SCALAR); 
```

见[http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/data-hydrators.html](http://docs.doctrine-project.org/projects/doctrine1/en/latest/en/manual/data-hydrators.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T09:34:30.663

我应该这样做：

```
$result = Doctrine_Query::create()
  ->select('id')
  ->from('skiChaletPrice')
  ->andWhere('ski_chalet_id = ?', $chaletId)
  ->andWhere('month = ?', $from)
  ->limit(1)
  ->fetchOne(array(), Doctrine_Core::HYDRATE_SINGLE_SCALAR); 

// result will be a single id or 0
return $result ?: 0;

// if you want array($id) or array() inseatd
// return (array) $result; 
```

# c++ - 警告 LNK4098：defaultlib 'mfc110u.lib' 与其他库的使用冲突

> ID：16100174
> 
> 赞同：1
> 
> 时间：2013-04-19T08:13:59.923
> 
> 标签：c++, visual-studio-2012, linker-warning

好吧，当我的项目使用多字节字符集时，我在链接使用 unicode 字符集编译的库时收到此警告。

```
1>LINK : warning LNK4098: defaultlib 'mfc110u.lib' conflicts with use of other libs; use /NODEFAULTLIB:library
1>LINK : warning LNK4098: defaultlib 'mfcs110u.lib' conflicts with use of other libs; use /NODEFAULTLIB:library 
```

（注意，不涉及其他库`msvcrt`等）我的问题是如何处理这个问题。我可以简单地忽略它还是必须添加 /NODEFAULTLIB:lib (mfc110u.lib 或 mfc110.lib???) 在任何情况下？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:57:39.077

有几个选项可用（同样适用于混合调试/发布库的类似警告）。

1）使用相同的项目规范重建所有内容，因此在您的情况下是多字节或 unicode

2) 保持一切原样，但要注意跨应用程序和使用不同运行时的库传递的数据。因此，您不会将任何内容传递给可以根据其他运行时错误处理的库。在调试/发布问题的情况下，这意味着例如您不释放（）或删除 [] 任何在库中分配的东西，反之亦然。如果库期望任何参数都是 unicode，那么在您的情况下，您应该采取措施提供正确的字符串到库函数。

# java - 将文本文件内容逐行存储到数组中

> ID：16100175
> 
> 赞同：13
> 
> 时间：2013-04-19T08:14:03.113
> 
> 标签：java, arrays

所有，我现在面临着不知道将文本文件中的内容存储到数组中的问题。情况就像，文本文件内容：

```
abc1
xyz2
rxy3 
```

我希望将它们逐行存储到数组中，这可能吗？我期望的是这样的：

```
arr[0] = abc1
arr[1] = xyz2
arr[2] = rxy3 
```

我尝试过这样的事情，但似乎不适合我。如果有人可以帮助我，真的非常感谢。

代码是：

```
BufferedReader in = new BufferedReader(new FileReader("path/of/text"));
        String str;

        while((str = in.readLine()) != null){
            String[] arr = str.split(" ");
            for(int i=0 ; i<str.length() ; i++){
                arr[i] = in.readLine();
            }
        } 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-19T08:16:22.620

我建议使用`ArrayList`处理动态大小的 ，而数组将需要预先定义的大小，您可能不知道。您始终可以将列表重新转换为数组。

```
BufferedReader in = new BufferedReader(new FileReader("path/of/text"));
String str;

List<String> list = new ArrayList<String>();
while((str = in.readLine()) != null){
    list.add(str);
}

String[] stringArr = list.toArray(new String[0]); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-19T08:21:14.950

最简单的解决方案：

```
List<String> list = Files.readAllLines(Paths.get("path/of/text"), StandardCharsets.UTF_8);
String[] a = list.toArray(new String[list.size()]); 
```

请注意，java.nio.file.Files 是从 1.7 开始的

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T08:20:23.703

这应该有效，因为它使用 List 因为您不知道文件中有多少行，而且它们以后可能会更改。

```
BufferedReader in = new BufferedReader(new FileReader("path/of/text"));
String str=null;
ArrayList<String> lines = new ArrayList<String>();
while((str = in.readLine()) != null){
    lines.add(str);
}
String[] linesArray = lines.toArray(new String[lines.size()]); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-11T07:18:47.323

# 爪哇8：

```
Files.lines(new File("/home/abdennour/path/to/file.txt").toPath()).collect(Collectors.toList()); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-19T08:17:15.147

你需要为你的情况做这样的事情： -

```
int i = 0;
while((str = in.readLine()) != null){
    arr[i] = str;
    i++;
} 
```

但请注意，`arr`应根据文件中的条目数正确声明 。

**建议：-**改用 a `List`（查看**@Kevin Bowersox**的帖子）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-19T08:20:27.583

只需使用[Apache Commons IO](http://commons.apache.org/proper/commons-io/)

```
List<String> lines = IOUtils.readLines(new FileInputStream("path/of/text")); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-19T08:17:57.553

当您将`str = in.readLine()) != null`一行读入`str`变量时，如果它不为空，则执行该`while`块。您无需再阅读`arr[i] = in.readLine();`. 当您不知道输入文件的确切大小（行数）时，也可以使用列表而不是数组。

```
BufferedReader in = new BufferedReader(new FileReader("path/of/text"));
String str;

List<String> output = new LinkedList<String>();

while((str = in.readLine()) != null){
    output.add(str);
}

String[] arr = output.toArray(new String[output.size()]); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-19T08:16:38.163

尝试这个：

```
String[] arr = new String[3];// if size is fixed otherwise use ArrayList.
int i=0;
while((str = in.readLine()) != null)          
    arr[i++] = str;

System.out.println(Arrays.toString(arr)); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-11-23T09:16:52.790

您可以使用此完整代码来解决您的问题。有关更多详细信息，您可以在[appucoder.com上查看](http://www.appucoder.com)

```
class FileDemoTwo{
    public static void main(String args[])throws Exception{
        FileDemoTwo ob = new FileDemoTwo();
        BufferedReader in = new BufferedReader(new FileReader("read.txt"));
        String str;
        List<String> list = new ArrayList<String>();
        while((str =in.readLine()) != null ){
            list.add(str);
        }
        String[] stringArr = list.toArray(new String[0]);
        System.out.println(" "+Arrays.toString(stringArr)); 
    }

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-19T12:29:13.303

建议为此使用 Apache IOUtils.readLines。请参阅下面的链接。

[http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html](http://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/IOUtils.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-26T11:26:37.923

您可以使用此代码。这工作非常快！

```
public String[] loadFileToArray(String fileName) throws IOException {
    String s = new String(Files.readAllBytes(Paths.get(fileName)));
    return Arrays.stream(s.split("\n")).toArray(String[]::new);
} 
```

# c++ - boost::signals::scoped_connection 在 std::vector 中不起作用。为什么？

> ID：16100180
> 
> 赞同：2
> 
> 时间：2013-04-19T08:14:17.460
> 
> 标签：c++, boost, boost-signals

据我了解，`scoped_connection`s 旨在在超出范围时自动断开连接，而不是之前。我发现当 scoped_connection 处于其中时，这不能正常工作`std::vector`（并且对于其他容器也可能失败）。

例如。

```
using boost::signals::scoped_connection; // just for readability
boost::signal<void ()> sig;
std::vector<scoped_connection> connection_vec;

connection_vec.push_back(sig.connect(foo));
assert(connection_vec.back().connected()); // this assertion fails! 
```

我已经通过声称`std::vector`要求元素可复制而不可复制来解释这`scoped_connection`一点 - 但这并不完全正确。`std::vector`只要求元素是*可移动*的。（我希望`scoped_connection`应该是可移动的。）

例如，以下代码有效：

```
std::vector<std::unique_ptr<scoped_connection>> vec2;
// Note that std::unique_ptr is uncopyable, but moveable

vec2.push_back(std::unique_ptr<scoped_connection>(new scoped_connection(sig.connect(foo))));
assert((*vec2.back()).connected()); // this assertion succeeds! 
```

此外，如果问题是由于`std::vector`试图复制不可复制的东西，那不应该产生编译错误吗？

所以我想知道`scoped_connection`在 a 中不能正常工作的实际原因是什么`vector`，这是一个可以在 boost.xml 中解决的问题吗？

（我在 gcc 版本 4.8.0 和 boost 版本 1.53.0 上对此进行了测试。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:16:06.593

[scoped_connection](http://www.boost.org/doc/libs/1_53_0/doc/html/boost/signals2/scoped_connection.html)没有移动构造函数（还）。所以它不像你想象的那样是可移动的，而是`std::move`会回退到复制。正如你提到的，你不能复制一个`scoped_connection`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:22:24.397

您需要使用`emplace_back`,`push_back`副本。

# spring - 如何在 Spring 3 (MVC) 中为 JAXB2 支持添加自定义 ContentHander？

> ID：16100181
> 
> 赞同：0
> 
> 时间：2013-04-19T08:14:20.433
> 
> 标签：spring, spring-mvc, marshalling, cdata, jaxb2

场景：我有一个使用 Spring 3 MVC 的 Web 应用程序。使用 Spring 3 中强大的新注释（@Controller、@ResponseBody 等），我编写了一些带有 @XML 注释的域对象，用于编组对 Web 客户端的 ajax 调用。一切都很好。我声明我的 Controller 类有一个带有根 XML 对象的返回类型 @ResponseBody - 有效负载被正确编组并发送到客户端。

问题是内容中的某些数据违反了 XML 合规性。必要时我需要用 CDATA 包装它。我在这里看到一个 POST [How to generate CDATA block using JAXB?](https://stackoverflow.com/questions/3136375/how-to-generate-cdata-block-using-jaxb) 建议使用自定义内容处理程序。好的，太棒了！

```
public class CDataContentHandler extends (SAXHandler|XMLSerializer|Other...) {
 // see http://www.w3.org/TR/xml/#syntax
 private static final Pattern XML_CHARS = Pattern.compile("[<>&]");

 public void characters(char[] ch, int start, int length) throws SAXException {
     boolean useCData = XML_CHARS.matcher(new String(c,start,length)).find();
     if (useCData) super.startCDATA();
       super.characters(ch, start, length);
     if (useCData) super.endCDATA();
 }

} 
```

使用 Spring MVC 3，我该如何实现？关于设置的 JAXB 方面，一切都是“自动”为我完成的，Spring 读取方法的返回类型，查看返回类型的注释并从类路径中提取 JAXB2 来进行编组（对象到 XML转换）。那么允许用户将自定义内容处理程序注册到配置的“钩子”到底在哪里？

使用 EclipseLink JAXB 实现就像将 @XmlCDATA 添加到相关的对象属性一样简单。Spring 是否有一些聪明的方法可以在这里提供帮助/将这个问题抽象为一个小的配置细节？

我知道 Spring 不依赖于任何特定的实现，但是为了这个问题，我们可以假设我使用的是默认实现。我在这里尝试了文档[http://static.springsource.org/spring-ws/site/reference/html/oxm.html](http://static.springsource.org/spring-ws/site/reference/html/oxm.html)但据我所知，它对这个问题几乎没有帮助。

感谢大家的任何回复，非常感谢。

## 更新：

感谢 Akshay 下面的建议答案。这足以让我走上正轨。进一步调查，我发现在 Spring 版本 3.05 和 3.2 之间有一些历史。在 Spring 3.05 中，注册自定义 MessageConverter 曾经非常困难（这确实是这里的目标）。

这段对话几乎解释了所要求的开发更改背后的想法： [https ://jira.springsource.org/browse/SPR-7504](https://jira.springsource.org/browse/SPR-7504)

这是构建自定义解决方案通常需要的类覆盖的链接：http://static.springsource.org/spring/docs/3.1.0.M1/javadoc-api/org/springframework/http/converter/AbstractHttpMessageConverter [。 html](http://static.springsource.org/spring/docs/3.1.0.M1/javadoc-api/org/springframework/http/converter/AbstractHttpMessageConverter.html)

以下关于堆栈溢出的问题与我所要求的非常相似（除了@ResponseBody 讨论与 JSON 和杰克逊有关） - 目标基本相同。

[Spring 3.2 和 Jackson 2：添加自定义对象映射器](https://stackoverflow.com/questions/14363555/spring-3-2-and-jackson-2-add-custom-object-mapper)

所以它看起来像使用，并且需要覆盖 MarshallingHttpMessageConverter，注册到 AnnotationMethodHandlerAdapter。上面的链接中有一个推荐的解决方案，也可以巧妙地使用这些东西并将整个东西包装在自定义定义的注释后面。

我还没有开发出一个可行的解决方案，但是自从我提出问题以来，我想至少发布一些可以帮助其他人解决同样问题的东西，然后开始。恕我直言，尽管在 Spring 3.2 中这一切都得到了改善，但要进行一些定制工作仍然有点像狗吃晚饭......我真的期待一个班轮配置更改等。

而不是扭曲和弯曲 Spring，对于我的特定问题，也许最简单的答案就是更改 JAXB2 实现并使用可以开箱即用的 Eclipse Link JAXB 之类的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:15:15.573

基本上你需要创建一个自定义的 HttpMessageConverter。而不是依赖 spring 默认使用的 Jaxb2RootElementHttpMessageConverter。

不幸的是，定制一个转换器意味着您告诉 spring 您将负责加载您需要的所有转换器！根据您是否使用注释、组件扫描、Spring 3.1 或更早版本等，这相当复杂并且可能会变得复杂。如何添加自定义转换器的问题在这里解决：[使用 @ResponseBody 自定义 HttpMessageConverter 来做 Json 事情](https://stackoverflow.com/questions/5019162/custom-httpmessageconverter-with-responsebody-to-do-json-things)

在您的自定义消息转换器中，您可以自由使用任何自定义 JAXB2 内容处理程序。

解决原始问题的另一种更简单的方法是使用自定义`XmlJavaTypeAdapter`. 创建一个自定义实现`javax.xml.bind.annotation.adapters.XmlAdapter`来处理 CDATA，在`marshal`方法中用 cdata 大括号包装返回值。然后在您映射的 pojo 中，使用`XmlAdapter`注释，将您的自定义适配器的类传递给它，您应该完成。

我自己没有实现适配器方法，所以无法提供示例代码。但它应该可以工作，而且工作量不会很大。

希望这可以帮助。

# image - Plone Kupu 中的图像模糊

> ID：16100192
> 
> 赞同：0
> 
> 时间：2013-04-19T08:15:00.183
> 
> 标签：image, plone, plone-3.x

我使用 Plone3 中的 Kupu 编辑器在网站中插入图像，自动缩放图像，并使用指向原始图像的链接制作更小的拇指。

这是我们如何做到这一点的教程：http: [//www.contentmanagementsoftware.info/plone-book/kupu/insert-image-properties/index_html](http://www.contentmanagementsoftware.info/plone-book/kupu/insert-image-properties/index_html)

Kupu 创建了一个新的缩放图像（不仅用 css 缩放，而且真实地缩放它），结果是图像变得有点模糊。我不知道这个问题是否与[这个文件](http://plone.org/documentation/kb/resizing-images-in-kupu)有关。

**我想到了这个问题。**有没有人也发现这个问题？有什么办法可以解决吗？

我认为获得高质量图像的唯一方法是使用 Photoshop 或某些图形编辑器手动缩放它们。但似乎 Kupu 不允许这样做。您必须吞下它的举止并上传其自行生成的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:57:01.857

好吧，有点过于本地化，但我们发现了主要错误。我想回应，以防任何用户处于同样的情况......

Kupu 将图像缩放到一定的宽度和高度。后来，css 又重新缩放了一点，使图像变得模糊。

这是主要问题，我们缩小了图像，然后在浏览器端再次放大。直到现在我们才注意到 kupu 实现背后有 css 并且“覆盖”（可以这么说）我们的配置。

# php - 如何在 PHP 标头（位置：）请求中获取“#”符号

> ID：16100193
> 
> 赞同：-3
> 
> 时间：2013-04-19T08:15:08.703
> 
> 标签：php, html, forms

嗨，我正在尝试使用本教程在我的网站上实现一个简单的联系表单 - [http://rosstanner.co.uk/2012/11/build-simple-contact-form-html-php-bootstrap/](http://rosstanner.co.uk/2012/11/build-simple-contact-form-html-php-bootstrap/)

问题是在用户提交操作后，我需要将用户重定向到页面底部的锚点 ID，即 www.somepage.com/index.php#contact

重定向是这样的...

```
header('Location: index.php?s='.urlencode('Thank you for your message.')) 
```

我试过了...

```
header('Location: index.php?s='.urlencode('Thank you for your message.')'#contact') 
```

……但无济于事。

当我尝试添加类似这样的内容以使其向下滚动到锚书签时，浏览器会挂在 contact-form-submission.php 页面上（联系表单逻辑的单独 php 页面）

很抱歉，如果我解释得很复杂。我实际上不知道PHP！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T08:23:23.113

正确的语法是这样的：

```
header('Location: index.php?s=' . urlencode('Thank you for your message.') . '#contact'); 
```

# ios - 如何在 iOS 中查找位置区号

> ID：16100201
> 
> 赞同：0
> 
> 时间：2013-04-19T08:15:26.597
> 
> 标签：ios, core-telephony

我需要在 iOS 中获取手机信号塔的 LAC。我知道我们可以在 FieldTest 模式下获得 MCC 和 MNC。CTCarrier 也提供 MCC 和 MNC。VAFieldTest ( [http://github.com/valexa/VAFieldTest](http://github.com/valexa/VAFieldTest) ) 也为我们提供了 CellId。

如何在 iOS 中获取 LAC。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:24:59.283

如果您发布了您的应用程序，Apple 将不会接受它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:18:54.500

Apple 不提供任何公共 API 来执行此操作。

# python - Accessing specific value in a list of values

> ID：16100204
> 
> 赞同：1
> 
> 时间：2013-04-19T08:15:36.257
> 
> 标签：python, object, dictionary, valuestack

I have a dictionary that looks like:

```
{'153':  |T-shirt| |200| |0| |0|, '764': |Jeans| |350| |0| |0|, '334': |Hatt| |59| |0|   |0|, '324': |Skor| |250| |0| |0|, '234': |Tröja| |300| |0| |0|, '543': |Jacka| |400| |0| |0|} 
```

This means that I for example have a key that looks like 153, which access a value of:

```
|T-shirt| |200| |0| |0| 
```

What if I would like to do is access 1 of the parts in my value. For exampel, if i type 153 and get|T-shirt| |200| |0| |0|, how then to access the part 200 in my value? If my dict value is: |T-shirt| |200| |0| |0|, i want only to get: 200, bot any of the other parts of the same value. All of my dict values are objects for the class wares, which means that each part that is enclosed by "||" is a attribute.

for exampel:

```
|T-shirt| |200| |0| |0|. 
```

Were T-shirt is a self.name attribute, 200 is a self.price attribute, 0(1st one) is a self.quantity and 0(2nd one) is a self.bought attribute.

I only want to access the self.price attribute, how do I do it? I tried indexing my object like:

```
x = wares[T-shirt, 200, 0, 0]
b = x[1]
print(b) 
```

but python says that:

```
"object can not be indexed" 
```

any one got a tip?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:21:03.957

```
>>> import re
>>> d= {'153':  '|T-shirt| |200| |0| |0|', '764': '|Jeans| |350| |0| |0|', '334': '|Hatt| |59| |0|   |0|', '324': '|Skor| |250| |0| |0|', '234': '|Tröja| |300| |0| |0|', '543': '|Jacka| |400| |0| |0|'}
>>> def parts(s):
        return re.findall(r'\|([^\|]+)\|', s) 
```

or since regex is evil I would recommend:

```
>>> def parts(s):
        return [x.strip('|') for x in s.split()]    

>>> parts(d['153'])
['T-shirt', '200', '0', '0']
>>> parts(d['153'])[1]
'200' 
```

Alternatively you could make things much easier and more readable by making `parts` return a dictionary:

```
>>> def parts(s):
       return dict(zip(('name', 'price', 'quantity', 'bought'), [x.strip('|') for x in s.split()]))

>>> parts(d['153'])['price']
'200' 
```

Actually we could make this even better using `collections.namedtuple`

```
>>> from collections import namedtuple
>>> def parts(s):
        Item = namedtuple('Item', ('name', 'price', 'quantity', 'bought'))
        return Item(*[x.strip('|') for x in s.split()])

>>> parts(d['153'])
Item(name='T-shirt', price='200', quantity='0', bought='0')
>>> parts(d['153']).price
'200' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:33:27.953

```
>>> print dict
{'153': ['T-shirt', '200', '0', '0'], '334': ['Hatt', '59', '0', '0'], '764': ['Jeans', '350', '0', '0'], '543': ['Jacka', '400', '0', '0'], '324': ['Skor', '250', '0', '0'], '234': ['Tr\xc3\xb6ja ', '300', '0', '0']}
>>> dict['153'][1]
'200'
>>> 
```

# django - 如何使用 django-south 进行迁移

> ID：16100206
> 
> 赞同：0
> 
> 时间：2013-04-19T08:15:49.883
> 
> 标签：django, django-south, database-migration

我正在开发的应用程序开始需要迁移数据库模式。我考虑过 django-south，但由于我对这种东西没有经验，所以我有点迷茫，这就是我的情况：

开发代码：最新模型，我没有跟踪我对模型所做的更改。

生产代码：运行代码，有旧模型。我们已经配置了服务器，因此我们可以使用 git pull 进行部署：）

如何在不破坏任何内容的情况下更新生产（和数据库）中的代码？我看到了该`--initial`声明，但我认为它不适用于这种情况，也不适用`convert_to_south`于伪造移民历史，但我仍然不知道该怎么办。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:27:06.727

Imo 最好为您的项目创建版本控制并使用类似[Fabric](http://lethain.com/deploying-django-with-fabric/)的东西进行部署。这将很好地包含您的生产环境。

south 没有什么神奇之处，只需将 south 添加到已安装的应用程序设置中并运行初始架构迁移，然后运行假迁移 ( `migrate <app_name> --fake`)，这样 south“知道”模型的当前状态。在未来的版本（包含架构更改）中，您可以运行`schemamigration <app_name> --auto`并`migrate <app_name>`相应地更新模型。

要将迁移保存在一个地方，请使用设置文件中的迁移设置：

```
SOUTH_MIGRATION_MODULES = {
    'app_name_1': 'project_name.migrations.page',
    'app_name_2': 'project_name.migrations.medialibrary',
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T14:47:44.740

您必须检查生产版本（以使模型恢复生产状态），创建初始迁移，将该迁移复制到您当前的开发分支，然后创建架构迁移。

# node.js - 在 mongodb 中查找嵌入文档？

> ID：16100210
> 
> 赞同：0
> 
> 时间：2013-04-19T08:15:50.720
> 
> 标签：node.js, mongodb

我的收藏是这样的

```
{
  "name":""
  "type":""
  "arr":[
   {
     "type":""
     "other field"
     ...
   },
  {
     "type":""
     "other field"
     ...
   }
} 
```

我的条件是输入参数是名称。所以基于名称我必须获取文档，另外一个条件是数组外部和内部的类型应该匹配..需要单独获取这些记录..如何实现这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T11:35:30.880

性能不佳，但可以正常工作（[http://docs.mongodb.org/manual/reference/operator/where](http://docs.mongodb.org/manual/reference/operator/where)）

```
db.SOME_COLLECTION.find({
  name:'SOME_VALUE', 
  $where: 
    function() {
      for(var i = 0; i < obj.arr.length; i++) {
        if(obj.arr[i].type==obj.type) {
          return obj
        }
      }
    }
  }
) 
```

ps 聚合框架已经解决了类比问题，但是在这种情况下，恕我直言，只有 $where 子句可用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T11:03:21.540

如果我对您的理解正确，这就是您获得所需结果的方式

```
{name:"",type:"",arr.type:""} 
```

您可以输入所需的值，它将返回所有匹配的记录。

# monitoring - Nagios 返回状态未知

> ID：16100215
> 
> 赞同：0
> 
> 时间：2013-04-19T08:16:05.450
> 
> 标签：monitoring, status, nagios, tivoli

我在 CentOS 上安装 Nagios 来监控一些服务器，其中一个是 TSM 服务器。

当我在命令行中执行它时，我下载了一个用 bash 编写的插件。

```
/usr/lib64/nagios/plugins/check_tsm db -v6
db - database utilization 42%, OK 
```

批处理脚本的返回码为 0（来自命令`echo $?`）

所以脚本工作正常，返回 0 表示在 nagios 中状态良好，但状态仍然未知，我真的不知道为什么。

我检查了nagios等中的日志。这不是commands.cfg中的命令定义或服务声明的问题，因为我复制了nagios每5分钟自动发送一次的命令，并且该命令在命令行中运行良好，但仍然不知道地位。

命令定义：

定义命令{

```
 command_name check_tsm_v6

    command_line /usr/lib64/nagios/plugins/check_tsm $ARG1$ -v6 $ARG2$ $ARG3$

    } 
```

服务声明：

定义服务{

```
 use generic-service 

    host_name        tsm-test

    service_description database utilization

    check_command check_tsm_v6!db!85!90
    } 
```

这[是](http://thobias.org/tsm/tsmmonitor/tsmmonitor)bash 脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T10:21:55.317

过去使用 Nagios 脚本引起我注意的一件事是用户权限。直接在命令行上测试脚本时，请确保在其前面加上：

```
sudo -u nagios 
```

所以你的将是：

```
sudo -u nagios /usr/lib64/nagios/plugins/check_tsm db -v6 
```

这假设您的 nagios 实例正在由 nagios 用户运行，这是一个相当安全的选择。

祝你好运

布拉德

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-21T12:13:42.363

尝试使用 yum install sysstat -y 命令下载软件包。

如果它有效，那就太好了。如果您仍然面临同样的问题，请上传浏览器中显示的完整错误？

# javascript - jquery 插件设置 this 的值

> ID：16100217
> 
> 赞同：0
> 
> 时间：2013-04-19T08:16:20.060
> 
> 标签：javascript, jquery, css, plugins

我正在创建星级评分框...我的 php 页面如下

```
<html>
<head>
  <script src='jquery.js'></script>
  <script src='alamStars.js'></script>
  <script>
    $().ready(function(){
       $("#txtStar").alamStar();
    });
  </script>

</head>
<body>
<?php
 if(isset($_GET[]))
 {
   echo $_GET['txtStar'];
 }
?>
 <form>
  <input type='text' name='txtStar' id='txtStar'>
  <input type='submit'>
 </form>
</body>
</html> 
```

我的插件代码如下

```
;(function ($) {
  $.fn.alamStar = function (options) {       
    var defaultVal = {
        img: '../images/start_rating.png',
        width: 105,
        height: 120
    }; //end array of default values

    var obj = $.extend(defaultVal, options);//overwrite default values if there
    this.after("<div id='alamStarBox' stars='"+this.val()+"'></div>");//dynamically create div
    var alamStarBox=$("#alamStarBox");//assign alamStarBox to a variable
    alamStarBox.html(this.val());//set initial value from textbox

    alamStarBox.css({
        'color'             :   'red',
        'background-image'  :   'url('+obj.img+')',
        'max-width'         :   obj.width+"px",
        'max-height'        :   obj.height+"px",
        'overflow'          :   'hidden'
    });//end styling css to alamStarBox

    alamStarBox.mousemove(function(e){
    var l=alamStarBox.offset().left;//Left value of alaStarBox
    var c=parseInt(e.pageX)+21;//current-position

    if(c>(parseInt(l)+parseInt(10)))
    {
        $(this).html("0");
        $(this).css('background-position-Y','0px');
    }
    if(c>(parseInt(l)+parseInt(30)))
    {
        $(this).html("1");
        $(this).css('background-position-Y','-20px');
    }
    if(c>(parseInt(l)+parseInt(50)))
    {
        $(this).html("2");
        $(this).css('background-position-Y','-40px');
    }
    if(c>(parseInt(l)+parseInt(70)))
    {
        $(this).html("3");
        $(this).css('background-positionY','-60px');
    }
    if(c>(parseInt(l)+parseInt(90)))
    {
        $(this).html("4");
        $(this).css('background-positionY','-80px');
    }
    if(c>(parseInt(l)+parseInt(110)))
    {
        $(this).html("5");
        $(this).css('background-positionY','-100px');
    }
});//end moue move function

alamStarBox.mouseout(function(){
    var p=parseInt($(this).attr("stars"))*20;
    $(this).css('background-positionY','-'+p+'px');
    $(this).html($(this).attr("stars"));
});//end function alamStarBox mouseOut

alamStarBox.click(function(){
    $(this).attr("stars",$(this).text());
});//end function alamStarBox click

var frm=this.closest("form");
frm.submit(function(){
    this.val(alamStarBox.text());//on submit form copy text from starbox to textBox
    //////////////////////////////////the above line is not working////////////////
});

 };//end alamStar function
})(jQuery); 
```

我想在名为 frm.submit 的最后一个函数中将文本框值设置为等于 div 文本，
但即使将其分配为静态字符串（如“静态值”）也无法正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:20:26.227

您必须将父函数中的副本保存`this`到另一个变量中，然后您可以在回调函数中引用该变量，如下所示：

```
var self = this;
var frm = this.closest("form");
frm.submit(function(){
    self.val(alamStarBox.text());  //on submit form copy text from starbox to textBox
}); 
```

发生这种情况是因为在提交回调函数内部`this`会有不同的值（很可能是表单 DOM 对象）。使用名为`self`or`that`的局部变量`me`是一种非常常见的设计模式，允许在本地回调函数中引用原始对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:21:04.573

`.submit`您正在表单的 jQuery 方法上使用回调，因此`this`很可能不是您认为的那样（将其记录到控制台以查看实际情况）。

Even`$(this)`在这里不起作用，因为那将是表单本身——调用`.val()`它是没有意义的。

在此函数中明确选择输入字段，然后它应该可以工作：`$("#txtStar").val(…)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:41:55.130

您可以使用 jfriend00 的建议，也可以使用 $.proxy() 将提交处理程序的范围更改为原始“this”值。

```
frm.submit($.proxy(function(){
    this.val(alamStarBox.text());   // NOW this=your textbox #txtStar
}, this)); 
```

# android - 从我的应用启动另一个应用

> ID：16100225
> 
> 赞同：0
> 
> 时间：2013-04-19T08:16:47.580
> 
> 标签：android, android-intent, android-activity, vlc

我想从我当前的活动中启动 Wondershare 播放器，并使其（ Wondershare 播放器）使用一些传递的参数（通过调用）作为流 url。

[我在https://github.com/rauljim/tgs-android/blob/integrate_record/src/com/tudelft/triblerdroid/first/VideoPlayerActivity.java#L211](https://github.com/rauljim/tgs-android/blob/integrate_record/src/com/tudelft/triblerdroid/first/VideoPlayerActivity.java#L211)找到了一些使用 VLC 而不是 Wondershare 的示例， 但我无法部署它就我而言。

我感谢您的帮助。

BR

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:20:22.177

请阅读这篇 Stack Overflow 帖子，其中详细说明了从其他应用程序启动活动：

[从您自己的（意图）打开另一个应用程序](https://stackoverflow.com/questions/2780102/open-another-application-from-your-own-intent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:19:25.003

```
 Intent LaunchIntent = getPackageManager().getLaunchIntentForPackage("com.tudelft.triblerdroid.first");
//put your extras here into Intent
    startActivity(LaunchIntent); 
```

# artificial-intelligence - 当蒙特卡洛树搜索达到内存限制时该怎么办

> ID：16100226
> 
> 赞同：7
> 
> 时间：2013-04-19T08:16:51.397
> 
> 标签：artificial-intelligence, montecarlo

我最近对游戏中应用的蒙特卡罗树搜索产生了兴趣。

我读过几篇论文，但我使用 Chaslot, G 的博士论文“蒙特卡洛树搜索”，因为我发现它更容易理解蒙特卡洛树搜索的基础知识

我试图对其进行编码，并坚持某些问题。该算法试图为每一个模拟将一个节点扩展到游戏树中。这很快升级为内存问题。我已经快速阅读了这篇论文，但它似乎没有解释如果该技术达到一定的内存限制会做什么。

如果该技术达到一定的内存限制，您能否建议该技术应该做什么？

你可以在这里看到这篇论文： [http ://www.unimaas.nl/games/files/phd/Chaslot_thesis.pdf](http://www.unimaas.nl/games/files/phd/Chaslot_thesis.pdf)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-27T05:49:27.340

One very effective approach is to grow the tree more slowly. That is, instead of expanding the tree every time you reach a leaf node, you expand it once it has at least *k* visits. This will significantly slow the growth of the tree, and often does not reduce performance. I was told by one of the authors of the Fuego Go program that he tried the approach, and it worked well in practice.

This idea was originally described in this paper:

Remi Coulom. Efficient selectivity and backup operators in monte-carlo tree search. In Computers and games, pages 72–83\. Springer, 2007.

It was also used in:

Max Roschke and Nathan Sturtevant. UCT Enhancements in Chinese Checkers Using an Endgame Database, IJCAI Workshop on Computer Games, 2013.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-04-22T10:09:21.493

论文[Memory Bounded Monte Carlo Tree Search](http://mcts.ai/edpowley/papers/powley_aiide17.pdf)评估了该问题的各种解决方案：

*   **停止**：当你达到内存限制时停止算法
*   **发育迟缓**：当你达到内存限制时，你停止生长树（但继续更新它）
*   **合奏**：当您达到内存限制时，您保留结果并从空树重新开始搜索（最后融合结果）
*   **扁平化**：当你达到内存限制时，你会摆脱除根及其直接子节点之外的所有节点，并从这个新的基础重新开始搜索
*   **垃圾收集**：当您达到内存限制时，您将删除所有未访问过给定次数的节点
*   **回收**：添加节点时，删除最长时间未访问的节点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:14:59.710

您可以丢弃访问次数小于最近未访问的某个阈值的所有节点（之前的播放次数）。这是一个快速但不高效的解决方案。最好也实施渐进式扩大。

# c - 如何从 Eclipse 中运行脚本

> ID：16100229
> 
> 赞同：0
> 
> 时间：2013-04-19T08:16:58.310
> 
> 标签：c, linux, eclipse, makefile, automake

我有一个不使用 autotools 的项目，但有一个 Makefile 我运行它来构建代码。这个 make 文件在 shell 脚本中运行。我已经在 Eclipse 中导入了该项目，但我似乎无法运行 shell 脚本（类似于 Ctrl + B 来制作或添加制作目标之一，即全部制作或制作安装）。

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:07:17.943

*您可以在Project Properties -> C/C++ Build -> Build Command -> Builder Settings*中指定一个脚本来构建您的项目。

您可以取消选中*使用默认构建命令*并指定您的（例如`make all`，`make install`或`bash make_all.sh`）。或者您可以保留默认的构建命令（必须是`make`）并在选项卡*行为*中指定目标。

但在你应该已经导入你的项目*Makefile Project with Existing Code*之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:26:24.307

如果您在同一个项目中使用 Make 工具，请不要使用 Eclipse。Eclipse 为您带来了一些用于项目编译等的工具，这些工具已经在 Make/Automake 中拥有。

# mysql - 为什么 Mysql 匹配布尔模式找不到“知道”

> ID：16100231
> 
> 赞同：2
> 
> 时间：2013-04-19T08:17:06.173
> 
> 标签：mysql, full-text-search

我有这两个查询

```
SELECT * FROM `foo` WHERE  MATCH(`title`) AGAINST('knows' in boolean mode )

SELECT * FROM `foo` WHERE  MATCH(`title`) AGAINST('woman' in boolean mode ) 
```

在表中我有一排`title = "a woman knows"`

第一个查询找到该行，但第二个没有！我尝试了不同的替代方案 - 例如，如果标题包含“a woman knots”，那么查询与“knots”匹配的作品

我很困惑，因此欢迎您提供任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:22:46.473

“知道”是一个[停用词](https://dev.mysql.com/doc/refman/5.5/en/fulltext-stopwords.html)，不会被索引（因此在所有搜索中都会被忽略）。[您可以使用ft_stopword_file](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_ft_stopword_file)服务器选项加载您自己的停用词列表。

# java - 更改组合中子项的优先级

> ID：16100239
> 
> 赞同：0
> 
> 时间：2013-04-19T08:17:46.083
> 
> 标签：java, swt

我有一个`Composite`名为 display 的子元素放置在绝对布局中。在我的整个程序中，这些孩子可以在合成物上四处走动并重叠。我想创建一个“优先级”，以便我可以选择将哪些子元素绘制在其他元素之上。孩子是我创建的一个自定义类`Llama`，它扩展了`Canvas`。我有一个整数字段来存储它们的优先级，但我不知道如何让它们按照我希望它们显示的顺序显示（基于整数字段）。这是显示我所说的重叠的程序的图像。

![在此处输入图像描述](https://i.stack.imgur.com/tFaVe.png)

基本上，他们会根据添加到合成中的顺序自动选择显示顺序（据我所知）。如何更改该顺序以适合我的优先领域？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:46:57.600

你需要[`Control.moveAbove()`](http://help.eclipse.org/helios/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/Control.html)和`moveBelow()`。

# java - ColumLabelProvider 中的 getImage 不再处理异常

> ID：16100240
> 
> 赞同：0
> 
> 时间：2013-04-19T08:17:50.320
> 
> 标签：java, swt, eclipse-rcp, jface

我知道还有其他几个线程在讨论 SWT 关于 No More Handles 错误，例如[SWT No More Handles](https://stackoverflow.com/questions/2018553/swt-no-more-handles)。

`ColumnLabelProvider`但是，当我使用 a for a使用该方法`TableViewer`为表的每个列提供图像时，我遇到了一个问题。`ColumnLabelProvider.getImage()`

当我加载包含大量数据（例如，8000 列）的表时，就会出现问题。

我将不同的图像（在我的例子中只有两个）实例化为包含 的 View 类的静态属性，`TableViewer`以避免同一图像的 8000 个实例：

```
private static Image FAILURE_IMAGE = UIPlugin.imageDescriptorFromPlugin(
        Activator.PLUGIN_ID, "/icons/failure.gif").createImage();

/** {@link Image} used to display a test case as run successfully. */
private static Image OK_IMAGE = UIPlugin.imageDescriptorFromPlugin(
        Activator.PLUGIN_ID, "/icons/ok.gif").createImage(); 
```

在 ColumnLabelProvider 我只是返回这些图像：

```
public Image getImage(Object element) {
    if (ok)
        return FAILURE_IMAGE;
    else
        return OK_IMAGE;
} 
```

但是，我收到 No More Handles 错误。

我做错什么了吗？将图像创建为静态字段的代码是错误的还是错误的？SWT 不应该能够显示带有图标的 8000 列的表格。

# jsf - 操作方法在 p:menuitem 中不起作用

> ID：16100247
> 
> 赞同：4
> 
> 时间：2013-04-19T08:18:07.710
> 
> 标签：jsf, jsf-2, primefaces

操作方法在我的`<p:menuitem>`. 我想`activeIndex`通过`<p:menuitem>`.

下面的代码是我的页面中使用的模板页面上的代码：

```
<h:form>
    <p:tabMenu activeIndex="#{loginBean.activeindex}">  
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star" />
        <p:menuitem value="Fabricants" url="/pagess/pagesFabricant/Fabricant.jsf" icon="ui-icon-wrench"   action="#{loginBean.Dirige(1)}" /> 
        <p:menuitem value="Composants" url="/pagess/pagesComposant/Composant.jsf" icon="ui-icon-search"  action="#{loginBean.Dirige(2)}"/> 
        <p:menuitem value="Dossier d'equivalence" url="DEQ.jsf" icon="ui-icon-document" action="#{loginBean.Dirige(3)}"/> 
    </p:tabMenu> 
</h:form> 
```

这是我的豆子：

```
public class LoginBean {

    private int activeindex;

    public int getActiveindex() {
    return activeindex;
    }

    public void setActiveindex(int activeindex) {
        this.activeindex = activeindex;
    }  

   public void Dirige(int a){
       setActiveindex(a);
   }
} 
```

当我单击任何菜单项时，不会调用操作方法。我做了一些调试以确保不调用该方法。或者，该方法正在使用`<p:commandButton>`.

* * *

这是模板

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
              "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml"
          xmlns:h="http://java.sun.com/jsf/html"
          xmlns:ui="http://java.sun.com/jsf/facelets"
          xmlns:p="http://primefaces.org/ui">

    <h:head>
<ui:insert name="title">Title</ui:insert></title>
    </h:head>
    <h:body>

    <h:form>
    <p:tabMenu activeIndex="#{loginBean.activeindex}">  
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star" />
        <p:menuitem value="Fabricants" url="/pagess/pagesFabricant/Fabricant.jsf" icon="ui-icon-wrench"   action="#{loginBean.Dirige(1)}" /> 
        <p:menuitem value="Composants" url="/pagess/pagesComposant/Composant.jsf" icon="ui-icon-search"  action="#{loginBean.Dirige(2)}"/> 
        <p:menuitem value="Dossier d'equivalence" url="DEQ.jsf" icon="ui-icon-document" action="#{loginBean.Dirige(3)}"/> 
    </p:tabMenu> 
    </h:form>
    <p/>
    <table border="5" align="center">
      <tr><th class="title">
        Bienvenue #{loginBean.username} dans Notre application Ipertool
      </th></tr>
    </table><p/>

    <ui:insert name="body">Body</ui:insert>

    <p:separator id="separator"/> 

    <ui:include src="/templates/includes/footer.xhtml"/>
    </h:body>
    </html> 
```

这是我按下 menuitem Fabricant 时的页面 Fabricant

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    template="/templates/template.xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">

<ui:define name="title">Liste Fabricants</ui:define>
<ui:define name="body">
<h:form id="form">  

    <p:growl id="growl" showDetail="true"/>  

    <p:commandLink  value="Ajouter Fabricant" action="#{fabricantbean.Ajouter()}"><img src="/image/ajout.jpg" alt= "Ajouter"></img></p:commandLink> 

    <p:dataTable id="cars" var="fab" value="#{fabricantbean.list}" paginator="true" rows="10"  rowKey="#{fab.idFabricant}"
                 selection="#{fabricantbean.selectitem}" selectionMode="single" emptyMessage="Aucun Fabricants Trouve">  

        <p:ajax event="rowSelect" listener="#{fabricantbean.onRowSelect}"   
                    update=":form:dialog :form:growl" oncomplete="carDialog.show()" />  

        <p:column  id="modelColumn" filterBy="#{fab.nomFabricant}"   
                headerText="Nom Fabricant" footerText="contains"  
                filterMatchMode="contains">  

            <h:outputText value="#{fab.nomFabricant}" />  
        </p:column>  

        <p:column>  
            <f:facet name="header">  
                    Lien Site  
            </f:facet>  
            <h:outputText value="#{fab.lienSite}" />  
        </p:column>  

        <p:column>  
            <f:facet name="header">  
                    Staut Fabricant  
            </f:facet>  
            <h:outputText value="#{fab.statutFabricant}" />  
        </p:column>  

        <p:column>  
            <f:facet name="header">  
                    Nom Contact  
            </f:facet>  
            <h:outputText value="#{fab.nomContact}" />  
        </p:column>  

        <p:column>  
            <f:facet name="header">  
                    Mail Contact  
            </f:facet>  
            <h:outputText value="#{fab.mailContact}" />  
        </p:column>  

        <p:column>  
            <f:facet name="header">  
                    Action  
            </f:facet>  
            <p:commandButton value="Modifier" action="#{fabricantbean.Modifier()}"> 
            <f:setPropertyActionListener target="#{fabricantbean.selectitem}" value="#{fab}" /> 
            </p:commandButton>
            <p:commandButton value="Supprimer" onclick="info.show()"  >
            <f:setPropertyActionListener target="#{fabricantbean.selectitem}" value="#{fab}" />
            </p:commandButton>
        </p:column>  
    </p:dataTable>
  <p:confirmDialog id="infodialoge"    message="Si vous supprimer ce Fabricant vous resquer de supprimer ces composant ainsi les DEQ"
                header="supprimer Fabricant" severity="alert" widgetVar="info">  

        <p:commandButton id="confirm" value="Oui Sure"  oncomplete="info.hide()"  
                    action="#{fabricantbean.supprimer()}" update="form:cars"/>  
        <p:commandButton id="decline" value="Non " onclick="info.hide()" type="button" />   

    </p:confirmDialog>  

  <p:dialog id="dialog" header="Fabricant Detail" widgetVar="carDialog" resizable="false"  dynamic="true" 
                showEffect="fade" hideEffect="explode">  

        <h:panelGrid id="display" columns="2" cellpadding="4">  

            <f:facet name="header">  
                <p:graphicImage value="/images/cars/#{tableBean.selectedCar.manufacturer}.jpg"/>  
            </f:facet>  

            <h:outputText value="lien Reach:" />  
            <h:outputText value="#{fabricantbean.selectitem.lienReach}" />

            <h:outputText value="lien Fmd:" />  
            <h:outputText value="#{fabricantbean.selectitem.lienFmd}" />

            <h:outputText value="lien Rohs:" />  
            <h:outputText value="#{fabricantbean.selectitem.lienRohs}" />  

            <h:outputText value="lien cofc:" />  
            <h:outputText value="#{fabricantbean.selectitem.fichierCofc}" />  

            <h:outputText value="remarque:" />  
            <h:outputText value="#{fabricantbean.selectitem.remarqueFabricant}" />   

        </h:panelGrid>  

    </p:dialog> 
</h:form>  

</ui:define>

</ui:composition> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T09:15:31.527

问题实际上出`url`在您的`menuitem`.
你必须编辑你的`Dirige`方法。尝试以下操作：

```
public String Dirige(int a){
   setActiveindex(a);
   if (a == 1) {
      return "/pagess/pagesFabricant/Fabricant.jsf";
   }else{
      if (a == 2) {
         return "/pagess/pagesComposant/Composant.jsf";
      }else{
         ...
      }
   }
} 
```

在您的模板中，您必须删除 url-Tags：

```
<h:form>
    <p:tabMenu activeIndex="#{loginBean.activeindex}">  
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star" />
        <p:menuitem value="Fabricants" icon="ui-icon-wrench"   action="#{loginBean.Dirige(1)}" /> 
        <p:menuitem value="Composants" icon="ui-icon-search"  action="#{loginBean.Dirige(2)}"/> 
        <p:menuitem value="Dossier d'equivalence" icon="ui-icon-document" action="#{loginBean.Dirige(3)}"/> 
    </p:tabMenu> 
</h:form> 
```

# jquery - 通过 JSON 抓取 API 并显示

> ID：16100261
> 
> 赞同：1
> 
> 时间：2013-04-19T08:18:54.407
> 
> 标签：jquery, json, api

我无法显示通过 JSON 通过 API 获得的数据。我的代码如下

```
var nextSessionAPI = 'www.someapi.co.uk';
getSessionValues(exhibitionID,sessionKey);
function getSessionValues(exhibitionID,sessionKey) {
    jQuery.getJSON(nextSessionAPI, function(data) {
        jQuery.each(data.Data.Session, function(index, sessions) {
            console.log('success');
            if(jQuery.trim(sessions.StartDate).exists()) {
                 console.log(sessions.StartDate);
            };  
        });
    });
} 
```

检查控制台我正在取回 API，所以我认为我的代码在 console.log('success'); 之前是可以的。

API如下：

```
{
    "Parameters":{
        "EditionId":45,
    },
    "Data": 
    [
        {
            "__type":"Session:ID",
            "Id":
                {
                    "Id":1251,
                },
            "DisplayName":"Some event",
            "EndDate":"\/Date(1366712700000)\/",
            "StartDate":"\/Date(1366711200000)\/"
        }
    ]
} 
```

任何帮助将不胜感激。ps 放轻松，我的 JS 和 JSON 不是最强的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:29:15.773

`jQuery.trim`返回一个字符串，您无法调用该字符串，`exists`这可能是您收到错误的原因。如果我在字符串上调用存在，则会收到错误“TypeError: Object aaa has no method 'exists'”。由于您的 JSON 中的 StartDate 是“/Date(1366711200000)/”，因此它要么是有效日期，要么为空，所以......

尝试更换线路：

```
if(jQuery.trim(sessions.StartDate).exists()) 
```

很简单：

```
if(sessions.StartDate) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:19:27.187

你的修复：

```
var nextSessionAPI = 'www.someapi.co.uk';
getSessionValues(exhibitionID,sessionKey);
function getSessionValues(exhibitionID,sessionKey) {
    jQuery.getJSON(nextSessionAPI, function(data) {
        jQuery.each(data.Data, function(index, sessions) {
            console.log('success');
            if(jQuery.trim(sessions.StartDate).exists()) {
                 console.log(sessions.StartDate);
            };  
        });
    });
} 
```

data.Data 是会话列表。数据不包含键：`Session`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:18:36.773

json 不包含任何名为 Sessions for Data 的属性，因此您必须将脚本更改为`jQuery.each(data.Data, function(...))`.

```
var nextSessionAPI = 'www.someapi.co.uk';
getSessionValues(exhibitionID,sessionKey);
function getSessionValues(exhibitionID,sessionKey) {
    jQuery.getJSON(nextSessionAPI, function(data) {
        jQuery.each(data.Data, function(index, sessions) {
             /* do funky stuff here */
        });
    });
} 
```

# c - 枚举值是在预处理时还是在编译时解析的？

> ID：16100283
> 
> 赞同：5
> 
> 时间：2013-04-19T08:19:48.013
> 
> 标签：c, c11

枚举值何时解析？换句话说，以下代码片段是否符合标准？

```
enum{
    A,
    B,
    MAX
}

#if MAX > 42
#    error "Woah! MAX is a lot!"
#endif 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T08:28:46.080

预处理器与枚举没有任何关系。但是您的示例编译没有错误，那么`#if MAX > 42`指令是怎么回事？

每当预处理器处理条件指令时，任何未定义为宏的标识符都被视为 0。因此假设`MAX`未在其他地方定义为宏，您的代码片段相当于：

```
enum{
    A,
    B,
    MAX
}

#if 0 > 42
#    error "Woah! MAX is a lot!"
#endif 
```

从 C99 6.10.1/3“有条件包含”：

> ... 在由于宏扩展和定义的一元运算符进行了所有替换之后，所有剩余的标识符都被替换为 pp-number 0，然后将每个预处理令牌转换为一个令牌。...

C89/C90 标准中的措辞相同。

# android - 相对布局和列表视图之间的行分隔符

> ID：16100291
> 
> 赞同：0
> 
> 时间：2013-04-19T08:20:17.067
> 
> 标签：android, android-layout, android-linearlayout

你好，我有一个顶部有标题的视图和一个带有 pulltorefresh 功能的 listView。

我想在 listView 中的第一项之前显示行分隔符：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:background="@drawable/background_azul"
   android:orientation="vertical" >

<RelativeLayout 
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="50dip"
    android:background="@color/usualBike"
>

    <TextView
        android:id="@+id/noticesLabel"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:gravity="center"
        android:text="@string/tituloNoticias"
        android:textColor="@color/white"
        android:textSize="30dip"
        android:textStyle="bold" />

</RelativeLayout>

<View
    android:id="@+id/View01"
    android:layout_width="fill_parent"
    android:layout_height="2dp"
    android:background="#3b5998"/>

<com.mypackage.myapp.PullToRefresh
    android:id="@+id/listNews"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:cacheColorHint="#00000000"
    android:layout_marginLeft="8dip"
    android:layout_marginRight="8dip"
    android:divider="#3b5998"
    android:dividerHeight="2dip"/>           

</LinearLayout> 
```

但是这条线没有显示。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:21:53.693

您的代码似乎没问题...放置分隔符足以使用您使用的视图。要使用分隔符，通常的做法是

```
< ViewGroup

....... />

< View

......../>

< ViewGroup

......../> 
```

您没有说的唯一原因可能是您在视图中使用的背景颜色。如果您使用与其父级相同的颜色，则它将不可见

# java - 如何轮询 FTP 位置以触发其中的更改？

> ID：16100292
> 
> 赞同：3
> 
> 时间：2013-04-19T08:20:19.223
> 
> 标签：java, ftp, jenkins-plugins

我正在尝试轮询 ftp 位置。我正在使用 Jenkins 进行项目的持续集成。因此，如果有人可以建议我使用 Jenkins 中的插件或任何其他方法来监视 FTP 位置的变化，那将会很有帮助。我需要监控 FTP 位置的变化，当发现​​变化时，我必须建立另一个工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-06T11:23:34.520

不确定如何使用 Jenkins，但如果您想使用纯 java 监控 FTP 位置的更改（即在目录中添加/删除/修改文件时接收通知），那么以下库可以帮助您进行实际轮询/通知机制：[https](https://github.com/drapostolos/rdp4j) ://github.com/drapostolos/rdp4j （**Java 的远程目录轮询器**）。

API的简单使用示例：

```
package example

import java.util.concurrent.TimeUnit;
import com.github.drapostolos.rdp4j.DirectoryPoller;
import com.github.drapostolos.rdp4j.spi.PolledDirectory;

public class FtpExample {

    public static void main(String[] args) throws Exception {
        String host = "ftp.mozilla.org";
        String workingDirectory = "pub/addons";
        String username = "anonymous";
        String password = "anonymous";
        PolledDirectory polledDirectory = new FtpDirectory(host, workingDirectory, username, password);

        DirectoryPoller dp = DirectoryPoller.newBuilder()
        .addPolledDirectory(polledDirectory)
        .addListener(new MyListener())
        .setPollingInterval(10, TimeUnit.MINUTES)
        .start();

        TimeUnit.HOURS.sleep(2);

        dp.stop();
    }
} 
```

RDP4J[用户指南](https://github.com/drapostolos/rdp4j/wiki/User-Guide)：

*   提供了一个`FtpDirectory`使用 appache commons 列出 FTP 位置中的文件的类示例`FTPClient`
*   描述了`MyListener`可以监听的事件
*   如何配置`DirectoryPoller`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T00:20:25.097

不确定如何在 Jenkins 中实现这一点。如果我只是回答监控 FTP 位置部分，您可以这样做。

确定要使用的编程语言。（Java、.NET 等）。编写代码来监控 FTP 服务器（假设它是您要监控的特定远程目录）并执行需要执行的作业。监视和执行作业都需要用编程语言完成。

我还假设您需要某种计时器来进行监视，这也可以使用诸如 Java 之类的编程语言来完成。

# c - 我可以将带有 sigqueue 的 char* 发送到另一个进程吗

> ID：16100299
> 
> 赞同：1
> 
> 时间：2013-04-19T08:20:37.837
> 
> 标签：c, signals, sigqueue

这是我在客户端程序中的一部分代码

```
 union sigval toServer;   

      char *test = "dummy";
      serverPID = atol(buf2);
      toServer.sival_ptr = (void *)test;

      // Register to server
      if (sigqueue(serverPID, SIGUSR1, toServer) == -1) {  // register
         fprintf(stderr," Server isn't ready!\n");
         return 1;
      } 
```

这是我在服务器程序中的处理程序

```
 static void register_handler(int signo, siginfo_t* info, void *context) {   

      registeredProgramID = info->si_pid;

      if(info->si_value.sival_ptr != NULL)
       fprintf(stderr," sent value is  = %s \n" ,(char *)info->si_value.sival_ptr);
      } 
```

没有错误，但我无法收到我发送的内容。它打印出一些奇怪的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:37:03.210

你不能。

您可以发送`char*`，但接收进程通常无法访问发送进程的内存，并且内存可能映射不同。当您访问接收到的指针指向的内存地址时，结果是未定义的（即特定于平台且不一定可重复）。最可能的结果是某种内存保护错误或读取内存包含随机值。

# c# - ASP.NET MVC：通过 DataAnnotation 进行自定义验证

> ID：16100300
> 
> 赞同：111
> 
> 时间：2013-04-19T08:20:41.783
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, data-annotations

我有一个具有 4 个字符串类型属性的模型。我知道您可以使用 StringLength 注释来验证单个属性的长度。但是我想验证 4 个属性组合的长度。

使用数据注释执行此操作的 MVC 方法是什么？

我问这个是因为我是 MVC 的新手，并且想在制作自己的解决方案之前以正确的方式进行操作。

* * *

## 回答 #1

> 赞同：180
> 
> 时间：2013-04-19T08:29:21.210

您可以编写自定义验证属性：

```
public class CombinedMinLengthAttribute: ValidationAttribute
{
    public CombinedMinLengthAttribute(int minLength, params string[] propertyNames)
    {
        this.PropertyNames = propertyNames;
        this.MinLength = minLength;
    }

    public string[] PropertyNames { get; private set; }
    public int MinLength { get; private set; }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var properties = this.PropertyNames.Select(validationContext.ObjectType.GetProperty);
        var values = properties.Select(p => p.GetValue(validationContext.ObjectInstance, null)).OfType<string>();
        var totalLength = values.Sum(x => x.Length) + Convert.ToString(value).Length;
        if (totalLength < this.MinLength)
        {
            return new ValidationResult(this.FormatErrorMessage(validationContext.DisplayName));
        }
        return null;
    }
} 
```

然后你可能有一个视图模型并用它装饰它的一个属性：

```
public class MyViewModel
{
    [CombinedMinLength(20, "Bar", "Baz", ErrorMessage = "The combined minimum length of the Foo, Bar and Baz properties should be longer than 20")]
    public string Foo { get; set; }
    public string Bar { get; set; }
    public string Baz { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2013-04-19T08:46:05.713

## 自我验证模型

你的模型应该实现一个接口`IValidatableObject`。将您的验证代码放入`Validate`方法中：

```
public class MyModel : IValidatableObject
{
    public string Title { get; set; }
    public string Description { get; set; }

    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        if (Title == null)
            yield return new ValidationResult("*", new [] { nameof(Title) });

        if (Description == null)
            yield return new ValidationResult("*", new [] { nameof(Description) });
    }
} 
```

请注意：这是一个**服务器端**验证。它在客户端不起作用。只有在表单提交后才会执行您的验证。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2014-07-17T21:51:28.450

[ExpressiveAnnotations](https://github.com/jwaliszko/ExpressiveAnnotations)为您提供了这样的可能性：

```
[Required]
[AssertThat("Length(FieldA) + Length(FieldB) + Length(FieldC) + Length(FieldD) > 50")]
public string FieldA { get; set; } 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-11-12T15:15:13.230

为了改进达林的答案，它可以更短一些：

```
public class UniqueFileName : ValidationAttribute
{
    private readonly NewsService _newsService = new NewsService();

    public override bool IsValid(object value)
    {
        if (value == null) { return false; }

        var file = (HttpPostedFile) value;

        return _newsService.IsFileNameUnique(file.FileName);
    }
} 
```

模型：

```
[UniqueFileName(ErrorMessage = "This file name is not unique.")] 
```

请注意，错误消息是必需的，否则错误将为空。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-11-14T02:48:47.993

**背景：**

需要模型验证来确保我们收到的接收数据是有效和正确的，以便我们可以对这些数据进行进一步处理。我们可以在动作方法中验证模型。内置验证属性是 Compare、Range、RegularExpression、Required、StringLength。但是，我们可能会遇到需要验证属性而不是内置属性的场景。

**自定义验证属性**

```
public class EmployeeModel 
{
    [Required]
    [UniqueEmailAddress]
    public string EmailAddress {get;set;}
    public string FirstName {get;set;}
    public string LastName {get;set;}
    public int OrganizationId {get;set;}
} 
```

要创建自定义验证属性，您必须从 ValidationAttribute 派生此类。

```
public class UniqueEmailAddress : ValidationAttribute
{
    private IEmployeeRepository _employeeRepository;
    [Inject]
    public IEmployeeRepository EmployeeRepository
    {
        get { return _employeeRepository; }
        set
        {
            _employeeRepository = value;
        }
    }
    protected override ValidationResult IsValid(object value,
                        ValidationContext validationContext)
    {
        var model = (EmployeeModel)validationContext.ObjectInstance;
        if(model.Field1 == null){
            return new ValidationResult("Field1 is null");
        }
        if(model.Field2 == null){
            return new ValidationResult("Field2 is null");
        }
        if(model.Field3 == null){
            return new ValidationResult("Field3 is null");
        }
        return ValidationResult.Success;
    }
} 
```

希望这可以帮助。干杯！

**参考**

*   [代码项目 - ASP.NET MVC3 中的自定义验证属性](http://www.codeproject.com/Articles/260177/Custom-Validation-Attribute-in-ASP-NET-MVC3)
*   [Haacked - ASP.NET MVC 2 自定义验证](http://haacked.com/archive/2009/11/19/aspnetmvc2-custom-validation.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-03T13:30:08.350

回答有点晚了，但是对于谁在搜索。您可以通过使用带有数据注释的额外属性轻松地做到这一点：

```
public string foo { get; set; }
public string bar { get; set; }

[MinLength(20, ErrorMessage = "too short")]
public string foobar 
{ 
    get
    {
        return foo + bar;
    }
} 
```

仅此而已。如果您真的想在特定位置显示验证错误，您可以在视图中添加：

```
@Html.ValidationMessage("foobar", "your combined text is too short") 
```

如果您想进行本地化，在视图中执行此操作会派上用场。

希望这可以帮助！

# c++ - 在命名空间外定义友元模板方法

> ID：16100302
> 
> 赞同：0
> 
> 时间：2013-04-19T08:20:44.703
> 
> 标签：c++, templates, namespaces, operators, friend

我的代码具有以下基本结构：

```
namespace A{

    template<class T,unsigned DIM>
    class CMyTable{
        ...
            public:
            template<class T,unsigned DIM>
            friend std::ostream& operator<<(std::ostream& s, const CMyTable<T,DIM>& vec);
        }    

    };

} 
```

最初的问题是让我的 operator<< 在命名空间 A 之外。

我尝试了这个解决方案：[如何在另一个 C++ 命名空间内的全局命名空间中定义朋友？](https://stackoverflow.com/questions/2207219/how-do-i-define-friends-in-global-namespace-within-another-c-namespace)

```
namespace A{

    template<class T,unsigned DIM>
    class CMyTable;
}

template<class T,unsigned DIM>
std::ostream& operator<<(std::ostream& s, const CMyTable<T,DIM>& vec);

namespace A{

    template<class T,unsigned DIM>
    class CMyTable{
        ...
            public:
            template<class T,unsigned DIM>
            friend std::ostream& ::operator<<(std::ostream& s, const CMyTable<T,DIM>& vec);
        }    

    };

}

template<class T,unsigned DIM>
std::ostream& operator<<(std::ostream& s, const CMyTable<T,DIM>& vec){
// [...]
} 
```

我收到此错误：错误 C2063: 'operator <<' : not a function inside the class declaration。

```
public:
template<class T,unsigned DIM>
friend std::ostream& ::operator<<(std::ostream& s, const CMyTable<T,DIM>& 
```

有没有人有任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:25:04.667

输出运算符实际上是类的接口，因此，从逻辑上讲，它应该在声明类的命名空间中，但是为了使您的代码正常工作，您可以使用

```
namespace A{

    template<class T,unsigned DIM>
    class CMyTable;
}

// friend is not correct here.
template<class T,unsigned DIM>
/*friend*/ std::ostream& operator<<(std::ostream& s, const A::CMyTable<T,DIM>& vec);

namespace A{

    template<class T,unsigned DIM>
    class CMyTable{
        ...
            public:
            // choose another names of template pars.
            // or use
            //friend std::ostream& (::operator << <>)(std::ostream& s,
            //const CMyTable<T, DIM>&);
            /*template<class T,unsigned DIM>*/
            template<class U, unsigned D>
            friend std::ostream& (::operator <<)(std::ostream&,
            const CMyTable<U,D>&);
        };
}

template<class T,unsigned DIM>
std::ostream& operator<<(std::ostream& s, const A::CMyTable<T,DIM>& vec){
// [...]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:35:03.363

如果您的 ostream 重载必须是`friend`（*需要访问受保护的成员*），则内联定义它，以便您可以使用传递给类的模板参数。

```
namespace A{

    template<class T,unsigned DIM>
    class CMyTable{
        ...
        public:
        // template<class T,unsigned DIM>  // This will shadow otherwise
        friend std::ostream& operator<<(std::ostream& s, const CMyTable<T,DIM>& vec) {
        // [...]
        }
    };
} 
```

* * *

否则，从类和命名空间中完全删除其声明，并将其定义为外部模板重载。

**请记住，如果它不需要访问私有或受保护的元素，它不必是朋友。**

```
namespace A{
   template<class T,unsigned DIM>
   class CMyTable{
    ...
        public:
    };
}

template<class T,unsigned DIM>
std::ostream& operator<<(std::ostream& s, const A::CMyTable<T,DIM>& vec){
// [...]
} 
```

* * *

第三个选项是让它保持朋友关系，但在命名空间 A 中定义它

```
namespace A{

    template<class T,unsigned DIM>
    class CMyTable{
        public:
            int i;

        template<class V,unsigned E>
        friend std::ostream& operator<<(std::ostream& s, const CMyTable<V,E>& vec);
    };  

};
//
//

namespace A{

    template<class T,unsigned DIM>
    std::ostream& operator<<(std::ostream& s, const CMyTable<T,DIM>& vec) {
        s << vec.i;
    }

} 
```

# python - python 正则表达式：匹配第一个“}”

> ID：16100303
> 
> 赞同：0
> 
> 时间：2013-04-19T08:20:47.527
> 
> 标签：python, regex

我有一个字符串`s`包含： -

```
Hello {full_name} this is my special address named {address1}_{address2}. 
```

我正在尝试匹配大括号中包含的所有字符串实例。

尝试：-

```
matches = re.findall(r'{.*}', s) 
```

给我

```
['{full_name}', '{address1}_{address2}'] 
```

但我实际上想要检索的是

```
['{full_name}', '{address1}', '{address2}'] 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:22:15.853

```
>>> import re
>>> text = 'Hello {full_name} this is my special address named {address1}_{address2}.'
>>> re.findall(r'{[^{}]*}', text)
['{full_name}', '{address1}', '{address2}'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T08:22:30.237

尝试非贪婪匹配：

```
matches = re.findall(r'{.*?}', s) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:22:34.083

你需要一个非贪婪的量词：

```
matches = re.findall(r'{.*?}', s) 
```

注意问号`?`。

# html - d3.csv 包含两个字的关键列

> ID：16100305
> 
> 赞同：1
> 
> 时间：2013-04-19T08:20:57.127
> 
> 标签：html, d3.js

我正在使用一个 csv 文件，其中一些键是两个单词（由空格分隔）。我想使用 d3.csv 加载 csv 文件，但不知道如何引用两字列中的数据（使用 d.key。）

此代码不显示任何内容：

```
svg.selectAll("circle").transition().duration(1000)
    .attr("cx",function(d) {return x(+d.percent obese 2000);})
    .attr("cy",function(d) {return y(+d.percent obese 2000);})
    .attr("r",5) 
```

谁能帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-05-11T16:53:16.710

在我使用 V4 的情况下，我使用的是`return +d["marker-color"]`; 调用十六进制颜色，但它不起作用。

我发现这`return d["marker-color"];`行得通

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:30:49.497

您可以使用括号和引号：

```
.attr("cx",function(d) {return x(+d["Percent Obese 2007"]);})
... 
```

# opengl - 如何有效地将texture1复制到texture2？

> ID：16100308
> 
> 赞同：16
> 
> 时间：2013-04-19T08:21:04.683
> 
> 标签：opengl, textures

我想将texture1复制到texture2。最笨的方法是把tex1数据从GPU复制到CPU，然后再把CPU数据复制到GPU。愚蠢的代码如下：

```
float *data = new float[width*height*4];
glBindTexture(GL_TEXTURE_2D, tex1);
glGetTexImage(GL_TEXTURE_2D, 0, GL_RGBA, GL_FLOAT, data);
glBindTexture(GL_TEXTURE_2D, tex2]);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32F, width, height, 0, GL_RGBA, GL_FLOAT, data); 
```

据我所知，它必须存在一种支持将数据从 GPU tex 复制到 GPU tex 而不涉及 CPU 的方法。我考虑使用将 tex1 四边形渲染到 tex2 的 FBO。但不知何故，我认为这仍然是幼稚的。那么实现这一点的最有效方法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-19T08:55:07.183

如果您支持 OpenGL 4.3，则可以直接[`glCopyImageSubData`](http://www.opengl.org/sdk/docs/man/xhtml/glCopyImageSubData.xml)用于此目的：

```
glCopyImageSubData(tex1, GL_TEXTURE_2D, 0, 0, 0, 0,
                   tex2, GL_TEXTURE_2D, 0, 0, 0, 0,
                   width, height, 1); 
```

当然，这要求目标纹理已经分配了适当大小和格式的图像（使用简单的，或者如果你有 GL 4`glTexImage2D(..., nullptr)`可能会更好）。`glTexStorage2D`

* * *

如果你没有那个，那么使用 FBO 将一个纹理渲染到另一个纹理可能仍然是最好的方法。最后，您甚至不需要渲染源纹理。您可以将两个纹理附加到 FBO 并使用[`glBlitFramebuffer`](http://www.opengl.org/sdk/docs/man3/xhtml/glBlitFramebuffer.xml)（自 OpenGL 3 以来的核心，或 2.x 中的 GL_EXT_framebuffer_blit 扩展，几乎任何首先出现 FBO 的地方）将一个颜色附件blit到另一个：

```
glBindFramebuffer(GL_FRAMEBUFFER, fbo);
glFramebufferTexture2D(GL_READ_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, 
                       GL_TEXTURE_2D, tex1, 0);
glFramebufferTexture2D(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT1, 
                       GL_TEXTURE_2D, tex2, 0);
glDrawBuffer(GL_COLOR_ATTACHMENT1);
glBlitFramebuffer(0, 0, width, height, 0, 0, width, height, 
                  GL_COLOR_BUFFER_BIT, GL_NEAREST); 
```

当然，如果你多次这样做，让这个 FBO 保持活力可能是个好主意。同样，这也要求目标纹理图像事先具有适当的大小和格式。或者您也可以使用*Michael*的建议，即仅将源纹理附加到 FBO 并`glCopyTex(Sub)Image2D`在目标纹理中做一个好的旧的。需要评估哪个表现更好（如果有的话）。

* * *

如果您甚至没有那个，那么您仍然可以使用读取一个纹理并将该数据写入另一个纹理的方法。但不要将 CPU 内存用作临时缓冲区，而是使用[像素缓冲区对象 (PBO)](http://www.opengl.org/wiki/Pixel_Buffer_Object)（自 OpenGL 2.1 以来的核心）。您仍然会有一个额外的副本，但至少会（或可能是）一个 GPU-GPU 副本。

# java - 弹簧控制器不显示相关视图

> ID：16100313
> 
> 赞同：0
> 
> 时间：2013-04-19T08:21:19.857
> 
> 标签：java, spring, web-applications, spring-mvc

我有以下弹簧控制器类。

```
@Controller
public class LayoutController {

    @RequestMapping(value = "/layout", method = RequestMethod.GET)
    public String ShowLayout(){
        return "redirect:/views/layout.html";
    }
} 
```

这是我的通用配置 xml。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.2.xsd">

        <!--  COMMON CONFIGURATIONS -->
        <mvc:annotation-driven/>
        <tx:annotation-driven/> 

        <bean id="viewResolver"
        class="org.springframework.web.servlet.view.InternalResourceViewResolver"
        p:prefix="/WEB-INF/views/" p:suffix=".html" />

        <!-- Annotations based Configuration -->
        <context:annotation-config />

        <mvc:resources mapping="/*" location="/WEB-INF/views/" />

        <!-- Components Auto-Detection (Backend) -->
        <context:component-scan base-package="com.jkcs.touchpos" use-default-filters="false" >
            <!-- Types annotated by Spring Managed, Controller and Transactional, or by an annotation that itself is 
            annotated by SpringManaged, Controller, Transactional -->
            <context:include-filter type="annotation" expression="com.jkcs.touchpos.platform.annotations.SpringManaged"/>
            <context:include-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
            <context:include-filter type="annotation" expression="org.springframework.transaction.annotation.Transactional"/>
        </context:component-scan>

        <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping" />

</beans> 
```

这是我的 mvc-config xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd">

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" />
</beans> 
```

这是我的 web.xml 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>TouchPOS</display-name>
  <servlet>
    <servlet-name>dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
</web-app> 
```

最后是调度程序 servlet：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

    <!--  SPECIFIC CONFIGURATIONS -->
    <import resource="springConfigurations/common-config.xml"/>
    <import resource="springConfigurations/mvc-config.xml"/>

</beans> 
```

当我在码头服务器上运行此 Web 应用程序时，我使用以下 URL 来获取布局。但是服务器会抛出 404 错误。请帮我找出我在做的错误的事情？

```
http://localhost:8080/TouchPOSApplicatio/layout 
```

更新：网页元素显示正确但没有 CSS。控制台打印了以下错误。

```
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/style/style.css] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/style/jquery.custom-scrollbar.css] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery-1.9.1.min.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery.colorbox.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery.touchSwipe.min.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/functions.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/dragscrollable.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery-ui.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/style/colorbox.css] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery.colorbox.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/functions.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/jquery.touchSwipe.min.js] in DispatcherServlet with name 'dispatcher'
Apr 19, 2013 2:17:42 PM org.springframework.web.servlet.PageNotFound noHandlerFound
WARNING: No mapping found for HTTP request with URI [/TouchPOSApplication/js/dragscrollable.js] in DispatcherServlet with name 'dispatcher' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:31:33.263

我认为`TouchPOSApplicatio`这只是问题中的错字？我很难在这里理解你的模式。您已将静态资源映射到`/WEB-INF/views`，这是无法从浏览器访问的，所以我认为这不会起作用。尝试将其放入常规的 webapp 文件夹中，例如`static`（与 位于同一级别`WEB-INF`）。然后将您的配置更改为：

```
<mvc:resources mapping="/static/**" location="/static"/> 
```

然后您可以通过键入来验证它是否可以访问`http://localhost:8080/TouchPOSApplication/static/layout.html`。如果这有效，那么您已经正确配置了静态资源。

**编辑**

如果您也有 css 资源，请确保将包含这些资源的文件夹也添加为 mvc:resource。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:45:56.137

你的控制器被映射到`@RequestMapping(value = "/layout", method = RequestMethod.GET)`，你的 servlet 映射是`<url-pattern>/</url-pattern>`，所以 URL 应该是`http://localhost:8080/layout`。

此外，正如 NilsH 已经说过的，您的控制器重定向到浏览器无法直接看到的文件。它应该作为静态文件公开。

# java - 解决Maven依赖收敛问题

> ID：16100315
> 
> 赞同：43
> 
> 时间：2013-04-19T08:21:25.223
> 
> 标签：java, maven, dependency-management, maven-enforcer-plugin

我使用 maven-enforcer-plugin 来检查依赖收敛问题。典型的输出是：

```
[WARNING] Rule 1: org.apache.maven.plugins.enforcer.DependencyConvergence failed 
  with message:
Failed while enforcing releasability the error(s) are [
Dependency convergence error for junit:junit:3.8.1 paths to dependency are:
+-foo:bar:1.0-SNAPSHOT
  +-ca.juliusdavies:not-yet-commons-ssl:0.3.9
    +-commons-httpclient:commons-httpclient:3.0
      +-junit:junit:3.8.1
and
+-foo:bar:1.0-SNAPSHOT
  +-junit:junit:4.11
] 
```

看到这条消息，我通常会通过排除传递依赖来“解决”它，例如

```
<dependency>
  <groupId>ca.juliusdavies</groupId>
  <artifactId>not-yet-commons-ssl</artifactId>
  <version>0.3.9</version>
  <exclusions>
    <!-- This artifact links to another artifact which stupidly includes 
      junit in compile scope -->
    <exclusion>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

我想了解这是否真的是一个修复以及以这种方式排除库所涉及的风险。照我看来：

*   只要我选择使用较新的版本，“修复”通常是安全的。这依赖于库作者保持向后兼容性。

*   通常对 Maven 构建没有影响（因为更接近的定义获胜），但是通过排除依赖项，我告诉 Maven 我知道这个问题，从而安抚了 maven-enforcer-plugin。

我的想法是否正确，是否有其他方法可以处理此问题？我对关注一般情况的答案很感兴趣——我意识到`junit`上面的例子有点奇怪。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-04-26T14:58:32.307

我们都同意 JUnit 永远不应该设置为`test`. 一般来说，我认为除了排除不需要的依赖之外，没有其他解决方案，所以我们都同意你这样做是正确的。

**一个简单的案例：**

正如 Andreas Krueger 所说，版本可能存在风险（我实际上遇到过）。假设项目的依赖项如下：

```
+-foo:bar:1.0-SNAPSHOT
  +-group1:projectA:2.0
     +-group2:projectB:3.8.1
  +-group2:projectB:4.11 
```

请注意，这只是对您的情况的简化。看到这个依赖树，你会排除 projectA 给出的依赖 projectB ：

```
<dependency>
  <groupId>group1</groupId>
  <artifactId>projectA</artifactId>
  <version>2.0</version>
  <exclusions>
    <exclusion>
      <groupId>group2</groupId>
      <artifactId>projectB</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

使用 maven 打包项目后，剩余的依赖项将是 group2-someProjectB-4.11.jar，版本 4.11 而不是 3.8.1。一切都会好起来的，项目将运行而不会遇到任何问题。

然后，过了一会儿，假设您决定升级到项目 A 的下一个版本，即 3.0 版，它增加了新的强大功能：

```
<dependency>
  <groupId>group1</groupId>
  <artifactId>projectA</artifactId>
  <version>3.0</version>
  <exclusions>
    <exclusion>
      <groupId>group2</groupId>
      <artifactId>projectB</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

问题是**您还不知道**projectA 版本 3.0 也已将其依赖项 projectB 升级到版本 5.0 ：

```
+-foo:bar:1.0-SNAPSHOT
  +-group1:projectA:3.0
     +-group2:projectB:5.0
  +-group2:projectB:4.11 
```

在这种情况下，您刚才所做的排除将排除 projectB 5.0 版。

但是，**projectA 3.0 版需要对项目 B 5.0 版进行改进**。由于排除，使用 maven 打包项目后，剩余的依赖项将是 group2-someProjectB-4.11.jar，版本 4.11 而不是 5.0。在您使用 projectA 的任何新功能时，程序将无法正确运行。

**解决方案是什么？**

我在一个 Java-EE 项目中遇到了这个问题。

一个团队开发了数据库服务。他们将其打包为 projectA。每次更新服务时，他们还会更新一个文件，其中列出了所有当前依赖项和当前版本。

ProjectA 是我正在处理的 Java-EE 项目的依赖项。每次服务团队更新 ProjectA 时，我也会检查版本的更新。

**事实上，排除依赖项并没有什么坏处。**但是每次更新已设置排除项的依赖项时，您必须检查：

*   如果这种排除仍然有意义。
*   如果您需要在自己的项目中升级排除的依赖项的版本。

我猜maven排除就像菜刀。它很锋利，可以毫不费力地切蔬菜，但在处理时需要小心...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T14:46:29.000

如果作为工件的 JUnit 作为编译范围内的依赖项通过，则这是您的库之一的错误，此处为：ca.juliusdavies。

JUnit 应始终包含在测试范围内。因此，在成功构建时，它**不会**被打包到生成的 .jar、.war 或 .ear 文件中。

一般来说，排除已经包含的依赖项并没有什么坏处，因为库 1 和库 2 共享一个共同的依赖项。

当然，唯一可能发生的问题是库 1 和库 2 包含相同依赖工件的不同版本时。**当库的功能发生变化时，这可能会导致运行时错误**。幸运的是，这种情况并不常见，除非版本号的差异很大。通常，建议包含最新的依赖版本并排除较旧的依赖版本。这在大多数情况下是可行的。

如果没有，请检查您的项目的一级依赖项是否有更新。

# sql - sql 在字符串中选择带有拆分功能的字符串？

> ID：16100316
> 
> 赞同：2
> 
> 时间：2013-04-19T08:21:26.733
> 
> 标签：sql, sql-server, select

我如何从非规范表中进行选择。

我有这样的表：

![在此处输入图像描述](https://i.stack.imgur.com/5pXXd.jpg)

此表不是标准 BNF 2。

我只想选择 DEPARTEMENT = something 的 NO_ID。示例：
当输入 44 则 NO_ID =1
当输入 37 然后 NO_ID =3
当输入 13（不在表中）则 NO_ID = 5

当然，当 input = 44 时，它可以工作：

```
SELECT [NO_ID]    
FROM [T_TARIF_ZONE]
WHERE DEPARTEMENT = '44' 
```

但是当输入 = 37 或 13 时，我如何输入 WHERE 语句。

提前谢谢你，史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:28:49.593

尝试这个：

```
SELECT [NO_ID]    
FROM [T_TARIF_ZONE]
WHERE DEPARTEMENT like '%37%' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T09:02:14.753

请试试：

```
select 
    NO_ID, 
    DEPARTMEMT 
from 
    T
where 
    ' '+DEPARTMEMT+' ' like 
    (case when @var=13 then ' FRANCE ' ELSE '% '+@var+' %' END) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:31:05.353

甲骨文版本 -

```
SELECT [NO_ID]    
FROM [T_TARIF_ZONE]
WHERE INSTR(DEPARTEMENT, '44')>0  OR INSTR(DEPARTEMENT, '37')>0 OR INSTR(DEPARTEMENT, '13')>0 
```

SQL Server 版本 -

```
 SELECT [NO_ID]    
FROM [T_TARIF_ZONE]
WHERE PATINDEX('44', DEPARTEMENT)>0  OR PATINDEX('37', DEPARTEMENT)>0 OR PATINDEX('13', DEPARTEMENT)>0 
```

# go - 是否可以在 go 中编写“流利”风格的 api？

> ID：16100317
> 
> 赞同：6
> 
> 时间：2013-04-19T08:21:34.790
> 
> 标签：go

其他几种语言具有“流利”或链式调用风格的 api，它允许您执行如下调用：

```
public class CatMap : ClassMap<Cat>
{
  public CatMap()
  {
    Id(x => x.Id);
    Map(x => x.Name)
      .Length(16)
      .Not.Nullable();
    Map(x => x.Sex);
    References(x => x.Mate);
    HasMany(x => x.Kittens);
  }
} 
```

值得注意的例子包括 fluent nhibernate、jquery 方法链接等。它是一种常见的（我会说非常受欢迎的）api 设计模式。

问题：go 语法似乎不支持这一点。

你可以这样做：

```
var blah = X().Y().Thing().OtherThing() 
```

...但是这个：

```
package main

import "n"

func main() {
    n.Log(":D")
    .Example()
    .Example
} 
```

结果是：

```
> command-line-arguments
> ./app.go:7: syntax error: unexpected . 
```

...基本上，因为 go 会自动在行尾插入 ;。

任何人都知道是否有办法解决这个问题？

你能禁用自动吗？以某种方式在一个街区？

或者这种 api 在 go 中是不可能的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-19T08:40:59.387

您可以将代码重新格式化为

```
func main() {
    n.Log(":D").
    Example().
    Example
} 
```

将句点放在行尾可以避免自动插入分号——它只发生在标识符、文字或右括号/大括号之后。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-21T13:40:19.080

看看[goproxy](https://github.com/elazarl/goproxy/)。我认为它的某些部分是流利的。

```
proxy.OnRequest(goproxy.DstHostIs("www.reddit.com")).DoFunc(
    func(r *http.Request,ctx *goproxy.ProxyCtx)(*http.Request,*http.Response) {
        if h,_,_ := time.Now().Clock(); h >= 8 && h <= 17 {
            return r,goproxy.NewResponse(r,
                    goproxy.ContentTypeText,http.StatusForbidden,
                    "Don't waste your time!")
        }
        return r,nil
}) 
```

# javascript - 从 javascript 到 html 的元素列表

> ID：16100318
> 
> 赞同：0
> 
> 时间：2013-04-19T08:21:36.350
> 
> 标签：javascript, html

我有一个未知长度的 Javascript 数组，我想让它的一些字段显示在我的 html 页面中。我试图在我的 js 库中创建一个函数来打印它们，直接通过我的 html 代码调用它

```
<body onload="parser()">
   <div id="list">
       <script> load_list() </script>
   </div>
</body> 
```

函数 parser() 从 xml 文件中提取信息并将它们放入数组中。函数 load_list 如下

```
function load_list () {
     document.write ("<ul>");
     for (i=0; i< array.length; i++) {
         document.write ("<li><a href='javascript:change("+array[i].x+")'>");
         document.write (array[i].name);
         document.write ("</a></li>");
     }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:31:30.993

尝试

```
<div id="list">
</div>

<script>
    var subjects = [{
        x: '1',
        name: 'One'
    }]

    function load_list(){
        var ul = document.createElement('ul');
        document.getElementById('list').appendChild(ul);
        for (i=0; i< subjects.length; i++) {
            var li = document.createElement('li');
            var a = document.createElement('a');
            a.innerHTML = subjects[i].name;
            a.setAttribute('href', "javascript:change("+subjects[i].x+")")
            li.appendChild(a);
            ul.appendChild(li);
        }
    }

    function parser(){

        //do parsing logic

        load_list()
    }

</script> 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/bkxxV/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T08:33:56.537

document.write 基本上已被弃用（非官方）。

进一步阅读： [为什么 document.write 被认为是“坏习惯”？](https://stackoverflow.com/questions/802854/why-is-document-write-considered-a-bad-practice)

此外，通过纯文本创建元素也是不明智的，因为它没有正确地将它们添加到 DOM。

尝试这个：

```
subjects = ["test","test2"];
array = [{x:"test",name:"name"},{x:"test2",name:"name2"}];

for (i=0; i< subjects.length; i++) {
    var li = document.createElement("li");
    var a = document.createElement("a");
    a.setAttribute("href","javascript:change("+array[i].x+")");
    a.innerHTML = array[i].name;
    li.appendChild(a);
    document.getElementById('listUL').appendChild(li);
}

<div id="list">
    <ul id="listUL">

    </ul>
</div> 
```

看到它在这里工作：

[http://jsfiddle.net/wdkmz/](http://jsfiddle.net/wdkmz/)

# linux - OpenVZ，无法更改密码

> ID：16100320
> 
> 赞同：1
> 
> 时间：2013-04-19T08:21:48.317
> 
> 标签：linux, passwords, vps, openvz

我正在尝试通过以下命令更改 VPS 的密码：

`vzctl set 180 --userpasswd root:test123 --save`

它给了我这个错误：`No changes in CT configuration, not saving`

使用 OpenVZ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-23T07:59:28.543

不要使用`--save`.

`vzctl set 180 --userpasswd root:test123`应该可以。

要了解更多信息，请参阅[Setting_root_Password_for_Container](http://openvz.org/User_Guide/Operations_on_Containers#Setting_root_Password_for_Container)

# oracle - 是否可以在 oracle 中创建视图表

> ID：16100324
> 
> 赞同：2
> 
> 时间：2013-04-19T08:21:58.127
> 
> 标签：oracle

这可能是一个愚蠢的问题，但由于 oracle 允许创建不同对象的表，我认为也许可以创建一个视图表。

我需要生成很多很多视图（这将旋转一些表）。每个视图都有不同的列名。我不想用成百上千个名为 `schema.xls_import_id_1234_sheet_0`.

是否可以创建视图表？然后用类似的东西查询它们

```
select * from table(
    select a_view from xls_sheet_views where xls_id = 1234 and sheet_no = 0) 
```

或者可能是一种将查询存储为 varchar2 类型的方法，以及某种自动执行它的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:45:31.750

不，您不能创建视图表。

根据您尝试解决的确切业务问题，您可能可以在包中的流水线表函数中实现逻辑，而不是拥有数千个视图。如果您有这么多视图，因为您要为每个可能透视的属性组合创建一个单独的对象，那么使用接受一些参数而不是拥有数百个视图的流水线表函数可能是有意义的。或者，在一个包中包含一些返回`SYS_REFCURSOR`.

一般来说，如果你想使用流水线表函数，你会想知道结果的结构。但是，通过在 Oracle 对象类型中使用多态性，您可能会变得很棘手。您可以声明单个对象类型，派生多个子类型，然后从父类型上定义的流水线表函数返回子类型的实例。Adrian Billington 有一个很好的例子来说明这种[灵活的流水线表函数](http://www.oracle-developer.net/display.php?id=420)。但是，您可以使用 Data Cartridge 框架变得更疯狂，并开发一个[返回任意结构化结果的流水线表函数](http://www.oracle-developer.net/display.php?id=422)。现在，只是因为你*可以*做这样的事情，如果没有经过深思熟虑，我当然不会提倡实际这样做。对于像旋转某些数据这样常见的事情，需要这种级别的动态代码会让我强烈怀疑您需要退后一步，看看系统的架构。

# wpf - 带有实体框架的非常简单的 WPF 应用程序的 OutOfMemoryException

> ID：16100325
> 
> 赞同：2
> 
> 时间：2013-04-19T08:21:59.297
> 
> 标签：wpf, binding, frameworks, entity, out-of-memory

我已经搜索过这个问题，但我只发现人们正在加载包含数百万条目的表格的问题。在我的情况下，情况并非如此。

我对 WPF 和实体框架都很陌生。我使用 Visual Studio 2010 数据源向导添加到数据库的连接。我使用拖放将视图从数据源拖放到我的 WPF 窗口中。该视图仅包含大约 32,000 条记录，选择大约需要 15 秒。

当我第一次构建并运行应用程序时，它运行良好并在窗口中显示数据。只是为了感受一下差异，我在 ListView 和 Datagrid 中显示相同的数据，但是当我只使用其中一个控件时没有什么不同：

当我第二次运行该应用程序时，它永远不会完成启动。它只显示“忙碌”光标，然后在一段时间后抛出 OutOfMemoryException。如果我在任务管理器中查看性能，内存只会不断上升，直到遇到异常。

我对此进行了调试：执行 EF 查询时不会发生这种情况。我什至让它将查询结果保存到一个列表中，并将其分配给窗口的数据源。我可以在调试器中看到查询终止并且列表生成良好，我可以在调试器中检查它。

*这是查询运行后*的数据绑定机制，似乎什么都没有泄漏内存然后抛出。顺便说一句，我没有可以发布的调用堆栈。

有没有其他人遇到过这个问题，你是如何解决的？

以下是更多信息：它是 Windows 7。

MainWindow.xaml 看起来像这样：

```
 <Window x:Class="WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525" Loaded="Window_Loaded" 
        mc:Ignorable="d" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:my="clr-namespace:WpfApplication2">
    <Window.Resources>
        <CollectionViewSource x:Key="vMyViewSource" d:DesignSource="{d:DesignInstance my:VMyView, CreateList=True}" />
    </Window.Resources>
    <Grid DataContext="{StaticResource vMyViewSource}">
        <Grid.RowDefinitions>
            <RowDefinition Height="20"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="20"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Row="0" Text="my view in a ListView:"/>
        <ListView Grid.Row="1" 
                  ItemsSource="{Binding}" 
                  Margin="0" 
                  Name="vMyListView" 
                  SelectionMode="Single">
            <ListView.ItemContainerStyle>
                <Style>
                    <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                    <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView>
                    <GridViewColumn x:Name="IDColumn1" Header="ID" Width="80">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Margin="6,-1,-6,-1" Text="{Binding Path=ID,Mode=OneWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn x:Name="Name" Header="Name" Width="80">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Margin="-6,-1" Text="{Binding Path=Name, Mode=OneWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    ... (more GridViewColumns)
                </GridView>
            </ListView.View>
        </ListView>

        <TextBlock Grid.Row="2" Text="my view in a DataGrid:"/>

        <DataGrid Grid.Row="3" 
                  AutoGenerateColumns="False" 
                  EnableRowVirtualization="True" 
                  HorizontalAlignment="Left" 
                  ItemsSource="{Binding}" 
                  Margin="0" 
                  Name="vMyViewDataGrid" 
                  RowDetailsVisibilityMode="VisibleWhenSelected" 
                  VerticalAlignment="Top" >
            <DataGrid.Columns>
                <DataGridTextColumn x:Name="IDColumn" Binding="{Binding Path=ID}" Header="ID" Width="SizeToHeader" />
                <DataGridTextColumn x:Name="NameColumn" Binding="{Binding Path=Name}" Header="Name" Width="SizeToHeader" />
                ... (more DataGridTextColumns, also some with a CellTemplate with a TextBox inside)
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</Window> 
```

这是 MainWindow 的 Window_Loaded 方法（大部分代码是由数据源向导自动生成的）：

```
 private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        WpfApplication2.MyEntities MyEntities = new WpfApplication2.MyEntities();
        // Load data into VMyView. You can modify this code as needed.
        System.Windows.Data.CollectionViewSource VMyViewViewSource = ((System.Windows.Data.CollectionViewSource)(this.FindResource("vMyViewViewSource")));
        System.Data.Objects.ObjectQuery<WpfApplication2.VMyView> VMyViewQuery = this.GetVMyViewQuery(MyEntities);
        var data = VMyViewQuery.Execute(System.Data.Objects.MergeOption.AppendOnly).ToList(); // I added the ToList() to make the query execute here
        VMyViewViewSource.Source = data;
    } // it gets here fine and loads the data 
```

我不敢相信这里有什么不寻常的地方，发生了什么，我怎样才能摆脱这个问题？

# javascript - 如何在 Kineticsjs 中动态添加点到线？

> ID：16100326
> 
> 赞同：0
> 
> 时间：2013-04-19T08:22:00.930
> 
> 标签：javascript, html, canvas, kineticjs

我想动态添加点到线。`setPoints(Array)`只会采用一组新的点数组，但我想通过向其添加另一个点来扩展该线。此外，我在将点添加到线时使用了过渡。怎么做 ？

这是行不通的

```
line.transitionTo({points:[x,y],duration:1,easing:'ease-out'}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:42:38.443

您目前无法进行转换，但您可以执行以下操作：

```
var points = line.getPoints();
points.push(x); // new x point 
points.push(y); // new y point
line.setPoints(points);
layer.draw(); 
```

# python - 选定字段的简单呈现逻辑

> ID：16100331
> 
> 赞同：0
> 
> 时间：2013-04-19T08:22:15.727
> 
> 标签：python, django

我通过将 window.location.href 设置为：`/edit_page/?id=user_id`在我的一个页面和我的views.py中呈现到这个页面我有这个：

```
id = request.GET.get('id') 
users = User.objects.all()
return render_to_response("index.html",{'id':id,'users':users},context_instance=RequestContext(request)) 
```

在我的 index.html 中，我有一个选择字段，其中包含从服务器呈现的用户选项，正如您在我的 dict 中看到的那样，默认情况下未选择选择字段。

`ID`我手中的是被选中在另一个页面中编辑的用户的 ID，但是现在我如何将选项设置为选择 ID 等于“`ID`在我的左手”中的用户。

希望，我很好地解释了我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:27:00.353

```
<select>
{% for user in users %}
{% if id == user.id %}<option selected>{% else %}<option>{% endif %}{{ user.first_name }}</option>
{% endfor %}
</select> 
```

# ios - 启用弧的 AVAudioPlayer 中的内存泄漏

> ID：16100339
> 
> 赞同：0
> 
> 时间：2013-04-19T08:22:38.700
> 
> 标签：ios, memory-leaks, automatic-ref-counting, avaudioplayer, instruments

**ARC**已启用。仪器显示内存泄漏。有什么解决办法吗？

这是我的代码：

```
- (void) onPlayButtonClicked
{
    NSString *title = @"Pause";

if (isPlay) {
    [player stop];
    player.delegate = nil;
    title = @"Play";
}
else
{
    player = [[ReaderGlobals audioPlayer] initWithContentsOfURL:mSoundPath error:nil];
    player.delegate = self;
    [player play];
}

isPlay ^= true;
[mButtonPlay setTitle:title forState:UIControlStateNormal];
} 
```

`ReaderGlobals`是一个单例类并`[ReaderGlobals audioPlayer]`返回一个实例`AVAudioPlayer`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:39:31.243

每次 ypu 按下播放按钮时都会创建播放器实例。但它没有被释放。使玩家成为一个属性。停止播放器后

```
self.player = nil; 
```

每当您停止播放播放器对象是轻量级对象时，这将释放播放器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:35:14.117

如果您的单例`[ReaderGlobals audioPlayer]`正在返回一个实例，那么您不需要调用`initWithContentsOfURL:error:`它。也就是说，您告诉我们`AVAudioPlayer`已经分配（retainCount 增加到 1）并“初始化”。因此，您应该只设置需要在现有返回实例上设置的内容。不要再调用init。

作为一般的最佳实践，您永远不应该对一个对象多次调用 init。虽然它不会增加 retainCount（alloc 会），但它可能会重新创建/重置内部 ivars，这可能会导致现有值泄露。

作为一般规则，您应该使用 setter 将任何值重置为新值（在您的情况下为 URL）。但是，`AVAudioPlayer`没有 URL 的设置器，因此`AVAudioPlayer`当您希望应用不同的 URL 时，您必须完全创建一个新实例。这就是它的用途。

# css - jQm 以编程方式调整表单单选按钮显示

> ID：16100340
> 
> 赞同：0
> 
> 时间：2013-04-19T08:22:44.460
> 
> 标签：css, jquery-mobile

我为单选按钮设置了一个水平对齐的字段，虽然按钮在 iPhone 上显示“恰到好处”，因为它们都在同一行而不会中断，但我担心在另一个尺寸的显示器上它会包裹按钮看起来很糟糕。

是否有一种简单的方法可以以编程方式完成此操作，或者更改填充、字体大小等以基本上将其全部强制到同一行而不截断？我可以使用窗口大小和大量数学将其破解到位，但我想知道是否有更“合适”的方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T13:16:43.790

最后，我从css中的每个按钮中删除了左右填充，将控件组设置为100％宽度！重要，然后在javascript中强制每个按钮的宽度为百分比。例如：4 件：25% 宽度，3 件：33%。

# mysql - 选择要按 desc 排序的查询 char 数字 id

> ID：16100341
> 
> 赞同：1
> 
> 时间：2013-04-19T08:22:45.980
> 
> 标签：mysql, sql, sql-order-by, natural-sort

我有示例数据

```
SMMP022011304196
SMMP022011304199    
SMMP022011304197    
SMMP022011304193
SMMP022011304195    
SMMP022011304198    
SMMP022011304192    
SMMP0220113041910   
SMMP022011304191
SMMP022011304194 
```

如果我使用`SELECT myfield from mytable order by myfield DESC` 我会得到这样的结果

```
SMMP022011304199    
SMMP022011304198    
SMMP022011304197    
SMMP022011304196    
SMMP022011304195    
SMMP022011304194    
SMMP022011304193    
SMMP022011304192    
SMMP0220113041910   
SMMP022011304191 
```

请帮助做出这样的结果：

```
SMMP0220113041910   
SMMP022011304199    
SMMP022011304198    
SMMP022011304197    
SMMP022011304196    
SMMP022011304195    
SMMP022011304194    
SMMP022011304193    
SMMP022011304192    
SMMP022011304191 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:35:26.733

只需按字段的长度排序，然后对长度相等的值进行排序：

```
SELECT myfield from mytable order by 
LENGTH(myfield) DESC,
myfield DESC 
```

[SQLFiddle 演示](http://sqlfiddle.com/#!2/cffe5/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:51:13.627

这工作正常。下面的代码适用于 SQL Server 2008 R2：

```
SELECT 
   myfield  
FROM mytable 
ORDER BY 
    LEN(myfield) DESC 
    ,myfield DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:35:20.467

如果数据总是在前面有 SMMP，你可以使用下面的：

```
ORDER BY LPAD(REPLACE(myfield,'SMMP',''),15,'0') desc; 
```

该方法的逻辑是忽略前面的 4 个字符，只对后面的数字进行排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T08:46:24.577

按照我之前的评论，排序如下： -

```
SELECT myfield
FROM mytable
ORDER BY SUBSTRING(myfield, 1, 4) DESC, cast(SUBSTRING(myfield, 5) AS unsigned) DESC 
```

请注意，这仅适用于您的字段为固定格式且 4 个字符后跟数字的情况

# php - 无法为我的网站实现 common header.php

> ID：16100347
> 
> 赞同：0
> 
> 时间：2013-04-19T08:23:08.467
> 
> 标签：php, html

我正在尝试在网站上的所有页面上放置一个通用头文件。我目前只是为一页做。

我正在使用“当前”类将给定页面标记为当前页面。我无法使用以下 html 执行此操作。标题显示 'class="current" href="contact.php" > Contact Us' 而不仅仅是“Contact Us”。运行代码会给你一个更好的主意。

似乎是一个简单的问题，但不知何故无法解决这个问题。请帮忙。

```
<?php               
$pagename=strtolower(basename($_SERVER['REQUEST_URI']));
?>    
    <div id="header">
        <div id="site_title">

        </div>  <!-- end of site_title -->
    </div><!-- end of header -->

    <div id="menu">
        <ul>
            <li><a href="index.php" class="current">Home</a></li>
            <li><a href="getstarted.php">Getting Started</a></li>
            <li><a href="account.php">My Account</a></li>
            <li class="current"><a href="about.php">About Us</a></li>
            <li><a <? if ($pagename=='contact.php') {?> class="current" <? } ?> href="contact.php" >Contact Us</a></li>

        </ul> 
    </div> <!-- end of menu -->

    <div id="middle">
        <h1>Welcome to my site</h1>
        <p></p> 
    </div> <!-- end middle--> 
```

- - - - - - - - 更新 - - - - - - - - - - - - - -

我不确定这可能是什么原因。第二行对我有用，而第一行不行。如果有人告诉我为什么会出现这种奇怪的行为，我将不胜感激

```
<li <? if ($pagename=='about.php') {?> class="current" <? } ?>><a href="about.php">About Us</a></li>
<li <?php if ($pagename=='contact.php') {?> class="current" <?php } ?>><a href="contact.php" >Contact Us</a></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:32:40.630

$pagename == "contact.php" 中的值是什么？

朱利安

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-19T08:31:11.527

您的关于我们的代码有 class="current"。这与“联系我们”页面不同。所以你看不出区别。

```
<li class="current"><a href="about.php">About Us</a></li> 
```

# c# - 创建数字证书时出现强密钥保护错误

> ID：16100348
> 
> 赞同：0
> 
> 时间：2013-04-19T08:23:10.120
> 
> 标签：c#, digital-certificate, pfx

我正在使用此代码创建 pfx：

```
public static void createpfx(string password)
    {
        // create DN for subject 
        var dnsubject = new CX500DistinguishedName();
        dnsubject.Encode("CN=FileHasher", X500NameFlags.XCN_CERT_NAME_STR_NONE);

        // create a new private key for the certificate
        CX509PrivateKey privateKey = new CX509PrivateKey();
        privateKey.ProviderName = "Microsoft Base Cryptographic Provider v1.0";
        privateKey.ContainerName = "Hasher Private Key";
        privateKey.MachineContext = false;
        privateKey.Length = 2048;
        privateKey.KeySpec = X509KeySpec.XCN_AT_SIGNATURE; // use is not limited
        privateKey.KeyUsage = X509PrivateKeyUsageFlags.XCN_NCRYPT_ALLOW_ALL_USAGES; 
        privateKey.ExportPolicy = X509PrivateKeyExportFlags.XCN_NCRYPT_ALLOW_PLAINTEXT_EXPORT_FLAG;
        privateKey.KeyProtection = X509PrivateKeyProtection.XCN_NCRYPT_UI_FORCE_HIGH_PROTECTION_FLAG;
        privateKey.Create();

        // Use the stronger SHA512 hashing algorithm
        var hashobj = new CObjectId();
        hashobj.InitializeFromAlgorithmName(ObjectIdGroupId.XCN_CRYPT_HASH_ALG_OID_GROUP_ID,
            ObjectIdPublicKeyFlags.XCN_CRYPT_OID_INFO_PUBKEY_ANY,
            AlgorithmFlags.AlgorithmFlagsNone, "SHA512");

        // Create the self signing request
        var cert = new CX509CertificateRequestCertificate();

        cert.InitializeFromPrivateKey(X509CertificateEnrollmentContext.ContextUser, privateKey, "");
        cert.Subject = dnsubject;
        cert.Issuer = dnsubject; // the issuer and the subject are the same
        cert.NotBefore = new DateTime(2013,1,1);
        // this cert expires immediately. Change to whatever makes sense for you
        cert.NotAfter = new DateTime(2029, 12, 31);
        //cert.X509Extensions.Add((CX509Extension)eku); // add the EKU
        cert.HashAlgorithm = hashobj; // Specify the hashing algorithm
        cert.Encode(); // encode the certificate

        Console.WriteLine("cert rawdata: "+cert.RawData);

        // Do the final enrollment process
        var enroll = new CX509Enrollment();
        enroll.InitializeFromRequest(cert); // load the certificate
        enroll.CertificateFriendlyName = "File Hashing Certificate"; // Optional: add a friendly name
        enroll.CertificateDescription = "Signed Hasher Certificate";

        string csr = enroll.CreateRequest(); // Output the request in base64
        //Console.WriteLine("csr==="+csr);
        // and install it back as the response
        enroll.InstallResponse(InstallResponseRestrictionFlags.AllowUntrustedCertificate,csr, EncodingType.XCN_CRYPT_STRING_BASE64, password); // no password
        // output a base64 encoded PKCS#12 so we can import it back to the .Net security classes
        var base64encoded = enroll.CreatePFX(password,PFXExportOptions.PFXExportChainWithRoot); // no password, this is for internal consumption
        //Console.WriteLine("base64==="+base64encoded);
        var fs = new System.IO.FileStream("hasher.pfx", System.IO.FileMode.Create);
        fs.Write(Convert.FromBase64String(base64encoded), 0, Convert.FromBase64String(base64encoded).Length);
        fs.Close();} 
```

创建 pfx 时，它会提示输入密码，但是，当我的应用程序使用私钥时，它不会提示输入密码。在输入密码 keyprotection 值更改为 XCN_NCRYPT_UI_NO_PROTECTION_FLAG 后，我监视了 privatekey 对象。我做错了什么？

# python - 模板查找问题。我不明白什么？

> ID：16100349
> 
> 赞同：4
> 
> 时间：2013-04-19T08:23:21.947
> 
> 标签：python, mako, python-3.3

**背景：**

我有以下目录结构：

```
/absolute/path/to/templates
            components/
                   component1.mak
                   component2.mak
            template1.mak 
```

该计划是将模板目录中的模板转换`include`为一堆组件。

在 template1.mak 我有类似的东西：

```
 <%include file="xxx.mak"/> 
```

在哪里`xxx`是`components/component1.mak`或者只是`component1.mak`（我都尝试了不同的结果，详情如下）

```
mylookup = TemplateLookup(directories=[yyy,])
oTemplate = Template(filename='/path/to/templates/template1.mak', lookup=mylookup)
oTemplate.render(args) 
```

其中 yyy 是`'/absolute/path/to/templates'`或者`'/absolute/path/to/templates/components'`

**问题：**

无论我使用 xxx 和 yyy 值的哪种组合，都会出现模板查找异常。yyy （查找路径）的值似乎对异常没有任何影响。

如果 xxx （包含标记路径）是`'components\component1.mak'`错误，则表示找不到文件`/absolute/path/to/templates/components/component1.mak`。如果`xxx`只是`'component1.mak'`那么错误是它找不到 `/absolute/path/to/templates/component1.mak`。

**问题**

我怎样才能让 mako 将这些东西包含在 components 目录中？我对模板查找缺少什么或不了解什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T10:48:10.697

`/`在模板中定义您的 xxx 调用时，请尝试放置前导。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-11-21T13:42:15.017

只是想提供一个更多信息的答案 - 路径实际上取决于哪个文件执行了代码。

## 示例 1

```
web/file.cgi              // was called first from the web
web/templates/header.mako // was called somewhere in file.cgi 
```

在这种情况下，查找目录应该是：

```
mylookup = TemplateLookup(directories=['templates/']) 
```

## 示例 2

```
// was called first from the web
web/file.cgi                 

// was imported and called in file.cgi
../somewhere/in-PYTHONPATH/mymodules/modulename.py

// was called from modulename.py
../somewhere/in-PYTHONPATH/mymodules/templates/edit.html 
```

那么您的查找目录实际上应该是：

```
 mylookup = TemplateLookup(directories=['../../../../somewhere/in-PYTHONPATH/mymodules/templates/'])
 OR
 mylookup = TemplateLookup(directories=['/fullpath/to/somewhere/in-PYTHONPATH/mymodules/templates/']) 
```

您需要完整路径，因为`web/file.cgi`它不位于后端模块的相对路径中......

由于某种原因，Mako Templates 不知道在相对目录中查找`mymodules/modulename.py`它调用`mymodules/templates/edit.html`不确定原因的文件（或者它可能只是我的旧版本 Mako Templates）

但是`<%include file="xxx.mak"/>`，行为不同，因为它确实相对于找到文件的位置进行查找，这就是为什么将其`/`拉上一层的原因-然后它查看了`templates/`.. 但同样，它对模块的工作方式不同在服务器的某个地方....

希望它可以帮助别人......

# javascript - IE9 悬停错误 - 移动一行后悬停状态保持不变

> ID：16100351
> 
> 赞同：2
> 
> 时间：2013-04-19T08:23:25.537
> 
> 标签：javascript, jquery, html, css, internet-explorer-9

这显然是实际应用程序的一个大大缩减的版本，但是错误仍然是相同的......

我们有一个表格，其中的行可以通过行中的控件向上/向下移动，并且为了表示这一点，移动控件具有悬停状态。在 IE9 中的以下 jsbin [http://jsbin.com/asasak/1](http://jsbin.com/asasak/1)中，您将看到在行移动后悬停状态保持不变。

有任何想法吗？我什至尝试在移动时更改行的类，然后删除类，但悬停状态仍然存在！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:43:11.333

[与移动 DOM 元素时 :hover persistent](https://stackoverflow.com/questions/14317760/hover-persistent-when-moving-dom-element)类似，我尝试了该`:active`解决方案，但在移动后将该状态附加到元素上，这是不好的。

解决此问题的一种方法是替换元素而不是移动它。这是一个 hack，对性能的影响很小，你可能不想添加它，它不像我想要的那样优雅，但这在 IE8 中对我有用。

```
$(document).ready(function(){
    $('table').on('click', 'a', function(){
      var $this = $(this);
      var row = $this.closest('tr');
      var index = row.index();
      var lastIndex = row.siblings().length;

      if ($this.hasClass('up') && index === 0 || $this.hasClass('down') && index === lastIndex) {
        return;
      }

      if ($this.hasClass('up')) {
        row.clone().insertBefore(row.prev());
      } else {
        row.clone().insertAfter(row.next());
      }

      row.remove();
    });
}); 
```

注意：使用[`.on()`](http://api.jquery.com/on/)委托*click*事件可以避免`.clone()`每次都需要元素及其事件。

# php - 如何使用连接表向数据库添加记录 - codeigniter

> ID：16100353
> 
> 赞同：3
> 
> 时间：2013-04-19T08:23:34.463
> 
> 标签：php, mysql, forms, codeigniter, join

我制作了一个表格，用于将工厂添加到我的数据库中。这很好用，但我无法在页面上显示我的工厂，因为它们位于连接表中，但是当我提交页面时，它不会向连接表添加 id，因此工厂不会显示在页面上.

连接的表如下所示：

```
bedrijfcategorieen
------------------
idbedrijfcat
idbedrijven
idcategorieen 
```

idbedrijven 是我的工厂表的 id。

我用于添加工厂的控制器功能：

```
function bedrijven()
{
    $data['options'] = $ddmenu;
    $this->load->view('members/header');
    $this->load->view('members/editform', $data);
    $this->load->view('members/footer');
}

function addbedrijven()
{
    $this->members_model->addbedrijf();
    redirect('members/index');
} 
```

我添加工厂的模型函数：

```
function addbedrijf()
{
    $data = array(
       'idbedrijven' => $idbedrijven,
       'Bedrijfsnaam' => $this->input->post('Bedrijfsnaam'),
       'Postcode' => $this->input->post('Postcode'),
       'Plaats' => $this->input->post('Plaats'),
       'Telefoonnummer' => $this->input->post('Telefoonnummer'),
       'Email' => $this->input->post('Email'),
       'Website' => $this->input->post('Website'),
       'Profiel' => $this->input->post('Profiel'),
       'Adres' => $this->input->post('Adres'),
       'logo' => $this->input->post('logo')
    );

    $this->db->insert('bedrijven', $data);
} 
```

我想通过连接表添加我的工厂。因此向工厂添加类别也会更容易。

我试过`where('bedrijfcategorieen.idbedrijven = idbedrijven`了，但没有用。

* * *

**表方案**

```
factories
---------
idfactories
factoryname
adress
postcode
country
telephone
...
...

categories
----------
idcategories
category

factorycategories
-----------------
idfactorycat
idfactories
idcategories 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T05:45:57.957

如果我理解正确 - 您想通过 JOIN 将记录添加到两个不同的表中。这是不可能的。您将为两个表编写两个单独的插入语句。

查看 Active Record 的文档[http://ellislab.com/codeigniter/user-guide/database/helpers.html](http://ellislab.com/codeigniter/user-guide/database/helpers.html)并阅读`$this->db->insert_id();`这可能会为您提供有关如何编写插入语句的线索。

# javascript - 如何清空ul自动完成JqueryMobile

> ID：16100360
> 
> 赞同：1
> 
> 时间：2013-04-19T08:24:03.120
> 
> 标签：javascript, jquery, autocomplete, html-lists

我有一个使用 ul 元素进行自动完成的网站（使用 JQueryMobile）。第一次加载页面时，我可以在 ul 输入中输入一些文本（带有数据角色列表视图的 ul）并将其保存在数据库中。然后，我重定向到其他站点，但是当我再次转到同一个站点时，我在 ul 输入中输入的数据仍然存在！当我将它发送到 db 时它会显示一个错误（错误是因为我需要在发送之前清空字段）。

网络充值时如何清空ul字段？我试过了

```
$("ul").html(" "); //not work
$("#id_div").remove(); //destroy the web and I can't enter again
$("#id_div").empty(); //same as above 
```

感谢和抱歉我的英语不好！

编辑：

我有不同的功能：

```
$( document ).on( "pageinit", "#confirm", function() {

    if(typeof localStorage.emails === 'undefined' || localStorage.emails === null){
        var mail = [];
        localStorage.emails = JSON.stringify(mail);
    }

    $( "#confirm_email1" ).on( "listviewbeforefilter", function ( e, data ) {
        var $ul = $( this ),
        $input = $( data.input ),
        value = $input.val(),
        html = "";
        $ul.html( "" );
        if ( value && value.length > 1 ) {

            var emails = JSON.parse(localStorage.emails)
            for(var i=0;i < emails.length;i++){
                html += "<li>" + emails[i] + "</li>";
            }
            $ul.html( html );
            $ul.listview( "refresh" );
            $ul.trigger( "updatelayout");
            $('li').click(function(){
                var mail = $(this).text();
                $input.val(mail);
                $ul.html( "" );
                $ul.listview( "refresh" );
                save_email1="";
                enviar_email1=mail;
            });

            save_email1 = $input.val();
            enviar_email1 = save_email1;
        }
    }); 
```

使用此功能，我创建 localStorage 以动态添加 li 元素以自动完成。

然后，我使用另一个：

```
function enviarReserva(){

    if(save_email1!==""){
        var emails = JSON.parse(localStorage.emails);
        emails.push(save_email1);
        localStorage.emails=JSON.stringify(emails);
    }

    var horafi = parseInt(horaReserva)+1;

    var check_soci1;

    if((enviar_email1!='' ) && (document.getElementById("soci_nosoci1").checked!=true)){
        check_soci1="no";
    }else{
        check_soci1="yeh";
    }

    $.ajax ( {
        beforeSend: function() { $.mobile.showPageLoadingMsg(); }, //Show spinner
        complete: function() { $.mobile.hidePageLoadingMsg() }, //Hide spinner
        url: "someURL?email1="+enviar_email1+"&check1="+check_soci1,
        dataType: "json",
        success: function (data, textStatus, jqXHR) {
            alert(data);
            actualitzarReserves();
            $.mobile.changePage("#mon",{transition:'none'});
            pag = 0;
            $('.pagina').html(pag);
            chargeWallet();
        },
        error: function (data, textStatus, jqHXR) {
            window.location.href="index.html";
        }
    });
} 
```

此函数检查 ul 是否为空以及是否选中了检查。然后，如果 check_soci 为 no，则 PHP 返回一些内容，如果 check_soci 为 yeh，则返回其他内容。

我的问题是，我第二次进入同一个网站时，ul 默认情况下不为空，尽管我清空了它发送给 PHP 的输入，但 check_soci 为否。错误！！

# vb6 - 将标签的属性保存到文件中，以便在 Visual Studio 2010 中读取和写入

> ID：16100365
> 
> 赞同：1
> 
> 时间：2013-04-19T08:24:20.063
> 
> 标签：vb6, vb.net-2010

我最近在 Visual Studio 2010 中创建了一个项目。我正在创建一个 Windows 应用程序，我想在其中将标签的属性保存到文件中，然后通过单击表单上的按钮，它将读取文件并恢复标签的属性。我能够在 vb6 中做到这一点，但我不能在 Visual Studio 2010 中做到这一点，因为它们的语言有点不同。这是我在VB6中写的：

这是保存标签的代码

```
 Open "Time Table" For Output As #1
    Write #1, Label4
    Close 1 
```

加载标签的代码

```
 Open "Time Table" For Input As #1
    Input #1, Label4
    Close 1 
```

所以我的问题是我应该在 Visual Studio 2010 中做什么才能使这段代码正常工作。

任何帮助表示赞赏 问候， SMKH

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T14:28:17.460

除非我误读了您的问题，否则您只想在 VB.NET 中读取和写入文件。

如果是这样的话，网上有很多例子，先试试[这个](http://support.microsoft.com/kb/315828)，还有[这里](http://msdn.microsoft.com/en-gb/library/6ka1wd3w.aspx)和[这里](http://msdn.microsoft.com/en-gb/library/db5x7c0d.aspx)。精简到最低限度，您的代码应该是这样的：

```
'Write
Using outfile As New StreamWriter("Time Table")
    outfile.Write(Label4.Text)
End Using

'Read
Using sr As New StreamReader("Time Table")
    Label4.Text = sr.ReadToEnd()
End Using 
```

附录：[这里有一个很好的序列化示例](http://support.microsoft.com/kb/316730)。

# corba - OMNIORB：在 IOR 中使用 Vmnet8 ip，在服务器外部无法访问

> ID：16100373
> 
> 赞同：1
> 
> 时间：2013-04-19T08:25:01.453
> 
> 标签：corba, iiop, omniorb

我在也运行 VMWare-Player 的机器上安装了 CORBA 服务器。VMWare 播放器创建两个虚拟网络连接。VMnet8 连接用于 VM 网络 NAT 模式。

意外的是，我的 Corba 服务器选择此网络连接作为第一个不是环回接口，并在其 IOR 和名称服务中使用此网络连接的 ip，这意味着客户端无法访问该 IP。

有没有一种方法可以设置默认 IP 而无需在omniorb 中设置固定端点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T23:16:11.450

请参阅有关[endPoint* 系列选项](http://omniorb.sourceforge.net/omni41/omniORB/omniORB004.html#toc23)的文档。您可以指定服务器将在 IOR 中侦听和发布的接口。

这些选项可以在命令行、配置文件、额外参数`orb_init()`或环境变量中设置。可以在[此处](http://omniorb.sourceforge.net/omni41/omniORB/omniORB004.html)找到有关配置 API 的更多信息。

# java - Android 上的照片库更新

> ID：16100374
> 
> 赞同：0
> 
> 时间：2013-04-19T08:25:03.610
> 
> 标签：java, android, gallery

我在使用 Eclipse 开发的 Android 应用程序时遇到问题。

问题是当我使用以下说明捕获新图像时：

intent.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, Uri.fromFile(file)); startActivityForResult（意图，TAKE_IMAGE）；设备将文件正确存储在正确的目标（extSdCard）中，但以下应该重新加载目录内容的代码在设备重新启动之前找不到新文件。

```
images.clear();
final String[] columns = { MediaStore.Images.Thumbnails._ID };
final String orderBy = MediaStore.Images.Media._ID;
String condition = MediaStore.Images.Media.DATA + " like '%/"+
Singleton.getCurrentPatient().getNrdo()+"/%'";

Cursor imagecursor =  getContentResolver().query(
            MediaStore.Images.Media.EXTERNAL_CONTENT_URI, columns,
            condition, null, orderBy);

if(imagecursor != null){
 int image_column_index = imagecursor
                .getColumnIndex(MediaStore.Images.Media._ID);
 int count = imagecursor.getCount();
 for (int i = 0; i < count; i++) {
            imagecursor.moveToPosition(i);
       int id = imagecursor.getInt(image_column_index);
       ImageItem imageItem = new ImageItem();
      imageItem.id = id;
      lastId = id;
      imageItem.img = MediaStore.Images.Thumbnails.getThumbnail(
                    getApplicationContext().getContentResolver(), id,
                    MediaStore.Images.Thumbnails.MICRO_KIND, null);
     images.add(imageItem);
 }
   imagecursor.close();
 }
notifyDataSetChanged(); 
```

}

不幸的是，我尝试了很多解决方案，但没有任何效果

我第一次使用这个代码

```
mScanner = new MediaScannerConnection(
AndroidCustomGalleryActivity.this,new MediaScannerConnection.MediaScannerConnectionClient() {
    public void onMediaScannerConnected() {
      mScanner.scanFile(imageUri.getPath(), null /* mimeType */);
 }
    public void onScanCompleted(String path, Uri uri) {
     if (path.equals(imageUri.getPath())) {
         mScanner.disconnect();
                AndroidCustomGalleryActivity.this
             .runOnUiThread(new Runnable() {
                 public void run() {
                    updateUI();
                  }
        });
         }
         }
     });
mScanner.connect(); 
```

imageUri 包含 onMediaScannerConnected 方法上的正确路径，但永远不会调用 onScanCompleted

然后我在拍摄照片后尝试了这些说明

```
sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, imageUri));    
updateUI(); 
```

再一次，updateUI 方法没有检测到新文件。

请问你能帮帮我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:27:02.417

使用你所有的东西：

```
sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED,
 Uri.parse("file://" +  Environment.getExternalStorageDirectory()))); 
```

在galary Scanner complate之后，使用以下代码从sdcard获取imageBitmap：

```
File imageFile = new File("/sdcard/gallery_photo_4.jpg");
ImageView jpgView = (ImageView)findViewById(R.id.imageView);
Bitmap bitmap = BitmapFactory.decodeFile(imageFile.getAbsolutePath());
jpgView.setImageDrawable(bitmap); 
```

# ios - 是否有任何可用于星级评定的控件？

> ID：16100378
> 
> 赞同：19
> 
> 时间：2013-04-19T08:25:05.973
> 
> 标签：ios, objective-c, rating, fractions

ios中是否有任何可用于星级评分的控件？所以我可以在 UITableviewCell 中使用它？

我知道有一些开源控件，例如 DYRating 等。但是我无法将它添加到 tableview 单元格中。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-08-18T04:27:32.677

我推荐[HCSStarRatingView](https://github.com/hugocampossousa/HCSStarRatingView)。它具有原生外观，还支持`IB_DESIGNABLE`和`IBInspectable`.

![HCSStarRatingView](https://i.stack.imgur.com/9RWHd.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-27T11:15:34.150

您可以查看 ASStar 评级。

将控件直接添加到您的视图控制器，或者您可以添加到您的单元格中。

这是 [github链接](http://github.com/yggg/ASStarRatingView)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-19T08:37:10.503

看看，它应该适合你：

[https://www.cocoacontrols.com/search?utf8=%E2%9C%93&q=star+rating](https://www.cocoacontrols.com/search?utf8=%E2%9C%93&q=star+rating)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-06T20:59:30.950

注意：这是一个“仅显示”的。 [![明星](https://i.stack.imgur.com/CE2Q6.png)](https://i.stack.imgur.com/CE2Q6.png)

我在这里采用了不同的方法，我使用带有星号的字体创建了一个带有属性字符串的标签，您可以在此处查看我的类别。我用了“SS Pika”字体，

```
#import "NSMutableAttributedString+Stars.h"

@implementation NSMutableAttributedString (Stars)

+ (NSAttributedString *)starWithRating:(CGFloat)rating
                            outOfTotal:(NSInteger)totalNumberOfStars
                          withFontSize:(CGFloat) fontSize{
    UIFont *currentFont = [UIFont fontWithName:@"SS Pika" size:fontSize];
    NSDictionary *activeStarFormat = @{
                                           NSFontAttributeName : currentFont,
                                           NSForegroundColorAttributeName : [UIColor redColor]
                                           };
    NSDictionary *inactiveStarFormat = @{
                                             NSFontAttributeName : currentFont,
                                             NSForegroundColorAttributeName : [UIColor lightGrayColor]
                                             };

    NSMutableAttributedString *starString = [NSMutableAttributedString new];

    for (int i=0; i < totalNumberOfStars; ++i) {
        //Full star
        if (rating >= i+1) {
            [starString appendAttributedString:[[NSAttributedString alloc]
                                               initWithString:@"\u22C6 " attributes:activeStarFormat]];
        }
        //Half star
        else if (rating > i) {
            [starString appendAttributedString:[[NSAttributedString alloc]
                                               initWithString:@"\uE1A1 " attributes:activeStarFormat]];
        }
        // Grey star
        else {
            [starString appendAttributedString:[[NSAttributedString alloc]
                                               initWithString:@"\u22C6 " attributes:inactiveStarFormat]];
        }

    }
    return starString;
}
@end 
```

用法：

```
self.ratingLabel.attributedText = [NSMutableAttributedString starWithRating:rating outOfTotal:5 withFontSize:9.0f]; 
```

这是 SWIFT 版本

```
extension NSMutableAttributedString{

    func starWithRating(rating:Float, outOfTotal totalNumberOfStars:NSInteger, withFontSize size:CGFloat) ->NSAttributedString{

        let currentFont = UIFont(name: "<USE UR FONT HERE>", size: size)!

        let activeStarFormat = [ NSFontAttributeName:currentFont, NSForegroundColorAttributeName: UIColor.redColor()];

        let inactiveStarFormat = [ NSFontAttributeName:currentFont, NSForegroundColorAttributeName: UIColor.lightGrayColor()];

        let starString = NSMutableAttributedString()

        for(var i = 0; i < totalNumberOfStars; ++i){

            if(rating >= Float(i+1)){
                // This is for selected star. Change the unicode value according to the font that you use
                starString.appendAttributedString(NSAttributedString(string: "\u{22C6} ", attributes: activeStarFormat))
            }
            else if (rating > Float(i)){
                // This is for selected star. Change the unicode value according to the font that you use
                starString.appendAttributedString(NSAttributedString(string: "\u{E1A1} ", attributes: activeStarFormat))
            }
            else{
                // This is for de-selected star. Change the unicode value according to the font that you use
                starString.appendAttributedString(NSAttributedString(string: "\u{22C6} ", attributes: inactiveStarFormat))
            }
        }

        return starString
    }
} 
```

用法：

```
starLabel.attributedText = NSMutableAttributedString().starWithRating(3.5, outOfTotal: 5, withFontSize: 8.0)
starLabelFull.attributedText = NSMutableAttributedString().starWithRating(5, outOfTotal: 5, withFontSize: 8.0)
starLabelZero.attributedText = NSMutableAttributedString().starWithRating(0, outOfTotal: 5, withFontSize: 8.0) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-05-05T11:57:24.877

**`Swift3`**

[https://github.com/marketplacer/Cosmos](https://github.com/marketplacer/Cosmos)

*   **安装吊舱**

    `target 'TargetName' do`

    `pod 'Cosmos'`

*   **使用此命令安装 pod 文件`pod install`**

*   **在你的故事板中放一个简单的 UIView 并给出类名`CosmosView`和模块名`Cosmos`**

[![在此处输入图像描述](https://i.stack.imgur.com/XiyYk.png)](https://i.stack.imgur.com/XiyYk.png)

**在这里您可以访问属性**

[![在此处输入图像描述](https://i.stack.imgur.com/Ikq03.png)](https://i.stack.imgur.com/Ikq03.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-19T09:16:46.080

您可以从 Cocoacontrols 检查以下控件。

[https://www.cocoacontrols.com/controls/star-rating-view](https://www.cocoacontrols.com/controls/star-rating-view)

[https://www.cocoacontrols.com/controls/scrratingview](https://www.cocoacontrols.com/controls/scrratingview)

[https://www.cocoacontrols.com/controls/amratingcontrol](https://www.cocoacontrols.com/controls/amratingcontrol)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-07-15T20:04:07.427

我刚刚编写了这个简单的 UIView 子类，它绘制了从 0 到 5 的星级评分，包括半颗星。您可以使用 tintColor 属性设置颜色并在界面编辑器中设置评级。视图宽度应设置为 5 * 高度。

[![星级](https://i.stack.imgur.com/ngv7d.png)](https://i.stack.imgur.com/ngv7d.png)

```
class StarsView: UIView {

    @IBInspectable var rating: Double = 5.0 {
        didSet {
            setNeedsLayout()
        }
    }

    func starPath(size: CGFloat, full: Bool) -> UIBezierPath {
        let fullPoints = [CGPoint(x: 0.5, y: 0.03), CGPoint(x: 0.61, y: 0.38), CGPoint(x: 0.99, y: 0.38), CGPoint(x: 0.68, y: 0.61), CGPoint(x: 0.8, y: 0.97), CGPoint(x: 0.5, y: 0.75), CGPoint(x: 0.2, y: 0.97), CGPoint(x: 0.32, y: 0.61), CGPoint(x: 0.01, y: 0.38), CGPoint(x: 0.39, y: 0.38)].map({ CGPoint(x: $0.x * size, y: $0.y * size) })
        let halfPoints = [CGPoint(x: 0.5, y: 0.03), CGPoint(x: 0.5, y: 0.75), CGPoint(x: 0.2, y: 0.97), CGPoint(x: 0.32, y: 0.61), CGPoint(x: 0.01, y: 0.38), CGPoint(x: 0.39, y: 0.38)].map({ CGPoint(x: $0.x * size, y: $0.y * size) })
        let points = full ? fullPoints : halfPoints
        let starPath = UIBezierPath()
        starPath.move(to: points.last!)
        for point in points {
            starPath.addLine(to: point)
        }
        return starPath
    }

    func starLayer(full: Bool) -> CAShapeLayer {
        let shapeLayer = CAShapeLayer()
        shapeLayer.path = starPath(size: bounds.size.height, full: full).cgPath
        shapeLayer.fillColor = tintColor.cgColor
        return shapeLayer
    }

    override func layoutSubviews() {
        super.layoutSubviews()
        let sublayers = layer.sublayers
        for sublayer in sublayers ?? [] {
            sublayer.removeFromSuperlayer()
        }
        for i in 1...5 {
            if rating >= Double(i) - 0.5 {
                let star = starLayer(full: rating >= Double(i))
                star.transform = CATransform3DMakeTranslation(bounds.size.height * CGFloat(i - 1), 0, 0)
                layer.addSublayer(star)
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-29T10:32:17.347

使用[https://github.com/hugocampossousa/HCSStarRatingView](https://github.com/hugocampossousa/HCSStarRatingView)。很容易实现这一点。只需写下这些代码行。在 .h 文件中为 IBOutlet HCSStarRatingView 创建一个用于存储评级值的字符串。

```
@property (weak, nonatomic) IBOutlet HCSStarRatingView *starRatingView;
@property (weak, nonatomic) NSString *ratingStr; 
```

在 .m 文件中写下这些行

```
self.starRatingView.maximumValue = 5;
self.starRatingView.minimumValue = 0;
self.starRatingView.value = 0;
self.starRatingView.tintColor = [UIColor yellowColor];
self.starRatingView.allowsHalfStars = YES;
self.starRatingView.emptyStarImage = [[UIImage imageNamed:@"heart-empty"] imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate];
self.starRatingView.filledStarImage = [[UIImage imageNamed:@"heart-full"] imageWithRenderingMode:UIImageRenderingModeAlwaysTemplate];
[self.starRatingView addTarget:self action:@selector(didChangeValue:) forControlEvents:UIControlEventValueChanged];

- (IBAction)didChangeValue:(HCSStarRatingView *)sender {
   NSLog(@"Changed rating to %.1f", sender.value);
  ratingStr = [NSString stringWithFormat:@"%.1f",sender.value];
  if([hostRatingStr isEqualToString:@"-0.0"]){
      self.ratingLbl.text = @"0.0";
  }else{
      self.ratingLbl.text = hostRatingStr;
   }
 } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-01-11T05:56:26.027

使用[https://github.com/shantaramk/RatingView](https://github.com/shantaramk/RatingView)。

实现这一点毫不费力。只需按照以下步骤操作：

**设置星景IBOutlet**

```
 @IBOutlet weak var rateView: StarRateView! 
```

**准备星级视图**

```
func setupStarRateView() {
    self.rateView.delegate = self
    self.rateView.maxCount = 5
    self.rateView.fillImage = UIImage(named: "fill_star")!
    self.rateView.emptyImage = UIImage(named: "empty_star")!
} 
```

**采用率查看代表**

```
extension RateServiceViewController: RatingViewDelegate {

func updateRatingFormatValue(_ value: Int) {
    print("Rating : = ", value)
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-11-30T11:04:37.027

是的，您可以使用许多库来制作此类控件，例如[用于评级控制的 cosmos Cosmos 库](https://github.com/evgenyneu/Cosmos/)

如果你想要看起来像评级图的东西（如图片中的那个），那么你可以[在 iOS 的 github 评级图视图中看到这个 repo](https://github.com/nikeshkrjha/StarRatingControl)

[![在此处输入图像描述](https://i.stack.imgur.com/TVgdE.png)](https://i.stack.imgur.com/TVgdE.png)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-06-03T17:06:18.067

如果您想要的只是整数个星，您可以使用一个简单的字符串数组并使用它来设置 UILabel 的 text 属性。

```
let ratingsDisplay = [
    "★☆☆☆☆",
    "★★☆☆☆",
    "★★★☆☆",
    "★★★★☆",
    "★★★★★"
]

let rating = 4
let label = UILabel()
label.text = ratingsDisplay[rating - 1] 
```

确保将 UILabel 的字体设置为以相同大小显示黑白星星的字体。许多但不是全部都这样做。

# php - 在 Colorbox 中使用 jQuery

> ID：16100379
> 
> 赞同：0
> 
> 时间：2013-04-19T08:25:10.270
> 
> 标签：php, javascript, jquery, colorbox

尝试在颜色框中使用 jQuery 时遇到一些问题。

当我从调用颜色框的页面调用任何 jQuery 时，它工作正常。

我的代码当前使用以下代码调用其中包含另一个页面的颜色框。

```
var page1 = '/page1/page.php';

jQuery(".page1click").colorbox({opacity:0.4, rel:'nofollow', href:page1, height:'700px', width: '702px', iframe:true}); 
```

这一切正常，我的代码显示在颜色框弹出窗口中。此外，我所有的 javascript 代码都在这个页面中工作。但是，当我尝试从颜色框中使用任何 jQuery 时，它不起作用。

我想要做的是在单击时隐藏一个 div。

如果有人可以提供帮助，那就太好了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:37:44.213

检查你是否在两个页面中都包含 jquery。这可能会产生冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:32:12.377

使用创建叠加层的插件，如 colorbox，它们会获取您的 html 标记并使用它在 DOM 中创建另一个元素。因此，您尝试隐藏的 div**可能与您用于创建它的 ID/类不同**。

当您查看由 Colorbox 创建的框时，请使用 firefox 中的 firebug 检查元素，以查看插件为您的 div 分配的 ID/类。

# google-apps - Google Apps 中的密码过期

> ID：16100380
> 
> 赞同：0
> 
> 时间：2013-04-19T08:25:10.957
> 
> 标签：google-apps, google-provisioning-api

是否可以使用 Google Provisioning API 设置密码的到期日期？或者检查密码的设置时间？

```
 <apps:login userName="NewUserName" 
  password="51eea05d46317fadd5cad6787a8f562be90b4446" hashFunctionName="SHA-1"
  suspended="false"/> 
```

根据协议示例，只有很少的字段，但可能像其他 api 中一样隐藏了其他一些字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T01:23:15.303

讨厌成为坏消息的承担者，但没有。

你可以做的是做一个 SSO，但要针对 Google Apps。

大多数有关 SSO 的文档都假定您需要针对 LDAP/Ad 进行身份验证。但我开发了一些直接针对 Google 进行身份验证的方法。

有两个原因：1 - 客户讨厌“非公司”登录屏幕 2 - 我可以强制密码过期（部分 SSO 正在开发密码更改）

理论上，您可以在 App Engine 中进行开发。

祝你好运！

# xml - 缺少 XML 执行权限？

> ID：16100381
> 
> 赞同：0
> 
> 时间：2013-04-19T08:25:12.550
> 
> 标签：xml, sql-server-2008r2-express

我已从 [https://stackoverflow.com/a/9714484/1678652获取此功能](https://stackoverflow.com/a/9714484/1678652)

```
SET @XML = N'<root><r>' + REPLACE(@s, @sep, '</r><r>') + '</r></root>'

INSERT INTO @result(Id)
SELECT DISTINCT r.value('.','int') as Item
FROM @xml.nodes('//root//r') AS RECORDS(r) 
```

它接受一个字符串并拆分成一个表格，每行都有一个元素。当我在 SSMS 中测试它时它可以工作，但是当我从 websserver (php/pdo) 调用它时，它返回一个空的结果集。

我认为它必须是具有 XML 权限的东西，因为如果我让函数将硬编码结果添加到表中，我**确实**会将结果返回给 php.ini。

如果我将参数硬编码到函数中，我**不会**得到 php 的结果，我可以更改函数以仅返回参数，因此这不是输入问题。

我想知道这是否相关：

[http://beingoyen.blogspot.dk/2009/06/tsql-error-execute-permission-denied-on.html](http://beingoyen.blogspot.dk/2009/06/tsql-error-execute-permission-denied-on.html)

> 解决方案很简单： GRANT EXECUTE ON XML SCHEMA COLLECTION::{XMLSchema1} TO {RestrictedLoginName}

但是这个 XML Schema 集合会被称为什么？在 SSMS 中，我可以浏览 XML Schema 集合类型的对象以向用户添加权限，但没有这种类型的对象。

我已将该功能的所有权限授予用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:29:56.747

我必须承认我不知道这两个函数之间的区别是什么，但我从[http://www.sqlperformance.com/2012/07/t-sql-queries/split-strings](http://www.sqlperformance.com/2012/07/t-sql-queries/split-strings)获得了这个函数：

```
ALTER FUNCTION [dbo].[Split]
(
   @Delimiter  NVARCHAR(255),
   @List       NVARCHAR(MAX)
)
RETURNS TABLE
WITH SCHEMABINDING
AS
   RETURN 
   (  
      SELECT val = y.i.value('(./text())[1]', 'nvarchar(4000)')
      FROM 
      ( 
        SELECT x = CONVERT(XML, '<i>' 
          + REPLACE(@List, @Delimiter, '</i><i>') 
          + '</i>').query('.')
      ) AS a CROSS APPLY x.nodes('i') AS y(i)
   ); 
```

但它按预期工作:-)

实际使用的是我的产品页面在mnogosearch中被索引；我进行搜索，获取产品 ID 列表，构建这些数字的空格分隔字符串。将此字符串传递给 sql 语句并返回产品表。

# r - Knitr：跟随另一个survplot时不会产生循环中的survplot

> ID：16100382
> 
> 赞同：3
> 
> 时间：2013-04-19T08:25:14.187
> 
> 标签：r, loops, knitr, survival-analysis

下面是一个最小的例子：

```
\documentclass{article}
\begin{document}

<<data, results='hide', echo=FALSE, include=FALSE>>= 
library(rms)
fake.survival.data <- Surv(1:30, rep(1, 30))
fit <- survfit(fake.survival.data ~ 1)  
@

<<threeplots>>=
survplot(fit, xlab = "zeroth plot")

for(j in c("first plot", "second plot")){
  survplot(fit, xlab = j)
}
@ 
```

在 for 循环中的两个图中，仅生成第二个（通常：仅生成最后一个）。问题似乎与 survplot 具体有关：如果我们在其中一个 survplot 之后添加一个普通图，例如：

```
\documentclass{article}
\begin{document}

<<data, results='hide', echo=FALSE, include=FALSE>>= 
library(rms)
fake.survival.data <- Surv(1:30, rep(1, 30))
fit <- survfit(fake.survival.data ~ 1)  
@

<<threeplots>>=
survplot(fit, xlab = "zeroth plot")
plot(c(1,1), xlab = "normal plot")
for(j in c("first plot", "second plot")){
  survplot(fit, xlab = j)
}
@ 
```

或者：

```
 \documentclass{article}
\begin{document}

<<data, results='hide', echo=FALSE, include=FALSE>>= 
library(rms)
fake.survival.data <- Surv(1:30, rep(1, 30))
fit <- survfit(fake.survival.data ~ 1)  
@

<<threeplots>>=
survplot(fit, xlab = "zeroth plot")

for(j in c("first plot", "second plot")){
  survplot(fit, xlab = j)
  plot(c(1, 1) xlab = j)
}
@ 
```

所有地块都在您期望的地方生成。

有谁知道这里发生了什么？

提前致谢，文森特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T06:09:56.833

这是由于`evaluate`包中的一个错误。我已经[修复它](https://github.com/hadley/evaluate/pull/31)并将补丁发送给包作者。目前，您可以

```
library(devtools)
install_github('evaluate', 'yihui')
install_github('knitr', 'yihui') 
```

# php - 将文件从 Google Chrome 文件系统上传到服务器

> ID：16100383
> 
> 赞同：0
> 
> 时间：2013-04-19T08:25:18.167
> 
> 标签：php, javascript, file-upload, filesystems

Chrome 有一个我正在使用的非常有用的文件系统 API。我想要做的是将存储在其中的文件上传到服务器。不幸的是，似乎可以将文件发送到服务器的唯一方法是提交一个表单，在该表单中，由于某些安全问题，用户明确选择要上传的文件。

任何帮助将非常感激。

彼得

* * *

所以我有这个想法。为什么不使用 FileReader 将 blob 转换为字符串，然后在请求正文中发送呢？

```
//entries[] contains a set of file objects
function readerSuccess(entries) {
   var i;
   for (i=0; i<entries.length; i++) 
   {
       if(entries[i].isFile === true)
       {
        data=new FormData();
    data.append('name',entries[i].fullPath);

    //Conversion...
    entries[i].file(function(file) {
            var reader = new FileReader();

            reader.onloadend = function(e) {
            var dataStr=this.result;

            };

        reader.readAsText(file);
     }, errorHandler);

   //Sending...
 data.append('file',dataStr);
 var oReq = new XMLHttpRequest();
 oReq.open("POST", "serv.php", true);
 oReq.send(data);

    }
    else if (entries[i].isDirectory === true)
    {
    getDirSuccess(entries[i]);
    }
  }
 } 
```

问题是它现在将 blob 作为单独的消息发送。例如：请求 URL:blob:http%3A//localhost/7492a164-ed62-4834-939c-e6437b52cba8 请求方法:GET 状态码:200 OK (from cache)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:29:29.083

我不完全确定您为什么在这里使用 FileReader。只需将每个 Blob/File 附加到您的 FormData 对象并发送它：

```
var data = new FormData();
if(entries[i].isFile)
{
   data.append('file' + i , entries[i]);
}

var oReq = new XMLHttpRequest();
oReq.open("POST", "serv.php", true);
oReq.send(data); 
```

# java - Java IO 传输问题

> ID：16100384
> 
> 赞同：1
> 
> 时间：2013-04-19T08:25:22.880
> 
> 标签：java, io

创建一个 FileUtils 类以重用所有 IO。我们通过共享将文件（随机数量）从一台 Unix 服务器传输到另一台。

**我的问题：** 随机一个文件将作为 0kb 文件通过，但没有例外，并说它传输成功。

**我们使用的基本方法：**

```
resultCode = 0;
    FileInputStream fis = null;
    FileOutputStream fos = null;
    try {
        fis = new FileInputStream(fileLocation + orginalFile);
        fos = new FileOutputStream(toFolder + destinationFile);
        byte[] buf = new byte[1024];
        int i = 0;
        while ((i = fis.read(buf)) != -1) {
            fos.write(buf, 0, i);
        }

        resultCode = 1;
    } catch (Exception e) {
        resultCode = 2;
        //our logging

    } finally {
        try {
            fis.close();
            fos.close();
        } catch (Exception e) {
//our logging
        }
    }

    return resultCode;
} 
```

关于可能导致这种情况的任何想法？每次传输单个文件时都会调用 FileUtils 类。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:37:44.657

在关闭之前刷新文件输出流[`fos.flush()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/OutputStream.html#flush%28%29)，我不确定它会解决你的问题，但值得一试：

> **public void flush() 抛出 IOException**
> 
> 刷新此输出流并强制写出任何缓冲的输出字节。flush 的一般约定是，调用它表示，如果先前写入的任何字节已被输出流的实现缓冲，则应立即将这些字节写入其预期目的地。

# c# - Linq-to-SQL 中的交叉连接效率如何？

> ID：16100386
> 
> 赞同：1
> 
> 时间：2013-04-19T08:25:23.690
> 
> 标签：c#, linq-to-sql

我知道，如果您使用 Linq-to-objects 执行交叉连接，则内部序列会针对外部序列的每个元素迭代一次。

以下代码演示了 的多次迭代`ints2`：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApplication1
{
    internal class Program
    {
        private static void Main()
        {
            var ints1 = Ints1();
            var ints2 = Ints2();

            var test = from i in ints1
                       from j in ints2
                       select i*j;

            foreach (var i in test)
                Console.WriteLine(i);
        }

        private static IEnumerable<int> Ints1()
        {
            Console.WriteLine("Starting  Ints1()");

            for (int i = 0; i < 5; ++i)
                yield return i;

            Console.WriteLine("Ending Ints1()");
        }

        private static IEnumerable<int> Ints2()
        {
            Console.WriteLine("Starting Ints2()");

            for (int i = 0; i < 5; ++i)
                yield return i;

            Console.WriteLine("Ending Ints2()");
        }
    }
} 
```

我的问题是这样的：

如果您在 Linq-to-SQL 中执行相同类型的查询，它会优化为 SQL`CROSS JOIN`吗？还是会多次评估内部序列（或做其他事情）？

（我几乎可以肯定它会被优化，但在搜索“网络”后，我没有找到任何关于此的结论性文档。）

* * *

[编辑]

我只是想提一下我问这个问题的原因。

`Resharper`如果您迭代 IEnumerable 两次，通常会警告您，但如果您使用嵌套执行交叉连接（例如在我上面的示例代码中） ，它*不会警告您。*`from`

我想知道为什么它没有警告您，并认为这可能是由于以下两个原因之一：

要么是疏忽，要么不需要，因为多重枚举对于嵌套来说不是问题，`from`因为它变成了 Linq-to-SQL 中的高效操作。我想是后一个原因。

现在您可能想知道是否`Resharper`仍应发出警告，因为 Linq-to-objects*将*多次枚举内部序列 - 但我想这不那么严重。

此外，我*实际上*从未在数据库上执行过这样的交叉连接（我也不打算这样做），但我*已经*在 Linq-to-objects 中使用了它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:46:10.387

Linq-to-SQL 将 linq 查询转换为在*数据库端*运行的 T-SQL 。

例如，如果你写：

```
from i in myContext.Table1
from j in myContext.Table2
select new {i,j} 
```

Linq-to-SQL 会将其转换为类似于以下内容的 T-SQL 查询：

```
SELECT * 
FROM Table1, Table2 
```

然后它将通过*只对结果集进行一次*迭代来为生成的匿名类型对象提供服务。

希望这是有道理的。

# wpf - 如何使用 WPF PrintDialog 打印多个页面范围

> ID：16100389
> 
> 赞同：3
> 
> 时间：2013-04-19T08:25:47.410
> 
> 标签：wpf, printing

我使用以下代码将视觉效果打印到打印机，页面范围从 1 到 3；

代码片段：

```
PrintDialog printDialog = new PrintDialog();
printDialog.PrintQueue = CurrentPrinter;
printDialog.PrintTicket = CurrentPrinter.UserPrintTicket;
printDialog.PageRangeSelection = PageRangeSelection.UserPages;
printDialog.UserPageRangeEnabled = true;
printDialog.PageRange = new PageRange(1, 3);
if((bool)printDialog.ShowDialog().GetValueOrDefault())
    printDialog.PrintDocument(Paginator, ""); 
```

目前我需要打印多个页面范围，例如 1-3,5-7。但是 WPF 打印对话框只支持一个页面范围，有没有办法呢？

提前致谢。

# jsf - 如何在不破坏当前功能的情况下更新 JSF Web 应用程序组件？

> ID：16100394
> 
> 赞同：0
> 
> 时间：2013-04-19T08:26:26.127
> 
> 标签：jsf, primefaces, richfaces, upgrade, icefaces

我有一个使用**RichFaces 4.1.0**的大型 Web 应用程序（100 多个 jsf 页面） 。我正在尝试**RichFaces 4.3.0**提供的新功能（例如**rich:placeHolder**）。这让我想到一个问题：如果我真的想使用新的 RichFaces 版本，我怎么知道升级是否安全？

我认为这是非常不安全的，因为不同的因素：旧的错误，新的错误，功能的变化，已经编写的代码（不一定是好的......），......

但是，我想知道，您通常如何在生产项目中处理此类问题。**是否可以通过使用JUnit**、**Mockito**、**Arquillian**或任何其他方法构建一个非常“*好*”的测试集来避免？或者，**一旦交付，让应用程序保持原样可能是最好的方法**？在这种情况下，我们将永远不会升级其中的任何 jar，（*尽可能避免*）？

 *******针对这个特定问题，RichFaces 团队开发了一个名为[CDK](http://www.bleathem.ca/blog/2011/11/richfaces-4-cdk-jqeury-ui-tabs.html)的内部框架，它提供组件独立性以促进模块化。这意味着我们可以使用**rich:placeHolder**组件并为其创建一个*jar*。然后我们必须将这个新*jar*添加到我们的应用程序中。这样可以避免升级所有主要的richfaces *jar*。这在这种情况下应该可以正常工作，因为**rich:placeHolder**是一个新组件，但如果我们尝试升级已经存在的组件，它将无法工作。

我认为同样的问题也适用于其他框架：Primefaces、Icefaces ......

您对如何承担升级问题有何建议？

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:10:38.273

这种升级有三种方法，这一切都取决于最适合您团队能力、预算和时间的方法。

## 1) 自动化网络测试

像[Selenium](http://docs.seleniumhq.org/)这样有用的 Web 测试框架可以让您记录 Web 应用程序与最新稳定版本的交互，并在 Web 应用程序的原型版本上回放记录的交互。

这里的学习曲线是这样的，技术熟练的 QA 分析师应该能够通过独立的记录来验证每个记录的需求。

## 2) 模块化升级

CDK 的想法听起来像是一种很好的规避风险的方法，可以随着时间的推移慢慢升级 JSF 框架。如果没有时间和人力，这可能是最好的方法。

## 3）QA蛮力

质量保证团队基本上将手动遍历所有需求的所有测试用例，并验证测试用例是否仍然通过。这与第一种方法一样耗费人力，但是下次升级前端库或框架时，整个过程将不得不重复。

## 网景方法

Netscape 因其在 90 年代浏览器大战中的垮台而闻名。让他们失望的是他们的测试和质量保证理念。他们认为用户应该是 QA，这是一个愚蠢的信念，因为用户对产品的 90% 的意见都是基于第一印象。

这种方法基本上是让开发人员暴力升级，直到它编译完成，做简单的冒烟测试，当一切似乎都正常时，将其发布到生产环境中，等待用户反馈确定错误。我不推荐这种方法，除非你有一个非关键的应用程序和一个固定的用户群。*******

# html - 使用 Webvtt 的字幕中的 HTML5 图形

> ID：16100395
> 
> 赞同：0
> 
> 时间：2013-04-19T08:26:30.957
> 
> 标签：html, video, subtitle

我试图`<track>`在 HTML5 中的 -Element 显示的视频字幕（Webvtt 格式）中实现很少的图形（使用 Chrome）。到目前为止，我使用 CSS 进行了尝试，`content:url()`但`background-image:url()`没有成功。有人对我如何解决我的问题有任何想法或提示吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-28T03:55:56.533

像这样使用 ::cue 选择器：

```
::cue {
  color: #FFF;
  background: transparent;
  text-shadow: black 0 0 0.2em;
  font: 1.2em sans-serif;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:42:35.100

1/你可以尝试使用z-index在video标签上添加div，不要使用track。2/然后你编写javascript函数用你的字幕更新div 3/你可以'css'它;）

# deployment - 如何将 Sinatra 应用程序作为 gem 发布并部署？

> ID：16100398
> 
> 赞同：5
> 
> 时间：2013-04-19T08:26:38.233
> 
> 标签：deployment, gem, sinatra, rack

我有一个 sinatra 应用程序并将其打包[为 gem](http://rubygems.org/gems/tubemp)。它的文件布局大致如下：

```
├── bin
│   └── tubemp
├── lib
│  └── tubemp.rb
├── Gemfile
└── tubemp.gemspec 
```

我可以很好地安装和运行它。调用`ruby lib/tubemp.rb`也会触发应用程序，因为 Sinatra 让它自动启动。`tubemp.rb`：

```
class Tubemp < Sinatra::Application
  get '/' do
    erb :index, :locals => { :title => "YouTube embeds without third party trackers." }
  end
end 
```

二进制文件也很简单。`bin/tubemp`：

```
#!/usr/bin/env ruby
require "tubemp.rb"
Tubemp.run! 
```

但现在我想将它部署为 Rack-app。或者将其部署在 Rack-app 中。至少它应该在生产机器上的乘客下运行。

对于通用应用程序，只需`config.ru`在应用程序所在的目录中添加一个即可。然后，该文件粗略地包含并调用`run Tubemp`. 将 nginx 或 apache 的乘客指向这个 rackup 文件和应用程序所在的目录，启动它。这很有效，直到我把它变成了一颗宝石；因为现在我不再有“应用程序所在的目录”，而是`gem install tubemp`决定放置文件的位置。

我是否需要创建一个`wrapper`捆绑 tubemp-gem 及其依赖项的应用程序？如果是这样，我如何从`rackup`文件中调用 gem？还是我完全错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T10:20:57.157

现在忽略[路径问题](http://www.sinatrarb.com/configuration.html#__the_applications_root_directory)，这是[我解决它](https://github.com/berkes/tubemp-site)的方法：

该应用程序捆绑为 gem `tubemp`，.

A`Gemfile`安装并包含 gemified 应用程序：

```
gem 'tubemp' 
```

运行 gemified 应用程序的A `config.ru`，称为`Tubemp`：

```
require 'rubygems'
require 'bundler/setup' # To allow inclusion via the Bundle/Gemfile
require 'sinatra'       # Sinatra is required so we can call its "set"
require 'tubemp'        # And include the application

# Set the environment to :production on production
set :environment, ENV['RACK_ENV'].to_sym

# And fire the application.
run Tubemp 
```

这两个文件是制作新机架应用程序所需的全部内容，其中包括 gemified Sinatra 应用程序，因此可以通过 nginx、passenger 或简单`rackup`的 .

# tsql - 为列切换行，为行切换列

> ID：16100400
> 
> 赞同：-2
> 
> 时间：2013-04-19T08:26:52.520
> 
> 标签：tsql, sql-server-2005, pivot, unpivot

我有这样的查询：

```
SELECT 
        Column,
        SUM(Row1) AS Row1,
        SUM(Row2) AS Row2,
        SUM(Row3) AS Row3,
        SUM(Row4) AS Row4,
        SUM(Row5) AS Row5,
        SUM(Row6) AS Row6,
        SUM(Row7) AS Row7,
        SUM(Row8) AS Row8,
        SUM(Row9) AS Row9,
        SUM(Row10) AS Row10,
        SUM(Row11) AS Row11,
        SUM(Row12) AS Row12,
        SUM(Row13) AS Row13,
        SUM(Row14) AS Row14,
        SUM(Row15) AS Row15,
        SUM(Row16) AS Row16,
        SUM(Row17) AS Row17
FROM #temp
GROUP BY
Column 
```

我得到这样的结果：

```
Column      Row1                                    Row2                                  
----------- --------------------------------------- --------------------------------------- 
1           45.00                                   0.00                                    
2           19.00                                   0.00 
```

并想得到这个：

```
Row          1                                       2                                  
----------- --------------------------------------- --------------------------------------- 
Row1         45.00                                   19.00                                    
Row2         0.00                                    0.00 
```

但是列号可能会有所不同，并且语法必须与 sql server 2005 兼容。我怎样才能达到这样的效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:41:22.167

根据您当前的查询并且您想要`column`列中的值，那么我的建议是应用 the`UNPIVOT`和然后应用该`PIVOT`函数。

UNPIVOT 函数将采用多个`row1`,`row2`等列并将它们转换为多行。然后您可以获取值并将它们转换为列。

查询将是：

```
select row, [1], [2]
from
(
  select [column], [row], value
  from #temp
  unpivot
  (
    value
    for row in (row1, row2, row3, row4, row5, row6,
                row7, row8, row9, row10, row11, row12,
                row13, row14, row15, row16, row17)
  ) un
) src
pivot
(
  sum(value)
  for [column] in ([1], [2])
) piv; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/6c620/3)。

如果您有已知数量的值，则上述版本会很好用，但如果值未知，那么您将需要对 PIVOT 和 UNPIVOT 使用动态 SQL：

```
DECLARE @colsUnpivot AS NVARCHAR(MAX),
   @cols AS NVARCHAR(MAX),
   @query  AS NVARCHAR(MAX)

select @colsUnpivot = stuff((select ','+quotename(C.name)
         from sys.columns as C
         where C.object_id = object_id('yt') and
               C.name != 'column'
         for xml path('')), 1, 1, '')

select @cols = STUFF((SELECT distinct ',' + QUOTENAME([column]) 
                    from yt
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query 
  = 'select row, '+@cols+' 
     from
     (
       select [column], [row], value
       from yt
       unpivot
       (
          value
          for [row] in ('+ @colsunpivot +')
       ) u
      ) src
      pivot
      (
        sum(value)
        for [column] in ('+@cols+')
      )piv'

exec(@query); 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/6c620/6)。两者都给出结果：

```
|  ROW |   1 |   2 |
--------------------
| row1 |  55 |  93 |
| row2 | 112 |  21 |
| row3 | 523 |  24 |
| row4 | 665 | 179 | 
```

# java - 如何在 android 中通过清理来处理全局状态

> ID：16100401
> 
> 赞同：1
> 
> 时间：2013-04-19T08:26:58.370
> 
> 标签：java, android

我正在开发一个具有一些全局状态（包括几个`SoundPool`s，需要一段时间才能加载）的 android 应用程序，我正在寻找管理它的最佳方法。到目前为止，我可以看到两个选项，但都不是完美的：

1.  将状态存储在我的主目录中`Activity`- 这很好地挂钩到`Activity`生命周期（有机会清理），并且我可以使用屏幕旋转`onRetainNonConfigurationInstance`并`getLastNonConfigurationInstance`保留状态，但是当在活动之间导航时，此状态将完全丢失并且必须重新 -加载，这将是不可接受的慢

2.  将状态存储在全局单例或`Application`子类中 - 这允许状态在活动之间的导航中持续存在，但由于 Application 没有`onDestroy`事件，因此没有机会释放`SoundPool`s

关于更好的方法来做到这一点的任何建议？或者我不应该担心在应用程序停止/终止时释放 SoundPools 吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:08:05.553

两者不仅不完美，而且实际上是非常糟糕的架构。

单例模式普遍受到越来越多的批评，而对于 Android 来说，情况更糟，因为您无法保证您的 Application 对象会持续存在（系统会在资源不足时将其杀死，这不是错误，而是正确的行为） .

onRetainNonConfigurationInstance 自 API 级别 13 起已弃用，Android 团队本身将其描述为“肮脏的黑客”；那也不是你想要使用的。

您可以通过将其托管在独立于您的活动的服务中来解决您的 Soundpool 持久性问题。一旦不再需要播放任何内容，请确保终止该服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T12:18:14.957

好的，这不是一个完整的答案，但我会跟进一个更具体的问题。

但原则上，拥有一个本地`Service`确实可以按以下方式工作：

*   有一个本地“绑定”服务持有状态
*   有各种活动，每次绑定和解除绑定到服务，例如：

 `````
@Override
public void onStart() {
    super.onStart();
    Intent intent = new Intent(this, LocalStateService.class);
    bindService(intent, serviceConnection, Context.BIND_AUTO_CREATE);
}

@Override
public void onStop() {
    if (stateService != null) {
        unbindService(serviceConnection);
        stateService = null;
    }
} 
````  `由于活动生命周期故意重叠，服务将一直存在，直到用户退出应用程序（或干脆离开它并去做其他事情）。此时，`onUnbind`再`onDestroy`调用该服务。

太好了，我们快到了。但是，该服务无法在配置重新启动（例如屏幕旋转）后继续存在，所以我将把它作为一个单独的问题发布......``

# perl - 如何在 perl 中理解这一点

> ID：16100408
> 
> 赞同：2
> 
> 时间：2013-04-19T08:27:06.203
> 
> 标签：perl

```
my @skipper = qw(blue_shirt hat jacket preserver sunscreen);
my @skipper_with_name = ('The Skipper' => \@skipper); 
```

如何理解第二行？

```
print @skipper_with_name; 
```

得到以下消息：

```
The SkipperARRAY(0x209cf90) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:29:45.863

前面的反斜杠`@skipper`获取对数组的引用。

如果您执行以下操作，则可以查看实际结构：

```
use Data::Dumper;
print Dumper \@skipper_with_name; 
```

也许您想要一个哈希来代替第二个数组，这意味着它`The Skipper`可以用作访问的键`@skipper`：

```
my %skipper_with_name = ('The Skipper' => \@skipper);
print Dumper \%skipper_with_name;
my @skipper_copy = @{$skipper_with_name{'The Skipper'}}; 
```

请注意我过去是如何`@{...}`取消引用数组引用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T08:35:29.977

正如 Stevenl 所提到`Data::Dumper`的，如果您将引用传递给它，则只打印出数组或哈希的结构，而不是结构本身。否则它会打印出结构是什么`(ARRAY)`以及它的内存地址。

另外，如果您希望`@skipper_with_name`是 a`HASH`而不是 a `ARRAY`，我会指出`@`仅用于数组，`%`是 a 的符号`HASH`（所以它会是`%skipper_with_name`）。此外，虽然`=>`在哈希中最常用于显示键/值关系，但它本质上只是一个逗号，因此可以毫无错误地用于创建数组。

```
my @skipper_with_name = ('The Skipper' => \@skipper); 
```

是相同的：

```
my @skipper_with_name = ('The Skipper',  \@skipper); 
```

你可以在这里看到：

```
 $skipper_with_name[0] = 'The Skipper' 
 $skipper_with_name[1] = \@skipper 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:34:51.683

`\`它是一个新的 Array，它具有对存储在其中的初始数组的引用（数组前面的斜线）。如果你打印它，你只会得到内存地址，你需要首先通过再次添加`@`符号来取消引用它以获取哈希的内容。

然而这没有任何意义，数组只能有数字索引。您可能想要做的是使用哈希。

```
my %skipper_with_name = ('The Skipper' => \@skipper); 
```

`'The Skipper'`现在您可以通过标识符引用数组。

```
print Dumper $skipper_with_name{'The Skipper'};
#or
print @{ $skipper_with_name{'The Skipper'} }; 
```

# php - 使用比率而不是单个输入来制作“like bar”？

> ID：16100413
> 
> 赞同：1
> 
> 时间：2013-04-19T08:27:16.967
> 
> 标签：php, output, social-media-like

你知道 YouTube 上有一个喜欢和不喜欢的栏吗？但它会根据比例而变化（即，条形始终大小相同，绿色和红色部分只是根据喜欢/不喜欢的比例占据不同的数量。

我在投票页面上有大约 200x5 的空间可以填充，并且我知道如何分配，例如，每个按钮单击 1 个像素，但是如果我只有 1 次单击或 1,000,000 次单击，这将是不好的，因为它看起来在我的页面上很可笑。所以我需要它是“基于比率的”而不是“基于数字的”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:35:09.830

假设您有 $likes（总喜欢）、$votes（总喜欢 + 不喜欢）和 $barWidth（条形的总宽度，以像素为单位...

首先得到比率：

```
$likesRatio = $likes/$votes; 
```

因此，如果您从 3 票中获得 1 个赞，这将产生 0.33。

然后乘以像素数：

```
$likesPixels = $likesRatio * $barWidth;
$dislikesPixels = $barWidth - $likesPixels; 
```

所以 0.33 * 200 = 66 像素，红色将是 134 像素 (200 - 66)。

然后分配像素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:35:30.647

为什么不直接计算比率并将其乘以像素数？

在 PHP 中：

```
// inputs: $n_likes, $n_dislikes 

$bar_width = 200; 
$bar_height = 5; 

$ratio = $n_likes/($n_likes + $n_dislikes); 

$n_green_pixels = round($bar_width * $ratio); 
// not even needed: $n_red_pixels = $bar_width - $n_green_pixels; 

// create a bar-image: 
$bar = imagecreatetruecolor($bar_width, $bar_height); 

// fill the whole image with red color: 
$red = imagecolorallocate($bar, 255, 0, 0);
imagefilledrectangle($bar, 0, 0, $bar_width-1, $bar_height-1, $red); 

if($n_green_pixels > 0)
{
  // draw a green line over the red background: 
  $green = imagecolorallocate($bar, 0, 255, 0);
  imagefilledrectangle($bar, 0, 0, $n_green_pixels-1, $bar_height-1, $green); 
}

// output the image and perform cleanup: 
imagepng($bar); // here: output directly to the browser, include filename as 2nd argument to write to a file 
imagedestroy($bar); 
```

# django - 如何防止在 Django 模板中多次包含静态文件？

> ID：16100417
> 
> 赞同：0
> 
> 时间：2013-04-19T08:27:25.810
> 
> 标签：django, include, django-templates

我有一些模板标签，其中在标题中包含一些 JavaScript 和 CSS 文件。问题是，如果我在同一个模板中多次使用这些标签，这些文件会被不必要地包含多次。有没有一种传统的方法来防止这种情况发生。（就像`#ifdef`在 C++ 中一样）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:35:25.183

我认为您需要组织您的模板，以便在顶层层次结构中包含包含，并且仅在您需要它的模板中从它继承。

Django 提供了一个非常强大的机制来扩展模板[https://docs.djangoproject.com/en/dev/ref/templates/builtins/](https://docs.djangoproject.com/en/dev/ref/templates/builtins/)但我认为你实际上并不需要类似预处理器的守卫，你可以去大部分时间在他们周围工作。

也许您需要的最实际示例将有助于了解您的问题。

# entity-framework - Entity Framework 5 不生成 [Key] 属性

> ID：16100418
> 
> 赞同：5
> 
> 时间：2013-04-19T08:27:33.950
> 
> 标签：entity-framework, visual-studio-2012, entity-framework-5

我将 EF5 与 VS2012 一起使用，并且在生成表时遇到了问题。

1）我创建了一个包含 2 个表的简单数据库模式（edmx）：

*   表 1：人
*   属性：Id（Guid）
*   属性：名称（字符串）

*   表 2：角色

*   属性：Id（Guid）
*   属性：类型（字符串）
*   属性：PersonId(Guid)（与表Person关联）

2）将唯一键（称为Id）的属性定义为：

*   并发模式：无
*   默认值：无
*   实体键：真
*   吸气剂：公共
*   姓名：身份证
*   可空：假
*   二传手：公开
*   StoreGeneratedPattern：身份
*   类型：Guid（我也尝试过 Int32）

3）Entity模型的属性是：

*   代码生成策略：无
*   数据库生成工作流程：TablePerTypeStrategy (VS)
*   数据库模式名称：dbo
*   DDL 生成模板：SSDLToSQL10.tt (VS)
*   实体容器访问：公共
*   实体容器名称：DatabaseSchemaContainer
*   延迟加载启用：真
*   元数据工件处理：嵌入输出程序集
*   命名空间：DatabaseSchema
*   复数新对象：错误
*   保存时转换相关文本模板：True
*   更新属性方面：真
*   验证构建：真

4）生成了相关的类，但是[Key]属性不存在：

```
using System;
using System.Collections.Generic;

public partial class Person
{
    public Person()
    {
        this.Role = new HashSet<Role>();
    }

    //[Key] <-- Missed!
    public System.Guid Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Role> Role { get; set; }
} 
```

5）我创建了一个域服务来向客户端公开上述实体，例如：

```
[EnableClientAccess]
public class DomainService1 : DomainService
{
    [Query]
    public IEnumerable<Person> GetPersonSet()
    {

    }

    [Update]
    public void UpdatePerson(Person person)
    {

    }

    [Insert]
    public void InsertPerson(Person person)
    {

    }

    [Delete]
    public void DeletePerson(Person person)
    {

    }
} 
```

6）重建并得到错误：

DomainService 'DomainService1' 中的实体 'Person' 没有定义键。DomainService 操作公开的实体类型必须至少具有一个标有 KeyAttribute 的公共属性。

任何建议表示赞赏！

啤酒

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-03T06:54:20.670

您可以尝试更改 .tt 生成模板的代码并在生成时向类添加属性。在您的情况下，您可以像这样更改属性生成方法：

```
public string Property(EdmProperty edmProperty)
{
    return string.Format(
        CultureInfo.InvariantCulture,

        //Custom check for key field
        (_ef.IsKey(edmProperty) ? "[Key]" : "") +

        "{0} {1} {2} {{ {3}get; {4}set; }}",
        Accessibility.ForProperty(edmProperty),
        _typeMapper.GetTypeName(edmProperty.TypeUsage),
        _code.Escape(edmProperty),
        _code.SpaceAfter(Accessibility.ForGetter(edmProperty)),
        _code.SpaceAfter(Accessibility.ForSetter(edmProperty)));
} 
```

并向每个生成的类添加命名空间声明：

```
public string UsingDirectives(bool inHeader, bool includeCollections = true)
{
    return inHeader == string.IsNullOrEmpty(_code.VsNamespaceSuggestion())
        ? string.Format(
            CultureInfo.InvariantCulture,

            //Namespace for KeyAttribute goes here
            "{0}using System; using System.ComponentModel.DataAnnotations;{1}" +
            "{2}",
            inHeader ? Environment.NewLine : "",
            includeCollections ? (Environment.NewLine + "using System.Collections.Generic;") : "",
            inHeader ? "" : Environment.NewLine)
        : "";
} 
```

完成后，您可以单击 .tt 上的右键并选择“运行自定义工具”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-25T16:37:46.183

虽然这个答案最初来自 EF4，但我怀疑情况仍然如此：

> T4 模板不使用数据注释，因为从模板生成的类不需要它们。（[来源](https://stackoverflow.com/a/8423806/163495)）

我怀疑这也可能与以下事实有关：在代码中您不需要 KeyAttribute，除非您使用不遵循约定的键字段（例如，Id 和 PersonId 自动用作 Person 实体上的键）。如果您在模型优先路线上不太远，也许考虑使用代码优先？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-25T18:54:57.120

vs2012 不是创建数据库模型的正确工具（还不是？）。您可以更好地使用 visio（不是 2013！）或 SQL Server Management Studio。而且你不需要它，99% 的数据建模工作是创建正确的模型，而不是 Vs2012 尝试的，以自动化到 c# 的一小步。

这就是 vs2012 中不包含您需要的明显功能的原因。也许永远不可能，因为 vs2012 是针对代码优先开发人员的。

# iphone - 如何以编程方式在 iphone 中执行应用程序音频的内部录制

> ID：16100421
> 
> 赞同：1
> 
> 时间：2013-04-19T08:27:46.853
> 
> 标签：iphone, objective-c, audio-recording

我想记录在 iphone 上运行的应用程序中播放的声音，但不记录来自麦克风的周围声音。所以请帮我如何进行内部录音

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-19T09:47:14.083

请参阅 AVAudioRecorder 上的苹果文档：

[ [https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAudioRecorder_ClassReference/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAudioRecorder_ClassReference/Reference/Reference.html)

它从 iOS 4 开始可用。

# c# - .net 检查用户是否登录 signalR

> ID：16100422
> 
> 赞同：2
> 
> 时间：2013-04-19T08:27:48.027
> 
> 标签：c#, asp.net, asp.net-mvc, signalr, signalr-hub

有没有办法检查用户是否在集线器中登录？

我知道我可以使用它，但是 HttpContext 在集线器中不可用：

```
HttpContext.Current.User.Identity.IsAuthenticated 
```

-问题是我正在向一群用户发送数据，并假设其中一个客户端有一段时间不活动并且他/她的会话到期。

我想做的是在我的 Hub => Send() 方法（从事件中调用）中，检查用户是否仍然登录，如果没有，我会向他/她的浏览器发送一条消息以重新加载页面.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:29:13.583

如果您只希望经过身份验证的用户能够连接/发送到集线器，则可以在集线器上使用 Authorize 属性。如果您想获取当前用户，那么您只需要访问 Context.User （它是集线器上可用的属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:50:28.003

你可以检查使用`Context.User.Identity.IsAuthenticated`

```
public class Chat : Hub
{
    public void send(string message)
    {
        Clients.addMessage(message);
    }

    public void securesend(string message)
    {
        if (this.Context.User.Identity.IsAuthenticated)
        {
            // secure send.
        }
    }
} 
```

[参考](https://stackoverflow.com/questions/9991035/securing-signalr-calls)

# jquery-mobile - 为什么简单的 jQuery 移动表格显示转置？

> ID：16100425
> 
> 赞同：0
> 
> 时间：2013-04-19T08:27:54.967
> 
> 标签：jquery-mobile

放在页面示例（和简单）表上：

```
<table id="myTable">
<thead>
    <tr>
        <th>Column 1</th>
        <th>Column 2</th>
        <th>Column 3</th>
    </tr>
</thead>
<tbody>
    <tr>
        <td>Row 1 Column 1</td>
        <td>Row 1 Column 2</td>
        <td>Row 1 Column 3</td>
    </tr>
    <tr>
        <td>Row 2 Column 1</td>
        <td>Row 2 Column 2</td>
        <td>Row 2 Column 3</td>
    </tr>
</tbody>
</table> 
```

显示不出意外 - 标题是一行，内部是 trs - 行。看这个：

```
Column 1    Column 2    Column 3
Row 1 Column 1  Row 1 Column 2  Row 1 Column 3
Row 2 Column 1  Row 2 Column 2  Row 2 Column 3 
```

然后尝试制作 jQuery 样式的表格 - 只需将 data-role="table" 添加到表格标签。惊喜 - 转置的表：1）头部是列（！）2）行是列。看这个：

```
Column 1Row 1 Column 1
Column 2Row 1 Column 2
Column 3Row 1 Column 3
Column 1Row 2 Column 1
Column 2Row 2 Column 2
Column 3Row 2 Column 3 
```

这是默认行为吗？这是怎么回事？如何强制jQuery表正常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:34:27.907

`data-mode's`默认情况下有两个' `reflow`，其中它将表格列折叠成堆叠的表示形式，看起来像每行的标签/数据对块。这种行为仅在移动设备中很明显，但是在桌面/平板电脑中，这看起来就像一张普通的桌子。

具有大量列的大表不适合较小的屏幕，因此还有另一种称为 as 的模式`columntoggle`允许用户切换列。

然而，为了在桌面浏览器中看到默认的表结构，要么摆脱`data-role`属性，要么设置`data-role='none'`

放`data-mode="columntoggle"`

```
<table data-role="table" id="my-table" data-mode="columntoggle">
    <thead>
        <tr>
            <th>Column 1</th>
            <th>Column 2</th>
            <th>Column 3</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Row 1 Column 1</td>
            <td>Row 1 Column 2</td>
            <td>Row 1 Column 3</td>
        </tr>
        <tr>
            <td>Row 2 Column 1</td>
            <td>Row 2 Column 2</td>
            <td>Row 2 Column 3</td>
        </tr>
    </tbody>
</table> 
```

添加以下样式以隐藏列按钮：

```
.ui-table-columntoggle-btn { display: none;} 
```

[**演示**](http://jsfiddle.net/maheshsapkal/CGAn4/1/)

# doxygen - Doxygen 如何避免换行间距

> ID：16100427
> 
> 赞同：1
> 
> 时间：2013-04-19T08:28:02.470
> 
> 标签：doxygen, line-breaks, spacing

如果我想通过doxygen`<br>`或`\n`在 doxygen 中强制换行以避免行间距（例如地址），怎么可能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T14:29:32.920

Doxygen 理解 HTML 并会插入一个换行符`<br>`。见： http: [//www.doxygen.nl/manual/htmlcmds.html](http://www.doxygen.nl/manual/htmlcmds.html)

# hyperlink - 在asp.net中将boundfield转换为超链接？

> ID：16100428
> 
> 赞同：1
> 
> 时间：2013-04-19T08:28:04.060
> 
> 标签：hyperlink

我想问一下如何将其转换为超链接？

```
 <asp:BoundField DataField="ProductName" HeaderText="Product Name" ReadOnly="True" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T11:19:18.060

[HyperLinkField](http://msdn.microsoft.com/pl-pl/library/system.web.ui.webcontrols.hyperlinkfield.aspx)应该适合这个。它看起来像：

```
<asp:HyperLinkField DataNavigateUrlFields="MyUrl"
                    DataTextField="ProductName"
                    HeaderText="Product Name"
                    Target="_blank"
/> 
```

其中*MyUrl*是包含超链接的 DataSource 中的公共属性名称。*使用DataNavigateUrlFormatString*属性格式化 URL 可能很有用，例如：

```
DataNavigateUrlFormatString="/display/something/form.aspx?ID={0}" 
```

如果你想构建更复杂的锚的*href*属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-11T01:10:43.693

示例完成：

```
<asp:HyperLinkField DataNavigateUrlFields="COD_DISC" datanavigateurlformatstring="~\otherview.aspx?COD_DISC={0}"  DataTextField="NOM_DISC" HeaderText="Name Column" Target="_self"/> 
```

然后你在'otherview'中得到查询字符串的值。例子：

```
 if (Request.QueryString["COD_DISC"] != null)
            urlParamentro = Request.QueryString["COD_DISC"].ToString(); 
```

# android - 我应该如何在 Android 上保存图像？

> ID：16100429
> 
> 赞同：-4
> 
> 时间：2013-04-19T08:28:09.640
> 
> 标签：android, image, file, caching, save

我想知道在 Android 上保存图像的最有效方法是什么。

我的应用程序基本上是这样的：你看到一张默认信用卡，接下来你可以选择扫描一个条形码（使用 zxing），然后它会为它生成一个 QR 码，并将 QR 码放在 ImageView 中默认卡已存储。

到目前为止，一切都很好; 但是，应用程序在离开结果（应用程序中的另一个屏幕，转到设备的主屏幕等）并返回屏幕时记住要显示的图像存在问题。它再次显示默认卡。

现在，我知道我必须保存二维码，但我想不出解决方案。该设备没有 SD 卡，因此无法保存到外部存储设备。

我尝试通过 SharedPreferences、OutputStream 和缓存来解决它；但无法让它工作。

您会选择这 3 种方式中的哪一种（或者可能是不同的方式，欢迎所有帮助），代码是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:51:15.143

```
public boolean saveBitmap(Bitmap image, String name){
    try {
        FileOutputStream fos = context.openFileOutput(name, Context.MODE_PRIVATE);
        image.compress(Bitmap.CompressFormat.JPEG, 70, fos);
        fos.close();
        return true;
    }
    catch (Exception e) {
        e.printStackTrace();
        return false;
    }
}

public Bitmap getBitmap(String name){
    try {
        FileInputStream fis = context.openFileInput(name);
        Bitmap image = BitmapFactory.decodeStream(fis);
        return image;
    }
    catch (Exception e) {
        e.printStackTrace();
        return null;
    }
} 
```

# c++ - C++ 在两个不同的类中实现一个接口

> ID：16100432
> 
> 赞同：0
> 
> 时间：2013-04-19T08:28:16.453
> 
> 标签：c++, interface

我正在尝试为我的 gui 实现抽象一个通用接口，但我很难弄清楚如何干净地做到这一点。这是我想要实现的简化版本。

```
class IBorderable
{
    virtual unsigned int getBorderWidth(BorderIndex index) const = 0;
    virtual void setBorderWidth(BorderIndex index, unsigned int width) = 0;
};

class Square : public IBorderable
{
    // Implement while limiting BorderIndex to only 4
    // Calling with invalid BorderIndex is handled at compile time
};

class Cube : public IBorderable
{
    // Implement while limiting BorderIndex to only 6
}; 
```

理想情况下，我想通过多态性来做到这一点，而不需要任何条件检查来确保 BorderIndex 在范围内。是否有可能让它在编译时抛出错误？我本来希望使用强类型枚举，但它们无法派生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:56:52.513

如果没有使通用接口的整个点无用的技巧，恐怕在编译时检查是不可能的。在运行时执行它当然很容易。

只有一个 IBorderable 引用/指针的编译器不知道它背后有什么样的派生对象，它也不需要——这就是接口和虚函数的全部意义所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:48:20.117

您可以使 IBorderable 成为模板，并使用 std::enable_if 使对无效索引的调用在编译时失败。

但我建议您将 IBorderable 设为包含 n 个 Border 实例的容器，并在运行时访问无效索引时处理错误。我觉得模板化（编译时最大索引检查）解决方案增加的复杂性是不值得的。

# java - SWT 文本图标搜索选项

> ID：16100436
> 
> 赞同：4
> 
> 时间：2013-04-19T08:28:29.640
> 
> 标签：java, swt

在 RCP 应用程序中，我使用 SWT Text 如下 -

`Text text = new Text(shell, SWT.SEARCH | SWT.ICON_CANCEL | SWT.ICON_SEARCH);`

在里面`Text`有一个选项来获取搜索和取消的图标。我在 Ubuntu Linux 上得到这个图标，而在 Windows 7 上这个图标不可见。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T08:38:05.867

Windows 不支持此功能。

[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=293230)有一个错误报告，其中包含一些如何自己实现它的建议。

# prolog - 如何使用 Prolog 中的读取谓词读取 .txt 文件中的所有 Prolog 谓词？

> ID：16100438
> 
> 赞同：1
> 
> 时间：2013-04-19T08:28:30.790
> 
> 标签：prolog

我正在使用 SWI Prolog 学习 Prolog。考虑一下我有一个名为**myFile.txt**的文件，其中包含以下内容：

```
line1.
line2.
line3. 
```

现在我正在尝试创建一个谓词，使用**读取**谓词必须读取此文件的内容，我创建了以下谓词：

```
readFileSee(InputFile) :- seeing(OldStream),
                          see(InputFile),
                          read(Term),
                          write(Term),
                          seen,
                          see(OldStream). 
```

问题是，当我执行这个程序时，我只获得第一行。例如，如果我启动此语句，我将获得：

```
?- readFileSee('/home/andrea/Documenti/prolog/lezione6/project/myFile.txt').
line1
true. 
```

**read**谓词读取**Prolog 术语**，但为什么只读取第一个术语？我该怎么做才能让它读取文件中包含的所有条款？我可以使用**读取**谓词吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:23:29.117

你可以使用重复：

```
readFileSee(InputFile) :- seeing(OldStream),
                          see(InputFile),
                          repeat,
                          read(Term),
                          ( Term == end_of_file -> true ; 
                            write(Term), fail
                          ),
                          seen,
                          see(OldStream). 
```

# c# - 从脚本调用两个控制器方法

> ID：16100451
> 
> 赞同：0
> 
> 时间：2013-04-19T08:29:02.340
> 
> 标签：c#, javascript, jquery, asp.net-mvc-4

我试图在我的控制器中调用两种方法。一个启动转换，另一个将转换百分比返回到视图以更新进度条。在调用 getPercentage 函数之前，通过单击“startConversion”按钮来启动转换。但是，只有转换开始，而百分比函数不会。我已经尝试先启动百分比函数并且它可以工作，但是在我按下转换按钮后 setTimeout 停止并且它不会再更新了。

有没有人有什么可能是错误的建议以及任何解决方法？

```
//View
<script type="text/javascript" >
    $(window).load(function () {
        startConvert();
    });

    function startConvert() {
        document.getElementById("startConversion").click()
        getPercentage();
    }

    function getPercentage() {
            $.ajax(
            {
                type: "POST",
                url: "@Url.Action("GetPercentage","File")",
                success: function (result) {
                    $('#div').html(result);
                    var r = result;
                    progressBarSim(r);
                },
                error: function (req, status, error) {
                    alert("Fail");
                }
            });
        setTimeout(getPercentage, 500);
    }

</script>

<form action="" method="post" enctype="multipart/form-data">         
    <input id="startConversion" type="Submit"  name="Convert" />
</form>

//FileController
[HttpPost]
public double GetPercentage() {
    return enc.Percent;
}

[HttpPost]
public ActionResult Convert()
{
... //Removed
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:35:39.247

您正在提交表单，这基本上会导致浏览器加载新页面（无论表单操作的结果是什么），这就是似乎从未调用 getPercentage() 方法的原因。

最简单的方法是使用 ajax 提交表单，但是您似乎希望用户上传文件，而这些文件不能通过 ajax 提交。

因此，我建议将表单上的目标设置为页面上不可见的 iframe。这将使表单提交到该 iframe（因此结果将加载到 iframe 中，并且不会导致在主窗口中加载新页面）。

即，类似：

```
 <iframe name="uploadTarget" src="" style="position:absolute;left:-9999px"></iframe>
  <form action="" method="post" enctype="multipart/form-data" target="uploadTarget">
  ... etc ... 
```

如果要跟踪实际上传的进度，则需要查看其他选项，例如使用[http://blueimp.github.io/jQuery-File-Upload/](http://blueimp.github.io/jQuery-File-Upload/)

编辑：使用 ajax 提交表单：

```
function startConvert() {
    var form = $("#startConversion").closest("form");
    $.post(form.attr('action'), form.serializeArray());
    getPercentage();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:35:52.843

为什么不尝试在方法本身`setInterval(getPercentage, 500);`内部调用，而不是一次又一次地调用。`startConvert``setTimeout`

# django - 没有模块名为六

> ID：16100454
> 
> 赞同：11
> 
> 时间：2013-04-19T08:29:17.873
> 
> 标签：django, six-python

安装`transifex`和 ./manage.py 后出现以下错误：

```
Error: No modules named six. 
```

Python Six 安装在 virtualenv 中（来自[https://pypi.python.org/pypi/six](https://pypi.python.org/pypi/six)） Django 版本为 1.4

任何帮助都会很棒！thx 和最好的问候迈克尔

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-19T09:50:55.757

`django.utils.six`在 Django 1.4.2 中添加，请参阅

[https://docs.djangoproject.com/en/1.5/topics/python3/#philosophy](https://docs.djangoproject.com/en/1.5/topics/python3/#philosophy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T10:33:45.250

我刚刚遇到了同样的问题。似乎 transifex 包中的依赖项未正确列出（它取决于 Django == 1.3.1 和 django-filter >= 0.1，但 django-filter 0.6 取决于 Django >= 1.4.5）。

我通过安装旧版本的 django-filter (0.5.4) 解决了问题，而不是使用 pypi 中提供的包（似乎在 pypi 上只有 0.6 和 0.1 版本），而是直接从这里下载 0.5.4 版本：

[https://github.com/alex/django-filter/releases](https://github.com/alex/django-filter/releases)

然后用通常的方式安装：

python setup.py 安装

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2017-09-01T09:12:55.507

这应该可以解决您的问题：

```
$ easy_install six 
```

# jquery - 取消选中复选框时打开 Fancybox iFrame

> ID：16100456
> 
> 赞同：0
> 
> 时间：2013-04-19T08:29:28.753
> 
> 标签：jquery, fancybox

我正在尝试使用 Fancybox 插件创建一个弹出窗口，我将解释这些组件：

*   交付详细信息在 ID 为 #deliverydetails 的单独元素中形成
*   id 为 sameAsCheckbox 的复选框

现在，当未选中复选框时，我希望将deliverydetails 表单弹出在fancybox iFrame 中。任何帮助，将不胜感激！

```
$(function () {
    $("#sameAsCheckbox").click(function () {
        if ($(this).is(':unchecked')) $('#deliverydetails').fancybox('');
    });
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:43:59.553

尝试这个

```
$("#sameAsCheckbox").click(function () {
 if ($(this).is(':checked')) {
  $('#deliverydetails').fancybox('');
 } 
}) 
```

[jFiddle 示例](http://jsfiddle.net/DMM33/)

或者您也可以在 che click 处理程序中使用它：

```
 if(this.checked) {
    //Do stuff
} 
```

[如此处所](https://stackoverflow.com/a/8423235/1479680)讨论

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:40:35.520

尝试

```
$("#sameAsCheckbox").click(function () {
    if ($(this).attr('checked') != 'checked') $('#deliverydetails').fancybox('');
}); 
```

# javascript - 如何通过 javascript 获取和更新 Primefaces pickList bean 源和目标列表

> ID：16100458
> 
> 赞同：0
> 
> 时间：2013-04-19T08:29:33.577
> 
> 标签：javascript, primefaces, interaction

我正在开发一个具有选择交互的地图应用程序。选择城市时尝试更新pickList bean。

```
<script>  
function onCitySelected(e) {  

   // get myPrimeFacesPickList

   // update myPrimeFacesPickList : move e.selectedCity source to target 
}  
</script> 
```

有没有办法在我的 javascript 代码中获取和更新源和目标城市列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:08:18.233

也许使用 primeface [RemoteCommand](http://www.primefaces.org/showcase/ui/remoteCommand.jsf)

它将向您的页面添加一个 js 函数，您可以在函数中使用该`onCitySelected`函数。然后调用该函数将触发您的支持 bean 中的一个方法，您可以在该方法中将所选城市添加到您的模型中（使用`<f:setPropertyActionListener>`），然后通过`update`在`remoteCommand`.

查看 primefaces 展示中 remoteCommand 的展示[案例，](http://www.primefaces.org/showcase/ui/remoteCommand.jsf)并查阅remoteCommand 组件上的[primefaces 文档](http://primefaces.googlecode.com/files/indexed_primefaces_users_guide_3_5.pdf)。

# ms-access - 编写一个 Access 查询有超过 1 个 SELECT 语句

> ID：16100459
> 
> 赞同：1
> 
> 时间：2013-04-19T08:29:34.577
> 
> 标签：ms-access, ms-access-2007

我有一个包含超过 1 个表的 Access 数据库。

我需要从多个表中选择多个值并将它们插入另一个表中。

**例子：**

```
Table: CashFlow with Fields(ID, Date, BooksBuyPrice, AuthorIncomes, 
          EmployeesIncomes, OpeningAmount, ClosingAmount, DailyResult)

Table: Books with Fields(ID, Name, AuthorID, BuyPrice, SellPrice, IsSold, SellDate)

Table: Author with Fields(ID, Name, DailyIncome)

Table: Employee with Fields(ID, Name, DailyIncome)

Note: User Must Insert OpeningAmount And ClosingAmount 
```

**我需要：**

1- 为所有作者选择 Sum(DailyIncome) 并将其值设置为`AuthorIncomes`CashFlow 表

2- 为所有员工选择 Sum(DailyIncome) 并将其值设置为`EmployeesIncomes`CashFlow 表

3- 为在选定日期售出的所有书籍选择 Sum(BuyPrice) 并将其值设置为`BooksBuyPrice`现金流表

4-在 CashFlow 表中设置用户`OpeningAmount`的价值`OpeningAmount`

5-在 CashFlow 表中设置用户`ClosingAmount`的价值`ClosingAmount`

6- DailyResult 字段必须等于 ((ClosingAmount - OpeningAmount - AuthorIncomes - EmployeesIncomes - BooksBuyPrice)

然后我必须在 CashFlow 表中插入一条具有上述值的新记录。

我怎样才能做到这一点？

注意：我的应用程序是 Visual Studio 2010 下连接到 Access 2007 数据库的 C# .NET 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:03:38.787

好的，让我们介绍几个基本任务，然后您可以根据您的特定要求充实代码。

我们将首先打开与数据库的连接：

```
var con = new System.Data.OleDb.OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data source=C:\__tmp\accounting.accdb;");
con.Open(); 
```

现在，我们将计算所有作者的 SUM(DailyIncome)，并将其存储在一个变量中

```
var cmd = new System.Data.OleDb.OleDbCommand("SELECT SUM(DailyIncome) FROM Author", con);
decimal SumOfDailyIncomeAuthors = (decimal)cmd.ExecuteScalar(); 
```

您可以对所有员工的 Sum(DailyIncome) 重复此操作。

计算 Books 的 SUM(BuyPrice) 基本相同，但您必须指定 SellDate：

```
cmd = new System.Data.OleDb.OleDbCommand("SELECT SUM(BuyPrice) FROM Books WHERE SellDate = ?", con);
cmd.Parameters.AddWithValue("?", new DateTime(2013, 4, 18));
decimal SumOfBuyPrice = (decimal)cmd.ExecuteScalar(); 
```

您已经在表单的文本框中获得了 OpeningAmount 和 ClosingAmount，因此您可以进行其余的计算并在 [CashFlow] 表中插入一个新行，如下所示：

```
cmd = new System.Data.OleDb.OleDbCommand("INSERT INTO CashFlow (AuthorIncomes, BooksBuyPrice, OpeningAmount, ClosingAmount) VALUES (?, ?, ?, ?)", con);
cmd.Parameters.AddWithValue("?", SumOfDailyIncomeAuthors);
cmd.Parameters.AddWithValue("?", SumOfBuyPrice);
cmd.Parameters.AddWithValue("?", txtOpeningAmount.Text);
cmd.Parameters.AddWithValue("?", txtClosingAmount.Text);
cmd.ExecuteNonQuery(); 
```

请注意，对于 ACE.OLEDB，添加`OleDbCommand.Parameters`时必须按照它们在`CommandText`. （参数名称被忽略，这就是为什么我没有在这里使用它们的原因，尽管对于具有大量参数的查询，名称有时仍然可以帮助我们人类保持直截了当。）

# c# - ASP.NET 用户控件的编辑、插入、更新模式

> ID：16100460
> 
> 赞同：2
> 
> 时间：2013-04-19T08:29:39.860
> 
> 标签：c#, asp.net, optimization, user-controls, web-user-controls

我正在寻找模板化用户控件的最佳方法，以便当我指定模式时说只读、编辑、更新、插入，然后用户控件会相应地更改其模式。

我已经确定了一些方法，我正在寻找的是一个非常优雅的解决方案。

*   在页面中创建一个表单视图，并将插入、编辑模板指定为单独的用户控件并相应地加载。

*   在用户控件内创建一个表单视图，并为记录的编辑/插入指定单独的控件。

*   *找到一种方法来模板化用户控件，以便当我指定模式时，在初始化用户控件时，它将适当地加载到页面中。*

    ```
    <asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
      <asp:FormView  DefaultMode="ReadOnly" ID="FormView1" runat="server"> 
        <ItemTemplate>
        <name:user ID="User1" Visible="true"  runat="server" />
        </ItemTemplate>
        <EditItemTemplate>
         <name:user ID="User2" Visible="true"  runat="server" />
        </EditItemTemplate>
    </asp:FormView> 
    ```

请分享您对在正常情况下如何做到这一点的看法；只有一个用户控件和用户控件基于模式更改状态（单个用户控件而不是 3 个用户控件的功能）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:39:09.133

尝试使用 MultiView ASP.NET 控件。您可以简单地设置内容的不同视图，并随时在这些视图之间切换。

这是一些教程[http://www.youtube.com/watch?v=YV5w7sgojm0](http://www.youtube.com/watch?v=YV5w7sgojm0)

# ios - CocoaPods 规范 lint 引发错误

> ID：16100462
> 
> 赞同：4
> 
> 时间：2013-04-19T08:29:53.437
> 
> 标签：ios, cocoapods

我创建了一个 iOS 框架项目并向其中添加了一个 .podspec。该框架以及包含的演示项目都生成良好。但是我在 pod spec lint 测试期间遇到了错误。

我正在使用的 podspec 文件是

```
Pod::Spec.new do |s|s.name         = "HorizontalPicker"
s.version      = "1.0.0"
s.summary      = "A similar to UIPickerView but horizontal picker view."
s.homepage     = "https://github.com/HHuckebein/HorizontalPicker"
s.license      = { :type => 'MIT', :file => 'LICENSE.txt' }
s.author       = { "RABE_IT Services" => "info@berndrabe.de" }
s.source       = { :git => "https://github.com/HHuckebein/HorizontalPicker.git", :tag => "1.0.0" }
s.platform     = :ios, '5.1'
s.source_files = 'HorizontalPicker/*.{h,m}'
s.framework    = 'QuartzCore'
s.requires_arc = true
end

-> HorizontalPicker (1.0.0)
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:42:30: error: unknown type name 'CAShapeLayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:42:1: error: property with 'retain (or strong)' attribute must be of object type
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:63:16: error: property 'masksToBounds' cannot be found in forward class object 'CALayer'
- NOTE  | [xcodebuild]  /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/System/Library/Frameworks/UIKit.framework/Headers/UIView.h:82:75: note: forward declaration of class here
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:112:32: error: member reference base type 'int *' is not a structure or union
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:319:21: error: property 'borderColor' cannot be found in forward class object 'CALayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:320:21: error: property 'borderWidth' cannot be found in forward class object 'CALayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:340:33: error: property 'borderWidth' cannot be found in forward class object 'CALayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:341:33: error: property 'borderColor' cannot be found in forward class object 'CALayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:401:10: error: use of undeclared identifier 'CAGradientLayer'
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:410:3: error: unknown type name 'CAGradientLayer'; did you mean 'CGGradientRef'?
- NOTE  | [xcodebuild]  /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/System/Library/Frameworks/CoreGraphics.framework/Headers/CGGradient.h:8:28: note: 'CGGradientRef' declared here
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:410:37: error: use of undeclared identifier 'CAGradientLayer'; did you mean 'gradientLayer'?
- NOTE  | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:410:20: note: 'gradientLayer' declared here
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:410:54: error: expected expression
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:411:16: error: member reference base type 'CGGradientRef *' (aka 'struct CGGradient **') is not a structure or union
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:412:16: error: member reference base type 'CGGradientRef *' (aka 'struct CGGradient **') is not a structure or union
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:414:22: error: member reference base type 'CGGradientRef *' (aka 'struct CGGradient **') is not a structure or union
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:416:22: error: member reference base type 'CGGradientRef *' (aka 'struct CGGradient **') is not a structure or union
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:436:10: error: use of undeclared identifier 'CAGradientLayer'; did you mean 'gradientLayer'?
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:436:10: error: reference to local variable 'gradientLayer' declared in enclosing context
- ERROR | [xcodebuild]  HorizontalPicker/HorizontalPicker/HPickerView.m:436:10: error: bad receiver type 'CGGradientRef *' (aka 'struct CGGradient **')
- ERROR | [xcodebuild]  fatal error: too many errors emitted, stopping now [-ferror-limit=] 
```

分析了 1 个 podspec。

[!] 规范未通过验证。

编辑目录结构是这样的。/Horizo​​ntalPicker/Horizo​​ntalPicker.podspec /Horizo​​ntalPicker/Horizo​​ntalPicker/源代码在这里

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T21:10:26.877

看看发生了什么我用

```
pod spec lint --no-clean ... 
```

它将生成的测试 pod 留在 /tmp 中。所以我发现在pch文件中添加了QuartzCore，这对于普通项目来说是可以的，但在类文件中却没有。

所以这不是最好的编码风格。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T01:58:11.533

就我而言，lint 是针对 OS X SDK 而不是 iOS SDK 测试规范。

两个平台都有安全框架，但 API 不一样，因此会出现错误。

只需添加`s.platform = :ios`到 podspec 即可修复它。

# css - DIV的斜率曲线角的CSS

> ID：16100463
> 
> 赞同：33
> 
> 时间：2013-04-19T08:30:12.283
> 
> 标签：css

如何实现这一点`<div>`：`CSS`

## ![在此处输入图像描述](https://i.stack.imgur.com/yZKfQ.png)

我的尝试：

```
div {
    height: 300px;
    background: red;
    position: relative;
}

div:before {
    content: '';
    position: absolute;
    top: 0; left: 0;
    border-top: 80px solid white;
    border-right: 80px solid red;
    width: 0;
} 
```

我无法修改斜坡部分并在里面填充白色。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-19T12:09:20.267

我的尝试，如评论中所述（[http://jsfiddle.net/8Zm96/](http://jsfiddle.net/8Zm96/)）：

```
div{
    width: 300px;
    height: 280px;
    background: #fff;
    border: solid 1px red;
    border-width: 0 1px 1px 1px;
    border-radius: 4px;
    margin-top: 40px;
    position: relative;
}

div:before{
    content: '';
    position: absolute;
    top: -20px;
    right: -1px;
    border: solid 1px red;
    border-width: 1px 1px 0 0;
    border-radius: 25px 4px 0 0;
    height: 24px;
    width: 250px;
    background: #fff;
}

div:after{
    content: '';    
    position: absolute;
    top: -20px;
    left: 2px;
    border: solid 1px red;
    border-width: 0 0 1px 0;
    border-radius: 0 0 20px 0;
    height: 20px;
    width: 55px;
    background: #fff;
} 
```

近距离放大，左角不合适，两条半曲线实际上相互弯曲，但在正常缩放时都看不到。这可能是手机和高分辨率屏幕的问题，它们可能会显示放大的内容，或者在正常缩放时更准确。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-19T10:49:07.610

这是我最好的尝试：http: [//jsfiddle.net/2y7TB/2/](http://jsfiddle.net/2y7TB/2/)

这是我用过的： ![在此处输入图像描述](https://i.stack.imgur.com/G8hqo.png)

我只在 Chrome 上测试过，如果你喜欢它并想要一个跨浏览器的解决方案，请询问:)

**LE**：似乎在最新版本的 Firefox 和 Opera 上也能正确显示。

```
.tab:before {
    content: '';
    position: absolute;
    top: -23px;
    right: -1px;
    border-right:1px solid orange;
    border-left:1px solid orange;
    border-top:1px solid orange;
    background:white;
    width: 247px;
    height:24px;
    border-top-right-radius:5px;
    border-top-left-radius:25px;
}

.tab:after {
    content: '';
    position: absolute;
    top: -9px;
    left:1px;
    border-right:1px solid orange;
    border-bottom:1px solid orange;
    border-top:none;
    background:white;
    width: 53px;
    height:9px;
    border-bottom-right-radius:180px;
    box-shadow:3px 3px 0px 3px white;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-19T09:07:22.930

你*可以*用 css 做到这一点，但它有很多摆弄（=潜在的跨浏览器问题）。我设置了一个[关于如何使用 CSS 的小提琴](http://jsfiddle.net/nDxYJ/194/)。然而，人们可以在边界内看到一些干扰（尤其是在缩放时）。这只是一个草图，当然可以优化。

更好和跨浏览器可靠的解决方案是在下面标记的位置使用背景图像。如果你愿意，你可以使用伪元素。

![在此处输入图像描述](https://i.stack.imgur.com/U0XUT.png)

基本上我用两个旋转和倾斜的伪元素构建斜坡。[该解决方案优于仅使用边框半径的解决方案（我认为这是非常次优的，因为浏览](http://caniuse.com/#search=transform)器呈现圆角的方式完全不同），但由于`transform`.

```
#head:before,#head:after {
    content:"";display:block;
    height:40px; 
    width:70px;
    border-left:2px solid orange;
    border-top:2px solid orange;
    transform:skewX(-45deg);
    border-top-left-radius:10px;
    position:relative;
    top:-2px;
    left:-40px;
}
#head:after {
    transform:rotate(180deg) skewX(-45deg);
    left:-180px;bottom:32px;top:auto;
    width:128px;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-19T09:07:40.833

也许这段代码？[jsFiddle](http://jsfiddle.net/Dhme5/)，我不确定你是否想要，**但它适用于所有浏览器..**

HTML：

```
<div class="head">&nbsp;</div>
<div class="bdy"><div class="mask"></div>&nbsp;<br><br><br><br><br><br></div> 
```

CSS：

```
.head{    
    border-top: 1px solid #ffccff;
    border-left: 1px solid #ffccff;
    border-right: 1px solid #ffccff;
    border-radius: 40px 7px 0 0 ;
    margin-left: 20%;
}
.bdy{
    border-radius: 3px 0 3px 3px;
    border-top: none;
    border-left: 1px solid #ffccff;
    border-right: 1px solid #ffccff;
    border-bottom: 1px solid #ffccff;
}
.mask{

    top:-1px;
    left:1px;
    width:20%;
    height: 1px;
    background-color:#ffccff;
} 
```

# magento - 显示缺货选项中的所有产品 magento

> ID：16100466
> 
> 赞同：0
> 
> 时间：2013-04-19T08:30:33.917
> 
> 标签：magento

我在过滤器列表中添加了排除缺货选项属性。单击“排除缺货”选项时，仅显示缺货的产品。我想展示所有的产品，包括缺货的产品。最初不显示缺货产品。

我想要这样的功能[`http://www.flipkart.com/mobiles/samsung~brand/pr?p\[\]=facets.availability%255B%255D%3DExclude%2BOut%2Bof%2BStock&p\[\]=sort%3Dfeatured&sid=tyy%2C4io&layout=grid`](http://www.flipkart.com/mobiles/samsung~brand/pr?p%5B%5D=facets.availability%255B%255D=Exclude%2bOut%2bof%2bStock&p%5B%5D=sort=featured&sid=tyy,4io&layout=grid)

单击缺货产品应在显示中包括缺货产品。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:34:41.037

检查这篇文章：

[http://colin.mollenhour.com/2009/09/28/yet-another-hiding-out-of-stock-products-update/](http://colin.mollenhour.com/2009/09/28/yet-another-hiding-out-of-stock-products-update/)

也许它可能有用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T07:14:16.393

如果您想在 magento 中显示/显示缺货产品，请按照以下步骤操作：

```
A. Login to Magento back-end
B. Go to menu System >> Configuration.
C. Take inventory tab from the left panel
D. Set Display out of stock products to ‘Yes’ in Stock options tab in the right panel
E. Clear your cache and reindex your Index management. 
```

# maven - 在 Windows 上安装 mifos 时，gradle clean cleanEclipse eclipse 命令无法构建

> ID：16100468
> 
> 赞同：1
> 
> 时间：2013-04-19T08:31:01.373
> 
> 标签：maven, gradle

我在我的电脑中克隆了 mifos 存储库。之后安装 gradle 1.5 按照说明从这里安装 gradle [https://github.com/openMF/mifosx/wiki/Gradle](https://github.com/openMF/mifosx/wiki/Gradle)

无法弄清楚 JAVA_OPTS 和它是什么..如果有人可以帮助解决这个问题？然后我进入 mifosng-provider 目录并尝试执行以下命令，该命令应该可以正常工作，但无法正常工作，而是显示以下内容

```
c:\mifosx\mifosng-provider>gradle clean cleanEclipse eclipse
Listening for transport dt_socket at address: 8005

FAILURE: Build failed with an exception.

* What went wrong:
Could not resolve all dependencies for configuration ':classpath'.
> Could not resolve org.zeroturnaround:gradle-jrebel-plugin:1.0.2-SNAPSHOT.
  Required by:
      :mifosng-provider:unspecified
   > Unable to load Maven meta-data from http://repo1.maven.org/maven2/org/zerot
urnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml.
      > Could not GET 'http://repo1.maven.org/maven2/org/zeroturnaround/gradle-j
rebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml'.
         > repo1.maven.org
   > Unable to load Maven meta-data from http://repos.zeroturnaround.com/nexus/c
ontent/groups/zt-public/org/zeroturnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/m
aven-metadata.xml.
      > Could not GET 'http://repos.zeroturnaround.com/nexus/content/groups/zt-p
ublic/org/zeroturnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml'
.
         > repos.zeroturnaround.com
   > Unable to load Maven meta-data from http://repo1.maven.org/maven2/org/zerot
urnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml.
      > Could not GET 'http://repo1.maven.org/maven2/org/zeroturnaround/gradle-j
rebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml'.
         > repo1.maven.org
   > Unable to load Maven meta-data from http://repo1.maven.org/maven2/org/zerot
urnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml.
      > Could not GET 'http://repo1.maven.org/maven2/org/zeroturnaround/gradle-j
rebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml'.
         > repo1.maven.org
   > Unable to load Maven meta-data from http://repo1.maven.org/maven2/org/zerot
urnaround/gradle-jrebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml.
      > Could not GET 'http://repo1.maven.org/maven2/org/zeroturnaround/gradle-j
rebel-plugin/1.0.2-SNAPSHOT/maven-metadata.xml'.
         > repo1.maven.org
> Could not resolve org.gradle.api.plugins:gradle-tomcat-plugin:0.9.7.
  Required by:
      :mifosng-provider:unspecified
   > Could not GET 'http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-
tomcat-plugin/0.9.7/gradle-tomcat-plugin-0.9.7.pom'.
      > repo1.maven.org
   > Could not GET 'http://repos.zeroturnaround.com/nexus/content/groups/zt-publ
ic/org/gradle/api/plugins/gradle-tomcat-plugin/0.9.7/gradle-tomcat-plugin-0.9.7.
pom'.
      > repos.zeroturnaround.com
   > Could not GET 'http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-
tomcat-plugin/0.9.7/gradle-tomcat-plugin-0.9.7.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-
tomcat-plugin/0.9.7/gradle-tomcat-plugin-0.9.7.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/org/gradle/api/plugins/gradle-
tomcat-plugin/0.9.7/gradle-tomcat-plugin-0.9.7.pom'.
      > repo1.maven.org
> Could not resolve nl.javadude.gradle.plugins:license-gradle-plugin:0.5.0.
  Required by:
      :mifosng-provider:unspecified
   > Could not GET 'http://repo1.maven.org/maven2/nl/javadude/gradle/plugins/lic
ense-gradle-plugin/0.5.0/license-gradle-plugin-0.5.0.pom'.
      > repo1.maven.org
   > Could not GET 'http://repos.zeroturnaround.com/nexus/content/groups/zt-publ
ic/nl/javadude/gradle/plugins/license-gradle-plugin/0.5.0/license-gradle-plugin-
0.5.0.pom'.
      > repos.zeroturnaround.com
   > Could not GET 'http://repo1.maven.org/maven2/nl/javadude/gradle/plugins/lic
ense-gradle-plugin/0.5.0/license-gradle-plugin-0.5.0.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/nl/javadude/gradle/plugins/lic
ense-gradle-plugin/0.5.0/license-gradle-plugin-0.5.0.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/nl/javadude/gradle/plugins/lic
ense-gradle-plugin/0.5.0/license-gradle-plugin-0.5.0.pom'.
      > repo1.maven.org
> Could not resolve com.github.ben-manes:gradle-flyway-plugin:0.2.
  Required by:
      :mifosng-provider:unspecified
   > Could not GET 'http://repo1.maven.org/maven2/com/github/ben-manes/gradle-fl
yway-plugin/0.2/gradle-flyway-plugin-0.2.pom'.
      > repo1.maven.org
   > Could not GET 'http://repos.zeroturnaround.com/nexus/content/groups/zt-publ
ic/com/github/ben-manes/gradle-flyway-plugin/0.2/gradle-flyway-plugin-0.2.pom'.
      > repos.zeroturnaround.com
   > Could not GET 'http://repo1.maven.org/maven2/com/github/ben-manes/gradle-fl
yway-plugin/0.2/gradle-flyway-plugin-0.2.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/com/github/ben-manes/gradle-fl
yway-plugin/0.2/gradle-flyway-plugin-0.2.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/com/github/ben-manes/gradle-fl
yway-plugin/0.2/gradle-flyway-plugin-0.2.pom'.
      > repo1.maven.org
> Could not resolve mysql:mysql-connector-java:5.1.22.
  Required by:
      :mifosng-provider:unspecified
   > Could not GET 'http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1
.22/mysql-connector-java-5.1.22.pom'.
      > repo1.maven.org
   > Could not GET 'http://repos.zeroturnaround.com/nexus/content/groups/zt-publ
ic/mysql/mysql-connector-java/5.1.22/mysql-connector-java-5.1.22.pom'.
      > repos.zeroturnaround.com
   > Could not GET 'http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1
.22/mysql-connector-java-5.1.22.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1
.22/mysql-connector-java-5.1.22.pom'.
      > repo1.maven.org
   > Could not GET 'http://repo1.maven.org/maven2/mysql/mysql-connector-java/5.1
.22/mysql-connector-java-5.1.22.pom'.
      > repo1.maven.org

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug
option to get more log output.

BUILD FAILED

Total time: 2 mins 38.61 secs 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:17:21.800

我得到了解决方案。我只需要在 gradle.properties 文件中设置我的代理设置，它就对我有用。

# javascript - 原型副本 vs Object.create() vs new

> ID：16100471
> 
> 赞同：5
> 
> 时间：2013-04-19T08:31:07.170
> 
> 标签：javascript, inheritance

我正在使用继承，我注意到有三种方法可以获得相同的结果。有什么不同？

```
function Animal(){
}

Animal.prototype.doThat = function() {
    document.write("Doing that");
}

function Bird(){
}

// This makes doThat() visible
Bird.prototype = Object.create(Animal.prototype); // Solution 1
// You can also do:
// Bird.prototype = new Animal(); // Solution 2
// Or:
// Bird.prototype = Animal.prototype; // Solution 3

var myVar = new Bird();
myVar.doThat(); 
```

如您所见，我提出了三个解决方案。它们中的每一个都使方法 doThat() 可见。

如果我评论所有这些，则确实存在错误。

如果我只删除其中一个，程序就可以工作。

那么......这三种解决方案之间的真正区别是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-19T08:46:02.823

> `Bird.prototype = Animal.prototype; // Solution 3`

由于这`Animal.prototype`直接分配给`Bird.prototype`，因此您对后者所做的所有更改也将反映在`Animal`以及从它继承的所有其他类中。

例如：

```
Bird.prototype.fly = function() {
    console.log('I can fly.');
}

var some_animal = new Animal();
some_animal.fly(); // this will work 
```

这肯定不是你想要的。不仅该子类的每个方法都可用于其他子类，而且如果您覆盖子类中的父方法，最后定义的子类将覆盖其他子类的更改。

在您的问题标题中，您似乎将此称为“原型副本”。这是不正确的，因为没有创建副本。`Animal.prototype`并且`Bird.prototype`将引用同一个对象。

* * *

> `Bird.prototype = new Animal(); // Solution 2`

长期以来，这一直是设置继承的常用方法，但它有两个主要缺点：

*   如果`Animal`需要参数，你会通过哪个？传递随机、无意义的参数只是为了使函数调用工作似乎是糟糕的设计。
*   `Animal`可能会有副作用，例如增加实例计数器，但此时您实际上并没有创建新实例（或不想），您只是想设置继承。

* * *

> `Bird.prototype = Object.create(Animal.prototype); // Solution 1`

这就是你现在应该这样做的方式（[直到有更好的解决方案出现](http://wiki.ecmascript.org/doku.php?id=harmony:classes)）。你真正想做的就是`Animal`将原型连接到`Bird`. 它避免了以前解决方案的所有缺点。

但是，要使其正常工作，您还必须在构造函数中调用`Animal`构造`Bird`函数。这就像`super`在其他编程语言中的调用：

```
function Bird(){
    Animal.call(this);
} 
```

这确保对新实例所做的任何命令/更改`Animal`都应用于新`Bird`实例。

`constructor`为原型的属性分配正确的值也是一种很好的做法。它通常指原型“所属”的功能，但在上述所有解决方案中，`Bird.prototype.constructor`都会指`Animal`. 所以我们必须这样做：

```
Bird.prototype.constructor = Bird; 
```

此属性在内部不使用，因此只有在您自己的代码依赖它时才需要这样做*。*但是，如果您创建一个供其他人使用的库，他们可能会期望该属性必须正确的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:39:44.340

您可以使用**解决方案 1**或**解决方案 2**，但**不应**使用**解决方案 3**。

原因是当你这样做的时候`Bird.prototype = Animal.prototype;`，每一次改变`Bird.prototype`都会影响到`Animal.prototype`，因为它们是同一个对象。

例如，您在 上附加了一个方法`Bird.prototype`，那么该方法也将适用于`Animal`，这不是您想要的。

# android - 在高分辨率设备上以全屏模式播放小分辨率视频

> ID：16100472
> 
> 赞同：0
> 
> 时间：2013-04-19T08:31:07.777
> 
> 标签：android, video, fullscreen, adt, stretch

我有一个`480x360`嵌套在全屏 VideoView 中的 mp4 视频。我想要的是在更高分辨率的物理设备上全屏播放。我不介意视频是否因将其拉伸到设备屏幕的尺寸而失真。我只想要它**全屏**。

我的Java代码是这样的：

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
       getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);

       VideoView vv = (VideoView) findViewById(R.id.videoView);

       vv.setOnPreparedListener(new OnPreparedListener() {
            @Override
            public void onPrepared(MediaPlayer mp) {
                mp.setLooping(true);
            }
        });

       Uri url=Uri.parse("android.resource://" + getPackageName() +"/"+ R.raw.bubblessd );

       vv.setVideoURI(url);
       vv.start();
       vv.requestFocus();

    }
} 
```

我的活动 XML 是这样的：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center"

    tools:context=".MainActivity" >

<VideoView
    android:id="@+id/videoView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_alignParentRight="true"/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-15T13:53:10.297

*   如果您使用 VideoView，在这种情况下保持纵横比的更好解决方案是修复黑色背景并裁剪您的 videoView。你可以 fitXY 你的 videoView 但它会失去原来的纵横比。检查此链接：[ [http://blog.gemserk.com/2013/01/22/our-solution-to-handle-multiple-screen-sizes-in-android-part-one/][1]](http://blog.gemserk.com/2013/01/22/our-solution-to-handle-multiple-screen-sizes-in-android-part-one/][1])
*   如果您使用 SurfaceView，（对我来说是最好的选择），您可以使用以下方法：

    yourSurfaceVideo.setVideoScalingMode(MediaPlayer.VIDEO_SCALING_MODE_SCALE_TO_FIT_WITH_CROPPING);

使您的视频适应您想要的空间。希望能帮助到你！

# r - 如何选择以某个数字结尾的索引？

> ID：16100473
> 
> 赞同：0
> 
> 时间：2013-04-19T08:31:08.390
> 
> 标签：r

我有以下向量：

```
x = c(31, 56, 78, 98, 76, 88, 90) 
```

并希望选择以相同数字结尾的所有值。例如，78、88、98。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T08:33:36.823

你可以使用这个：

```
v <- c(31,56,78,98,76,88,90)
v[v %% 10 == 8]
# [1] 78 98 88 
```

请注意，这将为您提供除以 10`v %% 10`的 mod 。`v`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-19T08:46:02.090

使用正则表达式，

```
x[grepl('.*8$',x)]
[1] 78 98 88 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T08:37:17.373

这是另一个冗长的解决方案。

```
mmm <- c(31,56,78,98,76,88,90)
mmm[sapply(sapply(as.character(mmm), strsplit, split = ""), "[[", 2) == 8]
[1] 78 98 88 
```

# wso2 - 带有变量的 Apache Synapse 属性配置

> ID：16100475
> 
> 赞同：1
> 
> 时间：2013-04-19T08:31:17.870
> 
> 标签：wso2

我正在尝试将变量添加到突触配置文件中的属性。该行看起来像这样（工作正常）：

`<property name="Authorization" expression="fn:concat('Basic ', base64Encode('username:password'))" scope="transport"/>`

但是，我正在尝试将用户名和密码作为参数传递，我尝试使用以下方法（以及撇号位于不同位置的类似变化）但没有任何效果：

`<property name="Authorization" expression="fn:concat('Basic ', base64Encode($url:username':'$url:password))" scope="transport"/>`

关于什么是错的任何想法或建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T08:12:58.393

想通了：base64Encode(concat($url:username,':',$url:password)))

# batch-file - 使用批处理文件创建防火墙例外

> ID：16100485
> 
> 赞同：0
> 
> 时间：2013-04-19T08:32:15.720
> 
> 标签：batch-file, firewall

我正在尝试为我拥有的自动`LAN joiner`创建`LAN party`一个，但我需要知道如何`firewall`为`games.exe`?

需要例外的文件位置是：`lanparty\exes\halo4.exe`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:21:32.470

如果您在谈论 Windows 防火墙，请使用：

```
Netsh Firewall 
```

类型：

```
Netsh Firewall /? 
```

从命令提示符获取参数列表

如果您使用的是其他软件防火墙，则需要指定哪一个。如果它是硬件防火墙，您还需要指定哪一个。

确实没有足够的信息来准确回答这个问题

# java - 多用户同时处理 csv

> ID：16100486
> 
> 赞同：1
> 
> 时间：2013-04-19T08:32:18.690
> 
> 标签：java, multithreading, concurrency, throttling, concurrent-programming

我有一个场景，我必须为用户处理文件夹中的 CSV 文件，并在处理后将它们存储到数据库中。我们每个用户有 5 种类型的提要。任何用户都可以在该文件夹中发送任何提要，随时进行处理，需要遵循以下规则：

*   不能同时处理同一客户的同一类型的提要，这意味着必须始终阻止同时处理时间。
*   不允许跨“x”个以上的客户端进行并发处理
*   不允许同一客户端同时处理超过“y”个文件

实现这一目标的好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:39:03.723

第一个限制可以用[AtomicBoolean](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/atomic/AtomicBoolean.html)的映射来实现。这可能不需要是 ConcurrentHashMap，因为您不会在初始化后更改地图的键。完成后不要忘记将提要的值重置为 false。

```
checkAndProcessFeed(Feed feed, Map<String, AtomicBoolean> map) {
    while(!map.get(feed.type).compareAndSet(false, true)) // assuming the AtomicBooleans were initialized to false
        Thread.sleep(500);
    }
    process(feed); // at this point map.get(feed.type).get() == true
    map.get(feed.type).set(false); // reset the AtomicBoolean to false
} 
```

其他两个限制可以用[AtomicInteger](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicInteger.html)来实现，用于维护客户端和每个客户端文件的计数；处理完成时递减，并通过比较和设置递增以启动新的客户端/文件。

```
final int maxClient = 5;
AtomicInteger clientCount = new AtomicInteger(0);
ConcurrentLinkedQueue<Client> queue = new ConcurrentLinkedQueue<>(); // hold waiting clients
while(true) {
    int temp = clientCount.intValue();
    if(!queue.isEmpty() && clientCount.compareAndSet(temp, temp + 1) { // thread-safe increment 
        process(clients.poll()); // don't forget to decrement the clientCount when the processing finishes
    } else Thread.sleep(500);
} 
```

# hadoop - Hadoop 排序示例因“不是 SequenceFile”而失败。如何设置 SequenceFile

> ID：16100487
> 
> 赞同：0
> 
> 时间：2013-04-19T08:32:25.923
> 
> 标签：hadoop

我正在尝试运行**bin/hadoop jar hadoop-examples-1.0.4.jar sort input output**

但收到错误“java.io.IOException: hdfs://master:9000/usr/ubuntu/input/file1 not a SequenceFile”

如果我运行**bin/hadoop jar hadoop-examples-1.0.4.jar wordcount input output 就**可以了。

所以我不知道如何处理它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:44:57.720

这里的错误信息是完全正确的；该`sort`示例需要一个[序列文件](http://wiki.apache.org/hadoop/SequenceFile)- 二进制键和值作为输入的平面文件，这种文件通常作为 MapReduce 作业的输出生成。

但是，该`wordcount`示例并不期望特别是序列文件作为输入，而只是一个文本文件，其键是文件中的偏移量（行号），值是行内容。

看到您拥有的输入文件本身不是序列文件，`sort`因此无法使用它们运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T07:27:45.447

@Jork，如果您对 hadoop-examples-1.0.4.jar 中给出的示例进行排序，您可以通过命令行参数更改输入和输出格式，或者您可以在程序中从 SequenceFileInputFormat 更改为 Text 类型。[Hadoop](/questions/tagged/hadoop "显示标记为“hadoop”的问题")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-17T18:01:54.703

我遇到过同样的问题。在这里，[https://wiki.apache.org/hadoop/Sort](https://wiki.apache.org/hadoop/Sort)，它说“输入和输出必须是序列文件。” 您应该将输入文件转换为 hadoop 序列文件，我希望有更简单的方法。我发现这个教程很有帮助，祝你好运！[https://examples.javacodegeeks.com/enterprise-java/apache-hadoop/hadoop-sequence-file-example/](https://examples.javacodegeeks.com/enterprise-java/apache-hadoop/hadoop-sequence-file-example/)

# postgresql - 选择按日期排序的唯一记录

> ID：16100488
> 
> 赞同：2
> 
> 时间：2013-04-19T08:32:37.903
> 
> 标签：postgresql, ruby-on-rails-3.2

我有 2 个以下型号：

```
class Schedule < ActiveRecord::Base    
  attr_accessible :description, :deadline_on, :repeat    
  has_many   :scheduled_transactions    
end

class ScheduledTransaction < ActiveRecord::Base    
  attr_accessible :transaction_on, :description    
  belongs_to :schedule    
end 
```

我想从每个计划中找到最后计划的交易。我知道我可以做到：

```
Schedule.all.each do |schedule|
  schedule.scheduled_transactions.order(:transaction_on).last
end 
```

但我想优化它并选择一个数据库。

我尝试构建 Rails 查询：

```
ScheduledTransaction.select('DISTINCT(schedule_id), scheduled_transactions.*').order('transaction_on DESC') 
```

被翻译成：

```
SELECT DISTINCT(schedule_id), scheduled_transactions.* FROM "scheduled_transactions" ORDER BY transaction_on DESC 
```

但它没有给出预期的结果。有多行具有相同的 schedule_id。

我的目标是选择包含每个时间表的最后一个预定事务的预定事务列表。有什么建议么？

(PostgreSQL) 9.1.9

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:13:18.183

正如 Guedes 所写，您可以为此使用 DISTINCT ON：

```
SELECT DISTINCT ON (schedule_id) *
  FROM scheduled_transactions
  ORDER BY schedule_id, transaction_on DESC 
```

# phpunit - 将 @runInSeparateProcess 与 markTestSkipped() 一起使用时出错

> ID：16100491
> 
> 赞同：-1
> 
> 时间：2013-04-19T08:33:01.190
> 
> 标签：phpunit

```
 /**
  * Tests Response->redirect
  * @runInSeparateProcess
 */
 public function testRedirect() {

    $this->markTestSkipped();
 } 
```

**错误信息：**

```
There was 1 error:

1) ResponseTest::testRedirect

PHPUnit_Framework_Exception: PHP Fatal error:  Uncaught exception 'PDOException' with message 'You cannot serialize or unserialize PDO instances' in -:44

Stack trace:
0 [internal function]: PDO->__sleep()

1 -(44): serialize(Array)

2 -(332): __phpunit_run_isolated_test()

3 {main}
  thrown in - on line 44

Fatal error: Uncaught exception 'PDOException' with message 'You cannot serialize or unserialize PDO instances' in -:44

Stack trace:
0 [internal function]: PDO->__sleep()

1 -(44): serialize(Array)

2 -(332): __phpunit_run_isolated_test()

3 {main}
  thrown in - on line 44 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T19:42:34.950

当 PHPUnit 在另一个进程中运行测试时，它将序列化一堆不同的数据以提供给该新进程。我假设你有一个数据库连接挂在 PHPUnit 试图序列化的变量中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-17T21:47:52.870

正如@SamHennessy 提到的，这个问题是因为失败时堆栈跟踪中的大量数据

这是因为TestCase中保存了一个大对象，

当断言失败时，会生成跟踪并序列化，因此如果跟踪中有大量数据，则序列化会中断。

就我而言，我将数据集保存在测试用例中，它在跟踪中生成了 239555 字节的数据

# java - 一个基本的 executeQuery 方法或每个查询一个

> ID：16100497
> 
> 赞同：0
> 
> 时间：2013-04-19T08:33:27.857
> 
> 标签：java, database-connection, datamapper

我已经开始创建一个 toDoList，我喜欢创建一个“DataMapper”来触发对我的数据库的查询。

我创建了这个 Datamapper 来为我处理事情，但我不知道在这种情况下我的思维方式是否正确。在我的 Datamapper 中，我只创建了 1 个必须执行查询的方法和几个知道要触发什么查询的方法（以最小化打开和关闭方法）。

例如我有这个：

```
public Object insertItem(String value) {

    this.value = value;

    String insertQuery = "INSERT INTO toDoList(item,datum) " + "VALUES ('" + value + "', CURDATE())";

    return this.executeQuery(insertQuery);
}

public Object removeItem(int id) {

    this.itemId = id;
    String deleteQuery = "DELETE FROM test WHERE id ='" + itemId + "'";

    return this.executeQuery(deleteQuery);

}

private ResultSet executeQuery(String query) {

    this.query = query;
    Connection con = null;
    Statement st = null;
    ResultSet rs = null;
    try {

        con = db.connectToAndQueryDatabase(database, user, password);

        st = con.createStatement();
        st.executeUpdate(query);
    } 
    catch (SQLException e1) {
        e1.printStackTrace();
    }
    finally {
            if (rs != null) {
                try {
                    rs.close();
                } catch (SQLException e2) { /* ignored */}
            }
            if (st != null) {
                try {
                    st.close();
                } catch (SQLException e2) { /* ignored */}
            }                       
            if (con != null) {
                try {
                    con.close();
                } catch (SQLException e2) { /* ignored */}
            }
            System.out.println("connection closed");
     }
    return rs;
} 
```

所以现在我不知道这样返回是否正确`ResultSet`。我很难做类似的事情

```
public ArrayList<ToDoListModel> getModel() {    
    return null;
} 
```

插入返回的每条记录`ArrayList`。但我觉得我有点卡住了。有人可以通过示例或其他方式引导我走向正确的道路吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:27:00.093

好的，在这种情况下，你可以做的是，首先创建一个 hashmap 的 ArrayList。其中包含键、值作为列名和列值。之后，您可以创建模型。

```
public List convertResultSetToArrayList(ResultSet rs) throws SQLException{
ResultSetMetaData mdata = rs.getMetaData();
int columns = mdata.getColumnCount();
ArrayList list = new ArrayList();
while (rs.next()){
    HashMap row = new HashMap(columns);
    for(int i=1; i<=columns; ++i){           
   row.put(md.getColumnName(i),rs.getObject(i));
}
   list.add(row);
}

return list;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:02:24.907

这取决于应用程序的工作方式。如果您在短时间内有很多数据库命中，最好将它们捆绑在一起并为所有查询使用相同的数据库连接，以减少连接建立和清理的开销。

如果您只有较大间隔的单个查询，您可以这样做。

您还应该考虑是否要分离数据库层和用户界面（如果存在）。在这种情况下，您不应该`ResultSet`将向上传递给用户界面，而是将数据包装在一个独立的容器中并通过您的应用程序传递。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:02:51.267

**如果我正确理解您的问题！，您需要使用insertItem**方法传递 ToDoListModel 对象列表以插入数据库。

你如何传递你的对象来插入项目实际上并不重要，但你需要考虑的是这个 DataMapper 是如何并发的，如果它可以一次被多个线程访问，你最终会创建多个数据库连接，这并不昂贵.您的代码实际上在顺序访问中没有任何问题。

因此，您可以在连接创建中添加同步块并使 DataMapper 类单例。

# redis - 如何使用 sinatra、sinatra-websocket 和 redis-rb 从 Redis 消息中通知 Websocket？

> ID：16100506
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:02.680
> 
> 标签：redis, sinatra

我有这个[https://gist.github.com/ohcibi/5418898](https://gist.github.com/ohcibi/5418898) Gist，它基本上只是 sinatra-websocket github 页面中的示例和粘贴的一些 Redis 代码。该部分

```
settings.redis.subscribe 'foobar' do |on|
  on.message do |channel, message|
    settings.sockets.each do |s|
      s.send message
    end
  end
end 
```

正在阻止 Sinatra 应用程序正确启动 aus`subscribe`正在阻止。我通过将订阅放入`ws.onopen`处理程序中取得了小小的成功，但这会覆盖每个新 websocket 的订阅（即只有最新的 websocket 会收到消息）。

如何在收到新的 redis 消息时通知所有连接的套接字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:58:27.143

我通过将它放在另一个线程中并使用 Thread locals 作为套接字成功：

```
set(:watcher, Thread.new do
  redis = Redis.new
  Thread.current['sockets'] = []

  redis.subscribe 'foobar' do |on|
    on.message do |channel, message|
      Thread.current['sockets'].each do |s|
        s.send message
      end
    end
  end
end) 
```

然后我做

```
settings.watcher['sockets'] << ws 
```

代替

```
settings.sockets << ws 
```

和

```
settings.redis.publish 'foobar', msg 
```

通过 redis watcher 通知套接字。

查看更新的要点：[https ://gist.github.com/ohcibi/5418898](https://gist.github.com/ohcibi/5418898)

# xml - Magento，添加自定义网址。Xml 或 Php/Html

> ID：16100507
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:10.157
> 
> 标签：xml, magento

示例：在 catalogsearch.xml 中，我可以找到：

```
 <reference name="footer_links">
        <action method="addLink" translate="label title" module="catalogsearch" ifconfig="catalog/seo/search_terms">
            <label>Search Terms</label>
            <url helper="catalogsearch/getSearchTermUrl" />
            <title>Search Terms</title>
        </action>
        <action method="addLink" translate="label title" module="catalogsearch">
            <label>Advanced Search</label>
            <url helper="catalogsearch/getAdvancedSearchUrl" />
            <title>Advanced Search</title>
        </action>
    </reference> 
```

很明显。在“footer_links”块中，代码将添加 2 个 url，搜索和高级搜索链接。现在，我的问题是：为什么我应该通过 xml 布局文件添加这两个链接，而不是直接在与页脚相关的 phtml 模板中添加它们？！

我认为，如果它相同，那么选择一种方法而不是另一种方法并不方便，我会编辑 phtml 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:08:13.687

Magento 中有很多块充当从其他布局文件添加子块的“容器”。它们通常在`page.xml`布局文件中定义，与`footer_links`块一样：

```
<block type="page/template_links" name="footer_links" as="footer_links" template="page/template/links.phtml"/> 
```

如您所见，它实例化`Mage_Page_Block_Template_Links`了包含布局文件在标记`addLink()`中调用的块方法的块类。`<action>`

定义这些类型的块可以让您在设置要跨多个布局文件添加的内容方面具有很大的通用性。这不仅将块声明分隔到仅与特定模块相关的不同布局文件中，而且还可以依赖于主题，从而允许您在主题之间完全更改布局。

此外，如果您不再使用块，这基本上是您通过仅在模板文件中工作而在某种程度上所做的事情，这取决于该块的构造方式以及它具有哪些子块，您可能会失去缓存的一些好处阻止 HTML。

因此，直接在模板文件中工作有 3 个主要缺点：

*   您失去了使用主题特定布局句柄的好处
*   模板文件几乎没有保持那么干净
*   您可能会失去一些块缓存的好处

我知道，当 Magento 对模板文件相当陌生时，在这种情况下使用模板文件似乎是一个很好的解决方案，但是当您发现更多有关 Magento 布局及其功能的信息时，您将开始看到在模板文件中工作的巨大好处框架设定的标准——在这种情况下使用布局文件。如果您了解拥有顶级容器块（例如和）的好处`content`，那么该块也具有完全相同的好处。`header``footer``footer_links`

# spotify - 同时播放 Spotify 音乐和音频

> ID：16100508
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:10.627
> 
> 标签：spotify

我开发了一个 iOS 应用程序，它可以同时播放用户音乐库中的音乐以及应用程序中包含的音频文件。我聘请了一位开发人员在应用程序中进行了几处更改，其中一项更改允许用户使用他们的“Spotify”播放列表而不是他们的“音乐”播放列表，如果他们有一个 Spotify 帐户。他告诉我，这个功能不可能与 Spotify API 一起使用。

有人可以帮助我，因为我真的需要这个功能才能工作吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:09:13.007

这对于 Web API 是不可能的，但是，看看[CocoaLibSpotify](https://github.com/spotify/cocoalibspotify)，它是一个 Mac 和 iOS 库，允许您访问用户的 Spotify 播放列表和播放曲目。

# c# - 与属性关联的函数不会触发？

> ID：16100509
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:10.617
> 
> 标签：c#, properties

`enter code here`我在 .cs 文件中有这个属性。每当我设置此属性时，与它关联的事件就会被触发。

```
 public event Action ResponseReceived;
    private string response;

    public string Response
    {

        get
        {
            return response;
        }

        set
        {
                response = value;
                if (ResponseReceived != null) { ResponseReceived(); }
        }

    } 
```

现在的问题是当我这样做时在另一个文件中

```
ResponseReceived += new Action(function_ResponseReceived);
void function_ResponseReceived()
{
    //change to gui thread
    if (InvokeRequired) 
    {   
        this.BeginInvoke(new Action(function_ResponseReceived), new object[] { }); 
        return; 
    }

    textBox1.Text = Response;
}

Response = "yes"; 
```

. . . （几行之后）。. .

```
Response = "no"; 
```

但`yes`不会触发与事件关联的函数，因为`Response = "no";`总是触发（该`Response`字段的更新速度比触发事件所需的时间快，所以我猜它被覆盖了）。有没有一种方法可以让我设置属性时与事件相关的函数都正确触发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:40:03.827

您对 Response 字段的更新速度比触发事件所需的时间更快的分析是不正确的。发生这种情况的唯一方法是，如果`ResponseReceived`委托在多个线程上更改，在这种情况下，您会遇到竞争条件。如果您查看代码，该方法中的每一步都将在同一个线程上连续执行（即一个接一个）。

必须重置或更改`ResponseReceived`事件-我的猜测是您在执行任何期望响应的操作之后设置事件处理程序，因此当第一个响应出现时，您尚未设置事件处理程序-在这种情况下，解决方案显然是在触发获取响应的操作之前设置事件处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T09:04:43.323

## 初步答案：

您显示的代码工作正常。
你的代码中一定有你提到的'. . . （几行之后）。. .'.

测试代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;    

namespace FunctionAssociatedPropertyFire {
    class Program {
        static void Main(string[] args) {
            new TestClass().Test();
            Console.ReadLine();
        }
    }
    class TestClass {
        public event Action ResponseReceived;
        private string response;    
        public string Response {
            get { return response; }    
            set {
                response = value;
                if (ResponseReceived != null) { ResponseReceived(); }
            }
        }

        void function_ResponseReceived() {
            Console.WriteLine("function_ResponseReceived");
        }

        public void Test() {
            ResponseReceived += new Action(function_ResponseReceived);
            Console.WriteLine("BeforeYes");
            Response = "yes";
            Console.WriteLine("AfterYes");
            Response = "no";
            Console.WriteLine("AfterNo");
        }
    }
} 
```

测试结果：

```
BeforeYes
function_ResponseReceived
AfterYes
function_ResponseReceived
AfterNo 
```

## 更新：

您正在异步调用，因此调用代码不会等待被调用的方法完成。您可以尝试使用 Invoke 方法而不是 BeginInvoke 方法。

```
void function_ResponseReceived() {
    //change to gui thread
    if (InvokeRequired) 
    {   
        this.Invoke(new Action(function_ResponseReceived), new object[] { }); 
        return; 
    }

    textBox1.Text = Response;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:42:59.963

只要您不篡改`ResponseReceived`两行之间的内容，就应该两次调用该操作。没有什么比该方法触发更快地更新该字段。

# d3.js - nvd3.js：更新图表时折线图中没有鼠标悬停数据点影响

> ID：16100510
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:15.437
> 
> 标签：d3.js, linechart, nvd3.js

我正在尝试使用 nvd3/d3 绘制一个简单的折线图。第一次加载图表时一切正常。但是，每当我加载新数据并更新图表时，在“鼠标悬停”期间发生在数据点上的转换都会丢失。虽然显示了工具提示。如何解决这个问题？

看看这个[jsFiddle 演示](http://jsfiddle.net/lkshminarayanan/af4nK/1/)。

添加代码：

```
//js :

    var n = 0;

var data = function (start) {
    var line1 = [],
        line2 = [];

    for (var i = start; i < start + 50; i++) {
        line1.push({
            x: i,
            y: 2 * i
        });
        line2.push({
            x: i,
            y: 3 * i
        });
    }

    return [{
        values: line1,
        key: 'y = 2 * x',
        color: '#ff7f0e'
    }, {
        values: line2,
        key: 'y = 3 * x',
        color: '#2ca02c'
    }];
}

var drawGraph = function (start) {
    var chart = nv.models.lineChart();

    chart.xAxis.axisLabel('Time (ms)')
        .tickFormat(d3.format(',r'));

    chart.yAxis.axisLabel('Voltage (v)')
        .tickFormat(d3.format('.02f'));

    d3.select('#chart svg')
        .datum(data(start))
        .transition().duration(500)
        .call(chart);

    nv.utils.windowResize(chart.update);

    return chart;
}

nv.addGraph(drawGraph(n));

$("button").click(function () {
    n += 50;
    nv.addGraph(drawGraph(n));
}); 
```

html页面：

```
<div id="chart">
<svg></svg>
</div>
<button>Change Graph</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:52:06.417

您需要的代码实际上比您拥有的要简单得多。您只需要创建一次图表对象，也不需要调用`nv.addGraph()`。我在[这里](http://jsfiddle.net/af4nK/2/)更新了 jsfiddle ；相关代码也在下面。

```
var chart = nv.models.lineChart();

chart.xAxis
  .axisLabel('Time (ms)')
  .tickFormat(d3.format(',r'));

chart.yAxis
  .axisLabel('Voltage (v)')
  .tickFormat(d3.format('.02f'));

var drawGraph=function(start) {
  d3.select('#chart svg')
    .datum(data(start))
    .transition().duration(500)
    .call(chart);

  nv.utils.windowResize(chart.update);
}

drawGraph(n);

$("button").click(function(){
  n += 50;
  drawGraph(n);
}); 
```

所有实际的绘图工作都是在生产线上完成的`.call(chart)`。

# oracle - Windows CE 和甲骨文

> ID：16100512
> 
> 赞同：2
> 
> 时间：2013-04-19T08:34:23.993
> 
> 标签：oracle, windows-ce, .net-assembly, system.data

我正在使用 VS2005，并且我有一个项目来构建用于 Windows CE 5 的应用程序，该应用程序连接到 Oracle 数据库 (11g)。这是我的代码：

```
 OracleConnection oConnexion = null;
        OracleCommand cmd = null;
        List<ApplicationEntity> ret = null;

        try {
            oConnexion = new OracleConnection();
            oConnexion.ConnectionString = oraConnection;

            oConnexion.Open();

            String sQuery = "SELECT ...";

            cmd = new OracleCommand(sQuery, oConnexion);
            cmd.CommandType = CommandType.Text;

            cmd.Parameters.Add(new OracleParameter(":1", OracleDbType.Varchar2));
            cmd.Parameters[":1"].Value = user.Badge;

            OracleDataReader dr = cmd.ExecuteReader();
            ... 
```

这是我的参考资料：

```
C:\Oracle\Ora11g_32\Client11g\odp.net\bin\2.x\Oracle.DataAccess.dll
C:\Program Files (x86)\Microsoft.NET\SDK\CompactFramework\v2.0\WindowsCE\System.Data.dll 
```

但是我有一些编译错误，我不明白为什么：

```
The type 'System.Data.Common.DbConnection' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'. 
The type 'System.Data.CommandType' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.
... 
```

你知道我该如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:15:39.893

这行不通。不能将桌面程序集与 Compact Framework 一起使用。Oracle 不提供 CF 连接器，所以我知道的唯一选择是在设备上[使用 Oracle Lite](http://www.oracle.com/technetwork/database/database-lite/twp-lite-10gr3-129866.pdf)，然后将本地数据库同步到企业数据库，或者使用像[DevArt 的 dotConnect](http://www.devart.com/dotconnect/oracle/)这样的商业 3rd-party 解决方案.

# asp.net-mvc-3 - 构建查询以填充视图模型时无法隐式转换类型错误

> ID：16100515
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:41.927
> 
> 标签：asp.net-mvc-3, entity-framework

我想做一个简单的查询来检索特定文章的组件数据+语言数据，然后将其放入视图模型中。

**ProductComponent**表是**Product**的子表，其中的相关字段是 ComponentID 和 ProductId（外键，parentId），所以我想将 ProductComponents 链接到 Product 和 ProductTranslations 我拥有所有语言特定数据的地方，所以我尝试了在一个查询中完成所有操作，以检索特定产品的组件列表。

这是查询：

```
 public IEnumerable<ProductComponents> ListComponents(int productid, string language)
    {
        var query = (from c in context.ProductComponents

                     from ct in context.ProductTranslations
                     where ct.ProductId == c.ComponentId
                     where ct.ProductLanguage == language

                     from cp in context.Product
                     where cp.ProductId == c.ComponentId

                     where c.ProductId == productid

                     select new EnumComponents
                     {
                         ProductId = c.ComponentId,
                         Name = ct.ProductName,
                         SKU = cp.SKU
                     });

        return query;
    } 
```

这给出了这个错误，并突出显示*返回查询；*部分：

```
Cannot implicitly convert type 'System.Linq.IQueryable<Artikelhantering.Models.EnumComponents>' to 'System.Collections.Generic.IEnumerable<Artikelhantering.Models.ProductComponents>'. An explicit conversion exists (are you missing a cast?) 
```

这是大部分数据模型，根据我在谷歌上搜索和查看 Stack Overflow 的结果，表之间的关系可能是罪魁祸首，所以我包括了大部分。

```
public class Product
    {
        [Key]
        public int ProductId { get; set; }
        [DisplayName("Article nr")]
        public string SKU { get; set; }
        [DisplayName("Product Category")]
        public int ProductCategoriesId { get; set; } 
        [DisplayName("Alternative Category")]
        public int? AdditionalCategoriesId { get; set; }
        [DisplayName("Show purchase button?")]
        public bool Purchase { get; set; } 
        [DisplayName("Show Product?")]
        public bool ShowProduct { get; set; } 
        [DisplayName("Picture name")]
        public string Picture { get; set; } 
        [DisplayName("Is reference product?")]
        public bool Reference { get; set; } 
        [DisplayName("Inprice")]
        public decimal inPrice { get; set; }    
        [DisplayName("Additional costs")]
        public decimal AddCost { get; set; } /
        [DisplayName("Weight in kg")]
        public decimal Weight { get; set; }
        [DisplayName("Volume in m^3")]
        public decimal Volume { get; set; }
        [DisplayName("Vat code, use 0")]
        public decimal VAT { get; set; }
        public virtual IList<ProductTranslations> ProductTranslations { get; set; }
        public virtual IList<ProductPrices> ProductPrices { get; set; }
        public virtual IList<ProductComponents> ProductComponents { get; set; }
        public virtual IList<ProductAccessories> ProductAccessories { get; set; }
        public virtual ProductCategories ProductCategories { get; set; }
        public virtual ProductCampaigns ProductCampaigns { get; set; }        
    }

    public class ProductTranslations 
    {
        [Key]
        public int ProductTranslationsId { get; set; }
        public int ProductId { get; set; } // This one links to the Product class
        [DisplayName("Language Code")]
        public string ProductLanguage { get; set; }
        [DisplayName("Description")]
        public string Description { get; set; }
        [DisplayName("Product Name")]
        public string ProductName { get; set; }
        [MaxLength(255)]
        [DisplayName("Meta Keywords")]
        public string MetaKeywords { get; set; }
        [MaxLength(255)]
        [DisplayName("Meta Description")]
        public string MetaDescription { get; set; }
        public virtual Product Product { get; set; }
    }

    public class ProductComponents 
    {
        [Key]
        public int ProductComponentsId { get; set; }
        public int ProductId { get; set; }
        public int ComponentId { get; set; }
        public virtual IList<ProductTranslations> ProductTranslations { get; set; }
        public virtual Product Product { get; set; }
    } 
```

然后我像这样定义模型之间的关系：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
            {
                modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();

                modelBuilder.Entity<ProductCategories>()
                .HasMany(x => x.ProductCategoriesTranslations) // Categories has many Translations
                .WithRequired(y => y.ProductCategories)     // Translations require a category
                .HasForeignKey(p => p.ProductCategoriesId);

                modelBuilder.Entity<Product>()
                .HasMany(x => x.ProductPrices) // Product has many ProductPricings
                .WithRequired(y => y.Product)     // ProductPricing has required Product
                .HasForeignKey(p => p.ProductId);

                modelBuilder.Entity<Product>()
                .HasMany(x => x.ProductTranslations) // Product has many ProductTranslations
                .WithRequired(y => y.Product)     // ProductTranslations has required Product
                .HasForeignKey(p => p.ProductId);

                modelBuilder.Entity<Product>()
                .HasMany(x => x.ProductComponents) // Product has many ProductComponents
                .WithRequired(y => y.Product)     // ProductComponents has required Product
                .HasForeignKey(p => p.ProductId);

                modelBuilder.Entity<Product>()
                .HasMany(x => x.ProductAccessories) // Product has many ProductAccessories
                .WithRequired(y => y.Product)     // ProductAccessories has required Product
                .HasForeignKey(p => p.ProductId);

            } 
```

我猜我需要为 ProductComponents 与 ProductTranslations 和 Product 定义适当的关系，但我不太确定如何，我尝试了各种方法来创建 ProductComponents -> ProductTranslations 之间的关系，但没有任何成功。当然，问题很可能是其他问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:51:55.597

看来是我自己想出来的。现在它终于点击了，非常简单和明显的错误。关键是将**public IEnumerable<ListComponents>**重命名为 public **IEnumerable<EnumComponents>**

回想起来似乎是合乎逻辑的，我应该在这里使用视图模型而不是模型，因为这毕竟是我想要填充的内容，然后我可以从视图模型内部调用模型就好了。

```
public IEnumerable<EnumComponents> ListComponents(int productid, string language)
    {
        //return context.ProductComponents.Where(m => m.ProductId == productid);
        var query = (from c in context.ProductComponents
        where c.ProductId == productid
        select new EnumComponents
        {
        Name = c.ProductTranslations
                    .Where(i => i.ProductLanguage == language)
                    .Where(i => i.ProductId == c.ComponentId)
                    .Select(i => i.ProductName)
                    .Single(),
        SKU = c.Product.SKU,
        ProductId = c.ComponentId
        });

        return (query);
    } 
```

# wso2 - WSO2 BPS - 动态 BPEL？

> ID：16100516
> 
> 赞同：0
> 
> 时间：2013-04-19T08:34:42.470
> 
> 标签：wso2, bpel

是否有可能有一个动态的 BPEL 流程来根据流程变量加载流程的一部分，或者我们必须将整个参数流程编码在一个大包中？能够在某个时间实例化不属于父进程的子进程可能很有用。

如果可能有任何教程或提示？

谢谢

卢卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T06:28:12.760

wso2 bps 不支持动态 bpel。一种选择是将您的流程分解为多个流程，并根据逻辑流在 bpel 中调用这些流程。

问候南迪卡

# windows-phone-7 - 标准平铺数据的背景图像是否有大小限制？

> ID：16100521
> 
> 赞同：1
> 
> 时间：2013-04-19T08:35:07.463
> 
> 标签：windows-phone-7

我正在尝试使用以下内容创建辅助磁贴`StandardTileData`：

```
StandardTileData tileData = new StandardTileData()
{
    Title = "",
    BackgroundImage = new Uri("/wifi.png", UriKind.Relative)
}; 
```

但是`BackgroundImage`没有设置，是否有一些尺寸限制？图像是否必须具有特定的属性集？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:18:57.963

图像大小不是这里的问题，而是文件位置。

您的[`BackgrounImage`](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.shell.standardtiledata.backgroundimage%28v=vs.105%29.aspx)图像必须保存到共享文件夹中：

> 如果 URI 引用存储在独立存储中的图像，则**该图像必须位于`Shared\ShellContent`文件夹**中。有关详细信息，请参阅[Windows Phone 的数据](http://msdn.microsoft.com/en-US/library/windowsphone/develop/ff402541%28v=vs.105%29.aspx)。

# show-hide - jQuery 切换显示/隐藏 - div 不展开

> ID：16100527
> 
> 赞同：3
> 
> 时间：2013-04-19T08:35:21.553
> 
> 标签：show-hide, jquery

我有一个小菜单，应该展开以显示下面的 HTML，目前它是隐藏的。

在 jQuery 之后：

```
$('.mobileMenu').click(function(e) {
    $(this).toggleClass('arrowDown').next().slideToggle('slow');
}); 
```

这段代码在[此页面](http://www.haselden.co.uk/rttest/inner.html)上效果很好（单击左侧的“隐藏”功能）

但是，我需要在“移动宽度”菜单中使用相同的功能。

如果您将浏览器的大小调整到 320 左右并转到[此处，](http://www.haselden.co.uk/rttest/index.html)您会看到菜单只是 +menu（在 mo 中有点糟糕但可以工作）。单击它，菜单会展开以显示链接，但它们挂在`main`内容区域上。

div 中的所有`navigation`div 都是，`display:block`但它们仍然不会将`main`div 向下推。我希望整个绿色`navigation`div 用它的内容来扩展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:47:55.937

`navigation`你在div`60px`和`menuWrapper`at的 div上有一个固定的高度`30px`。你需要使这个相对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:47:31.380

改变你的CSS

```
#rightCol {
width: 72.5%;
float:right;
}

#leftCol
{
width: 25%;
float:left;
} 
```

至

```
#rightCol {
width: 72.5%;
display:inline-block;
}

#leftCol
{
width: 25%;
display:inline-block;
} 
```

它应该工作。我已经在 chrome 上测试过了

# docx - 在 docx 中将图像彼此相邻放置

> ID：16100529
> 
> 赞同：0
> 
> 时间：2013-04-19T08:35:24.053
> 
> 标签：docx, image-replacement, opentbs, tinybutstrong

```
[audit; block=begin; comm=w:p; sub1=image] 
```

- 分页符 -

```
[audit_sub1; block=begin;] 
```

图像元素

```
[audit_sub1.path;ope=changepic;from=[val];default=current;adjust]
[audit_sub1; block=end;]
[audit; block=end; comm=w:p] 
```

在这种情况下发生的情况是，用于审核的所有图像都在页面上呈现在彼此下方。我希望图像水平渲染并在达到文档宽度时继续下一行。

**编辑**

当我把所有东西都写`[audit_sub1; block=begin;]`在`[audit_sub1; block=end;]`一行上时。我得到以下结果：

*   图 1 位于左上角（正确）
*   图像 2 位于图像 1 旁边（正确）
*   图像 3 在图像 1 上渲染（不正确，我希望它在新行上渲染，因为已达到宽度）

# facebook - facebook 发送 API 错误代码：100 API 错误描述：无效参数错误消息：“链接”无效

> ID：16100537
> 
> 赞同：10
> 
> 时间：2013-04-19T08:35:45.450
> 
> 标签：facebook, send

我正在使用 facebook post GRAPH UI 发布私人消息，其中包含指向我在 facebook 中的应用程序的链接。早些时候它工作正常，但从最近两天开始，对话框开始抛出错误：

> 发生错误。请稍后再试。
> 
> API 错误代码：100
> API 错误描述：无效参数
> 错误消息：“链接”无效。

发送消息我使用代码：

```
function sendMessage(id) {
  FB.ui({
    method : 'send',
    name : 'My APP',
    link : 'https://apps.facebook.com/MY_APP/',
    to : id,
    show_error : 'true',
    description : 'my description'
  });
} 
```

我对此进行了谷歌搜索，我得到的唯一相关信息是 Facebook 正在阻止指向其自己域的链接，以避免垃圾邮件。当我将链接更改为其他实时站点时，它的工作。

我需要将链接发送到我的应用程序，因为我必须提供这样的功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-14T14:19:22.407

我遇到过类似的问题，并想在这里分享我的调查结果。

Facebook 文档中描述该`link`参数的唯一信息不是很有帮助：

> **链接**- 在消息中发送的 URL。

### 还有其他几个与此类似/相关的 StackOverflow 问题：

### [Facebook API 错误 100 - 无效链接](https://stackoverflow.com/questions/15830066/facebook-api-error-100-invalid-link)

> 这个问题最终成为格式错误的`picture`参数

### [Facebook FB.ui 发送对话框间歇性地返回无效链接错误](https://stackoverflow.com/questions/17982183/facebook-fb-ui-send-dialog-intermittently-returns-invalid-link-error/18055274#18055274)-

> “问题围绕着我们的 url 是动态的并且每次都需要强制缓存。我现在对“ [https://developers.facebook.com/tools/debug/og/object](https://developers.facebook.com/tools/debug/og/object) ”进行 ajax 调用以刷新它，然后启动发送对话。”

## 我仍然不确切知道*什么*构成有效`link`参数，但是...

从上述问题和回答中做出一些推论，以及我的一些测试，有效`link`参数：

*   必须“完全合格”。IE 包含`http://`或`https://`
*   不能是链接**_**`facebook.com`
*   可能不喜欢重定向（或者你必须对它们偷偷摸摸）
*   *支持不在“应用程序域”列表中的*URL**
**   *支持*查询字符串*   可能对动态生成的页面很挑剔（如在[这个问题](https://stackoverflow.com/questions/17982183/facebook-fb-ui-send-dialog-intermittently-returns-invalid-link-error/18055274#18055274)中）*

 *显然，Facebook 有某种链接爬取机制，可以对`link`参数执行一些未知测试以确定其有效性。我只希望他们会选择为我们记录它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-07T15:05:39.580

找到了解决方案：

### [Facebook 发送对话框错误代码：100 API 错误描述：无效参数错误消息：“链接”无效。](http://blog.w3villa.com/programming/facebook-send-dialog-error-code-100-api-error-description-invalid-parameter-error-message-link-is-invalid/)

* * *

**问题原因：**

Facebook 不允许使用自己的链接来阻止垃圾邮件。

**问题方案：**

没有像 Facebook API 那样的解决方案。

**其他锻炼：**

缩短 URL，但它不适用于 Facebook 检查提供的 URL。重定向 URL，同上。在我的例子中，我部署了一个额外的 HTML 页面，用于重定向到 Facebook 应用程序链接。请记住，当 Facebook 扫描提供的 URL 时，您应该有几秒钟的计时器，因此它无法检测到页面正在重定向到相同的应用程序链接。我为我的 HTML 文件使用了以下代码：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>My Application</title>
</head>
<body>
    <p id="demo"></p>
</body>
<script type="text/javascript">
    var url = "https://apps.facebook.com/MY_APPLICATION_ID";
    var myVar = setInterval(function() {
        myTimer()
    }, 1000);
    var counter = 3;
    function myTimer() {
        if (counter == 0) {
            window.location.replace(url);
            window.clearInterval(myVar);
        }
        document.getElementById("demo").innerHTML = "you will be redirected in "
                + counter + " seconds...";
        counter = counter - 1;
    }
</script>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-05T10:07:16.390

除了我的链接指向我的网站外，我遇到了完全相同的问题。

如果有人处于类似情况，请查看[此解决方案](https://stackoverflow.com/questions/17982183/facebook-fb-ui-send-message-dialog-intermittently-returns-invalid-link-error/18055274#18055274)。希望这会帮助一些人。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-04T23:15:16.273

如果出现错误参数并且消息显示“API 错误代码：100” - 确保在 youtube 中未选中“与播放列表共享”旁边的框，并且该错误不会显示。*

# android - Robotium 测试框架错误

> ID：16100540
> 
> 赞同：0
> 
> 时间：2013-04-19T08:35:57.673
> 
> 标签：android, junit, robotium

我是新手，`Robotium test framework.` 我创建了一个示例项目，在该项目中，我只需单击一个按钮即可将一项活动移动到其他活动。

我的测试用例运行良好，但在涉及第二个活动时它会崩溃..

我的测试用例代码

```
public void testDisplayBlackBox() {
    solo.clickOnButton("Button");
    solo.assertCurrentActivity("Expected MainActivity activity", "SecondActvity");
    } 
```

我收到以下错误

```
junit.framework.ComparisonFailure: Expected MainActivity activity expected:<SecondAct[]vity> but was:<SecondAct[i]vity>
at com.jayway.android.robotium.solo.Asserter.assertCurrentActivity(Asserter.java:41)
at com.jayway.android.robotium.solo.Solo.assertCurrentActivity(Solo.java:588)
at com.example.ddd.MainActivityTest.testDisplayBlackBox(MainActivityTest.java:28)
at java.lang.reflect.Method.invokeNative(Native Method)
at android.test.InstrumentationTestCase.runMethod(InstrumentationTestCase.java:214)
at android.test.InstrumentationTestCase.runTest(InstrumentationTestCase.java:199)
at android.test.ActivityInstrumentationTestCase2.runTest(ActivityInstrumentationTestCase2.java:192)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1661) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:37:58.870

它在进入第二个之后不会崩溃，`activity`它会突然关闭，`activity2`如果你想看到以前的动作单独使用，这是一种正常的行为。`goBack()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:56:10.743

似乎您在 assertCurrentActivity 函数中的字符串有错字。

```
activity expected:<SecondAct[]vity> but was:<SecondAct[i]vity> 
```

检查此功能。如果仍然发生，请为我们提供一些代码编辑：

尝试：solo.assertCurrentActivity("你想要什么",SecondActivity.class);

# javascript - 未捕获的类型错误：无法将属性“值”设置为 null

> ID：16100543
> 
> 赞同：23
> 
> 时间：2013-04-19T08:36:08.563
> 
> 标签：javascript, html

我正在尝试使用 ajax 请求将输入的文本传递给控制器​​。但是当我尝试执行 JS 文件时，我收到了错误“Uncaught TypeError: Cannot set property 'value' of null”。

这是HTML代码：

```
<form action="">
    <input type="text" class="searchbox1" name="search" placeholder="Search for Brand, Store or an Item..." value="text" />
    <input type="button" class="searchbox_submit1" name="submit" value="text" onClick="javascript:getSearchText();">
</form> 
```

这是JS代码：

```
function getSearchText() {
    var searchText = document.getElementByName("search").value;
    h_url=document.getElementById("u").value;
    var theURL = h_url+'search_all/' + deptid + '/' + searchText + '/1';
    $.ajax({
        url : theURL,
        fail: function(){
        },
        success : function() {
        },
        error:function(){
        }
    });
} 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-19T08:38:26.263

您没有带有 id 的元素`u`。这就是发生错误的原因。请注意，您正在尝试获取名称为 'u' 的输入元素的值，并且它没有在您的代码中定义。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-09-20T15:09:11.180

问题可能在代码被执行的地方。如果您在执行 JavaScript 的文档的头部，即使您的网页中有一个 id="u" 的元素，代码也会在 DOM 完成加载之前执行，因此 HTML 还没有真正存在。 .. 您可以通过将代码移动到页面末尾的 html 结束标记上方来解决此问题。这是使用 jQuery 的一个很好的理由。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-07-29T14:49:26.443

如果有人因类似问题登陆此页面，我发现如果您的 JavaScript 在表单准备好之前在 HEAD 中运行，则可能会发生此错误。将您的 JavaScript 移到页面底部可以解决我的情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-11-30T19:53:06.603

问题是您没有任何具有 id 的元素，`u`因此您正在调用不存在的东西。
要解决这个问题，您必须向元素添加一个 id。

```
<input id="u" type="text" class="searchbox1" name="search" placeholder="Search for Brand, Store or an Item..." value="text" /> 
```

而且我也看到你为输入添加了一个值，所以这意味着输入不是空的，它将包含*text*。结果`placeholder`不会显示。

最后有一个警告，W3Validator 会说因为最后的“/”。：

> 对于当前文档，验证器会根据传统规则解释字符串，这些规则**打破了大多数作者的期望**，从而导致来自验证器的*令人困惑*的警告和错误消息。这种解释由 HTML 4 文档或其他基于 SGML 的 HTML 文档触发。要避免这些消息，只需在此类上下文中**删除“/”字符。**注意：如果您希望*<FOO />*被解释为与*XML 兼容的*“自关闭”标签，那么您需要使用*XHTML*或*HTML5*。

总之，它说你必须删除斜线。简单地写这个：

```
<input id="u" type="text" class="searchbox1" name="search" placeholder="Search for Brand, Store or an Item..."> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-25T05:14:46.437

我知道我回答这个答案为时已晚，但我希望这对其他正在面对和将要面对的人有所帮助。

正如您所写的那样， h_url 是全局`var = h_url;`变量，因此您可以在文件中的任何位置使用该变量。

*   `h_url=document.getElementById("u").value;` 这里 h_url 包含用户输入的搜索框文本值的值。

*   document.getElementById("u"); 这是您的表单字段的标识符，带有一些特定的`ID`.

*   您的搜索字段没有`id`

    `<input type="text" class="searchbox1" name="search" placeholder="Search for Brand, Store or an Item..." value="text" />`

*   更改搜索字段`id`

    `<input id="u" type="text" class="searchbox1" name="search" placeholder="Search for Brand, Store or an Item..." value="text" />`

*   当您单击提交时，它将尝试从中获取`document.getElementById("u").value;`语法正确但您尚未定义 id 的值，以便返回`null`。

*   因此，只需确保在使用表单字段时首先定义该 ID 并执行其他任务。

我希望这对您有所帮助，并且永远不会`Cannot set property 'value' of null` 出错。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-16T10:32:53.133

伙计们这个错误是因为元素 ID 在 js 中不可见尝试从 UI 中检查元素并将其粘贴到 javascript 文件中：

前 ：

```
document.getElementById('form:salesoverviewform:ticketstatusid').value =topping; 
```

后 ：

```
document.getElementById('form:salesoverviewform:j_idt190:ticketstatusid').value =topping; 
```

归功于 Divya Akka .... :)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-19T08:38:17.580

好像是这个功能

```
h_url=document.getElementById("u").value; 
```

您可以使用一些“console.log”来帮助自己查看 Null 对象。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-19T08:39:39.043

`h_url=document.getElementById("u")`此处为空

不存在 id 为的元素`u`

# sql - SQLlite 错误#2044：'AUTOINCEREMENT' 附近：语法错误

> ID：16100544
> 
> 赞同：-1
> 
> 时间：2013-04-19T08:36:15.780
> 
> 标签：sql, sqlite

它不断抛出错误：

> 错误 #2044：未处理的 SQLErrorEvent：。errorID=3115，操作=执行，消息=错误 #3115：SQL 错误。，详细信息='AUTOINCEREMENT'附近：语法错误；

谁能告诉我发生了什么事！感谢！

我的代码：

```
private function createTable():void
{
    var sql:String="CREATE TABLE IF NOT EXISTS log("+"log_id INTEGER PRIMARY KEY AUTOINCEREMENT NOT NULL,"+
        "log_date FLOAT NULL,"+"log_content TEXT NULL)";
    var st:SQLStatement=new SQLStatement();
    st.sqlConnection=conn;
    st.text=sql;
    st.execute()
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:55:29.977

不应该是`AUTOINCREMENT`，而不是`AUTOINCEREMENT`？

见[https://www.sqlite.org/autoinc.html](https://www.sqlite.org/autoinc.html)

# javascript - Jspdf无法导出网页

> ID：16100545
> 
> 赞同：3
> 
> 时间：2013-04-19T08:36:20.777
> 
> 标签：javascript

我已经下载了 jspdf，并在示例文件夹中运行了 basic.html。当我选择演示时，没有导出 pdf。我在 basic.js 脚本中添加了读取导出网页的内容，有什么遗漏的吗？我正在使用 Firefox 20。

这是我的测试页面：Test.html。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Testt</title>

    <script type="text/javascript" src="js/jquery/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="js/jquery/jquery-ui-1.8.17.custom.min.js"></script>
    <script type="text/javascript" src="jspdf.js"></script>
    <script type="text/javascript" src="libs/Deflate/adler32cs.js"></script>
    <script type="text/javascript" src="libs/FileSaver.js/FileSaver.js"></script>
    <script type="text/javascript" src="libs/Blob.js/BlobBuilder.js"></script>
    <script type="text/javascript" src="jspdf.plugin.addimage.js"></script>
    <script type="text/javascript" src="jspdf.plugin.standard_fonts_metrics.js"></script>
    <script type="text/javascript" src="jspdf.plugin.split_text_to_size.js"></script>
    <script type="text/javascript" src="jspdf.plugin.from_html.js"></script>
    <script type="text/javascript" src="js/basic.js"></script>
</head>

<body>
<script>

</script>

<a href="javascript:demoTwoPageDocument()" class="button">Run Code</a>
</body>
</html> 
```

这是js脚本：basic.js

```
function htmldemo(){
    var doc = new jsPDF();

// We'll make our own renderer to skip this editor
var specialElementHandlers = {
    '#editor': function(element, renderer){
        return true;
    }
};

// All units are in the set measurement for the document
// This can be changed to "pt" (points), "mm" (Default), "cm", "in"
doc.fromHTML($('body').get(0), 15, 15, {
    'width': 170, 
    'elementHandlers': specialElementHandlers
}); 
}

function demoTwoPageDocument() {
    var doc = new jsPDF();
    doc.text(20, 20, 'Hello world!');
    doc.text(20, 30, 'This is client-side Javascript, pumping out a PDF.');
    doc.addPage();
    doc.text(20, 20, 'Do you like that?');

    // Save the PDF
    doc.save('Test.pdf');
}

function demoLandscape() {
    var doc = new jsPDF('landscape');
    doc.text(20, 20, 'Hello landscape world!');

    // Save the PDF
    doc.save('Test.pdf');
}

function demoFontSizes() {
    var doc = new jsPDF();
    doc.setFontSize(22);
    doc.text(20, 20, 'This is a title');

    doc.setFontSize(16);
    doc.text(20, 30, 'This is some normal sized text underneath.');

    doc.save('Test.pdf');
}

function demoFontTypes() {
    var doc = new jsPDF();

    doc.text(20, 20, 'This is the default font.');

    doc.setFont("courier");
    doc.setFontType("normal");
    doc.text(20, 30, 'This is courier normal.');

    doc.setFont("times");
    doc.setFontType("italic");
    doc.text(20, 40, 'This is times italic.');

    doc.setFont("helvetica");
    doc.setFontType("bold");
    doc.text(20, 50, 'This is helvetica bold.');

    doc.setFont("courier");
    doc.setFontType("bolditalic");
    doc.text(20, 60, 'This is courier bolditalic.');

    doc.save('Test.pdf');
}

function demoTextColors() {
    var doc = new jsPDF();

    doc.setTextColor(100);
    doc.text(20, 20, 'This is gray.');

    doc.setTextColor(150);
    doc.text(20, 30, 'This is light gray.');

    doc.setTextColor(255,0,0);
    doc.text(20, 40, 'This is red.');

    doc.setTextColor(0,255,0);
    doc.text(20, 50, 'This is green.');

    doc.setTextColor(0,0,255);
    doc.text(20, 60, 'This is blue.');

    // Output as Data URI
    doc.output('datauri');
}

function demoMetadata() {
    var doc = new jsPDF();
    doc.text(20, 20, 'This PDF has a title, subject, author, keywords and a creator.');

    // Optional - set properties on the document
    doc.setProperties({
        title: 'Title',
        subject: 'This is the subject',
        author: 'James Hall',
        keywords: 'generated, javascript, web 2.0, ajax',
        creator: 'MEEE'
    });

    doc.save('Test.pdf');
}

function demoUserInput() {  
    var name = prompt('What is your name?');
    var multiplier = prompt('Enter a number:');
    multiplier = parseInt(multiplier);

    var doc = new jsPDF();
    doc.setFontSize(22);    
    doc.text(20, 20, 'Questions');
    doc.setFontSize(16);
    doc.text(20, 30, 'This belongs to: ' + name);

    for(var i = 1; i <= 12; i ++) {
        doc.text(20, 30 + (i * 10), i + ' x ' + multiplier + ' = ___');
    }

    doc.addPage();
    doc.setFontSize(22);
    doc.text(20, 20, 'Answers');
    doc.setFontSize(16);

    for (i = 1; i <= 12; i ++) {
        doc.text(20, 30 + (i * 10), i + ' x ' + multiplier + ' = ' + (i * multiplier));
    }
    doc.save('Test.pdf');

}

function demoRectangles() {
    var doc = new jsPDF();

    doc.rect(20, 20, 10, 10); // empty square

    doc.rect(40, 20, 10, 10, 'F'); // filled square

    doc.setDrawColor(255, 0, 0);
    doc.rect(60, 20, 10, 10); // empty red square

    doc.setDrawColor(255, 0, 0);
    doc.rect(80, 20, 10, 10, 'FD'); // filled square with red borders

    doc.setDrawColor(0);
    doc.setFillColor(255, 0, 0);
    doc.rect(100, 20, 10, 10, 'F'); // filled red square

    doc.setDrawColor(0);
    doc.setFillColor(255, 0, 0);
    doc.rect(120, 20, 10, 10, 'FD'); // filled red square with black borders

    doc.setDrawColor(0);
    doc.setFillColor(255, 255, 255);
    doc.roundedRect(140, 20, 10, 10, 3, 3, 'FD'); //  Black sqaure with rounded corners

    doc.save('Test.pdf');
}

function demoLines() {
    var doc = new jsPDF();

    doc.line(20, 20, 60, 20); // horizontal line

    doc.setLineWidth(0.5);
    doc.line(20, 25, 60, 25);

    doc.setLineWidth(1);
    doc.line(20, 30, 60, 30);

    doc.setLineWidth(1.5);
    doc.line(20, 35, 60, 35);

    doc.setDrawColor(255,0,0); // draw red lines

    doc.setLineWidth(0.1);
    doc.line(100, 20, 100, 60); // vertical line

    doc.setLineWidth(0.5);
    doc.line(105, 20, 105, 60);

    doc.setLineWidth(1);
    doc.line(110, 20, 110, 60);

    doc.setLineWidth(1.5);
    doc.line(115, 20, 115, 60);

    // Output as Data URI
    doc.output('datauri');
}

function demoCircles() {
    var doc = new jsPDF();

    doc.ellipse(40, 20, 10, 5);

    doc.setFillColor(0,0,255);
    doc.ellipse(80, 20, 10, 5, 'F');

    doc.setLineWidth(1);
    doc.setDrawColor(0);
    doc.setFillColor(255,0,0);
    doc.circle(120, 20, 5, 'FD');

    doc.save('Test.pdf');
}

function demoTriangles() {
    var doc = new jsPDF();

    doc.triangle(60, 100, 60, 120, 80, 110, 'FD');

    doc.setLineWidth(1);
    doc.setDrawColor(255,0,0);
    doc.setFillColor(0,0,255);
    doc.triangle(100, 100, 110, 100, 120, 130, 'FD');

    doc.save('Test.pdf');
}

function demoImages() {
    // Because of security restrictions, getImageFromUrl will
    // not load images from other domains.  Chrome has added
    // security restrictions that prevent it from loading images
    // when running local files.  Run with: chromium --allow-file-access-from-files --allow-file-access
    // to temporarily get around this issue.
    var getImageFromUrl = function(url, callback) {
        var img = new Image(), data, ret = {
            data: null,
            pending: true
        };

        img.onError = function() {
            throw new Error('Cannot load image: "'+url+'"');
        };
        img.onload = function() {
            var canvas = document.createElement('canvas');
            document.body.appendChild(canvas);
            canvas.width = img.width;
            canvas.height = img.height;

            var ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            // Grab the image as a jpeg encoded in base64, but only the data
            data = canvas.toDataURL('image/jpeg').slice('data:image/jpeg;base64,'.length);
            // Convert the data to binary form
            data = atob(data);
            document.body.removeChild(canvas);

            ret['data'] = data;
            ret['pending'] = false;
            if (typeof callback === 'function') {
                callback(data);
            }
        };
        img.src = url;

        return ret;
    };

    // Since images are loaded asyncronously, we must wait to create
    // the pdf until we actually have the image data.
    // If we already had the jpeg image binary data loaded into
    // a string, we create the pdf without delay.
    var createPDF = function(imgData) {
        var doc = new jsPDF();

        doc.addImage(imgData, 'JPEG', 10, 10, 50, 50);
        doc.addImage(imgData, 'JPEG', 70, 10, 100, 120);

        doc.save('output.pdf');

    }

    getImageFromUrl('thinking-monkey.jpg', createPDF);
}

function demoStringSplitting() {

    var pdf = new jsPDF('p','in','letter')
    , sizes = [12, 16, 20]
    , fonts = [['Times','Roman'],['Helvetica',''], ['Times','Italic']]
    , font, size, lines
    , margin = 0.5 // inches on a 8.5 x 11 inch sheet.
    , verticalOffset = margin
    , loremipsum = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus id eros turpis. Vivamus tempor urna vitae sapien mollis molestie. Vestibulum in lectus non enim bibendum laoreet at at libero. Etiam malesuada erat sed sem blandit in varius orci porttitor. Sed at sapien urna. Fusce augue ipsum, molestie et adipiscing at, varius quis enim. Morbi sed magna est, vel vestibulum urna. Sed tempor ipsum vel mi pretium at elementum urna tempor. Nulla faucibus consectetur felis, elementum venenatis mi mollis gravida. Aliquam mi ante, accumsan eu tempus vitae, viverra quis justo.\n\nProin feugiat augue in augue rhoncus eu cursus tellus laoreet. Pellentesque eu sapien at diam porttitor venenatis nec vitae velit. Donec ultrices volutpat lectus eget vehicula. Nam eu erat mi, in pulvinar eros. Mauris viverra porta orci, et vehicula lectus sagittis id. Nullam at magna vitae nunc fringilla posuere. Duis volutpat malesuada ornare. Nulla in eros metus. Vivamus a posuere libero.'

    // Margins:
    pdf.setDrawColor(0, 255, 0)
        .setLineWidth(1/72)
        .line(margin, margin, margin, 11 - margin)
        .line(8.5 - margin, margin, 8.5-margin, 11-margin)

    // the 3 blocks of text
    for (var i in fonts){
        if (fonts.hasOwnProperty(i)) {
            font = fonts[i]
            size = sizes[i]

            lines = pdf.setFont(font[0], font[1])
                        .setFontSize(size)
                        .splitTextToSize(loremipsum, 7.5)
            // Don't want to preset font, size to calculate the lines?
            // .splitTextToSize(text, maxsize, options)
            // allows you to pass an object with any of the following:
            // {
            //  'fontSize': 12
            //  , 'fontStyle': 'Italic'
            //  , 'fontName': 'Times'
            // }
            // Without these, .splitTextToSize will use current / default
            // font Family, Style, Size.
            console.log(lines);
            pdf.text(0.5, verticalOffset + size / 72, lines)

            verticalOffset += (lines.length + 0.5) * size / 72
        }
    }

    pdf.save('Test.pdf');
}

function demoFromHTML() {
    var pdf = new jsPDF('p', 'in', 'letter');

    // source can be HTML-formatted string, or a reference
    // to an actual DOM element from which the text will be scraped.
    var source = $('#fromHTMLtestdiv')[0]

    // we support special element handlers. Register them with jQuery-style 
    // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
    // There is no support for any other type of selectors 
    // (class, of compound) at this time.
    , specialElementHandlers = {
        // element with id of "bypass" - jQuery style selector
        '#bypassme': function(element, renderer){
            // true = "handled elsewhere, bypass text extraction"
            return true
        }
    }

    // all coords and widths are in jsPDF instance's declared units
    // 'inches' in this case
    pdf.fromHTML(
        source // HTML string or DOM elem ref.
        , 0.5 // x coord
        , 0.5 // y coord
        , {
            'width':7.5 // max width of content on PDF
            , 'elementHandlers': specialElementHandlers
        }
    )

    pdf.save('Test.pdf');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-31T14:26:54.713

10/31/13 - 我遇到了同样的问题。通过删除 basic.js 文件第 312 行末尾的分号来修复它。

# android-intent - 在片段之间传递意图

> ID：16100548
> 
> 赞同：1
> 
> 时间：2013-04-19T08:36:45.747
> 
> 标签：android-intent, android-fragments

我想将一个从一个选项卡传递到另一个选项卡的意图。当我在第一个片段中按下一个按钮时，我希望它引导我到另一个片段（例如活动）。是否有另一种方法可以在类似于 startActivity(new Intent(EntryTab.this, Journals.class)); 的片段中执行此操作 ? 下面是我的代码，startActivity 行显示错误。请帮忙！

```
public class EntryTab extends Fragment{
    public static final String LOGTAG = "BALANCE";
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        final LinearLayout ll = (LinearLayout) inflater.inflate(R.layout.entries, container, false);
        Button save = (Button) ll.findViewById(R.id.entriesButton);
        save.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                BalanceApp myapp= (BalanceApp) getActivity().getApplicationContext();
                DataSource datasource = myapp.datasource;
                datasource.open();

                Log.i(LOGTAG,"inside tab entry");

                EditText amount = (EditText) ll.findViewById(R.id.amount);
                int amt = Integer.parseInt(amount.getText().toString());

                 EditText debit = (EditText)ll.findViewById(R.id.debitText);
                 String dr = debit.getText().toString();

                 EditText credit = (EditText)ll.findViewById(R.id.creditText);
                 String cr = credit.getText().toString();

                 datasource.createEntry(dr, "DR", amt);
                 datasource.createEntry(cr, "CR", amt);

                 Cursor c=datasource.database.rawQuery("SELECT * FROM entries", null);
                 c.moveToFirst();
              //   Log.i(LOGTAG, dr + " " + amt + " " + cr );// the last row

                 Log.i(LOGTAG, c.getString(0) + " " + c.getString(1) + " " + c.getString(2) );// shows always the first row
                 datasource.close();

                 startActivity(new Intent(EntryTab.this, Journals.class)); // error: the constructor intent is undefined.

        }
    });
    return ll;      
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:16:11.943

一个活动可以有很多片段。在片段中，您可以通过`getActivity()`方法获取活动。

此外，要从活动 A -> 活动 B，我们使用意图。同样，要从 Fragment A -> Fragment B，在 Activity A 中，我们使用 FragmentTransactions。

```
FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();
Fragment f = new CustomFragment();
fragmentTransaction.add(R.id.fragment_container, f);
fragmentTransaction.commit(); 
```

另外，使用`addToBackStack()`方法，以便在回压时从片段 B 返回到片段 A。

# angularjs - 用 angular.js 构造一个烧瓶

> ID：16100549
> 
> 赞同：7
> 
> 时间：2013-04-19T08:36:49.050
> 
> 标签：angularjs, flask

如何使用 angular.js 前端构建烧瓶应用程序？什么是最佳实践？即使在进行开发时，我是否应该使用像 ngnix 这样的网络服务器来托管静态文件？

使用烧瓶默认值，我可以提供 index.html 如下所示：

```
@app.route('/')
def index():
    return make_response(open('static/index.html').read()) 
```

或者

```
@app.route('/')
def index():
    return send_from_directory('static', 'index.html') 
```

但是，有一个问题是我不能指向没有'../static'前缀的js文件。我只想指出 angular.js 和所有其他人，例如：

```
<script src="lib/angular/angular.js"></script> 
```

不是

```
<script src="../static/lib/angular/angular.js"></script> 
```

我可以更改烧瓶中的所有静态文件前缀吗？或者有没有解决这个问题的好方法？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:41:34.307

如果你真的想，你可以：

```
app = Flask(__name__, static_url_path='') 
```

虽然我只是使用绝对 URL：

```
/static/lib/angular/angular.js 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-01T06:33:32.703

我认为最佳实践是让您的 Web 服务器为您提供所有静态内容（angularjs、其他 js 文件、html、css、图像等）。

然后使用某种类型的约定（我喜欢使用“/api”路径）来为您的烧瓶服务器提供和接收数据。

例如，在您的 apache 配置中：

```
<VirtualHost *:80>
    DocumentRoot /path/to/static/files
    WSGIScriptAlias /api /path/to/flask/flask.wsgi
    ...
</VirtualHost> 
```

# android - Android：如何保存应用程序范围的实例状态？

> ID：16100550
> 
> 赞同：1
> 
> 时间：2013-04-19T08:36:49.860
> 
> 标签：android

关于应用程序范围的状态，我已经阅读了许多关于 POJO 单例与子类化应用程序类的讨论。

关于保存状态，我了解了 Activity.onSaveInstanceState。

但是由于应用程序并没有真正的生命周期方法，我如何保存从多个活动中使用的状态？

我的第一个想法是在我的主 Activity 中使用 onCreate() 和 onSaveInstanceState()，但是如果用户在另一个 Activity 中暂停应用程序会发生什么？当应用程序回到前面时，只会重新创建这个活动，而不是我的主要活动，对吧？

我是否必须在我的所有活动中执行相同的 onSaveInstanceState 和 onCreate 操作，还是有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:40:44.697

> 如何保存从多个活动中使用的状态？

当数据改变时更新你的持久化存储。根据定义，没有“从多个活动中使用”的“实例状态”。

> 我的第一个想法是在我的主 Activity 中使用 onCreate() 和 onSaveInstanceState()，但是如果用户在另一个 Activity 中暂停应用程序会发生什么？

最终，您的进程被终止。“实例状态”（例如，`onSaveInstanceState()`）*可能*会在稍后再次提供给您，具体取决于具体情况。您绝对需要保留的任何内容都需要放入持久存储（数据库、`SharedPreferences`文件）中，通常在数据发生更改时，就像过去 60 年来软件的编写方式一样。

# c++ - 如何为 QTreeWidget 中的特定行设置背景颜色

> ID：16100552
> 
> 赞同：1
> 
> 时间：2013-04-19T08:37:06.210
> 
> 标签：c++, qt, qt4

我想为 QTableWidget 中的特定行设置颜色，就像 setAlternatingRowColors 一样，只有我应该能够指定我想要的行和颜色。我尝试了以下代码

```
QBrush b (QColor(224,224,224));
item->setBackground( 0 , b );
item->setBackground( 1 , b );
item->setBackground( 2 , b ); 
```

但此代码仅用颜色填充项目列，而不是整行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:04:42.447

由于 Qt 在不同的 QTableWidgetItems 中处理 QTableWidget 的所有字段，因此根本无法像您在此处建议的那样简单地影响表中的完整行。由于您似乎只使用标准字段而没有自定义“特价”，因此您可以遍历一行 QTableWidgetItems 并一一设置它们的背景。

更符合您需求的更时尚的方式是使用 Qt 的模型/视图框架通过使用 QBackgroundRole 的数据后端获取背景颜色。一个很好的起点是：http: [//qt-project.org/doc/qt-4.8/model-view-programming.html](http://qt-project.org/doc/qt-4.8/model-view-programming.html)

掌握 MVC 范式背后的概念可能更难，但一旦掌握，它确实非常灵活。

# jquery - 存储一次原始文本

> ID：16100554
> 
> 赞同：2
> 
> 时间：2013-04-19T08:37:14.403
> 
> 标签：jquery, text, responsive-design, store

我有一个简单的函数，它获取 div 的原始文本，并在用户调整窗口大小（响应式站点）时更改此文本。当用户再次放大窗口时，必须显示原始文本。这很简单，但我有一个小问题。

```
function limitH2Text() {
        var origText = $(".result .right .mask").text();
        var width = $(window).width();
        if (width < 811) {
            $(".result .right .mask").each(function () {
                var $this = $(this);
                $this.text($this.text().slice(0, 75));
                $this.append('...').show();
            });
        } else {
            $(".result .right .mask").each(function () {
                $(this).text(origText);
            });
        }
    } 
```

控制台显示 var origText 包含三个 [.result .right .mask] div 的文本。你看，HTML 是 [.result .right .mask] 的重复。所以代替（例如）'你好，这是文本'，它显示'你好，这是文本你好，这是文本你好，这是文本'。当用户调整大小时，它会呈指数增长，因此浏览器会崩溃。我不知道如何只存储一个 div 的文本？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:41:26.643

尝试使用[**.eq()**](http://api.jquery.com/eq/)：

```
var origText = $(".result .right .mask").eq(0).text(); 
```

这会将匹配的元素集减少到指定索引处的元素，并存储那个 div 的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:40:58.503

您可以将原始文本存储在其 data-origText 属性中

```
function limitH2Text() {
        var origText = $(".result .right .mask").text();
         $(this).attr( "data-origText", origText  );
        var width = $(window).width();
        if (width < 811) {
            $(".result .right .mask").each(function () {
                var $this = $(this);
                $this.text($this.text().slice(0, 75));
                $this.append('...').show();
            });
        } else {
            $(".result .right .mask").each(function () {
                $(this).text( $(this).attr( "data-origText" ) );
            });
        }
    } 
```

# javascript - 如果资源不可访问，则为辅助来源

> ID：16100566
> 
> 赞同：2
> 
> 时间：2013-04-19T08:37:50.330
> 
> 标签：javascript, jquery, html, performance

事情是这样的：我正在处理的项目中有一个小型板载服务器，运行速度有点慢，所以我想将包含的小型网站的图像移动到外部资源，如外部 Web 服务器；

问题是，我不确定当我访问它时我是否会一直连接到互联网，也许我只会在局域网中。

所以我的问题是：如何为网页上的图像指定主要（外部）和次要/备份（本地）源？所以如果用户连接到互联网，这会减轻小服务器的负载吗？

提前谢谢各位！

编辑：我在这里找到了答案： [jQuery/JavaScript to replace broken images](https://stackoverflow.com/questions/92720/jquery-javascript-to-replace-broken-images)

- 这是错误，带有直接重新分配图像的内联javascript函数！（很棒的东西）

干杯，来自互联网的好人，帮助有需要的人！^^

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:42:34.260

加载失败时可以调用 onerror：

`<img onerror="runSomeScriptThatReplacesThisImage()" ...`

或者：

`<img onerror="this.src='yourOtherImage.jpg" ...`

只是要小心，因为如果`onerror`也失败了，你会得到一个循环。所以一定要避免这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T09:29:20.790

这可以在不使用任何 JavaScript 的情况下完成。

该[`object`元素](http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element)可用于显示图像。如果引用的图像（在`data`属性中）无法加载，`object`将使用 的后备内容。现在，如果你包括另一个`object`，这个将被尝试。最后一个应该包括替代的备用内容，例如描述图像的文本（类似于`alt`属性 on `img`）。

```
<object type="image/png" data="http://foo.example.com/external-image.png">
  <object type="image/png" data="/local-image.png">
    <!-- alternative text for the image (if even the local one cannot be loaded; for accessibility; etc.) -->
  </object>
</object> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:41:54.920

您的图像目录将有两个 URL，例如

1.  //www.remote.com/images/
2.  〜/图像/

当会话开始时，您可以向远程服务器发出请求，如果请求超时或者您没有收到 200 响应，您可以使用本地 URL 库。我建议将其存储在会话变量中以便于访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T08:41:32.723

我认为您最好的选择是使用 AJAX 检索图像。

然后，如果快速服务器出现故障，您可以回退到从慢速服务器中检索它们。

# python - python用单个'-'替换所有特殊字符和空格

> ID：16100568
> 
> 赞同：3
> 
> 时间：2013-04-19T08:37:55.660
> 
> 标签：python, regex, string

我正在尝试仅用单个“-”替换字符串中的所有特殊字符和空格

例如：

输入：`"Games & Fun"`

输出：`"Games-Fun"`

我试过了

```
>>> re.sub('[&" "]', '-', "Games & Fun")
'Games---Fun' 
```

但我`"Games-Fun"`只想要。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-19T08:39:11.107

```
>>> import re
>>> text = "Games & Fun"
>>> re.sub(r'\W+', '-', text)
'Games-Fun' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T08:42:45.793

```
>>> re.sub(r'[&\s]+', '-', "Games & Fun")
'Games-Fun' 
```

# c++ - python opencv中是否支持BackgroundSubtractorMOG2

> ID：16100569
> 
> 赞同：1
> 
> 时间：2013-04-19T08:37:59.307
> 
> 标签：c++, python, opencv

BackgroundSubtractorMOG2 是否有 Python 绑定，cpp 显然有。 我在想openCV的python版本和cpp版本
之间有兼容性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:17:11.520

OpenCV 2.x API 为您提供了 BackgroundSubtractorMOG 的 Python 绑定，只需查看此网站 [http://docs.opencv.org/modules/video/doc/motion_analysis_and_object_tracking.html](http://docs.opencv.org/modules/video/doc/motion_analysis_and_object_tracking.html)

这是一个例子

```
import cv2

backsub = cv2.BackgroundSubtractorMOG()

capture = cv2.VideoCapture("Balcony4_Vis.mpg")

if capture:
    while True:
        ret, frame = capture.read()
        if ret:
            fgmask = backsub.apply(frame, None, 0.01)
            contours, hierarchy = cv2.findContours(fgmask.copy(), cv2.RETR_EXTERNAL,
                                               cv2.CHAIN_APPROX_NONE)
            try: hierarchy = hierarchy[0]
            except: hierarchy = []
            for contour, hier in zip(contours, hierarchy):
                (x,y,w,h) = cv2.boundingRect(contour)
                if w > 10 and h > 10:
                    # figure out id
                    best_id = 1
                    .....

                    cv2.rectangle(frame, (x,y), (x+w,y+h), (255, 0, 0), 2)
                    cv2.putText(frame, str(best_id), (x,y-5), cv2.FONT_HERSHEY_SIMPLEX,
                            0.5, (255, 0, 0), 2)
            cv2.imshow("Track", frame)

            key = cv2.waitKey(10)
            if key == ord('q'):
                break 
```

# java - SelectOneMenu 未正确显示

> ID：16100583
> 
> 赞同：0
> 
> 时间：2013-04-19T08:38:40.873
> 
> 标签：java, jsf, primefaces

对于以下问题，我将不胜感激：
我得到一个登录屏幕，然后是另一个页面，其中 a`Panel`和内部`Panel`是 a `SelectOneMenu`。不幸的是`SelectOneMenu`，登录后的输出有时是这样的：

![SelectOneMenu 错误](https://i.stack.imgur.com/IjtaK.jpg)

*相反，用户的全名（！）应该放在`SelectOneMenu`.*
*有时有效，有时无效。*
*另外，如果我现在切换`User`，我只会得到它的第一个字母。（在下拉列表中写了全名）*

`ManagedBean`我在它的( `@ViewScoped`) 中填充内容`PostConstruct`并从数据库中获取数据。（查看 -> ManagedBean -> DAO 类 -> ManagedBean）。我还尝试将代码放入`public Classname{}`其中，结果相同。

我认为`SelectOneMenu`未正确呈现存在问题。
如何解决？

用户.xhtml：

```
<p:selectOneMenu id="somSelect" value="#{userManagerBean.somValue}"
    styleClass="selecters">
    <p:ajax update="userDataTable" listener="#{userManagerBean.changeSomValue}" />
    <f:selectItems value="#{userManagerBean.userList}" />
</p:selectOneMenu> 
```

ManagedBean @ViewScoped：

```
 @PostConstruct
        public void init() {
    // DAO Method
            retrieveTableData();

            String loggedInUser = "";
            try{
            loggedInUser = FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("sprintUser").toString();
            }catch(Exception e){
                System.err.println("> No previous login");
            }

            // Check for session login name and select from table - if session null select first
            if (somValue == null && userList.size() != 0) {
                somValue = userList.get(0);             
                for(int i = 0; i < userList.size(); i++){                           
                    if(loggedInUser.equals(userList.get(i))){
                        somValue = loggedInUser;
                    }
                }       
            }               

            selectedUser = somValue();       
            userData = new ArrayList<User>();
// a Table population
            populateUser(userData);
        } 
```

# cmake - 在开发共享库期间使用 KDevelop

> ID：16100585
> 
> 赞同：2
> 
> 时间：2013-04-19T08:38:48.617
> 
> 标签：cmake, kdevelop

我正在尝试使用 KDevelop 作为开发 C++ 共享库的 IDE。此处较早的帖子表明我需要为此编辑 CMake 生成文件。这是非常痛苦且非常耗时的，因为这意味着将我们自定义的面向 gmake 的构建系统转换为 CMake 的东西。

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T14:24:24.963

KDevelop 不会像许多其他 IDE 那样强迫您使用特定的构建系统。CMake 只是默认设置，因为它集成得非常好，而且许多（如果不是全部）KDE 项目都使用 cmake。

您可以通过选择“Custom Buildsystem”或“Custom Makefile Project Manager”来使用不同的构建系统。

自定义 Makefile 项目管理器只需调用“make” - 您当前的构建系统应该可以这样工作。

# php - PHP Mysqli foreach 不提取数据

> ID：16100590
> 
> 赞同：-2
> 
> 时间：2013-04-19T08:39:16.403
> 
> 标签：php, foreach, mysqli

我在标签内有以下 PHP 站点`<script>`，我正试图让它从我的表中提取`map`数据`mysqli`

但是在console.log中显示如下`position: new google.maps.LatLng(, ),`

我不确定我的代码哪里出错了。我的数据库连接是实时的并且在变量内`$con`

**PHP**

```
 <?php 
  $count = 0;
  $rowset = $con->query("SELECT * FROM map");
  foreach ($rowset as $row): ?>
  add_marker({
        position: new google.maps.LatLng(<?php echo $row->lat ?>, <?php echo $row->lng ?>),
        title:<?php echo $row->location ?>,
        map:map
    });
  <?php 
  $count++;
  endforeach; ?> 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:42:47.993

您没有提取数据。将 foreach 行替换为：

```
while ($row = $rowset->fetch_object()): 
```

那应该这样做。

编辑：不要忘记替换`endforach;`为`endwhile;`

# sql-server - FluentMigrator 是否支持创建过滤索引？

> ID：16100591
> 
> 赞同：8
> 
> 时间：2013-04-19T08:39:24.743
> 
> 标签：sql-server, indexing, sql-server-2012, fluent-migrator

是否可以使用 FluentMigrator创建[过滤索引？](http://msdn.microsoft.com/en-us/library/cc280372.aspx)场景是我想在可能包含 NULL 的列上创建唯一索引，因此过滤器应该排除索引列的 NULL 行。

我在 SQL Server 2012 中修改了 FluentMigrator 生成的索引以使用这样的过滤器，并且可以确认它运行良好，所以剩下的难题是生成这个选项。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T19:01:19.897

由于这是一个非常特定于 Sql Server 的功能，您不妨回退到 sql。

流畅风格的原因之一是它不是特定于数据库的，因此可以为不同的数据库类型运行相同的迁移。但是，如果您只打算使用 Sql Server 并想使用数据库特定的功能，那么 FluentMigrator 的优点在于它允许您执行 sql 语句。对于 FluentMigrator 中我们永远不会支持的高级内容以及存储过程中的更改，建议使用此方法。

它只是：

```
Execute.Sql(@"CREATE NONCLUSTERED INDEX FIBillOfMaterialsWithEndDate
    ON Production.BillOfMaterials (ComponentID, StartDate)
    WHERE EndDate IS NOT NULL;"); 
```

Postgres 也有部分索引，所以这可能是我们将来会添加到 FluentMigrator 的东西。

# ruby-on-rails - 捆绑远程错误：找不到存储库

> ID：16100592
> 
> 赞同：0
> 
> 时间：2013-04-19T08:39:28.220
> 
> 标签：ruby-on-rails, git, github

我想部署 rails3 的示例项目。当我运行“捆绑安装”时，它告诉我远程错误：找不到存储库。我是 git、github 和 rails3 的新手。但我已经创建了一个 github 帐户和配置git和github很好。我不知道发生了什么。如果有任何帮助，我将非常感激！

这是控制台消息（ubuntu 12.04LST）：

magic@magic-ThinkPad-T430u:~/文档/rails/ticketee-book$ bundle

```
Fetching gem metadata from http://rubygems.org/.......
Fetching gem metadata from http://rubygems.org/..
Fetching git://github.com/radar/rack-test
fatal: remote error: Repository not found.
Git error: command `git clone 'git://github.com/radar/rack-test'
"/home/magic/.rvm/gems/ruby-1.9.3-p392@rails3.2/cache/bundler/git/rack-test-
8ce034d275474b0b137179c1bd5be3e5ee2e2464" 
--bare --no-hardlinks` in directory /home/magic/文档/rails/ticketee-book has failed. 
```

这是宝石文件：

```
source 'http://rubygems.org'

gem 'rails', :git => "git://github.com/rails/rails", :branch => "3-1-stable"
# gem 'arel',      :git => 'git://github.com/rails/arel.git'
gem 'rack'
gem 'sprockets', :git => "git://github.com/sstephenson/sprockets.git"

gem 'sqlite3'

gem 'sass', '~> 3.1.0.alpha'
gem 'coffee-script'

gem 'dynamic_form'

gem 'devise', :git => "git://github.com/plataformatec/devise.git"
gem 'cancan'

gem 'paperclip', :git => "git://github.com/thoughtbot/paperclip.git"

gem 'searcher'
gem 'kaminari'

gem 'jquery-rails'
gem "oa-oauth", :require => "omniauth/oauth"
gem "delayed_job"

# gem "forem", :git => "git://github.com/radar/forem"
gem "ticketee-forem", :require => "forem", :path => "../forem"

gem 'sinatra'

group :test, :development do
  gem 'gmail'
  gem 'rspec-rails', '~> 2.6.1.beta1'
end

group :test do
  gem 'rack-test', :git => "git://github.com/radar/rack-test"
  gem 'cucumber-rails', :git => "git://github.com/cucumber/cucumber-rails"
  gem 'capybara'
  gem 'database_cleaner'
  gem 'factory_girl'
  gem 'email_spec'
  gem 'launchy'
end

group :production do
  gem 'pg'
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:41:14.593

在您的`Gemfile`, 在`test`组中，您有以下行

```
gem 'rack-test', :git => "git://github.com/radar/rack-test" 
```

它将指示 bundler 克隆存储库并将其内容用作 gem。由于 Github 上不再存在存储库，因此`bundle`失败。

您应该编辑您的 Gemfile 并使用新的存储库位置或使用来自`rubygems.org`. 最后，您必须编辑 gemfile 以使用以下替代方法之一：

```
gem 'rack-test', :git => "https://github.com/brynary/rack-test.git"
# or
gem "rack-test" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:47:35.457

不，问题是存储库不再存在。尝试在新地址上下载存储库：

```
git clone git://github.com/brynary/rack-test.git 
```

现在克隆完成后，在终端执行：

```
cd rack-test 
```

现在您位于`very`创建时创建的目录中`git clone`，然后尝试运行命令：

```
bundle install --path vendor/bundle 
```

一切都应该工作

# javascript - 在 Ember.js 中创建和读取记录

> ID：16100593
> 
> 赞同：1
> 
> 时间：2013-04-19T08:39:31.200
> 
> 标签：javascript, ember.js, ember-data

我正在使用 Emeber.js 框架；我创建了一个像这样的对象：

```
myApp.user=Ember.Object.extend({
    name:null,
    state:false
}); 
```

我也以这种方式定义了一个 Ember 模型：

```
myApp.Wuser = DS.Model.extend({
      nome: DS.attr('string'),
      user: DS.attr('mycustomtype') // i want put here a mycustom type (user)
}); 
```

问题是：如何创建记录？我试着写这个：

```
myApp.Wuser.createRecord({nome:"aaa",user:myApp.user.create()}); 
```

但是发生了错误；你知道如何创建记录以及如何读取它吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T12:32:07.777

您在商店中创建记录。

```
record = this.get('store').createRecord(MyApp.User, {name: 'Luke'}) 
```

要将其持久化到您的服务器：

```
this.get('store').commit(); 
```

您也可以对交易执行此操作：

```
record = transaction.createRecord(MyApp.User, {name: 'Luke'}) 
```

# php - 在 id 相同的数组中添加值 php

> ID：16100599
> 
> 赞同：-1
> 
> 时间：2013-04-19T08:39:45.580
> 
> 标签：php, arrays

我有一个数组。在数组中有 2 个相同的 [id] 值。我希望能够添加这些元素的 [score] 并合并 [id] 相同的元素。这可能吗？

```
[0] =>  
        [id] => 9428 
        [auth] => manual 
        [firstname] => Tariq 
        [lastname] => Essop 
        [score] => 75.000000000 
        [timecreated] => 1366093740 
        [courseid] => 215 
        [itemname] => 2164 Date of assessment and dispute resolution 
        [itemid] => 750 ) 

[1] => 
        [id] => 9428 
        [auth] => manual 
        [firstname] => Tariq 
        [lastname] => Essop 
        [score] => 75.000000000 
        [timecreated] => 1366100428 
        [courseid] => 215 
        [itemname] => 2168 Cross-border loans and intellectual property 
        [itemid] => 751 )

[2] => 
        [id] => 6258 
        [auth] => manual 
        [firstname] => Tariq 
        [lastname] => Essop 
        [score] => 75.000000000 
        [timecreated] => 1366100428 
        [courseid] => 215 
        [itemname] => 2168 Cross-border loans and intellectual property 
        [itemid] => 752 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:43:22.457

```
$data = array();

foreach ($array as $item) {
    if (!isset($data[$item['id']])) {
        $data[$item['id']] = $item;
    } else {
        // do whatever you need to do to $data[$item['id']], e.g.:
        $data[$item['id']]['score'] += $item['score'];
    }
} 
```

# regex - 正则表达式错误，匹配数字

> ID：16100601
> 
> 赞同：0
> 
> 时间：2013-04-19T08:39:50.013
> 
> 标签：regex, match

我有一个字符串`00000001001300000708303939313833313932E2`

所以，我想匹配`708 & E2`..

所以我写道：

`(?<=708)(.*\n?)(?=E2)`- 在 RegExr 中测试（它正在工作）

现在，从该结果`303939313833313932`匹配中获取结果（每隔一个数字）：

```
099183192 
```

如何 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:45:43.297

要匹配 和 之间的所有内容`708`，`E2`请使用：

```
708(\d+) 
```

如果您确定只有数字。否则尝试：

```
708(.*?)E2 
```

要匹配 中的每个第二个数字`303939313833313932`，请使用：

```
(?:\d(\d))+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:47:44.037

使用全局替换：

```
find: \d(\d)
replace: $1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:48:24.320

您是否期待正则表达式对此的回答？

您最好使用您正在使用的任何编程语言中的字符串操作来执行此操作。如果你有`text = "abcdefghi..."`然后做`output = text[0] + text[2] + text[4]...`一个循环，直到你用完字符。

您没有指定编程语言，但在 Python 中我会执行以下操作：

```
>>> text = "abcdefghjiklmnop"
>>> for n, char in enumerate(text):
...   if n % 2 == 0: #every second char
...     print char
... 
a
c
e
g
j
k
m
o 
```

# python - Python-从文件中获取特定行并迭代

> ID：16100602
> 
> 赞同：-1
> 
> 时间：2013-04-19T08:39:50.947
> 
> 标签：python, file

我有一个像这样的文件：

```
Hi=1
How=2
Are=3
You=4
Thank=5 
You=6 
Will=7 
Be=8  
Better=9

Hi=10
How=11
Are=12
You=13
Thank=14 
You=15 
Will=16 
Be=17  
Better=18 
```

我想获取每个（例如）第 1、第 3、第 5 行并将其存储在列表中。我知道，使用`linecache`with `enumarate`with`itertools`等获取特定行很容易。但是正如你所看到的，我在文件中迭代的行数相同，所以在从第一节获得第 1、3、5 行之后，我必须从第 2 节获得第 1、3、5 行。

所以我想让 smt 类似于：

```
>>>print "This is 1st row %s" %var1
>>>print "This is 3rd row %s" %var2
>>>print "This is 5th row %s" %var3
This is 1st row Hi=1 Hi=10
This is 3rd row Are=3 Are=12
This is 5th row Thank=5 Thank=14 
```

提前谢谢你的帮助..

编辑：

关于评论，在真实文件中存在超过 60.000 节经文。每节经文都用`=`符号隔开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:02:34.830

像这样使用`defaultdict(list)`：

```
from collections import defaultdict
with open("abc") as f:
    dic=defaultdict(list)
    i=1
    for line in f:
          line=line.strip()
          if line:
             dic[i].append(line)
             i+=1
          else:
             i=1

for i in range(1,10,2):   #get the 1,3,5,7,9 line
   print "This is row {0}: {1}".format(i," ".join(dic[i]))

print

for i in [1,4,8]:        #get the 1,4,8 line
   print "This is row {0}: {1}".format(i," ".join(dic[i])) 
```

**输出：**

```
This is row 1: Hi=1 Hi=10
This is row 3: Are=3 Are=12
This is row 5: Thank=5 Thank=14
This is row 7: Will=7 Will=16
This is row 9: Better=9 Better=18

This is row 1: Hi=1 Hi=10
This is row 4: You=4 You=13
This is row 8: Be=8 Be=17 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T09:01:34.983

解释：`verses`是一个`list`包含文本中所有经文的。

`indexes`是一个`list`包含您要打印的所有行的。

最后，为了打印结果，一个简单的使用`zip`do the work：

```
 txt = """Hi=1
How=2
Are=3
You=4
Thank=5 
You=6 
Will=7 
Be=8  
Better=9

Hi=10
How=11
Are=12
You=13
Thank=14 
You=15 
Will=16 
Be=17  
Better=18"""

verses = [[]]
for line in txt.splitlines():
    if line != "":
        verses[len(verses)-1] += [line]
    else:
        verses += [[]]

indexes = [1, 3, 5]
for i, line in enumerate(zip(*verses)):
    if i+1 in indexes:
        print("This is {} row {}".format(i+1, " ".join(line))) 
```

输出：

```
This is 1 row Hi=1 Hi=10
This is 3 row Are=3 Are=12
This is 5 row Thank=5  Thank=14 
```

# unit-testing - 测试驱动开发——何时/测试什么？

> ID：16100606
> 
> 赞同：1
> 
> 时间：2013-04-19T08:40:18.550
> 
> 标签：unit-testing, testing, tdd

我正在尝试开始使用 TDD，但马上我不确定我应该何时以及应该测试什么。我正在处理的一个新项目中的前两个任务如下。

1) 在 REST 端点上接收一些 JSON 格式的数据并将其保存在数据库中。假设数据是几条汽车记录-

> {“汽车”：[{“制造”：“福特”，“颜色”：“蓝色”，“年份”：“2010”，“for_sale”：真}，{“制造”：“宝马”，“颜色” ：“黑色”、“年份”：“2011”、“for_sale”：假 } ] }

因此数据到达 REST 端点，我需要将其保存在数据库中。我是否需要对这项任务进行测试，如果需要，它应该是什么样子？

2) 从数据库中检索一些记录并将它们显示在视图/网页中（即使用一些模板系统）。假设记录是上面的汽车记录，它们应该显示如下 -

> ```
> <ul id="cars">
>     <li id="car-1">
>         <div><span>Make:</span><span>Ford</span>
>         </div>
>         <div><span>Color:</span><span>blue</span>
>         </div>
>         <div><span>Year:</span><span>2010</span>
>         </div>
>         <div><span>For sale:</span><span>Yes</span>
>         </div>
>     </li>
>     <li id="car-2">
>         <div><span>Make:</span><span>BMW</span>
>         </div>
>         <div><span>Color:</span><span>black</span>
>         </div>
>         <div><span>Year:</span><span>2011</span>
>         </div>
>         <div><span>For sale:</span><span>No</span>
>         </div>
>     </li>
> </ul> 
> ```

那么我是否需要对这项任务进行测试，如果需要，它应该是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T13:17:45.983

您使用什么语言、平台等？也许我们可以为您找到一些例子。

TDD 一开始很棘手，像这样的任务（使用数据库和 Web 部件）需要在多个级别上进行测试。

首先将任务划分为可以进行单元测试的单一职责（可能映射到类）。例如，一个接受 JSON 输入的类，并用其属性对对象进行水合，TDD 该类。数据库层很难进行单元测试，我们通常使用存储库模式，然后在测试其他类时模拟该模式。

数据库单元测试很难，因此请考虑围绕数据库进行“验收”或“集成”测试。这可能是一个连接到真实测试数据库的测试，放入一些测试数据，再次将其拉出，并验证它看起来是否正确。从理论上讲，您甚至都不关心它是什么数据库，只要您存储的内容再次出现，您就知道它正在工作。

HTML / web 测试最好使用[selenium webdriver](http://docs.seleniumhq.org/projects/webdriver/)等工具在高级别的地方完成，它允许您编写启动真实浏览器的测试代码，与您的页面交互，并断言内容/行为符合预期。

通过与已经知道它的人结对编程，或者通过参加课程或培训课程来学习这些东西真的很好。还有很多书籍博客和教程，让您在沙盒中学习，这比在实际项目中尝试自己学习更简单，完成工作的压力与学习相冲突。

* * *

编辑：Java 和 Play 框架。好的，我不知道具体的播放框架，但如果你设置正确，它可能会为你做 JSON 解析，这会将 json 解析函数简化为样板代码。TDD 在这里没有很大的价值，但如果你愿意，你可以。同样，有一个活动记录风格的数据库层？因此，在测试您的库提供的代码时没有太多价值（而 dbs 对单元测试来说是困难的/不可能的/毫无意义的*）。

* * *

编辑：编辑 - 这很糟糕，显然[Play 使用静态控制器方法，这使得单元测试变得困难（因为你不能注入依赖项 - 这使得模拟变得困难）](http://lostechies.com/jamesgregory/2011/09/18/observations-on-the-play-framework/)。恐怕如果不进行数小时的研究，我就无法提供具体细节，但集成测试可能是这里的方法，它可以一起测试你的几个代码单元，包括数据库。

总而言之：

*   不要在样板上出汗 TDD。保持样板隔离和事物（即控制器只做网络的东西，然后移交给其他类。存储库只保存和检索对象，而不是规则/决策/操作。
*   当您开始向应用程序的内部添加更多业务逻辑时 - 将其隔离在业务类中（即 - 远离 web 或 db 样板），您可以轻松地进行单元测试。绝对是TDD这个东西。
*   尝试在您的应用程序中进行集成测试以测试数据库。在您的应用程序后面有一个真正的测试数据库，使用该应用程序保存、检索它，然后断言它是正确的。
*   使用 Selenium 之类的东西来测试网页。

*根据您的测试信念删除。

# paypal - Paypal在哪里设置接受沙盒中的数字商品付款

> ID：16100610
> 
> 赞同：2
> 
> 时间：2013-04-19T08:40:47.813
> 
> 标签：paypal, paypal-sandbox

这几天我一直在尝试这个。我已经创建了一些卖家账户，其中一个是我今年年初创建的，并且运行良好。然后当我今年 3 月返回这个项目时，Paypal 将 API 从 x.com 更改为 developer.paypal.com。旧的卖家账户仍然可以正常工作，并且仍然可以接受我最近创建的付款人账户的数字商品付款，但是具有 BUSINESS 类型的新卖家账户应该能够支付和接受付款有一些问题。这些新创建的卖家账户会收到以下警告：

> 您尚未注册接受数字交付商品的付款。﻿</p>

用谷歌做一些研究，我发布了我必须为数字商品设置贝宝商业账户。但我无法从新的贝宝开发者控制面板中找到设置它的位置。即使我尝试登录沙盒版的paypal.com，使用我在沙盒中创建的卖家账户，我仍然找不到可以设置的地方。在我的业务设置中，我只有两种选择，一种是 Paypal 支付专业版，另一种是“虚拟终端”。任何想法？请帮忙....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:52:52.843

我已经找到了在沙盒中为数字商品添加快速结账的方法，但我认为 Paypal 应该注意这一点，因为我使用的方式非常笨拙。

首先登录沙箱，然后使用应用程序/沙箱帐户中提供的 url 选择一个业务帐户登录沙箱。然后用你要设置的接受数字商品结账的账号登录沙盒url，应该是www.sandbox.paypal.com/us/home

登录后，进入我的业务设置，注意设置我的支付解决方案。单击查看所有产品，您将被重定向到新页面。现在请注意 url，“沙箱”丢失了。现在单击快速结帐按钮，或者您要添加到支付解决方案的任何内容，您将再次被重定向。现在注意url，在url中插入“sandbox”，例如www.paypal.com你必须用www.sandbox.paypal.com替换它，url的其余部分保持不变。然后按回车键，您将被重定向回业务设置页面。现在您可以看到您的付款解决方案已成为快速结帐。这很愚蠢，我希望贝宝可以让我们在不久的将来直接从控制面板中选择这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T19:57:02.400

另一种隐藏在个人资料 > 我的销售工具 > API 访问 > 更新 > 在底部 - 启用快速结帐。

当我稍后转到我的帐户 > 我的业务设置时，我看到：“您的付款解决方案：PayPal 数字商品（快速结帐）”

# iphone - 如何避免从照片库中选择或从 iOS 中的相机捕获的图像的背景？

> ID：16100615
> 
> 赞同：4
> 
> 时间：2013-04-19T08:41:08.690
> 
> 标签：iphone, ios, objective-c, xcode, crop

![在此处输入图像描述](https://i.stack.imgur.com/jq6Bb.jpg)

我只需要获取没有背景的选定图像，我们试图避免背景，我们需要只裁剪选定的部分。以及如何在点击选择图像颜色时更改像素数据。

或者我们可以这样做：

收割前：

![在此处输入图像描述](https://i.stack.imgur.com/rbSbl.png)

裁剪后：

![在此处输入图像描述](https://i.stack.imgur.com/iycHd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T12:09:55.150

一旦有了路径，您就可以允许用户在使用 bezierpath 选择后在图像上绘制 - 您可以为此使用 shapeLayer。就像是：

```
CAShapeLayer *shapeLayer = [CAShapeLayer layer]; 

shapeLayer.path = aPath.CGPath;

[view.layer setMask:shapeLayer];//or make it as

[imageview.layer setMask:shapreLayer]; 

// and add imageView as subview  of whichever view you want. 
// draw the original image on the imageview in that case 
```

要将其作为图像，

```
UIGraphicsBeginImageContext(view.bounds.size);
[view.layerrenderInContext:UIGraphicsGetCurrentContext()]; 

UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext(); 
```

# z3 - 在 z3 中定义 Set

> ID：16100616
> 
> 赞同：0
> 
> 时间：2013-04-19T08:41:10.480
> 
> 标签：z3

要在 Z3 中创建一组 3 个元素 (1,2,3)，我使用以下代码：

```
(define-sort Set () ( Array Int Bool ) )
(declare-const s Set ) 
( assert  ( and ( = ( select s 1 ) true )  ( = ( select s 2 ) true ) 
           ( = ( select s 3 ) true )  ) ) 
```

我得到的模型如下：

```
(model 
  (define-fun s () (Array Int Bool)
    (_ as-array k!0))
  (define-fun k!0 ((x!1 Int)) Bool
    (ite (= x!1 2) true
    (ite (= x!1 3) true
    (ite (= x!1 1) true
      true))))
) 
```

但相反，我怎样才能获得表格的模型：

```
(model    (define-fun s () (Array Int Bool)
    (_ as-array k!0))   (define-fun k!0 ((x!1 Int)) Bool
    (ite (= x!1 2) true
    (ite (= x!1 3) true
    (ite (= x!1 1) true
      false)))) ) 
```

以便集合成员以外的元素不包含在集合中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:56:55.243

您可以通过从空集开始来实现这一点，即定义为`false`无处不在的数组。

这是[一个例子](http://rise4fun.com/Z3/slri)：

```
(declare-const s1 (Array Int Bool))

(assert (= s1
  (store
    (store
      (store 
        ((as const (Array Int Bool)) false)
        1 true)
      2 true)
    3 true)
))

(check-sat)
(get-model) 
```

# php - Doctrine2 - 列在刷新之前变为空

> ID：16100623
> 
> 赞同：3
> 
> 时间：2013-04-19T08:41:35.130
> 
> 标签：php, symfony, orm, doctrine-orm

我正在尝试在数据库中插入一个新对象/行。对象是这样创建的：

```
$nodeaccess = new Nodeaccess(); // A by doctrine2 generated entity
$nodeaccess->setAccesslevel(0);
$nodeaccess->setDraw(0);
$nodeaccess->setUserid($userid);
$nodeaccess->setNodename($this->getUser()->getUsername() . ' Node');
$nodeaccess->setMac($node); 
```

表的所​​有列都已设置。当我打印`$nodeaccess->getUserid()`并打印`$nodeaccess->getMac()`所需的结果时。而且它们都不**是 null**。

但是当对象像这样持久化时：

```
$em = $this->getDoctrine()->getManager();
$em->persist($nodeaccess);
$em->flush(); 
```

发生以下错误：

> 执行 'INSERT INTO nodeaccess (mac, userID, accessLevel, nodeName, draw) VALUES (?, ?, ?, ?, ?)' 时发生异常，参数为 {"1":null,"2":null,"3 ":0,"4":"示例节点","5":0}:
> 
> SQLSTATE [23000]：违反完整性约束：1048 列“mac”不能为**空**

mac 和 userID 组合是主键，它们也是外键。它们在模型中设置如下：

```
/**
 * @var integer
 *
 * @ORM\Column(name="mac", type="bigint", nullable=false)
 * @ORM\Id
 */
private $mac;

/**
 * @var integer
 *
 * @ORM\Column(name="userID", type="integer", nullable=false)
 * @ORM\Id
 **/
private $userid; 
```

公共访问器已实现，我尝试将字段更改为公共，但没有帮助。

**更新** 访问器：

```
public function getMac()
{
    return $this->mac;
}

public function setMac($mac)
{
    $this->mac = $mac;
}

public function getUserid()
{
    return $this->userid;
}

public function setUserid($userid)
{
    $this->userid = $userid;
} 
```

**更新 2** 我已更改表，现在只有`mac`字段为 NULL。新型号：

```
/**
 * @var integer
 *
 * @ORM\Column(name="id", type="integer", nullable=false)
 * @ORM\Id
 * @ORM\GeneratedValue(strategy="IDENTITY")
 */
private $id;

/**
 * @var integer
 *
 * @ORM\Column(name="mac", type="bigint", nullable=false)
 */
private $mac;

/**
 * @var integer
 *
 * @ORM\Column(name="userID", type="integer", nullable=false)
 **/
private $userid; 
```

**更新**控制器动作：

```
public function inviteAction() {
    $repository = $this->getDoctrine()
            ->getRepository('GeninnoEDSBundle:Nodeaccess');
    $options = $repository->createQueryBuilder('na')
            .......
            ->getQuery()
            ->getResult();

    $form = $this->createFormBuilder()
            ->add('user', 'text', array(
                'attr' => array(
                    'placeholder' => '+ Gebruiker'
                )
            ))
            ->add('node', 'hidden')
            ->getForm();

    if ($this->getRequest()->isMethod('POST')) {
        $form->bind($this->getRequest());

        if ($form->isValid()) {
            $data = $form->getData();

            $user_repository = $this->getDoctrine()
                    ->getRepository('GeninnoEDSBundle:User');
            $user = $user_repository->findOneBy(array('username' => $data['user']));

            $node_repository = $this->getDoctrine()
                    ->getRepository('GeninnoEDSBundle:Node');
            $node = $node_repository->find($data['node']);

            $nodeaccess = new Nodeaccess();
            $nodeaccess->setAccesslevel(0);
            $nodeaccess->setDraw(0);
            $nodeaccess->setUserid($user);
            $nodeaccess->setNodename($this->getUser()->getUsername() . ' Node');
            $nodeaccess->setMac($node);

            $em = $this->getDoctrine()->getManager();
            $em->persist($nodeaccess);
            $em->flush();
        }
    }

    return array('options' => $options, 'form' => $form->createView());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T06:52:46.117

该问题已通过重新生成此特定实体（哦哦）得到解决。字段已更改为：

```
/**
 * @var \User
 *
 * @ORM\ManyToOne(targetEntity="User")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="userID", referencedColumnName="id")
 * })
 */
private $userid;

/**
 * @var \Node
 *
 * @ORM\ManyToOne(targetEntity="Node")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="mac", referencedColumnName="mac")
 * })
 */
private $mac; 
```

**更新**

那可能不是我认为的解决方法。将一些字段添加回类后再次出现问题。我发现通过删除以下代码，用户在持久化时不再被分配给 null。

```
/**
 * @var \Doctrine\Common\Collections\Collection
 *
 * @ORM\ManyToOne(targetEntity="User", inversedBy="accessNodes")
 * @ORM\JoinColumn(name="userID", referencedColumnName="id")
 **/
private $accessUsers; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:24:53.077

简短回答：节点的隐藏表单字段使用 __toString() 值，该值不是 id，因此不会被存储库调用找到，因此在持久时为空。

长答案：使用变压器：

在您的控制器中：

```
use GeninnoEDSBundle\Transformer\NodeTransformer; 
```

并修改表单生成器：

```
$transformer = new NodeTransformer( $em );
$form = $this->createFormBuilder()
        ->add('user', 'text', array(
            'attr' => array(
                'placeholder' => '+ Gebruiker'
            )
        ))
        ->add($builder->create( 'node', 'hidden')
            ->addModelTransformer( $transformer )
        )
        ->getForm(); 
```

您的变压器（新文件：GeninnoEDSBundle\Transformer\NodeTransformer.php）：

```
<?php

namespace GeninnoEDSBundle\Transformer;

use Doctrine\Common\Persistence\ObjectManager;
use GeninnoEDSBundle\Entity\Node;
use Symfony\Component\Form\DataTransformerInterface;
use Symfony\Component\Form\Exception\TransformationFailedException;

class NodeTransformer implements DataTransformerInterface
{
    /**
    * @var ObjectManager
    */
    private $em;

    //  If selector is multiple (Many2One or Many2Many)

    private $multi;

    /**
    * @param ObjectManager $em
    */
    public function __construct(ObjectManager $em, $multi=false)
    {
        $this->em = $em;
        $this->multi=$multi;
    }

    /**
    * Transforms an object (node) to a string (id).
    *
    * @param  Issue|null $node
    * @return string
    */
    public function transform($node)
    {
        if (null === $node) {return "";}
        if (is_object($node) && method_exists($node, "toArray")){
            $node=$node->map(function ($ob){return $ob->getId();});
            return implode(",",$node->toArray());
        }

        if ('array' == gettype($node)) {
            return implode(','
                          , array_map(function($element){
                                          return $element->getId();
                                      }
                                      ,$node));
        }
// var_dump($node);
        return $node->getId();
    }

    /**
    * Transforms a string (id) to an object (node).
    *
    * @param  string $id
    * @return Issue|null
    * @throws TransformationFailedException if object (node) is not found.
    */
    public function reverseTransform($id)
    {

        if (!$id) {
            if($this->multi) {return array();}
            return null;
        }

        if (strpos($id,',') !== false) {
            $id=explode(',',$id);
        }

        $qb=$this->em
        ->getRepository('GeninnoEDSBundle:Node')
        ->createQueryBuilder('r');
        $qb->andWhere($qb->expr()->in('r.id', $id));
        if (is_array($id) || $this->multi){
            $node=$qb->getQuery()
            ->getResult();
        } else {
            $node=$qb->getQuery()
            ->getSingleResult();
        }

        if (null === $node) {
            throw new TransformationFailedException(sprintf(
                'An node with id "%s" does not exist!',
                $id
                ));
        }

        return $node;
    }
} 
```

请注意：我已经添加了我的转换器，但您可能需要修改应用程序的逻辑。

有关变压器的更多信息：http: [//symfony.com/doc/current/cookbook/form/data_transformers.html](http://symfony.com/doc/current/cookbook/form/data_transformers.html)

# css - 使用 --sourcemap 标志运行 Compass

> ID：16100626
> 
> 赞同：11
> 
> 时间：2013-04-19T08:41:52.247
> 
> 标签：css, sass, compass-sass

Compass 是否支持 Sass 中的 --sourcemap 选项？我想通过 Compass 运行 Sass。我有

```
sass_options = {:sourcemap => true} 
```

在我的 config.rb 中，但是当我`compass watch`在我的项目文件夹中运行时，没有生成源映射文件。另一方面，当我跑步时

```
sass --compass --sourcemap --watch scss:css 
```

生成源文件，但忽略 config.rb。

（对于任何想知道 sourcemap 是什么的人，它是一个文件，当您检查元素时，它允许开发人员工具检查器指向 Sass scss 文件中样式的来源。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-29T13:17:59.540

@cimmanon 提供的解决方案对我不起作用。对我有用的是以下内容（感谢 Serge-Z 在[https://github.com/Compass/compass/issues/1108](https://github.com/Compass/compass/issues/1108)）：

```
sudo gem install compass-sourcemaps --pre 
```

然后你就像`compass watch`往常一样`sass_options = {:sourcemap => true}`在你的 config.rb 中做。

如果您在 OS X El Capitan 上并且由于无根模式而无法安装（感谢 Thomzzzzz 在[https://github.com/Compass/compass/issues/2018](https://github.com/Compass/compass/issues/2018)中）：

```
sudo gem install -n /usr/local/bin compass-sourcemaps --pre 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-19T14:39:58.703

从 Sass 3.3 或更高版本开始包含源映射，它仅与 Compass 1.0 兼容。

[https://github.com/chriseppstein/compass/issues/1108](https://github.com/chriseppstein/compass/issues/1108)

将以下内容添加到您的 config.rb 只会将 sourcemap 信息直接添加到您编译的 CSS 中：

```
sass_options = { :debug_info => true } 
```

输出：

```
@media -sass-debug-info{filename{font-family:file\:\/\/\/home\/chris\/compass\/sass\/test\.scss}line{font-family:\0000314}}
.foo {
  color: red;
} 
```

要获取源映射文件，您需要将此选项添加到 config.rb：

```
sourcemap = true 
```

控制台输出：

> ```
> $ compass watch
>  modified config.rb
>     clean css
>    delete css/test.css
> >>> Compass is watching for changes. Press Ctrl-C to Stop.
>     write css/test.css
>     write css/test.css.map 
> ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-23T23:29:11.180

对我来说，它适用于

```
sourcemap = true 
```

在 config.rb 中（解决方案取自[https://chillco.com/blog/setting-sass-and-compass-source-maps](https://chillco.com/blog/setting-sass-and-compass-source-maps)）

我通过考拉使用指南针（[http://koala-app.com/](http://koala-app.com/)）

# events - 为什么 DataReceived 在 Mono 上不起作用？

> ID：16100636
> 
> 赞同：0
> 
> 时间：2013-04-19T08:42:41.863
> 
> 标签：events, mono, serial-port

我想知道为什么 DataRecevied（或 ReadChar()）没有在 Mono 中实现。我在 3.x 测试版的注释上找不到任何内容，而且这两个都是旧的已知问题（[第一个问题甚至在 Mono 文档中提到](http://www.mono-project.com/HowToSystemIOPorts)）并且似乎很容易修复。
甚至还有诸如此类的“变通方法” [，](http://antanas.veiverys.com/enabling-serialport-datareceived-event-in-mono/)感觉集成起来并不难。

它站这么久有什么充分的理由吗？真的没人关心吗？Mono 不是*真的*在积极开发中吗？3.x beta 将指向其他...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T13:00:21.120

Mono 正在积极开发中。Xamarin 是其背后的主要公司（与其他公司相比，贡献的数量）。

当然，这意味着移动产品使用的错误/功能比其他东西更快地获得优先级。您是否有一家公司大量使用 System.IO.Ports 命名空间？那就考虑为它做贡献吧，它最近没有得到太多的爱。

PS：你甚至不需要编写代码就可以开始贡献。例如，您可以做的第一件事是审查其他人的贡献，例如[这个](https://github.com/mono/mono/pull/616)。

# apache2 - 多次刷新浏览器导致服务器挂起

> ID：16100639
> 
> 赞同：0
> 
> 时间：2013-04-19T08:42:47.497
> 
> 标签：apache2, settings, virtualhost

我在 apache2 和 debian 上运行具有 700mb 内存的虚拟服务器。我注意到多次按 ctrl+f5 (10 - 15) 后会导致服务器挂起。日志中没有信息。通过使用 htop 命令简单地观察内存行为，我可以看到内存达到顶部并且交换开始上升。网站再次响应大约需要 3-4 分钟。我的 apache2.conf 设置：

```
<IfModule mpm_prefork_module>
StartServers          3
MinSpareServers       6
MaxSpareServers      6
MaxClients           15
ServerLimit      15
MaxRequestsPerChild 500 
</IfModule> 
```

我应该调整哪些设置来防止这种挂起？这是否意味着，如果有 10 位或更多访问者访问我的网站，该网站将变得无响应？我的目标是一次能够为至少 20 个用户提供页面。谢谢你。

# api - 如果我在雅虎地图中有纬度和经度，如何获取位置名称

> ID：16100643
> 
> 赞同：1
> 
> 时间：2013-04-19T08:42:55.537
> 
> 标签：api, maps, yahoo

我正在设计一个将使用谷歌地图和雅虎地图的网络应用程序。但我正在搜索 yahoo api 来获取使用 lat 和 long 的位置地址。Google Api 无法正常工作。它们有非常密切的限制。请帮我..！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:37:46.430

如果您还没有尝试过，您应该使用 Google Geocoding API 的“反向地理编码（地址查找）”功能。

此处的详细信息：[https ://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)

如果您尝试过但不满意，您应该查看 Yahoo 的 Place Finder API。这让您可以通过传递纬度/经度坐标来搜索地址。请参阅以下链接：

概述： http: [//developer.yahoo.com/boss/geo/docs/requests-pf.html](http://developer.yahoo.com/boss/geo/docs/requests-pf.html) 通过纬度/经度：http: [//developer.yahoo.com/boss/geo/docs/address-formats.html#经纬度](http://developer.yahoo.com/boss/geo/docs/address-formats.html#latitude-longitude)

# configuration - 自定义 Neo4j GraphViz 编写器

> ID：16100648
> 
> 赞同：1
> 
> 时间：2013-04-19T08:43:04.527
> 
> 标签：configuration, neo4j, graphviz, dot

我有一个应用程序，它为我的 Neo4j 数据库的子图生成一个 GraphViz 点文件。它就像一个魅力，但有一些问题。

现在，每个节点的标题是节点 ID。然后列出属性及其各自的类型。这比我需要的信息更多，我想更改 GraphViz 编写器的配置方式。

我注意到几个类/接口，例如 GraphStyle、StyleParameter、StyleConfiguration，但我已经尝试了几件事，并且一直遇到无法访问它们各自包之外的某些类/接口的问题。也许我做错了，也许它的设计使用户无法重新配置 GraphViz 编写器，我不知道，但我想知道。

如何重新配置​​ GraphViz 编写器，以便点文件仅包含我希望它包含的信息，即我选择作为标题的属性，就节点而言没有其他内容。此外，这并不总是相同的属性，因此对于某些节点，我希望属性 A 作为标题，而对于没有属性 A 的节点，我希望属性 B 作为标题。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:05:43.610

您可以尝试使用此类提供的样式：[https ://github.com/neo4j/neo4j/blob/master/community/graphviz/src/main/java/org/neo4j/visualization/graphviz/AsciiDocSimpleStyle.java](https://github.com/neo4j/neo4j/blob/master/community/graphviz/src/main/java/org/neo4j/visualization/graphviz/AsciiDocSimpleStyle.java)

查看此类也可能很有用：[https ://github.com/neo4j/neo4j/blob/master/community/graphviz/src/main/java/org/neo4j/visualization/asciidoc/AsciidocHelper.java](https://github.com/neo4j/neo4j/blob/master/community/graphviz/src/main/java/org/neo4j/visualization/asciidoc/AsciidocHelper.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T11:10:55.050

我设法让它工作。首先，您需要创建两个新类：

```
class NodeStyleImpl implements NodeStyle
class RelationshipStyleImpl implements RelationshipStyle 
```

在这里，您可以定义节点和关系应如何以点表示法编写。示例实现如下所示：

```
public class NodeStyleImpl implements NodeStyle {

    public void emitNodeStart(Appendable apndbl, Node node) throws IOException {
        apndbl.append("  N" + node.getId() + " [\n    label = \"");
    }

    public void emitEnd(Appendable apndbl) throws IOException {
        apndbl.append("\"\n]\n");
    }

    public void emitProperty(Appendable apndbl, String propkey, Object propvalue) throws IOException {
        if(propkey.equals("propkeyone") || propkey.equals("propkeytwo"){
            apndbl.append(propvalue.toString());
        }
    }
} 
```

以模拟方式，您可以编写RelationshipStyleImpl。如果您正在寻找更高级的配置，您还可以编写一个 StyleConfiguration 实现。您可以查看 Neo4j 代码中的默认实现作为示例。

然后是 GraphStyle 类的问题。GraphStyle 类有一个受保护的构造函数，因此只能从包内访问。我提出了一个将其更改为公开的请求请求，但目前，这里有一个小“黑客”，它提供了一种解决方法。

```
package org.neo4j.visualization.graphviz

public class GraphStyleImpl extends GraphStyle {

    private GraphStyleImpl (NodeStyleImpl nstyle, RelationshipStyleImpl rstyle) {
        super(nstyle, rstyle);
    }
} 
```

注意包声明。因为 GraphStyle 构造函数是受保护的，所以 super(nstyle, rstyle) 方法只能从同一个包中访问。通过使用新的公共构造函数扩展类，您现在可以执行以下操作：

```
GraphStyle graphstyle = new GraphStyleImpl(new NodeStyleImpl(), new RelationshipStyleImpl());
GraphvizWriter writer = new GraphvizWriter(graphstyle); 
```

如果我的拉取请求被接受，则不再需要使用 GraphStyleImpl 类。

# c++ - 在 Visual Studio 2012 中对 exe 中的 C++ 代码进行单元测试时阻力最小的路径

> ID：16100650
> 
> 赞同：10
> 
> 时间：2013-04-19T08:43:13.497
> 
> 标签：c++, unit-testing, visual-studio-2012

我在这里需要一些明智的建议。长话短说，我正在重建一个——对我来说——由大约 7000 行代码组成的相对复杂的应用程序。我在创建应用程序的第一次迭代时遇到了许多问题，在我看来，测试驱动开发可能只是问题所在。

我很高兴看到 Visual Studio 2012 现在原生支持 C++ 中的 TDD，所以我继续阅读尽可能多的内容。不幸的是，Vs2012 相当新，我觉得文档有些缺乏。但这有点离题了。我主要依赖 MSDN 网站上的以下指南：

[http://msdn.microsoft.com/en-us/library/hh419385.aspx#objectRef](http://msdn.microsoft.com/en-us/library/hh419385.aspx#objectRef)

它相当清楚地指出，如果要将测试中的代码构建为 .exe，那么前进的方法是创建一个单独的测试项目并链接输出目标文件。我猜他们的意思是目标文件？或者可能不是？

老实说，我对需要链接多少个 .obj 感到有些困惑。起初我以为我需要链接每一个相当乏味的 obj 文件。

如果有人有这样做的经验并且也许还可以推荐使用哪些宏或类似的快捷方式以使此过程尽可能轻松，我将非常感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T09:14:35.463

这将取决于您如何构建解决方案。我喜欢构建我的解决方案的方式是拥有三个项目。

*   一个 .lib 项目，其中包含我的源代码。
*   一个可执行项目，与 .lib 链接。`main()`这会在调用中调用.lib
*   与 .lib 链接的测试项目 (exe)。

使用此结构，您可以使用该部分`Add New Reference...`中的按钮，`Common Properties`并且将为您对参考进行排序（除了在 中找到的标题包含路径`C++\General\Additional include directories`）。

如果您不想重组您的项目，您可以告诉链接器每个 obj 文件 ( `Linker\Input\Additional dependencies`)。如果您有很多要测试的类，这可能是大量的 .obj 文件。不幸的是，如果您使用预编译的头文件，您可能会遇到问题。

如果可以的话，我建议重组项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T22:46:40.347

当您使用项目依赖项时，有一个不错的选项，可让您在链接输出文件或让 IDE 自动选择来自其他项目的所有目标文件作为依赖项之间进行选择。

![在此处输入图像描述](https://i.stack.imgur.com/jcY73.png)

（不要担心屏幕截图中的 .NET 内容，这是取自 C++/CLI DLL 包含本机静态库项目的项目。只需对包含本机 DLL 或 EXE 项目的本机测试项目执行相同操作即可，选择与输入链接。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-18T03:08:07.433

## 本机应用程序 (.exe) 项目的单元测试项目

*   **将单元测试项目添加到解决方案**
    右键单击解决方案，*添加，新建项目*。在*Visual C++*下，选择*Native Unit Test Project*。
*   **添加应用程序作为对单元测试项目的引用**
    右键单击​​单元测试项目、*属性、通用属性、引用：*添加 .DLL 项目作为引用。这告诉 MSVC 如果应用程序自上次单元测试构建后发生更改，则在重新构建单元测试项目之前重新构建应用程序。
*   **告诉 MSVC 在哪里可以找到应用程序的库和对象文件**
    右键单击​​单元测试项目、*属性、链接器、常规：*编辑*附加库目录*并将路径添加到应用程序对象和库文件。
*   **收集所有 .obj 和 .lib 名称**
    从应用程序的对象和库文件所在的一个或多个子目录运行此批处理文件，如果有多个目录，则连接 .txt 文件。为方便起见，您可能希望将 .txt 文件添加到您的项目中。

    `: *** CollectObjLibFilenames.bat ***`
    `dir /B *.obj > ObjLibFilenames.txt`
    `dir /B *.lib >> ObjLibFilenames.txt`

*   **告诉 MSVC 将应用程序对象文件链接到单元测试应用程序**
    右键单击单元测试项目、*属性、链接器、输入：*编辑*附加依赖*项并添加应用程序对象文件名和库（.obj 和 .lib）文件名（复制和过去ObjLibFileNames.txt 中的文件）。
    **如果您的应用程序项目使用预编译的头文件，请不要忘记包含预编译的头文件对象文件，**通常是 *stdafx.obj，*如果省略它，您将收到**LNK2011**错误。

    > [微软说](https://msdn.microsoft.com/en-us/library/3ay26wa2%28v=vs.140%29.aspx) *“如果你使用预编译头文件，LINK 要求所有使用预编译头文件创建的目标文件都必须链接进去。”*
    > 
    > 我认为如果我添加包含我的应用程序入口点的目标文件会发生名称冲突`main(int argc, char *argv)`，但是我的单元测试项目在有或没有 main.obj 的情况下成功链接。我没有尝试将文件与其他入口点风格（WinMain、wWinMain、wmain）链接。如果您与其中之一发生名称冲突，您可以更改入口点的名称（这会很奇怪）：*属性、链接器、高级*，编辑Entry point，并相应重命名Application的入口点函数。我刚刚查看的单元测试项目中没有指定该选项，我认为这意味着默认值，几乎可以肯定是`main(int argc, char *argv)`.
    > 
    > 我的 main.cpp 文件只有一个函数（main）并且没有全局变量，即应用程序的其他部分没有引用 main.cpp 中的任何内容。如果链接文件没有引用任何对象文件，我假设您可以省略任何对象文件。不值得努力找出哪些满足小型应用程序的要求。对于大型应用程序......祝你好运；最终你还是要测试所有的执行路径。
    > 
    > 您可能会有一个预编译的头对象文件*stdafx.obj*单元测试项目中的文件以及应用程序项目中的文件。这不是问题，因为预编译头文件的默认目标文件名是 $(TargetName).pch，其中 $(TargetName) 解析项目名称。即，pch 目标文件将具有不同的名称。
    > 
    > 建议：与其将我的应用程序的stdafx.h文件的内容复制到相应的单元测试文件中，不如将应用程序的stdafx.h包含在单元测试项目的stdafx.h文件中，这样你就不必更新单元测试的版本了应用程序的文件更改。`#include <stdafx.h>`可以，但是我使用两个项目之间的相对路径（如果它们的相对路径稳定），或者如果更稳定，则使用应用程序源文件的完整路径名，以确保找到正确的文件。[关于如何解释 #include"header.h" 和#include](https://stackoverflow.com/questions/7404178/difference-between-include-hpp-and-include-hpp/26371957#26371957)的令人不安的解释。剧透：这是 C++ 的另一个实现特定功能。
    > ___________________________________________________________________顺便说
    > 
    > 一句，预编译的头文件是在*每个源文件*(.cpp) 的基础上指定的。一个*单独的 .cpp 文件只能使用一个预编译头文件，但您可以**在同一个项目*中拥有多个预编译头文件。看到[这个：](https://stackoverflow.com/questions/290034/is-there-a-way-to-use-pre-compiled-headers-in-vc-without-requiring-stdafx-h/35518943#35518943)

# python - 将 django 电子邮件保存到 eml

> ID：16100651
> 
> 赞同：1
> 
> 时间：2013-04-19T08:43:20.480
> 
> 标签：python, django, file, email

我在 django 中生成了一堆 html 电子邮件，我想将它们保存到一个模型中，在一个 FileField 中。我可以很容易地生成 html 内容并转储到`File`.，但我想创建可以在电子邮件客户端中打开的内容，例如 eml 文件。有谁知道 python 或 django 模块可以做到这一点？为了清楚起见，我不是在寻找替代电子邮件后端，因为我还希望在生成电子邮件时发送它们。

**编辑：**经过一番阅读，在我看来`EmailMessage.messge()`应该返回应该存储在 eml 文件中的内容。但是，如果我尝试像这样保存它，生成的文件是空的：

```
import tempfile
name = tempfile.mkstemp()[1]
fh = open(name, 'wb')
fh.write(bytes(msg.message()))
fh.close()
output = File(open(name, 'rb'), msg.subject[:50]) 
```

我想使用 a`BytesIO`而不是临时文件，但临时文件更容易测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T11:24:04.760

EML 文件实际上是一个具有名称值对的文本文件。一个有效的 EML 文件就像

```
From: test@example.com
To: test@example.com
Subject: Test

Hello world! 
```

如果您遵循上述模式并将其保存在扩展名为 .eml 的文件中，则类似 Thunderbird 的电子邮件客户端将毫无问题地解析并显示它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-20T07:45:54.670

我有类似的问题。我在 Django 网站上找到了[票。](https://code.djangoproject.com/ticket/15793#no1)最后的[评论](https://code.djangoproject.com/ticket/15793#comment:11)建议使用[django-eml-email-backend](https://github.com/kmike/django-eml-email-backend)。它对我有帮助，而且非常有用且简单。

[示例](https://github.com/kmike/django-eml-email-backend/blob/master/README.rst)：

安装：

```
$ pip install django-eml-email-backend 
```

使用：

```
EMAIL_BACKEND = 'eml_email_backend.EmailBackend'
EMAIL_FILE_PATH = 'path/to/output/folder/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-20T19:51:14.527

Django`EmailMessage.message().as_bytes()`将返回 .eml 文件的内容。然后，您只需要将文件保存到您选择的目录中：

```
from django.core.mail import EmailMessage

msg = EmailMessage(
    'Hello',
    'Body goes here',
    'from@example.com',
    ['to3@example.com'],
)
eml_content = msg.message().as_bytes()
file_name = "/path/to/eml_output.eml"
with open(file_name, "wb") as outfile:
    outfile.write(eml_content) 
```

# jquery - 如果不是点击目标，隐藏

> ID：16100654
> 
> 赞同：0
> 
> 时间：2013-04-19T08:43:23.730
> 
> 标签：jquery, click, target

这个问题已经被问了三次，但我似乎无法让它发挥作用。这是一个[小提琴](http://jsfiddle.net/BramVanroy/V9zg6/)。您可以通过单击链接来切换登录表单。如果您想隐藏它，您可以再次单击该链接，或在表单本身之外单击。

```
$j = jQuery.noConflict();

$j("a#login-link").click(function (e) {
    $j("div#custom-login").slideToggle("fast");
    e.preventDefault();
    e.stopImmediatePropagation();
});

$j(document).click(function (e) {
    if ($j("div#custom-login").is(":visible") && !$j("div#custom-login, div#custom-login *").is(e.target)) {
        $j("div#custom-login").slideUp("fast");
    }
}); 
```

问题是在表单内部点击仍然会隐藏表单——除非你点击边框，这很奇怪。一种解决方案是添加一个`*`选择器来获取所有子元素，如下所示：

```
$j(document).click(function (e) {
    if ($j("div#custom-login").is(":visible") && !$j("div#custom-login, div#custom-login *").is(e.target)) {
        $j("div#custom-login").slideUp("fast");
    }
}); 
```

但我无法想象它不能以其他方式完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:54:42.613

很简单，只需添加以下代码：

```
$j("div#custom-login").click(function (e) {
    e.stopPropagation();    
}); 
```

[**在这里演示**](http://jsfiddle.net/V9zg6/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:51:37.100

这行不是指定它在可见并且是选定目标时向上滑动吗？:O

```
if ($j("div#custom-login").is(":visible") && !$j("div#custom-login, div#custom-login *").is(e.target)) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:48:45.257

尝试

```
$j(document).click(function (e) {
    if ($j("div#custom-login").is(":visible") && !$j(e.target).closest("#custom-login").length) {
        $j("div#custom-login").slideUp("fast");
    }
}); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/zujYE/3/)

**重要说明** 使用选择器是一种不好的做法，例如`div#custom-login`，如果您将 id 作为选择器，则仅`#custom-login`将其用作选择器

# android - Chrome android 浏览器只显示网页宽度的一部分

> ID：16100655
> 
> 赞同：0
> 
> 时间：2013-04-19T08:43:29.230
> 
> 标签：android, html, css

`<div>`我有一个三星 Galaxy Note 2，我使用 chrome 浏览器显示一个顶部宽度为 1280像素的网页。由于 Galaxy Note 2 的屏幕为 1280 像素宽，我希望整个页面一次以全宽显示。

但事实并非如此，而是显示了大约 980px 的内容：我必须取消缩放才能看到整个页面宽度。它变得非常无聊，因为在每一页上，我都必须一次又一次地取消缩放。

我在标题中尝试了类似的东西：

```
<meta name="viewport" content="width=device-width, initial-scale=1" /> 
```

它修改了一些东西，但更糟糕的是：看起来我的 1280 像素中只显示了大约 640 像素

编辑，这里有 2 个 html 页面来测试：

--> 当我显示 test.html 时，我只能看到绿色，看不到红色。（我必须取消缩放才能看到两种颜色）

```
test.html :
    <html>
    <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
    <body>
    <div style="background-color:red; width: 1280px">
    <div style="background-color:green; width: 980px">
    hello world
    <a href="test2.html">Go next page</a>
    </div>
    </div>
    </body>
    </html>

test2.html :
    <html>
    <head>
    </head>
    <body>
    <div style="background-color:blue; width: 1280px">
    <div style="background-color:yellow; width: 980px">
    houston we have a problem
    <a href="test.html">Go prev page</a>
    </div>
    </div>
    </body>
    </html> 
```

我制作了 2 个页面，因为从一个页面切换到另一个页面时，比例不是持久的：即使我在 test.html 上取消缩放以适应屏幕，我也必须再次取消缩放 test2.html

我怎样才能一次获得我的 1280px 并为我的所有网页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:21:50.813

尝试将宽度设置为 100%

```
<meta name="viewport" content="width=100%, initial-scale=1" /> 
```

编辑：你也可以试试这个：

测试.html

```
<html>
<head>
<meta />
</head>
<body>
<div style="background-color:red; width: 100%">
<div style="background-color:green; width:80%">
hello world
<a href="test2.html">Go next page</a>
</div>
</div>
</body>
</html> 
```

test2.html

```
<html>
<head>
</head>
<body>
<div style="background-color:blue; width: 100%">
<div style="background-color:yellow; width: 80%">
houston we have a problem
<a href="test.html">Go prev page</a>
</div>
</div>
</body>
</html> 
```

百分比应自动采用您的设备宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T13:26:24.533

以为我遇到了同样的问题，因为我有一个 100% 宽度的顶部，然后我在手机上看到它，它切入了居中的包装纸和其中的内容。

对我来说，解决方案是在外部设置 min-width，所以如果你没有任何外部 div，请在 body 上设置 min-width。

# jdo - 您将如何为 JDO 实现连接查询

> ID：16100656
> 
> 赞同：1
> 
> 时间：2013-04-19T08:43:36.727
> 
> 标签：jdo

你有一个查询说： -

```
select p from profiles p, group g where p.profileId = g.profileId 
```

您将如何使用 JDO 实现它。它可能是基本的，但我是 JDO 的新手，无法搜索有意义的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-05-17T10:51:58.570

在 JDOQL 中，您实际上并没有像 JOIN 这样的东西。正如@sihaya 提到的，检索对象还将获取其所有成员（取决于配置的获取类型（“eager”将加载所有内容，“lazy”将稍后加载））

查看文档，您可以使用类似的东西，称为“未绑定变量”：

> 未绑定变量，用于替代 SQL 的 JOIN 操作

> ObjectDB 支持未绑定变量，但 JDO 认为是可选的。带有未绑定变量的查询类似于 SQL 中的 JOIN 查询，因为必须针对每个候选对象检查每个变量组合。就像 SQL 中的 JOIN 查询一样，带有未绑定变量的查询可能会变得非常慢，因此在使用时需要谨慎。

这是链接：[https ://www.objectdb.com/database/jdo/manual/chapter7](https://www.objectdb.com/database/jdo/manual/chapter7)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-10-30T11:14:38.887

在 JDO 和其他对象关系映射框架（如 JPA）中，两个实体之间的关系的连接条件是从元模型中推断出来的。

在您的示例中，您可能有两个实体 Profile 和 Group 以及从 Group 到 Profile 的 n-1 关系。然后给出以下实体：

```
@PersistenceCapable
public class Group {
     private Profile profile;
     ...
} 
```

和

```
@PersistenceCapable
public class Profile {
     ...
} 
```

执行以下 JDO 查询将选择组引用的所有配置文件：

```
select g.profile from Group g 
```

# php - https 和 http，都在 appfog 上监听 80 端口

> ID：16100657
> 
> 赞同：0
> 
> 时间：2013-04-19T08:43:56.447
> 
> 标签：php, redirect, https, apache2, port

在我的本地 apache2 服务器中，http 监听端口 80，https 监听端口 443

但是在appfog上，

http 和 https 都在监听 80 端口，因为我遇到了

```
"The webpage has a redirect loop" on google chrome. 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T10:33:19.313

AppFog 将所有的 Apache 服务器放在运行在 nginx 上的负载均衡器之后。在内部，它们都使用端口 80 上的默认 HTTP 进行通信，因为可以讨论在该层使用 SSL 加密所有通信的好处。他们可能仍在以某种方式使用 SSL，但这对我们来说并不重要。您无法查看客户端是否使用 SSL，因为它们连接到负载均衡器而不是您的 Apache 服务器。幸运的是，nginx 为我们发送了一些额外的标头。`X-Forwarded-Port`准确地说`X-Forwarded-Proto`。我们可以利用这一点并检查其中一个或多个字段并相应地重定向。

```
RewriteCond %{HTTP:X-Forwarded-Proto} !^https$ [NC]
RewriteRule ^(.*) https://yourdomain.com/$1 [R,L] 
```

这至少为我解决了这个问题。您可能想对 做一些事情`X-Forwarded-Port`，但这应该涵盖大多数情况。

# ubuntu - Tomcat 用户实例不工作 - Ubuntu 12.04

> ID：16100663
> 
> 赞同：2
> 
> 时间：2013-04-19T08:44:56.547
> 
> 标签：ubuntu, tomcat7

**我安装了 tomcat7-user 但它不工作。请在下面找到我所做的。我首先进行了系统范围的安装，但不知道有很多用户特定的实例。

```
apt-get install tomcat7 
```

它安装成功，但因为我想要用户实例，所以我删除了它**

```
apt-get remove tomcat7 
```

**然后安装tomcat7用户实例**

```
apt-get tomcat7-user 
```

**显示已安装。**

**我创建了一个实例**

```
tomcat6-instance-create mydev-web 
```

**现在我可以看到我家中创建的文件夹 mydev-web**

```
~/mydev-web$ ls
bin  conf  logs  temp  webapps  work

~/mydev-web/webapps$ ls
index.html 
```

**我启动tomcat。我可以看到无法将端口绑定为已使用错误。所以我做了8082端口**

```
<Connector port="8082" protocol="HTTP/1.1"
               connectionTimeout="20000"
               URIEncoding="UTF-8"
               redirectPort="8443" /> 
```

**我启动tomcat**

```
~/mydev-web/bin$ ./startup.sh 
Using CATALINA_BASE:   /home/adarsh/mydev-web
Using CATALINA_HOME:   /usr/share/tomcat7
Using CATALINA_TMPDIR: /home/adarsh/mydev-web/temp
Using JRE_HOME:        /usr/lib/jvm/java-1.6.0-openjdk
Using CLASSPATH:       /usr/share/tomcat7/bin/bootstrap.jar:/usr/share/tomcat7/bin/tomcat-juli.jar
Tomcat started

~/mydev-web/bin$ ps -a
  PID TTY          TIME CMD
 5075 pts/0    00:00:02 java
 5104 pts/0    00:00:00 ps 
```

在浏览器我给 url

```
http://localhost:8082/index.html. 
```

**我可以期待这个页面出现吗？**

**当我尝试关机时，我看到了看起来像错误消息的内容。**

```
:~/mydev-web/bin$ ./shutdown.sh 
Using CATALINA_BASE:   /home/adarsh/mydev-web
Using CATALINA_HOME:   /usr/share/tomcat7
Using CATALINA_TMPDIR: /home/adarsh/mydev-web/temp
Using JRE_HOME:        /usr/lib/jvm/java-1.6.0-openjdk
Using CLASSPATH:       /usr/share/tomcat7/bin/bootstrap.jar:/usr/share/tomcat7/bin/tomcat-juli.jar
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/common/classes], exists: [false], isDirectory: [false], canRead: [false]
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/common], exists: [false], isDirectory: [false], canRead: [false]
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/server/classes], exists: [false], isDirectory: [false], canRead: [false]
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/server], exists: [false], isDirectory: [false], canRead: [false]
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/shared/classes], exists: [false], isDirectory: [false], canRead: [false]
Apr 19, 2013 11:38:33 AM org.apache.catalina.startup.ClassLoaderFactory validateFile
WARNING: Problem with directory [/var/lib/tomcat7/shared], exists: [false], isDirectory: [false], canRead: [false]
Tomcat stopped 
```

请指导我..我的最终目标是尝试一些jsp

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-09T03:07:27.177

`server.loader`删除和中列出的目录`shared.loader`。deb 包不创建目录`/var/lib/tomcat7/*`。

# r - 如何在 R 中读取特定的 ascii 格式

> ID：16100669
> 
> 赞同：1
> 
> 时间：2013-04-19T08:45:28.327
> 
> 标签：r, ascii

我有一个具有以下格式的 ascii 文件：

```
 4 3 2 
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 1.00 1.00
 1.00 
 1.00 1.00
 1.00
 1.00 1.00
 1.00
 1.00 1.00
 1.00 
```

第一行 (4 3 2) 是标题。数字 2 表示文件中的组数（在本例中为两组：第一个全为零，第二个全为一）。每组由 4 个包含三个值的子组组成（第一行两个，下一行一个）。

我想以 4 代表列数和 3 代表矩阵的行数或我可以使用的东西的方式读取这样的文件`filled.contour`，同时保持两个子组分开（不同`factor`）。

我正在尝试使用该`read.fwf`功能执行此操作，但在尝试指定`widths`选项时遇到了一些困难。列的分配方式不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:54:29.367

您可以`scan` 在此处使用，并使用标题行创建正确的矩阵：

```
text <- ' 4 3 2 
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 0.00 0.00 
 0.00
 1.00 1.00
 1.00 
 1.00 1.00
 1.00
 1.00 1.00
 1.00
 1.00 1.00
 1.00'
dd <- scan(textConnection(text))
matrix(dd[-c(1:3)],ncol=dd[1],nrow=dd[2]*dd[3],byrow=TRUE)

     [,1] [,2] [,3] [,4]
[1,]    0    0    0    0
[2,]    0    0    0    0
[3,]    0    0    0    0
[4,]    1    1    1    1
[5,]    1    1    1    1
[6,]    1    1    1    1 
```

# java - 套接字编程。真的有那么复杂吗？

> ID：16100670
> 
> 赞同：0
> 
> 时间：2013-04-19T08:45:28.557
> 
> 标签：java, sockets

我开发了一个基于 Web 的 Java EE 应用程序。最近我有一项工作要添加额外的功能——能够向使用 .NET 平台编程的 TCP 服务器发送和接收消息。我和另一个人扩展了我们的系统，以便他们可以相互通信和交换字节。

但是有一个大问题，这里是：

几乎不可能让它工作超过几个小时而不出现一些套接字 I/O 错误。有时需要重新启动 TCP 服务器，有时我的 Web 服务器会重新启动，这应该不是问题，因为当两台服务器都在运行时，它们会以 5 秒的间隔 ping 自己，如果出现问题，则会再次创建套接字。

但正如我所提到的，几乎不可能在超过几个小时的时间内交换消息而不会遇到一些错误。

不幸的是，我不知道 TCP 服务器是如何工作的，这对我来说更难找到问题的根源。

使用 Sockets 真的有那么复杂吗？

其实我必须作为一个真正的问题。所以这里是：

你们能给我一些教程（不是sun网站上的那个简单的教程）或者告诉我一些关于套接字编程的更具体的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:53:57.157

*Java中的基本客户端-服务器编程。*

[http://edn.embarcadero.com/article/31995](http://edn.embarcadero.com/article/31995)

借助教程中指定的**注释** ，您几乎可以避免所有可能的初学者错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:53:59.420

互联网如果不稳定，并且永久保持 TCP 连接几乎是不可能的。例如，一些防火墙会在没有信息通过的一段时间后断开它。您无权访问的 TCP 服务器可能也会这样做。

我建议每次通过连接发送数据之前，检查它是否仍然处于活动状态，如果没有重新连接。

如果您还需要从服务器接收数据，因此您需要始终保持连接，最好定期检查连接是否处于活动状态，如果没有则重新建立连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:25:41.787

通过网络进行通信时，您应该预计会有一些停机时间，并将您的客户端和服务器写入容错。

服务器应该检测客户端何时掉线（例如意外的套接字关闭等），并且应该能够接受来自它的新连接。您可以创建某种会话逻辑，以便在客户端需要重新连接时保留状态。

客户端应该能够检测到它与服务器的连接何时断开，并且它应该能够重新连接并继续其工作。自动化这种行为应该不难。

如果您有任何类型的 UI，那么您应该在离线运行时向用户显示它正在尝试重新连接。

# regex - 正则表达式提取包含特定单词的超链接

> ID：16100671
> 
> 赞同：6
> 
> 时间：2013-04-19T08:45:29.057
> 
> 标签：regex

我需要从一段文本中提取一个包含 url 中特定单词的超链接。例子;

“这是一个带有指向某个页面的链接的文本。单击此链接`<a href="/server/specificword.htm>this is a link to a page</a>`可查看该页面。这是一个没有“特定词”一词的链接：`<a href="/server/mypage.htm>this is a link without the word "specificword" in the url</a>`“

所以，我需要解析这段文字，检查超链接，看看其中一个是否包含“特定词”这个词，然后提取整个超链接。然后我会得到这个：

```
<a href="/server/specificword.htm>this is a link to a page</a> 
```

我需要在 URL 中包含特定字词的超链接，例如。/server/specificword.htm，不在链接文本中

我试过的一个正则表达式是这个：`/(<a[^>]*>.*?</a>)|specificword/` 这将匹配文本中的所有超链接，或“特定词”。如果文本有多个链接，没有“特定词”这个词，我也会得到这些。

另外，我试过这个，但它什么都没有：

```
<a.*?href\s*=\s*["\']([^"\'>]*specificword[^"\'>]*)["\'][^>]*>.*?<\/a> 
```

我的正则表达式技能到此结束，任何帮助都会很棒......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T08:53:50.630

对所有 a 标签试试这个：

```
/<a [^>]*\bhref\s*=\s*"[^"]*SPECIFICWORD.*?<\/a>/ 
```

或仅用于链接（在第一个捕获组中）：

```
/<a [^>]*\bhref\s*=\s*"([^"]*SPECIFICWORD[^"]*)/ 
```

如果您使用 php，则链接：

```
preg_match_all('/<a [^>]*\bhref\s*=\s*"\K[^"]*SPECIFICWORD[^"]*/', $text, $results); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-19T09:23:54.860

这应该适合您的需求：

```
<a href="[^"]*?specificword.*?">.*?</a> 
```

[演示](http://regexr.com/3f223)

* * *

如果你想在你的锚焦油上允许其他属性，并且对内部空间更加自负，你可以尝试：

```
<a( [^>]*?)? href="[^"]*?specificword.*?"( .*?)?>.*?</a> 
```

[演示](http://regexr.com/3f226)

* * *

您当然也可以使用非捕获组`(?:...)`：

```
<a(?: [^>]*?)? href="[^"]*?specificword.*?"(?: .*?)?>.*?</a> 
```

[演示](http://regexr.com/3f229)

* * *

最后，如果你想为你的`href`属性允许简单的引号：

```
<a(?: [^>]*?)? href=(["'])[^\1]*?specificword.*?\1(?: .*?)?>.*?</a> 
```

[演示](http://regexr.com/3f22c)

* * *

最后但并非最不重要的一点：如果您想捕获 URL，只需在`[^\1]*?specificword.*?`部分周围加上括号：

```
<a(?: [^>]*?)? href=(["'])([^\1]*?specificword.*?)\1(?: .*?)?>.*?</a> 
```

[演示](http://regexr.com/3f22f)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T08:58:14.067

您尝试的最终正则表达式几乎拥有它。试试这个改变：

```
<a\s.*?href=["']([^"']*?specificword[^"']*?)[^>]*>.*?<\/a> 
```

主要区别在于使量词“懒惰”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-19T09:42:18.643

试试这个模式这是你想要的确切要求

```
(?=.*href=\"([^\"]*specificword[^"]*)")<a [^>]+> 
```

如果您只想要 url 值，请使用 Groups[1] 喜欢：

```
Regex.match("input string",@"(?=.*href=\"([^\"]*specificword[^"]*)")<a [^>]+>").Groups[1].value; 
```

# linux - 如何找到重复行的数量，每行包含几个用空格分隔的数字

> ID：16100675
> 
> 赞同：0
> 
> 时间：2013-04-19T08:45:43.667
> 
> 标签：linux, bash, sorting

假设我有一个这样的文件......

```
4  2  8  2 12  3 18  2 22  2 26  2 28  3 30  2      
4  3 10  2 14  2 18  2 20  3 22  2 28  2 32  2      
2  3 10  3 12  2 16  2 18  3 20  2 24  2 26  3     
1  3  3  3 17  3 19  3 26  2 28  2 30  2 32  2 
4  2  8  2 12  3 18  2 22  2 26  2 28  3 30  2 
```

输入中的第一行和最后一行是相同的...

我希望输出像...

```
4  2  8  2 12  3 18  2 22  2 26  2 28  3 30  2  2     
4  3 10  2 14  2 18  2 20  3 22  2 28  2 32  2  1   
2  3 10  3 12  2 16  2 18  3 20  2 24  2 26  3  1   
1  3  3  3 17  3 19  3 26  2 28  2 30  2 32  2  1 
```

输出中额外的最后一列只是指定了额外的行数.....

我怎么能在bash中做到这一点......

我知道这个`sort`命令，但它只适用于每行一个数字....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:55:52.803

来自[sehe的建议](https://stackoverflow.com/questions/16100675/how-to-find-the-numver-of-duplicate-lines-each-line-contains-a-few-numbers-sepe#comment22989520_16100675)，这个呢？

```
sort your_file | uniq -c | awk '{for(i=2;i<=NF;i++) printf $i"\t"; printf $1"\n"}' 
```

输出：

```
1       3       3       3       17      3       19      3       26      2       28      2       30      2       32      2       1
2       3       10      3       12      2       16      2       18      3       20      2       24      2       26      3       1
4       2       8       2       12      3       18      2       22      2       26      2       28      3       30      2       2
4       3       10      2       14      2       18      2       20      3       22      2       28      2       32      2       1 
```

# c# - WebBrowser 通过窗口电话中的会话 cookie 导航

> ID：16100678
> 
> 赞同：1
> 
> 时间：2013-04-19T08:45:56.213
> 
> 标签：c#, windows-phone-7, windows-phone-8, browser

我正在尝试通过**POST**方法登录网站`HttpWebRequest`。一开始，我创建了一个肖像页面，让用户输入用户名和密码并访问网页。我成功发布数据并从网站获取**HTML**内容。最后我使用该`Webrowser.NavigateTostring`方法在我创建的 webBrowser 中显示网站。

**问题 1**：在 webBrowser 中，我无法在网站上执行任何操作。在*普通*的网络浏览器中，成功登录后，我可以执行任何操作，例如转到活动论坛..但我面临的是我无法导航到活动论坛或任何论坛。

**问题 2**：在 webBrowser 中，图像不会显示，例如，用户图片、产品图片。我也尝试使用`IsolatedStorage`方法来显示**HTML**内容，但它也不起作用。

我感到困惑的是，该`Webrowser.NavigateTostring`方法是否是一种对互联网网站进行异步操作的方法？我做错了什么？还是我在寻找错误的方向？

任何帮助，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T16:38:22.567

不幸的是，Set-Cookie 是不受支持的 HTTP 标头之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T10:34:16.643

这种方式会遇到这些问题，就像您使用`WebBrowser.NavigateToString`或从独立存储加载 HTML 一样，任何指向图像、脚本或 CSS 的相关链接都不起作用。也不可能将任何 Cookie 传递`HttpWebRequest`给`WebBrowser`

这样做的方法是使用`WebBrowser`控件本身来执行 POST。[如 MSDN here](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff626636%28v=vs.105%29.aspx)`WebBrowser.Navigate`中所述，该方法有一个重载。这将允许您将数据发布到您的 URL。

```
// generate your form data based on the data you got from your "portrait page" 
// and get the bytes from that.
// (e.g. write your post data to a MemoryStream as UTF8 and get its bytes)
byte[] formBytes = ...

// write HTTP headers here, including the type of data you're posting, e.g.:
string headers = "Content-Type: application/x-www-form-urlencoded" 
   + Environment.NewLine;

Uri uri = ... // where you want the POST data to be sent

this.webBrowser.Navigate(uri, formBytes, headers); 
```

这样，您的网络浏览器将被正确初始化，并且您的 cookie、图像、脚本和 CSS 都应该可以正常工作。

# asp.net-mvc-4 - 键 attachdbfilename mvc 4 的值无效

> ID：16100679
> 
> 赞同：0
> 
> 时间：2013-04-19T08:45:57.127
> 
> 标签：asp.net-mvc-4

我正在做一个非常基本的 MVC 4 项目。我有一个简单的模型和一个 dbcontext。我正在尝试从表单中获取输入并使用 dbcontext 保存它。

这是我的代码，在控制器中

```
 public ActionResult FormShow(Models.bullseye sampbe)
    {
        if (ModelState.IsValid)
        {
            var db = new bullseyeDataContext();
            db.bullseyes.Add(sampbe);
            db.SaveChanges();

            return RedirectToAction("FormShow");
        }

        return FormShow();
    } 
```

在数据库上下文中

```
public class bullseyeDataContext : DbContext 
{
    public DbSet<bullseye> bullseyes { get; set; }

    static bullseyeDataContext()
    {
        Database.SetInitializer(new DropCreateDatabaseAlways<bullseyeDataContext>());
    }
} 
```

连接字符串是

```
<add name="MvcFourFirstTouch.Models.bullseyeDataContext"
connectionString="Data Source=(LocalDb)\v11.0;
Integrated        Security=SSPI;AttachDBFilename=|DataDirectory|\MvcFourFirstTouch.Models.bullseyeDataContext.mdf" providerName="System.Data.SqlClient" /> 
```

当我提交表单时，我得到键 attachdbfilename 的无效值。问题出在哪里？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:57:07.780

**更新**

问题在于您的连接字符串。`AttachDBFileName`不喜欢您指定给它的值。`\`可能是 db 名称的问题，或 LocalDB 的问题，或路径中缺少/存在额外内容。

但是，如果您没有明确的使用理由`AttachDBFileName`，那么我建议您替换`AttachDbFileName=[...].mdf`为`Initial Catalog=yourDBName`. 如果以这种方式出现问题，你会避免很多:)

# bash - 在bash中从字符串获取变量

> ID：16100683
> 
> 赞同：0
> 
> 时间：2013-04-19T08:46:04.033
> 
> 标签：bash, substitution

我正在编写一个 bash 脚本来自动化一些系统管理员的工作。我首先检查是否定义了许多变量。我现在这样做的方式是这样的：

```
function is_defined {
    if [ -z "$2" ]; then
        echo "$1 is not defined"
        exit
    fi
}

is_defined "PROJECTNAME" $PROJECTNAME 
```

我想要的是一个只接受一个参数的函数：变量名作为字符串，检查它是否已定义，如果未定义，请告诉用户并退出。

在 bash 中执行此操作的正确替换魔法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T08:59:34.707

像这样的东西：

```
function is_defined {
    if [ -z "${!1}" ]; then
        echo "$1 is not defined"
        exit 1
    fi
} 
```

${!a} 正如@sehe 所说，将打印变量的值，名称为 $1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T09:08:56.850

可以使用奇异的参数扩展：`${!var}`扩展为名称为 的变量`$var`。

## 版本 1

```
is_defined() {
  if [ -z "${!1}" ]; then
    echo "$1 is not defined"
    exit 1
  fi
} 
```

但我们可以进一步简化：

bash`${var?errormsg}`在其鲜为人知的功能中具有参数扩展。它基本上意味着“如果`var`已定义，则扩展为其值；否则， print `errormsg`，设置`$?`非零并跳到下一个命令”。`errormsg`是可选的，默认为`parameter null or not set`（但`?`是必需的）。与外来参数扩展一样，`${var:?errormsg}`如果变量具有空值，则可以使用冒号 ( ) 对其进行修改，以使其也出错。

在非交互式 shell 中，这种参数扩展产生的错误将中止 shellscript。

## 版本 2

```
is_defined() {
  : ${!1:?"parameter $1 null or unset"}
} 
```

刚刚在我的 MinGW bash 上进行了测试。该`:`命令只是忽略其所有输入，不执行任何操作并返回成功。（这确实有令人讨厌的副作用，即通过在错误消息前加上`sh: !1:`; 来污染您的错误消息，随意使用。）

# mysql - MySQL：从一个表复制到另一个不覆盖现有的？

> ID：16100689
> 
> 赞同：1
> 
> 时间：2013-04-19T08:46:22.113
> 
> 标签：mysql

我有两张桌子：

1.  表原件
2.  表备份

它们具有完全相同的结构。

我想要一个可以在一天中的任何时间运行的 SQL 语句，它将所有行从 tableOriginal 复制到 tableBackup 而不会覆盖 tableBackup 中的项目。基本上，此命令必须将 tableBackup 与 tableOriginal 同步。

我怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:48:53.357

```
INSERT INTO tableBackup(SELECT * FROM tableOriginal) 
```

只要主键被更新或替换为新的传入数据没有问题，这不会给您带来问题。但是，正如您已经知道的那样，备份表在您的命令之后将有更多数据，因为它没有删除它以前的数据

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T09:13:41.650

为什么不**先删除****tableBackup**中的所有数据，然后将 tableOriginal 中**的**数据**插入****tableBackup**

 **```
DELETE FROM tableBackup
INSERT INTO tableBackup(SELECT * FROM tableOriginal) 
```

为什么我们需要先删除？因为如果我们要向 tableBackup 插入唯一的数据，下次我们插入它就不会执行，因为我们将插入/添加一些已经存在的数据..

希望你明白我想说的。**

# c - 从文件中读取分号分隔的字符串

> ID：16100692
> 
> 赞同：0
> 
> 时间：2013-04-19T08:46:32.430
> 
> 标签：c, string, file

如何阅读 ”;” 从c中的文件中分离字符串？我正在使用以下方法：

```
char c;
c=fgetc(fp);
while(c!=EOF)
{
    int k=0;
    if(c=='\n')
    c=fgetc(fp);
    while(c!=';')
    {
        str1[k]=c;
        k++;
        c=fgetc(fp);
    }
    str1[k]='\0';
    c=fgetc(fp);
    k=0;
    while(c!=EOF && c!='\n')
    {
        str2[k]=c;
        k++;
        c=fgetc(fp);
    }
    str2[k]='\0';
    Seq(str1,str2);
    printf("\n");
    if(c==EOF)
    {
        break;
    }
    else
    c=fgetc(fp);
} 
```

> 输入文件：
> 
> ```
>  Hello;world
> 
>      Male;Female
> 
>      where;who 
> ```

我必须读取不同的字符串值，然后将它们传递给 Seq(hello,world).. 等函数

有更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T08:49:44.240

更好的方法是从文件中读取行，然后使用`strchr`、`strpbrk`、`strcspn`、`strtok`、`sscanf`或其他库函数来查找 ';'。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T08:53:14.403

```
while (fscanf(fp, " %[^;];%s", str1, str2) == 2)
  Seq(str1, str2); 
```

只要非常确定`str1`并且`str2`足够大！

格式说明：

*   `(space) : 跳过任何空格，包括换行符。`
`*   `%[^;]`: 读取一个不能包含分号的字符串。这不会跳过前导空格，因此我们必须明确地这样做（感谢@MOHAMED）。*   `;`: 读取并丢弃分号。如果不存在，则匹配失败。*   `%s`: 读取一个字符串直到空白，所以基本上直到行尾。`

 ``fscanf`返回匹配字段的数量。我们正在寻找两个，所以如果结果是任何其他数字，则输入失败。如果您的文件格式`feof(fd)`正确，则应返回 true，否则匹配会提前失败。

要正确偏执，您还应该包括字段宽度`str1`和`str2`确保您不会出现缓冲区溢出。因此，如果您分配了 100 个字节，您将使用`%99[^;]`（留下一个字节作为零终止符）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:53:47.250

您可以使用 **" %[^;] ; %[^\n]"** 作为 fscanf() 的格式说明符来执行此操作。它将读取文件直到遇到分号，然后是格式说明符中的分号string 将“吃掉”文件中该单词之后的分号。`

# rest - OData substringof 或以返回所有项目开始

> ID：16100697
> 
> 赞同：8
> 
> 时间：2013-04-19T08:47:02.520
> 
> 标签：rest, jquery, odata, sharepoint-2013

我正在尝试从休息呼叫中过滤我的结果。

```
$.ajax({
    type: "GET",
    headers: {
        "Accept": "application/json;odata=verbose"
    },
    dataType: "JSON",
    url: _spPageContextInfo.webServerRelativeUrl + "/_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$startswith('Title','" + request.term + "') eq true",
    success: function (data) {
    },
    error: function (ex) {
    }
}); 
```

在我的联系人列表中，我试图检索以字符串开头或其中包含字符串的项目的标题和 ID，例如这里是某人的姓名。

我也用 substringof 试过：

```
"/_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$substringof(" + request.term + ",'Title') eq true" 
```

这也提供了相同的结果。

它给了我列表中的所有列表项，并且没有应用过滤。[在查看此处使用 SharePoint 2013 REST 服务进行编程](http://msdn.microsoft.com/en-us/library/fp142385.aspx#bk_determining)后，我为其余部分构建了 Url 就像那里给出的架构一样，我认为 Url 看起来不错，但似乎不是这样

**编辑：**

在 OData Uri 约定中应用`$filter`类似的内容会给我以下错误：

```
{"error":{"code":"-1, Microsoft.SharePoint.SPException","message":{"lang":"en-US","value":"The query is not valid."}}} 
```

尝试使用以下查询字符串：

```
_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$filter=substringof(m,'Title') eq true

_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$filter=substringof('m','Title') eq true

_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$filter=substringof('m',Title) eq true 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-08-08T13:27:24.130

当我删除“eq true”时，我已经设法让带有 substringof 的过滤器返回正确的结果。

使用您的查询字符串之一，它应该像这样工作：

```
_api/lists/getByTitle('Contacts')/items?$select=Title,Id&$filter=substringof('m',Title) 
```

我没有检查任何其他函数，但至少，startswith 函数也是如此。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-19T21:44:41.723

对于任何查看此问题的人，我可以报告

```
/_api/web/lists/GetByTitle('Applications')/items?$filter=startswith(Title,'1AAJ') 
```

正在为我工​​作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T15:00:13.833

我在端点上尝试了您的查询 URI 并应用了一些更改： - 子字符串的第二个参数不应该是字符串，所以我删除了撇号

在此之后，我得到结果：

[http://jaydata.org/examples/Northwind.svc/Products](http://jaydata.org/examples/Northwind.svc/Products) ?$select=Product_ID,Product_Name&$filter=substringof('CH',Product_Name)

我的端点是标准的 WCF 数据服务，并且过滤器正在工作。

如果更改 URI 仍然返回所有记录，我猜这将是一个 SherePoint 技巧。如果你在过滤器中加入 'zzz' 或一些随机字符串会发生什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T14:34:47.853

检查[http://www.odata.org/documentation/odata-v2-documentation/uri-conventions/](http://www.odata.org/documentation/odata-v2-documentation/uri-conventions/)以了解正确的 uri 约定。

应该

```
/_api/lists/getByTitle('Contacts')     
/items?$select=Title,Id&$filter=substringof(" + request.term + ",'Title') eq true" 
```

所以包含 $filter

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-02-07T17:40:02.663

此外， contains 方法有效，并且我与它有更好的兼容性。语法是：

```
api/People?$filter=contains(LastName,%27Smith%27)&$select=LastName,FirstName 
```

# sql - 将另一个表中的数据放入检查约束

> ID：16100700
> 
> 赞同：6
> 
> 时间：2013-04-19T08:47:09.237
> 
> 标签：sql, triggers, constraints

我有一个表说table1和一个colum说checkColumn，

现在我想对字段 checkColumn 设置一个检查约束，这将只允许另一个表中存在的数据，例如表 2 在某些条件下，

我试过这样，

```
ALTER TABLE table1
ADD CHECK (checkColumn=(select field1 from table2 where field2='ABC') ) //the select is not scalar 
```

但是当我意识到它不允许在检查条件中使用子查询字符串时，我搜索了一下并阅读了我应该使用外键、触发器或其他东西，但并不真正了解如何在这里实现这些示例，所以将其作为一个单独的问题发布。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T09:07:04.240

不幸的是，您不能将 Sub Query 插入到 Check 约束的上下文中。但在这里我想给点建议，你可以使用任何触发器或函数，你可以使用外键约束来检查数据依赖关系我想分享一个函数的例子。例如

```
CREATE FUNCTION fn_Check_Rollnumber (
    @Rollnumber INT
)
RETURNS VARCHAR(10)
AS
BEGIN
    IF EXISTS (SELECT Rollnumber FROM Table_Student WHERE Rollnumber = @Rollnumber)
        return 'True'
    return 'False'
END 
```

现在您可以在检查上下文中使用此功能，例如，

```
ALTER TABLE Table_Fees 
    WITH CHECK ADD CONSTRAINT CK_RollCheck
    CHECK (fn_Check_Rollnumber(Rollnumber) = 'True') 
```

# asp.net - 谷歌地图中的路径着色

> ID：16100702
> 
> 赞同：0
> 
> 时间：2013-04-19T08:47:24.570
> 
> 标签：asp.net, google-maps-api-3

我想知道是否可以更改 Google Maps APIv3 中显示的路径的颜色，特别是在 TRANSIT 部分，其中使用 BUS、RAIL 和 WALKING 等不同的使用模式来显示结果。

我可以更改这些不同模式的显示颜色吗？目前，步行模式为黑色，其他模式为天蓝色。

我的代码是：

```
function calcRouteM() 
{
    var start = document.getElementById('DropDownList1').value;
    var end = document.getElementById('DropDownList2').value;
    var request = {
        origin: start,
        destination: end,
        provideRouteAlternatives: true,
        unitSystem: google.maps.UnitSystem.METRIC,
        travelMode: google.maps.DirectionsTravelMode.TRANSIT,
        transitOptions: {
              departureTime: new Date(1362799800000)
        }
    };
    directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
         directionsDisplay.setDirections(response);
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:15:51.853

如果您不使用 DirectionsRenderer 来显示和渲染它们，您可以更改折线的颜色。

[DirectionsRendererOptions](https://developers.google.com/maps/documentation/javascript/reference#DirectionsRendererOptions) _ `{suppressPolylines: false}`

> 抑制折线 | 布尔值 | 抑制多段线的渲染。

然后通过结果对象处理创建具有所需颜色的折线。

[自定义渲染路线的示例](http://www.geocodezip.com/v3_directions_custom_iconsC.html)（您可能只需要做折线）

另一个选项可能是（未测试）对返回的路线进行后期处理，将不同颜色的片段发送到具有不同值（颜色）的不同 DirectionsRenderer 调用 polylineOptions 选项。

# android - 如何检测墙壁的长边以准备遮罩和重新着色

> ID：16100708
> 
> 赞同：17
> 
> 时间：2013-04-19T08:47:50.317
> 
> 标签：android, iphone, opencv, image-processing, edge-detection

主要思想是允许用户重新着色到基于特定墙壁的用户选择。目前我已经使用`cvFloodFill`（帮助准备蒙版图像）实现了这个功能，它可以帮助我改变`HSV`墙的相对值，这样我就可以保留边缘。但这个解决方案的问题是它适用于颜色并且所有墙壁都被重新粉刷而不是用户选择的单一墙壁。

我也尝试过精明的边缘检测，但它只能检测边缘但无法将其转换为区域。

请在下面找到我目前用于重绘功能的代码

1.  准备口罩

    `cvFloodFill(mask, new CvPoint(295, 75), new CvScalar(255, 255, 255,0), cvScalarAll(1), cvScalarAll(1), null, 4, null);`

2.  拆分通道

    `cvSplit(hsvImage, hChannel, sChannel, vChannel, null);`

3.  换颜色

    `cvAddS(vChannel, new CvScalar(255*(0.76-0.40),0,0,0), vChannel, mask);`

我们如何从图像中检测边缘和相应区域。

我正在寻找可以不是`opencv`但应该适用于 iPhone 和 android的解决方案

![示例图像](https://i.stack.imgur.com/9yvrx.jpg)

**编辑**

我可以使用以下步骤获得如下图所示的结果

```
cvCvtColor(image, gray, CV_BGR2GRAY);   
cvSmooth(gray,smooth,CV_GAUSSIAN,7,7,0,0);
cvCanny(smooth, canny, 10, 250, 5); 
```

此输出有两个问题，不知道如何解决它们 1\. 靠近边缘 2\. 移除小边缘

![在此处输入图像描述](https://i.stack.imgur.com/otsMr.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-24T14:03:05.083

你可以尝试类似的东西：

```
 Mat imageOut = Mat::zeros(imageIn.rows, imageIn.cols, CV_8UC3);

 vector<vector<Point> > contours;
 vector<Vec4i> hierarchy;    

 findContours( imageIn, contours, hierarchy, CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE );
 for( int idx = 0; idx >= 0; idx = hierarchy[idx][0] )
 {
     Scalar color( rand()&255, rand()&255, rand()&255 );
     drawContours( imageOut, contours, idx, color, CV_FILLED, 8, hierarchy );
 } 
```

它应该用不同的颜色绘制墙壁。如果它有效，这意味着在“层次结构”中，每面墙都被识别为一个轮廓，然后您必须找出用户在他的触摸屏上选择了哪一个并进行颜色调整处理。

您可能需要更改“findContours”[链接](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours)中的不同参数。您还需要在轮廓检测之前对输入图像进行平滑处理，以避免对细节或纹理感到厌烦。

希望有帮助，托马斯

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-06-27T15:25:58.367

我想我可能会为您提供解决方案！在 OpenCV 中有一个名为 watershed.cpp 的示例文件，只需运行它，您将得到以下结果：

![只有短线关键点的分水岭](https://i.stack.imgur.com/uLdbf.png)

您可以让您的用户在他的屏幕上绘图以区分每面墙。然后，如果你想要更精确的东西，你可以像这样勾勒出这些区域（不接触其他线条）：

![更好的轮廓](https://i.stack.imgur.com/bJvGi.png)

还有多田！：

![相当不错的结果；）](https://i.stack.imgur.com/sbHPH.png)

通过一些工作，您可以使其用户友好（取消最后一行，连接区域等......）

希望有帮助！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-24T04:40:55.537

我认为您可以使用`Canny Edge Detection`算法来查找边缘差异。一些链接

1.  [堆栈溢出](https://stackoverflow.com/questions/9084859/pre-processing-the-image-before-edge-detection?rq=1)
2.  [堆栈溢出](https://stackoverflow.com/questions/12994612/how-to-do-canny-edge-detection-in-javacv-opencv)
3.  [OpenCV 质量保证](http://answers.opencv.org/question/11528/images-matching-using-canny-edge-detection/)
4.  [开放式CV](http://opencv.wikispaces.com/6%29+Canny+Edge+Detection)
5.  [本机教程](http://www.pages.drexel.edu/~nk752/Research/cannyTut2.html)

我希望这可以帮助你。谢谢。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-25T03:46:14.370

这是一些 OpenCV4Android 代码，用于查找被`Mat`调用的最大轮廓`image`，我们假设它在 RGBA 颜色空间中。要找到轮廓，首先需要对图像进行阈值化或二值化（转换为黑白）。在阈值化之前在图像上使用高斯模糊可以减少产生的小轮廓的数量。模糊和阈值的大小参数必须是奇数；您可以四处寻找哪个值可以提供最佳结果（在这里，我对两者都使用了 7）。

```
List<MatOfPoint> contours = new ArrayList<MatOfPoint>();
Mat BW = new Mat();
Mat hierarchy = new Mat();
MatOfPoint largestContour;

Imgproc.cvtColor(image, image, Imgproc.COLOR_RGBA2GRAY); // convert to grayscale

Imgproc.GaussianBlur(image, BW, new Size(7,7), 0); 

Imgproc.adaptiveThreshold(BW, BW, 255, 
    Imgproc.ADAPTIVE_THRESH_MEAN_C, Imgproc.THRESH_BINARY_INV, 7, 2.0);

Imgproc.findContours(BW, contours, hierarchy, Imgproc.RETR_EXTERNAL,
        Imgproc.CHAIN_APPROX_SIMPLE);

double maxArea = 0;
for (MatOfPoint contour : contours) {
    double area = Imgproc.contourArea(contour);
    if (area > maxArea) {
        maxArea = area;
        largestContour = contour;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-27T04:04:27.007

> 此输出有两个问题，不知道如何解决它们 1\. 靠近边缘 2\. 移除小边缘

1.  您可以使用形态学操作来关闭边缘。寻找膨胀和闭合运算符。

2.  您可以通过标记来去除小边缘。计算每个区域中的像素数（连接的白色像素）。删除像素数小于某个阈值的任何区域。我不使用opencv，但大多数库都有一个标签功能，可以创建一个图像，其中每组单一颜色的触摸像素在输出图像中分配一个唯一的颜色。

# visual-studio-2012 - 摆脱 Visual Studio Express 2012 上所有大写菜单的常用方法都失败了。请指教

> ID：16100710
> 
> 赞同：0
> 
> 时间：2013-04-19T08:47:56.880
> 
> 标签：visual-studio-2012, ide, registry, visual-studio-express, visual-studio-extensions

我一直试图摆脱桌面版 VS express 中的所有大写菜单，但无济于事。我已经通过将其放入 powershell 尝试了通常的注册表黑客

`Set-ItemProperty -Path HKCU:\Software\Microsoft\VisualStudio\11.0\General -Name SuppressUppercaseConversion -Type DWord -Value 1`

但是文件夹中没有`General`包含`11.0`文件夹，因此该选项失败。

我还尝试安装一个扩展程序，允许您关闭所有大写 [http://visualstudiogallery.msdn.microsoft.com/a83505c6-77b3-44a6-b53b-73d77cba84c8](http://visualstudiogallery.msdn.microsoft.com/a83505c6-77b3-44a6-b53b-73d77cba84c8) 但安装失败并出现错误`VSIXInstaller.NoApplicableSKUsException:...`

所以。这是一个小问题，我对此无能为力，*真的很烦人。*任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-23T03:10:10.207

据此[，](https://stackoverflow.com/questions/10859173/how-to-disable-all-caps-menu-titles-in-visual-studio-2012-rc#comment16692218_10859562)密钥将是 HKCU:\Software\Microsoft\WDExpress\11.0\General。

# java - 从 web.xml 调用 spring 控制器（异常类型）

> ID：16100718
> 
> 赞同：1
> 
> 时间：2013-04-19T08:48:32.320
> 
> 标签：java, spring-mvc, web.xml

我需要知道是否有任何方法可以`web.xml`从以下位置调用弹簧控制器：

```
<error-page>
    <exception-type>org.demo.exceptions.InvalidSessionException</exception-type>
    <location>/login.jsp</location>
</error-page> 
```

我创建了一个名为 as 的自定义异常类`InvaliSessionException`，通常我们从`<location>`标签中调用一些 jsp 页面，但我需要做的是调用登录控制器，例如`auth/login`ie `<location>/auth/login</location>`。

有什么办法可以做到这一点？

`InvaliSessionException.java`

```
public class InvalidSessionException extends NullPointerException 
{
    private static final long serialVersionUID = 1L;

public String getMessage()
{
    return "No user logged in.";
}

public int getExceptionType()
{
    return -1;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:27:09.387

执行此操作的首选方法是在 Spring 上下文中添加“全局异常处理程序”，而不是尝试从 web.xml 重新进入 Spring 上下文。

您可以通过在上下文中配置 org.springframework.web.servlet.handler.SimpleMappingExceptionResolver bean 来实现这一点。使用此解析器应处理的异常列表设置 exceptionMappings 属性，并为每个异常提及应向用户显示的视图。

这使设计保持清洁和可维护。

# c# - 不显示代码中依赖属性的更改

> ID：16100729
> 
> 赞同：1
> 
> 时间：2013-04-19T08:49:02.650
> 
> 标签：c#, wpf, button, dependency-properties, word-wrap

我创建了一个按钮，它应该支持自动换行。我的按钮 XAML 代码如下所示：

```
<Button x:Class="POS.TouchScreen.UI.Elements.TouchButtonWPF"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Height="23" HorizontalAlignment="Left" Name="buttonGrid" VerticalAlignment="Top" Width="75" BorderBrush="#FF8A97A9" Margin="4"
             DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <TextBlock Name="ButtonTextBlock" 
               HorizontalAlignment="Stretch" 
               VerticalAlignment="Stretch"
               Text="{Binding ButtonText, Mode=TwoWay}"
               TextWrapping="Wrap">
    </TextBlock> 
</Button> 
```

我已经实现了如下所示的属性：

```
public static readonly DependencyProperty ButtonTextProperty = 
    DependencyProperty.Register("ButtonText", typeof(string), typeof(TouchButtonWPF), new UIPropertyMetadata("Button",new PropertyChangedCallback(OnButtonTextChanged), new CoerceValueCallback(OnCoerceButtonText)));

private static object OnCoerceButtonText(DependencyObject o, object value)
{
    TouchButtonWPF button = o as TouchButtonWPF;
    if (button != null)
        return button.OnCoerceButtonText((string)value);
    else 
        return value;
}

protected virtual string OnCoerceButtonText(string value)
{
    return value;
}

private static void OnButtonTextChanged(DependencyObject o, DependencyPropertyChangedEventArgs e)
{
    TouchButtonWPF button = o as TouchButtonWPF;
    if (button != null)
        button.OnButtonTextChanged((string)e.NewValue, (string) e.OldValue);
}

protected virtual void OnButtonTextChanged(string NewValue, string OldValue)
{
    this.ButtonTextBlock.Text = NewValue;
}        

public string ButtonText
{
    get { return (string)GetValue(ButtonTextProperty); }
    set { SetValue(ButtonTextProperty, value); }
} 
```

插入 TouchButtonWPF 的实例如下所示

```
<tse:TouchButtonWPF ButtonText="OK" FontSize="16" Height="77" HorizontalAlignment="Left"x:Name="buttonOk" Width="85" /> 
```

这完美地工作并且按钮文本正确显示。但是，当我从 C# 代码分配 ButtonText 时，文本不会更新。我正在分配变量，如下所示。

```
 touchButton.ButtonText = navButton.Caption; 
```

谁能告诉我我做错了什么？请注意，事件处理程序在最初不起作用时已经实现，无法弄清楚我试图实现的功能是否需要这些事件处理程序？

期待阅读您的回复:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T09:19:13.997

你的问题是你直接设置一个依赖属性（`this.ButtonTextBlock.Text = NewValue`）。

在您执行此操作之前， this.ButtonTextBlock.Text 的值设置为`Binding`. 将绑定替换为本地值会删除绑定，文本将不再响应原始绑定表达式。

代替 -`this.ButtonTextBlock.Text = Value;`

和 -`this.ButtonTextBlock.SetCurrentValue(TextProperty, value);`

这将设置值而不会破坏您的绑定

# java - 在 Jenkins 构建中使用 ssehexec 任务不会停止其执行

> ID：16100730
> 
> 赞同：1
> 
> 时间：2013-04-19T08:49:05.763
> 
> 标签：java, shell, ant, jenkins

我在 Jenkins Ant 执行插件中有一个 Ant 任务，作为构建后步骤，用于在我们的一台服务器中远程运行 shell 脚本。shell 脚本在后台启动一个 java 进程。当我直接在服务器上执行 shell 脚本时，它会在后台启动 java 进程并出来。当我通过`sshexec`任务从 Jenkins 运行它时，shell 脚本会运行，但它永远不会出现，Jenkins Build 会等待。

后来，当我将`timeout`属性添加到`sshexec`它时，它在给定的毫秒数后超时，但 Jenkins 构建显示为失败。如何使 sshexec 任务从 shell 脚本执行中干净利落地出来？

这是我的`ssheexec`任务

```
<sshexec host="${deploy.host}" username="${deploy.username}"  password="${deploy.password}" command=". /etc/profile; cd ${deploy.path}; sh start.sh i1" trust="true" timeout="10000" /> 
```

start.sh文件如下**所示：**

```
nohup java -Xms512m -Xmx1024m -cp calculation.jar com.tes.StartCalculation $1 &

echo $! > calculation-$1-java.pid 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:26:49.770

看起来，ssh 执行的作业没有完全**守护**。在许多情况下，开始`nohup`是不够的。

请参阅与之相关的[讨论](https://github.com/jenkinsci/publish-over-ssh-plugin/pull/1)（在不同的上下文中）

> 问题是当您将某些内容推送到后台时，您没有关闭文件描述符。& 当你在 shell 中时很好，但当你想断开连接并让进程继续运行时还不够，你需要进程与 shell 断开连接。

.... 修复以更正脚本。

> 如果有人编写了一个未正确从终端分离的幼稚服务脚本，我想知道该脚本第一次在部署中使用的时间——SCM 更改将能够快速识别重大更改。
> 
> 隐藏问题以使不正确的代码能够发布到生产环境是错误的——如果我第一次知道它是在生产系统管理员抱怨时，我会不高兴。

如果这是同样的问题，你需要[守护脚本](http://www.unix.com/shell-programming-scripting/61539-daemonizing-bash-script.html)

# java - Java - 重绘背景

> ID：16100731
> 
> 赞同：0
> 
> 时间：2013-04-19T08:49:09.030
> 
> 标签：java, graphics, awt

我想用不同的图像重绘背景。这是一个 SSCCE 示例 - 我想向 Listener 添加一个动作，它将用另一个图像重新绘制。

```
package painting;

import javax.swing.SwingUtilities;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.BorderFactory;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseMotionListener;
import java.awt.event.MouseMotionAdapter;

public class SwingPaintDemo3 {

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            createAndShowGUI(); 
        }
    });
}

private static void createAndShowGUI() {
    System.out.println("Created GUI on EDT? "+
    SwingUtilities.isEventDispatchThread());
    JFrame f = new JFrame("Swing Paint Demo");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
    f.add(new MyPanel());
    f.pack();
    f.setVisible(true);
} 
}

class MyPanel extends JPanel {

private int squareX = 50;
private int squareY = 50;
private int squareW = 20;
private int squareH = 20;
Image img;

public MyPanel() {

    setBorder(BorderFactory.createLineBorder(Color.black));

    addMouseListener(new MouseAdapter() {
        public void mousePressed(MouseEvent e) {
            moveSquare(e.getX(),e.getY());
        }
    });

    addMouseMotionListener(new MouseAdapter() {
        public void mouseDragged(MouseEvent e) {
            moveSquare(e.getX(),e.getY());
        }
    });

}

private void moveSquare(int x, int y) {
    int OFFSET = 1;
    if ((squareX!=x) || (squareY!=y)) {
        repaint(squareX,squareY,squareW+OFFSET,squareH+OFFSET);
        squareX=x;
        squareY=y;
        repaint(squareX,squareY,squareW+OFFSET,squareH+OFFSET);
    } 
}

public Dimension getPreferredSize() {
    return new Dimension(250,200);
}

protected void paintComponent(Graphics g) {
    super.paintComponent(g);      
try {
    img = ImageIO.read(new File("graphics/close_0.jpg"));
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
}
    g.drawImage(img, 0, 0, null); 
    g.drawString("This is my custom Panel!",10,20);
    g.setColor(Color.RED);
    g.fillRect(squareX,squareY,squareW,squareH);
    g.setColor(Color.BLACK);
    g.drawRect(squareX,squareY,squareW,squareH);
}  
} 
```

那么我应该调用什么方法来用不同的图像重绘背景呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:14:51.490

据我所知，这个问题（“很少”）可能会引导您前进。请注意，代码不应**尝试**`paint`在or`paintComponent`方法中进行潜在的阻塞操作（如加载图像） 。

```
import javax.swing.*;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.awt.event.*;
import java.util.Random;

public class SwingPaintDemo3 {

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            createAndShowGUI();
        }
    });
}

private static void createAndShowGUI() {
    System.out.println("Created GUI on EDT? "+
    SwingUtilities.isEventDispatchThread());
    JFrame f = new JFrame("Swing Paint Demo");
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.add(new MyPanel());
    f.pack();
    f.setVisible(true);
}
}

class MyPanel extends JPanel {

private int squareX = 50;
private int squareY = 50;
private int squareW = 20;
private int squareH = 20;
Image img;
Random r = new Random();

public MyPanel() {
    img = new BufferedImage(40,40,BufferedImage.TYPE_INT_RGB);

    setBorder(BorderFactory.createLineBorder(Color.black));

    addMouseListener(new MouseAdapter() {
        public void mousePressed(MouseEvent e) {
            img = new BufferedImage(
                r.nextInt(getWidth())+1,
                r.nextInt(getHeight())+1,
                BufferedImage.TYPE_INT_RGB);
            moveSquare(e.getX(),e.getY());
        }
    });
}

private void moveSquare(int x, int y) {
    int OFFSET = 1;
    if ((squareX!=x) || (squareY!=y)) {
        squareX=x;
        squareY=y;
        repaint();
    }
}

public Dimension getPreferredSize() {
    return new Dimension(250,200);
}

protected void paintComponent(Graphics g) {
    super.paintComponent(g);

    g.drawImage(img, 0, 0, null);
    g.drawString("This is my custom Panel!",10,20);
    g.setColor(Color.RED);
    g.fillRect(squareX,squareY,squareW,squareH);
    g.setColor(Color.BLACK);
    g.drawRect(squareX,squareY,squareW,squareH);
}
} 
```

# php - 云上Mysql中消费rabbitmq队列和插入消息？

> ID：16100736
> 
> 赞同：0
> 
> 时间：2013-04-19T08:49:29.810
> 
> 标签：php, push-notification, rabbitmq, publish-subscribe, appfog

我开发了一个 android 应用程序，它订阅一个队列并发布到其他队列。一次它将相同的消息发布到两个不同的队列，其中一个是名为“Queue”的队列，现在我需要从 appfog 实例订阅“Queue”并使用消息并将它们插入 mysql db。

我使用 codeigniter 为上述目的创建了一个 php 独立应用程序。由于某种原因，worker 应用程序失去了与 rabbitmq 的连接。我想知道做到这一点的最佳方法。appfog 上的工作应用程序如何能够维持应用程序重新启动。

我需要用什么样的东西来解决上述问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:18:11.760

你用的是什么版本的 RabbitMQ？在 3.0 中，默认情况下为连接启用了心跳。如果有定期断开连接（默认为 10 分钟），则可能是心跳断开连接。

您的客户端（希望）可以在连接协商期间配置更长的时间，或者您可以让您的 PHP 应用程序定期发送心跳。这是描述它[的公告帖子。](http://www.rabbitmq.com/blog/2012/11/20/whats-new-in-rabbitmq-3-0/)

# html - 为什么 HTML 中的标签在现实世界中具有各种 rel 属性值

> ID：16100739
> 
> 赞同：2
> 
> 时间：2013-04-19T08:49:40.673
> 
> 标签：html

正如[w3school.com](http://www.w3schools.com/tags/att_link_rel.asp)所描述的：

> ![在此处输入图像描述](https://i.stack.imgur.com/5Pg9B.png)

HTML5 中的标签`link`为 attribute 规定了 10 个值`rel`，但我总是发现网页中使用了许多其他值，例如：

```
<link rel="me" type="text/html" href="www.example.com"/> 
```

`me`属性没有任何价值`rel`，但它仍然被广泛使用。

为什么会这样？任何链接或建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:56:37.273

这些都是微格式。

```
rel=me 
```

是身份整合，用于指示配置文件等效性（用户指示跨不同站点的一个或多个身份、配置文件、URL 都代表同一用户的能力。也称为：配置文件聚合、配置文件等效性）

[http://microformats.org/wiki/rel-me](http://microformats.org/wiki/rel-me)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T08:57:29.593

[HTML 规范](http://www.w3.org/html/wg/drafts/html/master/links.html#other-link-types)允许自定义`rel`属性值：

> 对预定义的链接类型集的扩展可以在微格式 wiki[现有相对值页面中注册。[MFREL]](http://microformats.org/wiki/existing-rel-values#HTML5_link_type_extensions)
> 
> 任何人都可以随时自由编辑微格式 wiki 现有相对值页面以添加类型。

你不应该依赖 w3schools，因为那里有很多不正确的数据：[http ://w3fools.com/](http://w3fools.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:55:58.297

`rel="me"`用于从关于一个人的一个页面到关于同一个人的其他页面的超链接。

见： http: [//microformats.org/wiki/rel-me](http://microformats.org/wiki/rel-me)

# mercurial - Mercurial 2.1.1 - 确定变更集是否为合并

> ID：16100743
> 
> 赞同：0
> 
> 时间：2013-04-19T08:50:01.437
> 
> 标签：mercurial, merge, hg-log

在 Mercurial中，添加`2.4`了一个模板关键字`{p2rev}`，可用于确定变更集是否为合并。

```
hg log -r42 --template {p2rev} 
```

如果返回“-1”，则没有第二个父项，因此变更集*不是*合并，否则*是*合并。

但是这里的大多数开发人员仍然在 Mercurial 上`2.1.1`。在他们的机器上使用`{p2rev}`总是返回 [空白]。

我在 2.1.1 中尝试过：

```
hg log -r42 --template {parents} 
```

这给出了一些*奇怪*的输出：

*   如果只有 1 个父级（不是合并）：没有输出
*   如果有 2 个父母（合并）：父母双方的 {rev}:{ node **}**

**例如，确定变更集是否是 Mercurial *pre-2.4*中的合并的最佳方法是什么`2.1.1`？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:37:42.467

该[`hg parents`](http://selenic.com/hg/help/parents)命令可能会执行您想要的操作：

```
hg parents -r 42 --template "{node|short}\n" 
```

对于合并变更集，您将获得 2 行输出，对于非合并变更集，您将获得 1 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T13:12:39.813

如果

```
hg log -r"42 & merge()" --template x 
```

返回一个非空字符串，然后变更集 42 是一个合并。
如果有结果，模板将返回字母 x。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:18:08.560

我正在使用 Mercurial 2.2.2 (Ubuntu 12.10)，这似乎可行（使用*修订集*查询语言）：

```
$ hg log -r 'merge()'
changeset:   6:f75b34694a73
parent:      4:129b7b24f6b4
parent:      5:85771af34f42
[...]
summary:     Merge branch 'default' of /foo/proto

changeset:   12:04975792d1f3
parent:      10:42c64107845f
parent:      11:226623b54bd2
[...]
summary:     merged branch 'experimental-bar' into 'default' 
```

# sitemap - 在站点地图中以多种语言定义数千种产品

> ID：16100744
> 
> 赞同：0
> 
> 时间：2013-04-19T08:50:03.140
> 
> 标签：sitemap, product

我有一个在线商店，有超过 70.000 种产品。几个月后，我们将拥有超过 200.000 种产品。每个产品都有自己的 url，具体取决于语言，例如：

*   domain.com/es/aaabbbcccc/product_code
*   domain.com/en/aaabbbcccc/product_code
*   domain.com/fr/aaabbbcccc/product_code
*   domain.com/pt/aaabbbcccc/product_code
*   domain.com/de/aaabbbcccc/product_code

所有这些 url 都重定向到同一页面，但语言取决于“es”、“en”等。

我们希望 Google 为站点地图编制索引，以便它了解我们所有的产品，以便使用 Google 搜索找到它们。

我一直在阅读有关站点地图的内容，如果我没记错的话，它们应该包含网页中的所有可用 url，但我知道我们不能为每个产品放置 5 个 url，因为那样会得到一百万个 url。

我是否应该为每个产品只定义一个 url，这会产生数千个 url？或者有没有办法告诉谷歌一个网址的格式，所以没有必要明确定义所有这些？

# jquery - Firefox 20.0.1：阻止选择选项的单击事件处理程序

> ID：16100746
> 
> 赞同：0
> 
> 时间：2013-04-19T08:50:08.297
> 
> 标签：jquery, firefox

我有以下事件处理程序：

```
$(document).live('click', function(e) {
    alert('test');
}); 
```

如何防止在 select.option 单击时调用处理程序？处理程序仅在 Forefox 20.0.1 中调用。Chrome 和旧版本的 firefox 可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:54:06.647

未经测试，但这样的东西应该可以工作

```
$(document).on('click', function(e) {
    if ($('option').has(e.target).length === 0) {
        alert('test')
    }
}) 
```

# python - 如何在 CentOS 6.4 上安装 urwid 1.1.1？

> ID：16100751
> 
> 赞同：0
> 
> 时间：2013-04-19T08:50:26.940
> 
> 标签：python, linux, installation, centos, urwid

要在 CentOS 6.4 上安装 urwid 1.1.1，我已经尝试过：

```
yum install python-urwid 
```

安装 urwid 0.9.9。

然后我手动下载[了 urwid 1.1.1](http://excess.org/urwid/)并运行：

```
cd /mnt/hgfs/Shared/urwid-1.1.1
python ./setup.py install 
```

就像[在线手册](http://excess.org/urwid/wiki/Installation)说的那样。

这导致以下错误：

```
[root@localhost ~]# cd /mnt/hgfs/Shared/urwid-1.1.1
[root@localhost urwid-1.1.1]# python ./setup.py install
running install
running build
running build_py
running build_ext
building 'urwid.str_util' extension
gcc -pthread -fno-strict-aliasing -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -DNDEBUG -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -D_GNU_SOURCE -fPIC -fwrapv -fPIC -I/usr/include/python2.6 -c source/str_util.c -o build/temp.linux-x86_64-2.6/source/str_util.o
source/str_util.c:25:20: error: Python.h: No such file or directory
source/str_util.c:88: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:100: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:121: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:169: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:190: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c:191: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c:191: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c: In function ‘Py_DecodeOne’:
source/str_util.c:195: error: ‘pos’ undeclared (first use in this function)
source/str_util.c:195: error: (Each undeclared identifier is reported only once
source/str_util.c:195: error: for each function it appears in.)
source/str_util.c:197: error: ‘ret’ undeclared (first use in this function)
source/str_util.c:202: error: ‘text_len’ undeclared (first use in this function)
source/str_util.c: At top level:
source/str_util.c:319: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:351: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c:352: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c:352: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c: In function ‘Py_DecodeOneRight’:
source/str_util.c:354: error: ‘Py_ssize_t’ undeclared (first use in this function)
source/str_util.c:354: error: expected ‘;’ before ‘subret’
source/str_util.c:356: error: ‘pos’ undeclared (first use in this function)
source/str_util.c:360: error: ‘text_len’ undeclared (first use in this function)
source/str_util.c:360: error: ‘subret’ undeclared (first use in this function)
source/str_util.c:360: error: too many arguments to function ‘Py_DecodeOne’
source/str_util.c:361: error: ‘ret’ undeclared (first use in this function)
source/str_util.c: At top level:
source/str_util.c:377: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:413: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c:414: error: expected declaration specifiers or ‘...’ before ‘Py_ssize_t’
source/str_util.c: In function ‘Py_WithinDoubleByte’:
source/str_util.c:416: error: ‘Py_ssize_t’ undeclared (first use in this function)
source/str_util.c:416: error: expected ‘;’ before ‘i’
source/str_util.c:418: error: ‘pos’ undeclared (first use in this function)
source/str_util.c:421: error: ‘line_start’ undeclared (first use in this function)
source/str_util.c:425: error: too many arguments to function ‘Py_WithinDoubleByte’
source/str_util.c:432: error: ‘i’ undeclared (first use in this function)
source/str_util.c: At top level:
source/str_util.c:440: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:476: error: expected ‘)’ before ‘*’ token
source/str_util.c:519: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:546: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘Py_MovePrevChar’
source/str_util.c:576: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:599: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘Py_MoveNextChar’
source/str_util.c:630: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:653: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘Py_CalcWidth’
source/str_util.c:708: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:739: error: expected ‘)’ before ‘*’ token
source/str_util.c:835: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘*’ token
source/str_util.c:855: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘Str_UtilMethods’
source/str_util.c:874: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘initstr_util’
source/str_util.c: In function ‘main’:
source/str_util.c:882: warning: implicit declaration of function ‘Py_SetProgramName’
source/str_util.c:885: warning: implicit declaration of function ‘Py_Initialize’
source/str_util.c:888: warning: implicit declaration of function ‘initstr_util’
error: command 'gcc' failed with exit status 1
[root@localhost urwid-1.1.1]# 
```

当前安装了 Python 2.6 和 gcc 4.4.7。

任何人都可以解释错误并提出解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:56:13.680

`yum install python-devel`应该可以解决您的问题，因为您缺少的是编译所需的 Python.h C 头文件。

# java - java连接mysql数据库失败

> ID：16100764
> 
> 赞同：0
> 
> 时间：2013-04-19T08:51:00.510
> 
> 标签：java, mysql, database-connection

我正在使用 tomcat 创建一个 vaadin Web 应用程序，并在另一台服务器上拥有一个外部数据库。无论如何，我都无法连接到外部数据库。我什至使用 j2se jre 1.6 创建了一个新的纯 java 项目并尝试连接到数据库，但连接仍然失败。我下载了 mysql 驱动程序并将其复制到 ~/Library/Java/Extensions 中，甚至从构建路径中添加/删除，但仍然没有任何改变。我关闭了防火墙，我不知道还能做什么。我相信我的代码是正确的，但无论如何：

```
String host = "jdbc:mysql://db.host.sk:3306/myDB";
    String name = "name";
    String pass = "pass";
    Connection connection;

    try {
        Class.forName("com.mysql.jdbc.Driver").newInstance();
        System.out.println("Connecting to database...");
        connection = DriverManager.getConnection(host, name,
                pass);
        System.out.println("SUCCESSFUL!!!");

    } catch (SQLException e) {
        System.out.println("Connecting to database failed");
        System.out.println(e.getMessage());
        e.printStackTrace();
    }
    catch (ClassNotFoundException e) {
        e.printStackTrace();
    } catch (InstantiationException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    }
} 
```

你能帮我解决这个问题吗？谢谢你。

编辑

堆栈跟踪：

```
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1121)
at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:355)
at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2479)
at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2516)
at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2301)
at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:834)
at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at     sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:416)
at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:317)
at java.sql.DriverManager.getConnection(DriverManager.java:579)
at java.sql.DriverManager.getConnection(DriverManager.java:221)
at DatabaseHelper.main(DatabaseHelper.java:17)
Caused by: java.net.ConnectException: Operation timed out
at java.net.PlainSocketImpl.socketConnect(Native Method)
at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
at java.net.Socket.connect(Socket.java:579)
at java.net.Socket.connect(Socket.java:528)
at java.net.Socket.<init>(Socket.java:425)
at java.net.Socket.<init>(Socket.java:241)
at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:259)
at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:305)
... 15 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:57:13.723

检查您的数据库服务是否已启动并在专用服务器上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T10:04:51.170

但是，以前从未遇到过这种情况，我阅读了几篇文章并发现可能的原因可能是 Java 和数据库之间存在阻止连接的东西，例如防火墙**或**服务器已关闭/不支持 tcp/ip**或**jdbc url 中的主机名是本地 dns 服务器等无法识别。好吧，您可以尝试以下建议（值得一试）：

1.  转到控制面板中的 Windows 服务并启动 MySQL 服务。
2.  检查您在数据库服务器上设置的等待超时并将其更新为 10000

    > 设置全球 wait_timeout = 10000;

*您还可以查看Soheil*在此处发布的具有良好答案的类似问题： [Solving a "communications link failure" with JDBC and MySQL](https://stackoverflow.com/questions/6865538/solving-a-communications-link-failure-with-jdbc-and-mysql)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T14:12:00.807

我（不）幸运地最终在我的机器上使用了 mysql 和 eclipse，现在一切运行顺利。很遗憾我没有让它像我想要的那样工作，但目前的方式更适合我。我不必进行任何更改和配置，终于可以开始编码了。我感谢您的所有帮助。

# linux - 哪个版本的linux内核开始支持sd/sdio version 3.00？

> ID：16100765
> 
> 赞同：0
> 
> 时间：2013-04-19T08:51:11.303
> 
> 标签：linux, git, kernel, device, linux-device-driver

- 你好呀，

这是关于 linux 内核 sd/mmc 子系统的问题。

目前我们使用的linux内核版本是2.6.29.4。

现在，有一个支持 SD/SDIO 3.00 版本的 SD/MMC 控制器集成到 SoC 中，因此，我们需要更新 linux 内核以支持 SD/SDIO 3.00 版本。

有人知道 linux 内核从哪个版本开始支持 SD/SDIO 3.00 版吗？

或者，有什么方法可以实现我们的目标？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:43:35.813

为了将来参考，您总是可以通过在内核源代码中搜索来快速回答这个问题和类似问题。最有用的命令是`git grep`和`git log -S<symbol>`。

只需克隆内核源代码：

```
git clone git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
cd linux 
```

然后运行这样的命令来找到你想要的：

```
git log -SSDIO_SD_REV_3_00 
```

这给出了以下结果（只有一次提交！）：

```
commit a303c5319c8e6ab0e744ebca118da8420043b2c3
Author: Philip Rakity <prakity@marvell.com>
Date:   Mon Nov 14 19:14:38 2011 -0800

mmc: sdio: support SDIO UHS cards

This patch adds support for sdio UHS cards per the version 3.0
spec.
... 
```

现在，您可以使用 git describe 来获取最接近该提交的内核版本：

```
git describe --contains a303c5319c8e6ab0e744ebca118da8420043b2c3 
```

打印：

```
v3.3-rc1~72^2~51 
```

换句话说，它在内核版本 3.3 中成为正式版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T10:00:17.840

Linux Kernel 3.3 版开始支持 SD/SDIO 3.00 版。

看到这个提交

[https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/include/linux/mmc/sdio.h?h=linux-3.3.y&id=b4625dab2c618eb87e177761dda3182b4cfaa604](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/include/linux/mmc/sdio.h?h=linux-3.3.y&id=b4625dab2c618eb87e177761dda3182b4cfaa604)

内核 3.3（找到`SDIO_SD_REV_3_00`定义） [https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/include/linux/mmc/sdio.h?h=linux-3.3 .y](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/include/linux/mmc/sdio.h?h=linux-3.3.y)

内核 3.2（未找到`SDIO_SD_REV_3_00`定义）： [https ://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/include/linux/mmc/sdio.h?h=linux -3.2.y](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/tree/include/linux/mmc/sdio.h?h=linux-3.2.y)

# c++ - 排序数组的难度

> ID：16100771
> 
> 赞同：2
> 
> 时间：2013-04-19T08:51:20.097
> 
> 标签：c++, arrays

我需要处理来自最大输入文件的数据。100,000 行，如下所示：

> 2014269619 Sally Clare Smith 女 95

这些是身份证号、姓名（2 或 3 个字）、性别和考试成绩。由制表符分隔。

我必须创建一个最大值数组。每个属性的长度为 100,000。此外，输入文件中的第一个数字将是该文件中的行数。所以，我创建了长度为 100,000 的数组。

一旦我设置了一个数组，我将使用给定的函数按 Name 的字母字符串顺序（升序）对名称进行排序，然后将它们放入输出文件中。但是，我不需要使用此特定功能。

我的挑战是，尽管给定函数对姓名进行排序，但它不会将 ID、性别和分数与姓名一起移动，从而导致数据库无用。

我尝试按以下方式对第一部分（设置数组）进行操作，但这似乎是错误的：

```
#include <iostream>
#include <fstream>
using namespace std;

void  ordering_sort( double  x[],  int  length)
{   
    int  i,  j,  k;
    double  t;

    for  (i=0;  i<length-1;  ++i)  {        
        k = i;       //find next smallest elm, x[k]

        for  (j=i+1;  j< length;  ++j)
            if  (x[k] > x[j])  k = j;

        //swap x[i] with x[k] 
        t = x[i];   x[i] = x[k];  x[k] = t;   
    }
}

int main () {

    ifstream fin;
    ofstream fout;

    fin.open("input.txt");
    fout.open("output.txt");

    if (fin.fail()) {
        cout << "Fail to open inout.txt" << endl;
        exit(1);
    }

    int ID [100000];
    string name [100000];
    string gender [100000];
    int score [100000];

    int y = 0;

    // In the following part, I am trying to extract the information into the different arrays,
    // one by one, increasing the number of the element from 0 up till x. 
    // Problem is that getline does not work for int arrays but I must use int.

    for (int y=0 ; y<x, y++) {
        getline(fin, ID [y], '\t'); // This does not work.
        getline(fin, name [y], '\t');
        getline(fin, gender [y], '\t');
        getline(fin, score [y], '\t'); //This does not work either.
        break;
    }

    ordering_sort( name,  int  length)

    // trying to use the function, which will not work as of now 
```

基本上，我需要帮助：

*   将输入文件中的数据提取到数组中，确保排序将应用于每一行，而不仅仅是单个数组（因此整行将被排序）
*   找到一种方法让 getline 为 int 数组工作
*   我会将数据输出到输出文件中，但这应该不是问题。
*   所有这些都必须使用数组来完成，而不是使用结构、向量、映射。

其他图书馆都很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:14:06.663

从技术上讲，这段代码不是有效的标准 C++，它依赖于编译器扩展（特别是 gcc 风格的）

```
int ID [x];
string name [x];
string gender [x];
int score [x]; 
```

因此，要使其成为有效的标准代码，您必须使用`new`. 但我将忽略这一点，因为我希望您显示的代码可以编译，这对于这个项目来说已经足够了。

> *   找到一种方法让 getline 为 int 数组工作

由于这些项目由标签分隔（据我所知），因此您实际需要做的就是：

```
cin >> ID[y]; 
getline(cin, name[y], '\t');
... 
cin >> score[y]; 
```

至于排序部分，有两种解决方案：

1.  正如评论中所建议的，您对索引表进行排序。
2.  在您的排序功能中，当您交换时，您交换所有项目。

索引表的排序是这样的：

```
if (score[index[i]] > score[index[j]]) swap(index[i], index[j]); 
```

交换一切方法将是这样的：

```
if (score[i] > score[j])
{
     swap(ID[i], ID[j]);
     swap(name[i], name[j]);
     swap(gender[i], gender[j]);
     swap(score[i], score[j]);
} 
```

# c# - 消息队列和异步/等待

> ID：16100773
> 
> 赞同：11
> 
> 时间：2013-04-19T08:51:27.237
> 
> 标签：c#, message-queue, async-await

我只想以异步方法接收我的消息！它冻结了我的用户界面

```
 public async void ProcessMessages()
    {
        MessageQueue MyMessageQueue = new MessageQueue(@".\private$\MyTransactionalQueue");
        MyMessageQueue.Formatter = new XmlMessageFormatter(new Type[] { typeof(string) });

        while (true)
        {
            MessageQueueTransaction MessageQueueTransaction = new MessageQueueTransaction();
            MessageQueueTransaction.Begin();

            ContainError = false;
            ProcessPanel.SetWaiting();

            string Body = MyMessageQueue.Receive(MessageQueueTransaction).Body.ToString();

            //Do some process with body string.

            MessageQueueTransaction.Commit();
        }
    } 
```

我只是像任何常规方法一样调用该方法，并且它没有工作！当我使用 BackgroundWorkers 而不是 async/await 时，此代码可以正常工作

想法？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-19T12:37:58.450

正如斯蒂芬所写，异步不会在线程中运行您的代码。幸运的是，您可以使用[TaskFactory.FromAsync](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskfactory.fromasync.aspx)和[MessageQueue.BeginReceive](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.beginreceive.aspx) /MessageQueue.EndReceive 来异步接收消息：

```
 private  async Task<Message> MyAsyncReceive()
    {
        MessageQueue queue=new MessageQueue();
        ...
        var message=await Task.Factory.FromAsync<Message>(
                           queue.BeginReceive(),
                           queue.EndReceive);

        return message;

    } 
```

您应该注意，虽然没有使用事务的 BeginReceive 版本。来自 BeginReceive 的文档：

> 不要对事务使用异步调用 BeginReceive。如果要执行事务性异步操作，请调用 BeginPeek，并将事务和（同步）Receive 方法放入为 peek 操作创建的事件处理程序中。

这是有道理的，因为无法保证您必须等待多长时间才能等待响应，或者哪个线程最终将处理完成的调用。

要使用事务，您将编写如下内容：

```
 private  async Task<Message> MyAsyncReceive()
    {
        var queue=new MessageQueue();

        var message=await Task.Factory.FromAsync<Message>(queue.BeginPeek(),queue.EndPeek);

        using (var tx = new MessageQueueTransaction())
        {
            tx.Begin();

            //Someone may have taken the last message, don't wait forever
            //Use a smaller timeout if the queue is local
            message=queue.Receive(TimeSpan.FromSeconds(1), tx);
            //Process the results inside a transaction
            tx.Commit();
        }
        return message;
    } 
```

**更新**

正如 Rob 指出的那样，原始代码使用了`message`from 的返回值`Peek`，它可能在`Peek`和之间发生了变化`Receive`。在这种情况下，第二条消息将丢失。

但是，如果另一个客户端读取队列中的最后一条消息，仍然有可能阻塞。为了防止这种情况，`Receive`应该有一个小的超时。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-19T12:17:39.010

[`async`不在后台线程上运行您的代码。](http://blogs.msdn.com/b/pfxteam/archive/2012/04/12/async-await-faq.aspx#6)您上面的代码应该引起编译器警告，告诉您您的方法将同步运行。

如果要在后台线程上执行方法，请使用`TaskEx.Run`：

```
public void ProcessMessages()
{
  ...
}

TaskEx.Run(() => ProcessMessages()); 
```

# nagios - 如何在 nagios 上设置 Mk livestatus？

> ID：16100780
> 
> 赞同：1
> 
> 时间：2013-04-19T08:52:25.087
> 
> 标签：nagios

我正在使用`Check_MK`基于`Nagios`.

```
Check_MK Version: 1.2.0p4
OS: Linux
Nagios Core 3.2.3 
```

我想`Nagios`使用`MK Livestatus`. 我很好奇，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:02:02.313

# javascript - 请帮助理解 JavaScript 函数调用。它是闭包还是递归？

> ID：16100783
> 
> 赞同：0
> 
> 时间：2013-04-19T08:52:28.557
> 
> 标签：javascript, d3.js

我正在使用 D3js 到 Tree Layout 来呈现一些数据，这里的工作结果：

[http://jsfiddle.net/chrisloughnane/vV3Sc/](http://jsfiddle.net/chrisloughnane/vV3Sc/)

我想学习如何正确导航树中的节点。因此，例如，我可以设置一个函数来将所有节点设置为通过单击打开/关闭，或者可能有一个类别索引，以便访问者可以单击`year one`并且该节点和所有子节点都将设置为打开。

我已经浏览了代码，但我无法理解

```
function toggleAll(d) {
    if (d.children) {
        d.children.forEach(toggleAll);
        toggle(d);
    }
}

root.children.forEach(toggleAll); 
```

对我来说，我用 the 调用函数，`root`然后如果传递的节点有每个`children`我传递给它的函数名？！当没有更多时，即它已达到 a时，它将值从to或反转切换。`child``node``children``leaf``children``_children`

当我通过 forEach 时发生了什么`toggleAll`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:18:49.940

这里的关键是`forEach`，这是一个原生 javascript 函数。（[这里的](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach)文档）

此方法为数组的每个元素执行回调 ( `toggleAll`)。参数将`d`通过 传递给`toggleAll`函数`forEach`。所以它不是来自关闭。

现在，由于再次调用 toggleAll `forEach`，它确实进入到树的下一层的递归模式，直到`d.children`为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:21:11.447

如果您不了解正在发生的事情，您是如何生成此工作代码的？

> 当我传递它toggleAll时会发生什么？

你明白这个问题中的“它”指的是什么吗？

无论如何，您正在使用 JavaScript 数组（或至少是类似数组的东西），您正在调用[forEach](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach)方法，该方法接受一个函数并在每个元素上调用该函数。因此，当您第一次调用 forEach on 时`root.children`，`toggleAll`会调用数组中的每个元素`root.children`。然后，您再次（现在递归地）为任何后续子节点调用 forEach。

# perl - 如何比较哈希值

> ID：16100788
> 
> 赞同：1
> 
> 时间：2013-04-19T08:52:42.493
> 
> 标签：perl

我想比较哈希值如下。我需要检查......

---> 如果所有哈希值都是“SUCCESS”，则只打印一次消息。

---> 否则，如果单个值是“FAILURE”，则仅打印另一条消息一次。

**请注意，无论哪种情况，我都只**需要打印一次消息

 **这是我的代码（其中一个值为“FAILURE”）

```
#!/usr/bin/perl -w
use strict;

my $hash = {
                1   =>  'SUCCESS',
                2   =>  'SUCCESS',
                3   =>  'SUCCESS',
                4   =>  'FAILURE',
            };

foreach my $key ( keys %$hash )
{
    if ($hash->{$key} eq 'FAILURE')
    {
        print "One of the Keys encoutered failure. Cannot proceed with Automation \n";
        last;
    }
    elsif ($hash->{$key} eq 'SUCCESS')
    {
        next;
        print "All the Keys were successful. Proceeding to Automation \n";
    }
} 
```

输出：

```
One of the Keys encoutered failure. Cannot proceed with Automation 
```

当其中一个键包含“FAILURE”时，这可以正常工作。

但是.....当所有值都是“成功”时，这不起作用：

```
#!/usr/bin/perl -w
use strict;

my $hash = {
                1   =>  'SUCCESS',
                2   =>  'SUCCESS',
                3   =>  'SUCCESS',
                4   =>  'SUCCESS',
            };

foreach my $key ( keys %$hash )
{
    if ($hash->{$key} eq 'FAILURE')
    {
        print "One of the Keys encoutered failure. Cannot proceed with Automation \n";
        last;
    }
    elsif ($hash->{$key} eq 'SUCCESS')
    {
        next;
        print "All the Keys were successful. Proceeding to Automation \n";
    }
} 
```

输出：

```
huh..there is no output. It brings me back to the bash shell. 
```

现在，如果我`next`从`else`循环中注释掉，那么它会打印 hte 语句 4 次。

```
All the Keys were successful. Proceeding to Automation 
All the Keys were successful. Proceeding to Automation 
All the Keys were successful. Proceeding to Automation 
All the Keys were successful. Proceeding to Automation 
```

**问题**：

因此，在这种情况下，我只想打印**一次“所有密钥都成功。继续自动化”的语句。** 我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T08:57:13.933

您的使用`next`导致循环立即跳到下一次迭代。这就是您看不到任何输出的原因——程序执行永远不会`print`到达`next`.

您可以做的是使用标志变量：

```
#!/usr/bin/perl -w
use strict;

my $hash = { 1   =>  'SUCCESS',
             2   =>  'SUCCESS',
             3   =>  'SUCCESS',
             4   =>  'SUCCESS',
           };

my $failure = 0;
foreach my $key (keys %$hash)
{
  if ($hash->{$key} eq 'FAILURE')
  {
    $failure = 1;
    last;
  }
}

if ($failure == 1) {
  print "One of the Keys encoutered failure. Cannot proceed with Automation \n";
} else {
  print "All the Keys were successful. Proceeding to Automation \n";
} 
```**

# sharepoint - 搜索 Web 服务中的安全修整

> ID：16100792
> 
> 赞同：0
> 
> 时间：2013-04-19T08:53:10.357
> 
> 标签：sharepoint, search, sharepoint-2007, ssp, security-trimming

我有一个使用 SharePoint 2007 搜索 Web 服务 ( `http://localhost/_vti_bin/search.asmx`) 的 Web 应用程序。我的范围包含多个内容源，它们都包含业务数据（通过外部数据库上的 SQL 查询抓取内容）。我需要这些内容源之一来为我提供安全修整结果。简单来说，我有两张表：

*   表 A 内容：NodeId、Title、Content
*   具有权限的表 B：NodeId、用户名

现在，爬虫索引表 A 没有问题。不过，我的问题是，在使用查询 Web 服务进行搜索时，我找不到对结果进行安全修整的解决方案。Web 服务使用服务帐户，没有模拟登录用户。是否有可能以某种方式将用户名传递给查询包对象，或者以任何其他方式检查表 B，用户名是否有权访问 NodeId？

由于我打算迁移到SP2013，也许你们中的一些人也知道这个Sharepoint版本的解决方案，如果在MOSS2007中没有办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-22T14:54:43.013

有 3 个主要选项可用于对 SharePoint 搜索结果进行安全修整。他们包括：

1.  ISecurityTrimmerPre - SharePoint 2013 中的新增功能。允许在执行搜索查询之前为用户添加其他声明
2.  ISecurityTrimmerPost - 在早期版本的 SharePoint 中也称为 ISecurityTrimmer2。允许在执行搜索查询后逐一修剪搜索结果
3.  Business Connectivity Services Indexing Connectors - 允许您在搜索索引器对内容源进行爬网时向它提供 ACL

有一组很棒的[博客文章](http://blogs.msdn.com/b/security_trimming_in_sharepoint_2013/)展示了如何实现每个选项。

[此外，这里是关于自定义安全修整](http://channel9.msdn.com/Events/SharePoint-Conference/2012/SPC049)的 SharePoint 会议 2012 会议的精彩视频。

高温高压

-尤金

# android - RESTful Web 服务或 SOAP

> ID：16100796
> 
> 赞同：0
> 
> 时间：2013-04-19T08:53:15.810
> 
> 标签：android, rest, mobile, soap

我将开发将从移动设备上使用的 Web 服务，移动设备可以是 Android、iPhone、Blackberry、Windows Phone。所以我的问题是哪些网络服务适合移动场景。我认为 REST 会更好，但其他因素呢？所以我只是想知道当我们开发将从移动设备使用的 Web 服务时应该考虑哪些因素？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:59:26.803

一般来说，我会推荐 REST，它是更新且不断增长的 API 方法，但它并不适合所有需求。例如，如果您打算让一些仅使用 SOAP 的现有应用程序连接到您，您可能会考虑使用 SOAP 甚至同时拥有这两种 API。

我会推荐一些阅读：

[比较和对比 REST 和 SOAP Web 服务？](https://stackoverflow.com/questions/10975863/compare-and-contrast-rest-and-soap-web-services)

[http://www.infoq.com/articles/rest-soap-when-to-use-each](http://www.infoq.com/articles/rest-soap-when-to-use-each)

# delphi - 串行 (COM) 端口名称或标识

> ID：16100798
> 
> 赞同：5
> 
> 时间：2013-04-19T08:53:18.933
> 
> 标签：delphi

我有一个使用 cport 访问多个串行端口的程序。

要进行配置，到目前为止，我只是在一个组合框中列出了所有可用的 comport 以进行选择，但是越来越多的带有（虚拟）串行接口的驱动程序使最终用户的配置变得很麻烦。

当前的检测适用于 createfile()，但存在的问题是您只能获得存在/不存在并且可能“忙”作为信息。

但是为了改进，我需要每个 COM 端口一个标识字符串，例如它所连接的硬件设备/驱动程序（设备管理器）。这将使用户更容易缩小范围（因为我们提供有限数量的串行卡）

可能它可以从 WMI 获得，但那是一片丛林，sb 是否有更具体的信息，或者更好的代码？

（Delphi XE3，Win7+，没有需要额外安装或部署的解决方案请）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-19T18:12:02.130

如果您想枚举 COM 端口以获得友好名称，您可以使用`SetupAPI`和[`GUID_DEVINTERFACE_COMPORT`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff545821%28v=vs.85%29.aspx)设备接口类。

试试这个样本

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  Windows,
  SysUtils,
  JvSetupApi;

const
  GUID_DEVINTERFACE_COMPORT:TGUID='{86E0D1E0-8089-11D0-9CE4-08003E301F73}';

procedure EnumerateCOMPorts;
var
   cbRequired : DWORD;
   hdev     : HDEVINFO;
   idev     : Integer;
   did      : TSPDeviceInterfaceData;
   pdidd    : PSPDeviceInterfaceDetailData;
   PropertyBuffer : array[0..255] of Char;
   DeviceInfoData: TSPDevInfoData;
   PropertyRegDataType: DWORD;
   RequiredSize: DWORD;
begin
  // enumerate the com ports
  hdev :=  SetupDiGetClassDevs(@GUID_DEVINTERFACE_COMPORT, nil, 0,  DIGCF_PRESENT OR DIGCF_DEVICEINTERFACE);
  if ( INVALID_HANDLE_VALUE <>  THandle(hdev) ) then
  begin
    try
      idev:=0;
      ZeroMemory(@did, SizeOf(did));
      did.cbSize := SizeOf(did);
      repeat
        if (SetupDiEnumDeviceInterfaces(hdev, nil, GUID_DEVINTERFACE_COMPORT, idev, did)) then
        begin
            cbRequired := 0;
            SetupDiGetDeviceInterfaceDetail(hdev, @did, nil, 0, cbRequired, nil);
           if (ERROR_INSUFFICIENT_BUFFER= GetLastError()) then
           begin
              pdidd:=AllocMem(cbRequired);
              try
                pdidd.cbSize := SizeOf(TSPDeviceInterfaceDetailData);
                DeviceInfoData.cbSize:= SizeOf(DeviceInfoData);
                RequiredSize:=0;
                if (SetupDiGetDeviceInterfaceDetail(hdev, @did, pdidd, cbRequired, RequiredSize, @DeviceInfoData)) then
                begin

                 PropertyRegDataType:=0;
                 RequiredSize:=0;
                 if SetupDiGetDeviceRegistryProperty(hdev, DeviceInfoData, SPDRP_FRIENDLYNAME, PropertyRegDataType,  PBYTE(@PropertyBuffer[0]), SizeOf(PropertyBuffer), RequiredSize) then
                  Writeln(Format('Friendly Name - %s',[PropertyBuffer]));

                 if SetupDiGetDeviceRegistryProperty(hdev, DeviceInfoData, SPDRP_DEVICEDESC, PropertyRegDataType,  PBYTE(@PropertyBuffer[0]), SizeOf(PropertyBuffer), RequiredSize) then
                  Writeln(Format('Description   - %s',[PropertyBuffer]));

                 if SetupDiGetDeviceRegistryProperty(hdev, DeviceInfoData, SPDRP_LOCATION_INFORMATION, PropertyRegDataType,  PBYTE(@PropertyBuffer[0]), SizeOf(PropertyBuffer), RequiredSize) then
                  Writeln(Format('Location      - %s',[PropertyBuffer]));
                end
                else
                RaiseLastOSError;
              finally
                FreeMem(pdidd);
              end;
           end;
        end
        else
        Break;
        inc(idev);
      until false;
    finally
      SetupDiDestroyDeviceInfoList(hdev);
    end;
  end;
end;

begin
  try
    if not LoadsetupAPI then exit;
     EnumerateCOMPorts;
  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
  readln;
end. 
```

这将返回类似的东西

![在此处输入图像描述](https://i.stack.imgur.com/6PZvc.png)

注意：该`JvSetupApi`单元是 JVCL 库的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T14:35:10.643

您可以将 HKEY_LOCAL_MACHINE \HARDWARE\DEVICEMAP\SERIALCOMM 用于 COMxx 样式的短名称。请记住指定只读访问权限以避免管理员权限/ UAC 必要性。您可以看到 usb232 适配器和真实的通讯端口。

您也可以检查 HKEY_LOCAL_MACHINE \SYSTEM\CurrentControlSet\Enum\Root\PORTS 但这似乎有点棘手。

# java - 在未安装 MS Access 的情况下将 Java 连接到 MS Access 数据库

> ID：16100808
> 
> 赞同：1
> 
> 时间：2013-04-19T08:53:47.613
> 
> 标签：java, ms-access

我创建了一个 CRUD 应用程序，应用程序的连接方法如下所示。我已经在我的计算机上对其进行了测试并且工作正常，但是在另一台未安装 MS Access 的计算机上进行测试时，它正在抛出`NullPointerException`.

那么我应该怎么做才能纠正这个问题呢？是否有任何用于连接到 .mdb 文件的库？

这些也应该在 Linux 上运行。如果库可用，我可以将 .mdb 文件转换为 Open Office Base...

```
void DoConnect()
{
    try{
    String current = new java.io.File( "." ).getCanonicalPath();
    current+="\\DataBases\\Quiz.mdb";
    String host = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)};DBQ="+current+";";
    String uName = "";
    String uPass = "";
    con=new Connection[Size];
    stmt=new Statement[Size];
    for(int i=0;i<Size;i++)
    {
        con[i]=DriverManager.getConnection(host, uName, uPass);
        stmt[i]=con[i].createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,ResultSet.CONCUR_UPDATABLE);
    }
    ts=stmt[0].executeQuery("SELECT * FROM Quiz");
    ts.first();
    rs=stmt[1].executeQuery("SELECT ANSW FROM Quiz");       

    System.out.print(rs.getString("STM1"));
    }catch (IOException | SQLException err) {

    }      
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:42:28.793

> 是否有任何用于连接 mdb 文件的库？

是的，有。Jet 数据库引擎包含在 Windows 中，但只有 32 位版本可用。如果您的应用程序作为 64 位进程运行，那么您需要在计算机上安装 64 位版本的 Access 数据库引擎（也称为 ACE）。您可以在此处下载 Access 数据库引擎：

[http://www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

请注意，要使用 Access 数据库引擎，您可能必须将连接字符串调整为...

```
String host = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};DBQ="+current+";"; 
```

*...如果这在没有*安装 Access 数据库引擎的32 位机器上不起作用（即，只有 Jet 数据库引擎的机器），那么您的代码可能必须

1.  首先尝试 Jet 连接字符串（即您的原始连接字符串），如果失败则

2.  尝试 ACE 连接字符串（即，此答案中的那个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T15:29:39.073

如果您没有在所有客户端计算机上安装 Access，连接到 Access 并不是一件容易的事。此外，Access 数据库规模庞大。所以我目前正在使用非常易于使用的 H2 数据库。关于大小，在我将 140 Mb Access 数据库复制到 H2 后，文件只有 732 Kb！

更多信息可以在[这里找到](http://www.h2database.com/html/tutorial.html)

# mysql - sql没有结果，因为空的左连接

> ID：16100810
> 
> 赞同：0
> 
> 时间：2013-04-19T08:53:50.907
> 
> 标签：mysql, sql

所以我有这个查询：

```
SELECT 
    AED.aId, CJ.* 
FROM 
    AED
        LEFT JOIN 
            Cronjob as CJ 
                ON CJ.aID = AED.aId 
WHERE 
                AED.aStatus = '1'
        AND 
                (
                        CJ.cjDatum < CURRENT_DATE - INTERVAL 14 DAY 
                AND
                        AED.aRegistratie > CURRENT_DATE - INTERVAL 10 YEAR
                )
        OR
                ( 
                        CJ.cjStatus = '9' 
                OR 
                        CJ.cjStatus = '2'
                ) 
```

问题是，Cronjob 表是空的，如果它是空的，仍然想给所有来自 AED 的 ID，状态为 1

我找不到任何使用完整的东西，所以我希望你们能帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:57:03.330

您应该将所有 CJ 条件移动到连接的 ON 子句中。

```
ON (
  CJ.aID = AED.aId 
  AND (cjStatus in ('2','9') OR cjDatum < CURRENT_DATE - INTERVAL 14 DAY )) 
```

选项二是将它们留在 WHERE 中，但要为 cjStatus 和朋友为 NULL 的情况做出规定（如果没有找到匹配项，它们将是 NULL）。

```
OR cjStatus IS NULL 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T09:02:41.103

当没有关联的 CronJob 时，过滤器`CJ.cjStatus = '9'`（例如）返回 false，因为`CJ.cjStatus`为 null。这就是 LEFT JOIN 所做的，当没有对应关系时它返回空字段。

要在要 LEFT JOIN 的表上添加过滤器，过滤器子句必须在连接子句中，如下所示：

```
SELECT AED.aId
     , CJ.* 
FROM AED
    LEFT JOIN Cronjob as CJ 
        ON CJ.aID = AED.aId 
        AND (CJ.cjDatum < CURRENT_DATE - INTERVAL 14 DAY 
             AND AED.aRegistratie > CURRENT_DATE - INTERVAL 10 YEAR
             )
        OR (CJ.cjStatus = '9' OR CJ.cjStatus = '2')
WHERE AED.aStatus = '1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:57:39.157

添加`OR (CJ.aid is null)`到条件的 AND 部分：

```
SELECT 
    AED.aId, CJ.* 
FROM 
    AED
        LEFT JOIN 
            Cronjob as CJ 
                ON CJ.aID = AED.aId 
WHERE 
                AED.aStatus = '1'
        AND 
             (  
              (
                        CJ.cjDatum < CURRENT_DATE - INTERVAL 14 DAY 
                AND
                        AED.aRegistratie > CURRENT_DATE - INTERVAL 10 YEAR
                ) 
              OR (CJ.aid is null)
              ) 

        OR
                ( 
                        CJ.cjStatus = '9' 
                OR 
                        CJ.cjStatus = '2'
                ) 
```

# php - 三维（或更多）标记系统？PHP / MySQL 数据库架构

> ID：16100814
> 
> 赞同：2
> 
> 时间：2013-04-19T08:54:07.443
> 
> 标签：php, mysql, database-design, tagging

很明显，我出来是带着一个头脑风暴的问题。那，或者我太菜鸟了，看不到任何明显的答案：

如何实现一个标签系统，其中每个标签与网站的每个用户都有特定的关系？

我试图实现的一个非常简单的例子是系统跟踪用户为每个标签所做的页面点击的情况。例如，多个标签关键字被“标记”到网站的每个页面。关于环境科学的页面可能会被标记为“生物学”和“社会学”等关键字。当用户 A 访问该页面时，用户 A 每次查看“生物学”时都会将一个数字加 1，而“社会学”则会再计算一次。

因此，我们最终得到了显示一个人喜欢特定标签的程度的记录。

使用 MySQL 执行此操作的最有效方法是什么，是否可以将其用于如下所示的两表系统？

```
Table 1: Tags

 - tag_title
 - tagged_pages
 - user_likes

Table 2: Users

 - user_id 
```

添加更多的表列是完全可以的。我要避免的是复制标签表和其中的所有记录。

到目前为止，我想出的只是将`user_likes`每个标签的字段格式设置为：`101-12, 99-3, 156-14`...等。然后使用 PHP explode() 将 user_id 与喜欢的数量分开。

非常感谢您的创造性见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T10:29:40.810

永远不要在一个列中放置多个信息。这是规范化的第一条规则，你真的不应该打破它。

我认为您需要更多表来正确构建它（并正确规范化它）

```
users
    id
    name

tags
    id
    name

pages
    id

page_tags
    page_id
    tag_id

user_page_hits
    user_id
    page_id
    hits 
```

现在，如果您想知道用户对某个标签的喜爱程度，您可以在这些表上创建一个视图，例如

```
user_tag_hits
    as select u.name, t.name, sum(uph.hits) hits from users u
              join user_page_hits uph on uph.user_id = u.id
              join page_tags pt on pt.page_id = uph.page_id
              join tags t on t.id = pt.tag_id
              group by u.name, t.name 
```

这会产生类似的结果

```
username tagname  hits
me  tag1    112
me  tag2    112
me  tag3    70
me  tag4    4
me  tag5    4 
```

# vb.net - DataGridView 行在将其数据源设置为 Linq 到实体查询后是只读的

> ID：16100815
> 
> 赞同：1
> 
> 时间：2013-04-19T08:54:08.897
> 
> 标签：vb.net, winforms, entity-framework, datagridview, linq-to-entities

我有这个简单的函数，它返回一个员工外出列表

```
Function LoadEmployees() As IQueryable
        Dim employeeList = From EMP In dbTables.tableOutings _
                         Select b.OutingID, b.EmployeeMaster.EmpID, b.EmployeeMaster.EmpNumber, _
                         b.EmployeeMaster.EmpName, b.DateEngaged, b.NoticeInLiue, b.TransportCalculation, b.Others
        Return employeeList
    End Function 
```

在我的 formLoad 事件中，我将上述函数设置为 Windows 窗体 DataGridView 控件的 DataSource，例如

```
Private Sub EmployeeBenefitsForm_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    dgvEmployeeOutings.AutoGenerateColumns = False
    dgvEmployeeOutings.DataSource = LoadEmployees()

End Sub 
```

数据已正确加载到 Datagridview 中，但是我需要解决的问题是正在获取 ReadOnly datagridview。我无法编辑任何列中的数据。我希望用户能够从该 datagridview 编辑数据。

为什么网格是ReadOnly。是不是因为数据是从两个不同的表返回的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:58:59.613

我在这里问了一个非常相似的问题，它可能有助于将[Linq To Entities 查询结果绑定到 datagridview](https://stackoverflow.com/questions/2460599/binding-linq-to-entities-query-results-to-a-datagridview)。

您还可以在此处查看另一个相关问题和答案[Linq-to-entities Include 方法不会加载相关记录](https://stackoverflow.com/questions/973794/linq-to-entities-include-method-doesnt-load-related-records)

# javascript - Javascript从对象中删除对象

> ID：16100817
> 
> 赞同：0
> 
> 时间：2013-04-19T08:54:18.470
> 
> 标签：javascript, jquery, object, attributes

我有以下函数应该删除以下 id 下的对象中的对象：

```
contactDeleteCounter++;
console.log(orderContactIds);
console.log(deletePosition);
console.log(orderContactIds[deletePosition]);
delete orderContactIds.deletePosition;
console.log(orderContactIds.deletePosition);
console.log(orderContactIds);
console.log(deletePosition); 
```

问题是我在 Chrome 中一切正常，但 Firefox 中的 Firebug 显示以下输出：

```
Object { 0={...}, 1={...}, 2={...}}
2
Object { id= "20" , type= "1" }

undefined
Object { 0={...}, 1={...}, 2={...}}
2 
```

如您所见，该属性未定义，但是当我查看对象时，它仍然存在...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:36:28.147

答案是创建回调并制作异步 Jquery：

```
function deleteCallback(deletePosition) {
    $.ajaxSetup({
        async : false
    });
    console.log(orderContactIds);
    console.log(deletePosition);
    console.log(orderContactIds[deletePosition]);
    delete orderContactIds[deletePosition];
    console.log(orderContactIds.deletePosition);
    console.log(orderContactIds);
    console.log(deletePosition);
    $.ajaxSetup({
        async : true
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:57:28.560

delete 操作符只删除一个引用，而不是一个对象本身。如果它确实删除了对象本身，其他剩余的引用就会悬空，就像 C++ 删除一样。（访问其中一个会导致崩溃。使它们全部变为空意味着在删除每个对象时需要额外的工作或额外的内存。）

由于 Javascript 是垃圾收集的，因此您不需要自己删除对象 - 当无法再引用它们时，它们将被删除。

如果您已完成对对象的引用，则删除对它们的引用会很有用，因为这为垃圾收集器提供了有关可以回收的更多信息。如果对大对象的引用仍然存在，这可能会导致它未被回收——即使您的程序的其余部分实际上并未使用该对象。

# php - php preg_replace 删除字符串中的千位分隔符

> ID：16100821
> 
> 赞同：1
> 
> 时间：2013-04-19T08:54:29.877
> 
> 标签：php, regex

有很长的文章，我只想删除`thousand separator`，而不是逗号。

```
$str = "Last month's income is 1,022 yuan, not too bad.";
//=>Last month's income is 1022 yuan, not too bad.

preg_replace('#(\d)\,(\d)#i','???',$str); 
```

如何编写正则表达式模式？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T08:57:18.763

如果简化规则“匹配直接位于数字之间的任何逗号”对您来说足够好，那么

```
preg_replace('/(?<=\d),(?=\d)/','',$str); 
```

应该做。

您可以通过确保紧跟三个数字来改进它：

```
preg_replace('/(?<=\d),(?=\d{3}\b)/','',$str); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T08:55:51.367

如果您查看[`preg_replace`文档](http://php.net/manual/en/function.preg-replace.php)，您可以看到您可以使用以下方法将捕获写回替换字符串中`$n`：

```
preg_replace('#(\d),(\d)#','$1$2',$str); 
```

请注意，无需转义逗号或使用`i`（因为模式中没有字母）。

另一种（可能更有效）的方法是使用[lookarounds](http://www.regular-expressions.info/lookaround.html)。这些不包含在匹配中，因此不必写回：

```
preg_replace('#(?<=\d),(?=\d)#','',$str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:57:15.417

第一个`(\d)`用 表示`$1`，第二个`(\d)`用表示`$2`。因此解决方案是使用这样的东西：

```
preg_replace('#(\d)\,(\d)#','$1$2',$str); 
```

实际上，最好在逗号后面加上 3 个数字，以避免在数字列表中造成严重破坏：

```
preg_replace('#(\d)\,(\d{3})#','$1$2',$str); 
```

# jquery - jquery val().length 在 ie7 中导致错误

> ID：16100826
> 
> 赞同：0
> 
> 时间：2013-04-19T08:54:44.133
> 
> 标签：jquery, internet-explorer-7

在以下行中，我在 IE7 中收到错误“对象不支持此属性或方法”。

```
if($("#"+id+"_txt").val().length > 0)
{
    ...........
} 
```

有人知道问题是什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:08:56.627

```
// this make sure val is not null and length > 0
if($("#"+id+"_txt").val())
{
    ...........
} 
```

您可以运行快速测试来确认。

```
if (""){
    alert('emptied: true;')
}
else {
    alert('emptied: false;')
}

if (null){
    alert('null: true;')
}
else {
    alert('null: false;')
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:02:21.457

```
var id='';
id= $("#"+id+"_txt").val();
if(id.length > 0)
{
   //do something
} 
```

# html - 自定义背景颜色 Wordpress 插件 WP Table Reloadad

> ID：16100828
> 
> 赞同：1
> 
> 时间：2013-04-19T08:54:46.910
> 
> 标签：html, wordpress, background-color, html-table

我在此站点上的 Wordpress 中使用 Wp Table Reloaded 插件：

```
http://equinoximpex.inditalent.com/acid-dyes/ 
```

在此页面的第二列阴影名称中，我想在每个下一个框中使用不同的颜色，例如，

```
http://www.equinoximpex.com/acid-dyes.html 
```

尝试使用

```
<div style="background-color:#xyz;"></div> 
```

但不行，想在每个框中使用自定义颜色。

我没有 php 的知识，但是对 Css 和 Html 有很好的了解。

所以请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T20:11:24.167

您需要给 Div 一个高度和宽度。说：

```
<div style="background-color: yellow; height: 25px; width: 35px;"></div> 
```

# android - Android - 在 OpenGL 纹理、位图和 GLUtils.texSubImage2D 中，y 轴的方向是从上到下还是从下到上？

> ID：16100830
> 
> 赞同：3
> 
> 时间：2013-04-19T08:54:48.277
> 
> 标签：android, opengl-es, coordinates, textures

有人可以弄清楚y轴进入哪个方向（从上到下或从下到上）：

安卓`Canvas`& `Bitmap`,

`Bitmap`相对于通过上传的 OpenGL 纹理 y 坐标（0 到 1）`GLUtils.texSubImage2D`，

和

Android`GLUtils.texSubImage2D`的`yOffset`数量相对于上述两个

?

我有一些通过实验工作的东西，但我更愿意在使用`GLUtils.texSubImage2D`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-16T12:39:00.847

从很久以前开始，在所有屏幕上，X 轴向右，Y 轴向下。

# android - 修改第一个电话号码并保存在android

> ID：16100832
> 
> 赞同：1
> 
> 时间：2013-04-19T08:54:54.523
> 
> 标签：android, android-contacts

我想使用下面的代码检索第一个电话号码，在该号码前添加一个零并保存电话号码。我是新手，到目前为止，下面的代码打开联系人列表，然后用户选择一个电话号码，电话号码显示为祝酒词。但是，我希望我的联系人列表中的第一个电话号码前面为零，然后保存。我知道我离解决方案不远，但是在尝试时，如果我得到您的帮助会更快。谢谢。

公共类 MainActivity 扩展 Activity {

```
 public static final int PICK_CONTACT    = 1;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // this opens the activity. note the  Intent.ACTION_GET_CONTENT
        // and the intent.setType
        ((Button)findViewById(R.id.btn_contacts)).setOnClickListener( new OnClickListener() {
            @Override
            public void onClick(View v) {
                // user BoD suggests using Intent.ACTION_PICK instead of .ACTION_GET_CONTENT to avoid the chooser
                Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
                // BoD con't: CONTENT_TYPE instead of CONTENT_ITEM_TYPE
                intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_ITEM_TYPE);
                startActivityForResult(intent, 1);                
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (data != null) {
            Uri uri = data.getData();

            if (uri != null) {
                Cursor c = null;
                try {
                    c = getContentResolver().query(uri, new String[]{ 
                                ContactsContract.CommonDataKinds.Phone.NUMBER,  
                                ContactsContract.CommonDataKinds.Phone.TYPE },
                            null, null, null);

                    if (c != null && c.moveToFirst()) {
                        String number = c.getString(0);
                        int type = c.getInt(1);
                        showSelectedNumber(type, number);
                    }
                } finally {
                    if (c != null) {
                        c.close();
                    }
                }
            }
        }
    }

    public void showSelectedNumber(int type, String number) {
        Toast.makeText(this, type + ": " + number, Toast.LENGTH_LONG).show();      
    }
} 
```

# algorithm - map reduce算法的并行效率计算公式是什么？

> ID：16100845
> 
> 赞同：0
> 
> 时间：2013-04-19T08:55:37.903
> 
> 标签：algorithm, hadoop, parallel-processing, mapreduce

有什么公式可以告诉我们map reduce算法的并行效率吗？（换句话说，我如何在数学上证明 MR 算法 A 优于 MR 算法 B）

[我用谷歌搜索了它，但我可以在wiki](http://en.wikipedia.org/wiki/Speedup)上找到并行算法的加速和效率的定义，但如果有人能展示这些公式如何应用于 MR 算法，那就太好了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T14:37:18.773

[简而言之](http://en.wikipedia.org/wiki/Bulk_synchronous_parallel)[，](http://en.wikipedia.org/wiki/Bulk_synchronous_parallel)请查看 Wiki [。`Bulk Synchronous Parallel``BSP`](http://en.wikipedia.org/wiki/Bulk_synchronous_parallel)

另一个复杂度计算包含在 Rob Bisselings 论文中

> 并行科学计算：使用 BSP 和 MPI 的结构化方法

`BSP``MapReduce`是对链接底部的复杂性/成本分析公式的抽象并包含。

所以你需要做的是，将你的`MapReduce`算法转换为`BSP`版本。障碍同步是例如阶段之间的转换`Map`或`Reduce`新`MapReduce`作业。消息（通信）是您在`Map`和`Reduce`函数中向文件系统发出的内容。

# winforms - System.Windows.Forms.DataGridView 中的 NullReferenceException 异常

> ID：16100847
> 
> 赞同：1
> 
> 时间：2013-04-19T08:55:43.287
> 
> 标签：winforms

我有一个 .NET 4.0 WinForms 应用程序。应用程序的表单包含一个网格——一个 System.Windows.Forms.DataGridView 对象

突然间，我得到了一个（不可重现的！）NullReferenceException。调用堆栈如下：

```
System.NullReferenceException: Object reference not set to an instance of an object.
   at System.Windows.Forms.DataGridView.UnwireEditingControlEvents()
   at System.Windows.Forms.DataGridView.EndEdit(DataGridViewDataErrorContexts context, DataGridViewValidateCellInternal validateCell, Boolean fireCellLeave, Boolean fireCellEnter, Boolean fireRowLeave, Boolean fireRowEnter, Boolean fireLeave, Boolean keepFocus, Boolean resetCurrentCell, Boolean resetAnchorCell)
   at System.Windows.Forms.DataGridView.SetCurrentCellAddressCore(Int32 columnIndex, Int32 rowIndex, Boolean setAnchorCellAddress, Boolean validateCurrentCell, Boolean throughMouseClick)
   at System.Windows.Forms.DataGridView.set_CurrentCell(DataGridViewCell value)
   at System.Windows.Forms.DataGridView.OnClearingRows()
   at System.Windows.Forms.DataGridViewRowCollection.ClearInternal(Boolean recreateNewRow)
   at System.Windows.Forms.DataGridView.RefreshRows(Boolean scrollIntoView)
   at System.Windows.Forms.DataGridView.DataGridViewDataConnection.ProcessListChanged(ListChangedEventArgs e)
   at System.Windows.Forms.DataGridView.DataGridViewDataConnection.currencyManager_ListChanged(Object sender, ListChangedEventArgs e)
   at System.Windows.Forms.CurrencyManager.OnListChanged(ListChangedEventArgs e)
   at System.Windows.Forms.CurrencyManager.List_ListChanged(Object sender, ListChangedEventArgs e)
   at System.Windows.Forms.BindingSource.OnListChanged(ListChangedEventArgs e)
   at System.Windows.Forms.BindingSource.InnerList_ListChanged(Object sender, ListChangedEventArgs e)
   at System.ComponentModel.BindingList`1.OnListChanged(ListChangedEventArgs e)
   at System.ComponentModel.BindingList`1.FireListChanged(ListChangedType type, Int32 index)
   at System.ComponentModel.BindingList`1.ClearItems()
   at System.Collections.ObjectModel.Collection`1.Clear()
   at <My Code>; 
```

调用 BindingList 派生列表的 Clear 方法。BindingList 派生的列表又在 BindingSource 对象中使用。BindingSource 对象是 DataGridView 的数据源。

我无法理解——为什么会这样？为什么它只是偶尔发生？（到目前为止，我只看到过一次问题）。又该如何避免呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-21T21:02:15.693

刚才我自己也遇到了。就我而言，我注意到只有在网格超过 10 行左右并且您立即尝试转到最后一行时才会发生这种情况。我的解决方法是，在设置之后`BindingSource`，手动将当前单元格设置为第一行中的单元格：

```
grdConditions.DataSource = myDataSource;
if (grdConditions.Rows.Count > 0)
    grdConditions.CurrentCell = grdConditions[0, grdConditions.RowCount - 1]; 
```

似乎为我解决了这个问题。

# javascript - 将图像从 javascript 客户端发送到 SQL 服务器的最佳格式

> ID：16100848
> 
> 赞同：0
> 
> 时间：2013-04-19T08:55:44.540
> 
> 标签：javascript, sql-server, ajax, asp.net-mvc, json

我正在制作一个存储 Azure SQL 服务器数据库用户信息的应用程序，包括从 Facebook 下载的个人资料照片。在服务器端，ASP.NET MVC4 将有一个控制器来接收信息并将其发送到数据库。

客户端是 Javascript，并认为以 json 格式提供图像（一旦转换为 base64）。这是一个不错的选择吗？直接发送jpg更好吗？用json发送信息有什么好处？

在 SQL Server 中，图像字段将存储为 nvarchar（最大值）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:01:33.050

您要将图像作为二进制流内容类型返回`image/jpeg`还是作为 base64 编码的文本流返回？您更有可能执行前者，因此几乎没有理由进行中间 base64 编码传输。当然，将它们存储为`VARBINARY(MAX)`. 即使*您*选择将它们存储为 base64，为 base64 文本选择 Unicode 数据类型也确实很浪费，（无缘无故地使存储成本翻倍......），base64 可以很好地适应`VARCHAR(max)`.

但是，特别是在 SQL Azure 环境中，您应该考虑将媒体存储在[Azure BLOB 存储](http://www.windowsazure.com/en-us/develop/net/how-to-guides/blob-storage/)中，并且只将 Blob 路径存储在您的数据库中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:02:08.077

在我看来，最好使用 Multipart Forms 或类似的东西直接以 .jpg 格式发送图像。

当您传输显式数据时，在 Json 中发送信息非常有用，例如您以后可以查询或反序列化的集合或对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:23:20.293

> 客户端是 Javascript，并认为以 json 格式提供图像（一旦转换为 base64）。这是一个不错的选择吗？

正如 Pasrus 指出的那样，您不会操纵图像数据。所以 JSON 在这里似乎不是一个好的选择。

一种选择是，您可以将 base64 数据添加到 html 标签的 src 属性中并发送。

> 用json发送信息有什么好处？

请检查这个答案，有很多：

[使用 application/json 优于 text/plain 的优势？](https://stackoverflow.com/questions/4350753/advantages-of-using-application-json-over-text-plain)

> 在 SQL Server 中，图像字段将存储为 nvarchar（最大值）

请参考这个链接：

[在 SQL Server 中存储图像？](https://stackoverflow.com/questions/5613898/what-about-storing-images-in-sql-server)

# jquery - $.ajax url 字符串防止自动编码

> ID：16100849
> 
> 赞同：2
> 
> 时间：2013-04-19T08:55:44.967
> 
> 标签：jquery, ajax, url, get

我已经编码了这个：

```
var serviceURL = "..../MaterialCollection(MaterialID='" + materialID + "')";

$.ajax({
    type: "GET",
    url: serviceURL,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: callbackSuccess,
    error: callbackError,
}); 
```

问题是 serviceURL 正在自动编码，`(`即被翻译`%28`并被`)`翻译为`%29`. 我不希望这个 URL 被自动编码。我应该做些什么？

谢谢你。问候

# matlab - Matlab linspace 和范围与 Kahan 求和算法的准确性

> ID：16100850
> 
> 赞同：0
> 
> 时间：2013-04-19T08:55:48.083
> 
> 标签：matlab, parallel-processing, floating-point, vectorization, double-precision

我正在使用 Matlab`linspace`函数和范围`:`运算符来获得等距的向量，但我意外地收到了不等距的数字。我的代码如下：

```
format long

x1 = linspace(3,5,20);
diff(x1)

x2 = 3:0.1:5;
diff(x2) 
```

向量差 ( `diff`) 的输出如下：

```
x1    
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894737
0.105263157894737
0.105263157894737   
0.105263157894737
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894736   
0.105263157894737   
0.105263157894737   
0.105263157894736
0.105263157894737   
0.105263157894736   
0.105263157894737

x2
0.100000000000000   
0.100000000000000   
0.100000000000000   
0.100000000000000
0.100000000000000   
0.100000000000000   
0.100000000000000   
0.100000000000000
0.100000000000000   
0.100000000000000   
0.100000000000000   
0.100000000000001
0.100000000000000   
0.100000000000001   
0.100000000000000   
0.100000000000000
0.100000000000001   
0.100000000000000   
0.100000000000001   
0.100000000000000 
```

为了解决这个问题，我通过以下代码使用 Kahan 求和方法：

```
dx = 2/19;
x3 = zeros(size(x1));
x3(1) = 0;
partial_sum = 0;
c = 0.0;
for k=2:20,
    y = dx - c;
    t = partial_sum + y;
    c = (t - partial_sum) - y;
    partial_sum = t;
    x3(k) = partial_sum;
end
diff(x3) 
```

我现在正在获得一个等距向量

```
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894737   
0.105263157894737   
0.105263157894737   
0.105263157894737
0.105263157894737   
0.105263157894737   
0.105263157894737 
```

但是，这种方法是“顺序的”。是否有人知道 Kahan 求和方法的矢量化或并行实现以提高效率或将其移植到（CUDA）并行减少？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T09:03:32.820

我认为你是误会了

**(a)**的使用`linspace`。你的来电

```
linspace(3,5,20) 
```

返回 20 个等距数字，从 3 开始，到 5 结束。试试

```
linspace(3,5,21) 
```

反而。请注意，向量的长度`x`和`x2`相差一。

( **b)**

浮点运算的微妙之处。这个主题在 SO 上得到了广泛的介绍，我不会复制已经找到的许多好的解释中的任何一个。

我认为您所看到的是*对于大多数数值应用来说等距的数字*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T09:07:26.243

我想这个链接会有所帮助：

[http://www.mathworks.com/matlabcentral/fileexchange/26800](http://www.mathworks.com/matlabcentral/fileexchange/26800)

您将找到该`XSum`功能，您可以在其中切换和测试不同的求和方法：

*   Double：Matlab 的 SUM 的线程安全实现。至少在 Matlab 2008a 到 2009b 中，多线程 SUM 的结果可能因调用而异。比单线程 SUM (MSVC++ 2008) 快 50%，精度相当。
*   Long：如果编译器支持（例如 LCC v3.8），则以 80 位 long double 形式累积。多 3.5 个有效数字，慢 40%。
*   Kahan：从下一个元素中减去局部误差。多 1 到 3 个有效数字，慢 10%。
*   Knuth：好像总和是在一个 128 位浮点数中累积的：大约还有 15 个有效数字。大约相同的速度（MSVC++2008 编译器）。这适用于最现实的问题。
*   Knuth2：30 个有效数字，就好像它以 196 位浮点数累加一样。慢 60%。
*   KnuthLong：与 Knuth 相同，但如果编译器支持，则使用 long double 来获得大约 21 个有效数字。慢 2.5 倍。

# ruby-on-rails - 使用 Authorize ruby gem 和 Rolify/Devise 定义类级别的授权者

> ID：16100864
> 
> 赞同：0
> 
> 时间：2013-04-19T08:56:18.087
> 
> 标签：ruby-on-rails

因此，将以下内容放在我的产品控制器的顶部之后：

```
 authorize_actions_for(Product) 
```

...这是我的 Product.rb 的顶部：

```
 resourcify
  include Authority::Abilities 
```

...这是我的 User.rb 的顶部

```
 rolify
  include Authority::UserAbilities 
```

我能够从 application_authorizer.rb 遵守这条规则：

```
def self.default(adjective, user)
  user.has_role? :admin
end 
```

换句话说，只有管理员用户才能以任何方式与产品互动。

但是，当我创建一个 product_authorizer.rb 如下

```
class ProductAuthorizer < ApplicationAuthorizer
  def self.creatable_by?(user)
    user.has_role? :admin
  end

  def self.updatable_by?(user)
    user.has_role? :admin
  end

  def self.deletable_by?(user)
    user.has_role? :admin
  end
end 
```

我没有看到规则得到遵守。我看到我的非管理员用户**仍然无法**访问产品的显示操作。鉴于上述情况，这不应该被允许吗？

我尝试将其添加到 Product.rb：

```
self.authorizer_name = 'StyleAuthorizer' 
```

我还尝试在 app_app.rb 中注释掉主要规则

```
#def self.default(adjective, user)
# user.has_role? :admin
#end 
```

...但仍然没有荣耀

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T14:20:31.843

[权威的源代码](https://github.com/nathanl/authority/blob/master/lib/authority/authorizer.rb#L20)中最基本`default`的总是返回false。因此，除非您在方法中明确授权非管理员，否则他们将无法访问显示页面。`self.readable`

删除`product_authorizer.rb`文件中的其他方法（它们不是必需的）并将它们替换为

```
def self.readable_by?(user)
  true
end 
```

# c++ - 嵌套迭代器循环，为什么迭代器相等？- C++

> ID：16100865
> 
> 赞同：1
> 
> 时间：2013-04-19T08:56:18.110
> 
> 标签：c++, arrays, iterator, nested-loops

我想在对象数组上构造嵌套循环，具有相当复杂的数据结构。因为我使用数组，所以我想利用它们的迭代器。在得到意想不到的结果后，我将问题归结为以下代码片段，当我期望迭代器不同时，它显示我的迭代器是相等的：

```
vector<int> intVecA;
vector<int> intVecB;

intVecA.push_back(1);
intVecA.push_back(2);

intVecB.push_back(5);
intVecB.push_back(4);

Foo fooOne(intVecA);
Foo fooTwo(intVecB);

vector<int>::const_iterator itA = fooOne.getMyIntVec().begin();
vector<int>::const_iterator itB = fooTwo.getMyIntVec().begin();
cout << "The beginnings of the vectors are different: "
     << (fooOne.getMyIntVec().begin() == fooTwo.getMyIntVec().begin()) << endl;
cout << (*(fooOne.getMyIntVec().begin()) == *(fooTwo.getMyIntVec().begin())) << endl;
cout << (&(*(fooOne.getMyIntVec().begin())) == &(*(fooTwo.getMyIntVec().begin()))) << endl;
cout << "But the iterators are equal: "
     << (itA==itB) << endl; 
```

这会产生：

```
The beginnings of the vectors are different: 0
0
0
But the iterators are equal: 1 
```

这种行为对我来说没有意义，我很乐意听到解释。

Foo 是一个简单的对象，其中包含一个向量和 getter 函数：

```
class Foo {
    public:
    Foo(std::vector<int> myIntVec);

    std::vector<int> getMyIntVec() const {
    return _myIntVec;
    }

    private:
    std::vector<int> _myIntVec;
};

Foo::Foo(std::vector<int> myIntVec) {
    _myIntVec = myIntVec;
} 
```

当第一次复制向量时，问题就消失了。为什么？

```
vector<int> intVecReceiveA = fooOne.getMyIntVec();
vector<int> intVecReceiveB = fooTwo.getMyIntVec();

vector<int>::const_iterator newItA = intVecReceiveA.begin();
vector<int>::const_iterator newItB = intVecReceiveB.begin();

cout << "The beginnings of the vectors are different: "
     << (intVecReceiveA.begin() == intVecReceiveB.begin()) << endl;
cout << "And now also the iterators are different: "
     << (newItA==newItB) << endl; 
```

产生：

```
The beginnings of the vectors are different: 0
And now also the iterators are different: 0 
```

进一步说明：我需要函数中的这些嵌套循环，这些循环需要在计算时间方面非常有效，因此我不想做不必要的操作。由于我是 C++ 新手，我不知道复制向量是否真的需要额外的时间，或者它们是否会在内部被复制。我也感谢任何其他建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:07:05.143

问题是您在 Foo 中的访问器：

```
std::vector<int> getMyIntVec() const {
return _myIntVec;
} 
```

我不返回 _myIntVec，它返回 myIntVec 的**副本**。相反，它应该看起来像：

```
const std::vector<int>& getMyIntVec() const {
return _myIntVec;
} 
```

否则，当您创建迭代器时，它们是从直接丢弃的副本中创建的，因此您的 C++ 编译器会重用该地址。这就是为什么你得到“平等”的迭代器，至少我是这么认为的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:07:59.420

这样做的原因是比较两个引用不同容器中元素的迭代器是未定义的行为。所以，不能保证你会得到什么。这来自于`getMyIntVec`返回一个副本`_MyIntVec`并将这些副本分配给 的新实例的事实`vector<int>`，因此这些确实是`_MyIntVec`成员的两个不同副本的迭代器。

根据标准：

§ 24.2.1

> 当且仅当存在使 i == j 的表达式 ++i 的有限应用序列时，迭代器 j 被称为从迭代器 i 可达。如果 j 可从 i 到达，则它们指的是同一序列的元素。

稍后在标准中：

§ 24.2.5

> 前向迭代器的 == 域是相同底层序列上的迭代器的域。

[这个问题](https://stackoverflow.com/questions/4657513/comparing-iterators-from-different-containers "比较来自不同容器的迭代器”；")已经回答了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:39:48.080

您在这里有一个严重的逻辑问题：

```
cout << "The beginnings of the vectors are different: "
 << (fooOne.getMyIntVec().begin() == fooTwo.getMyIntVec().begin()) << endl; 
```

如果它们相等，它将输出 1 而不是您通常期望的 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T09:01:00.457

你意识到你比较事物的方式是错误的吗？如果你比较`a == b`，即使你写

```
cout << "a is different from b: " << (a==b) << endl; 
```

输出将告诉两个元素是否相同而不是不同。要检查两件事是否不同，请`!=`使用`==`.

# android - Resources$NotFoundException drawable-xhdpi 来自可绘制资源

> ID：16100868
> 
> 赞同：8
> 
> 时间：2013-04-19T08:56:35.557
> 
> 标签：android, android-resources

我正在检查我的错误报告，有时我们会从我们的应用程序中收到此错误报告。我无法指出真正的问题是什么。此资源确实存在，大多数设备都可以正常工作，但某些特定设备（如 LG-E510 或 U8815）无法加载此资源。

有任何想法吗？

```
android.content.res.Resources$NotFoundException: File res/drawable-xhdpi/action_bar_search_icon.png from drawable resource ID #0x7f02007f
at android.content.res.Resources.loadDrawable(Resources.java:1714)
at android.content.res.Resources.getDrawable(Resources.java:581)
at com.actionbarsherlock.internal.view.menu.MenuItemImpl.getIcon(MenuItemImpl.java:384)
at com.actionbarsherlock.internal.view.menu.ActionMenuItemView.initialize(ActionMenuItemView.java:128)
at com.actionbarsherlock.internal.view.menu.ActionMenuPresenter.bindItemView(ActionMenuPresenter.java:192)
at com.actionbarsherlock.internal.view.menu.BaseMenuPresenter.getItemView(BaseMenuPresenter.java:176)
at com.actionbarsherlock.internal.view.menu.ActionMenuPresenter.getItemView(ActionMenuPresenter.java:178) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-29T00:45:50.347

正如您所说，如果电话/选项卡访问 xhdpi 目录，那么我们希望它适当地缩放图像以适合屏幕。因此，我们希望如果资源存在于任何一个目录中，那么我们将永远不会看到 ResourceNotFound 异常。然而：

xhdpi 仅在 Android SDK 8 中引入，因此如果您以 SDK 7 及更早版本为目标，您可能会遇到问题：

[仅在 Android 应用程序中使用 XHDPI 可绘制对象？](https://stackoverflow.com/questions/5998865/only-use-xhdpi-drawables-in-android-app)

Android 可能无法访问 xhdpi 目录的另一个原因是设备是否在屏幕兼容模式下运行：

[Android - 放置在 res/drawable-xhdpi 中的超大图像没有显示在平板电脑模拟器上，为什么？](https://stackoverflow.com/questions/9434884/android-extra-large-images-placed-in-res-drawable-xhdpi-arent-showing-on-tabl)

另一个可能的原因是，如果您的可绘制对象非常小，并且由于缩放，它的一个尺寸被舍入为零：

[由于宽度和高度，未找到 Android 资源](https://stackoverflow.com/questions/15428441/android-resource-not-found-because-of-width-and-height)

最后，一些 OEM 版本的 Android 可能会以非标准方式实现这一点（例如，如果他们的设备是 hdpi，则通过不搜索 xhdpi 目录来“增强性能”）：

[Android Drawable hdpi xhdpi mdpi ldpi 概念](https://stackoverflow.com/questions/15621876/android-drawable-hdpi-xhdpi-mdpi-ldpi-concept)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-24T21:52:50.490

您应该将可绘制对象保存在 hdpi 文件夹中。由于无法使用它的手机像素较少，因此它们无法显示图像。只需重新定位文件。

编辑：它们的像素较少，因为它们的屏幕尺寸较小。

# java - 在 CMIS 中获取 PDF 文件的缩略图

> ID：16100871
> 
> 赞同：1
> 
> 时间：2013-04-19T08:56:49.293
> 
> 标签：java, thumbnails, alfresco, cmis, opencmis

我正在使用 Apache Chemistry OpenCMIS 访问我的 Alfresco 存储库并获取文件。我可以通过文件的再现（cmis:thumbnail）获得缩略图，但它似乎只适用于图像。是否也可以获得 PDF 文件的缩略图视图？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T21:54:17.633

当然，这绝对是可能的。您用于获取图像再现的相同调用也适用于办公文档。我没有时间编写 Java 来向您展示（您已经在做的事情无论如何都会起作用），但这是您在 Python 中的做法，非常相似：

```
>>> doc = repo.getObject("workspace://SpacesStore/5515d3e1-bb2a-42ed-833c-52802a367033")
>>> doc.name
u'Project Objectives.ppt'
>>> rends = doc.getRenditions()
>>> rends
[<cmislib.model.Rendition object at 0x1102d3210>, <cmislib.model.Rendition object at 0x1102d3990>]
>>> rends[0]
<cmislib.model.Rendition object at 0x1102d3210>
>>> rends[0].href
u'http://localhost:8080/alfresco/cmisatom/a00f3835-612c-47a0-a0ae-1e95d9a80e73/content?id=workspace%3A%2F%2FSpacesStore%2F5515d3e1-bb2a-42ed-833c-52802a367033%3B1.0&streamId=workspace%3A%2F%2FSpacesStore%2Fe725ee47-62c6-4ae9-a761-9b69ba2835c5'
>>> rends[0].title
u'doclib'
>>> rends[1].title
u'webpreview'
>>> rends[1].href
u'http://localhost:8080/alfresco/cmisatom/a00f3835-612c-47a0-a0ae-1e95d9a80e73/content?id=workspace%3A%2F%2FSpacesStore%2F5515d3e1-bb2a-42ed-833c-52802a367033%3B1.0&streamId=workspace%3A%2F%2FSpacesStore%2F41c25437-ce2e-47e1-8e3d-a2f3008e7456'
>>> rends[1].getMimeType()
u'application/x-shockwave-flash' 
```

在这种情况下，我从所有安装附带的示例网站设计共享站点中检索 PowerPoint 文件的再现。你可以看到它有两个版本。一种是文档库列表中显示的 doclib 缩略图。另一个是用于在打开文档详细信息视图时预览演示文稿的 Flash 文件。

# asp.net - 在 System.Net.Http.Formatting 类中找不到 Windows 8 FormDataCollection

> ID：16100872
> 
> 赞同：0
> 
> 时间：2013-04-19T08:56:49.793
> 
> 标签：asp.net, http, windows-8, asp.net-web-api

我正在开发一个 Windows 8 应用程序，我想使用 System.Net.Http.Formatting.FormDataCollection 将数据发送到服务器。

我已经从 Nuget 安装了 Microsoft ASP.NET Web API 客户端库 4.1.0-alpha-120809。

但是，当我尝试使用 System.Net.Http.Formatting 类中的 FormDataCollection 时，它无法识别。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T14:17:04.807

您不应该真正使用 FormDataCollection 来发送表单内容，因为它不是从 HttpContent 派生的。改为这样做。

```
 var form = new Dictionary<string, string>();
  form.Add("foo","bar");
  form.Add("boo","baz");
  var response = await httpClient.PostAsync(new Uri("http://example.org/"), new FormUrlEncodedContent(form)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-02T10:41:31.183

`System.Net.Http`并且`System.Net.Http.Formatting`是两个不同的组件。确保您也添加了`System.Net.Http.Formatting`程序集作为参考。它对我有用。

# wso2 - WSO2 BPS - 邮寄活动

> ID：16100884
> 
> 赞同：2
> 
> 时间：2013-04-19T08:57:17.507
> 
> 标签：wso2, bpel

我需要有一个在 BPEL 流程的某个点发送邮件的活动。

是否有“邮件活动”或者我必须编写一种 Web 服务来调用，以便我调用该服务并让它发送邮件？

是否可以将 ESB 用于该业务？

如何将两者连接起来（再次使用 Web 服务，或者有一种更快、更简单的方法来连接它们）？

在这种情况下，将 ESB 功能添加到 BPS 以添加传输功能而不必为此添加 ESB 是否是一个好的解决方案？

我还看到有一些示例在axis2.xml中使用transportSender而不是使用代理，但似乎这种方法总是将邮件发送到我需要能够向主题发送邮件的相同地址（可能的 cc 和 bcc）来自进程的参数（在上一步中，我从 DB 读取数据并且有地址信息） tensportSender 是要遵循的路径还是我必须开发邮件服务？

有什么提示吗？

谢谢

卢卡

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-10T08:12:42.820

如前所述，目前 WSO2 BPEL 没有内置邮件活动，但您可以通过从 BPEL 工作流内部调用外部 Web 服务（DSS、AS）来获得此功能。

几天前，我创建了一个具有这种功能的工作流程。基本上我创建了一个 Axis2 服务，它只是用于发送电子邮件的 Java 代码，我可以在其中提供主题、内容和接收者等参数，因此一旦您调用该服务，您就可以将电子邮件发送到任何电子邮件地址。我将提到的 Axis2 服务部署到 WSO2 DSS 中，并从 BPEL 工作流中调用它，后来我将其部署到 WSO2 BPS 中。

我用于发送电子邮件的 Java 代码如下：

```
import java.util.Properties;

import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class MailSender {

    public static void main(String emailAddress, String content){

        String host = "smtp.gmail.com";
        String from = "example@gmail.com";
        String subject = "Subject example";

        Properties props = System.getProperties();
        props.put("mail.smtp.host", host);
        props.put("mail.smtp.user", from);
        props.put("mail.smtp.password", "");
        props.put("mail.smtp.port", "587");
        props.put("mail.smtp.starttls.enable", "true");
        props.put("mail.smtp.auth", "true");

        try{
            Session session = Session.getDefaultInstance(props, null);
            InternetAddress to_address = new InternetAddress(emailAddress);

            MimeMessage message = new MimeMessage(session);         
            message.setFrom(new InternetAddress(from));
            message.addRecipient(Message.RecipientType.TO, to_address);
            message.setSubject(subject);        
            message.setContent(content, "text/html; charset=UTF-8");

            Transport transport = session.getTransport("smtp");
            transport.connect("smtp.gmail.com","example@gmail.com","Password");
            transport.sendMessage(message, message.getAllRecipients());
            transport.close();

            }

            catch (MessagingException mex) {
            System.out.println("send failed, exception: " + mex);
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T05:43:08.167

目前，BPS 中没有作为内置活动的邮件活动。

但是，是的，您可以通过结合 ESB 和 BPS 来完成您的任务。您可以按如下方式进行。首先将 ESB 电子邮件发送服务公开为代理，然后使用 BPS 调用该服务。最好使用单独的 ESB 来完成这项任务，因为我在将 ESB 功能集成到 BPS 时遇到了一些困难。

# ios5 - 同步失败:-857 由远程 ID '%1' 标识的远程数据库已经在同步或数据库连接不可用:

> ID：16100886
> 
> 赞同：0
> 
> 时间：2013-04-19T08:57:23.927
> 
> 标签：ios5, xcode4.3, sup, mobilink

我正在使用目标 C 和 SUP 作为中间件在 iOS 中使用 iOS 本机应用程序。我使用相同的配置文件让两个不同的应用程序在 iPAD 中运行。

我的应用程序以前运行良好。但是现在当我尝试运行它时显示错误， **如远程 ID '%1' 标识的远程数据库已经在同步或数据库连接不可用：无法访问该远程 ID 的锁 错误代码 -10343**

我能做些什么来解决这个问题？当我在谷歌搜索时，我得到了一些信息，比如

'MobiLink 服务器无法访问统一数据库或 MobiLink 系统数据库中远程 ID 的锁。远程 ID 可能已被另一个同步锁定，或者数据库连接可能不可用。请检查数据库连接，稍后再尝试同步。

请帮助我......提前感谢您的任何帮助......'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T09:59:44.787

我认为这是因为数据库被某些应用程序锁定。

# ejb - 如何使用 ejb 实体 bean - 我必须在 ejb 容器中部署 ejb 实体 bean

> ID：16100887
> 
> 赞同：1
> 
> 时间：2013-04-19T08:57:25.733
> 
> 标签：ejb, entity, javabeans

我想知道如何使用 EJB 实体 bean。我必须在 ejb 容器中部署 EJB 实体 bean。

但是我看到我的朋友正在使用带有 EJB 实体 bean 的 java 持久性 api 的一些项目，但它们部署在 servlet 容器而不是 ejb 容器中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:12:37.017

OpenEJB应该和tomcat集成（现在有tomcat EJB兼容版本，叫tomEE）

请参阅[如何在 Tomcat 上部署基于 EJB 的应用程序](https://stackoverflow.com/questions/4304757/how-to-deploy-ejb-3-or-web-application-on-tomca)

# objective-c - Box2d Objective-C中的弧度角检查

> ID：16100893
> 
> 赞同：2
> 
> 时间：2013-04-19T08:57:38.763
> 
> 标签：objective-c, box2d, angle, radians

我正在使用 Box2D 在 Objective C 中创建汽车游戏。我想根据 CCSprite（转向）旋转来旋转车轮。

因此，为此，我能够根据触摸成功设置 CCSprite 转向的角度。但是当我试图获得转向旋转的价值时，尽管转向完美旋转，但它并没有得到完美的结果。但弧度角值有时并不完美。**所以我无法按照转向旋转来旋转车轮**

我的代码是设置转向角度如下

On Touch Begin，设置起始角度

```
-(void)getAngleSteer:(UITouch *) touch
{
    CGPoint location = [touch locationInView: [touch view]];
    location = [[CCDirector sharedDirector] convertToGL: location];
    float adjacent = steering.position.x - location.x;
    float opposite = steering.position.y - location.y;

    self.startAngleForSteer = atan2f(adjacent, opposite);
} 
```

触摸移动、移动转向和设置汽车角度

```
-(void)rotateSteer:(UITouch *) touch
{
    CGPoint location = [touch locationInView: [touch view]];
    location = [[CCDirector sharedDirector] convertToGL: location];

    float adjacent = steering.position.x - location.x;
    float opposite = steering.position.y - location.y;

    float angle = atan2f(adjacent, opposite);
    angle = angle - self.startAngleForSteer;
    steering.rotation = CC_RADIANS_TO_DEGREES(angle);

    //Main issue is in below line
    NSLog(@"%f %f", angle, CC_RADIANS_TO_DEGREES(angle));       
    if(angle > M_PI/3 || angle < -M_PI/3) return;
    steering_angle = -angle;//This is for Box2D Car Angle
} 
```

这是原木，当移动转向时，逆时针方向

```
-0.127680 -7.315529
-0.212759 -12.190166
-0.329367 -18.871363
5.807306 332.734131    // Why is 5.80 cuming just after -0.32 it should be decrease.
5.721369 327.810303
5.665644 324.617462 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:37:00.297

终于得到了这个问题的答案。感谢 Box2D 论坛（[http://box2d.org/forum/viewtopic.php?f=5&t=4726](http://box2d.org/forum/viewtopic.php?f=5&t=4726)）

对于Objective C，我们必须像下面的函数那样标准化角度。

```
-(float) normalizeAngle:(float) angle
{
    CGFloat result = (float)((int) angle % (int) (2*M_PI));

    return (result) >= 0 ? (angle < M_PI) ? angle : angle - (2*M_PI) : (angle >= -M_PI) ? angle : angle + (2*M_PI);
} 
```

只需在条件检查 M_PI/3 之前调用它

```
steering.rotation = CC_RADIANS_TO_DEGREES(angle);
angle = [self normalizeAngle:angle];//This is where to call.
if(angle > M_PI/3 || angle < -M_PI/3) return;
steering_angle = -angle; 
```

# json - 自动编码 Catalyst::View::JSON

> ID：16100897
> 
> 赞同：1
> 
> 时间：2013-04-19T08:57:46.463
> 
> 标签：json, perl, catalyst, dbix-class

我使用 DBIx 类从数据库中选择数据；我使用序列化将响应从控制器发送到客户端，使用 json`Catalyst::View::JSON`

但是从数据库中选择的 utf8-data 需要从 utf-8 解码为 perl-string，然后才能像这样发送到客户端

```
use Encode;

...

sub get_fruits :Path('getfruits') :Args(0) {
    my $fruits = [$c->model('DB::Fruit')->search({})->hashref_array];
    # Hated encode data loop
    foreach (@$fruits) {
        $_->{name} = decode('utf8', $_->{name});
    }
    $c->stash({fruits => $fruits});
    $c->forward('View::JSON');
} 
```

是否可以在视图中自动解码数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:25:09.973

Catalyst 模型**始终**必须确保数据被**解码**，无论它在哪里使用。视图必须确保数据被正确**编码**。您必须确保您的模型能够解码来自数据库的数据。如果您使用的是 DBIx::Class，请阅读[Using Unicode](https://metacpan.org/module/RIBASUSHI/DBIx-Class-0.08210/lib/DBIx/Class/Manual/Cookbook.pod#Using-Unicode)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:18:33.583

这可能就像确保 Catalyst::View::JSON 使用支持 UTF8 编码的 JSON 编码器一样简单。我相信如果您将 JSON::XS 与 Catalyst::View::JSON 一起使用，它将默认执行 UTF8 编码。您可以使用 json_driver 配置变量确保 Catalyst::View::JSON 正在使用 JSON::XS。

或者，您可以覆盖 Catalyst::View::JSON 中[的 JSON 编码，详见文档](http://search.cpan.org/~miyagawa/Catalyst-View-JSON-0.33/lib/Catalyst/View/JSON.pm#OVERRIDING_JSON_ENCODER)

# c# - 选择多个字段分组并求和

> ID：16100900
> 
> 赞同：47
> 
> 时间：2013-04-19T08:57:53.327
> 
> 标签：c#, asp.net, linq, linq-group

我想用 linq（对象列表）进行查询，但我真的不知道该怎么做，我可以进行分组和求和，但不能选择其余字段。例子：

```
ID  Value     Name   Category
1   5         Name1  Category1  
1   7         Name1  Category1
2   1         Name2  Category2
3   6         Name3  Category3
3   2         Name3  Category3 
```

我想按 ID 分组，按值 SUM 并返回所有这样的字段。

```
ID  Value     Name   Category
1   12        Name1  Category1  
2   1         Name2  Category2
3   8         Name3  Category3 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-04-19T09:17:26.207

更新：如果您想避免对所有字段进行分组，您可以按以下方式分组`Id`：

```
data.GroupBy(d => d.Id)
    .Select(
        g => new
        {
            Key = g.Key,
            Value = g.Sum(s => s.Value),
            Name = g.First().Name,
            Category = g.First().Category 
        }); 
```

但是此代码假定对于 each `Id`，相同`Name`且`Category`适用。如果是这样，您应该考虑按照@Aron 的建议进行规范化。这意味着将`Id`and保留`Value`在一个类中并将`Name`, `Category`（以及对于相同的任何其他字段相同`Id`）到另一个类，同时也具有`Id`供参考。规范化过程减少了数据冗余和依赖性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T09:09:19.287

```
void Main()
{
            //Me being lazy in init
    var foos = new []
    {
        new Foo { Id = 1, Value = 5},
        new Foo { Id = 1, Value = 7},
        new Foo { Id = 2, Value = 1},
        new Foo { Id = 3, Value = 6},
        new Foo { Id = 3, Value = 2},
    };
    foreach(var x in foos)
    {
        x.Name = "Name" + x.Id;
        x.Category = "Category" + x.Id;
    }
            //end init.

    var result = from x in foos
                group x.Value by new { x.Id, x.Name, x.Category}
                into g
                select new { g.Key.Id, g.Key.Name, g.Key.Category, Value = g.Sum()};
    Console.WriteLine(result);
}

// Define other methods and classes here
public class Foo
{
    public int Id {get;set;}
    public int Value {get;set;}

    public string Name {get;set;}
    public string Category {get;set;}   
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T09:14:24.960

尝试这个：

```
var objList = new List<SampleObject>();

objList.Add(new SampleObject() { ID = 1, Value = 5, Name = "Name1", Category = "Catergory1"});
objList.Add(new SampleObject() { ID = 1, Value = 7, Name = "Name1", Category = "Catergory1"});
objList.Add(new SampleObject() { ID = 2, Value = 1, Name = "Name2", Category = "Catergory2"});
objList.Add(new SampleObject() { ID = 3, Value = 6, Name = "Name3", Category = "Catergory3"});
objList.Add(new SampleObject() { ID = 3, Value = 2, Name = "Name3", Category = "Catergory3"});

var newList = from val in objList
              group val by new { val.ID, val.Name, val.Category } into grouped
              select new SampleObject() { ID = grouped.ID, Value = grouped.Sum(), Name = grouped.Name, Category = grouped.Category }; 
```

用 LINQPad 检查：

```
newList.Dump(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-30T08:43:43.307

如果你的课真的很长而且你不想复制所有的东西，你可以尝试这样的事情：

```
l.GroupBy(x => x.id).
  Select(x => {
    var ret = x.First();
    ret.value = x.Sum(xt => xt.value);
    return ret;
  }).ToList(); 
```

权力越大，责任越大。你需要小心。Line`ret.value = x.Sum(xt => xt.value)` **将更改**您的原始集合，因为您传递的是引用，而不是新对象。如果你想避免它，你需要在`Clone`你的类中添加一些方法`MemberwiseClone`（但同样，这会创建浅拷贝，所以要小心）。之后只需将行替换为：`var ret = x.First().Clone();`

# xml - 如何在 DOM Parser 中设置验证

> ID：16100903
> 
> 赞同：0
> 
> 时间：2013-04-19T08:58:09.233
> 
> 标签：xml, dom, xml-parsing

我正在使用 DOM 解析器我正在尝试设置验证。根据 DOMBuilderFactory 的[javadoc](http://docs.oracle.com/javase/6/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setValidating%28boolean%29)如果我将 setValidating 设置为 true 我无法理解它将验证什么？有人可以帮助我理解这一点吗？

```
javax.xml.parsers.DocumentBuilderFactory: factory.setValidating(true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:14:06.927

它将根据给定的模式或 DTD 进行验证。

给定以下示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.2.xsd">
   <foo></foo>
 </beans> 
```

这是一个格式良好的 XML，如果您不将 validate 设置为 true，则将解析文档。

但是，如果您将 validate 设置为 true，则文档结构将针对 `spring-beans-3.2.xsd`不允许该`foo`元素的架构进行验证。在这种情况下，解析器（文档生成器）将抛出 a `SAXParseException`。

XML 模式描述了文档中允许的元素和属性、数据类型、元素的顺序、出现次数等。例如，该模式允许`bean`元素嵌套在内部`beans`。

# multithreading - 多线程 AForge.NET 训练

> ID：16100908
> 
> 赞同：4
> 
> 时间：2013-04-19T08:58:43.560
> 
> 标签：multithreading, aforge, neural-network

我正在使用 AForge.NET ANN 并在我的训练集上对其进行训练。因为训练是单线程的，而且这个过程可能需要很长时间，所以我想知道是否可以运行多线程训练。

因为在训练弹性反向传播网络时使用线程是一个问题，所以我考虑在不同的网络之间拆分我的训练集，并且每 N 个 epoch 将所有网络的权重合并为一个，然后将其复制到所有线程（所以下一个 epoch 将从新的权重开始）。

我似乎无法在 AForge.NET 中找到结合两个（或更多）网络的方法。寻找有关如何开始实施过程的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T15:27:26.177

每 N 次迭代组合神经网络并不能很好地工作。只取权重并将它们组合起来可能非常棘手。在某些方面，这就是遗传算法的交叉操作的工作原理。

真正做到这一点的唯一方法是修改 AForge 的训练以支持多线程。基本上要做到这一点，您需要映射梯度计算，然后对梯度进行归约和。然后使用减少的梯度来更新网络。

我已经在 Encog 框架中实现了这个确切的东西，它支持多线程 (RPROP)，并且有一个 C# 版本。 [http://www.heatonresearch.com/encog](http://www.heatonresearch.com/encog)。

# c# - 我应该将服务注入到我的 MVC 视图中吗？

> ID：16100917
> 
> 赞同：9
> 
> 时间：2013-04-19T08:59:12.183
> 
> 标签：c#, asp.net-mvc, dependency-injection

我们正在使用 ASP.NET MVC 技术开发某种云 CMS，并在此过程中发现了一些障碍。用户可以通过控制面板更改许多参数，我们需要在视图中结束这些参数。例如，用于初始化 Facebook JS API 的 Facebook 应用程序 ID。或要在页面上显示的附加文本。或背景图片。现在我们没有使用 DI 来传输这些参数，而是将它们添加到 ViewModel，但这破坏了 ASP.NET MVC 处理模型的方式（例如表单验证、绑定等）

看起来使用 DI 注入提供参数、文本和图片的服务可以使我的视图减少对特定控制器的依赖，甚至还有一些微软技术可以做到这一点[http://www.asp.net/mvc/tutorials/动手实验室/aspnet-mvc-4-dependency-injection#Exercise2](http://www.asp.net/mvc/tutorials/hands-on-labs/aspnet-mvc-4-dependency-injection#Exercise2)。但是，论坛上有很多反对使用 DI 将服务注入视图的答案。

所以问题是：将一些服务注入视图的正确方法是什么？或者我根本不应该这样做并且应用程序设计有问题？

**更新**：一些真实的代码示例（现在我们使用模型来注入服务）

从数据库中注入文本（它们必须是用户可编辑的，因为它是 CMS）：

```
<div class="steps">@Html.Raw(Model.Texts["Main", "Step2"]</div> 
```

从数据库中注入翻译（实际上是本地化）：

```
<div class="gonfalon">@Model.Translations["Title_Winners"]</div> 
```

注入参数（来自数据库，可能是特定于请求的；例如，如果站点具有不同的域，则 facebook 应用程序应该是每个域的）：

```
Facebook.Initialize(Model.Parameters["FbApplicationId"], Model.Parameters["FbApplicationSecret"]); 
```

当前方法的问题是该代码取自竞赛机制。处理自定义文本、翻译或 facebook 应用程序 ID 绝对超出竞争业务范围。它还破坏了模型，因为模型模型不是实际的业务领域，而是处理很多实际上属于视图的东西（比如翻译和自定义文本）

**更新 2**：已将以下答案中的代码段修改为更通用：

```
public static class WebViewPageExtensions 
{ 
    public static I ResolveService<I>(this WebViewPage page) 
    { 
         return DependencyResolver.Current.GetService<I>(); 
    } 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T10:28:56.143

不，您不应该将服务注入视图，但是...

对于想要赋予主题开发者更多权力的主题化等场景，仅一种模型是不够的。例如，如果您的模型包含当前帖子，主题设计师如何要求侧边栏的类别列表？还是小部件？

在 asp.net mvc 中，您可以使用扩展方法来提供该功能。扩展方法将使用依赖解析器来获取服务。这样，您可以在视图中拥有所需的功能，而无需实际注入服务。

请注意，调用业务层更新模型仍然违反了关注点分离。视图可用的服务应该只包含读取模型或通用实用程序功能。

一个例子

```
 public static IMyViewServices MyServices(this WebViewPage view)
     {
         return DependencyResolver.Current.GetService<IMyViewServices>();
     } 
```

**在 DI 容器中配置的IMyViewServices**生命周期应该是每个 http（范围）请求

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T17:45:43.197

不，故事结束。为什么？原因如下：

您的视图只需要知道它将使用什么视图模型来呈现该模型。这有几个原因，但最大的一个是关注点分离。保持你的观点尽可能愚蠢。您将看到这种分离将在整个过程中为您提供一个干净的应用程序结构。

> 用户可以通过控制面板更改许多参数，我们需要在视图中结束这些参数。

我不确定你在这里的确切意思，但这就是为什么会有视图模型。您的业​​务层将塑造模型，您的控制器将简单地将它们映射到您的视图模型并将它们传递到视图（表示层）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T10:14:10.630

这实际上取决于您希望控制器执行多少操作以及您想要达到何种程度的分离。

在我的世界中，MVC 应用程序中的“控制器”做得尽可能少，因为我有一个处理所有业务逻辑的服务层和一个处理所有数据库交互的数据层。

在 GET 上，控制器将简单地调用一个服务方法，该方法将构建视图模型并将其交还给控制器，然后控制器将其传递给视图。在 POST 上，视图将数据发布到控制器，控制器将其发送到服务层进行验证、保存到数据库等。服务被注入到控制器的构造函数中。

如果您想查看代码示例，我将非常乐意发布它们。

# javascript - spring 3.0 web mvc中找不到JS和CSS文件错误

> ID：16100921
> 
> 赞同：2
> 
> 时间：2013-04-19T08:59:39.463
> 
> 标签：javascript, css, file, spring-mvc, include

我是 Spring 新手，我使用的是 spring 3.0 web mvc，我包含 js 和 css 文件，但它不适用于页面。Firebug 显示 js 和 css 文件的 404 错误。我尝试了很多组合来包含 js 和 css 文件，但没有任何效果。请为此提出一些建议。目录结构为：

```
SpringApp
--WebContent
  --resources
    --style.css
    --script.js
  --WEB-INF
    --views
           index.jsp
           --------- 
```

这是我的 web.xml 文件---

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">

<display-name>DojoSpring</display-name>
<servlet-name>SpringDojo</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
<load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
  <servlet-name>SpringDojo</servlet-name>
   <url-pattern>/</url-pattern>
</servlet-mapping> 
```

这是我的Spring配置文件-----

```
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

xsi:schemaLocation="http://www.springframework.org/schema/beans  
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/context 
http://www.springframework.org/schema/context/spring-context-3.0.xsd 
http://www.springframework.org/schema/mvc 
http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

<import resource="dbconfig.xml"/>

<mvc:annotation-driven />
<mvc:default-servlet-handler/>
<context:component-scan base-package="com.abc.controllers" />

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
<property name="prefix" value="/WEB-INF/views/"/>
<property name="suffix" value=".jsp"/>
</bean>

</beans>
</web-app> 
```

这是我的 index.jsp 文件--------

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Spring</title>
   <script type="text/javascript" src="/resources/script.js">
</head>
<body onload="testFun()">
    Welcome to spring world....
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:01:51.270

你能试试这个吗？

```
<display-name>DojoSpring</display-name>
<servlet-name>SpringDojo</servlet-name>
<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
<load-on-startup>2</load-on-startup>
</servlet>

<servlet>
<servlet-name>Resource Servlet</servlet-name>
<servlet-class>org.springframework.js.resource.ResourceServlet</servlet-class>
<load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
<servlet-name>SpringDojo</servlet-name>
<url-pattern>/</url-pattern>
</servlet-mapping>
<servlet-mapping>

<servlet-name>Resource Servlet</servlet-name>
<url-pattern>/resources/*</url-pattern>
</servlet-mapping> 
```

并`${pageContext.request.contextPath}/`为每次调用添加静态资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-25T19:39:38.527

在 web.xml 中添加以下内容

```
<servlet-mapping>
  <servlet-name>default</servlet-name>
  <url-pattern>*.css</url-pattern>
</servlet-mapping>
<servlet-mapping>
  <servlet-name>default</servlet-name>
  <url-pattern>*.js</url-pattern>
</servlet-mapping> 
```

并使用以下内容包含静态 js 文件

```
<script type="text/javascript" src="resources/script.js"> </script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-09T20:00:10.883

请检查此链接。我试过了，它对我很好。但只有当我将资源保存在 WEB-INF 文件夹之外时，它才对我有用。

[http://www.stackoverflow.com/questions/11952212/spring-3-1-javascript-file-not-found-404-error](http://www.stackoverflow.com/questions/11952212/spring-3-1-javascript-file-not-found-404-error)

# sonarqube - 与 jacoco 一起运行时，gwt-test-utils 单元失败

> ID：16100925
> 
> 赞同：5
> 
> 时间：2013-04-19T08:59:47.913
> 
> 标签：sonarqube, gwt-test-utils

我们正在尝试从使用 gwt-test-utils 编写的一组单元测试中为我们的 GWT 应用程序生成覆盖率报告。该项目是一个多模块的Maven项目。我们在 jenkins 上使用声纳插件来生成和整理我们的覆盖范围和违规信息。

当构建作业运行所有 GWT 单元测试作为正常构建的一部分通过时，但是当 Sonar 插件尝试重新运行测试时，它们都失败并出现以下错误：

> 初始化错误（uk.co.card.gwt.retailpost.client.dialog.productmodify.CurrencyEditDialogTest）经过时间：0秒<<<错误！com.googlecode.gwt.test.exceptions.GwtTestException：在 com.googlecode.gwt.test 的 com.googlecode.gwt.test.internal.GwtFactory.(GwtFactory.java:113) 生成 gwt-test-utils 先决条件时出错。 internal.GwtFactory.initializeIfNeeded(GwtFactory.java:45) 在 com.googlecode.gwt.test.internal.junit.AbstractGwtRunner.(AbstractGwtRunner.java:30) 在 com.googlecode.gwt.test.GwtRunner.(GwtRunner.java: 19) 在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39) 在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) 在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:

查看来自 jenkins 的其余控制台输出和工作区目录，我找不到“com.google.gwt.core.ext.UnableToCompleteException：（请参阅以前的日志条目）”所指的日志文件。

有没有人遇到过类似的问题并且知道如何让 Sonar 成功运行 gwt-test-utils，或者至少知道何时查找异常中提到的先前日志条目。

**编辑：经过进一步的实验，问题似乎是由 jacoco 引起的。尝试仅运行使用 jacoco 检测的单元测试（并且不涉及声纳）会导致相同的错误**

* * *

**编辑：

来自 pom.xml 的示例

```
 <build>
pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.jacoco</groupId>
                    <artifactId>jacoco-maven-plugin</artifactId>
                    <version>0.6.2.201302030002</version>
                </plugin>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <version>2.12.4</version>
                    <configuration>                        
                        <excludedGroups combine.self="override" />
                        <reuseForks>true</reuseForks>
                        <argLine>-Xmx1024m -XX:MaxPermSize=256m ${jacoco.agent.argLine}</argLine>
                    </configuration>
                </plugin>
</plugins>
        </pluginManagement>
        <plugins>            
            <plugin>
                <groupId>org.jacoco</groupId>
                <artifactId>jacoco-maven-plugin</artifactId>
                <configuration>
                    <propertyName>jacoco.agent.argLine</propertyName>
                    <destFile>${sonar.jacoco.itReportPath}</destFile>
                    <append>true</append>
                    <excludes>
                        <exclude>*.osgi.*</exclude>
                        <exclude>*.apache.*</exclude>
                        <exclude>*.sourceforge.*</exclude>
                        <exclude>*.junit.*</exclude>
                        <!-- Test support code does not need to be covered -->
                        <exclude>uk.co.card.retailpost.clientintegration.utilities.*</exclude>
                    </excludes>
                    <classDumpDir>temp/classes</classDumpDir>
                </configuration>
                <executions>
                    <execution>
                        <id>agent</id>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                    </execution>
                    <execution>
                        <id>report</id>
                        <goals>
                            <goal>report</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>   
        </plugins>
    </build> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:40:19.140

正如我在评论中提到的，使用 maven-surefire-plugin 的 jacoco 库以不同的顺序加载。要解决此问题，请编写您自己的运行程序（扩展 com.googlecode.gwt.test.GwtRunner）并更改线程 contextClassLoader 的类加载器。

```
import com.googlecode.gwt.test.GwtRunner;

    public class MyGwtRunner extends GwtRunner {

        static {
            URLClassLoader classLoader = (URLClassLoader) MyGwtRunner.class.getClassLoader();

            try {
                URL[] urls = getClassPath();
                ClassLoader cl = URLClassLoader.newInstance(urls, classLoader);
                Thread.currentThread().setContextClassLoader(cl);
            } catch (MalformedURLException e) {
                throw new IllegalStateException(e);
            }

        }

        public MyGwtRunner(Class<?> clazz) throws Throwable {
            super(clazz);
        }

        private static URL[] getClassPath() throws MalformedURLException {
            String classPath = System.getProperty("java.class.path");
            String pathSeparator = System.getProperty("path.separator");
            String[] array = classPath.split(pathSeparator);

            List<URL> files = new ArrayList<URL>();
            for (String a : array) {
                files.add(new File(a).toURI().toURL());
            }
            return files.toArray(new URL[files.size()]);
        }

    } 
```

在您的测试中，通过 MyGwtRunner 覆盖 GwtRunner

```
@GwtModule("com.my.module.GwtTestUtils")
@RunWith(MyGwtRunner.class)
public abstract class AbstractGwtJunit extends GwtTest { 
....
} 
```

# java - 如何从我的应用程序将小部件添加到 Android 主屏幕？

> ID：16100926
> 
> 赞同：20
> 
> 时间：2013-04-19T08:59:48.463
> 
> 标签：java, android, android-widget, homescreen

我正在编写一个应用程序，当用户指示我的应用程序这样做时，它应该能够将小部件（只是文本框）添加到用户手机的主屏幕。我怎么能做这样的事情？

我知道我可以添加一个应用小部件，但是添加更多呢？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-19T09:06:27.783

无法从应用程序将小部件放置在主屏幕中。只有主屏幕可以将应用小部件添加到主屏幕。

相似链接[link1](https://stackoverflow.com/a/7794568/931982) , [link2](https://stackoverflow.com/a/5104954/931982) , [link3](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/IxJFum0eaQ8)

但是您可以让用户从 widgetpicker 中选择小部件。

```
 Intent pickIntent = new Intent(AppWidgetManager.ACTION_APPWIDGET_PICK);
    pickIntent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetID);
    startActivityForResult(pickIntent, KEY_CODE); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-06-14T03:28:06.350

这是很久以前回答的，但如果有人偶然发现这个问题，我认为我应该提供一个最新的答案。

从 Android O (API 26) 开始，您现在可以将小部件从您的应用程序固定到用户的启动器！

只需在应用程序的 AndroidManifest 文件中创建小部件并使用[AppWidgetManager](https://developer.android.com/reference/android/appwidget/AppWidgetManager.html)请求将小部件固定到启动器。请注意，是否支持此功能取决于启动器，因此您必须在请求固定之前调用 AppWidgetManager 的[isRequestPinAppWidgetSupported()方法。](https://developer.android.com/reference/android/appwidget/AppWidgetManager.html#isRequestPinAppWidgetSupported())

以下是来自 Google 的一些更详细的文档：[https ://developer.android.com/preview/features/pinning-shortcuts-widgets.html#widgets](https://developer.android.com/preview/features/pinning-shortcuts-widgets.html#widgets)

希望这可以帮助！

编辑：自从我发布此答案以来，文档页面似乎发生了变化。这是一个更有用的链接，它提供了如何将小部件固定到启动器的代码示例：[https ://developer.android.com/guide/topics/appwidgets/#Pinning](https://developer.android.com/guide/topics/appwidgets/#Pinning)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T09:06:53.803

AFAIK 默认启动器应用程序不支持此功能。原因是用户应该自己将所有内容放在主屏幕上。允许从应用程序中放置小部件将为应用程序使用其“有用的”小部件向用户的家“发送垃圾邮件”打开大门。

# c# - 如何递归获取类别及其子类别的子类别

> ID：16100931
> 
> 赞同：1
> 
> 时间：2013-04-19T09:00:04.947
> 
> 标签：c#, asp.net-mvc, recursion

我正在尝试如下绘制我的网站地图

```
 <ul>
       <li>Cat1</li>           
       <li>Cat2                
             <ul class='sub2'>                     
                <li>Cat21</li>           
                <li>Cat22</li>
                <li>Cat23
                      <ul class='sub23'>                     
                            <li>Cat231</li>           
                            <li>Cat232</li>
                            <li>Cat233                                
                                   <ul class='sub233'>                     
                                      <li>Cat2331</li>           
                                      <li>Cat2332</li>
                                      <li>Cat2333</li>
                                   </ul>
                            </li>
                      </ul>
                 </li>
             </ul>
       </li>     
       <li>Cat3
             <ul class='sub3'>                     
                <li>Cat31</li>           
                <li>Cat32</li>
                <li>Cat33</li>
             </ul>
       </li>
       <li>Cat4</li>
 </ul> 
```

地图提供者是 PostCategory 对象的列表

```
 List<PostCategory> MapProvider=new List<PostCategory>();
///....MapProvider.add(...);
CategoryMapViewModel siteMap=new CategoryMapViewModel(MapProvider);
var map=siteMap.Map.ToString(); 
```

和 PostCategory 对象

```
public class PostCategory{
    [Key]
    public int? CategoryId{get;set;}

    [StringLength(20/*50*/,MinimumLength=3)]
    public string Name{get;set;}

    [StringLength(250)]
    public string Description { get; set; }

    //relationship
    public int? IdPostCategoryParent { get; set; }
    } 
```

我写了一些东西，但它不适用于子类别的子类别：例如：它适用于 sub2 但不适用于 sub23、sub332、sub....

这是我的 CategoryMapViewModel 类

```
public class CategoryMapViewModel
{
    public HtmlString Map { get; private set; }
    private List<int?> TakenIds = new List<int?>();
    public CategoryMapViewModel(List<PostCategoryModels> categoriesModels)
    {
        string map = "";
        map = BuildCategoriesMap(categoriesModels, map);
        this.Map = new HtmlString(map);
    }

    private string BuildCategoriesMap(List<PostCategoryModels> categories, string map)
    {
        if (categories != null && categories.Count > 0)
        {
            map += "<ul>";
            foreach (PostCategoryModels cat in categories)
            {
                if ((!cat.CategoryId.HasValue) || (cat.CategoryId.HasValue && (!TakenIds.Contains(cat.CategoryId))))
                {
                    map += "<li>" + cat.Name;
                    List<PostCategoryModels> subCats = categories.Where(c => c.IdPostCategoryParent == cat.CategoryId).ToList();
                    if (subCats.Count() > 0)
                    {
                        //map += BuildCategoriesMap(subCats, map);
                        //BuildCategoriesMap(subCats, map);
                        map += BuildCategoriesMap(subCats, "");
                    }
                    map += "</li>";
                }
                TakenIds.Add(cat.CategoryId);
            }
            map += "</ul>";
        }
        return map;
    }
} 
```

我错了吗 ？有人可以给我最好和最简单的方法吗？如果是，请这样做！亲切的问候！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:47:17.997

问题是您在类别中搜索子项，但是在处理直接子项时，您只传递直接子项，因此在搜索子类别时，没有匹配项。

一种解决方案是在您的类中保留对类别的引用，并在搜索子类别时使用它。

IE：

```
public class CategoryMapViewModel
{
    public HtmlString Map { get; private set; }
    private List<int?> TakenIds = new List<int?>();
    private List<PostCategoryModels> _categories;

    public CategoryMapViewModel(List<PostCategoryModels> categoriesModels)
    {    
        _categories = categoriesModels ?? new List<PostCategoryModels>();
        string map = BuildCategoriesMap(_categories);
        this.Map = new HtmlString(map);
    }

    private string BuildCategoriesMap(List<PostCategoryModels> categories)
    {
        var map = "";
        if (categories.Count > 0)
        {
            map += "<ul>";
            foreach (PostCategoryModels cat in categories)
            {
                if ((!cat.CategoryId.HasValue) || (cat.CategoryId.HasValue && (!TakenIds.Contains(cat.CategoryId))))
                {
                    map += "<li>" + cat.Name;
                    List<PostCategoryModels> subCats = _categories.Where(c => c.IdPostCategoryParent == cat.CategoryId).ToList();
                    map += BuildCategoriesMap(subCats);
                    map += "</li>";
                }
                TakenIds.Add(cat.CategoryId);
            }
            map += "</ul>";
        }
        return map;
    }
} 
```

我也去掉了一些多余的线

# c# - String.Contains() 是否比遍历字符串中的整个字符数组更快？

> ID：16100932
> 
> 赞同：5
> 
> 时间：2013-04-19T09:00:09.710
> 
> 标签：c#, performance

我有一个函数正在遍历字符串以查找模式并更改其中的部分。我可以通过插入优化它

```
if (!text.Contains(pattern)) return; 
```

但是，我实际上是在遍历整个字符串并将其中的一部分与模式进行比较，所以问题是，`String.Contains()`实际上是如何工作的？我知道有这样一个问题 - [String.Contains 是如何工作的？](https://stackoverflow.com/questions/3769519/how-does-string-contains-work)但答案相当不清楚。因此，如果`String.Contains()`也遍历整个字符数组并将它们与我正在寻找的模式进行比较，它不会真正使我的函数更快，而是更慢。

那么，尝试这样的优化是个好主意吗？而且 - 是否有可能`String.Contains()`比仅遍历整个数组并将每个字符与某个常量进行比较的函数更快？

这是代码：

```
 public static char colorchar = (char)3;

    public static Client.RichTBox.ContentText color(string text, Client.RichTBox SBAB)
    {
        if (text.Contains(colorchar.ToString()))
        {
            int color = 0;
            bool closed = false;
            int position = 0;
            while (text.Length > position)
            {
                if (text[position] == colorchar)
                {
                    if (closed)
                    {
                        text = text.Substring(position, text.Length - position);
                        Client.RichTBox.ContentText Link = new Client.RichTBox.ContentText(ProtocolIrc.decode_text(text), SBAB, Configuration.CurrentSkin.mrcl[color]);
                        return Link;
                    }

                    if (!closed)
                    {
                        if (!int.TryParse(text[position + 1].ToString() + text[position + 2].ToString(), out color))
                        {
                            if (!int.TryParse(text[position + 1].ToString(), out color))
                            {
                                color = 0;
                            }
                        }
                        if (color > 9)
                        {
                            text = text.Remove(position, 3);
                        }
                        else
                        {
                            text = text.Remove(position, 2);
                        }
                        closed = true;
                        if (color < 16)
                        {
                            text = text.Substring(position);
                            break;
                        }
                    }
                }
                position++;
            }
        }
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:30:29.890

简短的回答是您的优化根本不是优化。
基本上，`String.Contains(...)`只需返回`String.IndexOf(..) >= 0`
您可以将您的算法改进为：

```
int position = text.IndexOf(colorchar.ToString()...);
if (-1 < position)
{  /* Do it */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T14:04:12.577

如果您现在了解可用于优化的详细信息（不仅仅是简单的包含检查），请确保您可以使您的方法比 string.Contains 更快，否则 - 不会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:38:52.550

除非您已经对您的应用程序进行了概要分析，并确定这条线`String.Contains`是一个瓶颈，否则您*不应该*进行任何此类过早的优化。保持代码的意图清晰更为重要。

Ans 虽然有很多方法可以实现 .NET 基类中的方法，但您应该假设默认实现对于大多数人的用例来说已经足够优化了。例如，.NET 的任何（未来）实现都*可能*使用特定于 x86 的指令进行字符串比较。那么这总是比你在 C# 中可以做的更快。

如果您真的想确定您的自定义字符串比较代码是否比 快`String.Contains`，您需要使用多次迭代来测量它们，每次迭代都有不同的字符串。例如使用[`Stopwatch`类](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)来测量时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T09:15:57.733

检查这个类似的帖子[string.contains 是如何工作的](https://stackoverflow.com/questions/3769519/how-does-string-contains-work,)

我认为你将无法简单地做任何比 String.Contains 更快的事情，除非你想使用标准 CRT 函数 wcsstr，在 msvcrt.dll 中可用，这并不容易

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T09:15:09.727

是的。

并且没有错误（啊……）。

在很长的文本中查找多个子字符串有更好的方法，但对于最常见的用法，String.Contains（或 IndexOf）是最好的。

IIRC 的 String.Contains 的来源也可在 .Net 共享来源中找到

哦，如果您想要进行性能比较，您可以针对您的确切用例进行测量

# c - Linux 和 Windows 套接字 API

> ID：16100933
> 
> 赞同：3
> 
> 时间：2013-04-19T09:00:14.413
> 
> 标签：c, linux, windows, sockets, winsock

我想将一些特定于 Linux 的代码移植到包含套接字操作的 Windows。是否有任何第三方库可用于 Linux/BSD 套接字到 Winsock 的映射，例如用于线程操作的 pthread-w32 库？另外，我不能使用 Cygwin 工具链。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T09:35:09.457

好吧，我仍在努力，但这是新程序的开始：[https ://sourceforge.net/projects/libxc/](https://sourceforge.net/projects/libxc/)

# java - 如何停止正在运行的 TimerTask

> ID：16100935
> 
> 赞同：24
> 
> 时间：2013-04-19T09:00:27.163
> 
> 标签：java, timer

我正在尝试制作一个简单的计时器，在指定的秒数后播放哔声。我设法让它工作，但 TimerTask 在哔声后继续运行。现在我要停止执行吗？这是我的代码：

```
import java.util.Scanner;
import java.util.Timer;
import java.util.TimerTask;
import java.awt.Toolkit;

class Alarm {

    public static void main(String[] args) {
        long delay;
        Scanner scan = new Scanner(System.in);
        System.out.print("Enter a delay in seconds: ");
        delay = scan.nextInt()*1000;

        Timer timer = new Timer();

        TimerTask task = new TimerTask() {
            @Override
            public void run() {
                Toolkit.getDefaultToolkit().beep();
            }
        };

        timer.schedule(task, delay);
    }
} 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-19T09:03:18.427

您需要通过调用以下方法取消定时器

```
timer.cancel();  // Terminates this timer, discarding any currently scheduled tasks.
timer.purge();   // Removes all cancelled tasks from this timer's task queue. 
```

这将取消任务，所以这样的事情会起作用：

```
import java.util.Scanner;
import java.util.Timer;
import java.util.TimerTask;
import java.awt.Toolkit;

class Alarm {

    private static boolean run = true;

    public static void main(String[] args) {
        long delay;
        Scanner scan = new Scanner(System.in);
        System.out.print("Enter a delay in seconds: ");
        delay = scan.nextInt()*1000;

        final Timer timer = new Timer();

        final TimerTask task = new TimerTask() {
            @Override
            public void run() {
                if(run) {
                   Toolkit.getDefaultToolkit().beep();
                } else {
                   timer.cancel();
                   timer.purge();
                }
            }
        };

        timer.schedule(task, delay);

        // set run to false here to stop the timer.
        run = false;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-22T07:59:32.467

这对我有用（也使用了 purge() 建议）：

```
import java.util.Scanner;
import java.util.Timer;
import java.util.TimerTask;
import java.awt.Toolkit;

class Alarm {

    public static void main(String[] args) {
        long delay;
        Scanner scan = new Scanner(System.in);
        System.out.print("Enter a delay in seconds: ");
        delay = scan.nextInt()*1000;

        final Timer timer = new Timer();

        final TimerTask task = new TimerTask() {
            @Override
            public void run() {
                Toolkit.getDefaultToolkit().beep();
                timer.cancel();
                timer.purge();
            }
        };

        timer.schedule(task, delay);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T09:02:08.817

`cancel()`应该这样做 -`cancel`停止给定的取消`TimerTask`/`Timer`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-08T12:35:25.377

isStart = true; // 如果真正的定时器函数 countiue 被调用，否则时间取消
Timer timer = new Timer(); timer.schedule(new TimerClass(), 0, 5000);

```
class TimerClass extends TimerTask {

    public void run() {

        if (isStart) {
           yourFunction();
        }else {
            cancel();
        }

    }
} 
```

# sql - vb.net中的十进制值总和不正确

> ID：16100936
> 
> 赞同：0
> 
> 时间：2013-04-19T09:00:27.773
> 
> 标签：sql, sql-server, vb.net, decimal

我正在从 T-SQL 过程中提取数据，我的一列被转换为 numeric(18,2)

当我运行此过程并将数据复制到 excel 时，此列的总和比我在 vb.net 上运行时得到的总和少 0.01。

在 vb.net 中，我将列的值聚合到字典中（字符串，十进制）

我不知道为什么会这样。

```
 If Not dr.IsDBNull(dr.GetOrdinal(f.field)) Then
        Dim dval = If(dr.IsDBNull(dr.GetOrdinal(f.field)), 0D, dr.GetDecimal(dr.GetOrdinal(f.field)))
        di.Add(New FieldValue With {.Type = f, .Value = If(rpt.allow_negatives, dval, Math.Abs(dval))}, rpt.overide_format)
        If rpt.has_total AndAlso f.totaled Then totals(f.field) += dval
    Else
        di.Add(New FieldValue With {.Type = f, .Value = 0D})
    End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T11:05:55.533

Math.Abs​​ 有一个`decimal`重载，所以可能不是这样。更有可能是 Excel 计算错误。Excel 通常会丢弃超过 15 位精度的任何内容。

请参阅：[http ://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel](http://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel)

要向自己证明这一点，请键入

```
 1234567890123456.78 
```

到 Excel 单元格中。你会看到这个数字最终是：

```
 1234567890123450 
```

# c# - C# STAThread COMException

> ID：16100941
> 
> 赞同：7
> 
> 时间：2013-04-19T09:00:48.387
> 
> 标签：c#, .net, com, sta

我有一个外部组件 (C++)，我想从我的 C# 代码中调用它。

代码是这样的：

```
using System.Text;
using System.Threading;
using System.Threading.Tasks;

namespace dgTEST
{
    class Program
    {
        [STAThread]
        static void Main(string[] args)
        {
            ExtComponentCaller extCompCaller = new ExtComponentCaller();
            result = extCompCaller.Call(input);

            Thread t = new Thread(new ThreadStart(() =>
            {
                try
                {
                    result = extCompCaller.Call(input);
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.ToString());
                }
            }));

            t.SetApartmentState(ApartmentState.STA);
            t.Start();
            t.Join();
        }
    }
} 
```

所以问题是，在第一次调用时它运行良好，调用了外部组件，我得到了结果。

但是当我尝试在另一个线程中调用它时，我遇到了一个异常： System.InvalidCastException: Unable to cast COM object of type 'System.__ComObject' ... 。由于 STAThread，我确定抛出了这个异常。因为如果我从 Main 函数中删除 [STAThread] 属性，外部组件的第一次调用也会发生同样的情况，它工作正常。

如何从其他线程调用此外部组件以消除此异常？

更新 - - - - - - -

现在发生了其他疯狂的事情。当我使用 F5 从 Visual Studio 启动程序时，问题也出现在第一次调用中，但是当我直接执行二进制 .exe 文件时，它正在工作（从另一个线程它不是:(）。如果我切换从 Debug 到 Release 的构建并使用 F5 从 Visual Studio 启动它，第一个调用再次工作。

为什么会这样？

提前感谢您的帮助！

最好的问候，佐利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T13:39:52.190

线程从来都不是一个小细节。如果代码没有明确记录支持线程，那么 99% 的可能性是它不支持它。

显然这个组件不支持线程。创建另一个 STA 线程不是神奇的解决方案，它仍然是一个不同的线程。InvalidCastException 告诉您它还缺少编组来自工作线程的调用所需的代理/存根支持，就像您尝试创建的那样。需要对非线程安全的代码进行线程安全调用。尽管您确实违反了 [STAThread] 的合同，但它必须泵送一个消息循环。消息循环允许从工作线程调用非线程安全的组件。你从 Application.Run() 中得到一个消息循环。

这是降压停止的地方。它不是线程安全的，期间。即使修复了您的主线程或要求供应商或作者为您提供代理/存根，您仍然没有完成您打算做的事情，它实际上不会在您创建的那个工作线程上运行。所以它必须看起来像这样：

```
 static void Main(string[] args)
    {
        Thread t = new Thread(new ThreadStart(() =>
        {
             ExtComponentCaller extCompCaller = new ExtComponentCaller();
             result = extCompCaller.Call(input);
        }));

        t.SetApartmentState(ApartmentState.STA);
        t.Start();
        t.Join();
    } 
```

它在您进行调用的同一线程上创建对象，因此它是线程安全的。仍然存在这个工作线程不泵送消息循环的问题，COM 组件往往依赖于此。您会从死锁或未运行的事件中发现这是否是一个问题。如果当您从主线程调用它时它已经在您的测试程序中运行良好，那么您可能可以不用抽水。

# javascript - 从 webview Android 调用 javascript 函数

> ID：16100944
> 
> 赞同：0
> 
> 时间：2013-04-19T09:00:56.547
> 
> 标签：javascript, android

我有一个 webview，它加载了一个 html 文件。

现在我想从 webview 调用 Javascript 函数 DataInput()。

这是我的代码。但是控制台返回

```
E/Web Console(435): Uncaught ReferenceError: DataInput is not defined:1 
```

有人知道为什么吗？谢谢！

```
WebView engine = (WebView) (findViewById(R.id.webView1));

    engine.setWebViewClient(new WebViewClient());
    engine.setWebChromeClient(new WebChromeClient() {
          public boolean onConsoleMessage(ConsoleMessage cm) {
                Log.d("MyApplication", cm.message() + " -- From line "
                                     + cm.lineNumber() + " of "
                                     + cm.sourceId() );
                return true;
              }
            });
    engine.getSettings().setJavaScriptEnabled(true);
    engine.getSettings().setPluginsEnabled(true);

    engine.loadUrl("file:///" + path);
    engine.loadUrl("javascript:DataInput()"); 
```

我的 html 文件包含以下代码：

```
<script type="text/javascript">    
function DataInput( )
{   
  $( "video" ).each( function(e){this.play();}   );
  $( "video" ).bind( "ended", function(e){this.play();});
}
</script> 
```

进一步编辑::::::

我添加了一个按钮并在 onclick 时调用 JS 并且它（有点）工作......即

```
public void onClick(View arg0) {
    engine.loadUrl("javascript:DataInput()");

} 
```

怎么来的？？？？我真的很想知道为什么......

PS我说（有点）有效，因为视频确实自动播放（由于 $( "video" ).each( function(e){this.play();} );）但没有循环播放（$( "video" ） .bind("结束", function(e){this.play();}); <<< 不工作)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:42:15.403

将您的 Javascript 更改为此

```
<script type="text/javascript" src="location_of_your_jquery_file" />
<script type="text/javascript">
$(document).ready(function () {
    $.fn.gotofunc = function () {
        $("video").each(function (e) {
            this.play();
        });
        $("video").bind("ended", function (e) {
            this.play();
        });
    };

    function DataInput() {
        $.fn.gotofunc();
    }
});
</script> 
```

# ruby - Ruby - 在任何来源中都找不到 i18n-0.6.1

> ID：16100948
> 
> 赞同：0
> 
> 时间：2013-04-19T09:01:03.260
> 
> 标签：ruby, gem, redmine, puppet, i18n-gem

我正在尝试安装 Redmine，但在最后的步骤中遇到了麻烦。我以前从未使用过 Ruby 环境，我是一个完整的初学者。

```
$ RAILS_ENV=production rake db:migrate
Could not find i18n-0.6.1 in any of the sources
Run `bundle install` to install missing gems. 
```

（捆绑安装没有帮助。）所以我尝试“gem install i18n -v 0.6.1”，告诉我“1 gem installed”，一切正常。

而且它仍然不起作用，当我'gem list'时仍然没有得到i18n（任何版本）

以前的答案对我没有任何帮助，我没有使用乘客。

谢谢。

编辑：我找到了我的宝石所在的目录，/var/lib/gems/1.8/gems in18-0.6.1 和其他宝石在这里，但未在“宝石列表”中列出

编辑2：好的，我的问题现在更精确了。我实际上正在尝试编写一个 puppet 脚本来安装 Redmine，而“bundle install”实际上是在命令行上工作，而不是在 exec puppet 资源中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:44:30.537

如果您在远程安装 gems 时遇到问题并且没有经常更新项目，您可以缓存 gems 并将它们添加到 git by `bundle package`并在 by 之后安装它们 `bundle install --local`

# excel - 如何获取VBA中所有图表系列的源数据？

> ID：16100955
> 
> 赞同：2
> 
> 时间：2013-04-19T09:01:40.047
> 
> 标签：excel, vba, charts

```
With ActiveWorkbook.Sheets(1)
INSPECT_CHARTS_NUMBER = .ChartObjects.Count
For c= 1 To .ChartObjects.Count
Set INSPECT_CHART = .ChartObjects(c).Duplicate

.ChartObjects(c).Chart.SetSourceData Source:=.Range("e4:h4")

Next lngC
End With 
```

我执行上述操作以更改 VBA 中图表的源数据，这条线`.Chart.SetSourceData Source:=.Range("e4:h4")`确实可以完成工作，但如果该图表中有多个系列，这将不起作用。

如何获取所有系列的源数据，然后如何单独更改它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:16:19.133

这是一个例子

假设活动图表的系列集合正在从`A1:A5`和中选择值`C1:C5`。所以下面的代码会将源代码更改为`A8:A12`和`C8:C12`

```
Dim sc As SeriesCollection
Dim i as Long, j as Long

j = 1

For i = 1 To ActiveChart.SeriesCollection.Count
    ActiveChart.SeriesCollection(i).Values = "=Sheet1!R8C" & j & ":R12C" & j
    j = j + 2 '<~~ Adding 2 for Col C
Next 
```

**截屏**

前

![在此处输入图像描述](https://i.stack.imgur.com/sA1Gj.png)

后

![在此处输入图像描述](https://i.stack.imgur.com/aNq4E.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T09:17:12.470

采用`.seriescollection`

```
Set ChartSeries = ChartObj.Chart.SeriesCollection.NewSeries

With ChartSeries
    .Name = "Chart Series 1"
    .Values = Array(1, 2, 3, 4, 5)
    .XValues = Array("alpha", "beta", "gamma", "delta", "epsilon")
End With 
```

更多关于这个[链接](http://www.databison.com/index.php/vba-chart/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-07T11:56:26.920

您可以通过检索系列**.Formula**字符串来访问图表系列的数据源。

之后，您可以更改公式（例如使用替换），然后重新应用该系列的公式。

代码示例（为 Sid 的解决方案提供）：

```
Dim chart As ChartObject

For Each chart In ActiveSheet.ChartObjects

    Dim ser As Series

    For Each ser In chart.Chart.SeriesCollection
        Dim oF As String
        Dim nF As String
        oF = ser.Formula
        nF = Replace(oF, "$1", "$8") ' Changing the row 1 to row 8
        nF = Replace(nF, "$5", "$12") ' Changing the row 5 to row 12
        ser.Formula = nF
    Next ser

Next chart 
```

请务必使用**$**符号，因为系列**.Formula**使用数字表示图表**类型**。该符号有助于省略替换公式中的图表类型。

希望这可以帮助...

# css - 防止 :after 元素换行到下一行

> ID：16100956
> 
> 赞同：93
> 
> 时间：2013-04-19T09:01:46.167
> 
> 标签：css

我有这个 HTML：

```
<ul>
    <li class="completed"><a href="#">I want the icon to stay on the same line as this last <strong>word</strong></li>
</ul> 
```

我正在使用 :after 伪元素附加一个图标：

```
ul li.completed a:after {
    background:transparent url(img.png) no-repeat; 
    content: '';
    display:inline-block;
    width: 24px;
    height: 16px;
} 
```

问题：如果可用宽度太小，图标会换到下一行。我希望它与附加到的链接的最后一个单词保持在同一行：

![在此处输入图像描述](https://i.stack.imgur.com/coNwL.png)

这是可行的，而不是在整个链接中添加“nowrap”（我希望文字换行，而不是图标）。

[请参阅此处](http://jsfiddle.net/Bk38F/)的jsFiddle 。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2014-09-15T22:38:16.707

JSFiddle - [http://jsfiddle.net/Bk38F/65/](http://jsfiddle.net/Bk38F/65/)

为伪元素添加负边距，以补偿其宽度：

```
ul li.completed a:after {
    background:transparent url(img1.png) no-repeat; 
    content: ' ';
    display: inline-block;
    width: 24px;
    height: 16px;
    margin-right: -24px;
} 
```

现在，这将使图标溢出容器，并且只有当文本遇到行尾时，行才会中断。如果需要将图标保持在原来的容器宽度内，可以添加 padding 再次补偿：

```
ul li.completed a {
    display: inline-block;
    padding-right: 24px;
} 
```

* * *

**重要更新：**

要使此方法起作用，文本和包含伪元素的元素的结束标记之间必须没有空格。即使伪元素的宽度被负边距补偿，空白也会在它遇到父元素的边缘时使换行。例如，这有效：

```
<span>text goes here</span> 
```

这**不是**：

```
<span>
    text goes here
</span> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-19T09:17:11.503

您可以将图像添加到最后一个单词。这将使它破裂在一起。

给单词添加一个类 `<strong class="test">word</strong>`

和`.test:after { ...`

[http://jsfiddle.net/52dkR/](http://jsfiddle.net/52dkR/)

诀窍也是使该课程成为`inline-block`

如果您想保留下划线，请参阅此。

[http://jsfiddle.net/atcJJ/](http://jsfiddle.net/atcJJ/)

添加 `text-decoration:inherit;`

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-07-17T05:44:44.300

这与之前的答案有点相似，但我认为我会充实并充分解释它。

一旦设置`display: inline-block`,`:after`就成为非文本绑定元素。这就是它会换行的原因，也是 nowrap 无效的原因。所以别管`display`了。

由于默认情况下它是一个文本元素，因此只要它们之间没有空格，内容就会绑定到以前的文本。所以不要添加任何东西，但要确保你有`content: ""`，或者它与`display: none`. 唯一的问题是`height`并且`width`由 控制`content`，在这种情况下它是折叠的。也是，`width`是线高。`0``height`

使用填充调整区域大小；左或右，无所谓。添加一点`margin`，使图标不会触及文本。将所有内容保持为相对大小（`em`、`pt`等），并使用`background-size: contain`，以便图标随文本缩放，如表情符号或字体。最后将图标放置在您想要的位置`background-position`。

```
ul li.completed a:after {
  content: "";
  background: url('icon.svg');
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center center;
  margin-left: 0.2em; /* spacing*/
  padding-right: 0.75em; /* sizing */
} 
```

我已将它用于我的外部链接 ( `a[href*="://"]:after`)，它在 Firefox、Chrome 和 iOS 中运行良好。而且由于图标仍然是文本元素，即使是绑定后的直接文本，所以任何结束标点符号也会换行。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-12-11T21:55:08.343

如果使用图标字体：使用“不间断空格”unicode`\00a0`以及伪元素内容（在本例中为 Font Awesome 字形）。

这无需任何额外的标记或特殊格式或类名即可工作。

```
a[href^='http']::after {
  content: '\00a0\f14c';
  font-family: 'Font Awesome 5 Pro', sans-serif;
  line-height: 0;
} 
```

当最后一个“单词 + 图标”换行时，该`line-height: 0;`部件可防止线条抽搐。

[代码笔示例](https://codepen.io/jasesmith/pen/aPOygy/?editors=1100)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-06-27T18:43:57.087

我遇到了同样的问题。我真的不喜欢在最后一个词中添加强或跨度标签的想法，所以我尝试简单地将图标添加为背景图像，并带有一些填充权，而不是使用 :after 或 :before 伪元素。为我工作！

```
<ul><li class="completed"><a href="#">I want the icon to stay on the same line as this last word</a></li></ul> 
```

* * *

```
ul li.completed a {
background: url(img1.png) no-repeat 100% 50%;
padding-right: 18px;
} 
```

[http://jsfiddle.net/atcJJ/36/](http://jsfiddle.net/atcJJ/36/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-01-05T19:58:49.790

我正在尝试使用链接按钮进行此操作，并且按照@Hugo Silva 的建议在元素右侧添加填充最成功，然后将 ::after 设置为绝对位置。这是一个非常简单的解决方案，似乎适用于现代浏览器。

```
.button {
  position: relative;
  color: #F00;
  font-size: 1.5rem;
  padding-right: 2.25rem;
}

.button::after {
  content: '>>';
  display: inline-block;
  padding-left: .75rem;
  position: absolute;
} 
```

[这是一个 JS Fiddle。](https://jsfiddle.net/osey8duq/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-04-19T09:11:30.013

请确保您在结束标签之前

```
<ul><li class="completed"><a href="#">I want the icon to stay on the same line as this last <strong>word</strong></a></li></ul> 
```

试试下面的css。而不是使用“之后”使用“之前”并向右浮动。

```
ul li.completed a:before {
    background:transparent url(img1.png) no-repeat; 
    content: '';
    display:inline-block;
    width: 24px;
    height: 16px;
    float:right;
} 
```

请检查：http: [//jsfiddle.net/supriti/atcJJ/7/](http://jsfiddle.net/supriti/atcJJ/7/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-12-23T09:23:32.933

没有`:after`. 带背景的元素应该是`display:inline`.

```
<h1><span>I want the icon to stay on the same line as this last word</span></h1>

h1 span {
   padding-right: 24px;
   background: url('icon.svg') no-repeat right top; 
} 
```

[http://jsfiddle.net/my97k7b1/](http://jsfiddle.net/my97k7b1/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-04-13T14:57:28.170

当元素的文本末尾有空格时会出现问题，因此它将图标视为另一个单词。我的解决方案是使用 javascript 删除空格并将其放在元素之外。此外，通过这种方式，我们避免了`text-decoration:underline`可能位于链接末尾的空白的样式：

```
$(document).ready(function () {
  $("a[href$=\".pdf\"]").each(function () {
    var endspace = /\s$/;
    if (endspace.test($(this).html())) {
      var linktx = $(this).html().replace(/\s*$/, "");
      $(this).html(linktx);
      $(this).after(" ");
    }
  });
}); 
```

在 css 中，我在图标前添加了一个不间断空格`\00A0`，以将其与文本分开，并根据字体大小进行缩放。在某些情况下，使用狭窄的不间断空间`\202F`可以提供更好的视觉效果：

```
a[href$=".pdf"]:after {
  content: "\00A0\f1c1";
  font-family: "Font Awesome 5 Pro";
} 
```

[https://jsfiddle.net/poselab/910bw7zt/8/](https://jsfiddle.net/poselab/910bw7zt/8/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-16T07:40:00.240

我刚刚使用： `white-space: nowrap;` 为我工作！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-15T22:39:25.233

对于我的特定设置，唯一可行的解​​决方案是使用相对位置，并将我的图标元素放置在具有绝对位置的跨度中。像这样：

```
h2 a {
            position: relative;
            width: auto;
}
h2 a span {
            position: absolute;
            right: -30px;
            bottom: 0;
 }
```

```
<h2>
    <a href="#">
            The arrow won't drop to the next line as an orphan, even if the text is long and responsive
         <span>&#8594;</span>
    </a>
</h2>
```

# c - gst_parse_launch() 的限制？

> ID：16100967
> 
> 赞同：5
> 
> 时间：2013-04-19T09:02:10.567
> 
> 标签：c, gstreamer

据我了解，**gst_parse_launch()**基于描述管道的命令行语法创建了一个新管道。它会自动处理请求垫（有时是垫等）的所有复杂细节，并构建管道。

所以我的问题是，为什么不一直使用它呢？为什么还要添加垫添加处理程序、请求和链接垫等？

有没有使用**gst_parse_launch()**的情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T12:08:04.630

许多 GStreamer 元素将使用这些特性来探测它们应该加载的插件。想到的最好的例子是**decodebin**或**playbin**插件。对于第一个，您只需选择源（例如**filesrc**）。

现在，播放我们的媒体流时会发生什么？

一开始，**decodebin**的“内部”只有：

--- 接收器 -->|[ 类型查找] |

此时没有源垫出现，因为该元素仍然不知道流内容。

如果您有*avi*视频文件，那么**decodebin**将首先使用特定的 GStreamer 元素来探测流中使用的容器/编解码器是什么。此元素 ( [GstTypeFind](http://gstreamer.freedesktop.org/data/doc/gstreamer/head/gstreamer/html/gstreamer-GstTypeFind.html) ) 将根据流和编解码器/容器之间的相似性计算分数。

在这个例子中，TypeFind 将命中*avi*容器，因此它会分配一个*avi*解析器。**decodebin**的“内部”现在正在扩展...... *avi*解析器分析流以了解是否有音频/视频子流需要解析。如果是这样，则 typefind 再次进入以查找使用的编解码器。

然后分配适当的解码器。在这里，**decodebin**现在已经完全准备好了，下游元素（如 sink 元素）必须链接到新创建的 source pad 以使流继续运行。这是通过**焊盘添加**信号和焊盘链接程序完成的。

如果没有任何这些焊盘功能，则无法实现此行为，并且必须*在金属中*静态设置所有内容，然后才能获取流。这意味着您必须提前知道您将要阅读的流的内容是什么（这是一个*非常非常*严格的限制！）

最后一点：当您通过命令行指定管道时（就像`gst-launch`我猜的那样），您处于高级界面。在您指定的元素中，焊盘链接机制可能非常重要！事情是你不必费心，因为事情会完成。但是“不必为某事烦恼”并不意味着这件事对你没用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T13:58:44.307

如果使用 gst-launch，则只能运行静态管道。也就是说，您无法搜索，无法随时间改变音量，无法播放第二个文件。

gst-launch 实际上是作为一个开发者工具来尝试一个元素或一些属性。

# zend-framework2 - ZEND2 项目在克隆到单独的机器后不工作

> ID：16100977
> 
> 赞同：0
> 
> 时间：2013-04-19T09:02:37.767
> 
> 标签：zend-framework2

我已经从我们的服务器克隆了我办公室同事的 zend2 项目。他使用了 zfcuser、zfcbase 和 zfcadmin。但是当我试图在我的本地机器上运行该项目时

```
<b>Fatal error</b>:  Uncaught exception 'Zend\ModuleManager\Exception\RuntimeException'
with message 'Module (ZfcBase) could not be initialized.' in C:\xampp\htdocs\coolshop
\vendor\ZF2\library\Zend\ModuleManager\ModuleManager.php:140 
```

一切对我来说都很好，因为同一个项目 100% 在我同事的机器上工作。我也试过作曲家。但没有运气

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:09:51.623

这是将 ZfcBase 模块作为 git 子模块加载的结果。如果您修复此模块，您将以这种方式使用的其他模块或依赖项收到相同的错误。当有人尝试在新机器上克隆项目或您在本地删除项目并尝试重新克隆时，我遇到了这个问题。

这里的简单答案是使用 composer 作为你的依赖管理器，你会有更好的一天。前往[Packagist 上的ZfcBase](https://packagist.org/packages/zf-commons/zfc-base)并将require 语句复制到您的composer.json 文件中（您需要在保存.json 文件后运行composer 脚本）。大多数模块应该在 README 中有关于使用 composer 获取它们的说明。我应该注意，如果您使用其他依赖于 ZfcBase 的模块，您可能只需要为这些模块添加一个 require 语句，而不是它们的依赖项（如 ZfcBase）。

有人对 ZfcUser 模块[有类似的问题。](https://stackoverflow.com/questions/15848593/module-zfcuser-could-not-be-initialized/15883004#15883004)使用作曲家解决了他的问题。

# ruby-on-rails - 我得到“未定义的方法‘has_key？’ 对于 nil:NilClass" 用于所有错误

> ID：16100978
> 
> 赞同：1
> 
> 时间：2013-04-19T09:02:38.820
> 
> 标签：ruby-on-rails, ruby-on-rails-3, debugging, error-handling

我的 Rails 版本是 3.0.4.rc1 和 ruby​​ 1.9.3p194

我面临着非常奇怪的问题。

在我的项目中，我得到了`ERROR NoMethodError: undefined method`has_key？对于 nil:NilClass `in development.log file and`Internal Server Error`has_key?' for nil:NilClass`浏览器中未定义的方法。

对于任何错误，如果它的无效语句、未定义的变量、引发、退出、错误的数据库名称.. 或其他任何错误，我只会收到上述错误消息。太令人沮丧了，我无法知道错误是什么或错误在哪里（行号和文件名）。

如果没有错误，它可以正常工作，但是当有任何错误（引发、退出或任何其他错误）时，它会显示相同的错误消息。即`undefined method`has_key？对于零：NilClass`

错误日志：

```
[2013-04-19 14:41:07] ERROR NoMethodError: undefined method `has_key?' for nil:NilClass
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.4.rc1/lib/active_support/whiny_nil.rb:48:in `method_missing'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.2.5/lib/rack/runtime.rb:20:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.0.4.rc1/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.2.5/lib/rack/lock.rb:13:in `block in call'
<internal:prelude>:10:in `synchronize'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.2.5/lib/rack/lock.rb:13:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.0.4.rc1/lib/action_dispatch/middleware/static.rb:30:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.4.rc1/lib/rails/application.rb:168:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.4.rc1/lib/rails/application.rb:77:in `method_missing'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.0.4.rc1/lib/rails/rack/log_tailer.rb:14:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.2.5/lib/rack/content_length.rb:13:in `call'
/home/shweta/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.2.5/lib/rack/handler/webrick.rb:52:in `service'
/home/shweta/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/home/shweta/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/home/shweta/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

[这表明当模型中存在语法错误时会出现此类问题](https://stackoverflow.com/questions/9440325/rails-3-2-undefined-method-key-for-nilnilclass#answer-12668009)，但我的模型文件很好。

请帮忙。

PS我在rails控制台中没有这个问题。

# asp.net - ASP.net webapplication 挂起任何请求

> ID：16100986
> 
> 赞同：0
> 
> 时间：2013-04-19T09:03:06.437
> 
> 标签：asp.net, vb.net, iis-7, crystal-reports

全部，

我们在 IIS7.0 中托管了 ASP.net 应用程序。它运行平稳超过 2 年。目前我们面临以下问题。每当用户执行活动时，应用程序就会挂起并且没有给出任何响应。这些活动涉及使用水晶报表工具生成报表。我们分析了数据库，也没有调用数据库。我们重新启动了应用程序池，它工作正常。但我们经常面临这个问题。请提供任何解决方案。

语言：VB.Net 框架：.Net 2.0 应用：ASP.Net 组件：Crystal report 10

# tags - Flickr Context Similarity 或 Normalized Google Distance 是否有任何实现？

> ID：16100987
> 
> 赞同：1
> 
> 时间：2013-04-19T09:03:15.300
> 
> 标签：tags, semantics, flickr

我需要测量两个标签之间的语义相似度

最好的方法是使用 FCS（Flickr 上下文相似度），因为我的标签与从 Flickr 爬取的图像相关联。

本文档展示了如何从理论上计算它 [http://www.ee.columbia.edu/ln/dvmm/researchProjects/MultimediaIndexing/CBVS_FCS/CBVS_FCS.htm](http://www.ee.columbia.edu/ln/dvmm/researchProjects/MultimediaIndexing/CBVS_FCS/CBVS_FCS.htm)

java或任何其他语言中是否有任何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T09:36:10.920

这里有一个标准化谷歌距离的实现：[https ://code.google.com/p/ext-c/source/browse/trunk/src/nz/ac/vuw/ecs/kcassell/similarity/GoogleDistanceCalculator.java ?r=28](https://code.google.com/p/ext-c/source/browse/trunk/src/nz/ac/vuw/ecs/kcassell/similarity/GoogleDistanceCalculator.java?r=28)

将结果用作高斯分布的输入，这就是 FCS（如您发布的链接中所述）

# php - 自定义日期和数字格式字符串（带填充和偏移）

> ID：16100990
> 
> 赞同：0
> 
> 时间：2013-04-19T09:03:23.490
> 
> 标签：php, preg-match, string-formatting

我尝试根据定义的掩码创建可自定义的数字。
这是我制作面具的规则

您可以输入任何编号掩码。在此掩码中，可以使用以下标签：`{000000}`对应于每个客户都会递增的数字。

输入与所需的计数器长度一样多的零。

计数器将由左侧的零完成，以便具有与掩码一样多的零。

`{000000+000}`与之前相同，但从`+`first 开始应用与符号右侧数字相对应的偏移量。

`{000000@x}`与上一个相同，但当`x`达到月份时（`x`1 到 12 之间），计数器将重置为零。

如果使用此选项并且为 2 或更高，则还需要`x`序列`{yy}{mm}`或。`{yyyy}{mm}`

`{dd}`天（01 至 31）。

`{mm}`月（01 至 12）。

`{yy}`，`{yyyy}`或`{y}`超过 2、4 或 1 个数字的年份。

面具中的所有其他字符将保持不变。

不允许有空格。

2007 年 3 月 1 日创建的客户示例：
`ABC{yy}{mm}-{000000}`将给予`ABC0701-000099`，
`{0000+100}-ZZZ/{dd}/XXX`将给予`0199-ZZZ/31/XXX`

所以我现在的面具是`C{000000}`

```
 <?php
    $mask = "C{000000}";
$number = 100;
    if (preg_match('/\{(0+)([@\+][0-9]+)?([@\+][0-9]+)?\}/i',$mask,$regType)){
        $masktype=$regType[1];
        $masktype_value=substr(preg_replace('/^TE_/','',$number),0,strlen($regType[1]));//get n first characters of code where n is length in mask
        $masktype_value=str_pad($masktype_value,strlen($regType[1]),"#",STR_PAD_RIGHT);
        $maskwithonlyymcode=$mask;
        $maskwithonlyymcode=preg_replace('/\{(0+)([@\+][0-9]+)?([@\+][0-9]+)?\}/i',$regType[1],$maskwithonlyymcode);
        $maskwithonlyymcode=preg_replace('/\{dd\}/i','dd',$maskwithonlyymcode);
        $maskwithonlyymcode=preg_replace('/\{(c+)(0*)\}/i',$maskrefclient,$maskwithonlyymcode);
        $maskwithonlyymcode=preg_replace('/\{(t+)\}/i',$masktype_value,$maskwithonlyymcode);
        $maskwithnocode=$maskwithonlyymcode;
        $maskwithnocode=preg_replace('/\{yyyy\}/i','yyyy',$maskwithnocode);
        $maskwithnocode=preg_replace('/\{yy\}/i','yy',$maskwithnocode);
        $maskwithnocode=preg_replace('/\{y\}/i','y',$maskwithnocode);
        $maskwithnocode=preg_replace('/\{mm\}/i','mm',$maskwithnocode);
        print "maskwithonlyymcode=".$maskwithonlyymcode." maskwithnocode=".$maskwithnocode."\n<br>";

    }

    ?> 
```

但它不工作它正在打印

```
maskwithonlyymcode=C000000 maskwithnocode=C000000 
```

我想要的输出是`C000001`- `C000100`。

这段代码缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:34:26.300

我不太了解您的代码，因此无法修复它，但是：

```
<?

function process_mask($mask, $number, $date)
{
    while (preg_match("/\{(.+?)\}/", $mask, $match))
    {
        $outter_code = $match[0];
        $inner_code = $match[1];
        if (preg_match("/^(0+)(\+(\d+))?$/", $inner_code, $match2))
        {
            $number2 = $number;
            if (!empty($match2[3]))
            {
                $number2 += intval($match2[3]);
            }

            $replacement = str_pad($number2, strlen($match2[1]), "0", STR_PAD_LEFT);
        }
        else
        {
            switch ($inner_code)
            {
                case "dd":
                    $replacement = date("d", $date);
                    break;
                case "mm":
                    $replacement = date("m", $date);
                    break;
                case "y":
                    $replacement = substr(date("Y", $date), 3);
                    break;
                case "yy":
                    $replacement = date("y", $date);
                    break;
                case "yyyy":
                    $replacement = date("Y", $date);
                    break;
                default:
                    trigger_error("Unrecognised code $inner_code");
                    return NULL;
            }
        }

        $mask = str_replace($outter_code, $replacement, $mask);
    }

    return $mask;
}

function test_mask($mask)
{
    $date = mktime(0, 0, 0, 4, 19, 2013);
    echo str_pad($mask, 25)." => ".process_mask($mask, 100, $date)."\n";
}

test_mask("C{000}");
test_mask("C{000000}");
test_mask("C{000000+10}");
test_mask("ABC{yy}{mm}-{000000}");
test_mask("{0000+100}-ZZZ/{dd}/XXX");

?> 
```

输出：

```
C{000}                    => C100
C{000000}                 => C000100
C{000000+10}              => C000110
ABC{yy}{mm}-{000000}      => ABC1304-000100
{0000+100}-ZZZ/{dd}/XXX   => 0200-ZZZ/19/XXX 
```

我绝对不了解您有关重置计数器的规则。您想根据什么日期重置数字？当前日期？您是否为每个客户保留一些柜台（您还没有解释是什么`number`）？为什么要在某个月份重置它？间隔重置不是更有意义吗？就像每个月一样（在实现方面，每个月保持单独的计数器是有意义的，这样格式化逻辑与当前时间无关）。一些例子可能有助于理解这一点。

同样对于日期格式，我建议您坚持使用 PHP`date`格式，不要自己发明。

我建议你改用这样的模式（它实际上有点像.NET）：

```
{(#[+offset]|php-date-format-string)[:length]} 
```

所以（对于数字 = 999 和日期 = 2013-04-19）：

```
C{#:4}        => C0999
C{#+10:4}     => C1009
C{#:6}        => C000999
C{#:4}/{Y}    => C0999/2013
C{#:4}/{Y:4}  => C0999/2013
C{#:4}/{Y:2}  => C0999/13
C{#:4}/{Y:1}  => C0999/3
C{#:4}/{m}    => C0999/03
C{#:4}/{Y}{m} => C0999/201303
C{#:4}/{Ym}   => C0999/201303 
```

用于此的代码将更简单、更可扩展和更灵活。

# c# - 如何从 TFS 获取所有集合

> ID：16100991
> 
> 赞同：5
> 
> 时间：2013-04-19T09:03:25.927
> 
> 标签：c#, tfs, alm

如何使用 TFS API 从 TFS 获取集合

请参阅[此处](http://blog.johnsworkshop.net/)了解更多详情。这是关于 TFS 的最佳资源之一。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T09:03:25.927

```
private TfsConfigurationServer configurationServer;
configurationServer = TfsConfigurationServerFactory.GetConfigurationServer(uri);

public IList<KeyValuePair<Guid, String>> GetCollections()
{
    //ApplicationLogger.Log("Entered into GetCollections() : ");
    var collectionList = new List<KeyValuePair<Guid, String>>();
    try
    {
        configurationServer.Authenticate();

        ReadOnlyCollection<CatalogNode> collectionNodes = configurationServer.CatalogNode.QueryChildren(
            new[] { CatalogResourceTypes.ProjectCollection },
            false,
            CatalogQueryOptions.None);
        foreach (CatalogNode collectionNode in collectionNodes)
        {
            var collectionId = new Guid(collectionNode.Resource.Properties["InstanceId"]);
            TfsTeamProjectCollection teamProjectCollection =
                configurationServer.GetTeamProjectCollection(collectionId);

            if (teamProjectCollection == null)
                continue;

            collectionList.Add(new KeyValuePair<Guid, String>(collectionId, teamProjectCollection.Name));
        }
    }
    catch (Exception e)
    {
        ApplicationLogger.Log(e);
    }

    return collectionList;
} 
```

列表中每个返回的键值对都包含集合 guid 和集合名称