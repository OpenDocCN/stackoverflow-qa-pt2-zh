# StackOverflow 问答 15032000-15032999

# ios - UIButton 根据标题改变大小

> ID：15032000
> 
> 赞同：0
> 
> 时间：2013-02-22T19:42:25.933
> 
> 标签：ios

我正在使用带有自动布局的 iOS 6.0 和 xCode 4.5。我记得我曾经使用 [myButton sizeToFit] 根据其内容调整 UIButton 的大小。但现在它不起作用。UIButton 确实有宽度限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:59:22.287

解决方案是检查宽度约束，然后 make is >= somevalue 而不是 = somevalue

# vim - VIM NerdCommenter：如何在可视模式下切换评论？

> ID：15032001
> 
> 赞同：1
> 
> 时间：2013-02-22T19:42:26.460
> 
> 标签：vim, nerdcommenter

在可视模式下切换评论的命令是什么？该`cc`命令允许我在可视模式下进行评论。我找不到取消评论的命令。

```
[count]<leader>cc |NERDComComment| 
```

PS：我使用`c`命令在`normal`模式下切换评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:58:25.813

这个给你：

```
[count]<Leader>cu NERDComUncommentLine
Uncomments the selected line(s). 
```

# php - 在 php mysql 查询语法中使用 substr

> ID：15032008
> 
> 赞同：0
> 
> 时间：2013-02-22T19:43:00.283
> 
> 标签：php, mysql

我试图从列卧室svo 中获取第一个字符，并在 PHP 中的此查询中获得完全有用的“无效语法”。我试过用 ' 等切换' ，但仍然得到同样的东西......我做错了什么？

```
$query = @mysql_query("SELECT mlnum, , `.substr('bedroomssvo',0,1).`,totalfullbaths, arealiving FROM naples_Single_Family); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T19:44:11.327

请不要这样做（`@...`）。您正在抑制可能有效的错误。

您还需要停止使用`mysql_`函数。它们不再被维护[并被正式弃用](http://j.mp/XqV7Lp)。看到[**红框**](http://j.mp/Te9zIL)了吗？改为了解[*准备好的语句*](http://j.mp/T9hLWi)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://j.mp/QEx8IB)将帮助您决定使用哪个。

你想这样使用`SUBSTR`（位置 1 是`1`，不是`0`）：

```
SELECT mlnum, 
       Substr(bedroomssvo, 1, 1) AS bedroomssvo, 
       totalfullbaths, 
       arealiving 
FROM   naples_single_family 
```

[文档](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T19:47:21.667

所以，我在这里看到了几个问题：

```
SELECT mlnum, , `.substr('bedroomssvo',0,1).`,totalfullbaths, arealiving 
    FROM naples_Single_Family 
```

*   mlnum 后面多了一个逗号。
*   ``.substr('bedroomssvo',0,1).``意思是“列`.substr('bedroomssvo',0,1).`”，我不认为你想要那个。
*   `substr`并且`substring`在 SQL 中的第一个字符索引为 1（而在大多数语言中它是 0 索引）

所以问题是，您是要获取`'bedroomssvo'`（始终是`'b'`）的子字符串，还是要获取名为的列的子字符串`bedroomssvo`？我怀疑是后者。该查询将是：

```
SELECT mlnum, substr(bedroomssvo,1,1) as bedroomssvo_first_char,totalfullbaths, 
     arealiving FROM naples_Single_Family 
```

请注意我是如何去掉所有引号、刻度和`.`'s 的？那是因为您不需要转义任何内容，也不需要围绕列名进行任何有趣的业务。（除此之外：`as bedroomssvo_first_char`是可选的，但它使您的输出更容易理解）。

另一方面，如果你想获取你可以在 PHP 中访问的变量的子字符串，那么你可以这样做：

```
"SELECT mlnum, '{$yourString[0]}',totalfullbaths, arealiving 
    FROM naples_Single_Family" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T19:48:01.180

您使用的是反引号而不是引号，您不必转义 mysql 函数。这将起作用。

```
$query = mysql_query("SELECT mlnum, SUBSTR(bedroomssvo,1,1),totalfullbaths, arealiving FROM naples_Single_Family); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T19:44:13.027

试试这个

```
 SELECT mlnum , substr('bedroomssvo',0,1) ,totalfullbaths, arealiving FROM naples_Single_Family 
```

如果`bedroomssvo`是一列然后像这样使用它

```
SELECT mlnum , substr(bedroomssvo,1,1) ,totalfullbaths, arealiving FROM naples_Single_Family 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-22T19:48:58.943

采用

```
SUBSTR(column_name,1,x) 
```

在哪里：

1.  列名（字段名）
2.  1：起始索引：请不要在mysql中起始索引为1
3.  x = 整数（长度）

采用：

```
SUBSTR('text',1,x) 
```

对于文本

参考：[SUBSTR（）](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr)

# java - java.lang.IllegalArgumentException 在 Java 中使用 Jsoup 时

> ID：15032011
> 
> 赞同：1
> 
> 时间：2013-02-22T19:43:08.667
> 
> 标签：java, jsoup, web-crawler

我编写了代码来抓取网页并将图像保存在网页中。出于某种原因，我收到一个错误，我不确定如何修复。

我正在使用一种方法来确保我索引的每个图像都确实存在，所以我不确定为什么会发生这种情况。

这是我的代码：

```
import org.jsoup.Jsoup;
import org.jsoup.helper.Validate;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import java.net.*;
import java.awt.Image;
import java.awt.image.RenderedImage;
import java.io.*;

import java.io.IOException;

import javax.imageio.ImageIO;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;

public class jsoup {
    public static void main(String[] args) throws IOException {
    crawl("http://www.istockphoto.com/photo");
}

public static void crawl(String crawlurl) throws IOException{
    Document doc = Jsoup.connect(crawlurl).get();
    getImgFromLinks(doc);
}

public static void getImgFromLinks(Document doc) throws IOException{
    Elements links = doc.select("a[href]");
    //System.out.println(links);

    for(int i=0;i<links.size();i++){
        if(exists(links.get(i).attr("href"))){
            System.out.println("crawled: " + links.get(i).attr("href"));
            getImages(doc, links.get(i).attr("href"));
        }else{
            System.out.println("I couldnt crawl: " + links.get(i).attr("href"));
        }
    }
}

public static String smartUrl(String url, String src) {
    if(exists(src)){
        return(src);
    }else{
        return(url + src);
    }
}

public static void getImages(Document doc, String url) throws IOException{

      for(int i=0; i<doc.getElementsByTag("img").size();i++){
            Element image = doc.select("img").get(i);
            String imgsrc = image.attr("src");
            if(imgsrc.toLowerCase().contains("png") || imgsrc.toLowerCase().contains("jpg") || imgsrc.toLowerCase().contains("jpeg") || imgsrc.toLowerCase().contains("gif")){

            int slashIndex = smartUrl(url, imgsrc).lastIndexOf('/');
            String finalUrl = smartUrl(url, imgsrc).substring(slashIndex);

            URL imgurl = new URL(smartUrl(url, imgsrc));

            if(exists(imgurl.toString())){
            Image crawledimg = ImageIO.read(imgurl);

            ImageIO.write((RenderedImage) crawledimg, "gif",new File("/Users/Jonathan/Desktop/crawledimages" + finalUrl));

            System.out.println("I got an image from:" + url + " Image Name: " + finalUrl);
            }

        }
        }

}

public static boolean exists(String URLName) {
    try {
      HttpURLConnection.setFollowRedirects(false);

    //HttpURLConnection.setInstanceFollowRedirects(false);
      HttpURLConnection con =
         (HttpURLConnection) new URL(URLName).openConnection();
      con.setRequestMethod("HEAD");
      return (con.getResponseCode() == HttpURLConnection.HTTP_OK);
    }
    catch (Exception e) {
       return false;
    }
  }
} 
```

这是输出：

```
crawled: http://www.istockphoto.com/
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /facebook.png
I got an image from:http://www.istockphoto.com/ Image Name: /twitter.png
I got an image from:http://www.istockphoto.com/ Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/ Image Name: /cartWhite.png
I couldnt crawl: #
I couldnt crawl: http://www.istockphoto.com/sign-in/aHR0cCUzQSUyRiUyRnd3dy5pc3RvY2twaG90by5jb20lMkZwaG90bw==
I couldnt crawl: http://www.istockphoto.com/join/aHR0cCUzQSUyRiUyRnd3dy5pc3RvY2twaG90by5jb20lMkZwaG90bw==
crawled: http://www.istockphoto.com/photo
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
I got an image from:http://www.istockphoto.com/photo Image Name: /facebook.png
I got an image from:http://www.istockphoto.com/photo Image Name: /twitter.png
I got an image from:http://www.istockphoto.com/photo Image Name: /blank.gif
 Exception in thread "main" java.lang.IllegalArgumentException: im == null!
at javax.imageio.ImageIO.write(ImageIO.java:1457)
at javax.imageio.ImageIO.write(ImageIO.java:1527)
at jsoup.getImages(jsoup.java:68)
at jsoup.getImgFromLinks(jsoup.java:34)
at jsoup.crawl(jsoup.java:24)
at jsoup.main(jsoup.java:19) 
```

图像将被保存，直到发生错误。

有人知道如何解决这个问题吗？

此外，由于某种原因，页面上的相同图像会被多次保存。

感谢您的时间，

乔纳森·奥伦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:18:42.693

看起来像是`null`在里面通过`ImageIO.write()`

smartURL 函数有一个你需要解决的缺陷。它不是从网页获取的图像 URL 中创建预期的 URL。

例如： `/static/images/cartWhite.png`将由 smartURL 转换为`http://www.istockphoto.com/photo/static/images/cartWhite.png`不是图像但同时也不是错误页面。所以`crawledimg`指的是 null 导致`IllegalArgumentException`.

一个快速的解决方法是`URL`仅使用`http://www.istockphoto.com`inside创建`getImages()`。

图像将被保存多次，因为每个页面都有它们。您可以维护一个图像列表以避免这种情况发生。

我在您的代码中发现了另一个显示停止器，您将无法从您抓取的网页中检索任何其他图像。网站上的图片不以`*.jpg`or`*.png`等​​结尾。因此，您需要在开始之前研究网站上图片 URL 的模式。

# drupal - 以编程方式创建 Drupal 7 字段组

> ID：15032015
> 
> 赞同：2
> 
> 时间：2013-02-22T19:43:24.407
> 
> 标签：drupal, drupal-7, field

我正在尝试自动对由我的自定义模块创建的字段进行分组，但它不是很有效。我的期望是创建一个字段组并将现有字段分配给它。我正在使用 Field Groups 模块，因为它看起来很标准。

根据[http://drupal.org/node/1606758](http://drupal.org/node/1606758)的建议，我使用 ctools 批量导出来生成代码。我已将以下代码移动到我的模块中。不知道为什么这不起作用：

*   我的`hook_field_group_info()`和`hook_ctools_plugin_api()`都被击中了；我添加的调试标志正在被记录。
*   指定的字段被正确命名并且确实存在于数据库中。

我可能做错了什么？

========== 来自 Ctools Bulk Exporter：===========

**把它放在 nmc_directory.info**

```
name = nmc_directory export module
description = Export objects from CTools
dependencies[] = field_group
package = Chaos tool suite
core = 7.x 
```

**把它放在 nmc_directory.module**

```
<?php

/**
 * Implements hook_ctools_plugin_api().
 */
function nmc_directory_ctools_plugin_api($module, $api) {
  if ($module == 'field_group' && $api == 'field_group') {
    return array('version' => 1);
  }
} 
```

**把它放在 nmc_directory.field_group.inc**

```
<?php

/**
 * Implements hook_field_group_info().
 */
function nmc_directory_field_group_info() {
  $field_groups = array();

  $field_group = new stdClass();
  $field_group->disabled = FALSE; /* Edit this to true to make a default field_group disabled initially */
  $field_group->api_version = 1;
  $field_group->identifier = 'group_dir_phys_consumer_info|node|dir_physicians|form';
  $field_group->group_name = 'group_dir_phys_consumer_info';
  $field_group->entity_type = 'node';
  $field_group->bundle = 'dir_physicians';
  $field_group->mode = 'form';
  $field_group->parent_name = '';
  $field_group->data = array(
    'label' => 'Online Medical Providers Directory: Website (Consumer Information)',
    'weight' => '0',
    'children' => array(
      0 => 'dir_phys_gender',
      1 => 'dir_phys_category',
      2 => 'dir_phys_title',
      3 => 'dir_phys_fname',
      4 => 'dir_phys_lname',
      5 => 'dir_phys_suffix',
      6 => 'dir_phys_medfield_1',
      7 => 'dir_phys_medfield_2',
      8 => 'dir_phys_phone_public',
    ),
    'format_type' => 'fieldset',
    'format_settings' => array(
      'label' => 'Online Medical Providers Directory: Website (Consumer Information)',
      'instance_settings' => array(
        'required_fields' => 1,
        'classes' => '',
        'description' => '',
      ),
      'formatter' => 'collapsed',
    ),
  );
  $field_groups['group_dir_phys_consumer_info|node|dir_physicians|form'] = $field_group;

  return $field_groups;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:45:49.053

供将来参考 - 此代码（和方法）完美运行。

我的问题是这个模块变得如此庞大（4 种内容类型、60 多个字段、6 个词汇表等），以至于它在我的本地主机上运行得非常缓慢。当我在登台服务器上运行它时，它运行得非常好。我提高了本地主机 php.ini 上的最大执行时间，现在它在本地也可以正常工作。

FWIW：我能够使用 /devel/reinstall（来自 Devel 模块）重新安装模块，比通过模块管理页面快一点。不知道为什么这也没有超时，但它没有。

**编辑：** 嗯..所以几天后，我不确定问题完全是由于php执行时间造成的。这发挥了作用（某些字段从未创建+加上其他问题），但现在卸载和重新安装我的模块会产生字段组的分散结果。

*   一些字段组根本没有出现（数据库中的 {field_group} 表中没有记录）
*   但是，批量导出器模块确实将我的组列为可导出
*   添加的字段组不一定将指定的权重应用于其子项
*   卸载我的模块时，字段组*似乎*已被删除（[遵循此方法](https://stackoverflow.com/questions/7826486/delete-field-group-programmatically)）

# c++ - 为什么while循环会跳过char？

> ID：15032017
> 
> 赞同：0
> 
> 时间：2013-02-22T19:43:26.780
> 
> 标签：c++

所以我试图设置一个while循环来继续询问（y / n），但是当我按'y'并输入它时为什么会跳过“char itemtitle”并直接进入“double itemprice”？我对c ++真的很陌生，请帮忙，我会很感激

```
#include <cstdlib>
#include <iostream>
#include <sstream>

using namespace std;

#define tax 9.99
#define shipping ("Free")

void printmessage ()
{
  cout << "*Thanks for your business! We'll ship out your item as soon as possible*\n"
              "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n";
}

int main(int argc, char** argv)
{

   cout << "Write an invoice program and print it to the console.\n";
   cout << "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n;

   cout << "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"
           "Welcome to my Pc Store.\n"
           "'Where Technology is served right'\n"
           "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"<< endl;

   char name [256];
   cout << "Enter your full name: ";
   cin.getline (name, 256);

   char organization [256];
   cout << "What's your organization?: ";
   cin.getline (organization, 256);

   char quit = 'y';    
   do {
        char itemtitle [256];
        cout << "Enter name of Laptop you'd like to order: ";
        cin.getline (itemtitle, 256);

        double itemprice;
        cout << "Enter price of item: $";
        cin >> itemprice; 

        int quantity;
        quantity = 1;
        cout << "How many items?: ";
        cin >> quantity;

        if (quantity == 1) {     
            cout << "1 item(s)\n";  
        } else  {
           cout << quantity << " item(s)\n";
        } 

        cout << "Tax: $" << tax;

        double subtotal;
        subtotal = quantity * itemprice + tax;
        cout << "\nSub Total: $" << subtotal;

        cout << "\n";       
        cout << "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n"
               "Validation:\n\n";

        cout << "Item(s):\t\t\t\t\t" << "Amount:\n";       
        cout << itemtitle << "\t\t\t\t\t$" << quantity * itemprice + tax; ;
        cout << "\n" << quantity << " * $" << itemprice << " + $" << tax;

        cout << "\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n";
        cout << "Payment (Credit/Debit only)!\n\n";

        double cardnum;
        cout << "Card Numbers: ";
        cin >> cardnum;

        int ssn;
        cout << "SSN: ";
        cin >> ssn;

        cout << "\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"
               "Invoice Details:\n\n";

        time_t rawtime;
        struct tm * timeinfo;
        time ( &rawtime );
        timeinfo = localtime ( &rawtime );
        cout << "Date&Time: " << ("Current local time and date: %s", asctime (timeinfo));

        cout << name;
        cout << "\n" << organization;
        cout << "\n" << "("<< quantity << ")" << " " << itemtitle;

        cout << "\n\t\t\t" << "Total: $" << quantity * itemprice;
        cout << "\n\t\t\t" << "Tax: $" << tax;
        cout << "\n\t\t\t" << "Shipping: " << shipping;
        cout << "\n\n\t\t\t" << "Balance Due: $" << quantity * itemprice + tax;

        cout << "\n\t\t\t" << "Payment: " << "Paid" ;

        cout << "\n\n\nDo you want to continue shopping? (y/n): ";
        cin >> quit ;

        cout << "\n\n";

    } while (quit != 'n');

    cout << "\n\n\n";
    printmessage ();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:51:05.290

`std::cin.operator>>()`将`'\n'`字符留在缓冲区中，使其几乎无法用于`getline`. 您必须选择其中一个，然后相应地更改代码。

例如，使用 only `getline`，然后解析里面的结果字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:05:59.063

当你同时使用“cin >>”和“cin.getline()”来读取用户输入时，你会遇到这个问题。似乎在使用“>>”运算符时，在读取输入后，输入流中留下了“\n”，这导致对“getline”的后续调用立即返回。

两种解决方案。

首先，添加“cin.ignore();” 在“cin.getline(itemtitle, 256);”之前。“cin.ignore()”从输入序列中提取字符并丢弃它们。它将清除输入流。

二、替换“cin.getline(itemtitle, 256);” 用“cin >> itemtitle;”。我建议在您的代码中使用“cin.getline”或“cin >>”，但不要同时使用。“cin >>”会更好。

此外，应将“#include < ctime >”放在代码的顶部。

# ios - 如何为 UIView 或包含的控制器的遮罩效果设置动画

> ID：15032020
> 
> 赞同：2
> 
> 时间：2013-02-22T19:43:35.290
> 
> 标签：ios, core-animation, uiviewanimation

我们有一个 iOS，我们目前正在制作动画以将包含视图上的 alpha 设置为 0。像这样：

```
[UIView animateWithDuration:1.0f animations:^{
 self.jtContained.view.alpha = 1.0f;
}]; 
```

self.jtContained 是一个包含的控制器，代表其容器控制器的下半部分；这将删除此包含的控制器中的所有触摸功能。我们认为在这个包含的控制器上本质上具有动画蒙版可能更直观。这是我们想要的快速 5 分钟的 photoshop（即不是将其动画化，而是屏蔽掉包含的控制器）：

![在此处输入图像描述](../Images/c3add86eacae71dae62a964f33cde35a.png)

是否有使用 UIView 动画或核心动画的预构建方式来执行此操作？我什至想只遍历视图并将像素设置为 0。对不起，如果这是一个幼稚的问题，但我发现一些核心动画文档势不可挡。

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T21:39:51.500

您要做的是创建一个 CAShapeLayer 并使其成为视图层的遮罩层。然后将 CGPath 添加到作为视图全尺寸的形状层。（您将创建一条路径，该路径从视图的一个角开始，并围绕这些角绕一圈移动，从而创建一条矩形路径。）

当您想掩盖您的视图时，您可以将路径替换为另一个面积为零的矩形路径。（第一条路径可能会从 top_left、top_right、bottom_right、bottom_left、close 绕过拐角。空路径会去 top_left、top_right、top_left、top_right、close。）

Core Animation 将对定义形状层的路径的更改进行动画处理，并且由于路径是视图层的蒙版，因此蒙版会进行动画处理，从而隐藏您的视图。

正确制作此动画的关键是起始路径和结束路径必须具有相同数量的点。这就是我描述创建一个 4 点路径和另一个 EMPTY 4 点路径的原因。当你这样做时，Core Animation 会为点的移动设置动画，你会得到你想要的效果。如果您的起点和终点路径具有不同数量的控制点，或者控制点的顺序不同，则“结果未定义”并且通常根本不是您想要的。

你要问的是一个显示动画，这与我上面描述的相反。

我在 github 上有一个名为[**iOS-CAAnimation-group-demo**](https://github.com/DuncanMC/iOS-CAAnimation-group-demo)的演示项目（链接），它展示了这个想法。查看“蒙版动画”按钮后面的代码。该代码创建了一个“时钟擦除”动画，这比您想要做的简单显示要复杂得多。

PS如果这篇文章对您有帮助，请记得将其标记为回答您的问题（并投票。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-29T20:45:36.027

要详细说明以前的答案，您可以通过为蒙版使用的 CALayer 框架设置动画来做到这一点。如果它只是一个矩形遮罩，则不需要 CGPath。我们可以重用我们要隐藏的视图的框架。例子：

```
// Get the frame of the view's layer we're going to mask
let frame = viewToHide.layer.frame

// Create a new layer for our mask
// Masks are based on the "alpha" of the layer so if there is no background
// the mask won't cover anything so need to make sure we set that.
let mask = CALayer()
mask.backgroundColor = UIColor.whiteColor().CGColor
mask.frame = CGRectMake(0.0, 0.0, frame.width, frame.height)

// Set our new layer as the mask of the view we want to hide.
self.viewToHide.layer.mask = mask

UIView.animateWithDuration(1.0, animations: {() -> Void in

    // We keep the width of the new frame the same so
    // it looks like it's "rolling" up. Then we change the
    // height to 0.0, effectively making the mask not cover anything
    mask.frame = CGRectMake(0.0, 0.0, frame.width, 0.0)
}) 
```

# sql - 在 SQL SERVER 中创建自定义配置函数

> ID：15032025
> 
> 赞同：0
> 
> 时间：2013-02-22T19:43:57.763
> 
> 标签：sql, tsql, function, configuration, sql-server-2008-r2

我想要`@@servername`创建一个类似的功能。所以，新的`@@mycustomname`将返回我设置的东西，然后我可以`@@mycustomname`在我部署的 T-SQL 脚本中使用。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:04:20.047

不，你不能。这些是保留关键字。

您希望在某种程度上等同于全局变量，不幸的是它不存在。

你能做的最好的就是声明一个函数。

# linux - 将 Drupal 根目录设置为 777

> ID：15032026
> 
> 赞同：0
> 
> 时间：2013-02-22T19:43:58.303
> 
> 标签：linux, drupal, drupal-6

与我合作的一家公司存在上传文件（通过 FTP）的权限问题。我们找到了将所有内容都放在 777 上的解决方法（不是我的首选，但这里的易用性胜过安全性）。

问题在于 Drupal 在将根目录设置为 777 时会中断。

为什么是这样？我该如何改变呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T17:03:17.390

通常你的文件目录应该是：

```
chmod -R 775 files 
```

但还要确保您的所有者和组是正确的。在这种情况下，所有者应该是您的 ftp 用户。你的组应该是 apache 用户。

```
chgrp -R apache_user files
chown -R ftp_user files 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:57:44.100

使用 ftp 或 drupal 上传文件时遇到问题？Drupal 需要在站点/默认/文件中写入权限来保存图像和 css 等。

也许它的主人也有问题？检查此页面：[http ://drupal.org/node/244924](http://drupal.org/node/244924)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T11:58:34.253

> 问题在于 Drupal 在将根目录设置为 777 时会中断。

实际上，您需要更改的不是 Drupal 目录的根目录，而是目录`sites/default/files`。

如果您想以**最简单的方式**执行此操作，请将此目录权限更改为 777：

```
cd <your Drupal root>/sites/default
chmod -R 777 files 
```

**安全**的方法是将您的 WWW 用户（例如`www-data`）设置为该目录的所有者：

```
cd <your Drupal root>/sites/default
chown -R www-data files
chmod -R 775 files 
```

您也可以添加您的组（例如`my_group`）：

```
chgrp -R my_group files 
```

# jquery - 如果没有 ID，如何使用 jQuery 更改网站图标？

> ID：15032029
> 
> 赞同：4
> 
> 时间：2013-02-22T19:44:05.203
> 
> 标签：jquery, html, css

如果没有 ID，如何使用 jQuery 更改网站图标？我试图添加一个 ID，但我似乎无法找到它。我一直试图在控制台中找到正确的路径，但没有成功。这是我尝试过的： jQuery(:contains("shortcut icon")).attr("id", "favicon")

我认为这些是步骤，但我无法通过第一个步骤：

1.  通过 jquery 访问 FAVICON 的位置：卡住。这是HTML：

    ```
    <link href='/favicon.png' rel='shortcut icon' /> 
    ```

2.  将 ID 添加到 FAVICON：

    ```
    $('element').attr('id', 'favicon'); 
    ```

3.  使用 ID，更改 FAVICON：

    ```
    $('#favicon').attr('href','https://aerohive.com/sites/all/themes/aerohivenetworks/favicon.ico'); 
    ```

这是页面：http: [//community.aerohive.com/aerohive](http://community.aerohive.com/aerohive)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T19:46:43.800

元素的类型`link`不是`element`。

不过，您可能有多个链接元素，因此您应该更具体并使用属性选择器（因为您的属性可能具有唯一值）。

```
jQuery('link[rel="shortcut icon"]') 
```

添加 ID，丢弃对元素的引用，然后使用 ID 获取对元素的新引用是没有意义的。只需跳过第 2 步。

```
jQuery('link[rel="shortcut icon"]').attr('href','https://aerohive.com/sites/all/themes/aerohivenetworks/favicon.ico'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-16T08:32:35.920

对我有用的答案在[这里](https://stackoverflow.com/questions/4875689/is-it-possible-change-favicon-on-site-when-users-change-themes)

```
$(window).load(function () {
    $('head').append('<link href="your_favicon_name.ico" rel="shortcut icon" type="image/x-icon" />');
  }); 
```

检查这个[帖子](https://stackoverflow.com/questions/4875689/is-it-possible-change-favicon-on-site-when-users-change-themes)

# java - 在 Java Web 项目的 WebContent 内运行时保存文件

> ID：15032030
> 
> 赞同：0
> 
> 时间：2013-02-22T19:44:05.860
> 
> 标签：java, eclipse, jsp, jfreechart

以下是详细场景：

我正在开发一个 Java Web 项目。由于某些操作在运行时使用生成图表，`jfreechart API`然后我可以在其他一些 JSP 页面上看到该图表。当我从 Eclipse IDE 内部运行应用程序时，图像会显示，但是当我使用任何 Web 浏览器尝试时，图像不会显示。
我认为这与路径有关。所以，我想知道是否有任何方法可以将动态生成的图像文件存储在`WebContent`文件夹中。
或者如果它是由于其他问题而发生的，请赐教。

谢谢。

# c# - Compact Framework 中的 HttpResponseMessage 内容属性

> ID：15032031
> 
> 赞同：1
> 
> 时间：2013-02-22T19:44:07.230
> 
> 标签：c#, asp.net-mvc, asp.net-web-api, compact-framework

我正在构建一个 .NET 4.5 MVC 4 Web API，它将公开公开我希望安全访问的控制器方法。我创建了一个动作过滤器属性来检查正确编码的 RSA 令牌，为简洁起见，如下所示：

```
 public class TokenValidationAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        try
        {
            //authorize user
        }
        catch (Exception)
        {                
            actionContext.Response = new HttpResponseMessage(HttpStatusCode.Forbidden)
            {
                Content = new StringContent("Unauthorized User")
            };                
        }
    }
} 
```

然后在我的 .NET 3.5 CF 应用程序中，我将执行以下操作：

```
public static List<string> GetAvailableProjectIds()
        {
        var idList = new List<string>();
        var url = "the url";
        var req = CreateRequest(url, true);

        try
        {
            using (var response = (HttpWebResponse)req.GetResponse())
            {
                //do something with the resonse
            }
        }
        catch (Exception ex)
        {

        }

        return idList;
    } 
```

捕获的异常是 WebException 并包含正确的 403 禁止状态代码。但没有什么比我能找到的更有帮助的了。

有没有办法获取 Content 属性，以便我可以向最终用户显示他们尝试使用“未经授权的用户”进行身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T13:38:11.140

我从来没有真正喜欢过这种行为，它在通信正常时使用异常。尝试添加此扩展方法：

```
private static HttpResponse GetAnyResponse(this HttpRequest req)
{
   HttpResponse retVal = null;

   try
   {
      retVal = (HttpWebResponse)req.GetResponse()
   }
   catch (WebException webEx)
   {
      retVal = webEx.Response;
   }
   catch (Exception ex)
   {
      // these are the "bad" exceptions, let them pass
      throw;
   }

   return webEx;   
} 
```

然后将您的代码更改为：

```
using (var response = (HttpWebResponse)req.GetAnyResponse())
{
    //do something with the resonse
} 
```

# javascript - 固定控制条

> ID：15032033
> 
> 赞同：2
> 
> 时间：2013-02-22T19:44:11.133
> 
> 标签：javascript, html, jwplayer

控制栏默认启用自动隐藏。我需要禁用它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:54:03.743

```
controlbar: {
  idlehide: false,
  position: 'bottom' // or whatever suits
} 
```

公平，这适用于 5.10

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:32:06.587

在 JW6 中只有控件，它将所有控件设置在显示区域上。该值可以是真或假。恐怕在此版本中无法始终显示它们。

# php - htaccess 重写规则在提交表单时导致错误

> ID：15032042
> 
> 赞同：4
> 
> 时间：2013-02-22T19:44:41.397
> 
> 标签：php, forms, apache, .htaccess, url-rewriting

我使用我的 htaccess 文件来配置我网站上 url 的布局。

目前的问题是我不能再发送任何表格了。

我有两个文件将包含相同的代码（复制和重命名）。如果我调用`page1.php`url 将显示为`page1.php`. 一切正常，而我将尝试登录或导致一些错误。现在，当我将调用`index.php`（具有相同的代码！） url 中的`htaccess`隐藏`index.php`时，它应该这样做！但是当我测试登录脚本时，发布表单时什么都不会发生。它只是刷新网站。所以我不知道为什么会这样？

这种行为肯定是由`htaccess`通过重写规则引起的。我删除`htaccess`并再次尝试。没有它它可以工作，但仍然有这个丑陋的网址。

好的，以显示以下内容`htaccess`：

```
RewriteEngine On

RewriteCond %{REQUEST_URI} ^(.*)\.html$
RewriteRule ^.*\.html$ %1.php [L]  

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/$ $1.php

AddType application/x-httpd-php .htm .html

RewriteCond %{REQUEST_FILENAME} !-d 
RewriteCond %{REQUEST_FILENAME}\.php -f 
RewriteRule ^(.*)$ $1.php

RewriteRule ^index\.(htm|html|php) http://www.domain.com/ [R=301,L]
## rewrite the index file in subdirectories
RewriteRule ^(.*)/index\.(htm|html|php) http://www.domain.com/$1/ [R=301,L] 
```

表格将与以下内容一起发送：

```
form action = "<?php echo $_SERVER['PHP_SELF']?>" method= "post"... 
```

因此，如果有人可以帮助我，我将不胜感激。

**更新：**

要提供更多信息，我想实现什么：

首先结构如下：由于不同的语言，根结构如下：

```
www.domain.com/languagefolder/... 
```

现在，当用户呼叫时，`www.domain.com`他将被重定向到`languagesubfolder`. 当被重定向到这个子文件夹的索引页面时，第一件事应该是`www.domain.com/languagesfolder/index.php`不可见的，所以它只是`www.domain.com/languagesfolder/`. 这将自动完成。没关系。但是在调用`www.domain.com/languagesfolder/index.php`它时应该重写，`www.domain.com/languagesfolder/`这样用户就看不到`.../index.php`. 这似乎更专业。

接下来的事情将是在更多页面上提供链接，以便用户只需要输入`.../page`而不是`.../page.php`不显示文件扩展名。最后但并非最不重要的最后一件事是，当用户试图找出它是什么类型的文件时，我想通过重写扩展名来防止 SQL 注入，以便用户可以键入`.../page.php`以及`.../page.html`or `.../page.htm`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T15:17:21.170

使用：

```
form action = "<?php echo $_SERVER['PHP_SELF']?>" method= "post"... 
```

发布您的表格可能会导致以下内容：

```
form action = "/index.php" method = "post"... 
```

在你的代码中。线路出现问题的原因：

```
RewriteRule ^index\.(htm|html|php) http://www.domain.com/ [R=301,L] 
```

是不是它正在捕获您发布到的 index.php，然后在*没有*您的发布数据的情况下将您重定向到[http://www.domain.com/ 。](http://www.domain.com/)

 *如果您使用 firefox 并安装了 firebug，您可以通过查看 net 面板并在提交表单之前单击 persist 来实时看到这种情况。您将看到 POST /index.php 的 301 重定向，然后是[http://www.domain.com/](http://www.domain.com/)的 GET 。

您可以通过替换以下行来解决此问题：

```
form action = "<?php echo $_SERVER['PHP_SELF']?>" method= "post"... 
```

和：

```
form action = "/" method= "post"... 
```

或者：

```
form action = "<?php echo rtrim($_SERVER['PHP_SELF'], 'index.php'); ?>" method= "post"... 
```

这与使用 str_replace 相同，但只会删除最右边的“index.php”。

HTH。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:04:30.707

从查看 .htaccess 并阅读您的描述来看，您想要做什么似乎有点不清楚。听起来您想要干净的 URL（即从不显示文件扩展名），但您却谈论发布到 index.php 等。如果你想使用干净的 URL，你需要在整个过程中使用干净的 URL（即 post to`/`和 not `/index.php`）。

您应该从 .htaccess 中删除`AddType`声明，因为您永远不应该请求具有 .htm 或 .html 扩展名的文件，因为所有请求都将通过干净的 URL。`*.index`除了作为遗留用例（用于指向您网站的外部链接）之外，您不需要根据请求执行任何重定向。

您应该能够将 .htaccess 简化为以下内容：

```
RewriteEngineOn
# redirect legacy index links. Do this first to clean up URL. No need to use full URL here unless directly to different domain
RewriteRule ^(.*)index\.(html|htm|php)$ /$1 [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*)$ /$1.php [L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T15:10:01.017

您的问题似乎不是来自您的`.htaccess`. 这是我尝试过的。

.ht 访问：

```
RewriteEngine On
RewriteBase /stackoverflow/15032042

RewriteCond %{REQUEST_URI} ^(.*)\.html$
RewriteRule ^.*\.html$ %1.php [L]  

# I don't understand this RewriteRule
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/$ $1.php

AddType application/x-httpd-php .htm .html

RewriteCond %{REQUEST_FILENAME} !-d 
RewriteCond %{REQUEST_FILENAME}\.php -f 
RewriteRule ^(.*)$ $1.php

RewriteRule ^index\.(htm|html|php)$ http://www.workspace.domain.tld/stackoverflow/15032042/ [R=301,L]
RewriteRule ^(.*)/index\.(htm|html|php) http://www.workspace.domain.tld/stackoverflow/15032042/$1/ [R=301,L] 
```

索引.php：

```
if(isset( $_POST))
    var_dump($_POST);
echo '<form action="" method="POST"><input type="hidden" name="test" value="1" /><input type="submit" /></form>'; 
```

然后当我点击`http://www.workspace.domain.tld/stackoverflow/15032042/`并提交表单时，`$_POST`正确显示。

或者也许你没有想到你的子文件夹`RewriteBase`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T00:21:50.600

要转发查询字符串，您需要将`QSA` [RewriteRule 标志](http://httpd.apache.org/docs/current/rewrite/flags.html)添加到规则中，否则查询字符串将被丢弃。在大多数情况下，使用该标志也是一种很好的做法，有助于保持理智，`L`一旦满足规则，该标志将阻止进一步处理规则。您真的不想同时处理多个规则，而是制定单独`301`的规则并在重定向返回时处理它们。

```
RewriteRule ^(.*)$ $1.php [L,QSA] 
```

这解决了你的问题吗？

开心！*

# html - 我怎样才能水平居中一个元素与兄弟姐妹，并保持流动？

> ID：15032045
> 
> 赞同：1
> 
> 时间：2013-02-22T19:44:58.527
> 
> 标签：html, css

当前渲染： http: [//i.imgur.com/UNPCOfc.png](http://i.imgur.com/UNPCOfc.png)
所需渲染：http: [//i.imgur.com/8t6c2XM.png](http://i.imgur.com/8t6c2XM.png)

你好，

在下面的示例中，我希望我的 logo 元素 (id="logo") 出现在我的第 3 和第 4 li 元素之间。也就是说，我想让它恰好出现在其父级的中心，但仍与其兄弟姐妹一起处于正常流程中。

**我不能简单地将 logo 元素放在正确的位置，因为 li 元素是自动生成的并且数量未知。**

如果可能，最好使用纯 CSS 解决方案。

谢谢！

```
<style type="text/css">
ul {
    width: 100%;
    display: table;
}

li {
    display: table-cell;
}

#logo {
    width: 100px;
    height: 100px;
    background-color: black;
}
</style>
<ul>
    <li>Nav 1</li>
    <li>Nav 2</li>
    <li>Nav 3</li>
    <li>Nav 4</li>
    <li>Nav 5</li>
    <li>Nav 6</li>
    <li id="logo"></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:10:09.590

作为 CSS 解决方案，您可以像以下代码一样执行此操作：

注意：您需要为每个 li 元素添加不同的 id 属性

```
<style type="text/css">
ul {
    display: block;
    width: 700px;
    overflow: hidden;
    zoom: 1;
}

li {
  width: 100px;
}

li#menu-item-80,
li#menu-item-81,
li#menu-item-82,
li#logo {
    float: left;
}

li#menu-item-83,
li#menu-item-84,
li#menu-item-85 {
    float: right;
}

#logo {
    width: 100px;
    height: 100px;
    background-color: black;
}
</style>
<ul>
    <li id="menu-item-80">Nav 1</li>
    <li id="menu-item-81">Nav 2</li>
    <li id="menu-item-82">Nav 3</li>
    <li id="menu-item-83">Nav 4</li>
    <li id="menu-item-84">Nav 5</li>
    <li id="menu-item-85">Nav 6</li>
    <li id="logo"></li>
</ul> 
```

作为 Javascript jQuery 解决方案，您可以通过将最后一项附加到第三项之后的最后一项来重新排序菜单项，如下 jQuery 代码

```
<script>
jQuery(document).ready(function ($) {
  $('ul li:eq(2)').after($('li#logo'));
});
</script> 
```

# search - 如何获取谷歌搜索词？

> ID：15032050
> 
> 赞同：0
> 
> 时间：2013-02-22T19:45:21.690
> 
> 标签：search

我的任务是找到一种方法来执行不同的操作，或者根据某人用来查找网站的搜索词显示不同的内容。我以前见过其他网站这样做（显示我的搜索词以尝试使页面看起来更相关），但我不知道这是如何完成的。

如何获取用于查找页面的搜索词？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T19:49:19.293

我相信这通常是通过检查 HTTP_REFERRER 的值来完成的。您没有提及您使用的是哪种语言，但您可以在 PHP 中使用`$_SERVER['HTTP_REFERRER']`

# java - Java Web Start - 忽略/更改 Jar href URL

> ID：15032052
> 
> 赞同：0
> 
> 时间：2013-02-22T19:45:24.763
> 
> 标签：java, apache, netbeans, jnlp, java-web-start

我有一个通过 PHP 脚本创建的 JNLP 文件。它输出类似于以下文件的内容：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<jnlp codebase="/" spec="1.0+">
    <information>
        <title>sometitle</title>
        <vendor>somevendor</vendor>
        <homepage href=""/>
        <description>somedesc</description>
        <description kind="short">someshort</description>
    </information>
    <update check="always"/>
    <security>
<all-permissions/>
</security>
    <resources>
        <j2se version="1.7+"/>
        <jar href="http://fproject.localhost/getjava/jar/e43e034c49c4a24f2711d385370faaf1ef92ca76" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/commons-codec-1.6.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/commons-logging-1.1.1.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/fluent-hc-4.2.3.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/httpclient-4.2.3.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/httpclient-cache-4.2.3.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/httpcore-4.2.2.jar" main="true"/>
        <jar href="http://fproject.localhost/getjava/libs/lib/httpmime-4.2.3.jar" main="true"/>
    </resources>
    <application-desc main-class="Windows8.Windows8GUI">

    </application-desc>
</jnlp> 
```

应用程序加载并最初打开正常，但是应用程序很慢且无响应，在查看我的 apache 访问日志后，似乎发生了一些奇怪的事情，首先，它成功加载了所有 jar：

```
127.0.0.1 - - [22/Feb/2013:19:39:56 +0000] "GET /getjava/libs/lib/fluent-hc-4.2.3.jar HTTP/1.1" 200 24509 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:56 +0000] "GET /getjava/libs/lib/commons-logging-1.1.1.jar HTTP/1.1" 200 65294 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:56 +0000] "GET /getjava/jar/ba1df5097852421a791d095271fd48df6c79804c HTTP/1.1" 200 14060 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:56 +0000] "GET /getjava/libs/lib/commons-codec-1.6.jar HTTP/1.1" 200 253503 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:57 +0000] "GET /getjava/libs/lib/httpclient-4.2.3.jar HTTP/1.1" 200 469073 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:57 +0000] "GET /getjava/libs/lib/httpclient-cache-4.2.3.jar HTTP/1.1" 200 124242 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:57 +0000] "GET /getjava/libs/lib/httpcore-4.2.2.jar HTTP/1.1" 200 245191 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:39:57 +0000] "GET /getjava/libs/lib/httpmime-4.2.3.jar HTTP/1.1" 200 29955 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13" 
```

然后有大量对相同文件的请求，但位置已更改：

```
127.0.0.1 - - [22/Feb/2013:19:40:02 +0000] "GET /getjava/jar/lib/fluent-hc-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:03 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:03 +0000] "GET /getjava/jar/lib/httpclient-cache-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:03 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:03 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:04 +0000] "GET /getjava/jar/lib/fluent-hc-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:04 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:05 +0000] "GET /getjava/jar/lib/httpclient-cache-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:05 +0000] "GET /getjava/jar/lib/httpcore-4.2.2.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:05 +0000] "GET /getjava/jar/lib/httpmime-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:06 +0000] "GET /getjava/libs/lib/httpclient-cache-4.2.3.jar HTTP/1.1" 200 124242 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:06 +0000] "GET /getjava/libs/lib/httpcore-4.2.2.jar HTTP/1.1" 200 245191 "-" "JNLP/1.7.0 javaws/10.13.2.20 (<internal>) Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:06 +0000] "GET /getjava/jar/lib/fluent-hc-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:06 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:07 +0000] "GET /getjava/jar/lib/httpclient-cache-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:07 +0000] "GET /getjava/jar/lib/httpcore-4.2.2.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:07 +0000] "GET /getjava/jar/lib/httpmime-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:08 +0000] "GET /getjava/jar/lib/fluent-hc-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13"
127.0.0.1 - - [22/Feb/2013:19:40:08 +0000] "GET /getjava/jar/lib/httpclient-4.2.3.jar HTTP/1.1" 404 2011 "-" "Java/1.7.0_13" 
```

请注意 /getjava/libs/lib 已更改为 /getjava/jar/lib

这是怎么回事？JVM 从哪里得到这个 URL？

更重要的是，为什么 JVM 一遍又一遍地请求同一个文件？

**编辑 - 更多信息**

我想我已经把问题缩小了一点。我很确定这与Netbeans有关。我正在使用版本 7.2.1。

似乎额外库请求的 URL 来自`META-INF/MANIFEST.MF`主应用程序 Jar 中的文件。在那里我可以看到以下内容：

```
Class-Path: lib/commons-codec-1.6.jar lib/commons-logging-1.1.1.jar li
 b/fluent-hc-4.2.3.jar lib/httpclient-4.2.3.jar lib/httpclient-cache-4
 .2.3.jar lib/httpcore-4.2.2.jar lib/httpmime-4.2.3.jar 
```

这将解释修改后的 URL 和随后的 404 响应，因为这些文件在该 URL 上不可用。

我不明白为什么 Netbeans 会创建这些文件路径。我的印象是 Java Webstart 使用 JNLP 文件下载其资源，并且在该`<resources>`节点中？

我怎样才能停止 netbeans 添加这个`Class-Path`属性，因为我相信这是我的问题的根源。

**进一步更新**

我通过破解文件找到了解决此问题的方法。如果我取出这条线：

```
<attribute name="Class-Path" value="${jar.classpath}"/> 
```

从这个文件：

```
nbproject\build-impl.xml 
```

然后 Netbeans 为 Webstart 应用程序正确编译 Jar。它不会在 Jar 内的文件中创建`Class-Path`属性。`META-INF/MANIFEST.MF`删除此应用程序后，该应用程序工作得非常好，没有挂起，也没有对不存在的文件的虚假请求。

现在我想问题是，Netbeans 为什么要这样做？是否有适当的解决方法，而不是我破解 XML 配置文件？请记住，我已经使用 Java 大约一周了。我真的对 ANT/Java 一无所知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:12:20.673

尝试这个：

*   用作元素`http://fproject.localhost/getjava`的代码库`jnlp`
*   在资源上使用相对路径（即`<jar href="libs/lib/commons-logging-1.1.1.jar"/>`）
*   不要`main="true"`到处放，只放包含主类的jar`Windows8.Windows8GUI`

# c++ - C++ 复制构造函数和 stl 映射

> ID：15032058
> 
> 赞同：2
> 
> 时间：2013-02-22T19:45:43.263
> 
> 标签：c++, stl, copy-constructor

我有一个具有 map _abilities 的 Actor 类

Actor 类有一个复制构造函数，在其中我想将此映射中的功能复制到新的 Actor 实例。能力也有一个复制构造函数。

所以我的计划是循环遍历我要复制的传入actor实例的能力映射并创建新能力。我这样做是因为每个能力实际上都会起作用并修改演员，所以当我复制演员时，我还需要所有能力的新实例。以下代码在尝试将传入的演员能力分配给迭代器时，在 for 循环中给了我一个错误：

```
error C2679: binary '=' : no operator found which takes a right-hand operand of type     'std::_Tree_const_iterator<_Mytree>' (or there is no acceptable conversion)
1>          with
1>          [
1>              _Mytree=std::_Tree_val<std::_Tmap_traits<std::string,Ability     *,std::less<std::string>,std::allocator<std::pair<const std::string,Ability *>>,false>>
1>          ]
1>          c:\program files\microsoft visual studio 10.0\vc\include\xtree(429): could be 'std::_Tree_iterator<_Mytree> &std::_Tree_iterator<_Mytree>::operator =(const std::_Tree_iterator<_Mytree> &)'
1>          with
1>          [
1>              _Mytree=std::_Tree_val<std::_Tmap_traits<std::string,Ability *,std::less<std::string>,std::allocator<std::pair<const std::string,Ability *>>,false>>
1>          ]
1>          while trying to match the argument list '(std::_Tree_iterator<_Mytree>, std::_Tree_const_iterator<_Mytree>)'
1>          with
1>          [
1>              _Mytree=std::_Tree_val<std::_Tmap_traits<std::string,Ability *,std::less<std::string>,std::allocator<std::pair<const std::string,Ability *>>,false>>
1>          ]

// _abilities define as
map<string, Ability*> _abilities;

Actor::Actor(const Actor& actor)
{
// make a copy of this actors model and stats
_model = CopyEntity(actor._model);
_stats = actor._stats;

// copy the abilities and assign this as the new actor
map<string, Ability*>::iterator iter;
for(iter = actor._abilities.begin(); iter != actor._abilities.end(); ++iter)
    _abilities[(*iter).first] = new Ability(*(*iter).second, this);
} 
```

我不明白为什么它不允许我这样做。类型匹配。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T19:49:48.107

`actor`是一个常量对象。所以`actor._abilities.begin()`会返回`const_iterator`，不会`iterator`。

试试这个：

```
map<string, Ability*>::const_iterator iter; 
```

而不是这个：

```
map<string, Ability*>::iterator iter; 
```

在 C++11 中，您还可以使用`auto`which 来处理 const 正确性：

```
for(auto iter = actor._abilities.begin(); /* same as before */)
      _abilities[iter->first] = new Ability(*(iter->second), this);
} 
```

希望有帮助。

# mysql - 预览 MySQL 连接的快速方法是什么？

> ID：15032061
> 
> 赞同：1
> 
> 时间：2013-02-22T19:46:02.727
> 
> 标签：mysql, sql, optimization, join

我正在从事一个涉及数据集之间连接的项目，我们需要允许预览任意数据集之间的任意连接。这很疯狂，但这就是为什么它很有趣。这是使用面，所以给定一个连接，我想快速显示约 10 行结果。

我一直在围绕不同的方法对不同的表进行子采样，以这样一种方式进行实验，即我至少可以获得一些结果行，但保持样本足够小，以便连接速度快，并且不会导致采样成本高昂。

以下是我发现通过气味测试的方法。我想知道一些关于他们的事情：

1.  这些会在哪些类型的连接或数据集上失败？
2.  我如何识别这些数据集？
3.  如果这两者在同一件事上都不好，那么它们如何改进？
4.  有没有我没有放在这里的更好的采样类型？

### 有限制的子选择。

对一个数据集进行随机抽样以减小整体大小。

```
SELECT col1, col2 FROM table1 JOIN
  (SELECT col1, col2 FROM table2 LIMIT #) AS sample2 
    on table1.col1 = sample2.col1
  LIMIT 10; 
```

我喜欢这个，因为它很容易，并且将来有可能聪明地从哪个表中取样。也可以选择 table1.col1 从不等于 sample2.col1 的部分，因此不返回任何结果。

### 找到 col1 的相等值并对它们进行采样

更复杂的多查询方法。在这里，我将对要加入的列进行不同的选择，比较结果以找到共同值，然后进行子选择，将结果限制为共同值。

```
SELECT DISTINCT col1 FROM table1;
SELECT DISTINCT col1 FROM table2;
commonVals = intersection of above results
SELECT col1, col2 FROM table1 JOIN 
  (SELECT col1, col2 FROM table2 WHERE col1 IN(commonVals) LIMIT #) as sample2
    on table1.col1 = sample2.col1 
  LIMIT 10; 
```

这为我们提供了一个很好的 table2 样本，但 select distinct 查询可能比连接更昂贵。如果您知道不同的 cal 需要多长时间，我相信可能有一种方法可以确定这种方法是否更快，但目前我们对数据集的了解不多。

### 在连接上打一个 LIMIT

这是最简单的，也是我倾向于的。

```
SELECT col1, col1 FROM table1 join table2 on table1.col1 = table2.col1 LIMIT # 
```

假设连接很好，这将始终返回数据，并且至少在大量情况下它会很快完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:16:44.530

第一种方法的问题是第一个表中的行可能在第二个表中没有匹配项。请记住，内连接不仅进行匹配，还进行过滤。

如果用于连接的所有列都有索引，则第二种方法可以工作。然后，您可以通过执行以下操作获取匹配 id 的列表：

```
where id in (select id from table1) and id in (select id from table2) . . . 
```

这摆脱了初始代码，应该很快。

第三种方法是最直接地使用数据库的能力。您将取决于 MySQL 根据结果集的大小进行优化的能力。这是它所做的事情，至少在理论上是这样。

我强烈推荐第三种方法与连接中使用的列上的索引结合使用。这需要对查询进行最少的更改（只需添加一个`limit`子句）。它允许数据库在适当的情况下进行额外的优化。它适用于更一般的查询集。

# java - Spring MVC：将请求属性绑定到控制器方法参数

> ID：15032063
> 
> 赞同：22
> 
> 时间：2013-02-22T19:46:05.063
> 
> 标签：java, spring, spring-mvc

在 Spring MVC 中，很容易将请求*参数*绑定到处理请求的方法参数。我只是用`@RequestParameter("name")`. 但是我可以对请求*属性*做同样的事情吗？目前，当我想访问请求*属性*时，我必须执行以下操作：

```
MyClass obj = (MyClass) request.getAttribute("attr_name"); 
```

但我真的很想改用这样的东西：

```
@RequestAttribute("attr_name") MyClass obj 
```

不幸的是，它不能以这种方式工作。我可以以某种方式扩展 Spring 功能并添加我自己的“绑定器”吗？

**编辑** *（我想要实现的目标）*：我将当前登录的用户存储在请求属性中。因此，每当我想访问当前登录的用户（几乎在每个方法中）时，我都必须编写这个额外的行`user = (User) request.getAttribute("user");`。我想让它尽可能短，最好将它作为方法参数注入。或者，如果您知道如何通过拦截器和控制器传递某些东西的另一种方式，我会很高兴听到它。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-23T00:48:54.970

好吧，我终于明白了一点模型的工作原理和`@ModelAttribute`用途。这是我的解决方案。

```
@Controller 
class MyController
{
    @ModelAttribute("user")
    public User getUser(HttpServletRequest request) 
    {
        return (User) request.getAttribute("user");
    }

    @RequestMapping(value = "someurl", method = RequestMethod.GET)
    public String HandleSomeUrl(@ModelAttribute("user") User user)  
    {
        // ... do some stuff
    }
} 
```

`getUser()`标有注解的方法`@ModelAttribute`将自动填充所有`User user`标有 的参数`@ModelAttribute`。因此，当调用 HandleSomeUrl 方法时，调用看起来像`MyController.HandleSomeUrl(MyController.getUser(request))`. 至少我是这样想象的。很酷的是，用户也可以从 JSP 视图中访问，而无需任何进一步的努力。

这完全解决了我的问题，但是我还有其他问题。是否有一个共同的地方可以放置这些`@ModelAttribute`方法，以便它们对我的所有控制器都是通用的？我可以以某种方式从`preHandle()`拦截器的方法内部添加模型属性吗？

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-10-07T15:45:16.733

使用（从 Spring 4.3 开始）[@RequestAttribute](http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/RequestAttribute.html)：

```
@RequestMapping(value = "someurl", method = RequestMethod.GET)
public String handleSomeUrl(@RequestAttribute User user) {
    // ... do some stuff
} 
```

或者如果请求属性名称与方法参数名称不匹配：

```
@RequestMapping(value = "someurl", method = RequestMethod.GET)
public String handleSomeUrl(@RequestAttribute(name="userAttributeName") User user) {
    // ... do some stuff
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T20:02:57.803

我认为您正在寻找的是：

```
@ModelAttribute("attr_name") MyClass obj 
```

您可以在控制器中的方法的参数中使用它。

这是一个问题的链接，其中包含有关它的详细信息[什么是 Spring MVC 中的@ModelAttribute？](https://stackoverflow.com/questions/3423262/what-is-modelattribute-in-spring-mvc)

该问题链接到 Spring 文档以及一些使用它的示例。[你可以在这里](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-method-args)看到

**更新**

我不确定您是如何设置页面的，但是您可以通过几种不同的方式将用户添加为模型属性。我在下面设置了一个简单的例子。

```
@RequestMapping(value = "/account", method = RequestMethod.GET)
public ModelAndView displayAccountPage() {
    User user = new User(); //most likely you've done some kind of login step this is just for simplicity
    return new ModelAndView("account", "user", user); //return view, model attribute name, model attribute
} 
```

那么当用户提交请求时，Spring会将用户属性绑定到方法参数中的User对象上。

```
@RequestMapping(value = "/account/delivery", method = RequestMethod.POST)
public ModelAndView updateDeliverySchedule(@ModelAttribute("user") User user) {

    user = accountService.updateDeliverySchedule(user); //do something with the user

    return new ModelAndView("account", "user", user);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-04T15:14:39.683

不是最优雅的，但至少可以工作......

```
@Controller
public class YourController {

    @RequestMapping("/xyz")
    public ModelAndView handle(
        @Value("#{request.getAttribute('key')}") SomeClass obj) {

        ...
        return new ModelAndView(...);
    }

} 
```

来源： http: [//blog.crisp.se/tag/requestattribute](http://blog.crisp.se/tag/requestattribute)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-08T21:52:59.127

[从 spring 3.2 开始，使用 Springs ControllerAdvice](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/bind/annotation/ControllerAdvice.html)注释可以做得更好。然后，这将允许您获得一个建议，将 @ModelAttributes 添加到一个单独的类中，然后将其应用于您的所有控制器。

为了完整起见，也可以按原样实际制作 @RequestAttribute("attr-name") 。（以下根据[本文](https://sergialmar.wordpress.com/2011/03/29/extending-handler-method-argument-resolution-in-spring-mvc/ "自定义方法参数解析")修改以适应我们的需求）

首先，我们必须定义注解：

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.PARAMETER)
public @interface RequestAttribute {
    String value();
} 
```

然后我们需要一个 [WebArgumentResolver] 来处理绑定属性时需要做的事情

```
public class RequestAttributeWebArgumentResolver implements WebArgumentResolver {

    public Object resolveArgument(MethodParameter methodParameter, NativeWebRequest nativeWebRequest) throws Exception {
        // Get the annotation       
        RequestAttribute requestAttributeAnnotation = methodParameter.getParameterAnnotation(RequestAttribute.class);

        if(requestAttributeAnnotation != null) {
            HttpServletRequest request = (HttpServletRequest) nativeWebRequest.getNativeRequest();

            return request.getAttribute(requestAttributeAnnotation.value);
        }

        return UNRESOLVED;
    }
} 
```

现在我们只需要将此 customresolver 添加到配置中即可解决它：

```
<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="customArgumentResolver">
        <bean class="com.sergialmar.customresolver.web.support.CustomWebArgumentResolver"/>
    </property>
</bean> 
```

我们完成了！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-07T12:55:01.053

是的，您可以将自己的“绑定器”添加到请求属性 - 请参阅[spring-mvc-3-showcase](http://spring.io/blog/2010/07/22/spring-mvc-3-showcase/)，或使用@Peter Szanto 的解决方案。

或者，按照其他答案中的建议，将其绑定为 ModelAttribute。

由于它是您要传递到控制器的登录用户，因此您可能需要考虑[Spring Security](http://projects.spring.io/spring-security/)。然后您可以将[Principle](https://docs.oracle.com/javase/8/docs/api/java/security/Principal.html)注入您的方法中：

```
@RequestMapping("/xyz")
public String index(Principal principle) {
    return "Hello, " + principle.getName() + "!";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-19T03:51:27.997

在 Spring WebMVC 4.x 中，它更喜欢实现 HandlerMethodArgumentResolver

```
@Override
public boolean supportsParameter(MethodParameter parameter) {
    return parameter.getParameterAnnotation(RequestAttribute.class) != null;
}

@Override
public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mavContainer,
        NativeWebRequest webRequest, WebDataBinderFactory binderFactory) throws Exception {
    return webRequest.getAttribute(parameter.getParameterAnnotation(RequestAttribute.class).value(), NativeWebRequest.SCOPE_REQUEST);
} 
```

}

然后在 RequestMappingHandlerAdapter 中注册

# c# - 如何防止将长字符串写入 resx 文件

> ID：15032064
> 
> 赞同：1
> 
> 时间：2013-02-22T19:46:05.077
> 
> 标签：c#, visual-studio, designer, resx

即使我的表单未设置为本地化，如果我有一个文本长度超过 200 个字符的标签，Visual Designer 会将文本放入 .resx 而不是直接放入代码中。

这是问题，因为我使用了一种自定义本地化方法，该方法从代码中提取可本地化的字符串，但它不搜索 resx 文件。

有没有办法防止这种行为？我可以在我的代码中对字符串进行硬编码，以便提取器可以获取它，但这很烦人，因为文本在 Designer 中看起来是错误的。或者，我可以使用多个标签，但这感觉不对。

我在其他论坛看到其他人问过类似的问题，但没有答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-16T17:00:31.957

我没有完整的解决方案，但可以扫描与类型关联的资源并找到设计者决定这样做的字符串。

```
 var resources = new ResourceManager(type);
            using (var set = resources.GetResourceSet(CultureInfo.InvariantCulture, true, false))
            {
                if (set != null)
                {
                    foreach (DictionaryEntry res in set)
                    {
                        var key = res.Key as string;
                        var val = res.Value as string;
                        if (key == null || val == null)
                            continue;
                        if (!key.EndsWith(".Text"))
                            continue;
                        key = key.Substring(0, key.Length - ".Text".Length);
                        // key is now the name of your control
                        // val is the string the designer stored as its Text in the default resource
                    }
                }
            } 
```

# c++ - 无法在 make 文件中包含库

> ID：15032068
> 
> 赞同：0
> 
> 时间：2013-02-22T19:46:12.400
> 
> 标签：c++, c, linux, makefile

我有以下 3 个由其他程序员生成的 makefile。我已经包含了我的代码，在它们之间我用开始和结束进行了标记。该代码打算包含 libspatial 索引库。其他程序员有层次根目录---->tools--->r

MakeFile1 对应 r，MakeFile2 对应工具，MakeFile3 对应 root

现在，当我包含库时，我得到了错误

```
make all 
make: *** No rule to make target `bin//home/NP/rtree/spatialindex-src-1.8.0/src/storagemanager/DiskStorageManager.cc', needed by `bin/rdf3xload'.  Stop. 
```

我无法理解我犯了什么错误。有人可以帮助我吗？

**生成文件 1**

```
src_tools_r:=               \
    tools/r/r.cpp       \
    tools/r/Sorter.cpp      \
    tools/r/StringLookup.cpp    \
    tools/r/TempFile.cpp      \
    /home/NP/rtree/spatialindex-src-1.8.0/src/storagemanager/DiskStorageManager.cc

#Code which I wrote in order to include my library --begin
# for CS machines
COURSE_DIR = /home/NP/rtree/spatialindex-src-1.8.0/.libs
LIB_DIR     = /usr/local/lib

CPPFLAGS        = -I. \
                  -I$(COURSE_DIR)

LDFLAGS         = -L. \
                  -L$(COURSE_DIR) \
                  -R $(LIB_DIR):$(COURSE_DIR)

LDLIBS          = -lspatialindex
#Code which I wrote in order to include my library --end    

$(PREFIX)r$(EXEEXT): $(addprefix $(PREFIX),$(src_tools_r:.cpp=$(OBJEXT)) $(src_infra:.cpp=$(OBJEXT)) $(src_rts:.cpp=$(OBJEXT)) $(src_cts:.cpp=$(OBJEXT)))
    $(buildexe) 
```

**生成文件2**

```
include tools/r/MakeFile1

src_tools:=             \
    $(src_tools_r)      \

#Code which I wrote in order to include my library --begin
# for CS machines
COURSE_DIR = /home/NP/rtree/spatialindex-src-1.8.0/.libs
LIB_DIR     = /usr/local/lib

CPPFLAGS        = -I. \
                  -I$(COURSE_DIR)

LDFLAGS         = -L. \
                  -L$(COURSE_DIR) \
                  -R $(LIB_DIR):$(COURSE_DIR)

LDLIBS          = -lspatialindex
#Code which I wrote in order to include my library --end 
```

**制作文件3

```
# Include platform dependent makefiles
ifeq ($(OS),Windows_NT)
include Makefile.nt
else
include Makefile.unix
endif

PREFIX:=bin/

#############################################################################
# Default target
all: $(PREFIX)rd$(EXEEXT) $(PREFIX)r$(EXEEXT) $(PREFIX)rq$(EXEEXT) $(PREFIX)ru$(EXEEXT) $(PREFIX)re$(EXEEXT) $(PREFIX)ro$(EXEEXT)

#############################################################################
# Collect all sources

ifeq ($(LINEEDITOR),1)
src_lineeditor:=lineeditor/LineInput.cpp lineeditor/LineEditor.cpp lineeditor/Terminal.cpp lineeditor/Display.cpp lineeditor/Buffer.cpp
endif

include tools/Make2

source:=$(src_cts) $(src_infra) $(src_rts) $(src_tools) $(src_lineeditor)

#############################################################################
# Dependencies

generatedependencies=$(call nativefile,$(PREFIX)makeutil/getdep) -o$(basename $@).d $(IFLAGS) $< $(basename $@)$(OBJEXT) $(genheaders) $(GENERATED-$<)

ifneq ($(IGNORE_DEPENDENCIES),1)
-include $(addprefix $(PREFIX),$(source:.cpp=.d)) $(addsuffix .d,$(basename $(wildcard $(generatedsource))))
endif

#############################################################################
# Compiling

#Code which I wrote in order to include my library --begin
# for CS machines
COURSE_DIR = /home/NP/rtree/spatialindex-src-1.8.0/.libs
LIB_DIR     = /usr/local/lib

CPPFLAGS        = -I. \
                  -I$(COURSE_DIR)

LDFLAGS         = -L. \
                  -L$(COURSE_DIR) \
                  -R $(LIB_DIR):$(COURSE_DIR)

LDLIBS          = -lspatialindex

compile=$(CXX) -c $(TARGET)$(call nativefile,$@) $(CXXFLAGS) $(CXXFLAGS-$(firstword $(subst /, ,$<))) $(IFLAGS) $(IFLAGS-$(firstword $(subst /, ,$<))) $(call nativefile,$<)

$(PREFIX)%$(OBJEXT): %.cpp $(PREFIX)makeutil/getdep$(EXEEXT)
    $(checkdir)
    $(generatedependencies)
    $(compile)

#############################################################################
# Cleanup

clean:
    find bin -name '*.d' -delete -o -name '*.o' -delete -o '(' -perm -u=x '!' -type d ')' -delete

#############################################################################
# Executable

$(PREFIX)query: $(addprefix $(PREFIX),$(source:.cpp=$(OBJEXT)))

#Code which I wrote in order to include my library --end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:35:37.287

如果这是一个独立的库，它应该有自己的 Makefile，也应该单独构建。

如果要将源代码集成到主构建过程中，则必须符合它们的结构。

你有

*   不同的 c++ 源后缀`.cc`vs`.cpp`
    这很容易通过将源文件重命名为`.cpp`.
*   绝对路径`/home/NP/rtree/...`vs 相对路径`tools/r/...`
    这将涉及将整个树移动到主构建树中，因为规则期望目录可以从那里访问。

但我认为最好的方法是拥有一个库 Makefile 并将其集成到主构建中。

不幸的是，没有像更改变量 X 和移动 Y 行这样的简单答案。我建议，与您的同事坐下来一起解决这个 Makefile 问题。

# c# - 这个登录 c# 代码有什么问题

> ID：15032069
> 
> 赞同：-5
> 
> 时间：2013-02-22T19:46:15.087
> 
> 标签：c#, sql, login, ado.net

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Data;
using System.Data.SqlClient;

namespace aukcijska_p
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }
        private void button1_Click(object sender, RoutedEventArgs e)
        {
            string username = textBox1.Text;
            string password = textBox2.Text;

            if (string.IsNullOrEmpty(username) || string.IsNullOrEmpty(password))
                MessageBox.Show("Please insert correct values.", "Incorrect Username or password.");
            else
            {
                SqlConnection con = new SqlConnection(@"data source=(local);database=aukcija;integrated security=true;");
                con.Open();

                SqlCommand cmd = new SqlCommand("Select count(*) from users where name='" + username + "' and password='" + password + "'", con);

                Int32 returnedCount = (Int32)cmd.ExecuteScalar();

                if (returnedCount > 0)
                    new Window();
                else
                    MessageBox.Show("Wrong username or password");
            }

        }
        private void textBox1_TextChanged(object sender, System.Windows.Controls.TextChangedEventArgs e)
        {

        }

        private void textBox2_TextChanged(object sender, System.Windows.Controls.TextChangedEventArgs e)
        {

        }
    } 
```

和这个：

```
<Window x:Class="aukcijska_p.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="227" Width="292">
    <Grid Height="196" Width="281">
        <Label Content="Username:" Height="28" HorizontalAlignment="Left" Margin="37,63,0,0" Name="label1" VerticalAlignment="Top" Width="75" />
        <Label Content="Password:" Height="28" HorizontalAlignment="Left" Margin="37,99,0,0" Name="label2" VerticalAlignment="Top" Width="75" />
        <Button Content="Confirm" Height="23" HorizontalAlignment="Left" Margin="157,133,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="112,68,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" TextChanged="textBox1_TextChanged" />
        <TextBox Height="23" HorizontalAlignment="Left" Margin="112,101,0,0" Name="textBox2" VerticalAlignment="Top" Width="120" TextChanged="textBox2_TextChanged" Visibility="Visible" />
    </Grid>
</Window> 
```

它调试正常，但是当我按下确认时，我收到消息：程序停止工作..我在哪里犯了错误？任何人都可以帮助我吗？我用这张表制作了sql数据库：用户：user_ID，username，userpassword，user_level

继承人的形象： [http ://www39.zippyshare.com/v/97161315/file.html](http://www39.zippyshare.com/v/97161315/file.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:06:05.427

```
Select count(*) from users where name= 
```

应该：

```
Select count(*) from users where username= 
```

它在错误消息中这么说。“列名无效”。Cmon 人，你需要更加努力！不要放弃！

但正如其他人所说，代码还有许多其他问题。我建议阅读一般的数据库访问或学习绕过很多这些问题的实体框架之类的东西。

# sandbox - GameCenter 不使用沙盒模式

> ID：15032073
> 
> 赞同：0
> 
> 时间：2013-02-22T19:46:35.357
> 
> 标签：sandbox, game-center

我的应用在 iPhone 上的沙盒模式下不使用 GameCenter。通常（在我的旧 iPad 和新 iPad 上）沙盒模式是在我开始通过带有 dev-profiles 的 Xcode 安装的开发之后启用的。当您启动通过 GameCenter 安装的应用程序时，它会禁用 GC。我已经尝试了几件事：注销并在 GC 应用程序中登录并进入设置应用程序，恢复 iPhone，删除应用程序。我不知道下一步该怎么做，需要一些帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T00:16:15.303

您需要在 GC 应用程序中注销。确保您的应用已在 itunesconnect.apple.com 中注册，即使您尚未准备好提交它。然后确保在itunesconnect中为它启用了游戏中心。然后启动应用程序并从应用程序内登录 GC。然后您应该处于沙盒模式。

# jquery - jQuery 根据所选国家/地区更改手机的输入掩码

> ID：15032074
> 
> 赞同：3
> 
> 时间：2013-02-22T19:46:38.737
> 
> 标签：jquery, html

我想根据用户选择的国家/地区更改“电话”的输入掩码。我很确定我的问题在于没有 jQuery 代码以正确的语法更改元素 ID。

首先检查联系人是否已存档，如果找到则显示数据。当我找到具有国际电话号码的联系人时，该号码会根据需要显示。我们的大多数联系人来自美国，所以我选择该代码作为初始显示。当新联系人从美国以外的国家（或国际代码“1”）注册时，就会出现问题。然后掩蔽不会更改为 iphone。

```
 <html>
 <head>
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js">
 </script>
 <script src="jquery.js" type="text/javascript"></script>
 <script type="text/javascript" src= "../js/jquery.maskedinput.js"></script>
 <script>
 function show() 
 {
 var a = document.getElementById('country');
 var a = a.value.split(",")[1];
 document.getElementById("code").value= a+"+";
 if(a!=1)
jQuery(this).prev("phone").attr("id", "iphone");
 else
jQuery(this).prev("iphone").attr("id", "phone");    
 };
 </script>
 </head>
 <body>

 <p>Country:&nbsp;
<select id="country" name="country" onchange="show(this)">       
    <option value="United States,1" selected>United States</option><?php $code=1 ?>
    <option value="Sweden,37">Sweden</option>
 </p>

 <p>Phone:&nbsp;
 <?php echo '<input name="code"  id="code" size="1" type ="text" disabled="disabled" value="'.$code.'+"/>';
 if($code!=1)
 {
echo '<input name="phone"  id="iphone" type="text" value="'.$result1[phone].'"/>';
 }  
 else
 {
echo '<input name="phone" id="phone" type="text" value="'.$result1[phone].'"/>';
 }  
 ?>
 </p>
 <script>jQuery(function($)
 {
   $("#phone").mask("(999) 999-9999");
   $("#iphone").mask("99 99 99 99? 99");  
 }); 
 </script>

 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:44:00.617

我想你有一个我也遇到过的问题。结果，我开发了一个插件，它选择与输入的电话号码匹配的输入掩码。看看[演示](http://andr-04.github.com/inputmask-multi/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:55:14.757

我相信您可以在他们选择一个国家/地区时更改课程，然后使用新课程重新初始化您的面具：

```
<select id="country" name="country" onchange="show(this)">       
    <option value=".unitedStates" selected>United States</option><?php $code=1 ?>
    <option value=".sweden">Sweden</option>

<input type="text" id="phoneNumber" /> 
```

JS：

```
$('#country').change(function(){
  $("select option:selected").each(function () {
    var className = $(this).val();
    $('#phoneNumber').removeClass();
    $('#phoneNumber').addClass(className);
    initMasks();
  });
});

function initMasks(){
  $('.unitedStates').mask("(999) 999-9999");
  $('.sweden').mask("99 99 99 99? 99");  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:54:21.893

感谢 user1477388，我看到了我所做的不同。而不是试图改变元素的 id，我真的只是想改变面具。选择选项是从包含国家和代码（拨号代码）的 mySQL 数据表中填充的

```
 <select id="country" name="country" onchange="show(this)">
 <?php     
 $sql1="SELECT* FROM countries ORDER BY countryName";
 $query1= mysql_query ($sql1) or die("Couldn't execute check country query. ". mysql_error()); 
 while($row1=mysql_fetch_array($query1))
 {
  /* Option values are added by looping through the array */
 echo '<option value="'.$row1[countryName].','.$row1[code].'"\">'.$row1[countryName].'</option>';
 }
 echo "</select>";
 ?> 
```

然后在脚本中通过读取来确定拨号代码（$code） - [var a = a.value.split(",")[1]; ] If dialing code = 1 format #phone is (999) 999-9999 else format #phone is 99 99 99 99 99

```
 <script>
   function show() 
   {
    var a = document.getElementById('country');
    var a = a.value.split(",")[1];
   document.getElementById("code").value= a+"+";
   $code=a;
   if(a!=1)
   { 
   $("#phone").mask("99 99 99 99? 99");}
   else
   {$("#phone").mask("(999) 999-9999");
   }
   };
   </script> 
```

# ios - 如何将日期视为没有 DST 调整？

> ID：15032076
> 
> 赞同：0
> 
> 时间：2013-02-22T19:46:47.973
> 
> 标签：ios, timezone, dst

编辑：我的解决方案如下。

我有一种与日历相关的应用程序，用户可以在其中前后跳转特定整数天数。在午夜左右测试应用程序时，我意识到存在与 DST 相关的问题，我正在寻找最佳解决方案。

该应用程序并非真正基于 iOS 中的任何日历。但是，我显示公历日期和时间，以便用户参考熟悉的日期和时间。

其中一个内置的时间跳跃是 73 天，大约是 1/5 年。常用日期为 3 月春分 +/- 73 天的整数倍。例如，当从 3 月分点跳到 73 天前的某个日期时，问题就出现了，因为 3 月分点可能在 DST，而另一个则不是。这取决于系统上的时区设置。但是，该应用程序与时区无关，因此我宁愿显示时间，就好像没有 DST 这样的东西，但仍使用本地时区。我希望这是有道理的。

关于如何实现这一目标的任何建议？如果问题太模糊，也许我可以添加更多细节，但我不想通过添加太多来混淆事情。

编辑：我决定链接来自应用程序的示例屏幕打印以说明正在发生的事情。这张图片： http: [//victorspictures.com/trollart/h37a90c77#h56122c20](http://victorspictures.com/trollart/h37a90c77#h56122c20) 展示了今年春分的配置。标题说明了如何读取设备。按照图库中的下两张图片，了解如何使用该设备计算复活节日期。

无论如何，滑动手势允许用户移动 +/- 1 天或 +/- 73 天，这就是问题所在。我正在为日期显示添加时间，也许这就是我需要做的。

解决方案：Celeda 的建议

添加了这个方法：

```
- (NSDate *)setNoon: (NSDate *)date
{
   NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
   NSDateComponents *components = [calendar components:NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:date];
   [components setHour:12];
   NSDate *todayNoon = [calendar dateFromComponents:components];
   return todayNoon;
} 
```

然后，到处进行跳转，它被简单地封装在新方法中：

```
newDate = [self setNoon:[previousCode]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:17:30.457

根据您对 Hot Licks 的回答的评论，您似乎有一些数字`d`代表自 1975 年春分（UTC 时间为 1975 年 3 月 21 日 05:57:00）以来的天数，并且您想找出相应的日期公历。

我们可以使用`NSDate`、`NSCalendar`和`NSDateComponents`类来执行这个计算。为了避免 DST 的影响，我们需要将日历和格式化程序的时区设置为 UTC。

```
NSInteger d = 73 * 189; // days since the 1975 vernal equinox

NSTimeZone *utcTimeZone = [NSTimeZone timeZoneWithName:@"UTC"];

NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
calendar.timeZone = utcTimeZone;
NSDateFormatter *formatter = [[NSDateFormatter alloc] init]; 
formatter.dateFormat = @"yyyy-MM-dd";
formatter.timeZone = utcTimeZone;

NSDateComponents *epochComponents = [[NSDateComponents alloc] init];
epochComponents.year = 1975;
epochComponents.month = 3;
epochComponents.day = 21;
epochComponents.hour = 5;
epochComponents.minute = 57;
epochComponents.timeZone = utcTimeZone;
NSDate *epochDate = [calendar dateFromComponents:epochComponents];
NSLog(@"epochDate=%@", epochDate);
NSLog(@"epochDate from formatter=%@", [formatter stringFromDate:epochDate]);

NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];
offsetComponents.day = d;

NSDate *computedDate = [calendar dateByAddingComponents:offsetComponents toDate:epochDate options:0];
NSLog(@"computedDate=%@", computedDate);
NSLog(@"computedDate from formatter=%@", [formatter stringFromDate:computedDate]); 
```

尝试在日历和/或格式化程序上注释掉将时区设置为 UTC 的行，以查看 DST 如何更改结果。

如需更多信息，请阅读[*日期和时间编程指南*](http://developer.apple.com/library/ios/#Documentation/Cocoa/Conceptual/DatesAndTimes/DatesAndTimes.html#//apple_ref/doc/uid/10000039i)。

# css - 是否所有浏览器都需要至少一种样式信息才能开始渲染？

> ID：15032079
> 
> 赞同：0
> 
> 时间：2013-02-22T19:46:56.660
> 
> 标签：css

是否所有浏览器在至少`<style>`下载一个嵌入式标签或至少一个外部 CSS 文件后立即开始渲染，还是等到页面中链接的所有外部 CSS 文件都下载完毕？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:50:58.327

所有对外部脚本或样式表的显式引用都将阻止所有后续页面呈现，直到资源被下载并执行。

这篇文章“[浏览器的工作原理](http://taligarsiel.com/Projects/howbrowserswork1.htm#The_order_of_processing_scripts_and_style_sheets)”更详细，其中一个参考资料是官方的[CSS 2.1 处理模型](http://www.w3.org/TR/CSS21/intro.html#processing-model)。这由六个步骤组成，特别是

> 1.  ...
> 2.  ...
> 3.  检索与为目标媒体类型指定的文档关联的所有样式表。
> 4.  ...
> 5.  ...
> 6.  将格式化结构传输到目标介质

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:00:04.853

对于 html，渲染引擎会尽快在屏幕上显示内容。在开始构建和布局渲染树之前，它不会等到所有 HTML 都被解析。另一方面，样式表有不同的模型。从概念上看，由于样式表不会更改 DOM 树，因此没有理由等待它们并停止文档解析。但是，在文档解析阶段要求样式信息的脚本存在问题。如果样式还没有加载和解析，脚本会得到错误的答案，显然这会导致很多问题。这似乎是一个边缘情况，但很常见。

**[资源](http://taligarsiel.com/Projects/howbrowserswork1.htm#Render_tree_construction)**

浏览器同时运行多个线程来下载资源。样式表、html、脚本它们都在不同的线程中运行，对于 html，浏览器不会等待它开始创建的所有内容，`DOM tree`并且`render tree`只要样式数据可用，它们就会同时构建。**因此，简而言之，浏览器会在内存中为样式规则创建一个映射树，但除非下载了所有 CSS，否则它不会绘制它。**

您可能已经在 firebug 中看到所有 css 都是异步下载的，并且注意到 DOM 已经更改了很多次，这是因为脚本更改了 css 并且重新创建了渲染框架。

仅供参考：当样式表仍在加载和解析时，Firefox 会阻止所有脚本。Webkit 仅在脚本尝试访问可能受卸载样式表影响的某些样式属性时才阻止脚本。

# c++ - c++不能使用.h头文件的功能

> ID：15032083
> 
> 赞同：3
> 
> 时间：2013-02-22T19:47:10.153
> 
> 标签：c++

突然我不能使用我在.h头文件中写的新函数和我写的旧函数我可以使用它，我不敢相信：S

**标准数据文件**

```
#include "function.h" 
```

**钩子.h**

```
#include "stdafx.h"

    namespace DragoN_Hook
    {
            void EditOrginalCastleWar(int StartHour,int EndHour){

            unsigned char lol[4] = {0x83, 0x7A, 0x08,(unsigned char)StartHour};
            MemoryCopy((DWORD)0x00411A05,(DWORD)&lol,4);

    }
} 
```

**函数.h**

```
LPVOID MemoryCopy(DWORD destination, DWORD source, int length); 
```

**函数.cpp**

```
LPVOID MemoryCopy(DWORD destination, DWORD source, int length)
{
    DWORD oldSource      = 0;
    DWORD oldDestination = 0;

    VirtualProtect((LPVOID)source,length,PAGE_EXECUTE_READWRITE,&oldSource);
    VirtualProtect((LPVOID)destination,length,PAGE_EXECUTE_READWRITE,&oldDestination);

    memcpy((void*)destination,(void*)source,length);

    VirtualProtect((LPVOID)destination,length,oldDestination,&oldDestination);
    VirtualProtect((LPVOID)source,length,oldSource,&oldSource);

    return (LPVOID)destination;
}; 
```

**错误** **错误 C3861: 'MemoryCopy': 找不到标识符**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:51:08.567

这通常发生在您编译不会导致重新构建预编译头文件的单个文件时。如果您重建解决方案，它将重新创建标题。您还可以关闭预编译的标头，而不必处理它。

# php - 使用微时间存储投标

> ID：15032084
> 
> 赞同：-2
> 
> 时间：2013-02-22T19:47:19.100
> 
> 标签：php, codeigniter

尝试存储一个微时间，每次用户根据数据库中的当地时间 GMT 出价。在下面尝试此代码，但它只是在数据库中存储为 0000-00-00 00:00:00 。

函数创建（$user_bid）{

```
 $this->db->set('bid', $user_bid);

    $this->db->set('microtime',microtime(TRUE));

    $query= $this->db->insert('products');

    $this->load->view('bidding'); 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T19:50:20.713

使用 int 或 varchar 字段，而不是 mysql 表中的日期字段。

# mysql - 如何从两个表中删除？

> ID：15032093
> 
> 赞同：3
> 
> 时间：2013-02-22T19:47:46.417
> 
> 标签：mysql, sql

再会。

我有 2 个表 - test1 和 test2。

*结构表test1：*

![测试1](../Images/f696b6a9b27cff8fbc89b3d28742b95d.png)

*结构表test2：*

![测试2](../Images/88e43975c7d15cf2631cbe0439ec6ed2.png)

需要使用一个查询删除表*test1* where 中的行并删除表*test2* where 中`idn='22222'`的所有行。*`table2.subscription_id = table1.subscription_id`*

 **不使用while或forech，只有一个sql查询！*

*它们不是外键！*

是否可以？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T19:51:52.383

当然这是可能的。

查看[文档](http://dev.mysql.com/doc/refman/5.6/en/delete.html)（`DELETE`他们有一些仅用于多表删除的段落）。

句法：

```
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
tbl_name[.*] [, tbl_name[.*]] ...
FROM table_references
[WHERE where_condition] 
```

以您为例：

```
DELETE test1.*,  test2.*
FROM test1, test2
WHERE test1.subscription_id = test2.subscription_id
    AND test1.idn = '22222'; 
```

其他方式也是可能的。

如果您一直在使用外键，那会更简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T19:51:34.860

这不起作用：

```
DELETE Table1, Table2
FROM Table1
LEFT JOIN Table2
ON Table1.Id = Table2.Id
WHERE Table1.Id = 1; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/0902c/1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T19:54:48.463

试试这个

```
 DELETE
        test1, test2
   FROM
   test1  JOIN test2 
   WHERE
        test1.idn = 22222 AND
        test2.description_id = test1.description; 
```

[**演示 SQLFIDDLE**](http://sqlfiddle.com/#!2/b42a6/1)*

# c# - 以编程方式调用并呈现 power point 演示文稿

> ID：15032096
> 
> 赞同：2
> 
> 时间：2013-02-22T19:47:52.490
> 
> 标签：c#, asp.net, powerpoint

我有一个 ASP.NET C# Web 应用程序，用户可以在其中上传他们的 PowerPoint 演示文稿（ppt 文件）。我希望以编程方式（使用 C#）调用 power point 演示文稿并能够从网页上演示它。是否可以？我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T19:52:23.690

您可以使用[Interop](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.powerpoint.aspx)将上传的 Powerpoint 演示文稿保存为一系列图形（例如 PNG）。在 Powerpoint 中，这将是文件/另存为/*.png。您可以以编程方式完成相同的操作。从 ASP.Net 运行互操作代码不是一个好主意。您可以运行一个 Windows 服务来监视上传的 ppt 文件并将它们转换为相应的一系列图像。

这不会保留过渡和动画，但可以正常工作。

然后，您可以使用幻灯片库来显示各种图像（例如，使用 Flash 或 JavaScript……网络上有许多可用的解决方案）。

或者，如果您可以确保最终用户至少安装了免费的 Powerpoint 查看器，您可以将 ppt 文件返回给他们并设置[适当的 mime 类型](http://filext.com/faq/office_mime_types.php)，查看器将显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T22:01:34.193

正如 Eric 所说，使用互操作程序集将 Powerpoint 演示文稿更改为一系列图形要制作幻灯片库，您可以按照下面的链接进行操作，该链接很好地说明了编码。您必须使用 javascript 来完成它。

访问[http://www.c-sharpcorner.com/uploadfile/anjudidi/making-an-image-slideshow-in-Asp-Net/](http://www.c-sharpcorner.com/uploadfile/anjudidi/making-an-image-slideshow-in-Asp-Net/)

下面的链接还显示了如何创建幻灯片，但它是从数据库中获取图形。 [http://www.aspdotnet-suresh.com/2011/12/jquery-lightbox-image-slideshow-gallary.html](http://www.aspdotnet-suresh.com/2011/12/jquery-lightbox-image-slideshow-gallary.html)

# python - Python 的“open()”为“找不到文件”抛出不同的错误——如何处理这两个异常？

> ID：15032108
> 
> 赞同：49
> 
> 时间：2013-02-22T19:48:31.070
> 
> 标签：python, python-3.x, filenotfoundexception, ioerror

我有一个脚本，提示用户输入（要打开的文件的）文件名，如果当前目录中不存在该文件，则会再次提示用户。这是简短的版本：

```
file = input("Type filename: ")

...
try:
    fileContent = open(filename, "r")
    ...
except FileNotFoundError:
    ... 
```

当我在我的 MacOS X 上用 Python 3.3x 测试我的脚本时，当我故意输入错误的文件名时它工作得非常好（它在“预期”下执行套件）。

但是，当我想在 Windows 计算机上使用 Python 3.2x 运行我的代码时，我收到一条错误消息，指出未定义“FileNotFoundError”。因此，Windows 上的 Python 3.2 认为“FileNotFoundError”是一个变量，程序会因错误而退出。

我发现如果输入文件名无效，Windows 上的 Python 3.2 会抛出“IOError”。我在我的 Linux 机器上用 Python 2.7 对其进行了测试，它也是一个 IOError。

我现在的问题是，代码与

```
except "FileNotFoundError": 
```

不会在 Windows 的 Python 3.2 上运行，但如果我将其更改为

```
except "IOError": 
```

它不再适用于我的 Mac。

我怎么能解决它？我能想到的唯一方法是使用 `except`我通常不想要的 just 。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-02-22T20:11:48.523

在 3.3 中，[`IOError`成为 的别名`OSError`](http://docs.python.org/3.3/library/exceptions.html#IOError)，并且`FileNotFoundError`是 的子类`OSError`。所以你可以试试

```
except (OSError, IOError) as e:
   ... 
```

这将撒下一个非常广泛的网络，并且您不能在不检查的情况下假设异常是“找不到文件” `e.errno`，但它可能涵盖您的用例。

[PEP 3151](http://www.python.org/dev/peps/pep-3151/)详细讨论了更改的基本原理。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-22T20:13:54.907

这让我觉得比简单的要好`except:`，但我不确定它是否是最好的解决方案：

```
error_to_catch = getattr(__builtins__,'FileNotFoundError', IOError)

try:
    f = open('.....')
except error_to_catch:
    print('!') 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-09T14:39:11.867

因此，只有在找不到文件时才能准确捕获，我这样做：

```
import errno
try:
   open(filename, 'r')
except (OSError, IOError) as e: # FileNotFoundError does not exist on Python < 3.3
   if getattr(e, 'errno', 0) == errno.ENOENT:
      ... # file not found
   raise 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-22T19:49:24.753

您可以同时捕获 2 个错误

`except (FileNotFoundError, IOError):`

我没有意识到这是你问的。我希望有一个更有说服力的解决方案然后手动检查

```
try:
   error_to_catch = FileNotFoundError
except NameError:
   error_to_catch = IOError 
```

`except error_to_catch`

cwallenpoole 在他的回答中更有条件地做到了这一点 `(error_to_catch = getattr(__builtins__,'FileNotFoundError', IOError))`

# python - 如何获取网页上选定文本的 x,y 坐标？

> ID：15032110
> 
> 赞同：0
> 
> 时间：2013-02-22T19:48:38.770
> 
> 标签：python, find, return, coordinates, webpage

我有一个简单的查找功能，可以找到在网页上传递给它的内容。然后我需要返回找到的文本在该页面上所在位置的 x,y 坐标。

```
def find_text():
    win32api.keybd_event(win32con.VK_CONTROL, 0, 0, 0)
    win32api.keybd_event(ord('F'), 0, win32con.KEYEVENTF_EXTENDEDKEY | 0, 0)
    time.sleep(0.05)
    win32api.keybd_event(ord('F'), 0, win32con.KEYEVENTF_EXTENDEDKEY |        win32con.KEYEVENTF_KEYUP, 0)
    win32api.keybd_event(win32con.VK_CONTROL, 0, win32con.KEYEVENTF_KEYUP, 0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:06:55.167

看起来您正在尝试编写某种自动化...我认为您最好使用像[Telerik](http://www.telerik.com/automated-testing-tools/free-testing-framework.aspx)或[Selenium](http://docs.seleniumhq.org/)这样的网络自动化框架。如果您试图获取要单击的坐标，则不需要像这样的框架，您`click`通常只需要调用一个函数。

# encoding - AFNetworking 变音符号

> ID：15032116
> 
> 赞同：0
> 
> 时间：2013-02-22T19:49:06.233
> 
> 标签：encoding, afnetworking

我正在使用 AFNetworking 与我的 JSON API 进行通信。除了发送带有德语变音符号（即ä ö ü ß）的请求外，一切都很好。

我正在使用共享实例

```
+(LFMessaging*)shared
{
    static LFMessaging *sharedInstance = nil;
    static dispatch_once_t oncePredicate;
    dispatch_once(&oncePredicate, ^{
        sharedInstance = [[self alloc] init];
    });    
    return sharedInstance;
} 
```

要发送数据，我使用 AFHTTPClient 的子类和这种方法：

```
[parameters setValue:cmd forKey:@"cmd"];
NSMutableURLRequest *apiRequest =
[self multipartFormRequestWithMethod:@"POST"
                                path:[NSString stringWithFormat:@"http://%@%@", _domain, _target]
                          parameters:(NSDictionary*)parameters
           constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
               //TODO: attach file if needed
           }];

AFJSONRequestOperation* operation = [[AFJSONRequestOperation alloc] initWithRequest: apiRequest];
operation.JSONReadingOptions = NSJSONReadingMutableContainers;

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
... 
```

就在带有德语变音符号的参数通过 api 时似乎中断了。服务器没有收到正确的字符串。

如果服务器以 json 结果发送变音符号，一切都很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T12:39:50.097

```
self.stringEncoding = NSUTF8StringEncoding; 
```

解决了问题

# java - 输入文本字段不会在鼠标单击时移动光标？

> ID：15032123
> 
> 赞同：3
> 
> 时间：2013-02-22T19:49:30.683
> 
> 标签：java, javascript, events, gwt

我的所有`Input Text`领域都有问题，也许有人有一个想法：

我正在使用`GWT`，刚刚发现无法使用鼠标选择我的输入字段中的文本。在文本内部单击也不会移动光标。

但是使用光标给他们焦点是有效的。使用 CTRL+A 选择全部以及使用箭头键移动光标按预期工作。

我检查了`TextBox`具体的`onBrowserEvents()`方法，可以看到，点击事件得到了很好的接收。只是不知何故，他们不会修改浏览器中的文本输入控件。

我测试了不同的机器和不同的浏览器，它们的行为都是一样的。所以它一定是我的应用程序中的东西。

也许有人知道我做错了什么？我什至无法想象有什么东西会在我的*所有*输入字段上产生这种行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T11:32:31.260

原来是一个CSS问题：

我必须`-moz-user-select: -moz-none;`防止某些组件出现双击问题。我现在从其中排除了输入元素，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-19T14:40:36.507

我用它来解决选择文本并将光标移动到输入中的文本上的问题：

```
*, ::before, ::after
    -webkit-user-select: text 
```

# entity-framework - 在数据库/存储库中插入实体时应该断言/测试什么

> ID：15032125
> 
> 赞同：0
> 
> 时间：2013-02-22T19:49:35.840
> 
> 标签：entity-framework, integration-testing

这是我的集成测试代码：

```
// Arrange
var user = new User() { FirstName = "test", UserId = 4, LastName = "test", RegisteredAt = new DateTime(2013, 02, 02) };
var repository = new GenericRepository<User>(_context);

// Act
repository.Add(user);
_context.SaveChanges();

// Assert
Assert.IsNotNull(user.UserId); 
```

我见过有人用 UserId 进行 IsNotNull 测试，这是没有意义的，因为 UserId 不应该是可为空的整数。

您将测试什么以及如何测试以确保您创建并添加到数据库中的实体是相同的？

你会怎么做：

```
 var dbUser = _context.Users.First(u => u.FirstName == "test") 
```

接着

```
Assert.AreEqual(dbUser.FirstName,user.FirstName) 
```

这适用于您创建的所有属性？

**更新**

我用谷歌搜索了更多，人们真的在做不同的和奇怪的事情来测试一个实体是否被插入到数据库中：

```
Assert.That(1, Is.EqualTo(context.Roads.Count()));

Assert.assertNotNull(repo.findUserById(user.getId()));

ICustomer retainedCustomer = repository.
                    Customers.
                    Where(q => q.CustomerName == expectedCustomerName).
                    FirstOrDefault();
                Assert.IsNotNull(retainedCustomer); 
```

第一个甚至没有测试插入的名为 road 的实体，它正在检查道路表的计数......在我看来，第二个和第三个断言似乎是错误的，因为它们使用带有登录的存储库方法，这可能会在以后失败测试以获取插入的客户/用户。

你怎么看？

# javascript - 如何在列表中使用内联存储声明本地存储代理？

> ID：15032128
> 
> 赞同：0
> 
> 时间：2013-02-22T19:49:53.380
> 
> 标签：javascript, extjs, sencha-touch, sencha-touch-2

**背景**：我正在使用列表并存储列表配置。我每次都在进行 Ajax 调用并在列表中显示数据。现在，我想使用本地存储代理。

这是我的代码，

```
 xtype : 'list',
    id : 'namesList',
    store : {
    id : 'namesStore',
    autoLoad : true,
     fields : ['text', 'value'],
        proxy : {
            type:'ajax',
            url : 'dataFolder/namesList.json',
        reader : {
            type : 'json',
            rootProperty : 'record'
            }
            },
            },
        itemTpl :'<div class = mainContent>{text}</div>', 
```

我的问题是“如何在此配置中使用 localstorageProxy。当我直接添加

```
proxy : {
    type : 'localstorage',
    id: 'namesListLocalStorage',
    url : 'dataFolder/nameList.json',
    } 
```

它不显示任何记录。任何指针都会有很大帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T03:36:41.860

我使用了以下机制。

我已经声明了一个远程存储来从服务器获取日期，并声明一个本地存储来与远程存储同步并将数据存储到本地存储。

我的控制器总是检查本地存储中是否没有记录，然后只有远程存储会调用服务器并获取数据。

Once the sync of local store to remotestore is completed, I explictly store localstore as the store for the list using list.setStore method.

Thanks

# php - parse_str() 突然不工作

> ID：15032130
> 
> 赞同：0
> 
> 时间：2013-02-22T19:49:58.263
> 
> 标签：php, string, youtube

```
if($_POST['VIDEO']){
    $video = parse_url($_POST['VIDEO']);
    if($video['host'] == 'www.youtube.com' || $video['host'] == 'youtube.com'){
        $query = parse_str($video['query']);
        $v = $query['v'];
        if(!$v){
            //nothing found
        } else { 
            $videoOutput = 'yt:'.$v;
        }
    }
} 
```

所以我大约一个月前制作了这个脚本。直到昨晚都完美地工作。我不明白为什么。直到昨晚它都可以正常工作。它实际上会解析 url，并且主机是有效的。我到了`parse_str`，一切突然都不起作用了。我做到`print_r`了`$query`，它没有返回任何数据。如果我`echo`是变量，我会得到一个`1`. 这个文件还没有被动过，所以我不明白为什么它会突然坏掉。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T19:53:40.447

语法错误：parse_str 不返回任何内容。将 $string 解析成一个名为 $array 的数组：

```
parse_str($string, $array) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T19:53:16.453

如果您阅读 [parse_str()](http://php.net/manual/en/function.parse-str.php "parse_str()")的文档，您会发现如果您在没有第二个参数的情况下使用它，它不会返回任何内容（void）。

试试这个：

```
parse_str($video['query'], $query);

if (!$query['v']) {
  ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:16:24.683

根据 php.com 的文档和示例，您必须这样做：

```
$query = array(); 
parse_str($video['query'],$query); 
```

# ruby-on-rails - 设计：=> #

> ID：15032137
> 
> 赞同：0
> 
> 时间：2013-02-22T19:50:17.827
> 
> 标签：ruby-on-rails, devise

这可能是也可能不是设计错误，但我认为是。

在测试中，我尝试分配一个整数作为电子邮件地址。我从活动记录保存的“肠道”中收到此错误：

```
=> #<NoMethodError: undefined method `downcase!' for 1:Fixnum> 
```

尽管我的`User < ActiveRecord::Base`.

```
validates :email, format: { with: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i, message: "Invalid email"} 
```

我猜想以某种方式在电子邮件地址上调用了一些设计验证或其他钩子并炸毁了。接下来我可以尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T11:08:22.817

看看设计源代码：

该`authenticable`模块添加了`before_validation :downcase_keys`，它执行以下操作：

```
def downcase_keys
    self.class.case_insensitive_keys.each { |k| apply_to_attribute_or_variable(k, :downcase!) }
end 
```

（参见[lib/devise/models/authenticatable.rb](https://github.com/plataformatec/devise/blob/v2.2.3/lib/devise/models/authenticatable.rb#L163)以供参考）

它用于在对模型应用任何逻辑之前将所有不区分大小写的键小写。默认情况下，Devise 提供的配置`case_insensitive_keys`包含`email`您使用`Fixnum`.

```
# Keys that should be case-insensitive.
mattr_accessor :case_insensitive_keys
@@case_insensitive_keys = [ :email ] 
```

（参见[lib/devise.rb](https://github.com/plataformatec/devise/blob/v2.2.3/lib/devise.rb#L62)以供参考）

这样，验证甚至在您自己的验证被检查之前执行。也许可以将变量类型的附加验证添加到设计中，但默认情况下，您只会将`String`登录 / 等表单提供的分配给该字段。

我希望我能澄清一下。

# android - 对齐视图以模仿数学积分表达式

> ID：15032140
> 
> 赞同：2
> 
> 时间：2013-02-22T19:50:40.697
> 
> 标签：android, layout, view, android-relativelayout

我想要有一个复杂的视图排列，最终应该看起来像这样

```
 ______________
 | upper limit|
 ==============
      ____
      |  |
      |  | ___________
      |  | |Integrand|
      |  | ===========
      ====
    ________
    | low  |
    ======== 
```

当然，我尝试了令人讨厌的事情。彼此下方的三个视图 layout_centerHorizo​​ntal 将它们很好地居中，但是相对于整个布局。

我想让 Integrand 的视图向内移动到长垂直视图的右侧。但是，其他视图的中心对齐方式使其无法实现这一目标。

如果我在单独的布局中将三个视图彼此居中对齐，如果上限和下限视图变大，第四个视图将与长垂直视图相距太远。

我认为有一个简单的技巧可以实现它，非常感谢您的帮助。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content">
<com.example.nestviews.InputView
android:id="@+id/sum_upperlimit"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:text="10" />
<com.example.nestviews.LabelView
android:id="@+id/sum_label"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:paddingTop="-10dp"
android:layout_below="@id/sum_upperlimit"
android:layout_centerHorizontal="true"
android:textSize="40dp"
android:text="\u2211" />
<com.example.nestviews.InputView
android:id="@+id/sum_function"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignBottom="@id/sum_label"
android:layout_toRightOf="@id/sum_label"
android:layout_centerHorizontal="false"
android:text="n^2+1" />
<com.example.nestviews.InputView
android:id="@+id/sum_lowerlimit"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:layout_below="@id/sum_label"
android:text="n=1" />
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:29:02.207

我在一个相对布局中使用了一个相对布局，并为此使用了一个锚点。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <View
        android:id="@+id/sum_upperlimit"
        android:layout_width="200dp"
        android:layout_height="50dp"
        android:layout_centerHorizontal="true"
        android:background="@android:color/holo_purple" />

    <View
        android:id="@+id/View01"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_centerHorizontal="true"
        android:background="@android:color/holo_blue_dark" />

    <RelativeLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/relativeLayout1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/View01"
        android:layout_below="@+id/sum_upperlimit" >

        <View
            android:id="@+id/sum_label"
            android:layout_width="200dp"
            android:layout_height="50dp"
            android:layout_centerVertical="true"
            android:background="@android:color/holo_blue_light" />

        <View
            android:id="@+id/sum_function"
            android:layout_width="50dp"
            android:layout_height="300dp"
            android:layout_alignParentLeft="true"
            android:layout_alignParentTop="true"
            android:background="@android:color/holo_orange_light" />

        <View
            android:id="@+id/anchor"
            android:layout_width="50dp"
            android:layout_height="50dp"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:background="@android:color/holo_blue_dark" />
    </RelativeLayout>
     <View
        android:id="@+id/sum_lowerlimit"
        android:layout_width="100dp"
        android:layout_height="50dp"
        android:layout_below="@+id/relativeLayout1"
        android:layout_centerHorizontal="true"
        android:background="@android:color/black" />
</RelativeLayout> 
```

![在此处输入图像描述](../Images/e2f9b8e84dbc8be4e695fead798da13e.png)

# ios - 获取当前前台应用的名称

> ID：15032142
> 
> 赞同：3
> 
> 时间：2013-02-22T19:50:45.923
> 
> 标签：ios

我需要研究一组参与实验的测试用户实际使用了哪些应用程序。我想知道每个随机的 3rd 方应用程序用于对其进行统计的时间。如果可能的话，我计划通过 TestFlight 分发一个 iOS 应用程序。我的应用程序将收集应用程序使用统计数据并将其发送到我的服务器。

总体目标是每天从参与实验的每个用户那里获取每个已安装应用程序的总使用时间。

我有什么：我的一个想法是开发一个应用程序，该应用程序将使用 VoIP 后台配置文件（或类似配置）在后台运行并定期（如每 10 秒）记录当前前台应用程序的名称或捆绑标识符（如果任何）。

我找到了一种获取当前正在运行的进程的方法：[我们可以检索当前在 iPhone 和 iPad 上运行的应用程序](https://stackoverflow.com/questions/4312613/can-we-retrieve-the-applications-currently-running-in-iphone-and-ipad) 上述帖子中描述的方法给出了一个结构，该结构`kinfo_proc`包含其他结构，其中包含进程名称、优先级和运行时间等信息（包括在后台花费的时间）。我无法识别一个标志来揭示前景中的进程。优先级似乎也不是一个可靠的指标。我在这里错过了什么？

上述方法可用于获取进程的当前运行时间，但由于每个应用程序都可能在后台休眠数天（或数周），因此对于应用程序实际使用量而言，这是一个很差的指标。如果我可以每隔一小时左右杀死所有正在运行的用户安装的应用程序，那么我可以获得应用程序使用频率的指标。最常用的应用程序会更频繁地由用户冷启动。但这会给测试人员带来不愉快的体验，因为应用程序会被随机终止。但无论如何，有没有办法可以杀死另一个进程？

另一个想法是遍历视图层次结构来探测任务栏中最左侧应用程序的标签。关于这如何可能被破解的任何想法？

我有另一个想法，那就是分析设备日志并以这种方式收集应用程序使用统计信息。但是，似乎应用程序后台 - 前台切换活动未记录到系统控制台。是否有其他一些包含此信息的日志，或者我可以通过启用能源诊断日志记录以某种方式获取它？

如果我让我的测试用户设置为使用 Apple 移动设备管理 (MDM)，我是否能够收集我感兴趣的信息？

任何想法都非常感谢。

几点注意事项：我的测试用户没有越狱设备，但我可以使用私有 API，因为我不通过 App Store 分发。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-02-22T20:04:44.103

我会使用[Flurry Analytics](http://www.flurry.com/ "慌乱的")之类的分析工具来获取有关使用统计的数据，然后您可以使用[他们的 API](http://support.flurry.com/index.php?title=API_Usage)将这些数据下载到您的应用程序中。他们可以为您提供有关用户如何使用您的应用程序、使用频率等非常详细的统计信息。这是一个很棒的工具，而且它是免费的！

# shell - 我怎样才能得到最后修改日期

> ID：15032144
> 
> 赞同：0
> 
> 时间：2013-02-22T19:50:53.007
> 
> 标签：shell, command

如何仅获取文件夹（甚至子文件夹）中包含的文件的文件名及其最后修改日期

我想要这样的结果：

```
path/filename  lastmodified_date 
```

或者

```
filename lastmodified_date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:58:15.813

```
find /p/a/t/h -type f -printf '%p %t\n' 
```

将向您显示下面每个文件的名称和时间`/p/a/t/h`。要获取纪元时间而不是长格式，请使用：

```
find /p/a/t/h -type f -printf '%p %T@\n' 
```

查看文档以`find`获取有关如何更改时间戳格式的说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:53:00.557

您需要使用 glob() 或 scandir() 获取列表文件，之后需要使用 filemtime() 获取最后修改日期。

试试这个代码

```
$files = scandir('./'); // Get list files current dir
$times = array_map('filemtime', $files); // Get last modified date each file
$result = array_combine($files, $times); // Set file names as array index and times as value 
```

现在我们有了包含文件名和上次修改日期的数组。您可以使用 `foreach($result as $filename => $date)`$data 获取数据，该日期将具有 unix-time 日期。

# java - 如何在java中实现委托模式（如在objective-c中）

> ID：15032146
> 
> 赞同：7
> 
> 时间：2013-02-22T19:50:59.450
> 
> 标签：java, ios, objective-c, design-patterns, delegates

我查看了一个为 java 解释委托模式的示例。没有发现它有多大用处（请原谅我的无知），因为我觉得它在 Objective-c 中缺乏灵活性。有没有办法像在objective-c中那样动态设置委托对象。这不就是委托的全部意义吗？我对java的了解很初步，所以请详细解释一下。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:51:35.153

我认为有很多方法可以在 Java 中实现委托模式，但可能没有一种方法感觉像是内置的。

看看[维基百科的例子](http://en.wikipedia.org/wiki/Delegation_pattern#Complex)。您的基本选择是手动**实现一个接口**，然后简单地将调用转发**到一个具体实例**，您可以在运行时随意更改该实例。

现在，根据您拥有和可以使用的工具，您可以使此**转发**更加自动化。一个想法是使用面向方面的编程，例如 AspectJ。

拥有一个方面编译器（或运行时），您可以利用注释并为该语言提供一个简单的扩展：

```
class Person {
  @Delegate Animal animal;
  ...
} 
```

然后，您必须编写一个方面来查找s 并在类的（例如）接口`@Delegate`中自动添加转发方法。`Person`

**如果**您能够使用[更 groovy 的 JVM 语言](http://groovy.codehaus.org/)，那么您甚至不必编写一行代码，因为这些语言在标准库中有委托：

你可以看看[这里](http://groovy.codehaus.org/Delegate+transformation)，看看它是如何在 Groovy 中完成的。（本质`Person`上与我想出的示例语法完全一样......但内置！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T21:44:39.837

这就是你在 Java 中伪造函数式惯用语的方式。是的，这很可怕。如果您想要优雅的函数式惯用语，请使用一种不会将函数视为红头发继子的语言。如果您想要更多的编译时安全性，您当然可以使用更具体的接口定义，这样您就不会因为编程错误而到处出现 IndexOutOfBounds 和 ClassCastException。

```
public interface DelegatedFunction<T> {

T call(Object... args);

}

public class DoesSomeDelegatedTask {

  private List<DelegatedFunction<String>> delegatedFunctions = new ArrayList<>(1);

  public void addFunction(DelegatedFunction<String> function) {
    delegatedFunctions.add(function);
  }

  public void execute() {
    for (DelegatedFunction<String> function: delegatedFunctions) {
      System.out.println(function(something, someotherthing, whatever));
    }
  }
}

public class Main {
  public static void main(String[] args) throws Exception {
    DoesSomeDelegateTask doer = new DoesSomeDelegatedTask();
    doer.addFunction(new DelegatedFunction<String> () {
      @Override
      public String call(Object... args) {
        return ((SomeThings) args[0]).whatever((SomeOtherThing) args[1]//you get the idea
      }
    }
    doer.execute();
  }
} 
```

# ruby-on-rails - rails 3.2 ajax 实时搜索

> ID：15032148
> 
> 赞同：2
> 
> 时间：2013-02-22T19:51:05.680
> 
> 标签：ruby-on-rails, ajax

我仍然是 Rails 学习者，并且对实现 ajax 实时搜索感到绝望。搜索似乎适用于提交，但不适用于 keyup。想不通为什么...

index.html.erb

```
<%= form_tag contacts_path, :method => 'get', :id => "contacts_search" do %>
  <p>
    <%= text_field_tag :search, params[:search] %>
    <%= submit_tag "Search", :name => nil %>
  </p>
  <div id="cresults_div"><%= render 'cresults' %></div>
<% end %>

<%= link_to 'New Contact', new_contact_path %> 
```

联系人控制器.rb

```
 def index
    @contacts = Contact.search(params[:search])

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @contacts }
    end
  end 
```

index.js.erb

```
$("#cresults_div").html("<%= escape_javascript(render("cresults")) %>"); 
```

联系人.rb

```
 def self.search(search)
      if search
        where('last_name LIKE ?', "%#{search}%")
      else
        scoped
      end
  end 
```

联系人.js.coffee

```
jQuery ->
  # Ajax search on submit
  $('#contacts_search').submit( ->
    $.get(this.action, $(this).serialize(), null, 'script')
    false
  )
  # Ajax search on keyup
  $('#contacts_search input').keyup( ->
    $.get($("#contacts_search").attr("action"), $("#contacts_search").serialize(), null, 'script')
    false
  ) 
```

_cresults.html.erb

```
<%= hidden_field_tag :direction, params[:direction] %>
<%= hidden_field_tag :sort, params[:sort] %>
<h1>Listing contacts</h1>

<table>
  <tr>
    <th>Salutation</th>
    <th>First name</th>
    <th>Last name</th>
    <th>Stree</th>
    <th>Street no</th>
    <th>Zip</th>
    <th>City</th>
    <th>State</th>
    <th>Country</th>
    <th>Phone</th>
    <th>Email</th>
    <th></th>
    <th></th>
    <th></th>
  </tr>

<% @contacts.each do |contact| %>
  <tr>
    <td><%= contact.salutation %></td>
    <td><%= contact.first_name %></td>
    <td><%= contact.last_name %></td>
    <td><%= contact.stree %></td>
    <td><%= contact.street_no %></td>
    <td><%= contact.zip %></td>
    <td><%= contact.city %></td>
    <td><%= contact.state %></td>
    <td><%= contact.country %></td>
    <td><%= contact.phone %></td>
    <td><%= contact.email %></td>
    <td><%= link_to 'Show', contact %></td>
    <td><%= link_to 'Edit', edit_contact_path(contact) %></td>
    <td><%= link_to 'Destroy', contact, confirm: 'Are you sure?', method: :delete %></td>
  </tr>
<% end %>
</table> 
```

还尝试额外添加application.js

```
$(function() {
  $("#contacts_search input").keyup(function() {
    $.get($("#contacts_search").attr("action"), $("#contacts_search").serialize(), null, "script");
    return false;
  });
}); 
```

但是实时搜索不会在输入时开始......为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:53:53.523

在这种特殊情况下，我不得不删除

```
respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @contacts }
end 
```

从联系人控制器中的 index-Method 阻止

# php - 远程 php mysql_connect 到家里设置的 SQL 服务器

> ID：15032153
> 
> 赞同：0
> 
> 时间：2013-02-22T19:51:21.017
> 
> 标签：php, sql-server-2012

我已经在网上设置了一个免费域。我已经在我的家用 PC 上设置了 SQL Server 2012。问题：如何让我的 php MySql_connect 连接到我的家庭 SQL 服务器？假设我有一个生日愿望数据库，任何访问该网站的人都可以单击“显示”按钮，然后列表就会出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:55:55.663

SQL 服务器不使用`mysql_*`函数，您需要使用 PDO 驱动程序并使用 SQL 驱动程序连接。

[http://www.php.net/manual/en/ref.pdo-dblib.php](http://www.php.net/manual/en/ref.pdo-dblib.php)

然后使用 PDO Api

[http://www.php.net/manual/en/book.pdo.php](http://www.php.net/manual/en/book.pdo.php)

并使其外部端口通过路由器将 1433 转发到您的计算机。

* * *

此外，请确保您已将 SQL Server 配置为混合模式身份验证（服务器/本地身份验证），并为每个数据库创建不同的用户帐户。不要通过内置管理员帐户 (sa) 连接到 MSSQL 服务器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:54:44.563

在家中，在 Google 中搜索“我的 IP”，它应该会显示您路由器的外部 IP 地址。这就是您将`host`用作`mysql_connect`. 不幸的是，如果您的路由器重新启动或您断电等，您的 IP 地址可能会更改，因为您的 ISP 会动态分配 IP。

如果您的域名与您能够访问的服务器相结合，或者如果您的网络托管服务提供商为您提供 PHP，您可以使用 phpMyAdmin 或类似的东西来轻松地在服务器上设置数据库。然后你可以连接到`localhost`.

MySQL 和 SQL Server 之间没有明确的联系。SQL Server 是 Microsoft 产品，而 MySQL 是现在开源的 Oracle 产品。他们可能不会一起玩得很好。在服务器上建立数据库的想法听起来越来越诱人。

# android - 如何将 google maps v2 sdk 作为依赖项添加到 maven 项目？

> ID：15032154
> 
> 赞同：0
> 
> 时间：2013-02-22T19:51:22.040
> 
> 标签：android, maven, google-maps-android-api-2

如何将 google maps v2 sdk 作为依赖项添加到 maven 项目？我正在使用 jar 文件，但项目需要资源。我怎样才能添加它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T07:41:47.877

您应该能够使用我的 Maven Android SDK Deployer 将 Play 服务安装到本地 Maven 存储库或部署到存储库管理器，然后将 apklib 依赖项添加到包含地图内容的 Google Play 服务。

更多在[https://github.com/mosabua/maven-android-sdk-deployer](https://github.com/mosabua/maven-android-sdk-deployer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T13:20:29.330

It looks like the Maps v2 API is part of Google Play Services. So from the SDK manager, you need to make sure it's installed (under the 'Extras' category.) Then use the maven-android-sdk-deployer (as Manfred pointed out) to install the extras/google-play-services package. Then use this in your POM:

```
<dependency>
    <groupId>com.google.android.gms</groupId>
    <artifactId>google-play-services</artifactId>
    <version>7</version>
    <type>apklib</type>
</dependency>
<dependency>
    <groupId>com.google.android.gms</groupId>
    <artifactId>google-play-services</artifactId>
    <version>7</version>
    <type>jar</type>
</dependency> 
```

I noticed this when the maps JAR I was using has the package name `com.google.android.maps` but the v2 API uses `com.google.android.gms.maps`

# sql - 从 SQL 中的 select 语句中提取多个值

> ID：15032158
> 
> 赞同：3
> 
> 时间：2013-02-22T19:51:40.743
> 
> 标签：sql, select, inner-join

我正在尝试以更有效和优雅的方式实现这一目标

```
SELECT
  MD.*,
  (SELECT City FROM PostcodeData WHERE MD.Postcode = Postcode) [City],
  (SELECT State FROM PostcodeData WHERE MD.Postcode = Postcode) [State],
  (SELECT Areacode FROM PostcodeData WHERE MD.Postcode = Postcode) [Areacode]
FROM MemberDetails AS MD 
```

我显然可以在 Postcode 上 INNER JOIN 两个表，但是当 PostcodeData.postcode 中不存在 MemberDetail.postcode 时我遇到了问题。在这种情况下，我仍然希望选择那些成员，但城市、州和区号的结果为 NULL。这是在当前查询中实现的，但效率非常低。任何想法，将不胜感激。干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T19:54:05.873

只需使用`LEFT JOIN`：

```
SELECT
  MD.*,
  P.City,
  P.State,
  P.Areacode
FROM MemberDetails AS MD
   LEFT JOIN PostcodeData  P ON MD.Postcode = P.Postcode 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:53:47.073

使用 an[`OUTER JOIN`](http://msdn.microsoft.com/en-gb/library/ms187518%28v=sql.105%29.aspx)而不是 an `INNER JOIN`- 这将返回记录，即使连接表上没有匹配的记录。

> 然而，外部连接至少返回 FROM 子句中提到的一个表或视图中的所有行，只要这些行满足任何 WHERE 或 HAVING 搜索条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T19:55:32.087

肯定是外连接是答案吗？就像是：

```
SELECT MD.*, 
IsNull(pc.City,"No city") AS City,
IsNull(pc.State,"No state") AS State,
IsNull(pc.AreaCode,"No area code") AS AreaCode
FROM
MemberDetails AS MD
LEFT OUTER JOIN PostCodeData AS pc ON md.PostCode=pc.PostCode 
```

# git - git fetch、FETCH_HEAD 和 origin/master

> ID：15032159
> 
> 赞同：14
> 
> 时间：2013-02-22T19:51:41.467
> 
> 标签：git, git-fetch

我对 git 很陌生，但我在进行简单`fetch`操作时遇到了麻烦。

我正在尝试从他的存储库中获取同事的进度。起初我这样做了`git fetch HEAD`，这促使 git 下载了大约 350MB 的数据，所以我确信它已经做了一些事情。但是，`origin/master`最终仍然指向相同的旧提交（实际上它在名称下，`dev`但我会称之为`master`- 他没有`master`）。

之后我尝试`git fetch origin master`了但它似乎没有做任何事情，它只是更新了`FETCH_HEAD`. 我标记了`FETCH_HEAD`提交，所以我不会丢失它，但我仍然希望有一个更新的远程分支。

出了什么问题？我无权访问远程存储库。我还能在家修吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-23T20:46:23.870

我对您使用的命令有点困惑。 `HEAD`通常是 git 用来跟踪当前在工作目录中的提交的标签。该`git fetch`命令需要**远程**或**远程提交**配置来了解您想要获取的内容。使用`git fetch HEAD`将指示`HEAD`您的存储库中的远程。该命令没有错误地工作很奇怪。

例如： `git fetch HEAD`在我当前正在工作的存储库中导致以下错误

```
fatal: 'HEAD' does not appear to be a git repository
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

该命令`git remote`将列出所有遥控器，同时`git remote --verbose`将包括遥控器的地址。您可以使用它来查看您是否定义了远程`HEAD`以及您的朋友存储库的远程地址是什么？

但是，我的问题放在一边，以帮助消除您的困惑。该`git fetch ...`命令只更新远程引用——而不是你的本地引用。

为了清楚起见，请查看存储库中的 .git 文件夹（默认情况下它是隐藏的，因此您可能需要取消隐藏它）。您会发现类似于以下的文件夹结构

```
working directory
|=>.git
|  |=>objects           <= contains data for each commit
|  |=>refs
|     |=>heads
|        |-master       <= file containing current commit of local master branch
|     |=>remotes
|        |=>origin
|           |-master    <= file containing current commit of remote origin's master branch
|-FETCH_HEAD            <= file updated by `git fetch`, contains info of what was fetched 
```

假设您签出 master 分支，`git checkout master`--git 将更改您的工作目录以匹配 'objects' 文件夹中的提交数据，该数据与 '.git/refs/heads/master' 文件中的提交值匹配。

如果您这样`git fetch origin master`做，“.git/refs/remotes/origin/master”文件将更新为远程源上主分支的提交——并且该提交所需的所有提交数据都被下载并放置在“对象”中文件夹。

这里重要的一点是`git fetch`不会更新您的工作目录反映已签出的本地分支，并且`git fetch`永远不会更新本地分支。

需要使用`git merge ...`或`git rebase ...`来`master`使用`origin/master`. 根据选项和配置（是默认设置） ，`git pull ...`同时执行`git fetch ...`and either `git merge ...`or 。`git rebase ...``git merge ...`

在所有这些解释之后，您希望能够查看从您的朋友存储库中获取的内容（如果有的话）。该`git branch -avv`命令将列出所有本地和远程分支，以及提交号，对于本地分支，它正在跟踪哪个远程分支。

要查看分支如何相互关联，我发现使用工具绘制存储库树图很有帮助。有几个可供选择，但我发现`git log`命令足够了；比如`git log --all --graph --oneline --decorate`。公平的警告，对于大型存储库来说，这可能会很长并且令人费解。`--simplify-by-decoration`通过添加参数可以获得更短的输出。

总结一下：是否可以在家修复它取决于存储库中的信息。上述命令；`git remote --verbose`，`git branch -avv`并且`git log ...`应该让您了解存储库的当前状态。从那里您可以确定是否需要做更多的事情来使用`git merge`or获取本地分支中的数据`git rebase`。

与往常一样，如果您遇到麻烦，请回复您所学到的内容。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-01-07T08:51:07.217

从 git 1.8.4（2013 年 8 月）开始，[`git fetch`](http://git-scm.com/docs/git-fetch)将更新远程跟踪分支！不只是`FETCH_HEAD`。

请参阅[Jeff King (](https://github.com/peff) [)](https://github.com/peff)的[提交 f269048](https://github.com/git/git/commit/f269048754f3b835f4f7287c5a132714a059efce)：[`peff`](https://github.com/peff)

> 当我们运行一个不带参数的常规“ `git fetch`”时，我们会根据配置的 refspec 更新跟踪 refs。
> 但是，当我们运行“ `git fetch origin master`”（或“ `git pull origin master`”）时，我们根本不会查看配置的 refspec，而只是更新`FETCH_HEAD`.
> 
> 我们错过了更新“ `refs/remotes/origin/master`”（或用户配置的任何内容）的机会。一些用户觉得这很令人困惑，因为他们想与远程主机的旧状态进行进一步比较，例如：

```
$ git pull origin master
$ git log HEAD...origin/master 
```

* * *

但这假设您已将存储库设置为获取分支：

```
git config remote.origin.fetch 
```

如果为空：

```
git config remote.origin.fetch '+refs/heads/*:refs/remotes/origin/*' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-22T20:26:44.893

`git fetch`实际上并没有触及您的工作目录。它仅从远程获取最新更改。要实际更新您当前的状态，请使用[`git merge`](http://www.kernel.org/pub/software/scm/git/docs/git-merge.html)or [`git rebase`](http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)。此外，您可以使用[`git pull`](http://www.kernel.org/pub/software/scm/git/docs/git-pull.html)which 的作用类似于`git fetch`+的快捷方式`git merge`。

合并和变基之间的主要区别在于，在某些情况下合并将创建一个新的提交，具有累积状态（非快进合并）。恕我直言，这很糟糕，这让我想起了我使用 SVN 的时代。Rebase 只是在指定提交的顶部重放您的更改，因此您的历史记录始终是线性的。请务必使用与您的同事相同的流程。

我建议你阅读一些关于 git 和*git flow*的东西：一[本必读的书](https://github.com/progit/progit)和[一篇好文章](https://sandofsky.com/blog/git-workflow.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T13:52:03.123

你想做的是：

*   为您的同事添加遥控器
*   从他的存储库中获取更改
*   创建一个引用他的远程分支的本地分支

大概，您已经完成了第 1 步。但为了完整起见，它是：

`git remote add coworker git://path/to/coworkers/repo.git`

其中 URL 可以是 git 支持的任何 URL 格式。

现在您已经添加了遥控器，您想要获取他的更改：

`git fetch coworker`

这为您的每个分支提供了远程分支。假设他的分支叫做“仓鼠”。现在，为了完成工作，您创建自己的远程分支的本地副本

`git checkout -b hamster coworker/hamster`

这会创建并切换到一个名为 hamster 的分支。

从那时起，您可以在仓鼠上工作并将其推给他

`git push coworker hamster`

第一次，然后就`git push`在那之后。

任何时候你想下拉并合并他的更改，你可以这样做：

`git pull`

# compilation - 将 Ifort 标志转换为 Pgi Fortran 标志

> ID：15032163
> 
> 赞同：1
> 
> 时间：2013-02-22T19:51:52.347
> 
> 标签：compilation, fortran

当我使用 Intel Fortran 编译器和 Portlan Group 编译器编译相同的代码时，我得到了不同的结果。`-fp-model precise`pgi Fortran 中与ifort 中最接近的标志是什么？
pgi 中是否有一组标志可以匹配`-O2 -fp-model precise`ifort 标志的组合？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:39:00.967

使用不同编译器（甚至同一编译器的不同版本）编译的程序预计不会产生完全相同的结果。不同级别的优化（`-On`标志）在编译器之间也不是等效的（除了`-O0`根本不要求优化）。

我认为 PGI 中没有与 ifort's 等效的标志`-fp-model precise`，但您可能需要查看 PGI Fortran 编译器手册中的目标特定标志，更具体地说，这些标志：

```
-K[no]ieee          Use IEEE division, optionally enable traps
-Ktrap=align|denorm|divz|fp|inexact|inv|none|ovf|unf
                    Determine IEEE Trap conditions
-M[no]daz           Treat denormalized numbers as zero
-M[no]flushz        Set SSE to flush-to-zero mode
-M[no]fpapprox[=div|sqrt|rsqrt]
                    Perform certain fp operations using low-precision approximation
    div             Approximate floating point division
    sqrt            Approximate floating point square root
    rsqrt           Approximate floating point reciprocal square root
    -Mfpapprox      Approximate div,sqrt,rsqrt
-M[no]fpmisalign    Allow use of vector arithmetic instructions for unaligned operands
-M[no]fprelaxed[=div|recip|sqrt|rsqrt|[no]order]
                    Perform certain fp operations using relaxed precision
    div             Perform divide with relaxed precision
    recip           Perform reciprocal with relaxed precision
    sqrt            Perform square root with relaxed precision
    rsqrt           Perform reciprocal square root with relaxed precision
    [no]order       Allow expression reordering, including factoring
    -Mfprelaxed     Choose which operations depending on target processor 
```

程序的输出在不同编译器之间的某个不太重要的数字上有所不同是可以接受的。如果您的结果非常不同，则您的算法可能不是很健壮并且可能需要工作。

# ruby - Ruby Watir-Webdriver 的浏览器包装器

> ID：15032164
> 
> 赞同：1
> 
> 时间：2013-02-22T19:51:53.260
> 
> 标签：ruby, watir, watir-webdriver

我正在尝试围绕 Watir-Webdriver 的 Browser 对象编写一个包装器。主要是当用户调用

```
browser = Watir::Browser.new
browser.link(:text => 'continue').click 
```

我想检查用户在浏览器后输入的内容并记录下来，然后调用 Watir-Webdriver 的浏览器并执行操作。

我怎样才能做到这一点？

**更新**

我有一个公开 UI 测试功能的基类。它为用户实例化浏览器并将其公开为 $browser。当派生类对 $browser 对象执行任何操作时，我想将它包装在 begin/rescue 周围，并且我想记录用户正在做什么。因此，我不想公开 Watir 的 Browser 对象，而是想公开我自己的在调用 Watir 的 Browser 对象之前进行日志记录的对象。

现在，我通过在我的基类中有一个方法来实现这一点：

```
def perform(action, delay = 1)
    begin
        yield action if block_given?
        sleep delay
        assert(true)
    rescue  Watir::Exception::UnknownObjectException, 
            Watir::Exception::ObjectDisabledException,
            Watir::Exception::ObjectReadOnlyException,
            Watir::Exception::NoValueFoundException,
            Watir::Exception::MissingWayOfFindingObjectException,
            Watir::Exception::UnknownCellException,
            Watir::Exception::NoMatchingWindowFoundException,
            Watir::Exception::NoStatusBarException,
            Watir::Exception::NavigationException,
            Watir::Exception::UnknownFrameException,
            Watir::Exception::UnknownRowException,
            Selenium::WebDriver::Error::ElementNotVisibleError => e
        $log.error(e.message)
        assert(false)
    end
end 
```

但是，我想删除这个 perform 方法，这样调用者就不必对 perform 有任何了解。我还想检查调用者在 $browser 对象上所做的事情并记录下来。我不能在这里执行此操作，因为我无法将块转换为字符串。：-/

# r - R 中的 nls() 函数

> ID：15032166
> 
> 赞同：2
> 
> 时间：2013-02-22T19:51:56.677
> 
> 标签：r, regression, nls

混合新凯恩斯菲利普斯曲线是：

![模型](../Images/3c826ffed5d81b88c71557b8f034f96d.png)

经过几次操作，我们得到以下可估计模型：

![新模式](../Images/3d169db314b19c34748036e1f5ee3dad.png)

其中*π*是通货膨胀率，*x*是衡量产出缺口的指标（= 使用 Hodrick-Prescott 滤波器的 GDP 的周期性成分）。*模型π*和*x*的解释变量是可观察的。

我需要使用非线性最小二乘估计这个模型；然而，这个模型在我看来是线性的。此外，我`nls()`在 R 中使用该函数的尝试失败了。

此外，我对非线性回归的研究使我实现了逻辑人口增长，但我无法找到一种方法将我学到的知识与这个练习联系起来，尤其是在推导起始值时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T17:38:10.260

使用带有函数的普通最小二乘法 (OLS)`lm()`来估计问题中的方程 (2) 将导致对系数![系数1](../Images/e64a86e5028cd2fc833a22455204b608.png)和![系数2](../Images/dcbd94db2259b3b4836a70bad300e0bc.png)的估计![系数3](../Images/bf78970d3bd0afee4628bf3b2d9b8fe1.png)。

另一方面，使用具有`nls()`函数的非线性最小二乘法来估计方程将估计参数“a”、“b”和“c”的值，这些参数是感兴趣的参数。

R中的`nls()`函数（非线性最小二乘）有两个重要的参数：首先是`formula`参数，然后是`start`参数。在 R 中运行`?nls`会提供一些细节；然而，要点是`formula`参数包含一个想要估计的非线性模型的表达式（例如`y ~ a / (b + c*x)`，其中“y”和“x”是变量，“a”、“b”和“c”是参数感兴趣的）和`start`参数接受感兴趣的参数的起始值，R将在迭代过程中使用（因为非线性最小二乘法基本上迭代计算，直到获得参数的最佳值）。

以下是步骤：

(i) 获取参数'a'、'b'和'c'的起始值

在这里，我使用`lm()`函数来估计方程（2）的系数。我首先创建要在函数中使用的滞后变量。

注意：'y'指的是' ![圆周率](../Images/030bdca399c98079cdde288d12fb1253.png)'

```
y_1 = c(NA, head(y, head(y, -1) # variable 'y' lagged  by one time period
y_2 = c(c(NA, NA), head(y, head(y, -2) # variable 'y' lagged by two time periods
x_1 = c(NA, head(x, head(x, -1) # variable 'x' lagged by one time period 
```

因此，为了估计方程的系数，使用了以下代码：

```
reg = lm(y ~ y_1 + y_2 + x_1, na.action = na.exclude) # it is important to tell R to exclude the missing values (NA) that we included as we constructed the lagged variables 
```

现在我们有了 和 的估计值，![系数1](../Images/e64a86e5028cd2fc833a22455204b608.png)我们可以继续计算 'a'、'b' 和 'c' 的值，方法如下：![系数2](../Images/dcbd94db2259b3b4836a70bad300e0bc.png)![系数3](../Images/bf78970d3bd0afee4628bf3b2d9b8fe1.png)

```
B = 1 / reg$coefficients["y_1"] # Calculates the inverse of the coefficient on the variable 'y_1'

A = B * reg$coefficients["y_2"] # Multiplies 'b' by the coefficient on the variable 'y_2'

C = B * reg$coefficients["x_1"] # Multiplies 'b' by the coefficient on the variable 'x_1' 
```

`A`,`B`然后用作函数`C`中的起始值`nls()`

(ii) 使用`nls()`功能

```
nlreg = nls(y ~ (1/b)*y_1 - (a/b)*y_2 - (c/b)*x_1,
        start = list(a = A, b = B, c = C)) 
```

使用代码可以看到结果：

```
summary(nlreg) 
```

感谢 Ben Bolker 提供的见解:)

# iphone - 如何访问 iOS 设备 (iPhone/iPad) 内存统计信息？

> ID：15032169
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:02.870
> 
> 标签：iphone, ios, memory, statistics, device

我们如何以编程方式访问设备内存统计信息？假设我想知道设备的总内存容量是多少。比如是16GB、32Gb还是64GB，已经使用了多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:58:55.270

您可以通过方法检查这一点`attributesOfFileSystemForPath:`。将返回值存储到字典中，然后使用 key`NSFileSystemSize`可以检查总内存大小，通过 key`NSFileSystemFreeSize`可以检查可用内存

# c# - 记录哈希表属性

> ID：15032172
> 
> 赞同：2
> 
> 时间：2013-02-22T19:52:09.417
> 
> 标签：c#, visual-studio-2012

我有一个`Hashtable`我正在尝试记录的值。的名字`Hashtable`是“道具”。我的代码如下：

```
 Dictionary<string, string> keyPairs = new Dictionary<string, string>();
    foreach (KeyValuePair<string, string> items in props)
    {
       keyPairs.Add(items.Key, items.Value);
    }

    Logging.Instance.WriteInformation(string.Format("Key: {0} \t Value: {1}", keyPairs.Keys, keyPairs.Values)); 
```

然而，这会导致在`InvalidCastException`运行时。

是否有更简单/更明智的方式来记录键/值对？理想情况下，输出看起来像这样：

```
 key1        value1
 key2        value2
 key3        value3 
```

等等

另外一个想法是，在调试中，异常似乎发生在 foreach 循环的开始。我也尝试将其设置为`KeyValuePair<string, object>`但我得到相同的 InvalidCastException。
这可能与`KeyValuePair`在 System.Collections.Generic 中和`Hashtable`在 System.Collections 中有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T19:56:57.323

You can either use a loop or, if you want an one-liner:

```
var allPairs = string.Join(Environment.NewLine, 
    keyPairs.Select(kvp => string.Format("Key: {0} \t Value: {1}", kvp.Key, kvp.Value)));
Logging.Instance.WriteInformation(allPairs); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T19:54:16.293

当然，只需循环：

```
for (var entry : keyPairs)
{
    Logging.Instance.WriteInformation(string.Format("Key: {0} \t Value: {1}", 
                                      entry.Key, entry.Value);
} 
```

它只有几行 - 如果您在多个地方需要它，您可以轻松地将它放入一个方法中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T19:55:40.177

Log while you are looping.

```
Dictionary<string, string> keyPairs = new Dictionary<string, string>();
foreach (KeyValuePair<string, string> items in props)
{
   keyPairs.Add(items.Key, items.Value);
   Logging.Instance.WriteInformation(string.Format("Key: {0} \t Value: {1}", items.Key, items.Value));
} 
```

# ruby-on-rails - 如何获取 Ruby on Rails 中使用的 flash 的符号？

> ID：15032174
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:15.127
> 
> 标签：ruby-on-rails, helpers

我希望能够获得在 Flash 消息中使用的符号的名称。

例如：我正在寻找一个函数或助手，当 flash[:warning] 处于活动状态时会返回“警告”。

任何想法，将不胜感激？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-22T20:24:18.223

这对我有用。我想要从 flash[:warning] 中提取的字符串值 'warning'

```
flash.keys.first 
```

# html - Xml 到 Html 与不同路径之间的 xslt 依赖关系

> ID：15032177
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:42.900
> 
> 标签：html, xml, xslt

我正在尝试从 xml 文件开始动态生成问卷。问题是某些问题可能会根据其他答案显示或不显示。我不知道如何在html文件中插入这个依赖。我虽然在点击时插入一个 javascript 函数就足够了，但实际上我无法检索在这种情况下必须显示的问题。

这是我到目前为止的代码：

XML：

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl"?>
<questions>
  <question>
    <number/>
    <title>Which description best suits</title>
    <options>

      <option>
        <checkbox> String 1</checkbox>
        <questions/>
      </option>

      <option>
        <checkbox>  string 2 </checkbox>
        <questions>
          <question>
            <number/>
            <title> Hidden question ?</title>
            <options>

              <option>
                <checkbox> Hidden string 1</checkbox>
                <questions/>
              </option>

              <option>
                <checkbox> Hidden string 2 </checkbox>
              </option>

            </options>
          </question>
        </questions>
      </option>

    </options>
  </question>
</questions> 
```

XSLT：

```
<xsl:stylesheet version = '1.0' 
     xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>

<xsl:template match="/questions/question"> 
 <div id="question">
   <h6> <xsl:value-of select="//title"/> </h6>
   <xsl:apply-templates select="child::options"/> 
</div> 
</xsl:template>

<xsl:template match="*/questions/question">
 <div id="question" style="visibility:hidden;">
   <h6> <xsl:value-of select="child::title"/> </h6>
   <xsl:apply-templates select="child::options"/> 
</div> 
</xsl:template>

<xsl:template match="options"> 
    <div id="options">
         <xsl:apply-templates select="child::option" /> 
     </div>
</xsl:template>

<xsl:template match="checkbox"> 
  <input type="checkbox">
   <xsl:value-of select="."/>
  </input> 
</xsl:template>

<xsl:template match="textinput"> 
  <p> <xsl:value-of select="."/> </p>
  <input type="input">
   </input> 
</xsl:template>

<xsl:template match="checkboxInput"> 
  <input type="checkbox"><xsl:value-of select="."/></input> 
  <input type="input"></input> 
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:08:33.410

这应该可以解决问题：

```
<xsl:stylesheet version = '1.0'
     xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>

  <xsl:template match='/'>
    <html>
      <head>
        <title>Questions</title>
        <script 
           src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>
          function toggleQuestions(id, show)
          {
          var questions = $('#' + id);
          if(show)
          questions.show();
          else
          questions.hide();
          }
        </script>
        <style>
          .subQuestions
          {
          display: none;
          }
        </style>
      </head>
      <body>
        <xsl:apply-templates select='questions/question' />
      </body>
    </html>
  </xsl:template>
  <xsl:template match="questions/question">
    <xsl:param name="prefix" select="'question'" />

    <xsl:variable name="id" select="concat($prefix, '-', position())" />
    <div class="question" id="{$id}">
      <h6>
        <xsl:value-of select="title"/>
      </h6>
      <xsl:apply-templates select="options">
        <xsl:with-param name="prefix" select="$id" />
      </xsl:apply-templates>
      <xsl:apply-templates select="options/option[questions/question]" 
                           mode="subQuestions">
        <xsl:with-param name="prefix" select="$id" />
      </xsl:apply-templates>
    </div>
  </xsl:template>

  <xsl:template match="options">
    <xsl:param name="prefix" />
    <div class="options">
      <xsl:apply-templates select="option">
        <xsl:with-param name="prefix" select="$prefix" />
      </xsl:apply-templates>
    </div>
  </xsl:template>

  <xsl:template match="option">
    <xsl:param name="prefix" />
    <xsl:apply-templates select="*[not(self::questions)]">
      <xsl:with-param name="prefix" select="$prefix" />
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="checkbox" name="CheckBox">
    <xsl:param name="prefix" />
    <xsl:variable name="id" select="concat($prefix, '-', position())" />

    <input type="checkbox" >
      <xsl:if test="../questions/question">
        <xsl:attribute name="onclick">
          <xsl:value-of 
             select="concat('toggleQuestions(&quot;', 
                            $id, 
                            '&quot;, this.checked)')" />
        </xsl:attribute>
      </xsl:if>
      <xsl:value-of select="."/>
    </input>
  </xsl:template>

  <xsl:template match="textinput">
    <p>
      <xsl:value-of select="."/>
    </p>
    <input type="input">
    </input>
  </xsl:template>

  <xsl:template match="checkboxInput">
    <xsl:param name="prefix" />

    <xsl:call-template name="CheckBox">
      <xsl:with-param name="prefix" select="$prefix" />
    </xsl:call-template>
    <input type="input"></input>
  </xsl:template>

  <xsl:template match="option" mode="subQuestions">
    <xsl:param name="prefix" />
    <xsl:variable name="id" select="concat($prefix, '-', position())" />

    <div class="subQuestions" id="{$id}">
      <xsl:apply-templates select="questions/question">
        <xsl:with-param name="prefix" select="$id" />
      </xsl:apply-templates>
    </div>
  </xsl:template>
</xsl:stylesheet> 
```

在您的输入 XML 上运行时，这会产生：

```
<html>
  <head>
    <META http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Questions</title><script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script><script>
          function toggleQuestions(id, show)
          {
          var questions = $('#' + id);
          if(show)
          questions.show();
          else
          questions.hide();
          }
        </script><style>
          .subQuestions
          {
          display: none;
          }
        </style>
  </head>
  <body>
    <div class="question" id="question-1">
      <h6>Which description best suits</h6>
      <div class="options"><input type="checkbox"> String 1<input type="checkbox" onclick="toggleQuestions(&quot;question-1-1&quot;, this.checked)">  string 2 </div>
      <div class="subQuestions" id="question-1-1">
        <div class="question" id="question-1-1-1">
          <h6> Hidden question ?</h6>
          <div class="options"><input type="checkbox"> Hidden string 1<input type="checkbox"> Hidden string 2 </div>
        </div>
      </div>
    </div>
  </body>
</html> 
```

CSS 默认隐藏子`onclick`问题，处理程序中的 JavaScript 用于根据需要显示/隐藏问题。

# matlab - MATLAB中的快速傅立叶逆变换

> ID：15032178
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:43.440
> 
> 标签：matlab, fft

我的 MATLAB 代码`fft`及`ifft`以下代码存在逆傅立叶信号与输入信号`y`不匹配的问题`x`。有什么解决方案可以解决这个问题吗？

```
N = 1000;
t0 = 1e-13;
tau = 2*1e-14;
n = [0:t0/40:2*1e-13-t0/40];
f0 = 3*1e8/(150*1e-9);

x = cos(2*pi*f0*n);
x = x.*exp((-(n-t0).^2)./(tau^2));
X = abs(fft(x,N));
F = [-N/2 : N/2 - 1]/N;
X = fftshift(X);
y=ifft(X,80);

figure(3)
plot(n,y) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:23:35.607

我在这里看到了一些问题：

```
N = 1000;
t0 = 1e-13;
tau = 2*1e-14;
n = [0:t0/40:2*1e-13-t0/40];
f0 = 3*1e8/(150*1e-9);

x = cos(2*pi*f0*n);
x = x.*exp((-(n-t0).^2)./(tau^2));
%  X = abs(fft(x,N));  <-- Not seen this technique before, and why N=1000?
% try something more like:
X = fft(x);

F = [-N/2 : N/2 - 1]/N;
% this is fine to shift and plot the function
Xshifted = fftshift(X);
plot( abs( Xshifted ) )
% now you're taking the inverse of the shifted function, not what you want
% y=ifft(X,80);  also not sure about the 80
y = ifft(X);

figure(3)
plot(n,y)
figure(4)
plot( n, x ); hold on; plot( n, y, 'o' ) 
```

![脚本输出](../Images/69252a7f3a665441eb3dc346c366618d.png)

这就是我最初所看到的。！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-17T20:44:50.147

如果你取 fft 的绝对值，你会破坏重建原始信号所需的相位信息，即你​​计算的那一刻

```
X = abs(fft(x,N)); 
```

你不能通过 ifft 回去，因为现在你只有量级。此外，仅当您使用相同数量的 FFT bin 且 NFFT>=length(x) 时，逆变换才有效。

```
y=ifft(fft(x)); 
```

应该与 x 完全相同。

# python - Python 程序在处理异常时终止

> ID：15032180
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:48.517
> 
> 标签：python, exception

为了清楚起见，我正在编辑问题。

我在导入 MySQLdb 的模块中创建了一个类。我发现如果用户传递给我的类的表不存在，MySQLdb 将引发异常。我正在捕获该异常，并将一个新异常传递给客户。但即使客户端捕捉到我的异常，程序仍然会终止。我也尝试将相同的异常 MySQLdb 传递给客户端。

由于客户端将在循环中调用我的方法，并传入各种表名，因此如果表名不好，我不希望程序阻塞。我希望客户的迭代继续到下一个有效的表名。这是一个片段（tableName 是传递给该方法的参数）：

在我的班级/模块中：

```
    self.tableName = 表名
    尝试：       
        self.cursor.execute("select * from " + self.tableName + ";") #如果表不存在会抛出异常。
    除了：
        raise MyException("\n*** " + self.tableName + " 不存在。***")

```

在客户端：

```
    表 = ["BadTableName", "GoodTableNameA", "GoodTableNameB","GoodTableNameC"]

    尝试：
        对于表格中的表格：
            my_method(table) #Exception 消息通过 BadTableName 传入，但程序结束。此循环的子序列迭代永远不会发生
    除了例外，e：
        打印 e

```

即使在调用 my_method(BadTableName) 之后，我也希望客户端继续。

顺便说一句，my_method() 是在客户端导入的其自己的模块中定义的类的一部分。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:00:06.900

异常并不总是导致程序结束。从[文档](http://docs.python.org/2/tutorial/errors.html#exceptions)：

> 在执行过程中检测到的错误称为异常并且不是无条件致命的：

如果在 try: except 块中引发异常并且`except`子句指定异常或异常的超类，它将被处理。

在处理异常时，您可以检查它并找出与之相关的所有信息。我以前从未使用过该[`traceback`](http://docs.python.org/2/library/traceback.html#traceback-examples)模块，但它看起来包含您需要的一切。

我想您的第二个问题取决于您希望用户看到的内容。是否应该显示异常？（您可以访问回溯）。应该只显示消息吗？你应该记录回溯吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:06:06.863

添加到其他答案：未捕获的异常将终止程序，但仅在执行适用的[`finally`块](http://docs.python.org/2/reference/compound_stmts.html#finally)（如果有）和任何[`atexit`处理程序](http://docs.python.org/2/library/atexit.html)之后。所以原则上，可以在未捕获的异常之后无限期地继续执行。

但是，没有一类异常只会打印错误消息并按其性质继续执行。如果需要，请使用[警告](http://docs.python.org/2/library/warnings.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:00:45.497

未*捕获*的异常将终止程序。*捕获*的异常不会

如果捕获到异常，可以使用 traceback 模块输出堆栈跟踪：

[http://docs.python.org/2/library/traceback.html#traceback-examples](http://docs.python.org/2/library/traceback.html#traceback-examples)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T19:58:48.277

1）不，引发异常并不总是导致程序终止。*未捕获*的异常会导致程序终止。您可以使用块包围代码`try/except`，如下所示，以阻止异常向上传播堆栈。

```
try:
    file = open("foo.txt")
except IOError:
    file = None 
```

2）实际捕获异常的代码可以访问异常的原始堆栈帧，并且可以决定如何处理它。

使用原始回溯重新引发错误：

```
try:
    some_function()
except IOError as e:
    raise 
```

使用新的回溯重新引发错误（几乎没有第一种情况有用）：

```
try:
    some_function()
except IOError as e:
    raise e 
```

不要重新引发，并打印异常和回溯：

```
try:
    some_function()
except IOError as e:
    import traceback
    traceback.print_exc() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T20:50:34.087

阅读您编辑的问题后，我不确定您遇到了两个问题中的哪一个。

* * *

如果您的问题只是您只想要一个异常来终止一个循环迭代而不是整个循环，那么只需以明显的方式重新嵌套语句即可。而不是这个：

```
try:
    for table in tables:
        my_method(table) #Exception message gets passed in with BadTableName, but the program ends. Subsequest iterations of this loop never happen
except Exception, e:
    print e 
```

做这个：

```
for table in tables:
    try:
        my_method(table) #Exception message gets passed in with BadTableName, but the program ends. Subsequest iterations of this loop never happen
    except Exception, e:
        print e 
```

* * *

另一方面，如果问题是客户端没有捕获异常，那么问题很可能是您`MyException`的不是`Exception`. 至少有三种方式会发生这种情况。

由于您使用的是旧式`except`语法 ( `except Exception, e:`) 而不是新式 ( `except Exception as e:`)，因此您可能使用的是较旧的 Python 版本，它允许您引发不继承自`BaseException`. 例如：

```
class MyException(object):
    def __init__(self, msg):
        pass

try:
    raise MyException("dsfsdf")
except Exception:
    pass 
```

根据您的 Python 版本，这可能无法引发`MyException`，而是引发 a `TypeError(' Out[11]: TypeError('exceptions must be old-style classes or derived from BaseException, not MyException')`（这将被捕获），或打印警告，或者只是按照您的要求默默地“工作”（这意味着您没有捕获任何东西，而您的程序退出并回溯）。

* * *

同时，即使在 2.7 中，您仍然可以提出旧式类，也不会被捕获：

```
class MyException:
    def __init__(self, msg):
        pass

try:
    raise MyException("dsfsdf")
except Exception:
    pass 
```

这将始终无法捕获异常，并且您的应用程序将退出并带有回溯。

* * *

最后，如果你继承自`BaseException`而不是`Exception`，那么显然`Exception`不会抓住它。

```
class MyException(BaseException):
    def __init__(self, msg):
        pass

try:
    raise MyException("dsfsdf")
except Exception:
    pass 
```

再一次，这将始终无法捕获您提出的内容，并且您将退出并进行回溯。

# objective-c - 编译特定文件的标志

> ID：15032181
> 
> 赞同：0
> 
> 时间：2013-02-22T19:52:53.293
> 
> 标签：objective-c, xcode, objective-c++, compiler-flags

我在 xcode 上使用配置将源代码编译为 Objective-C++，但我添加了一个库，我想将其编译为 Objective-C，有办法吗？

我的配置：

```
//:configuration = Debug
CLANG_CXX_LIBRARY = libstdc++

//:configuration = Release
CLANG_CXX_LIBRARY = libstdc++

//:completeSettings = some
GCC_C_LANGUAGE_STANDARD
CLANG_CXX_LIBRARY
GCC_CW_ASM_SYNTAX

//:configuration = Debug
CLANG_CXX_LIBRARY = libstdc++
GCC_INPUT_FILETYPE = sourcecode.cpp.objcpp

//:configuration = Release
CLANG_CXX_LIBRARY = libstdc++
GCC_INPUT_FILETYPE = sourcecode.cpp.objcpp

//:completeSettings = some
GCC_C_LANGUAGE_STANDARD
CLANG_CXX_LIBRARY
GCC_CW_ASM_SYNTAX
GCC_INPUT_FILETYPE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T01:27:38.493

我不推荐你在这里做了什么。与其更改全局默认值，不如正确命名您的文件（`.m`对于 ObjC 和`.mm`ObjC++，对于 C++，'.cpp'）。如果由于某种原因这是不可能的，那么您可以选择要覆盖的单个文件。在“文件”列表中选择它们，打开检查器，然后在“身份和类型”字段中选择您想要的每个文件类型。应该可以通过这种方式将单个文件重置回 ObjC，但我建议保留默认设置并在绝对需要的地方覆盖。

将大部分代码编译为 ObjC++ 并不是一个好习惯。它不是一种得到很好支持的语言。它旨在作为 ObjC 和纯 C++ 之间的粘合剂。ObjC++ 在编译时和运行时会带来很多开销并导致性能损失（它在运行时也比 ObjC 或 C++ 使用更多的内存）。调试器和其他工具对它的支持最少。您当然不应该将其设为您的默认语言。有关该主题的更多信息，请参阅[Wrapping C++ Final Edition](http://robnapier.net/blog/wrapping-cppfinal-edition-759)。

# r - 使用带有特殊时区格式的 strptime %z

> ID：15032184
> 
> 赞同：8
> 
> 时间：2013-02-22T19:53:05.843
> 
> 标签：r, timezone, strptime, string-to-datetime

我正在处理从 Teradata 导出的 .csv 数据。几列最初是带有时区的时间戳，因此在 R 中加载 .csv 后，我想将这些列（作为字符串加载）转换为 POSIXlt 或 POSIXct。我正在使用，但 .csv 文件中的时区格式与预期`strptime`不符。`strptime`例如，它期望`-0400`但 .csv 具有`-04:00`冒号分隔小时和分钟的格式。

我可以删除冒号，但如果可能的话，这是一个额外的步骤和并发症。有没有办法告诉`strptime`时区（）使用不同的格式`%z`？

这是一个例子：

```
## Example data:
x <- c("2011-10-12 22:17:13.860746-04:00", "2011-10-12 22:17:13.860746+00:00")
format <- "%Y-%m-%d %H:%M:%OS%z"

## Doesn't work:
strptime(x,format)
## [1] NA NA

## Ignores the timezone:
as.POSIXct(x)
## [1] "2011-10-12 22:17:13 EDT" "2011-10-12 22:17:13 EDT"

## Remove the last colon:
x2 <- gsub("(.*):", "\\1", x)
x2
## [1] "2011-10-12 22:17:13.860746-0400" "2011-10-12 22:17:13.860746+0000"

## This works, but requires extra processing (removing the colon)
strptime(x2,format)
## [1] "2011-10-12 22:17:13" "2011-10-12 18:17:13" 
```

所以我希望使用类似的东西来实现最后一个结果`strptime(x,"%Y-%m-%d %H:%M:%OS%zz")`，其中`%zz`是识别`-04:00`格式的时区的自定义表达式。或者`%zH:%zM`可能会更好。

如果这是不可能的，是否有人具有将字符串（各种格式）转换为 data.frame/data.table 多列的日期的灵活/灵活的功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-08-14T04:57:35.993

事实证明`lubridate`可以处理这种格式：

```
library(lubridate)
ymd_hms(x)
## [1] "2011-10-13 02:17:13 UTC" "2011-10-12 22:17:13 UTC" 
```

或者，以本地时区显示：

```
with_tz(ymd_hms(x))
## [1] "2011-10-12 22:17:13 EDT" "2011-10-12 18:17:13 EDT" 
```

为了获得更大的灵活性（仍在使用`lubridate`）：

```
parse_date_time(x, "%Y-%m-%d %H:%M:%OS%z") 
```

为了更快的速度（在`lubridate`选项中）：

```
lubridate:::.strptime(x, "%Y-%m-%d %H:%M:%OS%OO") 
```

时间：

```
microbenchmark(
  ymd_hms(x),
  parse_date_time(x, "%Y-%m-%d %H:%M:%OS%z"),
  lubridate:::.strptime(x, "%Y-%m-%d %H:%M:%OS%OO"),
  strptime(gsub("(.*):", "\\1", x), format)
)

## Unit: microseconds
##                                               expr      min       lq       mean    median        uq      max neval
##                                         ymd_hms(x) 1523.819 1578.495 1715.14577 1629.5385 1744.3695 2850.393   100
##         parse_date_time(x, "%Y-%m-%d %H:%M:%OS%z") 1108.676 1150.633 1273.77301 1190.3315 1264.8050 5947.204   100
##  lubridate:::.strptime(x, "%Y-%m-%d %H:%M:%OS%OO")   89.838  103.390  112.45338  107.8425  115.2265  216.512   100
##        strptime(gsub("(.*):", "\\\\1", x), format)   46.716   58.294   71.90934   69.9415   86.5860  105.044   100 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T01:55:02.383

我刚刚遇到这个问题，试图实现同样的目标。

正如您所提到的，我发现修复它的唯一方法是使用正则表达式删除冒号。您可以稍微收紧正则表达式以避免在替换时出错。

```
x2 <- gsub('^([0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}\\.[0-9]+[+-][0-9]{2}):([0-9]{2})$',
           '\\1\\2',
           x)
# [1] "2011-10-12 22:17:13.860746-0400" "2011-10-12 22:17:13.860746+0000" 
```

# iphone - 我将如何测试为 JSON Web 服务下载数据需要多长时间。

> ID：15032185
> 
> 赞同：0
> 
> 时间：2013-02-22T19:53:10.203
> 
> 标签：iphone, ios, objective-c, json

我将如何测试从 JSON Web 服务下载数据需要多长时间

目前我是以下代码，并想 NSLog 下载需要多长时间。

```
- (void)downloadData{

// Download the JSON
NSString *jsonString = [NSString
                        stringWithContentsOfURL:[NSURL URLWithString:queryLine]
                        encoding:NSStringEncodingConversionAllowLossy|NSUTF8StringEncoding
                        error:nil];

NSMutableArray *itemsTMP = [[NSMutableArray alloc] init];

// Create parser for the api
SBJSON *parser = [[SBJSON alloc] init];
NSDictionary *results = [parser objectWithString:jsonString error:nil];

itemsTMP = [results objectForKey:@"results"];

[self setAllItems:[itemsTMP copy]];
self.displayItems = [itemsTMP copy];

int a =   [displayItems count];
    NSString *countString = [NSString stringWithFormat:@" results %d",a];
    countLabel.text = countString;

} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:59:01.950

您应该使用作为 Apple Developer 工具的一部分提供的 Instruments 工具。完全按照您的要求以及许多其他事情去做真的很棒。这是一个很好的起点：http: [//developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html](http://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:07:31.523

在下载 JSON 之前获取“时间戳”

```
NSDate *startTime = [[NSDate alloc] init];

// Download the JSON
NSString *jsonString = [NSString
                        stringWithContentsOfURL:[NSURL URLWithString:queryLine]
                        encoding:NSStringEncodingConversionAllowLossy|NSUTF8StringEncoding
                        error:nil];

NSDate *elapsedTime = [NSDate dateWithTimeInterval:0 sinceDate:startTime]; 
```

elapsedTime 将是一个 NSDate 对象，从日期开始设置为 seconds 秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T12:05:05.453

这就是我最终使用的。它非常适合我的需求。

```
 NSLog(@"Begin <your method name>");
NSDate *startTime = [NSDate date];

// Do something useful here

NSTimeInterval elapsedTime = [startTime timeIntervalSinceNow];
NSLog(@"End <your method name>");
NSLog([NSString stringWithFormat:@"Elapsed time: %f", -elapsedTime]); 
```

# c# - 如果记录存在，如何在 DataGridView 中使用 Check 填充 CheckBox 列？

> ID：15032188
> 
> 赞同：0
> 
> 时间：2013-02-22T19:53:20.263
> 
> 标签：c#, winforms, datagridview, datagridviewcheckboxcell

我有一个只显示 2 列的 DataGridView：员工姓名和一个名为参加的复选框。这是为了跟踪员工出席安全会议的情况。

加载此 DGV 时，我希望已标记为已参加的员工在各自的复选框中打勾。

这是我尝试过的，但它只检查所有框：

```
private void LoadEmpAttendanceDGV()
{
    string sqlstm = "SELECT EmpID, EmpName FROM dbo.MY_TABLE";
    // Additional code here, which loads the grid.

    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        myKey.empID = tempEmpID;
        myKey.trainingID = tempTrainingID;
        myRow = trainingSession.Read(myKey);

        // Check to see if record exists, meaning employee attended meeting.
        if (myRow != null)
        {
            for (int j=0; j < ds.Tables[0].Rows.Count; j++)
            {
                myDataGridView["Attended", j].Value = true;
                // Where "Attended" is the name of my CheckBox column
            }
        }
    }
} 
```

如果有人可以提供任何见解，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:13:25.700

像这样创建表

**SqlServer 代码**

```
USE [acc]
GO

CREATE TABLE [dbo].[EmpAttendedTheMeeting](
    [EName] [varchar](50) NOT NULL
) ON [PRIMARY]

GO

CREATE TABLE [dbo].[Employees](
    [EName] [varchar](50) NOT NULL
) ON [PRIMARY]

GO
insert into Employees(EName) values('kashif')
insert into Employees(EName) values('sunny')
insert into Employees(EName) values('kamran')

insert into EmpAttendedTheMeeting(EName) values('kashif')
insert into EmpAttendedTheMeeting(EName) values('kamran') 
```

**c# 代码**

```
namespace WindowsFormsApplication9
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        DataGridViewTextBoxColumn tb = new DataGridViewTextBoxColumn();
        DataGridViewCheckBoxColumn cb = new DataGridViewCheckBoxColumn();
        private void Form1_Load(object sender, EventArgs e)
        {
            FormatGrid(dataGridView1);
            LoadDg();
        }
        private void FormatGrid(DataGridView dg)
        {
            dg.Columns.Add(tb);
            dg.Columns[0].HeaderText = "EName";
            dg.Columns[0].Width = 199;

            dg.Columns.Add(cb);
            dg.Columns[1].HeaderText = "Attended";
            dg.Columns[1].Width = 69;            
        }
        private void LoadDg()
        {
            SqlConnection cn = new SqlConnection("data source=localhost;initial catalog=acc;uid=sa;pwd=emotions");                
            SqlDataAdapter da = new SqlDataAdapter("select Employees.EName, EmpAttendedTheMeeting.EName from Employees left join EmpAttendedTheMeeting on Employees.EName = EmpAttendedTheMeeting.EName", cn);
            DataTable dt = new DataTable();
            da.Fill(dt);
            foreach (DataRow dr in dt.Rows)
            {           
                dataGridView1.Rows.Add(dr[0], dr[1].ToString() == string.Empty ? false : true);
            }
        }   

    }
} 
```

我在我的gridview中得到这样的结果。因为sunny不在EmpAttentendedTheMeeting中，所以他的名字是未选中的

![网格视图](../Images/9a3d7545f5023ba6d62a25ffd81bbb63.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:03:10.907

尝试在设置值的底部附近的行中将 j 更改为 i

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T23:34:40.980

如果我错了，请原谅我，但这部分代码：

```
 for (int j=0; j < ds.Tables[0].Rows.Count; j++)
        {
            myDataGridView["Attended", j].Value = true;
            // Where "Attended" is the name of my CheckBox column
        } 
```

肯定将*每一*行都设置为真，不是吗？您只想将特定行设置为 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T20:34:40.740

如何在原始 SQL 中捕获记录的存在？就像是

SELECT EmpID, EmpName, isnull(attended,0) FROM dbo.MY_TABLE m 左外连接参加了 m.EmpID = a.EmpID

# jquery - jquery获取有文本的孩子的父母

> ID：15032189
> 
> 赞同：0
> 
> 时间：2013-02-22T19:53:26.907
> 
> 标签：jquery, selector

我正在使用 jQuery UI 对话框小部件。我正在创建两个按钮“开始/取消”。我需要编写一些导致单击“开始”按钮的代码。jQuery UI 创建以下标记：

```
<button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only" role="button" aria-disabled="false"><span class="ui-button-text">Start</span></button> 
```

所以，基本上，我想要一个选择器，它根据子元素的（跨度）文本（“开始”）选择父元素（按钮）。有没有选择器可以做到这一点？

谢谢，杰罗姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:57:23.063

像这样的东西应该可以工作，而不是经过测试..

```
$("button > span:contains('Start')").parent().click(); 
```

# jquery - jQuery从字符串中提取指定的子字符串和以下数字

> ID：15032192
> 
> 赞同：0
> 
> 时间：2013-02-22T19:53:35.847
> 
> 标签：jquery, string, extract

我需要提取一个指定的子字符串，然后是该子字符串后面的数字。

例如，我需要`cid=159`从字符串中提取： `http://website.com/ProductCats.asp?cid=159&otherjunk=1`. 即使`cid=`保持不变，后面的数字也可以改变，并且可以在 1-4 位之间的任何位置。

有什么方法可以提取该模式？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T19:57:52.537

这可能会有所帮助。我不记得在哪里找到它了，但它是一个获取 URL 并将变量分配给可以引用的数组的函数。这也是纯javascript。

```
function getUrlVars() {
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)     {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

所以你会做

```
var myURLArray = getUrlVars();
var cid = myURLArray['cid']; 
```

它对我帮助很大。再说一次，我没有做这个，但它很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:03:42.300

仅对任何 url 使用 javascript，而不仅仅是当前窗口 URL（如果需要）。`getLocation`我从与此相关的先前 SO 问题中借用了该功能。

```
var getLocation = function(href) {
    var l = document.createElement("a");
    l.href = href;
    return l;
};
var getUriObject = function(href){
    var l = getLocation(href);
    var queryArray=l.search.substr(1).split('&');
    var uriObject={};
    for(var i=0;i<queryArray.length;i++){
        uriObject[queryArray[i].split('=')[0]]=queryArray[i].split('=')[1];
    }
    return uriObject;
}
alert(getUriObject("http://website.com/ProductCats.asp?cid=159&otherjunk=1").cid); 
```

# loops - Apache james mailet 无限循环

> ID：15032193
> 
> 赞同：2
> 
> 时间：2013-02-22T19:53:36.337
> 
> 标签：loops, infinite-loop, james

我尝试将我的第一个示例 mailet 部署到 apache james v2.3.2，但它进入了一个无限循环，即使在重新启动服务器后一次又一次地向我发送电子邮件。阻止它的唯一方法是清理假脱机文件夹。

在 config.xml 中，我按如下方式配置了我的 mailet：

```
<mailet match="All" class="MyMailet" onMailetException="ignore">
  <supportMailAddress>support@[mydomain].com</supportMailAddress>
</mailet> 
```

我的 mailet 所做的只是从 support@[mydomain].com 向 me@[mydomain].com 邮箱发送电子邮件：

```
public class MyMailet extends GenericMailet {
  private MailAddress supportMailAddress;

  public void init() throws ParseException {
    supportMailAddress = new MailAddress(getInitParameter("supportMailAddress"));
  }

  public void service(Mail mail) throws MessagingException {
    MailAddress sender = mail.getSender();
    MailAddress realMailbox = new MailAddress("me@[mydomain].com");

    try {
      sendToRealMailbox(mail, realMailbox);
    } catch (MessagingException me) {
      me.printStackTrace();
    } catch (IOException ioe) {
      ioe.printStackTrace();
    }

    mail.setState(Mail.GHOST);
  }

  private void sendToRealMailbox(Mail mail, MailAddress realMailbox) throws MessagingException, IOException {
    Properties props = System.getProperties();
    Session session = Session.getDefaultInstance(props);
    MimeMessage message = new MimeMessage(session);

    message.setFrom(supportMailAddress.toInternetAddress());
    message.setRecipient(Message.RecipientType.TO, realMailbox.toInternetAddress());
    message.setSubject("MyMailet: " + mail.getMessage().getSubject());
    message.setText("MyMailet: message body");
    message.setSentDate(new Date());

    Collection recipients = new Vector();
    recipients.add(realMailbox);
    getMailetContext().sendMail(supportMailAddress, recipients, message);
  }

  public String getMailetInfo() {
    return "MyMailet";
  }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T19:42:44.547

您使用了匹配器“All”，即

`<mailet match="All">`

这告诉 James 为所有电子邮件运行此 mailet。因此，当您向 发送第一封电子邮件时`support@[mydomain].com`，mailet 会触发并向 发送电子邮件`me@[mydomain].com`。进入的电子邮件会`me@[mydomain].com`导致 mailet 再次触发并向 发送另一封电子邮件`me@[mydomain].com`，这会导致 mailet 再次触发，等等......

尝试改用“RecipientIs”匹配器，即

`<mailet match="RecipientIs=support@[mydomain].com">`

只有当电子邮件到达 support@[mydomain].com 时，这才会触发 mailet。

请参阅[带有示例的 James matchers 列表](http://james.apache.org/server/2.3.0/provided_matchers.html)。

# java - hazelcast队列上的java执行程序服务

> ID：15032199
> 
> 赞同：1
> 
> 时间：2013-02-22T19:53:48.200
> 
> 标签：java, hazelcast

我有一个 hazelcast 队列（在服务器实例之间共享），其中有 1000 条记录。记录是某种工作（如发送电子邮件、短信等）。我需要通过从队列中挑选它们来处理这些记录。为了让它更快，我正在考虑使用执行器服务，以便记录由多个线程异步处理。

此应用程序将部署在多台服务器上，因此我对多台服务器队列中记录的处理顺序感到有些困惑。我应该如何配置我的执行程序，以便它从队列中获取记录并处理它们。我是否需要将我的执行程序设置为每秒被调用一次，以便它不断从处理中获取记录。

我不确定我是否能够正确解释问题，但只是尝试在共享队列（跨服务器实例）上使用执行程序服务。

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:37:23.090

您可能需要考虑使用 hazelcast 执行器服务。我尝试将 hazelcast 队列用于本地线程池，我的经验是它不能正确分配任务。

[http://www.hazelcast.com/docs/2.5/manual/multi_html/ch09.html](http://www.hazelcast.com/docs/2.5/manual/multi_html/ch09.html)

它会自动在集群中分配作业执行。

假设job实现了Callable，可以执行以下操作

```
Future<T> future =  hazelcastInstance.getExecutorService([optional name]).submit(job);
//if you want the return value of the job, you can do this:
T value = future.get(); //This blocks until the job is done 
```

您可以使用不同的名称配置多个分布式线程池。

# xpages - 如何更改 XPages 源代码编辑器中的字体？

> ID：15032200
> 
> 赞同：0
> 
> 时间：2013-02-22T19:53:54.220
> 
> 标签：xpages

如何更改 XPages 源代码编辑器的字体类型、颜色和大小？

突出显示标签等呢？

谢谢，

霍华德

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T20:03:22.133

对于字体大小... Preferences->General->Appearance->Colors and Fonts->Basics->Text Font

对于语法着色：Preferences->XML->XML Files->Editor->Syntax Coloring

# html - 超出其父级的 div

> ID：15032209
> 
> 赞同：-1
> 
> 时间：2013-02-22T19:54:36.320
> 
> 标签：html, css, css-float

我有一个 HTML 布局。在内容 div ( `#contenido-post`) 内有同一个类 ( `.division-categorias`) 的各种 div。问题是最后一个`.division-categorias`溢出其父级并与侧边栏（`#columna-izquierda`）重叠。

这是[示例](http://nicolasgolub.com/html/categorias.html)。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:09:18.323

你真的看过浏览器中的 HTML 吗？看起来`.division-categorias`不在同一个div内，而是连续移出一层。我最好的猜测是，您正在服务器上以某种循环方式创建这些 div，并在`</div>`某处添加了额外的关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:17:34.357

您似乎在**“division-categorias”**类的**最后 2 个类别**中添加了一个结束 div 标签 看看带有图像标签的行

 **```
 <img src="imagenes/categorias-thumbnail.png" width="204" height="150" /></div> 
```

您确定要关闭那里的 div 标签吗？**

# r - .csv 的内容可以用作 R 中轴标记的向量吗？

> ID：15032210
> 
> 赞同：0
> 
> 时间：2013-02-22T19:54:38.143
> 
> 标签：r, vector, label, axis

假设我正在尝试通过以下方式标记 x 轴：

```
axis(1, at=1:5, lab=c("Mon", "Tue", "Wed", "Thu", "Fri")) 
```

除了我想使用我存储到变量“标签”的值

```
labels <- read.csv("labelFile.csv", header=T) 
```

当我在分配后输入“标签”时，R成功地返回枚举内容：

```
 labels
      AA
1     AB
2    AHA
3   APir
4      B
5     Ca
6  CA1or
7  CA1py
8  CA1ra
9  CA2py
10 CA3py
11   CA4
12    CE
13  cOF2
14  cOF3
15  cOF5
16  cOF6
17  DGgr
18  DGpf
19  DGsg
20 dlPF2
21 dlPF3
22 dlPF4
23 dlPF5
24 dlPF6
25   GPe
26   GPi
27    ic
28  IsCj
29     L
30    Me
31  mOF2
32  mOF3
33  mOF4
34  mOF5
35  mOF6
36   NAC
37    PL
38    Pu
39  rCG2
40  rCG3
41  rCG5
42  rCG6
43  rPAC
44     S
45    Tu
46  V1-1
47  V1-2
48  V1-3
49 V1-4A
50 V1-4B
51 V14Ca
52 V14Cb
53  V1-5
54  V1-6
55  V1wm
56 V2_L5
57  V2-2
58  V2-3
59  V2-4
60  V2-6 
```

当我尝试此代码时，会发生以下情况：

```
 axis(1, at=3*0:59, lab=c(labels))
Error in axis(1, at = 3 * 0:59, lab = c(labels)) : 
  'at' and 'labels' lengths differ, 60 != 1 
```

所以，我想要做的是让“labels.csv”文件的内容在 x 轴上的刻度线 1、4、7、10...59 处列出（每个增加三个的倍数时间）。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T19:58:19.590

我认为标签是一个`data.frame`，所以如果你写`c(labels)`你会得到一个包含一个的列表`data.frame`。这解释了长度错误。尝试这个：

```
axis(1, at=3*0:59, lab=as.vector(labels$AA)) 
```

# javascript - 如何在特定时间重新加载页面并且每天只加载一次

> ID：15032211
> 
> 赞同：6
> 
> 时间：2013-02-22T19:54:38.173
> 
> 标签：javascript

我有一个每分钟运行一次的 javascript 函数。

```
setInterval(function(){

  //first, check time, if it is 9 AM, reload the page
   var now = new Date();
   if (now.getHours() == 9 {
      window.refresh();
   }

  //do other stuff

},60000); 
```

现在的问题是，我希望每天只进行一次重新加载。由于该功能每分钟运行一次，因此下次启动时，如果在上午 9 点到 10 点之间，它将再次重新加载页面。如何使重新加载只发生一次？

我可以通过创建另一个每小时触发一次的间隔函数并检查是否应该重新加载来做到这一点。但是由于我已经拥有每分钟运行的上述功能，我可以从那里开始吗？

如果我最终创建了另一个每小时检查一次的函数。如果这两个函数同时启动会发生什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:00:47.213

我会存储最后一次刷新的日期，计算差异，它不到 6 小时（为了安全起见）你不需要刷新。

```
var lastRefresh = new Date(); // If the user just loaded the page you don't want to refresh either

setInterval(function(){

  //first, check time, if it is 9 AM, reload the page
   var now = new Date();
   if (now.getHours() == 9 && new Date() - lastRefresh > 1000 * 60 * 60 * 6) { // If it is between 9 and ten AND the last refresh was longer ago than 6 hours refresh the page.
      location.reload();
   }

  //do other stuff

},60000); 
```

我希望这就是你的意思。请注意，这是未经测试的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:01:08.647

无需使用更复杂的解决方案以更好的方式完成此操作，您可以使用 getDay() 并将其保存在 cookie 中，以便您可以检查最后一次调用此方法是否是同一天，仅此方式您将在上午 9 点之后的第二天和另一天。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-02-22T20:29:19.973

它在 C# 中。该算法将是：

1.  在 C# 中创建一个计时器，它在第 N 小时运行（例如，上午 10:00、下午 14:00 等）
2.  您检查时间是否为 X 小时（在本例中为上午 9:00）。
3.  如果是，则刷新页面。

# javascript - 如何在jQuery中多个事件句柄和传递数据

> ID：15032214
> 
> 赞同：0
> 
> 时间：2013-02-22T19:54:50.280
> 
> 标签：javascript, jquery

我想将多个事件附加到单个元素。但我想为每个事件附加不同的数据。jQuery中附加多个事件的方式如下：

```
 $("div.test").on({
     click: this.clickEventCalled,
     mouseenter: this.mouseEnterEventCalled
     mouseleave: this.mouseLeaveEventCalled
 }); 
```

但我希望能够做这样的事情：

```
 $("div.test").on("click", { name: "Karl" }, clickEventCalled); 
```

我想知道是否有比这样做更优雅的方法：

```
 var self = this;
 $("div.test").on({
     click: function(event){
         self.clickEventCalled(event,{name:"Karl"})
     },
     mouseenter: function(event){
         self.mouseEnterEventCalled(event,{name:"Ben"})
     },
     mouseleave: function(event){
         self.mouseLeaveEventCalled(event,{name:"Ken"})
     }
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:02:37.313

你可以这样做：

```
$("div.test").on("click", { name: "Karl" }, clickEventCalled)
             .on("mouseenter", { name: "Ben" }, mouseEnterEventCalled)
             .on("mouseleave", { name: "Ken" }, mouseLeaveEventCalled);
}); 
```

# firemonkey - FireMonkey XE3 中缺少使用子句

> ID：15032218
> 
> 赞同：-1
> 
> 时间：2013-02-22T19:55:15.487
> 
> 标签：firemonkey, uses

我的机器上安装了 XE3，并且正在使用 FireMonkey 2 做应用程序，但是在很多情况下，我会遇到缺少标识符的问题。它一直告诉我标识符是未知的，对于我放到表单上的大多数组件。有谁知道为什么它不自动添加到使用子句中，或者至少，我在哪里可以找到包含对应组件的包列表？例如，我什至不能使用 TText 组件，因为我找不到任何关于它所在位置的信息。

Ps：还有一件事，VCL 和 Firemonkey 形式之间是否有任何不同的操作列表？就像，我似乎无法在 Firemonkey 中使用 GetCurrentProcess，虽然它在 VCL 中运行良好，但该操作不包含在 Firemonkey-VCL 表单中不同的基本信息中......

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T12:40:43.207

如果您选择它抱怨的项目的文本并单击 F1 寻求帮助，帮助页面将告诉您父对象，然后您可以将其添加到使用子句中。

# java - Java 白盒测试

> ID：15032219
> 
> 赞同：3
> 
> 时间：2013-02-22T19:55:19.617
> 
> 标签：java, testing, white-box

如何在 Java 应用程序上进行白盒测试？这是否意味着我必须逐课测试？

根据我的研究，我知道：

> 白盒测试是一种软件测试方法，其中被测试项目的内部结构/设计/实现对测试人员来说是已知的。测试人员通过代码选择输入来练习路径并确定适当的输出。编程知识和实施知识是必不可少的。白盒测试是在用户界面之外进行测试，并深入到系统的本质。

白盒测试应该是什么样的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-02-14T02:35:04.337

**简介：** *现代白盒测试使用复杂的自动化工具来帮助开发人员设计好的测试并以有意义的方式测量代码覆盖率。广泛使用的（如果是基本的）示例包括[Cobertura](http://cobertura.github.io/cobertura/)、[EMMA](http://emma.sourceforge.net/)、[EclEmma 和 JaCoCo](http://www.eclemma.org/index.html)。*

> 如何在 Java 应用程序上进行白盒测试？

传统上，黑盒测试意味着另一个团队（不是开发人员）负责测试软件，并且他们在这样做时不会查看源代码。

即使转向单元测试，设计测试的常用方法是使用或多或少的黑盒*输入域特征，*即只测试边界条件和一些任意“正常”输入值。

然而，很明显，这种方法可能无法行使该功能的某些分支。一个优秀的开发人员会**打开代码**并说“嘿，我需要添加一个输入来运行那个分支。”

现代白盒测试通过自动化流程将这个想法更进一步，产生这样的输出以显示方法的哪些部分尚未被 JUnit（来自 NetBeans 插件[TikiOne](http://plugins.netbeans.org/plugin/48570/?show=true)）执行：

![NetBeans 插件 TikiOne 使用 JaCoCo 库来显示我的测试未能覆盖的分支。](../Images/138901883f93ec92a9058678ee2f9f6f.png)

> 白盒测试应该是什么样的？

摘要中提到的代码覆盖工具试图自动化确保您运行每一行或每一分支代码的过程。当集成到像[Jenkins](http://en.wikipedia.org/wiki/Jenkins_%28software%29)这样的持续集成环境中时，您的团队不仅可以持续关注您的测试是否通过，还可以关注您是否达到了覆盖目标（来自 NetBeans 插件[TikiOne](http://plugins.netbeans.org/plugin/48570/?show=true)）：

![NetBeans 插件 TikiOne 总结了我对几个类的测试覆盖率低劣。](../Images/73bb6c0e06e6f6389456ef9ac1cf0230.png)

在软件工程研究中，**白盒测试比计算行数要复杂得多**。已经开发了各种各样的工具和数学技术来帮助您确保为测试提供的输入正确地涵盖了代码的所有可能行为。

例如，使用复杂布尔谓词的飞机自动驾驶系统的警告系统可能会使用植根于形式逻辑的白盒测试标准，以确保我们**涵盖**通过控制器的所有逻辑可能路径。

分析线和分支覆盖率是最常见的标准，是使用**软件图形表示的**一种特殊情况，例如[控制流图](http://en.wikipedia.org/wiki/Control_flow_graph)或[数据流图](http://en.wikipedia.org/wiki/Data_flow_diagram)。一个好的工具将读取您的代码以生成图形，然后您可以从各种[图形覆盖标准](http://swtv.kaist.ac.kr/courses/cs453-fall09/graph_coverage.pdf)中进行选择，以自动推荐一组通过方法控制逻辑（分支）的路径，您需要执行这些路径以实现您的测试目标。

线和分支是最简单和最常用的（控制）图覆盖标准（对应于覆盖节点和边）——在某些工具中可以使用更彻底（且难以满足）的指标，如边对和主要路径。这些问题不仅询问“我是否至少在每个分支上进行了每个选择一次”，而是“我是否通过我能够到达那里的所有方式通过了每个分支。”

程序员仍然需要找到一组输入来练习这些路径，并设计足够小和足够简单的代码，以使所需的测试数量不会以更全面的标准获得良好的覆盖率不会呈指数级增长。但是现在你有了正式的、定量的方法来 A) 告诉你需要测试什么，并且 B) 告诉你你的项目测试得有多好。

> 这是否意味着我必须逐课测试？

白盒测试是一种*设计*测试的方法。它可以应用于所有测试级别，包括单元测试、集成测试和系统测试。

* * *

有关测试覆盖率标准的更多信息，请参阅

*   贝泽，鲍里斯。*软件测试技术。*梦想科技出版社，2003 年。

或查看最新的

*   阿曼、保罗和杰夫·奥夫特。*软件测试简介。*剑桥大学出版社，2008 年。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T19:58:46.563

逐类测试通常称为单元测试。有几种流行的工具可以帮助您。从 JUnit 或 TestNG 开始。为提供某些功能的每个类或类（模块）组实施测试。

然后你可以上去，即为更大的模块和整个应用程序编写测试。此类测试通常称为集成测试。

# javascript - 如何在点击事件中获取上一个 div？

> ID：15032220
> 
> 赞同：0
> 
> 时间：2013-02-22T19:55:20.350
> 
> 标签：javascript, jquery, html

我正在使用两个锚标签：“previous-slide-collections”和“next-slide-collections”。下一个锚点起作用，而前一个锚点不起作用。

**JavaScript：**

```
$("#next-slide-collections").click((function(){
        //alert('hi');
    var counter = 0;
    return function()
    {
       $("#div" + counter).hide("fast");
       counter = (counter % 3) + 1;
       $("#div" + counter).show("fast");
    }
 })());

$("#previous-slide-collections").click((function(){
    //alert('hi');
    var counter = 0;
    return function()
    {
       $("#div" + counter).hide("fast");
       counter = (counter - 1);
       $("#div" + counter).show("fast");
    }
})()); 
```

**HTML：**

```
<div id="div1"></div>
<div id="div2"></div>
<div id="div3"></div>
<a id="previous-slide-collections"></a>
<a id="next-slide-collections"></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:08:06.970

您的下一个和上一个按钮都使用自己的计数器变量。但是，您的下一个按钮应该可以工作，因为您上一个按钮的计数器从 0 开始，单击它将转到 -1，这将选择 0 个元素。要确认，请将您以前的计数器更改为从 3 开始，您会看到它做了一些事情。

让他们共享相同的变量，它应该工作（大部分）。

```
var counter = 0;
$("#next-slide-collections").click(function()
    {
       $("#div" + counter).hide("fast");
       counter = (counter % 3) + 1;
       $("#div" + counter).show("fast");
    }
);

$("#previous-slide-collections").click(function()
    {
       $("#div" + counter).hide("fast");
       counter = (counter - 1);
       $("#div" + counter).show("fast");
    }
); 
```

您仍然必须考虑在第一个 div 上单击 prevous 和在最后一个 div 上单击 next。

# c++ - DEV C++ 编译，但 Visual Studio 没有

> ID：15032222
> 
> 赞同：0
> 
> 时间：2013-02-22T19:55:30.467
> 
> 标签：c++, visual-studio-2010, dev-c++

这段代码有什么问题？为什么 1 编译器说没问题并运行它，但来自 Microsoft 的其他编译器大喊大量错误。我什至找不到事情是错误的，因为有十亿条错误。

```
 #include <iostream>
#include <cstdlib>
#include <ctime>
#include <cstring>
using namespace std;
class Person
{
private:
    static const int LIMIT = 256;
    string lname;
    char fname[LIMIT];
public:
    Person() { lname = "";fname[0] = '\0'; }
    Person(const string & ln , const char* fn = "HejTy") { lname=ln; strncpy(fname,fn,LIMIT);}
    void Show() const {  cout << "nieformalnie: " << fname << " " << lname << endl; }
    void FormalShow() const {  cout << "formalnie: " << lname << " " << fname << endl; }
};
int main(){
    Person one;
    Person two("StaszeK");
    Person three("JACEK", "Placek");
    one.Show();
    cout << endl;
    one.FormalShow();
    two.Show();
    cout << endl;
    two.FormalShow();
    cout << endl;
    three.Show();
    cout << endl;
    three.FormalShow();
        cout << endl; 
    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:01:30.207

您缺少标题`<string>`。包括它。

```
#include <string> 
```

# asp.net-mvc - MVC 3 应用程序将视图转换为 dll

> ID：15032224
> 
> 赞同：0
> 
> 时间：2013-02-22T19:55:34.930
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, razorgenerator

我正在 mvc3 razor 中开发一个应用程序，它将部署在多个共享主机帐户中。我想将应用程序编译成dll，就像在asp.net aspx文件中一样，上面写着“这是预编译工具生成的标记文件，不应删除！” 剃刀视图如何实现这一点。

# iis - 从客户端请求、服务器端获取 Active Directory 用户？

> ID：15032226
> 
> 赞同：0
> 
> 时间：2013-02-22T19:55:41.463
> 
> 标签：iis, active-directory, httpmodule

我有一个在 IIS 7.5 上运行的自定义 HTTP 模块，请求将来自同一 Active Directory 环境中的不同机器。**我是否可以**在运行服务器端的 HTTP 模块中从请求（或查找，如果我知道 LDAP 路径？）中获取当前用户（他们的 AD 名称？）？

我不是 AD 专家，但我查看`HTTPApplication`了模块中实例（见下文）的不同属性，但没有看到任何明显的东西。

```
Private Sub AuthenticateRequest(sender As Object, e As EventArgs)

        Dim oHttpApplication As HttpApplication = CType(sender, HttpApplication)
        '...
        ' Get AD Info from oHttpApplication.Request?
        '...
End Sub 
```

有谁知道这是否可能或知道实现此目的的方法？

**更新：**

我在下面添加了我的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T16:03:54.893

我的解决方案 - 在 VB.NET 中：

```
Dim username As String = Thread.CurrentPrincipal.Identity.Name 
```

**注意：**我的链接中问题的答案继续使用 a`PrincipalContext`和`UserPrincipal`对象，但对于我的场景，我需要的只是用户名。我还想指出，在测试该解决方案时，这一行：

```
pc = new PrincipalContext(ContextType.Domain, "active.directory.domain.com") 
```

对我来说没有域也可以正常工作：

```
pc = new PrincipalContext(ContextType.Domain) 
```

因此，希望这对将来的某人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T01:25:48.503

**修改 IIS 设置：**

在 IIS 中**禁用**匿名身份验证并**启用**Windows 身份验证。

**修改 Web 应用程序配置文件：**

启用模拟

```
<configuration>
  <system.web>
    <identity impersonate="true"/>
  </system.web>
</configuration> 
```

**C#代码：**

```
using System.Security.Principal

var user = WindowsIdentity.GetCurrent().Name; 
```

# eclipse - Eclipse 中的“无法加载 javah”错误

> ID：15032230
> 
> 赞同：3
> 
> 时间：2013-02-22T19:56:01.743
> 
> 标签：eclipse, ant, javah

我正在尝试在 Eclipse 的 ant 构建文件中使用 javah 任务，但我不断收到以下错误：

构建失败

C:\sandbox\build-jni.xml:7: 无法加载 javah

这是我的 build-jni.xml 文件：

```
<project>
<property name="bin" location="bin" />

<target name="generate-jni">
    <javah destdir="${bin}" classpath="${bin}">

        <class name="org.example.ExecJNI" />
    </javah>
</target> 
```

关于我为什么会收到该错误的任何想法？我的项目指向 JDK 而不是 JRE

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T16:47:17.950

原来我的 Ant Home Entries in Window --> Preferences 中没有 C:\Program Files\Java\jdk1.7.0_15\tools.jar。这似乎解决了问题。

# powershell - Powershell：粘贴最后一个命令

> ID：15032237
> 
> 赞同：2
> 
> 时间：2013-02-22T19:56:23.507
> 
> 标签：powershell, powershell-3.0

有没有办法让 powershell 将我的最后一个命令粘贴到我当前的命令行中？

例如，假设我输入：

```
get-service 
```

并决定我想要更多关于它的信息，所以我会输入：

```
get-help get-service 
```

相反，似乎应该有一个捷径，所以我可以这样：

```
get-help %x 
```

**并获得与此示例中的快捷方式%x**相同的结果，将替换为前面的命令**get-service**。甚至键盘上的一个按钮也可以获得相同的结果。当然这是一个人为的例子，但它似乎在更复杂的场景中非常有用。有类似的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T20:07:45.597

自动变量`$$`保存最新的命令。

所以你可以做

```
get-service
get-help $$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:10:46.723

在 PowerShell 中，您有一个用于最后一个命令 "称为" 的变量`$$`。前任：

```
PS > $$
get-help

PS > Get-Service

Status  Name                               DisplayName                                           
------  ----                               -----------                                           
Running AdobeARMservice                    Adobe Acrobat Update Service                          

PS > get-help $$ -full

NAME
    Get-Service

PS > $$
-full

PS > Get-Help Get-Service

NAME
    Get-Service

PS > $$
Get-Service 
```

但是，正如您在上面的示例中看到的那样，它存储了上一个命令的最后一部分，这有时可能会适得其反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:19:18.953

向上箭头导航回您的历史记录，您可以编辑以前输入的命令以将它们作为新命令执行。

```
Get-Service 
```

`Up-arrow`
`Home`

```
Help (space) 
```

# silverlight - Silverlight 忽略 [必需] 数据注释

> ID：15032238
> 
> 赞同：0
> 
> 时间：2013-02-22T19:56:31.463
> 
> 标签：silverlight, c#-4.0, data-annotations

仅供参考：在 VS 2012 Ultimate 中使用 .NET 4.5 和 Silverlight 5。

我的 [Required] 和 Length 数据注释不想冒泡到我的 Silverlight 表单中并进行验证。我有一个通过 DDS 公开的相当直接的课程。例子：

```
public class FooCard : INotifyPropertyChanged
{
    [Key]
    [Required]
    [IntegerValidator(MinValue = 0, MaxValue = 32768)]
    public short FooID { get; set; }

    [Required]
    [StringLength(15)]
    public string FooName { get; set; } 
```

我的 XMAL 看起来像这样：

```
<TextBlock Height="25" Text="FooID:" Grid.Row="1" Grid.Column="0" HorizontalAlignment="Right"
                                Margin="0,0,2,0">
</TextBlock>
<TextBox Name="TextBox_FooID" Text="{Binding Path=FooID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Row="1" Grid.Column="1" TextChanged="TextBox_TextChanged">
</TextBox>
<TextBlock Height="25" Text="Foo Name:" Grid.Row="2" Grid.Column="0" HorizontalAlignment="Right"
                                    Margin="0,0,2,0">
</TextBlock>
<TextBox Name="TextBox_FooName" Text="{Binding Path=FooName, Mode=TwoWay, ValidatesOnExceptions=True, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged}" Grid.Row="2" Grid.Column="1"
                             TextChanged="TextBox_TextChanged"
                             LostFocus="TextBox_FooName_LostFocus"> 
```

DDS 设置为 auto load false 并且查询参数绑定到 FooID 文本框。最初，当有人加载表单时，我将数据上下文设置为我的 DDS，并且在这种情况下我没有在 DDS 上执行加载操作，因为用户选择他们正在创建“新 Foo”记录。因此，此时 DataView.CurrentItem 为空。这就是正在发生的事情：

如果用户开始在带有 FooID 等注释的绑定字段中键入内容，它会立即仅在该字段上运行任何注释验证器。出现一个红色框，表示最小长度。但是，在我的示例中，没有任何东西可以验证其他绑定属性，例如 FooName 。我实际上可以使用空的 fooName 提交更改，并引发验证错误异常。当然，我将保存更改按钮绑定到我的 DDS 的 HasValidationErrors 属性，所以这不会发生在用户身上。但是，用户对为什么禁用保存更改按钮感到困惑，并且没有红色框要求他们在 fooName 中输入内容。我当然可以创建一个标签或将 * 放在框旁边，表明它是必需的。

但是，我可以通过加载 FooName = " "; 来解决这个问题。FooName = string.empty; 在 OnNavigatedTo 的代码隐藏中。一旦它加载空间然后再次设置为空字符串，它就会显示为一个红色框。这几乎就像 Silverlight 要求首先初始化每个属性或其他东西。这似乎是一个彻底的黑客攻击，我讨厌要求我表单上的 50 多个文本框都设置为一些虚假的初始值并再次返回。IE。这不是一个解决方案，而是一个故障排除步骤。

这里发生了什么？我仍然是一个相当新的开发人员，他更像是一名终身 DBA（现在只有一年的时间来开发 SL 解决方案），我刚刚开始在我的课程中使用验证器，而不是在代码隐藏和按钮点击事件等中使用穷人的验证。但是，在 google / bing 中找不到很多关于发生此类问题的信息。任何见解都值得赞赏。我确定我可能会以错误的方式进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T12:29:01.343

问题是 DataAnnotations 的验证仅在 Property Setter 中触发，然后绑定引擎仅在通过绑定调用 Setter 时才会选择它。如果要显示所有属性的验证错误，则必须实现[INotifyDataErrorInfo](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifydataerrorinfo%28v=vs.95%29.aspx)。

实现此接口后，您可以随时从代码中设置验证错误。如果有帮助，您还可以使用 Validator 类来获取每个属性的验证错误，例如：

```
Validator.ValidateProperty(valueToValidate, 
    new ValidationContext(this, null, null) { MemberName = "MyProperty" } ); 
```

# zsh - 0##*/ 在 ZSH 中有什么作用？

> ID：15032239
> 
> 赞同：0
> 
> 时间：2013-02-22T19:56:34.023
> 
> 标签：zsh

我知道这是一种模式，它会导致一些搜索发生：

```
zsh: no matches found: 0##*/ 
```

但是，我不知道它在搜索什么，也不知道实际上是什么命令行工具在处理请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:22:25.007

该错误来自 zsh 本身进行文件名扩展（AKA globbing）。*zshexpn*手册页的**文件名生成**部分对此进行了介绍。

 *如果您`EXTENDED_GLOB`设置了选项（在*zshoptions*手册页中介绍），则`##`令牌的行为类似于`+`扩展正则表达式中的 will，匹配前面项目的 1 次或多次出现（`0`在您的示例中）。以下`*`将匹配任何字符序列（不包括任何字符）。最后`/`的将限制匹配到目录。因此，整个模式将匹配当前目录中名称以 . 开头的任何目录`0`。尽管实际上没有任何理由使用该`##`部分；它不会影响结果，并使模式更加混乱且不可移植到其他 shell。

如果未设置该选项，则`##`字符将按字面意思表示。`*`和字符将`/`被视为与我在前一段中描述的相同。整个模式将匹配当前目录中名称以 . 开头的任何目录`0##`。*

# javascript - 如何修复我的脚本错误：“对象不支持属性或方法‘模态’”

> ID：15032240
> 
> 赞同：0
> 
> 时间：2013-02-22T19:56:34.287
> 
> 标签：javascript

当我单击“电子邮件公司”链接时，我的网站上出现以下错误（示例如下：[http ://www.expeditionersafaris.com/place/5-day-best-of-both-worlds- kruger-and-private-reserve-tour-wildlife-encounters/](http://www.expeditionersafaris.com/place/5-day-best-of-both-worlds-kruger-and-private-reserve-tour-wildlife-encounters/)）。

错误是：

SCRIPT438：对象不支持属性或方法“模态”post.custom.js，第 56 行字符 3

脚本是：

```
jQuery(document).ready(function () {
jQuery('a.b_sendtofriend').click(function (e) {
    e.preventDefault();
    jQuery('#basic-modal-content').modal({persist:true});
});

jQuery('a.b_claim_listing').click(function (e) {
    e.preventDefault();
    jQuery('#basic-modal-content4').modal({persist:true});
});

    jQuery('a.b_send_inquiry' ).click(function (e) {
    e.preventDefault();
    jQuery('#basic-modal-content2').modal({persist:true});
});

    jQuery('p.links a.a_image_sort').click(function (e) {
    e.preventDefault();
    jQuery('#basic-modal-content3').modal({persist:true});
}); 
```

错误指向 jQuery('#basic-modal-content2').modal({persist:true}); 部分。

# vb6 - 什么是从另一个表单调用表单的更好方法

> ID：15032247
> 
> 赞同：3
> 
> 时间：2013-02-22T19:56:51.790
> 
> 标签：vb6

假设我有 2 个名为 Form1 和 Form2 的表单。我想从 Form1 调用 Form2 中的函数 abc()。哪个更好，为什么？

方法一：

```
 'In Form1
  Form2.abc() 
```

方法二：

```
 'In Form1
  Dim oFrm As New Form2
  oFrm.abc() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T09:49:42.407

在 VB6 中，当程序运行时，只要您通过表单名称引用表单，VB6 就会创建该表单的实例。该实例也被添加到 Forms 集合中。

您可以发现使用此代码或其合适的变体实例化了哪些表单：

```
Dim frmCurrent As Form
Dim output As String
For Each frmCurrent In Forms
    output = output & frmCurrent.Name & vbCrLf
Next
MsgBox output 
```

因此，当您调用 Form2.abc() 时，您是在对新创建的 Form2 表单实例调用 abc 过程（如果有助于理解，您可以将单词 class 替换为 form）。

当需要退出程序时，您可能会遇到一种错误，即程序在内存中徘徊，但在屏幕上不可见，因为您已关闭所有可见表单，但未关闭通过调用实例化的表单，例如`Form2.abc`. 这导致流行的“关闭所有表单”代码被添加到许多 VB6 程序的退出过程中：

```
Private Sub cmdExit_Click()
   Dim current As Form
   Dim output As String
   For Each current In Forms
      Unload current
   Next
End Sub 
```

当您标注一个变量并为其分配一个新的 Form2 实例时，您正在根据该变量创建一个具有范围的新表单。该实例**未**添加到 Forms 集合中：

```
Dim frmNew As New frmTest
frmNew.abc

Dim frmCurrent As Form
Dim output As String
For Each frmCurrent In Forms
    output = output & frmCurrent.Name & vbCrLf
Next
MsgBox output 'Does not include frmNew aka frmTest 
```

因此，您的第二种方法通常更好，因为它不会在 Forms 集合中创建 Form2 的实例或重用可能会给您带来意外结果的现有实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:38:13.947

如果您只有一个 Form2 实例，那么只需使用方法 1。

如果您需要多个实例或预计需要多个实例，请使用方法 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T12:41:56.383

因为您在问这个问题，所以我假设您已经加载了 form2，所以我会直接调用该函数（选项 1）

它还取决于您的功能的性质..它会干扰form2吗？它使用来自form2的数据吗？....如果是这样我会直接调用该函数

如果它是一个全局函数，我不会把它放在 form2 中，而是放在一个模块中

如果你想加载一个新的 form2 实例，并让用户与之交互，那么我会选择选项 2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-25T09:04:17.110

如果您知道 Form2 已经加载，则第一种方法很好，并且可以在任何上下文中全局调用 FunctionName()。如果您只需要在 Form2 中执行尚未加载的特定功能，则第二种方法最好。但是，您需要注意内存泄漏：

* * *

`Form2`从using调用函数`Form2.FunctionName()`将执行以下操作：

1-检查是否`Form2`已加载？如果没有，它将首先加载。2-`FunctionName()`被执行 3-`Form2`将保留在内存中，直到它被专门卸载。

您必须通过手动卸载 Form2 来清理

```
Unload Form2 
```

否则，当您*认为* 您已经关闭`Form1`并结束程序时，`Form2`已经加载并且您的可执行文件的进程已经存在于TaskManager中。

* * *

调用`FunctionName()`使用

```
Dim oFrm as New Form2
oFrm.FunctionName() 
```

将确保加载 Form2 的实例（在代码的本地上下文中）然后执行该函数，但是当您完成它时仍然需要卸载它：

```
Unload oFrm 
```

否则你的程序会像第一种情况一样泄漏内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-03T22:16:09.913

将 private 更改`Sub Form_Load()`为 public `Sub Form_Load()`，然后可以从第二种形式调用它

例如，您想从 form2 调用 form1`form_load()`

应该使用：调用`form1.form_load()`

# c# - Windows 窗体 - MDI 窗体的验证

> ID：15032258
> 
> 赞同：0
> 
> 时间：2013-02-22T19:57:51.993
> 
> 标签：c#, .net, winforms, visual-studio-2010, validation

我正在开发一个桌面应用程序，该应用程序主要是 MDI 表单及其管理。有很多可编辑的表格需要针对不同的条件进行验证（最小/最大长度，只有数字等等..）。我正在使用`.NET4.0`,`Visual Studio 2010`和`C#`. 有没有比为每个表单编写自定义验证方法更有效的方法来验证这些表单？

# spring - spring mvc 通用控制器和服务

> ID：15032264
> 
> 赞同：1
> 
> 时间：2013-02-22T19:58:11.190
> 
> 标签：spring, spring-mvc, restful-architecture

我正在使用 Spring MVC 开发一个小型 RESTful 应用程序，我想在通用控制器、服务和实体中实现通用 CRUD。我有一个实体`Person`和 2 个从该实体继承字段的实体（例如`Person1`和`Person2`）。

最好的方法是什么？

我看到了一个示例，其中所有控制器都是最终的。拥有通用控制器是一种不好的做法吗？服务呢？如何制作通用实体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T10:49:11.603

我已经开发了类似的东西，使通用控制器抽象为抽象方法

```
protected abstract RestService<T, ID> getService(); 
```

和其他控制器必须扩展这个控制器并实现这个方法我也用抽象方法对服务做了同样的事情

```
protected abstract PagingAndSortingRepository<T, ID> getRepo(); 
```

要让存储库在抽象服务中使用它，您必须注意这些抽象类没有@Controller 或@Service，同样在 Controller 的子类中，您必须将根路径指定为：

```
@Controller
@RequestMapping("/customer")
public class CustomerRestController extends RestController<Customer, Long> { 
```

在抽象控制器中，您必须使用相对路径，例如：

```
@RequestMapping(value = "/{id}", method = RequestMethod.PUT)
@ResponseBody
public ResponseEntity<String> update(@PathVariable ID id,
    @RequestBody T t) { 
```

如果您对此解决方案感兴趣，我可以与您分享源代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:29:32.277

不，我认为让控制器不是最终的并不是坏习惯。事实上，我从未编写过最终的 Spring MVC 控制器，尽管我可以看到这样做的吸引力。

至于“通用”控制器，没有什么能阻止您创建基类控制器。Controller 只是一个 POJO，所以它非常简单。

更好的是，如果您想获得最大的收益，为什么不使用 Spring Roo？它下面的所有 Spring MVC 都会生成您的样板代码，当您完成使用它来完成创建站点的所有繁重工作时，您可以简单地将所有 roo 生成的代码推入您自己的代码中，然后将其扔到一边你不再需要它了。

# ruby-on-rails - Rails 3 使用 premailer 发送多部分电子邮件，并且可以选择是否使用模板

> ID：15032269
> 
> 赞同：0
> 
> 时间：2013-02-22T19:58:32.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, email, actionmailer

我可以选择创建一封电子邮件，其中的内容可以是 HTML 文档的一部分，也可以是整个 HTML 文档。如果只是一部分，Mailer应该使用模板进行渲染。如果它包含该`<html>`元素（表明它是一个完整的 HTML 文档），则在发送时不应使用模板文件。除了发送的电子邮件中的“电子邮件部分”出现故障并在某些情况下重复之外，我几乎已经完成了所有设置和工作。它搞砸了电子邮件的呈现。我认为这与我对方法的调用`mail`以及 Premailer 对`deliver`方法所做的操作有关，但我不确定从这里去哪里。

EBlast.rb

```
def main(m, args={})
    # 'm' is an Email.rb object
    ready_email 'E-Blast', args # Don't worry about this
    assign_private_id_header # or this

    # Read the Template
    @variable_width = (@user.email =~ /@hotmail|@live|@windows/).nil?
    @page_title = m.subject
    m.prep_for_email # squeeze unnecessary whitespace and create 'quick-nav' links based on h1 tags

    # Read in attachments
    m.inline_attachments.each do |name, loc|
    attachments.inline[name] = File.read(loc)
    end
    m.external_attachments.each do |name, loc|
    attachments[name] = File.read(loc)
    end

    mail_object = mail(:to => @user.email, :subject => m.subject) do |format|
    format.text { render :text => 'placeholder' } # This should be replaced by Premailer html > text conversion upon deliver!

    if m.needs_template?
        # Use the main.html.erb template
        @email = m # Needed for helper methods in template view
        format.html 
    else
        # Use the content of the email as the entire HTML source
        format.html { render :text => m.content }
    end
    end
    # Apply Google Analytics tracking parameters to links pointing to this domain
    m.prep_for_sending mail_object
end 
```

电子邮件.rb

```
def prep_for_sending(mail_object)

    unless mail_object.html_part.nil?
    # Replace the content with the generated html
    self.content = mail_object.html_part.body.raw_source
    # Add Google analytics tracker info to links
    apply_url_tracker :source => "Eblast Generator", :medium => :email
    # Replace the html raw_source
    mail_object.html_part.body = content

    end

    # Return mail object so mailer can call deliver
    mail_object

end 
```

更新：经过一些解决方法（为“非模板内容”创建一个空白模板），我发现了另一个问题……我认为这个问题真正触及了正在发生的事情的核心。当有文本、html 和附件（只是内联或内联和外部）时，不会生成多部分/混合和多部分/相关部分。

更新 2：部分成功！显然，我很喜欢奇怪的错误。我必须使用`File.open(loc, 'rb') { |f| f.read }`而不是`File.read(loc)`在阅读附件时使用，因为我正在使用 Windows 作为开发机器。叹息有没有办法在 File.read 中指定“rb”标志？我在任何地方都找不到文档。我现在要尝试让 Premailer 工作，因为我必须禁用它来测试它。

最终更新：看起来 Premailer 正在搞砸多部分布局。有没有一种方法可以使用 Premailer 而不会自行连接到交付？我只需要它来内联 CSS 并生成纯文本部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:25:34.357

确认这是 premailer-rails3 gem [here](https://github.com/fphilipe/premailer-rails3/issues/21)的错误。使用`gem "premailer-rails3", :git => "git://github.com/tdgs/premailer-rails3.git"`并正确发送。有6个小时:)

附录：似乎 Premailer 可能遇到了我在[这个线程](https://stackoverflow.com/a/15057210/191741)中遇到的同样问题。它似乎也复制了 html 部分，并且最终可能会搞砸整个电子邮件解析。所以实际上最终它可能是 ActionMailer - 或者在将内容分配给 Mail 部分的主体时负责的任何类。

# r - 将数据从 3 行重组为 1 行

> ID：15032270
> 
> 赞同：7
> 
> 时间：2013-02-22T19:58:41.977
> 
> 标签：r, csv, reshape2

我需要从包含大部分重复数据的 csv 文件中重新组织数据。我将数据导入到数据框中的 R 中，但遇到以下问题：

```
ID   Language  Author   Keyword
12   eng       Rob      COLOR=Red
12   eng       Rob      SIZE=Large
12   eng       Rob      DD=1
15   eng       John     COLOR=Red
15   eng       John     SIZE=Medium
15   eng       John     DD=2 
```

我需要做的是将其转换为一行，每个关键字在单独的列中

```
ID   Language  Author  COLOR  SIZE      DD
12   eng       Rob     Red    Large     1 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T20:36:45.670

使用这个`reshape2`包很简单：

`tt`定义为加里[的答案](https://stackoverflow.com/a/15032524/892313)

```
library("reshape2")

tt <- cbind(tt, colsplit(tt$Keyword, "=", c("Name", "Value")))
tt_new <- dcast(tt, ID + Language + Author ~ Name, value.var="Value") 
```

这使

```
> tt_new
  ID Language Author COLOR DD   SIZE
1 12      eng    Rob   Red  1  Large
2 15      eng   John   Red  2 Medium 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T20:11:24.890

使用`plyr`ans`strsplit`你可以做这样的事情：

```
library(plyr)
res <- ddply(dat,.(ID,Language,Author),function(x){
        unlist(sapply(strsplit(x$Keyword,'='),'[',2))
})

colnames(res)[4:6] <- c('COLOR','SIZE','DD')

 ID Language Author COLOR   SIZE DD
1 12      eng    Rob   Red  Large  1
2 15      eng   John   Red Medium  2 
```

**编辑：**这是解决@Brian关注的概括：

```
res <- ddply(dat,.(ID,Language,Author), function(x){
             kv <- strsplit(x$Keyword, '=')
             setNames(sapply(kv, `[`, 2),
                      sapply(kv, `[`, 1)) }) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:18:40.203

试试这个`reshape2`：

```
tt <- read.table(header=T,text='ID   Language  Author   Keyword
 12   eng       Rob      COLOR=Red
 12   eng       Rob      SIZE=Large
 12   eng       Rob      DD=1
 15   eng       John     COLOR=Red
 15   eng       John     SIZE=Medium
 15   eng       John     DD=2')

tt$Keyword <- as.character(tt$Keyword)

tt <- transform(tt, key_val = lapply(tt$Keyword,function(x) strsplit(x,'=')[[1]][2]),
 key_var = lapply(tt$Keyword,function(x) strsplit(x,'=')[[1]][1]))

tt_new <- dcast (tt, ID + Language + Author ~ key_var, value.var='key_val') 
```

# javascript - document.cookie 或 window.location 赋值的行为从何而来？

> ID：15032272
> 
> 赞同：0
> 
> 时间：2013-02-22T19:58:45.473
> 
> 标签：javascript

`document.cookie`或者`window.location`是其`=`运算符被覆盖的对象，因此当您尝试更改它们时，会发生与常规分配不同的事情。 `document.cookie`更令人惊讶的是`typeof document.cookie === "string"`。

它是一些非常具体的 javascript 对象的一些内置功能，还是可以用任何类型的对象复制的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:06:03.640

在 JavaScript 中，可以定义对象属性（如`document.cookie`或`window.location`）以在读取或写入属性值时自动调用 getter 或 setter 函数。属性也可以标记为可写或不可写。浏览器使用此功能来实现您所看到的行为。

从[ECMAScript 5](http://es5.github.com/)`Object.defineProperty`开始，您可以使用该函数以这种方式定义自己的属性。可以在[此处](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)找到有关如何使用它的详细信息和示例。例如，您可以使用此功能在将值分配给您的一个对象的属性时调用一些复杂的操作。

# ruby-on-rails-3.2 - 如何修复 UTF-8 中的无效字节序列？

> ID：15032276
> 
> 赞同：0
> 
> 时间：2013-02-22T19:59:01.697
> 
> 标签：ruby-on-rails-3.2

有时，当使用没有路由的输入链接时，我会显示一条很好的消息，例如：

*抱歉，此链接 {@not_found_path} 不是从我们的旧网站迁移过来的，或者您输入错误..*

如何修复 @not_found_path 值以免出现错误：

`invalid byte sequence in UTF-8`在模板中？我安装了 ruby​​ 1.9.3 和 rails 3.2.11

任何的想法？

```
def render_404(exception)
      @not_found_path = exception.message
      respond_to do |format|
        format.html { render template: 'errors/not_found', layout: 'layouts/application', status: 404 }
        format.all { render nothing: true, status: 404 }
      end
    end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T01:45:33.937

我已经在这样的视图中解决了它：

```
The link #{content_tag(:span, @not_found_path.force_encoding("ISO-8859-1").encode("utf-8"), :class => 'text-error')} is not found, We are sorry for that, as we have migrated our website, we could not restore all the links. 
```

我希望这会帮助一些人

# c++ - 在具有内联链接的冲突定义上生成错误

> ID：15032279
> 
> 赞同：7
> 
> 时间：2013-02-22T19:59:19.423
> 
> 标签：c++, linker, inline

我今天遇到了一个奇怪的错误，直到现在我还是设法避免了它。

**文件 1.cpp：**

```
#include <iostream>
inline void print() { std::cout << "Print1\n"; }
void y() { print(); } 
```

**文件 2.cpp：**

```
#include <iostream>
inline void print() { std::cout << "Print2\n"; }
void x() { print(); } 
```

**主.cpp：**

```
int x();
int y();

int main(){
    x();
    y();
} 
```

**输出：**

```
Print1                         (Expected Print2)
Print1 
```

因为`print()`具有内联链接，所以不会产生多重定义错误（用 编译`g++ -Wall file1.cpp file2.cpp main.cpp`）并且重复的符号会被静默折叠。我看到的实际情况是使用内联类方法，而不是显式内联函数，但效果是一样的。

我想知道是否有链接器选项或类似选项可以让我在发生此类错误时发出警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:14:13.467

根据标准**，没有必要/强制**生成错误/警告。这违反了 C++ 的[*单一定义规则*](http://en.wikipedia.org/wiki/One_Definition_Rule)，因为它们具有不同的函数体。

引用自： [*默认情况下的外部内联*](http://www.glenmccl.com/ansi_015.htm)

> “外部内联”的含义是，**如果**对函数的调用不是内联生成的，那么编译器应该**只制作函数定义的一份副本**，以便在所有目标文件之间共享。
> 
> **如果发生上述情况**，根据语言标准，该程序的行为被认为是未定义的，但编译器和链接器都不需要给出诊断消息。实际上，这意味着，**根据实现的工作方式，编译器或链接器可能只是默默地选择**要在任何地方使用的定义之一。

该行为与 GCC 在此处对*[模糊链接](http://gcc.gnu.org/onlinedocs/gcc/Vague-Linkage.html)*的定义一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:16:12.530

这些函数不是内部链接或匿名命名空间，因此它们显然是外部的，具有相同的名称。他们有不同的身体，所以你显然违反了单一定义规则。那时任何关于会发生什么的猜测都没有用，因为您的程序格式不正确。

我猜你编译时没有优化，编译器生成了函数调用而不是实际内联，它选择了一个主体作为要调用的函数（让另一个成为孤立的）。现在大概如果您使用优化进行编译，您的预期输出将被发出，但您的程序仍然不正确。

编辑评论：不幸的是，编译器不需要诊断违反一个定义规则的情况（他们甚至可能无法检测到所有情况）。但是，您可以做一些事情：

*   使源私有函数始终在匿名命名空间中`static`或在匿名命名空间中（出于逻辑分组目的，我更喜欢命名空间，但两者都可以）。
*   特别注意`inline`方法（无论位置如何），因为它们明确告诉编译器所有版本都是相同的（对于非内联方法，您很可能至少会从链接器获得重复符号错误）。这里最安全的方法是避免使用全局命名空间内联函数（或在命名时特别注意）。此外，您需要非常小心 changed `#define`s 不会更改函数体（例如`assert`，在一个使用有`NDEBUG`而另一个没有使用的内联函数中使用）。
*   逻辑上使用类和命名空间来分解代码并帮助防止同一符号的多个定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:13:42.130

我将从我在[这里](http://gcc.gnu.org/ml/gcc-help/2011-11/msg00057.html)找到的类似主题的电子邮件线程中无耻地复制粘贴......

> 这不是 gcc 问题。
> 
> 您没有提到您使用的是哪个操作系统。我假设它是 GNU/Linux。在 GNU/Linux 或任何其他基于 ELF 的系统上，有一个全局变量和函数的全局命名空间。当两个共享库使用相同的全局变量名时，它们指的是同一个变量。这是一个特点。
> 
> 如果您希望发生不同的事情，请查看符号可见性和链接器版本脚本。

似乎您应该能够告诉链接器/编译器符号 X 应该是唯一的，如果不是，则抱怨。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-22T23:55:30.207

要将函数设为 .cpp（或 .c）文件的本地函数，您必须将该函数设为`static`. 当您在两个单独的 .cpp 文件中声明 print 时，它们都编译为`print_v`，第二个符号被编译器删除（忽略）*。

这只是对它如何在我的机器上起作用的假设。我在 MAC OS X Mountain Lion 上尝试了相同的代码，得到了与您相同的结果，但我能够通过添加`static`这两个函数来解决它。

* 如果你在编译中改变文件的顺序，行为就会改变。尝试`g++ file{2,1}.cpp main.cpp`，输出应该是

`print2`

`print2`

此致， 阿卜杜拉赫曼·阿洛泰比

# c++ - 未使用依赖类型的“预期主表达式”错误

> ID：15032285
> 
> 赞同：4
> 
> 时间：2013-02-22T19:59:29.643
> 
> 标签：c++, templates, methods

在以下代码中，main() 中的 'bObj->b()' 行编译，但 'cObj->c()' 行给出错误 'expected primary-expression before '>' token'。这与依赖类型无关；在适当的位置添加“模板”或“类型名称”没有帮助。关于问题所在的任何提示？在此代码的“真实”版本中，函数“b”还有许多其他模板和非模板版本。问题可能只发生在一个地方而不是其他地方，但我无法确定可能是什么重要的区别。

```
#include <boost/shared_ptr.hpp>

class A {};
class D : public A {};

class B
{
public: 
        template <class T> boost::shared_ptr<T> b() { return boost::shared_ptr<T>(); }
};      

class C
{
public: 
        boost::shared_ptr<A> b() { return boost::shared_ptr<A>(); }
};      

int main(int, char **)
{       
        boost::shared_ptr<C> cObj(new C);
        boost::shared_ptr<B> bObj = boost::dynamic_pointer_cast<B>(cObj);

        bObj->b<D>();
        cObj->b<D>();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:06:31.963

`C`没有成员函数*模板*，只有常规成员函数。因此，调用时不能提供模板参数`C::b()`：

```
cObj->b<D>(); // ERROR!
cObj->b(); // OK 
```

而且：

> 在此代码的“真实”版本中，函数“b”还有许多其他模板和非模板版本。

那么您提供的代码很可能不是您在代码的“真实”版本中遇到的问题的一个很好的例子。

> 问题可能只发生在一个地方而不是其他地方，但我无法确定可能是什么重要的区别。

*你*最了解你的代码。我们不能对我们看不到的东西做出假设。如果此答案不能解决您的问题，我认为您应该制作一个更具代表性的示例来说明您的“真实”代码的作用，可能会将其简化为[SSCCE](http://sscce.org)。

# css - @font-face 在 Firefox 或 IE 中不起作用 - 我怎么知道为什么？

> ID：15032287
> 
> 赞同：0
> 
> 时间：2013-02-22T19:59:42.690
> 
> 标签：css, fonts, font-face, webfonts

我快疯了。当我在客户端的服务器上进行测试时，@font-face 在 IE 或 FireFox 中不起作用。我的代码是合法的 - 如果我将它上传到我自己的服务器，它可以在所有浏览器中正常工作。但是在我真正需要它工作的地方没有运气。我尝试重新排序 CSS，并确认字体确实已上传到服务器。

我已阅读以下链接的信息： http:
[//sixrevisions.com/css/font-face-web-fonts-issues/](http://sixrevisions.com/css/font-face-web-fonts-issues/)
[http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/](http://paulirish.com/2009/bulletproof-font-face-implementation-syntax/)

根据第一篇文章中的信息，我尝试了谷歌的 WebFont 加载器以防万一，但没有运气。我还查看了 Firebug 中的 .NET 面板，但它对我来说是希腊语。我尝试更新 URL 路径，根据这篇文章删除域： [http ://www.fontsquirrel.com/forum/discussion/227/font-face-not-working-in-firefox-or-ie/p1](http://www.fontsquirrel.com/forum/discussion/227/font-face-not-working-in-firefox-or-ie/p1)

我不知道还能尝试什么。在这一点上，我已经放弃并告诉客户他们不能拥有他们喜欢的字体，但我真的很想了解为什么。有什么帮助吗？

这是我使用的由 FontSquirrel 生成的代码：

```
 @font-face {
        font-family: 'Dax';
        src: url('/fonts/dax/dax-regular-webfont-webfont.eot');
        src: url('/fonts/dax/dax-regular-webfont-webfont.eot?#iefix') format('embedded-opentype'),
             url('/fonts/dax/dax-regular-webfont-webfont.woff') format('woff'),
             url('/fonts/dax/dax-regular-webfont-webfont.ttf') format('truetype'),
             url('/fonts/dax/dax-regular-webfont-webfont.svg#Dax') format('svg');
        font-weight: normal;
        font-style: normal;
    }
        body{
                    font-family: 'Dax';
                    font-size: 25px;
                                } 
```

我刚刚想到另一个想法 - 我的客户在他们的网站上设置了重定向。这可能是它在那些浏览器中不起作用的原因吗？

提前感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:04:02.120

firefox 要求所有字体都来自同一个域......所以这听起来像是一个跨域问题。如果没有，无论哪种方式你都需要这个（我假设），你需要将 woff 文件类型添加到你的 .htaccess 文件中。更多信息：http: [//www.fontsquirrel.com/blog/2010/11/troubleshooting-font-face-problems](http://www.fontsquirrel.com/blog/2010/11/troubleshooting-font-face-problems)

# html - 为什么我们不希望能够设置文件输入样式和选择 html 元素？- 我不想知道怎么做

> ID：15032288
> 
> 赞同：2
> 
> 时间：2013-02-22T19:59:46.833
> 
> 标签：html, css

[这是我今天下午提出的同样问题](https://stackoverflow.com/questions/15029463/why-we-cant-stylize-select-and-input-file-html-elements-i-dont-want-to-know)的又一次尝试，但人们不理解它，并在结束前投了反对票。

首先：我不想知道如何解决无法设置文件输入样式并选择输入 html 元素作为其他 html 元素的问题。事实上，我已经知道如何解决它[c&p](https://stackoverflow.com/questions/15029463/why-we-cant-stylize-select-and-input-file-html-elements-i-dont-want-to-know#)：

*   [Firefox中文件输入字段的样式问题](https://stackoverflow.com/questions/352467/styling-issues-with-a-file-input-field-in-firefox)
*   [为 input type="file" 按钮设置样式](https://stackoverflow.com/questions/572768/styling-an-input-type-file-button)
*   [如何使用 CSS3 / Javascript 设置“输入文件”的样式？](https://stackoverflow.com/questions/3226167/how-to-style-input-file-with-css3-javascript)
*   [造型](https://stackoverflow.com/questions/4532733/styleize-input-type-file)
*   [更改输入类型=“文件”上的光标类型](https://stackoverflow.com/questions/1537223/change-cursor-type-on-input-type-file)
*   [Jquery - 设置输入文件标签样式的最佳方式](https://stackoverflow.com/questions/3984815/jquery-best-way-to-style-a-input-file-tag)
*   [如何设置输入文件文本框的样式？](https://stackoverflow.com/questions/4840504/how-can-i-style-input-file-textbox)

我再说一遍，我已经知道如何**解决这个问题。这不是我的问题**。感谢您的所有意图，但这不是必需的。

问题很简单：

*为什么我们不能像其他元素一样轻松地设置样式，实际上就像所有其他 html 元素、文件输入或选择输入 HTML 元素一样？我们更喜欢不能为这些元素设置样式的技术原因是什么？*

我们不能这样做是因为对用户有危险吗？因为他们看不到他们点击的地方？这是一个可访问性问题？标准禁止这样做的原因是什么？

如果你不能理解这个问题很抱歉。是我。但不要像以前那样对它投反对票。

PS：我不想知道如何设置文件输入和选择输入的样式。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:07:32.740

在选择元素的例子中，这是因为通常操作系统会处理这些问题，因为每个平台都有鼠标操作之外的输入法。如果您有平板电脑，您希望选择框的处理方式因触摸输入而略有不同。

在许多情况下，这是由于可访问性设置所致。您永远不想覆盖可访问性设置。有视力障碍的人可能需要辅助技术；其他用户有身体障碍，难以或无法使用鼠标等标准指点设备。

因此，一些浏览器供应商出于特定原因无法处理这些元素的样式，并完全依赖操作系统来告诉浏览器如何呈现特定元素。尽管其中一些正在发生变化，尤其是在 webkit 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:03:20.797

技术原因很简单，浏览器不允许我们这样做。UI 由主机操作系统提供。

# html - html和dom按钮序列创建

> ID：15032289
> 
> 赞同：1
> 
> 时间：2013-02-22T19:59:56.403
> 
> 标签：html, xml, dom, button, html-table

我试图弄清楚如何使用按钮来创建显示在所选按钮前面的新按钮。有三个按钮和一个“插入”按钮。我希望能够单击按钮 1，然后插入并在其前面出现一个新按钮。按钮 2 和 3 也会发生同样的情况。

我注意到通过我的代码单击按钮会自动在表格的单元格 0 处创建一个新按钮。我不希望按钮实际执行任何操作，而是接受“插入”按钮可以使用的用户输入将它们放置在那里。

请帮忙，我卡住了。

我到目前为止的代码是：

```
<html>
<head>
<title>Button Sequence Creation</title>
<script>
function displayResult()
{
var firstRow=document.getElementById("myTable").rows[0];
var x=firstRow.insertCell();
x.innerHTML="New"
}
</script>
</head>
<body>
<h1>Button Sequence Creation</h1>
<hr>
<table id = "myTable" border="1">
  <tr>
        <td>
    <input type="button" value="button1" name ="button1" onclick="displayResult()"></td>
        <td>
    <input type="button" value="button2" name ="button2" onclick="displayResult()"></td>
        <td>
    <input type="button" value="button3" name ="button3" onclick="displayResult()"></td>
  </tr>
</table>
<br>
<button type="button" onclick="displayResult()">Insert</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:01:57.213

不确定您希望“插入”按钮如何工作。但是下面的代码有效。

```
<html>
<head>
  <title>Button Sequence Creation</title>
  <script>
    function displayResult(obj){
      var firstRow=document.getElementById("myTable").rows[0];
      var newButton = document.createElement('input');
      newButton.type = 'button';
      newButton.value = "New";

      var newTD = document.createElement('td');
      newTD.appendChild(newButton);

      obj.parentNode.parentNode.insertBefore(newTD, obj.parentNode);
    }
  </script>
</head>
<body>
  <h1>Button Sequence Creation</h1>
  <hr>
    <table id = "myTable" border="1">
      <tr>
        <td>
          <input type="button" value="button1" id="button1" name ="button1" onclick="displayResult(this)">
        </td>
        <td>
          <input type="button" value="button2" id="button2" name ="button2" onclick="displayResult(this)">
        </td>
        <td>
          <input type="button" value="button3" id="button3" name ="button3" onclick="displayResult(this)">
        </td>
      </tr>
   </table>
   <br>
   <!--button type="button" onclick="displayResult()">Insert</button-->
</body>
</html> 
```

# c# - 死锁说明？

> ID：15032297
> 
> 赞同：2
> 
> 时间：2013-02-22T20:00:26.367
> 
> 标签：c#, .net, multithreading, deadlock

*也许对“死锁”还有其他解释，但 AFAIK ：*

[参考](http://books.google.co.il/books?id=t1de8nSVYnkC&pg=PA882&lpg=PA882&dq=%22A%20deadlock%20happens%20when%20two%20threads%20each%20wait%20for%20a%20resource%20held%20by%20the%20other,%20so%20neither%20can%20proceed.%22&source=bl&ots=24seVuLjaz&sig=ApUJDxRvzk0WEMoq67JVJBeeE8s&hl=en&sa=X&ei=z9YnUZ_zIorLswb1wIHYBA&redir_esc=y#v=onepage&q=%22A%20deadlock%20happens%20when%20two%20threads%20each%20wait%20for%20a%20resource%20held%20by%20the%20other,%20so%20neither%20can%20proceed.%22&f=false)

> 当**两个线程都等待对方持有的资源**时，就会发生死锁，因此两个线程都无法继续。

但是我在这里看到了几个关于 SO 的答案，声称长时间等待（不相互等待）也是一个僵局：

**[示例 #1](https://stackoverflow.com/a/894071/859154)**

```
namespace ConsoleApplication7
{
    public class Program
    {
        public static void Main(string[] args)
        {
            LockableClass lockable = new LockableClass();
            new Thread(new ParameterizedThreadStart(BackgroundMethod)).Start(lockable);
            Thread.Sleep(500);
            Console.Out.WriteLine("calling Reset");
            lockable.Reset();
        }

        private static void BackgroundMethod(Object lockable)
        {
            lock (lockable)
            {
                Console.Out.WriteLine("background thread got lock now");
                Thread.Sleep(Timeout.Infinite);
            }
        }
    }

    public class LockableClass
    {
        public Int32 Value1 { get; set; }
        public Int32 Value2 { get; set; }

        public void Reset()
        {
            Console.Out.WriteLine("attempting to lock on object");
            lock (this)
            {
                Console.Out.WriteLine("main thread got lock now");
                Value1 = 0;
                Value2 = 0;
            }
        }
    }

} 
```

> 请原谅我，但我在这里看到的只是一个尚未释放的纯锁。这不是两个线程都在等待另一个线程的情况。这里的线程**不**等待主线程完成。

* * *

**[另一个例子#2](https://stackoverflow.com/a/728920/859154)**

```
class ILockMySelf
{
    void doThat()
    {
        lock(this){ ... }
    }
}

class WeveGotAProblem
{
    ILockMySelf anObjectIShouldntUseToLock;

    void doThis()
    {
        lock(anObjectIShouldntUseToLock)
        {
            // Following line should run in a separate thread
            // for the deadlock to happen
            anObjectIShouldntUseToLock.doThat();
        }
    }
} 
```

同样在这里。运行的线程`doThis` 不等待将运行的“单独线程”`doThat`

**问题 ：**

*   这里涉及死锁吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:40:31.833

我同意 David Hope 的观点，即死锁的定义很广泛，适用于线程之外的场景。但是，第二个示例不是死锁，因为它没有导致线程“停止”的情况。

要更正第二个示例，请启动一个新线程**并**强制 thread1 在 thread2 上等待。然后，您可以创建死锁：

```
//Deadlock
public class Program
{
    public static void Main(string[] args)
    {
        WeveGotAProblem p = new WeveGotAProblem();
        p.doThis();//gain a lock on this thread                        
    }        
}

class ILockMySelf
{
    public void doThat()
    {
        //Thread2 waits on Thread1 to release "this"
        lock (this)
        {
            Console.WriteLine("that");
        }
    }
}

class WeveGotAProblem
{
    ILockMySelf anObjectIShouldntUseToLock = new ILockMySelf();

    public void doThis()
    {
        lock (anObjectIShouldntUseToLock)
        {
            Task task = Task.Factory.StartNew(new Action(() => anObjectIShouldntUseToLock.doThat()));
            Task.WaitAll(task);//Thread1 waits on Thread2 to return.  This is important
        }
    }
} 
```

在这里，我们有两个或多个相互竞争的动作，每个动作都在等待对方完成。

*   线程 1 正在等待线程 2 返回。
*   线程 2 正在等待线程 1 释放它需要的资源，然后才能返回。

第一个示例（虽然是人为的……为什么要让一个线程永远休眠……？）可能由于类似的原因导致死锁。

例如

*   Thread1 等待 Thread.Sleep() 返回（它永远不会）
*   Thread2 等待 Thread1 释放 lockable 上的锁（它永远不会）

动作是线程并且每个线程都在等待不同的结果这一事实只是实现细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T00:42:06.413

**关于示例 1：**

我个人不认为这是一个死锁，但这只是因为我对“死锁”这个词的语义。当然，在这个例子中，两个线程都不会继续，因此它与死锁具有相同的影响，但这并不是因为每个线程都在等待另一个线程持有的资源。相反，正在执行的线程`BackgroundMethod`（称为 T1）只是在等待……并且等待……一无所获。由于 T2 没有等待 T1 持有的资源，因此执行的线程`Reset`（称为 T2）无法采取任何操作来解除对 T1 ^(1的阻塞。)正是出于这个原因，我不认为这是一个僵局。但是，如果其他人不同意我的观点，我不会抱怨太多。

**关于示例 2：**

正如其他人指出的那样，这也不是僵局。除了这次是因为两个线程都不会阻塞。一个原因是因为 a`lock`是可重入的。但是，即使您确实`doThat`在另一个线程上运行，代码仍然不会死锁，因为会`doThis`立即释放锁。我认为[P.Brian.Mackey](https://stackoverflow.com/a/15032817/158779)在他的回答中已经很好地涵盖了这一点，所以我没有理由进一步阐述。

**现在是有趣的东西**

以下是我最喜欢的死锁插图之一，因为不涉及锁定或阻塞方法。问题的微妙之处令人麻木。这里的问题与没有内存屏障有关。线程 A 等待线程 B 设置信号标志，同时线程 B 一直等待线程 A 重置它，而两个线程都没有看到另一个线程所做的更改，因为编译器、JIT 和硬件可以自由优化以非直观的方式读取和写入标志。

在此示例中，简单*变量*`bool`是`signal`资源。或者，更抽象地说，内存是一种资源。由于应用软件和硬件优化的方式，内存操作可以具有获取-释放语义。这就是记忆障碍背后的全部意义所在。事实上，内存栅栏（或屏障）的正式定义使用术语获取和释放*，因为*内存是一种可以像任何其他资源一样被操纵的资源。

 ***免责声明：再现性可能因您的环境和构建配置而异。*

```
public class Example
{
  private bool signal = false;

  void ThreadA()
  {
    while (!signal);
    signal = false;
  }

  void ThreadB()
  {
    signal = true;
    while (signal);
  }
} 
```

* * *

¹*为了完全迂腐，你可以打电话`Thread.Interrupt`来“戳”`Thread.Sleep`电话。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:10:31.940

真的，这取决于您对 的定义`deadlock`，因此问题...

根据维基百科，死锁是：

> 死锁是这样一种情况，其中两个或多个相互竞争的动作都在等待对方完成，因此永远都不会。

您从任一定义中推断出活动或动作必须在不同的线程中，这不是定义所说的。

所以，从技术上讲，我会得出结论，示例 1 不是死锁，因为无论如何后台线程都不会结束（在异常之外），但示例 2 是死锁，因为如果两个动作没有竞争相同资源，然后执行流程就可以了。

在这两种情况下，都存在编程错误（#2 更像是一个错误，其中 #1 看起来像是一个人为的示例），这导致代码无法向前推进。

所以，在任何一种情况下......无论这个词的具体意图或用法如何，都有一个问题需要解决`deadlock`**

# c# - 如何绑定到静态 BitmapSource？

> ID：15032298
> 
> 赞同：2
> 
> 时间：2013-02-22T20:00:41.577
> 
> 标签：c#, wpf, xaml, wpf-4.5

我想用标准的 Windows“错误图标”创建我的自定义错误/异常对话框。

我遵循了[这个问题](https://stackoverflow.com/questions/2572734/how-do-i-use-standard-windows-warning-error-icons-in-my-wpf-app)的建议并且它有效。

但是，我目前正在创建一个绑定到的实例属性，就像绑定到任何属性一样：

```
class ErrorWindowViewModel
{
    private readonly ImageSource _errorImage;

    public ImageSource ErrorImage { get { return _errorImage; } }

    public ErrorWindowViewModel()
    {
        _errorImage = Imaging.CreateBitmapSourceFromHIcon(SystemIcons.Error.Handle, Int32Rect.Empty, BitmapSizeOptions.FromEmptyOptions());
    }
} 
```

我想做的是在我的 ErrorWindow 类中定义一个静态字段：

```
partial class ErrorWindow : Window
    {
        private readonly static ImageSource ErrorImage = 
            Imaging.CreateBitmapSourceFromHIcon(SystemIcons.Error.Handle, Int32Rect.Empty, BitmapSizeOptions.FromEmptyOptions());
    } 
```

我不能强制我的 XAML 引用该字段。

```
<Image Source="what_to_put_here_to_make_it_work" /> 
```

我正在使用 WPF 4.5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:45:43.050

您必须创建一个静态属性

```
private static readonly ImageSource errorImage =
    Imaging.CreateBitmapSourceFromHIcon(SystemIcons.Error.Handle, Int32Rect.Empty, BitmapSizeOptions.FromEmptyOptions());

public static ImageSource ErrorImage
{
    get { return errorImage; }
} 
```

并像这样绑定：

```
<Image Source="{Binding Source={x:Static local:ErrorWindow.ErrorImage}}"/> 
```

# javascript - 如何获取 JavaScript 对象定义以在控制台中提供自定义输出？

> ID：15032301
> 
> 赞同：1
> 
> 时间：2013-02-22T20:00:51.827
> 
> 标签：javascript

前几天我在查看“CamanJS”项目时第一次注意到这一点。这个问题很难解释，除非你自己去做。如果您访问 camanjs.com，然后使用 Firebug 或 Chrome JavaScript 控制台，输入单词`Caman`并按 Enter。不 `Caman()`带括号 - 只是`Caman`. 它将输出：`Version 4.1.0, Released 2/12/2013`。

但如果你看`typeof Caman`，它只是一个“函数”。那么到底如何让它输出这样的自定义字符串，而不实际调用函数呢？这是通过某种`prototype`扩展完成的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T20:02:23.697

如果函数有自定义`toString()`方法，就会发生这种情况。

例如：

```
function x() { }
x.toString = function() { return "Hi there!"; };  
console.log(x) 
```

# jboss7.x - 嵌入式 JBoss EAP 6 / AS 7 入门

> ID：15032303
> 
> 赞同：3
> 
> 时间：2013-02-22T20:00:54.670
> 
> 标签：jboss7.x, ejb-3.1, embedded-jboss, jboss-eap-6

我正在尝试使用规范中描述的 EJBContainer.createEJBContainer API（JSR 318：Enterprise JavaBeans，版本 3.1，第 22 章：可嵌入用法）中描述的可嵌入 JBoss，**而不是**使用 JBoss 特定 API的[各种前辈。](http://shrubbery.mynetgear.net/c/display/W/Embedded+JBoss+and+Embedded+EJB3)

# 概述

*   当我正常调用我的 main 方法时，会话 bean 调用成功。但似乎存在一些类加载问题，因为`"java:jboss/UserTransaction"`无法将 JNDI 对象转换为 javax.transaction.UserTransaction。
*   所以我想这里需要[JBoss 模块的类加载魔法。](https://docs.jboss.org/author/display/MODULES/Home)通过我的尝试，createEJBContainer 没有找到任何 EJBContainerProviders 并抛出 EJBException。

请注意，并非我的所有问题都需要阅读所有后续详细信息。因此，如果阅读内容过多，请查看问题部分。谢谢！

# 环境

JBoss AS 7.1.1.Final（jboss-as-7.1.1.Final.zip，仅在standalone.xml 中更改了日志配置）
（最初是 JBoss EAP 6.0.1 GA，这是实际的目标环境 - 同样的问题）
Oracle JDK 1.7 .0_11
Windows 7 教授 64 位

# 细节

### 无状态会话 bean

```
package test.helloworld.impl;

import javax.ejb.Remote;
import javax.ejb.Stateless;
import test.helloworld.api.HelloWorld;

@Stateless
@Remote(HelloWorld.class)
public class HelloWorldBean implements HelloWorld
{
    @Override
    public String salute()
    {
        return "Hello, world";
    }
} 
```

...及其业务接口：

```
package test.helloworld.api;

public interface HelloWorld
{
    String salute();
} 
```

### 客户端程序

```
package test.helloworld.client;

import static java.lang.System.out;
import java.io.File;
import java.util.HashMap;
import java.util.Map;
import javax.ejb.embeddable.EJBContainer;
import javax.naming.Context;
import javax.transaction.UserTransaction;
import test.helloworld.api.HelloWorld;

public class HelloWorldEmbeddedEjbTestClient
{
    public static void main(String[] args)
    {
        int status = 1;

        try
        {
            main();
            status = 0;
        }
        catch (Throwable e)
        {
            e.printStackTrace(System.err);
            System.err.flush();
        }
        finally
        {
            // Simply returning from main leaves some thread (and
            // hence the JVM) running for another 60s, so force exit
            System.exit(status);
        }
    }

    private static void main() throws Exception
    {
        Map<String, Object> properties = new HashMap<String, Object>();
        properties.put(EJBContainer.MODULES, new File[]{new File("./HelloWorld-EJB.jar")});
        EJBContainer container = EJBContainer.createEJBContainer(properties);

        try
        {
            Context jndiContext = container.getContext();
            Object serviceObj = jndiContext.lookup("java:global/HelloWorld-EJB/HelloWorldBean");
            out.println("service:\t" + serviceObj);
            HelloWorld service = (HelloWorld) serviceObj;
            out.println("result:\t" + service.salute());

            callInTx(service, jndiContext);
        }
        finally
        {
            out.println("closing EJBContainer...");
            container.close();
            out.println("EJBContainer closed.");
        }
    }

    private static void callInTx(HelloWorld service, Context jndiContext) throws Exception
    {
        UserTransaction tx = (UserTransaction) jndiContext.lookup("java:jboss/UserTransaction");
        tx.begin();
        out.println("result in tx:\t" + service.salute());
        tx.commit();
    }
} 
```

### 打包

C:\eclipse\projects\HelloWorldSlSB-Client\rt\HelloWorld-API.jar：

```
META-INF/MANIFEST.MF
test/helloworld/api/HelloWorld.class 
```

C:\eclipse\projects\HelloWorldSlSB-Client\rt\HelloWorld-EJB.jar：

```
META-INF/MANIFEST.MF
META-INF/jboss-deployment-structure.xml
test/helloworld/impl/HelloWorldBean.class
test/helloworld/api/HelloWorld.class 
```

HelloWorld-EJB.jar:META-INF/jboss-deployment-structure.xml:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<jboss-deployment-structure>
    <deployment>
        <dependencies></dependencies>
        <exclusions>
            <module name="Classpath"/>
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules\test\helloworld\client\main\HelloWorldSlSB-Client.jar：

```
META-INF/MANIFEST.MF
test/helloworld/client/HelloWorldEmbeddedEjbTestClient.class 
```

C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules\test\helloworld\client\main\module.xml：

```
 <main-class name="test.helloworld.client.HelloWorldEmbeddedEjbTestClient"/>

    <resources>
        <resource-root path="HelloWorldSlSB-Client.jar"/>
    </resources>

    <dependencies>
        <module name="javax.api"/>
        <module name="javax.ejb.api"/>
        <module name="org.jboss.as.embedded" export="true"/>
<!--
        <module name="org.jboss.as.server" export="true"/>
-->
    </dependencies>
</module> 
```

所有 META-INF/MANIFEST.MF 文件只包含“Manifest-Version: 1.0”。

# 结果

## 直接调用

使用`-Xmx512m -XX:MaxPermSize=256m`类路径 直接调用 HelloWorldEmbeddedEjbTestClient.main

```
C:\eclipse\output\HelloWorldSlSB-Client
C:\java\jboss-as-7\jboss-modules.jar
C:\java\jboss-as-7\modules\org\jboss\as\embedded\main\jboss-as-embedded-7.1.1.Final.jar
C:\java\jboss-as-7\modules\javax\ejb\api\main\jboss-ejb-api_3.1_spec-1.0.1.Final.jar
C:\java\jboss-as-7\modules\javax\transaction\api\main\jboss-transaction-api_1.1_spec-1.0.0.Final.jar
C:\java\jboss-as-7\modules\org\jboss\logging\main\jboss-logging-3.1.0.GA.jar
C:\java\jboss-as-7\modules\org\jboss\as\controller-client\main\jboss-as-controller-client-7.1.1.Final.jar
C:\java\jboss-as-7\modules\org\jboss\logmanager\main\jboss-logmanager-1.2.2.GA.jar
C:\java\jboss-as-7\modules\org\jboss\dmr\main\jboss-dmr-1.1.1.Final.jar
C:\eclipse\projects\HelloWorldSlSB-Client\rt\HelloWorld-API.jar 
```

和系统属性

```
-Duser.language=en
-Djboss.home=c:/java/jboss-as-7
-Djboss.home.dir=c:/java/jboss-as-7
-Dorg.jboss.as.embedded.ejb3.BARREN=true
-Dfile.encoding=ISO-8859-1 
```

EJB 调用成功，但无法将 JNDI 对象“java:jboss/UserTransaction”强制转换为 javax.transaction.UserTransaction：

```
...
19:21:01,875 INFO  [org.jboss.ejb.client] (main) JBoss EJB Client version 1.0.5.Final
service:    Proxy for remote EJB StatelessEJBLocator{appName='', moduleName='HelloWorld-EJB', distinctName='', beanName='HelloWorldBean', view='interface test.helloworld.api.HelloWorld'}
result: Hello, world
closing EJBContainer...
19:21:06,362 INFO  [org.jboss.as.server.deployment] (MSC service thread 1-7) JBAS015877: Stopped deployment HelloWorld-EJB.jar in 90ms
19:21:06,370 INFO  [org.jboss.as.repository] (pool-9-thread-1) JBAS014901: Content removed from location c:\java\jboss-as-7\standalone\data\content\35\424415b9a67d64fe8a6dc7ee0700480282f34b\content
19:21:06,370 INFO  [org.jboss.as.server] (pool-9-thread-1) JBAS018558: Undeployed "HelloWorld-EJB.jar"
19:21:06,390 INFO  [org.jboss.as.osgi] (MSC service thread 1-1) JBAS011942: Stopping OSGi Framework
EJBContainer closed.
java.lang.ClassCastException: org.jboss.tm.usertx.client.ServerVMClientUserTransaction cannot be cast to javax.transaction.UserTransaction
    at test.helloworld.client.HelloWorldEmbeddedEjbTestClient.callInTx(HelloWorldEmbeddedEjbTestClient.java:65)
    at test.helloworld.client.HelloWorldEmbeddedEjbTestClient.main(HelloWorldEmbeddedEjbTestClient.java:52)
    at test.helloworld.client.HelloWorldEmbeddedEjbTestClient.main(HelloWorldEmbeddedEjbTestClient.java:21) 
```

（看起来有点奇怪，因为异常被捕获并打印在 main 的末尾。当然，它发生在容器关闭之前。）

调试器显示 JNDI 对象的 getClass().getClassLoader() 是 org.jboss.modules.ModuleClassLoader
`ModuleClassLoader for Module "org.jboss.jboss-transaction-spi:main" from local module loader @4b436982 (roots: c:\java\jboss-as-7\modules)`
及其 getClass().getInterfaces()[0] /* == interface javax.transaction.UserTransaction */.getClassLoader()但是，UserTransaction.class.getClassLoader() 的类型是
`ModuleClassLoader for Module "javax.transaction.api:main" from local module loader @4b436982 (roots: c:\java\jboss-as-7\modules)`
sun.misc.Launcher$AppClassLoader。

## jboss-modules.jar 调用

`java -jar jboss-modules.jar`通过带有类路径的org.jboss.modules.Main.main 调用（即还有什么作用）

```
C:\java\jboss-as-7\jboss-modules.jar 
```

如上所述的系统属性和参数

```
-mp "C:\java\jboss-as-7\modules;C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules"
test.helloworld.client 
```

它已经在 createEJBContainer 中失败了：

```
javax.ejb.EJBException: Unable to instantiate container with factories []
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:97)
    at test.helloworld.client.HelloWorldEmbeddedEjbTestClient.main(HelloWorldEmbeddedEjbTestClient.java:42)
    at test.helloworld.client.HelloWorldEmbeddedEjbTestClient.main(HelloWorldEmbeddedEjbTestClient.java:21)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.modules.Module.run(Module.java:260)
    at org.jboss.modules.Main.main(Main.java:291) 
```

调试显示这是因为在方法 EJBContainer.findAllFactories() 中，在线程上下文类加载器中找不到资源“META-INF/services/javax.ejb.spi.EJBContainerProvider”，即
`ModuleClassLoader for Module "test.helloworld.client:main" from local module loader @1afec586 (roots: C:\java\jboss-as-7\modules,C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules)`

# 问题

*   有谁知道如何解决这个问题或有任何类似的工作？
*   正常的 JBoss 安装是正确的起点，还是我需要特定的可嵌入变体？
*   UserTransaction 甚至应该在可嵌入场景中使用吗？
    *   如果是，这是否意味着我也可以为 JPA 2 CMT 实体和旧版 JDBC 代码使用一个 XA 数据源？两者都可以参与同一个事务（例如，JDBC 代码以 java.sql.Connection.setAutoCommit(false) 开始 tx，然后使用 TransactionAttributeType.REQUIRED 调用 EJB）？
*   有人可以指点我一些文件吗？我发现的只是带有 JBoss 特定 API 的旧东西，而不是标准的 EJB 3.1 方式。
    *   最好记录如何在没有任何测试框架的情况下使用，因为我正在评估它以供生产使用。

感谢您阅读全部（或部分:-)！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T17:48:31.110

在记得我读过[META-INF/services 需要显式导入](https://docs.jboss.org/author/display/MODULES/Module+descriptors#Moduledescriptors-Moduledependencies)之后，我找到了 JBoss Modules 方式的解决方案。所以，客户端的 module.xml 需要一个`services="import"`，现在看起来像这样：

C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules\test\helloworld\client\main\module.xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<module xmlns="urn:jboss:module:1.1" name="test.helloworld.client">
    <main-class name="test.helloworld.client.HelloWorldEmbeddedEjbTestClient"/>

    <resources>
        <resource-root path="HelloWorldSlSB-Client.jar"/>
    </resources>

    <dependencies>
        <module name="javax.api"/>
        <module name="javax.ejb.api"/>
        <module name="org.jboss.as.embedded" services="import"/>
        <module name="org.jboss.logmanager"/>
        <module name="test.helloworld"/>
    </dependencies>
</module> 
```

此外，一条错误消息告诉我将系统属性设置`java.util.logging.manager`为`org.jboss.logmanager.LogManager`，因此我添加了相应的`-D`VM 参数。然后来了`ClassNotFoundException: org.jboss.logmanager.LogManager`，所以我在上面添加了 logmanager 依赖项。

仅将 EJB jar 放入`createEJBContainer`Map 参数不足以让客户端看到它，因此似乎 EJB 也必须是客户端可以显式依赖的模块（`<module name="test.helloworld"/>`上文）。所以我将 HelloWorld-API.jar 和 HelloWorld-EJB.jar 移动到了*modulePath* /test/helloworld/main/ 目录（即 C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules\test\helloworld\main），更改了相应的路径`new File("./HelloWorld-EJB.jar")`，并为它们添加了一个 module.xml：

C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules\test\helloworld\main\module.xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<module xmlns="urn:jboss:module:1.1" name="test.helloworld">
    <resources>
        <resource-root path="HelloWorld-API.jar"/>
        <resource-root path="HelloWorld-EJB.jar"/>
    </resources>
</module> 
```

我`test/helloworld/api/HelloWorld.class`从 EJB jar 中删除。没有必要，但可能更清洁。

**编辑 2013-02-27**：找到一个更简单的工作调用，仍在使用`org.jboss.modules.Main`，但部署了 EJB，因为我们可能会为非嵌入式使用做，并且不需要 module.xml 文件。现在没有参数`createEJBContainer()`就足够了，因为我在`-cp`参数中包含了 EJB jar。

%JBOSS_HOME%\standalone\deployments 包含

```
HelloWorld-API.jar
HelloWorld-EJB.jar 
```

HelloWorld-EJB.jar：

```
META-INF/MANIFEST.MF
META-INF/jboss-deployment-structure.xml
test/helloworld/impl/HelloWorldBean.class 
```

HelloWorld-EJB.jar:META-INF/jboss-deployment-structure.xml:

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<jboss-deployment-structure>
    <deployment>
        <dependencies>
            <module name="deployment.HelloWorld-API.jar"/>
        </dependencies>
        <exclusions>
            <module name="Classpath"/>
        </exclusions>
    </deployment>
</jboss-deployment-structure> 
```

调用：

```
C:\java\jdk1.7\bin\java -Xmx512m -XX:MaxPermSize=256m -Duser.language=en
-Djboss.home=c:/java/jboss-as-7 -Djboss.home.dir=c:/java/jboss-as-7
-Djava.util.logging.manager=org.jboss.logmanager.LogManager
-classpath "C:\java\jboss-as-7\jboss-modules.jar"
org.jboss.modules.Main
-mp "C:\java\jboss-as-7\modules"
-dep "javax.ejb.api, org.jboss.as.embedded, org.jboss.logmanager"
-cp "C:\eclipse\output\HelloWorldSlSB-Client;C:\java\jboss-as-7\standalone\deployments\HelloWorld-API.jar;C:\java\jboss-as-7\standalone\deployments\HelloWorld-EJB.jar"
test.helloworld.client.HelloWorldEmbeddedEjbTestClient 
```

目录 C:\eclipse\projects\HelloWorldSlSB-Client\rt\modules：空，不再使用。

**编辑结束 2013-02-27**

## 剩下的问题

*   如果有人知道如何在不运行 org.jboss.modules.Main 的情况下直接调用，我仍然想知道。
*   文档链接仍然非常受欢迎。
*   UserTransaction / JDBC 问题

顺便说一句，也许有足够声誉的人可以添加像 jboss-modules 这样的标签？

# objective-c - 带有 IBOutlets 和 segues 的 UICollectionViewCell

> ID：15032315
> 
> 赞同：1
> 
> 时间：2013-02-22T20:02:06.603
> 
> 标签：objective-c, uicollectionview, uistoryboardsegue, uicollectionviewcell

我创建了一个自定义 UICollectionViewCell，其中包含多个按钮和标签。我需要每个按钮通过弹出框显示不同的视图。我尝试将 segues 放在按钮上，这给了我编译器错误。

```
".../MainStoryboard_iPad.storyboard: Couldn't compile connection: <IBCocoaTouchOutletConnection:0x4012ea380  <IBProxyObject: 0x4012d7600> => anchorView => <IBUICollectionViewCell: 0x4012d06a0>>" 
```

我尝试将 segue 放在原型单元本身上，结果相同。我从按钮和标签中删除了所有 IBOutlets，仍然得到编译器错误。

如何正确设置一个集合视图单元到网点和转场？我已经看过做这件事的教程，但它根本不起作用。

蒂亚！

珍妮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T10:29:56.237

这对我有用。我希望每个集合视图单元格都有一个会弹出一个弹出窗口的按钮。

首先，在 Interface Builder 中，我在我的故事板中创建了一个新的视图控制器——这个视图控制器是用户触摸按钮时的目标弹出框。在 IB 中，确保在 Identity Inspector 中为该视图控制器提供一个 Storyboard ID，我使用了“destinationView”。在 Attributes Inspector 中，我将 Size 设置为“Form Sheet”，并将 Presentation 设置为“Form Sheet”。

我将按钮放到源视图控制器上我的集合视图中的集合视图单元格上。

在我的源视图控制器中，我创建了一个处理按钮的方法：

```
- (IBAction)handleButton:(id)sender 
```

然后我在 Interface Builder 的源视图控制器中将该按钮操作与该方法挂钩。

此函数的代码如下所示：

```
- (IBAction)handleButton:(id)sender
{
    UIStoryboard* storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

    // get an instance of the destination view controller 
    // you can set any info that needs to be passed here 
    // just use the "sender" variable to find out what view/button was touched
    DestinationViewController *destVC = [storyboard instantiateViewControllerWithIdentifier:@"destinationView"]; 

    // create a navigation controller (so we can have buttons and a title on the title bar of the popover) 
    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:destVC];

    // say that we want to present it modally 
    [navController setModalPresentationStyle:UIModalPresentationFormSheet];

    // show the popover 
    [[self navigationController] presentViewController:navController animated:YES completion:^{

    }]; 
} 
```

在我的目标视图控制器中，我添加了一个标题和一个用于关闭弹出框的完成按钮：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Done" style:UIBarButtonItemStyleDone target:self action:@selector(dismissExampleButton:)];

    self.title = @"Example Title";
}

- (IBAction)dismissExampleButton:(id)sender
{
    [[self parentViewController] dismissViewControllerAnimated:YES completion:^{

    }]; 
} 
```

请注意，我尝试使用 segues 代替。但是，弹出窗口对我不起作用，它只是动画到一个新的全尺寸目标视图控制器，即使 IB 中的设置是“表单”。我如上所述在 IB 中设置了目标视图控制器，并创建了从源视图控制器到目标视图控制器的 segue。我在属性检查器中给了 segue 一个标识符，比如“exampleSegue”。我将按钮连接到源视图控制器中的操作。

通过这种方式，源视图控制器看起来像：

```
- (IBAction)handleButton:(id)sender
{
    [self performSegueWithIdentifier:@"exampleSegue" sender:sender];
} 
```

而且，为了向目标视图控制器获取数据，我还在源视图控制器中实现了这一点：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"exampleSegue"]) {

        DestinationViewController *destViewController = (DestinationViewController *)[segue destinationViewController];

        // give the destViewController additional info here
        // destViewController.title.text = @"blah"; 
        // etc. 
    } 
} 
```

# c - malloc前使用的必要性（float*）

> ID：15032318
> 
> 赞同：2
> 
> 时间：2013-02-22T20:02:13.590
> 
> 标签：c

在我们经常使用的任何指针变量的程序中：

```
float *x;
x=(float*)malloc(a*sizeof(long int)); 
```

我想知道为什么我们`(float*)`在前面使用`malloc`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:05:19.740

Malloc 返回一个指向 void 的指针。

`(float*)`从指向 void 的指针转换为指向 float 的指针

在 C 中这不是必需的，在 C++ 中是这样，因此有些人建议使您的代码与 C++ 编译器兼容。

但你不需要这样做。（有些C迷反对）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-22T20:05:15.887

`malloc`会给你一个指针`void`，你不能用它来做任何与你想用`float`. 为了能够使用在返回的内存位置分配的变量，您需要将其强制转换为 a`float*`以便您可以取消引用该指针并将其用作`float`.

但是，正如您写的问题一样，您应该将返回值转换为`malloc`to `float*`，然后在将其分配给之前立即取消引用它`x`，因为您没有声明`x`为指向`float`.

**编辑：**正如评论者所指出的，显式转换只**需要**在 C++ 中，而不是在 C 中。

# c - 如何重新分配内部和外部数组

> ID：15032324
> 
> 赞同：4
> 
> 时间：2013-02-22T20:02:55.310
> 
> 标签：c, string, memory-management

所以，我接到了一个奇怪的任务。我必须将文件内容读取到数组字符串中。但是，我必须像这样初始化数组（我必须将其初始化为数组大小 1）：

```
char **input = (char **)malloc(1*sizeof(char*)) 
```

代替

```
char **input = (char **)malloc((sizeOfFile+1)*sizeof(char*)) 
```

所以，我必须继续使用 realloc。我的问题是，如何重新分配内部数组（字符串）以及如何重新分配外部数组（字符串数组）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T20:04:58.673

您不必重新分配“内部数组”。您分配的内存内容是指针，当您重新分配时，`input`您只重新分配`input`指针，而不是 where`input`指向的内容。

* * *

一个粗略的 ASCII 图像来显示它是如何工作的：

起初，当您在`input`数组中分配单个条目时，它看起来像这样：

```
 +----------+    +---------------------------+
input -> | input[0] | -> | What `input[0]` points to |
         +----------+    +---------------------------+ 
```

在您重新分配为第二个条目腾出位置之后（即`input = realloc(input, 2 * sizeof(char*));`）

```
 +----------+    +---------------------------+
input -> | input[0] | -> | What `input[0]` points to |
         +----------+    +---------------------------+
         | input[1] | -> | What `input[1]` points to |
         +----------+    +---------------------------+ 
```

内容，即`input[0]`与重新分配前相同。唯一改变的是实际的`input`指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:19:34.403

你的`char**`（即指向指针的指针`char`）是一个指向一些内存的指针数组。因此，您不仅需要为一堆`char*`指针分配内存，而且还需要分配每个指针将指向的内存（将存储一些字符的内存）：

```
const int ARR_SIZE = 10;
const int STR_SIZE = 20;

char** strArr = malloc(ARR_SIZE * sizeof(char*));
for (int i = 0; i < ARR_SIZE; ++i)
    strArr[i] = malloc(STR_SIZE * sizeof(char));

strArr[9] = "Hello";

strArr = realloc(strArr, (ARR_SIZE + 5) * sizeof(char*));
for (int i = 0; i < 5; ++i)
    strArr[ARR_SIZE + i] = malloc(STR_SIZE * sizeof(char));

strArr[14] = "world!";

printf("%s %s", strArr[9], strArr[14]); 
```

完整的例子在[这里](http://ideone.com/JB3zS4)。希望这可以帮助 ：）

# c# - 日期时间选择器和小日期时间

> ID：15032327
> 
> 赞同：-1
> 
> 时间：2013-02-22T20:03:02.020
> 
> 标签：c#, sql, sql-server, tsql

我在 C# 中有这段代码：

```
label3.Text = dateTimePicker1.Value.ToString(); 
DateTime vencim = dateTimePicker1.Value; 
DataTable llenar3 = minaf.cargrid3(vencim);
BindingSource forwo = new BindingSource();
forwo.DataSource = llenar3;
dataGridView1.AutoGenerateColumns = true;
dataGridView1.DataSource = llenar3;
dataGridView1.Refresh(); 
```

cargrid3 是这样的：

```
DataTable rcargaP = new DataTable();
SqlConnection abre1 = Tconex.GetConnection();
SqlDataAdapter da3 = new SqlDataAdapter();
SqlCommand llena5 = new SqlCommand("vencedata", abre1);
SqlParameter para1 = new SqlParameter("@venci", SqlDbType.SmallDateTime);
para1.Value = vence; llena5.Parameters.Add(para1);
llena5.CommandType = CommandType.StoredProcedure;
da3.SelectCommand = llena5;
da3.Fill(rcargaP);
return rcargaP; 
```

程序是这样的：

```
alter proc vencedata (@venci datetime)as
select   conta,vencimento,pagamento,historico,original,formpagto,planoconta,clifor 
from financeiro where vencimento >= @venci 
order by vencimento desc 
```

datetimepicker 有效，如果我在 SQL Studio 中编写，则 proc 有效：

```
vencedata '01/31/2013' 
```

程序 vencedata 仅适用于这种格式

```
vencedata '03/28/2013' (mm/dd/yyyy) 
```

但是当我尝试

```
vencedata '28/03/2013'(dd/mm/yyyy) 
```

我也试过这个：

```
alter proc vencedata (@inicio smalldatetime/*,@final smalldatetime*/)as
select idconta,vencimento,pagamento,historico,original,formpagto,planoconta,clifor 
from financeiro where vencimento >= convert (varchar, @inicio,101) 
```

一个不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:19:33.780

假设 vence 是一个包含 dateTimePicker1 选定日期的字符串，您可以试试这个：

```
para1.Value = vence.ToString("MM/DD/AAAA"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:56:40.573

您应该以正确的格式转换字符串中的日期，然后将其作为参数传递。

尝试这个。

```
para1.Value = String.Format("{0:d/M/yyyy HH:mm:ss}", vence); 
```

我希望这对你有帮助。

问候，

# zend-framework2 - Zend Framework 2 用户指南中的 AlbumTableGateway

> ID：15032330
> 
> 赞同：2
> 
> 时间：2013-02-22T20:03:05.600
> 
> 标签：zend-framework2, tablegateway

在当前（2.1）ZF2用户指南的“[数据库和模型](http://framework.zend.com/manual/2.1/en/user-guide/database-and-models.html)”一章中有一个代码片段，我不明白：

（块“使用ServiceManager配置表网关并注入AlbumTable”）

```
...
class Module
{
    // getAutoloaderConfig() and getConfig() methods here

    // Add this method:
    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'Album\Model\AlbumTable' =>  function($sm) {
                    $tableGateway = $sm->get('AlbumTableGateway');
                    $table = new AlbumTable($tableGateway);
                    return $table;
                },
                'AlbumTableGateway' => function ($sm) {
                    $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                    $resultSetPrototype = new ResultSet();
                    $resultSetPrototype->setArrayObjectPrototype(new Album());
                    return new TableGateway('album', $dbAdapter, null, $resultSetPrototype);
                },
            ),
        );
    }
} 
```

该变量`$sm`稍后将成为 的实例`Zend\ServiceManager\ServiceManager`，对吗？Zend\ServiceManager\ServiceManager#get(...) 方法需要一个类名作为第一个参数。但是没有类 AlbumTableGateway。只有两个模型类：Album\Model\Album 和 Album\Model\AlbumTable。

这是指南中的错误还是我错误地理解了代码？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T08:56:11.763

想到这一点的最好方法是 ServiceManager 的`get()`方法采用键值，而不是类名。键值需要映射到将导致返回类实例的内容。

如果键在该`invokables`部分内，则 ServiceManager 将尝试实例化键指向的字符串，假设它是一个类名：

```
'invokables' => array(
    'some_name' => 'My\Mapper\SomeClassName',
), 
```

如果 key 在`factories`section 内，则 ServiceManager 将执行 key 指向的回调并期望返回一个对象实例：

```
'factories' => array(
    'some_name' => function($sm) { return new \My\Mapper\SomeClassName(); },
), 
```

通常，当您需要做的不仅仅是实例化一个类时，您会使用工厂 - 通常您需要使用另一个依赖项设置该类。如果您只需要实例化一个类，请使用可调用的。

# jquery - jQuery确定鼠标是否从侧面离开

> ID：15032331
> 
> 赞同：0
> 
> 时间：2013-02-22T20:03:10.120
> 
> 标签：jquery, events, mouse

我已经有一个鼠标输入的脚本，但我无法从侧面弄清楚离开语句。目标是使 .darker 动画从鼠标所在的一侧进入，并从鼠标离开的一侧离开。

```
$('body').on('mouseenter', '.article', function(e){
    if(e.offsetX < 10){
        side = "left";
        $('.darker', this).css('top', '0');
        $('.darker', this).css('left', '-325px');
        $('.darker', this).animate({
            left: 0
        },200,function(){});
    }
}); 
```

你知道如何确定从侧面离开吗？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T20:21:25.297

看看鼠标事件，基本上'mouseover'和'mouseout'是你想要的事件。

浏览[此鼠标事件的优秀链接以](http://www.quirksmode.org/js/events_mouse.html)获取详细信息

有关 jQuery 特定答案，请查看 jQuery API 文档中的 .mouseover() 和 .mouseout()

# google-app-engine - 数据存储区 JPA Google 应用引擎的 IN 运算符

> ID：15032335
> 
> 赞同：0
> 
> 时间：2013-02-22T20:03:20.053
> 
> 标签：google-app-engine, jpa, google-cloud-datastore, jdo

本文档中引用的数据存储区 JDO 的 IN 运算符[https://developers.google.com/appengine/docs/java/datastore/jdo/queries#Filters](https://developers.google.com/appengine/docs/java/datastore/jdo/queries#Filters)

那么，在 Datastore JPA 中它是什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T07:49:03.550

Errm，根据 JPA2 规范，JPA 中的“IN”运算符称为“IN”。建议阅读 JPA 规范以及 DataNucleus v3.x 文档。

JDO 没有“IN”运算符（该文档清楚地告诉您），它具有“包含”。GAE/Datastore 具有该页面中提到的“IN”运算符

# c - 在 C 中提取 DER 编码证书的公钥

> ID：15032338
> 
> 赞同：1
> 
> 时间：2013-02-22T20:03:29.507
> 
> 标签：c, openssl, der

我从 ldap 搜索请求中获取 DER 编码证书（在 base64 解码后），需要从中解析公钥。我很确定它可以使用 openssl 库。不幸的是，API 文档保存得不是很好。是否有任何示例或其他库来提取信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T06:25:57.387

使用 d2i_X509 获取 X509 * 结构中的证书。之后使用 X509_get_pubkey 获取公钥。X509_get_pubkey 将为您提供 EVP_PKEY * 结构中的公钥。我希望这必须解决您的目的。

如果您的证书是 PEM 格式（Base64 编码由 "-----BEGIN CERTIFICATE-----" 包装），那么您也可以使用 PEM_read_X509 直接获取 X509 * 对象。

例子：

```
//Get the X509 object.
//Say certificate is encoded in a file
X509 * xcert = PEM_read_X509(fp, NULL, NULL, NULL);

//or assuming DER encoded certificate in buf with length of buffer is buflen.
X509 * xcert = d2i_X509(NULL, buf, buflen);

//Get the public key.
EVP_PKEY * pubkey = X509_get_pubkey(xcert);

//later free this pubkey object when no longer required.
EVP_PKEY_free(pubkey); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T06:17:54.430

您可以尝试使用[d2i_X509](http://www.openssl.org/docs/crypto/d2i_X509.html) API 来解码 DER 编码的证书。它为您提供了一个 X509 结构，您应该能够从中获取公钥。

# vba - 将 VBA 数组打印到 Excel 单元格

> ID：15032339
> 
> 赞同：1
> 
> 时间：2013-02-22T20:03:30.600
> 
> 标签：vba, excel

我正在尝试将 VBA 创建的数组打印到 excel 电子表格的单元格中。渗透和径流值不断出现“下标超出范围”错误我是否正确创建软管阵列？我已将计算和打印子功能合并为一个。

```
 NumMonth = 12
 Dim col As Long
 Dim rw As Long
 rw = 4
 col = 13

 Range(Cells(rw, col), Cells(rw + NumMonth - 1, col)).Value = _
    Application.Transpose(WC)

Range(Cells(rw, col + 1), Cells(rw + NumMonth - 1, col + 1)).Value = _
    Application.Transpose(Runoff)

   Range(Cells(rw, col + 2), Cells(rw + NumMonth - 1, col + 2)).Value = _
     Application.Transpose(Percolation)
   End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:18:10.360

它的 application.transpose 而不是 worksheetfunction

```
 Range(Cells(rw, col), Cells(rw + NumMonth - 1, col)).Value = _
      application.Transpose(WC) 
```

这是一个测试子

```
Sub test()
Dim myarray As Variant

'this is a 1 row 5 column Array
myarray = Array(1, 2, 3, 4, 5)

'This will fail because the source and destination are different shapes
Range("A1:A5").Value = myarray

'If you want to enter that array into a 1 column 5 row range like A1:A5

Range("A1:A5").Value = Application.Transpose(myarray)
End Sub 
```

如果你调用你在另一个子中创建的数组，你会得到一个错误。当您单步执行代码时，可以在本地窗口中看到其原因。当您运行创建数组的子程序时，它将显示在本地，当子程序结束时它将消失，这意味着它不再存储在内存中。要从另一个子引用变量或数组，您必须传递它。

传递数组或变量可以用不同的方式完成这里有几个链接 [Here](http://www.cpearson.com/excel/passingandreturningarrays.htm) [And Here](http://www.cpearson.com/excel/byrefbyval.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T00:01:37.687

你的`Precip`和`RefET`永远是平等的，这难道就是吗？

```
Precip(i) = Cells(4 + i, 2).Value
RefET(i)  = Cells(4 + i, 2).Value 
```

* * *

此外，当您设置`Runoff`和`Percolation`数组时，如果您的 if 语句不满足（如下），它们不会被设置为任何内容，我可以使用提供的数据来满足它：

```
If (fc - WC(j - 1) + RefET(i) * dz < Precip(i) * dz) then 
```

我会添加一些东西以确保它们总是有价值：

```
If (fc - WC(j - 1) + RefET(i) * dz < Precip(i) * dz) Then
    Runoff(i) = (Precip(i) - (fc - WC(j - 1) + RefET(i)) * dz) * 0.5
    Percolation(i) = (Precip(i) - (fc - WC(i - 1) + RefET(i)) * dz) * 0.5
    WC(j) = fc
Else
    Runoff(i) = 0
    Percolation(i) = 0
    WC(j) = WC(j - 1) + Precip(i) - RefET(i) / dz
End If 
```

* * *

**这样做后，我发现您没有`ReDim`使用`Runoff`and`Percolation`变量。** 您需要将以下内容添加到您的`WaterBalanceRead`子目录中。

```
ReDim Runoff(1 To NumMonth + 1)
ReDim Percolation(1 To NumMonth + 1) 
```

# php - 从 MySQL 数据库填充复选框

> ID：15032344
> 
> 赞同：0
> 
> 时间：2013-02-22T20:03:36.423
> 
> 标签：php, mysql

在我的 MySQL 数据库中，我有一个这样的表：

```
Column      Value
----------------------------------
Id          int pk autoinc
Name        varchar(50)
Choices     set('a', 'b', 'c', ...)
...         ... 
```

更新此数据时，我希望显示许多复选框，每个复选框代表一个选项成员。每个复选框都是在 PHP 中创建的，类似于：

```
echo "<input type=Checkbox name=$choiceName[i] value=$choiceName[i]>" 
```

我的问题是如何为表中的特定 ID 创建这些复选框并填充它们（通过检查与否）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T22:41:30.153

我终于找到了解决方案。

为了在数据类型的列`Choice`中获取允许的值。`set`您必须执行以下操作：

```
 $result = mysql_query("SHOW COLUMNS FROM Table LIKE 'Choice'");
  $line = mysql_fetch_array($result);
  //Remove the unwanted characters from the Type
  $set = substr($line['Type'],5,strlen($line['Type'])-7);
  //An array containing all allowed members from the Choice set
  $choices = preg_split("/','/",$set);

  $result = mysql_query("SELECT * FROM Table WHERE Id=$someId");
  $row = mysql_fetch_row($result);
  $selected = explode(',', $row[$indexOfChoicesColumn]);
  $j=0;
  for($i=0; $i<count($days); $i++){
     if($j<count($selected) && $selected[$j] == $choices[$i]){
        echo $choices[$i]." <input type='checkbox' name='choices[]' value='". $choices[$i] ."' checked> ";
        $j++;
     }
     else echo $choices[$i]." <input type='checkbox' name='choices[]' value='". $choices[$i] ."'> ";
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:30:43.557

例子：

```
//or you can obtain $choices = $row['Choices']; from  your DB, its the same 

$choices = "Example1,Example4,Example10";
$arrChoices = explode(',', $choices);

foreach ($arrChoices as $key => $value) {
echo "<input type='checkbox' name='$value' value='$value'/>";
} 
```

萨卢多斯 ;)

# sql-server-2008 - 当变量是 varchar(4) 但不是 varchar 时，SQL LIKE 匹配 int

> ID：15032348
> 
> 赞同：0
> 
> 时间：2013-02-22T20:03:47.987
> 
> 标签：sql-server-2008

试图通过用户 ID（一个 int）将一些记录与用户匹配。但它将动态完成，我需要能够同时匹配所有记录（我为 LIKE 通配符传递了一个 '%' 字符）。我以前做过这个，不小心遇到了这个问题。

```
Declare 
   @uid varchar = 300

SELECT * FROM items WHERE user_id LIKE @uid 
```

不起作用，但这确实

```
Declare
   @uid varchar(10) = 300

SELECT * FROM items WHERE user_id LIKE @uid 
```

它匹配得很好，为什么没有声明 varchar 的大小时第一个版本不起作用？为什么它不抛出错误？

环境是 MSSQL SERVER 2008 R2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:11:57.597

代表以后必须维护您的代码的每个人，请不要这样做。

varchar 不起作用的原因是因为这相当于`varchar(1)`- 一个字符宽。话虽如此，如果您想允许检索所有内容或一个用户，请尝试以下操作：

```
DECLARE @Uid int
-- Get user id 300
SET @Uid = 300
-- Will match on 'User_ID = @Uid'
SELECT * FROM Items WHERE (User_ID = @Uid or @Uid is null) OPTION (RECOMPILE)
-- Get all users
SET @Uid = null
-- Will match on '@Uid is null'
SELECT * FROM Items WHERE (User_ID = @Uid or @Uid is null) OPTION (RECOMPILE) 
```

使用`LIKE`要求服务器将您要过滤的每一行都转换为字符串，然后进行字符串比较，几乎是强制进行表扫描。使用`=`with`is null`将导致处理器（希望）注意到`@Uid is null`计算结果与`true`行无关。

* * *

根据 Martin Smith 的建议，我最终对其进行了更多研究，并发现[MVP Erland Sommarskog 对该主题进行了更完整的讨论](http://www.sommarskog.se/dyn-search-2008.html)。长短，一定要包括`OPTION (RECOMPILE)`，以避免次优的计划选择。该建议有一些警告，我建议您阅读这篇文章以避免被他们抓住 - 我要修复一些表现不佳的搜索 SP...

# c# - requiredif 实体框架空字段

> ID：15032349
> 
> 赞同：1
> 
> 时间：2013-02-22T20:03:57.687
> 
> 标签：c#, .net, entity-framework

我正在使用 MVC 中的自定义验证来验证基于另一个字段的字段，我遇到了这个实现：

```
 public class RequiredIfAttribute : ValidationAttribute
    {
        private String PropertyName { get; set; }
        private String ErrorMessage { get; set; }
        private Object DesiredValue { get; set; }

        public RequiredIfAttribute(String propertyName, Object desiredvalue, String errormessage)
        {
            this.PropertyName = propertyName;
            this.DesiredValue = desiredvalue;
            this.ErrorMessage = errormessage;
        }

        protected override ValidationResult IsValid(object value, ValidationContext context)
        {
            Object instance = context.ObjectInstance;
            Type type = instance.GetType();
            Object proprtyvalue = type.GetProperty(PropertyName).GetValue(instance, null);
            if (proprtyvalue.ToString() == DesiredValue.ToString())
            {
                return new ValidationResult(ErrorMessage);
            }
            return ValidationResult.Success;
        }
    } 
```

我有一个简单的类定义如下：

```
public class Person
{
    public int PersonID { get; set; }
    public string name { set; get; }
    [RequiredIf("name","","Address is required")]
    public string addr { get; set; }
} 
```

当我运行该页面时，我收到一个`Object reference not set to an instance of an object.`错误，但更改该行以`[RequiredIf("name","John","Address is required")]`产生预期的结果。我的问题是，您如何使用它来检查该字段是否为空。

我也尝试将行更改为，`[RequiredIf("name",null,"Address is required")]`但我得到了同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:38:54.207

这似乎有效：

```
protected override ValidationResult IsValid(object value, ValidationContext context)
        {
            if (value != null) { return ValidationResult.Success; }

            Object instance = context.ObjectInstance;
            Type type = instance.GetType();
            Object proprtyvalue = type.GetProperty(PropertyName).GetValue(instance, null);
            if (proprtyvalue == null) {
               return new ValidationResult(ErrorMessage);
            }
            return ValidationResult.Success;
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:12:59.110

您没有发布您正在测试的实际 Person 实例，所以我只是猜测：在尝试调用 ToString() 之前确保**PropertyName的属性值不为空。**所以你的**Person.Name**不能为**null**！

# android - 不支持的操作异常

> ID：15032350
> 
> 赞同：0
> 
> 时间：2013-02-22T20:04:04.930
> 
> 标签：android, listview

我制作了从 sd 卡加载很多东西并在 Listview 中显示的列表视图。现在我正在尝试制作自定义列表视图适配器以使该列表视图看起来更好，但每次我都会收到此错误`02-22 20:54:21.411: E/AndroidRuntime(17273): java.lang.UnsupportedOperationException: addView(View, LayoutParams) is not supported in AdapterView` 这是我的 java 代码：

```
 musiclist = (ListView) findViewById(R.id.PhoneMusicList);
           musiclist.setAdapter(new MusicAdapter(getApplicationContext(), count, null));

    public class MusicAdapter extends BaseAdapter {
           private Context mContext;
           Context context; 
        int layoutResourceId;    
        ListView data[] = null;
           public MusicAdapter(Context context, int layoutResourceId, ListView data[]){
               super();
               mContext = context;

                this.layoutResourceId = layoutResourceId;
                this.context = context;
                this.data = data;
           }

           public int getCount() {
                 return count;
           }

           public Object getItem(int position) {
                 return position;
           }

           public long getItemId(int position) {
                 return position;
           }

           public View getView(int position, View convertView, ViewGroup parent) {
               View row = convertView;
               ListViewHolder holder = null ;

                 String id = null;
               if(row == null)
            {
                   LayoutInflater inflater = getLayoutInflater();
                row = inflater.inflate(R.layout.listview_item_row, parent);
             holder = new ListViewHolder();
                       music_column_index = musiccursor
.getColumnIndexOrThrow(MediaStore.Audio.Media.DISPLAY_NAME);
                       musiccursor.moveToPosition(position);
                       id = musiccursor.getString(music_column_index);
                       music_column_index = musiccursor
.getColumnIndexOrThrow(MediaStore.Audio.Media.SIZE);
                       musiccursor.moveToPosition(position);
                       id += musiccursor.getString(music_column_index);
                      row.setTag(holder);
                      holder.txtTitle.setText(id);
                      holder.imgIcon.setImageResource(R.drawable.music);
                      holder.imgIcon = (ImageView)row.findViewById(R.id.imgIcon);
                    holder.txtTitle = (TextView)row.findViewById(R.id.txtTitle);
                 } else {
                       holder = (ListViewHolder)row.getTag();
                 }
               holder.txtTitle.setText(id);
               holder.imgIcon.setImageResource(R.drawable.music);
                 return row;

           }

        }
     static class ListViewHolder
        {
            ImageView imgIcon;
            TextView txtTitle;
 }
} 
```

主.xml：

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
          android:orientation="vertical" android:layout_width="fill_parent"
          android:layout_height="fill_parent">

        <ListView
            android:id="@+id/PhoneMusicList"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            >
        </ListView>

    </LinearLayout> 
```

列表视图行

```
 <ImageView android:id="@+id/imgIcon"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:gravity="center_vertical"
            android:layout_alignParentTop="true"
            android:layout_alignParentBottom="true"
            android:layout_marginRight="15dp"
            android:layout_marginTop="5dp"
            android:layout_marginBottom="5dp" />

         <TextView android:id="@+id/txtTitle"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:gravity="center_vertical"
            android:layout_alignParentTop="true"
            android:layout_alignParentBottom="true"
            android:textStyle="bold"
            android:textSize="22dp"
            android:textColor="#000000"
            android:layout_marginTop="5dp"
            android:layout_marginBottom="5dp" />

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:14:57.330

你不能像这样夸大你的视图：

`row = inflater.inflate(R.layout.listview_item_row, parent);`

相反，您应该：

`row = inflater.inflate(R.layout.listview_item_row, parent, false);`

这将告诉`parent`，在这种情况下`ListView`，不要附加孩子。

# jquery - 如何排除 在 html 中不受 jquery 动画的影响？

> ID：15032353
> 
> 赞同：-2
> 
> 时间：2013-02-22T20:04:10.600
> 
> 标签：jquery

就像标题说的那样，我需要排除 a 受到 jquery 脚本的影响

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:01:38.517

我在 JQuery 方面没有太多经验，所以有人可能会想出比我更好的答案，但是针对这篇文章的标题，您可以将不希望受到影响的标签更改为另一个标签，例如 or 。另一种解决方案是为您确实希望受 jquery 影响的用户提供一个可由脚本调用的 id。在涉及网站时，仅调用标签过于模糊。

我希望这会有所帮助。不过，我可能完全错过了这个问题。值得一试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:27:06.587

您应该阅读 jQuery 插件创作的入门部分。它解释了你的插件范围： http: [//docs.jquery.com/Plugins/Authoring#Getting_Started](http://docs.jquery.com/Plugins/Authoring#Getting_Started)

此外，请确保您使用适当的命名空间：[http ://docs.jquery.com/Plugins/Authoring#Namespacing](http://docs.jquery.com/Plugins/Authoring#Namespacing)

最后，您可以依靠 noConflict： [http ://docs.jquery.com/Using_jQuery_with_Other_Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)

# math - 括号结合加法

> ID：15032360
> 
> 赞同：5
> 
> 时间：2013-02-22T20:04:56.503
> 
> 标签：math, combinations, catalan

我有一个有趣的组合问题，我有点卡住了

让我们定义一个函数 p(xn)，它返回方程 x 的 '()' 的数量 现在 x 只能是 x1 + x2 + x3 ... xn 这个函数定义为 n >=2

例子：

P(x2) = (x1 + x2) = 1

p(x3) = ((x1 + x2) + x3) 和 (x1 + (x2 + x3))

p(x4) =

((x1 + x2) + (x3 + x4))

((((x1 + x2) + x3) + x4)

((x1 + (x2 + x3)) + x4)

(x1 + ((x2 + x3) + x4))

(x1 + (x2 + (x3 + x4)))

等等 注意 (x1 + (x2 + x3) + x4) 不是一个有效的例子，每个 + 必须有一个 ()

现在，我试图想出一个 P 的公式来确定组合的数量我不确定是否有一个固定的公式或依赖于其先前术语的递归定义。各位大佬能帮我看看公式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T01:13:03.390

基本上，您正在寻找唯一的二叉表达式树的数量，其中节点是求和，叶子是 x [1]到 x [n]。我们称这个数为 P(n)。

您可以选择任何 n-1 个求和作为根节点。让我们选择第 k 个求和。根的左边有 k 个变量，所以你可以用 P(k) 的方式组织左子树。右边有 nk 个变量，所以右子树可以用 P(nk) 种方式组织。因此，总的来说，您可以以 P(k)P(nk) 不同的方式组织树。

由于您可以从 1 到 n-1 自由选择 k，因此您可以用 n 个叶子组织表达式树的总数为：

```
P(n) = P(1)P(n-1) + P(2)P(n-2) + ··· + P(n-2)P(2) + P(n-1)P(1) 
```

正如@DSM 在评论中指出的那样，这种递归关系生成了加泰罗尼亚数字。有一个封闭形式的解决方案，但从递归公式推导出来有点棘手。[您可以在加泰罗尼亚数字的 Wikipedia 文章中](http://en.wikipedia.org/wiki/Catalan_number)找到该公式的几个证明。解决方案是：

```
P(n) = C(2n,n)/(n+1)                where C(n,k) = n! / (k!(n-k)!) 
```

# perl - 什么是 HTML MS Excel 文件的好 CPAN 解析器？

> ID：15032365
> 
> 赞同：3
> 
> 时间：2013-02-22T20:05:02.490
> 
> 标签：perl, parsing, html-parsing, excel

我知道常规（二进制）Excel 文件可以通过`Spreadsheet::ParseExcel`.

但是，我有一个 HTML 格式的文件：

```
<html xmlns:x="urn:schemas-microsoft-com:office:excel">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1252">
<!--[if gte mso 9]>
<xml>
<x:ExcelWorkbook>
<x:ExcelWorksheets>
<x:ExcelWorksheet>
<x:Name>Holdings</x:Name>
<x:WorksheetOptions> 
```

除了手动将其解析为通用 HTML 文件（例如 TreeBuilder 等）之外，是否有一个 CPAN 模块可以解析并让我以电子表格的形式访问这样的文件，类似于 `Spreadsheet::ParseExcel`？

这是模块不起作用的地方：

```
#!/usr/local/bin/perl
use strict; use warnings;
use Spreadsheet::ParseExcel;
my $parser   = Spreadsheet::ParseExcel->new();
my $file     = 'file1.xls';
my $workbook;
eval {$workbook   = $parser->Parse($file);}; 
#($Workbook returned here is ‘undef’) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:42:34.800

我使用 XPath 解析器从这样的文件中提取我需要的内容，在`./Cell/Data`节点内部的`//Row`节点上进行迭代，但这与使用的接口不同`Spreadsheet::ParseExcel`。

我还发现您需要先进行一些源过滤，然后才能使用 XML 解析器。至少你必须运行

```
s/<xml version>/<!-- xml version -->/;
s/&/&amp;/g 
```

在输入上。

* * *

这是一个简洁但完整的解决方案，将这样的文件提取到二维数组中：

```
use XML::XPath;
open F, '<', $dirty_file_name;
open G, '>', $clean_file_name;
while(<F>) { 
    s/<xml version>/<!-- xml version -->/;
    s/&/&amp;/g;
    print G
}
close G;
close F;

@table = map { [ map { $_->string_value } $_->find('./Cell/Data')->get_nodelist ]
  } XML::XPath->new( filename => $clean_file_name )->find('//Row')->get_nodelist; 
```

# ruby-on-rails-3 - 在 html 页面中预览/嵌入文件的聪明方法是什么？

> ID：15032366
> 
> 赞同：1
> 
> 时间：2013-02-22T20:05:02.957
> 
> 标签：ruby-on-rails-3, file, dropbox, box-api

在我的应用程序 (Rails) 中，用户可以参考 Box.com 上托管的文件（主要是文档、pdf、ppts 和图像）。我想嵌入文件，以便可以在我的应用程序中预览它们，而无需将用户重定向到 Box。

不幸的是，Box API 似乎不再提供嵌入方法（Box API V1`get_embed_code`方法用于返回嵌入代码以在 Flash 中显示文件）。所以在这一点上，如果我继续使用 Box，我只能让用户下载文件或将他们重定向到文件的共享链接，这对于我的用例来说是无法接受的。

如何使用 Box 或其他服务实现我正在寻找的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T06:29:04.447

对于图像文件，您可以获得最大 256x256 的缩略图：http: [//developers.box.com/docs/#files-get-a-thumbnail-for-a-file](http://developers.box.com/docs/#files-get-a-thumbnail-for-a-file)

对于办公文档，我们还没有对 V2 中可用的文档进行预览是正确的。我之前用[Crocodoc](http://crocodoc.com)生成 Office 文档的 HTML5 预览，非常满意。

# php - Modrewrite 没有发送 $_GET 参数

> ID：15032386
> 
> 赞同：0
> 
> 时间：2013-02-22T20:06:39.700
> 
> 标签：php, .htaccess, url-rewriting, get

我正在尝试重写我的网址：

```
RewriteEngine On
RewriteBase /

RewriteRule ^help/(.+)/(.+) help.php?helpid=$2
RewriteRule ^city/(.+)/(.+) city.php?cityid=$2 
```

甚至该 url 包含预期的格式：[http ://example.com/help/the-irelevant-title/5/](http://example.com/help/the-irelevant-title/5/)

看起来

`isset($_GET['helpid']))``false`总会开火`help.php`

通常这个系统对我有用。我在这里缺少什么吗？

-编辑-

正如我所看到的，这应该有效（或至少你们中的一个人回答）我正在为问题添加更多代码：

**完整的 .htaccess 内容**

```
RewriteEngine On

ErrorDocument 500 /oohps.php
ErrorDocument 404 /oohps.php

RewriteCond %{HTTP_HOST} ^www.example.com [NC]
RewriteRule ^(.*)$ http://example.com/$1 [L,R=301]

RewriteBase /

RewriteRule ^help/([^/]+)/([^/]+) help.php?helpid=$2 [QSA]
RewriteRule ^city/([^/]+)/([^/]+) city.php?cityid=$2 [QSA]

RewriteRule ^login$ login.php 
```

**help.php 的开始**

```
session_start();
error_reporting(E_ALL);
ini_set('display_errors', '1');
$_GET['noseo'] = true;
include('htmlhead.php');
/* Leemos la id del grupo*/
$selected;
if(isset($_GET['helpid'])){
    $selected = $_GET['helpid'];
}else {
    echo '<script>alert("Modrewrite fails. Id is missing, id: '.$_GET['helpid'].'");location.href = "/"</script>';   /* Allways returns this*/
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:10:22.953

正则表达式过于贪婪，第一个`.+`匹配斜线也导致正则表达式的其余部分失败。正`[^/]+`则表达式将匹配除斜杠之外的任何内容。

```
RewriteRule ^help/([^/]+)/([^/]+) help.php?helpid=$2
RewriteRule ^city/([^/]+)/([^/]+) city.php?cityid=$2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:09:06.937

使用`[QSA]`应该可以转发 GET 参数。此外，将`.+`（贪婪）更改为`[^/]+`（意味着不是斜线重复 1 次或多次的任何字符），它应该可以解决您的问题。

```
RewriteRule ^help/([^/]+)/([^/]+) help.php?helpid=$2 [QSA]
RewriteRule ^city/([^/]+)/([^/]+) city.php?cityid=$2 [QSA] 
```

也可以简写为：

```
RewriteRule ^(help|city)/([^/]+)/([^/]+) $1.php?$1id=$3 [QSA] 
```

[从 apache 手册](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_qsa)：

> 当替换 URI 包含查询字符串时，RewriteRule 的默认行为是丢弃现有的查询字符串，并将其替换为新生成的查询字符串。使用 [QSA] 标志会合并查询字符串。
> 
> 考虑以下规则：
> 
> RewriteRule /pages/(.+) /page.php?page=$1 [QSA]
> 
> 使用 [QSA] 标志，对 /pages/123?one=two 的请求将被映射到 /page.php?page=123&one=two。如果没有 [QSA] 标志，相同的请求将被映射到 /page.php?page=123 - 也就是说，现有的查询字符串将被丢弃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:08:26.813

你有两个变量是有原因的吗？这虽然有效：

```
RewriteEngine On
RewriteBase /    
RewriteRule ^help/([^/\.]+)/([^/\.]+)/?$ help.php?helpid=$2 [L]
RewriteRule ^city/([^/\.]+)/([^/\.]+)/?$ city.php?cityid=$2 [L] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-25T05:02:32.713

您可以在根目录的 .htaccess 文件中尝试此操作：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  ^/([^/]+)/[^/]+/([^/]+)/?  [NC]
RewriteRule .*              %1.php?%1id=%2             [L] 
```

重定向

`http://domain.com/par1/anything/par2`带或不带斜杠

至

`http://domain.com/par1.php?par1id=par2`

Strings`par1`和假定是动态的`anything`，`par2`根据问题中的示例， 它是 PHP 脚本的名称，也是重定向查询中名称`par1`的第一部分。`key`

`par1`=**帮助**时的示例：

重定向：

`http://domain.com/help/the-irelevant-title/5/`

至：

`http://domain.com/help.php?helpid=5`

对于永久重定向，替换`[L]`为`[R=301,L]`

* * *

虽然我没有测试其他规则并且不知道它们是否按预期工作，但问题中的 .htaccess 文件应该像这样修改，以在这个答案中包含规则集：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
ErrorDocument 500 /oohps.php
ErrorDocument 404 /oohps.php

RewriteCond %{HTTP_HOST} ^www.domain.com [NC]
RewriteRule ^(.*)$ http://domain.com/$1 [L,R=301]

RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  ^/([^/]+)/[^/]+/([^/]+)/?  [NC]
RewriteRule .*              %1.php?%1id=%2             [L]

# Next line is a suggested addition to prevent loops.
RewriteCond %{REQUEST_URI}  !login\.php [NC]
RewriteRule ^login$   login.php         [L] 
```

# mysql - SUM() 用于相关表中的多个值

> ID：15032392
> 
> 赞同：0
> 
> 时间：2013-02-22T20:07:29.733
> 
> 标签：mysql, database-design

我在 MySQL 数据库中有三个相关的表：

*   inventory_items 定义仓库中的项目类型
*   inventory_transactions 定义添加或删除的库存数量
*   位置定义所述库存的位置

Inventory_transactions 有一个 quantity_offset，用于存储从给定位置添加或删除了多少给定 inventory_item。

我有以下查询，它将获取 global_quantity（给定 inventory_item_id 的所有数量偏移的总和）以及 location_quantity，只要我知道位置 ID，它对特定位置执行相同操作。

```
SELECT sku, name, SUM(quantity_offset) AS global_quantity,
(
SELECT SUM(quantity_offset)
    FROM inventory_transactions
    WHERE inventory_items.inventory_item_id = inventory_transactions.inventory_item_id AND inventory_transactions.location_id = 1
) AS location_quantity
FROM inventory_items
JOIN inventory_transactions ON inventory_items.inventory_item_id = inventory_transactions.inventory_item_id
GROUP BY sku 
```

我想要结束的是为每个位置添加一列，因此结果可能具有如下值：

```
sku, name, global_quantity, denver_quantity, dallas_quantity, ft_wayne_quantity 
```

我的后备方案是在单个inventory_item 页面上执行此操作（当我知道库存项目并可以按位置分组时），但是能够在单个查询中执行此操作并将其全部放入一个表中会非常棒。

最初，我以为我可以遍历子查询，但无法以编程方式设置列名（在 AS 中）。

提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:25:38.687

顺便说一句，如果行来自给定位置，则可以在有条件地返回 quantity_offset 的表达式上使用 SUM 聚合获得相同的结果，而不是在 SELECT 列表中使用子查询。我还将使用 LEFT 外连接到 inventory_transactions 表，这样我就可以确保为 inventory_items 中的每一行返回一行：

```
SELECT i.sku
     , i.name
     , SUM(t.quantity_offset) AS global_quantity
     , SUM(IF(t.location_id = 1,t.quantity_offset,NULL)) AS location_1_quantity 
  FROM inventory_items i
  LEFT
  JOIN inventory_transactions t ON i.inventory_item_id = t.inventory_item_id
  GROUP BY i.sku 
```

（这并不能回答你的问题，但我想让你意识到这一点。）

要回答您的问题，首先，SELECT 语句不可能动态更改它在结果集中返回的列的数量或类型。您需要为要返回的每一列定义一个表达式。（SQL SELECT 语句文本的生成可以动态完成，以生成特定的 SELECT 语句，但该 SELECT 语句返回的列由 SELECT 语句固定。）

如果我有一组相对固定的 location_id 值，并且我需要您指定的结果集，我将多次重复条件表达式的 SUM，对于每个位置或我想要的任何位置集一次：

```
SELECT i.sku
     , i.name
     , SUM(t.quantity_offset) AS global_quantity
     , SUM(IF(t.location_id = 1,t.quantity_offset,NULL)) AS location_1_quantity 
     , SUM(IF(t.location_id = 2,t.quantity_offset,NULL)) AS location_2_quantity 
     , SUM(IF(t.location_id = 3,t.quantity_offset,NULL)) AS location_3_quantity 
     , SUM(IF(t.location_id IN (1,2,3),t.quantity_offset,NULL)) AS location_123_quantity 
     , SUM(IF(t.location_id = 4,t.quantity_offset,NULL)) AS location_4_quantity
  FROM inventory_items i
  LEFT
  JOIN inventory_transactions t ON i.inventory_item_id = t.inventory_item_id
  GROUP BY i.sku 
```

如果要返回的列集需要真正动态，那么我根本不会将它们作为列返回。相反，我会将每个位置的 SUM(quantity_offset) 作为单独的行返回，然后在客户端将转换处理为按列表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:25:57.703

您应该使用条件和 - 这是我所知道的最有效的方式（最快的查询）：

```
SELECT sku, name, SUM(quantity_offset) AS global_quantity,
  sum(case when inventory_transactions.location_id = 1 then quantity_offset else 0 end) as  loc1_quantitity,
  sum(case when inventory_transactions.location_id = 2 then quantity_offset else 0 end) as loc2_quantitity,
  sum(case when inventory_transactions.location_id = 3 then quantity_offset else 0 end) as loc3_quantitity
FROM inventory_items JOIN inventory_transactions ON inventory_items.inventory_item_id = inventory_transactions.inventory_item_id
GROUP BY sku 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:12:54.657

试试这个

```
 SELECT sku, name, SUM(quantity_offset) AS global_quantity,
       (
        SELECT SUM(quantity_offset)
         FROM inventory_transactions
           WHERE inventory_items.inventory_item_id = inventory_transactions.inventory_item_id AND inventory_transactions.location_id = 1
          AND location = denver) AS denver_quantity ,
        (
        SELECT SUM(quantity_offset)
         FROM inventory_transactions
           WHERE inventory_items.inventory_item_id = inventory_transactions.inventory_item_id AND inventory_transactions.location_id = 1
          AND location = dallas) AS dallas_quantity,
         (
        SELECT SUM(quantity_offset)
         FROM inventory_transactions
           WHERE inventory_items.inventory_item_id = inventory_transactions.inventory_item_id AND inventory_transactions.location_id = 1
          AND location = ft_wayne) AS ft_wayne_quantity
   FROM inventory_items
   JOIN inventory_transactions ON inventory_items.inventory_item_id = inventory_transactions.inventory_item_id
   GROUP BY sku 
```

请注意，我用作`location`列名我不知道您拥有的位置的列名，只需替换它

# javascript - 当显示最后一个孩子时，如何让点击功能停止工作？

> ID：15032398
> 
> 赞同：0
> 
> 时间：2013-02-22T20:07:50.597
> 
> 标签：javascript, jquery

这是 html，pages-nr 有一个固定的宽度，带有一个 overflow:hidden ：

```
<div class="pages-scroll">
    <div class="pages-rightarrow"></div>
    <div class="articles-pages">
       <div class="pages-nr">
            <a href="javascript:void(0)">1</a>                          
            <a href="javascript:void(0)">2</a>
            <a href="javascript:void(0)">3</a>
            <a href="javascript:void(0)">4</a>
            <a href="javascript:void(0)">5</a>
            <a href="javascript:void(0)">6</a>
            <a href="javascript:void(0)">7</a>
            <a href="javascript:void(0)">8</a>
       </div>
     </div> 
     <div class="pages-leftarrow"></div>
</div> 
```

这是我到目前为止写的脚本，我不知道要问什么“如果”这样做，当我到达最后一个 div 或第一个 div 时，箭头将被隐藏。

```
$('.pages-leftarrow').click(function () {
    if ( $('.pages-nr a').hasClass('????') ) {
        $('.pages-rightarrow').hide();
    }
    else {
        $('.pages-nr').css({"margin-left": function(index, value) {
            return parseFloat(value) - 44}
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:48:59.170

这是 jsFiddle： http: [//jsfiddle.net/Na3W7/4/](http://jsfiddle.net/Na3W7/4/) 这是启动时运行的代码的核心：

```
$('.pages-nr a:not(:first),.pages-leftarrow').hide();
$('.pages-rightarrow').click(function(e){
    e.preventDefault();
    var $nextPage = $('.pages-nr a:visible:first').hide().next().show();
    if($nextPage.is('.pages-nr a:last-child')){
        $(e.target).hide();
    }
    if($('.pages-nr a:first').is(':visible')) {
        $('.pages-leftarrow').hide();
    }
    else {
        $('.pages-leftarrow').show();
    }

});
$('.pages-leftarrow').click(function(e){
    e.preventDefault();
    var $prevPage = $('.pages-nr a:visible:first').hide().prev().show();
    if($prevPage.is('.pages-nr a:first-child')){
        $(e.target).hide();
    }
    if($('.pages-nr a:last').is(':visible')) {
        $('.pages-rightarrow').hide();
    }
    else {
        $('.pages-rightarrow').show();
    }

}); 
```

# javascript - 脚本更改图片。在完成的代码中

> ID：15032400
> 
> 赞同：1
> 
> 时间：2013-02-22T20:07:51.780
> 
> 标签：javascript, jquery, gallery, preloader

**你好！** 如何制作非常简单的动画。**在这段代码中？** 例如，图片每 5 秒改变一次。

现在我只做了一个。必然需要一个预加载器。

**这是原始文章。** [http://www.htmldrive.net/items/show/1080/jQuery-useful-preload-image-effect](http://www.htmldrive.net/items/show/1080/jQuery-useful-preload-image-effect)

我删除了所有不必要的。我只留下了预加载器和加载图片“script.js”。同样在网站上，我只有“javascript & jquery”。我删除了： [https ://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js](https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js)

**我会很感激你的帮助。** 谢谢。

```
 #img_url{
    border: 0 none;
    height: 44px;
    width: 614px;
    vertical-align: top;
    margin-right: 0;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    background-repeat: no-repeat;
}
#load_img{
    border: 0 none;
    color: #363636;
    font-weight: bold;
    height: 33px;
    text-shadow: 0 1px 0 #C5C4C4;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    cursor: pointer;
    background-attachment: scroll;
    background-color: #1F8BCC;
    background-image: none;
    background-repeat: no-repeat;
    background-position: 0 0;
}
#image_content{
    width: 614px;
    height: 944px;
    text-align: center;
    overflow: hidden;
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
    position: absolute;
    left: -7px;
    top: 66px;
}
#img_holder{
    height:944px;
    width:614px;
    margin:0 auto;
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
}
#img_holder img{
    max-width: 614px;
    max-height: 944px;
}
.loadit{background:url("/images/ajaxload.gif") no-repeat scroll center center transparent;}
.credit{font-size:12px;} 
```

下一个博迪

```
 <div id="image_content">
<div id="img_holder" class="loadit"></div>
<div id="img_url" class=""></div>
</div> 
```

和 JAVA

```
$(function(){
    LoadImage();
    $("#load_img").click(function(){
        $("#current_img").remove();
        $('#img_holder').addClass('loadit');
        LoadImage();
    });
    function LoadImage(){
        var img_url = $("#img_url").val();
        if(img_url == ''){
            img_url = "images/01.png";
        }
        var img = new Image();
        $(img).load(function(){
            $(this).hide();
            $('#img_holder').removeClass('loadit').append(img);
            $(img).fadeIn();

        }).attr('src',img_url).attr('id','current_img');
    }
}); 
```

**有这样的代码。如何制作不断变化的图像？** 预加载和下一个播放图像：

> `"images/01.png", "images/02.png";`

我想我们在谈论不同的事情......再次感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:30:42.847

要在特定间隔检查中进行函数调用：http: [//www.w3schools.com/jsref/met_win_setinterval.asp](http://www.w3schools.com/jsref/met_win_setinterval.asp)

构建一个方法，加载一个 img 并在图像加载完成时显示它。

```
threadID = setInterval(LoadImage, 3000);  //Calls your method every 3 seconds. 
```

使用 clearInterval 您可以停止此操作。

```
clearInterval(threadID); 
```

例如

```
$(document).ready( function () {
   var threadID = setInterval(loadAndDisplayImage, 5000);

   $('button#stop').click(function() {
      clearInterval(threadID);
   });
});

function loadAndDisplayImage() {
   //Code to load and display image;
} 
```

希望我这有帮助。

//编辑：

如果您像这样存储图像：

图像 1 图像 2 图像 3

你可以这样做：

```
var imageCounter = 0; //imagecounter in global scope
var imageBaseUrl = "http://yourfilehost/image-";
function loadAndDisplayImage() {
    var image = new Image();
    image.onload = displayOnLoad; //function that displays your images;
    image.src = imageBaseUrl + imageCounter ++ ;

    //maybe set up limit
    if(imageCounter >= 5){
        imageCounter = 0;
    } 
} 
```

# ios - iOS GameKit 无法通过蓝牙连接

> ID：15032409
> 
> 赞同：0
> 
> 时间：2013-02-22T20:08:37.327
> 
> 标签：ios, objective-c, bluetooth, gamekit

我正在尝试在 2 台设备之间连接，iOS 模拟器和 iPhone 设备。

```
_picker = [[GKPeerPickerController alloc] init];
_picker.delegate = self;
_picker.connectionTypesMask = GKPeerPickerConnectionTypeNearby; 
```

出于某种原因，设备只能通过 wifi 发现彼此。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:37:40.017

模拟器不适用于蓝牙，尝试使用 2 个设备，应该可以工作..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:11:37.900

您是否尝试过使用[CoreBluetooth](http://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html)框架？

模拟器中还支持 CoreBluetooth（通过连接外部蓝牙 LE USB 加密狗）。

正如@David 所说，模拟器可能不支持 Gamekit 的蓝牙。

# html - 解析 HTML 页面

> ID：15032411
> 
> 赞同：1
> 
> 时间：2013-02-22T20:08:47.157
> 
> 标签：html, vb.net

所以，我有一个 html 页面，在这个 HTML 的一个节点中，我有一个名为 src 的属性，这个属性是一个链接……我怎样才能得到这个链接？

我的意思是说：

```
<img border='0' id='image' src='/scripts/image/Telerik.Web.UI.WebResource.axd?type=rca&amp;guid=82ca2bae-12b2-441b-b6fa-56c315c935ae'> 
```

属性 src 是一个链接，我怎样才能得到那个链接？我得到了 src 字符串，但是，没有链接......为了得到 src 字符串，我做了这个：

```
 If doc.Body.InnerHtml.Contains("image") Then
        MessageBox.Show(doc.GetElementById("image").GetAttribute("src"))
    End If 
```

所以，'/scripts/image/Telerik.Web.UI.WebResource.axd?type=rca&guid=82ca2bae-12b2-441b-b6fa-56c315c935ae'是一个链接......

['/scripts/image/Telerik.Web.UI.WebResource.axd?type=rca&guid=82ca2bae-12b2-441b-b6fa-56c315c935ae'](http://www.google.com.br/%22getThisLink%22) <- 像这样，undersantd？我只是想得到这个链接....（hiperlink）

那么，我怎样才能获得链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T14:36:45.657

尝试这个：

```
document.getElementsById('elementID').src 
```

请检查[test.html](http://www.eslamifar.com/download/stackoverflow/15032411/test.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-22T21:31:16.567

如果您使用 jQuery，您可以使用**.attr()**和**.text()**来获取图像的 src 并将结果作为文本输出到 div （或其他）。看到这个 jFiddle：http: [//jsfiddle.net/wWpT9/](http://jsfiddle.net/wWpT9/)

HTML：

```
<img src="path-to-your-image/photo.jpg" />
<div id="result"></div> 
```

jQuery：

```
var src = $("img").attr("src");
$("#result").text(src); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-22T20:16:18.227

如果我正确理解您的问题，您想获取图像标签的 src 值是吗？然后你可以像这样使用jquery

```
var i = $('#image').attr('src'); 
```

# java - ThreadPoolExecutor ：任务正在排队并且未提交

> ID：15032412
> 
> 赞同：12
> 
> 时间：2013-02-22T20:08:53.620
> 
> 标签：java, threadpoolexecutor

我们有一个场景，提交给 ThreadPoolExecutor 的任务长时间运行。当线程池启动时，我们以核心池大小 = 5、最大池大小 = 20 和队列大小 10 启动它。在我们的应用程序中，大约有 10 个任务被提交。大多数情况下，这些任务运行几分钟/小时，然后完成。然而，有一种情况是所有 5 个任务都挂在 I/O 上。结果，我的核心池大小达到了最大值，但我的 Threadpoolexecutor 队列未满。所以额外的 5 个任务永远没有机会运行。请建议我们如何处理这种情况？在这种情况下有一个较小的队列更好的选择吗？初始化线程池时，最佳队列大小是多少？

另外关于挂起的任务，有什么办法可以将线程从线程池中拉出来？在这种情况下，至少其他任务将有机会运行。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-22T20:18:07.950

总体情况是这样的：

```
core pool size = 5,
max pool size = 20 and 
queue size of 10 
```

提交了 10 个任务。其中有

1.  5 个任务挂在 I/O => 核心池大小的所有线程都被占用。因此没有空闲线程。
2.  剩下5个任务。这 5 个线程被排入队列，因为没有空闲线程并且队列可以容纳 10 个任务。在队列已满或核心池中的任何线程空闲之前，这些排队的任务将不会执行。

因此，您的程序被挂起。

[**在这里**](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)了解更多关于`ThreadPoolExecutor`手表动态的信息。该文档的要点如下：[](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)

 ***   如果运行的线程少于 corePoolSize，则 Executor 总是更喜欢添加新线程而不是排队。
*   如果 corePoolSize 或更多线程正在运行，Executor 总是更喜欢排队请求而不是添加新线程。
*   如果请求无法排队，则会创建一个新线程，除非这将超过 maximumPoolSize，在这种情况下，该任务将被拒绝。

**编辑**
如果您希望增加核心池大小，则可以使用**[setCorePoolSize(int corePoolSize)](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#setCorePoolSize%28int%29)**。如果您增加`corepoolsize`新的线程，则将在需要时启动以执行任何排队的任务。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-22T20:19:06.260

ThreadPoolExecutor的[Javadocs](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html)指出：

任何 BlockingQueue 都可以用来传输和保存提交的任务。此队列的使用与池大小交互：

*   如果运行的线程少于 corePoolSize，则 Executor 总是更喜欢添加新线程而不是排队。
*   如果 corePoolSize 或更多线程正在运行，Executor 总是更喜欢排队请求而不是添加新线程。
*   如果请求无法排队，则会创建一个新线程，除非这将超过 maximumPoolSize，在这种情况下，该任务将被拒绝。

除非在 5 个线程“挂起”后超过队列大小，否则您不会获得更多线程。

真正的答案是：解决导致线程挂起的问题。否则，如果线程运行时间过长，您将不得不实现一些使用`Future`返回的 s来取消线程的方案。`submit()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-05T04:57:42.400

我认为另一种方法是根据队列中等待的任务数设置 corePoolSize 。可以使用 setCorePoolSize 控制 corePoolSize。一个示例监视器线程可以控制您的 threadPoolExecutor。您还可以改进此监视器以调整并行度。

```
 public class ExecutorMonitor extends Thread{

            ThreadPoolExecutor executor = null;
            int initialCorePoolSize;
            public ExecutorMonitor(ThreadPoolExecutor executor)
            {
                this.executor = executor;
                this.initialCorePoolSize = executor.getCorePoolSize();
            }
            @Override
            public void run()
            {
                while (true)
                {   
                    try {
                        Thread.sleep(5000);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                    if (executor.getQueue().size() > 0)
                    {
                        if(executor.getActiveCount() < executor.getMaximumPoolSize())
                            executor.setCorePoolSize(executor.getCorePoolSize() + 1);
                    }
                    if (executor.getQueue().size() == 0)
                    {
                        if(executor.getCorePoolSize() > initialCorePoolSize)
                            executor.setCorePoolSize(executor.getCorePoolSize() -1);
                    }
                }
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T20:24:37.587

jdk 中“可变”大小的线程池功能有点棘手。基本上，由于您概述的原因，您使用的设置不会很好地工作。当我想要一个可变大小的线程池时，我通常使用这个设置：

```
 ThreadPoolExecutor executor = new ThreadPoolExecutor(maxPoolSize, maxPoolSize,
                                                         DEFAULT_THREAD_TIMEOUT, DEFAULT_THREAD_TIMEOUT_UNIT,
                                                         new LinkedBlockingQueue<Runnable>(),
                                                         threadFactory);
    executor.allowCoreThreadTimeOut(true); 
```

这将创建一个可变大小的线程池，该线程池将在 1 和 maxPoolSize 线程之间变化。由于核心大小与最大大小相同，因此池将始终更喜欢添加线程而不是排队，因此在线程数达到最大值之前您永远不会备份队列。

更新：至于您的挂起任务问题，如果任务的长度有上限，您可以让单独的经理跟踪未完成的 Future 并在它们超过最大运行时间时取消它们。当然，这假设您的任务是可中断的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-13T14:16:21.347

根本问题是用户确实获得了具有无限队列场景的 CORE_POOL_SIZE 线程。因此，如果核心池中有 5 个线程是他可以使用的全部，那么 max size 无济于事。虽然在所有情况下都建议减少线程执行时间，但在生产场景中，我们通常无法控制第三方服务的行为方式，因此解决方案是将核心池大小增加到等于最大池大小或限制队列大小.

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2013-10-10T11:19:17.983

我想最好的解决方案是覆盖 ThreadPoolExecutor 的执行方法并引入其中的更改。**

# android - 如何在多行上方浮动文本视图

> ID：15032414
> 
> 赞同：1
> 
> 时间：2013-02-22T20:08:54.473
> 
> 标签：android, android-layout

我必须做一个包含行的 24 小时列表。每行代表一个小时。

例如：我在早上 6 点到 10 点有一个活动。我需要一个对象来覆盖这段时间（早上 6 点 - 上午 10 点）。如图所示：

[http://img824.imageshack.us/img824/6190/20130221192829.png](http://img824.imageshack.us/img824/6190/20130221192829.png)

我想知道我该怎么做以及我应该使用什么布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:18:21.860

我会使用 24 行的 ListView，每小时一个，并编写一个自定义适配器来根据您要突出显示的时间段绘制小时背景。
在适配器中，如果小时适合时间段，您只需让 getView 函数更改行布局背景颜色。

在这里你有很好[的 ListViews 和 Adapters教程](http://docs.xamarin.com/guides/android/user_interface/working_with_listviews_and_adapters)

如果您需要能够标记部分小时，假设 15 分钟间隔，您可以使用这样的自定义行布局：

![在此处输入图像描述](../Images/b3896d5cb5fba85459b46c391c832834.png)

您在左侧有一个小时的 TextView 占位符，间隔 15 分钟的 4 个 textViews，（为其背景着色）和一个具有透明背景的重叠以放置文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:44:38.370

另一种解决方案是在滚动视图中简单地使用线性布局，它不像 ListView 那样巧妙的内存消耗，因为所有内容都已加载，但由于您限制了将显示的条目数量，因此您可以确定多少内存它需要全部加载。

LinearLayout / ScrollView 组合的最大优势是您可以控制布局，而不受限于将其放入一系列行中。它也比 ListView / Adapter 组合更容易理解，因此应该更容易实现。

编辑：

想一想，LinearLayout 可能不是最好的，因为它不允许单个视图重叠多个小时，使用 RelativeLayout 或 TableLayout 可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T01:51:44.440

我使用 ListView 解决了。首先，我必须获取数据库信息并将其保存在游标中。然后，我创建了一个带有 arrayList 的个性化适配器，其中包含一个活动/事件，其中保存了 id 和活动/事件描述。每个arrayList 位置代表一个小时。游标包含“初始时间”和“最后时间”如果游标包含数字 03 作为初始时间，并且包含数字 08 作为最后时间，那么： -我必须使用从开始到 03 的空值来完成 arrayList。在那方式，前 3 小时将是 arrayList 的前三个位置 - 然后我必须在初始时间和最后一小时之间做减法器，因为我需要知道该活动/事件中有多少 arrayList 位置。- 在 arrayList 的第四个位置，我将活动/事件与 id 和描述放在一起。- 然后，在下一个位置，我必须放置一个带有 id 且没有描述许多行和减法结果的活动/事件。最后，我在个性化适配器中收起了arraylist。我很感激你的帮助。！非常感谢！问候，何塞。

# maven - 使用 nsis-maven-plugin 填充 VIProductVersion

> ID：15032423
> 
> 赞同：0
> 
> 时间：2013-02-22T20:09:37.823
> 
> 标签：maven, nsis

我想为我的 nsis Windows 安装程序使用 pom.xml 中版本字段的值。为此，我使用[nsis-maven-plugin](http://mojo.codehaus.org/nsis-maven-plugin/)生成一个`target/project.nsh`（将包含一个适当的`PROJECT_VERSION`字段），然后`!include`进入我的`setup.nsi`.

这就是问题所在：假设我的 pom`project.version`是 1.2-SNAPSHOT。`makensis`将因错误而失败：

```
[MAKENSIS] Error: invalid VIProductVersion format, should be X.X.X.X 
```

所以我有两个问题：

1.  “-SNAPSHOT”字符串

    我可以在设置字段之前将其删除`VIProductVersion`，但是当它真的不是时，我的版本会显示为 1.2。

2.  我的版本看起来像 XX，但必须是 XXXX

    `VIProductVersion ${PROJECT_VERSION}.0.0`一旦我将我的 pom 更改`project.version`为 1.2.1 ，用两个零（例如）硬填充字段就会中断

有什么好的策略吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:42:28.227

我对 maven 一无所知，但我可以告诉你为什么 NSIS 会这样工作。

您可以使用[`VIAddVersionKey`](http://nsis.sourceforge.net/Docs/Chapter4.html#4.8.3)添加任何您想要的字符串（包括“ProductVersion”）。`VIProductVersion`设置 win32/PE 版本资源的[固定 (VS_FIXEDFILEINFO)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646997%28v=vs.85%29.aspx)部分，这就是为什么它必须包含 4 个 16 位数字...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T15:46:15.697

我有同样的问题。由于我在项目中使用了[copy-maven-problem](http://evgeny-goldin.com/wiki/Copy-maven-plugin)，因此我还使用它来`project.nsh`处理 Groovy 代码段：

```
<resource>
    <targetPath>${project.build.directory}</targetPath>
    <file>${project.build.directory}/installer-header.nsh</file>
    <destFileName>installer-header-processed.nsh</destFileName>
    <!-- groovy extension point -->
    <process>{{ 
            def versionsList = project.version.replaceFirst("-SNAPSHOT", "").tokenize('.')
            while(!(versionsList.size >= 4)){
                versionsList.add('0')
            }
            files[0].append("!define VI_PRODUCT_VERSION \"" + versionsList.join('.') + "\"\n")
        }}</process>
</resource>
<resource>
    <targetPath>${project.build.directory}</targetPath>
    <file>${project.build.directory}/installer-header-processed.nsh</file>
    <destFileName>installer-header.nsh</destFileName>
    <move>true</move>
</resource> 
```

检查该插件的文档并调整变量/文件名（即我称之为头文件`installer-header.nsh`）

在此之后，您在标题中有一个变量`VI_PRODUCT_VERSION`（根据需要重命名），您可以在`setup.nsi`.

我知道这看起来像 q bad hack，但它现在有效。我希望将来会有插件生成的变量..

PS：在打包阶段调用 nsis-maven-plugin 之前的 copy-maven-plugin 以使其工作。我在 nsis 插件之前定义了 copy 插件——它`.nsh`是在 prepare-package 阶段生成的，所以它在处理之前就存在了。

# asp.net - 母版页和内容页中的 asp.net 表单

> ID：15032424
> 
> 赞同：1
> 
> 时间：2013-02-22T20:09:47.537
> 
> 标签：asp.net, forms, master-pages, webforms

我的 asp.net 网络表单有问题我有两个来自（不包括自动添加的默认表单）一个母版页，另一个在内容页中，当我提交第二个时，只有第一个被提交：
母版页：

```
 <form  method="GET" action="Search.aspx" >
    <div id="searchform" class="search-form">
        <input type="text" id="txtSearch" name="txtSearch" style="height: 20px;" placeholder="ووشەی گەران لێرەدا بنووسسە" class="search-input placeholder" />
        <input type="submit" id="btnSearch" class="btn" name="btnSearch" value="بگەرێ" />
        <br />
        <span style="text-align: center; padding-top: 2px; padding-right: 100px;">
            <select id="DropDownListItems" name="cat">
                <option value="0">ناونیشان</option>
                <option value="1">کۆمپانیا</option>
                <option value="2">ووڵات</option>
                <option value="3">جۆری کار</option>
                <option value="4">شار</option>
                <option value="5">هەمووی</option>
            </select>
        </span>
    </div>
</form> 
```

内容页：

```
 <div id="element_to_pop_up" style="text-align: center;">
          <form method="POST" action="AddJob.aspx">
             <h2>جۆری کار</h2>
             <p>
                 <span id="txtJobTypeSpan" style="color: red;"></span>

                 <input type="text" name="jobname" id="jobname"/>
             </p>
             <p>
                 <input type="submit" name="btnAddJobCat" value="submit"/>

             </p>                      
          </form>              
     </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:05:04.090

当您在页面中添加另一个元素时，您[**无法**嵌套表单](http://www.w3.org/MarkUp/html3/forms.html)。它将嵌套在.`<form/>``Content``form``Master Page`

删除`<form/>`您的元素`Content Page`并使用[**Button.PostBackUrl**](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.postbackurl.aspx)如果您需要使用`POST`其他元素`action`而不是`Postback`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:21:47.640

尝试将第二种形式更改为：

```
<input type="button" name="btnAddJobCat" value="submit" onclick="document.forms[1].submit()" /> 
```

或者

```
<input type="button" name="btnAddJobCat" value="submit" onclick="document.getElementById('element_to_pop_up').submit()" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-08T06:17:31.083

将所有控件设为 ASP.NET 控件，并为每个按钮添加 ValidationGroup 属性的不同名称

在 MasterPage 中：

```
<form  method="GET" action="Search.aspx" id="form1" runat="server" >
<div id="searchform" class="search-form">
    <input type="text" id="txtSearch" name="txtSearch" style="height: 20px;" placeholder="ووشەی گەران لێرەدا بنووسسە" class="search-input placeholder" />
    <input type="submit" id="btnSearch" class="btn" name="btnSearch" value="بگەرێ" />
    <br />
    <span style="text-align: center; padding-top: 2px; padding-right: 100px;">
        <select id="DropDownListItems" name="cat">
            <option value="0">ناونیشان</option>
            <option value="1">کۆمپانیا</option>
            <option value="2">ووڵات</option>
            <option value="3">جۆری کار</option>
            <option value="4">شار</option>
            <option value="5">هەمووی</option>
        </select>
    </span>
</div> 
```

将 ContentPlaceHolder 控件放在您希望放置 ContentPage 的位置

在内容页面中：

```
 <asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">     
    <div id="element_to_pop_up" style="text-align: center;">
              <form method="POST" action="AddJob.aspx">
                 <h2>جۆری کار</h2>
                 <p>
                     <span id="txtJobTypeSpan" style="color: red;"></span>

                     <input type="text" name="jobname" id="jobname"/>
                 </p>
                 <p>
                     <input type="submit" name="btnAddJobCat" value="submit"/>

                 </p>                      
              </form>              
         </div>
</asp:Content> 
```

ContentPage 不应该有表单标签。您所有的代码都应该在内容标签中

# wcf - 为 WCF WS-Security 和 WSE Nonce 身份验证编写 WCF 拦截器

> ID：15032426
> 
> 赞同：0
> 
> 时间：2013-02-22T20:10:01.223
> 
> 标签：wcf, wcf-data-services, wcf-binding, wcf-security

我必须编写一个 WCF 拦截器来扩展 WCF 行为

我的扩展程序的行为是它将向请求添加自定义标头....

自定义标题将如下所示

```
 <soapenv:Header>
    <wsse:Security soapenv:mustUnderstand="1"
  xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
<wsse:UsernameToken wsu:Id="UsernameToken-8"
  xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
  <wsse:Username>TeStUsErNaMe1</wsse:Username>
  <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText"                  >TeStPaSsWoRd1</wsse:Password>
  <wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"                  >f8nUe3YupTU5ISdCy3X9Gg==</wsse:Nonce>
  <wsu:Created>2011-05-04T19:01:40.981Z</wsu:Created>
</wsse:UsernameToken>
</wsse:Security> 
```

我编写了一个 CustomCredential ，它将标头添加到请求中。

我的问题是如何扩展这个 WCF 行为

因为它正在使用 CustomCredentials

我想要类似下面的东西

client.ChannelFactory.Endpoint.Behaviors.Remove(); client.ChannelFactory.Endpoint.Behaviors.Add(new CustomCredentials());

在我的 WCF 拦截器中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T14:33:01.273

这是一篇关于如何做到这一点的好文章。它详细解释了它，并且在需要 Nonce 和 Created 的 WS-Security Web 服务上表现出色。

[http://www.west-wind.com/weblog/posts/2012/Nov/24/WCF-WSSecurity-and-WSE-Nonce-Authentication](http://www.west-wind.com/weblog/posts/2012/Nov/24/WCF-WSSecurity-and-WSE-Nonce-Authentication)

# c++ - openCV说它找不到相机

> ID：15032427
> 
> 赞同：1
> 
> 时间：2013-02-22T20:10:09.320
> 
> 标签：c++, opencv, visual-studio-2012

大家好，我正在尝试使用我的相机使用 openCV 和 Visual Studio 2012 (C++) 获取视频，但出现错误消息：“未检测到相机！！！” 图片解释了我的问题：

当我执行我的代码时：

![在此处输入图像描述](../Images/df39e478c93556a2867bfc94e942d485.png)

我选择了确定：

![在此处输入图像描述](../Images/a907ecf87bbd426902065c55dc72fda6.png)

我的代码：

```
#include <opencv2/objdetect/objdetect.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/imgproc/imgproc.hpp>

#include <iostream>
#include <stdio.h>

using namespace std;
using namespace cv;

int main( int argc, const char** argv )
{
    CvCapture* capture = 0;
    Mat frame, frameCopy, image;

    capture = cvCaptureFromCAM( CV_CAP_ANY ); //0=default, -1=any camera, 1..99=your camera

if( !capture )
{
cout << "No camera detected" << endl;
system("pause");
}

cvNamedWindow( "result", CV_WINDOW_AUTOSIZE );

if( capture )
{
cout << "In capture ..." << endl;
for(;;)
{
IplImage* iplImg = cvQueryFrame( capture );
frame = iplImg;

if( frame.empty() )
break;
if( iplImg->origin == IPL_ORIGIN_TL )
frame.copyTo( frameCopy );
else
flip( frame, frameCopy, 0 );

cvShowImage( "result", iplImg );

if( waitKey( 10 ) >= 0 )
break;
}
// waitKey(0);
}

cvWaitKey(50);

cvReleaseCapture( &capture );
cvDestroyWindow( "result" );

return 0;
    } 
```

感谢提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-17T12:12:19.627

你的代码没有错。再次检查您的网络摄像头。（例如，网络摄像头驱动程序）和测试：`"capture = cvCaptureFromCAM( -1 );"`

# javascript - 带有间隔提示和修复的随机数

> ID：15032429
> 
> 赞同：1
> 
> 时间：2013-02-22T20:10:14.760
> 
> 标签：javascript, random, prompt

我尝试用随机数填充数组：

```
var randomArray = new Array(10);
function randFillArray(array, aInx, zInx) {
    for(var i = 0; i < array.length; i++) {
        array[i] = randomFromInterval(aInx, zInx);
    }
}
function randomFromInterval(from, to){
    return Math.floor((Math.random() *(to - from + 1)) + from);
}
var minV = 1;
var maxV = 6;
randFillArray(randomArray, minV, maxV);
for(var i = 0; i < randomArray.length; i++) {
        document.write(randomArray[i]+"<br />");
    } 
```

这是很好的工作。但是如果我想像这样输入最小值和最大值：

```
var minV = prompt("min");
var maxV = prompt("max"); 
```

具有相同的 min = 1 和 max = 6，我可以在数组中得到 0。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:22:29.660

在提示窗口中输入的值存储为字符串，因此您必须将它们评估为整数。至少有两种方法可以做到这一点。

1.  使用功能`parseInt`：

    ```
    var minV = parseInt(prompt("min"));
    var maxV = parseInt(prompt("max")); 
    ```

2.  将“字符串”乘以 1：

    ```
    var minV = prompt("min");
    var maxV = prompt("max");
    minV *= 1;
    maxV *= 1; 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:25:31.483

```
var minV = parseInt(prompt("min"));
var maxV = parseInt(prompt("max")); 
```

# ruby-on-rails - 使用 Carrierwave 和回调删除模型上的属性内容

> ID：15032433
> 
> 赞同：1
> 
> 时间：2013-02-22T20:10:33.750
> 
> 标签：ruby-on-rails, model, attributes, carrierwave

我正在尝试在删除上传的文件时从模型中删除文件属性（使用复选框）。该文件已正确删除，但属性未正确删除。有人能帮我吗？我不想在模型中移动这段代码。我认为它必须位于上传器内部。

```
# DocumentUploader.rb

# Hooks
before :cache, :update_file_attributes
after :remove, :remove_file_attributes

private

def update_file_attributes(file)
  model.file_name = file.original_filename
  model.file_size = file.size
  model.mime_type = file.content_type
end

def remove_file_attributes
  %w(file_name file_size mime_type).each { |attr| model[attr] = "" }
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:14:48.123

刚刚自己遇到了这个问题。我让它在我的应用程序中工作，类似地，类似这样的事情：

```
def remove_file_attributes
  model.file_name = ""
  model.file_size = ""
  model.mime_type = ""

  model.save
end 
```

猜你的也可以，但你只需要添加'model.save'。注意：这样做之后，我的数据库中的字段为 NULL，而不是空字符串（这对我来说很好）。

# linux - 如何显示当前 .bashrc 文件的来源？

> ID：15032438
> 
> 赞同：2
> 
> 时间：2013-02-22T20:11:04.097
> 
> 标签：linux, bash, shell, recover

所以我刚刚回显到 bashrc，并删除了那里的所有内容。但是我的外壳没有关闭或重新加载，所以我的 bash 的来源是旧的。有没有办法查看我当前的 bashrc 文件的来源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T22:31:38.340

`set`您可以使用 bash 命令（没有参数，它会转储当前环境变量和函数）和`alias`（类似地，转储别名）获得当前 bash shell 环境的相当完整的转储。这些可以帮助您重建许多旧的 .bashrc 文件。

但是，您应该记住，这些不会显示旧的 .bashrc 本身，它们会显示*其结果*。例如，如果默认系统 PATH 是`/usr/bin:/bin:/usr/sbin:/sbin`并且您的旧 .bashrc 包含

```
PATH="$PATH:/opt/X11/bin" 
```

这只会显示最终结果：

```
PATH=/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin 
```

如果您将其复制到新的 .bashrc 中，并且系统 PATH 得到更新（例如包含`/usr/local/bin`），您的 .bashrc 将删除更新。

因此，您不应该只获取 and 的输出`set`并将`alias`其用作新的 .bashrc。但是您可以将它们用作曾经存在的东西的提醒，也可以使用它们来避免例如必须重写任何复杂的函数以及您定义的此类函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T20:22:51.737

不，基本上。Bash 评估登录脚本的内容，但不会保留它们。您可以通过查看当前环境（使用`env`命令）来重建它们的一部分，但大部分都已经消失了。Bash 不提供高级反射。

将其视为一种学习体验，并让它激励您从现在开始进行备份并将重要配置保留在版本控制中。

# android - 如何为移动用户设置自动网站切换？大多数移动浏览器不支持 Flash

> ID：15032440
> 
> 赞同：0
> 
> 时间：2013-02-22T20:11:12.090
> 
> 标签：android, html, flash, mobile, web

我有一个运行 flash 的网站，它在桌面上运行良好，但在 Android 浏览器上不支持。如何设置自动切换？当网站检测到其移动用户时，显示静态网站而不是动态 Flash 网站？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:23:54.833

您可以使用[SWFObject](http://code.google.com/p/swfobject/)将 Flash 包含在 HTML 页面中（它是一个小型 JavaScript 库）。它包括在未检测到 Flash Player 时显示替代 (html) 内容的工具。

所以你只需将你的静态站点的主页添加为 Flash 显示的替代内容；如果他们安装了 Flash，用户将看到 Flash 站点，如果没有安装，则用户将看到静态站点。

这样您就可以进行更一般的切换 - 设备可以播放 Flash 吗？而不是这是一个移动设备？

# javascript - 回调完成后返回一个对象

> ID：15032441
> 
> 赞同：-1
> 
> 时间：2013-02-22T20:11:17.347
> 
> 标签：javascript, extjs

调用此函数时，我希望该函数在返回对象之前等待回调完成`r`

```
 function getWmsLayers(oneServerState){
            reader = new GeoExt.data.WMSCapabilitiesReader();;
            var serverLayers = new Array();
            var store = new GeoExt.data.WMSCapabilitiesStore({
                    url: OpenLayers.ProxyHost + oneServerState.serverUrl,
                    reader: reader
            });
            var isCallBackCompleted = false;
            store.load({
                    callback: function (r) {
                            return r;
                    }
            });
            //Do something ??
            return r;
    };

    layers = getWMSLayers(oneServerState); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:13:54.913

您不能等待异步调用完成。这本质上就是异步调用的定义！你能做的最好的就是拆分你的调用逻辑。所以代替这个：

```
stuff();
result = doAsyncCall(); // WILL NOT WORK!
moreStuff(result); 
```

使用这样的回调：

```
stuff();
var callback = function (result) { moreStuff(result); };
doAsyncCall(callback); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:16:37.663

您必须 w8 才能加载图层。像这样：

```
 function getWmsLayers(oneServerState, fnCallback){
            reader = new GeoExt.data.WMSCapabilitiesReader();;
            var serverLayers = new Array();
            var store = new GeoExt.data.WMSCapabilitiesStore({
                    url: OpenLayers.ProxyHost + oneServerState.serverUrl,
                    reader: reader
            });
            var isCallBackCompleted = false;
            store.load({
                    callback: function (r) {
                        fnCallback(r);
                    }
            });
    }; 
```

然后用这个调用这个函数：

```
 getWmsLayers(serverstate, function ( l ) {
       layers = l;
       nextFunctiontoContinueProgressing();
    }); 
```

这就是你如何建立一个回调链来完成你的请求。

# vb.net - 检查 textbox.text 是否存在于数组中

> ID：15032446
> 
> 赞同：3
> 
> 时间：2013-02-22T20:12:03.167
> 
> 标签：vb.net, visual-studio, textbox

在这里，我有我的简单代码，包含数组列表和 2 个文本框，当我按下按钮脚本必须检查是否在数组列表中找到文本表单 Textbox2。你能帮我修一下吗？谢谢 ！

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim pins() As String = {"dgge", "wada", "caas", "reaa"}
    If TextBox2.Text = pins() Then
        TextBox1.Text = "Succes"
    End If End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:21:18.633

如果你想使用 LINQ，你可以这样做：

```
If pins.Contains(TextBox2.Text) Then
    TextBox1.Text = "Success"
End If 
```

否则，最简单的选择是使用 a`List`而不是数组：

```
Dim pins As New List(Of String)(New String() {"dgge", "wada", "caas", "reaa"})
If pins.Contains(TextBox2.Text) Then
    TextBox1.Text = "Success"
End If 
```

但是，如果必须使用数组，可以使用类`IndexOf`中的方法`Array`：

```
If Array.IndexOf(TextBox2.Text) >=0 Then
    TextBox1.Text = "Success"
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:19:31.520

```
If Array.IndexOf(pins, TextBox2.Text) <> -1 Then
    TextBox1.Text = "Succes"
End If End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:19:52.660

```
If pins.IndexOf(TextBox2.Text) >= 0 Then
    TextBox1.Text = "Founded"
End If 
```

或者，如果您使用`List(Of String)`而不是数组：

```
If pins.Contains(TextBox2.Text) Then
    TextBox1.Text = "Founded"
End If 
```

# windows - 如何在不使用 GUI 的情况下在 windbg 中的停止指令后获取堆栈跟踪？

> ID：15032448
> 
> 赞同：2
> 
> 时间：2013-02-22T20:12:18.500
> 
> 标签：windows, windbg

通常我在我的 C++ 代码中插入一个`assert(0);`，启动 Windbg，按 F5，回车`k`，我得到一个堆栈跟踪。然后我必须通过鼠标复制粘贴它并退出。

但我想自动化这个。有什么方法可以检索堆栈跟踪并将其写入文本文件而无需手动使用 GUI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:42:09.780

`.logopen`首先，您可以使用如下方式将 gui 的输出写入文本文件

```
.logopen c:\dump\myLog.txt 
```

这会将所有内容转储到该位置，调用`.logclose`以关闭日志，因此在一行中：

```
.logopen c:\dump\myLog.txt; k; .logclose 
```

其次如果实在不想用gui的话，还有windbg的命令行版本，cdb。您可以使用以下命令执行此操作：

```
cdb -log c:\data\myLog.txt -lines -pn myApp.exe -c ".symfix;.reload;k;qd" 
```

这将打开调用堆栈的行号，输出到日志，使用名称附加到您的进程，然后用双引号执行命令以修复 MS 的符号服务器，重新加载，转储调用堆栈并退出和分离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T19:28:24.280

假设您不再尝试进一步调试它，而只是尝试获取堆栈跟踪，那么只需调用此函数并将输出写入文件。

CaptureStackBackTrace ( [http://msdn.microsoft.com/en-us/library/bb204633(VS.85).aspx?ppud=4](http://msdn.microsoft.com/en-us/library/bb204633(VS.85).aspx?ppud=4) )

# android - 在移动设备上使用 Adob e Air 进行声学回声消除

> ID：15032449
> 
> 赞同：7
> 
> 时间：2013-02-22T20:12:29.717
> 
> 标签：android, ios, air, flash-builder, microphone

有人在 Adob​​e Air 构建的移动应用程序中实现了回声消除吗？

有：

*   Microphone.getEnhancedMicrophone() 但它在移动设备上返回 null。

*   Microphone.setUseEchoSuppression(true) 也不起作用。

*   也许与ANE？[我在Apple Docs](http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/MultimediaPG/UsingAudio/UsingAudio.html#//apple_ref/doc/uid/TP40009767-CH2-SW6)中看到了回声抑制设置

有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T00:43:51.590

目前没有已知的解决方案。已经承诺了 4 年的回声抑制。上面的代码将不起作用，因为 Microphone.setUseEchoSuppression(true) 在使用 Adob​​e AIR 的 Android 上不起作用。检测来自 Netstream 的音频的能力也不起作用，因此使用音量和增益手动编码解决方案也不起作用。由于回声抑制问题，我正在考虑重写我的整个视频聊天应用程序。Adobe 显然未能与 Google 合作寻找解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-17T21:47:37.710

不，Microphone.setUseEchoSuppression 什么都不做。它只是 Adob​​e 计划在某个时候实施的占位符功能。

截至 2015 年 12 月 17 日，Adobe 尚未针对 Apple 和 Android 平台上的移动设备上的 AIR 解决 AEC。

但是，我的一位联系人与 Adob​​e 的 Chris Campbell 就 AIR Mobile 的 AEC 进行了几次交谈，Chris 说他们已经获得了合法的 WRT 许可，并且正在将 AEC 纳入 AIR 20（2015 年 12 月）。

我还没有看到任何其他迹象表明 Adob​​e 是否会这样做。我知道这对于基于视频聊天的应用程序的开发人员来说将是一个巨大的推动力，包括对移动设备的支持。我们有网络 AEC 和桌面 AIR。只需要移动设备即可创建全渠道视频解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-12T16:43:38.110

它现在在最新的 AIR SDK（v22 和 v23）中实现。

[https://helpx.adobe.com/flash-player/release-note/fp_23_air_23_release_notes.html](https://helpx.adobe.com/flash-player/release-note/fp_23_air_23_release_notes.html)

所以你现在可以使用`Microphone.getEnhancedMicrophone()`.

您还需要为 Android 添加此权限：

`<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T02:33:34.310

您的设备不支持增强型麦克风，因此只需使用 getMicrophone：

```
 mic = Microphone.getMicrophone();
    mic.rate = 44;
    mic.setUseEchoSuppression(true); 
```

# django - 抑制manage.py转储数据上的警告输出？

> ID：15032450
> 
> 赞同：6
> 
> 时间：2013-02-22T20:12:43.667
> 
> 标签：django

我正在使用 django 的 dumpdata 和 loaddata 命令来方便一些数据导出。但是，我目前有一些未解决的弃用警告，因此当我将转储数据的输出写入文件时，警告最终会出现在文件的顶部，我每次都必须手动清理转储文件。有什么方法可以抑制或避免警告，dumpdata 的输出是合法的 json，而不必每次都手动删除警告文本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-12-22T08:43:58.157

您还可以通过 python 解释器上的标志来抑制警告，而无需在任何地方插入代码

例如

```
python -Wi manage.py dumpdata 
```

[https://docs.python.org/2/using/cmdline.html#cmdoption-W](https://docs.python.org/2/using/cmdline.html#cmdoption-W)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T21:06:13.120

您可以尝试覆盖[`warning.showwarning`](http://docs.python.org/2/library/warnings.html#warnings.showwarning). 将以下代码放在您将在您`dumpdata`（例如您的`settings.py`）时导入的位置：

```
import warnings
warnings.showwarning = lambda *x: None 
```

# php - 如何有效防止目录暴力破解？

> ID：15032451
> 
> 赞同：1
> 
> 时间：2013-02-22T20:12:50.717
> 
> 标签：php, security, .htaccess, directory, obfuscation

我有一个脚本，其中主要组件存储在子文件夹中。所有组件只能从充当控制器的 index.php 访问。在考虑如何从公共访问/可见性中隐藏组件文件夹时，我得到了 2\. 考虑到的选项：

1.  在每个目录中使用 .htaccess 来传递 403 禁止错误。
2.  使用以下 php 脚本和“假”404 HTML 消息在每个文件夹中放置一个 index.php。

    header('HTTP/1.0 404 Not Found');

我尝试了这两个选项并使用 OWASP ZAP 进行了扫描。对于第一个选项，可以获得脚本的整个结构，因为对于每个系统文件夹，都会提供 403。使用第二个选项，OWASP 无法为我提供脚本文件夹列表，因为 404 告诉它没有文件夹。

现在我不知道这些方法中哪种方法最好，htaccess 会阻止所有访问，但是使用假的 404，您甚至看不到有目录。

有没有办法让 .htaccess 的安全性和交付的 404 的良好混淆？

编辑：对不起，我忘了提，由于服务器限制，我无法将组件移动到可访问的脚本路径之外！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:18:13.810

PHP 可以包含文档根目录之外的文件。

通常我有这个设置：

```
/www/application            - this is the web application root
/www/application/includes   - here you find the components
/www/application/root       - here you place index.php 
```

这样你就不需要禁止你不想被访问的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:24:43.510

对此有两种思路。首先，正如@nalply 所说，只是将脚本移出文档根目录。PHP 允许您将文件包含在服务器根目录下，因此它们根本不需要包含您的实际公共内容。在我看来，**这是最好的方法**。

第二种方法是使用`.htaccess`指令。例如，在我运行的特定站点上，我在技术上无法实施第一个选项。因此，我将一个`.htaccess`文件放在任何不打算被公众点击的目录中，其中包含以下代码：

```
deny from all 
```

这不允许浏览器访问目录中的任何文件，但您仍然可以通过 PHP 包含这些文件。这将是第二好的方法。

我强烈建议不要使用`index.php`发送 HTTP 错误标头或显示消息的文件。仅使用此方法，该目录中的其他文件在**技术上仍然可以访问。**如果有人知道这些文件之一的路径，他们将能够访问它们。

**TL;DR**将文件放在文档根目录的非公共目录中，***或者***`.htaccess`在每个目录中使用一个文件。不要使用`index.php`文件来阻止目录访问。

# c# - 如何检查是否安装了 ssl 证书？

> ID：15032456
> 
> 赞同：1
> 
> 时间：2013-02-22T20:13:07.503
> 
> 标签：c#, windows-phone-8, ssl-certificate

我使用此代码安装自签名证书（用户必须确认安装）。

```
 // Constructor
    public MainPage()
    {
        this.Loaded += new RoutedEventHandler(MainPage_Loaded);

    }
    private async void MainPage_Loaded(object sender, RoutedEventArgs e)
    {
        try
        {
            StorageFolder packageLocation = Windows.ApplicationModel.Package.Current.InstalledLocation;
            StorageFolder certificateFolder = await packageLocation.GetFolderAsync("Certificates");
            StorageFile certificate = await certificateFolder.GetFileAsync("myCer.cer");

            await Launcher.LaunchFileAsync(certificate);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message.ToString());
        }
    } 
```

是否可以检查证书是否已安装，以便我不必在每次启动应用程序时都安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T18:46:20.733

证书可以通过多种方式进行比较，但最常见的两种方式是

*   按指纹
    *   公钥的加密哈希
    *   根据要求计算 - 不存储在证书本身中
    *   在所有证书中唯一
    *   使用抗碰撞哈希算法时难以伪造（[http://en.wikipedia.org/wiki/Preimage_attack](http://en.wikipedia.org/wiki/Preimage_attack)）
*   按序列号和发行人
    *   使用 PKI 时必须是唯一的
    *   无需计算即可更快地进行比较
    *   只有在验证链信任时才能被信任。攻击者可以使用选定的序列号和颁发者名称生成自签名证书。

在代码中：

```
X509Certificate cert1 = /* your cert */;
X509Certificate cert2 = /* your other cert */;

// assuming you are validating pki chain
// X509Certificate compares the serial number and issuer
bool matchUsingSerialAndIssuer = cert1.Equals(cert2);

// otherwise
bool publicKeyIsIdentical = cert1.GetCertHashString() == cert2.GetCertHashString();
// or easier to read if using X509Certificate2 (Thumbprint calls GetCertHashString)
// bool publicKeyIsIdentical = cert1.Thumbprint == cert2.Thumbprint; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:28:52.110

你为什么不尝试这样的事情来找到证书。还将此名称空间包含到您的项目 System.Security.Cryptography.X509Certificates 中；如果您不能使用 X509，您可以更改以下代码以使用不同类型的证书。

```
 private static X509Certificate2 GetCertificateFromStore(string certSN)
        {

            X509Store store = new X509Store(StoreName.Root, StoreLocation.LocalMachine);
            try
            {
                store.Open(OpenFlags.ReadOnly);
                X509Certificate2Collection col = store.Certificates;

                foreach (var currCert in col)
                {
                    var currSN = currCert.SerialNumber;
                    if (certSN.ToUpperInvariant() == currSN)
                    {
                        return currCert; // you found it return it
                        break;
                    }

                }

                return null; // you didnt now install it...
            }
            finally
            {
                store.Close();
            }

        } 
```

# c++ - C++11 时钟：g++ stable_clock::is_steady == false？

> ID：15032462
> 
> 赞同：10
> 
> 时间：2013-02-22T20:13:38.933
> 
> 标签：c++, gcc, c++11, gcc4.7

所以准确的时序对我来说很重要，我正在研究 C++ 11 中指定的 3 种时钟类型，即`system_clock`、`steady_clock`和`high_resolution_clock`. 我最初关心的是测试不同类型时钟的调用开销是否有任何差异，并检查每种类型时钟的分辨率。这是我的示例程序：

```
#include <chrono>
#include <cstdio>
using namespace std;
using namespace std::chrono;

int main(int argc, char **argv)
{
  size_t N = 1e6;
  if(2 == argc) {
    sscanf(argv[1], "%zu", &N);
  }

#if defined(hrc)
  typedef high_resolution_clock clock;
#warning "High resolution clock"
#elif defined(sc)
  typedef steady_clock clock;
#warning "Steady clock"
#elif defined(sys)
  typedef system_clock clock;
#warning "System clock"
#endif

  const double resolution = double(clock::period::num) / double(clock::period::den);

  printf("clock::period: %lf us.\n", resolution*1e6);
  printf("clock::is_steady: %s\n", clock::is_steady ? "yes" : "no");
  printf("Calling clock::now() %zu times...\n", N);

  // first, warm up
  for(size_t i=0; i<100; ++i) {
    time_point<clock> t = clock::now();
  }

  // loop N times
  time_point<clock> start = clock::now();
  for(size_t i=0; i<N; ++i) {
    time_point<clock> t = clock::now();
  }
  time_point<clock> end = clock::now();

  // display duration
  duration<double> time_span = duration_cast<duration<double>>(end-start);
  const double sec = time_span.count();
  const double ns_it = sec*1e9/N;
  printf("That took %lf seconds. That's %lf ns/iteration.\n", sec, ns_it);

  return 0;
} 
```

我用它编译

```
$ g++-4.7 -std=c++11 -Dhrc chrono.cpp -o hrc_chrono
chrono.cpp:15:2: warning: #warning "High resolution clock" [-Wcpp]
$ g++-4.7 -std=c++11 -Dsys chrono.cpp -o sys_chrono
chrono.cpp:15:2: warning: #warning "System clock" [-Wcpp]
$ g++-4.7 -std=c++11 -Dsc  chrono.cpp -o sc_chrono
chrono.cpp:15:2: warning: #warning "Steady clock" [-Wcpp] 
```

我用 G++ 4.7.2 编译，然后运行

*   SUSE Linux，内核 v3.1.10，CPU i7
*   Angstrom Linux 嵌入式系统，内核 v3.1.10，MCU Tegra 2 (ARM Cortex A9)。

第一个令人惊讶的是，这 3 种时钟显然是同义词。它们都具有相同的周期（1 微秒），并且时间/呼叫实际上是相同的。**如果它们都相同，那么指定 3 种类型的时钟有什么意义？**这仅仅是因为G++的实现`chrono`还不成熟吗？或者 3.1.10 内核可能只有一个用户可访问的时钟？

第二个惊喜，这是巨大的，是**stable_clock::is_steady == false**。我相当肯定，根据定义，该属性应该是正确的。是什么赋予了？？我该如何解决它（即，实现稳定的时钟）？

如果你可以在其他平台/编译器上运行这个简单的程序，我很想知道结果。如果有人想知道，我的 Core i7 上大约是 25 ns/迭代，而 Tegra 2 上大约是 1000 ns/迭代。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T21:58:57.223

`steady_clock` *支持 GCC 4.7（如 4.7 版本的文档所示：*http :* [//gcc.gnu.org/onlinedocs/gcc-4.7.2/libstdc++/manual/manual/status.html#status.iso.2011](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/libstdc++/manual/manual/status.html#status.iso.2011)）并且`steady_clock::is_steady`是正确的，但前提是您使用`--enable-libstdcxx-time=rt`*

 *有关该配置选项的详细信息，请参阅[https://stackoverflow.com/a/12961816/981959](https://stackoverflow.com/a/12961816/981959)。

对于 GCC 4.9，如果您的操作系统和 C 库支持 POSIX 单调时钟，它将自动启用`clock_gettime`（对于带有 glibc 2.17 或更高版本的 GNU/Linux 以及 Solaris 10、IIRC 都是如此）

`--enable-libstdcxx-time=rt`这是在AMD Phenom II X4 905e、2.5GHz 上配置 GCC 4.8 的结果，但我认为它现在被限制到 800MHz，运行 Linux 3.6.11、glibc 2.15

```
$ ./hrc
clock::period: 0.001000 us.
clock::is_steady: no
Calling clock::now() 1000000 times...
That took 0.069646 seconds. That's 69.645928 ns/iteration.
$ ./sys
clock::period: 0.001000 us.
clock::is_steady: no
Calling clock::now() 1000000 times...
That took 0.062535 seconds. That's 62.534986 ns/iteration.
$ ./sc
clock::period: 0.001000 us.
clock::is_steady: yes
Calling clock::now() 1000000 times...
That took 0.065684 seconds. That's 65.683730 ns/iteration. 
```

在运行 Linux 3.4.0、glibc 2.16 的 ARMv7 Exynos5 上*没有* GCC 4.7 （因此所有三种时钟类型的结果相同）`--enable-libstdcxx-time`

```
clock::period: 1.000000 us.
clock::is_steady: no
Calling clock::now() 1000000 times...
That took 1.089904 seconds. That's 1089.904000 ns/iteration. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-22T20:23:36.360

> 如果你可以在其他平台/编译器上运行这个简单的程序，我很想知道结果。

Mac OS X 10.8、clang++ / libc++、-O3、2.8 GHz Core i5：

```
High resolution clock

clock::period: 0.001000 us.
clock::is_steady: yes
Calling clock::now() 1000000 times...
That took 0.021833 seconds. That's 21.832827 ns/iteration.

System clock

clock::period: 1.000000 us.
clock::is_steady: no
Calling clock::now() 1000000 times...
That took 0.041930 seconds. That's 41.930000 ns/iteration.

Steady clock

clock::period: 0.001000 us.
clock::is_steady: yes
Calling clock::now() 1000000 times...
That took 0.021478 seconds. That's 21.477953 ns/iteration. 
```

`steady_clock`并且`system_clock`必须是不同的类型。 `steady_clock::is_steady`必须是`true`。 `high_resolution_clock`可能是 or 的不同类型或`steady_clock`别名`system_clock`。 `system_clock::rep`必须是有符号类型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-22T20:34:13.323

根据[GNU 的网站](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#iso.2011.specific)，GNU libstdc++ 还不支持`steady_clock`。这就是为什么`steady_clock::is_steady`是假的。

以下是支持清单的相关部分：

```
20.11.7.1   Class system_clock           Y   
20.11.7.2   Class steady_clock           N   Support old monotonic_clock spec instead
20.11.7.3   Class high_resolution_clock  Y 
```*

# printing - 在 Maple 中循环打印

> ID：15032469
> 
> 赞同：1
> 
> 时间：2013-02-22T20:13:58.757
> 
> 标签：printing, maple

我是 Maple 的新手，所以如果这个问题很明显，请原谅这个问题。我正在运行一些需要很长时间的例程，并且我想按原样获取更新。基本上我有一个大`for`循环，我想在每次通过后查看输出，而不是等待结束。这是我所拥有的想法：

```
for i from 1 to 10 do
  M := complicatedFunction(i);
  print(i, M);
od; 
```

它的作用是运行所有 10 个周期，然后打印所有 10 个输出。

我想要的是在每个周期结束时打印输出，这样我就可以看到它的进展情况。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:05:12.653

听起来好像您正在使用文档，而您的代码在文档块中执行。

您可以将代码放在执行组中（其中代码行在红色`>`提示的右侧输入）。您可以使用主菜单栏的 Insert->Execution Group 将此类插入到文档中。打印到执行组应该异步完成（这是您想要的）。

如果您的代码在一个过程中，那么您只需要从执行组执行对该过程的调用，即使该过程本身是在某个文档块的其他地方定义的。

或者，您可以为此编码从文档切换到工作表。您可以使用主菜单栏的文件->打开在文档和工作表之间进行选择。在工作表中，编码的主要区域是执行组。您甚至可以在菜单栏的工具->选项-界面下设置默认打开的首选项。

# php - 使用 AJAX 更改 PHP 函数中的参数并重新加载

> ID：15032470
> 
> 赞同：0
> 
> 时间：2013-02-22T20:14:04.920
> 
> 标签：php, javascript, jquery, ajax

关于在这里使用 AJAX 的问题。我想更改函数参数并重新加载它。

所以函数的初始值 $x 可能是 5，我想通过单击一个按钮来更改它，然后重新加载函数但 $x 将等于 6。等等。

```
<?php 
function first_Func($x,$y){
    //do this
} 
```

这是在我的另一个问题上向我建议的：

```
$('#next').click(function(){
        var x = '12';
        var y = '17'; 
        var url  = "url of the script";
        $.ajax({'url' : url ,
            'type' : 'post',
            'data' : {'x' : x , 'y' : y} ,
            'success' : function(data){
                // do something with your data
            }
        }); 
```

但我不明白这是如何工作的。我大概是在将数据传递给服务器，但是如何在我的脚本中使用它呢？我没有用这个改变我原来的 PHP 脚本中的任何变量..

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:19:12.337

```
<?php
$x = $_POST['x'];
$y = $_POST['y'];
$result = ...
return json_encode($result); 
```

在客户端（javascript）中管理变量。在开始时声明一个变量并在 onclick 内增加/减少。

`success`jQuery 中的-`callback`定义您将如何处理 PHP 脚本返回的数据（例如，将其放在带有 的 HTML 标记中`getElementById("xyz").innerHTML = value`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:21:48.490

您可以像这样简单地将此脚本添加到您自己的脚本中

```
$('#next').click(function(){
    var x = "$x";
    var y = "$y"; 
    var url  = "url of the script";
    $.ajax({'url' : url ,
        'type' : 'post',
        'data' : {'x' : x , 'y' : y} ,
        'success' : function(data){
            // do something with your data
        }
    }); 
```

如果您需要从表单中读取脚本而不是`$x and $y`使用这些： `filter_input(INPUT_POST, 'id', FILTER_SANITIZE_STRING`或`filter_input(INPUT_GET, 'id', FILTER_SANITIZE_STRING`从地址读取它们。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-22T20:22:03.207

您的 PHP 脚本必须捕获获取变量 x 和 y 并将其传递给函数。例如

```
<?php 
  if(isset($_GET["x"]) && isset($_GET["x"]) ) {
    echo test( $_GET["x"] , $_GET["y"] );

  }

function test($x, $y) {
    return json_encode(array( $x, $y));
} 
```

但是传递变量的方式就像我做的那样非常粗糙。

在 javascript 中，你的成功函数看起来像这样

```
success:function (data) {
   console.log(data);
} 
```

# uml - 如何在 UML 对象图中显示多重性

> ID：15032474
> 
> 赞同：9
> 
> 时间：2013-02-22T20:14:27.447
> 
> 标签：uml, instance, class-diagram, object-diagram

我想知道是否有办法在 UML 中创建对象数组？

以下是我尝试使用 Modelio 作为建模环境，但您可以看到有不同的对象（即 instance[0]、instance 1]、instance[2]、instance[3]）

![在此处输入图像描述](../Images/adfacb9ba34a1a0c455b462965a97312.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-23T18:25:58.497

如您所知，有两种方法可以在类图中显示 UML 属性：属性文本和关联表示法。

考虑一个公司和员工的例子。两个有效的类图是：

![在此处输入图像描述](../Images/25c21088a098e9079e890f2f1503f60b.png)

现在让我们尝试绘制相应的对象图：

如果 fulltime_employees 的详细信息（例如年龄）很重要，则只能将它们显示为单独的对象：

![在此处输入图像描述](../Images/8c26396e4606cd776c93307127f29ef1.png)

如果细节不重要，我们可以使用属性文本表示法：

![在此处输入图像描述](../Images/c7964bccda53b1ea171df0d6c3ca7b03.png)

当对象数量更多时显示它的另一种方式（这里假设为 5）：（这也是在对象图中显示多重性的一般方式）

![在此处输入图像描述](../Images/2c526ae3ebfad0c661b79323f7428d23.png)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-17T14:33:52.840

例如，`std::vector<Class>`如果您想在类图中显示一组对象，您可以使用。

如果要显示具体对象， 可以使用`instance1:Class`, `instance2:Class`... ，但必须将它们添加到对象图中，而不是类图中。`instanceN:Class`

您不能混合类图的元素和对象图的元素，因为它们在概念上是不同的。

# java - Scala和Java中的枚举器与迭代器

> ID：15032475
> 
> 赞同：4
> 
> 时间：2013-02-22T20:14:37.603
> 
> 标签：java, scala, playframework, iterate

枚举器和迭代器有什么区别？根据我的理解，这在 Java`Enumerator`中并不是一个花哨的别名。`enum`相反，它似乎是一种类似于`Iterator`. 那么有人能够比较和对比`Enumerator`吗`Iterator`？`Play`另外，我在as中看到了一个用法

```
val data = getDataStream
val dataContent: Enumerator[Array[Byte]] = Enumerator.fromStream(data) 
```

编辑：

我倾向于认为这`Enumerator`为我们提供了实际的数据块，而`Iterator`为我们提供了指向已经分块的数据的指针，例如列表。但我不相信情况确实如此。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:34:38.670

`Enumerator`是一个[Play 类](http://www.playframework.com/documentation/2.0/Enumerators)，而不是 Java 或 Scala 类。

它是[`Iteratee`](http://www.playframework.com/documentation/2.0/Iteratees)Play 提供的 I/O 处理的一部分。Iteratees 是一个有趣的野兽——一方面，它将数据“推送”到处理程序，而不是依赖处理程序来提取数据，因此具有更好的性能。另一方面，*它*允许处理程序控制何时应该停止流。最后，可以组合迭代器，以便不同的迭代器负责输入的不同部分（例如，一个接收 HTTP 标头，另一个接收其正文）以及将它们链接起来，以便低级迭代器可以进行预处理，即然后喂给更高级别的迭代器。

上面有很多素材，自己动手吧。

它与迭代器或枚举*没有*任何关系。

# python - 对于我的 Appengine 应用程序，Python2.7 的性能比 Python2.5 差得多

> ID：15032477
> 
> 赞同：2
> 
> 时间：2013-02-22T20:14:52.587
> 
> 标签：python, performance, google-app-engine

我看到 py2.7 线程和 py2.5 之间的性能存在巨大差异。py2.5 的性能提高了 2-4 倍（取决于特定的服务器 url 调用），从而降低了延迟和 cpu 使用率（即花费了我在 py2.5 下运行同一台服务器要少得多）这里有一些统计数据.. 似乎很奇怪，因为 py2.7 被宣传为更高效、更便宜。还有人看到这个吗？这是显示性能的几个屏幕截图。我正在比较各种服务器 url 调用的 RuntimeMCyles 和 Avg Latency 以确定性能。这两者之间的唯一区别是 py25 vs py27，否则我没有更改任何代码：

Py2.7 带线程：

![Py2.7 带线程](../Images/474c1fe697809f8eb898e3a68e1c6947.png)

Py2.5（py2.5 服务器在此处运行的请求要少得多。但随着时间的推移它会跟踪相同的情况，所以这是一个很好的表示）：

![Py2.5](../Images/938880333825e1873cfce0c0fbb8e2ba.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T20:56:15.280

您的问题听起来可能是由非线程安全的代码引起的。

我会尝试附加[cProfile](https://developers.google.com/appengine/kb/commontasks#profiling)或[Google App Engine Mini Profiler](https://github.com/kamens/gae_mini_profiler)，看看是否可以解决这个问题。

其他需要检查的是[这个](http://blog.notdot.net/2011/10/Migrating-to-Python-2-7-part-1-Threadsafe)关于准备应用程序以迁移到 Python 2.7 的简单指南。

# javascript - 限制没有 if 语句的数字

> ID：15032482
> 
> 赞同：1
> 
> 时间：2013-02-22T20:15:16.423
> 
> 标签：javascript, jquery, math, if-statement

我很好奇是否有一种方法可以在不使用 if 语句的情况下使用 javascript 来限制数字。假设我有一个从 0 到 100 的数字，但我只希望它允许 30 到 70。所以任何小于 30 的数字都变为 30，大于 70 的数字变为 70。使用 if 语句，它看起来像这样：

```
var x = 0;
if (x > 70) {
   x = 70;
}
if (x < 30) {
   x = 30;
} 
```

我正在寻找更多涉及算术的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T20:19:39.817

试试这个：

```
x = Math.min(70, Math.max(30, x)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:16:56.477

总是有三元表达式？

```
var x = 0;
    x = x > 70 ? 70 : x;
    x = x < 30 ? 30 : x; 
```

你甚至可以加入他们

```
var x = 0;
    x = x > 70 ? 70 : x < 30 ? 30 : x; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:24:37.037

当然，您可以使用条件三元运算符 ( `.. ? .. : ..`) 来完成，但我假设您只是在询问仅使用数学来完成，没有条件。如果是这样，那么您可以使用 Absolute 函数来做到这一点：

```
var x30 = x - 30;
var x30 = (x30 + Math.abs(x30)) / 2  + 30;
var x70 = 70 - x;
var x70 = 70 - (x70 + Math.abs(x70)) / 2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T20:18:29.730

您可以使用条件（三元）运算符并像这样链接它们

```
var x = 0;
x = x > 70 ? 70 : x < 30 ? 30 : x; 
```

不知道这是多么可读:)

或者，您可以使用 Math.min() 和 Math.max()

```
var x = 0;
x = Math.max(30, Math.min(x, 70)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T20:19:19.770

## 短路

```
var x = Math.floor(Math.random()*100)

x = x > 70 ? 70 : (x < 30 ? 30 : x); 
```

单行，没有 if 语句。

## 或者您可以使用最大/最小

```
var x = Math.floor(Math.random()*100)

x = Math.min(70, Math.max(30, x)); 
```

# azure - Windows Azure：如何恢复试用帐户 SQL Server 数据

> ID：15032483
> 
> 赞同：3
> 
> 时间：2013-02-22T20:15:23.483
> 
> 标签：azure, azure-storage

我创建了一个试用版 Windows Azure 帐户，但它的时间已过期。现在我去订阅了，但是我用我的试用帐户创建的 SQL Server 数据库被禁用了。

如何检索我放在那里的数据？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T22:00:56.903

几周前，我的一个客户遇到了这个问题。我们让他们设置了 Azure 3 个月免费试用，同时我们完成了他们的解决方案的开发和测试。他们将我设置为共同管理员，完成后我为他们部署了解决方案。

快进 3 个月后，我收到一封来自客户的电子邮件和电话，他的客户通知他该站点正在显示站点不可用消息。

我能够从 Azure 支持部门获得有关此问题的帮助。当您打开支持票时，它实际上被视为计费问题，因此启动支持票是免费的。

您需要做的就是登录 Azure 管理门户并从顶部菜单中选择“支持”选项。单击“技术和计费支持”下的“获取支持”链接。此时，将弹出一个自定义的“联系 Microsoft 支持”对话框，其中列出了您的所有订阅以及选择支持类型的选项。在这种情况下，您将选择过期订阅并选择“计费”作为支持类型以及相应的区域和语言，然后选择创建工单。

我不记得该步骤之后出现的确切选项，但您可以选择过期服务的选项并输入一些评论来描述您希望访问过期试用版中的数据。

Azure 支持工程师在下一个工作日回复我们并回复“我查看了您的帐户。如果您只需要访问您的网站和数据库，您无需迁移任何内容。我可以重新激活您过期的试用订阅作为现收现付订阅。您的所有数据仍将在您的存储帐户中。”

最后，我们终究还是不需要他们的帮助。与所有此类问题一样，我已经开始使用替代计划，以防他们无法简单地重新激活帐户。幸运的是，有了这个解决方案，除了数据库之外，没有任何数据存储在任何地方。

我有源代码控制中的原始 Web 项目，还有一个最近的 .bacpac 导出的 SQL Azure 数据库，该数据库存储在另一个未过期帐户下的 Azure 存储中。我们建立了一个新的现收现付帐户，并在几个小时内重新部署了站点并恢复了数据库。

如果我们没有“B 计划”选项，他们似乎可以简单地重新激活过期的帐户。每当我在某个问题上需要帮助时，Azure 支持对我来说都很棒，因此它们始终是最好的起点。

干杯，杰森

# javascript - HTML5 最佳动画框架

> ID：15032487
> 
> 赞同：0
> 
> 时间：2013-02-22T20:16:00.380
> 
> 标签：javascript, html, canvas

（对不起我的英语不好）

我不敢相信画布上动画的唯一方法是'setInterval（）'有人知道吗？setInterval 太慢了，它在旧设备上的工作很糟糕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:17:48.210

使用 CSS3 动画和过渡。
大多数现代浏览器都会硬件加速它们；它们将比你用 Javascript 编写的任何东西都要快得多。

如果您的动画对于纯 CSS 来说过于复杂，请使用`requestAnimationFrame()`，这将使您的动画以浏览器帧速率运行并避免不必要的计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:20:45.253

尝试使用`setTimeout`而不是`setInterval`. 它通常工作得更顺畅。

# javascript - 在 Fabric.js 中分层画布对象

> ID：15032497
> 
> 赞同：24
> 
> 时间：2013-02-22T20:16:55.257
> 
> 标签：javascript, sorting, fabricjs, layer

有没有办法通过官方 API 在 Fabric.js 画布上分层对象？现在我发现这样做的唯一方法是手动遍历 canvas._objects 并重新排序它们，以便它们以特定顺序绘制。有没有更好的方法来做到这一点，它不会（可能）破坏对象？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-02-23T05:05:27.887

[编辑] 我在下面更正了我的信息（我的错，我最初考虑的是 KineticJs api）。

FabricJS 有这些改变对象 z-index 的 API 方法：

```
canvas.sendBackwards(myObject)
canvas.sendToBack(myObject)
canvas.bringForward(myObject)
canvas.bringToFront(myObject) 
```

在幕后，FabricJs 通过从 getObjects() 数组中删除对象并将其拼接回所需位置来更改 z-index。它有一个很好的优化，可以检查相交的对象。

```
bringForward: function (object) {
       var objects = this.getObjects(),
           idx = objects.indexOf(object),
           nextIntersectingIdx = idx;

       // if object is not on top of stack (last item in an array)
       if (idx !== objects.length-1) {

         // traverse up the stack looking for the nearest intersecting object
         for (var i = idx + 1, l = this._objects.length; i < l; ++i) {

           var isIntersecting = object.intersectsWithObject(objects[i]) ||
                                object.isContainedWithinObject(this._objects[i]) ||
                                this._objects[i].isContainedWithinObject(object);

           if (isIntersecting) {
             nextIntersectingIdx = i;
             break;
           }
         }
         removeFromArray(objects, object);
         objects.splice(nextIntersectingIdx, 0, object);
       }
       this.renderAll();
     }, 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-01-26T18:01:12.190

第 1 步：您可以使用`preserveObjectStacking: true`

第 2 步：然后使用 sendtoback,sendtofront....fabricjs 选项，如下所示

[在这里回答](https://stackoverflow.com/a/41879620/1390678)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-06T07:43:57.727

如果您想为所有对象设置特定的顺序，而不是向前/向后移动一个对象，迭代调用将/发送到前/后是很慢的。

您可以使用以下代码`bringToFront`作为灵感来加速此用例：[https ://github.com/kangax/fabric.js/blob/586e61dd282b22c1d50e15c0361875707e526fd8/src/static_canvas.class.js#L1468](https://github.com/kangax/fabric.js/blob/586e61dd282b22c1d50e15c0361875707e526fd8/src/static_canvas.class.js#L1468)

并这样做：

```
fabric.Canvas.prototype.orderObjects = function(compare) {
    this._objects.sort(compare);
    this.renderAll();
} 
```

其中 compare 定义了排序，例如：

```
function compare(x,y) {
    return x.getWidth() * x.getHeight() < y.getWidth() * y.getHeight();
}

some_canvas.orderObjects(compare) 
```

如果您想将较小的物体放在前面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-23T13:07:15.923

我就是这样做的。我为每个织物对象添加了一个 zIndex 属性，然后在将它们添加到画布后调用了一个排序函数：

```
const CIRCLE_INDEX = 1
let object = new fabric.Circle({
    left: 10,
    top: 10,
    radius: 5
    ...other properties
    zIndex: CIRCLE_INDEX
}); 
```

然后在添加对象后调用这样的函数

```
const sortObjects = () => {
    canvas._objects.sort((a, b) => (a.zIndex > b.zIndex) ? 1 : -1);
    canvas.renderAll();
} 
```

# java - 如何根据要求创建多个类对象

> ID：15032498
> 
> 赞同：0
> 
> 时间：2013-02-22T20:16:55.127
> 
> 标签：java, class

我最近开始用 Java 创建游戏。对于这个游戏，我创建了一个名为 Tower 的类。在这个类中，我有一些整数变量和一些字符串。现在我想知道是否有办法创建一个新的 Tower 对象来响应鼠标事件。

例如：屏幕上的单击事件应该创建一个新的 Tower 对象（然后将坐标添加到 Tower 对象）。而且，如果您单击屏幕上的其他位置，则会使用新坐标创建另一个 Tower 对象。

我想要这样的东西，因为玩家可以购买多个塔并将它们放置在他或她喜欢的任何地方（这些塔将具有不同的属性）。有没有办法做到这一点？这甚至可能吗？如果没有任何建议：P？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:40:56.657

尝试这种方法这不是最终和完美的答案，但希望它对您的问题有用

```
LinkedList<Tower> list = new LinkedList<Tower>(); 
```

在鼠标事件上：

```
list.add(new Tower());
list.get(0).x = 4;
list.get(0).y = 5;
//......
System.out.println("x  = "+list.get(0).x);  
System.out.println("y  = "+list.get(1).y); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:45:55.357

这是一些代码片段，它将生成五个带有 UUID 的塔 - 在 HashMap 中跟踪每个塔（来源 Jack Maney）。

您只需要修改它以从循环`onClick()`而不是`for`循环创建。

```
final class TowerGenerator
{
   private final Map<UUID, Tower> towerMap = new HashMap<UUID, Tower>();

   public void generateFiveTowers()
   {
      for (int i = 0; i < 5; i++)
      {
         final UUID uuid = UUID.randomUUID();
         towerMap.put(uuid, new Tower(uuid));
      }
   }
} 
```

# c++ - std::unique_ptr 删除函数，initializer_list - 驱动分配

> ID：15032501
> 
> 赞同：6
> 
> 时间：2013-02-22T20:17:03.137
> 
> 标签：c++, c++11, unique-ptr, initializer-list

全部，

当我使用初始化列表格式实例化一个小部件数组时，一个指向成员变量小部件实例的裸指针会编译，但在更改为 std::unique_ptr<> gcc 后会给出有关已删除函数的编译错误。

$ unname -a

Linux .. 3.5.0-21-generic #32-Ubuntu SMP Tue Dec 11 18:51:59 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux

$ g++ --版本

g++ (Ubuntu/Linaro 4.7.2-5ubuntu1) 4.7.2

此代码给出以下编译器错误：

```
#include <stdlib.h>
#include <memory>

class Widget
{
public:
    Widget() {}
};

class W1 : public Widget
{
public:
    W1() {}
};

class W2 : public Widget
{
public:
    W2() {}
};

class WFactory
{
public:
    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}

    ~WFactory() { _w.reset(nullptr); }
    // ~WFactory() { delete _w; }  <--- for naked ptr

private:
    // NOTE: does not compile
    std::unique_ptr<Widget>  _w; 
    // NOTE: does compile
    // Widget* _w;
};

int main()
{
    std::unique_ptr<Widget> a(new W1()); // <--- compiles fine

    WFactory wf[] { 4, "msg" };          // <--- compiler error using unique_ptr<>
} 
```

错误：

```
$ g++ -o unique_ptr  -std=c++11 -Wall  unique_ptr.cpp 
unique_ptr.cpp: In function ‘int main()’:
unique_ptr.cpp:36:30: error: use of deleted function ‘WFactory::WFactory(const WFactory&)’
unique_ptr.cpp:22:7: note: ‘WFactory::WFactory(const WFactory&)’ is implicitly deleted because the default definition would be ill-formed:
unique_ptr.cpp:22:7: error: use of deleted function ‘std::unique_ptr<_Tp, _Dp>::unique_ptr(const std::unique_ptr<_Tp, _Dp>&) [with _Tp = Widget; _Dp = std::default_delete<Widget>; std::unique_ptr<_Tp, _Dp> = std::unique_ptr<Widget>]’
In file included from /usr/include/c++/4.7/memory:86:0,
             from unique_ptr.cpp:2:
/usr/include/c++/4.7/bits/unique_ptr.h:262:7: error: declared here
unique_ptr.cpp:36:30: error: use of deleted function ‘WFactory::WFactory(const WFactory&)’
unique_ptr.cpp:36:14: warning: unused variable ‘wf’ [-Wunused-variable] 
```

我对任何一个都不知所措：幕后的机制会产生删除的 fcxn；或者更简单地说，为什么 std::unique_ptr<> 的表现力与裸 ptr 相比似乎受到限制。

我的问题是：

*   飞行员失误？
*   编译器错误？
*   我可以让我想要的代码在一些改变的情况下工作吗？

谢谢你。

**编辑 1**

根据您的回答，我很感激，我可以对 WFactory 进行以下更改：

（**标记为不道德的代码**）

```
class WFactory
{
public:
    WFactory(const WFactory& wf)
    {
        (const_cast<WFactory&>(wf)).moveto(_w);
    }

    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}

    ~WFactory() { _w.reset(nullptr); }

    void moveto(std::unique_ptr<Widget>& w)
    {
        w = std::move(_w);
    }
private:
    std::unique_ptr<Widget>  _w; 
}; 
```

现在程序编译并运行。我感谢标准人员出于某种原因编写规范，因此我将我的结果发布为我手头的案例的善意专业化，我真的想强调 ptr 的独特性。

**编辑 2**

根据乔纳森的回复，以下代码不会抑制隐式移动 ctor：

```
class WFactory
{
public:
    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}

private:
    std::unique_ptr<Widget>  _w; 
}; 
```

请注意，根本没有`~WFactory() {..}`。

也许有 ya-ans，但我发现在 Main() 中对 wf[] 使用 c++11 风格的迭代会导致 no-copy-ctor-for-WFactory 错误。那是：

```
int Main()
..
    WFactory wf[] { 4, "msg" };

    for ( WFactory iwf : wf )    <---- compiler error again
        // ..

    for (unsigned i = 0; i < 2; ++i)  <--- gcc happy
        wf[i] //  ..
} 
```

我想新的 c++11 风格的迭代正在做一个对象复制是不言而喻的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T20:29:43.767

根据 C++11 标准的第 8.5.1/2 段：

> 当聚合由初始化列表初始化时，如 8.5.4 中所指定，初始化列表的元素被视为聚合成员的初始化，按递增的下标或成员顺序。每个成员都是从相应的初始化子句**复制初始化的。**[...]

因此，对于每个元素，复制初始化涉及创建目标类型的临时对象，然后使用该临时对象来复制构造数组的元素。

但是，您的类包含一个成员，其类型是 的实例`unique_ptr`，它是不可复制的。这也使您的课程不可复制。

此外，虽然`unique_ptr`是*可移动*的，但您的类不是，因为编译器隐式生成移动构造函数被显式定义的析构函数的存在所抑制。如果不是这种情况（即，如果您为您的类明确定义了移动构造函数），复制初始化将起作用（参见 8.5/15）。

尝试更改`WFactory`如下定义以查看：

```
class WFactory
{
public:
    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}
    WFactory(WFactory&& f) : _w(std::move(f._w)) {}
    ~WFactory() { _w.reset(nullptr); }
private:
    std::unique_ptr<Widget> _w;
};

int main()
{
    std::unique_ptr<Widget> a(new W1());
    WFactory wf[] { 4, "msg" };          // OK
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T22:39:30.340

> 产生删除 fcxn 的幕后机制；

数组只能这样初始化，如果类型是可复制或可移动的，并且`unique_ptr`不可复制，因此`unique_ptr`默认情况下具有成员的类是不可复制的，并且您的类型具有用户定义的析构函数，它禁止隐式移动构造函数，所以你的类型也不能移动。

> 或者更简单地说，为什么`std::unique_ptr<>`与裸 ptr 相比，它的表现力似乎受到限制。

`unique_ptr`正在将您从严重的错误中解救出来。使用裸指针，您的类型非常不安全并且会导致未定义的行为，因为您没有复制构造函数，因此指针被复制然后被两个不同的对象删除两次。繁荣，你的程序有未定义的行为。 `unique_ptr`通过防止其被复制来修复您的课程，这是安全且正确的。

您可以通过多种方式使其工作，最简单的是删除用户定义的析构函数，这使您的类可移动，并且数组初始化将编译。

或者，如果您出于其他原因需要用户定义的析构函数，您仍然可以通过编写用户定义的移动构造函数来显式移动`_w`成员来使其工作。

如果由于某种原因不可能，您可以通过添加默认构造函数来使其工作，因此可以默认构造数组元素，然后对其进行移动分配：

```
class WFactory
{
public:
    WFactory() = default;
    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}

private:
    std::unique_ptr<Widget>  _w; 
};

int main()
{  
    WFactory wf[2];
    wf[0] = WFactory(4);
    wf[1] = WFactory("msg");
} 
```

您编辑的版本是不道德的并且非常可疑，您不应该那样抛弃`const`并且您不应该从左值移动，尤其是不要离开左`const`值。不要去那边。而是更改您使用该类的方式以避免需要复制它，**或者**编写一个有效的复制构造函数来对拥有的对象进行深层复制：

```
class Widget
{
public:
    Widget() {}
    virtual std::unique_ptr<Widget> clone() const = 0;
};

class W1 : public Widget
{
public:
    W1() {}
    virtual std::unique_ptr<Widget> clone() const
    { return std::unique_ptr<Widget>(new W1(*this)); }
};

class W2 : public Widget
{
public:
    W2() {}
    virtual std::unique_ptr<Widget> clone() const
    { return std::unique_ptr<Widget>(new W2(*this)); }
};

class WFactory
{
public:
    WFactory(const int i)   : _w(new W1()) {}
    WFactory(const char* s) : _w(new W2()) {}
    WFactory(const WFactory& w) : _w(w._w->clone()) {}
    // ... 
```

最好的方法是让类可移动，一个好的方法是遵循[零规则](http://flamingdangerzone.com/cxx11/2012/08/15/rule-of-zero.html)

# design-patterns - 使用带代理的适配器来使用 3rd 方库

> ID：15032506
> 
> 赞同：1
> 
> 时间：2013-02-22T20:17:41.813
> 
> 标签：design-patterns

我正在尝试使用一些 excel 操作 3rd 方库。这个库正在使用一些接口来处理工作簿和工作表。所以我尝试使用适配器模式来与 3rd 方库分离。我已将适配器用于工作簿和工作表。如您所知，工作簿中有许多工作表。在工作簿适配器中存储工作表适配器是一种解决方案，但在我的代码和库中管理和同步工作表似乎有点困难。所以似乎使用一些代理作为工作表列表是答案。但也好像用锤子杀死苍蝇。所以问题是解决方案是什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T02:34:45.173

从您的问题中，我无法获得任何进一步的细节，但您的方法似乎是一个明智的解决方案。然而，设计模式不是对具体问题的回答，而是处理它的一般策略。然后你能做的就是争论为什么设计正确匹配你想要解决的问题：

*   由于 Facade 模式更适合简化子系统的接口，因此更适合这种场景且常用的结构模式是 Adapter。
*   就像在 和 的经典示例中一样`ProxyImage`，`RealImage`使用工作表的代理可以避免在不需要时加载它们。此外，如果将它与适配器结合使用，您将获得与前一种情况相同的优势。

![在此处输入图像描述](../Images/577da0673ad365c331f54337e1e25dae.png)

最后，我不认为您的解决方案过于复杂并且从长远来看是值得的：减少与 3rd 方库的耦合是一项合理的努力，但不会增加太多复杂性。

# jquery - jquery ajax 内存泄漏

> ID：15032507
> 
> 赞同：4
> 
> 时间：2013-02-22T20:17:42.437
> 
> 标签：jquery, ajax, memory-leaks

我绝对不是第一个遇到 jQuery 内存泄漏问题的人，但是我找不到我正在寻找的许多与我所看到的类似的问题的答案。

首先，泄漏位：

```
$(document).ready(function ivr_grabber(){
var xhr = $.ajax({
    url: '/ivr/inprogress',
    timeout: 3000,

    success: function(data){
        $('#open-ivrs').html(data);
        data = null;
    },
    complete: function(){
        setTimeout(ivr_grabber, 3000);
    }
});
xhr = null;
}); 
```

PHP 代码返回一个表格，其中包含一些被我们的 PBX 呼叫的人。我已经注释掉了 .html(data) 行，它没有任何区别。我也删除了setTimeout，然后放回去，没有运气。我试图取消设置可能导致此泄漏的所有值，但我无法弄清楚它来自哪里。

它似乎以每个 ajax 调用约 5 KB 的速率泄漏。有什么想法吗？

在 Chrome 上使用 jQuery 1.7.2

我一直在拍摄堆快照，以上都没有影响泄漏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:52:48.347

我发现了内存泄漏问题。它是在：

```
setTimeout(); 
```

我正在调用一个函数名，它调用该函数，然后设置一个超时来调用该函数。有不断升级的超时堆积。实际上，我需要使用匿名函数，如下所示：

```
setTimeout(function(){
    some_func();
}, 5000); 
```

编辑：这实际上并没有解决 jQuery 的 ajax 方法容易产生的微小的固有句柄积累。我还没有想办法解决这个问题。

编辑 2：我遇到的另一个导致内存泄漏的问题是挂载事件处理程序。像这样重新定义事件处理程序：

```
$('#something').click(function(){ do stuff }); 
```

不会删除旧的 .click() 处理程序，我发现使用 .unbind('click') 解决了我遇到的许多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:20:01.473

我对此不是 100% 确定的，但请尝试在 document.ready 处理程序的范围之外声明函数 ivr_grabber。另外，为什么将 jqXHR 对象设置为 null？据我所知，这没有任何作用，并且可能会干扰异步请求。

```
$(document).ready(ivr_grabber);
function ivr_grabber() {} 
```

# c# - 在 C# 中引用父作用域中的对象 - 可能吗？

> ID：15032513
> 
> 赞同：0
> 
> 时间：2013-02-22T20:18:03.067
> 
> 标签：c#, reference, scope

我有一个创建“数据持有者”对象的类，然后用一些修饰符类修改这个对象，类似于：

```
public class Process {
    public void Run() {
        var dataHolder = new DataHolder();

        var firstModification = new FirstModification(dataHolder);
        firstModification.Run();

        var secondModification = new SecondModification(dataHolder);
        secondModification.Run();

        //etc.
    }
}

public class FirstModification {

    DataHolder data_holder;

    public FirstModification (DataHolder dh) {
        data_holder = dh;
    }

    public void Run() {
        // do something with data_holder
    }
}

public class SecondModification {
    // etc.
} 
```

在此代码中，每个修改构造函数必须接收`dataHolder`作为参数，并带有相应的样板，修改器类中的重复代码。

因此，如果可能和/或建议，我希望每个修改器对象都“已经知道”方法`dataHolder`内部存在的活动对象`Process.Run()`（可以说是它的“父范围”），而无需将其作为修饰符构造函数的参数。

编辑：我正在尝试实现管道（又名管道和过滤器）设计模式，灵感来自[此处](http://keyvan.io/pipes-and-filters-pattern-in-net)和[此处](http://stevenatkinson.wordpress.com/2009/03/02/pipeline-design-pattern/)描述的内容。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:20:37.473

> 因此，如果可能和/或建议，我希望每个修改器对象都“已经知道” Process.Run() 方法中存在的活动 dataHolder 对象（可以说是它的“父范围”），没有需要将其作为参数传递给修饰符构造函数。

可能的？是的，通过一个线程局部变量来维护“`DataHolder`这个线程的当前”（或者只是一个简单的静态变量，甚至）。

推荐的？不，我不会这么说。我认为您目前没有任何问题-您认为将所有内容都隐含会获得什么好处？

没有什么可以让你回到堆栈并在调用方法中找到局部变量......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:21:36.837

您必须以*某种方式*关联实例

```
var firstModification = new FirstModification() 
```

等与实际数据。

目前的做法还不错。如果您希望您的修改实例能够访问“父范围”，那么您必须将父对象引用传递给它们。这实际上为他们提供了比他们实际需要的更多访问父对象的权限，我不鼓励这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:28:42.230

对 Modifier 类进行超类化并将 DataHolder 对象作为静态变量从 Process 类中可用如何？

```
public class SuperModifierClass
{
    DataHolder dataHolder;

    public SuperModifierClass()
    {
        dataHolder = Process.DataHolder;
    }
}

public class FirstModifier
{
    public FirstModifier() : base() // Is base called implicitly by default? I forgot...
    {
    }
} 
```

另一种选择是通过 MEF 和 Unity（谷歌这些术语）等框架来查看控制反转。这些本质上允许您做的是注册可以在实例化具有它们作为参数的新类时自动加载的对象。您会说“好吧，如果有人需要 DataHolder 对象，请使用这个”当您通过此类框架实例化修改类时，所谓的“容器”实际上会通过询问它是否已注册并获取参数来解析参数注册的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T20:21:05.573

为您的参数使用`ref`关键字。

```
...
var firstModification = new FirstModification(ref dataHolder);
...
public FirstModification (ref dataHolder dh) {
    // Make changes to dh
}
... 
```

这会将对 dataHolder 对象的引用从 Process 类传递给您的 FirstModification 方法。

# c - 使用 fscanf 将数据输入到动态结构指针数组中？

> ID：15032522
> 
> 赞同：2
> 
> 时间：2013-02-22T20:18:32.663
> 
> 标签：c, segmentation-fault, dynamic-arrays, scanf

我有一个任务并且遇到了一些障碍。以下代码应该从文件中获取输入，将其读入我定义的结构中，并且对输入行数没有任何限制。但是，它在第*​​ 24*行出现段错误：

```
1 #include <stdio.h>
2 #include <stdlib.h>
3 #include <string.h>
4
5 typedef struct __student {
6         int ID;
7         char fname[33];
8         char lname[33];
9         float grade;
10 } student;
11
12 void partA(FILE *fp) {
13
14         int i, r;
15         i = r = 0;
16         int N = 1000;
17         student **S;
18
19         S = (student **)malloc(sizeof(student *) * N);
20
21
22         while(!feof(fp)){
23                 fscanf(fp, "%d %[^,], %s %f", &S[i]->ID, S[i]->lname, S[i]->fname, &S[i]->grade ); // segfault occurs on this line
24                 printf("%d %s %s %f\n", S[i]->ID, S[i]->fname, S[i]->lname, S[i]->grade);
25                 i++;
26                 printf("Something's happening, at least");
27                 if(i == N){
28                         N *= 2;
29                         S = (student **)realloc(S, sizeof(student) * N);
30                         if(S == NULL) {
31                                 printf("Memory reallocation failed; Fatal error.");
32                                 break;
33                         }
34                 }
35         }
36 } 
```

我之前测试过代码，虽然当时我使用的是静态数组并想更改为动态大小。然而，即使 gdb with 除了行号之外提供的帮助也很少。我是否需要单独 malloc 每个**学生**结构，或者我在这里错过了一些完全不同的东西？

**编辑**：当我在while循环中为每个*学生分配内存时，代码似乎有效：*

```
S[i] = (student *)malloc(sizeof(student)); 
```

所以这似乎解决了这个问题。我会进行一些测试来确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:14:49.593

除了你的 malloc 问题之外，这两行还有很大的问题

```
while(!feof(fp)){
    fscanf(fp, "%d %[^,], %s %f", &S[i]->ID, S[i]->lname, S[i]->fname, &S[i]->grade ); // segfault occurs on this line 
```

一个问题是您的`lname`和`fname`字段是固定大小的 33 字符数组，这意味着如果您的输入此时有超过 32 个字符，您将跑出数组的末尾并损坏内容。另一个问题是您没有检查返回值`fscanf`来查看是否出现问题（例如 EOF），导致您在到达文件末尾时尝试打印垃圾记录。你想要的是这样的：

```
while (fscanf(fp, "%d %32[^,],%32s%f", &S[i]->ID, S[i]->lname, S[i]->fname, &S[i]->grade) == 4) { 
```

为您的循环控制。

**编辑**

问题`while(!feof(fp))`（以及为什么它几乎总是一个错误）是`feof(fp)`只有在您尝试读取文件末尾之后才返回 true 。在你读完最后一行之后，`feof(fp)`仍然返回 false，所以你再次进入循环并尝试读取另一行。该读取失败，但由于您不检查 的返回值`fscanf`，因此您没有意识到它，而是在您的数组中获得了一个垃圾额外值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:29:30.787

在第 19 行，您为 N 个学生指针分配了足够的空间，但没有为学生自己的结构分配空间。您需要执行以下操作：

```
for( int i = 0; i < N; i++) {
     S[i] = malloc(sizeof(struct __student));
} 
```

# sql - Rails 3 使用 select distinct

> ID：15032523
> 
> 赞同：1
> 
> 时间：2013-02-22T20:18:37.007
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, select, distinct

我有 3 张桌子需要连接在一起。

我有`Events`,`Places`和`Boroughs`

地方属于自治市镇并有许多活动

从给定日期的事件列表中，我想检索所有不同行政区的列表。

```
Event.where(day_of_week: 2).joins(:place,:borough).select("DISTINCT(boroughs.name) AS name") 
```

生成 SQL：

```
SELECT DISTINCT(boroughs.name) AS name FROM "events" INNER JOIN "places" ON "places"."id" =        
"events"."place_id" INNER JOIN "places" "places_events_join" ON "places_events_join"."id" = 
"events"."place_id" INNER JOIN "boroughs" ON "boroughs"."id" = 
"places_events_join"."borough_id" WHERE "events"."active" = 't' AND "events"."day_of_week" = 3 
```

当我将它放入我的 postgres DB 控制台时，它看起来很完美并且可以工作，但是对于我的 rails 控制台，我得到了。

```
#<Event >, #<Event >, #<Event >, #<Event >, #<Event >, #<Event >, #<Event >, #<Event >, #<Event >, #<Event > 
```

更新：

Mr.The Walrus 的建议非常有效，但我仍然很困惑，为什么当 SQL 本身产生相同的结果时，反过来却行不通。

```
Borough.joins(:events).where(:events => {:day_of_week => 2}).select("DISTINCT(boroughs.name) AS name") 
```

产生：

```
[#<Borough name: "richmond">, #<Borough name: "southwark">, #<Borough name: "brent">, #<Borough name: "city of london">] 
```

但是这个

```
Event.where(:events => {:day_of_week => 2}).joins(:borough).select("DISTINCT(boroughs.name) AS name") 
```

产生：

```
[#<Event >, #<Event >, #<Event >, #<Event >, #<Event >] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:23:59.920

您需要为您的列命名，否则 ActiveRecord 将不知道如何映射它。

```
Event.where(day_of_week: 2).joins(:place,:borough).select('DISTINCT(boroughs.name) as "bouroughs.name"') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:31:27.030

我想我会这样做：

```
Borough.joins(:events).where(:events => {:day_of_week => 2}) 
```

默认情况下，Rails 将使用内部连接，因此它将排除任何没有匹配事件的自治市镇。如上所述，您实际上根本不需要用于查询的位置数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T12:24:16.917

从 Rails 3.2 开始，尝试[Pluck](http://guides.rubyonrails.org/active_record_querying.html#pluck)

```
Event.where(:events => {:day_of_week => 2}).joins(:borough).uniq.pluck('boroughs.name') 
```

应该管用。

如果您打算将其与预先警告的范围链接起来，延迟加载将导致它无法按预期工作，而是执行类似的操作

```
def self.somemethod
  joins(:borough).pluck('boroughs.name').uniq
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-22T20:27:34.423

首先，别名列名，

```
select("DISTINCT boroughs.name as borough_name") 
```

然后将该名称作为字段访问。

```
events = Event.where(day_of_week: 2).joins(:place,:borough).select("DISTINCT boroughs.name as borough_name")
events.map{|event| event.borough_name} 
```

# silverlight-4.0 - 将 0 转换为图像

> ID：15032526
> 
> 赞同：0
> 
> 时间：2013-02-22T20:18:50.197
> 
> 标签：silverlight-4.0, telerik, telerik-grid, ivalueconverter

我有一个带有两列的 Telerik rad 网格，1\. isconstraint，2\. 数量

isconstraint 是一个布尔值，它显示真假。数量是整数

如果 isconstraint 为假，我的要求是将数量列中的 0 转换为图像或颜色画笔。

我尝试使用 IvalueConverter。我试图将 Isconstraint 作为转换器参数传递。在运行时，它成功构建，但没有加载页面。谁能帮我解决这个问题。非常感谢您。我的代码看起来像这样。

```
 <telerik:GridViewDataColumn DataMemberBinding="{Binding LastQtyAvail}"                                                                                
                                                Width="130"                                             
                                                IsReadOnly="True" TextAlignment="Right" HeaderTextAlignment="Center">
                                                <telerik:GridViewDataColumn.CellTemplate>
                                                            <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image x:Name="img" Visibility="Visible" Source="{Binding LastQtyAvail,Converter={StaticResource QuantityToImageConverter},ConverterParameter={Binding IsConstraint}}" Width="100" Height="100"/>
                                                            <TextBlock Text="{Binding LastQtyAvail}">
                                                            </TextBlock>
                                                        </StackPanel>
                                                            <!--<Border BorderThickness="1"
                                                                        CornerRadius="5"
                                                                        VerticalAlignment="Top"
                                                                        BorderBrush="Black"
                                                                        Margin="0"
                                                                        Background="{Binding LastQtyAvail, 
                                                                        Converter={StaticResource QuantityToImageConverter},ConverterParameter={Binding IsConstraint}}">                                                                

                                                                <Image x:Name="img" Visibility="Visible" Source="{Binding LastQtyAvail,Converter={StaticResource QuantityToImageConverter},ConverterParameter={Binding IsConstraint}}" Width="100" Height="100"/>
                                                            <TextBlock Text="{Binding LastQtyAvail}">
                                                            </TextBlock>
                                                        </Border>-->

                                                    </DataTemplate>
                                                </telerik:GridViewDataColumn.CellTemplate>

                                            </telerik:GridViewDataColumn>

<telerik:GridViewDataColumn DataMemberBinding="{Binding IsConstraint, Mode=TwoWay}" HeaderTextAlignment="Center"                                                                                
                                                IsGroupable="False" IsVisible="{Binding IsColumnVisibleToCustomer, Source={StaticResource PFOViewModel}}"
                                                IsReadOnly="{Binding CanExecuteProductUpdateConstrain, Converter={StaticResource BooleanNotConverter}, Mode=OneWay}"
                                                Background="#77ADD8E6"                                                                                
                                                Width="74" /> 
```

而valueconverter cs文件是

```
public class QuantityToImageConverter : IValueConverter
    {

        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            //string path = string.Empty;
            //int result = (int)value;

            //string falsePath = "/Brightstar.VSO;component/Assets/DataGrid/False.png";

            //if (parameter == null)
            //{
            //    //int imagePaths = Convert.parameter.ToString().Split('|');
            //    //if (imagePaths.Length == 2)
            //    //{
            //    //    truePath = imagePaths[0];
            //    //    falsePath = imagePaths[1];
            //    //}
            //}

            //if (parameter != null)
            //{
            // // int imagePaths = Convert.parameter.ToString().Split('|');
            //    int imagePaths = Convert.Parameter.Tostring().Split('1');
            //    if (imagePaths.Length == 2)
            //    {

            //        falsePath = imagePaths[1];
            //    }
            //}

            ////if (result==0 && )
            ////{

            ////}
            ////else
            ////{
            ////    path = falsePath;
            ////}

            Int32 id = System.Convert.ToInt32(value);

            LinearGradientBrush brush = new LinearGradientBrush();
            brush.StartPoint = new Point(0, 1);
            brush.EndPoint = new Point(0, 0);
            brush.GradientStops.Add(new GradientStop()
            {
                Color = Colors.White,
                Offset = 0
            });
            brush.GradientStops.Add(new GradientStop()
            {
                Color = Color.FromArgb(
                    200,
                    System.Convert.ToByte((id * 103) % 256),
                    System.Convert.ToByte((id * 157) % 256),
                    System.Convert.ToByte((id * 233) % 256)
                ),
                Offset = 1
            });

            return brush;

            //ImageSourceConverter conv = new ImageSourceConverter();
            //return conv.ConvertFromString(falsePath);
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            return 0;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T20:40:12.370

我通过以下链接解决了它

[http://www.scottlogic.co.uk/blog/colin/2009/06/silverlight-multibindings-how-to-attached-mutiple-bindings-to-a-single-property/](http://www.scottlogic.co.uk/blog/colin/2009/06/silverlight-multibindings-how-to-attached-mutiple-bindings-to-a-single-property/)

这个对我有用...

# jquery - jQuery函数将alpha添加到元素bg

> ID：15032527
> 
> 赞同：5
> 
> 时间：2013-02-22T20:18:58.410
> 
> 标签：jquery

我试图制作检查元素的背景并将其背景更改为具有 alpha 通道的功能。函数有这种形式：

```
$.fn.bgalpha = function(alpha) {
    var bg = $(this).css('background-color');
    //...
} 
```

但是：当设置正常颜色时，chrome将bg返回为rgb，当没有bg时返回为零的rgba，即8总是返回十六进制，ie9在没有bg时返回“透明”，当有bg时返回rgb等等。这么多不同案例。

我想要做的是 > 从对象的 bg 颜色中获取 r,g,b，将其添加到“a”通道并将元素 bg 设置为具有所有值的 rgba。但是当我们谈论交叉浏览时，从简单的事情开始变得棘手和复杂。

您知道如何以“通用”方式使用这些颜色吗？在不同的情况下，我将值“无”、“透明”、“rgba”、“rgb”或“hex”作为 bg 的初始值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:53:23.077

包括[jQuery Color 插件](https://github.com/jquery/jquery-color/)（它是官方认可的）并使用它的`.alpha()`方法。

以下代码片段将更改背景颜色，`this`使其 50% 透明：

```
var clr2 = $.Color(this,'background-color').alpha(0.5);
$(this).css('background-color', clr2.toRgbaString()); 
```

或一行：

```
$(this).css('background-color', $.Color(this,'background-color').alpha(0.5).toRgbaString()); 
```

[http://jsfiddle.net/mblase75/aea3h/](http://jsfiddle.net/mblase75/aea3h/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:24:46.040

```
$.fn.bgalpha = function(alpha)
{
    return $(this).each(function(){
        $(this).css('background-color', $.Color(this,'background-color').alpha(alpha).toRgbaString());          
    });
} 
```

使用[Blazemonger 的](https://stackoverflow.com/a/15032998/901048)解决方案 - 这是最终代码。

使用：

```
$('.something').bgalpha(0.8); 
```

它需要`jquery.color.js`（缩小后7kb）

# c++ - c ++查找映射值和键

> ID：15032529
> 
> 赞同：0
> 
> 时间：2013-02-22T20:19:00.727
> 
> 标签：c++, map, key

我试图找出一种方法来搜索地图中的键，在消息中返回它，获取找到的键的值，然后在另一条消息中返回它。例如，下面的类有一个在杂货店找到的水果列表，我想创建一个 if than else 语句来在地图中找到水果名称，在下面的消息中返回它的名称，然后在另一个输出中返回它的价格. 我怎样才能做到这一点？

`

```
#include <iostream>
#include <string>
#include <set>
#include <map>
#include<utility>
using namespace std;

int main()
{

map<string,double> items;
items["apples"] = 1.56;
items["oranges"] = 2.34;
items["bananas"] = 3.00; 
items["limes"] = 4.45;       
items["grapefruits"] = 6.00;    

string fruit = "apples";

//If a fruit is in map
cout << "Your fruit is: " << "(fruitname value here)"
    <<"\n";
    << "your price is: " <<"(fruitname price here)" 
    << "\n";
 // return the fruitname and its price

  return 0;
} 
```

到目前为止，我只看到了展示如何打印整个地图的示例。我见过的最接近的是在这个链接上发布的（见第二篇文章）：[看看地图 c++ 中是否有一个键](https://stackoverflow.com/questions/7858652/see-if-there-is-a-key-in-a-map-c)，但我对语法感到困惑，特别是“buf.c_str()”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:22:46.383

由于地图的键是`std::string`，因此您不必使用`.c_str()`. 您可以传递`std::string`对象本身：

```
auto it = items.find(fruit); //don't pass fruit.c_str()
if ( it != items.end())
   std::cout << "value = " << it-second << std::endl;
else
   std::cout << ("key '" + fruit + "' not found in the map") << std::endl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:22:15.750

很容易：

```
auto it = items.find(fruit);

if (it != items.end())
{
    std::cout << "Your fruit is " << it->first << " at price " << it->second ".\n";
}
else
{ 
    std::cout << "No fruit '" << fruit << "' exists.\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T20:22:18.893

使用`map`s`find`成员函数。

```
map<string,double>::const_iterator i = items.find(fruit);
if(i != items.end())
    cout << "Your fruit is: " << i->first << "\n" << "your price is: " << i->second << "\n"; 
```

# google-app-engine - Google App Engine 上按 IP 地址划分流量

> ID：15032531
> 
> 赞同：3
> 
> 时间：2013-02-22T20:19:09.597
> 
> 标签：google-app-engine

我想根据一组已知 IP 地址将流量引导到不同版本的 Google App Engine 代码。

例如，如果传入请求来自给定列表中的 IP 地址，则流量将定向到版本 1。如果不是，则定向到版本 2。

有没有办法从管理控制台或部署配置中做到这一点？

最终目标是在从批准的 IP 地址访问站点时授予对额外功能的访问权限。如果我不能从管理控制台执行此操作，那么我计划在用户登录过程中获取 IP 地址，并根据 IP 设置他们的安全角色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T23:04:42.270

在管理控制台或部署过程中没有办法。但是，如果您进行基于 cookie 的流量拆分，您可以自己设置 cookie（基于传入的 IP 地址或您想要的其他值）。该值存储在文档中，`GOOGAPPUID`您要使用的值在[文档](https://developers.google.com/appengine/docs/adminconsole/trafficsplitting#Routing)中进行了描述，并且取决于您要拆分的版本数量以及您希望发送到每个版本的相应流量级别。

如果您不想为*不在*给定 IP 列表上的用户进行流量拆分，则应确保为所有用户显式设置 cookie。否则，App Engine 将默认提供该值（并将一些用户发送到这两个版本）。

# php - 在更新页面 CMS 上更改图像

> ID：15032537
> 
> 赞同：0
> 
> 时间：2013-02-22T20:19:23.013
> 
> 标签：php, html, image-upload

嗯，这是我每次创建 CMS 时唯一困扰我的问题。假设我已经包含了添加一些带有文本的图像的功能（不是图像库）。这是 CRUD 的创建函数。读取和删除也不是很困难。我面临的唯一问题是**更新**功能。

应该如何处理图像更新。我怎么知道用户是否要更改图像以及稍后是否提交新图像。

如果他检查更改图像并使用相同的图像上传，那么先取消之前的图像链接并再次上传相同的图像是没有用的。

这类事情是如何处理的？

目前我正在使用 codeigniter 进行开发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:24:05.717

大多数 CMS 都会内置图像功能。我首先建议不要在这里重新发明轮子。

例如，在 ExpressionEngine 中（在 codeigniter 后端）你给了一个“字段标签”`<img src="{{channel.img}}" />`

CMS 在后端足够智能，可以在更新时更改该字段的值，而无需您手动执行任何操作。唯一的问题是它是否会覆盖图像名称/位置，而不是在上传中创建新图像并将前一个图像保留在其中。

这也是 Umbraco CMS 中的处理方式。

你还需要什么？

# vb.net - 如何使用类（VB.Net）将数据从一种形式传递到另一种形式

> ID：15032538
> 
> 赞同：1
> 
> 时间：2013-02-22T20:19:25.137
> 
> 标签：vb.net, forms, class

在我的主程序（表单）中，我有两个列表框、一个文本框和一个按钮。当我在每个列表框中选择两个项目并在文本框中输入一个数字时，它应该存储在一个数组中。我想用一个类来做到这一点。（我刚刚问了一个关于这个的问题，现在效果很好）。问题是我想以不同的形式显示结果。我课堂上的代码如下所示：

```
Public Class Stocking

Public sale(3, 4) As Integer
Public numberSellers(3) As Integer
Public numberProducts(4) As Integer

Public Sub addItem(ByRef my_sellerListBox As ListBox, ByRef my_productListBox As ListBox, ByRef my_saleTextBox As TextBox)
    Dim sellerLineInteger As Integer
    Dim productColumnInteger As Integer

    sellerLineInteger = my_sellerListBox.SelectedIndex
    productColumnInteger = my_productListBox.SelectedIndex

    ' add in two dimensional array 
    If sellerLineInteger >= 0 And productColumnInteger >= 0 Then
        sale(sellerLineInteger, productColumnInteger) = Decimal.Parse(my_saleTextBox.Text)
    End If

    my_saleTextBox.Clear()
    my_saleTextBox.Focus()

    For sellerLineInteger = 0 To 3
        For productColumnInteger = 0 To 4
            numberSellers(sellerLineInteger) += sale(sellerLineInteger, productColumnInteger)
        Next productColumnInteger
    Next sellerLineInteger

End Sub
Public Sub showItems(ByRef my_label)

    my_label.Text = numberSellers(0).ToString 'using this as a test to see if it works for now

End Sub
End Class 
```

我的主要形式是这样的：

```
Public Class showForm

Public sale(3, 4) As Integer
Public numberSellers(3) As Integer
Public numberProducts(4) As Integer

Dim StockClass As New Stocking

    Public Sub addButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles addButton.Click

    StockClass.addItem(sellerListBox, producttListBox, saleTextBox)

End Sub

Public Sub SalesByMonthToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SalesByMonthToolStripMenuItem.Click

    saleForm.Show() 
```

在我的第二种形式中，显示存储在数组中的结果是：

```
Public Class saleForm

Dim StockClass As New Stocking

Public Sub saleForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    StockClass.showItems(Label00)
    'Only using one label as a test for now.

End Sub

End Class

End Sub 
```

我对其进行了测试并试图查看结果是否显示在主窗体上，它确实如此。所以我猜这个问题是因为我使用了不同的形式。另外我认为这可能是因为我以不同的形式再次调用该类并且不保留数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:28:30.547

问题是您的 saleForm 正在实例化一个新的 Stocking 对象。在创建 saleForm 期间，您需要将在主窗体中创建的 Stocking 对象发送到新窗体，或者您需要使主窗体中的 Stocking 对象公开可用，可能通过属性。

所以，在你的主要形式中，你可能有这样的东西：

```
Public StockClass As New Stocking 
```

然后，因为它没有作为私有变量受到保护，所以您可以通过类似的方式从辅助表单访问它

```
showForm.StockClass.showItems(Label00) 
```

当然，危险在于这将两种形式紧紧地结合在一起。从长远来看，学习如何在初始化期间将第一个表单中填充的 StockClass 发送到第二个表单会更好，但我对 WinForms 开发的记忆不够，无法帮助解决这个问题，抱歉。

# postgresql - PostgreSQL 中的键值对

> ID：15032540
> 
> 赞同：1
> 
> 时间：2013-02-22T20:19:34.013
> 
> 标签：postgresql, entity-attribute-value, hstore

我需要将键值对保存在 PostgreSQL 数据库中，该数据库将包含有关记录的一些基本信息。

在对该主题进行了一些谷歌搜索后，我发现这`hstore`是其中一种选择。但即使在阅读了文档之后，我也无法弄清楚如何在带有`hstore`列的表中添加记录，以及它们如何在结果中返回以及如何解析它。

我对 PostgreSQL 完全陌生，所以任何代码参考都会很棒。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-22T22:56:49.197

要使用[**`hstore`**](https://www.postgresql.org/docs/current/hstore.html)数据类型，您需要先安装附加模块 hstore。每个数据库一次：

```
CREATE EXTENSION hstore; 
```

[`CREATE EXTENSION`](https://www.postgresql.org/docs/current/sql-createextension.html)已在 Postgres 9.1 中添加。旧版本有其他方法。

[在 dba.SE 上的相关问题下阅读有关 RDBMS 中](https://dba.stackexchange.com/q/20759/3684)*EAV*（实体-属性-值）存储的优缺点的更多信息。

在 Postgres 9.2+ 中考虑[**`json`**](https://www.postgresql.org/docs/current/datatype-json.html)作为替代方案。
在 Postgres 9.4+ 中考虑[**`jsonb`**](https://www.postgresql.org/docs/current/datatype-json.html).

# iphone - 将 GLKVector3 添加到 NSMutableArray

> ID：15032543
> 
> 赞同：1
> 
> 时间：2013-02-22T20:19:49.333
> 
> 标签：iphone, ios, objective-c, xcode

我正在尝试将 GLKVector3 对象添加到 NSMutableArray 中。我知道 NSMutableArrays 只会接受某些对象，所以对我来说最好的方法是将 GLKVector3 添加到数组中。

这是一个代码示例：

```
 for(id basenormal in [jsnmvtx objectForKey:@"baseNormals"]){
            [basenormalsVectorArrays addObject:GLKVector3MakeWithArray(basenormal)];
        } 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:36:53.753

问题是这`GLKVector3`是 C 风格`struct`，而不是对象。所以它不知道如何响应`retain`or `release`，因此不能与`NSArray`.

您可以做的是将每个都包装成`NSValue`一个对象类型，并且它知道如何在其中保留任意 C 类型。它不是特别整洁，因为您跨越了 C 和 Objective-C 之间的边界，但是例如

```
GLKVector3 someVector;

[array addObject:[NSValue valueWithBytes:&someVector objCType:@encode(GLKVector3)]];

...

GLKVector3 storedVector;

NSValue *value = ... something fetched from array ...;
[value getValue:&storedVector];

// storedVector now has the value of someVector 
```

这会将 的内容复制`someVector`到 中`NSValue`，然后将它们再次复制到`storedVector`.

您可以使用`valueWithPointer:`并且`pointerValue`如果您希望`someVector`在数组中保留对的引用而不是复制内容，那么您需要小心手动内存管理，因此更好的解决方案可能是使用`NSData`如下：

```
// we'll need the vector to be on the heap, not the stack
GLKVector3 *someVector = (GLKVector3 *)malloc(sizeof(GLKVector3));

[array addObject:[NSData dataWithBytesNoCopy:someVector length:sizeof(GLKVector3) freeWhenDone:YES]];
// now the NSData object is responsible for freeing the vector whenever it ceases
// to exist; you needn't do any further manual management

...

GLKVector3 *storedVector = (GLKVector3 *)[value bytes]; 
```

# php - Fancybox onclose 放置内容

> ID：15032546
> 
> 赞同：0
> 
> 时间：2013-02-22T20:19:55.250
> 
> 标签：php, jquery, fancybox

我有几个输入框的表单，例如：

```
FORM START
News -> input
News picture -> input (id="newspics", name="news_picture")
Add -> submit button

"Hyperlink Set picture" -> opening Fancy box window with gallery (table, 5*5, 25 pictures), images must be hyperlinked with unique id

FORM END 
```

我需要花式框 onclose() 和我的输入（news_picture）之间的通信，当用户单击图片时我需要：关闭花式框，将 ID 号放入我的输入（新闻图片）。请如果有人帮助我。

更新：我解决了问题。

我制作了一个小的 php 脚本，当用户点击 addpicture.php?id=$id 时，fwrite 函数会写入 id 号

在此之后，我得到它们，代码：

```
'onClosed'          : function() {
jQuery.get('aa.txt',function(data){
alert(data);
});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:46:03.613

如果您想将 php 变量传递到 fancybox 回调中，您可以这样做

```
$(".fancybox").fancybox({
  "onClosed" : function(){
    $("#input_selector").val(<?php echo $phpVariable; ?>);
    // or add an ID attribute
    // $("#input_selector").attr("id", ""+<?php echo $phpVariable; ?>+"");
  }
}); 
```

...上面的例子是为了让你知道怎么做，它不是一个食谱；）

请记住，这`onClosed`是fancybox v1.3.4 的回调……如果您的版本是v2.x，请`afterClose`改用。

# matlab - 在matlab中打印n * m矩阵

> ID：15032549
> 
> 赞同：9
> 
> 时间：2013-02-22T20:20:14.840
> 
> 标签：matlab

在 MATLAB 中，我以这种方式打印一个非常大的矩阵：

```
fid = fopen('c:\\OUTPUT.txt','wt');
fprintf(fid,'%f\t',T');
fclose(fid); 
```

但这是不对的！我想像这样打印它：（`\t`在它们之间和`\n`行尾）

```
1   2   3
4   5   6
7   8   9
10  11  12 
```

我搜索并发现如果它是 3*3 这很好：

```
fprintf(fid,'%f %f %f\n',T'); 
```

但在我的情况下，我改变了大小......

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-22T20:32:55.800

您可以使用非常简单的

```
fprintf([repmat('%f\t', 1, size(A, 2)) '\n'], A'); 
```

`\t`但是，您将在每一行的末尾有一个多余的选项卡：

```
>> A = magic(5)

A =

    17    24     1     8    15
    23     5     7    14    16
     4     6    13    20    22
    10    12    19    21     3
    11    18    25     2     9

>> fprintf([repmat('%f\t', 1, size(A, 2)) '\n'], A')
17.000000   24.000000   1.000000    8.000000    15.000000   % oh, a tab
23.000000   5.000000    7.000000    14.000000   16.000000   % oh, a tab 
4.000000    6.000000    13.000000   20.000000   22.000000   % oh, a tab
10.000000   12.000000   19.000000   21.000000   3.000000    % oh, a tab
11.000000   18.000000   25.000000   2.000000    9.000000    % oh, a tab 
```

要将输出打印到文件中，只需使用

```
fprintf(fid, [repmat('%f\t', 1, size(A, 2)) '\n'], A') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-22T20:36:52.997

你可能还想看看[`dlmwrite`](http://www.mathworks.com/help/matlab/ref/dlmwrite.html)

您可以设置分隔符、精度等。

```
dlmwrite('myfile.txt', M, 'delimiter', '\t', 'precision', 6) 
```

`M`你的矩阵在哪里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-11T12:30:46.557

*添加到@Lumen 已经有帮助和接受的答案*

您可以消除多余的制表符`strrep`，用于查找换行符之前的制表符，`\t\n`替换为 just, `\n`。

所以，

```
fprintf([repmat('%f\t', 1, size(A, 2)) '\n'], A'); 
```

变成：

```
fprintf(strrep([repmat('%f\t', 1, size(A, 2)) '\n'],'\t\n','\n'), A'); 
```

# javascript - 将代码传输到服务器时出现灯箱错误

> ID：15032554
> 
> 赞同：0
> 
> 时间：2013-02-22T20:20:43.810
> 
> 标签：javascript, jquery, lightbox, typeerror

我正在我正在开发的网站上实现一个 JQuery 灯箱。同一组代码在 localhost 中运行良好，但是当我将代码传输到我的服务器时，我收到有关灯箱的错误。`Uncaught TypeError: Object function Object() { [native code] } has no method 'extend'`. 我不知道这意味着什么错误。

另外我在页面上只有 jQuery lib。

这是我正在处理的页面[mypage](http://tapmichiana.org/immigration-reform.php)

请帮我。

**更新**

我在 jquery lib 和 lightbox 脚本链接之间添加`<script>jQuery.noConflict();});</script>`了`<head></head>`html..in。但仍然无法正常工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:24:12.370

很多时候，当缺少依赖脚本时会发生该错误。如果您使用 jQuery 之外的多个库，也会发生这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T23:10:03.457

运行良好，您可以尝试重新上传 lightbox.css 以修复对齐问题。

# xml - 在来自变量和表的 PostgreSQL 函数中生成 XML

> ID：15032558
> 
> 赞同：0
> 
> 时间：2013-02-22T20:21:08.603
> 
> 标签：xml, function, postgresql

我将从我想要的输出开始：

```
<?xml version="1.0"?>
<Accounts>
    <Account>
        <variable1>variable1</variable1>
        <variable2>variable2</variable2>
        <variable3>variable3</variable3>
        <variable4>variable4</variable4>
        <variable5>variable5</variable5>
        <variable6>variable6</variable6>
        <Table>
            <Row>
                <Column1>row1col1</Column1>
                <Column2>row1col2</Column2>
                <Column3>row1col3</Column3>
            </Row>
            <Row>
                <Column1>row2col1</Column1>
                <Column2>row2col2</Column2>
                <Column3>row2col3</Column3>
            </Row>
            <Row>
                <Column1>row3col1</Column1>
                <Column2>row3col2</Column2>
                <Column3>row3col3</Column3>
            </Row>
        </Table>
    </Account>
    ...
</Accounts> 
```

这需要来自当前的 SQL 函数循环通过 Accounts 和每个帐户 ID 收集每个帐户上面的所有相关数据，例如变量 1、2、表等。因此，每个帐户 ID 它返回所有变量和表及其3 列和所有行。

因此，为了简化，对于每个 Account ID，XML 文件需要将上述结构附加到文件中。现在，当我尝试创建包含所有这些不同部分的 XML 文件时，我的困境就来了。

第一个问题是如何将表信息和变量信息组合成一个 XML 树。我知道可以使用表中的元素创建 XML 森林，但问题是每个帐户都有一组可变数据和一个表。我已经考虑过 table_to_xml 但这直接取自表，我不知道如何在 table/xml 之前附加变量元素。

我考虑过做文本数组：

```
for rec in execute cmd
loop

  cmd:= 'select xmlelement(name "Account",
        xmlelement(name "Variable1", '||var1||'))';

  execute cmd into vtext
  varray[n] := vtext;
  n++
end loop; 
```

然后可能将嵌套到 xmlelement 中的表格也作为文本数组。继续嵌套，直到我拥有所有的 '，然后在它们都在一起后将它们发送到 XML。

下一个问题是将所有这些帐户组合到同一个 XML 文件中的一个总体元素中。

如果有人对如何解决这个问题有任何想法，我将不胜感激。我觉得我在考虑整个过程，或者用 SQL 做这件事太荒谬了，也许我应该用 Python 这样的脚本语言来尝试这些操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T20:12:47.547

问题的解决方案非常简单。将所有数据放入临时表并连接。特别是为我想要的输出执行此操作的方法：

```
-- FUNCTION AFTER CREATE AND DECLARES
v_cmd := 'select Accounts from <table>';

final_xml := '<?xml version="1.0"?><Accounts>';

for record in execute v_cmd
loop
    <generate Account data into SQL variables>

    -- Check if temp table exists, then create P1
    v_table_name1 := '<temp_table1>';

    IF EXISTS (select 1 from information_schema.tables 
    where table_schema = '<schema>' and table_name = <temp_table1>) THEN
        v_s_cmd := 'DROP TABLE '||<temp_table1>;
        execute v_s_cmd;
    END IF;

    v_s_cmd := 'CREATE TABLE <temp_table1>
    (variable1 varchar, variable2 varchar, ...)';
    execute v_s_cmd;
    v_s_cmd := 'INSERT INTO <temp_table1> 
    (variable1, variable2, ...)
    VALUES ('||coalesce(quote_literal(Account.variable1),'NULL')||',' 
           ''||coalesce(quote_literal(Account.variable2),'NULL')||',' ...)'';
    execute v_s_cmd;

    <generate multiple row data to be elements of the above Account>

    -- Check if temp table exists, then create P1
    v_table_name2 := '<temp_table2>';

    IF EXISTS (select 1 from information_schema.tables 
    where table_schema = '<schema>' and table_name = <temp_table2>) THEN
        v_s_cmd := 'DROP TABLE '||<temp_table2>;
        execute v_s_cmd;
    END IF;

    v_s_cmd := 'CREATE TABLE <temp_table2(Column1, Column2, Column3)';
    execute v_s_cmd;

    column_id = record.row_id;

    for column_record in

    SELECT Column1, Column2, Column3 FROM <column_data_source>
    WHERE data_id = column_id ORDER BY Column1, Column2, Column3

    loop
        v_s_cmd := 'INSERT INTO '||<temp_table2>|| 
        '(Column1, Column2, Column3, column_id) SELECT 
        '||quote_literal(column_record.Column1)||', 
        '||quote_literal(column_record.Column2)||', 
        '||quote_literal(column_record.Column2)||', 
        '''||column_id||''';';
        execute v_s_cmd;
    end loop;

    -- get var data 
    v_s_cmd := '(select regexp_replace((
    XMLElement(name Account, 
        XMLForest(variable1, variable2 ...)))::text,
        ''</Account>'','''',''g'') as var_d
    FROM <temp_table1>)';

    execute v_s_cmd into var_data;

    -- get Table data
    v_s_cmd := 'select XMLElement(name Row, 
                    XMLForest(Column1, Column2, Column3)) as test
                FROM '||<temp_table2>;

    table_rec := '<Table>';

    -- concatenate to variable
    for row_rec in execute v_s_cmd
    loop
        table_rec := table_rec || row_rec.test;
    end loop;
    table_rec := table_rec||'</Table></Account>';

    -- complete XML part and concatenate to main xml variable
    final_xml := final_xml || var_data || s_a_rec;

    v_s_cmd := 'drop table '||temp_table1;
    execute v_s_cmd;
    v_s_cmd := 'drop table '||temp_table2;
    execute v_s_cmd;

END LOOP;

final_xml := final_xml || '</Accounts>';

final_xml := XMLPARSE(DOCUMENT final_xml);

create table schema.temp_final_xml(xmlcode varchar);
insert into schema.temp_final_xml(xmlcode) VALUES (final_xml);

v_s_cmd := 'COPY (select xmlcode from schema.temp_final_xml) 
            TO ''/filepath/file.xml''';
execute v_s_cmd;

drop table schema.temp_final_xml; 
```

如果有更清洁的方法来执行此操作，我很想知道。我绞尽脑汁想了几天才想出这个。

# android - 如何使 JSONParser 类适用于 Android ICS 和更新版本？

> ID：15032560
> 
> 赞同：0
> 
> 时间：2013-02-22T20:21:17.290
> 
> 标签：android, httprequest

此代码适用于较旧的 api 版本，例如。我在 API8-2.2 上使用过它，它做了我想要的。

但是当试图在我的安卓 4.2.1 手机上运行该应用程序时，它就崩溃了。我试图在互联网上找到这个问题，发现我需要一个叫做Asyntask的东西，所以我开始寻找它，但我仍然不明白它。有人可以帮我解决这个问题吗？

```
package com.thevnkid93.ucebnice;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.util.Log;

    public class JSONParser {

        static InputStream is = null;
        static JSONObject jObj = null;
        static JSONArray jArr=null;
        static String json = "";

        // function get json from url
        // by making HTTP POST or GET method
        public static JSONArray makeHttpRequest(String url, String method,
                List<NameValuePair> params) {

            // Making HTTP request
            try {
                // check for request method
                if(method == "POST"){
                    // request method is POST
                    // defaultHttpClient
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpPost httpPost = new HttpPost(url);
                    httpPost.setEntity(new UrlEncodedFormEntity(params,"utf-8"));

                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();

                }else if(method == "GET"){
                    // request method is GET
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    String paramString = URLEncodedUtils.format(params, "utf-8");
                    url += "?" + paramString;
                    HttpGet httpGet = new HttpGet(url);

                    HttpResponse httpResponse = httpClient.execute(httpGet);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();
                }           

            } catch (UnsupportedEncodingException e) {
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            try {
                BufferedReader reader = new BufferedReader(new InputStreamReader(
                        is, "iso-8859-1"), 8);
                StringBuilder sb = new StringBuilder();
                String line = null;
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
                is.close();
                json = sb.toString();
            } catch (Exception e) {
                Log.e("Buffer Error", "Error converting result " + e.toString());
            }

            // try parse the string to a JSON object
            try {
                jArr = new JSONArray(json);
            } catch (JSONException e) {
                Log.e("JSON Parser", "Error parsing data " + e.toString());
            }

            // return JSON String (Array)
            return jArr;

        }

} 
```

日志猫：

02-23 23:01:10.540: E/AndroidRuntime(30520): android.os.NetworkOnMainThreadException

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:25:05.897

查看您的代码，将其转换为[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)真的很容易。只需将 a`JSONParser. makeHttpRequest()`放入`doInBackground()`AsyncTask 的方法中。

但是，您可能不会使用[Thread](http://developer.android.com/reference/java/lang/Thread.html)，因为您没有在代码中进行任何 UI 修改。

```
Thread thread = new Thread() {
    @Override
    public void run() {
        try {
            JSONArray myArray = JSONParser. makeHttpRequest();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
};

thread.start(); 
```

# ios - iOS 在两种颜色之间的点处查找颜色

> ID：15032562
> 
> 赞同：17
> 
> 时间：2013-02-22T20:21:26.730
> 
> 标签：ios, gradient, uicolor, blending, linear-gradients

我有一个问题：我需要能够采用两种颜色并从中制作“虚拟渐变”。然后我需要能够在这条线上的任何点找到颜色。我目前的做法是这样的：

```
if (fahrenheit < kBottomThreshold)
{
    return [UIColor colorWithRed:kBottomR/255.0f green:kBottomG/255.0f blue:kBottomB/255.0f alpha:1];
}
if (fahrenheit > kTopThreshold)
{
    return [UIColor colorWithRed:kTopR/255.0f green:kTopG/255.0f blue:kTopB/255.0f alpha:1];
}

double rDiff = kTopR - kBottomR;
double gDiff = kTopG - kBottomG;
double bDiff = kTopB - kBottomB;

double tempDiff = kTopThreshold - kBottomThreshold;

double rValue;
double gValue;
double bValue;

rValue = kBottomR + ((rDiff/tempDiff) * fahrenheit);
gValue = kBottomG + ((gDiff/tempDiff) * fahrenheit);
bValue = kBottomB + ((bDiff/tempDiff) * fahrenheit);

return [UIColor colorWithRed:rValue/255.0f green:gValue/255.0f blue:bValue/255.0f alpha:1]; 
```

变量：

*   `fahrenheit`是传递给我的函数的变量，它是我要为其查找颜色的虚拟行上的数字。
*   `kTopR`, `kTopB`, 和`kTopG`是渐变一端的 RGB 值。他们的`kBottom`同行也一样。
*   `kBottomThreshold`并且`kTopThreshold`是我的渐变的端点。

**这是我的问题：** ***当`fahrenheit`越过渐变的任一端时，渐变似乎“跳跃”到不同的值。***

我在这里包含了一个托管在我的 S3 服务器上的示例[项目](https://s3.amazonaws.com/erwaysoftwarestackoverflow/StackOverflowExample.xcarchive.zip)。

***您确实需要下载该项目并在模拟器/设备上尝试以了解我的意思***（除非您非常聪明并且可以通过查看代码来判断）

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2017-10-13T11:48:09.223

**斯威夫特 - 3.0 && 4.0**

```
extension UIColor {
    func toColor(_ color: UIColor, percentage: CGFloat) -> UIColor {
        let percentage = max(min(percentage, 100), 0) / 100
        switch percentage {
        case 0: return self
        case 1: return color
        default:
            var (r1, g1, b1, a1): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
            var (r2, g2, b2, a2): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
            guard self.getRed(&r1, green: &g1, blue: &b1, alpha: &a1) else { return self }
            guard color.getRed(&r2, green: &g2, blue: &b2, alpha: &a2) else { return self }

            return UIColor(red: CGFloat(r1 + (r2 - r1) * percentage),
                           green: CGFloat(g1 + (g2 - g1) * percentage),
                           blue: CGFloat(b1 + (b2 - b1) * percentage),
                           alpha: CGFloat(a1 + (a2 - a1) * percentage))
        }
    }
} 
```

***用法：-***

```
let colorRed = UIColor.red
let colorBlue = UIColor.blue

let colorOutput = colorRed.toColor(colorBlue, percentage: 50) 
```

> **结果**

[![在此处输入图像描述](../Images/f6906d03d112194df8927e54107aa336.png)](https://i.stack.imgur.com/FDEsE.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-22T20:32:29.040

问题是你没有`kBottomThreshold`从`farenheit`.

但是让我们简化一下。

首先，我们要将输入温度映射到`t`[0 ... 1] 范围内的参数。然后，我们想要映射`t`到范围 [ `kBottomR`... `kTopR`] 中的输出，也映射到范围 [ ... ] 中的输出，以及范围 [ `kBottomG`... `kTopG`] 中的输出。`kBottomB``kTopB`

```
UIColor *colorForDegreesFahrenheit(double fahrenheit) {
    double t = (fahrenheit - kBottomThreshold) / (kTopThreshold - kBottomThreshold);

    // Clamp t to the range [0 ... 1].
    t = MAX(0.0, MIN(t, 1.0));

    double r = kBottomR + t * (kTopR - kBottomR);
    double g = kBottomG + t * (kTopG - kBottomG);
    double b = kBottomB + t * (kTopB - kBottomB);

    return [UIColor colorWithRed:r/255 green:g/255 blue:b/255 alpha:1];
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-30T23:28:56.570

谢谢[@ramchandra-n](https://stackoverflow.com/a/46729248/9024807)我实现了扩展以按百分比从颜色数组中获取中间颜色

```
extension Array where Element: UIColor {
    func intermediate(percentage: CGFloat) -> UIColor {
        let percentage = Swift.max(Swift.min(percentage, 100), 0) / 100
        switch percentage {
        case 0: return first ?? .clear
        case 1: return last ?? .clear
        default:
            let approxIndex = percentage / (1 / CGFloat(count - 1))
            let firstIndex = Int(approxIndex.rounded(.down))
            let secondIndex = Int(approxIndex.rounded(.up))
            let fallbackIndex = Int(approxIndex.rounded())

            let firstColor = self[firstIndex]
            let secondColor = self[secondIndex]
            let fallbackColor = self[fallbackIndex]

            var (r1, g1, b1, a1): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
            var (r2, g2, b2, a2): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
            guard firstColor.getRed(&r1, green: &g1, blue: &b1, alpha: &a1) else { return fallbackColor }
            guard secondColor.getRed(&r2, green: &g2, blue: &b2, alpha: &a2) else { return fallbackColor }

            let intermediatePercentage = approxIndex - CGFloat(firstIndex)
            return UIColor(
                red: CGFloat(r1 + (r2 - r1) * intermediatePercentage),
                green: CGFloat(g1 + (g2 - g1) * intermediatePercentage),
                blue: CGFloat(b1 + (b2 - b1) * intermediatePercentage),
                alpha: CGFloat(a1 + (a2 - a1) * intermediatePercentage)
            )
        }
    }
} 
```

您可以使用它来获得两种或多种颜色之间的中间颜色：

```
let color = [.green, .yellow, .red].intermediate(percentage: 70) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-19T00:14:43.283

如果您的渐变比 2 色渐变更复杂，您可以考虑将 CGGradientRef 绘制到临时 CGImageRef 中并直接从图像缓冲区读取 RGBA 值。

这是我与 5 个渐变色标和颜色有关的事情：

```
 CGFloat tmpImagewidth = 1000.0f; // Make this bigger or smaller if you need more or less resolution (number of different colors).
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    // create a gradient
    CGFloat locations[] = { 0.0,
        0.35,
        0.55,
        0.8,
        1.0 };
    NSArray *colors = @[(__bridge id) [UIColor redColor].CGColor,
                        (__bridge id) [UIColor greenColor].CGColor,
                        (__bridge id) [UIColor blueColor].CGColor,
                        (__bridge id) [UIColor yellowColor].CGColor,
                        (__bridge id) [UIColor redColor].CGColor,
                        ];
    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef) colors, locations);
    CGPoint startPoint = CGPointMake(0, 0);
    CGPoint endPoint = CGPointMake(tmpImagewidth, 0);

    // create a bitmap context to draw the gradient to, 1 pixel high.
    CGContextRef context = CGBitmapContextCreate(NULL, tmpImagewidth, 1, 8, 0, colorSpace, kCGImageAlphaPremultipliedLast);

    // draw the gradient into it
    CGContextAddRect(context, CGRectMake(0, 0, tmpImagewidth, 1));
    CGContextClip(context);
    CGContextDrawLinearGradient(context, gradient, startPoint, endPoint, 0);

    // Get our RGB bytes into a buffer with a couple of intermediate steps...
    //      CGImageRef -> CFDataRef -> byte array
    CGImageRef cgImage = CGBitmapContextCreateImage(context);
    CGDataProviderRef provider = CGImageGetDataProvider(cgImage);
    CFDataRef pixelData = CGDataProviderCopyData(provider);

    // cleanup:
    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);
    CGImageRelease(cgImage);
    CGContextRelease(context);

    const UInt8* data = CFDataGetBytePtr(pixelData);

    // we got all the data we need.
    // bytes in the data buffer are a succession of R G B A bytes

    // For instance, the color of the point 27% in our gradient is:
    CGFloat x = tmpImagewidth * .27;
    int pixelIndex = (int)x * 4; // 4 bytes per color
    UIColor *color = [UIColor colorWithRed:data[pixelIndex + 0]/255.0f
                                     green:data[pixelIndex + 1]/255.0f
                                      blue:data[pixelIndex + 2]/255.0f
                                     alpha:data[pixelIndex + 3]/255.0f];

    // done fetching color data, finally release the buffer
    CGDataProviderRelease(provider); 
```

我并不是说这比上面答案中的“数学方式”更好，当然，生成临时图像会产生内存和 CPU 税。然而，这样做的好处是，无论您需要多少渐变停止，代码复杂性都保持不变......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-04-24T21:14:36.417

# 斯威夫特 5.3

获取两种颜色之间的 n 种颜色：

```
import UIKit

extension CGFloat {
    var getPercentageValues: [CGFloat] {
        let increment: CGFloat = 100/(self-1)
        var values = [CGFloat]()
        let last: CGFloat = 100
        var value: CGFloat = 0
        while value <= last {
            values.append(value)
            value += increment
        }
        return values
    }
}

extension UIColor {
    func toColor(_ color: UIColor, percentage: CGFloat) -> UIColor {
        let percentage = max(min(percentage, 100), 0) / 100
        switch percentage {
        case 0: return self
        case 1: return color
        default:
            var (r1, g1, b1, a1): (CGFloat, CGFloat, CGFloat, CGFloat) = (.zero, .zero, .zero, .zero)
            var (r2, g2, b2, a2): (CGFloat, CGFloat, CGFloat, CGFloat) = (.zero, .zero, .zero, .zero)
            guard self.getRed(&r1, green: &g1, blue: &b1, alpha: &a1) else { return self }
            guard color.getRed(&r2, green: &g2, blue: &b2, alpha: &a2) else { return self }

            return UIColor(red: CGFloat(r1 + (r2 - r1) * percentage),
                           green: CGFloat(g1 + (g2 - g1) * percentage),
                           blue: CGFloat(b1 + (b2 - b1) * percentage),
                           alpha: CGFloat(a1 + (a2 - a1) * percentage))
        }
    }

    func getColors(to color: UIColor, with quantity: CGFloat) -> [UIColor] { 
        quantity.getPercentageValues.map { self.toColor(color, percentage: $0 ) }
    }
}

let redColor = UIColor.red
let blueColor = UIColor.blue

print(redColor.getColors(to: blueColor, with: 10)) 
```

## 结果

[![在此处输入图像描述](../Images/84e5c03d428d9e992bc797e98b901e0a.png)](https://i.stack.imgur.com/F0Nw6.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-03T10:07:26.687

我想扩展/修改@Sebastien Windal 的答案，因为他的答案非常适合我的用例，但可以通过直接从上下文中获取 pixelData 来进一步改进（请参阅[Get pixel data as array from UIImage/CGImage in swift](https://stackoverflow.com/questions/33768066/get-pixel-data-as-array-from-uiimage-cgimage-in-swift)）。

我迅速实现了他的答案，因此更改也用 swift 编写。

只需在绘制渐变之前将 Int Array 传递给上下文。然后，在绘制上下文时，该数组将用 pixelData 填充。

```
let dataSize = tmpImagewidth * 1 * 4
var pixelData = [UInt8](repeating: 0, count: Int(dataSize))

let context = CGContext(data: &pixelData, width: Int(tmpImagewidth), height: 1, bitsPerComponent: 8, bytesPerRow: 4 * Int(tmpImagewidth), space: colorSpace, bitmapInfo: CGImageAlphaInfo.premultipliedLast.rawValue) 
```

然后我们可以先跳过创建图像，然后从那里读取 pixelData。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-26T13:34:06.643

SwiftUI 颜色运算符 + 重载

```
 func +(lhs: Color, rhs: Color) -> Color {
    let lhsUIColor = UIColor(lhs)
    let rhsUIColor = UIColor(rhs)

    var (r1, g1, b1, a1): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
    var (r2, g2, b2, a2): (CGFloat, CGFloat, CGFloat, CGFloat) = (0, 0, 0, 0)
    guard lhsUIColor.getRed(&r1, green: &g1, blue: &b1, alpha: &a1) else { return Color(lhsUIColor) }
    guard rhsUIColor.getRed(&r2, green: &g2, blue: &b2, alpha: &a2) else { return Color(rhsUIColor) }

    return Color(Color.RGBColorSpace.sRGB, red: Double(r1 + r2) / 2, green: Double(g1 + g2) / 2, blue: Double(b1 + b2) / 2, opacity: Double(a1 + a2) / 2)
} 
```

# javascript - 提示时取消和空输入的不同值

> ID：15032565
> 
> 赞同：2
> 
> 时间：2013-02-22T20:21:41.123
> 
> 标签：javascript, prompt

我刚开始使用 Javascript，我一直在尝试制作一个打招呼的小脚本。这里是：

```
function hello() {

    while (!name) {

        var name = prompt("What's your name", "");
        var greetingElement = document.getElementById("greeting");

        greetingElement.style.color = "red";

        if (name == null) {
            greetingElement.innerHTML = "Boring!";
            break;
        }
        else if (name == 0) {
            greetingElement.innerHTML = "Don't you have a name";
        }
        else {
            greetingElement.innerHTML = "Hello " + name + "!";
        }
    }
}
window.onload = hello; 
```

我的问题是，如果您在提示符上按取消，我想显示一条消息，如果您不输入输入并按确定，则显示另一条消息。据我所知，这两个操作都会导致 null 值，那么我该如何显示不同的消息呢？

我在代码中所做的显然不是最佳的，我知道这一点。

如果你按下取消它现在没有，我也希望while循环结束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:12:41.147

如果您需要检查一些不同的虚假值，您需要将它们与[`Strict equal`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comparison_Operators)运算符进行比较。您可以在下面的代码中看到它。我还对您的代码进行了一些小的更改，以使其流畅地工作。

```
function hello(){
    var greetingElement = document.getElementById("greeting");
    greetingElement.style.color = "red";
    while (!name) {
        var name = prompt("What's your name?", "");
        if (name === null || name === false) { // Canceled
            greetingElement.innerHTML = "Boring!";
            break; // Leave this out, if the name is mandatory
        }
        if (name === "") { // OK, but no name
            greetingElement.innerHTML = "Don't you have a name?";
        } else { // OK with a name
            greetingElement.innerHTML = "Hello " + name + "!";
        }
    }
} 
```

[jsFiddle](http://jsfiddle.net/4T6wA/)的现场演示

# frameworks - System.IO.FileNotFoundException：无法解析程序集“nameOfDll”

> ID：15032572
> 
> 赞同：0
> 
> 时间：2013-02-22T20:22:11.767
> 
> 标签：frameworks, entity

拥有一个使用实体框架绑定控件的 Visual Studio 2010 应用程序。将应用程序发布到 IIS 7.5 后，我收到以下错误堆栈跟踪消息。

在本地运行时不会发生这种情况！

System.IO.FileNotFoundException：无法解析程序集“nameOfDll”。

经过数小时和数天的研究并遵循所有建议，错误仍然存​​在。

我确保所有引用都在本地加载，并将每个引用的 CopyTo: 设置为 true。唯一的其他建议是在 EntityDataSource 定义中设置 ContextTypeName。我不确定要输入的正确值。

我在 IIS 6.0 上也遇到过这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:25:32.217

当需要特定版本和/或文化的 DLL 的版本或文化不匹配时，您通常会收到此类错误。

使用 Fusion Log Viewer (Fuslogvw) 记录绑定错误。注意：您必须以管理员身份运行它，否则它将静默登录失败。

[http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.110).aspx)

Fuslogvw 的输出将准确地告诉您为满足绑定请求所做的尝试以及失败的原因。

如果这是在您可以这样做的环境中，请停止 IIS，启动 Fuslogvw，启动 Fuslogvw 日志记录，然后再次启动 IIS 并浏览到有问题的网站。如果你不能停止 IIS，我相信在 Fuslogvw 运行和日志记录的情况下回收相关的应用程序池应该足够了。

# javascript - Meteor 为模板助手提供的集合中的每个对象多次渲染父级

> ID：15032576
> 
> 赞同：2
> 
> 时间：2013-02-22T20:22:26.153
> 
> 标签：javascript, meteor, handlebars.js

我的 HTML 代码是：

```
{{#each slides}}
   {{> slide}}
{{/each}} 
```

我的 javascript 助手是：

```
Template.draggables.slides = function() {
return LiveSlides.find();
}; 
```

我已经尝试`{{#isolate}}`过`{{#each}}`声明，以及子模板，以及两者的组合，以及更多的排列。正在重新渲染所有父模板，并且针对集合中的每个对象。因此，在第一次加载网页时，如果集合中有 10 个对象，则将呈现所有父模板。我正在记录这一切。我很确定它不会以常规 Session 变量的方式运行——我认为这是集合表现得很有趣。任何人都知道问题可能是什么？

更新——我刚刚创建了一个新的空白应用程序来测试，我仍然在让父模板重新渲染它们自己——这里的所有应用程序都有：

```
 <body>
  {{> parent}}
</body>

<template name="parent">
    {{>child}}
</template>

<template name="child">
    {{#each desks}}
        <li>{{name}}</li>
    {{/each}}
</template>

Template.parent.rendered = function() {
    console.log('parent rendered');
};

Template.child.desks = function() {
    return Desks.find();
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:17:00.657

我认为这里发生的事情是为每个渲染的子调用父“渲染”回调。所以父级实际上并没有再次被放回 DOM 上。其渲染的回调正在被孩子们触发。如果您要完成某个特定的用例，请告诉我，我会尝试通过一些建议来扩展我的答案。

# html - 从右边距移动一个最右边的浮动

> ID：15032582
> 
> 赞同：4
> 
> 时间：2013-02-22T20:22:46.723
> 
> 标签：html, css

假设我有一个导航栏，其中有 5 个元素很好地浮动到左侧。然后我添加一个我想在最右边的元素，但我希望在浮动到最右边的元素和实际文档的边缘之间留一点边距。如果我只是这样做`float:right;`，则元素将被粉碎到文档的末尾。如果我试图弄乱`position-right`or `margin-right`，什么也不会发生。如何让元素远离边缘？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:32:57.197

几个选项，首先使用包装器来控制两个 div 分离：

HTML：

```
<div id="wrapper">
<div id="left">Left Div</div>
<div id="right">Right Div</div>
</div> 
```

CSS：

```
#left {
    float: left;
}

#right {
    float: right;
}

#wrapper {
    width: 500px;
    margin: auto;
    padding: auto;
    overflow: auto;
} 
```

[http://jsfiddle.net/wDjFV/](http://jsfiddle.net/wDjFV/)

另一种选择是`float: left`在 BOTH上做并在`<div>`那里用边距分开：

HTML：

```
<div id="left">Left Div</div>
<div id="right">Right Div</div> 
```

CSS：

```
#left {
    float: left;
}

#right {
    float: left;
    margin-left: 200px;
} 
```

[http://jsfiddle.net/wDjFV/3/](http://jsfiddle.net/wDjFV/3/)

更新：

只是对您可能不知道的第二个选项的想法，您需要对任何低于您浮动的 s`clear:both`的 CSS 规则进行处理，以获得正常的堆叠行为。`<div>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:24:46.870

`padding-right`可能是您正在寻找的，而不是`position-right`. 无论哪种方式，`margin-right`都应该努力将盒子从页面边缘拉开。`padding-right`将框保留在页面边缘，但将包含的内容移离边缘更远。

# java - Java - DBCP 与 JNDI？

> ID：15032585
> 
> 赞同：4
> 
> 时间：2013-02-22T20:23:03.713
> 
> 标签：java, jndi, apache-commons-dbcp, jdbc-pool

我是一个新手，我已经创建了一些 simlpe Java Swing 应用程序。我能够使用 apache commons DBCP 创建连接池并访问数据源。

我最近开始使用 JSP 和 Servlet 创建基于 Java Web 的应用程序。我已经学会了使用 JNDI 来访问数据源。我更新 XML 文件并使用 InitialContext() 和 lookup("java:comp/env") 就是这样！！！！我使用 Apache Tomcat 作为我的 Servlet/JSP 容器。

**1\. 但是DB连接池是在哪里创建的呢？**

**2\. 如果是，那么这是否意味着 JNDI 在内部以某种方式使用 DBCP？**

当我必须为 Swing 应用程序创建 DBCP 时，我必须首先创建一个 GenericObjectPool 实例，然后创建一个连接工厂对象，最后创建一个 PoolableConnectionFactory 对象来创建用于获取连接的 Datasource。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:28:50.973

JNDI 是一种将对象从系统的一个部分传递到另一个部分的机制（从技术上讲，跨类加载器）。这对于 Java 运行时中的类和接口（如 String 或 DataSource）最有用。

这意味着在您的情况下，JNDI 只是一种传输机制，您需要在其他地方定义实际的连接池。大多数 Web 容器都有一种机制来定义系统范围的连接池，然后 JNDI 允许您使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T20:28:07.740

Tomcat为[JNDI 数据源使用](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html)[Apache DBCP](http://commons.apache.org/dbcp/)和[Apache Pool](http://commons.apache.org/pool/)的自定义实现。这些库位于单个 JAR 中，位于.`$CATALINA_HOME/lib/tomcat-dbcp.jar`

主包是`org.apache.tomcat.dbcp`为了避免与[Apache Commons](http://commons.apache.org/)中的常规包冲突。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T21:05:15.737

JNDI 是一种通过查找定位远程资源的机制。它与连接池库没有任何共同之处。这些库（其中 c3p0、DBCP 和 BoneCP 最为著名）允许您创建具有池连接和/或语句能力的数据源。*如果在*您的应用程序中使用此数据源，则不需要使用 JNDI，如果它位于*远程*系统上（例如，在 Tomcat 中），则需要使用 JNDI 来访问数据源。

作为旁注，您为什么选择使用老式的 Servlet/JSP 组合？使用 JSP 后继者 facelets 是一个更好的主意，它是 JSF 2.x 中的首选视图技术。

另一个评论是将您的数据源的管理转移到一个众所周知的框架。一个方向可能是使用 ORM，例如 Hibernate，来管理您的数据源（在创建时考虑到连接池）。

# objective-c - 如何在Objective C：NSString中显示复杂的分数？NSAttributedString？

> ID：15032588
> 
> 赞同：3
> 
> 时间：2013-02-22T20:23:24.600
> 
> 标签：objective-c, cocoa, nsstring

`NSString`是否可以使用Cocoa 中的任何 -like 类来显示分数？

例如，我想将分数 (x+2)/(x-4) 显示为`NSString`其中 (x+2) 位于表达式 (x-4) 上方的一行上方。这是一个更复杂示例的图像：

![在此处输入图像描述](../Images/ab861229a4e475231264878b5d261f05.png)

我已经可以考虑如何使用一堆`NSView`s 来做到这一点，但想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:48:08.753

您可以使用`UIWebView`实例和开源[MathJax 库](http://docs.mathjax.org/en/latest/installation.html)来呈现用适当的[TeX](http://en.wikipedia.org/wiki/TeX)编写的数学代码。

# css - CSS 帮助响应主题

> ID：15032589
> 
> 赞同：0
> 
> 时间：2013-02-22T20:23:25.870
> 
> 标签：css, html

我对这么“小”的东西有一个大问题，我无法弄清楚，我正在与这里的每个人联系。我遇到的问题是这样的：

我有大约 512 像素或 800 像素宽的照片，我想在圆形显示区域居中放置并保持悬停效果。我还需要调整照片的大小，以便居中的部分显示相当数量的照片。

如果照片是完美的正方形，我正在使用的当前代码将使它们成为完美的圆圈。问题是当照片是矩形时，它会变成椭圆形。

我使用 overflow:hidden 和 css 创建了一个如下所示的 div，但它与当前的 CSS 冲突。任何帮助将不胜感激！

```
.thumby {
width:200px;
margin: 0 auto;
overflow:hidden;
position: relative;
height: 200px;
border-radius: 100% 100% 100% 100%; 
```

}

```
img.absolutely {
left: 50%;
margin-left: -256px;
top: 50%;
margin-top: -200px;
position:absolute;
width:512px; 
```

}

这是我的开发页面的链接。

[http://www.lmcodebox.com/b-test/index5.html](http://www.lmcodebox.com/b-test/index5.html)

[http://www.lmcodebox.com/b-test/portfolio.html](http://www.lmcodebox.com/b-test/portfolio.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:39:29.263

你有没有想过将图像设置为 div 的背景？这样你就可以保留你已经使用的所有效果，并且有一些方法可以在不影响外部 div 的情况下操纵背景位置。拥有完美圆形 div 的其他可能解决方案是使用 ::after 伪类，就像在这个画廊教程中一样： [http ://webdesignerwall.com/tutorials/decorative-css-gallery-part-2](http://webdesignerwall.com/tutorials/decorative-css-gallery-part-2)

对不起，如果我误解了你，希望对你有所帮助。

PS.：顺便说一句，漂亮的测试页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:45:47.887

* * *

首先，您只需将边框半径设置为 50% 即可使某个圆成为圆形，如果每个角的值相同，则只需输入一次，如下所示：

```
border-radius:50%; 
```

就这些图像是矩形而言，您可以将图像设置为跨度的背景，给它一个高度和一个形成正方形的宽度并使用显示块。这将使照片保持比例，但允许您将它们设为正方形。

但是，如果您有很多图像要显示，这可能会造成一些标记混乱。另一种解决方案，这意味着更多的工作，但我个人会这样做，就是使用 Photoshop 或其他一些图像编辑工具将你的图像裁剪成正方形作为缩略图。

最重要的是，我没有看到您链接的页面上实际声明的宽度或高度。你确定你把他们放在了正确的班级吗？我看到声明的边界半径，但我只看到 max-width: 100%; 不是宽度：200 像素或高度：200 像素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T08:06:00.370

我重新考虑了使用图像作为元素背景的建议，就像上面**madaaah**所做的那样。

我最终做的是在我的 A 标签周围包裹一个 DIV，如下所示：

然后，我像这样设置 A 的背景： style="background:url(PHOTO URL HERE) no-repeat;background-position:center;">

最后，我制作了一个方形图像 (800 x 800) 进入 A 标签内部，使其保持圆形并使其完全透明，因此背景图像可见，同时以“响应式”方式增长和缩小。

# android - 在 Android 应用程序中使用 MediaPlayer 的正确方法

> ID：15032590
> 
> 赞同：5
> 
> 时间：2013-02-22T20:23:28.580
> 
> 标签：android, android-mediaplayer

对不起我的英语，但我来自巴西，我使用了谷歌翻译。

好吧，我在这个应用程序中苦苦挣扎，我试图将流媒体制作成在线广播，在 2.2 版中运行良好，但 4.0 版不起作用。没有错误发生，根本不起作用。下面是我的代码。

我很感激任何帮助。

```
package com.radiomiriam;
import java.io.IOException;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Toast;

public class Main extends Activity {
public String url = "http://69.64.48.96:9880";
public MediaPlayer player = new MediaPlayer();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    play();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

public void stop(){
    Toast.makeText(getApplicationContext(), "Finalizando...", Toast.LENGTH_SHORT).show();
    if(player.isPlaying()){
        player.stop();
    }
}

public void play(){
    if(player.isPlaying()){
        Toast.makeText(getApplicationContext(), "Já está em execução!", Toast.LENGTH_SHORT).show();
    } else {
        Toast.makeText(getApplicationContext(), "Preparando...", Toast.LENGTH_SHORT).show();
        player.setAudioStreamType(AudioManager.STREAM_MUSIC);
        player.setAudioStreamType(AudioManager.STREAM_NOTIFICATION);
        try {
            player.setDataSource(url);
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (SecurityException e) {
            e.printStackTrace();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        try {
            player.prepare();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        player.start();
    }
}

public void onClick(View v) {
    final int id = v.getId();
    switch (id) {
    case R.id.btnPlay:
        play();
        break;
    case R.id.btnStop:
        stop();
        break;
    }
}
} 
```

您好，请原谅我的坚持，但我的问题仍然没有找到解决方案，不知道如何解决，我再次请求您帮助解决这个问题。

该应用程序在 2.x 和 3.x 版本中运行，但不在 4.x 版本中运行。以下是下载该项目的链接，您可以查看并帮助我。

[http://nsi.inf.br/RadioMiriam.rar](http://nsi.inf.br/RadioMiriam.rar)（已删除）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T09:31:50.257

我下载了你的项目，它实际上返回错误代码：E/MediaPlayer(1976): error (-38, 0)

这是由在准备好之前启动媒体播放器引起的。

我做了一些改变，它开始工作了。你应该 ：

1.  在 MediaPlayer 上设置 onPrepared 监听器（即在 onCreate 中）

    ```
    player.setOnPreparedListener(new OnPreparedListener() {
        @Override
        public void onPrepared(MediaPlayer mp) {
            mp.start();
        }
    }); 
    ```

2.  从您的 play() 方法中删除 player.start()

3.  以这种方式设置数据源（在你的 play() 方法中）

    ```
    player.setDataSource(this, Uri.parse("http://69.64.48.96:9880/")); 
    ```

它适用于我的 HTC Sensation 与 Android 4.0.3

如果您需要任何帮助，请告诉我。

编辑：我忘了，我也删除了

```
player.setAudioStreamType(AudioManager.STREAM_NOTIFICATION); 
```

这是多余的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:32:26.930

该`prepare()`调用可能阻塞了 UI 线程（当你这样做时，android 4.0 讨厌它）

您需要在异步任务等后台线程中完成这项工作。这是实现 AsyncTask 以`play()`在后台运行的匿名版本。

```
public void onClick(View v) {
    final int id = v.getId();
    switch (id) {
    case R.id.btnPlay:
        new AsyncTask<Void, Void, Void>(){
            @Override
            protected Void doInBackground(Void... voids) {
                play();
                return null;
            }
        }.execute();
        break;
    case R.id.btnStop:
        stop();
        break;
    }
} 
```

您需要阅读一些有关[MediaPlayer 状态](http://developer.android.com/reference/android/media/MediaPlayer.html#prepare%28%29) （播放、准备、停止等）的信息，以了解调用 prepare 会阻塞 UI 线程的原因（

有关[AsyncTasks的更多信息](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:42:30.173

您尚未在 .xml 文件中的按钮和代码之间设置任何链接。即使您按下按钮，也永远不会调用 onClick 方法。

用这个替换你的 onCreate 方法：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button playButton = (Button) findViewById(R.id.btnPlay);
    playButton.setOnClickListener(this);
    Button stopButton = (Button) findViewById(R.id.btnStop);
    stopButton.setOnClickListener(this);
    play();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:58:47.683

**在 android 中，在后台线程上做任何IO**工作总是更好。

这包括 MediaPlayer 。但在 MediaPlayer 的情况下，您已经有了`prepareAsync()`在后台为您准备 MediaPlayer 的方法。

一个很好的方法是这样的：

```
package com.radiomiriam;
import java.io.IOException;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.view.View;
import android.widget.Toast;

public class Main extends Activity  implements OnPreparedListener{
public String url = "http://69.64.48.96:9880";
public MediaPlayer player = new MediaPlayer();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    play();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

public void stop(){
    Toast.makeText(getApplicationContext(), "Finalizando...", Toast.LENGTH_SHORT).show();
    if(player.isPlaying()){
        player.stop();
    }
}

public void play(){
    if(player.isPlaying()){
        Toast.makeText(getApplicationContext(), "J? est? em execuç?o!", Toast.LENGTH_SHORT).show();
    } else {
        Toast.makeText(getApplicationContext(), "Preparando...", Toast.LENGTH_SHORT).show();
        player.setAudioStreamType(AudioManager.STREAM_MUSIC);
        player.setAudioStreamType(AudioManager.STREAM_NOTIFICATION);
        try {
            player.setDataSource(url);
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (SecurityException e) {
            e.printStackTrace();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        try {
            player.setOnPreparedListener(this);
            player.prepareAsync();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        }
    }
}
@Override
public void onPrepared(MediaPlayer mp) {
    // TODO Auto-generated method stub
    mp.start();
}
public void onClick(View v) {
    final int id = v.getId();
    switch (id) {
    case R.id.btnPlay:
        play();
        break;
    case R.id.btnStop:
        stop();
        break;
    }
}
} 
```

此外，阅读文档始终是一个好习惯，因此这里是 MediaPlayer API 的链接：[MediaPlayer](http://developer.android.com/reference/android/media/MediaPlayer.html)

# matlab - 结构的预分配，matlab

> ID：15032591
> 
> 赞同：0
> 
> 时间：2013-02-22T20:23:29.607
> 
> 标签：matlab

matlab中结构的预分配是一个问题。请在 matlab profiler 中查看以下代码

```
 time   calls  line

                2    65 sizeofTLS= 10000;
    < 0.01       2   66 LaserS(sizeofTLS).POI(n)={0}; 
      0.03       2   67 LaserS(sizeofTLS).dis(n)={0}; 
      0.04       2   68 LaserS(sizeofTLS).plane(n)={0}; 
                     69 
                     70 
    < 0.01       2   71 for it=1:sizeofTLS 
     16.74 2823212   72     LaserS(it).POI(1:n)={0}; 
     16.91 2823212   73     LaserS(it).dis(1:n)={0}; 
     16.88 2823212   74     LaserS(it).plane(1:n)={0}; 
      1.04 2823212   75 end 
```

我该如何改进它（72,73,74）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:29:58.070

预分配结构的最佳方法是使用以下语法：

```
myEmptyCell = num2cell( zeros(1,n) );
b           = repmat( struct('POI', myEmptyCell ,...
                             'dis', myEmptyCell,...
                             'plane', myEmptyCell ) , sizeofTLS, 1 ); 
```

这比在我的笔记本电脑上不预分配快约 10 倍。

# c++ - 向可变参数模板类添加回调 - 不可能吗？

> ID：15032594
> 
> 赞同：1
> 
> 时间：2013-02-22T20:23:37.767
> 
> 标签：c++, visual-studio-2012, callback, variadic-templates

我正在尝试创建一个模板类，它有一个 Add 方法，它将一个函数回调附加到该类，所以当我可以从那里使用指定的参数列表调用它时。它编译得很好，除了我所在的部分调用回调。它只是不接受参数，我已经尝试了我能想到的一切，但它仍然给我同样的“无法扩展参数包”错误。我使用*Visual Studio 2012*和**Microsoft Visual C++ 编译器2012 CTP (v120_CTP_Nov2012)** 这里是示例源：模板类变量 { private: void (*)($arguments...) callbackPtr;

```
public:
    Variadic();
    ~Variadic();

    void Attach(void (*callback)($arguments...));

    void operator()($arguments... arguments);
}; 
```

然后我向它添加一个回调：

```
template<typename... $arguments>
void Variadic<$arguments...>::Attach(void (*callback)($arguments...))
{
    callbackPtr = callback;
} 
```

并使用 () 运算符执行它：

```
template<typename... $arguments>
void Variadic<$arguments...>::operator()($arguments... arguments)
{
    (callbackPtr)(arguments...);
} 
```

在 main.cpp 我做了一个小测试：

```
 void test(int testInt, float testFloat)
{
    //DoNothing
}

int main()
{
Variadic<int, float> var; //create one that will have a callback that takes an int and a float argument
var.Attach(test); //attach test, which takes an int and a float as arguments
var(2, 3.0f); //try to call it
} 
```

问题出现在我构建时 - 它在这一行给了我 2 个错误：***(callbackPtr)(arguments...);*** 错误是：

> 错误 C3546：“...”：没有可用于展开的参数包错误 C2065：“参数”：未声明的标识符

起初我认为这是一个语法问题，我没有正确传递**参数......但我尝试了所有可能的方法，它仍然给我同样的错误。我在“***参数包扩展*”中找不到太多信息谷歌要么。我做错了什么？我确定我以某种方式错误地使用了***(callbackPtr)(arguments...);*** 打电话，但不知道怎么打。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:02:20.940

在我进入答案之前，你应该知道一些事情：

*   Microsoft VC++ 2012 年 11 月的 CTP 不能很好地处理可变参数和函数指针/函数签名。在几乎所有情况下，都需要手动手动扩展它们。它很糟糕，但你必须忍受它，直到我们投入 VS 和 VC++ 的所有资金真正开花结果，并且我们得到一个具有其他编译器已经支持的大量 C++11 特性的编译器。

*   传递函数指针并让编译器确定正确的类型比大多数人乍看之下猜测的要复杂一些。有很多类型~~引诱~~演绎和模板专业化。

除此之外，基于函数指针和成员函数的回调需要很多模板魔法和很多有趣的功能，而不仅仅是使用`std::function<>`. 在我向您展示我最终使用的解决方案之前，我强烈建议您使用 a `std::vector<std::function<[RETURNTYPE]( [PARAMS] )> >`（或仅`std::function`用于单次返回）来避免尝试使这一切都解决的巨大麻烦。在任何一种情况下，[请参阅我在@Insilico 下方的回答，了解在 GCC 中使用可变参数模板可以正常工作的回调和事件系统](https://stackoverflow.com/a/13614540/1357649)。

正如我之前所说，对于在 VC++ 中工作的版本，您必须手动修改各种定义，我最终创建了一个回调类和一个事件类来执行此操作。它适用于多个回调，但如果需要，您可以将类简化`Event`为单个附加/回调：

```
template<typename TFuncSignature>
class Callback;

/////////////////
/* 2 ARGUMENT  */
/////////////////

template<typename R, typename T1, typename T2>
class Callback<R (T1, T2)> {
public:
    typedef R (*TFunc)(void*, T1, T2);

    const static size_t Arity = 2;

    Callback() : obj(0), func(0) {}
    Callback(void* o, TFunc f) : obj(o), func(f) {}

    R operator()(T1 t1, T2 t2) const {
        return (*func)(obj, t1, t2);
    }

    typedef void* Callback::*SafeBoolType;
    operator SafeBoolType () const {
        return func != 0? &Callback::obj : 0;
    }

    bool operator! () const {
        return func == 0;
    }

    bool operator== ( const Callback<R (T1, T2)>& right ) const {
        return obj == right.obj && func == right.func;
    }

    bool operator!= ( const Callback<R (T1, T2)>& right ) const {
        return obj != right.obj || func != right.func;
    }

private:
    void* obj;
    TFunc func;
};

namespace detail {
    template<typename R, class T, typename T1, typename T2>
    struct DeduceConstMemCallback2 { 
        template<R(T::*Func)(T1, T2) const> inline static Callback<R(T1, T2)> Bind(T* o) {
            struct _ { static R wrapper(void* o, T1 t1, T2 t2) { return (static_cast<T*>(o)->*Func)(std::forward<T1>(t1, t2); } };
            return Callback<R(T1, T2)>(o, (R(*)(void*, T1, T2)) _::wrapper);
        }
    };

    template<typename R, class T, typename T1, typename T2>
    struct DeduceMemCallback2 { 
        template<R(T::*Func)(T1, T2)> inline static Callback<R(T1, T2)> Bind(T* o) {
            struct _ { static R wrapper(void* o, T1 t1, T2 t2) { return (static_cast<T*>(o)->*Func)(t1, t2)); } };
            return Callback<R(T1, T2)>(o, (R(*)(void*, T1, T2)) _::wrapper);
        }
    };

    template<typename R, typename T1, typename T2>
    struct DeduceStaticCallback2 { 
        template<R(*Func)(T1, T2)> inline static Callback<R(T1, T2)> Bind() { 
            struct _ { static R wrapper(void*, T1 t1, T2 t2) { return (*Func)(t1), t2); } };
            return Callback<R(T1, T2)>(0, (R(*)(void*, T1, T2)) _::wrapper); 
        }
    };
}

template<typename R, class T, typename T1, typename T2>
detail::DeduceConstMemCallback2<R, T, T1, T2> DeduceCallback2(R(T::*)(T1, T2) const) {
    return detail::DeduceConstMemCallback2<R, T, T1, T2>();
}

template<typename R, class T, typename T1, typename T2>
detail::DeduceMemCallback2<R, T, T1, T2> DeduceCallback2(R(T::*)(T1, T2)) {
    return detail::DeduceMemCallback2<R, T, T1, T2>();
}

template<typename R, typename T1, typename T2>
detail::DeduceStaticCallback2<R, T1, T2> DeduceCallback2(R(*)(T1, T2)) {
    return detail::DeduceStaticCallback2<R, T1, T2>();
}

template <typename T1, typename T2> class Event2 {
public:
    typedef void(* TSignature)(T1, T2);
    typedef Callback<void(T1, T2)> TCallback;
    typedef std::vector<TCallback> InvocationTable;

protected:
    InvocationTable invocations;

public:
    const static int ExpectedFunctorCount = 2;

    Event2 () : invocations() {
        invocations.reserve( ExpectedFunctorCount );
    }

    Event2 ( int expectedfunctorcount ) : invocations() {
        invocations.reserve( expectedfunctorcount );
    }

    template <void (* TFunc)(T1, T2)> void Add (  ) {
        TCallback c = DeduceCallback2( TFunc ).template Bind< TFunc >( );
        invocations.push_back( c );
    }

    template <typename T, void (T::* TFunc)(T1, T2)> void Add ( T& object ) {
        Add<T, TFunc>( &object );
    }

    template <typename T, void (T::* TFunc)(T1, T2)> void Add ( T* object ) {
        TCallback c = DeduceCallback2( TFunc ).template Bind< TFunc >( object );
        invocations.push_back( c );
    }

    template <typename T, void (T::* TFunc)(T1, T2) const> void Add ( T& object ) {
        Add<T, TFunc>( &object );
    }

    template <typename T, void (T::* TFunc)(T1, T2) const> void Add ( T* object ) {
        TCallback c = DeduceCallback2( TFunc ).template Bind< TFunc >( object );
        invocations.push_back( c );
    }

    void Invoke ( T1 t1, T2 t2 ) {
        size_t i;
        for ( i = 0; i < invocations.size(); ++i ) {
            invocations[i]( t1, t2 );
        }
    }

    void operator() ( T1 t1, T2 t2 ) {
        size_t i;
        for ( i = 0; i < invocations.size(); ++i ) {
            invocations[i]( t1, t2 );
        }
    }

    size_t InvocationCount ( ) {
        return invocations.size( );
    }

    template <void (* TFunc)(T1, T2)> bool Remove ()          
    { return Remove (DeduceCallback2(TFunc).template Bind<TFunc>()); } 
    template <typename T, void (T::* TFunc)(T1, T2)> bool Remove (T& object) 
    { return Remove <T, TFunc>(&object); } 
    template <typename T, void (T::* TFunc)(T1, T2)> bool Remove (T* object) 
    { return Remove (DeduceCallback2(TFunc).template Bind<TFunc>(object)); } 
    template <typename T, void (T::* TFunc)(T1, T2) const> bool Remove (T& object) 
    { return Remove <T, TFunc>(&object); } 
    template <typename T, void (T::* TFunc)(T1, T2) const> bool Remove (T* object) 
    { return Remove (DeduceCallback2(TFunc).template Bind<TFunc>(object)); } 

protected:

    bool Remove( TCallback const& target ) {
        auto it = std::find(invocations.begin(), invocations.end(), target);
        if ( it == invocations.end()) 
            return false;
        invocations.erase(it);
        return true;
    }

}; 
```

# opencv - opencv warpaffin 崩溃

> ID：15032597
> 
> 赞同：0
> 
> 时间：2013-02-22T20:23:55.100
> 
> 标签：opencv, crash

我在尝试跳过对 warpAffine 的调用时遇到崩溃（不是例外）：

```
void rotateImage( const Mat& source, double degree, Mat& output )
{
    Point2f src_center( source.cols / 2.0F, source.rows / 2.0F );
    Mat rot_mat = getRotationMatrix2D( src_center, degree, 1.0 );
    output.create( source.size(), source.type() );
    warpAffine( source, output, rot_mat, source.size() );
} 
```

这在第一次使用灰度图像时运行良好。然而对于彩色图像（IMREAD_COLOR - 2010 x 222 x 24bit mat），它会**崩溃**。没有用尝试/捕捉..

有什么线索吗？

我正在使用 windows7 + Qt5.0.1 + opencv243 编译器是visual studio 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:04:47.533

好的……谜团解开了……

**OpenCV 241 在 243 不适用的情况下工作**......所以，如果你要去**Qt + VS2010 + Win7 使用 opencv 241 并避免 243** ...我使用了他们网站上提供的预编译的 opencv。

不会报告错误..我没有时间，opencv 的一个可怜的家伙不提供正确的构建！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:53:46.440

在 warpAffine() 中使用 dst.size() 而不是 src.size()

# python - 如何在 PyObjC 中自我处理 cookie

> ID：15032611
> 
> 赞同：1
> 
> 时间：2013-02-22T20:24:33.510
> 
> 标签：python, webkit, pyobjc

我在 PyObjC 中为我的学习实现了一个最小的浏览器。首先，我在 pyobjc 中搜索了使用 webkit 的方法，并编写了如下代码：

```
#coding: utf-8

import Foundation
import WebKit
import AppKit
import objc

def main():
    app = AppKit.NSApplication.sharedApplication()
    rect = Foundation.NSMakeRect(100,350,600,800)
    win = AppKit.NSWindow.alloc()
    win.initWithContentRect_styleMask_backing_defer_(
        rect,
        AppKit.NSTitledWindowMask |
            AppKit.NSClosableWindowMask |
            AppKit.NSResizableWindowMask |
            AppKit.NSMiniaturizableWindowMask,
        AppKit.NSBackingStoreBuffered,
        False)
    win.display()
    win.orderFrontRegardless()

    webview = WebKit.WebView.alloc()
    webview.initWithFrame_(rect)

    pageurl = Foundation.NSURL.URLWithString_("http://twitter.com")
    req = Foundation.NSURLRequest.requestWithURL_(pageurl)
    webview.mainFrame().loadRequest_(req)

    win.setContentView_(webview)
    app.run()

if __name__ == '__main__':
    main() 
```

它工作得很好。但我注意到这个浏览器正在与 safari 共享 cookie。我希望它独立于我的 Safari.app。所以我再次用谷歌搜索，我了解到我可以使用**NSMutableURLRequest**覆盖 cookie-handling-methods 。下面是我测试的第二个代码：

```
#coding: utf-8

import Foundation
import WebKit
import AppKit
import objc

def main():
    app = AppKit.NSApplication.sharedApplication()
    rect = Foundation.NSMakeRect(100,350,600,800)
    win = AppKit.NSWindow.alloc()
    win.initWithContentRect_styleMask_backing_defer_(
        rect,
        AppKit.NSTitledWindowMask |
            AppKit.NSClosableWindowMask |
            AppKit.NSResizableWindowMask |
            AppKit.NSMiniaturizableWindowMask,
        AppKit.NSBackingStoreBuffered,
        False)
    win.display()
    win.orderFrontRegardless()

    webview = WebKit.WebView.alloc()
    webview.initWithFrame_(rect)

    pageurl = Foundation.NSURL.URLWithString_("http://twitter.com")
    req = Foundation.NSMutableURLRequest.requestWithURL_(pageurl)
    Foundation.NSMutableURLRequest.setHTTPShouldHandleCookies_(req, False)
    webview.mainFrame().loadRequest_(req)

    win.setContentView_(webview)
    app.run()

if __name__ == '__main__':
    main() 
```

这段代码向我展示了 twitter 的登录屏幕 :-) 但我无法通过此浏览器登录 twitter。我输入帐户名、密码并按下回车键。然后浏览器会显示我一直在 Safari.app 中使用的帐户的时间线。

是的，我知道这是正确的结果。我没有写任何关于处理 cookie 的内容。我的问题是关于这一点。我想知道：

1.  如何实现和使用类似**NSHTTPCookieStorage 的**东西？
2.  我可以用python写吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T08:08:02.870

从简单的部分开始：如果可以在 Objective-C 中执行此操作，那么 PyObjC 也应该可以。

也就是说，我不清楚这是否可能。[如何在不共享 cookie 的情况下拥有多个 webkit 实例？](https://stackoverflow.com/questions/364219/how-can-i-have-multiple-instances-of-webkit-without-sharing-cookies)似乎表明它不是，尽管您可以通过 webkit 委托做某事。

另一种选择是使用 NSURLProtocol，注册一个自定义 NSURLProtocol 类来处理 http/https 请求并使用 Python 的 urllib 或 urllib2 实现它。PyDocURL[示例](http://pythonhosted.org/pyobjc/examples/WebKit/PyDocURLProtocol/index.html)展示了如何执行此操作（该示例为 pydoc:// URL 注册了一个子类）。

[有关 NSURLConnection 的更多信息，请访问 Apple 网站。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLProtocol_Class/Reference/Reference.html#//apple_ref/occ/clm/NSURLProtocol/registerClass:)

更新了实现提示：

另一种方法可能是通过 NSHTTPCookieStorage (NSHTTPCookieStorage.sharedHTTPCookieStorage.setCookieAcceptPolicy_(NSHTTPCookieAcceptPolicyNever)) 禁用 cookie 存储。然后使用 webkit 资源加载委托自己处理 cookie：

*   维护自己的 cookie 存储（可能使用 urllib2 中的类）

*   在 webView:resource:willSendRequest:redirectResponse:fromDataSource: 根据该存储中的信息添加 cookie 标头

*   在 webView:resource:didReceiveResponse:fromDataSource: 检查“set-cookie”标头并更新您自己的 cookie 存储。

这样做应该不会太难，我很想在 PyObjC 网站上将此功能作为示例（或者甚至作为 PyObjC 的 WebKit 绑定中的实用程序类）。

# python - Django，带有递归和 Twitter API 的 Celery

> ID：15032617
> 
> 赞同：3
> 
> 时间：2013-02-22T20:24:59.330
> 
> 标签：python, django, twitter, rabbitmq, celery

我正在使用 Django 1.4 和 Celery 3.0 (rabbitmq) 构建任务组合，用于获取和缓存对 Twitter API 1.1 的查询。我正在尝试实现的一件事是任务链，其中最后一项基于迄今为止的响应和最近检索到的响应中的响应数据，对两个节点的任务进行递归调用。具体来说，这允许应用程序遍历用户时间线（最多 3200 条推文），考虑到任何给定的请求最多只能产生 200 条推文（Twitter API 的限制）。

我的 tasks.py 的关键组件可以在[这里](http://pastebin.com/90HYGGJr)看到，但在粘贴之前，我将展示我从 Python shell 调用的链（但最终将通过最终 Web 应用程序中的用户输入启动）。鉴于：

```
>>request(twitter_user_id='#1010101010101#, 
  total_requested=1000, 
  max_id = random.getrandbits(128) #e.g. arbitrarily large number) 
```

我打电话：

```
>> res = (twitter_getter.s(request) | 
        pre_get_tweets_for_user_id.s() | 
        get_tweets_for_user_id.s() | 
        timeline_recursor.s()).apply_async() 
```

关键是timeline_recursor 可以启动可变数量的get_tweets_for_user_id 子任务。当timeline_recursor 在它的基本情况下，它应该返回一个响应字典，定义如下：

```
@task(rate_limit=None)
def timeline_recursor(request):
    previous_tweets=request.get('previous_tweets', None) #If it's the first time through, this will be None
    if not previous_tweets:
        previous_tweets = [] #so we initiate to empty array
    tweets = request.get('tweets', None) 

    twitter_user_id=request['twitter_user_id']
    previous_max_id=request['previous_max_id']
    total_requested=request['total_requested']
    pulled_in=request['pulled_in']

    remaining_requested = total_requested - pulled_in
    if previous_max_id:
        remaining_requested += 1 #this is because cursored results will always have one overlapping id

    else:
        previous_max_id = random.getrandbits(128) # for first time through loop

    new_max_id = min([tweet['id'] for tweet in tweets])
    test = lambda x, y: x<y

    if remaining_requested < 0:  #because we overshoot by requesting batches of 200
        remaining_requested = 0

    if tweets:
        previous_tweets.extend(tweets)

    if tweets and remaining_requested and (pulled_in > 1) and test(new_max_id, previous_max_id):

        request = dict(user_pk=user_pk,
                    twitter_user_id=twitter_user_id,
                    max_id = new_max_id,
                    total_requested = remaining_requested,
                    tweets=previous_tweets)

        #problem happens in this part of the logic???

        response = (twitter_getter_config.s(request) | get_tweets_for_user_id.s() | timeline_recursor.s()).apply_async()

    else: #if in base case, combine all tweets pulled in thus far and send back as "tweets" -- to be 
          #saved in db or otherwise consumed
        response = dict(
                    twitter_user_id=twitter_user_id,
                    total_requested = total_requested,
                    tweets=previous_tweets)
    return response 
```

因此，我对 res.result 的预期响应是一个字典，其中包含一个 twitter 用户 ID、请求的推文数量以及在连续调用中引入的一组推文。然而，在递归任务领域，一切都不是很好。当我运行上面确定的链时，如果我在启动链后立即进入*res.status*，它表示“成功”，即使在我的 celery worker 的日志视图中，我也可以看到正在对 twitter api 进行链式递归调用正如预期的那样，使用正确的参数。即使正在执行链式任务，我也可以立即运行 result.result。res.result 产生一个 AsyncResponse 实例 id。即使在递归链接的任务完成运行之后， res.result 仍然是一个 AsyncResult id。

另一方面，我*可以*通过 res.result.result.result.result['tweets'] 访问我的完整推文集。我可以推断出每个链接的链接子任务确实正在发生，我只是不明白为什么 res.result 没有预期的结果。当 timeline_recursor 获得其基本情况时应该发生的递归返回似乎没有按预期传播。

关于可以做什么的任何想法？Celery 中的递归可以变得非常强大，但至少对我来说，我们应该如何考虑使用 Celery 的递归和递归函数以及这如何影响链式任务中返回语句的逻辑并不完全清楚。

很高兴根据需要澄清，并提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:35:57.837

返回什么`apply_async`（如对象类型）？

我不知道 celery，但是在 Twisted 和许多其他异步框架中......`True`当任务被推迟到队列中时，对类似的东西的调用会立即返回（通常或者可能是一个可以跟踪状态的对象）。

再次，不知道 celery ，我猜这正在发生：

你是：`response`立即定义为 async deferred `task`，但随后尝试对其采取行动，就好像结果已经进来一样

您想成为：定义一个`callback`例程以在任务完成后在结果上运行并返回一个值

查看 celery 文档，`apply_async`通过 - 接受回调`link`，我找不到任何人试图从中捕获返回值的示例。

# c++ - ///的目的是什么 在 Visual Studio 中

> ID：15032619
> 
> 赞同：0
> 
> 时间：2013-02-22T20:25:01.823
> 
> 标签：c++, frameworks, visual-studio-2012

我在网上搜索并没有找到解释此评论块用法的结果。因此，我希望有人能向我解释这种评论风格背后的原因。

```
///<comment> Text goes here. </comment> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T20:26:15.570

它们是 XML 文档注释。

[http://msdn.microsoft.com/en-us/library/b2s063f7.aspx](http://msdn.microsoft.com/en-us/library/b2s063f7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:27:16.193

它是软件聚合器和 Visual Studio 本身经常使用的 XML 语法来生成帮助/文档文件。比如沙堡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:34:25.680

它们也被 doxygen 识别为文档注释： http:
[//www.doxygen.nl/manual/docblocks.html](http://www.doxygen.nl/manual/docblocks.html)

**编辑 1：更正**
doxygen 识别开头的“///”，而不是`</comment>`.

# ios - 附加到多部分表单的断言失败

> ID：15032621
> 
> 赞同：10
> 
> 时间：2013-02-22T20:25:09.857
> 
> 标签：ios, objective-c, afnetworking

我正在将我的应用程序从 ASIHTTPRequest 迁移到 AFNetworking 以与后端 API 对话。除了上传图片外，一切似乎都很好。我在互联网上使用了不同的示例，但在我的应用程序上运行它总是会导致崩溃。

```
2013-02-22 17:02:28.680 MyApp[1477:907] *** Assertion failure in -[AFStreamingMultipartFormData appendPartWithHeaders:body:], AFNetworking/AFHTTPClient.m:885
2013-02-22 17:02:28.687 MyApp[1477:907] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Invalid parameter not satisfying: body' 
```

问题似乎在这里：

```
NSMutableURLRequest *request = [[MyServiceAPIClient sharedClient] multipartFormRequestWithMethod:@"POST" path:@"/api/method" parameters:nil constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
    [formData appendPartWithFileData:imageData name:@"face" fileName:@"face.jpg" mimeType:@"image/jpeg"];
}]; 
```

`MyServiceAPIClient`是一个单例类，在 AFNetworking iOS 示例应用程序中给出。

如果我评论这`appendPartWithFileData`部分一切正常，显然它不会发送我的照片。

如果我用普通的发布请求替换多部分表单请求，它就可以工作。唯一的问题是将 my 附加`NSData`到表单中。

有什么观察吗？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-22T20:32:47.987

查看`AFNetworking/AFHTTPClient.m`代码后，我猜你`imageData`是`nil`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-05T07:38:51.697

补充一点，虽然 Sulthan 的回答是正确的，但您通常可以通过将任何带有`nil`值的参数插入到`formData`.

# c# - MVC 将 Base64 字符串转换为图像，但是 ... System.FormatException

> ID：15032622
> 
> 赞同：6
> 
> 时间：2013-02-22T20:25:31.110
> 
> 标签：c#, asp.net-mvc, base64, form-data

我的控制器在此代码的请求对象中获取上传的图像：

```
[HttpPost]
public string Upload()
{
    string fileName = Request.Form["FileName"];
    string description = Request.Form["Description"];
    string image = Request.Form["Image"];

    return fileName;
} 
```

image 的值（至少是它的开头）看起来很像这样：

```
data:image/jpeg;base64,/9j/4AAQSkZJRgABAgEAYABgAAD/7gAOQWRvYmUAZAAAAAAB/... 
```

我尝试使用以下方法进行转换：

```
byte[] bImage = Convert.FromBase64String(image); 
```

但是，这给出了 System.FormatException：“输入不是有效的 Base-64 字符串，因为它包含非 base 64 字符、两个以上的填充字符或填充字符中的非法字符。”

我觉得问题在于至少字符串的开头不是base64，但据我所知，它都不是。我需要在解码之前解析字符串吗？我错过了一些完全不同的东西吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:29:44.417

看起来你*可以*从一开始就去掉这个`"data:image/jpeg;base64,"`部分。例如：

```
const string ExpectedImagePrefix = "data:image/jpeg;base64,";
...
if (image.StartsWith(ExpectedImagePrefix))
{
    string base64 = image.Substring(ExpectedImagePrefix.Length);
    byte[] data = Convert.FromBase64String(base64);
    // Use the data
}
else
{
    // Not in the expected format
} 
```

当然，您可能希望使此 JPEG 特定性降低一些，但我会尝试将其作为第一次通过。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-01-29T08:31:53.923

原因确实是“data:image/jpeg;base64”，我建议使用这种方法从 base64 中删除起始字符串

```
var base64Content = image.Split(',')[1];
byte[] bImage = Convert.FromBase64String(base64Content); 
```

这是最短的解决方案，您不必使用魔术字符串或编写正则表达式。

# oracle11g - 如何减少 ODP.NET 中 Connection.Open 的超时

> ID：15032627
> 
> 赞同：0
> 
> 时间：2013-02-22T20:25:43.463
> 
> 标签：oracle11g, odp.net

我正在为我的 C# Oracle 11g ODP.NET4 应用程序进行拉线测试。一旦我拔下电缆并尝试连接到 Oracle，Connection.Open() 方法会等待大约 15 秒，然后返回错误“连接请求超时”。

我希望看到这 15 秒减少到 5 秒，甚至 3 秒。

我认为连接字符串参数“连接超时”可以解决这个问题，但它没有。我将它设置为 3，打开仍然需要 15 秒。经过一番阅读，事实证明该参数与池化有关，可能不适用于此处。

有没有办法减少打开命令返回错误所需的时间？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T02:16:29.283

您应该查看 FAN 和 FCF。

# javascript - 柜台箱，对所有客户可见

> ID：15032628
> 
> 赞同：0
> 
> 时间：2013-02-22T20:25:44.060
> 
> 标签：javascript, ajax, jquery, counter

您好，我的网站需要一个按钮，它将从 60 秒开始倒计时到 0，然后它应该显示一些文本（让我们喝酒，欢呼）并返回开始按钮。

所有用户都必须能够看到这个倒计时，这样当一个用户开始倒计时时其他用户可以看到这个。

它还应该显示一个计数器，有多少用户点击了按钮，并加入了“按钮”

我已经研究过了，但我需要做 Ajax / javascript pull。

由于我的编程技能仍处于复制/粘贴/编辑水平，我不知道如何开始，我可以构建计时器，但不知道如何进行拉动。

谁能帮我开始。

问候勒内

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:00:01.547

首先，您需要一个有状态的后端来存储用户数。所以php +任何数据库。

你提到了socket.io，建立在nodejs上。

使用 nodejs 这并不困难，因为它是一个单线程运行时，因此您可以将变量值共享给不同的客户端。

你的 nodejs 必须听 3 个 url：

1.  用于传递基础页面（可以在没有 nodejs 的情况下完成，只需 url 到 html）
2.  用于将按钮的点击从客户端传递到后端的 ajax url，返回当前计数
3.  ajax url 传递当前秒数，返回当前计数和连接用户。

每次调用 2\. 频道时，您需要检查倒计时是否已经开始运行。如果不是：启动它，否则增加点击计数器。

像这样：

```
//nodejs code
var currendSeconds=60;
var connectedClients = 0;
var threadid;

function clientClickedButton(req, res){ // 2\. url
     if(currendSeconds==60 || ) {
          threadid = setInterval(function(){
                currendSeconds--;
                if(currentSeconds == 0){
                    clearInterval(threadid);
                }
          }, 1000);  //your counter
     }
     connectedClients++;
     res.send(currendSeconds);
} 
```

您的客户端必须监听按钮上的点击事件，向 2.url 发送 ajax req 并显示返回的秒数（从现在开始我们不需要请求秒数，只需设置倒计时客户端，无需请求当前秒数. )

# git - 如何在其中任何一个的多个解决方案下提交同一个项目？

> ID：15032630
> 
> 赞同：1
> 
> 时间：2013-02-22T20:25:50.887
> 
> 标签：git, version-control, commit, dvcs

这肯定必须是重复的，因为它是一个常见的场景，如果是这样，请引导我找到一个好的链接。

我有一个通用项目（类库），它将在许多解决方案中使用，比如说，一个通用解决方案，我将其称为`dll`在解决方案`A`和`B`. 所以现在的目录结构是这样的：

```
Solution Common (dll)
      - Project Common

Solution A
      - Project A1

      - Project A2

      - Project Common #only referenced, so logical presence, not in real

Solution B
      - Project B1

      - Project B2

      - Project Common #only referenced, so logical presence, not in real 
```

现在我需要的是

1.  一个 git 存储库，`dll`以便我可以提交对`dll`文件所做的更改。

2.  一个 git 存储库，`A`以便我可以提交对文件`A`以及`dll`文件所做的更改。（由于在 Visual Studio 中我将两个项目都放在一个解决方案下，因此编辑它们很容易，但我应该能够将它们**一起**提交）。如果我可以`dll`从`dll`存储库中提取任何特定的提交，也将受到欢迎，但这不是绝对必要的。

3.  与上述相同`B`。

基本上我需要 3 个存储库，以便我可以在 3 个不同的解决方案文件夹中单独提交，但我还需要能够在`dll`存储库之间共享存储库，`A`并且`B`我可以从中提交和提取等。

我的问题是：

1.  是否可以？

2.  如果是这样，我将如何构建我的存储库？

3.  我将如何提交/拉动`dll`并`A`在一起？

我已经想到的一种解决方案是为其范围之外的所有 3 个解决方案拥有一个巨大的存储库，但这似乎很不优雅，因为我还有其他解决方案文件夹`A`以及`B`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:24:05.290

我确认这是**[git 子模块](http://git-scm.com/docs/git-submodule)**（由[madhead](https://stackoverflow.com/users/750510/madhead)[提到](https://stackoverflow.com/questions/15032630/how-to-commit-same-project-under-multiple-solutions-from-any-of-them/15033431#comment21126282_15032630)）的用途，但您需要意识到子模块首先是对另一个 repo 的*固定*引用。 您可以直接在子模块中进行修改，但您需要：

 **   在该子模块中提交，并推送到其上游仓库
*   cd 回到父仓库
*   在该父仓库中提交（记录子模块的新引用）并推送到父上游仓库

[（在“子模块的真实性质](https://stackoverflow.com/questions/1979167/git-submodule-update/1979194#1979194)”中查看更多内容）

这非常适合[基于组件的](https://stackoverflow.com/questions/933723/what-is-component-driven-development/933735#933735)方法，其中每个模块都可以独立发展，并且将所述模块的特定修订组合在一起以形成完整的程序。
（您的“巨型回购”将是一种基于系统的方法，其中所有模块都是可写的，并且在其*最新*版本中）*

# javascript - 电子邮件网站和电话号码的表单验证

> ID：15032631
> 
> 赞同：0
> 
> 时间：2013-02-22T20:25:56.320
> 
> 标签：javascript, html, validation

我在这里做错了什么？我正在尝试使用 javascript 运行一小段验证 bny。我正确地做正则表达式吗？

```
var z=document.forms["myForm"]["website"].value;
if (z==null || z=="")
  {
  $('.five').show();
  return false;
  }
var validWebsite = /^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/
if(!validWebsite.test(document.forms["myForm"]["website"].value))
{
  $('.five').html('Enter a Valid Website');
  return false;
}

var number = /^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/
if(!number.test(document.forms["myForm"]["number"].value)){
    $('.six').show()
    return false;
} 
```

html

```
*email: <br>
<input type="text" name="email"/><div class="four alertmessage" style="display:none;color:red;">Enter your Email</div><br>
website: <br>
<input type="text" name="website"/><div class="five alertmessage" style="display:none;color:red;">Enter your Website</div><br>
Contact phone number: <br>
<input type="text" name="number"/><div class="six alertmessage" style="display:none;color:red;">Enter your Number</div>

<input name="submit" class="submitButton" type="submit" value="Submit"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T07:05:36.287

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>
function validate()
{
    var z=document.forms["myForm"]["website"].value;
    if (z=="")
    {
        $('.five').show();
        return false;
    }

    var validWebsite = /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;
    if(!validWebsite.test(z)){
        $('.five').html('Enter a Valid Website');
        return false;
    }

    var n=document.forms["myForm"]["number"].value;
    var number = /^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/;
    if(!number.test(n)){
    $('.six').show()
    return false;
    }

    return true;
}
</script>

<form onsubmit="return validate()" method="post" name="myForm"> 
*email: <br>
<input type="text" name="email"/><div class="four alertmessage" style="display:none;color:red;">Enter your Email</div><br>
website: <br>
<input type="text" name="website"/><div class="five alertmessage" style="display:none;color:red;">Enter your Website</div><br>
Contact phone number: <br>
<input type="text" name="number"/><div class="six alertmessage" style="display:none;color:red;">Enter your Number</div>

<input name="submit" class="submitButton" type="submit" value="Submit">
</form> 
```

# java - 如何查找位于 linux 框上的文件的大小并在 java webapp 中显示

> ID：15032637
> 
> 赞同：0
> 
> 时间：2013-02-22T20:26:17.457
> 
> 标签：java, linux, jakarta-ee, document

我有一个显示一堆文档链接的网络应用程序。这些文件位于我的 linux 机器上。

现在我想在一列中显示每个文件的大小。

我现在想的解决方案是：

谷歌搜索后我注意到

```
du -h /home/user/me/doc.txt gives the size of file. 
```

所以我正在考虑获得一个新的网络服务，它需要一个文档位置，连接到我的盒子并运行上面的命令并吐回大小。

唯一担心的是我会有大约 1000 个结果。它们将位于不同的文件夹中。因此在每个文件上运行上述命令需要时间。

有什么办法可以有效地完成我的工作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:40:47.433

您可以使用 java 递归读取所有文件并排除不​​需要的文件并获取文件大小，但调用 du -h 更快，并且需要更少的代码。

```
 //you will problably need to tune up a bit the du command
        String[] cmd = {
        "/bin/sh", "-c", "du -h /home/user/me/*.txt" };//to get all the txt files size in folder

        try {
            Process p = Runtime.getRuntime().exec(cmd);
            BufferedReader bri = new BufferedReader(new InputStreamReader(
                    p.getInputStream()));

            String line = "";
            while ((line = bri.readLine()) != null) {
                System.out.println(line);
            }
        } catch (IOException e) {

            e.printStackTrace();
        } 
```

**更新** 我已经对不同目录中的 mp3 文件进行了测试，只需不到一秒钟的时间，就有超过 6000 个文件存储在不同的文件夹中。

使用的命令：

```
"/bin/sh", "-c", "du -h -a /media/mp3 | grep .mp3" 
```

# python - 如何从 button_press_event matplotlib 返回一个值？

> ID：15032638
> 
> 赞同：4
> 
> 时间：2013-02-22T20:26:19.970
> 
> 标签：python, matplotlib

我是新来的，在 python 和 matplotlib 上也是新的。

我想创建一个代码，允许我从函数定义中获取坐标（event.xdata），以便以后可以使用该数据。但是到目前为止，我已经能够阅读，一些变量是局部变量（函数内部的变量），而其他变量是全局变量（我们想要“稍后”使用的变量）。我尝试使用我也读过的“全局”选项不是最好的，但它没有用......解决方案当然可能是从定义的拾取函数返回值......问题是我必须创建一个从函数接收返回的变量...但由于这是一个事件（不是简单的函数），我不能要求变量接收返回，因为它是在绘制绘图后发生的事件。可能应该（？）类似于：

```
import matplotlib.pyplot as plt
import numpy as np

asd = () #<---- i need to create a global variable before i can return a value in it? 
fig = plt.figure()
def on_key(event):
    print('you pressed', event.key, event.xdata, event.ydata)
    N=event.xdata
    return N in asd #<---- i want to return N into asd

cid = fig.canvas.mpl_connect('key_press_event', on_key)
lines, = plt.plot([1,2,3])
NAAN=on_key(event) #<---- just to try if return alone worked... but on_key is a function which happens in the plot event... so no way to take the info from the return
plt.show() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:59:40.887

您可以使用可变对象和闭包来做到这一点：

```
mutable_object = {} 
fig = plt.figure()
def on_key(event):
    print('you pressed', event.key, event.xdata, event.ydata)
    N=event.xdata
    mutable_object['key'] = N 
```

然后，您可以通过

```
N = mutable_object['key'] 
```

使用它，您也可以使用`list`and来执行此操作`append`，或者创建自己的类等。

# xml - 删除emacs中某种类型的所有标签

> ID：15032639
> 
> 赞同：4
> 
> 时间：2013-02-22T20:26:25.087
> 
> 标签：xml, regex, emacs

我有一个 XML 文件。只是读到，我可以告诉你很兴奋。

现在我想完全删除其中的一些标签：

```
<qwerty option=1>
<nmo>sdfsdf</nmo>
<blue>sdfsdf</blue>
</qwerty> 
```

这是一个大文件。我将如何删除所有标签`nmo`和`blue`，包括它们的内容？在 Emacs 或我的 mac 可以使用的任何其他东西中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-22T20:50:27.370

Emacs 有用于导航符号表达式或“sexps”的命令。在`xml-mode`中，sexp 导航命令适用于标签。您可以导航到开头`<`，按`C-M-f`( `forward-sexp`) 导航到标签末尾，或按`C-M-k`( `kill-sexp`) 将其终止。该变量`nxml-sexp-element-flag`控制您是走到开始标签的末尾（默认）还是结束标签的末尾。我更喜欢后者。

要删除这些标签，首先`nxml-sexp-element-flag`使用`M-x customize-variable nxml-sexp-element-flag`. 接下来，搜索您要删除的标签，将点移到开头`<`并按`C-M-k`。将这一切包装在一个宏中，并在整个文件中重复，直到搜索失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T20:54:34.203

我假设您的 xml 文件格式正确。而且我还假设与您的示例相反，您的“真实”数据比每行一个标签（根标签除外）要复杂一些。否则我们是否同意它就像删除包含给定标签的行一样简单？

这是一个可以解决问题的函数的命题：

```
(defun my-remove-tag (tag)
  (save-excursion
     (let ((case-fold-search nil))
       (while (search-forward-regexp (concat "<" tag "[^\\>]*>"))
     (delete-region
      (match-beginning 0)
      (search-forward (concat "</" tag ">"))))))) 
```

调用此函数，您可能会查找或标签，如下`nmo`所示：`blue``qwerty`

```
(my-remove-tag "nmo")
(my-remove-tag "qwerty") 
```

The rationale is looking for a opening tag then look for the closing one, and delete everything in the middle. Attributes for a tag could go in the middle of the way, and this function deal with opening tag containing attributes.

The case sensitiveness is disabled and restored once the function is done. Also the Emacs Point is restored with the usual macro : `save-excusion`.

## Update

I removed the outer let. No need to restore the case-fold-search value by hand, the let binding simply shadows the global value, it is restored by by means of "unshadowing".

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-22T22:18:30.300

I believe that a more generic approach would be to use some more XML-oriented tool, like XSL(T) (don't be afraid, no one likes that), but it can come in handy if you have to work with XML (don't be afraid, no one likes that either).

So, here we go:

This is your XSL file (it copies all the stuff in the original XML and replaces the nodes you wanted to remove with empty lines. Finally, it prints it out, making it look somewhat prettier, then if you have it replaced using a regexp.

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:msxsl="urn:schemas-microsoft-com:xslt"
                exclude-result-prefixes="msxsl"
                >
  <xsl:output method="xml" indent="yes"/>
  <xsl:strip-space elements="*"/> 

  <!-- Copy everything -->
  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <!-- Find any node named nmo or blue and replace it with nothing -->
  <xsl:template match="nmo | blue"/>
</xsl:stylesheet> 
```

This is my example I used to test:

```
<?xml version="1.0" encoding="utf-8"?>
<nodes>
  <qwerty option="1">
    <nmo>sdfsdf</nmo>
    <blue>sdfsdf</blue>
  </qwerty>
  <nodes>
    <qwerty option="1">
      <nmo>sdfsdf</nmo>
      <blue>sdfsdf</blue>
    </qwerty>
  </nodes>
  <nodes>
    <qwerty option="1">
      <nmo>sdfsdf</nmo>
      <blue>sdfsdf</blue>
    </qwerty>
    <other node=""/>
    <nodes>
      <qwerty option="1">
        <nmo>sdfsdf</nmo>
        <blue>sdfsdf</blue>
      </qwerty>
      <qwerty option="1">
        <nmo>sdfsdf</nmo>
        <blue>sdfsdf</blue>
      </qwerty>
      <qwerty option="1">
        <nmo>sdfsdf</nmo>
        <blue>sdfsdf</blue>
      </qwerty>
    </nodes>
  </nodes>
</nodes> 
```

And this is the output I'm receiving:

```
<?xml version="1.0"?>
<nodes>
  <qwerty option="1"/>
  <nodes>
    <qwerty option="1"/>
  </nodes>
  <nodes>
    <qwerty option="1"/>
    <other node=""/>
    <nodes>
      <qwerty option="1"/>
      <qwerty option="1"/>
      <qwerty option="1"/>
    </nodes>
  </nodes>
</nodes> 
```

Notice how it also closed the `qwerty` nodes.

The command line to get this would be something like:

```
xsltproc ./remove-nodes.xsl ./nodes-to-be-removed.xml > result.xml 
```

You could run it from Emacs' shell, or use any of Emacs' function to call it / create a process with it and so on. `man xsltproc` for more info - it's usage is really basic. It was installed on my Fedora, but I would imagine that due to widespread of XML around the world it would either be already installed on a Mac, or must be installable in some way.

# mysql - 当 WHERE 中有变量时，Mysql 查询不使用索引

> ID：15032641
> 
> 赞同：11
> 
> 时间：2013-02-22T20:26:38.757
> 
> 标签：mysql

我有这张桌子：

```
CREATE TABLE `ClientesHora_copy` (
`dia` varchar(6) default NULL,
`hora` varchar(2) default NULL,
`sit` varchar(17) default NULL,
`nodo` varchar(6) default NULL,
`clientes` decimal(41,0) default NULL,
`segundos` double default NULL,
`llamadas` decimal(41,0) default NULL,
`fecha` datetime default NULL,
KEY `nodo_fecha` (`nodo`,`fecha`),
KEY `nodo` (`nodo`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

这个查询：

```
SET @sitio= 'ABA000';
SET @horaini='2013-02-12 15:18:00';
SET @horafin='2013-02-12 20:36:00';     
    EXPLAIN SELECT nodo,sit,clientes,segundos,llamadas,fecha,hora,@horaini AS  horaini,@horafin AS horafin
        FROM `ClientesHora_copy`
        WHERE 
        nodo =@sitio
        AND
        fecha BETWEEN DATE_SUB(DATE_FORMAT(@horaini, "%Y-%m-%d %H:00:00"), INTERVAL 7 DAY)
            AND DATE_SUB(DATE_FORMAT(@horafin, "%Y-%m-%d %H:00:00"), INTERVAL 7 DAY) 
```

我有这个解释

```
id  select_type  table               type    possible_keys  key     key_len  ref        rows  Extra        
------  -----------  -----------------  ------  -------------  ------  -------  ------  -------  -------------
 1  SIMPLE       ClientesHora_copy  ALL     (NULL)         (NULL)  (NULL)   (NULL)  2716460  Using where 
```

但如果我不使用@sitio 变量（但使用@horaini、@horafin 变量）：

```
EXPLAIN SELECT nodo,sit,clientes,segundos,llamadas,fecha,hora,@horaini AS  horaini,@horafin AS horafin
        FROM `ClientesHora_copy`
        WHERE 
        nodo ='ABA000'
        AND
        fecha BETWEEN DATE_SUB(DATE_FORMAT(@horaini, "%Y-%m-%d %H:00:00"), INTERVAL 7 DAY)
            AND DATE_SUB(DATE_FORMAT(@horafin, "%Y-%m-%d %H:00:00"), INTERVAL 7 DAY) 
```

我明白了：

```
id  select_type      table                type    possible_keys    key         key_len  ref       rows  Extra  
------  -----------  -----------------  ------  ---------------  ----------  -------  ------  ------  -------------
 1  SIMPLE            ClientesHora_copy  range   nodo_fecha,nodo  nodo_fecha  18       (NULL)       1  Using where 
```

知道为什么 Mysql 不使用带有 @sitio 变量的索引，而是使用 @fechaini 和 @fechafin 吗？

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-22T20:42:53.430

最可能的解释是该列`nodo`是字符数据类型，并且`character_set_connection`与为该列指定的字符集不匹配。

如果该列是用`latin1`字符集定义的，请尝试：

```
WHERE nodo = CONVERT(@sitio USING latin1) 
```

* * *

作为演示，使用 utf8，解释输出显示没有可用的索引：

```
EXPLAIN SELECT t.* FROM mytable t WHERE t.foo = CONVERT(@foo USING utf8)
                                                                  ^^^^
id select_type table type possible_keys key    key_len ref    rows Extra        
-- ----------- ----- ---- ------------- ------ ------- ------ ---- -----------
 1 SIMPLE      t     ALL  (NULL)        (NULL) (NULL)  (NULL)    3 Using where 
```

但是对于 latin1，解释输出显示索引可用（并且已使用）：

```
EXPLAIN SELECT t.* FROM mytable t WHERE t.foo = CONVERT(@foo USING latin1)
                                                                  ^^^^^^    
id select_type table type possible_keys key    key_len ref    rows Extra        
-- ----------- ----- ---- ------------- ------ ------- ------ ---- -----------
 1  SIMPLE     t     ref  t_ix          t_ix   13      const     1 Using where 
```

# html - 垂直对齐 css3。尝试了其他一切

> ID：15032642
> 
> 赞同：0
> 
> 时间：2013-02-22T20:26:41.177
> 
> 标签：html, css, vertical-alignment

我正在尝试垂直对齐`<a>`导航 div 中的 '，但由于某种原因无法正常工作。我已经检查过没有其他样式覆盖我的代码，以及几种定位组合。

```
<div id="logodiv">
    <figure>
        <img id="logo" src="/images/Capture2.jpg" alt="logo" />
    </figure>
    <nav id="flexbox">
        <div class="menudiv"><a class="menua" href="gallery.html">Gallery</a></div>
        <div class="menudiv"><a class="menua" href="events.html">Events</a></div>
        <div class="menudiv"><a class="menua" href="default.html">Home</a></div>
        <div class="menudiv"><a class="menua" href="membership.html">Info</a></div>
        <div class="menudiv"><a class="menua" href="contactus.html">Contact</a></div>
    </nav>
</div> 
```

**CSS**

```
#logodiv {
    width:100%;
    height:100px;
    position:relative;
    display:block;

}

#flexbox{
    background-color:#f5b00e;
    float:right;
    width:65%;
    min-width:400px;
    height:30px;
    padding:0;
    margin:0;
    white-space:nowrap;
    margin-bottom:0px;
    position:absolute;
    right:0px;
    bottom:0px;
    display:inline;
}

.menudiv{
    width:20%;
    height:100%;
    line-height:100%;
    display:inline;
    float:left;
    margin:0 auto;
    padding:0;
    vertical-align:middle;
    position:relative;
}

.menua{
    line-height:100%;
    height:100%;
    font-family: font, Arial, sans-serif;
    font-size:15pt;
    text-decoration:none;
    text-shadow:none;
    margin-top:10px;
    vertical-align:bottom;
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:33:26.277

**检查它** [http://jsfiddle.net/mKbLW/1/](http://jsfiddle.net/mKbLW/1/)

改变了你的一些价值观。有一些不需要的 CSS 规则。

```
#logodiv {
    width:100%;
    height:100px;
    position:relative;
    display:block;

}

#flexbox{
    background-color:#f5b00e;
    float:right;
    width:65%;
    min-width:400px;
    height:30px;
    padding:0;
    margin:0;
    white-space:nowrap;
    margin-bottom:0px;
    position:absolute;
    right:0px;
    bottom:0px;
    display:inline;
}

.menudiv{
    width:20%;
    height:100%;
    float:left;
    padding:0;
    position:relative;
}

.menua {
    height:100%;
    line-height:30px;
    display:inline;
    font-family: font, Arial, sans-serif;
    font-size:15pt;
    text-decoration:none;
    text-shadow:none;
    margin-top:10px;
} 
```

# c# - 从流程标准输出中获取值

> ID：15032643
> 
> 赞同：2
> 
> 时间：2013-02-22T20:26:43.260
> 
> 标签：c#, wpf, .net-4.0

我正在尝试获取输出以显示我机器上当前打开的文档，但无论如何它都会返回 NULL。

```
StringCollection values = new StringCollection();
var proc = new Process
{
     StartInfo = new ProcessStartInfo
     {
          FileName = "openfiles.exe",
          Arguments = "/query /FO CSV /v",
          UseShellExecute = false,
          RedirectStandardOutput = true,
          CreateNoWindow = true
     }
};
proc.Start();
while (!proc.StandardOutput.EndOfStream)
{
     string line = proc.StandardOutput.ReadLine();
     values.Add(line);
}
foreach (string sline in values)
MessageBox.Show(sline); 
```

**编辑：**

在进一步审查期间，我发现我遇到了异常问题。在我的诊断运行期间，我得到以下信息： Proc.BasePriority thre 类型为 System.InvalidOperationException 的异常

**编辑：**

尝试将代码提取为：

```
string val = proc.StandardOutput.ReadToEnd();
MessageBox.Show(val); 
```

返回时也是一个 NULL 值，即使在 proc.start(); 之后，Proc 仍然有错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T20:51:52.993

您必须同时阅读标准输出和标准错误流。这是因为您不能从同一个线程中读取它们。

为此，您必须使用将在单独线程上调用的[事件处理程序。](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.outputdatareceived.aspx)

`anycpu`按照`openfiles`32 位和 64 位变体的形式编译代码。如果体系结构不匹配，它可能找不到可执行文件。

从错误流中读取的行前面带有 ! > 所以他们在输出中脱颖而出。

```
 StringCollection values = new StringCollection();
    var proc = new Process
    {
        StartInfo = new ProcessStartInfo
        {
            FileName = "openfiles.exe",
            Arguments = "/query /FO CSV /v",
            UseShellExecute = false,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            CreateNoWindow = false
        }
    };
    proc.Start();

    proc.OutputDataReceived += (s,e) => {
        lock (values)
        {
            values.Add(e.Data);
        }
    };
    proc.ErrorDataReceived += (s,e) => {
        lock (values)
        {
            values.Add("! > " + e.Data);
        }
    };

    proc.BeginErrorReadLine();
    proc.BeginOutputReadLine();

    proc.WaitForExit();
    foreach (string sline in values)
        MessageBox.Show(sline); 
```

# android - Android附加调试器而不运行应用程序

> ID：15032644
> 
> 赞同：7
> 
> 时间：2013-02-22T20:26:43.560
> 
> 标签：android, eclipse, ddms

我继承了一些仅在应用程序未运行时导入文件时出现问题的代码。我想看看是否有办法在应用程序运行之前连接/监控应用程序并能够单步执行代码。

问题仅在导入启动应用程序时出现。我看到我可以使用 DDMS 来调试 logcat 和堆，但我需要能够使用调试器单步执行代码......至少我认为我会这样做。

![在此处输入图像描述](../Images/ae66187c7a989d906c39c92f3c539a8e.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-08-19T12:34:55.950

在几个最新的 API 版本（至少 21+）中，您可以找到：

```
Settings -> Developer options -> Wait for debugger. 
```

它可以帮助您在调试应用程序启动期间停止调试器

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T21:04:58.757

应用程序运行后，您可以转到 DDMS 进程并单击错误图标。如果您需要在早期代码运行之前立即执行此操作，您可以在该代码之前休眠，以便您有机会开始调试您的进程。但是，如果这听起来太麻烦，那么日志记录可能是一个更好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-11T06:49:28.153

`Shift+F9`应该以调试模式启动，这将在运行之前附加调试器。或者，`Run -> Debug '[app name]'`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-12-13T22:50:49.143

对于 android studio，您可以通过单击此图标并选择正确的进程来附加调试器。

[![将调试器附加到android](../Images/b9cf7b1a78998d8870c62d94f1d68a90.png)](https://i.stack.imgur.com/gtinR.png)

# ruby - Ruby中的“！=”和“！〜”之间有什么区别吗？

> ID：15032650
> 
> 赞同：2
> 
> 时间：2013-02-22T20:26:59.970
> 
> 标签：ruby

我试图在下面的代码中`!~`与操作员一起玩。`!=`但想不出有什么区别。但我有疑问，如果不是这样，为什么 Ruby 会引入它们？

```
 2 !=3
# => true
 2 !~ 3
# => true
 c= [1,2,3]
# => [1, 2, 3]
 d=[1,4,5]
# => [1, 4, 5]
 c != d
# => true
 c !~ d
# => true 
```

任何人都可以在这里帮助我说他们之间是否有任何区别吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T20:31:46.580

[`=~`运算符](http://ruby-doc.org/core-1.9.3/Object.html#method-i-3D-7E)及其否定`!~`用于模式匹配[。](http://ruby-doc.org/core-1.9.3/Object.html#method-i-3D-7E)它被[Regexp](http://www.ruby-doc.org/core-1.9.3/Regexp.html#method-i-3D-7E)和[String](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-3D-7E)覆盖以提供正则表达式模式匹配，但对于数字，它没有实现。这就是为什么`2 =~ 3`给`nil`，所以`2 !~ 3`是`true`。

# perl - Perl - 字符串中正则表达式匹配的位置

> ID：15032651
> 
> 赞同：3
> 
> 时间：2013-02-22T20:27:04.620
> 
> 标签：perl, regex

```
if (my @matches = $input_string =~ /$metadata[$_]{"pattern"}/g) {
  print $-[1] . "\n"; # this gives me error uninitialized ...
} 
```

`print scalar @matches;`给了我 4，没关系，但如果我`$-[1]`用来开始第一场比赛，它给了我错误。问题出在哪里？

EDIT1：如何获取字符串中每个匹配项的位置？如果我有字符串“ahoj ahoj ahoj”和正则表达式/ahoj/g，我如何获得字符串中每个“ahoj”的开始和结束位置？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:37:37.543

该数组`@-`包含最后一次成功匹配的开始偏移量（in `$-[0]`）以及该匹配中可能存在的任何捕获的偏移量（in`$-[1]`等`$-[2]`）。

您的字符串中没有捕获，因此只有`$-[0]`有效，并且（在您的情况下）最后一次成功匹配是第四个，因此它将包含模式的第四个实例的偏移量。

获得单个匹配的偏移量的方法是写

```
my @matches;
while ("ahoj ahoj ahoj" =~ /(ahoj)/g) {
  push @matches, $1;
  print $-[0], "\n";
} 
```

**输出**

```
0
5
10 
```

或者，如果您不想要单个匹配的字符串，那么

```
my @matches;
push @matches, $-[0] while "ahoj ahoj ahoj" =~ /ahoj/g; 
```

# c# - 在依赖类型“Bd.Domain.Entities.FootballGame”上找不到导航属性“FootballGame”

> ID：15032656
> 
> 赞同：7
> 
> 时间：2013-02-22T20:27:23.700
> 
> 标签：c#, entity-framework, ef-code-first

我正在创建我的第一个 asp.net mvc3 应用程序。我正在使用代码优先方法。我有以下型号：

```
public class FootballGame
{
    [Key]
    public Guid id_FootballGame { get; set; }

    [ForeignKey("FootballGame")]
    public Guid? FK_id_FootballGame { get; set; }
    public virtual FootballGame PreviousFootballGame { get; set; }

    [ForeignKey("FootballTeam")]
    public Guid id_FootballTeam_owner { get; set; }
    public virtual FootballTeam FootballTeamOwner { get; set; }

    [ForeignKey("FootballTeam")]
    public Guid id_FootballTeam_guest { get; set; }
    public virtual FootballTeam FootballTeamGuest { get; set; }
}

public class FootballTeam
{
    [Key]
    public Guid id_FootballTeam { get; set; }
    public string teamName { get; set; }
} 
```

我有以下课程：

```
public class EFDbContext : DbContext
{
    public EFDbContext() : base("name=EFDbContext") { }

    public DbSet<FootballTeam> FootballTeams { get; set; }
    public DbSet<FootballGame> FootballGames { get; set; }
} 
```

不幸的是，有一个例外：

> 类型“Bd.Domain.FootballGame”的属性“FK_id_FootballGame”上的 ForeignKeyAttribute 无效。在依赖类型“Bd.Domain.FootballGame”上找不到导航属性“FootballGame”。Name 值应该是有效的导航属性名称。

我试图删除这些行：

```
[ForeignKey("FootballGame")]
public virtual FootballGame PreviousFootballGame { get; set; } 
```

但是，出现另一个例外：

> 类型“Bd.FootballGame”的属性“id_FootballTeam_owner”上的 ForeignKeyAttribute 无效。在依赖类型“Bd.FootballGame”上找不到导航属性“FootballTeam”。Name 值应该是有效的导航属性名称。

我期待任何帮助。问候，丹尼斯。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-22T20:40:36.450

试试这个：

```
public class FootballGame
{
    [Key]
    public Guid id_FootballGame { get; set; }

    public Guid? FK_id_FootballGame { get; set; }
    [ForeignKey("FK_id_FootballGame")]
    public virtual FootballGame PreviousFootballGame { get; set; }

    public Guid id_FootballTeam_owner { get; set; }
    [ForeignKey("id_FootballTeam_owner")]
    public virtual FootballTeam FootballTeamOwner { get; set; }

    public Guid id_FootballTeam_guest { get; set; }
    [ForeignKey("id_FootballTeam_guest")]
    public virtual FootballTeam FootballTeamGuest { get; set; }
} 
```

# git - Team Foundation Service + Git 本地构建控制器

> ID：15032659
> 
> 赞同：2
> 
> 时间：2013-02-22T20:27:33.590
> 
> 标签：git, tfs, tfsbuild

我目前有一个 Team Foundation Service Git 存储库。

尝试使用 TFS2012 本地构建控制器时，我收到以下错误：

```
TF215097: An error occurred while initializing a build for build definition CI Check-In: 
Exception Message: Cannot create unknown type '{clr-namespace:Microsoft.TeamFoundation.Build.Activities.Core;assembly=Microsoft.TeamFoundation.Build.Activities}SetBuildNumber'. (type XamlObjectWriterException)
Exception Stack Trace:    at System.Xaml.XamlObjectWriter.WriteStartObject(XamlType xamlType)
   at System.Xaml.XamlServices.Transform(XamlReader xamlReader, XamlWriter xamlWriter, Boolean closeWriter)
   at System.Activities.XamlIntegration.FuncFactory`1.Evaluate()
   at System.Activities.DynamicActivity.OnInternalCacheMetadata(Boolean createEmptyBindings)
   at System.Activities.Activity.InternalCacheMetadata(Boolean createEmptyBindings, IList`1& validationErrors)
   at System.Activities.ActivityUtilities.ProcessActivity(ChildActivity childActivity, ChildActivity& nextActivity, Stack`1& activitiesRemaining, ActivityCallStack parentChain, IList`1& validationErrors, ProcessActivityTreeOptions options, ProcessActivityCallback callback)
   at System.Activities.ActivityUtilities.ProcessActivityTreeCore(ChildActivity currentActivity, ActivityCallStack parentChain, ProcessActivityTreeOptions options, ProcessActivityCallback callback, IList`1& validationErrors)
   at System.Activities.ActivityUtilities.CacheRootMetadata(Activity activity, LocationReferenceEnvironment hostEnvironment, ProcessActivityTreeOptions options, ProcessActivityCallback callback, IList`1& validationErrors)
   at System.Activities.Validation.ActivityValidationServices.InternalActivityValidationServices.InternalValidate()
   at Microsoft.TeamFoundation.Build.Workflow.WorkflowHelpers.ValidateWorkflow(Activity activity, ValidationSettings validationSettings)
   at Microsoft.TeamFoundation.Build.Hosting.BuildProcessCache.LoadFromXaml(String workflowXaml, TextExpressionImports textExpressionImports)
   at Microsoft.TeamFoundation.Build.Hosting.BuildControllerWorkflowManager.PrepareRequestForBuild(IBuildDetail build, WorkflowRequest request, IDictionary`2 dataContext)
   at Microsoft.TeamFoundation.Build.Hosting.BuildWorkflowManager.TryStartWorkflow(WorkflowRequest request, WorkflowManagerActivity activity, BuildWorkflowInstance& workflowInstance, Exception& error, Boolean& syncLockTaken) 
```

使用托管控制器时，一切正常。我的本地构建控制器似乎无法解析 Microsoft.TeamFoundation.Build.Activties.Core。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T11:11:04.253

更新 2 中附带的构建控制器版本不知道如何与 Git 存储库通信，但恐怕。这是因为 Team Build 中对基于 Git 的团队项目的支持仍在开发中。安装在托管构建控制器中的构建控制器版本支持它，因此您目前必须使用托管构建服务器来针对 tfs.visualstudio.com 进行 Git 构建。

当 Visual Studio 和 Team Foundation Server 的框中还提供 Git 支持时，该计划是让构建控制器支持 Git - 即 VS/TFS 的下一个主要版本。

# c# - 用 utf8 字符替换内部字符串后无法写入 rtf 文件

> ID：15032664
> 
> 赞同：0
> 
> 时间：2013-02-22T20:28:02.923
> 
> 标签：c#, rtf

我有一个 rtf 文件，我必须在其中用某些语言特定字符 (UTF8) 进行一些文本替换。替换后，我尝试保存到新的 rtf 文件，但字符设置不正确（奇怪的字符），或者文件保存有所有 rtf 原始代码和所有格式。这是我的代码：

```
var fs = new FileStream(@"F:\projects\projects\RtfEditor\Test.rtf", FileMode.Open, FileAccess.Read);
//reads the file in a byte[]
var sb = FileWorker.ReadToEnd(fs);
var enc = Encoding.GetEncoding(1250);
//var enc = Encoding.UTF8;
var sbs = enc.GetString(sb);
var sbsNew = sbs.Replace("#test/#", "ă î â șșțț");
//first writting aproach
var fsw = new FileStream(@"F:\projects\projects\RtfEditor\diac.rtf", FileMode.Create, FileAccess.Write);                                     
fsw.Write(enc.GetBytes(sbsNew), 0, enc.GetBytes(sbsNew).Length);
fsw.Flush();
fsw.Close(); 
```

在这种方法中，结果文件是正确的，但字符“șșțț”显示为“????”。

```
//second writing aproach
using (StreamWriter sw = new StreamWriter(fsw, Encoding.UTF8))
{
    sw.Write(sbsNew);
    sw.Flush();
} 
```

在这种方法中，结果文件是一个 rtf 文件，但所有 rtf 原始代码和格式以及特殊字符都被正确保存（șșțț 显示正确，没有更多????）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:34:44.917

RTF 文件只能直接包含 7 位字符。其他所有内容都需要编码为转义序列。更详细的信息可以在例如[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Rich_Text_Format)中找到。

# jquery - ASP.net MVC 4，友好的 url 和中文

> ID：15032665
> 
> 赞同：1
> 
> 时间：2013-02-22T20:28:02.760
> 
> 标签：jquery, asp.net-mvc-4, friendly-url, chinese-locale, myprettycms

我使用friend url jquery 插件（[http://www.bulgaria-web-developers.com/projects/javascript/friendurl/](http://www.bulgaria-web-developers.com/projects/javascript/friendurl/)）来创建我的菜单编辑器。
![我漂亮的 cms 菜单编辑器（2 种语言模式）](../Images/3c9e420c90385e22a55b5b4e003d9d3b.png)

我的妻子是中国人，我让她输入中文文本以尝试我的菜单是否有效。

可以输入和保存中文字符，但我意识到我无法创建中文友好的 url。

你能告诉我中国网站管理员如何处理**友好的网址**和**中文文本**吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:30:06.930

您可以使用带有 Punycode 的基本 ASCII 字符将任何 Unicode URL 转换为等效 URL

[http://en.wikipedia.org/wiki/Punycode](http://en.wikipedia.org/wiki/Punycode)

可以在 URL 栏中输入 Punycode，并将其解析为原始 Unicode URL。

# java - Java 的语言集成查询 (LINQ)

> ID：15032670
> 
> 赞同：6
> 
> 时间：2013-02-22T20:28:25.963
> 
> 标签：java, linq, java-8

我在 SO 上发现了几个关于 LINQ for Java 的问题，例如

*   [LINQ for Java 工具](https://stackoverflow.com/q/346721/1944131)
*   [有没有类似 LINQ for Java 的东西？](https://stackoverflow.com/q/2008149/1944131)

但是，这些问题是在 2008 年至 2010 年左右提出的。当时 Java 语言不支持必要的语言功能，如 lambda 表达式（根据[Jon Skeet 的回答](https://stackoverflow.com/a/346735/1944131)）。

现在Java8即将出现，并且可能会提供Lambda Expressions等功能，您认为是否有可能很快有一个LINQ for Java实现/项目？

您是否听说过任何试图填补 Java 和 C# 之间差距的项目？

# c++ - Qt MOC 生成代码文档

> ID：15032686
> 
> 赞同：0
> 
> 时间：2013-02-22T20:29:15.037
> 
> 标签：c++, qt, moc

我正在 Qt 中设计一个用户界面，出于长寿的原因，我不想在未来的构建中使用 Qt Meta-Object Compiler。我知道 MOC 会解析标准 C++ 代码中的某些宏，并根据这些宏生成 C++ 代码。

我想知道的是：这个生成的代码的文档在哪里？我想将生成的代码直接写到我的相关类中。虽然现在这可能很麻烦，但如果 Qt 消失并且 MOC 不复存在，它将避免任何问题，从而使 UI 在长期内更加稳定。

谢谢！

**编辑 1：** 我正在 Visual Studio（不是 Qt Creator）中为不基于 Qt 框架的 C++ 应用程序设计基于 Qt 的 UI。我希望能够分发可以构建为纯 C++ 的代码，其中 Qt 代码链接自将被打包的特定库。我希望能够在未安装 Qt 的系统上构建此代码。因此希望避免 MOC。我不想冒犯任何 Qt 粉丝，Qt 很棒。但是，我在这个项目上需要一些不同的东西，所以“只使用 MOC”的建议根本没有帮助。

**编辑2：**当我错了时，我有足够的能力承认。经过更多的思考和研究，显然不值得尝试我计划做的事情。我只需要保存 MOC 生成的代码并分发它。谢谢大家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T22:28:35.157

将 moc 输出逐字放入您的代码中会使您的代码不那么可移植，而不是更多，因为 moc 输出格式比源不兼容的 Qt 主要版本（当前版本 5）更频繁地更改（当前版本 67）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T00:36:55.707

正如这里的每个人都向我指出的那样，试图绕过 MOC 似乎总体上是不值得的。我的解决方案是将 MOC 生成的源文件保存在源代码管理中，并将它们与主要应用程序代码一起打包以进行分发。

# wpf - 当命令 CanExecute 为 false 时，按钮不会被禁用

> ID：15032689
> 
> 赞同：10
> 
> 时间：2013-02-22T20:29:24.110
> 
> 标签：wpf, mvvm, command, prism

我有一个简单的窗口，带有一个按钮，它通过命令绑定到 ViewModel。

如果 MyCommand.CanExecute() 为假，我希望该按钮被禁用。但似乎 WPF 只会在第一次绘制窗口时设置 IsEnabled 属性。任何后续操作都不会影响按钮的可见状态。我正在使用 Prism 的 DelegateCommand。

我的观点：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <Button Content="Click Here" Command="{Binding MyCommand}" Width="100" Height="50"/>
</Grid> 
```

和我的视图模型：

```
public class MyVM : NotificationObject
{
    public MyVM()
    {
        _myCommand = new DelegateCommand(DoStuff, CanDoStuff);
    }

    private void DoStuff()
    {
        Console.WriteLine("Command Executed");
        _myCommand.RaiseCanExecuteChanged();
    }

    private bool CanDoStuff()
    {
        var result =  DateTime.Now.Second % 2 == 0;
        Console.WriteLine("CanExecute is {0}", result);
        return result;
    }

    private DelegateCommand _myCommand;

    public ICommand MyCommand
    {
        get
        {
            return _myCommand;
        }
    }
} 
```

50% 的时间，当我的应用程序加载时，该按钮被正确禁用。但是，如果它在窗口加载时启用，并且我单击按钮执行命令，我预计 50% 的时间按钮会被禁用，但它永远不会。该命令不执行，但我仍然可以单击该按钮。如何让 WPF 了解当 CanExecute() 为 false 时应禁用该按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T22:40:38.263

我看到您正在使用 Prism 及其`NotificationObject`and `DelegateCommand`，所以我们应该期望 RaiseCanExecuteChanged() 中不会有错误。

但是，该行为的原因是 Prism 的 RaiseCanExecuteChanged 同步运行，因此 `CanDoStuff()`在我们仍在执行时调用，`ICommand.Execute()`结果似乎被忽略了。

如果您使用自己的命令创建另一个按钮并`_myCommand.RaiseCanExecuteChanged()`从该命令/按钮调用，则第一个按钮将按照您的预期启用/禁用。

或者，如果您使用 MVVM Light 和 RelayCommand 尝试相同的操作，您的代码将正常工作，因为 MVVM Light 的`RaiseCanExecuteChanged`调用会调用异步 using`CommandManager.InvalidateRequerySuggested()`的回调，从而避免您在 Prism 的实现中看到的行为。`CanDoStuff``Dispatcher.CurrentDispatcher.BeginInvoke`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-04T16:28:33.373

你可以试试这个（`Microsoft.Practices.Prism.dll`是必要的）

```
public class ViewModel
{
    public DelegateCommand ExportCommand { get; }

    public ViewModel()
    {
        ExportCommand = new DelegateCommand(Export, CanDoExptor);
    }

    private void Export()
    {
        //logic
    }

    private bool _isCanDoExportChecked;

    public bool IsCanDoExportChecked
    {
        get { return _isCanDoExportChecked; }
        set
        {
            if (_isCanDoExportChecked == value) return;

            _isCanDoExportChecked = value;
            ExportCommand.RaiseCanExecuteChanged();
        }
    }

    private bool CanDoExptor()
    {
        return IsCanDoExportChecked;
    }
} 
```

# c++ - 为什么是 std::this_thread 命名空间？

> ID：15032692
> 
> 赞同：4
> 
> 时间：2013-02-22T20:29:42.097
> 
> 标签：c++, c++11, library-design

std::this_thread 命名空间有技术原因吗？为什么这个命名空间的成员没有被实现为 std::thread 类的静态成员？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-22T20:46:37.257

从[原始提案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2184.html)中，无论您是为自己获取还是为子线程获取 a `thread::id`，都拼写了获取方式：`get_id()``thread::id`

> 请注意，`this_thread`当您请求当前线程的 id 与子线程的 id 时，使用命名空间来消除歧义。为了减少界面的概念足迹，此操作的`get_id`名称保持不变。

```
std::thread my_child_thread(f);
typedef std::thread::id ID;

ID my_id = std::this_thread::get_id();  // The current thread's id
ID your_id = my_child_thread.get_id();  // The child   thread's id 
```

因此，`this_thread`命名空间是一种区分两者的可读方式，同时将概念接口保持在最低限度（获取线程 ID 的名称相同）。

这是一个可能的替代设计：

```
struct thread
{
    static int get_id() {return 1;}
    int get_id() const {return 2;}
}; 
```

这种设计的一个缺点是它不能编译：

```
test.cpp:4:9: error: static and non-static member functions with the same parameter types cannot be overloaded
    int get_id() const {return 2;}
        ^
test.cpp:3:16: note: previous declaration is here
    static int get_id() {return 1;}
               ^
1 error generated. 
```

另一种设计会给静态成员一个不同的名称。但是现在界面更大了。最初的提案还以完全相同的方式处理了另一个函数：

```
bool have_i_been_canceled = std::this_thread::cancellation_requested();  // Current thread's cancellation status
bool have_you_been_canceled = my_child_thread.cancellation_requested();  // Child   thread's cancellation status 
```

因此，重用名称很有意义，这样客户就不必学习这么多的名称。`this_thread`如果他们想查询当前线程，他们只需要学习使用命名空间。不幸的是，委员会在标准化过程中取消了线程取消。

# c# - 在 C# 桌面应用程序中显示 Google 图片的有效方法

> ID：15032696
> 
> 赞同：0
> 
> 时间：2013-02-22T20:29:57.027
> 
> 标签：c#, wpf, .net-4.0, google-search-api

所以我正在做一个项目，该项目需要能够调出与所选项目相关的谷歌图像。

现在，我正在使用 Google 自定义搜索 API 进行图像搜索并将结果以 json 格式返回。然后我解析出提供的前五个图像路径，并将它们作为图像添加到包装面板。

这看起来像什么的快速片段

```
 BitmapImage bmi = new BitmapImage(new Uri(url, UriKind.Absolute));
        image.Source = bmi; 
```

问题是这平均需要 20-40 秒。虽然谷歌搜索不到 1。我最初认为这是因为谷歌只是在我下载完整图像时加载缩略图，但我检查了所有大小，没有一个大于 30kb，所有下载都通过网络浏览器。

所以我认为我只是以错误的方式处理这个问题。

什么是加载预览然后允许用户选择一个在本地实际保存的正确方法。

问候。约翰·W。

# python - 使用组合或其他技巧来迭代 3 个不同的数组？

> ID：15032698
> 
> 赞同：0
> 
> 时间：2013-02-22T20:30:01.403
> 
> 标签：python, numpy

考虑我的代码

```
a,b,c = np.loadtxt ('test.dat', dtype='double', unpack=True) 
```

a、b 和 c 是相同的数组长度。

```
for i in range(len(a)):

   q[i] = 3*10**5*c[i]/100
   x[i] = q[i]*math.sin(a)*math.cos(b)
   y[i] = q[i]*math.sin(a)*math.sin(b)
   z[i] = q[i]*math.cos(a) 
```

我试图找到 x,y,z 中 2 个点之间差异的所有组合来迭代这个方程 (xi-xj)+(yi-yj)+(zi-zj) = r

我用这个组合码

```
for combinations in it.combinations(x,2):
   xdist =  (combinations[0] - combinations[1])
for combinations in it.combinations(y,2):
   ydist =  (combinations[0] - combinations[1])
for combinations in it.combinations(z,2):
   zdist =  (combinations[0] - combinations[1])

r = (xdist + ydist +zdist) 
```

对于我拥有的大文件，python 需要很长时间，我想知道是否有更快的方法来获取我的数组 for r，最好使用嵌套循环？

如

```
if i in range(?):
     if j in range(?): 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T22:12:28.793

既然你显然在使用 numpy，那么让我们实际使用 numpy；它会快得多。如果您在使用 numpy 时完全避免 python 循环，并且使用它的向量化数组操作，它几乎总是更快并且通常更容易阅读。

```
a, b, c = np.loadtxt('test.dat', dtype='double', unpack=True)

q = 3e5 * c / 100  # why not just 3e3 * c?
x = q * np.sin(a) * np.cos(b)
y = q * np.sin(a) * np.sin(b)
z = q * np.cos(a) 
```

现在，您的示例代码在此之后并没有做您可能希望它做的事情 - 请注意您`xdist = ...`每次都是怎么说的？您正在覆盖该变量，而不是对它做任何事情。不过，我将假设您想要每对点之间的平方欧几里得距离，并制作一个等于第 th 点和`dists`第th 点之间距离的矩阵。`dists[i, j]``i``j`

简单的方法，如果你有 scipy 可用：

```
# stack the points into a num_pts x 3 matrix
pts = np.hstack([thing.reshape((-1, 1)) for thing in (x, y, z)])

# get squared euclidean distances in a matrix
dists = scipy.spatial.squareform(scipy.spatial.pdist(pts, 'sqeuclidean')) 
```

如果您的列表很大，那么不使用 squareform 会更节省内存，但是它是一种压缩格式，很难找到特定的距离对。

稍微难一点，如果你不能/不想使用 scipy：

```
pts = np.hstack([thing.reshape((-1, 1)) for thing in (x, y, z)])
sqnorms = np.sum(pts ** 2, axis=1)
dists = sqnorms.reshape((-1, 1)) - 2 * np.dot(pts, pts.T) + sqnorms 
```

它基本上实现了公式 (a - b)^2 = a^2 - 2 ab + b^2，但都类似于矢量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:50:03.760

好吧，您的计算的复杂性非常高。此外，如果要将所有`r`值存储在单个列表中，则需要大量内存。通常，您不需要列表，而生成器可能足以满足您想要对值执行的操作。

考虑这段代码：

```
def calculate(x, y, z):
    for xi, xj in combinations(x, 2):
        for yi, yj in combinations(y, 2):
            for zi, zj in combinations(z, 2):
                yield (xi - xj) + (yi - yj) + (zi - zj) 
```

这将返回一个生成器，每次调用生成器的`next()`方法时该生成器只计算一个值。

```
gen = calculate(xrange(10), xrange(10, 20), xrange(20, 30))
gen.next() # returns -3
gen.next() # returns -4 and so on 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:51:01.830

抱歉没有发布完整的解决方案，但您应该避免嵌套调用 range()，因为每次调用它都会创建一个新元组。您最好调用 range() 一次并存储结果，或者改用循环计数器。

例如，而不是：

```
max = 50

for number in range (0, 50):

    doSomething(number) 
```

...你会这样做：

```
max = 50
current = 0

while current < max:

    doSomething(number)
    current += 1 
```

# php - MySql Error: cannot connect to local MySql server through socket '/var/run/mysqld/mysqld.sock' (2)，而其他页面确实连接正确

> ID：15032709
> 
> 赞同：1
> 
> 时间：2013-02-22T20:30:50.987
> 
> 标签：php, mysql, sockets, cakephp, phpmyadmin

我知道这个问题在这个网站上是一个反复出现的问题，但我的问题与以前的问题有点不同。

**问题**

一些页面使用正确的套接字目录，而其他页面尝试通过不正确的套接字目录进行连接，或者这就是我认为问题是基于我收到的错误。

**细节**

主机：example.com

cakePHP 版本：1.3.2（不是我的选择）。

页面的内容来自数据库。

网址：[http ://example.com](http://example.com)

我的网站有 2 个部分：

*   匿名部分
*   会员或管理员的登录部分

匿名部分有效。它访问数据库、添加内容和应有的功能。

**错误**

当我单击主页上“工作链接”下的链接“查看更多..”时发生错误。**应该会弹出一个登录表单**，但我收到错误“无法通过套接字'/var/run/mysqld/mysqld.sock' (2) 连接到本地 MySql 服务器”。

此外，在我通过主页上的“会员登录”按钮登录后，使用正确的凭据，它也会产生同样的错误。

**问题**

为什么我网页上的不同部分会尝试通过不同的目录访问套接字？

**额外的东西**

我今天注册了，这是我的第一篇文章，所以对我的帖子提供足够信息的反馈将对以后的帖子有所帮助。

谢谢你的时间。

**更新**

经过进一步研究，MySql 从一开始就一直使用套接字目录 /var/run/mysqld/mysqld.sock。不确定这意味着什么，但继续研究..

**数据库.php 文件**

类 DATABASE_CONFIG {

```
var $default = array(
    'driver' => 'mysqli',
    'persistent' => true,
    'host' => 'redlabelcom.netfirmsmysql.com',
    'login' => 'bcp',
    'password' => '********',
    'database' => 'bcp',
    'prefix' => '',
    'encoding' => 'UTF8',
    //'socket' => '/var/run/mysqld/mysqld.sock', // I've tried commenting out all variations of socket and port
    //'port' => '/var/run/mysqld/mysqld.sock',   // nothing works.
);

var $test = array(
    'driver' => 'mysqli',
    'persistent' => false,
    'host' => 'redlabelcom.netfirmsmysql.com',
    'login' => 'bcp',
    'password' => '********',
    'database' => 'bcp',
    'prefix' => '',
    'encoding' => 'UTF8',
    //'port' => '/var/run/mysqld/mysqld.sock',
); 
```

} ?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:54:07.627

这个问题真的很奇怪。我想这与mysql连接有关。MySQL 是一个守护进程，通常配置在 /etc/mysql/my.cnf 中。在那里您定义客户端将如何连接 MySQL 服务器：

```
[client]
port            = 3306
socket          = /var/run/mysqld/mysqld.sock 
```

如果您的套接字错误（服务器上没有这样的套接字），您可能正在从应用程序的匿名/安全部分连接不同的 mysql 主机/端口。这是可能的（我的意思是来自不同应用程序部分的不同数据库连接）。检查您的配置（主机、端口等）并尝试从 MySQL 控制台连接：

```
$ mysql -h hostname -u username -p dbname # enter password 
```

并检查是否可以连接。如果您可以从控制台连接，那么您肯定会从任何服务器端应用程序（php、python 等）进行连接。

这是别人正在开发的应用程序，对吧，现在你必须维护它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T08:48:26.260

**问题解决了！**

感谢大家的支持！

这是一个有趣的问题，最初看起来比实际问题更复杂。

如果您需要访问 phpbb 数据字段，cakephp 版本 1.3.2 设置为与数据库建立新连接。新连接使用与 database.php 文件中设置的配置不同的配置。

以下是文件位置的详细说明。

**'app/webroot/discussion/common.php'**文件使用与 database.php 文件不同的一组 MySql 参数与数据库建立新连接。同样，它不使用 database.php 的 MySql 配置。

相反，cakephp 定义了位于以下位置的新连接变量： **'app/webroot/discussion/config.php'**

要解决问题，只需更改

$dbhost => 本地主机 -> $dbhost => 你的服务器名

$dbname => 错误名称 -> $dbname => 正确名称

ETC..

请记住，以前的开发人员可能更改了这些值，所以如果这对您没有帮助，那么祝您好运。

顺便说一句，上面的错误消息是尝试连接到 localhost 的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-19T06:21:46.697

为了解决这个问题，我运行了以下命令：

mysqld --tc-heuristic-recover=ROLLBACK

systemctl 启动 mariadb.service

# sql - 如何从表中删除重复行但保留它们的不同之处？

> ID：15032714
> 
> 赞同：0
> 
> 时间：2013-02-22T20:31:23.133
> 
> 标签：sql, tsql, rank

抓住的是，整行都是一样的。

桌子：

```
Hello
Hello
Hello
Bye
Bye
Good Morning
Good Morning 
```

我想离开：

```
Hello
Bye
Good Morning 
```

我知道你可以在这里使用 RANK() 但我从未真正使用过它，所以我不太确定。

谁能帮我一把？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-22T20:33:01.240

您可以使用`row_number()`然后从表中删除行号不为 1 的所有内容：

```
;with cte as
(
  select col,
    row_number() over(partition by col order by col) rn
  from yourtable
)
delete 
from cte 
where rn > 1; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/2deb1/1)

# python - 远程编写 SQLite 数据库

> ID：15032721
> 
> 赞同：0
> 
> 时间：2013-02-22T20:32:19.217
> 
> 标签：python, sqlite, paramiko

我正在寻找一种方法来从 SQLite 数据库中获取结果，选择部分模式，并通过 paramiko 在远程机器上重新创建它，而无需本地文件或任何形式的远程文件（不是纯 SQLite 数据库）的中间步骤.

这篇博文设置了一个很好的方法来获取我想要的部分模式，但我必须将它转储到一个文件中，然后通过远程脚本将其读入数据库：

[http://blog.marcus-brinkmann.de/2010/08/27/how-to-use-sqlites-backup-in-python/](http://blog.marcus-brinkmann.de/2010/08/27/how-to-use-sqlites-backup-in-python/)

我知道 paramiko 可以提供像这样的对象的远程文件：

```
f = self.sftp.open(path, 'wb')
f.write(fileobj.read())
f.close() 
```

有没有办法将某些文件对象、StringIO 或字节转换与 SQLite DB API 结合起来，以便提供一种流式传输预构建 SQLite 数据库的方法，而无需在主机或远程上进行额外的文件写入？

换句话说，像这样：

```
f = self.sftp.open(path, 'wb')
conn = sqlite3.connection(f) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:43:17.653

不能直接解决您的问题，但这就是 web api 的用途。构建一个类似 REST 的 api 可能是一个不错的选择。

由于您已经在 python 中，我会看看[Django ，它可以使用](https://www.djangoproject.com/)[django-tastypie](http://django-tastypie.readthedocs.org/en/latest/)提供一个 drop-ship API 。 [如果您使用已经存在的数据库模式进行操作， Django](https://www.djangoproject.com/)将是一个不太理想的解决方案，尽管您可以使其工作。

您可能还想研究[Pylons](http://www.pylonsproject.org/)，它是一个比 Django 更通用/准系统的框架。一切都取决于您的实际要求。

# c# - TabControls 有问题

> ID：15032727
> 
> 赞同：0
> 
> 时间：2013-02-22T20:32:39.303
> 
> 标签：c#, tabcontrol, selectedindex

当单击带状菜单按钮时，我正在尝试将父表单上的标签页名称更改为用户在子表单上的文本框中键入的内容。我有一切工作，我可以在两个表单之间提取正确的信息，但每次获取当前选定的标签页时，它总是返回“0”。

**在 Forum1 上设置新标签页名称的功能（消息框来自尝试调试）**

```
public void setNewTabName(string TextBoxText)
    {
        MessageBox.Show("Called");
        MessageBox.Show(TextBoxText);
        int CurrentSelectedTab = tabControl1.SelectedIndex;
        MessageBox.Show(CurrentSelectedTab.ToString());
        tabControl1.TabPages[CurrentSelectedTab].Text = TextBoxText;
    } 
```

**用于获取文本框信息并将其传递给 Form1 的函数 (Form2)**

```
 private void button1_Click(object sender, EventArgs e)
     {
         BT frm1 = new BT();
         frm1.setNewTabName(getTextBoxInfo());
     }

    public string getTextBoxInfo()
     {
         return textBox1.Text;
     } 
```

任何帮助将不胜感激。我想我发布了所有相关代码，但如果您需要其他任何内容，我可以发布整个内容。唯一真正遗漏的是它在单击按钮时创建一个新标签页。

编辑：从子 GUI 中取出相同的方法时效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:55:34.320

我认为问题在于每次单击按钮时都会创建一个新表单（BT 类）。我建议您将表单创建从按钮单击事件移动到父表单加载功能。

# google-app-engine - 如何使用 JPA 和 AppEngine 设置多对一关系？

> ID：15032728
> 
> 赞同：3
> 
> 时间：2013-02-22T20:32:47.087
> 
> 标签：google-app-engine, jpa, google-cloud-endpoints

我一直在尝试使用 JPA 与 AppEngine 中的 2 个实体建立关系，目前遇到了这个错误：

```
java.io.IOException: com.google.appengine.repackaged.org.codehaus.jackson.map.JsonMappingException: Infinite recursion (StackOverflowError) (through reference chain 
```

我的实体如下所示：

```
@Entity
public class MyUser {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key key;

    @OneToMany(fetch = FetchType.LAZY, mappedBy = "user", cascade = CascadeType.ALL)
    private List<MyMessage> messages;
} 
```

还有这个：

```
@Entity
public class MyMessage {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Key key;

    @ManyToOne(optional=false)
    private MyUser user;

} 
```

用户已经存在，这里是我插入新消息并得到递归错误的地方：

```
EntityManager mgr = getEntityManager();
MyUser myuser = mgr.find(MyUser.class, KeyFactory.createKey("MyUser", user.getEmail()));
mymessage.setUser(myuser);
myuser.addMessage(mymessage);
mgr.persist(myuser);
mgr.persist(mymessage); 
```

我应该如何在 JPA 和 AppEngine 指南中设置这种关系？谢谢！

**更新**

我的问题是涉及杰克逊，而不是 JPA。JPA 关系很好，但是我需要删除该关系并通过代码对其进行管理，因为它在序列化消息时导致无限递归，这些消息指的是引用消息的用户等等。我还必须确保将 MyMessage 中的用户属性注释为 @Transient 以避免持久性抱怨持久化已存在的子级拥有的父级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:28:07.220

我不知道端点序列化这些类的合理方法。当前代码生成的 JSON 看起来类似于以下内容：

```
// 1
{
  "key": "foo",
  "messages": [
    {
      "key": "bar",
      "user": {
        // repeat 1
    },
  // and so on...
} 
```

最好的办法是定义一个（或多个）类以通过网络发送，而不是定义 JPA 实体，后者将 JSON 定义为无限多的层次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T08:01:02.527

显然，您的消息与 JPA 持久性无关，而是与杰克逊有关（大概与您如何将这些对象传回有关？）。只有您知道从哪里调用它。从您的帖子中不清楚您的实际持久性操作是否成功，因为您没有生成堆栈跟踪和其余的持久性代码（例如 Jackson 调用的来源）

# object-detection - 以编程方式识别对象？

> ID：15032732
> 
> 赞同：1
> 
> 时间：2013-02-22T20:32:59.803
> 
> 标签：object-detection

灵感来自最近的 Kickstarter 活动：[http ://www.kickstarter.com/projects/dominikmazur/camfind-a-mobile-visual-search-app?ref=category](http://www.kickstarter.com/projects/dominikmazur/camfind-a-mobile-visual-search-app?ref=category)

该应用程序使用移动相机拍照并识别几乎任何物体。拍摄电影海报的照片将识别电影并在网络上为您提供有关它的结果，拍摄产品的照片将向您显示该产品可用于销售的网站。

我的问题是，这现实吗？我觉得这很有趣，但它的对象检测真的那么简单吗？我对有关资源的一些反馈感兴趣，以帮助某人开始学习此主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T21:00:48.577

计算机视觉和[模式识别](http://en.wikipedia.org/wiki/Pattern_recognition)一点也不容易。这是与人工智能相关的整个领域。然而，在高层次上理解起来相对简单。他们***不可能***在客户端上做这一切。这些手机不够快，甚至没有足够*的*存储空间。

他们最有可能做的是将图像发送到他们的服务器，然后在图像上使用某种最近邻近似，并通过决策树查找在*海量*图像数据库中运行结果，这些图像都有一些散列。这将与他们拥有的图像进行密切匹配（假设他们在数据库中有***很多***图像），即使只有部分图像匹配。然后，使用哈希，他们查找有关该图像的其他一些信息以发送到设备。

希望有帮助！

# bash - 追加到大文件的顶部：bash

> ID：15032734
> 
> 赞同：14
> 
> 时间：2013-02-22T20:33:10.287
> 
> 标签：bash, grep, append

我有一个将近 3 GB 的文件，我想在其顶部添加两行。每次我尝试手动添加这些行时，vim 和 vi 都会在保存时冻结（我让它们每个尝试保存大约 10 分钟）。我希望有一种方法可以追加到顶部，就像追加到文件底部一样。到目前为止，我看到的唯一内容包括一个临时文件，由于文件大小，我觉得它会很慢。我希望是这样的：

```
grep -top lineIwant >> fileIwant 
```

有谁知道附加到文件顶部的好方法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-22T20:36:10.893

尝试

```
cat file_with_new_lines file > newfile 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-23T01:15:01.580

我做了一些基准测试来比较使用*sed*和就地编辑（如[这里](https://stackoverflow.com/a/15032760/1337398)所建议）和*cat*（如[这里](https://stackoverflow.com/a/15032768/1337398)所建议）。

~3GB*大文件*，充满点：

```
$ head -n3 bigfile
................................................................................
................................................................................
................................................................................

$ du -b bigfile
3025635308      bigfile 
```

*在bigfile*顶部插入两行文件*换行符*：

 *```
$ cat newlines
some data
some other data

$ du -b newlines
26      newlines 
```

* * *

使用[*dumbbench v0.08 的*](http://search.cpan.org/dist/Dumbbench/)基准测试结果：

*猫*：

```
$ dumbbench -- sh -c "cat newlines bigfile > bigfile.new"
cmd: Ran 21 iterations (0 outliers).
cmd: Rounded run time per iteration: 2.2107e+01 +/- 5.9e-02 (0.3%) 
```

*带有重定向的*sed ：**

 *```
$ dumbbench -- sh -c "sed '1i some data\nsome other data' bigfile > bigfile.new"
cmd: Ran 23 iterations (3 outliers).
cmd: Rounded run time per iteration: 2.4714e+01 +/- 5.3e-02 (0.2%) 
```

*sed*就地编辑：

```
$ dumbbench -- sh -c "sed -i '1i some data\nsome other data' bigfile"
cmd: Ran 27 iterations (7 outliers).
cmd: Rounded run time per iteration: 4.464e+01 +/- 1.9e-01 (0.4%) 
```

因此，在对大文件进行就地编辑时，*sed似乎要慢得多（80.6%），这可能是由于之后将中间临时文件移动到了原始文件的位置。*使用 I/O 重定向*sed*仅比*cat*慢 11.8% 。

基于这些结果，我将按照[此答案](https://stackoverflow.com/a/15032768/1337398)中的建议使用*cat*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-22T20:35:28.840

尝试这样做：

使用[sed](/questions/tagged/sed "显示标记为“sed”的问题")：

```
sed -i '1i NewLine' file 
```

或使用[ed](/questions/tagged/ed "显示标记为“ed”的问题")：

```
ed -s file <<EOF
1i
NewLine
.
w
q
EOF 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-22T21:10:18.840

这种操作的速度很大程度上取决于底层[文件系统](http://en.m.wikipedia.org/wiki/File_system)。据我所知，没有针对此特定操作优化的 FS。大多数 FS 使用完整的磁盘块来组织文件，除了最后一个，它可能在文件末尾部分使用。实际上，如果不能被 整除，则大小为 的文件`N`将占用`N/S`块，`S`块大小在哪里，并且文件的剩余部分（大小为`N%S`，`%`是余数运算符）再占用一个块。`N``S`

通常，这些块由它们在磁盘（或分区）上的索引引用，这些索引存储在 FS 元数据中，附加到分配它们的文件条目。

从这个描述中，您可以看到，只需使用文件使用的新块列表更新元数据，就可以预先添加大小为块大小倍数的内容。但是，如果该前置内容没有完全填充多个块，则现有数据将不得不移动超出的数量。

一些 FS 可能实现在文件的已用块列表中（不仅作为最后一个条目）有部分使用块的可能性，但这并不是一件容易的事。

有关更多详细信息，请参阅这些其他 SO 问题：

*   [将数据附加到文件](https://stackoverflow.com/questions/5560191/prepending-data-to-a-file)
*   [是否存在具有低级别前置操作的文件系统](https://stackoverflow.com/questions/7080850/is-there-a-file-system-with-a-low-level-prepend-operation)

在更高的级别上，即使 FS 驱动程序支持该操作，程序仍然有可能不使用该功能。

对于您要解决的那个问题的实例，最好的方法可能是一个能够`cat`将新内容和现有内容添加到新文件的程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T11:15:04.670

```
 cat file

   Unix
   linux 
```

它使用命令同时附加到文件的两行

sed -i '1a C \n java ' 文件

```
 cat file
   Unix
   C
   java
   Linux 
```

你想 INSERT 意味着使用 i 和 Replace 意味着使用 c**

# google-maps - Google Maps API 放大和缩小标记大小更改

> ID：15032739
> 
> 赞同：1
> 
> 时间：2013-02-22T20:33:38.557
> 
> 标签：google-maps, zooming

```
google.maps.event.addListener(google_map, 'zoom_changed', function() {
var z = google_map.getZoom();

_.each(map_shapes, function(s) {

    if (! $.isFunction(s.shape.getPosition)) return;

    var w = s.shape.getIcon().size.width;
    var h = s.shape.getIcon().size.height;

    s.shape.setIcon(new google.maps.MarkerImage(
        s.shape.getIcon().url, null, null, null, new google.maps.Size(
            w - Math.round(w / 3 * (last_zoom - z)),
            h - Math.round(h / 3 * (last_zoom - z)))
        )
    );

});

last_zoom = z;
}); 
```

当有人放大和缩小时，我正在使用此代码调整我的标记大小，但它会使图标在你缩小时变大，在你放大时变小。我想要相反的结果。

我正在使用谷歌地图 API 3。

我尝试了几种不同的组合，但似乎无法让它发挥作用。

# android - MediaPlayer 数据源问题

> ID：15032740
> 
> 赞同：2
> 
> 时间：2013-02-22T20:33:42.933
> 
> 标签：android, media-player

我的 MediaPlayer 有问题。就在我设置数据源时，我得到了错误：

```
02-22 21:26:10.050: E/MediaPlayer-JNI(7332): setDataSource: outside path in JNI is �x@ 
```

我的设备是 Samsum Galaxy Advance 和我的代码：

```
try {
      mediaPlayer.reset();
      mediaPlayer.setDataSource(audioFile);
      mediaPlayer.prepare();
      mediaController.show();
      mediaPlayer.start();
    } catch (IllegalArgumentException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (SecurityException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (IllegalStateException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T22:12:58.523

尝试这样设置数据源路径，并以这种方式使用mediacontroller：

```
String audioFile= Environment.getExternalStorageDirectory().getAbsolutePath();
audioFile+="/NaturaLocal/muralla_torreVieja_es.mp3";

MediaPlayer mp = new MediaPlayer();
MediaController mc= new MediaController(mp);
mc.setDataSource(audiofile);
mc.prepare();
mc.start(); 
```

# google-drive-api - 将 Google Drive 连接到 Can SQL

> ID：15032741
> 
> 赞同：2
> 
> 时间：2013-02-22T20:33:48.953
> 
> 标签：google-drive-api, google-docs-api, google-cloud-sql

我希望尝试将 Google 的 Cloud SQL 服务与 google drive 结合起来。本质上，我想使用 Google 表单让用户轻松输入数据，然后将数据输入 Cloud SQL 环境（我可以从中进行报告和分析）。

我的问题是，是否有人已经这样做了，或者对如何实现这一点有任何想法？我已经将谷歌表单写入电子表格，而且效果很好。我熟悉 SQL，因此创建报告和从 Cloud SQL 环境中提取数据应该不难......但我不知道如何将两者联系起来。

理想情况下，我希望按计划（可能每晚）运行一些东西，以从谷歌电子表格中提取数据，更新 Cloud SQL 数据库，并从电子表格中清除旧数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-14T04:57:38.917

我认为最好的方法是使用[Google Apps Script](https://developers.google.com/apps-script)。

Apps 脚本允许您为给定的表单定义一个`onSubmit()`方法，当有人向表单提交答案时将调用该方法。

然后，您可以使用该`JDBC`服务连接到 Cloud SQL。

# regex - 记事本正则表达式替换

> ID：15032750
> 
> 赞同：1
> 
> 时间：2013-02-22T20:34:14.537
> 
> 标签：regex, notepad++

本质上我有一组名字，比如

```
name1,
name2,
name3, 
```

我想通过记事本++中的查找和替换来实现

```
name1 = name1,
name2 = name2,
name3 = name3, 
```

**我在Find what**中找到那些 name1 name2 没有问题：

 **```
[^\s,]+ 
```

但是在**Replace with**中，我应该怎么做才能将 ',' 替换为 "=**不管找到什么**，," ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:38:32.600

查找内容（假设您的正则表达式正确找到您想要的内容）：`[^\s,]+`

用。。。来代替：`$0 = $0`

`$0`表示与“查找内容”中的表达式匹配的所有内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:46:57.367

您可以尝试在搜索字段中使用以下正则表达式：

^(\w+\d),

和替换字段：

1 美元 = 1 美元，

希望对你有帮助！**

# html - 可以在 iframe 中更改远程页面的内容吗？

> ID：15032767
> 
> 赞同：1
> 
> 时间：2013-02-22T20:36:08.367
> 
> 标签：html, iframe

您可以在自己的网站页面上的**iframe**中操纵来自不同网站的页面内容吗？

因此，例如，我想省略博客的导航链接和评论，但保留原始网页所有者的实际内容、页脚和横幅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:44:46.860

在[支持浏览器](http://caniuse.com/#search=postMessage)的情况下，这可以通过[`postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)（由[Web 消息规范](http://www.w3.org/TR/webmessaging/)涵盖）实现，但需要框架站点的合作。

您不能自由访问第三方网站的 DOM，因为这会带来严重的安全风险（例如：Alice 访问 Mallory 的网站。Mallory 将 Bob 的网站放在 iframe 中。Alice 的浏览器自动填充用户名和密码字段。Mallory 使用JavaScript 并将它们发送到她自己的服务器。）

# c# - c#验证字符串是否包含匹配数量的括号

> ID：15032770
> 
> 赞同：6
> 
> 时间：2013-02-22T20:36:17.440
> 
> 标签：c#, regex, string, linq, validation

如果我有这样的字符串......

```
"123[1-5]553[4-52]63244[19-44]" 
```

...验证以下条件的最佳方法是什么：

1.  每个开括号都有一个匹配的右括号
2.  不超过**3**组括号
3.  没有嵌套括号（即 [123-[4]9] **）**

正则表达式是否能够验证所有这些场景？如果没有，那么 LINQ 怎么样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T20:40:09.543

因为您不允许嵌套，所以可以使用正则表达式：

```
^([^[\]]*\[[^[\]]*\]){0,3}[^[\]]*$ 
```

解释：

*   `(...){0,3}`最多匹配以下三组：
    *   `[^[\]]*`匹配可选的非括号字符
    *   `\[`匹配 `[`开组
    *   `[^[\]]*`匹配组内可选的非括号字符
    *   `\]`匹配`]`关闭组
*   最后，`[^[\]]*`在所有组之后匹配更多可选的非括号字符

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T20:38:14.477

最快的方法就是迭代字符串

```
bool Validate(string input) 
{
    int braceBalance = 0;
    int openCount = 0;
    for (int i = 0; i < input.Length; i++)
    {
        if (input[i] == '[') 
        {
            braceBalance++;
            openCount++;
        }
        if (openCount > 3) return false;  // More than 3 pairs
        if (input[i] == ']') braceBalance--;
        // Check for nesting:
        if (braceBalance < -1 || braceBalance > 1) return false;
    }
    return (braceBalance == 0); // Check for equal number of opening and closing
} 
```

RegEx 和 Linq 都会有比这更大的开销（尽管取决于您的应用程序，这可能无关紧要）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:09:30.263

只是为了看看它是否合理，这是一个 LINQ:y 解决方案：

```
bool[] b =
  input.Where(c => c == '[' || c == ']')
  .Select((c,i) => (c == '[') == (i % 2 == 0))
  .ToArray();

bool valid = b.Length % 2 == 0 && b.Length <= 6 && b.All(i => i); 
```

它过滤掉`[`and`]`字符，然后检查是否只有交替的括号（以 开头`[`）、偶数且不超过 6 个。

# algorithm - 相关网络实现

> ID：15032773
> 
> 赞同：1
> 
> 时间：2013-02-22T20:36:28.320
> 
> 标签：algorithm, boost, graph, graph-algorithm, minimum-spanning-tree

我一直在研究我的图形/网络问题，我想我终于知道我想做什么了。现在我正在进入实现，我在决定使用哪些库时遇到了问题。该图本身非常简单，每个节点都由一个字符串标记，每个节点都是两个节点（变量）之间的概率/相关系数，并且是无向的。我想在图上执行的操作是：

*   插入新节点/边（快速）
*   找到所有对最短（1/概率）路径，并记住路径中的节点 - 可能是约翰逊的算法
*   为 k 个特定顶点构造最小权重 Steiner 树
    *   使用约翰逊算法构建最短路径
    *   遍历路径 p 中的当前节点，找到到 k 中剩余节点的最短路径
*   查看图表的平均度数
*   评估节点的介数
*   获取聚类系数
*   找到图的模块化

对于其中的许多，我想将结果与 Erdos-Renyi 模型进行比较，并将其作为零假设进行测试。此外，能够通过马尔可夫场使用统计力学定义会很有帮助，因为这样我就可以计算两个不相同的节点之间的相关性，并询问关于熵等的图形问题。所以一个好的映射到某种马尔可夫字段库上也会很有用。

目前问题的症结在于我正在尝试找到一个可以使用的 C++ 库。我看过 R，但我想要一些更健壮、更快的东西。我正在考虑的三个库是：

*   柠檬
    *   易于使用和安装
    *   简单明了的文档
    *   有一些我想要的功能
    *   通过读取文本文件动态创建图形，并确保没有重复的节点，这是我无法弄清楚的噩梦
*   Boost 图形库
    *   对象的难以处理、晦涩难懂的定义，以及如何使用它们
    *   文档与代码的功能不匹配，必然
    *   有很多我想要的算法，以及从文本文件创建图形的非常简单的方法
*   多线程图形库
    *   并行性已经合并
    *   比 BGL 更容易阅读
    *   没有那么多功能
    *   仍然是神秘的

再往前走，我设想图生活在分布式网络上，具有分布式存储（hadoop 或其他东西）。我怀疑整个图不适合内存，所以我必须想出一个缓存方案来查看图的某些部分。

对于我描述的问题，人们会建议什么图书馆？只使用 BGL 并编写我自己的函数会更好吗？多线程版本呢？是否有任何图书馆更适合我想做的工作类型，尤其是我想要计算的数量？

[原帖](https://stackoverflow.com/questions/14846335/finding-a-minimum-maximum-weight-steiner-tree)

谢谢！

**Edit1** 所以我对 BGL 感到非常沮丧。我有一个邻接列表图，我想在图上运行我自己版本的约翰逊（或弗洛伊德，在这一点上，我并不挑剔），并返回距离矩阵供我查看。除了我无法让它工作。到目前为止，这是我的完整代码实现：

```
using namespace boost;

int main()
{
//Read in the file
std::ifstream datafile("stuff");
if (!datafile)
{
    std::cerr << "No Stuff file" << std::endl;
    return EXIT_FAILURE;
}

//Build the graph
typedef adjacency_list < vecS, vecS, undirectedS, property < vertex_name_t,
    std::string >, property < edge_weight_t, double > > Graph;
Graph g;

//Build the two properties we want, string and double
//Note, you have to nest properties for more
typedef property_map< Graph, vertex_index_t >::type vertex_index_map_t;
vertex_index_map_t vertex_index_map = get(vertex_index, g);
typedef property_map < Graph, vertex_name_t >::type name_map_t;
name_map_t name_map = get(vertex_name, g);
typedef property_map < Graph, edge_weight_t >::type probability_map_t;
probability_map_t probability = get(edge_weight, g);

//Map of of the vertices by string
typedef graph_traits < Graph >::vertex_descriptor Vertex;
typedef std::map < std::string, Vertex > NameVertexMap;
NameVertexMap AllNodes;

//Load the file into the graph
for (std::string line; std::getline(datafile, line);)
{
    char_delimiters_separator < char >sep(false, "", ";");
    tokenizer <> line_toks(line, sep);
    tokenizer <>::iterator i = line_toks.begin();
    std::string conditionA = *i++;
    NameVertexMap::iterator pos;
    bool inserted;
    Vertex u, v;

    boost::tie(pos, inserted) = AllNodes.insert(std::make_pair(conditionA, Vertex()));
    if (inserted)
    {
        u = add_vertex(g);
        name_map[u] = conditionA;
        pos->second = u;
    }
    else
    {
        u = pos->second;
    }

    std::string correlation = *i++;
    std::istringstream incorrelation(correlation);
    double correlate;
    incorrelation >> correlate;

    boost::tie(pos, inserted) = AllNodes.insert(std::make_pair(*i, Vertex()));
    if (inserted) {
        v = add_vertex(g);
        name_map[v] = *i;
        pos->second = v;
    }
    else
    {
        v = pos->second;
    }

    graph_traits < Graph >::edge_descriptor e;
    boost::tie(e, inserted) = add_edge(u, v, g);
    if (inserted)
        probability[e] = 1.0/correlate;
}

typedef boost::graph_traits<Graph>::edge_iterator edge_iter;
std::pair<edge_iter, edge_iter> edgePair;
Vertex u, v;
for(edgePair = edges(g); edgePair.first != edgePair.second; ++edgePair.first)
{
    u = source(*edgePair.first, g);
    v = target(*edgePair.first, g);
    std::cout << "( " << vertex_index_map[u] << ":" << name_map[u] << ", ";
    std::cout << probability[*edgePair.first] << ", ";
    std::cout << vertex_index_map[v] << ":" << name_map[v] << " )" << std::endl;
}  
} 
```

其中输入文件的格式为 NodeA;correlation;NodeB。我在上面粘贴的代码有效，但是当我尝试包含 johnson_all_pairs_shortest_paths 功能时遇到了严重的麻烦。我真正想要的不仅是一个 DistanceMatrix D（我似乎无法正确构造它，我希望它是一个双精度方阵 double D[V][V], V = num_vertices(g)，但它给了我回我没有正确调用该函数），还有沿着该路径采用的节点列表，类似于 wiki 文章中关于[Floyd 算法的内容](http://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm)路径重构。我是否应该尝试为这个问题推出自己的算法，因为我无法确定功能是否存在（更不用说如何进行函数调用）？BGL 的文档与实现一样迟钝，所以我真的没有任何现代示例可以继续。

# mysql - 多个表之间的多个联接

> ID：15032780
> 
> 赞同：0
> 
> 时间：2013-02-22T20:37:01.247
> 
> 标签：mysql, left-join, inner-join, outer-join

我正在为工作构建一个休假请求工具。

我有 3 个表：REQUESTS、COVERED 和 MODID。

请求具有以下字段：

```
ID INT Auto_Increment not null Primary Key
MODID VARCHAR(7) not null
THE_DATE DATE not null
THE_TIME VARCHAR(30) not null
COVERED CHAR(1) not null Default = 'N' 
```

COVERED 具有以下字段：

```
ID INT not null Primary Key
CMODID VARCHAR(7) not null 
```

最后 MODID 具有以下字段：

```
MODID VARCHAR(7) not null Primary Key
MODNAME VARCHAR(40) not null 
```

当在 REQUESTS 中提出休假请求时，会使用 ID (auto_increment) 填充 mod 的 MODID，并将其放入 TOR THE_DATE 中，mod 需要覆盖和他们的班次的 THE_TIME。

我有一个输入上述数据的 PHP 后端。同样的后端，当有人接班时，将 REQUESTS.ID 添加到 COVERED.ID 和覆盖班次的 mod 的 MODID。然后它为该特定班次设置 REQUESTS.COVERED = "Y"。

我可以使用以下命令获取具有活动休假请求的所有 MODS 的列表：

```
SELECT M.MODNAME, R.THE_DATE, R.THE_TIME
FROM REQUESTS R
INNER JOIN MODID M ON M.MODID = R.MODID WHERE COVERED = 'N'; 
```

我遇到的问题是我想获取所有请求的模块列表，这些模块的请求涵盖了他们的请求的日期和时间以及涵盖班次 EG 的模块的名称

请求的 MODNAME 日期时间 覆盖 MODNAME

这是我尝试过的：

```
SELECT M.MODNAME, R.THE_DATE, R.THE_TIME, C.CMODID
FROM REQUESTS R, COVERED C 
INNER JOIN MODID M ON M.MODID = R.MODID 
INNER JOIN MODID M ON M.MODID = C.CMODID
WHERE COVERED = 'N'; 
```

我知道上面的 MySQL 有很多问题，但我被卡住了，不知道该怎么办。

这是我的 MYSQL 表的 DUMP [https://dl.dropbox.com/u/12531574/TOR_2013-02-22.sql](https://dl.dropbox.com/u/12531574/TOR_2013-02-22.sql)

**编辑**

**我能得到的最接近的**

使用：

```
SELECT R.MODID, R.THE_DATE, R.THE_TIME, C.CMODID
FROM REQUESTS R
INNER JOIN COVERED C ON C.ID = R.ID; 
```

输出：

```
MODID   THE_DATE    THE_TIME    CMODID
AKH3    2013-02-28  10:00AM - 1:00PM PST    TST3 
```

我要做的就是将 AKH3 (MODID) 更改为 MODID 表中的相应 MODNAME，并将 TST3 (CMODID) 更改为 MODID 表中的相应 MODNAME。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:38:46.647

Since you are only seeking out the ones with coverage, you don't NEED left joins and you should hopefully have FK Constraints in place to keep the mod lookups from breaking. This will give you what you want, with the additional second join of the MODID table giving you the covering mod's name.

```
SELECT M.MODNAME, R.THE_DATE, R.THE_TIME, CM.MODNAME AS `MOD COVERING NAME`
FROM REQUESTS R
JOIN MODID M ON R.MODID = M.MODID
JOIN COVERED C ON C.ID = R.ID
JOIN MODID CM ON CM.MODID = C.CMODID 
```

I would highly suggest you change the table structure to store the CMODID to the actual integer ID of the mod as your table structure is convoluted.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:45:20.410

```
SELECT M.MODNAME, R.THE_DATE, R.THE_TIME, C.CMODID
FROM MODID M
LEFT JOIN REQUESTS R ON R.MODID = M.MODID
AND R.COVERED = 'N';
LEFT JOIN COVERED C ON C.CMODID = M.MODID 
```

试试这个！

# jpa - 在工作单元克隆异常中遇到空或零主键不起作用

> ID：15032781
> 
> 赞同：4
> 
> 时间：2013-02-22T20:37:15.953
> 
> 标签：jpa, jpa-2.0

每当我第一次通过单击说出在 outputText 中输入文本时，都不会发生异常，数据库中的所有内容都会更新，但是当我第二次单击说出按钮时，会出现以下异常。

1) 主页.xhtml

```
</div>
    <div style="width:100%;background-color:#EEEEEE;">
    <h:panelGrid columns="2">
    <h:form>
        <h:outputText value="Speak Out"/><br/>
        <h:outputText value="Share whats in your mind.!" style="color:#aaaaaa;font-size:x-small;"/>
        <p:inputTextarea name="content" id="sharetext" cols="60" rows="2" onclick="this.value='';" value="#{statusBean.status.statusmsg}" style="text-size:small;" /><br/>

        <p:commandButton type="submit" value="Speak Out"  action="#{statusBean.save}"  ajax="false" styleClass="buttonstyle"/><br/>
    </h:form>

    <h:form>
        <h:outputText value="Pic Out"/><br/>
        <p:fileUpload fileUploadListener="#{statusBean.handleFileUpload}"/>
        <h:outputText value="Share whats in your mind through an image.!" style="color:#aaaaaa;font-size:x-small;"/>
        <p:inputTextarea name="content" id="sharetext" cols="60" rows="2" onclick="this.value='';" value="#{statusBean.status.picstatusdesc}" style="text-size:small;" /><br/>

        <p:commandButton type="submit" value="Pic Out"  action="#{statusBean.picSave}"  ajax="false" styleClass="buttonstyle"/><br/>
    </h:form>   

    </h:panelGrid>
   </div> 
```

2）StatusBean.java

```
 public class StatusBean {
Date d;
Comment comment;
Status status;
private EntityManager em;
private UploadedFile uploadedFile;

public Comment getComment() {
    return comment;
}

public void setComment(Comment comment) {
    this.comment = comment;
}

public Status getStatus() {
    return status;
}

public void setStatus(Status status) {
    this.status = status;
}

public StatusBean() {
    d = new Date();
    comment = new Comment();
    status = new Status();
    EntityManagerFactory emf = Persistence
            .createEntityManagerFactory("FreeBird");
    em = emf.createEntityManager();
}

public String save() {
    FacesContext context = FacesContext.getCurrentInstance();
    HttpSession session = (HttpSession) context.getExternalContext()
            .getSession(true);
    User user = (User) session.getAttribute("userdet");
    status.setEmail(user.getEmail());
    status.setStatusBy(user.getFirstName());
    status.setTimeMillis(d.getTime());
    status.setPicture(user.getImage());
    System.out.println("status save called");
    em.getTransaction().begin();
    em.persist(status);
    em.getTransaction().commit();
    session.isNew();
    return "success";
}

public String picSave() {
    FacesContext context = FacesContext.getCurrentInstance();
    HttpSession session = (HttpSession) context.getExternalContext()
            .getSession(true);
    User user = (User) session.getAttribute("userdet");
    status.setEmail(user.getEmail());
    status.setStatusBy(user.getFirstName());
    status.setTimeMillis(d.getTime());
    status.setPicture(user.getImage());
    System.out.println("picstatus save called");
    em.getTransaction().begin();
    em.persist(status);
    em.getTransaction().commit();
    session.isNew();
    return "success";
}

public void handleFileUpload(FileUploadEvent e) {
    System.out.println("file handler called");
    uploadedFile = e.getFile();
    String fileName = uploadedFile.getFileName();
    fileName = fileName.substring(fileName.lastIndexOf("\\") + 1);
    FacesContext context = FacesContext.getCurrentInstance();
    HttpSession session = (HttpSession) context.getExternalContext()
            .getSession(true);
    System.out.println(fileName);
    try {
        ServletContext ctx = (ServletContext) FacesContext
                .getCurrentInstance().getExternalContext().getContext();
        String imagesPath = ctx.getRealPath("images");
        FileOutputStream fos = new FileOutputStream(imagesPath
                + "/statusPicture/" + fileName);
        fos.write(uploadedFile.getContents());
        fos.flush();
        fos.close();
        status.setPicstatus(fileName);
    } catch (IOException e1) {
        e1.printStackTrace();
    }
  }
} 
```

3) 状态实体类

```
@Entity
public class Status implements Serializable,Comparable<Status> {
    private static final long serialVersionUID = 1L;

    @Id
    private int statusId;
    private String email;
    private String picstatus;
    private String picstatusdesc;
    private String picture;
    private String statusBy;
    private String statusmsg;
    private long timeMillis;

    public Status() {
    }

    public int getStatusId() {
        return this.statusId;
    }

    public void setStatusId(int statusId) {
        this.statusId = statusId;
    }

    public String getEmail() {
        return this.email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPicstatus() {
        return this.picstatus;
    }

    public void setPicstatus(String picstatus) {
        this.picstatus = picstatus;
    }

    public String getPicstatusdesc() {
        return this.picstatusdesc;
    }

    public void setPicstatusdesc(String picstatusdesc) {
        this.picstatusdesc = picstatusdesc;
    }

    public String getPicture() {
        return this.picture;
    }

    public void setPicture(String picture) {
        this.picture = picture;
    }

    public String getStatusBy() {
        return this.statusBy;
    }

    public void setStatusBy(String statusBy) {
        this.statusBy = statusBy;
    }

    public String getStatusmsg() {
        return this.statusmsg;
    }

    public void setStatusmsg(String statusmsg) {
        this.statusmsg = statusmsg;
    }

    public long getTimeMillis() {
        return this.timeMillis;
    }

    public void setTimeMillis(long l) {
        this.timeMillis = l;
    }
    @Override
    public int compareTo(Status o) {

        return (int) (o.getTimeMillis()-this.getTimeMillis());
    }

} 
```

4) 堆栈跟踪

```
 WARNING: #{statusBean.save}: javax.persistence.RollbackException: Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
javax.faces.FacesException: #{statusBean.save}: javax.persistence.RollbackException: Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: javax.faces.el.EvaluationException: javax.persistence.RollbackException: Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    ... 36 more
Caused by: javax.persistence.RollbackException: Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commitInternal(EntityTransactionImpl.java:102)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commit(EntityTransactionImpl.java:63)
    at com.bean.StatusBean.save(StatusBean.java:80)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    ... 37 more
Caused by: Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
    at org.eclipse.persistence.exceptions.ValidationException.nullPrimaryKeyInUnitOfWorkClone(ValidationException.java:1439)
    at org.eclipse.persistence.descriptors.changetracking.DeferredChangeDetectionPolicy.calculateChanges(DeferredChangeDetectionPolicy.java:107)
    at org.eclipse.persistence.descriptors.changetracking.DeferredChangeDetectionPolicy.calculateChangesForExistingObject(DeferredChangeDetectionPolicy.java:54)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.calculateChanges(UnitOfWorkImpl.java:643)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1490)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitRootUnitOfWork(RepeatableWriteUnitOfWork.java:267)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitAndResume(UnitOfWorkImpl.java:1143)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commitInternal(EntityTransactionImpl.java:84)
    ... 47 more

WARNING: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception
Local Exception Stack: 
Exception [EclipseLink-7197] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Null or zero primary key encountered in unit of work clone [com.entity.Status@1523582], primary key [0]. Set descriptors IdValidation or the "eclipselink.id-validation" property.
    at org.eclipse.persistence.exceptions.ValidationException.nullPrimaryKeyInUnitOfWorkClone(ValidationException.java:1439)
    at org.eclipse.persistence.descriptors.changetracking.DeferredChangeDetectionPolicy.calculateChanges(DeferredChangeDetectionPolicy.java:107)
    at org.eclipse.persistence.descriptors.changetracking.DeferredChangeDetectionPolicy.calculateChangesForExistingObject(DeferredChangeDetectionPolicy.java:54)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.calculateChanges(UnitOfWorkImpl.java:643)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitToDatabaseWithChangeSet(UnitOfWorkImpl.java:1490)
    at org.eclipse.persistence.internal.sessions.RepeatableWriteUnitOfWork.commitRootUnitOfWork(RepeatableWriteUnitOfWork.java:267)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.commitAndResume(UnitOfWorkImpl.java:1143)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commitInternal(EntityTransactionImpl.java:84)
    at org.eclipse.persistence.internal.jpa.transaction.EntityTransactionImpl.commit(EntityTransactionImpl.java:63)
    at com.bean.StatusBean.save(StatusBean.java:80)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.el.parser.AstValue.invoke(AstValue.java:254)
    at com.sun.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:302)
    at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105)
    at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
    at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
    at javax.faces.component.UICommand.broadcast(UICommand.java:315)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259)
    at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)

log file rotation... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-16T09:37:43.710

我不明白为什么它第一次起作用，但就像 Nicolas Labrot 我看不到你设置你的主键，这就是为什么你得到一个主键是 Exception 的原因`null`。如果您将密钥设置在其他地方，请检查它是否可能为 0。如果您未在 persistence.xml 中设置以下属性，Eclipselink 不支持将 0 作为主键，您将得到该异常。

```
<property name="eclipselink.allow-zero-id" value="true"/> 
```

该属性只是告诉 EclipseLink 将 '0' 视为有效的主键，而不是`null`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-24T12:45:55.227

**不推荐使用eclipselink.allow-zero-id**属性，因此您应该使用**eclipselink.id-validation**来定义哪些主键组件值被视为无效。

```
<property name="eclipselink.id-validation" value="NULL"/> 
```

请参阅：[https ://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/p_id_validation.htm](https://www.eclipse.org/eclipselink/documentation/2.4/jpa/extensions/p_id_validation.htm)

# php - 添加数据库的一列以获得总和然后除以得到百分比

> ID：15032788
> 
> 赞同：2
> 
> 时间：2013-02-22T20:37:51.850
> 
> 标签：php, mysql, sum

我在一个结构如下的数据库中有信息：

```
shoe size name    weight
9         bob     150
9         tom     250
9         joe     100
5         billy   75
5         franky  80
etc. 
```

你明白了。我想将重量与鞋码相加，然后除以每一个以获得百分比。所以鞋码 9 将是 500。然后除以每个尺码的总和......所以 bob 将是鞋码组 9 的 30%，tom 将是鞋码组 9 的 50%，joe 将是鞋码组的 20%尺寸组 9

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:39:32.073

```
SELECT SUM(weight) as sum, COUNT(*) as count
FROM mytable
GROUP BY size 
```

这会给你重量的总和和每个尺寸的数量，然后你可以得到平均值

或者，如果您想一口气完成

```
 SELECT  size, SUM(weight)/COUNT(*) as average
    FROM mytable
    GROUP BY size 
```

编辑-我误读了您的问题，这是一个可以满足您要求的查询

```
 SELECT  b.name,  b.weight/sum(a.weight) as average  
   FROM  table as a JOIN table as b on a.size=b.size     
   WHERE  1 group by a.size, b.name 
```

# javascript - 使用 Twitter Bootstrap 附加和分离附加的标题

> ID：15032789
> 
> 赞同：4
> 
> 时间：2013-02-22T20:37:53.377
> 
> 标签：javascript, css, twitter-bootstrap, affix

我正在尝试使用附加功能将标题附加到屏幕顶部，但仅将其附加到页面的一部分。当用户滚动超过某个点时，它应该分离（并与内容一起向上滚动）。

我正在使用这个[jsfiddle](http://jsfiddle.net/Uaa3U/198/)中的脚本。

我现在正在尝试的是：

```
$('#nav-wrapper').height($("#nav").height());

$('#nav').affix({
    offset: $('#nav').position()
});
$('#nav').detached({
    offset: $('#bottom').position()
}); 
```

像这样的`.detached`类：

```
.detached { position: static; } 
```

无法让这个工作。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-04T02:42:10.940

您可以在函数中编写逻辑，并将其作为 offset.top 传递给 affix。

尝试

```
var navHeight = $("#nav").height();
var detachTop = $("#detach").offset().top;
var navTop = $("#nav-wrapper").offset().top;

$('#nav-wrapper').height(navHeight);
$('#nav').affix({
    offset : {
        top : function() {
            if ((navHeight + $(window).scrollTop()) > detachTop) {
                return Number.MAX_VALUE;
            }
            return navTop;
        }
    }
}); 
```

[小提琴来了。](http://jsfiddle.net/BuNq2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-22T21:41:18.610

Twitter Bootstrap 词缀模块没有该选项。但是，我已经使用了很多次[hcSticky](http://someweblog.com/hcsticky-jquery-floating-sticky-plugin/)，它很棒。看一下，它使用起来很简单，而且效果很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-04T04:07:24.320

另一个可能适合您的选项：http: [//jsfiddle.net/panchroma/5n9vw/](http://jsfiddle.net/panchroma/5n9vw/)

**HTML**

```
<div class="header" data-spy="affix">
affixed header, released after scrolling 100px
</div> 
```

**Javascript**

```
$(document).ready(function(){
$(window).scroll(function(){
var y = $(window).scrollTop();
if( y > 100 ){
  $(".header.affix").css({'position':'static'});
} else {
  $(".header.affix").css({'position':'fixed'});
}
});
}) 
```

祝你好运！

# dotcloud - 使用 dotcloud 指定 PHP 版本

> ID：15032790
> 
> 赞同：0
> 
> 时间：2013-02-22T20:38:02.620
> 
> 标签：dotcloud

我有一个需要 PHP 5.3 的应用程序。是否可以指定要运行的 PHP 版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:15:26.037

目前无法在[PHP 和 PHP-Worker services](http://docs.dotcloud.com/services/php/)中指定 PHP 的版本。当前版本（截至本文发布）为 5.4.6-2~lucid+1

如果您需要特定版本的 PHP，可以使用自定义配方下载并安装您正在寻找的特定版本。以下项目是此类自定义服务的示例。

[https://github.com/kencochrane/php-on-dotcloud](https://github.com/kencochrane/php-on-dotcloud)

# json - 如何使用 JTA 发布使用 Jax-RS 的对象数组？

> ID：15032791
> 
> 赞同：0
> 
> 时间：2013-02-22T20:38:03.413
> 
> 标签：json, rest, jpa, jax-rs, jta

我有一个 jax-rs REST 服务，它发布一个

`ArrayList<Book>`

对象到服务器。

在服务器上，我遍历每本书，将其转换为 BookEntity（我正在使用 JPA），然后持久化每本书。

如果任何 BookEntity 无法持久化，我希望整个 POST 操作失败，并且提交的 ArrayList 中没有 Book Entity 被持久化。我想回滚整个操作，使其全部或全无。

仅使用容器管理事务（我知道您只需注入您的实体管理器即可免费获得）就可以解决问题吗？还是我需要 JTA 才能做到这一点？我对自动完成事务管理的哪一部分感到有点困惑？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T08:06:21.637

仅仅注入一个实体管理器不会给你容器管理的事务。这些是为服务启用 CMT 的先决条件：

1.  服务必须是 EJB（@Stateless、@Stateful、@MessageDriven）
2.  服务必须定义[`@TransactionManagement(CONTAINER)`](http://docs.oracle.com/javaee/6/api/javax/ejb/TransactionManagement.html)。这是默认设置，因此可以省略整个注释
3.  服务必须为其 JPA 操作使用 JTA 实体管理器。

如果满足所有先决条件，那么对于服务上的任何给定业务方法，容器将自动管理其事务。事务行为可以通过使用注解在一个方法一个方法的基础上进行微调[`TransactionAttribute`](http://docs.oracle.com/javaee/6/api/javax/ejb/TransactionAttribute.html)，但默认是每个方法的：

*   如果不存在事务，则启动一个
*   当方法完成时，提交事务
*   如果方法抛出异常，则回滚事务

# sql - 选择除顶行之外的所有行

> ID：15032803
> 
> 赞同：8
> 
> 时间：2013-02-22T20:39:20.443
> 
> 标签：sql, sql-server, rows

如何从表中返回除第一行之外的所有行。这是我的sql语句：

```
Select Top(@TopWhat) * 
from tbl_SongsPlayed 
where Station = @Station 
order by DateTimePlayed DESC 
```

如何更改我的 SQL 语句以返回除第一行之外的所有行。

非常感谢

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-22T20:45:20.477

SQL 2012 也有相当方便的 OFFSET 子句：

```
Select Top(@TopWhat) *
from tbl_SongsPlayed 
where Station = @Station 
order by DateTimePlayed DESC
OFFSET 1 ROWS 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-22T20:41:43.850

根据您的数据库产品，您可以使用`row_number()`：

```
select *
from
(
  Select s.*,
    row_number() over(order by DateTimePlayed DESC) rn
  from tbl_SongsPlayed s
  where s.Station = @Station 
) src
where rn >1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-22T21:28:14.590

'Chrisb' 已经给出了一个非常简洁的答案。不过你也可以试试这个...

EXCEPT 操作数 ( [http://msdn.microsoft.com/en-us/library/ms188055.aspx](http://msdn.microsoft.com/en-us/library/ms188055.aspx) )

```
Select Top(@TopWhat) *
from tbl_SongsPlayed 
Except  Select Top(1) *
from tbl_SongsPlayed 
where Station = @Station 
order by DateTimePlayed DESC 
```

'Not In' 是另一个可以使用的子句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T20:45:04.377

假设您有一个唯一的 ID `tbl_SongsPlayed`，您可以执行以下操作：

```
// Filter the songs first
With SongsForStation
As   (
   Select *
   From   tbl_SongsPlayed
   Where  Station = @Station
)
// Get the songs
Select *
From   SongsForStation
Where  SongPlayId <> (
   // Get the top song, most recently played, so you can exclude it.
   Select Top 1 SongPlayId
   From   SongsForStation
   Order By DateTimePlayed Desc
   )
// Sort the rest of the songs.
Order By
   DateTimePlayed desc
        Where 
```

# r - sqldf：将时间戳从 GMT/UTC 更改为本地时间

> ID：15032806
> 
> 赞同：1
> 
> 时间：2013-02-22T20:39:43.393
> 
> 标签：r, sqldf, lubridate

我有与[这个问题](https://stackoverflow.com/questions/9522270/sqldf-changes-timestamp-from-localtime-to-gmt-utc)完全相反的问题。`sqldf`正在将日期从 GMT/UTC 转换为本地时间。如何防止这种行为？注意：我使用`lubridate`包将日期字符串转换为 POSIXct。

```
dates <- c("9/12/2010 0:25","9/12/2010 23:22","9/10/2010 1:55")
foo <- data.frame(dates=mdy_hm(dates)) 
```

返回

```
 dates
1 2010-09-12 00:25:00
2 2010-09-12 23:22:00
3 2010-09-10 01:55:00 
```

然而

```
bar <- sqldf("SELECT * FROM foo") 
```

返回

```
 dates
1 2010-09-11 19:25:00
2 2010-09-12 18:22:00
3 2010-09-09 20:55:00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T01:52:00.843

[sqldf](http://code.google.com/p/sqldf/)的帮助 wiki给出了如何处理日期的示例。您需要使用 as 将结果转换为数字。然后将结果提供给 processMethod 以将其转换为所需的格式。

这里适应你的例子。

```
dates <- c("9/12/2010 0:25","9/12/2010 23:22","9/10/2010 1:55")
foo <- data.frame(dates=mdy_hm(dates))
processDates <- function(data, ...) {
   ix <- grepl("_convert$", names(data))
   names(data)[ix] <- sub("_convert$", "", names(data)[ix])
   data[ix] <- lapply(data[ix], as.POSIXct, 
                      origin = "1970-01-01",
                      tz='UTC')
   data
   }

sqldf("select dates as newdates_convert from foo", method = processDates)

             newdates
1 2010-09-12 00:25:00
2 2010-09-12 23:22:00
3 2010-09-10 01:55:00 
```

# html - 使用 QRegExp 从 html 字符串中提取 href 值

> ID：15032807
> 
> 赞同：2
> 
> 时间：2013-02-22T20:39:52.367
> 
> 标签：html, regex, qt, qregexp

我正在下载一个网页，并试图从中提取一些值。

我感兴趣的页面位置属于这种类型：

```
<a data-track=\"something\" href=\"someurl\" title=\"Heaven\"><img src=\"somesource.jpg\" /></a> 
```

我需要提取 href (someurl) 值。请注意，我拥有的 HTML 字符串中有多个条目，例如上面的条目，因此我将使用一个列表来存储从字符串中提取的所有 URL。

这是我迄今为止尝试过的：

```
QString html_str=myfile();
QRegExp regex("<a data-track\\=\"something\" href\\=\".*(?=\" title)");
if(regex.indexIn(html_str) != -1){
    QStringList list;
    QString str;
    list = regex.capturedTexts();
    foreach(str,list)
        qDebug() << str.remove("<a data-track=\"something\" href=\"");
} 
```

使用上面的代码，我只得到一次出现 ( )，它包含从第一次出现到文件末尾`list.count() == 1`的整个 HTML 字符串，没有其中的所有已被删除的字符串。`someurl``<a data-track="something" href=""`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-16T15:05:25.853

我会这样做：（确保你仔细检查你的正则表达式）

```
QRegExp regex("<a data-track=\"something\" href=\".*(?=\" title)");

if (regex.indexIn(html_str) != -1) qDebug() << html_str.cap().remove(<a data-track=\"something\" href=\"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-21T05:23:21.353

您可以使用 while 循环来控制“html_str”的位置

```
pos = regex.indexIn(htmlContent);    // get the first position
while(pos = regex.indexIn(htmlContent, pos) != -1){    // continue next
    QStringList list;
    list = regex.capturedTexts();
    foreach(QString url, list) {
        // do something
    }
    pos += regex.matchedLength();
} 
```

# c# - 验证的最佳地点在哪里......构造函数或留给客户调用？

> ID：15032808
> 
> 赞同：2
> 
> 时间：2013-02-22T20:39:56.330
> 
> 标签：c#, validation

这确实是一个通用的（也可能是一个更主观的）问题。我有一些类，我使用接口来定义验证对象状态的标准方法。当我这样做时，我开始摸不着头脑......最好是 1.) 允许构造函数（或初始化方法）自动静默过滤掉错误信息，或者...... 2.) 允许客户端实例化然而，让客户端在继续之前调用接口的 IsValid 属性或 Validate() 方法？

基本上，一种方法是沉默的，但可能会产生误导，因为客户可能不知道某些信息由于不符合验证标准而被过滤掉了。那么另一种方法会更直接，但也会增加一两步？这里有什么典型？

好的，经过漫长的一天尝试跟上其他事情，我终于想出了一个例子。请为我服务，因为它并不理想，也绝不是什么美妙的东西，但希望它的服务足够好，可以让大家明白这一点。我目前的项目太复杂了，无法为此提出一些简单的事情，所以我编造了一些东西……相信我……完全编造出来的。

好的，示例中的对象是这样的：

**客户端：**代表客户端代码（控制台应用程序顺便说一句）

**IValidationInfo：**这是我在当前项目中使用的实际接口。它允许我为不一定要供客户端使用的“后端”对象创建验证框架，因为业务逻辑可能足够复杂。这也允许我分离验证代码并根据需要调用业务逻辑。

**OrderManager：**这是客户端代码可以用来管理订单的对象。可以这么说，它对客户友好。

**OrderSpecification：**这是客户端代码可以用来请求订单的对象。但是如果业务逻辑不起作用，则可以引发异常（或者如果需要，不添加订单并忽略异常......）在我的真实示例中，我实际上有一个对象不是那么黑 -白色至此围栏的哪一侧......因此，当我意识到我可以将验证请求（调用 IsValid 或 Validate()）推送到 cilent 时，我最初的问题是。

**CustomerDescription：**代表我分类的客户（假装是从数据库中读取的。

**产品：**表示也被分类的特定产品。

**OrderDescription：**代表正式的订单请求。业务规则是客户不能订购他们未分类的任何东西（我知道..这不是很现实，但它给了我一些可以使用的东西......）

好的...我刚刚意识到我无法在此处附加文件，所以这是代码。我为它的冗长外观道歉。这是我使用我的 Validation 接口创建对客户端友好的前端和业务逻辑后端所能做的最好的事情：

公共类 Client { 静态 OrderManager orderMgr = new OrderManager();

```
 static void Main(string[] args)
    {
        //Request a new order
        //Note:  Only the OrderManager and OrderSpecification are used by the Client as to keep the 
        //       Client from having to know and understand the framework beyond that point.
        OrderSpecification orderSpec = new OrderSpecification("Customer1", new Product(IndustryCategory.FoodServices, "Vending Items"));
        orderMgr.SubmitOrderRequest(orderSpec);
        Console.WriteLine("The OrderManager has {0} items for {1} customers.", orderMgr.ProductCount, orderMgr.CustomerCount);

        //Now add a second item proving that the business logic to add for an existing customer works
        Console.WriteLine("Adding another valid item for the same customer.");
        orderSpec = new OrderSpecification("Customer1", new Product(IndustryCategory.FoodServices, "Sodas"));
        orderMgr.SubmitOrderRequest(orderSpec);
        Console.WriteLine("The OrderManager now has {0} items for {1} customers.", orderMgr.ProductCount, orderMgr.CustomerCount);

        Console.WriteLine("Adding a new valid order for a new customer.");
        orderSpec = new OrderSpecification("Customer2", new Product(IndustryCategory.Residential, "Magazines"));
        orderMgr.SubmitOrderRequest(orderSpec);
        Console.WriteLine("The OrderManager now has {0} items for {1} customers.", orderMgr.ProductCount, orderMgr.CustomerCount);

        Console.WriteLine("Adding a invalid one will not work because the customer is not set up to receive these kinds of items.  Should get an exception with message...");
        try
        {
            orderSpec = new OrderSpecification("Customer3", new Product(IndustryCategory.Residential, "Magazines"));
            orderMgr.SubmitOrderRequest(orderSpec);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }

        Console.ReadLine();
    }
}

public interface IValidationInfo
{
    string[] ValidationItems { get; }

    bool IsValid { get; }

    void Validate();

    List<string> GetValidationErrors();

    string GetValidationError(string itemName);
}

public class OrderManager
{
    private List<OrderDescription> _orders = new List<OrderDescription>();
    public List<OrderDescription> Orders
    {
        get { return new List<OrderDescription>(_orders); }
        private set { _orders = value; }
    }

    public int ProductCount
    {
        get
        {
            int itemCount = 0;
            this.Orders.ForEach(o => itemCount += o.Products.Count);
            return itemCount;
        }
    }

    public int CustomerCount
    {
        get
        {
            //since there's only one customer per order, just return the number of orders
            return this.Orders.Count;
        }
    }

    public void SubmitOrderRequest(OrderSpecification orderSpec)
    {
        if (orderSpec.IsValid)
        {
            List<OrderDescription> orders = this.Orders;

            //Since the particular customer may already have an order, we might as well add to an existing
            OrderDescription existingOrder = orders.FirstOrDefault(o => string.Compare(orderSpec.Order.Customer.Name, o.Customer.Name, true) == 0) as OrderDescription;
            if (existingOrder != null)
            {
                List<Product> existingProducts = orderSpec.Order.Products;
                orderSpec.Order.Products.ForEach(p => existingOrder.AddProduct(p));
            }
            else
            {
                orders.Add(orderSpec.Order);
            }
            this.Orders = orders;
        }
        else
            orderSpec.Validate(); //Let the OrderSpecification pass the business logic validation down the chain
    }
}

public enum IndustryCategory
{
    Residential,
    Textile,
    FoodServices,
    Something
}

public class OrderSpecification : IValidationInfo
{
    public OrderDescription Order { get; private set; }

    public OrderSpecification(string customerName, Product product)
    {
        //Should use a method in the class to search and retrieve Customer... pretending here
        CustomerDescription customer = null;
        switch (customerName)
        {
            case "Customer1":
                customer = new CustomerDescription() { Name = customerName, Category = IndustryCategory.FoodServices };
                break;
            case "Customer2":
                customer = new CustomerDescription() { Name = customerName, Category = IndustryCategory.Residential };
                break;
            case "Customer3":
                customer = new CustomerDescription() { Name = customerName, Category = IndustryCategory.Textile };
                break;
        }

        //Create an OrderDescription to potentially represent the order... valid or not since this is
        //a specification being used to request the order
        this.Order = new OrderDescription(new List<Product>() { product }, customer);

    }

    #region IValidationInfo Members
    private readonly string[] _validationItems =
    {
        "OrderDescription"
    };
    public string[] ValidationItems
    {
        get { return _validationItems; }
    }

    public bool IsValid
    {
        get
        {
            List<string> validationErrors = GetValidationErrors();
            if (validationErrors != null && validationErrors.Count > 0)
                return false;
            else
                return true;
        }
    }

    public void Validate()
    {
        List<string> errorMessages = GetValidationErrors();
        if (errorMessages != null && errorMessages.Count > 0)
        {
            StringBuilder errorMessageReported = new StringBuilder();
            errorMessages.ForEach(em => errorMessageReported.AppendLine(em));
            throw new Exception(errorMessageReported.ToString());
        }
    }

    public List<string> GetValidationErrors()
    {
        List<string> errorMessages = new List<string>();
        foreach (string item in this.ValidationItems)
        {
            string errorMessage = GetValidationError(item);
            if (!string.IsNullOrEmpty(errorMessage))
                errorMessages.Add(errorMessage);
        }

        return errorMessages;
    }

    public string GetValidationError(string itemName)
    {
        switch (itemName)
        {
            case "OrderDescription":
                return ValidateOrderDescription();
            default:
                return "Invalid item name.";
        }
    }

    #endregion

    private string ValidateOrderDescription()
    {
        string errorMessage = string.Empty;

        if (this.Order == null)
            errorMessage = "Order was not instantiated.";
        else
        {
            if (!this.Order.IsValid)
            {
                List<string> orderErrors = this.Order.GetValidationErrors();
                orderErrors.ForEach(ce => errorMessage += "\n" + ce);
            }
        }

        return errorMessage;
    }

}

public class CustomerDescription : IValidationInfo
{
    public string Name { get; set; }
    public string Street { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public int ZipCode { get; set; }
    public IndustryCategory Category { get; set; }

    #region IValidationInfo Members
    private readonly string[] _validationItems =
    {
        "Name",
        "Street",
        "City",
        "State",
        "ZipCode",
        "Category"
    };
    public string[] ValidationItems
    {
        get { return _validationItems; }
    }

    public bool IsValid
    {
        get
        {
            List<string> validationErrors = GetValidationErrors();
            if (validationErrors != null && validationErrors.Count > 0)
                return false;
            else
                return true;
        }
    }

    public void Validate()
    {
        List<string> errorMessages = GetValidationErrors();
        if (errorMessages != null && errorMessages.Count > 0)
        {
            StringBuilder errorMessageReported = new StringBuilder();
            errorMessages.ForEach(em => errorMessageReported.AppendLine(em));
            throw new Exception(errorMessageReported.ToString());
        }
    }

    public List<string> GetValidationErrors()
    {
        List<string> errorMessages = new List<string>();
        foreach (string item in this.ValidationItems)
        {
            string errorMessage = GetValidationError(item);
            if (!string.IsNullOrEmpty(errorMessage))
                errorMessages.Add(errorMessage);
        }

        return errorMessages;
    }

    public string GetValidationError(string itemName)
    {
        //Validation methods should be called here... pretending nothings wrong for sake of discussion & simplicity
        switch (itemName)
        {
            case "Name":
                return string.Empty;
            case "Street":
                return string.Empty;
            case "City":
                return string.Empty;
            case "State":
                return string.Empty;
            case "ZipCode":
                return string.Empty;
            case "Category":
                return string.Empty;
            default:
                return "Invalid item name.";
        }
    }

    #endregion
}

public class Product
{
    public IndustryCategory Category { get; private set; }
    public string Description { get; private set; }

    public Product(IndustryCategory category, string description)
    {
        this.Category = category;
        this.Description = description;
    }
}

public class OrderDescription : IValidationInfo
{
    public CustomerDescription Customer { get; private set; }

    private List<Product> _products = new List<Product>();
    public List<Product> Products
    {
        get { return new List<Product>(_products); }
        private set { _products = value; }
    }

    public OrderDescription(List<Product> products, CustomerDescription customer)
    {
        this.Products = products;
        this.Customer = customer;
    }

    public void PlaceOrder()
    {
        //If order valid, place
        if (this.IsValid)
        {
            //Do stuff to place order
        }
        else
            Validate(); //cause the exceptions to be raised with the validate because business rules were broken
    }

    public void AddProduct(Product product)
    {
        List<Product> productsToEvaluate = this.Products;
        //some special read, validation, quantity check, pre-existing, etc here
        // doing other stuff... 
        productsToEvaluate.Add(product);
        this.Products = productsToEvaluate;
    }

    #region IValidationInfo Members

    private readonly string[] _validationItems =
    {
        "Customer",
        "Products"
    };
    public string[] ValidationItems
    {
        get { return _validationItems; }
    }

    public bool IsValid
    {
        get
        {
            List<string> validationErrors = GetValidationErrors();
            if (validationErrors != null && validationErrors.Count > 0)
                return false;
            else
                return true;
        }
    }

    public void Validate()
    {
        List<string> errorMessages = GetValidationErrors();
        if (errorMessages != null && errorMessages.Count > 0)
        {
            StringBuilder errorMessageReported = new StringBuilder();
            errorMessages.ForEach(em => errorMessageReported.AppendLine(em));
            throw new Exception(errorMessageReported.ToString());
        }
    }

    public List<string> GetValidationErrors()
    {
        List<string> errorMessages = new List<string>();
        foreach (string item in this.ValidationItems)
        {
            string errorMessage = GetValidationError(item);
            if (!string.IsNullOrEmpty(errorMessage))
                errorMessages.Add(errorMessage);
        }

        return errorMessages;
    }

    public string GetValidationError(string itemName)
    {
        switch (itemName)
        {
            case "Customer":
                return ValidateCustomer();
            case "Products":
                return ValidateProducts();
            default:
                return "Invalid item name.";
        }
    }

    #endregion

    #region Validation Methods

    private string ValidateCustomer()
    {
        string errorMessage = string.Empty;

        if (this.Customer == null)
            errorMessage = "CustomerDescription is missing a valid value.";
        else
        {
            if (!this.Customer.IsValid)
            {
                List<string> customerErrors = this.Customer.GetValidationErrors();
                customerErrors.ForEach(ce => errorMessage += "\n" + ce);
            }
        }

        return errorMessage;
    }

    private string ValidateProducts()
    {
        string errorMessage = string.Empty;

        if (this.Products == null || this.Products.Count <= 0)
            errorMessage = "Invalid Order. Missing Products.";
        else
        {
            foreach (Product product in this.Products)
            {
                if (product.Category != Customer.Category)
                {
                    errorMessage += string.Format("\nThe Product, {0}, category does not match the required Customer category for {1}", product.Description, Customer.Name);
                }
            }
        }
        return errorMessage;
    }
    #endregion
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:42:44.923

如果信息有效，您不希望构造函数大声抛出异常的任何原因？根据我的经验，最好避免创建处于无效状态的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:01:44.257

这完全取决于客户。正如你已经提到的，有一个权衡。默认情况下，方法 1 是我最喜欢的。创建具有良好封装性的智能类，并对客户端隐藏细节。智能程度取决于谁将使用该对象。如果客户具有商业意识，您可以根据这种意识的水平透露细节。这是二分法，不应被视为黑色或白色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:55:49.703

好吧，如果我理解正确的话，基本上有两个问题——你应该立即失败还是稍后失败，以及你是否应该省略/假设某些信息。

1）我总是喜欢尽快失败——很好的例子是在编译时失败与在运行时失败——你总是希望在编译时失败。因此，如果某个对象的状态出现问题，正如 Jon 所说的那样 - 尽可能大声地立即抛出异常并处理它 - 不要在未来引入额外的复杂性，因为你将走向 if/elseif/elseif /elseif/else 胡说八道。

2）当涉及到用户输入时，如果您能够简单地自动过滤掉错误 - 那就去做吧。例如，我几乎从不向用户询问国家——如果我真的需要它，我会自动从 IP 中检测到它并以表格形式显示。如果用户只需要确认/更改数据，那就更容易了——而且我不需要处理 null 情况。

现在，如果我们谈论的是在某些处理过程中由代码生成的数据——对我来说情况完全不同——我总是想知道尽可能多的信息（以便于以后调试），理想情况下你永远不应该破坏任何一块信息。

最后，在您的情况下，我建议您将 IsValid 保持为简单的 yes/no（不是 yes/no/maybe/kindaok/etc）。如果您可以自动修复一些问题 - 执行此操作，但请考虑他们将对象保留在 IsValid 中是的。对于其他一切，您抛出异常并转到 IsValid=no。

# mysql - MySQL中的子查询计数字符串

> ID：15032814
> 
> 赞同：0
> 
> 时间：2013-02-22T20:40:25.030
> 
> 标签：mysql, sql, subquery

```
LEFT JOIN
(
    SELECT user_id, review, COUNT(user_id) totalCount
    FROM reviews
    GROUP BY user_id
) b ON b.user_id= b.user_id 
```

我试图`WHERE LENGTH(review) > 100`在某个地方适应它，但每次我放它，它都会给我带来问题。

上面的子查询将所有评论总数按`user_id`. 我只是想再增加一个资格。仅计算长度超过 100 条的评论。

在旁注中，我已经看到了这个功能`CHAR_LENGTH`——不确定这是否是我需要的。

**编辑：**

这是完整的查询，可以满足我的需求：

```
 static public $top_users = "
            SELECT  u.username, u.score,
            (COALESCE(a.totalCount, 0) * 4) +
            (COALESCE(b.totalCount, 0) * 5) +
            (COALESCE(c.totalCount, 0) * 1)  +
            (COALESCE(d.totalCount, 0) * 2)  +
            (COALESCE(u.friend_points, 0)) AS totalScore
            FROM users u 
            LEFT JOIN
                (
                    SELECT user_id, COUNT(user_id) totalCount
                    FROM items 
                    GROUP BY user_id
                ) a ON a.user_id= u.user_id
            LEFT JOIN
                (
                    SELECT user_id, COUNT(user_id) totalCount
                    FROM reviews
                    GROUP BY user_id
                ) b ON b.user_id= u.user_id
            LEFT JOIN
                (
                    SELECT user_id, COUNT(user_id) totalCount
                    FROM ratings
                    GROUP BY user_id
                ) c ON c.user_id = u.user_id
             LEFT JOIN
                (
                    SELECT user_id, COUNT(user_id) totalCount
                    FROM comments
                    GROUP BY user_id
                ) d ON d.user_id = u.user_id

                ORDER BY totalScore DESC LIMIT 25;"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:42:09.300

`LENGTH()`返回以字节为单位的字符串长度。你可能想要`CHAR_LENGTH()`，因为它会给你实际的字符。

```
SELECT user_id, review, COUNT(user_id) totalCount
FROM reviews
WHERE CHAR_LENGTH(review) > 100
GROUP BY user_id, review 
```

你也没有`GROUP BY`正确使用。

[请参阅文档](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:29:26.820

您想要的查询是：

```
LEFT JOIN
                (
                    SELECT user_id, COUNT(user_id) totalCount,
                           sum(case when length(review) > 100 then 1 else 0 end
                              ) as NumLongReviews
                    FROM reviews
                    GROUP BY user_id
                ) b ON b.user_id= b.user_id 
```

这包括评论和“长”评论。该计数是使用`case`嵌套在`sum()`函数中的语句完成的。

# css - 固定侧边栏固定在页眉和页脚之间

> ID：15032815
> 
> 赞同：0
> 
> 时间：2013-02-22T20:40:28.120
> 
> 标签：css

我有一个侧边`position:fixed`栏`height:100%`

然而，效果并不是我想要的。高度 100% 是窗口的 100%，因为我需要成为它的容器的 100%，它被限制在页眉和页脚之间。页眉也是固定的，因此主要内容在其“下方”滚动，同时页脚锚定在主要内容的底部，其高度取决于加载的内容量。

在这个[jsfiddle 中](http://jsfiddle.net/27U5n/)，我设置了`ul#toolBarList`要`200px`演示的高度。如果放大窗口并向下滚动，侧边栏应该占据整个空白高度。我并不是要简单地在列表后面设置背景，而是侧边栏的底部应该锚定到页脚的顶部。

要了解为什么 100% 不起作用，请设置`200px`并`100%`见证列表如何溢出页脚。

答案可以是一些简洁的 javascript，或者最好是与 IE8+、最新的 chrome/firefox 兼容的所有 CSS。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:51:51.310

您需要将其所有父元素的高度设置为 100%，或者只使用这个 CSS 而不是高度：

```
top: 0;
bottom: 0;
right: 0; //whichever side you want it on 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:52:42.360

100% 高度仅在父元素具有明确的高度集时才有效。您可以通过在 html 元素、body 元素和介于两者之间的任何其他容器元素上设置 100% 高度来实现 100% 高度。例如，

```
<html style="height: 100%;">
  <body style="height: 100%;">
    <div id="page" style="height: 100%;">
      <div id="sidebar" style="height: 100%; float: left;">content</div>
      <div id="main" style="height: 100%; float: left;">content</div>
    </div>
  </body>
</html> 
```

# sql-server-2008-r2 - 创建从 SQL Server 2008r2 到 Access 2003 的链接服务器

> ID：15032820
> 
> 赞同：1
> 
> 时间：2013-02-22T20:40:48.163
> 
> 标签：sql-server-2008-r2, ms-access-2003, linked-server

我在 ASP.NET 中编写了一个 Web 应用程序，它将所有数据存储在 SQL Server 2008r2 中，并通过存储过程运行所有内容。该应用程序正在为希望将 2-3 条数据推送到他们使用的具有 Microsoft Access 2003 后端（.MDB 文件）的旧应用程序的部门收集数据。我的想法是为 Access 创建一个链接服务器，这样我的应用程序就可以将所有内容推送到 SQL 服务器，并且可以从那里处理它（看起来很简单）。根据来自 MSDN 的信息（[此处](http://msdn.microsoft.com/en-us/library/ms190479%28v=sql.105%29.aspx)和[此处](http://msdn.microsoft.com/en-us/library/ff772782%28v=sql.105%29.aspx)），我使用以下 SQL 命令创建链接服务器：

```
EXEC sys.sp_addlinkedserver  @server = N'CMPtesting' , 
    @datasrc = N'\\srv.local\SHAREDOCS\MPS\CMPdata.mdb' ,
    @srvproduct = N'Access' , 
    @provider = N'Microsoft.Jet.OLEDB.4.0' 
```

这成功完成，我可以看到我的 CMPtesting 服务器列在`Server Objects -> Linked Servers`. 但是，如果我尝试使用此验证服务器：

```
SELECT name FROM [CMPtesting].master.sys.databases 
```

        甚至只是查看表格，我得到一个错误：

> **OLE DB 提供程序“Microsoft.Jet.OLEDB.4.0”不能用于分布式查询，因为提供程序配置为在单线程单元模式下运行。（Microsoft SQL Server，错误：7308）**

研究该错误导致我找到“ [SQL to Access 链接服务器](https://stackoverflow.com/questions/5873673/sql-to-access-linked-server)”，它建议安装一些不同的 Access 驱动程序，然后使用`@provider = N'Microsoft.ACE.OLEDB.12.0'`而不是 Jet 驱动程序。同样，这成功完成，但尝试查看表会产生不同的错误：

> **无法为链接服务器“CMPtesting”创建 OLE DB 提供程序“Microsoft.ACE.OLEDB.12.0”的实例。（Microsoft SQL Server，错误：7302）**

我知道这不仅仅是一个无效的驱动程序错误，因为如果我只是编造一个提供者名称，我会得到这个：

> **OLE DB 提供程序“foobar”尚未注册。（Microsoft SQL Server，错误：7403）**

我不确定还可以尝试什么，因为我的所有搜索都只是在`sp_addlinkedserver`没有任何其他详细信息或帮助解决这些错误的情况下对如何运行进行了更多重新散列。

# css - 如何阻止用户从其他元素中选择不可选择的元素？

> ID：15032822
> 
> 赞同：0
> 
> 时间：2013-02-22T20:41:01.213
> 
> 标签：css, selection, highlighting

我有一些带有图像的 div 来形成按钮。

我正在尝试使其全部无法选择，但是我的页面上还有一些其他 div 需要选择，并且我仍然可以从中选择禁用的 div。

使用您的标准禁用了不可选择的 div：

```
div#ControlsDiv {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

div#ControlsDiv * {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;                      
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:11:13.060

您尝试使用的技术似乎有点太简单了，猜猜看，它是：[https](https://developer.mozilla.org/en-US/docs/CSS/user-select#Browser_compatibility) ://developer.mozilla.org/en-US/docs/CSS/user-select#Browser_compatibility 。

基于此，我将立即停止使用它。

Div 显示/隐藏通常在 javascript 中完成，这里有一个关于如何在 javascript 和 jQuery 中完成的链接：

[在 Javascript 中启用和禁用 Div 及其元素](https://stackoverflow.com/questions/8423812/enable-disable-a-div-and-its-elements-in-javascript)

# python - Python中的每次激活“全局”变量？

> ID：15032824
> 
> 赞同：1
> 
> 时间：2013-02-22T20:41:04.347
> 
> 标签：python

这似乎是一件相当奇怪的事情，但我很好奇是否可以在 Python 中将变量**隐式传递**到调用链而不将其作为参数传递。为了更好地说明这里是一个例子：

*这是“正常”的方式：*

```
def three(something):
    print(something)

def two(something):
    # ...
    three(something)

def one(something):
    # ...
    two(something) 
```

*这就是我想要做的：*

```
def three():
    # something is defined implicitly
    print(something)

def two():
    # ...
    three()

def one(something):
    # somehow define something inside a context
    # for this activation 
    two() 
```

为此`one`，`two`和`three`不在同一类甚至同一模块中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:04:09.827

1.  你不想这样做。

2.  如果您真的确信要折磨自己，那么您可以创建一个单独的线程并`one()`在该线程中运行对的调用。然后只`threading.local`用于共享状态。

3.  你真的不想这样做。

以下是使用线程本地存储的方法：

```
import threading
state = threading.local()

def three():
    # something is defined implicitly
    print(state.something)

def two():
    # ...
    three()

def one(something):
    # somehow define something inside a context
    # for this activation
    def inner():
        state.something = something
        two()
    t = threading.Thread(target=inner)
    t.start()
    t.join()

if __name__=='__main__':
    one(42)
    one(24) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:54:23.277

如果必须，您可以为函数对象本身赋值。理想情况下，如果 'something' 设置不正确，three() 和 two() 都会执行会引发比 AttributeError 更好的异常的检查。

```
def three():
    print(three.something)

def two():
    three.something = two.something
    three()

def one(something):
    two.something = something
    two() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:08:54.760

您可以利用词法闭包 - 在 one() 的定义中定义 two() 和 three()。

```
>>> def one(something):
...     def two():
...         three()
...     def three():
...         print something
...     two()
...
>>> one(1)
1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:28:41.220

您可以使用`__builtins__`来保存“全局变量”。

```
>>> __builtins__.something = "Hello world!"
>>> def foo():
    print something

>>> foo()
Hello world! 
```

这可以帮助您避免显式传递变量。
这是一个可怕的黑客攻击。恕我直言，你真的不需要这样做。

# wcf - 为创建消息契约的 WCF 生成的代理

> ID：15032829
> 
> 赞同：0
> 
> 时间：2013-02-22T20:41:59.270
> 
> 标签：wcf, proxy

我正在我的项目中使用 WCF 服务，我已使用“添加服务引用...”为其添加了引用。我希望它生成一个带有 ServiceClient 实体和接口的干净代理。相反，我看到它为每个 OperationContract 方法创建了 MethodNameRequest、MethodNameRequestBody、MethodNameResponse、MethodNameResponseBody 实体。

因此，在调用服务方法时，代理将 MethodNameRequest 实例传递给服务方法，该方法的输入参数作为 RequestBody 的属性。请参阅下面的调用 AboutInformationGet() 方法的示例，该方法不接受任何参数。

```
 public WCFDynamicInvocation.PostingService.AboutModel AboutInformationGet() {
        WCFDynamicInvocation.PostingService.AboutInformationGetRequest inValue = new WCFDynamicInvocation.PostingService.AboutInformationGetRequest();
        inValue.Body = new WCFDynamicInvocation.PostingService.AboutInformationGetRequestBody();
        WCFDynamicInvocation.PostingService.AboutInformationGetResponse retVal = ((WCFDynamicInvocation.PostingService.IMIGQPosting)(this)).AboutInformationGet(inValue);
        return retVal.Body.AboutInformationGetResult;
    } 
```

我相信这种行为是人们期望在 Web 服务代理中看到的。因此我怀疑 WCF 服务没有正确配置。

这里有人遇到过这个问题吗？为了使生成的代理类似于 WCF 服务，该服务需要进行哪些更改。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:18:43.437

[这里](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/b9655eeb-cdbb-4703-87d8-00deac340173)有一个类似的帖子。

右键单击您的服务参考 -> 配置服务参考... -> 检查是否选中了“始终生成消息合同”复选框。取消选中它并点击 OK 以重新生成代理以查看您是否获得了正常的代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T22:48:54.577

经过一段时间的努力，我终于发现代理中的消息契约的原因是服务接口具有以下属性：

```
[XmlSerializerFormat(Use = OperationFormatUse.Literal, Style = OperationFormatStyle.Document)] 
```

据我了解，我可以使用以下属性装饰 DataContracts 以避免包装 [MessageContract(IsWrapped = false)]

但是响应仍然被包装，因为 OperationContract 没有被修改。

由于没有特别需要使用 XMLSerializer 代替 WCF 的默认 DataContractSerializer，我们将删除 XmlSeralizerFormat 装饰。

# c# - 如何正确使用图形

> ID：15032830
> 
> 赞同：0
> 
> 时间：2013-02-22T20:42:02.873
> 
> 标签：c#, .net, graphics

除了标准图形之外，我正在尝试使用更高级的图形。我的一个尝试是创建一些有用的控件——一个旋钮。我有一个包含 100 个旋钮的图像，其值为 1-100，在项目中，我将其拆分为一个***位图数组***，其中包含每个值 (1-100) 的位图。

这是旋钮对于某个值的样子，可以通过按住鼠标并向上/向下拖动来更改该值。

![旋钮](../Images/dbd58070490011a5ebbbc80f46ebf5be.png)

我的技术是每当值更改时，作为控件对象的旋钮的 BackgroundImage 属性将更改为位图数组中“值”索引中的图像。这意味着如果我有位图数组**X**、值**V**和旋钮**K**，那么`K.BackgroundImage = X[V]`. 每次更改值都会重复此操作。

**问题是：**当我在运行时增加/减少值时，旋钮在图像更改期间就像“闪烁”。这导致我认为我的技术不好，我想知道是否有更好的方法来做到这一点。

*旋钮的设计不是我的，只是在互联网上找到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:27:21.547

我将假设您有一个 UserControl 或某种 Control 派生子类。如果你不这样做，那就让它...

当您使用它时，请阅读这篇很棒的文章： http: [//www.codeproject.com/Articles/12870/Don-t-Flicker-Double-Buffer](http://www.codeproject.com/Articles/12870/Don-t-Flicker-Double-Buffer)

最重要的是，在覆盖中执行您的绘画`OnPaint`并在您的构造函数中执行以下操作：

```
 SetStyle(
        ControlStyles.UserPaint |
        ControlStyles.AllPaintingInWmPaint |
        ControlStyles.OptimizedDoubleBuffer, true); 
```

那应该可以解决您的闪烁问题。

# android - Eclipse 重新安装后，“Android SDK：管理附加站点”不会重新加载用户定义的站点

> ID：15032833
> 
> 赞同：0
> 
> 时间：2013-02-22T20:42:11.230
> 
> 标签：android, eclipse, add-on, failed-installation, hidden-files

我最近不得不完全重新安装 eclipse（例如从[http://www.android.com/](http://www.android.com/)安装的 androideclipse ）。在我重新安装之前，我碰巧使用了一个用户定义的附加站点（例如[https://broadcom-ble.googlecode.com/files/repository.xml](https://broadcom-ble.googlecode.com/files/repository.xml)）在重新安装之前一切都按预期工作。

重新安装后，当我尝试重新加载相同的加载项时，SDK Mgr 似乎接受了指针，但没有添加它。（进度条短暂启动然后消失，当我编译时，编译器找不到导入。）显然在重新安装之前我没有清除一些剩余状态。我已经删除、清理并重新启动了 androideclipse 安装七次，现在越来越挑剔首先删除所有可能的 eclipse 文件。

我已经删除了*所有*可以找到的 Eclipse 安装文件，包括 .eclipse、.android 和 .metadata。所以我怀疑周围肯定还有其他化石文件。

显然我错过了这么多的魔法。那里的某些大师是否知道必须删除以使机器“干净”的文件列表。是否有一些注册表项 - 肯定没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:39:34.037

用户定义的站点 ( [https://broadcom-ble.googlecode.com/files/repository.xml](https://broadcom-ble.googlecode.com/files/repository.xml) ) 库依赖于 Android 2.3.3( **API10** )，除非您已经在 SDK 管理器中*扩展*API10 以显示 API10 的子您不会看到新组件出现的组件。所以你坐下来沮丧地想知道为什么它没有加载。

明智的做法是确保他们在 SDK 主窗格中选择“按存储库打包/排序”。然后，当您完成指定用户定义站点并返回主 SDK 管理器面板时，新组件不会隐藏在未扩展的 API 级别下。

现在，当您检查新组件并单击安装时，会出现“许可对话框”，并提到它依赖于其他一些软件包（例如 Android 2.2\. API10 rev2），这是一个重要线索。

# php - 尝试从 PHP 进行删除 sql 查询时出现白屏

> ID：15032834
> 
> 赞同：1
> 
> 时间：2013-02-22T20:42:20.307
> 
> 标签：php, mysql, sql, sql-delete

我的屏幕是白色的，没有 php 错误，没有 sql 错误……只是白色的。我的代码有什么问题？

```
<?PHP  require ("../SQL.php");
if($id=filter_input(INPUT_GET, 'id', FILTER_SANITIZE_STRING)); else
$id = filter_input(INPUT_POST, 'id', FILTER_SANITIZE_STRING);
$editare = "SELECT marca, model FROM modele WHERE id={$id};";
foreach ($dbh->query($editare) as $linie)
{
$id                    = $linie['id'];
$marca                 = $linie['marca'];
$model                 = $linie['model'];
} ?>
<?php require ("../SQL.php");   

$editare = "DELETE FROM modele WHERE id=$id"; 

if ($dbh->query($editare)) 
{
 print '<center><h2><img src="http://bahoy.tk/images/ok.png"></img><br /><br   />Telefonul/Tableta este sters!</h2><br />
Vei fi redirectionat in cateva momente inspre adaugarea unui nou model de tableta sau  telefon!
<meta http-equiv="refresh" content="2; URL=index.php"/></center>'; 
}
else(mysql_error())     
?> 
```

我只想从`id`一个查询中删除所有指定的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:44:00.540

你在第 4 行有一个错误:) 改变这个：`$editare = "SELECT id, marca, model FROM modele WHERE id={$id};";`

你也忘了从桌子上`id`看`modele`

# java - JSF 中不同组件的 ManagedBeans

> ID：15032836
> 
> 赞同：0
> 
> 时间：2013-02-22T20:42:27.343
> 
> 标签：java, spring, jsf, jsf-2

我有一个关于在应用程序中使用 ManagedBeans 的问题。

我有一个页面，它作为不同的 JSP 组件，如 autoComplete、selectOneMenu、textarea、inputFields、datatable 等。

我为这些组件使用单独的服务类和 DAO，因为这些组件的实体类不同。

对于 ManagedBeans，我应该为一页的所有组件使用一个 ManagedBean，还是为不同的组件使用不同的 ManagedBean？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:02:23.727

由于单个页面上的组件很可能是高度耦合的，因此使用多个 managedbean 并没有真正的好处。但是，如果 bean 的一部分在多个页面中高度重复，您可能会考虑将其重构为[Composite Component](http://www.tutorialspoint.com/jsf/jsf_composite_components.htm)。

# sql - 在 DB2 中提取前一年的动态日期范围

> ID：15032842
> 
> 赞同：1
> 
> 时间：2013-02-22T20:42:51.560
> 
> 标签：sql, date, db2, ibm-midrange

我有两个当前的 SQL 查询，我目前使用它们来比较上一年的 GM% 和今年的 GM%。这是我每天早上运行的每日报告。日期算术不是很可靠，我正在尝试寻找替代方案。以前我认为该报告仅适用于周一，不包括当天（即如果在周二运行，它只会拉到周一。如果在周一运行，它不会拉任何东西。）最近已更改为 where when报告是周一跑的，他们想看周五到周日。我正在考虑将其设置为前 5 天，不包括当天。（周一跑会拉到周四、周五、周六、周日。）问题是它必须是今年的一天与去年的同一天进行比较。任何尝试过这个的人都知道，得到这个并不容易。这是我当前的日期算术代码。我很茫然，我可以使用一些帮助。

```
Where DB1.TB1.CLM1>=Current Date-364 days - (DAYOFWEEK(CURRENT DATE) - 2) DAYS 
      And DB1.TB1.CLM1< Current Date- 364 days 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:19:07.063

如果我没听错的话，周二你会提取周一的统计数据。周三，你会为周一至周二提供统计数据。周五，你拉周一至周四。对于所有这些，您需要与前一年相同的一天。

诀窍是现在星期一，你需要拉上一个周末，即周四至周日。

你还没有确定星期天要做什么，所以我不考虑这个情况。

试试这个 WHERE 语句：

```
where
   ( -- do this after Monday
   dayofweek(current date) > 2 and
   DB1.TB1.CLM1 between ((current date - 364 days) - (dayofweek(current date) - 2) days) and (current_date - 365 days)
   ) 
   or
   ( -- do this on Monday
   dayofweek(current date) = 2 and
   DB1.TB1.CLM1 between (current date - 368 days) and (current date - 365 days)
   ) 
```

# automation - Windows 和 Web 的自动化测试？

> ID：15032844
> 
> 赞同：0
> 
> 时间：2013-02-22T20:42:53.877
> 
> 标签：automation, functional-testing, windows-applications

我正在寻找一种检查以下功能的自动化测试工具：

1.  本地桌面上的 Windows 应用程序功能测试
2.  基于网络的功能测试
3.  无需编码，供没有编码经验的测试人员使用
4.  记录和运行对于 GUI 来说很容易，但是对于基于对象的测试，一些功能可以编写简单的单词而无需编码而没有语法问题

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T13:45:06.847

我会推荐 QTP，因为它无需任何编码即可使用。测试人员将只记录和回放记录的测试。

第四点不是很懂。我希望我的回答能有所启发，并为您指明正确的方向

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-14T17:26:03.927

TestComplete 是解决这个问题的方法。它的强项是您正在寻找的一切。还有 30 天的免费试用期和大量内容可让您快速上手。无需编码。[http://smartbear.com/products/qa-tools/automated-testing-tools/](http://smartbear.com/products/qa-tools/automated-testing-tools/)

# sql - 使用 Excel 2010 中的 DateTime 参数运行 SQL 查询

> ID：15032845
> 
> 赞同：0
> 
> 时间：2013-02-22T20:42:55.357
> 
> 标签：sql, oracle, excel

我正在使用 ODBC 连接 Excel 2010，我知道我们可以通过添加 [Blah Blah] 在 MS Query 中设置参数，并`?`在实际查询中添加。

但我不知道如何用 to_date 为数据时间做一个参数。

这是我的where子句。

```
where ("R"."TIME_STAMP">=TO_DATE ('03-02-2013 00:00:00', 'DD-MM-YYYY HH24:MI:SS') 
   AND "R"."TIME_STAMP"<=TO_DATE ('09-02-2013 23:59:59', 'DD-MM-YYYY HH24:MI:SS')) 
```

我不确定我需要什么信息，但这里是 time_stamp 字段的数据类型。

```
SQL> desc tablet
 Name                                      Null?    Type
 ----------------------------------------- -------- -----------------------
 TIME_STAMP                                         DATE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:24:12.830

我认为您只是在准备 SQL 查询并将其发送到 Oracle。我以为你在调用 Oracle 存储过程。

您的 where 子句应如下所示：

```
where ("R"."TIME_STAMP" between ? and ?) 
```

在 Excel 中，您需要一个单元格来输入日期或日期/时间（假设它是`A1`），然后是另一个带有公式的单元格`=TEXT(A1, "MM-DD-yyyy hh:mm:ss")`。这是在 MS Query 中链接到的单元格。重复第二个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-16T07:30:30.557

使用 excel 中的文本单元格将日期存储为`dd Mmm YYYY`（例如 2014 年 2 月 2 日）。

使用 MSQuery 中的参数选项 (?) 来引用文本单元格。

```
where ("R"."TIME_STAMP" between ? and ?) 
```

# java - 使用 Java switch 语句在特定 HTML 标记之间抓取文本

> ID：15032848
> 
> 赞同：0
> 
> 时间：2013-02-22T20:43:20.430
> 
> 标签：java, string, text, switch-statement, tokenize

我正在尝试获取`<AU></AU>`文件中标签之间的文本，然后在新行上打印出结果。我需要使用 switch 语句和一个名为 CharacterFromFileReader 的辅助类来执行此操作，该类一个一个地读取文件中的每个字符。

这是我到目前为止提出的代码：

```
package code;

import java.util.HashMap;

import util.general.CharacterFromFileReader;

public class HW4 {

String _toReturn = "";

public void authorScanner(String inputPath){
    CharacterFromFileReader reader = new CharacterFromFileReader(inputPath);

    int state = 0;

    while(reader.hasNext()){
        char c = reader.next();

        switch(state){
            case 0:
                _toReturn = "";

                if(c=='<'){
                    state = 1;
                }

            case 1:
                if(c=='A'){
                    state = 2;
                }

            case 2:
                if(c=='U'){
                    state = 3;
                }
            case 3:
                if(c=='>'){
                    state = 4;
                }
            case 4:
                if(c=='<'){
                    state = 5;
                }
                if(c != '<'){
                    _toReturn = _toReturn + c;
                    state = 4;
                }
            case 5:
                if(c=='/'){
                    state = 6;
                }
            case 6:
                if(c=='A'){
                    state = 7;
                }
            case 7:
                if(c=='U'){
                    state = 8;
                }
            case 8:
                if(c=='>'){
                    System.out.println(_toReturn);
                    state = 0;
                }
                else{
                    state = 0;
                }
        }   

    }
} 
```

}

但是，当我运行 authorScanner(test.xml); 时，我得到以下输出：

```
>
> 
```

下面是 test.xml 的内容：

```
<AU>AUTHOR</AU> 
```

我究竟做错了什么？我相信我已经设置了要搜索的 switch 语句`<AU>`，然后让它将以下字符附加到名为 _toReturn 的字符串中。由于它将字符附加到字符串，它应该检查字符 '<'，如果存在则继续检查结束标记`</AU>`。如果存在结束标记，则打印出 _toReturn。

有关如何编写适当解决方案的任何提示/建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:46:25.307

看起来您`break;`在 switch 中的每个 case 之后都缺少语句。如果你添加这些，它看起来可能会做你想要的。

# javascript - 从查询字符串中检索数字的最有效方法？

> ID：15032851
> 
> 赞同：2
> 
> 时间：2013-02-22T20:43:26.713
> 
> 标签：javascript, numbers, query-string, url-parameters, url-parsing

我需要解析同时包含文本和数字的查询字符串。例如以下查询字符串：

```
?userID=12&team=Sales&quarter=Q1&count=2310 
```

应翻译成以下 JavaScript 对象：

```
{
userID:12, // not "12"
team:"Sales",
quarter:"Q1",
count:2310 // not "2310"
} 
```

目前我分两步进行：

1.  解析查询字符串
2.  遍历所有参数并确定哪些是数字（使用正则表达式或 isNumber 函数`!isNaN(parseFloat(n)) && isFinite(n)`

这似乎相当低效，尤其是因为我的大多数参数都不是数字。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:57:44.320

你知道你要在哪里使用指定值吗？

因为如果您将任何数字格式的字符串（如“3239”）乘以 1，这将把该字符串转换为数字..

```
var example = 5 + (o.count*1) //o.count will be a number... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:48:23.630

两个建议：

1.  如果您知道哪些参数将保存数字，则只对那些参数进行转换
2.  据我所知，将字符串转换为数字的最快方法是对它们使用一元运算符，如下所示：

    +(strVar)

乘以 1 也应该是快速的 AFAIK

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:51:14.817

解析查询字符串后，您可以将整数值的这些字符串表示形式转换为实际整数，如下所示：

```
var obj; // your object that the string is parsed into, with all values as strings.
for (var prop in obj) {
    if (String(parseInt(obj[prop])) === obj[prop]) {
        obj[prop] = parseInt(obj[prop]);
    }
} 
```

# svn - SVN st：这些状态是什么意思？

> ID：15032852
> 
> 赞同：3
> 
> 时间：2013-02-22T20:43:31.413
> 
> 标签：svn

在我将一个主干合并到我的分支以获取最新更改后，我将我的分支合并到了主干。然后做了一个 snv st，这是让我困惑的输出的一部分：

```
R  +    path/to/dirA
M      path/to/dirB 
```

我还获得了我理解的添加目录的“A”状态。但我不明白的只是上面的状态，特别是这些目录没有进行任何更改。当我在其中一个目录上执行 svn diff 时，我得到了`Property changes on: path/to/dirA`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T06:14:24.107

`svn help status`其实真的很好。

我将粘贴相关的部分：

> ```
> First column: Says if item was added, deleted, or otherwise changed
>   ' ' no modifications
>   'A' Added
>   'C' Conflicted
>   'D' Deleted
>   'I' Ignored
>   'M' Modified
>   'R' Replaced
>   'X' an unversioned directory created by an externals definition
>   '?' item is not under version control
>   '!' item is missing (removed by non-svn command) or incomplete
>   '~' versioned item obstructed by some item of a different kind
> 
> Second column: Modifications of a file's or directory's properties
>   ' ' no modifications
>   'C' Conflicted
>   'M' Modified
> 
> Fourth column: Scheduled commit will contain addition-with-history
>   ' ' no history scheduled with commit
>   '+' history scheduled with commit
> 
> Seventh column: Whether the item is the victim of a tree conflict
>   ' ' normal
>   'C' tree-Conflicted 
> ```

因此，目录的第一个被替换为副本（或移动）。例如

```
svn rm path/to/dirA
svn cp path/to/someOtherDir path/to/dirA 
```

第二个可能是属性修改，因为它是一个目录，并且目录的第一列中不能有 M，因为这意味着对文本的修改。开始时似乎缺少一列，这可能是一个空格。

`svn diff`不太擅长显示树的变化，因为它默认以 unidiff 输出，没有提供指定树变化的方法。但是`svn diff --git`做得更好，因为 git 格式确实提供了指定树的更改。

鉴于您在合并后提出的问题，我猜您想知道这些合并是否成功。使用合并寻找的东西是冲突，它将在第一列、第二列或第七列中显示为 C。第一列是文本冲突，第二列是属性冲突，第七列是树冲突。

SVN 1.8 发布时还会在树修改状态下显示注释，如果它是移动的一部分，它将说明节点来自哪里或去哪里。

# javascript - 黑客在javascript中选择多个，flicke

> ID：15032855
> 
> 赞同：0
> 
> 时间：2013-02-22T20:43:47.970
> 
> 标签：javascript

根据我客户的规范，我已经用 javascript 破解了 html 的 <select multiple>：

*   单击一个项目*只会*切换*该*项目的选定状态。
*   其他选定的项目保持选中状态。

一点点 javascript 会记住所有选定的值。当用户点击时，只会选择他点击的选项。javascript 选择他记得的选项。

但是，它会导致闪烁效果。我怀疑是否有任何解决方案，但我觉得我不得不问一下，以防万一，有没有人知道延迟渲染的方法，或者任何其他解决方案来完成这个，没有闪烁？

此致。

编辑：这是代码

```
var choices=new Array();
function prepmulti(){
    var m=document.querySelectorAll('select');
    for(var i=0;i<m.length;i++)
        if(m[i].id!=''){
            m[i].onclick=toggle;
            choices.push(new Array());
        }
}
function toggle(){
    var sel, x;
    for(var i=0; i<this.options.length;i++)
        if(this.options[i].selected){
            sel=i;
            break;
        }
    if((x=choices[this.id].indexOf(sel))<0)
        choices[this.id].push(sel);
    else{
        choices[this.id].splice(x, 1);
        this.options[sel].selected=false;
        }
    for(i=0;i<choices[this.id].length;i++)
            this.options[choices[this.id][i]].selected=true;
}

<body onload='prepmulti();'> 
```

选择的倍数有 ids 0、1、2 等...如果你给他们其他 id，代码必须稍微修改一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:56:52.713

您看到的闪烁来自它更改选定的选项然后重新绘制 - 不幸的是，我认为这在大多数浏览器中是无法避免的。

在 Chrome 中，您可以绑定`onmousedown`选择、使用`preventDefault`，然后将 event 设置为与其相反`target`的`selected`内容。

```
var m=document.querySelectorAll('select');
for(var i=0;i<m.length;i++)
{
    m[i].onmousedown = function(e) {
        e.preventDefault();
        e.target.selected = !e.target.selected;
    };
} 
```

[http://jsfiddle.net/VDnQK/](http://jsfiddle.net/VDnQK/)

不过，这只适用于 Chrome。IE 支持 preventDefault for`select`但`e.target`返回`select`而不是`option`元素。FireFox 似乎不支持用于 select 的 preventDefault （至少，我无法让它工作）。

# com - 将 .net 用户控件转换为 COM 组件

> ID：15032860
> 
> 赞同：0
> 
> 时间：2013-02-22T20:44:02.623
> 
> 标签：com, user-controls, com-interop

我有一个**工作的 .net winform 用户控件**，想将其转换为 COM。我一直在努力寻找一种方法来将此用户控件转换**为启用 COM**（用于 VS6/C++6）。我不确定这是否可行？还是我必须考虑另一种方法？这是界面：

```
[ComVisible(true)]
[InterfaceType(ComInterfaceType.InterfaceIsDual)]
[Guid("C8BDB591-189D-4EB5-A026-7C9FFBEE3A85")]
public interface iMainInterface
{
    [DispId(1)]
    void ShowMyInterface();
} 
```

这是控制：

```
[ComVisible(true)]
[ClassInterface(ClassInterfaceType.None)]
[ComSourceInterfaces(typeof(iMainInterface))]
[Guid("F8D26781-5A97-4467-B732-7EAB1A04C3F2")]
public partial class MainInterface : UserControl
{
    public void ShowMyInterface()
    {
       ...
    }
 } 
```

错误消息似乎是针对**[ComSourceInterfaces(typeof(iMainInterface))]**

这是错误：错误 2 无法注册程序集“MyInterface.dll”。类型 'xxx.MainInterface' 不支持指定的默认 COM 接口：'xxx.iMainInterface' PerformReportControl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:20:02.650

[ComSourceInterfaces] 应该只用于生成事件的接口。它确实看起来 iMainInterface 没有任何事件，所以只需删除该属性。

你忘了让你的类继承接口。使固定：

```
[ComVisible(true)]
[ClassInterface(ClassInterfaceType.None)]
[Guid("F8D26781-5A97-4467-B732-7EAB1A04C3F2")]
public partial class MainInterface : UserControl, iMainInterface
{
    public void ShowMyInterface()
    {
       ...
    }
 } 
```

支持接口类型的大写 I（不是 i）。

# vb.net - 将 SqlParameters 添加到集合时，是否必须在 sql 参数名称前加上 @ 符号？

> ID：15032863
> 
> 赞同：1
> 
> 时间：2013-02-22T20:44:12.523
> 
> 标签：vb.net, sql-server-2008, parameters, sqlclient

在 VB.NET 中，我们添加了不带 @ 符号的 sql 参数，并且应用程序工作正常：

```
cmd.Parameters.Add("in_id", SqlDbType.Int).Direction = ParameterDirection.Input 
```

这个[页面](http://msdn.microsoft.com/en-us/library/yy6y35y8.aspx)说参数占位符的语法取决于数据源并`System.Data.SqlClient`使用格式中的命名参数`@parametername`。

我们正在从 Oracle 移植代码，并且同一页面说它`System.Data.OracleClient`使用 format 中的命名参数`:parmname (or parmname)`，这意味着不需要冒号。

该页面没有明确表示没有@符号的参数对于`Data.SqlClient`.

使用时，参数名称（输入或输出参数）前是否需要@符号`Data.SqlClient`？

# c - fscanf 计算“不可见”空格

> ID：15032865
> 
> 赞同：1
> 
> 时间：2013-02-22T20:44:16.213
> 
> 标签：c, input, matrix, scanf

我目前正在开发从 .txt 文件中获取信息并且需要将其存储在矩阵中的程序。当我只是打印文件时，我使用接下来的几行代码：

```
void read_maze(struct maze *mazePointer) {

FILE *fp;
fp = fopen("map1.txt", "r");

    int counter = 0;
    int column = 0;
    char mazeContent[99999];

    if(fp != NULL) {

        while (fscanf(fp, "%c", &mazeContent[counter]) == 1){

            int row = counter % 10;
            printf("%c", mazeContent[counter]);

            counter++;

            if (row == 9) {
                column ++;
            }               
        } 

        fclose(fp);
    }
} 
```

请注意，我还没有使用“行”和“列”变量，这纯粹是为了下一个例子！从这行代码中，我得到以下输出：

```
##########
#    #   #
# ##   #S#
# ########
#       E#
########## 
```

它看起来不错，但是一旦我将列和行变量添加到它们，我需要将它们存储在一个矩阵中，这就是为什么我需要正确拟合列和行，我得到以下输出。

```
#(0,0)#(0,1)#(0,2)#(0,3)#(0,4)#(0,5)#(0,6)#(0,7)#(0,8)#(0,9)
(1,0)#(1,1) (1,2) (1,3) (1,4) (1,5)#(1,6) (1,7) (1,8) (1,9)#(2,0)
(2,1)#(2,2) (2,3)#(2,4)#(2,5) (2,6) (2,7) (2,8)#(2,9)S(3,0)#(3,1)
(3,2)#(3,3) (3,4)#(3,5)#(3,6)#(3,7)#(3,8)#(3,9)#(4,0)#(4,1)#(4,2)
(4,3)#(4,4) (4,5) (4,6) (4,7) (4,8) (4,9) (5,0) (5,1)E(5,2)#(5,3)
(5,4)#(5,5)#(5,6)#(5,7)#(5,8)#(5,9)#(6,0)#(6,1)#(6,2)#(6,3)#(6,4) 
```

这不一样。正如您所注意到的，我的函数计算第 2 行开头的空间以及其余部分，而我的 .txt 文件中没有空间。它完全搞砸了一切，因为我无法在矩阵中的指定位置签署数字。有谁知道出了什么问题，因为不幸的是我找不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:39:33.650

从“fgets”while 循环开始就成功了！

```
 if(fp != NULL) {
            while (fgets(line, 12, fp) != NULL){

                for(int indexChar = 0; indexChar < 10; indexChar ++) {
                    printf("%c(%i)", line[indexChar], indexChar);
                }
                printf("\n");           
            } 
            fclose(fp);
    } 
```

输出：

```
#(0)#(1)#(2)#(3)#(4)#(5)#(6)#(7)#(8)#(9)
#(0) (1) (2) (3) (4)#(5) (6) (7) (8)#(9)
#(0) (1)#(2)#(3) (4) (5) (6)#(7)S(8)#(9)
#(0) (1)#(2)#(3)#(4)#(5)#(6)#(7)#(8)#(9)
#(0) (1) (2) (3) (4) (5) (6) (7)E(8)#(9)
#(0)#(1)#(2)#(3)#(4)#(5)#(6)#(7)#(8)#(9) 
```

# java - SQLite 数据库错误：未找到表 Android

> ID：15032867
> 
> 赞同：-2
> 
> 时间：2013-02-22T20:44:24.053
> 
> 标签：java, android, database

尝试创建数据库时出现此错误：错误消息在此处输入代码 02-23 02:08:46.780: E/Database(32721): Error inserting email=af contact=38 dob=1/8/68 name=ex 02-23 02:08:46.780: E/Database(32721): android.database.sqlite.SQLiteException: 没有这样的表: 配置文件: , 编译时: 插入配置文件 (电子邮件、联系人、出生日期、姓名) 值 (?, ?, ?, ?); 02-23 02:08:46.780: E/Database(32721): atandroid.database.sqlite.SQLiteCompiledSql.native_compile(Native Method) 02-23 02:08:46.780: E/Database(32721): at

```
package a.vaccination;

import android.content.ContentValues;
import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class datahandler {

public static final String KEY_ROWID = "id";
public static final String KEY_name = "name";
public static final String KEY_dob = "dob";
public static final String KEY_contact = "contact";
public static final String KEY_email = "email";
private static final String TAG = "DBAdapter";

private static final String DATABASE_NAME = "profile";
private static final String DATABASE_TABLE = "profiles";
private static final int DATABASE_VERSION = 2;

private static final String DATABASE_CREATE
 = "create table  (id integer primary      keyautoincrement, "
 + "name VARCHAR not null, dob date, contact VARCHAR, email VARCHAR);";
private final Context context;

private DatabaseHelper DBHelper;
private SQLiteDatabase db;

public datahandler(Context ctx) {
    this.context = ctx;
    DBHelper = new DatabaseHelper(context);
}

protected static class DatabaseHelper extends SQLiteOpenHelper {
    DatabaseHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        try {
            db.execSQL(DATABASE_CREATE);
            //db = DBHelper.getWritableDatabase();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
    + newVersion + ", which will destroy all old   data");
        db.execSQL("DROP TABLE IF EXISTS contacts");
        onCreate(db);
    }
    }

// ---opens the database---
public datahandler open() throws SQLException {
    db = DBHelper.getWritableDatabase();
    return this;
}

// ---closes the database---
public void close() {
    DBHelper.close();
}

// ---insert a record into the database---
public long insertRecord(String name, String dob, String contact,
        String email) {
    ContentValues initialValues = new ContentValues();
    initialValues.put(KEY_name, name);
    initialValues.put(KEY_dob, dob);
    initialValues.put(KEY_contact, contact);
    initialValues.put(KEY_email, email);
    return db.insert(DATABASE_TABLE, null, initialValues);
}

// ---updates a record---
public boolean updateRecord(long rowId, String name, String dob,
        String contact, String email) {
    ContentValues args = new ContentValues();
    args.put(KEY_name, name);
    args.put(KEY_dob, dob);
    args.put(KEY_contact, contact);
    args.put(KEY_email, email);
    return db.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T08:36:42.397

您的查询不正确：

*   您缺少表名
*   您在键和自动增量之间缺少空格

所以纠正它如下：

```
String DATABASE_CREATE = "create table TableName(id integer primary key autoincrement, "
+ "name VARCHAR not null, dob date, contact VARCHAR, email VARCHAR)"; 
```

现在它将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T08:32:53.090

请在此处尝试使用表名

```
private static final String DATABASE_CREATE
 = "create table TABLENAME (id integer primary key autoincrement, "
 + "name VARCHAR not null, dob date, contact VARCHAR, email VARCHAR);"; 
```

这似乎是背后的原因

> 没有这样的表：profiles

# c# - 如何在 C# 中写入 Dock 内容

> ID：15032868
> 
> 赞同：0
> 
> 时间：2013-02-22T20:44:26.890
> 
> 标签：c#, dock, dockpanel

有一个`DockPanel`，当我练习此代码时，它会将停靠内容添加到正确的 Dock 但我无法让它显示文本（即执行 Step1 和 Step2 等，如下所示）。我做了很多研究，没有任何工作。在此先感谢您的帮助。

```
public void ShowInstructionForm()
{
    dragDropForm = new DockContent();
    dragDropForm.Name = "Hints";

    dragDropForm.TabText = "Hints2";
    dragDropForm.ShowHint = DockState.DockRight;
    dragDropForm.BackColor = Color.White;
    dragDropForm.Text = "- Perform the step number 1 ."
        + Environment.NewLine + " - Perform the Step number 2";                                     

    try
    {
        dragDropForm.Show(this.oDock.MainDock);
    }
    catch (Exception e)
    {
        MessageBox.Show(this.oDock.MainDock, "error happened  " + e.Message);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:12:59.413

就个人而言，我会使用数据绑定来实现您想要的，以便您坚持更严格的设计模式。

**XAML**

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525"
    DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <DockPanel>
        <TextBlock Text="{Binding Path=Foo}" />
    </DockPanel>
</Window> 
```

**C＃**

```
public partial class MainWindow : Window
{
    public string Foo { get; set; }

    public MainWindow()
    {
        Foo = "hello world"; // Changing Foo 'automagically' changes your textblock value
        InitializeComponent();
    }
} 
```

通过将业务逻辑与 UI 代码分开，您可以更加灵活。显然，这只是一个在停靠面板中使用文本块进行数据绑定的示例，但希望这能让您更好地理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:21:18.403

你能像这样进入 xaml 并在 DockPanel 中放置一个文本块：

```
<DockPanel>
  <TextBlock Text="- Perform the step number 1 ."/>
</DockPanel> 
```

# android - 以编程方式创建多行 EditText

> ID：15032870
> 
> 赞同：27
> 
> 时间：2013-02-22T20:44:28.837
> 
> 标签：android, android-edittext, multiline

我正在尝试通过代码创建多行 EditText。这就是我使用的：

```
EditText txt = new EditText(this);    
lp = new LinearLayout.LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT, 1.0f);
txt.setLayoutParams(lp);
txt.setSingleLine(false); 
txt.setInputType(InputType.TYPE_TEXT_FLAG_MULTI_LINE); 
```

但它仍然在一行中。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-05-09T10:38:11.977

这应该这样做

```
txt.setSingleLine(false);
txt.setImeOptions(EditorInfo.IME_FLAG_NO_ENTER_ACTION); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-09-19T12:26:10.070

你也可以使用这个：

```
txt.setInputType(InputType.TYPE_CLASS_TEXT|InputType.TYPE_TEXT_FLAG_MULTI_LINE); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-03-15T14:36:45.883

结合以上所有答案是正确的答案，所以这里是：

```
texInput.setSingleLine(false);
texInput.setImeOptions(EditorInfo.IME_FLAG_NO_ENTER_ACTION);
texInput.setInputType(InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_FLAG_MULTI_LINE);
texInput.setLines(5);
texInput.setMaxLines(10);
texInput.setVerticalScrollBarEnabled(true);
texInput.setMovementMethod(ScrollingMovementMethod.getInstance());
texInput.setScrollBarStyle(View.SCROLLBARS_INSIDE_INSET); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-22T20:51:07.983

将其包含在您的代码中：

```
txt.setLines(maxlines); 
```

maxlines 将是您希望在 EditText 中允许的最大行数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-27T16:39:21.017

最终对我有用的组合是：

```
answerView.setInputType(InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_LONG_MESSAGE);
answerView.setSingleLine(false); 
```

至少部分我`setInputType`用于配置几个不同的选项，因此它比其他一些可能性更有意义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-19T09:50:39.103

在我的手机上，更改 imeOptions 和 inputType 没有任何作用；设置 moveMethod 和/或 scrollBarStyle 会严重影响组件，以至于用户将无法选择任何文本；isVerticalScrollBarEnabled 和 isHorizo​​ntalScrollBarEnabled 什么都不做；我能做的最好的就是使用

```
txt.setSingleLine(false); 
```

（`txt.setImeOptions(EditorInfo.IME_FLAG_NO_ENTER_ACTION);`似乎是不必要的）但这不会在该死的 EditText 中显示任何滚动条。最终我放弃了，只要我需要一个多行的 EditText，我就会膨胀一个布局片段。这是布局：

```
<?xml version="1.0" encoding="utf-8"?>
<EditText xmlns:android="http://schemas.android.com/apk/res/android"
android:inputType="textMultiLine"
android:lines="4"
android:minLines="4"
android:gravity="top|start"
android:maxLines="4"
android:layout_height="wrap_content"
android:layout_width="fill_parent"
android:scrollbars="vertical"
/> 
```

这是 Anko 片段：

```
fun ViewManager.multiLineEditText(@StyleRes theme: Int = 0, init: EditText.() -> Unit): EditText = ankoView(
    { ctx -> ctx.layoutInflater.inflate(R.layout.util_multilineedittext, this@multiLineEditText as ViewGroup, false) as EditText }, theme, init) 
```

Android 开发太难了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-22T20:51:18.313

试试这个

```
txt.setLines(number of lines); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-17T11:43:38.337

除了上述建议之外 - 如果您无法使其正常工作，您可能需要设置以下附加参数

```
texInput.setHorizontallyScrolling(false);
texInput.setHorizontalScrollBarEnabled(false); 
```

如果您正在以编程方式更改编辑文本的高度，那么您可能还想通过调用 requestLayout() 来请求布局。

# ssis - 在ssis中获取excel文件名

> ID：15032872
> 
> 赞同：0
> 
> 时间：2013-02-22T20:44:40.333
> 
> 标签：ssis

我想知道是否有人可以帮助我在 ssis 的目标数据库中获取 excel（源）文件名。数据库表有一个名为 filename 的列（等于 excel 文件名）。拥有文件名将帮助我进行审计。注意：我不是 vb 脚本人，但如果 vb 是唯一的出路，我会很感激示例脚本，因为我必须在我的逻辑中使用它。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:12:39.533

您可以使用“派生列”组件并添加一个包含所需属性的新列。我猜您想添加一个派生列，该列将存储 Excel 连接的“文件名”或“连接字符串”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T23:51:40.893

出于多种原因，我建议将文件保存为 CSV。如果它是 CSV 文件，您可以为其创建平面文件源。然后右键单击该项目并转到“显示高级编辑器...”单击“组件属性”选项卡并转到底部的“自定义属性”。有一个名为“FileNameColumnName”的字段。对于值，输入您要在其中存储文件名的列的名称。然后，该字段将可用于您的目的地。

[http://sqlblog.com/blogs/jamie_thomson/archive/2010/03/31/filenamecolumnname-property-flat-file-source-adapter-ssis-nugget.aspx](http://sqlblog.com/blogs/jamie_thomson/archive/2010/03/31/filenamecolumnname-property-flat-file-source-adapter-ssis-nugget.aspx)

# javascript - 根据百分比从一个 rgba 运行到另一个

> ID：15032873
> 
> 赞同：1
> 
> 时间：2013-02-22T20:44:41.343
> 
> 标签：javascript, jquery

假设我有这两个 rgba 代码：

**rgba(150, 160, 255, 1)**和**rgba(195, 0, 0, 1)**

我想以 0/100 的百分比从一个传递到另一个。

0% 将是**rgba(150, 160, 255, 1)**

100% 将是**rgba(195, 0, 0, 1)**

我正在尝试用这个制作热图。

我如何确定 rgba 将是什么让说...... 30％！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:47:49.037

对于代码中的每个值`x`：

```
x = min_x + (max_x - min_x)*percentage/100 
```

（注：`max_x`可以小于`min_x`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T20:49:31.763

对于每个组件，您只需要做`start+(end-start)*percentage`

因此，对于您的 30%，您将拥有：

```
red = 150 + (195 - 150) * 0.3 = 205.5
green = 160 + (0 - 160) * 0.3 = 112
blue = 255 + (0 - 255) * 0.3 = 178.5
alpha = 1 + (1 - 1) * 0.3 = 1 
```

因此，您的最终颜色将是`rgba(206, 112, 179, 1)`

# statistics - 测试新方法需要多大的测试样本量？

> ID：15032880
> 
> 赞同：0
> 
> 时间：2013-02-22T20:45:15.980
> 
> 标签：statistics, evaluation

我开发了一种新的图像分割技术，现在我想评估它的性能。我想知道我需要多少样本来执行评估？换句话说，测试样本集有多大才足以评估新方法？有什么理论支持吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:15:11.870

有标准的计算机视觉数据集可以对分割进行基准测试。示例：[http](http://www.eecs.berkeley.edu/Research/Projects/CS/vision/bsds/) ://www.eecs.berkeley.edu/Research/Projects/CS/vision/bsds/ 您必须报告您的算法在这些方面的执行情况。考虑到世界上所有可能的图像的数量非常大，这些将构成一个很好的样本。;-)

# windows - 在 8 个通道上独立播放多首歌曲

> ID：15032882
> 
> 赞同：1
> 
> 时间：2013-02-22T20:45:17.433
> 
> 标签：windows, audio

如何在 USB 7.1 声卡上播放多个歌曲文件，每个文件都在特定频道中？计算机规格为： 4gb ram Windows 2003 Server Proc Intel Xeon x3430

它没有内置声卡，我无法安装。

这个想法是有 8 个播放列表，每个播放列表都将在声卡上的自己的频道上播放。

# java - 无法为 JBoss Web 2.1.9.GA 配置 Eclipse 服务器运行时

> ID：15032885
> 
> 赞同：0
> 
> 时间：2013-02-22T20:45:21.957
> 
> 标签：java, eclipse, jboss-web

我在本地 Eclipse 安装中使用本地 JBoss Web 2.1.9.GA 实例作为服务器运行时环境时遇到问题。

我们的客户端使用 JBoss Web 2.1.9.GA 而不是标准的 Tomcat 6 安装，因此我需要使用本地 JBoss Web 2.1.9.GA 实例进行测试和调试。现在，我知道 JBoss Web 只是 Tomcat 6 的一个更名且仅稍作修改的版本，但是当我尝试使用“Apache > Apache Tomcat v6.0”服务器运行时作为我的选择时，然后选择服务器基础文件夹在我的机器上，我在对话框顶部收到以下错误：

此目录中的 Apache Tomcat 安装版本为 2.1.9.GA。预计安装 Tomcat 6.0。

我不确定如何让它工作，因为它打算在这一点上工作；似乎没有任何选项可以接受 JBoss Web 2.1.9.GA 服务器文件夹。关于在 Eclipse 中使用 JBoss Web 的在线信息似乎也几乎为零。

对于上下文，我在运行 OS 10.7.4 的 MacBook Pro 上使用 SpringSource Tool Suite v2.9.2.RELEASE 预打包的 Eclipse 安装。不过*没关系*，java 就是 java，Eclipse 就是 Eclipse，是吗？

有没有人有这方面的经验和运气？

汤姆哈里斯

（我在 2 月 22 日发布了这个问题，但在 3 月 5 日仍然没有答案，所以我附上了这个注释并稍微改写了这个问题。）

# java - java中带有注释的简单servlet（图像文件夹）

> ID：15032892
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:10.447
> 
> 标签：java, servlets

我在 webContent/images 上有一个包含图像的文件夹。我只想知道如何在网上提供这个文件夹。

在我的项目中，我只有一个带有注释的 servlet：

```
@WebServlet(urlPatterns = { "/" })
public class IndexCtrl extends HttpServlet { 
```

每次我尝试获取图像时，此 servlet 都会获得优先权并发送索引页面。如何在网络上提供图像文件夹？我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:55:55.400

只是不要将 servlet 映射到`/`. 这使它成为默认的 servlet，它捕获所有请求。将其映射到它必须处理的 URL（`/index.html`例如）。

# deployment - 部署 MVC4：System.IO.FileNotFoundException

> ID：15032893
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:17.373
> 
> 标签：deployment, asp.net-mvc-4, dependencies, asp.net-web-api

我非常基本的 .Net 4.5 MVC4 Web Api 应用程序在我的开发机器上的 IIS 上运行良好，但是当我尝试在没有安装 Visual Studio 的生产机器上部署和运行时，我收到以下消息：

> 无法加载文件或程序集“Microsoft.Web.Infrastructure，Version=1.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。

服务器正在运行带有 IIS7 的 Windows Server 2008 R2，并且安装了 .Net 4.5。

我在项目中安装了大量的 NuGet 包，这些包直接来自 MVC4 Web Api 项目模板，包括 Microsoft.Web.Infrastructure。我的项目没有引用它，但似乎是依赖项的依赖项，或者其他什么。

[我在https://stackoverflow.com/a/9593577/326110](https://stackoverflow.com/a/9593577/326110)上读到，由于它使用 NuGet（至少他们在谈论使用 NuGet 的 MVC3）它应该自动是可部署的，所以我不知道该去哪里从这里。

如果我手动将 Microsoft.Web.Infrastructure.dll 从我的 NuGet 包文件夹复制到服务器上的 bin 文件夹，它可以工作，但显然这似乎不是正确的方法:(

# android - 安卓早期版本如何实现setVideoScalingMode

> ID：15032894
> 
> 赞同：6
> 
> 时间：2013-02-22T20:46:18.403
> 
> 标签：android, android-mediaplayer

MediaPlayer.setVideoScalingMode（int 模式）非常适合 API 16 及更高版本，允许在 和 之间进行`VIDEO_SCALING_MODE_SCALE_TO_FIT`选择`VIDEO_SCALING_MODE_SCALE_TO_FIT_WITH_CROPPING`。

有没有办法在 API 16 之前为 Android 实现相同的功能？

我试图设置`SurfaceView`MediaPlayer 使用的尺寸，但 MediaPlayer 会裁剪原始视频以适合`SurfaceView`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-02T13:08:48.537

面对同样的问题，通过这篇文章获得解决方案 [http://blog.lemberg.co.uk/surface-view-video-cropping](http://blog.lemberg.co.uk/surface-view-video-cropping) 但有一点点改变：默认情况下，TextureView 已经具有缩放以使视频适合屏幕纵横比，所以你会得到高/宽视频的左/右或上/下条纹。当您使用文章中的方法时，您将获得 TextureView 比例 + 由 updateTextureViewSize 计算的比例，因此比例非常大。我对这个问题的解决方案是计算相对比例值：

```
float div = Math.max(scaleX,scaleY)-Math.min(scaleX, scaleY);
matrix.setScale(1+div,1+div,pivotPointX,pivotPointY); 
```

代替

```
 matrix.setScale(scaleX, scaleY, pivotPointX, pivotPointY); 
```

# svn - Capistrano - 确保我的服务器可以访问存储库

> ID：15032896
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:23.377
> 
> 标签：svn, deployment, tortoisesvn, capistrano

我正在通过教程[使用 Capistrano 设置我的部署](https://github.com/capistrano/capistrano/wiki/2.x-from-the-beginning)。步骤之一是：

> 我们需要告诉 Capistrano 我们的源代码在哪里。这是您的应用程序的存储库地址，默认情况下，您的本地计算机（您将部署的位置）和生产服务器（您将部署到的位置）都可以访问它。

我的存储库托管在[http://beanstalkapp.com/](http://beanstalkapp.com/)上 ，我通过本地机器上的 Tortoise SVN 访问它。所以我想这意味着我的本地机器可以访问存储库。但是，我对如何确保我的生产服务器可以访问该存储库感到困惑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:15:26.850

您只需要使用 SVN 凭据（显然还有 svn 包）配置您的生产机器，即可从您的 SVN 存储库中签出，无论它托管在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T20:56:59.450

“为了能够部署，您的服务器需要能够访问您的存储库” - [https://help.github.com/articles/deploying-with-capistrano](https://help.github.com/articles/deploying-with-capistrano)

如何连接到存储库 - [https://help.github.com/articles/managing-deploy-keys](https://help.github.com/articles/managing-deploy-keys)

也有助于理解 ssh 代理转发 - [http://www.unixwiz.net/techtips/ssh-agent-forwarding.html](http://www.unixwiz.net/techtips/ssh-agent-forwarding.html)

# wpf - WPF 和 Windows 8 中列表框的触摸/鼠标事件行为

> ID：15032898
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:29.400
> 
> 标签：wpf, vb.net, windows-8, mouseevent, touch-event

尝试在 Windows 8 机器上的列表框中同时处理鼠标和触摸输入时，我得到了我认为的意外行为（因为它不同于在 Windows 7 上运行相同的软件）。

这是我处理事件的函数/方法

```
Private Sub Drag_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Input.InputEventArgs) Handles lvItems.PreviewMouseDown, lvItems.PreviewTouchDown 
```

当我让它同时处理鼠标和触摸输入时，（`PreviewTouchDown`和`PreviewMouseDown`）它将接收两个事件（触摸事件和鼠标按钮事件），即使我为首先引发的事件设置`event.Handled = True`了。`TouchEventArgs`

如果我从事件处理程序中删除对 PreviewTouchDown 事件的处理，我将不会收到 PreviewMouseDown 事件。

我需要的是每次触摸/点击只调用一次该方法。我无法删除 PreviewMouseDown，因为它不仅用于触摸屏。单次触摸同时传递触摸事件和鼠标事件会破坏我们的功能。

在 Windows 7 上，我只接收到触摸事件，因为我设置了handled=true，所以鼠标事件被取消了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T21:41:25.163

在 Windows 8 上，触摸事件可以升级为鼠标事件。这有时很方便，因为它允许我在 Win8（不是在 Win7 下）中使用触摸打开一个组合框，但有时这是不受欢迎的，正如您也发现的那样。另请参阅[JoshB 的文章](http://nui.joshland.org/2010/04/why-wont-wpf-controls-work-with-touch.html "JOSHB的文章")以获得更准确的解释。

就我而言，我在鼠标事件处理程序中检查了 e.StylusDevice == null （在处理鼠标时，它是 null，而不是在处理触摸事件时）。也许这对你也有帮助？

例如，我制作了一个 ZoomGrid，它既可以听鼠标也可以听触摸。在 Windows 7 下，没有问题，但在 Windows 8 下，触摸移动后也触发了平移行为。检查 e.StylusDevice != null 修复了它。

```
 private void MainGridMouseMove(object sender, MouseEventArgs e)
    {
        if (e.LeftButton != MouseButtonState.Pressed) return;
        if (!isDraggingBackground || e.StylusDevice != null) return;
        var curPosition = e.GetPosition(sender as UIElement);
        var delta = curPosition - startPosition;
        var rectsMatrix = ((MatrixTransform)RenderTransform).Matrix;
        rectsMatrix.Translate(delta.X, delta.Y);
        Offset = new Point(rectsMatrix.OffsetX, rectsMatrix.OffsetY);
        RenderTransform = new MatrixTransform(rectsMatrix);
        e.Handled = true;
    } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-24T13:19:40.797

我为解决这个问题所做的是检测计算机是否运行 Windows 8，如果是，则不设置`Handled`，以便不会发生与鼠标相关的事件。

```
If Not My.Computer.Info.OSFullVersion.Contains("Windows 8") Then
    e.Handled = True
End If 
```

# sql - 在查询中的某些值之前添加文本

> ID：15032899
> 
> 赞同：1
> 
> 时间：2013-02-22T20:46:34.493
> 
> 标签：sql, ms-access

我正在为一个班级建立一个婚礼数据库，目前有一个费用表。该表显示费用标签（鲜花、摄影师、乐队......）和付款到期日（除其他外）。我还有一张单独的桌子用于其他任务（询问新娘派对，发送邀请......）。

我目前有一个联合查询，它将两个表组合成一个“待办事项列表”。这是查询的sql：

```
SELECT Expense AS Task, DateDue, tblExpenses.[Paid?] AS [Completed?]
from tblExpenses
UNION SELECT Task, DateDue, tblToDoList.[Completed?]
from tblToDoList; 
```

我的问题是按计划组合的最终列表，但该列表在“任务”标题下具有诸如“鲜花”之类的值。我希望能够在来自费用表的值之前添加“支付”或“已支付”，以便它读起来像谓词而不是主题。有没有办法做到这一点？

抱歉，如果这有任何令人困惑的地方。我对 SQL 的了解非常有限，我不确定如何准确地表达所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:51:44.267

怎么样 .. ？

```
SELECT Expense AS Task, DateDue, 
       IIf(tblExpenses.[Paid?]=True,"Paid","Pay For") AS [Completed?]
FROM tblExpenses
UNION 
SELECT Task, DateDue, tblToDoList.[Completed?]
FROM tblToDoList; 
```

如果paid 为真（是），查询将返回“Paid”，否则将返回“Pay for”。

重新评论

```
SELECT "Paid " & Expense AS Task, DateDue, 
       tblExpenses.[Paid?] AS [Completed?]
FROM tblExpenses
UNION 
SELECT Task, DateDue, tblToDoList.[Completed?]
FROM tblToDoList; 
```

# javascript - 按计划将 html 页面打印为 PDF

> ID：15032901
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:45.887
> 
> 标签：javascript, html, pdf, automatic-storage

我有一个 HTML 页面，它使用 javascript 在不同的服务器上使用图形处理程序生成动态图像。图像将包含 1 周的相同数据，但会在 1 周窗口到期时更改。

我正在尝试想出一种方法来自动将页面内容保存到服务器上的本地文件或写入 PDF 文件。

我尝试使用 HTTTrack 之类的“网络下载器”，但它没有获取动态图像...

我在 IIS 上运行 html 页面。

我没有使用 IIS 或 ASP 的经验。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:04:07.847

我不确定我是否有任何方法可以自动从前端直接执行此操作。挑战在于，您出去抓取网站的任何“屏幕抓取工具”都需要运行 javascript 才能获取表格，这不是我看到的许多此类系统的运行方式。当您拥有一个大量使用 javascript 或 flash 增强的网站时，您会在 Archive.org 上看到奇怪的部分原因。

您可能会尝试的未经测试的概念已发布[在此堆栈问题中](https://stackoverflow.com/questions/5667880/simple-screen-scraping-using-jquery)

我可以看到某种系统，您可以将其与另一台计算机一起安装，该计算机会安排浏览器加载，然后以某种方式打印到 .pdf。我一直找不到任何可以使该过程自动化的特定软件，因此您只能自己拼凑这样的系统。

显然，您拥有可用于制作动态图像的数据。我能想到的功能最丰富的方法是使用像 Jasper Reports 或 Crystal Reports 这样的系统，您可以提供数据、复制报告并通过 pdf 轻松输出，这是两个系统中的内置导出。

也许值得质疑您的最终目的。对我来说，在另一个表中创建相关数据的“快照”并使用另一个系统从该快照数据中呈现您的图表似乎比仅打印屏幕更有价值。然后，您可以根据需要返回并调整数据，或将其用于其他报告目的，在任何数量的工具中导出，甚至像 Access 一样简单。哎呀，10 年后，您可能希望数据看起来比您当前使用的图形系统更好，并且您将拥有数据以任何您想要的方式呈现它。当营销副总裁来寻找他的数字时，只需单击一下即可输出可以根据需要从那里操纵的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T19:17:48.493

[我能够使用wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)将我的带有 Javascript 的 HTML 页面转换为 PDF来完成我想做的事情。我通过任务调度程序运行该作业，以提供我的网站 url 和输出文件名作为参数。

然后，我使用 Windows 批处理文件检查文件是否已创建，然后将其重命名/通过电子邮件发送给感兴趣的各方。

这当然要求您能够在您的服务器上安装 wkhtmltopdf。

# eclipse - 在eclipse上将新版本的WAR部署到tomcat上

> ID：15032903
> 
> 赞同：0
> 
> 时间：2013-02-22T20:46:48.777
> 
> 标签：eclipse, maven, tomcat, jar, war

所以我在eclipse和tomcat 6上遇到了这个问题。

我可以使用服务器（tomcat 6）->添加资源，添加所有内容来上传我对 eclipse 的战争的第一个版本。

但是后来我尝试编辑一些行，然后以 maven clean->run as maven install 运行，然后清理，清理 tomcat 工作目录，然后重新启动服务器，它不会向我显示反映的更改。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:54:20.607

您清理了应用程序并执行了安装，但似乎您没有正确执行构建。确保您正在生成一个新的战争文件（查看它的生成日期以确保您正在部署最后一个版本）。如果你的项目有很多模块，例如：war 和 jars。确保你也构建了 jars，并且这些 jars 在 tomcat/libs 文件夹或 WEB-INF/libs 中被替换，检查依赖 jars 的生成日期，然后你可以看到差异。

此致。

# java - 如何将多个 Java 项目部署到同一个 Azure 云服务和存储帐户？

> ID：15032906
> 
> 赞同：1
> 
> 时间：2013-02-22T20:47:03.970
> 
> 标签：java, eclipse, azure

我刚刚开始学习 Azure，所以我希望这似乎是一个基本问题。使用 Eclipse（以及带有 Java 的 Windows Azure 插件）我首先编写了一个基本的 JSP (html) 文件，该文件只是在浏览器中显示一些文本。

第一个项目的部署很顺利。它在存储和计算模拟器中按预期运行，很好地部署到我添加到 Azure 的新云服务和存储帐户中，在暂存和生产中运行良好。我在包中部署了 JDK 和应用服务器。

我在 Eclipse 中创建了第二个项目，与第一个项目相同，只是项目和应用程序名称不同。该软件包还包括 JDK 和应用程序服务器。在模拟器中工作正常，但是当我尝试部署到现有的 Azure 云服务和存储帐户时，它失败了。

…</p>

上传部署包 - 100% 完成

2013 年 2 月 22 日 12:29:45 - 创建部署

2013 年 2 月 22 日 12:29:47 - 失败：HTTP 错误代码：409 冲突

不能将多个项目部署到同一个云服务和存储帐户吗？

第一个应用程序仍在云中运行。

谢谢

答案摘要马丁的回答为我解决了这个问题。尽管当我尝试发布到现有云服务时 Eclipse 没有显示消息，但我能够取消发布现有云服务，然后按预期发布到登台，然后再发布到生产环境。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:40:39.980

我不这么认为，当您将第二个项目发布到同一个云服务时，Eclipse 会要求您取消发布您的第一个项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T23:10:37.863

如果您要发布同一服务的较新版本，则只需单击工具栏上的取消发布按钮（在发布旁边）即可首先删除您之前的部署。

如果您有意发布一个完全不同的应用程序，除了您已经发布的应用程序之外，您还需要在发布对话框中为其创建一个新服务，而不是再次选择相同的服务（默认情况下会发生这种情况） ）。

如果您只是将另一个 WAR 添加到同一个容器安装（Tomcat 等），那么在 Eclipse Azure 项目中执行此操作，然后重新发布 - 这相当于在同一个服务中发布相同的部署（所以你需要取消发布上一个）。

# spring - 为spring中的junit休眠测试加载应用程序上下文

> ID：15032909
> 
> 赞同：1
> 
> 时间：2013-02-22T20:47:23.187
> 
> 标签：spring, hibernate, junit, applicationcontext

我有一个正确定义的 spring 配置 XML 文件，它导入了一些其他的 XML 文件。测试应该从 MySQL 数据库中读取/写入/删除记录。我遇到了休眠问题 - 测试无法访问数据库并且休眠抛出以下异常：

```
Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor];
nested exception is org.hibernate.service.UnknownServiceException:
Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor] 
```

这是我的测试课：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(value = "classpath:*.xml")
@TransactionConfiguration(transactionManager = "transactionManager", defaultRollback = true)
@Transactional
public class JukeboxTest {

    @Autowired
    private ApplicationContext applicationContext;

    private Jukebox jukebox;

    private SessionFactory sessionFactory;
    private Session session = null;

    @BeforeClass
    public static void setUpClass() {
    }

    @AfterClass
    public static void tearDownClass() {
    }

    @Before
    public void setUp() {
        jukebox = (Jukebox) applicationContext.getBean("metal_jukebox");
        sessionFactory = (SessionFactory) applicationContext.getBean("sessionFactory");
        session = sessionFactory.openSession();
        System.out.println(jukebox.getName());
    }

    @After
    public void tearDown() {
        session.close();
        sessionFactory.close();
    }

    @Test
    @Transactional
    public void testGetName() {
        assertEquals("Metal Jukebox", jukebox.getName());
    } 
```

这是我的休眠配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx.xsd">

    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">update</prop>
            </props>
        </property>
        <property name="annotatedClasses">
            <list>
                <value>com.blogspot.symfonyworld.lyricsbase.model.Song</value>
            </list>
        </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory"/>
    </bean>

    <tx:annotation-driven transaction-manager="transactionManager"/>

</beans> 
```

system.out 行正确显示了 bean XML 中定义的值，所以配置没问题。我猜注释在某种程度上是错误的，但我不知道要修复什么，因为异常什么也没告诉我。

这是异常堆栈跟踪：

```
org.springframework.orm.hibernate4.HibernateSystemException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]; nested exception is org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]
    at org.springframework.orm.hibernate4.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:185)
    at org.springframework.orm.hibernate4.HibernateTransactionManager.convertHibernateAccessException(HibernateTransactionManager.java:594)
    at org.springframework.orm.hibernate4.HibernateTransactionManager.doRollback(HibernateTransactionManager.java:495)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:846)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:823)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener$TransactionContext.endTransaction(TransactionalTestExecutionListener.java:588)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.endTransaction(TransactionalTestExecutionListener.java:297)
    at org.springframework.test.context.transaction.TransactionalTestExecutionListener.afterTestMethod(TransactionalTestExecutionListener.java:192)
    at org.springframework.test.context.TestContextManager.afterTestMethod(TestContextManager.java:396)
    at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:91)
    at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:231)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:88)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:71)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:174)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: org.hibernate.service.UnknownServiceException: Unknown service requested [org.hibernate.stat.spi.StatisticsImplementor]
    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:126)
    at org.hibernate.internal.SessionFactoryImpl.getStatisticsImplementor(SessionFactoryImpl.java:1468)
    at org.hibernate.internal.SessionFactoryImpl.getStatistics(SessionFactoryImpl.java:1464)
    at org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl.afterTransaction(TransactionCoordinatorImpl.java:140)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.afterTransactionCompletion(JdbcTransaction.java:138)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.rollback(AbstractTransactionImpl.java:214)
    at org.springframework.orm.hibernate4.HibernateTransactionManager.doRollback(HibernateTransactionManager.java:488)
    ... 33 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:55:37.910

如果这是一个服务，请在测试上下文中定义 bean JukeBox。

如果这是 dao，那么请将实体管理器、事务管理器和会话工厂注入 bean。

# spring - 在 Spring SecurityContextHolder 中存储有关访客的信息

> ID：15032910
> 
> 赞同：1
> 
> 时间：2013-02-22T20:47:28.317
> 
> 标签：spring, session, servlets

我想添加来宾功能：这意味着来宾是像用户一样行为的对象，但不是持久化的，而是拥有`ROLE_GUEST`而不是`ROLE_USER`. 我想在会话中存储一个guestID，这样当客人做某事时，我可以检索客人并以客人的名义采取行动。如果我想保留一个`Stateless Servlet`.

我当前的注册用户登录是这样的：

```
auth = new UsernamePasswordAuthenticationToken(username, password, auths);
Authentication result = authManager.authenticate(auth);
SecurityContextHolder.getContext().setAuthentication(result); 
```

我正在寻找与此类似的东西，或者直接在 SecurityContextHolder.getContext() 中的某处添加来宾名称的方法。我可以获取弹簧`Session`对象或另一个会话来存储此信息吗？

我没有使用`Spring MVC`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:07:57.333

`UsernamePasswordAuthenticationToken`您应该使用框架提供的[匿名身份验证机制](http://static.springsource.org/spring-security/site/docs/current/reference/anonymous.html)，而不是假的。您可以使用安全命名空间对其进行配置：

```
<security:http ....>
    ....
    <security:anonymous username="guest" granted-authority="ROLE_GUEST"/>
</security:http> 
```

这将导致将`AnonymousAuthenticationFilter`具有`AnonymousAuthenticationToken`提供的名称和角色的一个放入安全上下文中。（当然，只有在其他过滤器（如`UsernamePasswordAuthenticationFilter`）无法验证用户身份时才会发生这种情况。）

# javascript - 如何强制触摸事件冒泡？

> ID：15032912
> 
> 赞同：1
> 
> 时间：2013-02-22T20:47:32.390
> 
> 标签：javascript, jquery, ipad, touch

有没有办法强制触摸事件冒泡？默认情况下，ipad 上的触摸事件不会冒泡。

```
$(document).on('touchstart', function (e) {
   closePopupOnClick(e, popup);
}); 
```

因此，必须再次单击才能触发。建议任何人？

# button - highcharts 隐藏缩放重置按钮，以编程方式调用缩放重置

> ID：15032914
> 
> 赞同：22
> 
> 时间：2013-02-22T20:47:45.310
> 
> 标签：button, highcharts, zooming, reset

我在 highcharts 中有一个很好的图表，用户可以放大。我真的不喜欢内置的 ZOOM RESET 按钮，并且想将我自己的自定义缩放重置按钮添加到已经存在的导航栏中。

所以我的问题是： 1\. 有没有办法隐藏默认的 highcharts ZOOM RESET 按钮？2\. 有没有我可以调用的方法/函数来执行 ZOOM RESET？（我可以通过我自己的按钮点击来调用它）

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-22T21:34:20.087

你可以传递`resetZoomButton`as`display: none`和 call `zoomOut`。

```
chart: {
    resetZoomButton: {
        theme: {
            display: 'none'
        }
    }
}

$('#resetZoom').click(function() {
    chart.zoomOut();
});

<input type="button" value="reset zoom" id="resetZoom"/> 
```

[**演示**](http://jsfiddle.net/MvxQ8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-22T10:19:00.950

只需获取图表并调用缩小：

```
chart = $("#your-chart").highcharts();
chart.zoomOut(); 
```

# user-input - Rebol 中命令行的基本输入

> ID：15032916
> 
> 赞同：2
> 
> 时间：2013-02-22T20:47:48.827
> 
> 标签：user-input, rebol

我目前正在学习 Rebol。

在我知道的其他语言中，我可以从命令行读取输入，例如在 Java 中：

```
Scanner sc = new Scanner(System.in)
sc.nextLine(); 
```

在 C# 中

```
Console.ReadLine(); 
```

在 C 中

```
scanf("%s", s); 
```

我想知道如何在 Rebol 中完成同样的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T21:25:50.127

该函数通过在请求输入之前打印一个字符串来`ask`补充：`input`

```
age: ask "How old are you? " 
```

它还`/hide`对隐藏输入进行了改进：

```
pass: ask/hide "Enter your password: " 
```

*此时，/hide在 Rebol 3 alphas中[没有实现](http://curecode.org/rebol3/ticket.rsp?id=1400)*

更长的答案（至少对于中级）将包括监视`system/ports/input`端口（您可以`source input`为自己完成此操作）——这可以用于输入不是来自控制台的情况（例如 shell、电脑动画）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-22T20:52:00.140

您可以使用该`input`命令在控制台请求输入。

```
>> name: input
Joe
== "Joe" 
```

# php - 在 Stripe 中使用优惠券代码

> ID：15032918
> 
> 赞同：4
> 
> 时间：2013-02-22T20:47:55.097
> 
> 标签：php, javascript, stripe-payments

我有一个使用[Stripe](https://stripe.com/)处理订阅付款的网站。只有一种订阅类型。我按照NetTuts 上的[本教程](http://net.tutsplus.com/tutorials/tools-and-tips/so-you-want-to-accept-credit-cards-online/)进行了初始设置。有一个表格可以很好地处理订阅并且一切正常。客户要求提供优惠券代码。Stripe 支持这一点，所以我开始尝试在现有表单中添加优惠券代码。

我在 Stripe 中设置了优惠券代码，设置了我的测试密钥并在 Stripe 中切换到了测试模式。我正在我的代码中执行一些检查：

1.  检查是否输入了优惠券，如果没有则创建一个没有优惠券选项的新客户对象
2.  检查Coupon是否有效，如果无效则返回错误

如果输入了优惠券并且有效，则在创建新客户时将匹配的 Stripe 优惠券对象作为选项传递。

```
 if(isset($couponCode) && strlen($couponCode) > 0) {
  $using_discount = true;
  try {
        $coupon = Stripe_Coupon::retrieve($couponCode);
        if($coupon !== NULL) {
           $cCode = $coupon;
        }
        // if we got here, the coupon is valid

     } catch (Exception $e) {

        // an exception was caught, so the code is invalid
        $message = $e->getMessage();
        returnErrorWithMessage($message);

     }

}

try
{ 
  if($using_discount == true) {
    $customer = Stripe_Customer::create(array(
          "card" => $token,
          "plan" => "basic_plan",
          "email" => $email,
          "coupon" => $cCode
       ));
  }
  else {
        $customer = Stripe_Customer::create(array(
          "card" => $token,
          "plan" => "basic_plan",
          "email" => $email
       ));
  } 
```

$couponCode 正确地填充了表单字段，就像填充所有其他字段一样，我已经三次检查它是否被正确拉出。

当我尝试在没有优惠券代码的情况下提交表单时，它会收取全额费用并正确通过 Stripe。

但是，如果我输入有效或无效的优惠券代码，它不会在创建新客户对象时将优惠券对象与客户对象一起传递，并在通过 Stripe 时收取全额费用。

我已经看了好几个小时的代码，似乎无法弄清楚为什么它总是无法识别折扣代码并将匹配的优惠券对象传递给 Stripe。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-19T11:24:23.477

这可能有点过时了，您找到了代码的解决方案。但似乎您需要做的就是将原始 $couponCode 作为 Coupon 的数组值传递。正如 codasaurus 所说，您只是从优惠券的条纹中获取一个数组，除非您执行 $cCode->id 并将 ID 传递回您的数组以创建客户，否则您不需要该数组。

当您将 $using_discount 设置为 true 时，我进行了更改，因为如果优惠券有效与否，这将触发发送优惠券代码。

一旦优惠券实际有效，我们就会发送优惠券。您只需要提交状态的值，因此 $coupon 是那里系统中折扣的参考。或者，如果您想以这种方式创建它，您可以使用 $coupon->id。

这是我对基于您的代码的解决方案的看法，它可能会更好，但我希望它可以帮助其他寻找像我这样的解决方案的人。

```
if($coupon!='' && strlen($coupon) > 0) {
          try {
                $coupon = Stripe_Coupon::retrieve($coupon); //check coupon exists
                if($coupon !== NULL) {
                 $using_discount = true; //set to true our coupon exists or take the coupon id if you wanted to.
                }
                // if we got here, the coupon is valid

             } catch (Exception $e) {
                // an exception was caught, so the code is invalid
                $message = $e->getMessage();
                returnErrorWithMessage($message);
             }

        }
        if($using_discount==true)
        {
            $customer = Stripe_Customer::create(array(
                  "card" => $token,
                  "plan" => $plan,
                  "email" => $id,
                  "coupon"=>$coupon) //original value input example: "75OFFMEMBER" stripe should be doing the rest.
                );
        }
        else
        {
            $customer = Stripe_Customer::create(array(
                  "card" => $token,
                  "plan" => $plan,
                  "email" => $id)
                );
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T18:46:44.533

查看文档[https://stripe.com/docs/api#create_customer](https://stripe.com/docs/api#create_customer)，Stripe_Customer::create() 调用正在寻找优惠券代码。看起来您正在传递整个优惠券对象。

除非您的第一次尝试捕获失败，否则 $couponCode 已经有您的优惠券代码。此外，您还需要执行其他几项检查以确定优惠券是否有效。例如，如果coupon->times_redeemed < coupon->max_redemptions，或者如果coupon->redeem_by 已经过去等。您可能还想通过检查客户折扣对象来检查客户是否已经在使用优惠券。

如果这些检查中的任何一个失败，只需设置您的 $using_discount = false;

# php - 数组，从 MySQLi 到 PDO

> ID：15032920
> 
> 赞同：2
> 
> 时间：2013-02-22T20:48:01.390
> 
> 标签：php, mysql, arrays, pdo, mysqli

几年前，SO 用户帮助我构建了以下代码以在组中分配“合作伙伴”（如循环 [A->B->C->D->A->B->...] ):

```
$q = "SELECT user_id FROM users WHERE group_id='$gi' ORDER BY RAND()";
$r = mysqli_query ($dbc, $q) or trigger_error("Query: $q\n<br />MySQL Error: " . mysqli_error($dbc));

    while ($row = mysqli_fetch_array($r)) {
        $users[] = $row[0];
    }

    $current = end($users);
    $partners = array();
    foreach ($users as $user) {
        $partners[$user] = $current;
        $current = $user;
        $q="UPDATE users SET partner='{$partners[$user]}' WHERE user_id='{$user}'";
        mysqli_query ($dbc, $q) or trigger_error("Query: $q\n<br />MySQL Error: " . mysqli_error($dbc));
    } 
```

然而，现在我正在用 PDO 重写我的大部分代码，而数组正在杀死我。到目前为止，这是我重写此内容的最佳尝试：

```
$query = "SELECT id FROM users WHERE gid=:gid ORDER BY RAND()";
$query_params = array( ':gid' => $_SESSION['user']['gid'] );
try {
    $stmt = $db->prepare($query);
    $result = $stmt->execute($query_params);
} 
catch(PDOException $ex) {   
    die("Failed to run query: " . $ex->getMessage());
}
while ($row = $stmt->fetchAll(PDO::FETCH_COLUMN)) {
$users[] = $row[0];
}
$current = end($users);
$partners = array();
foreach ($users as $user) {
    $partners[$user] = $current;
    $current = $user;
    $query = "UPDATE users SET partner=:partner WHERE id=:id";
    $query_params = array(
        ':partner' => '{$partners[$user]}',
        ':id' => '{$user}'
    );

    try {
    $stmt = $db->prepare($query);
    $result = $stmt->execute($query_params);
    }
    catch(PDOException $ex) {
        die("Failed to run query: " . $ex->getMessage());
    }
} 
```

我所有的阅读和搜索都没有得到关于为什么我的修改后的代码不再有效的答案。 **现在发生的所有事情都是将一个用户自己分配为合作伙伴，而不是循环分配合作伙伴。**

据我所知，我的`fetchAll`陈述是不正确的，但是如何？对于我的一生，我无法弄清楚。

（如果你提出一种更有效的方法来做这件事，我不会感到不安。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:12:19.173

```
 ':id' => '{$user}' 
```

是错的。您正在尝试在查询中插入文字`{`, `$`, `u`, etc...。它应该只是

```
 ':id' => $user 
```

对于合作伙伴也是如此。

请记住... PHP 不会在单引号字符串中插入变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:35:31.687

又一个小时的磨练和修补，我偶然发现了答案。我不知道为什么它似乎无处共享，但 PDO 的等价物`mysqli_fetch_array`并不是普遍的`fetchAll`。在这种情况下，以及许多其他情况下，正确的替代品是`fetch(PDO::FETCH_NUM)`.

所以，我的代码现在与上面完全一样，除了这个更改：

```
while ($row = $stmt->fetch(PDO::FETCH_NUM)) {
    $users[] = $row[0];
} 
```

代替：

```
while ($row = $stmt->fetchAll(PDO::FETCH_COLUMN)) {
    $users[] = $row[0];
} 
```

# python - 未来不可知的南方数据迁移

> ID：15032925
> 
> 赞同：4
> 
> 时间：2013-02-22T20:48:12.137
> 
> 标签：python, django, serialization, migration, django-south

我一直在用 south 开发一个 django 应用程序，并进行了一种松散的持续部署。初次迁移后不久，我进行了几次数据迁移，如下所示：

```
def forwards(self, orm):                                                   
    from django.core.management import call_command                        
    call_command("loaddata", "#######.json") 
```

当时，我什么都没想。手动填充数据库然后将其全部转储到固定装置中已经很容易了。然后当我终于写了一些单元测试时，我开始收到这样的错误：

```
Creating test database for alias 'default'...
Problem installing fixture '/home/axel/Workspace/02_ereader_blast/content/fixtures/99_deals.json': Traceback (most recent call last):
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/core/management/commands/loaddata.py", line 196, in handle
    obj.save(using=using)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/core/serializers/base.py", line 165, in save
    models.Model.save_base(self.object, using=using, raw=True)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/db/models/base.py", line 551, in save_base
    result = manager._insert([self], fields=fields, return_id=update_pk, using=using, raw=raw)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/db/models/manager.py", line 203, in _insert
    return insert_query(self.model, objs, fields, **kwargs)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/db/models/query.py", line 1593, in insert_query
    return query.get_compiler(using=using).execute_sql(return_id)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/db/models/sql/compiler.py", line 910, in execute_sql
    cursor.execute(sql, params)
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 52, in execute
    return self.cursor.execute(query, args)
DatabaseError: Could not load content.BookDeal(pk=1): column "entry_id" of relation "content_bookdeal" does not exist
LINE 1: INSERT INTO "content_bookdeal" ("id", "book_id", "entry_id",...
                                                         ^

Installed 19 object(s) from 1 fixture(s)
Problem installing fixture '/home/axel/Workspace/02_ereader_blast/content/fixtures/99_deals_entries.json': Traceback (most recent call last):
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/core/management/commands/loaddata.py", line 190, in handle
    for obj in objects:
  File "/home/axel/Workspace/02_ereader_blast/venv/local/lib/python2.7/site-packages/django/core/serializers/json.py", line 47, in Deserializer
    raise DeserializationError(e)
DeserializationError: Entry has no field named 'book_deals' 
```

据我所知，loaddata 命令使用的是我最近的模型，而不是当时的南方州，并且因为从那时起我已经对它们进行了重大更改，因此当前模型将旧数据解释为无效。

所以我的问题是：

*   设置未来数据迁移以免发生这种情况的最佳方法是什么？
*   我如何才能摆脱这种情况，并将其带到最佳实践领域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T21:55:19.940

我找到了解决方案，由这个 stackoverflow 问题提供：

[django 在向后迁移/ loaddata 后从夹具加载数据使用的是模型模式而不是数据库模式](https://stackoverflow.com/questions/5472925/django-loading-data-from-fixture-after-backward-migration-loaddata-is-using-mo/5906258#5906258)

如最佳答案中所述，我使用了一个非常优雅地修补 loaddata 命令获取其模型的片段。

请注意，我确实必须扩大我对这些数据迁移的冻结范围，以便他们可以从 orm 而不是直接访问他们需要的所有模型。

这感觉像是解决问题的正确方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:07:23.603

我认为，我的方法很可能是完全的黑客/滥用南方/最糟糕的做法。但是...如果您知道您的 django 模型符合您的数据表。我可能会采用新的开始方法：

1.  重命名（或删除）相关迁移文件夹。
2.  在 south_migrationhistory 数据表中，删除您尝试为其创建新开始的应用程序的所有关联条目。
3.  `python manage.py convert_to_south app-name`.
4.  一切都应该很好。

如果数据表是规范的，并且您的 django 模型不符合要求，那么我将 django 模型与数据表保持一致的方式是运行：

```
python manage.py inspectdb > inspectdb.py 
```

现在我可以为我的模型比较两个版本的 django 代码，以使它们对齐。这使我能够经历新的开始序列。

# java - 改进嵌套枚举定义

> ID：15032926
> 
> 赞同：0
> 
> 时间：2013-02-22T20:48:13.257
> 
> 标签：java, enums

我喜欢使用`enum`s，它增强了代码的可读性和可用性。但是在某些情况下，我想简化“复制的”A 和 B“枚举”构造和函数……这可能吗？

```
public static enum KEYS {

    KEYS() {};

    public static enum RSA {

        RSA() {};

        public static enum A {

            ONE (new String[]{...}),
            TWO (new String[]{...}),
            THREE (new String[]{...});

            public final String[] keys;

            A(String[] keys) {
                this.keys=keys;
            }

            public int getVersion(){
                return keys.length;
            }

        }

        public static enum B {

            ONE (new String[]{...}),
            TWO (new String[]{...}),
            THREE (new String[]{...});

            public final String[] keys;

            B(String[] keys) {
                this.keys=keys;
            }

            public int getVersion(){
                return keys.length;
            }

        }

    }

    ...

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T00:50:30.067

目前不可能有一个`getVersion()`由各种枚举（嵌套或非嵌套）重用的方法的通用实现，因为 Java 使所有枚举成为最终的（不可扩展的），因此它们不能从彼此或其他类继承。您必须为每个枚举定义所有方法和构造函数。

（注意：Java 8 将来可能会使用*防御方法*）

# ios - 可以在 textFieldShouldReturn 中更新 coreData 存储吗？

> ID：15032928
> 
> 赞同：0
> 
> 时间：2013-02-22T20:48:25.103
> 
> 标签：ios, core-data, uitextfield, nsfetchedresultscontroller

我读过你不应该在 textFieldShouldReturn 中执行动画。当实现 NSFetchedResultsControllerDelegate 时，CoreData 更新会导致动画发生。所以不建议更新textFieldShouldReturn中的coreData吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:21:59.153

我自己没有读过（任何引用？），但如果您担心，请`textFieldDidEndEditing:`改为更新。

# iphone - 在屏幕上同时有两个视图，而需要一个（iphone）

> ID：15032929
> 
> 赞同：0
> 
> 时间：2013-02-22T20:48:44.980
> 
> 标签：iphone, view, screen

我有两个视图，当我单击一个按钮以显示第一个视图时，另一个视图的水龙头仍位于第一个视图页面的底部。

但是当我点击那个水龙头给我带来第二个视图时，它把它带到第一个视图后面！我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:50:48.083

你可以把它放在前面，像这样

```
[self.view bringSubviewToFront:secondView]; 
```

# charts - Microsoft ReportViewer (2010) 图表时间作为具有间隔值的类别

> ID：15032930
> 
> 赞同：0
> 
> 时间：2013-02-22T20:48:46.727
> 
> 标签：charts, dataset, reportviewer, report-viewer2010

这里的第一个问题，所以如果我做错了什么，请原谅我。

我正在尝试在 MS ReportViewer 2010 中创建一个折线图，它应该显示每天有多少人注册。基本上它应该在 X 轴上显示过去 30 天，每天在刻度线上显示，在 Y 轴上显示当天注册的人数。

在我的数据集上，我有一个包含“RegistrationDate”列的“People”表。

到目前为止（在过去 3 小时内:)）我已经设法做到了： - X（类别）轴上的 RegistrationDate - Y（值）轴上的 CountRows()

如果我在最小和最大刻度值中保留“自动”，我确实会得到一些结果，但我有这些问题：1）特别是图表在 X 轴上仅包含至少有一个人注册的日期，但忽略了那些为零的。基本上轴不是在 30 天内划分的，而是在 20 天左右，不包括没有注册的日子有一个检查“总是包括 0”，但没有任何改变

2）我尝试手动设置X轴最小值/最大值，数据消失了！

提前致谢 ！！

> [edit_update] 在 24 小时猛烈抨击它之后，并意识到 reportviewer 文档和教程至少可以说很少（我猜人们使用其他工具？），我已经在代码中实现了一个解决方法。在从 minDate 到 maxDate 的循环中，我填充了具有日期和注册计数作为成员的对象列表，从而用每个可能的值填充 x 轴，以及零。远非很好，也不是很灵活（我仍然不明白 x 轴分组如何很好地工作），但它有点做它的工作。这是我应该回答自己的问题的情况吗？[结束更新]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T13:35:24.260

经过 24 小时的猛烈抨击，并意识到 reportviewer 文档和教程至少可以说很少（我猜人们使用其他工具？），我已经在代码中实现了一种解决方法。在从 minDate 到 maxDate 的循环中，我填充了具有日期和注册计数作为成员的对象列表，从而用每个可能的值填充 x 轴，以及零。远非很好，也不是很灵活（我仍然不明白 x 轴分组如何很好地工作），但它有点做它的工作。这是我应该回答自己的问题的情况吗？

# http - 对于没有正文的 4xx 错误，Content-Type 应该是什么？

> ID：15032932
> 
> 赞同：17
> 
> 时间：2013-02-22T20:48:56.887
> 
> 标签：http, http-headers, grape-api

考虑一个获得以下响应的 HTTP 请求：

```
405 Method Not Allowed
Content-Length: 0 
```

这样的内容类型应该是什么？

*   设置为无？
*   没有设置？
*   设置为`text/plain`或`text/html`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-22T20:50:44.027

您没有任何内容，因此我根本不会设置 a `Content-Type`。如果您发现这会给客户带来问题（老实说，这似乎不太可能），我可能会选择`text/plain`- 绝对不是`text/html`，因为您的“空内容”*不是*HTML 文档。

# javascript - 从某个偏移量中选择 div 的内容

> ID：15032935
> 
> 赞同：0
> 
> 时间：2013-02-22T20:49:13.153
> 
> 标签：javascript

我想从某个高度选择一个分区的所有内容，使用高度作为一种偏移量。我从数据库加载数据，将其放入 div 中，然后获取 div 的高度：

```
<div id='gtheight' style='display:none;'>
<!--content is returned from database here-->
 </div> 
```

我得到了 div 的高度：

```
var heit=$(\"#gtheight\").height(); 
```

我的阈值为 470px。如果返回的内容使 div 的高度超过 470px，则应提取多余的内容，并将其放置在另一个 div 中。因此，如果内容的高度为 500px，则占用最后 40px 左右的内容（出于外观原因，我在差异中添加了盈余）应该被放入另一个 div 中（500-470=30px，我添加 10px 给 40px ）。我知道我不能这样做：

```
 divsaved.innerHTML=divloaded.innerHTML;//where divloaded is the variable relating
 //to the data from the db. 
```

因为那只会将所有 html 从 div1 放到 div2。那么有没有办法使用javascript来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:56:07.467

您可能对[CSS3 区域模块](http://dev.w3.org/csswg/css3-regions/Overview.src.html)感兴趣，因为它似乎完全符合您的要求。也就是说，[支持非常缺乏](http://caniuse.com/#feat=css-regions)，所以你可能想要推迟。

与此同时，我不确定该建议什么。这取决于内容是纯文本还是涉及其他元素。在前一种情况下，您可以将文本分解成单词并找出顶部 470px 中最后一行的结尾在哪里，但在后一种情况下，这将非常困难。

# php - 为什么一个查询返回正确的值，但紧随其后的一个返回 0？

> ID：15032943
> 
> 赞同：3
> 
> 时间：2013-02-22T20:49:32.983
> 
> 标签：php, mysql, mysqli

这是我的代码：

```
 $stmt1 = $db->prepare("SELECT wins FROM users WHERE id = ?");
            $stmt2 = $db->prepare("SELECT losses FROM users WHERE id = ?");

            $stmt1->bind_param("i", $_SESSION["id"]);
            $stmt2->bind_param("i", $_SESSION["id"]);

            $stmt1->bind_result($db_wins);
            $stmt2->bind_result($db_losses);

            $stmt1->execute();
            $stmt2->execute();

            $stmt1->fetch();
            $stmt2->fetch();

            // Print out user scores
            echo "<p><strong>User:</strong> " . $_SESSION["username"] . "</p>\n";
            echo "<p><strong>Wins:</strong> " . $db_wins . "</p>\n";
            echo "<p><strong>Losses:</strong> " . $db_losses . "</p>\n"; 
```

一切都正确打印，除了损失，当它应该打印表中的值时打印 0。

注意事项：

*   它按预期在页面下方打印值，但不使用准备语句。
*   如果我在 phpMyAdmin（返回 0 的查询）或 Sequel Pro 中运行它，它会返回正确的损失值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:57:52.837

我同意上面 Kolink 的评论，但我认为将代码更改为以下内容也应该可以解决问题。[PHP 页面](http://www.php.net/manual/en/mysqli-stmt.bind-result.php)提供了以下替代方案，也许也可以在您的情况下使用？编辑：显然，您仍然可以将 bind_param 加入其中。

```
/* prepare statement */
if ($stmt = $mysqli->prepare("SELECT Code, Name FROM Country ORDER BY Name LIMIT 5")) {
   $stmt->execute();

   /* bind variables to prepared statement */
   $stmt->bind_result($col1, $col2);

   /* fetch values */
   while ($stmt->fetch()) {
       printf("%s %s\n", $col1, $col2);
   }

   /* close statement */
   $stmt->close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:56:03.410

您正在使用`fetch()`没有参数，因此默认情况下它应该返回您想要的数据。如果您传入`PDO::FETCH_BOUND`，则可能会[根据文档](http://www.php.net/manual/en/pdostatement.fetch.php)触发绑定操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T21:01:10.157

您是否尝试计算 ($db_losses) 而不仅仅是打印 de variable ？

有时 Mysql 数组中的指针不在第一个元素处，而是留在数组的最后一个打印 0 的元素上！

尝试在您的阵列上使用 reset() 函数。[http://www.php.net/reset](http://www.php.net/reset)

# jquery - 具有父单元格值的基本数学

> ID：15032944
> 
> 赞同：0
> 
> 时间：2013-02-22T20:49:57.443
> 
> 标签：jquery, html, math, html-table

我有一个带有 id 值的表和每个单元格中的图像。到目前为止，当用户单击该单元格时，我的代码会显示该单元格 ID。当用户再次单击同一单元格时，它还会“取消显示”该 ID。我现在要做的是将数字 10 分配给我的表格类，这样当您单击单元格时，它将显示 10，或者如果您单击 2 个单元格，它将显示 20 但如果您单击其中一个单元格再次减去 10。我希望这很容易理解。

到目前为止，这是我的代码： HTML：

```
<table>
<tr>
<td class='test' id='1'><img src='images/Dog.gif'/></td>
<td class='test' id='2'><img src='images/Cat.gif'/></td>
<td class='test' id='3'><img src='images/Mouse.gif'/></td>
<td class='test' id='4'><img src='images/Human.gif'/></td>
</tr>
</table> 
```

JS：

```
$(document).ready(function() { 
var clicked = [];
$('td.test').click(function() {
    var found = clicked.indexOf(this.id);       
    if(found !== -1) {
        clicked.splice(found, 1);       
    } else {
        clicked.push(this.id);
    }
    $('#output').text(clicked.join(','));
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T20:57:16.943

我不完全确定我理解你，但这是它：

```
$('#output').text(clicked.length*10); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T21:15:42.440

这应该很简单。尝试以下

```
 var score = 0;

   $('td.test').click(function() {
       var $this = $(this);
       if (!$this.hasClass('clicked')) {
           $this.addClass('clicked');
           score += 10;
       } else {
           $this.removeClass('clicked');
           score -= 10;
       }
       $('#output').text(score);
  }); 
```

# java - 如何处理来自网站的 utf-8 内容

> ID：15032947
> 
> 赞同：0
> 
> 时间：2013-02-22T20:50:02.203
> 
> 标签：java, utf-8, web

我是java新手，我被困在这个功能中：

```
public String getFromUrl(String url){
    String content = "";
    try{
        URL U = new URL(url);
        URLConnection conn = U.openConnection();
        conn.setRequestProperty("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13 (.NET CLR 3.5.30729)");
        BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream(), "UTF-8"));
        String line;
        while((line = reader.readLine()) != null)content += line+"\r\n";
        reader.close();
    }
    catch(Exception e){}
    return content;
} 
```

我总是得到问号而不是 utf-8 符号！我做错了什么？

我读了这篇[文章](https://stackoverflow.com/questions/4555128/how-to-correctly-read-url-content-with-utf8-chars)

第一：我不明白为什么要使用字节数组？

第二：如果我写的话，在这种情况下“while循环”应该是什么样子

```
while((line = reader.readLine()) != null)content = line.getBytes("UTF-8"); 
```

我的日食说“局部变量内容可能尚未初始化”

第三：我应该如何将字节数组转换回字符串？

然后我读[了这个](https://stackoverflow.com/questions/12591580/read-utf-8-url-to-string-java)。我什至没有尝试这篇文章中的方式，因为我正在尝试编写一个模拟浏览器获取和发布请求的函数。似乎我发现了如何使用 URL 类执行它，所以我不想使用任何其他类和方法。

现在我唯一的问题是如何处理 utf-8 内容。

任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T21:21:11.363

倾倒：

```
String encoding = conn.getContentEncoding(); 
```

如果不为空，您可以将其用于阅读器。

并转储可能捕获的异常。

# xml - 从特定父元素中读取特定子元素

> ID：15032949
> 
> 赞同：1
> 
> 时间：2013-02-22T20:50:14.577
> 
> 标签：xml, vb.net, parent-child

示例 XML；

```
<root>
 <cmdset>Set 1
     <comment>Comment 1 here.</comment>
     <cmd>Command 1</cmd>
     <cmd>Command 2</cmd>
 </cmdset>

 <cmdset>Set 2
     <comment>Comment 2 here.</comment>
     <cmd>Command 3</cmd>
     <cmd>Command 4</cmd>
 </cmdset>
</root> 
```

目前我有一个填充`<cmdset>`元素的列表框。代码是；

```
 Dim doc As XmlDocument = New XmlDocument()
    doc.Load("help.xml")
    For Each textNode As XmlText In doc.SelectNodes("//cmdset/text()")
        listCmdSet.Items.Add(textNode.InnerText)
    Next 
```

哪个输出到列表框；

```
Set 1
Set 2 
```

我现在希望能够处理特定元素中的某些子元素`<cmdset>`，仅处理`<cmd>`此示例中的元素，而不是`<comment>`元素。所以如果在列表框中选择了Set 1，我只想处理文本“Command 1”和“Command 2”。

有人建议我给元素一个 ID 或名称会使事情变得更容易，但我想尽可能避免这种情况，因为我希望最终用户可以编辑 XML（有时不是很技术）所以我试图让事情变得简单尽可能。

我尝试了各种不同的想法，但无济于事，我是 XML 新手（从 SO 获得了填充列表框的代码），所以如果到目前为止我所做的任何事情都是不好的做法，请大喊大叫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:05:33.920

是的，如果您正在查看的值在属性或子元素中，这样做会更容易，但仍然可以这样做。这将遍历包含 text`cmd`的所有值：`cmdset``Set 1`

```
For Each node As XmlNode In doc.SelectNodes("//cmdset[normalize-space(text())='Set 1']/cmd")
    Dim value As String = node.InnerText
    ' ...
Next 
```

方括号建立了一个条件，因此只有条件为真的元素才会被包括在内。该`normalize-space`功能对于本质上修剪文本以消除文本后的换行符是必要的。

但是，从您的问题来看，这有点不清楚，如果这正是您要问的。如果您已经引用了所需的父元素，那么您可以简单地执行以下操作：

```
Dim cmdsetElement As XmlElement = ' ...
For Each node As XmlNode in cmdsetElement.SelectNodes("cmd")
    Dim value As String = node.InnerText
    ' ...
Next 
```

# javascript - 满足条件后如何更改body的onload事件

> ID：15032951
> 
> 赞同：1
> 
> 时间：2013-02-22T20:50:21.870
> 
> 标签：javascript, jquery

一旦满足某个条件，我想更改 body 的 onload 事件。

在我的情况下，条件是我首先必须让页面加载并获取当前的 onload 事件并将其与某个字符串进行比较，如果它返回 true，然后我将用不同的函数替换它以分配给 onload 事件。

这甚至可能吗，因为当页面加载时，我的新 onload 事件实际上什么都不做，所以我猜我必须在它到达正文之前对其进行更改。

这是我从上一个问题中得到的。我还添加了一些东西：

```
$(document).ready(function(){
var x = new String(document.body.onload);
x = x.replace(/ /gi,"");
x = x.replace("functiononload(event){","");
x = x.replace("}","");
alert(x);
//what i want to do after i checked the old event if it is equal to something.
window.onload = function() {
newfunction();
x();
}();
});

<body onload="wewewe();"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T22:40:43.977

你为什么不简单地使用：

```
$(document).ready(function() {
    if (condition) {
        // do something
    }
    else {
        // do something other
    }
}); 
```

`body.onload`并且`$(document).ready()`几乎相同。

# css - 如何在 CSS 中使用悬停同时更改两个元素的属性

> ID：15032956
> 
> 赞同：1
> 
> 时间：2013-02-22T20:50:41.453
> 
> 标签：css, hover

我需要实现这一点：当我将鼠标悬停在红色框上时，紫色的应该会消失，当我将鼠标悬停在橙色的框上时，蓝色的应该会消失，然后我将鼠标悬停在黄色的框上，绿色的会消失。我设法做到了，但我也需要反过来做，但我尝试的一切都没有奏效。有人可以帮我吗？

```
<html>
<head>
    <title>Boxes</title>
    <style type"text/css">
    div {
        width:70px;
        height:90px;
        border:3px solid #000;
    }
    .t1 {
        background: red;
        top: 50px;
        left: 15px; 
        position: absolute;
    }
    .t1:hover + .t6{
        background: red;
        top: 50px;
        left: 15px; 
        z-index: 1;
        position: absolute;
        visibility: invisible;
    }
    .t2 {
        position: absolute;
        background:orange;
        top: 100px;
        left: 60px;
    }
    .t2:hover + .t5 {
        position: absolute;
        background:orange;
        top: 100px;
        left: 60px;
        z-index: 1;
        visibility: invisible;
    }
    .t3 {
        background:yellow;
        top: 150px;
        left: 110px;
        position: absolute;
    }
    .t3:hover + .t4 {
        background:yellow;
        top: 150px;
        left: 110px;
        position: absolute;
        visibility: invisible;
        z-index: 1;
    }
    .t4 {
        background:green;
        top: 200px;
        left: 160px;
        position: absolute;
    }
    .t5 {
        background:blue;
        top: 250px;
        left: 210px;
        position: absolute;
        z-index: 1;
    }
    .t6 {
        background:purple;
        top: 300px;
        left: 260px;
        position: absolute;
        z-index: 2;
    }

    <!--backwards-->

    </style>
</head>
<body>

    <div class="t1"></div>
    <div class="t6"></div>
    <div class="t2"></div>
    <div class="t5"></div>
    <div class="t3"></div>
    <div class="t4"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:19:14.477

CSS 目前仅以“向下”的方式工作。这意味着您只能从父母到孩子或第一个兄弟姐妹到下一个兄弟姐妹。你不能“向上”——孩子到父母或第二个兄弟姐妹到第一个。

换句话说，您可以使用当前的 HTML 结构（`t1 + t6`在 t1 旁边时选择 t6），但不能（在 t6 旁边时选择 t1），因为 t1 在 t6 之前。`t6 + t1`

遍历 DOM 的唯一方法是使用 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T20:55:45.693

仅靠 CSS 是不可能的。请改用 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T22:52:17.357

**这是可能的**！有一些技巧：P 只是重新排序一些盒子并玩容器。

**最终解决方案**：http : [//jsfiddle.net/vd7km/4/](http://jsfiddle.net/vd7km/4/)

我只是在玩 CSS，但你可以检查我的工作：http: [//jsfiddle.net/vd7km/](http://jsfiddle.net/vd7km/)

```
<div class="cont" id="cont1" >
  <div id="d1" ></div>
  <div id="d2" ></div>
</div> 
```

这是魔术代码：

```
.cont div:first-child:hover + div {
    visibility: hidden;
}

.cont:hover div:first-child {
    visibility: hidden;
}
.cont:hover div:first-child:hover {
    visibility: visible !important;
} 
```

更新！： http: [//jsfiddle.net/vd7km/2/](http://jsfiddle.net/vd7km/2/)

还有两个和代码重构。

几乎完成：http: [//jsfiddle.net/vd7km/3/](http://jsfiddle.net/vd7km/3/)

完成：http: [//jsfiddle.net/vd7km/4/](http://jsfiddle.net/vd7km/4/)

谢谢让我玩:-)

# java - Java Swing：将选项卡添加到 JPanels

> ID：15032959
> 
> 赞同：1
> 
> 时间：2013-02-22T20:50:50.077
> 
> 标签：java, swing, jpanel, jtabbedpane

我有一系列选项卡，但我想在它显示的面板中添加更多选项卡，就像复制功能区菜单一样。我大致知道需要做什么（更改 makeTextPanel 函数的返回类型），但不知道如何做，因此将不胜感激。

```
package components;

import javax.swing.JTabbedPane;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JFrame;
import javax.swing.JComponent;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.KeyEvent;

public class ribbonMenu extends JPanel {
        public ribbonMenu() {
                super(new GridLayout(1,1));

                JTabbedPane tabbedPane = new JTabbedPane();

                JTabbedPane tabbedPane2 = new JTabbedPane();

                JComponent panel1 = makeTextPanel("Panel #1");
                tabbedPane.addTab("Tab 1", panel1);
                panel1.setPreferredSize(new Dimension(600, 400));

                JComponent panel2 = makeTextPanel("Panel #2");
                tabbedPane.addTab("Tab 2", panel2);

                JComponent panel3 = makeTextPanel("Panel #3");
                tabbedPane.addTab("Tab 3", panel3);

                add(tabbedPane);

                tabbedPane.setTabLayoutPolicy(JTabbedPane.SCROLL_TAB_LAYOUT);           
        }

        protected JComponent makeTextPanel (String text) {
                JPanel panel = new JPanel(false);
                JLabel filler = new JLabel(text);
                filler.setHorizontalAlignment(JLabel.CENTER);
                panel.setLayout (new GridLayout(1,1));
                panel.add(filler);
                return panel;
        }

        private static void createAndShowGUI() {
            JFrame frame = new JFrame ("ribbonMenu");
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

            frame.add(new ribbonMenu(), BorderLayout.CENTER);

            frame.pack();
            frame.setVisible(true);
        }

        public static void main(String[] args) {
                SwingUtilities.invokeLater(new Runnable() {
                    public void run() {
                        UIManager.put("swing.boldmetal", Boolean.FALSE);
                        createAndShowGUI();
                    }

                });
        }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:59:50.670

为什么需要更改返回类型？

而不是这个

```
JComponent panel1 = makeTextPanel("Panel #1"); 
```

利用

```
JPanel panel1 = (JPanel)makeTextPanel("Panel #1"); 
```

对于更多选项卡，您可以再次`JTabbedPane`在该面板中添加

# oauth - Twitter API，查找登录用户

> ID：15032960
> 
> 赞同：0
> 
> 时间：2013-02-22T20:50:52.790
> 
> 标签：oauth, twitter

我登录到我的 Twitter 帐户。然后我访问[这个 twitter 应用程序网站](http://who.unfollowed.me/)。我单击使用 Twitter 链接登录，我被重定向到 Twitter 授权页面，我给予身份验证。然后我看到应用网站的会员页面。然后我从我的 Twitter 帐户中检查经过身份验证的应用程序：[https ://twitter.com/settings/applications](https://twitter.com/settings/applications)

我看到我验证了该应用程序。然后我删除了应用程序网站的所有 cookie。但我不会从 Twitter 网站注销。我重新访问应用程序网站并单击使用 twitter 登录。

如果没有 Auth 确认，我将被重定向到成员页面。怎么可能？

我了解他们将我的身份验证令牌保存在他们的数据库中并用于验证凭据。但是如果没有 cookie 等，他们怎么知道我是那个 Twitter 用户？

是否有可能知道该用户登录了 Twitter？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T10:58:31.153

当使用“身份验证”而不是“授权”时，可以解决此问题。每次用户登录时授权都需要权限，如果用户之前没有授予权限或他/她撤销了权限，则需要进行身份验证。

这称为透明登录。

注意：身份验证不包括 DM 访问。

[https://dev.twitter.com/docs/auth/implementing-sign-twitter](https://dev.twitter.com/docs/auth/implementing-sign-twitter)

# google-chrome - 使用 Sockets API 的 Chrome 打包应用程序中的 HTTP 服务器

> ID：15032967
> 
> 赞同：0
> 
> 时间：2013-02-22T20:51:13.607
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-app

我正在尝试从 Google Chrome 打包应用程序中获取一个简单的网页服务器。应用程序中已经有一个 UDP 服务器在运行并且没有任何问题。

我正在启动 socket.listen`0.0.0.0:8080`并从中复制大部分代码

```
https://github.com/GoogleChrome/chrome-app-samples/tree/master/webserver 
```

. 示例应用程序中复制了相同的问题。

我正在做的是接受请求并将单个 HTML 文件发送到请求中包含一些数据的所有请求（`request.data.length > 0`）。该应用程序的流程类似于具有几乎等效功能的示例应用程序。

为了测试这一点，我正在使用`Socket Test 3.0`（来自 SourceForge）。创建一个套接字`127.0.0.1:8080`并将其`GET / HTTP/1.1`作为内容发送。正如预期的那样，Chrome 应用程序会使用 html 文件和正确的标题进行响应。我可以多次重复此操作而无需重新启动应用程序。当应用程序通过 Chrome 发送请求时，就会出现问题。乍一看，它按预期工作，但随后它在刷新*时超时。*这也在示例应用程序中复制。

在调试时，我发现每件事都在处理。写入套接字被销毁并`socket.accept(serverSocket, ...)`发出。我还确保它是在`socket.write`. 预期的第一个请求是针对请求的页面（`GET / HTTP/1.1`for `localhost:8080`）。第二个是 favicon.ico 作为`GET /favicon.ico HTTP/1.1`. 然后是第三个没有数据的连接（然后被忽略并销毁套接字）。与 SocketTest 中的每个请求都得到回复不同。

我在[YouTube 上](http://youtu.be/W5-0PDgJSJw)重现错误时创建了一段视频，显示截屏视频。我正在处理的项目的 repo 也在[GitHub 上](https://github.com/shantanuthatte/OSC_Server)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-27T01:59:51.010

我在使用 Google 的示例网络服务器时遇到了同样的问题。我写了一个更健壮的不会挂起的套接字服务器应用程序。源代码位于 GitHub 上的[https://github.com/kzahel/web-server-chrome](https://github.com/kzahel/web-server-chrome)，您可以从 Chrome 网上商店安装它，网址为[https://chrome.google.com/webstore/detail/web-server- for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb](https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb)

# javascript - 如何使用 CamanJS 更改图像？

> ID：15032973
> 
> 赞同：7
> 
> 时间：2013-02-22T20:51:19.720
> 
> 标签：javascript, html, html5-canvas, image-manipulation

我有多个图像，我想`<canvas>`在不同的时间点将它们分别加载到一个元素中，然后使用[CamanJS](http://camanjs.com/)操作它们。我可以让第一张图片看起来像这样：

```
Caman('#canvas-element', '/images/one.jpg'); 
```

但是当我随后尝试使用以下代码更新相同的元素时，它不起作用。

```
Caman('#canvas-element', '/images/two.jpg'); 
```

有什么方法可以重置/清除/刷新画布并将新的图像数据加载到其中，还是我真的需要为`<canvas>`要加载的每个图像创建单独的元素？我更喜欢单个元素，因为我不想吃掉所有的记忆。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-25T17:27:06.170

从 IMG 或 CANVAS 元素中移除 Caman 属性（data-caman-id），更改图像，然后重新渲染 Caman。

```
document
  .querySelector('#view_image')
  .removeAttribute('data-caman-id');

const switch_img = '/to/dir/img.png';

Caman("#view_image", switch_img, function() {
  this.render();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-05T08:10:31.763

希望遵循的代码可以帮助其他有相同需求的人。

```
function loadImage(source) {
    var canvas = document.getElementById('image_id');
    var context = canvas.getContext('2d');
    var image = new Image();
    image.onload = function() {
        context.drawImage(image, 0, 0, 960, 600);
    };
    image.src = source;
}

function change_image(source) {
    loadImage(source);
    Caman('#image_id', source, function () {
        this.reloadCanvasData();
         this.exposure(-10);
         this.brightness(5);
        this.render();
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T23:09:07.587

只是通过大量的试验和错误才弄清楚这一点，然后是一个愚蠢的时刻！

我没有直接在我的 html 中创建画布，而是创建了一个容器，然后执行以下操作：

```
var retStr = "<canvas id=\"" + myName + "Canvas\"></canvas>";
document.getElementById('photoFilterCanvasContainer').innerHTML = retStr;

Caman("#" + myName + "Canvas", myUrl, function() {
    this.render();
}); 
```

您希望每次使用新图像访问 Caman 函数时画布 ID 都是唯一的。

# java - android api调用返回简单数组

> ID：15032974
> 
> 赞同：0
> 
> 时间：2013-02-22T20:51:26.493
> 
> 标签：java, android

我正在调用一个 api，它应该返回一个长度在 0 到 9 之间的数组。现在我不明白如何获取该数组。获取其他api的简单字符串我的代码是：根据此代码工作正常。

```
private String test(String url)
{
    String str = null;
    int c;
    try
    {
    URL hp = new URL(url);  //The String hp1 is passed in URL

    URLConnection hpCon = hp.openConnection();  
    hpCon.setUseCaches(false);
    hpCon.setConnectTimeout(10000);
    System.out.println("*url content for: " + url);
    InputStream input=hpCon.getInputStream();
    StringBuffer sb = new StringBuffer();

    while(((c=input.read())!= -1))
    {
        sb.append((char)c);
    }
    str=sb.toString();
    sb = null;
    //System.out.print(str);

    input.close();
    input = null;
    hpCon = null;
    hp = null;
    }
    catch(Exception e)
    {

    }
    return str;  
} 
```

# c++ - boost::shared_ptr 循环依赖

> ID：15032976
> 
> 赞同：3
> 
> 时间：2013-02-22T20:51:37.800
> 
> 标签：c++, tree, include, shared-ptr

我有一个问题，我在每个级别使用不同的类实现了一棵树。指向树项的指针是 boost::shared_ptr<>。

因为每个级别都存储了一个指向父级的指针和一个指向其子级的指针，所以头文件中存在循环依赖关系。

代码如下所示：

```
//A.hpp
class A
{
    List<boost::shared_ptr<B> > children;
};

//B.hpp
class B{
   boost::shared_ptr<A> parent;

}; 
```

因为我使用 boost::shared_ptr 我不能在 B.hhp 中使用前向声明。但我不知道如何解决这个问题。如果你能帮助我，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-22T20:57:41.793

> 因为我使用 boost::shared_ptr 我不能在 B.hhp 中使用前向声明

这不是真的。声明 a`shared_ptr<>`不应该要求指向的类型是完整的：

```
#include <boost/shared_ptr.hpp>

class A;

int main()
{
    boost::shared_ptr<A> pA; // OK
}

class A { }; 
```

您的问题不在于对头文件的相互依赖。您绝对*可以*使用前向声明来打破这些依赖关系。

您遇到的问题是使彼此保持活动状态的对象之间的循环引用。要打破这个循环，请使用`boost::weak_ptr`.

此外，C++11 引入了标准类模板`std::shared_ptr`和`std::weak_ptr`（在`<memory>`标题中定义），因此除非您使用 C++03，否则您应该考虑使用这些类模板而不是 Boost 的类模板。

```
//A.hpp
class A
{
    List<boost::shared_ptr<B> > children;
};

//B.hpp
class B{
   boost::weak_ptr<A> parent;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T20:57:14.150

您应该使用[`boost::weak_ptr`](http://www.boost.org/doc/libs/release/libs/smart_ptr/weak_ptr.htm)in`B`来打破循环：

```
//A.hpp
class A
{
    List<boost::shared_ptr<B> > children;
};

//B.hpp
class B
{
   boost::weak_ptr<A> parent;
}; 
```

可以用方法[转换](http://www.boost.org/doc/libs/1_53_0/libs/smart_ptr/weak_ptr.htm#lock)成。`boost::shared_ptr<A>``lock()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T20:58:03.650

从孩子到父母的指针（那些“向上”树的指针）应该是[boost::weak_ptr](http://www.boost.org/doc/libs/1_53_0/libs/smart_ptr/weak_ptr.htm)。这将有效地打破你的循环依赖，同时仍然可以通过 boost::shared_ptrs （通过weak_ptr::lock() 函数）访问父母。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T21:02:52.523

这是经典的智能指针。您必须以某种方式`weak_ptr`在某个方向上使用来打破依赖关系。

它的工作方式是*不*`weak_ptr`持有指向对象的引用。但是你可以在任何给定时间通过调用它的函数来获得。你必须小心，但不要在不知何故过期*后打电话。**`shared_ptr``.lock()``.lock()` *`shared_ptr`**

 **我使用这种机制的方式如下：你总是对`shared_ptr`你的父母不给你的孩子，你总是对`weak_ptr`你的孩子不给你的父母。所以你永远不会有循环依赖，因为你不能在你的层次结构中做一个硬链接。

这种方式是有道理的（但它可能会根据您的特定情况而有所不同）：如果孩子存在，那么父母必须仍然存在，因此调用`.lock()`不会`weak_ptr`失败。

`weak_ptr`您可以在[Boost 文档](http://www.boost.org/doc/libs/1_53_0/libs/smart_ptr/weak_ptr.htm)中了解更多信息。**

# java - 初学者Java静态范围错误

> ID：15032977
> 
> 赞同：-1
> 
> 时间：2013-02-22T20:51:42.700
> 
> 标签：java, static, scope

（对于初学者 Java 类）作业指定我只创建一个 Scanner 实例，并且我需要在多个方法中使用它，所以我在 main 之外声明了它。我声明了一个数组并尝试将其与方法调用 initialCash() 等同起来，就像我在 Python 中所做的那样。问题是如果我将 initialCash 方法设为静态，我就不能使用 Scanner。如果 initialCash() 不是静态的，Eclipse 会告诉我它“不能对非静态方法进行静态引用”。（in the money = initialCash(); line）我该如何解决这个问题？

```
package proj1;

import java.util.Scanner;

public class Project1 
{
    Scanner scanner = new Scanner(System.in);

    public static void main(String[] args) 
    {
        int[] money = new int[4]; 
        money = initialCash();

    }   
    public int[] initialCash()
    {
        int[] initialMoney = new int[4];

        while(true)
        {
            System.out.print("Ones: ");
            initialMoney[0] = scanner.nextInt();
            System.out.print("Fives: ");
            initialMoney[1] = scanner.nextInt();
            System.out.print("Tens: ");
            initialMoney[2] = scanner.nextInt();
            System.out.print("Twenties: ");
            initialMoney[3] = scanner.nextInt();

            if((initialMoney[0]>=0)&&(initialMoney[1]>=0)&&(initialMoney[2]>=0)&&(initialMoney[3]>0))    
            {
                return initialMoney;
            }
            else
            {
                System.out.println("One or more invalid denominations. Try again.");
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T20:53:25.467

创建您的类的一个实例并从 main 调用该实例上的 initialCash。

```
money = new Project1().initialCash(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-31T21:01:05.230

PermGenError 所说的肯定会起作用，或者您可以将 initalCash() 方法和扫描仪引用变量都设为静态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-08T01:31:29.603

在您的代码中，该行

`Scanner scanner = new Scanner(System.in);`

每次创建类型的对象时都会创建一个新`Scanner`对象`Project1`。而如果你把它写成

`static Scanner scanner = new Scanner(System.in);`

它将创建一个`Scanner`实例供所有引用该对象的类使用。在您提到的问题中，必须只有一个 Scanner 对象，如果是这样，这就是要走的路。

如果你使用

`money = new Project1().initialCash();`

您正在创建一个新`Project1`对象以及一个新的 Scanner 对象，如果您要`Scanner`通过调用另一个函数来重用该对象，那么您不能因为它与 的特定实例相关联`Project1`，所以我建议您制作它`static`，与`initialCash`函数，它与该对象实例相关联。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-10T04:41:37.320

将 Scanner 和 initialMoney 方法设为静态。这应该可以解决您的问题。

```
static Scanner scanner = new Scanner(System.in);

public static void main(String[] args)
{
    int[] money = new int[4];
    money = initialCash();

}
public static int[] initialCash()
{
    int[] initialMoney = new int[4];

    while(true)
    {
        System.out.print("Ones: ");
        initialMoney[0] = scanner.nextInt();
        System.out.print("Fives: ");
        initialMoney[1] = scanner.nextInt();
        System.out.print("Tens: ");
        initialMoney[2] = scanner.nextInt();
        System.out.print("Twenties: ");
        initialMoney[3] = scanner.nextInt();

        if((initialMoney[0]>=0)&&(initialMoney[1]>=0)&&(initialMoney[2]>=0)&&(initialMoney[3]>0))
        {
            return initialMoney;
        }
        else
        {
            System.out.println("One or more invalid denominations. Try again.");
        }
    }

} 
```

# java - 我们应该使用 ApacheCXF 还是 EJB 来传递逻辑和 Web 模块？

> ID：15032978
> 
> 赞同：0
> 
> 时间：2013-02-22T20:51:42.733
> 
> 标签：java, jakarta-ee, tomcat, glassfish, ejb

我们目前正在为大学开发一个网络应用程序，我们希望得到更有经验的开发人员的一些建议。

我们有一个使用 Hibernate 对 MySQL 数据库进行操作的后端。另一个项目是使用后端提供的 API 的 Web UI（注册用户、获取与某些配置文件关联的数据等）。我们为 UI 使用 JSF 框架 (RichFaces)。一切都是使用 Maven 构建的。

我们无法决定的技术是用于 UI 和逻辑模块之间的通信。第一个选项是使用 ApacheCXF 提供 UI 可以作为客户端的 SOAP Web 服务。第二个选项是使用 EJB 从 UI 模块调用后端方法。

哪种方法使用更广泛？就我们在​​ Web 上阅读的内容而言，使用 EJB 比使用 SOAP Web 服务要快。另一方面，我们对使用 Tomcat 的 EJB 没有任何经验（我们更喜欢使用 Tomcat，因为它似乎是一个更便宜的选择，但是我们不知道要在 Tomcat 中使用 EJB 需要做什么）。此外，从一开始就使用 Web 服务将使我们能够添加对不同平台（例如，Android）的支持。

我们正在讨论的另一个方面是应该如何部署应用程序。我们现在考虑的替代方案是：

1.  将其部署为单个 WAR 项目（这将解决我们在将 UI 与应用程序后端通信时遇到的问题）。
2.  使用 Web 服务在同一服务器上部署两个 WAR 项目，以便在项目之间进行通信。（我们有一个使用这种方法的原型部署在 Tomcat 服务器上）
3.  部署 WAR 项目和 EJB 项目。
4.  部署一个包含对 WAR 和 EJB 项目的引用的 EAR 项目。（我们有一个使用这种方法的原型部署在 Glassfish 服务器上）

该项目现在正在启动，所以我们现在只会处理几百个用户。但是，如果项目成功，我们将需要处理数百万用户。

任何意见，将不胜感激。谢谢。

编辑：那么关于如何部署项目的任何建议？有必要使用EAR吗？如果我们将项目部署为 EAR 模块有什么好处吗？

编辑 2：我们在这个线程上找到了我们需要的建议：[部署 java 应用程序 (Tomcat/Glassfish)](https://stackoverflow.com/questions/15042973/deploying-java-applications-tomcat-glassfish)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:49:25.020

我们在工作中使用 ApacheCXF，它有 SOAP 和 Restful。可靠且相对容易设置。我不确定你为什么要使用 glassfish，也许它是首选，但你也可以在 eclipse 中实现你的项目。这真的取决于您和您的团队以及您的团队可能必须构建和支持的要求和技能集，带有两个war文件的CXF webservice + apache + eclipse将是一个很好的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T22:45:11.157

第一件事。如果不需要，我会避免使用 Web 服务。如果你觉得你可能需要从外部程序和平台调用这个系统，那就去吧。即使这样，我也只会使用 Web 服务接口进行外部集成，并且仍然有一个内部 EJB 实现。

EJB 非常适合企业应用程序。我强烈建议你调查一下。它们为 EJB 池、事务、面向方面的编程、安全性、有状态会话、Java 消息传递、JNDI 等提供支持。您可以将它们直接注入到托管 Bean (JSF) 中。您说您最终将处理数百万用户，因此我假设您希望您的应用程序尽可能快地运行，我认为 SOAP Web 服务不适合。请记住，SOAP Web 服务将消息编码为文本，因此如果您的应用程序将发送二进制文件等，那么您将遇到严重的性能问题。

就部署而言，我会使用 EAR，或者为 JSF 和 EAR 后端使用 WAR。您可以使用 Injection 从多个 Web 应用程序和其他 EAR 应用程序中提取您需要的类，甚至可以远程提取。

我不确定你为什么说 Tomcat**更便宜**。Glassfish 开源版是一个功能齐全的 JavaEE6 服务器并且它是免费的。JBoss 也符合 JavaEE 并且是免费的。它们都用于许多生产环境。我发现 glassfish 对用户更加友好，并且会推荐给 EJB 菜鸟 :)

我也开始使用Tomcat，但现在我根本不使用它。当你可以拥有整个沙邦时，为什么只使用 servlet 容器？希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T20:20:30.027

在这种情况下，我不会使用 Web 服务。您可以使用托管 bean 作为控制器。将逻辑放入 EJB，将视图放入丰富的面孔中，并使用托管 bean 控制流程。

如果您使用 maven，您可以生成具有 EAR 结构的项目（web 模块的 war 和 ejbs 的 jar）。我不记得原型的名称，但您可以轻松找到它。

# linux - ft-models.out 生成文件错误

> ID：15032983
> 
> 赞同：-1
> 
> 时间：2013-02-22T20:51:55.083
> 
> 标签：linux, makefile, ubuntu-12.04

我只是尝试编译一个makefile，但是没有用，我的Makefile是这样的，

这对我来说非常重要，我将上传并发布所有文件夹的链接，如果有人可以帮助我，他可能会去天堂：D 这是我所有文件夹的链接，任何人都可以在 LINUX 上运行此代码吗？ [http://s2.dosya.tc/server/OfLhtU/Desktop.zip.html](http://s2.dosya.tc/server/OfLhtU/Desktop.zip.html)

```
TRAIN=correctparses_03.txt.gz
TEST=test.1.2.dis.gz
FST=tfeatures.fst turknum.fst turkunk.fst unknown.fst
SCRIPTS=lookup dlist script.txt singleline.pl merge.pl features.pl ft-models.pl          ft-model-eval.pl
LIBS    =   -L"/usr/include/glib-2.0"   -lglib

all: eval.out

eval.out: test.features.gz ft-model-eval.pl ft-models.out
@echo === Evaluating the disambiguation model
zcat $< | ft-model-eval.pl -v > $@ 2> eval.err
tail -5 eval.err

test.features.gz: test.merge.gz features.pl
@echo === Preparing testing features for a +-2 word window
zcat $< | features.pl | gzip > $@

test.merge.gz: ${TEST} test.lookup.gz merge.pl
@echo === Merging answers in testing file with lookup results
merge.pl 'zcat ${TEST} |' 'zcat test.lookup.gz |'  2> $@.err | gzip > $@

test.lookup.gz: ${TEST} ${FST} script.txt singleline.pl lookup
@echo === Running lookup on the testing file
zcat $< | awk '{print $$1}' | lookup -f script.txt | singleline.pl | gzip > $@

ft-models.out: ft-models.pl dlist train.features.gz
@echo === Training individual feature models
ft-models.pl 'zcat train.features.gz |'

train.features.gz: train.merge.gz features.pl
@echo === Preparing training features for a +-2 word window
zcat $< | features.pl | gzip > $@

train.merge.gz: ${TRAIN} train.lookup.gz merge.pl
@echo === Merging answers in training file with lookup results
merge.pl 'zcat ${TRAIN} |' 'zcat train.lookup.gz |' 2> $@.err | gzip > $@

train.lookup.gz: ${TRAIN} ${FST} script.txt singleline.pl lookup
@echo === Running lookup on the training file
zcat $< | awk '{print $$1}' | lookup -f script.txt | singleline.pl | gzip > $@

clean:
-rm train.lookup.gz
-rm train.merge.gz train.merge.gz.err
-rm train.features.gz
-rm -rf ft-models.out
-rm test.lookup.gz
-rm test.merge.gz tst.merge.gz.err
-rm test.features.gz
-rm dlist.{dbg,tst,trn,val}
-rm eval.{out,err}

# To compile the dlist decision list induction program:

# CC=gcc
# CFLAGS=-O3 -Wall -I. `pkg-config --cflags glib-2.0`
# LIBS=`pkg-config --libs glib-2.0`

# dlist: dlist.o glib-ext.o
#   $(CC) $(CFLAGS) $^ $(LIBS) -o $@

# dlist.o: dlist.c glib-ext.h

# glib-ext.o: glib-ext.c glib-ext.h 
```

当我运行这个make文件时，错误是；

```
 make: ft-models.pl: Command not found
 make: *** [ft-models.out] Error 127 
```

我该如何解决？谢谢...

,

第一个错误实际上是这个

```
=== Running lookup on the testing file
zcat test.1.2.dis.gz | awk '{print $1}' | lookup -f script.txt | singleline.pl | gzip > test.lookup.gz
/bin/sh: 1: lookup: not found
/bin/sh: 1: singleline.pl: not found
=== Merging answers in testing file with lookup results
merge.pl 'zcat test.1.2.dis.gz |' 'zcat test.lookup.gz |'  2> test.merge.gz.err | gzip      > test.merge.gz
=== Preparing testing features for a +-2 word window
zcat test.merge.gz | features.pl | gzip > test.features.gz
/bin/sh: 1: features.pl: not found
=== Running lookup on the training file
zcat correctparses_03.txt.gz | awk '{print $1}' | lookup -f script.txt | singleline.pl | gzip > train.lookup.gz
/bin/sh: 1: singleline.pl: not found
/bin/sh: 1: lookup: not found
=== Merging answers in training file with lookup results
merge.pl 'zcat correctparses_03.txt.gz |' 'zcat train.lookup.gz |' 2> train.merge.gz.err | gzip > train.merge.gz
=== Preparing training features for a +-2 word window
zcat train.merge.gz | features.pl | gzip > train.features.gz
/bin/sh: 1: features.pl: not found
=== Training individual feature models
./ft-models.pl 'zcat train.features.gz |'
Finding unique morphological features in data
Found 0 morphological features
=== Evaluating the disambiguation model
zcat test.features.gz | ft-model-eval.pl -v > eval.out 2> eval.err
make: *** [eval.out] Error 127 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T01:25:28.467

可能需要几个步骤来解决这个问题。在第 28 行，更改：

```
ft-models.pl ... 
```

对此：

```
./ft-models.pl ... 
```

告诉我们结果（在对此答案的评论中）。

**编辑：**

好的！现在在第 20 和 36 行，更改：

```
merge.pl ... 
```

对此：

```
./merge.pl ... 
```

并告诉我们会发生什么。

# python - 返回函数的函数的 Python 命名约定

> ID：15032984
> 
> 赞同：5
> 
> 时间：2013-02-22T20:51:56.363
> 
> 标签：python, coding-style, naming-conventions

对于返回另一个函数的函数，Python 命名约定是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T21:00:44.713

[函数装饰器](http://www.python.org/dev/peps/pep-0318/#examples)是返回函数的函数的示例。在（链接的）示例部分中，似乎没有使用任何标准命名约定。我认为没有约定。如果您认为应该有，您可以随时[引入 PEP](http://www.python.org/dev/peps/pep-0001/#submitting-a-pep)。虽然，可能不应该有一个标准。只需[明智地命名函数](http://www.python.org/dev/peps/pep-0008/#naming-conventions)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T21:08:45.280

就像@Martijn Pieters 说的那样，没有，就像@kzh 说的那样，您可以引入 PEP。当我在 python 中遇到不适合 PEP-8 的东西时，我会使用 Cocoa（Apple 的框架）。

根据 Cocoa 的说法，一个方法应该通过它的名字准确地告诉我它做了什么，如果它返回一些东西，那么这个东西应该是选择器中的第一个词（方法名）。

例如，

根据其他参数返回字符串的方法应为：

```
def stringForObjectNamed(anObjectName): 
```

或者

```
def string_for_object_named(an_object_name): 
```

所以在你的情况下：

```
def function_for_param1_and_param2(param1, param2): 
```

或者

```
def method_for_param1_and_param2(param1, param2): 
```

一开始就给我类型，所以我不需要检查方法来弄清楚它应该给我什么。而且由于 python 不是静态类型的，这非常有用。

# actionscript-3 - 如何通过 navigateToURL 传递数据？

> ID：15032987
> 
> 赞同：0
> 
> 时间：2013-02-22T20:52:02.500
> 
> 标签：actionscript-3, flash, url, web

```
navigateToURL(new URLRequest("other.html"), "_self"); 
```

other.html 中嵌入了一个 swf。有没有办法可以将变量传递给嵌入在 other.html 中的 swf。

原因是我需要告诉 swf 用户是否已登录，如果他已登录，请将用户详细信息传递给它。随意建议可能更有效的替代方法。

我的整个网站都是用 Flash 制作的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T20:55:26.267

好久没写flash了，不过假设'+'是字符串拼接的方式...

对于 GET 变量，我会这样做：

```
var url:String = "other.html";
url += "?someParam=someValue";
url += "&someOtherParam=someOtherValue";
navigateToURL(new URLRequest(url), "_self"); 
```

这有效地制作了您的网址：

```
"other.html?someParam=someValue&someOtherParam=someOtherValue" 
```

**编辑：**

像这样实际获取查询变量的东西......

```
function loaderComplete(myEvent:Event)
{
  var myQueryStrings=this.loaderInfo.parameters;
  var someParamValue:String=myQueryStrings.someParam;
}

this.loaderInfo.addEventListener(Event.COMPLETE, loaderComplete); 
```

# hadoop - Sqoop 增量导入到 S3 Wrong FS 错误

> ID：15032995
> 
> 赞同：4
> 
> 时间：2013-02-22T20:52:56.600
> 
> 标签：hadoop, cloudera, sqoop

在 中使用`--incremental append`标志时`sqoop import`，作业将失败。

`ERROR tool.ImportTool: Imported Failed: Wrong FS: s3n://<api_key>:<api_secret>@bucket/folder/`

这是完整的命令：

`sqoop import --connect jdbc:postgresql://someplace.net:12345/db --warehouse-dir s3n://<key>:<private>@bucket/folder/ --table my_table --hive-drop-import-delims --escaped-by "\\" --username root --password safepass -m 2 --split-by id --incremental append --check-column id`

`--incremental' and`没有--check-column的完全相同的命令可以正常工作，并按预期上传到正确的 s3 目录。我希望能够运行增量导入并将其上传到 s3。

我正在使用 Sqoop 1.4.1-cdh4.1.3

完整输出：

```
13/02/23 12:02:10 DEBUG sqoop.ConnFactory: Loaded manager factory: com.cloudera.sqoop.manager.DefaultManagerFactory
13/02/23 12:02:10 DEBUG sqoop.ConnFactory: Trying ManagerFactory: com.cloudera.sqoop.manager.DefaultManagerFactory
13/02/23 12:02:10 DEBUG manager.DefaultManagerFactory: Trying with scheme: jdbc:postgresql:
13/02/23 12:02:10 INFO manager.SqlManager: Using default fetchSize of 1000
13/02/23 12:02:10 DEBUG sqoop.ConnFactory: Instantiated ConnManager org.apache.sqoop.manager.PostgresqlManager@5239443f
13/02/23 12:02:10 INFO tool.CodeGenTool: Beginning code generation
13/02/23 12:02:10 DEBUG manager.SqlManager: No connection paramenters specified. Using regular API for making connection.
13/02/23 12:02:11 DEBUG manager.SqlManager: Using fetchSize for next query: 1000
13/02/23 12:02:11 INFO manager.SqlManager: Executing SQL statement: SELECT t.* FROM "fan_pages_facebookpage" AS t LIMIT 1
13/02/23 12:02:11 DEBUG orm.ClassWriter: selected columns:
13/02/23 12:02:11 DEBUG orm.ClassWriter:   id
13/02/23 12:02:11 DEBUG orm.ClassWriter:   name
13/02/23 12:02:11 DEBUG orm.ClassWriter:   page_id
13/02/23 12:02:11 DEBUG orm.ClassWriter:   category_id
13/02/23 12:02:11 DEBUG orm.ClassWriter:   is_published
13/02/23 12:02:11 DEBUG orm.ClassWriter:   website
13/02/23 12:02:11 DEBUG orm.ClassWriter:   username
13/02/23 12:02:11 DEBUG orm.ClassWriter:   description
13/02/23 12:02:11 DEBUG orm.ClassWriter:   about
13/02/23 12:02:11 DEBUG orm.ClassWriter:   can_post
13/02/23 12:02:11 DEBUG orm.ClassWriter:   talking_about_count
13/02/23 12:02:11 DEBUG orm.ClassWriter:   link
13/02/23 12:02:11 DEBUG orm.ClassWriter:   picture
13/02/23 12:02:11 DEBUG orm.ClassWriter:   last_synced_date
13/02/23 12:02:11 DEBUG orm.ClassWriter:   fans
13/02/23 12:02:11 DEBUG orm.ClassWriter: Writing source file: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.java
13/02/23 12:02:11 DEBUG orm.ClassWriter: Table name: fan_pages_facebookpage
13/02/23 12:02:11 DEBUG orm.ClassWriter: Columns: id:4, name:12, page_id:12, category_id:4, is_published:-7, website:12, username:12, description:12, about:12, can_post:-7, talking_about_count:4, link:12, picture:12, last_synced_date:93, fans:4, 
13/02/23 12:02:11 DEBUG orm.ClassWriter: sourceFilename is fan_pages_facebookpage.java
13/02/23 12:02:11 DEBUG orm.CompilationManager: Found existing /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/
13/02/23 12:02:11 INFO orm.CompilationManager: HADOOP_HOME is /usr/lib/hadoop
13/02/23 12:02:11 DEBUG orm.CompilationManager: Adding source file: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.java
13/02/23 12:02:11 DEBUG orm.CompilationManager: Invoking javac with args:
13/02/23 12:02:11 DEBUG orm.CompilationManager:   -sourcepath
13/02/23 12:02:11 DEBUG orm.CompilationManager:   /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/
13/02/23 12:02:11 DEBUG orm.CompilationManager:   -d
13/02/23 12:02:11 DEBUG orm.CompilationManager:   /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/
13/02/23 12:02:11 DEBUG orm.CompilationManager:   -classpath
13/02/23 12:02:11 DEBUG orm.CompilationManager:   /etc/hadoop/conf:/usr/lib/hadoop/lib/commons-beanutils-core-1.8.0.jar:/usr/lib/hadoop/lib/log4j-1.2.17.jar:/usr/lib/hadoop/lib/jsr305-1.3.9.jar:/usr/lib/hadoop/lib/guava-11.0.2.jar:/usr/lib/hadoop/lib/paranamer-2.3.jar:/usr/lib/hadoop/lib/asm-3.2.jar:/usr/lib/hadoop/lib/jets3t-0.6.1.jar:/usr/lib/hadoop/lib/jettison-1.1.jar:/usr/lib/hadoop/lib/slf4j-log4j12-1.6.1.jar:/usr/lib/hadoop/lib/jackson-jaxrs-1.8.8.jar:/usr/lib/hadoop/lib/jsch-0.1.42.jar:/usr/lib/hadoop/lib/commons-el-1.0.jar:/usr/lib/hadoop/lib/commons-collections-3.2.1.jar:/usr/lib/hadoop/lib/servlet-api-2.5.jar:/usr/lib/hadoop/lib/commons-codec-1.4.jar:/usr/lib/hadoop/lib/jasper-runtime-5.5.23.jar:/usr/lib/hadoop/lib/jersey-json-1.8.jar:/usr/lib/hadoop/lib/kfs-0.3.jar:/usr/lib/hadoop/lib/slf4j-api-1.6.1.jar:/usr/lib/hadoop/lib/jersey-core-1.8.jar:/usr/lib/hadoop/lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hadoop/lib/commons-net-3.1.jar:/usr/lib/hadoop/lib/jackson-xc-1.8.8.jar:/usr/lib/hadoop/lib/mockito-all-1.8.5.jar:/usr/lib/hadoop/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop/lib/junit-4.8.2.jar:/usr/lib/hadoop/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop/lib/commons-beanutils-1.7.0.jar:/usr/lib/hadoop/lib/jaxb-impl-2.2.3-1.jar:/usr/lib/hadoop/lib/xmlenc-0.52.jar:/usr/lib/hadoop/lib/jersey-server-1.8.jar:/usr/lib/hadoop/lib/commons-io-2.1.jar:/usr/lib/hadoop/lib/jasper-compiler-5.5.23.jar:/usr/lib/hadoop/lib/jsp-api-2.1.jar:/usr/lib/hadoop/lib/jline-0.9.94.jar:/usr/lib/hadoop/lib/activation-1.1.jar:/usr/lib/hadoop/lib/commons-httpclient-3.1.jar:/usr/lib/hadoop/lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hadoop/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop/lib/commons-configuration-1.6.jar:/usr/lib/hadoop/lib/commons-logging-1.1.1.jar:/usr/lib/hadoop/lib/commons-math-2.1.jar:/usr/lib/hadoop/lib/commons-cli-1.2.jar:/usr/lib/hadoop/lib/jaxb-api-2.2.2.jar:/usr/lib/hadoop/lib/zookeeper-3.4.3-cdh4.1.3.jar:/usr/lib/hadoop/lib/commons-digester-1.8.jar:/usr/lib/hadoop/lib/stax-api-1.0.1.jar:/usr/lib/hadoop/lib/commons-lang-2.5.jar:/usr/lib/hadoop/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop/.//hadoop-common.jar:/usr/lib/hadoop/.//hadoop-annotations-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop/.//hadoop-annotations.jar:/usr/lib/hadoop/.//hadoop-auth.jar:/usr/lib/hadoop/.//hadoop-auth-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop/.//hadoop-common-2.0.0-cdh4.1.3-tests.jar:/usr/lib/hadoop/.//hadoop-common-2.0.0-cdh4.1.3.jar:/usr/lib/sqoop/conf:/etc/zookeeper::/usr/lib/sqoop/lib/ant-contrib-1.0b3.jar:/usr/lib/sqoop/lib/ant-eclipse-1.0-jvm1.2.jar:/usr/lib/sqoop/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/sqoop/lib/avro-ipc-1.7.1.cloudera.2.jar:/usr/lib/sqoop/lib/avro-mapred-1.7.1.cloudera.2.jar:/usr/lib/sqoop/lib/commons-io-1.4.jar:/usr/lib/sqoop/lib/hsqldb-1.8.0.10.jar:/usr/lib/sqoop/lib/jackson-core-asl-1.8.8.jar:/usr/lib/sqoop/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/sqoop/lib/jetty-util-6.1.26.jar:/usr/lib/sqoop/lib/netty-3.4.0.Final.jar:/usr/lib/sqoop/lib/paranamer-2.3.jar:/usr/lib/sqoop/lib/servlet-api-2.5-20081211.jar:/usr/lib/sqoop/lib/snappy-java-1.0.4.1.jar:/usr/lib/sqoop/postgresql-9.0-802.jdbc4.jar:/usr/lib/sqoop/sqoop-1.4.1-cdh4.1.3.jar:/usr/lib/sqoop/sqoop-test-1.4.1-cdh4.1.3.jar::/usr/lib/hadoop-hdfs/./:/usr/lib/hadoop-hdfs/lib/log4j-1.2.17.jar:/usr/lib/hadoop-hdfs/lib/jsr305-1.3.9.jar:/usr/lib/hadoop-hdfs/lib/commons-daemon-1.0.3.jar:/usr/lib/hadoop-hdfs/lib/guava-11.0.2.jar:/usr/lib/hadoop-hdfs/lib/asm-3.2.jar:/usr/lib/hadoop-hdfs/lib/commons-el-1.0.jar:/usr/lib/hadoop-hdfs/lib/servlet-api-2.5.jar:/usr/lib/hadoop-hdfs/lib/commons-codec-1.4.jar:/usr/lib/hadoop-hdfs/lib/jasper-runtime-5.5.23.jar:/usr/lib/hadoop-hdfs/lib/jersey-core-1.8.jar:/usr/lib/hadoop-hdfs/lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hadoop-hdfs/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-hdfs/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-hdfs/lib/xmlenc-0.52.jar:/usr/lib/hadoop-hdfs/lib/jersey-server-1.8.jar:/usr/lib/hadoop-hdfs/lib/commons-io-2.1.jar:/usr/lib/hadoop-hdfs/lib/jsp-api-2.1.jar:/usr/lib/hadoop-hdfs/lib/jline-0.9.94.jar:/usr/lib/hadoop-hdfs/lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hadoop-hdfs/lib/commons-logging-1.1.1.jar:/usr/lib/hadoop-hdfs/lib/commons-cli-1.2.jar:/usr/lib/hadoop-hdfs/lib/zookeeper-3.4.3-cdh4.1.3.jar:/usr/lib/hadoop-hdfs/lib/commons-lang-2.5.jar:/usr/lib/hadoop-hdfs/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-hdfs/.//hadoop-hdfs-2.0.0-cdh4.1.3-tests.jar:/usr/lib/hadoop-yarn/lib/log4j-1.2.17.jar:/usr/lib/hadoop-yarn/lib/paranamer-2.3.jar:/usr/lib/hadoop-yarn/lib/asm-3.2.jar:/usr/lib/hadoop-yarn/lib/guice-3.0.jar:/usr/lib/hadoop-yarn/lib/aopalliance-1.0.jar:/usr/lib/hadoop-yarn/lib/jersey-core-1.8.jar:/usr/lib/hadoop-yarn/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-yarn/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop-yarn/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-yarn/lib/jersey-server-1.8.jar:/usr/lib/hadoop-yarn/lib/commons-io-2.1.jar:/usr/lib/hadoop-yarn/lib/javax.inject-1.jar:/usr/lib/hadoop-yarn/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop-yarn/lib/netty-3.2.4.Final.jar:/usr/lib/hadoop-yarn/lib/guice-servlet-3.0.jar:/usr/lib/hadoop-yarn/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-yarn/lib/jersey-guice-1.8.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-common-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests-2.0.0-cdh4.1.3-tests.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-nodemanager.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-common.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-site-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-api-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-web-proxy.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-web-proxy-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-applications-distributedshell.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-site.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-api.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-resourcemanager.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-common-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-resourcemanager-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-nodemanager-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-applications-distributedshell-2.0.0-cdh4.1.3.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-common.jar:/usr/lib/hadoop-yarn/.//hadoop-yarn-server-tests.jar:/usr/lib/hadoop-0.20-mapreduce/./:/usr/lib/hadoop-0.20-mapreduce/lib/commons-beanutils-core-1.8.0.jar:/usr/lib/hadoop-0.20-mapreduce/lib/aspectjtools-1.6.5.jar:/usr/lib/hadoop-0.20-mapreduce/lib/log4j-1.2.17.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jsr305-1.3.9.jar:/usr/lib/hadoop-0.20-mapreduce/lib/guava-11.0.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/paranamer-2.3.jar:/usr/lib/hadoop-0.20-mapreduce/lib/asm-3.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/avro-compiler-1.7.1.cloudera.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jets3t-0.6.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jettison-1.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jackson-jaxrs-1.8.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jsch-0.1.42.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-el-1.0.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-collections-3.2.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/servlet-api-2.5.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-codec-1.4.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jasper-runtime-5.5.23.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jersey-json-1.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/kfs-0.3.jar:/usr/lib/hadoop-0.20-mapreduce/lib/kfs-0.2.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/slf4j-api-1.6.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jersey-core-1.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jetty-6.1.26.cloudera.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-net-3.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jackson-xc-1.8.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/mockito-all-1.8.5.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jackson-core-asl-1.8.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/junit-4.8.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/snappy-java-1.0.4.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jackson-mapper-asl-1.8.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/aspectjrt-1.6.5.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-beanutils-1.7.0.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jaxb-impl-2.2.3-1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/xmlenc-0.52.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jersey-server-1.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-io-2.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jasper-compiler-5.5.23.jar:/usr/lib/hadoop-0.20-mapreduce/lib/hsqldb-1.8.0.10.jar:/usr/lib/hadoop-0.20-mapreduce/lib/ant-contrib-1.0b3.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jsp-api-2.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/activation-1.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-httpclient-3.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jetty-util-6.1.26.cloudera.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/avro-1.7.1.cloudera.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-configuration-1.6.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-logging-1.1.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-math-2.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-cli-1.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/jaxb-api-2.2.2.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-digester-1.8.jar:/usr/lib/hadoop-0.20-mapreduce/lib/stax-api-1.0.1.jar:/usr/lib/hadoop-0.20-mapreduce/lib/commons-lang-2.5.jar:/usr/lib/hadoop-0.20-mapreduce/lib/protobuf-java-2.4.0a.jar:/usr/lib/hadoop-0.20-mapreduce/lib/hadoop-fairscheduler-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-2.0.0-mr1-cdh4.1.3-tools.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-2.0.0-mr1-cdh4.1.3-examples.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-examples-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-tools.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-ant.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-test-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-2.0.0-mr1-cdh4.1.3-ant.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-core.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-tools-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-core-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-2.0.0-mr1-cdh4.1.3-test.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-test.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-2.0.0-mr1-cdh4.1.3-core.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-examples.jar:/usr/lib/hadoop-0.20-mapreduce/.//hadoop-ant-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/hadoop-0.20-mapreduce/hadoop-core-2.0.0-mr1-cdh4.1.3.jar:/usr/lib/sqoop/sqoop-1.4.1-cdh4.1.3.jar
Note: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details.
13/02/23 12:02:19 DEBUG orm.CompilationManager: Could not rename /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.java to /home/users/alexkehayias/./fan_pages_facebookpage.java
java.io.FileNotFoundException: /home/users/alexkehayias/./fan_pages_facebookpage.java (Permission denied)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:209)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:160)
    at org.apache.commons.io.FileUtils.doCopyFile(FileUtils.java:936)
    at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:888)
    at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:835)
    at org.apache.commons.io.FileUtils.moveFile(FileUtils.java:2385)
    at org.apache.sqoop.orm.CompilationManager.compile(CompilationManager.java:227)
    at org.apache.sqoop.tool.CodeGenTool.generateORM(CodeGenTool.java:83)
    at org.apache.sqoop.tool.ImportTool.importTable(ImportTool.java:390)
    at org.apache.sqoop.tool.ImportTool.run(ImportTool.java:476)
    at org.apache.sqoop.Sqoop.run(Sqoop.java:145)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)
    at org.apache.sqoop.Sqoop.runSqoop(Sqoop.java:181)
    at org.apache.sqoop.Sqoop.runTool(Sqoop.java:220)
    at org.apache.sqoop.Sqoop.runTool(Sqoop.java:229)
    at org.apache.sqoop.Sqoop.main(Sqoop.java:238)
    at com.cloudera.sqoop.Sqoop.main(Sqoop.java:57)
13/02/23 12:02:19 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.jar
13/02/23 12:02:19 DEBUG orm.CompilationManager: Scanning for .class files in directory: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629
13/02/23 12:02:19 DEBUG orm.CompilationManager: Got classfile: /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.class -> fan_pages_facebookpage.class
13/02/23 12:02:19 DEBUG orm.CompilationManager: Finished writing jar file /tmp/sqoop-hdfs/compile/ecf12c8875f71c2d98db0ccde2516629/fan_pages_facebookpage.jar
13/02/23 12:02:19 DEBUG tool.ImportTool: Using temporary folder: 23120219788fan_pages_facebookpage
13/02/23 12:02:19 INFO tool.ImportTool: Maximal id query for free form incremental import: SELECT MAX(id) FROM fan_pages_facebookpage
13/02/23 12:02:19 INFO tool.ImportTool: Incremental import based on column "id"
13/02/23 12:02:19 INFO tool.ImportTool: Upper bound value: 2178
13/02/23 12:02:19 WARN manager.PostgresqlManager: It looks like you are importing from postgresql.
13/02/23 12:02:19 WARN manager.PostgresqlManager: This transfer can be faster! Use the --direct
13/02/23 12:02:19 WARN manager.PostgresqlManager: option to exercise a postgresql-specific fast path.
13/02/23 12:02:19 DEBUG manager.CatalogQueryManager: Retrieving primary key for table 'fan_pages_facebookpage' with query SELECT col.ATTNAME FROM PG_CATALOG.PG_NAMESPACE sch,   PG_CATALOG.PG_CLASS tab, PG_CATALOG.PG_ATTRIBUTE col,   PG_CATALOG.PG_INDEX ind WHERE sch.OID = tab.RELNAMESPACE   AND tab.OID = col.ATTRELID   AND tab.OID = ind.INDRELID   AND sch.NSPNAME = (SELECT CURRENT_SCHEMA())   AND tab.RELNAME = 'fan_pages_facebookpage'   AND col.ATTNUM = ANY(ind.INDKEY)   AND ind.INDISPRIMARY
13/02/23 12:02:19 DEBUG manager.CatalogQueryManager: Retrieving primary key for table 'fan_pages_facebookpage' with query SELECT col.ATTNAME FROM PG_CATALOG.PG_NAMESPACE sch,   PG_CATALOG.PG_CLASS tab, PG_CATALOG.PG_ATTRIBUTE col,   PG_CATALOG.PG_INDEX ind WHERE sch.OID = tab.RELNAMESPACE   AND tab.OID = col.ATTRELID   AND tab.OID = ind.INDRELID   AND sch.NSPNAME = (SELECT CURRENT_SCHEMA())   AND tab.RELNAME = 'fan_pages_facebookpage'   AND col.ATTNUM = ANY(ind.INDKEY)   AND ind.INDISPRIMARY
13/02/23 12:02:19 INFO mapreduce.ImportJobBase: Beginning import of fan_pages_facebookpage
13/02/23 12:02:20 DEBUG mapreduce.DataDrivenImportJob: Using table class: fan_pages_facebookpage
13/02/23 12:02:20 DEBUG mapreduce.DataDrivenImportJob: Using InputFormat: class com.cloudera.sqoop.mapreduce.db.DataDrivenDBInputFormat
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/sqoop-1.4.1-cdh4.1.3.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/postgresql-9.0-802.jdbc4.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/sqoop-1.4.1-cdh4.1.3.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/sqoop-1.4.1-cdh4.1.3.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/paranamer-2.3.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/netty-3.4.0.Final.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/commons-io-1.4.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/jetty-util-6.1.26.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/servlet-api-2.5-20081211.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/jackson-core-asl-1.8.8.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/snappy-java-1.0.4.1.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/jackson-mapper-asl-1.8.8.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/hsqldb-1.8.0.10.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/ant-contrib-1.0b3.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/ant-eclipse-1.0-jvm1.2.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/avro-mapred-1.7.1.cloudera.2.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/avro-1.7.1.cloudera.2.jar
13/02/23 12:02:21 DEBUG mapreduce.JobBase: Adding to job classpath: file:/usr/lib/sqoop/lib/avro-ipc-1.7.1.cloudera.2.jar
13/02/23 12:02:24 WARN mapred.JobClient: Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
13/02/23 12:02:26 INFO db.DataDrivenDBInputFormat: BoundingValsQuery: SELECT MIN("id"), MAX("id") FROM "fan_pages_facebookpage" WHERE ( "id" <= 2178 )
13/02/23 12:02:26 DEBUG db.IntegerSplitter: Splits: [                           1 to                        2,178] into 4 parts
13/02/23 12:02:26 DEBUG db.IntegerSplitter:                            1
13/02/23 12:02:26 DEBUG db.IntegerSplitter:                          546
13/02/23 12:02:26 DEBUG db.IntegerSplitter:                        1,090
13/02/23 12:02:26 DEBUG db.IntegerSplitter:                        1,634
13/02/23 12:02:26 DEBUG db.IntegerSplitter:                        2,178
13/02/23 12:02:27 INFO mapred.JobClient: Running job: job_201302231136_0003
13/02/23 12:02:28 INFO mapred.JobClient:  map 0% reduce 0%
13/02/23 12:02:51 INFO mapred.JobClient:  map 25% reduce 0%
13/02/23 12:02:52 INFO mapred.JobClient:  map 50% reduce 0%
13/02/23 12:03:03 INFO mapred.JobClient:  map 100% reduce 0%
13/02/23 12:03:11 INFO mapred.JobClient: Job complete: job_201302231136_0003
13/02/23 12:03:11 INFO mapred.JobClient: Counters: 23
13/02/23 12:03:11 INFO mapred.JobClient:   File System Counters
13/02/23 12:03:11 INFO mapred.JobClient:     FILE: Number of bytes read=0
13/02/23 12:03:11 INFO mapred.JobClient:     FILE: Number of bytes written=667342
13/02/23 12:03:11 INFO mapred.JobClient:     FILE: Number of read operations=0
13/02/23 12:03:11 INFO mapred.JobClient:     FILE: Number of large read operations=0
13/02/23 12:03:11 INFO mapred.JobClient:     FILE: Number of write operations=0
13/02/23 12:03:11 INFO mapred.JobClient:     HDFS: Number of bytes read=412
13/02/23 12:03:11 INFO mapred.JobClient:     HDFS: Number of bytes written=1165120
13/02/23 12:03:11 INFO mapred.JobClient:     HDFS: Number of read operations=4
13/02/23 12:03:11 INFO mapred.JobClient:     HDFS: Number of large read operations=0
13/02/23 12:03:11 INFO mapred.JobClient:     HDFS: Number of write operations=4
13/02/23 12:03:11 INFO mapred.JobClient:   Job Counters 
13/02/23 12:03:11 INFO mapred.JobClient:     Launched map tasks=4
13/02/23 12:03:11 INFO mapred.JobClient:     Total time spent by all maps in occupied slots (ms)=64432
13/02/23 12:03:11 INFO mapred.JobClient:     Total time spent by all reduces in occupied slots (ms)=0
13/02/23 12:03:11 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0
13/02/23 12:03:11 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0
13/02/23 12:03:11 INFO mapred.JobClient:   Map-Reduce Framework
13/02/23 12:03:11 INFO mapred.JobClient:     Map input records=1935
13/02/23 12:03:11 INFO mapred.JobClient:     Map output records=1935
13/02/23 12:03:11 INFO mapred.JobClient:     Input split bytes=412
13/02/23 12:03:11 INFO mapred.JobClient:     Spilled Records=0
13/02/23 12:03:11 INFO mapred.JobClient:     CPU time spent (ms)=3110
13/02/23 12:03:11 INFO mapred.JobClient:     Physical memory (bytes) snapshot=507801600
13/02/23 12:03:11 INFO mapred.JobClient:     Virtual memory (bytes) snapshot=3964473344
13/02/23 12:03:11 INFO mapred.JobClient:     Total committed heap usage (bytes)=108265472
13/02/23 12:03:11 INFO mapreduce.ImportJobBase: Transferred 0 bytes in 50.0965 seconds (0 bytes/sec)
13/02/23 12:03:11 INFO mapreduce.ImportJobBase: Retrieved 1935 records.
13/02/23 12:03:11 ERROR tool.ImportTool: Imported Failed: Wrong FS: s3n://auth:secret@bucket/folder, expected: hdfs://ec2-111-11-11-1.compute-1.amazonaws.com:8020 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-10T06:50:41.183

发生这种情况的原因是 Sqoop 在“增量”模式下将文件写入临时目录。这是为了避免部分写入最终目标目录。将所有内容写入临时目录后，它将为每个文件发出“重命名”以将它们放入最终目标目录，这显然不适用于文件系统（HDFS -> S3）。

完成这项工作的方法是让 Sqoop 也将 S3 用于临时目录。在发布作业之前，将 Sqoop 所依赖的系统属性设置为临时文件的基础（请参阅[AppendUtils](https://github.com/apache/sqoop/blob/trunk/src/java/org/apache/sqoop/util/AppendUtils.java)）：

```
System.setProperty("sqoop.test.import.rootDir", <AUTHENTICATED_S3N_URL>); 
```

此外，在重命名文件时，Sqoop 通过从 Hadoop 配置中获取默认 FS 来获取 FS 句柄，因此您还需要将其设置为 S3N：

```
FileSystem.setDefaultUri(configuration, <AUTHENTICATED_S3N_URL>); 
```

它不漂亮，但它有效。