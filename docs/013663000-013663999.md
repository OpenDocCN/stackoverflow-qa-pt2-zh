# StackOverflow 问答 13663000-13663999

# silverlight - 使用独立存储 (vb) 保存的复选框

> ID：13663003
> 
> 赞同：0
> 
> 时间：2012-12-01T19:39:11.583
> 
> 标签：silverlight, silverlight-5.0

我在加载 CheckBox 的已保存设置时遇到问题（选中 True 或 False）。在调用已保存的设置时，它总是从 IsolatedStorage 天气中返回为 True，CheckBox 是否已被选中？请查看随附的代码，如果有人能告诉我我的方式的错误，我将不胜感激。

亲切的问候

将要

```
 Private Sub Button2_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button2.Click 
```

'Rem 保存设置'

如果 CheckBox1.IsChecked = True 那么

隔离存储设置.ApplicationSettings("MyCheckBox") = CheckBox1.IsChecked = True

ElseIf CheckBox1.IsChecked = False Then

IsolatedStorageSettings.ApplicationSettings("MyCheckBox") = CheckBox1.IsChecked = False

万一

结束子

```
 Private Sub Button3_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button3.Click 
```

'Rem 调用保存的设置'

MessageBox.Show("首先选择坦克程序")

CheckBox1.IsChecked = (IsolatedStorageSettings.ApplicationSettings("MyCheckBox"))

结束子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T14:12:19.793

这个答案是微软 Silverlight 论坛的 Karmjit Singh 给我的

Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) 处理 Button1.Click

```
 If IsolatedStorageSettings.ApplicationSettings.Contains("MyCheckSettings") Then
     IsolatedStorageSettings.ApplicationSettings("MyCheckSettings") = CheckBox1.IsChecked
  Else
     IsolatedStorageSettings.ApplicationSettings.Add("MyCheckSettings", CheckBox1.IsChecked)
  End If 
```

结束子

Private Sub Button2_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) 处理 Button2.Click

```
 Dim x As Boolean?

  IsolatedStorageSettings.ApplicationSettings.TryGetValue(Of Boolean?)("MyCheckSettings", x)
  CheckBox2.IsChecked = x 
```

结束子

# java - Optimization: replace for loop with ListIterator

> ID：13663011
> 
> 赞同：0
> 
> 时间：2012-12-01T19:40:23.740
> 
> 标签：java, optimization, for-loop, while-loop, listiterator

It's my first working on a quite big project, and I've been asked to obtain the best performances.

So I've thouhgt to replace my for loops with a `ListIterator`, because I've got around 180 loops which call `list.get(i)` on lists with about 5000 elements.

So I've got two questions.

1) Are those 2 snippets equal? I mean, do them produce the same output? If no, how can I correct the `ListIterator` thing?

```
ListIterator<Corsa> ridesIterator = rides.listIterator();
    while (ridesIterator.hasNext()) {
        ridesIterator.next();
        Corsa previous = ridesIterator.previous(); //rides.get(i-1)
        Corsa current = ridesIterator.next(); //rides.get(i)
        if (current.getOP() < d.getFFP() && previous.getOA() > d.getIP() && current.wait(previous) > DP) {
            doSomething();
            break;
        }
    } 
```

__

```
for (int i = 1; i < rides.size(); i++) {
    if (rides.get(i).getOP() < d.getFP() && rides.get(i - 1).getOA() > d.getIP() && rides.get(i).getOP() - rides.get(i - 1).getOA() > DP) {
        doSomething();
            break;
        }
    } 
```

2) How will it be the first snippet if I've got something like this? (changed i and its exit condition)

```
for (int i = 0; i < rides.size() - 1; i++) {
    if (rides.get(i).getOP() < d.getFP() && rides.get(i + 1).getOA() > d.getIP() && rides.get(i).getOP() - rides.get(i + 1).getOA() > DP) {
        doSomething();
            break;
        }
    } 
```

I'm asking because it's the first time that I'm using a `ListIterator` and I can't try it now!

EDIT: I'm not using an ArrayList, it's a custom List based on a LinkedList

EDIT 2 : I'm adding some more infos. I can't use a caching system because my data is changing on evry iteration and managing the cache would be hard as I'd have to deal with inconsistent data. I can't even merge some of this loops into one big loop, as I've got them on different methods because they need to do a lot of different things.

So, sticking on this particular case, what do you think is the best pratice? Is ListIterator the best way to deal with my case? And how can I use the ListIterator if my for loop works between 0 and size-1 ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:39:54.470

如果您知道最大大小，如果您从集合中退出（例如`ArrayList`用简单数组替换它们），您将获得最佳性能。

因此，请改为`ArrayList<Corsa>`使用 5000 个元素创建`Corsa[] rides = new Corsa[5000]`. 例如，不要硬编码，而是`5000`使用它来避免代码中的[幻数](http://en.wikipedia.org/wiki/Magic_number_(programming))。然后用 normal for 迭代，参考.`final static int MAX_RIDES = 5000``rides[i]`

一般来说，如果你追求性能，你应该用 Java 编写代码，就像它是 C/C++ 一样（当然你可以）。代码不是那么面向对象和漂亮，但它很快。记得最后总是做优化，当你确定的时候，你发现了一个瓶颈。否则，你的努力是徒劳的，只会降低代码的可读性和可维护性。还要使用[分析器](https://stackoverflow.com/questions/14762/please-recommend-a-java-profiler)，以确保您的更改实际上是升级，而不是降级。

使用的另一个缺点`ListIterator`是它在内部分配内存。因此 GC（垃圾收集器）会更频繁地唤醒，这也会对整体性能产生影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-19T16:15:29.257

1.  不，他们不这样做。

    ```
    while (ridesIterator.hasNext()) {
      ridesIterator.next();
      Corsa previous = ridesIterator.previous(); //rides.get(i-1)
      Corsa current = ridesIterator.next(); //rides.get(i) 
    ```

    变量previous 和current 将包含相同的“Corsa”值，有关详细信息，请参阅[ListIterator 文档](http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html)（迭代器位于“中间”位置）。

    正确的代码如下所示：

    ```
    while (ridesIterator.hasNext()) {
      Corsa previous = ridesIterator.next(); //rides.get(i-1)
      if(!ridesIterator.hasNext())
        break; // We are already at the last element
      Corsa current = ridesIterator.next(); //rides.get(i)
      ridesIterator.previous(); // going back 1, to start correctly next time 
    ```

2.  代码实际上看起来完全一样，只是解释（如注释中所示）会有所不同：

    ```
    while (ridesIterator.hasNext()) {
      Corsa previous = ridesIterator.next(); //rides.get(i)
      if(!ridesIterator.hasNext())
        break; // We are already at the last element
      Corsa current = ridesIterator.next(); //rides.get(i+1)
      ridesIterator.previous(); // going back 1, to start correctly next time 
    ```

从（过早的？）优化的角度来看，ListIterator 实现更好。

*   LinkedList 是一个双向链表，这意味着每个元素都链接到它的前任（前一个）和它的后继（下一个）。所以它每个循环做 3 次推荐。=> 3*N
*   每个 get(i) 需要遍历所有先前的元素才能到达第 i 个索引位置。所以平均每个循环有 N/4 个推荐。（你会认为 N/2，但 LinkedList 从列表的开头**或**结尾开始。） => 2 * N * N/4 == N^2 /2

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:26:09.287

这里有一些建议，希望一两个适用于你的情况。

1.  尝试每个循环只执行一次 rides.get(x)。
2.  缓存方法会产生适合您代码的局部变量。

在某些情况下，编译器可以优化对同一事物的多次调用，而不是只做一次，但并非总是出于许多微妙的原因。作为程序员，如果您知道这些应该提供相同的值，那么将它们缓存在局部变量中。

例如，

```
int sz = rides.size ();
float dFP = d.getFP ();  // wasn't sure of the type, so just called if float..
float dIP = d.getIP ();
Corsa lastRide = rides.get ( 0 );
for ( int i = 1; i < sz; i++ ) {
    Corsa = rides.get ( i );
    float rOP = r.getOP ();
    if ( rOP < dFP ) {
        float lastRideOA = lastRide.getOA (); // only get OA if rOP < dFP
        if ( lastRideOA > dIP && rOP - lastRideOA > DP ) {
            doSomething ();
            // maybe break;
        }
    }
    lastRide = r;
} 
```

这些优化可能并非在所有情况下都有效。例如，如果您`doSomething`扩展了列表，那么您需要重新计算 sz，或者可能在每次迭代时返回执行rides.size()。这些优化还假设列表是稳定的，因为元素在`get..()`'s. 如果`doSomething`对列表进行更改，那么您需要缓存的更少。希望你明白这一点。您也可以将其中一些技术应用于循环的迭代器形式。

# javascript - document.all 是什么意思？

> ID：13663023
> 
> 赞同：6
> 
> 时间：2012-12-01T19:41:36.327
> 
> 标签：javascript, getelementbyid

> **可能重复：**
> [document.all 与 document.getElementById](https://stackoverflow.com/questions/2408424/document-all-vs-document-getelementbyid)

我正在重构其他人编写的一些旧代码。我遇到了以下片段：

```
if (document.all || document.getElementById) {
   ...
} 
```

if 语句中的代码何时执行？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-01T19:43:29.063

document.all() 是一种访问 DOM 元素的非标准方式。它已被一些浏览器弃用。它使您可以访问文档中的所有子元素。

document.getElementById() 是一个标准并且完全受支持。每个元素在文档上都有一个唯一的 id。

# floating-point - 如何用二进制表示浮点数。IEEE

> ID：13663026
> 
> 赞同：3
> 
> 时间：2012-12-01T19:41:59.793
> 
> 标签：floating-point, binary, decimal

类似于十进制二进制数也可以表示浮点数。现在我读到它可以有那种花车

`0.5`: `0.1`, `0.25`: `0.01`, `0.125`: `0.001`... 等等。但是，例如，0.1（十进制）如何以二进制表示？

此外，给定一个十进制浮点数，如何将其转换为十进制等效值，（鉴于它不是那么简单）。

编辑：所以我知道更好的问题是；如何将十进制浮点数转换为二进制？现在我知道我们乘以小数部分，直到它变为零。现在很有可能两个浮点可以具有相同的表示，对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T19:47:19.320

给定多少位？

0.1b：

```
0.00011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011001100110011... 
```

如您所见，这是一个近似值。

```
Binary                                          Decimal
0.1     == 1/2^1         == 1/2              == 0.5
0.01    == 1/2^2         == 1/4              == 0.25
0.11    == 1/2^1 + 1/2^2 == 1/2 + 1/4 == 3/4 == 0.75 
```

[小数点](http://en.wikipedia.org/wiki/Radix_point)后的每一位代表 1/2^(position_after_bit_string)。

```
postion:   |1|2|3|4|5|6|7|
         0.|0|0|0|0|0|0|1| 
```

所以`0.0000001 = 1/2^7 = 0.0078125`

伪代码：

```
decimal_value = 0 
for i, bit in enumerate(binary_string):
    if bit == 1
         decimal_value += 1/2**i 
```

欲了解更多信息[为什么不能用二进制精确表示十进制数？](https://stackoverflow.com/questions/1089018/why-cant-decimal-numbers-be-represented-exactly-in-binary)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:44:14.370

另一个可能有帮助的观察结果。浮点数的“整数部分”以“正常”形式存在于二进制文件中，例如，如果值为 25.7482，则浮点数中将包含位“11001”（25），后面的位表示分数（实际上第一个'1'从未存储，它在格式中隐含）。如果从该数字中减去 25.0，再乘以 10，则得到 7.482，通过检查该值的整数部分，可以得到第一个小数位“7”。

减去 7.0，乘以 10 得到 4.82 ，因此下一个数字“4”，依此类推。这个过程理论上最终会以零结果结束，因为所有可以用浮点格式精确表示的值都有精确的十进制表示；但是，考虑到原始浮点的精度，“精确”结果的位数可能比实际合理的多得多（无论如何，您可能需要额外的内部精度才能获得完全精确的结果 - 您需要确保乘以 10 确实不会产生舍入误差）。

而且，对于像 6.432e-200 这样的数字，这种方法是可行的，但效率不高（在第一个 '6' 出现之前你会生成 199 个零）。

# coldfusion - 从远程位置提取文件或授予用户对我的系统的 FTP 访问权更好吗？

> ID：13663027
> 
> 赞同：1
> 
> 时间：2012-12-01T19:42:03.043
> 
> 标签：coldfusion, upload, ftp, remote-access, remote-server

我需要设置一个流程来使用用户提供的 CSV 数据（正在运行`Coldfusion 8/MySQL 5.0.88`）更新数据库表。

我不确定执行此操作的最佳方法。

我应该让用户通过 FTP 访问我的系统，为每个用户生成一个目录并从那里上传文件，还是应该从外部位置获取文件，所以用户必须设置一个我的系统可以访问的 FTP 文件夹。我有点倾向于第二种方式，并想使用`cfschedule`and来设置它`cfftp`，但我不确定这是前进的最佳方式。安全方面，我更倾向于让用户指定一个 FTP 位置，从我拉取的位置，而不是为每个用户分发和维护 FTP 文件夹。

**问题：**
在安全性和自动化方面，哪种方法更好？

感谢您的输入！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T19:56:26.600

我不会使用任何一种方法。我会给用户一个网页来上传他们的 csv 文件。接受文件的 cf 页面会将它们放置到特定文件夹中，并确保它们具有唯一的文件名。cffile 标签将帮助您。

计划的作业将从目标文件夹上的 cfdirectory 标记开始。这将创建一个查询对象。循环遍历它并对每个文件执行您必须执行的操作。

请记住检查正确的文件扩展名。然后查看文件的第一行以确保它与预期的格式匹配。

完成文件处理后，请对其进行处理，以免在下一个计划作业中再次处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T19:53:13.037

设置自定义 FTP 服务器当然是可能的，因为您可以创建用户并赋予他们特权（自动）。它也是安全的。但是，如果您没有任何设置 FTP 服务器的经验，我不知道从哪里开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T19:49:51.587

试试[https://www.dropbox.com/](https://www.dropbox.com/)

a.)创建一个保管箱帐户，向您的用户/客户发送邀请。

b.)您可以将文件/文件夹上传到保管箱，您的客户/用户可以从他们的保管箱帐户/保管箱桌面应用程序访问它。

c.)您的用户/客户可以上传文件/文件夹，您可以从您的 Dropbox
网站帐户/桌面应用程序访问它。Dropbox 是排名第一的软件，在安全性和自动化方面更好。

其他解决方案：

1.  最佳解决方案 GOOGLE DRIVE（免费 5gb）创建一个新的 gmail 帐户，将您的 id 和密码提供给您的用户。让他们打开 google 驱动器并导入/导出文件。或尝试 skydrive（免费 25gb）

2.  [http://www.syncplicity.com/](http://www.syncplicity.com/)

3.  [https://www.cubby.com/](https://www.cubby.com/)

4.  [http://www.huddle.com/?source=cj&aff=4003003](http://www.huddle.com/?source=cj&aff=4003003)

5.  [http://www.egnyte.com/](http://www.egnyte.com/)

6.  [http://www.sharefile.com/](http://www.sharefile.com/)

# php - 我只想返回不同的最新用户 id 列（mysql/php）

> ID：13663032
> 
> 赞同：0
> 
> 时间：2012-12-01T19:42:50.697
> 
> 标签：php, mysql, distinct

我有一个注册和登录站点，人们可以登录并开始在表单中输入信息。我有一个保存进度按钮，可以将一个新行插入到表中，该行的用户 ID 存储在第二列中。我想知道是否有一个 mysql 查询只能返回最新的不同结果 User_Id？像唯一 user_id 的最大 id 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:13:28.567

据我了解，您需要插入一条记录并在插入后获取它的 id 吗？

```
public $dbserver = '';
public $dbusername = '';
public $dbpassword = '';
public $dbname = '';

function openDb() {
    try {
        $db = new PDO('mysql:host=' . $this->dbserver . ';dbname=' . $this->dbname . ';charset=utf8', '' . $this->dbusername . '', '' . $this->dbpassword . '');
    } catch (PDOException $e) {
        die("error, please try again");
    }
    return $db;
}

function addNewUser($firstname) {
    $query = "INSERT INTO user (fname) VALUES(?)";
    $db = $this->openDb();
    $stmt = $db->prepare($query);
    $stmt->bindValue(1, $firstname, PDO::PARAM_STR);
    $stmt->execute();
    return $db->lastInsertId('id');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T19:45:36.447

是的，在选择查询中使用 'order by User_Id desc limit 1'。这将为您提供最新的唯一 User_Id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T19:47:07.773

听起来你正在寻找[mysql_insert_id](http://php.net/manual/en/function.mysql-insert-id.php)

# php - 立即加载 URL 导航

> ID：13663035
> 
> 赞同：2
> 
> 时间：2012-12-01T19:43:21.767
> 
> 标签：php, javascript, caching, navigation, preload

一段时间以来，众所周知，“快速导航”可以轻松用于[http://example.com/#1](http://example.com/#1) --> [http://example.com/#2](http://example.com/#2)。

但是，那里有一种新技术。[它可以在http://example.com/1](http://example.com/1) --> [http://example.com/2](http://example.com/2)之间快速导航。

**示例：[http ://rageslide.com/](http://rageslide.com/)**

正如您在示例中看到的那样，http://rageslide.com/1 和 http://rageslide.com/2 等之间的导航[显然](http://rageslide.com/1)不会强制整个站点重新加载[。](http://rageslide.com/2)
我想为我的网站做同样的事情，但我不知道该怎么做。我的网站提供的所有页面都是动态的（通过 PHP 和 MYSQL）。

我有这个想法：

*   将页面 (http://example.com/2) 的生成输出缓存 60 秒。
*   当用户通过 Javascript在[http://example.com/1上预加载 (http://example.com/2) 时。](http://example.com/1)
*   用户从[http://example.com/1](http://example.com/1)导航到[http://example.com/2](http://example.com/2)。由于内容是预加载和缓存的，因此内容将立即提供给用户。

不同的想法：

*   不知何故，[http](http://example.com/1) ://example.com/1通过 .htaccess被解释为[http://example.com/content.php#1 。](http://example.com/content.php#1)但我不知道这是否可能。

这行得通吗？或者解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:11:47.943

不，您在那里看到的 url 不用于加载另一个页面。网站中包含的 javascript 代码中有 AJAX 请求，它们加载新内容以显示和更新 URL 栏。

您可以在[本文](http://spoiledmilk.com/blog/html5-changing-the-browser-url-without-refreshing-page/)以及过去提出的以下问题中了解更多信息：

[在不重新加载页面的情况下修改 URL](https://stackoverflow.com/questions/824349/modify-the-url-without-reloading-the-page)

[使用新 URL 更新地址栏而不使用哈希或重新加载页面](https://stackoverflow.com/questions/3338642/updating-address-bar-with-new-url-without-hash-or-reloading-the-page)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:03:33.463

我可以想到两种可能的方法，您可以尝试一下。

首先是简单地使用 iframe 加载每个页面的下一页和上一页，当有人滑动到下一页时，将下一页加载到新的 iframe 或带有 ajax 或任何其他 html 元素的 div 中。

另一种是使用`rel`属性，这里是关于它的[解释](http://demosthenes.info/blog/190/Using-link-rel-to-preload-web-content-and-aid-accessibility)。

希望这可以帮助你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:25:32.687

通过让浏览器缓存预期的导航点资源，您可以非常接近而无需编写任何脚本或降级网站

为了缓存图像，将假人放在身体的末端 `<img .... height="0" width="0">`

对于页面 `<link rel=”prefetch” href=”url” />`，幻灯片查看器类型页面的下一个和上一个还有一个 rel 属性

注意：url 可以是 javascript 资源

注意 2：过渡可能比从 javascript 动态填充稍微不干净，尤其是在较大的复杂页面上，但仍然可以在 noscript 或 javascript 关闭的情况下工作，所以可能是一个很好的后备

# javascript - 使用 javascript 或 jquery 在不同的 html 文件之间共享变量

> ID：13663038
> 
> 赞同：0
> 
> 时间：2012-12-01T19:43:43.477
> 
> 标签：javascript, html, variables

在属于同一项目的 .html 文件之间定义和访问共享变量的最简单方法是什么。

谢谢你们，

b 问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T19:45:51.563

如果您打算让这些对于每个客户都是独一无二的，您可以：

1.  存储 cookie
2.  将数据作为请求参数的一部分传递

如果您打算永久存储数据，则应使用服务器端语言。

您在任何 JS 文件中定义的变量都以完全相同的方式访问。例如，考虑`variables.js`您在所有页面顶部包含的以下文件：

```
var variable1 = "foo";
var variable2 = "bar"; 
```

然后，在后面的任何脚本中，您都可以简单地引用这些变量。考虑 mypage.html：

```
<html>
    <head>
        <script src="variables.js" type="text/javascript"></script>
        <script>
            alert(variable1); // alerts "foo"
        </script>
    </head>
    <body>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T19:47:43.050

`sessionStorage`和对象将`localStorage`允许您在 .html 文件之间共享键/字符串值对，前提是它们属于同一域。`localStorage`值在会话之间存储在浏览器中，如果用户切换浏览器，则不会携带这些值；服务器也不能在没有额外代码的情况下查看这些值。

[http://en.wikipedia.org/wiki/Web_storage](http://en.wikipedia.org/wiki/Web_storage)

# javascript - html5画布文本中字体大小的有效粒度是多少？

> ID：13663040
> 
> 赞同：2
> 
> 时间：2012-12-01T19:43:45.120
> 
> 标签：javascript, css, html, canvas

我已经详尽地寻找答案，我希望 stackoverflow 能再次提供帮助。

如果我们设置上下文的字体大小，它似乎允许任意精度：

```
fontSize = 11.654321;
context.font = 'bold ' + fontSize + 'px sans-serif '; 
```

检查上下文对象将显示字体大小已非常精确地设置。然而，我注意到`measureText()`上下文对象的方法总是返回一个整数值（大概是一个上限）。有谁知道显示文本时使用的实际精度（使用基于像素的字体大小时）？

包含此信息的文档链接就足够了（只要它实际上告知了精度）。

如果有人问，我正在尝试通过执行以下操作来调整字体以使文本适合给定的宽度：

```
var fontSize = 12;
context.font = 'bold ' + fontSize + 'px sans-serif ';

var text = "whatever";
var maxWidth = 200;

var currentWidth = context.measureText(text).width;
var adjustment = maxWidth / currentWidth;
fontSize *= adjustment;
context.font = 'bold ' + fontSize " 'px sans-serif '; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T19:21:32.030

对于 Chromium 和 Firefox，有效精度似乎是整数级别（我没有测试过 Internet Explorer）。我创建了[这个 jsFiddle](http://jsfiddle.net/mmfhk/5/)来研究这个问题，从我的研究来看，在 Chromium 和 Firefox 中，以子整数精度指定的字体大小有效地四舍五入到最接近的整数。

我所做的测试假设该`measureText()`方法运行正常（这可能是一个错误的假设）。测试表明这种方法有一些奇怪的行为（在 Chromium 中比在 Firefox 中更明显）。

使用重复字符（'m'）的固定长度字符串，我将字符串的测量大小绘制成其字体大小的函数。当字体大小输入步长使用 0.1 时，输出字符串宽度对于步长 1.0 保持不变。这些“步骤”以整数字体大小为中心，跳跃发生在整数之间的中点。

在 Chromium 中观察到的奇怪行为是，有时输入字体大小可以变化多达 2 个像素，而字符串的测量宽度没有变化。此行为是意外的，但会定期发生（从零偏移）。以下输入值间隔导致测量宽度没有变化：[3.5, 5.5), [12.5, 14.5), [21.5, 23.5), [30.5, 32.5) 等等。这些“大平坦台阶”的中心似乎相距 9 个像素（4.5、13.5、22.5、31.5）。如果这确实是一个错误，第一个中心的中心大约是其余部分之间间隔的一半，这可能是一个线索。

在 Firefox 中，奇怪的行为要微妙得多。如果将输入步长更改为 1，则图形几乎是线性的（如预期的那样）。但图形会周期性地在 1 的间隔内稍微陡峭。例如，这发生在 [11.5, 12.5) 和 [35.5, 36.5 ）。

如果我忽略了某些东西，或者我的方法中有一些错误，请发表评论并告诉我。我不太关心 Firefox 的行为，但到目前为止，我认为 Chromium 中的行为是一个错误。我可能会提交错误报告，如果是这样，我将更新我的答案以包含一个链接。

# javascript - 为什么我的动画无法运行？

> ID：13663042
> 
> 赞同：0
> 
> 时间：2012-12-01T19:43:48.760
> 
> 标签：javascript

当我在我的网站上运行代码时，它从图像 jackhammers1 而不是 jackhammers0 开始，并且不会执行 startBouncing() 方法。它只显示带有一张图像且没有动画的表单。这是从教科书中复制的示例，因此我看不出它不应该如何工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />

<title>JackHammer</title>

<script type="text/javascript">

/* <![CDATA[ */

var jackhammers = newArray(11);
var curJackhammer = 0;
var direction;
var begin;
jackhammers[0] = "jackhammer0.gif";
jackhammers[1] = "jackhammer1.gif";
jackhammers[2] = "jackhammer2.gif";
jackhammers[3] = "jackhammer3.gif";
jackhammers[4] = "jackhammer4.gif";
jackhammers[5] = "jackhammer5.gif";
jackhammers[6] = "jackhammer6.gif";
jackhammers[7] = "jackhammer7.gif";
jackhammers[8] = "jackhammer8.gif";
jackhammers[9] = "jackhammer9.gif";
jackhammers[10] = "jackhammer10.gif";

function bounce(){

    if(curJackhammer == 10)
        curJackhammer = 0;
    else
        ++curJackhammer;
        document.getElementsByTagName("img")[0].src = jackhammers[curJackhammer].src;

    if(curJackhammer == 0)
        direction = "up";

    else if(curJackhammer == 10)
        direction = "down";
        document.getElementsByTagName("img")[0].src = jackhammers[curJackhammer];
}

function startBouncing(){

    if (begin)
        clearInterval (begin);
    begin = setInterval("bounce()",90);
}

/* ]]> */

</script>

</head>

<body>

<h1>Jackhammer Man</h1>

<p><img src="jackhammer1.gif" height="113" width="100" alt="Image of a man with a jackhammer." /></p>

<form action="" enctype="text/plain">
    <p>
        <input type="button" value="Start Bouncing" onclick="startBouncing();" />
        <input type="button" value="Stop Bouncing" onclick="clearInterval(begin);" />
    </p>
</form>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:24:12.600

它以 jackhammer1 开头，因为在 html 源代码中您拥有`<img src="jackhammer1.gif"...`而不是 jackhammer0，并且*当*用户单击按钮开始弹跳时，它将以 jackhammer1 开头，因为在 javascript 中，您在交换图像*之前*`curJackhammer`从 0 递增到 1 。

 *我认为下面的代码会做你想要的......（虽然不确定你想用 做什么`direction = "up" / "down"`）。

`if`请注意，在 javascript 之后和中通常需要大括号`else`，但如果只有一个命令，它们是可选的。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>    
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>JackHammer</title>
<script type="text/javascript">
var curJackhammer = 0;
var begin;

function bounce() {
    document.getElementsByTagName('img')[0].src = 
         'jackhammer' + curJackhammer + '.gif';
    curJackhammer ++;
    if (curJackhammer > 10) {
        curJackhammer = 0;
    }
}

function startBouncing(){
    if (begin) {
        clearInterval (begin);
    }
    begin = setInterval(bounce,90);
}
</script>
</head>

<body>

<h1>Jackhammer Man</h1>

<p><img src="jackhammer1.gif" height="113" width="100" 
alt="Image of a man with a jackhammer." /></p>

<form action="" enctype="text/plain">
    <p>
        <input type="button" value="Start Bouncing" onclick="startBouncing();" />
        <input type="button" value="Stop Bouncing" onclick="clearInterval(begin);" />
    </p>
</form>

</body>

</html>​ 
```*

# r - 退出当前浏览器（返回一级）

> ID：13663043
> 
> 赞同：9
> 
> 时间：2012-12-01T19:43:50.247
> 
> 标签：r

有时您将多个`browser`s 放入一个函数中进行调试。我知道你可以退出整个shebang，`Q`但是如果你想退出第二个浏览器（见下面的代码）并返回到第一级浏览器怎么办？我听说过 type`c`但这并没有退出第二级`browser`。

```
FUN <- function() {
browser()                      #first one
    lapply(1:10, function(x) {
browser()                      #second one
        return(x)
    })
}

FUN() 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-01T20:19:22.067

键入`c` *确实会*退出当前浏览器上下文。

但是，您的代码在执行期间会执行一个“第一级”和 10 个不同的“第二级”浏览器调用。结果，当您退出*一个*二级浏览器时，您几乎立即被扔到*下*一个浏览器中，因此看起来打字`c`不起作用。

键入`c <RETURN>`11 次以确认这是正在发生的事情。

```
> FUN()
Called from: FUN()
Browse[1]> c
Called from: FUN(1:10[[1L]], ...)
Browse[1]> c
Called from: FUN(1:10[[2L]], ...)
Browse[1]> c
Called from: FUN(1:10[[3L]], ...)
Browse[1]> c
Called from: FUN(1:10[[4L]], ...)
Browse[1]> c
Called from: FUN(1:10[[5L]], ...)
Browse[1]> c
Called from: FUN(1:10[[6L]], ...)
Browse[1]> c
Called from: FUN(1:10[[7L]], ...)
Browse[1]> c
Called from: FUN(1:10[[8L]], ...)
Browse[1]> c
Called from: FUN(1:10[[9L]], ...)
Browse[1]> c
Called from: FUN(1:10[[10L]], ...)
Browse[1]> c 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-01T22:45:04.213

我同意 Josh 的观点，并想建议您当前代码的这两种替代方案：

1) `debugonce`: 如果我们调用`foo`你的内部函数，那么`debugonce(foo)`只会在第一次`foo`调用时启动调试器，当`x==1`.

```
FUN <- function() {
  browser()
  foo <- function(x)return(x)
  debugonce(foo)
  lapply(1:10, foo)
} 
```

2)`debug`和`undebug`。运行后`debug(foo)`，每次`foo`调用调试器都会启动，直到你运行`undebug(foo)`：

```
FUN <- function() {
  browser()
  foo <- function(x)return(x)
  debug(foo)
  lapply(1:10, foo)
} 
```

当您想停止调试`foo`时，请`undebug(foo)`在点击之前输入`c`，它将带您回到第一级浏览器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-02T12:23:23.957

我在第二个浏览器之后添加`qwer`（或其他一些不存在的对象）。然后我手动翻阅代码，当我想退出第二个浏览器时，我只需按`c`. 它抛出对象不存在的错误。您将被退回到第一个浏览器调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-20T23:03:07.333

运行 undebug(yourFunction) 这将终止调试，但仍保留在浏览器提示符处，然后键入 c 并（可能几次）返回到常规命令提示符

# javascript - 如何使图像在网页上变得不可见且不可交互？

> ID：13663044
> 
> 赞同：4
> 
> 时间：2012-12-01T19:43:52.103
> 
> 标签：javascript, html, css

我制作了一个 javascript 脚本，它将扫描网页中的所有 .gif，并将它们的可见性属性设置为“隐藏”，这使我可以选择要在页面上显示的图像类型。我使用了此代码：

```
function makeAllGIF(){
var x = document.getElementsByTagName("img");
for(i = 0 ; i < x.length; i++){
    var y = x.item(i);
    if(y.getAttribute("src").match("gif") != null){
        y.style.visibility = "visible";
        }else{
        y.style.visibility = "hidden";
            }
    }
} 
```

编辑：

将代码更改为：

```
function makeAllGIF(){
var x = document.getElementsByTagName("img");
for(i = 0 ; i < x.length; i++){
    var y = x.item(i);
    if(y.getAttribute("src").match("gif") != null){
        y.style.display = "normal";
        }else{
        y.style.display = "none";
            }
    }
} 
```

工作正常，谢谢大家！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T19:44:54.583

在图像上设置属性`display: none`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T19:53:03.993

是的，列维是对的。只需修改代码如下：

```
function makeAllGIF(){
    var x = document.getElementsByTagName("img");
    for(i = 0 ; i < x.length; i++){
        var y = x.item(i);
        if(y.getAttribute("src").match("gif") != null){
            y.style.visibility = "visible";
            y.style.display = ""; // you can assign "block" as the value here.
        }
        else{
            y.style.visibility = "hidden";
            y.style.display = "none";
        }
    }
} 
```

# php - Xdebug with Sublime Text 2

> ID：13663045
> 
> 赞同：3
> 
> 时间：2012-12-01T19:43:54.650
> 
> 标签：php, xdebug, sublimetext2, breakpoints

我正在尝试使用 Sublime Text 2 设置 Xdebug 以在我的本地计算机上调试 PHP，但绝对无处可去。我正在使用 PHP 5.4 运行 MAMP。我在 php.ini 的末尾输入了这个：

```
[xdebug]
zend_extension="/Applications/MAMP/bin/php/php5.4.4/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so"
xdebug.remote_enable=On
xdebug.remote_host="localhost"
xdebug.remote_port=9000
xdebug.remote_handler="dbgp"
xdebug.remote_autostart=1 
```

Xdebug.so 扩展随 MAMP 一起提供，我已验证它位于 php.ini 文件中指定的位置。我可以在我的 PHP 信息中看到 Xdebug 信息。

在 Sublime Text 2 中，我已经安装了[这个](https://github.com/Kindari/SublimeXdebug)包并将我的项目中的设置更改为：

```
{
    "folders":
    [
        {
            "path": "/Applications/MAMP/htdocs"
        }
    ],

    "settings": {
        "xdebug": { "url": "http://localhost" }
    }
} 
```

我可以按 SHIFT 和 F8 来调出 Sublime Text 2 中的插件菜单，并且可以添加或删除断点（代码行左侧出现一个灰点）。当我点击“开始调试”时，它会打开一个浏览器，并在 url 上附加了“?XDEBUG_SESSION_START=sublime.xdebug”字符串。但是我的断点什么也没做。

我已经尝试添加`xdebug_break();`到我的代码中以查看是否会停止程序，但它不会。浏览器和IDE似乎根本没有连接......

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-03T23:16:22.633

首先，Kindari 的 xdebug 插件并不是你会高兴的。他把这个插件作为一种试验，在编写它的同时学习 sublime api，所以它充满了问题、硬编码的变量和东西。我最终放弃了它并卸载了那个插件，它只是没有用（但它有效）。恕我直言，最大的缺陷之一是无法显示超过 1 级的数组变量。几个月前他在github上发帖说他要从头开始重写它，从那以后它似乎被废弃了，但我仍然在拼命等待新版本的出现，我什至在考虑学习python并自己编写它。

好吧，如果你不想尝试，首先确保 Xdebug 工作正常，通过使用其他 Xdebug 客户端进行尝试。如果 Xdebug 在其他地方工作，请确保您安装了 python2.6，因为它不适用于 2.7。如果您运行的是 ubuntu 12.04，python2.6 不在存储库中，因此插件自述文件中有 Ubuntu 12.04 的解决方法：

1.  下载 [http://packages.ubuntu.com/lucid/python2.6][python 2.6]。
2.  提取它：

    ```
    dpkg-deb -x python2.6_2.6.5-1ubuntu6_i386.deb python2.6 
    ```

3.  将解压后的 usr/lib/python2.6 文件夹复制到 {Sublime Text 目录}/lib (=/usr/lib/sublime-text-2/lib/)

记住两件事：首先，有一个文件 /usr/lib/sublime-text-2/lib/python26.zip，所以不要删除这个文件。其次，在您提取的那个 .deb 中，里面有 usr/lib/python2.6，这就是您要复制的内容，而不是整个 python2.6 目录。所以，如果你不在那个解压的 .deb 之外，

```
cp -r python2.6/usr/lib/python2.6 /usr/lib/sublime-text-2/lib 
```

可能会完成这项工作。我不太确定，如果你应该复制那个 python2.6/usr/lib/python2.6 文件夹或者只是它的内容，我确实复制了两个并且它没有搞砸任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T04:06:41.783

你安装的是python 2x 版吗？尝试安装python，或者设置xdebug.remote_enable=1

# php - javascript 数组到 php array_sum()

> ID：13663048
> 
> 赞同：0
> 
> 时间：2012-12-01T19:44:15.180
> 
> 标签：php, javascript

似乎无法弄清楚.. 我有一个 JavaScript 函数，它获取具有相同类名的所有元素的值：

```
var total = $(".bob").map(function() {
    return $(this).val();
}).get();

var queryString = "?total="+total;
http.open("GET", "product.php" + queryString, true);

http.onreadystatechange = rgetHttpRes;
http.send(null); 
```

我将数组传递给我的 php 文件 -

```
if (isset($_GET['total'])) {
    $price = $_GET['total'];
    $num = array($price);
    $result = array_sum($num);
    echo($result);
}

// So I passed 2 integers with the JavaScript function: 15.99 and 10.99 into this  php function.
   It will only return one of them:  10.99 // 
```

当我这样做时：

```
if (isset($_GET['total'])) {
    $price = $_GET['total'];
    $num = array($price);
    print_r($num);
} 
```

这是我得到的输出：

```
Array ( [0] => 15.99, 10.99 ) 
```

我不知道为什么它不会像这样打印它们

```
Array ( [0] => 15.99 [1] => 10.99 ) 
```

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T19:46:10.770

查询作为字符串传递，您需要使用`explode`它来将其转换为数组

```
if(isset($_GET['total'])) {
    $price = $_GET['total'];
    $num = explode(",",$price);
    print_r($num);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T19:49:37.997

这个怎么样 ？

```
var t = $(".bob").size();
var ken = new Array();
var a;
for(a = 0;a<t;a++){
ken.push($(".bob").eq(a).val());
} 
```

# sql - SQL select语句混淆

> ID：13663051
> 
> 赞同：0
> 
> 时间：2012-12-01T19:45:11.050
> 
> 标签：sql, oracle

> **可能重复：**
> [Oracle 中的对偶表是什么？](https://stackoverflow.com/questions/73751/what-is-the-dual-table-in-oracle)

我一直想知道查询如何：

```
select sysdate
from dual; 
```

或者

```
select 8
from dual; 
```

做工作。

因为我习惯于 select 语句从给定表中选择列/s 值。但在上面提到的示例中，双表没有 sysdate 或只有 '8' 列....

有人可以解释一下它是如何工作的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:01:36.960

您不必选择列。您可以选择表达式，可以按列、常量值、函数调用、计算......所以您可以从员工表中选择它

```
select 
  e.nr,  -- column
  upper(e.name) as name, -- Function call to change the name to uppercase.
  e.age + 5 as age, -- expression with calculation with column value. 
  1  -- Just a value. Contains 1  for each row that the query returns.
from 
  employees e; 
```

注意`as name`和`as age`。这是因为一旦表达式包含的不仅仅是列名，列名就会丢失。在这种情况下，您可以指定希望列在查询结果中的名称。表名本身也有类似的技巧。别名`e`只是一种简写。这在使用多个表（在连接中）时特别有用。在这个简单的查询中，表别名可以完全省略。

`dual`只是一个特殊的表，它有 1 行，一列名为`dummy`. 它有许多不同的用途[，前面已经讨论过](https://stackoverflow.com/questions/73751/what-is-the-dual-table-in-oracle)。其他一些数据库根本不需要使用`dual`。例如，在 MySQL 中你可以只写

```
select
  1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:12:08.397

这只是一张只有一行的桌子。它是由Oracle 的[Charles Weiss](http://en.wikipedia.org/wiki/DUAL_table#cite_note-1)创建的，用于提供一个用于加入 Oracle 数据字典的内部视图的表。

> 我在 Oracle 数据字典中创建了 DUAL 表作为基础对象。它本身并不打算被看到，而是在预期被查询的视图中使用。想法是您可以对 DUAL 表执行 JOIN，并在结果中为表中的每一行创建两行。然后，通过使用 GROUP BY，可以汇总生成的连接以显示 DATA 范围和 INDEX 范围的存储量。DUAL 这个名字似乎很适合从一个行创建一对行的过程。

您可以利用 Dual 做很多巧妙的事情。我用它来生成一个数字列表。例如

```
SELECT LEVEL just_a_column
FROM dual
CONNECT BY LEVEL <= 365 
```

另请注意，从 10g 开始，Oracle 认识到 dual 的独特用途，并且 9i 和更早版本中的逻辑读取/全表扫描已针对应用程序消除。升级到 10g 对使用双重的应用程序具有显着的性能优势。（例如，从双重中选择 sysdate）。

说明计划示例：在 10g 及更高版本中，dual 是一个魔术表 - 如果您从 dual 中选择 sysdate，则计划将是：

```
sql> select sysdate from dual;

SYSDATE
---------
12-DEC-02

Execution Plan
-----------------------------------------------------------------
| Id  | Operation        | Name | Rows  | Cost (%CPU)| Time     |
-----------------------------------------------------------------
|   0 | SELECT STATEMENT |      |     1 |     2   (0)| 00:00:01 |
|   1 |  FAST DUAL       |      |     1 |     2   (0)| 00:00:01 |
----------------------------------------------------------------- 
```

# php - Ajax 应该在 MVC 项目中调用什么 URL？

> ID：13663052
> 
> 赞同：0
> 
> 时间：2012-12-01T19:45:15.637
> 
> 标签：php, javascript, ajax, model-view-controller, front-controller

我是一个半新手，所以请多多包涵…… **注意，此时我不知道 jQuery 或 Json**

在我的 MVC 项目中（我没有使用框架，但该项目将前端控制器与 MVC 结合在一起），我有：
1）一个控制器，它将一些参数发送到 DAO。DAO 运行 MySQL 查询并将一系列文章发送回控制器。
2）一个视图层，我希望用户能够单击一个按钮从一个文章移动到另一个文章。我建议这样做的方法是通过 javascript Ajax 调用来获取控制器中生成的数组中的下一篇文章。

我的问题是：Ajax 函数调用的 URL 应该是什么？显然它不能调用控制器（或者可以吗？）。我应该添加一类专用的 Ajax 内容容器，控制器将使用数组实例化吗？我很难看到视图如何找到正确的 URL……控制器是否应该将参数传递给视图并让它请求查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:06:13.247

XHR（也称为 AJAX）调用在控制器级别没有什么不同，然后是经典的浏览器请求。不同之处仅在于您期望收到的响应。

这意味着，如果您已经完全实现了视图（不仅仅是愚蠢的模板），那么请求的类型应该只对视图很重要。您可以通过添加扩展轻松区分它们：

*   `http://foo.in/user/list`- 简单的请求
*   `http://foo.in/user/list.json`- XHR 请求

差异主要在路由机制上得到认可，它们在`Request`实例上设置了特定的细节。当控制器看到该`Request`实例有一个`isXHR`标志时，它会告诉视图：*“用一些东西来响应这个，那不是完整的 HTML 页面”*。

基本上，相同的控制器应该同时处理普通调用和 XHR 调用。其实你并不关心，它是什么类型的请求。仅您是否需要生成`html`，`xml`或`json`在响应中。

> [**PS：**模型层应该完全不受请求类型的影响。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T10:09:08.483

从上面的帖子列表中，我假设您必须知道 Ajax 语法才能在编辑文章时调用方法。

如何做到这一点如下： 1\. 最初在控制器中定义一个动作，它服务于您的目的（可能是在这种情况下编辑您的文章。） 2\. 通过 ajax 方法指定控制器和您要调用的动作。（此时应该是Articles--Controller，EditArticle--Action）。

控件会自动导航到特定的操作方法。

问候 Pavan.G

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-01T19:51:49.683

取决于您使用的框架。但一般来说：

您可以使用控制器发送一个“标志”（例如在一个 GET 变量中），它是一个 AJAX 查询，然后退出该函数，但是对于 AJAX 查询有不同的控制器被认为是一个更好的路线:) 无论如何，有些东西与此类似：

```
function page() {
   if($_GET["is_ajax"] == "1") {
      // return the AJAX query
      return;
   }
// go on with showing the page
} 
```

希望这可以帮助！

# javascript - 如何计算从弹出窗口出现到在javascript中被点击的时间？

> ID：13663057
> 
> 赞同：1
> 
> 时间：2012-12-01T19:45:56.860
> 
> 标签：javascript

> **可能重复：**
> [在 JavaScript 中计算经过的时间](https://stackoverflow.com/questions/1210701/compute-elapsed-time-in-javascript)

我正在尝试为我的心理学项目构建一个词汇决策任务。

该任务在 javascript 中：出现一个带有单词的弹出窗口，用户根据单词是否符合语法单击是或否。

我需要计算弹出窗口出现和用户点击之间的时间。你能告诉他们需要做什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T19:48:26.047

当弹出窗口出现时，您可以存储使用此语句检索到的当前时间：

```
var createDate = new Date().getTime(); 
```

然后，当用户单击是或否时，您检索新日期并计算与前一个时间戳的差异：

```
var delay = new Date().getTime() - createDate; 
```

# php - 检测 HTML 代码注入

> ID：13663060
> 
> 赞同：1
> 
> 时间：2012-12-01T19:46:15.790
> 
> 标签：php, html

使用 php strip_tag 函数来防止 HTML 注入到我的数据库中我想知道是否有任何方法可以检测它是否已被使用，即以下内容：

if (strip_tags 已被使用/对代码有任何影响) { error; }

我想输出一个错误，让用户知道不能事先使用 HTML 标签，而不是直接插入数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T19:48:21.723

只需将清理后的数据与原始数据进行比较，如果不匹配，则向用户添加警告：

```
$data = $_GET["field_name"];
$sanitized = strip_tags($data);
if ($sanitized != $data) {
    echo "HTML not allowed.";
    // or...
    // throw new Exception("HTML not allowed.");
} 
```

# android - 使用 simonvt 数字选择器时出现 ClassCastException

> ID：13663065
> 
> 赞同：3
> 
> 时间：2012-12-01T19:46:56.493
> 
> 标签：android, xml, classcastexception, numberpicker

我正在尝试使用 simonvt 号码选择器。我已成功将库添加到我的项目中，并且已成功运行带有库的示例项目。但在我的项目中，我得到了这个例外：

> 12-01 21:39:48.543: E/AndroidRuntime(987): java.lang.RuntimeException: 无法启动 >activity ComponentInfo{com.tekna.digiguide/com.tekna.digiguide.KayitHourPickerActivity}: >java.lang.ClassCastException ：net.simonvt.widget.NumberPicker

任何人都可以帮忙吗？

我的xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical" >

    <net.simonvt.widget.NumberPicker
        android:id="@+id/numberPicker"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

    <Button
        android:id="@+id/buttonPickerEkle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

和我的活动

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.pickerlayout);

        final NumberPicker np = (NumberPicker) findViewById(R.id.numberPicker);
        np.setMaxValue(24);
        np.setMinValue(1);
        np.setFocusable(true);

        np.setFocusableInTouchMode(true);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T19:52:25.003

看来您已导入：

```
import android.widget.NumberPicker; 
```

但是你想使用：

```
import net.simonvt.widget.NumberPicker; 
```

# c# - 如何查找包含 nunit 测试的 dll 文件

> ID：13663068
> 
> 赞同：3
> 
> 时间：2012-12-01T19:47:03.640
> 
> 标签：c#, .net, unit-testing, nunit

我有一个包含许多 dll 的文件夹。其中之一包含 nunit 测试（标有 [Test] 属性的函数）。我想从 c# 代码运行 nunit 测试。有没有办法找到正确的dll？

谢谢你

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T22:49:42.127

您可以使用[Assembly.LoadFile](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfile.aspx)方法将 DLL 加载到 Assembly 对象中。然后使用[Assembly.GetTypes](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.gettypes.aspx)方法获取程序集中定义的所有类型。然后使用[GetCustomAttributes](http://msdn.microsoft.com/en-us/library/kff8s254.aspx)方法，您可以检查该类型是否用 [TestFixture] 属性修饰。如果你想让它快速变脏，你可以在每个属性上调用 .GetType().ToString() 并检查字符串是否包含“TestFixtureAttribute”。

您还可以检查每种类型中的方法。使用方法[Type.GetMethods](http://msdn.microsoft.com/en-us/library/td205ybf.aspx)来检索它们，并对它们中的每一个使用 GetCustomAttributes，这次搜索“TestAttribute”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T23:45:40.910

以防万一有人需要工作解决方案。由于您无法卸载以这种方式加载的程序集，因此最好将它们加载到另一个 AppDomain 中。

```
 public class ProxyDomain : MarshalByRefObject
  {
      public bool IsTestAssembly(string assemblyPath)
      {
         Assembly testDLL = Assembly.LoadFile(assemblyPath);
         foreach (Type type in testDLL.GetTypes())
         {
            if (type.GetCustomAttributes(typeof(NUnit.Framework.TestFixtureAttribute), true).Length > 0)
            {
               return true;
            }
         }
         return false;
      }
   }

     AppDomainSetup ads = new AppDomainSetup();
     ads.PrivateBinPath = Path.GetDirectoryName("C:\\some.dll");
     AppDomain ad2 = AppDomain.CreateDomain("AD2", null, ads);
     ProxyDomain proxy = (ProxyDomain)ad2.CreateInstanceAndUnwrap(typeof(ProxyDomain).Assembly.FullName, typeof(ProxyDomain).FullName);
     bool isTdll = proxy.IsTestAssembly("C:\\some.dll");
     AppDomain.Unload(ad2); 
```

# java - 如何设置外键为空？

> ID：13663070
> 
> 赞同：0
> 
> 时间：2012-12-01T19:47:07.560
> 
> 标签：java, jpa, foreign-keys

我有这样定义的表：

```
@Entity
public class Shipment implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Long id;

    @ManyToOne(optional=true)
    @JoinColumn(name="SENDER_ID",referencedColumnName="CUSTOMER_ID", nullable=true)
    private Customer sender;

    @ManyToOne(optional=true)
  //  @Column(nullable=true)
    @JoinColumn(name="TARRIF_ID",referencedColumnName="TARRIF_ID",nullable=true)
    private Tarrif tarrif;

    @ManyToOne(optional=true)
  //  @Column(nullable=true)
    @JoinColumn(name="RECIPIENT_ID",referencedColumnName="CUSTOMER_ID",nullable=true)
    private Customer recipient;

    @ManyToOne(optional=true)
   // @Column(nullable=true)
    @JoinColumn(name="COURIER_ID",referencedColumnName="COURIER_ID",nullable=true)
    private Courier courier;
....
} 
```

我想删除与货件相关联的客户/快递员/关税对象。所以基本上，我希望能够将外键设置为 NULL。

虽然 nullable 设置为 true，但 glassfish 表示无法完成，因为外键约束被违反。有任何想法吗 ？

我正在使用 javaee 6、javax.persistence.api 1.0.2、glassfish 3+ 和 java derby db。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T15:14:25.693

在调用 remove 之前，您需要在“Java”/JPA 中将对对象的任何引用设置为 null。这将导致外键值设置为空。

您可以在自己的 DDL 中配置外键约束来执行此操作，但您的对象模型（可能还有缓存）仍然会损坏（最好修复您的代码）。

# android - ListFragment 中的 setText

> ID：13663073
> 
> 赞同：2
> 
> 时间：2012-12-01T19:47:19.397
> 
> 标签：android, textview, fragment, loader

我是 Android 编程的初学者，我想知道您是否可以帮助我。

我有一个 ListFragment：

```
public class AdvertFrag extends ListFragment implements LoaderManager.LoaderCallbacks<Cursor> 
```

我正在使用 loaderManager 从数据库中填充。这可以正常工作并显示广告的详细信息，但我想做一些计算（通过经度和纬度计算距离），然后在每个 AdvertFrag 上显示到商店位置的距离。

我已经研究过在片段中的 TextView 上使用 setText() 并阅读过您应该允许首先调用 onCreateView 方法，以便存在视图。我试过下面的代码：

```
public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {
        view = inflater.inflate(R.layout.row, container, false);
        if(view == null)
        {
            Log.i("TEST","null");
        }
        else
        {
            distance = (TextView) view.findViewById(R.id.distance);
            distance.setText("the distance will go here");
        }
        return view;
    } 
```

但是收到错误消息“您的内容必须有一个 id 属性为 android.R.id.list 的 ListView。允许 OnCreateView 只调用：

```
return super.onCreateView(inflater, container, savedInstanceState); 
```

工作正常。

所以我的问题是，我做错了什么？以及如何让 setText 在 ListActivity 中工作？还是我以完全错误的方式去做？

**如果有用，请添加信息：**

我的 row.xml，只有加载器填充的文本视图和距离的附加文本视图。

我有一个在其 XML 中有片段的 fragmentActivity，如下所示：

```
<fragment 
        ...
        android:name="com.example.goclub.AdvertFrag"
        .../> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:17:33.513

就像 user113215 所说`onCreateView()`的那样，`ListFragment`不是更改列表项内小部件的地方。`CursorAdapter`假设您正在使用一个，您将不得不为此创建一个自定义。[你可以在这里](http://thinkandroid.wordpress.com/2010/01/11/custom-cursoradapters/)找到一个很好的教程。基本上它扩展了 a`SimpleCursorAdapter`并对`bindView`方法进行了更改。

# java - 将“远”对象传递给另一个对象 - 好的和坏的做法

> ID：13663074
> 
> 赞同：-1
> 
> 时间：2012-12-01T19:47:19.507
> 
> 标签：java, oop

假设我们有一个对象 (A)，它应该执行另一个对象 (B) 的方法，该方法不在对象 (A) 本身的范围内，也不在其成员的范围内。

克服这个问题我可能采用以下方法之一：

*   在可能使用它的任何对象中存储对该对象的引用，可能导致内存泄漏

*   为我可能需要使用的任何对象创建吸气剂并像那样使用它们（这可能不是最佳实践）。

    ```
    anObject.getABC().getDEF().getHIG().DoSomething(); 
    ```

*   将一些对象定义为单一音调，这可能是一个很好的解决方案，但每当我使用自由覆盖它可能会很痛苦，它的子类不会与覆盖的子类一起使用。

*   静态成员，可能是最糟糕的方式。

我的问题：**在维护面向对象代码的同时，最好的方法是什么，应该考虑什么？**

（这些问题是指一般的 OOP，但我更喜欢 JAVA 中的代码示例）

**例子：**

*   用户单击菜单上的某些内容，这应该会影响与菜单无关的内容或与其密切相关的内容。对于

*   具有应释放其内存的消耗方法的类应访问可能包含但不直接相关的对象。例如，在画布上绘制的汽车对象应从该对象和该数组中删除自己保存与 GUI 线程没有任何关系的汽车列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:02:54.587

得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)说：不要和陌生人说话。

如果 A 需要调用 B 的方法，那么 B 应该是 A 的直接依赖。如果 B 实际上不是 A 的直接依赖，而是传递依赖，即 A 依赖 C，C 又依赖 D，即依赖于B，那么A应该调用C的方法，C调用D的方法，D调用B的方法：

```
A --> C --> D --> B 
```

阅读您的示例，您似乎正在寻找 Observable/Observer 方法。例如：当您单击菜单时，菜单应该只调用其观察者（或在 Swing/AWT 术语中的侦听器）的方法，它们是接口的实例。侦听器会将自己注册到菜单，以便在菜单单击时收到通知。

# java - JVM 崩溃后来自 Neo4J 的 InvalidRecordException

> ID：13663075
> 
> 赞同：6
> 
> 时间：2012-12-01T19:47:30.177
> 
> 标签：java, crash, neo4j

我在 CentOS 上运行 Neo4J 1.8 嵌入式 Java 6。

在 JVM 崩溃后，我开始遇到以下一些异常：

```
org.neo4j.graphdb.NotFoundException: Unable to load one or more relationships from Node[1169385]. This usually happens when relationships are deleted by someone else just as we are about to load them. Please try again.
        at org.neo4j.kernel.impl.core.NodeImpl.loadMoreRelationshipsFromNodeManager(NodeImpl.java:530)
        at org.neo4j.kernel.impl.core.NodeImpl.getMoreRelationships(NodeImpl.java:415)
        at org.neo4j.kernel.impl.core.NodeImpl.loadInitialRelationships(NodeImpl.java:368)
        at org.neo4j.kernel.impl.core.NodeImpl.ensureRelationshipMapNotNull(NodeImpl.java:345)
        at org.neo4j.kernel.impl.core.NodeImpl.getAllRelationshipsOfType(NodeImpl.java:195)
        at org.neo4j.kernel.impl.core.NodeImpl.getRelationships(NodeImpl.java:247)
        at org.neo4j.kernel.impl.core.NodeProxy.getRelationships(NodeProxy.java:92)
        at com.bizya.polosvc.neo4j.model.PersonImpl.getAllSelvesNoPropsLoad(PersonImpl.java:1303)
        at com.bizya.polosvc.neo4j.model.PathsFinderImpl.findPaths(PathsFinderImpl.java:189)
        at com.bizya.polosvc.neo4j.model.PathsFinderImpl.findPaths(PathsFinderImpl.java:49)
        at com.bizya.server.services.ReachabilityService.findReachabilities(ReachabilityService.java:82)
        at com.bizya.server.widget.BrowsingPageBuilder.buildAdditionalResultsModel(BrowsingPageBuilder.java:97)
        at com.bizya.server.widget.ContextBrowsingPageBuilder.buildAdditionalResultsModel(ContextBrowsingPageBuilder.java:81)
        at com.bizya.server.widget.ContextBrowsingPageBuilder.buildAdditionalResultsModel(ContextBrowsingPageBuilder.java:71)
        at com.bizya.server.widget.servlet.NetworkServlet.doGet(NetworkServlet.java:139)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
        at com.bizya.server.widget.servlet.MasterWidgetServlet.handleAuthorizedUser(MasterWidgetServlet.java:167)
        at com.bizya.server.widget.servlet.MasterWidgetServlet.service(MasterWidgetServlet.java:150)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at com.google.inject.servlet.ServletDefinition.doService(ServletDefinition.java:263)
        at com.google.inject.servlet.ServletDefinition.service(ServletDefinition.java:178)
        at com.google.inject.servlet.ManagedServletPipeline.service(ManagedServletPipeline.java:91)
        at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:62)
        at com.google.inject.servlet.FilterDefinition.doFilter(FilterDefinition.java:168)
        at com.google.inject.servlet.FilterChainInvocation.doFilter(FilterChainInvocation.java:58)
        at com.google.inject.servlet.ManagedFilterPipeline.dispatch(ManagedFilterPipeline.java:118)
        at com.google.inject.servlet.GuiceFilter.doFilter(GuiceFilter.java:113)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
        at org.apache.coyote.ajp.AjpAprProcessor.process(AjpAprProcessor.java:429)
        at org.apache.coyote.ajp.AjpAprProtocol$AjpConnectionHandler.process(AjpAprProtocol.java:384)
        at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1665)
        at java.lang.Thread.run(Thread.java:662)
Caused by: org.neo4j.kernel.impl.nioneo.store.InvalidRecordException: Node[1169385] is neither firstNode[969258] nor secondNode[1170375] for Relationship[3477951]
        at org.neo4j.kernel.impl.nioneo.xa.ReadTransaction.getMoreRelationships(ReadTransaction.java:167)
        at org.neo4j.kernel.impl.nioneo.xa.ReadTransaction.getMoreRelationships(ReadTransaction.java:105)
        at org.neo4j.kernel.impl.persistence.PersistenceManager.getMoreRelationships(PersistenceManager.java:108)
        at org.neo4j.kernel.impl.core.NodeManager.getMoreRelationships(NodeManager.java:608)
        at org.neo4j.kernel.impl.core.NodeImpl.loadMoreRelationshipsFromNodeManager(NodeImpl.java:527)
        ... 38 more 
```

我得到了更多具有不同ID的人。

这些异常在尝试加载特定节点时是一致的，我确定我没有删除任何关系。在命令行 shell 中检查这些节点时，我得到了同样的错误（org.neo4j.graphdb.NotFoundException：无法加载一个或多个关系......）。

这似乎是某种腐败。关于如何修复它的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T02:22:56.027

鉴于您在 JVM 崩溃后所做的尝试以及您一直遇到的麻烦，您可能需要调查 Neo4J 1.8 中可能导致您遇到问题的错误的可能性。这可能是由您的关系标识符引起的，就像在[这种](https://stackoverflow.com/questions/12200889/neo4j-cypher-version-1-8-probable-bug-with-relationship-identifiers)情况下一样。不幸的是，它是 1.8 版本的一个错误。您可能需要考虑升级到 1.9 或使用我发布的链接中接受的答案中建议的解决方法。

希望这会为您指明正确的方向！祝你编码好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T16:15:34.530

你试过 ConsistencyCheckTool 吗？

例如，您可以使用（在 Maven 项目中）检查数据库

```
<groupId>org.neo4j</groupId>
<artifactId>neo4j-consistency-check</artifactId>
<version>1.9.M02</version> 
```

作为依赖项并运行：

```
org.neo4j.consistency.ConsistencyCheckTool.main(databasedir) 
```

或者下载 Neo4j 企业版并使用合适的 jars。

# .net - .Net 在没有 id 的 Iframe 中更改值

> ID：13663078
> 
> 赞同：0
> 
> 时间：2012-12-01T19:47:57.103
> 
> 标签：.net, iframe

我正在处理自动填写表格，但我没有通过图片上传。图片上传在没有 id 或名称的 iframe 内。我想知道我是否可以为之类添加一个值

```
webbrowser1.document.getelementbyid("file[]").setAttribute("Value","Url") 
```

或者

```
WebBrowser1.Document.Window.Frames("file[]")... 
```

下面是 html 代码（我没有更改它的权限）

```
 <iframe width="250" scrolling="no" height="22" frameborder="no" marginwidth="0" marginheight="0" allowtransparency="true" border="0" src="/upload.html?v4#mdrp9c7tlgin8d038qnj6mnmi4">#document<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head></head>
    <body>
    <div id="button_container"><object id="SWFUpload_0" class="swfupload" width="250" height="22" data="/swfupload250beta3/swfupload.swf?wrapperbrowsercheck=0.7308926264884217&preventswfcaching=1354384013251" type="application/x-shockwave-flash"></object></div>
    <form enctype="multipart/form-data" target="uploader" action="/upload.php" method="post"><input id="file" type="file" onchange="fileUploadStart(this);" name="file[]"></input></form>
    </body></html></iframe> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T19:56:20.583

使用 jQuery：

```
$("iframe").contents().find("#file").attr("Value","Url") 
```

# php - 关键字错误，从网站中提取内容。面向对象

> ID：13663085
> 
> 赞同：3
> 
> 时间：2012-12-01T19:49:18.793
> 
> 标签：php, database, oop, keyword

从网站（wiki 文章）中提取关键字时遇到问题，提取的关键字并不完全是关键字，是从 html 中提取的词，而不是从网站中提取的词。

我使用以下代码：

```
include("Extkeys.php");
[...]
if (empty($keywords)){
$ekeywords = new KeyPer;
$keywords = $ekeywords->Keys($webhtml);
} 
```

“Extkeys”的代码是：

```
<?php
class Extkeys {
function Keys($webhtml) { 
$webhtml = $this->clean($webhtml); 
$blacklist='de,la,los,las,el,ella,nosotros,yo,tu,el,te,mi,del,ellos'; 
$sticklist='test'; 
$minlength = 3; 
$count = 17; 

$webhtml = preg_replace('/[\.;:|\'|\"|\`|\,|\(|\)|\-]/', ' ', $webhtml); 
$webhtml = preg_replace('/¡/', '', $webhtml); 
$webhtml = preg_replace('/¿/', '', $webhtml);

$keysArray = explode(" ", $webhtml); 
$keysArray = array_count_values(array_map('strtolower', $keysArray)); 
$blackArray = explode(",", $blacklist); 

foreach($blackArray as $blackWord){ 
if(isset($keysArray[trim($blackWord)])) 
unset($keysArray[trim($blackWord)]); 
} 
arsort($keysArray); 
$i = 1; 
$keywords = ""; 
foreach($keysArray as $word => $instances){ 
if($i > $count) break; 
if(strlen(trim($word)) >= $minlength && is_string($word)) { 
$keywords .= $word . ", "; 
$i++; 
} 
} 

$keywords = rtrim($keywords, ", "); 

return $keywords=$sticklist.''.$keywords; 
} 

function clean($webhtml) { 

$regex = '/(([_A-Za-z0-9-]+)(\\.[_A-Za-z0-9-]+)*@([A-Za-z0-9-]+)(\\.[A-Za-z0-9-]+)*)/iex'; 
$desc = preg_replace($regex, '', $webhtml); 
$webhtml = preg_replace( "''si", '', $webhtml ); 
$webhtml = preg_replace( '/]*>([^<]+)<\/a>/is', '\2 (\1)', $webhtml ); 
$webhtml = preg_replace( '//', '', $webhtml ); 
$webhtml = preg_replace( '/{.+?}/', '', $webhtml ); 
$webhtml = preg_replace( '/ /', ' ', $webhtml ); 
$webhtml = preg_replace( '/&/', ' ', $webhtml ); 
$webhtml = preg_replace( '/"/', ' ', $webhtml ); 
$webhtml = strip_tags( $webhtml ); 
$webhtml = htmlspecialchars($webhtml); 
$webhtml = str_replace(array("\r\n", "\r", "\n", "\t"), " ", $webhtml); 

while (strchr($webhtml," ")) { 
$webhtml = str_replace(" ", "",$webhtml); 
} 

for ($cnt = 1; 
$cnt < strlen($webhtml)-1; $cnt++) {
if (($webhtml{$cnt} == '.') || ($webhtml{$cnt} == ',')) { 
if ($webhtml{$cnt+1} != ' ') { 
$webhtml = substr_replace($webhtml, ' ', $cnt + 1, 0); 
} 
} 
} 
return $webhtml; 
} 
}
?> 
```

这是提取的关键字的示例：

> testfalse, lang, {mw, loader, window, function, true, vector, user, gadget, mediawiki, legacy, options, usebetatoolbar, implementation, resourceloader, default

文章来源： [http ://en.wikipedia.org/wiki/Searchengine](http://en.wikipedia.org/wiki/Searchengine)

代码“Extkeys”，它是教程中代码的副本，适合我使其发挥作用。

我如何使代码可以提取网站的关键字，而不是 html？

此致！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T19:54:51.557

假设我理解您的问题，我认为只需执行以下操作就是您正在寻找的解决方案。

This will read the HTML from a URL (e.g. [http://www.whatever.com/page.html](http://www.whatever.com/page.html)) and use that to generate the keys, rather than requiring the HTML as a parameter.

```
function Keys($url) { 
    $webhtml = file_get_contents($url); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T19:59:31.173

您想先从页面中提取内容，然后搜索关键字。这意味着您想从页面中找到实际内容并将内容剥离为侧边栏、页脚等。只需 google 以提取 HTML 内容，有很多关于此的文章。

我在java中做过一次，有一个名为[boilerpipe](https://code.google.com/p/boilerpipe/)的库我不确定是否有PHP端口/接口，快速谷歌搜索没有显示任何内容。但我确信 PHP 也有类似的库。

摆脱 HTML 而不是专门搜索页面内容的最简单方法是使用正则表达式去除所有 html，例如`s/<[^>]+>//g`. 然而，对于搜索引擎来说，这可能不是最好的方法，因为您最终会遇到很多可能会弄乱您的密钥提取的废话。

**编辑：**这是一篇关于[使用 PHP 进行内容提取](http://www.keyvan.net/2011/03/content-extraction/)的文章。

# c# - ASP.NET - 将会话数据从第 2 页传递到第 1 页

> ID：13663090
> 
> 赞同：0
> 
> 时间：2012-12-01T19:50:31.633
> 
> 标签：c#, asp.net

我有两页。在第 2 页上，我手动向控件输入值，然后将这些值分配给属性。当我在第 2 页单击“确认”时，我使用以下方法启动会话（我猜）：

```
protected void Button1_Click(object sender, EventArgs e)
    {
        AssignValues();

        //Start data sessions
        Session["ID"] = IDizposoje;
        Session["Ime"] = Ime;
        Session["Priimek"] = Priimek;
        Session["DatumIzposoje"] = DatumIzposoje;
        Session["DatumVrnitve"] = DatumVrnitve;
        Session["VrstaVozila"] = VrstaVozila;

        Response.Redirect("Default.aspx");
    } 
```

我希望您帮助我，在列中的 page1 上的 gridview 中显示该数据。我有 6 个属性，因此有 6 个列。

怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T19:56:37.623

当你给它分配一些东西时，你不会开始`Session`。当用户访问网站的第一页时，会话立即开始。

您想将 a`GridView`用于单个记录还是这些属性集合？[`DataTable`](http://msdn.microsoft.com/en-us/library/t31h6yhs%28v=vs.110%29.aspx)您可以在 中创建一个`Page2`，将其存储在会话中并将其`DataSource`用作`GridView`.

在“默认.aspx”中

```
protected void Page_Load(Object sender, EventArgs e)
{
    if(!IsPostBack)
    {
         DataTable table = (DataTable) Session["TblIzposoje"];
         GridView1.DataSource = table;
         GridView1.DataBind();
    }
} 
```

`GridView`如果设置`AutogenerateColumns`为 ，那将直接起作用`true`。

# c++ - OpenGL GLSL (3.x-4.1) 弃用统一变量解释

> ID：13663092
> 
> 赞同：1
> 
> 时间：2012-12-01T19:50:55.953
> 
> 标签：c++, opengl, glsl, deprecated

我正在做一个项目，涉及使用 OpenGL 使用 OpenGL 4.1 和 GLSL 版本 410 渲染逼真的气泡。

在我的研究中，我发现在 3.0（已弃用）和 3.1（已删除）之间存在内置 OpenGL 着色器变量/函数的丢失。

文档中提到了这一点，我得出的结论是，我必须自己在 C++ 代码中编写这些变量并将它们传递给着色器。我只是在寻找有关这些变量的确切作用的方向或解释，以便我可以开始。

我主要关心解释的一些变量/函数，以便我可以开始重写它们：

```
gl_TextureMatrix[int n];

vec4 textureCube (samplerCube sampler, vec3 coord [, float bias] );

gl_FragColor; 
```

此外，是否有提供这些详细解释的途径？

# iphone - [__NSArrayM objectAtIndex:]：空数组的索引 0 超出范围

> ID：13663093
> 
> 赞同：-1
> 
> 时间：2012-12-01T19:51:03.927
> 
> 标签：iphone, objective-c, ios, xcode

我在 Xcode 中的项目中遇到此错误；

NSRangeException [__NSArrayM objectAtIndex:]：空数组的索引 0 超出范围

```
I think the line is here in my initial controller.m file;

            Session *item = [dataArray objectAtIndex:0];

            NSString* strDate = [LoadSessionController GetTimeString:item.mCreateDate];
            cell1.title = @"Restore last session";
            cell1.date = strDate;
            cell1.ago = [LoadSessionController GetBeforeTimeString:item.mCreateDate];   
            cell1.image = item.mThumbnail;
            cell1.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            cell1.selectionStyle = UITableViewCellSelectionStyleBlue;
            cell = cell1;
            break;
        }

As the crash log is this;

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x328c429e __exceptionPreprocess + 158
1   libobjc.A.dylib                 0x395a697a objc_exception_throw + 26
2   CoreFoundation                  0x3280fb70 -[__NSArrayM objectAtIndex:] + 160
3   ColorSplash                     0x0001722a 0x1000 + 90666
4   UIKit                           0x3861f540 -[UITableView(UITableViewInternal) _createPreparedCellForGlobalRow:withIndexPath:] + 408
5   UIKit                           0x38604306 -[UITableView(_UITableViewPrivate) _updateVisibleCellsNow:] + 1306
6   UIKit                           0x3861b7c2 -[UITableView layoutSubviews] + 202
7   UIKit                           0x385d77fe -[UIView(CALayerDelegate) layoutSublayersOfLayer:] + 254
8   QuartzCore                      0x3a2abd5e -[CALayer layoutSublayers] + 210
9   QuartzCore                      0x3a2ab8fc CA::Layer::layout_if_needed(CA::Transaction*) + 456
10  QuartzCore                      0x3a2ac830 CA::Layer::layout_and_display_if_needed(CA::Transaction*) + 12
11  QuartzCore                      0x3a2ac216 CA::Context::commit_transaction(CA::Transaction*) + 234
12  QuartzCore                      0x3a2ac024 CA::Transaction::commit() + 312
13  UIKit                           0x385dd8e6 _afterCACommitHandler + 122
14  CoreFoundation                  0x328996c8 __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 16
15  CoreFoundation                  0x328979bc __CFRunLoopDoObservers + 272
16  CoreFoundation                  0x32897d12 __CFRunLoopRun + 738
17  CoreFoundation                  0x3280aeb8 CFRunLoopRunSpecific + 352
18  CoreFoundation                  0x3280ad44 CFRunLoopRunInMode + 100
19  GraphicsServices                0x35d4f2e6 GSEventRunModal + 70
20  UIKit                           0x386282f4 UIApplicationMain + 1116 
```

但我确信数组不是空的，但也许较新版本的 iOS 需要对 :0 提供不同的答案

任何帮助将非常感激，

谢谢，

克里斯

编辑 - 更多信息；

```
- (void)viewDidLoad
{
    CGRect frame = CGRectMake(0, 0, SCN_WIDTH, SCN_HEIGHT);
    [self.view setFrame: frame];

    self.dataArray = [LoadSessionController loadTableData:NO];
    self.tableView.rowHeight = ROW_HEIGHT;
} 
```

...加载会话控制器是；

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *kCustomCellID = @"MyCellID";

    CustomCell *cell = (CustomCell *)[tableView dequeueReusableCellWithIdentifier:kCustomCellID];
    if (cell == nil)
    {
        cell = (CustomCell *)[[[CustomCell alloc] initWithFrame:CGRectZero reuseIdentifier:kCustomCellID] autorelease];
    }

    Session *item = [dataArray objectAtIndex:[self getDataIndex:indexPath.row]];

    NSString* strDate = [LoadSessionController GetTimeString:item.mCreateDate];
    cell.title = @"Load saved session";
    cell.date = strDate;
    cell.ago = [LoadSessionController GetBeforeTimeString:item.mCreateDate];    
    cell.image = item.mThumbnail;
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;

    return cell;
}

NSInteger TimeSort(Session *obj1, Session *obj2, void *reverse) {
    if ((NSInteger *)reverse == NO) {
       if ([obj1.mCreateDate timeIntervalSinceNow] < [obj2.mCreateDate timeIntervalSinceNow])
           return NSOrderedAscending;
        else
            return NSOrderedDescending;
    }
    else {
        if ([obj1.mCreateDate timeIntervalSinceNow] > [obj2.mCreateDate timeIntervalSinceNow])
            return NSOrderedAscending;
        else
            return NSOrderedDescending;
    }
}

+ (NSMutableArray*) loadTableData:(BOOL) bLoadRestoreData
{
    NSMutableArray* ret = [[NSMutableArray alloc] init];
    NSString* path =[NSHomeDirectory() stringByAppendingPathComponent:@"Documents"];

    int i;
    int nStartNo = 1;
    if (bLoadRestoreData)
        nStartNo = 0;

    for (i = nStartNo; i < 100; i++)
    {
        if ([Session exist:path index:i])
        {
            Session* one = [[Session alloc] init];
            [one read:path index:i];
            [ret addObject:one];
            [one release];
        }
    }

    [ret sortUsingFunction:TimeSort context:self];
    return ret;
}

+ (NSString*) GetTimeString:(NSDate *)date
{
    NSCalendar *calendar = [NSCalendar currentCalendar];
    NSDateComponents *components = [calendar components:
                                    (kCFCalendarUnitHour|kCFCalendarUnitMinute|kCFCalendarUnitYear|kCFCalendarUnitMonth|kCFCalendarUnitDay) fromDate:date];

    //[dateFormatter stringFromDate:date]
    return [NSString stringWithFormat:@"Saved %02d/%02d/%02d  %02d:%02d", components.year, components.month, components.day,
                      components.hour, components.minute];
}

#define TIME_SUFFIX(a) (((a)>1)?"s":"")
+ (NSString*)   GetBeforeTimeString:(NSDate*) date
{
    NSTimeInterval ago = [date timeIntervalSinceNow];

    unsigned int temp = -ago;

    int days = temp / (3600*24); temp = temp % (3600 * 24);
    int hours = temp / 3600; temp = temp % 3600;
    int minutes = temp / 60; temp = temp % 60;
    int seconds = temp;

    if (days == 0 && hours == 0 && minutes == 0)
    {
        return [NSString stringWithFormat:@"%d second%s ago", 
                seconds, TIME_SUFFIX(seconds)];
    }
    else if (days == 0 && hours == 0)
    {
        return [NSString stringWithFormat:@"%d minute%s %d second%s ago", 
                minutes, TIME_SUFFIX(minutes), seconds, TIME_SUFFIX(seconds)];
    }
    else if (days == 0)
    {
        return [NSString stringWithFormat:@"%d hour%s %d minute%s ago", 
                hours, TIME_SUFFIX(hours), minutes, TIME_SUFFIX(minutes)];
    }
    else {
        return [NSString stringWithFormat:@"%d day%s %d hour%s ago", 
                days, TIME_SUFFIX(days), hours, TIME_SUFFIX(hours)];
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T21:10:53.603

“但我确信数组不是空的，但也许较新版本的 iOS 需要一个不同的答案，而不是：0”

不，事实并非如此。你的数组肯定是空的。只需在您认为问题所在的语句之前记录您的数组，然后看看您得到了什么。如果需要检查数组是否为空，可以检查 array.count 是否为 0 或 array.lastObject 是否为 nil。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T19:59:14.957

正如你的错误信息所说，你`dataArray`是空的。要么根本不填写，要么在填写之前访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:01:07.650

数组肯定是空的，通过断言验证它：

```
NSAssert( [dataArray count] >=1, @"Array is empty"); 
```

然后发布您认为填充数组的代码。

# mongodb - 将大集合插入另一个集合

> ID：13663103
> 
> 赞同：1
> 
> 时间：2012-12-01T19:51:53.560
> 
> 标签：mongodb, pymongo

我收集了 30000 个形式的文档：

```
<_id:X src: 1 , dst:2}
<_id:X src: 1 , dst:3}
<_id:X src: 1 , dst:4}
<_id:X src: 1 , dst:5}
<_id:X src: 1 , dst:6}
<_id:X src: 1 , dst:7}
... 
```

我将此集合转换为以下形式：

```
<_id: 1 , listOfNumbers:[2, 3, 4, 5, 6, 7}
<_id: 2 , dst:0}
<_id: 3 , dst:0}
<_id: 5 , dst:0}
<_id: 7 , dst:0}
<_id: 9 , dst:0}
... 
```

我通过使用 MapReduce 操作和 push 方法来做到这一点，转换 10000 个文档需要 12 秒，转换 20000 个文档需要 75 秒。

有谁知道如何更快地做到这一点？索引在这里起作用吗？

谢谢！

# ruby - Ruby 找不到 puts 和其他命令？

> ID：13663109
> 
> 赞同：2
> 
> 时间：2012-12-01T19:52:41.717
> 
> 标签：ruby, macos

我试图做我认为应该是一个非常基本的脚本作为我的第一个 ruby​​ 代码。也许有人可以帮助我解决正在发生的事情。

```
./delete_file.rb: line 3: puts: command not found
./delete_file.rb: line 4: auth_token: command not found
./delete_file.rb: line 6: puts: command not found

User1$ cat delete_file.rb 
# /usr/bin/ruby
# Delete file script
puts "Enter current token"
auth_token = gets.chomp

puts "data goes here" + auth_token + "more data here" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-01T19:54:01.783

文件的第一行应该是：

```
#!/usr/bin/ruby 
```

# java - Java if-then 树中缺少返回语句错误

> ID：13663110
> 
> 赞同：2
> 
> 时间：2012-12-01T19:52:47.333
> 
> 标签：java, compiler-errors, return

我试图告诉 Critter 程序从四个选项中随机选择一种攻击类型；我以为我已经涵盖了我的 return 语句基础，但是我从 drjava 收到“缺少返回语句”错误：

```
public Attack fight(String opponent) {
   int fightChoice = new Random().nextInt(4); 

   if(fightChoice == 0){
     return Attack.ROAR;
   } if(fightChoice == 1){
     return Attack.POUNCE;
   } if(fightChoice == 2){
     return Attack.SCRATCH;
   } if(fightChoice == 3){
     return Attack.FORFEIT;
   }
 } 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T19:54:47.797

基本上，编译器不够聪明，无法确定您已经用这四个`if`语句涵盖了所有可能性（它并不真正了解关于 的返回值的合同`Random.nextInt()`）。

因此，您需要`return`在 final 之后添加一个 dummy `if`。你在那里返回什么并不重要，因为它实际上是死代码。但是，返回某种未使用或明显无效的值将是一种很好的风格。

**编辑**：再三考虑，与其返回一个虚拟值，不如无条件地抛出某种“程序员错误”异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T19:53:18.757

您需要在 if 语句之外缺少一个语句。例如，如果`flightChoice == 4`，任何`if`条件都不成立，所以你应该`return`在方法的末尾添加一个。这个 return 语句必须返回一些类型，`Attack`比如`if`分支。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T19:54:10.327

您可能认为您的*if 语句*涵盖了所有可能的情况，但编译器只编译代码，不涵盖/计算可能性。您需要`return`在最后一个*if-statement*之后添加语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-01T19:54:24.990

试想一下，当你没有人时会发生`if condition`什么`true`？在这种情况下，您不会从该方法返回任何内容。

您应该从您的方法可以遵循的每条路径返回，否则您将收到`missing return`语句错误。

*   您可以创建`if's`一个`if-else if`块，然后`else`在最后添加一个，然后从那里返回一些值。
*   或者，您可以简单地在方法的末尾添加一个 return 语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T19:54:38.423

`return`如果没有`if`陈述是真的，你需要一个陈述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-01T20:04:28.503

上述/先前的答案解释说`return`，如果否`if`为真，您需要在最后声明。在这种情况下，我只想添加一个建议，作为一种好的做法（也许不是最好的）：只在最后返回一个结果并为每个返回的结果分配一个值`if`（也许添加一些`else`s 以使其更有效在这种情况下）。

# android - 如何在 Android 中打开带有 youtube 应用程序的 YouTube 链接（使用 Dreamweaver CS6）？

> ID：13663113
> 
> 赞同：0
> 
> 时间：2012-12-01T19:53:04.740
> 
> 标签：android, jquery, html, mobile, dreamweaver

我正在使用 adobe dreamweaver CS6 和 jQuery Mobile 开发 Android 应用程序。开发后，我的应用程序通过phonegap组合在一起。这里我有以下问题：我有一些与 YouTube 链接相关的按钮，但我希​​望它们在 YouTube 应用程序中打开。我只想在 Dreamweaver 中工作，并且仅在必要时使用插件。我已经阅读过“intents”和“URL-s”，但我不知道如何使用它们以及它们如何在 Dreamweaver 中工作。我还没有找到任何好的教程。

可以的话请详细点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T19:58:29.557

通常你可以简单地链接到 youtube。youtube 应用程序将处理该请求，并在用户允许时启动。

youtube 应用程序有一个特殊的意图处理程序，其中 youtube 的 URL 将被捕获。因此，通常在第一个指向 youtube 的链接上，系统会询问用户是否应该启动 youtube 应用程序或浏览器。

在原生 android 应用程序中有效的这样一个链接是：[http ://www.youtube.com/watch?v=xxxx](http://www.youtube.com/watch?v=xxxx)

所以在dreamweaver/html中它应该是这样的：

```
<a href="http://www.youtube.com/watch?v=xxxx">Some Video</a> 
```

# c# - 如何使用 Joeblogs.dll 在 Wordpress 上发布标签

> ID：13663114
> 
> 赞同：3
> 
> 时间：2012-12-01T19:53:05.697
> 
> 标签：c#, wordpress, xml-rpc, joeblogs

我正在编写一个用于在 wp 博客上发布的类，我正在使用 Joeblogs.dll。我在 Post 结构（或其他任何地方）中找不到的是如何使用博客文章创建标签。

你有什么主意吗？

# php - 显示结果的 CakePHP 分页问题

> ID：13663119
> 
> 赞同：2
> 
> 时间：2012-12-01T19:53:22.157
> 
> 标签：php, cakephp, pagination

我正在为分页而苦苦挣扎。我想使用默认功能。问题是分页按钮（数字，上一个，下一个）的链接不起作用。我不知道如何将 URL 中的“page:2”传递回分页器，让他知道他必须显示/呈现带有接下来 5 个结果的表格。例如：我单击 page:2 的“2”，网站将被刷新，但根本没有显示结果表。

其他信息：输入字段的 URL 位于 cakephp/Posts/index。当我单击分页器按钮（例如 prev）时，分页器转到 cakephp/Posts/index/page:2。

在这里你得到 PostsController 代码：

```
class PostsController extends AppController {    
    var $name = 'Posts';
    public $helpers = array('Html', 'Form', 'Js', 'Paginator');
    public $components = array('RequestHandler');
    public $paginate = array(
    'limit' => 5,
    'maxLimit' => 50,
    'order' => array(
        'Post.INCOME' => 'asc',
    ),
);
function index() {
    //debug($this->request->data);
    //var_dump($this->params);
    if(!empty($this->request->data['ajaxSearchAll'])){
        if($this->RequestHandler->isAjax()){
            //$data = $this->Post->find('all', array('conditions' => array('ZIPCODE LIKE' => '%' . $this->data['ajaxSearchAll'] . '%')));
            $posts = $this->paginate('Post', array('ZIPCODE LIKE' => '%' . $this->data['ajaxSearchAll'] . '%')); 
            //$this->set('posts', $data);
            $this->set(compact('posts')); 
            $this->render('SearchAll', 'ajax');         
        }   
    } 
/// GOES ON WITH IRRELEVANT STUFF /// 
```

下面显示了“search_all.ctp”的视图文件代码（调试转储显示了一个正确的数组应该是怎样的）：

```
<?php $this->paginator->settings = array(
    'limit' => 5,
    'maxLimit' => 25
); 
$this->Paginator->options(array('url' => array('controller' => 'Posts', 'action' => 'index')));
?>
<table>
    <tr>
        <th><?php echo $this->Paginator->sort('CITY', 'Stadt'); ?></th>

        <th><?php echo $this->Paginator->sort('DATE', 'Lieferdatum'); ?></th>
        <th><?php echo $this->Paginator->sort('TIME', 'Lieferzeit'); ?></th>        
    </tr>
    <!-- Hier iterieren wir in einer Schleife durch den $posts Array und geben die Daten des aktuellen Elements aus -->

    <?php foreach ($posts as $post): ?>
    <tr>
        <td><?php echo $this->Html->link($post['Post']['CITY'],"/Posts/view/".$post['Post']['id']); ?></td>
        <td><?php echo $post['Post']['DATE']; ?></td>
        <td><?php echo $post['Post']['TIME']; ?></td>
    </tr>
    <?php endforeach;} ?>
</table>
<?php 
if(!empty($posts)){ 
    echo $this->Paginator->first(__('Erste Seite', true), array('class' => 'disabled'));
    echo " ";
    echo $this->Paginator->prev('« Vorherige Seite', null, null, array('class' => 'disabled'));
    echo " ";
    echo $this->Paginator->numbers();
    echo " ";
    echo $this->Paginator->next('Nächste Seite »', null, null, array('class' => 'disabled'));
    echo " ";
    echo $this->Paginator->last(__('Letzte Seite', true), array('class' => 'disabled'));
} ?>
<?php debug($this->Paginator->params()); 
debug($this->request->params['paging']);
?> 
```

如果你们中的任何人能解决我的问题，我将不胜感激。

更新1：我给你数组

```
debug($this->request->params['paging']); 
```

它看起来非常好。我必须对命名参数做些什么吗？我在食谱中找不到合适的东西:-(

```
array(
    'Post' => array(
        'page' => (int) 1,
        'current' => (int) 5,
        'count' => (int) 11,
        'prevPage' => false,
        'nextPage' => true,
        'pageCount' => (int) 3,
        'order' => array(
            'Post.INCOME' => 'asc'
        ),
        'limit' => (int) 5,
        'options' => array(
            'conditions' => array()
        ),
        'paramType' => 'named'
    )
) 
```

更新 2：index.ctp 的代码，ajax 搜索开始的地方。分页器的查询和第一页运行良好。但根本不是分页器的按钮：

```
<div id="courierQuery">
    <?php echo $this->Form->create(false, array('type' => 'post', 'default' => false)); ?>
    <?php echo $this->Form->input('ajaxSearchAll', array('type' => 'text', 'id' => 'ajaxSearchAll', 'name' => 'ajaxSearchAll', 'label' => false, 'placeholder' => 'Bitte PLZ eingeben'))?>
    <?php $before = $this->Js->get('#loading')->effect('fadeIn', array('buffer' => False)); ?>
    <?php $success = $this->Js->get('#loading')->effect('fadeOut', array('buffer' => False)); ?>
    <?php echo $this->Js->get('#ajaxSearchAll')->event('keyup', $this->Js->request(
        array('controller'=>'Posts', 'action'=>'index'),
            array(
                'update'=>'#erfolgreich_ajax',
                'before' => $before,
                'success' => $success,
                'async' => true,
                'dataExpression' => true,
                'method' => 'post',
                'data'=>$this->Js->serializeForm(array('isForm'=>'false', 'inline'=>'true'))
            )   
        )
    ); ?>
    <?php echo $this->Form->end();?>        
</div>
/// IRRELEVANT STUFF ///
<div id="loading" style="display: none;">
    <div style="float:left;margin-top: 14px"><?php echo $this->Html->image('ajax-loader.gif', array('id' => 'busy-indicator')); ?></div>
    <div style="float:left;margin: 22px 0 0 10px;color: #fff"><p>Suche nach Inseraten l&auml;uft ...</p></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T13:28:24.987

我找到了一个很好的解决方案:)

那就是保存每次点击页面时都会读取的会话参数。最后，Daniel 在视图中的 ajax-pagination-code 提示提供了区分非 ajax 调用和 ajax 调用的能力。因此，每个搜索和分页链接都在控制器代码的 ajax 路径中处理，而会话参数的删除可以在外部处理（这是我之前的一些主要问题）。

控制器代码：

```
 function index() {
    if(!$this->RequestHandler->isAjax()){
        $this->Session->delete('Ajax.searchA');
        $this->Session->delete('Ajax.searchS');
        $this->Session->delete('Ajax.searchB');
    }
    if($this->RequestHandler->isAjax()){
        if(!empty($this->request->data['ajaxSearchAll'])){
            $this->Session->write('Ajax.searchA', $this->request->data['ajaxSearchAll']);
            $this->Session->delete('Ajax.searchS');
            $this->Session->delete('Ajax.searchB');
            $posts = $this->paginate('Post', array('ZIPCODE LIKE' => '%' . $this->Session->read('Ajax.searchA') . '%')); 
            $this->set(compact('posts')); 
            $this->render('SearchAll', 'ajax');         
        } else{
            if($this->Session->read('Ajax.searchA') != null){
                $posts = $this->paginate('Post', array('ZIPCODE LIKE' => '%' . $this->Session->read('Ajax.searchA') . '%')); 
                $this->set(compact('posts'));   
                $this->render('SearchAll', 'ajax'); 
            }
        }
    // OTHER 2 BLOCKS //
    }
} 
```

在视图中也必须进行一些调整。首先是一个 div 包装了 ajax-update 的整个页面，以了解要更新的内容（感谢 Daniel 的提示）。其次 echo $this->Js->writeBuffer(); 在底部获得链式链接对于正常工作至关重要。查看代码（search_all.ctp）：

```
<div id="searchAll">
<?php if(empty($posts)){ ?>
        <p class="error">Leider keine Inserate gefunden :-(</p>
        <p>Sei der erste in Deinem PLZ-Bereich und erstelle ein Inserat:</p>
        <?php echo $this->Html->link('Inserat erstellen', array('controller' => 'Posts', 'action' => 'add')); ?>
    <?php } else { ?>
    <p class="message">Wir haben <?php echo $this->Paginator->counter('{:count}');?> Inserate gefunden :-)</p>
    <?php
    $this->Paginator->options(array(
                  'update'=>'#searchAll',
                  'evalScripts'=>true,
                  'before' => $this->Js->get('#loading')->effect('fadeIn', array('buffer' => false)),
                  'complete' => $this->Js->get('#loading')->effect('fadeOut', array('buffer' => false))
                  ));
    ?>
    <table>
        <tr>
            <th><?php echo $this->Paginator->sort('ZIPCODE', 'Postleitzahl'); ?></th>
        </tr>
        <!-- Hier iterieren wir in einer Schleife durch den $posts Array und geben die Daten des aktuellen Elements aus -->

        <?php foreach ($posts as $post): ?>
        <tr>
            <td><?php echo $post['Post']['ZIPCODE']; ?></td>
        </tr>
        <?php endforeach;} ?>
    </table>
    <?php 
    if(!empty($posts)){ 
        echo $this->Paginator->numbers();
    } ?>
<?php 
//debug($this->Paginator->params()); 
//debug($this->request->params['paging']);
debug($this->Session->read('Ajax.searchA'));
echo $this->Js->writeBuffer();
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T01:24:36.720

我正在使用的方法节省了两种不同的视图：

```
// UsersController.php
public function admin_index() {
    $this->User->recursive = 0;
    $this->set('users', $this->paginate());
}

// admin_index.ctp
<h1>Users</h1>
<?php
$this->Paginator->options(array(
                  'update'=>'#content',
                  'evalScripts'=>true
                  ));
?>

<table id="content-table">
<tr>
    <th><?php echo $this->Paginator->sort('username', 'Username', array('escape'=> false)); ?></th>
    <th><?php echo $this->Paginator->sort('created', 'Created', array('escape'=> false)); ?></th>
</tr>

<?php
foreach ($users as $user) {
    echo "<tr>";
    echo "<td>";
    echo $user['User']['username'];
    echo "</td><td>";
    echo $user['User']['created'];
    echo "</td>";
    echo "</tr>";
}
?>
</table>

<div id="leftcontrols" class="left">
    <?php echo $this->Paginator->first(' <<'); ?>
    <?php echo $this->Paginator->prev(' <'); ?>
</div>
<div id="rightcontrols" class="right">
    <?php echo $this->Paginator->next(' >'); ?>
    <?php echo $this->Paginator->last(' >>'); ?>
</div>
<br/>

<div id="controls" style="text-align:center;">
    <?php echo $this->Paginator->counter(); ?>
</div> 
```

`#content`在我的默认布局中，无论如何它只是围绕视图。

# java - 仅匹配正则表达式中的括号内

> ID：13663122
> 
> 赞同：2
> 
> 时间：2012-12-01T19:53:50.870
> 
> 标签：java, regex, pattern-matching, assert

我正在努力构建一个正则表达式。

匹配规则：

*   必须包含 EN 字符串
*   字符串必须在括号之间
*   在开始的括号中，必须有一个！
*   字符串可以在圆括号内的任何位置
*   如果 EN 字符串存在于括号外，则不能匹配

与 RegEx 匹配的字符串可以具有以下格式，以及预期的相应答案：

```
public void testRegexToMatchContextToIgnoreFromString() {
    String regex = "\\([^\\(].?[EN+].?\\)";
    assertTrue("!(EN)CLIENT".matches(regex));
    assertTrue("!(EN,PR)CLIENT".matches(regex));
    assertTrue("!(PR,EN)CLIENT".matches(regex));

    assertFalse("!(PR)CLIENT".matches(regex));
    assertFalse("!(CO,PR)CLIENT".matches(regex));
} 
```

我尝试了各种方法，但我对 RegEx 知之甚少，所以我最终陷入了困境，无处可去。有人能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T19:56:42.693

这应该符合您的要求（我已经用您的测试用例对其进行了测试）：

```
String regex = ".*!\\(.*EN.*\\).*"; 
```

说明：任何字符 (.*) 的前零个或多个。然后是'！（'，然后是零个或多个任何字符，然后是'EN'，然后是零个或多个任何字符，然后是右括号，然后是零个或多个任何字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:10:38.913

这是您的正则表达式[演示](http://regex101.com/r/qM1gW1)

`!\([^\(\)]*EN[^\(\)]*\)`

注意：不会为 java 转义。

# android - 通过框架布局调用 setcontentview

> ID：13663123
> 
> 赞同：1
> 
> 时间：2012-12-01T19:53:55.230
> 
> 标签：android, android-layout, android-framelayout

我对android开发很陌生，所以答案可能很简单。

我在我的项目中使用这个库， [https://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)

我有我的主布局（activity_main），它有一个显示相机的表面视图。该库使用布局文件（menu_frame）。我的问题是我想将该布局文件覆盖在我的布局（activity_main）之上。因此，不是菜单 (menu_frame) 推送我的布局文件，而是覆盖它并保留我的布局文件。

目的是我想将菜单的不透明度设置为最小，以便在菜单打开时您仍然可以查看它后面的相机。

我调用我的 setcontentview(R.layout.activity_main)，然后调用 setbehindcontentview(R.layout.menu_frame)。所以我想如果我给菜单一个id并将menu_frame布局中的framelayout添加到我的activity_main布局中，我将能够调用setbehindcontentview(R.id.framelayoutId)，但这不起作用。

这是我的代码片段：

```
 @Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       requestWindowFeature(Window.FEATURE_NO_TITLE);

       final int activity = R.layout.activity_main;
       setContentView(activity);

       setBehindContentView(R.layout.menu_frame);

        SlidingMenu sm = getSlidingMenu();
        sm.setShadowWidthRes(R.dimen.shadow_width);
        sm.setShadowDrawable(R.drawable.shadow);
        sm.setBehindOffsetRes(R.dimen.slidingmenu_offset);
        sm.setFadeDegree(0.35f);
        sm.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN); 
```

activity_main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent">

<SurfaceView
    android:id="@+id/surfaceview"
    android:layout_width="fill_parent"
    android:layout_height="match_parent" />

</FrameLayout> 
```

menu_frame.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#FFFFFF" /> 
```

总而言之，我希望一个布局文件覆盖另一个布局文件，或者以一种将它们叠加在彼此之上的方式将两者结合起来。

提前致谢

# c# - 使用 Azure 存储客户端库 v2 的共享访问签名出现 404 错误

> ID：13663130
> 
> 赞同：3
> 
> 时间：2012-12-01T19:54:37.080
> 
> 标签：c#, azure, azure-storage, azure-blob-storage

我正在尝试使用Windows Azure 存储客户端库**的 v2.0为 blob（并使用它）生成共享访问签名。**我从[这个示例](http://vunvulearadu.blogspot.ro/2012/07/how-to-use-shared-access-signature-with.html)开始，但它适用于 v1.7，将其转换为 2.0 会产生 404 错误。

这是我的实际代码：服务器端，生成 SAS：

```
var myAccount = CloudStorageAccount.Parse(
                  ConfigurationManager.ConnectionStrings[
                              "AzureStorageConnectionString"].ConnectionString);
var myContainer = myAccount.CreateCloudBlobClient()
                                          .GetContainerReference(containerName);
myContainer.CreateIfNotExists();

string blobName = "Imports/" + DateTime.UtcNow.ToString("yyyy-MM-dd_HH-mm-ss") 
                             + ".zip";
var myBlob = myContainer.GetBlockBlobReference(blobName);
using (var stream = 
 new MemoryStream(System.Text.Encoding.UTF8.GetBytes("Hey, I'm empty for now.")))
{
    myBlob.UploadFromStream(stream);
}

var sharedAccesSignature = myBlob.GetSharedAccessSignature(
                 new Microsoft.WindowsAzure.Storage.Blob.SharedAccessBlobPolicy()
{
   Permissions = 
       Microsoft.WindowsAzure.Storage.Blob.SharedAccessBlobPermissions.Write 
       | Microsoft.WindowsAzure.Storage.Blob.SharedAccessBlobPermissions.Read,
       SharedAccessExpiryTime = DateTime.UtcNow.AddHours(1),
});

return myBlob.Uri.AbsoluteUri + sharedAccesSignature; 
```

它在客户端尝试了很多事情，有时会导致 404 或 403 服务器错误。例如我试过这个（结果：404）：

```
var blobClient = new CloudBlobClient(new Uri(blobWithSharedAccessSignature));
// blobWithSharedAccessSignature here is : https://azertyuiop.blob.core.windows.net/container1/Imports/2012-12-01_19-43-54.zip?sv=2012-02-12&se=2012-12-01T20%3A43%3A54Z&sr=b&sp=rw&sig=h0bTUk[...]3D
// calling blobWithSharedAccessSignature from a webBrowser works.
// result here is valid for containerName : container1
var container = blobClient.GetContainerReference(containerName);
ICloudBlob blobRef = container.GetBlobReferenceFromServer(blobWithSharedAccessSignature);   ==> error 404
using (var fileStream = File.OpenRead(fileFullPath))
{
    blobRef.UploadFromStream(fileStream);
} 
```

我尝试更换

```
container.GetBlobReferenceFromServer(blobWithSharedAccessSignature); 
```

经过

```
container.GetBlockBlobReference(blobWithSharedAccessSignature); 
```

我也尝试更换

```
blobClient = new CloudBlobClient(new Uri(blobWithSharedAccessSignature)); 
```

经过

```
blobClient = new CloudBlobClient(new Uri(blobWithSharedAccessSignature), new StorageCredentials(blobWithSharedAccessSignature)); 
```

这会导致“403 - 禁止”错误。

有人可以通过在 v2 中提供完整样本来帮助我吗？或者告诉我是我的错误？谢谢 ！

**更新 - 解决方案：（**感谢 Sandrino Di Mattia）

```
// Assuming that blobWithSharedAccessSignature is : 
//  "https://azertyuiop.blob.core.windows.net/container1/Imports/2012-12-01_19-43-54.zip?sv=2012-02-12&se=2012-12-01T20%3A43%3A54Z&sr=b&sp=rw&sig=h0bTUkTR%2FdTF%2BVZgDUuBPHqG%2BiTtFeXK4kepBpDR2AU%3D"
Uri blobUriWithoutCredentials = new Uri(new Uri(blobWithSharedAccessSignature).GetLeftPart(UriPartial.Path));
// here blobUriWithoutCredentials is https://azertyuiop.blob.core.windows.net/container1/Imports/2012-12-01_19-43-54.zip
string credentials = blobWithSharedAccessSignature.Substring(blobWithSharedAccessSignature.IndexOf('?'));
// here credentials is "?sv=2012-02-12&se=2012-12-01T22%3A26%3A55Z&sr=b&sp=rw&sig=Lsk8kLyJ8TFoGNVLbFLftCIXUNlIIRPZalkhoPdUfh8%3D"
var blobClient = new CloudBlobClient(blobUriWithoutCredentials, new StorageCredentials(credentials));
ICloudBlob blobRef = blobClient.GetBlobReferenceFromServer(blobUriWithoutCredentials);
using (var fileStream = File.OpenRead(fileFullPath))
{
    blobRef.UploadFromStream(fileStream);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-01T21:02:46.253

初始化时，`CloudBlobClient`您需要传递 2 个参数

*   **baseUri**：没有 SAS 的 Blob url，`http://test.blob.core.windows.net/temp/Imports/2012-12-01_20-56-52.zip`
*   **凭据**：这应该是您的 SAS 没有 url，`?sv=2012-02-12&se=2012-12-01T21%3A57%3A56Z&sr=b&sp=rw&sig=5JboXXM1Yeo%2BuI6mb18VbURluo%3D`

工作样本：

```
var blobClient = new CloudBlobClient(new Uri(blob.Uri.AbsoluteUri), new StorageCredentials(sharedAccesSignature));
using (var fileStream = File.OpenRead(fileFullPath))
{

    blobClient.GetBlobReferenceFromServer(new Uri(blob.Uri.AbsoluteUri))
                .UploadFromStream(fileStream);
} 
```

额外提示：您不需要获取对容器的引用。您可以通过调用`GetBlobReferenceFromServer`.`CloudBlobClient`

# git - 如何使用 git 管理依赖项？

> ID：13663135
> 
> 赞同：1
> 
> 时间：2012-12-01T19:54:52.343
> 
> 标签：git, dependencies, repository

我是在线开源项目的新手。我已经克隆了一个 repo，但是运行代码需要某些依赖项。我如何找到/下载它们？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T19:59:27.477

Git 对版本控制很有用，但通常不适合依赖管理。例如，如果这是 node.js，您可以在`package.json`. 从那里，您可以使用`npm install`.

因此，您管理依赖项的方式将根据您使用的堆栈而改变。

# javascript - jQuery选择所有具有id属性并具有给定类的项目

> ID：13663137
> 
> 赞同：0
> 
> 时间：2012-12-01T19:55:19.407
> 
> 标签：javascript, jquery, jquery-selectors

我想要做的是选择 ID 属性以给定字符串开头但也有一个类的所有项目。例如我有这个：

```
<div id="test-id-1" class="test"></div>
<div id="test-id-2" class="test selected"></div>
<div id="test-id-3" class="test"></div> 
```

所以我正在尝试使用这样的东西：

```
jQuery('div[id^="test-id-"].selected').trigger('click'); 
```

但它不起作用。它应该只返回我的示例中的第二项。我怎样才能做到这一点？

提前谢谢了， ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T19:58:24.683

触发点击事件的更简单方法是：

```
$('div[id^="test-id-"].selected').click(); 
```

还要记住确保在执行此代码时实际加载了元素。

这是一个例子：http: [//jsfiddle.net/qy5Yc/](http://jsfiddle.net/qy5Yc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:40:00.080

似乎您没有将代码包装在`document.ready`其中，这意味着如果代码在 html 存在之前运行，它不会将处理程序绑定到不存在的元素。使用`ready`事件包装器可确保在代码触发时元素存在

参考：

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

# c++ - 在时间 T 位置 x,y 的多边形

> ID：13663145
> 
> 赞同：0
> 
> 时间：2012-12-01T19:55:57.927
> 
> 标签：c++, opengl, glut

例如，我试图使多边形 A 在时间 = 1 秒时位于 (x,y) 位置。然后它应该在时间 = 2 秒时位于 (x,y+2) 位置。然后我计划制作更多这样的多边形。我还希望它是动画的，并且多边形从第一个位置平滑地移动到第二个位置，而不是一个多边形跳跃一圈。

到目前为止，我已经了解了 glutTimerFunction，但是，根据我的理解，我不能单独告诉多边形位于位置 (x,y) 和时间 T。但似乎我必须制作我想要的每个多边形（大约 500）然后让计时器一次循环遍历所有多边形。

有没有办法使用 glutTimerFunc 明确地告诉多边形在时间 T 处于位置 (x,y)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T06:01:35.970

OpenGL 是一个低级 API，而不是引擎或框架。它没有内置的方法来随着时间的推移自动在位置之间进行插值，这取决于您作为引擎编写者以您认为合适的方式实现。随着时间的推移，两点之间的线性插值相当容易（即，在伪代码中`position = startPos + ((endPos - startPos) * timeElapsed`）。沿着更复杂的曲线进行插值基本上是相同的，只是表示所需曲线的数学要多一些。

您是正确的，您必须手动遍历所有多边形并定位它们。这是使用低级图形 API 而不是预先编写的引擎的另一个特性。

有许多不同复杂性（和价格）的引擎可以为您抽象出这些细节，但是，如果您的目标是学习图形编程，我建议您避开它们并努力学习。

# c++ - 将 double 精确转换为 mpf_class

> ID：13663146
> 
> 赞同：1
> 
> 时间：2012-12-01T19:55:57.767
> 
> 标签：c++, gmp

从 double 初始化 GMP 浮点变量（mpf_t 或 mpf_class，没关系）的正确方法是什么？

代码：

```
#include <iostream>
#include <gmpxx.h>

int main()
{
        double d=0.1;

        //1024 bits is more that 300 decimal digits
        mpf_set_default_prec(1024);

        mpf_class m(d);

        //after initializing mpf_class variable, set default output precision
        std::cout.precision(50);
        std::cout.setf(std::ios_base::scientific);

        std::cout << m << std::endl;

        return 0;
} 
```

输出是：

```
1.00000000000000005551115123125782702118158340454102e-01 
```

没关系，如果我`d`直接打印，但在`m`变量 300 尾数的十进制数字是可信的！我将 GMP 用于迭代数值方法，因此这些非零值会引入错误并使方法收敛缓慢。

如果我初始化`m`为`mpf_class m("0.1");`，则输出为：

```
1.00000000000000000000000000000000000000000000000000e-01 
```

所以问题不`operator<<`在于`mpf_class`. 这个问题不仅存在于初始化，也存在于分配中。

目前我使用以下内容：

```
mpf_class linsys::DtoGMP(const double& arg)
{
        char buf[512];
        sprintf(buf,"%.15le\n",arg);
        return mpf_class(buf);
} 
```

正确转换。

是否有更快和/或更原生的方式来做到这一点？

我的操作系统是 OpenSUSE 12.1，编译器：gcc 4.6.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:11:47.617

如果您以相同的精度打印出双精度数，您应该会看到相同的奇怪数字。那只是因为[0.1 不能用浮点数准确表示](http://www.exploringbinary.com/why-0-point-1-does-not-exist-in-floating-point/)。mpf_class 准确地再现了存储在 double 中的值。这是与您的期望不符的双倍。

可能有一种方法可以指定 gmp 的精度或某种方法来舍入输入。~~我不知道在哪里看~~。

**编辑**

`mpf_class`有一个带有精度参数的构造函数：[http ://www.gnu.org/software/gmp/manual/html_node/C---Interface-Floats.html](http://www.gnu.org/software/gmp/manual/html_node/C---Interface-Floats.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-01-09T23:12:12.960

你可以使用这个方法

`mpf_class a; double d=0.1; a=static_cast<mpf_class>(d*10)/static_cast<mpf_class>(10);` 如果您知道 double 有多少个小数位，则可以使用此方法

# sockets - 间歇性套接字关闭警告导致内部错误

> ID：13663147
> 
> 赞同：0
> 
> 时间：2012-12-01T19:56:04.527
> 
> 标签：sockets, proxy, warnings, internal

我在 weblogic 服务器中收到间歇性套接字警告，并且由于 web 服务器中的内部错误。

警告消息是**BEA-000449**，表示套接字已关闭，因为在 5 秒的指定超时时间内没有从套接字读取数据。我可以更改时间，我可以看到它正在生效。

在错误日志中，我可以看到以下错误：

`Internal Error: proxy error reading status line`

在访问日志中，我看到**502 响应代码**。

我在用：

*   Weblogic 服务器版本 10.3.5 和 10.3.6（这两个版本问题仍然存在）
*   Apache Http 服务器 2.2.22
*   使用 mod_proxy

我已经`SetENV`在 Web 服务器中应用了参数，因为我知道 apache mod_proxy 中存在一些错误。我测试了各种场景以保持活动开/关更改不同的参数等，但对我没有任何作用。

已经超过 9 周了，我一直在处理这个错误，但无法解决它。如果有人可以帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T15:00:11.037

此问题已得到解决。

我们的环境中存在一些与操作系统相关的问题，因为请求需要时间......我们按照 oracle 的建议应用了补丁。为了更安全，我们将 weblogic 服务器的连接超时增加到 25 秒。

# python-3.x - Python 中的石头、纸、剪刀

> ID：13663148
> 
> 赞同：0
> 
> 时间：2012-12-01T19:56:07.023
> 
> 标签：python-3.x

我正在为我的计算机科学课用 Python（我正在使用 Python 33 IDLE）制作石头、剪纸、剪刀游戏。我编写了这个脚本，但是当我运行它并做出选择时，它什么也没做。请帮助并告诉我我错在哪里。这是脚本：

```
from random import choice
cpu = choice(('rock','paper','scissors'))
p1 = input(' rock, paper, or scissors? ')
rock = 1
paper = 2
scissors = 3
if(cpu == rock)and(p1 == rock):
    print('You Tied')
elif(cpu == rock)and(p1 == paper):
    print('You Win')
elif(cpu == rock)and(p1 == scissors):
    print('You Lose')
elif(cpu == paper)and(p1 == rock):
    print('You Lose')
elif(cpu == paper)and(p1 == paper):
    print('You Tied')
elif(cpu == paper)and(p1 == scissors):
    print('You Win')
elif(cpu == scissors)and(p1 == rock):
    print('You Win')
elif(cpu == scissors)and(p1 == paper):
    print('You Lose')
elif(cpu == scissors)and(p1 == scissors):
    print('You Tied') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:08:26.470

这是你的作业=P

一些勘误点：

1 - 由于石头、纸和剪刀是常数并且永远不会改变，因此最好遵循 PEP 8 并将它们全部大写。

2 - 不要害怕使用空格来增加代码的可读性。最初，您将所有内容都“整合在一起”。如果它被分解成逻辑部分，阅读起来很好（尝试阅读并遵循 PEP 8 - 遵循 Python 风格指南将极大地帮助你！）

3 - 您最初拥有：

```
cpu = choice(('rock','paper','scissors')) 
```

哪个制造石头、纸和剪刀`STRINGS`——注意`''`你的选择吗？如果您想评估随机选择的选项，您需要先实例化您的 CONSTANTS，然后让计算机从这些选项中选择 - 这就是为什么，如果您查看下面的版本，我将您的 CONSTANTS 移到上面`cpu = choice()`。

4 - 你有 p1 非常 _ irritating_ （不是你的错，我的字体的错）......我正在阅读它 pl 就像在 pL 中一样......出于这个原因，我会避免用数字命名变量。相反，我做了 player_one （变量名更具描述性，它还可以更具描述性，但对于这个例子来说，它“足够好”）。再次 - PEP 8 是你的朋友！

5 - 很好的第一次尝试！欢迎来到 Python！

注意：我使用的是 2.6/2.7 Python，而不是 3.*，这就是为什么我使用 raw_input() 而不是你的 input()。

```
from random import choice

ROCK = 1
PAPER = 2
SCISSORS = 3

cpu = choice((ROCK, PAPER, SCISSORS))
player_one = raw_input('-> ROCK, PAPER, or SCISSORS? ')

if str(player_one).upper() == 'ROCK':
    player_one = 1
elif str(player_one).upper() == 'PAPER':
    player_one = 2
elif str(player_one).upper() == 'SCISSORS':
    player_one = 3
else:
    print('What the heck did you pick!?  Pick a valid option!')

if(cpu == ROCK)and(player_one == ROCK):
    print('You Tied')
elif(cpu == ROCK)and(player_one == PAPER):
    print('You Win')
elif(cpu == ROCK)and(player_one == SCISSORS):
    print('You Lose')
elif(cpu == PAPER)and(player_one == ROCK):
    print('You Lose')
elif(cpu == PAPER)and(player_one == PAPER):
    print('You Tied')
elif(cpu == PAPER)and(player_one == SCISSORS):
    print('You Win')
elif(cpu == SCISSORS)and(player_one == ROCK):
    print('You Win')
elif(cpu == SCISSORS)and(player_one == PAPER):
    print('You Lose')
elif(cpu == SCISSORS)and(player_one == SCISSORS):
    print('You Tied') 
```

**UPDATE1：** 针对您的最新问题，请查看以下代码。我对代码进行了修改以清理它。我们对“外行”失去了一些可读性，但是一旦你习惯了阅读 Python，我认为这同样干净/清晰。新代码的最后两行向您展示了一种（多种方式）可以实现目标的方式。请记住，您希望在一开始就通过强制比较从 int() 和 str() 进行转换。您不必这样做，所以我所做的是妥协：我`tuple`通过执行您之前拥有的 int() 选项并将它们与作为 int() 值表示的 str() 对象组合来创建. 这样，我可以随时通过引用索引值在两者之间进行交换。

想要在字符串中打印出结果的另一种方法是使用前一行空间将 int() 转换回 str()，然后执行以下操作：

```
print("You picked " + player_one + " and the CPU picked " + cpu) 
```

但是，再次，您必须将您的 player_one 和 cpu 整数转换回它们的字符串。我在下面使用的方法使用元组，因为我更喜欢这种方法而不是你的下意识反应想要你做的事情（这类似于你认为你可能会做的事情）。

```
from random import choice

ROCK = (1, "ROCK")
PAPER = (2, "PAPER")
SCISSORS = (3, "SCISSORS")

cpu = choice((ROCK, PAPER, SCISSORS))

player_one = raw_input('-> ROCK, PAPER, or SCISSORS? ')

if str(player_one).upper() == 'ROCK':
    player_one = (1, "ROCK")
elif str(player_one).upper() == 'PAPER':
    player_one = (2, "PAPER")
elif str(player_one).upper() == 'SCISSORS':
    player_one = (3, "SCISSORS")
else:
    print('What the heck did you pick!?  Pick a valid option!')

out_vect = (cpu[0], player_one[0])

OUTCOMES = ('You Tied', 'You Win', 'You Lose')
POSSIBILITIES = (([(1,2), (2, 3), (3, 1)], OUTCOMES[1]), ([(2, 1), (3, 2), (1, 3)], OUTCOMES[2]))

if(out_vect[0] == out_vect[1]):
    print OUTCOMES[0]
elif out_vect in POSSIBILITIES[0][0]:
    print(POSSIBILITIES[0][1])
elif out_vect in POSSIBILITIES[1][0]:
    print(POSSIBILITIES[1][1])
else:
    print("~Epic Fail~ in the program!")

result_summary = "You chose " + player_one[1] + " and the CPU chose " + cpu[1]

print result_summary 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:01:16.413

`cpu`是`'rock'`,`'paper'`或`'scissors'`, 但您只将其与`1`,`2`和进行比较`3`。这可能是主要问题。

你可以`cpu = choice((1, 2, 3))`解决这个问题。

或者反过来，比较字符串文字，而不是整数：

```
if cpu == 'rock' and p1 == 'rock': # note the quotes 
```

此外，您有 3 个`if`s 代表平局，而应该只有一个：

```
if cpu == p1:
    print('You tied') 
```

# php - Facebook 画布 PHP SDK getLoginUrl

> ID：13663149
> 
> 赞同：-1
> 
> 时间：2012-12-01T19:56:09.067
> 
> 标签：php, facebook, facebook-php-sdk

我正在运行一个通过 PHP-SDK 连接到 Facebook 的网站。我可以弄清楚，出了什么问题：

1.  新用户来到 mysite url 并使用按钮使用 facebook 登录。
2.  Facebook 请求许可。用户接受。
3.  我所有的。

但：

1.  新用户来到 Facebok Canvas 应用程序并使用一个按钮使用 facebook 登录（我不使用 Javascript，也不想使用。）。
2.  没有任何反应，似乎 facebook 调用了 url (getLoginUrl) 但它没有显示用户可以允许权限的页面。

我用：

```
 $params = array(
              'canvas' => 1,
              'fbconnect' => 0,
              'scope' => 'user_about_me, email, publish_stream, read_stream',
              'redirect_uri' => http:/my_domain.com,
              'display' => 'page'
            );
   $loginUrl = $facebook->getLoginUrl($params); 
```

我尝试使用：

```
 'redirect_uri' => 'http://apps.facebook.com/app_namespace/', 
```

但它也不起作用。有人有什么想法吗？

非常感谢...

**编辑：**我尝试使用javascript：top.location.href = ...它有效，但前提是我使用redirect_uri - htttp://domain.com，所以用户不再在facebook画布应用程序中:(我认为有可能是我用错了...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:26:34.737

如果将重定向 uri 设置为画布 URL，则可以使用以下命令获取用户的访问令牌

```
$facebook->getSignedRequest(); 
```

# sql - Postgres Async API 检测查询结束

> ID：13663151
> 
> 赞同：6
> 
> 时间：2012-12-01T19:56:22.467
> 
> 标签：sql, c, postgresql, asynchronous

我正在使用 PostgreSQL C API。阅读[文档](http://www.postgresql.org/docs/current/static/libpq-async.html)，它指出当 PQgetResult 返回 NULL 时查询已完成，如果 PQisBusy 不返回 0，则 PQgetResult 将阻塞。但是，如果没有更多输入，PQisBusy 将返回 1，因此我无法调用 PQgetResult 并获取 NULL。因此我不知道查询是否结束。有没有其他方法可以知道查询是否完成？我误解了异步 API 吗？

- - 编辑 - - -

C代码的基本思想是：

```
PQsendQuery(conn, query)

while(true)
{
    PQconsumeInput(conn)
    if(PQisBusy(conn) == 0)
    {
        PGresult* res = PQgetResult(conn);
        if(res)
        {
            //print result
        }
        else
        {
            //res == NULL
            //indicates query is over
            break;
        }
    }
} 
```

结果将被打印，但循环永远不会终止。因为 PQisBusy 只返回 0 一次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T15:56:26.913

我认为你需要的是`PQsetSingleRowMode`让`PQgetResult`每次返回一行。

来自[http://www.postgresql.org/docs/9.2/static/libpq-single-row-mode.html](http://www.postgresql.org/docs/9.2/static/libpq-single-row-mode.html)

> 通常，libpq 收集 SQL 命令的整个结果并将其作为单个 PGresult 返回给应用程序。对于返回大量行的命令，这可能是不可行的。对于这种情况，应用程序可以在单行模式下使用 PQsendQuery 和 PQgetResult。在这种模式下，结果行一次返回给应用程序，因为它们是从服务器接收的。
> 
> 如果查询返回任何行，它们将作为单独的 PGresult 对象返回，除了具有状态码 PGRES_SINGLE_TUPLE 而不是 PGRES_TUPLES_OK 之外，它们看起来像正常的查询结果。在最后一行之后，或者如果查询返回零行，则立即返回状态为 PGRES_TUPLES_OK 的零行对象；这是不再有行到达的信号。

查看示例代码： [https ://github.com/markokr/libpq-rowproc-demos/blob/master/demo-onerow-async.c](https://github.com/markokr/libpq-rowproc-demos/blob/master/demo-onerow-async.c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T14:54:31.010

根据我从评论中的链接中了解的内容，我会尝试这样的事情（参数`select()`和其他函数调用可能完全不同）：

```
if (select(sock   1, &input_mask, NULL, NULL, NULL) < 0) {

    fprintf(stderr, "select() failed: %s\n", strerror(errno));
    exit_nicely(conn);
}

PQconsumeInput(conn);

while (PQisBusy(conn) != 0) {

    /* wait here */ 

}

while (PGresult* res = PQgetResult(conn)) { /* not sure this is OK, test for not null */

    /* do something with res */

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-04T09:32:47.597

我可以看到代码的一个问题，您没有检查 PQconsumeInput(conn) 函数的返回。因为 PQconsumeInput 负责清除繁忙标志。可能发生的情况是 PQconsumeInput 会在不处理任何数据并清除繁忙标志的情况下失败。

我认为在调用 PQisBusy 之前检查 PQconsumeInput 的结果应该可以正常工作。

```
while (PQconsumeInput(conn) == 1) 
{
  if(PQisBusy(conn) == 0)
  {
        PGresult* res = PQgetResult(conn);
        if(res)
        {
            //print result
        }
        else
        {
            //res == NULL
            //indicates query is over
            break;
        }
    }
} 
```

# android - 使视图宽度 wrap_content，但不超过 0.5 权重

> ID：13663153
> 
> 赞同：3
> 
> 时间：2012-12-01T19:56:31.597
> 
> 标签：android, layout

在我的 LinearLayout 中，我有两个子 ViewGroups，基本上我希望它们每个占用 50% 的空间（并且已经完成），但也有可能这些 ViewGroups 之一的内容远小于 50%，在这种情况下，有没有办法让第二个视图匹配剩余空间？

现在我的布局如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:orientation="horizontal"
    android:weightSum="1">

<include layout="@layout/layout1"
    android:layout_width="0dip"
    android:layout_weight="0.5"
    android:layout_height="match_parent" />

<include layout="@layout/layout2"
    android:layout_width="0dip"
    android:layout_weight="0.5"
    android:layout_height="match_parent" /> 
```

而我想要实现的是：一种布局wrap_content，但不超过50%，第二种布局填满剩余空间。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:01:28.720

在您的线性布局中制作两个布局，并为每个布局指定`layout_weight`. `0.5`然后在其中的每一个中放置一个带有 trait 的视图组`android:layout_width="wrap_content"`。像这样 -

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:paddingTop="5dp"
android:paddingBottom="5dp"
android:orientation="horizontal"
android:weightSum="1">
    <LinearLayout
       android:layout_weight="0.5"
       ......
<include layout="@layout/layout1"
    android:layout_width="wrap_content"
    android:layout_height="match_parent" />
</LinearLayout>
<LinearLayout
     android:layout_weight="0.5"
     ......
<include layout="@layout/layout2"
    android:layout_width="0dip"
    android:layout_weight="0.5"
    android:layout_height="match_parent" />
<LinearLayout/> 
```

# mysql - MySQL InnoDB 删除 500,000 条记录会降低整个服务器的速度

> ID：13663158
> 
> 赞同：0
> 
> 时间：2012-12-01T19:57:07.887
> 
> 标签：mysql, linux, innodb

每周都会触发一个 cronjob，从使用 InnoDB 引擎的 MySQL 表中删除大约 500,000 条记录。该表包含用于每周处理的 Web 日志数据，然后删除不再需要的数据。该表上有 3 个索引（没有外键），包括时间，它是一个 unix 时间戳。

> 从 global_viewlog 中删除时间<1354391592

问题是上周运行的这个查询需要 2 多个小时才能运行，而在那段时间我的整个服务器都滞后了。'iotop' 揭示了被 MySQL 引用大量写入的硬盘，并且服务器负载急剧增加到不健康的水平。

每次点击都会写入表格。房间里有我没看到的大象吗？即，优化这个每周查询的一些显而易见的事情？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T20:02:22.107

如果您定期根据时间删除旧数据，那么基于同一列对表进行分区会使其速度更快。它将不同的时间段分隔到磁盘上的不同区域，因此删除只是删除整个块而不是查看单个行。

[http://dev.mysql.com/doc/refman/5.5/en/partitioning.html](http://dev.mysql.com/doc/refman/5.5/en/partitioning.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:25:20.860

您正在使用 InnoDB，因此存在隐式事务。您正在删除一大堆记录，因此交易量很大。@Erik Ekman 是对的，如果您可以进行分区工作，那么这是处理此问题的好方法。

但这是另一个好方法。尝试以较小的批次进行删除，就像这样。

```
 DELETE 
    FROM global_viewlog 
   WHERE time<135439159
   LIMIT 1000 
```

继续发布此声明，直到没有任何内容可删除。大多数客户端库（JDBC 等）返回受影响的记录数。或者，如果您想以便宜的方式执行此操作，您可以从脚本中发出一千次语句。

（您可以调整`LIMIT`语句中的记录数。）它可能会或可能不会比您的单个删除语句花费更多的时间，但它不会占用您的服务器太多。

尝试将此表的访问方法更改为 MyISAM 并使用：

```
 DELETE LOW_PRIORITY QUICK
    FROM global_viewlog 
   WHERE time<135439159 
```

这将使您的清理操作不会干扰生产。

将您的 cronjob 的频率从每周一次更改为每天一次。这将减少您的删除批次的大小，因此您无需清理如此庞大的混乱。

# maven-3 - Maven Tycho：有没有办法在构建过程中删除“eclipsec.exe”？

> ID：13663162
> 
> 赞同：0
> 
> 时间：2012-12-01T19:58:39.167
> 
> 标签：maven-3, tycho

在“/products//Win32/{x86 |x86_64}/../”下成功构建窗口环境“eclipsec.exe”后，有什么方法可以在构建过程中删除“eclipsec.exe”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T10:07:43.337

到目前为止，只有一种解决方法

[http://dev.eclipse.org/mhonarc/lists/tycho-user/msg03071.html](http://dev.eclipse.org/mhonarc/lists/tycho-user/msg03071.html)

它依赖于 p2 接触点执行的未指定顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T07:48:20.070

为此，我已成功使用 p2.inf 建议文件。我添加了在安装产品时删除不需要的文件的说明。我还没有经历过这种失败，但是 P2 没有很好的文档记录，所以如果 p2.inf 应用到早期，文件可能仍然出现......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-02T06:58:23.330

您可以设置 maven-clean-plugin 在“干净”生命周期中将其清除。但这只会在您运行“mvm clean”时执行：

```
 <plugin>
    <artifactId>maven-clean-plugin</artifactId>
    <version>2.5</version>
    <configuration>
      <filesets>
        <fileset>
          <directory>/products//Win32/{x86 |x86_64}/../</directory>
          <includes>
            <include>eclipsec.exe</include>
          </includes>
        </fileset>
      </filesets>
    </configuration>
  </plugin> 
```

[http://maven.apache.org/plugins/maven-clean-plugin/examples/delete_additional_files.html](http://maven.apache.org/plugins/maven-clean-plugin/examples/delete_additional_files.html)

另一种选择是使用 maven-antrun-plugin：

```
<plugin>
<artifactId>maven-antrun-plugin</artifactId>
<version>1.7</version>
<executions>
  <execution>
    <phase>package</phase>
    <configuration>
      <target>
        <delete file="/products//Win32/{x86 |x86_64}/../eclipsec.exe"/>
      </target>
    </configuration>
    <goals>
      <goal>run</goal>
    </goals>
  </execution>
</executions> 
```

这是附加到“包”阶段，将在项目编译后删除文件。更多关于插件使用的信息： [http ://maven.apache.org/plugins/maven-antrun-plugin/usage.html](http://maven.apache.org/plugins/maven-antrun-plugin/usage.html)

# ruby - if + else 和 if -> unless 之间的不一致

> ID：13663163
> 
> 赞同：8
> 
> 时间：2012-12-01T19:58:48.800
> 
> 标签：ruby, rspec, capybara, railstutorial.org

今天我在定义自定义 RSpec 匹配器时遇到了一个问题，我解决了这个问题，但实际上看不出为什么其中一种方法有效而另一种方法无效的任何原因，下面是代码：

方法 1 - if + else：

```
RSpec::Matchers.define :have_success_message do |message|
  match do |page|
    if message.nil?
      page.should have_selector('div.alert.alert-success')
    else
      page.should have_selector('div.alert.alert-success', text: message)
    end
  end
end 
```

方法 2——如果后面跟着除非

```
RSpec::Matchers.define :have_success_message do |message|
  match do |page|
    page.should have_selector('div.alert.alert-success') if message.nil?
    page.should have_selector('div.alert.alert-success', text: message) unless message.nil?
  end
end 
```

我认为第一种方法更好，因为它只检查一次条件，但是结果应该是一样的，对吧？

好吧，事实证明第一种方法的测试通过了，而第二种方法的测试没有。我完全不知道为什么会这样，如果有人能对此有所了解，我会很高兴。

编辑：

忘记添加实际测试（使用方法 2）：

存在以下 HTML 标记：

```
<div class="alert alert-success">Profile updated</div> 
```

我运行 4 个单独的测试：

```
it { should have_success_message } # fails
it { should have_success_message('Profile updated') } # passes
it { should have_selector('div.alert.alert-success') } # passes
it { should have_selector('div.alert.alert-success', text: "Profile updated") } # passes 
```

失败带有以下消息：

```
1) User pages edit with valid information 
 Failure/Error: it { should have_success_message }
   expected #<Capybara::Session> to have success message
 # ./spec/requests/user_pages_spec.rb:80:in `block (5 levels) in <top (required)>' 
```

当 HTML 标记不存在时，所有 4 个测试都失败。

编辑2：

我尝试了另一种方法来验证控制流是否正确：

方法3：

```
if message.nil?
  puts "In if, message is: #{message.inspect}"
  page.should(have_selector('div.alert.alert-success'))
end
unless message.nil?
  puts "In unless, message is: #{message.inspect}"
  page.should(have_selector('div.alert.alert-success', text: message))
end 
```

使用这种方法，行为与方法 2 相同 - 第一次测试失败，然后通过 3 次。

输出如下：

> 在 if 中，消息是：nil
> 在除非，消息是：“配置文件已更新”

所以控制流看起来不错，但是

```
page.should(have_selector('div.alert.alert-success')) 
```

失败，即使它通过了匹配器之外。这真是一个谜。

最终编辑：

只是为了响应批准的答案-当我像这样切换代码时：

```
page.should have_selector('div.alert.alert-success', text: message) unless message.nil? 
page.should have_selector('div.alert.alert-success') if message.nil? 
```

测试如下所示：

```
it { should have_success_message } # passes
it { should have_success_message('Profile updated') } # fails
it { should have_selector('div.alert.alert-success') } # passes
it { should have_selector('div.alert.alert-success', text: "Profile updated") } # passes 
```

所以我认为确实最后一行，当它不正确时，被评估为零，这会导致整个混乱。无论如何，第一种方法更好，但我很高兴我没有想到这个问题:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T20:48:46.297

这对于 RSpec 来说是正确的行为，尽管它看起来很意外。

考虑这段代码：

```
x = nil
"foo" if x.nil?
"bar" unless x.nil?
#=> 
"foo"
nil 
```

当条件为假时，该`...unless`语句返回。`nil`

在您的自定义匹配器中，`...unless`当您的消息为 nil 时，该语句返回 nil。

这是匹配块中的最后一行，所以匹配块返回 nil。

然后 RSpec 看到您的匹配块返回 nil，RSpec 认为它与 false 相同，因此 RSpec 报告您的自定义匹配器失败。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-01T22:05:21.027

哇，那是一个巧妙的谜题！关键是该`match`方法应该返回一个布尔结果。在第一个选项中，隐式返回值是`if`分支的结果，即`true`.

为什么呢`true`？嗯，`should`是这样[定义](https://github.com/rspec/rspec-expectations/blob/master/lib/rspec/expectations/syntax.rb#L53)的：

```
 def should(matcher=nil, message=nil, &block)
        ::RSpec::Expectations::PositiveExpectationHandler.handle_matcher(self, matcher, message, &block)
      end 
```

它委托给[`PositiveExpectationHandler`](https://github.com/rspec/rspec-expectations/blob/master/lib/rspec/expectations/handler.rb#L17)，其`handle_matcher`方法如下所示：

```
 def self.handle_matcher(actual, matcher, message=nil, &block)
    check_message(message)
    ::RSpec::Matchers.last_should = :should
    ::RSpec::Matchers.last_matcher = matcher
    return ::RSpec::Matchers::BuiltIn::PositiveOperatorMatcher.new(actual) if matcher.nil?

    match = matcher.matches?(actual, &block)
    return match if match

    message ||= matcher.respond_to?(:failure_message_for_should) ?
                matcher.failure_message_for_should :
                matcher.failure_message

    if matcher.respond_to?(:diffable?) && matcher.diffable?
      ::RSpec::Expectations.fail_with message, matcher.expected, matcher.actual
    else
      ::RSpec::Expectations.fail_with message
    end
  end 
```

我们可以看到，如果匹配器返回`true`（或实际上是任何真值），则 this 从函数返回并隐式成为 的返回值`should`。我不确定这种行为是否记录在任何地方。

然而，在第二个选项中，最后一个表达式/语句的值获胜，并且因为`unless`条件是`true`，所以表达式计算为`nil`：

```
1.9.3-p0 :001 > x unless true
 => nil 
```

所以 RSpec 认为 matcher 试图报告失败是因为你`nil`意外返回。

* * *

要解决此问题，您可能不应该`should`在匹配器中使用。您可以像这样调用 Capybara 的`HaveSelector`匹配器：

```
if message.nil?
  have_selector('div.alert.alert-success').matches? page
else
  have_selector('div.alert.alert-success', text: message).matches? page
end 
```

顺便说一句，指定`text: nil`最终会流到[此处](https://github.com/jnicklas/capybara/blob/master/lib/capybara/helpers.rb#L29)，它将导致空的正则表达式，因此`nil`无论如何都不需要检查，您可以像这样编写匹配器：

```
match do |page|
  have_selector('div.alert.alert-success', text: message).matches? page
end 
```

不是很Rubyesque，我承认，但你去吧。

# python - 仅将唯一行插入 SQLite（python）

> ID：13663164
> 
> 赞同：13
> 
> 时间：2012-12-01T19:58:51.233
> 
> 标签：python, sqlite

我`cursor.executemany`用来将 CSV 文件中的成批行插入到 SQLite 表中，其中一些预计会根据主键字段重复。当我执行命令时，我可以预见地得到一个完整性错误并且没有插入任何内容。

如何有选择地只插入非重复行，而不必提前手动过滤掉它们？我知道在纯 Python 中你可以简单地创建一个错误异常并跳过重复的行——在这个用例中我可以实现类似的东西吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-01T22:02:34.893

只需使用`INSERT OR IGNORE`忽略重复项。

[http://sqlite.org/lang_insert.html](http://sqlite.org/lang_insert.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-01T20:53:42.863

一种选择是简单地使用错误捕获手动写出循环，而不是使用`executemany`.

伪代码：

```
for row in csvfile:
   try:
       cursor.execute('INSERT INTO X (Y) VALUES (%s)' % row[rowdatapoint])
   except IntegrityError:
       pass 
```

可能不如 高效`executemany`，但它会捕获您的错误，而不是进入更复杂的 SQL 更改，这可能涉及您预先生成一个巨大的`INSERT`SQL 字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-08-02T12:35:25.023

在批量插入中有重复记录是一种痛苦，会导致整个批处理失败。然而`ON CONFLICT`，作为子句扩展的`INSERT`子句清除了重复记录的障碍。有多个 SQLite 子句可用于处理此类情况：

`INSERT OR IGNORE` **忽略**重复记录

`INSERT OR REPLACE` **用最少的替换**最新的重复记录

更多解释：

1.  [https://sqlite.org/lang_conflict.html](https://sqlite.org/lang_conflict.html)
2.  [https://sqlite.org/lang_insert.html](https://sqlite.org/lang_insert.html)

# c++ - 通过浏览器授权

> ID：13663165
> 
> 赞同：2
> 
> 时间：2012-12-01T19:58:52.280
> 
> 标签：c++, http, http-get, last.fm

我正在尝试编写一个与 Last.fm API 交互的应用程序，但我被卡住了。我的问题与授权有关。引用 Last.fm API 网站：

> 您的应用程序需要打开 Web 浏览器的实例并将用户发送到 last.fm/api/auth，并将您的 API 密钥和身份验证令牌作为参数。使用 HTTP GET 请求。

我知道如何发送 GET 请求以及如何使用指定的 URL 打开浏览器。但是，当用户在浏览器中批准或不批准授权时，如何实现此功能并捕获我的应用事件？也许我应该使用 HTTP GET 15 秒，如果我没有收到用户名，我应该要求用户再次执行授权。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:33:38.960

这有点意思。说明看起来很简单，但这实际上是一个难题，而且似乎 Last.fm 自己的用于与服务交互的[liblastfm C++ 库](https://github.com/lastfm/liblastfm)提供了解决方案。

一些按难度递增的方法包括：

*   打开该 URL 的默认 Web 浏览器，并显示一个按钮供用户在授权应用程序后单击。

    优点：简单

    缺点：用户体验差。您需要确保有明确的说明供用户遵循，以免他或她感到困惑。此外，用户可能会认为您的应用程序已损坏，因为“他们已经授权了您的应用程序！”，直到他或她按下按钮时才意识到您的应用程序不知道这一点。

*   打开默认 Web 浏览器到 URL，显示无限期的“等待来自 Last.fm 的授权”消息，并每隔 15 秒左右轮询一次[auth.getSession](http://www.last.fm/api/show/auth.getSession)方法 API 调用，以查看用户是否已授权您的应用程序。也许还提供“立即检查”按钮。

    优点：简单且用户体验不差。

    缺点：API 似乎没有提供表明用户拒绝授权的错误代码。您可能不知道用户是否曾经授权过您的应用程序，并且您可能会永远等待授权。此外，我不知道 auth.getSession 调用是否有限制，但您可能会遇到速率限制问题。

*   在您的应用程序中嵌入 Web 浏览器。您可以完全控制它，并且设置事件处理程序应该很简单。

    优点：无需轮询，因为应用程序会在用户提交表单时收到通知。

    缺点：用户界面可能会让某些用户感到困惑。

*   向操作系统注册自定义 URI 方案并使用 Last.fm 的[说明授权 Web 应用程序](http://www.last.fm/api/webauth)。

    这个想法是注册一个 URI 方案（也称为应用程序协议；例如`myApp://`）并使用自定义方案（例如）指定一个回调 URL `myApp://lastFmAuthorizationCallback`。

    看：

    *   [将应用程序注册到 URI 方案](http://msdn.microsoft.com/en-us/library/aa767914.aspx)
    *   [如何创建自己的 URL 协议？（例如所以：//…）](https://stackoverflow.com/q/389204/196844)
    *   [如何将自定义协议映射到 Mac 上的应用程序？](https://stackoverflow.com/q/471581/196844)
*   （特定于平台）自动化网络浏览器。执行此操作的确切方法取决于 Web 浏览器和平台。

    优点：可以无缝。正确完成后应提供出色的用户体验。

    Cons: Tricky to develop and the automation might break with an upgrade of the browser.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T00:17:29.363

这部分取决于您用于启动浏览器进程的 API。如果您使用的 API 可以检测到启动的进程何时退出，请使用该机制。对 HTTP GET 的 /auth 调用您不会收到任何类型的用户名。根据[桌面应用程序的其余身份验证文档，](http://www.last.fm/api/desktopauth)当用户批准后，浏览器将自动关闭：

> 一旦用户授予您的应用程序使用其帐户的权限，基于浏览器的过程就结束了，并且要求用户关闭浏览器并返回到您的应用程序

在此之后，您还需要执行一些步骤。您接下来需要调用[auth.getSession](http://www.last.fm/api/show/auth.getSession)来获取会话。如果用户尚未批准您的应用，则此调用将失败（并且您可以向用户显示他们需要批准您的应用并再次向他们提供链接的失败）。以下是列出的可能错误类型：

> 错误
> 
> 4：提供的身份验证令牌无效
> 
> 14：这个令牌没有被授权
> 
> 15：此令牌已过期
> 
> 4 : Authentication Failed - 您没有访问服务的权限
> 
> 9：无效的会话密钥 - 请重新验证 10：无效的 API 密钥 - 您必须被授予
> 
> 等等。

在您批准会话后，您可以开始进行适当的呼叫

# jsp - 将文件上传到数据库

> ID：13663166
> 
> 赞同：0
> 
> 时间：2012-12-01T19:58:59.430
> 
> 标签：jsp, servlets, file-upload

我创建了一个包含以下条目的数据库

```
File_data     longvarchar
File_date     date 
```

我们正在尝试在upload.jsp 中将文件插入数据库，但是当我单击sendfile 按钮时，它显示一个空白页并且文件没有保存在数据库中。

```
<%@ page import="java.io.*,java.sql.*,java.util.*,java.text.*,java.text.SimpleDateFormat" %>
<html>
<%
int val =0;
String contentType = request.getContentType();
if ((contentType != null) && (contentType.indexOf("multipart/form-data") >= 0)) {
DataInputStream in = new DataInputStream(request.getInputStream());
int formDataLength = request.getContentLength();
byte dataBytes[] = new byte[formDataLength];
int byteRead = 0;
int totalBytesRead = 0;

while (totalBytesRead < formDataLength) {
byteRead = in.read(dataBytes, totalBytesRead, formDataLength);
totalBytesRead += byteRead;
}
String file = new String(dataBytes);
String saveFile = file.substring(file.indexOf("filename=\"") + 10);
System.out.println("saveFile=" + saveFile);
saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1,saveFile.indexOf("\""));
System.out.println("saveFile" + saveFile);
saveFile = file.substring(file.indexOf("filename=\"") + 10);
saveFile = saveFile.substring(0, saveFile.indexOf("\n"));
saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1,saveFile.indexOf("\""));
int lastIndex = contentType.lastIndexOf("=");
String boundary = contentType.substring(lastIndex + 1,contentType.length());
int pos;

pos = file.indexOf("filename=\"");
pos = file.indexOf("\n", pos) + 1;
pos = file.indexOf("\n", pos) + 1;
pos = file.indexOf("\n", pos) + 1;
int boundaryLocation = file.indexOf(boundary, pos) - 4;
int startPos = ((file.substring(0, pos)).getBytes()).length;
int endPos = ((file.substring(0, boundaryLocation)).getBytes()).length;

FileOutputStream fileOut = new FileOutputStream(saveFile);
fileOut.write(dataBytes, startPos, (endPos - startPos));
 %>

 <%
Connection con=null;
PreparedStatement pstatement = null;
String line = null;
String value=null;
String url = "jdbc:derby://localhost:1527/";
String dbName = "CustomerDB";
String userName = "admin"; 
String password = "admin";
try{
StringBuilder contents = new StringBuilder();
BufferedReader input = new BufferedReader(new FileReader(saveFile));
while (( line = input.readLine()) != null){
contents.append(line);
}
value = contents.toString();
System.out.println("Value:"+value);
Class.forName("oracle.jdbc.driver.OracleDriver");
con = DriverManager.getConnection(url+dbName,userName,password);
java.util.Date now = new java.util.Date();
String DATE_FORMAT = "yyyy-MM-dd hh:mm:ss";
SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT);
String strDateNew = sdf.format(now) ;

String queryString = "INSERT INTO file_tbl set file_data='"+value+"',file_date='"+strDateNew+"'";

//out.println(queryString);

pstatement=con.prepareStatement(queryString);

val = pstatement.executeUpdate();

 if(val>0)
 {
 %>
 <br><br>
  <b>File <% out.println(saveFile); %> has been uploaded and inserted into Database at <%=strDateNew%>.</b>
 <%
 }

 }
 catch(Exception e)
  {}
 }
 %>
 </html> 
```

我没有得到正在发生的事情，因为它没有向我显示任何错误。所以请帮助我如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T10:34:42.417

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
 pageEncoding="ISO-8859-1"%>
 <%@ page  import="java.io.*,java.sql.*,java.util.*,java.text.*,java.text.SimpleDateFormat" %>    
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>

 <%
 int val =0;
String contentType = request.getContentType();
if ((contentType != null) && (contentType.indexOf("multipart/form-data") >= 0)) {
DataInputStream in = new DataInputStream(request.getInputStream());
int formDataLength = request.getContentLength();
out.println(formDataLength);
 byte dataBytes[] = new byte[formDataLength];
int byteRead = 0;
 int totalBytesRead = 0;

while (totalBytesRead < formDataLength) {
byteRead = in.read(dataBytes, totalBytesRead, formDataLength);
totalBytesRead += byteRead;
 }
String file = new String(dataBytes);
String saveFile = file.substring(file.indexOf("filename=\"") + 10);
System.out.println("saveFile= " + saveFile);
saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1,saveFile.indexOf("\""));
System.out.println("saveFile" + saveFile);
saveFile = file.substring(file.indexOf("filename=\"") + 10);
saveFile = saveFile.substring(0, saveFile.indexOf("\n"));
saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1,saveFile.indexOf("\""));
int lastIndex = contentType.lastIndexOf("=");
String boundary = contentType.substring(lastIndex + 1,contentType.length());
int pos;

 pos = file.indexOf("filename=\"");
 pos = file.indexOf("\n", pos) + 1;
 pos = file.indexOf("\n", pos) + 1;
 pos = file.indexOf("\n", pos) + 1;
 int boundaryLocation = file.indexOf(boundary, pos) - 4;
 int startPos = ((file.substring(0, pos)).getBytes()).length;
 int endPos = ((file.substring(0, boundaryLocation)).getBytes()).length;

 FileOutputStream fileOut = new FileOutputStream(saveFile);
 fileOut.write(dataBytes, startPos, (endPos - startPos));
  %>

 <%
 String line = null;
 String value=null;
 try{
 StringBuilder contents = new StringBuilder();
 BufferedReader input = new BufferedReader(new FileReader(saveFile));
 while (( line = input.readLine()) != null){
  contents.append(line);
 }
 value = contents.toString();
 System.out.println("Value: "+value);
Class.forName("oracle.jdbc.driver.OracleDriver");
 Connection con=DriverManager.getConnection("jdbc:oracle:thin:@//localhost:1521/xe","system","vyas");
 java.util.Date now = new java.util.Date();
 String DATE_FORMAT = "yyyy-MM-dd hh:mm:ss";
 SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT);
 String strDateNew = sdf.format(now) ;
 System.out.println(strDateNew);

 Statement stmt=con.createStatement();
 System.out.println("Run");
 stmt.executeUpdate("insert into userstorage (data,date) values('"+ value +"','"+        strDateNew +"')");
 System.out.println("query successfully run");

 }
 catch(Exception e)
{
 System.out.println(e.getMessage());
}
 }
 %>

 </body>
 </html> 
```

# command-line - PSEXEC - “句柄无效”以系统用户身份运行命令时

> ID：13663167
> 
> 赞同：14
> 
> 时间：2012-12-01T19:59:07.167
> 
> 标签：command-line, batch-file, psexec, command-line-tool

如果从用户生成的命令提示符运行，这是可以正常工作的命令：

```
PSEXEC \\xxx.xxx.xxx.xxx -u xxxx -p xxxx -accepteula cmd /c "TYPE C:\Pyxislog\PYXIS01.log|Find/i "%ID%"" >nul 
```

但是，如果我尝试从系统调用的 cmd 提示符运行它，我会得到：

```
Couldn't access 10.219.149.65:
The handle is invalid.
Connecting to 10.219.149.65... 
```

它必须以系统用户身份运行，因为它将通过以系统用户身份运行的远程软件工具进行部署。这是 psexec 的限制吗？是的，用户名和密码具有管理权限。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-18T12:09:54.950

经过大量研究，它是一个windows安全功能，可以阻止系统用户的所有网络访问，包括以另一个用户身份运行任务。我发现规避此问题的最佳方法是创建计划任务以从管理员帐户运行 psexec。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:01:10.827

**Psexec 通过添加-s**参数强制使用系统用户帐户。

我们使用 psexec 在远程计算机中启动一些任务，并将其记录在数据库表中。当我们不使用 -s 参数时，用户显示为域\管理员，但如果您使用 -s 参数，它显示为“系统”

对于无效的句柄消息，请检查：

[https://superuser.com/questions/200938/psexec-the-handle-is-invalid](https://superuser.com/questions/200938/psexec-the-handle-is-invalid)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-29T06:07:49.597

您是否尝试过使用 -h 标志？

来自 technet：-h 如果目标系统是 Vista 或更高版本，则使用帐户的提升令牌运行进程（如果可用）。

整页：[https ://technet.microsoft.com/en-us/sysinternals/psexec.aspx](https://technet.microsoft.com/en-us/sysinternals/psexec.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-25T19:28:50.740

这可能是不相关的，但我实际上发现如果连接到机器上我得到了这个“句柄无效”错误 - 即机器睡着了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-09T18:56:30.587

这是我用来遵循 IT 人员关于安排任务以管理员身份运行并避免“句柄无效”问题的说明的代码。

```
 //Schedule a task that will run the script
        using (TaskService ts = new TaskService())
        {
            TaskDefinition td = ts.NewTask();
            td.RegistrationInfo.Description = "Runs script as admin user";
            td.Triggers.Add(new TimeTrigger(DateTime.Now.AddMinutes(2)));
            td.Actions.Add(new ExecAction(@"C:\...\script.exe"));
            try
            {
                ts.RootFolder.RegisterTaskDefinition(@"Script", td, TaskCreation.CreateOrUpdate, "username", "password", logonType: TaskLogonType.Password);
            }
            catch (UnauthorizedAccessException e)
            {
                Console.WriteLine("Could not register task in task scheduler.");
                Console.WriteLine(e.ToString());
                return;
            }
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-30T09:22:08.877

我的代码完美运行：

```
public static void RunTask(string[] task, string username, string password)
{
    System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo(task[1] + ".exe");
    psi.RedirectStandardOutput = true;
    psi.RedirectStandardError = true;
    psi.CreateNoWindow = true;
    psi.UseShellExecute = false;
    string args = String.Format(@"-u {1} -p {2} -accepteula \\{0} " + (task[1] == "psexec" ? "-d -s -i 2 {3}" : "{3}"), task[0], username, password, task[1] == "psservice" ? task[2].TrimStart('"').Insert(task[2].IndexOf(' '), "\"") : task[2]);
    psi.Arguments = args;

    System.Diagnostics.Process prc = System.Diagnostics.Process.Start(psi);
    string output = (prc.StandardError.ReadToEnd() + "\r\n" + prc.StandardOutput.ReadToEnd()).Trim();
    output = output.Substring(output.IndexOf(".com\r\n\r\n") + 8);

    prc.WaitForExit();

    if (!(output.Contains("started on") || output.Contains("killed on") || output.Contains("SERVICE_NAME"))) throw new Exception(output);
} 
```

示例调用：

```
 RunTask(new string[] { "MACHINE", "psexec", @"""C:\Program Files (x86)\Internet Explorer\iexplore.exe""" }, "USERNAME", "PASSWORD");
    RunTask(new string[] { "MACHINE", "pskill", @"""iexplore.exe""" }, "USERNAME", "PASSWORD");
    RunTask(new string[] { "MACHINE", "psservice", @"""start SOMESERVICE""" }, "USERNAME", "PASSWORD");
    RunTask(new string[] { "MACHINE", "psservice", @"""stop SOMESERVICE""" }, "USERNAME", "PASSWORD"); 
```

*   确保程序旁边有**psexec.exe**、**pskill.exe**和**psservice.exe**。

# click - Imacros：无法单击没有 href 属性的锚点

> ID：13663175
> 
> 赞同：0
> 
> 时间：2012-12-01T20:00:02.110
> 
> 标签：click, href, imacros

我正在使用 Imacros 单击此按钮：

```
<a id="button6685628" class="p-button" style="border: 2px solid rgb(0, 0, 255);">
<span>Submit</span></a> 
```

使用这个 Imacros 代码：

```
TAG POS=1 TYPE=A ATTR=ID:button6685628 
```

运行 Imacros 代码时，该按钮仅被选中但未单击，所以请，有人知道如何进行此单击吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T02:52:35.357

试试`TAG POS=1 TYPE=SPAN ATTR=TXT:Submit`。如果它不起作用，则可能是一个 javascript 事件触发按钮，如果您禁用 javascript，则脚本会单击它。

# c++ - push_back 一个结构体到一个结构体中的一个向量中

> ID：13663176
> 
> 赞同：1
> 
> 时间：2012-12-01T20:00:06.193
> 
> 标签：c++, vector, struct, push-back

我有以下结构：

```
enum messageType {New = 0, Old = 1, No_Message = 2};

typedef struct {
    enum messageType type;
    unsigned int senderID;
    char message[100];
} StoredMessageData;

struct StoredMessage {
    unsigned int recipientID;
    vector<StoredMessageData> messages;

    StoredMessage(const unsigned int& intRecipient = 0, const vector<StoredMessageData>& data = vector<StoredMessageData>())
    : recipientID(intRecipient), messages(data)
    {
        messages.reserve(10);
    }

    bool operator<(const StoredMessage& compareTo) const
    {
        return recipientID < compareTo.recipientID;
    }

    bool operator==(const StoredMessage& compareTo) const
    {
        return recipientID == compareTo.recipientID;
    }
}; 
```

在我的主要方法中，有时我会收到一条消息并希望像这样存储它：

```
if(msgs.find(rcvdRecipientID) == msgs.end())
{
    StoredMessage storedMsg;
    storedMsg.recipientID = rcvdRecipientID;
    msgs.insert(storedMsg);
}

set<StoredMessage>::iterator it = msgs.find(rcvdRecipientID);
StoredMessage storedMsg = *it;

StoredMessageData data;
data.type = New;
data.senderID = rcvdSenderID;
strcpy(data.message, rcvdMessage);

storedMsg.messages.push_back(data); 
```

如果在 push_back() 之后，我调用了 storedMsg.messages.size()，我得到的值为 1。这对我来说很有意义。

但是，后来，我想知道我存储了多少条消息，所以，这段代码：

```
StoredMessage storedMsg;
if(msgs.find(rcvdSenderID) != msgs.end())
{
    storedMsg = *(msgs.find(rcvdSenderID));
    cout << "Number of stored messages to send: " << int(storedMsg.messages.size()) << endl << endl;
    ... 
```

在这里，即使使用与以前相同的 ID，storedMsg.messages.size() 也会返回 0...我对为什么会发生这种情况感到困惑，并怀疑它与被复制的向量有关，因为它们的大小不同，但我'不确定。我不是 C++ 专家，所以请保持温和。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:23:07.400

可能它发生是因为这里

```
StoredMessage storedMsg = *it; 
```

您创建对象的副本并对副本进行所有修改。

# html - 位置：绝对，宽度：未知。如何使div居中

> ID：13663181
> 
> 赞同：0
> 
> 时间：2012-12-01T20:00:26.497
> 
> 标签：html, css

我需要将 div 与此页面上图像滑块上的点对齐： [https ://dharman.eu/sites/daftpunk/](https://dharman.eu/sites/daftpunk/)

我已经在 SO 上搜索了一种方法，我发现了这个线程： [Position center of div tag, which width is unknown advanced](https://stackoverflow.com/questions/13580678/position-center-of-div-tag-which-width-is-unknown-advanced)

我应用了那里给出的解决方案，但结果并不像我预期的那样。div 看起来比它应该的更靠右一点。

谁能告诉我这里可能是什么问题？

编辑：这发生在 FF 中，在 Chrome 中，div 一直向右。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:14:45.220

试试这个CSS `#sliderDots`：

```
#sliderDots {
    position: relative;
    bottom: 40px;
    display: inline-block;
    background-color: whiteSmoke;
    border-radius: 15px;
    box-shadow: 0 0 10px 3px, 0 0 10px 0 #888 inset;
    padding: 10px 10px 10px 20px;
} 
```

在 IE、FF 和 Chrome 中工作正常（位置更改为`relative`，底部更改为`40px`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:18:12.450

```
<center style="width:750px;height:20px">
    <div id="sliderDots">
        <ul>
            <li class="activeDot"></li>
            <li class=""></li>
            <li class=""></li>
            <li class=""></li>
            <li class=""></li>
            <li class=""></li>
            <li class="">
            </li></ul>
    </div>
</center> 
```

**为什么 750px 居中？**

因为您的“内容”类的宽度为 800 像素，而右填充 + 左填充为 50 像素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:18:43.307

您还可以将 div 放在另一个容器 div 中，该容器 div 绝对定位并位于同一空间中，但随后将 sliderDots div 与 margin: auto 相对。

# recursion - 为什么这些阶乘函数的速度差异如此之大？

> ID：13663182
> 
> 赞同：0
> 
> 时间：2012-12-01T20:00:57.800
> 
> 标签：recursion, python-2.7, factorial, divide-and-conquer

所以我最近对快速计算阶乘产生了兴趣，我写了一个，并从互联网上找了一些其他的来测试。这是代码（Python 2.7）：

```
def prime_sieve(n):
    """A prime sieve, takes an int n, and returns all the primes < n"""
    odds = range(3,n+1,2) #make a list of odd numbers starting at 3
    i = 0 #an index counter
    sqrt_n = int(n**0.5) #upper limit for sieving is isqrt(n)
    d = len(odds) #the length of the list
    while odds[i]<=sqrt_n:
        if odds[i]: #odds[i]!=0
            step = odds[i] #the ith odd which is nonzero is the next prime
            start = (i+1)*step + i #this is the location of odds[i]^2
            while start<d: #zero out stepth odd from start.
                odds[start]=0
                start+=step
        i+=1
    return [2]+filter(None, odds) #return a list of primes

#This one I wrote, and the stuff above
def factorial(n):
    """A factorial function which computes n! using it's prime factors"""
    factors = [[i, 0] for i in prime_sieve(n)] #a list holding factor-exp pairs
    for i in xrange(len(factors)): #find the exponents
        m=float(n)
        while factors[i][0]<m:
            m/=factors[i][0]
            factors[i][1]+=int(m)
    result = 1 << factors[0][1] #start off by shifting result, instead of x 2^m
    for i in factors[1:]: #multiply result by every prime factor^exp
        result*=i[0]**i[1]
    return result

#the next two are the obvious ones
def naive_factorial(n):
    """Calculates n! with a simple while loop"""
    result = n
    while (n-1)>1: #n! = n*(n-1)*(n-2)...*2*1
        result*=(n-1)
        n-=1
    return result

def recursive_fact(n):
    """Calculates n! recursively"""
    if n<=1: return 1 #n! = n*(n-1)!
    return n*recursive_fact(n-1)

def factorial2(n):
    """Another factorial claiming to be fast, pulled from the internet
       I have no idea how this works"""
    result = 1
    buf = 1
    power2 = 0
    stack = []

    while n > 1:
        stack.append(n)
        n /= 2
        power2 += n

    for n1 in stack[::-1]:
        while n <= n1:
            buf *= n 
            n += 2
        result *= buf

    result <<= power2
    return result

def multiply_range(n, m):
    if n == m:
        return n
    if m < n:
        return 1
    else:
        return multiply_range(n, (n+m)/2) * multiply_range((n+m)/2+1, m)

def factorial3(n):
    """"Also from the internet, the logic seems reasonable, 'divide and conquer'. """
    return multiply_range(1, n)

if __name__=="__main__":
    import math
    import cProfile
    print "Calculating 70000! using naive_factorial."
    cProfile.run("naive_factorial(70000)")
    print "\nCalculating 70000! using math.factorial."
    cProfile.run("math.factorial(70000)")
    print "\nCalculating 70000! using factorial."
    cProfile.run("factorial(70000)")
    print "\nCalculating 70000! using factorial2."
    cProfile.run("factorial2(70000)")
    print "\nCalculating 70000! using factorial3."
    cProfile.run("factorial3(70000)") 
```

我对python并不陌生，我已经将它作为我的主要语言使用了几年，但结果有点出乎意料......

```
Calculating 70000! using naive_factorial.
         3 function calls in 19.842 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   19.842   19.842 <string>:1(<module>)
        1   19.842   19.842   19.842   19.842 factorial.py:30(naive_factorial)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

Calculating 70000! using math.factorial.
         3 function calls in 22.372 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   22.372   22.372 <string>:1(<module>)
        1   22.372   22.372   22.372   22.372 {math.factorial}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

Calculating 70000! using factorial.
         8 function calls in 9.092 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.003    0.003    9.092    9.092 <string>:1(<module>)
        1    0.020    0.020    0.024    0.024 factorial.py:1(prime_sieve)
        1    9.066    9.066    9.090    9.090 factorial.py:17(factorial)
        1    0.002    0.002    0.002    0.002 {filter}
        2    0.000    0.000    0.000    0.000 {len}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.002    0.002    0.002    0.002 {range}

Calculating 70000! using factorial2.
         19 function calls in 5.791 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    5.791    5.791 <string>:1(<module>)
        1    5.791    5.791    5.791    5.791 factorial.py:43(factorial2)
       16    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}

Calculating 70000! using factorial3.
         140002 function calls (4 primitive calls) in 1.147 seconds

   Ordered by: standard name

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    1.147    1.147 <string>:1(<module>)
 139999/1    1.147    0.000    1.147    1.147 factorial.py:65(multiply_range)
        1    0.000    0.000    1.147    1.147 factorial.py:73(factorial3)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects} 
```

我的问题是，最后一个怎么能快得多？！看看所有的递归！我以为 Python 不喜欢递归！那么为什么速度这么快呢？阶乘2如何工作？另外，大家都知道，我检查了这些都为几个不同的值产生了正确的输出，所以我很确定这些都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T12:46:03.013

简短回答“如何`factorial2()`工作：它会挑选出所有奇数，同时只*计算*结果必须乘以 2 的次数（变量`power2`，仅将奇数相乘，最后一步）将结果的二进制表示左移（实际上是乘以`2**power2`）。

至于“为什么这么快”，我不清楚你是否正确解释了你的结果：这个数字`140002 function calls`似乎包括`multiply_range()`. 它仍然很快（我`factorial2`在 5 次运行中得到 1.6 秒和 4.4 秒`n=70000`），但并没有那么离谱。

# c++ - c++ 模糊双非虚函数继承

> ID：13663184
> 
> 赞同：2
> 
> 时间：2012-12-01T20:01:07.773
> 
> 标签：c++, inheritance

假设我有 2 个课程：

```
struct a
{
    void test();
};

struct b
{
    void test();
}; 
```

现在让我们从这些类继承：

```
class c : public a, public b
{
}; 
```

调用`c::test()`会产生错误，因为`class a`和`class b`具有相同的功能`void test()`，现在我的问题：

是否可以继承那些（非虚拟！）函数，并且何时`c::test()`调用两者都被执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:03:51.560

为此，您需要实现`void test()`in`c`并调用这两个方法。没有自动的方法可以做到这一点。

```
class c : public a, public b
{
public:
    void test() {
        a::test();
        b::test();
    }
} 
```

但是，我强烈建议您不要在派生类中重新实现非虚函数。问题是下面会悄悄地调用不同的函数，即使它们在同一个对象上操作：

```
 c* p1 = new c();
   a* p2 = p1;
   p1->test();
   p2->test(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:08:23.187

你的前提是错误的；继承自`a`并且`b`不是错误。尝试调用`c::test()`是一个错误，因为它的分辨率不明确。但是，您可以随意覆盖`test()`in `c`，例如通过显式调用`this->a::test();`and `this->b::test();`in `void c::test();`。

# jquery - Jquery popUp menu with mouseenter 然后绑定 mouseleave fadeOut 延迟

> ID：13663186
> 
> 赞同：1
> 
> 时间：2012-12-01T20:01:12.137
> 
> 标签：jquery, bind

我有一些`DIV`通过单击另一个 DIV 触发元素淡入。我想不出一个脚本来：

*   在鼠标离开时 -以一些延迟（例如 500 毫秒）**淡出**`DIV`，但如果在 500 毫秒执行之前再次将鼠标悬停在其上 - 以某种方式重新获得元素可见性。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:06:42.990

这应该为你做！

这是关于 JS Fiddle 的演示：http: [//jsfiddle.net/bCCnB/](http://jsfiddle.net/bCCnB/)

```
$('#divid').mouseout(function() {
    var timeout = window.setTimeout(function() {
        $(this).hide();
    }.bind(this), 500);
    $(this).data('timeout', timeout);
});

$('#divid').mouseover(function() {
    var timeout = $(this).data('timeout');
    if (timeout) {
        window.clearInterval(timeout);
        $(this).data('timeout', null);
    }
}); 
```

# android - 是否可以在 Android 或 ios 中更改 gmail 同步间隔？

> ID：13663191
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:01:32.563
> 
> 标签：android, gmail

是否可以在 Android 或 ios 中更改 gmail 同步间隔？我可以通过操作系统或 gmail 应用程序提供的任何文件系统更改它吗？

我可以在系统设置中的ios中做到这一点。但是有没有一种编程方式？任何API？

我在 android 中发现，有一个 android.content.PeriodicSync 类。那有用吗？

谢谢，</p>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:30:22.103

我敢肯定，如果您将手机植根，请为其提供可编辑的自定义 ROM，您可以更改手机的各个方面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T23:29:01.447

在 iOS 上绝对没有办法以编程方式执行此操作——第三方应用程序甚至无法访问邮件帐户，更不用说它们的同步设置了。

# objective-c - alloc init 内部方法

> ID：13663197
> 
> 赞同：0
> 
> 时间：2012-12-01T20:02:19.067
> 
> 标签：objective-c, ios

我在同一个应用程序中有两种方法

第一个是分数类

```
 -(Fraction *) divide: (Fraction *) f
 {
 Fraction *result = [[Fraction alloc] init];
 result.numerator = numerator * f.denominator
 [result reduce];
 return result;
 } 
```

第二个是在计算器类

```
-(Fraction *) performOperation: (char) op
   {
 Fraction *result;
 switch (op) {
 case '+':
 result = [operand1 add: operand2];
 break;
 .
 .
 .
 .
 etc

break;
}
accumulator.numerator = result.numerator;
accumulator.denominator = result.denominator;
return accumulator;
} 
```

为什么第一个需要在第一个方法中分配和初始化 *result 实例变量而不是第二个？是因为它调用了另一个方法 [result reduce] 还是因为它返回了一个值？或者是其他东西？第二种方法似乎只是简单地实例化 Fraction 类型的临时变量结果，而无需初始化或创建内存。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:13:16.750

你的困惑源于对正在发生的事情的一种不准确的思考方式。如果你这样想会更清楚：

您所做的不是“分配初始化结果变量”，而是“分配初始化分数对象，然后将其地址分配给结果变量”。

对象的创建与将其地址分配给变量是分开的，并且对象与变量不同，变量只是引用它。

因此，在第二种情况下，您不需要分配 init 分数，因为您没有尝试创建新的空分数，而是从其他地方获取指向分数的指针（本例中的 -add 方法）并使用它。

此外，您的 -divide 方法看起来也不正确。你永远不会在你的新分数上设置分母。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:15:30.447

您已经在方法中`alloc`吃掉并`init`ialize 对象并返回指向它的指针。然后将此指针分配给一个局部变量——您不需要为它分配更多内存。

另外，如果您不使用 ARC，请不要忘记在您的`autorelease`方法中，或者在使用它后的方法中。否则你的应用程序会泄漏内存。`result``-divide``release``-performOperation`

# php - PHP mb_internal_encoding()

> ID：13663202
> 
> 赞同：1
> 
> 时间：2012-12-01T20:02:45.837
> 
> 标签：php, encoding, character-encoding

在[mb_internal_encoding()](http://php.net/manual/en/function.mb-internal-encoding.php)的 PHP 文档中，它说：

> encoding 是用于**HTTP 输入字符编码转换**、**HTTP 输出字符编码转换**的字符编码名称，以及 mbstring 模块定义的字符串函数的默认字符编码。

我的假设是 PHP 获取二进制数据也对其进行操作，输出二进制数据，由用户代理通过内容的指定字符集进行解释。

HTTP 输入/输出字符转换是什么意思？PHP 如何知道 HTTP 输入编码以将其转换为另一种编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T12:47:39.013

默认情况下，您是正确的。但是`mb_string`可以将扩展配置为挂钩到 php 的 http 输入和 http 输出，并在需要时执行自动转换。

默认情况下，配置值为：

```
mbstring.encoding_translation   "0"
mbstring.http_input = pass
mbstring.http_output = pass 
```

有关更多信息，请参阅[文档](http://php.net/manual/en/mbstring.configuration.php)。

# ios - 在 iOS 中更新资源的简单方法（无需编译）

> ID：13663208
> 
> 赞同：0
> 
> 时间：2012-12-01T20:03:20.100
> 
> 标签：ios, resources

我想知道是否有任何方法可以改善 iOS 中程序员和设计师的工作流程，而无需重新考虑源代码控制或代码。

目前我有一个设计师和我一起工作，他对代码和源代码控制感到不舒服。然后，每次他想在应用程序中间看到一个资源时，我都必须重新编译。

我可以使用 web 服务，并且只获取每次应用程序启动时更改的资源。但是，我觉得如果他用 10-20 兆更改大约 10 个视频（例如新的压缩测试），这个解决方案可能会令人沮丧。

在 Windows 8 中，我可以使用库文件夹中的资源创建一个文件夹，他可以访问它并替换资源。然后，应用程序可以从该文件夹加载所有资源。但是我可以在 iOS 中做什么？没有 sd 卡（或外部硬盘驱动器），我想我不能将资源放在一个文件夹中并将它们加载到应用程序中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T10:22:06.453

对我来说，我将通过添加`UIFileSharingEnabled`到 Info.plist使我的应用程序在 iTunes 文件共享中可用

然后我用自定义方法包装我对加载资源的调用，例如：

```
- (NSString *)pathForImage:(NSString *)imageName
{
    // Somewhere like this:
    // /var/mobile/Applications/01234567-89AB-CDEF-0123-456789ABCDEF/Documents/images/
    NSString *imagesPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
    imagesPath = [imagesPath stringByAppendingPathComponent:@"images"];

    NSString *path = [imagesPath stringByAppendingPathComponent:imageName];

    if ([[NSFileManager defaultManager] fileExistsAtPath:path])
    {
        return path;
    }
    else
    {
        NSString *fileName = [imageName stringByDeletingPathExtension];
        NSString *fileExt = [imageName pathExtension];
        return [[NSBundle mainBundle] pathForResource:fileName ofType:fileExt];
    }
} 
```

并更改我的图像加载代码

```
[UIImage imageNamed:@"foo.png"]; 
```

到

```
[UIImage imageWithContentsOfFile:[self pathForImage:@"foo.png"]]; 
```

下次当设计师想要更新资源时，他/她可以打开 iTunes 并将新文件拖放到您的应用程序中。 ![iTunes 文件共享](../Images/e3d44d25545243745f1f38e6e419166d.png) 有关 iTunes 文件共享的更多信息，请查看[Apple 的文档](http://developer.apple.com/library/ios/documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW20)。

**更新**`UIFileSharingEnabled`：如果您的应用程序不为最终用户使用 iTunes 文件共享，请记住通过在 Info.plist 中删除来关闭它！否则 Apple 可能会因为您启用了未使用的功能而拒绝您的应用程序，这可能会使用户感到困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:26:38.433

在它工作的模拟器中，在设备上，交换资源会破坏代码签名...当然您也可以更改应用程序，以便从应用程序库文件夹中加载图像...他想通过 ssh 连接到 iPhone 左右？

*我*会给他安装 xcode 和模拟器（实际上我让我们的设计师使用 xcode，他们可以构建应用程序！）

# tfs - Upgrade file in TFS Source control

> ID：13663210
> 
> 赞同：1
> 
> 时间：2012-12-01T20:03:33.870
> 
> 标签：tfs

I need to upgrade some 3rd party library binaries in my project. So I want to remove SomeLibrary folder and then insert SomeLibrary with other content (or clear SomeLibrary content and then insert upgraded content).

Currently I have to make 2 check-ins for that: one for remove and one for add. If I remove and then try to add immediately I get an error telling this element already has pending changes.

Is there any way to do that by 1 check-in?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T21:37:41.337

Why do you need to change folders?

For example, if you have your binaries in e `lib` folder, simply check out the folder, overwrite the upgraded binaries, add any new ones, remove anything that's no longer needed, then check it all in at once.

# php - Ajax 如何在不重新加载的情况下发送表单

> ID：13663214
> 
> 赞同：0
> 
> 时间：2012-12-01T20:03:48.707
> 
> 标签：php, html, ajax

我在我的网站上的当前代码如下，我将很快将该代码转移到我的 profile.php 中:)

测试.php

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/
libs/jquery/1.3.0/jquery.min.js">
</script>
<script type="text/javascript" >
$(function() {
$("#ntb").click(function() {
var nt = $("#nt").val();
var data=$('#nt').serialize();
if(nt=='')
{
$('.success').fadeOut(200).hide();
$('.error').fadeOut(200).show();
}
else
{
$.ajax({
type: "POST",
url: "../ajax/post.php",
data: dataString,
success: function(){
$('.success').fadeIn(200).show();
$('.error').fadeOut(200).hide();
}
});
}
return false;
});
});

</script>

<form method="post" name="form">
<input id="nt" name="nt" type="text" />
<input type="submit" style="display:block;" name='ntb' id='ntb'  class="Buttonchat"     value="Post" />
</form>
<div>
<span class="error" style="display:none"> Please Enter Valid Data</span>
<span class="success" style="display:none"> Registration Successfully</span>
</div></form&gt; 
```

上面的代码是 ajax 和 html，当我有 ajax 时并不能真正工作，但是当我只有 html 和 php 时，它会发布到数据库中，我知道为什么 :(

../ajax/post.php

```
<?php

include '../core/init.php';

if(isset($_POST['nt']) && isset($_POST['ntb'])){
mysql_query("INSERT INTO `post` (`myid`, `text`) VALUES ('".$_SESSION['id']."',         '".mysql_real_escape_string($_POST['nt'])."')");
}
?> 
```

以上是我发布数据的 php，这 100% 有效 :) 谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:07:41.273

我这样做：

```
function submitMe(val) {
    jQuery(function($) {    
        $.ajax( {           
            url : "some_php_page.php?action="+val,
            type : "GET",
            success : function(data) {
                alert ("works!"); //or use data string to show something else
                }
            });
        });
    } 
```

`action`然后我只是解析`some_php_page.php?`

这样做：

```
//function that get value from the request object and parses it to a variable; or stopps the script if no value is found
function getanyValue($param) {
    if (isset($_GET[$param])) {
        return $_GET[$param];
    } else {
        die('');
    }
}
//get the action value
$action = getanyValue('action');
//add action to the database
$inserId = addAction($action);

public $dbserver = '';
public $dbusername = '';
public $dbpassword = '';
public $dbname = '';

function openDb() {
    try {
        $db = new PDO('mysql:host=' . $this->dbserver . ';dbname=' . $this->dbname . ';charset=utf8', '' . $this->dbusername . '', '' . $this->dbpassword . '');
    } catch (PDOException $e) {
        die("error, please try again");
    }
    return $db;
}

function addAction($action) {
    $query = "INSERT INTO action_table (action_column) VALUES(?)";
    $db = $this->openDb();
    $stmt = $db->prepare($query);
    $stmt->bindValue(1, $action, PDO::PARAM_STR);
    $stmt->execute();
    //get the action_table id from the database from the new insert
    return $db->lastInsertId('id');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:08:56.297

您不一定需要 AJAX 来提交表单而无需重新加载。一个方便的技巧是简单地提交到隐藏的 iframe：

```
<iframe style="display:none" name="submissiontarget" id="submissiontarget"></iframe>

<form method="post" target="submissiontarget" action = "../ajax/post.php" name="form">
<input id="nt" name="nt" type="text" />
<input type="submit" style="display:block;" name='ntb' id='ntb'  class="Buttonchat"     value="Post" />
</form>
<div>
<span class="error" style="display:none"> Please Enter Valid Data</span>
<span class="success" style="display:none"> Registration Successfully</span>
</div>
</form> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T20:10:34.160

问题是您将“dataString”传递给 PHP 脚本。我所看到的“dataString”没有在任何地方定义。

所以你要做的是：

```
var dataString = 'nt=' + data + '&ntb=whateverntbshouldbeequalto'; 
```

这应该够了吧！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-01T20:11:24.377

首先，我会尝试打印出您的`$_POST`内容以查看正在发送的内容。看来您的数据格式不正确。您正在测试您的 php 中的两个单独的变量，但似乎您试图`data`在 ajax 帖子的您的部分中只发送一个。

# scala - 检查 Scala 宏中的可变参数类型归属

> ID：13663216
> 
> 赞同：9
> 
> 时间：2012-12-01T20:03:55.460
> 
> 标签：scala, macros, variadic-functions, scala-2.10, scala-macros

假设我有这个宏：

```
import language.experimental.macros
import scala.reflect.macros.Context

object FooExample {
  def foo[A](xs: A*): Int = macro foo_impl[A]
  def foo_impl[A](c: Context)(xs: c.Expr[A]*) = c.literal(xs.size)
} 
```

这适用于“真实”可变参数：

```
scala> FooExample.foo(1, 2, 3)
res0: Int = 3 
```

但是归于可变参数类型的序列的行为让我感到困惑（在 Scala 2.10.0-RC3 中）：

```
scala> FooExample.foo(List(1, 2, 3): _*)
res1: Int = 1 
```

并表明推断类型没有任何可疑之处：

```
scala> FooExample.foo[Int](List(1, 2, 3): _*)
res2: Int = 1 
```

我本来预计会出现编译时错误，这就是我想要的。我在编写的大多数宏中都使用了以下方法：

```
object BarExample {
  def bar(xs: Int*): Int = macro bar_impl
  def bar_impl(c: Context)(xs: c.Expr[Int]*) = {
    import c.universe._
    c.literal(
      xs.map(_.tree).headOption map {
        case Literal(Constant(x: Int)) => x
        case _ => c.abort(c.enclosingPosition, "bar wants literal arguments!")
      } getOrElse c.abort(c.enclosingPosition, "bar wants arguments!")
    )
  }
} 
```

这在编译时解决了问题：

```
scala> BarExample.bar(3, 2, 1)
res3: Int = 3

scala> BarExample.bar(List(3, 2, 1): _*)
<console>:8: error: bar wants literal arguments!
              BarExample.bar(List(3, 2, 1): _*) 
```

不过，这对我来说就像是一种 hack——它混合了一种验证（检查参数是否为文字）和另一种验证（确认我们确实有可变参数）。我还可以想象我不需要参数是文字的情况（或者我希望它们的类型是通用的）。

我知道我可以做到以下几点：

```
object BazExample {
  def baz[A](xs: A*): Int = macro baz_impl[A]
  def baz_impl[A](c: Context)(xs: c.Expr[A]*) = {
    import c.universe._

    xs.toList.map(_.tree) match {
      case Typed(_, Ident(tpnme.WILDCARD_STAR)) :: Nil =>
        c.abort(c.enclosingPosition, "baz wants real varargs!")
      case _ => c.literal(xs.size)
    }
  }
} 
```

但这是处理非常简单（我认为这是广泛必要的）参数验证的一种丑陋方式。我在这里缺少一个技巧吗？我可以确保`foo(1 :: Nil: _*)`在我的第一个示例中给出编译时错误的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:45:16.787

这是否按预期工作？

```
object BarExample {
  def bar(xs: Int*): Int = macro bar_impl
  def bar_impl(c: Context)(xs: c.Expr[Int]*) = { 
    import c.universe._
    import scala.collection.immutable.Stack
    Stack[Tree](xs map (_.tree): _*) match { 
      case Stack(Literal(Constant(x: Int)), _*) => c.literal(x)
      case _ => c.abort(c.enclosingPosition, "bar wants integer constant arguments!")
    }
  }
} 
```

# android - 过滤扩展 LIst Activity 的 LIstview

> ID：13663219
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:04:21.640
> 
> 标签：android, listview, filter

我一直在阅读一些有关过滤列表视图的主题，但我感到困惑，因为我对适配器和不同种类的适配器知之甚少。我找到了一个与我的问题几乎相似的解决方案。这是Zoleas发布的代码

```
TextWatcher filterTextWatcher = new TextWatcher() {

        public void afterTextChanged(Editable s) {
        }

        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }

        public void onTextChanged(CharSequence s, int start, int before, int count) {
            _myAdapter.getFilter().filter(s);
        }
    };
    _filterText = (EditText) findViewById(R.id.search_box);
    _filterText.addTextChangedListener(filterTextWatcher); 
```

我对如何在 Ontextchanged 方法中声明我的适配器感到困惑，因为我的适配器看起来像这样。

```
setListAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, result)); 
```

需要有关如何实现过滤器的帮助是我的列表视图上的完整代码。

```
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.firstaid);
    filterText = (EditText) findViewById(R.id.acET);
        DbHelper tblFa = new DbHelper(this);
    tblFa.open();
    ArrayList<String> result = tblFa.getFAData();
    result = tblFa.getFAData();
    setListAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, result));
    ListView lv = getListView();
    lv.setTextFilterEnabled(true);
    tblFa.close();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:09:18.883

您只需要创建另一个字段变量，就像`filterText`：

```
ArrayAdapter<String> _myAdapter; 
```

并像这样使用它`onCreate()`：

```
_myAdapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, result);
setListAdapter(_myAdapter); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:25:15.297

试试看；

```
EditText edt = (EditText) this.view.findViewById(R.id.editTxtView);

        edt.addTextChangedListener(new TextWatcher() {
        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before, int count) {
             ListView listView = (ListView) view.findViewById(R.id.yourListviewID);

                YourAdapterOrWhateverAdapter adapter = (YourAdapterOrWhateverAdapter) listView.getAdapter();  

               adapter.getFilter().filter(s);

        @Override
        public void afterTextChanged(Editable s) {

        } 
```

# iphone - NSMutableString + 网络服务

> ID：13663223
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:04:54.023
> 
> 标签：iphone, objective-c

我正在尝试使用 Web 服务，但是当元素名称更改时，更改所有其他...

```
-(void)callWebService {
    _estacionamentoAdd = [[Estacionamento alloc]init];
    NSString *url = @"http://urlfromws";
    NSMutableURLRequest *request =[[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:url]];
    [request setHTTPMethod:@"GET"];

    NSURLConnection *conn=[[NSURLConnection alloc] initWithRequest:request delegate:self];
    if (conn) {
        webData = [[NSMutableData data] retain];
    }
    else
    {

    }
} 
```

//什么时候得到response的值

```
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    if(!soapResults)
    {
        soapResults = [[NSMutableString alloc] init];
    }
    NSLog(@"stringFound:%@", string);
    [soapResults setString:string];
} 
```

//收到响应时

```
 - (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName        namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
 {
     if(!soapResults)
    {
        soapResults = [[NSMutableString alloc] init];
  }

if( [elementName isEqualToString:@"id"])
{
 id = [soapResults intValue];
}
else if( [elementName isEqualToString:@"name"])
{
    name = soapResults;
}
else if( [elementName isEqualToString:@"adress"])
{
    adress = soapResults;

 }
[soapResults setString:@""];

    } 
```

当元素名称为“名称或地址”时，id 和名称等于地址

当 elementName 是 id...id = soapResults。好的，但是当 elementName 是 Adress 时，adress=soapResults 并且 id 也会改变。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:34:09.563

好吧，我只看到名称和地址将始终为 @"" 并且相同。

例如

```
...
name = soapResults; //NOT copied.. name and soapResults are the same object
... 
[soapResults setString:@""]; //affects name too, as they are the same 
```

地址相同，但 id 不同，因为那是整数，而不是对象

*   名称 = 地址 = 肥皂结果...

您可能想要复制该值

```
name = [soapResults description];
...
address = [soapResults description]; 
```

* * *

其他问题：
不要在 foundCharacters 中使用 [soapResults setString:newString]，使用 appendString（foundCharacters 被调用 n 次）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T11:18:18.670

我解决了我的问题：

//总是释放 NSMutableString

```
-(void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
if(soapResults) {
    [soapResults release];
    soapResults = nil;
}

    soapResults = [[NSMutableString alloc] init];

NSLog(@"stringFound:%@", string);
[soapResults appendString:string]; 
```

}

# python - Python 导入：模块的路径不同，取决于它是从哪里导入的？

> ID：13663227
> 
> 赞同：1
> 
> 时间：2012-12-01T20:05:06.117
> 
> 标签：python, import, module

标题可能很难理解，但我会尽力解释。

我有一个名为的文件夹`SubModule`，其中包含总共 3 个文件：

```
__init__.py
Class1.py
Class2.py 
```

在里面`__init__.py`，我得到了这个：

```
import Class1
import Class2

def main():
    c1 = Class1.Class1()
    c2 = Class2.Class2()

if __name__ == "__main__":
    main() 
```

一切正常，没有错误，我可以正确使用 c1 和 c2。

* * *

当我尝试将文件夹移动`SubModule`到其他模块的（我们称之为`MainModule`）文件夹下时，就会出现问题。所以我会有以下内容：

```
MainModule\__init__.py
MainModule\SubModule\__init__.py
MainModule\SubModule\Class1.py
MainModule\SubModule\Class2.py 
```

现在，当我尝试像这样导入`SubModule`时`MainModule\__init__.py`：

```
import SubModule
c1 = SubModule.ClassOne.ClassOne()
c2 = SubModule.ClassTwo.ClassTwo() 
```

我希望这能奏效。但是，运行`MainModule\__init__.py`会引发错误 `SubModule\__init__.py`：

```
Traceback (most recent call last):
  File "C:\...\MainModule\__init__.py", line 1, in <module>
    import SubModule
  File "C:\...\MainModule\SubModule\__init__.py", line 1, in <module>
    import Class1
ImportError: No module named 'Class1' 
```

如您所见，错误来自`import Class1`，它告诉我有`No module named 'Class1'`. 这是因为现在的路径`SubModule.Class1`，而不是唯一的`Class1`。我可以通过更改为这个来摆脱这个错误`SubModule\__init__.py`：

```
import SubModule.Class1
import SubModule.Class2 
```

但是，我不能再`SubModule`通过运行来单独使用`SubModule\__init__.py`，因为路径将`import Class1`再次出现，而不是`import SubModule.Class1`.

这让我抓狂，有没有办法概括导入，所以哪个模块导入 SubModule 并不重要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:25:10.267

有一种方法，不完全是“一般”，但是......

```
try:
    import Submodule.Class1 as Class1
except ImportError:
    import Class1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:53:11.270

您应该始终从系统路径绝对导入模块。所以如果你的包 MainModule 包含一个子包 SubModule，你应该做`from MainModule import SubModule`（或`from . import SubModule`）。此外，在 SubModule 中，执行`from . import Class1`. 无论路径如何，这都应该让它工作`SubModule`。（但是，如果您`SubModule`以两种不同的方式导入它仍然会导致奇怪 - 包括将其作为主文件运行与导入它。）

# php - 使用 htaccess 在 URL 前添加

> ID：13663228
> 
> 赞同：1
> 
> 时间：2012-12-01T20:05:16.107
> 
> 标签：php, .htaccess, url-rewriting

抱歉，如果有人问过这个问题，或者我不确定标题是否正确，但我刚刚开始使用 htaccess 文件，我有点迷茫。基本上我想要做的是在 URL 前面加上“index.php”。例如，如果用户输入：

[http://www.example.com/show/12](http://www.example.com/show/12)

我希望 htaccess 文件创建 URL：

[http://www.example.com/index.php/show/12](http://www.example.com/index.php/show/12)

如果这不可能，有没有办法总是去 index.php 前端控制器并将“show/ *number* ”添加到 URL 中，以便前端控制器可以将参数传递给另一个控制器？

我的 htaccess 代码如下：

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ index.php 
```

我需要它假设所有 URL 请求都将发送到 index.php 前端控制器，然后将 URL 的其余部分传递给前端控制器。

我不断收到的错误是：

```
The requested URL /testing-mod-rewrite/show/12 was not found on this server. 
```

如果有帮助，这是我的前端控制器的 PHP 代码：

```
include_once('controllers/baseController.php');
$uri = $_SERVER['REQUEST_URI'];
$urifinal = str_replace($uri , '/', $uri);

$request = explode('/', $_SERVER['REQUEST_URI']);
$controller = new BaseController();
$controller->index_action($request); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T23:28:36.767

编辑：实际上，我不完全确定你想要什么。在您的问题中，您说如果没有它，您想将 index.php 添加到 url。在您的问题下的评论中，您说您想从 URL 中删除它。前者很可能会更容易使用 PHP。后者应通过以下方式完成：

* * *

您可以将信息传递给查询字符串。

```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?view=$1 [L] 
```

所以输入的 URL 可能是：example.com/view/test/foo，重写的（内部）URL 是 example.com/index.php?view=test/foo

现在在 PHP 中你应该能够做到：

```
$view = $_GET['view'];
$controller = new BaseController();
$controller->index_action(explode('/', $view)); 
```

请注意，您应该在某个时候验证 $view 中包含的输入。

编辑：另外，我不明白这一行：

```
$urifinal = str_replace($uri , '/', $uri); 
```

这似乎是一种过于复杂的说法：

```
$urifinal = '/'; 
```

除非我完全错过了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:14:18.107

**更新：**

下面是一个重定向输入 URL 的示例：

`http://www.example.com/show/12`到这个网址：

`http://www.example.com/index.php?show=12`

```
RewriteEngine on
RewriteRule ^(show)/([0-9]+)/?$ http://www.example.com/index.php?$1=$2 [L] 
```

我知道这不完全是问题的答案，但是要使您的问题按原样工作，您需要创建一个具有该名称的子目录，`index.php`我认为这是不可能的。

如果目录存在，则使用任何其他名称（例如 new_dir）规则将如下所示：

```
RewriteEngine on
RewriteRule ^(show)/([0-9]+)/?$ http://www.example.com/new_dir/$1/$2 [L] 
```

最后一行将重定向到：

`http://www.example.com/new_dir/show/12`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:15:36.953

Visit this link [http://www.askapache.com/htaccess/redirect-index-blog-root.html](http://www.askapache.com/htaccess/redirect-index-blog-root.html)

Or if you own a wordpress site ,it is bit easy. You need to install any of these plugins in your external\local site and follow the instructions in links to work.

1.) [http://wordpress.org/extend/plugins/redirection/](http://wordpress.org/extend/plugins/redirection/)

2.) [http://wordpress.org/extend/plugins/quick-pagepost-redirect-plugin/](http://wordpress.org/extend/plugins/quick-pagepost-redirect-plugin/)

3.) [http://www.dailyblogtips.com/gocodes-url-redirection-plugin-for-wordpress/](http://www.dailyblogtips.com/gocodes-url-redirection-plugin-for-wordpress/)

4.) [http://pathanruet.wordpress.com/2011/04/23/wordpress-plugin-url-redirection/](http://pathanruet.wordpress.com/2011/04/23/wordpress-plugin-url-redirection/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T02:40:07.177

好吧，看起来我的 htaccess 代码很好，我需要做的就是禁用 MultiViews。

```
<Directory /var/www/>
    Options Indexes MultiViews + FollowSymLinks
    AllowOverride All
    Order allow,deny
    allow from all
</Directory> 
```

# ios - iOS：在屏幕上添加具有固定位置的子视图

> ID：13663230
> 
> 赞同：4
> 
> 时间：2012-12-01T20:05:19.847
> 
> 标签：ios, xcode, uiview, position

如何修复屏幕上的子视图位置（尤其是在 UIScrollView 和 UITableView 中）？我认为在故事板中

```
[self.view addSubview:aSubView]; 
```

不再工作了。

有任何想法吗？

**编辑#1**：我使用的是 UITableViewController，而不是简单的 UITableView。

**编辑#2**：

```
CGRect fixedFrame = self.menuViewRelative.frame;
fixedFrame.origin.y = 0 + scrollView.contentOffset.y;
self.menuViewRelative.frame = fixedFrame;

menuViewRelative = [[UIView alloc] init];
menuViewRelative.backgroundColor = [UIColor grayColor];
menuViewRelative.frame = CGRectMake(0.0, 0.0, 320.0, 50.0);

[self.view addSubview:self.menuViewRelative]; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-02T18:14:10.833

正如其他人所指出的，如果您不使用 a ，这会更容易一些`UITableViewController`，但无论如何也没那么难。

`UITableView`是 的子类`UIScrollView`，因此表视图的委托（`UITableViewController`在本例中为您的实例）也将接收`UIScrollViewDelegate`方法调用。您所要做的就是实现每次滚动偏移更改时调用的方法并调整“固定”视图的框架。

像这样的东西：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    CGRect fixedFrame = self.fixedView.frame;
    fixedFrame.origin.y = 20 + scrollView.contentOffset.y;
    self.fixedView.frame = fixedFrame;
} 
```

将 20 替换为您希望它距表格视图顶部的点数。您仍然添加`self.fixedView`为 的子视图`self.view`，这将确保它看起来像在表格视图上方的固定位置。

* * *

**编辑：**使用您发布的代码，我猜您的版本应该如下所示：

```
- (void)viewDidLoad {
    menuViewRelative = [[UIView alloc] init];
    menuViewRelative.backgroundColor = [UIColor grayColor];
    menuViewRelative.frame = CGRectMake(0.0, 0.0, 320.0, 50.0);

    [self.view addSubview:self.menuViewRelative];
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView
    CGRect fixedFrame = self.menuViewRelative.frame;
    fixedFrame.origin.y = 0 + scrollView.contentOffset.y;
    self.menuViewRelative.frame = fixedFrame;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T16:03:03.063

您可以将您的子视图添加到窗口中，例如：

```
[self.view.window addSubview:mySubView]; 
```

这个对我有用。我在动态表格视图中添加了一个像素位置信息视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-02T10:40:54.170

如果它是一个包含表格视图的简单视图控制器，则 [self.view addSubview:aSubView] 应该可以工作。但如果它是一个表格视图控制器，它就不会工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-25T17:10:37.330

可以通过将子（您的）视图从 UIScrollView 移动到滚动视图的超级视图来完成。

这是一个简单的示例：
将按钮放置/设置在滚动视图上（不在滚动视图内），如此处所示。并且还针对滚动视图的超级视图设置按钮约束（位置）。

[![在此处输入图像描述](../Images/8df38cc8168973ecc56e404fe43adffb.png)](https://i.stack.imgur.com/gCCD8.png)

这是参考。每个视图的位置层次结构的快照。

[![在此处输入图像描述](../Images/df8f11fb9d5fdab6a486e107ed260b3f.png)](https://i.stack.imgur.com/iLTol.png)

# c++ - 在 omp 关键部分内引发 C++ 异常

> ID：13663231
> 
> 赞同：19
> 
> 时间：2012-12-01T20:05:33.597
> 
> 标签：c++, openmp

我想知道在 OMP 关键部分中抛出 C++ 异常是否安全。

```
#pragma omp critical (my_critical_section)
{
    ...
    throw my_exception("failed")
    ...       
} 
```

g++ 没有抱怨。我很困惑，因为它抱怨`return`关键部分内的语句。它返回错误：`invalid exit from OpenMP structured block`当我写

```
#pragma omp critical (my_critical_section)
{
    ...
    return;
    ...       
} 
```

那么，为什么给临界区一个异常就可以了，但是用一个return语句就不行了呢**？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-01T22:13:00.140

不，不允许有例外的关键部分。`g++`在这种情况下不会抱怨，但它`try/catch`会在关键部分的块周围默默地插入一个隐式。例如下面的代码：

```
#pragma omp critical (my_crit)
{
   throw 3;
} 
```

被 GCC 4.7 的 OpenMP 处理器降低为：

```
#pragma omp critical (my_crit)
__builtin_GOMP_critical_name_start (&.gomp_critical_user_my_crit);
try
  {
    D.20639 = __cxa_allocate_exception (4);
    try
      {
        MEM[(int *)D.20639] = 3;
      }
    catch
      {
        __cxa_free_exception (D.20639);
      }
    __cxa_throw (D.20639, &_ZTIi, 0B);
  }
catch
  {
    <<<eh_must_not_throw (terminate)>>>
  }
__builtin_GOMP_critical_name_end (&.gomp_critical_user_my_crit); 
```

达到隐式内置的 catch-all 处理程序`<<<eh_must_not_throw (terminate)>>>`会导致非常不优雅的终止：

```
terminate called after throwing an instance of 'int'
Abort trap: 6 
```

`try/catch`无论外部构造是否存在，都会插入隐式`try/catch`，即异常永远不会离开该`critical`部分。

`parallel`OpenMP 标准规定，如果在大多数 OpenMP 构造（ 、`section`、`master`、`single`、`for`、`critical`、等）中引发异常，则`task`必须在同一构造中恢复执行，并且同一线程必须捕获异常。违反此限制会导致不符合标准的 OpenMP 代码，并通过在所有此类构造中`g++`插入`try/catch`带有终止处理程序的块来简单地强制符合标准。

至于`return`存在语句时的错误，OpenMP 将 C/C++ 中的结构化块定义为：

> 对于 C/C++，一个可执行语句，可能是复合语句，顶部有一个入口，底部有一个出口，或者是一个 OpenMP 结构。

还有（对于所有语言）：

> 退出点不能是*结构化块*的分支。

显然`return`构成了块的一个分支，不同于简单的块底部的下降。

# javascript - 长 javascript if else 语句

> ID：13663242
> 
> 赞同：0
> 
> 时间：2012-12-01T20:07:12.537
> 
> 标签：javascript, jquery, if-statement, refactoring

我有一长串 if-else 语句。我知道有一种更有效的方法可以做到这一点，但对 javascript 还不够熟悉。有人可以提供一些指导吗？

```
$('#webform-component-primary-credential--0').change (function() {
    if ($('#edit-submitted-primary-credential-0').val() == 35) {
      $('#edit-submitted-additional-credentials-0-47').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-47").attr("disabled", "disabled");
    } else {
      $("#edit-submitted-additional-credentials-0-47").removeAttr("disabled");
    }
    if ($('#edit-submitted-primary-credential-0').val() == 41) {
      $('#edit-submitted-additional-credentials-0-53').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-53").attr("disabled", "disabled");
    } else {
      $("#edit-submitted-additional-credentials-0-53").removeAttr("disabled");
    }
    if ($('#edit-submitted-primary-credential-0').val() == 13) {
      $('#edit-submitted-additional-credentials-0-29').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-29").attr("disabled", "disabled");
    } else {
      $("#edit-submitted-additional-credentials-0-29").removeAttr("disabled");
    }   

}); 
```

本系列中还有大约 12 个 if-else 语句，但这给出了总体思路。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T20:09:02.973

如果您总是检查相同的值，请使用 switch-case 语句：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/switch)

（这也可以用在 C/C++ 和许多其他从它们那里借用语法的语言中。有些语言有它的变体，比如 Ruby 的 case-when 语法。）

您的代码实际上有点麻烦，因为它包含在 switch-case 语句中（最好是长`if () {} else if () {} ... else () {}`链），但您可以通过以下方式做到这一点：

```
$('#webform-component-primary-credential--0').change (function() {
    var active_element;

    $("#edit-submitted-additional-credentials-0-47").removeAttr("disabled");
    $("#edit-submitted-additional-credentials-0-53").removeAttr("disabled");
    $("#edit-submitted-additional-credentials-0-29").removeAttr("disabled");

    switch ($('#edit-submitted-primary-credential-0').val()) {
        case 35:
            active_element = $("#edit-submitted-additional-credentials-0-47");
            break;
        case 41:
            active_element = $("#edit-submitted-additional-credentials-0-53");
            break;
        case 13:
            active_element = $("#edit-submitted-additional-credentials-0-29");
            break;
    }

    active_element.attr('checked', false);
    active_element.attr("disabled", "disabled");
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-01T20:24:18.283

像这样的东西可能会起作用：

```
$("#webform-component-primary-credential--0").change(function() {
    var primaryCred = $("#edit-submitted-primary-credential-0").val(), 
        credIdPrefix = "#edit-submitted-additional-credentials-0-", 
        credMap = { 35 : 47, 41 : 53, 13 : 29 };

    for (var cred in credMap) {
        if (primaryCred == cred) {
            $(credIdPrefix + credMap[cred]).attr({ "checked" : false, "disabled" : "disabled" });
        } else {
            $(credIdPrefix + credMap[cred]).removeAttr("disabled");
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T20:46:13.480

这是一种更清洁，更快捷的方法：

```
$(function() {
    var dependencies, $checkboxes;

    dependencies = {
        35: 47,
        41: 53,
        13: 29
    };

    $checkboxes = $(":checkbox[id^='edit-submitted-additional-credentials-0-']");

    $('#webform-component-primary-credential--0').change(function() {
        var primaryCredential, selector;
        primaryCredential = $('#edit-submitted-primary-credential-0').val();
        selector = "#edit-submitted-additional-credentials-0-" + dependencies[primaryCredential];

        $checkboxes
            .prop("disabled", false)
            .filter(selector)
            .prop({
                disabled: true,
                checked: false
            });
    });
}); 
```

​如果你有这么多的复选框，你应该缓存它们以提高性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T20:14:53.473

您可以使用`switch-case`如下语句：

```
var credential = $('#edit-submitted-primary-credential-0').val();
$('#webform-component-primary-credential--0').change (function() {
switch (credential) {
   case 35:
      $('#edit-submitted-additional-credentials-0-47').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-47").attr("disabled", "disabled");
      break;
   case 41:
      $('#edit-submitted-additional-credentials-0-53').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-53").attr("disabled", "disabled");
      break;
   case 13:
      $('#edit-submitted-additional-credentials-0-29').attr('checked', false);
      $("#edit-submitted-additional-credentials-0-29").attr("disabled", "disabled");
      break;
   default:
      $("#edit-submitted-additional-credentials-0-47").removeAttr("disabled");
      $("#edit-submitted-additional-credentials-0-53").removeAttr("disabled");
      $("#edit-submitted-additional-credentials-0-29").removeAttr("disabled");
   } 
```

});

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T21:17:03.187

我觉得这个更干净。没有测试过代码。您可以扩展凭证对象以使用 val 数组和键。您还需要更改 edit_additional_credentials() 实现。

```
$('#webform-component-primary-credential--0').change (function() {
    edit_additional_credentials();
});

var credentials = [
    {
        primary: 'edit-submitted-primary-credential-0',
        additional: [
            {
                key: 35,
                val: 'edit-submitted-additional-credentials-0-47'
            },
            {
                key: 41,
                val: 'edit-submitted-additional-credentials-0-53'
            },
            {
                key: 13,
                val: 'edit-submitted-additional-credentials-0-29'
            }
        ]
    }
];

function disable_additional_credential(id) {
    $('#' + id).attr('checked', false);
    $('#' + id).attr("disabled", "disabled");
}

function enable_additional_credential(id) {
    $('#' + id).removeAttr("disabled");
}

function edit_additional_credentials() {

    for (var i = 0; i < credentials.length; i++) {
        var val = $('#' + credentials[i].primary).val();

        for (var j = 0; j < credentials[i].additional.length; j++) {
            if (val == credentials[i].additional.key) {
                disable_additional_credential(credentials[i].additional.val);
            } else {
                enable_additional_credential(credentials[i].additional.val);
            }
        }
    }
} 
```

# c# - c#不能反序列化嵌套的json字符串

> ID：13663248
> 
> 赞同：0
> 
> 时间：2012-12-01T20:08:02.427
> 
> 标签：c#, json

我正在尝试反序列化嵌套的 json 字符串

```
 public class recentlySearchedAdd
    {
        public recentlySearchedAdd()
        {
            searchedLocations = new List<recentlySearchedLoc>();
        }
        public string status { get; set; }
        public List<recentlySearchedLoc> searchedLocations { get; set; }
    }

    public class recentlySearchedLoc
    {
        public int id { get; set; }
        public string location { get; set; }

    } 
```

这是处理json字符串的代码

```
 //dummy json string
        string json = "{\"status\": \"OK\", \"searchedLocations\": [{\"id\": 7, \"location\": \"California\"}, {\"id\": 4, \"location\": \"90007\"}, {\"id\": 3, \"location\": \"New York, NY\"}]}";
        JavaScriptSerializer ser = new JavaScriptSerializer();
        List<recentlySearchedAdd> recentlySearchedAddList = ser.Deserialize<List<recentlySearchedAdd>>(json);
        Response.Write("count:"+recentlySearchedAddList.Count); 
```

计数为 0……这段代码有什么问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:17:34.753

你很亲密。序列化程序返回的`recentlySearchedAdd`不是它的列表。

```
JavaScriptSerializer ser = new JavaScriptSerializer();
recentlySearchedAdd recentlySearchedAddList = ser.Deserialize<recentlySearchedAdd>(json);
Console.Write("count:" + recentlySearchedAddList.searchedLocations.Count); 
```

# string - 转换输入文件中的字符串

> ID：13663251
> 
> 赞同：2
> 
> 时间：2012-12-01T20:08:06.857
> 
> 标签：string, unix

我`file1.txt`在 Unix 上有一个文本文件。我想生成另一个文件`file2.txt`，在其中更改所有具有这种格式的行组（取自多项选择题）

```
a. [first choice]
b. [second choice]
c. [third choice] 
```

到

```
[first choice] [second choice] [third choice] 
```

我怎么能那样做？

**编辑**：一个例子是

```
What is the value of three plus five?
a. six
b. seven
c. eight

This line is not so relevant.
blah blah

What is the capital of England?
a. London
b. Birmingham
c. New York 
```

它应该转换为

```
What is the value of three plus five?
six seven eight

This line is not so relevant.
blah blah

What is the capital of England?
London Birmingham New York 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:36:42.233

这个单线应该适合你：

```
 awk '{if($0~/^[a-z]\. /){gsub(/^[a-z]\. /,"");printf "%s ",$0;s=1;next;}else{if(s)print "";print $0;s=0}}' file1 
```

测试

```
kent$  cat exam
What is the value of three plus five?
a. six
b. seven
c. eight

This line is not so relevant.
blah blah

What is the capital of England?
a. London
b. Birmingham
c. New York

kent$  awk '{if($0~/^[a-z]\. /){gsub(/^[a-z]\. /,"");printf "%s ",$0;s=1;next;}else{if(s)print "";print $0;s=0}}' exam
What is the value of three plus five?
six seven eight 

This line is not so relevant.
blah blah

What is the capital of England?
London Birmingham New York 
```

# php - 配置远程 Git 存储库

> ID：13663252
> 
> 赞同：0
> 
> 时间：2012-12-01T20:08:16.467
> 
> 标签：php, macos, git

我是 Git 新手，但已经享受并收获了其中的好处。但是，我需要继续前进。

我在我的 Mac 上运行了 Git，并且——正如你所知道的——我正在使用 Coda 2 和用于 Mac 的 Github 客户端。

我可以访问具有两个帐户的服务器：1\. live（可通过 www.domain.com 访问），以及；2\. 开发人员（可通过 d.domain.com 访问）。

我想：

1.  将我对特定 Web 应用程序项目（用 PHP 编写，使用 MySQL）所做的更改反映在开发人员帐户上，供客户批准，然后；
2.  最后上传到真实账户。

就目前而言，在阅读[了 Git 文档的第 4 章](http://git-scm.com/book/en/Git-on-the-Server)之后，我一点也不聪明。

虽然我是一名开发人员，但我很少亲身参与网络、终端或类似的事情；我通常使用 cPanel 和 WHM。

所以我正在寻找一些简单的东西来指导我完成这个过程，当然比前面提到的更简单，这对我来说几乎没有任何意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:19:38.863

I think you need to create a local Git repo with two Remote (developer domain and live domain):

```
git remote add dev http://d.domain.com/path/to/repo
git remote add live http://domain.com/path/to/repo 
```

When you want to push your master branch to dev do:

```
git push dev master 
```

and if you are ready to go live:

```
git pull dev master
git push live master 
```

# haskell - 在haskell中绑定计算的运行时间

> ID：13663261
> 
> 赞同：7
> 
> 时间：2012-12-01T20:09:16.063
> 
> 标签：haskell, artificial-intelligence, sleep, thread-sleep

我正在用 Haskell 编写游戏 AI，我想在指定的时间内搜索游戏状态树（即我总是希望 AI 花费 3 秒来决定要采取什么行动）

我怎样才能用像 Haskell 这样的纯语言来做到这一点？我希望我需要深入研究线程等，但我希望尽可能地减少它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:55:24.653

一个想法：将（由@MathematicalOrchid 建议）与来自[SafeSemaphore](http://hackage.haskell.org/packages/archive/SafeSemaphore/0.9.0/doc/html/Control-Concurrent-MSampleVar.html)`timeout`的可变变量结合起来，以在您的进程每次计算部分结果时存储中间值：

```
import Control.Monad
import Control.Concurrent.MSampleVar
import System.Timeout

fac :: Integer -> Integer
fac 0 = 1
fac n = n * fac (n - 1)

tmo :: Int -> ((a -> IO ()) -> IO ()) -> IO (Maybe a)
tmo ms f = do
    mvar <- newSV Nothing
    timeout ms (f (writeSV mvar . (Just $!)))
    readSV mvar

longComp :: (Integer -> IO ()) -> IO ()
longComp save = let loop n = save (fac n) >> loop (n + 1)
                in loop 0

main :: IO ()
main = tmo 10000 longComp >>= print 
```

传递给函数`tmo`的第一个参数是一个`IO`动作，它可以用来保存中间结果。如果超时，则返回最后保存的结果。结果被转换为 WHNF 以便真正的计算发生在保存结果的线程中，而不是在从`tmo`.

在这个变体中，传递给的函数`tmo`必须保存它的输出，它不能返回它。但是很容易修改它，使其签名为`(a -> IO ()) -> IO a`.

如果你想让事情变得更纯粹，我建议创建你自己的 monad 来封装这个想法而不会泄露`IO`。

* * *

**更新：**请注意：

> 尽管运行时会努力确保不会发生任意延迟，但不能保证异常会及时传递。在 GHC 中，只有当线程到达安全点时才会引发异常，安全点是发生内存分配的地方。一些循环不会在循环内执行任何内存分配，因此不会被 throwTo 中断。

（来自[throwTo](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Concurrent.html#v%3athrowTo)的文档）。在上面的示例中，`fac`不分配任何内存，因此对于大量内存不会立即中断。

**更新：**我基于这些想法创建了一个小型库，该库定义了一个用于计算的单子，该单子可以在返回最终结果或因超时而死之前返回部分结果。见[https://github.com/ppetr/timeout-with-results](https://github.com/ppetr/timeout-with-results)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-01T20:43:38.013

由于您要寻找的结果取决于时间，这不可避免地会涉及不纯的代码。

`System.Timeout`从包中看起来，它`base`提供了运行 I/O 计算直到某个超时的能力（根据 leftaroundabout 的评论。）所以你需要做的就是编写一个`IO`返回你感兴趣的结果的计算。但是.. . 棘手的部分是让`IO`动作实际*计算*结果，而不仅仅是返回未评估的结果。为此，我*认为*您需要`evaluate`从`Control.Exception`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-01T21:48:22.747

`System.Timeout`是要走的路。它有一个非常干净的界面，一点也不觉得你在搞乱线程。

搜索游戏空间听起来像是纯粹的计算，并`System.Timeout`运行`IO`动作，因此您需要将值包装在 中`return`，并足够严格地评估代码，`timeout`以免在评估到 WHNF 后立即相信答案已返回.

[这里](https://stackoverflow.com/questions/10071560/timing-out-pure-functions)有一个代码可能是什么样子的示例，来自我遇到的类似问题。

# c# - 函数和函数有什么区别 和方法（x，y）？

> ID：13663263
> 
> 赞同：0
> 
> 时间：2012-12-01T20:09:26.303
> 
> 标签：c#

以下两种方法有什么区别？他们都返回完全相同（据我所知）所以我想知道为什么一个人宁愿使用一个而不是另一个？

是否存在以下两种方法中的一种更可取的特定情况？`func<>`或者在任何情况下使用普通方法 会更好？

```
 private static int addThings(int x, int y)
 {
  return x*y;
 }

 private static Func<int,int,int> addMoreThings = (x,y) =>
 {
  return x*y;
 }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:11:30.537

`Func`是一个*委托*- （C++ 程序员称之为强类型函数指针）。

这`Func<int,int,int>`意味着接受两个整数并返回一个整数的函数的委托 - 任何此类函数。

在 的情况下`addThings`，立即进行计算并返回结果。

在 的情况下`addMoreThings`，返回*函数*。以后可以*调用*它。

在没有更多上下文的情况下很难推荐一个而不是另一个 - 拥有委托版本可以让您变得懒惰 - 使用策略模式，例如通过将策略分配给委托。

# sql - 在 SQL 中将行转换为列

> ID：13663264
> 
> 赞同：3
> 
> 时间：2012-12-01T20:09:36.590
> 
> 标签：sql, sql-server, pivot

请问我该怎么做？

![在此处输入图像描述](../Images/78e7b82bc395d509f8cee2fd50185e76.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:35:55.073

您可以使用[**`PIVOT`**](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)table 运算符将这些课程成绩的行转换为列，如下所示：

```
SELECT  
  Course, 
  [1] AS "Grade 1", 
  [2] AS "Grade 2", 
  [3] AS "Grade 3", 
  [4] AS "Grade 4"
FROM
(
  SELECT 
    Course, 
    Grade, 
    ROW_NUMBER() OVER(PARTITION BY Course 
                      ORDER BY COURSE) rownum 
  FROM Grades
) t
PIVOT 
(
   MAX(Grade)
   FOR rownum IN([1], [2], [3], [4])
) p; 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!3/7b946/13)

这会给你：

```
COURSE    GRADE 1   GRADE 2      GRADE 3     GRADE 4
  A         15        17          (null)     (null)
  B         12      (null)        (null)     (null)
  C         10        18            0           9 
```

**请注意：**我使用排名功能[**`ROW_NUMBER()`**](http://msdn.microsoft.com/en-us/library/ms186734.aspx)将`PARTITION BY Course`它们分为四个等级。这样您就可以将它们分为这四个组。

如果你需要这个动态，以防有未知数量的等级。在这种情况下，您可以使用动态 SQL 来动态生成成绩列表，如下所示：

```
DECLARE @cols AS NVARCHAR(MAX);
DECLARE @query AS NVARCHAR(MAX);

SELECT @cols = STUFF((SELECT distinct ',' 
                        + QUOTENAME('Grade ' 
                        + CAST(ROW_NUMBER() OVER(PARTITION BY Course 
                                               ORDER BY Course) AS VARCHAR(10)))
                FROM Grades
                         FOR XML PATH(''), TYPE
                      ).value('.', 'NVARCHAR(MAX)'), 1, 1, '');

SELECT @query = 'SELECT Course, ' + @cols +  
                'FROM
                 (
                   SELECT 
                     Course, 
                     Grade, 
                     ''Grade '' + CAST(ROW_NUMBER() 
                                       OVER(PARTITION BY Course 
                                ORDER BY COURSE) AS VARCHAR(10)) rownum 
                   FROM Grades
                 ) t
                 PIVOT 
                 (
                   MAX(Grade)
                   FOR rownum IN(' + @cols + ')' +
                ') p';
execute(@query); 
```

## [动态 SQL 小提琴演示](http://sqlfiddle.com/#!3/1bbe7/1)

# file - 如何使用 sed 或 awk 更正日志时间格式

> ID：13663265
> 
> 赞同：1
> 
> 时间：2012-12-01T20:09:38.823
> 
> 标签：file, bash, csv, sed, awk

我目前正在处理一个处理 csv 文件的脚本，并在此过程中更正它们的某些方面。如果需要，它所做的一件事是正确的时间格式。发生两种类型的转换：

```
 xx:xx:xx to PTxxHxxMxxS
 10:03:45 to PT10H03M45S 
```

我已经能够使用以下方法（见下文）来做到这一点，尽管我试图找出如何使用 sed 或 awk 来加快进程。除了实际的转换过程之外，我还想记录所做的更改（比如转换 4 次值，计数器将增加到 4），我可以使用 if 轻松完成下面的语句（虽然没有显示），虽然我不太了解使用 sed/awk 做这件事。

```
 istimef=$( echo "$Sfcpp6" | grep ".*:.*:.*" )
                    if [ "$istimef" != "" ]; then
                            hs=$( echo "$Sfcpp6" | cut -d ':' -f 1 )
                            mn=$( echo "$Sfcpp6" | cut -d ':' -f 2 )
                            sc=$( echo "$Sfcpp6" | cut -d ':' -f 3 )
                            Sfcpp6=$( echo "PT"$hs"H"$mn"M"$sc"S" )
                            echo "$Sfcp6"
                    fi 
```

它本质上检查时间值是否存在，然后执行转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:53:25.230

令人惊讶的是，您需要多少进程和子shell 来完成这项任务！我总是对人们的聪明才智和创造力感到惊讶。我计算了 10 个子外壳和 4 个进程生成。

看，您可以在不产生一个进程且无需任何子shell 的情况下实现完全相同的效果。我们在这里谈论加速！

第一个任务，给定一个形式为 的字符串，尽可能高效地`xx:yy:zz`将其转换为（看，只有一个命令！和一个内置命令！没有！）：`PTxxHyyMzzS``sed`

```
$ string='12:34:56'
$ printf -v transformed 'PT%sH%sM%sS' ${string//:/ }
$ # Done! Don't believe me?
$ echo "$transformed"
PT12H34M56S 
```

现在，在执行此操作之前，您可能需要检查字符串是否为`xx:yy:zz`. 为此退出`grep`。只需这样测试它：

```
if [[ "$string" = *:*:* ]]; then
    echo "ok"
else
    echo "not ok"
fi 
```

因此，您向我们展示的脚本部分会更有效率，因此：

```
if [[ "$Sfcpp6" = *:*:* ]]; then
    printf -v Sfcp6 'PT%sH%sM%sS' ${Sfcpp6//:/ }
    echo "$Sfcp6"
fi 
```

总计：0 个子外壳，0 个进程产生。

或者，如果您的目标只是回显转换后的字符串：

```
if [[ "$Sfcpp6" = *:*:* ]]; then
    printf 'PT%sH%sM%sS\n' ${Sfcpp6//:/ }
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:12:52.007

`sed`解决方案：用于`\(...\)`捕获数字，字符类`[0-9]`以匹配任何数字。

```
sed 's/\([0-9][0-9]\):\([0-9][0-9]\):\([0-9][0-9]\)/PT\1H\2M\3S/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:52:36.403

如果要计算替换的行：

```
perl -pe '
    END{print "count=$count\n"}
    s/(\d{2}):(\d{2}):(\d{2})/PT$1H$2M$3S/ && $count++
' file.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-02T14:48:32.637

@choroba 发布的这个 sed 解决方案的 GNU awk 等效项：

```
sed 's/\([0-9][0-9]\):\([0-9][0-9]\):\([0-9][0-9]\)/PT\1H\2M\3S/' 
```

将非常相似：

```
awk '{print gensub(/([0-9][0-9]):([0-9][0-9]):([0-9][0-9])/,"PT\\1H\\2M\\3S","")}' 
```

但是可以对 awk 解决方案进行简单的修改，以解决您的问题“是否可以让 sed 记录它所做的更改？”：

```
awk '{orig=$0; $0=gensub(/([0-9][0-9]):([0-9][0-9]):([0-9][0-9])/,"PT\\1H\\2M\\3S",""); print} $0 != orig{count++} END{printf "%d changes made.\n",count}' 
```

而 sed 解决方案不能。

# c# - 为什么我不能将 yield 放在 try 中？

> ID：13663267
> 
> 赞同：0
> 
> 时间：2012-12-01T20:09:53.203
> 
> 标签：c#

> **可能重复：**
> [为什么 yield return 不能出现在带有 catch 的 try 块内？](https://stackoverflow.com/questions/346365/why-cant-yield-return-appear-inside-a-try-block-with-a-catch)

我想确保我的应用程序不会崩溃并尝试将我的方法放在 try 中，我的函数是`IEnumerable`返回类型，我不能这样做。

我有哪些选择？

```
public static IEnumerable<Packet> splitPacket(Packet packet, int numberOfFragments)
{
    IpV4Datagram ipV4Datagram = packet.Ethernet.IpV4;

    if (ipV4Datagram.Protocol == IpV4Protocol.Tcp || ipV4Datagram.Protocol == IpV4Protocol.Udp)
    {
        EthernetLayer ethernet = (EthernetLayer)packet.Ethernet.ExtractLayer();
        IpV4Layer ipV4Layer = (IpV4Layer)packet.Ethernet.IpV4.ExtractLayer();
        DateTime packetTimestamp = packet.Timestamp;
        ipV4Layer.HeaderChecksum = null;
        PayloadLayer payload = (PayloadLayer)packet.Ethernet.IpV4.Payload.ExtractLayer(); //extract the data
        int totalLength = payload.Length;
        int partialLength = totalLength / numberOfFragments; //split data into smaller segments
        partialLength = (partialLength / 8) * 8; //make sure it's divisible with 8 (http://en.wikipedia.org/wiki/IPv4#Fragmentation_and_reassembly)
        ushort offset = 0; //send one by one

        while (offset < totalLength)
        {
            int fragmentLength = partialLength; //get length for this fragment
            IpV4FragmentationOptions options = IpV4FragmentationOptions.MoreFragments;

            if (offset + fragmentLength >= totalLength) //is this the last fragment ? trim length if needed
            {
                options = IpV4FragmentationOptions.None;
                fragmentLength = totalLength - offset;
            }

            byte[] newBuffer = ipV4Datagram.Payload.ToArray(); //copy the actual data into a new buffer
            PayloadLayer newPayload = new PayloadLayer { Data = new Datagram(newBuffer, offset, fragmentLength) };
            ipV4Layer.Fragmentation = new IpV4Fragmentation(options, offset); //change IP layer fragmentation options
            yield return PacketBuilder.Build(packetTimestamp, ethernet, ipV4Layer, newPayload); //return
            offset += (ushort)fragmentLength; //next offset
        }
    }
} 
```

# python - 将行拆分为段落

> ID：13663268
> 
> 赞同：1
> 
> 时间：2012-12-01T20:09:54.890
> 
> 标签：python

输入：行列表

输出：行列表的列表，它是在（一个或多个的序列）空行处拆分的输入列表。

这是我迄今为止最不难看的解决方案：

```
split_at_empty(lines):
    paragraphs = []
    p = []
    def flush():
        if p:
            paragraphs.append(p)
        p = []
    for l in lines:
        if l:
            p.append(l)
        else:
            flush()
    flush()
    return paragraphs 
```

必须有更好的解决方案（甚至可能是功能性的）！任何人？

示例输入列表：

```
['','2','3','','5','6','7','8','','','11'] 
```

输出：

```
[['2','3'],['5','6','7','8'],['11']] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:52:26.433

```
import re

ss =  '''Princess Maria Amelia of Brazil (1831–1853)

was the daughter of Dom Pedro I,
founder of Brazil's independence and its first emperor,

and Amelie of Leuchtenberg.

The only child from her father's second marriage,
Maria Amelia was born in France
following Pedro I's 1831 abdication in favor of his son Dom Pedro II.

Before Maria Amelia was a month old, Pedro I left for Portugal
to restore its crown to his eldest daughter Dona Maria II.
He defeated his brother Miguel I (who had usurped Maria II's throne),
only to die a few months later of tuberculosis.

'''

def select_lines(input,regx = re.compile('((?:^.+\n)+)',re.MULTILINE)):
    return [x.splitlines() for x in regx.findall(input)]

for sl in  select_lines(ss):
    print sl
    print 
```

结果

```
['Princess Maria Amelia of Brazil (1831\x961853)']

['was the daughter of Dom Pedro I,', "founder of Brazil's independence and its first emperor,"]

['and Amelie of Leuchtenberg.']

["The only child from her father's second marriage,", 'Maria Amelia was born in France', "following Pedro I's 1831 abdication in favor of his son Dom Pedro II."]

['Before Maria Amelia was a month old, Pedro I left for Portugal', 'to restore its crown to his eldest daughter Dona Maria II.', "He defeated his brother Miguel I (who had usurped Maria II's throne),", 'only to die a few months later of tuberculosis.']

[['2', '3'], ['5', '6', '7', '8'], ['11']] 
```

另一种方式，对列表采取行动：

```
li = [ '', '2', '3', '', '5', '6', '7', '8', '', '', '11']

lo = ['5055','','','2','54','87','','1','2','5','8','','']

lu = ['AAAAA','BB','','HU','JU','GU']

def selines(L):
    ye = []
    for x in L:
        if x:
            ye.append(x)
        elif ye:
            yield ye ; ye = []
    if ye:
        yield ye

for lx in (li,lo,lu):
    print lx
    print list(selines(lx))
    print 
```

结果

```
['', '2', '3', '', '5', '6', '7', '8', '', '', '11']
[['2', '3'], ['5', '6', '7', '8'], ['11']]

['5055', '', '', '2', '54', '87', '', '1', '2', '5', '8', '', '']
[['5055'], ['2', '54', '87'], ['1', '2', '5', '8']]

['AAAAA', 'BB', '', 'HU', 'JU', 'GU']
[['AAAAA', 'BB'], ['HU', 'JU', 'GU']] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:15:08.500

比原来的丑一点：

```
def split_at_empty(lines):
    r = [[]]
    for l in lines:
        if l:
            r[-1].append(l)
        else:
            r.append([])
    return [l for l in r if l] 
```

（最后一行去掉了原本会被添加的空列表。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T22:15:18.317

对于列表理解的痴迷者......

```
def split_at_empty(L):
    return [L[start:end+1] for start, end in zip(
        [n for n in xrange(len(L)) if L[n] and (n == 0 or not L[n-1])],
        [n for n in xrange(len(L)) if L[n] and (n+1 == len(L) or not L[n+1])]
        )] 
```

或更好

```
def split_at_empty(lines):
    L = [i for i, a in enumerate(lines) if not a]
    return [lines[s + 1:e] for s, e in zip([-1] + L, L + [len(lines)]) 
            if e > s + 1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T20:30:15.130

您可以将列表组合成一个字符串，然后重新拆分它：

```
>>> a = ['', '2', '3', '', '5', '6', '7', '8', '', '', '11']
>>> [x.strip().split(' ') for x in ' '.join(a).split('  ')]
[['2', '3'], ['5', '6', '7', '8'], ['11']] 
```

而且您可能应该使用正则表达式来捕获任意数量的空格（我在此处的“11”之前添加了另一个空格）：

```
>>> import re
>>> pat = re.compile(r'\s{2,}')
>>> a = ['', '2', '3', '', '5', '6', '7', '8', '', '', '', '11']
>>> [x.strip().split(' ') for x in pat.split(' '.join(a))]
[['2', '3'], ['5', '6', '7', '8'], ['11']] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T20:33:01.483

这是一个基于生成器的解决方案：

```
def split_at_empty(lines):
   sep = [0] + [i for (i,l) in enumerate(lines) if not l] + [len(lines)]
   for start, end in zip(sep[:-1], sep[1:]):
      if start + 1 < end:
         yield lines[start+1:end] 
```

对于您的输入：

```
l = ['' , '2' , '3' , '' , '5' , '6' , '7' , '8' , '' , '' , '11']
for para in split_at_empty(l):
   print para 
```

它产生

```
['2', '3']
['5', '6', '7', '8']
['11'] 
```

# delphi - 使用 Indy 提高传输速度

> ID：13663274
> 
> 赞同：1
> 
> 时间：2012-12-01T20:11:07.383
> 
> 标签：delphi, indy, indy10

我需要使用 INDY10 组件将许多文件从一台 tcp indy 服务器传输到客户端。有没有办法通过为 TCP 客户端或服务器通信设置任何参数来提高传输速度。

文件大小：~ 10 MBYte .... 50 Mybte

文件大小是否有限制，我的电脑使用的是 WIN 7 x64 和 32 GBYTE RAM 我们的网络是 LAN.100 其他位置 LAN 已经改进为 GIGABIT LAN

```
 function SendStream(AContext: TIdContext; AStream: TStream): Boolean; overload;
  var
    StreamSize: LongInt;
  begin
    try
      Result := True;
      try
        StreamSize := (AStream.Size);

        // AStream.Seek(0, soFromBeginning);

        AContext.Connection.IOHandler.Write(LongInt(StreamSize));
        AContext.Connection.IOHandler.WriteBufferOpen;
        AContext.Connection.IOHandler.Write(AStream, 0, False);
        AContext.Connection.IOHandler.WriteBufferFlush;
      finally
        AContext.Connection.IOHandler.WriteBufferClose;
      end;
    except
      Result := False;
    end;
  end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T09:24:59.880

发送代码可以简化为

```
 function SendStream(AContext: TIdContext; AStream: TStream): Boolean;
  begin
    Result := True;
    try
      AContext.Connection.IOHandler.Write(AStream, 0, True);
    except
      Result := False;
    end;
  end; 
```

第三个参数使 Indy 将流大小作为 Integer 或 Int64（取决于 TIdIOHandler.LargeStream 属性的值）值写入客户端。

然后客户端可以读取流大小和流使用

```
// reads the stream size then reads the stream data
Client.IOHandler.ReadStream(MyStream, -1, False); 
```

（在[Delphi TidTCPServer 和 TidTCPClient 传输记录时](https://stackoverflow.com/questions/10874447/delphi-tidtcpserver-and-tidtcpclient-transferring-a-record)发现只有传输方向相反）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T16:39:18.540

直接发送流并保存正在制作的字节的另一个副本。特别是在您的示例中 - 删除提到 WriteBuffer 的 3 行代码。

根据流的大小和并发客户端的数量，您可能会通过使用您并不真正需要的大型缓冲副本来破坏内存管理器。您对大传输的目标是限制某些东西必须处理整个流的次数。

# javascript - 获取和比较对象身份的最佳方法是什么？

> ID：13663281
> 
> 赞同：2
> 
> 时间：2012-12-01T20:11:38.870
> 
> 标签：javascript, spidermonkey

我想在 GJS 中实现字典和集合，但唯一可用的比较运算符`Object`是`===`，所以如果我在标准 JavaScript 中实现它们，当`Object`s 用作键时它们会很慢。GJS 使用尚无 Map 和 Set 的官方独立 SpiderMonkey 版本 (1.8.5)。引入允许比较对象身份的 API 的最佳方法是什么？

*   我可以为 GJS 编写一个 C 模块，允许获取和比较对象标识
    *   也许我可以使用指向`JSObject`s 的指针。
        *   能保证SpiderMonkey不会动`JSObject`吗？
        *   C 标准不允许比较不是来自同一个块的指针。
        *   并且新的 64 位计算机具有不适合`double`53 位整数的 64 位地址。
    *   我可以手动将对象与数字关联起来。
        *   如何在`JSObject`不添加 JavaScript 可见的属性的情况下将任意数据与任意现有数据相关联？
*   或者也许有一个特定于 SpiderMonkey 的扩展，它允许我在纯 JavaScript 中完成它而无需编写 C 模块？

# jquery - FadeOut() 函数

> ID：13663290
> 
> 赞同：0
> 
> 时间：2012-12-01T20:12:34.300
> 
> 标签：jquery, html, image, fadein, fadeout

我有一个简单的问题要问你。为什么下面的代码无法正常工作 - 图像无法消失。怎么了？我必须在 jQuery 中使用 fadeOut 函数。也许这是一个语法错误？

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>FadeOut - jQuery</title>

<script type="text/javascript" src="js/jquery-1.2.6.min.js"></script>
<style type="text/css">
#outercorners img {
    display:yes;
}
</style>

<script type="text/javascript">

var x=1; // The corner counter

function fading() {
  $("#corner"+(++x)).fadeOut(2000); // Fade in the current corner

  if (x==5) { // Last image to be faded in?
    clearInterval(); // Stop interval
  }
} 

$(document).ready(function(){
$("button").click(function(){
  setInterval("fading()",1000); // Call function every second
});

</script>

</head>

<body>

<button>Start!</button>

<div id="outercorners">

 <img id="corner1" src="images/mouse_1.jpg" width="200" height="150"/>
 <img id="corner2" src="images/mouse_2.jpg" width="200" height="150"/>
 <img id="corner3" src="images/mouse_3.jpg" width="200" height="150"/>
 <img id="corner4" src="images/mouse_4.jpg" width="200" height="150"/>

 <div id="corner5"><img src="images/mouse_5.jpg" width="200" height="150" />
  <img id="corner6" src="images/mouse_6.jpg" width="200" height="150"/>
 <img id="corner6" src="images/mouse_7.jpg" width="200" height="150"/>
 <img id="corner7" src="images/mouse_8.jpg" width="200" height="150"/>

 <div id="corner9"><img src="images/mouse_9.jpg" width="200" height="150" />
  <img id="corner10" src="images/mouse_10.jpg" width="200" height="150"/>
 <img id="corner11" src="images/mouse_11.jpg" width="200" height="150"/>
 <img id="corner12" src="images/mouse_12.jpg" width="200" height="150"/>

  <div id="corner13"><img src="images/mouse_13.jpg" width="200" height="150" />
  <img id="corner14" src="images/mouse_14.jpg" width="200" height="150"/>
 <img id="corner15" src="images/mouse_15.jpg" width="200" height="150"/>
 <img id="corner16" src="images/mouse_16.jpg" width="200" height="150"/>

 </div>

</div>

</body>
</html> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:27:23.957

首先，您忘记关闭会生成语法错误的 DOM 就绪处理程序。

您还应该存储对间隔的引用以将其传递给`clearInterval`.

您的增量逻辑也略有偏差。要淡入前 4 个角落，它将是：

```
var x = 0,
    interval;

function fading() {
    $("#corner" + (++x)).fadeOut(2000); // Fade in the current corner
    if (x == 4) { // Last image to be faded in
        clearInterval(interval);
    }
}

$(document).ready(function() {
    $("button").click(function() {
        interval = setInterval(fading, 1000);
    });
}); //<-- you forgot to close DOM ready 
```

[**小提琴**](http://jsfiddle.net/2j8TM/)

* * *

也如评论所述，考虑将 jQuery 版本升级到更新的版本。jQuery 1.8.3 已经发布了。

还有一件事，您的评论说“淡入”，但您正在打电话`fadeOut`。如果要淡入`display:none`元素，请将`fadeOut`调用替换为`fadeIn`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:27:32.933

我刚刚使用了最新的 jQuery 库，清理了您的 HTML 并修复了 javascript：

## *[jsBin 演示](http://jsbin.com/igufen/1/edit)*

```
var x=1;  // The corner counter
var intv; 

function fading() {

  $("#corner"+(x++)).fadeOut(2000); // Fade in the current corner

  if (x%6===0) { // Last image to be faded in?
    clearInterval(intv); // Stop interval
  }

}

$(document).ready(function(){
  $("button").click(function(){
    intv = setInterval(fading,1000); // Call function every second
  });
}); 
```

HTML：

```
<button>Start!</button>

<div id="outercorners">

 <img id="corner1" src="images/mouse_1.jpg" width="200" height="150" alt="1" />
 <img id="corner2" src="images/mouse_2.jpg" width="200" height="150" alt="2" />
 <img id="corner3" src="images/mouse_3.jpg" width="200" height="150" alt="3" />
 <img id="corner4" src="images/mouse_4.jpg" width="200" height="150" alt="4" />

 <img id="corner5" src="images/mouse_5.jpg" width="200" height="150" alt="5" />
 <img id="corner6" src="images/mouse_6.jpg" width="200" height="150" alt="6" />
 <img id="corner6" src="images/mouse_7.jpg" width="200" height="150" alt="7" />
 <img id="corner7" src="images/mouse_8.jpg" width="200" height="150" alt="8" />

 <img id="corner9"  src="images/mouse_9.jpg" width="200" height="150" alt="9" />
 <img id="corner10" src="images/mouse_10.jpg" width="200" height="150" alt="10" />
 <img id="corner11" src="images/mouse_11.jpg" width="200" height="150" alt="11" />
 <img id="corner12" src="images/mouse_12.jpg" width="200" height="150" alt="12" />

 <img id="corner13" src="images/mouse_13.jpg" width="200" height="150" alt="13" />
 <img id="corner14" src="images/mouse_14.jpg" width="200" height="150" alt="14" />
 <img id="corner15" src="images/mouse_15.jpg" width="200" height="150" alt="15" />
 <img id="corner16" src="images/mouse_16.jpg" width="200" height="150" alt="16" />

</div> 
```

`(x%6===0)`这个模数将帮助您一次淡化 5 x 5 图像。

# ubuntu - 为 Raspberry Pi 交叉编译第三方库的非繁琐方法

> ID：13663292
> 
> 赞同：5
> 
> 时间：2012-12-01T20:12:43.177
> 
> 标签：ubuntu, cross-compiling, raspberry-pi

我正在尝试将现有的 Linux C++ 应用程序移植到 Raspberry Pi。该应用程序依赖于许多第三方库。

我正在运行 Ubuntu 12.04，并使用 crosstools-ng 构建了我的 GCC 4.7 交叉编译器（后来才意识到我可以通过使用官方提供的工具链为自己省去麻烦！）我能够为我的覆盆子。到现在为止还挺好。

然后我开始尝试构建我所有的第三方库依赖项：GLib、SDL 和其他几个。这些依赖关系中的每一个都有自己的依赖关系，等等。很快就发现，手动构建所有这些库的 ARM 版本将非常乏味和耗时。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T08:45:38.880

在发现[ScratchBox2](http://maemo.gitorious.org/scratchbox2)之后，我设法拼凑出一些可行的东西。ScratchBox2 是一个有助于创建适合交叉编译的 chroot 并利用[QEmu](http://wiki.qemu.org/Main_Page)的工具，允许您在计算机上运行外部 CPU 二进制文件。在我的例子中，ScratchBox2 调解对 Raspbian 的独立沙箱的访问，Raspbian 是针对 Raspberry Pi 优化的 Debian 的 ARM 变体。

结果是，一旦我完成了所有设置——并且设置它需要几个乏味的小时——我能够简单地输入`sb2 -eR apt-get install ...`以获得任何所需的 ARM 包。这是神奇的东西。（警告：我对 Ubuntu 12.10 中的官方 ScratchBox2 包没有运气，所以最好从源代码自己构建它，使用[官方 Git repo](http://maemo.gitorious.org/scratchbox2)的最新版本。）

为了帮助您更轻松地重现我的设置，我在 Github 上为我的虚拟机放置了 Vagrant 配方：[https](https://github.com/nickhutchinson/raspberry-devbox) ://github.com/nickhutchinson/raspberry-devbox 。几乎可以肯定它的边缘很粗糙——这是我第一次使用 Puppet 配置工具——但希望其他人可以让它更健壮。

我发现这些资源非常有用：

*   介绍 ScratchBox2 的幻灯片 (PDF) [http://www.daimi.au.dk/~cvm/sb2.pdf](http://www.daimi.au.dk/~cvm/sb2.pdf)
*   描述如何创建 Raspbian chroot 的论坛主题：[http ://www.raspberrypi.org/phpBB3/viewtopic.php?f=66&t=7413](http://www.raspberrypi.org/phpBB3/viewtopic.php?f=66&t=7413)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:08:46.723

查看[openembedded 构建框架](http://www.openembedded.org/wiki/Main_Page)。它旨在自动化交叉编译的所有繁琐任务。

openembedded 项目增加了对 raspberry [-pi 目标的支持](https://github.com/djwillis/meta-raspberrypi)

您可以使用像[poky](http://pokylinux.org/doc/poky-handbook.html)或[angstrom](http://www.angstrom-distribution.org/building-angstrom)这样的开放嵌入式发行版 sdk进行设置并帮助您入门。

Poky 可以吐出 rpm,ipk,deb。他们中的大多数将在其他发行版上工作。所以你不需要使用 poky 发行版本身。

[这](http://www.pimpmypi.com/blog/blogPost.php?blogPostID=7)是使用带有 raspberry-pi 的 openembedded 的指南

之后，您可以创建一个 bitbake 配方或自定义 oe 层，为您的应用程序定义依赖项。查看相关文档的 poky 手册。

使用或不使用 openembedded 的另一个选项是在 qemu-arm 机器上加载完整的开发环境，并在生产映像上使用二进制文件。Openemmbedded/poky 有一个 qemu-arm sdk 镜像的目标镜像配方。

# python - 大文件的高效 Hadoop 字数统计

> ID：13663294
> 
> 赞同：0
> 
> 时间：2012-12-01T20:12:53.627
> 
> 标签：python, hadoop, hadoop-streaming

我想实现一个用于字数统计的 hadoop reducer。在我的减速器中，我使用哈希表来计算单词。但是如果我的文件非常大，哈希表将使用大量内存。我该如何解决这个问题？（例如，一个有 1000 万行的文件，每个 reducer 接收 1 亿个单词，他如何计算一个哈希表需要 1 亿个键的单词）我当前的实现是在 python 中。有没有减少内存量的聪明方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:42:28.407

最有效的方法是在映射器中维护词频哈希映射，并在它们达到一定大小（例如 100,000 个条目）时将它们刷新到输出上下文。然后清除地图并继续（记得在清理方法中也刷新地图）。

如果你仍然真的有 1 亿个单词，那么你要么需要等待很长时间才能完成减速器，要么增加集群大小并使用更多减速器。

# python - 将整数转换为二进制

> ID：13663295
> 
> 赞同：5
> 
> 时间：2012-12-01T20:13:09.693
> 
> 标签：python

我有一个整数，我想将其转换为二进制并将位串存储在从右侧开始的一维数组中。例如，如果输入是，`6`那么它应该返回一个像`[1,1,0]`. 如何在python中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T20:16:42.010

## Solution

Probably the easiest way is not to use [`bin()`](http://docs.python.org/2/library/functions.html#bin) and string slicing, but use features of [`.format()`](http://docs.python.org/2.7/library/stdtypes.html#str.format):

```
'{:b}'.format(some_int) 
```

How it behaves:

```
>>> print '{:b}'.format(6)
110
>>> print '{:b}'.format(123)
1111011 
```

In case of [`bin()`](http://docs.python.org/2/library/functions.html#bin) you just get the same string, but prepended with "`0b`", so you have to remove it.

## Getting list of `int`s from binary representation

**EDIT**: Ok, so do not want just a string, but rather a list of integers. You can do it like that:

```
your_list = map(int, your_string) 
```

## Combined solution for edited question

So the whole process would look like this:

```
your_list = map(int, '{:b}'.format(your_int)) 
```

A lot cleaner than using `bin()` in my opinion.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-01T20:16:05.220

```
>>> map(int, bin(6)[2:])
[1, 1, 0] 
```

If you don't want a list of ints (but instead one of strings) you can omit the `map` component and instead do:

```
>>> list(bin(6)[2:])
['1', '1', '0'] 
```

* * *

**Relevant documentation:**

*   [`bin`](http://docs.python.org/2/library/functions.html#bin)
*   [`list`](http://docs.python.org/2/library/functions.html#list)
*   [`map`](http://docs.python.org/2/library/functions.html#map)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-01T20:19:50.990

You could use this command:

```
map(int, list(bin(YOUR_NUMBER)[2:])) 
```

What it does is this:

*   `bin(YOUR_NUMBER)` converts `YOUR_NUMBER` into its binary representation
*   `bin(YOUR_NUMBER)[2:]` takes the effective number, because the string is returned in the form `'0b110'`, so you have to remove the `0b`
*   `list(...)` converts the string into a list
*   `map(int, ...)` converts the list of strings into a list of integers

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-01T20:15:10.760

[`bin`](http://docs.python.org/2/library/functions.html#bin)如果您的 Python >= 2.6 ，则可以使用该函数：

```
list(bin(6))[2:] 
```

**编辑：**哎呀，忘记将项目转换为`int`：

```
map(int, list(bin(6))[2:]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-01T20:15:16.920

在现代 Python 中，您可以（`>python2.5`）：

```
>>> bin(23455)
'0b101101110011111' 
```

丢弃第一个'0b'：

```
>>> [ bit for bit in bin(23455)[2:] ]
['1', '0', '1', '1', '0', '1', '1', '1', '0', '0', '1', '1', '1', '1', '1'] 
```

一切都在一起：

```
def get_bits(number):
    return [ int(bit) for bit in bin(number)[2:] ] 
```

在 2.5 中，您将获得一个`NameError: name 'bin' is not defined`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-01T20:34:08.690

其他答案`bin()`用于此。它有效，但我发现使用字符串运算来做数学有点......嗯......蹩脚：

```
def tobits(x):
    r = []
    while x:
        r.append(x & 1)
        x >>= 1
    return r 
```

将`tobits(0)`返回一个空列表。这可能好或不好，取决于你会用它做什么。因此，如果需要，请将其视为特例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-02T05:27:32.340

您可以使用`numpy.unpackbits`.

这是带有示例的详细链接：[https ://numpy.org/doc/stable/reference/generated/numpy.unpackbits.html](https://numpy.org/doc/stable/reference/generated/numpy.unpackbits.html)

# jquery-ui - 如何禁用 ctrl 和 alt 按下以在 jQuery UI 自动完成中打开下拉菜单

> ID：13663296
> 
> 赞同：0
> 
> 时间：2012-12-01T20:13:11.087
> 
> 标签：jquery-ui, jquery-ui-autocomplete

重现步骤：

*   在 IE9 中打开[http://jqueryui.com/autocomplete/#combobox](http://jqueryui.com/autocomplete/#combobox)
*   选择右侧的组合框
*   单击自动完成框。
*   按下并释放 ctrl 或 alt 键

观察到的：

自动完成下拉菜单打开。

如何禁用此打开，以便只有 ctrl 和 alt 键不打开下拉框？

**更新**

我试过了

```
$(input).bind({
    keydown: function (e) {
        if (e.ctrlKey || e.altKey) {
            return false;
          }
    }
 }); 
```

但这会阻止所有键。

我注意到如果 ctrl 键被按住下拉菜单消失，但如果 ctrl 被释放，它会再次打开。

看起来来事件会导致下拉菜单重新打开。

# jquery - Bootstrap/Foundation 中的图像：文本在加载时移动

> ID：13663298
> 
> 赞同：1
> 
> 时间：2012-12-01T20:13:17.903
> 
> 标签：jquery, html, css, twitter-bootstrap, responsive-design

我无法理解基本 html 的一部分。

当我加载页面时，对于图像，除非我定义宽度和高度，否则它将从 0 开始，并增长到高度。这会导致文本移动。我不想那样做，但如果我要定义高度，那么事物的响应性将不起作用。它会弯曲和破坏图像，因为宽度是相对的，而高度不是。

在这种情况下我会怎么做？

你可以在 www.adarels.com 上看到我在说什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:07:48.647

您可以使用样式“display:none”隐藏 div。

使用如下准备好的 jquery，您可以显示 div（请注意，这未经测试，希望您作为建议尝试一下）：

```
$(document).ready(function(){
    $(#divid).show();
}); 
```

让我知道它是否有效。

# asp.net-mvc - 子字符串未按预期工作

> ID：13663299
> 
> 赞同：0
> 
> 时间：2012-12-01T20:13:19.683
> 
> 标签：asp.net-mvc, vb.net

这似乎是一个相当简单的问题，但我一直遇到同样的异常，我不知道为什么。

我只能假设它与对子字符串在 VB.NET 中的工作方式的误解有关。

以下代码不断抛出 ArgumentOutOfRange 异常：

```
 <%=Html.Encode(IIf(item.description.Length > 150, item.description.Substring(0, 150), item.description))%> 
```

现在这里应该发生的是，如果 item.description 超过 150 个字符，则输出前 150 个字符，否则输出整个字符串。问题是它不断尝试获取子字符串，而不管 if 语句的结果长度如何。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:18:42.260

请改用 If(expression,truepart,falsepart) 运算符：IIF 运算符尝试评估真假部分，而 If 运算符仅尝试评估相关部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:18:49.733

当您使用时，`IIF`您评估所有表达式 - 真和假的“分支”。

这意味着对于长度小于 150 个字符的字符串，您仍然调用`item.description.Substring(0, 150)`，从而导致错误。

也许有一个`item.ShortDescription`which 只返回前 150 个字符，使用普通的`IF/THEN`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:21:59.023

尝试使用：

检查这个：[IIf() 与 If](https://stackoverflow.com/questions/28377/iif-vs-if)

```
If(item.description.Length > 150) Then
  item.description.Substring(0, 150) 
Else 
  item.description
End If 
```

或者，

```
If(item.description.Length > 150, item.description.Substring(0, 150), item.description) 
```

# ruby-on-rails - Rails：单元助手测试。assert_select "a[class='current']" do |anchors| 中的 "anchors" 是什么意思？

> ID：13663301
> 
> 赞同：0
> 
> 时间：2012-12-01T20:13:27.933
> 
> 标签：ruby-on-rails

嗨，我目前正在阅读有关测试的教程。我们正在构建帮助方法来突出显示导航栏中的选项卡。以下是辅助方法。

```
module RecipesHelper
  def tabs(current_tab)
    content_tag(:div, links(current_tab), :id => "tabs")
  end

  def links(current_tab)
    nav_items.map do |tab_name, path|
      args = tab_name, path

      if tab_name == current_tab
         args << {:class => "current"}
      end
      link_to *args
    end.join(separator).html_safe
  end

  def nav_items
    {
      "New" => new_recipe_path,
      "List" => recipes_path,
      "Home" => root_path
    }
  end

  def separator
    content_tag(:span, "|", :class => "separator").html_safe
  end
end 
```

这是其中一项测试：

```
require 'test_helper'
class RecipesHelperTest < ActionView::TestCase
  test "current tab is correct" do
    render :text => tabs("New")
    assert_select "a[class='current']" do |anchors|
      anchors.each do |anchor|
        assert_equal new_recipe_path, anchor.attributes['href']
      end
    end
  end
end 
```

`anchors`我的问题是块中传递的变量是什么？与嵌套块相同的问题`anchor`。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:02:48.297

如果您阅读有关 assert_select 的文档，它将获得所有匹配元素的列表。在这种情况下`a[class='current']`，可能会返回一个标签（锚点）列表。

然后它遍历该列表和 assert_equal 如果该`href`单个 a 标记的属性匹配`new_recipe_path`

[assert_select 文档](http://apidock.com/rails/ActionController/Assertions/SelectorAssertions/assert_select)

# web - 为什么我的内容安全策略在除 Safari 之外的任何地方都有效

> ID：13663302
> 
> 赞同：10
> 
> 时间：2012-12-01T20:13:33.657
> 
> 标签：web, safari, content-security-policy

我已将我的安全策略定义为：

```
default-src 'self'; script-src 'self'; frame-src 'self';  style-src 'self' 'unsafe-inline'; 
```

（我仍然在几页的开头有 CSS）。

我对 Firefox 或 Chrome 没有任何问题（IE 还不支持 CSP），但是，当我尝试在 Safari 中进行测试时，我收到了一系列错误，例如：

```
Refused to load style from 'http://localhost/styles/alliance.css' because of Content-Security-Policy.
.
.
.
Refused to load image from 'http://localhost/images/Landing1.jpg' because of Content-Security-Policy.
.
.
.
Refused to load script from 'http://localhost/JQuery/jquery-1.7.2.min.js' because of Content-Security-Policy. 
```

图片应该被 default-src 覆盖，另外两个被列为“Self”，所以我不知道为什么 Safari 不接受我的图片和脚本。我没有 Mac，所以我在 Windows (5.1.7) 上使用 Safari。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-02T07:12:30.467

Safari 5 在实现 CSP 方面有点落后。Safari 6 要好得多，但我不认为它是为 Windows 发布的。我认为您只是看到了实现错误。如果 WebKit nightlies 可用于 Windows，那可能是一个很好的测试替代方案。

不过，老实说，我不建议将`X-WebKit-CSP`标头提供给 Safari 5。Safari 6，是的，但 5 有点太破了，无法真正使用。

另请注意，您可以简化您的政策。两者`script-src`和`frame-src`都会回落到`default-src`。`default-src 'self'; style-src 'self' 'unsafe-inline'`应该有同样的效果。

# iphone - 允许用户从免费版本中购买付费应用版本？

> ID：13663304
> 
> 赞同：4
> 
> 时间：2012-12-01T20:13:54.173
> 
> 标签：iphone, ios, app-store, in-app-purchase

有一个关于实施免费和付费版本应用程序的一般性问题。我现在已经设置好了，我在 1 个应用程序/项目中有 2 个目标，并且我用 def 语法指定了精简版和付费版本中的内容。它可以工作并运行两个目标。

1) 如何让用户直接从免费版购买付费应用？（发现多篇较早的文章说链接很好，其他人说会被拒绝，必须使用应用内购买）我可以使用绑定到标签栏项目或按钮的链接，像这样，

```
NSString *iTunesLink = @"http://itunes.apple.com/gb/app/wired-news-uk/id435728870?mt=8";
[[UIApplication sharedApplication]
 openURL:[NSURL URLWithString:iTunesLink]]; 
```

或者我是否需要为应用内购买实施 storekit？

2）我打算在底部放置一个新的标签栏项目（链接到付费版本）-尚未尝试，但我应该能够为免费版本设置标签栏，为付费版本设置另一种方式版本，对吗？本质上，隐藏标签栏项目以在升级后购买付费版本。

3）将每个应用程序（免费和付费）版本提交到应用程序商店 - 我假设我将能够设置目标并存档二进制文件以供上传，对吗？itunesconnect 中的两个单独的应用程序提交？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-01T20:48:40.880

我在应用商店中有几个 Lite/Paid 应用对（最初都是在 IAP 存在之前创建的）。多年来，我对这些应用程序进行了许多更新，所以如果你做得对，Apple 似乎对这个想法总体上没问题。

1）您实际上无法从免费应用程序中购买付费应用程序。您能做的最好的事情就是将用户发送到您的付费应用商店。

2）这应该工作。在我的一个应用程序中，我在主工具栏中有一个额外的图标，可将用户带到付费应用程序的应用商店页面。

3) 是的，您提交了两个完全独立的应用程序。您在 iTunes Connect 中设置了两个应用程序，每个应用程序都有自己唯一的应用程序 ID。

具有两个目标的单个项目是设置代码的简单且正确的方法。对我来说，我做了两个存档构建，在 iTunes Connect 中设置了两个应用程序或应用程序更新，然后将这两个应用程序/更新提交到 iTunes Connect。我总是让两个应用程序完美同步。Apple 似乎总是一起审查它们，并且总是在大约同一时间将它们推到商店。只有一次，两者相隔一两个多小时才获得批准。

您必须小心的主要事情是免费版本。它可以是“免费”或“精简版”，但不能是“演示”。免费版本必须完全正常运行。免费版本中没有任何 UI 元素被禁用，因为它们仅在付费版本中有效。它会被拒绝。如果它在免费版本中不起作用，请不要在免费版本中提及它。

我的大多数应用程序对，与付费版本相比，免费版本允许的数据有限。当用户尝试添加超出此点的数据时，我会弹出一个警报，并提醒他们免费版本有限制，并为他们提供升级的机会。除此之外，没有其他烦人的弹出窗口提供付费版本。可以在免费应用程序中有一个按钮或其他任何东西让用户升级，只是不要在 X 使用或时间后将其推到他们的脸上或弹出任何类型的提醒。应用程序的免费版本必须完全独立运行。

这是我对免费/付费应用对与 IAP 的对比：

IAP 的缺点： - IAP 没有促销代码 - 您不能在一段时间内免费提供 IAP（销售或其他） - 免费应用程序的评级往往较低，因为任何雅虎都可以下载。- IAP 的额外编码

免费/付费配对的缺点： - 两个目标，两个应用程序版本，两组图像，iTunes Connect 中的两组内容 - 拆分下载和评级/评论。

就个人而言，由于我已经这样做了好几年了，提交两个应用程序的额外努力是微不足道的。

编辑：

我忘了提一件事 - 仍然不能保证 Apple 会以这种方式接受这些应用程序。但是有很多这样的应用程序的例子，所以如果做得正确应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:20:59.367

如果你想拥有两个应用程序，那么你必须有两个具有不同应用程序 id-s 的技术独立提交。从同一个项目中获得它可能会很棘手，不确定是否可以使用两个目标来完成。从技术上讲，AppStore 规则不允许从免费版本中“追加销售”付费版本，但如果不是太激进，那么它可能会被批准。安全的解决方案是使用 InApp Purchase，这会给您带来很多好处：

*   相当容易实现
*   不需要两个应用程序代码库
*   您在 appstore 中有单个下载计数和项目

实际上，在应用内购买之前，这个包含两个独立应用的解决方案是有意义的，我今天看不出有多大意义。

# ios - 而不是 sizeToFit 我应该使用什么

> ID：13663309
> 
> 赞同：1
> 
> 时间：2012-12-01T20:14:50.167
> 
> 标签：ios, view, sizetofit

我正在开发一个主视图填满整个屏幕的应用程序。此主视图包含您可以将其视为精灵的子视图。他们使用自己的代码四处游荡。他们四处游荡的逻辑可能会让他们在屏幕外游荡。我想做的是调整主视图的大小，使其包含所有子视图。不过，实际上变化的并不是视图大小。正在改变的是缩放比例。有点像缩小谷歌地图视图。我怎么做？它将是触发此操作的手势识别器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:30:55.943

您应该使用三级视图层次结构来执行此操作：

*   顶层视图
    *   缩放视图
        *   精灵视图 0
        *   精灵视图 1
        *   精灵视图 2
        *   等等

设置缩放视图的边界以包含所有精灵视图的框架。然后设置缩放视图的变换，使其适合顶级视图。

```
- (void)updateBoundsAndTransformOfView:(UIView *)scaledView {
    CGRect scaledBounds = CGRectNull;
    for (UIView *spriteView in scaledView.subviews) {
        scaledBounds = CGRectUnion(scaledBounds, spriteView.frame);
    }

    scaledView.bounds = scaledBounds;
    // Now scaledView's size is large enough to contain all of its subviews,
    // and scaledView's coordinate system origin is at the left edge of the
    // leftmost sprite and the top edge of the topmost sprite.

    UIView *topLevelView = scaledView.superview;
    CGRect topLevelBounds = topLevelView.bounds;
    CGFloat xScale =topLevelBounds.size.width / scaledBounds.size.width;
    CGFloat yScale = topLevelBounds.size.height / scaledBounds.size.height;
    CGFloat scale = MIN(xScale, yScale);
    scaledView.transform = CGAffineTransformMakeScale(scale, scale);
    scaledView.center = CGPointMake(CGRectGetMidX(topLevelBounds), CGRectGetMidY(topLevelBounds));
} 
```

# ruby-on-rails - 浏览器地理位置回调多久触发一次？

> ID：13663311
> 
> 赞同：1
> 
> 时间：2012-12-01T20:15:01.070
> 
> 标签：ruby-on-rails, google-maps, geolocation, haml, gmaps4rails

我有来自 gmaps4rails 的以下代码，它不断使地图在移动浏览器中闪烁。`Gmaps.map.geolocationSuccess`我想知道回调触发的频率。地图在移动浏览器中闪烁是因为它真的经常刷新这个回调吗？

```
- content_for :scripts do
  :javascript
    Gmaps.map.geolocationSuccess = function(){
      var lng = Gmaps.map.userLocation.lng();
      var lat = Gmaps.map.userLocation.lat();
      //load map then add the markers
      $('.map_container').hide();
      $('.map_container').show();
      Gmaps.loadMaps();

      //add markers from controller
      Gmaps.map.addMarkers(#{@maps_json});

      var user_image = "http://wiki.alumni.net/wiki/images/thumb/5/55/Wikimap-blue-dot.png/50px-Wikimap-blue-dot.png";

      //add current location marker
      Gmaps.map.addMarkers([{
        "lng": lng,
        "lat": lat,
        "width":"40",
        "height":"48",
        "picture": user_image
      }]);

      //center the screen on your current location
      Gmaps.map.serviceObject.setCenter(new google.maps.LatLng(lat, lng));
      Gmaps.map.serviceObject.setZoom(14);
    }; 
```

# knockout.js - Dynamically created observables and computed values in Knockout

> ID：13663318
> 
> 赞同：2
> 
> 时间：2012-12-01T20:15:37.733
> 
> 标签：knockout.js

I have an observable array containing objects (dynamically created) that have themselves observable attributes. So far so god, but when I try to add a computed observable to the dynamically created object, the observables of the object resolve to undefined.

// Object whose model has an observable array and an instance of the dynamically generated objects

```
function SecretSanta(params) {
    ... 
    ko.applyBindings(new this.Model(this));
};

SecretSanta.prototype = {
    ...
    Model: function(secretSanta) {

        var self = this;
        this.secretSanta = secretSanta;
        this.newSanta = new Santa();

        this.santas = ko.observableArray();

        this.addSanta = function() {
            self.santas.unshift(new Santa(self.newSanta.getName(), self.newSanta.getEmail()));
            self.newSanta.clear();
        }

        this.removeSanta = function(santa) {
            self.santas.splice(self.santas.indexOf(santa), 1);
        };

        this.santasCount = ko.computed(function() {
            return self.santas().length;
        });

        this.valid = ko.computed(function() {
            return self.santasCount() >= self.secretSanta.VALID_SANTAS;
        });
    }
};

// Dynamically generated objects
function Santa(name, email) {
    var self = this;

    this.name = ko.observable(name);
    this.email = ko.observable(email);

    this.valid = ko.computed(function () {      
        return self.name().match(/\w{3,}/);
    });     
} 
```

In the last line of code the console is complaining that self.name() is undefined; if i get rid of the computed initialization and set this.valid to the function inside, it works fine (but the bindings do not get update).

Can any one point out what i am doing wrong?. Thanks a lot in advance.

I provide a link to the complete code [http://jsfiddle.net/jeAtT/5/](http://jsfiddle.net/jeAtT/5/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:45:39.050

计算的 observable 在您创建它们时会立即进行评估。在创建时， 的值`self.name()`是未定义的。所以，你`match`不能取消未定义。

一种选择是初始化您的名称，例如：

```
this.name = ko.observable(name || ""); 
```

# ruby-on-rails - Multiple scope uniqueness validation

> ID：13663323
> 
> 赞同：9
> 
> 时间：2012-12-01T20:15:47.157
> 
> 标签：ruby-on-rails, activerecord

I wanted to clarify the behavior of multi-scope uniqueness validation. The [documentation](http://api.rubyonrails.org/classes/ActiveRecord/Validations/ClassMethods.html) says:

> Or even multiple scope parameters. For example, making sure that a teacher can only be on the schedule once per semester for a particular class.

```
class TeacherSchedule < ActiveRecord::Base
  validates_uniqueness_of :teacher_id, :scope => [:semester_id, :class_id]
end 
```

My understanding of this is that I could have a teacher teaching two classes in the same semester but not the same class, and I could have a teacher teaching the same class in different semesters. Is this correct? All 3 fields must match some existing record in order for validation to fail?

Is there a way to validate it so that it fails if either semester_id or class_id matches?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-01T20:19:41.873

> My understanding of this is that I could have a teacher teaching two classes in the same semester but not the same class, and I could have a teacher teaching the same class in different semesters. Is this correct? All 3 fields must match some existing record in order for validation to fail?

Yes, this is correct. Thing about it as "for every unique value of `scope`, the field can only show up once." When `scope` is an array, a "unique value for scope" is a combination of the fields' values.

> Is there a way to validate it so that it fails if either semester_id or class_id matches?

So a teacher should never teach twice in a semester, and also should never ever teach the same class, even in a different semester? That doesn't seem right, but you could do that with a validation on each:

```
class TeacherSchedule < ActiveRecord::Base
  validates_uniqueness_of :teacher_id, :scope => :semester_id
  validates_uniqueness_of :teacher_id, :scope => :class_id
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-04T10:26:28.073

我刚刚了解了唯一性验证如何与范围一起工作，我想与大家分享。

假设您在组织中有多个部门，并且任何员工也可以同时属于两个或多个部门。为了确保员工的电子邮件 ID 在每个部门中是唯一的，我们使用范围。

通过这样做，我们可以确保没有两个具有相同电子邮件地址的员工在同一个部门工作。我们还可以找出特定员工所在的所有部门。

简单来说，使用范围的唯一性验证适用于两个属性（在我们的例子中是电子邮件，部门）。

# java - Regular expression : "is followed by a slash or is the end of the line"

> ID：13663329
> 
> 赞同：2
> 
> 时间：2012-12-01T20:16:20.293
> 
> 标签：java, regex

Using Java, I'm trying to write a regular expression that would parse another regular expression. I want to extract the *named groups* from the source regular expression (those represent parameters separated by slashes in an URL). Also, the source string may or may not start and end with a slash.

For example, for both source strings :

`(?<name>john)/(?<facet>aaa/bbb/ccc/?)`

and

`/(?<name>john)/(?<facet>aaa/bbb/ccc/?)/`

I'd like a regular expression that would extract those as named groups:

`(?<name>john)` and `(?<facet>aaa/bbb/ccc/?)`

I tried :

```
(^|.*/)(?<param>\(\?<[^>]+>[^\)]+\))(/.*|$) 
```

But this only returns `(?<name>john)` as a group named "param", not `(?<facet>aaa/bbb/ccc/?)`!!

When I remove the `(/.*|$)` part, both are returned! But I want this ending condition to make sure a param is followed by a slash or is at the end of the line...

Do you have any idea why `(/.*|$)` prevents the second param to be found?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:20:31.530

环顾四周是你的朋友：`(?=\/|\n)`

这是您需要的一个小例子。[例子](http://regex101.com/r/qX4mE2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:21:00.533

您可以使用以下正则表达式： -

```
"(?:/|^)(\\(\\?<.*?>.*?\\))(?=/|$)" 
```

并使用`Matcher@find`方法提取所有匹配项。

```
String str = "(?<name>john)/***(?<facet>aaa/bbb/ccc/?)/(?<not>aaa/bbb/?)***";
Matcher matcher = Pattern.compile("(?:/|^)(\\(\\?<.*?>.*?\\))(?=/|$)").matcher(str);

while (matcher.find()) {
    System.out.println(matcher.group(1));
} 
```

**输出 ： -**

```
(?<name>john) 
```

最后一个不打印，因为它后面没有 a`slash`也没有`end of line`。

# python - Python: Searching for Unicode string in HTML with index/find returns wrong position

> ID：13663330
> 
> 赞同：1
> 
> 时间：2012-12-01T20:16:36.543
> 
> 标签：python, html

I am trying to parse the number of results from the HTML code returned from a search query, however when I use find/index() it seems to return the wrong position. The string I am searching for has an accent, so I try searching for it in Unicode form.

A snippet of the HTML code being parsed:

```
<div id="WPaging_total">
  Aproximádamente 37 resultados.
</div> 
```

and I search for it like this:

```
str_start = html.index(u'Aproxim\xe1damente ')
str_end = html.find(' resultados', str_start + 16)#len('Aproxim\xe1damente ')==16
print html[str_start+16:str_end] #works by changing 16 to 24 
```

The print statement returns:

```
damente 37 
```

When the expected result is:

```
37 
```

It seems str_start isn't starting at the beginning of the string I am searching for, instead 8 positions back.

```
print html[str_start:str_start+5] 
```

Outputs:

```
l"> 
```

The problem is hard to replicate though because it doesn't happen when using the code snippet, only when searching inside the entire HTML string. I could simply change str_start+16 to str_start+24 to get it working as intended, however that doesn't help me understand the problem. Is it a Unicode issue? Hopefully someone can shed some light on the issue.

Thank you.

**LINK:** [http://guiasamarillas.com.mx/buscador/?actividad=Chedraui&localidad=&id_page=1](http://guiasamarillas.com.mx/buscador/?actividad=Chedraui&localidad=&id_page=1)

**SAMPLE CODE**:

```
from urllib2 import Request, urlopen

url = 'http://guiasamarillas.com.mx/buscador/?actividad=Chedraui&localidad=&id_page=1'
post = None
headers = {'User-Agent':'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2)'}          
req = Request(url, post, headers)
conn = urlopen(req)

html = conn.read()

str_start = html.index(u'Aproxim\xe1damente ')
str_end = html.find(' resultados', str_start + 16)
print html[str_start+16:str_end] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T21:40:19.963

您的问题最终归结为这样一个事实，即在 Python 2.x 中，`str`类型表示字节序列，而`unicode`类型表示字符序列。因为一个字符可以由多个字节编码，这意味着字符串的`unicode`-type 表示的长度可能与`str`同一字符串的 -type 表示的长度不同，并且以同样的方式，`unicode`表示上的索引字符串的 可能指向文本的不同部分，而不是`str`表示上的相同索引。

发生的情况是，当你这样做时`str_start = html.index(u'Aproxim\xe1damente ')`，Python 会自动解码`html`变量，假设它是用 utf-8 编码的。（好吧，实际上，在我的 PC 上，`UnicodeDecodeError`当我尝试执行该行时，我只是得到一个。我们的一些与文本编码相关的系统设置肯定是不同的。）因此，如果`str_start`是 n 那么这意味着`u'Aproxim\xe1damente '`出现在第*n 个字符*处HTML。但是，当您稍后将其用作切片索引以尝试获取第 (n+16)th 个字符之后的内容时，您实际上得到的是第*(n+16)th 字节*之后的内容，在这种情况下不是等效，因为页面的早期内容具有重音字符，在以 utf-8 编码时占用 2 个字节。

最好的解决方案是在收到 html 时将其转换为 unicode。对您的示例代码的这个小修改将做您想要的，没有错误或奇怪的行为：

```
from urllib2 import Request, urlopen

url = 'http://guiasamarillas.com.mx/buscador/?actividad=Chedraui&localidad=&id_page=1'
post = None
headers = {'User-Agent':'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2)'}          
req = Request(url, post, headers)
conn = urlopen(req)

html = conn.read().decode('utf-8')

str_start = html.index(u'Aproxim\xe1damente ')
str_end = html.find(' resultados', str_start + 16)
print html[str_start+16:str_end] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:45:03.720

目前还不清楚您要做什么，但是如果我猜对了，您正在尝试从 HTML 文件中获取大致的结果数量，那么您可能会更好，因为您使用该`re`模块常用表达。

```
import re
re.search(ur'(?<=Aproxim\xe1damente )\d+', s).group(0)

# returns:
#   u'37' 
```

最终，您最好的选择实际上是一个类似`lxml`or的包`BeautifulSoup`，但如果没有更多上下文，我无法为您提供更具体的帮助。

# jquery - Jquery EasyUI data grid save changes into database

> ID：13663332
> 
> 赞同：0
> 
> 时间：2012-12-01T20:16:46.237
> 
> 标签：jquery, jquery-easyui

I am using jquery EasyUi data grid. As per documentation at [http://www.jeasyui.com/tutorial/datagrid/datagrid12.php](http://www.jeasyui.com/tutorial/datagrid/datagrid12.php)

I have build up the datagrid. Now what I want is there is a function acceptchanges in datagrid I want to save all the table changes in one go. And I need it urgent wanted to deploy project by tomorrow. Any suggestion ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T20:36:34.697

```
var rows = $('#dg').datagrid('getRows');
$.each(rows, function(i, row) {
  $('#dg').datagrid('endEdit', i);
  var url = row.isNewRecord ? 'test.php?savetest=true' : 'test.php?updatetest=true';
  $.ajax(url, {
      type:'POST',
      dataType: 'json',
      data:row
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:33:36.053

当用户点击时，您可以简单地更新每一行`save`。`saverow(target)`在演示的函数中，`target`是保存链接，因此您可以使用以下命令获取该行：

```
function saverow(target){

    var $row=$(target).closest('tr');
    /* map text of each cell to an array*/
    var cellData= $row.find('td').map(function(){
         return $(this).text();
    }).get();

     /* send array to server*/

    $.post('upDateUrl', { rowData : cellData}, function(response){
         /* do something with response*/
    })
}; 
```

# java - Error when trying to get sun.runtime.Name is undefined

> ID：13663333
> 
> 赞同：2
> 
> 时间：2012-12-01T20:16:54.220
> 
> 标签：java, coldfusion

I am trying to get some info on the internal of my ColdFusion site

```
struct function get_site_info() output="false"  {

var oSystem = createObject('java','java.lang.System');
var jremodel    = oSystem.getProperty("sun.arch.data.model");
var jrename     = oSystem.getProperty("sun.runtime.name");
var jreversion  = oSystem.getProperty("sun.runtime.version");

var stResult = {CFVERSION = server.ColdFusion.ProductVersion, 
    CFLEVEL = server.ColdFusion.ProductLevel,
    JRENAME = jrename, // Error happens here
    JREVERSION = jreversion };

return stResult;
} 
```

The error message is

```
Variable JRENAME is undefined. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:36:19.360

没有像“sun.runtime.name”这样的属性（或者实际上是 sun.runtime.anything）。

您可能想要**java.runtime.name**。

要查看系统的所有可用属性，请执行以下操作：

```
<cfdump var=#createObject('java','java.lang.System').getProperties()# /> 
```

# application-pool - 'DefaultAppPool' is being automatically disabled due to a series of failures

> ID：13663334
> 
> 赞同：8
> 
> 时间：2012-12-01T20:17:04.740
> 
> 标签：application-pool, user-profile, iis-8, applicationpoolidentity

Having a tough time with this issue. Not sure how but my ApplicationPoolIdentity is broken.

Currently I'm running IIS 8 on Windows 8 with Visual Studio 2012\. When trying to debug an application from Visual Studio, or just navigating to the site in a browser I get the following error logged and a 503 error.

```
Application pool 'DefaultAppPool' is being automatically disabled due to a series of failures in the process(es) serving that application pool. 
```

If I check out the Application error logs, I find the following error from the **User Profile Service**.

```
Windows cannot log you on because your profile cannot be loaded. Check that you are connected to the network, and that your network is functioning correctly. 

 DETAIL - The system cannot find the path specified. 
```

Upon looking into the details I find that the **User Profile Service** is trying to load up a profile with the Id

S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415

Now I opened up the registry to try and find the profile with that UserId. However there's nothing in the Profile list that helps.

![No profile with the ID here](../Images/79905478b3c15676c77b164f999d288d.png)

So digging around a little more I've found that this issue can be resolved by either

A) Set the **Load User Profile** of the Application Pool to false.

B) Use a different account for the application pool.

C) Fix the account.

Seeing how this is the built in account, I'd prefer to fix the issue rather than fix the sympton.

What I have tried

*   aspnet_regiis -i
*   Removing IIS from windows and reinstalling.
*   Attempted to follow the guide [here](http://setspn.blogspot.ca/2012/09/temporary-profiles-and-iis-application.html) but I don't know the account password :P

My hunch

Somehow the ApplicationPoolIdentity got messed up. Is there any physical folders for the built-in accounts? I know that the Network and Local service profiles physical directories exist at **C:\Windows\ServiceProfiles\**. It is possible to recreate the ApplicationPoolIdentity profile? Or am I way off on what the real issue is?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T18:07:43.553

C）这是我在 regedit 中修复帐户的方法

> HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList

有一个名为“默认”的设置。您必须确保数据值指向驱动器上的现有目录。默认情况下，它包含“%SystemDrive%\Users\Default”。在我的公司中，默认更改为自定义配置文件。不知何故，有人删除了该用户个人资料。因此，当 defaultAppPool 用户尝试为自己创建帐户时，它无法这样做，因为 windows 无法为他提供默认用户配置文件。

您还可以在查看应用程序文件夹下的事件查看器时诊断此错误。您将收到该类型的消息：

> Windows 找不到本地配置文件，正在使用临时配置文件登录。您对此配置文件所做的更改将在您注销时丢失。

# php - dynamic custom menu php

> ID：13663336
> 
> 赞同：0
> 
> 时间：2012-12-01T20:17:24.117
> 
> 标签：php, web

trying to get some thing like that dynamically

```
<ul>
<li><a href="index.php">Home</a></li>
<li><a href="about.php">About Us</a></li>
<li><a href="#">Academics</a>
    <ul style="overflow: hidden; display: block; height: 0px; z-index: 51; opacity: 0.00980392;">
        <li><a href="bscs.php">Bs Computer Science</a></li>
        <li><a href="dit.php">Diplomas (DIT &amp; DCHE)</a></li>
        <li><a href="mbait.php">MBAIT</a></li>
    </ul>
</li>
<li><a class=" " href="#">College</a>
</ul> 
```

the code is

```
<?php 
//========================================================
$result = mysql_query("    SELECT id, parentId, name
    FROM
        menu
    ORDER BY
        parentId, name");

$menuData = array(
    'items' => array(),
    'parents' => array()
);

while ($menuItem = mysql_fetch_assoc($result))
{
    $menuData['items'][$menuItem['id']] = $menuItem;
    $menuData['parents'][$menuItem['parentId']][] = $menuItem['id'];
}

function buildMenu($parentId, $menuData)
{
    $html = '';

    if (isset($menuData['parents'][$parentId]))
    {
        $html = '<ul id="main_menu">';
        foreach ($menuData['parents'][$parentId] as $itemId)
        {
            $html .= '<li>' . $menuData['items'][$itemId]['name'];

                // find childitems recursively
                $html .= buildMenu($itemId, $menuData);

            $html .= '</li>';
        }
        $html .= '</ul>';
    }

    return $html;
}

// output the menu
echo buildMenu(0, $menuData); 
//=======================================================
 ?> 
```

above code is showing only first parents elements in the menu and the remaing elements are not showing.. the menu is not working correctly becoz of the class id is not given in the ul tag.. and by writing this

```
echo '<ul id="main_menu">';
// output the menu
echo buildMenu(0, $menuData); 
echo "</ul>"; 
```

it shows nothing in the menu

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:29:49.987

好的，试试这个：

```
<?php

//========================================================
$result = mysql_query("    SELECT id, parentId, name, link
    FROM
        menu
    ORDER BY
        parentId, name");

$menuData = array(
    'items' => array(),
    'parents' => array()
);

while ($menuItem = mysql_fetch_assoc($result)) {
    $menuData['items'][$menuItem['id']] = $menuItem;
    $menuData['parents'][$menuItem['parentId']][] = $menuItem['id'];
}

function buildMenu($parentId, $menuData)
{
    $html = '';

    if (isset($menuData['parents'][$parentId]) && count( $menuData['parents'][$parentId] ) > 0 ) {
       if( $parentId == "0" ){
          $html = '<ul id="main_menu">';
        }else{
          $html = '<ul id="sub_menu">';
        }
        foreach ($menuData['parents'][$parentId] as $itemId) {
            $html .= '<li>';
            $html .= strlen($menuData['items'][$itemId]['link']) > 2?
                     '<a href="'.$menuData['items'][$itemId]['link'].'">'.$menuData['items'][$itemId]['name'].'</a>':
                     $menuData['items'][$itemId]['name'];
            $html .= buildMenu($itemId, $menuData);
            $html .= "</li>";
        }
        $html .= '</ul>';
    } else {

        $html .= '<li>' . $menuData['items'][$parentId]['name'].'</li>';
    }

    return $html;
}

// output the menu
echo buildMenu(0, $menuData);
//=======================================================

?> 
```

# javascript - 使 SVG 变换矩阵围绕其中心旋转

> ID：13663343
> 
> 赞同：2
> 
> 时间：2012-12-01T20:18:32.667
> 
> 标签：javascript, math, matrix, svg, transform

HTML

```
<rect id="red" style="fill: red;" height="100" width="20"></rect> 
```

JS

```
var layer = 
{  
    sizeReal   : { "width": 20, "height": 100 }                   
,   sizeScaled : { "width": 10, "height": 50 }
,   position   : { "x": 200, "y": 200 } 

,   scale      : 0.5
,   rotation   : 0
,   matrix     : [ 1, 0, 0, 1, 0, 0 ]
};

// Not sure if its the cleanest way but it works it rotates itself arounds its center.
//
$("#red")[0].setAttribute( 'transform', 'translate(' + layer.position.x + ',' + layer.position.y +') rotate(' + layer.rotation +',' + ( layer.sizeScaled.width  / 2 ) + ',' + ( layer.sizeScaled.height / 2 ) + ') scale(' + layer.scale + ',' + layer.scale +')' ) 
```

现在我只想对矩阵做同样的事情。我正在使用 sylvester 来乘以矩阵。

我做了一个小提琴来澄清问题:)

[http://jsfiddle.net/xYsHZ/3/](http://jsfiddle.net/xYsHZ/3/)

我希望红色矩形的行为与绿色矩形相同。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T11:52:35.150

固定的！！矩阵元素的顺序错误:)

```
$("#red")[0].setAttribute( 'transform', 'matrix(' + layer.matrix[ 0 ][ 0 ] + ',' + layer.matrix[ 1 ][ 0 ] + ',' + layer.matrix[ 0 ][ 1 ] + ',' + layer.matrix[ 1 ][ 1 ] + ',' + layer.matrix[ 0 ][ 2 ] + ',' + layer.matrix[ 1 ][ 2 ] + ')' );
},50); 
```

[http://jsfiddle.net/6DR3D/2/](http://jsfiddle.net/6DR3D/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T02:14:29.093

问题是`rotate(angle, x, y)`通话。此调用围绕点 (x,y) 以给定角度旋转。但相反，您构建矩阵以围绕 layer.position 旋转。

为了相对于对象围绕给定点 (x,y) 旋转，您需要先平移到 (-x,-y)，然后旋转，然后再平移回 (x,y)。

所以如果你有一个矩阵乘法函数 Mul 它可能看起来像这样：

```
var m1 = GetMatrix(0, 0, {"x":-layer.sizeScaled.width/2, "y":-layer.sizeScaled.height/2});
var m2 = GetMatrix(layer.rotation, layer.scale, layer.position);
var m3 = GetMatrix(0, 0, {"x":layer.sizeScaled.width/2, "y":layer.sizeScaled.height/2});

var m = Mul(Mul(m3,m2), m1); //i.e. apply the matricdes in order m1, then m2, then m3 
```

# c# - 让查询使用参数和“喜欢”

> ID：13663348
> 
> 赞同：3
> 
> 时间：2012-12-01T20:18:55.983
> 
> 标签：c#, asp.net, sql

我已经看到了很多关于在 Sql 查询和“like”中使用参数的问题，但我已经尝试了所有我见过的编码方式，但仍然无法让我的查询给出结果。如果我在查询本身中输入一个值，它运行良好。当我运行列出的第一个查询时，我收到错误“必须声明标量变量“@Search”，但我认为我是使用 cmd.Parameters.AddWithValue 语句做到的。谁能看到我可能做错了什么？感谢任何帮助.

```
 //Declare the connection object
        SqlConnection Conn = new SqlConnection();
        Conn.ConnectionString = ConfigurationManager.ConnectionStrings["MyDatabase"].ConnectionString;

        //Connect to the db
        Conn.Open();

        //Define query

        //This query doesn't work
        string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE (State LIKE '%' + @Search + '%')";

        //This query doesn't work either
        string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE State LIKE @Search";

        //This query works
        string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE State LIKE 'MI'";

        //Declare the Command
        SqlCommand cmd = new SqlCommand(sql, Conn);

        //Add the parameters needed for the SQL query
        cmd.Parameters.AddWithValue("@Search", "%" + txtSearch.Text + "%");           

        //Declare a SQL Adapter
        SqlDataAdapter da = new SqlDataAdapter(sql, Conn);

        //Declare a DataTable
        DataTable dt = new DataTable();

        //Populate the DataTable
        da.Fill(dt);

        //Bind the Listview
        lv.DataSource = dt;
        lv.DataBind();

        dt.Dispose();
        da.Dispose();
        Conn.Close(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-01T20:22:40.673

在上面的代码中，您没有使用 SqlDataAdapter 中的参数，在下面的代码中，您将在命令中使用 SqlDataAdapter。

```
 //This query doesn't work
    string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE (State LIKE @Search)";

    //Declare the Command
    SqlCommand cmd = new SqlCommand(sql, Conn);

    //Add the parameters needed for the SQL query
    cmd.Parameters.AddWithValue("@Search", "%" + txtSearch.Text + "%"); 

  //Declare a SQL Adapter
    SqlDataAdapter da = new SqlDataAdapter();

    **sa.SelectCommand = cmd** 
```

如果您不想使用参数化查询，这将起作用：

```
 //Declare the connection object
    //This query doesn't work
    string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE (State LIKE '%" + **txtSearch.Text** + "%')";

  //Declare a SQL Adapter
    SqlDataAdapter da = new SqlDataAdapter(sql, conn); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-01T20:58:42.367

您的主要问题是您没有使用由于此构造函数而构建的命令

```
SqlDataAdapter da = new SqlDataAdapter(sql, Conn); 
```

因此，您也没有使用参数，唯一有效的查询是不使用任何参数的查询（第三个）。您应该改用此构造函数（使用创建的构造函数`SqlCommand`）

```
SqlDataAdapter da = new SqlDataAdapter(cmd); 
```

更改正在使用的构造函数后，将应用以下任一查询：

```
string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE State LIKE @Search";
...
cmd.Parameters.AddWithValue("@Search", "%" + txtSearch.Text + "%"); 
```

或这个：

```
string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE State LIKE '%' + @Search + '%'";
...
cmd.Parameters.AddWithValue("@Search", txtSearch.Text); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-01T20:33:37.083

```
string sql = "SELECT CustomerID, LastName, FirstName, Email, Password, Address1, Address2, City, State, Zip, Phone, Fax FROM Customer WHERE (State LIKE '%' + @Search + '%')";

cmd.Parameters.AddWithValue("@Search",txtSearch.Text); 
```

这应该工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-27T08:02:12.977

除了接受的答案，不要忘记用方括号替换你的 _, % 。否则它仍然会给出错误的结果。

```
txtSearch.Text.Replace("_","[_]").Replace("%","[%]") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T20:42:08.670

您可以使用 SqlDataReader 而不是使用 SqlDataAdapter

```
SqlDataReader myReader = cmd.ExecuteReader();

DataTable dt = new DataTable();
dt.Load(myReader); 
```

您会在您的代码中注意到，该参数附加到 cmd 上，但实际上并未使用该参数，因此 SqlDataAdapter 不知道该参数。

# android - 在 eclipse logcat 中导出过滤器

> ID：13663353
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:20:06.053
> 
> 标签：android, eclipse, filtering, logcat

有什么方法可以导出/恢复 logcat 的过滤器。我问的原因是我使用的计算机不止一台，而且我有很多不同的过滤器来调试我的应用程序，所以我想避免在每台计算机上手动输入数百个过滤器。

如果在 Eclipse 中使用用于 android 开发的默认工具无法做到这一点，是否还有其他具有此功能的 Eclipse 日志插件？

在此之后我进行了一些谷歌搜索，但找不到任何关于该主题的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:45:35.960

`logcat.view.filters.list`您可以将in的值从一个工作区复制`<workspace>/.metadata/.plugins/org.eclipse.core.runtime/.settings/com.android.ide.eclipse.ddms.prefs`到另一个工作区，它们将共享相同的配置。

# templates - 如何更改 Accounts-UI 模板？

> ID：13663354
> 
> 赞同：4
> 
> 时间：2012-12-01T20:20:05.873
> 
> 标签：templates, overriding, meteor, user-accounts

根据[Telescope](http://demo.telesc.pe/)示例（[源代码](https://github.com/SachaG/Telescope)），可以显示自定义帐户 UI 表单（参见他的[user_signin.html](https://github.com/SachaG/Telescope/blob/master/client/views/users/user_signin.html)）并使用`{{loginButtons}}`（参见他的[nav.html](https://github.com/SachaG/Telescope/blob/master/client/views/common/nav.html)）默认保留其他内容`Accounts-UI package`。

我正在寻找 2 小时这是怎么可能的。知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T02:18:10.200

[您可以使用Accounts.ui.config](http://docs.meteor.com/#accounts_ui_config)配置 Accounts UI 。例如：

```
Accounts.ui.config({
  requestPermissions: {
    facebook: ['user_likes'],
    github: ['user', 'repo']
  },
  passwordSignupFields: 'USERNAME_AND_OPTIONAL_EMAIL'
}); 
```

# javascript - Open div panel inbetween two tweets?

> ID：13663355
> 
> 赞同：0
> 
> 时间：2012-12-01T20:20:10.320
> 
> 标签：javascript, jquery, html, twitter

I'm working on a UI that has Twitter feeds. I want to be able to open a panel in the middle of two tweets, pushing the tweet below downwards. This functionality can be seen in tweet clients like TweetBot. As each new tweet in the stream popped up it would push each one below it down as well. Tool bar would be the same for all tweets.

Here is what I have for the JS:

```
$(document).ready(function() {
    hidden = true;
    $("div#tweetcontainer").click(function() {
        if (hidden == false) {
            $("div#toolbar").slideUp('fast');
            hidden = true;
        } else {
            $("div#toolbar").slideDown('fast');
            hidden = false;
        }
    });
});​ 
```

Here is the markup of the HTML:

```
 <div id="wrapper">
    <!------------- Indivdual Tweet -------------------------->
<div id="tweetcontainer">
<div id="avatarcontainer">
  <div id="avatar"></div>
</div>
<div id="content">
  <div id="tweetheader">
    <div id="name">
      <h1>John Drake</h1>
    </div>
    <div id="tweethandle">
      <h2>@Drakejon</h2>
    </div>
    <div id="tweettime">10m</div>
  </div>
  <div>
    <p>Exceptional Buys Ranger To Give Monitoring Shot In The Arm To Its 'DevOps' Platform <a href="http://tcrn.ch/11m3BrO">http://tcrn.ch/11m3BrO</a> by <a href="#">@sohear</a> </p>
  </div>
</div>
</div>
<!------------- Indivdual Tweet 2 -------------------------->
<div id="tweetcontainer">
<div id="avatarcontainer">
  <div id="avatar"></div>
</div>
<div id="content">
  <div id="tweetheader">
    <div id="name">
      <h1>John Drake</h1>
    </div>
    <div id="tweethandle">
      <h2>@Drakejon</h2>
</div>
    <div id="tweettime">10m</div>
  </div>
  <div>
    <p>Exceptional Buys Ranger To Give Monitoring Shot In The Arm To Its 'DevOps' Platform <a href="http://tcrn.ch/11m3BrO">http://tcrn.ch/11m3BrO</a> by <a href="#">@sohear</a> </p>
  </div>
</div>
</div>

<!-------------Tool Bar -------------------------------->
<div id="toolbar">
<div class="toolset">reply</div>
<div class="toolset">Retweet</div>
<div class="toolset">Favorite</div>
<div class="toolset">Track</div>
<div class="toolset">Details</div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:38:27.987

做

```
$toolbar = $(.toolbar).clone();
$(this).after($toolbar); 
```

我想你将不得不做类似的事情

```
$(.toolbar).addClass("hidden"); 
```

在将其附加到 div 之前，然后执行

```
if ($(.toolbar)).hasClass("hidden"){
    ...pulldown...
} 
```

或保持它消失并在附加后使其下拉的东西。

# android - Android - ExpandableListView 中的 CheckedTextView/CheckBoxes

> ID：13663358
> 
> 赞同：0
> 
> 时间：2012-12-01T20:20:49.600
> 
> 标签：android, checkbox, expandablelistview, checkedtextview

我试过浏览互联网，但我通常根本不明白如何实现这一点。

我拥有的是一个有很多类别的测验应用程序，有些类别是子类别。这是一个典型的示例列表：

动物

*   小狗
*   猫
*   大象

国家

水果

蔬菜

*   萝卜
*   土豆

我希望能够展开和折叠动物和蔬菜，以便可以选择其中的各个类别。也可以选择没有子项目的类别。

我认为最好使用带有checkedtextviews 或复选框的expandablelistview。有没有人有一个教程的链接可以告诉我如何做到这一点，或者如果它不是太麻烦告诉我如何做到这一点？

非常感谢

# sql - SQL 从视图中创建过程

> ID：13663360
> 
> 赞同：0
> 
> 时间：2012-12-01T20:20:58.453
> 
> 标签：sql, procedure

这是一个 SQL 视图，显示与 ID 为“2”的书在同一书架上的图书数量。有没有一种简单的方法可以将其转换为可以输入图书 ID 的过程，而不是默认 ID 为“2”？我还没有冒险进入程序，这个特定的程序会涉及很多编码吗？

```
 SELECT COUNT(*) FROM books
    WHERE shelf_id = (SELECT shelf_id FROM books WHERE book_id = 2) 
```

子查询是因为 Book 表有书架 ID，但书架不包含书架 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:27:32.187

您的代码可能如下所示：-

```
CREATE PROCEDURE spBooks(@BookID integer)
AS
SELECT COUNT(*) FROM books
    WHERE shelf_id = (SELECT shelf_id FROM books WHERE book_id = @BookID)
GO; 
```

那应该创建您想要的存储过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:29:36.750

如果是 Oracle，请尝试以下操作：

```
 PROCEDURE GET_BOOK_COUNT(
        i_book_id            IN  books.book_id%TYPE,
        o_count              OUT NUMBER)
      AS
      BEGIN
            SELECT COUNT(*) INTO o_count  FROM books
            WHERE shelf_id = 
                         (SELECT shelf_id FROM books WHERE book_id = i_book_id );
      END GET_BOOK_COUNT; 
```

但最好将其设为 a`function`而不是`procedure`as：

```
 FUNCTION GET_BOOK_COUNT(
        i_book_id            IN  books.book_id%TYPE)
            RETURN NUMBER
            IS
            l_count Number;
            SELECT COUNT(*) INTO l_count  FROM books
            WHERE shelf_id = 
                         (SELECT shelf_id FROM books WHERE book_id = i_book_id );
            RETURN l_count;
      END GET_BOOK_COUNT; 
```

# filepicker.io - 位图图像的图像转换失败

> ID：13663364
> 
> 赞同：0
> 
> 时间：2012-12-01T20:21:12.440
> 
> 标签：filepicker.io

BMP 图像在这里：[https ://www.filepicker.io/api/file/fdsYv4NSaCGUefBAQmER](https://www.filepicker.io/api/file/fdsYv4NSaCGUefBAQmER)

以及重现失败的代码：

```
var fpfile = { url: 'https://www.filepicker.io/api/file/fdsYv4NSaCGUefBAQmER',
    文件名：'customers.jpg'，mimetype：'image/jpeg'，isWriteable：false，大小：629454}；
console.log("正在转换...");
/*我们可以显示结果图像的元素*/
var result = document.getElementById("convert-result");
filepicker.convert(fpfile, {宽度: 200, 高度: 200},
    函数（new_FPFile）{
        控制台.log(new_FPFile.url);
        结果.src = new_FPFile.url;
    }
);

```

不清楚我在这里做错了什么，任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T05:10:09.003

我们目前不支持 .bmp 进行转换，但我们正在添加它。

# vba - 将变量数组转储到范围 - VBA excel错误1004

> ID：13663370
> 
> 赞同：5
> 
> 时间：2012-12-01T20:21:47.040
> 
> 标签：vba, vba, excel, excel-2003

我正在为 Excel 使用[vba](/questions/tagged/vba "显示标记为“vba”的问题")，以便通过以下方式将数据保存到数组中：

```
Dim allPosts As Variant
allPosts = Range("A2:J5000") 
```

之后，我正在更改`allPosts`数组中的数据，然后我想通过以下方式将其粘贴回来：

```
Range("A2:J5000").Value = allPosts 
```

我收到错误：

> 运行时错误 1004 应用程序定义或对象定义

并且复制在特定单元格处停止，当我**将此单元格处的字符串更改为更短时**，问题就解决了。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-02T00:49:20.373

您可以使用第二个数组来存储太长的单元格长度，并分别迭代这些

从[这篇 Microsoft 支持文章中](http://support.microsoft.com/default.aspx?scid=kb;en-us;818808&Product=xl2003&wa=wsignin1.0) [，excel-2003](/questions/tagged/excel-2003 "显示标记为“excel-2003”的问题")无法处理写回长度超过**911**个字符的数组字符串， [excel-2010](/questions/tagged/excel-2010 "显示标记为“excel-2010”的问题")在我的测试中运行良好）

下面的代码：

1.  设置在范围内读取的主要变体数组
2.  设置与第一个数组大小相等的第二个空白变量
3.  测试数组的每个部分的单元格长度是否超过 911 个字符，然后
    *   操作第一个数组中较短的值，或者，
    *   从第一个数组中删除值，然后将其写入第二个数组
4.  第一个数组一次性转储回范围
5.  第二个数组逐个单元迭代以转储其他字符串

**代码**

```
 Sub KudosRickyPonting()
    Dim allPosts As Variant
    Dim allPosts2 As Variant
    Dim vStrs As Variant
    Dim lngRow As Long
    Dim lngCol As Long
    allPosts = Range("A2:J5000").Value2
    ReDim allPosts2(1 To UBound(allPosts, 1), 1 To UBound(allPosts, 2))

    For lngRow = 1 To UBound(allPosts, 1)
        For lngCol = 1 To UBound(allPosts, 2)
            If Len(allPosts(lngRow, lngCol)) < 912 Then
                allPosts(lngRow, lngCol) = "Updated:" & allPosts(lngRow, lngCol)
            Else
                allPosts2(lngRow, lngCol) = "NEW PART " & allPosts(lngRow, lngCol)
                'erase long value from first array
                allPosts(lngRow, lngCol) = vbNullString
            End If
        Next
    Next
    Range("A2:J5000").Value = allPosts

    For lngRow = 1 To UBound(allPosts2, 1)
        For lngCol = 1 To UBound(allPosts2, 2)
            If Len(allPosts2(lngRow, lngCol)) > 0 Then Range("A2").Offset(lngRow - 1, lngCol - 1).Value2 = allPosts2(lngRow, lngCol)
        Next
    Next
    End Sub 
```

# ruby-on-rails - 无法进行迁移

> ID：13663373
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:21:55.887
> 
> 标签：ruby-on-rails, ruby, migration

我刚刚重新安装了我的 Ubuntu，所以我安装了 Ribu 和 Rails。一切进展顺利，但是当我尝试制作模型（数据库表）时，出现了几个错误。这是没有痕迹的错误：

```
cdr@ubuntu:~/pro$ rake db:migrate
==  CreateMonsters: migrating =================================================
-- create_table(:monsters)
rake aborted!
An error has occurred, this and all later migrations canceled:

undefined method `straing' for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x000000023cae90>
/home/cdr/pro/db/migrate/20121201195505_create_monsters.rb:4:in `block in change'
/home/cdr/pro/db/migrate/20121201195505_create_monsters.rb:3:in `change'
Tasks: TOP => db:migrate
(See full trace by running task with --trace) 
```

这是有迹可循的：

```
cdr@ubuntu:~/pro$ rake db:migrate --trace
** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:migrate
==  CreateMonsters: migrating =================================================
-- create_table(:monsters)
rake aborted!
An error has occurred, this and all later migrations canceled:

undefined method `straing' for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x00000003f4c3d0>
/home/cdr/pro/db/migrate/20121201195505_create_monsters.rb:4:in `block in change'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/schema_statements.rb:160:in `create_table'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:466:in `block in method_missing'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:438:in `block in say_with_time'
/usr/lib/ruby/1.9.1/benchmark.rb:280:in `measure'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:438:in `say_with_time'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:458:in `method_missing'
/home/cdr/pro/db/migrate/20121201195505_create_monsters.rb:3:in `change'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:407:in `block (2 levels) in migrate'
/usr/lib/ruby/1.9.1/benchmark.rb:280:in `measure'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:407:in `block in migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in `with_connection'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:389:in `migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:528:in `migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:720:in `block (2 levels) in migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:775:in `call'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:775:in `block in ddl_transaction'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/transactions.rb:208:in `transaction'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:775:in `ddl_transaction'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:719:in `block in migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:700:in `each'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:700:in `migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:570:in `up'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/migration.rb:551:in `migrate'
/usr/lib/ruby/gems/1.9.1/gems/activerecord-3.2.9/lib/active_record/railties/databases.rake:179:in `block (2 levels) in <top (required)>'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:227:in `call'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:227:in `block in execute'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:222:in `each'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:222:in `execute'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/usr/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:159:in `invoke_with_call_chain'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:152:in `invoke'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:141:in `invoke_task'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `block (2 levels) in top_level'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `each'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `block in top_level'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:108:in `run_with_threads'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:93:in `top_level'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:71:in `block in run'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:158:in `standard_exception_handling'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:68:in `run'
/usr/lib/ruby/gems/1.9.1/gems/rake-10.0.2/bin/rake:37:in `<top (required)>'
/usr/bin/rake:23:in `load'
/usr/bin/rake:23:in `<main>'
Tasks: TOP => db:migrate 
```

这是迁移：

```
class CreateMonsters < ActiveRecord::Migration
  def change
    create_table :monsters do |t|
      t.straing :name
      t.text :description

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:23:36.993

`t.straing`? 那应该是`t.string`

您发布的错误（下面的片段）

```
An error has occurred, this and all later migrations canceled:

undefined method `straing' 
```

正在为你指出错误的方向

# git - 可以将 GITHub 提交推送到新分支吗？还是他们已经致力于原作？

> ID：13663376
> 
> 赞同：1
> 
> 时间：2012-12-01T20:22:32.520
> 
> 标签：git, github, push, commit

我对本地版本的代码进行了一些更改并提交了它们，但我想将它们推送到新的分支。我担心当我推送我的更改时，它们都会影响主分支。

我已经“提交”了我的更改是一个问题吗？还是这些提交只会应用于我创建的新分支？

我是一个完全的 GITHub no00b，所以请放轻松。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:43:06.213

使用显式推送命令

```
git push origin <branch-name> 
```

只有这个分支会推送到 github 仓库。

如果您影响主分支中的某些内容，您还可以恢复您的提交。利用

```
git reset HEAD~<commits count> 
```

要删除提交的所有更改：

```
git reset HEAD~<commits count> --hard 
```

我向您推荐 ProGit 书以了解有关 GIT 的更多信息[https://github.com/progit/progit](https://github.com/progit/progit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:30:58.117

这取决于分支是否是主分支的子分支。我建议你去这里更深入的细节。

[http://learn.github.com/p/branching.html](http://learn.github.com/p/branching.html)

# scala - Scala中的模式匹配Jackson JSON

> ID：13663379
> 
> 赞同：2
> 
> 时间：2012-12-01T20:22:48.677
> 
> 标签：scala, pattern-matching, jackson

我想知道是否可以在 Scala 中对[Jackson JSON 对象进行模式匹配。](http://jackson.codehaus.org/)我们目前在一个项目中大量使用[jackson-module-scala](https://github.com/FasterXML/jackson-module-scala)，并且能够从 Json ObjectNode/JsonNode 对象的模式匹配中受益。

如果这不可能，我将如何添加此功能？我在考虑从 JsonNode/ObjectNode 到 MyClass 的隐式转换`MyClass`，其中 MyClass 有`unapply`方法，做 JsonNode.toString 和正则表达式匹配。如果我的逻辑是正确的，那么我可以对 JsonNode 对象进行模式匹配。当然，可能有更好的方法我不知道，或者由于我还不知道的原因，这个方法可能不起作用。为了说明我的情况，我希望能够执行以下操作：

```
val mapper = new ObjectMapper()
mapper.registerModule(DefaultScalaModule)

val json = mapper.createObjectNode()
                .put("key1","value1")
                .put("key2","value2")
                .put("key3","value3")

json match {
  case MyClass("key1", "value1", "key2", y) => println("Found key1 with value1, where key2 is " + y)
  case MyClass("key1", x) => println("Key1 value is " + x)
  ...
  _ => println("No match found")
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T02:07:10.137

您是否尝试过使用案例类反序列化？ [https://github.com/FasterXML/jackson-module-scala/blob/master/src/test/scala/com/fasterxml/jackson/module/scala/deser/CaseClassDeserializerTest.scala](https://github.com/FasterXML/jackson-module-scala/blob/master/src/test/scala/com/fasterxml/jackson/module/scala/deser/CaseClassDeserializerTest.scala)

如果这不起作用，我认为您最好创建提取器来表示您的域对象。下面的代码假设一个 scala Map，但它应该给你一个想法。不需要隐式转换。

```
case class DomainObjectA(v1: String, v2: String)
object DomainObjectAExtractor {
  def unapply(m: Map[String, String]) = for {
     v1 <- m.get("key1")
     v2 <- m.get("key2")
  } yield DomainObjectA(v1, v2)
}

case class DomainObjectB(v3, v4, v5)
object DomainObjectBExtractor {
  def unapply(m: Map[String, String]) = for {
     v3 <- m.get("key3")
     v4 <- m.get("key4")
     v5 <- m.get("key5")
  } yield DomainObjectB(v3, v4, v5)
}

json match {
  case DomainObjectAExtractor(a@DomainObjectA(_, _)) => a
  case DomainObjectBExtractor(b@DomainObjectB(_, _, _)) => b
} 
```

但是，如果您坚持尝试匹配键/值对，则可能有一些方法可以完成您可以接受的事情。无法将输入从 传递到 unapply 函数`case`，如果我理解您想要正确执行的操作，我认为这将是必需的。可以使用即将正式发布的 scala 2.10 中的实验性宏来执行此操作。我和他们玩得还不够多，不知道这是否可能。

如果假设键的顺序，您可以想出一个`::`类似于`::`for list 的 unapply 运算符。这可以`K, V`以这个已知的顺序提取对。就我个人而言，这对我的口味来说太脆弱了。

```
val json = Map(("key1" -> "one"), ("key2" -> "two"))

object -> {
  def unapply[A, B](ab: (A, B)) = Some(ab)
}

object :: {
  def unapply[K, V](m: Map[K, V]): Option[((K, V), Map[K, V])] = 
    m.headOption.map(_ -> m.tail)
}

scala> json match {
     |   case ("key1" -> "one") :: ("key2" -> value2) :: _ => value2
     | }
res0: java.lang.String = two 
```

您将无法以错误的顺序提取密钥

```
scala> json match {
     |   case ("key2" -> value2) :: _ => value2
     |   case _ => "match fail"
     | }
res2: java.lang.String = match fail 
```

你也可以写`Key1`, `Key2`, `Key3`。这可能会或可能不会很好地扩展。

```
object && {
  def unapply[A](a: A) = Some((a, a))
}

object Key2 {
  def unapply[V](m: Map[String, V]) = m.get("key2")
}

object Key1 {
  def unapply[V](m: Map[String, V]) = m.get("key1")
}

scala> json match {
     |   case Key2(value2) && Key1(value1) => (value2, value1)
     | }
res5: (java.lang.String, java.lang.String) = (two,one) 
```

# c++ - 将任意 lambda 表达式传递给函数？

> ID：13663381
> 
> 赞同：1
> 
> 时间：2012-12-01T20:22:52.300
> 
> 标签：c++, templates, c++11, lambda

我有一个非常奇特的问题，因为我正在尝试创建某种编译器...我想将 lambda 表达式传递给这样的模板化函数：

```
 template<class T>
delegate<T>* bind(std::function<T> func)
{
    return nullptr;
} 
```

所以我现在可以打电话

```
bind([&](int a) { // do something }); 
```

...所以通常情况下，这不会是一个问题，因为 std::function 能够捕获一个 lambda。但这里的问题是（假设）我不知道或不想提供有关“T”到底是什么的信息。它可以是您也可以插入到 std::function<>... 的任何函数签名

我还需要将此“推断”签名传递回我想要返回的“委托”类，并且该委托类需要是指向类的指针......

现在我想出了这个：

```
template<class T>
struct delegate : public std::function<T>
{
    delegate(const std::function<T>& func) : std::function<T>(func) { }
    delegate(const delegate<T>& func) { }
};

template<class T>
delegate<T>* bind(std::function<T>&& func)
{
    return new delegate<T>(std::forward<std::function<T>>(func));
} 
```

但是上面调用“bind”的例子因“模板参数推导失败”而失败。如何在调用“bind”时无需显式指定“T”参数而使其工作（至少它可以工作）？

由于理论上我的编译器拥有解决此问题的所有信息，我可以只插入“T”的实例，但这会使生成的代码不必要地复杂化。

顺便说一句，我正在使用最新的 Clang 编译器。

* * *

这是最终的解决方案：

```
 template<typename T> struct get_signature;
template<typename Mem, typename Ret, typename... Args> struct get_signature<Ret(Mem::*)(Args...) const> {
    typedef Ret type(Args...);
};

template<class T> 
delegate<typename get_signature<decltype(&T::operator())>::type>* bind(T func)
{
    return nullptr;
} 
```

请注意，您可能需要根据需要调整“const”修饰符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:32:52.933

首先，你完全搞砸了你的右值引用。您的转发根本不起作用。

其次，在某些情况下这是不可能的。对于*某些函数对象*`operator()`，您可以通过获取成员函数指针并检查其签名来推断签名。但是对于其他人来说，他们将超载并且无法正常工作。

```
template<typename T> struct get_signature;
template<typename Mem, typename Ret, typename... Args> 
struct get_signature<Ret(Mem::*)(Args...)> {
    typedef Ret(Args...) type;
};

template<class T> 
delegate<typename get_signature<&T::operator()>::type>* bind(T func)
{
    return nullptr;
} 
```

第三，`std::bind`?

# c# - JSON 将数据发布到 mvc 控制器

> ID：13663383
> 
> 赞同：0
> 
> 时间：2012-12-01T20:22:57.570
> 
> 标签：c#, asp.net-mvc, json, postback

我有一个包含人员和地址的实体类。

```
public class Person
{
        public int Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }

        public List<Address> Addresses { get; set; }
}

public class Address
{
   public string ZipCode { get; set; }
   public string City { get; set; }
   public string State { get; set; }
   public string Country { get; set; }
} 
```

在我看来，我显示了一些复选框。

```
@model DataContext.Models.Persons

@{
    ViewBag.Title = "Person list";
}

@using (Html.BeginForm("Update", "Test", FormMethod.Post))
{

    <div id="personContainer">
        @foreach(var t in Model.Person)
        {
            <input type="checkbox" value="@t.ID" name="@t.FirstName ">@t.FirstName <br />
        }
    </div>
    <p>
        <input type="submit" id="save">
    </p> 
} 
```

我的控制器如下所示：

```
[HttpPost]
public JsonResult Update(Person p)
{

   return Json( new { redirectTo = Url.Action("Index") });
} 
```

我要发布的数据必须是强类型的。如何使用 JSON 将数据（在本例中为所有复选框）回发到“更新”控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-11T10:38:34.087

您需要为视图模型的每个属性输入。

每个输入上的 name 属性需要与 MVC 识别它的属性名称相同。

例如：

```
@model Person

@using (Html.BeginForm("Update", "Test", FormMethod.Post))
{
    @Html.HiddenFor(model => model.ID)

    <input type="checkbox" value="@model.FirstName" name="FirstName ">@model.FirstName <br />
    <input type="checkbox" value="@model.LastName" name="LastName ">@model.LastName <br />
    @Html.EditorFor(model => model.Addresses)

    <input type="submit" id="save">
} 
```

对于地址，创建一个编辑器模板，剃须刀引擎会意识到该属性是一个可枚举的。

它将向名称属性添加可枚举的数字，如下所示：

```
<input id="addresses_0__city" type="text" value="City" name="addresses[0].city"> 
```

请注意，名称具有数组样式。

*   要创建编辑器模板，请在您的“共享”视图文件夹（或相关视图文件夹）中创建一个名为“EditorTemplates”的文件夹。
*   创建一个名为 Address 的局部视图（与类型相同）。
*   为每个地址添加要查看的 HTML：

    ```
    @model Address

    @Html.CheckBox("ZipCode", false, new { value = Model.ZipCode}) @Model.ZipCode
    <br />
    @Html.CheckBox("City", false, new { value = Model.City}) @Model.City
    <br />
    @Html.CheckBox("State", false, new { value = Model.State}) @Model.State
    <br />
    @Html.CheckBox("Country", false, new { value = Model.Country}) @Model.Country
    <br /> 
    ```

这将起作用，但它不会将表单发布为 JSON。如果您需要专门发布为 JSON，您可以在 AJAX POST 上将表单数据转换为 JSON：

```
$.ajax("/Test/Update",
{
    type: "post",

    data: JSON.stringify($('form').serializeObject()), // converting to JSON
    contentType: 'application/json; charset=utf-8',
    dataType: 'json',
    success: function (data) {}      
    error: function () {}
}); 
```

对于 JSON.stringify，首先使用以下方法将表单放入对象表单：

```
$.fn.serializeObject = function () {
    var obj = {};
    var arr = this.serializeArray();

    $.each(arr, function () {
        var splt = this.name.split(".", 2);
        if (splt.length === 2) {
            if (obj[splt[0]] === undefined) {
                obj[splt[0]] = {};
            }
            obj[splt[0]][splt[1]] = this.value || '';
        }
        else if (obj[this.name] !== undefined) {
            if (!obj[this.name].push) {
                obj[this.name] = [obj[this.name]];
            }
            obj[this.name].push(this.value || '');
        }
        else {
            obj[this.name] = this.value || '';
        }
    });
    return obj;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:40:59.480

设置一个 jquery 方法以在表单提交上运行以将序列化的表单发送到 Begin Form 中的控制器

```
$('formSelector').submit(function () {
    if ($(this).valid()) {
        $.ajax({
            url: this.action,
            type: this.method,
            data: $(this).serialize(),
            success: function (result) {
                if (result.Success == true) {

                }
                else {
                    $('#Error').html(result.Html);
                }
            }
        });
    }
    return false;
}); 
```

# entity-framework - 实体框架“复合”属性？

> ID：13663385
> 
> 赞同：1
> 
> 时间：2012-12-01T20:23:31.097
> 
> 标签：entity-framework

我正在使用 EF 4.1，代码优先，并希望客户实体上的属性由常量字符串值和填充的 customerId 零组成，以充当客户参考。

我可能有点愚蠢，但我正在努力弄清楚如何在没有 A) 的情况下实现这一点返回常量 + CustomerId.Tostring("000000")

这首先用代码“可行”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T00:39:54.040

如果您可以更改数据库，我会为此创建一个[计算列](http://msdn.microsoft.com/en-us/library/ms191250%28v=sql.105%29.aspx)。因此，您将其留给数据库以生成参考值，并且它也可供数据库的其他使用者（如果有）使用。

您的`Customer`类将具有一个类似于`CustomerReference`(string) 的属性，该属性映射到计算列，并且[配置](http://msdn.microsoft.com/en-us/library/hh829109%28v=vs.103%29.aspx)为具有`DatabaseGeneratedOption.Computed`这将导致 EF 在插入对象后读取该值。

# java - 从 DialogFragment 调用 DialogFragment，getActivity() 中的 ClassCastException

> ID：13663391
> 
> 赞同：1
> 
> 时间：2012-12-01T20:24:01.077
> 
> 标签：java, android, android-dialogfragment

我的应用程序中有一个 DialogFragment1（由 MyFragmentActivity 调用），带有日期和时间字段。当用户单击它们时，会出现 DatePickerFragment 和 TimePickerFragment。它们还扩展了 DialogFragments。我想像往常一样将它们的值返回到 DailogFragment1：

```
public void onDateSet(DatePicker view, int year, int month, int day) {
        EditDateDialogListener activity = (EditDateDialogListener) getActivity();
        activity.onFinishDateDialog(day, month, year);

} 
```

（在我照常实施之前）

```
public interface EditDateDialogListener{
void onFinishDateDialog(int day, int month,int year);
} 
```

在实现 EditDateDialogListener 的 DialogFragment1 中：

```
public void onFinishDateDialog(int day, int month, int year){
this.mDay=day;
this.mMonth=month;
this.mYear=year;
updateDateDisplay(); 
```

但是我有一个运行时错误 12-01 20:03:52.018: E/AndroidRuntime(756): java.lang.ClassCastException: MyFragmentActivity cannot be cast to DatePickerFragment$EditDateDialogListener

我知道这是对话片段而不是活动，但是我怎样才能以正确的方式调用它？得到什么？感谢您的时间。

UPD：我的 MyFragmentActivity 没有实现 EditDateDialogListener，因为我不需要这个日期，而是在 DialogFragment1 中。

```
public class MyFragmentActivity extends FragmentActivity{ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:32:14.197

**添加**

> 我的 MyFragmentActivity 没有实现 EditDateDialogListener，因为我在那里不需要这个 Date，而是在 DialogFragment1 中。

我懂了。然后 DailogFragment1 必须实现如下所述的 EditDateDialogListener 并且您需要更改`onDateSet()`为使用[`getParentFragment()`](http://developer.android.com/reference/android/app/Fragment.html#getParentFragment%28%29)：

```
public void onDateSet(DatePicker view, int year, int month, int day) {
    EditDateDialogListener listener = (EditDateDialogListener) getParentFragment();
    listener.onFinishDateDialog(day, month, year);
} 
```

* * *

**原始答案**

我假设您正在尝试在开发人员指南中执行类似[此示例的操作。](http://developer.android.com/guide/topics/ui/dialogs.html#PassingEvents)

这个错误意味着`MyFragmentActivity`没有实现你的自定义`EditDateDialogListener`。简单地改变这个：

```
public class MyFragementActivity extends FragmentActivity { 
```

对此：

```
public class MyFragementActivity extends FragmentActivity implements EditDateDialogListener {
//                                             Add this:  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
```

并覆盖你的听众的`onFinishDateDialog()`回调。

* * *

一起改变`MyFragmentActivity`：

```
public class MyFragementActivity extends FragmentActivity implements EditDateDialogListener {
    @Override
    public void onFinishDateDialog(int day, int month, int year) {
        // Do something
    }
    // The rest of your MyFragmentActivity code here
} 
```

随着这一行上方的变化`DatePickerFragment`：

```
EditDateDialogListener activity = (EditDateDialogListener) getActivity();  // It works! 
```

不会再抛出任何异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T08:31:40.867

我解决了这个问题。像这样：在 MyFragmentActivity 有一个标签：

```
DialogFragment dlg = MyFragmentActivity.newInstance(p1,p11, p2, p3);
dlg.show(getSupportFragmentManager(), "DataFragmentTag"); 
```

在 DatePickerFragment 中：

```
public void onDateSet(DatePicker view, int year, int month, int day) {

    EditDateDialogListener handler = (EditDateDialogListener) getActivity().getSupportFragmentManager().findFragmentByTag("DataFragmentTag");
    handler.onFinishDateDialog(day, month, year);
} 
```

# php - 如何在链接变量中使用超链接？

> ID：13663393
> 
> 赞同：2
> 
> 时间：2012-12-01T20:24:07.253
> 
> 标签：php, get

我`$_GET['link']`用来接收链接...

但是链接中有`&`' 导致变量被错误地读取。

我该怎么做呢？

这是链接...

[http://vk.com/video_ext.php?oid=172860651&id=162881967&hash=1864975b71a6085a&hd=1](http://vk.com/video_ext.php?oid=172860651&id=162881967&hash=1864975b71a6085a&hd=1)

以供参考。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T20:29:41.173

在编写链接时使用`urlencode`，然后在阅读链接时使用`urldecode`：

```
<a href="http://example.com/file.php?link=<?php echo urlencode($link);?>">link</a>

<?php
   $link = urldecode($_GET['link']);    
   echo $link;
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:29:01.353

创建链接时应使用 PHP 的 urlencode ( [http://php.net/manual/en/function.urlencode.php](http://php.net/manual/en/function.urlencode.php) )，然后使用 urldecode ( [http://php.net/manual/en/function.urldecode .php](http://php.net/manual/en/function.urldecode.php) ) 在 $_GET['link'] 上获取正确的值。

# c# - 在保持 UI 响应的单独线程中运行返回对象的数据库访问任务的最佳方式？

> ID：13663400
> 
> 赞同：1
> 
> 时间：2012-12-01T20:25:13.523
> 
> 标签：c#, .net, multithreading, data-access-layer, splash-screen

[Windows 窗体应用程序和 .NET 4.0]

我需要执行返回对象（类列表或简单类）的数据库访问方法。

我还需要在主线程进行初始化时打开响应式表单。

我需要在单独的线程上运行这些，以保持用户界面的响应，当然还需要能够将结果传递回主线程以进行 UI 更新。

我一直在阅读有关各种方法的书籍。

我了解我的工作可以通过以下方式完成：

*   背景地勤工作者
*   线程类
*   任务类

我应该潜入哪一个？

更新：使用建议的任务类，我使用以下方法获取跨线程安全错误：

```
private void BtnCheckClick(object sender, EventArgs e)
{
    var itm =   Task<JDEItemLotAvailability>.Factory.StartNew(() =>
                             Dal.GetLotAvailabilityF41021(
                                                         txtLot.Text,
                                                         cmbMcu.SelectedItem.ToString(),
                                                         cmbLocn.SelectedItem.ToString())
                            );
       lblDescriptionValue.Text = itm.Result.Description;
       lblItemCodeValue.Text = itm.Result.Code;
       lblQuantityValue.Text = itm.Result.AvailableQuantity.ToString();
       LotFocus(true);
} 
```

在上面的例子中，我在 cmbMcu 控件而不是 txtLot 中得到了异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:32:15.980

我已经使用 Thread 完成了很多项目，但是 Task 应该更易于使用。

这是演示如何使用线程进行异步操作。

这是将数据返回到 ui 的类：

```
public class MyAsyncClass
{

    public delegate void NotifyComplete(DataSet data);
    public event NotifyComplete NotifyCompleteEvent;

    //Starts async thread...
    public void Start()
    {
        System.Threading.Thread t = new System.Threading.Thread(new System.Threading.ThreadStart(DoSomeJob));
        t.Start();
    }

    void DoSomeJob()
    {
        //just wait 5 sec for nothing special...
        System.Threading.Thread.Sleep(5000);
        if (NotifyCompleteEvent != null)
        {
            //TODO: fill your data...
            DataSet ds = new System.Data.DataSet();

            NotifyCompleteEvent(ds);
        }
    }
} 
```

这是ui实现：

```
 MyAsyncClass myClass = null;

    private void button2_Click(object sender, EventArgs e)
    {
        myClass = new MyAsyncClass();
        myClass.NotifyCompleteEvent += new MyAsyncClass.NotifyComplete(myClass_NotifyCompleteEvent);
        //here I start the job inside working class...
        myClass.Start();
    }

    //here my class is notified from working class when job is completed...
    delegate void myClassDelegate(DataSet data);
    void myClass_NotifyCompleteEvent(DataSet data)
    {
        if (this.InvokeRequired)
        {
            Delegate d = new myClassDelegate(myClass_NotifyCompleteEvent);
            this.Invoke(d, new object[] { data });
        }
        else
        {
            //TODO: show your data
            MessageBox.Show("Data retrieved!");
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T22:34:58.897

我会使用这个**[`Task`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)**类，同步它真的很容易，而且它已经为返回对象提供了支持。

```
var task = Task.Factory.StartNew(
    () => GetDatabaseData(someArguments),
    TaskCreationOptions.LongRunning);

// Example method
public DataSet GetDatabaseData(object args) { ... } 
```

这告诉**[调度程序](http://msdn.microsoft.com/en-us/library/dd997402.aspx)**创建并开始一个新任务，并暗示如果调度程序使用线程池，不使用线程池线程可能是个好主意。无论如何，您现在可以决定如何同步。

例如，要实现与 Gregor Primar 的答案类似的行为，您可以使用**[`ContinueWith`](http://msdn.microsoft.com/en-us/library/dd270696.aspx)**以下方法设置延续，

```
task.ContinueWith(oldTask => ProcessReturnedData(oldTask.Result));

// Example method
public IEnumerable<SomeEntity> ProcessReturnedData(DataSet data) { ... } 
```

这将安排在对象完成执行`ProcessReturnedData`后调用该方法。`task`请注意，即使`task`由于某种原因失败，它也会被调用，因此它可能并不总是一个好的解决方案 - 或者您必须在提供的委托中进行一些检查。

如果您想在主线程上进行非阻塞等待并在那里使用返回的对象，您可以简单地使用该**[`Wait`](http://msdn.microsoft.com/en-us/library/dd235635.aspx)**方法。

```
task.Wait(); // Makes current thread wait until the task is comnpleted.
DataSet result = task.Result; // Accessing the result object. 
```

# jquery - Jquery Ajax Firefox 不发送 cookie（Chrome 有效）

> ID：13663409
> 
> 赞同：9
> 
> 时间：2012-12-01T20:25:56.177
> 
> 标签：jquery, ajax, firefox, google-chrome, spring-security

我正在尝试在我的应用程序中使用 Ajax 身份验证，我似乎已经让它工作了，除了 firefox 似乎没有在“cookie”请求标头中向服务器发送正确的 jessionid 以进行后续请求，而 chrome 这样做很好. 下面是登录功能：

```
$.ajaxSetup({
    xhrFields: {
        withCredentials : true
    }
})
function sudoLogin(callback){

    $.ajax({
            url : HOST + "/ProperApp/j_spring_security_check",
            type : "POST",
            data : $("#login").serialize(),
            dataType: 'json',
            async : false,
            success: function(result) {
                if (result.login) {
                    callback(true);
                } else {
                    callback(false);
                }
            }
        })
} 
```

在 Firefox 的响应中，我可以看到正在设置的 cookie，并调用了成功回调：

```
Set-Cookie  JSESSIONID=81235e7ff741e941c1e078afee5c; Path=/ProperApp; HttpOnly 
```

但是，在后续请求中，例如这个请求，cookie 不会被发送：

```
function getUserDeets(callback){
    $.ajax({
        url : HOST+ "/ProperApp/userData",
        type : "GET",
        async : false,
        dataType : 'json',
        xhrFields: {
                withCredentials: true
            },
        success : function(data){
            callback(data);
        }
    })
}
$('#submitLogin').click(function(){
            sudoLogin(function(loggedIn){
                if(loggedIn){
                    //window.location = "sudoIndex2.php";
                    getUserDeets(function(user){
                       alert(user);
                    })

                }
                else
                    alert("login failure");
            });
        }); 
```

在 Chromium 中，请求包含 cookie 标头，并且成功回调被正确调用：

```
...
Connection:keep-alive
Cookie:JSESSIONID=8129ef67b59180f9f21383cba850
Host:localhost:8080
Origin:http://localhost:8000
Referer:http://localhost:8000/loginSignup.php
... 
```

但是在 Firefox 中，请求标头不包含 cookie 标头，并且从不调用成功：

```
...
Connection  keep-alive
Host    localhost:8080
Origin  http://localhost:8000
Referer http://localhost:8000/loginSignup.php
... 
```

我在服务器端创建了一个 ajax 过滤器，我认为应该允许这种情况发生：

```
response.setHeader("Access-Control-Allow-Origin", request.getHeader("origin"));
response.setHeader("Access-Control-Max-Age", "360");
response.setHeader("Access-Control-Allow-Credentials", "true");
response.setHeader("Access-Control-Allow-Headers", "Authorization"); 
```

知道为什么这会在 Chrome 而不是 Firefox 中无缝运行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T23:44:21.843

如果您希望使用本机 ajax 或 jquery ajax，请去掉 async:false。它对我有用。

为了进一步兼容旧浏览器，我建议使用[http://easyxdm.net/wp/](http://easyxdm.net/wp/)。EasyXDM 方法是使用 iframe hack，它要求您将 html 文件放在要进行 ajax 调用的主机上。这将是强制异步的，是的。但是这个easyXDM的好处是你不必担心cors headers。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-30T21:18:21.900

首先有几个观察：

*   OP（原始帖子）正在处理跨域 XHR，因为 AustinR 使用不同的端口（如果主机、域或端口的任何部分不同，则浏览器将 XHR 视为跨域）
*   跨域 XHR 需要在服务器上设置正确的 CORS 标头
*   OP 中的 javascript 似乎很好，除了 async:false 理想情况下应该设置为 async:true （或跳过，因为设置默认为 true）

参考给定的示例，我将从以下 CORS 标头开始：

```
response.setHeader("Access-Control-Allow-Origin", "http://localhost:8000"); // use a wildcard (*) as the 2nd parameter if you want to be less restrictive
response.setHeader("Access-Control-Max-Age", "360");
response.setHeader("Access-Control-Allow-Credentials", "true");
response.setHeader("Access-Control-Allow-Methods", "GET");
response.setHeader("Access-Control-Allow-Headers", "Origin");
response.setHeader("Access-Control-Expose-Headers","Access-Control-Allow-Origin"); 
```

最后一个 CORS 设置“Access-Control-Expose-Headers”特别有用，因为它使您有机会对服务器在 HTTP 响应中发送的标头进行故障排除。

检查 Firebug 网络面板中的响应标头部分以获取 CORS 标头。您的请求的“Origin”标头应与服务器响应的“Access-Control-Allow-Origin”标头的模式匹配。

# c# - 创建类似于 AppBar 的动画

> ID：13663413
> 
> 赞同：1
> 
> 时间：2012-12-01T20:26:16.587
> 
> 标签：c#, windows-8, windows-runtime

我正在尝试创建类似于 AppBar 的动画 - 基本上使控件从屏幕的底部边缘进入。这样做的问题是控件的高度可能会根据其内容而改变，因此我无法`TranslateTransform.Y`在 XAML 或 Loaded 事件中设置初始值，因为内容是在页面加载后生成的。

所以，用其他（和更少）的话来说。我需要为一个我不知道其大小的控件在屏幕上设置动画。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T19:25:34.973

您可以使用过渡。例如 PaneThemeTransition 或 EntranceThemeTransition。我不确定您应该使用哪个属性来添加过渡，因为这取决于您的情况。但是你可以这样做：

```
Popup.ChildTransitions = new TransitionCollection { new EntranceThemeTransition() }; 
```

弹出窗口不是强制性的：

```
<uielement>
  <uielement.Transitions>
    oneOrMoreTransitions
  </uielement.Transitions>
</uielement> 
```

[动画](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh452703.aspx)

# ruby - 转储类似 YAML 的 Hash 键名

> ID：13663418
> 
> 赞同：2
> 
> 时间：2012-12-01T20:27:02.403
> 
> 标签：ruby, hash

`Hash`获取由点分隔的所有键（带有嵌套）的列表的便捷方法是什么？

鉴于我有一个哈希：

```
{ level1: { level21: { level31: 'val1', 
                       level32: 'val2' }, 
            level22: 'val3' } 
} 
```

表示哈希中所有关键路径的所需输出（字符串数组）：

```
level1.level21.level31
level1.level21.level32
level1.level22 
```

我目前的解决方案：

```
class HashKeysDumper
  def self.dump(hash)
    hash.map do |k, v|
      if v.is_a? Hash
        keys = dump(v)
        keys.map { |k1| [k, k1].join('.') }
      else
        k.to_s
      end
    end.flatten
  end
end 
```

它也可作为[gist](https://gist.github.com/4184731)（带有规格）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T00:03:01.353

好吧，这取决于您所说的清洁剂是什么意思，但这里有一个*较小*的版本……

1.  将适用于子类 Hashes 或 Hash-alikes
2.  扩展 Hash，使其在您的代码中*看起来更清晰。*

    ```
    class Hash
      def keydump
        map{|k,v|v.keydump.map{|a|"#{k}.#{a}"} rescue k.to_s}.flatten
      end
    end 
    ```

结果：

```
{ level1: { level21: { level31: 'val1', 
                       level32: 'val2' }, 
            level22: 'val3' } 
}.keydump
=> ["level1.level21.level31", "level1.level21.level32", "level1.level22"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T01:27:20.913

我刚刚向[RubyTree](https://github.com/evolve75/RubyTree)提交了一些代码，其中添加了`from_hash()`允许您执行此操作的代码：

```
require 'rubytree'

Tree::TreeNode.from_hash(hash).each_leaf.map{|n| "#{n.name}.#{n.parentage.map(&:name).reverse.join('.')}" }

=> ["level1.level21.level31", "level1.level21.level32", "level1.level22"] 
```

除了 gem 要求之外，它是一个单线 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T20:48:34.860

这是我对此的看法：

```
h = { 'level1' => { 'level2' => { 'level31' => 'val1', 'level32' => 'val2' } } }

class Hash
  def nested_keys
    self.inject([]) { |f, (k,v)| f += [k, v.is_a?(Hash) ? v.nested_keys : []] }.flatten
  end
end

keys = h.nested_keys

p keys
#=> ["level1", "level2", "level31", "level32"]

k1, k2 = keys.shift, keys.shift

puts [k1, k2, keys.shift].join('.')
#=> level1.level2.level31

puts [k1, k2, keys.shift].join('.')
#=> level1.level2.level32 
```

### [这是一个工作演示](http://cibox.org/slivu/stackoverflow?lang=ruby&file=dump-yaml-like-key-names-of-hash-in-ruby.rb&run=true)

# ruby-on-rails - 唯一性验证失败时显示重复记录？

> ID：13663420
> 
> 赞同：0
> 
> 时间：2012-12-01T20:27:09.203
> 
> 标签：ruby-on-rails

当我的 Rails 唯一性验证失败时，我想在发回用户时在表单视图中使用部分显示重复记录。

我该如何做到这一点？现在我只知道如何更改显示的错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:33:59.237

在 Rails 中没有内置的方法可以做到这一点，并且可能有十几种方法可以做到这一点。这是一种方法，虽然不优雅，但应该可以满足您的需求。

1）检查是否存在唯一性验证错误。不幸的是，没有一种简单的方法可以做到这一点，因此您必须检查控制器中的错误名称。如果有错误，搜索现有记录，并将其存储在实例变量中：

```
def create
  @new_model = Model.new(params[:model])

  if @new_model.save
    # success...
  else
    if @new_model.errors[:field].index("has already been taken")
      @existing_record = Model.where(field: model.field).first
    end

    render :new
  end
end 
```

2）在您的视图中部分呈现现有记录

```
<%= render partial: 'partial_name', locals: {existing_record: @existing_record} %> 
```

# php - 防止表单提交空输入？

> ID：13663426
> 
> 赞同：-5
> 
> 时间：2012-12-01T20:27:44.503
> 
> 标签：php, javascript, jquery, html, css

> **可能重复：**
> [如何防止提交 HTML 表单的输入字段值（如果它为空）](https://stackoverflow.com/questions/8029532/how-to-prevent-submitting-the-html-forms-input-field-value-if-it-empty)

```
<?php

include '../core/init.php';
if(isset($_POST['nt']) && isset($_POST['ntb'])){
mysql_query("INSERT INTO `post` (`myid`, `text`) VALUES ('".$_SESSION['id']."', '".mysql_real_escape_string($_POST['nt'])."')");
}
?>

<iframe style="display:none" name="submissiontarget" id="submissiontarget"></iframe>
<form method="post" target="submissiontarget" action = "../ajax/post.php" name="form">
<input type="textbox" name="nt" class="postwall" id="nt"  placeholder="Post on your wall" rows="7" wrap="physical" cols="40" onfocus="if(this.value=='Post On Your Wall')this.value='';" onblur="if(this.value=='')this.value='Post On Your Wall';" />
<input type="submit" style="display:none;" name='ntb' id='ntb'  class="Buttonchat"     value="Post" />
</form> 
```

我希望能够这样做，所以如果文本框是空白的，它会说，“他们在你的墙上发帖时出错，请再试一次”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:38:04.747

```
if(isset($_POST['nt']) && isset($_POST['ntb'])) {
    …
} else {
    echo "There was an error posting on your wall, please try again.";
} 
```

如副本中所示，在客户端捕获空输入提交可能是一个附加功能，但您不会绕过在服务器端执行此操作。

# r - 如何检索，从数据框中提取值，然后分配给要用于索引的对象

> ID：13663427
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:27:46.933
> 
> 标签：r, object, indexing, user-input, assign

我正在尝试编写一个函数来允许用户输入各种参数（“means”、“temp”等），然后将它们编译成一个列表，以便我可以使用它们。列表中的值被提取并分配给对象。

```
param <- function(){
parameters <- c("means","variance","temp","gene","add") 
x <- list()
for(i in 1:length(parameters)){
  z <- readline(paste("Input ", parameters[i], ": ", sep=""))
  #store inputs in vector x
  x[[z]] <- z
  #x[[i]] <- z
  #x[i] <- z
} #End of for loop to bring in inputs

#Bind results into a vector
y=c(x[[1]],x[[2]],x[[3]],x[[4]],x[[5]])
#Assign answers to proper variable names so they can be used to index.  
means <- y[1]; variance <- y[2]; temp <- y[3]; gene <- y[4]; add <- y[5]
#means <- x[[1]]; variance <- x[[2]]; temp <- x[[3]]; gene <- x[[4]]; add <- x[[5]]
} #End of function to bring in inputs 
```

我想使用这些对象来索引更大的数据框（strn.x）。

```
yav=strn.x[NT==temp, means] 
```

我参考了[https://stat.ethz.ch/pipermail/r-help/2008-April/158757.html](https://stat.ethz.ch/pipermail/r-help/2008-April/158757.html)来了解如何将用户输入分配给对象，并且我认识到（基于[Retrieving specific values from subsetting a data.table](https://stackoverflow.com/questions/13648651/retrieving-specific-values-from-subsetting-a-data-table)）我的问题的一部分是对象所采用的类。我尝试使用“[[”来提取没有名称的值，但它们仍然以类“list”或“data.frame”的形式出现，具体取决于我在上面的函数中包含的内容。

```
means
 V1
1 FT_mn
class(means)
[1] "data.frame" 
```

我希望他们采用以下形式：

```
[1] FT_mn 
```

我需要做什么才能使其正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T00:59:42.967

尝试 unlist() 将 data.frame 或列表转换为向量。

# asp.net-mvc - 如何为采用参数的方法配置 Fluent Security 策略？

> ID：13663429
> 
> 赞同：1
> 
> 时间：2012-12-01T20:28:03.580
> 
> 标签：asp.net-mvc, lambda, compiler-errors, fluent-security

> **可能重复：**
> [Fluent Security - 配置参数化控制器操作](https://stackoverflow.com/questions/13203875/fluent-security-configuring-parameterized-controller-actions)

我正在尝试 Fluent Security 在 ASP.NET MVC 应用程序中强制实施安全策略，但我无法为采用参数的控制器方法定义策略。作为我的意思的一个例子，下面的代码片段显示了应该保护的控制器：

```
public class AccountController : Controller
{
    ...

    [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult LogOff()
    {
        return RedirectToAction("Index", "Home");
    }

    [HttpPost]
    [ValidateAntiForgeryToken]
    public ActionResult Disassociate(string provider, string providerUserId)
    {
        return View();
    }
} 
```

而且，此代码片段（从概念上）显示了我如何尝试配置 Fluent Security 以允许对两个控制器方法进行身份验证访问。

```
SecurityConfigurator.Configure(config => {
    config.For<AccountController>().DenyAuthenticatedAccess();
    config.For<AccountController>(x => x.LogOff()).DenyAnonymousAccess();
    config.For<AccountController>(x => x.Disassociate()).DenyAnonymousAccess();
}); 
```

但是，后一个代码不会构建，因为没有`Disassociate`. 编译器报告以下内容：`No overload for method 'Disassociate' takes 0 arguments`.

如何为该方法配置 Fluent Security `AccountController.Disassociate(string, string)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:31:31.450

看来您可以传递预期类型的​​任何值，因此在我的情况下，我可以执行以下操作来安抚编译器：

```
config.For<AccountController>(x => x.Disassociate("", "")).DenyAnonymousAccess(); 
```

# haskell - 为什么不懒惰

> ID：13663430
> 
> 赞同：8
> 
> 时间：2012-12-01T20:28:09.113
> 
> 标签：haskell, ghc

我仍在开始探索 Haskell。我知道这段代码在`IO`monad 中“运行”。当它从`l <- ...`一行转到下一行时，`IO - bind`就会调用 。

人们可能会认为，因为 Haskell 是**惰性**的，所以`l`永远不会评估。但是 " `bind`" 总是评估前一个命令，对吗？因为程序会产生“file-not-found”错误。

```
main = do
    l <- mapM readFile [ "/tmp/notfound" ]
    return () 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-01T20:40:17.133

> 人们可能会认为，因为 Haskell 是懒惰的，所以 l 永远不会被评估。

是的，它永远不会被评估。但是，由于`(>>=)`in的定义`IO`，动作`readFile "/tmp/notfound"`被执行，这意味着运行时尝试打开文件。如果没有这样的文件，则会引发“找不到文件”错误。如果有这样的文件，它会被打开，但它的内容在被要求之前不会被读取。在上面，它们不是必需的，因此不会读取内容。

这里评估（甚至执行）的是*产生*`l`. 由于该文件不存在，因此会引发错误。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-01T20:42:50.360

如果您`do`在代码中扩展符号，您会得到：

```
main = (mapM readFile ["/tmp/notfound"]) >>= (\l -> return ()) 
```

所以是的，`l`从未评估过，但这并不意味着`mapM`从未评估过调用。`>>=`总是需要评估它的左操作数以便至少在某种程度上产生一个值（至少在 IO monad 和任何其他想到的 monad 中）。

# mysql - MySql如何比较今年的月份和去年的月份？

> ID：13663433
> 
> 赞同：2
> 
> 时间：2012-12-01T20:28:23.683
> 
> 标签：mysql, date

我如何找到与去年 2 月相比，与去年 2 月相比，今年 2 月销售额增加 20% 以上的部门编号（与今年一样，因此将使用 YEAR(CURDATE()) 而不是说“2012”） . 结果表应该只有一列包含销售额增加 20% 的部门编号。

如果去年 2 月没有“部门 2”的销售额，但有今年 2 月的销售额，则 0 * 1.2= 0，因此结果不会显示“部门 2”。如果去年 2 月“部门 3”卖了一件，而今年 2 月卖了两件，这将是 1.5 的增长，超过 1.2，因此结果应该显示“部门 3”。如果只有 3 个部门，最多应该只有 3 行。

部门 2 没有出现，因为去年 2 月有 3 次销售，今年 2 月有 1 次销售。部门 4 没有出现，因为去年 2 月没有销售所以就数学而言 0 * 1.2 = 0 所以部门 4 不会出现，尽管今年 2 月有销售。

提前谢谢你，希望这足够详细。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T23:12:04.370

这使用**[`MAKEDATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_makedate)**函数来创建一年的第一天，然后添加适当的月份间隔来计算（二月）月份的开始和下个月的开始日期。

用 1代替`?`一月，用 2 代替二月等：

```
SELECT 
    this_year.departement_no
FROM  
      ( SELECT departement_no, COUNT(*) AS num_sales
        FROM department
        WHERE date >= MAKEDATE( YEAR(NOW()), 1) + INTERVAL (?-1) MONTH
          AND date < MAKEDATE( YEAR(NOW()), 1) + INTERVAL (?) MONTH
        GROUP BY departement_no
      ) this_year
    LEFT JOIN
      ( SELECT departement_no, COUNT(*) AS num_sales
        FROM department
        WHERE date >= MAKEDATE( YEAR(NOW())-1, 1) + INTERVAL (?-1) MONTH
          AND date < MAKEDATE( YEAR(NOW())-1, 1) + INTERVAL (?) MONTH
        GROUP BY departement_no
      ) last_year
          ON  last_year.departement_no = this_year.departement_no
WHERE 
    this_year.num_sales > 1.2 * COALESCE(last_year.num_sales, 0) ; 
```

如果您希望（作为您相当奇怪的要求）不显示今年 2 月有销售而去年没有销售的部门，请删除该`COALESCE()`功能。您还可以更改`LEFT`加入`INNER`加入：

```
WHERE 
    this_year.num_sales > 1.2 * last_year.num_sales ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:43:31.813

尝试使用`having`如下：

```
 select departement_no
    from department
    group by departement_no
    having sum(case date_format(date, '%m%Y') 
                when CONCAT('02',YEAR(CURDATE())) then 1 else 0 end) 
           >
           1.2 * sum(case date_form(date, '%m%Y') 
                     when CONCAT('02',YEAR(DATE_SUB(CURDATE(),INTERVAL 1 Year)))
                     then 1 else 0 end)
         AND 
         sum(case date_form(date, '%m%Y') 
                     when CONCAT('02',YEAR(DATE_SUB(CURDATE(),INTERVAL 1 Year)))
                     then 1 else 0 end) > 0 
```

# c++ - 将 void* 转换为 std::function

> ID：13663434
> 
> 赞同：2
> 
> 时间：2012-12-01T20:28:41.570
> 
> 标签：c++, function, pointers, casting, std

将具有不同参数的函数指针存储在 void 指针向量中。

```
unordered_map<string, vector<void*> > List;

template <typename T>
void Listen(string Name, function<void(T)> Function)
{
    List[Name].push_back(&Function);
} 
```

然后我想调用它们，假设它`T`与`Fire`用于`Listen`.

```
template <typename T>
void Fire(string Name, T Data)
{
    auto Functions = List[Name];

    for (auto i = Functions.begin(); i != Functions.end(); ++i)
    {
        (function<void(T)>)i)(Data);
    }
} 
```

但我得到一个编译器错误，内容为`error C2064: term does not evaluate to a function taking 1 arguments in file ...\vc\include\xrefwrap 431 1`.

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:45:05.737

一方面，您正在获取参数的地址，这里：

```
List[Name].push_back(&Function); 
```

然后，您尝试将迭代器对象转换为`std::function`此处的对象：

```
(function<void(T)>)i) 
```

您尝试做的事情可以这样做，尽管它并不漂亮，但委婉地说：

```
unordered_map<string, vector<void*> > List;

template <typename T>
void Listen(string Name, function<void(T)> &Function)
{
    List[Name].push_back(&Function);
}

template <typename T>
void Fire(string Name, T Data)
{
    auto Functions = List[Name];

    for (auto i = Functions.begin(); i != Functions.end(); ++i)
    {
      function<void(T)> *ptr = *i;

      (*ptr) (Data);
    }
} 
```

它可能会以多种方式中断，例如，您无法控制以某个名称注册的函数 in`Listen`是否使用正确的参数 in`Fire`调用 - 考虑调用`Listen<int> ("foo", f);`然后执行`Fire<double> ("foo", 3.14);`

另一种方法 - 只需为回调传递闭包：

```
unordered_map<string, std::vector<function<void()> > > List;

void Listen(string Name, function<void()> Function)
{
    List[Name].push_back(Function);
}

void Fire(string Name)
{
    auto Functions = List[Name];

    for (auto i = Functions.begin(); i != Functions.end(); ++i)
      (*i) ();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:30:38.280

```
#include <functional>
#include <unordered_map>
#include <memory>
#include <string>
#include <vector>

template<typename T> struct BlockDeduction{typedef T type;};
struct BaseCallback {
  virtual ~BaseCallback();
  template<typename T>
  void DoCall( typename BlockDeduction<T>::type&& t ) const;
};
template<typename T>
struct Callback: BaseCallback
{
  std::function<void(T)> func;
  Callback( std::function<void(T)> const& f ):func(f) {}
};

template<typename T>
void BaseCallback::DoCall( typename BlockDeduction<T>::type&& t ) const {
  Assert( dynamic_cast<Callback<T>const*>(this) );
  static_cast<Callback<T>const*>(this).func(std::forward(t));
}

typedef std::unique_ptr<BaseCallback> upCallback;
template<typename T>
upCallback make_callback( std::function<void(T)> const& f ) {
  return upCallback( new Callback<T>( f ) );
}

struct Listener {
  std::unordered_map< std::string, std::vector<upCallback>> List;
  template<typename T>
  void Listen( std::string Name, std::function<void(T)> f) {
    List[Name].push_back( make_callback(f) );
  }
  template<typename T>
  void Fire( std::string Name, typename BlockDeduction<T>::type&& t ) {
    auto callbacks = List.find(Name);
    if (callbacks == List.end()) return;
    for(auto it = callbacks->second.begin(); it != callbacks->second.end(); ++it) {
      if (it +1 = callbacks->second.end())
      {
        (**it).DoCall<T>( std::forward(t) );
      } else {
        (**it).DoCall<T>( t );
      }
    }
  }
}; 
```

... 或类似的东西。

这会在地图中存储一个副本，`std::function`通常是包裹起来的。内存是通过`unique_ptr`. 我小心地在类型必须与您安装时使用的类型完全相同的点处阻止类型推导`Listener`（此时的自动类型推导相当脆弱）。

在调试中，如果您违反 Name<->type 映射，您将获得断言失败。

需要为 nullary 回调做一些额外的工作。只需编写一个`DoCall`转换`BaseCallback`为 的`Callback<void>`，专门化为`Callback<void>`空值`function`包装器，专门化为`make_callback`空值`function`，然后编写一个调用 bare的`Fire(string)`方法。`Listener``DoCall`

或者创建一个`struct Empty`并使用 lambdas 将 nullary 函数包装在 中`function<void(Empty)>`，这将涉及更少的代码，但在运行时会更慢。

# objective-c - 新建Homebrew Gui mac os项目，学习objective-c

> ID：13663436
> 
> 赞同：0
> 
> 时间：2012-12-01T20:28:57.000
> 
> 标签：objective-c, macos, user-interface, homebrew

我正在尝试使用objective-c在mac上为自制软件构建一个Gui，但是当我尝试使用以下代码查看已安装的软件包时，它返回空但是如果我尝试其他命令（如更新）它会给我结果，我尝试了与java相同并且发生相同的错误。

Git[页面](https://github.com/roger62/GHomeBrew/tree/master/GHomeBrew)：随意帮助项目，代码可能有很多错误我是 Objective-c 的新手。

```
NSTask *task;
task=[[NSTask alloc]init];
[task setLaunchPath:@"/Users/rogeriop062/homebrew/bin/brew"];

NSArray *arguments;
arguments = [NSArray arrayWithObjects:@"list",nil];
[task setArguments: arguments];

NSPipe *pipe;
pipe =[NSPipe pipe];
[task setStandardOutput:pipe];

NSFileHandle *file;
file=[pipe fileHandleForReading];

[task launch];

NSMutableData *data=[NSMutableData dataWithCapacity:1000];

while ([task isRunning]) {

    [data appendData:[file readDataToEndOfFile]];
}
[data appendData:[file readDataToEndOfFile]];

NSString *string;
string =[[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];
NSLog(@"result: %@\n",string); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:04:48.190

这是一个有趣的项目；对你有益！Homebrew 在我的 Mac 上运行得非常好。我看不出你的代码有什么问题。我将您的代码粘贴到我的 iMac 上的测试例程中，它运行良好。它列出了我用 brew 安装的程序。每行一个，我没想到，但它起作用了。对不起。

你也可以试试这个。从头到尾删除方法中的所有内容`[task launch]`，并将其替换为：

```
task.terminationHandler = ^(NSTask *blockTask) {
    NSMutableData *data=[NSMutableData dataWithCapacity:1000];
    [data appendData:[file readDataToEndOfFile]];
    NSString * string =[[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"result: %@\n",string);
};
[task launch]; 
```

这会产生与您在我的机器上的代码相同的结果 - 恐怕它可以工作 - 但它不会花费计算时间来等待结果。

# javascript - 如何将变量作为字符串参数放入谷歌的 API data.addRows('string', value)

> ID：13663437
> 
> 赞同：1
> 
> 时间：2012-12-01T20:28:57.007
> 
> 标签：javascript, asp.net

我想在 data.AddRows 中使用一个变量作为字符串参数，就像这样......

```
 function LanguagesChart(Names, Nums) {

        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Language');
        data.addColumn('number', 'Employees');

        for (i = 0; i < Names.length - 1; i++) {
            data.addRows([  [Names[i], Nums[i] ] ]);  //This doesn't work
            data.addRows([  [' ' +Names[i], Nums[i] ] ]);  //This doesn't work
            data.addRows([  ['English', Nums[i] ] ]);   //This works
        }
        var options = { 'title': 'Employees Languages', 'width': 400, 'height': 300 };

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('LanguageChart'));
        chart.draw(data, options);
    } 
```

我知道问题出在哪里。Javascrip 没有通过参数列表获得正确的数组。我正在使用 asp.net 在 Page_Load 上发送这些数组，并且我正在从数据库中获取这些值...

```
 string[] langs = languages.Split(' ');
      string[] Nums = nums.Split(' ');

      string serializedLat = (new JavaScriptSerializer()).Serialize(langs);
      string serializedLong = (new JavaScriptSerializer()).Serialize(Nums);

      ScriptManager.RegisterStartupScript(this, this.GetType(), "LanguagesChart",  "LanguagesChart( " + serializedLat + ", " + serializedLong + ");", true); 
```

Nums 数组适用于 js 脚本，但 Names 数组不适用，尽管我使用 alert(Names[i] + Nums[i]) 对其进行了测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T08:16:57.270

我通过 asp.net 向 javascript 发送一个字符串数组，在 js 中我将它用作 int 数组，尽管它们在 js 中不存在。获得这些值的正确方法是......

```
 var num = parseInt(Nums[i]);
    data.addRows([  [Names[i], num ] ]); 
```

很高兴就这样结束了！

# android - 更改 Spinner 下拉按钮的背景颜色

> ID：13663439
> 
> 赞同：1
> 
> 时间：2012-12-01T20:29:20.883
> 
> 标签：android, android-arrayadapter, android-view

我的 ActionBar 中有一个下拉导航列表。我想根据它们的位置以及当前选定的项目来更改列表项背景的背景颜色。

我创建了自己的类，可以`ArrayAdapter`像这样扩展和更改背景：

```
@Override
public View getView (int position, View convertView, ViewGroup parent) {
    View v = super.getView(position, convertView, parent);
    v.setBackgroundColor(Color.parseColor(VideoGroup.getColorForId(position)));
    return v;
}

@Override
public View getDropDownView (int position, View convertView, ViewGroup parent) {
    View v = super.getView(position, convertView, parent);
    v.setBackgroundColor(Color.parseColor(VideoGroup.getColorForId(position)));
    return v;
} 
```

然而，这会导致以下结果——请注意，实际的列表项看起来不错，但当前选择的项却没有。

![](../Images/b05bfaf20f33a540573d71eee7d2d2f0.png)

如何获取`Group 1`此处的背景颜色以填充整个导航按钮的区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:36:53.953

不幸的是，Spinner 本身就是一个图像，因此很难让它改变颜色，因为理想情况下，每种颜色都需要一个图像。例如，您将无法使文本的背景扩展到三角形之外。绝对可以做到，但这可能意味着要进行相当多的定制。

将颜色蒙版应用于视图的另一种（可能更简单）的方法是使用过滤器：

```
 spinner.getBackground().setColorFilter(THE_COLOR_GOES_HERE, PorterDuff.Mode.MULTIPLY); 
```

# java - 如何确保在类中重新实现 toString() 方法？

> ID：13663441
> 
> 赞同：7
> 
> 时间：2012-12-01T20:29:22.413
> 
> 标签：java, overriding, tostring

假设我有一个接口和许多实现该接口的类。我想强制覆盖`toString()`每个类中的默认实现（也就是说，如果某些类不覆盖它，那应该会导致编译错误）。

有可能实现吗？在接口主体中声明`public abstract String toString();`，无论有无`@Override`注解，都是合法的，但没有任何作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-01T20:33:49.407

是的，有点。

```
protected abstract String internToString(); 
```

进而

```
@Override
public String toString() {
 return internToString(); 
} 
```

在你的基类中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-02T01:31:02.137

编写一个注解和注解处理器，并在编译期间使用它。

您的注释将如下所示：

```
public @ interface MustOverrideToString { } 
```

并且您的注释处理器将寻找任何类

1.  使用 MustOverrideToString 注释扩展一个类
2.  不覆盖 toString

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T20:34:30.377

我认为您不需要将方法的实现声明`toString()`到特定类中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-02T08:08:51.983

如果您创建`abstract`类，则不需要另一种方法：

```
public abstract class Base{
    public abstract String toString();
}

...

public class Sub extends Base{} //will not compile 
```

# ruby-on-rails - factorygirl 不承认我现有的协会

> ID：13663442
> 
> 赞同：0
> 
> 时间：2012-12-01T20:29:23.490
> 
> 标签：ruby-on-rails, factory-bot

出于某种原因，factorygirl 说我的演讲模型没有方法“问题”。

运行测试时收到以下错误消息：

```
Failures:

  1) Lecture has a valid factory
     Failure/Error: FactoryGirl.create(:lecture).should be_valid
     NoMethodError:
       undefined method `questions' for #<FactoryGirl::Declaration::Implicit:0x007f8a29da1550>
     # ./spec/factories/lecture.rb:27:in `block (4 levels) in <top (required)>'
     # ./spec/factories/lecture.rb:26:in `each'
     # ./spec/factories/lecture.rb:26:in `block (3 levels) in <top (required)>'
     # ./spec/models/lecture_spec.rb:21:in `block (2 levels) in <top (required)>' 
```

这是我的讲座课的片段

```
 Class Lecture < ActiveRecord::Base
        # TODO change to `ordering` attribute
        default_scope :order => :id
        attr_accessible :name, :description, :soundfile, :soundfile_file_name, :soundfile_file_content_type, :soundfile_file_size, :soundfile_updated_at, :questions_attributes
        belongs_to :lesson
        has_many :questions
        has_many :users
        has_many :explanations
end 
```

这是我的问题课

```
class Question < ActiveRecord::Base
    attr_accessible :name, :description, :soundfile, :soundfile_file_name, :answer, :explanationfile, :explanationfile_file_name

    default_scope :order => :id

    belongs_to :lecture
end 
```

在控制台中，当我这样做时

```
lecture.questions
  Question Load (0.1ms)  SELECT "questions".* FROM "questions" WHERE "questions"."lecture_id" = 14 ORDER BY id
=> [#<Question id: 5, lesson_id: nil, name: "Perimeter Pentagon", description: "What is the perimeter of the pentagon", answer: 3, created_at: "2012-11-13 23:26:31", updated_at: "2012-11-13 23:26:31", soundfile_file_name: "Perimeter_Question_1.mp3", soundfile_content_type: "audio/mp3", soundfile_file_size: 1494243, soundfile_updated_at: "2012-11-13 23:26:30", lecture_id: 14, explanationfile_file_name: "Perimeter_Question_1_Explanation.mp3", explanationfile_content_type: "audio/mp3", explanationfile_file_size: 3693765, explanationfile_updated_at: "2012-11-13 23:26:30">] 
```

它返回正确的结果。

这些是我的工厂：lecture.rb require 'faker'

```
FactoryGirl.define do
    factory :lecture do
        #association :question
        name        {Faker::Lorem.words(1)}
        description {Faker::Lorem.words(7)}
        soundfile_file_name {Faker::Lorem.words(1)}
        soundfile_content_type {Faker::Lorem.words(3)}
        soundfile_file_size     {Faker::Lorem.words(8)}

        after_build do |question|
            [:question_one, :question_two, :question_three].each do |question|
                lecture.questions << FactoryGirl.build(question, user: user)
            end
        end
    end
end 
```

问题.rb

```
require 'faker'

FactoryGirl.define do
    factory :question do
        association :lecture
        name        {Faker::Lorem.words(1)}
        description {Faker::Lorem.words(7)}

        factory :question_one do
            answer  1
        end

        factory :question_two do
            answer 2
        end

        factory :question_three do
            answer 3
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-09T20:15:17.560

语法**after_build**已更改，现在应该使用**after(:build) 。**工厂文件中用于讲座的下一个代码解决了这个问题

```
after(:build) do |lecture|
  [:question_one, :question_two, :question_three].each do |question|
    lecture.questions << FactoryGirl.build(question, lecture: lecture)
  end
end 
```

你应该从你的问题工厂中删除**关联 :lecture**因为它会导致**SystemStackError: stack level too deep**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:53:31.757

在你的 lection-factory.rb 你应该写

```
 after_build do |question|
        [:question_one, :question_two, :question_three].each do |question|
            association :questions, factory: :question, strategy: :build
        end
    end 
```

# c++ - 另一个条件语句使程序更快

> ID：13663443
> 
> 赞同：4
> 
> 时间：2012-12-01T20:29:24.113
> 
> 标签：c++, performance, branch-prediction

阅读[为什么处理排序数组比处理未排序数组更快？](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)，我在主循环中添加了一个额外的测试。似乎这个额外的测试使程序更快。

```
int main()
{
    // Generate data
    const unsigned arraySize = 32768;
    int data[arraySize];

    for (unsigned c = 0; c < arraySize; ++c)
         data[c] = std::rand() % 256;

    //Don't sort the array
    //std::sort(data, data + arraySize);

    // Test
    clock_t start = clock();
    long long sum = 0;

    for (unsigned i = 0; i < 100000; ++i)
    {
        // Primary loop
        for (unsigned c = 0; c < arraySize; ++c)
        {
            if (data[c] >= 128)
                sum += data[c];

            //With this additional test, execution becomes faster
            if (data[c] < 128)
                sum += data[c];
        }
    }

    double elapsedTime = static_cast<double>(clock() - start) / CLOCKS_PER_SEC;

    std::cout << elapsedTime << std::endl;
    std::cout << "sum = " << sum << std::endl;
} 
```

我得到大约 4.2 秒的附加测试和 18 秒没有附加测试。额外的测试不应该让程序变慢而不是让它变快吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-01T20:32:24.573

由于那个*特殊*的附加测试，这个等效的代码：

```
for (unsigned i = 0; i < 100000; ++i)
{
    // Primary loop
    for (unsigned c = 0; c < arraySize; ++c)
    {
       if (data[c] >= 128)
            sum += data[c];

        //With this additional test, execution becomes faster
        if (data[c] < 128)
            sum += data[c];
     }
} 
```

变成这样：

```
for (unsigned i = 0; i < 100000; ++i)
{
  // Primary loop
  for (unsigned c = 0; c < arraySize; ++c)
  {
    sum += data[c];//because exactly one condition is guaranteed to be
                   //true in each iteration (in your code)!
                   //the equivalent is as if there is no condition at all!
  }
} 
```

这就是它变得更快的原因。

正是由于*不寻常*的附加测试和*相同*的主体，编译器能够优化代码，去除`if`条件。当你有一个`if`时，编译器就无法做到这一点。

试着写这个：

```
sum -= data[c]; //the body is not identical anymore! 
```

在其中一种`if`情况下。我确信编译器将**无法**优化代码。它现在应该发出较慢的机器代码。

* * *

请注意，外部循环可以完全省略，尽管它不太依赖于附加测试::

```
// Primary loop
for (unsigned c = 0; c < arraySize; ++c)
{
    sum += 100000 * data[c];
} 
```

或这个：

```
// Primary loop
for (unsigned c = 0; c < arraySize; ++c)
{
    sum += data[c];
} 
sum = 100000 * sum; //multiple once! 
```

# java - Java quicksort.Identify 分区中的更改 while 循环

> ID：13663457
> 
> 赞同：1
> 
> 时间：2012-12-01T20:30:50.147
> 
> 标签：java, quicksort

如果在分区方法中我想初始化 l=start 或 l=start+1 和 end =end-1 ，我需要对分区循环进行哪些更改？如果这些值被初始化为 l=start-1; 并且 r=结束；比循环工作正常，但它不满足不变量。有什么想法吗？

```
 public class qs {
          private qs(){}

    /**
     * Sort an array in ascending order
     * @param arr array to sor  */
       public static void quickSort(int[] arr){
        qs(arr, 0, arr.length);
            }

    /**
             * Sort a region of an array in ascending order.
             * Elements outside the given region are unchanged.
             * requires: 0 <= start <= end <= arr.length
             * @param arr   array to sort
             * @param start start of region (inclusive)
             * @param end   end of region (exclusive)
             */
            private static void qs(int[] arr, int start, int end){
                if (end <= start+1){    //region of length 0 or 1
                    return;
                }
                int x = arr[start];
                int p = partition(arr, start+1, end, x);
                    //now swap arr[start] with arr[p-1]
                arr[start] = arr[p-1];
                arr[p-1] = x;
                qs(arr, start, p-1);
                qs(arr, p, end);

            }

            /**
             * Partition a region of an array.
             * Rearranges elements in region so that small ones
             *   all have smaller indexes than the big ones.
             * Elements outside the region are unchanged.
             * requires: 0 <= start <= end <= arr.length
             * @param arr   array to partition
             * @param start start of region (inclusive)
             * @param end   end of region (exclusive)
             * @param x     pivot - "small" and "big" are <x, >=x.
             * @return      start index (inclusive) of big elements
             *              in region after partition.
             */
            private static int partition(
                int[] arr, int start, int end, int x)
            {

                int l = start ;
                int r = end-1;

                while (l<r) {

                    while(++l< r && arr[l] < x);

                        while(--r > l && arr[r] > x);

                        if(l >= r) // if pointers cross,
                            break; // partition done
                            else  {
                            int temp;
                        temp = arr[l];
                        arr[l] = arr[r];
                        arr[r] = temp;

                    }
                }
               return l;  
                }

            public static void main(String[] args) {
                int[] a = {15,8,4,8,9,6,};
                quickSort(a);
                for (int i = 0; i < a.length; i++){
                    System.out.print(" "+a[i]);
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:33:29.770

Pivot 应该是中间点，而不是数组的起点。

```
int x = arr[start]; 
```

将此行替换为...

```
int x = arr[(start+end)/2] 
```

# objective-c - 覆盖 UITextView 中的 SelectAll

> ID：13663458
> 
> 赞同：0
> 
> 时间：2012-12-01T20:30:53.853
> 
> 标签：objective-c, ios, xcode, uitextview

无论如何，`UITextView`当用户选择全选时，我可以将里面的文本复制到剪贴板，而无需等待用户的复制命令？

换句话说，是否可以制作`-selectAll`如下方法？

```
-(BOOL)selectAll
{
    //custom code to copy the text
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:49:30.023

如果选择了 selectAll，您可以继承 UITextView 并覆盖`canPerformAction`您可以调用自己的剪贴板函数的位置

```
- (BOOL)canPerformAction:(SEL)action withSender:(id)sender
{
    if (action == @selector(selectAll:))
    {
        [UIPasteboard generalPasteboard].string = self.text;
        return YES;
    }
    return [super canPerformAction:action withSender:sender];
} 
```

# c++ - C/C++ 函数指针的 UML 表示

> ID：13663462
> 
> 赞同：17
> 
> 时间：2012-12-01T20:31:06.030
> 
> 标签：enterprise-architect, c++, c, uml, enterprise-architect

UML 结构图中 C/C++ 函数指针 (fp) 的最佳表示是什么？

我正在考虑使用界面元素，即使“退化”也可能会受到最多声明一个操作的约束。

我在本文档中找到了一些建议：[C 和 UML 同步用户指南，第 5.7.4 节](http://www.google.de/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&cad=rja&ved=0CEoQFjAD&url=http://gforge.enseeiht.fr/docman/view.php/122/4145/TPC_UML_C_UserGuide.pdf&ei=YVy6UKT7HorOswa_uoGgCQ&usg=AFQjCNHp2F2Kx3A_JaxuTsKPorAnksqyoQ&sig2=s66MiFyjtRhDSqGJpa-oQQ)。但这听起来很麻烦，在实践中也不是很有用。即使从非常低级别的语义角度来看也是如此。下图简要展示了他们的概念： ![在此处输入图像描述](../Images/c6e115a9da7a8d162db9149f28362b9e.png)

恕我直言，C 和 C++ 函数指针被用作接口的狭窄视图，它只提供一个函数及其签名。在 C fp 中也将用于实现更复杂的接口，声明一个包含一组函数指针的结构。

我想我什至可以设法让我的特定 UML 工具（Enterprise Architect）转发生成正确的代码，并与代码更改同步而不会造成伤害。

我的问题是：

1.  将 fp 声明为 UML 中接口元素的一部分是否会提供正确的语义视图？
2.  单 fp 声明应该使用什么样的构造型？至少我需要在代码中提供一个 typedef，~~所以这将是我的胆量选择。~~（我发现这个原型是 Enterprise Architect 专有的），我需要定义一个合适的原型来适应代码生成。实际上我选择了刻板印象名称“代表”，这是否有任何含义或语义冲突？
3.  至于 C++，是否会在类元素中嵌套一个“委托”原型接口，足以正确表达类成员函数指针？

这是我对 C 语言表示的想法的示例图： ![C语言接口及函数指针实现](../Images/f8041f44f3acd8e2fae7ef29fb0295df.png)

这是应该从上述模型生成的 C 代码：

```
struct Interface1;

typedef int (*CallbackFunc)(struct Interface1*);

typedef struct Interface1
{
    typedef void (*func1Ptr)(struct Interface1*, int, char*);
    typedef int (*func2Ptr)(struct Interface1*, char*);
    typedef int (*func3Ptr)(struct Interface1*, CallbackFunc);

    func1Ptr func1;
    func2Ptr func2;
    func3Ptr func3;

    void* instance;
};

/* The following extern declarations are only dummies to satisfy code
 * reverse engineering, and never should be called.
 */
extern void func1(struct Interface1* self, int p1, char* p2) = 0;
extern int func2(struct Interface1* self, char*) = 0;
extern int func3(struct Interface1* self, CallbackFunc p1) = 0; 
```

**编辑：**
整个问题归结为手头的 UML 工具及其特定代码工程功能的最佳方法。因此，我添加了[enterprise-architect](/questions/tagged/enterprise-architect "显示标记为“企业架构师”的问题")标签。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-08T11:52:37.063

EA 的帮助文件对函数指针的主题有以下说法：

> 导入 C++ 源代码时，Enterprise Architect 忽略函数指针声明。要将它们导入您的模型，您可以创建一个 typedef 来定义函数指针类型，然后使用该类型声明函数指针。以这种方式声明的函数指针作为函数指针类型的属性导入。

注“能”。这是来自 C++ 部分，C 部分根本没有提到函数指针。所以它们没有得到很好的支持，这当然是由于建模和编程社区之间的差距：UML 根本不支持非平凡的语言概念，因此任何解决方案都必然是特定于工具的。

我的建议有点牵强，而且有点hacky，但我认为它应该工作得很好。

因为在 UML 中操作不是一流的，不能用作数据类型，所以我的回应是为它们创建一流的实体——换句话说，将函数指针类型定义为类。

这些类有两个用途：类名将反映函数的类型签名，以使程序员在图中看起来很熟悉，而一组标记值将表示实际参数和返回类型以用于代码生成。

0) 您可能希望为步骤 1-4 设置 MDG 技术。

1) 使用详细信息“Type=RefGUID;Values=Class;”定义标记值类型“retval”

2) 定义另一组具有相同详细信息的标记值类型，名为“par1”、“par2”等。

3) 使用包含“retval”标记值（但没有“par”标记）的类构造型“funptr”定义配置文件。

4) 修改代码生成脚本属性声明和参数以检索“retval”（始终）和“par1”-“parN”（已定义）并为它们生成正确的语法。这将是棘手的一点，我实际上并没有这样做。我认为无需太多努力就可以完成，但是您必须尝试一下。您还应该确保没有为“funptr”类定义生成代码，因为它们代表匿名类型，而不是 typedef。

5) 在您的目标项目中，定义一组类来表示原始 C 类型。

有了这个，您可以将函数指针类型定义为一个 «funptr» 类，其名称类似于“long(*)(char)”，用于接受 char 并返回 long 的函数。

在“retval”标签中，选择您在步骤 4 中定义的“long”类。

手动添加“par1”标签，如上选择“char”类。

您现在可以将此类用作属性或参数的类型，或 EA 允许类引用的任何其他位置（例如在不同的 «funptr» 类的“par1”标签中；这使您可以轻松地为其中一个参数本身就是函数指针类型的函数）。

这里最骇人听闻的一点是编号的“par1”-“parN”标签。虽然在 EA 中可以定义多个具有相同名称的标签（您可能必须更改标签值窗口选项才能看到它们），但我认为您无法在代码生成脚本中检索不同的值（即使你可以我认为不一定会保留顺序，并且参数顺序在C中很重要）。所以你需要事先决定参数的最大数量。在实践中不是一个大问题；设置说 20 个参数应该足够了。

这种方法对逆向工程没有帮助，因为 EA 9 不允许您自定义逆向工程过程。然而，即将到来的 EA 10（目前在 RC 1 中）将允许这样做，虽然我自己没有看过它，所以我不知道这将采取什么形式。

![在此处输入图像描述](../Images/f76f996c52bec4ef5fb870c21d2971e2.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T17:31:36.843

函数指针的定义超出了 UML 规范的范围。更重要的是，它是许多 UML 建模软件不支持的特定于语言的特性。因此，我认为您对第一个问题的一般回答建议避免使用此功能。您提供的技巧仅与 Enterprise Architect 相关，并且与其他 UML 建模工具不兼容。以下是一些其他 UML 软件支持函数指针的方式：

**MagicDraw** UML`C++FunctionPtr`对 FP 类成员使用 << >>构造型，`C++FunctionSignature`对函数原型使用 << >>。

代码示例（取自[官方网站](http://www.nomagic.com/support/demos.html)——参见“Modeling typedef and function pointer for C++ code generation”viewlet）：

```
class Pointer
{
    void (f*) ( int i );
} 
```

对应的UML模型：

![MagicDraw UML 中的函数指针](../Images/80be364e31e88cfaad6df483fb2c507f.png)

**Objecteering**使用相应的 C++ TypeExpr 注释定义 FP 属性。

**IBM 的Rational Software Architect**不支持函数指针。用户可以将它们添加到用户定义部分中生成的代码中，这些部分在代码->UML 和 UML->代码转换期间保持不变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T21:00:47.000

对我来说似乎是正确的。我不确定您是否应该深入了解描述单个函数指针的类型和关系的低级细节。我通常发现描述一个接口就足够了，不需要分解它的内部元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-08T11:57:43.553

我认为你可以用一个类虚拟地包装函数指针。我认为 UML 不必是代码的蓝图级别，记录概念更重要。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-04T20:06:42.573

我已经能够与 Enterprise Architect 合作。它有点笨拙的解决方案，但它满足了我的需求。我做了什么：

1.  创建一个名为 FuncPtr 的新类原型。我在这里遵循了指南： [http](http://www.sparxsystems.com/enterprise_architect_user_guide/10/extending_uml_models/addingelementsandmetaclass.html) ://www.sparxsystems.com/enterprise_architect_user_guide/10/extending_uml_models/addingelementsandmetaclass.html 当我这样做时，我为配置文件创建了一个新视图。所以我可以将它包含在我的主要项目之外。

2.  修改了类代码模板。基本上选择 C ​​语言并从 Class Template 开始，然后点击“Add New Stereotype Override”并添加 FuncPtr 作为新的覆盖。

3.  将以下代码添加到该新模板中：

> ```
> %PI="\n"%
> %ClassNotes%
> typedef %classTag:"returnType"% (*%className%)(
> %list="Attribute" @separator=",\n" @indent="    "%
> ); 
> ```

4.  修改了属性声明代码模板。和以前一样，添加一个新的 Stereotype

5.  将以下代码添加到新模板中：

> %PI=""% %attConst=="T" ? “常量”：“”%
> 
> %attType%
> 
> %attContainment=="通过引用" ? "*" : ""%
> 
> %attName%

这就是我在 Enterprise Architect 中获得函数指针所需要做的一切。当我想定义一个函数指针时，我只是：

1.  创建普通班级
2.  使用我想要的返回类型添加标签“returnType”
3.  为参数添加属性。

这样，它将创建一个新类型，该类型可以作为属性或参数包含在其他类（结构）和运算符中。我没有将它本身设为运算符，因为那样它就不会在工具内部被引用为您可以选择的类型。

所以它有点hacky，使用特殊的原型类作为函数指针的typedef。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-11T12:51:05.000

我的感觉是您希望将 UML 接口映射到 struct-with-function-pointers C 习惯用法。

Interface1 是模型中的重要元素。到处声明函数指针对象类型会使您的图表难以辨认。

Enterprise Architect 允许您指定自己的代码生成器。寻找[代码模板框架](http://www.sparxsystems.com/enterprise_architect_user_guide/software_development/codetemplates.html)。您应该能够借助一两个新的构造型来修改预先存在的 C 代码生成器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-06T17:40:01.170

像您的第一个示例一样，我将使用分类器，但将其隐藏在配置文件中。我认为他们已经将它包括在内以清楚地解释这个概念；但在实践中，刻板印象的整个想法是将细节抽象到配置文件中，以避免“噪音”问题。EA 非常适合处理配置文件。

我与您的第一个示例的不同之处在于我将分类***原始类型***刻板印象而不是***数据类型***刻板印象。数据类型是一个域范围对象，而原始类型是一个原子元素，其语义定义在 UML 范围之外。这并不是说你不能添加注释，尤其是在配置文件中，或者给它一个非常清晰的原型名称，比如 functionPointer。

# ruby-on-rails - 无法批量分配受保护的属性：_destroy

> ID：13663469
> 
> 赞同：1
> 
> 时间：2012-12-01T20:31:46.553
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, destroy

当我提交嵌套表单时，我遇到了这个非常奇怪的错误。

`Can't mass-assign protected attributes: _destroy`

知道为什么会这样吗？这有点令人担忧，因为我不得不暂时用 javascript 删除 'destroy' hidden_​​field，直到我弄清楚它是什么，这意味着我不能删除任何东西！

_ *form.html.erb*

```
<%= nested_form_for(@post, :html=> {:multipart => true, :class=> "new_blog_post", :id=> "new_blog_post"}) do |f| %>

 <%= field do %>
    <%= f.text_field :title, placeholder: "Give your post a title", :class=>"span12" %>
 <% end %>

 <%= field do %>
    <%= f.text_area :body, placeholder: "Write something here...", :id=>"blog-text", :class=>"span12" %>
 <% end %>

 <%= f.label :search_locations, "Add locations to your post" %>
    <%= text_field_tag :name,"",:class=>"localename", :id=>"appendedInput", :placeholder=> "Name of the location", :autocomplete => "off" %>
    <%= f.link_to_add "Add a location", :locations %>

 <%= actions do %>
   <%= f.submit "Submit", :class=>"btn", :disable_with => 'Uploading Image...' %>

<% end end%> 
```

_posts_controller.rb_

```
class PostsController < ::Blogit::ApplicationController   

...   

def new
  @post = current_blogger.blog_posts.new(params[:post])
  @location = @post.locations.build

end

def edit
  @post = Post.find(params[:id])
  #@post = current_blogger.blog_posts.find(params[:id]) removed so any use can edit any post
  @location = @post.locations.build
end

def create
   location_set = params[:post].delete(:locations_attributes) unless params[:post][:locations_attributes].blank?

   @post = current_blogger.blog_posts.new(params[:post])

   @post.locations = Location.find_or_initialize_location_set(location_set) unless location_set.nil?

 if @post.save
    redirect_to @post, notice: 'Blog post was successfully created.'
  else
    render action: "new"
  end
end

def update
  @post = current_blogger.blog_posts.find(params[:id])
  if @post.update_attributes(params[:post])
    redirect_to @post, notice: 'Blog post was successfully updated.'
  else
    render action: "edit"
  end
end

def destroy
  @post = current_blogger.blog_posts.find(params[:id])
  @post.destroy
  redirect_to posts_url, notice: "Blog post was successfully destroyed."
end 
```

*位置.rb*

```
class Location < ActiveRecord::Base
  after_save { |location| location.destroy if location.name.blank? }

  has_many :location_post
  has_many :posts, :through => :location_post
  has_many :assets

   attr_accessible :latitude, :longitude, :name, :post_id, :notes, :asset, :assets_attributes
    accepts_nested_attributes_for :assets, :allow_destroy => true
    include Rails.application.routes.url_helpers

  def self.find_or_initialize_location_set(location_set)
   locations = []
   locations = locations.delete_if { |elem| elem.flatten.empty? }
   location_set.each do |key, location|

    locations << find_or_initialize_by_name(location)
  end
     locations
  end

 end 
```

编辑：

*new.html.erb 中呈现形式的片段*

```
 <div class="row span locsearch">      
       <div class="input-append span3">

        <input autocomplete="off" class="localename" id="appendedInput" name="name" placeholder="Name of the location" type="text" value="">

        <span class="add-on"><input id="post_locations_attributes_0__destroy" name="post[locations_attributes][0][_destroy]" type="hidden" value="false"><a href="javascript:void(0)" class="remove_nested_fields" data-association="locations"><i class="icon-trash"></i></a></span>  </div>

<div class="latlong offset3 span4"> <p class="help-block">Enter the name of the town or city visited in this blog entry.</p>
        </div>

        <input class="LegNm" id="post_locations_attributes_0_name" name="post[locations_attributes][0][name]" type="hidden" value="Dresden">
        <input class="long" id="post_locations_attributes_0_longitude" name="post[locations_attributes][0][longitude]" type="hidden" value="13.7372621">
        <input class="lat" id="post_locations_attributes_0_latitude" name="post[locations_attributes][0][latitude]" type="hidden" value="51.0504088">

    </div>  
</div> 
```

编辑2：

*post.rb*

```
class Post < ActiveRecord::Base

require "acts-as-taggable-on"
require "kaminari"

acts_as_taggable    

self.table_name = "blog_posts"

self.paginates_per Blogit.configuration.posts_per_page

# ==============
# = Attributes =
# ==============
attr_accessible :title, :body, :tag_list, :blogger_id, :coverphoto, :locations_attributes

# ===============
# = Photo Model =
# ===============

    has_attached_file :coverphoto,
                :styles => {
                  :coverbar => "600x300>", :medium => "250x250^" , :thumb => "100x100^"},
                  #:source_file_options =>  {:all => '-rotate "-90>"'},
                  :storage => :s3,
                  :s3_credentials => "#{Rails.root}/config/s3.yml",
                  :bucket => "backpackbug",
                  :path => "/:style/:id/:filename"                

# ===============
# = Validations =
# ===============

validates :title, presence: true, length: { minimum: 6, maximum: 66 }
validates :body,  presence: true, length: { minimum: 10 }
validates :blogger_id, presence: true

# =================
# = Associations =
# =================    

belongs_to :blogger, :polymorphic => true
has_many :location_post
has_many :locations, :through => :location_post
belongs_to :profile
accepts_nested_attributes_for :locations, :allow_destroy => true, :reject_if => proc { |attributes| attributes['name'].blank? }

end end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:49:30.440

这是通过结合这个和另一个答案来解决的，在这里找到：

[如何修复此创建功能？](https://stackoverflow.com/questions/13688896/how-can-i-fix-this-create-function/13689476#13689476)

短期修复是添加 attr_accessible :_destroy 和 attr_accessor :_destroy。

谢谢两位！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T22:57:39.090

添加`:_destroy`到您的`attr_accessible`列表

```
attr_accessible ...., :_destroy 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-02T13:07:10.430

你应该写信给 post.rb，

```
 attr_accessible: locations_atributes 
```

和

```
accepts_nested_attributes_for :locations, :allow_destroy => true 
```

当您通过 post 对象更新位置对象时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-03T15:30:16.810

替换`f.hidden_field`它必须保持不变（第2行）

```
 module ApplicationHelper
  def link_to_remove_fields(name, f)
    text_field_tag(:_destroy) + link_to_function(name, "remove_fields(this)")
  end 
```

# linq - 如何合并两个 Linq IEnumerable 查询而不运行它们？

> ID：13663470
> 
> 赞同：5
> 
> 时间：2012-12-01T20:32:03.883
> 
> 标签：linq, task-parallel-library, ienumerable

如何合并`List<T>`基于 TPL 的任务以供以后执行？

```
 public async IEnumerable<Task<string>> CreateTasks(){ /* stuff*/ } 
```

我的假设是[`.Concat()`](http://msdn.microsoft.com/en-us/library/bb882641.aspx)...

```
 void MainTestApp()  // Full sample available upon request.
     {
        List<string> nothingList = new List<string>();
        nothingList.Add("whatever");
        cts = new CancellationTokenSource();

         delayedExecution =
            from str in nothingList
            select AccessTheWebAsync("", cts.Token);
         delayedExecution2 =
          from str in nothingList
          select AccessTheWebAsync("1", cts.Token);

         delayedExecution = delayedExecution.Concat(delayedExecution2);
     }

    /// SNIP

    async Task AccessTheWebAsync(string nothing, CancellationToken ct)
    {
        // return a Task
    } 
```

我想确保这不会产生任何任务或评估任何东西。事实上，我想我在问“什么逻辑上执行 IQueryable 到返回数据的东西”？

**背景**

由于我正在进行递归并且我不想在正确的时间之前执行此操作，如果多次调用合并结果的正确方法是什么？

如果重要的话，我正在考虑运行此命令来启动`var AllRunningDataTasks = results.ToList();`此代码后跟的所有任务：

```
while (AllRunningDataTasks.Count > 0)
{
    // Identify the first task that completes.
    Task<TableResult> firstFinishedTask = await Task.WhenAny(AllRunningDataTasks);

    // ***Remove the selected task from the list so that you don't
    // process it more than once.
    AllRunningDataTasks.Remove(firstFinishedTask);

    // TODO: Await the completed task.
    var taskOfTableResult = await firstFinishedTask;

    // Todo: (doen't work)
    TrustState thisState = (TrustState)firstFinishedTask.AsyncState;

    // TODO: Update the concurrent dictionary with data
    // thisState.QueryStartPoint + thisState.ThingToSearchFor 

    Interlocked.Decrement(ref thisState.RunningDirectQueries);
    Interlocked.Increment(ref thisState.CompletedDirectQueries);

    if (thisState.RunningDirectQueries == 0)
    {
        thisState.TimeCompleted = DateTime.UtcNow;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T17:00:13.100

要回答具体问题“什么逻辑上执行 IQueryable 到返回数据的东西”？这将是任何强制产生至少一个值，或强制发现一个值是否可用的东西。

例如，`ToList`、`ToArray`、`First`、`Single`、`SingleOrDefault`和`Count`都将强制求值。（虽然`First`不会评估整个集合 - 它会检索第一个项目然后停止。）这些都必须至少开始检索值，因为如果不这样做，它们中的任何一个都无法返回它们返回的值。在 and 的情况下`ToList`，`ToArray`这些返回完全填充的非惰性集合，这就是他们必须评估所有内容的原因。返回单个项目的方法至少需要询问第一个项目，然后这些`Single`方法将继续检查如果继续评估是否没有其他结果（如果结果更多，则抛出异常）。

使用`foreach`迭代查询也将强制评估。（同样，出于同样的原因：您向它询问集合中的实际值，因此它必须提供它们。）

`Concat`不会立即评估，因为它不需要 - 只有当您向串联序列询问一个值时，它才需要向其输入询问值。

顺便说一句，尽管您在这里的示例中询问过`IQueryable`您没有使用它。这可能很重要，因为与您实际获得的 LINQ to Objects 实现（您获得 plain `IEnumerable<T>`）相比，它的工作方式存在一些差异。我认为这在这个示例中没有什么不同，但它让我想知道您的原始代码与您在此处发布的用于说明的版本之间是否可能发生了变化？这很重要，因为不同的 LINQ 提供者可以以不同的方式做事。绝对使用延迟评估的`IEnumerable<T>`味道`Concat`，虽然我希望大多数其他 LINQ 实现都是如此，但这并不是绝对的。

如果您需要多次使用结果，并且您想确保只评估一次，但直到您真正需要它们时才评估它们，那么通常的方法是`ToList`在您确实需要时调用进行评估，然后保留结果`List<T>`，以便您可以再次使用它。一旦您以`List<T>`（或数组）形式获得数据，您就可以根据需要多次使用该列表。

顺便说一句，你的第一个问题有一个问题：

“如何合并基于 TPL 的任务列表以供以后执行？”

一般来说，如果您已经有一个 TPL 任务，那么您无法阻止它执行。（有一个例外。如果您`Task`直接构造 a 而不是使用一种更正常的创建方法，它实际上不会运行，直到您告诉它。但通常，返回任务的 API 返回实时任务，即，当您拿到它们时，它们很可能已经在运行，甚至已经完成。）

您的示例中的“稍后执行”来自这样一个事实，即您实际上根本没有要开始的任务列表。（如果您确实有一个`List<T>`任务，那么“稍后执行”将不是一个选项。）您拥有的是几个可枚举，如果您要评估它们，它们将创建任务。创建任务的行为与在任何返回任务的 TAP 样式 API 中启动它的行为是不可分割的。

根据您所写的其余内容，我*认为*您真正要问的是：

“我如何将多个`IEnumerable<Task<T>>`对象合并为一个对象`IEnumerable<Task<T>>`，从而推迟对基础枚举的评估，直到组合的可枚举本身被评估？”

`Concat`应该为此工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T05:01:15.410

以下是合并数据的一种 hacky 方式...我不喜欢在 Main 或此示例的其他一些方面使用“nothingList”的方式，但它似乎完成了工作并允许我合并待处理的任务。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

// Add a using directive and a reference for System.Net.Http.
using System.Net.Http;

// Add the following using directive.
using System.Threading;

namespace ProcessTasksAsTheyFinish
{
    public partial class MainWindow : Window
    {
        // Declare a System.Threading.CancellationTokenSource.
        CancellationTokenSource cts;
        List<IEnumerable<Task>> launchList = new List<IEnumerable<Task>>();

        public MainWindow()
        {
            InitializeComponent();

            List<string> nothingList = new List<string>();
            nothingList.Add("whatever");

            cts = new CancellationTokenSource();

             delayedExecution =
                from str in nothingList
                select AccessTheWebAsync("", cts.Token);

             List<string> nothingList2 = new List<string>();
             nothingList2.Add("whatever");

             delayedExecution2 =
              from str in nothingList2
              select AccessTheWebAsync("1", cts.Token);

             launchList.Add(delayedExecution);
             launchList.Add(delayedExecution2);

             delayedExecution = delayedExecution.Concat(delayedExecution2);
        }
        IEnumerable<Task> delayedExecution = null;
        IEnumerable<Task> delayedExecution2 = null;

        private async void startButton_Click(object sender, RoutedEventArgs e)
        {
            resultsTextBox.Clear();

            // Instantiate the CancellationTokenSource.

            try
            {
                // ***Set up the CancellationTokenSource to cancel after 25 seconds.
                //cts.CancelAfter(250000);

                var test  =  delayedExecution;// AccessTheWebAsync("", cts.Token);

                var testList = test.ToList();

                while (testList.Count() > 0)
                {
                    var firstFinishedTask = await Task.WhenAny(testList);
                    testList.Remove(firstFinishedTask);

                      await firstFinishedTask;
                }

                resultsTextBox.Text += "\r\nDownloads complete.";
            }
            catch (OperationCanceledException tee)
            {
                resultsTextBox.Text += "\r\nDownloads canceled.\r\n";
            }
            catch (Exception)
            {
                resultsTextBox.Text += "\r\nDownloads failed.\r\n";
            }

            cts = null;
        }

        private void cancelButton_Click(object sender, RoutedEventArgs e)
        {
            if (cts != null)
            {
                cts.Cancel();
            }
        }

        async Task<string> AccessTheWebAsync(string nothing, CancellationToken ct)
        {
            // CHANGE THIS VALUE TO CONTROL THE TESTING
            bool delayConversionOfQueryToList = false;

            HttpClient client = new HttpClient();

            // Make a list of web addresses.
            List<string> urlList = null;

            if (nothing == "1")
            {
                urlList = SetUpURLList2();
            }
            else urlList = SetUpURLList();

            // ***Create a query that, when executed, returns a collection of tasks.
            IEnumerable<Task<int>> downloadTasksQuery =
                from url in urlList select ProcessURL(url, client, ct);

            // DEBUG!!!
            if (delayConversionOfQueryToList == true)
            {
                await Task.Delay(10000);
                resultsTextBox.Text += String.Format("\r\nDelay of IQueryable complete.  Tip: Did you see any IsRunning messages?");
            }

            // ***Use ToList to execute the query and start the tasks. 
            List<Task<int>> downloadTasks = downloadTasksQuery.ToList();

            // DEBUG!!!
            if (delayConversionOfQueryToList == false)
            {
                await Task.Delay(10000);
                resultsTextBox.Text += String.Format("\r\nDelay of .ToList() complete.   Tip: Did you see any IsRunning messages?");
            }

            // ***Add a loop to process the tasks one at a time until none remain.
            while (downloadTasks.Count() > 0)
            {
                // Identify the first task that completes.
                Task<int> firstFinishedTask = await Task.WhenAny(downloadTasks);

                resultsTextBox.Text += String.Format("\r\nID  {0}", firstFinishedTask.Id);

                // ***Remove the selected task from the list so that you don't
                // process it more than once.
                downloadTasks.Remove(firstFinishedTask);

                // Await the completed task.
                int length = await firstFinishedTask;
                resultsTextBox.Text += String.Format("\r\nLength of the download:  {0}", length);
            }

            return nothing;
        }

        private List<string> SetUpURLList()
        {
            List<string> urls = new List<string> 
            { 
                "http://msdn.microsoft.com",
                "http://msdn.microsoft.com/library/windows/apps/br211380.aspx",
                "http://msdn.microsoft.com/en-us/library/hh290136.aspx",
                "http://msdn.microsoft.com/en-us/library/dd470362.aspx",
                "http://msdn.microsoft.com/en-us/library/aa578028.aspx",
                "http://msdn.microsoft.com/en-us/library/ms404677.aspx",
                "http://msdn.microsoft.com/en-us/library/ff730837.aspx"
            };
            return urls;
        }
        private List<string> SetUpURLList2()
        {
            List<string> urls = new List<string> 
            { 
                "http://www.google.com",

            };
            return urls;
        }

        async Task<int> ProcessURL(string url, HttpClient client, CancellationToken ct)
        {
            resultsTextBox.Text += String.Format("\r\nIS RUNNING {0}", url);

            // GetAsync returns a Task<HttpResponseMessage>. 
            HttpResponseMessage response = await client.GetAsync(url, ct);
            // Retrieve the website contents from the HttpResponseMessage.
            byte[] urlContents = await response.Content.ReadAsByteArrayAsync();

           // Thread.Sleep(3000);
           // await Task.Delay(1000, ct);
           return urlContents.Length;
        }
    }
}

// Sample Output:

IS RUNNING http://msdn.microsoft.com
IS RUNNING http://msdn.microsoft.com/library/windows/apps/br211380.aspx
IS RUNNING http://msdn.microsoft.com/en-us/library/hh290136.aspx
IS RUNNING http://msdn.microsoft.com/en-us/library/dd470362.aspx
IS RUNNING http://msdn.microsoft.com/en-us/library/aa578028.aspx
IS RUNNING http://msdn.microsoft.com/en-us/library/ms404677.aspx
IS RUNNING http://msdn.microsoft.com/en-us/library/ff730837.aspx
IS RUNNING http://www.google.com
Delay of .ToList() complete.   Tip: Did you see any IsRunning messages?
ID  1
Length of the download:  48933
ID  2
Length of the download:  375328
ID  3
Length of the download:  220428
ID  4
Length of the download:  222256
ID  5
Length of the download:  229330
ID  6
Length of the download:  136544
ID  7
Length of the download:  207171
Delay of .ToList() complete.   Tip: Did you see any IsRunning messages?
ID  8
Length of the download:  43945
Downloads complete. 
```

# c++ - 我如何在monodevelop（C++）中链接SDL和GL

> ID：13663474
> 
> 赞同：1
> 
> 时间：2012-12-01T20:32:23.137
> 
> 标签：c++, linux, monodevelop

[我正在尝试使用 openGL 和 SDL 编译一个简单的程序，但我似乎无法在](http://monodevelop.com/documentation/creating_c_and_cpp_projects)monodevelop 中链接库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T23:17:56.280

您需要下载[`Tao Framework`](http://sourceforge.net/projects/taoframework/?source=dlp)SDL 和 OpenGL dll 并将其添加到项目引用中。

有关更多详细信息，请参见[此处](http://www.sdltutorials.com/settings-up-monodevelop-to-run-tao)。

# c# - 敏捷包后代功能问题

> ID：13663477
> 
> 赞同：2
> 
> 时间：2012-12-01T20:32:48.067
> 
> 标签：c#, html-agility-pack

```
 public string getContent(string webAddress)
    {
        HtmlAgilityPack.HtmlWeb web = new HtmlAgilityPack.HtmlWeb();
        HtmlDocument doc = web.Load(webAddress);
        return string.Join(" ", doc.DocumentNode.Descendants().Select(x => x.InnerText));
    } 
```

我正在使用此功能试图检查该功能的作用！但是我得到了一个异常，它告诉我函数 Decendants 在当前上下文中不存在！虽然我已经包含了敏捷包的引用 dll！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T08:42:04.067

您需要使用`htmlagilitypack`支持`LINQ`兼容集合的最新版本来导航 HTML 树

使用这个[最新](http://htmlagilitypack.codeplex.com/releases/view/90925)版本！

# gcc - 从内联汇编访问结构成员？

> ID：13663478
> 
> 赞同：3
> 
> 时间：2012-12-01T20:32:48.067
> 
> 标签：gcc, inline-assembly, gnu-assembler

我正在尝试使用内联汇编将一堆结构成员（`Particle`是指向此类结构的指针）加载到一些寄存器中。这是我最初的解决方案：

```
asm("mov    %1(%0), %%edx\n"
    "fld    %2(%0)\n"
    "fld    %3(%0)\n"
    "fld    %4(%0)\n"
    "fld    %5(%0)\n"
    "movups %6(%0), %%xmm1\n"
    "movups %7(%0), %%xmm2\n"
    "movups %8(%0), %%xmm3\n"
    "movups %9(%0), %%xmm4\n"
    :
    : "r" (Particle),
        "n" (offsetof(ptcParticle, Active)),
        "n" (offsetof(ptcParticle, Size)),
        "n" (offsetof(ptcParticle, Rotation)),
        "n" (offsetof(ptcParticle, Time)),
        "n" (offsetof(ptcParticle, TimeScale)),
        "n" (offsetof(ptcParticle, Colour)),
        "n" (offsetof(ptcParticle, Location)),
        "n" (offsetof(ptcParticle, Velocity)),
        "n" (offsetof(ptcParticle, Accel))
    : "%edx", "%st", "%st(1)", "%st(2)", "%st(3)", "%xmm1", "%xmm2",
        "%xmm3", "%xmm4"
); 
```

但是，它不起作用，因为 GCC 将这些偏移量输出为立即数文字，如下所示：

```
mov     $0(%eax), %edx
fld     $44(%eax)
fld     $40(%eax)
fld     $8(%eax)
fld     $4(%eax)
movups  $12(%eax), %xmm1
movups  $28(%eax), %xmm2
movups  $48(%eax), %xmm3
movups  $60(%eax), %xmm4 
```

结果，在表达式之后被`gas`视为`(%eax)`垃圾：

```
Error: junk `(%eax)' after expression 
```

如果我只能摆脱输出中的美元符号，这将起作用。知道如何访问结构成员吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T10:03:16.543

好的，我想通了 -`%c`需要操作员。我写了这个帮助宏：

```
#define DECLARE_STRUCT_OFFSET(Type, Member)     \
    [Member] "i" (offsetof(Type, Member)) 
```

并像这样使用它：

```
 asm("mov    %c[Active](%0), %%edx\n"
        "fld    %c[Size](%0)\n"
        "fld    %c[Rotation](%0)\n"
        "fld    %c[Time](%0)\n"
        "fld    %c[TimeScale](%0)\n"
        "movups %c[Colour](%0), %%xmm1\n"
        "movups %c[Location](%0), %%xmm2\n"
        "movups %c[Velocity](%0), %%xmm3\n"
        "movups %c[Accel](%0), %%xmm4\n"
        :
        : "r" (Particle),
            DECLARE_STRUCT_OFFSET(ptcParticle, Active),
            DECLARE_STRUCT_OFFSET(ptcParticle, Size),
            DECLARE_STRUCT_OFFSET(ptcParticle, Rotation),
            DECLARE_STRUCT_OFFSET(ptcParticle, Time),
            DECLARE_STRUCT_OFFSET(ptcParticle, TimeScale),
            DECLARE_STRUCT_OFFSET(ptcParticle, Colour),
            DECLARE_STRUCT_OFFSET(ptcParticle, Location),
            DECLARE_STRUCT_OFFSET(ptcParticle, Velocity),
            DECLARE_STRUCT_OFFSET(ptcParticle, Accel)
        : "%edx", "%st", "%st(1)", "%st(2)", "%st(3)", "%xmm1", "%xmm2",
            "%xmm3", "%xmm4"
    ); 
```

生成的程序集现在是正确的，一切似乎都正常。

# c++ - stl 堆栈对象的大小限制

> ID：13663481
> 
> 赞同：4
> 
> 时间：2012-12-01T20:33:09.517
> 
> 标签：c++, stl, stack

a 的大小有限制`std::stack`吗？

我使用 a`std::stack<std::pair<int,std::string>>`作为我的堆栈，当条目数超过大约 100 万时，我收到运行时错误。

这是由于大小的限制`std::stack`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T20:37:37.340

`std::stack`是一个容器适配器。它只是其他一些容器的正面，使它看起来像一个堆栈。考虑一下，如果您将名称替换为并将名称替换为 ，`std::vector`则可以将其视为堆栈。因此，任何大小限制或类似限制都将是支持容器的结果，而不是.`push``push_back``pop``pop_back``std::stack`

的默认支持容器`std::stack`是`std::deque`( `N3376 23.6.5.2 [stack.defn]`)。该标准要求`std::deque`提供一个`max_size`成员函数 ( )，它告诉您根据实现限制可以容纳`N3376 23.3.3.1 [deque.overview]/2`的最大元素数。`std::deque`这通常类似于`std::numeric_limits<std::deque<t>::size_type>::max()`.

但是，您更有可能遇到机器内存限制，或者在应用程序的其他地方有一些错误导致运行时错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-02T08:26:00.470

`std::stack`容器适配器的底层容器放置在`protected`部分中，[可以按名称访问](http://en.cppreference.com/w/cpp/container/stack) （通过完全限定名称从派生类或通过使用derective`c`引入类名称空间）。`using`默认基础容器是`std::deque`. `std::deque`,`std::list`或`std::vector`. 它们都提供`max_size()`成员函数，返回可分配的最大大小。 上述容器的[权威来源](http://en.cppreference.com/w/cpp/container/list/max_size)WRT成员函数表示：`max_size()`

> **笔记**
> 
> 该值通常等于 std::numeric_limits::max()，并反映容器大小的理论限制。在运行时，容器的大小可能会被限制为小于 max_size() 可用 RAM 量的值。

因此，`max_size()`智能实现的返回值可以依赖于可分配的 RAM。

要访问`std::stack<>::c.max_size()`一个应该编写一个派生`std::stack<>`类，如下所示：

```
#include <iostream>
#include <stack>

#include <cstdlib>

template< typename type >
struct my_stack
    : std::stack< type >
{

    using base = std::stack< type >;
    using base::base;
    using base::operator =;

    std::size_t
    max_size() const
    {
        return base::c.max_size();
    }

};

int
main()
{
    my_stack< int > s;
    std::cout << s.max_size() << std::endl;
    return EXIT_SUCCESS;
} 
```

# objective-c - NSArray 不需要的释放

> ID：13663483
> 
> 赞同：0
> 
> 时间：2012-12-01T20:33:12.030
> 
> 标签：objective-c, macos

我是集合编程的新手，所以我遇到了这个问题。任何帮助将不胜感激...

我在类初始化中初始化了一个 NSArray 实例（我已经在头文件中将其定义为该类的属性，因此 ia 必须可以在该类实现中的任何位置访问它）并使用 `+(NSArray*) arrayWithObjects: ;`. init 方法中的每一件事都很好，但是，......

当我想在更新方法中使用该数组时，应用程序崩溃，因为该数组已**DEALLOCATED**。

为什么那个数组被释放了？我该如何预防？

谢谢 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:47:59.887

如果你不使用 ARC，那么你应该用 initWithObjects 初始化它，然后保留它。
如果您使用 ARC，可能它只是一个弱引用。在声明属性时使其成为强引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T20:37:54.350

您应该`alloc`使用 NSArray 并改用`-initWithObjects`方法。

`NSArray* tempArray = [[NSArray alloc] initWithObjects:(id), ..., nil]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T20:41:21.333

如果你像这样初始化数组，

```
objects = [NSArray arrayWithObjects: buttonOne, buttonTwo, 
                                     textField, nil]; 
```

它是一种传统的方法，它只是在一次对象访问后自动释放对象。相反，您可以`retain`使用对象，也可以像这样分配和初始化它

```
objects = [NSArray alloc] initWithObjects: buttonOne, buttonTwo, 
                                     textField, nil]; 
```

# java - 使用 SIP 和 RTP 的简单聊天应用程序

> ID：13663485
> 
> 赞同：2
> 
> 时间：2012-12-01T20:33:17.100
> 
> 标签：java, sip, voip, rtsp, rtp

我想使用 SIP 和 RTP 创建一个简单的 JAVA 语音聊天应用程序。其实我了解SIP，RTP，RTCP和RTSP的理论概念。但是，当涉及到JAVA编程时，我不知道如何开始！有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-14T13:10:51.380

好的，我已经做了一段时间了，我想与像我这样的其他初学者分享它。我使用了非常易于理解的 Android SIP API，并使用 Mobicents TOMCAT SIP Servlet 作为我的 SIP 服务器。它就像魅力一样！

# java - 如何以类似于 c/c++ 和 LLVM 的方式在 java 中编写简单的 VM

> ID：13663491
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:34:00.300
> 
> 标签：java, llvm, vm-implementation

我想用有限的java指令创建一个非常简约的虚拟机。我知道如何在 c/c++ 中结合 LLVM 进行操作，但我也想在 java 中尝试它，因为我无法访问 LLVM，我该如何在 java 中进行操作，我该如何模拟这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:51:24.733

如果你想编译成 Java 字节码，那么你可能想要使用像 ASM 这样的库：它是为生成和操作字节码而设计的：

*   [http://asm.ow2.org/](http://asm.ow2.org/)

许多 JVM 语言（例如 Clojure、Groovy）使用 ASM 或类似的东西作为底层字节码生成器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T11:32:58.680

要使用 JVM，您必须在 JVM 工作方式的约束范围内工作，即运行字节码。这意味着您必须生成字节码或编译的 Java 源代码。如果您使用 Java 源选项，您可以生成“指令”，这些指令使用方法调用作为一种非常轻量级（对于开发人员）实现它的方式来实现。

# javascript - 尝试更新数据库时出现 jQuery 可排序错误

> ID：13663492
> 
> 赞同：0
> 
> 时间：2012-12-01T20:34:02.807
> 
> 标签：javascript, jquery, user-interface, jquery-ui-sortable

我正在使用 jQuery sortable 让用户能够对显示的订单图像进行排序。但是我无法将实际订单发送到 php 脚本

JS：

```
$( ".sort-p-images" ).sortable({
    stop: function(event, ui){
        var form_data = { order: $(".sort-p-images").sortable('toArray')) }
        $.ajax({
            url: "update_img_order",
            type: "POST",
            data: form_data,
            dataType: "json",
            cache: false,
            success: function(json)
            {
                console.log('ajax done');
            }
        });
    }
}); 
```

我得到的错误是： `Uncaught SyntaxError: Unexpected token }`

为什么我不能将它包含在变量下`form_data`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:37:31.173

去掉多余的括号：

`var form_data = { order: $(".sort-p-images").sortable('toArray')) }`

将其更改为：

`var form_data = {order: $(".sort-p-images").sortable('toArray')};`

# flash - 从外部 txt 文件加载

> ID：13663495
> 
> 赞同：0
> 
> 时间：2012-12-01T20:34:11.903
> 
> 标签：flash, actionscript-2, flash-cs5.5

嗨，我想使用 Actionscript 2 将外部 .txt 文件加载到 Flash CS5.5 中的动态文本字段，但它仅加载 609 行（13070 个字符）！！！好吧，这个列表真的很大，大约有 2500 多行……我需要全部加载……我使用了这些代码：

```
myData = new LoadVars();
myData.onLoad = function() {
textInstance.text = this.myVariable;
};
myData.load("Shopids.txt"); 
```

如果您知道将大量文本加载到动态文本字段的任何替代方法，请帮助我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T13:45:03.320

哇，我自己找到了答案：D

我的文本文件有“ **&** ”符号.....

在我删除它之后，所有的内容都被加载了:)

我希望这对某些人有用！

# git - 推送到 bitbucket 时出现错误“inotify_add_watch”

> ID：13663496
> 
> 赞同：0
> 
> 时间：2012-12-01T20:34:22.327
> 
> 标签：git, push, bitbucket, inotify

将某个项目的任何分支推送到 bitbucket 时，我突然开始出错。

当我这样做时：`git push`，我得到以下信息：

```
inotify_add_watch: No such file or directory
registerToSubTree : warning, failed to register /home/user/workspace/project/.git/refs/remotes/origin/dev.lock :Error watching /home/user/workspace/project/.git/refs/remotes/origin/dev.lock : No such file or directory 
```

这可能是什么原因造成的？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-25T23:01:04.103

从命令行提交时我刚刚遇到此错误（使用带有 git 1.8.1.2 的 Ubuntu 13.04）。

```
$:~/dev/myLogger$ git push origin master
**Everything up-to-date**
inotify_add_watch: No such file or directory
registerToSubTree : warning, 
    failed to register /home/me/dev/myLogger/.git/refs/remotes/origin/master.lock :
    Error watching /home/me/dev/myLogger/.git/refs/remotes/origin/master.lock : No such file or directory 
```

我打开了 Eclipse（带有用于 HTML 开发的 Aptana 插件）。

关闭 Eclipse 并重新运行命令，错误就消失了。

# php - PHP 下载脚本有效，但客户端浏览器无法下载

> ID：13663499
> 
> 赞同：0
> 
> 时间：2012-12-01T20:34:36.693
> 
> 标签：php, download, http-headers

该脚本适用于我的 http 文件服务器。我的文件来自 web 根目录，所以我使用 php 脚本来抓取文件并将其发送到客户端。问题是，当我单击文件下载浏览器（ff 和 chrome）时，不会询问我是否要保存文件。在 chrome 的网络工具中，在网络下，我看到 download.php 确实执行成功。事实上，我什至可以看到文件以字节为单位的请求传输到了哪里。但下载的文件不在客户端计算机上。为什么浏览器客户端不询问/下载文件？

Web 服务器是 Nginx。

```
<?php

$path = "/trunk/";
$file = $_POST['filename'];
$file_ext = pathinfo($file, PATHINFO_EXTENSION);
$file_name = pathinfo($file, PATHINFO_BASENAME);
$file_full = $path . $file_name;

$finfo = new finfo(FILEINFO_MIME_TYPE);

$ctype = $finfo -> file($file_full);
header("Content-Disposition: attachment; filename=\"".$file_name."\"");
header("Content-Type: " .$ctype);
header("Content-Length: " .filesize($file_full));
error_log(filesize($file_full));

readfile($file_full);

?> 
```

请求标头：

```
POST /php/download.php HTTP/1.1

    Host: www.example.com
    Connection: keep-alive
    Content-Length: 146
    Origin: https://www.example.com
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.79 Safari/537.4
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMA7u5AkYPL9qGmRY
    Accept: */*
    Referer: https://www.example.com/index.php
    Accept-Encoding: gzip,deflate,sdch
    Accept-Language: en-US,en;q=0.8
    Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

响应标题

```
HTTP/1.1 200 OK
Server: nginx
Date: Sat, 01 Dec 2012 20:22:28 GMT
Content-Type: application/zip
Content-Length: 75090
Connection: keep-alive
Keep-Alive: timeout=300
X-Powered-By: PHP/5.4.6--pl0-gentoo
Content-Disposition: attachment; filename="try.zip"
Expires: Sat, 01 Dec 2012 20:22:27 GMT
Cache-Control: no-cache 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T09:45:06.697

使用*Content-Type: application/octet-stream*来保证在所有浏览器中强制下载。如果您知道您正在发送二进制内容（如您的 zip），那么也添加*Content-Transfer-Encoding: binary*。

# php - 使用 oop php 以 html 形式显示用户特定数据

> ID：13663504
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:35:53.153
> 
> 标签：php, oop

我想显示一个特定于用户的表单及其个人详细信息，然后允许他更新该信息。但为了做到这一点，我需要在表格中显示他的详细信息，以便他可以更新它们。

我在 MyClass 类中有一个函数 ShowUserInformation()：

```
function ShowUserInformation()
{
    $query = "SELECT id, name, email FROM saloni WHERE id = '$_SESSION[ID_korisnika]'";
    $result = mysql_query($query);
    while($row=mysql_fetch_array($result)):
        $id= $row['id'];
        $name= $row['name'];
        $email = $row['email'];
    endwhile;   

    return $result;
} 
```

我的问题是：如何在文本框中的另一个页面上显示 $name、$email 或 $id 的值？

如果我以程序方式执行此操作，它会在我执行此操作时起作用：

```
<input type="text" value="<?php echo $name ?>" name="name" class="" /> 
```

但是，我怎样才能以 oop 方式显示 $name、$email、$ID...？而且不会只有这 3 个变量，还会有更多，所以我需要一些可以应用的东西。我已经包含了文件，创建了对象...

```
$my_class = new MyClass; //create an object of class 
```

HTML - 我试过这样的东西......

```
<input type="text" value="<?php echo $my_class->ShowUserInformation($name)?>" name="name" class="" /> 
```

我是 PHP 和 oop 的新手，所以对我来说很容易:)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T20:53:23.580

快速而肮脏的方式：

```
class YourClass {

    /**
     * Ident
     */
    public $id;

    /**
     * Name
     */
    public $name;

    /**
     * Mail
     */
    public $email;

    public function showUserInformation($name) {

        //[...]        

        while($row=mysql_fetch_array($result)):
            $this->id= $row['id'];
            $this->name= $row['name'];
            $this->email = $row['email'];
        endwhile; 

        //[...] 

    }
}

<input type="text" value="<?php echo $my_class->name?>" name="name" class="" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T20:50:24.487

你**ShowUserInformation()**函数必须返回一个**$name**。在你编写一个函数返回**$result**

HTML 必须是这样的：

```
<input type="text" value="<?php echo $my_class->ShowUserInformation() ?> name="name" class="" /> 
```

# android - java.lang.RuntimeException：无法启动活动 ComponentInfo java.lang.ClassCastException

> ID：13663508
> 
> 赞同：0
> 
> 时间：2012-12-01T20:36:23.230
> 
> 标签：android

我正在写一个数独应用程序。我想做一个主视图和拼图视图，但是当我完成第二个活动时，它崩溃了。

这是我的主要活动的 onCreate 函数：

```
public class Main extends Activity {
    private Button button1, button3,button4;
    PuzzleView puzzleview;
    Score score;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        puzzleview = new PuzzleView(this);
        score = new Score(this);

        setContentView(R.layout.activity_main);

        button1 = (Button)findViewById(R.id.button1);
        button1.setOnClickListener(new Button.OnClickListener(){
             public void onClick(View v) {
                setContentView(puzzleview);
             }
        });

        button4 = (Button)findViewById(R.id.button4);
        button4.setOnClickListener(new Button.OnClickListener(){
             public void onClick(View v) {
                setContentView(score);
             }
        });
    } 
```

这是我的第二个活动的 onCreate：

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        main = new Main();
        puzzleview = new PuzzleView(this);
        puzzleview.requestFocus();
    } 
```

这个 LogCat：

```
12-01 20:17:56.291: E/AndroidRuntime(1345): FATAL EXCEPTION: main
12-01 20:17:56.291: E/AndroidRuntime(1345): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.sudoku/com.example.sudoku.Main}: java.lang.ClassCastException: com.example.sudoku.Main cannot be cast to com.example.sudoku.Sudoku
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.os.Looper.loop(Looper.java:137)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at java.lang.reflect.Method.invokeNative(Native Method)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at java.lang.reflect.Method.invoke(Method.java:511)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at dalvik.system.NativeStart.main(Native Method)
12-01 20:17:56.291: E/AndroidRuntime(1345): Caused by: java.lang.ClassCastException: com.example.sudoku.Main cannot be cast to com.example.sudoku.Sudoku
12-01 20:17:56.291: E/AndroidRuntime(1345):     at com.example.sudoku.PuzzleView.<init>(PuzzleView.java:26)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at com.example.sudoku.Main.onCreate(Main.java:18)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.Activity.performCreate(Activity.java:5008)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-01 20:17:56.291: E/AndroidRuntime(1345):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-01 20:17:56.291: E/AndroidRuntime(1345):     ... 11 more 
```

如果有什么信息不够，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:39:18.387

问题不在于您发布的任何内容，而在于 PuzzleView 第 26 行：

```
at com.example.sudoku.PuzzleView.<init>(PuzzleView.java:26) 
```

您正在尝试将您传入的内容（一个`Main`实例）转换为`(Sudoku)`.

# ruby-on-rails-3 - #<# 的未定义局部变量或方法“div” :0x109226b18>

> ID：13663509
> 
> 赞同：1
> 
> 时间：2012-12-01T20:36:26.880
> 
> 标签：ruby-on-rails-3

当我开始使用 Ruby On Rails 时，我遇到了麻烦。任何帮助都会很棒。附加信息：提取的源代码（第 25 行附近）：

```
</header>
    <div class="container">
        <% flash.each do |key, value| %>
            <%= content_tag(div, value, :class=> "alert alert-#{key}") %>
        <% end %>
        <%= yield %>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:18:20.747

该行应该是`<%= content_tag(:div, value, :class=> "alert alert-#{key}") %>`

请注意，我传入的是一个符号 :div 而不仅仅是 div。该错误仅意味着它试图查找名为 div 的变量或方法，但内容标签接受我相信的符号或字符串。我认为它也适用于“div”。

# iphone - Parse.com：PFQuery 从 PFUser currentUser 查询数据

> ID：13663510
> 
> 赞同：5
> 
> 时间：2012-12-01T20:36:29.423
> 
> 标签：iphone, objective-c, ios, parse-platform

在我的 iOS 应用程序中，我使用 Parse.com 框架。当应用程序首次启动或用户未登录时，`PFLogInViewController`和`PFSignUpViewController`将显示在视图上。当用户创建他/她的帐户时，应用程序会像往常一样自动创建用户，但它也会在用户下创建另一个名为 的变量`isPrivate`，它需要一个布尔值。我的问题是如何使用来获取的`PFQuery`值？`isPrivate``currentUser`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T22:38:01.650

在玩弄了 PFObject、PFUser 和 PFQuery 之后，我找到了我的问题的答案。您必须创建一个 PFQuery 查询 PFUser 类，然后您必须将查询范围缩小到只有`currentUser username`，然后您请求 的值`isPrivate`。

```
PFQuery *query= [PFUser query];

[query whereKey:@"username" equalTo:[[PFUser currentUser]username]];

[query getFirstObjectInBackgroundWithBlock:^(PFObject *object, NSError *error){

    BOOL isPrivate = [[object objectForKey:@"isPrivate"]boolValue];

}]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-02T23:51:55.267

查询可帮助您找到许多符合条件的对象。当您已经知道想要的对象（当前用户）时，这并不真正适用。您可以决定 currentUser 是否是私有的

```
[PFUser.currentUser[@"isPrivate"] boolValue]; 
```

尽管在这种特殊情况下，您实际上不需要保留单独的字段来确定用户是否为匿名用户（由自动用户创建的类型）。尝试：

```
[PFAnonymousUtils isLinkedWithUser:PFUser.currentUser]; 
```

这适用于所有身份验证工具（PFFacebookUtils、PFTwitterUtils 和 PFAnonymousUtils）。isLinkedWithUser 确定这些身份验证系统是否具有特定用户的凭据。

# jquery - 创建 SVG 堆叠块 / div / legos

> ID：13663512
> 
> 赞同：1
> 
> 时间：2012-12-01T20:36:43.173
> 
> 标签：jquery, graphics, graph, svg, block

我已经通过尝试修改 jquery 条形图或 mansonary 或 svg 等搜索并提出了多个“伪解决方案”，但我想我只想问是否有人对我有更好的解决方案。请。

我需要创建一个堆叠计划，以显示建筑物中的租户每层使用的空间大小或百分比。我在下面通过 jpg 包含了一个简单示例的链接。我需要通过租约到期对其进行着色并使其动态化 - 单击块并传递 id 变量。我只是不认为 css 块浮动是最容易应用的，但我可能是错的。

![块图像](../Images/d5bf3b3e9362cc766c35c191d24472ab.png)

例子就是最好的解释。我认为乐高积木问题很接近。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T22:07:57.177

使用纯 HTML 不是更简单吗？沿着这条线：

```
<html>
  <head>
    <title></title>
    <style type="text/css">
      .floorName, .suites, .suite {display:inline-block}
      .floorName  {width:100px}
      .suites     {
        width:500px;
        height:100%;
      }
      .suite      {
        position:relative;
        color:white; 
        background-color:#FF9934;
        text-align:center;
        height:100%;
      }
      /* This draws the border around the suites */
      .suite:before {
        content:"";
        position:absolute;
        display:block;
        width:100%;
        height:100%;
        border:1px solid black;
        top:-1px;
        left:-1px;
      }
      .expire2012 {background-color:#3266CC}
      .expire2013 {background-color:#FE0000}
      .expire2014 {background-color:#99CC67}
      .expire2015 {background-color:#00FF01}
      .expire2016 {background-color:#993400}
    </style>
  </head>
  <body>
    <div class="floor">
      <div class="floorName">Floor 12</div>
      <div class="suites">
        <div style="width:100%" class="suite expire2012">Suite 1200</div>
      </div>
    </div>
    <div class="floor">
      <div class="floorName">Floor 11</div>
      <div class="suites">
        <div style="width:40%" class="suite">Suite 1100</div
        ><div style="width:40%" class="suite">Suite 1110</div
        ><div style="width:20%" class="suite expire">Suite 1120</div>
      </div>
    </div>
    <div class="floor">
      <div class="floorName">Floor 10</div>
      <div class="suites">
        <div style="width:100%" class="suite expire2013">Suite 1000</div>
      </div>
    </div>
    <div class="floor">
      <div class="floorName">Floor 9</div>
      <div class="suites">
        <div style="width:40%" class="suite expire2016">Suite 900</div
       ><div style="width:60%" class="suite expire2014">Suite 910</div>
      </div>
    </div>
  </body>
</html> 
```

# ios - 在 View Controller IOS 中更新 Core Data 中的属性

> ID：13663515
> 
> 赞同：0
> 
> 时间：2012-12-01T20:37:00.997
> 
> 标签：ios, objective-c

我正在制作一个 Iphone 应用程序，我想更改 Core Data 中的一个值。通常我只`didselect`在表格视图中完成索引路径方法的行。现在我来自一个表格视图并进入其中一个单元格，并希望在 viewController 中更改该单元格中的一个属性。

这样做：`NSManagedObject *d = [self.model.frc_Work objectAtIndex:1];`会给我一个错误。

```
//The way I have done it before

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath

{
          NSManagedObject *d = [self.model.frc_Work objectAtIndexPath:indexPath];
          [d setValue:[NSNumber numberWithInt:1] forKey:@"status"];
}

//How do I do it this way 
- (IBAction)btnDone:(id)sender {

    NSManagedObject *d = [self.model.frc_Work objectAtIndex:1];

    [d setValue:self.tvTheNote.text forKey:@"notes"];

    [self.model saveChanges];

    self.tvTheNote.text = @"";

    [self dismissModalViewControllerAnimated:YES];
} 
```

我的 Frc 代码是：

```
 - (NSFetchedResultsController *)frc_Work

{

// If the frc is already configured, simply return it

if (_frc_Work) return _frc_Work;

// Otherwise, create a new frc, and set it as the property (and return it below)

_frc_Work = [_cdStack frcWithEntityNamed:@"Work" withPredicateFormat:nil predicateObject:nil sortDescriptors:@"title,YES" andSectionNameKeyPath:nil];

return _frc_Work;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:09:46.677

使用...创建索引路径

```
NSIndexPath rowIndexPath = [NSIndexPath indexPathWithIndex:1]; 
```

然后调用：

```
NSManagedObject *d = [self.model.frc_Work objectAtIndexPath:rowIndexPath]; 
```

# javascript - Javascript对象文字和“this”上下文？

> ID：13663517
> 
> 赞同：0
> 
> 时间：2012-12-01T20:37:24.683
> 
> 标签：javascript, scope, this

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:42:25.057

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:44:39.413

您可以将上下文作为闭包的一部分传递给处理函数：

```
$('myButton').on("click", (function(context) {
    return function() {
        context.Work
    };
})(this)); 
```

不用说，这是跨浏览器，因为它依赖于 JS 的核心特性之一。

# c# - 访问 ASP.Net 缓存项时，跟随会导致 RACE CONDITION 吗？

> ID：13663518
> 
> 赞同：1
> 
> 时间：2012-12-01T20:37:27.460
> 
> 标签：c#, asp.net, caching

我正在使用下面的代码，对我来说，下面的代码似乎永远不会发生竞争条件。还是有可能出现比赛条件？

```
 List<Document> listFromCache = Cache[dataCacheName] as List<Document>;
        if (listFromCache != null)
        {
           //do something with listFromCache. **IS IT POSSIBLE** that listFromCache is 
                                              //NULL here
        }
        else
        {
             List<Document> list = ABC.DataLayer.GetDocuments();
             Cache.Insert(dataCacheName, list, null, DateTime.Now.AddMinutes(5), 
                          System.Web.Caching.Cache.NoSlidingExpiration);
        } 
```

**更新：** 克里斯帮我解决了这个问题，但我只是想，我会分享一些对其他人非常有帮助的细节。

为了完全避免任何竞争条件，我必须在真实部分中添加一个检查，否则我可能会得到一个计数为零的列表，如果其他人在缓存中清除它（不删除该项目，而只需调用 Clear 方法在我的 if 评估为 TRUE 之后，列出缓存中的对象）。那么，在 listFromCache 对象的 if 的真实部分中，我不会有任何数据。

**为了克服**原始代码中这种微妙的 RACE 条件，我必须仔细检查 listFromCache 的真实部分，如下面的代码所示，然后用最新数据重新填充 Cache。

此外，正如 Chris 所说，如果其他人通过调用 Cache.Remove 方法从 Cache 中“删除”项目，**则 listFromCache 不会受到影响**，因为垃圾收集器不会从 HEAP 内存中删除实际的 List 对象，因为名为 ' listFromCache' 仍然有它的引用（我在克里斯的回答帖子下的评论中更详细地解释了这一点）。

```
List<Document> listFromCache = Cache[dataCacheName] as List<Document>;
    if (listFromCache != null)
    {
      //OVERCOME A SUBTLE RACE CONDITION BY IF BELOW
      if( listFromCache == null || listFromCache.Count == 0)
      {
          List<Document> list = ABC.DataLayer.GetDocuments();
          Cache.Insert(dataCacheName, list, null, DateTime.Now.AddMinutes(5), 
                      System.Web.Caching.Cache.NoSlidingExpiration);
       }
       //NOW I AM SURE MY listFromCache contains true data
       //do something with listFromCache. **IS IT POSSIBLE** that listFromCache is 
                                          //NULL here
    }
    else
    {
         List<Document> list = ABC.DataLayer.GetDocuments();
         Cache.Insert(dataCacheName, list, null, DateTime.Now.AddMinutes(5), 
                      System.Web.Caching.Cache.NoSlidingExpiration);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:55:17.603

不，您的评论不可能`listFromCache`变为 null，因为此时它是本地引用。如果缓存条目在其他地方无效，它不会影响您的本地引用。但是，您可能会遇到检索到空值的情况，但是在收集文档 ( `ABC.DataLayer.GetDocuments()`) 的过程中，另一个进程已经这样做并插入了缓存条目，此时您将其覆盖。（这对您来说可能完全可以接受，在这种情况下，太好了！）

您可以尝试使用静态对象锁定它，但老实说，我不确定这是否适用于 ASP.NET 上下文。我不记得缓存是在所有 ASP.NET 进程（IIRC，具有不同的静态上下文）之间共享还是仅在每个 Web 工作者之间共享。如果是后者，静态锁就可以正常工作。

也只是为了证明：

```
List<Document> listFromCache = Cache[dataCacheName] as List<Document>;
if (listFromCache != null)
{
    Cache.Remove(dataCacheName);
    //listFromCache will NOT be null here.
    if (listFromCache != null)
    {
        Console.WriteLine("Not null!"); //this will run because it's not null
    }
} 
```

# antlr4 - ANTLR 4 中 $type 属性的替代品是什么？

> ID：13663525
> 
> 赞同：3
> 
> 时间：2012-12-01T20:38:00.607
> 
> 标签：antlr4

这是示例。ANTLR4 无法识别此 ($type)。

```
Number //options { backtrack=true; }
  :  IntegerLiteral { $type = IntegerLiteral; }
  |  FloatLiteral { $type = FloatLiteral; }
  | IntegerLiteral { $type = IntegerLiteral; }
  ; 
```

这可以用什么代替？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-04T13:35:07.233

在 ANTLR 4 中，这是新的语法：

```
Foo
  : Bar -> type(SomeType)
  | ...
  ; 
```

但是，对于您上面的规则，您应该删除`Number`规则并确保`FloatLiteral`and`IntegerLiteral`规则不是片段规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:44:02.980

在 ANTLR v4 中，执行以下操作：

```
Number
 : IntegerLiteral {setType(IntegerLiteral);}
 | ... 
```

# php - php /c# 哈希密码

> ID：13663529
> 
> 赞同：0
> 
> 时间：2012-12-01T20:38:29.647
> 
> 标签：php, objective-c

我在应用商店中有一个应用，我用它来散列通行证：

```
 //salt the password
NSString* saltedPassword = [NSString stringWithFormat:@"%@%@", fldPassword.text, kSalt];

//prepare the hashed storage
NSString* hashedPassword = nil;
unsigned char hashedPasswordData[CC_SHA1_DIGEST_LENGTH];
//hash the pass
NSData *data = [saltedPassword dataUsingEncoding: NSUTF8StringEncoding];
if (CC_SHA1([data bytes], [data length], hashedPasswordData)) {
    hashedPassword = [[NSString alloc] initWithBytes:hashedPasswordData length:sizeof(hashedPasswordData) encoding:NSASCIIStringEncoding]; 
```

我在数据库中的密码是 Vîÿ¿ Ø2(&Zw6

我的问题是我找不到做同样事情的 php 函数，所以用户可以在那里重置 pass 。

我可以在 Xcode 中这样做：

```
 NSString *hashkey = <your data here>;
 // PHP uses ASCII encoding, not UTF
 const char *s = [hashkey cStringUsingEncoding:NSASCIIStringEncoding];
 NSData *keyData = [NSData dataWithBytes:s length:strlen(s)];

 // This is the destination
uint8_t digest[CC_SHA1_DIGEST_LENGTH] = {0};
// This one function does an unkeyed SHA1 hash of your hash data
CC_SHA1(keyData.bytes, keyData.length, digest);

// Now convert to NSData structure to make it usable again
NSData *out = [NSData dataWithBytes:digest length:CC_SHA1_DIGEST_LENGTH];
// description converts to hex but puts <> around it and spaces every 4 bytes
NSString *hash = [out description];
hash = [hash stringByReplacingOccurrencesOfString:@" " withString:@""];
hash = [hash stringByReplacingOccurrencesOfString:@"<" withString:@""];
hash = [hash stringByReplacingOccurrencesOfString:@">" withString:@""];
// hash is now a string with just the 40char hash value in it 
```

这给了我一个代码thats = to sha1() php中的函数，但如果我这样做，我必须重置所有当前用户传递并将其邮寄给他们：-/

# markdown - 如何在 Octopress 中使用 Markdown 在网格中排列图像

> ID：13663530
> 
> 赞同：2
> 
> 时间：2012-12-01T20:38:52.700
> 
> 标签：markdown, jekyll, octopress

我正在尝试用一些图像缩略图写一篇博客文章。我正在通过以下方式使用代码

```
...[之前的降价内容]...

[{% img left https://lh5.googleusercontent.com/-UjFXd_iX4wg/UK_LGHwB1GI/AAAAAAAACGM/Y9dOC2JLMu0/s400/2012-11-01%252010.51.22.jpg '电热水壶的电源按钮'%}](https ://picasaweb.google.com/lh/photo/v54UgP-UYdQKngGBXIkVdtMTjNZETYmyPJy0liipFm0?feat=directlink)

[{% img left https://lh5.googleusercontent.com/-pZWML6wLvMk/UK_NhINxrh​​I/AAAAAAAACHc/8dvYICW8AA8/s400/2012-11-01%252011.01.24.jpg '外置硬盘的电源按钮'%}]( https://picasaweb.google.com/lh/photo/F8GpZ42t2k7OnFWfgzGDW9MTjNZETYmyPJy0liipFm0?feat=directlink)

[{% img left https://lh6.googleusercontent.com/-1L7v_5CYtq8/UK_NndJB_HI/AAAAAAAACHk/se84006Yoyo/s400/2012-11-01%252011.37.17.jpg '宜家床头灯的电源按钮'%}]（ https://picasaweb.google.com/lh/photo/2O6MNRL11LHZaOWy5ucSFdMTjNZETYmyPJy0liipFm0?feat=directlink)

...[降价后的内容]...

```

这很好用，但是如果我在它下面放一些文本，它会从最后一张图像的右侧开始，而不是在新行上。

我怎样才能有一个图像网格并让文本在网格之后继续？我正在使用降价来写帖子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T23:16:29.003

它可能适合您，也可能不适合您，但我为类似的用例编写了一个 Jekyll 插件 - [https://github.com/matthewowen/jekyll-slideshow](https://github.com/matthewowen/jekyll-slideshow)

这适用于拥有全尺寸图像，您希望在其中生成缩略图网格，以允许全尺寸图像出现在灯箱中。

如果这不是你的确切情况，我的建议是使用 CSS 来做到这一点。语法的“左”部分仅表示要添加的 CSS 类。在这种情况下，我猜 Octopress 的 CSS 附带了一个规则来让这个类向左浮动——这使得它们彼此并排出现，但让文本环绕它。您可以改为使用“网格”之类的东西，然后添加一个 CSS 规则来为该类的图像提供内联块显示属性。

# android - Android 中的外部数据

> ID：13663531
> 
> 赞同：0
> 
> 时间：2012-12-01T20:39:04.230
> 
> 标签：android

我在我的 Android 应用程序中硬编码了数据。这将是树格式。像这样

```
<makes>
<make>
<name>abc</name>
<id>1</id>
</make>
... 10 more entries.
</makes> 
```

由于这些数据将被硬编码，因此在我的应用程序中，我可以使用什么来轻松地在我的应用程序中解析。我可以简单地从我的资产目录中加载它，并使用 xml 解析，但是有没有内置的方法来使用它。我知道我可以从 xml 资源中创建一个字符串数组，但是我该如何使用这个结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:05:00.733

您可以轻松地将该表存储为`SQLite`数据库。此[链接](http://coenraets.org/blog/androidtutorial/)可能会有所帮助，尤其是第 6 步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:47:55.430

您可以使用实现 XmlPullParser 接口的 XmlResourceParser 类，并允许您[解析 XML 文件](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)，从资源文件夹加载它。之后，我建议使用 XML 中定义的两个属性定义一个 Make 类，并在循环遍历 xml 文件时使用该类的对象填充 List 或其他类型的数据结构。

# ant - ANT 脚本将消息构建到 log4j 配置的日志文件中

> ID：13663535
> 
> 赞同：0
> 
> 时间：2012-12-01T20:39:31.760
> 
> 标签：ant, log4j

我正在开发一个使用 Eclipse 作为 IDE 和 ant 作为构建工具的 java 项目。对于日志记录，我正在使用 log4j 库。我可以使用 log4j 配置在我的整个应用程序的日志文件中获取日志消息。但是当我使用 ANT 构建项目时，ANT 构建消息仍会发布到控制台。我想确保当我构建项目时，ANT 生成的构建消息，如构建失败/成功，也应该发布到相同的地方使用 log4j 的记录器文件。

如果有人有想法，请帮助我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T01:07:49.493

要传递日志记录 log4j，您可以在运行 Ant 时使用它：

```
$ ant -listener org.apache.tools.ant.listener.Log4jListener 
```

log4j 的配置由你决定。请参阅Ant 手册中有关[Listeners的信息。](http://ant.apache.org/manual/listeners.html)

# r - R, 使用 reshape 拉取 pre post 数据

> ID：13663541
> 
> 赞同：1
> 
> 时间：2012-12-01T20:39:55.333
> 
> 标签：r, plyr, reshape

我有一个简单的数据框如下

```
x = data.frame(id = seq(1,10),val = seq(1,10))
x
id val
1   1
2   2  
3   3
4   4
5   5
6   6
7   7
8   8
9   9
10  10 
```

我想再添加 4 列。前 2 行是前两行，后两行是后两行。对于前两行和最后两行，它需要写为 NA。如何在 reshape 包中使用 cast 来完成此操作？

最终输出看起来像

```
1 1 NA NA 2 3
2 2 NA 1 3 4
3 3 1 2 4 5
4 4 2 3 5 6 
```

... 等等...

非常感谢提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:54:37.697

在你给出例子之后，我改变了解决方案

```
 mat <- cbind(dat,
 c(c(NA,NA),head(dat$id,-2)),
 c(c(NA),head(dat$val,-1)),
 c(tail(dat$id,-1),c(NA)),
 c(tail(dat$val,-2),c(NA,NA)))

colnames(mat) <- c('id','val','idp','valp','idn','valn')

   id val idp valp idn valn
1   1   1  NA   NA   2    3
2   2   2  NA    1   3    4
3   3   3   1    2   4    5
4   4   4   2    3   5    6
5   5   5   3    4   6    7
6   6   6   4    5   7    8
7   7   7   5    6   8    9
8   8   8   6    7   9   10
9   9   9   7    8  10   NA
10 10  10   8    9  NA   NA 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:46:27.250

这是一个解决方案`sapply`。首先，选择新列的相对变化：

```
lags <- c(-2, -1, 1, 2) 
```

创建新列：

```
newcols <- sapply(lags,
                  function(l) {
                    tmp <- seq.int(nrow(x)) + l; 
                    x[replace(tmp, tmp < 1 | tmp > nrow(x), NA), "val"]}) 
```

绑定在一起：

```
cbind(x, newcols) 
```

结果：

```
 id val  1  2  3  4
1   1   1 NA NA  2  3
2   2   2 NA  1  3  4
3   3   3  1  2  4  5
4   4   4  2  3  5  6
5   5   5  3  4  6  7
6   6   6  4  5  7  8
7   7   7  5  6  8  9
8   8   8  6  7  9 10
9   9   9  7  8 10 NA
10 10  10  8  9 NA NA 
```

# c++ - 一个 double 是否将方程中的每个 int 都提升为 double？

> ID：13663545
> 
> 赞同：29
> 
> 时间：2012-12-01T20:40:10.027
> 
> 标签：c++, floating-point, type-conversion, integer-promotion

是否存在一种浮点数据类型（例如`double`）确保所有 +、-、*、/、% 等数学运算都采用双操作数？

如果故事比这更复杂，是否有描述这些规则的资源？我应该不问这样的问题，并且总是明确地`int`转换到`double`等式的结果是什么时候`double`。这是我正在考虑的一些方程式。我故意没有在我的系统上编译和运行，因为这是可能依赖于编译器的类型。

```
int a(1), b(2), c(3);
double d(4.);
double result1 = a + b/d + c; // equal to 4 or to 4.5?
double result2 = (a + b)/d + c; // equal to 3 or to 3.75?    
double result3 = a/b + d; // equal to 4 or to 4.5? 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-01T21:04:44.430

> 我故意没有在我的系统上编译和运行，因为这是可能依赖于编译器的类型。

这**不**依赖于编译器。C++ 清楚地定义了[这些操作的顺序](http://en.cppreference.com/w/cpp/language/operator_precedence)以及它们是如何转换的。

转换如何发生取决于操作的顺序。

```
double result1 = a + b / d + c; // equal to 4 or to 4.5? 
```

在此示例中，首先发生除法。因为这是一个 int 除以 double，编译器通过将 int 转换为 double 来处理这个问题。因此，结果`b / d`是双精度数。

C++ 做的下一件事是`a`将`b / d`. 这是一个加到 double 的 int，因此它将 int 转换为 double 并相加，得到一个 double。同样的事情发生在`c`.

```
double result3 = a / b + d; // equal to 4 or to 4.5? 
```

在本例中，首先处理除法。`a`并且`b`都是整数，因此不进行任何转换。的结果`a / b`是 int 类型，为 0。

然后，将其结果添加到`d`. 这是一个 int 加一个 double，因此 C++ 将 int 转换为一个 double，结果是一个 double。

即使此表达式中存在双精度数，`a / b`也会首先计算，并且双精度数在执行到达双精度数之前没有任何意义。因此，会发生整数除法。

我发现促销和转换规则非常复杂。通常，类似整数的数字（short、int、long）被提升为等效的浮点数（float、double）。但是由于大小差异和符号，事情变得复杂了。

有关转换的详细信息，请参阅[此问题](https://stackoverflow.com/questions/5563000/implicit-type-conversion-rules-in-c-operators)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-01T20:42:07.483

> 是否将方程式中的`double`每一项提升为？`int``double`

不，只有单个操作的结果（相对于优先级）。

```
double result1 = a + b/d + c; // equal to 4 or to 4.5? 
```

4.5.

```
double result2 = (a + b)/d + c; // equal to 3 or to 3.75? 
```

3.75。

```
double result3 = a/b + d; // equal to 4 or to 4.5? 
```

4.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-01T21:16:47.350

您必须考虑每个运算符的优先级，您必须像解析器一样思考：

```
double result1 = a + b/d + c; // equal to 4 or to 4.5? 
```

这就像一个 + (b/d) +c 因为'/'运算符具有最大的优先级。那么这两个操作中的哪个首先进行并不重要，因为浮点操作数在中间，它“感染”其他操作数并使它们成为双倍。所以它是 4.5。

```
double result2 = (a + b)/d + c; // equal to 3 or to 3.75? 
```

这里也一样，就像 ((a+b)/d )+c，所以 a+b 是 3，那 3 变成了一个浮点数，因为被提升为 double，因为是 d 的被除数，它是一个 double，所以它是 0.75+3，即 3.75。

```
double result3 = a/b + d; // equal to 4 or to 4.5? 
```

就像 (a/b)+d，所以 a/b 是 0，d 是 4，所以是 4。解析器按优先级顺序进行所有操作，因此您可以准确地知道表达式的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-01T20:53:07.073

一般情况下，如果二元运算符的一个操作数是浮点数，另一个是整数，则将整数转换为浮点数，结果为浮点数。

在具有多个子表达式的复合表达式中，每个运算符都使用您可能知道的优先规则单独处理。因此， in `a*b + c*d`,`a*b`被评估，并且`c*d`被评估，并且结果被加在一起。里面的任何东西`c*d`都没有效果，`a*b`反之亦然。

当然，C++ 很复杂，用户定义的运算符可能还有其他行为。

定义规则的权威资源是 C++ 标准。该标准相当大而且技术性很强。您可能更愿意先检查 C 标准。有关标准的链接，请参阅[此答案](https://stackoverflow.com/a/83763/298225)。任何关于 C 或 C++ 的好书都应该描述默认的类型转换和表达式求值。

# android - 应用程序在后台占用 CPU 而什么都不做

> ID：13663553
> 
> 赞同：3
> 
> 时间：2012-12-01T20:41:06.813
> 
> 标签：android

当 android 应用程序 (JNI+Java) 进入后台时，基于 Elixir 监视器它会占用 40-80% 的 CPU 而没有任何明显的原因。Logcat 没有任何实际活动的迹象，DDMS 方法分析器没有找到任何方法调用。

事实上，几分钟后 OS (ISC) 至少有时似乎会自动修复它：重新启动应用程序进程，然后正如预期的那样 - 占用 0% 的 CPU 和一些内存。当我再次启动应用程序并按 home 将其带到后台时，会发生同样的 CPU 占用。

有什么想法可以调查吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T10:39:34.430

所以我的结论是：1.如果Profiler中没有显示方法调用，那么很可能意味着在NDK端浪费了CPU，2.应该在那里使用基于GDB的分析，可能是这样[的](https://stackoverflow.com/questions/6490479/android-ndk-load-cpu)

# php - Slim 在本地开发机器上工作，但不在远程服务器上工作

> ID：13663555
> 
> 赞同：0
> 
> 时间：2012-12-01T20:41:21.413
> 
> 标签：php, slim

我正在玩 Slim，它在我运行 MAMP 的本地机器上运行良好。根 URL 显示“home”，/features 显示“features”。然而，在我的 Linode 机器上，只有 root 可以工作（“home”）。当我转到 /features 时，我得到一个 404。

```
<?php

//Slim Framework
require 'Slim/Slim.php';

\Slim\Slim::registerAutoloader();

//Instantiate, register URIs
$app = new \Slim\Slim(array(
    'debug' => true
));

$app->get('/', 'getHome');
$app->get('/features', 'getFeatures');

$app->run();

function getHome() {
    echo "home";
};

function getFeatures() {
    echo "features";
};

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T20:53:03.890

原来我没有在我的 .htaccess 文件中打开 mod rewrite。上传以下 .htaccess 解决了我的问题：

```
RewriteEngine On

# Some hosts may require you to use the `RewriteBase` directive.
# If you need to use the `RewriteBase` directive, it should be the
# absolute physical path to the directory that contains this htaccess file.
#
# RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [QSA,L] 
```

# c# - 基准不一致的结果

> ID：13663562
> 
> 赞同：0
> 
> 时间：2012-12-01T20:42:18.030
> 
> 标签：c#, .net, benchmarking

我正在尝试分析一个函数。该函数旨在将结构转换为数组。我有两种不同的方法，使用编组或 BitConverter。当然，marshaling 方法创建了一个函数，可以在特定条件下与几乎所有结构一起使用。BitConverter 需要每个结构的自定义函数。我最初的想法是 BitConverter 会更快，但我的测试结果并不一致。

这是基准的剪切和粘贴。

我已经以多种不同的形式尝试了以下基准。当我首先对 BitConverter 函数进行基准测试时，它往往会更快。当我首先对 Marshaling 函数进行基准测试时，它往往会更快。我错过了什么？

**摘要以显示流程。这不是基准测试流程的实际代码。**

```
main()
{
    Stopwatch watch = new Stopwatch;
    // To take care of JIT
    bitConverterFunction();
    marshalingFunction();

    //Thread.Sleep(0);   // I've tried this thinking it had to do with context switching issues but the results were basically the same.
    watch.Start();
    for(i=0; i<iterations; i++)
    {
         bitConverterFunction();
    }
    watch.Stop();

    Timespan bitConverterTime = watch.Elapsed;
    //Thread.Sleep(0);   // I've tried this thinking it had to do with context switching issues
    watch.Restart();
    for(i=0; i<iterations; i++)
    {
         marshalingFunction();
    }
    watch.Stop();
    Timespan marshalingTime = watch.Elapsed;

    // it seems that whichever function is run first, tends to be the quickest.

} 
```

**如果你想测试真实代码**

```
using System;
using BenchmarkTool;

namespace BenchmarkConsole
{
    class Program
    {
        static void Main(string[] args)
        {
            Benchmarks.StructToArrayConversion(100);
            Benchmarks.StructToArrayConversion(1000);
            Benchmarks.StructToArrayConversion(10000);
            Benchmarks.StructToArrayConversion(100000);

            Console.WriteLine("Press any key to continue.");
            Console.ReadKey();
        }
    }
}

using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using NUnit.Framework;

namespace BenchmarkTool
{
    [TestFixture]
    public static class Benchmarks
    {
        [TestCase(100)]
        [TestCase(1000)]
        [TestCase(10000)]
        [TestCase(100000)]
        [TestCase(1000000)]
        public static void StructToArrayConversion(int iteration = 100)
        {
            Stopwatch watch = new Stopwatch();
            EntityStatePDU6 state = new EntityStatePDU6()
                {
                    Version = 0,
                    ExerciseID = 0x01,
                    PDUType = 0x02,
                    Family = 0x03,
                    Timestamp = 0x07060504,
                    Length = 0x0908,
                    Site = 0x0D0C,
                    Application = 0X0F0E,
                    Entity = 0X1110,
                    NumArticulationParams = 0X13,
                    VelocityX = BitConverter.ToSingle(new byte[] {0x14, 0x15, 0x16, 0x17}, 0),
                    VelocityY = BitConverter.ToSingle(new byte[] {0x18, 0x19, 0x1A, 0x1B}, 0),
                    VelocityZ = BitConverter.ToSingle(new byte[] {0x1C, 0x1D, 0x1E, 0x1F}, 0),
                    LocationX = BitConverter.ToSingle(new byte[] {0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27}, 0),
                    LocationY = BitConverter.ToSingle(new byte[] {0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F}, 0),
                    LocationZ = BitConverter.ToSingle(new byte[] {0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37}, 0),
                    Roll = BitConverter.ToSingle(new byte[] {0x38, 0x39, 0x3A, 0x3B}, 0),
                    Pitch = BitConverter.ToSingle(new byte[] {0x3C, 0x3D, 0x3E, 0x3F}, 0),
                    Heading = BitConverter.ToSingle(new byte[] {0x40, 0x41, 0x42, 0x43}, 0),
                    Appearance = 0X47464544
                };

            // To take care of JIT
            ToArrayBitConverter(state);
            state.ToByteArray();

            Console.WriteLine("*** Benchmark Start ***");
            Console.WriteLine("BitConverter Benchmark");
            byte[] bitconverterArray = ToArrayBitConverter(state);
            //Thread.Sleep(0);
            watch.Start();
            for(int i = 0; i < iteration; i++)
            {
                bitconverterArray = ToArrayBitConverter(state);
            }
            watch.Stop();
            TimeSpan bitConverterTime = watch.Elapsed;

            Console.WriteLine("{0} Iterations: {1}", iteration, watch.Elapsed.TotalSeconds.ToString("0.0000000"));
            Console.WriteLine();

            Console.WriteLine("Marshal StructToPtr Benchmark");
            byte[] marshalArray = null;
            //Thread.Sleep(0);
            watch.Restart();
            for (int i = 0; i < iteration; i++)
            {
                marshalArray = state.ToByteArray();
            }
            watch.Stop();
            TimeSpan marshalTime = watch.Elapsed;

            Console.WriteLine("{0} Iterations: {1}", iteration, watch.Elapsed.TotalSeconds.ToString("0.0000000"));

            Console.WriteLine();
            Console.WriteLine("Results");
            Console.WriteLine("{0} Faster", marshalTime < bitConverterTime ? "Marshaling" : "BitConverter");
            Console.WriteLine("Speed Ratio: {0}", marshalTime < bitConverterTime ? bitConverterTime.TotalSeconds / marshalTime.TotalSeconds : marshalTime.TotalSeconds / bitConverterTime.TotalSeconds);

            Console.WriteLine("**********************************");
            Console.WriteLine();
            Assert.AreEqual(bitconverterArray.Length, marshalArray.Length);
            for(int i = 0; i < bitconverterArray.Length; i++)
            {
                Assert.AreEqual(marshalArray[i],bitconverterArray[i], "@index " + i);
            }
        }

        public static byte[] ToArrayBitConverter(EntityStatePDU6 entity)
        {
            int size = Marshal.SizeOf(typeof (EntityStatePDU6));
            byte[] array = new byte[size];
            array[0] = entity.Version;
            array[1] = entity.ExerciseID;
            array[2] = entity.PDUType;
            array[3] = entity.Family;
            array[4] = (byte)((0xFF & entity.Timestamp));
            array[5] = (byte)((0xFF00 & entity.Timestamp) >> 8);
            array[6] = (byte)((0xFF0000 & entity.Timestamp) >> 16);
            array[7] = (byte)((0xFF000000 & entity.Timestamp) >> 24);
            array[8] = (byte)((0xFF & entity.Length));
            array[9] = (byte)((0xFF00 & entity.Length) >> 8);
            // Padding1: array[10], array[11]
            array[12] = (byte)((0xFF & entity.Site));
            array[13] = (byte)((0xFF00 & entity.Site) >> 8);
            array[14] = (byte)((0xFF & entity.Application));
            array[15] = (byte)((0xFF00 & entity.Application) >> 8);
            array[16] = (byte)((0xFF & entity.Entity));
            array[17] = (byte)((0xFF00 & entity.Entity) >> 8);
            //padding2 array[18]
            array[19] = entity.NumArticulationParams;

            byte[] bytes = BitConverter.GetBytes(entity.VelocityX);
            array[20] = bytes[0];
            array[21] = bytes[1];
            array[22] = bytes[2];
            array[23] = bytes[3];
            bytes = BitConverter.GetBytes(entity.VelocityY);
            array[24] = bytes[0];
            array[25] = bytes[1];
            array[26] = bytes[2];
            array[27] = bytes[3];
            bytes = BitConverter.GetBytes(entity.VelocityZ);
            array[28] = bytes[0];
            array[29] = bytes[1];
            array[30] = bytes[2];
            array[31] = bytes[3];

            bytes = BitConverter.GetBytes(entity.LocationX);
            array[32] = bytes[0];
            array[33] = bytes[1];
            array[34] = bytes[2];
            array[35] = bytes[3];
            array[36] = bytes[4];
            array[37] = bytes[5];
            array[38] = bytes[6];
            array[39] = bytes[7];

            bytes = BitConverter.GetBytes(entity.LocationY);
            array[40] = bytes[0];
            array[41] = bytes[1];
            array[42] = bytes[2];
            array[43] = bytes[3];
            array[44] = bytes[4];
            array[45] = bytes[5];
            array[46] = bytes[6];
            array[47] = bytes[7];

            bytes = BitConverter.GetBytes(entity.LocationZ);
            array[48] = bytes[0];
            array[49] = bytes[1];
            array[50] = bytes[2];
            array[51] = bytes[3];
            array[52] = bytes[4];
            array[53] = bytes[5];
            array[54] = bytes[6];
            array[55] = bytes[7];

            bytes = BitConverter.GetBytes(entity.Roll);
            array[56] = bytes[0];
            array[57] = bytes[1];
            array[58] = bytes[2];
            array[59] = bytes[3];
            bytes = BitConverter.GetBytes(entity.Pitch);
            array[60] = bytes[0];
            array[61] = bytes[1];
            array[62] = bytes[2];
            array[63] = bytes[3];
            bytes = BitConverter.GetBytes(entity.Heading);
            array[64] = bytes[0];
            array[65] = bytes[1];
            array[66] = bytes[2];
            array[67] = bytes[3];

            array[68] = (byte)((0xFF & entity.Appearance));
            array[69] = (byte)((0xFF00 & entity.Appearance) >> 8);
            array[70] = (byte)((0xFF0000 & entity.Appearance) >> 16);
            array[71] = (byte)((0xFF000000 & entity.Appearance) >> 24);

            return array;
        }

        public static Byte[] ToByteArray<T>(this T obj) where T : struct
        {
            int size = Marshal.SizeOf(obj);
            var arr = new byte[size];
            IntPtr ptr = Marshal.AllocHGlobal(size);

            Marshal.StructureToPtr(obj, ptr, false);
            Marshal.Copy(ptr, arr, 0, size);
            Marshal.FreeHGlobal(ptr);

            return arr;
        }
    }

    public struct EntityStatePDU6
    {
        // PDU Header 12 Bytes
        public byte Version;
        public byte ExerciseID;
        public byte PDUType;
        public byte Family;
        public uint Timestamp;
        public ushort Length;
        public ushort Padding1;

        // Entity ID 6 bytes
        public ushort Site;
        public ushort Application;
        public ushort Entity;

        public byte Padding2;

        public byte NumArticulationParams;

        public float VelocityX;
        public float VelocityY;
        public float VelocityZ;

        public double LocationX;
        public double LocationY;
        public double LocationZ;

        public float Roll;
        public float Pitch;
        public float Heading;

        public uint Appearance;

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:35:16.247

任何低于 100000 的情况都太小而无法获得一致的结果。

即使在相同代码的运行之间，结果也非常不一致（> 2x 时序差异）。这让我觉得产生了大量的垃圾，结果主要取决于垃圾收集何时开始以及垃圾收集器的性能。

我`GC.Collect`在停止秒表后添加了一些调用，这使得结果更加一致（运行之间的差异为 +/- 10%）。100000 和 1000000 次迭代的编组速度通常快 1.5 - 2 倍。这是在为 Release|x86 编译的 Mono 2.10.8.1 上，所以你的里程可能会有所不同。

# jquery-mobile - aspx 服务器端 jquery 或 javascript window.location.hash='#pg2'; 如果启用了 jquery 库，则不执行

> ID：13663564
> 
> 赞同：1
> 
> 时间：2012-12-01T20:42:22.837
> 
> 标签：jquery-mobile, asp.net-mvc-4

如果脚本 src="http://code.jquery.com/jquery-1.7.1.min.js 在 aspx 页面中启用，则以下代码将不会在 aspx.cs 页面中执行，如果我禁用 jquery 然后代码完美运行。有问题的代码在后面代码的 IsPostback 中：

aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="resolution_finder.aspx.cs" Inherits="client_mobile_tickets_resolution_finder" Debug="true" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />

    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
    <link rel="shortcut icon" type="image/ico" href="favicon.ico">

     <style type="text/css">
        .ui-btn-text {
            font-size: 15px; 
        }
    </style>

    <script type="text/javascript" language="javascript">

        function init_Timer() {
            //-- Log out after 5 minutes
            var timeout = parseInt('<%=timeout %>');
            setTimeout('logOut()', timeout);
        }

        function logOut() {
            document.location = '<%=serverName %>/mobile_support/log_off.aspx?uid=<%=uid %>';
        }

    </script>    

    <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
</head>
<body onload="init_Timer();">
    <form id="frmMain" runat="server">
        <div data-role="page" data-theme="b" id="pg1" name="pg1" >

            <div data-role="header">
                <div class="ui-bar ui-bar-a" style="text-align:center; height:30px; " >
                    <h1 style="white-space: normal">Resolution Finder</h1>
                </div>
            </div><!-- /header -->

            <div data-role="content">
                <label for="ddl">Select an Issue:</label><br />
                    <asp:DropDownList ID="ddlSubject" runat="server" DataSourceID="sdsSubject" 
                        DataTextField="issue" DataValueField="issue" >
                    </asp:DropDownList><br />

                    <asp:SqlDataSource ID="sdsSubject" runat="server" 
                        ConnectionString="<%$ ConnectionStrings:mobile %>" 
                        SelectCommand="get_sl_top_20_issues_p" SelectCommandType="StoredProcedure">
                    </asp:SqlDataSource>

                <asp:Button ID="cmdGo" runat="server" Text="Show Solution(s)" 
                    data-icon="search" theme="a" onclick="cmdGo_Click" />

             </div><!-- /Content -->

             <div data-role="footer" data-position="fixed">
                <div data-role="navbar" style="white-space: normal;" >
                    <ul>
                        <li><a href="<%=serverName %>/mobile_support/home.aspx?uid=<%=uid %>">Home</a></li>
                        <li><a href="active.aspx?uid=<%=uid %>">Active Tickets</a></li>
                        <li><a href="#" onclick="document.location='<%=serverName%>/mobile_support/log_off.aspx?uid=<%=uid %>&logOff=1';">Log Off</a></li>
                    </ul>
                </div>            
            </div><!-- /Footer -->

        </div><!-- /Page -->

   </form>
</body>
</html> 
```

aspx.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;

public partial class client_mobile_tickets_resolution_finder : System.Web.UI.Page
{
    public int uid;
    public static DataTable dt;
    public string serverName;
    public string timeout;
    public int rowCount;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack)
        {
            //--ClientScript.RegisterStartupScript(this.GetType(), "hash", "window.location.hash='#pg2';", true);
            ScriptManager.RegisterStartupScript(this.Page, this.GetType(), "tmp", "<script type='text/javascript'>showResults();</script>", false);
        }
        serverName = HttpContext.Current.Request.Url.Scheme + "://" + HttpContext.Current.Request.Url.Authority; // + HttpContext.Current.Request.ApplicationPath;

        //Get uid
        uid = int.Parse(Request.QueryString["uid"]);

        //Open database connection
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["mobile"].ConnectionString);
        try
        {
            conn.Open();

            ////-- Test to be sure db is open
            if (conn.State == ConnectionState.Open)
            {
                //--Get Home screen data
                SqlDataAdapter ad = new SqlDataAdapter("get_mobile_server_info_p", conn);
                DataSet ds = new DataSet();

                ad.Fill(ds, "dsResult");
                dt = ds.Tables[0];
                timeout = dt.Rows[0][2].ToString();
            }
            else
            {
                Response.Write("Error.....  Could not open dataset....");
                Response.End();
            }
        }
        finally
        {
            conn.Close();
            conn.Dispose();
        }
    }

    protected void cmdGo_Click(object sender, EventArgs e)
    {
        //--Get actions for selected issue

        //Open database connection
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["mobile"].ConnectionString);
        try
        {
            conn.Open();

            ////-- Test to be sure db is open
            if (conn.State == ConnectionState.Open)
            {
                //--Get resolutions
                SqlDataAdapter ad = new SqlDataAdapter("get_sl_actions_for_issue_p '" + ddlSubject.SelectedValue + "'", conn);
                DataSet ds = new DataSet();

                ad.Fill(ds, "dsResult");
                dt = ds.Tables[0];

                rowCount = dt.Rows.Count;

                //-- Populate the results
                DataTable newsDataTable = new DataTable();

                // add some columns to our datatable
                newsDataTable.Columns.Add("href_li");
                newsDataTable.Columns.Add("DisplayText");

                for (int i = 1; i < dt.Rows.Count; i++)
                {
                    DataRow newsDataRow = newsDataTable.NewRow();
                    newsDataRow["href_li"] = i;
                    newsDataRow["DisplayText"] = dt.Rows[i][0].ToString();
                    newsDataTable.Rows.Add(newsDataRow);
                }
                menu_ul_1.DataSource = newsDataTable;
                menu_ul_1.DataBind();

                //--Navigate to the 2nd page
                //--this.ClientScript.RegisterStartupScript(this.GetType(),"navigate", "window.location.hash='#pg2';",true);
                //--Response.RedirectPermanent("resolution_finder.aspx?uid=" + uid + "#pg2");
            }
            else
            {
                Response.Write("Error.....  Could not open dataset....");
                Response.End();
            }
        }
        finally
        {
            conn.Close();
            conn.Dispose();
        }
    }
} 
```

# java - Mahout：CSV 到矢量并运行程序

> ID：13663567
> 
> 赞同：5
> 
> 时间：2012-12-01T20:42:29.137
> 
> 标签：java, apache, hadoop, mahout

我正在用 Mahout 分析 k-means 算法。我将运行一些测试，观察性能，并对我得到的结果进行一些统计。

我不知道如何在 Mahout 中运行我自己的程序。但是，命令行界面可能就足够了。

要运行我做的示例程序

```
$ mahout seqdirectory --input uscensus --output uscensus-seq
$ mahout seq2sparse -i uscensus-seq -o uscensus-vec
$ mahout kmeans -i reuters-vec/tfidf-vectors -o uscensus-kmeans-clusters -c uscensus-kmeans-centroids -dm org.apache.mahout.common.distance.CosineDistanceMeasure -x 5 -ow -cl -k 25 
```

数据集是一个大型 CSV 文件。每一行都是一条记录。特征以逗号分隔。第一个字段是 ID。由于输入格式，我不能立即使用 seqdirectory。我正在尝试实现这个类似问题的答案[How to perform k-means clustering in mahout with vector data stored as CSV?](https://stackoverflow.com/questions/8785392/how-to-perform-k-means-clustering-in-mahout-with-vector-data-stored-as-csv) 但我还有 2 个问题：

1.  如何从 CSV 转换为 SeqFile？我想我可以使用 Mahout 编写自己的程序来进行这种转换，然后将其输出用作 seq2parse 的输入。我想我可以使用 CSVIterator ( [https://cwiki.apache.org/confluence/display/MAHOUT/File+Format+Integrations](https://cwiki.apache.org/confluence/display/MAHOUT/File+Format+Integrations) )。我应该使用什么类来阅读和写作？
2.  如何构建和运行我的新程序？我无法通过 Mahout 这本书或这里的其他问题来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-21T13:20:46.907

要以 SequenceFile 格式获取数据，您可以采取一些策略。两者都涉及编写您自己的代码——即，不是严格的命令行。

**策略 1** 使用 Mahout 的 CSVVectorIterator 类。你传给它一个 java.io.Reader，它会读入你的 CSV 文件，把每一行变成一个 DenseVector。我从未使用过它，但在 API 中看到了它。如果您对 DenseVectors 没问题，看起来就足够直截了当。

**策略 2** 编写自己的解析器。这真的很简单，因为您只需在“，”上分割每一行，并且您有一个可以循环的数组。对于每行中的每个值数组，您可以使用如下方式实例化一个向量：

```
new DenseVector(<your array here>); 
```

并将其添加到列表中（例如）。

然后......一旦你有一个向量列表，你可以使用这样的东西将它们写入 SequenceFiles（我在下面的代码中使用 NamedVectors）：

```
FileSystem fs = null;
SequenceFile.Writer writer;
Configuration conf = new Configuration();

List<NamedVector> vectors = <here's your List of vectors obtained from CSVVectorIterator>;

// Write the data to SequenceFile
try {
    fs = FileSystem.get(conf);

    Path path = new Path(<your path> + <your filename>);
    writer = new SequenceFile.Writer(fs, conf, path, Text.class, VectorWritable.class);

    VectorWritable vec = new VectorWritable();
    for (NamedVector vector : dataVector) {

        vec.set(vector);
        writer.append(new Text(vector.getName()), vec);

    }
    writer.close();

} catch (Exception e) {
    System.out.println("ERROR: "+e);
} 
```

现在，您有了一个 SequenceFile 格式的“点”目录，可用于 K-means 聚类。您可以将命令行 Mahout 命令指向此目录作为输入。

无论如何，这是一般的想法。可能还有其他方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-01T08:15:45.183

要使用 csv 文件运行 kmeans，首先您必须创建一个 SequenceFile 以作为 KmeansDriver 中的参数传递。以下代码读取CSV文件“points.csv”的每一行并将其转换为向量并将其写入SequenceFile“points.seq”

```
try (
            BufferedReader reader = new BufferedReader(new FileReader("testdata2/points.csv"));
            SequenceFile.Writer writer = new SequenceFile.Writer(fs, conf,new Path("testdata2/points.seq"), LongWritable.class, VectorWritable.class)
        ) {
            String line;
            long counter = 0;
            while ((line = reader.readLine()) != null) {
                String[] c = line.split(",");
                if(c.length>1){
                    double[] d = new double[c.length];
                    for (int i = 0; i < c.length; i++)
                            d[i] = Double.parseDouble(c[i]);
                    Vector vec = new RandomAccessSparseVector(c.length);
                    vec.assign(d);

                VectorWritable writable = new VectorWritable();
                writable.set(vec);
                writer.append(new LongWritable(counter++), writable);
            }
        }
        writer.close();
    } 
```

希望能帮助到你！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T22:04:26.837

当我运行上述代码时出现了一些问题，因此对语法进行了一些修改，这里是工作代码。

```
String inputfiledata = Input_file_path;
            String outputfile = output_path_for_sequence_file;
            FileSystem fs = null;
            SequenceFile.Writer writer;
            Configuration conf = new Configuration();
            fs = FileSystem.get(conf);
            Path path = new Path(outputfile);`enter code here`
            writer = new SequenceFile.Writer(fs, conf, path, Text.class, VectorWritable.class);
            VectorWritable vec = new VectorWritable();
            List<NamedVector> vects = new ArrayList<NamedVector>();
            try {
                fr = new FileReader(inputfiledata);
                br = new BufferedReader(fr);
                s = null;
                while((s=br.readLine())!=null){

                    // My columns are split by tabs with each entry in a new line as rows
                    String spl[] = s.split("\\t");
                    String key = spl[0];
                    Integer val = 0;
                    for(int k=1;k<spl.length;k++){
                                colvalues[val] = Double.parseDouble(spl[k]);
                                val++;
                        }
                    }
                    NamedVector nmv = new NamedVector(new DenseVector(colvalues),key);
                    vec.set(nmv);
                    writer.append(new Text(nmv.getName()), vec);
                }
                            writer.close();

            } catch (Exception e) {
                System.out.println("ERROR: "+e);
            }
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-25T04:10:05.633

我建议您实现一个程序，将 CSV 转换为 mahout 接受的稀疏矢量序列文件。
您需要做的是了解 InputDriver 如何将包含以空格分隔的浮点数的文本文件转换为 VectorWritable 的 Mahout 序列文件，特别适用于集群作业的输入，以及通常需要此输入的任何 Mahout 作业。您将根据需要自定义代码。
如果您已经下载了 Mahout 的源代码，那么 InputDriver 位于包 org.apache.mahout.clustering.conversion。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-10T22:02:32.883

org.apache.mahout.clustering.conversion.InputDriver 是一个可以用来创建稀疏向量的类。

示例代码如下

mahout org.apache.mahout.clustering.conversion.InputDriver -i testdata -o output1/data -v org.apache.mahout.math.RandomAccessSparseVector

如果你运行 mahout org.apache.mahout.clustering.conversion.InputDriver 它会列出它期望的参数。

希望这可以帮助。
另外，这是我写的一篇文章，用于解释我如何在 arff 文件上运行 kmeans 集群
[http://mahout-hadoop.blogspot.com/2013/10/using-mahout-to-cluster-iris-data.html](http://mahout-hadoop.blogspot.com/2013/10/using-mahout-to-cluster-iris-data.html)

# sql-server - T-SQL 集群外键

> ID：13663569
> 
> 赞同：4
> 
> 时间：2012-12-01T20:42:35.473
> 
> 标签：sql-server, performance, tsql, foreign-keys

“[创建表”语法](http://msdn.microsoft.com/en-us/library/ms174979%28v=sql.105%29.aspx)显然不允许我指定集群外键约束。换句话说，这是非法的：

```
--keyword CLUSTERED must be removed before this will execute...
CREATE TABLE [Content](
    [ID] [int] NOT NULL CONSTRAINT PK_Content_ID PRIMARY KEY,
    ContentDefID int NOT NULL CONSTRAINT FK_Plugin_ContentDef FOREIGN KEY CLUSTERED REFERENCES ContentDef(ID)
    )
GO 
```

但我不明白为什么它是非法的。集群外键的 ISTM 将促进分页查找的性能。换句话说，“给我父 ID 20 的子项 80 到 140”。

这有什么理由吗？

## 更新

根据 Oded 和 Tvanfosson 的反馈，我发现以下工作：

```
CREATE TABLE [Content](
    [ID] [int] NOT NULL CONSTRAINT PK_Content_ID PRIMARY KEY,
    ContentDefID int NOT NULL UNIQUE CLUSTERED CONSTRAINT FK_ContentDefContent FOREIGN KEY REFERENCES ContentDef(ID)
    )
GO 
```

但上述问题导致的问题多于解决的问题。首先，“唯一”外键迫使我的关系是一对一的，这是我不想要的。其次，这只有效，因为它表示创建两个单独的约束，而不是单个 CLUSTERED FOREIGN KEY。

但这项调查让我更接近我的答案。显然[聚集索引必须是唯一的](https://stackoverflow.com/questions/4332982/do-clustered-indexes-have-to-be-unique)，如此处所述。报价：

> 如果聚集索引不是唯一索引，则 SQL Server 通过添加一个内部生成的值（称为唯一符）使任何重复键唯一

特别是，我认为[这个答案](https://stackoverflow.com/a/4333377/284758)涵盖了它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T22:31:51.890

正如其他人所解释的那样，聚集索引不必是主键，但它必须是唯一的，或者 SQL-Server 向其添加（未显示）`UNIQUIFIER`列。

为避免这种情况，您可以通过将主键列显式添加到聚集索引来使聚集索引唯一，如下所示。然后，该索引将可供外键约束使用（以及用于查询，例如连接两个表）。

请注意，正如@Martin Smith 所解释的，`CONSTRAINT`和的概念`INDEX`是不同的。各种 DBMS 以不同的方式实现这些。SQL-Server 会自动为某些约束创建索引，而不会为外键约束创建索引。建议尽管有一个约束可以使用的索引（在引用的表中删除或更新时）：

```
CREATE TABLE Content(
    ID int NOT NULL,
    ContentDefID int NOT NULL,
    CONSTRAINT PK_Content_ID 
      PRIMARY KEY NONCLUSTERED (ID),
    CONSTRAINT CI_Content
      UNIQUE CLUSTERED (ContentDefID, ID),
    CONSTRAINT FK_Plugin_ContentDef 
      FOREIGN KEY (ContentDefID) REFERENCES ContentDef(ID)
) ; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-02T10:10:52.147

> 这有什么理由吗？

您不妨问为什么不能创建`CLUSTERED`检查约束或`CLUSTERED`默认约束。

外键只定义了一个逻辑约束，并且在 SQL Server 中没有为它自动创建索引（这只发生在`UNIQUE`or`PRIMARY KEY`约束中）。在 SQL Server 中总是这样，如果您希望 FK 列被索引，您需要`CREATE INDEX`自己在相关列上运行 a。

因此 a 的概念`CLUSTERED FOREIGN KEY`没有任何意义。`CLUSTERED INDEX`正如您在问题中指出的那样，您当然可以在构成 FK 的列上创建一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-01T20:44:39.593

一张表只能有*一个*聚集索引。默认情况下，这将是主键列。

[有一些方法可以改变这一点](https://stackoverflow.com/questions/8333013/sql-server-creating-table-with-clustered-index-without-a-primary-key)- 您将需要使用`PRIMARY KEY NONCLUSTERED`和`UNIQUE CLUSTERED FOREIGN KEY`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-02T11:10:43.400

您似乎将聚集索引的概念与键（主键或外键）混为一谈。为什么不先创建表，然后再指定其聚集索引？（从您的第一个示例中复制的代码并尽可能少地更改）

```
CREATE TABLE [Content](
    [ID] [int] NOT NULL CONSTRAINT PK_Content_ID PRIMARY KEY NONCLUSTERED,
    ContentDefID int NOT NULL CONSTRAINT FK_Plugin_ContentDef FOREIGN KEY REFERENCES ContentDef(ID)
    )
GO

CREATE CLUSTERED INDEX IX_Content_Clustered on Content(ContentDefID) 
```

您无需使聚集索引唯一

# c++ - 更高的核心负载英特尔 TBB

> ID：13663570
> 
> 赞同：0
> 
> 时间：2012-12-01T20:42:47.443
> 
> 标签：c++, for-loop, parallel-processing, intel, tbb

我正在使用 Intel TBB parallel_for 来加速 for 循环进行一些计算：

```
tbb::parallel_for(tbb::blocked_range<int>(0,ListSize,1000),Calc); 
```

Calc 是 doCalc 类的对象

```
class DoCalc
{
vector<string>FileList;
public:
    void operator()(const tbb::blocked_range<int>& range) const{
    for(int i=range.begin(); i!=range.end();++i){
    //Do some calculations
    }
    }
    DoCalc(vector<string> ilist):FileList(ilist){}
}; 
```

大约需要。当我使用 for 循环的标准串行形式时，大约需要 60 秒。当我使用 TBB 的 parallel_for 完成工作时，需要 20 秒。使用标准时，我的 i5 CPU 的每个内核的负载约为。15%（根据 Windows 任务管理器）并且非常不均匀，大约为 15%。50% 并且在使用 parallel_for 时非常均匀。

我想知道在使用 parallel_for 时是否可以获得更高的核心负载。除了grain_size还有其他参数吗？如何在不更改 for 循环中的操作的情况下提高 parallel_for 的速度（此处为//在上面的代码示例中进行一些计算）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T16:57:41.287

粒度参数是可选的。如果未指定 grainsizee，则应为算法模板提供分区器。分区器是指导范围分块的对象。auto_partitioner 提供了一种替代方法，可以启发式地选择粒度大小，这样您就不必指定一个。启发式尝试限制开销，同时仍为负载平衡提供充足的机会。

获取更多信息，请访问 tbb 网站。www.threadingbuildingblocks.org

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T14:13:40.743

您的问题的答案还取决于算法中内存访问和计算之间的比率。如果您对大量数据执行很少的操作，那么您的问题是内存受限，这将限制核心负载。另一方面，如果您用很少的数据进行大量计算，那么您改进的机会就更大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T23:48:07.403

正如@Eugene Roader 已经建议的那样，您可能希望使用 auto_partitioner （这是 TBB 版本 2.2 的默认设置）来自动分块范围：

```
tbb::parallel_for(tbb::blocked_range<int>(0,ListSize),Calc,tbb:auto_partitioner()); 
```

我假设您的 i5-CPU 有 4 个内核，因此您获得了 3 倍的加速（60 秒 => 20 秒），这已经“相当不错”了，因为并行化中可能存在某些开销。一个问题可能是 CPU 的内存带宽的最大限制，它被 3 个线程饱和 - 或者您可能有很多分配/解除分配，这些分配/取消分配是/必须在线程之间与标准内存管理器同步。在内部循环中没有太多代码更改的情况下解决这个问题的一个技巧可能是使用线程本地分配器，例如对于 FileList：

```
vector<string,tbb:scalable_allocator<string>> FileList; 
```

请注意，您也应该为循环中使用的所有其他容器尝试 tbb::scalable_allocator，以使您的并行化加速更接近内核数 4。

# java - 将创建的对象添加到列表时出现问题

> ID：13663578
> 
> 赞同：0
> 
> 时间：2012-12-01T20:43:48.233
> 
> 标签：java, swing

我已经完成了一个小程序，但遇到了一个我无法找到解决方案的错误。

我的目标是通过触发单击将创建的对象（从 JPanel 扩展的 BlockObject ）添加到列表（使用 ArrayList ）中，然后能够读取列表以将其打印在屏幕上，但在读取此类列表时我得到 ArrayOutOfBoundsException。

我一直在调试并找到了问题的原因，我不知道为什么，我创建并添加到它的每个对象都检索最新类型（前面解释过）而不是创建它的那个。

沿着列表运行的代码是

```
 public void ListBlock(){

    BlockObject auxb;
    Point auxp;

    for(int i = 0; i < list.size(); i++){
        auxb = list.get( i );

        if( auxb.getType() != 0 ){

            auxp = list.get( i ).limitBounds( 0, list.get( i - 1 ).getHeight() );
            auxb.setBounds( ( int ) auxp.getX(), ( int ) auxp.getY(), GlobalDataStorage.StatementWidth, GlobalDataStorage.StatementHeight );
        }
        add( auxb );
    }

} 
```

麻烦说这是因为它总是处于 if() 条件，所以即使是第一个元素也需要前一个元素（这是 OutOfBounds 的原因），但是每个时刻里面已经有一个元素类型为 0 可以跳转它，其余的进入它：

```
 list = new ArrayList<BlockObject>();
    startingBlock = new BlockObject( 0 ); 
```

那里的类​​型是 0，但它会按照前面的解释发生变化，这是不应该发生的，也不知道为什么会发生。

添加了以下元素：

```
 public void mouseClicked( MouseEvent evt ) {

        point = new Point( evt.getX(), evt.getY() );;

        if( ( findComponentAt( point ) instanceof BlockObject ) && ( StatementPanel.getType() != 0 ) ){

            list.add( new BlockObject( StatementPanel.getType() ) );

            ListBlock();
            revalidate();
            repaint();

        }

    } 
```

BlockObject 创建时的类型保存在一个变量中，并且它应该不会改变，所以我认为每个创建都会用一个值保存在列表中，但它会不断更改在 StatementPanel 新叶时创建的所有先前对象它被选中（StatementPanel 它是在 JTree 之后实现的，每个叶子都有不同的类型）。虽然这可能是获取类型的静态方法，但添加不同的方法不起作用。

也许问题很明显，我看不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:14:29.423

我假设你有这个问题：

```
Example e = new Example();
e.ChangeValue("e");
List<Example> examples = new List<Example>();
examples.add(e);
e.ChangeValue("e2");
examples.add(e); 
```

这样做的问题是，如果您将 e 添加到列表中，它只会创建对该对象的引用，并且添加到列表中的两个引用都指向相同的引用（因此更改一个也会更改另一个），对此的解决方案是 Create一个新对象一个新示例并将其值复制到其中，这样您就不会遇到引用问题并且一次只能更改一个

# r - 如何为 R 中矩阵的每一行重复计算？

> ID：13663580
> 
> 赞同：4
> 
> 时间：2012-12-01T20:44:13.703
> 
> 标签：r, apply

我对编程和 R 非常陌生。我试图找到我的问题的答案，但部分问题是我不知道究竟要搜索什么。

我正在尝试为矩阵的每一行重复计算（统计距离）。这是我到目前为止所拥有的：

```
pollution1 <-as.matrix(pollution[,5:6])
ss <- var(pollution1)
ssinv <- solve(ss)
xbar <- colMeans(pollution1)
t(pollution1[1,]-xbar)%*%ssinv%*%(pollution1[1,]-xbar) 
```

这让我只有第一个统计距离，但我不想用不同的矩阵行重新输入这条线来获得所有这些距离。

根据我的阅读，我可能需要一个循环或使用`apply()`，但我自己没有成功。对此的任何帮助，以及有关如何搜索帮助的建议，因此我不需要发布，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T21:19:30.340

你也可以考虑这个`mahalanobis`函数： from `?mahalanobis`,

> 返回 '​​x' 中所有行的平方马氏距离和向量 mu = 'center' 相对于 Sigma = 'cov'。这（对于向量'x'）定义为
> 
> ```
>  D^2 = (x - mu)' Sigma^-1 (x - mu) 
> ```

当然，学习如何使用`apply`也很好......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T20:48:53.580

只是使用呢`apply`

```
apply(pollution1, 1, function(i) t(i-xbar) %*% ssinv %*% (i-xbar)) 
```

* * *

此外，如果您使您的示例可重现，这将很有帮助，例如：

```
pollution1 = matrix(rnorm(100), ncol=2)
ss = var(pollution1)
ssinv = solve(ss)
xbar = colMeans(pollution1)
t(pollution1[1,]-xbar) %*% ssinv %*% (pollution1[1,]-xbar) 
```

# paypal - 贝宝订阅/定期付款

> ID：13663581
> 
> 赞同：0
> 
> 时间：2012-12-01T20:44:15.280
> 
> 标签：paypal, payment, paypal-ipn

我目前正在为一个网站整理一个处理脚本，并且遇到了一个我似乎无法找到明确答案的问题。Paypal 的文档充其量是不确定的，我使用 Paypal 的程度不足以从他们提供的信息中轻松辨别答案。

当通过 Paypal 创建订阅时，它们首先会返回两个通知 - subscr_payment 和 subscr_signup。

我的问题是：设置数据中的未来付款是作为 subscr_payment 还是作为 recurring_payments 处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T08:54:22.053

未来的付款以“subscr_payment”的形式发送

[https://www.paypal.com/cgi-bin/webscr?cmd=p/acc/ipn-subscriptions-outside](https://www.paypal.com/cgi-bin/webscr?cmd=p/acc/ipn-subscriptions-outside)

# qt - Qt vs XCB：Qt 做低级任务有多强大？

> ID：13663582
> 
> 赞同：0
> 
> 时间：2012-12-01T20:44:25.947
> 
> 标签：qt, qt4, gtk, xcb

我正在尝试创建一个程序来锁定具有 Linux 操作系统的计算机的屏幕，该计算机将使用我自己的身份验证机制解锁。我可以单独在Qt中完成（锁定屏幕，切换到锁定屏幕的能力......）还是我需要学习XCB或相关的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T14:06:20.997

Qt 不涵盖窗口或会话管理（如锁定屏幕）。您需要使用本机 API。

通常锁定屏幕不是随机应用程序做的事情，而是桌面环境提供给用户的事情。因此，在 UI 工具包中涵盖此类任务没有多大意义。（与管理相关的任务也是如此，例如配置网络接口）。

# javascript - 使用 d3.js 在一个 xml 中导入多个 svg

> ID：13663584
> 
> 赞同：1
> 
> 时间：2012-12-01T20:44:38.607
> 
> 标签：javascript, svg, d3.js

目前我正在摆弄 D3.js。看起来棒极了！我想知道 D3.js 是否适合在网页中绘制多个 svg 元素。我找到了 d3.xml 方法并让它工作。

最初我在玩 Raphaeljs，但对于我作为 JS 新手来说，很难找到有用的 tuts/docs。我正在使用 webtool 将 SVG 转换为 JSON 对象，然后将它们包含在 1 个 js 文件中，这是剥离标签和东西的大量工作。这可以节省 HTTP 请求。现在我想对 D3.js 进行同样的尝试，看看哪一个适合我。

使用 D3 导入多 SVG 文件的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:48:49.560

您可以使用 D3 编写的 SVG 数量没有限制。D3 所做的只是访问 DOM 并对其进行修改，以便浏览器知道绘制 SVG 或如何操作 SVG。D3 只是让您更轻松地访问元素并使用它们。

如果您从 JSON 对象中读取 SVG，您只需要读取多个 JSONS。

以 D3js.org 网站的前两个示例为例...

```
d3.csv("morley.csv", function(error, csv) {
  var data = [];

  csv.forEach(function(x) {
    var e = Math.floor(x.Expt - 1),
        r = Math.floor(x.Run - 1),
        s = Math.floor(x.Speed),
        d = data[e];
    if (!d) d = data[e] = [s];
    else d.push(s);
    if (s > max) max = s;
    if (s < min) min = s;
  });

  chart.domain([min, max]);

  var svg = d3.select("body").selectAll("svg")
      .data(data)
    .enter().append("svg")
      .attr("class", "box")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.bottom + margin.top)
    .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
      .call(chart);

  d3.select("button").on("click", function() {
    svg.datum(randomize).call(chart.duration(1000)); // TODO automatic transitions
  });
}); 
```

从箱线图示例中，这将打开“morley.csv”并处理数据。

```
d3.json("flare.json", function(error, root) {
  var node = svg.selectAll(".node")
      .data(bubble.nodes(classes(root))
      .filter(function(d) { return !d.children; }))
    .enter().append("g")
      .attr("class", "node")
      .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

  node.append("title")
      .text(function(d) { return d.className + ": " + format(d.value); });

  node.append("circle")
      .attr("r", function(d) { return d.r; })
      .style("fill", function(d) { return color(d.packageName); });

  node.append("text")
      .attr("dy", ".3em")
      .style("text-anchor", "middle")
      .text(function(d) { return d.className.substring(0, d.r / 3); });
}); 
```

从气泡图示例中，这将打开“flare.json”并开始使用它。没有什么能阻止您在同一个文件中执行这两项操作。

与任何其他程序一样，您需要注意的是变量引用。每个 SVG 都需要自己的参考。上面的两个代码块在几件事上使用了相同的变量名，所以他们会互相踩踏。如果您希望将这两个都放在一个页面上，您只需重命名变量，使它们是唯一的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T21:25:03.893

```
d3.xml("./svgs.xml", "application/xml", function(xml, error) {

    var data = xml.documentElement,
        sections = data.getElementsByTagName("section"),
        svgWrapper = "center";

    for (var i = 0, lenS = sections.length; i < lenS; i++) {    

        var name = sections[i].getElementsByTagName("name")[0].childNodes[0].nodeValue,
            images = sections[i].getElementsByTagName("image");

        for (var j = 0, lenI = images.length; j < lenI ; j++) {   

            //<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
            var image = images[j].firstElementChild;

            //assuming I only target 1 unique HTML5-element
            if (document.getElementsByTagName(name)[0] !== undefined) {

                //in search of wrapper-class and append data to it
                document.getElementsByTagName(name)[0].getElementsByClassName(svgWrapper)[0].appendChild(image);

            // If node "name" is not a element then it's an id
            } else if (document.getElementById(name) !== undefined) {

                document.getElementById(name).getElementsByClassName(svgWrapper)[0].appendChild(image);
            } else {

                console.alert("what the hell went wrong while inserting svgs?!");
                alert("What the hell went wrong while inserting svgs?!");
            }

        }   
    }
}); 
```

如果有人得到指针可能会改进这个，比如 IE9，因为只测试 Chrome 和 Firefox（必须安装 Windows VM）。如何捕获和处理 XHR 中的错​​误参数？

# c++ - 在 C++ 中使用 preincrement 而不是 postincrement 真的很重要吗？

> ID：13663590
> 
> 赞同：1
> 
> 时间：2012-12-01T20:44:59.960
> 
> 标签：c++, optimization, compiler-construction

> **可能重复：**
> [C++ 中的 i++ 和 ++i 之间是否存在性能差异？](https://stackoverflow.com/questions/24901/is-there-a-performance-difference-between-i-and-i-in-c)

Google 的 C++ 样式指南 [1] 指出，使用 preincrement( `++i`) 通常比使用 postincrement( `i++`) 更有效，因此如果忽略返回值，则含义相同，因此更可取。

如果您谈论的是本机类型，则几乎在每种情况下差异可能都可以忽略不计，但是如果您有一个重载的类，我知道它会有所作为。无论如何，考虑到返回值无关紧要的情况，这不是编译器优化的完美目标吗？它发生在现代 C++ 编译器中吗？如果不是，为什么？

[1] [http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml?showone=Preincrement_and_Predecrement#Preincrement_and_Predecrement](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml?showone=Preincrement_and_Predecrement#Preincrement_and_Predecrement)

# python - 在 python 脚本中只使用从 Arduino 读取的最新值，而不是存储在缓冲区中的值？

> ID：13663591
> 
> 赞同：4
> 
> 时间：2012-12-01T20:45:01.593
> 
> 标签：python, serial-port, buffer, arduino, readline

我一直在做一个项目，使用 Python 从 arduino 读取值，然后控制摄像机。Arduino 控制两个超声波传感器并以厘米为单位报告距离。然后，python 脚本使用 ser.readline() 读取与 Arduino 的距离。当脚本读取范围之外的值时，一切正常。但是，如果它进入循环所需范围内的距离，它会正常工作一次，然后从 Arduino 读取旧值而不是当前的“实时”值，这会导致它继续记录循环而不是退出循环。我该怎么做才能摆脱缓冲区中的旧值而只读取最新值？我找到了几种方法并对其进行了测试，但到目前为止还没有运气。

这是我正在使用的代码（我知道它写得不好，但这是我第一次尝试使用 python 并在 matlab 之外编写代码）

```
import sys, time
import serial
import cv
import os
from time import strftime

#Create window for Camera 0
cv.NamedWindow("Camera 0", cv.CV_WINDOW_AUTOSIZE)
capture0 = cv.CreateCameraCapture(2)
cv.ResizeWindow("Camera 1", 640, 480)
cv.MoveWindow("Camera 0", 0, 0)
#Create window for Camera 1
cv.NamedWindow("Camera 1", cv.CV_WINDOW_AUTOSIZE)
capture1 = cv.CreateCameraCapture(1)
cv.MoveWindow("Camera 1", 150, 150)

#Initialize connection to Arduino
arduino = serial.Serial('COM12', 9600)

connected = False

#Confirm that Arduino is connected and software is able to read inputs
while not connected:
    serin = arduino.readline()
    connected = True
    f = 'Sensor Connected'
    print f

'''#Dummy variables for testing
value1 = 145
value2 = 30'''

#Initialize video record on as false (0)
vid = 0

#Initialize counter
counter_vid = 0
counter = 0

Accel = 1

def Camera0():
    frame0=cv.QueryFrame(capture0)
    cv.WriteFrame(writer0,frame0)
    cv.ShowImage("Camera 0", frame0)

def Camera1():
    frame1=cv.QueryFrame(capture1)
    cv.WriteFrame(writer1,frame1)
    cv.ShowImage("Camera 1", frame1)

while True:
    status = arduino.readline()
    value1=int((status[6:10]))-1000
    value2=int((status[17:21]))-1000
    print(value1)
    print(value2)
    if value1>180 and value2>180 and vid==0:
        vid = 0
    elif value1>180 and value2>180 and vid==1:
        vid = 0
    elif value1<180 and vid==0 or value2<180 and vid==0:
        filename0 = strftime("OUTPUT\%Y_%m_%d %H_%M_%S") + " camera0.avi"
        writer0=cv.CreateVideoWriter(filename0, 1, 15.0, (640,480), is_color=1)
        filename1 = strftime("OUTPUT\%Y_%m_%d %H_%M_%S") + " camera1.avi"
        writer1=cv.CreateVideoWriter(filename1, 1, 15.0, (640,480), is_color=1)
        vid=1
        while counter_vid<25 and vid==1:
            Camera0()
            Camera1()
            counter_vid += 1
            print(counter_vid)
            cv.WaitKey(10)
    else:
        while counter_vid<25 and vid==1:
            Camera0()
            Camera1()
            counter_vid += 1
            print(counter_vid)
            cv.WaitKey(10)        

    cv.WaitKey(25)
    counter_vid = 0
    counter += 1
    print('End of Loop Counter')
    print(counter) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T23:04:26.843

你是对的缓冲区填满。您需要一种方法来始终从缓冲区中获取最新值。

我建议更换这个：

```
status = arduino.readline() 
```

有了这个：

```
status = getLatestStatus() 
```

然后通过您的相机功能进一步向上：

```
def getLatestStatus():
    while arduino.inWaiting() > 0:
        status = arduino.readline()
    return status 
```

这个函数 getLatestStatus 每次调用都会遍历整个缓冲区，只返回最新的状态，忽略同时返回的所有状态。

您的另一个选择是修改您的 arduino 的“固件”以在每次收到命令时返回距离传感器值（例如“M\n”），这样您就不必担心缓冲区问题。这就是我为 arduino 供电的超声波测距设备所做的，我觉得它比“读取整个缓冲区”解决方案更清洁。不过，它会在您的距离测量中引入更多延迟。

# mysql - 如何合并两个 SQL 查询以获得最新的 Wordpress 帖子和特色图片

> ID：13663594
> 
> 赞同：0
> 
> 时间：2012-12-01T20:45:31.030
> 
> 标签：mysql, sql, wordpress

我正在尝试在 ASP 页面上显示最新的帖子摘录、帖子标题和特色图片。为了简化查询，我将永久链接添加为每个帖子的自定义字段。我有一个查询可以获取除特色图片之外的所有内容，我还有另一个查询可以获取特色图片，但我不知道如何将它们合并到一个查询中。

// 获取文章摘录和文章标题

```
SELECT
 wp_posts.id, 
 wp_posts.post_title, 
 wp_postmeta.meta_value, 
 wp_postmeta.meta_key, 
 wp_posts.post_excerpt 
 FROM 
 wp_postmeta 
 INNER JOIN wp_posts p ON (wp_postmeta.post_id = wp_posts.ID) 
 WHERE post_id IN (
 SELECT wp_posts.id 
 FROM wp_posts 
 WHERE post_type = 'post' 
 AND post_status = 'publish' 
 AND meta_key = 'my_permalink' 
 ORDER BY post_date, wp_posts.id
 ) 
 ORDER BY wp_posts.post_date DESC, wp_postmeta.post_id 
 LIMIT 2 
```

// 获取帖子的特色图片

```
 SELECT p.*
      FROM wp_postmeta AS pm
     INNER JOIN wp_posts AS p ON pm.meta_value=p.ID 
     WHERE pm.post_id = $ID
       AND pm.meta_key = '_thumbnail_id' 
     ORDER BY p.post_date DESC 
```

谁能帮我合并这些查询？谢谢。

要返回的样本数据：ID | post_title | post_excerpt | meta_value_my_permalink | 特色图片指南

** 更新*** 我已经设法得到以下工作正常，除了我不能得到更多的一行，因为当我尝试在子查询中使用“IN”时出现错误，例如 pm2.post_id IN (SELECT wp_posts. id FROM wp_posts WHERE post_type = 'post' AND post_status = 'publish' ORDER BY post_date DESC LIMIT 2)

```
SELECT 
  p.post_title,
  p.post_excerpt,
  pm.meta_value AS permalink,
  p2.guid as thumbnail,
  p2.post_title as image_alt
FROM
  wp_postmeta pm
  INNER JOIN wp_posts p ON (pm.post_id = p.ID),
  wp_postmeta pm2
  INNER JOIN wp_posts p2 ON (pm2.meta_value = p2.ID)
WHERE
  pm.post_id = (SELECT wp_posts.id FROM wp_posts WHERE post_type = 'post' AND post_status = 'publish' ORDER BY post_date DESC LIMIT 1) AND 
  pm.meta_key = 'my_permalink' AND 
  pm2.post_id = (SELECT wp_posts.id FROM wp_posts WHERE post_type = 'post' AND post_status = 'publish' ORDER BY post_date DESC LIMIT 1) AND 
  pm2.meta_key = '_thumbnail_id' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T07:50:07.890

如果没有一些示例数据，很难看到你想要得到什么，但我认为你知道帖子 ID 并且需要来自 my_permakink 和 _thumbnail_id 键的信息？因为我在平板电脑上，所以我只会给你简单的骨头，让你限制结果集并过滤它。

```
Select *
From wp_posts p
     Inner join
     Wp_postmeta pm1 on p.id = pm1.post_id and metakey = 'my_permalink'
     Inner join
     Wp_postmeta pm2 on p.id = pm1.post_id and metakey = '_thumbnail_id' 
```

这将为您提供每个包含两个元键信息的图像的帖子。如果您想要没有图像的帖子的信息，请将第二个内部连接更改为左连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T20:34:36.070

使用它来检索帖子标题、帖子 ID、帖子特色缩略图 url、帖子类别等 - “选择 a.ID id、a.post_title 标题、a.post_content 内容、分类、名称、a.post_date_gmt postdate、max(c. guid) img_url FROM kb_posts a JOIN kb_term_relationships tr ON (a.id = tr.object_id) JOIN kb_term_taxonomy tt ON (tr.term_taxonomy_id = tt.term_taxonomy_id AND tt.taxonomy='category') JOIN kb_terms t ON (t.term_id = tt .term_id 和 t.term_id = $user_id)

```
 LEFT JOIN
            (select post_parent, max(post_date_gmt) as latest_image_date from kb_posts
            where post_type='attachment' GROUP BY post_parent) b 
            on a.id=b.post_parent

            LEFT JOIN kb_posts c
            on c.post_parent=a.id 
            and c.post_type='attachment' 
            and b.latest_image_date = c.post_date_gmt where c.guid IS NOT NULL

            GROUP BY a.ID ORDER BY a.ID DESC LIMIT 5" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T13:32:06.693

一堆连接和一个视图作为子查询给了我我需要的东西。

```
SELECT 
  p.post_title,
  p.post_excerpt,
  pm.meta_value AS permalink,
  p2.guid AS thumbnail,
  p2.post_title AS thumbnail_alt
FROM
  wp_postmeta pm
  INNER JOIN wp_posts p ON (pm.post_id = p.ID)
  INNER JOIN wp_postmeta pm2 ON (pm2.post_id = p.ID)
  INNER JOIN wp_posts p2 ON (pm2.meta_value = p2.ID)
WHERE
  pm.meta_key = 'my_permalink' AND
  pm2.meta_key = '_thumbnail_id' AND 
  p.ID IN (SELECT * FROM vwLatestPostIds) 
```

# microstrategy - 使用属性选择器更改面板集中的面板（微策略）

> ID：13663598
> 
> 赞同：1
> 
> 时间：2012-12-01T20:46:12.230
> 
> 标签：microstrategy

所以我有一个属性选择器，它当前根据传递给该网格的属性更改网格的视图。我还有一个直接位于网格下方的面板集，其中包含包含 iframe 的面板，当用户在选择器中选择一个属性时，需要对其进行更改。换句话说，当用户从选择器中选择一个属性时，面板会发生变化并显示新的 iframe。有没有办法可以通过属性选择器以某种方式控制面板集？

面板集包含 iframe ，每个面板都有一个带有特定 URL 源的 iframe。如果我能以某种方式将属性传递给 URL，那么 SINGLE 面板中的 iframe 可以根据属性选择器中的选择进行更改，这将是一件很棒的事情。例如，如果我将 iframe 的 URL 源设置为“/servername/microstrategy/asp/{&attribute}.html”，并将我的 html 文件存储在正确的文件夹中。但似乎没有办法将选定的属性传递给 iframe 的源 URL。

我唯一能想到的是以某种方式访问​​ click 事件的“代码隐藏”，以便它像往常一样更改网格，并导致面板集更改面板。

Web 编辑器或 SDK/Eclipse IDE 中有什么东西可以让我访问这样的逻辑吗？或者是否有一些很酷的解决方法可以允许属性选择器更改面板集中显示的面板。

谢谢您的帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T21:46:30.210

有点老问题，但AFAIK没有办法做到这一点。您可能应该使用文本框并将它们用作选择器。也许使用视图过滤器你可以实现类似的东西......

# backbone.js - 骨干js没有路由到我的网址

> ID：13663601
> 
> 赞同：1
> 
> 时间：2012-12-01T20:47:16.607
> 
> 标签：backbone.js, routing

我有下面的设置；主干路由不会在单击产品或销售链接时启动我是否必须从视图中显式调用导航？

```
<script type="text/javascript">

        $(function () {
            var Router = Backbone.Router.extend({
                routes: {
                    "Products": "products",
                    "Sales": "sales"
                },
                products: function () {
                    console.log('products');
                },
                sales: function () {
                    console.log('sales');
                }
            });
        new Router();
            Backbone.history.start();
        });
        </script> 
```

我在 aspx 页面中有 2 个产品链接

```
<div id= "Store">
    <ul>
        <li><a href="#Products">Products</a> </li>
        <li><a href="#Sales"> Sales</a> </li>
</ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:53:09.337

我在您的代码中看到的唯一问题`app.init`是未定义，因此脚本在访问路由器之前崩溃。如果我只是为该方法添加一个存根（或 remove `app.init()`），那么路由会按您的预期触发。

```
var app = {
    init: function() {}
}; 
```

见这里：http: [//jsfiddle.net/ZnrPd/2/](http://jsfiddle.net/ZnrPd/2/)

# breeze - 如何在 Breezejs 中获取 TotalRows 计数，以便我可以进行分页

> ID：13663602
> 
> 赞同：6
> 
> 时间：2012-12-01T20:47:19.210
> 
> 标签：breeze

我正在将 Breezejs 用于客户端 JavaScript。我不确定在使用应用了过滤器（where 子句）的 Breezejs（使用 IQueryable 的服务器端）时如何获取查询总数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-07T20:53:09.947

从 v 0.75.1 开始，我们向 EntityQuery 添加了一个新的“inlineCount”方法。有关详细信息，请参阅微风 API 文档。希望这将提供您所需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T14:41:22.913

我们对 Ward 的方案做了一点改动，因为 Enumerable.Count 会从 db 中加载所有记录，而不仅仅是 count（我们看了 sql profiler 后才意识到这一点）。

首先我们为 IQueryable.Count 扩展方法创建一个包装器（因为我们不能通过反射调用扩展方法）。

```
public static class QueryWrapper {
    public static int Count<T>(IQueryable<T> query) where T: class {
        return query.Count();
    }
} 
```

我们改变了

```
if (actionExecutedContext.Request.RequestUri.Query.Contains("$inlinecount")) {
    if (dQuery is IQueryable) {
        inlineCount = Enumerable.Count(dQuery);
    }
} 
```

使用此代码，

```
if (actionExecutedContext.Request.RequestUri.Query.Contains("$inlinecount")) {
    if (dQuery is IQueryable) {
        var method = typeof(QueryWrapper).GetMethod("Count");
        var genericMethod = method.MakeGenericMethod(elementType);
        inlineCount = (int)genericMethod.Invoke(null, new object[] { dQuery });
    }
} 
```

在此更改之后，实体框架仅获得计数，而不是所有记录。

希望这可以帮助。

祝你今天过得愉快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-02T19:48:33.467

更新： $inlineCount 从 v.0.75.1 开始在微风中，使这个答案过时了。

因此，我删除了我的回答，其中描述了一种解决方法（Umut Özel 在他的回答中改进了一种解决方法）。新功能是由这个 SO 问题和您的所有贡献驱动的。谢谢你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-01T23:20:54.707

[支持 $inlinecount 查询](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions/suggestions/3273039-support-inlinecount-in-queries)目前正在审核中 - 请投票支持。

# joomla - 如何将项目从 K2 转移到 Joomla 文章或 wordpress ？什么是最明智的选择？

> ID：13663603
> 
> 赞同：1
> 
> 时间：2012-12-01T20:47:23.697
> 
> 标签：joomla, joomla2.5, joomla-k2

我对 Joomla K2 扩展感到厌烦。这是我用过的最糟糕的扩展，我厌倦了一直纠正错误和错误。即使是在 K2 论坛中，大部分帖子也突然奇怪地消失了，导致 google 搜索结果达到 404 页。

我在 joomla 上做了最愚蠢的事情：我在 joomla 1.6 中安装了他们的扩展，因为我想在每篇文章中设置特色图片而 joomla 没有类似的东西（然后升级到 2.5）。所以我创建了一个新闻门户，一年内每天发布大约 6 篇文章（或 K2 条目）。到目前为止，有 10 个类别、1000 篇文章和 200 个标签（只有 4 个用户）。网站上没有什么复杂的，所有组件都“按原样”使用。我什至没有使用 K2 额外字段等。

我非常想将所有项目、类别、标签和图像从 K2 转移到 Joomla 文章。然后我会升级到新的Joomla 3.0。如果可以选择，我会将所有数据传输到 wordpress。我没有钱聘请经验丰富的开发人员，而且我拥有高级编程知识，但我不是专家。我可以尝试将数据从一列复制到另一列，但我非常感谢具有“强大”知识的开发人员的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T13:04:35.517

在[Joomla 的论坛上](http://forum.joomla.org/viewtopic.php?p=2528965)，它说：

> K2 文章存储在表 jos_k2_items 中。使用 sql 查询将它们复制到 jos_content。

```
INSERT INTO ###_content (title, alias, catid, published, introtext, fulltext)
SELECT title, alias, catid, published, introtext, fulltext
FROM ###_k2_items ; 
```

这是关于 Joomla 1.5 发布的。检查新的表结构并进行必要的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-22T11:40:02.550

我不确定您是否仍在寻找答案，但也许其他人会这样做。

如果您想将 K2 移动到 WordPress，WordPress 插件目录中有一个[插件](https://wordpress.org/plugins/cms2cms-joomla-k2-to-wp-website-migration/)可用于自动迁移。它支持导入不同类型的内容，包括类别、标签、菜单等，因此它可能会满足您的要求。

该过程的快速指南包括以下步骤 -

1.  您在 WP 网站上安装插件
2.  在服务中创建帐户
3.  下载扩展并将其安装在您的 K2 网站上
4.  选择要迁移的实体
5.  尝试试用迁移（迁移 10 个帖子）
6.  如果你喜欢它，你可以尝试完全迁移（它不是免费的）

您可以参考[这里](https://cms2cms.com/blog/joomla-k2-wordpress-migration-plugin-works/)以获取更多信息，此外，此服务也在[WordPress Codex](https://codex.wordpress.org/Importing_Content#Joomla)中表示。

希望能帮助到你。

# encryption - 关于 NaCL 加密库的问题

> ID：13663604
> 
> 赞同：7
> 
> 时间：2012-12-01T20:47:26.477
> 
> 标签：encryption, cryptography, encryption-symmetric, encryption-asymmetric, nacl-cryptography

我正在寻找实现加密系统的库，并且对使用 NaCl: Networking and Cryptography 库特别是[box 函数](http://nacl.cr.yp.to/box.html)很感兴趣。显然，它使用对称加密 XSalsa20、Curve25519 用于公私加密，Poly1305 用于身份验证作为其原语。

但是，文档在它们的使用方式上看起来不够充分。例如，它提到要计算密钥，它使用发送者的私钥和接收者的公钥来计算密钥。但它没有解释如何。任何人都可以阐明它吗？

如果我要使用相同的公钥和私钥，我不会在下一次尝试时生成相同的密钥，这将是灾难性的。有谁知道它背后的解释，或者给我提供更多关于函数如何工作而不是如何使用函数的文档？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-01T21:30:54.390

## 如何`crypto_box`工作？

`box`在两个密钥上使用 Diffie-Hellman 密钥交换并对结果进行哈希处理。然后它使用它作为`secret_box`.

*   `crypto_box`相当于`crypto_box_beforenm`后面跟着`crypto_box_afternm`。

*   `crypto_box_beforenm`是散列密钥交换，其工作原理如 Curve25519 论文中所述，使用 Curve25519 上的椭圆曲线 Diffie-Hellman 密钥交换，使用 HSalsa 对结果进行散列。这会产生一个 32 字节的共享密钥。

    k = 哈希（曲线 25519（b，A））= 哈希（曲线 25519（a，B））

*   `crypto_box_afternm`与 相同`crypto_secret_box`。它需要一个 24 字节的 nonce 和一个 32 字节的密钥。它是一种经过身份验证的流密码，使用 XSalsa20 进行加密，使用 Poly1305 作为 MAC。XSalsa20 输出的前 32 个字节用于 MAC，其余字节被`xor`编入明文进行加密。

## 如果你多次使用它会发生什么？

如果您采用两个固定的密钥对，则密钥交换的结果将始终相同。

但是，`secret_box`即使您多次使用密钥，对称部分也是安全的，只要您从不为该密钥重复使用 nonce，即 (key, nonce) 对必须是唯一的。

对于所有现代经过身份验证的流密码，此属性几乎相同，例如 AES-GCM 或 XSalsa20-Poly1305。

创建唯一随机数的常用方法是：

*   使用 8 字节前缀和随机 16 字节值（无状态，随机 16 字节很可能是唯一的）
*   使用 16 字节前缀和 8 字节计数器（有状态，在为每个数据包递增的连接中很有用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-03T15:55:17.357

> 例如，它提到要计算密钥，它使用发送者的私钥和接收者的公钥来计算密钥。但它没有解释如何。任何人都可以阐明它吗？

有一个很好的、可以理解的视频，但用的是德语：[https](https://www.youtube.com/watch?v=aC05R9xqbgE) ://www.youtube.com/watch?v=aC05R9xqbg ​​E。该视频解释了“离散对数”和“椭圆曲线”解决方案。

在“椭圆曲线”场景中，公钥 P 是曲线上的一个点（具有 x 和 y 坐标）。P 是通过将生成器 G（由曲线定义）与密钥 K 相乘来计算的。要计算密钥 S，只需将对等点的点 P（对等点的公钥）与自己的密钥 K（a标量数）。两个对等方都进行此操作：

*S_Alice = P_Bob 多 K_Alice = G 多 K_Bob 多 K_Alice*

*S_Bob = P_Alice 多 K_Bob = G 多 K_Alice 多 K_Bob*

由于曲线是一个**交换群**，所以乘法的顺序无关紧要，所以从上面的计算可以看出，最终 Bob 和 Alice 都计算出了相同的密钥。

# node.js - Express redis 会话存储停止在新机器上工作

> ID：13663609
> 
> 赞同：0
> 
> 时间：2012-12-01T20:48:05.063
> 
> 标签：node.js, session, express, redis

我安装了redis，并且可以连接到它，但是会话不会持续并且什么也没有出现。我没有更改任何代码，除了升级到节点 0.8.15 而不是 0.8.6

```
 var RedisStore = require('connect-redis')(express);

  app.use(express.session({
    store: new RedisStore({
      host: cfg.redis.host,
      db: cfg.redis.db
    }),
    secret: 'meow'
  }));

//after login:
      req.session.userid = user._id; 
```

我不得不重新安装 redis，而且我很确定我在 debian 上没有正确执行此操作。该代码在另一台服务器上运行良好。我可以运行 redis-cli 并连接到数据库，但是没有密钥。我启用了调试，但看不到任何明显的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T20:55:12.423

我使用的是debian版本的redis，这行不通。我必须完全安装 2.6.6，特别是运行 ./utils/install_server.sh

顺便说一句，他们的脚本有一个错误：

```
sudo update-rc.d -f mongodb defaults
update-rc.d: using dependency based boot sequencing
insserv: warning: script 'K01redis_6379' missing LSB tags and overrides
insserv: warning: script 'redis_6379' missing LSB tags and overrides 
```

您需要将以下代码添加到 /etc/init.d/redis_6379 的顶部

```
# chkconfig: - 58 74
# description: redis_6379 is the redis daemon.
### BEGIN INIT INFO
# Provides: redis_6379
# Required-Start:    $network $remote_fs $local_fs 
# Required-Stop:     $network $remote_fs $local_fs
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: start and stop redis_6379
# Description: Redis daemon
### END INIT INFO 
```

我在这里提交了一个错误：[https ://github.com/antirez/redis/issues/804](https://github.com/antirez/redis/issues/804)

# c - C中的'memdup'函数？

> ID：13663617
> 
> 赞同：14
> 
> 时间：2012-12-01T20:49:11.680
> 
> 标签：c, memcpy, strdup

在 C 中，您可以使用`strdup`简洁地分配缓冲区并将字符串复制到其中。然而，据我所知，一般记忆没有类似的功能。例如，我不能说

```
struct myStruct *foo = malloc(sizeof(struct myStruct));
fill_myStruct(foo);

struct myStruct *bar = memdup(foo, sizeof(struct myStruct));
// bar is now a reference to a new, appropriately sized block of memory,
//   the contents of which are the same as the contents of foo 
```

那么，我的问题是三方面的：

1.  是否有一些我不知道的像这样的标准库函数？
2.  如果没有，是否有一种简洁且最好是标准的方法来执行此操作而无需显式调用`malloc`and `memcpy`？
3.  为什么 C 包含`strdup`但不包含`memdup`？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-03-13T14:52:56.687

你可以用一个简单的函数来实现它：

```
void* memdup(const void* mem, size_t size) { 
   void* out = malloc(size);

   if(out != NULL)
       memcpy(out, mem, size);

   return out;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-08-13T08:08:20.710

在`void *xmemdup (void const *p, size_t s)`GNU Gnulib 的`xalloc.h`.

请注意，它会`xalloc_die`在内存不足的情况下调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-16T12:41:49.960

您可能只想定义`memdup()`自己，然后按照已经建议的方式在代码中使用它。我的函数版本如下。

```
void *memdup(const void *src, size_t n)
{
    void *dest;

    dest = malloc(n);
    if (dest == NULL)
            return NULL;

    return memcpy(dest, src, n);
} 
```

至于讨论是否`memdup()`过于琐碎甚至多余，我不这么认为。它对于在代码中复制结构非常有用。C 标准库的 ANSI/ISO 和 POSIX 标准都包含如此多的便利功能，但遗憾的是没有这个。

示例：重新实现`strdup()`using `memdup()`.

```
char *strdup(const char *src)
{
    return memdup(src, strlen(src) + 1);
} 
```

示例：`memdup()`用于复制对象。

```
int some_function(const struct some_struct *some_const_data)
{
    struct some_struct *my_mutable_copy;

    my_mutable_copy = memdup(some_const_data, sizeof *some_const_data);
    if (my_mutable_copy == NULL)
        return -1;

    ...

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-01T20:59:23.457

strdup 函数读取并复制空终止字符串上的空值。但是，普通数据没有任何此类分隔符，因此您需要为其指定要复制的数据的长度。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2012-12-01T20:58:46.557

复制任意内存结构并不像复制字符串那么简单。例如，您应该如何处理结构包含指向其他结构（例如字符串）的指针的情况？“复制”这样的结构是什么意思？与字符串的情况不同，对此没有一个正确的答案。在这种情况下，最好让应用程序开发人员根据他们的用例创建一种机制来制作结构的副本，而不是通过假装有一种规范的方法来处理它来混淆问题。

# javascript - 如果已打开，如何通过按钮关闭自动完成下拉菜单

> ID：13663619
> 
> 赞同：4
> 
> 时间：2012-12-01T20:49:27.653
> 
> 标签：javascript, jquery-ui, jquery-ui-autocomplete

由于未知原因，该按钮不会关闭 jquery ui 组合框。

重现此行为的步骤：

1.  在 IE9 中打开[http://jqueryui.com/autocomplete/#combobox 。](http://jqueryui.com/autocomplete/#combobox)

2.  选择右侧的组合框。

3.  单击下拉菜单 [▼] 按钮将其打开。

4.  再次单击下拉菜单 [▼] 按钮。

观察到的：

> 下拉菜单仍然打开

预期的：

> 下拉菜单应关闭。

代码包含：

```
if (input.autocomplete("widget").is(':visible')) {
    input.autocomplete('close');
    return false;
} 
```

但不知为何`input.autocomplete("widget").is(':visible')`总是假的。

如果单击按钮并打开下拉菜单，如何关闭下拉菜单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T08:54:20.197

添加变量：

```
var isVisible = false; 
```

并将此代码添加到的单击事件函数中`$( "<a>" )`：

```
if(isVisible == true)
{
    input.autocomplete( "close" );
    input.blur();
    isVisible = false;
}
else
    isVisible = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-05T14:01:29.887

Javascript 替代方案：

```
 document.getElementById('my_autocomplete_element').blur(); 
```

# xcode - 如何在 XCode/clang 中为 iPhone 编译独立的 ARM 程序集文件

> ID：13663622
> 
> 赞同：3
> 
> 时间：2012-12-01T20:49:52.810
> 
> 标签：xcode, assembly, arm

任何人都可以提供一个简单的示例，说明如何使用 llvm 4.1 编译器在 XCode 4.5 for iPhone 中编译的独立 ARM 程序集文件（.s 文件）中编译和链接函数？换句话说，带有默认编译器的最新 XCode。

我正在尝试从 .cc 或 .mm 文件（都与 cplusplus 兼容）中调用 ARM 汇编函数。

我想将此文件放入 iPhone 的 XCode 模板项目之一（例如 OpenGL 游戏）并调用其中定义的函数（例如，将输入 int 加 1 并返回值的函数）。

我试过这个例子： [Compile Arm Assembly directly in XCode](https://stackoverflow.com/questions/1384118/compile-arm-assembly-directly-in-xcode)

当我尝试此帖子中的代码时出现链接器故障：架构 armv7 的未定义符号：“add_in_asm(int)”，引用自：

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:39:14.220

由于您使用的是 C++/ObjC++，因此链接器将找不到 C 名称，除非它被声明为这样。因此，您应该将您的函数声明为

```
extern "C" int myfunction(...); // or what signature ever... 
```

# c++ - SDL 轮询事件用 z 反转 w，反之亦然

> ID：13663625
> 
> 赞同：2
> 
> 时间：2012-12-01T20:50:36.403
> 
> 标签：c++, sdl

我正在使用 WASD 键进行简单的相机移动：

```
switch (k) {
    case SDLK_w:
        this->up = true;
        break;
    case SDLK_s:
        this->down = true;
        break;
    case SDLK_a:
        this->left = true;
        break;
    case SDLK_d:
        this->right = true;
        break;
    default:
        break;
} 
```

这很不言自明。但是当我按下`w`它时，它根本没有检测到那个按钮被按下。如果我按`a`或`d`或`s`它工作。很酷的一点是，如果我只是更改`SDLK_w`为任何其他按钮（比如说`SDLK_q`）保持相同的确切代码，它就可以工作。这不是我如何处理的问题，`this->up`因为即使我在里面的屏幕上打印一些东西`case SDLK_w:`并且我按下 w 它也不会打印任何东西。

PS：显然我的 w 键没有坏，否则我很难写下这篇文章。

w有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:01:42.627

这可能取决于您使用的键盘类型，实际上您的 W 和 Z 键可能会根据您的键盘布局而颠倒。我建议你试试 ALT+SHIFT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-23T19:38:48.947

Do not use SDLK_w for this as it gives you whatever key actually gives you a W letter, whereas what you want is the key that you'd expect at the W position regardless of the layout, you do this by using scancodes, in this case SDL_SCANCODE_W.

# path - 在哪里可以找到 posix 路径规范？

> ID：13663628
> 
> 赞同：1
> 
> 时间：2012-12-01T20:51:12.143
> 
> 标签：path, posix, specifications

我希望我的应用程序能够处理任何与 posix 兼容的文件路径。但是经过长时间的谷歌搜索，我唯一发现的是[这个 bnf](http://www.gridlab.org/WorkPackages/wp-1/Doc/C-Manual/node273.html)。看起来不像官方和可信赖的来源。

我应该相信上面链接中的信息吗？在哪里可以找到或多或少的官方规范？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T16:29:40.037

[路径名](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap03.html#tag_03_266)的定义

路径名[解析](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap04.html#tag_04_11)

您在上面链接的语法看起来不错。

# java - 请问我的Java代码有什么问题？

> ID：13663631
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:51:47.857
> 
> 标签：java, copy-constructor

为什么我的代码在最后一个输出中返回空值？我应该返回这个： Auto MERCEDES C from Garage: TOP SERVICE (x2) 实际上，完整的输出应该是： Auto FORD S-MAX from Garage: SPEEDY Auto FORD FOCUS from Garage: SPEEDY Auto MERCEDES C from Garage: TOP SERVICE Auto MERCEDES C from Garage：顶级服务

我知道问题出在我的构造函数的某个地方，它构造了我的对象的副本。谢谢

```
public class Garage {

    //final String naam;
    String naam;

    public Garage (String n){
        this.naam = n;
        }
    public String getName(){
        return naam;
    }

    public void setName(String sn){
        this.naam = sn;
    }

    public String toString(){
        return ""+getName(); 

    }

}

public class Auto {

    //static final String brandName; 
    String brandName;
    Garage garage;

    public Auto(String mn){
        this.brandName = mn;

    }
    public Auto(Auto a){
        this.hashCode();
    }
    public Auto(String mn, Garage g){
        //this(mn);
        this.brandName = mn;
        this.garage = g;
    }

    public String getBranName(){
        return brandName;
    }
    public Garage getGarage(){
        return garage;
    }

    public void setGarage(Garage g){
        this.garage = g;
    }

    public String toString(){
        return "Auto "+getBranName()+" from Garage: "+getGarage();
    }

}

public class GarageTester {

    /**
     * @param args
     */
    public static void main(String[] args) {

        Auto auto = new Auto("FORD S-MAX");
        Garage garage = new Garage("SPEEDY");
        auto.setGarage(garage);

        System.out.println(auto);

        auto = new Auto("FORD FOCUS",garage);

        System.out.println(auto);

        auto =  new Auto("MERCEDES C", new Garage("TOP SERVICE"));

        System.out.println(auto);

        Auto kopie = new Auto(auto);

        System.out.println(kopie);

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:02:00.123

你还没有在`Auto`课堂上实现你的复制限制器。

```
public Auto(Auto a){
    this.hashCode();
} 
```

截至目前，它只是调用`hashCode()`方法但不初始化类属性：

请更正如下：

```
public Auto(Auto a){
    this.brandName = a.brandName;
    this.garage = a.garage;
} 
```

一旦完成，则`Auto kopie = new Auto(auto);`语句将生成新的类实例`kopie`，其中包含从实例复制的属性`auto`。

# javascript - 在响应式网站上分离桌面和移动 jQuery 函数

> ID：13663632
> 
> 赞同：0
> 
> 时间：2012-12-01T20:51:52.780
> 
> 标签：javascript, jquery, function, responsive-design, viewport

我正在开发一个响应式站点，该站点具有一组特定的 jQuery 函数，用于桌面布局和移动布局。如果它们同时处于活动状态，它们会相互干扰。

通过检查 window.width，我只能在页面加载时提供正确的功能集，并且我想在 window.resize 上做同样的事情。

我已经在这里设置了一个精简的小提琴：http: [//jsfiddle.net/b9XEj/](http://jsfiddle.net/b9XEj/)

目前存在两个**问题**：

1.  desktopFunctions 或 mobileFunctions 将在页面调整大小时连续触发，无论它们是否已经加载。
2.  如果窗口的大小调整超过一个断点，然后返回到以前的大小，则已经加载了不正确的函数集，从而干扰了当前集。

window.resize 函数的**行为**方式如下：

1.  检查当前是否针对视口大小激活了正确的功能集
2.  如果是，请返回。
3.  如果否，则触发正确的函数集并删除不正确的函数集（如果存在）。

在上面的 Fiddle 示例中，您总是会看到一行，显示“移动功能处于活动状态”或“桌面功能处于活动状态”。

在这一点上我有点迷茫，但我**尝试过**使用

```
if ($.isFunction(window.mobileFunctions)) 
```

检查功能是否已经存在，但我似乎无法在不破坏整体功能的情况下使其工作。这是该代码的小提琴：http: [//jsfiddle.net/nA8TB/](http://jsfiddle.net/nA8TB/)

提前考虑，这种尝试也不会考虑是否已经存在不正确的函数集。所以，我真的希望有一种方法可以更简单地处理这个问题并解决这两个问题。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:20:50.730

以下解决了其中的两个问题。`resize`每秒触发多次，因此使用超时将修复它不断触发您的代码。它还添加了一个检查以查看是否相同的大小有效，如果是则返回

```
$(document).ready(function() {

    var windowType;
    var $wind = $(window);

    var desktopFunctions = function() {
        $('body').append('<p>Desktop functions are active</p>');
    }

    var mobileFunctions = function() {
        $('body').append('<p>Mobile Functions are active</p>');
    }

    var mobileCheck = function() {
        var window_w = $wind.width();
        var currType = window_w < 940 ? 'mobile' :'desktop';

        if (windowType == currType) {
            $('body').append('<p>No Type Change, Width= '+window_w+'</p>');
            return;
        } else {
            windowType = currType;
        }

        if (windowType == 'mobile') {                
            mobileFunctions();
        } else {
            desktopFunctions();
        }
    }

    mobileCheck();
    var resizeTimer;

    $wind.resize(function() {
        if (resizeTimer) {
            clearTimeout(resizeTimer);
        }

        resizeTimer = setTimeout(mobileCheck, 300)
    });

}); 
```

演示：http: [//jsfiddle.net/b9XEj/1/](http://jsfiddle.net/b9XEj/1/)

如果没有看到您的两组函数之间存在一些现实世界的差异，就很难就如何阻止它们发生冲突提供指导。一种可能性是检查`windowType`您的功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:00:35.823

您可以通过添加延迟来防止连续发射`mobileCheck`。使用 a`setTimeout`和`checkPending`布尔值。

```
var checkPending = false;

$(window).resize(function(){
    if (checkPending === false) {
        checkPending = true;
        setTimeout(mobileCheck, 1000);
    }
}); 
```

见这里：http: [//jsfiddle.net/2Q3pT/](http://jsfiddle.net/2Q3pT/)

**编辑**

至于第二个要求，您可以使用此模式来创建或使用现有的：

```
mobileFunctions = mobileFunctions || function() {
    // mobile functions active
}; 
```

见：http: [//jsfiddle.net/2Q3pT/2/](http://jsfiddle.net/2Q3pT/2/)

# android - 是否可以监听另一个应用程序何时启动？

> ID：13663642
> 
> 赞同：2
> 
> 时间：2012-12-01T20:52:58.197
> 
> 标签：android, launching-application

> **可能重复：**
> [Android，检测其他应用何时启动](https://stackoverflow.com/questions/3290936/android-detect-when-other-apps-are-launched)

启动股票计算器时，我希望在其之上启动我的应用程序。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:23:59.680

这是可能的，但应用程序必须一直在后台运行。这将消耗内存和电池寿命。

此外，我不认为强迫最终用户使用您的应用程序在道德上是正确的。

# tags - ExpressionEngine 博客标签

> ID：13663652
> 
> 赞同：0
> 
> 时间：2012-12-01T20:53:43.780
> 
> 标签：tags, blogs, expressionengine

在使用 ExpressionEngine 时，是否有一种内置方法可以以与 WordPress 类似的方式向内容添加标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T13:47:23.777

不，没有与 WP 标签等效的 EE 本机。对于类似的事情，您需要进入第 3 方市场。这里有几个选项：

*   [标记器](http://www.devdemon.com/tagger/)，免费且积极维护和支持（支持需要 50 美元的“开发人员”许可证
*   [标签](http://www.solspace.com/software/detail/tag)，商业广告，约 60 美元

在这两个中，我只使用了 Tagger。它很好地完成了工作，但我无法将其与“标签”进行比较，因为我没有使用它。还有一个叫做 Taggable 但我不相信它已经被积极维护或更新了。（我愿意，但 StackOverflow 不允许我添加超过 2 个链接，直到我的代表增加。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T16:13:20.127

我使用了 Erik 提到的 Tag 和 Tagger。我发现标签足以满足我的需要。Tagger 添加了一些更高级别的功能，但我发现在大多数情况下我不需要它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-02T22:14:42.027

我可能会选择已经列出的两个附加组件之一，但要彻底，还有 Erik 确实提到的 Taggable ，但无法链接到它：

[https://github.com/jamierumbelow/taggable](https://github.com/jamierumbelow/taggable)

# html - 使用 zurb 基础的顶部导航登录表单

> ID：13663653
> 
> 赞同：4
> 
> 时间：2012-12-01T20:53:44.827
> 
> 标签：html, css, zurb-foundation

我已经学习了引导程序，但我正在尝试为不同的项目学习基础知识，只是为了接触它。我想知道是否有任何简单的方法可以将用户名/密码表单添加到顶部导航栏，类似于 bootstrap 的做法？我在这里查看了名为工作区的模板：http: [//foundation.zurb.com/page-templates/workspace.html](http://foundation.zurb.com/page-templates/workspace.html)它在顶部有一个搜索框，看起来与我想要的非常相似，但是当我换行时它周围的一种形式，它变得混乱。有人知道如何在基础中做到这一点吗？

我正在尝试使用的内容：

```
<nav class="top-bar contain-to-grid">
    <ul>
      <li class="name"><img src="/images/betalogo.jpg"></li>
      <li class="toggle-topbar"><a href="#"></a></li>
    </ul>

    <section>
      <ul class="left">
          <li><a href="#">Link 1</a></li>
          <li><a href="#">Link 2</a></li>
      </ul>

      <ul class="right">
        <li>
              <input type="text">
        </li>
        <li>
              <input type="password">
        </li>

        <li class="has-button">
          <input type="submit" class="small button" value="Log In">
        </li>
      </ul>
    </section>
</nav> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T17:36:16.233

我知道这是一个旧线程，我相信您现在已经弄清楚了，但也许其他人可以使用答案。

```
<!-- Right Nav Section --> 
```

<

```
ul class="right">
  <li class="divider hide-for-small"></li>
  <li class="active"><a href="#">Artists</a></li>
  <li class="divider"></li>
  <li class="active"><a href="#">Shows</a></li>
  <li class="divider"></li>
  <li class="active"><a href="#">Radio</a></li>
  <li class="divider"></li>
  <li class="active"><a href="/responsive/blog/">Blog</a></li>
  </li>
  <li class="divider"></li>
  <?php if(empty($_SESSION['user_id'])){ ?>
  <li class="has-form signinform">
    <form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
      <div class="row collapse">
        <div class="columns username">
          <input type="text" placeholder="Username" name="username">
        </div>
        <div class="columns password">
          <input type="text" placeholder="Password" name="password">
        </div>

      </div>

    </li>
    <input type="submit" value="Login" name="login" class="button">
</form>
<?php } 
######end show login######
?>
</ul> 
```

这只是我页面的过去，但是您可以查看是否需要在其中放入表单，您必须在 li 标签中使用“has-form”类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T11:01:29.563

从源头上……</p>

```
<ul class="right">
  <li class="search">
    <form>
      <input type="search">
    </form>
  </li>

  <li class="has-button">
    <a class="small button" href="#">Search</a>
  </li>
</ul> 
```

这将为您提供所需的 UI，但不一定是功能。我发现这个问题是提交按钮在表单之外——因此没用；除非您使用一些 JS 将按钮粘贴到坦率地说会破坏[KISS](http://en.wikipedia.org/wiki/KISS_principle)的表单上。

或者，您可以在表单中使用新行。感谢 Foundation 的行嵌套。确保`.collapse`该行是您希望按钮位于搜索栏旁边；省略它以保持列之间的排水沟。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-02T05:55:55.573

尝试将每个列表项包装在一列中。

```
 <ul class="right">
        <div class="column">
        <li class="username"><form><input type="text" placeholder="Username" /></li></div>
        <div class="column">
        <li><input type="password" placeholder="Password"></li></div>
        <div class="column">
        <li class="has-button"><a class="small button" href="#">Login</a></form></li></div>
    </ul> 
```

# java - 在java中实现一个惰性供应商

> ID：13663655
> 
> 赞同：17
> 
> 时间：2012-12-01T20:54:14.563
> 
> 标签：java, guava, lazy-evaluation

在 Java 中实现惰性供应商的正确范例或实用程序类（似乎找不到预先存在的类）是什么？

我希望有一些东西可以处理一次计算/稍后缓存的行为，并允许我独立指定计算行为。我知道这可能有一个错误，但它具有正确的语义：

```
abstract public class LazySupplier<T> implements Supplier<T> 
{
    private volatile T t;
    final private Object lock = new Object();

    final public T get() {
        if (t == null)
        {
            synchronized(lock)
            {
                if (t == null)
                    t = compute();
            }
        }
        return t;
    }
    abstract protected T compute();
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-01T21:27:40.487

这已经在[`Suppliers.memoize`](http://google.github.io/guava/releases/21.0/api/docs/com/google/common/base/Suppliers.html#memoize-com.google.common.base.Supplier-)方法中实现了。

```
public static <T> Supplier<T> memoize(Supplier<T> delegate) 
```

> 返回一个供应商，它缓存在第一次调用 get() 期间检索到的实例，并在后续调用 get() 时返回该值。见：记忆
> 
> 返回的供应商是线程安全的。委托的 get() 方法最多会被调用一次。供应商的序列化表单不包含缓存值，在重新序列化的实例上调用 get() 时将重新计算缓存值。
> 
> 如果 delegate 是之前调用 memoize 创建的实例，则直接返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-08T17:47:30.313

Apache Commons Lang 有一个[LazyInitializer](https://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/concurrent/LazyInitializer.html)。

# python - NumPy 中的矩阵乘法行为

> ID：13663661
> 
> 赞同：4
> 
> 时间：2012-12-01T20:54:54.103
> 
> 标签：python, matrix, numpy, matrix-multiplication

有以下几点：

```
In [14]: A = array([[1, 1], [3, 2], [-4, 1]])

In [15]: A
Out[15]:
array([[ 1,  1],
       [ 3,  2],
       [-4,  1]])

In [16]: x = array([1, 1])

In [17]: x
Out[17]: array([1, 1])

In [18]: dot(A, x)
Out[18]: array([ 2,  5, -3]) 
```

我期待一列，因为 dot() 函数被描述为普通的矩阵乘法。

为什么它返回一行呢？这种行为似乎非常令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T20:59:46.810

`x`一维向量，因此不知道它是行向量还是列向量。的结果也是如此`dot(A, x)`。

变成`x`二维数组，一切都会好的：

```
In [7]: x = array([[1], [1]])

In [8]: x
Out[8]: 
array([[1],
       [1]])

In [9]: dot(A, x)
Out[9]: 
array([[ 2],
       [ 5],
       [-3]]) 
```

最后，如果您更喜欢使用更自然的矩阵表示法，请转换`A`为`numpy.matrix`：

```
In [10]: A = matrix(A)

In [11]: A * x
Out[11]: 
matrix([[ 2],
        [ 5],
        [-3]]) 
```

# ads - (#4) 达到应用程序请求限制 - ADS API

> ID：13663665
> 
> 赞同：0
> 
> 时间：2012-12-01T20:55:31.867
> 
> 标签：ads, facebook-ads-api

今天早些时候，我的应用程序开始收到这个 API 返回：

```
{
    "error": {
       "message": "(# 4) Application request limit reached",
       "type": "OAuthException"
       "code": 4
    }
} 
```

有问题的电话是这样的：

我已经理解了这个问题，但我想知道我是否可以做一些事情来增加调用的限制。

有没有人经历过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:30:51.147

这实际上被报告为一个错误。如果他们改变了速率限制，这对我们所有在下面的线程上闲逛的困惑的人来说都是新闻；）

[https://developers.facebook.com/bugs/442544732471951?browse=search_50ca0e8ed9fa97632231355](https://developers.facebook.com/bugs/442544732471951?browse=search_50ca0e8ed9fa97632231355)

# c# - 将 c# 代码中的文本添加到 gridview 标签

> ID：13663668
> 
> 赞同：1
> 
> 时间：2012-12-01T20:56:35.940
> 
> 标签：c#, asp.net, gridview, label, itemtemplate

我需要在 gridview 上的 itemtemplate 中添加特定文本...

现在我在我的gridview中有这个

```
<asp:TemplateField HeaderText="Total" SortExpression="Total" ItemStyle-Width="100px">
    <ItemTemplate>
        <asp:Label ID="lblTotal" runat="server" Text='<%#Math.Round(Convert.ToDouble(Eval("Total")), 2).ToString("C") + " M.N."%>'>
        </asp:Label>
    </ItemTemplate>
</asp:TemplateField> 
```

在它说的部分

```
<asp:Label ID="lblTotal" runat="server" Text='<%#Math.Round(Convert.ToDouble(Eval("Total")), 2).ToString("C") + " M.N."%>'> 
```

我做了一个特定的文本，但它总是相同的文本（当然除了在 Eval 中）......但我需要从这个方法中获取我需要的格式。

```
public static string GetFormatoMoneda(decimal decCantidad)
{
    //Get data from currency (Dollars, Pesos, Euros, etc.)
    DataRow dr = ConexionBD.GetInstanciaConexionBD().GetTipoDeMonedaPrincipal((int)HttpContext.Current.Session["Grupo"]);

    return dr["Signo"] + Math.Round(decCantidad, 2).ToString("C").Substring(1) + " " + dr["Abreviatura"];
} 
```

我使用这种方法来获取特定的字符串并在标签上使用它（我在cs文件上的代码上分配它）..但在这种情况下......我必须将该文本插入到gridview的列上......

如何获取该字符串值并将其插入到模板字段/项目模板内的标签上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T00:21:22.393

代替 ...

```
Text='<%#Math.Round(Convert.ToDouble(Eval("Total")), 2).ToString("C") + " M.N."%>' 
```

...采用

```
Text='<%#GetFormatoMoneda(Eval("Total"))%>' 
```

但是，这假定 GetFormatoMoneda 与 Web 表单属于同一类。如果没有，那么您需要包含类名，例如

```
Text='<%#MyClass.GetFormatoMoneda(Eval("Total"))%>' 
```

然后您需要更改 GetFormatoMoneda 以使用对象类型参数，例如

```
public static string GetFormatoMoneda(object objCantidad)
{
    var decCantidad = Convert.ToDecimal(decCantidad);

    //Get data from currency (Dollars, Pesos, Euros, etc.)
    DataRow dr = ConexionBD.GetInstanciaConexionBD().GetTipoDeMonedaPrincipal((int)HttpContext.Current.Session["Grupo"]);

    return dr["Signo"] + Math.Round(decCantidad, 2).ToString("C").Substring(1) + " " + dr["Abreviatura"];
} 
```

或者使用带有对象参数的其他方法并调用 GetFormatoMoneda(decimal)，传入正确的值，例如

```
protected string CorrectFormat(object obj)
{
    return GetFormatoMoneda(Convert.ToDecimal(obj));
} 
```

在这种情况下你会使用

```
Text='<%#CorrectFormat(Eval("Total"))%>' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T17:51:49.677

如果您想以编程方式执行此操作，则可以这样做：

默认.aspx：

```
<asp:GridView ID="gvGrid" runat="server" AutoGenerateColumns="false" OnRowDataBound="gvGrid_RowDataBound">
  <Columns>
    <asp:TemplateField>
      <ItemTemplate>
        <asp:Label ID="lblTotal" runat="server" />
      </ItemTemplate>
    </asp:TemplateField>
  </Columns>
</asp:GridView> 
```

默认.aspx.cs：

```
protected void Page_Load(object sender, EventArgs e)
{
  if (!IsPostBack)
  {
    //Generate fake data
    var data = Enumerable.Range(1, 20);

    //Give the data to the grid
    gvGrid.DataSource = data;
    gvGrid.DataBind();
  }
}

protected void gvGrid_RowDataBound(object sender, GridViewRowEventArgs e)
{
  if (e.Row.RowType == DataControlRowType.DataRow)
  {
    //Find the control
    var lblTotal = (Label)e.Row.FindControl("lblTotal");

    //Get the data for this row
    var data = (int)e.Row.DataItem;

    //Display the data
    lblTotal.Text = data.ToString();
  }
} 
```

# c++ - 函数中的变量是否始终在 Arduinos 上保留在 RAM 中？

> ID：13663669
> 
> 赞同：1
> 
> 时间：2012-12-01T20:56:51.227
> 
> 标签：c++, memory, memory-management, arduino

我有一个相当大的 Arduino 草图，它正在推动处理器上可用内存的极限。正如我正在释放内存并尽可能减少对全局变量的使用一样。我正在使用`MemoryFree.h`（可以在[此处](http://arduino.cc/playground/Code/AvailableMemory)找到详细信息）来检查可用内存。我有一个工作草图（在这里发布太长），但是当我添加另一个带有一些变量的函数（在我认为可用内存范围内）时，我的系统由于没有内存而崩溃或停止。

我添加了以下功能：

```
boolean moved(){

int yreadings[4];
int zreadings[4];

free(&yreadings);
free(&zreadings);
} 
```

然后我将以下代码添加到我的主循环中：

```
 Serial.print("Mem is ");
 Serial.println(freeMemory());
 moved(); 
```

如果`moved()`在循环中并且下面的整个函数被注释掉，我会得到一个输出

```
Mem is 499 
```

在每次迭代中，表明每次迭代都不会丢失内存。

然而，如果我取消注释函数并调用它，我会得到以下输出：

```
Mem is 499
Mem is -16094 
```

在崩溃之前的第一行和第二行...

即使内存是持久的，这不应该只使用比每次迭代的全部 499 字节少得多吗？不过，我怎么会失去任何记忆？

更新：更奇怪的是：如果我删除了moved（）函数并全局声明整数数组，我仍然会得到499的内存读取。这是怎么回事？不应该减少24个整数消耗的内存量吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T21:13:08.383

如果您只需要在函数执行的一部分中存在自动存储，您可以将它们放在范围块中：

```
void foo(void) {

   // some code where neither reading variable is occupying memory

   {
      int yreadings[4];
      int zreadings[4];

      // here these variable are taking up memory

   }

   // other code where neither reading variable is occupying memory
} 
```

但当然，您只能在该块中使用它们。

* * *

为了扩展我的评论，有三类内存使用具有不同的持续时间

*   在函数或方法或类上下文中声明的全局变量和变量`static`存在于程序的整个生命周期
*   自动变量（在函数或方法中声明的变量）在其范围的生命周期内存在，包括从该范围调用的任何其他子程序的生命周期
*   动态分配是从`new`¹或`alloc`函数族获得的内存块（由于簿记原因，它总是比您请求的大小稍大），从您分配它们的时间一直持续到您调用`delete`或`free`（分别）。

* * *

¹如果您覆盖`new`它，它可能仍然适用，也可能不适用，但如果您这样做，则需要注意了解您对自己做了什么。

# html5-canvas - 在 createjs 中添加渐变文本

> ID：13663671
> 
> 赞同：1
> 
> 时间：2012-12-01T20:57:25.440
> 
> 标签：html5-canvas, easeljs, createjs

我目前正在寻找一种向使用 textjs 生成的文本对象添加渐变的方法。

```
 this.text = new createjs.Text(this.val, this.font, "#efa146");
    this.text.textAlign = "center";
    this.text.y = this.pos.y;
    this.text.x = this.pos.x;

    console.log(this.text);

    window.stage.addChild(this.text); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-02-07T05:52:17.047

其实很简单，像这样扩展Text对象

```
<script>
    (function () {
        function GradientText(text, font, color) {
            this.Text_constructor(text, font, color);
        }

        var p = createjs.extend(GradientText, createjs.Text);

        p._drawTextLine = function (ctx, text, y) {
            if (this.gradient) {
                var height = this.getMeasuredLineHeight();
                var my_gradient = ctx.createLinearGradient(0, y, 0, y + height);
                my_gradient.addColorStop(0, "black");
                my_gradient.addColorStop(1, "white");

                ctx.fillStyle = my_gradient;
                ctx.fillText(text, 0, y, this.maxWidth || 0xFFFF);
            } else {
                this.Text__drawTextLine(ctx, text, y);
            }
        };

        window.GradientText = createjs.promote(GradientText, "Text");
    }());
</script> 
```

现在只需创建一个`GradientText`这样的实例：

```
 var text = new GradientText("Hello world!", "20px Arial", "#ff0000");
 text.gradient = true; 
```

将文本添加到`stage`. 这是它的 jsfiddle：[https ://jsfiddle.net/r94zmwxa/](https://jsfiddle.net/r94zmwxa/)

*PS我刚刚写了一个例子（黑色和白色），但你可以改变`addColorStop`从`this.gradient`动态设置渐变颜色！*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T22:08:48.540

目前没有办法做到这一点。对不起。有计划在未来为 Text 添加对填充和描边方法的更好控制。

# python - 无需下载即可获取 Gmail 附件文件名

> ID：13663672
> 
> 赞同：13
> 
> 时间：2012-12-01T20:57:36.173
> 
> 标签：python, gmail, attachment, imaplib

我正在尝试从可能包含一些大附件（约 30MB）的 Gmail 帐户获取所有邮件。我只需要名称，而不是整个文件。我找到了一段代码来获取消息和附件的名称，但它会下载文件然后读取其名称：

```
import imaplib, email

#log in and select the inbox
mail = imaplib.IMAP4_SSL('imap.gmail.com')
mail.login('username', 'password')
mail.select('inbox')

#get uids of all messages
result, data = mail.uid('search', None, 'ALL') 
uids = data[0].split()

#read the lastest message
result, data = mail.uid('fetch', uids[-1], '(RFC822)')
m = email.message_from_string(data[0][1])

if m.get_content_maintype() == 'multipart': #multipart messages only
    for part in m.walk():
        #find the attachment part
        if part.get_content_maintype() == 'multipart': continue
        if part.get('Content-Disposition') is None: continue

        #save the attachment in the program directory
        filename = part.get_filename()
        fp = open(filename, 'wb')
        fp.write(part.get_payload(decode=True))
        fp.close()
        print '%s saved!' % filename 
```

我必须每分钟执行一次，所以我无法下载数百 MB 的数据。我是网络脚本的新手，所以有人可以帮助我吗？我实际上不需要使用 imaplib，任何 python 库对我来说都可以。

此致

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-01T21:31:00.543

而不是 fetch `RFC822`，这是完整的内容，你可以指定`BODYSTRUCTURE`.

由此产生的数据结构`imaplib`相当混乱，但您应该能够找到消息每个部分的文件名、内容类型和大小，而无需下载整个内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-01T21:01:33.357

如果您对文件名有所了解，可以使用[imap SEARCH 命令的 X-GM-RAW gmail 扩展名](https://developers.google.com/google-apps/gmail/imap_extensions)。这些扩展允许您使用任何[gmail 高级搜索](http://support.google.com/mail/bin/answer.py?hl=en&answer=7190)查询来过滤邮件。这样，您可以将下载限制为匹配的消息，或排除一些您不想要的消息。

```
mail.uid('search', None, 'X-GM-RAW', 
       'has:attachment filename:pdf in:inbox -label:parsed')) 
```

上述搜索收件箱中未标记为“已解析”的带有 PDF 附件的邮件。

一些专业提示：

*   标记您已经解析的消息，因此您不需要再次获取它们（上例中的 -label:parsed 过滤器）
*   总是使用 uid 版本而不是标准的顺序 ids（你已经这样做了）
*   不幸的是，MIME 很混乱：有很多客户做奇怪（或完全错误）的事情。您可以尝试仅下载和解析标头，但这值得吗？

[编辑]

如果在解析后标记消息，则可以跳过已解析的消息。这应该足够合理以监控您的班级邮箱。

也许您生活在互联网带宽比程序员时间更昂贵的世界角落；在这种情况下，您可以仅获取标题并查找“Content-disposition”==“attachment；filename=somefilename.ext”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-01T21:16:05.590

消息数据项的 FETCH 在`RFC822`功能上等同于`BODY[]`。IMAP4 支持其他消息数据项，列在[RFC 3501 的 6.4.5 节中](https://www.rfc-editor.org/rfc/rfc3501#section-6.4.5)。

尝试请求一组不同的消息数据项以获取您需要的信息。例如，您可以尝试`RFC822.HEADER`或可能`BODY.PEEK[MIME]`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-27T20:26:00.740

老问题，但只是想分享我今天提出的解决方案。搜索所有带有附件的电子邮件并输出 uid、发件人、主题和格式化的附件列表。编辑相关代码以显示如何格式化 BODYSTRUCTURE：

```
 data   = mailobj.uid('fetch', mail_uid, '(BODYSTRUCTURE)')[1]
    struct = data[0].split()        
    list   = []                     #holds list of attachment filenames

    for j, k in enumerate(struct):
        if k == '("FILENAME"':
            count = 1
            val = struct[j + count]
            while val[-3] != '"':
                count += 1
                val += " " + struct[j + count]
            list.append(val[1:-3])
        elif k == '"FILENAME"':
            count = 1
            val = struct[j + count]
            while val[-1] != '"':
                count += 1
                val += " " + struct[j + count]
            list.append(val[1:-1]) 
```

我也在[GitHub 上](https://github.com/jarps/emails_if_attachment/blob/master/fetch.py)发布了它。

**编辑**

上述解决方案很好，但从有效负载中提取附件文件名的逻辑并不可靠。当文件名包含第一个单词只有两个字符的空格时，它会失败，

例如：“ad cde gh.png”。

尝试这个：

```
import re # Somewhere at the top

result, data = mailobj.uid("fetch", mail_uid, "BODYSTRUCTURE")

itr = re.finditer('("FILENAME" "([^\/:*?"<>|]+)")', data[0].decode("ascii"))

for match in itr:
    print(f"File name: {match.group(2)}") 
```

[在这里](https://regex101.com/r/9emVOm/1)测试正则表达式。

# c# - 获取泛型参数的泛型函数

> ID：13663673
> 
> 赞同：0
> 
> 时间：2012-12-01T20:57:39.800
> 
> 标签：c#, generics

这可能是一些愚蠢的疏忽，但它是这样的：

```
public class Entity<TId> where TId : IEquatable<TId>
{
    public virtual TId Id { get; private set; }
}

public class Client : Entity<Guid> { }
public class State : Entity<short> { }

public class Helper
{
    protected IList<Client> clients;
    protected IList<State> states;

    //Works
    public T Get<T>()
    {
        return default(T);
    }

    public T Get<T>(Guid id) where T : Entity<Guid>
    {
        return default(T);
    }

    public T Get<T>(short id) where T : Entity<short>
    {
        return default(T);

    }
} 
```

我到底如何编写适用于这两个类的 Get 函数？以及从实体继承的所有其他人？

我只是希望我不会得到太多的反对票。:(

**编辑**

这就是它将被使用的地方。所以它不会只有两个类。但基本上我模型上的所有类。

```
 //What should I declare here?
    {
        TEntity result = default(TEntity);
        try
        {
            using (var tx = session.BeginTransaction())
            {
                result = session.Query<TEntity>().Where(e => e.Id == Id).FirstOrDefault();
            }
            return result;
        }
        catch (Exception ex)
        {

            throw;
        }
    } 
```

**使用SWeko给出的解决方案**

```
public TEntity Get<TEntity, TId>(TId Id)
            where TEntity : Entity<TId>
            where TId : IEquatable<TId>
        {
            try
            {
                TEntity result = default(TEntity);
                using (var tx = statefullSession.BeginTransaction())
                {
                    result = statefullSession.Query<TEntity>().Where(e => e.Id.Equals(Id)).FirstOrDefault();
                }
                return result; 
            }
            catch (Exception ex)
            {
                throw;
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:24:50.097

如果问题只是在方法的`where`子句中放入什么`Get`，您可以这样做：

```
public TEntity Get<TEntity, TId> (TId id) where TEntity : Entity<TId>
                                          where TId : IEquatable<TId>
{
  .....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:35:16.883

我认为不需要泛型`Get`方法，因为您想从两个预定义的列表中返回预先知道的类型（客户端、状态）的对象。

```
public class Helper
{
    protected IList<Client> clients;
    protected IList<State> states;

    public Client GetClient(Guid id)
    {
        return clients.Where(c => c.Id == id);
    }

    public State GetState(short id)
    {
        return states.Where(s => s.Id == id);
    }
} 
```

考虑使用字典来提高速度，其中 id 用作键。

* * *

或者，您可以将两个公共 Get 方法基于一个私有通用 Get 方法

```
private TEntity Get<TEntity,TId>(IList<TEntity> list, TId id)
{
    return list.Where(item => item.Id == id);
}

public Client GetClient(Guid id)
{
    return Get(clients, id);
}

public State GetState(short id)
{
    return Get(states, id);
} 
```

# php - 数据库表结构查询

> ID：13663674
> 
> 赞同：0
> 
> 时间：2012-12-01T20:57:40.477
> 
> 标签：php, mysql, sql, database, database-design

只需快速查询适合小型应用程序的最佳数据库结构，[数据库将是 SqlLite 或 MySql 以及用 PHP 编写的应用程序，如果有帮助的话]

基本上我的问题是条目将有很多选项，并且这些选项可能会被添加和删除，因此编辑数据库结构可能不是最好的主意。我只是想知道将此选项存储到数据库的最佳方法是什么。在过去的类似情况下，我通过将序列化或 JSON 格式的数据存储到表行来实现这一点，但我想知道这是否是最佳选择，任何建议都会很棒。

该应用程序是基于地图的，用户可以在其中添加/删除标记，标记具有类型[例如商店、学校、医院等]。用户还可以添加和删除类型。除此之外，用户可以创建地图视图，例如只有学校和医院可见的地图。

这有点难以描述，但这里是描述 [ 简化 ] 表结构

***标记***

```
+---------+-----+-----+--------+-----------+
|markerID | lat | lng | typeID | name      |
+---------+-----+-----+--------+-----------+
|1        | 52  | -9  | 1      | A School  |
|2        | 52  | -9  | 2      | A Shop    |
|3        | 52  | -9  | 1      | B School  |
|4        | 52  | -9  | 3      | A Hospital|
+---------+-----+-----+--------+-----------+ 
```

***标记类型***

```
+-------+-------------+--------------+
|typeID | name        | icon         |
+-------+-------------+--------------+
|1      | Schools     | school.png   |
|2      | Shops       | shop.png     |
|3      | Hospitals   | hospitals.png|
+-------+-------------+--------------+ 
```

***地图视图***

```
+------+---------------------+---+
|mapID | name                | ??|
+------+---------------------+---+
|1     | Schoool & Shops     | ??|
|2     | Hospitals & Schools | ??|
+------+---------------------+---+ 
```

所以我的问题基本上是，存储 mapID #42 应该显示带有 typeID #2、#5 和 #23 的标记的信息的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:06:22.263

据我了解，地图视图可能有许多标记（这是逻辑）。所以我认为连接表将是最好的解决方案。例如名为 MapMarkers 的表，其结构如下： MapMarkers

```
 | id | MapID | MarkersID | ?? | ( you can add other infos for example if you want to store personnalized maps for each client you can add userID) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:03:55.363

您应该使用第三个表来表示两个表之间的关系：

mapView ---- < mapView-markerType > ---- markerType

mapView-markerType 将具有以下属性： | 编号 | 地图ID | 类型ID |

（显然，您应该得到一个比 mapView-markerType 更短的名称）

**编辑** 考虑到您在帖子上所做的更改，您将获得：

**mapView_markerType**

```
 id*    | mapId    | typeId
  --------|----------|----------
    1     | 1        | 1
    2     | 1        | 2
    3     | 2        | 1
    4     | 2        | 3 
```

***编辑2***

因此，为了进一步解释我对以下评论的意思：

***地图视图***

```
+------+---------------------+----------+
|mapID | name                | typeComb |
+------+---------------------+----------+
|1     | Schoool & Shops     |  {1,2}   |
|2     | Hospitals & Schools |  {1,3}   |
+------+---------------------+----------+ 
```

# silverlight - Windows Phone XNA 和 Silverlight 不能使用 Pivot Control？

> ID：13663675
> 
> 赞同：2
> 
> 时间：2012-12-01T20:58:04.130
> 
> 标签：silverlight, xna, windows-phone, pivot

我正在尝试创建一个使用 Silverlight + XNA（“Windows Phone XAML 和 XNA”模板）的 Windows Phone 7 组合应用程序。一页将有 XNA+Silverlight UI 控件，其余的将是没有 XNA 的纯 UI 页面。我想在其中一个纯 UI 页面上使用 Pivot 控件，但是当我添加默认的 Pivot 页面模板时，它不断抛出错误。

无法将指定的值分配给集合。预期以下类型：“UIElement”

无法将内容添加到“Pivot”类型的对象...

我似乎找不到任何信息为什么不允许 Pivot 控件。任何人都知道为什么使用 Pivots 不能与 XNA+Silverlight 一起使用？尤其是因为它仅用于 UI 页面（无 XNA）。如果我创建一个仅 Silverlight 的项目，则 Pivot 页面很好。这是在 Visual Studio 2012 顺便说一句。谢谢！

# c# - 声明字节数组以从文件中获取字节

> ID：13663685
> 
> 赞同：-1
> 
> 时间：2012-12-01T20:59:20.323
> 
> 标签：c#

基本上我正在使用流阅读器将文件中的所有字节读入字节数组。

我声明的数组如下所示：`byte[] array = new byte[256];`

数组256的大小可以从文件中读取整个字节吗？说一个文件有 500 个字节而不是 256 个字节？

或者数组中的每个元素的大小为 256 字节？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:01:50.247

只需使用

```
 byte[] byteData = System.IO.File.ReadAllBytes(fileName); 
```

然后您可以通过查看`byteData.Length`属性来了解文件的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:02:24.297

您可以[`File.ReadAllBytes`](http://msdn.microsoft.com/en-us/library/system.io.file.readallbytes.aspx)改用：

```
byte[] fileBytes = File.ReadAllBytes(path); 
```

或者，如果您只想知道大小，使用[`FileInfo`](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)对象：

```
FileInfo f = new FileInfo(path);
long s1 = f.Length; 
```

**编辑**：如果你想“以经典的方式”评论：

```
byte[] array;
using (FileStream fileStream = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.Read))
{
    int num = 0;
    long length = fileStream.Length;
    if (length > 2147483647L)
    {
        throw new ArgumentException("File is greater than 2GB, hence it is too large!", "path");
    }
    int i = (int)length;
    array = new byte[i];
    while (i > 0)
    {
        int num2 = fileStream.Read(array, num, i);
        num += num2;
        i -= num2;
    }
} 
```

（通过反映`ILSpy`）

# linux - 替换文件Unix中的字符串

> ID：13663696
> 
> 赞同：9
> 
> 时间：2012-12-01T21:01:13.160
> 
> 标签：linux, string, unix, replace, sed

我`file1.txt`在 Unix 上有一个文本文件。我想生成另一个文件`file2.txt`，在其中我将所有出现的 替换`apple-pie`为`apple_pie`。我可以使用什么命令？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-01T21:03:06.990

用于`sed`对输出进行全局替换`file1.txt`并将输出重定向到`file2.txt`：

```
sed 's/apple-pie/apple_pie/g' file1.txt > file2.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-01T20:01:14.713

`sed`具有更好的性能，`awk`但两者都适用于此搜索和替换。[参考](https://davidlyness.com/post/the-functional-and-performance-differences-of-sed-awk-and-other-unix-parsing-utilities)

如果您将命令放在脚本中（例如，ksh、sh），那么语法如下：

```
awk '{gsub(/apple-pie/,"apple_pie");print}' "file1.txt" > "file2.txt"
sed -e 's/apple-pie/apple_pie/g' "file1.txt" > "file2.txt" 
```

# wcf - 在 Oracle VirtualBox 中测试 WCF 服务

> ID：13663702
> 
> 赞同：1
> 
> 时间：2012-12-01T21:01:42.053
> 
> 标签：wcf, wcf-binding

我正在使用使用 TCP 绑定的自托管 WCF 服务。我想在我的 VirtualBox 的虚拟机上测试它。我使用 NAT 作为网络驱动程序。我应该使用端口转发吗？我应该如何更改我的客户端应用程序的 .config 文件？这是我用于在 localhost 上进行测试的一个：

```
<client>
     <endpoint address="net.tcp://localhost:8090/Service/" 
               binding="netTcpBinding"
               bindingConfiguration="NetTcpBinding_IMyWCFService"
               contract="MyWCFService.IMyWCFService"
               name="NetTcpBinding_IMyWCFService">
     </endpoint>
</client> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:15:12.663

NAT 很好，如果您只想在本地进行开发和测试，NAT 应该会相应地工作，但是如果您想用虚拟机处理外部请求，那么 NAT 太基础了，不会让服务器角色。

因此最好使用 Bridge Networking 配置您的 VM：[https ://blogs.oracle.com/fatbloke/entry/networking_in_virtualbox1#Bridged](https://blogs.oracle.com/fatbloke/entry/networking_in_virtualbox1#Bridged)

在这种情况下，您将在您的虚拟服务器中拥有自己的 IP，您可以在 app.config 中配置它，并且您将能够从“外部世界”指向

# tree - 向树中添加节点

> ID：13663703
> 
> 赞同：0
> 
> 时间：2012-12-01T21:01:48.093
> 
> 标签：tree, go

我正在使用 Go 编程语言开发一个项目，我需要一个树结构以及向树中添加节点（很多节点）的能力。每个节点都是一个结构，如下所示：

```
type Node struct {
    ip net.IP
    nodes []Node
    value int
} 
```

每个节点可以拥有的节点数是可变的（在 1-4 之间）。IP 地址（我稍后会搜索）可以包含在节点中，但大多数节点对于该元素将是 nil。

我可以用其他语言轻松地做到这一点，但我需要找到一种有效的方法将这些节点添加到 Go 中的树中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T00:00:21.267

例如，`nodes`作为指向 的指针切片`Node`，

```
package main

import (
    "fmt"
    "net"
)

type Node struct {
    value int
    ip    net.IP
    nodes []*Node
}

func main() {
    node1 := Node{value: 1}
    node2 := Node{value: 2}
    node3 := Node{value: 3}
    node4 := Node{value: 4}
    node1.nodes = append(node1.nodes, &node2, &node3)
    node2.nodes = append(node2.nodes, &node4)
    node3.nodes = append(node3.nodes, &node4)
    fmt.Printf("node1: %p %v\n", &node1, node1)
    fmt.Printf("node2: %p %v\n", &node2, node2)
    fmt.Printf("node3: %p %v\n", &node3, node3)
    fmt.Printf("node4: %p %v\n", &node4, node4)
} 
```

输出：

```
node1: 0xc200069100 {1 [] [0xc200069180 0xc200069200]}
node2: 0xc200069180 {2 [] [0xc200069240]}
node3: 0xc200069200 {3 [] [0xc200069240]}
node4: 0xc200069240 {4 [] []} 
```

[切片类型](http://golang.org/ref/spec#Slice_types)

[追加和复制切片](http://golang.org/ref/spec#Appending_and_copying_slices)

[切片技巧](http://code.google.com/p/go-wiki/wiki/SliceTricks)

[指针类型](http://golang.org/ref/spec#Pointer_types)

# iphone - 如何从子类正确设置超类属性

> ID：13663707
> 
> 赞同：1
> 
> 时间：2012-12-01T21:02:22.517
> 
> 标签：iphone, objective-c, ios

我正在继承 UITextField 并希望为其 rightView 属性分配一个自定义按钮。我在子类的 setFrame 中设置了按钮。

我的文本字段在 ViewController 和 Class 中的出口连接设置为我在 Interface Builder 的 Identity Inspector 中的子类。

问题是我的自定义按钮没有出现。

我试图克服这个问题并在我的子类中创建了一个 setupRightView 方法。然后，当我从 View Controller 调用 outlet 属性上的 setupRightView 时——瞧——一切正常！

我对Objective-C还很陌生，我想我在对象模型上犯了一些愚蠢的错误。为什么我不能在我的子类中正确设置 rightView 属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:49:03.150

您是否记得这样做：

self.rightViewMode = UITextFieldViewModeAlways;

该属性默认设置为 UITextFieldViewModeNever，因此如果不包含该行，您将看不到您的按钮。

编辑后：我检查了将我的代码放入 setFrame 中，但它在那里不起作用——不知道为什么。如果我把它放在 awakeFromNib 中效果很好。

```
-(void)awakeFromNib {
    UIButton *myButton = [UIButton buttonWithType:2];
    self.rightView = myButton;
    self.rightViewMode = UITextFieldViewModeAlways;
} 
```

# python - Python 在寻路时冻结

> ID：13663710
> 
> 赞同：2
> 
> 时间：2012-12-01T21:02:42.357
> 
> 标签：python, path-finding

我有一个脚本，它使用邻接图和 BFS 算法来查找两点之间的路径。该图有大约 10,000 个顶点，脚本设置如下：

```
graph = {...
         '9660': ['9661', '9662', '9659'],
         '9661': ['9654', '9660'],
         '9662': ['9660', '9663'],
         '9663': ['9664', '9662'],
         '9664': ['9665', '9663'],
                              ...}

def bfs(graph, start, end):
# maintain a queue of paths
queue = []
# push the first path into the queue
queue.append([start])
while queue:
    # get the first path from the queue
    path = queue.pop(0)
    # get the last node from the path
    node = path[-1]
    # path found
    if node == end:
        return path
    # enumerate all adjacent nodes, construct a new path and push it into the queue
    for adjacent in graph.get(node, []):
        new_path = list(path)
        new_path.append(adjacent)
        queue.append(new_path)

print bfs(graph, '50', '8659') 
```

因为这个算法适用于小的邻接图，我猜 python 只需要很长时间来处理这个大小的图。我的目标是找到最短的路径，但如果我什至找不到一条路径，那目前是不可能的。是否有使用大型邻接图处理路径查找的 python 解决方案？如果是这样，我可以举个例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T12:27:35.147

您没有跟踪访问过的节点，如果您的图不是有向无环图，这可能会导致大量时间浪费。例如，如果您的图表是

```
{'A': ['B', 'C', 'D', 'E'],
 'B': ['A', 'C', 'D'],
 'C': ['A', 'B', 'D'],
 'D': ['A', 'B', 'C'],
 'E': ['F'],
 'F': ['G'],
 'G': ['H'],
 ...
 'W': ['X'],
 'X': ['Y'],
 'Y': ['Z']} 
```

使用您的算法调用`bfs(graph, 'A', 'Z')`会在最终到达 Z 之前不必要地循环通过“A”、“B”、“C”和“D”。而如果您跟踪访问过的节点，则只需添加“A”、“B”的邻居, 'C' 和 'D' 到队列中各一次。

```
def bfs(graph, start, end):
    # maintain a queue of paths
    queue = []

    # push the first path into the queue
    queue.append([start])

    # already visited nodes
    visited = set()

    while queue:
        # get the first path from the queue
        path = queue.pop(0)

        # get the last node from the path
        node = path[-1]

        # if node has already been visited
        if node in visited:
            continue

        # path found
        if node == end:
            return path
        # enumerate all adjacent nodes, construct a new path and push it into the queue
        else:
            for adjacent in graph.get(node, []):
                # add the path only if it's end node hasn't already been visited
                if adjacent not in visited
                    new_path = list(path)
                    new_path.append(adjacent)
                    queue.append(new_path)

            # add node to visited set
            visited.add(node) 
```

使用这个版本的算法和字母图，这是队列和访问集在整个算法的 while 循环顶部的样子：

```
queue = [ ['A'] ]
visited = {}

queue = [ ['A', 'B'], ['A', 'C'], ['A', 'D'], ['A', 'E'] ]
visited = {'A'}

queue = [ ['A', 'C'], ['A', 'D'], ['A', 'E'], ['A', 'B', 'C'],
          ['A', 'B', 'D'] ]
visited = {'A', 'B'}

queue = [ ['A', 'D'], ['A', 'E'], ['A', 'B', 'C'], ['A', 'B', 'D'],
          ['A', 'C', 'D'] ]
visited = {'A', 'B', 'C'}

queue = [ ['A', 'E'], ['A', 'B', 'C'], ['A', 'B', 'D'], ['A', 'C', 'D'] ]
visited = {'A', 'B', 'C', 'D'}

queue = [ ['A', 'B', 'C'], ['A', 'B', 'D'], ['A', 'C', 'D'], ['A', 'E', 'F'] ]
visited = {'A', 'B', 'C', 'D', 'E'}

queue = [ ['A', 'B', 'D'], ['A', 'C', 'D'], ['A', 'E', 'F'] ]
visited = {'A', 'B', 'C', 'D', 'E'}

queue = [ ['A', 'C', 'D'], ['A', 'E', 'F'] ]
visited = {'A', 'B', 'C', 'D', 'E'}

queue = [ ['A', 'E', 'F'] ]
visited = {'A', 'B', 'C', 'D', 'E'}

queue = [ ['A', 'E', 'F', 'G'] ]
visited = {'A', 'B', 'C', 'D', 'E', 'F'}

queue = [ ['A', 'E', 'F', 'G', 'H'] ]
visited = {'A', 'B', 'C', 'D', 'E', 'F', 'G'}

...
...

queue = [ ['A', 'E', 'F', 'G', 'H', ..., 'X', 'Y', 'Z'] ]
visited = {'A', 'B', 'C', 'D', 'E', 'F', 'G', ..., 'X', 'Y'}

# at this point the algorithm will pop off the path,
# see that it reaches the goal, and return 
```

这比添加路径要少得多`['A', 'B', 'A', 'B', 'A', 'B', ...]`。

# iphone - 减少 UIImage 的文件大小？

> ID：13663711
> 
> 赞同：1
> 
> 时间：2012-12-01T21:02:44.193
> 
> 标签：iphone, objective-c, ios, uiimage

我想保持 UIImage 相同的可见大小，但减小它的文件大小。有没有办法做到这一点？

例如，如果用户要保存用相机拍摄的 10 张图像，我希望它们具有更小的文件大小，同时保持原始图像的大部分质量和相同的宽度和高度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:06:13.603

以更高的压缩率另存为 jpeg（会降低质量）

```
NSData * UIImageJPEGRepresentation (
   UIImage *image,
   CGFloat compressionQuality
); 
```

# spring - 确定春季社交中的联系类型

> ID：13663717
> 
> 赞同：2
> 
> 时间：2012-12-01T21:03:37.593
> 
> 标签：spring, spring-social

有没有办法找出登录用户的当前连接类型？我想知道用户是否通过 Facebook、Twitter 或没有社交帐户登录。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T18:10:50.957

最近我还必须验证给定用户的连接类型。

在 Spring Social 中，您可以使用 getApi() 验证连接类型。假设已经创建了连接（可能通过 ConnectSupport#completeConnection），那么您只需要添加如下内容：

```
if (connection.getApi() instanceof Facebook) {
  System.out.println("Facebook connection");
} else if (connection.getApi() instanceof Twitter) {
  System.out.println("Twitter connection");
} 
```

# python - 在混合数据列表中求和

> ID：13663718
> 
> 赞同：1
> 
> 时间：2012-12-01T21:03:38.717
> 
> 标签：python, arrays, list, append

这是一个具体的问题，将帮助我完成即将发布的项目。这很简单，我对 Python 很陌生，我的背景主要是艺术。我喜欢它，但我也觉得它很有挑战性。

我有一个包含数字/名称列表的文本文件（Data.txt），如下所示（简短示例）：

```
String 1
34.6
45.6
45.9
String 2
34.6
45.6
45.9 
```

这是一个混合列表。在每个 String....12 个数字之后，依此类推。请注意，数字是“浮动的”。

我设计了这个：

```
numberList = []
data = []
data = open("SalesData.txt").read().split()
for i in data:
        numberList.append(i)
print numberList 
```

这将附加并打印外部 .txt 列表中的所有数据。如何在新列表（numberList）中获取所有数据，但不包括通过读取文件找到的所有“字符串”。这样，我可以只对数字进行总和 ---

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:12:42.487

首先，你不应该`.read().split()`在你的文件上做 - 这将在任何空白处分割，而不仅仅是在换行符上。幸运的是，Python 可以直接遍历文件。

然后，您可以尝试将每一行转换为浮点数，并且仅在可行时将其附加到列表中（否则跳过它）。此外，您可以立即将其转换为浮点数 - 使其更容易总结。

```
number_list = []
with open("SalesData.txt") as myfile:
    for line in myfile:
        try:
            number_list.append(float(line))
        except ValueError:
            pass
print(sum(number_list)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:15:27.320

如果您的数据是结构化的（似乎是这种情况），我会简单地使用一个计数器并删除 len 12 的每个序列的第一个元素。

这是一个例子：

```
numberList = []
data = []
counter = 0
with open("SalesData.txt") as myfile:
    for line in myfile:
        if counter > 0:
            number_list.append(float(line))
        counter = (counter + 1) % 12
print numberList 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T21:11:24.467

只需遍历行并仅将数字添加到列表中...

```
with open("somefile.txt") as f:
     my_list = []
     for line in f:
         try:
            my_list.append(float(line))
         except ValueError:
             pass

print sum(my_list) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T21:22:37.527

```
import re

ss =  '''String 1 
34.6 
45.6 
45.9 
String 2 
34.6 
45.6 
45.9 

'''

print re.findall('^(?!.*?[a-zA-Z])[0-9.+-]+',ss,re.MULTILINE) 
```

但是如果可以有没有 ASCII 的字母，它就行不通了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T21:10:29.947

尝试这个：

```
tsum = []
for j in numberList:
    try: tsum.append(float(j))
    except: pass
sum = sum(tsum) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-01T21:11:53.380

你可以做类型检查，或者如果数字实际上是字符串中的数字，你可以做一些类似`"13".isdigit()`检查的事情，但我可能想做一些更聪明的事情：

```
numberList = []

for i in range(0, len(data)/13):
    numberList.append(data[1*(i+1):13*(i+1)]) 
```

那个（或类似的东西）应该针对字符串后面的数字组。这确实取决于您的输入数据不是垃圾，但它在大型数据集上的工作速度应该比做`.isdigit()`或其他类型检查更快。

# c# - 避免在每个 setter 中调用 RaisePropertyChanged

> ID：13663719
> 
> 赞同：6
> 
> 时间：2012-12-01T21:03:40.777
> 
> 标签：c#, mvvm, inotifypropertychanged, proxy-classes

我想摆脱模型类上占用空间和重复的 RaisePropertyChanged-Properties。我想要我的模特课...

```
public class ProductWorkItem : NotificationObject
{
    private string name;
    public string Name
    {
        get { return name; }
        set { 
            if (value == name) return; 
            name = value; RaisePropertyChanged(() => Name); 
        }
    }
    private string description;
    public string Description
    {
        get { return description; }
        set { 
            if (value == description) return; 
            description = value; RaisePropertyChanged(() => Description); 
        }
    }
    private string brand;
    public string Brand
    {
        get { return brand; }
        set { 
            if (value == brand) return; 
            brand = value; RaisePropertyChanged(() => Brand); 
        }
    }
} 
```

...再次看起来像这样简单：（但在属性更改时通知视图）

```
public class ProductWorkItem
{
    public string Name{ get; set; }
    public string Description{ get; set; }
    public string Brand{ get; set; }
} 
```

这可以通过某种代理类来实现吗？

我想避免为每个模型类编写代理。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T23:06:58.503

**[我知道在“vanilla”C# 中没有简单且可维护的方法，但您可以通过aspect](http://en.wikipedia.org/wiki/Aspect-oriented_programming)**实现这一点。我为此使用了**[PostSharp](http://www.sharpcrafters.com/postsharp/features)**，它的缺点是作为付费的 3rd 方产品，但有一个免费版本，您也可以在其中执行此操作。PostSharp 利用目标指定、继承等**[属性的优势，并将它们扩展到方面。](http://msdn.microsoft.com/en-us/library/aa288059%28v=vs.71%29.aspx)**

然后，您可以定义一个`LocationInterceptionAspect`，它覆盖`OnSetValue`调用您的`RaisePropertyChanged`委托的方法。然后你可以使用用你的 aspect 属性装饰的自动生成的属性。

PostSharp 的付费版本允许您在类级别执行此操作，因此您只需要一个属性（或者不需要，如果您装饰您的基类并将该属性定义为可继承）。这在 PostSharp 网站上被**[描述](http://www.sharpcrafters.com/solutions/notifypropertychanged)**为一个用例`InstanceLevelAspect`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-02T10:56:01.607

我来到了**NotifyPropertyWeaver**扩展，从那时起就定期使用它。它是一个 Visual Studio 扩展，在编译代码之前，它为您实现了始终相同的 INPC 内容。你什么都没有注意到。

您需要安装扩展，然后您的模型需要如下所示：

```
public class ProductWorkItem : INotifyPropertyChanged
{
    public string Name{ get; set; }
    public string Description{ get; set; }
    public string Brand{ get; set; }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

扩展比为您添加所有其余部分。我喜欢这种方法的地方在于，您的类仍然“正式”实现 INPC 接口，并且您也可以在非 WPF 上下文中使用它（因为 INPC 根本不只是 WPF 的东西），但仍然没有用所有这些东西在你的课堂上乱扔垃圾。它为依赖于属性的只读属性引发通知。

当然，它有点假，因为它只是使写作自动化，根本没有改变基本概念的任何东西。但也许这是一种妥协...

这里有更多信息：[链接](http://visualstudiogallery.msdn.microsoft.com/bd351303-db8c-4771-9b22-5e51524fccd3)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-27T20:19:54.100

我们可以避免在 WPF 中的每个属性设置器上编写 RaisePropertyChanged 的​​重复代码。

使用 Postsharp 的免费版本。

通过使用以下代码，我们可以仅将虚拟属性绑定到视图。

```
namespace Test
{
[Serializable]
[AttributeUsage(AttributeTargets.Assembly | AttributeTargets.Module | AttributeTargets.Class | AttributeTargets.Property, AllowMultiple = true)]
public sealed class RaisePropertyChangedAttribute : MethodInterceptionAspect
{
    private string propertyName;

    /// <summary>
    /// Compiles the time validate.
    /// </summary>
    /// <param name="method">The method.</param>
    public override bool CompileTimeValidate(MethodBase method)
    {
        return IsPropertySetter(method) && !method.IsAbstract && IsVirtualProperty(method);
    }

    /// <summary>
    /// Method invoked at build time to initialize the instance fields of the current aspect. This method is invoked
    /// before any other build-time method.
    /// </summary>
    /// <param name="method">Method to which the current aspect is applied</param>
    /// <param name="aspectInfo">Reserved for future usage.</param>
    public override void CompileTimeInitialize(MethodBase method, AspectInfo aspectInfo)
    {
        base.CompileTimeInitialize(method, aspectInfo);
        propertyName = GetPropertyName(method);
    }

    /// <summary>
    /// Determines whether [is virtual property] [the specified method].
    /// </summary>
    /// <param name="method">The method.</param>
    /// <returns>
    ///   <c>true</c> if [is virtual property] [the specified method]; otherwise, <c>false</c>.
    /// </returns>
    private static bool IsVirtualProperty(MethodBase method)
    {
        if (method.IsVirtual)
        {
            return true;
        }

        var getMethodName = method.Name.Replace("set_", "get_");
        var getMethod = method.DeclaringType.GetMethod(getMethodName, BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic);

        return getMethod != null && getMethod.IsVirtual;
    }

    private static string GetPropertyName(MethodBase method)
    {
        return method.Name.Replace("set_", string.Empty);
    }

    /// <summary>
    /// Determines whether [is property setter] [the specified method].
    /// </summary>
    /// <param name="method">The method.</param>
    /// <returns>
    /// <c>true</c> if [is property setter] [the specified method]; otherwise, <c>false</c>.
    /// </returns>
    private static bool IsPropertySetter(MethodBase method)
    {
        return method.Name.StartsWith("set_", StringComparison.OrdinalIgnoreCase);
    }

    /// <summary>
    /// Method invoked <i>instead</i> of the method to which the aspect has been applied.
    /// </summary>
    /// <param name="args">Advice arguments.</param>
    public override void OnInvoke(MethodInterceptionArgs args)
    {
        var arg = args as MethodInterceptionArgsImpl;

        if ((arg != null) && (arg.TypedBinding == null))
        {
            return;
        }

        // Note ViewModelBase is base class for ViewModel
        var target = args.Instance as ViewModelBase;

        args.Proceed();

        if (target != null)
        {
            target.OnPropertyChanged(propertyName);                    
        }
    }
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-15T18:40:12.057

Coming from the other side (and if you don't have a fancy Extension) you can "autospecify" changed properties with the extension methods outlined in my answer here: [WCF service proxy not setting "FieldSpecified" property](https://stackoverflow.com/questions/1680356/wcf-service-proxy-not-setting-fieldspecified-property/21144944#21144944)

Specifically, you could use the 'non-reflection method' to configure specific "OnPropertyChanged" handling per class to do other things than just set a specified field.

```
public static class PropertySpecifiedExtensions2
{
    /// <summary>
    /// Bind the <see cref="INotifyPropertyChanged.PropertyChanged"/> handler to automatically call each class's <see cref="IAutoNotifyPropertyChanged.Autonotify"/> method on the property name.
    /// </summary>
    /// <param name="entity">the entity to bind the autospecify event to</param>
    public static void Autonotify(this IAutoNotifyPropertyChanged entity)
    {
        entity.PropertyChanged += (me, e) => ((IAutoNotifyPropertyChanged)me).WhenPropertyChanges(e.PropertyName);
    }

    /// <summary>
    /// Create a new entity and <see cref="Autonotify"/> it's properties when changed
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <returns></returns>
    public static T Create<T>() where T : IAutoNotifyPropertyChanged, new()
    {
        var ret = new T();
        ret.Autonotify();
        return ret;
    }
}

/// <summary>
/// Used by <see cref="PropertySpecifiedExtensions.Autonotify"/> to standardize implementation behavior
/// </summary>
public interface IAutoNotifyPropertyChanged : INotifyPropertyChanged
{
    void WhenPropertyChanges(string propertyName);
} 
```

And then each class themselves defines the behavior:

```
public partial class MyRandomClass: IAutoNotifyPropertyChanged
{

    /// <summary>
    /// Create a new empty instance and <see cref="PropertySpecifiedExtensions.Autospecify"/> its properties when changed
    /// </summary>
    /// <returns></returns>
    public static MyRandomClass Create()
    {
        return PropertySpecifiedExtensions2.Create<MyRandomClass>();
    }

    public void WhenPropertyChanges(string propertyName)
    {
        switch (propertyName)
        {
            case "field1": this.field1Specified = true; return;
            // etc
        }

        // etc
        if(propertyName.StartsWith(...)) { /* do other stuff */ }
    }
} 
```

The downside to this is, of course, magic strings for property names making refactoring difficult, which you could get around with `Expression` parsing?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-02T02:42:51.397

我在命名空间中找到[了这个类](http://msdn.microsoft.com/en-us/library/system.dynamic.dynamicobject.aspx)`System.Dynamic`......它可以让您拦截绑定目标上的实际`DataBinding`调用，以及绑定源上的。`DependencyObject``Property`

[http://i.msdn.microsoft.com/en-us/library/system.windows.data.binding.DataBindingMostBasic(v=vs.110).png?appId=Dev11IDEF1&l=EN-US&k=k(System.Windows .Data.Binding)%3bk(VS.XamlEditor)%3bk(TargetFrameworkMoniker-.NETFramework](http://i.msdn.microsoft.com/en-us/library/system.windows.data.binding.DataBindingMostBasic(v=vs.110).png?appId=Dev11IDEF1&l=EN-US&k=k(System.Windows.Data.Binding)%3bk(VS.XamlEditor)%3bk(TargetFrameworkMoniker-.NETFramework)

所以现在可以做的是实现一个类（让我们称之为`DynamicNpcProxy`），它实现`INotifyPropertyChanged`、派生`DynamicObject`并覆盖了`TryGetMember`和`TrySetMember`方法。

```
public class DynamicNpcProxy : DynamicObject, INotifyPropertyChanged
{
    public DynamicNpcProxy(object proxiedObject)
    {
        ProxiedObject = proxiedObject;
    }

    //...

    public object ProxiedObject { get; set; }

    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        SetMember(binder.Name, value);
        return true;
    }

    protected virtual void SetMember(string propertyName, object value)
    {
        GetPropertyInfo(propertyName).SetValue(ProxiedObject, value, null);
        if (PropertyChanged != null) 
            PropertyChanged(ProxiedObject, new PropertyChangedEventArgs(propertyName));
    }

    protected PropertyInfo GetPropertyInfo(string propertyName)
    {
        return ProxiedObject.GetType().GetProperty(propertyName);
    }

    // override bool TryGetMember(...)
} 
```

为了让它工作，将代理包裹在你当前的绑定源周围，替换它们，然后让`DynamicObject`剩下的事情去做。

在 ViewModel.cs 中：

```
IList<ProductWorkItem> items;
//... assign items
var proxies = items.Select(p => new DynamicNpcProxy(p)).ToList();
ICollectionView Products = CollectionViewSource.GetDefaultView(proxies); 
```

在 View.xaml 中：

```
<TextBox Text="{Binding Products.CurrentItem.Name}" /> 
<TextBox Text="{Binding Products.CurrentItem.Description}" /> 
```

你最终得到的是：

![](../Images/df2a809f054fe6bd1390f37c0e5281b1.png)

另请查看[这篇文章](http://www.codeproject.com/Articles/100710/Using-DynamicObject-to-Implement-General-Proxy-Cla)，`code project`其中提供了更多信息......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-31T14:00:24.140

这已经是老东西了，只是没有人提到：

[https://marketplace.visualstudio.com/items?itemName=AlexeyLavnikov.KindOfMagic](https://marketplace.visualstudio.com/items?itemName=AlexeyLavnikov.KindOfMagic)

您可以使用类上的 1 个属性为 ViewModel 中的每个属性打开自动通知。

# python - 限制使用 numpy.genfromtxt 为 matplotlib 读取多少数据

> ID：13663721
> 
> 赞同：12
> 
> 时间：2012-12-01T21:04:15.910
> 
> 标签：python, numpy, matplotlib

我正在使用源数据的文本文件和 matplotlib 在 python 中创建一个图形来绘制图形。下面的简单逻辑效果很好。

但是有没有办法让 numpy.gentfromtxt 只读取文件“temperature_logging”的前 50 行？目前它读取整个文件。

```
temp = numpy.genfromtxt('temperature_logging',dtype=None,usecols=(0))
time = numpy.genfromtxt('temperature_logging',dtype=None,usecols=(1))

dates = matplotlib.dates.datestr2num(time)

pylab.plot_date(dates,temp,xdate=True,fmt='b-')

pylab.savefig('gp.png') 
```

temperature_logging 中的内容；

```
21.75 12-01-2012-15:53:35    
21.75 12-01-2012-15:54:35    
21.75 12-01-2012-15:55:35    
.
.
. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-01T21:17:52.683

`numpy.genfromtxt`接受迭代器和文件。这意味着它将接受`itertools.islice`. 这`test.txt`是一个五行文件：

```
>>> import itertools, numpy
>>> with open('test.txt') as t_in:
...     numpy.genfromtxt(itertools.islice(t_in, 3))
... 
array([[  1.,   2.,   3.,   4.,   5.],
       [  6.,   7.,   8.,   9.,  10.],
       [ 11.,  12.,  13.,  14.,  15.]]) 
```

有人可能认为这会比让`numpy`处理文件 IO 慢，但快速测试表明并非如此。`genfromtxt`提供了一个`skip_footer`关键字参数，如果您知道文件的长度，您可以使用该参数...

```
>>> numpy.genfromtxt('test.txt', skip_footer=2)
array([[  1.,   2.,   3.,   4.,   5.],
       [  6.,   7.,   8.,   9.,  10.],
       [ 11.,  12.,  13.,  14.,  15.]]) 
```

...但是对 1000 行文件的一些非正式测试表明，`islice`即使您只跳过几行，使用也会更快：

```
>>> def get(nlines, islice=itertools.islice):
...     with open('test.txt') as t_in:
...         numpy.genfromtxt(islice(t_in, nlines))
...         
>>> %timeit get(3)
1000 loops, best of 3: 338 us per loop
>>> %timeit numpy.genfromtxt('test.txt', skip_footer=997)
100 loops, best of 3: 4.92 ms per loop
>>> %timeit get(300)
100 loops, best of 3: 5.04 ms per loop
>>> %timeit numpy.genfromtxt('test.txt', skip_footer=700)
100 loops, best of 3: 8.48 ms per loop
>>> %timeit get(999)
100 loops, best of 3: 16.2 ms per loop
>>> %timeit numpy.genfromtxt('test.txt', skip_footer=1)
100 loops, best of 3: 16.7 ms per loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:46:24.100

不知道 numpy，但一种可能的解决方案是使用[stringio](http://docs.python.org/2/library/stringio.html)类。

这使您可以将实际需要的数据加载到具有普通文件 IO 的字符串中（还有一个字节版本），从字符串创建一个类似文件的对象并将其传递给 numpy.

# c++ - libcudart 和本地构建的 gcc 链接针对错误的 glibc

> ID：13663722
> 
> 赞同：0
> 
> 时间：2012-12-01T21:04:28.237
> 
> 标签：c++, gcc, linker, cuda, glibc

我试图让 CUDA5 在共享集群上工作。

当我调用本地 gcc 来构建大型应用程序时，它工作得很好。当我使用 CUDA 包装器时，我收到一条错误消息，指出它找不到 glib 的某些部分。

`/lib64/libc.so.6`如果我指定了本地 gcc 库目录，为什么 CUDA 会查看？

```
[uid002@n001 cuda5test]$ ldd /home/ex/uid002/cuda/lib64/libcudart.so
/home/ex/uid002/cuda/lib64/libcudart.so: /lib64/libc.so.6: version `GLIBC_2.14' not found (required by /home/ex/uid002/cuda/lib64/libcudart.so)
    linux-vdso.so.1 =>  (0x00007fff277ff000)
    libdl.so.2 => /lib64/libdl.so.2 (0x00007f5328da6000)
    libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f5328b89000)
    librt.so.1 => /lib64/librt.so.1 (0x00007f5328981000)
    libstdc++.so.6 => /home/ex/uid002/gcc/lib64/libstdc++.so.6 (0x00007f532867d000)
    libm.so.6 => /lib64/libm.so.6 (0x00007f53283f8000)
    libgcc_s.so.1 => /home/ex/uid002/gcc/lib64/libgcc_s.so.1 (0x00007f53281e3000)
    libc.so.6 => /lib64/libc.so.6 (0x00007f5327e67000)
    /lib64/ld-linux-x86-64.so.2 (0x000000335ae00000) 
```

和

```
[uid002@n001 cuda5test]$ echo $LD_LIBRARY_PATH
/home/ex/uid002/cuda/lib64:/home/ex/uid002/gmp/lib:/home/ex/uid002/mpfr/lib:/home/ex/uid002/mpc/lib:/home/ex/uid002/gcc/lib64 
```

我试图重新安装 CUDA 包，这没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T03:56:21.550

> libcudart.so：/lib64/libc.so.6：未找到版本“GLIBC_2.14”

此错误意味着该`libcudart.so`库已链接到具有`glibc-2.14`或更高版本的系统上。如果您的系统（在链接时和运行时）的版本 >= 2.14 ，则*只能使用该库。*`glibc`您的系统不满足`libcudart.so`. 您必须使用旧版本的`libcudart.so`，或升级您的系统。

（注意：`glibc`错误升级是导致系统无法启动的*可靠方法。）*

> 如果我指定了本地 gcc 库目录，为什么 CUDA 会查看 /lib64/libc.so.6？

`Glibc`不是`GCC`分布的一部分，并且是完全独立的。“本地 gcc 库目录”不太可能`libc.so`在其中。

# java - 播放 Framework 2.0 和 EBean，包装 INFORMATION_SCHEMA

> ID：13663726
> 
> 赞同：2
> 
> 时间：2012-12-01T21:04:57.580
> 
> 标签：java, playframework-2.0, ebean

使用播放！框架 2.0.4 和 EBean 作为持久层 我试图将数据库“元”信息包装到 Java 类中。

我在 application.conf 中映射类：

```
db.myData.url="jdbc:sqlserver://localhost:2301;databaseName=myData;"
ebean.myData="models.database.JavaTable" 
```

然后我创建了一个类，如下所示：

```
package models.database;
import javax.persistence.Column;
import javax.persistence.Entity;

import javax.persistence.Table;

import play.db.ebean.Model;
@Entity
@Table(name="tables",schema="INFORMATION_SCHEMA",catalog="myData")
public class JavaTable extends Model{

@Column(name="TABLE_NAME")
public String table_name;

public static Finder<String, JavaTable> find = new Finder<String, JavaTable>(
    String.class, JavaTable.class
);
} 
```

当我启动 Play! 时，它告诉我需要在数据库上运行演变以创建表“myData.INFORMATION_SCHEMA.tables”。然后我尝试通过单元测试来测试连接......

```
@Test
public void testGetTables(){
     running(fakeApplication(), new Runnable() {
            @Override
            public void run() {
                EbeanServer server = Ebean.getServer("myData");

                List<SqlRow> rows = server.createSqlQuery("select * from myData.Information_Schema.Tables").findList();
               for(SqlRow row: rows)
                System.out.println("====>Row: " + row.toString());

            }
        });
} 
```

单元测试执行正确，表名打印成功。

**编辑：**根据@nico_ekito，我删除了配置文件中的进化插件并开始获取：

```
RuntimeException DataSource user is null 
```

因此，经过一番研究，我决定禁用配置文件中的其他数据源，并将我尝试与之通信的数据库移动到“db.default”和“ebean.default”，模型开始工作。如果 Play 定义了多个数据库，有没有办法告诉模型应该使用*哪个数据源？*通过“ebean.default="myData.JavaTable" 设置类似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T13:16:48.610

您应该尝试通过在 application.conf 文件中添加以下内容来禁用进化：

```
evolutionplugin=disabled 
```

测试没问题，因为你没有启动一个真正的应用程序，而是使用了一个`fakeApplication()`不使用进化插件的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T22:07:44.130

有趣的是，我只成功地使用包级别值定义了我的 eBean 服务器（因此，“myData.*”而不是“myData.JavaTable”）。要实现这一点，您可能必须将特定 eBean 服务器的所有类移动到它们自己的包中。

# c# - 如何正确组织多对象 JSON 的 C# 应用程序设计？

> ID：13663729
> 
> 赞同：0
> 
> 时间：2012-12-01T21:05:17.507
> 
> 标签：c#, .net, json

我的 C# 应用程序存在架构问题。我需要有以下 JSON：

```
{data:{lat:22,lng:33}, error:{code:0,description:""}} 
```

我正在尝试使用这些类来实现这个 JSON 结构：

```
public class Response
{
    public object Data { get; set; }
    public object Error { get; set; }

    public Response()
    {
        Error = new ErrorsManager();
    }
}

public class Coordinates : Response
{
    public double Lat { get; set; }
    public double Lng { get; set; }
} 
```

我可以毫无问题地设置***Error的值。***但是如何为***数据***设置值我不明白。任何人都可以为这种情况提出适当的解决方案吗？我知道这个问题可以通过Java 中的**扩展来解决。**我可以在 C# 中使用类似的东西吗？

**更新：**我想在 JSON 中有共同的根对象 - 数据和错误。但是数据对象可以有不同的上下文，比如：坐标、用户数据等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:11:41.557

您可以将 Data 设置为坐标实例。那是这样的：

```
public class Response
{
    public object Data { get; set; }
    public object Error { get; set; }

    public Response()
    {
        Error = new ErrorsManager();
        Data = new Coordinates();
    }
}

public class Coordinates {
    public double Lat { get; set; }
    public double Lng { get; set; }
} 
```

您可能会考虑创建 Response 的强类型版本，含义如下：

```
public class Response
{
    public Coordinates Data { get; set; }
    public ErrorsManager Error { get; set; }

    public Response()
    {
        Error = new ErrorsManager();
        Data = new Coordinates();
    }
} 
```

如果您有不同的响应类型，您可能希望有一个仅定义 Error 的基类和添加新属性的子类。我假设您正在使用[JSON.NET 之](http://james.newtonking.com/projects/json-net.aspx)类的东西来序列化/反序列化。

你可以是通用的：

```
public class Response<T> where T : new() {
    public T Data { get; set; }
    public ErrorsManager Error { get; set; }

    public Response() {
        Error = new ErrorsManager();
        Data = new T();
    }
}

public class Coordinates {
    /* left away */
} 
```

用法：

```
var response = new Response<Coordinates>();
response.Data.Lat = 0.01;
// whatever you like 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:10:24.053

C＃：

```
String JSON = (new JavaScriptSerializer()).Serialize(
    new { data = new { lat = 22; lng = 33; }; error = new {code = 0; description=String.Empty;}; }
); 
```

或者：

```
using System.Web.Script.Serialization;

    public class myResponse
    {
        public Coordinates data;
        public Error error;

        public myResponse()
        {
            data = new Coordinates();
            error = new Error();
        }
    }

    public class Coordinates
    {
        public double lat;
        public double lng;
    }

    public class Error
    {
        public int code;
        public String description;
    }

    var resp = new myResponse();
    resp.data.lat = 0.3453453453;
    resp.data.lng = 0.3453453453;
    resp.error.code = 0;
    resp.error.description = "Description of error";

    String JSON = (new JavaScriptSerializer()).Serialize(resp); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T21:14:53.450

创建类型安全的类而不是将它们声明为对象

```
public class Response
{
    public Coordinates Data { get; set; }
    public Error Error { get; set; }
}

public class Error
{
    public int code { get; set; }
    public string description { get; set; }
}

public class Coordinates 
{
    public double Lat { get; set; }
    public double Lng { get; set; }
} 
```

您可以将 json 字符串反序列化为

```
string jsonStr = @"{data:{lat:22,lng:33}, error:{code:0,description:""aaa""}}";

var jObj = JsonConvert.DeserializeObject<Response>(jsonStr); //Json.Net 
```

或者

```
var jObj2 = new JavaScriptSerializer().Deserialize<Response>(jsonStr); 
```

* * *

您还可以使用[Json.Net以完全](http://json.codeplex.com/)**动态**的方式进行，而无需声明任何这些类

```
dynamic dynObj = JsonConvert.DeserializeObject(jsonStr); 
Console.WriteLine(dynObj.data.lat);
Console.WriteLine(dynObj.error.description); 
```

# haskell - Haskell - 同时打印和返回状态

> ID：13663730
> 
> 赞同：-1
> 
> 时间：2012-12-01T21:05:48.627
> 
> 标签：haskell, compiler-errors, syntax-error

我正在用 Haskell 写一个 Brainf*ck 解释器。

我正在尝试打印`(chr (fromEnum $ getMem state))`这只是 Word8 到 Char 的转换。然后我想在特定情况下打印后返回一个新状态，即

```
 '.' -> do hPutChar stdout (chr (fromEnum $ getMem state))
            hFlush stdout
            return state { prog_pointer = prog_pointer state} 
```

我收到此错误消息

```
The function `hPutChar' is applied to six arguments,
but its type `Handle -> Char -> IO ()' has only two

In a stmt of a 'do' block:
  hPutChar
    stdout
    (chr (fromEnum $ getMem state))
    hFlush
    stdout
    return
    (state {prog_pointer = prog_pointer state}) 
```

使用此代码

```
iterateBF :: BFState -> IO BFState
iterateBF state = case (program state !! prog_pointer state) of
    --some more cases here--
    '.' -> do hPutChar stdout (chr (fromEnum $ getMem state))
            hFlush stdout
            return state { prog_pointer = prog_pointer state} 
```

我似乎无法弄清楚为什么我会收到此错误。

在 leftaroundabout 和 sabauma 发表评论后，我将代码编辑为

```
iterateBF :: BFState -> IO BFState
iterateBF state = case (program state !! prog_pointer state) of
    --some more cases here--
    '.' -> do hPutChar stdout (chr (fromEnum $ getMem state))
           hFlush stdout
           return state { prog_pointer = prog_pointer state} 
```

这次只使用空格。

但是，我得到`parse error on input 'hFlush'`

有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:36:06.750

基于leftaroundabout的评论，你想要

```
'.' -> do hPutChar stdout (chr (fromEnum $ getMem state))
          hFlush stdout
          return state { prog_pointer = prog_pointer state} 
```

注意 后面的所有行是如何`do`相互对齐的，而不是与`do`.

# database - Linq-to-SQL SubmitChanges 不更新物理数据库

> ID：13663735
> 
> 赞同：1
> 
> 时间：2012-12-01T21:06:31.047
> 
> 标签：database, vb.net, linq-to-sql, submitchanges

我是新来的，只注册了，因为我迫切需要解决我的问题。`.MDF`我有一个 VB.NET 项目，该项目正在使用我已导入项目的本地文件。主键完好无损，所以我知道这不是我的问题。

我正在使用 Linq-to-SQL 查询数据库并进行更改。在我的主窗体上，我使用由查询填充的数据网格视图。我在插入时遇到问题，其中查询工作正常并且 DGV 使用新创建的数据进行更新，但是当我调用时`SubmitChanges()`，更改不会保存到实际的物理数据库中。我不确定我错过了什么或做错了什么。

这是我的代码，可以更好地帮助您获得有根据的答案。

```
Public Class frmCell_Leader
    'Reference DataContext
    Private db As New MarquardtClassesDataContext()

    Private Sub frmCell_Leader_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

        FillProductionGrid()
        PrepareInsertFields()
    End Sub

    Private Sub FillProductionGrid()
        ''''''''''''''''''''''''''''''''''
        'E.Salce Last Modified 11.29.2012
        'Comments: Working
        ''''''''''''''''''''''''''''''''''

        'Populate DGV
        Dim query = From marq In db.tblProductivities
                 Select
     marq.PartNum, marq.Produced, marq.Packed, marq.Issue, marq.StationNum, _
     marq.PlanDownTime, marq.UnplannedDownTime, marq.CurDate

        dgvProduction.DataSource = query
    End Sub
    Private Sub PrepareInsertFields()
        ''''''''''''''''''''''''''''''''''
        'E.Salce Last Modified 11.29.2012
        'Comments: Working
        ''''''''''''''''''''''''''''''''''

        'Fill Planned Downtime Combo Box
        Dim PlannedQuery = From planned In db.tblPlannedDownTimes
                           Select planned.Plan_ID, planned.Description, planned.Active
                           Where Active = True

        cboPlanned.DataSource = PlannedQuery
        cboPlanned.DisplayMember = "Description"
        cboPlanned.ValueMember = "Plan_ID"

        'Fill UnPlanned Downtime Combo Box
        Dim UnPlannedQuery = From unplanned In db.tblUnplannedDownTimes
                           Select unplanned.Unplan_ID, unplanned.Description, unplanned.Active
                           Where Active = True

        cboUnplanned.DataSource = UnPlannedQuery
        cboUnplanned.DisplayMember = "Description"
        cboUnplanned.ValueMember = "UnPlan_ID"
    End Sub

    Private Sub btnAdd_Click(sender As System.Object, e As System.EventArgs) Handles btnAdd.Click
        'Add the new Production to database
        'Create an productivity object
        Dim marqpro As New tblProductivity With {
            .PartNum = CShort(txtPartNumber.Text),
            .Produced = CShort(txtProduced.Text),
            .Packed = CShort(txtPacked.Text),
            .Issue = txtIssue.Text,
            .PlanDownTime = CShort(cboPlanned.SelectedValue),
            .UnplannedDownTime = CShort(cboUnplanned.SelectedValue),
            .CurDate = Date.Today}

        'insert newly created data
        Try
            'Submit changes too database
             db.tblProductivities.InsertOnSubmit(marqpro)

            db.SubmitChanges()
            db.Refresh(Data.Linq.RefreshMode.KeepCurrentValues, marqpro)

            'Refresh DGV
            FillProductionGrid()
            MessageBox.Show("Data added successfully")

        Catch ex As Exception
            MessageBox.Show("Error: " & ex.Message)
        End Try
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T19:38:08.187

也许您的项目中有一个 .mdf 文件，每次构建时都会将其复制到 bin/debug 文件夹中。

[为什么我的 SubmitChanges() 不能在 LINQ-to-SQL 中工作？](https://stackoverflow.com/q/586291/532498)

# javascript - 是否可以使用 jquery 全屏制作 swf 对象？

> ID：13663741
> 
> 赞同：0
> 
> 时间：2012-12-01T21:07:00.000
> 
> 标签：javascript, jquery, flash, fullscreen

> **可能重复：**
> [Flash 将视图变为全屏](https://stackoverflow.com/questions/5706317/flash-to-take-the-view-to-fullscreen)

那么当使用 jquery 按下按钮时是否可以全屏制作 Flash 游戏？如果无法做到这一点，如果我不想使用 html5 全屏，还有哪些选择？

更新：全屏浏览器可以，不必全屏

# mysql - 如何在所有准备好具有多个连接的数据库上执行之间的查询？

> ID：13663743
> 
> 赞同：0
> 
> 时间：2012-12-01T21:07:09.280
> 
> 标签：mysql, wordpress, join

我正在尝试编写一个查询来检查保存时自定义帖子类型（属性）中的自定义元值是否等于另一个自定义帖子类型中的元值（警报）

我可以为正常匹配字段完成这项工作，但是我试图让它在一个范围内工作，例如，如果“属性”中的“卧室”介于“警报”中的“a_bedrooms_min”和“a_bedrooms_max”之间。到目前为止，我的查询看起来像这样：

```
//Property Meta Fields
$meta_type = 'flat';
$meta_bedrooms = '2';

//Alert Meta Fields
a_bedrooms_min = 1
a_bedrooms_max = 3

SELECT ID
    FROM wp_posts
    INNER JOIN wp_postmeta m1
        ON ( wp_posts.ID = m1.post_id )    
    INNER JOIN wp_postmeta m2
        ON ( wp_posts.ID = m2.post_id )
    INNER JOIN wp_postmeta m3
        ON ( wp_posts.ID = m3.post_id )
WHERE
     wp_posts.post_type = 'alerts'
     AND wp_posts.post_status = 'publish'
     AND ( m1.meta_key = 'a_property_type' AND m1.meta_value = '$meta_type' )
     AND ( m2.meta_key = 'a_bedrooms_min' AND m2.meta_value >= '$meta_bedrooms' )
     AND ( m3.meta_key = 'a_bedrooms_max' AND m3.meta_value <= '$meta_bedrooms' )
GROUP BY wp_posts.ID
ORDER BY wp_posts.post_date
DESC; 
```

最后两个 AND 显然不适用于我正在尝试做的事情，但如何才能让它发挥作用？

谢谢罗伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:28:09.600

我认为你很接近。您有一个混合的旧 ANSI 与更明确的 JOIN。正如您在此示例中所见，3 个条件中的每一个都明确地连接到所有 3 个部分的元表。因此，ID 应该每个 ID 只出现一次，因为每个元应该最多返回一个记录，并且该记录只有在所有 3 个元都找到相应的匹配项时才符合条件。

```
SELECT 
      ID
   FROM 
      wp_posts

         INNER JOIN wp_postmeta m1
            ON wp_posts.ID = m1.post_id
           AND m1.meta_key = 'a_property_type'
           AND m1.meta_value = '$meta_type'

         INNER JOIN wp_postmeta m2
           on wp_posts.ID = m2.post_id
          AND m2.meta_key = 'a_bedrooms_min' 
          AND m2.meta_value <= '$meta_bedrooms'

         INNER JOIN wp_postmeta m3
           on wp_posts.ID = m3.post_id
          AND m3.meta_key = 'a_bedrooms_max' 
          AND m3.meta_value >= '$meta_bedrooms'

   WHERE
          wp_posts.post_type = 'alerts'
      AND wp_posts.post_status = 'publish'

   GROUP BY 
      wp_posts.ID

   ORDER BY 
      wp_posts.post_date DESC; 
```

我已经修改了，因为我相信 <= 和 >= 实际上是倒退的。例如，您在 meta_value 中的 MINIMUM 卧室是 1，而 max 是 3...您正在寻找 2 来获得资格。

因此，您需要 MIN_BEDROOMS <= 2 和 2 <= MAX_BEDROOMS 最初呈现的是 MIN_BEDROOMS >= 2（1 永远不会大于 2）和 MAX_BEDROOMS <= 2（2 永远不会小于 2）。

再试一次。

# java - 如何使用过滤器匹配包含字符串的字符串 - Google App Engine

> ID：13663746
> 
> 赞同：1
> 
> 时间：2012-12-01T21:08:13.400
> 
> 标签：java, google-app-engine

在 Google App Engine 中，如何匹配包含字符串的字符串？我的数据存储包含“tester”，如果我传入“est”，则应该返回 tester。

```
Filter myFilter =  new FilterPredicate("name",FilterOperator.IN, "est"); 
```

但我收到此错误：`A collection of values is required`

我认为我没有正确使用过滤器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T00:20:59.560

您不能按照您描述的方式使用 IN 过滤器。如果您给出一个字符串列表，并且想要匹配给定列表中的一个字符串，则 IN 可以工作。

搜索 API 存在于您尝试执行的操作： [https ://developers.google.com/appengine/docs/python/search/overview](https://developers.google.com/appengine/docs/python/search/overview)

可以使用大于/小于搜索来查找以子字符串开头的字符串，但如果要在字符串中的任何位置查找子字符串，则需要使用 Search API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T00:47:15.087

A possible solution to this, even though app engine does not support wildcards is to insert every possible sequential combination to the datastore.

So if wanted to do a wildcard search on 'design'

Add the following entries :

```
'd'
'de'
'des'
'desi'
'desig'
'design'
'e'
'es'
'esi'
'esig'
'esign'
's'
'si'
'sig'
'sign'
'i'
'ig'
'ign'
'g'
'gn'
'n' 
```

These are all possible combinations for a wildcard search on 'design'. Although this is very wasteful of data storage memory.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-07T13:22:50.240

由于字符串可以与 >= 和 <= 进行比较，因此您可以存储组合：
design
esign
sign
ign
gn
n

要搜索所有带有“sign”的名称，您可以查询：

名称 >= 'sign' AND 名称 <= 'sign\uffffd'

实际上，您可以将组合截断限制为 4 个字符；很少有人可能需要完整的结果集来搜索所有包含“n”的名称。

# mysql - 在 MySQL SELECT 中使用 IF/ELSE

> ID：13663747
> 
> 赞同：2
> 
> 时间：2012-12-01T21:08:15.693
> 
> 标签：mysql, if-statement

我有一张桌子`members`和一张桌子`venues`。我目前有这个选择语句：

```
SELECT VenueName, VenueID 
FROM Venue 
WHERE active='Y' 
ORDER BY VenueName 
```

此语句的结果用于使用场地名称填充下拉列表，这很有效。我将其称为“原始选择”。

我想更改它，以便下拉列表仅显示链接到该成员的场地名称：

```
SELECT Venue.VenueName, Venue.VenueID, members.id, members.venueid 
FROM Venue, members 
WHERE Venue.VenueID = members.venueid 
AND members.id='$userid' 
```

这也有效。我将其称为“新选择”。

我有两个超级管理员，他们`members.venueid`的`all`不是场地 ID 号，所以我想创建一个运行 NEW SELECT 的语句，如果`members.id='all'`然后运行 ​​ORIGINAL SELECT。

谁能指出我正确的方向？我尝试过各种各样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T12:53:06.283

感谢@Chris，您为我指明了正确的方向，下面是我工作的最终版本：

```
SELECT DISTINCT Venue.VenueName, Venue.VenueID
FROM Venue, members
WHERE (
'$userid' =  'all'
AND active =  'Y'
)
OR (
Venue.VenueID = members.venueid
AND members.id =  '$userid'
)
ORDER BY VenueName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:41:44.090

您可以尝试类似以下的操作：

```
SELECT Venue.VenueName, Venue.VenueID
FROM Venue, members 
WHERE 
(
  Venue.VenueID = members.venueid
  AND $userid <> 'all' 
  AND members.id = 'all'
)
OR
(
  Venue.VenueID = members.id
  AND $userid = 'all'
  AND members.id = 'all'
) 
```

# c - OpenMP - for循环线程分配

> ID：13663750
> 
> 赞同：0
> 
> 时间：2012-12-01T21:08:27.080
> 
> 标签：c, openmp

假设我有一个索引为 0..n-1 的数组。有没有办法选择每个线程将处理哪些单元格？例如，线程 0 将处理单元格 0 和 5，线程 1 将处理单元格 1 和 6，依此类推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:16:02.327

你看过并行的时间表子句吗？

```
#pragma omp for schedule(static, 1) 
```

应该实现你想要的，你可以使用下面的简单代码来试验 schedule 子句：

```
#include<stdio.h>
#include<omp.h>

int main(){

  int i,th_id;

  #pragma omp parallel for schedule(static,1)
  for ( i = 0 ; i < 10 ; ++i){
    th_id = omp_get_thread_num();
    printf("Thread %d is on %d\n",th_id,i);
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T11:54:27.467

你甚至可以更明确：

```
#pragma omp parallel
{
   int nth = omp_get_num_threads();
   int ith = omp_get_thread_num();
   for (int i=ith; i<n; i+=nth)
   {
      // handle cell i.
   }
} 
```

这应该完全符合您的要求：线程 ith 处理单元格 ith、ith+nth、ith+2*nth、ith+3*nth 等等。

# python - Python/Django 上的 Sqlite 问题

> ID：13663752
> 
> 赞同：2
> 
> 时间：2012-12-01T21:08:47.223
> 
> 标签：python, django, sqlite

我正在尝试学习 Django 并遵循 Django Book 教程，当我在 Python shell 中键入这些行时出现错误：

```
>>> from django.db import connection
>>> cursor = connection.cursor() 
```

这是我得到的回溯：

```
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "C:\Python27\lib\site-packages\django\db\backends\__init__.py", line 306,
 in cursor
    cursor = self.make_debug_cursor(self._cursor())
  File "C:\Python27\lib\site-packages\django\db\backends\sqlite3\base.py", line
288, in _cursor
    self._sqlite_create_connection()
  File "C:\Python27\lib\site-packages\django\db\backends\sqlite3\base.py", line
278, in _sqlite_create_connection
    self.connection = Database.connect(**kwargs)
OperationalError: unable to open database file 
```

关于如何解决这个问题的任何想法？在我的 settings.py 上，我`DATABASES ENGINE`设置为：`django.db.backends.sqlite3`并`NAME`设置为：`C:\Python27/PythonProjects/mysite`。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:22:57.137

我发现（在现代 Django 中）只给出一个像文件名一样`database.sqlite`的文件名作为名称是最好的选择。Django 应该通过将新数据库粘贴在项目的根文件夹中来解释这一点，这非常适合我的需要。

# gwt - 将堆栈跟踪转换为字符串？

> ID：13663753
> 
> 赞同：15
> 
> 时间：2012-12-01T21:08:58.087
> 
> 标签：gwt

是否可以将堆栈跟踪打印到 GWT 中的字符串？我认为在 java.io 中使用类的常用方法不起作用，因为 java.io 包在客户端不可用（并且 Writer、PrintWriter 等在该包中）

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-03T04:32:05.253

我不确定 StackTraceElement 是否被模拟，但如果是，你可以运行类似的东西

```
for (StackTraceElement element : exception.getStackTrace()) {
    string += element + "\n";
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-03T12:41:32.027

这是我用来`String`在 GWT 中检索完整堆栈跟踪的方法：

```
private static String getMessage (Throwable throwable) {
    String ret="";
    while (throwable!=null) {
            if (throwable instanceof com.google.gwt.event.shared.UmbrellaException){
                    for (Throwable thr2 :((com.google.gwt.event.shared.UmbrellaException)throwable).getCauses()){
                            if (ret != "")
                                    ret += "\nCaused by: ";
                            ret += thr2.toString();
                            ret += "\n  at "+getMessage(thr2);
                    }
            } else if (throwable instanceof com.google.web.bindery.event.shared.UmbrellaException){
                    for (Throwable thr2 :((com.google.web.bindery.event.shared.UmbrellaException)throwable).getCauses()){
                            if (ret != "")
                                    ret += "\nCaused by: ";
                            ret += thr2.toString();
                            ret += "\n  at "+getMessage(thr2);
                    }
            } else {
                    if (ret != "")
                            ret += "\nCaused by: ";
                    ret += throwable.toString();
                    for (StackTraceElement sTE : throwable.getStackTrace())
                            ret += "\n  at "+sTE;
            }
            throwable = throwable.getCause();
    }

    return ret;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-03T14:10:24.850

我不建议尝试在 GUI 标签中显示错误堆栈跟踪。

1) 在 GWT 混淆后它们不可读。它们看起来就像新行上的一堆制表符对齐的字符。

2) 它们不是 I18N 格式。

3）正确的方法是只向用户显示格式正确的错误“消息”。exception.getMessage() 将为您提供一行非 obf 信息，该信息应为用户提供必要的 UX 交互。

4）如果您正在寻找**`well formed`**有助于调试的异常堆栈跟踪（而不是用户），您应该使用 GWT 的有据可查的日志记录功能和 Web 模式异常 -

a) [https://developers.google.com/web-toolkit/doc/latest/DevGuideLogging](https://developers.google.com/web-toolkit/doc/latest/DevGuideLogging)

b) 另请阅读[http://code.google.com/p/google-web-toolkit/wiki/WebModeExceptions](http://code.google.com/p/google-web-toolkit/wiki/WebModeExceptions)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-06T11:07:23.100

使用[com.google.gwt.logging.impl.StackTracePrintStream](https://docs.sencha.com/gxt/4.x/javadoc/gwt-2.8.2/com/google/gwt/logging/impl/StackTracePrintStream.html)

```
Throwable t = ...;
StringBuilder message = new StringBuilder();
StackTracePrintStream ps = new StackTracePrintStream(message);
t.printStackTrace(ps);
ps.flush(); 
```

# javascript - 过渡不适用于元素

> ID：13663754
> 
> 赞同：0
> 
> 时间：2012-12-01T21:09:01.263
> 
> 标签：javascript, css, css-transitions

我想要一个位于页面中心的 div（我现在使用 300px），当几秒钟过去后，我想让第二个 div 可见，并使它们都在中心，相差 50px，这就是我现在已经完成了，我的第一个问题是为什么第二个 div 的不透明度更改不适用？

```
<!DOCTYPE html>
<html>
<head>
    <title>Whatever</title>
    <meta charset="utf-8" />
    <style type="text/css">
        #main {
            position: absolute;
            top: 200px;
            left: 300px;
        }

        div.c {
            width: 200px;
            height: 200px;
            float:left;
            position:relative;
            left:200px;
            -webkit-transition:left 2s;
        }

        #left {
            background-color: palevioletred;
        }

        #right {
            -webkit-transition:opacity 2s;
            background-color: ThreeDDarkShadow;
            opacity:0;
        }
    </style>

    <script type="text/javascript">
        window.onload = function () {
            setTimeout("myfunc()", 3000);
        }

        function myfunc() {
            var stupido = document.getElementsByClassName("c");
            for (var i in stupido) {
                stupido[i].style.left = 0;
            }
            document.getElementById("right").style.opacity = 1;
        }
    </script>
</head>
<body>
    <div id="main">
        <div id="left" class="c">x</div>
        <div id="right" class="c">x</div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T13:31:44.200

作为`stupido`一个`HTMLCollection`而不是数组，它的`length`属性被循环通过。`stupido[i].style === undefined`，生成错误，脚本崩溃。

更改`for(var i in stupido)`为`for(i=0; i<stupido.length; i++)`
另外，[尽可能不要在 setTimeout 中使用字符串](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)

[工作小提琴](http://jsfiddle.net/WQtPc/3/)

# java - 接口方法中的递归

> ID：13663755
> 
> 赞同：1
> 
> 时间：2012-12-01T21:09:01.730
> 
> 标签：java, recursion

我正在尝试在 searchTree 类中编写递归方法，并且由于某种原因，这些方法正在接口中的类外部查找方法的定义，而不是查看它们自己。以下是一些代码片段：

在主类：

```
 public class BinarySearchTree<T extends Comparable<T>> implements BinarySearchTreeInterface1<T>, BinarySearchTreeInterface2<T>{` 
```

Main 中的递归方法：

```
 public int getHeight(){
        if (isEmpty()){
            return 0;
        }else{
            int height = 1 + Math.max(this.getLeftSubTree().getHeight(),
                                      this.getRightSubTree().getHeight());
            return height;
        }
   }` 
```

如您所见，我有两个接口类。该错误强调 getHeight() 并指出：

```
cannot find symbol
symbol: method getHeight()
location: interface BinarySearchTreeInterface1<T>
where T is a type-variable:
 T extends Comparable<T> declared in class BinarySearchTree 
```

我在 Interface2 文件中显示了 5 个递归方法，它们都得到了同样的错误。感谢您的任何帮助。

更新：我很犹豫是否发布接口课程，因为它们来自大学课程，我不想让讲师感到不安。具有讽刺意味的是，非递归方法工作得很好。这是 Interface2 文件显示的一小部分内容：

```
public interface BinarySearchTreeInterface2<T>{

    public int getNumberOfNodes();

    public int getHeight(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:29:12.407

似乎`getLeftSubTree()`返回一个`BinarySearchTreeInterface1<T>`. 但是 getHeight() 是在 中定义的`BinarySearchTreeInterface2<T>`，所以不能对 的结果调用 getHeight() 方法`getLeftSubTree()`。

您可以通过覆盖如下`getLeftSubTree()`方法来编译程序：

```
public BinarySearchTree<T> getLeftSubTree() {
    ...
} 
```

当然，也必须对`getRightSubTree()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:30:25.783

该错误表示`getLeftSubTree()` **声明**返回的类型未实现`getHeight()`。

请记住，*声明为由方法返回的类型可以是它**实际*返回的类型的超类型（例如和接口） 。所以可以声明 `BinarySearchTreeInterface1<T> getLeftSubTree()`（它不实现`BinarySearchTreeInterface2`），并实际返回一个`BinarySearchTree<T>`（它实现）——并得到你上面描述的错误。

# jface - 一种在 jface 向导中的下一个按钮上添加事件的方法？

> ID：13663760
> 
> 赞同：2
> 
> 时间：2012-12-01T21:09:09.873
> 
> 标签：jface, wizard

我正在开发一个 jface 向导，当我单击 wizardPage 上的下一个按钮时，我需要做一些处理，而不是在向导上的完成按钮上。有一个事件可以用来这样做吗？我的向导页面扩展了 WizardPage。谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T03:18:33.897

解决此问题的方法是在您的页面中扩展 WizardPage 在默认构造函数中为该页面设置一个唯一名称。然后在 Wizard 类中重写这个方法：

```
public IWizardPage getNextPage(IWizardPage page) {
    return super.getNextPage(page); 

} 
```

然后基于 page.getName() 您可以查看它是否是您想要在用户单击下一步时对其进行处理的页面。您可以将其投射到您的特定向导页面，在这里您可以控制添加错误消息、将 setPageComplete 设置为 false 或执行任何您需要的操作。这是最好的方法。如果您在向导页面本身上覆盖 getNextPage()，它将在页面显示之前被调用，这不是一个好方法。

# python - Django M2M QuerySet 过滤多个外键

> ID：13663762
> 
> 赞同：5
> 
> 时间：2012-12-01T21:09:27.207
> 
> 标签：python, django, many-to-many, django-queryset

对于我正在处理的消息传递模块，我有这两个类。这个想法是对话由一组参与者（两个或更多）表示。我正在努力寻找一种通过逻辑查找对话的方法，即我试图找到的所需对话具有以下参与者。但是，我尝试`Conversation.objects.filter(participants__in=[p1, p2])`了 OR 样式查询，p1 是参与者或 p2 是参与者。我想要 p1 和 p2 并且... pN 是参与者。有什么帮助吗？

```
class Conversation(models.Model):
    date_started = models.DateTimeField(auto_now_add=True)
    participants = models.ManyToManyField(User)

    def get_messages(self):
        return Message.objects.filter(conversation=self)

    def new_message(self, sender, body):
        Message.objects.create(sender=sender, body=body, conversation=self)
        self.save()

class Message(models.Model):
    sender = models.ForeignKey(User)
    body = models.TextField()
    date = models.DateTimeField(auto_now_add=True)
    conversation = models.ForeignKey(Conversation)

    def __unicodde__(self):
        return body + "-" + sender 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-02T07:33:58.440

我认为你只需要迭代过滤。这可能完全是胡说八道，因为我有点睡眠不足，但也许是这样的经理方法：

```
class ConversationManager(models.Manager):
    def has_all(self, participants):
        # Start with all conversations
        reducedQs = self.get_query_set()
        for p in participants:
            # Reduce to conversations that have a participant "p" 
            reducedQs = reducedQs.filter(participants__id=p.id)
        return reducedQs 
```

一般来说，您应该养成使用表级查询管理器方法的习惯，而不是类方法。通过这种方式，您会得到一个查询集，如果需要，您可以进一步过滤。

[灵感来自对文档](https://docs.djangoproject.com/en/dev/topics/db/models/#many-to-many-relationships)中具有成员名称 Paul 的所有组的查询和[此答案](https://stackoverflow.com/questions/5301996/django-many-to-many-query)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-02T10:21:06.293

如果您在同一个相关模型上多次链接 filter()，则生成的查询将对同一个表有一个额外的 JOIN。

所以你有了 ：`Conversation.objects.filter(participants=p1).filter(participants=p2)`

您可以通过查看生成的查询来确认此行为`print Conversation.objects.filter(participants=p1).filter(participants=p2).query`

请参阅：[https ://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships](https://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships)

由于它仍然相当简单和高效，我会避免在查询后使用 python 逻辑，这需要从数据库中引入太多数据，然后通过迭代再次过滤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T23:32:30.247

One way of doing it could be using python sets:

```
#Get the set of conversation ids for each participant
    p1_conv_set = set(Converstation.objects.filter(participants = p1).values_list('id', flat=True))
    p2_conv_set = set(Converstation.objects.filter(participants = p2).values_list('id', flat=True))
    .
    .
    pn_conv_set = set(Converstation.objects.filter(participants = pN).values_list('id', flat=True))
    #Find the common ids for all participants
    all_participants_intersection = p1_conv_set & p2_conv_set & ....pN_conv_set
    #Get all the conversation for all the calculated ids
    Conversation.objects.filter(id__in = all_participants_intersection) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T21:30:16.477

首先，我会在该字段中添加一个相关名称`participants`：

```
participants = models.ManyToManyField(User, related_name='conversations') 
```

这不是必需的，但更具可读性 IMO。

然后您可以执行以下操作：

```
p1.conversations.filter(participants__in=p2) 
```

这将返回 p2 也参与的所有 p1 的对话。

我不确定这种过滤方法的数据库效率，也许使用其他类型的数据库（可能是 Neo4j 之类的图形数据库）更合适。

# android - 从 ListView 和 ArrayAdapter 中删除项目

> ID：13663763
> 
> 赞同：2
> 
> 时间：2012-12-01T21:09:38.867
> 
> 标签：android, listview, android-listview

我正在尝试制作一个简单的代码，当用户单击它时删除一个 ListView 项目。我的代码：

```
static ArrayAdapter<String> dataAdapter;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_notifications_list);

    String[] arraylist = {"a", "b", "c", "d"};
    List<String> list = Arrays.asList(arraylist);

    dataAdapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1,
            list);

    setListAdapter(dataAdapter);

}

public void onListItemClick(ListView l, View v, final int position, long id) {
    dataAdapter.remove(dataAdapter.getItem(position));
    dataAdapter.notifyDataSetChanged();
} 
```

单击该项目时，应用程序崩溃并出现以下错误：

```
D/AndroidRuntime(31862): Shutting down VM
W/dalvikvm(31862): threadid=1: thread exiting with uncaught exception (group=0x40b4e300)
E/AndroidRuntime(31862): FATAL EXCEPTION: main
E/AndroidRuntime(31862): java.lang.UnsupportedOperationException
E/AndroidRuntime(31862):    at java.util.AbstractList.remove(AbstractList.java:638)
E/AndroidRuntime(31862):    at java.util.AbstractList$SimpleListIterator.remove(AbstractList.java:75)
E/AndroidRuntime(31862):    at java.util.AbstractCollection.remove(AbstractCollection.java:229)
E/AndroidRuntime(31862):    at android.widget.ArrayAdapter.remove(ArrayAdapter.java:244)
E/AndroidRuntime(31862):    at com.dennis.notifications.NotificationList.onListItemClick(NotificationList.java:113)
E/AndroidRuntime(31862):    at android.app.ListActivity$2.onItemClick(ListActivity.java:319)
E/AndroidRuntime(31862):    at android.widget.AdapterView.performItemClick(AdapterView.java:298)
E/AndroidRuntime(31862):    at android.widget.AbsListView.performItemClick(AbsListView.java:1088)
E/AndroidRuntime(31862):    at android.widget.AbsListView$PerformClick.run(AbsListView.java:2861)
E/AndroidRuntime(31862):    at android.widget.AbsListView$1.run(AbsListView.java:3535)
E/AndroidRuntime(31862):    at android.os.Handler.handleCallback(Handler.java:615)
E/AndroidRuntime(31862):    at android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime(31862):    at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(31862):    at android.app.ActivityThread.main(ActivityThread.java:4931)
E/AndroidRuntime(31862):    at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(31862):    at java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(31862):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
E/AndroidRuntime(31862):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
E/AndroidRuntime(31862):    at dalvik.system.NativeStart.main(Native Method) 
```

我是Java和Android的新手，如果可以的话，请为初学者解释清楚该怎么做。
提前谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T21:48:43.747

您可以使用：

```
String[] arraylist = {"a", "b", "c", "d"};
List<String> list = new ArrayList<String>();
Collections.addAll(list, arraylist); 
```

`Arrays.asList()`只创建一个指向`arrayList`它的 List 仍然只是一个原始的字符串数组。而且您不能像`remove()`在原始数组上那样执行复杂的操作。用你的价值观`Collections.addAll()`填充真实。`list``arraylist`

# javascript - 流星渲染列表拦截？客户端

> ID：13663765
> 
> 赞同：1
> 
> 时间：2012-12-01T21:09:45.957
> 
> 标签：javascript, meteor

我的聊天消息显示如下：

```
 {{#each msg}}
    {{> chatMsg}}
  {{/each}} 
```

当用户进入聊天时，我将文档添加到集合中`user joins the chat`。当用户快速重新进入并离开聊天时，我不想`user joins the chat`一遍又一遍地重复。我想显示类似`user joins the chat x3`.

有没有办法通过连接到 renderList 在客户端做到这一点？我知道我可以在服务器端更改文档，但它似乎不必要地密集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T02:05:17.107

从这里到达那里的最简单方法是编写自定义发布者。不只是从发布函数返回一个游标，而是在发布函数中对游标调用 observe()，并在其中执行适当的 set()、unset() 和 flush() 调用，以适当地乘以前一个消息而不是添加新消息。您可以在[Meteor.publish 的流星文档中找到相关文档](http://docs.meteor.com/#meteor_publish)

要从比较中获得基础，您可以查看当前发布 Cursor 的代码，该代码位于 packages/mongo-livedata/mongo_driver.js 中，位于 Cursor.prototype._publishCursor 中。

注意：我的回答是针对 Meteor 0.5.2。自定义发布者的 API 将在 Meteor 的未来版本中发生变化，您必须调用的函数不同于 set() unset() 和 flush()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T09:19:33.553

一种选择是进行仅更新最新用户加入消息的方法调用。

```
function formatJoinMessage(username,count) {...}

if (Meteor.isServer) Meteor.startup(function () {Chats._ensureIndex({modified:-1}); ...});

Meteor.methods({
    join:function() {
        var joinMessage = Chats.find({type:MESSAGE_TYPE_JOINED,userId:this.userId}).sort({modified:-1}).fetch()[0];
        if (joinMessage)
            Chats.update({_id:joinMessage._id},{$inc:{joins:1},$set:{text:formatJoinMessage(this.userId,joinMessage.joins+1),modified:new Date()});
        else
            Chats.insert({user:this.userId,joins:1,modified:new Date(),text:formatJoinMessage(this.userId,1)});
    }
)}; 
```

不想更改服务器文档？没关系，但从概念上讲，聊天加入不是聊天消息。因此，您绝对应该在文档`meta`中包含此类内容的字段。`chat`

但假设你不想这样做。我会做这样的事情：

```
var userIdToName = function(userId) {...}; // some kind of userId to name helper

Template.chatroom.msg = function() {
  var messages = Chat.findOne(Session.get("currentChat")).messages; // msg in your code?
  return _.reduce(messages,function (newMessages, currentMessage) {
    var lastMsg = newMessages[newMessages.length-1];
    if (currentMessage.type == MESSAGE_TYPES_JOIN) {
       if (lastMsg && lastMsg.type == MESSAGE_TYPES_JOIN && currentMessage.user == lastMsg.user) {
          currentMessage.timesJoined = lastMsg.timesJoined+1;
          newMessages.shift();
       } else {
          currentMessage.timesJoined = 1;
       }
       currentMessage.chatMsg = userIdToName(lastMsg.user) + " joins the chat &mult;" + currentMessage.timesJoined.toString();
    }
    return newMessages.concat(currentMessage);
  },[]);
} 
```

这有点笨拙。可以这么说，它将在聊天的当前消息中找到的所有加入消息“减少”为一条消息。您动态添加属性`timesJoined`；它没有出现在文档中。但是您应该有一个`type`字段让您知道加入消息和常规消息之间的区别。

如果您至少没有该元数据，那么您的聊天应用程序将无法正常工作。不要犹豫，改变你的模型！

# android - Android 开发 - 使按钮打开新屏幕

> ID：13663768
> 
> 赞同：0
> 
> 时间：2012-12-01T21:10:07.400
> 
> 标签：android

我正在尝试做的可能非常简单，但我遵循了几个不同的说明，似乎无法让它工作。基本上我想做的就是在（main_activity）下的xml布局中创建一个按钮，在java（MainActivity）中引用它，然后设置该按钮以打开它自己的新xml文件。截至目前，当我单击按钮（在我的手机上而不是模拟器上）时崩溃。这就是我到目前为止所拥有的。感谢您查看它。

xml屏幕一

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<TextView
    android:id="@+id/tvFirst"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:text="Application"
    android:textSize="30dp" />

<Button
    android:id="@+id/b1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/tvFirst"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="46dp"
    android:text="1"
    android:textSize="30dp" />

</RelativeLayout> 
```

java屏幕1

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button b = (Button) findViewById(R.id.b1);

    b.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            Intent i = new Intent(MainActivity.this, ButtonOne.class);
            startActivity(i);
        }

    });
}
} 
```

xml屏幕2

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/tvButtonOne"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="This is te button one screen" />

</LinearLayout> 
```

java屏幕2

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    findViewById(R.layout.buttonone);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:23:01.450

@javac 和 @AC 都是正确的，您需要调用`setContentView`，但还要确保您已在 AndroidManifest.xml 文件中声明了新活动。

```
<activity
android:name="NAME"
android:label="@string/string_name"/> 
```

查看[此链接](http://developer.android.com/training/basics/firstapp/starting-activity.html#AddToManifest)以了解 Android 文档的内容。

为了帮助您获得更广泛的理解，您尝试做的工作流程将是这样的：

1.  开始活动 1
2.  (in `onCreate()`)`onClickListener`设置为按钮
3.  按钮被按下
4.  `onClickListener`奔跑，呼唤`startActivity()`
5.  在`startActivity()`中，系统确保您已在 AndroidManifest.xml 中声明了该活动，如果有，它会启动该活动。
6.  (in `onCreate()`) call `setContentView()`，它告诉新活动如何布置自己，并且还使调用`findViewById()`按您期望的方式工作。
7.  调用`findViewById()`以获取对您希望能够操作的视图的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:16:43.607

您的应用程序崩溃了，因为您在调用`findViewById(R.layout.buttonone);`时没有为您的新 Activity 提供任何东西 - 它找不到 R.layout.buttonone 因为

*   您尚未设置此 Activity 的布局
*   您试图找到一个布局文件，它不是视图，而是定义视图排列方式的 xml；视图对象的布局。

这意味着您需要替换`findViewById(R.layout.buttonone);`为`setContentView (R.layout.buttonone);`

从那里您可以使用`findViewById()`获取 xml 文件中定义的**组件**，例如`tvButtonOne`. 确保您要访问的每个组件都有自己的 id，否则您的应用程序将再次崩溃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T21:18:20.950

所以我猜你有两个屏幕（2个活动），当点击按钮时它会启动screen2。那么在 screen2 类上，您没有定义视图。

使用这一行来引用 xml 文件

```
setContentView(xmlfilenamehere); 
```

这里有一些关于开始第二个活动的信息。

[http://developer.android.com/training/basics/firstapp/starting-activity.html](http://developer.android.com/training/basics/firstapp/starting-activity.html)

# c++ - 向量到 const uint16_t * 类型

> ID：13663774
> 
> 赞同：-1
> 
> 时间：2012-12-01T21:10:39.283
> 
> 标签：c++, modbus

我想为我的自定义项目使用 libmodbus。一切都适用于预定义的静态值，但我不能使用 modbus_write_registers 函数和`const uint16_t *'src'`动态预定义的第四个参数。

在实践中，我必须将获得的 DB 值转换为这种类型，不知道如何。

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:12:03.970

假设您有一个`std::vector<uint16_t>`，您可以使用指针访问底层内存缓冲区`std::vector<uint16_t>::data()`（在本示例中将返回`uint16_t *`）。

# ios - 本机 ios 和 android 中 signalR 的客户端

> ID：13663782
> 
> 赞同：8
> 
> 时间：2012-12-01T21:11:37.883
> 
> 标签：ios, signalr, socketrocket

1）如果我必须为使用 SignalR 的服务器开发本机 IOS 客户端，我可以使用

[SocketRocket](https://github.com/square/SocketRocket)还是[UnittWebSocketClient](http://code.google.com/p/unitt/wiki/UnittWebSocketClient)？

2）客户端应用程序不使用任何浏览器有关系吗？

3) SignalR 与.net 4.5 中的[Superwebsocket](http://superwebsocket.codeplex.com/)或微软的 websocket 有何不同？不是都支持 rfc6455 协议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-06T14:50:39.740

对于 iOS 和 OSX，您可以使用[Signalr-ObjC，](https://github.com/DyKnow/SignalR-ObjC)它与正在进行的 SignalR 版本保持一致。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-16T19:35:37.337

微软刚刚发布了一个安卓客户端[https://github.com/SignalR/java-client](https://github.com/SignalR/java-client)。对于 iO，您无法查看[https://github.com/DyKnow/SignalR-ObjC](https://github.com/DyKnow/SignalR-ObjC)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-25T12:45:48.070

您可以查看我的项目[SignalA](https://github.com/erizet/SignalA)以获得原生 Android 客户端。~~它正在进行中... :)~~它现在已更新到 SignalR 1.0 版本中使用的协议版本 1.2。

# security - 使用手头的加密和未加密文件恢复 AES 加密密钥

> ID：13663788
> 
> 赞同：0
> 
> 时间：2012-12-01T21:12:18.883
> 
> 标签：security, encryption, aes

> **可能重复：**
> [当我拥有原始文件时恢复 AES 加密文件密码](https://stackoverflow.com/questions/10296259/recover-an-aes-encrypted-file-password-when-i-have-the-original-file)

基本上标题已经是问题了。我想解密大约 20 个 .doc 文件，它们是用 MyWinLocker 加密的，据我所知，这意味着 AES。现在我有一个加密文件的未加密副本，并且想知道是否存在使用这对文件来获取可以在其他文件上使用的解密密钥的方法，或者如果可能的话，找到使用的密码.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:16:44.043

我会说不。这是因为加密算法必须能够抵御以下攻击：[已知明文](http://en.wikipedia.org/wiki/Known-plaintext_attack)和[选择密文](http://en.wikipedia.org/wiki/Chosen-ciphertext_attack)

# c# - 在 JavaScript / TypeScript 中实现 IEnumerable

> ID：13663792
> 
> 赞同：6
> 
> 时间：2012-12-01T21:13:03.237
> 
> 标签：c#, javascript, ienumerable, typescript

我正在尝试`yield`在 JavaScript/TypeScript 中实现 C# 关键字（不管是哪个）：例如，我想实现[代码](http://msdn.microsoft.com/en-us/library/vstudio/9k7k7cf0.aspx)：

```
//using System.Collections;  
//using System.Diagnostics; 
public static void Process()
{
    // Display powers of 2 up to the exponent of 8:  
    foreach (int number in Power(2, 8))
    {
        Debug.Write(number.ToString() + " ");
    }
    // Output: 2 4 8 16 32 64 128 256
}

public static IEnumerable Power(int baseNumber, int highExponent)
{
    int result = 1;

    for (int counter = 1; counter <= highExponent; counter++)
    {
        result = result * baseNumber;
        yield return result;
    }
} 
```

在 JavaScript 中。

最终目标是在 JavaScript 中实现[我在 stackoverflow 上提出](https://stackoverflow.com/questions/13548048/is-there-a-splitbycharactertype-method-in-c-sharp-like-there-is-in-java)的另一个问题中用 C# 编写的函数：

```
public static IEnumerable<string> SplitByCharacterType(string input)
{
    if (String.IsNullOrEmpty(input))
        throw new ArgumentNullException(nameof(input));

    StringBuilder segment = new StringBuilder();
    segment.Append(input[0]);
    var current = Char.GetUnicodeCategory(input[0]);

    for (int i = 1; i < input.Length; i++)
    {
        var next = Char.GetUnicodeCategory(input[i]);
        if (next == current)
        {
            segment.Append(input[i]);
        }
        else
        {
            yield return segment.ToString();
            segment.Clear();
            segment.Append(input[i]);
            current = next;
        }
    }
    yield return segment.ToString();
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T21:31:58.227

我认为没有一种合理的方法可以在循环的上下文中进行这项工作，该`for`循环在“移动下一个”操作期间保留惰性求值的 C# 语义。不过，您可以使用闭包合理地模拟这一点。

（打字稿代码）：

```
function getPowers(base: number, maxExponent: number) {
    var currentExponent = 1;
    return function() {
        if(currentExponent > maxExponent) {
            return undefined;
        } else {
            return Math.pow(base, currentExponent++);
        }
    }
}

// Simple test
var p = getPowers(2, 8);
var n: number;
while((n = p()) !== undefined) {
    console.log(n);
}

// Demonstrate that multiple instances work
var p2 = getPowers(2, 3);
var p3 = getPowers(3, 3);
while(true) {
    var n2 = p2();
    var n3 = p3();
    if((n2 || n3) === undefined) break;

    console.log(n2 + ", " + n3);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-15T06:53:04.223

我知道这是多年以后的事了，但是 TypeScript 中现在存在生成器和迭代器，所以现在这是可能的。您可以在此处阅读更多详细信息：[https ://github.com/Microsoft/TypeScript/wiki/What%27s-new-in-TypeScript#typescript-23](https://github.com/Microsoft/TypeScript/wiki/What%27s-new-in-TypeScript#typescript-23)

我是 的原作者`SplitByCharacterType`，所以我想我也会尝试在 JS 中重新实现它。最困难的问题是缺乏区分字符类型的本机能力（例如：）`GetUnicodeCategory`。[unicode-categories](https://github.com/paulmillr/unicode-categories)看起来可以用来识别字符类别。这里[也有一个答案](https://stackoverflow.com/a/7028178/184746)。我将使用第二个选项，因为它看起来更全面。请注意，`getType()`此处使用的方法来自该答案。

```
function* splitByCharacterType(input) {
    if (!input || !input.length) 
        return;

    var segment = [input[0]];
    var current = getType(input[0]);

    for (var i = 1; i < input.length; i++) {
        var item = input[i];
        var next = getType(item);
        if (next == current) {
            segment.push(item);
        } else {
            yield segment.join("");
            segment = [item];
            current = next;
        }
    }
    yield segment.join("");
} 
```

这也是一个关于这个主题的有趣页面：http: [//inimino.org/~inimino/blog/javascript_cset](http://inimino.org/~inimino/blog/javascript_cset)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T21:23:15.327

某些版本的 JavaScript 包括`yield`但未得到广泛支持（尽管 Firefox 确实支持它）。

尽管真正的“yield”的标志是多个活动的调用堆栈，它需要线程（这就是可以在 Java 中模拟 yield 的原因），但您也许可以即兴发挥，但标准 JS 也没有线程。

您可以查看 Web Workers [http://en.wikipedia.org/wiki/Web_worker](http://en.wikipedia.org/wiki/Web_worker)，但我怀疑这对于大多数受益于产量的应用程序来说过于重量级和限制性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T21:49:51.933

@Lajos Arpad：拥有一个数组与拥有一个 IEnumerable 不同。该接口的核心是按需评估迭代中的下一个元素。

为瑞安+1。

从某种意义上说，该示例可能会更好，即对 getPowers 函数的调用不应具有 maxExponent 参数。这对于惰性求值 IEnumerable 来说根本不是必需的。消费者可以选择任意数量的权力。

Ryan 的示例也适用于无界场景，而任何使用数组的实现都必须失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T22:09:27.587

因此，这里有一个示例，展示了枚举如何在其定义中不受限制，但通过仅读取几个元素来限制消费者端：

```
 function getPowers(base) {
            var currentExponent = 1;
            return function () {
                return Math.pow(base, currentExponent++);
            }
        }

        function test() {
            // Simple test
            var p = getPowers(2);
            var elem = document.getElementById("a");
            elem.innerHTML = "<p>" + p() + "<p>" + p() + "<p>" + p() + "<p>" + p() + "<p>" + p() + "<p>" + p() + "<p>" + p();
        } 
```

# .htaccess - htaccess 重定向和 ExpressionEngine

> ID：13663796
> 
> 赞同：1
> 
> 时间：2012-12-01T21:13:25.503
> 
> 标签：.htaccess, redirect, expressionengine

我刚刚推出了一个新版本的网站，我们将它们从静态文件移到了 ExpressionEngine。

我正在使用 Ellis 批准的 htaccess 方法从 URL 中删除 index.php，但我还需要从旧站点重定向一些 URL，并且我在重定向中得到了工件（因为缺少更好的术语）网址。

例如，我有这个重定向：

```
RedirectMatch 301 /2013/atlanta/ /event/atlanta-2013 
```

实际上最终将您发送到这里：

```
http://aneventapart.com/event/atlanta-2013?/2013/atlanta/ 
```

幸运的是，页面仍然可以正确加载，但我宁愿没有那个查询字符串。

下面是从 ExpressionEngine URL 中删除 index.php 的片段：

```
RewriteCond $1 !\.(gif|jpe?g|png)$ [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?/$1 [L] 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T15:46:03.097

无论如何都不是 .htaccess 方面的专家，但是，如果您希望 ExpressionEngine 社区的所有杰出人物都解决您的问题，请[在此处发布，而不是在 stackexchange 上](https://expressionengine.stackexchange.com/)。

话虽这么说，这是我的镜头。如果你想从

```
http://aneventapart.com/2013/atlanta/ 
```

至

```
http://aneventapart.com/event/atlanta-2013/ 
```

您的 301 规则应该出现在您的 .htaccess 中删除 index.php 的部分之前。我会写这样的规则：

```
RewriteRule ^2013/atlanta/ /event/atlanta-2013/ [R=301,L] 
```

另外，恭喜重新设计！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T01:20:13.650

除非您尝试匹配以下子页面：/2013/atlanta/something/ 例如，我会推荐以下内容

```
Redirect 301 /2013/atlanta/ http://aneventapart.com/event/atlanta-2013/ 
```

URI 到完整 URL 也是如此，这将在您看到的末尾删除基本的 URI 菊花链。

顺便说一句，这可以移动到 expressionengine.stackexchange.com 公共测试版网站吗？

# core-data - 从分支到主干的核心数据迁移

> ID：13663798
> 
> 赞同：0
> 
> 时间：2012-12-01T21:13:42.213
> 
> 标签：core-data, core-data-migration

我遇到了一个核心数据迁移的情况，想知道是否有人有任何建议。

短版 - 我们在**主干中有一个****v1.5**核心数据模型（**基于 v1.0**），在**分支中有一个****v2.0**核心数据模型（也**基于 v1.0**）。我们应该如何将 v2.0 数据模型与 v1.5 的更改合并？

 ******长版：我们的原始应用程序有我们核心数据模型的 v1.0。发布应用程序后，我们开始在分支中开发数据模型的 v2.0（基于 v1.0）。在 v2.0 开发过程中，我们的维护团队发现 v1.0 上的一个 bug，并在主干中创建了 v1.5 核心数据模型（基于 v1.0）。现在我们已经完成了 v2.0 的开发，我们需要将分支更改合并回主干，并且 v2.0 数据模型需要与 v1.5 合并。有没有人建议我应该怎么做？我可以重置 v2.0 数据模型的基本版本并使其基于 v1.5 吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T22:44:26.367

我认为您永远不应该有多个具有相同版本号的版本，因为版本号是为了唯一标识版本而发明的。如果你对几个不同的版本使用相同的版本号，那么你作品的用户如何通过看到 2.0 版本知道他们手中的哪个 2.0 版本？您应该创建一个子版本，例如 2.0.1 版本，这样每个人都会知道 2.0 版本包含在 2.0.1 版本中修复的错误。******

# iphone - 与 CAEmitterLayer 一起使用的代码问题

> ID：13663804
> 
> 赞同：1
> 
> 时间：2012-12-01T21:14:34.900
> 
> 标签：iphone, objective-c, ios, caemitterlayer

我想在用户正确猜测后制作五彩纸屑效果，我在网上搜索了一些看起来非常不错的东西，但它只有 .m 文件，我不知道如何处理头文件。

[这是带有五彩纸屑效果链接的页面链接](http://blog.argteam.com/coding/better-effects-3-simple-ios-5-particle-systems-by-example/)

这是 .m 文件本身，我在这些行上收到错误：

```
if ((self = [super initWithFrame:frame])) {
    self.userInteractionEnabled = NO;
    self.backgroundColor = [UIColor clearColor];
    _confettiEmitter = (CAEmitterLayer*)self.layer; 
```

为什么会出现错误？

```
//
// Created by tdimson on 8/15/12.

#import <QuartzCore/QuartzCore.h>
#import "SFSConfettiScreen.h"

@implementation SFSConfettiScreen {
    __weak CAEmitterLayer *_confettiEmitter;
    CGFloat _decayAmount;
}

- (id)initWithFrame:(CGRect)frame {
    if ((self = [super initWithFrame:frame])) {
        self.userInteractionEnabled = NO;
        self.backgroundColor = [UIColor clearColor];
        _confettiEmitter = (CAEmitterLayer*)self.layer;
        _confettiEmitter.emitterPosition = CGPointMake(self.bounds.size.width /2, 0);
        _confettiEmitter.emitterSize = self.bounds.size;
        _confettiEmitter.emitterShape = kCAEmitterLayerLine;

        CAEmitterCell *confetti = [CAEmitterCell emitterCell];
        confetti.contents = (__bridge id)[[UIImage imageNamed:@"Confetti.png"] CGImage];
        confetti.name = @"confetti";
        confetti.birthRate = 150;
        confetti.lifetime = 5.0;
        confetti.color = [[UIColor colorWithRed:0.6 green:0.6 blue:0.6 alpha:1.0] CGColor];
        confetti.redRange = 0.8;
        confetti.blueRange = 0.8;
        confetti.greenRange = 0.8;

        confetti.velocity = 250;
        confetti.velocityRange = 50;
        confetti.emissionRange = (CGFloat) M_PI_2;
        confetti.emissionLongitude = (CGFloat) M_PI;
        confetti.yAcceleration = 150;
        confetti.scale = 1.0;
        confetti.scaleRange = 0.2;
        confetti.spinRange = 10.0;
        _confettiEmitter.emitterCells = [NSArray arrayWithObject:confetti];
    }

    return self;
}

+ (Class) layerClass {
    return [CAEmitterLayer class];
}

static NSTimeInterval const kDecayStepInterval = 0.1;
- (void) decayStep {
    _confettiEmitter.birthRate -=_decayAmount;
    if (_confettiEmitter.birthRate < 0) {
        _confettiEmitter.birthRate = 0;
    } else {
        [self performSelector:@selector(decayStep) withObject:nil afterDelay:kDecayStepInterval];
    }
}

- (void) decayOverTime:(NSTimeInterval)interval {
    _decayAmount = (CGFloat) (_confettiEmitter.birthRate /  (interval / kDecayStepInterval));
    [self decayStep];
}

- (void) stopEmitting {
    _confettiEmitter.birthRate = 0.0;
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:23:50.217

对此进行逆向工程应该非常简单。它显然是一个`UIView`子类，所以这样的东西就足够了，在现代 Objective-C 中，你甚至不需要在实现文件中声明实例变量。

```
@interface SFSConfettiScreen : UIView

@property(nonatomic, weak) CAEmitterLayer *confettiEmitter;
@property(nonatomic, assign) CGFloat decayAmount;

@end 
```

如果您的 Xcode 版本是 4.4 或更高版本，这应该可以正常工作。否则，将实现保持原样并删除`@property`声明，留下一个空的接口声明。这也应该有效；我只是更喜欢属性而不是 ivars。

# assembly - 为什么 MS-DOS 不初始化 DS 和 ES 寄存器？

> ID：13663811
> 
> 赞同：10
> 
> 时间：2012-12-01T21:15:33.420
> 
> 标签：assembly, dos, intel, masm, x86-16

为什么`DS`和`ES`寄存器的初始化必须由程序员手动完成？

例如：

```
MOV AX, DTSEG
MOV DS, AX 
```

另一方面，`CS`和`SS`寄存器由操作系统初始化（in `MS-DOS`）。为什么会这样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-01T21:20:45.843

因为`CS`和`SS`寄存器对于程序执行是必不可少的，而`DS`和`ES`寄存器指向用户定义的数据段。默认情况下，执行程序中不存在任何数据，这没有什么可以初始化`DS`and`ES`的。作为程序编写者，您可以通过设置数据段寄存器来指定数据的位置。

**编辑**：正如@FrankKotler 正确指出的那样，在`.com`文件中（整个程序大小不超过单个段），`DS`并且`ES`被初始化并等于`CS`. 对于其他执行模型，`DS`并由`ES`指针初始化`PSP`（这不是指向真实用户数据的指针）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-05-16T11:57:33.960

您的问题的正确答案（我相信 V.Aghazarian 大师在大学问过您）并不是因为 CS ans SS 对于程序执行至关重要。

MS-DOS 中的问题在于[程序段前缀](https://en.wikipedia.org/wiki/Program_Segment_Prefix)

来自维基百科：

> PSP 的段地址在程序执行时传入 DS 寄存器。也可以稍后通过使用 Int 21h 函数 51h 或 Int 21h 函数 62h 来确定。任一函数都将返回寄存器 BX 中的 PSP 地址。[1](https://en.wikipedia.org/wiki/Program_Segment_Prefix)

# c++ - 如何访问 32 位寄存器数组和读/写 16 位上下段作为单独的操作

> ID：13663814
> 
> 赞同：1
> 
> 时间：2012-12-01T21:15:44.430
> 
> 标签：c++, arrays, pointers, struct

我有一个连续的内存区域，包含 320 位，分为 10 个独立的“寄存器”。

一旦我创建了内存区域，我就会得到第一个寄存器元素的地址。

此时，我想在逻辑上映射一个包含 32 位数字的高位和低位部分的 32 位结构数组，然后遍历该数组并分别写入高低段。

我已经有一个函数，可以使用位旋转方案将 32 位数字拆分并输入两个 16 位部分。

我的问题是，将结构数组覆盖在连续区域上的最佳方法是什么。

我需要这样做的原因是我正在使用外部库与嵌入式设备通信，而该库没有 32 位的概念，甚至底层设备都将数据存储在 32 位寄存器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:23:46.943

首先，确保您的结构是编译器表示的 32 位。检查 sizeof(struct xxx) == 4 并使用编译器打包选项直到它是（技术上这确保 struct 是 4 个字符，但它应该足够好）..

其次是创建一个指向结构类型对象的指针，然后为其分配内存块的地址。您将需要一个老式的类型转换操作来做到这一点。

类似的东西（注意高低的顺序以及其中的字节将因硬件而异）。

```
typedef struct {
   short high;
   short low;
} hilo;

hilo *registers = (hilo *) memPtr; 
```

# ios6 - 带有 RestKit 0.10.1 和简单返回类型的 HTTP PUT

> ID：13663815
> 
> 赞同：0
> 
> 时间：2012-12-01T21:15:45.987
> 
> 标签：ios6, restkit

我有一个 REST 方法，`http://api.mysite/RestMethod?uid=1`它接受`Credentials`请求正文中的对象。`Credentials`object 非常简单：有两个属性，`UserName`并且`Password`. 成功请求后，该方法返回一个整数。

我想将 Credentials 放在上面`URL`并取回返回的整数值。那里的所有示例都显示了`PUT`何时请求和响应都使用相同类型的对象。我将如何取回一个`int`？

我能够开始`PUT`使用

```
[objectManager putObject:credentials delegate:self]; 
```

RestKit 显示响应返回状态码 200。但它无法反序列化整数。

任何帮助将不胜感激。

谢谢。

PS 我绝对不需要使用 RestKit。我会考虑其他选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T16:05:51.950

最后，我最终重写了我的 API 方法以返回相同`Credentials`的对象，并将布尔标志`IsAuthenticated`设置为 true 或 false，并使用`RKObjectManager`映射将序列化器/反序列化器映射到 JSON

# android - 适用于 Android 程序的应用内 Paypal 按钮

> ID：13663819
> 
> 赞同：2
> 
> 时间：2012-12-01T21:16:15.377
> 
> 标签：android, paypal

我想开发一个允许我通过 PayPal 接受捐款的应用程序。我已经读过，只要没有激活其他服务（捐赠与购买）（[来源](https://stackoverflow.com/questions/5053722/paypal-donations-on-android-apps)），就允许这样做。

如果用户安装了 PayPal 应用程序，我想打开它并填写必填字段。

是否有这样做的意图，或者我必须打开一个带有 Paypal 按钮 URL 的网页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T20:17:26.597

我 100% 确定您必须使用 Paypal 按钮 URL 打开网页

我将它用于我的捐赠按钮并将其设置为图片按钮：

```
`Donate.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("https://www.paypal.com/your_paypal"));
                startActivity(browserIntent);
            }
        });` 
```

要获取链接版本，请在设置按钮时单击电子邮件版本。如果捐款是给你的，我会把按钮命名为“支持开发者”

# java - “此方法不适用于参数”错误

> ID：13663831
> 
> 赞同：-3
> 
> 时间：2012-12-01T21:17:36.227
> 
> 标签：java, syntax-error, processing

有谁知道我为什么会收到这个错误？本质上，该程序显示图像，显示直方图或图像。然后它调整每个像素的亮度，并再次显示具有调整值的图像和直方图。

错误是：

> `The method drawHistogram(int[], int, int) is not applicable for arguments (PImage, int[]);`

```
PImage rocks;
PImage rocksBrightened;
PImage rocks2;
int rockBytes[][];
int rockBrights[][];

void setup() {  

  rocks = loadImage("rocks.png");
  size(rocks.width+256, rocks.height*2);
  rocks2 = createGraphics(rocks.width, rocks.height, P2D);
  rocks2.loadPixels();

  int h = rocks.height;
  size(rocks.width*2, rocks.height*2);
  image(rocks, 0, 0);
  rockBytes = new int[rocks.width][rocks.height];
  rockBrights = new int[rocks.width][rocks.height];
  for (int i = 0;i < rocks.width; i++) {  
    for (int j = 0; j < rocks.height; j++) {
    rockBytes[i][j] = rocks.get(i, j);
    } 
  }  
  for (int i = 0; i < rocks.width; i++) { 
    for (int j = 0; j < rocks.height; j++) { 
      rockBrights[i][j] = rocksBrightened.get(i, j); 
      }  
    } 
  drawHistogram(rocks, computeHistogram(rocks)); //THIS LINE CAUSES ERROR
  brighten(rockBrights);
  // makeImage(rocksBrightened, rockBrights);
  image(rocksBrightened, 0, h);
  }

void loadPixelArray(PImage anImage) { 
  anImage.loadPixels(); //load pixels into pixels[] array
  }

int[] computeHistogram (PImage anImage) {
  int histogram[] = new int[256];
  for (int i = anImage.pixels.length-1; i >= 0; --i) {
    int v = (int) brightness(anImage.pixels[i]);
    histogram[v]++;
  }
  int maxV = 0;
  for (int i = 0; i < 256; i++) {
    maxV = max(maxV,histogram[i]);
  }
  for (int i = 0; i < 256; i++) {
    histogram[i] = (int) (histogram[i]*100.0/maxV);
  }
  return histogram; 
}

void brighten(int anyArray[][]) { 

   for (int i = rocks.pixels.length-1; i >= 0; --i) {
      int v = rocks.pixels[i];
      float br = brightness(v);
      float r = constrain(br*-.004436+2.1308*red(v),0,255);
      float g = constrain(br*-.004436+2.1308*green(v),0,255);
      float b = constrain(br*-.004436+2.1308*blue(v),0,255);
      rocks2.pixels[i] = color(r,g,b);
      } 
  }

  void drawHistogram(int histogram[], int x, int y) {
  noStroke();
  fill(0);
  stroke(255);
  rect(x, y, 256, 256);
  for (int i = 0; i < 256; i++) {
    line(x + i, y+256, x + i, y+256 - histogram[i]);
  }
 }

 void makeImage(PImage anImage, int imgArray[][]) { 

   anImage.loadPixels();
   for (int i = 0; i < imgArray.length; i++) {   
     for (int j = 0; j < imgArray[0].length; j++) {   
     int loc = i + j*imgArray.length;   
     set(i, j+100, color(imgArray[i][j])); 
     } 
   }
   anImage.updatePixels();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-01T21:57:13.253

好吧，错误消息说明了一切：

> 方法 drawHistogram(int[], int, int) 不适用于参数 (PImage, int[]);

这意味着您正在尝试调用方法`drawHistogram()`，该方法被声明为`drawHistogram(int[], int, int)`（这意味着它需要一个 int 数组和两个 int 作为参数），但是您传递了一个`PImage`和一个 int 数组而不是所需的参数。那没有意义。

这有点像试图将一美元钞票插入一台只接受硬币的机器：它不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T23:38:51.773

正如 JB Nizet 所说。要纠正这个特定的错误，只需使用方法 computeHistogram()，调用：

```
drawHistogram(computeHistogram(rocks), x, y); 
```

其中 x 和 y 是绘制直方图的基本位置。但在那之后，代码将无法编译。还有一些其他的错误你可以去处理:)

# php - Codeigniter：控制器太大，如何将其分成更小的块？

> ID：13663835
> 
> 赞同：1
> 
> 时间：2012-12-01T21:18:13.457
> 
> 标签：php, codeigniter, controllers

我遇到的问题是 my_controller.php 有超过 1000 行代码。虽然我在浏览它时没有问题，但我想将该控制器的一部分放在其他一些文件中。

更详细地说：

我有一个控制器，其中包含特定对象（及其子对象）的 CRUD 函数（不是模型函数、控制器函数，这意味着那里没有数据库查询）

现在，对于每个 CRUD，我都有一个用作控制器的函数（通过 url 访问的那个，如果是 Create 部分，它将准备一个表单），一个管理表单数据的函数（获取POST 并将其发送到验证，如果可以，则发送数据以进行进一步准备）和验证（通过回调验证数据）和准备（主要用于调用模型方法并向其发送准备好的数据数组）。

由于此控制器中所有对象的 CRUD 使用大部分相同的数据，它们共享许多功能。

所以我想创建特定的 .php 来存储验证函数、回调函数、准备函数等。

做这个的最好方式是什么？

创建 CRUD 控制器时的常见程序或良好做法是什么？

我希望我足够清楚，我对语言和 php 编程的了解都相当有限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:31:10.677

你有一个“胖”控制器。一种选择是查看可以轻松推送到模型的内容，以便您拥有“瘦控制器胖模型”。考虑模型的一种方法是它是您的数据库表以及如何使用该数据的业务规则。因此，诸如验证和数据准备之类的事情可以在模型中发生。然后控制器只是交出并收集对象和数组。并且模型可以直接调用其他模型。

如果您不喜欢这种方法，或者您需要更便携的东西，请使用库。要查看的另一件事是，您在不同的地方是否需要一些简短的位（技术术语）——看看将它们放在站点配置文件中。

# ios - 在空数据库中下载 sqlite 数据库结果

> ID：13663840
> 
> 赞同：0
> 
> 时间：2012-12-01T21:18:29.687
> 
> 标签：ios, sqlite, download, filesystems

我正在开发一个基于 sqlite 数据库的 iOS 应用程序。由于我不想每次添加新数据时都更新应用程序，因此我想将 sqlite 数据库存储在服务器上并询问用户是否要下载更新。

这是我的代码：

```
 NSString *stringURL = [NSString stringWithFormat:@"http://myurl.com/dl.php"];
    NSData *data = [NSData dataWithContentsOfURL:[NSURL URLWithString:stringURL]];
    [data writeToFile:storePath atomically:YES]; 
```

dl.php 只是将 sqlite 数据库发送到客户端（php：readfile("foo.sqlite")）。当我在浏览器中访问 url 时，数据库已正确下载 (336 KB)。

我也试过：

```
 [fileManager removeItemAtPath:storePath error:error];
    [fileManager createFileAtPath:storePath contents:data attributes:nil]; 
```

我的问题：文件被下载，但 sqlite 数据库只有 188 KB（而不是 336 KB）。该文件未完全损坏。如果我用sqlite数据库编辑器打开文件，表结构是正确的，但是sqlite文件中没有数据。

有什么建议我做错了吗？

# java - 使用 Java 删除所有带有扩展名的文件

> ID：13663843
> 
> 赞同：10
> 
> 时间：2012-12-01T21:18:39.230
> 
> 标签：java, file

我（相对）是Java新手，我正在尝试实现一个.jar，它运行Windows XP命令提示符中的命令列表，它将是：

```
cd\
cd myfolder
del *.lck /s 
```

我的（失败的）尝试：

```
// Lists all files in folder
File folder = new File(dir);
File fList[] = folder.listFiles();
// Searchs .lck
for (int i = 0; i < fList.length; i++) {
    String pes = fList.get(i);
    if (pes.contains(".lck") == true) {
        // and deletes
        boolean success = (new File(fList.get(i)).delete());
    }
} 
```

我在“get(i)”周围的某个地方搞砸了，但我认为我现在已经非常接近我的目标了。

我请求您的帮助，并提前非常感谢您！

* * *

**编辑**

好的！非常感谢大家。通过 3 个建议的修改，我最终得到：

```
// Lists all files in folder
File folder = new File(dir);
File fList[] = folder.listFiles();
// Searchs .lck
for (int i = 0; i < fList.length; i++) {
    String pes = fList[i];
    if (pes.endsWith(".lck")) {
        // and deletes
        boolean success = (new File(fList[i]).delete());
    }
} 
```

现在它起作用了！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-01T21:23:53.197

```
for (File f : folder.listFiles()) {
    if (f.getName().endsWith(".lck")) {
        f.delete(); // may fail mysteriously - returns boolean you may want to check
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-01T21:20:28.453

`fList.get(i)`应该`fList[i]`是`fList`一个数组，它返回一个`File`引用而不是 a `String`。

改变： -

```
String pes = fList.get(i); 
```

到： -

```
File pes = fList[i]; 
```

然后更改`if (pes.contains(".lck") == true)`为
`if (pes.getName().contains(".lck"))`

事实上，既然你正在检查`extension`，你应该使用`endsWith`方法而不是`contains`方法。是的，您不需要将您的`boolean`价值与`==`. 所以只需使用这个条件： -

```
if (pes.getName().endsWith(".lck")) {
    boolean success = (new File(fList.get(i)).delete());
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-12T03:24:40.390

Java 8 方法

```
Arrays.stream(yourDir.listFiles((f, p) -> p.endsWith("YOUR_FILE_EXTENSION"))).forEach(File::delete); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-18T12:42:26.210

最终代码有效:)

```
File folder = new File(dir);
                File fList[] = folder.listFiles();

                for (File f : fList) {
                    if (f.getName().endsWith(".png")) {
                        f.delete(); 
                    }} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T21:20:45.647

您正在使用`Collection`方法`get`。`Array`使用`Array Index`如下符号：

```
 File pes = fList[i]; 
```

最好在文件名上使用[**endsWith() String 方法：**](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#endsWith%28java.lang.String%29)

```
 if (pes.getName().endsWith(".lck")){
      ...
   } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-14T11:13:30.937

Java 8 拉姆达

```
File folder = new File(yourDirString);
Arrays.stream(folder.listFiles())
            .filter(f -> f.getName().endsWith(".lck"))
            .forEach(File::delete); 
```

# c# - 从静态函数访问外部变量

> ID：13663844
> 
> 赞同：2
> 
> 时间：2012-12-01T21:19:08.887
> 
> 标签：c#, string, static, void, output

我有一个静态函数：

```
static string GenRan()
{
    List<string> s = new List<string> {"a", "b"};
    int r = Rand();
    string a = null;

    if (r == 1)
    {
        a += s[0];
        s.RemoveAt(0);
    }
    if (r == 2)
    {
        a += s[1];
        s.RemoveAt(1);
    }
    return a;
} 
```

但是每次我调用该函数时，列表都会被重置，所以我想从静态函数外部访问列表。

有办法吗？

我试过：

```
static void Main(string[] args)
{
    List<string> s = new List<string> {"a", "b"};
    string out = GenRan(s);
}

static string GenRan(List<string> dict)
{

    int r = Rand();
    string a = null;

    if (r == 1)
    {
        a += s[0];
        s.RemoveAt(0);
    }
    if (r == 2)
    {
        a += s[1];
        s.RemoveAt(1);
    }
    return a;
} 
```

但后来我得到一个索引超出范围错误（不知道为什么）。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-01T21:21:17.623

您需要将其作为[**静态字段**](http://msdn.microsoft.com/en-us/library/aa645751%28v=vs.71%29.aspx)变量添加到类中：

```
private static List<string> s = new List<string> { "a", "b" };

static string GenRan()
{
    int r = Rand();
    string a = null;

    if (r == 1)
    {
        a += s[0];
        s.RemoveAt(0);
    }
    if (r == 2)
    {
        a += s[1];
        s.RemoveAt(1);
    }
    return a;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:21:25.580

> 但是每次我调用该函数时，列表都会被重置，所以我想从静态函数外部访问列表。

您的意思不是很清楚，但是如果您的意思是希望列表在调用之间保持不变，则需要在方法之外将其声明为静态变量：

```
private static readonly List<string> s = new List<string> {"a", "b"}; 
```

现在您可以从任何方法访问该列表，它基本上是类状态的一部分。但是，这种方法有*很多*警告：

*   `List<T>`不是线程安全的，通常静态方法应该是线程安全的。如果您只是 C# 的新手并且不使用多个线程，那么您现在可以忽略它。
*   您真的应该重命名变量 -`s`没有说明列表的含义。
*   一般来说，全局可变状态是个坏主意。它使测试您的代码和对其进行推理变得困难。同样，如果您是 C# 新手并且只是在进行试验，您可能不必担心这一点，但随着您继续前进，您应该尝试在对象中放置更多可变状态，而不仅仅是静态变量。

# c++ - 路径和符号使 C++ 的 MPI 黯然失色

> ID：13663845
> 
> 赞同：1
> 
> 时间：2012-12-01T21:19:11.090
> 
> 标签：c++, eclipse, mpi, openmpi

我已经安装了 OpenMPI 和所有用于 eclipse 的工具来使用 MPI。只有一个小问题。当我创建一个使用**MPI-C++**的项目时，我总是必须包含项目“符号和路径”配置的路径，以便`MPI::Init(argc, argv);`eclipse 识别类似的语句。

有没有办法让**所有**项目的`include`路径都设置为 MPI 的正确目录？这只发生在 C++ 中，因为当我尝试使用 C 时，eclipse 可以识别所有 MPI 函数。

![在此处输入图像描述](../Images/e6936d3993e8b5aca6321d095b7038ea.png)

# objective-c - uint16_t 与 UInt16

> ID：13663853
> 
> 赞同：3
> 
> 时间：2012-12-01T21:20:22.040
> 
> 标签：objective-c, ios, c

我正在编写一个 iOS 应用程序，我注意到我有几种方法可以定义一个固定宽度的 16 位无符号整数。

1.  uint16_t - 在 stdint.h 中定义
2.  UInt16 - 在 MacTypes.h 中定义

由于这些是固定宽度（我假设相同的字节序），Apple 定义自己的版本的原因可能是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T21:30:06.830

“用户定义”类型在标准类型成为标准的一部分之前就已经存在。

我在任何地方都使用标准类型，除非直接使用指定“用户定义”类型的接口。

# ruby-on-rails - Heroku 预编译错误

> ID：13663857
> 
> 赞同：5
> 
> 时间：2012-12-01T21:20:39.530
> 
> 标签：ruby-on-rails, heroku

将我的 rails 应用程序推送到 heroku 时，预编译不起作用，现在每当我尝试做任何事情（重新启动 heroku、重置数据库、迁移数据库、重命名 heroku 等）时，我都会收到此错误：

更新：似乎 Bundler 也不能在我的笔记本电脑上本地工作。

```
/usr/local/lib/ruby/site_ruby/1.8/rubygems/dependency.rb:52:in `initialize': Valid types are [:development, :runtime], not nil (ArgumentError)
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:371:in `new'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:371:in `search'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:361:in `gems_size'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `start'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `map'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:159:in `start'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:128:in `resolve'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:127:in `catch'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/resolver.rb:127:in `resolve'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/definition.rb:182:in `resolve'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/definition.rb:113:in `specs'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/gems/bundler-1.2.0/lib/bundler/environment.rb:27:in `specs'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.1.0/lib/rubygems-bundler/noexec.rb:56:in `candidate?'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.1.0/lib/rubygems-bundler/noexec.rb:74:in `setup'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194@global/gems/rubygems-bundler-1.1.0/lib/rubygems-bundler/noexec.rb:89
from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require'
from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
from /Users/aaa/.rvm/gems/ruby-1.9.3-p194/bin/ruby_noexec_wrapper:9 
```

这是原始推送中发生的事情：

```
 Running: rake assets:precompile
   rake aborted!
   could not connect to server: Connection refused
   Is the server running on host "127.0.0.1" and accepting
   TCP/IP connections on port 5432?
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `initialize'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `new'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:1208:in `connect'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:326:in `initialize'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `new'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/postgresql_adapter.rb:28:in `postgresql_connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:315:in `new_connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:325:in `checkout_new_connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:247:in `block (2 levels) in checkout'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `loop'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:242:in `block in checkout'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:239:in `checkout'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:102:in `block in connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:101:in `connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:410:in `retrieve_connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:171:in `retrieve_connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_specification.rb:145:in `connection'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/model_schema.rb:308:in `clear_cache!'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.9/lib/active_record/railtie.rb:97:in `block (2 levels) in <class:Railtie>'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:418:in `_run__1193294461922673159__prepare__3401192585586483770__callbacks'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/application/finisher.rb:47:in `block in <module:Finisher>'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/initializable.rb:30:in `instance_exec'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/initializable.rb:30:in `run'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/initializable.rb:55:in `block in run_initializers'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/initializable.rb:54:in `each'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/initializable.rb:54:in `run_initializers'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/application.rb:136:in `initialize!'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/railtie/configurable.rb:30:in `method_missing'
   /tmp/build_13mv4cuh78fg0/config/environment.rb:5:in `<top (required)>'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `require'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `block in require'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:236:in `load_dependency'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.9/lib/active_support/dependencies.rb:251:in `require'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/application.rb:103:in `require_environment!'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/railties-3.2.9/lib/rails/application.rb:297:in `block (2 levels) in initialize_tasks'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/sprockets/assets.rake:93:in `block (2 levels) in <top (required)>'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/sprockets/assets.rake:60:in `block (3 levels) in <top (required)>'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/sprockets/assets.rake:23:in `invoke_or_reboot_rake_task'
   /tmp/build_13mv4cuh78fg0/vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.9/lib/sprockets/assets.rake:29:in `block (2 levels) in <top (required)>'
   Tasks: TOP => environment
   (See full trace by running task with --trace)
   Precompiling assets failed, enabling runtime asset compilation 
```

我将不胜感激任何人在解决此问题时可以提供的任何帮助。

更新：这是我的 Gemfile：

```
source 'https://rubygems.org'

gem 'rails', '3.2.9'
gem 'pg'
gem 'redis'
gem 'bcrypt-ruby', '3.0.1'
gem 'jquery-rails'
gem 'rails-i18n'
gem 'globalize3', '~> 0.2.0'
gem 'batch_translations', '~> 0.1.2'

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:38:14.877

我在这里找到了一个看起来有点像你在这里遇到的问题的解决方案

[资产：预编译错误heroku](http://www.simonecarletti.com/blog/2012/02/heroku-and-rails-3-2-assetprecompile-error/)

它基本上说将此行添加`config.assets.initialize_on_precompile = false`到您的`application.rb`文件中。显然 Rails 3.2 和 Heroku 存在问题。这可能会也可能不会解决您的问题，但会缩小可能性。

此外，您可能想尝试在 Gemfile 中添加以下内容：`ruby "1.9.3"`就在该`source`行的下方。让我知道这个是否奏效。还要确保在添加该行后运行 bundle install 。

# php - 如何使用此日期验证代码创建 php 函数？

> ID：13663862
> 
> 赞同：0
> 
> 时间：2012-12-01T21:21:08.550
> 
> 标签：php, validation, function, date

我有一段代码可以在没有使其成为函数的情况下工作。但是，当我把它变成一个函数时，它总是返回 false。顾名思义，此函数的目的是检查日期是否有效。谁能告诉我代码有什么问题？

```
function is_valid_date($a) {
//date format Y-m-d H:i:s
if(preg_match('/^((19|20)\\d\\d)-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01]) ([01]\d|2[0123]):([0-5]\d):([0-5]\d)$/', $a)){ 
    list( $_date , $_time ) = explode(' ',$a);
    list ($year,$month,$day) = explode("-",$_date);
    list($hour,$minute,$second) = explode(":",$_time);

    if ($day == "31" && ($month == "4" || $month == "6" || $month == "9" || $month == "11" || $month == "04" || $month == "06" || $month == "09" ))  {
        return false;
    } elseif ($month == "2" || $month == "02") {
            if($year % 4==0){
                if($day == "30" || $day == "31"){
                    return false;
                } else {
                    return true;
                }
            }else{
                if($day == "29" || $day == "30" || $day == "31"){
                    return false;
                } else {
                    return true;
                }
            }
    }

}else{
    return false;

}
} 
```

当我尝试

```
if (is_valid_date("2012-12-02 15:30:00")) { echo "valid date";} 
```

什么都没有打印。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:29:14.327

以下使用有什么问题[`checkdate`](http://php.net/manual/en/function.checkdate.php)？

```
<?php
    function is_valid_date($date) {
        if (preg_match('/^((19|20)\\d\\d)-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01]) ([01]\d|2[0123]):([0-5]\d):([0-5]\d)$/', $date, $matches)){
            return checkdate($matches[3], $matches[4], $matches[1]);
        }
        return false;
    }
    var_dump(is_valid_date("2012-12-02 15:30:00")); //true
?> 
```

这将匹配以下内容：

```
2012-10-13 00:00:00
1990-02-30 12:34:56 
```

但不是

```
15:30:00
2012-12-02
2012/12/02 15:30:00
2012-13-02 15:30:00 
```

[点击这里查看它在线运行](http://3v4l.org/rC19Q)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:27:19.803

放

```
return true; 
```

在函数结束之前（最后一个大括号之前`}`）。否则，在某些情况下，不会返回任何内容并被视为`false`.

整个代码：

```
function is_valid_date($a) {
//date format Y-m-d H:i:s
if(preg_match('/^((19|20)\\d\\d)-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01]) ([01]\d|2[0123]):([0-5]\d):([0-5]\d)$/', $a)){ 
    list( $_date , $_time ) = explode(' ',$a);
    list ($year,$month,$day) = explode("-",$_date);
    list($hour,$minute,$second) = explode(":",$_time);

    if ($day == "31" && ($month == "4" || $month == "6" || $month == "9" || $month == "11" || $month == "04" || $month == "06" || $month == "09" ))  {
        return false;
    } elseif ($month == "2" || $month == "02") {
            if($year % 4==0){
                if($day == "30" || $day == "31"){
                    return false;
                } else {
                    return true;
                }
            }else{
                if($day == "29" || $day == "30" || $day == "31"){
                    return false;
                } else {
                    return true;
                }
            }
    }

}else{
    return false;

}
    return true;

} 
```

# html - 如何开始页面抓取技术

> ID：13663863
> 
> 赞同：0
> 
> 时间：2012-12-01T21:21:09.547
> 
> 标签：html, xml, rss

我是页面抓取的新手，我不知道从哪里开始。进行页面抓取的最简单方法是什么？您对此有何看法，哪些网络技术最适合？谁能帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:35:44.450

查看[html agility pack](http://htmlagilitypack.codeplex.com/)；

例子：

这要看情况。例如，如果一个标签有一个类并且它是唯一的——它是一个函数，但是如果有多个标签，你需要根据标签位置来思考和创建你的函数，另一种没有标签的情况，你会必须计算 html 元素；例如，您可能还需要遍历表行。

下面的示例与您需要的类似。（不确定它是否仍然有效，因为如果页面布局发生变化，它可能会失败。）但它给出了这个想法，你可以从那里开始。

PS - 提问时请给出确切的问题，而不是模糊的问题。

**C# 示例：**

```
 String openUrl = @"http://www.ebay.com/sch/-/11724/i.html?_nkw=" + some_part_number + "&_armrs=1&LH_Complete=1";

                HtmlWeb hw = new HtmlWeb();
                hw.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)";
                HtmlAgilityPack.HtmlDocument doc = hw.Load(openUrl);

                foreach (HtmlNode nd in doc.DocumentNode.SelectNodes("//tr[@itemprop='offers']"))
                {
                    String title = "";
                    title = Regex.Split(nd.InnerHtml.ToString(), ("title='"))[1].Trim();
                    title = Regex.Split(title, "'")[0].Trim();
                } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-01T21:28:02.283

可能最好和最简单的方法是使用雅虎查询语言 YQL。使用起来很简单。你也可以使用 yql 的 yahoo 管道。去谷歌上查询。你可以从这里开始：http: [//ijaar.com/basic-yql-tutorials/](http://ijaar.com/basic-yql-tutorials/)

还有一些关于堆栈上的屏幕抓取的问题，所以检查一下。

是的，yql 不是唯一的技术，你也可以使用 php、xquery，甚至 python，但在我看来这是最简单的——而且效果很好。

# r - 创建滞后和移动平均线

> ID：13663867
> 
> 赞同：0
> 
> 时间：2012-12-01T21:21:34.477
> 
> 标签：r, lag, moving-average

我有一个数据框，其中包含许多气象和环境变量的日常测量结果。我需要创建 14 天的滞后并计算 3 个不同的连续滞后期的移动平均值（滞后 0 和 1、滞后 2 到 6 和 8 到 14。如果有人建议更好、更短的方法来完成这项任务，我将不胜感激比如下所示。

```
library(gamair) 
library(mgcv) 
data(chicago) 

attach(chicago)
m <- length(tmpd)
t <- 14
LAG_tmpd <- matrix(0,m,t)  

for (j in 1:t)         
{
  for (g in 1:j)      
  {
    LAG_tmpd[g,j]<-NA

  }
  for(i in (j+1):m)   
  {
    LAG_tmpd[i,j]<-c(tmpd[i-j])

  }
}
tmpd_lag01 <- (LAG_tmpd[,1]+LAG_tmpd[,2])/2
tmpd_lag26 <- (LAG_tmpd[,3]+LAG_tmpd[,4]+LAG_tmpd[,5]+LAG_tmpd[,6]+LAG_tmpd[,7])/5
tmpd_lag713 <- (LAG_tmpd[,8]+LAG_tmpd[,9]+LAG_tmpd[,10]+LAG_tmpd[,11]+LAG_tmpd[,12]+LAG_tmpd[,13]+LAG_tmpd[,14])/7 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:48:36.393

您可以使用 来执行此操作`filter`，例如：

```
f <- function(vec, lags) {
    weights <- rep(0, max(lags))
    weights[lags] <- 1
    filter(vec, filter=weights/length(lags), sides=1)
}

tmpd_lag26 <- f(tmpd, c(3, 4, 5, 6, 7)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T01:26:46.800

你可以用更短的时间来复制你的结果

```
 m <- length(tmpd)
    lagmat <- matrix(rep(NA,m*14), nrow=m)
    for (i in 1:14){ lagmat[ (i+1):m, i] <- tmpd[1:(m-i)] }

    tmpd_lag01  <- rowMeans( lagmat[ , 1:2 ] )
    tmpd_lag26  <- rowMeans( lagmat[ , 3:7 ] )
    tmpd_lag713 <- rowMeans( lagmat[ , 8:14] ) 
```

请注意，您所说`tmpd_lag01`的实际上是计算滞后一个时期和滞后两个时期的平均值，我觉得这个符号有点奇怪。如果这实际上不是您想要的，而是您想在移动平均线中包含最新数据，那么初始代码将变为

```
 m <- length(tmpd)
    lagmat <- matrix(rep(NA,m*15), nrow=m)
    for (i in 1:15){ lagmat[ i:m, i] <- tmpd[1:(m-i+1)] } 
```

# xslt - 在元素上使用通配符的 xml xsl xpath 转换

> ID：13663868
> 
> 赞同：0
> 
> 时间：2012-12-01T21:21:37.903
> 
> 标签：xslt, xpath, conditional

我有一些不友好且半生不熟的 xml 文件，类似于以下内容：

```
<root>
<child0><name0>Bob Dylan</name0></child0>
<child1><name1>Daft Punk</name1></child1>
<child2><name2>Nine Inch Nails</name2></child2>
</root> 
```

我希望将每个文件转换为以下内容：

```
<root><children>
<child><name>Bob Dylan</name></child>
<child><name>Daft Punk</name></child>
<child><name>Nine Inch Nails</name></child> 
</children>
</root> 
```

每个文件都没有确定的子文件数量。有些人只有`<child0>`而有些人有`<child0> ... <child10>`。儿童中的元素也没有确定，例如。名称[0]等

所以我想遍历每个孩子（可能使用通配符或结尾，或??）以匹配始终终止孩子和孩子的孩子元素的数字。

这不起作用，但类似于：

```
<xsl:for-each select="child*" >
     <child>
     <name><xsl:value-of select="name[index]"></name>
     </child>
</xsl:for-each> 
```

我看到了很多选择、if 和 match 条件的例子，这些条件处理选择元素内的内容（或通过位置或索引的方式选择元素）......因为这就是它应该完成的方式。

但我有有效但半生不熟的 xml。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T22:56:05.440

这是一个简单的、面向推送的解决方案，可以实现您想要的。请注意，它可以使用 XSLT/XPath 1.0 或 2.0 工作。

**当这个 XSLT：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output omit-xml-declaration="yes" indent="yes" />
  <xsl:strip-space elements="*" />

  <xsl:template match="/*">
    <root>
      <children>
        <xsl:apply-templates />
      </children>
    </root>
  </xsl:template>

  <xsl:template match="*[starts-with(name(), 'child')]">
    <child>
      <xsl:apply-templates />
    </child>
  </xsl:template>

  <xsl:template match="*[starts-with(name(), 'name')]">
     <name>
       <xsl:apply-templates />
     </name>
  </xsl:template>

</xsl:stylesheet> 
```

**...应用于原始 XML：**

```
<root>
  <child0>
    <name0>Bob Dylan</name0>
  </child0>
  <child1>
    <name1>Daft Punk</name1>
  </child1>
  <child2>
    <name2>Nine Inch Nails</name2>
  </child2>
</root> 
```

**...产生了想要的结果：**

```
<root>
  <children>
    <child>
      <name>Bob Dylan</name>
    </child>
    <child>
      <name>Daft Punk</name>
    </child>
    <child>
      <name>Nine Inch Nails</name>
    </child>
  </children>
</root> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:35:35.843

一种简单的方法是在 name() 值上使用正则表达式：

```
<xsl:for-each select="*[matches(name(),'^child\d$')]">
... 
```

# web - 如何允许人们使用他们的 fb 帐户登录到我的网站

> ID：13663870
> 
> 赞同：0
> 
> 时间：2012-12-01T21:21:57.543
> 
> 标签：web, facebook-social-plugins, facebook-login

我正在尝试构建我的第一个应用程序，允许人们使用他们的 fb 帐户登录我的网站。但是，我不断收到此消息

> 您尚未授权任何应用程序与您的 Facebook 帐户进行交互

如何授权应用与 fb 帐户进行交互？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:36:44.230

遵循本[文档中的步骤](https://developers.facebook.com/docs/howtos/login/getting-started/)

如果在那之后您仍然遇到问题，请发布有关您在步骤中的位置的更多详细信息。

# c++ - 嵌入式系统时钟

> ID：13663871
> 
> 赞同：1
> 
> 时间：2012-12-01T21:22:01.153
> 
> 标签：c++, c, time, embedded

我正在开发一个项目，我需要支持具有 ms 粒度的日历 + 时钟。我设法配置了芯片的 RTC 来帮助我计时，但我很难找到正确的数据类型来显示时间。

我一直使用`time_t`（Unix epoch），但是它是基于秒的，所以它不会起作用。怎么样`struct timeval`？似乎`struct tm`在演示文稿（asctime）的上下文中不支持此结构。

在嵌入式系统中表示时间的首选方式是什么？

注意：这个系统连接了一个基于java的后端服务器，需要与它同步时间，所以我正在寻找一种可以在多种语言中开箱即用的结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:51:38.183

您对毫秒粒度的需求以及与基于 Java 的交互的需求都表明，自纪元以来的 64 位时间将是一个合适且直接的选择。

今天的大多数编译器都有 64 位类型。如果不是，您可以将其作为两个 32 位类型的结构以本地端序适当的顺序处理，并放入代码来处理进位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T10:41:03.000

有毫秒和毫秒，一个很容易，另一个很难。

我们运行一个 1ms 的硬件定时器中断循环来处理必须在实体光栅上运行的东西（例如电机控制）。我们从这个例程中增加一个全局的 32 位“滴答”值，然后可以用来对需要以亚秒间隔发生的事情进行计时（例如，每 50 毫秒轮询一次）。

这与使用微型硬件计时器作为计时参考不同，在这样的系统中，任何东西的准确性都存在问题 - 从时钟晶体的准确性到所有各种预分频器、中断延迟等。现在，我们不在乎我们的电机控制程序是每秒运行 999 次还是每秒 1001 次，或者我们是否每 49.5 毫秒而不是 50 毫秒轮询一次引脚的状态，因为它已经足够接近了，重要的是它发生在及时。在 24 小时的过程中，我们最终可能会收到比一天中毫秒数还多的“滴答声”，这会导致手表很糟糕。

例如 - 时钟预分频器计数到 N 然后复位，还是 n-1 并复位？它是立即重置还是需要一个时钟周期？这种细节在微观上让人头疼。

我会使用 RTC 作为时间参考，然后可能将 ms 计数器与秒的滴答声同步（每 1Hz RTC 中断将“滴答声”重置为 0），这意味着您的 ms 值只会非常相对于 RTC 略微偏离。您甚至可以直接读取 RTC 的输入时钟寄存器，以提取运行 RTC 的更快时钟（通常为 32.768kHz 时钟）。我们这样做是为了从 1kHz 定时器的预分频器时钟寄存器中获取微秒值。它并不完美，我们不使用它来保持时间，仅用于捕获 sub-ms 事件。

或者，看看你的应用程序是否真的*需要*毫秒，或者你是否可以在 100 毫秒内编出一个数字并报告，这不像 JS 是原子钟级计时明智的 - 它甚至不是米老鼠 -手表级。如果你真的需要这种准确性，那你就错了。

# linux - pThread 函数参数，向每个线程发送相同的值，同时等待其他内容

> ID：13663872
> 
> 赞同：0
> 
> 时间：2012-12-01T21:22:09.323
> 
> 标签：linux, pthreads, pass-by-reference

我正在向`sturct dataBlock`我的线程发送一个，其中包含`a pointer`相同的 listRoot（对于所有线程）、一个`int indexInForLoop`和一个`int listSize`；列表中的节点有一个 int 值，它是要处理的 ash 和一个 int worker，它是 nrOfListElements % nrOfWorkers(Threads)。但不知何故，我发送给每个线程的结构是相同的，但它不应该每个都有 1 个不同的 int 变量和 indexFromForLoop。我究竟做错了什么？

终端输出：

```
node #1 worker: 1  value: 86
node #2 worker: 0  value: 77
node #3 worker: 1  value: 15
node #4 worker: 0  value: 93
node #5 worker: 1  value: 35
? List got populated
workersInput: 2
in for, ret= 0
in for, ret= 0
* Thread start:             id: 3067579200^
forID_ 1 
->val: 86   
valid for sqrt 
* Thread start:             id: 3075971904^
forID_ 1 
->val: 86   
valid for sqrt 
```

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#include <unistd.h>
#include <math.h>   

#define workTime 5
#define workersLimitNr 3

struct dataBlock{
    struct node *root;
    int listSize;
    int forIndex;
};

struct node { // std linked list node
    int value;
    int worker;
    struct node *next;
};

int slots = 0; // only 3 threads are allowed to access the list
int availableCheck(){   // check if thread can acces the list
    if(slots < 3) return 0;
    else return -1;
}

pthread_mutex_t mutp = PTHREAD_MUTEX_INITIALIZER;   //condvar mutex
pthread_cond_t  condvar = PTHREAD_COND_INITIALIZER;   //condvar

void * worker( void *data ){
    struct dataBlock *inData = (struct dataBlock *) data;
    struct node *root = inData->root;
    int listSize =  inData->listSize;
    int forIndex = inData ->forIndex;

    printf( "* Thread start:            ^\n"); 

    pthread_mutex_lock( &mutp );
    if(availableCheck() < 0){
        printf( " ^^^ List not available yet... \n" ); 
        pthread_cond_wait( &condvar, &mutp );
    } 
    struct node *it = root;
    printf("forID_ %d \n", forIndex);
    while(it->next != NULL){
        if(forIndex == it->worker){
            printf("valid for sqrt \n");
            if(it->value > 2){
                sqrt(it->value);
                break;
            }
        }
        it = it->next;
        printf("->val: %d   \n", it->value);
    }

    pthread_cond_signal( &condvar ); // 
    pthread_mutex_unlock( &mutp ); 
    return NULL;
}

int main( int argc, char *argv[] ){
    if ( argc != 3 ){
        printf( "Programm must be called with \n NR of elements and NR of workers! \n " );
        exit( 1 );
    }

    int i;
    struct node *root;
    struct node *iterator;  

//prepare list for task
    int listSize = atoi(argv[1]);
    int nrWorkers = atoi(argv[2]);
    root = malloc(sizeof( struct node) );

    root->value = rand() % 100;
    root->worker = 0;
    iterator = root;

    for( i=1; i<listSize; i++ ){
        iterator->next = malloc(sizeof(struct node));
        iterator = iterator->next;
        iterator->value = rand() % 100;
        iterator->worker = i % nrWorkers;
        printf("node #%d worker: %d  value: %d\n", i, iterator->worker,iterator->value);
    }
    printf("? List got populated\n");

// Create all threads to parse the link list
    int ret;    
    printf("workersInput: %d\n",nrWorkers);

    pthread_t w_thread;
    pthread_t* w_threads = malloc(nrWorkers * sizeof(w_thread));

    struct dataBlock *data = malloc(sizeof(struct dataBlock));
    data->root = root;
    data->listSize = listSize;

    for( i=0; i < nrWorkers; i++ ){ 
        data->forIndex = i;
        ret = pthread_create ( &w_threads[i], NULL, worker, (void *) data );
        if( ret ) {
            perror("Thread creation fail");
            exit(2);    
        }   
        printf("in for, ret= %d\n",ret);
    } 

    for ( i = 0; i < nrWorkers; i++){
        pthread_join(w_threads[i],NULL);
    }

    free(root);
    free(iterator);
    return 0;
} 
```

编辑：我使用了 pthread_self() 并确认存在不同的威胁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:32:56.790

使用

```
data->forIndex = i; 
```

您覆盖以前的值。并且由于您只有一个`dataBlock`线程，因此每个线程都会指向同一个地方。而且由于创建线程并不**意味着**“在执行循环中的下一条语句之前启动它”，因此每个线程看到的值纯属运气。

您必须`dataBlock`为每个线程分配一个，并且`dataBLock`只将每个线程分配给一个线程。

# c# - Visual Studio：如何将代码模板添加到项目中

> ID：13663877
> 
> 赞同：1
> 
> 时间：2012-12-01T21:22:46.310
> 
> 标签：c#, visual-studio-2010

我想创建一个功能，允许我自动将一些相关文件添加到我的 C# 项目中。我想创建一个基于模板的新表单，并创建一个 XML 文件并将其添加到项目中的单独子目录中。我该怎么做呢？我看到 Visual Studio 2008 中提供了向导、加载项、宏等，但我不知道哪个最适合我的需要。我认为一个巫师会起作用，但这可能是矫枉过正。我只想消除从同一项目中现有文件集中复制的重复性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T23:02:56.867

您可以使用 VS2010 中的菜单 File|Export Template... 将单个项目项导出为压缩模板。要创建包含多个文件的模板，您可以导出第一个项目，然后将其他项目添加到生成的模板 zip。您还需要编辑 zip 中的 .vstemplate 文件以包含其他项目。

例如，我从现有项目中导出了一个表单，然后添加了一个 xml 文件。生成的 zip 文件包含文件

__TemplateIcon.ico
Form1.cs
Form1.Designer.cs
Form1.resx
MyTemplate.vstemplate
xmldata.xml

.vstemplate 文件包含以下 xml：

```
<VSTemplate Version="3.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="Item">
  <TemplateData>
    <DefaultName>TwoFileTemplate</DefaultName>
    <Name>TwoFileTemplate</Name>
    <Description>Test template</Description>
    <ProjectType>CSharp</ProjectType>
    <SortOrder>10</SortOrder>
    <Icon>__TemplateIcon.ico</Icon>
  </TemplateData>
  <TemplateContent>
    <References />
    <ProjectItem SubType="" TargetFileName="xml\$fileinputname$.xml" ReplaceParameters="true">xmldata.xml</ProjectItem>
    <ProjectItem SubType="Form" TargetFileName="$fileinputname$.cs" ReplaceParameters="true">Form1.cs</ProjectItem>
    <ProjectItem SubType="" TargetFileName="$fileinputname$.Designer.cs" ReplaceParameters="true">Form1.Designer.cs</ProjectItem>
    <ProjectItem SubType="" TargetFileName="$fileinputname$.resx" ReplaceParameters="true">Form1.resx</ProjectItem>
  </TemplateContent>
</VSTemplate> 
```

更新 zip 文件后，将其移动到文件夹 ...\Visual Studio 2010\Templates\ItemTemplates。

新模板现在应该显示在 VS2010 的“添加新项目”对话框中。它将使用您在将新项目添加到项目时指定的任何名称添加表单和 xml 文件，并将 xml 文件放在名为“xml”的目录中。如果您想要一个或另一个文件的固定名称，您可以`$fileinputnam$`在 .vstemplate 文件中替换为所需的名称。

编辑 - 如果您想要一个表单或其他类文件的固定项目名称，您还需要打开代码模板并替换`$safeitemname$`为所需的名称。

# android - 如何从自定义对话框中获取数据

> ID：13663878
> 
> 赞同：6
> 
> 时间：2012-12-01T21:22:53.527
> 
> 标签：android, dialog

我的代码中有一个对话框，当我单击主活动中的一个按钮时，它会弹出，这个对话框是这样的：

![在此处输入图像描述](../Images/b7349728548dc291cf4e52c52092a48b.png)

我想将“输入数字”和“输入名称”测试框中的字符串数据放到主活动中的 viewText 中，我不知道如何传递这个值。我弹出对话框的部分代码是这样的：

> btnstart.setOnClickListener(new OnClickListener() {

```
 @Override
        public void onClick(View v) {
            // Auto-generated method stub
            final Dialog dialog = new Dialog(Main0.this);
              dialog.setContentView(R.layout.number);
              dialog.setTitle("Save New Number");
              dialog.setCancelable(true);   
              dialog.show();

        }
    }); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-01T21:28:15.120

这应该有效：

```
Button saveButton = (Button)dialog.findViewById(R.id.saveButton);
saveButton.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View arg0) {
        String name = ((EditText)dialog.findViewById(R.id.nameText)).getText().toString();
        String number = ((EditText)dialog.findViewById(R.id.numberText)).getText().toString();
    }
}); 
```

（将其添加到您的`onClick`方法中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:36:17.900

如果要显示文本的 textView 位于弹出对话框的同一个 Activity 中，请定义如下字符串：

```
 String text=""; 
```

然后，在 xml 定义的对话框布局中获取您的 textView（在 dialog.show() 之前的 onClick 内）。

```
 TextView yourTextView = (TextView)dialog.findViewById(YourTextViewId);
   text = yourTextView.getText(); 
```

之后，您可以将文本设置为要显示输入的 TextView：

```
 yourShowView.setText(text); 
```

# php - 更改字符串的各个部分

> ID：13663882
> 
> 赞同：1
> 
> 时间：2012-12-01T21:23:06.403
> 
> 标签：php

我正在制作一个命令转换类型系统，这就是我正在使用的系统，例如，如果一个字符串是：

```
if (strcmp(cmdtext, "/COMMAND", true) == 0) 
```

我想替换它，但是将字符串 COMMAND 保留在变量中，然后将其插入到该字符串中：

```
CMD:COMMAND(playerid, params[]) 
```

我将如何在 PHP 中执行此操作我尝试使用 str_replace() 和 sscanf() 的混合物

如果字符串类似于

```
if (strcmp(cmdtext, "/COMMAND", true) == 0)
    {
        Functions
        return 1;
    } 
```

括号和其中的所有内容都将是一个常量，而 COMMAND 将是一个变量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:53:52.457

在这种情况下，我会使用一些正则表达式。

我假设所有命令都是已知的。

```
$known_commands = "START|STOP|QUIT";
$out=preg_replace("#/($known_commands)#i", 'CMD:\1(playerid, params[])', '/START');
//$out contains string(29) "CMD:START(playerid, params[])" 
```

# php - 如何使用 html 创建搜索功能

> ID：13663885
> 
> 赞同：0
> 
> 时间：2012-12-01T21:23:15.850
> 
> 标签：php, html

我有一个 120mb 的文本文件，其中包含以下形式的数据

```
(entry name) | (entry data)
(entry name2) | (entry data2)
(entry name3) | (entry data3>) 
```

等等几十万个条目。每个条目由返回分隔

我想在 html 中创建一个搜索引擎，它根据条目名称和数据扫描文本文件以查找匹配项。

例如：如果我在搜索栏中输入或输入任何字符串，则 html 页面应返回`entry name2`：`entry name2``entry data2`

> 的条目数据`entry name2`是`entry data2`

它还应该返回其他条目的匹配项，例如`entry name3`输入到搜索栏中的字符串是否是`entry name2`和的子集`entry name3`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:27:59.907

HTML 是一种标记语言，而不是一种编程语言。您不能在 HTML 中执行此操作。您必须使用 PHP（服务器端）或 Javascript（客户端）之类的东西。此外，您肯定不想将所有这些数据都存储在一个文本文件中。具有这么多条目的线性搜索可能需要很长时间。使用某种数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:28:14.323

您无法仅使用`HTML`.

您要求的是仅适用于服务器端语言的功能（特别是如果我们谈论的是动态列表）。您应该熟悉服务器端语言（PHP 等）并学习如何使用它们。

# javascript - 设计一个javascript模块，这个参考

> ID：13663889
> 
> 赞同：1
> 
> 时间：2012-12-01T21:23:50.380
> 
> 标签：javascript

我正在学习 javascript 模块以及如何编写它们。我遇到了一个问题，即我不能 100% 确定我的模式是正确的。任何可能让我以后更容易的评论都会很好，但我的问题是我不确定如何正确使用原型。

我像这样使用我的模块：

```
 var cm = CodeMirror.fromTextArea(document.getElementById("code"), {
            lineNumbers: true,
            matchBrackets: true,
            mode: "text/x-csharp"
        });
        var adapt = new $.codeMirrorSignalRAdapter(cm, $.connection.codeHub); 
```

但在我的adapter.prototype hubChange 中，this.silent 是未定义的。我想认为 var adapter = function(cm,hub) 是构造函数，我不知道如何从原型函数访问属性 self.[cm,hub,silent] 。

```
(function ($, window) {
    "use strict";

    if (typeof ($) !== "function") {
        // no jQuery!
        throw new Error("CodeMirrorAdapter: jQuery not found. Please ensure jQuery is referenced before the SignalR.js file.");
    }
    if (typeof ($.signalR) !== "function") {
        throw new Error("CodeMirrorAdapter: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/hubs.");
    }

    var adapter = function (cm, hub) {
        var self = this;
        self.cm = cm;
        self.hub = hub;
        self.silent = false;

        cm.on("change", function (_, change) { self.onChange(change); });
        hub.client.Change = self.hubChange;

        return self;
    };

    adapter.fn = adapter.prototype = {
        init: function (cm, hub) {

        },
        onChange: function (change) {
            if (!this.silent) {
                this.hub.server.change(change)
                        .done(function () { })
                        .fail(function (ee) { alert(ee) });
            }
        },
        hubChange: function (change) {
            alert(this.silent);
            this.silent = true;
            this.cm.replaceRange(change.text[0], change.from);
            this.silent = false;
        },
    };

    $.codeMirrorSignalRAdapter = adapter;
}(window.jQuery, window)); 
```

除了这个关键字的问题之外，模块设计看起来还不错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:06:34.543

的值`this`可以是 5 个可能选项中的任何一个。阅读 MDN 上的这篇文章以获取更多信息：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)

在您的特定情况下`hub.client.Change = self.hubChange;`，您正在注册`hubChange`为处理程序。问题是当处理程序被调用时，没有代码可以确保`this`已设置为正确的适配器对象。

我们如何确保这一点？

```
hub.client.Change = function () { self.hubChange.apply(self, arguments);}; 
```

`apply`你可以在这里阅读更多关于[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)

我们所做的与您对`cm.on("change")`绑定所做的类似。

**对代码的思考**

您的构造函数以`return self;`不需要的结尾。当函数作为构造函数调用时，即使用`new`关键字，它将隐式返回一个新实例。当函数在没有`new`关键字的情况下被调用时，它将返回函数返回的任何内容，在这种情况下，它不会是一个新实例。这将是任何`this`设置。它很可能会返回`window`。建议，删除该行。这样，如果您不小心在没有 new 的情况下调用它，您将返回 undefined。

# iphone - 除了我的实现之外，还有更好的方法可以将 UIBarButtonItem 从刷新更改为停止 UIWebView 吗？

> ID：13663892
> 
> 赞同：1
> 
> 时间：2012-12-01T21:23:54.790
> 
> 标签：iphone, objective-c, ios, uiwebview, uitoolbar

几年来我一直这样做的方式是简单地创建两个工具栏，并在加载 UIWebView 时将一个或另一个设置为隐藏。我所有的工具栏和 barbutton 项目都是在 IB 中创建的。如果我可以在没有这种“黑客”的情况下使我的实现更小，我感谢提供的任何帮助。

这是我正在使用的代码：

```
#import "Web.h"

@interface  Web()

@property (nonatomic, strong) IBOutlet UIWebView *webView;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *refreshButton;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *stopButton;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *backButtonRefreshToolbar;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *forwardButtonRefreshToolbar;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *backButtonStopToolbar;
@property (nonatomic, strong) IBOutlet UIBarButtonItem *forwardButtonStopToolbar;
@property (nonatomic, strong) IBOutlet UIToolbar *toolbarStop;
@property (nonatomic, strong) IBOutlet UIToolbar *toolbarRefresh;

@end

@implementation Web

- (void)webViewDidStartLoad:(UIWebView *)webView
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    self.toolbarStop.hidden = NO;
    self.toolbarRefresh.hidden = YES;
}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
    self.toolbarStop.hidden = YES;
    self.toolbarRefresh.hidden = NO;
    [self actualizeButtons];
}

- (void)actualizeButtons
{
    self.backButtonRefreshToolbar.enabled = [self.webView canGoBack];
    self.forwardButtonRefreshToolbar.enabled = [self.webView canGoForward];
    self.backButtonStopToolbar.enabled = [self.webView canGoBack];
    self.forwardButtonStopToolbar.enabled = [self.webView canGoForward];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:31:40.873

是的。使用单个`UIToolbar`实例，并在需要交换显示的项目时调用其`setItems:animated:`方法。`animated:NO`这应该具有与显示/隐藏一对工具栏相同的视觉效果。

当标题需要更改时，您也可以只设置`possibleTitles`相关属性。`UIBarButtonItem`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T22:48:44.187

这是我根据上述帮助得出的结论：

```
@property (nonatomic, strong) IBOutlet UIToolbar *webToolbar;
@property (nonatomic, strong) UIBarButtonItem *backButton;
@property (nonatomic, strong) UIBarButtonItem *forwardButton;
@property (nonatomic, strong) UIBarButtonItem *refreshButton;
@property (nonatomic, strong) UIBarButtonItem *stopButton;
@property (nonatomic, strong) UIBarButtonItem *flexibleItem;

- (void)toolbarButtons
{
    self.backButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"UIButtonBarArrowLeft.png"] style:UIBarButtonItemStyleBordered target:self action:@selector(goBack)];

    self.forwardButton = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"UIButtonBarArrowRight.png"] style:UIBarButtonItemStyleBordered target:self action:@selector(goForward)];

    self.backButton.enabled = [self.webView canGoBack];
    self.forwardButton.enabled = [self.webView canGoForward];

    self.flexibleItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace
                                                                  target:nil
                                                                  action:nil];

    self.refreshButton = [[UIBarButtonItem alloc]
                      initWithBarButtonSystemItem:UIBarButtonSystemItemRefresh
                      target:self action:@selector(refreshWebView)];

    self.refreshButton.style = UIBarButtonItemStyleBordered;

    self.stopButton = [[UIBarButtonItem alloc]
                      initWithBarButtonSystemItem:UIBarButtonSystemItemStop
                      target:self action:@selector(stop)];

    self.stopButton.style = UIBarButtonItemStyleBordered;

    if(self.webView.loading)
    {
        NSArray *items = [NSArray arrayWithObjects: self.backButton, self.forwardButton, self.flexibleItem, self.stopButton, nil];
        [self.webToolbar setItems:items animated:NO];
    }
    else
    {
        NSArray *items = [NSArray arrayWithObjects: self.backButton, self.forwardButton, self.flexibleItem, self.refreshButton, nil];
        [self.webToolbar setItems:items animated:NO];
    }
} 
```

# visual-studio-2010 - 未安装指定平台工具集 (v110)

> ID：13663898
> 
> 赞同：60
> 
> 时间：2012-12-01T21:24:16.997
> 
> 标签：visual-studio-2010, visual-studio-2012

我有一个最初使用 VS2010 创建的解决方案。当我使用 VS 2012 打开它时，它要求我进行一些转换，我同意了。现在我正在使用 VS 2010 再次打开解决方案，当我尝试构建它时出现错误：

> 错误 MSB8008：指定的平台工具集 (v110) 未安装或无效。请确保选择了受支持的 PlatformToolset 值

我该如何解决？例如，有没有办法`platform toolset`再次将其更改为 v100？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-04-24T15:48:10.197

是的，确实是：

*   右键项目
*   选择属性
*   选择配置属性
*   一般的
*   平台工具集

当您进入平台工具集时，单击`v110`右侧列中的值。您将看到一个下拉菜单，您可以在其中选择`v90`、`v100`或`inherit`。当然`v100`是正确答案。一旦`v100`被选中，我不相信您可以`v110`从 VS 2010 中返回。您必须再次在 VS 2012 中打开才能将其移回`v110`.

# c - _exit 和 return 的区别

> ID：13663900
> 
> 赞同：0
> 
> 时间：2012-12-01T21:24:39.867
> 
> 标签：c, fork, exit

考虑以下代码

```
 int     glob = 6;       /* external variable in initialized data */

    int
    main(void)
    {
        int     var;        /* automatic variable on the stack */
        pid_t   pid;

        var = 88;
        printf("before vfork\n");   /* we don't flush stdio */

        if ( (pid = vfork()) < 0)
            err_sys("vfork error");
        else if (pid == 0) {        /* child */
            glob++;                 /* modify parent's variables */
            var++;
            _exit(0);               /* child terminates */
        }

        /* parent */
        printf("pid = %d, glob = %d, var = %d\n", getpid(), glob, var);
        exit(0);
    } 
```

这是一个解释如何使用 vfork 系统调用的示例。如果我不使用 _exit 而是使用 return，我会得到不同的输出值。返回不等于调用_exit吗？为什么不？

# php - 保持登录功能 php

> ID：13663902
> 
> 赞同：2
> 
> 时间：2012-12-01T21:25:04.623
> 
> 标签：php, security

我正在制作一个允许用户保持登录状态的 php 页面，并且我正在检查用户当前的 IP 与存储在 sql 表中的 IP。

我将用户 ID 存储在 cookie 中而不是 ip 中。

我还应该做哪些其他检查？因为我认为现在 IP 还不够。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:34:18.427

它依赖于 cookie 使用户保持登录您的应用程序或网站。用户的 IP 可能会发生变化，因此无法获得此功能。它只是写cookie，然后在登录时读取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T21:40:21.167

您可能希望将用户详细信息存储在会话中。Cookie 相对不安全，可用于提权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-15T15:53:15.090

散列会话 cookie 有利于保持用户登录。这是因为 cookie 保留在用户的计算机上，并允许它访问会话数据。散列它增加了一层安全性。

用户的 IP 地址不如 cookie 或会话变量好。一方面，它可以改变（就像智能手机从一个塔的范围移动到另一个塔一样）。另一方面，它可以被共享（就像在同一个无线路由器上的多个用户一样）。最后，IP 地址可以被欺骗。

另一方面，会话只会在浏览器打开时持续（取决于服务器端设置的会话超时）。在这种情况下，会话建立一个会话 cookie，允许浏览器指向服务器上的会话数据。

会话数据更加安全，因为在浏览器会话期间，只有一个会话 cookie 是驻留在用户机器上的所有内容。这样您就可以在服务器上存储更敏感的数据（用户名、个人身份信息或帐户数据）。

访问会话数据的唯一方法是通过该用户的一个会话 cookie，它通常是一串很长的随机字符。散列它使得解读变得非常困难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-09T09:10:38.043

IP 可以更改，因此使用 IP 来“保持登录”不是一个好主意。最好的方法是在 cookie 中使用 API 密钥。这种方式允许用户即使在更改 IP 时也可以登录（例如当他们连接到代理时）。请参阅下面的问题： [“让我登录” - 最好的方法](https://stackoverflow.com/questions/1354999/keep-me-logged-in-the-best-approach)

# c++ - 数组是如何分配的？

> ID：13663905
> 
> 赞同：0
> 
> 时间：2012-12-01T21:25:27.853
> 
> 标签：c++

Noob在这里，我有2个问题。

1）当创建这样一个int a[10]这样的数组时，系统如何为数组设置内存？即系统是否连续分配十个 1 字内存（在堆中？）。char a[10] 呢？还是用户定义的类型？

2）动态分配呢？如 int *a = new int[10]; 这个数组在内存中是如何设置的？（与问题 1 类似的问题）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T21:33:50.850

C++ 标准不保证这种行为——它甚至没有提到堆栈或堆。

但通常，当您调用函数时，*堆栈帧*会被推送到足够大的堆栈以包含该函数的所有自动变量（以及其他对象，例如其返回值）。因此，如果您考虑该功能`foo`：

```
void foo() {
  int x;
  std::string str;
} 
```

当这个函数被调用时，栈顶被推上去，所以有足够的空间存放 a`int`和 a `std::string`。这些类型的大小是实现定义的，标准对它们进行了一些限制，但您可以将它们视为`sizeof(int)`字节`sizeof(std::string)`。

现在，当您的函数中有一个数组时，例如`int a[10]`，该函数的堆栈帧将包含足够的空间 10`int`秒或`10*sizeof(int)`字节。此帧大小直接烘焙到您的可执行文件中 - 当调用该函数时，堆栈将增加该大小。

当你做动态分配时，比如`int* a = new int[10]`，你是在堆中分配 10 `int`s 的空间，或者`10*sizeof(int)`，。但是，您已将堆栈帧增加了一些量，即`sizeof(int*)`. 指针对象本身存储在堆栈上，但`int`它指向的 s 在堆上。

`std::string`请注意，在第一个示例中，您可能想知道如果 an可以具有可变长度，如何将堆栈帧大小烘焙到可执行文件中。这是因为`std::string`对象本身具有固定大小，`sizeof(std::string)`但很可能会进行某种动态分配来管理其内部表示 - 这种内部表示将在堆上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T21:30:35.160

1.  您将`10 * sizeof(type)`在堆栈上获得一个字节存储块（假设没有发生溢出），因此内存中的每个元素都是连续的并且大小相同，这就是数组元素的指针运算有效的原因。一旦超出范围，此内存将被释放。请注意，不一定会为您初始化此内存。在 的情况下`int[10]`，它将包含垃圾，而不是 0。

2.  它是一样的，但元素在免费存储，而不是堆栈上。`new`如果无法分配内存，则抛出异常。`new[]`也可以超载。一旦`delete[]`被调用，这个内存就会被释放，这就是为什么类似的东西`std::vector`通常是一个更好的选择，因为当向量超出范围时它会释放它，在其他一些方面使用它更容易。

# c++ - C++ std::map 每次调用类对象时如何获取新的地图对象

> ID：13663906
> 
> 赞同：0
> 
> 时间：2012-12-01T21:25:55.540
> 
> 标签：c++, stdvector, stdmap

我有一个问题，每次在 main 中调用更新函数时，我都需要将地图对象插入到向量（大小为 2）中。下面是该类的代码片段。

### 缓存.hxx

```
#ifndef CACHECOS_H
#define CACHECOS_H

#include <iostream>
#include <string>
#include <map>
#include <vector>

using namespace std;

class Cache
{
    public:
        static int index;
        static vector<map<string, map<string, string> > > cacheVector;
    protected:
        typedef map<string, string> innerMap;
        typedef map<string, innerMap> cacheMap;
        cacheMap cache_Map;
};
#endif 
```

### CacheReader.hxx

```
#ifndef CACHEREADER_H
#define CACHEREADER_H

#include "Cache.hxx"

class CacheReader : public Cache
{
    public:
        CacheReader();
        ~CacheReader();
        void readCache();
};
#endif 
```

### CacheWriter.hxx

```
#ifndef CACHEWRITER_H
#define CACHEWRITER_H

#include "Cache.hxx"

class CacheWriter : public Cache{
    public:
        CacheWriter();
        ~CacheWriter();
        void updateCosCache();

    private:
        time_t lastUpdated;
};

#endif 
```

### CacheWriter.cxx

```
#include "CacheWriter.hxx"
#include <sstream>

using namespace std;

int Cache::index = -1;
vector<map<string, map<string, string> > >Cache::cacheVector;

CacheWriter::CacheWriter()
{}

CacheWriter::~CacheWriter()
{}

void CacheWriter::updateCosCache()
{
    cache_Map.clear(); //Is this required
    //First element in the outer map
    cache_Map.insert(make_pair("test1", innerMap()));
    //Write elment in inner map
    cache_Map["test1"].insert(make_pair("mailstore", "host1"));
    cache_Map["test1"].insert(make_pair("mailboxid", "100"));
    cache_Map["test1"].insert(make_pair("emailId", "test@test.com"));
    cache_Map["test1"].insert(make_pair("poplogin", "test"));
    lastUpdated = time(NULL);
    cache_Map.insert(make_pair("lastUpdated", innerMap()));
    stringstream ss;
    ss << lastUpdated;
    cache_Map["lastUpdated"].insert(make_pair("timeStamp", ss.str()));
    if(index == -1) {
        cout<<"Cuurent index is "<<index<<endl;
        cacheVector.push_back(cache_Map);
        //cacheVector.insert(cacheVector.begin() + index +1, cache_Map);
        index = 0;
    } else if(index == 0) {
        cout<<"Cuurent index is "<<index<<endl;
        cacheVector.insert(cacheVector.begin() + 1, cache_Map); // insert new map in the vector.
        index = 1;
    } else {
        cout<<"Cuurent index is "<<index<<endl;
        cacheVector.insert(cacheVector.begin() + 0, cache_Map );
        index = 0;
    }
} 
```

### CacheReader.cxx

```
#include "CacheReader.hxx"

CacheReader::CacheReader()
{}

CacheReader::~CacheReader()
{}

void CacheReader::readCache()
{
    cache_Map = cacheVector[index];
    map<string, innerMap>::iterator cache_Mapit;
    map<string, string>::iterator innerIter;
    for(cache_Mapit = cache_Map.begin(); cache_Mapit != cache_Map.end(); ++cache_Mapit) {
        cout << "\n\nNew element\n" <<(*cache_Mapit).first<<endl;
        for(innerIter = (*cache_Mapit).second.begin(); innerIter != (*cache_Mapit).second.end(); ++innerIter) {
            cout << (*innerIter).first << " => " << (*innerIter).second << endl;
        }
    }
} 
```

### 测试.cxx

```
#include "Cache.hxx"
#include "CacheReader.hxx"
#include "CacheWriter.hxx"

int main()
{
    CacheWriter cacheWriter;
    CacheReader cacheReader;

    for(int i = 0; i < 5; i++) {
        cacheWriter.updateCosCache();
        cacheReader.readCache();
    }
} 
```

以下是上述代码的输出。

$ ./测试

```
Cuurent index is -1

New element
lastUpdated
timeStamp => 1354396680

New element
test1
emailId => test@test.com
mailboxid => 100
mailstore => host1
poplogin => test
Cuurent index is 0

New element
lastUpdated
timeStamp => 1354396680

New element
test1
emailId => test@test.com
mailboxid => 100
mailstore => host1
poplogin => test
Cuurent index is 1

New element
lastUpdated
timeStamp => 1354396680

New element
test1
emailId => test@test.com
mailboxid => 100
mailstore => host1
poplogin => test
Cuurent index is 0

New element
lastUpdated
timeStamp => 1354396680

New element
test1
emailId => test@test.com
mailboxid => 100
mailstore => host1
poplogin => test
Cuurent index is 1

New element
lastUpdated
timeStamp => 1354396680

New element
test1
emailId => test@test.com
mailboxid => 100
mailstore => host1
poplogin => test 
```

正如您从上面的输出中看到的那样，即使我试图获取一个新的地图对象，以前的值也会被覆盖（**时间戳**相同），而我希望应该存在两个不同的地图对象，直到发生索引交换以便之前存在的价值。有什么方法可以让我每次都获得新的地图对象，这样以前的索引值就不会被覆盖。在这方面的任何指针都会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:49:01.813

我认为问题在于您使用 cacheVector.insert 而不是 cacheVector[]。每次调用 insert 方法都会将向量大小增加一。这可能不是您所期望的。

# google-chrome - 将消息从扩展程序发送到选项卡

> ID：13663907
> 
> 赞同：0
> 
> 时间：2012-12-01T21:26:13.780
> 
> 标签：google-chrome, google-chrome-extension, google-chrome-app

我在将消息从 Chrome 扩展程序 (popup.html) 发送到在选定选项卡中注入的脚本时遇到问题。popup.html 中的代码如下：

```
alert("sending MSG");
chrome.tabs.sendMessage(null, {greeting: "hello"}, function(response) {
console.log(response.farewell); 
});
alert("MSG send"); 
```

问题是只显示“正在发送消息”警报，但没有显示第二个警报“已发送消息”。就像它在阻止代码一样。

即使我使用此功能：

```
chrome.tabs.getSelected(null, function(tab) {  
chrome.tabs.sendMessage(tab.id, {greeting: "hello"}, function(response) { 
console.log(response.farewell); alert("MSG sent _ in");
                                         });
                        });
alert("MSG send _ out"); 
```

在这里我遇到了同样的问题：显示了“MSG send _ out”，但没有显示“MSG send _ in”。如果有人对这个问题有任何想法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T00:00:13.057

如果您查看弹出窗口检查器，您会看到您的弹出窗口将出现运行时错误，因此最后一个`alert`不起作用。

解决方案很简单，你应该使用，`chrome.extension.sendMessage`而不是`chrome.tabs.sendMessage`，

```
alert("sending MSG");
chrome.extension.sendMessage(null, {greeting: "hello"}, function(response) {
    console.log(response.farewell); 
});
alert("MSG send"); 
```

# c++ - 如何对齐堆栈上的缓冲区？

> ID：13663911
> 
> 赞同：5
> 
> 时间：2012-12-01T21:26:59.273
> 
> 标签：c++, gcc, embedded

我正在尝试实现一个与其大小对齐的内存缓冲区，这样我就可以使用 DMA 控制器的模特性来实现一个环形缓冲区。我知道我可以用 memalign 做到这一点，但我想知道是否可以在堆栈上这样做，因为到目前为止我已经能够**避免 dynamic memory**。我使用的是 GCC 4.4.1，我不关心可移植性（嵌入式系统）。

我想做类似的事情：

```
template<uint16_t num_channels, uint16_t buffer_size>
class sampler {
    __attribute__((aligned(buffer_size * num_channels * 2)))
    uint16_t buffer[buffer_size][num_channels];
}; 
```

但当然 GCC 不会接受非常量对齐（并且似乎表明对齐 > 8 可能无论如何都不会得到尊重）。

我想我可以使用 C++0x alignas() 来实现这一点，但它似乎直到 4.8 版才出现在 GCC 中。

我想一个选择可能是将缓冲区的大小加倍，但这似乎浪费了一堆空间（我计划尝试将大部分设备内存用于此缓冲区）。也许我应该放弃并使用动态内存。memalign 在浪费空间方面会相对有效吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:33:04.233

您不需要将存储空间的大小增加一倍，您只需要添加它 - 基本上与幕后所做`(alignment - 1)`的相同。`memalign`对于两个对齐的幂：

```
char buf[size + (alignment -1)];
char *aligned = (char*)((intptr_t)buf + (alignment - 1) & ~intptr_t(alignment - 1)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T23:51:01.933

自从我使用链接器命令文件以来已经有很长时间了，但我认为它会像这样。

创建文件 buffer.cpp

```
char buffer[ BUFFER_SIZE ]; 
```

目标文件具有名为 .bss（用于未初始化数据）、.data（用于初始化数据）和 .text（用于可执行代码）的部分。buffer[] 将进入 .bss，因为它没有被初始化。

所以像这样的（gnu）链接器文件应该可以解决问题

```
SECTIONS {
   .bss 0x0  : {
        buffer.o(.bss)
        *(.bss)
    }
   .data : {
        *(.data)
    }
   .text : {
        *(.text)
    }
} 
```

0x0 告诉链接器在地址 0x0 加载缓冲区 []。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T21:33:46.243

您能否创建一个大于 的缓冲区`buffer_size`，然后计算其中的偏移量？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T21:38:33.503

如果您的嵌入式系统具有内存管理单元，则无需担心明智地使用动态内存，尤其是在每次运行只分配一次的情况下。

如果它没有 MMU，您可以考虑使用链接器映射文件分配一个固定位置。

在具有实际操作系统的系统上，与 DMA 兼容的缓冲区可能必须由内核专门分配。

# html - 在 chrome 中复制画布像素内容时出现意外结果，为什么？

> ID：13663916
> 
> 赞同：0
> 
> 时间：2012-12-01T21:27:55.713
> 
> 标签：html, canvas

我正在将画布“alpha-pixels”复制到某个数组（Tarray）。我发现opera和chrome的做法不同。为了测试，我缓冲了某个范围（65,100）的值并“警告”了它们。

```
this.Tarray = null;
.....   
create: function (e) {
  ..........
    var test = '';
    var ctx = this.canvas.getContext('2d');
    var pixels = ctx.getImageData(0, 0, this.canvas.width, this.canvas.height).data;
    this.Tarray = new Array(pixels.length / 4);

    for (var i = 0; i < pixels.length; i += 4) {
        this.Tarray[i / 4] = pixels[i + 3];
      // here we buffer some range of values
        if (i / 4 < 100 && i / 4 > 65)
            test += (',' + pixels[i + 3]);
    }
    alert(test)
  ...........
 }
...... 
```

这是歌剧的结果：

：![](../Images/c6205c4c7b0eaa5da3f7e1afcf80bd38.png)

这是镀铬结果：

![](../Images/1b0054e43d5b21d5c463ae8f569e7733.png)

为什么？

**编辑**

这是创建透明效果的代码（图片增加了它的 alpha 值）：

```
 transperancyEffect: function () {

    // when menu first draws (but not displays) it has native alpha value
    //so we must change it before first display
    this.changeTransperancy(0, 0, this.canvas.width, this.canvas.height, this.canvas, 2);
    document.body.appendChild(this.canvas);
    var N = 20;

    var delay = Math.round(this.buildInfo.time / N);

    var self = this;

    function wrapper() {
        arguments.callee.myStaticVar = arguments.callee.myStaticVar || 0;
        arguments.callee.myStaticVar++;
        var ctx = self.canvas.getContext('2d');
        var imageData = ctx.getImageData(0, 0, self.canvas.width, self.canvas.height);
        //   self.changeTransperancy(0, 0, self.canvas.width, self.canvas.height, self.canvas, (arguments.callee.myStaticVar * 200/N + 4));
        var pixels = imageData.data;

        for (var i = 0; i < pixels.length; i += 4) {
            pixels[i + 3] = self.Tarray[i / 4]; // Math.round((self.Tarray[i / 4] * arguments.callee.myStaticVar )/ N);
        }
        ctx.clearRect(0, 0, self.canvas.width, self.canvas.height);

        ctx.putImageData(imageData, 0, 0);

    }

    function callback() {
        self.registerListeners();
    }

    this.repeat(wrapper, delay, N, callback);
} 
```

changeTransperancy - 此功能正常工作。最后一个参数 - alpha 值。

repeat - 基于 setInterval 但允许指定调用次数 (N) 和回调函数。

这个函数不能改变任何东西（pixels[i + 3] = self.Tarray[i / 4] - 相同的 alpha 值）。在 Opera 中一切正常。在 Chrome 中 - (. 那是因为 chrome 没有正确复制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:14:15.770

alpha 值的差异通常是由于不同浏览器处理抗锯齿的方式造成的。

除非您通过直接像素操作来绘制图像，否则您必然会从不同的浏览器供应商处获得不同的 alpha 值。

因此，如果您使用`createImageData`/绘制画布`putImageData`，您应该不会看到不同的 alpha 值，但如果您使用其他更高级别的函数，例如`fillRect`/`strokeRect`您可能会注意到 alpha（有时甚至是 RGB）不匹配。

# c++ - 将子类作为父类传递给方法

> ID：13663919
> 
> 赞同：3
> 
> 时间：2012-12-01T21:28:03.200
> 
> 标签：c++, oop

```
class Method {
  public:    
  virtual void Rum();
};
class Euler : public Method {
  virtual void Rum() {
    printf("ahoj\n");
  }    
};
class Kutta : public Method {
  virtual void Rum() {
    printf("ahoj2\n");
  }    
};
class Simulator {
  public:
  Method *pointer;
  Simulator();
  void setmethod(Method m) { pointer = &m; }
};

int main() {
  Simulator s;
  s.setmethod(new Kutta());
  s.pointer->Rum();
  s.setmethod(new Euler());
  s.pointer->Rum();
} 
```

我希望这个例子足够容易理解。我试图应用继承原则，但我得到了这些错误：（OOP 的东西在我的脑海里似乎有点乱）

```
prog.cpp: In function ‘int main()’:
prog.cpp:26: error: no matching function for call to ‘Simulator::setmethod(Kutta*)’
prog.cpp:21: note: candidates are: void Simulator::setmethod(Method)
prog.cpp:28: error: no matching function for call to ‘Simulator::setmethod(Euler*)’
prog.cpp:21: note: candidates are: void Simulator::setmethod(Method) 
```

那么传递孩子而不是父母的正确方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:30:36.183

您的签名`void setmethod(Method m)`不正确。它必须`void setmethod(Method* m)`与您的调用相匹配。

作为旁注，您需要在方法中使用引用或指针才能使多态性起作用——这意味着您不能将参数传递给`setmethod`按值传递并期望多态性起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-01T22:49:56.713

此代码将起作用：

```
#include <stdio.h>                                                                                                                                                                                                   

class Method {
  public:    
  virtual void Rum() = 0;
};
class Euler : public Method {
  virtual void Rum() {
    printf("ahoj\n");
  }    
};
class Kutta : public Method {
  virtual void Rum() {
    printf("ahoj2\n");
  }    
  virtual void Rum2() {
    printf("ahoj2blah\n");
  }    
};
class Simulator {
  public:
  Method *pointer;
//  Simulator(); // this was only declaration...
  void setmethod(Method* m) { pointer = m; }
};

int main() {
  Simulator s;
  s.setmethod(new Euler());
  s.pointer->Rum();
  s.setmethod(new Kutta());
  s.pointer->Rum();
//  s.pointer->Rum2(); //you can use only functions from Method
} 
```

首先你应该在 Method 中定义 Rum 函数。
还有两个`void setmethod(Method m)` 不正确的原因：

1.  [new 总是返回指向对象的指针](http://www.cplusplus.com/reference/new/operator%20new/)
2.  最重要的一个：
    Compiller 预期的具有 Method 类型的对象，因此它为参数分配了 sizeof(Method) 个字节。
    不幸的是，继承的对象经常有额外的变量，所以[他们的大小大于他们父母的大小](http://ideone.com/KDUXqP)。这就是为什么函数不能接受带有继承类型的对象。
    好的解决方案是将指针传递给函数，它总是有 8 个字节。不幸的是，您只能使用在我们派生出另一个的类中定义的方法和变量，但是当我们要调用的函数是虚拟的时，将调用被覆盖的函数。

# java - Java 正则表达式/拆分

> ID：13663920
> 
> 赞同：2
> 
> 时间：2012-12-01T21:28:07.617
> 
> 标签：java, regex, string, split

我希望在第一部分拆分一个字符串`':'`，以防止字符串的第二部分包含`':'`. 我一直在看正则表达式，但仍然有一些问题，有人可以帮帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-01T21:31:26.277

您可以使用带有限制参数[的 split 重载：](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split(java.lang.String,%20int))

```
String[] result = s.split(":", 2); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-01T21:31:34.823

您可以使用 2 参数[`String#split`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29)来指定拆分后获得的数组中所需的元素数：-

```
String str = "rohit:jain:use:single:split";
String[] arr = str.split(":", 2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T22:07:27.083

请注意，该拆分使用正则表达式。并且 indexOf + substr 可以比 split 快得多。

# ios - 缩放字体大小以垂直适应 UILabel

> ID：13663924
> 
> 赞同：19
> 
> 时间：2012-12-01T21:28:15.603
> 
> 标签：ios, cocoa-touch, fonts, uilabel

我想采用标准的 UILabel 并增加字体大小以填充垂直空间。从这个[问题](https://stackoverflow.com/questions/10419607/ios-how-to-find-the-right-font-size-in-points-with-the-same-height-as-a-give)的公认答案中汲取灵感，我在 UILabel 上使用这个 drawRect 实现定义了一个子类：

```
- (void)drawRect:(CGRect)rect
{
    // Size required to render string
    CGSize size = [self.text sizeWithFont:self.font];

    // For current font point size, calculate points per pixel
    float pointsPerPixel = size.height / self.font.pointSize;

    // Scale up point size for the height of the label
    float desiredPointSize = rect.size.height * pointsPerPixel;

    // Create and assign new UIFont with desired point Size
    UIFont *newFont = [UIFont fontWithName:self.font.fontName size:desiredPointSize];
    self.font = newFont;

    // Call super
    [super drawRect:rect];
} 
```

但这不起作用，因为它会将字体缩放到标签底部之外。如果你想复制它，我从标签 289x122 (wxh) 开始，字体为 Helvetica，起始点大小为 60，适合标签。这是使用字符串“{Hg”的标准 UILabel 和我的子类的示例输出：

![uilabel](../Images/b71b114ebce11da865c3a4f613185dbf.png)

![uilabel 子类](../Images/977ab47e0259b4233653f339e06ae242.png)

我已经查看了字体下降和上升，尝试缩放以不同的组合考虑这些，但仍然没有任何运气。任何想法，这与具有不同下降和上升长度的不同字体有关吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-02T17:43:46.510

你的计算`pointsPerPixel`方法不对，应该是...

```
float pointsPerPixel =  self.font.pointSize / size.height; 
```

另外，也许这段代码应该在，`layoutSubviews`因为字体应该改变的唯一时间是帧大小改变的时候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T08:13:56.867

我想知道它是否是一个四舍五入的错误，它会逐渐增大到下一个更大的字体大小。你能稍微缩放一下rec.size.height吗？就像是：

```
float desiredPointSize = rect.size.height *.90 * pointsPerPixel; 
```

**更新：**您的 pointPerPixel 计算是倒退的。你实际上是用字体点来划分像素，而不是用像素来划分点。交换这些，它每次都有效。只是为了彻底，这是我测试的示例代码：

```
//text to render    
NSString *soString = [NSString stringWithFormat:@"{Hg"];
UIFont *soFont = [UIFont fontWithName:@"Helvetica" size:12];

//box to render in
CGRect rect = soLabel.frame;

//calculate number of pixels used vertically for a given point size. 
//We assume that pixel-to-point ratio remains constant.
CGSize size = [soString sizeWithFont:soFont];
float pointsPerPixel;
pointsPerPixel = soFont.pointSize / size.height;   //this calc works
//pointsPerPixel = size.height / soFont.pointSize; //this calc does not work

//now calc which fontsize fits in the label
float desiredPointSize = rect.size.height * pointsPerPixel;
UIFont *newFont = [UIFont fontWithName:@"Helvetica" size:desiredPointSize];

//and update the display
[soLabel setFont:newFont];
soLabel.text = soString; 
```

对于我测试的每种尺寸（从 40pt 到 60pt 字体），它都可以缩放并适合标签框。当我颠倒计算时，我看到了相同的结果，字体太高，不适合盒子。

# postgresql - 如何避免在 PostgreSQL 9.2.1 中循环触发调用

> ID：13663926
> 
> 赞同：7
> 
> 时间：2012-12-01T21:29:02.953
> 
> 标签：postgresql, triggers, postgis, plpgsql

我有一张桌子：

```
CREATE TABLE field_data.soil_samples (
 pgid SERIAL NOT NULL,
 sample_id text,
 project_id text,
 utm_zone integer,
 utm_easting integer,
 utm_northing integer,
 wgs84_longitude double precision,
 wgs84_latitude double precision,
 yt_albers_geom geometry(Point,3578),
 CONSTRAINT soil_samples_pk PRIMARY KEY (pgid)
) 
```

PostGIS 2.0 中的几何图形`yt_albers_geom`是使用触发器创建的，该触发器在针对此表的 INSERTS 时触发。如果插入的记录满足以下条件之一，则生成几何：

1.  `wgs84_latitude`和`wgs84_longitude`字段都不为空
2.  `utm_zone`、`utm_easting`和中的每一个`utm_northing`都不为空

现在，我对如何进行更新以实现以下目标感到困惑：

1.  当对`utm_zone`, `utm_easting`, 或进行更新时`utm_northing`, 然后`wgs_84_latitude`, `wgs84_longitude`,`yt_albers_geom`并由触发器更新
2.  对`wgs84_latitude`或进行更新时，`wgs84_longitude`所有`utm_`字段都会更新，`yt_albers_geom`。
3.  当对 进行更新时`yt_albers_geom`，所有坐标字段都会更新。

似乎这些触发器中的任何一个都会导致触发器触发的无限循环，对吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-02T02:56:52.270

您可以使用**标准触发器** `BEFORE UPDATE OF ... ON ...`来执行此操作。
[手册上`CREATE TRIGGER`告知：](http://www.postgresql.org/docs/current/interactive/sql-createtrigger.html)

> 仅当列出的列中的至少一个列被提及为 UPDATE 命令的目标时，触发器才会触发。

再往下：

> 当它的任何列被列为 UPDATE 命令的 SET 列表中的目标时，将触发特定于列的触发器（使用 UPDATE OF column_name 语法定义的触发器）。即使未触发触发器，列的值也可能更改，因为**不考虑 BEFORE UPDATE 触发器对行内容所做的更改。**

大胆强调我的。所以没有无限循环，因为触发器内部的更新不会调用另一个触发器。

## 测试用例

创建测试表（简化，没有不相关的行）：

```
CREATE TABLE soil_samples (
  pgid SERIAL PRIMARY KEY

 ,utm_zone integer
 ,utm_easting integer
 ,utm_northing integer

 ,wgs84_longitude double precision
 ,wgs84_latitude double precision

 ,yt_albers_geom double precision
); 
```

### 您的第一个要求的虚拟触发器：

> 当对`utm_zone`、`utm_easting`或进行更新时`utm_northing`，则 `wgs_84_latitude`、`wgs84_longitude`和`yt_albers_geom`由触发器更新。

```
CREATE OR REPLACE FUNCTION trg_upbef_utm()  RETURNS trigger AS
$func$
BEGIN
   NEW.wgs84_latitude  := NEW.wgs84_latitude + 10;
   NEW.wgs84_longitude := NEW.wgs84_longitude + 10;
   NEW.yt_albers_geom  := NEW.yt_albers_geom + 10;

   RETURN NEW;
END
$func$ LANGUAGE plpgsql;

CREATE TRIGGER upbef_utm
BEFORE UPDATE OF utm_zone, utm_easting, utm_northing ON soil_samples
FOR EACH ROW
WHEN (NEW.utm_zone     IS DISTINCT FROM OLD.utm_zone    OR
      NEW.utm_easting  IS DISTINCT FROM OLD.utm_easting OR
      NEW.utm_northing IS DISTINCT FROM OLD.utm_northing)  -- optional
EXECUTE PROCEDURE trg_upbef_utm(); 
```

该`WHEN`子句是可选的。防止触发器在没有实际更改值时触发。

### 您的第二个要求的虚拟触发器：

> 当对`wgs84_latitude`or进行更新时`wgs84_longitude`，所有 u`tm_`字段以及`yt_albers_geom`.

```
CREATE OR REPLACE FUNCTION trg_upbef_wgs84()  RETURNS trigger AS
$func$
BEGIN
   NEW.utm_zone       := NEW.utm_zone + 100;
   NEW.utm_easting    := NEW.utm_easting + 100;
   NEW.utm_northing   := NEW.utm_northing + 100;
   NEW.yt_albers_geom := NEW.yt_albers_geom + 100;

   RETURN NEW;
END
$func$ LANGUAGE plpgsql;

CREATE TRIGGER upbef_wgs84
 BEFORE UPDATE OF wgs84_latitude, wgs84_longitude ON soil_samples
 FOR EACH ROW
 WHEN (NEW.wgs84_latitude  IS DISTINCT FROM OLD.wgs84_latitude OR
       NEW.wgs84_longitude IS DISTINCT FROM OLD.wgs84_longitude)  -- optional
 EXECUTE PROCEDURE trg_upbef_wgs84(); 
```

**沿着这些**思路触发第三个要求......

 **### 测试

```
INSERT INTO soil_samples VALUES (1, 1,1,1, 2,2, 3) RETURNING *; 
```

触发器`upbef_utm`：空更新，没有任何反应：

```
UPDATE soil_samples SET utm_zone = 1 RETURNING *; 
```

更新实际更改：第二个触发器`upbef_wgs84`不会触发`UPDATE OF utm_zone`！

```
UPDATE soil_samples SET utm_zone = 0 RETURNING *; 
```

触发器`upbef_wgs84`：

```
UPDATE soil_samples SET wgs84_latitude = 0 RETURNING *; 
```

[**-> SQLfiddle 演示。**](http://sqlfiddle.com/#!12/dac29/1)**

# android - Android 片段崩溃

> ID：13663943
> 
> 赞同：1
> 
> 时间：2012-12-01T21:30:52.550
> 
> 标签：android, crash, android-fragments

我刚刚开始学习 Android 片段。请帮助我为什么我的以下程序崩溃了。

一个 Activity 包含两个片段，每个片段只有一个按钮可以显示。我尝试按照 Head First Android Development 中的示例进行操作...但是 :(

包含片段的活动

```
public class FragmentsContainer extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragmentscontaineractivity);
    }
} 
```

片段容器的布局

```
 <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <fragment
            android:name="com.example.nasaimage.ImageOne"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1" />

        <fragment
            android:name="com.example.nasaimage.ImageTwo"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="2" />
    </LinearLayout> 
```

第一个片段和布局

```
 public class ImageOne extends Fragment {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

        }

        @Override
        public View onCreateView(LayoutInflater inflater,
                ViewGroup container, Bundle savedInstanceState) {
            return inflater.inflate(R.layout.imageoneactivity, container, false);
        }
   }

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

第二个活动和布局

```
 public class ImageTwo extends Fragment {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){

             View view =  inflater.inflate(R.layout.imagetwoactivity, container, false);

                Button button = (Button) view.findViewById(R.id.button1);
                button.setOnClickListener(new View.OnClickListener() {
                  @Override
                  public void onClick(View v) {

                  }
                });
                return view;
        }
    }

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Button" />

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-06-06T17:54:00.163

为什么要使用这种方法，您可以使用更智能的方法...按下按钮、菜单选项或导航抽屉项目后，可以像这样调用片段：

```
FragmentManager fragmentManager = getFragmentManager();
            FragmentTransaction fragmentTransaction = fragmentManager
                    .beginTransaction();
            FragmentExcel fragmentS1 = new FragmentExcel();
            fragmentTransaction.replace(R.id.content_frame, fragmentS1);
            fragmentTransaction.commit(); 
```

然后片段类可以是这样的，其中有三个具有特定功能的按钮：

```
public class FragmentExcel extends Fragment {    
    Button buttonCat, buttonBudg, buttonExpense;
    DBHelper db;

    public static Fragment newInstance(Context context) {
        FragmentHistory f = new FragmentHistory();    
        return f;
    }

    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {    
        if (container == null) {
            return null;
        }

        RelativeLayout mLinearLayout = (RelativeLayout) inflater.inflate(
                R.layout.fragment_excel, container, false);

        db = new DBHelper((getActivity().getBaseContext()));

        buttonCat = (Button) mLinearLayout.findViewById(R.id.buttonCategoies);
        buttonBudg = (Button) mLinearLayout.findViewById(R.id.buttonBudgets);
        buttonExpense = (Button) mLinearLayout
                .findViewById(R.id.buttonExpenses);

        buttonCat.setOnClickListener(new View.OnClickListener() {    
            @Override
            public void onClick(View v) {
                db = new DBHelper((getActivity().getBaseContext()));
                String tableName = "categories";
                db.exportDataIntoCSV(tableName);

                Toast.makeText(getActivity().getBaseContext(),
                        "File is saved in tour SDCard storage",
                        Toast.LENGTH_SHORT).show();    
            }
        });

        buttonBudg.setOnClickListener(new View.OnClickListener() {    
            @Override
            public void onClick(View v) {
                //Do whatever you want    
            }
        });

        buttonExpense.setOnClickListener(new View.OnClickListener() {    
            @Override
            public void onClick(View v) {
                //Do whatever you want              }
        });

        return mLinearLayout;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T01:46:06.900

[您应该包括在此处](http://developer.android.com/tools/extras/support-library.html)找到的支持库，然后进行`Activity`扩展`FragmentActivity`。

只有 Android 3.x 及更高版本在基类中添加了`FragmentManager`和支持。`Fragment``Activity`

# mysql - 使用 mysql 列出每个级别的高分

> ID：13663948
> 
> 赞同：0
> 
> 时间：2012-12-01T21:31:01.457
> 
> 标签：mysql

我有以下2个数据库结构：

**级别**：

```
CREATE TABLE IF NOT EXISTS `levels` (
  `lid` int(6) NOT NULL auto_increment,
  `name` varchar(25) NOT NULL,
  `levelcode` mediumtext character set utf8 collate utf8_unicode_ci NOT NULL,
  PRIMARY KEY  (`lid`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

和**高分**：

```
CREATE TABLE IF NOT EXISTS `highscores` (
  `lid` int(11) NOT NULL,
  `userid` int(6) NOT NULL,
  `score` int(8) NOT NULL,
  PRIMARY KEY  (`lid`,`userid`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1; 
```

我想做的是获取所有级别的列表，以及特定用户是否有高分、最高分或根本没有分数。对于这个例子，让我们使用`userid`'2'

这是我希望实现的结果示例表：（抱歉不知道如何制作表格）

```
Level ID,  Level Name,        ScoreStatus
1,         firstlevel,        noscore
2,         secondlevelname,   best score
3,         third level name,  has score 
```

等等..

有没有办法用一个查询来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T21:39:42.137

您可以使用`GROUP BY`和`MAX()`查找每个级别的最高分，然后使用 a`LEFT OUTER JOIN`选择最高分或`NULL`：

```
SELECT s.lid, lvl.name, MAX(s.score)
    FROM levels AS lvl
    LEFT OUTER JOIN highscores AS s ON lvl.lid = s.lid
    GROUP BY s.lid; 
```

如果您想将此限制为`userid`2 `WHERE userid=2`，请在`GROUP BY`.

> 好的，所以 MAX( s.score ) 让我获得了该级别的最佳分数，我将如何获得 userids 2 分数来比较他的分数，看看它是否是最好的？

啊，对……嗯，我现在没有在任何 MySQL 面前，也不能完全记住细节，以至于没有测试就写出来……用最简单的方式，你会期望分数被选中使用时从`highscores`表中`MAX()`选择整行，因此`userid`将与分数配对，您可以检查它是否等于 2。

但我有一种感觉，您必须在内部对该表进行反向排序（按分数），以便该`GROUP BY`子句将`userid`得分最高的放在第一行，从而选择该特定用户。这对我来说有点笨拙。

因此，您可以做的是保留原始查询并将整个查询连接回用户表。然后测试用户的分数是否等于高分。像这样的东西：

```
SELECT a.lid, a.name, IF( highscore IS NULL,
                          'no score',
                          IF( highscore = score,
                              'best score',
                              'has score' ) )
  FROM
    (SELECT s.lid, lvl.name, MAX(s.score) AS highscore
        FROM levels AS lvl
        LEFT OUTER JOIN highscores AS s ON lvl.lid = s.lid
        GROUP BY s.lid) AS a
  JOIN
    highscores s ON s.lid = a.lid
  WHERE userid = 2
  ORDER BY lid; 
```

如果这在语法上不正确，请致歉。它应该接近你所追求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-02T01:30:49.843

您可以通过仅针对 HighScores 表来获取 ALL 的 MAX 和特定用户的 MAX 来做到这一点……然后，加入用户表并通过左连接限定要显示的消息。因此，最内层的预查询针对每个“LID”执行所有用户的最高分数，另一个针对该用户的实际分数。

```
select
      L.lid,
      L.Name,
      L.LevelCode,
      if( PreQuery.HighScore is null, 'No Score', 'Score' ) as HasAScore,
      coalesce( PreQuery.HighScore, 0 ) as HighScore,
      if( PreQuery.UserHS > 0, 'User Has Score', 'No User Score' ) as UserHasAScore,
      coalesce( PreQuery.UserHS, 0 ) as UserHighScore,
      if( PreQuery.UserHS > 0 AND PreQuery.UserHS = PreQuery.HighScore, 
             'Use HAS The High Score', 'not the high score' ) as DoesUserHaveHighScore
   from
      Levels L
         LEFT JOIN ( select
                           HS.LID,
                           MAX( HS.Score ) as HighScore,
                           MAX( IF( HS.UserID = UserIDYouAreCheckingFor, HS.Score, 0 )) as UserHS
                        from
                           HighScores HS
                        group by
                           HS.LID ) PreQuery
            ON L.lid = PreQuery.LID 
```

# java - 为什么 Pattern 是最终的？

> ID：13663959
> 
> 赞同：-2
> 
> 时间：2012-12-01T21:32:33.560
> 
> 标签：java, class, final

我不会尝试扩展 Pattern 因为我们不能（我会包装），但我想知道为什么 Pattern 类是 final ？

我的意思是这个类可以扩展到最大的用途，但他们选择让它成为最终的。为什么 ？

如果我问它，它更像是一种技术（好奇？）方式，而不是“java太糟糕”的方式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T21:35:58.757

它是`final`专门为了*防止*你扩展它，因为它不是为子类而设计的。[`Pattern`实例是不可变且线程安全](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)的，如果您创建自己的`Pattern`.

*   [为什么 java.util.Scanner 类被声明为“final”？](https://stackoverflow.com/questions/3776940/why-is-the-java-util-scanner-class-declared-final?rq=1)
*   [为什么 String 类在 Java 中声明为 final？](https://stackoverflow.com/questions/2068804/why-is-string-final-in-java)
*   当然，还有最重要的*Effective Java*引用：

    > ### [第 17 项：设计和文件继承或禁止继承](http://my.safaribooksonline.com/book/programming/java/9780137150021/classes-and-interfaces/ch04lev1sec5)

# graphics - 实现布料自合谋最简单的方法是什么？

> ID：13663962
> 
> 赞同：1
> 
> 时间：2012-12-01T21:33:00.820
> 
> 标签：graphics, collision-detection, physics

我正在尝试实现一个具有自我勾结的布料模拟系统。我使用带有弹簧力的粒子系统实现了整个布料。（即我有一个布料的顶点网格）现在，我还需要一个简单的方法来实现自我共谋。实际上，共谋检测和响应都是如此。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T22:48:26.450

这取决于您想要它的简单（和不精确）：

最简单的变体： - 选择关于顶点的高分辨率布料。在每个顶点使用一个球体，足够大/足够多，不会留下整体。为每个接触创建弹簧（必须在每个时间步重做）。时间步长必须足够小以避免隧道效应（虽然球-球连续很容易检测，但如果您不想回溯解决方案，分辨率可能会更棘手）。

更精确的变体：Trimesh-trimesh（或 spline-spline）在检测部分具有连续碰撞检测。一些刚体接触建模与响应部分的摩擦。

有很多关于这个主题的文章。Barraff and Witkin 1998 [http://www.cs.cornell.edu/courses/cs667/2005sp/readings/baraff98.pdf](http://www.cs.cornell.edu/courses/cs667/2005sp/readings/baraff98.pdf)是一个初学者，但有几个问题。

一个简单的文献搜索将提供更多。

# ios - 根据用户按钮对获取结果控制器进行排序单击 IOS

> ID：13663964
> 
> 赞同：0
> 
> 时间：2012-12-01T21:33:06.233
> 
> 标签：ios, nssortdescriptor

我正在制作一个 Iphone 应用程序，并试图根据用户点击特定按钮在我获取的结果控制器上执行排序。当用户单击按钮时，我输入了下面显示的代码，但是我收到一条错误消息

> -[NSSortDescriptor 计数]：无法识别的选择器发送到实例 0x6bc3250
> 
> *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-。如何解决此问题并根据用户按钮单击对数据进行排序？

```
- (IBAction)btnValue:(id)sender {
    self.model.frc_Work.delegate = self;

    self.model.frc_Work.fetchRequest.sortDescriptors = [NSSortDescriptor sortDescriptorWithKey:@"Value" ascending:YES];

    [NSFetchedResultsController deleteCacheWithName:@"Work"];

    NSError *error = nil;
    [self.model.frc_Work performFetch:&error];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T21:36:32.223

您应该收到一个编译器警告，指出您将错误类型的对象分配给`sortDescriptors`fetch 请求的属性，该属性需要一个`NSArray`，而不是`NSSortDescriptor`.

您可以改为这样分配它：

```
NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"Value" ascending:YES];
self.model.frc_Work.fetchRequest.sortDescriptors = [NSArray arrayWithObject:sortDescriptor]; 
```

此属性采用数组的原因是，您可以指定一个排序描述符列表，以连续应用于某些键可能具有相同值的值（例如，按姓氏排序，如果姓氏相等，则按名字排序）。

# c - localtime() 弄错了，说日期 = 9 月 31 日

> ID：13663965
> 
> 赞同：0
> 
> 时间：2012-12-01T21:33:21.360
> 
> 标签：c, datetime, mktime, localtime

我正在制作一个日历程序。“扩展重复事件”代码给我带来了无穷无尽的麻烦。我通过使用 mktime() 来扩展事件以获取“纯”时间值，然后将重复增量（在本例中为 604800 秒或 7 天）添加到它。localtime() 然后用于获取日历结构。

有时候是这样的：

原始事件：9月10日

```
{tm_sec = 0, tm_min = 0, tm_hour = 16, tm_mday = 10, tm_mon = 9,
 tm_year = 2012, tm_wday = 4, tm_yday = 283, tm_isdst = 0, 
 tm_gmtoff = -25200, tm_zone = 0x608ff0 "PDT"} 
```

第一次重复：9月17日

```
{tm_sec = 0, tm_min = 0, tm_hour = 17, tm_mday = 17, tm_mon = 9,
 tm_year = 2012, tm_wday = 4, tm_yday = 290, tm_isdst = 1, 
 tm_gmtoff = -25200, tm_zone = 0x608ff0 "PDT"} 
```

第二次重复：9月24日

```
{tm_sec = 0, tm_min = 0, tm_hour = 16, tm_mday = 24, tm_mon = 9,
 tm_year = 2012, tm_wday = 4, tm_yday = 297, tm_isdst = 0,
 tm_gmtoff = -25200, tm_zone = 0x608ff0 "PDT"} 
```

第三次重复：9 月 31 日？！

```
{tm_sec = 0, tm_min = 0, tm_hour = 16, tm_mday = 31, tm_mon = 9,
 tm_year = 2012, tm_wday = 4, tm_yday = 304, tm_isdst = 0,
 tm_gmtoff = -25200, tm_zone = 0x608ff0 "PDT"} 
```

有谁知道这里发生了什么？我必须自己填写`localtime()`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T21:36:37.807

从[文档](http://pubs.opengroup.org/onlinepubs/7908799/xsh/time.h.html)中：结构的成员是`struct tm`基于 0 的（通常在 C 中）。

```
int    tm_mon   month of year [0,11] 
```

所以实际上编号的月份`9`是第 10 个月，也就是 10 月，它有 31 天。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:52:43.707

正如 H2CO3 指出的那样，`tm_mon`是从 0 开始的，所以日期实际上是 10 月 31 日，这是有道理的。

我想提一下，简单地将 604800 秒添加到提前 7 天可能不是用户希望从日历程序中获得的。604800*正好是*7 天，但如果用户希望每 7 天在上午 10:00 重复一次事件，添加 604800 秒并不总是会导致时间为上午 10:00，因为这忽略了夏令时和闰秒等特殊注意事项.

您可以做的是将 7 添加到`tm_mday`. 不要担心超过一个月的天数，因为`mktime()`会纠正它。

# php - php和json读取字符串

> ID：13663973
> 
> 赞同：0
> 
> 时间：2012-12-01T21:34:23.543
> 
> 标签：php, json

[我在使用来自http://www.wunderground.com/](http://www.wunderground.com/) API 的pvp 读取 json 响应时遇到问题。我发现读取除整数以外的任何内容都有问题。我在网上寻找，但我的问题没有合适的答案。最后我放弃了...

编码：

```
$json_string = file_get_contents($w);
$json_string = utf8_encode($json_string);
$result = json_decode($json_string,true); 
```

结果`print_r($result);`给了我完整的正确答案

```
Array ( [response] => Array ( [version] (...) Europe/Warsaw [local_tz_offset] => +0100 [weather] => Scattered Clouds [temperature_string] => 30 F (-1 C) [temp_f] => 30 [temp_c] => -1 [relative_humidity] => 93% [wind_string] => From the SE at 8 MPH [wind_dir] => SE [wind_degrees] => 130 [wind_mph] => 8 [wind_gust_mph] => 0 [wind_kph] => 13 [wind_gust_kph] => 0 [pressure_mb] => 1013 [pressure_in] => 29.92 [pressure_trend] => 0 [dewpoint_string] => 28 F (-2 C) [dewpoint_f] => 28 [dewpoint_c] => -2 [heat_index_string] => NA [heat_index_f] => NA [heat_index_c] => NA [windchill_string] => 23 F (-5 C) [windchill_f] => 23 [windchill_c] => -5 [feelslike_string] => 23 F (-5 C) [feelslike_f] => 23 [feelslike_c] => -5 [visibility_mi] => 6.2 [visibility_km] => 10.0 [solarradiation] => [UV] => 1 [precip_1hr_string] => -9999.00 in (-9999.00 mm) [precip_1hr_in] => -9999.00 [precip_1hr_metric] => -9999.00 [precip_today_string] => 0.00 in (0.0 mm) [precip_today_in] => 0.00 [precip_today_metric] => 0.0 [icon] => partlycloudy [icon_url] => (..) [forecast_url] =>(..) [history_url] => (..) [ob_url] =>(..)52.16999817,20.96999931 ) ) 
```

但关键是我只能读取 Integer 而不是 string 不知道为什么：

```
echo "Current temperature in ${location} is: ${temp_c}\n";
echo "Current temperature F in ${location} is: ${temp_f}\n";
echo "Current humidity F in ${location} is: ${hum}\n";
echo "Current wind in ${location} is: ${wind}\n"; 
```

输出如下所示：

```
Current temperature in Warsaw is: -3 
Current temperature F in Warsaw is: 27 
Current humidity F in Warsaw is: 
Current wind in Warsaw is: 
```

因此，正如我之前提到的，除了整数之外，我无法从 json 中读取任何内容。使用 php 版本：

```
php -v
PHP 5.3.6 (cli) (built: Apr 14 2011 14:58:35)
Copyright (c) 1997-2011 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2011 Zend Technologies 
```

花了几个小时寻找解决方案后仍然找不到我的问题的答案。如果您知道任何线索，请告诉我，因为现在我一直被这个问题困扰着，我想永远。

```
var_dump($result) 
```

也给了我适当的数组：

```
 array(3) { ["response"] (...)["weather"]=> string(16) "Scattered Clouds" ["temperature_string"]=> string(11) "30 F (-1 C)" ["temp_f"]=> int(30) ["temp_c"]=> int(-1) ["relative_humidity"]=> string(3) "93%" ["wind_string"]=> string(20) "From the SE at 8 MPH" ["wind_dir"]=> string(2) "SE" ["wind_degrees"]=> int(130) ["wind_mph"]=> int(8) ["wind_gust_mph"]=> int(0) ["wind_kph"]=> int(13) ["wind_gust_kph"]=> int(0) ["pressure_mb"]=> string(4) "1013" ["pressure_in"]=> string(5) "29.92" ["pressure_trend"]=> string(1) "0" ["dewpoint_string"]=> string(11) "28 F (-2 C)" ["dewpoint_f"]=> int(28) ["dewpoint_c"]=> int(-2) ["heat_index_string"]=> string(2) "NA" ["heat_index_f"]=> string(2) "NA" ["heat_index_c"]=> string(2) "NA" ["windchill_string"]=> string(11) "23 F (-5 C)" ["windchill_f"]=> string(2) "23" ["windchill_c"]=> string(2) "-5" ["feelslike_string"]=> string(11) "23 F (-5 C)" ["feelslike_f"]=> string(2) "23" ["feelslike_c"]=> string(2) "-5" ["visibility_mi"]=> string(3) "6.2" ["visibility_km"]=> string(4) "10.0" ["solarradiation"]=> string(0) "" ["UV"]=> string(1) "1" ["precip_1hr_string"]=> string(25) "-9999.00 in (-9999.00 mm)" ["precip_1hr_in"]=> string(8) "-9999.00" ["precip_1hr_metric"]=> string(8) "-9999.00" ["precip_today_string"]=> string(16) "0.00 in (0.0 mm)" ["precip_today_in"]=> string(4) "0.00" ["precip_today_metric"]=> string(3) "0.0" ["icon"]=> string(12) "partlycloudy" ["icon_url"]=> string(47) "http://icons-ak.wxug.com/i/c/k/partlycloudy.gif" ["forecast_url"]=> string(54) (..) ["history_url"]=> string(76) (..) ["ob_url"]=> string(89) (...) } } 
```

PS我在粘贴和格式化所有print_r结果时遇到了一些问题，所以我不得不用'（..）'来解决一些问题

谢谢

# javascript - 多个 Json 对象未绑定到 HttpPost 上的 asp.net mvc 控制器操作

> ID：13663974
> 
> 赞同：0
> 
> 时间：2012-12-01T21:34:25.560
> 
> 标签：javascript, json, asp.net-mvc-4, model-binding

我将 json 对象传递给 asp.net mvc 控制器操作。两个参数都为空。

有人可以发现错误prolly错误的命名吗？

```
/* Source Unit */
var sourceParent = sourceNode.getParent();
var sourceUnitParentId = sourceParent == null ? null : sourceParent.data.key;
var sourceUnit = { unitId: sourceNode.data.key, parentId: sourceUnitParentId };
var sourceUnitJson = JSON.stringify(sourceUnit);

/* Target Unit */
var targetParent = targetNode.getParent();
var targetUnitParentId = targetParent == null ? null : targetParent.data.key;
var targetUnit = { unitId: targetNode.data.key, parentId: targetUnitParentId };
var targetUnitJson = JSON.stringify(targetUnit);

moveUnit(sourceUnitJson, targetUnitJson);

function moveUnit(sourceUnit, targetUnit) {
        $.ajax({
            url: '@Url.Action("Move", "Unit")',
            type: 'POST',
            data: { sourceUnit: sourceUnit, targetUnit: targetUnit },
            success: function (response) {

            },
            error: function (e) {

            }
        });
    }

[HttpPost]
        public ActionResult Move(DragDropUnitViewModel sourceUnit, DragDropUnitViewModel targetUnit)
        {
            Unit sUnit = Mapper.Map<DragDropUnitViewModel, Unit>(sourceUnit);
            Unit tUnit = Mapper.Map<DragDropUnitViewModel, Unit>(targetUnit);
            _unitService.MoveUnit(sUnit, tUnit);
            return new EmptyResult();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:41:15.023

为什么不使用视图模型？如果要将 JSON 传递给控制器​​操作，则定义一个包含 2 个属性的视图模型，然后定义`JSON.stringify`整个请求。

这是您的视图模型：

```
public class MoveViewModel
{
    public DragDropUnitViewModel SourceUnit { get; set; }
    public DragDropUnitViewModel TargetUnit { get; set; }
} 
```

现在您的控制器操作将视图模型作为参数：

```
[HttpPost]
public ActionResult Move(MoveViewModel model)
{
    Unit sUnit = Mapper.Map<DragDropUnitViewModel, Unit>(model.SourceUnit);
    Unit tUnit = Mapper.Map<DragDropUnitViewModel, Unit>(model.TargetUnit);
    _unitService.MoveUnit(sUnit, tUnit);
    return new EmptyResult();
} 
```

最后使用 AJAX 调用此控制器操作并通过确保您已指定正确的请求内容类型来发送 JSON 请求，否则 ASP.NET MVC 将不知道如何反序列化返回 JSON 请求：

```
/* Source Unit */
var sourceParent = sourceNode.getParent();
var sourceUnitParentId = sourceParent == null ? null : sourceParent.data.key;
var sourceUnit = { unitId: sourceNode.data.key, parentId: sourceUnitParentId };

/* Target Unit */
var targetParent = targetNode.getParent();
var targetUnitParentId = targetParent == null ? null : targetParent.data.key;
var targetUnit = { unitId: targetNode.data.key, parentId: targetUnitParentId };

/* build the view model */
var moveModel = { sourceUnit: sourceUnit, targetUnit: targetUnit };

/* Pass the view model to the server using an AJAX request */
moveUnit(moveModel);

function moveUnit(moveModel) {
    $.ajax({
        url: '@Url.Action("Move", "Unit")',
        type: 'POST',
        // It's very important to specify the correct content type
        // request header because we are sending a JSON request
        contentType: 'application/json; charset=utf-8',
        data: JSON.stringify(moveModel),
        success: function (response) {

        },
        error: function (e) {

        }
    });
} 
```

概括：

*   每次您有一个控制器操作采用超过 1 个单个参数时，您都做错了。立即停止并定义视图模型。
*   每次您有一个控制器操作将域模型传递给视图时，您都做错了。立即停止并定义视图模型。

如您所见，这都是关于 ASP.NET MVC 中的视图模型的。

# c++ - 来自多个类的 Ostream

> ID：13663984
> 
> 赞同：-2
> 
> 时间：2012-12-01T21:36:08.990
> 
> 标签：c++, ostream

我似乎收到了错误 C2440：'return' cannot convert from 'LinkList' to 'Tray *'。我想要做的是将第二类的输出添加到客户类的输出中。因此，如果我要调用诸如 whoIsEating() 之类的方法，我可以很容易地得到谁、在哪里和做什么的列表。我有一个使用“朋友”的想法，但我对此不太确定。

客户.h

```
class Customer
{
private:
    int tableNumber;
    std::string firstName;
    std::string lastName;
    LinkList<Tray> *myTray;
public:
    Customer();
    Customer(std::string sFirstName, std::string sLastName,
        int sTableNumber,
        LinkList<Tray> *myTray = new LinkList<Tray>());
    ~Customer(void);

    int gettableNumber();
    Tray* getTray(void); 
```

客户.cpp

```
Tray* Customer::getTray()
{
    return *myTray;
}

ostream& operator << (ostream& output, Customer& customer)
{
    output << customer.getFirstName() << " " << customer.getLastName() << endl
        << customer.gettableNumber() << endl
        << (*customer.getTray()) << endl; //Edit: Fixed this
    return output; 
```

托盘.cpp

```
ostream& operator << (ostream& output, Tray& tray)
{
    output << "Drink: " << tray.getdrink() << endl;
    output << "Food: " << tray.getfood() << endl;
    return output;
} 
```

怀疑的输出就像

姓名：约翰·史密斯

桌数：12

用餐详情：

喝茶

食物：炸鱼薯条

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T21:43:12.843

在您的 customer.cpp 文件中，您有 getTray 返回一个指向托盘的指针，并且您传递了 myTray 实例变量：

```
Tray* Customer::getTray()
{
    return *myTray;
} 
```

但是，在您的客户类中，您已经将 myTray 定义为 LinkedList

```
class Customer
{
    ...
    LinkList<Tray> *myTray; << here 
```

您需要返回一个指向托盘的指针，因此您可能想做更多类似的事情：

```
Tray* Customer::getTray()
{
    return &(myTray->first());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T15:11:28.340

## 你发布了

```
template<typename T>
class LinkList {
public:
    LinkList();
    ~LinkList();
    void insert(T); //Insert new node in order
    void print(); //Outputs contents
    int getSize();
    void target(T);
    Node<T>* search(T); //Search for value in link list 
                        //and returns pointer to value
    Node<T> *startingPtr;
    Node<T> *endPtr;
private:
    bool isEmpty();
    void insertStart(T); //insert before first node
    void insertEnd(T); //insert after last node
    void insertNext(T);
    void insertBefore(T);
};

template<typename T>
class Node {
    friend class LinkList<T>;
public: 
    T getData();
    Node(T);
    Node* nextPtr;
private:
    T data;
    Node* prevPtr;
}; 
```

## 问题

该类`LinkedList`不会公开您想要的数据。

你想返回一个指向 a 的指针`Tray`，也就是`Tray*`：

```
Tray* Customer::getTray() 
```

...但是您拥有的对象是指向 a 的指针`LinkedList<Tray>`：

```
LinkList<Tray> *myTray; 
```

该`LinkedList`课程使您可以访问`Node<Tray>*`，例如：

```
Node<T> *startingPtr; 
```

...并且该类使您可以通过以下方法`Node`访问`Tray`对象：`getData`

```
T getData(); 
```

...但不幸的是，您想要 a `Tray*`，并且从中获得 a 并不简单`Tray*`。（问题是它`getData`返回一个很快就会消失的临时对象，所以如果你用那个对象的地址来获取 a `Tray*`，你将有一个很快指向垃圾的指针。）

## 解决方案

一种解决方法是`getTray`返回 a `Node<Tray>*`，您可以访问它，例如：

```
Node<Tray>* Customer::getTray()
{
    return myTray->startingPtr;
}

// note that this assumes that the customer has at least one tray in it's list
ostream& operator << (ostream& output, Customer& customer)
{
    output << customer.getFirstName() << " " << customer.getLastName() << endl
        << customer.gettableNumber() << endl
        << customer.getTray()->getData() << endl;
    return output;
}

// note the added 'const', which means tray.getdrink() and tray.getfood()
// will have to be const member methods
ostream& operator << (ostream& output, const Tray& tray) 
{
    output << "Drink: " << tray.getdrink() << endl;
    output << "Food: " << tray.getfood() << endl;
    return output;
} 
```

# database - 如何在数据库中插入超链接？

> ID：13663989
> 
> 赞同：0
> 
> 时间：2012-12-01T21:36:42.063
> 
> 标签：database, oledbexception

大家好，我正在尝试动态地将社交分享按钮添加到我的文章中。我想将社交分享脚本与我的文章文本一起插入到数据库中，并使用唯一的分享链接显示它。所以我是这样编码的。这可能不是一个好主意，但我想知道这种方式是否可行。

```
string socialButton = "
<div id='social_nav_horizontal'>    <h3>        Bookmark or Share This Post</h3>    <ul>        <li>            <a class='delicious' href='http://del.icio.us/post?url=Your website title' title='Share this on del.icio.us'>Delicious</a></li>     <li>            <a class='facebook' href='http://www.facebook.com/sharer.php?u=http://yourwebsite.com'>Facebook</a></li>        <li>            <a class='stumbleupon' href='http://www.stumbleupon.com/submit? url=http://www.yoursite.com/'>Stumble</a></li>      <li>            <a class='twitter' href='http://twitter.com/home?status=Your Website Title- http://yourwebsite.com@TwitterUserName'>Twitter</a></li>    </ul></div><p>  &nbsp;</p>"; 
```

所以**“插入 myArticleTable(articleText) 值 ('"+socialButton + articleText.Text+"')”;** 但是在尝试插入时会引发异常。

```
System.Data.OleDb.OleDbException: Syntax error (missing operator) in query expression '' 
```

只有当我直接将它传递到我的**ckeditor (wysiwyg)**富文本编辑器并在按钮单击事件上执行插入语句时，这项工作才有效。

你能帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:01:02.527

因为单引号用于指示字符串的开始和结束，所以需要对其进行转义。简短的回答是使用两个单引号 - '' - 以便 SQL 数据库将值存储为 '.

```
Ex:-
Insert into Person
(First, Last)
Values
('Joe', 'O''Brien') 
```

看看使用 REPLACE 来清理传入的值：

*   甲骨文[更换](http://www.techonthenet.com/oracle/functions/replace.php)
*   [SQL 服务器](http://msdn.microsoft.com/en-us/library/ms186862.aspx)
*   [替换 MySQL](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)
*   [替换 PostgreSQL 替换](http://www.postgresql.org/docs/8.1/static/functions-string.html)

您想检查 ''''，如果它们存在于字符串中，则用 '''''' 替换它们，以逃避唯一的单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-01T22:02:18.830

您还没有意识到这一点，但是您刚刚在您的代码中发现了 SQL 注入漏洞。基本上任何可以在服务器上运行此代码的人都可以将恶意 SQL 放入您的文章中并执行。

这就是错误试图伪装的意思：它解释了您的链接/文章的内容并使它们成为 SQL 的一部分 - 这在语法上变得不正确。不要试图手动转义`socialButton`值`articleText.Text`。改用命名参数：

```
insert into myArticleTable (articleText) values (?) 
```

并使用以下内容填充此参数：

```
cmd.Parameters.AddWithValue("parm1", socialButton + articleText.Text); 
```

请记住，永远不要通过连接字符串来手动生成 SQL。此外，命名参数更简洁。

免责声明：我不是 .NET 开发人员，从[如何参数化复杂的 OleDB 查询中复制了代码片段？](https://stackoverflow.com/questions/9650292)以及[如何使用 oledb 参数更新表？](https://stackoverflow.com/questions/2675610)但是几乎所有语言都适用相同的规则。

# python - 使用正则表达式读取和处理文件

> ID：13663992
> 
> 赞同：1
> 
> 时间：2012-12-01T21:36:59.083
> 
> 标签：python, regex, file-io

我有一个庞大的文件，它只不过是这些块的重复单元：

```
//WAYNE ROONEY (wr10)
  90 [label="90"];
  90 -> 11 [weight=25];
  90 -> 21 [weight=23];
  90 -> 31 [weight=17];
  90 -> 41 [weight=12];
  90 -> 51 [weight=1];
  90 -> 62 [weight=50];
  90 -> 72 [weight=7];
  90 -> 82 [weight=27];
  90 -> 92 [weight=9];
  90 -> 102 [weight=43]; 
```

我需要转换成看起来像这样的格式

```
90 11 25 
```

即我只需要删除所有额外的东西，只需保持数字不变。

我尝试使用正则表达式，这行代码：

```
for line in filein:
    match = re.search('label=" "', line)
    if match:
        print (match.group()) 
```

但它只是打印文件中的所有实例`'label'`。如果我尝试搜索`'label=" "'`，则没有输出。如果我能知道如何阅读标签，那么阅读权重将与它非常相似。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T21:44:14.960

这个怎么样：

```
import re

file = open("file","r")                       

for line in file:                                 
    if re.search('->',line):
        print ' '.join(re.findall('[0-9]+',line)) 
```

输出：

```
90 11 25
90 21 23
90 31 17
90 41 12
90 51 1
90 62 50
90 72 7
90 82 27
90 92 9
90 102 43 
```

只需重定向以保存输出：`python test.py > newfile`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T21:44:18.830

您可以将所有行与以下内容匹配：

1.  `(\d+)`-> 一个数字（反向引用）
2.  `\s*->\s*`-> 空间 -> 空间
3.  `(\d+)`-> 另一个数字（反向引用）
4.  `\s*\[weight=\"`-> 空格和字面量 [weigth="
5.  `(\d+)`-> 另一个数字（反向引用）
6.  `\];`-> 字面量 ]; 结束比赛。

然后你有一个像这样编号的反向引用：

1.  第一个数字
2.  第二个数字
3.  第三个数字

现在您可以使用您想要的模式构建您的字符串。（1 美元 2 美元 3 美元）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T21:44:07.643

要从每一行获取所有数字，请`r'\d+'`与 一起使用`.findall()`：

```
for line in filein:
    if 'label' in line:
        print 'label:',
    print ' '.join(re.findall(r'\d', line)) 
```

不完全清楚你想对这些`label`行做什么，但非常简单的循环会打印出来：

```
label: 90 90
90 11 25
90 21 23
90 31 17 
```

等等

# ruby-on-rails - factorygirl rails，在我的规范中说“最需要”-不知道如何解决

> ID：13663994
> 
> 赞同：0
> 
> 时间：2012-12-01T21:37:30.710
> 
> 标签：ruby-on-rails, factory-bot

我在运行测试时收到以下错误消息。它说问题出在我的演讲规范中，并且顶部是必需的。我不知道这是否与需要我的 spec_helper.rb 文件有关。

```
 1) Lecture has a valid factory
     Failure/Error: FactoryGirl.create(:lecture).should be_valid
     NoMethodError:
       undefined method `after_build=' for #<Lecture:0x007fe7747bce70>
     # ./spec/models/lecture_spec.rb:21:in `block (2 levels) in <top (required)>' 
```

我的工厂如下所示：

```
require 'faker'

FactoryGirl.define do   
  factory :question do      
    association :lecture        
    name { Faker::Lorem.words(1) }

    description {Faker::Lorem.words(7)}

    factory :question_one do
      answer 1
    end

    factory :question_two do
      answer 2
    end

    factory :question_three do
      answer 3
    end
  end
end 
```

这是我的 Lecture_spec 文件

```
require 'spec_helper'

describe Lecture do     
  it "has a valid factory" do
    FactoryGirl.create(:lecture).should be_valid    
  end
end 
```

这是我的演讲工厂，我在这里定义了演讲工厂。

```
FactoryGirl.define do
    factory :lecture do
        #association :question
        name        {Faker::Lorem.words(1)}
        description {Faker::Lorem.words(7)}
        soundfile_file_name {Faker::Lorem.words(1)}
        soundfile_content_type {Faker::Lorem.words(3)}
        soundfile_file_size     {Faker::Lorem.words(8)}

        after_build do |question|
            [:question_one, :question_two, :question_three].each do |question|
                association :questions, factory: :question, strategy: :build
            end
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T22:02:27.050

我认为问题在于您没有定义讲座的工厂。它正在尝试创建一个讲座，但您还没有定义工厂。

为讲座添加工厂应该可以解决问题。在您的工厂文件夹下的自己的 Lectures.rb 文件中执行此操作。

您可以执行以下操作

```
FactoryGirl.define do 
  factory :lecture do
   #some attributes here
  end
end 
```

它应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T23:33:44.193

FactoryGirl uses an `after` method with a lifecycle hook parameter to specify callbacks, so your code should read:

```
after(:build) do |question|
    [:question_one, :question_two, :question_three].each do |question|
        association :questions, factory: :question, strategy: :build
    end
end 
```

See [the Callbacks section in the readme](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#callbacks) for more information.

# file-io - ansible include_if_exists

> ID：13663996
> 
> 赞同：2
> 
> 时间：2012-12-01T21:37:41.793
> 
> 标签：file-io, include, yaml, ansible, configurationmanager

如果文件存在，我正在寻找一种有条件地在 Ansible 播放中包含文件的方法。如果文件不存在，不幸的是，使用“include”会引发致命错误。我正在遍历一堆包并安装它们，我想检查每个包的可选配置文件。请参见下面的简化示例：

```
---
- name: Basic setup of an Ubuntu box
  hosts: all
  vars:
    packages:
      - ack-grep
      - vim
      - zsh
      - htop
      - openssh-server
      - cowsay
  tasks:
    - name: Run package configuration
      action: apt name=$item
      include: "packages/${item}.yml"
      with_items: $packages 
```

一旦脚本试图包含一个不存在的文件，它就会停止并出现错误。我确定我只是想以错误的方式做某事，但我已经做了几个小时并尝试了我能想到的一切，但没有结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-13T01:54:04.350

你不应该这样做，因为它在[https://github.com/ansible/ansible/issues/2726](https://github.com/ansible/ansible/issues/2726)上描述了特别看一下这个评论：

> 是的 include + with_items 不是人们应该使用的东西。
> 
> 我们不应该记录它。
> 
> 虽然我知道您现在在变量中有特定的结构，但最好在任务中使用 with_items 。
> 
> 它不适用于库存变量，所以这就是为什么你想在你的任务/角色中放置循环。

Ansible 1.5 甚至不支持它。如果你尝试运行它，你会得到这个错误：

> 错误：[已弃用]：include + with_items 是已删除的弃用功能。请更新您的剧本。Ansible 未能成功完成。任何错误输出都应该在上面可见。请修复这些错误，然后重试。

在你的剧本中包含其他变量和任务的最佳使用方法是使用角色。看看[http://docs.ansible.com/playbooks_roles.html#task-include-files-and-encouraging-reuse](http://docs.ansible.com/playbooks_roles.html#task-include-files-and-encouraging-reuse)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-25T09:53:53.993

我个人使用

```
- include: ...
  when: condition 
```

因此，您可以根据某个 var 是 true 还是 false 或设置等来调整您的包含。这些 var 甚至可以在库存文件中设置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-03T13:59:55.053

我正在使用 Ansible 版本 2.9.20

```
---
- name: Basic setup of an Ubuntu box
  hosts: all
  vars:
    packages:
      - ack-grep
      - vim
      - zsh
      - htop
      - openssh-server
      - cowsay
  tasks:
    - name: check if file exists
      local_action: stat path=packages/{{ item }}.yml
      with_items: "{{ packages }}"
      register: check_file

    - name: Run package configuration
      action: apt name={{ item.item }}
      with_items: "{{ check_file.results }}"
      when: item.stat.exists 
```

在这里，我在一个剧本中创建了 2 个任务：

*   任务 1 将检查文件是否存在并将输出提供给`check_file`变量，该变量将在第二个任务中读取以执行操作。
*   任务 2 将根据文件状态执行操作，即，如果文件存在则执行操作，否则不执行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-29T19:07:37.573

'include' 是一个任务，用于包含戏剧、角色或更多任务而不是数据文件。任务也必须单独执行（- 块）。如上所述，您需要使用“vars_files”来包含带有变量的文件，以便在播放中使用。

# php - Yii 框架 time() 与行为 time() 不一样

> ID：13663997
> 
> 赞同：1
> 
> 时间：2012-12-01T21:37:47.200
> 
> 标签：php, time, frameworks, yii

我尝试在我的用户表中更新 de last_login_time，但 time() 总是比函数的 updatedTime 行为高 5 小时

```
public function behaviors()
{
    return array(
        'timestamps' => array(
            'class' => 'zii.behaviors.CTimestampBehavior',
            'createAttribute' => 'create_time',
            'updateAttribute' => 'update_time',
            'setUpdateOnCreate' => true,
        )
    );
} 
```

我更新 last_login_time 的功能非常简单：

```
private function userLogedin()
{
    $user = User::model()->findByPk($this->auth->user_id);
    $user->last_login_time = date('Y-m-d H:i:s',time());
    return $user->save();
} 
```

我怎样才能拥有与行为一相同的时间？有没有更友好的方法来创建这种更新？

非常感谢！我是 Yii 的新手，这是我的第一个应用程序，请多多关照 ^^

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:41:18.377

[`CTimestampBehavior`](https://github.com/yiisoft/yii/blob/1.1.12/framework/zii/behaviors/CTimestampBehavior.php)根据 . 报告的*数据库服务器的*本地时间设置时间[`NOW()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_now)。您的代码根据*Web 服务器的*本地时间设置时间，如[`time()`](http://php.net/manual/en/function.time.php).

两台服务器之间的时区差异应解释 5 小时的差异。

如果您想使用与您自己的代码类似的语法来实现相同的效果`CTimestampBehavior`，则必须使用[`CDbExpression`](http://www.yiiframework.com/doc/api/1.1/CDbExpression)：

```
$user = User::model()->findByPk($this->auth->user_id);
$user->last_login_time = new CDbExpression('NOW()');
return $user->save(); 
```

[这里](http://www.yiiframework.com/wiki/10/how-to-automate-timestamps-in-activerecord-models/)也有一个相同的例子。

# iphone - iPhone 应用键盘

> ID：13663998
> 
> 赞同：2
> 
> 时间：2012-12-01T21:37:51.570
> 
> 标签：iphone, ios5, ios6

我想用我自己的自定义图像为 Iphone 制作一个表情符号/表情符号应用程序，我想要将它与键盘集成的选项，但从我在这里看到的情况来看这是不可能的？我在 App Store 上看到一些应用程序具有不同的图像，然后是可以集成到键盘中的常规表情符号，所以是否有可能或者最好只是将副本复制到剪贴板路线。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:05:09.517

这是不可能的。应用商店中有很多表情符号应用程序，所有图标都相同。自 iOS 6 发布以来，表情符号键盘已包含在其中。

# c++ - 多人游戏作弊（例如：Tibia）如何从客户端（在本例中为 C++）访问信息？

> ID：13663999
> 
> 赞同：3
> 
> 时间：2012-12-01T21:38:05.097
> 
> 标签：c++, memory, automation, code-injection

Tibia 是一款通过 C++ 客户端运行的在线多人游戏（[图片](http://www.nerdweek.com.br/wp-content/uploads/2011/12/tibia.jpg)）。有一些作弊工具可以让你改变角色的外观，当你的 HP 达到某个点时使用恢复项目，甚至可以在没有美感的情况下描绘地图（[图片](http://blackdtools.com/screenshotsbsc/menu03.jpg)）。

这些软件如何访问 Tibia 使用的内部存储器，以及它们如何确定特定信息的存储位置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-01T22:25:32.910

您可能知道，应用程序的所有指令/数据都保存在内存中的特定偏移处，通常由编译器设置。使用调试器/反汇编器（例如 ollydbg）或内存“搜索器”（例如 CheatEngine），您可以查看这些。一个简单的过程是在内存中搜索给定值（例如游戏健康），然后通过游戏动态对其进行更改并重复搜索，直到您获得所讨论值的内存地址，这通常是静态的，即：不会改变直到可执行文件得到更新。（实际上，ASLR 等技术用于随机化，但可以规避）

现在使用获得的地址，您可以生成一个处理程序，通过使用 Windows API 执行鼠标点击/击键或通过调用游戏内函数来处理它，这些地址和参数也可以通过调试找到。（例如：如果健康<50%，调用这个函数）

另一种方法是使用代理，通过该代理路由所有流量，您可以在其中注入传出数据包以执行操作，或解析传入数据包以推断条件。

显然，我无法提供示例代码，但您可以从阅读逆向工程基础知识和数据包嗅探开始，然后通过解决crackmes 和遵循诸如CheatEngine 论坛上的单人游戏作弊教程进行练习。

您还可以查看此聊天日志，了解有关机器人和对策的信息，如向非程序员解释的那样：http://pastebin.com/6WWif7gK [（](http://pastebin.com/6WWif7gK) 开始于：20）