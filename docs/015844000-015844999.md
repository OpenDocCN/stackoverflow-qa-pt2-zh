# StackOverflow 问答 15844000-15844999

# android - 方法查询db返回结果

> ID：15844003
> 
> 赞同：0
> 
> 时间：2013-04-05T21:35:04.580
> 
> 标签：android, sqlite

应用程序不会运行。这经常发生：

```
04-05 21:29:09.570: E/AndroidRuntime(1069): Caused by: java.lang.IllegalArgumentException: 
   Cannot bind argument at index 1 because the index is out of range.  
   The statement has 0 parameters. 
```

Main - 调用方法

```
Cursor wow = db.trying("Gold");
       text = (TextView) findViewById(R.id.textView13);
       String quantity = wow.getString(0); //
       text.setText(quantity); 
```

数据库处理程序 - 方法

```
public Cursor trying(String vg){
        String q = "SELECT quantity FROM " + TABLE_CONTACTS + " WHERE name=" + "'" + vg +"'";
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor  cursor = db.rawQuery(q, new String[] {vg});

            if (cursor != null) {
                cursor.moveToFirst();
            }
            return cursor;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T10:13:07.910

问题是

```
 String q = "SELECT quantity FROM " + TABLE_CONTACTS + " WHERE name=" + "'" + vg +"'"; 
```

在您的查询中，您已经指定了 where 条件的参数。之后您再次将其传递给查询

```
Cursor  cursor = db.rawQuery(q, new String[] {vg}); 
```

这会造成混乱。所以尝试更改您的查询

```
String q = "SELECT quantity FROM " + TABLE_CONTACTS + " WHERE name = ?";
SQLiteDatabase db = this.getReadableDatabase();
Cursor  cursor = db.rawQuery(q, new String[] {vg}); 
```

或者你选择另一种方法

```
 String q = "SELECT quantity FROM " + TABLE_CONTACTS + " WHERE name=" + "'" + vg +"'";
    Cursor  cursor = db.rawQuery(q, null);
   if(cursor != null && cursor.getCount()>0){
   cursor.moveToFirst();
   //do your action
   //Fetch your data

}
else {
 Toast.makeText(getBaseContext(), "No records yet!", Toast.LENGTH_SHORT).show();
    return;
} 
```

[参考](https://stackoverflow.com/a/14566988/1450401)

# angularjs - angular.js 和 untappd API，如何发送 Get 请求

> ID：15844005
> 
> 赞同：1
> 
> 时间：2013-04-05T21:35:11.020
> 
> 标签：angularjs

我正在尝试通过 angular.js 连接到 Untappd API；API 文档说

> 每当您调用 API 时，您必须将您的客户端 ID 和客户端密码作为 GET 参数传递，如下所示 [http://api.untappd.com/v4/method_name?client_id=CLIENTID&client_secret=CLIENTSECRET](http://api.untappd.com/v4/method_name?client_id=CLIENTID&client_secret=CLIENTSECRET)

有角度我做了这个简单的控制器

```
function UntappdController($scope,$http) {
$http.get('http://api.untappd.com/v4/user/badges/jonnyjava?client_id=XXX&client_secret=XXX').success(function(data) {
    alert('ok');
 }).
error(function(data, status, headers, config) {
    alert('ko');
});
}
UntappdController.$inject = ['$scope', '$http']; 
```

但它不起作用。（我总是 KO）

所以我尝试了一个 RESTful 服务。这样

```
angular.module('BadgeServices', ['ngResource']).
factory('Badge', function($resource){
  return $resource('http://api.untappd.com/v4/user/badges/jonnyjava/', {}, {
    query: {method:'GET',params:{client_id: 'XXX', client_secret: 'XXX'}, isArray:true}
  });
}); 
```

但这也不起作用......我做错了什么？我是角度的新手。它看起来很简单，但我缺少一些基本的东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:04:48.347

该`error`函数传递了这些变量：`data, status, headers, config`. 检查它们的内容——我确信服务器有一些说明出了什么问题的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T18:21:33.287

对不起，我忘记了！这是我得到的错误函数..

```
data: status:0 headers:function (name) {
    "use strict";
if (!headersObj) headersObj =  parseHeaders(headers);
if (name) {
  return headersObj[lowercase(name)] || null;
}
    return headersObj;
}config:[object Object] 
```

没什么帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T21:56:13.583

解决了！这是一个CORS问题。如果有人感兴趣，解决方案就在这里。 [stackoverflow-Angularjs 问题 $http.get 不工作](https://stackoverflow.com/questions/15542278/angularjs-issue-http-get-not-working?answertab=active#tab-top)

# html - CSS 字母间距 SAFARI

> ID：15844008
> 
> 赞同：1
> 
> 时间：2013-04-05T21:35:19.263
> 
> 标签：html, css, safari, letter-spacing

我有我喜欢的网站，跨浏览器，虽然我在 CSS 中有字母间距，但在 safari 中它不明白我有什么，它破坏了设计 - 有什么建议吗？这是CSS：

```
body 
{
margin: auto;
font-family: 'Lato';
letter-spacing:0.50px;
font-size: 14px;
color: #999; 
font-weight: normal;
} 
```

它似乎没有给它任何东西。它在 Mozilla Firefox 中运行良好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:38:40.290

Webkit 浏览器（Safari、Chrome）与 Gecko（Mozilla）不同。因此，请使用`1px`代替`0.5px`，因为 Webkit 将向下舍入，`0`而 Mozilla 将向上舍入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T06:39:39.397

Chrome/Blink 前段时间已修复此问题，因此这应该适用于当前稳定版本：[http ://src.chromium.org/viewvc/blink?view=revision&revision=153727](http://src.chromium.org/viewvc/blink?view=revision&revision=153727)

Webkit 刚刚解决了这个问题，所以你必须稍等片刻才能让它在 safari 和其他基于 webkit 的浏览器上运行：http: [//trac.webkit.org/changeset/161521](http://trac.webkit.org/changeset/161521)

# vb.net - 防止谷歌通过vb浏览器检测你的流量

> ID：15844012
> 
> 赞同：0
> 
> 时间：2013-04-05T21:35:34.487
> 
> 标签：vb.net, browser

我有这个问题很长时间了，我测试了很多方法来解决它，但我不能。我的主要问题是，当我的 vb 网络浏览器在谷歌搜索时，谷歌从我的计算机网络中检测到异常流量（比如谷歌说），所以我被迫输入谷歌每 5 分钟发送给我的图像字符，然后再次尝试最后一次搜索.

有谁知道防止这种情况的方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:39:27.323

您可能需要使用[Google API](http://code.google.com/)。您可以从他们的网站下载它们。

# sql - H2 DB CSVREAD 命令在放入 VARCHAR 之前将值转换为日期

> ID：15844014
> 
> 赞同：2
> 
> 时间：2013-04-05T21:35:43.837
> 
> 标签：sql, import, h2, csv

我正在尝试加载一个制表符分隔的文本文件，其中包含一列值，这些值恰好看起来像一个日期，但不是。看来CSVREAD命令扫描行，将列中的文本值转换为java.Sql.Date，然后看到目标列是VARCHAR并执行toString（）获取值......这正是不是我需要的。我实际上需要没有任何日期处理的原始未转换文本。

那么，有没有办法在 CSVREAD 命令中关闭“有用的类日期列转换”？

这是我可以用来演示不良行为的最简单案例：

```
CREATE TABLE x
  (
    name VARCHAR NOT NULL
    value VARCHAR
  ) AS
  SELECT *  CSVREAD('C:\myfile.tab', null, 'UTF-8', chr(9))
; 
```

该文件包含三行、一个标题和两个值记录：

```
name\tvalue\n
x\t110313\n
y\t102911\n 
```

任何有关如何绕过 CVSREAD 的过度帮助部分的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T05:50:14.473

（看来您自己发现了这一点，但无论如何）：

对于`CSVREAD`，所有列都是字符串。`CSVREAD`函数或数据库**不会**尝试将值转换为日期，或以任何其他方式尝试检测数据类型。数据库只执行您要求的操作，即在您的情况下将数据作为字符串读取。

如果您确实想将列转换为日期，则需要明确地执行此操作，例如：

```
CREATE TABLE x(name VARCHAR NOT NULL, value TIMESTAMP) AS
SELECT * 
FROM CSVREAD('C:\myfile.tab', null, 'UTF-8', chr(9)); 
```

如果需要非默认解析，您可以使用：

```
CREATE TABLE x(name VARCHAR NOT NULL, value TIMESTAMP) AS
SELECT "name", parsedatetime("value", "M/d/y") as v 
FROM CSVREAD('C:\myfile.tab', null, 'UTF-8', chr(9)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-12T07:07:54.290

对于那些在 csv 文件中没有标题的人，示例可能是这样的：

```
CREATE TABLE x(name VARCHAR NOT NULL, value TIMESTAMP) AS
SELECT "0", parsedatetime("1", 'd-M-yyyy') as v 
FROM CSVREAD('C:\myfile.tab', '0|1', 'UTF-8', '|'); 
```

注意日期格式周围的单引号。当我尝试 Thomas 的示例时，它给了我一个使用 H2 的错误：

> 未找到“dM-yyyy”列；SQL 语句：

我的 csv 文件：

```
firstdate|13-11-2013\n
seconddate|14-11-2013 
```

# php - /.ssh/Authorized_keys 是公共 php

> ID：15844024
> 
> 赞同：-1
> 
> 时间：2013-04-05T21:37:17.003
> 
> 标签：php

当我打开`http://mysite.com/.ssh/authorized_keys`一个页面时，会打开并显示以下信息：

> ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAIEAvz7xl5Q7X+uobuGs9TMWh41A2icZNY2KLNgOHdsDl6E3kfxQhVxXCxBOl0QejWUeJatp0SU3y7//P5E35qDIMdEw8w7W2fpDdnKtmHhcvfs1BiKOP4BxwsE5JDhgt2zPt0RgxK/SR79q8g1oPi9V2xlDduCQ5mZq44vEwSLXVNU=

这是什么？这是脆弱的吗？攻击者可以通过它获得管理员权限吗？如果是这样，他会怎么做？他将如何进行攻击？

版本：PHP/5.3.18

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:45:45.647

ssh 服务器使用该`authorized_keys`文件来存储用于公钥/私钥身份验证的公钥。在 Linux 上，此文件通常位于`.ssh`用户主目录中的密钥所在的目录中。我的猜测是，您使用的用户将 Web 根目录作为其主目录，当为该用户添加公钥时，就会创建此文件。这可能是入侵的迹象，但更有可能是正常的，因为攻击者不需要添加公钥，尤其是在 . 从理论上讲，文件的存在和可见应该没有害处，因为如果没有拥有私钥的人，公钥就没有任何意义，但人们也不需要看到它。如果您知道您不需要该文件，您可以将其删除，或者如果您需要它，您可以放一个`.htaccess`目录中的文件以阻止 Web 访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:44:10.023

看起来您的 Web 根目录设置为您的用户主目录。这绝对是一个安全漏洞。特别是如果您可以访问也在 .ssh 目录中的私钥文件 (id_rsa)。您想在 vhost 配置中更改 DocumentRoot 设置。

# php - 执行数据库查询后关闭会话

> ID：15844026
> 
> 赞同：1
> 
> 时间：2013-04-05T21:37:43.600
> 
> 标签：php, sql, joomla, security

我对 joomla 和 sql 的经验很少，非常感谢您的帮助！我正在使用 joomla 2.5，我正在从数据库中查询数据并将其存储在内存中，代码如下：

```
function getList()
{
    $mainframe = JFactory::getApplication('site');
        $db = JFactory::getDBO();
        $query = "  SELECT 
                    * 
                FROM 
                    #__ListUser 
                WHERE
                    $db->setQuery( $query );"
        $rows = $db->loadObjectList();
        return $rows;
} 
```

我有3个问题，

1.  当我查询数据库时，会打开一个新的数据库会话，我需要在之后关闭它还是自动关闭它？

2.  您知道实现此方法的更有效方法吗（用户会话内存大小约为 11MB！）

3.  使用此方法访问数据库是否存在任何安全问题？

非常感谢你！任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:38:20.533

代码应该是这样的（我现在不明白它是如何工作的）：

```
function getList()
{
   // $mainframe = JFactory::getApplication('site'); // you don't need this line!
        $db = JFactory::getDBO();
        $query = "  SELECT 
                    * 
                FROM 
                    #__ListUser 
                WHERE
                    1=1"; // just some condition to extract selected rows
        $db->setQuery( $query ); // this sets the query and it's joomla, not sql.
        $rows = $db->loadObjectList();
        return $rows;
} 
```

请注意 WHERE .... 需要一个条件（否则，如果您想要所有行，请删除 WHERE 和后面的内容）

1.  你不需要关闭它
2.  11Mb 不一定是由于该查询，尝试添加 LIMIT 0,1 （只返回一行）你会发现你的内存没有太大变化。在全局配置中打开调试，然后重新加载组件。在页面的最底部，您会看到哪些扩展正在占用您的内存。尽管在大多数安装中 11Mb 是可以接受的。
3.  如果您使用输入参数创建 WHERE 条件，只需确保 $db->quote() 任何值以防止 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T03:42:35.787

尝试

```
$db = JFactory::getDbo();
$query = $db->getQuery(true);
$query->select($db->quote('*')
      ->from($db->quoteName('#__Listuser') // Do you really have upper case there?
      ->where('your condition with proper quoting');
$db->setQuery($query);
$rows = $db->loadObjectList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-18T13:33:59.750

1.

**解冷：**

如果要关闭或断开数据库会话，可以使用：

```
$db->disconnect(); // See: http://api.joomla.org/cms-3/classes/JDatabaseDriver.html#method_disconnect 
```

但我想，想要使用 JFactory::getDBO(); 的所有其他模块、插件或模板的数据库连接；当时也关闭了，需要重新打开。

**更好的：**

在将查询传输到 PHP 变量后，您应该使用 FREE RESULT：http: [//api.joomla.org/cms-3/classes/JDatabaseDriverMysql.html#method_freeResult](http://api.joomla.org/cms-3/classes/JDatabaseDriverMysql.html#method_freeResult)

```
$db->freeResult(); 
```

# python - Cython 错误：将整数数组传递给函数时，无法将 Python 对象转换为类型“int *”错误

> ID：15844028
> 
> 赞同：2
> 
> 时间：2013-04-05T21:37:53.787
> 
> 标签：python, pass-by-reference, cython

我正在尝试将整数数组传递给 Cython 中的函数，但我不明白为什么会出现标题中提到的错误。

我正在尝试做的示例代码如下：

```
cpdef foo(int *table):
for i in range(10):
    table[i] = i

cdef int *temp=<int *>malloc(10*sizeof(int))
foo(temp)

for i in range(10):
    print temp[i] 
```

我将不胜感激有关如何将数组正确传递给函数的任何指针。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T21:40:52.173

这里的问题是函数`cpdef`- 这意味着它可以从 C 和 Python 代码中调用，并且意味着所有参数必须是 Python 对象（否则如何从 Python 调用它？）

将其声明为`cdef`。

# php - 可以回显真实但不会返回

> ID：15844030
> 
> 赞同：0
> 
> 时间：2013-04-05T21:37:57.950
> 
> 标签：php

当我的循环完成但它似乎没有发生时，我试图返回 true。我可以让它回显真或假或任何文本，但返回什么也不做。

想知道是否有人可以解释为什么会这样。

这是我删除了数据库调用的（有点）函数，例如它并不重要。

```
function loop_me(){
// this part is not important...
    $finished = false;
    $done  = 0;
    $userC = 1000;
    $page  = 0;
    $count = 10;
    $array = array()
    $data = array('1','2','3') // big array of data...

    if($done < $userC){

    for($i=0; $i<$count; $i++){
        $array[] = $data[$i];
    }

// bellow is the important part...      
    if($done >= $userC){
        $finished = true;
    }else{
       $page++;
       loop_me();
    }
}

if($finished){
// If I echo true it outputs 1 (this is fine)
// if I return true I get nothing this is got good as I want to do an IF statement on the 
// output, which I can't do if it does not.
    echo(true);
}
} 
```

好的，所以上面有问题的函数，但只是为了帮助你，函数的基本思想是我循环认为一个数据数组（上面没有显示）但是这个数据是分页的，所以它需要转到下一个' page' 一旦它完成了第一页和几页，所以我想要做的是当它完成循环时认为它全部返回 true。

可能是一个简单的修复。

但我无法解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:40:10.670

将您的内容编辑`echo (true);`为：`return true;` 然后调用您的函数：

```
$var = loop_me();
echo $var;    // If a success you should see true. 
```

如果在调用定义的函数时出现问题，您还应该考虑添加 return false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:41:15.243

您递归地调用了“loop_me()”，但您需要返回它。

```
}else{
   $page++;
   return loop_me();
} 
```

当然也改变回声返回！

# java - 如何判断 javax.servlet 是否成功发送响应

> ID：15844033
> 
> 赞同：0
> 
> 时间：2013-04-05T21:38:18.230
> 
> 标签：java, servlets, jetty

我正在使用码头服务器来处理 http 请求。我想知道是否有任何方法可以检查响应是否成功发送回客户端。是否有我可以检查的错误代码或状态，或者如果传输到客户端因任何原因失败，我可以捕获异常？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:45:44.017

> 是否有我可以检查的错误代码或状态，或者如果传输到客户端因任何原因失败，我可以捕获异常？

听起来您希望服务器能够知道响应是否已完全传递给客户端。

简单的答案是没有办法知道这一点。TCP/IP 不支持，HTTP 不支持，Servlet API 也不支持。

在某些情况下，如果服务器注意到客户端提前关闭了连接，则可能会引发异常。但是不能保证它会注意到，或者它会导致应用程序 servlet 代码可见的异常。实际上，在 servlet 调用返回之前，很可能不会注意到关闭（如果有的话）。

* * *

如果您想为网页实现某种“响应交付”确认，您*可以*在网页中嵌入一些“onload”Javascript，将 AJAX 请求发送回服务器。但是，您必须考虑用户禁用 Javascript 或原始请求是由非浏览器应用程序发出的情况。

# eclipse - 当我对它进行更改时，如何让 Eclipse 重新编译我的 JUnit 测试？

> ID：15844034
> 
> 赞同：3
> 
> 时间：2013-04-05T21:38:18.273
> 
> 标签：eclipse, maven, junit, compilation, refresh

我在 Mac 10.7.5、Java 6、Junit 4.8.1 和 Maven 3.0.3 上使用 Eclipse Juno。我已将 Maven 项目导入 Eclipse，但无法刷新 JUnit 测试编译。当我在编辑器中编辑 JUnit 测试时，保存它，右键单击测试并选择“运行方式”->“JUnit 测试”，Eclipse 似乎没有重新编译测试，而是使用我的原始类文件目标/测试类目录。当我使用“mvn clean test-compile”在命令行上编译时，更新的类正确地出现在 target/test-classes 目录中。

所以我的问题是，我怎样才能让 Eclipse 正确编译我的测试并将其放在 target/test-classes 目录中？我已经在我的项目设置中验证了“源”下的 myproject/src/test/java，其输出文件夹为 myproject/target/test-classes，其中包含（全部）和排除（无）。

*   戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T21:42:07.787

这很奇怪。JUnit 测试与任何其他 Java 文件一样被处理，它们应该在保存时重新编译。首先，确保 Project -> Build automatically 已启用。

如果是，则转到文件系统，删除测试的类文件，然后从 IDE 内部对文件进行空格更改。文件是否重新生成？我的猜测是。

如果没有，请查看您的错误日志并将所有相关错误粘贴到此处。

# java - 索引列表时的最佳 HashMap 初始容量

> ID：15844035
> 
> 赞同：31
> 
> 时间：2013-04-05T21:38:20.837
> 
> 标签：java, algorithm, dictionary, hashmap

我有一个列表 ( `List<T> list`)，我想使用映射 ( `HashMap<Integer, T> map`) 通过它们的 id 来索引它的对象。我总是在构造函数中`list.size()`用作**初始容量**`HashMap`，如下面的代码所示。这是在这种情况下使用的最佳初始容量吗？

**注意**：我永远不会在地图上添加更多项目。

```
List<T> list = myList;
Map<Integer, T> map = new HashMap<Integer, T>(list.size());
for(T item : list) {
    map.put(item.getId(), item);
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-04-05T21:50:02.220

如果您希望避免重新散列`HashMap`，并且您知道不会将其他元素放入 中`HashMap`，那么您必须考虑负载因子以及初始容量。[a`HashMap`默认](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)的负载因子为 0.75 。

`put`每当添加新条目（例如放置新键/值）时，都会进行确定是否需要重新散列的计算。因此，如果您指定初始容量为`list.size()`，负载因子为 1，那么它将在最后一个 之后重新散列`put`。因此，为防止重新散列，请使用负载因子 1 和容量`list.size() + 1`.

**编辑**

查看`HashMap`源代码，如果*旧*大小达到或超过阈值，它将重新散列，因此不会在最后一个重新散列`put`。所以看起来容量`list.size()`应该没问题。

```
HashMap<Integer, T> map = new HashMap<Integer, T>(list.size(), 1.0); 
```

这是相关的`HashMap`源代码：

```
void addEntry(int hash, K key, V value, int bucketIndex) {
    Entry<K,V> e = table[bucketIndex];
    table[bucketIndex] = new Entry<>(hash, key, value, e);
    if (size++ >= threshold)
        resize(2 * table.length);
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-02-25T00:03:07.867

“容量”关键字在定义上是不正确的，并且没有以通常预期的方式使用。

默认情况下，HashMap 的“负载因子”为 0.75，这意味着当 HashMap 中的条目数达到所提供容量的 75% 时，它将调整数组大小并重新散列。

例如，如果我这样做：

```
Map<Integer, Integer> map = new HashMap<>(100); 
```

当我添加第 75 个条目时，映射会将条目表的大小调整为 2 * map.size()（或 2 * table.length）。所以我们可以做几件事：

1.  更改负载因子 - 这可能会影响地图的性能
2.  将初始容量设置为 list.size() / 0.75 + 1

最好的选择是两者中的后者，让我解释一下这里发生了什么：

```
list.size() / 0.75 
```

这将返回 list.size() + list.size() 的 25%，例如，如果我的列表大小为 100，它将返回 133。然后，如果地图的大小为等于初始容量的 75%，所以如果我们有一个大小为 100 的列表，我们会将初始容量设置为 134，这意味着从列表中添加所有 100 个条目不会导致地图的任何大小调整。

最终结果：

```
Map<Integer, Integer> map = new HashMap<>(list.size() / 0.75 + 1); 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-04-05T21:46:14.713

Guava[`Maps.newHashMapWithExpectedSize`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html#newHashMapWithExpectedSize%28int%29)使用这个辅助方法来计算默认负载因子的初始容量`0.75`，基于一些预期的值数量：

```
/**
 * Returns a capacity that is sufficient to keep the map from being resized as
 * long as it grows no larger than expectedSize and the load factor is >= its
 * default (0.75).
 */
static int capacity(int expectedSize) {
    if (expectedSize < 3) {
        checkArgument(expectedSize >= 0);
        return expectedSize + 1;
    }
    if (expectedSize < Ints.MAX_POWER_OF_TWO) {
        return expectedSize + expectedSize / 3;
    }
    return Integer.MAX_VALUE; // any large value
} 
```

参考：[来源](http://docs.guava-libraries.googlecode.com/git/javadoc/src-html/com/google/common/collect/Maps.html#line.201)

从`newHashMapWithExpectedSize`文档中：

> 创建一个`HashMap`具有足够高的“初始容量”的实例，它*应该可以*容纳`expectedSize`没有增长的元素。这种行为不能得到广泛的保证，但对于 OpenJDK 1.6 来说确实如此。也不能保证该方法不会无意中*过*大返回的地图。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-04-05T21:41:46.163

你在做什么很好。通过这种方式，您可以确定哈希映射*至少有*足够的容量用于初始值。如果您有更多关于哈希映射使用模式的信息（例如：它是否经常更新？是否经常添加许多新元素？），您可能希望设置更大的初始容量（例如，`list.size() * 2`），但永远不要降低。使用分析器确定初始容量是否过快不足。

**更新**

感谢@PaulBellora 建议将初始容量设置为`(int)Math.ceil(list.size() / loadFactor)`（通常，默认负载因子为 0.75）以避免初始调整大小。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-05T21:49:24.763

根据[java.util.HashMap 的参考文档](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)：

> 在设置其初始容量时，应考虑映射中的预期条目数及其负载因子，以尽量减少重新哈希操作的次数。如果初始容量大于最大条目数除以负载因子，则不会发生重新哈希操作。

这意味着，如果您提前知道 HashMap 应该存储多少条目，则可以通过选择适当的初始容量**和负载因子**来防止重新散列。然而：

> 作为一般规则，默认负载因子 (.75) 在时间和空间成本之间提供了良好的折衷。较高的值会减少空间开销，但会增加查找成本（反映在 HashMap 类的大多数操作中，包括 get 和 put）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-19T13:17:43.763

**如果您不知道负载系数/容量内部结构，则经验法则：**

```
initialCapacityToUse = (Expected No. of elements in map / 0.75) + 1 
```

使用这个初始容量值，存储给定的预期数量不会发生重新哈希。地图中的元素集。

# requirejs - Typescript AMD 模块不返回任何内容

> ID：15844043
> 
> 赞同：1
> 
> 时间：2013-04-05T21:38:48.010
> 
> 标签：requirejs, typescript, amd

我正在“log.ts”文件中导出一个简单的函数：

```
export function message(s : string) {
    console.log(s);
} 
```

这是由同一目录中的文件（“MyController.ts”）导入的：

```
import log = module("./log");
class MyController {

    a : string = "aaa";

    constructor () {
        log.message("hello world");
    }
} 
```

编译后，我得到以下 JS：

```
define(["require", "exports", "./log"], function(require, exports, __log__) {
    var log = __log__;

    var MyController = (function () {
        function MyController() {
            this.a = "aaa";
            log.message("hello world");
        }
        return MyController;
    })();    
})
//@ sourceMappingURL=MyController.js.map 
```

这个定义函数应该返回 MyController。因为它没有，所以这个片段中的回调没有得到控制器参数的任何东西：

```
 require(["MyController"], function (controller) {
                    theRoute.controller = controller;
                    defer.resolve();
                    $rootScope.$apply();
                }); 
```

我可以通过在定义调用中手动添加返回来解决这个问题，但这不是一个好的解决方法，因为 JS 是由 TS 编译器输出的。

我做错了什么还是打字稿中的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:59:37.947

你应该写：

```
import log = module("./log");
export class MyController { // <--- 'export'
    a : string = "aaa";
    constructor () {
        log.message("hello world");
    }
} 
```

和：

```
 require(["MyController"], function (controller) {
     theRoute.controller = new controller.MyController(); // <--
     defer.resolve();
     $rootScope.$apply();
   }); 
```

从 0.9.x 开始，您将能够`export = MyController;`在 .ts 文件的底部编写以使该类成为顶级导出对象。

# jquery - Twitter 引导弹出框已损坏

> ID：15844047
> 
> 赞同：1
> 
> 时间：2013-04-05T21:39:17.213
> 
> 标签：jquery, html, css, wordpress, twitter-bootstrap

**笔记：**

*   jQuery 1.9.1
*   引导程序 2.3.1
*   WordPress 3.6 Beta 1 - 此问题仅在 WordPress 3.6 Beta 中发生

似乎弹出框在最新版本的 wordpress 中被破坏了，我有带有弹出框的元素的 html，以及使弹出框工作的 jquery。

**图片**

[![在此处输入图像描述](https://i.stack.imgur.com/AUxsb.png)](https://i.stack.imgur.com/AUxsb.png)

万一你看不到它，弹出的箭头会向左移动，实际上是不透明的

**该特定元素的 HTML：**

```
<div class="control-group">
    <label class="radio">
        <input type="radio" class="regular" name="aisis_options[posts_display]" value="regular_posts" checked=""> Display normal index of posts. 
        <a href="#" id="regularPosts" rel="popover" data-content="This is a regular list of posts, it comes with a sidebar and pagination." data-trigger="hover" data-original-title="Display as Regular Listing">
            <i class="icon-info-sign"></i>
       </a>
    </label>
</div> 
```

jQuery：

```
$("#regularPosts").popover({ html : true }); 
```

我不知道还能向您展示什么，因为我无法授予您对我的 WordPress“实时”开发环境的管理员访问权限。

有人可以告诉我发生了什么事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:28:49.137

我确认两个样式表（Bootstrap 和 Wordpress load-styles.php）之间的冲突出现在*WordPress 3.6 Beta 1*上。

在这个 beta 版本中，他们显然添加了`.arrow`Twitter Bootstrap Popover 也使用的类。

## 我是如何解决的？

1.  **bootstrap.min.js**：替换`<div class="arrow">`为`<div class="popover-arrow">`
2.  **bootstrap.min.css**：批量替换`.arrow`为`.popover-arrow`

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T06:27:59.300

Bootstrap 也会要求您下载 popover 插件，因此请确保您已实现该插件。或者甚至转到自定义引导页面，并确保选择了您的**选项**。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-06T06:53:52.650

好吧，实际上它们在您的代码中没有问题，您已经正确实现了它，问题是**twitter bootstrap css 和 wordpress css 崩溃了，**您必须通过制作 bootstrap css 来自定义它，尝试删除 wordpress css 或将 bootstrap css 制作为`!important`.. . 愿这个技巧对你有用...

# knockout.js - 用 knockoutjs 隐藏标签

> ID：15844051
> 
> 赞同：0
> 
> 时间：2013-04-05T21:39:37.510
> 
> 标签：knockout.js, knockout-2.0

在淘汰赛绑定方面需要一些帮助。我有以下标签]

```
 <a class="link" data-bind="href: Url">My Url</a> 
```

我想要做的是，如果“Url”为空或为空，则隐藏用户视图中的标签。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:44:43.960

你可以尝试这样的事情：

```
<a class="link" data-bind="attr: { href: url}, visible: url().length > 0">
    My Url
</a> 
```

或者如果您根本不希望它出现在标记中：

```
<!-- ko if: url().length > 0 -->
    <a class="link" data-bind="attr: { href: url}">
        My Url
    </a>
<!-- /ko --> 
```

# ios - SKPaymentQueue addPayment 抛出异常

> ID：15844054
> 
> 赞同：3
> 
> 时间：2013-04-05T21:39:55.967
> 
> 标签：ios, objective-c, in-app-purchase, storekit

我已经在 Apple 门户中配置了我的 iOS 应用程序的应用内购买，我要求我的产品使用`SKProductsRequest`并正确接收，然后将它们存储在`NSMutableDictionary`.

```
-(void)productsRequest:(SKProductsRequest *)request didReceiveResponse:(SKProductsResponse*)response
{
    NSLog(@"%@", @"AppStore: Accepted");
    for (SKProduct * s in response.products) {
        NSLog(@"    [%@]", s.productIdentifier);
    }

    [productsById removeAllObjects];

    for (SKProduct * product in response.products) {
        [productsById setObject:product forKey:product.productIdentifier];
    }

    [request release];
} 
```

但是，当尝试进行购买时，这`addPayment`条线会抛出`'NSInvalidArgumentException', reason: '*** setObjectForKey: key cannot be nil'`

```
-(void)purchase:(NSString *)productId {
    SKProduct *selectedProduct = [productsById objectForKey:productId];
    SKMutablePayment *payment = [SKMutablePayment paymentWithProduct: selectedProduct];
    payment.quantity = 1;

    [[SKPaymentQueue defaultQueue] addTransactionObserver: self];
    [[SKPaymentQueue defaultQueue] addPayment: payment]; //<- this line throws an exception
} 
```

正如苹果的文档所说，我已经检查了 productId 是一个有效的产品，并且 payment.quantity 是 > 0。我在模拟器和 iPad 中都尝试过，结果相同。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:24:50.843

我很确定你没有分配`productsById`字典。

`self.productsById = [@{} mutableCopy];`在你的`-viewDidLoad:`方法中加入类似的东西

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T13:04:03.463

我发现了我的问题，错误不在`SKPaymentQueue addPayment:`消息的参数中，而是在执行`SKPaymentQueue paymentQueue: updatedTransactions:` 打印异常的堆栈跟踪之后，我注意到消息实际上是从 立即发送给我的委托的`addPayment:`，我从来没有看到，因为调试器在进入时会直接遇到异常，`addPayment:`而不会破坏我的委托代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-22T08:30:37.963

我有类似的问题。在我的情况下，`SKPaymentQueue.defaultQueue().addPayment(payment)`抛出异常，因为我错过了：

```
SKPaymentQueue.defaultQueue().removeTransactionObserver(self) 
```

在我的`deinit`方法中。

# ios - 如何使用 UIBezierpath 在 touchesEnded 的屏幕上绘制一个点

> ID：15844057
> 
> 赞同：5
> 
> 时间：2013-04-05T21:40:15.797
> 
> 标签：ios, objective-c, uibezierpath

有人可以告诉我如何使用 UIBezierpath 绘制一个点吗？我可以使用 UIBezierpath 画一条线，但是如果我移开手指并将其放回原处，然后再移开，屏幕上什么也不会画出来。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint p = [touch locationInView:self];
    [pPath moveToPoint:p];
    [pPath stroke];
    [self setNeedsDisplay];
}

- (void)drawRect:(CGRect)rect
{
     [pPath stroke];
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T21:48:02.463

您的路径不包括任何要描边的线段或曲线段。

试试这个：

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    CGPoint p = [touches.anyObject locationInView:self];
    static CGFloat const kRadius = 3;
    CGRect rect = CGRectMake(p.x - kRadius, p.y - kRadius, 2 * kRadius, 2 * kRadius);
    pPath = [UIBezierPath bezierPathWithOvalInRect:rect];
    [self setNeedsDisplay];
}

- (void)drawRect:(CGRect)rect {
    [[UIColor blackColor] setFill];
    [pPath fill];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-09-04T06:05:20.643

我使用了这段代码：

```
 -(void)handleTap:(UITapGestureRecognizer*)singleTap { 
     //draw dot on screen

     CGPoint tapPoint = [singleTap locationInView:self];
     [bezierPath_ moveToPoint:tapPoint];
     [bezierPath_ addLineToPoint:tapPoint];

     [self setNeedsDisplay]; 
} 
```

# android - 每 10 分钟在后台执行一次数据库操作

> ID：15844059
> 
> 赞同：1
> 
> 时间：2013-04-05T21:40:24.420
> 
> 标签：android, background, timer

我想每 10 分钟在后台执行一次数据库操作。最好的方法是什么？

也许：

*   话题：*怎么样？*
*   服务：*很复杂？*
*   AsyncTasks：*周期太长*

我目前的做法：

```
CountDownTimer clearDBsCountDownTimer = new CountDownTimer(600000, 600000) {
    @Override
    public void onFinish() {
        ClearDBs();
    }
};

private void ClearDBs() {
    // Clearing databases here
    clearDBsCountDownTimer.start();
} 
```

但它不起作用：我认为是因为该`ClearDBs()`方法等待`CountDownTimer`完成，对吧？

但是如何正确地做到这一点：有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:41:46.363

AlarmManager + IntentService 是最干净的方法。

使用 AlarmManager，您可以安排定期 IntentServices。

`onHandleIntent()`IntentService 是在后台线程（调用）中执行特定操作并终止的服务。

他们完美地组合在后台执行定期工作。

例如检查[这篇文章](http://dhimitraq.wordpress.com/2012/11/27/using-intentservice-with-alarmmanager-to-schedule-alarms/)。

请小心此类操作，因为它们可能会导致电池耗尽（并使用户生气）。

正如@Squonk 所建议的，您可以使用`setRepeating(...)`或`setInexactRepeating(...)`安排定期事件。

如果您只想在您的应用程序处于前台时执行此后台任务，您仍然可以取消事件调用[manager.cancel()](http://developer.android.com/reference/android/app/AlarmManager.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:03:37.673

创建[绑定服务](http://developer.android.com/guide/components/bound-services.html#Binder)将是一个好主意。

对于线程使用[ScheduledExecutorService](http://developer.android.com/reference/java/util/concurrent/ScheduledExecutorService.html)

# java - 为什么这个 GridBagConstraints 代码不起作用？

> ID：15844062
> 
> 赞同：2
> 
> 时间：2013-04-05T21:40:36.060
> 
> 标签：java, gridbaglayout

你好，所以我想在我的面板中添加文本区域、文本字段和按钮。我希望区域使用 3/4 的高度和全宽，字段使用 1/4 的高度和 3/4 的宽度，以及一个按钮使用 1/4 的高度和 1/4 的宽度。我张贴一张照片来显示我想要得到的东西。代码如下：

```
// My JPanel class
public MainPanel() {
   setLayout(new GridBagLayout());
   add(area, new GBC(0, 0, 4, 3).setWeight(4,4).setFill(GBC.BOTH));
   add(field, new GBC(0, 3, 3, 1).setWeight(1,1).setFill(GBC.HORIZONTAL));
} 
```

GBC 是我的类，它继承自 GridBagConstraints 类：

```
public class GBC extends GridBagConstraints {

   public GBC(int gridx, int gridy) {
      this.gridx = gridx;
      this.gridy = gridy;
      weightx = 100;
      weighty = 100;
   }

   public GBC(int gridx, int gridy, int gridwidth, int gridheight) {
      this(gridx, gridy);
      this.gridwidth = gridwidth;
      this.gridheight = gridheight;
   }

   public GBC setFill(int fill) {
      this.fill = fill;
      return this;
   }
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/86WUt.png)

所以问题是区域和字段都占一半高度，并且一个按钮在中心，隐藏在字段下面......无论如何看起来很糟糕，如果如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T21:53:25.827

`weightx`并且`weighty`是指定如何分配额外空间的内容。在您的情况下，它们在水平和垂直方向上都具有相同的值，即**100**。

尝试将`weightx`and设置`weighty`为**4** for并将and`JTextArea`设置为**1** for`weightx``weighty`**`JTextField`**

 **您可以检查文档中每个字段的作用`GridBagConstraints`：

[http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagConstraints.html](http://docs.oracle.com/javase/7/docs/api/java/awt/GridBagConstraints.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:07:21.977

它应该是这样的：

```
add(area, new GBC(0, 0, 4, 3).setWeight(4,4).setFill(GBC.BOTH));
add(field, new GBC(0, 3, 3, 1).setWeight(1,1).setFill(GBC.HORIZONTAL)); 
```

另请阅读有关 weightx 和 weighty 的信息，因为您以错误的方式使用它们**

# dojo - dojo/request/xhr 返回 xml 而不是 json

> ID：15844064
> 
> 赞同：2
> 
> 时间：2013-04-05T21:40:37.033
> 
> 标签：dojo, xmlhttprequest

我正在使用一个简单的 dojo xhr 请求：

```
require(["dojo/query", "dojo/on", "dojo/dom-style", "dojo/request/xhr", "dojo/domReady!"],
            function (query, on, domStyle, xhr) {

                xhr("api/products", {
                    handleAs: 'json'
                }).then(function (data) {
                    console.log('GOT DATA FROM DOJO XHR', data);
                }, function (err) {
                    console.log('ERROR FROM DOJO XHR', err);
                });
            }
        ); 
```

这工作正常，但返回的数据是 XML 而不是 JSON。

但是，jQuery 中的相同调用以 JSON 格式返回数据。

当我查看标题时，对于 jQuery 调用它显示：`Content-Type application/json; charset=utf-8`，但对于 dojo 调用它显示：`Content-Type application/xml; charset=utf-8`

我还补充说：

```
headers: { "Content-Type": "application/json; charset=uft-8" } 
```

到 xhr 参数，但仍然没有运气，它仍然返回 xml。

是什么赋予了？您如何告诉 dojo xhr 将其作为 json 处理？我正在使用dojo 1.8.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T09:22:11.753

服务器本身并不像那样。使用 firebug 检查 dojo 和 jquery 在执行 xhr 时的请求。必须有一个参数告诉服务器它是dojo 或jquery。更改该参数。

dojo和jquery是一样的，都是基于js的，都是用xhr的。请考虑发布两者的确切请求信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T02:08:36.833

修复服务器端的工作，但这是一个创可贴的解决方案。服务器正确响应它在 Accept 标头中看到的内容。即使在 Dojo xhr 调用中您指定了 'application/json'，出于某种原因，Firefox 也会将其替换为 'text/html,application/xhtml+xml,application/xml;q=0.9, */* ;q=0.8' 或类似的东西。因此，.NET 会发回 XML 而不是 JSON。在其他浏览器中不会发生。

我仍在研究如何以正确的方式修复它。

**更新：**我想我有一个答案，但不知道为什么它会修复它。如果我在 xhr 请求中设置 headers 值，如下所示，那么在 Firefox 中一切正常：

标头：{“内容类型”：“应用程序/json；charset=utf-8', '接受': '应用程序/json' }

如果我使用双引号，则这些标头不会传输到服务器，而是返回 XML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T05:19:55.240

好的，找到了为什么会发生的问题，但不是根本原因。

我将 web api 与 asp.net mvc4 一起用于 json 服务。事实证明，对于 dojo，服务返回 xml，但对于 jQuery，它返回 json。

所以，如果它对其他人感兴趣，我是如何修复它的，是在 WebApiConfig 中我删除了 xml 作为支持的返回类型：

```
 var appXmlType = config.Formatters.XmlFormatter.SupportedMediaTypes.FirstOrDefault(t => t.MediaType == "application/xml");
        config.Formatters.XmlFormatter.SupportedMediaTypes.Remove(appXmlType); 
```

由于我只对 JSON 感兴趣，这对我来说没问题，但如果你需要同时支持这两者，那么你可能需要更深入地研究。

所以，总而言之，这个问题并不是真正的dojo xhr 问题，即不是客户端问题，而是服务器问题没有正确处理请求。

希望它对其他人有帮助。

# django - Beautifulsoup django 集成

> ID：15844068
> 
> 赞同：0
> 
> 时间：2013-04-05T21:40:53.627
> 
> 标签：django, python-2.7, beautifulsoup

还是个新手，所以我有一堆看起来很傻的问题。但是，我来了：

作为一个学习 python 的项目，我决定从简单的东西开始。我的想法是去 craigslist 查找摩托车的价格，浏览每个城市的前 10 页，然后给出平均值、中位数和价格趋势。这项工作的结果可以在这里找到（[http://craigslistcompanion.co.nf/](http://craigslistcompanion.co.nf/)）以及代码。

现在为了让事情变得更好，我决定让用户输入他们想要的东西（摩托车/汽车/自行车）以及从哪里输入（sfbay/austin 等）并获得与该页面所示相同的结果。当我开始研究它时，我被告知学习 django 将是一个很好的起点，过去几天我一直在尝试这样做。然而，到目前为止我所学到的主要是建立数据库并处理它们。

我想知道某处是否有教程可以告诉我如何从用户那里获取输入然后对其进行操作。我想完全使用 python/django 来做到这一点。

例如，假设我希望用户输入他们的名字和姓氏，然后尝试使用该字符串并输出一些东西。我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T03:23:24.310

First some clarification. Do you want to develop a web interface for your users? If so, then Django is a great start. [The Django Book](http://www.djangobook.com/en/2.0/index.html "The Django Book") is a very good introduction to Django and teaches you with examples. The task of getting user information, validating it, manipulating it and saving it in a database is the most basic of task and it is explained well in the book.

The next thing is web scraping craigslist. From how you structured your question, it seams that you have solved that part of the problem. right?

# java - 调整 JPanel 大小后组件消失

> ID：15844070
> 
> 赞同：3
> 
> 时间：2013-04-05T21:40:55.053
> 
> 标签：java, swing, jpanel, paintcomponent

我正在尝试使用鼠标单击后出现的可拖动十字创建 JPanel。一切正常，但是当我调整 JPanel 的大小时，十字架消失了。我试图在我的 JPanel 中覆盖 paintComponent 方法，但是所有的十字都在坐标 (0,0) 处。我该如何解决？

```
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionAdapter;
import java.util.ArrayList;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class CrossPanel extends JPanel implements MouseListener {

private int orderOfCross = 0;
private ArrayList<Cross> crosses;
private int defaultSizeOfCrosses = 10;

CrossPanel() {
    setOpaque(false);
    addMouseListener(this);
    crosses = new ArrayList<Cross>();
}

@Override
public void mouseClicked(MouseEvent e) {
    int x = e.getX();
    int y = e.getY();
    Cross cross = new Cross(orderOfCross++, defaultSizeOfCrosses);
    crosses.add(cross);
    cross.setLocation(x - defaultSizeOfCrosses, y - defaultSizeOfCrosses);
    add(cross);
    repaint();
}

@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    //        for (int i = 0; i < crosses.size(); i++) {
    //            crosses.get(i).paint(g);
    //        }
}

@Override
public void mousePressed(MouseEvent e) {}

@Override
public void mouseReleased(MouseEvent e) {}

@Override
public void mouseEntered(MouseEvent e) {}

@Override
public void mouseExited(MouseEvent e) {}

public static void main(String[] args) {
    JFrame f = new JFrame();
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    CrossPanel crossPane = new CrossPanel();
    f.getContentPane().add(crossPane);
    f.setSize(600, 500);
    f.setLocation(200, 200);
    f.setVisible(true);
}
}

class Cross extends JComponent {

private int order;
protected Cursor draggingCursor = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
private volatile int draggedAtX, draggedAtY;
int size;

public Cross(int order, int size) {
    this.order = order;
    this.size = size;
    this.setBounds(0, 0, 4 * size, 3 * size + 10);
    addDragListeners();
    setCursor(draggingCursor);
}

@Override
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    Graphics2D g2 = (Graphics2D) g;
    g2.setColor(Color.red);
    g2.setStroke(new BasicStroke(3));
    g2.drawLine(0, size, size + size, size);
    g2.drawLine(size, 0, size, size + size);
    Font f = new Font("Monospaced", Font.BOLD, size + 10);
    g2.setFont(f);
    g2.drawString(String.valueOf(order), size - size / 2, 3 * size + 10);
}

private void addDragListeners() {
    addMouseListener(new MouseAdapter() {
        @Override
        public void mousePressed(MouseEvent e) {
            draggedAtX = e.getX();
            draggedAtY = e.getY();
        }
    });
  addMouseMotionListener(new MouseMotionAdapter() {
        @Override
        public void mouseDragged(MouseEvent e) {
            Point newLocation = new Point(e.getX() - draggedAtX + getLocation().x,  e.getY() - draggedAtY + getLocation().y);
            setLocation(newLocation);
        }
    });
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:59:44.440

我很少看到`null`布局的用途，对于所有感知的好处，有很多缺点。

整个 Swing API 是围绕布局管理器的使用而设计的，所以你会很疯狂（恕我直言）简单地扔掉所有这些工作。

如果您发现自己处于可用布局管理器似乎无法执行您想要的操作的位置，那么编写您自己的布局管理器可能更值得。

在这里，我提出了一个`PropertionalLayoutManager`其意图是提供布局功能，该功能将根据父组件的宽度/高度百分比将组件放置在容器上。这意味着，当父组件调整大小时，子组件将以父组件的百分比重新定位。

![在此处输入图像描述](https://i.stack.imgur.com/CXYxd.png)![在此处输入图像描述](https://i.stack.imgur.com/9W1Ze.png)

```
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Component;
import java.awt.Container;
import java.awt.Cursor;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.LayoutManager2;
import java.awt.Point;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionAdapter;
import java.text.NumberFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class CrossPanel extends JPanel implements MouseListener {

    private int orderOfCross = 0;
    private ArrayList<Cross> crosses;
    private int defaultSizeOfCrosses = 10;

    CrossPanel() {
        setOpaque(false);
        addMouseListener(this);
        crosses = new ArrayList<Cross>();
        setLayout(new PropertionalLayoutManager());
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        int x = e.getX();
        int y = e.getY();
        Cross cross = new Cross(orderOfCross++, defaultSizeOfCrosses);

        float xPos = (float)x / (float)getWidth();
        float yPos = (float)y / (float)getHeight();

        crosses.add(cross);

        add(cross, new PropertionalConstraints(xPos, yPos));
        revalidate();
    }

    public static String format(float value) {
        return NumberFormat.getNumberInstance().format(value);
    }

    @Override
    public void mousePressed(MouseEvent e) {
    }

    @Override
    public void mouseReleased(MouseEvent e) {
    }

    @Override
    public void mouseEntered(MouseEvent e) {
    }

    @Override
    public void mouseExited(MouseEvent e) {
    }

    public static void main(String[] args) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        CrossPanel crossPane = new CrossPanel();
        f.getContentPane().add(crossPane);
        f.setSize(600, 500);
        f.setLocation(200, 200);
        f.setVisible(true);
    }

    public class Cross extends JComponent {

        private int order;
        protected Cursor draggingCursor = Cursor.getPredefinedCursor(Cursor.HAND_CURSOR);
        private volatile int draggedAtX, draggedAtY;
        int size;

        public Cross(int order, int size) {
            this.order = order;
            this.size = size;
//            this.setBounds(0, 0, 4 * size, 3 * size + 10);
            addDragListeners();
            setCursor(draggingCursor);
            Font f = new Font("Monospaced", Font.BOLD, size + 10);
            setFont(f);

        }

        @Override
        public Dimension getPreferredSize() {
            // This is dangrous, you are making assumptions about platforms
            // that you have no eviednce to support.
            FontMetrics fm = getFontMetrics(getFont());
            return new Dimension(Math.max(fm.stringWidth(String.valueOf(order)), size), size + fm.getHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2 = (Graphics2D) g;
            g2.setColor(Color.red);
            g2.setStroke(new BasicStroke(3));

            FontMetrics fm = g2.getFontMetrics();

            int width = getWidth() - 1;
            int height = getHeight() - 1;

            int x = (width - fm.stringWidth(String.valueOf(order))) / 2;
            int y = fm.getAscent();
            g2.drawString(String.valueOf(order), x, y);

            int crossSize = Math.min(width, height - fm.getHeight());
            x = (width - crossSize) / 2;
            y = fm.getHeight();
            g2.drawLine(x, y, x + crossSize, y + crossSize);
            g2.drawLine(x + crossSize, y, x, y + crossSize);
        }

        private void addDragListeners() {
            addMouseListener(new MouseAdapter() {
                @Override
                public void mousePressed(MouseEvent e) {
                    draggedAtX = e.getX();
                    draggedAtY = e.getY();
                }

            });
            addMouseMotionListener(new MouseMotionAdapter() {
                @Override
                public void mouseDragged(MouseEvent e) {
                    Point newLocation = new Point(e.getX() - draggedAtX + getLocation().x, e.getY() - draggedAtY + getLocation().y);
                    setLocation(newLocation);
                }

            });
        }

    }

    public class PropertionalConstraints {

        private float x;
        private float y;

        public PropertionalConstraints(float x, float y) {
            this.x = x;
            this.y = y;
        }

        public float getX() {
            return x;
        }

        public float getY() {
            return y;
        }

        public void setX(float x) {
            if (x > 1f) {
                x = 1f;
            } else if (x < -0f) {
                x = 0f;
            }
            this.x = x;
        }

        public void setY(float y) {
            if (y > 1f) {
                y = 1f;
            } else if (y < -0f) {
                y = 0f;
            }
            this.y = y;
        }

    }

    public class PropertionalLayoutManager implements LayoutManager2 {

        private Map<Component, PropertionalConstraints> mapConstraints;

        public PropertionalLayoutManager() {
            mapConstraints = new HashMap<>(25);
        }

        public PropertionalConstraints getConstraintsFor(Component comp) {
            return mapConstraints.get(comp);
        }

        public void setConstraintsFor(Component comp, PropertionalConstraints pc) {
            mapConstraints.put(comp, pc);
        }

        @Override
        public void addLayoutComponent(Component comp, Object constraints) {
            if (constraints instanceof PropertionalConstraints) {
                mapConstraints.put(comp, (PropertionalConstraints) constraints);
            } else {
                throw new IllegalArgumentException("Constraints must be PropertionalConstraints");
            }
        }

        @Override
        public Dimension maximumLayoutSize(Container target) {
            return preferredLayoutSize(target);
        }

        @Override
        public float getLayoutAlignmentX(Container target) {
            return 0.5f;
        }

        @Override
        public float getLayoutAlignmentY(Container target) {
            return 0.5f;
        }

        @Override
        public void invalidateLayout(Container target) {

        }

        @Override
        public void addLayoutComponent(String name, Component comp) {

        }

        @Override
        public void removeLayoutComponent(Component comp) {
            mapConstraints.remove(comp);
        }

        @Override
        public Dimension preferredLayoutSize(Container parent) {
            return parent.getSize();
        }

        @Override
        public Dimension minimumLayoutSize(Container parent) {
            return preferredLayoutSize(parent);
        }

        @Override
        public void layoutContainer(Container parent) {
            int width = parent.getWidth();
            int height = parent.getHeight();
            for (Component comp : parent.getComponents()) {
                PropertionalConstraints con = mapConstraints.get(comp);
                if (con != null) {
                    int x = (int)(width * con.getX());
                    int y = (int)(height * con.getY());
                    comp.setSize(comp.getPreferredSize());
                    comp.setLocation(x, y);
                } else {
                    comp.setBounds(0, 0, 0, 0);
                }
            }
        }

    }

} 
```

在一些旁注中，您正在使用“魔术”数字来确定某些元素的大小和渲染位置。这是一个非常糟糕的主意。您应该，尤其是在绘画或印刷时，将所有这些值都基于经验值。

在此示例中，我已恢复为使用`FontMertrics`来提供所需的信息，以更准确地计算各种元素的大小和位置。这将允许更好的跨平台支持，因为并非所有字体在所有平台上都呈现相同；）

# ember.js - 如何通过 Ember.js 中的需求 API 访问 itemController 中的属性

> ID：15844071
> 
> 赞同：2
> 
> 时间：2013-04-05T21:41:07.503
> 
> 标签：ember.js

当我通过需求 API 访问控制器的内容时​​，如何访问 itemController 的属性？

```
App.PostsIndexController = Ember.ArrayController.extend
  itemController: 'post'
  someAction: -> console.log("i'm melting!")

App.PostController = Ember.ObjectController.extend
  someComputedProperty: (-> true ).property()

App.IndexController = Ember.Controller.extend
  needs: ['postsIndex'] 
```

```
<script type="text/x-handlebars" data-template-name="index">
  {{#each post in controllers.postsIndex.content}}
    {{someComputedProperty}}
    <a {{action someAction target="postsIndex"}}>click</a>
  {{/each}}
</script> 
```

我试过`{{controllers.postsIndex.someComputedProperty}}`并`{{someComputedProperty}}`在`index`模板中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:48:36.817

> 当我通过需求 API 访问控制器的内容时​​，如何访问 itemController 的属性？

首先，您应该将 传递`controllers.postsIndex`给`{{each}}`助手而不是`controllers.postsIndex.content`. 否则，`{{each}}`助手将在您的模型对象上循环而不通过`PostsIndexController`. 所以就像@MilkyWayJoe 建议的那样，尝试类似：

```
<script type="text/x-handlebars" data-template-name="index">
  {{#each post in controllers.postsIndex}}
    {{someComputedProperty}}
    <a {{action someAction target="postsIndex"}}>click</a>
  {{/each}}
</script> 
```

> 我试过了，但似乎 someComputedProperty 在更改时不会更新，尽管它在页面加载时计算正确。

除非您指定依赖项列表，否则 Ember 计算属性不会更新：

```
App.PostController = Ember.ObjectController.extend
  someComputedProperty: (-> true ).property('title', 'someotherproperty', 'etc') 
```

# c++ - 字符串连接的c ++开销

> ID：15844074
> 
> 赞同：4
> 
> 时间：2013-04-05T21:41:15.253
> 
> 标签：c++, string, optimization, file-io

我正在从 ifstream 中读取随机 ascii 的文本文件。我需要能够将整个消息放入字符串类型以进行字符解析。我当前的解决方案有效，但我认为我正在使用等效的方法在更长的文件上谋杀处理时间：

```
std::string result;

for (std::string line; std::getline(std::cin, line); )
{
    result += line;
} 
```

我担心与这样的连接字符串相关的开销（这种情况发生了几千次，消息长达数千个字符）。我过去几天一直在浏览不同的潜在解决方案，但没有什么是非常合适的......我不知道提前消息的长度，所以我不认为使用动态大小的字符数组是我的答案.

我通读了这个听起来几乎适用但仍然让我不确定的[SO 线程；](https://stackoverflow.com/questions/10961224/performance-overhead-of-c-string-tokenize-via-istringstream)

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:06:55.620

问题实际上是您不提前知道完整大小，因此您无法适当地分配内存。我希望您获得的性能影响与此有关，而不是与`string`s 连接的方式有关，因为它在标准库中有效地完成了。

因此，我建议推迟连接，直到您知道 final 的完整大小`string`。也就是说，您首先将所有字符串存储在一个大`vector`文件中：

```
using namespace std;
vector<string> allLines;
size_t totalSize = 0;
// If you can have access to the total size of the data you want
// to read (size of the input file, ...) then just initialize totalSize
// and use only the second code snippet below.
for (string line; getline(cin, line); )
{
    allLines.push_back(line);
    totalSize += line.size();
} 
```

然后，您可以`string`提前知道它的大小来创建您的大：

```
string finalString;
finalString.reserve(totalSize);
for (vector<string>::iterator itS = allLines.begin(); itS != allLines.end(); ++itS)
{
    finalString += *itS;
} 
```

不过，我应该提一下，只有在遇到性能问题**时才应该这样做。**不要尝试优化不需要的东西，否则会使程序复杂化而没有明显的好处。我们需要优化的地方通常是违反直觉的，并且可能因环境而异。因此，只有在您的分析工具告诉您需要时才这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:55:25.610

您正在为文件中的每一行复制结果数组（当您展开结果时）。而是预先分配结果并以指数方式增长：

```
std::string result;
result.reserve(1024); // pre-allocate a typical size

for (std::string line; std::getline(std::cin, line); )
{
    // every time we run out of space, double the available space
    while(result.capacity() < result.length() + line.length())
        result.reserve(result.capacity() * 2);

    result += line;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T21:47:00.727

如果您知道文件大小，请使用 result 的成员函数 'reserve()' 一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T21:48:33.723

我太困了，无法为您整理任何可靠的数据，但最终，在不提前知道大小的情况下，您*总是*不得不做这样的*事情*。事实上，您的标准库实现足够智能，可以相当巧妙地处理字符串大小调整。（尽管事实上 没有指数增长保证`std::string`，但 有`std::vector`。）

因此，尽管您可能会在前 50 次左右的迭代中看到不需要的重新分配，但一段时间后，重新分配的块变得如此之大，以至于重新分配变得很少见。

如果您分析并发现这仍然是一个瓶颈，也许使用`std::string::reserve`一个*典型的*数量。

# javascript - 在jQuery中获取url参数不起作用

> ID：15844076
> 
> 赞同：0
> 
> 时间：2013-04-05T21:41:21.313
> 
> 标签：javascript, jquery, html, jquery-mobile

这是页面的链接：

localhost/basket/newstext.html?url= [http://www.basket-planet.com/ru/news/9246](http://www.basket-planet.com/ru/news/9246)

当页面加载时，我试图提醒 url，所以我知道它在一个变量中。但事实并非如此。我发现了很多方法，但没有一个对我有用。我不明白为什么！！！我的html页面：

```
<head>
<script src="js/newstext.js"></script>
</head>
<body>
<div data-role="page" id="newstext">
</div>
</body> 
```

js脚本：

```
$('#newstext').bind('pageshow', function(event) {
var url = getUrlVars()["url"];
alert (url);
});

function getUrlVars() {
var vars = [], hash;
var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
for(var i = 0; i < hashes.length; i++)
{
    hash = hashes[i].split('=');
    vars.push(hash[0]);
    vars[hash[0]] = hash[1];
}
return vars;
} 
```

我很想得到这个答案……请帮忙！！！

更新：这是在第一页附加链接和文章的 js 脚本：

```
var serviceURL = "http://localhost/basket/services/";
var news;
$('#mainNews').bind('pageinit', function(event) {
getNews();
});

function getNews() {
$.getJSON(serviceURL + 'getmainnews.php', function(data) {
    $('#fnews li').remove();
    mainnews = data.items;
    $.each(mainnews, function(index, mnews) {
        $('#fnews').append('<li data-icon="false"><a style="white-space:normal;" href="newstext.html?url=http://www.basket-planet.com' + mnews.link + '">' + mnews.article + '</a></li>');
    });
    $('#fnews').listview('refresh');
});
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:45:23.860

我终于让它工作了。从看到页面转换是如何处理的，我应该记得当我阅读它时，jQuery Mobile 通过 AJAX 处理所有事情。解决方法是添加 $.mobile.ajaxEnabled = false; 在第一页，这样页面就可以像普通网页一样处理。

如果有人可以添加到这个并告诉我在启用 AJAX 的情况下如何做到这一点，那就太好了。但是经过很多努力，这是我找到的唯一解决方案。感谢大家的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:59:43.630

一周后我遇到了这个问题，这就是我所做的尝试：

```
function GetURLParameter(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++) 
    {
       var sParameterName = sURLVariables[i].split('=');
       if (sParameterName[0] == sParam) 
       {
        return sParameterName[1];
       }
    }
}​ 
```

并调用此函数：

```
 var tech = GetURLParameter('technology'); 
```

感谢[http://jquerybyexample.blogspot.com/2012/06/get-url-parameters-using-jquery.html](http://jquerybyexample.blogspot.com/2012/06/get-url-parameters-using-jquery.html)

试试看：）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-05T21:56:05.053

如果您只想使用 Javascript 获取当前 URL，这是最简单的方法。

```
<html>
  <body>
    <script>alert(window.location);</script>
  </body>
</html> 
```

# django - 在 django 的同一个基于类的视图中使用不同的权限装饰器

> ID：15844077
> 
> 赞同：0
> 
> 时间：2013-04-05T21:41:33.197
> 
> 标签：django, django-class-based-views

我最近在我的 Django 应用程序中切换到基于类的视图，并希望尽可能优雅地使用它们。在应用程序中，我有一个评论系统，如果权限匹配，管理员应该能够删除和/或发布/取消发布评论。我为此写了一个`RedirectView`，包括两个功能：

```
class CommentChangeView(RedirectView, SingleObjectMixin):
    """
    A redirection that acts on a Comment. The url parameter
    "action" is taken as a class function and executed.
    """

    model = Comment

    def get_redirect_url(self, pk):
        """
        Redirect to the article page, always.
        """
        return reverse('post', args=(self.object.post.slug,))

    def get(self, *args, **kwargs):
        """
        Here, it is decided what to execute.
        """

        self.object = self.get_object()
        func = getattr(self, kwargs.pop('action', None), None)

        if callable(func):
            func()

        return super(CommentChangeView, self).get(*args, **kwargs)

    @method_decorator(permission_required('blog.delete_comment'))
    def delete(self):
        """
        Delete the comment
        """

        self.object.delete()
        messages.success(self.request, 'Comment deleted.')

    @method_decorator(permission_required('blog.change_comment'))
    def toggle_publish(self):
        """
        Toggle its publication state
        """

        self.object.published = not self.object.published
        self.object.save()
        messages.success(self.request, 'Comment toggled.') 
```

现在的问题是，我希望这两个操作具有不同的权限 - 因此有不同的装饰器。通常，`dispatch`功能是装饰的。上面的代码不起作用，我得到一个`TypeError`. 没有装饰器，它可以完美地工作。

我将如何实施这种情况？或者我应该将删除和发布的视图分开吗？

* * *

这是 StackTrace 的`TypeError`：

```
Internal Server Error: /comment/toggle_publish/1/
Traceback (most recent call last):
  File "/***/lib/python2.7/site-packages/django/core/handlers/base.py", line 115, in get_response
    response = callback(request, *callback_args, **callback_kwargs)
  File "/***/lib/python2.7/site-packages/django/views/generic/base.py", line 68, in view
    return self.dispatch(request, *args, **kwargs)
  File "/***/lib/python2.7/site-packages/django/views/generic/base.py", line 86, in dispatch
    return handler(request, *args, **kwargs)
  File "/***/blog/blog/views.py", line 186, in get
    func()
  File "/***/lib/python2.7/site-packages/django/utils/decorators.py", line 25, in _wrapper
    return bound_func(*args, **kwargs)
TypeError: _wrapped_view() takes at least 1 argument (0 given) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T09:44:10.763

Bibhas 通过更仔细地查看 StackTrace 为我指明了正确的方向。我能够通过为函数引入一个额外的参数来使其工作。此代码现在有效：

```
class CommentChangeView(RedirectView, SingleObjectMixin):
    """
    A redirection that acts on a Comment. The url parameter
    "action" is taken as a class function and executed. It therefore
    combines the delete and publish_comment functions (and, later, possibly)
    more.
    """

    model = Comment

    def get_redirect_url(self, pk):
        """
        Redirect to the article page, always.
        """
        return reverse('post', args=(self.object.post.slug,))

    def get(self, request, *args, **kwargs):
        """
        Here, it is decided what to execute.
        """

        self.object = self.get_object()
        func = getattr(self, kwargs.pop('action', None), None)

        if callable(func):
            func(request)

        return super(CommentChangeView, self).get(request, *args, **kwargs)

    @method_decorator(permission_required('blog.delete_comment'))
    def delete(self, request):
        """
        Delete the comment
        """

        self.object.delete()
        messages.success(self.request, 'Comment deleted.')

    @method_decorator(permission_required('blog.change_comment'))
    def toggle_publish(self, request):
        """
        Toggle its publication state
        """

        self.object.published = not self.object.published
        self.object.save()
        messages.success(self.request, 'Comment toggled.') 
```

# android - 使用来自一个来源的多个图像视图

> ID：15844079
> 
> 赞同：2
> 
> 时间：2013-04-05T21:41:42.210
> 
> 标签：android, imageview

我有一个 Imageview，`activity_main.xml`我想从这个不同的位置画两个。我试过这个没有成功：

```
 image = (ImageView)findViewById(R.id.imageView1);
    image2 = (ImageView)findViewById(R.id.imageView1);

    LayoutParams params = (LinearLayout.LayoutParams) image.getLayoutParams();
    LayoutParams params2 = (LinearLayout.LayoutParams) image2.getLayoutParams();

    params.topMargin = 50;
        params.leftMargin = 50;
        image.setLayoutParams(params);

        params2.topMargin = 100;
        params2.leftMargin = 100;
        image2.setLayoutParams(params2); 
```

它只画了一块。我也试过`setImageBitmap`：

```
image2.setImageBitmap(((BitmapDrawable)image.getDrawable()).getBitmap()); 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:50:54.770

您不能像那样重复使用相同的 ImageView。您需要将另一个 ImageView 添加到您的布局 xml 文件中：

```
<ImageView
android:layout_height="wrap_content"
android:layout_width="wrap_content"
android:id="@+id/imageView2" /> 
```

然后更改此行：

```
image2 = (ImageView)findViewById(R.id.imageView1); 
```

对此：

```
image2 = (ImageView)findViewById(R.id.imageView2); 
```

顺便说一句，您应该避免使用像`imageView1`and之类的名称`imageView2`。这些根本不是描述性的，它们使您更难理解您的代码实际上在做什么。考虑使用更能描述变量作用的变量名称。它将使您的代码更易于理解和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:53:05.023

您只看到一个`ImageView`，因为`ImageView`您的布局中只有一个。两者`image`和在您的布局中`image2`引用相同的 id ( )：`R.id.imageView1`

```
image = (ImageView)findViewById(R.id.imageView1);
image2 = (ImageView)findViewById(R.id.imageView1); 
```

正如我所见，你可以解决这两种方法：

1.  一次膨胀你`ImageView`的 s 并在运行时将它们添加到你的布局中。对于您要尝试做的事情，这有点复杂。
2.  使用所需的适当边距将另一个添加`ImageView`到您的 xml 布局（将 id 设置为）。`R.id.imageView2`然后只需`ImageView`在代码中引用每个并单独编辑它们。

解决方案 #2 在您的代码中看起来像这样（在`ImageView`您的 xml 布局中添加第二个之后）：

```
image = (ImageView)findViewById(R.id.imageView1);
image2 = (ImageView)findViewById(R.id.imageView2); 
```

# authentication - 詹金斯 LDAP 身份验证 - 拒绝

> ID：15844084
> 
> 赞同：0
> 
> 时间：2013-04-05T21:41:49.023
> 
> 标签：authentication, jenkins, ldap

我们使用 Jenkins 和 LDAP 身份验证。我的问题：是否可以实施这种权利方案？

```
if not logged-in (anonymous)                      ==> read all                           
if logged in (via LDAP) but not a "special" user  ==> full access to specified jobs only 
if logged in (via LDAP) and also a "special" user ==> full admin access 
```

我的目标是避免显式管理大量用户。

有一个插件“角色策略插件”支持指定作业的权限，但它不区分匿名用户和登录（通过 LDAP）用户。似乎授予对指定作业的访问权限的唯一方法是逐个用户授予它……我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:11:27.577

可以使用 Active Directory 吗？如果是这样：

*   您可以使用组进行身份验证，从而将权限分配给整个组。
*   您可以使用基于项目的矩阵，因此指定的作业仅对特定组可见

如果您不能（仅 LDAP）：

我认为您仍然可以执行上述操作，但我认为您的 LDAP 配置将需要为组做更多的工作。我不确定 Jenkins LDAP API 中的组支持。

# php - 多阶段联系表 - PHP

> ID：15844087
> 
> 赞同：0
> 
> 时间：2013-04-05T21:41:59.930
> 
> 标签：php, forms, contact-form, multi-step

[http://webexpedition18.com/download/signup_form_WebExpedition18/](http://webexpedition18.com/download/signup_form_WebExpedition18/)

嗨，大家好，

上面的多阶段联系表非常适合我自己的项目。它看起来很棒并且可以解决问题，但是当我试图获取通过电子邮件提交的信息时，我感到很困惑。

所以我有一个漂亮的表格，但它不会发送任何信息，所以对我来说毫无用处。即使我只是从教程站点上传未修改的演示文件，它仍然无法正常工作。

这是我的html：

```
<div id="container">
 <form action="contact.php" method="post">
    <div id="first_step">
        <div class="form">
            <label for="full-name">Full Name:</label> <input id="username"
            name="full-name" style="margin-bottom:10px;" type="text" value=
            ""> <label for="telephone">Telephone:</label> <input id=
            "username" name="telephone" style="margin-bottom:10px;" type=
            "text" value=""> <label for="email-address">Email
            Address:</label> <input id="username" name="email-address"
            style="margin-bottom:10px;" type="text" value="">
        </div>

        <div class="clear"></div><input class="submit" id="submit_first"
        name="submit_first" type="submit" value="Next">
    </div>

    <div class="clear"></div>

    <div id="second_step">
        <div class="form">
            <label for="company-name">Company Name (if you have
            one):</label> <input id="username" name="company-name" style=
            "margin-bottom:10px;" type="text" value=""> <label for=
            "existing-website">Existing Website (if you have one):</label>
            <input id="username" name="existing-website" style=
            "margin-bottom:10px;" type="text" value=""> <label for=
            "existing-domain">What domain would you like the new website to
            be on?</label> <input id="username" name="existing-domain"
            style="margin-bottom:10px;" type="text" value="">
        </div>

        <div class="clear"></div><input class="submit" id="submit_second"
        name="submit_second" type="submit" value="Next">
    </div>

    <div class="clear"></div>

    <div id="third_step">
        <div class="form">
            <label for="which-package">Which package would you
            like?:</label>

            <p><label><input id="RadioGroup1_0" name="RadioGroup1" type=
            "radio" value="Standard"> Standard</label> <label><input id=
            "RadioGroup1_1" name="RadioGroup1" type="radio" value=
            "Business"> Business</label> <label><input id="RadioGroup1_2"
            name="RadioGroup1" type="radio" value="Professional">
            Professional</label></p><label for="which-template">Which
            template would you like?:</label>

            <p><label><input id="RadioGroup2_0" name="RadioGroup2" type=
            "radio" value="1"> 1</label> <label><input id=
            "RadioGroup2_1" name="RadioGroup2" type="radio" value=
            "2"> 2</label> <label><input id="RadioGroup2_2"
            name="RadioGroup2" type="radio" value="3">
            3</label></p>

            <div class="clear"></div>
        </div>

        <div class="clear"></div><input class="submit" id="submit_third"
        name="submit_third" type="submit" value="Next">
    </div>

    <div class="clear"></div>

    <div id="fourth_step">
        <div class="form">
            <h2>All done ...</h2>

            <p style="margin-top:30px;">Press 'Submit' and we'll send you
            everything you need to get you up and running.</p>
        </div>

        <div class="clear"></div><input class="send submit" id=
        "submit_fourth" name="submit_fourth" type="submit" value="Submit">
    </div>
</form>
</div>
</div> 
```

提交按钮只是没有做任何事情。我在我的contact.php 文件中尝试了许多不同的php 表单处理程序代码，但我仍然一无所获。

非常感谢任何帮助。经过6个小时的尝试，我现在变得非常绝望。

谢谢你。

demo自带的JS文件是：

```
$(function(){
//original field values
var field_values = {
        //id        :  value
        'username'  : 'username',
        'password'  : 'password',
        'cpassword' : 'password',
        'firstname'  : 'first name',
        'lastname'  : 'last name',
        'email'  : 'email address'
};

//inputfocus
$('input#username').inputfocus({ value: field_values['username'] });
$('input#password').inputfocus({ value: field_values['password'] });
$('input#cpassword').inputfocus({ value: field_values['cpassword'] }); 
$('input#lastname').inputfocus({ value: field_values['lastname'] });
$('input#firstname').inputfocus({ value: field_values['firstname'] });
$('input#email').inputfocus({ value: field_values['email'] }); 

//reset progress bar
$('#progress').css('width','0');
$('#progress_text').html('0% Complete');

//first_step
$('form').submit(function(){ return false; });
$('#submit_first').click(function(){
    //remove classes
    $('#first_step input').removeClass('error').removeClass('valid');

    //ckeck if inputs aren't empty
    var fields = $('#first_step input[type=text], #first_step input[type=password]');
    var error = 0;
    fields.each(function(){
        var value = $(this).val();
        if( value.length<4 || value==field_values[$(this).attr('id')] ) {
            $(this).addClass('error');
            $(this).effect("shake", { times:3 }, 50);

            error++;
        } else {
            $(this).addClass('valid');
        }
    });        

    if(!error) {
        if( $('#password').val() != $('#cpassword').val() ) {
                $('#first_step input[type=password]').each(function(){
                    $(this).removeClass('valid').addClass('error');
                    $(this).effect("shake", { times:3 }, 50);
                });

                return false;
        } else {   
            //update progress bar
            $('#progress_text').html('33% Complete');
            $('#progress').css('width','113px');

            //slide steps
            $('#first_step').slideUp();
            $('#second_step').slideDown();     
        }               
    } else return false;
});

$('#submit_second').click(function(){
    //remove classes
    $('#second_step input').removeClass('error').removeClass('valid');

    var emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;  
    var fields = $('#second_step input[type=text]');
    var error = 0;
    fields.each(function(){
        var value = $(this).val();
        if( value.length<1 || value==field_values[$(this).attr('id')] || (   $(this).attr('id')=='email' && !emailPattern.test(value) ) ) {
            $(this).addClass('error');
            $(this).effect("shake", { times:3 }, 50);

            error++;
        } else {
            $(this).addClass('valid');
        }
    });

    if(!error) {
            //update progress bar
            $('#progress_text').html('66% Complete');
            $('#progress').css('width','226px');

            //slide steps
            $('#second_step').slideUp();
            $('#third_step').slideDown();     
    } else return false;

});

$('#submit_third').click(function(){
    //update progress bar
    $('#progress_text').html('100% Complete');
    $('#progress').css('width','339px');

    //prepare the fourth step
    var fields = new Array(
        $('#username').val(),
        $('#password').val(),
        $('#email').val(),
        $('#firstname').val() + ' ' + $('#lastname').val(),
        $('#age').val(),
        $('#gender').val(),
        $('#country').val()                       
    );
    var tr = $('#fourth_step tr');
    tr.each(function(){
        //alert( fields[$(this).index()] )
        $(this).children('td:nth-child(2)').html(fields[$(this).index()]);
    });

    //slide steps
    $('#third_step').slideUp();
    $('#fourth_step').slideDown();            
});

$('#submit_fourth').click(function(){
    //send information to server
    alert('Sent. Thank you!');
});

}); 
```

我的contact.php文件中使用的php是：

```
<?php 
$errors = '';
$myemail = 'yourname@website.com';//<-----Put Your email address here.
if(empty($_POST['name'])  || 
empty($_POST['email']) || 
empty($_POST['message']))
{
$errors .= "\n Error: all fields are required";
}

$name = $_POST['name']; 
$email_address = $_POST['email']; 
$message = $_POST['message']; 

if (!preg_match(
"/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,3})$/i", 
$email_address))
{
$errors .= "\n Error: Invalid email address";
}

if( empty($errors))
{
$to = $myemail; 
$email_subject = "Contact form submission: $name";
$email_body = "You have received a new message. ".
" Here are the details:\n Name: $name \n Email: $email_address \n Message \n $message"; 

$headers = "From: $myemail\n"; 
$headers .= "Reply-To: $email_address";

mail($to,$email_subject,$email_body,$headers);
//redirect to the 'thank you' page
header('Location: contact-form-thank-you.html');
} 
?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
```

" [http://www.w3.org/TR/html4/loose.dtd](http://www.w3.org/TR/html4/loose.dtd) ">

```
<html>
<head>
<title>Contact form handler</title>
</head>

<body>
<!-- This page is displayed only if there is some error -->
<?php
    echo nl2br($errors);
    ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:17:57.323

`$('form').submit(function(){ return false; });`告诉提交应该返回 false

# hibernate - 休眠准备语句不起作用

> ID：15844093
> 
> 赞同：0
> 
> 时间：2013-04-05T21:42:26.340
> 
> 标签：hibernate

我曾经在我的`hibernate.cfg.xml`文件中有这个 url 连接，一切正常。

```
<property name="connection.url">jdbc:oracle:thin:address.to.real.db</property> 
```

现在，我像这样更改 URL 以在本地学习代码。

```
<property name="connection.url">jdbc:hsqldb:mem:mock_db</property> 
```

更改后，下面的语句将不再起作用。它抛出一个异常说`Invalid schema name: TEST in statement`

```
jdbcConnection.prepareStatement(parameterizedStrQuery); 
```

在我的休眠映射 xml 文件中，我有这行代码

```
<hibernate-mapping schema="TEST"> 
```

parameterizedStrQuery 看起来像这样

```
select obj.obj_id, from test.obj where obj.foo=0 and obj.var = 1 and (obj.obj_id in (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)) 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:05:27.107

根据[http://hsqldb.org/doc/guide/databaseobjects-chapt.html#dbc_schemas_schema_objects](http://hsqldb.org/doc/guide/databaseobjects-chapt.html#dbc_schemas_schema_objects)

> 在 HyperSQL 中，每个数据库只有一个目录。目录的名称是 PUBLIC。您可以使用 ALTER CATALOG RENAME TO 语句重命名目录。所有模式都属于此目录。目录名称与数据库的文件名无关。

所以我会尝试打开你`mock_db`的目录并将目录从 重命名`PUBLIC`为`TEST`。

# cuda - Mathematica 中 NVIDIA K20 GPU 上的内核数

> ID：15844094
> 
> 赞同：4
> 
> 时间：2013-04-05T21:42:32.310
> 
> 标签：cuda, wolfram-mathematica, opencl, nvidia

我在 Mathematica 中使用 NVIDIA K20 GPU。K20 的白皮书规定了以下规格：

1.  2496 个单精度内核（每个多处理器 192 个 x 13 个多处理器）
2.  832 个双精度内核（每个多处理器 64 个 x 13 个多处理器）
3.  416 个特殊功能单元（每个多处理器 32 个 x 13 个多处理器）

但是，当我启动 Mathematica 并在加载 OpenCL 或 CUDA 后查看 GPU 的规格时，它说我只有 416 个内核（我附上了 Mathematica 命令的屏幕截图和报告的规格）。这是否与双精度内核或特殊功能单元的数量有关？Mathematica 在我告诉它我将编写什么样的代码（例如双精度、超越函数）之前报告了这些规范。![在此处输入图像描述](https://i.stack.imgur.com/oiDzX.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:11:29.930

您的 Mathematica 很可能还不了解 Kepler 架构，因此将多处理器计数错误地转换为内核计数。

由于无论如何“核心”主要是一种营销发明，你可以放心地忽略这个数字。Mathematica 仍将使用整个 GPU（尽管 Kepler 感知版本可能仍会通过其他优化带来一些加速）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-06T15:03:55.880

这是一个 OpenCL 工件，而不是 Mathematica 的问题。Mathematica 通过供应商驱动程序 API（如 CUDA 或 OpenCL）与 GPU 设备通信。在这种情况下，信息是通过调用 OpenCL 的

OpenClGetDeviceInfo (.. )

请求 CL_DEVICE_MAX_COMPUTE_UNITS

OpenCL 驱动程序说它有 13 个 SMU，每个可以运行 32 个线程。因此有 416 个计算单元。OpenCL 规范对计算单元是什么含糊不清。所以 OpenCl 给出了 SMU * Warp 大小的总和。OpenCL 在 AMD 上也做了类似的事情，报告 7950 有 28 个计算单元，它有 1792 个流单元。AMD 79xx 每个 SMU 运行 64 个线程。

# iphone - 如何修复此错误：“ARC 禁止在 Xcode 中发送明确的‘release’消息”

> ID：15844097
> 
> 赞同：37
> 
> 时间：2013-04-05T21:42:43.047
> 
> 标签：iphone, objective-c, animation, automatic-ref-counting

我正在尝试从图像数组在 iPhone 中制作一个简单的动画图像：

```
- (void)viewDidLoad {
    NSArray *imageArray;
    imageArray = [[NSArray alloc] initWithObjects:
                  [UIImage imageNamed:@"sun1"],
                  [UIImage imageNamed:@"sun2"],
                  nil];
    fadeImage.animationImages = imageArray;
    fadeImage.animationDuration = 1;
    [imageArray release];  //==== HERE IS WHERE I GET THE ERROR ====== 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-04-05T21:43:53.983

**解决方案#1：**

只需删除发布声明。ARC 将为您管理。

```
[imageArray release]; // remove this line 
```

ARC 是自动引用计数。与手动引用计数相反。
WWDC 有一些很棒的演讲视频。如果您想观看它们，我可以提供链接。

**在[过渡到 ARC 发行说明](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html)中，请参阅*ARC 强制执行新规则*：**

> 您不能显式调用 dealloc，或者实现或调用 retain、 **release**、retainCount 或 autorelease。
> 
> 禁止扩展到使用@selector(retain)、@selector(release) 等。

**解决方案#2：**

如果您不希望将代码转换为 ARC（例如，您不是在编写新应用程序，而是在维护旧应用程序/或者您导入了太多代码以至于不值得迁移到 ARC），您可以禁用 ARC。

*   **为选定文件**禁用 ARC 要禁用 ARC，您可以`-fno-objc-arc`对特定文件使用编译器标志。选择目标并转到`Build Phases`-> `Compile Sources`。编辑`Compiler Flags`并添加`-fno-objc-arc`

*   **Disabling ARC for the project**
    *Source: [How to disable Xcode4.2 Automatic Reference Counting](https://stackoverflow.com/questions/7837024/how-to-disable-xcode4-2-automatic-reference-counting)*

    *   在左侧的管理器中单击您的项目。
    *   选择你的目标，在下一列中结束。
    *   选择顶部的构建设置选项卡。
    *   向下滚动到“Objective-C 自动引用计数”（它可能被列为
    *   “CLANG_ENABLE_OBJC_ARC”在用户定义的设置组下），并将其设置为 NO。

# matlab - 我们可以在 Matlab 中有一个混合类型的矩阵......以及如何？

> ID：15844099
> 
> 赞同：3
> 
> 时间：2013-04-05T21:42:52.543
> 
> 标签：matlab, types, matrix

我正在尝试编写一个以矩阵（特别是矩阵）作为输出的函数，其行显示一个双类型变量和一个二进制“状态”。没有真正的原因，只是出于好奇，我想知道是否有办法让行具有不同的类型。

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:19:55.237

MATLAB 为存储混合数据类型提供了两种可行的选项：

### 元胞数组

您可以将[元胞数组](http://www.mathworks.com/help/matlab/cell-arrays.html)视为一个特殊的矩阵，其中每个元素（称为*cell*）可以是不同的类型（和大小）。例如：

```
C = {2, 'Hello'} 
```

是一个存储双精度和字符串的元胞数组。

### 结构

[结构](http://www.mathworks.com/help/matlab/structures.html)还可以存储不同数据类型和大小的值，每个值都在不同的*字段中*。例如，上面的元胞数组中的信息可以用以下方式表示为一个结构：

```
S.count = 2
S.name = 'Hello' 
```

建议：
似乎结构看起来更适合您的需求；我想你会有一个叫做`status`存储布尔值的字段和一个叫做`number`存储双精度值的字段。对于多个值，您可以将布尔向量存储在中`status`，将双精度向量存储在 中`number`。或者，您可以拥有一个结构数组，每个结构包含一个布尔值和一个双精度值。

# javascript - JS通过原型实现的几个函数

> ID：15844100
> 
> 赞同：1
> 
> 时间：2013-04-05T21:42:54.907
> 
> 标签：javascript, function, prototype

我是 JS 新手。如果我想将例如 2 个函数分配给一个构造函数，我是否必须通过原型调用函数声明两次？

```
function Shape(x, y) {
    this.x= x;
    this.y= y;
}

Shape.prototype.foo= function() {

    return ...;
};

Shape.prototype.bar= function() {

    return ...;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:50:03.517

如果我理解正确，这样的事情会起作用：

```
function Shape(x, y) {
    this.x= x;
    this.y= y;
}

Shape.prototype = {
    constructor: Shape,
    foo: function() {
        return ...;
    },
    bar: function() {
        return ...;
    }
} 
```

[http://jsfiddle.net/Yc4V4/](http://jsfiddle.net/Yc4V4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:50:48.190

你可以这样做，或者你可以为原型分配一个新对象（覆盖任何现有的属性/方法）：

```
Shape.prototype = {
    foo : function(){
    },
    bar : function(){
    }
}; 
```

如果您要向不同的原型添加大量方法并且不想覆盖整个原型对象，请定义一个辅助方法来为您执行分配：

```
function addToPrototype(constructor, obj){
    for (var prop in obj){
        constructor.prototype[prop] = obj[prop];
    }
}

addToPrototype(Shape, {
    foo : function(){
    },
    bar : function(){
    }
});

addToPrototype(Shape, {
    something : function(){
    }
});

addToPrototype(Polygon, {
    somethingElse : function(){
    }
}); 
```

# math - 投影 - 将 3d 转换为 2d

> ID：15844101
> 
> 赞同：9
> 
> 时间：2013-04-05T21:42:56.060
> 
> 标签：math, graph, matrix, projection

我有问题或很好，我不知道如何将具有 x、y、z 值的 3d 点转换为 2d 点，我必须绘制投影，我确实有点的 x、y、z 值但我不知道如何将它们转换为 2d 以便我可以将它们移动到我的轴上。

![在此处输入图像描述](https://i.stack.imgur.com/Fs54X.jpg)

我一直在寻找 wiki 和 google，但是我不太确定应该使用哪些矩阵转换来获得想要的结果。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-05T23:44:16.173

让我们首先假设查看您的场景的相机以原点为中心，并查看`-z`方向。然后：

*   透视投影由下式给出：
    `x' = x/z`
    `y' = y/z`

*   正交投影由下式给出：（
    `x' = x`
    `y' = y`
    即，仅丢弃 z 分量）

现在您已经应用了上述步骤，您可能会获得一个位于 的点`(x',y') = (-28.4, +134.5)`。您现在需要根据您的屏幕分辨率和相机“缩放因子”和纵横比来缩放和居中它们：例如，您可能想要乘以`Zoom`并添加`screen_center`到您的组件`x`和`y`组件（注意：大多数图形渲染系统都有`y`方向指向向下，因此您可能需要为`y`组件交换符号）。您可能仍然会得到具有负坐标或坐标大于画布大小的像素。只需丢弃它们：这意味着它们在您的视锥之外。

最后，您可能想知道如果您的相机**未**指向`-z`原点或未以原点为中心该怎么办。对于后者，这很简单：只需在执行任何其他操作之前将相机坐标减去所有 3D 点的分量即可。对于相机旋转，它实际上也很容易：您只需要在执行其他任何操作之前以相机旋转的相反方式旋转您的点。这只是意味着您需要将所有 3D 坐标乘以相机旋转矩阵的转置。这一步背后的想法是，移动相机与在相反方向移动点完全相同（并且旋转矩阵的逆是同一矩阵的转置）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T22:31:04.687

I would highly recommend using an existing graphics package to do this rather trying to write your own libraries. I don't know what language you are working in but OpenGL is an open source graphics engine that can be used for 3D rendering and has cross-language comparability so it might be the place to start.

If you insist on doing it by hand there is very good example code in the answer to [this](https://stackoverflow.com/questions/8633034/basic-render-3d-perspective-projection-onto-2d-screen-with-camera-without-openg?rq=1) question.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-06T16:17:57.333

如果您打算在 3 维中旋转形状，则只需要考虑相机角度。如果您对线性代数和三角函数有深入的了解，那么值得付出额外的努力，因为它使您的程序更加灵活，但如果您在数学上不太熟悉，我会推荐以下解决方案。

要将 3D 图像投影到 2D 平面中，您需要做的是创建和映射的方程。

```
(x,y,z) -> (x',y') 
```

您可以通过定义从 3D 点到 2D 点的三个映射来做到这一点。

```
(1,0,0) -> (  1,  0)
(0,1,0) -> (  0,  1)
(0,0,1) -> (-.7,-.7) 
```

我将 (-.7,-.7) 用于 z 访问，因为该点距原点大约 1 个单位，并且位于 x 和 y 访问之间。

有了这三个点之后，您就有足够的信息来计算任意点 x,y,z。

```
(x,y,z) -> (1*x - .7*z, 1*y - .7*z) 
```

在计算机图形中，网格的原点不在屏幕中心，而是在左上角。为了使用我们刚刚在程序中生成的方程，我们必须定义一个偏移量以将原点移动到屏幕的中心。我们称这个偏移点(Ox, Oy)。

随着偏移量，我们的等式变为以下。

```
(x,y,z) -> (Ox + 1*x - .7*z, Oy + 1*y - .7*z) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-04T22:17:01.607

这对我有用：（它在 vb 中）。f_nodes 是平面节点，a_nodes 是经过 alpha、beta 和 gamma 变换后的 3d 节点。(x,y,z) 是一个点。还有更复杂的。

```
 ca = Cos(alpha)
    sa = Sin(alpha)
    cb = Cos(beta)
    sb = Sin(beta)
    cg = Cos(gamma)
    sg = Sin(gamma)
    q(1) = cg * (cb * X - sb * (sa * Y + ca * z)) - sg * (ca * Y - sa * z)
    q(2) = sg * (cb * X - sb * (sa * Y + ca * z)) + cg * (ca * Y - sa * z)
    q(3) = sb * X + cb * (sa * Y + ca * z)

    f_nodes(i, 1) = q(1)
    f_nodes(i, 2) = q(2)

    a_nodes(i, 1) = q(1)
    a_nodes(i, 2) = q(2)
    a_nodes(i, 3) = q(3) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-05T17:24:00.097

我找到了一种将 3D 投影到**Isometric** 2D 的方法。

我假设等轴测视图的**角度**，当然还有一个要投影的 ​​3D 点

```
Dim IsometricViewAngle As Integer = 30
Dim RowPoint As New Point3D(dx,dy,dz) 
```

其中*dx*、*dy*和*dz*是您的自定义值。然后我必须计算 X 和 Y 增量和减量的**增量**值，例如

```
Dim XDelta = Math.Cos(IsometricViewAngle * Math.PI / 180)
Dim YDelta = Math.Sin(IsometricViewAngle * Math.PI / 180)
Dim ZDelta = 0.5 
```

好的，就是这样，现在我要将 3D 点投影到 2D 点：

```
Dim X As Double = (RowPoint.X * XDelta) + (RowPoint.Y * YDelta)
Dim Y As Double = (RowPoint.X * XDelta) + (RowPoint.Z * ZDelta)
Dim ProjectedPoint As New Point(X,Y) 
```

并且最终结果在 RadDiagram 中效果最好。问候/

# javascript - 尝试访问 HTML5 电子邮件验证客户端

> ID：15844103
> 
> 赞同：0
> 
> 时间：2013-04-05T21:42:57.577
> 
> 标签：javascript, html

我只是想做一个简单的电子邮件验证，我有一个电子邮件输入

```
<input type='email' id="user_email"> 
```

我正在尝试使用 Javascript 调用它

```
document.getElementById('user_email').addEventListener('invalid', function() {
    console.log('Invalid Email');
}) 
```

但它似乎没有工作，我试过谷歌搜索但什么也没找到。谢谢！

我只是想在电子邮件上使用 HTML5 验证将 P 元素文本更改为“无效的电子邮件格式”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:44:01.247

在输入中添加 id ？

```
<input type='email' id='user_email' /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:00:25.407

通过更改整个修复它

```
document.getElementById('user_email').addEventListener('invalid', function() {
    console.log('Invalid Email');
}) 
```

至

```
document.getElementById('user_email').checkValidity(); 
```

# ruby - 关闭自身的子浏览器窗口显然会破坏 Watir-webdriver 到父窗口的链接？

> ID：15844105
> 
> 赞同：5
> 
> 时间：2013-04-05T21:43:12.480
> 
> 标签：ruby, webdriver, watir-webdriver, selenium-chromedriver

在 Chrome 中，使用 watir-webdriver，我单击一个打开子浏览器窗口的按钮。

我愿意：

```
@browser.window(title: 'Child').use 
```

我成功地与该子窗口中的各种项目进行了交互。

很快，在此窗口中执行了一项操作，该站点认为这是首先打开窗口的“点”。例如，

```
@browser.button(title: 'Button').click 
```

执行此操作时，子窗口会自行关闭。

但是，当我告诉 watir-webdriver 返回使用父窗口时，出现错误：

```
@browser.window(title: 'Parent').use # => results in
# Selenium::WebDriver::Error::NoSuchWindowError: emptyScript execution failed; 
# The window could not be found 
```

我认为这是 Selenium/Watir-webdriver 错误的原因是因为以下代码有效：

```
@browser.window(title: 'Child').use
# ... Now I do various things in the child window that do NOT
# ... cause it to close itself. They all work as expected.
# ...
puts @browser.window(title: 'Parent').present? #=>true
@browser.window(title: 'Child').close
puts @browser.window(title: 'Parent').present? #=>true
@browser.window(title: 'Parent').use # => No error thrown 
```

唯一的区别是导致子窗口自行关闭的操作。

我注意到 watirspec 代码没有自动关闭窗口的测试用例，所以这可能是 watir-webdriver 中窗口代码的一个被忽视的方面。

好的，这是*您*可以运行的代码，您可以自己查看此问题：

```
require 'watir-webdriver'
@b = Watir::Browser.new :chrome
@b.goto 'ckeditor.com/demo#full'
@b.div(id: 'cke_editor1').link(title: 'Link').click
@b.link(title: 'Browse Server').wait_until_present
@b.link(title: 'Browse Server').click
@b.window(title: 'CKFinder').use { 
  @b.frame(title: 'CKFinder').link(id: 'r0').right_click
  @b.frame(title: 'CKFinder').frame(id: 'cke_22_frame').wait_until_present 
  @b.frame(title: 'CKFinder').frame(id: 'cke_22_frame').link(id: 'cke_200').click
} 
```

这将导致此错误：

```
Selenium::WebDriver::Error::NoSuchWindowError: emptyScript execution failed;
The window could not be found 
```

别说我从来没有为你做过什么！:-)

现在，在你问“你为什么要测试第 3 方编辑工具，你这个疯子？”之前，我会为你回答：我不是。

我正在测试的是，CKEditor 工具生成的源代码在特定情况下得到正确更新（这远远超出了这里问题的范围）。要设置它，我首先需要知道该源代码*是*什么，以便稍后我可以验证它是否由不同的进程正确更新。为此，我必须首先使用 CKEditor 的链接工具正确设置它。卡皮奇？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T23:19:42.363

如果您需要返回打开的第一个窗口，您可以使用

```
@browser.windows[0] 
```

你也可以做这样的事情（未经测试）

```
@browser.windows.each do |window|
  if window.title.include?(target_string)
    window.use
  end
end 
```

# javascript - 检查是否在javascript中设置了变量

> ID：15844108
> 
> 赞同：0
> 
> 时间：2013-04-05T21:43:27.017
> 
> 标签：javascript

我想要一个 JS 函数来说明是否设置了变量。我在下面定义了isset()。

如评论中所述，它的行为很奇怪。有任何想法吗？

```
<html>
    <head></head>
    <body>
        <script type="text/javascript">

          function isset(variableName) {
            return typeof variableName != 'undefined';
          }

          a = 5;
          console.log(isset(a)); 
          console.log(isset(b)); // returns an error.
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T21:44:22.923

您需要`typeof`直接执行检查，而不是在函数内部。

原因与 PHP 中的原因完全相同（除非您使用传递引用，否则您的函数也会中断）：

`isset(b)`导致抛出异常，因为`b`它是一个未定义的变量并将其作为参数传递试图读取它，这是您无法做到的。所以`typef`检查永远不会执行。

# c# - 将 ITPC 元数据写入映像

> ID：15844110
> 
> 赞同：0
> 
> 时间：2013-04-05T21:43:49.003
> 
> 标签：c#, image, metadata, iptc

我必须修改 6000+ jpg 图像的 iptc 元数据。不幸的是，我没有找到任何图书馆，甚至没有找到这样做的例子。

您能否给我一个提示如何修改图像的元数据或指向我可以通知自己的网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:02:46.797

快速浏览一下[System.Windows.Media.Imaging](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.aspx)命名空间就会发现[`InPlaceBitmapMetadaWriter`](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.inplacebitmapmetadatawriter.aspx)该类。我想这就是你要找的：

```
Stream pngStream = new System.IO.FileStream("smiley.png", FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite);
PngBitmapDecoder pngDecoder = new PngBitmapDecoder(pngStream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default);
BitmapFrame pngFrame = pngDecoder.Frames[0];
InPlaceBitmapMetadataWriter pngInplace = pngFrame.CreateInPlaceBitmapMetadataWriter();
if (pngInplace.TrySave() == true)
{
    pngInplace.SetQuery("/Text/Description", "Have a nice day."); 
}

pngStream.Close(); 
```

# unicode - Python 2.7 中保证的 unicode 或 ascii 退避

> ID：15844122
> 
> 赞同：1
> 
> 时间：2013-04-05T21:44:42.250
> 
> 标签：unicode, python-2.7, character-encoding, web-scraping

我是 BeautifulSoup4 中 UnicodeDammit 模块的忠实拥护者，它把一个字符串牢牢地放在 unicode 中，并且还做了 HTML 反转义：

```
from bs4 import UnicodeDammit
unicode_page = UnicodeDammit(raw_page, [suspected_encodings_if_any]).unicode_markup 
```

但是，在某些情况下，即使是强大的 Dammit 也会失败，并返回一个空字符串。对于这些情况，我希望对 ascii 进行某种退避。

Dammit 使用 chardet，所以没有必要放弃这一点。（该死的还寻找 iconv_codec 库——任何人都对此有任何经验吗？） 退回到 ascii 的最佳方式是什么？这种尝试会丢失一些东西，但它似乎也有效：

```
def to_unicode_with_ascii_backoff(text):
    if isinstance(text, unicode):
        return text
    else:
        ud = UnicodeDammit(text).unicode_markup
        if ud: 
            return ud
        else:
            return ''.join(i for i in text if ord(i) < 128) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T20:29:19.893

“最佳”取决于您的应用程序。您可以逐步改进您的功能：

```
def to_unicode_with_ascii_backoff(text):
    u = UnicodeDammit(text).unicode_markup
    return u if u or not text else text.decode('ascii', 'replace') 
```

如果输入不是字节字符串或 Unicode 字符串，它总是返回 Unicode 字符串或引发错误。

# css - 错位取决于文本

> ID：15844123
> 
> 赞同：2
> 
> 时间：2013-04-05T21:44:42.273
> 
> 标签：css

我正在尝试让水平 li 元素创建这些卡片效果。

但是，它们内部的文本量似乎使它们的对齐方式偏离了（有些高于其他）。例如，第 3 个框的文本比其他 2 个要多，因此它的位置高于其他框。

```
li {
  position: relative;
  display: inline-block;
  width: 282px;
  height: 368px;
  background: url("../img/comedians/comedian-card.png");
  padding: 20px;
  margin: 10px;
} 
```

无论里面的文字如何，我怎样才能让它们对齐？

[http://f.cl.ly/items/2e2I2Z0x0g3M2D1o2F0t/stackoverflow.png](http://f.cl.ly/items/2e2I2Z0x0g3M2D1o2F0t/stackoverflow.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:48:11.383

尝试使用`vertical-align`，例如：`vertical-align: middle`。我会试着在一秒钟内拿出一个演示。

这是演示：http: [//jsfiddle.net/wMb8t/1/](http://jsfiddle.net/wMb8t/1/)

## CSS

```
li{
    display: inline-block;
    width: 120px;
    border: 1px solid black;
    margin: 5px;
    vertical-align: top;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:49:03.030

因为你的块是`inline-block`，你应该添加`vertical-align:top;`

# macos - 从 mac 终端提示符中删除文件路径

> ID：15844128
> 
> 赞同：0
> 
> 时间：2013-04-05T21:45:21.217
> 
> 标签：macos, bash, terminal, .bash-profile

我正在尝试摆脱 mac 终端命令提示符中显示的文件路径。

例子：`superuser@x-160-94-176-201:[~/dir1/dir2/dir3/dir4/]$`

如果您有更长的目录名称，您最终会丢失整行。我知道在 cshrc 中我可以做到这一点，事实上我已经在我的 ubuntu 框中编辑了 .cshrc 以进行此更改。

```
 if ( $?tcsh ) then
    #set prompt="%n@%m (%/) % "
    set prompt="[%n@%m %c]% "
    #set prompt="%n@%B%m%b (%B%~%b) % "
    set prompt2 = "%R loop: "
    set prompt3 = "oops\041 %R (y|n|e)? " 
```

我在我的 Mac 上运行 bash，但我尝试在我的 Mac 中设置提示符，`bash_profile`但它没有任何影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:55:32.447

在 bash （和其他`*sh`风格的 shell）上，您可以通过设置环境变量来设置提示`PS1`。

例如，将其设置为

```
% PS1=`hostname`':\W> ' 
```

给你一个提示：

```
host:pwd> 
```

where`host`是您的主机名（由 command 返回`hostname`），并且`pwd`是路径的最后一个组成部分。

查看`man bash`并搜索`PROMPTING`所有细节，包括如何做粗体，包括时间等等。

`zsh`（这是一个很好的 shell）对花哨的提示有更广泛的支持。

# php - 通过使用 preg_match 的 php 正则表达式

> ID：15844129
> 
> 赞同：0
> 
> 时间：2013-04-05T21:45:27.670
> 
> 标签：php, regex, preg-match

我有一个`$play`由字符和数字组成的变量。例如：

`$play = "blah05"`

我怎么用`preg_match()`只能得到05？我的`$regexp`正确吗？

```
$regexp = "/^[^0-9]/";
if (preg_match($regexp, $play, $matches)) {
   echo "matches[0]";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T21:50:39.137

如果你想从最后得到数字，正则表达式应该是这样的：

`$regexp = '/(\d+)$/';`

如果您想从字符串中的任何位置获取数字：

`$regexp = '/(\d+)/';`

只需`var_dump($matches);`查看结果并选择最适合您的选项即可。

```
if (preg_match($regexp, $play, $matches)) {
   var_dump($matches);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:48:17.760

尝试：

```
$regexp = "/([0-9]+)$/";
if (preg_match($regexp, $play, $matches)) {
    echo $matches[1];
} 
```

这将捕获在字符串末尾具有数字的那些，如果您想捕获在字符串中任何位置具有数字的那些，请删除 $。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T21:47:54.620

```
$regexp = "/[0-9]+/";
if (preg_match($regexp, $play, $matches)) {
   echo $matches[0];
} 
```

[0-9] 是数字。并且使用 + 你匹配至少一个数字（尽可能多）。

# python - 比较 Python 中的异常对象

> ID：15844131
> 
> 赞同：15
> 
> 时间：2013-04-05T21:45:34.510
> 
> 标签：python, exception, comparison

我是 Python 的新手，我被这个问题困住了。我正在尝试比较两个“异常对象”，例如：

```
try:
    0/0
except Exception as e:
    print e
>> integer division or modulo by zero

try:
    0/0
except Exception as e2:
    print e2
>> integer division or modulo by zero

e == e2
>> False

e is e2
>> False 
```

我应该如何进行这种比较以获得“真”？

我正在尝试做的事情：

```
class foo():
    def bar(self, oldError = None):
        try:
            return urllib2.urlopen(someString).read()                   
        except urllib2.HTTPError as e:
            if e.code == 400: 
               if e != oldError: print 'Error one'
            else: 
               if e != oldError: print "Error two"
            raise
         except urllib2.URLError as e:
             if e != oldError: print 'Error three'
             raise

class someclass():        
    # at some point this is called as a thread
    def ThreadLoop(self, stopThreadEvent):
        oldError = None
        while not stopThreadEvent.isSet():
            try:
                a = foo().bar(oldError = oldError)
            except Exception as e:
                oldError = e
            stopThreadEvent.wait(3.0) 
```

（可能是一些语法错误）

我为什么要这样做？因为我不想两次打印相同的错误

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-05T21:53:43.343

对于大多数异常类，您可以使用

```
type(e) is type(e2) and e.args == e2.args 
```

这测试它们的类是否完全相同，并且它们包含相同的异常参数。这可能不适用于不使用的异常类`args`，但据我所知，所有标准异常都可以。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-05T21:48:26.373

您要[检查](http://docs.python.org/3.3/library/functions.html#isinstance) [异常的类型](http://docs.python.org/3.3/library/functions.html#type)：

```
>>> isinstance(e2, type(e))
True 
```

请注意，当然，这将允许子类 - 这是一件很奇怪的事情，所以我不确定你在寻找什么行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-08-13T13:04:30.997

在这种情况下，使用 str() 比较异常消息会很有用。

```
...
        except urllib2.HTTPError as e:
            if e.code == 400: 
                if isinstance(oldError, type(e)) and str(e) != str(oldError): 
                    print 'Error one'
            else: 
                if isinstance(oldError, type(e)) and str(e) != str(oldError): 
                    print "Error two"
            raise
         except urllib2.URLError as e:
             if isinstance(oldError, type(e)) and str(e) != str(oldError): 
                 print 'Error three'
             raise
... 
```

# debugging - IntelliJ 中对象引用旁边的井号是什么意思？

> ID：15844136
> 
> 赞同：1
> 
> 时间：2013-04-05T21:46:05.203
> 
> 标签：debugging, intellij-idea, object-reference

英镑符号计数（在屏幕截图中突出显示）是什么意思？

![IntelliJ 中的对象引用](https://i.stack.imgur.com/NZbSH.png)

我使用 IntelliJ 12 社区版。该项目使用 Android SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T10:57:39.950

IntelliJ IDEA 显示相关对象的 toString() 方法返回的文本。井号表示该方法的作者想要表示的任何含义。

# xml-parsing - Sybase ASE xmltable - 模式不起作用

> ID：15844139
> 
> 赞同：0
> 
> 时间：2013-04-05T21:46:15.773
> 
> 标签：xml-parsing, sap-ase

我正在使用 Sybase ASE 15.0.2 尝试以下操作，但发现很难通过：

动机是提取 <tables> 标签的内容。有人可以帮我解决这个问题吗？

参考 - [http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc30020.1502/html/xmlb/CFHIDCJC.htm](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc30020.1502/html/xmlb/CFHIDCJC.htm)

```
declare @purgeTableInfo varchar(16300)
select @purgeTableInfo = 
    '<purge>
        <start-time>00:00:000</start-time>
        <end-time>03:00:000</end-time>
        <tables>
            <table>
                <table_name>table1</table_name>
                <owner>dbo</owner>
                <columns>
                    <column>
                        <column_name>column1</column_name>
                        <column_value>121212xdfsdsdsdsd</column_value>
                        <column_condition>like</column_condition>
                    </column>
                    <column>
                        <column_name>column2</column_name>
                        <column_value>121212xdfsdsdsdsd</column_value>
                        <column_condition>like</column_condition>
                    </column>
                </columns>
            </table>
        </tables>
    </purge>'
        select * 
          from xmltable('/purge/tables/table/columns/column'
                    passing @purgeTableInfo
                    columns columnName varchar(255) path 'column_name',
                            tableName varchar(255) pattern '../../table_name') as purgeInputDetails 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T14:46:33.837

在我上面的问题中，我试图避免循环并尝试使用 xmltable() 以便它就像一个查询。但是，事实证明，对于更复杂的结构，如多表和多列 xml，xmltable() 有点僵化（在我的问题中，我提到了单表和多列 xml 的基本情况）。所以，我将采用“xmlextract()+looping”的方式。这是多表/多列xml的解决方案：

```
declare @i int
declare @extractedTable varchar(50)
declare @j int
declare @extractedColumn varchar(50)
select @i = 1
select @extractedTable = ''

while (@extractedTable != null)
begin
    select @extractedTable=convert(varchar(50),xmlextract ('/purge/tables/table['+convert(varchar(5),@i)+']/table_name/text()', @purgeTableInfo))
    print "%1!", @extractedTable

    if(@extractedTable != null)
    begin
        select @j = 1
        select @extractedColumn = ''
        while (@extractedColumn != null)
        begin
            select @extractedColumn=convert(varchar(50),xmlextract ('/purge/tables/table['+convert(varchar(5),@i)+']/columns/column['+convert(varchar(5),@j)+']/column_name/text()', @purgeTableInfo))
            print "%1!", @extractedColumn
            if(@extractedColumn != null)
            begin
                insert into tabCols select @extractedTable as tableName, @extractedColumn as columnName
                select @j = @j+1
            end
        end
        select @i = @i+1
    end
end
commit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-18T13:54:41.527

在没有 WHILE 或游标的情况下在 1 个查询中执行此操作

```
declare @XML text
select @XML = 
    '<purge>
        <start-time>00:00:000</start-time>
        <end-time>03:00:000</end-time>
        <tables>
            <table>
                <table_name>table1</table_name>
                <owner>dbo</owner>
                <columns>
                    <column>
                        <column_name>column1</column_name>
                        <column_value>121212xdfsdsdsdsd</column_value>
                        <column_condition>like</column_condition>
                    </column>
                    <column>
                        <column_name>column2</column_name>
                        <column_value>121212xdfsdsdsdsd</column_value>
                        <column_condition>like</column_condition>
                    </column>
                </columns>
            </table>
        </tables>
    </purge>'

select
  P.starttime
, P.endtime
, T.table_name
, T.owner
, C.column_name
, C.column_value
, C.column_condition
from
  --<purge>
  xmltable('/purge'
  passing @XML
  columns 
    ROW_NUM int for ordinality
  , starttime time path 'start-time'
  , endtime time path 'end-time'
  ) AS P
  --/purge/tables/table  
  LEFT JOIN xmltable('/tables/table'
  passing ISNULL(CAST(xmlextract('/purge['+convert(varchar(5), P.ROW_NUM)+']/tables', @XML) as VARCHAR(16000)), '<tables><table></table></tables>')
  columns
    ROW_NUM int for ordinality
  , table_name varchar(50) path 'table_name'
  , owner varchar(100) path 'owner'
  ) AS T ON 1 = 1
  --/purge/tables/table/columns/column 
  LEFT JOIN xmltable('/columns/column'
  passing ISNULL(CAST(xmlextract('/purge['+convert(varchar(5), P.ROW_NUM)+']/tables/table['+convert(varchar(5), T.ROW_NUM)+']/columns', @XML) as VARCHAR(16000)), '<columns><column></column></columns>')
  columns
    ROW_NUM int for ordinality
  , column_name varchar(50) path 'column_name'
  , column_value varchar(500) path 'column_value'
  , column_condition varchar(50) path 'column_condition'  
  ) AS C ON 1 = 1 
```

# c++ - 使用 std::initializer_list 创建树？

> ID：15844144
> 
> 赞同：5
> 
> 时间：2013-04-05T21:46:48.093
> 
> 标签：c++, c++11, initializer-list

我所拥有的是这样的：

```
struct ExprTreeNode {
   char c;
   std::vector< int > i;
};

ExprTreeNode tn { '+', { 1, 2, 3, 4 } }; 
```

我想写的是这样的：

```
MyTree t1 { '+', { 1, 2, { '*', { 3, 4, 5 } } } };
MyTree t2 { '*', { { '+', { 77, 88, 99, 111 } }, { '-', { 44, 33 } } } }; 
```

我可以自由定义 MyTree 类（和可能的辅助类）——但它应该是类似于树的东西——比如作为 TreeNode 内容的运算符和一个包含子节点的容器（例如 std::vector）。

在 C++ 中是否可以使用这样的 initializer_list 来初始化树状结构？（如果可能的话，提示如何做到这一点会很好。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:07:35.887

以下可能对您有用：

```
struct ExprTreeNode {
    bool is_value;
    int i;
    char c;
    std::vector< ExprTreeNode > v;

    ExprTreeNode( int i_ ) : is_value( true ), i( i_ ) {}
    ExprTreeNode( char c_, std::initializer_list< ExprTreeNode > v_ )
      : is_value( false ), c( c_ ), v( v_ ) {}
};

ExprTreeNode tn { '+', { 1, 2, { '*', { 3, 4 } } } }; 
```

（在实践中你可能想结合`i`and `c`）

这是一个[活生生的例子](http://liveworkspace.org/code/9cIBJ%2416)。

* * *

**更新：**正如我在另一个 Q/A 中指出的那样，我使用了类似的技术，以上是我`std::vector<ExprTreeNode>`作为成员使用的未定义行为，并且在这一点上，`ExprTreeNode`它不是一个完整的类型。以下应该解决它：

```
struct ExprTreeNode {
    int value_;
    char op_;
    std::shared_ptr< void > subnodes_;

    ExprTreeNode( int v ) : value_( v ) {}
    ExprTreeNode( char op, std::initializer_list< ExprTreeNode > subnodes );

    void print() const;
};

typedef std::vector< ExprTreeNode > Nodes;

ExprTreeNode::ExprTreeNode( char op, std::initializer_list< ExprTreeNode > l )
  : op_(op), subnodes_(std::make_shared<Nodes>(l))
{} 
```

这`shared_ptr`也将其用作叶子/非叶子的标志，如果你想使用它，你需要先转换它：

```
void ExprTreeNode::print() const
{
   if( !subnodes_ ) {
      std::cout << value_;
   }
   else {
      std::cout << op_ << " ( ";
      for( const auto& e : *std::static_pointer_cast<Nodes>(subnodes_) ) {
         e.print(); std::cout << " ";
      }
      std::cout << ")";
   }
} 
```

这是更新的[实时示例](http://liveworkspace.org/code/1WXPbx%241)。

# javascript - 可以在 Node.js 中将变量设置为只读吗

> ID：15844145
> 
> 赞同：3
> 
> 时间：2013-04-05T21:46:50.450
> 
> 标签：javascript, node.js

我想防止变量被更改。特别是对象的属性：

```
var foo = { bar: 'baz' };

// do something to foo to make it readonly

foo.bar = 'boing'; // should throw exception 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T21:56:42.173

你可以试试

```
Object.defineProperty(foo, "bar", { writable: false }); 
```

并且后面的分配要么静默失败，要么如果您处于严格模式，则会引发异常（根据 David Flanagan 的“JavaScript : The Definitive Guide”）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T21:54:16.803

使用一个函数：

```
var foo = function() {
  var bar = 'baz';

  return {
    getBar: function() {
      return bar;
    }
  }
}(); 
```

这样 foo.bar 是未定义的，您只能通过 foo.getBar(); 访问它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T21:54:39.640

看这个例子：

```
var Foo = function(){
     this.var1 = "A";   // public
     var var2 = "B";    // private
     this.getVar2 = function(){ return var2; }
}

var foo = new Foo();

console.log(foo.var1);   // will output A
console.log(foo.var2)    // undefined
console.log(foo.getVar2())    // will output B 
```

# php - 在服务器上使用没有扩展名的文件是否有任何问题？

> ID：15844146
> 
> 赞同：-1
> 
> 时间：2013-04-05T21:46:53.073
> 
> 标签：php, file-extension

我想在我的服务器上使用没有扩展名的文件。这样做的原因是我也可以将该文件名用作变量名。总的来说，它只是让我正在制作的应用程序中的事情变得更加容易。

该文件仅用作 PHP 站点中的包含文件，并且可以正常工作。所以问题是......没有扩展是否有任何明显的问题，或者这是不好的做法？如果我将此站点导入另一台服务器，会有任何兼容性问题吗？

编辑：关闭，因为它是题外话。这样做的原因显然是因为它被标记为“文件扩展名”，我指的是文件扩展名。当实际上我在谈论 PHP 时，它也被标记为 PHP。我的错。

由于缺乏研究而被否决...以下是有关没有扩展名的问题的 stackoverflow 链接列表：

1.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:49:24.390

由于您的文件没有扩展名，您应该不会遇到任何问题。就能够执行文件而言，权限基于文件系统，而不是文件扩展名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:52:42.687

就在这里。为了确定如何处理文件，Web 服务器通常会查看扩展名。如果在那里无法确定，它通常只会输出原始文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T21:53:11.997

我个人不会采用这种方法，如果这对于您的应用程序围绕此设置是必要的。应该有什么大问题。

正如 Moov Tony 所说，权限是基于文件系统的，而不是基于实际的扩展名。

另一方面，我会监视 http 请求，只是为了确保这些文件没有通过 http:// 地址导航。

我相信他们是一些可能能够提取此类文件的网站撕裂者。但是，不能使用所述网站抓取工具来抓取服务器端脚本。

所以总的来说，是的。围绕这样的解决方案不应该有任何问题。我个人会监控对您网站的 http 请求，以检测这些文件名是否过于手动导航。

* * *

另一方面，您将需要重新配置您的网络服务器以告诉它如何处理这些文件名。通常，如果没有任何指示，一些网络服务器默认输出文件内容。

# c++ - 显示二维数组图像的最佳 C++ 库

> ID：15844153
> 
> 赞同：1
> 
> 时间：2013-04-05T21:47:34.177
> 
> 标签：c++, image-processing, multidimensional-array

我有一个二维数组，其中包含从二进制文件传输的图像。我想显示此图像，并且想知道执行此操作的最佳工具（C++ 库）是什么。

简单来说，什么 C++ 库可以获取二维数组并显示图像？

编辑*我认为最好更具体。

我正在尝试获取 8 位数值的二维数组并将它们索引到某种结构中以显示我的图像。

Matlab 有一个名为 imshow(X, Map) 的函数，其中 Map 是一个 n×3 的 RGB 值数组。X 是二维数组。C++ 库是否提供了类似的功能。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:02:52.207

如果您正在使用`WinAPI`，您可以随意在程序窗口中绘画，这是我认为最简单的方法。见[这个](http://www.dreamincode.net/forums/topic/261009-bitmap-printing-tutorial-in-c-win32/)或[这个](http://www.codeproject.com/Articles/1988/Guide-to-WIN32-Paint-for-beginners)。

否则我建议你学习使用[OpenGL](https://www.google.cz/search?q=%20C%2b%2b%20start%20with%20opengl&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a)，我认为它在今天被认为是主流并且有更多的功能等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T00:07:27.207

是否需要在 C++ 中完成所有这些工作，还是可以扩展您的工具链？听起来你可以将 C++ 与例如[gnuplot](http://www.gnuplot.info/)结合起来，效果很好，而且工作量很小。

在这种情况下，您要做的是获取二维数字数组并将它们（它们的字符串表示形式，而不是它们的位表示形式）打印到`stdout`，每行一个像素行，像素由空格（或制表符）分隔。运行程序并将输出重定向到文件：

```
$ ./yourprogram > img.dat 
```

然后，创建一个 gnuplot 脚本，根据需要绘制图像。Gnuplot 有[大量文档](http://www.gnuplot.info/documentation.html)可以帮助您入门 - 如果您下载当前版本 (4.6) 的 pdf 并查看“图像”标题下（第 53 页），这似乎正是您想要的。

我对这种方法的主要论据，例如 OpenGL 是，这*真的很容易*。写入`stdout`是任何 C++ 程序员学习的第一件事，而 gnuplot 旨在使绘制数据变得容易。诚然，gnuplot 确实有一个陡峭的学习曲线，但远没有使用 OpenGL 产生相同质量的东西那么陡峭。

# c++ - 如何使用一个字符串打印此 unicode 行？

> ID：15844154
> 
> 赞同：1
> 
> 时间：2013-04-05T21:47:46.970
> 
> 标签：c++

我遇到了特定 Unicode 字符的问题。

假设我想打印出 Október：ó=U+00F3

```
setlocale(LC_ALL, "");
cout << "\xF3"; //this prints ó
cout << "Okt\xF3"; //this prints Októ
cout << "Okt\xF3ber"; //this prints Oktľr 
```

我知道打印 Október 的唯一方法是：

```
cout << Okt\xF3 << ber; 
```

如何创建打印 Október 的刺痛？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:50:00.427

采用

```
cout << "Okt\xF3\x62\x65r"; 
```

十六进制转义序列尽可能地扩展，因此作为有效的十六进制数字的`'b'`and`'e'`包含在转义序列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:52:40.623

您可以使用编译时字符串连接来防止转义序列超出您的预期：

```
cout << "Okt\xF3" "ber"; 
```

# css - twitter bootstrap 自定义轮播指标

> ID：15844157
> 
> 赞同：4
> 
> 时间：2013-04-05T21:47:58.617
> 
> 标签：css, twitter-bootstrap, responsive-design, carousel, scaling

我想用这样的东西改变轮播指示器：

![自定义轮播指标](https://i.stack.imgur.com/AesAt.png)

我的轮播指标有这个标记：

```
<ol class="carousel-indicators">

    <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
        <h4>IMAGE1</h4><br/><h5>subtitle</h5><br/><span>+</span>
    </li>

    <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
        <h4>IMAGE2</h4><br/><h5>subtitle</h5><br/><span>+</span>
    </li>
    <li data-target="#ShowCarousel-03" data-slide-to="2">
        <h4>IMAGE3</h4><br/><h5>subtitle</h5><br/><span>+</span>
    </li>
    <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
        <h4>IMAGE4</h4><br/><h5>subtitle</h5><br/><span>+</span>
    </li>

                    </ol> 
```

CSS：

```
 .carousel-indicators {
     position: absolute;
     top: 0px;
     left: 0px;
     z-index: 5;
     margin: 0;
    list-style: none;
     }
      .carousel-indicators li{
    background: url(images/triangle.png) no-repeat;
    width:320px;
    height:176px;
    cursor: pointer;
    text-align:center;
} 
```

当我调整浏览器的大小时，轮播会适应屏幕的宽度，但指示器正在折叠。

有人可以帮助我提供有关如何在较低分辨率（如轮播图像）上制作此比例的提示吗？

谢谢！

乐：

我试过把 li 元素放在这样的地方：

```
 <div class="row-fluid">
 <div class="span3>
 <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
    <h4>IMAGE1</h4><br/><h5>subtitle</h5><br/><span>+</span>
  </li>
  <div class="span3>
 <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
    <h4>IMAGE1</h4><br/><h5>subtitle</h5><br/><span>+</span>
   </li>

  <div class="span3>
 <li data-target="#ShowCarousel-03" data-slide-to="0" class="active">
    <h4>IMAGE1</h4><br/><h5>subtitle</h5><br/><span>+</span>
 </li>
 </div>
 </div> 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-22T07:41:02.403

它正在崩溃，因为您的轮播指示器的宽度是 320 像素。如果您还希望代码在移动设备上响应，则无法解决。您可以替换百分比而不是使用固定宽度

```
.carousel-indicators li{
    background: url(images/triangle.png) no-repeat;
    max-width:25%;
    max-height:15%; /*or any other percentage that would look good*/
    cursor: pointer;
    text-align:center;
} 
```

请注意，我使用了 max-height 和 max-height ，这样我就可以保持图像的比例，这样它就不会在任何一个方向上被拉伸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:01:03.653

您可以使用媒体查询 -

```
@media screen and (max-width:480px) {
     .carousel-indicators li{
        background: url(images/triangle.png) no-repeat;
        background-size:120px 60px;
        width:120px;
        height:60px;
        cursor: pointer;
        text-align:center;
    } 
```

# android - adb 无法识别 Nexus 7 平板电脑

> ID：15844160
> 
> 赞同：3
> 
> 时间：2013-04-05T21:48:06.460
> 
> 标签：android, adb

我对 android sdk 和我的平板电脑有一些奇怪的行为。我正在尝试通过以下方式识别我的平板电脑：

```
adb devices -l 
```

命令。

每次我插入平板电脑时，电脑上都会弹出一个窗口片刻，询问我将平板电脑识别为相机并询问我想用什么应用程序打开它。然后在我点击任何东西之前它就消失了。在平板电脑上，它会说“允许从某台计算机进行usb调试？”。有时在我点击它之前它会消失。其他时候我点击它，但 adb devices -l 仍然无法识别它。然后我检查 dmesg：

```
[ 3398.180553] usb 1-1: new high-speed USB device number 45 using ehci_hcd
[ 3398.321392] usb 1-1: New USB device found, idVendor=18d1, idProduct=4e44
[ 3398.321404] usb 1-1: New USB device strings: Mfr=2, Product=3, SerialNumber=4
[ 3398.321411] usb 1-1: Product: Nexus 7
[ 3398.321416] usb 1-1: Manufacturer: asus
[ 3404.230444] usb 1-1: USB disconnect, device number 45 
```

我正在使用 Linux Mint 14。直到最近我才遇到问题。

以下是我为解决问题所采取的步骤列表：

1.  重新启动我的计算机，选择不同的内核版本
2.  使用 adb kill-server 和 adb start-server 重新启动 adb
3.  将平板电脑电缆插入其他 4 个 USB 端口
4.  重新启动平板电脑
5.  仔细检查是否仍然启用了 USB 调试（是的，它是）
6.  lsusb（应该显示 Google Inc.，但不是）
7.  我有最新的 sdk，一切都是最新的
8.  谷歌搜索，但我只找到了我已经采取的基本故障排除步骤
9.  更多步骤

我不确定还能做什么。但是，这种生产力时间上的损失让我付出了代价。我几乎完成了我的第一个公司应用程序，需要完成它，以便我可以向他们出售产品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:29:39.057

You can try with these steps:

1.  stop the server with: adb kill-server.
2.  Go to ~/.android/ and if doesn't exist create the file: adb_usb.ini
3.  Add a line with the value: 0x18d1 (the vendorId of your device).
4.  Save and close the file.

Try again. For me it worked (i'm using a 100 euros tablet...) Finally if you still have problems you can create an udev rule in /etc/udev/rules.d/51-android.rules, like the following:

```
SUBSYSTEM =="usb", ATTR{idVendor}=="18d1", MODE ="0666", GROUP ="plugdev" 
```

And make sure that your user is in plugdev group. Hope this help.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T08:22:03.217

一个朋友给了我一根新电缆。现在我的平板电脑显示`adb devices -l`, `lsusb`,`dmesg`没有错误，并且可以在 Eclipse Android SDK Bundle 中运行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-05T22:00:06.203

你检查过块设备的权限吗？尝试以 root 身份启动 adb 服务器。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-05T21:55:58.147

您的计算机上安装了正确的驱动程序吗？

即使平板电脑被识别，这并不一定意味着驱动程序已安装。

您可以在此处找到 Nexus 7 的驱动程序：[http ://www.asus.com/Tablets_Mobile/Nexus_7/#support_Download_32](http://www.asus.com/Tablets_Mobile/Nexus_7/#support_Download_32)

# mysql - Emoji 插入 Play Framework

> ID：15844163
> 
> 赞同：2
> 
> 时间：2013-04-05T21:48:22.417
> 
> 标签：mysql, scala, playframework, emoji

我正在使用播放框架 2.0.x，我遇到了表情符号插入的问题，似乎 SQL 类正在将这些转换为映射的字符串值，而不是我尝试插入的正确字符。我已经在 MySQL 上测试了一些东西，并且可以完美地使用 utf8mb4 设置，这只发生在使用 play 进行插入时，我将它缩小到在插入之前构建查询进行转换的任何内容。

可以清楚地看到转换是在 SQL 对象内的这个查询中发生的

```
SQL(
                  """
                      UPDATE users SET 
                      first_name={fname}
                      , last_name={lname}
                      , email={email}
                      , birthdate={bday}
                      , gender={sex}
                      WHERE user_id={userId} 
                  """
                  ).on(
                      'userId -> userId,
                      'fname -> fname,
                      'lname -> lname,
                      'email -> email.trim,
                      'bday ->bday,
                      'sex -> gender
                  ).executeUpdate()

Execution exception [[SQLException: Incorrect string value: '\xF0\x9F\x98\x9A' for column 'first_name' at row 1]] 
```

当然，我希望此时会看到一个 Emoji 图标，即 .

我需要更改字符编码以进行播放吗？任何想法表示赞赏！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:15:15.360

在查询解决此问题之前添加“SET NAMES utf8mb4”。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-07T09:37:55.193

```
db.default.url="jdbc:mysql://127.0.0.1/test?useUnicode=true&characterEncoding=UTF-8" 
```

使用Unicode=true&characterEncoding=UTF-8

# jquery - jQuery暂停一个while循环

> ID：15844168
> 
> 赞同：0
> 
> 时间：2013-04-05T21:48:43.333
> 
> 标签：jquery

我正在尝试使用 jQuery 中的 while 循环滚动浏览我的横幅图像。

我需要找到一种方法来暂停循环的每个循环，以便横幅图像可以缓慢循环。

这是我的代码

```
var bannerIMG = ['img1','img2','img3'];
var counter = 0;
var num = 1;
while (num <= 3) {
$('#header').addClass(bannerIMG[counter]);
   counter = counter +1;    
   num = num+1;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T21:52:53.310

`**[LIVE DEMO](http://jsbin.com/uresal/4/edit)**`

```
var img = ['img1', 'img2', 'img3'],
    c = 0,
    run = setInterval(loop, 1000); 

function loop(){ 
  $('#header').removeClass().addClass( img[++c%img.length] );    
} 
```

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators/](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators/)
[http://api.jquery.com/](http://api.jquery.com/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-05T21:57:39.687

可以使用此代码

```
var bannerIMG = ['img1','img2','img3'];
var counter = 0;
function loop(){
    $('#header').addClass(bannerIMG[counter]);
    counter = counter+1;
}

setInterval(loop, 1000); 
```

感谢大家的帮助

# java - 蓝牙低功耗 Java Api 或 C/C++ 库

> ID：15844171
> 
> 赞同：2
> 
> 时间：2013-04-05T21:48:59.043
> 
> 标签：java, c++, bluetooth, bluetooth-lowenergy

是否有任何最近移植的 Java api 或 C/C++ 库可用于在 windows XP 或 mac mini 下编写 BLE 独立程序？

正如我在这篇文章中所读到的：“[适用于 Windows 7.0 的蓝牙低功耗 API](https://stackoverflow.com/questions/14401435/bluetooth-low-energy-api-for-windows) ”这样的 API 仅适用于 Windows 8。

有人知道任何对在 Windows 8 下开始编程 BLE 应用程序有用的链接吗？

在此先感谢，乔尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T07:25:53.410

有关示例代码，请参阅以下链接中列出的一些函数的“示例” [http://msdn.microsoft.com/en-us/library/windows/hardware/hh450825(v=vs.85)。 aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/hh450825(v=vs.85).aspx)

希望在一定程度上有所帮助

# ruby - Nokogiri：复制节点并添加新的父节点进行复制？

> ID：15844175
> 
> 赞同：0
> 
> 时间：2013-04-05T21:49:08.107
> 
> 标签：ruby, copy, nokogiri, parent

知道如何复制一个节点，然后给它一个新的父节点，目的是将副本写入一个新文件吗？

我注意到，当我将一个节点重新分配为另一个节点的父节点时，什么也没有发生。例如，

```
doc.xpath("/child").each do|child|

  # copy node to new structure. also tried dup()
  copyofchild = child

  # create new node to become newdoc's parent
  mom = Nokogiri::XML::Node.new('mom', copyofchild)

  copyofchild.parent = mom

  puts copyofchild  # lists <child>...</child>, not <mom><child>...</child></mom>

  # write newdoc to file...   
end 
```

文档页面上的一个示例显示了类似的工作，尽管他们将结构中的一项重新分配为同一结构中另一项的父项。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:22:13.007

从此开始：

```
require 'nokogiri'

xml = '<xml><bar>text</bar></xml>'
doc = Nokogiri::XML(xml)

bar = doc.at('bar')
bar.parent.children = '<foo>' + bar.to_xml + '</foo>'
puts doc.to_xml 
```

看起来像：

```
<?xml version="1.0"?>
<xml>
  <foo>
    <bar>text</bar>
  </foo>
</xml> 
```

或者，您可以这样做：

```
bar = doc.at('bar')
bar.replace('<foo>' + bar.to_xml + '</foo>') 
```

您的代码中的部分问题是您的 XPath 访问器：

```
"/child" 
```

不按你的想法做。它只找到一个顶级`<child>`节点，而不是树中更远的一个节点。在我的示例 XML 中，它相当于`<xml>`节点。也许您想要在整个文档`//child`中查找节点。`<child>`

就个人而言，我更喜欢 CSS 访问器而不是 XPath。两者都得到了 Nokogiri 的良好支持，并且两者都使某些事情变得比另一个更容易，因此熟悉两者是件好事。

# cordova - PhoneGap 应用程序在三星 Galaxy SIII 上停留在纵向模式

> ID：15844177
> 
> 赞同：0
> 
> 时间：2013-04-05T21:49:17.657
> 
> 标签：cordova, rotation, viewport, landscape, portrait

我刚刚完成了我的第一个基于 PhoneGap 的 Android 应用程序。带有 JqueryMobile 的 HTML5。在大多数设备上都可以正常工作，除了手机卡在纵向模式的三星 Galazy SIII 上。我无法让它旋转到横向。我一直在环顾四周，我不确定是否需要更改元视口标签或清单文档中的某个位置的设置。

这是我的元视口标签的内容：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no"/> 
```

知道这是否正确或三星的修复方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:50:56.280

如果您的活动标签中有 android:screenOrientation="portrait"，请查看您的清单。这会将方向固定为纵向。

# wikipedia - 在 Wikipedia Dump 中查找和下载图像

> ID：15844190
> 
> 赞同：6
> 
> 时间：2013-04-05T21:50:19.417
> 
> 标签：wikipedia, wikipedia-api, mediawiki-api

我正在尝试在维基百科上找到所有图像的完整列表，然后我可以将其过滤到公共领域的图像。我已经从这里下载了 SQL 转储：

[http://dumps.wikimedia.org/enwiki/latest/](http://dumps.wikimedia.org/enwiki/latest/)

并研究了数据库模式：

[http://upload.wikimedia.org/wikipedia/commons/thumb/4/42/MediaWiki_1.20_%2844edaa2%29_database_schema.svg/2193px-MediaWiki_1.20_%2844edaa2%29_database_schema.svg.png](http://upload.wikimedia.org/wikipedia/commons/thumb/4/42/MediaWiki_1.20_%2844edaa2%29_database_schema.svg/2193px-MediaWiki_1.20_%2844edaa2%29_database_schema.svg.png)

我想我明白了，但是当我从维基百科页面中选择一个示例图像时，我在转储中的任何地方都找不到它。例如：

[http://en.wikipedia.org/wiki/File:Carrizo_2a.JPG](http://en.wikipedia.org/wiki/File:Carrizo_2a.JPG)

我已经对转储“图像”、“图像链接”和“页面”进行了 grep，以寻找“Carrizo_2a.JPG”，但没有找到。

这些转储不完整吗？我误解了结构吗？有一个更好的方法吗？

另外，要向前迈出一步：在我过滤了我的列表并且我想下载大量图像（数千张）之后，我看到一些提到我需要从网站的镜像中执行此操作以防止 wikipedia/wikimedia 超载. 如果对此也有任何指导，那将很有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T22:12:40.063

MediaWiki 将文件数据存储在两个或三个位置，具体取决于您的计数方式：

*   当前文件版本的实际元数据存储在`image`表中。这可能是您主要想要的；你会在[这里](http://dumps.wikimedia.org/enwiki/latest/enwiki-latest-image.sql.gz)找到它的最新 en.wikipedia 转储。

*   旧被取代文件修订的数据被移动到`oldimage`表中，该表与表具有基本相同的结构`image`。这张桌子也被倾倒了，最新的一张在[这里](http://dumps.wikimedia.org/enwiki/latest/enwiki-latest-oldimage.sql.gz)。

*   最后，每个文件也（通常）对应于命名空间 6 ( ) 中的一个非常普通的 wiki 页面`File:`。您将在 XML 转储中找到这些文本，与任何其他页面相同。

哦，您在英文维基百科转储中找不到链接到的那些文件的原因是它们来自 Wikimedia Commons 的共享存储库。您将在[Commons 数据转储](http://dumps.wikimedia.org/commonswiki/latest/)中找到它们。

至于下载实际文件，[这里是（显然）官方文档。](http://en.wikipedia.org/wiki/Wikipedia%3aDatabase_download#Where_are_images_and_uploaded_files) 据我所知，他们所说的“*批量下载目前（截至 2012 年 9 月）可以从镜像中获得，但不能直接从 Wikimedia 服务器提供。* ”就是如果你想要一个 tarball 中的所有图像，你将拥有使用镜子。如果您只是从维基百科和/或共享资源上的数百万图像中提取相对较小的一部分，那么直接使用维基媒体服务器应该没问题。

只需记住基本礼貌：发送一个[用户代理字符串](http://meta.wikimedia.org/wiki/User-Agent_policy)来标识您自己，并且不要对服务器施加太大压力。特别是，我建议您按顺序运行下载，这样您只有在完成前一个文件后才开始下载下一个文件。无论如何，这不仅比并行下载更容易实现，而且它确保您不会占用超过您的带宽份额，并允许下载速度或多或少地自动适应服务器负载。

附言。无论您是从镜像下载文件还是直接从 Wikimedia 服务器下载文件，您都需要确定它们位于哪个目录。典型的 Wikipedia 文件 URL 如下所示：

```
http://upload.wikimedia.org/wikipedia/en/a/ab/File_name.jpg 
```

其中“ `wikipedia/en`”部分标识维基媒体项目和语言（出于历史原因，Commons 被列为“ `wikipedia/commons`”），[“ `a/ab`”部分](http://commons.wikimedia.org/wiki/FAQ#What_are_the_strangely_named_components_in_file_paths.3F)由 UTF-8 中文件名的 MD5 哈希的前两个十六进制数字给出（因为它们'在数据库转储中编码）。

# asp.net-mvc - 在 automapper valueresolver 中生成到 mvc 控制器操作的路由

> ID：15844193
> 
> 赞同：1
> 
> 时间：2013-04-05T21:50:32.107
> 
> 标签：asp.net-mvc, asp.net-mvc-4, automapper

我正在使用 automapper 并有一个值解析器。在解析器中，我想创建一个指向 mvc 路由的链接，最好使用 T4MVC 或任何其他方式。我的控制器的结果是路由强格式的 url。

我该如何设置？可能吗？

# android - Screen_Off 在应用程序级别不起作用

> ID：15844195
> 
> 赞同：1
> 
> 时间：2013-04-05T21:50:44.427
> 
> 标签：android, broadcastreceiver

Screen_Off 在应用程序级别中不起作用，尽管它在活动级别上工作。

我的问题，当屏幕熄灭时，它必须进入登录屏幕，下面的代码，成功进入登录屏幕，但它导致我未注册接收广播

我做了什么

如果我在 Menifesty 级别做，屏幕关闭广播不会触发，

清单级别

```
 <receiver android:name="com.android.libray.ScreenReciver" android:enabled="true" >
         <intent-filter>
             <action android:name="android.intent.action.SCREEN_OFF"/>
                   <action android:name="android.intent.action.SCREEN_ON"/>
             </intent-filter>
      </receiver>

if i do in activity level,then it will fire screenReciver

  IntentFilter filter =new IntentFilter(Intent.ACTION_SCREEN_OFF);

            BroadcastReceiver mReceiver=new ScreenReciver();
                registerReceiver(mReceiver, filter);

public class ScreenReciver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        // TODO Auto-generated method stub
         if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
                // do whatever you need to do here

             Intent myintent = new Intent(context,TimerClockActivity.class);
                myintent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
                myintent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                context.startActivity(myintent);
                wasScreenOn = false;
             Log.v("screenoff", "Logggoff");

            } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
                // and do whatever you need to do here

            }

    } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:11:56.267

广播是受保护的`SCREEN_OFF`广播，只有通过 Java 代码在 Service 或 Activity 或另一个 Receiver 中动态注册时，您才会收到它。在清单中注册不适用于此广播。

# c++ - 为什么这在 Visual Studio 2012 (SP2) 中不起作用

> ID：15844203
> 
> 赞同：0
> 
> 时间：2013-04-05T21:51:23.010
> 
> 标签：c++, visual-studio-2010, visual-studio-2012, dereference

这应该只是用单词 POINTER 替换 '*'

```
#define POINTER *

// Define an 8bit byte
typedef unsigned short aByte;

// Define a pointer to an 8bit byte
typedef aByte POINTER aPointerToByte; 
```

这不会在 vs2012 中编译，但它确实在 vs2010 中编译

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T17:54:13.987

好的，我不确定我是否理解这一点，但是以某种方式删除这段代码会使问题消失。

```
#if !defined(__FreeBSD__)
   #include <pcrt32.h>
#endif 
```

# javascript - JavaScript 中的“variable = variable || {}”是什么意思

> ID：15844213
> 
> 赞同：9
> 
> 时间：2013-04-05T21:52:03.840
> 
> 标签：javascript

这个变量的初始化代表什么：

```
var variable = variable  ||  {} ; 
```

应该如何以及何时使用它？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-05T21:53:28.603

该行代码执行以下操作：

**IF** `variable`未定义（或具有错误值）**然后**将其设置为空对象。

**ELSE**什么都不做（从技术上讲，`variable`被分配给自己）

换句话说`variable`，如果它是以下任何一种，它将被转换为一个空对象：

*   错误的
*   不明确的
*   无效的
*   零
*   钠
*   一个空字符串

请参阅[toBoolean](http://www.ecma-international.org/ecma-262/5.1/#sec-9.2)以了解规范对错误值的*定义*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:53:38.470

如果变量未定义或为假，则将其初始化为空对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T21:53:49.253

就是测试是否`variable`被初始化。如果不是，它初始化`variable`为一个空对象。如果它确实存在，它什么也不做，（技术上分配`variable`给它自己）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T21:54:33.817

如果变量已经存在，则使用它，否则创建一个空对象

# mysql - ASP.NET MVC 4，一个视图中的多个模型？

> ID：15844215
> 
> 赞同：5
> 
> 时间：2013-04-05T21:52:08.467
> 
> 标签：mysql, asp.net, asp.net-mvc, vb.net, asp.net-mvc-4

我正在做一个小项目，其中我们有一张工程师表、一张项目表和一张元素表。工程师被分配了多个元素，元素可以有多个项目。我只是想知道我将如何展示工程师所不具备的所有元素。

目前，我创建了一个将工程师与元素相关联的表。它看起来有点像这样：

```
 [Engineer Elements]
[Engineer ID][Element ID]
   [1]           [2]
   [1]           [4]
   [2]           [2]
   [2]           [8] 
```

所以我确实有办法链接这两个表。可以将我推向正确的方向，学习更多关于使用 MVC 将这些表链接在一起的知识吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T21:58:15.843

如果您还没有一个视图模型来表示它，只需创建一个：

```
public class MyViewModel
{
    public Engineer Engineer { get; set; }
    public List<Element> Elements { get; set; }
} 
```

在控制器中填充一组视图模型

```
public ActionResult MyAction()
{
    var viewModels = 
        (from e in db.Engineers
         select new MyViewModel
         {
             Engineer = e,
             Elements = e.Elements,
         })
        .ToList();
    return View(viewModels);
} 
```

在您的视图中，只需指定您正在使用视图模型的集合：

```
@model List<MyViewModel>
@foreach(var vm in Model)
{
    <h1>Projects for engineer: @vm.Engineer.Name</ha>
    <ul>
    @foreach(var ele in vm.Elements)
    {
        <li>@ele.Name</li>
    }
    </ul>
} 
```

# msbuild - 如何从巡航控制.net 运行外部 msbuild 文件

> ID：15844216
> 
> 赞同：1
> 
> 时间：2013-04-05T21:52:09.677
> 
> 标签：msbuild, cruisecontrol.net

我有一个构建大约 20 个 vc2010 解决方案的 msbuild xml 文件。它从源代码控制中检索代码，构建所有解决方案，并对结果进行模糊处理（对于 .net 项目）。我想从 ccnet 使用它。有没有办法只“调用”这个 xml 文件来构建我的项目？这样做有缺点吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T00:04:16.520

是的，CruiseControl.NET 有[构建 MSBuild 项目的任务](http://www.cruisecontrolnet.org/projects/ccnet/wiki/MsBuild_Task)。

# java - Hibernate：实体上的多个过滤器

> ID：15844220
> 
> 赞同：9
> 
> 时间：2013-04-05T21:52:23.397
> 
> 标签：java, hibernate, hibernate-filters

我想在一个实体上使用多个 Hibernate 过滤器，我已经尝试了所有合乎逻辑的事情，但没有运气，而 Google 在这方面做得不够，Hibernate 文档也是如此。我无法想象这是不可能的。（使用 Java 6 Hibernate 4.1.9.final）

**目前，我有这个：**

```
@Entity
@Table(name = "CATEGORY")
public class Category implements Serializable
{
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "CATEGORYID")
    private int ID;

    @Column(name = "CATEGORYNAME")
    private String name;

    @OneToMany(fetch = FetchType.EAGER)
    @JoinColumn(name = "CATEGORYID")
    @OrderBy("TESTCASEID desc")
    @Filter(name = "TEST_RUN_ID_FILTER")
    private Collection<TestCase> testCases;
...
}

@Entity
@Table(name = "TESTCASE_NEW")
@FilterDef(name = "TEST_RUN_ID_FILTER", defaultCondition = "TESTRUNID in (:IDS)", parameters = { @ParamDef(name = "IDS", type = "int") })
public class TestCase implements Serializable
{
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "TESTCASEID")
    private int ID;

    @Column(name = "TESTCASENAME")
    private String name;

...
} 
```

我想向 Testcase 类添加第二个独立过滤器。我所追求的是这样的：

```
Select ...  
  From CATEGORY INNER JOIN TESTCASE on CATEGORY.CATEGORYID = TESTCASE.CATEGORYID
 Where TESTCASE.TESTRUNID in (....)
   and TESTCASE.TESTCASENAME like '%..%' 
```

**这是我尝试过的**

我尝试像这样将多个@FilterDefs 添加到TestCase，但是没有编译：

```
 @Entity
    @Table(name = "TESTCASE_NEW")
    @FilterDef(name = "TEST_RUN_ID_FILTER", defaultCondition = "TESTRUNID in (:IDS)", 
parameters = { @ParamDef(name = "IDS", type = "int") })
    @FilterDef(name = "TESTCASE_NAME_FILTER", defaultCondition = "TESTCASENAME like :TESTCASE_NAME", 
parameters = { @ParamDef(name = "TESTCASE_NAME", type = "string") })

    public class TestCase implements Serializable
    {
        private static final long serialVersionUID = 1L;

        @Id
        @Column(name = "TESTCASEID")
        private int ID;

        @Column(name = "TESTCASENAME")
        private String name;

    ...
    } 
```

Hibernate 文档导致尝试这样的事情，抱怨 testrunid 过滤器不存在

```
 @Entity
    @Table(name = "CATEGORY")
    public class Category implements Serializable
    {
        private static final long serialVersionUID = 1L;

        @Id
        @Column(name = "CATEGORYID")
        private int ID;

        @Column(name = "CATEGORYNAME")
        private String name;

        @OneToMany(fetch = FetchType.EAGER)
        @JoinColumn(name = "CATEGORYID")
        @OrderBy("TESTCASEID desc")
        private Collection<TestCase> testCases;
    ...
    }

       @Entity
    @Table(name = "TESTCASE_NEW")
    @FilterDef(name = "TESTCASE_FILTER", parameters = { @ParamDef(name = "IDS", type = "int"), @ParamDef(name = "TESTCASE_NAME", type = "string") })
    @Filters({ @Filter(name = "TEST_RUN_ID_FILTER", condition = "TESTRUNID in (:IDS)"), @Filter(name = "TESTCASE_NAME_FILTER", condition = "TESTCASENAME like :TESTCASE_NAME") })
    // @FilterDef(name = "TEST_RUN_ID_FILTER", defaultCondition = "TESTRUNID in (:IDS)", parameters = { @ParamDef(name =
    // "IDS", type = "int") })
    public class TestCase implements Serializable
    {
        private static final long serialVersionUID = 1L;

        @Id
        @Column(name = "TESTCASEID")
        private int ID;

        @Column(name = "TESTCASENAME")
        private String name;
        ...
    }
     @SuppressWarnings("unchecked")
        public List<Category> getCategories(List<Integer> testRunIDs, String category, String testCaseName)
        {
            Session session = getSession();
            session.enableFilter("FILE_TYPE_FILTER");
            if (testRunIDs != null && testRunIDs.size() != 0)
            {
                session.enableFilter("TEST_RUN_ID_FILTER").setParameterList("IDS", testRunIDs);
            }
            if (category != null && !category.equals("0") && !category.equals(""))
            {
                session.enableFilter("CATEGORY_FILTER").setParameter("CATEGORY", category);
            }

            /*
             * Hibernate wants to do an (left) outer join be default.
             * This bit of HQL is required to get it to do an inner join.
             * The query tells Hibernate to do an inner join on the testCases property inside the Category object
             */

            Query query = session.createQuery("select distinct c from Category c inner join c.testCases tc");
            List<Category> result = query.list();
            return result;

..
} 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-06T01:16:12.970

我实际上已经解决了，但感谢您的帮助。解决方案（下文详述）是将多个 @FilterDef 注释包装在一个 @FilterDef**的**注释中。奇怪的是，我在任何地方或在 Hibernate 文档中都没有找到这个，我看到了这篇文章（[一个元素上相同类型的多个注释？](https://stackoverflow.com/questions/1554112/multiple-annotations-of-the-same-type-on-one-element)），并认为嘿也许 @FilterDefs 存在并且确实存在。

```
@Entity
@Table(name = "TESTCASE_NEW")
@FilterDefs({
        @FilterDef(name = "TESTCASE_NAME_FILTER", defaultCondition = "TESTCASENAME like :TESTCASENAME", parameters = { @ParamDef(name = "TESTCASENAME", type = "string") }),
        @FilterDef(name = "TEST_RUN_ID_FILTER", defaultCondition = "TESTRUNID in (:IDS)", parameters = { @ParamDef(name = "IDS", type = "int") })
})
public class TestCase implements Serializable
{
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "TESTCASEID")
    private int ID;

    @Column(name = "TESTCASENAME")
    private String name;

...
}

@Entity
public class Category implements Serializable
{
    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "CATEGORYID")
    private int ID;

    @Column(name = "CATEGORYNAME")
    private String name;

    @OneToMany(fetch = FetchType.EAGER)
    @JoinColumn(name = "CATEGORYID")
    @OrderBy("TESTCASEID desc")
    @Filters({
            @Filter(name = "TEST_RUN_ID_FILTER"),
            @Filter(name = "TESTCASE_NAME_FILTER") })
    private Collection<TestCase> testCases;

...
} 
```

在 DAO 中，我只打开我需要的那些

```
public List<Category> getCategories(List<Integer> testRunIDs, String category, String testCaseName)
    {
        Session session = getSession();

        if (testRunIDs != null && testRunIDs.size() != 0)
        {
            session.enableFilter("TEST_RUN_ID_FILTER").setParameterList("IDS", testRunIDs);
        }

        if (testCaseName != null)
        {
            session.enableFilter("TESTCASE_NAME_FILTER").setParameter("TESTCASENAME", testCaseName);
        }

        /*
         * Hibernate wants to do an (left) outer join be default.
         * This bit of HQL is required to get it to do an inner join.
         * The query tells Hibernate to do an inner join on the testCases property inside the Category object
         */

        Query query = session.createQuery("select distinct c from Category c inner join c.testCases tc");
        List<Category> result = query.list();
        return result;
    } 
```

# html - 删除隐藏和显示中的空白：无输入元素

> ID：15844222
> 
> 赞同：0
> 
> 时间：2013-04-05T21:52:27.890
> 
> 标签：html, css, input, hidden, space

我有几行看起来像这样：

```
<input type="hidden" name="email" value="email@email.com" style="display:none" > 
```

每个都增加了额外的空间，即使我使用了隐藏类型和显示：无。我开始认为这是 CSS 中的东西（[http://www.pastebin.ca/2350649](http://www.pastebin.ca/2350649)），但是在改变了一些东西之后也找不到导致它的原因。

输入都在一个表单中，如果这有区别的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:04:36.350

它不是输入元素，而是 html。如果你有这样的设置：

```
text
<input>
more text 
```

呈现文本和输入元素之间的换行符/空格。

最简单的解决方案当然是在发出 html 时删除该空格。如果你不能这样做，一个技巧是添加`font-size: 0`到容器和`font-size ?`要显示的单个元素中。

[http://jsfiddle.net/ExplosionPIlls/cs63w/](http://jsfiddle.net/ExplosionPIlls/cs63w/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-21T10:26:24.303

**第 1步：**将代码添加到 div 元素中，并带有如下 id 标签：

```
<div id="remove_br"><input type="hidden" name="email" value="email@email.com" style="display:none" ></div> 
```

**step2：**在你的页面标签之前添加这个jQuery代码`</html>`：

```
<script type="text/javascript">
$("#remove_br").find('br').remove()
</script> 
```

**注意：**不要忘记添加此代码以调用 jQuery

```
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script> 
```

对于初学者程序员：如果您不想自己下载和托管 jQuery，您可以从 CDN（内容交付网络）中包含它。

```
 <head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head> 
```

将 jQuery 添加到您的网页[单击此处](http://www.w3schools.com/jquery/jquery_install.asp)。

# jquery - 如何创建一个具有右列的页面，该页面在某个点后不应滚动

> ID：15844223
> 
> 赞同：-4
> 
> 时间：2013-04-05T21:52:29.900
> 
> 标签：jquery, html, css

如果你看这个页面，

[http://www.cracked.com/blog/4-simple-pieces-career-advice-almost-no-one-follows/](http://www.cracked.com/blog/4-simple-pieces-career-advice-almost-no-one-follows/)

您会看到，在向下滚动几页后，右栏固定在最后一部分，并且不会随着页面的其余部分向下滚动。（它固定在最后一个广告上）我怎样才能实现这种效果？有教程或指南吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:58:36.373

您需要使用 jQuery。如果 .box 是滚动后要修复的 div：

```
$(window).scroll(function(){
    var scrollTop = $(window).scrollTop();

    if(scrollTop > 200){
        $('.box').css('position','fixed');
        }
}); 
```

# c++ - 对象的实例化类

> ID：15844225
> 
> 赞同：0
> 
> 时间：2013-04-05T21:52:34.447
> 
> 标签：c++, gdb, eclipse-cdt

我在eclipse中用gdb调试一个c++程序。我现在怎么知道一个对象的确切类别？假设我正在调试一个方法

```
void foo(Instruction *I){
  I->bar();
} 
```

假设还有`Instruction`很多子类。我怎么知道`Instruction`实例化对象的哪个子类`I`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T18:01:30.030

您想要“设置打印对象”。这将使用 RTTI 信息打印完整的对象。

这应该是默认值；希望最终会是这样。

# oop - 无法为文件生成代码

> ID：15844231
> 
> 赞同：0
> 
> 时间：2013-04-05T21:52:50.843
> 
> 标签：oop, gcc, real-time, ada, gnat

请看下面的代码

**公式.ads**

```
package Formula is
   procedure CalculateFormula;
end Formula; 
```

**公式.adb**

```
with Ada.Text_IO; use Ada.Text_IO;
with Formula; use Formula;

package body Formula is
   procedure CalculateFormula is

      package fom_io is new Ada.Float_Text_IO(Float);
      use fom_io;

      u : Float;
      t : Float;
      a : Float;
      answer : Float;

   begin
      put_line("Enter 'U'");
      get(u);

      put_line("Enter 'T'");
      get(t);

      put_line("Enter 'A'");
      get(a);

      answer = (u*t)+ 0.5(a(t*t));

      put("Answer is: ");
      put(answer,Fore => 1,Aft => 1,Exp => 1);
   end CalclualeFormula;
end Formula; 
```

当我运行此代码时，出现以下错误

```
gnatmake -d -PC:\Users\yohan\Documents\Ada\Formula\formula.gpr
gcc -c -I- -gnatA C:\Users\yohan\Documents\Ada\Formula\formula.ads
cannot generate code for file formula.ads (package spec)
gnatmake: "C:\Users\yohan\Documents\Ada\Formula\formula.ads" compilation error

[2013-04-06 03:18:22] process exited with status 4 (elapsed time: 00.22s) 
```

我对艾达很陌生。几个小时前开始编码。请帮助我摆脱上述问题。谢谢你。

**编辑**

**公式.gpr**

```
project Formula is

   for Main use ("formula.ads");

end Formula; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:09:04.683

GPR 文件显示您正在尝试将包规范用作主程序单元 - 这不起作用。

解决这个问题的两种方法：最简单的一种是在文件“calculateformula.adb”中使“CalculateFormula”成为一个独立的主程序，并将其设置在您的项目文件中：

```
for Main use ("calculateformula.adb"); 
```

但是，如果您想了解包是如何工作的，有一种“更好”的方法（因为它可以让您了解包的用途以及它们的使用方式......）

包是可重用的组件：包规范是您使用它们所需的全部内容......但实际上您在另一个程序中使用它们。所以在这种情况下，您将创建一个主程序

```
with Formula; use Formula;

    procedure MyMain is
    begin
       CalculateFormula;
    end MyMain; 
```

在 .gpr 文件中，

```
for Main use ("mymain.adb"); 
```

然后编译器会自动编译正确的包并找到 Shark 指出的其他问题。

正如“hello world”示例所示，您在这里真的不需要单独的 Main。然而，这种琐碎的“主子程序”（用正确的 Ada 术语来说）并不罕见，尤其是对于稍后在更复杂的应用程序中使用的单元测试包之类的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:10:17.843

这令人费解，因为编译器应该标记一些大错误，例如：

```
package fom_io is new Ada.Float_Text_IO(Float); 
```

这不是`with`ed，并且

```
answer = (u*t)+ 0.5(a(t*t)); 
```

因为：

1.  `=`不是赋值运算符；你需要`:=`。
2.  0.5(XXXX) 不是有效的乘法。

另外，Ada 中有幂运算，所以 t**2 可以代替 t*t。

* * *

**`formula.adb`**

```
with
Ada.Float_Text_IO,
Ada.Text_IO;

use
Ada.Text_IO;

package body Formula is
   procedure CalculateFormula is

      use Ada.Float_Text_IO;

      u, t, a, answer : Float;

    Procedure Prompt( Item : out Float; Name : String ) is
    begin
        put_line("Enter '"& Name &"'");
        get(Item);
    end prompt;
   begin

    prompt( u, "U" );
    prompt( t, "T" );
    prompt( a, "A" );

      answer:= (u*t) + 0.5*( a*t**2 );

      put("Answer is: ");
      put(answer,Fore => 1,Aft => 1,Exp => 1);
      New_Line;
   end CalculateFormula;
end Formula; 
```

这更正了您遇到的语法错误。另一个答案似乎是正确的，因为这个 ["cannot generate code for" 错误] 似乎是 gpr 文件而不是源本身的问题。

# python - 我需要 print 语句留在 If 循环中，所以它是有条件的，但在 for 循环之外，所以它不会重复很多次

> ID：15844239
> 
> 赞同：1
> 
> 时间：2013-04-05T21:53:11.673
> 
> 标签：python, loops, break

我目前正在使用 for 循环。它遍历一堆命令，最后，我希望它打印一些东西。在这个 for 循环中，是一个 if-else 语句。

我使用 break 来中断 if- 语句，然后它直接进入 else 部分。

```
for x in list:
   if x is 1:
      do a bunch of commands
      break
   else:
      do a bunch of other commands
print 'Success' 
```

我需要 print 语句留在 If 循环中，所以它是有条件的，但在 for 循环之外，所以它不会重复很多次。有任何想法吗？

我希望它仅在 x 不等于 1 时打印“成功”。但最后只有一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T21:57:41.933

你可以使用一个*标志*——一个你设置的变量来指示一个事件的发生（在这种情况下，`else`分支已经到达）。

```
success = False
for x in list:
   if x is 1:
      do a bunch of commands
      break
   else:
      do a bunch of other commands
      success = True

if success:
    print 'Success' 
```

这里发生的情况是，`else`可能会在循环中多次到达案例，将成功变量设置为`True`（可能）多次。最后的`if`语句检查标志是否`True`在末尾，因此`'Success'`最多打印一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:36:29.173

在这种情况下你不需要一个标志，python 有你覆盖，使用`for` `else`

```
for x in list:
  if x is 1:
      # do a bunch of commands
      break
  else:
      # do a bunch of other commands
else:
    # only if we didn't break from the loop (no 1 in the list)
    print 'Success' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-03T04:58:18.137

# 必须设置标志

标志 = 0

def findlength(s): length = len(s) for p in password: if(length >= 6): flagA = 1 else: flagA = 0

```
return flagA 
```

def findupper(u): for p in password: if(p.isupper() == 1): flagB = 0

```
 else:
        flagB = 1

return flagB 
```

def findlower(l): for p in password: if(p.islower()): flagC = 0

```
 else:
        flagC = 1

return flagC 
```

def findnumber(d): for p in password: if(p.isdigit()): flagD = 1

```
 else:
        flagD = 0
return flagD 
```

# perl - 按perl中的元素计数

> ID：15844250
> 
> 赞同：1
> 
> 时间：2013-04-05T21:53:45.743
> 
> 标签：perl

我有一个像这样的文件：

```
fan      apple banana orange mango
cooler   apple orange banana mango
cooler   apple orange banana mango
cooler   apple orange banana mango
fan      apple banana orange mango
fan      apple banana orange mango
cooler   apple orange banana mango
fan      apple banana orange mango 
```

现在，当我逐行进行时，我想在范来的那一刻数一数，并且需要增加每个粉丝的计数。喜欢

```
count 1
fan      apple banana orange mango
cooler   apple orange banana mango
cooler   apple orange banana mango
cooler   apple orange banana mango
count 2
fan      apple banana orange mango
count 3
fan      apple banana orange mango
cooler   apple orange banana mango
count 4
fan      apple banana orange mango 
```

这就是我想要的输出。帮助表示赞赏...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T21:58:14.577

```
#!/usr/bin/perl
use strict;
use warnings;

my $n = 0;
while (<>) {
    print "count ", ++$n, "\n" if /^fan\b/;
    print;
} 
```

或作为使用 Perl 5.10+ 的单行程序：

```
perl -pE 'say "count ", ++$n if /^fan\b/' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:01:06.543

在单行中：

```
perl -lane 'BEGIN{$c=1}; $F[0] eq "fan" && do{print "count ".$c++ }; print' file 
```

# mysql - SQL 帮助 - 根据匹配不同的字段更新一个表中的字段以匹配另一个表中的字段

> ID：15844255
> 
> 赞同：1
> 
> 时间：2013-04-05T21:54:16.920
> 
> 标签：mysql, sql, phpmyadmin

感谢任何帮助。我正在研究一个设计有点糟糕的数据库。我需要通过基于另一个表更新一个表来修复一些不良数据，如下所示（我松散地描述了我需要的 SQL）：

两张表：

*   **`Airports`**- 包括字段：`lat`, `lon`, `airport_id`.
*   **`Events`**- 包括字段：`lat`, `lon`, `airport_id`.

我想更新（当前不正确的）事件表`lat`和`lon`（正确的）机场表纬度和经度。

基本上：`UPDATE events WHERE <events.airport_id = airports.airport_id> SET events.lat = airports.lat`

然后我可以再次运行它。

我知道我很接近，但没有确切的语法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:22:30.020

这也应该有效：

```
UPDATE events e
set    e.lat = (select a.lat from airports a where a.airport_id = e.airport_id),
       e.lon = (select a.lon from airports a where a.airport_id = e.airport_id)
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:56:43.603

是的，你很接近，但你需要[`UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/update.html)with `JOIN`。这是正确的语法：

```
UPDATE events AS e
INNER JOIN Airports AS a ON e.airport_id = a.airport_id
SET e.lat = a.lat,
    e.lon = a.lon; 
```

您将表引用，在`UPDATE`子句中指定的更新表与`JOIN`ed 表直接放在子句之后，然后在该`UPDATE`子句之后`SET`，您还可以`WHERE`在末尾包含一个可选子句。

# ios - 使用块会自动创建新线程吗？

> ID：15844264
> 
> 赞同：1
> 
> 时间：2013-04-05T21:54:52.777
> 
> 标签：ios, multithreading, objective-c-blocks

刚刚开始使用块......非常混乱。我正在使用这样的块：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
NSDictionary *myDictionary = [[mySingleton arrayPeopleAroundMe] objectAtIndex:indexPath.row];

NSMutableString *myString = [[NSMutableString alloc] initWithString:@"http://www.domain.com/4DACTION/PP_profileDetail/"];
[myString appendString:[myDictionary objectForKey:@"userID"]];
NSURLRequest *urlRequest = [NSURLRequest requestWithURL:[NSURL URLWithString:[myString stringByAddingPercentEscapesUsingEncoding: NSUTF8StringEncoding]]
                                            cachePolicy:NSURLRequestUseProtocolCachePolicy
                                        timeoutInterval:60.0];
NSOperationQueue *queue = [[NSOperationQueue alloc] init];
[NSURLConnection
 sendAsynchronousRequest:urlRequest
 queue:queue
 completionHandler: ^( NSURLResponse *response,
                      NSData *data,
                      NSError *error)
 {
     [[mySingleton dictionaryUserDetail] removeAllObjects];
     [[mySingleton arrayUserDetail] removeAllObjects];

     if ([data length] > 0 && error == nil) // no error and received data back
     {
         NSError* error;
         NSDictionary *myDic = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
         [mySingleton setDictionaryUserDetail:[myDic mutableCopy]];

         NSArray *myArray = [myDic objectForKey:@"searchResults"];
         [mySingleton setArrayUserDetail:[myArray mutableCopy]];

         [self userDetailComplete];
     } else if
         ([data length] == 0 && error == nil) // no error and did not receive data back
     {
         [self serverError];
     } else if
         (error != nil) // error
     {
         [self serverError];
     }
 }];
} 
```

一旦连接完成，这被称为：

```
-(void)userDetailComplete {
ViewProfile *vpVC = [[ViewProfile alloc] init];
[vpVC setPassedInstructions:@"ViewDetail"];
[[self navigationController] pushViewController:vpVC animated:YES];
} 
```

导致此错误弹出：“尝试从主线程或Web线程以外的线程获取Web锁。这可能是从辅助线程调用UIKit的结果。” 我摆脱错误的唯一方法是将 userDetailComplete 更改为：

```
-(void)userDetailComplete {
dispatch_async(dispatch_get_main_queue(), ^{
ViewProfile *vpVC = [[ViewProfile alloc] init];
[vpVC setPassedInstructions:@"ViewDetail"];
[[self navigationController] pushViewController:vpVC animated:YES];
});
} 
```

我的问题：每次使用块时都会自动启动一个新线程吗？使用积木时我还应该注意哪些其他陷阱？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T22:03:34.993

块不创建线程。它们是闭包；它们只包含可在将来某个时间点运行的可运行代码。

这是在后台线程上运行的，因为这是您要求它执行的操作：

```
NSOperationQueue *queue = [[NSOperationQueue alloc] init];
[NSURLConnection
  sendAsynchronousRequest:urlRequest
  queue:queue
  ... 
```

您创建了一个新队列，然后要求`NSURLConnection`在该队列上给您回电。如果您想在主线程上被回调，请通过`[NSOperationQueue mainQueue]`. 这通常是你想要的。

# asp.net-mvc - 带有 connString 的 DbContext 构造函数导致 EF 迁移和 EF Powertools 出现问题

> ID：15844268
> 
> 赞同：0
> 
> 时间：2013-04-05T21:55:14.297
> 
> 标签：asp.net-mvc, entity-framework, asp.net-web-api, dbcontext

我想将连接字符串传递给 DbContext 的构造函数。此处已回答了执行此操作的方法：[将连接字符串传递给代码优先的 DbContext](https://stackoverflow.com/questions/4805094/pass-connection-string-to-code-first-dbcontext)

（不喜欢点击的代码）

```
public MyContext(string connString)
    : base(connString)
{

} 
```

但是，当我尝试启用迁移时，我收到错误消息：“目标上下文 '...' 不可构造。添加默认构造函数或提供 IDbContextFactory 的实现。”

此外，当我尝试使用 EF PowerTools 生成实体数据模型时，收到错误消息：“在所选文件中找不到派生自 DbContext 的可构造类型。”

这是个常见的问题吗？我有一个修复，但感觉就像一个黑客。其他人必须先处理这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:04:43.960

还添加一个空构造函数，例如..

```
public MyContext()
{
} 
```

事情是，一旦你定义了一个参数化的 ctor，你的默认 ctor 就会被隐藏

例如[，当您创建带参数的构造函数时，为什么默认的无参数构造函数会消失](https://stackoverflow.com/questions/11792207/why-does-the-default-parameterless-constructor-go-away-when-you-create-one-with)

这也是向外部用户“隐藏”默认构造的一种方式。

* * *

通常，您甚至不会将“其他” ctor 暴露给外部 - 作为“您的”，您只需在您需要的内容中进行硬编码。或者更好 - 您使用“app.config”来指定连接字符串。有关详细信息（及其问题），请参阅...

[迁移不会改变我的表](https://stackoverflow.com/questions/15730662/migration-does-not-alter-my-table/15734839#15734839)
[迁移没有按我的意愿工作... Asp.net EntityFramework](https://stackoverflow.com/questions/15794413/migration-not-working-as-i-wish-asp-net-entityframework/15795166#15795166)

# jquery - bxSlider 自定义前下一个按钮

> ID：15844270
> 
> 赞同：5
> 
> 时间：2013-04-05T21:55:31.500
> 
> 标签：jquery, navigation, slider, next, bxslider

我想使用我自己的 pre 和 next 按钮，它也在滑块 div 之外。我正在使用 BxSlider。我将分享我的代码。如果你能帮上忙，我会很高兴的。

这是按钮和幻灯片。

```
 <div class= "productsbuttons"><img id ="proprev" src="images/productleftarrow.png" /><img style="margin-left:10px;" id="pronext" src="images/productrightarrow.png" /> </div>
            </div>       
            <div class = "products">
              <ul class = "mainslider">
                <li><img class = "productslider" src="images/menu-image/img1.png" /> Lores ASda</li>
                <li><img class = "productslider" src="images/img1.png" /> ASDasdasd</li>
                <li><img class = "productslider" src="images/menu-image/img1.png" /> ASd</li>
                <li><img class = "productslider" src="images/img1.png" /> ASas</li>
              </ul> 
```

这是jquery

```
$(document).ready(function() {
  var mySlider =   $('.mainslider').bxSlider({
  nextSelector: '#pronext',
  prevSelector: '#proprev',

  prevText: '',   
  nextText: '',
  minSlides: 2,
  maxSlides: 2,
  slideWidth: 360,
  slideMargin: 5,
  pager:false,
    });
  }); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-07-10T10:00:25.577

添加您的图像`src`，`nextText`如下所示：

```
nextText: '<img src="images/next.jpg" height="25" width="25"/>',
prevText: '<img src="images/previous.jpg" height="25" width="25"/>' 
```

工作示例的工作[**JSFiddle**](http://jsfiddle.net/qLSGe/1/)：

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-04-17T16:45:04.017

您可以在下面尝试此代码。这应该有效。

```
$(document).ready(function(){

    var slider = $('.mainslider').bxSlider({
        minSlides: 2,
            maxSlides: 2,
            slideWidth: 360,
            slideMargin: 5,
            pager:false,
    });

    $('#pronext').click(function(){
      slider.goToNextSlide();
      return false;
    });

    $('#proprev').click(function(){
      slider.goToPrevSlide();
      return false;
    });

}); 
```

# ios - UINavigationController 后退按钮没有动画

> ID：15844274
> 
> 赞同：7
> 
> 时间：2013-04-05T21:55:39.973
> 
> 标签：ios, uinavigationcontroller

我对导航控制器的后退按钮动画有一个奇怪的问题：

我的应用程序有一个带有 3 个选项卡的选项卡栏控件，其中一个有一个导航控制器和两个后续视图控制器，第一个仅显示主表，第二个显示详细信息，当我从详细信息中点击后退按钮时出现问题视图控制器，而不是滑回主视图控制器，它只是弹出没有动画的视图。

我注意到，如果我先转到另一个选项卡，然后再次返回此选项卡，动画将正常触发。

我已经从头开始重建了整个应用程序导航，但问题仍然存在，感谢任何帮助。

提前致谢！。

编辑：添加了更多信息

这就是我的故事板在那个特定分支中的样子： ![在此处输入图像描述](https://i.stack.imgur.com/HpSgx.png)

这是来自“Partidos Activos”视图控制器的 prepareForSegue：

```
#pragma mark - Segues

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    if ([segue.identifier isEqualToString:@"PartidosEnDia"]) {
        PartidosActivosEnFecha *paf = segue.destinationViewController;
        CalendarCell *senderCell = (CalendarCell *)sender;
        paf.datos = senderCell.dataDic;
    }
} 
```

两个 viewController viewDidLoad 方法都在方法开始时调用 super 。

正如我之前所说，如果我只是点击其他选项卡然后回到这个选项卡，“Partidos Activos En Fecha”视图控制器的滑回动画按预期工作，只有当我启动应用程序并直接转到这个视图控制器时滑回动画不起作用，它只是在没有动画的情况下到达调用者 viewController。

希望我添加了足够的信息，如果不只是告诉我，我会再次添加。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-07T21:39:56.567

我终于找到了问题所在，我错过了方法中的调用，`super`但是`viewDidAppear`在`UITabBarController`！中，我只检查`viewControllers`选项卡而不是`tabbarviewcontroller`. @rdelmar 是对的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-30T08:15:34.203

我有同样的问题。我的原因是我的 UITabBarController 中的一个空`viewDidAppear:animated`方法。删除该方法后，动画再次正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T02:00:41.417

我想[这](https://stackoverflow.com/questions/15400827/how-to-handle-uinavigationcontrollers-and-uitabbarcontrollers-ios-6-1)就是你想要的。如果我理解，您的问题是处理导航控制器的堆栈，对吗？所以，检查那个链接。

# facebook - 在非 webview 客户端上是否有任何首选的登录方式

> ID：15844276
> 
> 赞同：1
> 
> 时间：2013-04-05T21:55:44.870
> 
> 标签：facebook, rest, login, legacy

我有一个智能电视应用程序，不能使用外登录方法。可以使用 Legacy REST API 登录吗？还有其他首选方式吗？旧版 REST API 将支持多长时间？

# css - 下划线不会出现在锚点悬停上，即使它在 CSS 中

> ID：15844278
> 
> 赞同：0
> 
> 时间：2013-04-05T21:55:49.810
> 
> 标签：css

出于某种原因，当我将鼠标悬停在#navigationText 中的锚点上时，只有光标变为指针，但 text-decoration:underline 没有生效。

知道为什么会发生这种情况以及如何解决吗？

我的CSS说：

```
#navigationText a:hover{
    cursor:pointer;
    text-decoration:underline;
} 
```

这是未发生的页面的实时链接：[https ://dl.dropbox.com/u/270523/help/initializr/index.html](https://dl.dropbox.com/u/270523/help/initializr/index.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:17:51.943

我发现即使没有出现下划线，底部边框也会悬停。

因此，如果我将悬停 css 更改为：

```
#navigationText a:hover{
    border-bottom:1px solid #000;
} 
```

这是不一样的，但它是一个类似的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:26:56.247

尝试将字体系列设置为更通用/默认的字体。当我切换 font-family:'Trend'; 通过 Chrome Dev Tools 在 main.css 的第 95 行，下划线显示在悬停时。

我不确定为什么会这样，但我认为这会解决问题。

# matlab - 如何使用 matlab 的 filter 函数来计算滤波器的脉冲响应样本？

> ID：15844279
> 
> 赞同：1
> 
> 时间：2013-04-05T21:55:53.327
> 
> 标签：matlab, filter, sample

到目前为止，我有以下代码：

```
[b,a] = ellip(4,.2,40,[.41 .47]); //elliptical filter
[H,w] = freqz(b,a,4096); 
```

我需要弄清楚如何计算滤波器脉冲响应的 4096 个样本。我不知道怎么做。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:07:24.473

你有`b`和`a`，所以你可以`filter`得到脉冲响应：

```
imp = [1, zeros(1, 4095)]
h = filter(b, a, imp); 
```

对于您的示例，`plot(h)`应该产生如下内容：

![在此处输入图像描述](https://i.stack.imgur.com/z1Elx.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:53:34.783

```
[h,t] = impz(b,a, 4096) 
```

使用[impz() 函数](http://www.mathworks.com/help/signal/ref/impz.html)，h 是数据，t 是样本数。

# php - 从页面中删除选中的元素

> ID：15844281
> 
> 赞同：0
> 
> 时间：2013-04-05T21:55:56.637
> 
> 标签：php, jquery

我有这个通过 jquery.form 插件发送帖子的脚本：

```
$(document).ready(function() { 
        $('#submit_btn').on('click', function(e)            { 
            $("#preview").html('');
            $("#preview").html('<img src="loader.gif" alt="Uploading...."/>');
        $("#imageform").ajaxForm({
        target: '#preview',
        success:  afterSuccess //call function after 
        }); 
    });
});        
function afterSuccess()
{
$('#imageform').resetForm();
$('.ImgStatus').appendTo('.img');
} 
```

并得到一个 html 响应。

```
<div id="<?php echo $RandNumber; ?>" class="ImgStatus">
<input id="<?php echo $RandNumber; ?>" type="checkbox" name="<?php echo $RandNumber; ?>" />                              
<img src='upload/<?php echo $actual_image_name; ?>' class='preview'>
</div> 
```

我要做的是在单击删除按钮时删除与复选框 ID 对应的 div。并且还将 $_POST 发送到带有已检查 div 的 php 页面。直到现在我有这样的东西但是当我按下按钮时它并没有删除元素......

```
$("#clickme").click(function(e){    
var selected = $(".img input:checked").map(function(i,el){return el.name;}).get();   
$(selected).remove();      
}); 
```

jsfiddle.net/aHr6v/3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:16:59.987

您可以简单地选择所选输入字段（div）的父级，然后像这样删除它：

```
$("#clickme").click(function(e){  
    var selected = $(".img input:checked").parent();
    $(selected).remove();
}); 
```

这是一个工作示例：http: [//jsfiddle.net/aHr6v/5/](http://jsfiddle.net/aHr6v/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:17:05.130

检查这个：http: [//jsfiddle.net/aHr6v/6/](http://jsfiddle.net/aHr6v/6/)

根据您在评论中所说的，我添加了以下行，通过 id 搜索 div 并将其删除

```
$("div#"+selected).remove(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T22:17:16.217

我建议：

```
$("#clickme").click(function (e) {
    $('div.img input:checked').closest('div').remove();
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/aHr6v/8/)。

这会查看所有被检查的输入，找到最接近的父祖先，`div`然后从 DOM 中删除那个/那些元素。

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`remove()`](http://api.jquery.com/remove/).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T22:17:49.953

`selected`是一个数组。您要做的是将该数组的一个或多个元素作为选择器传递：

```
$.each(selector, function(){
    $('#' + this).remove();
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T22:17:23.600

只是改变

```
$(selected).remove(); 
```

到

```
$('#'+selected).remove(); 
```

**编辑：**或至（删除所有选定的 div）

```
$.each(selected, function(){
    $('#' + this).remove();
}); 
```

# php - PHP - 如何按订单搜索文件夹图像

> ID：15844285
> 
> 赞同：1
> 
> 时间：2013-04-05T21:56:11.920
> 
> 标签：php, search, directory

我有以下代码在文件夹 /images/ 中搜索图像并回显它们。但是，每次我刷新页面时，它都会以随机顺序显示图像。图像被命名为 1、2、3、4 等等。有什么办法可以让最后一个数字（例如：4）是第一个显示的数字，依此类推？

```
<?php
    $dirname = "images";
    $images = scandir($dirname);
    shuffle($images);
    $ignore = Array(".", "..");
    foreach($images as $curimg){
        if(!in_array($curimg, $ignore)) {
            echo "<img src=\"". $dirname . '/' . $curimg ."\">" ;
        }
    }               
?> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T21:58:53.563

这是由于你的洗牌。你正在随机化你的数组。让我向您介绍： http: [//php.net/manual/en/function.array-reverse.php](http://php.net/manual/en/function.array-reverse.php) 这是

```
<?php
    $dirname = "images";
    $images = scandir($dirname);
    $images = arsort(array_reverse($images, true));
    $ignore = Array(".", "..");
    foreach($images as $curimg){
        if(!in_array($curimg, $ignore)) {
            echo "<img src=\"". $dirname . '/' . $curimg ."\">" ;
        }
    }               
?> 
```

* * *

**更新**：

```
$dirname = "Images";
$images = scandir($dirname);
sort($images,SORT_NUMERIC);
krsort($images);
$ignore = Array(".", "..");
foreach($images as $curimg){
    if(!in_array($curimg, $ignore)) {
        echo "<img src=\"". $dirname . '/' . $curimg ."\"> \n" ;
    }
} 
```

我一直在使用的东西：

没有`sort();`and`krsort();`我返回：

```
<img src="Images/1.png"> 
<img src="Images/10.png"> 
<img src="Images/11.png"> 
<img src="Images/2.png"> 
<img src="Images/3.png"> 
<img src="Images/4.png"> 
<img src="Images/5.png"> 
<img src="Images/6.png"> 
<img src="Images/7.png"> 
<img src="Images/8.png"> 
<img src="Images/9.png"> 
```

使用 krsort 和 sort.. 我返回：

```
<img src="Images/11.png"> 
<img src="Images/10.png"> 
<img src="Images/9.png"> 
<img src="Images/8.png"> 
<img src="Images/7.png"> 
<img src="Images/6.png"> 
<img src="Images/5.png"> 
<img src="Images/4.png"> 
<img src="Images/3.png"> 
<img src="Images/2.png"> 
<img src="Images/1.png"> 
```

我想这就是你要找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T21:58:23.000

[http://www.php.net/manual/en/function.array-reverse.php](http://www.php.net/manual/en/function.array-reverse.php)

应该是正确的功能而不是随机播放

更新：

更好的是直接通过scandir对其进行排序：

```
$images = scandir($dirname, SCANDIR_SORT_DESCENDING); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T21:59:21.697

您可以尝试将图像名称加载到数组中，而不是排序数组然后回显图像标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T22:16:32.920

```
<?php

$dirname = "images";
$files = scandir($dirname, 1); // using SCANDIR_SORT_DESCENDING PHP 5.4+ ONLY!
foreach ($files as $file) {
 if ($file !== '.' && $file !== '..') {
     echo "<img src=\"". $dirname . '/' . $file ."\">" ;
}
}
?> 
```

# javascript - jQuery - 如果用户选择了下拉项目，则删除它

> ID：15844288
> 
> 赞同：3
> 
> 时间：2013-04-05T21:56:43.697
> 
> 标签：javascript, jquery

我有 4 个下拉列表，其中包含从数据库中获取的下拉列表中的团队列表。我已将下拉列表的代码放在下面，我很抱歉它是用 JADE 的 HTML 模板引擎编写的，但这就是我编写代码的方式。我也把我当前的 jQuery 脚本放在了下面。

目前，它有点工作，如果我从团队 1 到团队 4 并选择一个团队，那么它就可以工作，但如果我改变了对其中一个下拉菜单的想法......那么整个列表就会混乱它已经删除了某些项目...

如果我进入 team1 中的一个团队，它应该从列表的其余部分中消失....但是如果我更改团队 1，该团队应该再次出现在列表的其余部分中，但目前没有。

任何想法如何解决这一问题？

JADE 下拉菜单：

```
div.row
    label.control-label(for="team1") Team 1:
    div.controls
        select#team1(style='width: 160px;')
            include teamsDropDown
div.row
    label.control-label(for="team2") Team 2:
    div.controls
        select#team2(style='width: 160px;')
            include teamsDropDown
div.row
    label.control-label(for="team3") Team 3:
        div.controls
            select#team3(style='width: 160px;')
                include teamsDropDown
div.row
        label.control-label(for="team4") Team 4:
            div.controls
                select#team4(style='width: 160px;')
                    include teamsDropDown 
```

团队下拉玉：

```
-if(teamsList.length > 0){
    option
    -each team in teamsList
    option.teamDropDown(id="#{team.key}",value="#{team.key}") #{team.name}
-}else{
    No teams till now..
-} 
```

jQuery脚本：

```
script(type='text/javascript')
$('select').change(function() {
 $('select').not(this).children('option[value=' + $(this).val() + ']').remove();
}); 
```

小提琴：

[http://jsfiddle.net/m8QCZ/](http://jsfiddle.net/m8QCZ/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:06:42.880

也许这可以满足您的需求：

[看演示](http://jsfiddle.net/m8QCZ/50/)

```
var $selects = $('select');
$('select').change(function () {
    $('option:hidden', $selects).each(function () {
        var self = this,
            toShow = true;
        $selects.not($(this).parent()).each(function () {
            if (self.value == this.value) toShow = false;
        })
        if (toShow) $(this).show();
    });
    if (this.value != 0) //to keep default option available
      $selects.not(this).children('option[value=' + this.value + ']').hide();
}); 
```

# selenium - Selenium IDE：没有 ID 的单击命令

> ID：15844290
> 
> 赞同：0
> 
> 时间：2013-04-05T21:56:43.760
> 
> 标签：selenium, automation, click

如何对没有“id”的按钮执行点击操作。

```
<a class="ui-button altbuttonfix" onclick="mojarra.jsfcljs(document.getElementById('productionreporttoolbar-productionReportToolBarForm'),{'productionreporttoolbar-productionReportToolBarForm-j_idt43':'productionreporttoolbar-productionReportToolBarForm-j_idt43','userId':'11448','reportName':'','statementName':'productionReport.productionReport','token':'','productionReportId':'1000274'},'report');return false" style="" href="#">
      View 
```

它是一种`class`类型。任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T15:41:22.920

为什么不只使用类值？我一直用它作为定位器：

```
Webdriver driver = new FirefoxDriver();
WebElement e = driver.findElement(By.className("ui-button altbuttonfix"));
e.click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-22T00:34:41.273

在这种情况下，您可以使用该类来识别此按钮

```
css=a.ui-button.altbuttonfix 
```

# c# - 迁移到 C# 后 AjaxAutoComplete 不起作用

> ID：15844292
> 
> 赞同：1
> 
> 时间：2013-04-05T21:56:53.627
> 
> 标签：c#, asp.net-ajax, autocompleteextender

我的自动完成功能在使用旧网站时工作正常，但在移植到 C# 和实体框架时无法正常工作。下面的 HTML 是用户控件的一部分。我已经在 web 服务代码中放置了断点，它甚至看起来都没有被调用。我不知道在哪里可以查看休息时间。任何帮助，将不胜感激。谢谢。

```
<asp:ScriptManagerProxy ID="ScriptManagerProxy1" runat="server">
</asp:ScriptManagerProxy>
                         <asp:TextBox ID="TextBoxDamName" runat="server" Columns="50"></asp:TextBox>
                    <asp:AutoCompleteExtender ID="TextBoxDamName_AutoCompleteExtender"
                        runat="server"
                        DelimiterCharacters="" 
                        Enabled="True" 
                        ServicePath="DamSafetyAutoComplete.asmx"
                        ServiceMethod="SelectDamNames" 
                        FirstRowSelected="True" 
                        MinimumPrefixLength="1" 
                        CompletionInterval="200"
                        TargetControlID="TextBoxDamName">
                    </asp:AutoCompleteExtender></td>

namespace ExternalDamSafetySearch
{
    /// <summary>
    /// Summary description for DamSafetyAutoComplete
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class DamSafetyAutoComplete : System.Web.Services.WebService
    {
        [WebMethod]
        [System.Web.Script.Services.ScriptMethod]
        public string[] SelectDamNames(string prefixText, Int32 count)
        {
            try
            {
                EnterprisePubEntities EE = new EnterprisePubEntities();

                return EE.DamSafetyDatas
                    .Take(count)
                    .Where(c => c.DamName.StartsWith(prefixText))
                    .Distinct()
                    .OrderBy(c => c.DamName)
                    .Select(c => c.DamName)
                    .ToArray();
            }
            catch (Exception) { throw; }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T16:16:10.040

事实证明，我没有将控件指向我的 Web 服务文件的正确位置。一旦我修复了我仍然没有得到结果，即使我在 web 服务中点击了该方法。原来我没有正确返回结果。我通过转动这个来修复它

```
 return EE.DamSafetyDatas
                .Take(count)
                .Where(c => c.DamName.StartsWith(prefixText))
                .Distinct()
                .OrderBy(c => c.DamName)
                .Select(c => c.DamName)
                .ToArray(); 
```

到

```
 return EE.DamSafetyDatas
                 .Where(c => c.DamName.StartsWith(prefixText))
                .Distinct().Take(count)
                .OrderBy(c => c.DamName)
                .Select(c => c.DamName)
                .ToList.ToArray(); 
```

我还必须更改 .Take(count) 的位置，因为它会从列表中获取第一个（count = 10）然后按开头过滤它们。

# php - 在 PHP 中检测正确的字符编码？

> ID：15844295
> 
> 赞同：5
> 
> 时间：2013-04-05T21:57:10.507
> 
> 标签：php, character-encoding, detection, multibyte

我正在尝试检测字符串的字符编码，但无法得到正确的结果。
例如：

```
$str = "&euro; &sbquo; &fnof; &bdquo; &hellip;" ;
$str = mb_convert_encoding($str, 'Windows-1252' ,'HTML-ENTITIES') ;
// Now $str should be a Windows-1252-encoded string.
// Let's detect its encoding:
echo mb_detect_encoding($str,'Windows-1252, ISO-8859-1, UTF-8') ; 
```

该代码输出`ISO-8859-1`但它应该是`Windows-1252`.

这有什么问题？

**编辑：**
更新示例，以响应@raina77ow。

```
$str = "&euro;&sbquo;&fnof;&bdquo;&hellip;" ; // no white-spaces
$str = mb_convert_encoding($str, 'Windows-1252' ,'HTML-ENTITIES') ;
$str = "Hello $str" ; // let's add some ascii characters
echo mb_detect_encoding($str,'Windows-1252, ISO-8859-1, UTF-8') ; 
```

我再次得到错误的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-23T13:46:37.333

PHP 中 Windows-1252 的问题在于它几乎*永远不会*被检测到，因为一旦您的文本包含 0x80 到 0x9f 之外的任何字符，它就不会被检测为 Windows-1252。

这意味着如果您的字符串包含一个普通的 ASCII 字母，例如“A”，甚至是一个空格字符，PHP 会说这不是有效的 Windows-1252，并且在您的情况下，回退到下一个可能的编码，即 ISO 8859-1。这是一个 PHP 错误，请参阅[https://bugs.php.net/bug.php?id=64667](https://bugs.php.net/bug.php?id=64667)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:01:28.257

尽管使用 ISO-8859-1 和 CP-1252 编码的字符串具有不同的字节码表示：

```
<?php
$str = "&euro; &sbquo; &fnof; &bdquo; &hellip;" ;
foreach (array('Windows-1252', 'ISO-8859-1') as $encoding)
{
    $new = mb_convert_encoding($str, $encoding, 'HTML-ENTITIES');
    printf('%15s: %s detected: %10s explicitly: %10s',
        $encoding,
        implode('', array_map(function($x) { return dechex(ord($x)); }, str_split($new))),
        mb_detect_encoding($new),
        mb_detect_encoding($new, array('ISO-8859-1', 'Windows-1252'))
    );
    echo PHP_EOL;
} 
```

结果：

```
Windows-1252: 802082208320842085 detected:            explicitly: ISO-8859-1
  ISO-8859-1: 3f203f203f203f203f detected:      ASCII explicitly: ISO-8859-1 
```

...从我们在这里可以看到， . 的第二个参数似乎存在问题`mb_detect_encoding`。使用`mb_detect_order`代替参数会产生非常相似的结果。

# kinect - 尝试在 OpenNI 中编译 Nite2 示例

> ID：15844296
> 
> 赞同：0
> 
> 时间：2013-04-05T21:57:18.120
> 
> 标签：kinect, openni

我是 Kinect SDK 的新手，因此我请求您帮助解决这个问题：

> 1>----- 构建开始：项目：UserViewer，配置：Debug Win32 ------
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_oniInitialize*在函数“public：static enum openni::Status __cdecl openni::OpenNI::initialize(void)”(?initialize@OpenNI@openni@@SA? AW4状态@2@XZ)
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_oniShutdown*在函数“public: static void __cdecl openni::OpenNI::shutdown(void)”(?shutdown@OpenNI@openni@@SAXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_oniGetExtendedError*在函数“public: static char const * __cdecl openni::OpenNI::getExtendedError(void)”(?getExtendedError@OpenNI@openni@@SAPBDXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号_imp *_oniDeviceOpen*在函数“public：enum openni::Status __thiscall openni::Device::open(char const *)”中引用（？open@Device@openni@@QAE ?AW4Status@2@PBD@Z)
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号 _ *imp* _oniDeviceClose 在函数“public: void __thiscall openni::Device::close(void)”(?close@Device@openni@@QAEXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_oniDeviceGetInfo*在函数“private: enum openni::Status __thiscall openni::Device::_setHandle(struct _OniDevice *)”(?_setHandle@Device@openni@@AAE ?AW4Status@2@PAU_OniDevice@@@Z)
> 
> 1>Viewer.obj : 错误 LNK2019: 无法解析的外部符号 _ *imp* _oniDeviceIsPropertySupported 在函数“public: bool __thiscall openni::Device::isPropertySupported(int)const” (?isPropertySupported@Device@openni@@QBE_NH@Z) 中引用
> 
> 1>Viewer.obj : 错误 LNK2019: 无法解析的外部符号 _ *imp* _oniDeviceIsCommandSupported 在函数“public: bool __thiscall openni::Device::isCommandSupported(int)const” (?isCommandSupported@Device@openni@@QBE_NH@Z) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_oniFrameAddRef*在函数“public：void __thiscall openni::VideoFrameRef::_setFrame(struct OniFrame *)”(?_setFrame@VideoFrameRef@openni@@QAEXPAUOniFrame@@@Z )
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号_imp *_oniFrameRelease*在函数“public: void __thiscall openni::VideoFrameRef::release(void)”(?release@VideoFrameRef@openni@@QAEXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteInitialize*在函数“public：静态枚举 nite::Status __cdecl nite::NiTE::initialize(void)”中引用 (?initialize@NiTE@nite@@SA? AW4状态@2@XZ)
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteShutdown*在函数“public: static void __cdecl nite::NiTE::shutdown(void)”(?shutdown@NiTE@nite@@SAXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteInitializeUserTracker*在函数“public：enum nite::Status __thiscall nite::UserTracker::create(class openni::Device *)”中引用（？create@UserTracker@nite @@QAE?AW4Status@2@PAVDevice@openni@@@Z)
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteInitializeUserTrackerByDevice*在函数“public: enum nite::Status __thiscall nite::UserTracker::create(class openni::Device *)”中引用 (?create@UserTracker@nite @@QAE?AW4Status@2@PAVDevice@openni@@@Z)
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号_imp *_niteShutdownUserTracker*在函数“public：void __thiscall nite::UserTracker::destroy(void)”(?destroy@UserTracker@nite@@QAEXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteStartSkeletonTracking*在函数“public: enum nite::Status __thiscall nite::UserTracker::startSkeletonTracking(short)”中引用 (?startSkeletonTracking@UserTracker@nite@@QAE?AW4Status @2@F@Z)
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteStartPoseDetection*在函数“public: enum nite::Status __thiscall nite::UserTracker::startPoseDetection(short,enum nite::PoseType)”(?startPoseDetection@UserTracker@ nite@@QAE?AW4Status@2@FW4PoseType@2@@Z)
> 
> 1>Viewer.obj：错误 LNK2019：无法解析的外部符号_imp *_niteReadUserTrackerFrame*在函数“public: enum nite::Status __thiscall nite::UserTracker::readFrame(class nite::UserTrackerFrameRef *)”(?readFrame@UserTracker@nite @@QAE?AW4Status@2@PAVUserTrackerFrameRef@2@@Z)
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号_imp *_niteUserTrackerFrameRelease*在函数“public：void __thiscall nite::UserTrackerFrameRef::release(void)”(?release@UserTrackerFrameRef@nite@@QAEXXZ) 中引用
> 
> 1>Viewer.obj：错误 LNK2019：未解析的外部符号 _ *imp* _niteConvertJointCoordinatesToDepth 在函数“public: enum nite::Status __thiscall nite::UserTracker::convertJointCoordinatesToDepth(float,float,float,float *,float *)const 中引用?convertJointCoordinatesToDepth@UserTracker@nite@@QBE?AW4Status@2@MMMPAM0@Z)
> 
> 1>C:\Program Files\PrimeSense\NiTE2\Samples\UserViewer..\Bin\UserViewer.exe : 致命错误 LNK1120: 20 unresolved externals
> 
> ========== 构建：0 成功，1 失败，0 最新，0 跳过 ==========

我正在使用 OpenNI2 和 Nite2 并尝试编译其中一个 Nite2 示例项目。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-15T18:47:54.917

OpenNI2不支持Kinect，据我所知，也许你可以尝试使用旧的OpenNI，至少这是我学到的，在尝试相同之后，但我不知道在windows下，我使用的是GNU/ubuntu。

# objective-c - NSPopupButton 默认状态和绑定

> ID：15844297
> 
> 赞同：1
> 
> 时间：2013-04-05T21:57:19.107
> 
> 标签：objective-c, macos, cocoa, nspopupbutton

我有一个 NSPopupButton 绑定到一个数组控制器的内容/值，我确实将它绑定到视图控制器中的一个属性..一切都工作得很好。然后我需要为共享用户默认值中的弹出窗口设置一个默认值。这就是一切都出错的地方！如果我将“选定值”更改为具有我的用户默认的模型键路径.. 删除绑定到我的本地属性。并且还更改了我不想要的默认值（我在“首选项”窗口中执行此操作）。

现在我用代码绕过它，通过 NSString 从弹出窗口中查找所需的 mnaged 对象，如下所示：[[_qualifierPopup selectedCell] title] ...但这非常笨拙！

所以两个问题：

1.  我可以通过共享用户默认设置 NSPopupbutton 的默认状态 - 如果是这样，如何？
2.  考虑到在弹出窗口绑定到用户默认值之前，它已绑定到返回正确托管对象的 id 类型的属性，我可以从弹出窗口中检索相同的 id 而不是字符串并对该字符串进行查找吗？如果是这样，有人可以帮助我了解语法。

谢谢伊恩

# cakephp - Cake PHP 验证，更改传入的 $data

> ID：15844300
> 
> 赞同：0
> 
> 时间：2013-04-05T21:57:41.170
> 
> 标签：cakephp, variables, validation, cakephp-2.1

我的蛋糕验证有问题。用户在表单字段中输入例如“20 欧元”，我只想得到去掉欧元符号的数字“20”。但是验证方法只允许检查某事是否是它应该是的。

我即将在我的规则集中创建一个函数，但我正在努力走得更远，因为该函数在蛋糕上下文中返回的是真或假，而不是像我需要的修改后的变量......

```
'rule-3' => array(
    'rule'    => 'checkEuro',
    'message' => 'don´t need one because it should be a conversion only :-('
)

public function checkEuro($data) {
    $data = str_replace('&#8364;','',$data);
    return preg_replace('/[^0-9]/','', html_entity_decode($data));
} 
```

我希望你能帮忙。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:15:46.803

如果您只需要将*金额*本身存储在数据库中而*不是*欧元符号，您应该在验证之前去掉欧元符号*。*

您可以在[`beforeValidate()`](http://book.cakephp.org/2.0/en/models/callback-methods.html#beforevalidate)模型的回调中执行此操作；

```
public function beforeValidate(array $options = array())
{
    if (!empty($this->data[$this->alias]['FIELDNAME']) {
        // Strip the euro-sign
        // NOTE: should also take plain, non-entity € into account here?
        $this->data[$this->alias]['FIELDNAME'] = str_replace(
            '&#8364;', '', $this->data[$this->alias]['FIELDNAME']
        );
    }

    return parent::beforeValidate($options);
} 
```

（当然，替换`FIELDNAME`为实际的字段名）

剥离货币符号后，使用[`decimal`](http://book.cakephp.org/2.0/en/models/data-validation.html#Validation%3a%3adecimal)or[`numeric`](http://book.cakephp.org/2.0/en/models/data-validation.html#Validation%3a%3anumeric)验证规则验证值

**note** 如果您*确实*要存储*包含*货币符号的值，请使用核心[`money`](http://book.cakephp.org/2.0/en/models/data-validation.html#Validation%3a%3amoney)验证规则。

# mongodb - MongoDB Schema Design（嵌套数组 vs 单独集合）

> ID：15844301
> 
> 赞同：3
> 
> 时间：2013-04-05T21:57:41.087
> 
> 标签：mongodb, database-schema, mongodb-php, schema-design

我正在编写客户端管理 Web 应用程序。我正在尝试找出管理客户付款关系的正确方法。每天一次，应用程序向另一个 API 发送请求，并为我存储在数据库中的每个客户同步付款金额。我经常需要根据客户类型（合同类型、销售日期等）运行付款报告（付款金额）。我已经有`clients`收藏了。我试图在两种模式之间进行选择：

```
{
      "client_id": "asdf123",
      "client_last_name": "BB",
      "address": "123 Main St",
      "city": "ATLANTA",
      "payments_history": [
        {
          "contract_number": "asdf123",
          "payment_date": ISODate("2012-09-02T07:00:00.0Z"),
          "amount": 103.33,
          "payment_number": NumberInt(1)
        },
        {
          "contract_number": "asdf123",
          "payment_date": ISODate("2012-09-30T07:00:00.0Z"),
          "amount": 103.33,
          "payment_number": NumberInt(2)
        },
        {
          "contract_number": "asdf123",
          "payment_date": ISODate("2012-11-04T07:00:00.0Z"),
          "amount": 103.33,
          "payment_number": NumberInt(3)
        }
      ]
  } 
```

与创建单独的集合“ `payments`”相比，其中每个文档都是`payment`. 我觉得最好将这些数据分开，因为`client`每次查询都会将每个文档增长为大量数据（如果我选择特定字段，这仍然会占用大量内存）。但另一方面，我将无法运行聚合报告（因为它基于来自两个不同集合的数据）。最好的方法是什么？我应该将它们分开并在服务器端（php）上使用两个不同的查询进行聚合吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:35:16.780

由于听起来您实际上需要在客户端上下文之外查询支付数据（即，用于汇总报告），所以我不想将每个单独的支付项目添加到客户端集合对象中。

我当然会创建一个支付对象集合，然后在每个支付的客户端对象中引用一个支付密钥，在支付对象中引用一个客户端密钥，这样你就有一个明确的方法来将一个方向与另一个方向关联起来，或者有第三个集合将客户映射到付款。

这里更可取的可能真的取决于您的访问模式。例如，如果在需要建立关系的情况下查找总是在一个方向上，那么您甚至可能不需要在两组对象上都使用这样的“外键”。

# android - android中的admob网络集成

> ID：15844304
> 
> 赞同：0
> 
> 时间：2013-04-05T21:57:59.600
> 
> 标签：android, admob, mobfox

目前有 9k 印象和 0.06 美元 ecpm 的 Admob，所以我想使用 MobFox 作为备份。所以我在 MobFox 注册了一个帐户，并使用 MobFox 发布者 ID 使用 Admob 设置中介。我需要在我的应用程序中安装任何 SDK 更新并重新发布它还是只需要 Admob sdk ？我在 MobFox 中收到 0 个请求，那是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T01:47:28.707

检查 LogCat 以了解错误原因。很可能是因为您需要在项目中包含 MobFox [SDK 和适配器](https://developers.google.com/mobile-ads-sdk/ad-network-mediation)库。

# pdf - ruby on rails with gem pdf-reader：未初始化的常量错误

> ID：15844311
> 
> 赞同：0
> 
> 时间：2013-04-05T21:58:32.497
> 
> 标签：pdf, ruby-on-rails-3.1, rubygems, gem

我在尝试使用 pdf-reader(V1.3.2) 进入 PDF unsing ruby​​ on rails (ruby V1.9.3) 时遇到了困难。我基本上认为这是一个错误：

未初始化的常量 PDF::READER

我找到了一些问题的答案，例如： [ruby​​ install yob pdf reader](https://stackoverflow.com/questions/7384723/ruby-install-yob-pdf-reader) 但没有真正解决它。gem 已安装并在 gemfile 和 bundle-command 答案中

这是图书馆： [https ://github.com/yob/pdf-reader](https://github.com/yob/pdf-reader)

这是我的代码：

```
class UploadController < ApplicationController
require 'rubygems'
require 'pdf/reader'

def index
    render :file => 'app\views\upload\uploadfile.html.erb'
    reader = PDF::READER.new("hello.pdf")
            @pagenumbers = reader.page_count
end
def uploadFile
    @uploaded = false
    if post = Datafile.save(params[:upload])
        #render :text =>"File saved!"
        @uploaded = true

        index
else render :text =>"file not saved!"
end
end
def error_file
    render :text => "error"
    end
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T15:30:18.607

解决了！愚蠢的错字！PDF::阅读器 --> PDF::阅读器

# javascript - Javascript字符串连接

> ID：15844313
> 
> 赞同：0
> 
> 时间：2013-04-05T21:58:46.160
> 
> 标签：javascript, twitter-bootstrap, popover

我有字符串连接的问题。我正在进行一系列 ajax 调用，并根据结果构建一个表，其中每个元素都有一个引导弹出框字段。在这个领域，我想展示更多的细节。这是代码：

```
...initiate ajax post ...
... other parameters...
function(data){//function called on success
        var popoverContent = 'Sent: ';
        popoverContent = popoverContent.concat(JSON.stringify(obj.value));
        popoverContent = popoverContent.concat('\nReceived: ');
        popoverContent = popoverContent.concat(JSON.stringify(data.error));
        console.log(popoverContent);

... other processing ...
...building table...

'<td> <a class="btn large primary" rel="popover" data-content='+popoverContent+' data-original-title="Detailed description">'+outcome+'</a></td>'+ ...

...rest of the code ... 
```

现在我的问题是，虽然在控制台中 popoverContent 具有我想要以字符串形式显示的所有数据，但在弹出窗口中只有 Sent: 被显示。如果我使 popoverContent 等于任何其他连接的部分，它会显示该部分，但它不会显示整个内容。我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:01:40.153

`console.log`您可以使用通常更易于阅读的 += 运算符（尽管不是必需的），而不是调用之前的内容，如下所示：

```
var popoverContent = 'Sent: ';
popoverContent += JSON.stringify(obj.value);
popoverContent += '\nReceived: ';
popoverContent += JSON.stringify(data.error); 
```

然而，真正的问题在于您的实际 HTML 输出。你没有用“s”包围结果。事实上，它也需要被转义。像：

```
... '<td>' +
  '<a class="btn large primary" rel="popover" data-content="' +
      popoverContent.replace(/&/g, '&amp;').replace(/"/g, '&quot;')
     .replace(/\n/g, '<br/>') +
    '" data-original-title="Detailed description">' +
    outcome +
  '</a>' +
'</td> + ... 
```

# c# - 尝试更新 SQL Server 数据库中的值

> ID：15844319
> 
> 赞同：1
> 
> 时间：2013-04-05T21:59:09.737
> 
> 标签：c#, sql, sql-server

目前我在更新 SQL Server 数据库中的值时遇到问题。

我正在做一个项目，该项目将学生姓名、出生日期和性别存储在数据库中，并且能够通过 Windows 窗体进行编辑和更新。到目前为止浏览数据工作正常，但是当表单上的值发生更改并单击更新按钮时，程序会崩溃并显示

> NullReferenceException 未处理。你调用的对象是空的。

错误，我目前不知道是什么原因造成的。

目前我有一个`DBConnector`类，它打开与数据库和数据集的连接并将其传递给包含文本框的 Windows 窗体以显示值和导航按钮以浏览数据。（下面是类和windows窗体的代码，我希望能比我解释得更好）。

`DBConnector.cs`班级_

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;

namespace StudentRecords
{
    public class DBConnector
    {
        //Properties
        //connection object
        private System.Data.SqlClient.SqlConnection Conn;

        //dataset object
        private StudentsDataSet Ds1;
        //dataadapter object
        private System.Data.SqlClient.SqlDataAdapter Da;

        //constructors
        public DBConnector()
        {
            //call initialisation
            init();
        }

        //Methods
        //initialisation method
        public void init()
        {
            //create the memory space for the connection object
            Conn = new System.Data.SqlClient.SqlConnection();
            //create the memory space for the dataset
            Ds1 = new StudentsDataSet();

            //set the connection string to the location of our database file
            Conn.ConnectionString = @"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Students.mdf;Integrated Security=True;User Instance=True";

            //open the conenction
            Conn.Open();

            //create a query to get all the records from the table
            string query = "SELECT * from Studentstbl";
            //create the data adapter for the database
            Da = new System.Data.SqlClient.SqlDataAdapter(query, Conn);
            //use it to fill the dataset as the first parameter the second is a name for the table we use later on
            Da.Fill(Ds1, "Students");

            //close the connection
            Conn.Close();
            System.Windows.Forms.MessageBox.Show("Database connection Open", "Success");
        }

        public StudentsDataSet DBDataSet
        {
            get
            {
                return Ds1;
            }
        }

        //update method

        public void UpdateDB(DataSet ds, string table)
        {
            //create a command builder to reconnect to the database
            System.Data.SqlClient.SqlCommandBuilder cb;
            //set the comamnd builder to be our existing dataadapter
            cb = new System.Data.SqlClient.SqlCommandBuilder(Da);
            Da.Update(ds, table);
        }
    }
} 
```

Windows`studentdetails.cs`窗体

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace StudentRecords
{
    public partial class studentdetails : Form
    {
        DataSet StudentDataSet;
        //set variables for limit
        int Limit = 0;
        int current = 0;

        public studentdetails()
        {
            InitializeComponent();
        }

        public studentdetails(DataSet ds)
            : this()
        {
            StudentDataSet = ds;
            //set the limit of records we can navigate
            Limit = StudentDataSet.Tables["Students"].Rows.Count;

            NavigateRecords();
        }

       public studentdetails(DBConnector db) : this()
       { }

        public studentdetails(DBConnector db, int sRow) : this(db)
        {
            current = sRow;
            NavigateRecords();
            //turn on editing
            plEdit.Visible = true;
            //set our local dataset object to point to the passed in one
            DBConnection = db;
            StudentDataSet = db.DBDataSet;
            Limit = StudentDataSet.Tables["Students"].Rows.Count;
            NavigateRecords();
        }

        //navigate records function to move through the records
        public void NavigateRecords()
        {   //create a datarow object and set it to be the first row in the dataset
            DataRow dRow = StudentDataSet.Tables["Students"].Rows[current];
            //set the form text to add the current record number
            this.Text += " for record " + dRow.ItemArray.GetValue(0).ToString();
            //fill the text boxes with the database values
            txtFirstName.Text = dRow.ItemArray.GetValue(1).ToString();
            txtMiddleName.Text = dRow.ItemArray.GetValue(2).ToString();
            txtLastName.Text = dRow.ItemArray.GetValue(3).ToString();
            txtDOB.Text = dRow.ItemArray.GetValue(4).ToString();
            txtgender.Text = dRow.ItemArray.GetValue(5).ToString();
        }

        //update the label for the dtatbase
        private void UpdateCount()
        {
            txtCount.Text = (current + 1).ToString() + " of " + Limit.ToString();
        }

        private void btn_next_Click(object sender, EventArgs e)
        {
            if (current != Limit - 1)
            {
                current++;
                NavigateRecords();
            }
            else
            {
                MessageBox.Show("Last Record", "Information", 0, MessageBoxIcon.Information);
            }
        }

        private void btn_prev_Click(object sender, EventArgs e)
        {
            if (current > 0)
            {
                current--;
                NavigateRecords();
            }
            else
            {
                MessageBox.Show("First Record", "Information", 0, MessageBoxIcon.Information);
            }
        }

        private void btn_Last_Click(object sender, EventArgs e)
        {
            if (current != Limit - 1)
            {
                current = Limit - 1;
                NavigateRecords();
            }
        }

        private void btn_first_Click(object sender, EventArgs e)
        {
            if (current != 0)
            {
                current = 0;
                NavigateRecords();
            }
        }

        public DBConnector DBConnection { get; set; }

        private void btn_save_Click(object sender, EventArgs e)
        {
            {
                //create a new datarow 
                DataRow dRow = StudentDataSet.Tables["Students"].NewRow();

                //set the data to be the values from the text boxes
                dRow[1] = txtFirstName.Text;
                dRow[2] = txtMiddleName.Text;
                dRow[3] = txtLastName.Text;
                dRow[4] = txtDOB.Text;
                dRow[5] = txtgender.Text;

                //add the row to our dataset
                StudentDataSet.Tables["Studentstbl"].Rows.Add(dRow);

                //increase the limit as we have a new record
                Limit++;
                //move to the newly entered Student
                current = Limit - 1;
                DBConnection.UpdateDB(StudentDataSet, "Students");
                MessageBox.Show("Record Saved", "Information", 0, MessageBoxIcon.Information);
                NavigateRecords();
            }

        }

        private void btn_update_Click(object sender, EventArgs e)
        {
            {   //get the current row
                DataRow dRow = StudentDataSet.Tables["Students"].Rows[current];
                //set the dataset values to those in the textboxes
                dRow[1] = txtFirstName.Text;
                dRow[2] = txtMiddleName.Text;
                dRow[3] = txtLastName.Text;
                dRow[4] = txtDOB.Text;
                dRow[5] = txtgender.Text;

                //call the update method in our DB connector class
                DBConnection.UpdateDB(StudentDataSet, "Students");
                //display a message box
                MessageBox.Show("Record updated", "Information", 0, MessageBoxIcon.Information);

                NavigateRecords();
            }

        }

    }
} 
```

调用数据库`Students.mdf`和调用表`Studentstbl`，在线抛出错误：

```
DBConnection.UpdateDB(StudentDataSet, "Students"); 
```

我知道这可能是我错过的一些愚蠢的事情，但是我对 C# 编码还很陌生，所以如果是这种情况，请原谅我 :)

编辑：我还应该指出，这`studentdetails`是一个辅助表单，主表单只包含一个在其中打开该表单的按钮，它简单地包含代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace Coursework3
{
    public partial class Form1 : Form
    {
        DBConnector Students;
        public Form1()
        {
            InitializeComponent();
            //intansiate the object in memory
            Students = new DBConnector();
        }

        private void btnstudentdetails_Click(object sender, EventArgs e)
        {
            new studentdetails(Students.DBDataSet).ShowDialog();
        }
    }
} 
```

# jquery - Joomla 2.5 mootools ajax - 向组件发送参数

> ID：15844325
> 
> 赞同：0
> 
> 时间：2013-04-05T21:59:33.350
> 
> 标签：jquery, ajax, joomla

我一直在寻找几个小时来解决这个问题。我有一个带有控制器的标准组件，因此：

```
defined('_JEXEC') or die;

jimport('joomla.application.component.controller');
jimport( 'joomla.environment.request' );

class GetajaxController extends JController
{
  function test()   
   {
       $jinput = new JInput();
       $myvar = $jinput->getVar('eventname');
       print_r($_REQUEST);
       $a = $_GET['eventname'];
       $event = JRequest::getVar( 'eventname' ) ;
       $client = JRequest::getVar( 'client' ) ;   
       echo "CLIENT:".$client." EVENT:".$event."*".$myvar;
   }
} 
```

（我一直在尝试多种解决方案，这就是为什么那里有额外的废话但相关代码仍然存在）

因此，我从自定义模块中调用它：

```
$urlA = "index.php?option=com_getajax&task=test&format=raw";
$document = JFactory::getDocument();
$document->addScriptDeclaration("

    function runButton() {

       var data = 'eventname=aName&client=aClient';
       var url='$urlA';
       var request = new Request({
       url: url,
       data: data,
       method:'post',
       onSuccess: function(responseText){
         document.getElementById('xml_result').innerHTML=responseText;
       }
       }).post('eventname=foo&client=baR'); // ORIGINALLY HAD IT AS JUST .post()
       request.setHeader('eventname', 'sdfsdfsdf'); // ADDED
   }
"); 
```

返回的响应仅包含硬编码的“CLIENT: ... EVENT”减去变量。换句话说，我确实得到了响应，并且整个事情的 ajax/jquery 部分工作正常，只是我似乎无法成功地将参数发送到组件。（或者至少，在组件中检索它们）

我已经触发了它，但它们不在响应中。我什至对 url 进行了硬编码，并在控制器中使用了一个简单的 $_GET ，但没有成功；

```
$urlA = "index.php?option=com_getajax&task=test&format=raw&event=foo&client=bar"; 
```

我已经尝试过使用和不使用 sef url。您可以从控制器中看到我尝试了各种方法来捕获传递的参数。我也试过'get'和'post'。

顺便说一句，我已经尝试了所有通常发布的解决方案，所以我认为这与 joomla 以某种只有开发人员母亲才能欣赏的晦涩方式删除 url 参数有关。

*   在萤火虫中，出现了一个“x”参数，我没有发送它似乎是空的。不知道这是否重要。

任何帮助都会很棒。

在此先感谢，杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T21:14:56.897

如果有人觉得这很有用，我基本上需要将其解析为基础知识以使其正常工作。

虽然这涉及到很多试验和错误，但我还没有声称完全理解所有这些。

控制器：

```
define( '_JEXEC', 1 );

// need to get various libraries first for joomla specific controls

jimport( 'joomla.application.component.controller' );
jimport( 'joomla.environment.request' );

// we extend JController 

class GetajaxController extends JController {

  // the 'test' function will be a 'task' we can call in the url by the name 'test' 
  // (we can have many by simple defining new functions within our JController class)

    function test() {

        $app =& JFactory::getApplication();

        // get vars posted from module

        $foo = JRequest::getVar('aVar');
        $bar = JRequest::getVar('bVar');
        $result = doSomethingWithThem($foo,$bar);

        // encode result and send back. 
        // (using json encoding allows us multiple return variables. not used here.) 

        if($result) echo json_encode(array('test' => $result));

        // need to flush and close to prevent anything else but our data going back

        $app->close();
        return;
    }
}

// helper functions can be in the controller but not in the JController class

function doSomethingWithThem($foo,$bar) {
   return $foo . $bar;
} 
```

模块：

```
define('_JEXEC', 1);

// bring in mootools (which I'm not convinced is needed here, but it works so...)

JHTML::_( 'behavior.mootools' );
JHtml::_( 'behavior.framework', true );

// add jscript to rendered page

$document->addScriptDeclaration("

   // add a function to an element event (a button in this case)
   jQuery('#btgetajax').live('click', function() {

      var aVar = "Something";
      var bVar = "Something else";

      // actually call the ajax component. notice the task=test. 
      // format=raw further asks the component to only return our data

      var url='index.php?option=com_getajax&task=test&format=raw';

      // json encode the data we're sending to the controller

      var dat = {'aVar':aVar, 'bVar':bVar};

      // send it via ajax

      jQuery.ajax({

         url: url,
         method: 'post',
         data: dat,
         dataType:'json',
         success: function(data) {
            alert(data.test);
         },
         error:function(xhr, status, data) {
            alert(status);
         }

      });
   });
"); 
```

# java - 为什么在 1.5 之前的 java 版本中用 StringBuilder 替换 StringBuffer 对象是不安全的

> ID：15844328
> 
> 赞同：0
> 
> 时间：2013-04-05T21:59:51.360
> 
> 标签：java, stringbuilder, scjp, stringbuffer

晚上好，我在博客中阅读了这些声明，`it's NOT safe to replace a StringBuffer object with a StringBuilder in java version earlier than 1.5` 这似乎是事实，但没有明显的原因！！，我知道 StringBuffer 正在扩展类 java.lang.AbstractStringBuilder。StringBuilder 还扩展了 AbstractStringBuilder，因此它也继承了这些方法。所以从编译器的角度来看，您可以安全地将 StringBuffer 替换为 StringBuilder。当然 StringBuilder 是不同步的，所以如果你关心同步，你不能用字符串生成器替换字符串缓冲区，所以在我看来，同步是我们在用字符串生成器替换字符串缓冲区时唯一能想到的因素，但似乎还有另一个因素`JAVA Version`，但我不知道这些对决定有何影响，请与我讨论这些观点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:03:14.910

请参阅[http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html)

`StringBuilder`在 Java 1.5 之前不存在，因此早期的 Java 版本将无法使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T22:05:45.830

在 1.5 之前的 VM 中使用它不安全的原因是因为在 1.5`StringBuilder`之前不存在。如果您查看[JavaDoc，`StringBuilder`](http://docs.oracle.com/javase/6/docs/api/java/lang/StringBuilder.html)您会发现它仅在 1.5 之后才退出。

关于何时在 1.5+ 中使用它，您只需替换`StringBuffer`为`StringBuilder`. 如果您有多个线程写入缓冲区，则您不想这样做。但是，在大多数情况下，例如，当您只想`String`从方法中创建并返回它时`toString()`，您应该是安全的。

# matlab - ODE45 和时间间隔

> ID：15844329
> 
> 赞同：0
> 
> 时间：2013-04-05T21:59:53.860
> 
> 标签：matlab

`ODE45`matlab中的函数接受参数：

```
(function,[tinitial tfinal],yinitial) 
```

但在这里，我相信，时间跨度是预先确定的。如何为它分配一个向量？我的意思是如何解决域的 ODE 问题`1:0.1:5`？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:22:39.683

您可以为时间跨度分配以下向量，这样，您对 ode45 说您希望在特定时间点（这里，每 0.001）得到解决方案

```
tspan = ti:0.001:tf; 
```

输出向量 ( T, X ) 的步数与 tspan 向量的步数一样多。

（但如果你的意思是你希望求解器采取预先确定的和恒定的步骤来求解方程，你不能那样做。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:27:39.700

如果您需要指定时间点的值，只需执行以下操作：

```
tspan = 1:0.1:5
[T Y] = ode45(odefun, tspan, y0) 
```

`T`应该与 相同`tspan`，并且`Y`将是每个时间点的对应值。

# php - 上传文件时codeigniter出错？

> ID：15844330
> 
> 赞同：0
> 
> 时间：2013-04-05T22:00:02.073
> 
> 标签：php, mysql, codeigniter

我正在尝试在我的 CodeIgniter 函数中设置文件上传..

但无论我尝试做什么，我都会遇到错误......

谁能帮我解决我的问题？

我在控制器中的功能。

```
function insert_user_details(){

            $this->load->library('form_validation');
            $this->form_validation->set_rules('UserName', 'Username', 'callback_username_check');
            //$this->form_validation->set_rules('Password', 'Password', 'required');
            //$this->form_validation->set_rules('Email', 'Email', 'required|email');
            //$this->form_validation->set_rules('FirstName','FirstName', 'required');
            //$this->form_validation->set_rules('MiddleName','FirstName', 'required');
            //$this->form_validation->set_rules('LastName','FirstName', 'required');

            if ($this->form_validation->run() == FALSE)
            {
                echo 'Please Fill in the Forms Correctly' ;
            }
            else
            {
                $config['upload_path'] = '../user_uploads/';
                $config['allowed_types'] = 'gif|jpg|png';
                $config['max_size'] = '100';
                $config['max_width']  = '1024';
                $config['max_height']  = '768';
                $this->load->library('upload', $config);
                $pass = $this->input->post('Password');
                $pass = md5($pass);
                $data = array(
                    'UserName'=>$this->input->post('UserName'),
                    'Password'=>$pass,
                    'FirstName'=>$this->input->post('FirstName'),
                    'MiddleNames'=>$this->input->post('MiddleName'),
                    'LastName'=>$this->input->post('LastName'),
                    'DateOfBirth'=>date('Y-m-d',strtotime($_POST['DateOfBirth'])),
                    'AddressLine1'=>$this->input->post('AddressLine1'),
                    'AddressLine2'=>$this->input->post('AddressLine2'),
                    'City'=>$this->input->post('City'),
                    'CountryID'=>$this->input->post('CountryID'),
                    'NationalityCountryID'=>$this->input->post('NationalityCountryID'),
                    'MobileNo'=>$this->input->post('MobileNo'),
                    'WorkPhoneNo'=>$this->input->post('WorkPhoneNo'),
                    'WorkPhoneExtention'=>$this->input->post('WorkPhoneExtension'),
                    'NationalTaxNumber'=>$this->input->post('NationalTaxNumber'),
                    'NationalIDCardNo'=>$this->input->post('NationalIDCardNo'),
                    'MaritalStausID'=>$this->input->post('UI_LanguageID'),
                    'ReligionID'=>$this->input->post('ReligionID'),
                    'Photograph' => $this->upload->data(),
                    'Email'=>$this->input->post('Email'),
                    'WebUrl'=>$this->input->post('WebUrl'),
                    'HighestEducation'=>$this->input->post('HighestEducation'),
                    'UserResumeFile'=> 'res.jpg',
                    'UI_LanguageID'=> $this->input->post('UI_LanguageID'),
                    'LastLoginDate'=>'2013-02-24 00:00:00',
                    'LastLoginIP'=>'192.168.1.2',
                    'Remarks'=>$this->input->post('Remarks'),
                    'CreateByUserID'=>'1',
                    'CreateAt'=>'2013-02-24 00:00:00',
                    'ModifiedByUserID'=>'2',
                    'ModifiedAt'=>'2013-02-24 00:00:00',
                    'IsActive'=>'1'
                );
                $table = 'sys_user_accounts';
                $this->common_model->insert_record($table, $data);
                echo 'Success Message' ;
                //$this->load->view('user_management/success','','true');
        }
    } 
```

这是视图文件。

'照片', 'id' => '照片', 'placeholder' => '上传用户照片', 'maxlength' => '250' ); echo form_upload($input_field_attributes); ?>

是的，我使用了多部分

```
echo form_open_multipart('user_management/manage_users',array('id' => 'insert_user')); 
```

所以谁能告诉我为什么我在萤火虫中得到这个错误？以及如何解决？

```
> Error Number: 1054

Unknown column 'Array' in 'field list'

INSERT INTO `sys_user_accounts` (`UserName`, `Password`, `FirstName`, `MiddleNames`, `LastName`, `DateOfBirth`, `AddressLine1`, `AddressLine2`, `City`, `CountryID`, `NationalityCountryID`, `MobileNo`, `WorkPhoneNo`, `WorkPhoneExtention`, `NationalTaxNumber`, `NationalIDCardNo`, `MaritalStausID`, `ReligionID`, `Photograph`, `Email`, `WebUrl`, `HighestEducation`, `UserResumeFile`, `UI_LanguageID`, `LastLoginDate`, `LastLoginIP`, `Remarks`, `CreateByUserID`, `CreateAt`, `ModifiedByUserID`, `ModifiedAt`, `IsActive`) VALUES ('hello', '1a1dc91c907325c69271ddf0c944bc72', 'fda', 'fda', 'fad', '2010-03-03', '1', 0, '1', 0, 0, '1', '1', 0, '1', 0, 0, 0, Array, 0, 0, 0, 'res.jpg', 0, '2013-02-24 00:00:00', '192.168.1.2', 0, '1', '2013-02-24 00:00:00', '2', '2013-02-24 00:00:00', '1')

Filename: C:\xampp\htdocs\projects\zorkif_nextgen\system\database\DB_driver.php

Line Number: 330 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:09:19.687

我对 CI 不是很熟悉，但我可以看到它`$this->upload->data();`正在返回一个数组，这就是它抛出错误的原因。

如果您使用的是 PHP 5.4，请尝试使用`$this->upload->data()['file_name']`or `$this->upload->data()['full_path']`，如果您使用的是 PHP 5.3 或更低版本，则不要简单地分配`$this->upload->data()`给某个变量并通过适当的键访问值。

就在插入之前执行此操作`var_dump($this->upload->data());`，我相信您会弄清楚的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T14:30:06.963

`'Photograph' => $this->upload->data()`

$this->upload->data() 是一个返回数组的 CI 函数，因此要将其插入数据库中的列中，您需要对其进行序列化、将其更改为字符串或仅从数组中设置一个值对于照片字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T08:35:08.680

尝试调试`$this->upload->do_upload('image_file_name')`// 你的实际输入文件名

并在上传之前检查条件 //检查是否上传成功

```
if(!$this->upload->do_upload('image_file_name'))
{
    // If all uploading condition not mate like image size/type etc.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T22:09:05.780

在您的 $data 数组中，您正在分配 $this->upload->data() 的“照片”索引。实际上 $this->upload->data() 这个辅助函数返回一个数组。详情[在这里](http://ellislab.com/codeigniter/user-guide/libraries/file_uploading.html)

如果你想保存照片的名字，试试这个

```
$name = $this->upload->data(); 
```

然后在你的数组中

```
'Photograph' => $name['file_name'] 
```

# perl - 增加文件中的变量

> ID：15844333
> 
> 赞同：-1
> 
> 时间：2013-04-05T22:00:17.253
> 
> 标签：perl

我是 Perl 的新手。我要做的是打开一个文件列表，在每个文件中增加三个不同的变量，保存文件，然后关闭。

变量看起来像这样

```
This_Is_My_Variable03
This_Is_My_Variable02
This_Is_My_Variable01 
```

以 01 结尾的变量在文件中多次出现。变量有时是字符串的一部分。变量的`This_Is_My_Variable`部分永远不会改变。

谢谢。

这可能不是最好的解决方案，但它有效

```
#!perl=C:\IBM\RationalSDLC\ClearCase\bin\perl

use warnings;
use strict;

use Tie::File;

tie my @data, 'Tie::File', 'myfile.txt' or die $!;

s/(This_Is_My_Variable)(\d+)+/$1.++($_=$2)/eg for @data;

untie @data; 
```

感谢 Borodin 让我开始`Tie::File`：这绝对有帮助。

使用while循环的第二种解决方案

```
#!perl=C:\IBM\RationalSDLC\ClearCase\bin\perl
use warnings;

#use strict;

sub inc {
    my ($num) = @_;
    ++$num;
}

open(FILE, "myfile.txt") || die $!;
$i = 0;
while (<FILE>) {
    $string = $_;
    if (/This_Is_My_Variable../) {
        $string =~ s/(This_Is_My_Variable)(\d+)+/$1.++($_=$2)/eg;
        print "$string \n";
        $i++;
    }
    else {
        print "$string \n";
    }
}

close FILE; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T01:40:48.397

```
use strict;
use warnings;

use Tie::File;

tie my @data, 'Tie::File', 'myfile' or die $!;

s/(\d+)$/sprintf '%02d', $1+1/e for @data; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T09:29:06.810

您的*“使用 while 循环的第二种解决方案”*存在许多问题。

*   *永远不要*禁用`use strict`以使程序正常工作。所做的只是隐藏代码中的问题

*   您有一个未使用的子程序`inc`和一个未使用的变量`$i`

*   `open`您应该始终使用, 和词法文件句柄的三参数形式

*   在应用替换之前无需测试该行是否包含字符串

*   您可以简单地`($2+1)`在替换字符串中使用，而不是将值分配给`$_`并使用`++($_=$2)`

*   如果您打算对从文件中读取的行使用命名变量，那么通常您应该使用`while (my $string = <$fh>) {...}`. 对于像这样的短块，最好只使用`$_`

*   你没有`chomp`输入，这很好，除非你在每行之后打印一个额外的空格和换行符

*   您`print "$string \n"`的代码中有两次。`if`它也可能只在结构外出现一次

此代码执行相同的过程。我希望它有所帮助。

```
use strict;
use warnings;

open(my $fh, '<', 'myfile.txt') || die $!;
while (<$fh>) {
    s/(This_Is_My_Variable)(\d+)/$1.($2+1)/eg;
    print;
} 
```

# c++ - MFC 拖动对象

> ID：15844337
> 
> 赞同：1
> 
> 时间：2013-04-05T22:00:29.237
> 
> 标签：c++, mfc

我使用 将三个对象绘制到一个窗口上`CPaintDC`，现在我试图通过使用`OnMouseMove`事件处理程序使其中一个（椭圆）变得可拖动。我只是在玩 MFC，不知道如何让它工作。

这是我尝试过的`OnMouseMove`：

```
// TODO: Add your message handler code here and/or call default
CClientDC dc(this);
CRect rect;
GetClientRect(&rect);
dc.SetMapMode(MM_ANISOTROPIC);
dc.SetWindowExt(100, 100);
CRect rectEllipse(ellipse.cx, ellipse.cy,(ellipse.cx) + 10, (ellipse.cy) + 10);//(10, 10, 20, 20);dc.Ellipse(ellipse.cx, ellipse.cy, (ellipse.cx) + 10, (ellipse.cy) + 10);//10, 10, 20, 20);
//CPoint ellipseDest;

//dc.SetViewportExt(rect.Width(), rect.Height());
 if (mouseCaptured)
   {
       ellipse.cx = point.x;
       ellipse.cy = point.y;
       InvalidateRect(rectEllipse, TRUE); 
   }
CDialogEx::OnMouseMove(nFlags, point); 
```

请在下面找到我粘贴的代码。

非常感谢帮忙。

```
#include "stdafx.h"
#include "CSIT861a3 Vasilkovskiy.h"
#include "CSIT861a3 VasilkovskiyDlg.h"
#include "afxdialogex.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CAboutDlg dialog used for App About

class CAboutDlg : public CDialogEx
{
public:
    CAboutDlg();

// Dialog Data
    enum { IDD = IDD_ABOUTBOX };

    protected:
    virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV support

// Implementation
protected:
    DECLARE_MESSAGE_MAP()
public:
//  afx_msg void OnLButtonDown(UINT nFlags, CPoint point);
//  afx_msg void OnLButtonUp(UINT nFlags, CPoint point);
//  afx_msg void OnMouseMove(UINT nFlags, CPoint point);
};

CAboutDlg::CAboutDlg() : CDialogEx(CAboutDlg::IDD)
{
}

void CAboutDlg::DoDataExchange(CDataExchange* pDX)
{
    CDialogEx::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(CAboutDlg, CDialogEx)
//  ON_WM_LBUTTONDOWN()
//  ON_WM_LBUTTONUP()
//  ON_WM_MOUSEMOVE()
END_MESSAGE_MAP()

// CCSIT861a3VasilkovskiyDlg dialog

CCSIT861a3VasilkovskiyDlg::CCSIT861a3VasilkovskiyDlg(CWnd* pParent /*=NULL*/)
    : CDialogEx(CCSIT861a3VasilkovskiyDlg::IDD, pParent)
{
    m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);

    ellipseColor = RGB(255, 0, 0);
    centerRectColor = RGB(0, 0, 0);
    rightRectColor = RGB(255, 0, 0);
    centerRect.left = 40;
    centerRect.top = 20;
    centerRect.right = 55;
    centerRect.bottom = 80;
    rightRect.left = 75;
    rightRect.top = 35;
    rightRect.right = 90;
    rightRect.bottom = 50;
    ellipse.cx = 10;
    ellipse.cy = 10;
    mouseCaptured = false;
}

void CCSIT861a3VasilkovskiyDlg::DoDataExchange(CDataExchange* pDX)
{
    CDialogEx::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(CCSIT861a3VasilkovskiyDlg, CDialogEx)
    ON_WM_SYSCOMMAND()
    ON_WM_PAINT()
    ON_WM_QUERYDRAGICON()
    ON_WM_LBUTTONDOWN()
    ON_WM_LBUTTONUP()
    ON_WM_MOUSEMOVE()
END_MESSAGE_MAP()

// CCSIT861a3VasilkovskiyDlg message handlers

BOOL CCSIT861a3VasilkovskiyDlg::OnInitDialog()
{
    CDialogEx::OnInitDialog();

    // Add "About..." menu item to system menu.

    // IDM_ABOUTBOX must be in the system command range.
    ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
    ASSERT(IDM_ABOUTBOX < 0xF000);

    CMenu* pSysMenu = GetSystemMenu(FALSE);
    if (pSysMenu != NULL)
    {
        BOOL bNameValid;
        CString strAboutMenu;
        bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);
        ASSERT(bNameValid);
        if (!strAboutMenu.IsEmpty())
        {
            pSysMenu->AppendMenu(MF_SEPARATOR);
            pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
        }
    }

    // Set the icon for this dialog.  The framework does this automatically
    //  when the application's main window is not a dialog
    SetIcon(m_hIcon, TRUE);         // Set big icon
    SetIcon(m_hIcon, FALSE);        // Set small icon

    // TODO: Add extra initialization here

    return TRUE;  // return TRUE  unless you set the focus to a control
}

void CCSIT861a3VasilkovskiyDlg::OnSysCommand(UINT nID, LPARAM lParam)
{
    if ((nID & 0xFFF0) == IDM_ABOUTBOX)
    {
        CAboutDlg dlgAbout;
        dlgAbout.DoModal();
    }
    else
    {
        CDialogEx::OnSysCommand(nID, lParam);
    }
}

// If you add a minimize button to your dialog, you will need the code below
//  to draw the icon.  For MFC applications using the document/view model,
//  this is automatically done for you by the framework.

void CCSIT861a3VasilkovskiyDlg::OnPaint()
{
    //Create pen and pointer to the old pen
    CPen blackPen; 
    blackPen.CreatePen(PS_SOLID, 1, RGB (0, 0, 0)); 

    //Create a bursh
    CBrush blackBrush(centerRectColor);
    CBrush redBrush(rightRectColor);
    CBrush hatchRedBrush(HS_CROSS, ellipseColor);

    //Set up object for painting
    CPaintDC dc (this);
    CRect rect;
    GetClientRect (&rect);
    dc.SetMapMode (MM_ANISOTROPIC);
    dc.SetWindowExt (100, 100);
    dc.SetViewportExt (rect.Width (), rect.Height ());

    //select pen 
    dc.SelectObject(&blackPen);

    //Rectangle red interior color
    dc.SelectObject(&redBrush);
    dc.Rectangle(rightRect); //(75, 35, 90, 50);

    //Rectangel black interior
    dc.SelectObject(&blackBrush);//Select Brush
    dc.Rectangle( centerRect);//(40, 20, 55, 80);

    //Ellipse
    dc.SelectObject(&hatchRedBrush);//Select Brush
    dc.Ellipse(ellipse.cx, ellipse.cy, (ellipse.cx) + 10, (ellipse.cy) + 10);//10, 10, 20, 20);

    if (IsIconic())
    {
        CPaintDC dc(this); // device context for painting

        SendMessage(WM_ICONERASEBKGND, reinterpret_cast<WPARAM>(dc.GetSafeHdc()), 0);

        // Center icon in client rectangle
        int cxIcon = GetSystemMetrics(SM_CXICON);
        int cyIcon = GetSystemMetrics(SM_CYICON);
        CRect rect;
        GetClientRect(&rect);
        int x = (rect.Width() - cxIcon + 1) / 2;
        int y = (rect.Height() - cyIcon + 1) / 2;

        // Draw the icon
        dc.DrawIcon(x, y, m_hIcon);
    }
    else
    {
        CDialogEx::OnPaint();
    }
}

// The system calls this function to obtain the cursor to display while the user drags
//  the minimized window.
HCURSOR CCSIT861a3VasilkovskiyDlg::OnQueryDragIcon()
{
    return static_cast<HCURSOR>(m_hIcon);
}

//void CAboutDlg::OnLButtonDown(UINT nFlags, CPoint point)
//{
//  // TODO: Add your message handler code here and/or call default
//  //SetCapture();
//  CClientDC dc(this);
//  CRect rect;
//  GetClientRect(&rect);
//  dc.SetMapMode(MM_ANISOTROPIC);
//  dc.SetWindowExt(100, 100);
//  dc.SetViewportExt(rect.Width(), rect.Height());
//  CRect rectEllipse(10, 10, 20, 20);
//  
//  ellipseColor = RGB(0,0,0);
//
//  CDialogEx::OnLButtonDown(nFlags, point);
//}

//void CAboutDlg::OnLButtonUp(UINT nFlags, CPoint point)
//{
//  // TODO: Add your message handler code here and/or call default
//  ReleaseCapture ();
//  CDialogEx::OnLButtonUp(nFlags, point);
//}

//void CAboutDlg::OnMouseMove(UINT nFlags, CPoint point)
//{
//  // TODO: Add your message handler code here and/or call default
//
//  CDialogEx::OnMouseMove(nFlags, point);
//}

void CCSIT861a3VasilkovskiyDlg::OnLButtonDown(UINT nFlags, CPoint point)
{
    // TODO: Add your message handler code here and/or call default

    CClientDC dc(this);
    CRect rect;
    GetClientRect(&rect);
    dc.SetMapMode(MM_ANISOTROPIC);
    dc.SetWindowExt(100, 100);
    dc.SetViewportExt(rect.Width(), rect.Height());

    CRect rectEllipse(ellipse.cx, ellipse.cy, 20, 20);//(10, 10, 20, 20);
    CRgn circle;
    dc.LPtoDP(rectEllipse); 
    circle.CreateEllipticRgnIndirect(rectEllipse);

    if (circle.PtInRegion(point))
    {
        SetCapture();
            mouseCaptured = true;
        ellipseColor = RGB(0,0,255);
        InvalidateRect(rectEllipse, FALSE);
    }

    CDialogEx::OnLButtonDown(nFlags, point);
}

void CCSIT861a3VasilkovskiyDlg::OnLButtonUp(UINT nFlags, CPoint point)
{
    // TODO: Add your message handler code here and/or call default
    ReleaseCapture ();
    mouseCaptured = false;
    CDialogEx::OnLButtonUp(nFlags, point);
}

void CCSIT861a3VasilkovskiyDlg::OnMouseMove(UINT nFlags, CPoint point)
{

    // TODO: Add your message handler code here and/or call default

     if (mouseCaptured)
       {
              /*
                Code to drag and drop and redraw ellipse
                  */
              InvalidateRect(rectEllipse, TRUE); 
       }
    CDialogEx::OnMouseMove(nFlags, point);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T07:29:24.490

我认为 Mark Ransom 的评论是对的，您需要在 MouseMove 上使两个矩形无效。

```
CRect rectEllipse(ellipse.cx, ellipse.cy,(ellipse.cx) + 10, (ellipse.cy) + 10);
if (mouseCaptured)
{    InvalidateRect(rectEllipse, TRUE); 
     ellipse.cx = point.x;
     ellipse.cy = point.y;
     CRect rectNew(ellipse.cx, ellipse.cy,(ellipse.cx) + 10, (ellipse.cy) + 10);
     InvalidateRect(rectNew, TRUE); 
```

}

另外，在`OnLButtonUp()`

```
if (mouseCaptured)
{    ellipseColor = RGB(255, 0, 0);
     CRect rectEllipse(ellipse.cx, ellipse.cy,(ellipse.cx) + 10, (ellipse.cy) + 10);
     InvalidateRect(rectEllipse, TRUE); 
} 
```

# android - 自定义 listView 以随机顺序显示较少的项目

> ID：15844338
> 
> 赞同：2
> 
> 时间：2013-04-05T22:00:30.443
> 
> 标签：android, listview

我为我的 android 应用程序制作了一个自定义的膨胀 listView，但我的 getView() 方法有问题。

```
public class BinderData extends BaseAdapter {

    private LayoutInflater inflater;
    private ArrayList targetList;
    private ViewHolder holder;
    private Activity nikola;
    private Context context;

    private static ArrayList genres = new ArrayList();

    public BinderData(Activity act, List<Genre> map) {
        targetList = new ArrayList();
        for (int i = 0; i<map.size(); i++){
            Genre genre = map.get(i);
            targetList.add(genre);
            ArrayList<Artist> aList = genre.getArtists();
            for (int j = 0; j<aList.size(); j++){
                targetList.add(aList.get(j));
            }
        }
        this.nikola = act;
        inflater = (LayoutInflater) act
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    } 
```

这是我的 getView() 方法

```
public View getView(int position, View convertView, ViewGroup parent) {
        View vi = convertView;

        if (convertView == null){
            ViewableItem item = (ViewableItem)targetList.get(position);
            if (item.isTypeOf().equalsIgnoreCase("genre")){
                vi = inflater.inflate(R.layout.category_row, null);
                holder = new GenreViewHolder();
                ((GenreViewHolder)holder).textViewGenreTitle = (TextView)vi.findViewById(R.id.textViewCategoryTitle);
                String s = ((Genre)item).getTitle();
                holder.setTitle(s);
            }else{
                vi = inflater.inflate(R.layout.list_row, null);
                holder = new ArtistViewHolder();
                ((ArtistViewHolder)holder).textViewArtistName = (TextView)vi.findViewById(R.id.textViewAuthorNameHome);
                String s = ((Artist)item).getArtist();
                holder.setArtistName(s);
            }
            vi.setTag(holder);
        }else{
            holder = (ViewHolder)vi.getTag();
        }

        return vi;
    } 
```

我的列表有两种布局。一个用于类别标题，另一个用于该类别下的项目。

[http://imgur.com/xbPfGTi](http://imgur.com/xbPfGTi) - 这是图片

我已经让 targetList 充满了我需要在我的 listView 中显示的数据。（在构造函数中）有问题！列表中的艺术家不断重复，类别不在正确的位置。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:36:33.160

您的问题是由于您没有将数据绑定到您的行时`convertView != null`，而是返回`convertView`被回收给您的行，这就是您看到相同重复数据的原因。

您需要`View`根据数据类型将数据绑定到每一行的行，如下所示：

```
public View getView(int position, View convertView, ViewGroup parent) {
    final View row;
    boolean isGenreRow = getItemViewType(position) == GENRE_ROW;

    // Inflate views if this is a new row
    if (convertView == null) {
        // Get the right type of view depending on the type of data
        if (isGenreRow) {
            row = inflater.inflate(R.layout.category_row, null);
            holder = new GenreViewHolder();
            ((GenreViewHolder) holder).textViewGenreTitle = (TextView) row.findViewById(R.id.textViewCategoryTitle);
        }
        else {
            row = inflater.inflate(R.layout.list_row, null);
            holder = new ArtistViewHolder();
            ((ArtistViewHolder) holder).textViewArtistName = (TextView) row.findViewById(R.id.textViewAuthorNameHome);
        }
        row.setTag(holder);
    }
    // Otherwise, use the recycled row
    else {
        row = convertView;
        holder = (ViewHolder) row.getTag();
    }

    // Bind data to views, depending on data type
    ViewableItem item = (ViewableItem) targetList.get(position);
    if (isGenreRow) {
        ((GenreViewHolder) holder).setTitle(((Genre) item).getTitle());
    }
    else {
        ((ArtistViewHolder) holder).setArtistName(((Artist) item).getArtist());
    }

    return row;
} 
```

您还必须覆盖其他一些方法以让`BaseAdapter`知道存在不止一种数据类型，因此它知道如何回收行的`View`s。

```
private static final int GENRE_ROW = 0;
private static final int ARTIST_ROW = 1;

@Override
public int getItemViewType(int position) {
    // Return the row type at the position
    ViewableItem item = (ViewableItem) targetList.get(position);
    return item.isTypeOf().equalsIgnoreCase("genre") ? GENRE_ROW : ARTIST_ROW;
}

@Override
public int getViewTypeCount() {
    // Return the number of row types there are
    return 2;
} 
```

假设我没有犯任何错误，您应该能够复制并粘贴此解决方案。

# ruby-on-rails - 理解 Application.routes.draw 源代码

> ID：15844341
> 
> 赞同：1
> 
> 时间：2013-04-05T22:00:49.867
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

几个月前，我开始使用 Rails 开发 Web 应用程序。与我使用的任何新框架一样，作为进一步理解它的一个步骤，我已经开始阅读源代码。也许这是我最近对 ​​Ruby 的了解，但我在理解它时遇到了一些麻烦。

今天我决定查看`Application.routes.draw`（来自`routes.rb`）并从[ActionDispatch::Routing 文档](http://api.rubyonrails.org/classes/ActionDispatch/Routing.html)中找到[rails/actionpack/lib/action_dispatch/routing/route_set.rb](https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_dispatch/routing/route_set.rb)`draw`中定义的方法，但我看不到它在（或或）中的位置玩。此外，我看不到在哪里定义了方法。`Application.rb``Engine.rb``Railtie.rb``routes``Application`

非常感谢任何答案或链接。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:07:26.687

好的，我终于在[engine.rb #488 行](https://github.com/rails/rails/blob/3-2-stable/railties/lib/rails/engine.rb#L488)`routes`找到了方法。我会从那里拿走它。

# javascript - 从 Morningstar.com 获取上行/下行捕获率

> ID：15844342
> 
> 赞同：2
> 
> 时间：2013-04-05T22:00:57.333
> 
> 标签：javascript, excel, vba, build-automation

第一次很长时间。

这个 VBA 的新东西，但是很流行。

我有兴趣拉动许多共同基金的上行/下行捕获率，并希望使流程自动化。我从中获取信息的表格不是您的典型表格；我猜这是晨星网站上的“动态对象” 这是网站。

[http://performance.morningstar.com/fund/ratings-risk.action?t=FDSAX®ion=USA&culture=en-us](http://performance.morningstar.com/fund/ratings-risk.action?t=FDSAX&region=USA&culture=en-us)

这是专门针对 SunAmerica 的 Focus Dividend Fund 的；但是我想为很多资金做这就是我现在拥有的代码；我把它拿到 msgbox，但不知道如何循环和获取有关 excel 的信息。

```
Private Sub Worksheet_Change(ByVal Target As Range)
  If Target.Column=Range("upDown").Row And _
  Target.Column= Range("upDown").Column Then

  Dim IE as New InternetExplorer
  IE.Visible=False
  IE.navigate "http://performance.morningstar.com/fund/ratings-risk.action?t=" _
     & Range("upDown").Value

  Do
    DoEvents
  Loop Until IE.readyState = READYSTATE_Complete
    Dim Doc as HTMLDocument
    Set Doc = IE.document
    Dim sTR As String 'got the "TR" from google chrome inspect element
    sTR = Trim(Doc.getElementsByTagName("tr")(45).innerText) 
```

这就是我卡住的地方。我知道我需要使用“拆分”来排列我需要的每个数据。示例 1 年上涨 1 年下跌 3 年上涨 3 年下跌。

因此，一旦我在 excel 上得到它，我需要让 excel 运行我所有的代码......大约 1500 来提取该数据，因为它每月更新一次。

提前谢谢你……你会救命的……如果我不弄清楚的话，我可能会开枪自杀 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T16:33:13.270

试试下面的代码。

```
Sub Test()

    Dim IE As Object, Doc As Object, lastRow As Long, tblTR As Object, tblTD As Object, strCode As String
    lastRow = Range("A65000").End(xlUp).Row

    Set IE = CreateObject("internetexplorer.application")
    IE.Visible = True

    For i = 1 To lastRow

        strCode = "FDSAX"    ' Range("A" & i).value  ' kindly change it as per your requirement. Currently hardcoded

        IE.navigate "http://performance.morningstar.com/fund/ratings-risk.action?t=" & "FDSAX"

        Do While IE.readystate <> 4: DoEvents: Loop

        Set Doc = CreateObject("htmlfile")
        Set Doc = IE.document

tryAgain:
        Set tblTR = Doc.getelementbyid("div_upDownsidecapture").getelementsbytagname("tr")(3)

        If tblTR Is Nothing Then GoTo tryAgain

        j = 2
        For Each tblTD In tblTR.getelementsbytagname("td")
            tdVal = Split(tblTD.innerText, vbCrLf)
            Cells(i, j) = tdVal(0)
            Cells(i, j + 1) = tdVal(1)
            j = j + 2
        Next

    Next
End Sub 
```

# c - 二叉搜索树，删除节点

> ID：15844347
> 
> 赞同：0
> 
> 时间：2013-04-05T22:01:17.187
> 
> 标签：c, binary-search-tree

我正在编写一个程序，如果你愿意，它会读取“学生记录”，然后根据数据将其分成 4 个二叉搜索树。我试图删除一个节点，但我不想实际删除它，我只想在结构中设置一个标志，它基本上让我知道它已被“删除”。这是我的代码，它给了我几个错误：

```
 void deleteNode( TreeNodePtr *treePtr, SREC R, unsigned long key)/*ADD HOW*/
 {
    printf("I got into the delete function.\n");

     /*empty*/
    if(*treePtr != NULL)
    {
        if(R.SID<(*treePtr)->SID)/*Not empty*/
        {
            printf("less than\n");
            deleteNode((*treePtr)->leftPtr, R, key);
        }
        else if(R.SID>(*treePtr)->SID)
        {
            printf("more than.\n");
            deleteNode((*treePtr)->rightPtr, R, key);
        }
        else
        {
            treePtr->exists = 1;
            printf("Are we deleted yet?\n");
        }
    }
    else
    {
         fprintf(stderr,"Could not locate student with ID.\n");
    }
 } 
```

错误是：注意：预期为“struct treeNode **”，但参数类型为“struct treeNode *”错误：“struct treeNode”没有名为“SID”的成员。我确定我只是错过了一些小东西，但我不知道它是什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:21:44.087

改变

```
deleteNode((*treePtr)->leftPtr, R, key); 
```

进入

```
deleteNode(&(*treePtr)->leftPtr, R, key); 
```

对的也一样。如果您真的希望该功能能够接受，这是值得怀疑的`**`。`*`当您没有实际删除时，a也可以正常工作。

对于第二个错误，您很可能有一个`struct treeNode`类型为 的成员`SREC`。您必须添加该成员名称的中缀，例如`(*treePtr)->R.SID`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:43:49.170

> 错误是：注意：预期的“struct treeNode **”但参数类型为“struct treeNode *”错误：“struct treeNode”没有名为“SID”的成员</p>

这些错误正是他们所说的。的第一个参数`deleteNode`是 type `TreeNodePtr *`aka `struct treeNode **`，但是你传递`(*treePtr)->leftPtr`的是 type `TreeNodePtr`aka `struct treeNode *`。你引用 (*treePtr)->SID 但没有这样的成员`struct treeNode`.

你也应该得到一个错误

```
treePtr->exists = 1; 
```

因为 treePtr 指向一个*指向 a 的指针*，`struct treeNode`但指针没有成员。为什么您的“已删除”标志称为“存在”？那是倒退。要么调用它`deleted`，要么将其设置为 0 并将其初始化为 1。前者更好。

你的`key`参数是什么？你从不使用它。

`TreeNode`假设包含一个`SREC`被调用`R`的和一个`deleted`标志，这可能会起作用：

```
void markDeleted(TreeNode* pnode, SREC R)
{
    if (pnode == NULL)
    {
        fprintf(stderr,"Could not locate student with ID.\n");
    }
    else if (R.SID < pnode->R.SID)
    {
        /* search left branch */
        markDeleted(pnode->leftPtr, R);
    }
    else if (R.SID > pnode->R.SID)
    {
        /* search right branch */
        markDeleted(pnode->rightPtr, R);
    }
    else
    {
        /* match */
        pnode->deleted = 1;
    }
} 
```

# c# - 如何使用 C# 对硬盘进行分区

> ID：15844349
> 
> 赞同：1
> 
> 时间：2013-04-05T22:01:25.823
> 
> 标签：c#, .net, partitioning

我熟悉格式化分区的 WMI 方法，但如果我想以编程方式创建分区怎么办？这可能吗？如果可以，有人可以指出我正确的方向吗，因为我很难找到有关这方面的信息。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:17:54.423

您可能只想使用`Process.Start`分区磁盘所需的参数/脚本来调用 diskpart：

[http://support.microsoft.com/kb/300415](http://support.microsoft.com/kb/300415)

[http://technet.microsoft.com/en-us/library/cc766465%28v=ws.10%29.aspx](http://technet.microsoft.com/en-us/library/cc766465%28v=ws.10%29.aspx)

# c# - 游戏c#的暂停按钮

> ID：15844356
> 
> 赞同：0
> 
> 时间：2013-04-05T22:02:05.860
> 
> 标签：c#, winforms

我只想创建一个简单的暂停按钮，如果有必要，也许还可以创建另一个恢复按钮。我一直在环顾四周，我大多看到 Thread.Sleep()，这对我不起作用，因为我希望暂停保持暂停，直到用户需要。

Thread.Suspend() 不起作用，因为它现在已经过时了。

我还看到了另一种创建第二种形式的解决方案，但是，这似乎对我不起作用。一旦打开第二个表单，整个程序就会关闭。

我不确定这是否有区别，但我的程序当前使用两个线程（主线程运行 form1 和另一个线程）。理想情况下，一切都需要暂停。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:20:33.430

最简单的事情是拥有一些其他线程可以访问的变量/属性。

```
Bool ShouldPause = false; 
```

另一个线程应该在它的游戏循环中有类似的东西：

```
while(true)
{
  if(!ShouldPause)
  {
    UpdateGame();
  }
  Draw();
} 
```

只有当 ShouldPause 变量为假时，游戏才会继续。我做了几次，效果很好。

您不想通过一些类似“暂停”的功能暂停线程，因为它会阻止他在屏幕上绘图并且看起来好像它没有响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:13:13.297

您可以使用线程信号技术。一个好的开始是看一下[ManualResetEvent 类](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)

# c# - 为什么提交按钮将空数据从视图传递到控制器

> ID：15844361
> 
> 赞同：1
> 
> 时间：2013-04-05T22:02:23.637
> 
> 标签：c#, asp.net-mvc-3

我对 C# 和 MVC 非常陌生，这可能看起来像一个基本问题，但即使在彻底寻找有类似问题的人之后，我也无法让它发挥作用。

问题出在我在编辑视图上的提交按钮上，由于某种原因，该按钮将空数据传递给 Update 方法，而不是表单输入数据。

这是视图：

```
<div class="row-fluid metro">
<div class="span2 offset4">

    @using (Html.BeginForm("Update", "Realty", FormMethod.Post))
    {

        @Html.HiddenFor(model => model.Address)
        @Html.HiddenFor(model => model.Details)
        @Html.HiddenFor(model => model.Manager)
        @Html.ValidationSummary(true)
        <div class="control-group">
            <label class="control-label">Details</label>
            <div class="controls">
                @Html.EditorFor(model => model.Details)
                @Html.ValidationMessageFor(model => model.Details)
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Address</label>
            <div class="controls">
                @Html.EditorFor(model => model.Address)
                @Html.ValidationMessageFor(model => model.Address)
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">Manager</label>
            <div class="controls">
                  @Html.DropDownListFor(model => model.Manager.Id, Model.Managers)

               </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Guardar</button>
            <a href="@Url.Action("Index", "Realty")"><button type="button" class="btn">Cancelar</button></a>
        </div>
    }
</div> 
```

这是视图模型 public class RealtyViewModel { /// /// 获取或设置 id。/// public int Id { get; 放; }

```
 public string Address { get; private set; }

    /// <summary>
    /// Gets the details.
    /// </summary>
    public string Details { get; private set; }
    public List<HomeViewModel> Homes { get; private set; }

    /// <summary>
    /// Gets the manager.
    /// </summary>

    public IEnumerable<SelectListItem> Managers { get; set; }

    public ManagerViewModel Manager { get; private set; }
    public RealtyViewModel(int id,string Address, string Details, ManagerViewModel Manager)
    {
        this.Id = id;
        this.Address = Address;
        this.Details = Details;
        this.Manager = Manager;
    }

    public RealtyViewModel() {}

} 
```

}

最后，如果需要，这是来自控制器的 Update 方法：

```
 public ActionResult Update(RealtyViewModel model)
    {
        if (model.Id == 0)
        {
            var manager = this.managerService.Get(model.Manager.Id);
            this.realtyService.Create(model.Address, model.Details,manager);
        }
        else
        {
            var manager = this.managerService.Get(model.Manager.Id);
            this.realtyService.Update(model.Id,model.Address, model.Details, manager);
        }

        return this.RedirectToAction("Index");
    } 
```

任何帮助将不胜感激，在此先感谢。

```
 public ActionResult Edit(int id)
    {
        List<SelectListItem> managers = new List<SelectListItem>();
        var model = new RealtyViewModel();

        if (id != 0)
        {
            var realty = this.realtyService.Get(id);
            var mvm = new ManagerViewModel(realty.Manager.Id, realty.Manager.Name, realty.Manager.Age);
            model = new RealtyViewModel(realty.Id, realty.Address, realty.Details, mvm);
        }
        foreach (var Manager in managerService.GetAll())
        {
            managers.Add(new SelectListItem { Value=Manager.Id.ToString(),Text=Manager.Name});
        }
        model.Managers = managers;
        return this.View(model);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:09:39.110

尝试从此表单中删除隐藏字段

```
<div class="row-fluid metro">
<div class="span2 offset4">

    @using (Html.BeginForm("Update", "Realty", FormMethod.Post))
        {
        @Html.ValidationSummary(true)
            <div class="control-group">
            <label class="control-label">Details</label>
            <div class="controls">
                @Html.EditorFor(model => model.Details)
                @Html.ValidationMessageFor(model => model.Details)
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Address</label>
            <div class="controls">
                @Html.EditorFor(model => model.Address)
                @Html.ValidationMessageFor(model => model.Address)
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">Manager</label>
            <div class="controls">
                  @Html.DropDownListFor(model => model.Manager.Id, Model.Managers)

               </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Guardar</button>
            <a href="@Url.Action("Index", "Realty")"><button type="button" class="btn">Cancelar</button></a>
        </div>
    }
</div> 
```

# python - 如何从动态 URL 抓取和下载文件？

> ID：15844365
> 
> 赞同：-2
> 
> 时间：2013-04-05T22:02:52.000
> 
> 标签：python, download, web-crawler

我有自己的 python 爬虫（基于 Udacity.com 的 CS101），试图从 download.cnet.com 下载文件（安装程序），当爬虫爬行时，我希望它像这样工作：

1.  判断链接是否为下载链接：

    > > > response = urllib2.urlopen(' [http://example.com/](http://example.com/) ')
    > > > 
    > > > content_type = response.info().get('Content-Type')
    > > > 
    > > > 打印内容类型

2.  如果爬虫得到：

    ```
    application/octet-stream 
    ```

3.  爬虫将从链接下载安装程序

问题是download.com似乎没有提供真正的下载链接，我的爬虫无法从他们的动态链接中找到下载链接。例如，当我尝试在 download.com 上下载 Opera 时，他们确实有这样的消息：“您的下载将在稍后开始。如果没有，请重新开始下载。” 但是当我检查“重新启动下载”链接时，我期待得到真正的下载链接（例如 download.com/blah/Opera.exe），但我得到了一些我的爬虫无法理解的奇怪地址。

所以我已经从[http://googlewebmastercentral.blogspot.no/2008/09/dynamic-urls-vs-static-urls.html](http://googlewebmastercentral.blogspot.no/2008/09/dynamic-urls-vs-static-urls.html)确认 download.com 正在使用动态链接，但是我应该怎么做才能让我的爬虫找到此链接，以便它可以从 download.com 下载安装程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T09:07:31.873

正如您所说，您可能会在页面中获取 JavaScript 或 AJAX，这会在“真实”浏览器中激活下载，同时阻碍您简单地自动化它。

这是对同一问题的另一个讨论：[StackOverflow: Mechanize and JavaScript](https://stackoverflow.com/questions/5793414/mechanize-and-javascript)。如上所述，一种选择是使用 Python 的替代品，例如 PhantomJS 或浏览器自动化框架（带有可选的“远程控制”），例如 Selenium。

# php - 两个 MySQL 结果集到一个嵌套数组

> ID：15844366
> 
> 赞同：2
> 
> 时间：2013-04-05T22:02:55.113
> 
> 标签：php, mysql, nested

我有两个数据表“项目”和“子公司”，结构如下：

**项目** ItmCod ItmName

**子公司** ItmCod母公司ItmCodChild

我需要显示一个项目列表，每个项目及其子公司列表，就像在这个 json 中一样：

```
{
   "ItmCod":1,
   "ItmName":"BogusItem1",
   "Subsidiaries":
   [
      {
         "ItmCodParent":1,
         "ItmCodChild":15
      },{
         "ItmCodParent":1,
         "ItmCodChild":16      
      }
   ]
},{
   "ItmCod":2,
   "ItmName":"BogusItem2",
   "Subsidiaries":
   [
      {
         "ItmCodParent":2,
         "ItmCodChild":17
      },{
         "ItmCodParent":2,
         "ItmCodChild":18      
      }
   ]
} 
```

如何将第二个结果集添加到第一个结果集以进行嵌套，如上所示。到目前为止我有这个代码：

```
$sql = "SELECT ItmCod, ItmName FROM item";

$item_rows = array();

while($item_row = $database->fetch_array_assoc($item_result)){

   $sub_sql = "SELECT ItmCodParent, ItmCodChild FROM subsidiary WHERE subsidiary.ItmCodParent = " . $item_row["ItmCod"];

   $sub_result = $database->query($sub_sql);

   $sub_rows = array();

   while($sub_row = $database->fetch_array_assoc($sub_result)){
      $sub_rows[] = $sub_row;
   }

   $item_rows[] = $item_row;
}

print json_encode($item_rows); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:13:46.923

就在这条线之上

```
$item_rows[] = $item_row; 
```

只需添加

```
$item_row['Subsidiaries']=$sub_rows; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:18:46.663

我会像这样做一个单一的连接查询：

```
SELECT i.ItmCod AS ItmCod, i.ItmName AS ItmName, s.ItmCodChild AS ItmCodChild
FROM item AS i
INNER JOIN subsidiary AS s
   ON i.ItmCod = s.ItmCodParent 
```

注意我没有选择`s.ItmCodParent`，因为这只是多余的`i.ItmCod`.

然后像这样构建数组：

```
$item_rows = array();
while($item_row = $database->fetch_array_assoc($item_result)){
   $item_rows[(int)$item_row['ItmCod']]['ItmCod'] = $item_row['ItmCod'];
   $item_rows[(int)$item_row['ItmCod']]['ItmName'] = $item_row['ItmCod'];
   $sub_array = array(
       'ItdCodParent' => $item_row['ItmCod'],
       'ItmCodChild' => $item_row['ItmCodChild']
   );
   $item_rows[(int)$item_row['ItmCod']]['Subsidiaries'][] = $sub_array;
}
$item_rows = array_values($item_rows); // reset numerical indexes.
echo json_encode($item_rows); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:23:32.117

我不会尝试通过两个查询来解决这个问题：

```
$sql = '
    SELECT I.ItmCod, I.ItmName, S.ItmCodChild
    FROM item I
    LEFT JOIN subsidiary S ON (S.ItmCodParent = I.ItmCod)
';

// fetch $item_result with $sql

$item_rows = array();
while ($item_row = $database->fetch_array_assoc($item_result)) {
  $cod = $item_row['ItmCod'];
  if (!array_key_exists($cod, $item_rows)) {
    $item_rows[$cod] = $item_row;
  }

  $item_rows[$cod]['Subsidiaries'] = array(
    'ItmCodParent' => $cod,
    'ItmCodChild' => $item_row['ItmCodChild'],
  );
}

// array_values is because json_encode will keep the keys
// otherwise
print json_encode(array_values($item_rows)); 
```

这样一来，您就不必为每个单独的项目行运行额外的查询来获取子公司（最大限度地减少往返时间，并让数据库做它擅长的事情）。

# .net - 如何获得 CLR blittable 结构的对齐大小？

> ID：15844367
> 
> 赞同：0
> 
> 时间：2013-04-05T22:03:00.957
> 
> 标签：.net, interop, sizeof

我正在制作一个类似于[`SafeBuffer`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.safebuffer.aspx)针对 .NET 2.0 的类。其中一个功能是`void ReadArray<T>(long position, T[] array, int offset, int count)`(or `WriteArray`)，它将一系列 (blittable) 结构读入/写入数组。

我的第一个猜测是简单地使用`Marshal.PtrToStructure`/`StructureToPtr`和推进 by `Marshal.SizeOf`。然而，查看 IL 以获取`SafeBuffer.ReadArray`它`Marshal.AlignedSizeOf<T>()`用于提升的节目（一种内部方法）。该函数定义为：

```
uint s = Marshal.SizeOf<T>();
if (s == 1u || s == 2u || IntPtr.Size == 8 && s == 4u) { return s; }
return Marshal.AlignedSizeOfType(typeof(T)); // an internalcall 
```

该方法仅在 .NET 4.0 中定义，因此我无法使用（也无法在 Rotor 中使用）。

我的想法是`Marshal.UnsafeAddrOfPinnedArrayElement`在数组中的相邻元素上使用，但这不起作用。这是我的测试代码：

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;

namespace test
{
    class Program
    {
        [StructLayout(LayoutKind.Sequential)]
        struct A
        {
            byte a;
            short x;
            byte b;
        }

        private static MethodInfo MarshalAlignedSizeOf;
        static int MAlignedSizeOf(Type t)
        {
            if (MarshalAlignedSizeOf == null) { MarshalAlignedSizeOf = typeof(Marshal).GetMethod("AlignedSizeOf", BindingFlags.NonPublic | BindingFlags.Static); }
            return (int)(uint)MarshalAlignedSizeOf.MakeGenericMethod(t).Invoke(null, null);
        }

        static int AlignedSizeOf(Type t)
        {
            Array a = Array.CreateInstance(t, 0);
            GCHandle pin = GCHandle.Alloc(a, GCHandleType.Pinned);
            try
            {
                return (int)(Marshal.UnsafeAddrOfPinnedArrayElement(a, 1).ToInt64() - Marshal.UnsafeAddrOfPinnedArrayElement(a, 0).ToInt64());
            }
            finally { pin.Free(); }
        }

        unsafe static void Main(string[] args)
        {
            Console.WriteLine("sizeof:       " + sizeof(A));
            Console.WriteLine("SizeOf:       " + Marshal.SizeOf(typeof(A)));
            Console.WriteLine("aligned size: " +  AlignedSizeOf(typeof(A)));
            Console.WriteLine("mars algn sz: " + MAlignedSizeOf(typeof(A)));
        }
    }
} 
```

x86 或 x64 上的哪些输出`6, 6, 6,`**`8`**（请注意本机 AlignedSizeOf 有何不同？）。

所以问题是：

1.  讨论：为什么这个对齐大小与正常大小不同？在 C/C++ 中 sizeof() 是完全对齐的值。（`sizeof(arr)/sizeof(arr[0])`总是有效）
2.  是否有一种托管方式（有或没有不安全代码）来获得 blittable 通用结构的对齐大小？
3.  我应该只使用`SizeOf()`而不关心这个额外的对齐吗？在那种情况下，我可能只是在进行块转移......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T00:19:22.847

您必须选择选项 3，您也无权访问 StructureToPtrNative()。您可以使用 Marshal.StructureToPtr() 来复制值类型值，并且还要求您使用 Marshal.SizeOf() 来测量它。

这就是降压停止的地方。至于其他问题，CLR 用于内部存储的确切布局规则非常不寻常，并且很难进行逆向工程。存储在数组中的示例结构的大小确实为 8，添加了两个额外的填充字节。只需要 6 个即可使所有字段正确对齐。不知道为什么会这样，太埋没在 CLR 内部。如果您想尝试使用调试器在实践中看到这一点，那么[这个答案](https://stackoverflow.com/a/5241493/17034)将向您展示如何做到这一点。

```
 static void Main(string[] args) {
        var arr = new A[] { new A() { a = 1, x = 2, b = 3}, new A { a = 0x11, x = 0x12, b = 0x13 }};
    }  // <== set breakpoint here 
```

并在调试器内存窗口的地址框中输入“&arr”得到

```
 0x000000001D67DE70  98 73 14 03 00 00 00 00 01 00 02 00 03 00 00 00 11 00 12 00 13 00 00 00 
                                             ^ arr[0]                ^ arr[1] 
```

# ruby - “each”、“foreach”、“collect”和“map”有什么区别？

> ID：15844371
> 
> 赞同：3
> 
> 时间：2013-04-05T22:03:15.610
> 
> 标签：ruby, loops, enums, iterator, iteration

似乎有很多方法可以在 Ruby 中遍历 Enumerable。`each`, `foreach`, 或 in `collect`,`map`或其他类似方法之间有什么区别吗？

或者有什么理由我不应该在某些情况下使用某些方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:12:40.560

`collect`/`map`是等价的。它们的不同之处`each`在于`each`只为每个元素执行块，而`collect`/`map`返回一个数组，其中包含为每个元素调用块的结果。另一种说法可能是，`each`期望对每个元素*做*一些事情，而`map`期望对每个元素进行*转换*（将其映射到其他东西上）。

您可以使用`collect`或使用`map`任何地方`each`，并且您的代码仍然可以工作。但它的效率可能会稍低一些，因为它将结果收集在一个数组中，除非您的 Ruby 实现意识到它不必费心创建一个数组，因为它从未使用过。

使用`each`代替`map`or的另一个原因`collect`是帮助任何阅读您的代码的人。如果我看到`each`了，那我就可以了，我们将使用数据的每个元素来做一些事情。如果我看到`map`了，那么我希望看到基于旧数据的重新映射创建新数据。

关于`map`vs.`collect`我想说这是一个偏好问题，但你应该选择一个并坚持下去以保持一致性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:10:06.117

`Array#collect`(and `Array#map`) 根据块中传递的代码返回一个新数组。 `Array#each`对数组的每个元素执行操作（由块定义）。

我会这样使用`collect`：

```
array = [1, 2, 3]
array2 = array.collect {|val| val + 1}

array.inspect # => "[1, 2, 3]"
array2.inspect # => "[2, 3, 4]" 
```

像这样`each`：

```
array = [1, 2, 3]
array.each {|val| puts val + 1 }
# >> 2
# >> 3
# >> 4
array.inspect # => "[1, 2, 3]" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T22:12:14.760

使用`pry`and `Rubinus`（更容易阅读 ruby​​ 代码）自己看看

```
$ pry
[1] pry(main)> cd Enumerable
[2] pry(Enumerable):1> show-method collect

From: .../rbx-head/kernel/common/enumerable18.rb @ line 4:
Owner: Enumerable
Visibility: public
Number of lines: 9

def collect
  if block_given?
    ary = []
    each { |o| ary << yield(o) }
    ary
  else
    to_a
  end
end

[3] pry(Enumerable):1> show-method map

From: .../rbx-head/kernel/common/enumerable18.rb @ line 4:
Owner: Enumerable
Visibility: public
Number of lines: 9

def collect
  if block_given?
    ary = []
    each { |o| ary << yield(o) }
    ary
  else
    to_a
  end
end
[4] pry(Enumerable):1> 
```

所以不适合这两个。

`map`并`collect`遍历一个集合。对于每个对象，它执行你的块然后收集结果。`each`方法不收集结果

# css - CSS3 颜色的精确语法

> ID：15844375
> 
> 赞同：1
> 
> 时间：2013-04-05T22:03:24.043
> 
> 标签：css, syntax, colors

我找不到 CSS3 颜色合法语法的精确定义，无论是正则表达式、BNF 还是任何可能存在的严格的正式定义。一些信息可以从[CSS3 颜色模块](http://www.w3.org/TR/2003/CR-css3-color-20030514/)中的口头描述中得出（例如，逗号分隔的列表可能包含空格），但我不知道例如前导零是否像

```
rgb(010,005,255)
rgba(050%,1%,01%,0) 
```

实际上是合法的，或者省略小数的前导零，例如

```
rgba(100,100,100,.5) 
```

我不是在谈论浏览器可以容忍什么，我是在问这是否是官方合法的 CSS3 语法，因为我也对在非浏览器应用程序中使用这些颜色定义感兴趣。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T14:43:19.957

正如您已经发现的那样，[CSS3 颜色模块](http://www.w3.org/TR/2003/CR-css3-color-20030514/)规范说

*函数符号中 RGB 值的格式为 'rgb(' 后跟以逗号分隔的三个数值（三个整数值或三个百分比值）列表，后跟 ')'*

但是你需要查看[CSS 2.1 的基本数据类型部分](http://www.w3.org/TR/CSS21/syndata.html#numbers)来找出整数或百分比值是什么，它说...

*某些值类型可能具有整数值（用 表示）或实数值（用 表示）。实数和整数仅以十进制表示法指定。An由一个或多个数字“0”到“9”组成。A 可以是 ，也可以是零个或多个数字，后跟一个点 (.)，后跟一个或多个数字。整数和实数前面都可以用“-”或“+”表示符号。-0 相当于 0，不是负数。*

所以整数和数字可以有前导零。

然后稍后在基本数据类型上说

*百分比值的格式（在本规范中表示为）是紧随其后的 '%'。*

所以百分比也可以有前导零。

# asp.net-mvc - 扫描站点中的所有操作

> ID：15844380
> 
> 赞同：1
> 
> 时间：2013-04-05T22:04:06.830
> 
> 标签：asp.net-mvc, asp.net-mvc-4, navigation

如何为站点中的所有操作创建操作链接？
我想将这些操作链接放入菜单系统中。

我希望我能做类似的事情

```
foreach controller in controllers {
    foreach action in controller{
        stringbuilder.writeline(
            "<li>"+actionlink(menu, action, controller)+"<li>"
        );
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T15:22:21.423

这是我的看法：

```
var controllers = Assembly.GetCallingAssembly().GetTypes().Where(type => type.IsSubclassOf(typeof(Controller))).ToList();
var controlList = controllers.Select(controller =>
                                     new
                                     {
                                         Actions = GetActions(controller),
                                         Name = controller.Name,
                                     }).ToList(); 
```

方法`GetActions`如下：

```
public static List<String> GetActions(Type controller)
{
    // List of links
    var items = new List<String>();

    // Get a descriptor of this controller
    var controllerDesc = new ReflectedControllerDescriptor(controller);

    // Look at each action in the controller
    foreach (var action in controllerDesc.GetCanonicalActions())
    {
        // Get any attributes (filters) on the action
        var attributes = action.GetCustomAttributes(false);

        // Look at each attribute
        var validAction =
            attributes.All(filter => !(filter is HttpPostAttribute) && !(filter is ChildActionOnlyAttribute));

        // Add the action to the list if it's "valid"
        if (validAction)
           items.Add(action.ActionName);
    }
    return items;
} 
```

如果您需要菜单系统检查[MVC Sitemap Provider](https://github.com/maartenba/MvcSiteMapProvider)，它将根据您在成员资格实施中定义的角色让您绝对控制要呈现的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:46:09.203

这是如何从控制器[Asp.net Mvc 获取所有操作的方法：列出具有特定属性的控制器上的所有操作](https://stackoverflow.com/questions/1358170/asp-net-mvc-list-all-the-actions-on-a-controller-with-specific-attribute)或[访问 ASP.NET MVC 应用程序中的控制器/操作列表](https://stackoverflow.com/questions/790464/accessing-the-list-of-controllers-actions-in-an-asp-net-mvc-application) 为了实现您的目标，您应该在您的使用并过滤来自第二个链接的每个控制器调用的`Assembly.GetExportedTypes()`子类和子类。`ControllerBase``new ReflectedControllerDescriptor(typeof(TController)).GetCanonicalActions()`

# r - 带有可选参数的 R 函数来保存文件

> ID：15844381
> 
> 赞同：1
> 
> 时间：2013-04-05T22:04:09.530
> 
> 标签：r, function

我正在尝试使用可选参数在 R 中创建一个用户定义的函数，以将绘图保存为 pdf。我有默认为 FALSE 的必需参数。如果为 TRUE，则使用 filename.pdf 保存为 pdf。我是否有一些语法错误：

```
seeplot <-function (save=FALSE) {
x <- seq(1,10,1)
y <- x^2
plot (x,y,type="l")
if (save==TRUE) pdf(file="save")
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T22:17:29.917

我认为`?pdf`你遇到麻烦是因为没有仔细阅读。我会让你有点挣扎（因为挣扎很好，射击我经常和 R 战斗）但我认为逻辑保存方法可能不是最好的，所以我会插话。这是我看到的 3 个错误：

1.  你打电话给 pdf 但在那之后再也没有绘图
2.  你从不说`dev.off`
3.  pdf没有文件扩展名

这是您修复的功能：

```
seeplot <-function (save=FALSE) {
    x <- seq(1,10,1)
    y <- x^2
    plot (x,y,type="l")
    if (save) {
        pdf(file="save.pdf")
        plot (x,y,type="l")
        dev.off()
    }
} 
```

但是我可以建议提供文件名而不是逻辑保存。这允许用户随意命名文件：

```
seeplot <-function (file=NULL) {
    x <- seq(1,10,1)
    y <- x^2
    plot (x,y,type="l")
    if (!is.null(file)) {
        pdf(file=file)
        plot (x,y,type="l")
        dev.off()
    }
} 
```

# c# - 如何克隆一个 RectangleF

> ID：15844382
> 
> 赞同：1
> 
> 时间：2013-04-05T22:04:09.577
> 
> 标签：c#, copy, geometry, clone, system.drawing

如何`RectangleF`在 C# 中轻松克隆（复制）a？

显然有一些不优雅的方法可以做到这一点，例如`new RectangleF(r.Location, r.size)`，但肯定有`.Copy`or`.Clone`方法隐藏在某处吗？但是这些都没有为我编译，似乎也没有复制构造函数。我怀疑有一些简单的、C# 标准的复制任何结构的方法，但我还没有找到。

万一这很重要，我的真正目标是创建一个返回矩形偏移版本的方法（因为，令人惊讶的是，`RectangleF`它没有内置的 - 它只有一个 mutator 方法）。我对此的最佳尝试是：

```
public static RectangleF Offset(RectangleF r, PointF offset) {
    PointF oldLoc = r.Location;
    return new RectangleF(new PointF(oldLoc.X+offset.X, oldLoc.Y+offset.Y), r.Size);
} 
```

（由于 令人震惊地缺少加法运算符而变得比它应该的更丑`PointF`，但这是另一个问题。）有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:14:22.613

RectangleF 是一个结构，即一个值类型。考虑以下：

```
public class Program
{
    struct S
    {
        public int i;
    }

    static void Main(string[] args)
    {
        S s1 = new S();
        S s2 = s1;

        s1.i = 5;

        Console.WriteLine(s1.i);
        Console.WriteLine(s2.i);
    }
} 
```

输出是：

```
5
0 
```

因为 S 是一个结构，即 s2 是 s1 的副本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T22:14:02.910

A`Rect`是一个结构体，一个值类型。

要克隆它，只需将其分配给一个新变量。

# c++ - 将python编译成共享库

> ID：15844383
> 
> 赞同：6
> 
> 时间：2013-04-05T22:04:11.057
> 
> 标签：c++, python, c, compiler-construction

我有一堆 python 代码，我想将它们“编译”成一个带有 C 接口的共享库，该接口可以与其他 C/c++ 程序链接，并且可以在不依赖太多其他库的情况下工作（可能是 python 和其他一些 dll，但是它们都应该包含在具有最终库的目录中）。

我真的不想为此将python代码重写为C++。我当然可以，但最好有一个独立的库，可以像 dll/so 库一样使用。

我已经尝试过 cython 并想将 python 编译为 C，然后将 C 代码编译为 dll，但这似乎还不能正常工作（我还不能让它完美地工作）。然后我也尝试了 bbfreeze - 但是 bbfreeze 是否支持创建 .so 文件？无法找出如何做到这一点。有人知道吗？

你知道其他更直接的选择吗？python代码只需要编译一次。最重要的是，如果它创建一个 .so 文件，无论它有多大，它都可以在没有太多依赖项的情况下正常工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-25T21:03:51.327

您可以在 C++ 应用程序中将 Python 用作库：它称为[Python/C API](https://docs.python.org/3.5/c-api/index.html)。

这个想法是您初始化自己的解释器，然后在其中加载脚本。您可以通过 Python 解释器中的全局变量或模块公开您的 C++ 对象，以便您的代码与之交互，您可以直接从 C++ 代码运行 Python 函数。

现在，我了解到您可能希望将 Python 脚本嵌入到共享库中：对于传统的 GNU 工具链，这不一定是一件容易的事。有[多种技术](https://stackoverflow.com/questions/327609/include-binary-file-with-gnu-ld-linker-script)可以实现这一点，但没有一种是官方的，而且与仅将脚本放在外部文件中相比，所有技术似乎都过于复杂。

如果您的目标是对最终用户隐藏脚本，您可以使用私钥对其进行签名或加密，并将公钥嵌入您的库中，但请记住，任何有足够动力的人都可以轻松检索到该密钥.

# .htaccess - 我如何确保我的网站始终有 https infront

> ID：15844386
> 
> 赞同：-1
> 
> 时间：2013-04-05T22:04:17.050
> 
> 标签：.htaccess

嘿伙计们，我有以下 .htaccess 代码：

```
RewriteEngine On
    RewriteCond %{HTTP_HOST} !^www.site.com$ [NC]
    RewriteRule ^(.*)$ https://www.site.com/$1 [L,R=301] 
```

这将始终确保我的 ssl 正确显示，但出于某种原因，如果您要搜索该站点并单击其子类别（例如服务），请在 google 上进行。它只是将您带到站点的服务并在没有 https 的情况下显示它，所以它只是变成 www.....

我该如何解决？

大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:27:22.460

您正在使用的 rewritecond 阻止带有 www 的网址（例如 http://www.site.com/page.html）被重定向

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://www.site.com%{REQUEST_URI} [R=301,L] 
```

# css - 颠倒CSS中有序列表计数器的顺序

> ID：15844387
> 
> 赞同：2
> 
> 时间：2013-04-05T22:04:29.043
> 
> 标签：css

我有一个片段可以让您更好地理解我的问题：

```
$(window).load(function() {
  var total;

  $(document).ready(function() {
    $('#dupe').click(function() {
      $('#uploadForms').prepend($('#htmlTemplate').html());
      $($('#uploadForms .upload_form')[0]).animate({
        height: $($('#uploadForms .upload_form')[$('#uploadForms .upload_form').size() - 1]).css('height'),
        opacity: 1
      }, 500);
      totalForms();

      $(".upload_form").each(function() {
        if (typeof $(this).find('a.close')[0] === 'undefined') {
          if ($('#uploadForms .upload_form').size() > 1) $(this).prepend('<a class="close">x</a>');
        }
      });

      $(".upload_form").on("click", ".close", function() {
        $(this).parent().animate({
          height: 0,
          opacity: 0,
          paddingTop: 0,
          paddingBottom: 0
        }, 500, function() {
          $(this).parent().remove();
          totalForms()
        });
        if ($('#uploadForms .upload_form').size() - 1 <= 1) $('#uploadForms .upload_form').find('a.close').remove();
      });
    });

    function totalForms() {
      total = $('#uploadForms .upload_form').size();
      $('#total').html(total);
    }
  });
});
```

```
.upload_form {
  background-color: rgba(0, 0, 0, .3);
  padding: 16px 64px 10px 76px;
  border-bottom-left-radius: 15px;
  border-bottom-right-radius: 15px;
  margin-bottom: 10px;
}
.coverArt {
  margin-right: 48px;
  margin-bottom: 36px;
}
label input,
label textarea {
  width: 252px;
}
.info {
  display: block;
  vertical-align: top;
}
.close {
  float: right;
  color: white;
  margin: 10px;
  display: block;
  cursor: hand;
  border-radius: 100%;
  cursor: pointer;
  width: 18px;
  height: 18px;
  text-align: center;
  -moz-user-select: none;
  -webkit-user-select: none;
}
.close:hover {
  background-color: rgba(0, 0, 0, 0.5);
}
ol {
  counter-reset: li;
  margin-left: 0;
  padding-left: 0;
}
ol > li {
  position: relative;
  margin: 0 0 6px 2em;
  padding: 0px 0px 8px;
  list-style: none;
  border-top: 2px solid #666;
}
ol > li:before {
  content: counter(li);
  counter-increment: li;
  position: absolute;
  top: -2px;
  left: -2em;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  width: 2em;
  margin-right: 8px;
  padding: 4px;
  border-top: 2px solid #666;
  color: #fff;
  background: #666;
  font-weight: bold;
  font-family: "Helvetica Neue", Arial, sans-serif;
  text-align: center;
}
li ol,
li ul {
  margin-top: 6px;
}
ol ol li:last-child {
  margin-bottom: 0;
}
.template {
  display: none
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<input type="button" value="Add file..." id="dupe">
<input type="button" value="Upload file(s)" id="dupe">

<hr>

<p>Total: <span id="total">1</span></p>

<div id="htmlTemplate" class="template">
  <li>
    <div class="upload_form" style="height:0;opacity:0;">
      <span class="number"></span>
      <a class="close">x</a>
      <div class="info">
        <p>Filler</p>
      </div>
    </div>
  </li>
</div>

<ol id="uploadForms">
  <li>
    <div class="upload_form">
      <span class="number"></span>
      <a class="close">x</a>
      <div class="info">
        <p>Filler</p>
      </div>
    </div>
  </li>
</ol>
```

在此演示中，如果您单击“添加文件...”，则会添加一个新的列表元素，其中包含一个新的`<div>`内部元素。我的问题是：如何反转计数器的顺序？

相关CSS：

```
ol {
    counter-reset:li;
}
ol > li {
    position:relative;
    margin:0 0 6px 2em;
    padding: 0px 0px 8px;
    list-style:none;
    border-top:2px solid #666;
}
ol > li:before {
    content: counter(li);
    counter-increment:li;
    position:absolute;
    top:-2px;
    left:-2em;
    box-sizing:border-box;
    width:2em;
    margin-right:8px;
    padding:4px;
    border-top:2px solid #666;
    color:#fff;
    background:#666;
    font-weight:bold;
    font-family:"Helvetica Neue", Arial, sans-serif;
    text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:10:36.847

我没有纯 CSS 解决方案，但你的页面已经相当 JS-heavy，所以我认为它会好起来的。

对于`li`添加

```
counter-increment: li -1; 
```

让它倒数。这意味着它不能重置为 0，但它必须重置为总元素。

从`ol`开始

```
counter-reset:li 2; 
```

然后更新你的 JS：

```
$('#total').html(total);
$("ol").css('counter-reset', 'li ' + (+total + 1)); 
```

[http://jsfiddle.net/ExplosionPIlls/ArZUW/1/](http://jsfiddle.net/ExplosionPIlls/ArZUW/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:55:12.933

这是另一种与 Explosion Pills 非常相似的解决方案：http: [//jsfiddle.net/pN6Fx/](http://jsfiddle.net/pN6Fx/)

## CSS

```
ol{
    list-style-type: none;
    list-style-position: inside;
}
li:before{
    content: counter(list-items) '. ';
    counter-increment: list-items -1;
} 
```

## HTML

```
<ol style="counter-reset: list-items 5;">
    <li>An element</li>
    <li>An element</li>
    <li>Another element</li>
    <li>A third element</li>
</ol> 
```

您只需要`counter-reset`通过 JavaScript 更新属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:12:31.317

在此页面[http://www.impressivewebs.com/reverse-ordered-lists-html5/](http://www.impressivewebs.com/reverse-ordered-lists-html5/)之后存在元素的`reversed`属性。`<ol>`

够糟糕的，我不明白是否支持

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-23T03:30:06.943

如果您正在寻找纯 css 解决方案并[支持带有 Flexbox 的浏览器](http://caniuse.com/#search=flexbox)，您可以利用该`flex-direction`属性来反转列表项的顺序。

这将给出一个反向列表的外观，但 DOM 顺序实际上不会改变。

# algorithm - 在 Robinson Projection 中将图像坐标从/到纬度/经度表示转换

> ID：15844393
> 
> 赞同：0
> 
> 时间：2013-04-05T22:04:47.263
> 
> 标签：algorithm, math, map, coordinates, projection

我有一张带有世界地图的图像（在 Robinson 投影中显示世界），我需要使用纬度/经度找到相应的坐标（x/y），反之亦然。出于某种原因，我设法找到了其他预测的实现，但没有找到 Robinson。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:42:48.813

你看过[Proj.4](http://trac.osgeo.org/proj/)吗？它包括罗宾逊投影的源代码，但我不知道如何破译宏；但就它的价值而言，它就在[这里](http://trac.osgeo.org/proj/browser/trunk/proj/src/PJ_robin.c?rev=2311)。

# javascript - 具有动态添加不行为的项目的淘汰赛映射网格

> ID：15844396
> 
> 赞同：0
> 
> 时间：2013-04-05T22:04:57.420
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin, knockout-2.0

我有一个很好的淘汰视图模型，其列表显示为网格。我确实使用映射插件。

您可以选择项目、反向选择、从列表中删除项目以及动态添加项目。

但是，如果我确实添加了一个项目，我将无法删除它或任何其他项目。此外，如果我添加另一个它不会显示。但是计算值确实显示了额外的行

这是隔离问题的小提琴：

[http://jsfiddle.net/medo/7jrnb/](http://jsfiddle.net/medo/7jrnb/)

```
self.add = function () {
    self.orderLines.push(ko.mapping.fromJS({ Sku: "", Qty: 1, Name: "", OriginalSKU: "", Description: "", Exists: false, Selected:false })); 
```

};

删除和选择项目，一切都很好。按添加项目和删除不起作用。再次按 add 也是一个意想不到的结果。

knockout-2.2.1.js Knockout Mapping 插件 v2.4.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:37:46.157

在您的`add`函数中，您拼写错误`OriginalSku`为`OriginalSKU`（不同的大小写）。这会导致绑定失败，并且似乎会阻止敲除工作。修正拼写，一切就绪。

# jquery - jQuery单张图片幻灯片放映问题

> ID：15844397
> 
> 赞同：0
> 
> 时间：2013-04-05T22:05:09.680
> 
> 标签：jquery, slideshow

因此，我目前正在尝试构建一个具有由导航选项卡控制的巨型单张图片幻灯片的网站。当您使用 jQuery 单击特定导航菜单选项卡时，我试图让网站将图像（如幻灯片放映）移动到特定位置。出于某种原因，什么都没有发生。我几乎可以肯定代码是正确的，但也许有什么地方不对？...idk？帮助！

这是当前站点的链接：http: [//mindhandle.com/UMCsite_v2/](http://mindhandle.com/UMCsite_v2/)

现在，只有“媒体”选项卡是 jQuery 的目标。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:11:38.727

您提供的页面上存在脚本错误：`$ is not defined`。

![在此处输入图像描述](https://i.stack.imgur.com/4NuYS.png)

您需要在调用 jQuery 脚本`SS.js` ***之后调用。***

在您的`head`中，将顺序更改为以下内容：

```
<script src="js/jquery-1.9.1.min.js"></script>
<script src="js/jquery-migrate-1.1.1.min.js"></script>
<script type="text/javascript" src="js/SS.js"></script> 
```

* * *

`marginLeft`并且`margin-left`都是有效的：

`.animate()`使用`marginLeft`演示：http: [//jsfiddle.net/dirtyd77/3FkLW/2/](http://jsfiddle.net/dirtyd77/3FkLW/2/)

`.animate()`使用`margin-left`演示：http: [//jsfiddle.net/dirtyd77/3FkLW/3/](http://jsfiddle.net/dirtyd77/3FkLW/3/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-05T22:09:47.623

而不是设置边距使用左侧和顶部。

您必须设置位置：相对于图像

# sql - 计数（*），区别和列

> ID：15844398
> 
> 赞同：-3
> 
> 时间：2013-04-05T22:05:23.103
> 
> 标签：sql, sql-server, tsql

如何在 sqlserver 中完成这样的操作

```
select firstname,count(*) from
(select distinct firstname,lastname,amount 
from emp)
group by firstname 
```

这适用于甲骨文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:07:17.467

我不明白你想做什么，但你的查询可以这样写：

```
SELECT firstname, COUNT(*) 
FROM emp
GROUP BY firstname; 
```

**或者：**

```
select firstname, count(*) 
from 
(
  select distinct firstname, lastname, amount 
  from emp
) AS t
group by firstname; 
```

您也可以在;中使用`DISTINCT`关键字。`COUNT`像这样：`COUNT(DISTINCT columnanme)`相反。

* * *

**或者：**

```
select firstname, lastname, amount, COUNT(*)
from emp
group by firstname, lastname, amount; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:09:36.937

这是我工作的一些东西的一个例子，它们基本上做同样的事情：

```
SELECT SYS_CSL, COUNT(SYS_CSL)
FROM (
    SELECT SYS_CSL 
    FROM [VANTAGE_READ].CSL_SERV_RANK
    WHERE AGNT_CSL = 0
    AND (STOP_DTE_CSL > GETDATE() OR STOP_DTE_CSL IS NULL)
    ) t1 GROUP BY sys_csl 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:15:31.307

您需要命名派生表

```
select firstname, count(*)  
from  (select distinct firstname,lastname,amount from emp) derived 
group by firstname 
```

# html - 以编程方式更改 Fusion 表卡布局

> ID：15844401
> 
> 赞同：2
> 
> 时间：2013-04-05T22:05:29.403
> 
> 标签：html, google-apps-script, google-fusion-tables, google-drive-api

在使用 Fusion Tables 和 Google Apps Script 创建员工数据库时，我试图尽可能地利用现有的 Fusion Tables UI。卡片非常有用，但我正在寻找一种可以以编程方式更改其布局的方法。

对于数据库中的每个条目，用户可以上传相关文档并将它们附加到条目中。这些文件存储在谷歌驱动器中，并且该文档的链接存储（作为 html 字符串）在数据库字段之一中。这是一个[简单的图像](https://www.diigo.com/item/image/3toye/g87b?size=o)，它可能看起来像什么以及制作它的[布局代码](https://www.diigo.com/item/image/3toye/dtok?size=o)。

问题是可上传的文件（和字段）是动态的。用户可以通过我的 ui 添加或重新定义这些字段，我需要每张卡上可用文件的完整列表进行相应调整，因此我不必每次都手动配置布局。如何在卡片上创建链接列表？

其他背景资料：

*   融合表只能查看。我还没有想出一种方法来验证融合表 ui 中的数据输入，因此数据输入将以编程方式并在自定义 ui 中完成。
*   我知道我目前的方法不是很健壮，我对通过卡提供对这些文件的访问的其他方法非常开放。我什至玩弄过为每个条目创建一个通用 html 字段的想法，该字段以编程方式创建以显示我想要的内容。我只是希望有更好的方法。

PS 我一直在为发布链接和图像的声誉限制而苦苦挣扎。如果你认为我有信誉，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T18:56:05.120

> 问题是可上传的文件（和字段）是动态的。用户可以通过我的 ui 添加或重新定义这些字段，我需要每张卡上可用文件的完整列表进行相应调整，因此我不必每次都手动配置布局。如何在卡片上创建链接列表？

我可能没有完全关注，但听起来您的应用可以更改每个用户的架构？这就是您的示例信息窗口 HTML 似乎显示的内容。但这需要为每个应用程序用户提供一个单独的表。如果不是这种情况，那么我不清楚您如何使用“字段”一词。

无论如何，Fusion Tables API 确实允许您更改模板内容，这可能会解决您的问题：[https ://developers.google.com/fusiontables/docs/v1/reference/template](https://developers.google.com/fusiontables/docs/v1/reference/template)

# asp.net - 异步/部分回发数据网格问题

> ID：15844403
> 
> 赞同：1
> 
> 时间：2013-04-05T22:05:35.500
> 
> 标签：asp.net, ajax, datagrid, webforms, updatepanel

我正在尝试获取一个 aspx 数据网格控件来执行导致部分回发（异步）而不是完整回发的帖子。我添加了脚本管理器、更新面板和内容模板包装器，但当我选择数据项并单击添加时，它仍会刷新页面。

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePartialRendering="True" ></asp:ScriptManager>
 <asp:UpdatePanel ID="upPnlLookup" runat="server" UpdateMode="Conditional" ChildrenAsTriggers="True">
        <ContentTemplate>
            <asp:DataGrid ID="ObjectPropertiesDataGrid" CellPadding="5" CellSpacing="5" OnItemCommand="ObjectPropertiesDataGrid_ItemCommand" OnItemDataBound="ObjectPropertiesDataGrid_ItemDataBound" AutoGenerateColumns="False" CssClass="List" DataKeyField="id" runat="server">
              <asp:TemplateColumn>
               <ItemTemplate>
                 <asp:Panel ID="multiValuePanel" Visible="false" runat="server">
                        <table>
                           <tr>
                             <td valign="top">
                                 <asp:Button ID="addButton" CssClass="button" CommandName="AddValue" Width="65px" Text="Add" runat="server"></asp:Button>
                                 <asp:Button ID="addAllButton" CssClass="button" CommandName="AddAllValue" Width="85px" Text="Add All" runat="server"></asp:Button>
                                 <br />
                                <asp:ListBox ID="listBoxValues" Width="250px" CssClass="listbox" SelectionMode="Multiple"  runat="server"></asp:ListBox>
                              </td>
                              <td valign="top">
                                <asp:Button ID="removeButton" CssClass="button" Text="Remove" Width="65px" CommandName="RemoveValue"   runat="server"></asp:Button>
                                <asp:Button ID="removeAllButton" CssClass="button" Text="Remove All" Width="85px" CommandName="RemoveAllValue" runat="server"></asp:Button>
                                  <br />
                               <asp:ListBox ID="listBoxCurrentValues" Width="250px" CssClass="listbox" SelectionMode="Multiple" runat="server"></asp:ListBox>
                              </td>                                         
                             </tr>
                       </table>
               </asp:Panel>
        </ItemTemplate>
  </asp:TemplateColumn>
</asp:DataGrid>
</ContentTemplate>
     <Triggers>
         <asp:AsyncPostBackTrigger ControlID="addButton" EventName="Click" />
         <asp:AsyncPostBackTrigger ControlID="removeButton" EventName="Click" />
         <asp:AsyncPostBackTrigger ControlID="addAllButton" EventName="Click" />
         <asp:AsyncPostBackTrigger ControlID="removeAllButton" EventName="Click" />
     </Triggers>
</asp:UpdatePanel> 
```

代码背后（片段/相关方法）：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        SaveButton.Click += SaveButton_Click;
        btnAddChild.Click += btnAddChild_Click;
        btnAddChildTop.Click += btnAddChildTop_Click;
        DeleteButton.Click += DeleteButton_Click;
        CancelButton.Click += CancelButton_Click;
        CopyButton.Click += CopyButton_Click;
        NewButton.Click += NewButton_Click;
        AddSiteButton.Click += AddSiteButton_Click;
        RemoveSiteButton.Click += RemoveSiteButton_Click;
        ActivateAll.Click += ActivateAll_Click;
        DeactivateAll.Click += DeactivateAll_Click;
        startDateCalender.SelectionChanged += startDateCalender_SelectionChanged;
        endDateCalender.SelectionChanged += endDateCalender_SelectionChanged;
        startDateCalender.Load += startDateCalender_Load;
        endDateCalender.Load += endDateCalender_Load;
        CacheButton.Click += CacheButton_Click;

        if (IsPostBack)
            return;
        if (String.IsNullOrEmpty(Request["id"]))
        {
            Response.Redirect("default.aspx");
        }
        else
        {
            LoadData();
        }
    }

    private void LoadData()
    {
        Properties = ContentProviderFactory.GetContentProvider().GetObjectTypeProperties(CurrentContentObject.Type, false);
        uploadImage.DataSource = DataHelper.GetObjecTypeImageSizes(CurrentContentObject.Type);
        uploadImage.Container = CurrentContentObject;

        foreach (var property in from Property p in Properties
                               let objectProperty = CurrentContentObject.GetProperty(p.Id)
                               where objectProperty == null
                               select p)
        {
            CurrentContentObject.Items.Add(property);
        }

        ObjectPropertiesDataGrid.DataSource = Properties;
        var children = ContentProviderFactory.GetContentProvider().GetContentObjectChildren(CurrentContentObject.Id);

        dgObjectChildren.DataSource = children.Where(c => c.Active);
        dgObjectInactiveChildren.DataSource = children.Where(c => !c.Active);

        dgObjectParents.DataSource = ContentProviderFactory.GetContentProvider().GetContentObjectParents(CurrentContentObject);
        ddlContentTypes.DataSource = ContentProviderFactory.GetContentProvider().GetContentObjectTypes(CurrentContentObject.Type);
        ddlContentTypesTop.DataSource = ContentProviderFactory.GetContentProvider().GetContentObjectTypes(CurrentContentObject.Type);

        SitesListBox.DataSource = ContentProviderFactory.GetContentProvider().GetContentObjectSitesAvailable(CurrentContentObject.Id);
        SetSitesListBox.DataSource = ContentProviderFactory.GetContentProvider().GetContentObjectSites(CurrentContentObject.Id);

        if (CurrentContentObject.Id == 0)
        {
            Response.Status = "301 Moved Permanently";
            Response.AddHeader("Location", "/admin/Contentobjects/ObjectNotFound.aspx");
            Response.End();
        }

        const string DATE_FORMAT = "MM/dd/yyyy";

        if (CurrentContentObject.StartDate.ToString(DATE_FORMAT) != SqlDateTime.MinValue.Value.ToString(DATE_FORMAT))
        {
            startDateTextBox.Text = CurrentContentObject.StartDate.ToShortDateString();
        }
        if (CurrentContentObject.EndDate.ToString(DATE_FORMAT) != SqlDateTime.MaxValue.Value.ToString(DATE_FORMAT))
        {
            endDateTextBox.Text = CurrentContentObject.EndDate.Date.ToShortDateString();
        }

        DataBind();

        //if its an orphan child/child, remove 'add child' button and pulldown
        if (ddlContentTypes.Items.Count == 0)
        {
            btnAddChild.Visible = false;
            ddlContentTypes.Visible = false;
        }
        if (ddlContentTypesTop.Items.Count == 0)
        {
            ddlContentTypesTop.Visible = false;
            btnAddChildTop.Visible = false;
        }

        // Add delete confirmation javascript
        DeleteButton.Attributes["onclick"] = "return confirm_object_delete();";

        RenderTypeHeader();
        RenderBreadcrumb();

        if (CurrentContentObject.ParentId == 0)
        {
            UserInfo.AddToHistory(CurrentContentObject.Id, CurrentContentObject.Name);
        }
        else
        {
            UserInfo.AddToHistory(CurrentContentObject.Parent.Id, CurrentContentObject.Parent.Name);
        }

        startCalenderPanel.Visible = false;
        endCalenderPanel.Visible = false;
    }

        protected void ObjectPropertiesDataGrid_ItemCommand(object sender, DataGridCommandEventArgs e)
    {
        var id = (int)ObjectPropertiesDataGrid.DataKeys[e.Item.ItemIndex];

        switch (e.CommandName.ToLower())
        {
            case "clearimage":
                {
                    // Delete the image (does not physically remove the image but will be replaced if new a new one updates)
                    var imageProperty = e.Item.FindControl("imageProperty") as Image;
                    var tbFileName = e.Item.FindControl("tbFileName") as TextBox;

                    tbFileName.Text = string.Empty;
                    imageProperty.ImageUrl = string.Empty;

                    break;
                }
            case "addvalue":
                {
                    // Adds a property value to the list of properites
                    var listBoxValues = e.Item.FindControl("listBoxValues") as ListBox;
                    var listBoxCurrentValues = e.Item.FindControl("listBoxCurrentValues") as ListBox;

                    foreach(var item in listBoxValues.Items.Cast<ListItem>().Where(item => item.Selected))
                    {
                        // Add item to the set values
                        listBoxCurrentValues.Items.Add(item);
                    }

                    for (var i = listBoxValues.Items.Count - 1; i >= 0; i--)
                    {
                        if (listBoxCurrentValues.Items.FindByValue(listBoxValues.Items[i].Value) != null)
                        {
                            listBoxValues.Items.RemoveAt(i);
                        }
                    }

                    SortListBox(listBoxCurrentValues);
                    break;
                }
            case "removevalue":
                {
                    var listBoxValues = e.Item.FindControl("listBoxValues") as ListBox;
                    var listBoxCurrentValues = e.Item.FindControl("listBoxCurrentValues") as ListBox;

                    for(var i = listBoxCurrentValues.Items.Count - 1; i >= 0; i--)
                    {
                        if(listBoxCurrentValues.Items[i].Selected)
                        {
                            listBoxValues.Items.Add(listBoxCurrentValues.Items[i]);
                            listBoxCurrentValues.Items.RemoveAt(i);
                        }
                    }

                    SortListBox(listBoxValues);
                    break;
                }
            case "addallvalue":
                {
                    var listBoxValues = e.Item.FindControl("listBoxValues") as ListBox;
                    var listBoxCurrentValues = e.Item.FindControl("listBoxCurrentValues") as ListBox;

                    foreach(ListItem item in listBoxValues.Items)
                    {
                        // Add item to the set values
                        listBoxCurrentValues.Items.Add(item);
                    }

                    for(var i = listBoxValues.Items.Count - 1; i >= 0; i--)
                    {
                        if(listBoxCurrentValues.Items.FindByValue(listBoxValues.Items[i].Value) != null)
                        {
                            listBoxValues.Items.RemoveAt(i);
                        }
                    }

                    SortListBox(listBoxCurrentValues);

                    break;
                }
            case "removeallvalue":
                {
                    var listBoxValues = e.Item.FindControl("listBoxValues") as ListBox;
                    var listBoxCurrentValues = e.Item.FindControl("listBoxCurrentValues") as ListBox;

                    for (var i = listBoxCurrentValues.Items.Count - 1; i >= 0; i--)
                    {
                        listBoxValues.Items.Add(listBoxCurrentValues.Items[i]);
                        listBoxCurrentValues.Items.RemoveAt(i);
                    }

                    SortListBox(listBoxValues);

                    break;
                }
            case "addalldatalistvalue":
                {
                    var dataListValues = e.Item.FindControl("DataListValues") as DataList;
                    var dataListCurrentValues = e.Item.FindControl("CurrentDataListValues") as DataList;

                    foreach (DataListItem item in dataListValues.Items)
                    {
                        ImageLink imageLink = ImageLinks[id][item.ItemIndex];
                        CurrentImageLinks[id].Add(imageLink);
                    }

                    for (var i = dataListValues.Items.Count - 1; i >= 0; i--)
                    {
                        if (CurrentImageLinks[id].Contains(ImageLinks[id][i]))
                        {
                            ImageLinks[id].RemoveAt(i);
                        }
                    }

                    dataListValues.DataSource = ImageLinks[id];
                    dataListCurrentValues.DataSource = CurrentImageLinks[id];
                    dataListValues.DataBind();
                    dataListCurrentValues.DataBind();
                    break;
                }
            case "removealldatalistvalue":
                {
                    var dataListValues = e.Item.FindControl("DataListValues") as DataList;
                    var dataListCurrentValues = e.Item.FindControl("CurrentDataListValues") as DataList;

                    for (var i = dataListCurrentValues.Items.Count - 1; i >= 0; i--)
                    {
                        ImageLinks[id].Add(CurrentImageLinks[id][i]);
                        CurrentImageLinks[id].RemoveAt(i);
                    }

                    dataListValues.DataSource = ImageLinks[id];
                    dataListCurrentValues.DataSource = CurrentImageLinks[id];
                    dataListValues.DataBind();
                    dataListCurrentValues.DataBind();

                    break;
                }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T06:21:24.983

我认为您在`Page_Load`. 例如，如果您有此错误代码，您的页面将刷新而不是更新：

```
protected void Page_Load(object sender, EventArgs e)
    {
        if (IsPostBack)
        {
            Response.Redirect("WebForm1.aspx");
            int.Parse("");

        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T05:33:17.370

也试试这个：

```
Control me = FindControl(Request.Params.Get("__EVENTTARGET"));
if(FindControl(me!=addButton && me!=removeButton && me!=addAllButton && me!=removeAllButton)
 {
    if (IsPostBack)
        return;
    if (String.IsNullOrEmpty(Request["id"]))
    {
        Response.Redirect("default.aspx");
    }
    else
    {
        LoadData();
    }
 } 
```

# c# - Where 查询的通用 DBContext

> ID：15844410
> 
> 赞同：4
> 
> 时间：2013-04-05T22:06:11.033
> 
> 标签：c#, asp.net-mvc-3, entity-framework

所以我试图为 where 查询创建一个通用函数，而不是使用存储库，所以可以做这样的事情吗？

```
 public IEnumerable<T> Something<T>(int authorId) where T : class
    {
        return Vmsb.Set<T>().Where(c => c.AuthorId== authorId);

    } 
```

现在我不能，因为它不知道 c.AuthorId 是什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T23:13:52.947

创建一个接口`IHaveAuthor`并使用此属性在部分类上指定它：

```
public interface IHaveAuthor
{
    int AuthorId { get; set; }
}

//Note that the interface is already implemented in auto-generated part.
//Or if it's Code First, just specify it directly on your classes.
public partial class Book : IHaveAuthor
{
}

public partial class Article : IHaveAuthor
{
} 
```

然后将接口指向泛型类型[`where`](http://msdn.microsoft.com/en-us/library/bb384067.aspx)约束下：

```
public IEnumerable<T> GetAuthorPublicationsOf<T>(int authorId) 
    where T : class, IHaveAuthor
{
    return Vmsb.Set<T>().Where(c => c.AuthorId == authorId);
} 
```

以及用法：

```
var authorBooks = query.GetAuthorPublicationsOf<Book>(authorId);
var authorArticles = query.GetAuthorPublicationsOf<Article>(authorId); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T23:30:24.923

添加到[Olexander 的答案](https://stackoverflow.com/a/15845090/176877)中，因为 EF 建议您使用工作单元模式，所以我通常不会在我的方法中假设 DbContext - 我可能会传入最通用的对象。同样作为风格问题，我喜欢返回界面。

**编辑**更新以包括 Olexander 使用 IQueryable 而不是 IEnumerable 的重要修复。

所以我的方法签名看起来像：

```
public IQueryable<IHaveAuthor> Something(int authorId, IQueryable<IHaveAuthor> items)
{
    return items.Where(c => c.AuthorId == authorId);
} 
```

因此，调用它与您当前对它的调用会有些不同 - 大概是这样的：

```
var db = new MyDbContext();
var items = db.Books;
var itemForAuthor1 = Something(1, items); 
```

否则，您的“某事”方法不是非常灵活 - 它假定您当前对象上有一个现有的 DbContext，这可能不是一个安全的假设（因为它只应该在这一小块工作中存在，无论它是什么），您不能将其与其他命令等链接起来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T13:07:32.397

迭戈希望我的代码可以帮助你。

```
 protected List<T> ListAll<T>() where T : class
    {
        using (MyDbContext db = new MyDbContext ()) 
        {
            return db.Set(typeof(T)).Cast<T>().AsNoTracking<T>().ToList();
        }

    }

    protected T ListAllById<T>(int id) where T : class
    {
        using (MyDbContext db = new MyDbContext ()) 
        {
            return db.Set(typeof(T)).Cast<T>().Find(id);
        }
    }

    protected void InsertObj(Object obj)
    {
        using (MyDbContext db = new MyDbContext()) 
        {
            db.Set(obj.GetType()).Add(obj);
            db.SaveChanges();
        }
    }

    protected void UpdateObj(Object obj)
    {    
        try
        {
            using (MyDbContext db = new MyDbContext())
            {
                db.Set(obj.GetType()).Attach(obj);
                db.Entry(obj).State = EntityState.Modified;
                db.SaveChanges();
            }
        }
        catch (System.Exception ex)
        {
            System.Windows.Forms.MessageBox.Show(" " + ex.Message);
        }            
    }

    protected void DeleteObj(Object obj)
    {
        using (MyDbContext db = new MyDbContext ())
        {
            db.Set(obj.GetType()).Attach(obj);
            db.Entry(obj).State = EntityState.Deleted;
            db.SaveChanges();
        }

    } 
```

# c++ - 在通用对象更新循环中，每个控制器或每个对象更新更好吗？

> ID：15844412
> 
> 赞同：2
> 
> 时间：2013-04-05T22:06:21.750
> 
> 标签：c++, performance, templates, c++11

我正在编写一些**通用代码**，它们基本上将有一个由一组控制器更新的对象向量。

该代码在我的特定上下文中有点复杂，但简化为：

```
template< class T >
class Controller
{ 
public:
    virtual ~Controller(){}
    virtual void update( T& ) = 0;
    // and potentially other functions used in other cases than update
}

template< class T >
class Group
{
public:
    typedef std::shared_ptr< Controller<T> > ControllerPtr;

    void add_controller( ControllerPtr );    // register a controller
    void remove_controller( ControllerPtr ); // remove a controller

    void update(); // udpate all objects using controllers

private:

    std::vector< T > m_objects;
    std::vector< ControllerPtr > m_controllers;
}; 
```

我故意不使用 std::function 因为我不能在我的特定情况下使用它。我还故意使用共享指针而不是原始指针，这实际上对我的问题并不重要。

无论如何，我感兴趣的是 update() 实现。我可以通过两种方式做到这一点。

**A)**对于每个控制器，更新所有对象。

```
template< class T >
void Group<T>::update()
{
    for( auto& controller : m_controllers )
        for( auto& object : m_objects )
            controller->update( object );
} 
```

**B)**对于每个对象，通过应用所有控制器进行更新。

```
template< class T >
void Group<T>::update()
{
    for( auto& object : m_objects )
        for( auto& controller : m_controllers )
            controller->update( object );
} 
```

**“测量！测量！测量！”** 你会说，我完全同意，但我无法衡量我不使用的东西。问题是它是通用代码。我不知道T的大小，我只是假设它不会很大，也许很小，也许还是有点大。真的，除了它被设计为包含在向量中之外，我不能对 T 做出太多假设。我也不知道将使用多少个控制器或 T 个实例。在我目前的用例中，会有很大不同的计数。

问题是：***一般来说*****哪种解决方案最有效？**

 *我在这里考虑缓存一致性。此外，我假设此代码将用于不同的编译器和平台。

我的直觉告诉我，更新指令缓存肯定比更新数据缓存更快，这将使解决方案 B) 通常更有效。但是，当我对性能产生怀疑时，我学会了不相信自己的阵风，所以我在这里问。

我得到的解决方案将允许用户选择（使用编译时策略）哪个更新实现与每个 Group 实例一起使用，但我想提供一个默认策略，我无法决定哪个是在大多数情况下最有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:09:16.983

我们有一个活生生的证据证明现代编译器（尤其是英特尔 C++）能够交换循环，所以这对你来说并不重要。

我从伟大的[@Mysticial 的回答](https://stackoverflow.com/a/11227902/752976)中记住了这一点：

> Intel Compiler 11 做了一些神奇的事情。它交换两个循环，从而将不可预测的分支提升到外部循环。因此，它不仅不受错误预测的影响，而且速度也比 VC++ 和 GCC 生成的速度快两倍！

[维基百科关于该主题的文章](http://en.wikipedia.org/wiki/Loop_interchange)

检测是否可以进行循环交换需要检查交换的代码是否真的会产生相同的结果。从理论上讲，可以准备不允许交换的类*，*但话又说回来，可以准备从任一版本中受益更多的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T11:04:55.653

## 缓存友好性接近虔诚

对单个控制器的方法如何表现一无所知`update`，我认为性能中最重要的因素是*缓存友好性*。

考虑到缓存的有效性，两个循环之间的唯一区别是`m_objects`它们是连续布局的（因为它们包含在向量中）并且它们在内存中线性访问（因为循环是有序的）但`m_controllers`只在此处被指向并且它们可以可以在内存中的任何位置，此外，它们可以是具有不同`update()`方法的不同类型，它们本身可以驻留在任何位置。因此，在遍历它们时，我们会在内存中跳跃。

关于缓存，这两个循环的行为如下：（当你关心性能时，事情从来都不是简单直接的，所以请耐心等待！）

*   *循环**A***：内部循环高效运行（除非对象很大 - 数百或数千字节 - 或者它们将数据存储在自身之外，例如`std::string`），因为缓存访问模式是可预测的，并且 CPU 将预取连续的缓存线，因此不会在读取对象的内存时不要太拖延。但是，如果对象向量的大小大于 L2（或 L3）缓存的大小，则外部循环的每次迭代都需要重新加载整个缓存。但同样，缓存重新加载将是有效的！
*   *循环**B***：如果控制器确实有许多不同类型的`update()`方法，这里的内部循环可能会导致内存中的疯狂跳跃，但所有这些不同的更新函数都将处理缓存和可用的数据（特别是如果对象很大或者它们它们本身包含指向分散在内存中的数据的指针。）除非`update()`方法本身访问这么多内存（例如，因为它们的代码*很大*或者它们需要大量自己的 - 即控制器 - 数据），否则它们在每次调用时都会破坏缓存；在这种情况下，无论如何，所有的赌注都是关闭的。

因此，我通常建议以下策略，这需要您可能*没有*的信息：

*   如果对象很小（或很小！）并且类似 POD（本身不包含指针）肯定更喜欢*循环**A***。
*   如果对象很大和/或复杂，或者如果有许多不同类型的复杂控制器（数百或数千种不同的方法） ，则`update()`首选*循环**B。***
*   如果对象很大和/或复杂，并且它们太多以至于迭代它们会多次颠簸缓存（数百万个对象），并且`update()`方法很多，它们非常大和复杂，需要很多其他数据，那么我会说循环的顺序没有任何区别，您需要考虑重新设计对象和控制器。

## 对代码进行排序

如果可以的话，*根据控制器的类型对控制器进行排序*可能会有所帮助！您可以使用某种内部机制`Controller`或类似的东西`typeid()`或其他技术根据控制器的类型对控制器进行排序，因此连续`update()`传递的行为变得更加规律、可预测和良好。

*无论您选择实现哪种循环顺序，这都是一个好主意，但它在循环**B***中会产生更大的影响。

但是，如果控制器之间的差异很大（即如果实际上所有控制器都是唯一的），这将无济于事。此外，显然，如果您需要保留应用控制器的顺序，您将无法执行此操作。

## 适应和即兴创作

实现这两种循环策略并在*编译时*（甚至运行时）根据用户提示或基于编译时可用的信息（例如 的大小`T`或`T`; 如果 T 很小并且/ 或 POD，您可能应该使用*循环**A***。）

您甚至可以在运行时执行此操作，根据对象和控制器的数量以及您可以找到的任何其他信息来决定。

但是，这些类型的“Klever”技巧可能会给您带来麻烦，因为您的容器的行为将取决于奇怪、不透明甚至令人惊讶的启发式和黑客攻击。此外，在某些情况下，它们可能甚至会损害性能，因为还有许多其他因素会影响这两个循环的性能，包括但不限于数据的性质以及对象和控制器中的代码、确切的大小和配置缓存级别及其相对速度、CPU 架构及其处理预取、分支预测、缓存未命中等的确切方式，编译器生成的代码等等。

如果您想使用这种技术（实现两个循环并在它们之间切换是编译和/或运行时），我强烈建议您让用户进行选择。您可以接受有关使用哪种更新策略的提示，作为模板参数或构造函数参数。您甚至可以拥有两个用户可以随意调用的更新函数（例如`updateByController()`和）。`updateByObject()`

## 关于分支预测

这里唯一有趣的分支是虚拟`update`调用，作为通过两个指针（指向控制器实例的指针，然后是指向其 vtable 的指针）的间接调用，很难预测。但是，根据类型对控制器进行排序将对此有很大帮助。

还要记住，错误预测的分支会导致几到几十个 CPU 周期的停顿，但对于高速缓存未命中，停顿将达到数百个周期。当然，错误预测的分支也可能导致缓存未命中，所以...正如我之前所说，就性能而言，没有什么是简单明了的！

无论如何，我认为缓存友好性是迄今为止影响性能的最重要因素。*

# python - 模板文件 VS. Django中的HTML文件？

> ID：15844421
> 
> 赞同：-3
> 
> 时间：2013-04-05T22:07:18.083
> 
> 标签：python, html, django, django-templates

嗨，我只是对 django 中的模板和 HTML 文件之间的区别有一个广泛的问题。例如，在我的项目中，我有一个名为 templates 的目录，它将存储我的模板，这也是我的 HTML 文件所在的位置吗？模板是否嵌入在这些 HTML 文件中？如果不是，你能给我举一个关于这两个文件如何协同工作的好例子吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:10:36.037

[请参阅Django book](http://www.djangobook.com/en/2.0/index.html)中的第 4 章。

# windows - MonoDevelop 未在 Windows 上安装：Gtk# 问题

> ID：15844430
> 
> 赞同：2
> 
> 时间：2013-04-05T22:08:00.843
> 
> 标签：windows, mono, monodevelop, gtk#

类似的[问题](https://stackoverflow.com/questions/13025828/installing-monodevelop-on-windows-workaround-for-gtk-requirement?answertab=active#comment17710015_13035812/)，尽管链接线程的解决方案对我不起作用。

重申问题：我已经安装了 Mono 2.10.9 并在我的 Windows 8 上运行，但无法安装 MonoDevelop（我实际上正在尝试在 sourceforge 上找到 MD 版本 3.0.6，似乎最新版本还没有 Windows 支持）。运行 msi 安装程序时，我得到

> 必须安装 Gtk# 版本 2.12.9 或更高版本。

即使在为 .NET 安装 Gtk# 2.12.20 之后也会出现错误消息（如在 MD Windows 下载会话中找到的）。

我什至尝试编辑 MD msi 文件（如此处所推荐[的](http://mono.1490590.n4.nabble.com/Monodevelop-2-8-5-Windows-7-failed-to-install-with-Gtk-2-12-9-error-message-td4245817.html)），但这也没有奏效。

这个问题有什么解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-01T18:32:06.807

我有同样的问题。我实际上通过您发布的论坛修复了它。

1.  下载并安装[ORCA MSI 编辑器](https://www.technipages.com/download-orca-msi-editor)。
2.  现在右键单击 Monodevelop-xxx.msi 并选择使用 Orca 编辑。
3.  从 Tables 列表中选择“Launch Condition”，在右侧窗格中将出现 2 个条目
4.  编辑名为：的条件`GTKSHARPVERSION >= "2.12" OR REMOVE ~= "ALL"`为`GTKSHARPVERSION >= 2.12.9 OR REMOVE ~= "ALL"`
5.  节省
6.  再次运行安装程序

起初它没有用，但后来我重试了几次，实际上让它工作了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T05:03:56.973

如消息所述，您需要 Gtk# 2.12.9 或更高版本，而您只有 2.10。

另外，如果我是你，我会安装完整的 Xamarin studio msi（Windows 版本的 MonoDevelop），而不是干涉从 sourceforge 下载的源代码，这基本上是为了在 linux 上进行风格开发。

您可以在这里找到 Xamarin studio 和 Gtk# 2.12.20（最新）：

[http://monodevelop.com/Download/](http://monodevelop.com/Download/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-11T03:20:50.580

我遇到了同样的问题，然后按照上面的说明进行操作。

但是，我通过您发布的论坛修复了它。

1.  下载并安装`ORCA MSI Editor`。
2.  现在右键单击`Monodevelop-xxx.msi`并选择使用 Orca 编辑。
3.  从 Tables 列表中选择“Launch Condition”，在右侧窗格中将出现 2 个条目
4.  编辑名为：的条件`GTKSHARPVERSION >= "2.12" OR REMOVE ~= "ALL"`为`GTKSHARPVERSION >= 2.12.9 OR REMOVE ~= "ALL"`
5.  节省
6.  再次运行安装程序

我所做的是使用 Orca 编辑 Monodevelop-xxx.msi 并从 Launch Condition 中删除该行`GTKSHARPVERSION >= "2.12.19" OR REMOVE ~= "ALL"`，然后我就能够安装 Xamarin studio。

但是当我运行 Xamarin Studio 软件抛出同样的问题请安装 Gtk# 必须安装。

我再次修改了 Xamarin Studio 安装程序和条件，然后删除了 Gtk#，然后我重新安装了 Gtk，Xamarin Studio 运行正常。

# sql - 在 Oracle 中定义 CLOB 的大小

> ID：15844434
> 
> 赞同：9
> 
> 时间：2013-04-05T22:08:28.067
> 
> 标签：sql, oracle11g, clob

我正在制作一个存储 XML 的表。为了存储 XML，我使用了`CLOB`数据类型。我的 XML 的最大大小为 5kb。

创建表时我应该定义什么大小的`CLOB`列？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-05T22:37:14.733

在设置 clob 时，您没有准确定义大小（与 varchar 不同）。这只是简单`clob`的。

lob 的最大大小为 4Gb。

存储方面，它将使用如下空间：

1.  如果 lob 被定义为行内，并且 lob 小于 ~ 4kb ，它只会占用文档的空间量。（例如，在行中存储一个 512 字节的 xml，它将使用 512 字节。
2.  如果 lob 定义在行外（或超过 4kb），那么它将使用您在创建表时定义的“块”大小的倍数。

创建 lob 列时，您可以指定其存储子句来控制行内和行外选项，如下所示：

```
LOB (c) STORE AS lobseg (DISABLE STORAGE IN ROW CHUNK 16384) 
```

即，这将指定 lob 永远不能与常规表数据内联存储，并且将以每个块 16kb 的倍数分配存储空间，因此即使您的文档为 1kb，也将占用 16kb 的存储空间。

如果您的 xml 文档只有 5kb，您可能需要考虑行内存储，并放置一个小块大小（最小块大小为 1 个块，所以如果您有一个 4kb 范围的表空间，您的最小块大小将为 4kb ; 如果你指定less，它将被忽略）。允许行内 lob 的缺点是表会更大，因此大范围扫描可能会受到一些影响（但 lob 检索更快）。

同样在 11g 中，您可以选择压缩您可能需要考虑的 lob 段（如果您的许可证涵盖它）。尽管使用如此小的文档，您可能不会受益匪浅。

在这里阅读更多：http: [//docs.oracle.com/cd/B28359_01/appdev.111/b28393/adlob_tables.htm](http://docs.oracle.com/cd/B28359_01/appdev.111/b28393/adlob_tables.htm)

# ruby - Ruby - 有没有办法用重载方法的同名调用超类的方法

> ID：15844436
> 
> 赞同：0
> 
> 时间：2013-04-05T22:08:40.683
> 
> 标签：ruby, oop

是否可以执行以下操作：

```
class A
  def a(var)
    puts "do something with #{var}"
  end
end

class B < A
  def a(var)
    var = var + "some modification"
    #this is what I want to do:
    super.a(var)
  end
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:19:56.437

除非我误读了您的问题，否则您应该可以自己打电话`super`；例如：

```
class A
  def a(var)
    puts "do something with #{var}"
  end
end

class B < A
  def a(var)
    var = var + "some modification"
    #this is what I want to do:
    #super.a(var)
    super
  end
end

v = B.new
v.a("hey") 
```

生产

```
$ ruby test.rb
do something with heysome modification 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:25:31.597

您不能在`super`调用中使用方法名称

如果你`super`自己使用它，那么它将调用`super`类的实现传递相同的参数

```
class A
  def a(var)
    puts var
  end
end

class B < A
  def a(var)
    super
  end
end

B.new.a(1) #=> 1 
```

如果要修改变量，则可以重新分配`var`arg 或使用`super`传入参数的调用

```
class A
  def a(var)
    puts var
  end
end

class B < A
  def a(var)
    var = 2
    super
  end
end

B.new.a(1) #=> 2 
```

或者

```
class A
  def a(var)
    puts var
  end
end

class B < A
  def a(var)
    super(2)
  end
end

B.new.a(1) #=> 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:27:16.667

*试试下面的：*

```
class A
  def a(var)
    puts "do something with #{var}"
  end
end

class B < A
  def a(var)
    var = var + "some modification"
    #this is what I want to do:
    #super.a(var)
    self.class.superclass.instance_method(:a).bind(self).call 12
  end
end

v = B.new
v.a("hello") 
```

***输出：***

```
do something with 12 
```

另一个：

```
class A
  def a(var)
    puts "do something with #{var}"
  end
end

class B < A
    alias :old_a :a
  def a(var)
    var = var + "some modification"
    #this is what I want to do:
    #super.a(var)
    old_a 12
  end
end

v = B.new
v.a("hello") 
```

***输出：***

```
do something with 12 
```

# java - 为什么foreach语句不改变元素值？

> ID：15844443
> 
> 赞同：61
> 
> 时间：2013-04-05T22:09:33.570
> 
> 标签：java, foreach

为什么下面的印刷品是老板而不是贝司？

```
String boss = "boss";
char[] array = boss.toCharArray();

for(char c : array)
{
 if (c== 'o')
     c = 'a'; 
}
System.out.println(new String(array)); //How come this does NOT print out bass?It prints boss. 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-04-05T22:11:09.950

您正在更改迭代变量`c`。这不会改变数组的内容。迭代变量只是数组元素的*副本*。如果你想修改数组，你需要明确地这样做：

```
for (int i = 0; i < array.length; i++) {
    if (array[i] == 'o') {
        array[i] = 'a';
    }
} 
```

您的原始代码（根据[JLS 的第 14.14.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.14.2)）等效于：

```
for (int i = 0; i < array.length; i++) {
    char c = array[i];
    if (c == 'o') {
        c = 'a'; 
    }
} 
```

改变局部变量的值永远不会改变其他任何东西——它*只会*改变局部变量。那作业：

```
char c = array[i]; 
```

*将数组中的值复制*到局部变量中。它不会永久地将局部变量与数组元素相关联。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-05T22:11:14.163

这是因为`c = 'a'`分配给未引用自身索引处存在的实际值`a`的局部变量。它只包含在 的指定索引处存在的值的副本。因此，更改实际上是在局部变量中进​​行的，而不是在引用的实际位置。如果要更改值，则确实应该使用以下内容：`c``array``array``array[i]`

```
int i = 0;
for(char c : array)
{
 if (c== 'o')
     array[i] = 'a'; 
  i++;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-05T22:12:19.070

c 的值是数组中值的副本。直接访问数组以更改相关值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-05T22:11:03.053

您的变量`c`会更改，但数组内容不会更改。要更改数组，不要使用`c`, 直接操作数组。

```
for(int i = 0; i < array.length; i++)
{
 char c = array[i];
 if (c== 'o')
     array[i] = 'a';
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-05T22:12:48.080

您将“a”分配给局部变量 c，但没有分配给数组元素。要让它打印低音，你需要

```
for (int i = 0; i < array.length; i++) {
    if (array[i] == 'o') {
        array[i] = 'a';
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-05T22:12:22.670

在“for each”循环中应用的更改是在她的身体内部进行的（这是因为值是复制的，而不是引用）。要处理引用，请使用“for”循环。

# android - 试图改变按钮的宽度

> ID：15844446
> 
> 赞同：0
> 
> 时间：2013-04-05T22:09:40.123
> 
> 标签：android

我正在尝试获取屏幕的宽度，然后更改按钮的宽度。我正在使用 setWidth，并且宽度没有改变（我将它设置为一个小数字，30，所以我可以判断大小是否改变。代码 mBut = (Button)findViewById(R.id.butRington); // this不起作用，将尺寸设置为小，这样我就可以真正告诉 mBut.setWidth(30); mBut.setOnClickListener(this);

布局

```
 <LinearLayout 
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="center" 
android:orientation="horizontal" > 

        <Button
        android:id="@+id/butVol"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:textSize="24px"
        android:text="Volume"   
        android:textColor="#ff0000ff"

    />

    <Button
        android:id="@+id/butRington"
        android:layout_width="100dp"
        android:layout_height="wrap_content"
        android:textSize="24px"
        android:text="Rington"  
        android:textColor="#ff0000ff"

    /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:13:53.800

您需要修改按钮的 LayoutParams。

> mBut.setLayoutParams(new LinearLayout.LayoutParams(30, xxxx));

其中 xxx 是按钮的高度。您可以通过以下方式检索它

```
ViewGroup.LayoutParams params = mBut.getLayoutParams();
params.height; 
```

检查[这个帖子](http://android-coding.blogspot.in/2011/05/resize-button-programmatically-using.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:24:57.200

将 layout_widht 挂到 wrap_content 后，我​​可以将宽度更改为我需要的每个尺寸。

```
<Button
    android:id="@+id/butRington"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="R"
    android:textColor="#ff0000ff"
    android:textSize="24px" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:38:31.417

获取屏幕宽度：

```
Display display = getWindowManager().getDefaultDisplay();
Point size = new Point();
display.getSize(size);
int width = size.x 
```

现在你需要得到你的按钮，然后设置新的宽度：

```
Button b = (Button) findViewById(R.id.button1);
b.setWidth(width); 
```

# c - 从文件中获取数字并将它们放入数组所需的建议

> ID：15844447
> 
> 赞同：1
> 
> 时间：2013-04-05T22:09:41.610
> 
> 标签：c

我正在编写一个程序，该程序从 txt 文件中获取数字并将它们放入 2 个不同的数组中。

文本文件如下所示：

```
 50 40
    250 140
    5 6
    500 50
    300 200 
```

我需要将第一列中的所有数字放入一个数组中，将第二列放入另一个数组中。

到目前为止，这是我的代码：

```
 #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>

    int main()
    {
        FILE * ifp = fopen("input2.txt","r"); //Open the input file
        int cars = 5, i , j; // Initialized cars and counters i and j
        char VIEW[20], BID[20], CLOSE[20];
        int CAR[10], START_BID[10], MIN_INCREASE[10];
        int *b; // Temp pointer to current bid
        int  *m; // Temp pointer to current array of the minimum increase

        strcpy(VIEW, "VIEW");
        strcpy(BID, "BID");
        strcpy(CLOSE, "CLOSE");

     for (i = 0; i < cars; i++) {
         b = &START_BID[i]; // Get pointer to current START_BID
         m = &MIN_INCREASE[i]; // Get pointer to array of current MIN_INCREASE
         fscanf(ifp, "%d", &b[i]);
         for (j = 0; j < cars; j++) {
             fscanf(ifp, "%d", &m[i]);
         }
     }

        printf("%d\n", START_BID);
        printf("%d\n", MIN_INCREASE);

            fclose(ifp);

        return 0;
    } 
```

我让它打印 2 个数组的内容以查看它们是否被正确拉出。

这是我的输出：

```
 2686588
    2686548 
```

关于如何将数字拉入正确数组的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:21:58.053

这是一个解决方案：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main()
{
    FILE * ifp = fopen("file.txt","r"); //Open the input file
    int cars = 5, i , j; // Initialized cars and counters i and j
    char *view="VIEW", *bid="BID", *CLOSE="CLOSE";
    int CAR[10], START_BID[10], MIN_INCREASE[10];

    for (i = 0; i < cars; i++) 
    {
        fscanf(ifp, "%d %d", &START_BID[i],&MIN_INCREASE[i]);
    }

    for (i = 0; i < cars; i++) 
    {
        printf("%d %d\n", START_BID[i], MIN_INCREASE[i]);
    }
    fclose(ifp);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:26:15.177

根据您的问题，要读取数据，必须修改第一个循环

```
 for (i = 0; i < cars; i++) {
     fscanf(ifp, "%d", &START_BID[i]);
     fscanf(ifp, "%d", &MIN_INCREASE[i]);
 } 
```

并将数据打印为单独的数组

```
printf("\nStarting Bids:\t");
for (i = 0; i < cars; i++) {
    printf("%d\t", START_BID[i]);
}

printf("\nMinimum Increase:\t");
for (i = 0; i < cars; i++) {
  printf("%d\t", MIN_INCREASE[i]);
}

printf("\n"); 
```

有了这个输出控制台看起来像

```
Starting Bids:  50      250     5       500     300
Minimum Increase:       40      140     6       50      200 
```

# c# - C# 中“今天”、“昨天”、“8 秒前”等的字符串扩展

> ID：15844451
> 
> 赞同：3
> 
> 时间：2013-04-05T22:09:58.473
> 
> 标签：c#

有没有人听说过或访问过一些 c# 字符串扩展片段或库，可以将“昨天”、“今天”、“明天”等内容转换为 DateTimes 或“8 秒前”、“10 分钟后”进入时间跨度？

如果没有，对 C# 中的样子有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T22:14:30.450

我在某个时候从某个地方得到了这个。

```
public static string ElapsedTime(DateTime dtEvent) 
{ 
    TimeSpan TS = DateTime.Now - dtEvent; 
    int intYears = DateTime.Now.Year - dtEvent.Year; 
    int intMonths = DateTime.Now.Month - dtEvent.Month; 
    int intDays = DateTime.Now.Day - dtEvent.Day; 
    int intHours = DateTime.Now.Hour - dtEvent.Hour; 
    int intMinutes = DateTime.Now.Minute - dtEvent.Minute; 
    int intSeconds = DateTime.Now.Second - dtEvent.Second; 
    if (intYears > 0) return String.Format("{0} {1} ago", intYears, (intYears == 1) ? "year" : "years");
    else if (intMonths > 0) return String.Format("{0} {1} ago", intMonths, (intMonths == 1) ? "month" : "months");
    else if (intDays > 0) return String.Format("{0} {1} ago", intDays, (intDays == 1) ? "day" : "days");
    else if (intHours > 0) return String.Format("{0} {1} ago", intHours, (intHours == 1) ? "hour" : "hours");
    else if (intMinutes > 0) return String.Format("{0} {1} ago", intMinutes, (intMinutes == 1) ? "minute" : "minutes");
    else if (intSeconds > 0) return String.Format("{0} {1} ago", intSeconds, (intSeconds == 1) ? "second" : "seconds"); 
    else 
    { 
        return String.Format("{0} {1} ago", dtEvent.ToShortDateString(), dtEvent.ToShortTimeString()); 
    } 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T22:13:55.940

我不知道任何开箱即用的库，但它很容易编写你自己的：

```
public static class DateTimeExtensions
{

public static DateTime Yesterday (this DateTime x)
{
return x.AddDays(-1);
}

} 
```

然后，您可以执行以下操作：

```
var yesterday = DateTime.Now.Yesterday(); 
```

编辑：您似乎只想将逐字字符串转换为日期时间。如果不将某些字符串显式映射到某个条件，我看不出你怎么能做到这一点，例如

```
public static DateTime GiveMeADateTime(this string stringValue)
{
switch (stringValue)
{
case "today": return DateTime.Now;
case "tomorrow": return DateTime.Now.AddDays(1);
default: return DateTime.Now;
}
} 
```

然后你可以像这样使用它：

```
var todaysDate = "today".GiveMeADateTime(); 
```

请注意，这**不是动态的，也不是可维护**的。但我想这可能会给你一些想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T23:37:43.443

既然这将成为关于这个主题的公开辩论......

对于 C# 或其他方式，我还没有看到任何类似的东西，所以：

你需要一个解析器，显然......

1）自己制作一个“方便”的解析器 - 取决于您在这里定位的“语言”，如果它足够简单，您可以使用简单的“标记化”，只需过滤“已知单词”（例如，不要介意词汇分析等，允许“奇怪”的词），把它们放在篮子里并提取数字。匹配秒等、数量和一些短语。这并不理想，远非如此，但如果简单，如果它有效，那就太好了。

2) RegEx 对于[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)类型的问题并不理想——但同样，如果您将问题最小化，您可以解析出其中的一些问题。就个人而言，我不会，但是如果您需要一种快速而肮脏的语言并且没有真正的语言，只需解析出简单的格式，请尝试一下

[3）对于更复杂 - 和更好的解决方案 - 使用像Antlr](http://www.antlr.org/)这样具有 C# 库的一流解析器（虽然帮助很少 - 但如果需要，提出一个更具体的问题，我会尝试挖掘一些代码）。
还有[Irony](http://irony.codeplex.com/)，它是一个基于表达式的 C# 原生解析器 - 使用起来很有趣（虽然不如 Antlr 快或性能好，但它对你来说可能无关紧要，更容易使用，更多帮助等）。[也可以看看](http://www.hanselman.com/blog/TheWeeklySourceCode59AnOpenSourceTreasureIronyNETLanguageImplementationKit.aspx)

# php - 未找到符号：_iconv libiconv.2.dylib

> ID：15844463
> 
> 赞同：1
> 
> 时间：2013-04-05T22:10:41.800
> 
> 标签：php

当我尝试运行 VBoxManage 时，出现以下错误。如果我尝试自己运行 php，我也会得到它。知道该怎么做才能解决它吗？

```
$ VBoxManage --help
dyld: Symbol not found: _iconv
  Referenced from: /usr/lib/libcups.2.dylib
  Expected in: /opt/local/lib/libiconv.2.dylib
in /usr/lib/libcups.2.dylib
Trace/BPT trap: 5 
```

# ruby-on-rails - 未初始化的常量 ActionDispatch::Session::EncryptedCookieStore (NameError)

> ID：15844465
> 
> 赞同：36
> 
> 时间：2013-04-05T22:10:58.147
> 
> 标签：ruby-on-rails, passenger, session-cookies

我和乘客一起在 4 号轨道上。一切都很好，直到我`bundle`刚刚做了一个。现在我遇到以下错误：

```
Web application could not be started

uninitialized constant ActionDispatch::Session::EncryptedCookieStore (NameError)
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application/configuration.rb:144:in `const_get'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application/configuration.rb:144:in `session_store'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application.rb:345:in `block in default_middleware_stack'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application.rb:307:in `tap'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application.rb:307:in `default_middleware_stack'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/engine.rb:494:in `app'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application/finisher.rb:34:in `block in <module:Finisher>'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/initializable.rb:30:in `instance_exec'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/initializable.rb:30:in `run'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/initializable.rb:55:in `block in run_initializers'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:150:in `block in tsort_each'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:183:in `block (2 levels) in each_strongly_connected_component'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:219:in `each_strongly_connected_component_from'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:182:in `block in each_strongly_connected_component'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:180:in `each_strongly_connected_component'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/2.0.0/tsort.rb:148:in `tsort_each'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/initializable.rb:54:in `run_initializers'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/application.rb:214:in `initialize!'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/rails-2ac97df55230/railties/lib/rails/railtie/configurable.rb:30:in `method_missing'
  /opt/ptolemy-web/config/environment.rb:5:in `<top (required)>'
  config.ru:3:in `require'
  config.ru:3:in `block in <main>'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `instance_eval'
  /u/sf/ytl/.rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/gems/rack-1.5.2/lib/rack/builder.rb:55:in `initialize'
  config.ru:1:in `new'
  config.ru:1:in `<main>'
  /opt/rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/passenger-7ef605967703/helper-scripts/rack-preloader.rb:82:in `eval'
  /opt/rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/passenger-7ef605967703/helper-scripts/rack-preloader.rb:82:in `preload_app'
  /opt/rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/passenger-7ef605967703/helper-scripts/rack-preloader.rb:127:in `<module:App>'
  /opt/rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/passenger-7ef605967703/helper-scripts/rack-preloader.rb:6:in `<module:PhusionPassenger>'
  /opt/rbenv/versions/2.0.0-p0/lib/ruby/gems/2.0.0/bundler/gems/passenger-7ef605967703/helper-scripts/rack-preloader.rb:5:in `<main>' 
```

我的宝石文件

```
source 'https://rubygems.org'

# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'
gem 'rails', github: 'rails/rails'

# database
gem 'pg'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   github: 'rails/sass-rails'
  gem 'coffee-rails', github: 'rails/coffee-rails'
  gem 'coffeebeans'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  gem 'therubyracer', platforms: :ruby

  gem 'uglifier', '>= 1.0.3'
end

# UI
gem 'jquery-rails'
gem 'less-rails'
gem 'twitter-bootstrap-rails'
gem 'jquery-ui-rails'
gem 'jquery-datatables-rails', github: 'rweng/jquery-datatables-rails'
gem 'backbone-on-rails'
gem 'd3_rails'
gem 'rails-timeago'
gem 'dygraphs-rails'

# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks
gem 'turbolinks'

# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder
gem 'jbuilder', '~> 1.0.1'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano', group: :development

# To use debugger
# gem 'debugger'

# UI middleware
gem 'passenger', github: 'FooBarWidget/passenger'
gem 'rack-webauth' 
```

我的 google-foo 在这件事上相当薄弱。谁能帮忙？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2013-04-06T09:57:22.797

最近在 Rails 4 中删除了秘密 cookie 存储。请参阅[Changelog](https://github.com/rails/rails/blob/4-0-stable/actionpack/CHANGELOG.md#rails-400-june-25-2013)。

为了让您的应用程序再次运行，请将config/initializers/session_store.rb 中的行`config.session_store :encrypted_cookie_store`替换为。`config.session_store :cookie_store`商店将自动加密。

如果不确定。创建一个新的 Rails 4 应用程序 ( `rails new app_name --pre`) 并查看初始化程序。

有关详细信息，请参阅[相应的提交](https://github.com/rails/rails/commit/f9d23b3848ab81cfb5207e14ccabca3d2e9b3182)

# ios - 为什么“pod update”会在 Hudson 上产生“stty：stdin 不是终端”？

> ID：15844472
> 
> 赞同：3
> 
> 时间：2013-04-05T22:11:21.413
> 
> 标签：ios, terminal, continuous-integration, hudson, cocoapods

我正在使用 cocoapods 并在我们的 Hudson 服务器上的工作构建步骤中调用“pod update”。

这是日志：

```
+ pod update
Resolving dependencies of `./Podfile'
Updating spec repositories
stty: stdin isn't a terminal
... 
```

直接从我的机器上的命令行工作或直接在 Hudson 机器上工作时，我没有得到这个。发生了什么事，我应该担心吗？

# javascript - JavaScript 的性能测试

> ID：15844480
> 
> 赞同：-1
> 
> 时间：2013-04-05T22:11:38.970
> 
> 标签：javascript, performance

我已经为严重依赖 JavaScript 和 JQuery 的 Web 应用程序开发了一个框架，并且在处理一些 UI 更改时，我在客户端处理中面临着很大的性能问题......而且因为我使用了许多 JavaScript 库，所以我将无法传递每个 JavaScript 函数、回调和事件处理程序以检查每个性能。

有没有办法检测导致长时间处理能够优化甚至替换它们的特定功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:14:52.977

使用 Chrome 开发者工具或 Firebug 中的 Profile 函数，它可以让您概览调用的每个函数、堆栈和运行时间。

# ruby-on-rails - 加速狮身人面像？

> ID：15844481
> 
> 赞同：2
> 
> 时间：2013-04-05T22:11:39.400
> 
> 标签：ruby-on-rails, ruby, sphinx, thinking-sphinx

我有一个很大的站点，有近 600.000 条索引文章，一些查询需要 200 毫秒才能执行。

我能做些什么来加快速度吗？有什么经验可以分享吗？

我的应用是 Rails 3.0，带有 Thinking Sphinx 和最新版本的 Sphinx。

这是我搜索的配置：

```
searchd
{
  listen = < IP >:< PORT >
  log = < LOG PATH >
  query_log = < QUERY LOG PATH >
  pid_file = < PID FILE PATH >
  max_matches = 100000
  thread_stack = 1024K
  read_buffer = 512K
  read_unhinted = 64K
  max_filters = 512
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:55:16.370

对于 Thinking Sphinx，您是否使用了最新的 Rails 3.0 友好版本 2.0.14？即使您是，最近也有一些更改添加了连接池/持久 Sphinx 连接，这提供了明显的速度提升，因为大多数搜索不会有设置套接字的开销。

不过，您需要通过 git 使用最新版本：

```
gem 'thinking-sphinx',
  :git    => 'git://github.com/pat/thinking-sphinx.git',
  :branch => 'v2',
  :ref    => '6fbbbc0c5d' 
```

也就是说，Barry 的评论值得关注，他对 Sphinx 有很多经验。

# jquery - 颜色框内容在 IE8 中未更新

> ID：15844487
> 
> 赞同：0
> 
> 时间：2013-04-05T22:12:14.113
> 
> 标签：jquery, html, internet-explorer-8, colorbox

我正在使用 Colorbox 作为日期弹出窗口，人们一直对我说内容没有改变（我在 Mac 上使用 Chrome/FF，所以没有 IE）。一旦我在 IE8 中查看它，我注意到只要我更改数据库中的值并且 Windows 内容发生更改，IE8 就不会显示它。我在 FF 或 Chrome 中没有这个问题。

这是内容（由 PHP 脚本生成）：

```
<link rel="stylesheet" href="http://mouseware.net/weekendcamping/includes/popupbox/colorbox.css" />
    <script src="http://mouseware.net/weekendcamping/includes/popupbox/jquery.colorbox-min.js"></script>
    <script>
        $(document).ready(function(){
            // Colorbox elements
            $(".inline").colorbox({inline:true, width:"50%", height:"50%"});$(".ajax").colorbox({width:"50%", height:"50%"});$(".ajax_lg").colorbox({width:"75%", height:"75%"});$(".ajax_tall").colorbox({width:"50%", height:"75%"});
        });
    </script>
                <div align="left" style="font-size:8pt;"><a href="http://mouseware.net/weekendcamping/administrator/index.php?option=reservations&act=selectDate&loc=1&height=400&width=400&dsptmpl=1" class="thickbox" style="font-size:8pt; color:#000000;">Location</a> &raquo; Date</div><br />
        <table align="center" cellpadding="2" cellspacing="1" border="0" style="padding:0; margin:0;">
            <tr>
                <th>
                    <div style="font-size:16pt; font-weight:bold;">Select Date</div>
                </th>
            </tr>
                                <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('04/05/2013 - 04/07/2013')">04/05/2013 - 04/07/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('04/12/2013 - 04/14/2013')">04/12/2013 - 04/14/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('04/19/2013 - 04/21/2013')">04/19/2013 - 04/21/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('04/26/2013 - 04/28/2013')">04/26/2013 - 04/28/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('05/03/2013 - 05/05/2013')">05/03/2013 - 05/05/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('05/10/2013 - 05/12/2013')">05/10/2013 - 05/12/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('05/17/2013 - 05/19/2013')">05/17/2013 - 05/19/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('05/24/2013 - 05/26/2013')">05/24/2013 - 05/26/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('05/31/2013 - 06/02/2013')">05/31/2013 - 06/02/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('06/07/2013 - 06/09/2013')">06/07/2013 - 06/09/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('06/14/2013 - 06/16/2013')">06/14/2013 - 06/16/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('06/21/2013 - 06/23/2013')">06/21/2013 - 06/23/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('09/06/2013 - 09/08/2013')">09/06/2013 - 09/08/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('06/28/2013 - 06/30/2013')">06/28/2013 - 06/30/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('09/20/2013 - 09/22/2013')">09/20/2013 - 09/22/2013</a>
                        </td>
                    </tr>
                                            <tr>
                        <td>
                            <a href="#" onClick="$.colorbox.close(); updateEventDate('10/11/2013 - 10/13/2013')">10/11/2013 - 10/13/2013</a>
                        </td>
                    </tr>
                                </table> 
```

它是从邮件文件中调用的

```
$.colorbox({href:'popupDate.php', width:'50%', height:'50%'}) 
```

我最好的猜测是弹出窗口被缓存在 IE 中，所以它不会重新生成内容......但我不确定。

我已将颜色框更新到最新的 1.4.15，并将 jQuery 更新到最新的 1.9.1。这些更新都没有改变。我也尝试将内容放在标签和标签中，但没有帮助。我还尝试将无缓存 HTML 和 PHP 代码添加到我的父级和弹出框......也没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T20:44:54.053

尝试删除 IE 临时文件（缓存）。

这对我有用。

也许您应该为此页面发送一些无缓存标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-08T20:41:55.707

每次向 href 参数添加时间戳或其他唯一变量。它会帮助你。

```
var seconds = new Date().getTime();
$.colorbox({href:'popupDate.php'+seconds}); 
```

# json - 取消嵌套 json 对象

> ID：15844494
> 
> 赞同：0
> 
> 时间：2013-04-05T22:12:33.933
> 
> 标签：json

我的示例 json 是

```
"multiList": [
{
"my_key" : "this is my key"
},
{
"my_text_box": "This is my text box"
}, 
```

]

如何将其动态转换为 {"my_key" : "this is my key"}, {my_text_box": "This is my text box"}？

使用 jQuery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:16:44.913

你的问题没有意义。您是否要求转换为两个单独的对象？这两个对象的字符串表示？还有什么？我可以做前两个：

```
var objOne = json.multiList[0];
var objTwo = json.multiList[1];

var objStr = JSON.stringify(json.multiList[0]) + ', '
    + JSON.stringify(json.multiList[1]); 
```

如果您想将所有单独的属性添加到一个对象中，您可以在循环中扩展另一个对象。

```
var obj = {};
json.multiList.forEach(function (elem) {
    for (k in elem) {
        if (elem.hasOwnProperty(k)) {
            obj[k] = elem[k];
        }
    }
}); 
```

[http://jsfiddle.net/ExplosionPIlls/t2xyd/](http://jsfiddle.net/ExplosionPIlls/t2xyd/)

这不考虑覆盖`obj`.

# python - 创建线程安全的顶级小部件

> ID：15844498
> 
> 赞同：1
> 
> 时间：2013-04-05T22:12:45.780
> 
> 标签：python, python-2.7, thread-safety, tkinter

我正在尝试学习如何使用线程模块。我按照这里的说明进行操作：http: [//effbot.org/zone/tkinter-threads.htm](http://effbot.org/zone/tkinter-threads.htm)

我希望测试脚本将：

1.  每两秒打印一次“计数”
2.  显示一个弹出对话框窗口（也每 2 秒）
3.  弹出窗口应该允许累积（如果我一段时间不点击“确定”，应该有多个弹出窗口）

但是，当我运行此脚本时，它会冻结主窗口并在一段时间后崩溃。我想我没有正确实现线程模块。

有人可以看看并指出我做错了什么吗？

这是我迄今为止尝试过的：

```
from Tkinter import *
import thread
import Queue
import time

class TestApp:
    def __init__(self, parent):
        self.super_Parent = parent
        self.main_container = Frame(parent)
        self.main_container.pack()
        self.top_frame = Frame(self.main_container)
        self.top_frame.pack(side=TOP)
        self.bottom_frame = Frame(self.main_container)
        self.bottom_frame.pack(side=TOP)
        self.text_box = Text(self.top_frame)
        self.text_box.config(height=20, width=20)
        self.text_box.pack()
        self.queue = Queue.Queue()
        self.update_me()

    def show_popup(self):
        self.my_popup = Toplevel(self.main_container)
        self.my_popup.geometry('100x100')
        self.popup_label = Label(self.my_popup, text="Hello!")
        self.popup_label.pack(side=TOP)
        self.pop_button = Button(self.my_popup, text="OK", command=self.my_popup.destroy)
        self.pop_button.pack(side=TOP)

    def write(self, line):
        self.queue.put(line)

    def update_me(self):
        try:
            while 1:
                line = self.queue.get_nowait()
                if line is None:
                    self.text_box.delete(1.0, END)
                else:
                    self.text_box.insert(END, str(line))
                self.text_box.see(END)
                self.text_box.update_idletasks()
        except Queue.Empty:
            pass
        self.text_box.after(100, self.update_me)

def pipeToWidget(input, widget):
    widget.write(input)

def start_thread():
    thread.start_new(start_test, (widget,))

def start_test(widget):
    count = 0
    while True:
        pipeToWidget(str(count) + "\n", widget)
        count += 1
        time.sleep(2)
        widget.show_popup()

root = Tk()
widget = TestApp(root)
start_button = Button(widget.bottom_frame, command=start_thread)
start_button.configure(text="Start Test")
start_button.pack(side=LEFT)
root.title("Testing Thread Module")
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:37:07.317

我无法重现您的问题，但我可以看到它为什么会发生。

您正在使用`queue`将消息从后台线程传递到主线程进行更新`text_box`，这是正确的。但是您也是`widget.show_popup()`从后台线程调用的，这意味着它会`Toplevel`在后台线程中创建并显示一个新线程。这是*不*正确的。

所有 UI 代码必须在同一个线程中运行——不是每个顶级窗口的所有 UI 代码，所有 UI 代码*周期*。在某些平台上，您可能会在自己的线程中运行每个窗口（甚至是自由线程），但这不*应该*工作，并且肯定会在某些平台上崩溃或做不正确的事情。（此外，该单个 UI 线程必须是某些平台上的初始线程，但这与此处无关。）

* * *

因此，要解决此问题，您需要像创建更新文本框一样创建弹出窗口。

显而易见的方法是`widget.show_popup()`将`update_me()`. 如果您希望它在文本框更新后 2 秒发生，只需添加`self.top_frame.after(2000, self.show_popup)`到方法中即可。

但我猜您正在尝试自学如何拥有多个独立的更新机制，因此告诉您“只对所有内容使用单个更新队列”可能不是一个好的答案。在这种情况下，只需创建两个队列，并为每个队列提供一个单独的更新方法。然后，做你的`pipeToWidget`，睡 2 秒，然后`pipeToPopup`。

* * *

解决此问题的另一种方法是使用[`mtTkinter`](http://tkinter.unpythonic.net/wiki/mtTkinter). 它基本上完全按照您正在做的事情进行，但使其自动化，将每个实际的 Tk GUI 调用推送到一个队列中，以便稍后由主循环运行。当然，您的对象本身必须是线程安全的，这也意味着您必须处理来自一个线程的 GUI 调用与来自另一个线程的调用交错。但只要这些都不是问题（而且它们似乎不是你的情况），它就像魔术一样。

* * *

如果你想知道*为什么*这在 Win7 上对你来说是冻结和/或崩溃，而不是在 OS X 10.8 上对我来说......好吧，你真的需要研究一堆 Tcl、C 和 Python 代码，以及每个东西建好了。而且，除非它很简单（比如你的 Tk 构建不是自由线程的），否则它不会告诉你太多。代码不应该工作，如果它似乎对我有用……那可能只是意味着它每次都能工作，直到我职业生涯中最重要的演示，到那时它会失败。

# youtube - 将 YouTube 视频缩小到响应宽度

> ID：15844500
> 
> 赞同：133
> 
> 时间：2013-04-05T22:12:49.417
> 
> 标签：youtube, responsive-design, embed

我在我们的网站上嵌入了一个 YouTube 视频，当我将屏幕缩小到平板电脑或手机尺寸时，它会在宽度约为 560 像素时停止缩小。这是 YouTube 视频的标准还是我可以添加到代码中以使其变小？

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2013-04-05T22:18:58.103

您可以使用 CSS 使 YouTube 视频具有响应性。使用“videowrapper”类将 iframe 包装在 div 中，并应用以下样式：

```
.videowrapper {
    float: none;
    clear: both;
    width: 100%;
    position: relative;
    padding-bottom: 56.25%;
    padding-top: 25px;
    height: 0;
}
.videowrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
} 
```

.videowrapper div 应该在响应式元素内。.videowrapper 上的填充是防止视频折叠所必需的。您可能需要根据您的布局调整数字。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2016-04-11T12:44:52.543

如果您使用的是 Bootstrap，您还可以使用响应式嵌入。这将完全自动化地使视频响应。

[http://getbootstrap.com/components/#responsive-embed](http://getbootstrap.com/components/#responsive-embed)

下面有一些示例代码。

```
<!-- 16:9 aspect ratio -->
<div class="embed-responsive embed-responsive-16by9">
  <iframe class="embed-responsive-item" src="..."></iframe>
</div>

<!-- 4:3 aspect ratio -->
<div class="embed-responsive embed-responsive-4by3">
  <iframe class="embed-responsive-item" src="..."></iframe>
</div> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-14T13:36:26.597

使用 jQuery 为 YouTube 和 Vimeo 改进的仅 Javascript 解决方案。

```
// -- After the document is ready
$(function() {
  // Find all YouTube and Vimeo videos
  var $allVideos = $("iframe[src*='www.youtube.com'], iframe[src*='player.vimeo.com']");

  // Figure out and save aspect ratio for each video
  $allVideos.each(function() {
    $(this)
      .data('aspectRatio', this.height / this.width)
      // and remove the hard coded width/height
      .removeAttr('height')
      .removeAttr('width');
  });

  // When the window is resized
  $(window).resize(function() {
    // Resize all videos according to their own aspect ratio
    $allVideos.each(function() {
      var $el = $(this);
      // Get parent width of this video
      var newWidth = $el.parent().width();
      $el
        .width(newWidth)
        .height(newWidth * $el.data('aspectRatio'));
    });

  // Kick off one resize to fix all videos on page load
  }).resize();
}); 
```

只需嵌入即可简单使用：

```
<iframe width="16" height="9" src="https://www.youtube.com/embed/wH7k5CFp4hI" frameborder="0" allowfullscreen></iframe> 
```

或者使用像 Bootstrap 这样的响应式风格框架。

```
<div class="row">
  <div class="col-sm-6">
    Stroke Awareness
  <div class="col-sm-6>
    <iframe width="16" height="9" src="https://www.youtube.com/embed/wH7k5CFp4hI" frameborder="0" allowfullscreen></iframe>
  </div>
</div> 
```

*   依靠 iframe 的宽度和高度来保持纵横比
*   可以使用宽高比作为宽度和高度 ( `width="16" height="9"`)
*   等到文档准备好再调整大小
*   使用 jQuery 子字符串`*=`选择器而不是字符串的开头`^=`
*   从视频 iframe 父级而不是预定义元素获取参考宽度
*   Javascript 解决方案
*   没有 CSS
*   无需包装

感谢@Dampas 的起点。 [https://stackoverflow.com/a/33354009/1011746](https://stackoverflow.com/a/33354009/1011746)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-08-14T14:32:18.937

我在此处接受的答案中使用 CSS 来处理我的响应式 YouTube 视频 - 在 YouTube 于 2015 年 8 月左右更新他们的系统之前效果很好。YouTube 上的视频尺寸相同，但无论出于何种原因，现在接受的答案中的 CSS信箱我们所有的视频。顶部和底部有黑色条纹。

我已经对尺寸进行了调整，并决定摆脱顶部填充并将底部填充更改为`56.45%`. 似乎看起来不错。

```
.videowrapper {
    position: relative;
    padding-bottom: 56.45%;
    height: 0;
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-04-06T13:50:16.713

@magi182 的解决方案是可靠的，但它缺乏设置最大宽度的能力。我认为 640 像素的最大宽度是必要的，因为否则 youtube 缩略图看起来像素化。

我的两个包装器的解决方案对我来说就像一个魅力：

```
.videoWrapperOuter {
  max-width:640px; 
  margin-left:auto;
  margin-right:auto;
}
.videoWrapperInner {
  float: none;
  clear: both;
  width: 100%;
  position: relative;
  padding-bottom: 50%;
  padding-top: 25px;
  height: 0;
}
.videoWrapperInner iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
<div class="videoWrapperOuter">
  <div class="videoWrapperInner">
    <iframe src="//www.youtube.com/embed/C6-TWRn0k4I" 
      frameborder="0" allowfullscreen></iframe>
  </div>
</div> 
```

我还将内部包装器中的 padding-bottom 设置为 50 %，因为在 @magi182 的 56 % 时，顶部和底部出现了一个黑条。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-07-18T21:02:06.257

### 现代简单的css解决方案

新的[纵横比](https://developer.mozilla.org/en-US/docs/Web/CSS/aspect-ratio)是这个问题的现代解决方案。

```
aspect-ratio: 16 / 9; 
```

这就是您自动制作 div、图像、iframe 大小所需的全部内容。[样品](https://css-tricks.com/a-first-look-at-aspect-ratio/)。

它得到了[很好的支持](https://caniuse.com/mdn-css_properties_aspect-ratio)，但还没有在 Safari 中（将用于即将到来的 iOS15）——所以现在你仍然需要使用后备。您可以使用 @supports 功能实现这一点

```
.element 
{
   aspect-ratio: 16 / 9;

   @supports not (aspect-ratio: 16 / 9) 
   {
       // take your pick from the other solutions on this page
   }
 } 
```

假设您的开发浏览器确实支持此属性，请务必通过注释掉`aspect-ratio`和来在没有它的情况下进行测试`@supports`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-26T19:27:57.373

这是旧线程，但我在[https://css-tricks.com/NetMag/FluidWidthVideo/Article-FluidWidthVideo.php上找到了新答案](https://css-tricks.com/NetMag/FluidWidthVideo/Article-FluidWidthVideo.php)

以前的解决方案的问题是您需要在视频代码周围有特殊的 div，这不适合大多数用途。所以这里是没有特殊 div 的 JavaScript 解决方案。

```
// Find all YouTube videos - RESIZE YOUTUBE VIDEOS!!!
var $allVideos = $("iframe[src^='https://www.youtube.com']"),

// The element that is fluid width
$fluidEl = $("body");

// Figure out and save aspect ratio for each video
$allVideos.each(function() {

    $(this)
    .data('aspectRatio', this.height / this.width)

    // and remove the hard coded width/height
    .removeAttr('height')
    .removeAttr('width');

});

// When the window is resized
$(window).resize(function() {

    var newWidth = $fluidEl.width();

    // Resize all videos according to their own aspect ratio
    $allVideos.each(function() {

        var $el = $(this);
        $el
        .width(newWidth)
        .height(newWidth * $el.data('aspectRatio'));

    });

// Kick off one resize to fix all videos on page load
}).resize();

// END RESIZE VIDEOS 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-11T07:23:53.510

归功于先前的答案[https://stackoverflow.com/a/36549068/7149454](https://stackoverflow.com/a/36549068/7149454)

Boostrap 兼容，调整您的容器宽度（在本例中为 300 像素），您就可以开始了：

```
<div class="embed-responsive embed-responsive-16by9" style="height: 100 %; width: 300px; ">
<iframe class="embed-responsive-item" src="https://www.youtube.com/embed/LbLB0K-mXMU?start=1841" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0"></iframe>
</div> 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2016-05-26T07:42:23.243

好的，看起来像大解决方案。

为什么不`width: 100%;`直接添加到您的 iframe 中。;)

所以你的代码看起来像`<iframe style="width: 100%;" ...></iframe>`

试试这个，它会像我的情况一样工作。

享受！:)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2017-03-18T10:41:56.960

我用简单的css做这个如下

代码

```
<iframe id="vid" src="https://www.youtube.com/embed/RuD7Se9jMag" frameborder="0" allowfullscreen></iframe> 
```

CSS 代码

```
<style type="text/css">
#vid {

max-width: 100%;
height: auto;

} 
```

# mysql - mysql --quick 选项

> ID：15844501
> 
> 赞同：0
> 
> 时间：2013-04-05T22:12:50.507
> 
> 标签：mysql, client, option

当我`--quick option`按照另一个网络发布中的建议运行 mysql 时， desc`<table>`会返回很多 -

`--quick`而当我在没有该选项的情况下运行 mysql 时会`desc table`返回正常输出。

表有 7 列...6 双和 1 日期列。

谢谢拉曼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:28:37.643

> --quick: Do not cache each query result, print each row as it is received

Which means if you `DESCRIBE` a table, and MySQL wants the pretty print (you now, `|`'s between fields, and `-`'s around header & bottom), it does not know yet how long each field in the resultset is going to be, so it assumes the largest width that column may get for the 'boxing'. If you look at `INFORMATION_SCHEMA.COLUMNS`, you can see for instance `COLUMN_COMMENT` is `varchar(1024)`, all those fields really add up. It may seem you only get `-`'s, but those are just the 'bottom' of the boxing, if you scroll up (assuming your scrollback is big enough), you'll see your desired data is there.

You can:

*   use \G as you delimiter for vertical output rather the boxed.
*   start the process with automatic vertical output with `--auto-vertical-output`
*   start the process with non-tabular / non-boxed output with `mysql --quick -s`

# php - PHP snmp 返回结果

> ID：15844504
> 
> 赞同：0
> 
> 时间：2013-04-05T22:13:23.750
> 
> 标签：php, snmp

我使用此函数通过 snmp 获取结果
`snmp2_walk("localhost", "private", "OID");`

一切正常，但结果以这种形式返回：
STRING: "..."
STRING: "second"

是否有将此结果转换为普通字符串的函数？
从`STRING: "second"`到`second`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T19:26:26.867

我相信这就是您正在寻找的：

```
snmp_set_quick_print(1); // print just the value, no types
snmp_set_valueretrieval(SNMP_VALUE_PLAIN); // no quotes for strings 
```

[http://us1.php.net/manual/en/ref.snmp.php](http://us1.php.net/manual/en/ref.snmp.php)

# c++ - 使用 make 和自动依赖构建程序

> ID：15844506
> 
> 赞同：0
> 
> 时间：2013-04-05T22:13:24.903
> 
> 标签：c++, makefile

我编写了一个简单的 C++ 程序，我第一次想使用`makefile`. 作为一个挑战，我想制作一个makefile，它自己列出所有依赖项。我正在关注[本](http://www.makelinux.net/make3/make3-CHP-2-SECT-7)教程。我的程序由`main.cpp`和`ext1.cpp`组成`ext1.h`。按照教程，我有以下makefile

```
VPATH    = src include

CPPFLAGS = -o include

CC = gcc

SOURCES  = main.cpp \
       ext1.cpp

-include $(subst .c,.d,$(SOURCES))

%.d: %.c
    $(CC) -M $(CPPFLAGS) $< > $@.$$$$;                      \
    sed 's,\($*\)\.o[ :]*,\1.o $@ : ,g' < $@.$$$$ > $@;     \
    rm -f $@.$$$$ 
```

当我运行它时，我收到消息：`make: *** No targets specified and no makefile found. Stop.`我不清楚我在我的情况下缺少什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T23:19:30.870

你试图一次做太多事情。

**步骤 1.**您的第一个 makefile 应该构建可执行文件*，而不*尝试自动依赖检测。

```
VPATH = include src
CPPFLAGS += -Iinclude
CC = gcc

exec: main.o ext1.o
    $(CC) $^ -o $@

%.o: %.cc
    $(CC) -c $(CPPFLAGS) $< -o $@

main.o ext1.o: ext1.h 
```

**第 2 步。**一旦完美运行，您可以将标头依赖项放在单独的文件中：

生成文件：

```
VPATH = include src
CPPFLAGS += -Iinclude
CC = gcc

exec: main.o ext1.o
    $(CC) $^ -o $@

%.o: %.cc
    $(CC) -c $(CPPFLAGS) $< -o $@

-include *.d 
```

主.d：

```
main.o : ext1.h 
```

ext1.d：

```
ext1.o: ext1.h 
```

**步骤 3。**一旦完美*运行*，您就可以自动生成依赖文件：

```
VPATH = include src
CPPFLAGS += -Iinclude
CC = gcc

exec: main.o ext1.o
    $(CC) $^ -o $@

%.o: %.cc
    $(CC) -c -MMD $(CPPFLAGS) $< -o $@

-include *.d 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T03:26:51.577

没有找到make文件？你给makefile起什么名字？确保它`makefile`或者`Makefile`如果你只是执行命令`make`，否则你可以将文件名传递给`make`这样的

```
make -f yourmakefile 
```

Petr Budnik 建议的更改必须有效

# sql - SQL Server - 插入两个表的组合

> ID：15844508
> 
> 赞同：2
> 
> 时间：2013-04-05T22:13:29.877
> 
> 标签：sql, sql-server, tsql, insert

我需要在 SQL Server 中组合两个表。但是我需要将表 A 的每个项目与表 B 的每个项目都有一行，从而产生一个表 C。我会是这样的：

```
Table A
A
B
C
D

Table B
1
2
3

Table C
column x | cloumn Y
   A           1
   A           2
   A           3
   B           1
   B           2 
   B           3
   C           1
   C           2
   C           3
   D           1
   D           2
   D           3 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T22:20:44.853

你可以简单地这样做：

```
SELECT 
 a.a + CAST(b AS VARCHAR(2)) AS a
FROM tablea a
CROSS JOIN tableb AS b; 
```

看看它的实际效果：

*   [SQL 小提琴演示](http://sqlfiddle.com/#!3/79dc8/5)

然后您可以使用该[`INTO`](http://msdn.microsoft.com/en-us/library/ms188029.aspx)子句将它们插入到已经存在的表中：

```
INSERT INTO tablec(c)
SELECT 
 a.a + CAST( b AS VARCHAR(2)) AS a
FROM tablea a
CROSS JOIN tableb AS b; 
```

或从这些值创建一个新表：

```
SELECT 
 a.a + CAST( b AS VARCHAR(2)) AS c
INTO Tablec
FROM tablea a
CROSS JOIN tableb AS b; 
```

[**更新的 SQL Fiddle 演示**](http://sqlfiddle.com/#!3/a84e5/4)

**请注意：**我假设了列的名称，因为您没有在问题中指定它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T02:00:35.607

看起来您正在尝试获取以下内容：

```
select a.col1, b.col1
into tableC
from tableA a
cross join tableB b 
```

# android - 如何在Android中打开当前布局的webview？

> ID：15844515
> 
> 赞同：0
> 
> 时间：2013-04-05T22:14:18.003
> 
> 标签：android, android-layout, android-intent, android-widget, android-webview

一直在寻找这个。如何打开将出现在当前布局之上的 web 视图？webview 将显示来自互联网的网页，用户在其中输入他们的详细信息并提交。

如果有人玩过 Facebook 登录、Twitter 登录，甚至是 PayPal 支付，他们都在做我想要的，一个漂浮在当前布局之上的 webview 请看下面的截图：

**请注意，**我不会创建自己的 webview 文本框和按钮，它将是来自我希望在该 webview 中显示的 url 的网页

![没有 webview 的应用程序](https://i.stack.imgur.com/YJqRrl.png)

![带有 facebook 登录 webview 的应用程序](https://i.stack.imgur.com/BO2oSl.png)

![带有 twitter 登录 webview 的应用程序](https://i.stack.imgur.com/hlFbVl.png)

![使用贝宝支付 webview 的应用程序](https://i.stack.imgur.com/M9bRzl.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:15:47.110

只需在[Dialog](http://developer.android.com/guide/topics/ui/dialogs.html)中启动它。

对话框可以以自定义布局为主题，看起来几乎像任何东西。

如果您仍然需要更大的灵活性，请尝试使用以对话框为主题的 Activity。

# java - Hibernate 和 Raw JDBC 应用程序的混合正在锁定

> ID：15844518
> 
> 赞同：2
> 
> 时间：2013-04-05T22:14:30.113
> 
> 标签：java, hibernate, jdbc, sql-server-2008-r2

我接管了一家公司的 Java Web 应用程序，该应用程序有 30k 行代码。系统上有大约 20 个用户。该应用程序最初执行原始 jdbc sql 查询。我已经将一些 SQL 转换为休眠状态，但由于时间和预算限制，我没有全部转换。我的想法是我可以混合使用两种 db 交互方法（hibernate 和 raw jdbc），同时将应用程序逐步迁移到所有 hibernate。它使用 c3p0 连接池。它使用两个池；一个用于休眠，一个用于原始 jdbc 查询。有一些原始的 jdbc 更新和插入查询，但它们现在都使用 hibernate 的`session.doWork(Work work)`钩子。数据库是 Microsoft SQL Server '08 R2。

我们使用这种方法遇到的问题似乎总是表现为应用程序锁定。在过去的一个月里，我已经能够通过修复明显的问题来减少锁定的频率。我现在处于一个原因不是很明显的地步，我和我的老板怀疑我们的方法或配置存在根本性的错误，可以完全解决这个问题。

令我困惑的一件事是，如果这些锁定是数据库死锁，则线程转储似乎仅表明写入阻塞了读取。但是，事务隔离级别是读提交的，那么为什么写会阻塞读呢？

你有什么建议可以给吗？对更好的调试分析有什么建议吗？

这是我的 persistence.xml 文件中的属性

```
<property name="hibernate.dialect" value="org.hibernate.dialect.SQLServerDialect"/>
<property name="hibernate.archive.autodetection" value="class, hbm"/>
<property name="hibernate.c3p0.min_size" value="20" />
<property name="hibernate.c3p0.max_size" value="300" />
<property name="hibernate.c3p0.timeout" value="300" />
<property name="hibernate.c3p0.max_statements" value="50" />
<property name="hibernate.c3p0.idle_test_period" value="3000" /> 
```

我对原始 jdbc 选择查询使用默认的 c3p0 配置

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T06:08:16.930

我想你现在已经解决了这个问题，但如果没有，你可以查看这个链接[http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/transactions.html](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/transactions.html)

您可以首先检查您的应用程序没有长期未结交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T07:45:46.017

我认为你的问题是你的代码打开了更多的事务和休眠代理对象，也许你有更多的逻辑事务被破坏或没有关闭。

Hibernate 根据您从数据库检索到逻辑事务的单个记录创建代理对象。如果您在另一个事务中更改此记录，或者您将这些代理与它们的事务同步，或者休眠运行更多刷新操作来更新这些代理（如果它们的事务是打开的）。

现在，为了帮助您，我的问题是：

*   你能开发新代码吗？如果没有，我建议离开 Hibernate。

如是：

*   我建议创建一个中间层来管理数据层和所有代码之间的逻辑事务。

*   使用一些支持 JPA 2.0 的 IDE 通过数据库逆向工程创建对象。

# cocoa - Cocoa 自动布局约束 - 可变数量视图的编程填充

> ID：15844520
> 
> 赞同：4
> 
> 时间：2013-04-05T22:14:34.100
> 
> 标签：cocoa, views, padding, autolayout

我希望能够将新视图添加到超级视图，但它们之间的垂直距离保持不变。为此，我尝试以编程方式为每个视图设置一个约束，但我不知道该怎么做。问题是我事先不知道视图的数量或相对位置。

有没有办法以编程方式为每个视图设置约束，以便无论它们相邻的其他视图如何，自动布局都会保持视图之间的恒定间距？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T18:21:23.010

这个简短的代码片段可能是您正在寻找的：

```
NSMutableArray* newVerticalConstraints = [NSMutableArray array];
UIView* firstView = nil;
UIView* secondView = nil;
UIView* superview = <Your container view>;
NSArray* subviews = [superview subviews];
if ([subviews count] > 0) {
    firstView = [subviews objectAtIndex:0];
    // Add first constraint
    [newVerticalConstraints addObjectsFromArray:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|-10-[firstView]" options:0 metrics:nil views:NSDictionaryOfVariableBindings(firstView)]];

    for (int i = 1; i < [subviews count]; i++) {
        secondView = [subviews objectAtIndex:i];
        [newVerticalConstraints addObjectsFromArray:[NSLayoutConstraint constraintsWithVisualFormat:@"V:[firstView]-10-[secondView]" options:0 metrics:nil views:NSDictionaryOfVariableBindings(firstView,secondView)]];
        firstView = secondView;
    }

    // Add last constraint
    [newVerticalConstraints addObjectsFromArray:[NSLayoutConstraint constraintsWithVisualFormat:@"V:[firstView]-10-|" options:0 metrics:nil views:NSDictionaryOfVariableBindings(firstView)]];

    [superview removeConstraints:self.verticalConstraints];
    [superview addConstraints:newVerticalConstraints];
    // Save all vertical constraints to be able to remove them
    self.verticalConstraints = newVerticalConstraints;
} 
```

# list - 从列表中生成方案中的所有可能性

> ID：15844521
> 
> 赞同：3
> 
> 时间：2013-04-05T22:14:51.273
> 
> 标签：list, scheme

我有一个子列表列表：

```
((a b c) (e f) (z h)) 
```

我想生成这样的东西：

```
((a e z) (a f z) (a e h) (a f h) (b e z) (b e h) ... ) and so on. 
```

我想，给定一个子列表列表，生成所有可能的子列表，其中包含来自每个输入子列表的元素。

我怎样才能得到这个输出？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:19:07.653

您正在描述列表列表的[笛卡尔积](https://en.wikipedia.org/wiki/Cartesian_product)，这是一个可能的实现（在 Racket 中工作）：

```
(define (cartesian-product lsts)
  (foldr (lambda (lst acc)
           (for*/list ((x (in-list lst))
                       (y (in-list acc)))
             (cons x y)))
         '(())
         lsts)) 
```

现在，如果你不使用 Racket，这里有一个使用标准程序的 vanilla 实现；它应该适用于任何定义类似`fold-right`- 过程的 Scheme 解释器：

```
(define (flatmap f lst)
  (apply append (map f lst)))

(define (cartesian-product lsts)
  (foldr (lambda (lst acc)
           (flatmap (lambda (x)
                      (map (lambda (y)
                             (cons x y))
                           acc))
                    lst))
         '(())
         lsts)) 
```

无论哪种方式，它都按预期工作：

```
(cartesian-product '((a b c) (e f) (z h)))

=> '((a e z) (a e h) (a f z) (a f h) (b e z) (b e h)
     (b f z) (b f h) (c e z) (c e h) (c f z) (c f h)) 
```

# php - PHP - 获取 URL 的结尾

> ID：15844524
> 
> 赞同：0
> 
> 时间：2013-04-05T22:15:11.840
> 
> 标签：php, post, get

所以我想我需要为此提交一个新问题......

这是我的老问题：[PHP - 获取路径减去根](https://stackoverflow.com/questions/15842455/php-get-path-minus-root/15842594?noredirect=1#15842594)

我需要一种 PHP 方法来将 URL 设为以下任何一种......

```
http://kenthomes.net/plan_detail.php?mod=39
http://kenthomes.net/Amelia-Cove 
```

离开我之后得到一切……

```
"plan_detail.php?mod=39" // If there is no alias for that page 
```

或者

```
"Amelia-Cove" // If that page has an alias being applied 
```

实际上，由于别名的原因，它们是同一个页面，但并非所有这些页面都有与之关联的别名，例如...

```
http://kenthomes.net/plan_detail.php?mod=52 
```

不像……

```
http://kenthomes.net/Amelia-Cove 
```

目前我正在使用...

```
trim($_SERVER['REQUEST_URI'],'/') 
```

这给了我...

```
"Amelia-Cove" // Which is fine. 
```

或者

```
"plan_detail.php" // Which is not okay. 
```

我需要..

```
"Amelia-Cove" // Which is fine. 
```

或者

```
"plan_detail.php?mod=39" // Which is fine. 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:20:19.740

您可以通过以下方式获取 URL 的所有部分[`parse_url()`](http://www.php.net/manual/en/function.parse-url.php)

例如;

```
$parts = parse_url('http://kenthomes.net/plan_detail.php?mod=39');

print_r($parts); 
```

应该给你这样的东西：

```
Array
(
    [scheme] => http
    [host] => kenthomes.net
    [path] => /plan_detail.php
    [query] => mod=39
) 
```

您可以使用它来创建自己的 URL，其中包含您需要的部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:22:38.300

`$_SERVER["REQUEST_URI"]`仅包含 URI。

当你还想要 之后的部分时`?`，你也需要使用`$_SERVER["QUERY_STRING"]`。

利用：

```
trim($_SERVER['REQUEST_URI'] . $_SERVER['QUERY_STRING'], '/'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:25:29.260

[`parse_url`](http://php.net/manual/en/function.parse-url.php)，如果你只想要最右边的，使用[`str_split`](http://php.net/manual/en/function.str-split.php)就足够了。

```
$data = parse_url($url, PHP_URL_PATH); 
```

应该够了。

否则，如果响应当前请求，[`$_SERVER['REQUEST_URI']`](http://www.php.net/manual/en/reserved.variables.server.php)可能会起作用，因为那是整个 URI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T22:26:32.003

你可以试试这个：

```
$uri = $_SERVER['REQUEST_URI'];
$qs = $_SERVER['QUERY_STRING'];

echo trim($uri . $qs, '/'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T22:21:44.757

您可以通过以下方式获取查询字符串（问号后的位）`$_SERVER['QUERY_STRING']`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-05T22:21:46.403

附加. `$_SERVER['REQUEST_URI']`_`$_SERVER['QUERY_STRING']`

[PHP: $_SERVER - 手动](http://se2.php.net/reserved.variables.server.php)

# html - 引导下拉菜单 同一水平行上的两个链接

> ID：15844533
> 
> 赞同：7
> 
> 时间：2013-04-05T22:15:48.833
> 
> 标签：html, twitter-bootstrap

我正在使用 Bootstrap 制作下拉菜单。我想要的选项之一是下拉菜单中同一水平行上的两个链接。我将如何实现这一目标？

```
<div class = "navbar">
<div class = "navbar-inner">

<li class = "dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Dropdown Button
        <b class="caret"></b>
    </a>

    <ul class = "dropdown-menu" role="menu" >
        <li><a href="#">On First Row</a></li>
        <li><a href="#">On Second Row</a></li>
        <li><a href="#">On Third Row</a><a href="#">Also On Third Row</a></li>
</ul>
</li>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-07-27T20:36:17.643

您解决的代码在这里 >>>>>[**一个下拉列表项中有两个链接**](http://jsfiddle.net/3CwzH/3/)

html

* * *

```
 <div class="navbar">
    <div class="navbar-inner">
        <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Dropdown Button
        <b class="caret"></b>
    </a>

            <ul class="dropdown-menu" role="menu">
                <li><a href="#">On First Row</a>
                </li>
                <li><a href="#">On Second Row</a>
                </li>
                <li class="hz"><a href="#">On Third Row</a><a href="#">Also On Third Row</a>
                </li>
            </ul>
        </li>
    </div>
</div> 
```

css

* * *

```
.open> ul>li.hz{
    display: inline-flex !important;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-04-04T14:56:37.880

eirenaios 的回答有问题：

当下拉菜单包含在可折叠的导航栏中时，当导航栏折叠时，多个`<li>`将显示在一行上（直到它换到下一行）。这看起来非常丑陋和令人困惑。

这是基于 eirenaios 答案的解决方案，但也适用于带有下拉菜单的切换（可折叠）导航栏：

[https://plnkr.co/edit/JnsvKGiBokrI1frxC11P?p=preview](https://plnkr.co/edit/JnsvKGiBokrI1frxC11P?p=preview)

* * *

**编辑：**

附加 CSS 规则：

```
.open > .dropdown-menu {
    display: table-caption;
} 
```

* * *

HTML（与原版基本相同，但被一个汉堡菜单按钮包围`.navbar-collapse`并添加`.navbar-header`了一个打开折叠菜单的按钮）：

```
<nav class="navbar navbar-default">
  <div class="navbar-header" data-toggle="collapse" data-target="#navbar0">
    <button type="button" class="navbar-toggle">
      <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
    </button>
  </div>
  <!-- toggled content -->
  <div class="collapse navbar-collapse" id="navbar0">
    <ul class="nav navbar-nav">

      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown Menu A <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="hz">
            <a href="#">Item A1 left</a>
            <a href="#">Item A1 right</a>
          </li>
          <li class="hz">
            <a href="#">Item A2 left</a>
            <a href="#">Item A2 right</a>
          </li>
          <li>
            <a href="#">Single item A3</a>
          </li>
          <li class="hz">
            <a href="#">Item A3 left</a>
            <a href="#">Item A3 right</a>
          </li>
        </ul>
      </li>

    </ul>
  </div>
</nav> 
```

# payment - 结合 Dwolla 的 guestSend 和 registerUser？

> ID：15844537
> 
> 赞同：0
> 
> 时间：2013-04-05T22:16:26.550
> 
> 标签：payment, dwolla

如果我将 guestSend 和 registerUser 合并为一个`<form>`，那么之后会立即验证该用户的银行帐户吗？

这会阻止我打电话`verifyFundingSource()`，即 3-5 天等待 Dwolla 与银行同步吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T02:30:39.820

访客发送功能不会验证 Dwolla 用户的银行帐户。您总是需要等待 Dwolla 验证帐户的新资金来源 - 不幸的是，没有办法绕过它。

# git - git：符号链接/对外部存储库中文件的引用

> ID：15844542
> 
> 赞同：51
> 
> 时间：2013-04-05T22:16:38.550
> 
> 标签：git

在 git 中是否有可能在 git repo 中拥有指向特定文件的“链接”？就像 git submodules 对文件夹所做的那样，但我的问题是关于一个特定的文件，而不是一个完整的目录：

```
my-project/
    class1.java
    class2.java
    logback.xml (link to a particular file, say https://github.com/theHilikus/JRoboCom/blob/master/jrobocom-core/src/main/resources/logback.xml) 
```

可以看出，在这种情况下，拥有一个完整的子模块文件夹是没有意义的，它只是一个文件。
我可以将链接锁定到特定提交，但如果它在自己的项目生命周期中发生变化时移动会更好

注意，这与文件系统的符号链接无关；我说的是对另一个项目、repo、分支或任何东西中的文件的引用。如果文件的内容是重复的而不是文件系统符号链接，那没关系

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2015-01-04T21:18:31.313

Git 具有可用于实现所需功能的功能。它支持文件系统符号链接并支持子模块。子模块已经是处理对其他存储库的引用的标准方法。您可以将它们与本地引用文件的方式结合使用。这可以使用相对符号链接直接处理，也可以使用脚本间接处理，该脚本将文件从子模块复制到您需要它们的位置。

每个外部 git 树应该有一个子模块，并且应该小心对待这些子模块，因为它们不仅是指向外部存储库的链接，而且是指向它们特定提交的链接。以下解决方案将向您展示如何使用外部存储库中的单个文件，但仍保持子模块的所有优点。

另一种方法是直接获取文件，但是您将完全失去子模块的优势，或者您必须自己构建功能。正如我已经说过的，子模块是处理此类任务的标准方法，除非您有特殊需要，例如不惜一切代价*避免下载其他文件，否则您应该使用它。*

## 使用子模块和符号链接

准备好子模块后，您只需添加指向子模块目录结构的文件系统符号链接。

在项目目录的 shell 中运行它：

```
$ git submodule add https://github.com/theHilikus/JRoboCom
$ ln -s JRoboCom/jrobocom-core/src/main/resources/logback.xml
$ git add .gitmodules logback.xml
$ git commit -m "add a symbolic link to logback.xml with the respective submodule" 
```

现在你有一个符号链接：

```
logback.xml -> JRoboCom/jrobocom-core/src/main/resources/logback.xml 
```

## 使用子模块和脚本

作为替代方案，您可以使用从子模块中复制普通文件的自定义脚本。在非常特殊的情况下，您可以在没有子模块的情况下从脚本处理外部存储库，但我通常不推荐它。

创建一个包含以下内容的文件`bootstrap.sh`：

```
#!/bin/sh
git submodule init
git submodule update

cp JRoboCom/jrobocom-core/src/main/resources/logback.xml . 
```

在项目目录的 shell 中运行它：

```
$ git submodule add https://github.com/theHilikus/JRoboCom
$ git add .gitmodules bootstrap.sh
$ git commit -m "add a script to fetch logback.xml from the respective submodule" 
```

请注意，我们没有将`logback.xml`文件添加到 Git，因为它将从子模块中获取。

指示存储库的用户首先运行上面的脚本。它将准备他们的存储库以使用子模块，将获取子模块数据并将文件复制到其位置。有时项目中已经有某种引导脚本。

## 使用脚本通过 git 协议获取单个文件

使用`git archive`.

创建一个文件 bootstrap.sh，其中包含：

```
#!/bin/sh
git archive --remote=https://github.com/theHilikus/JRoboCom master:JRoboCom/jrobocom-core/src/main/resources logback.xml | tar -x 
```

在项目目录的 shell 中运行它：

```
$ git add bootstrap.sh
$ git commit -m "add a script to fetch logback.xml directly from the remote project" 
```

## 使用脚本通过 HTTP 获取单个文件

如果存储库托管服务还通过 HTTP 提供单个文件，您可以简单地使用`curl`或`wget`下载它们。

创建一个文件 bootstrap.sh，其中包含：

```
#!/bin/sh
curl -O https://raw.githubusercontent.com/theHilikus/JRoboCom/master/jrobocom-core/src/main/resources/logback.xml 
```

在项目目录的 shell 中运行它：

```
$ git add bootstrap.sh
$ git commit -m "add a script to fetch logback.xml directly from github" 
```

## 关于获取单个文件的脚本的说明

您还可以将引用存储在具有特定扩展名（如`*.url`）的文件中，或在一个文件中维护引用列表（如`.references`在您的项目目录中），并构建一个更全面的脚本来遍历所有引用并下载相应的文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-04T20:22:28.613

接受的答案似乎具有误导性，因为只要所有开发人员使用的操作系统都支持，**Git 就可以很好地处理符号链接。**

Git 默认尝试存储符号链接而不是跟随它们（为了紧凑性和人们通常想要的）。

当您检出包含链接的树时，无论目标文件系统对象是否存在，它都会将该对象恢复为符号链接。

如果您在不支持符号链接的 FAT 等文件系统上，并且您的存储库使用它们，您可以将 core.symlinks 配置变量设置为 false，并且符号链接将作为包含链接文本的小型纯文本文件检出。

所以参考：

[git 如何处理符号链接？](https://stackoverflow.com/questions/954560/what-does-git-do-to-files-that-are-a-symbolic-link)

[Git - 如何处理符号链接](https://stackoverflow.com/questions/15465436/git-how-to-handle-symlinks)

[如何让 git 遵循符号链接？](https://stackoverflow.com/questions/86402/how-can-i-get-git-to-follow-symlinks)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-17T15:09:55.473

晚了几年，但看看[DVC](https://dvc.org)工具，它允许你 git 版本跟踪或链接存储在远程存储中的任何类型的文件。该工具具有独立于平台的文件链接方式。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-05T23:11:33.617

很不幸的是，不行。您可以在 git 中拥有的唯一外部引用类型是通过子模块，它将整个分支放在一个目录中。您需要创建一个脚本或其他东西来帮助从所需位置获取文件并将其放入您的工作树中。

# actionscript-3 - AS3 OOP 继承和函数

> ID：15844548
> 
> 赞同：0
> 
> 时间：2013-04-05T22:17:06.990
> 
> 标签：actionscript-3, flash, oop, inheritance, functional-programming

我希望有人可以帮助我解决我试图将我创建的谜题中的 as3 代码集成到我的游戏 FLA 文件中的问题。

在 Game.fla 中，我有一个名为 Engine 的主类，它包含从库中调用多个空影片剪辑到舞台，然后使用库中的资产填充每个影片剪辑。每个影片剪辑都有自己的关联类。

我在一个单独的文件中创建了每个拼图，并使用它自己的主类来测试并确保拼图正常工作，当我尝试将拼图的代码添加到影片剪辑类时，我遇到了许多错误

**输出错误**

```
 **Warning** The linkage identifier 'feedback2' was already 
   assigned to the symbol 'wrong_box', and cannot be assigned 
    to the symbol 'graphics/scrambleAssets/wrong_box',
    since linkage identifiers must be unique. 
```

**和编译器错误**

```
 Line 132 1136: Incorrect number of arguments.  Expected 1. 
```

***第 132 行是这样的：***

```
 if(ques_num==words.length){removeChild(checker);
  f3=new feedback3;
  addChild(f3);
   f3.x=100;
   f3.y=100;
  }else{
  getword();} 
```

**主班**

```
 public function show_level1Puzzle(){

        level1Puzzle_screen = new level1Puzzle(this);
        remove_levelChooseBoy();

        addChild(levelPuzzleBoy_screen);
        level1Puzzle_screen.x=510;
        level1Puzzle_screen.y=380;
    } 
```

** level1Puzzle 类**

```
 package actions {

import flash.display.MovieClip;

public class level1Puzzle extends MovieClip {
                    public var main_class:Engine;

                    // variables used in puzzle
                   var words:Array = new Array; 
        Var rand1:int;var rand2:int; 
        var i:int; //variable used for loop iterations
        // more variables

    public function level1Puzzle(passed_class:Engine) {
                    main_class = passed_class;

    public function getword(passed_class:Engine) {
        main_class = passed_class;
        words=["cat","dog"];
        current_word=words[ques_num];
        setTiles(current_word.length);
        ques_num++;
    }
    public function setTiles(a) {tileArray=[ ];
        for(i=0;i<a;i++){
            var tempclip:Tile =new Tile;addChild(tempclip);
                tempclip.x=300+(i*180);tempclip.y=200;tempclip.tag=i;
            tempclip.original_posx=tempclip.x;
            tempclip.original_posy=tempclip.y;
            tileArray[i]=tempclip;

            var tempclip2:Placeholder =new Placeholder;addChild(tempclip2);
            tempclip2.x=300+(i*180);tempclip2.y=400;
            targetArray[i]=tempclip2;

        }//for i
        scramble_word(a);
    } 
```

//拼图的更多功能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:41:30.527

这个函数有一个参数：

```
public function getword(passed_class:Engine) {
        main_class = passed_class;
        words=["cat","dog"];
        current_word=words[ques_num];
        setTiles(current_word.length);
        ques_num++;
    } 
```

在第 132 行，您没有传递参数，因此这就是错误消息的原因。

# node.js - ExpressJS SSL 仅在一个域上

> ID：15844552
> 
> 赞同：0
> 
> 时间：2013-04-05T22:17:24.263
> 
> 标签：node.js, express

我正在使用 ExpressJS。我`app`的`https`服务器也包含一个虚拟主机。

```
app.use(express.vhost('api.example.com', require('./lib/subdomains/api').app)); 
```

因为我的 SSL 证书仅适用于根域，所以我的`api.example.com`域现在无法加载它提供的路由。

我怎样才能只在我的根域上使用 SSL 而不是我的另一个？我需要能够在域之间共享应用程序配置，而不是 SSL 证书。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T07:55:57.063

多哈。我没有改变我`NODE_ENV`的所以虚拟主机在实时环境中设置不正确。

# c++ - 使用指针从 std::list 中擦除元素？

> ID：15844556
> 
> 赞同：1
> 
> 时间：2013-04-05T22:17:33.513
> 
> 标签：c++, list, std

```
class SororityBeerExpo{
public:

     std::list<LaysCrankdPepChip> m_chipList;

     void destroyChip(LaysCrankdPepChip * target)
     {
         // m_chipList needs to erase that which is pointed at by target but
         // erase() requires an iterator which is not what we got to work with
         // remove() needs a value which is not right either
     }
} 
```

我的问题是，如何使用指向该元素的指针删除列表中的元素？我想在不使用迭代器代替指针的情况下做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:21:12.240

您可以对列表中的元素进行 [线性] 搜索，将每个元素的地址与您的指针进行比较（[`std::find_if`](http://en.cppreference.com/w/cpp/algorithm/find)符合要求）。当然，最终您仍将使用迭代器，因为这正是我们所[`list::erase`](http://en.cppreference.com/w/cpp/container/list/erase)需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:23:40.437

您不能直接执行此操作（尽管有关执行此操作的间接方式，请参见本杰明的回答）。列表节点包含的数据不仅仅是包含的对象（例如指向前一个和下一个节点的指针），但您的原始指针仅指向包含的对象。

# javascript - 是否可以防止抛出特定的异常？

> ID：15844562
> 
> 赞同：2
> 
> 时间：2013-04-05T22:17:54.790
> 
> 标签：javascript, exception, error-handling

有没有办法“白名单” - 或防止 - 在 try catch 块中抛出特定错误？

例如，假设我有一个我知道但不想记录的异常。但是，我想捕获该 try/catch 块中弹出的任何其他错误。

* * *

这是我能想到的最好的：

```
try {
...
} catch(exception) {

    //Loop through a predefined list of known errors that we want to ignore.
    for (var i in whitelistOfErrors) {

        //if our exception MATCHES an error that we want to ignore,
        //don't throw it
        if (exception == whitelistOfErrors[i])
            break;

        //if our exception DOESN'T MATCH an error that we want to ignore,
        //throw it
        if (i = whitelistOfErrors.length)
            throw exception;
    }
} 
```

（或者用为您搜索数组的方法替换逻辑，如果存在的话）

# c++ - 如何使更安全的 AddCallback() - 对象中不同事件的函数

> ID：15844566
> 
> 赞同：2
> 
> 时间：2013-04-05T22:18:20.820
> 
> 标签：c++, events, callback

我有`AddCallback()`第二个参数`int`。但是如何减少客户端代码
传输不正确的可能性呢？`type`这种情况下什么是好的风格？ *注意：*如果不相等，则类型不正确`mouseDown` `mouseUp` `mouseHover` `mouseLeave`

```
const int  mouseDown = 0;
const int  mouseUp = 1;
const int  mouseHover = 2;
const int  mouseLeave = 3;

class Widget
{
public:
    ...
    bool AddCallback(void (*func)(Widget*), const int type);
protected:
    std::vector<void (*)(Widget*)>  funcsDown;
    std::vector<void (*)(Widget*)>  funcsUp;
    std::vector<void (*)(Widget*)>  funcsHover;
    std::vector<void (*)(Widget*)>  funcsLeave;
    ...
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:52:56.970

对于 C++11，您应该使用强类型枚举：

```
enum class mouseAction { mouseDown = 0, mouseUp = 1, mouseHover = 2, mouseLeave = 3 };

bool AddCallback(void (*func)(Widget*), const mouseAction type); 
```

使用 C++03，您仍然可以使用枚举并提供第二个重载以使使用整数的调用变成链接器错误：

```
enum mouseAction { mouseDown = 0, mouseUp = 1, mouseHover = 2, mouseLeave = 3 };

// implement this method (here or somewhere else)
bool AddCallback(void (*func)(Widget*), const mouseAction type);

// but only declare this one:
bool AddCallback(void (*func)(Widget*), const int type); 
```

如果你这样称呼它：

```
myWidget.AddCallback( &foo, mouseDown ); // works
myWidget.AddCallback( &foo, 42 ); // linker error 
```

# compression - 如何存储和随后解码霍夫曼表

> ID：15844567
> 
> 赞同：1
> 
> 时间：2013-04-05T22:18:27.383
> 
> 标签：compression, decode, huffman-code

我有一张来自图像中像素强度的霍夫曼表。我需要将其存储在二进制文件中，就像 jpeg 图像的 DHT 格式一样。然后接收器可以提取这些值，但我不知道如何重建表格。我非常详细地描述了我是如何生成和存储我的表的，以防任何排序顺序影响最终结果。

## 生成表格

*   在列表中为每个强度 [0,255] 制作成对（频率，强度），然后删除频率为 0 的任何对。

*   按频率升序对该列表进行排序。在多对具有相同频率的情况下，它们按强度排序，例如 [ (1, 7), (1, 55), (1, 107), (2, 4), (2, 19) 等]

*   弹出两个最前面的对，第一个是左孩子，第二个是右孩子，将它们放在父节点中并再次对列表进行排序。对列表进行排序时，对于相同的频率，首先按长度升序排列各个对，然后是父节点，例如 [ (1, 107), (2, 4), (2, 19), (2, ((1 , 7), (1, 55))) 等]

*   迭代构建整个树，然后遍历它以获取代码。

## 存储表

为了存储表，表头由以下顺序形成：

*   树中的级别数（无论如何往往是 16）

*   每个级别 (1-16) 有多少个代码，例如 0（代表 1）、2（代表 2）、1（代表 3）等

*   然后按顺序写强度，例如 2 表示 2 级，1 表示 3 级，等等。

*   为了确保没有混淆，每个级别的代码最初都是按数字排序的，例如级别 6：000100、000101、001000、001001、001011

## 提取后的代码

所以现在我可以提取这些并得到下表中的值。我读过这就是重构代码所需的全部内容，但我不明白这个过程。例如，我的 2 级代码应该是 10 和 11。我怎么知道它不是 00 和 01？我已经提供了前几个级别，如果您能解释这个过程只是为了让我继续前进，我将非常感激。

```
bits | number
-----+--------
1    |    0
2    |    2
3    |    1
4    |    1
5    |    2
6    |    5
7    |    6
8    |    6
9    |   17
etc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T03:03:27.510

您需要发送的只是每个符号的代码中的位数。零可以表示该符号不存在，因此未编码。比特数本身可以是霍夫曼编码和游程编码，就像在[deflate 格式](https://www.rfc-editor.org/rfc/rfc1951)中所做的那样。

给定这组代码长度，您只需要确保在两端以相同的方式分配位序列。这是使用规范的霍夫曼代码完成的，其中代码在每个位长度内按符号顺序分配。

# awk - 仅保留文件中最新且基于两个字段重复的行

> ID：15844569
> 
> 赞同：2
> 
> 时间：2013-04-05T22:18:45.823
> 
> 标签：awk

这与问题有关

*   [awk - 如果字段重复则删除行](https://stackoverflow.com/questions/2604088/awk-remove-line-if-field-is-duplicate?rq=1)
*   [sed/awk + ​​regex 删除第一个字段匹配的重复行（IP 地址）](https://stackoverflow.com/questions/9257883/sed-awk-regex-delete-duplicate-lines-where-first-field-matches-ip-address)

我有一个这样的文件：

```
FOO,BAR,100,200,300
BAZ,TAZ,500,600,800
FOO,BAR,900,1000,1000
HERE,THERE,1000,200,100
FOO,BAR,100,10000,200
BAZ,TAZ,100,40,500 
```

重复项由前两个字段确定。此外，更“最近”的记录（文件中较低的/较高的行号）是应该保留的记录。

将输出的 awk 脚本是什么：

```
BAZ,TAZ,100,40,500
FOO,BAR,100,10000,200
HERE,THERE,1000,200,100 
```

输出顺序不是那么重要。

awk 语法的解释会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:27:36.687

[这在awk](/questions/tagged/awk "显示标记为“awk”的问题")中很容易：我们只需要输入一个带有键的数组，该键与第一列和第二列相结合，其余的作为值：

```
$ awk -F, '{a[$1","$2]=$3","$4","$5}END{for(i in a)print i,a[i]}' OFS=, file.txt
BAZ,TAZ,100,40,500
HERE,THERE,1000,200,100
FOO,BAR,100,10000,200 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T17:27:17.010

这可能对您有用（tac 和 GNU 排序）：

```
tac file | sort -sut, -k1,2 
```

# google-app-engine - 谷歌云端点稳定性？

> ID：15844575
> 
> 赞同：2
> 
> 时间：2013-04-05T22:19:20.303
> 
> 标签：google-app-engine, google-cloud-endpoints

我正在使用此[链接](https://developers.google.com/eclipse/docs/endpoints-androidconnected-gae)使用 GCM 构建一个简单的聊天应用程序，并且我发现了这个很棒的功能“Google Cloud Endpoints”，它使事情变得更容易。但我害怕依赖它，因为我注意到它仍然是实验性的。我可以信任它还是应该改用 Java Servlet？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T01:23:59.343

确实，“实验”这个标签有点吓人。如果您担心，您可以考虑稍等到 Google IO 2013，也就是 5 月中旬。他们经常在那里发布公告并介绍新技术。

他们在去年的 Google IO（7 月）上首次宣布了端点，如果端点有任何重大变化，他们可能会在今年宣布。

如果您确实开始使用 Endpoints，仅用于 Android，并且没有用户身份验证，我认为如果您必须使用 Servlet（即，由于令人反感）。用户身份验证的东西将更难取代 IMO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:48:48.227

就我使用 Google Cloud Endpoints 而言，它们运行良好。此外，已经实现了许多有趣的功能，例如与[Google Eclipse 插件](https://developers.google.com/eclipse/docs/endpoints-overview)集成和通过[Google APIs Explorer](https://developers.google.com/apis-explorer/#p/)进行测试，甚至在本地主机中，使用[开发服务器](https://developers.google.com/appengine/docs/java/tools/devserver)进行测试。

我知道它们仍处于试验阶段，可能是因为它们只是一种尚未经过彻底测试的新技术，并且会不断更新。无论如何，到目前为止我还没有发现重大错误，您应该能够使用将存在的连续版本重用您的端点。它似乎不会在不久的将来消失......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T11:56:11.847

这是一个较老的问题，但对于进一步的参考，我想说我短暂的经历并不那么愉快。

我试过“移动后端应用程序”。一开始，一切正常，但几天后（没有改变任何东西）我收到：

```
GoogleJsonResponseException 404 Not Found 
```

我在 stackoverflow 上发布了其他帖子，并设法通过创建另一个项目来解决它。我更改了代码，它仍然有效。但是我又遇到了两个项目的问题，我重新部署并更改了设置（在其他帖子中找到了提示）并且它起作用了。现在不管我做什么，它都不再起作用了。

我希望这个问题是特定于这个项目的，但它仍然令人沮丧。

# payment - Dwolla 用户可以同时拥有非营利和营利性资金来源吗？

> ID：15844576
> 
> 赞同：1
> 
> 时间：2013-04-05T22:19:27.273
> 
> 标签：payment, dwolla

如果是这样，是否需要从列出的 API 进行额外的 API 调用[`addFundingSource`](https://developers.dwolla.com/dev/docs/funding/add)才能将两者都放在一个 Dwolla 帐户下？

目前我无法生成这两种帐户类型，所以我无法提供代码，但显然首先知道这是否可能会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T02:25:59.737

只要银行账户支持 ACH 交易，对于 Dwolla 来说，该银行账户是用于营利性还是非营利性用途都无关紧要。您应该能够将两种资金来源添加到单个 Dwolla 帐户。

# javascript - 更新地图属性

> ID：15844577
> 
> 赞同：0
> 
> 时间：2013-04-05T22:19:30.140
> 
> 标签：javascript, maps, yui, mapbox

我正在尝试“简化”mapbox 地图。很确定这不是特定于 mapbox.js

基本上我通过 id 获取地图，然后在其上调用属性，但这些不会更新地图。

我可以在 DOM 控制台中重新创建[这个例子](http://mapbox.com/mapbox.js/example/optimal-easing/)。

![一只忙碌的猫](https://www.evernote.com/shard/s94/sh/68a6f4a1-cb05-4244-9747-238744311d30/bd97bad22f14e591a5dab23ad4f5cb03/deep/0/Screenshot%2005/04/13%2002:35.jpg)

在我的应用程序中，我有一个更新地图的函数，我使用相同的逻辑：通过标识符获取地图，然后调用属性来移动它。

我错过了什么？

谢谢！！

在我的代码中，我有一个 YUI 自动完成字段，“on”或“after”都没有工作：

```
function addMeasureInput() {
YUI().use("autocomplete", "autocomplete-filters", "autocomplete-highlighters", function(Y) {
    //skin
    Y.one('body').addClass('yui3-skin-sam');
    //Array source
    var locs = getLocationsList();
    Y.one('#ac-input').plug(Y.Plugin.AutoComplete, {
        resultFilters: 'phraseMatch',
        resultHighlighter: 'phraseMatch',
        source: locs,
        on: {
            select: function() {
             console.log("Location Selected!");
                             var map = mapbox.map('map');
             map.ease.location({ lat: 0, lon: 0 }).zoom(5).optimal();
            }
        },
        after: {
            select: function(o) {
                var map = mapbox.map('map');
                map.ease.location({ lat: 0, lon: 0 }).zoom(5).optimal();
                showLoc(o.result.raw);
            }
        }
    });
}); 
```

};

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T06:41:10.957

`mapbox.map('map')`必须只创建地图： http: [//mapbox.com/mapbox.js/api/v0.6.7/#mapbox.map](http://mapbox.com/mapbox.js/api/v0.6.7/#mapbox.map)：

```
Create a map on the current page. 
```

当我得到地图 DOM 元素时`document.getElementById('map')`，我没有找到任何指向 mapbox 地图实例的链接。因此，您可能无法通过 DOM 获取现有地图实例。但是，将您自己的 javascript 对象保存在 DOM 元素中是个坏主意。

更好地将您的地图实例保存为 javascript 对象。对于您的 mapbox exaple [http://mapbox.com/mapbox.js/example/optimal-easing/](http://mapbox.com/mapbox.js/example/optimal-easing/) `map`实例存储在`window`对象中。所以你可以写：

```
map.ease.location({ lat: 38.9, lon: -77 }).zoom(10).optimal(); 
```

或者

```
map.zoomIn(); 
```

等等。它会起作用的。

**UPD：** 据我所知，您最好使用延迟初始化之类的东西：

```
var map = null;

function ease (lat, lon, zoom) {
    if (!map) {
        map = mapbox.map('map');
    }
    map.ease.location({ lat: lat, lon: lon }).zoom(zoom).optimal();
}

function addMeasureInput() {
    YUI().use("autocomplete", "autocomplete-filters",
              "autocomplete-highlighters", function(Y) {
        //skin
        Y.one('body').addClass('yui3-skin-sam');
        //Array source
        var locs = getLocationsList();
        Y.one('#ac-input').plug(Y.Plugin.AutoComplete, {
            resultFilters: 'phraseMatch',
            resultHighlighter: 'phraseMatch',
            source: locs,
            on: {
                select: function() {
                    console.log("Location Selected!");
                    ease(0, 0, 5);
                }
            },
            after: {
                select: function(o) {
                    ease(0, 0, 5);
                    showLoc(o.result.raw);
                }
            }
        }
    });
}); 
```

但是，地图初始化是一个非常缓慢的操作（创建 dom，加载瓦片），所以最好初始化一次地图，并且可能不是按需初始化。

# reporting - 在 Pentaho BI 服务器中使用 PDI 转换作为报表参数的数据源

> ID：15844578
> 
> 赞同：3
> 
> 时间：2013-04-05T22:19:39.383
> 
> 标签：reporting, pentaho, kettle

关于如何使用 PDI 转换作为 BI 服务器控制台中报告参数的数据源的任何建议？

我已将 prpt 报告上传到 BI 服务器，但我收到一条消息“解析参数信息时出错”。和文件都在同一个目录中`.prpt`。`.ktr`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T19:41:32.817

实际上，刚刚意识到可以通过添加转换 (KTR) 作为资源来解决该问题。在这种情况下，可以使用`File-Resources`菜单选择。在对话框中选择要导入的转换并选择 text/xml 格式。为资源命名并保存它。您必须再次保存您的 PRPT 文件 ( `File-Save`)。

这里需要注意的是，转换应该与 PRPT 文件位于同一文件夹中。然后在数据源中，不要选择通过文件夹路径进行转换，而是使用在上一步中分配的资源的名称（没有用于查看文件的下拉菜单）。您必须知道资源的确切名称才能这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T15:08:21.537

仔细检查日志。我怀疑它没有找到 KTR。当您在 prpt 中选择 KTR 时，它通常（令人讨厌地）保存整个路径，因此它可能是您开发框上定义的 ktr 的完整路径。

这确实有效，所以要坚持！

# c# - 覆盖内置的 .NET 类

> ID：15844583
> 
> 赞同：0
> 
> 时间：2013-04-05T22:20:25.740
> 
> 标签：c#, .net, inheritance

如果我从诸如 System.Windows.Forms.Control 之类的类继承并创建 System.Windows.Forms.NewControl，是否有办法强制 .NET 将我的 System.Windows.Forms.NewControl 类用作 System.Windows.Forms .Control 以便所有内置控件都使用我的 System.Windows.Forms.NewControl？

IE。我想对控件的工作方式进行一些基本的更改，并且我希望将这些更改反映在所有控件中，而不必对每个控件类型进行子类化。

我知道扩展方法对此不起作用，因为它们需要显式调用，并且我希望更改属性和方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:22:03.953

不，你不能做这样的事情。OO 背后的理念是，编写代码遵守现有类的契约和行为的人可以相信该类将继续按照其设计方式运行，而无需担心用户干扰。这不是像 Ruby 这样的动态语言。

# javascript - 如何在javascript中的类之间共享变量

> ID：15844585
> 
> 赞同：0
> 
> 时间：2013-04-05T22:20:32.523
> 
> 标签：javascript, jquery

我通过在 jQuery/JS 之上构建自定义库来扩展我的 JS 知识，并且这些类必须相互交互。我来自 PHP，所以我可以使用静态变量，但在 JS 中不知道。这是我想要的一个例子：

```
var A = function() {
    this.myPublicVar = "thisShouldBePrintedFromClassB";
}

A.prototype = {
    showMyVar : function() {alert(this.myPublicVar);} // This gets triggered on direct access.
}

var B = function() {}
B.prototype = {
    // I have no idea how to to access A.myPublicVar
} 
```

任何人都可以为我提供简单的教程或任何东西？

PS：我刚刚开始扩展我的 JS 知识，使用 JS/jQuery 进行简单设计（使用选择器和构建数据验证器等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:24:21.887

您可以使用继承来访问变量。

```
var A = function() {
    this.myPublicVar = "thisShouldBePrintedFromClassB";
}

A.prototype = {
    showMyVar : function() {alert(this.myPublicVar);} // This gets triggered on direct access.
}

var B = function() {}
B.prototype = new A();
B.prototype.print = function(){
  alert(this.myPublicVar);
}

var b = new B();
b.print(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:23:15.570

```
var A = function() {
    this.myPublicVar = "thisShouldBePrintedFromClassB";
}

A.prototype = {
    showMyVar : function() {alert(this.myPublicVar);} // This gets triggered on direct access.
}

var B = function() {}
B.prototype = new A();  //This is what you're missing.

console.log(B.prototype.myPublicVar); 
```

# localization - 如何在 Google 协作平台上支持不同的语言？

> ID：15844598
> 
> 赞同：0
> 
> 时间：2013-04-05T22:22:04.503
> 
> 标签：localization, web, google-sites, sites

不使用 Google Web Translation Tool 是否可以支持不同的语言环境？

网络翻译似乎不适用于 Google 协作平台，一旦生成的代码 (javascript) 被 Google 协作平台页面编辑器（编辑 HTML）视为无效。也不支持基于头部的元标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T22:18:30.640

为每个语言环境创建一个新站点并同步它们的页面结构。您还可以使用此脚本创建机器翻译版本（尽管它们需要由母语人士修复）：

```
function localizepagestolocalizedsites() {

      var fromblog =  SitesApp.getPageByUrl("https://sites.google.com/a/yourdomain.com/english/home");
      var toblog =  SitesApp.getPageByUrl("https://sites.google.com/a/yourdomain.com/japanese/home");

      var nextbloc = 0;

      while (true) {
        var pages = fromblog.getAllDescendants({"start":nextbloc,"max":100});

        if (pages.length > 0){

          Logger.log("starting at.."+nextbloc+" there are .."+pages.length+" pages starting with.."+pages[0].getTitle());
          var i = nextbloc;
          for (var x in pages) {

            var localizedTitle = LanguageApp.translate(pages[x].getTitle(), "en", "ja");
            var localizedBody = LanguageApp.translate(pages[x].getHtmlContent(), "en", "ja");

            toblog.createWebPage(localizedTitle, pages[x].getName(), localizedBody);

            i = i + 1;          
          }    
        } else {
          break;      
        }
        nextbloc = nextbloc + 100;

      }      

    } 
```

# c++ - 在 OpenGL 中播放动画

> ID：15844619
> 
> 赞同：1
> 
> 时间：2013-04-05T22:23:59.127
> 
> 标签：c++, opengl, fltk

只想延迟几微秒，这样我就可以看到我的动画了。延迟功能不起作用。我正在使用 fltk，所以任何与它有关的东西也可以提供帮助。

```
for(i = 0; i < 1; i = i + 0.1)
{ 
    glClearColor(0.0f, 0.0f, 0.0f, 1.0f );
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glLoadIdentity();
    glTranslatef(i,i,1);
    glRotatef(spin, 0, 0, 1);
    delay(1000);
    glScalef(i,i,i);
    glutWireCube(1);        
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T00:34:37.857

您不会在 OpenGL 中以这种方式播放动画（从技术上讲，您可以将 SwapBuffers 放在循环的末尾，但这不是一个好主意）。

您应该做的是实现一个空闲处理程序，它在调用时发出重绘。在绘图函数中，您应该对调用显示函数之间的时间进行计时，以将动画推进该量。

*Never(!)*运行一个循环，在该循环中添加睡眠或类似内容。这样的代码对外部事件没有响应，现代操作系统会将表现出类似行为的程序视为无响应/挂起，并向用户显示允许终止程序的消息框。这不是你想要的。

# c - 语法错误：输入结束时的预期声明

> ID：15844622
> 
> 赞同：-4
> 
> 时间：2013-04-05T22:24:27.530
> 
> 标签：c, syntax

我不断收到以前从未见过的奇怪语法错误，我不确定它有什么问题。我可以得到一些额外的眼睛来帮助我找出问题所在吗？

错误内容为：错误：输入末尾的预期声明或语句粗线是它突出显示的错误。

```
void draw(int deck[SIZE])
{
     int i; 

     for(i = 0; i < 5; i++)
     {
           cards;
           putchar('\n');
           }

void cards()
{
         char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

         for(i=0; i<SIZE; i++)
    {       
        if(i%13 == 0 || i%13 == 10 || i%13 == 11 || i%13 == 12)
            printf("%s ", facecheck(i%13) );
        else printf("%d ", i%13+1);
        printf("of %s \n", suits[i/13]);
    };

**}** 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:27:50.270

You didn't close `draw` function. You're missing a `}` at the end:

```
void draw(int deck[SIZE])
{
     int i; 
     for(i = 0; i < 5; i++)
     {
           cards;
           putchar('\n');
     }
} //ADD ME PLEASE :( 
```

As stated on the comments, a good IDE could have caught this before compiling.

I also recommend you to indent your code so you can better match opening/closing braces.

Your code suffers from additional errors, I highly recommend you to read a tutorial and to review your code.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:26:52.037

'牌;' 看起来很可疑，因为它是函数的名称

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:32:12.730

```
 for(i=0; i<SIZE; i++)
        {       
           if(i%13 == 0 || i%13 == 10 || i%13 == 11 || i%13 == 12)
           printf("%s ", facecheck(i%13) );
           else printf("%d ", i%13+1);
           printf("of %s \n", suits[i/13]);
        }; //no need of semi-colon after curly brace
    }
 } //missing curly brace 
```

# multithreading - 在 CancellationToken 上停止 AcceptTcpClient

> ID：15844630
> 
> 赞同：1
> 
> 时间：2013-04-05T22:25:00.277
> 
> 标签：multithreading, sockets, .net-4.0, network-programming, tcplistener

有什么方法可以在 .net4 中检查 CancellationToken 同时接受客户端同步。

```
 while (!token.IsCancellationRequested)
    {
        //change this somehow to use check cancellation but keep this blocking
        TcpClient client = _tcpListener.AcceptTcpClient();
        var client= new myclient(client);
        _clients.Add(telemetryClient);
    } 
```

到目前为止我能做的最好的还不够干净：

```
 while (!token.IsCancellationRequested)
        {
            var acceptTask = Task<TcpClient>.Factory.FromAsync(_tcpListener.BeginAcceptTcpClient, _tcpListener.EndAcceptTcpClient, null);
            var tokenTask = Task.Factory.StartNew(() =>
                {
                    while (!token.IsCancellationRequested)
                    {
                        Thread.Sleep(1000);
                    }
                    return;
                }, token);
            Task.WaitAny(new Task[] { acceptTask ,tokenTask}, token);

            if (token.IsCancellationRequested)
                break;

            TcpClient client = acceptTask.Result;//_tcpListener.AcceptTcpClient();
            var client = new myclient(client);
            _clients.Add(telemetryClient);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T21:05:55.883

仅执行 Task.WaitAny(acceptTask, token) 还不够吗？

即我不明白为什么需要tokenTask。

此外，如果发生取消，然后 acceptTask 遇到异常，您可能会发现出现“未观察到的异常”情况。考虑使用 TaskScheduler.UnobservedTaskException 来捕获（并可能忽略）这些。

-麦克风

# c++ - 从循环中移除数据依赖

> ID：15844632
> 
> 赞同：1
> 
> 时间：2013-04-05T22:25:15.493
> 
> 标签：c++, loops

我有以下 C++ 循环：

```
for (i = LEN_MAX - 1; i >= 0; i--) {
            int j = i - LEN_MAX + len;      
            if (j < 0)
                break;
            int ind = a.getElem(j);
            short t = ind;
            ind = --c[ind];
            b.setElem(ind, t);
} 
```

我想做的是从中删除迭代之间的所有依赖关系。例如，在上面的循环中，该行`ind = --c[ind]`具有迭代间依赖关系，因为要减少，我需要具有上一次迭代的值。这是我正在寻找的转换示例：

从：

```
 for (i = 1; i < RADIX_MAX; i++) {
            if (i == radix)
                break;
            c[i] += c[i - 1];
            c[i] += temp;       
        } 
```

到：

```
 short temp = c[0];
        for (i = 1; i < RADIX_MAX; i++) {
            if (i == radix)
                break;
            c[i] += temp;     //this loop no longer depends on last iteration 
            temp = c[i];
        } 
```

我想将相同的技术应用于我发布的第一个循环，但我不确定如何。我想这样做的原因是因为它是优化我正在使用的工具的性能所必需的。有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:50:59.193

您提供的循环没有简单的转换来删除迭代间依赖项（并且您给出的第二个示例实际上并没有删除迭代间依赖项）。每次迭代都取决于上一次`c`迭代发生了什么，*而当前的实现无法解决*这个问题。如果您对算法和/或存储在其中的值和/或其中的值有所了解`c`，`a`您可以重新编写代码以删除订单依赖性，鉴于您提供的一小段代码，我们无法做到这一点.

# database - 使用 Excel 作为 ODBC 数据库

> ID：15844633
> 
> 赞同：10
> 
> 时间：2013-04-05T22:25:21.333
> 
> 标签：database, windows, excel, ms-access, odbc

我想知道，如何在 Excel 中创建一个数据库表，以便它可以与 ODBC 一起使用

我想使用 ODBC，我有两个选择，MS Access 或 Excel，

您可能知道，为了将某些 MS Access 文件或 Excel 文件指示为 ODBC 源，您需要遵循：

管理工具->数据源（ODBC）->选择用户DSN->从列表中选择“Excel文件”或“MS Access数据库”->按“配置”->最后选择文件（MS Access或Excel）为ODBC 源

好吧，它与 MS Access 配合得很好，我可以连接到文件并查看我在里面创建的所有表

但是说到Excel，虽然可以连接到文件，但是看不到我在里面创建的表格

我只是在“插入”选项卡中使用了“表格”，添加了一些标题作为列名，并给表格一个有意义的名称。这是这样做的方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-06T10:44:15.157

您可以通过多种方式引用 Excel 工作簿中的“表格”数据：

*   一个完整的工作表。
*   工作表上的命名单元格区域。
*   工作表上未命名的单元格区域。

Microsoft 知识库文章[257819](http://support.microsoft.com/kb/257819)的“使用代码选择 Excel 数据”部分对它们进行了详细说明。

最直接的方法是将数据保存在单独的工作表上，将列名放在第一行（从单元格 A1 开始），然后让实际数据从第 2 行开始，如下所示

![Excel](https://i.stack.imgur.com/9vVZB.png)

为了进行测试，我创建了一个名为“odbcFromExcel”的用户 DSN，它指向该工作簿......

![ODBC](https://i.stack.imgur.com/cwRA1.png)

...然后运行以下 VBScript 来测试连接：

```
Option Explicit
Dim con, rst, rowCount
Set con = CreateObject("ADODB.Connection")
con.Open "DSN=odbcFromExcel;"
Set rst = CreateObject("ADODB.Recordset")
rst.Open "SELECT * FROM [Sheet1$]", con
rowCount = 0
Do While Not rst.EOF
    rowCount = rowCount + 1
    If rowCount = 1 Then
        Wscript.Echo "Data row 1, rst(""LastName"").Value=""" &  rst("LastName").Value & """"
    End If
    rst.MoveNext
Loop
Wscript.Echo rowCount & " data rows found."
rst.Close
Set rst = Nothing
con.Close
Set con = Nothing 
```

结果是

```
C:\Users\Gord\Documents\__tmp>cscript /nologo excelTest.vbs
Data row 1, rst("LastName").Value="Thompson"
10 data rows found. 
```

我希望这对您的 Excel 连接问题有所帮助。

作为最后的评论，我不得不说，如果您在 Excel 中执行的操作需要“几秒钟”，但在 Access 中执行“大约需要 20-25 分钟”，那么我强烈怀疑您正在以**非常**低效的方式使用 Access方式，但这是另一个问题的主题（如果你想追求它）。

## 编辑

如果您想将数据插入 Excel 工作簿，那么这是可能的，但请注意 Excel ODBC 连接的默认设置是“只读”，因此您必须单击“选项>>”按钮并清除该复选框：

![只读](https://i.stack.imgur.com/MnC8F.png)

完成后，以下代码...

```
Option Explicit
Dim con
Set con = CreateObject("ADODB.Connection")
con.Open "DSN=odbcFromExcel;"
con.Execute "INSERT INTO [Sheet1$] (ID, LastName, FirstName) VALUES (11, 'Dumpty', 'Humpty')"
con.Close
Set con = Nothing
Wscript.Echo "Done." 
```

...确实会在 Excel 工作表中添加一个包含所提供数据的新行。

但是，这仍然不能解决当您将“嗅探器”应用程序指向 Excel ODBC DSN 时没有可供选择的“表”的问题。

您可以尝试的一件事是在第 1 行创建一个带有列标题的 Excel 工作表，然后选择这些*整列*并创建一个 Excel“定义名称”。然后，查看您的“嗅探器”应用程序是否将其识别为您可以选择的“表”名称。

FWIW，我在 Excel 工作簿中定义了名称`myTable`，`=Sheet1!$A:$C`然后我的原始代码在我使用时***起作用***`SELECT * FROM [myTable]`：

```
C:\Users\Gord\Documents\__tmp>cscript /nologo excelTest.vbs
Data row 1, rst("LastName").Value="Thompson"
1048576 data rows found. 
```

如您所见，它正确检索了第一个“记录”，但随后它无法识别有效数据的结尾并继续读取工作表中的约 100 万行。

我非常怀疑我是否会为此付出更多努力，因为我同意其他评论，即使用 Excel 作为“ODBC 数据库”确实不是一个好主意。

我强烈建议您尝试找出为什么您之前使用 Access 的尝试如此不令人满意。正如我之前所说，在我看来，在与 Access 交互方面做得**非常糟糕。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T14:50:07.913

我最近对一些数据也有类似的问题。我设法绕过它的方法是将数据选择为范围 A1:XY12345，然后使用定义名称工具来命名范围。当您通过 ODBC 连接到 Excel 工作簿时，此命名范围将显示为“表格”，而您实际定义（每个 Excel）为表格的范围则不会。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-30T14:15:26.663

您只需从 Excel 文件的第一行中选择尽可能多的列，然后在编辑栏左侧的编辑框中为其命名。当然，您也可以为文件的每一列命名！

# linux - SED 替换为“可能的”换行符

> ID：15844650
> 
> 赞同：0
> 
> 时间：2013-04-05T22:27:00.967
> 
> 标签：linux, sed

我有一个运行良好的 sed 命令，除非它在文件的某处遇到换行符。这是我的命令：

```
sed -i 's,<a href="\(.*\)">\(.*\)</a>,\2 - \1,g' 
```

现在，它工作得很好，但我刚刚遇到了这个带有如下`a`标签的文件：

```
<a href="link">Click
        here now</a> 
```

当然没有找到这个。所以我需要以某种方式修改它以允许在搜索中换行。但我不知道如何让它允许这样做，除非我先检查整个文件并`\n`事先删除所有文件。问题是我丢失了文件中的所有格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:45:49.880

您可以通过在 sed 脚本中插入一个循环来执行此操作：

```
sed -e '/<a href/{;:next;/<\/a>/!{N;b next;};s,<a href="\(.*\)">\(.*\)</a>,\2 - \1,g;}' yourfile 
```

照原样，这将在输出中留下一个嵌入的换行符，并且不清楚你是否想要这样。如果没有，只需替换换行符：

```
sed -e '/<a href/{;:next;/<\/a>/!{N;b next;};s/\n//g;s,<a href="\(.*\)">\(.*\)</a>,\2 - \1,g;}' yourfile 
```

也许清理额外的空间：

```
sed -e '/<a href/{;:next;/<\/a>/!{N;b next;};s/\n//g;s/\s\{2,\}/ /g;s,<a href="\(.*\)">\(.*\)</a>,\2 - \1,g;}' yourfile 
```

解释：`/<a href/{...}`让我们忽略我们不关心的行。一旦我们找到我们喜欢的，我们检查它是否有结束标记。如果不是 ( `/<\a>/!`) 我们抓取下一行和一个换行符 (N) 和分支 (b) 回到 :next 看看我们是否已经找到它。一旦我们找到它，我们将继续进行替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:46:01.497

这是一个快速而肮脏的解决方案，假设链接中不会有超过一个换行符：

```
sed -i '' -e '/<a href=.*>/{/<\/a>/!{N;s|\n||;};}' -e 's,<a href="\(.*\)">\(.*\)</a>,\2 - \1,g' 
```

第一个命令 ( `/<a href=.*>/{/<\/a>/!{N;s|\n||;};}`) 检查`<a href=...>`without的存在`</a>`，在这种情况下，它将下一行读入模式空间并删除换行符。第二个是你的。

# java - 阻止客户端关闭与 netty 服务器的连接（我需要设置什么）？

> ID：15844657
> 
> 赞同：0
> 
> 时间：2013-04-05T22:27:23.237
> 
> 标签：java, tcp, netty

我正在调试我正在编写的netty代理的问题，我注意到即使我跳过“代理”方面并实现一个简单的http服务器并从commons httpclient串行发送两个请求，commons httpclient也会关闭连接和第二个请求是在不同的连接中进行的。另一方面，如果我代理请求，则第二个请求使用相同的连接，但是当我尝试将第二个请求的响应写入客户端通道时，我得到一个“连接重置”异常。

我的管道和基本处理程序的代码：

```
 ChannelFactory factory =
            new NioServerSocketChannelFactory(
                    Executors.newCachedThreadPool(),
                    Executors.newCachedThreadPool());
    ServerBootstrap sb = new ServerBootstrap(factory);

    sb.setPipelineFactory(new ChannelPipelineFactory() {
        public ChannelPipeline getPipeline() {
            return Channels.pipeline(
                    new HttpRequestDecoder(),
                    new HttpResponseEncoder(),
                    new RequestHandler());
        }
    });

private static class RequestHandler extends SimpleChannelHandler {

    @Override
    public void messageReceived(ChannelHandlerContext ctx, final MessageEvent e) {
        HttpResponse clientResponse = new DefaultHttpResponse(HttpVersion.HTTP_1_1, HttpResponseStatus.OK);
        clientResponse.setHeader(HttpHeaders.Names.CONTENT_TYPE, "text/html; charset=UTF-8");
        clientResponse.setContent(ChannelBuffers.wrappedBuffer(new byte[] {1, 2, 3}));
        System.out.println("here: " + e.getChannel());
        e.getChannel().write(clientResponse);
    }
} 
```

这是端口 2080 上的 tcpdump，显示客户端正在关闭连接（open-handshake、push、push、close-handshake、open-handshake、push、push、close-handshake）：

```
[master] sudo tcpdump -i any '(port 2080)'
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes
15:13:22.396482 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [S], seq 3122841582, win 32792, options [mss 16396,sackOK,TS val 880723828 ecr 0,nop,wscale 7], length 0
15:13:22.396499 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.45724: Flags [S.], seq 604436385, ack 3122841583, win 32768, options [mss 16396,sackOK,TS val 880723829 ecr 880723828,nop,wscale 7], length 0
15:13:22.396511 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [.], ack 1, win 257, options [nop,nop,TS val 880723829 ecr 880723829], length 0
15:13:22.406805 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [P.], seq 1:1600, ack 1, win 257, options [nop,nop,TS val 880723839 ecr 880723829], length 1599
15:13:22.406817 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.45724: Flags [.], ack 1600, win 256, options [nop,nop,TS val 880723839 ecr 880723839], length 0
15:13:22.446068 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.45724: Flags [P.], seq 1:63, ack 1600, win 256, options [nop,nop,TS val 880723878 ecr 880723839], length 62
15:13:22.446083 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [.], ack 63, win 257, options [nop,nop,TS val 880723878 ecr 880723878], length 0
15:13:22.449192 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [F.], seq 1600, ack 63, win 257, options [nop,nop,TS val 880723881 ecr 880723878], length 0
15:13:22.449360 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.45724: Flags [F.], seq 63, ack 1601, win 256, options [nop,nop,TS val 880723881 ecr 880723881], length 0
15:13:22.449371 IP localhost.localdomain.45724 > localhost.localdomain.autodesk-nlm: Flags [.], ack 64, win 257, options [nop,nop,TS val 880723881 ecr 880723881], length 0
15:13:22.449716 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [S], seq 929672323, win 32792, options [mss 16396,sackOK,TS val 880723882 ecr 0,nop,wscale 7], length 0
15:13:22.449729 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.35737: Flags [S.], seq 1626218986, ack 929672324, win 32768, options [mss 16396,sackOK,TS val 880723882 ecr 880723882,nop,wscale 7], length 0
15:13:22.449737 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [.], ack 1, win 257, options [nop,nop,TS val 880723882 ecr 880723882], length 0
15:13:22.449986 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [P.], seq 1:1600, ack 1, win 257, options [nop,nop,TS val 880723882 ecr 880723882], length 1599
15:13:22.449992 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.35737: Flags [.], ack 1600, win 256, options [nop,nop,TS val 880723882 ecr 880723882], length 0
15:13:22.453566 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.35737: Flags [P.], seq 1:63, ack 1600, win 256, options [nop,nop,TS val 880723886 ecr 880723882], length 62
15:13:22.453582 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [.], ack 63, win 257, options [nop,nop,TS val 880723886 ecr 880723886], length 0
15:13:22.475867 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [F.], seq 1600, ack 63, win 257, options [nop,nop,TS val 880723908 ecr 880723886], length 0
15:13:22.475998 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.35737: Flags [F.], seq 63, ack 1601, win 256, options [nop,nop,TS val 880723908 ecr 880723908], length 0
15:13:22.476012 IP localhost.localdomain.35737 > localhost.localdomain.autodesk-nlm: Flags [.], ack 64, win 257, options [nop,nop,TS val 880723908 ecr 880723908], length 0 
```

如果我使用代理会发生以下情况，该代理实质上是从 中保存通道`messageReceived()`，并稍后查找该通道以编写响应。请注意，这里的通道没有关闭，而是由客户端重置，导致 IOException 'connection reset'：

```
[master] sudo tcpdump -i any '(port 2080)'
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked), capture size 65535 bytes
15:11:02.055316 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [S], seq 1055230627, win 32792, options [mss 16396,sackOK,TS val 880583487 ecr 0,nop,wscale 7], length 0
15:11:02.055333 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.58266: Flags [S.], seq 596566447, ack 1055230628, win 32768, options [mss 16396,sackOK,TS val 880583487 ecr 880583487,nop,wscale 7], length 0
15:11:02.055344 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [.], ack 1, win 257, options [nop,nop,TS val 880583487 ecr 880583487], length 0
15:11:02.066169 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [P.], seq 1:1600, ack 1, win 257, options [nop,nop,TS val 880583498 ecr 880583487], length 1599
15:11:02.066188 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.58266: Flags [.], ack 1600, win 256, options [nop,nop,TS val 880583498 ecr 880583498], length 0
15:11:02.071439 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.58266: Flags [P.], seq 1:1568, ack 1600, win 256, options [nop,nop,TS val 880583503 ecr 880583498], length 1567
15:11:02.071450 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [.], ack 1568, win 256, options [nop,nop,TS val 880583503 ecr 880583503], length 0
15:11:02.076384 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [P.], seq 1600:3199, ack 1568, win 256, options [nop,nop,TS val 880583508 ecr 880583503], length 1599
15:11:02.080625 IP localhost.localdomain.autodesk-nlm > localhost.localdomain.58266: Flags [P.], seq 1568:3135, ack 3199, win 256, options [nop,nop,TS val 880583513 ecr 880583508], length 1567
15:11:02.102018 IP localhost.localdomain.58266 > localhost.localdomain.autodesk-nlm: Flags [R.], seq 3199, ack 3135, win 256, options [nop,nop,TS val 880583534 ecr 880583513], length 0 
```

我的处理程序中是否缺少一些东西来阻止客户端关闭连接？

编辑：阅读响应似乎会导致连接重置消失并且连接被正常断开。知道为什么这个 println 会在第二次请求后阻止连接重置吗？

```
httpClient.executeMethod(method);
System.out.println(method.getResponseBodyAsString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T00:09:05.017

您的处理程序正在发送 HTTP v1.1 响应，其中 keep-alive 是默认连接类型，因此只要您的客户端期望 v1.1 而不是 v1.0，并且行为正确，那么您不必做任何事情更多以指示客户端保持连接打开。

如果您的客户端期待 HTTP v1.0，您可以添加一个“Connection: keep-alive”标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T19:58:27.570

终于想通了。有几个问题。最重要的问题是我没有从发起对该代理的调用的公共 HttpClient 调用 method.releaseConnection()。出于某种原因，调用 getResponseBodyAsString() 或 getResponseBodyAsStream.close() 也消除了重置问题。

# visual-studio-2010 - Setup/MSI - Multiple user input directories

> ID：15844661
> 
> 赞同：0
> 
> 时间：2013-04-05T22:27:46.037
> 
> 标签：visual-studio-2010, windows-installer, installation, inno-setup

I'm in need of a setup creation tool (preferably outputing MSI file but not necessary) that is able to prompt the user for a "core" installation directory, and then prompt a second time for a "runfile" directory.

I've messed around a bit in Visual Studio 2010 and with Inno Setup but can't seem to find a solution.

Any suggestions?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-06T12:08:53.290

A list with the best tools available currently: [http://en.wikipedia.org/wiki/Windows_Installer#Tools](http://en.wikipedia.org/wiki/Windows_Installer#Tools)

# php - PHP 函数作用域失败

> ID：15844663
> 
> 赞同：3
> 
> 时间：2013-04-05T22:27:57.020
> 
> 标签：php, api, class, function, scope

我正在努力理解范围以及阻止我的新代码工作的原因（假设它是范围问题）。

以下函数位于`PATH.'/includes/custom-functions.php'`引用类的文件中：

```
 function infusion() {
      require_once(PATH.'/classes/infusion.php'); //PATH is defined in WordPress from ~/wp-content/themes/theme/
      return new infusion();
    } 
```

该类依赖于目录`PATH.'/api/isdk.php'`中另一个文件的连接凭据。`/api/`从内部，我有许多其他功能可以完美`PATH .'/includes/custom-functions.php'`调用和工作。`$infusion = infusion();`

**问题**
我创建了一个新文件：`PATH.'/includes/report.php'`我需要访问`$infusion = infusion();`但无法通过重复`function infusion()`上面的定义来工作；使用`require_once();`；或使用`include();`. 所有这 3 个选项只会杀死其余的代码，我只能得出结论 - 好吧，我没有结论。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:33:33.743

我假设代码没有使用命名空间，因此不允许您重新声明`infusion`函数（通过重新定义函数或重新包含类）。

您的`includes/report.php`文件应该简单地具有：

```
require_once PATH.'/includes/custom-functions.php';

// your other code here ...

$infusion = infusion(); 
```

可能是您包含在文件中的其他文件/类已经需要`custom-functions.php`沿线，因此您可以完全跳过它。另请注意，在您尝试使用该`PATH`常量之前，应该已经在某处（直接或通过 d 文件）定义了它。`include`如果您设置`error_reporting`为 include `E_ALL`，如果该常量不存在，您将在错误日志中收到通知。

如果失败，您的错误日志可能会提供一些关于您的问题的额外背景。

# c - Is there a ring buffer implementation in the standard gcc distribution?

> ID：15844664
> 
> 赞同：4
> 
> 时间：2013-04-05T22:28:04.060
> 
> 标签：c, gcc, circular-buffer

I want to use a ring buffer but do not want to implement my own if one already exists. Does the standard gcc distribution have one?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-23T07:39:31.533

一些不直接在*gcc*中的替代方案，

*   在维基百科中，您可以找到一个[POSIX 循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer#Optimized_POSIX_implementation)
*   Zed Shaw在他的 C 书籍中有[一个循环缓冲区章节](http://c.learncodethehardway.org/book/ex44.html)
*   [boost 库](http://www.boost.org/doc/libs/1_39_0/libs/circular_buffer/doc/circular_buffer.html)有一个用于 C++的库：

# android - 按一天中的小时分组结果行 sqllite android

> ID：15844665
> 
> 赞同：0
> 
> 时间：2013-04-05T22:28:13.503
> 
> 标签：android, sqlite, time

表中有条目包含 2 列（整数数据、时间）。时间存储在 TEXT 中，格式为 HH:MM，这是标准格式之一（根据[sqllite 文档](http://www.sqlite.org/lang_datefunc.html)）。'integerdata' 是一些整数。我正在寻找按一天中的小时分组的行内容，整数数据为每小时的 AVG(integerdata)。例如行：

```
(10, 10:01)
(2, 10:25)
(5, 11:01)
(9, 11:25) 
```

我希望输出如下：

```
6, 10:00 
7, 11:00 
```

一种新手和**可怕**的方法是对每个小时范围进行查询（进行 24 个查询）。就像是：

```
SELECT AVG(integerdata) from table WHERE time BETWEEN 'time1' AND 'time2'
//time1 and time2 can vary between 10:00 to 11:00; then 11:00 to 12:00 ... 
```

第二种方法可能是使用 GROUP BY 子句，但我不确定如何。我用谷歌搜索并试图在stackoverflow上查看一些答案，但没有任何帮助。我真的很感激任何贡献。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:50:40.947

> 我正在寻找按一天中的小时分组的行内容，整数数据为每小时的 AVG(integerdata)。

这是我的第一个想法。由于您的时间仍然是`TEXT`，您可以使用[`substr()`](http://www.sqlite.org/lang_corefunc.html)函数从时间列中仅获取小时，然后您可以在 `GROUP BY`子句中使用此子字符串。

```
Select AVG(integerdata), SUBSTR(time, 0, 3) as gt from Table group by gt; 
```

我假设您的时间格式`HH:MM`在这种情况下`SUBSTR(time, 0, 3)`仅返回小时，现在您可以开始按小时分组。

它返回：`10`, `11`, `12`, ...

# java - 从本地网络外部访问服务器

> ID：15844671
> 
> 赞同：-1
> 
> 时间：2013-04-05T22:28:29.697
> 
> 标签：java, java-server

我有一个用 Java 编写的服务器，它基本上等待来自不同客户端的请求并为他们的请求提供服务。我正在从 Eclipse 运行此服务器。此服务器可在本地网络上访问，但我希望能够从本地网络外部访问此服务。请问有什么办法吗？

PS我是这些东西的真正初学者

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:31:52.853

您可以在路由器中打开一个端口，该端口通向服务器正在侦听的端口。然后，您连接到您的公共 IP。这个ip可以[在](http://www.visaminip.se/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:35:11.760

您还可以下载 Hamachi 之类的内容，然后下载 Hamachi 并在其他 PC 和 Mac（以及 Linux ......目前处于测试阶段）上登录您的网络。然后，您将希望能够访问您的服务器。

*   [Hamachi主产品页面](https://secure.logmein.com/products/hamachi/)
*   [Linux 测试版](https://secure.logmein.com/labs/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:17:53.243

正如@Java Player 所说，问题在于您的路由器（Nat）拒绝任何传入本地网络的数据包......简而言之，有很多解决方案：

1.  **第三方服务器**：您必须在客户端/服务器程序之间有一个充当中介角色的专用服务器。

    优点：

    *   彻底解决与Nat相关的问题。

    缺点：

    *   除了您的客户端之外，您还必须编写另一个将数据包转发到所需目的地的第三方。

    *   顺便说一句，它有点重（浪费带宽）。

2.  [**反向连接**](http://en.wikipedia.org/wiki/Reverse_connection)：服务器和客户端程序颠倒过来，即客户端变成服务器，服务器变成客户端，'*大部分木马都使用*...

    优点：

    *   这种方法很容易实现。

    缺点：

    *   你必须至少有一个开放的端口。
3.  [**udp 打孔**](http://en.wikipedia.org/wiki/UDP_hole_punching)：这种方法可能被所有对等解决方案（例如：skype、utorrent...）使用。

    优点：

    *   您不需要任何路由器配置。
    *   对等点之间的直接连接。

    缺点：

    *   您还需要调用第三方服务器`STUN server`来获取有关您的路由器的信息。
    *   并非所有使用 udp 打孔的路由器，您还必须考虑第一个解决方案。
    *   编写打孔解决方案并非易事。

# python - 在 Pygraphviz 中创建的重复边

> ID：15844673
> 
> 赞同：0
> 
> 时间：2013-04-05T22:29:13.043
> 
> 标签：python, python-2.7, tree, graphviz, pygraphviz

我正在使用 PyGraphviz 生成具有多个级别和节点的分层树状结构。每当我尝试在两个节点之间创建一条边时（我为树中的每个节点分配了唯一索引），Pygraphviz 都会生成两条边，同时考虑实际节点值和索引，而我期望它只创建一条边节点唯一索引之间。请看下面的示例代码和图。

**示例代码：**

```
from pygraphviz import *

word_link = []
A = AGraph(directed=True)
ind = 0
A.add_node(ind, color='lightskyblue', style='filled', label='Root', shape='box')
sen_ind = ind + 1
# sentence 1
A.add_node(sen_ind, color='lightcoral', style='filled', label=0, shape='box')
A.add_edge(ind, sen_ind, color='plum', style='filled')
word_ind = sen_ind + 1
# word 1
A.add_node(word_ind, color='lightsalmon', style='filled', shape='box', label=0)
word_link.append(word_ind)
A.add_edge(sen_ind, word_ind, color='plum', style='filled')
word_ind += 1
# word 2
A.add_node(word_ind, color='lightsalmon', style='filled', shape='box', label=1)
A.add_edge(sen_ind, word_ind, color='plum', style='filled')
sen_ind = word_ind + 1
# sentence 2
A.add_node(sen_ind, color='lightcoral', style='filled', label=1, shape='box')
A.add_edge(ind, sen_ind, color='plum', style='filled')
word_ind = sen_ind + 1
# word 1
A.add_node(word_ind, color='lightsalmon', style='filled', label=0, shape='box')
A.add_edge(sen_ind, word_ind, color='plum', style='filled')
word_ind += 1
# word 2
A.add_node(word_ind, color='lightsalmon', style='filled', label=1, shape='box')
word_link.append(word_ind)
A.add_edge(sen_ind, word_ind, color='plum', style='filled')

# doesn't work | need a fix
A.add_edge(word_link[0], word_link[1], color='sienna', style='filled')

A.layout()  # layout with default (neato)
A.draw('simple.png',prog='dot') # draw png 
```

**使用重复边生成的树** ![在此处输入图像描述](https://i.stack.imgur.com/aT32l.png)

**预期数字：** ![在此处输入图像描述](https://i.stack.imgur.com/Ewzd4.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:12:59.707

尝试添加`constraint=False`：

```
A.add_edge(word_link[0], word_link[1], constraint=False, color='sienna', style='filled') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-11T13:11:56.043

您也可以尝试定义等级（级别）

看到这个答案另一个用途给了我一个类似的问题：

[Pygraphviz / networkx 设置节点级别或层](https://stackoverflow.com/questions/22207802/pygraphviz-networkx-set-node-level-or-layer/22214653#22214653)

# android - 异常 android.os.NetworkOnMainThreadException","code":"503"

> ID：15844679
> 
> 赞同：0
> 
> 时间：2013-04-05T22:30:11.720
> 
> 标签：android

这是我的代码：

```
private static JSONObject doGetRequest(String url) throws JSONException {
    System.out.println("doGetRequest > url : " + url);
    JSONObject json = null;
    HttpClient httpClient = new DefaultHttpClient();
    HttpGet httpGet = new HttpGet(url);
    HttpResponse response;
    System.out.println("doGetRequest > httpGet " + httpGet);
    try {
        System.out.println("doGetRequest > before response ");
        response = httpClient.execute(httpGet);
        System.out.println("doGetRequest > response " + response);
        if(response.getStatusLine().getStatusCode() == 200) {
            HttpEntity entity = response.getEntity();
            if (entity != null) {
                InputStream instream = entity.getContent();
                String result = convertStreamToString(instream);
                instream.close();

                json = new JSONObject(result);
            }
        } else {
            json = oDeskRestClient.genError(response.getStatusLine().getStatusCode(), response.getStatusLine().toString());
        }
    } catch (ClientProtocolException e) {
        json = oDeskRestClient.genError(HTTP_RESPONSE_503, "Exception: ClientProtocolException");
    } catch (IOException e) {
        json = oDeskRestClient.genError(HTTP_RESPONSE_503, "Exception: IOException");
    } catch (JSONException e) {
        json = oDeskRestClient.genError(HTTP_RESPONSE_503, "Exception: JSONException");  
    } catch (Exception e) {
        json = oDeskRestClient.genError(HTTP_RESPONSE_503, "Exception: Exception " + e.toString());
    } finally {
        httpGet.abort();
    }
    System.out.println("doGetRequest > json: " + json);
    return json;
} 
```

我收到异常： 异常 android.os.NetworkOnMainThreadException","code":"503" 在这一行： HttpClient httpClient = new DefaultHttpClient();

谁能帮我解决这个错误？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:36:42.433

查看[文档](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)。基本上，您需要启动一个[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)（例如）并在其中调用您的方法。

从第二个链接：

```
private class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
     protected Long doInBackground(URL... urls) {
         int count = urls.length;
         long totalSize = 0;
         for (int i = 0; i < count; i++) {
             totalSize += Downloader.downloadFile(urls[i]);
             publishProgress((int) ((i / (float) count) * 100));
             // Escape early if cancel() is called
             if (isCancelled()) break;
         }
         return totalSize;
     }

     protected void onProgressUpdate(Integer... progress) {
         setProgressPercent(progress[0]);
     }

     protected void onPostExecute(Long result) {
         showDialog("Downloaded " + result + " bytes");
     }
 } 
```

> 一旦创建，任务就会非常简单地执行：

```
 new DownloadFilesTask().execute(url1, url2, url3); 
```

在你的情况下，当然，你需要打电话`doGetRequest`而不是`Downloader.downloadFile(urls[i])`

# c# - 遍历 WebBrowser 控件 DOM - 具有子元素和文本的元素

> ID：15844682
> 
> 赞同：1
> 
> 时间：2013-04-05T22:30:26.277
> 
> 标签：c#, dom, webbrowser-control

我正在尝试使用 C# 遍历 WebBrowser 控件的 DOM，并对每个 HtmlElement 执行一些处理。（我同时对 DOM 进行了一些转换，但对于本次讨论，假设我试图通过递归遍历每个节点来展平 DOM）

当我遇到类似的事情时：

```
<p>Text with a <a href="http://www.example.com/">link</a> in the middle of it </p> 
```

我找到了 P 标记的 HtmlElement（其中包含预期的 InnerText）和对应于标记 A 的子 HtmlElement 节点。A 标记的 HtmlElement 包含预期的内部文本。

*但我找不到任何与 A 标签前后的文本相关的结构或属性。*

除了将 P 标签的 InnerHtml 属性与 A 标签的 OuterHtml 属性进行比较的可怕技巧之外，有没有办法在 A 标签的文本之前和之后找到文本？

还是有另一种方式来遍历 IE DOM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:35:29.420

为了在 DOM 中获取文本节点，QI（C# 中的一种类型`HtmlElement.DomElement`转换）是`mshtml.IHTMLDOMNode`.

然后你可以通过`IHTMLDOMNode.childNodes`. 然后枚举`IHTMLDOMNode.childNodes`集合，查找类型为 3（文本）的节点。如果您还想在子元素中查找文本节点，请对类型 1 子节点重复此操作。

# javascript - 如何访问使用 JustGage 创建的新对象的值参数？

> ID：15844684
> 
> 赞同：2
> 
> 时间：2013-04-05T22:30:44.380
> 
> 标签：javascript, graphael, justgage

我没有去挖掘，因为我认为 JustGage 有什么方法等并不重要，但我有这个新对象`g`。

```
var g = new JustGage({
    id: "gauge", 
    value: 34, 
    min: 0,
    max: 100,
}); 
```

我的问题是如何稍后在脚本中检索 value 参数。

我以为这`var value = g.value`会起作用，但事实并非如此。

这是 justgage.js 文件的一部分：

```
 JustGage = function(config) {

  if (!config.id) {alert("Missing id parameter for gauge!"); return false;}
  if (!document.getElementById(config.id)) {alert("No element with id: \""+config.id+"\" found!"); return false;}

  var obj = this;

  // configurable parameters
  obj.config =
  {
    // id : string
    // this is container element id
    id : config.id,

    // title : string
    // gauge title
    title : (config.title) ? config.title : "",

    // titleFontColor : string
    // color of gauge title
    titleFontColor : (config.titleFontColor) ? config.titleFontColor : "#999999",

    // value : int
    // value gauge is showing
    value : (config.value) ? config.value : 0, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:35:24.537

尝试`g.config.value`- 从查看 JustGage 源代码，我认为它会在那里。

# c# - 我如何在 C# 中编写这个 java 代码

> ID：15844685
> 
> 赞同：0
> 
> 时间：2013-04-05T22:30:57.093
> 
> 标签：c#, java, arrays, stringbuilder, formatter

我有一个称为数字的整数数组

```
public String toDecimalString() {
        StringBuilder b = new StringBuilder(9 * digits.length);
        Formatter f = new Formatter(b);
        f.format("%d", digits[0]);
        for(int i = 1 ; i < digits.length; i++) {
            f.format("%09d", digits[i]);
        }
        return b.toString();
    } 
```

我试过

```
String.Format("%09d", digits[i]); 
```

但我认为我做错了什么

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:35:55.577

我对java格式化程序不是很熟悉，但我认为这就是你想要的

```
var str = string.Format("{0:D9}", digits[i]); 
```

甚至更好

```
var str = digits[i].ToString("D9"); 
```

要加入所有这些字符串，我建议这样做：

```
var str = string.Join(string.Empty, digits.Select(d => d.ToString("D9"))); 
```

**延伸阅读**

*   [标准数字格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)
*   [自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:49:36.877

我想你想要类似的东西

```
StringBuilder sb = new StringBuilder();
sb.append(String.Format("DL", digits[i]));
for (int i = 1; i < digits.Length; i++) {    
    sb.append(String.Format("D9", digits[i]));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T00:00:31.077

**从 java 代码中**复制并将其直接****粘贴**到 c# 代码中，然后更改（在您的`toDecimalString()`方法中）：**

 ***   f.format 到 f. **格式**_
*   数字长度到数字。**长度**_
*   b.toString() 到 b. **字符串**（）

然后将此类粘贴到您的代码中：

```
public partial class Formatter: IFormatProvider, ICustomFormatter {
    public String Format(String format, object arg, IFormatProvider formatProvider=null) {
        if(!format.StartsWith("%")||!format.EndsWith("d"))
            throw new NotImplementedException();

        m_Builder.Append(String.Format("{0:D"+format.Substring(1, format.Length-2)+"}", arg));
        return m_Builder.ToString();
    }

    object IFormatProvider.GetFormat(Type formatType) {
        return typeof(ICustomFormatter)!=formatType?null:this;
    }

    public Formatter(StringBuilder b) {
        this.m_Builder=b;
    }

    StringBuilder m_Builder;
} 
```

**请注意**，该类仅实现了您的问题所述的**最低要求**，如果您进一步扩展要求，则需要添加代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T23:10:40.653

```
 public string toDecimalString()
{
    StringBuilder b = new StringBuilder(9 * digits.Length);
    var str = digits[0].ToString("D");
    b.Append(str);
    for (int i = 1; i < digits.Length; i++)
    {
        var str2 = digits[i].ToString("D9");
        b.Append(str2);
    }                
    return b.ToString();
} 
```

谢谢大家的回答，我终于找到了上面的解决方案**

# ios - ios 6 - 加载数据后触发segue

> ID：15844687
> 
> 赞同：0
> 
> 时间：2013-04-05T22:31:33.017
> 
> 标签：ios, ios6, uitableview, afnetworking, segue

我在 TableView 中有一些数据。我想要的是在用户点击行后立即调用服务。主要问题是“performToSegue”首先调用，因此在目标控制器的 tableView 中没有数据填充。

检索数据后如何调用 segue？

非常感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:41:07.613

*   您需要删除情节提要中从单元格拖动到下一个 viewController 的 segue。
*   接下来通过从当前控制器拖动到下一个控制器来进行segue

![在此处输入图像描述](https://i.stack.imgur.com/tK3qM.png)

现在在`UITableViewController`实施

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
    {
      // Do some network request
      // on completion call
      [self performSegueWithIdentifier:@"theIdentifierUsedInStoryboard" sender:self];
    } 
```

# node.js - 将函数传递给下一个函数，根据条件触发。节点

> ID：15844691
> 
> 赞同：1
> 
> 时间：2013-04-05T22:32:09.420
> 
> 标签：node.js, asynchronous, express

我使用 express.js 创建一个 node.js REST 服务器，作为其中的一部分，我还创建了一个简单的会话系统。我有 3 个模块：

*   应用程序.js
*   highscoreMan.js
*   用户会话.js

app.js url`http://localhost/api/highscores`现在使用给定参数调用 userSession：

```
//Get all highscores
app.get('/api/highscores', function (req, res) {
  userSession.checkValidity(req.query['username'], req.query['sessionid'], highscoreMan.getAll(req, res));
}); 
```

但是，在 checkValidity 中，我传递的函数被自动调用：

```
function checkValidity(username, sessionId, callback) {
  userSession.findOne({ userid: username, sessionid: sessionId }, function (err, result) {
        if (err) {
          console.log(err);
        }
        if(result) {
          callback;
        }
  });
} 
```

我只想运行正在传递的函数，因为我从数据库中获得了正确的结果（稍后将针对会话日期等添加其他检查）。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T00:47:40.957

要延迟调用`highscoreMan.getAll()`，您需要将其声明为`function`可以稍后调用*的*另一个语句：

```
app.get('/api/highscores', function (req, res) {
  userSession.checkValidity(req.query['username'], req.query['sessionid'], function () {
    highscoreMan.getAll(req, res);
  });
}); 
```

否则，将立即调用它，并将其`return`值传递给`userSession.checkValidity()`.

请注意，您还需要调整`checkValidity`以调用传递的`callback`：

```
// ...
if(result) {
  callback();
}
// ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T00:33:27.940

除非我不完全理解你的问题，否则你不能做这样的事情吗？

```
if (result && some_validator(result)) {
    callback();
} 
```

# javascript - 互联网连接丢失时的 ajax 错误处理程序

> ID：15844695
> 
> 赞同：0
> 
> 时间：2013-04-05T22:32:31.793
> 
> 标签：javascript, ajax, jquery, error-handling

我有一些 ajax 调用，我想在其中添加处理程序以防出现错误。我找到了“错误”处理程序，但这不起作用，即**当互联网连接丢失时**。这些案件是否有第二个处理程序？

```
$.ajax({
      type: "GET",
      url: "dosomethink.php",
      success: function (data) {
        $('#abc').html(data);
      },
      error: function (xhr, ajaxOptions, thrownError) {
        alert(xhr.status);
        alert(thrownError);
      }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-22T04:44:06.107

如果您使用超时和错误方法怎么办

```
$.ajax({type: 'GET',url: '/controller/action',timeout: 15000,success: function(data) {},error: function(XMLHttpRequest, textStatus,errorThrown) {}}); 
```

# android - 带有 cookie 身份验证的 DownloadManager

> ID：15844697
> 
> 赞同：5
> 
> 时间：2013-04-05T22:32:51.030
> 
> 标签：android, android-download-manager, download-manager

我正在尝试使用 DownloadManager 从我的服务器解析带有 JSESSIONID 的 cookie 来获取 zip 文件。我正在使用 HTTPCLIENT lib 完成我所有的进程登录并设置一个变量 JSESSIONID 以供以后在我的 DownloadManager 请求中使用。

我的下载请求：

```
 DownloadManager.Request request = new DownloadManager.Request(Uri.parse(htmlUrlDownload));

    request.addRequestHeader("Cookie", "JSESSIONID=" + JSESSIONID);
    request.addRequestHeader(Constants.USER_AGENT, Constants.TARGET_REQUEST_HEADER);

    request.setDescription("Baixando " + metaDado.getType());
    request.setTitle("Download");
    request.allowScanningByMediaScanner();
    request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);

    String nameFile = offlineUuid + ".zip";

    fileName = nameFile;

    filePath = Environment.getExternalStorageDirectory() + File.separator + Environment.DIRECTORY_DOWNLOADS
            + File.separator + fileName;

    request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, nameFile);

    final DownloadManager manager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);

    final long downloadId = manager.enqueue(request); 
```

问题是下载永远不会开始，并且 COLUMN_REASON 返回一个代码到[ERROR_UNHANDLED_HTTP_CODE](http://developer.android.com/reference/android/app/DownloadManager.html)

但是，如果我尝试使用未经身份验证的 Dropbox 链接或使用 httpclient 下载相同的文件，它会完美运行，我做错了什么？

如何获得更好的味精错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T11:54:24.790

您的代码没有任何问题，似乎您的服务器正在响应 HTTP 重定向状态代码，这导致 DownloadManager 无法处理下载。

**来自 Android 文档**：-

> 公共静态最终 int ERROR_UNHANDLED_HTTP_CODE
> 
> 当收到下载管理器无法处理的 HTTP 代码时，在 API 级别 9 中添加了 COLUMN_REASON 的值。

请参见下面的代码片段：-

**从 Android Framework 源码[下载Manger.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/app/DownloadManager.java)**

```
case Downloads.Impl.STATUS_UNHANDLED_HTTP_CODE:
                case Downloads.Impl.STATUS_UNHANDLED_REDIRECT:
                    return ERROR_UNHANDLED_HTTP_CODE; 
```

因此，您需要检查您的服务器日志是否存在此问题，或将直接文件 url 传递给不会导致任何重定向的下载管理器。

另请注意，您需要 Androidmanifest.xml 中的以下两个权限才能按预期工作

```
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

# c++ - 使基类设置父类的正确方法

> ID：15844700
> 
> 赞同：3
> 
> 时间：2013-04-05T22:32:56.470
> 
> 标签：c++, oop

我在以下情况下有点挣扎：假设我有一个类“Base”，它需要一些信息才能正常工作。因此，我设置了一个带有适当参数的构造函数，例如：

```
class Base {
    public: Base(X x, Y y, Z z);
}; 
```

这适用于一般的“基地”。但我希望有代表特定“基础”的子类，这些“基础”经常使用，并且包含设置基类所需的所有信息，例如：

```
class Derived {
    public: Derived() {
        X x;
        x.addSomeInformation("foo bar");
        // ...
        // now what?
    }
}; 
```

这里的问题是我不能通过初始化列表调用父构造函数（通常会这样做），因为要移交的参数还不存在。

因此，我觉得我的设计存在严重问题。我可以通过引入一个受保护的默认构造函数和一个模仿普通构造函数的“配置”方法来完成这项工作，但我不确定这是否是一个好主意（主要是因为这样我不能确保子类实际调用“配置“ - 如果不是这样，那会给我留下一个未正确初始化的基类）：

```
class Base {
    public: Base(X x, Y y, Z z) { configure(x, y, z); }
    protected: Base() {}
    protected: void configure(X x, Y y, Z z);
};

class Derived {
    public: Derived() {
        X x;
        // ...
        configure(x, y, z);
    }
}; 
```

如何以适当的方式处理这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:59:26.263

我的第一个建议是创建`X`一个有价值的构造函数，而不是强制它默认构造：

```
class Derived {
    public: Derived() : Base(X("foo bar"), <blah>) {
    }
}; 
```

如果这不是一个选项，请将 X-creation 逻辑拆分为另一个函数并使用它：

```
class Derived {
    public: Derived() : Base(make_X(), <blah>) {
    }
    private: static X make_X() {
        X x;
        x.addSomeInformation("foo bar");
        // Anything else needed.
        return x;
    }

}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:52:03.547

整个`configure`（有时称为`initialize`）方法概念似乎确实是可行的方法。实际上，作为游戏开发项目的一部分，我自己过去曾遇到过这个问题，我只是使用了与您提出的类似的解决方案，而以后不会再被它咬伤。

只要此类不是某些公共 API 的一部分（即使确实如此），您也不应该担心如果有人不调用`configure`. 如果您真的想通过将参数设置为左右无效值来破坏很多 API，但这并不意味着这些 API 不好。只需确保清楚地记录此使用模式即可。

你会感到不安，因为事实上，人们认为正确性依赖于某个方法的代码必须在某个时间调用某个其他方法是不好的。他们是对的，只要这会影响代码的*可读性*（甚至可能影响性能），在您的情况下这根本不是真的。具有`initialize`（或任何您想调用的）方法以及构造函数的对象*不是*坏习惯，并且使用这样的方法实际上是编程中广泛使用的习惯用法。

另一件肯定有帮助的事情是将基类设计为在 X/Y/Z 坏时**尽快失败。**这样，任何可能因忘记调用而弹出的错误都`configure`可以在引起更大问题之前被捕获和修复。

另一种方法是重新考虑（如果可能的话）等对象的构建方式`X`，`Y`并为这些类的用户（在本例中为您）提供更多通过构造函数初始化它们的可能性。将这些对象划分为子组件（如果适用于您的情况）也可能有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:21:01.143

这是一个非常不同的答案，但您可以检查组合而不是继承。

即派生“真的”是一个基础吗？

另一种选择是考虑创建一个工厂方法，该方法负责完成最终使用所需参数调用构造函数所需的所有工作。（这基本上就是 Mark B 在他的第二个例子中展示的内容（差不多）。

或者，让 Derived 将 base.x 和 base.y 修改为它们需要的内容，并且由于使用了这些设置器，因此更新了基础构造中应该发生的任何事情。

听起来隐藏委托人可能是有益的，因此您可以通过工厂强制所有构建，该工厂始终可以在返回它创建的具体产品之前调用 product->config。

# c#-4.0 - @Url.action 强制转换异常

> ID：15844701
> 
> 赞同：1
> 
> 时间：2013-04-05T22:32:57.147
> 
> 标签：c#-4.0, url.action

我正在尝试在要单击的链接上实现@Url.Action。

```
 link = "@Url.Action("ExportWeeklyTimesheetPDF", "Hours", new { projectId = Model.ProjectId, reportType = 'Week', reportDate = 'reportDate'})"
 link.replace("reportDate",dateString);
 $("#exportPDF").attr("href", link); 
```

当我尝试添加时，reportType = 'Week', reportDate = 'reportDate' 我不断收到未处理的强制转换异常。如果我没有reportType 和reportDate，它工作正常。如何解决这个烂摊子？任何帮助，将不胜感激。

谢谢尼基尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:43:31.643

您似乎正在尝试将 C# 方法的返回值分配给 javascript 变量，然后用另一个 javascript 变量替换其中的一部分。如我错了请纠正我。

您需要仔细查看并弄清楚您所写的内容。它不起作用，因为您使用的是单引号而不是双引号，并且 javascript`link.replace`行只会替换`reportDate`.

此代码应该可以工作：

```
@{
  string url = Url.Action("ExportWeeklyTimesheetPDF", "Hours", new { projectId = Model.ProjectId, reportType = "Week", reportDate = "replaceWithReportDate"});
}

link = "@url";
link.replace("replaceWithReportDate", dateString);
$("#exportPDF").attr("href", link); 
```

您仍然需要确保`replaceWithReportDate`结果链接中的 更改为预期格式。

# c - 排序数组无法使方法工作

> ID：15844703
> 
> 赞同：-1
> 
> 时间：2013-04-05T22:33:15.727
> 
> 标签：c

标签是将您的问题与其他类似问题分类的关键字或标签。标签是将您的问题与其他类似问题分类的关键字或标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:38:53.557

在以下三个代码块中，我将首先编写您的行，然后是它应该是什么：

```
String[] sort = new String[listNames];
String[] sort = new String[listNames.length];
                                    ^^^^^^^ 
```

* * *

```
for (int x = 0; x < sort; x++) {
for (int x = 0; x < sort.length; x++) {
                        ^^^^^^^ 
```

* * *

```
sort[x] = JOptionPane.showMessageDialog(" Tutor LAST NAME and FIRST NAME Listed in Alphabetically Order"+(x+1)+ " " + "For example: 'Smith, John'");
sort[x] = JOptionPane.showMessageDialog(null, " Tutor LAST NAME and FIRST NAME Listed in Alphabetically Order"+(x+1)+ " " + "For example: 'Smith, John'");
                                        ^^^^^ 
```

假设你真的想在排序之前创建一个新数组，你的方法应该是：

```
public static String[] sortNames(String[] listNames) {
    String[] copy = Arrays.copyOf(listNames, listNames.length);
    Arrays.sort(copy);
    return copy;
} 
```

如果它必须是一个方法，但您不必创建第二个数组，您可以这样做：

```
public static void sortNames(String[] listNames) {
    Arrays.sort(listNames);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:35:38.437

你应该改变

```
for (int x = 0; x < sort; x++) 
```

到

```
for (int x = 0; x < sort.length; x++) 
```

反而。和

```
String[] sort = new String[listNames]; 
```

到

```
String[] sort = new String[listNames.length]; 
```

此外，`JOptionPane.showMessageDialog()`应该以这种方式使用：

```
JOptionPane.showMessageDialog(null," Tutor LAST NAME and FIRST NAME Listed in Alphabetically Order"+(x+1)+ " " + "For example: 'Smith, John'"); 
```

# android - 使用 Sencha Mobile Packager 修改 AndroidManifest

> ID：15844707
> 
> 赞同：1
> 
> 时间：2013-04-05T22:33:44.760
> 
> 标签：android, sencha-touch-2, sencha-cmd

我正在使用 Sencha Touch 2 开发移动应用程序，并且我正在使用 Sencha Cmd 3.1 生成 de APK 文件。

但似乎它有某种 Bug 显示应用程序上的 Android Native 标题栏。我想隐藏它，因为我正在为标题栏使用 Sencha 组件...

在[Sencha 2.1 新闻](http://www.sencha.com/blog/whats-new-in-sencha-touch-21/)中，他们这样说：

> “打包程序配置还允许您通过 rawConfig 键将“原始”数据传递给 iOS info.plist 和 Android AndroidManifest.xml。我们还听取了您关于非管理员访问本机打包程序的反馈，我们更新了设置因此不再需要管理员访问权限。”

但是当我去[Sencha 官方文档](http://docs.sencha.com/touch/2-1/#!/guide/native_packaging)时，他们说这个 rawConfig 键仅适用于 iOS。

令人沮丧！我找到的唯一解决方案是修改 Base AndroidManifest.xml 并添加此代码...`android:theme="@android:style/Theme.NoTitleBar".`

但我想以好的方式做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T18:52:05.423

我没有使用 Sencha Cmd 3.1，但是如果你升级到 4.0.4.84 版本，解决方案很简单。如果您将 Sencha 与“Phonegap”一起使用，您需要做的就是深入研究 config.xml。您可以使用此文件为不同平台定义各种配置。

在此处查找文档：http: [//docs.build.phonegap.com/en_US/#googtrans%28en%29](http://docs.build.phonegap.com/en_US/#googtrans%28en%29) [http://docs.build.phonegap.com/en_US/configuring_basics.md.html#The%20Basics](http://docs.build.phonegap.com/en_US/configuring_basics.md.html#The%20Basics)

# php - PHP 和 MySQL 编码 UTF8

> ID：15844708
> 
> 赞同：0
> 
> 时间：2013-04-05T22:33:48.533
> 
> 标签：php, mysql, encoding, utf-8

**大家好；**

我们在字符编码方面遇到了一些奇怪的问题：

我们使用带有 UTF+8 的 Notepad++，没有 BOM 并将信息发送到数据库（mysql）：

当插入：“análisis”时，它会插入“análisis”

任何人都知道这怎么可能发生？

提前致谢！

--

**编辑：如果我手动将信息插入 MySQL 表，它可以正常工作。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:37:15.493

UTF8 EN/DECODE 可能是你需要的，[Leer > PHP UTF8 EN/DECODE](http://php.net/manual/en/function.utf8-decode.php)

还 `mysql_query("SET NAMES utf8");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:38:25.930

Try this query:

```
SET NAMES utf8 
```

And send explicit UTF-8 headers:

```
header('Content-type: text/html; charset=utf-8'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T22:39:16.493

You'll need to verify the character encoding of the column (which is either explicitly defined on the column, or using the table / database defaults). Also make sure that no encoding-unsafe functions are modifying the string before inserting.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T22:40:03.050

我认为您需要按如下方式更新数据库字符集：

```
ALTER DATABASE db_name DEFAULT CHARACTER SET 'utf8'; 
```

我希望这对你有用！

# button - 页面回发 - 双重绑定

> ID：15844709
> 
> 赞同：0
> 
> 时间：2013-04-05T22:33:49.070
> 
> 标签：button, data-binding, datagrid, postback, modal-dialog

我有一个网页，该网页具有根据所选日期和过滤器动态构建的数据网格。在 itemdatabound 上，为每个单元格创建了一个链接按钮，因此单击时将打开一个模式弹出窗口，其中包含可以修改的详细信息。我遇到的问题是，当我更改过滤器（datepicker、btnShow）时，页面绑定了两次并复制了网格中的列。如果我放一个！= page.ispostback，当我单击一个单元格链接按钮时，数据网格就会消失。请帮忙

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true"
    CodeBehind="Frm.aspx.cs" Inherits="web.Frm" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="asp" %>
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <script type="text/javascript" language="javascript" src="Scripts/script.js"> </script>
    <script src="Scripts/jquery-1.8.3.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>

    <script language="javascript" type="text/javascript">
        $(document).ready(function () {
            $('#<%= datepicker.ClientID %>').datepicker({ changeMonth: true, changeYear: true });
        });

    </script>

    <asp:ScriptManager runat="server" ID="scriptManager" EnablePageMethods="true">
    </asp:ScriptManager>
    <asp:Button ID="btnShowPopupAmend" Style="display: none" runat="server" />
    <!--Start:Amend Details-->
    <asp:ModalPopupExtender ID="mpeAmend" runat="server" TargetControlID="btnShowPopupAmend"
        PopupControlID="pnlpopupAmend" CancelControlID="imgCancel" BackgroundCssClass="modalBackground" />
    <asp:Panel ID="pnlpopupAmend" runat="server" Width="700px" Style="display: none;"
        class="ModalPanel">
        <asp:Panel ID="pnlInner" runat="server" BackColor="white" Width="700px">
            <table style="width: 700px;" class="BG">
                <tr>
                    <td width="10px">
                        &nbsp;
                    </td>
                    <td align="left">
                        <asp:Label ID="lbl" runat="server" Text="Amend" CssClass="norm_w" Font-Bold="True"></asp:Label>
                    </td>
                    <td align="right">
                        <asp:Button ID="btnAmendCloseConfirm" runat="server" Text="x" OnClick="imgCancel_Click">
                        </asp:Button>
                    </td>
                </tr>
                </tr>
                <table style="width: 700px;">
                    <tr height="25">
                        <td width="10px">
                            &nbsp;
                        </td>
                        <td>
                            <asp:Label ID="Label1" runat="server" CssClass="norm">&nbsp;Name:</asp:Label>
                        </td>
                        <td>
                            <asp:Label ID="LblName" runat="server" CssClass="norm"></asp:Label>

                        </td>
                    </tr>
                    <tr height="25">
                        <td width="10px">
                            &nbsp;
                        </td>
                        <td valign="top">
                            <asp:Label ID="Label4" runat="server" CssClass="norm">&nbsp;Address:</asp:Label>
                        </td>
                        <td>
                            <asp:TextBox ID="TxtAddress" runat="server" CssClass="norm_no_border" TextMode="MultiLine"
                                Rows="4" Width="300px" Style="overflow: hidden"></asp:TextBox>
                        </td>
                    </tr>
                </table>
                <br />
                <asp:Button ID="imgCancel" Text="cancel" Height="25px" Width="80px" runat="server"
                    OnClick="imgCancel_Click" />
        </asp:Panel>
    </asp:Panel>
    <!--End:Amend Details-->
    <!--Start:Filters-->
    <div>
        <asp:Label ID="Lbl1" runat="server" CssClass="norm">Show Details:</asp:Label>
        <asp:CheckBox ID="ChkDetails" runat="server"></asp:CheckBox>
        <asp:Label ID="Lbl2" runat="server" CssClass="norm"> Show Names:</asp:Label>
        <asp:CheckBox ID="ChkNames" runat="server"></asp:CheckBox>
        &nbsp;<asp:Button ID="btnShow" Text="Go" runat="server" OnClick="btnShow_Click">
        </asp:Button>
    </div>
    <!--End:Filters-->
    <br />
    <!--Start:Grid-->
    <div>
        <asp:Label ID="lblBeginning" runat="server" CssClass="head2">&nbsp;&nbsp;Week:</asp:Label>
        &nbsp;&nbsp;<asp:TextBox ID="datepicker" runat="server" AutoPostBack="true" CssClass="norm"
            OnTextChanged="datepicker_TextChanged"></asp:TextBox>
     <br />
    </div>
    <asp:DataGrid ID="dgData" runat="server" CssClass="DG" Width="100%" CellPadding="4"
        AutoGenerateColumns="False" GridLines="Vertical" OnItemDataBound="dgData_ItemDataBound">
        <AlternatingItemStyle CssClass="Alternating"></AlternatingItemStyle>
        <ItemStyle CssClass="Item"></ItemStyle>
        <Columns>
            <asp:TemplateColumn>
                <HeaderStyle CssClass="head"></HeaderStyle>
                <ItemStyle CssClass="bdr"></ItemStyle>
            </asp:TemplateColumn>
        </Columns>
    </asp:DataGrid>
    <!--End:Grid--> 
```

后面的代码

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (!Page.IsPostBack)
            {

                if (Session["Week"] != null)
                {
                    DateTime dDate = DateTime.Parse(Session["Week"].ToString());
                    datepicker.Text = Utils.GetFirstDateOfWeek(dDate, DayOfWeek.Monday).ToString("dd MMM yyyy");
                }
                else
                {
                    datepicker.Text = Utils.GetFirstDateOfWeek(DateTime.Now, DayOfWeek.Monday).ToString("dd MMM yyyy");
                    Session["Week"] = datepicker.Text.ToString();
                }

            }
            BindData(datepicker.Text, ChkDetails.Checked, ChkNames.Checked);

        }

        protected void datepicker_TextChanged(object sender, EventArgs e)
        {
            BindData(datepicker.Text, ChkDetails.Checked, ChkNames.Checked);
            Session["Week"] = datepicker.Text.ToString();
        }
        protected void BindData(string sWkDate, Boolean bDetails, Boolean bNames)
        {
            DataSet ds = null;
            ds = ListGridDetails(sWkDate);

            //  .................
        }
        protected void dgData_ItemDataBound(object sender, DataGridItemEventArgs e)
        {

            if (e.Item.ItemType == ListItemType.AlternatingItem | e.Item.ItemType == ListItemType.Item | e.Item.ItemType == ListItemType.SelectedItem)
            {
                LinkButton lnk = default(LinkButton);
                lnk = new LinkButton();
                lnk.Text = "Amend";
                lnk.CommandName = "Amend";
                lnk.CommandArgument = id;
                lnk.Command += new CommandEventHandler(AmendButtonClick);
                e.Item.Cells[i].Controls.Add(lnk);

            }
        }
        public void AmendButtonClick(object sender, CommandEventArgs e)
        {

            //.............

            this.mpeAmend.Show();

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:35:40.217

在回发`Page_Load`时也会调用并且您的绑定逻辑会调用，因为它不属于`!Page.IsPostBack`. 试试用这个

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {

        if (Session["Week"] != null)
        {
            DateTime dDate = DateTime.Parse(Session["Week"].ToString());
            datepicker.Text = Utils.GetFirstDateOfWeek(dDate, DayOfWeek.Monday).ToString("dd MMM yyyy");
        }
        else
        {
            datepicker.Text = Utils.GetFirstDateOfWeek(DateTime.Now, DayOfWeek.Monday).ToString("dd MMM yyyy");
            Session["Week"] = datepicker.Text.ToString();
        }

        BindData(datepicker.Text, ChkDetails.Checked, ChkNames.Checked);
    }
} 
```

# android - 滚动 GridView 时保留填充条

> ID：15844710
> 
> 赞同：25
> 
> 时间：2013-04-05T22:33:57.477
> 
> 标签：android

我有这个`GridView`（见屏幕截图），其中包含所有需要大约 12 个倾角间距的项目。但是，当我在 上设置填充时`GridView`，似乎我无法滚动我想要做的这个 paddingm。我如何实现这一目标？

请注意我要滚动的前两张图片上方的空间片：

![滚动时的屏幕截图](https://i.stack.imgur.com/ry2ZN.png)

代码：

```
<GridView
    android:id="@+id/feed_grid"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:columnWidth="96dp"
    android:gravity="center"
    android:horizontalSpacing="@dimen/grid_view_margins"
    android:numColumns="auto_fit"
    android:padding="@dimen/grid_view_margins"
    android:stretchMode="columnWidth"
    android:scrollbarStyle="outsideInset"
    android:verticalSpacing="@dimen/grid_view_margins" /> 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-04-20T18:27:03.950

`android:clipToPadding="false"`将解决您的目的

# ios - 使用 CATransform3DRotate 设置 layer.transform，如 UIViewAnimationOptionTransitionFlipFromRight

> ID：15844711
> 
> 赞同：2
> 
> 时间：2013-04-05T22:33:57.487
> 
> 标签：ios, transformation, catransform3d

我设置了一个视图，这样当应用程序向前导航时，它`transitionFromView`使用该`UIViewAnimationOptionTransitionFlipFromRight`选项执行。这会产生如下效果：

![使用 UIViewAnimationOptionTransitionFlipFromRight](https://i.stack.imgur.com/T5aCW.png)

向后导航使用`UIViewAnimationOptionTransitionFlipFromLeft`，但其他方面相同。好的，到目前为止，一切都很好。

现在，我还设置了一个`UIPanGestureRecognizer`，以便我可以将视图的翻转与用户在屏幕上的水平手势联系起来。但显然我不能`transitionFromView`在那种情况下使用，所以我的手势识别器是手动设置 with 的`transform`属性`layer`：

```
CATransform3D transform = CATransform3DIdentity;
transform.m34 = 1.0 / -800.0;
viewToTransform.layer.transform = CATransform3DRotate(transform, M_PI * rotationPercent, 0.0, 1.0, 0.0); 
```

但这会产生微妙的不同效果：

![CATransform3D旋转](https://i.stack.imgur.com/HspFJ.png)

在翻转动画期间视图的`UIViewAnimationOptionTransitionFlipFromRight`选项`transitionFromView`被缩放，以便翻转视图的最高边缘保持容器视图的高度。但是当手动执行 时`transform`，`layer`视图的中心保持不变的大小，在动画期间略微裁剪翻转视图的较长边缘的角。

`transform`在我的手势识别器中设置属性时如何实现这种效果`layer`（我可能也想调整我`opacity`的 ，以获得轻微的调光效果`transitionFromView`）。我想我可以使用`CATransform3DMakeScale`并根据旋转角度和我的特定`m34`设置手动计算缩放函数，但在我进行那个练习之前，我想确保我没有忽略一些更直观或更自然的方法实现标准翻转动画所需的同时缩放和旋转。即使我必须手动计算比例因子，我也会很感激关于如何将它定义为`m34`设置和角度的函数的指导（我不是矢量变换的精妙之处的专家）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T14:57:03.263

变换都基于您的图层锚点。那是您旋转的“枢轴点”。

anchorPoint 在 x 和 y 中使用从 0 到 1 的比例，默认为 0.5、0.5

我相信您会希望您的图层设置如下所示：

```
viewToTransform.layer.anchorPoint = CGPointMake(0.5, 1); 
```

这个问题的答案中有一些很好的信息和研究地点：

[更改我的 CALayer 的锚点会移动视图](https://stackoverflow.com/questions/1968017/changing-my-calayers-anchorpoint-moves-the-view)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-13T20:49:52.273

HalR 是正确的，为了达到预期的效果，应该改变`anchorPoint`. 因此，对于围绕视图右边缘旋转的水平翻转，可以按如下方式设置锚点：

```
viewToTransform.layer.anchorPoint = CGPointMake(1, 0.5); 
```

但是，这也会改变视图，因此需要将新值`anchorPoint`与`CATransform3D`将视图转换回原来位置的值相结合。例如，这是一个 Swift 3 自定义过渡“动画控制器”，它执行水平翻转动画。

```
class HorizontalFlipAnimationController: NSObject, UIViewControllerAnimatedTransitioning {

    enum TransitionType {
        case presenting
        case dismissing
    }

    let transitionType: TransitionType

    init(transitionType: TransitionType) {
        self.transitionType = transitionType

        super.init()
    }

    func animateTransition(using transitionContext: UIViewControllerContextTransitioning) {
        let inView   = transitionContext.containerView
        let toView   = transitionContext.view(forKey: .to)!
        let fromView = transitionContext.view(forKey: .from)!

        var frame = inView.bounds

        func flipTransform(angle: CGFloat, offset: CGFloat = 0) -> CATransform3D {
            var transform = CATransform3DMakeTranslation(offset, 0, 0)
            transform.m34 = -1.0 / 1600
            transform = CATransform3DRotate(transform, angle, 0, 1, 0)
            return transform
        }

        toView.frame = inView.bounds
        toView.alpha = 0

        let transformFromStart:  CATransform3D
        let transformFromEnd:    CATransform3D
        let transformFromMiddle: CATransform3D
        let transformToStart:    CATransform3D
        let transformToMiddle:   CATransform3D
        let transformToEnd:      CATransform3D

        switch transitionType {
        case .presenting:
            transformFromStart  = flipTransform(angle: 0,        offset: inView.bounds.size.width / 2)
            transformFromEnd    = flipTransform(angle: -.pi,     offset: inView.bounds.size.width / 2)
            transformFromMiddle = flipTransform(angle: -.pi / 2)
            transformToStart    = flipTransform(angle: .pi,      offset: -inView.bounds.size.width / 2)
            transformToMiddle   = flipTransform(angle: .pi / 2)
            transformToEnd      = flipTransform(angle: 0,        offset: -inView.bounds.size.width / 2)

            toView.layer.anchorPoint = CGPoint(x: 0, y: 0.5)
            fromView.layer.anchorPoint = CGPoint(x: 1, y: 0.5)

        case .dismissing:
            transformFromStart  = flipTransform(angle: 0,        offset: -inView.bounds.size.width / 2)
            transformFromEnd    = flipTransform(angle: .pi,      offset: -inView.bounds.size.width / 2)
            transformFromMiddle = flipTransform(angle: .pi / 2)
            transformToStart    = flipTransform(angle: -.pi,     offset: inView.bounds.size.width / 2)
            transformToMiddle   = flipTransform(angle: -.pi / 2)
            transformToEnd      = flipTransform(angle: 0,        offset: inView.bounds.size.width / 2)

            toView.layer.anchorPoint = CGPoint(x: 1, y: 0.5)
            fromView.layer.anchorPoint = CGPoint(x: 0, y: 0.5)
        }

        toView.layer.transform = transformToStart
        fromView.layer.transform = transformFromStart
        inView.addSubview(toView)

        UIView.animateKeyframes(withDuration: self.transitionDuration(using: transitionContext), delay: 0, options: [], animations: {
            UIView.addKeyframe(withRelativeStartTime: 0, relativeDuration: 0.0) {
                toView.alpha = 0
                fromView.alpha = 1
            }
            UIView.addKeyframe(withRelativeStartTime: 0, relativeDuration: 0.5) {
                toView.layer.transform = transformToMiddle
                fromView.layer.transform = transformFromMiddle
            }
            UIView.addKeyframe(withRelativeStartTime: 0.5, relativeDuration: 0.0) {
                toView.alpha = 1
                fromView.alpha = 0
            }
            UIView.addKeyframe(withRelativeStartTime: 0.5, relativeDuration: 0.5) {
                toView.layer.transform = transformToEnd
                fromView.layer.transform = transformFromEnd
            }
        }, completion: { finished in
            toView.layer.transform = CATransform3DIdentity
            fromView.layer.transform = CATransform3DIdentity
            toView.layer.anchorPoint = CGPoint(x: 0.5, y: 0.5)
            fromView.layer.anchorPoint = CGPoint(x: 0.5, y: 0.5)

            transitionContext.completeTransition(!transitionContext.transitionWasCancelled)
        })
    }

    func transitionDuration(using transitionContext: UIViewControllerContextTransitioning?) -> TimeInterval {
        return 1.0
    }
} 
```

这会产生：

[![示例翻转](https://i.stack.imgur.com/wCOsU.gif)](https://i.stack.imgur.com/wCOsU.gif)

# java - 将应用程序/xml POST 消息发送到 REST API 不起作用

> ID：15844712
> 
> 赞同：1
> 
> 时间：2013-04-05T22:34:13.713
> 
> 标签：java, rest, post, jaxb, jax-rs

这是带有 JAX-RS 注释的 POST 方法：

```
@POST
@Consumes(MediaType.APPLICATION_XML)
@Produces(MediaType.TEXT_PLAIN)
public Response storeUser(User user) {

   boolean wasStored = JPAUserStore.storeUser(user);

   if (wasStored) {
      return Response.ok("User was stored.").build();
   } else {
      return Response.status(Status.BAD_REQUEST).build();   
   }

} 
```

这是带有 JAXB 注释的 User 类：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public User {

  @XmlElement(name = "Name")
  protected String name;

  @XmlElement(name = "Address")
  protected String address;

  public void setName(String name) {
     this.name = name;
  }

  public String getName() {
     return this.name;
  }

  public void setAddress(String address) {
     this.address = address;
  }

  public String getAddress() {
     return this.address;
  }

} 
```

REST Web 服务在 Jetty 上运行。当我发送内容类型为“application/xml”和此正文的请求消息（使用 RESTClient Firefox 插件）时

```
 <?xml version="1.0" encoding="UTF-8"?>
 <User>
    <Name>Max</Name>
    <Address>Main Street 12</Address>
 </User> 
```

将向相应的资源返回 400 Bad 请求。根据日志，方法 JPAUserStore.storeUser(...) 未执行。

是什么原因，为什么@POST注解的方法不会被执行并返回OK？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T02:13:24.933

默认情况下，您的`User`类的根元素是`user`，您需要使用它`@XmlRootElement(name="User")`来匹配您的 XML 文档。

# java - Android - 如何设置路径在数组中的背景图像

> ID：15844713
> 
> 赞同：0
> 
> 时间：2013-04-05T22:34:20.647
> 
> 标签：java, android, arrays

我有以下数组：

```
final String[][] dataArr = {
        {"R.drawable.bengaltiger", "bengaltiger"},
        {"R.drawable.cat", "cat"},
        {"R.drawable.chimp", "chimp"},
        {"R.drawable.eagle", "eagle"},
        {"R.drawable.frog", "frog"},
        {"R.drawable.lamb", "lamb"},
        {"R.drawable.wolf", "wolf"},
}; 
```

从这个我试图播放声音并使用图像作为按钮的背景：

```
final Button guessRight = (Button) findViewById(R.id.butRight);
guessRight.setBackgroundResource(R.drawable.bengaltiger); 
```

无法使用 uri 在数组中的图像设置背景图像，因为函数“setBackgroundResource”需要一个 int 或一个我有字符串的 URI。

我的问题是如何将字符串转换为 URI，以便我可以在“setBackgroundResource”函数中使用数组中的路径？

我的方法正确吗？或者我应该使用另一种方式来存储我的数据或以不同的方式处理它？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:43:17.280

这里有很多问题。

1.  您似乎想使用字符串来保存每个 ID 的符号名称。你自己指出这行不通。
2.  您将这些存储在二维字符串数组中，这是错误的数据结构。

相反，您需要将这些存储在[Map](http://developer.android.com/reference/java/util/Map.html)中。

```
Map<Integer, String> imageMap = new HashMap<Integer, String>
// Put the other ones here.
imageMap.put(R.drawable.bengalTiger, "bengaltiger");
.
.
.

// Later on, use them like this:
for(Integer id : imageMap.keyset()) {
  String name = imageMap.get(id);
  // You can now use "id" and "name" in whatever UI elements you want.
} 
```

此外，如果您在列表中存储任意数量的 ID 和名称，那么为什么要让视图将它们从布局中放入？您似乎希望以编程方式创建它们，否则为什么不一开始就在 XML 布局中进行设置呢？

# python - 为什么我在 Python 中收到错误消息“无法导入名称 NoneType”？

> ID：15844714
> 
> 赞同：19
> 
> 时间：2013-04-05T22:34:21.247
> 
> 标签：python, python-3.x, porting

我正在尝试将一些代码从 2 转换为 3 以及以下简单脚本

```
import types
from types import NoneType 
```

结果是

> ImportError：无法导入名称 NoneType

如何将上述从 2 转换为 3？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-05T22:36:47.817

模块中不再有`NoneType`引用。`types`您应该直接检查身份`None`，即`obj is None`. 如果您真的需要 , 另一种方法`NoneType`是使用它：

```
NoneType = type(None) 
```

`types.NoneType`这实际上与之前定义的方式完全相同，在[2007 年 11 月 28 日](http://hg.python.org/cpython/rev/918bbee3a545)被删除之前。

作为旁注，您无需导入模块即可使用该`from .. import`语法，因此`import types`如果您不在其他任何地方使用模块引用，则可以放弃您的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-31T10:02:40.717

如果您的用例允许，您可以：

```
if my_dict.get('key'):  # By Default: returns None if key doesn't exists
    # Do something
else:
    # Do something with None 
```

None 是一个虚假值，因此您可以在不导入任何内容的情况下使用 if-else 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-05T15:03:47.630

在执行验证时，获取`NoneType`是有用的，可以缩写在`None`可接受类型的元组中传递允许类型的条件链。所以不要写这样的东西：

```
a = {...}
is_valid = (
    a.get(mandatory_field) is None
    or isinstance(a[mandatory_field], str)
) 
```

可以写：

```
is_valid = isinstance(a.get(mandatory_field), (str, NoneType)) 
```

可以通过将默认字符串值传递给来解决此问题`.get(...)`（因为在没有该字段的情况下，您将返回有意通过验证的内容，即使该值不存在），但它太hacky，晦涩难懂并且确实影响可读性。

由于`NoneType`不再是可以导入的东西，因此您可以在需要时制作自己的东西。这些是一些选项：

```
NoneType = type(None)
NoneType = None.__class__ 
```

如果您遵循 PEP8 建议，则 linter可能会抱怨调用的变量`NoneType`不符合您的命名约定。我发现`type(None)`在需要`NoneType`. 这只是两个字符的区别，就像可读性一样，您可以节省一行代码；）

上面代码片段的最终解决方案如下所示：

```
is_valid = isinstance(a.get(mandatory_field), (str, type(None))) 
```

# ios - “self”在 iOS 5.1 的调试器中不可用

> ID：15844719
> 
> 赞同：6
> 
> 时间：2013-04-05T22:34:47.917
> 
> 标签：ios, debugging

我正在尝试调试在 iOS 5.1 下运行的问题，当我在调试器中停止出现错误的代码并尝试使用调试器打印某些内容时，我收到以下消息：

> 错误：警告：在声称捕获 Objective-C 对象指针的上下文中停止，但“self”不可用；假装我们在一个通用的上下文中

打扰一下？有人知道我在这里对自己做了什么吗？

代码太复杂了，任何人都不想看——我主要希望有人能告诉我调试器消息的含义。

这过去只是间歇性地失败，但现在大部分都失败了。该操作通常（或可能总是）在我第一次在 iOS 5.1 中尝试时有效，偶尔在第一次之后，显然总是在 iOS 6 中有效。

如果它有助于了解一般上下文......我正在尝试将刚刚编写的对象添加到 ALAssetsGroup 所以这是在非 UI 线程上的完成块中。对于完成块，我有一个看起来很合理的堆栈回溯。失败是因为存储的 ALAssetsGroup 不再具有有意义的值——或者说它的 NSLog 知道它是一个 ALAssetsGroup 对象。这个值被分配在一个地方（并记录下来以便我跟踪它），我可以通过键值观察看到初始分配，我看不到它以 KVO-sorta 的方式被更改过。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-04-18T20:37:09.163

在构建设置中，设置`Precompile Prefix Header`为`NO`我修复它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T23:59:05.317

这是一个调试器错误（是的，想象一下！）

只需重新启动 XCode，这对您来说应该不再是问题了 :)

**编辑：**

精神！我在想别的东西。

您正在创建一个保留周期，到目前为止，调试器以这种方式对这个特定的保留周期进行分类（正如我所说，一个错误）。

要解决此问题，请创建以下内容的弱副本`self`：

`__weak __typeof(self)weakSelf = self;`

然后因为`self`那给你带来麻烦：

更改`self.object`为`weakSelf.object`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-04T14:55:57.503

在 Xcode 5 和 iOS 6.1 开发中，我也遇到了同样的情况。

我在*Release*模式下编译，如果有人再次遇到此问题，请检查您是否在*Debug*模式下编译。

# asp.net-mvc-3 - 将其转换为通用存储库模式

> ID：15844721
> 
> 赞同：2
> 
> 时间：2013-04-05T22:34:58.680
> 
> 标签：asp.net-mvc-3, entity-framework, repository-pattern, unit-of-work

我已经开始将项目转换为通用存储库和工作单元模式。到目前为止，我已经能够将控制器中的所有直接上下文引用逆向工程到通用存储库；但是，我在使用以下两行代码时遇到了问题：

```
`context.Entry(ticket).Collection(i => i.TicketItems).Load();
            ticket.TicketItems.Clear();` 
```

这是我的控制器之前所做的，以删除 a`Ticket`和 a之间的任何引用`TicketItem`。`Ticket`和之间存在多对多的关系`TicketItem`。所以这两行代码是我之前用来`TicketItems`从`Ticket`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T23:00:52.677

您可以在存储库界面中有两种方法 - 一种用于导航引用，另一种用于导航集合：

```
public interface IRepository<T>
{
    void LoadNavigationReference<TReference>(T entity,
        Expression<Func<T, TReference>> navigationProperty,
        params Expression<Func<TReference, object>>[] includes)
        where TReference : class;

    void LoadNavigationCollection<TElement>(T entity,
        Expression<Func<T, ICollection<TElement>>> navigationProperty,
        params Expression<Func<TElement, object>>[] includes)
        where TElement : class;
} 
```

它们也应该支持包括其他嵌套导航属性。实施将是：

```
public class Repository<T> : IRepository<T>
    where T : class
{
    private readonly MyContext _dbContext;

    public Repository(MyContext dbContext)
    {
        _dbContext = dbContext;
    }

    public void LoadNavigationReference<TReference>(T entity,
        Expression<Func<T, TReference>> navigationProperty,
        params Expression<Func<TReference, object>>[] includes)
        where TReference : class
    {
        if (includes == null || includes.Length == 0)
            _dbContext.Entry(entity).Reference(navigationProperty).Load();
        else
            _dbContext.Entry(entity).Reference(navigationProperty).Query()
                .IncludeMultiple(includes).Load();
    }

    public void LoadNavigationCollection<TElement>(T entity,
        Expression<Func<T, ICollection<TElement>>> navigationProperty,
        params Expression<Func<TElement, object>>[] includes)
        where TElement : class
    {
        if (includes == null || includes.Length == 0)
            _dbContext.Entry(entity).Collection(navigationProperty).Load();
        else
            _dbContext.Entry(entity).Collection(navigationProperty).Query()
                .IncludeMultiple(includes).Load();
    }
} 
```

上面使用的`IncludeMultiple`扩展方法取自[Ladislav Mrnka's answer here](https://stackoverflow.com/a/5376637/270591)。

您问题中的示例将如下所示：

```
repository.LoadNavigationCollection(ticket, i => i.TicketItems);
ticket.TicketItems.Clear(); 
```

哪里`repository`是类型`IRepository<Ticket>`。

如果`TicketItem`有另一个导航属性，比如`TicketItemDetails`，你可以用这种方式急切地加载它`TicketItems`：

```
repository.LoadNavigationCollection(ticket, i => i.TicketItems,
    t => t.TicketItemDetails); 
```

**编辑**

顺便说一句，作为关于通用存储库的关键旁注：以上是通用存储库的一部分，它实际上有 16 种方法，我在项目的早期阶段使用过，然后我停止扩展它并完全放弃这种风格。

该存储库一开始有大约 5 种方法（就像您在 Internet 上看到的大多数常用存储库一样）。仅使用这 5 种方法而不会失去很多 Entity Framework 的功能是不可能的。因此，我需要根据项目的实际需求逐步扩展它，并且在我将其从项目中删除之前，它从未变得“完整”。

问题是：如果你向某人展示接口（“这里我有一个超级通用且独立于技术的数据访问接口”），他会立即说“啊哈，你正在使用实体框架！”。原因是几乎每个方法都只是 Entity Framework 方法的包装，您无法通过使用接口方法的其他名称来隐藏它。整个界面有 EF `DbContext`/ Code-First 的味道。

现在，尝试使用实体框架以外的另一种技术来实现该接口。您很可能会遇到与我相同的问题：缺少很多方法来利用其他技术的强大功能，或者现有方法的参数错误，或者您无法合理地使用其他方法实现的方法太多技术。

我什至失败并失去了为单元测试构建该接口的内存实现的所有乐趣。

在我看来，这样的通用存储库是[泄漏抽象](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)的典型示例，您想到的真正实现通过整个接口闪耀。

但是如果你不能抽象出实体框架的使用，那么构建一个通用的存储库接口是毫无意义的。

# c++ - 重载二维数组运算符并抛出异常

> ID：15844722
> 
> 赞同：0
> 
> 时间：2013-04-05T22:35:05.187
> 
> 标签：c++, matrix, operator-overloading, multidimensional-array, square-bracket

我一直在思考这个问题，并没有想出任何有用的东西。我有由 2 个类表示的矩阵：

```
class CMatrix {
public:
    CMatrixRow * matrix;
    int height, width;
    CMatrix(const int &height, const int &width);
    CMatrix(const CMatrix &other);
    ~CMatrix();
    CMatrixRow operator [] (const int &index) const; 
    ...
}

class CMatrixRow {
public:
    int width;
    CMatrixRow(const int &width);
    CMatrixRow(const CMatrixRow &other);
    ~CMatrixRow();
    double operator [] (const int index) const;
    void operator =(const CMatrixRow &other);
private:
    double * row; 
```

};

其中 CMatrix 是矩阵行 (CMatrixRow) 的容器。当有人试图在其边界之外访问矩阵时，或者换句话说，使用的索引之一大于矩阵的大小时，我需要抛出异常。问题是，我需要以某种方式将第一个索引传递给方法

```
double operator [] (const int index) const; 
```

因此它可以抛出有关两个索引的信息的异常，无论其中哪一个是错误的。我也想让它尽可能简单。你能想到什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:41:17.457

您`CMatrixRow`需要能够找出它在您的容器中的哪一行。一种简单的方法是给`CMatrixRow`'s 的构造函数一个额外的参数，即它的行索引，然后它可以在创建后保留它。但是，这是一种冗余形式，如果您开始四处移动，可能会导致问题`CMatrixRow`。

通常使用`operator()`两个参数来实现矩阵访问，而不是`operator[]`通过辅助类来实现。所以，而不是`matrix[i][j]`，你会做`matrix(i, j)`。这使您的问题变得更加容易，并且还可能导致性能提高。请参阅[“为什么我的 Matrix 类的界面不应看起来像一个数组数组？”](http://www.parashift.com/c++-faq/matrix-array-of-array.html) 了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T18:14:09.947

最终我设法做到了这样

```
class CMatrix {
public:
    double ** matrix;
    int height, width, throwFirstIndex;

    class Proxy {
    public:
        Proxy(double * array, const int width, const int rowIndex, bool fail = false);
        double & operator [] (const int &index) const;
    private:
        double * row;
        int width, rowIndex;
        bool fail;
    };

    CMatrix(const int &height, const int &width);
    CMatrix(const CMatrix &other);
    ~CMatrix();
    Proxy operator [] (const int &index) const;
    ...
}; 
```

我基本上复制了这个：[Operator[][] 重载](https://stackoverflow.com/questions/6969881/operator-overload)

# d3.js - d3在项目上用鼠标悬停调用缩放图

> ID：15844724
> 
> 赞同：2
> 
> 时间：2013-04-05T22:35:12.167
> 
> 标签：d3.js

我在我的图表上附加了缩放功能，它工作正常。

当我将鼠标悬停事件附加到图表中的项目（矩形）时，鼠标悬停会触发，但不会调用缩放。

我试图让鼠标悬停使工具提示出现，并且“鼠标单击并拖动”使图表仅在 y 轴上平移。

有没有一种简单的方法可以让它们一起工作，或者我应该像这个例子一样自定义事件？

[http://bl.ocks.org/stepheneb/1182434](http://bl.ocks.org/stepheneb/1182434)

```
bar = g.selectAll(".bar")
            .data(currentData)
            .enter().append('rect')
            .attr("class", "horizontal bar")
            .attr("x", 0)

        .attr("height", ordinalScale.rangeBand())
            .attr("y", function(d) {
            return ordinalScale(d.key);
        })
            .attr("width", 0)
            .on("mouseover", function(d) {

            tooltip = d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);

            tooltip.style("left", (d3.event.pageX - 80) + "px")
                .style("top", (d3.event.pageY) + "px")
                .append('p')
                .text(d.key)
                .attr('class', 'tootip-key')
                .append('p')
                .text(d.value)
                .attr('class', 'tooltip-value');

            tooltip.transition()
                .duration(200)
                .style("opacity", 0.9);

        })

            .on("mouseout", function(d) {

            tooltip.remove();

        }); 
```

并且缩放行为是这样附加的。

```
g.append("g")
        .attr("class", "y axis")
        .call(yAxis)
        .attr("pointer-events", "all")
        .call(d3.behavior.zoom().on("zoom", zoom)); 
```

谢谢！

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-04-16T18:49:00.777

获取工具提示的最简单方法是将元素附加`svg:title`到您想要具有工具提示的元素。其余的将由浏览器处理。如果您需要更高级的东西，请查看[Tipsy](https://github.com/bigmlcom/tipsy)。

要将平移限制在 y 轴，只需忽略`x`处理程序函数中值的转换（`zoom`在您的情况下）。

# javascript - javascript ajax回调函数不起作用

> ID：15844727
> 
> 赞同：0
> 
> 时间：2013-04-05T22:35:18.103
> 
> 标签：javascript, jquery

`ajax` `callback`我对函数有疑问

我有

```
test = function(){
  this.items=[];
}

//original state.
test.prototype.getListItems = function (){

    this.items.push('test item');
    this.handleItems();

}

//this method will be called if the user clicks a button.
test.prototype.clickBtn = function (){

    this.ajGetOneMoreItem()    
    this.handleItems();
}

//a callback function that will add a new item.
test.prototype.ajGetOneMoreItem = function (){
   var that=this;    
     ajax.callback = function(dataItem){
         that.items.push(dataItem);
     }    
}

//to show the items.
test.prototype.handleItems = function (){

       //only show the test item, but not dataItem after user clicks a button.
      console(this.items)

}

var testObj = new test();

$('#testBtn).click(function(){
   testObj.clickBtn();
}) 
```

我想显示通过用户添加的新项目。但是，似乎 this.items 只显示了第一个 ' `test item`' 而没有添加新的`dataItem`。我在这里错过了什么吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:42:08.243

调用：

```
this.ajGetOneMoreItem(); 
```

几乎立即完成。这意味着下一步：

```
this.handleItems(); 
```

在执行 AJAX 回调之前发生。为了解决这个问题，将第二步移到回调中。

```
test.prototype.ajGetOneMoreItem = function (){
   var that=this;    
     ajax.callback = function(dataItem){
         that.items.push(dataItem);
         that.handleItems();
     }    
} 
```

# android - 如何为 TimerTask 使用 while 循环

> ID：15844730
> 
> 赞同：1
> 
> 时间：2013-04-05T22:35:37.527
> 
> 标签：android, timer, while-loop, countdown, thread-sleep

我是 Java 编程新手，有一个问题。我创建了这段代码，现在我想插入一个 while 循环，以便文本再次每五秒更改一次。我试图插入一个 while 语句和 Thread.sleep 但它不起作用。

```
 Timer tim = new Timer(); 

    String rndStr1 = myStringArray[new Random().nextInt(myStringArray.length)];
    txtV1.setText(rndStr1);

    tim.scheduleAtFixedRate( new TimerTask() {

            @Override
                public void run() {
                    count++;

                    runOnUiThread(new Runnable() 
                     {

                        public void run() 

                        {                              
                        if(count==5)//change the text after 5 seconds
                        {

                        String rndStr1 = myStringArray[new Random().nextInt(myStringArray.length)];
                        txtV1.setText(rndStr1);
                        }
            }, 1000, 1000 ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:38:46.137

Try public void run()

```
 {                              
                    if(count==5)//change the text after 5 seconds
                    {
                       wait(5000);
                    String rndStr1 = myStringArray[new Random().nextInt(myStringArray.length)];
                    txtV1.setText(rndStr1);
                    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T05:37:35.817

为什么需要一个while循环？如果您希望文本每 5 秒更改一次，只需将计时器任务参数设置为 5000、5000 而不是 1000、1000。您根本不需要 if (count == 5)。计时器将每 5 秒运行一次，您只需将文本设置为您的 textView。那里有什么问题？

# c# - 更改实体框架和 log4net 的 app.config

> ID：15844736
> 
> 赞同：0
> 
> 时间：2013-04-05T22:35:56.247
> 
> 标签：c#, entity-framework, c#-4.0, entity-framework-4, log4net

我在控制台应用程序中使用实体框架和 log4net。这是我的 app.config 的样子：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
  </configSections>
  <log4net>
    <appender name="RollingFile" type="log4net.Appender.RollingFileAppender">
      <param name="File" value="C:\\Temp\\Logs\\"/>
      <param name="RollingStyle" value="Date"/>
      <param name="DatePattern" value="yyMMdd_HHmm'.log'" />
      <param name="StaticLogFileName" value="false"/>
  <appendToFile value="true" />
      <maximumFileSize value="100KB" />
      <maxSizeRollBackups value="2" />
      <layout type="log4net.Layout.PatternLayout">
  <conversionPattern value="%date{MM/dd/yyyy HH:mm:ss} %logger [%thread] (Line :%line) %level - %message%newline"/>
      </layout>
    </appender>
    <root>
      <level value="DEBUG" />
      <appender-ref ref="RollingFile" />
    </root>
  </log4net>
  <connectionStrings>
    <add name="CAPDBEntities" connectionString="metadata=res://*/CAPDB.csdl|res://*/CAPDB.ssdl|res://*/CAPDB.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=caServer;initial catalog=CAPDB;persist security info=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    <add name="USPDBEntities" connectionString="metadata=res://*/USPDB.csdl|res://*/USPDB.ssdl|res://*/USPDB.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=UsServer;initial catalog=USPDB;persist security info=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
</configuration> 
```

我收到“ConfigErrorsException 未处理”错误。它指向我设置的 CAPDBEntities。为了让 EF 和 log4net 都使用同一个 app.config 文件工作，我需要进行哪些更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T20:21:01.753

我想我想通了。我从 Nuget 下载了实体框架并重新创建了 App.config。在那之后它起作用了。

# java - 如何为下载管理器编写测试驱动的 Java 类？

> ID：15844738
> 
> 赞同：0
> 
> 时间：2013-04-05T22:36:00.813
> 
> 标签：java, url, testing, tdd, download-manager

我正在使用 UP Design 开发一个下载管理器。在这个细化迭代中，我的主要用例：下载文件。这里是 Download.java

```
public class Download  implements Runnable {

// Max size of download buffer.
private static final int MAX_BUFFER_SIZE = 1024;

// These are the status names.
public static final String STATUSES[] = {"Downloading", "Complete"};

// These are the status codes.
public static final int DOWNLOADING = 0;
public static final int COMPLETE = 1;
public static void main(String[] args) throws MalformedURLException {
    System.out.println("Welcome to Download Manager.");
    System.out.println("Enter a URL.");
    URL url;
    String s;
    Scanner scan= new Scanner(System.in);
    s=scan.nextLine();
    url= new URL(s);
    Download download=new Download(url);

}

private URL url; // download URL
private int size; // size of download in bytes
private int downloaded; // number of bytes downloaded
private int status; // current status of download

// Constructor for Download.
public Download(URL url) {
    this.url = url;
    size = -1;
    downloaded = 0;
    status = DOWNLOADING;

    // Begin the download.
    download();
}
 // Start or resume downloading.
private void download() {
    System.out.println("Starting.");
    Thread thread = new Thread(this);
    thread.start();
}
// Download file.
public void run() {
    RandomAccessFile file = null;
    InputStream stream = null;

    try {
        // Open connection to URL.
        HttpURLConnection connection =
                (HttpURLConnection) url.openConnection();

        // Specify what portion of file to download.
        connection.setRequestProperty("Range",
                "bytes=" + downloaded + "-");

        // Connect to server.
        connection.connect();

        int contentLength = connection.getContentLength();

  /* Set the size for this download if it
     hasn't been already set. */
        if (size == -1) {
            size = contentLength;

        }

        // Open file and seek to the end of it.
        file = new RandomAccessFile(getFileName(url), "rw");
        file.seek(downloaded);

        stream = connection.getInputStream();
        while (status == DOWNLOADING) {
    /* Size buffer according to how much of the
       file is left to download. */
            byte buffer[];
            if (size - downloaded > MAX_BUFFER_SIZE) {
                buffer = new byte[MAX_BUFFER_SIZE];
            } else {
                buffer = new byte[size - downloaded];
            }
            System.out.print("%"+(downloaded/size)+'\r');
            // Read from server into buffer.
            int read = stream.read(buffer);
            if (read == -1){
                System.out.println("File was downloaded");
                break;
            }

            // Write buffer to file.
            file.write(buffer, 0, read);
            downloaded += read;

        }

  /* Change status to complete if this point was
     reached because downloading has finished. */
        if (status == DOWNLOADING) {
            status = COMPLETE;

        }
    } catch (Exception e) {
       System.out.println("Error!");
    } finally {
        // Close file.
        if (file != null) {
            try {
                file.close();
            } catch (Exception e) {}
        }

        // Close connection to server.
        if (stream != null) {
            try {
                stream.close();
            } catch (Exception e) {}
        }
    }
} 
```

我该如何编写此代码的测试代码？例如我应该测试URL验证，还是应该控制文件是否正在下载？我该如何进行这些测试？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T12:27:05.623

您编写的课程很难测试，因为它试图做的太多了。如果您要将一些职责提取到外部依赖项中，您最终可能会得到一个类来管理从 URL 下载的低级下载，而另一个类来管理本地文件系统。就像是：

```
interface UrlDownloader {
    InputStream download(URL url, int offset) throws IOException;
}

interface DownloadFolder {
    List<String> getFiles();
    void writeToFile(String filename, InputStream contents) throws IOException;
    void getFileSize(String filename);
} 
```

然后可以使用这些类的模拟版本来测试下载管理器。使用 mockito 之类的库，您可以编写如下测试：

```
@Test
public void canDownloadCompleteFile() throws IOException {
    URL url = new URL("http://example.com/file.txt");
    InputStream inputStream = new ByteArrayInputStream("abc".getBytes());
    UrlDownloader urlDownloader = mock(UrlDownloader.class);
    DownloadFolder downloadFolder = mock(DownloadFolder.class);
    when(urlDownloader.download(url, 0)).thenReturn(inputStream);

    DownloadManager manager = new DownloadManager(urlDownloader, downloadFolder);

    manager.download(url);

    verify(downloadFolder).writeToFile("file.txt", inputStream);
} 
```

使用 mockito，您可以控制依赖项何时抛出异常，或验证使用特定参数调用方法。

另一种方法是创建假类来实现你的接口并使用内存中的数据结构而不是真正的文件系统/网络。然后可以使用 assertEquals 等测试这些类的状态：

```
@Test
public void canDownloadCompleteFile() throws IOException {
    URL url = new URL("http://example.com/file.txt");
    FakeDownloadFolder downloadFolder = new FakeDownloadFolder();
    FakeUrlDownloader urlDownloader = new FakeUrlDownloader();
    urlDownloader.setUrlContents(url, "abc".getBytes());

    DownloadManager manager = new DownloadManager(urlDownloader, downloadFolder);

    manager.download(url);

    assertEquals("abc".getBytes(), downloadFolder.getFileAsByteArray("file.txt"));
} 
```

测试驱动开发背后的理念是您只编写由测试支持的代码。因此，您将实现足够的 DownloadManager 以通过第一个测试，然后添加另一个测试（例如，恢复不完整的下载）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:17:24.147

回答您的直接问题：为*这些*代码编写测试真的很难。

单元测试的美妙之处在于它们向您展示了您的代码的客户端可以多么容易地使用该模块。有一个名为“面向对象的分析与设计”的大领域旨在帮助程序员解决此类问题。

在这里，您应该更改您的代码，以便存在几个具有单一职责的例程，例如，一个用于通过网络进行通信，一个用于将自定义数据流存储到 HDD，另一个用于处理使用输入。这样，您可以单独测试这些“例程”，甚至提供您自己的“网络”环境（例如，将放置硬编码值而不是真正连接到网络的类）

# objective-c - NSLayoutConstraints 冲突

> ID：15844742
> 
> 赞同：1
> 
> 时间：2013-04-05T22:36:15.100
> 
> 标签：objective-c, nsview, nslayoutconstraint

我正在尝试以编程方式将按钮添加到已经在视图中的 NSTextField 下方的视图中。该视图是在 IB 中创建的并使用约束。它是一个 NSTableCellView，但我怀疑在这种情况下会有什么不同。我的代码是这样的：

```
NSView *previousView = self.pathsField;

for( NSString *path in self.revision.paths )
{
    NSButton *pb = [[NSButton alloc] initWithFrame: bframe];

    pb.bezelStyle = NSRoundRectBezelStyle;
    [self addSubview: pb];
    pb.title = path;
    [self addConstraint: [NSLayoutConstraint constraintWithItem: pb
                                           attribute: NSLayoutAttributeTop
                                           relatedBy: NSLayoutRelationEqual
                                           toItem: previousView
                                           attribute: NSLayoutAttributeBottom
                                           multiplier: 1 constant: 2.0]];
    [buttons addObject: pb];
    bframe.origin.y += 20;
    previousView = pb;
}
self.pathButtons = buttons; 
```

如果我将 addConstraint 调出，按钮就会毫无怨言地添加（只是不在正确的位置）。通过 addConstraint 调用，我在调试控制台上收到很多关于约束冲突的消息，并且我的一些 IB 创建的约束被破坏。

显然我做错了什么。我希望约束要求新按钮的顶部比前一个视图或按钮的底部低 2 px。看起来这应该不会引起任何冲突，那么我在哪里呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T00:41:41.970

实际上，您在使用约束时会犯*两种*错误：您的约束*既*冲突*又*模棱两可！正如其他人所说，通过设置为 NO 来消除冲突`translatesAutoresizingMaskIntoConstraints`，但随后开始担心歧义。只有指定布局所需的*所有内容，才能成功使用约束。*您正在指定顶部，但仅此而已；您还需要指定前缘（左），可能还需要指定宽度和高度（可能不是因为按钮有时具有固有大小；您必须进行试验）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T00:26:58.410

您遇到的错误是因为您没有通过调用`setTranslatesAutoresizingMaskIntoConstraints:`子视图来选择自动布局。

```
NSButton *pb = [[NSButton alloc] initWithFrame: bframe];
[pb setTranslatesAutoresizingMaskIntoConstraints:NO]; 
```

# tkinter - cx_freeze 不会为 python 3.1.1 创建正确的 .exe

> ID：15844748
> 
> 赞同：1
> 
> 时间：2013-04-05T22:36:40.830
> 
> 标签：tkinter, cx-freeze, python-3.1

我使用python 3.1.1，并且一直在尝试编译我今天早些时候编写的程序，我认为代码足够短，可以在下面发布。

```
from tkinter import *

class Application(Frame):
    """ GUI application that creates a story based on user input. """
    def __init__(self, master):
        """ Initialize Frame. """
        super(Application, self).__init__(master)  
        self.grid()
        self.label1()
        self.label2()

    def label1(self):
        Label(self,
              text = "Shop Keeper 1.1",
              font = ("fixedsys",
                      72)).grid(row = 0, column = 0, sticky = W)
    def label2(self):
        Label(self,
              text = "Welcome to Shop Keeper 1.1!"
              ).grid(row = 1, column = 0, sticky = W)

        # create a label and text entry for a plural noun
        Label(self,
              text = "Block name:"
              ).grid(row = 2, column = 0, sticky = W)
        self.BlokID = Entry(self)
        self.BlokID.grid(row = 2, column = 1, sticky = W)

        # create a label and text entry for a verb
        Label(self,
              text = "Amount:"
              ).grid(row = 3, column = 0, sticky = W)
        self.Amound = Entry(self)
        self.Amound.grid(row = 3, column = 1, sticky = W)

        Label(self,
              text = "Name:"
              ).grid(row = 4, column = 0, sticky = W)
        self.nama = Entry(self)
        self.nama.grid(row = 4, column = 1, sticky = W)

        Label(self,
              text = "Desired price:"
              ).grid(row = 5, column = 0, sticky = W)
        self.desprice = Entry(self)
        self.desprice.grid(row = 5, column = 1, sticky = W)

       # create a submit button
        Button(self,
               text = "Submit order",
               command = self.submit
               ).grid(row = 6, column = 1, sticky = W)

        self.submit = Text(self, width = 75, height = 10, wrap = WORD)
        self.submit.grid(row = 7, column = 0, columnspan = 4)

    def submit(self):
        """ Fill text box with new story based on user input. """
        # get values from the GUI
        BlockID = self.BlokID.get()
        amount = self.Amound.get()
        name = self.nama.get()
        price = self.desprice.get()

        emess = name 
        emess += " ordered "
        emess += amount
        emess += " units of "
        emess += BlockID
        emess += " at the price of "
        emess += price
        emess += " each."
        emess += "\n"

        # display the story                                

        self.submit.insert(0.0, emess)

# main
root = Tk()
root.title("Shop Keeper 1.0")
app = Application(root)
root.mainloop() 
```

我一直在尝试用 cx_freeze 编译它几个小时，但没有运气。它会创建文件夹，但是当我单击 .exe 时，它​​会非常快速地打开和关闭。多次快速点击后，我发现它缺少一些与 Tkinter 相关的模块，在搜索了这里的论坛后，我得出的结论是它缺少模块。但是，我无法修复它！我已经尝试按照建议添加 tcl8.5 和 tk8.5 文件夹，但似乎无法修复它。我已经尽我所能，所以我把这个问题作为最后的手段。创建的文件夹包含以下文件：

```
_socket.pyd
_tkinter.pyd
library.zip
mad_lib.exe
python31.dll
select.pyd
tcl85.dll
tk85.dll
unicodedata.pyd 
```

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T05:03:56.347

我尝试了以下方法，对我来说效果很好。

使用 activestate python 3.2.2.3 ( [http://www.activestate.com/activepython/downloads](http://www.activestate.com/activepython/downloads) )

然后我去了[http://cx-freeze.sourceforge.net/](http://cx-freeze.sourceforge.net/)并下载并安装了适用于 Python 3.2 的 MSI（我使用的是 64 位）。

我将您的程序保存为 C:\Scripts\Shopkeeper.py

接下来我运行了这个：

```
C:\Python32\Scripts\cxfreeze C:\Scripts\Shopkeeper.py --target-dir C:\cxfreezetest 
```

然后我跑了`C:\cxfreezetest\Shopkeeper.exe`，效果很好。

![在此处输入图像描述](https://i.stack.imgur.com/u3XsC.jpg)

# jquery - 在元素本身中设置 jQuery UI 属性

> ID：15844752
> 
> 赞同：0
> 
> 时间：2013-04-05T22:36:47.940
> 
> 标签：jquery, jquery-ui

好吧，尽管如此，我的问题可能是微不足道的：

要设置**手风琴以适应其内容**，[文档是这样说](http://api.jqueryui.com/accordion/#option-header)的：

```
$( ".selector" ).accordion({ heightStyle: "content" }); 
```

我可以在元素本身中这样做吗？这就是我想做的：

```
<div id="accordion" style="heightStyle: 'content';" > 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:38:46.523

不，这不是样式元素，它是一个 jQuery 参数。该参数允许`jQuery accordian`库以某种方式运行。

这只是执行的一些代码，只是简单地更改值：

```
if (heightStyle === "fill") {
    maxHeight = parent.height();
    this.element.siblings(":visible").each(function () {
        var elem = $(this),
            position = elem.css("position");

        if (position === "absolute" || position === "fixed") {
            return;
        }
        maxHeight -= elem.outerHeight(true);
    });

    this.headers.each(function () {
        maxHeight -= $(this).outerHeight(true);
    });

    this.headers.next()
        .each(function () {
        $(this).height(Math.max(0, maxHeight -
            $(this).innerHeight() + $(this).height()));
    })
        .css("overflow", "auto");
} else if (heightStyle === "auto") {
    maxHeight = 0;
    this.headers.next()
        .each(function () {
        maxHeight = Math.max(maxHeight, $(this).css("height", "").height());
    })
        .height(maxHeight);
} 
```

# vim - 在 VimL (vimscript) 中从其他自动加载的字典函数调用自动加载的字典函数

> ID：15844753
> 
> 赞同：2
> 
> 时间：2013-04-05T22:36:56.393
> 
> 标签：vim

是否可以从 Vim 脚本中另一个自动加载的字典函数中调用自动加载的字典函数？

我想有这样的东西`autoload/foo.vim`：

```
function! foo#Initialize()
  return 1
endfunction

let foo#MyDict = {}

function! foo#MyDict.say_hi() dict
  echo "hi"
endfunction

let foo#OtherDict = {}

function! foo#OtherDict.call_hi() dict
  call foo#MyDict.say_hi()
endfunction 
```

我想从另一个文件/交互式/无论如何使用它：

```
call foo#Initialize()
call foo#OtherDict.call_hi() 
```

不幸的是，这给了我一个错误：

```
E121: Undefined variable: foo#MyDict 
```

`foo#Initialize()`由于 Vim 中与字典函数不触发自动加载相关的错误/限制，调用是必要的。有一个关于这个的[谷歌群组](https://groups.google.com/forum/#!msg/vim_use/p48GZDesjQc/R2ptcs33v9wJ)线程，布拉姆证实了这个问题。

但是，我不确定这是这个问题的根源，因为一旦文件被自动加载（通过`foo#Initialize()`），调用字典函数通常会起作用。上面的嵌套调用示例给了我一个错误。

为了澄清，这很好用：

```
function! foo#SayHello()
  echo "hello"
endfunction

function! foo#OtherDict.say_hello() dict
  call foo#SayHello()
end 
```

只有对自动加载的字典函数的嵌套调用才会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T12:01:17.743

将脚本放在`plugin/`目录中或`:runtime`在使用前显式 'd 时也会发生同样的情况。`foo#MyDict`但是当使用 script-local代替时没有错误`s:MyDict`。这对我来说也是意料之外的。[请在vim_dev 邮件列表](http://www.vim.org/community.php)上提交错误。

# jquery - 将此 XML 转换为 JSON Jquery

> ID：15844755
> 
> 赞同：0
> 
> 时间：2013-04-05T22:37:05.923
> 
> 标签：jquery, xml, arrays, json, loops

所以我有这个来自 Winamp 的 XML

```
<dict>
        <key>Track ID</key><integer>0</integer>
        <key>Name</key><string>American Idol 2013</string>
        <key>Artist</key><string>Amber Holcomb</string>
        <key>Album Artist</key><string>Amber Holcomb</string>
        <key>Album</key><string>Unknown Album</string>
        <key>Kind</key><string>MPEG audio file</string>
        <key>Size</key><integer>3645</integer>
        <key>Total Time</key><integer>233000</integer>
        <key>Date Modified</key><date>Thu Mar 14 12:11:12 2013</date>
        <key>Date Added</key><date>Thu Apr 04 16:10:15 2013</date>
        <key>Bitrate</key><integer>128</integer>
        <key>Location</key><string>file://localhost/Z:%5Canthony%5CMusic%5CiTunes%5CiTunes%20Media%5CMusic%5CUnknown%20Artist%5CUnknown%20Album%5CAmber%20Holcomb%20-%20A%20Moment%20Like%20This%20-%20Studio%20Version%20-%20American%20Idol%202013.mp3</string>
        <key>File Folder Count</key><integer>-1</integer>
        <key>Library Folder Count</key><integer>-1</integer>
      </dict> 
```

我想把它变成一个 JsonArray

`var myarray = {"TrackID":0, "Name":"American IDol 2013"...};`

我发现了如何遍历每个标签，但我似乎无法理解如何做到这一点。我正在考虑创建一个预定义的 Json 数组或其他东西`{"TrackID": "", "Name":""}`，当 JSON 完成后，我将其推送到主 JSON 中（如果我没有正确解释这一点，请见谅）。

有没有办法让所有键组成一个数组，其余的组成一个数组，然后将它们合并到一个 JSON 数组中？我真的可以使用一些建议。

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:42:24.247

我只是回答了我自己的问题，我认为......

```
var key1 = "keyname";
var val1 = "value";

var myarray = {};

myarray[key1] = val1; 
```

* * *

所以这里是xml：[http ://honciano.com/kayokee/ci/uploads/xmlbackup2.xml](http://honciano.com/kayokee/ci/uploads/xmlbackup2.xml)

这是我用来创建 Json 数组的代码。我不知道这是否是正确的做法，但我得到了它的工作。我遇到的问题是从“KEY”标签中获取值并在“KEY”标签之后获取值，但不是“KEY”的标签是“STRING”或“INTEGER”。

所以这就是我创造的......

```
$.ajax({
                url: "<? echo base_url().'uploads/songlist.xml';?>",
                dataType: 'HTML',

                success: function(data){
                    var myarray ={"track":[]};
                    var key1 = "";
                    var val1 = "";          
                    var arrayContainer = {};
                    var myCount = 0;
                    $(data).find("dict").children("dict").children("dict").each(function(){

                        $(this).children().each(function(i, e){
                            var nodeKey=(this).nodeName;

                            if(nodeKey=="KEY"){
                                key1 = $(this).text();

                            } else {
                                val1 = $(this).text();
                                arrayContainer[key1] = val1;
                                myCount++;
                                //console.log("key1:"+key1+" - val1:"+val1+" - myCount:"+myCount);
                            }               

                            if(myCount==14){
                                myarray.track.push(arrayContainer);
                                arrayContainer={};
                                myCount=0;
                                //console.log("cutoff new line");
                            }           
                        });

                    });

                    $.each(myarray.track, function(i, obj){
                        $.each(obj, function(e, val){
                            console.log("e:"+e+" - val:"+val);
                        });
                    });

                }
            }) 
```

它完全有效，它给了我我想要的东西。谢谢大家！

# android - FileNotFoundException with MediaPlayer.create() reading from /res/raw

> ID：15844759
> 
> 赞同：0
> 
> 时间：2013-04-05T22:37:17.613
> 
> 标签：android, android-mediaplayer, android-resources

I have a tiny uncompress .wav file in my /res/raw directory called keyclick.wav (/res/raw/keyclick.wav).

However, I'm occasionally seeing an exception thrown which causes the activity to crash:

```
java.io.FileNotFoundException: This file can not be opened as a file descriptor; it is probably compressed at ...
android.content.res.AssetManager.openNonAssetFdNative(Native Method)
android.content.res.AssetManager.openNonAssetFd(AssetManager.java:427)
android.content.res.Resources.openRawResourceFd(Resources.java:857)
android.media.MediaPlayer.create(MediaPlayer.java:662) 
```

It says "it is probably compressed" but I've double checked, it is not compressed.

This is how I instantiate the MediaPlayer:

```
this.clickPlayer = MediaPlayer.create(this.getActivity(), R.raw.keyclick); 
```

I uploaded the file so you can see it directly:

[http://inadaydevelopment.com/stackoverflow/keyclick.wav](http://inadaydevelopment.com/stackoverflow/keyclick.wav)

The file is only 664 bytes and it's not compressed. Why is the system failing to get a file descriptor?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T01:49:20.457

肯尼，您是否尝试过使用这种方法播放文件：

```
MediaPlayer mp = new MediaPlayer();
AssetFileDescriptor afd = getResources().openRawResourceFd(R.raw.keyclick);
mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
mp.prepare();
mp.start(); 
```

# angularjs - 如何在 Angular 表达式中从全局 API 调用函数？

> ID：15844764
> 
> 赞同：8
> 
> 时间：2013-04-05T22:38:18.573
> 
> 标签：angularjs

Angular.js 提供了一组全局函数，如 angular.lowercase、angular.isArray 等。

假设我的范围中有一个字符串：

```
function MyController($scope) {
   $scope.myString = "TEST"
} 
```

调用 angular.lowercase 无效：

```
{{lowercase(myString)}}
{{angular.lowercase(myString)}} 
```

如何在我的模板中调用这样的函数？

**更新**

angular.isArray 示例

```
<div ng-show="isArray(myVar)">...</div> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-05T23:58:16.517

{{}} 中的表达式不是真正的 javascript，尽管它看起来是这样 - 它是一个 angularjs[表达式](http://docs.angularjs.org/guide/expression)。因此，并非所有内容都可供您使用。

charlietfl 是正确的，您的特定情况可以使用现有过滤器解决。但是，并非每个 angular.* 函数都以这种方式公开，在这种情况下，您应该创建自己的自定义过滤器。

过滤器是最干净的，但作为一种肮脏的解决方法，您也可以在控制器中使用以下行：

```
$scope.lowercase = angular.lowercase;  // not angular.lowercase() 
```

# objective-c - GCD 滚动视图加载问题

> ID：15844766
> 
> 赞同：1
> 
> 时间：2013-04-05T22:38:26.247
> 
> 标签：objective-c, uiscrollview, grand-central-dispatch

我正在使用 GCD 为我的滚动视图加载图像，但不是跟随我创建的帧，它只制作一个图像在其中闪烁的帧。这是我的代码：

```
//Create the array    
-(void)awakeFromNib {

images = [NSMutableArray arrayWithObjects: [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"imageOne" ofType:@"png"]], [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"imageTwo" ofType:@"png"]], [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"imageThree" ofType:@"png"]],nil];

}

 //Populate scrollview
-(void)populate {

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);

scrollview.pagingEnabled = YES;
scrollview.backgroundColor = [UIColor clearColor];
scrollview.clipsToBounds = YES;
scrollview.delegate = self;

[scrollview setContentSize:CGSizeMake(2 * scrollview.frame.size.width, scrollview.frame.size.height)];

int number = [images count] ;
NSLog(@"%i",images);

int rowTwoInt = 0;
int rowThreeInt = 0;
int rowFourInt = 0;

for (int i = 0; i < number; i++) {

    if (i <= 3) {

        finalFrame = CGRectMake( i*(80), 12, 80, 80);
    }

    if (i == 4) {
        finalFrame = CGRectMake(0, 95, 80, 80);
    }
    if ((i >4) && (i <= 7)) {
        rowTwoInt = rowTwoInt + 80;
        finalFrame = CGRectMake(rowTwoInt, 95, 80, 80);
    }

    if (i == 8) {
         finalFrame = CGRectMake(0, 178, 80, 80);
    }
    if ((i > 8) && (i <= 11)) {
        rowThreeInt = rowThreeInt + 80;
        finalFrame = CGRectMake(rowThreeInt, 178, 80, 80);
    }

    if (i == 12) {
        finalFrame = CGRectMake(0, 261, 80, 80);
    }
    if ((i > 12) && (i <= 15)) {
        rowFourInt = rowFourInt + 80;
        finalFrame = CGRectMake(rowFourInt, 261, 80, 80);
    }

    IconButton = [UIButton buttonWithType:UIButtonTypeCustom];
    IconButton.frame = CGRectMake(0, 0, 57, 57);
    IconButton.center = CGPointMake(40, 29);

    [IconButton addTarget:self action:@selector(Selected:) forControlEvents:UIControlEventTouchUpInside];
    IconButton.tag = i;

    dispatch_async(queue, ^{
        UIImage *icon = [images objectAtIndex:i];

        dispatch_sync(dispatch_get_main_queue(), ^{
            [IconButton setImage:icon forState:UIControlStateNormal];

        });
    });

    [cell addSubview:IconButton];

      cell = [[UIView alloc] initWithFrame:finalFrame];
 [scrollview addSubview:cell]; 
```

那我做错了什么？我是 GCD 的新手，所以可能与此有关。另外，如果您看到提高 UIScrollView 性能的方法，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:56:35.420

我怀疑您已声明`IconButton`为实例变量、`static`变量或全局变量。

每次通过循环时，您都会更改`IconButton`. 到您的十二个队列块执行时，`IconButton`将设置为其最终值 - 对您创建的最后一个按钮的引用。所有块都使用实例（`static`或全局）`IconButton`变量，因此所有块都更新相同的最终按钮。

创建一个局部变量来引用按钮，并在循环中使用该局部变量：

```
UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
IconButton = button;
IconButton.frame = CGRectMake(0, 0, 57, 57);
...

dispatch_async(queue, ^{
    UIImage *icon = [images objectAtIndex:i];

    dispatch_sync(dispatch_get_main_queue(), ^{
        [button setImage:icon forState:UIControlStateNormal];

    });
}); 
```

每个块将在创建块时捕获局部变量的值，因此每个块将捕获对不同按钮的引用。

# drupal - Drupal 查看实体引用上下文

> ID：15844775
> 
> 赞同：0
> 
> 时间：2013-04-05T22:39:10.370
> 
> 标签：drupal, drupal-7, views, organic-groups, entityreference

我正在使用实体参考和有机组运行 Drupal 7。我有两种内容类型，一种是组，另一种是组内容。我有一个实体引用字段（选择列表），它引用与组关联的组内容。

我想创建一个仅显示从组内容类型中的此实体引用字段中选择的字段值的视图。

例如：

```
 Team: Red Sox
 Location: Fenway 
```

Location 是一种内容类型（组内容），Team 是组。有许多团队和许多位置，但是当我查看组页面时，我想要一个仅显示单个位置的视图（组内容类型中的一个 SELECTED ）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T02:11:21.447

经过大量研究，我意识到 Views 和 context 无法自行处理。我最终使用[View PHP](http://drupal.org/projects/views_php)构建了一个过滤器，该过滤器有效地过滤掉了所有其他结果而不是我想要的结果：

```
$node = menu_get_object();
$item = field_get_items('node', $node, 'field_name');
$loc = $item[0]['target_id'];
$refnode = node_load($loc);
$primary = $refnode->title;
if ($primary != $row->title) {
  return TRUE;
} 
```

欢迎您使用这个 :) 如果有人对如何编写此代码有任何更好的建议，请随时发表评论或发布替代解决方案。

# python - 在 Python 3 中使用 from-import 语句仍然需要输入类名

> ID：15844777
> 
> 赞同：1
> 
> 时间：2013-04-05T22:39:36.607
> 
> 标签：python, import, python-3.x, module

我在同一个目录中有三个 Python 模块。在其中两个文件中是我要访问的类。我的印象是，如果我的模块之一（称为枚举）中有以下代码：

```
class Directions:

    UP = 1
    DOWN = 2
    LEFT = 3
    RIGHT = 4

class Colors:
    RED = [255, 0, 0] 
```

我可以使用以下语句：

```
from enum import Directions
from enum import Colors 
```

能够像这样访问类成员：

```
foo = DOWN
bar = RED 
```

但是，我必须像这样访问它们

```
foo = Directions.DOWN
bar = Colors.RED 
```

否则会产生错误。有什么方法可以使用 import/from-import 语句来访问我的类成员而无需指定类名？还是我应该以不同的方式组织我的“枚举”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T22:46:27.693

除了该类定义内部之外，不可能直接从代码访问类成员。

尝试将您的枚举模块更改为以下内容：

```
__all__ = ['UP', 'DOWN', 'LEFT', 'RIGHT', 'RED']

# Directions
UP = 1
DOWN = 2
LEFT = 3
RIGHT = 4

# Colors
RED = [255, 0, 0] 
```

然后`from enum import *`在您想要访问这些变量的模块内部使用。

在这里定义`__all__`不是必需的，但无论如何使用它是一个好习惯。它控制使用时导入`from foo import *`的名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T22:47:11.847

以不同的方式组织它们。没有直接的方法可以按照您的要求进行操作。

另一方面，引用`Directions.DOWN`and`Colors.RED`是非常 Pythonic 的。它是显式的（`DOWN`指的是 a `Direction`，而不是 a `MattressStuffing`）并使用命名空间来包含数据（`Colors.RED`不同于`Alerts.RED`）。这些都是好事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T22:59:16.453

如果您的课程与您在此处发布的内容一样简单，那么它们就没有必要成为真正的课程。但是，要使用您拥有的代码获得您想要的东西，您需要这样做：

```
from enum import Directions
from enum import Colors

foo = Directions()    # This is called instantiation
foo.DOWN

bar = Colors()    # You can potentially instantiate as many of these as you want
bar.RED

rab = Colors()
rab.RED    # Try it, you'll see 
```

类并不是真正打算像您那样保存静态变量，但是这段代码就是它的工作方式。

Python*不*应该使您的代码工作的原因是因为以下示例：

```
class Directions:

    UP = 1
    DOWN = 2
    LEFT = 3
    RIGHT = 4

class Directions2:

    UP = 9
    DOWN = 8
    LEFT = 7
    RIGHT = 6 
```

然后你导入

```
from enum import Directions
from enum import Directions2 
```

如果你然后尝试使用`foo = DOWN`，那么 Python 怎么知道`DOWN`你在说什么？这个基本概念的技术术语是*命名空间*。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T22:48:12.730

```
from enum import Directions 
```

`Directions`这将从模块中导入名称`enum`。内部发生了什么，内部导入函数实际上会将*局部*变量设置`Directions`为以这种方式导入的任何内容。特别是，它不会设置任何其他局部变量——这正是您使用该`from..import`语法的原因，因此您可以完全控制设置的名称。

所以像这样使用它，你就无法获取变量`DOWN`和`RED`设置。

如果您想使用它们，则需要直接导入它们，即，`from <something> import DOWN, RED`或者`from <something> import *`如果您只想导入所有内容（通常不鼓励这样做）。

现在来说说这`<something>`部分；您无法导入类型的属性，因此您必须以`enum`某种方式更改您的模块。一种冗长的可能性是将每种类型更改`Directions`为`Colors`单独的模块，因此您可以这样做`from enum.Directions import DOWN`。

另一种可能性是直接在 enum 模块中公开这些变量，例如：

```
class Directions:
    UP = 1
    DOWN = 2
    LEFT = 3
    RIGHT = 4

UP = Directions.UP
DOWN = Directions.DOWN
LEFT = Directions.LEFT
RIGHT = Directions.RIGHT 
```

当然，如果你甚至需要那种`Directions`类型，你可以争论。通常，您实际上只想导入`Directions`并明确使用`Directions.UP`etc. 指定每个枚举值，因此您实际上知道您指的是哪种枚举。

# delphi - 在运行时隐藏 UI 组件，设计问题

> ID：15844778
> 
> 赞同：0
> 
> 时间：2013-04-05T22:39:38.777
> 
> 标签：delphi

在表单上，​​我在流程开始时需要第一组 UI 控件，稍后我只需要第二组组件。我将流程集#1 的集合放在第一个面板上，完成流程步骤#1 后我开始隐藏面板#1，从 UI 设计指南中是否有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:46:27.763

使用您所描述的面板是一种非常常见且非常受人尊敬的方式。这样做没有错。

另一个常用的习惯用法是带有隐藏选项卡的页面控件。所以，做一个页面控件。添加两个标签页。将两个选项卡表的 TabVisible 设置为 False。然后在运行时设置页面控件的 ActivePage 属性以指定向用户显示哪个页面。

页面控制方法与使用面板非常相似。在设计时使用它可能稍微容易一些，但很大程度上取决于个人喜好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T23:31:23.190

我会使用框架而不是面板。您可以像 Forms 一样在设计时设计 Frames，然后根据需要在运行时创建 Frames 的实例。因此，创建您的第一个 Frame（您甚至可以在设计时将其放在 Form 上），然后在运行时，准备好后您可以销毁第一个 Frame 实例并创建第二个 Frame 的实例。

# php - 在 PHP 中发送 404 标头后显示来自 htaccess 的 404 文档

> ID：15844780
> 
> 赞同：1
> 
> 时间：2013-04-05T22:39:42.920
> 
> 标签：php, html, .htaccess, mod-rewrite, redirect

在 PHP 中，我使用以下代码来指示找不到页面：

```
header("HTTP/1.0 404 Not Found");exit(); 
```

在`.htaccess`文件中，我有以下行来处理 404 自定义文档：

```
ErrorDocument 404 /404.html 
```

现在，当我发送 PHP 404 标头时，我希望它显示自`404.html`定义定义，`.htaccess`而是显示一条消息“此链接似乎已损坏”。因此它不会显示自定义 404 页面，如果我从中删除该行`.htaccess`仍然不会显示服务器的常规 404 页面，并且还会显示断开的链接消息。

那么，当我在 PHP 中发送标头时，如何让它显示 404 页面呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T08:05:33.817

`ErrorDocument`这里的问题是，除非 URL 处理管道找不到 URL 指向的文件（或处理程序），否则不会处理由 表示的自定义错误文档。在您的情况下，处理管道**确实**找到了一个文件，即您的 php 文件，因此它本身永远不会达到 404，因此`ErrorDocument`永远不会应用。

当 apache 使用 php 处理程序运行您的 php 文件，并且您的**php 文件决定返回 404**时，您不仅需要提供 404 响应代码，还需要提供 HTML 错误文档。您看不到默认的 apache 错误文档，因为 apache 从不认为请求是 404（它会将请求交给您的 php 文件）。所以你需要做这样的事情：

```
header("HTTP/1.0 404 Not Found");
include('404.html');
exit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:43:25.443

您只需向浏览器发送 404 代码尝试重定向到错误 404 页面

```
header('location: http://youdomain.com/404.html'); exit; 
```

# javascript - Javascript - 如何使用配置值制作构造函数？

> ID：15844781
> 
> 赞同：1
> 
> 时间：2013-04-05T22:39:48.797
> 
> 标签：javascript, oop, extjs, constructor

我搜索了很多 javascript OOP 库，但我只找到了一个具有我想要的功能的库。我想用这样的配置值创建 javascript 对象：

var iPhone = new SmartPhone({ hasTouchScreen: true, operatingSystem: 'iOS' });

我发现的唯一一个库是 Sencha Ext JS4 [http://docs.sencha.com/ext-js/4-2/#!/api/Ext.ClassManager](http://docs.sencha.com/ext-js/4-2/#!/api/Ext.ClassManager)

...像这样创建构造函数有什么魔力？或者你能建议我任何其他可以为我做这件事的 OOP 库吗？我正在寻找免费库，因为我需要在我们的商业应用程序中使用它，所以我不能使用仅用于开源项目的免费 Sencha。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:48:34.873

魔法：

```
var SmartPhone = (function SmartPhoneClass() {

  function SmartPhone(props) {
    this.hasTouchScreen = props.hasTouchScreen || false;
    this.operatingSystem = props.operatingSystem || 'Android';
  }

  SmartPhone.prototype = {
    ...
  };

  return SmartPhone;

}());

var iPhone = new SmartPhone({
  hasTouchScreen: true,
  operatingSystem: 'iOS'
}); 
```

# arrays - 取许多 N 大小数组的平均值

> ID：15844782
> 
> 赞同：-2
> 
> 时间：2013-04-05T22:39:49.797
> 
> 标签：arrays, perl

谁能帮我解决这个问题？我正在尝试编写一个脚本，该脚本需要许多 N 大小的数组的总和。`(1,2)`在下面的示例中，数组的平均值为`(0+1+2+1)/4 = 1`和`(2+3+2+1)/4 = 2`。目前，下面的代码仅适用于大小为 2 的数组。我将如何处理大小为 100 的数组以使 @results 的长度为 100？我想我需要一个柜台，对吧？

```
use strict;
use warnings;

my @w = (0, 2);
my @x = (1, 3);
my @y = (2, 2);
my @z = (1, 1);

my @arrays = \(@w, @x, @y, @z);

my ($x, $y) = (0, 0);
foreach my $arr(@arrays) {
    $x += $arr->[0];
    $y += $arr->[1];
}

my @result = ( $x / @arrays,  $y / @arrays);

print "@result\n";  # <---- prints 1 2

#######
# my attempt
my @avg;
for my $i(0..$w) {
    # I'm guessing the result 'map...' returns is an array
    @avg[$i] = sum(\(map $_->[$i], @arrays)) / @arrays;    
}    

# sum the elements in an array and return its value
sub sum{
# takes 1 param: an arrey_ref
    my $sum = 0;
    for ( @{$_[0]} ) {
    $sum += $_;
    }
    return $sum;
} 
```

我的尝试很接近，但它不起作用。我想在不使用模块的情况下做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:08:28.087

这是我的解决方案：

```
use strict;
use warnings;

my $SIZE = 3;
my @w = (0, 2, 3);
my @x = (1, 3, 4);
my @y = (2, 2, 6);
my @z = (1, 1, 3);

my @arrays = \(@w, @x, @y, @z);

my @result = ();
foreach my $arr(@arrays) {
    for(my $i=0; $i<$SIZE; $i++) {
        $result[$i] += $arr->[$i];
    }
}

@result = map { $_ / @arrays } @result;

print "(@result)", "\n";  # <---- prints (1 2 4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T12:38:55.553

`map`不返回数组。[文档](http://perldoc.perl.org/functions/map.html)

改变

```
@avg[$i] = sum(\(map $_->[$i], @arrays)) /@arrays; 
```

至

```
$avg[$i] = sum( map $_->[$i], @{$arrays[$i]} ) / @{$arrays[$i]}; 
```

和改变

```
sub sum{
    my $sum = 0;
    for ( @{$_[0]} ) {
    $sum += $_;
    }
    return $sum;
} 
```

至

```
sub sum {
    my $sum;
    $sum += $_ for @_;
    return $sum;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T01:26:17.027

该[`List::Util`](https://metacpan.org/module/List%3a%3aUtil)模块对于此类问题非常有用。再加上一个简单的`average`子程序，它使一切变得非常简单。

```
use strict;
use warnings;

use List::Util 'sum';
sub average { sum(@_) / @_ }

my @w = (0, 2);
my @x = (1, 3);
my @y = (2, 2);
my @z = (1, 1);

my @arrays = \(@w, @x, @y, @z);

my @results = map {
  my $i = $_;
  average(map $_->[$i], @arrays);
} 0 .. $#{$arrays[0]};

print "@results\n"; 
```

**输出**

```
1 2 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-05T23:16:54.503

以一种简单的方式进行，如下所示：

```
#!/usr/bin/env perl

use strict;
use warnings;

my @w = (1, 2, 3, 4);
my @x = (1, 2, 3, 4);
my @y = (1, 2, 3, 4);
my @z = (1, 2, 3, 4);

my @arrays = \(@w, @x, @y, @z);

my @sums;
foreach my $arr(@arrays) {
    for( my $i = 0; $i <= $#w; $i++, $j++ )
    {
    $sums[$j] += $arr->[$i];
    }
}

my @avg = map { $_ / @arrays } @sums;

foreach( @avg )
{
    print "$_ ";
}

print "\n"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-05T23:18:08.943

是的，它非常接近。以下是对问题代码的更正：

```
my @avg;
for my $i (0..$#w) {
    my @transposed = map {$_->[$i]} @arrays;
    $avg[$i] = sum(\@transposed) / @transposed;
    # or in one line: $avg[$i] = sum( [map {$_->[$i]} @arrays] ) / @arrays;
} 
```

（我假设数组`@w`、`@x`和都是相同的大小。`@y`）`@z`

请注意，这`@avg[$i]`是一个数组切片。你想`$avg[$i]`指定一个特定的位置。

# c - 为什么这个 C 代码会出现分段错误？

> ID：15844783
> 
> 赞同：3
> 
> 时间：2013-04-05T22:39:56.513
> 
> 标签：c, pointers, segmentation-fault

这段代码给了我一个分段错误：

```
char *s1 = "String 1", *s2 = "String 2";
void swap(char **, char **);

int main(void) {
    swap(&s1, &s2);
    return 0;
}

void swap(char **p, char **q) {
    char **tmp;

    *tmp = *p;
    *p = *q;
    *q = *tmp;
} 
```

但是，如果我将最后一个函数的主体更改为此代码，它不会产生任何问题：

```
 char *tmp;

    tmp = *p;
    *p = *q;
    *q = tmp; 
```

我真的不明白为什么我的第一个代码会出现分段错误。提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T22:41:10.910

您的`tmp`指针未初始化，您在下一行取消引用它。这是未定义的行为，其中包括段错误的可能性。

# java - 在java中调用C函数

> ID：15844787
> 
> 赞同：-3
> 
> 时间：2013-04-05T22:40:16.093
> 
> 标签：java, c, web-services, api

我有一个用 C 编写的工具包。我想制作一个使用这个工具包的 java web 服务。我怎样才能做到这一点。我怎样才能调用这个工具包的功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:44:49.253

如果工具包提供输出，您可以只获取输出并通过管道传输它们吗？

如果没有，我认为自己转换它会更容易，除非涉及指针。

否则，

[http://java.sun.com/docs/books/jni/html/start.html#769](http://java.sun.com/docs/books/jni/html/start.html#769)

# c++ - 对于大于 64 位的位值，C++ 将二进制转换为十进制

> ID：15844788
> 
> 赞同：-2
> 
> 时间：2013-04-05T22:40:25.630
> 
> 标签：c++

我正在使用此代码将二进制转换为十进制。但是此代码不适用于更多 64 位，因为 __int64 仅包含 8 个字节。您能否告诉建议一种用于将超过 64 位转换为十进制值的算法。我的最终结果也必须是字符串。帮助表示赞赏。谢谢。

```
 int bin2dec(char *bin)
 {
    __int64  b, k, m, n;
    __int64  len, sum = 0;

    len = strlen(bin) - 1;
    for(k = 0; k <= len; k++)
    {
            n = (bin[k] - '0'); // char to numeric value
            if ((n > 1) || (n < 0))
            {
                    puts("\n\n ERROR! BINARY has only 1 and 0!\n");
                    return (0);
            }
            for(b = 1, m = len; m > k; m--)
            {
                    // 1 2 4 8 16 32 64 ... place-values, reversed here
                    b *= 2;
            }
            // sum it up
            sum = sum + n * b;
    }
    return(sum);
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:05:12.557

您可以轻松地将大数字（以任何基数）存储为`std::deque`数字 - 使用双端队列可以轻松地在任一端添加数字。您可以对它们实现基本的算术运算，这使得使用标准乘法和数字相加算法将二进制转换为十进制变得容易：

```
std::deque<char> &operator *=(std::deque<char> &a, unsigned b)
{
    unsigned carry = 0;
    for (auto d = a.rbegin(); d != a.rend(); d++) {
        carry += (*d - '0') * b;
        *d = (carry % 10) + '0';
        carry /= 10; }
    while (carry > 0) {
        a.push_front((carry % 10) + '0');
        carry /= 10; }
    return a;
}

std::deque<char> &operator +=(std::deque<char> &a, unsigned b)
{
    for (auto d = a.rbegin(); b > 0 && d != a.rend(); d++) {
        b += (*d - '0');
        *d = (b % 10) + '0';
        b /= 10; }
    while (b > 0) {
        a.push_front((b % 10) + '0');
        b /= 10; }
    return a;
}

std::string bin2dec(char *bin) {
    std::deque<char> tmp{'0'};
    while (*bin) {
        if (*bin != '0' && *bin != '1') {
            puts("\n\n ERROR! BINARY has only 1 and 0!\n");
            return ""; }
        tmp *= 2;
        if (*bin++ == '1')
            tmp += 1; }
    return std::string(tmp.begin(), tmp.end());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:50:42.520

通常，当处理大于一个整数单元中可以存储的数据时，解决方案是以下两种情况之一：

1.  使用字符数组/字符串将值存储为“ASCII”（每个字符一位）
2.  在数组中使用多个整数来存储值，使用`X`每个元素的位。

转换没有什么特别的不同，只是一旦你完成了`X`位，你就转移到下一个元素。

顺便一提：

```
int bin2dec(char *bin)
 {
    int  k, n;
    int len;
    __int64  sum = 0;

    len = strlen(bin);
    for(k = 0; k < len; k++)
    {
            n = (bin[k] - '0'); // char to numeric value
            if ((n > 1) || (n < 0))
            {
                    puts("\n\n ERROR! BINARY has only 1 and 0!\n");
                    return (0);
            }
            // sum it up
            sum <<= 1;
            sub += n;
    }
    return(sum);
 } 
```

有点简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:06:00.230

算法很简单：不断除以 10 的幂，以获得每 10 位的值。诀窍是能够存储大于 64 位的数字并除以 10 的幂。存在用于存储大数字的算法，您应该找到一个，虽然它们并不难纠正，但它们比在 Stackoverflow 上输入答案的适当大小要大。

但基本上，您创建一个累加器 bignum，将其设置为 1 并开始将其乘以 10，直到它的值大于您的目标 bignum。然后将其除以 10 并启动算法：

```
while accum >= 1
divide source/accum place the dividend in your output string. 
substract that number time accum from your source.
divide accum by 10 and loop 
```

你认识那个算法吗？这可能是你在小学时被教导做长除法的方式。好吧，这就是您“打印”十进制二进制数的方式。

有很多方法可以提高它的性能。（提示，您不必在基数 10 中工作。对于 32 位整数，在基数 10^8 中工作，对于 64 位整数，在基数 10^17 中工作。）但首先您需要一个库，可以减、加、倍, 除并比较 bignums。

当然，一个 bignum 库可能已经有一个 toString 函数。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-05T22:53:37.500

手动：

```
int binaryToDec(char *bin)
 {
    int  k, n;
    int len=strlen(bin);
    int  dec = 0;

    for(k = 0; k < len; k++)
    {
            n = (bin[k] - '0');
            dec <<= 1;
            dec += n;
    }
    return(dec);
 } 
```

你也可以考虑一个bitset：

```
std::bitset<64> input(*bin);
std::cout<<input.u_long(); 
```

# css - 实现简单布局的麻烦（2行，每行不同的颜色）

> ID：15844796
> 
> 赞同：0
> 
> 时间：2013-04-05T22:41:13.573
> 
> 标签：css

我无法实现某个布局，其中页眉占据视口高度的 50% 和宽度的 100%，而页脚占据视口高度的 50% 和宽度的 100%。页眉应该是绿色的，页脚应该是白色的。

颜色有效，但高度无效。高度只适合每个元素的内容量。

知道为什么以及如何解决它吗？

另外，我知道高度加起来超过 100%。我也在尝试触发滚动条。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:50:39.510

HTML：

```
<header></header>
<footer></footer> 
```

CSS：

```
html, body {
    height: 100%;
}

header, footer {
    height: 50%;
    width: 100%;
}

header {
    background: green;
} 
```

[演示](http://jsfiddle.net/V3YdW/)

诀窍是确保`html`和`body`元素设置为 100% 高度。

# php - 为什么没有从 GiantBomb API 返回 JSON

> ID：15844799
> 
> 赞同：0
> 
> 时间：2013-04-05T22:41:19.807
> 
> 标签：php, json, api, wrapper, decode

我尝试使用 GiantBomb api 来查询视频游戏，目前当我在浏览器中输入 URL 时，它工作得很好。Json 数据出现。

这是一个示例网址.. h​​ttp [://www.giantbomb.com/api/search/? api_key=83611ac10d0dfghfgh157177ecb92b0a5a2350c59a5de4&query=Mortal+Kombat&format=json](http://www.giantbomb.com/api/search/?api_key=83611ac10d0dfghfgh157177ecb92b0a5a2350c59a5de4&query=Mortal+Kombat&format=json)

但是当我尝试使用我刚刚开始构建的 php 包装器时，它返回 html?? 这是我的包装代码的开始......（现在非常业余）

你会注意到在“请求”方法中，我已经注释掉了 json_decode($url) 的返回值，因为当我取消注释时，页面会抛出 500 错误？？？所以我想看看当我回应它时会发生什么。它呼应了一个 html 页面。当然，当您在浏览器中输入该 url 时，它应该只是回显显示的内容，不是吗？

但是......如果我用 GoogleMap url 替换 url，它会很好地回显 Json 数据，而不使用 json_decode。关于这里发生的事情有什么想法吗？？？？

```
class GiantBombApi {

public $api_key;
public $base_url;
public $format;

 function __construct() {
$this->format="&format=json";
$this->api_key = "83611ac10d0d157177ecb92b0a5a2350c59a5de4";
$this->search_url = "http://www.giantbomb.com/api/search/?api_key=".$this- >api_key."&query=";

}

public function search($query){
$query = urlencode($query);
$url = $this->search_url.$query.$this->format;
return $this->request($url);
}

public function request($url) {
$response = file_get_contents($url);
echo $response;
//return json_decode($response, true);

      }
   }

   //TESTING SECTION
   $games = new GiantBombApi;
   $query = $_GET['search'];
   echo $games->search($query); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:47:38.083

我通过 Postman 运行了一些请求，似乎 api 查看了 mime 类型以及查询字符串。所以尝试将“格式”的标题设置为“json”。

# sql - 在 SQL 中查找数据集“边”

> ID：15844805
> 
> 赞同：1
> 
> 时间：2013-04-05T22:42:22.990
> 
> 标签：sql, database, vertica

我有大量数据被错误地加载到 SQL 数据库中（如果重要的话，它是 Vertica DB）。

每行都有一个 id 和一个时间戳。数据是按顺序加载的（顺序 ID），但是时间戳转换不正确，导致所有时间都被加载为“AM”。

这是数据库中内容的简化示例：

```
id    |      time
001   | 2013-01-01 00:00:01 // Jan 1st
002   | 2013-01-01 01:20:00
...   | ...
500   | 2013-01-01 11:59:59
501   | 2013-01-01 00:00:01 // should be 12:00:01 (PM)
502   | 2013-01-01 00:10:00 // should be 12:10:00 (PM)
...   | ...
750   | 2013-01-01 11:59:59 // should be 23:59:59 (PM)
751   | 2013-01-02 00:00:00 // next day (the 2nd) 
```

我需要一个查询，它可以找到我需要在时间上增加 12 小时的行的 ID 范围。例如，对于上面的示例数据，返回的行应该是`501, 750`. 这样我可以在 id >= 501 和 <= 750 的情况下添加 12 小时。

基本上，我需要某种回顾+展望机制。以编程方式，这意味着遍历每一行并检查*日期*的日期是否与下一行相同，并检查*时间*是否早于前一行。但是，我确信在 SQL 中有一些更好的方法可以做到这一点......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:25:24.393

这**不完全**是您要查找的内容，但它会提供给定日期不同步的所有行对。

```
SELECT t1.id As 'ID1', t1.timestamp As 'Stamp1', t2.id As 'ID2', t2.timestamp As 'Stamp2' 
FROM Table1 t1
JOIN Table1 t2 ON Date(t1.timestamp) = Date(t2.timestamp) AND 
                  Time(t2.timestamp) <= Time(t1.timestamp) AND
                  t1.id <= t2.id
WHERE t1.id <> t2.id OR Time(t2.timestamp) <> Time(t1.timestamp)
ORDER BY t1.id; 
```

这是[SQL 小提琴](http://sqlfiddle.com/#!2/2d9d39/8)

# java - ListView 在视图中显示不正确的数据

> ID：15844807
> 
> 赞同：0
> 
> 时间：2013-04-05T22:42:25.167
> 
> 标签：java, android

如果我滚动浏览我的 ListView，一个 ListView 项目中的一个 TextView (expiresIn) 会随机复制到其他项目中。我猜这与 ViewHolder 有关，但我真的看不出我哪里出错了，它只有 expiresIn TextView 我有问题：

```
public class MySyncListAdapter extends CouchbaseViewListAdapter {

protected MainActivity parent;
private CouchDbConnector db;
private static final String TAG = "MySyncListAdapter";

public MySyncListAdapter(MainActivity parent, CouchDbConnector couchDbConnector, ViewQuery viewQuery) {
    super(couchDbConnector, viewQuery, true);
    this.parent = parent;
    this.db = couchDbConnector;
    Log.d(TAG, "in constructor");

}

private static class ViewHolder {
   ImageView img;
   TextView label;
   TextView dateAdded;
   TextView expiresIn;
}

@Override
public View getView(int position, View itemView, ViewGroup parent) {
    Log.d(TAG, "in getView");

    View v = itemView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater)parent.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.list_item, null);
        ViewHolder vh = new ViewHolder();
        vh.label = (TextView) v.findViewById(R.id.label);
        vh.img = (ImageView) v.findViewById(R.id.img);
        vh.dateAdded = (TextView) v.findViewById(R.id.tvDateAdded);
        vh.expiresIn = (TextView) v.findViewById(R.id.tvExpiresInList);
        v.setTag(vh);
    }

    TextView label = ((ViewHolder)v.getTag()).label;
    TextView dateAdded = ((ViewHolder)v.getTag()).dateAdded;
    TextView expiresIn = ((ViewHolder)v.getTag()).expiresIn;
    ImageView img = ((ViewHolder)v.getTag()).img;
    Row row = getRow(position);
    JsonNode item = row.getValueAsNode();
    JsonNode itemText = item.get("header");
    JsonNode dateAddedText = item.get("dateAdded");
    JsonNode expiryDateText = item.get("expiryDate");
    JsonNode attachmentText = item.get("_attachments");

    ViewHolder holder = (ViewHolder) v.getTag();

    if(label != null) {
        holder.label.setText(itemText.getTextValue());
    }

    if(dateAdded != null) {
            Log.d(TAG, "in dateAdded getView");
            if(CompareDate.isDateAddedToday(dateAddedText.getTextValue())){
             holder.dateAdded.setText(R.string.today); 
            }
            else if (CompareDate.isDateAddedYesterday(dateAddedText.getTextValue())){
                holder.dateAdded.setText(R.string.yesterday);
            }
            else{
                String age = String.valueOf(CompareDate.getAgeInDays(dateAddedText.getTextValue()));
                holder.dateAdded.setText( age + " " + parent.getResources().getString(R.string.days_ago));
            }

    }

    if(!expiryDateText.isNull() && expiresIn != null){
        long noDays = CompareDate.getDaysUntil(expiryDateText.getTextValue());
        if(noDays<6){
            holder.expiresIn.setTextColor(Color.parseColor("#ff4444"));
        }
        holder.expiresIn.setText(String.valueOf(noDays) + " " + parent.getResources().getString(R.string.days_until_expiry));

    }

    if(img != null){
    //bitmap stuff
    holder.img.setImageBitmap(bitmap); 
    }

    return v;
} 
```

**更新** 通过添加一个专门设置 expiresIn 到“”的 else 语句来解决它。希望解释一下，但是为什么如果我不专门设置它，它会使用另一个项目的文本视图。

```
 if(!expiryDateText.isNull() && expiresIn != null){
        long noDays = CompareDate.getDaysUntil(expiryDateText.getTextValue());
        if(noDays<6){
            holder.expiresIn.setTextColor(Color.parseColor("#ff4444"));
        }
        holder.expiresIn.setText(String.valueOf(noDays) + " " + parent.getResources().getString(R.string.days_until_expiry));   
    }
    else {
        holder.expiresIn.setText("");
    } 
```

# c# - 检查一个数字是否是偶数但不是零，在 1 条件下？

> ID：15844808
> 
> 赞同：0
> 
> 时间：2013-04-05T22:42:30.250
> 
> 标签：c#, .net, bit-manipulation

我认为这是不可能的，但这可以在 1 个条件而不是 2 个条件下完成吗？

我试图不这样做

```
bool test = (Number1 & 1) == 0 && (Number1 > 0); 
```

或这个

```
bool test = (Number1 & 1) == 0 && (Number1 != 0); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T03:24:24.453

将对所有 >= 2 的偶数返回 true，对所有奇数以及所有 <= 0 的数字返回 false：

```
bool test = ((Number1 - 1) % 2 == 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T00:10:37.670

尽管这在技术上是放入`Number1`一个变量中，但我认为它会起作用。我假设`Number1`是从长时间运行的函数调用或属性返回的？无论哪种方式：

```
private bool IsEvenNotZero(int num) {
    return (num & 1) == 0 && (num != 0);
}

bool test = IsEvenNotZero(Number1); 
```

这会将其放入一个参数中，您可以通过这种方式测试该参数两次。我不知道为什么你不能放入`Number1`一个正常的变量，并且在不了解情况的情况下我不知道是否可以做得更好。

# ruby-on-rails-3 - 使用 mongoid 和 rails 3 在 mongodb 中查找 id 的性能不佳

> ID：15844809
> 
> 赞同：1
> 
> 时间：2013-04-05T22:42:33.463
> 
> 标签：ruby-on-rails-3, mongodb, mongoid, mongoid3

我`Model.find(array_of_ids)`在 mongodb 中使用 mongoid 驱动器的性能很差，我不明白为什么。

相关代码：

```
ids = get_ids() #Get an array of 137 _ids for Topic model.
Topic.find(ids) #Find all data, but take 4 seconds to do it. 
```

_id 字段是自动索引的，因此不需要任何手动配置。

那么，为什么这么慢呢？

请询问您是否需要更多解释，并为我糟糕的英语感到抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-25T10:44:40.650

似乎你已经得到了解决方案。

我只是想补充一下。

如果 id 可以达到 137，我认为您应该将关系存储在 Topic 集合中。情况恰恰相反。查询将是

```
Topic.where(:id => self.topic_id) 
```

其中 self 指的是该模型的记录。

它实际上是 has_many 和 belongs_to 关系。

Mongodb 存储数组的能力，并不意味着对于与其他模型关联的那么多（137）条记录，您可以以这种方式存储。关系方法更好。如果数据类型与其他模型/集合无关，只需将某些内容放入数组中。例如，主题标签可能是“时尚、青少年、幼稚、俗气等，您没有预定义标签，而是由您的用户定义。这是在 mongodb 中使用数组功能的好机会。

对于数组包含主题列表的情况，其中主题是在主题集合中定义的数据，应该使用关系模型。

只是一些建议，请不要投票给我。

# vim - 如何将参数从 :command 传递给函数？

> ID：15844810
> 
> 赞同：10
> 
> 时间：2013-04-05T22:42:37.470
> 
> 标签：vim

我想写一个命令，这个命令的格式是这样的：

```
[range]MyCMD[!] [count] [oneArg] [flags] 
```

或者

```
[range]MyCMD[!] [oneArg] [count] [flags] 
```

类似于

```
:[range]P[rint] [count] [flags] 
```

或者

```
:[range]d[elete] [x] {count} 
```

该命令`MyCMD`最终将调用一个函数来完成一些工作。我写了这一行（**行不通**）

```
command! -nargs=+ -range -bang -count=0  MyCMD <line1>,<line2>call MyFUNC(<q-args>, "<bang>","<count>", .... ..) 
```

这里的问题是，如何处理这些论点：

*   **问题1**我读到了帮助，`-range`不能`-count`同时使用，但我需要它们。我还看了一些 vim 命令，比如 :delete、:print，当我们使用这些命令时，我们可以同时给出`range`和`count`。我还发现如果 a `{count}`or`[count]`可用，vim doc 有两个相同命令的条目。像：

    ```
    :[range]d[elete] [x]    
    :[range]d[elete] [x] {count} 
    ```

    或者

    ```
    :[range]p[rint] [flags]
    :[range]p[rint] {count} [flags] 
    ```

    这是为什么？为什么不只是用`[count]`？（这将是**另一个小问题**）

*   **我的设计中的问题 2**，所有这些参数都是可选的，它们具有默认值（见下表）。如何将这些参数传递给函数（我已检查`<q-args> and <f-args>`）以及如何区分哪些用户输入用于哪个参数？例如用户给出

    `:MyCMD 5 g`

    *   5是数？还是参数？
    *   g是arg还是flag？
    *   或'5 g'是arg？  

    这是 args 的默认值：

    ```
    argName | Default value | description
    -------------------------------------
    range   | current line  | this could be get by function xxx ( ) range
    count   | 0             | this could be get by <count>
    bang    | ""            | this is easy too, with <bang>
    arg     | " "           | this argument could have space
    flags   | ""            | no space allowed for flags
    ------------------------------------- 
    ```

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-06T10:03:15.100

对于复杂的自定义命令，不能只依赖 Vim 有限的解析选项；你可以让它处理范围`-range`，但必须自己解析你的参数组合。

```
:command! -nargs=* -range -bang MyCMD <line1>,<line2>call MyFUNC(<bang>0, <q-args>) 
```

内部`MyFUNC`（可能应该定义`:function MyFUNC( ... ) range`为仅调用一次），`split()`空格上的参数。或者，您可以将函数定义为使用可变数量的参数并使用`<f-args>`，但请注意函数参数的数量是有限的（最多 20 个 IIRC）。

这`<bang>0`是将 bang 转换为布尔值的一个很好的技巧，这通常是您所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T23:21:07.693

不得不提出棘手的问题。我真的没有任何解决方案，但这是我的发现。

```
:command! -range -bang -nargs=* MY echo [<bang>0, <line1>, <line2>, <count>, <q-args>] 
```

运行以下场景后：

```
:MY
[0, 3, 3, -1, '']
:MY!
[1, 3, 3, -1, '']
:%MY
[0, 1, 10, 10, '']
:%MY 4
[0, 1, 10, 10, '4']
:MY 4
[0, 3, 3, -1, '4']
:%MY flag
[0, 1, 10, 10, 'flag']
:MY flag
[0, 3, 3, -1, 'flag']
:%MY 4 flag
[0, 1, 10, 10, '4 flag'] 
```

现在用`-count`而不是`-range`

```
:command! -count -bang -nargs=* MY echo [<bang>0, <line1>, <line2>, <count>, <q-args>] 
```

结果：

```
:MY
[0, 3, 1, 0, '']
:MY!
[1, 3, 1, 0, '']
:%MY
[0, 1, 10, 10, '']
:%MY 4
[0, 1, 4, 4, '']
:MY 4
[0, 3, 4, 4, '']
:%MY flag
[0, 1, 10, 10, 'flag']
:MY flag
[0, 3, 1, 0, 'flag']
:%MY 4 flag
[0, 1, 4, 4, 'flag'] 
```

如您所见，这并不容易。我的建议是`-range`与您的命令一起使用。然后通过 解析`<q-args>`寻找数字`\d\+`。

# ios - 其他 settings.plist 不显示在 iOS 的设置包中

> ID：15844813
> 
> 赞同：0
> 
> 时间：2013-04-05T22:42:49.640
> 
> 标签：ios, objective-c, xcode, settings.bundle

在过去的几个小时里，我尝试实现一个额外的 Settings Bundle plist 文件。在此屏幕上，您可以在左侧站点上看到 Root.plist 和 ChildNode 项，用于名为“more.plist”的附加 plist 文件（位于 xCode 中的 settings.bundle 中。 ![带有两个 plist 文件的 xCode 屏幕截图](https://i.stack.imgur.com/x2udp.png)

但是当我将应用程序部署到模拟器时，我看不到附加设置窗格“第三方许可证”。 ![在此处输入图像描述](https://i.stack.imgur.com/g2qXV.png)

当我单击“第三方许可证”时，会出现一个空白页面。

![结果](https://i.stack.imgur.com/hAL5J.png)

怎么了 ？是的，我已经阅读了@apple dev center 的开发者库，但我找不到我正在搜索的信息:(

我很感激你的想法！

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T19:20:01.487

卸载您的应用程序，然后重新安装，它对我有用...

# r - 查找字符串不是 %in% 其他字符串向量

> ID：15844816
> 
> 赞同：5
> 
> 时间：2013-04-05T22:43:16.003
> 
> 标签：r

如果你有一个字符串向量并且你想知道哪个匹配。使用 %in% 很简单。

```
x <- c("red","blue","green")
y <- c("yellow","blue","orange")

which(x %in% y) # Literally, which X are in Y. 
```

但是相反的情况呢，你想在哪里找到哪些 X 不在 Y 中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T22:49:53.407

我喜欢的一种简洁方式（我从@joran，iirc 学到的）是：

```
`%nin%` <- Negate(`%in%`)
which(x %nin% y)
[1] 1 3 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-05T22:48:56.103

Doing`%in%`返回一个真假向量。使用感叹号将使那些 Ts 和 Fs 转过来，并且通过将所有内容包装进去`which`将为您提供索引。

```
> which(!x %in% y)
[1] 1 3
> which(x %in% y)
[1] 2 
```

# php - 在 hybridauth 中执行 Yahoo YQL

> ID：15844818
> 
> 赞同：0
> 
> 时间：2013-04-05T22:43:17.907
> 
> 标签：php, yahoo-api, hybridauth

我使用[hybridauth](http://hybridauth.sourceforge.net/)来获取 Yahoo 联系人。Hybridauth 使用 OAuth REST API 进行调用。

问题是使用 rest API 我没有得到所有联系人。[如果我在http://developer.yahoo.com/yql/console/](http://developer.yahoo.com/yql/console/)中使用 YQL，我会得到所有联系人。

我必须在雅虎的联系人类型。我手动输入的测试联系人和我使用雅虎工具导入的 Facebook 联系人。

使用 YQL，我得到了所有这些。使用 hybridauth rest api 我只能得到一个联系人（测试一个）。所以我的问题是是否可以使用 hybridauth 执行 YQL。

到目前为止，我尝试过`hybridauth/Hybrid/Providers/Yahoo.php`：

```
$response = $this->api->get('http://query.yahooapis.com/v1/yql?q=select%20*%20from%20social.contacts(0)%20where%20guid%3Dme%3B', $parameters); 
```

但不工作:(

谢谢！

# php - 试图在 PHP 中打印 stdClass 对象的属性，以文字'$'开头

> ID：15844824
> 
> 赞同：1
> 
> 时间：2013-04-05T22:43:56.187
> 
> 标签：php, echo, stdclass

我的对象名称是 $distinct1

`print_r($distinct1)`显示下面的对象但是当我尝试做

```
echo $distinct1->properties->city 
```

或者

```
echo $distinct1->distinct_id 
```

我没有得到任何价值回报。知道发生了什么吗？

```
stdClass Object
(
    [$distinct_id] => AAA
    [$properties] => stdClass Object
        (
            [$city] => Palo Alto
            [$country_code] => US
            [$region] => California
            [$name] => John Smith
)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:48:51.307

嗯，如果你的属性真的是这样命名的：

```
$distinct1->{'$properties'}->{'$city'} 
```

但如果可能的话，我会研究*设置*它的机制并在那里修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:47:49.307

该对象的属性名称实际上以`$`任何奇怪的原因开头。

```
echo $distinct1->{'$properties'}->{'$city'}; 
```

# php - 文件名最大长度

> ID：15844825
> 
> 赞同：1
> 
> 时间：2013-04-05T22:43:58.887
> 
> 标签：php, javascript

我有一个这样的文件上传表格

```
<form action="upload_file.php" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label>
<input type="file" name="file" id="file"><br>
<input type="submit" name="submit" value="Submit">
</form> 
```

有时用户上传的文件名称为 200 个字符。存在限制文件名最大长度的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:51:35.040

浏览器会将基本文件名公开给 JavaScript，因此这在技术上是可行的，尽管正如上面提到的@VisioN，我想不出你为什么会关心；只需将服务器上的文件重命名为其他文件即可。如果你绝对需要阻止它，那么给你的元素一个 ID`uploader`然后：

```
<script>
document.getElementById("uploader").onsubmit = function(){
    return document.getElementById("file").value.length < 200; 
};
</script> 
```

当然，这只有在启用 JavaScript 时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T23:19:34.750

使用 Graham 的代码并使用 PHP 检查文件名长度

```
if(strlen($_POST['name']) > 200) { echo "filename to long"; exit; } 
```

并且您必须将 MAX_FILE_SIZE 添加到您的 HTML 表单中，否则 PHP 不会获取上传的文件

```
<input type="hidden" name="MAX_FILE_SIZE" value="MaximumFilesizeInBytes"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:14:47.753

您还应该在 PHP 端验证它，因为有人可以直接将其提交到 upload_file.php 并绕过任何 HTML/JavaScript 限制。

# drag-and-drop - SL 5 文件拖放应用程序在本地工作，而不是从远程网页启动

> ID：15844827
> 
> 赞同：1
> 
> 时间：2013-04-05T22:44:07.927
> 
> 标签：drag-and-drop, silverlight-5.0

我正在开发一个用户可以将文件和目录拖放到其中的应用程序。
当我从调试器启动应用程序时，无论是带调试还是不带调试，应用都会按预期工作。
当我尝试在远程站点的页面中使用 xap 时，我得到一个安全异常。

```
foreach (FileInfo fi in files)  
{  
  // _files.Enqueue(fi);  
  if (fi.Attributes == FileAttributes.Directory) 
```

将调试器附加到浏览器，我看到：

+fi.Attributes 'fi.Attributes' 引发了类型为 'System.Security.SecurityException' System.IO.FileAttributes {System.Security.SecurityException} 的异常
“不允许文件操作。访问路径 '' 被拒绝。”

1）为什么从调试器启动它会起作用？
2）我怎样才能让它在调试器之外工作？

感谢您的任何见解....

# java - 使用用户定义的 IdentifierGenerator UUID 休眠

> ID：15844828
> 
> 赞同：0
> 
> 时间：2013-04-05T22:44:16.227
> 
> 标签：java, database, hibernate, uuid

我正在使用 Hibernate 3.6 的环境。我正在尝试实现一个使用 java.util 中的 UUID 作为 PK 的 MySQL 表，这些 UUID 是从 EntityImage 定义的多个字符串生成的。这是我用来生成这些密钥的代码。

```
public class EntityIDGenerator implements IdentifierGenerator {
    ...    
    private UUID generateUUID(String str) {
            return UUID.nameUUIDFromBytes(str.getBytes());
    }
    public UUID generateUUID(EntityImage image) {
        return generateUUID(image.getEntityId()+image.getEntityType().toUpperCase()+image.getFilename().toUpperCase());
    }
    ...
    public Serializable generate(SessionImplementor session, Object object)
        throws HibernateException {
              if(object instanceof EntityImage) {
                   return generateUUID((EntityImage)object);
              }
              return null;
    }
} 
```

在这里他是我的冬眠

```
<class name="EntityImage" table="entity_image">
    <id name="id" column="id" type="entityUUID" unsaved-value="null">
        <generator class="com.covelo.energy.score.db.EntityIDGenerator" />
    </id>
    <property name="entityId" type="int"/>
    <property name="entityType" type="string" length="45" />
    <property name="filename" type="string" length="90" />
    <property name="fileType" type="string" length="5"/>
    <property name="imageData" type="binary" column="image_data"/>
  </class> 
```

使用我当前的设置，我只能让它以一种方式工作，自己生成 UUID 并检查 Hibernate 中是否存在密钥，然后相应地调用保存或更新（或者只是将 UUID 分别设置为 null 或值）

这种方式似乎是错误的，特别是对于实现这个 PK 生成器。理想情况下，Hibernate 会使用我的 IdentifierGenerator 生成一个 PK，然后检查它是否存在并更新或保存它。我的架构是错误的还是在休眠中有一种方法可以做到这一点？

**注意：**我很清楚 saveOrUpdate 的工作原理[Hibernate 文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/objectstate.html#objectstate-saveorupdate)

-提前致谢。内德

# javascript - Highcharts，更改最大块边框颜色

> ID：15844829
> 
> 赞同：0
> 
> 时间：2013-04-05T22:44:21.307
> 
> 标签：javascript, jquery, highcharts

我正在尝试解决一种能够从列堆栈中直观地挑选出具有最高值的块的方法。我正在考虑一种方法来做到这一点，同时保持块的背景颜色，是为
具有最大值的块添加边框颜色，例如红色。

这是我的[http://jsfiddle.net/luis9xx/ehBtQ/](http://jsfiddle.net/luis9xx/ehBtQ/)。与 highcharts 演示库中的几乎相同

我发现这个例子[http://jsfiddle.net/Z5VPw/](http://jsfiddle.net/Z5VPw/)用于将列的特定颜色更改为另一种颜色。但是数据集做的方式不一样，不确定是否需要使用类似的方案集来勾勒边框颜色。

此外，我查看了 highcharts api，似乎无法找到我正在尝试做的明确路径。

到目前为止，有两个部分

*   第 1 部分：确定列堆栈中的最大块。
*   第 2 部分：将堆栈中最大块的边框更改为红色
    *   我找到了这些属性，但不确定将它们放在哪里
    *   `borderWidth:5, borderColor:'Red'`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T11:24:26.433

第 1 部分：您可以从 Highcharts 中完成，对吧？创建简单的 for() 并检查哪一列是最高的

第 2 部分：将其放入点对象中，例如，当您知道哪些点是该格式中的最高集合数据时：

```
series: [{
    data: [ [1], [2], { y: 3, borderWidth: 5, borderColor: 'red' }]
}, {
    data: [ { y: 3, borderWidth: 5, borderColor: 'red' }, [1], [2]]
}, {
    data: [ [1], { y: 3, borderWidth: 5, borderColor: 'red' }, [2]]
}] 
```

# c# - VB6 到 C#：用于转换为双精度的哈希符号

> ID：15844833
> 
> 赞同：2
> 
> 时间：2013-04-05T22:45:11.060
> 
> 标签：c#, type-conversion, vb6-migration

我目前正在将 VB6 项目转换为 C#，并且我注意到 VB6 允许您`#`在计算期间在整数后添加 a 以将其标记（并转换）为双精度。

例子：

```
If valueAsDeg >= (1# / 60#) Then Err.Raise - 1 
```

在 C# 中是否有***类似***的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T22:47:09.910

使用后缀“D”，例如`1D`

> 默认情况下，赋值运算符右侧的实数文字被视为双精度值。但是，如果您希望将整数视为双精度数，请使用后缀 d 或 D。

[http://msdn.microsoft.com/en-US/library/678hzkk9(v=vs.110).aspx](http://msdn.microsoft.com/en-US/library/678hzkk9(v=vs.110).aspx)

```
double result = 1 / 60;
Console.WriteLine( result ); 
```

输出：0

```
double result = 1D / 60D;
Console.WriteLine( result ); 
```

输出：0.0166666666666667

`float`请注意， “F”、`decimal`“M”和“L”有类似的后缀，`long`并且支持[无符号后缀](http://msdn.microsoft.com/en-us/library/t98873t4.aspx)。

# android - 使用scala解析器在android上的Stackoverflow错误

> ID：15844836
> 
> 赞同：0
> 
> 时间：2013-04-05T22:45:33.043
> 
> 标签：android, parsing, scala

如何在 Android 中使用 scala 解析器获取 stackoverflowerror？我正在使用这段代码：

```
val parseEApply: Parser[EApply] =
    ("EApply" ~> "(" ~> parseExpression) ~ ("," ~> parseListExpression <~ ")") ^^ {
  case e ~ l => EApply(e, l)
} 
```

通过使用不同的括号重写它，我摆脱了错误。有人可以解释一下为什么吗？EApply 是一个可以包含其他表达式的表达式，以及一个表达式列表。

```
val parseEApply: Parser[EApply] =
     "EApply(" ~> parseExpression ~ ("," ~> parseListExpression <~ ")") ^^ {
  case e ~ l => EApply(e, l)
} 
```

那么为什么在第一个而不是第二个中可能存在递归错误呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T11:26:40.640

我能够通过成对重新组合解析器来部分解决这个问题。所以而不是：

```
val parseExpression = p1 | p2 | p3 | p4 | p5 | p6 | p7 | p8 
```

我用括号写了

```
val parseExpression = ((p1 | p2) | (p3 | p4)) | ((p5 | p6) | (p7 | p8)) 
```

它毫无怨言地工作。

# c++-cli - c++/cli 多线程套接字和表单

> ID：15844839
> 
> 赞同：0
> 
> 时间：2013-04-05T22:45:50.733
> 
> 标签：c++-cli

谁能指出我正确的方向，我似乎徒劳地在网络上循环......

```
private: System::Void loginButton_Click(System::Object^  sender, System::EventArgs^  e) {
             mLogin* lgn;
             string text = marshal_as<string>(subjectName->Text);

             if (lgn->login(&text) == "Master")
             {
                 delete this;
                 mSockServ server;
                 vMaster master;
                 Thread^ newThread = gcnew Thread(gcnew ThreadStart(master, &vMaster::ShowDialog));
                 newThread->Start();

                 //master.ShowDialog();
                 server.sockInit();
             }
             else if (lgn->login(&text) == "Slave")
             {
                 delete this;
                 vSlave slave;
                 mSockClnt client;
                 Thread^ newThread = gcnew Thread(gcnew ThreadStart(client, &mSockClnt::sockInit));
                 newThread->Start();
                 //client.sockInit(text);
                 slave.ShowDialog();
             }
             else if (lgn->login(&text) == "No")
             {
                MessageBox::Show("Not a valid username or password");
             }
         } 
```

我只想在一个新线程中启动一个新表单，以便它与我也想在一个新线程中启动的套接字服务器或客户端同时运行。我似乎既不能启动套接字也不能启动表单，这是我的错误：

错误 1 ​​错误 C3352：“ShowDialog”：指定的函数与委托类型“void (void)”不匹配

错误 2 错误 C3352: 'void mSockClnt::sockInit(std::string)' : 指定的函数与委托类型 'void (void)' 不匹配

虽然我确保 sockInit 是 void 类型...

谢谢你。

# git - 无法从 Git Bitbucket 存储库中删除跟踪的文件

> ID：15844841
> 
> 赞同：1
> 
> 时间：2013-04-05T22:46:01.047
> 
> 标签：git, netbeans, bitbucket

我正在与其他 3 位开发人员一起使用 git bitbucket 存储库。

其中一位开发人员不小心推送了一个我们不想在 repo 中跟踪的文件，现在我正试图删除它。

当我执行命令时：

`git update-index --assume-unchanged nbproject/genfiles.properties`

它给了我错误：

`fatal: Unable to mark file nbproject/genfiles.properties`

虽然文件显然在那里。我已经承诺了。但是，当我执行 git status 时，我有两个没有为提交暂存的更改（因为我故意将它们排除在提交之外）。

我们都在使用 Netbeans（别无选择），这是我正在尝试删除的特定于项目的文件，因为我们在不同的机器上是不同的（它们在 Mac 上，我在 Linux 上）。

我是否可以删除或取消跟踪其他人添加的此文件？我是 bitbucket repo 的管理员。

该文件在我的 .gitignore 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T18:29:31.600

我找到了我的问题的答案。我做了一个`git ls-files`，发现我想要删除的文件没有被我跟踪。这就是我无法标记或删除它们的原因。

所以我找到了我的同事，让他们运行相同的命令来找出谁在跟踪文件。当我找到罪魁祸首时，我让他们运行`git rm --cached filename`，然后提交，然后推送。

问题解决了。

# jquery - jquery 只工作一次

> ID：15844848
> 
> 赞同：0
> 
> 时间：2013-04-05T22:46:37.130
> 
> 标签：jquery, css, html-lists, toggle

我有一个默认状态下带有隐藏列表元素的 ul：

```
$(function () {
    $("li.closed > ul").hide();
}); 
```

单击时，我会显示带有切换的隐藏列表元素。

```
$("ul > li.closed").click(function () {
    var li = $(this).closest('li');
    li.find(' > ul').slideToggle('fast');
    $(this).toggleClass("closed open");
}); 
```

一切正常。但是当我访问另一个页面并返回到我以前的页面时，切换不再起作用 - 当我单击它们时，它们会切换出去并立即切换回。

我正在将我的链接加载到一个 div 中：

```
$(".link").click(function (e) {
    // Prevent the default action of the event
    e.preventDefault();
    var linkHref = this.id + '.html';
    $("#content").load(linkHref);
    $("#nav a.active").toggleClass('inactive active');
    $(this).addClass("active").removeClass('inactive');
}); 
```

因此我的 html 页面只存在于正文部分，并且我每次都在加载 global.js，这可能是一个问题（比如缓存或其他东西）吗？像这样：

```
<script src="js/global.js" type="text/javascript"></script>

<article>    
    <ul>
        <li class="closed">Headline
            <ul>
                <li class="fl"><a href="#"><img src="x.png"></a></li>
                <li class="fl"><a href="#"><img src="x.png"></a></li>
            </ul>
        </li>
    </ul>
</article> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:52:08.250

而不是这个-

```
$(function () {
    $("li.closed > ul").hide();
}); 
```

删除上面的 jQuery 代码并将其插入到您的 CSS

```
li.closed > ul {
    display:none;
} 
```

# javascript - jQuery 1.9.1 中的单选按钮是否存在错误？

> ID：15844852
> 
> 赞同：11
> 
> 时间：2013-04-05T22:46:49.847
> 
> 标签：javascript, jquery, debugging, jquery-selectors

我一直在尝试使用 jQuery 以编程方式选择单选按钮，我认为这就像更改选中的属性一样简单。

但是，以下代码似乎并没有在 Chrome/Firefox 中执行 jQuery 1.9.1 中的预期。

**预期行为：**单击包含单选按钮的 div -> 'checked' 属性被设置 -> 在 DOM 中呈现检查。

**实际行为：**单击包含单选按钮的 div -> 'checked' 属性被设置 -> 在 DOM 中为单击的第一个和第二个按钮呈现选中状态，后续按钮不会呈现为选中状态。

**jQuery：**

```
$('div.form-type-radio').on('click', function () {    
    var Id = $(this).find('input[type=radio]').attr('id');   
    $('form input[type=radio]:not(#'+Id+')').removeAttr('checked');   
    $('#' + Id).attr('checked', 'checked');    
    console.log($('#' + Id));    
}); 
```

这是一个 jsFiddle - [http://jsfiddle.net/GL9gC/](http://jsfiddle.net/GL9gC/)

我已经用以前版本的 jQuery 尝试了相同的代码，并且一切都按预期工作。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-05T22:49:30.880

在这种情况下，您应该使用[**prop()**](http://api.jquery.com/prop/)而不是[**attr()**](http://api.jquery.com/attr/) / [**removeAttr()**](http://api.jquery.com/removeAttr/)。

这是一个有效的[**jsFiddle**](http://jsfiddle.net/GL9gC/3/)。

**jQuery：**

```
$('div.form-type-radio').on('click', function () {
    var Id = $(this).find('input[type=radio]').prop('id');
    $('form input[type=radio]:not(#'+Id+')').prop('checked');
    $('#' + Id).prop('checked', 'checked');
    console.log($('#' + Id));
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T22:53:22.377

`**[LIVE DEMO](http://jsfiddle.net/GL9gC/2/)**`

```
$('div.form-type-radio').on('click', function () {    
    $(this).find(':radio').prop({checked: true});
}); 
```

[http://api.jquery.com/prop/](http://api.jquery.com/prop/)

# regex - 如何验证“。” 在电子邮件地址中？

> ID：15844854
> 
> 赞同：0
> 
> 时间：2013-04-05T22:47:05.397
> 
> 标签：regex, forms, validation

我有以下方法可以在表单中验证我的电子邮件地址。

```
 -(BOOL) validEmailAddress:(NSString*) emailString {
    NSString *regExPattern = @"^[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}$";
    NSRegularExpression *regEx = [[NSRegularExpression alloc] initWithPattern:regExPattern options:NSRegularExpressionCaseInsensitive error:nil];
    NSUInteger regExMatches = [regEx numberOfMatchesInString:emailString options:0 range:NSMakeRange(0, [emailString length])];
    if (regExMatches == 0) 
        return NO; // email invalid
     else
        return YES; // email valid 
  } 
```

这很好用，只是如果用户提供“abc@xyz”的电子邮件（没有像 .com 或 .org 这样的超级域），它就会崩溃。

我很确定问题与“。”有关。在我的正则表达式中。我试着像这样逃避它，

```
NSString *regExPattern = @"^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$"; 
```

但这也行不通。有什么建议么？

编辑：最初发布问题时，我没有在最后一个点之前添加转义符。对不起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:51:17.457

你必须逃脱最后一个点。因此，您的表达如下：

```
^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$ 
```

但是，由于`\`Objective C 也将 解释为转义字符，因此您必须对其进行转义。这是在 Objective C 中通过使用双反斜杠 ( `\\`) 完成的

```
NSString *regExPattern = @"^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:51:29.180

在您的上一个示例中，我没有看到转义序列。尝试：

```
NSString *regExPattern = @"^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:16:50.310

你需要逃避这个点，是的。

要接受“abc@xyz”，您还需要将点及其后面的所有内容设为可选。您可以通过将其封装在括号中并在其后加上问号来做到这一点，例如：

```
^[A-Z0-9._%+-]+@[A-Z0-9.-]+(\.[A-Z]{2,4})?$ 
```

# python - 执行 STAX 文件时将日志消息转储到控制台

> ID：15844865
> 
> 赞同：0
> 
> 时间：2013-04-05T22:48:08.277
> 
> 标签：python, xml, automation

我有一个从命令行执行的 XML 文件 (STAX)

```
[root@local ~]# staf local STAX EXECUTE FILE "/root/test2.xml" 
ARGS "{'command':'ls'}" WAIT RETURNRESULT 
```

并获得以下输出..

```
Response
--------
{
  Job ID         : 57
  Start Date-Time: 20130405-18:27:13
  End Date-Time  : 20130405-18:27:13
  Status         : Normal
  Result         : 0
  Job Log Errors : []
  Testcase Totals: {
    Tests : 0
    Passes: 0
    Fails : 0
  }
} 
```

脚本内容..

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE stax SYSTEM "stax.dtd">
<stax>
<defaultcall function="runCommand"/>

<function name="runCommand">
    <function-list-args>
            <function-required-arg name="command"/>
    </function-list-args>

    <try>
           <sequence>

            <script>print("This");</script>
            <message>'%s  %s:  is a:  %s' % (STAXCurrentTestcase, STAXCurrentFunction, command)</message>
            <log>'test'</log>

            <return>0</return>
        </sequence>

        <catch exception="'eTerminateFunction'" var="eInfo">
            <sequence>
                    <log level="'fail'">'%s  %s:  Terminating function   Error: %s' % (STAXCurrentTestcase, STAXCurrentFunction, eInfo)</log>
                    <tcstatus result="'fail'">eInfo</tcstatus>
                    <return>1</return>
            </sequence>
        </catch>
    </try>
</function>
</stax> 
```

为什么在执行期间或之后没有任何日志记录被转储到控制台？
for`<log>`或`<message>`python`<script>print("This")</script>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T03:46:05.377

据我所知

> STAX EXECUTE WAIT RETURNRESULT 请求在结果中准确返回它应该返回的内容，如[STAX 用户指南的](http://staf.sourceforge.net/current/STAX/staxug.html#Header_Execute)“执行”部分“结果”小节中所述。它返回有关作业的更多摘要类型信息以及 STAX 作业日志中记录的任何错误。
> 
> [STAX 作业中的元素在 STAX 作业用户日志中记录一条消息，如STAX 用户指南中](http://staf.sourceforge.net/current/STAX/staxug.html#Header_Log_Element)的“日志：在 STAX 作业用户日志中记录一条消息”部分所述。[本节说要查看“STAX 日志记录”部分的“查询 STAX 作业用户日志”](http://staf.sourceforge.net/current/STAX/staxug.html#Header_StaxLogging)小节，以获取有关如何查询 STAX 作业用户日志以查看您在 STAX 作业中登录的消息的更多信息.
> 
> 或者，要在 STAX 服务计算机上查询具有作业 ID 1 的 STAX 作业的 STAX 作业用户日志，您可以指定：

```
STAF local LOG QUERY MACHINE {STAF/Config/MachineNickname} LOGNAME STAX_Job_1_User 
```

> **注意：**当您运行 STAX 作业时，会创建一个 STAX 作业日志。这与 STAX 作业用户日志不同。只有当 STAX 作业在其中记录数据（例如通过元素）时，才会创建 STAX 作业用户日志。
> 
> [STAX 作业中的元素向 STAX 监视器发送消息，如 STAX 用户指南http://staf.sourceforge.net/current/STAX/staxug](http://staf.sourceforge.net/current/STAX/staxug.html#Header_Message_Element)中的“消息：向 STAX 监视器发送消息”部分所述。 [html#Header_Message_Element](http://staf.sourceforge.net/current/STAX/staxug.html#Header_Message_Element)。要查看发送到 STAX Monitor 的消息，您需要通过 STAX Monitor 运行作业。运行 STAX 作业时，消息将显示在“消息”面板中。
> 
> 至于元素内“打印”语句的输出到哪里，这由 PYTHONOUTPUT 参数控制，该参数可以在注册 STAX 服务时指定或通过 STAX SET PYTHONOUTPUT 请求更改，或在执行时为特定 STAX 作业覆盖STAX 作业（通过在 STAX EXECUTE 请求上或通过 STAX 监视器指定 PYTHONOUTPUT 选项）。[这将在“安装和配置”](http://staf.sourceforge.net/current/STAX/staxug.html#Header_StaxServiceMach)一节中讨论。[STAX 用户指南中的“STAX 服务机器”](http://staf.sourceforge.net/current/STAX/staxug.html#Header_StaxServiceMach) 小节和“执行”部分。
> 
> 默认设置是在 STAX 作业用户日志中记录 Python 打印输出。因此，如果您使用默认设置，“打印”输出将记录到 STAX 作业用户日志（与元素中的消息记录的位置相同），您可以通过查询 STAX 作业用户日志来查看它我上面讲过。
> 
> *   PYTHONOUTPUT 指定 Python 的 stdout/stderr 应该被重定向到哪里（例如，如果您在 STAX 作业的元素中使用 print 语句）。有效值如下（不区分大小写）：
> *   “JobUserLog”表示将 Python 输出记录在 STAX 作业用户日志中。这是默认设置。
> *   “消息”表示将 Python 输出发送到 STAX 监视器并显示在消息面板中。
> *   “JobUserLogAndMsg”表示将 Python 输出记录在 STAX 作业用户日志中，并将其发送到 STAX 监视器并显示在消息面板中。
> *   “JVMLog”表示使用以下格式将 Python 输出写入 STAX 服务的 JVM 日志中，以便您知道哪个 STAX 作业在什么时间产生了输出： <`Timestamp> [JobID: <JobID>] <Python Output>`

# html - 我可以使文本区域与文本一起增长到最大高度吗？

> ID：15844868
> 
> 赞同：29
> 
> 时间：2013-04-05T22:48:26.243
> 
> 标签：html, css, textarea

我正在做一个项目，我在 div 中有各种大小的数据。当用户点击其中一个 div 时，它需要变成一个可编辑的文本区域。宽度是恒定的，但我希望高度从原始 div 的高度开始，然后在添加滚动条之前增长到最大高度。那可能吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-04-05T22:59:31.583

您可以使用`contenteditable`并让用户直接输入`div`，这是一个演示：http: [//jsfiddle.net/gD5jy/](http://jsfiddle.net/gD5jy/)

## HTML

```
<div contenteditable>
    type here...
</div> 
```

## CSS

```
div[contenteditable]{
    border: 1px solid black;
    max-height: 200px;
    overflow: auto;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-19T05:13:11.840

有一篇关于这个主题的优秀的 A List Apart 文章：[Expanding Text Areas Made Elegant](http://alistapart.com/article/expanding-text-areas-made-elegant)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-05T22:54:58.183

这是JavaScript函数

```
// TextArea is the Id from your textarea element
// MaxHeight is the maximum height value
function textarea_height(TextArea, MaxHeight) {
    textarea = document.getElementById(TextArea);
    textareaRows = textarea.value.split("\n");
    if(textareaRows[0] != "undefined" && textareaRows.length < MaxHeight) counter = textareaRows.length;
    else if(textareaRows.length >= MaxHeight) counter = MaxHeight;
    else counter = 1;
    textarea.rows = counter; } 
```

这是CSS样式

```
.textarea {
height: auto;
resize: none; } 
```

这是HTML代码

```
<textarea id="the_textarea" onchange="javascript:textarea_height(the_textarea, 15);" width="100%" height="auto" class="textarea"></textarea> 
```

这对我来说可以

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-21T10:04:27.057

我用 Javascript 创建的最好的解决方案（[在 developer.mozilla.org 上](https://developer.mozilla.org/en-US/docs/Web/API/HTMLTextAreaElement#autogrowing_textarea_example)），并且适合在一行中使用，并且有点风格。

*单独的 Javascript 仅对演示的自动编写有用。*

```
/*
      AUTO TYPE TEXT FROM THIS S.O. ANSWER: 
          https://stackoverflow.com/a/22710273/4031083
          Author @Mr.G
*/
var demo_input = document.getElementById('txtArea');

var type_this = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sed blandit turpis, eu auctor arcu.\r\n\r\nCras iaculis urna non vehicula volutpat. Nullam tincidunt, ex sit amet commodo pulvinar, lorem ex feugiat elit, non eleifend nisl metus quis erat.";
var index = 0;

window.next_letter = function() {
    if (index <= type_this.length) {
        demo_input.value = type_this.substr(0, index++);
        demo_input.dispatchEvent(new KeyboardEvent('keyup'));
        setTimeout("next_letter()", 50);
    }
}

next_letter();
```

```
<!-- THE MAIN PART -->
<textarea 
  id = "txtArea"
  cols="20" 
  rows="4" 
  onkeyup="if (this.scrollHeight > this.clientHeight) this.style.height = this.scrollHeight + 'px';"
  style="overflow:hidden;
         transition: height 0.2s ease-out;">

</textarea>
```

# sql-server - JDBC / IntelliJ 无法加载 sqljdbc_auth.dll

> ID：15844875
> 
> 赞同：3
> 
> 时间：2013-04-05T22:48:54.573
> 
> 标签：sql-server, jdbc, intellij-idea

我正在尝试在 IntelliJ 中运行一个小型测试程序。代码：

```
String driverClass = "com.microsoft.sqlserver.jdbc.SQLServerDriver";
    String url = "jdbc:sqlserver://test.test.com;integratedSecurity=true";
    String userName = "test";
    String password = "test";
    Class.forName(driverClass);
    try (Connection con = DriverManager.getConnection(url, userName, password);
         Statement st1 = con.createStatement();
         Statement st2 = con.createStatement();
    ) {
      String sql1 = "EXEC  [dbo].[Cleanup]";
      String sql2 = "EXEC  [dbo].[DetailsALL] \"DetailsALL.csv\" ";
      st1.execute(sql1);
      st2.execute(sql2);

    }catch(Exception e){
     System.out.println(e.getMessage());
    } 
```

我在 VM 选项中添加了以下内容：

-Djava.library.path="\Users\sgupta\IdeaProjects\todos\sqljdbc_4.0\enu\auth\x86\" ![在此处输入图像描述](https://i.stack.imgur.com/8zIIS.png)

运行程序会导致：

**2013 年 4 月 5 日下午 5:43:20 com.microsoft.sqlserver.jdbc.AuthenticationJNI 警告：无法加载 sqljdbc_auth.dll 原因：java.library.path 中没有 sqljdbc_auth 此驱动程序未配置为集成身份验证。ClientConnectionId:db8a3aa3-d84b-49d2-a7eb-64c4187a8303**

我已经仔细检查了我在 VM 选项中指定的路径。还有其他建议吗？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-07T00:08:45.757

看来我有一些坏消息要告诉你。这直接来自 .tar.gz 文件中包含的 sqljdbc 文档。打包文件后，转到此帮助网页：sqljdbc_4.0/enu/help/default.htm

在目录 >>> 使用 JDBC 驱动程序连接到 SQL Server >>> 构建连接 URL 下，转到“使用集成身份验证连接”部分

本节的底部有以下引用，它基本上表示您不能将 dll 方法用于非 Windows 系统。

> JDBC驱动在非Windows操作系统上运行时不支持集成认证。当从非 Windows 操作系统连接到 SQL Server 时，该驱动程序也不提供任何功能来提供 Windows 身份验证凭据，例如用户名和密码。在这种情况下，应用程序必须改用 SQL Server 身份验证。

但是，这个相同的帮助文件的等效 msdn 文档似乎表明，对于所有非 Windows 操作系统，您可以让它与 Kerberos 一起使用。 [http://msdn.microsoft.com/en-us/library/ms378428.aspx](http://msdn.microsoft.com/en-us/library/ms378428.aspx)

此 msdn 链接提供了 Kerberos 进程的概述，但它缺乏针对非 Windows 机器的详细设置。 [http://msdn.microsoft.com/en-us/library/gg558122.aspx](http://msdn.microsoft.com/en-us/library/gg558122.aspx)

如果有人想出让 Kerberos 从非 Windows 机器连接到 SQL Server 的详细信息，我很想听听他们的意见。

# php - 我想获取公共 ip，但是 apache2 获取私有 ip

> ID：15844876
> 
> 赞同：0
> 
> 时间：2013-04-05T22:48:55.500
> 
> 标签：php, apache, ip

我想获得我的用户的公共 IP 地址，但我的代码获得了私人 IP……你知道有什么问题吗？

我的代码：

```
function get_ip()
{
        $ips = "";

        if(isset($_SERVER["HTTP_CLIENT_IP"]))
            $ips .= ';'.$_SERVER["HTTP_CLIENT_IP"];

        if(isset($_SERVER["HTTP_X_FORWARDED_FOR"]))
            $ips .= ';'.$_SERVER["HTTP_X_FORWARDED_FOR"];

        if(isset($_SERVER["HTTP_X_FORWARDED"]))
            $ips .= ';'.$_SERVER["HTTP_X_FORWARDED"];

        if(isset($_SERVER["HTTP_FORWARDED_FOR"]))
            $ips .= ';'.$_SERVER["HTTP_FORWARDED_FOR"];

        if(isset($_SERVER["HTTP_FORWARDED"]))
            $ips .= ';'.$_SERVER["HTTP_FORWARDED"];

        if(isset($_SERVER["REMOTE_ADDR"]))
            $ips .= ';'.$_SERVER["REMOTE_ADDR"];

    return $ips;

} 
```

有时该函数将 ip 返回为“10.46.40.246”......获取公共 ip 的最佳方法是什么？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T22:53:35.350

您看到的异常可能来自办公环境中代理背后的人。如果您总是想要公共 IP，您可能只需要使用`REMOTE_ADDR`. 我想你也可以使用这个函数，`REMOTE_ADDR`如果它返回私有 IP 块中的某些内容，则可以使用它。

# r - 考试 r 包仍然可用吗？我无法在 mac lion 10.7.5 上安装

> ID：15844878
> 
> 赞同：-6
> 
> 时间：2013-04-05T22:48:57.917
> 
> 标签：r, r-exams

找不到“考试”R 包的安装。它仍然可用吗？或已弃用？不在 CRAN 上。请帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-06T00:56:44.383

我刚刚从源代码编译它，似乎 t 没有 C 代码，所以你可以这样做：

```
 install.packages("exams", type="source") 
```

# php - 是否可以在 php 站点上进行 Windows 身份验证？

> ID：15844879
> 
> 赞同：1
> 
> 时间：2013-04-05T22:48:58.370
> 
> 标签：php, sql-server, windows, iis, windows-authentication

我们正在使用 IIS 在 php 5.2 上运行一个内部网站。

目前，每个用户都被分配了一个登录名。登录信息通过 php 授权，根据 sql server 数据库表确认信息。

PHP 使用 sql server 身份验证将 select 语句发送到 sql server。

我们希望保留 sql server 身份验证；但是，我们希望用户能够使用 Windows 身份验证访问该站点。

**我们如何在 php 站点上实现 windows 身份验证？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:56:07.987

您可以使用`LDAP`PHP 的绑定来实现这一点。

[这](http://www.davidschultz.org/blog/2008/4/10/how-to-authenticate-against-active-directory-using-php.html)是一个使用[`ldap_bind`](http://php.net/manual/fr/function.ldap-bind.php)PHP 扩展实现此功能的示例。

此示例实现的是使用目录服务[`Active Directory`](http://en.wikipedia.org/wiki/Active_Directory)对您的客户端进行身份验证，该*目录服务提供 Active Directory**域*上当前注册用户的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T22:56:45.150

如果您使用的是 Active Directory，那么您可以使用 LDAP 来验证与域的连接：

```
// load from login form
$user = 'user';
$pass = 'pass';

$ldap = ldap_connect( "example.com" );
if( false === ( $bind = ldap_bind( $ldap, $user, $pass ) ) ) {
  // auth error
} else {
  // user is authenticated
} 
```

# java - 生成带有继承字段的构造函数

> ID：15844886
> 
> 赞同：2
> 
> 时间：2013-04-05T22:50:09.903
> 
> 标签：java, intellij-idea

IntelliJ IDEA 仅使用本地字段生成构造函数（Alt + Insert），而不使用从超类继承的字段。

这对我来说听起来像是一个错误。还是有可能以某种方式？

**编辑：**

![构造器生成器](https://dl.dropbox.com/u/14685507/consts.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-07T10:55:58.490

超类字段不会显示在列表中，因为它们是由超类构造函数初始化的；这种行为是设计使然，而不是错误。

当您调用“生成构造函数”操作时，它让您选择要调用的超类构造函数。生成的构造函数的参数将是所选超类构造函数的参数和您在对话框中选择的当前类中的字段列表的组合。

# django - 如何避免在 Django 视图中硬编码 URL

> ID：15844887
> 
> 赞同：2
> 
> 时间：2013-04-05T22:50:18.407
> 
> 标签：django

我正在做一个关于 Django 的简单项目。目前，我正在实现的视图总是返回一个硬编码路径：

```
def temp_view(request):
   ...
   return render("app/detail.html") 
```

或者

```
def temp_view_2(request):
   ...
   return redirect("/app/view2") 
```

我想要做的是摆脱硬编码 URL（用于查看 URL 和模板 URL）。有没有合适的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T23:02:56.490

Django 提供了几种不同的方法。在一个视图中，该`django.core.urlresolvers.reverse()`函数是最常用的。关于这个问题和 Django 提供的选项的完整讨论在这里：

[https://docs.djangoproject.com/en/dev/topics/http/urls/#reverse-resolution-of-urls](https://docs.djangoproject.com/en/dev/topics/http/urls/#reverse-resolution-of-urls)

# javascript - 如何在toggleClass中使用名称中带有浏览器前缀的css样式的div？

> ID：15844895
> 
> 赞同：0
> 
> 时间：2013-04-05T22:51:11.243
> 
> 标签：javascript, jquery, html, css, toggleclass

我正在使用以下解决方案来解决我遇到的一些跨浏览器问题：

[跨浏览器修复](http://rafael.adm.br/css_browser_selector/)

在我的 CSS 中，使用上述解决方案，我有类似的东西：

```
 .some_class {
      margin-left: 40px;
 }
 .win.ie some_class {
      margin-left: 100px;
 } 
```

win.ie some_class 仅在 Windows 上用于 IE。

现在，在我使用 JavaScript 的代码的其他地方，我正在使用以下内容：

```
 $("#someid").toggleClass("some_class"); 
```

我现在需要做的是在上面的 JS 片段中使用 .win.ie some_class 。我该怎么做？

我试着做：

```
 $("#someid").toggleClass(".win.ie some_class"); 
```

但这只是将它添加到 HTML 中的实际类中。是否有可能完成我在这里尝试做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:54:19.557

这不是有效的 CSS：

```
.win.ie some_class {
      margin-left: 100px;
 } 
```

尝试这个：

```
.win.ie.some_class 
```

这会将样式应用于具有`win`、`ie`和`some_class`类的元素。或者：

```
.win.ie .some_class 
```

如果`some_class`元素是具有`win`和`ie`类的元素的子元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:54:09.217

首先，让我们修复 CSS，some_class 缺少点：

```
.win.ie .some_class {
    margin-left: 100px;
} 
```

其次，在toggleClass而不是实际类上查找find：

```
$(".win.ie #someid").toggleClass("some_class"); 
```

# apache-flex - Flex 4 spark datagrid 使用选项卡选择行更改

> ID：15844897
> 
> 赞同：0
> 
> 时间：2013-04-05T22:51:17.850
> 
> 标签：apache-flex, datagrid, flex-spark

当跳格通过最后一列时，我正在尝试更改火花数据网格中的选定行。换句话说，我想突出显示行以跟随活动单元格。

有任何想法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-05T01:04:24.000

这就是我的做法。我在网格上的 selectionChange 和 caretChange 事件执行相同的功能。

```
<s:DataGrid id="my_rates_grid" x="0" y="0" width="100%" height="100%"
                            creationComplete="my_rates_grid_creationCompleteHandler(event)"
                            editable="true" alternatingRowColors="[#FFFFFF, #e9f1f6]"
                            gridItemEditorSessionSave="my_rates_grid_gridItemEditorSessionSaveHandler(event)"
                            requestedRowCount="4"
                            selectionChange="my_rates_grid_selectionChangeHandler(event)"
                            caretChange="my_rates_grid_selectionChangeHandler(event)"> 
```

* * *

然后在那个 my_rates_grid_selectionChangeHandler 函数中（注意我必须将其参数类型更改为泛型类型事件）

```
protected function my_rates_grid_selectionChangeHandler(event:Event):void
        {
            if(my_rates_grid.editorRowIndex >= 0){
                trace("it's happening");
                my_rates_grid.setSelectedIndex(my_rates_grid.editorRowIndex);
            }

        } 
```

所以每次我点击它时，它都会跟随，并且保存功能也会捕获我的新值。

# json - Kendo UI Grid - ClientTemplate 调用 MVC Url.Action 调用（错误地）两个不同的动作

> ID：15844898
> 
> 赞同：0
> 
> 时间：2013-04-05T22:51:20.653
> 
> 标签：json, asp.net-mvc-4, kendo-ui, jquery-ui-dialog, kendo-grid

1.  我有一些数据通过 Ajax 绑定加载到 Kendo 网格中。
2.  在其中一列中有一个调用 javascript 方法 (showAll) 的 ClientTemplate。
3.  此方法将调用一个动作并获取数据的详细信息，将其放入 json 响应中，然后打开一个 jquery-ui 对话框以显示详细信息。
4.  当用户单击网格中的链接时，会为 GetDetails 操作触发 HttpGet，但问题是，它也会为整个页面的操作（索引）触发。

我想，问题是什么导致了索引操作被触发？因为，对话框将显示，详细数据将填充，但一旦我关闭对话框，所有过滤器文本框将被重置，网格将重新加载，其中的数据。

唯一调用的操作不应该是 GetDetails 吗？

任何提示将不胜感激！

代码：

```
@(Html.Kendo().Grid<LogViewModel>()
    .Name("LogGrid")
    .Columns(column =>
    {
        column.Bound(x => x.StuffCount).Title("Stuff").Width(70)
            .ClientTemplate("<a onclick=\"showAll('" + "#= Id #')\"" + " href=''>#= StuffCount #</a>");
    })
    .DataSource(dataBinding => dataBinding
                .Ajax()
                .PageSize(50)
                .Read(read => read.Action("GetData", "Summary")
                    .Data("getSearchFilters"))
                .Model(model => model.Id(o => o.Id)))
            .Events(e => e
                .DataBound("onGridItemsDatabound"))
            .Pageable(paging => paging.Refresh(true))
)}

<div id="dialog-message" title="" style="display: none">
    <p id="msg"></p>    
</div>

<script type="text/javascript">
    var showAll= function (id) {
        var url = '@Url.Action("GetDetails", "Summary")' + "/" + id;
        var sTitle = 'title text';
        $.getJSON(url, null, 
            function (data) {
                $("#dialog-message").dialog({ title: sTitle });
                $("#msg").text(data.details);
                showMessage();        
            });
    };

    var showMessage = function () {
        $("#dialog-message").dialog({
            modal: true,
            draggable: false,
            resizable: false,
            buttons: {
                Ok: function() {
                    $(this).dialog("close");
                }
            }
        });
    };
</script> 
```

控制器方法（为简洁起见删除了内容

```
public ActionResult Index(...)
{
    ...
}

public ActionResult GetDetails(Guid id)
{
    ... (get data from repository)

    return Json(data, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T14:17:33.270

我在 Telerik 论坛上发布了同样的问题。他们的管理员为我指出了正确的方向：

*   [http://www.kendoui.c​​om/forums/mvc/grid/kendo-ui-grid---clienttemplate-calling-mvc-url-action-calls-(不正确)-two-different-actions.aspx](http://www.kendoui.com/forums/mvc/grid/kendo-ui-grid---clienttemplate-calling-mvc-url-action-calls-(incorrectly)-two-different-actions.aspx)
*   [我应该为 JavaScript 链接使用哪个“href”值，“#”还是“javascript:void(0)”？](https://stackoverflow.com/questions/134845/href-attribute-for-javascript-links-or-javascriptvoid0)

事实证明，我必须将 void 添加到 href 以调用 javascript 并留在页面上。href="javascript:void(0)"

# vba - 在 MS PowerPoint 中查找和突出显示文本

> ID：15844903
> 
> 赞同：2
> 
> 时间：2013-04-05T22:51:36.930
> 
> 标签：vba, powerpoint, powerpoint-2007

我使用这个站点的一些代码制作了一个宏来对 Word 文档进行关键字搜索并突出显示结果。

我想在 PowerPoint 中复制效果。

这是我的 Word 代码。

```
Sub HighlightKeywords()

Dim range As range
Dim i As Long
Dim TargetList

TargetList = Array("keyword", "second", "third", "etc") ' array of terms to search for

For i = 0 To UBound(TargetList) ' for the length of the array

   Set range = ActiveDocument.range

   With range.Find ' find text withing the range "active document"
   .Text = TargetList(i) ' that has the words from the array TargetList
   .Format = True ' with the same format
   .MatchCase = False ' and is case insensitive
   .MatchWholeWord = True ' and is not part of a larger word
   .MatchAllWordForms = False ' and DO NOT search for all permutations of the word

   Do While .Execute(Forward:=True)
   range.HighlightColorIndex = wdYellow ' highlight the keywords from the for loop yellow

   Loop

   End With
Next

End Sub 
```

这是我目前在 PowerPoint 中的内容，它绝不是功能性的。

```
Sub HighlightKeywords()

Dim range As range
Dim i As Long
Dim TargetList

TargetList = Array("keyword", "second", "third", "etc") ' array of terms to search for

For Each sld In Application.ActivePresentation.Slides

For Each shp In sld.Shapes

    If shp.HasTextFrame Then

        Set txtRng = shp.TextFrame.TextRange

For i = 0 To UBound(TargetList) ' for the length of the array

   With range.txtRng ' find text withing the range "shape, text frame, text range"
   .Text = TargetList(i) ' that has the words from the array TargetList
   .Format = True ' with the same format
   .MatchCase = False ' and is case insensitive
   .MatchWholeWord = True ' and is not part of a larger word
   .MatchAllWordForms = False ' and DO NOT search for all permutations of the word

   Do While .Execute(Forward:=True)
   range.HighlightColorIndex = wdYellow ' highlight the keywords from the for loop yellow

   Loop

   End With
Next

End Sub 
```

* * *

我最终通过 MSDN 找到了我的答案，但它与我从人们提交的内容中选择的正确答案非常接近。

这是我使用的代码：

```
Sub Keywords()

Dim TargetList
Dim element As Variant

TargetList = Array("First", "Second", "Third", "Etc")

For Each element In TargetList
   For Each sld In Application.ActivePresentation.Slides
      For Each shp In sld.Shapes
         If shp.HasTextFrame Then
            Set txtRng = shp.TextFrame.TextRange
            Set foundText = txtRng.Find(FindWhat:=element, MatchCase:=False, WholeWords:=True)
            Do While Not (foundText Is Nothing)
               With foundText
                  .Font.Bold = True
                  .Font.Color.RGB = RGB(255, 0, 0)
               End With
            Loop
         End If
      Next
   Next
Next element

End Sub 
```

* * *

事实证明，代码有效，但却是一场性能噩梦。我在下面选择作为正确答案的代码运行得更加顺畅。我已经调整了我的程序以匹配所选的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T06:26:33.457

AFAIK 没有内置方法可以用颜色**突出显示找到的单词。**您可以特意创建一个矩形并将其放在找到的文本后面并为其着色，但这完全是一个不同的球类游戏。

这是一个示例，它将在所有幻灯片中搜索文本，然后将找到的文本设为粗体、下划线和斜体。如果你愿意，你也可以改变字体的颜色。

假设我们有一张看起来像这样的幻灯片

![在此处输入图像描述](https://i.stack.imgur.com/bV3Es.png)

将此代码粘贴到模块中，然后尝试。我已经对代码进行了注释，以便您理解它不会有问题。

```
Option Explicit

Sub HighlightKeywords()
    Dim sld As Slide
    Dim shp As Shape
    Dim txtRng As TextRange, rngFound As TextRange
    Dim i As Long, n As Long
    Dim TargetList

    '~~>  Array of terms to search for
    TargetList = Array("keyword", "second", "third", "etc")

    '~~> Loop through each slide
    For Each sld In Application.ActivePresentation.Slides
        '~~> Loop through each shape
        For Each shp In sld.Shapes
            '~~> Check if it has text
            If shp.HasTextFrame Then
                Set txtRng = shp.TextFrame.TextRange

                For i = 0 To UBound(TargetList)
                    '~~> Find the text
                    Set rngFound = txtRng.Find(TargetList(i))

                    '~~~> If found
                    Do While Not rngFound Is Nothing
                        '~~> Set the marker so that the next find starts from here
                        n = rngFound.Start + 1
                        '~~> Chnage attributes
                        With rngFound.Font
                            .Bold = msoTrue
                            .Underline = msoTrue
                            .Italic = msoTrue
                            '~~> Find Next instance
                            Set rngFound = txtRng.Find(TargetList(i), n)
                        End With
                    Loop
                Next
            End If
        Next
    Next
End Sub 
```

**最终截图**

![在此处输入图像描述](https://i.stack.imgur.com/akjqy.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T09:55:38.950

我想扩展@Siddharth Rout 的答案，这个答案很好而且相当推荐（我的获奖者+1）。但是，也有可能在 PP 中“突出显示”一个单词（单词范围）。设置高亮有一个严重的缺点——它会破坏其他字体设置。因此，如果真的需要使用高亮，我们需要在之后返回适当的字体设置。

这是单个文本框中单个单词的示例：

```
Sub Highlight_Word()

Dim startSize, startFont, startColor

With ActivePresentation.Slides(1).Shapes(1).TextFrame2.TextRange.Words(8).Font
'read current state
   startSize = .Size
   startFont = .Name
   startColor = .Fill.ForeColor.RGB

'set highlight
   .Highlight.RGB = RGB(223, 223, 223) 'light grey

'return standard parameters
   .Size = startSize
   .Name = startFont
   .Fill.ForeColor.RGB = startColor

End With

End Sub 
```

这种解决方案可以放在@Siddharth 解决方案内部的某个地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T16:14:32.803

如果您需要完全保留原始文本格式，您可以：

在找到包含目标文本的形状时，复制形状 将副本发送到原始形状的 Z 顺序 在副本形状上突出显示 将标签应用于副本和原始，以表明它们稍后需要注意，例如 oOriginalShape.Tags。添加“Hilighting”、“Original” oDupeShape.Tags。添加“Hilighting”、“Duplicate”

将原始形状设置为不可见

然后，如果您需要反转突出显示并恢复原始格式，您只需遍历所有形状；如果形状有一个 Hilighting 标签 = "Original"，让它可见。如果它有 Higlighting tag = "Duplicate"，请将其删除。

这里的问题是，如果有人编辑了突出显示的形状，则在您恢复时编辑将丢失。必须教用户还原、编辑，然后重新=突出显示。

# java - 此代码如何具有 LCOM4 值 1？

> ID：15844904
> 
> 赞同：1
> 
> 时间：2013-04-05T22:51:39.057
> 
> 标签：java, sonarqube, code-metrics

[声纳文档](http://docs.codehaus.org/display/SONAR/LCOM4+-+Lack+of+Cohesion+of+Methods#LCOM4-LackofCohesionofMethods-GoodLCOM4afterRefactoring)将以下内容显示为 LCOM4 = 1 的重构代码。但在我看来，它应该是 2，因为**和****之间没有凝聚力`getFullName``getFullAddress`**。我错过了什么？

```
public class Client {

  public String firstname;
  public String lastname;
  public Address address;

  public String getFullName() {
    return firstname + " " + lastname;
  }

  public String getFullAddress() {
    return address.getFullAddress();
  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:07:21.297

似乎您发现了文档问题！根据 Freddy Mallet 的说法，这不是 LCOM4 重构的一个很好的例子，将得到修复：

[http://sonar.15.n6.nabble.com/Question-about-LCOM4-td5009876.html](http://sonar.15.n6.nabble.com/Question-about-LCOM4-td5009876.html)

一般来说，有少数数据结构不太适合 LCOM4 算法，在做出重构决策时要记住这一点。POJO 和模板方法模式的具体实现是我发现属于这一类的两个例子。

在此特定情况下，上述链接中的 Mallet 解释说，此特定 bean 被授予 LCOM4=1，因为 getFullAddress 被视为 bean 访问器，并且 bean 访问器被排除在 LCOM4 评分之外。

# github - 如何停止谷歌索引我的 Github 存储库

> ID：15844905
> 
> 赞同：72
> 
> 时间：2013-04-05T22:51:39.900
> 
> 标签：github, robots.txt

我使用 Github 来存储我的一个网站的文本，但问题是 Google 也在 Github 中索引文本。因此，相同的文本将同时出现在我的网站和 Github 上。例如[这个搜索](https://www.google.com/search?client=ubuntu&channel=fs&q=Improving%20your%20Perl%20code%20-%20one%20Perl%3a%3aCritic%20policy%20at%20a%20time%20&ie=utf-8&oe=utf-8)最热门的是我的网站。第二个命中是 Github 存储库。

我不介意人们是否看到来源，但我不希望 Google 将其编入索引（并且可能会因重复内容而受到惩罚。）除了将存储库设为私有之外，还有什么方法可以告诉 Google 停止对其进行索引？

[在Github Pages](http://pages.github.com/)的情况下会发生什么？这些是源位于 Github 存储库中的站点。他们有同样的重复问题吗？

以[这个搜索](https://www.google.com/search?client=ubuntu&channel=fs&q=Marpa+parses+anything+you+can+write+in+BNF%2C+including+ambiguous+and+even+infinitely+ambiguous+grammars.+&ie=utf-8&oe=utf-8)最热门的线索进入[Marpa 网站](http://jeffreykegler.github.io/Marpa-web-site/)，但我没有看到搜索结果中列出的[来源。](https://github.com/jeffreykegler/Marpa-web-site/blob/gh-pages/index.html)如何？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-04-13T11:50:39.390

GitHub的[https://github.com/robots.txt](https://github.com/robots.txt)文件允许索引 'master' 分支中的 blob，但限制所有其他分支。因此，如果您没有“主”分支，Google 不应该为您的页面编制索引。

如何删除“主”分支：

在您的克隆中创建一个新分支 - 我们称其为“主”并将其推送到 GitHub

```
git checkout -b main
git push -u origin main 
```

在 GitHub 上更改默认分支（请参阅存储库的设置部分）或此处[https://github.com/blog/421-pick-your-default-branch](https://github.com/blog/421-pick-your-default-branch)

然后从您的克隆和 GitHub 中删除主分支：

```
git branch -d master
git push origin :master 
```

让其他可能已经分叉您的存储库的人也这样做。

或者，如果您想在经济上支持 GitHub，您可以私有化[https://help.github.com/articles/making-a-public-repository-private](https://help.github.com/articles/making-a-public-repository-private)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T14:57:35.350

简单的答案：将您的仓库设为私有。

[https://help.github.com/articles/making-a-public-repository-private](https://help.github.com/articles/making-a-public-repository-private)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-06T02:46:25.850

我可以想到目前有效的两种解决方案：

1.  **重命名您的存储库以开始`tags`。** 因此，例如，代替`my-repo`，将其重命名为`tags-my-repo`。或者：
2.  创建一个新分支，但不要将其设为默认值。然后，在默认分支上，删除所有文件。这样做的副作用是 a) 使默认分支在保持公共状态的同时对爬虫隐藏之外毫无用处，以及 b) 迫使您将新分支用作主分支。您仍然可以根据需要重命名现在无用的默认分支和事实上的新分支。

**为什么我认为该线程中的旧解决方案不再起作用：** [https](https://github.com/robots.txt) ://github.com/robots.txt从那时起发生了变化。在 2013 年提出原始问题时，[robots.txt 看起来像这样](https://web.archive.org/web/20130413033056/https://github.com/robots.txt)：

```
User-agent: Googlebot
Allow: /*/*/tree/master
Allow: /*/*/blob/master
Disallow: /ekansa/Open-Context-Data
Disallow: /ekansa/opencontext-*
Disallow: /*/*/pulse
Disallow: /*/*/tree/*
... 
```

而现在没有`Allow`s 而只​​有`Disallow`s：

```
User-agent: *

Disallow: /*/pulse
Disallow: /*/tree/
Disallow: /gist/
Disallow: /*/forks
...
Disallow: /*/branches
Disallow: /*/tags
... 
```

如果您只是创建一个新分支，将其设为默认分支，然后删除旧分支，则 URL`https://github.com/user-name/repo-name`将仅显示您的新默认分支并在当前`robots.txt`.

**我上面的解决方案是如何工作的：（** 它们基于[谷歌目前对 robots.txt](https://developers.google.com/search/docs/advanced/robots/robots_txt#url-matching-based-on-path-values)的解释）

**解决方案 1**将使您的 repo 的 URL 匹配`Disallow: /*/tags`，从而将其排除在爬网之外。因此，事实上，您可以使用`disallow`表单路径中的任何单个单词为您的 repo 名称添加前缀，`/*/word`而无需以斜杠结尾（因此`tree`，由于以斜杠结尾，因此不起作用`Disallow: /*/tree/`）。

**解决方案 2**只是确保默认分支（即唯一已爬网的分支）不包含您不想爬网的内容。换句话说，它将所有相关的东西“移动”到一个分支，所以它们在 中`https://github.com/user-name/repo-name/tree/branch-name`，由于`Disallow: /*/tree/`.

**免责声明**

*   显然，我的解决方案在很大程度上取决于`robots.txt`任何给定时间点的情况。
*   [这并不能*保证*它不会出现在搜索结果](https://developers.google.com/search/docs/advanced/robots/intro)中。
*   这应该很明显：由于您的存储库是公开的，因此已经知道您的用户名的人总是可以导航到您的内容。这个事实与手头的问题无关，但我认为我应该把它放在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-06T08:29:25.290

如果想坚持使用 master 分支，似乎没有办法使用私人回购（并向上销售你的 GitHub 帐户）或使用其他免费提供私人回购的服务，如[Bitbucket](https://bitbucket.org)。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2013-04-06T05:43:13.533

短遮阳篷。是的，您可以使用 robots.txt。

如果您想阻止 Googlebot 抓取您网站上的内容，您有多种选择，包括使用 robots.txt 阻止访问您服务器上的文件和目录。

只有当您的网站包含您不希望搜索引擎索引的内容时，您才需要 robots.txt 文件。如果您希望搜索引擎为您网站中的所有内容编制索引，则不需要 robots.txt 文件（甚至不需要一个空文件）。

虽然 Google 不会抓取 robots.txt 阻止的网页内容或将其编入索引，但如果我们在网络上的其他网页上找到这些网址，我们仍可能会将其编入索引。因此，页面的 URL 以及其他公开可用的信息（例如指向该站点的链接中的锚文本或来自 Open Directory Project (www.dmoz.org) 的标题）可能会出现在 Google 搜索结果中。

资料来源：

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93708](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=93708) [http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156449](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=156449)

# c++ - Lua 模块从 DllMain 推送 C 函数

> ID：15844908
> 
> 赞同：1
> 
> 时间：2013-04-05T22:52:04.280
> 
> 标签：c++, c, lua

我有一个该死的大问题。如您所知，Lua 允许制作模块，您可以使用 5.1（以前的 loadlib）中的 require() 函数加载这些模块。

```
#define LUA extern "C" __declspec(dllexport) int __cdecl

static int l_TestFunc(lua_State * L) 
{

    lua_pushboolean (L, 1); // return true

    return 1;
}

LUA luaopen_MyModule(lua_State *L)
{

    printf("test2");
    lua_pushcfunction(L, l_TestFunc);
    lua_setglobal(L, "TestFunc");

    return 1;
} 
```

所以在 Lua 中你只是在使用`require("MyModule")`并且一切正常。（luaopen_* 是入口点）

但我需要使用标准方式（DllMain 作为入口点）。我试过了，但没有用。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:00:46.890

> 但我需要使用标准方式（DllMain 作为入口点）。我试过了，但没有用。有什么想法吗？

DllMain 将始终是您的入口点（如果已定义），但您不能使用它来加载您的函数，因为*您没有 Lua 状态可以将它们加载到那里*。

当您在 Lua 代码中运行“require”时，执行该代码的应用程序（例如 lua.exe）将加载您的 DLL（调用 DllMain），然后在执行 require 语句`luaopen_MyModule` *的 Lua 状态中调用传递。*您的 DllMain 无法访问该状态指针...

* * *

……嗯，不*一般*的方式。您*可以*解决一些问题，以便主机应用程序在加载 DLL*之前将 Lua 状态的内存位置写入您的 DLL 可访问的某个外部位置（注册表、文件等）。*您的 DLLMain 可以获取指针寄存器并将其功能置于该状态。不知道你为什么要这样做，但在像 C 这样的语言中，这在技术上是可行的。

这将要求您编写主机，因此您可以安排在某处写入状态。或者你可以有一个单独的模块，以普通方式加载，写入 Lua_state 值，然后所有其他模块可以从它们的 DllMains 访问它。

* * *

这闻起来很像[XY 问题](http://www.perlmonks.org/?node_id=542341)。愿意分享您*为什么*要在 DllMain 中注册您的函数吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:31:40.037

尝试这个...

而不是使用名称 MyModule`require("MyModule")`并`luaopen_MyModule`使用注入 DLL 的可执行文件的名称。如果这不起作用，请将 require 调用更改为`.exe`最后。

Lua 的 require 是调用 Win32 LoadLibrary 然后 GetProcAddress 来找到 luaopen 函数。两个调用都将使用 require() 的参数。看起来 PE-inject 使注入的 DLL 中的所有函数看起来就像它们在 EXE 模块中一样。因此，您需要 LoadLibrary 将句柄返回给 EXE 模块，然后 GetProcAddress 将找到注入的 luaopen 函数。

这可能不起作用的几个原因。一是Lua的require确实有DLL文件名和DLL模块名匹配的要求。这不是 Win32 要求，因此您的可移植可执行文件可能并非如此。

# database - 自然连接的关联性

> ID：15844911
> 
> 赞同：1
> 
> 时间：2013-04-05T22:52:13.353
> 
> 标签：database, relational-database, relational-algebra, natural-join

我想知道关系代数中的自然连接操作是否是关联的。我的意思是，下面的等式是真的吗？

```
(S1 NATURAL JOIN S2) NATURAL JOIN S3 = S1 NATURAL JOIN (S2 NATURAL JOIN S3) 
```

直觉上它看起来与我相关，但我不确定。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:56:53.917

`inner join`仅返回符合`on`条件的行。它对右手或左手桌子都没有特殊处理。所以 an`inner join`是关联的。

A`natural join`是`inner join`所有具有相同名称的列上的一个。因为 an`inner join`是关联的，所以 a 也是`natural join`。

# javascript - javascript同时将两个数组的元素压入一个数组

> ID：15844913
> 
> 赞同：1
> 
> 时间：2013-04-05T22:52:23.870
> 
> 标签：javascript, arrays, push

我试图找到一个同时从两个数组输入数据并将它们放入一个数组的javascript代码。我认为这会起作用，但仔细看，它并不能完全发挥作用。

```
var tempDeck = [];
var array1 = ["one", "two"];
var array2 = ["three", "four"];
for (i = 0; i < array1.length + array2.length; i++){
  if (i % 2 == 0){
    tempdeck.push(array1[i]);
  }else{
    tempdeck.push(array2[i]);
  }
} 
```

我需要它来输出结果

```
tempdeck[0] = "one";
tempdeck[1] = "three";
tempdeck[2] = "two";
tempdeck[3] = "four"; 
```

我试图避免手动放置它们，因为数字或数组是基于用户输入的。：（ 有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:56:46.163

**[jsFiddle](http://jsfiddle.net/BaKJt/)**

您应该只使用较大数组的长度，并且仅在索引处存在值时才添加`i`。

```
var tempDeck = [];
var array1 = ["one", "two"];
var array2 = ["three", "four"];
var len = array1.length > array2.length ? array1.length : array2.length;
for (i = 0; i < len; i++){
  if( array1.length > i )tempDeck.push(array1[i]);
  if( array2.length > i )tempDeck.push(array2[i]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:57:35.990

[http://underscorejs.org/#union](http://underscorejs.org/#union)

union_.union(*arrays) 计算传入数组的并集：按顺序排列在一个或多个数组中的唯一项的列表。

_.union([1, 2, 3], [101, 2, 1, 10], [2, 1]); => [1, 2, 3, 101, 10]

# c# - HttpGetRequestStream 的发布调用限制

> ID：15844917
> 
> 赞同：0
> 
> 时间：2013-04-05T22:53:07.587
> 
> 标签：c#, http, post, httpwebrequest

我试图弄清楚对“GetRequestStream”的调用是否有限制。

为了测试这一点，我创建了一个负载测试，其中包含 10 个代理和 1 个控制器，所有这些都试图进行 post call（对象大小 10kb）和 10 个用户计数。（下面的代码）。我没有调用“GetResponse()”来查看是否可以对 GetRequestStream 进行大量调用。

但实际发生的情况是，即使使用所有这些代理，负载测试也没有超过每秒 85 到 90 个请求，而争论点是代码“使用 (Stream requestStream = request.GetRequestStream())”中的这一行。

我将代理减少到 2 个，但结果相同。端点服务器是一个单一的服务器盒。当我使用 VIP（由后端的 3 台服务器支持）时，我得到了 3 倍的输出，即能够达到 270 RPS。当我针对 VIP 再次将代理增加到 15 时，平均值仍然保持不变。所以我得出结论，在调用 GetRequestStream 期间使用了一些共享资源

基于较早的 SO 帖子[HttpWebRequest.GetRequestStream ：它的作用是什么？](https://stackoverflow.com/questions/5325801/httpwebrequest-getrequeststream-what-it-does)

它提到对 GetRequestStream 的调用实际上阻塞了服务器端的一些资源，并且无论生成的 post 调用的数量如何，它都只能服务这么多的请求。我曾经相信 GetRequestStream 不会进行任何调用，而只是获取一个流并将对象写入流中，当我们调用 GetResponse() 时会发生调用

```
HttpWebRequest request =
   (HttpWebRequest)HttpWebRequest.Create("http://some.existing.url");

request.Method = "POST";
request.ContentType = "text/xml";

Byte[] documentBytes = GetDocumentBytes ();

using (Stream requestStream = request.GetRequestStream())
{
   requestStream.Write(documentBytes, 0, documentBytes.Length);
   requestStream.Flush();
   requestStream.Close();
} 
```

如果有人可以向我指出一些资源，我可以在其中挖掘更多关于此的细节，或者如果有人可以解释这种行为，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:18:17.180

根据 http 1.1 RFC，HttpWebRequest 具有从客户端到主机的默认连接限制为两个 - 这可能会导致延迟下降超过两个并发用户。可以通过客户端进程的app.config来改变，见[这里](https://stackoverflow.com/questions/866350/how-can-i-programmatically-remove-the-2-connection-limit-in-webclient)和[这里](http://msdn.microsoft.com/en-us/library/1tkaca2y.aspx)。

# r - 使用ggplot2的累积图

> ID：15844919
> 
> 赞同：15
> 
> 时间：2013-04-05T22:53:13.500
> 
> 标签：r, ggplot2, cumulative-sum

我正在学习使用`ggplot2`并正在寻找`ggplot2`能够重现以下结果的最小代码`base::plot`。我已经尝试了一些东西，但它们最终都非常长，所以我正在寻找最小的表达式，并且*理想情况下希望在 x 轴上有日期*（`plot`下面没有）。

```
df = data.frame(date = c(20121201, 20121220, 20130101, 20130115, 20130201),
                val  = c(10, 5, 8, 20, 4))
plot(cumsum(rowsum(df$val, df$date)), type = "l") 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-05T22:54:25.580

试试这个：

```
ggplot(df, aes(x=1:5, y=cumsum(val))) + geom_line() + geom_point() 
```

![在此处输入图像描述](https://i.stack.imgur.com/P4GkR.png)

`geom_point()`如果您不想要它，只需删除它。

**编辑：**由于您需要使用 x 标签来绘制数据是日期，因此您可以绘制`x=1:5`并使用`scale_x_discrete`来设置`labels`新的`data.frame`. 服用`df`：

```
ggplot(data = df, aes(x = 1:5, y = cumsum(val))) + geom_line() + 
        geom_point() + theme(axis.text.x = element_text(angle=90, hjust = 1)) + 
        scale_x_discrete(labels = df$date) + xlab("Date") 
```

![在此处输入图像描述](https://i.stack.imgur.com/wfSBJ.png)

既然您说`val`“日期”将超过 1 个，您可以首先使用 聚合它们`plyr`，例如。

```
require(plyr)
dd <- ddply(df, .(date), summarise, val = sum(val)) 
```

然后，您可以通过替换为来继续执行相同的`x = 1:5`命令`x = seq_len(nrow(dd))`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-06-07T19:32:57.173

几年后，我决定做：

```
ggplot(df, aes(as.Date(as.character(date), '%Y%m%d'), cumsum(val))) + geom_line() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-28T10:00:58.343

[Jan Boyer](https://stackoverflow.com/users/8239069/jan-boyer)似乎在这个问题中找到了一个更简洁的解决方案[，](https://stackoverflow.com/questions/32090073/geom-bar-geom-line-with-different-y-axis-scale)我已经缩短了一点，并结合了[Prradep](https://stackoverflow.com/users/4836511/prradep)的答案，以便提供（希望）最新的答案：

```
ggplot(data = df, 
   aes(x=date)) +
geom_col(aes(y=value)) +
geom_line(aes(x = date, y = cumsum((value))/5, group = 1), inherit.aes = FALSE) +
ylab("Value") + 
theme(axis.text.x = element_text(angle=90, hjust = 1)) 
```

请注意，`date`它不是日期格式，而是`character`, 并且`value`已经按照[Prradep](https://stackoverflow.com/users/4836511/prradep)在上面的回答中的建议进行了分组。

# ajax - ajax 每 3 秒调用一次时的浏览器含义

> ID：15844920
> 
> 赞同：0
> 
> 时间：2013-04-05T22:53:20.813
> 
> 标签：ajax, jquery, firefox

我们希望每 3 秒检查一次数据库中是否有任何更新，使用 jquery $.ajax。技术很清楚，但有什么理由不触发这么多 ajax 调用？（浏览器、缓存、性能等）。Web 应用程序每天在每个客户端上运行大约 10 小时。我们正在使用火狐。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:03:16.610

Ajax 调用的含义不是在客户端（浏览器，...），而是在服务器端。例如，每个 ajax 调用都会在服务器上命中。IE。更多的带宽消耗，没有服务器请求命中增加，这反过来又增加了服务器负载等。Ajax 调用实际上是为了以服务器端影响为代价来增加客户端友好性。

问候，拉维

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T23:14:31.947

在实现无限重复 AJAX 调用之前，您应该仔细考虑，它们之间存在任意延迟。你是怎么想出3秒的？如果您打算以这种方式轮询服务器，则需要将请求频率降低到尽可能低的数量。以下是一些需要考虑的事情：

*   你获取的数据真的会经常改变吗？
*   你的服务器能否每 3 秒处理一次请求，单个请求的操作需要多长时间？
*   您能否增加不活动后的延迟或根据先前的服务器响应猜测下一次延迟应该多长时间？
*   您能否在[窗口失去焦点](https://stackoverflow.com/questions/2720658/how-to-detect-when-a-tab-is-focused-or-not-in-chrome-with-javascript/6184276#6184276)时完全停止轮询，并在它再次处于前台时重新启动它。
*   如果用户在网站上打开同一页面 10 次，您的服务器应识别并限制其响应，使用其中具有唯一值的 cookie（推荐）或基于客户端 IP 地址。

最重要的是，考虑使用 HTML 5 [Web 套接字](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)将数据“推送”到客户端，而不是轮询——大多数现代浏览器都支持这一点。如果 Web 套接字不可用，可以使用几个框架来回退到轮询 - 一个出色的 .NET 示例是[SignalR](http://signalr.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T11:55:17.207

您正在寻找每 3 秒后的任何更改，这样，当您在短时间内连续获取数据时，流量会增加。它还可能不断增加浏览器端的内存使用量。由于您需要检查数据库中的任何更新，您可以选择其他任何替代方案，例如 Sheepjax、Comet 或 SignalR。（SignalR 通常将数据广播给所有用户，彗星需要许可证）。希望这可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T23:09:36.910

我看到很多应用程序每 5 秒左右发出一次请求，例如遥控器（网络播放器）或聊天。所以这对浏览器来说应该不是问题。

一个好的做法是在发出新请求之前等待答案，这意味着例如不使用 setInterval 触发请求。（如果用户失去连接，会阻止打开太多连接）。还要验证与答案相关的所有计算是否在收到下一个答案时完成。

如果您可以在服务器端访问它，请将您的服务器配置为设置 http 标头 Connection: Keep-Alive，这样您就不会为每个请求增加太多 TCP 开销。这可以大大加快小请求。

我看到的最后一点当然是验证您的服务器是否能够回答这么多请求。

# google-visualization - 谷歌图表 - 日期和网格线

> ID：15844923
> 
> 赞同：1
> 
> 时间：2013-04-05T22:53:31.100
> 
> 标签：google-visualization

这个奇怪的事情似乎让我在水平线上只看到了 4 条网格线。有人可以帮忙吗？

```
<html>
  <head>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();
  data.addColumn('date', 'Date');
  data.addColumn('number', 'Now');
  data.addColumn('number', 'Comparison');
  data.addRows([
    [new Date(2008, 1 ,1),  1264,      1477],
          [new Date(2008, 1 ,2),  1499,      1406],
          [new Date(2008, 1 ,3),  1322,       1105],
          [new Date(2008, 1 ,4),  1147,      1154],
          [new Date(2008, 1 ,5),  1309,      1227],
          [new Date(2008, 1 ,6),  1251,      1298],
          [new Date(2008, 1 ,7),  1238,      1264],
          [new Date(2008, 1 ,8),  1264,      1477],
          [new Date(2008, 1 ,9),  1499,      1406],
          [new Date(2008, 1 ,10),  1322,       1105],
          [new Date(2008, 1 ,11),  1147,      1154],
          [new Date(2008, 1 ,12),  1309,      1227],
          [new Date(2008, 1 ,13),  1251,      1298],
          [new Date(2008, 1 ,14),  1238,      1264],
          [new Date(2008, 1 ,15),  1789,      1256],
          [new Date(2008, 1 ,16),  1789,      1078],
          [new Date(2008, 1 ,17),  1965,      975],
          [new Date(2008, 1 ,18),  1654,      896],
          [new Date(2008, 1 ,19),  1478,      789],
          [new Date(2008, 1 ,20),  1278,      989],
          [new Date(2008, 1 ,21),  1078,      1009],
          [new Date(2008, 1 ,22),  1698,      1109],
          [new Date(2008, 1 ,23),  1398,      1209],
          [new Date(2008, 1 ,24),  1298,      1509],
          [new Date(2008, 1 ,25),  1298,      1009],
          [new Date(2008, 1 ,26),  1198,      1209],
        ]);
        var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data);
      }
    </script>
  </head>
  <body>
    <div id="chart_div" style="width: 2000px; height: 1000px;"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T00:42:43.143

图表的默认行为是使用 5 条网格线。请参阅下[的文档](https://developers.google.com/chart/interactive/docs/gallery/linechart#Configuration_Options)`hAxis.gridlines.count`。

如果要增加网格线的数量，请在图表中设置选项。例如：

```
chart.draw(data, {vAxis: {gridlines: {count: 100}}}) 
```

这是一个带有一大堆网格线的示例（来自添加了上述选项的 Google Playground）：

```
function drawVisualization() {
  // Create and populate the data table.
  var data = google.visualization.arrayToDataTable([
    ['x', 'Cats', 'Blanket 1', 'Blanket 2'],
    ['A',   1,       1,           0.5],
    ['B',   2,       0.5,         1],
    ['C',   4,       1,           0.5],
    ['D',   8,       0.5,         1],
    ['E',   7,       1,           0.5],
    ['F',   7,       0.5,         1],
    ['G',   8,       1,           0.5],
    ['H',   4,       0.5,         1],
    ['I',   2,       1,           0.5],
    ['J',   3.5,     0.5,         1],
    ['K',   3,       1,           0.5],
    ['L',   3.5,     0.5,         1],
    ['M',   1,       1,           0.5],
    ['N',   1,       0.5,         1]
  ]);

  // Create and draw the visualization.
  new google.visualization.LineChart(document.getElementById('visualization')).
      draw(data, {curveType: "function",
                  width: 500, height: 400,
                  vAxis: {maxValue: 10, gridlines: {count: 100}}
                 }
          );
} 
```

由于您没有指定期望的网格线数量，请编辑以上内容以满足您的需要。

# php - Web 服务用户之间的加密

> ID：15844927
> 
> 赞同：2
> 
> 时间：2013-04-05T22:53:46.350
> 
> 标签：php, passwords, rsa, encryption

我有一个网络服务（类似于在线商店），用户可以在其中保存他们的数据。我需要加密该数据，以便只有管理员和用户自己才能读取该数据。

每个经理和用户都有自己的密码存储在数据库中。

首先，我考虑过使用 RSA（公钥/私钥），但我不知道如何使用管理员和用户的不同密码访问加密数据。

顺便说一句：我可以提示用户和管理员每次尝试访问加密数据时输入他的密码（与数据库中的散列密码比较并解密安全数据）。

请帮助并原谅我糟糕的英语。提前致谢！

编辑：最简单的方法是使用硬编码的主密码进行加密/解密，但我认为这是非常非常不安全的。

EDIT2：好的，我想我知道了： 1\. 生成唯一密钥 2\. 使用对称加密使用来自 (1) 的唯一密钥加密数据 3\. 使用用户密码加密来自 (1) 的唯一密钥并将其与用户的凭据一起存储4\. 使用管理员密码加密来自 (1) 的唯一密钥，并将其与管理员凭据一起存储

现在当经理想要访问数据时，我提示他输入密码，然后从 (4) 解密哈希，从 (1) 获取唯一密钥并解密安全数据。来自用户的解密是一样的：(3)->(1)->data

所以现在的问题是让这个可供多个用户使用-> user_data/managers，哈哈

EDIT3：忘了提：用户创建一次数据，然后经理将其用于内部使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T22:56:43.040

如果您不介意每次用户需要访问数据时都提示输入密码，您可以考虑使用[mcrypt](http://php.net/manual/en/ref.mcrypt.php) php 模块。不过，请务必在实施任何事情之前进行研究。如果您不小心，它很容易不安全地使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:52:32.027

我相信您应该使用经过标准验证的技术。听起来我的方式应该是 SSL 连接和安全的服务器。我相信您绝对不需要加密数据，而只需为其所有者或通过某些权限层次结构（通过 Web 服务安全逻辑）提供访问权限。如果您需要保护数据免受磁盘被盗，请使用操作系统的加密分区。

# java - 使用 OAuth 的 Google App Engine 身份验证

> ID：15844928
> 
> 赞同：2
> 
> 时间：2013-04-05T22:53:54.360
> 
> 标签：java, android, google-app-engine, authentication, oauth-2.0

那里有很多论坛和示例，但所有这些都已过时或无法理解。

我知道要验证对 AppEngine 的请求，我需要使用 AccountManager 登录到谷歌帐户，使用 GoogleAuthUtil.getToken 获取令牌，获取 AuthCookie，然后使用我的令牌在 AppEngine 上做任何我想做的事情。

现在，最后两部分是我不明白的部分：

1.  什么是 AuthCookie？每次发布都需要买一个新的吗？从 AppEngine 请求经过身份验证的请求是临时的“权限”吗？我收到的第一个令牌是永久令牌还是每次发布我也应该获得一个新令牌？

2.  我当前的请求是“endpoint.list().execute()”。身份验证在哪里？我见过很多奇怪的 HTTP 请求示例，但没有一个使用 AppEngine 端点。

如果它太基本了，我很抱歉，但我真的刚刚开始使用 AppEngine，我找不到任何关于它从头到尾如何工作的明确解释。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T15:09:32.573

由于您使用的是 Endpoints，您读过这个吗？

[https://developers.google.com/appengine/docs/java/endpoints/consume_android#making-authenticated-calls](https://developers.google.com/appengine/docs/java/endpoints/consume_android#making-authenticated-calls)

它是最新的，我认为它相当清楚（它包括一个样本）。

我相信 OATH 的本质是你需要为每个会话获取一个新的令牌。

# machine-learning - XOR 递归神经网络的顺序训练数据

> ID：15844932
> 
> 赞同：1
> 
> 时间：2013-04-05T22:54:14.203
> 
> 标签：machine-learning, artificial-intelligence, neural-network

我正在尝试实现一个循环神经网络，并试图让它学习一个 XOR 函数作为一个小例子。

由于它是一个循环网络，我认为让它只与一个输入单元一起工作可能会很好，以便了解它在记住以前的状态时的表现如何；即基于顺序输入实现异或函数：

```
INPUT(t-1) = 0
INPUT(t)   = 1
OUTPUT(t)  = 1 
```

或者

```
INPUT(t-1) = 1
INPUT(t)   = 1
OUTPUT(t)  = 0 
```

因此，我的输入训练数据按以下顺序一次显示一个：

```
inputs = { 0, 0, 1, 1, 0 } 
```

以及对应的目标输出

```
targets = { 0, 0, 1, 0, 1 }. 
```

但这不是学习，尽管我知道可能有很多原因，但我想知道也许我没有正确定义我的数据集，因此我不会向我的网络提出正确的问题。然后我来这里寻找关于什么可能是正确的训练集的想法，以对“顺序”XOR 函数进行监督学习。

我正在处理的实现类似于 Elman RNN，如果您需要任何详细信息，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T14:15:10.903

以下链接：[https ://code.google.com/p/encog-java/source/browse/trunk/encog-examples/src/org/encog/examples/neural/recurrent/elman/ElmanXOR.java?r= 2423](https://code.google.com/p/encog-java/source/browse/trunk/encog-examples/src/org/encog/examples/neural/recurrent/elman/ElmanXOR.java?r=2423)

包含一个适用于 XOR 问题的循环 Elman 网络实现。它使用Encog（相对容易使用）来处理网络本身的实现。希望您能够看到您的实施中的差异并纠正。

# fortran - 在高性能 FORTRAN 代码中实现查找的智能方法

> ID：15844935
> 
> 赞同：1
> 
> 时间：2013-04-05T22:54:19.157
> 
> 标签：fortran, lookup-tables, fortran77

我正在用 FORTRAN 77 编写一个模拟，其中我需要从一些实验数据中获取一个参数值。数据来自互联网数据库，所以我提前下载了它，但是没有简单的数学模型可以用来提供连续尺度的值——我只有离散的数据点。但是，对于 x 轴上的任何值，我都需要知道这个参数，而不仅仅是我从数据库中获得的离散值。

为简化起见，您可以说我知道 的`f(x)`所有整数值的值`x`，并且需要一种方法来找到`f(x)`任何实际`x`值（永远不会超出我所知道的最小或最大`x`）。

我的想法是获取数据并进行线性插值，以便能够获取参数值；在伪代码中：

```
double xd = largest_data_x_lower_than(x)

double slope = (f(xd+dx)-f(xd))/dx // dx is the distance between two x values
double xtra = x-xd

double fofx = f(xd)+slope*xtra 
```

为了实现这一点，我需要对数据点进行某种查找。我可以`xd`通过从数据库中获取所有整数的值来轻松查找`x`，这样`xd = int(x)`和`dx = 1`，但我仍然不知道如何实现查找`f(xd)`。

**什么是实现这一点的好方法？**

在一次模拟运行期间，该值将被获取 10^7 到 10^9 次，因此性能至关重要。换句话说，每次我需要一个值时都从 IO 读取`f(xd)`不是一种选择。

我目前有一个文本文件中的数据点，每行有一对（制表符分隔）`x,f(x)`，所以对于一个解决方案的奖励点，它还提供了一种将数据从那里获取到任何需要的形状的平滑方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T01:06:22.423

你说你有所有整数的值。你有从to`i, f(i)`的所有整数的对吗？然后将值读入一个维度为 的数组。除非值的数量是巨大的。对于 和 之间的实数值，很容易在数组中建立索引并在最近的一对数值之间进行插值。 `i``M``N``f(i)``y``M:N``M``N`

为什么要使用 FORTRAN 77？Fortran 90/95/2003 已经使用我们多年了...

编辑：在评论中回答问题，重新如何在 FORTRAN 77 中只读取一次数据值，而不必在长链调用中将它们作为参数传递。技巧 1：在程序启动时，将它们读入数组，该数组位于一个命名的公共块中。技巧 2：第一次调用返回的函数时，将`f(x)`值读入同样位于`SAVE`语句中的局部变量。使用已保存的逻辑来指定函数是否在其第一次调用中。一般来说，我更喜欢技术 2，因为它更“本地”，但它不是线程安全的。如果您正在并行进行模拟，则第一种技术可以在程序进入多线程之前的启动阶段完成。

下面是一个使用示例`SAVE`：[fortran SAVE 语句](https://stackoverflow.com/questions/2893097/fortran-save-statement)。（在 Fortran 95 表示法中......转换为 FORTRAN 77）。将读取的数据放入`IF`块中的数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T22:59:35.977

您可能想要一种插入或拟合数据的方法，但您需要更具体地了解数据的维度、数据的行为方式、访问数据的方式（例如，也许您的下一个请求总是靠近最后一个），网格的制作方式（均匀分布，随机或其他方式），以及您需要数据的位置才能知道哪种方法最适合您。

但是，如果现有数据集非常密集且接近线性，那么您当然可以进行线性插值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T18:41:18.113

`fvals`使用您的数据库（文件），您可以创建一个带有`fvals(ii)`函数的数组`f(xmin + (ii-1) * dx)`。x 值`xx`和数组索引之间的映射是`ii = floor((xx - xmin) / dx) + 1`. 一旦你知道`ii`了，你就可以使用它周围的点进行插值：使用`ii`和`ii+1`或一些更高阶的多项式插值进行线性插值。[对于后者，您可以使用来自Numerical Recipes](http://apps.nrbook.com/fortran/index.html)的相应 polint 例程。请参见第 103 页。

# opengl - 使用 glUniformMatrix 将数组发送到着色器

> ID：15844939
> 
> 赞同：1
> 
> 时间：2013-04-05T22:54:37.257
> 
> 标签：opengl, glsl, vertex-shader

我有一个模型，其中所有`matdex`s （读取矩阵索引）都是 0、1 和 2 大致均匀分布。 `bonebends[matdex[whichvertex]]`告诉我们应该在这个顶点上使用哪个矩阵。
初始化，C++：

```
std::vector< GLint >  matdex; //initialized to 0, 1, or 2 for each vertex loaded, not shown for brevity
std::vector<glm::mat4> bonebends;
int frames=0;
bonebends.push_back(glm::mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)); //identity matrices initially
bonebends.push_back(glm::mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1));
bonebends.push_back(glm::mat4(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)); // thats 3 bones
ver_ind = glGetAttribLocation(shaderID, "VER_IND");
boneID = glGetUniformLocation(shaderID, "BONE_MATRIX[0]");
glGenBuffers(1, &ind_buff);
glBindBuffer(GL_ARRAY_BUFFER, ind_buff);
glBufferData(GL_ARRAY_BUFFER, matdex.size() * sizeof(GLint), &matdex[0], GL_STATIC_DRAW); 
```

定期在主循环中，c ++：

```
glEnableVertexAttribArray(3); //IND
glBindBuffer(GL_ARRAY_BUFFER, ind_buff);
glVertexAttribPointer( ver_ind, 1, GL_INT, GL_FALSE, 0, (void*)0 );
//ALSO LOOK HERE
glUniformMatrix4fv(boneID, 3 , GL_FALSE, &bonebends[0][0][0]);
frames+=1;
float cs=cos(3.14*2.0*(frames/100.0));
float sn=sin(3.14*2.0*(frames/100.0));
//  LOOK HERE
bonebends[0]=glm::mat4(
cs ,  0,-sn,0  ,
0 ,  1,  0,0  ,
sn,  0, cs,0  ,
0 ,  0,  0,1  ); 
```

在着色器中，glsl：

```
layout(location = 3) in int VER_IND;
uniform mat4 BONE_MATRIX[3]; 
```

在着色器的主要功能中，glsl：

```
gl_Position =  BONE_MATRIX[VER_IND] * vec4(VER_POS,1); //VER_POS is the vertex's coordinates 
```

我希望这会使所有重合`matdex`为 0 的顶点旋转，其余的保持静止。相反，这会显示模型（否则会正确渲染）旋转，好像所有`matdex`s 值都等于 0。一点点`cout`告诉我它们不是。我不知道如何`VER_IND`在着色器中调试。
我试过

*   使用`uint`而不是 的`int`所有化身`matdex`，这没有任何区别。
*   更改`BONE_MATRIX[VER_IND]`为`BONE_MATRIX[0]`in shader，导致崩溃（？？？）
*   以各种方式更改的第二个和第四个参数`glUniformMatrix4fv(boneID, 3 , GL_FALSE, &bonebends[0][0][0]);`没有帮助。
*   更改了`matdex`s 值，使得它们都不为 0，并且它仍然旋转，就好像着色器仅使用`BONE_MATRIX[0]`.
*   将下面的行更改`// LOOK HERE`为`bonebends[1]=glm::mat4(`导致模型根本不旋转。

由此我得出结论，它只使用了第一个`BONE_MATRIX[3]`，可能是因为着色器没有正确接收它。我可以发布整个内容，但它有点冗长。
我想知道我做错了什么以及如何从着色器中获取信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T01:26:38.440

有很多问题。

首先，`matdex`是*空*的。所以你没有得到任何实际信息。

第二，

```
layout(location = 3) in int VER_IND;

glVertexAttribPointer( ver_ind, 1, GL_INT, GL_FALSE, 0, (void*)0 ); 
```

这两件事*不能*一起工作。`glVertexAttribPointer`只能提供浮点输入。如果您使用整数格式`GL_INT`，[它们将被转换为浮点数](http://www.opengl.org/wiki/Vertex_Specification#Component_type)。如果要提供整数输入，`glVertexAttribIPointer`则必须使用（注意`I`）。

或者只是做`VER_IND`一个浮动。并通过`GLubyte`s 而不是`GLint`s。真的，占用所有的记忆是没有意义的。

第三：

```
glEnableVertexAttribArray(3); //IND
glVertexAttribPointer( ver_ind, 1, GL_INT, GL_FALSE, 0, (void*)0 ); 
```

这两个函数的第一个参数应该是*相同的*，如果你想启用`ver_ind`.

第四：

```
//ALSO LOOK HERE
glUniformMatrix4fv(boneID, 3 , GL_FALSE, &bonebends[0][0][0]); 
```

我看不到您`glUseProgram`用来设置要更改统一数据的程序的位置。

第五：

```
//  LOOK HERE
bonebends[0]=glm::mat4( 
```

*上传后*更改值不会神奇地导致上传的值更改。

可能存在（并且可能存在）更多问题，但您发布的代码不完整，我不打算成为您的个人调试器。至少，从你*知道*有效的代码开始，然后做出最小的改变来实现你想要的。让它工作，然后再做一次改变。等等。你一次做了很多事情，但没有成功。

# sql - 三张表中的两个计数

> ID：15844941
> 
> 赞同：0
> 
> 时间：2013-04-05T22:54:53.207
> 
> 标签：sql, sql-server

我正在尝试使用以下查询计算两列：

```
select distinct [District], 
  count (Distinct [Student Identifier Statewide California]) 
         as '11-12 Enrollment',
  (select count (Distinct IncdtKey) 
From [dbo].[DisciplineStudentFile1112]
where GrdLvLKey in ('15', '01', '02', '03', '04', 
                        '05', '06', '07', '08', '09', 
                        '10', '11', '12', '18', '19')) as Total_Incidents
From 
  dbo.SSID1112StudentEnrollmentRecords with (nolock)
inner join 
  [dbo].[SchoolDetail] on CDSCode = dbo.SSID1112StudentEnrollmentRecords.CDSOrig
where  
  [EnrollStatCodeOrig] like '10'
and 
  [Grade Level Code] in ('PS', 'KN', '01', '02', '03', 
                         '04', '05', '06', '07', '08', 
                         '09', '10', '11', '12', 'UE', 'US')
group by [District]
order by [District] 
```

我的结果是：

```
District      11-12 Enrollment  Total_Incidents
AB Unified          20662                896371
CE Unified          5387                 896371
DR Unified          526                  896371
FJ Unified          1506                 896371
KT Unified          8415                 896371 
```

我不知道如何获得`Total_Incidents`列中的单个计数而不是总计数 896371？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:16:58.987

一种简单的方法是将子查询与外部查询相关联：

```
select distinct SD.District,
  count ( distinct SER.[Student Identifier Statewide California] ) as [11-12 Enrollment],
  ( select count( distinct DSF.IncdtKey ) from dbo.DisciplineStudentFile1112 as DSF
    where DSF.GrdLvLKey in ( '15', '01', '02', '03', '04', '05', '06', '07', '08', '09', 
      '10', '11', '12', '18', '19' ) and -- Note additional condition here.
      DSF.District = SD.District ) as Total_Incidents
from dbo.SSID1112StudentEnrollmentRecords as SER with (nolock) inner join 
  dbo.SchoolDetail as SD on SD.CDSCode = SER.CDSOrig
where SER.EnrollStatCodeOrig like '10' and 
  [Grade Level Code] in ( 'PS', 'KN', '01', '02', '03', '04', '05', '06', '07', '08', 
  '09', '10', '11', '12', 'UE', 'US' )
group by SD.District
order by SD.District 
```

我对表模式做了一些假设。我建议在使用连接时为每个表提供一个别名，并在每个引用上使用别名以避免混淆。

另一种解决方案是使用另一个连接，`DisciplineStudentFile1112`然后使用`GROUP BY`.

# python - Python furl 库 - 有没有办法在没有 url 编码的情况下向 url 添加参数？

> ID：15844944
> 
> 赞同：5
> 
> 时间：2013-04-05T22:55:18.773
> 
> 标签：python

我有一个 url，我需要添加一个 api 密钥作为参数。密钥中有 % 和其他字符，不应该是 url 编码，有没有办法用[furl](https://github.com/gruns/furl)做到这一点？

这是我当前的代码：

```
request_url = furl('http://www.domain.com/service/') \
    .add({
    'format'     : 'json',
    'location'      : address_line_1 + ',' + city + ',' + state,
    'key'           : APP_KEY
}).url 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T00:27:36.193

> 我有一个 url，我需要添加一个 api 密钥作为参数。密钥中包含 % 和其他字符，不应进行 url 编码

那不可能是真的。它*必须*是 URL 编码的。否则，您最终会得到一个无效的 URL，或者一个不代表您想要的 URL。

例如，假设键是`123%456%789`. 如果您发送`http://www.domain.com/service/?format=json&key=123%25456%25789`，则另一端的Web服务将获得`123%456%789`，这将成功。如果你只是 send `http://www.domain.com/service/?format=json&key=123%456%789`，另一端的 web 服务会 get `123E6x9`，这会失败。

所以，你的例子已经是正确的，你不需要做任何事情。

如果出于某种原因，您在`APP_KEY`到达这里之前已经进行了 URL 编码……好吧，不要。使用这样的名称，我猜它是一个常量文字，只是复制并粘贴到您的模块中，这意味着您必须手动对其进行 URL 编码并复制并粘贴结果。只是不要那样做，你很好。

如果你得到了`APP_KEY`URL 编码的形式，你总是可以用例如 ，`urlparse.parse_qs`甚至用来解码它`furl`。

但如果这一切似乎都不合理……</p>

> 有没有办法用 furl 做到这一点？

否。请参阅文档的[编码](https://github.com/gruns/furl/blob/master/API.md#encoding)部分。`furl`仅适用于*解码*的查询字符串名称和值。

但是有一个简单的方法可以解决这个问题。URL 并没有那么复杂，`furl`它专门设计用于允许您混合和匹配手动和编程创建的位。[自述文件](https://github.com/gruns/furl)中的大多数示例都准确地表明了这一点，例如`furl('http://www.google.com/?one=1').add({'two':2}).url`. 因此，如果您已经`"key=123%25456%25789"`从某个地方获得了预编码，只需手动将其粘贴在字符串上，然后再将其提供给`furl`：

```
request_url = furl('http://www.domain.com/service/?key={}'.format(APP_KEY)) \
    .add({
    'format'     : 'json',
    'location'      : address_line_1 + ',' + city + ',' + state,
}).url 
```

哈基？好吧，是的，因为您正在回避`furl`的编码，但这正是您要问的问题。

# android - Android 4.2 引入了内核默认启用的 SELinux

> ID：15844945
> 
> 赞同：1
> 
> 时间：2013-04-05T22:55:22.910
> 
> 标签：android, linux, operating-system, selinux

1.  正如我正确理解的那样，Android 4.2 引入了内核默认启用的 SELinux。我对吗？反正有没有禁用它？

有一些应用程序可能无法正常工作。

前任。使用 mount 命令系统范围停止工作

1.  反正有禁用它吗？我检查了 VZW Galaxy Nexus - 构建 JDQ39 - 我不确定 Linux 版本是什么 - SELinux 或 Linux。

2.  在安卓设备上使用 SELinux VS Linux 有什么好处。

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-26T15:42:13.810

正确地说，SELinux 在 4.4 中仅针对特定进程启用：“在 Android 4.3 中，SELinux 是完全允许的。在 Android 4.4 中，SELinux 对多个根进程的域强制执行：installd、netd、vold 和 zygote。所有其他进程，包括其他服务和所有应用程序，仍处于允许模式，以允许进一步评估并防止 Android 4.4 中的故障。不过，错误的应用程序可能会触发不允许的根进程中的操作，从而导致进程或应用程序崩溃。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-21T10:20:01.743

SE Android 是基于 SE Linux 构建的 Android。此 SE Android 可以处于以下三种状态之一：Permissive、Enforcing 和 Disabled。

默认情况下，Android 内核可能构建在 SE Linux for 4.2 上，但默认情况下处于 Permissive 模式。从 4.4 开始，它处于强制模式。并且由于它是允许的，因此它与禁用一样好，只是会记录 AVC 日志。

您可以通过 adb 查看 SE Android 的模式。只需在 adb shell 中输入命令 getenforce，您应该会获得上述状态之一。如果状态是 Permissive 或 Disabled，则 SE Android 不是问题的原因。

同样为了在 Linux 上使用 SE Linux 的好处，还有很多。最重要的是除了 DAC 之外的 MAC 的使用。您可以参考[此](http://www.cs.columbia.edu/~lierranli/coms6998-7Spring2014/papers/SEAndroid-NDSS2013.pdf)内容，也可以转到说明使用 SE Android 如何增强 Android 中的安全性并减轻之前发生的许多漏洞的部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T02:30:32.970

可以绕过挂载问题。

诀窍是在设备本身上使用 adb 在本地连接到设备并通过它发出 mount 命令。在 adb 中运行时，您似乎摆脱了阻止 mount 在应用程序中工作的任何监狱。我不认为它与 SELinux 相关，它似乎与多用户安全性有关，并且显然主要存在于 Android api 而不是内核级别（控制台应用程序应该可以正常访问挂载）。

使用 4.2.2 会有点困难，因为您现在需要为 adb 设置密钥。

看看[这里](http://forum.xda-developers.com/showthread.php?t=2003836)，它适用于 Nexus 10，但基本原则应该适用于任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-22T11:36:40.050

如果您已植根您的设备，您可以将其连接到您的计算机并简单地执行

```
adb shell
su
setenforce 0 
```

禁用 SELinux。还有其他方法可以禁用它，其中一些包括将 0 写入某些 /dev/... 或 /sys/... 设备。

在大多数设备上，只有本地安装的 mount 命令不允许您进行任何挂载。通常这可以通过使用busybox来解决。只需安装busybox，或将其推送到本地目录并调用*busybox mount -o remount,rw /system*为例，重新挂载可读写的系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-09T02:03:07.853

不，默认情况下未启用。Android 上确实没有默认启用的功能，每个手机制造商都会在制造新设备时设置配置并进行修改。即使 AOSP 在他们的内核中默认启用它（它没有），制造商也必须在他们的内核中启用它。

SELinux 是具有强制访问控制的 Linux。请阅读 SELinux。

即使是即将附带 SE Android（SELinux + Android 中间件 MAC）的设备（例如 Galaxy S IV）也默认将其设置为许可模式。您需要一个 MDM 客户端将其设置为强制执行。

# ruby-on-rails - MongoDB/Mongoid：搜索匹配数组中第一项的文档

> ID：15844947
> 
> 赞同：2
> 
> 时间：2013-04-05T22:55:49.307
> 
> 标签：ruby-on-rails, mongodb, mongoid, mongoid3

我有一个包含数组的文档：

```
{
    _id: ObjectId("515e10784903724d72000003"),
    association_chain: [
        {
            name: "Product",
            id: ObjectId("4e1e2cdd9a86652647000003")
        }
    ],
    //...
} 
```

我正在尝试在集合中搜索数组中`name`第一项与给定值匹配的文档。`association_chain`

如何使用 Mongoid 做到这一点？或者，如果您只知道如何使用 MongoDB 来完成，如果您发布一个示例，那么我可能会弄清楚如何使用 Mongoid 来完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T22:46:13.343

使用位置运算符。`.0`您可以使用（以及使用`.1`等）查询数组的第一个元素。

```
> db.items.insert({association_chain: [{name: 'foo'}, {name: 'bar'}]})
> db.items.find({"association_chain.0.name": "foo"})
{ "_id" : ObjectId("516348865862b60b7b85d962"), "association_chain" : [ { "name" : "foo" }, { "name" : "bar" } ] } 
```

您可以看到位置运算符有效，因为在`foo`第二个元素中搜索不会返回命中...

```
> db.items.find({"association_chain.1.name": "foo"})
> 
```

...但搜索`bar`确实如此。

```
> db.items.find({"association_chain.1.name": "bar"})
{ "_id" : ObjectId("516348865862b60b7b85d962"), "association_chain" : [ { "name" : "foo" }, { "name" : "bar" } ] } 
```

您甚至可以在不索引所有关联链文档的所有名称的情况下索引此特定字段：

```
> db.items.ensureIndex({"association_chain.0.name": 1})
> db.items.find({"association_chain.0.name": "foo"}).explain()
{
        "cursor" : "BtreeCursor association_chain.0.name_1",
        "nscanned" : 1,
        ...

}
> db.items.find({"association_chain.1.name": "foo"}).explain()
{
        "cursor" : "BasicCursor",
        "nscanned" : 3,
        ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T22:59:47.453

有两种方法可以做到这一点：

1）如果您已经知道您只对出现在“association_chain”中的第一个产品名称感兴趣，那么这样会更好：

```
db.items.find("association_chain.0.name":"something") 
```

请注意，这不会返回所有提及所需产品的项目，而只会返回那些在“association_chain”数组的第一个位置提及的项目。

如果你想这样做，那么你需要一个索引：

```
db.items.ensureIndex({"association_chain.0.name":1},{background:1}) 
```

2）如果您正在寻找特定产品，但不确定它出现在 Association_chain 的哪个位置，请执行以下操作：

使用 MongoDB shell，您可以使用 '.' 访问嵌套结构内的任何哈希键。点运算符！请注意，这与该键在记录中嵌套的深度无关（不是很酷吗？）

您可以像这样对嵌入的哈希数组进行查找：

```
db.items.find("association_chain.name":"something") 
```

这将返回集合中包含关联数组中任何位置提到的所需产品的所有记录。

如果你想这样做，你应该确保你有一个索引：

```
db.items.ensureIndex({"association_chain.name":1},{background: 1}) 
```

请参阅此页面上的“点表示法”：http: [//docs.mongodb.org/manual/core/document/](http://docs.mongodb.org/manual/core/document/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-08T21:46:14.420

您可以使用聚合框架来做到这一点。在 mongo shell 中运行一个展开文档的查询，以便每个数组元素都有一个文档（在其他字段中有重复的数据），然后按 id 和要包含的任何其他字段分组，加上带有运算符 $first 的数组. 然后只需包含 $match 运算符即可按名称或 mongoid 进行过滤。

这是与第一个产品名称匹配的查询：

```
db.foo.aggregate([
{ $unwind:"$association_chain"     
},
{
  $group : {
            "_id" : {
                "_id" : "$_id",
                "other" : "$other"
            },
            "association_chain" : {
                $first : "$association_chain"
            }
        }
},
{  $match:{ "association_chain.name":"Product"}
}

]) 
```

以下是通过 mongoid 查询第一个产品的方法：

```
db.foo.aggregate([
{ $unwind:"$association_chain"     
},
{
   $group : {
            "_id" : {
                "_id" : "$_id",
                "other" : "$other"
            },
            "association_chain" : {
                $first : "$association_chain"
            }
        }
},
{  $match:{ "association_chain.id":ObjectId("4e1e2cdd9a86652647000007")}
}

]) 
```

# mysql - Mysql 在记录中插入波浪号 ~

> ID：15844950
> 
> 赞同：1
> 
> 时间：2013-04-05T22:56:12.793
> 
> 标签：mysql, phpmyadmin

我在尝试将 mysql 中的部分 url 更改为其中包含波浪号的 URL 时遇到了一点问题。

目前我的网站有一个 url `domain.com/admin/`。但是因为我需要使用共享的 ssl 证书，所以我必须在其前面添加一个带有 linux 用户名的波浪号，就像这样`/~crr/admin/`。我是写sql的新手，已经搜索过了，但找不到这个问题。

这是我正在尝试的，那是我遇到字符错误的时候。

```
UPDATE menu_items 
SET menu_links = replace(menu_links, "/admin/", "/~crr/admin/"); 
```

我在没有波浪号的情况下尝试了它并且它有效，所以我很确定它是波浪号引起的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:06:58.017

您可以尝试使用单引号：

```
UPDATE menu_items 
SET    menu_links = replace(menu_links, '/admin/', '/~crr/admin/'); 
```

我不记得 ~ 是 MySQL 中的保留字符。如果上述方法不起作用，请尝试转义 ~ （PHPMyAdmin 使用 ~ 我猜在显示近似数据计数时）

```
UPDATE menu_items 
SET    menu_links = replace(menu_links, '/admin/', '/\~crr/admin/'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:14:09.387

MYSQL 接受 CHR() 吗？也许尝试“/” & CHR(126) & “crr/admin/”

UPDATE menu_items SET menu_links = replace(menu_links, "/admin/", "/" & CHR(126) & "crr/admin/");

# jquery - .fadeToggle() 在第二个循环后停止

> ID：15844958
> 
> 赞同：0
> 
> 时间：2013-04-05T22:57:37.153
> 
> 标签：jquery, transition

我正在尝试编写一个在单击元素后使用淡入淡出转换来显示文本的事件。该代码似乎可以一次性使用，但我希望它是一个切换/取消切换文本的无限循环。在切换一次文本然后切换一次之后，`.fadeToggle()`似乎停止反应，但其他一切似乎都正常。我需要这种方法，因为`.visuallyhidden`它是屏幕阅读器所必需的（以及出于审美目的的淡入淡出过渡）。

```
$(document).ready(function () {

    $('.CEL-clickToggleReaction').addClass('visuallyhidden');
    $('.CEL-clickToggleAction').bind('click', openReaction);

    function openReaction() {
        $(this).parent().parent().find('.CEL-clickToggleReaction').removeClass('visuallyhidden');
        $(this).parent().parent().find('.CEL-clickToggleReaction').hide();
        $(this).parent().parent().find('.CEL-clickToggleReaction').fadeToggle(500);
        $(this).attr('class', 'CEL-clickToggleActionOpen');
        $(this).parent().parent().find('.CEL-clickToggleActionOpen').unbind();
        $(this).parent().parent().find('.CEL-clickToggleActionOpen').bind('click', closeReaction);

    }

    function closeReaction() {
        $(this).parent().parent().find('.CEL-clickToggleReaction').fadeToggle(500);
        $(this).parent().parent().find('.CEL-clickToggleReaction').delay().queue(function (next) {
            $(this).parent().parent().find('.CEL-clickToggleReaction').addClass('visuallyhidden');
            $(this).parent().parent().find('.CEL-clickToggleReaction').show();
        });
        $(this).attr('class', 'CEL-clickToggleAction');
        $(this).parent().parent().find('.CEL-clickToggleAction').unbind();
        $(this).parent().parent().find('.CEL-clickToggleAction').bind('click', openReaction);

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:27:59.003

谢谢您的意见！我发现我遇到的问题是 .queue()。我只是在该函数之后添加 .dequeue() ，它现在可以工作了。

谢谢！！

编辑：我实际上改变了代码的整个工作方式，并将在这里分享。这是（我相信的）一种处理淡入淡出切换的好方法，同时仍然保持内容屏幕阅读器可访问（假设您的代码中有某种视觉隐藏）。

```
$(document).ready(function () {

        $('.CEL-clickToggleReaction').addClass('visuallyhidden').css('opacity', 0);

        $('.CEL-clickToggleAction').click(function(){
            var reaction = $(this).parent().parent().find('.CEL-clickToggleReaction'),
                opacity = reaction.css('opacity');

                if (reaction.hasClass('visuallyhidden')) {

                    reaction.removeClass('visuallyhidden').animate({opacity: (opacity==1?0:1)});

                }

                else {

                    reaction.animate({opacity: (opacity==1?0:1)}).queue(function (next) {

                        reaction.addClass('visuallyhidden').dequeue();

                    });

                }
        });   
}); 
```

# asp.net - 在 ASP.net 中使用 image404 和 azurereader2

> ID：15844960
> 
> 赞同：8
> 
> 时间：2013-04-05T22:58:00.323
> 
> 标签：asp.net, azure, imageresizer

我正在使用以下插件来调整 ASP.net 应用程序 AzureReader2 中的图像大小工作正常 image404 单独工作正常但是当我尝试访问 blob url 时它不会重定向并且它正在给出

```
The remote server returned an error: (404) Not Found. 
```

[http://imageresizing.net/plugins/image404](http://imageresizing.net/plugins/image404)

[http://imageresizing.net/plugins/azurereader2](http://imageresizing.net/plugins/azurereader2)

有人用过 azurereader2 的 image404 吗？它与此兼容吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-14T12:53:26.197

从 3.4.3 版开始，此错误现已修复。

见[http://imageresizing.net/releases/3-4-3](http://imageresizing.net/releases/3-4-3)

# ruby-on-rails - Mongoid：对 has_many 关联的渴望加载计数

> ID：15844962
> 
> 赞同：2
> 
> 时间：2013-04-05T22:58:27.057
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

我是 mongodb 的新手。

我正在尝试列出一些文档，我的班级有一个`has_many`关联，我想显示该关联中的文档数量。

我需要做一些急切的加载吗？

如果我使用`includes`将加载的所有文件，我只想要计数。

身份映射已启用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T06:05:58.403

我不知道如何防止急切加载加载整个文档。我很想知道现在这是否可能。

你可以得到这样的计数：

```
ChildDoc.where(myclass_id: myclass_obj.id).count 
```

因此，您正在查询关联的隐式创建的外键字段。这仍然是每个父文档的查询，但理想的快速查询。

如果性能是您真正关心的问题，您可以编写一个查询，该查询将返回更多数据，但在一次行程中——包含文档的所有 id——如下所示：

```
ChildDoc.where(myclass_id: {"$in" => list_of_myclass_objs.map {|x| x.id}}).only(:id, :myclass_id) 
```

由于您是新手，我要补充一点，您可能想自己在 FK 字段上创建索引—— mongoid 不会为您执行此操作。

```
class ChildDoc
    include Mongoid::Document
    belongs_to :myclass
    index({ myclass_id: 1 })
end 
```

进而

```
rake db:mongoid:create_indexes 
```

# c - 为什么会崩溃？- C

> ID：15844963
> 
> 赞同：-2
> 
> 时间：2013-04-05T22:58:27.363
> 
> 标签：c

我非常接近完成这个，至少我希望如此，因为如果我不这样做，我会发疯的。我已经设法摆脱所有语法和错误以摆脱编译器，我开始它希望我最终会完成然后......它崩溃了......

为了大致了解它的工作原理，假设从“甲板”中打印出五个值 - 然后再次随机打乱打印（以显示打乱）

我是如此接近。我可以尝尝！

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#define SIZE 52

enum faces{Ace = 0, Jack = 10, Queen, King};
char * facecheck(int d); 
void shuffle( int deck[]);
void draw(int deck[SIZE]); 
void cards(int hand);
int main() 
{ 
    int deck[SIZE], i, n;
    char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

    srand( time( NULL ) ) ;

    for(i = 0; i<SIZE; i++)
    {
        deck[i] = i;
        i++;
    };

    draw(deck);
    shuffle(deck); 
    draw(deck);

    return 0; 
}  

char * facecheck(int d)
{
    static char * face[] = 
    {
        "Ace",
        "Jack",
        "Queen",
        "King" };

    if(d == Ace)
        return face[0];
    else
    {
        if(d == Jack) 
            return face[1];
        else
        {
            if(d == Queen)
                return face[2];
            else 
            { 
                if(d == King)
                    return face[3];
            }
        }
    }
}

void shuffle( int deck[]) 
{
     int i, j, temp; 

     for(i = 0; i < SIZE; i++)
     {
           j = rand() % SIZE; 
           temp = deck[i];
           deck[i] = deck[j];
           deck[j] = temp;
           }
     printf("The deck has been shuffled \n"); 
} 

void draw(int deck[SIZE])
{
     int i; 
     int hand[i];

     for(i = 0; i < 5; i++)
     {
           cards(hand[i]);
           putchar('\n');
           }
}

void cards(hand)
{
     int i; 

         char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

         for(i=0; i<SIZE; i++)
    {       
        if(i%13 == 0 || i%13 == 10 || i%13 == 11 || i%13 == 12)
            printf("%s ", facecheck(i%13) );
        else printf("%d ", i%13+1);
        printf("of %s \n", suits[i/13]);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:00:50.373

它可能会崩溃，因为这里：

```
for(i = 0; i<SIZE; i++)
{
    deck[i] = i;
    i++;
}; 
```

你增加 i 两次。删除`i++`行：

```
for(i = 0; i<SIZE; i++)
{
    deck[i] = i;
}; 
```

也在这里：

```
void draw(int deck[SIZE])
{
     int i; 
     int hand[i]; 
```

该行`int hand[i]`可能会失败，因为 i 不是常量（它也没有初始化）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:11:05.847

一些注意事项：

```
void draw(int deck[SIZE])
{
    int i; 
    int hand[i];

    for(i = 0; i < 5; i++)
    {
        cards(hand[i]);
        putchar('\n');
    }
} 
```

`i`默认情况下未初始化，并且将包含之前该内存地址中的任何内容，然后您创建一个此随机长度的数组-您是要这样做吗？

然后你将 hand[0], hand[1], ..., hand[4] 传递给卡片，即使它们是未定义的。

这可能会导致崩溃。

也许你想要类似的东西：

```
void draw(int deck[SIZE])
{
    int numCards = 5;
    int i; 
    int hand[numCards];
    int card;
    for(i = 0; i < numCards; i++)
    {
        card = deck[i];     /* Draw a card */
        hand[i] = card;     /* Store it in a "hand" array (even though you dont use it) */
        cards(card);        /* Display info about the card */
    }
} 
```

* * *

在这里，无论您的牌组如何排序，您都可以打印出每张牌的整数值。

```
void cards(hand)
{
    int i; 

    char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

    for(i=0; i<SIZE; i++)
    {       
        if(i%13 == 0 || i%13 == 10 || i%13 == 11 || i%13 == 12)
            printf("%s ", facecheck(i%13) );
        else 
            printf("%d ", i%13+1);
        printf("of %s \n", suits[i/13]);
    }

} 
```

我不认为你打算这样做。我想你的意思是

```
void cards(int card)
{
    char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

    if(card%13 == 0 || card%13 == 10 || card%13 == 11 || card%13 == 12)
        printf("%s ", facecheck(card%13) );
    else 
        printf("%d ", card%13+1);
    printf("of %s \n", suits[card/13]);
} 
```

由于您已经在每张卡上调用此函数，因此没有理由循环任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T17:45:36.847

```
for(i = 0; i<SIZE; i++)
{
    deck[i] = i;
    i++;
}; 
```

for循环中分号的错误？

```
for(i = 0; i<SIZE; i++)
{
    deck[i] = i;
    i++; //one of the answer stated to remove this sentence
} 
```

# visual-studio-2010 - 如何强制 VS2010 停止使用过时的插件？

> ID：15844964
> 
> 赞同：0
> 
> 时间：2013-04-05T22:58:28.727
> 
> 标签：visual-studio-2010, plugins, tfs, telerik, msscci

当我在 VS2010 中关闭 Telerik“RadControlsWebsite”项目时，我得到，“*此插件适用于旧版本的 Visual Studio。请使用团队资源管理器。* ”

然后，当我关闭该对话框时，我看到“*初始化 Team Foundation Server MSSCCI Provider 源代码控制提供程序时出现故障。您不能使用此提供程序执行源代码控制操作。* ”

虽然我有 TFS，但我没有将这个项目绑定到它。那么它试图使用什么过时的插件，为什么要尝试使用它，以及我如何才能用这个无赖的稀有比特来规避未来“所以我们再次见面”？

## 更新

我在这里看到：http: [//social.msdn.microsoft.com/Forums/en-US/tfspowertools/thread/4775882e-2675-4f6f-ba6f-6c67d2e7dcd0](http://social.msdn.microsoft.com/Forums/en-US/tfspowertools/thread/4775882e-2675-4f6f-ba6f-6c67d2e7dcd0)提示如何操作，但在 GiangShi 指定的位置（就我而言，它是 VS 10.0 | CurrentSourceControlProvider)，我只看到这个键：

```
Name=Default
Type=REG_SZ
Data={googledyboobopetc} 
```

如果我使用的是 TFS，我是否需要更改这个 val，或者添加一个新的 val，或者什么（使用 TFS，但去掉 err msg）？

# php - PHP从多维数组中提取值而无需循环

> ID：15844965
> 
> 赞同：4
> 
> 时间：2013-04-05T22:58:31.330
> 
> 标签：php, arrays, loops, foreach, extract

我只是想知道是否可以在 PHP 中从数组中提取值而无需循环。这是我的数组的一部分，所以你知道我的意思；

```
Array
(
[0] => Array
    (
        [0] => 76
        [1] => Adventures of Huckleberry Finn
    )

[1] => Array
    (
        [0] => 65
        [1] => Adventures of Huckleberry Finn
    )

[2] => Array
    (
        [0] => 59
        [1] => Bookcases
    )
) 
```

我在每个数组中的整数 [0] 之后 - 有没有比 foreach 循环更快的函数（我通常这样做的方式）？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-02-23T15:30:06.407

当然，您正在寻找[array_column](http://php.net/manual/pt_BR/function.array-column.php)函数。

```
$newArray = array_column($originalArray,'0'); 
```

如 PHP 手册中所述，使用此函数，您可以从数组数组中提取您需要的唯一信息。它通常与关联数组一起使用，但您可以使用数字作为参数，它也可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T23:43:06.020

寻找一个清晰的循环，你的程序员同事会感谢你的。它可能与任何其他解决方案一样快或快，并且清晰的代码比晦涩的循环躲避更可取。

就像一个例子：你需要多少秒才能看到什么：

```
list($b) = call_user_func_array('array_map',array_merge(array(null),$a)); 
```

...做？

行得通。不要使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:00:33.133

您最终的意思是 array_walk ...但这也是某种循环？那么：答案是否定的。

而且我认为没有更快的方法（除了用 C 编写自己的扩展 :-P）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T23:05:49.513

尝试：

```
array_walk($array, function(&$v) { $v = $v[0]; }); 
```

那应该将数组转换为您想要的格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T23:10:19.823

您可能正在寻找 array_walk()

```
$newArray = array();
$myCallback = function($key) use(&$newArray){
  $newArray[] = $key[0];
};

array_walk($myArray, $myCallback); 
```

这当然是如果你在变量 $myArray 中有你的数组

# php - 用字母分隔 foreach 循环的结果

> ID：15844966
> 
> 赞同：0
> 
> 时间：2013-04-05T22:58:46.247
> 
> 标签：php, mysql

这是我的查询：

```
try
{
  $sql = 'SELECT park_id, name, town, state, country
          FROM tpf_parks wHERE  ORDER BY name ASC';
  $result = $pdo->query($sql);
}
catch (PDOException $e)
{
  $error = 'Error fetching parks: ' . $e->getMessage();
  //include 'error.html.php';//
  exit();
}

$output = 'Parks Loaded';
//include 'output.html.php';//

foreach ($result as $row)
{
  $parklist[] = array(
    'park_id' => $row['park_id'],
    'name' => $row['name'],
    'town' => $row['town'],
    'state' => $row['state'],
    'country' => $row['country']
  );
}
include 'parks.html.php'; 
```

这是parks.html.php

```
<?php foreach ($parklist as $park):?>
    <a href="park.php?park_id=<?php echo $park['park_id'];?>">
        <h2><?php echo $park['name'];?></h2>
        <h3><?php echo $park['town'],',',$park['state'],',',$park['country'];?></h3>
    </a>
    <hr>
<?php endforeach; ?> 
```

我正在寻找可以更改 foreach 循环的某种方式，以便我可以将结果分成按第一个字母排序的组。这样我就可以为每个 Letter 放置一个 html 锚点，使用户可以通过单击页面顶部的链接（ABCDE 等）更轻松地找到特定记录。我不知道如何实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:06:39.310

[好吧，除非您使用变量 variables](http://php.net/manual/en/language.variables.variable.php) ，否则它不会是最漂亮的解决方案，这将允许您创建数组并基于带有字母数组的循环分配它们。

但是，如果这对您来说太复杂了，只需执行以下操作：

```
$a = array();
$b = array();
$c = array();
...

foreach ($result as $row)
{
    $letter = strtolower(substr($row['name'], 0, 1));
    if ($letter == 'a') $a.push($row);
    else if($letter == 'b') $b.push($row);
    ...
} 
```

显然，对每个字母都重复。

然后，当您循环遍历数组以创建 html 时，您必须对每个字母数组执行 foreach()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:07:17.473

```
foreach ($result as $row)
{
   //add to sub-array with first letter of $row['name']
   $parklist[strtolower($row['name'][0]][] = array(
   ....

//rather then give the whole alphabet with possible empties, check for existing letters:
$letters = array_keys($parklist) 
```

或者，为了多字节环境中的安全（例如 utf-8）：

```
 $parklist[mb_strtolower(mb_substr($row['name'],0,1))][]= array( 
```

（假设你有一个正确的`mb_internal_encoding()`）

如果您希望变音符号解决他们的基础（`ö`例如`o`）；

```
 $parklist[iconv('whateveryourinputcharsetis','ASCII//TRANSLIT',mb_strtolower(mb_substr($row['name'],0,1)))][]= array( 
```

请注意，您按名称列*排序*，`MySQL`因此您的条目应该按顺序排列，前提是您有正确的`COLLATION`：

正确的字符集/排序规则：

```
mysql> CREATE TABLE t ( f char(1)) charset=utf8;
Query OK, 0 rows affected (0.25 sec)
mysql> show full columns from t;
+-------+---------+-----------------+------+-----+---------+-------+---------------------------------+---------+
| Field | Type    | Collation       | Null | Key | Default | Extra | Privileges                      | Comment |
+-------+---------+-----------------+------+-----+---------+-------+---------------------------------+---------+
| f     | char(1) | utf8_general_ci | YES  |     | NULL    |       | select,insert,update,references |         |
+-------+---------+-----------------+------+-----+---------+-------+---------------------------------+---------
mysql> INSERT INTO t VALUES ('a'),('p'),('ä'),('o'),('ñ'),('ò');
Query OK, 6 rows affected (0.09 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM t ORDER BY f;
+------+
| f    |
+------+
| a    |
| ä    |
| ñ    |
| o    |
| ò    |
| p    |
+------+
6 rows in set (0.00 sec) 
```

但错误造成了严重破坏：

```
mysql> SELECT * FROM t ORDER BY CONVERT(f USING ascii);
+------+
| f    |
+------+
| ä    |
| ñ    |
| ò    |
| a    |
| o    |
| p    |
+------+
6 rows in set (0.00 sec) 
```

# javascript - 从 javascript 中的元标记中获取日期

> ID：15844968
> 
> 赞同：1
> 
> 时间：2013-04-05T22:58:57.223
> 
> 标签：javascript, string

我需要使用 javascript 从我的页面上的这个元数据中获取日期：

有效和过期有两个日期，我需要得到的日期是过期。

有没有办法得到它？我尝试了字符串方法，拆分但它不起作用：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T06:45:30.067

您可以使用从元标记获取数据`querySelector`，例如作者将是：

```
var authorTag = document.querySelector('[name=author]'); 
```

这是一个功能，你应该想要你想要的过期日期：

```
function getExpires() {
    var expiresTag = document.querySelector('[HTTP-EQUIV=expires]');

    try {
        return expiresTag.content;
    } catch(e) {
        console.log('Unable to get expires meta content');
        return '';
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-05T23:03:49.947

```
var metas = document.getElementsByTagName["meta"]; 
```

并循环查找您想要的标签：

```
for (var i=0; i<metas.length;i++) {  
  if (metas[i].getAttribute("itemprop")) {

    var theTagValueINeed = metas[i].getAttribute("itemprop");

  }
} 
```

# c++ - 为什么 gcc “--as-needed” 标志会导致符号丢失？

> ID：15844970
> 
> 赞同：3
> 
> 时间：2013-04-05T22:59:09.530
> 
> 标签：c++, linker

```
g++ [...] -ldiskcache_i [...] -lDCache  [...] 
```

链接并运行良好，但是

```
g++ [...] -Xlinker --as-needed  -ldiskcache_i [...] -lDCache  [...] 
```

给出一个缺失的符号：

```
libdiskcache_i.so: undefined reference to `TDCacheFile::Stage(char const*, unsigned int, char const*)' 
```

这两个库都是共享对象。

该符号在 中被请求`-ldiskcache_i`并且应该在 中被解析 `-lDCache`，因为它是在引入 as-needed 标志之前。这个方法唯一有趣的是它是一个类的静态方法`TDCacheFile`，并且调用使用了静态属性。

# c++ - 将互斥锁与其数据相关联的正确方法是什么？

> ID：15844972
> 
> 赞同：10
> 
> 时间：2013-04-05T22:59:16.257
> 
> 标签：c++, c++11, mutex

在将钱从一个银行帐户转移到另一个帐户的经典问题中，公认的解决方案（我相信）是将互斥锁与每个银行帐户相关联，然后在从一个帐户提取资金并将其存入另一个帐户之前锁定两者。乍一看，我会这样做：

```
class Account {
public:
  void deposit(const Money& amount);
  void withdraw(const Money& amount);
  void lock() { m.lock(); }
  void unlock() { m.unlock(); }

private:
  std::mutex m;
};

void transfer(Account& src, Account& dest, const Money& amount)
{
  src.lock();
  dest.lock();

  src.withdraw(amount);
  dest.deposit(amount);

  dest.unlock();
  src.unlock();
} 
```

但是手动解锁有异味。我可以公开互斥体，然后使用`std::lock_guard`in `transfer`，但公共数据成员也有味道。

的要求`std::lock_guard`是它的类型满足*BasicLockable*`lock`的要求，也就是调用`unlock`有效。`Account`满足该要求，因此我可以直接使用`std::lock_guard`with `Account`：

```
void transfer(Account& src, Account& dest, const Money& amount)
{
  std::lock_guard<Account> g1(src);
  std::lock_guard<Account> g2(dest);

  src.withdraw(amount);
  dest.deposit(amount);
} 
```

这似乎没问题，但我以前从未见过这种事情，并且复制互斥锁的锁定和解锁`Account`本身似乎有点臭。

在这种情况下，将互斥锁与其保护的数据相关联的最佳方法是什么？

更新：在下面的评论中，我注意到它`std::lock`可以用来避免死锁，但我忽略了它`std::lock`依赖于`try_lock`功能的存在（除了 for`lock`和`unlock`）。添加`try_lock`到`Account`的界面似乎是一个相当严重的黑客攻击。因此，如果`Account`要保留对象的互斥锁`Account`，它似乎必须是公共的。这有相当的恶臭。

一些提议的解决方案让客户使用包装器类将互斥锁与`Account`对象静默关联，但是，正如我在评论中指出的那样，这似乎使代码的不同部分可以轻松使用不同的包装器对象`Account`，每个都创建自己的互斥体，这意味着代码的不同部分可能会尝试`Account`使用不同的互斥体来锁定。那很糟。

其他提议的解决方案依赖于一次仅锁定一个互斥锁。这消除了锁定多个互斥体的需要，但代价是某些线程可能看到系统的不一致视图。从本质上讲，这放弃了涉及多个对象的操作的事务语义。

在这一点上，公共互斥锁开始看起来像是可用选项中最不臭的，这是我真的不想得出的结论。真的没有更好的了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T01:06:00.710

查看**Herb Sutter在****C++ 和 Beyond 2012**上的演讲：[C++ 并发](http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Herb-Sutter-Concurrency-and-Parallelism)。他展示了 C++11 中类似[Monitor Object的实现示例。](http://en.wikipedia.org/wiki/Monitor_%28synchronization%29)

```
monitor<Account> m[2];
transaction([](Account &x,Account &y)
{
    // Both accounts are automaticaly locked at this place.
    // Do whatever operations you want to do on them.
    x.money-=100;
    y.money+=100;
},m[0],m[1]);
// transaction - is variadic function template, it may accept many accounts 
```

执行：

[**现场演示**](http://coliru.stacked-crooked.com/a/de69939cf1ec890d)

```
#include <iostream>
#include <utility>
#include <ostream>
#include <mutex>

using namespace std;

typedef int Money;

struct Account
{
    Money money = 1000;
    // ...
};

template<typename T>
T &lvalue(T &&t)
{
    return t;
}

template<typename T>
class monitor
{
    mutable mutex m;
    mutable T t;
public:
    template<typename F>
    auto operator()(F f) const -> decltype(f(t))
    {
        return lock_guard<mutex>(m),
               f(t);
    }
    template<typename F,typename ...Ts> friend
    auto transaction(F f,const monitor<Ts>& ...ms) ->
        decltype(f(ms.t ...))
    {
        return lock(lvalue(unique_lock<mutex>(ms.m,defer_lock))...),
        f(ms.t ...);
    }
};

int main()
{
    monitor<Account> m[2];

    transaction([](Account &x,Account &y)
    {
        x.money-=100;
        y.money+=100;
    },m[0],m[1]);

    for(auto &&t : m)
        cout << t([](Account &x){return x.money;}) << endl;
} 
```

输出是：

```
900
1100 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T23:12:51.437

让钱“在外流”一段时间并没有错。让它像这样：

```
Account src, dst;

dst.deposit(src.withdraw(400)); 
```

现在只需使每个单独的方法线程安全，例如

```
int Account::withdraw(int n)
{
    std::lock_guard<std::mutex> _(m_);
    balance -= n;
    return n;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T00:39:29.617

我更喜欢使用非侵入式包装类，而不是使用互斥锁污染原始对象并在每个方法调用上锁定它。这个包装类（我命名为`Protected<T>`）包含用户对象作为私有变量。`Protected<T>`将友谊授予另一个名为`Locker<T>`. 储物柜将包装器作为其构造函数参数，并为用户对象提供公共访问器方法。locker 还保持包装器的互斥锁在其生命周期内处于锁定状态。因此，locker 的生命周期定义了一个可以安全访问原始对象的范围。

`Protected<T>`可以实现`operator->`快速调用单个方法。

工作示例：

```
#include <iostream>
#include <mutex>

template<typename>
struct Locker;

template<typename T>
struct Protected
{
    template<typename ...Args>
    Protected(Args && ...args) :
        obj_(std::forward<Args>(args)...)
    {        
    }

    Locker<const T> operator->() const;
    Locker<T> operator->();

private:    
    friend class Locker<T>;
    friend class Locker<const T>;
    mutable std::mutex mtx_;
    T obj_;
};

template<typename T>
struct Locker
{
    Locker(Protected<T> & p) :
        lock_(p.mtx_),
        obj_(p.obj_)
    {
        std::cout << "LOCK" << std::endl;
    }

    Locker(Locker<T> && rhs) = default;

    ~Locker()
    {
        std::cout << "UNLOCK\n" << std::endl;
    }

    const T& get() const { return obj_; }
    T& get() { return obj_; }

    const T* operator->() const { return &get(); }
    T* operator->() { return &get(); }

private:    
    std::unique_lock<std::mutex> lock_;
    T & obj_;    
};

template<typename T>
struct Locker<const T>
{
    Locker(const Protected<T> & p) :
        lock_(p.mtx_),
        obj_(p.obj_)
    {
        std::cout << "LOCK (const)" << std::endl;
    }

    Locker(Locker<const T> && rhs) = default;

    ~Locker()
    {
        std::cout << "UNLOCK (const)\n" << std::endl;
    }

    const T& get() const { return obj_; }    
    const T* operator->() const { return &get(); }

private:    
    std::unique_lock<std::mutex> lock_;
    const T & obj_;
};

template<typename T>
Locker<T> Protected<T>::operator->()
{
    return Locker<T>(const_cast<Protected<T>&>(*this));
}

template<typename T>
Locker<const T> Protected<T>::operator->() const
{
    return Locker<T>(const_cast<Protected<T>&>(*this));
}

struct Foo
{
    void bar() { std::cout << "Foo::bar()" << std::endl; }
    void car() const { std::cout << "Foo::car() const" << std::endl; }
};

int main()
{
    Protected<Foo> foo;

    // Using Locker<T> for rw access
    {
        Locker<Foo> locker(foo);
        Foo & foo = locker.get();
        foo.bar();
        foo.car();
    }

    // Using Locker<const T> for const access
    {
        Locker<const Foo> locker(foo);
        const Foo & foo = locker.get();
        foo.car();
    }

    // Single actions can be performed quickly with operator-> 
    foo->bar();
    foo->car();
} 
```

生成此输出：

```
LOCK
Foo::bar()
Foo::car() const
UNLOCK

LOCK (const)
Foo::car() const
UNLOCK (const)

LOCK
Foo::bar()
UNLOCK

LOCK
Foo::car() const
UNLOCK 
```

[使用在线编译器进行测试。](http://coliru.stacked-crooked.com/view?id=c3c08cda10533b8a6e52963083262350-50d9cfc8a1d350e7409e81e87c2653ba)

**更新：**固定 const 正确性。

**PS：**还有一个[异步变体](http://coliru.stacked-crooked.com/view?id=665ae867f4fd7a82d9c8ff461c46dcb6)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-06T00:42:59.767

就我个人而言，我是[LockingPtr](http://www.drdobbs.com/cpp/volatile-the-multithreaded-programmers-b/184403766)范式的粉丝（这篇文章已经过时了，我个人不会听从它的所有建议）：

```
struct thread_safe_account_pointer {
     thread_safe_account_pointer( std::mutex & m,Account * acc) : _acc(acc),_lock(m) {}

     Account * operator->() const {return _acc;}
     Account& operator*() const {return *_acc;}
private:
     Account * _acc;
     std::lock_guard<std::mutex> _lock;
}; 
```

并实现包含这样一个`Account`对象的类：

```
class SomeTypeWhichOwnsAnAccount {
public:
     thread_safe_account_pointer get_and_lock_account() const {return thread_safe_account_pointer(mutex,&_impl);}

      //Optional non thread-safe
      Account* get_account() const {return &_impl;}

      //Other stuff..
private:
     Account _impl;
     std::mutex mutex;
}; 
```

如果合适，可以用智能指针替换指针，您可能需要一个`const_thread_safe_account_pointer`（甚至更好的通用模板`thread_safe_pointer`类）

为什么这比显示器（IMO）好？

1.  您可以在不考虑线程安全的情况下设计您的 Account 类；线程安全是*使用*您的类的对象的属性，而不是您的类本身的属性。
2.  在类中嵌套对成员函数的调用时，不需要递归互斥锁。
3.  无论您是否锁定互斥锁，您都可以在代码中清楚地记录（并且您可以通过不实现来完全防止使用无锁定`get_account`）。同时拥有 a`get_and_lock()`和`get()`函数会*迫使*您考虑线程安全性。
4.  定义函数（全局或成员）时，您有一个清晰的语义来指定函数是否需要锁定对象的互斥锁（只需传递 a `thread_safe_pointer`）还是线程安全不可知（使用`Account&`）。
5.  最后但并非最不重要的一点是，`thread_safe_pointer`与监视器有完全不同的语义：

考虑一个`MyVector`通过监视器实现线程安全的类，以及以下代码：

```
MyVector foo;
// Stuff.. , other threads are using foo now, pushing and popping elements

int size = foo.size();
for (int i=0;i < size;++i)
   do_something(foo[i]); 
```

像这样的 IMO 代码真的很糟糕，因为它让你觉得`safe`监视器会为你处理线程安全，而这里我们有一个非常难以发现的竞争条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T23:17:12.080

您的问题是将锁定与数据相关联。在我看来，将其`mutex`塞入对象中很好。你可以更进一步，使对象本质上成为[监视器](http://en.wikipedia.org/wiki/Monitor_%28synchronization%29)：锁定进入函数成员，离开时解锁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-06T01:10:02.487

我相信为每个帐户提供自己的锁是可以的。它向您的代码的任何读者提供了一个明确的信号，即访问`Account`是一个关键部分。

任何涉及每个帐户一个锁的解决方案的缺点是，当您编写同时操作多个帐户的代码时，您必须注意死锁。但是，避免该问题的直接方法是将您的交互限制为一次只与一个帐户进行交互。这不仅避免了潜在的死锁问题，还增加了并发性，因为当当前线程忙于不同的事情时，您不会阻止其他线程访问其他帐户。

您对一致视图的担忧是有效的，但可以通过记录当前事务中发生的操作来实现。例如，您可以使用事务日志来装饰您的`deposit()`和`withdraw()`操作。

```
class Account {
  void deposit(const Money &amount);
  void withdraw(const Money &amount);
public:
  void deposit(const Money &amount, Transaction& t) {
    std::lock_guard<std::mutex> _(m_);
    deposit(amount);
    t.log_deposit(*this, amount);
  }
  void withdraw(const Money &amount, Transaction& t) {
    std::lock_guard<std::mutex> _(m_);
    withdraw(amount);
    t.log_withdraw(*this, amount);
  }
private:
  std::mutex m_;
}; 
```

然后，a`transfer`是记录的提款和存款。

```
void transfer (Account &src, Account &dest, const Money &amount,
               Transaction &t) {
  t.log_transfer(src, dest, amount);
  try {
    src.withdraw(amount, t);
    dest.deposit(amount, t);
    t.log_transfer_complete(src, dest, amount);
  } catch (...) {
    t.log_transfer_fail(src, dest, amount);
    //...
  }
} 
```

请注意，事务日志的概念与您选择部署锁的方式是正交的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-06T07:11:39.923

我认为您的答案是按照您的建议使用 std::lock()，但将其放入朋友函数中。这样您就不需要公开帐户互斥锁。新朋友函数不使用 deposit() 和withdraw() 函数，需要单独锁定和解锁互斥锁。请记住，朋友函数不是成员函数，但可以访问私有成员。

```
typedef int Money;

class Account {
public:
  Account(Money amount) : balance(amount)
  {
  }

  void deposit(const Money& amount);
  bool withdraw(const Money& amount);

  friend bool transfer(Account& src, Account& dest, const Money& amount)
  {
     std::unique_lock<std::mutex> src_lock(src.m, std::defer_lock);
     std::unique_lock<std::mutex> dest_lock(dest.m, std::defer_lock);
     std::lock(src_lock, dest_lock);

     if(src.balance >= amount)
     {
        src.balance -= amount;
        dest.balance += amount;
        return true;
     }
     return false;
  }
private:
  std::mutex m;
  Money balance;
}; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-10T04:25:21.273

大多数解决方案都有一个问题，即数据是公开的，因此人们可以在不锁定锁的情况下访问它。

有一种方法可以解决这个问题，但是您不能使用模板，因此必须求助于宏。在 C++11 中实现要好得多，而不是在这里重复整个讨论，我链接到我的实现：[https ://github.com/sveljko/lockstrap](https://github.com/sveljko/lockstrap)

# javascript - Javascript字符串是原型函数吗？

> ID：15844974
> 
> 赞同：1
> 
> 时间：2013-04-05T22:59:17.773
> 
> 标签：javascript, function, prototype

我正在 javascript 中创建一个小 Shape 类，以便画布消磨一些时间。我想知道我是否可以做类似下面的事情，

```
var Shape = function (shape) {

     // pseudo code
     if (shape is a prototype function of Shape) {
         shape();
     }
}

Shape.prototype.quad = function () {

} 
```

因此，对于上述内容，唯一有效的字符串将`quad`是唯一定义的原型函数。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:16:39.547

鉴于这`shape`是一个字符串，只需使用`in`它来查看它是否存在`Shape.prototype`

```
var Shape = function (shape) {
     if (shape in Shape.prototype) {
         Shape.prototype[shape]();
     }
}; 
```

这当然不会给你一个有用的`this`价值`Shape.prototype.quad`，但我不能告诉你在那里想要什么。

* * *

如果您打算将其用作构造函数，那么您将`this`改用它。

```
var Shape = function (shape) {
     if (shape in this) {
         this[shape]();
     }
}; 
```

* * *

如果您还想确定它是一个函数，请使用`typeof`.

```
 if ((shape in this) && typeof this[shape] === "function") {
     this[shape]();
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:05:54.280

**[jsFiddle 演示](http://jsfiddle.net/ArAsS/)**

我认为您正在寻找的是继承检测。这可以通过检查来完成`instanceof`。这是一个例子：

```
var Shape = function (shape) {
 if( shape instanceof Shape ){
  alert("shape instance found");   
 }
};

var Quad = function(){};
Quad.prototype = new Shape();

var q = new Quad();
var s = new Shape(q); 
```

* * *

编辑

**[jsFiddle 演示](http://jsfiddle.net/E3NGw/1/)**

也许您想寻找由字符串定义的原型？在这种情况下，请执行以下操作：

```
var Shape = function (shape) {
 if( typeof this[shape] == "function" ){
    alert("shape is a prototype function");   
 }
};
Shape.prototype.quad = function(){};

var c = new Shape("circle");
var q = new Shape("quad"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T23:44:00.960

假设 Shape 是一个构造函数，试试这个，它使用非标准但常用的**proto**属性。

```
var Shape = function (shape) {
    for (var functionName in this) {
        if (this.__proto__.hasOwnProperty(functionName)) {     
            if (this[functionName]  ===  shape) {
                shape.call(this);
            }
        }            
    }
}

Shape.prototype.quad = function () { console.log("quad")}
new Shape(Shape.prototype.quad) 
```

# jquery - jquery 函数在 wordpress 中不起作用

> ID：15844980
> 
> 赞同：1
> 
> 时间：2013-04-05T22:59:39.877
> 
> 标签：jquery, wordpress, timer

我需要将此功能集成到我的 wordpress 中，并且我还需要使用多个示例事件，它只适用于一个。有什么建议吗？谢谢。

```
<div id="example">
<p style="display: block;">3 Hours</p>
<p>2h and 30m</p>
<p>2h</p>
<p>1h and 30m</p>
<p>1h</p>
<p>30min</p>
<p>Started</p>
</div>

Jquery
$(document).ready(function(){ 

$("#example p:first").css("display", "block");

jQuery.fn.timer = function() {
    if(!$(this).children("p:last-child").is(":visible")){
        $(this).children("p:visible")
            .css("display", "none")
            .next("p").css("display", "block");
    }
    else{
        $(this).children("p:visible")
            .css("display", "none")
        .end().children("p:first")  
            .css("display", "block");
    }
} // timer function end

window.setInterval(function() {
    $("#example").timer();
}, 50); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T10:56:50.910

将此添加到您的functions.php

```
<?php 
if (!is_admin()) 
    add_action("wp_enqueue_scripts", "my_jquery_enqueue", 11);
function my_jquery_enqueue() {
    wp_deregister_script('jquery');
    wp_register_script('jquery', "http" . ($_SERVER['SERVER_PORT'] == 443 ? "s" : "") . "://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js", false, null);
    wp_enqueue_script('jquery');
}
?> 
```

# magento - 如何在 Magento 1.7 结帐的总计中包含运费税？

> ID：15844982
> 
> 赞同：2
> 
> 时间：2013-04-05T22:59:44.443
> 
> 标签：magento, magento-1.7, checkout, shipping

目前，在结帐的“订单审核”下，它列出了以下内容： - 小计：44.00 美元 - 运输和处理成本：0.00 美元 - 税：4.18 美元 - 总计：44.00 美元

问题是总计不包括税额（因此总计变为 $48.18

我曾尝试在 Magento 1.7 的 System/Config/Sales/Tax 页面上解决此问题，但无论我更改什么配置，我还没有成功地使总计包含税。

注意：税款基于订单的发货地（例如，公司位于华盛顿州，因此订单需缴纳 WA 州运费税）

欢迎提出想法。谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T03:26:03.870

登录到管理员去

> 系统 --> 配置 --> 销售 --> 税 --> 购物车显示设置 --> 在总计中包括税 --> 设置为是 --> 保存配置"

以及将相同的设置设置为“订单、发票、贷项凭证显示设置”

# c# - 如何自动连接 IBM MQ 客户端？

> ID：15844983
> 
> 赞同：4
> 
> 时间：2013-04-05T22:59:50.807
> 
> 标签：c#, .net, ibm-mq

我正在使用 MQ 7x 客户端的 MQ.NET 类，并且导入和导出消息工作正常。但是，如果网络断开连接或远程管理器断开连接，IBM MQ 客户端不会自动重新连接。我得到：

```
Error: Remote host ' not available, retry later. 
```

发生此类问题时，有没有办法自动连接并继续处理消息？

有一个属性可以检查队列管理器的连接：

```
mqQMgr = new MQQueueManager("My queue manager name" ,"my channel name",",my connection name"); 
```

`mqQMgr.IsConnected`返回真/假，但这无助于自动连接。

这就是我正在使用的：

```
 // mq properties
    Hashtable properties = new Hashtable();
    properties.Add(MQC.TRANSPORT_PROPERTY, MQC.TRANSPORT_MQSERIES_MANAGED);            
    properties.Add(MQC.CONNECTION_NAME_PROPERTY, "connectionName");            
    properties.Add(MQC.CHANNEL_PROPERTY, "channelName");
    properties.Add(MQC.CONNECT_OPTIONS_PROPERTY, MQC.MQCNO_RECONNECT_Q_MGR);

    mqQMgr = new MQQueueManager("my queue manager"), properties); //error thrown 
```

我在上面的行中收到此错误

```
IBM MQException caught in send message - reason code - 2046- message -CompCode: 2, Reason: 2046
{"MQRC_OPTIONS_ERROR"}
base {System.ApplicationException}:
{"MQRC_OPTIONS_ERROR"}
CompCode: 2
CompletionCode: 2
Message: "MQRC_OPTIONS_ERROR"
Reason: 2046 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T00:23:03.057

从 v7.1 开始，MQ C# 客户端支持自动客户端重新连接。您必须使用`MQCNO_RECONNECT`or`MQCNO_RECONNECT_Q_MGR`或`MQCNO_RECONNECT_AS_DEF`CNO 选项来启用自动重新连接。MQ v7.1 提供了几个示例，SimpleClientAutoReconnectPut.cs 就是其中之一。详情请参阅样本。

简单的片段。

```
mqQMgr = new MQQueueManager("QM", MQC.MQCNO_RECONNECT,"SVRCONNCHN","localhost(1414)"); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-05T23:39:10.170

我使用它已经有一段时间了，但是有自动重新连接的选项：在这里你可以阅读更多，即使它是 Java 定制的，这些选项也可以在 C# 包装器中使用： [IBM MQ：自动客户端重新连接](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=/com.ibm.mq.amqzag.doc/fa70190_.htm)

一个好的模式是在您编写消息以检查它是否已连接并重新连接之前：

```
if (!mqQMgr.IsConnected) {
   mqQMgr.Connect();
}
mqQMgr.Write(message); 
```

我不知道这是否会帮助你。祝你好运！

# android - 访问静态arraylist时Android空指针异常

> ID：15844993
> 
> 赞同：0
> 
> 时间：2013-04-05T23:00:49.617
> 
> 标签：android, static, arraylist, android-widget, nullpointerexception

我遇到了一个我一生都无法理解的错误。我有一个侦听器，它进行 Web 服务调用并从其他两个类 practiceRoundListActivity 和 qualifierRoundListActivity 填充静态数组列表。因此，在下面的代码中，在 foreach 循环中，我有两个条件来决定将插入事件的数组列表。第一个条件“praciticeRoundListActivity.values ...”工作正常，但对“qualifierRoundListActivity.values ...”的调用不起作用，我得到一个空指针异常。

```
 public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
    if (arg2 != 0) {
        String name = (String) arg0.getItemAtPosition(arg2);
        Log.d(TAG, name);
        Team team = SpectatorActivity.map2.get(name);
        Log.d(TAG, team.getGSID());
        String url = "http://qualifiers.golfstat.com/webservices/remote.cfc?method=getEventsByGSID&GSID=";
        url += team.getGSID();
        wt.execute(url, team);
        //practiceRoundListActivity.values = new ArrayList<String>();
        //qualifierRoundListActivity.values2 = new ArrayList<String>();
        for(Event event : team.getEvents()) {
            if(event.getType() == 'p') {
                Log.d(TAG, "PR found");
                practiceRoundListActivity.values.add(event.getEventDescription() + " " + event.getTournamentDescription());
            } else if(event.getType() == 'q') {
                Log.d(TAG, "QR found");
                // //HERE IS THE BUG qualifierRoundListActivity.values.add(event.getEventDescription() + " " + event.getTournamentDescription());
            }
        }
        tabHost.setCurrentTab(1);
        tabHost.setVisibility(0);
    }
} 
```

作为列表活动， practiceRoundListActivity 和 qualifierRoundListActivity 附加到要显示的数组适配器。我已经用尽了每一个想法来学习一些东西，任何关于为什么会发生这种情况的东西。最近，由于 practiceRound... 和 qualifierRound... 非常相似，我将 practiceRound... 类的代码复制到 qualifierRound... 并将所有必要的名称更改为 quailifierRound...（我知道这些类名很烦人长）。预先感谢您的任何帮助。

```
public class qualifierRoundListActivity extends ListActivity {

static ListView listView;
ArrayAdapter<String> adapter;
public static ArrayList<String> values;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.round_list);

    listView = getListView();
    values = new ArrayList<String>();
    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
    listView.setAdapter(adapter);
    listView.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            // TODO Auto-generated method stub
            Intent intent = new Intent(getApplicationContext(), LeaderBoardActivity.class);
            startActivity(intent);
        }

    });
}

public static void setMultipleChoice() {
    listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);
}

@Override
public void onPause() {
    super.onPause();
    listView.setOnItemLongClickListener(null);
}
} 
```

Logcat：第 154 行是“qlualifierRoundListActivity.values.add(...”行。

```
03-20 23:05:59.272: E/AndroidRuntime(2392): FATAL EXCEPTION: main
03-20 23:05:59.272: E/AndroidRuntime(2392): java.lang.NullPointerException
03-20 23:05:59.272: E/AndroidRuntime(2392):     at com.gstat.activities.SpectatorActivity.onItemSelected(SpectatorActivity.java:154)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.widget.AdapterView.fireOnSelected(AdapterView.java:871)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.widget.AdapterView.access$200(AdapterView.java:42)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.widget.AdapterView$SelectionNotifier.run(AdapterView.java:837)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.os.Handler.handleCallback(Handler.java:587)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.os.Looper.loop(Looper.java:123)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at android.app.ActivityThread.main(ActivityThread.java:3683)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at java.lang.reflect.Method.invokeNative(Native Method)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at java.lang.reflect.Method.invoke(Method.java:507)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-20 23:05:59.272: E/AndroidRuntime(2392):     at dalvik.system.NativeStart.main(Native Method) 
```

因此，我将 qualifierRoundListActivity 显示在选项卡中，下面是我从主类启动它的方式。

```
 public void setupTab(final View view, final String tag) {
    View tabView = createTabView(tabHost.getContext(), tag);
    TabSpec setContent = tabHost.newTabSpec(tag).setIndicator(tabView);
    Intent intent;
    if(tag == "Practice Rounds") {
        intent = new Intent(this, practiceRoundListActivity.class);
        setContent.setContent(intent);
    }
    else {
        intent = new Intent(this, qualifierRoundListActivity.class);
        setContent.setContent(intent);
    }
    tabHost.addTab(setContent);
}

private static View createTabView(final Context context, final String text) {
    View view = LayoutInflater.from(context).inflate(R.layout.tabs_small, null);
    TextView textView = (TextView) view.findViewById(R.id.tabsText);
    textView.setText(text);
    return view;
} 
```

当我在 qualifier... 类中添加静态方法时：

```
public static void add(String event) {
    values.add(event);
} 
```

我在 values.add(event) 行收到一个空指针异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T23:05:14.760

当 Activity 结束其生命周期并被垃圾回收时，使用 Activity 初始化的静态数据将被删除。你不应该假设它会在那里。

不要直接访问数据，而是在静态方法中查询它。该方法将首先检查静态数据是否为空，如果是，它将在返回之前重新填充它。

Android Activity 生命周期令人困惑，您可能已经对 Activity 的行为方式做出了一些合理但不正确的假设。

您的解决方案可能是保留这些数据（例如：在 SharedPreferences 中），除非绝对必要，否则不要将其存储为静态数据。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-05T23:05:10.290

尝试把 values = new ArrayList(); 在 setContentView 之前

# asp.net - 如何订购我的自定义过滤器属性

> ID：15844996
> 
> 赞同：2
> 
> 时间：2013-04-05T23:01:09.677
> 
> 标签：asp.net, servicestack

我想控制过滤器的运行顺序，这可能吗？

```
[LogRequestFilterAttribute]
[ApiKeyRequestFilterAttribute] 
```

我总是想先记录请求，然后进行安全检查，这可能吗？Priority 属性似乎与全局过滤器之前/之后的执行有关。

谢谢你，斯蒂芬

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T02:38:41.463

[Request 和 Response 过滤器属性](https://github.com/ServiceStack/ServiceStack/wiki/Filter-attributes)有一个**Priority**属性，您可以覆盖该属性，让您指定触发过滤器的排序顺序。

这是执行第一个过滤器时的事件序列，来自 ServiceStack 的[Order of Operations wiki 页面](https://github.com/ServiceStack/ServiceStack/wiki/Order-of-Operations)：

```
 ...

  5\. Request Filter Attributes with Priority < 0 gets executed
  6\. Then any Global Request Filters get executed
  7\. Followed by Request Filter Attributes with Priority >= 0
  8\. Action Request Filters (New API only)
  9\. Then your Service is executed with the configured IServiceRunner and its 
     OnBeforeExecute, OnAfterExecute and HandleException custom hooks are fired
  10\. Action Response Filters (New API only)
  11\. Followed by Response Filter Attributes with Priority < 0
  12\. Then Global Response Filters
  13\. Followed by Response Filter Attributes with Priority >= 0 
```

每当您在任何过滤器中关闭响应时，即`httpRes.EndServiceStackRequest()`响应的处理是短路的，并且不会对该请求进行进一步的处理。

# android - 为 Android 移植 SoundTouch

> ID：15844997
> 
> 赞同：1
> 
> 时间：2013-04-05T23:01:15.617
> 
> 标签：android, audio, java-native-interface, soundtouch

我一直在尝试为 Android 编写一个应用程序，它可以让我实时放慢和加速音乐。我遇到了 SoundTouch 库，它甚至声明它可以通过 jni 在 Android 中使用。但是，源代码仅将 getversionString() 方法转换为 andorid。我找到了这个库的其他几个实现，例如[https://github.com/nonameentername/soundtouch-android](https://github.com/nonameentername/soundtouch-android)，但它缺少关键文件，因此无法编译。我还尝试移植一个名为 Mypodconv 的桌面应用程序（[http://www.aplu.ch/home/apluhomex.jsp?site=44](http://www.aplu.ch/home/apluhomex.jsp?site=44)), 到 Android，但这使用了包含在 rt.jar 中的 javax.sound 包，这对于 android 来说太大了，因此会导致堆溢出并导致 Eclipse 崩溃。有人知道我怎样才能让这个库在 android 中工作吗？谢谢