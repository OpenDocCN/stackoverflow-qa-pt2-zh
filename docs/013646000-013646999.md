# StackOverflow 问答 13646000-13646999

# php - 如何在 MySQL 数据库中存储多级 ul 列表？

> ID：13646007
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:13.337
> 
> 标签：php, jquery, mysql, list, store

`<ul>`我从 mysql 数据库中列出了一个长的、至少 5 个级别的列表。用户有机会对项目进行排序、将一个项目从一个列表拖放到另一个、重命名或删除。然后保存它。

我使用 PHP 进行列表，使用 Javascript/Jquery 重新排列项目。

**我的问题是将 ul li 元素拆分为数组的最佳方法是什么？**拥有每个元素的父 ID 很重要。

非常简化的示例代码：

```
<a href="#">Parent item name</a>
<ul data-level='0'>
    <li>
        <a href="#">Child item name</a>
        <ul data-level='1'>
            <li><a href="#">2nd level item 1</a></li>
            <li><a href="#">2nd level item 2</a></li>
            <li><a href="#">2nd level item 3</a></li>
            <li><a href="#">2nd level item 4</a></li>
        </ul>
    </li>
</ul> 
```

结果，“第 2 级项目 2”应该有它的父“子项目名称”（它的 id 存储在其名称旁边的隐藏输入字段中）。

该列表可以是任何级别，因为用户也可以添加其他级别。代码也必须处理 15 级列表。

我正在考虑`<li>`通过javascript获取放置在每个元素中的隐藏输入的值。JQuery 能够获取孩子的数量。但这似乎不是最好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:26:29.460

恕我直言，当单击提交按钮时，您的 jquery 可以迭代列表并创建 JSON 对象（每个成员都有父值，0 代表根）并使用 AJAX 将其发送到后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T02:01:21.527

这是一个可能的解决方案：

HTML：

```
<a href="#">Parent item name</a>
<ul class="0" id="level_0_count_0" data-level='0'>
<li>
    <a href="#">Child item name</a>
    <ul class="1" id="level_1_count_0" data-level='1'>
        <li><a href="#">ul 0 2nd level item 1pppppppp</a></li>
        <li><a href="#">ul 0 2nd level item 2pppppppp</a></li>
        <li><a href="#">ul 0 2nd level item 3pppppppp</a></li>
        <li>
            <a href="#">ul 0 2nd level item 4</a>
            <ul class="2" id="level_2_count_0" data-level='1'>
                <li><a href="#">ul 2 3nd level item 1cccccccc</a></li>
                <li><a href="#">ul 2 3nd level item 2cccccccc</a></li>
                <li><a href="#">ul 2 3nd level item 3cccccccc</a></li>
                <li><a href="#">ul 2 3nd level item 4cccccccc</a></li>
            </ul>
        </li>
    </ul>
</li>

<li>
    <a href="#">Child item name</a>
    <ul class="1" id="level_1_count_1" data-level='1'>
        <li><a href="#">ul 1 2nd level item 1</a></li>
        <li><a href="#">ul 1 2nd level item 2</a></li>
        <li><a href="#">ul 1 2nd level item 3</a></li>
        <li><a href="#">ul 1 2nd level item 4</a></li>
    </ul>
</li> 
```

JavaScript：

```
 var $j = jQuery.noConflict();
$j(document).ready(function() {
var temp = new Array();
find_ul(0, temp);
});

function find_ul(parent_class, new_object_, level_count){
if( $j('.' + parent_class + ' > li > ul').length == 0){
    return new_object_;
}else{
    var current_objs = $j('.' + parent_class + ' > li > ul');
    var i = 0;
    parent_class++;
    $j.each(current_objs, function() {
            var current_ul_id = '';
            var object_lis =  $j('ul#level_' + parent_class + '_count_' + i + ' > li');
            var b = 0;
            var tempora = new Array();
            var current_ul_id = $j(this).attr('id');
            alert(current_ul_id);

           $j.each(object_lis, function() {
               tempora[b] = $j(this).html();
               b++;
               alert($j(this).html());

            });

            new_object_[i] = {ul_id: current_ul_id, lis:tempora};
            i++;

    });
}
   find_ul(parent_class, new_object_);
} 
```

您可以在以下位置查看/测试它：http: [//jsfiddle.net/BsDpY/4/](http://jsfiddle.net/BsDpY/4/)

这将为 ul/li 的每一层生成一个包含级别的数组

因此它将首先通过第一级（父母）然后通过其子 UL ..

希望有帮助。

# sql - where子句中存在sql短路OR或条件

> ID：13646009
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:17.077
> 
> 标签：sql, sql-server, performance, shortcut

我正在尝试强制 sql server 在某些字段上进行短路或比较。在 Or 的左侧，我有一个简单的变量比较，而在右侧，我有一个非常“重”的子查询。

```
WHERE
(@Var = 'DefaultValue' )  OR 
Exists(select * from atable) 
```

如果第一条语句为假，有没有办法只执行 or 语句的右侧。

我已经尝试过 case 和 if else 语句，但找不到任何有效的语法。

我正在使用 MS SQL 服务器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:19:31.263

你不能在一条 SQL 语句中做你想做的事。但是，您可以在存储过程中执行类似的操作

```
If @Var = 'DefaultValue' then
BEGIN
     SELECT * FROM table 
END
ELSE
BEGIN
     SELECT * FROM table
     WHERE Exists(select * from atable)
END 
```

如果你有很多输入，你应该考虑动态 SQL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-04T03:38:12.590

这个怎么样？

```
WHERE 1 = CASE @Var
               WHEN 'DefaultValue' THEN 1
               ELSE (SELECT TOP 1 1 FROM atable)
          END 
```

# r - 如何从文件中删除行名

> ID：13646010
> 
> 赞同：1
> 
> 时间：2012-11-30T13:15:18.220
> 
> 标签：r, csv, dataframe, rowname

我有一个看起来像这样的文件..

```
"Locations" "X9442" "X5997"
"1" "cg00000957"    0.87    0.86
"2" "cg00001349"    0.78    0.78
"3" "cg00001583"    0.06    0.08
"4" "cg00002028"    0.01    0.01 
```

我希望删除行名并使其如下所示：

```
 "Locations"    "X9442" "X5997"
 "cg00000957"   0.87    0.86
 "cg00001349"   0.78    0.78
 "cg00001583"   0.06    0.08
 "cg00002028"   0.01    0.01 
```

我尝试了各种方法，但在执行 write.table 时无法删除这些索引。有时标题“位置”也会移动其列。有人可以帮助我如何在 R 或 linux 中实现上述目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T13:16:43.300

查看帮助文件：`?write.table`特别是，

```
write.table(dd, file="output.csv", row.names=FALSE) 
```

# ruby-on-rails - rails 我如何配置资产：预编译用于在 public/javascript 或 /public/stylesheets 中创建文件

> ID：13646013
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:21.320
> 
> 标签：ruby-on-rails, ruby, rake

我有一个要部署在生产服务器上的 Rails 应用程序，

问题是当我运行 rake assets:precompile 时，它​​会在 /public/assets 下生成 css 和 js 文件，例如“/public/assets/application.css”和“/public/assets/application.js”

但是当我在我的erb上添加这个标签时

`<%= stylesheet_link_tag "application", :media => "all" %>`

`<%= javascript_include_tag "application" %>`

我经营这个网站，他们都指

“mysyte/javascript/application.js”和“mysite/stylesheets/application.css”

所以，问题是，我如何配置应用程序，以便在我预编译我的资产时将它们放在“/public/javascript”、“/public/stylesheets”和“/public/images”中

提前致谢。

编辑：

我想真正的问题是在生产中使用以下标签

`<%= stylesheet_link_tag "application", :media => "all" %>` 指的是“www.mydomain.com/javascript/application.js”

我如何将其更改为引用“www.mydomain.com/assets/application.js”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:11:14.090

我已经解决了这个，

问题是我在我的应用程序上使用 mongoid，并且必须在我的 application.rb 中删除 active_record

我删除`require "rails/all"` 并更改了我添加

```
require "action_controller/railtie"
require "action_mailer/railtie"
require "active_resource/railtie"
require "rails/test_unit/railtie" 
```

我失踪了

```
require "sprockets/railtie" 
```

现在我的应用程序正在正确的资产文件夹中搜索资产。

感谢 Richlewis 和 deefour 抽出宝贵时间。

# javascript - 客户端需要 Cookies 值，Httponly 属性为 true

> ID：13646014
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:24.323
> 
> 标签：javascript, gwt, session-cookies, httponly

我们`httpOnly`在 web.xml 文件中设置参数 true 以防止在客户端创建 cookie。这导致读取 cookie 值。我们使用以下方式读取 GWT 中的 JSESSIONID cookie。

```
Cookie.getCookie("JSESSIONID"); 
```

这返回未定义。如果我删除`Httponly=true`web.xml 中的属性，它的工作正常并返回一个 cookie。

任何人都可以建议一种使用 HttpOnly true 获取 cookie JSESSIONID cookie 的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:05:06.750

`HttpOnly`不是你想的那样。它的唯一目的是告诉浏览器明确**不要**将 cookie 暴露给脚本，而只在 HTTP 级别使用它。

没有什么可以阻止客户端伪造 cookie。有几种方法可以通过所谓的*会话固定*攻击来防止跨站点请求伪造 (CSRF)，但`HttpOnly`不是其中之一。`HttpOnly`有助于跨站点脚本 (XSS)，因此如果页面包含恶意的第 3 方脚本，它无法读取 cookie 以将其发送到第 3 方服务器——可能稍后将其用于*会话固定*攻击，但是只有当您的网站容易受到攻击时，才有可能这样做——。

# eclipse - 跨平台应用 IBM Worklight

> ID：13646016
> 
> 赞同：1
> 
> 时间：2012-11-30T13:15:30.430
> 
> 标签：eclipse, cross-platform, ibm-mobilefirst

我正在使用 IBM Worklight MEAP 开发跨平台应用程序，但是在构建项目时出现以下错误

[2012-11-30 18:31:47] iphone 构建失败：com.worklight.builder.exception.WorklightBuildRuntimeException：资源管理器 - 读取 info.plist 文件/Users/ipcmac/Documents/workspace_IndigoNew/MYNew/apps/NewApp/ 时出现问题iphone/native/MYNewNewAppIphone-Info.plist（没有这样的文件或目录）嵌套异常：/Users/ipcmac/Documents/workspace_IndigoNew/MYNew/apps/NewApp/iphone/native/MYNewNewAppIphone-Info.plist（没有这样的文件或目录）

[2012-11-30 18:32:20] android 构建失败：com.worklight.builder.exception.WorklightBuildRuntimeException：资源管理器 - 读取 XML 文件时出错：/Users/ipcmac/Documents/workspace_IndigoNew/MYNew/apps/NewApp/ android/native/AndroidManifest.xml（没有这样的文件或目录）嵌套异常：/Users/ipcmac/Documents/workspace_IndigoNew/MYNew/apps/NewApp/android/native/AndroidManifest.xml（没有这样的文件或目录）[2012-11 -30 18:32:20] 发生核心 Eclipse 异常：无法从位置“/Users/ipcmac/Documents/workspace_IndigoNew/MYNew/apps/NewApp/android/native/.project”读取项目描述文件。

所以有人有解决方案吗？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T07:35:46.643

尝试删除 iPhone 和 Android 下的本机文件夹并重建。

# jquery-mobile - 在 iPhone 上的 jQueryMobile 中将输入字段中的文本居中

> ID：13646019
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:45.017
> 
> 标签：jquery-mobile

因此，如果您查看[jsfiddle](http://jsfiddle.net/jb8Jx/)（为了保持一致性，我在下面发布了代码），您将看到输入文本居中。但是，如果我在我的 iPhone（iOS5）上访问 jsfiddle（以及我的测试站点），则文本只是左对齐。所以，我想知道你们是否知道这是一个已知的问题（谷歌搜索 - 似乎不是）并且您知道解决方法。

CSS：

```
.centerText{
    text-align: center;
}​ 
```

js：

```
$(document).ready(function(){
    $( "#popupLogin" ).popup( "open" );            
});​ 
```

html:

```
<!DOCTYPE html>
<html>
<head>
    <title>test</title>
</head>
<body>    
    <section id="home" data-role="page">
        <header data-role="header">
            <h1>test page</h1>
        </header>

        <div data-role="popup" id="popupLogin" data-theme="a" class="ui-corner-all">
            <h3 class="centerText">Register free!</h3>
            <div class="popup">
                <form>                
                      <input type="email" name="email" id="email" class="centerText" placeholder="email" data-theme="a"/>
                      <button type="submit" data-theme="b">Sign me up</button>

                      <p class="centerText">
                          text1<br/>
                          text2<br/>
                          etc...<br/>
                      </p>                
                </form>
            </div>
        </div>        
    </section>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:32:18.383

这里对您的 jsFiddle 进行了一些修改：http: [//jsfiddle.net/Twisty/jb8Jx/2/](http://jsfiddle.net/Twisty/jb8Jx/2/)只是向您展示了一些尝试移动占位符的方法。

**HTML**

```
<!DOCTYPE html>
<html>
<head>
    <title>test</title>
</head>
<body>    
    <section id="home" data-role="page">
        <header data-role="header">
            <h1>test page</h1>
        </header>
        <div data-role="content">
                <label>Left Align</label><input type="text" placeholder="email" class="leftText">
            <label>Right Align</label><input type="text" placeholder="email" class="rightText">
            <label>Center Text</label><input type="text" placeholder="email" class="centerText">
            <label>Pad Left</label><input type="text" placeholder="email" class="leftPadText">
            </div>
        <div data-role="popup" id="popupLogin" data-theme="a" class="ui-corner-all">
            <h3 class="centerText">Register free!</h3>

            <div class="popup">
                <form>                
                      <input type="email" name="email" id="email" class="centerText" placeholder="email" data-theme="a" style="text-align: center;"/>
                      <button type="submit" data-theme="b">Sign me up</button>

                      <p class="centerText">
                          text1<br/>
                          text2<br/>
                          etc...<br/>
                      </p>                
                </form>
            </div>
        </div>        
    </section>
    </body>
</html> 
```

**CSS**

```
input.centerText{
    text-align: center;
}

input.leftText {
    text-align: left;
}

input.rightText {
    text-align: right;
}

input.leftPadText {
    padding-left: 220px;
} 
```

# xna - 动态加载的 texture2D 和不同的表面格式

> ID：13646023
> 
> 赞同：3
> 
> 时间：2012-11-30T13:15:52.277
> 
> 标签：xna

有谁知道在 XNA 中是否可以从 jpg 文件**动态**加载位图并使用其他表面格式绘制 texture2d`SurfaceFormat.Color`吗？

由于内存/速度限制，我需要使用`Bgr565`或`Dxt surface`格式化。我可以使用内容管道并将内容处理器、纹理格式设置为 DxtCompressed，但`Content.Load`不允许动态纹理加载。

我可以使用`Texture2D.FromStream`，但它只创建`SurfaceFormat.Color`纹理。我尝试以所需的表面格式创建空的 Texture2D，并尝试使用手动设置位图数据，`SetData`但这似乎是一种过于复杂的方式。

是否存在`Texture2D.FromStream`并且`Texture2D.SetData`唯一的方法来动态加载 jpg 文件并将它们用作`Bgr565`或`Dxt`表面格式纹理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-01T12:34:09.933

还没有使用 SurfaceFormat 加载的解决方案。但是您可以加载它们并将它们绘制到具有所需格式的渲染目标，然后将纹理数据复制到您创建的具有所需格式的新纹理？

会增加加载时间，但应该允许您正在寻找的加速执行？

# ruby-on-rails - 在 Rails 2 中更改模式

> ID：13646024
> 
> 赞同：0
> 
> 时间：2012-11-30T13:15:54.860
> 
> 标签：ruby-on-rails, rails-migrations

我需要在我的架构中的表中添加一些列。有人能告诉我最好的方法吗？

以下内容似乎不完整或错误，因为 schema.rb 文件未更新以包含新列，并且所有相应的视图文件（编辑、索引、新建、显示）未更新以包含新列。更不用说生成的所有迁移类的膨胀了。谢谢

```
ruby script/generate migration RecordLabelToAlbums record_label:string
      exists  db/migrate
      create  db/migrate/20121130125859_record_label_to_albums.rb 
```

创建这个：

```
class RecordLabelToAlbums < ActiveRecord::Migration
def self.up
end

def self.down
 end
end 
```

然后我添加了这个：

```
class RecordLabelToAlbums < ActiveRecord::Migration
def self.up
   add_column :albums, :record_label, :text
end

def self.down
   remove_column :albums, :record_label
end

end 
```

我跑了：

```
rake db:migrate 
```

得到这个：Mysql::Error: 表'albums'已经存在：CREATE TABLE `albums`( `id`int(11) DEFAULT NULL auto_increment PRIMARY KEY, `created_at`datetime, `updated_at`datetime)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:17:27.047

您添加的代码是正确的。

该错误表明，由于某种原因，您的系统似乎认为它尚未运行创建专辑表的原始迁移。迁移的状态（在 Rails 2 中）在名为的数据库中的一个表中指定`schema_migrations`——如果这变得混乱，那么它将尝试重新运行迁移。我不确定是什么导致它感到困惑，但我确实记得在 2008 年我使用 Rails 2.x 时发生过几次。

该表很简单——您可以从 SQL 提示符中查看其中的内容——我认为只是它认为已经运行的迁移的名称。

如果您不介意丢失一些数据，您可以尝试`rake db:rollback`甚至`rake db:reset`回到开始。 `rake db:rollback STEP=2`将回滚最后 2 次迁移。

如果您需要数据，请通过添加一条或多条引用`app/db/migrations`可能已丢失的迁移的新记录来更正表的内容。我认为顺序很重要（Rails 3 中的格式略有变化，我不记得如何）。

任何时候您想添加或更改数据库架构，使用 rails 生成迁移，然后在`rake db:migrate`准备就绪后运行。

只是问：有什么方法可以迁移到 Rails 3。它已经推出多年了，Rails 4 即将推出。如果你不接受打击和升级，你会发现自己陷入了不兼容、弃用、安全和性能问题等等的死水。

# php - 如何在不损失图像质量的情况下从 JPG 中删除 exif？

> ID：13646028
> 
> 赞同：22
> 
> 时间：2012-11-30T13:16:04.320
> 
> 标签：php, thumbnails, imagick

我有一个 PHP 照片共享应用程序，其中用户上传的图像使用 ImageMagick 调整为各种拇指格式。

作为一种看似“聪明”的节省文件大小的方法，我正在从这些拇指中删除 exif 信息，如下所示：

```
$imagick = new Imagick($image);
$imagick->stripImage();
$imagick->writeImage($image); 
```

这行得通。它确实删除了 EXIF 信息，其中 30KB 的拇指可节省 12KB 并变为 18KB。在单个页面上显示许多此类拇指时可显着节省。

然而问题是它工作得有点太好了。与未剥离的版本相比，生成的图像似乎丢失了很多颜色信息并且看起来“平坦”。

根据我迄今为止的研究，我的理论是以下一项或两项是正确的：

*   作为剥离过程的一部分，Imagick 丢弃了基本的颜色配置文件信息
*   Imagick 在保存图像时重新压缩图像，失去质量

不管问题的原因是什么，我都在寻找一种方法来删除 EXIF 信息，使其不会影响图像质量或颜色本身。

这甚至可能吗？

**更新：**

根据 Gerald Schneider 的回答，我尝试在“剥离”图像之前将质量设置强制为 100%：

```
$imagick = new Imagick($image);
$imagick->setCompression(imagick::COMPRESSION_JPEG);
$imagick->setCompressionQuality(100);
$imagick->stripImage();
$imagick->writeImage($image); 
```

不幸的是，问题仍然存在。下面是示例输出，尽管将质量设置为 100%，但图像仍然是扁平的。

![在此处输入图像描述](../Images/a080e8c0c5af25eb1ae8afdc996863ca.png)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-07-07T22:07:41.770

考虑在删除所有其他 EXIF 数据的同时保留 ICC 配置文件（这会导致更丰富的颜色）：

1.  提取 ICC 配置文件
2.  剥离 EXIF 数据和图像配置文件
3.  重新添加 ICC 配置文件

在 PHP + imagick 中：

```
$profiles = $img->getImageProfiles("icc", true);

$img->stripImage();

if(!empty($profiles))
    $img->profileImage("icc", $profiles['icc']); 
```

（重要提示：使用 ImageMagick 3.1.0 测试版，我得到的结果与[文档](http://php.net/manual/en/imagick.getimageprofiles.php)`getImageProfiles()`略有不同。我建议您使用参数，直到您获得一个具有实际配置文件的关联数组。）

对于命令行 ImageMagick：

```
convert image.jpg profile.icm
convert image.jpg -strip -profile profile.icm output.jpg 
```

如果您使用 ImageMagick，图像当然会被重新压缩，但至少颜色保持不变。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T22:12:09.090

在对错误存储的文件头中的 MIME 类型进行了类似更改后，我建议您通过标准工具验证 EXIF 数据的长度，然后使用多字节字符串函数手动“归零”数据。

EXIF 在 JPEG 文件中最多只能是 64KB，但是我不肯定它是否正好是 64KB，所以我会从这个开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-02T04:00:04.773

[GIMP](https://www.gimp.org/)（另一个开源图像编辑器）还允许删除 EXIF、IPTC、XMP、缩略图、ICC（颜色配置文件）等元数据，而不会丢失图像/图片质量。

在 GIMP 中打开图像后，选择“导出”/“导出为”等选项，然后选择/取消选择要删除/保留的元数据。

要保持原始图像质量，您必须选择（勾选）选项“**使用原始图像的质量设置**”，该选项显示在顶部的“质量”滑动条下方。

我通常喜欢选择 ICC（保存颜色配置文件元数据）选项，以保持良好的颜色质量，并带有彩色照片。
其他选项（保存 EXIF、保存 IPTC、保存 XMP、保存缩略图等）我通常会取消选择。

更多信息：[这里](https://photo.stackexchange.com/a/104485/97316)。

# .net - 列出 MVC 路由的工具 - Visual Studio Express

> ID：13646034
> 
> 赞同：12
> 
> 时间：2012-11-30T13:16:34.113
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-routing, visual-studio-express

我正在学习 .NET MVC，而我正在构建的应用程序变得更像意大利面条。在我的代码中，我在不同的控制器中有许多动作，这些动作自然都会产生各种视图和局部视图。更糟糕的是，我有 @Html.Action 命令，这又增加了一层混乱。其中一些是默认脚手架操作遗留下来的。

是否有任何工具可以生成我网站中所有可能路线的列表以及它们返回的视图？

我还想找到所有未使用的视图和没有视图的操作，并通常正确地重构所有内容。像这样的东西（请不要评论这个具体的例子）：

```
Route               Views returned
------------------------------------------
/User/Edit          /User/Edit.cshtml
/Admin/User/Edit    /User/Edit.cshtml
... 
```

这样的事情存在吗？可以用 .tt 模板完成吗？

或者也许我的整个方法是错误的..！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-30T13:30:15.210

这些也许可以帮助您：

*   [Mvc 路由可视化工具](http://mvcroutevisualizer.codeplex.com/)（Visual Studio 扩展）
*   [路由调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)（也作为[nuget 包](http://nuget.org/packages/routedebugger)提供）
*   [一瞥](http://getglimpse.com/)

我还没有测试过*Mvc Route Visualizer*，但它似乎可以满足你的要求。

**编辑：**

也许这对你更有效。它不会显示返回的视图，但它至少会显示所有控制器和操作：

1.  将[MvcCodeRouting](http://mvccoderouting.codeplex.com/) nuget 包添加到您的项目中。
2.  转到注册路由的方法。
3.  之后`routes.IgnoreRoute("{resource}.axd/{*pathInfo}");`，添加以下代码行：

    ```
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    // If you don't have "HomeController", choose another controller you have.
    // MvcCodeRouting will look for all controllers in the same namespace and sub-namespaces as the one specified here.
    routes.MapCodeRoutes(typeof(HomeController), new CodeRoutingSettings
    {
        UseImplicitIdToken = true
    });

    // Other, existing, routes here... 
    ```

4.  构建并运行应用程序。

5.  转到**[http://yoururl.com/routes.axd](http://yoururl.com/routes.axd)**查看所有创建的路由，它们将包含所有操作。
6.  如果你已经安装了 Route Debugger，你可以在那里看到它们：

    ![Route Debugger screenshot](../Images/e581ff8844a89b421af46ea93a7a6a72.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:31:05.537

Yes you can use **Asp .Net MVC MiniProfiler.**

Here are the some **great links** for that

**[Miniprofiler Home](http://miniprofiler.com/)**

**[Scott Hanselman Blog](http://www.hanselman.com/blog/NuGetPackageOfTheWeek9ASPNETMiniProfilerFromStackExchangeRocksYourWorld.aspx)**

**[Sam Saffron Blog](http://samsaffron.com/archive/2011/07/25/Automatically+instrumenting+an+MVC3+app)**

***Here is a screenshot of the MiniProfiler :***

![enter image description here](../Images/c3f4ebeddc47272e0fcd0d612c229c4e.png) Hope this will help you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:31:29.563

Route debugger by Phil Haack may help you

[ASP.NET Routing Debugger](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

[RouteDebugger 2.0](http://haacked.com/archive/2011/04/12/routedebugger-2.aspx)

# python - 安装脚本和包位于不同的位置

> ID：13646036
> 
> 赞同：0
> 
> 时间：2012-11-30T13:16:38.987
> 
> 标签：python, setuptools

我正在使用 setuptools 0.6 来打包我的代码。默认情况下，当我键入 python setup.py sdist 时，脚本必须在包的同一文件夹中。如果我的安装脚本和我的包文件夹不在同一个文件夹中，我该怎么做才能指定包的确切路径？谢谢

# mocking - rhino-mocks stub 和 expect 有什么区别

> ID：13646038
> 
> 赞同：16
> 
> 时间：2012-11-30T13:16:45.003
> 
> 标签：mocking, rhino-mocks, stub, stubbing, expectations

rhino-mocks stub 和 expect 之间有什么区别：在我看来，它们的行为完全相同？

```
mockContext.Stub(x => x.Find<Blog>())
    .Return(new List<Blog>() 
    { 
        new Blog() { Id = 1, Title = "Test" } 
    }.AsQueryable());

mockContext.Expect(x => x.Find<Blog>())
    .Return(new List<Blog>()
    {
        new Blog(){Id = 1,Title = "Title"},
        new Blog(){Id=2,Title = "no"}
    }.AsQueryable()); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-02T09:12:38.260

`Stub()`定义存根对象**的行为**。
`Expect()`定义模拟对象**的行为**和**期望**。

因此，如果您需要检查是否调用了模拟方法，您应该使用`Expect`：

```
var mockContext = MockRepository.GenerateMock<IContext>();
mockContext.Expect(x => x.Find<Blog>()).Return(new List<Blog>()); 
```

现在，在*测试操作*完成后，您可以验证是否满足预期：

```
mockContext.VerifyAllExpectations(); 
```

如果您需要存根方法行为，您可以使用`Stub()`：

```
var mockContext = MockRepository.GenerateStub<IContext>();
mockContext.Stub(x => x.Find<Blog>()).Return(new List<Blog>()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-06T11:42:29.457

当你在这种情况下对一个方法使用Expect时x.Find()，如果你的方法在测试期间没有被调用mockContext.VerifyAllExpectations(); 将失败。

# java - 延迟加载关联未正确初始化子关联

> ID：13646041
> 
> 赞同：0
> 
> 时间：2012-11-30T13:16:55.197
> 
> 标签：java, hibernate, jpa, hibernate-mapping

我有以下实体：

```
@Entity
public class Foo {
    @ManyToOne(optional = false) // I've tried @OneToOne also, same result
    @JoinColumn(name = "bar_id")
    private Bar bar;

    // this is a business key, though not mapped as unique for legacy reasons
    @Column(nullable = false)
    private long fooNo; 

    // getters/setters + other properties
}

@Entity
public class Bar {
    @OneToOne(optional = true, mappedBy = "bar", cascade = CascadeType.ALL)
    private Foo foo;

    // getters/setters + other properties
} 
```

**注意：**这是正确的映射：@ManyToOne 和 @OneToOne（不是我设计的）。我也在双方都尝试过@OneToOne，结果相同。

基本上，我可以有一个没有 Foo 对象的 Bar，但是每次我有一个 Foo 时，都必须有一个与之关联的 Bar。Foo 被认为是父对象（这就是为什么它是关联的所有者），但 Bar 在某些情况下可以独立存在。

然后我加载一个`Foo`像这样的对象：

```
SELECT f FROM Foo f WHERE f.fooNo = :fooNo 
```

`foo.getBar()``Bar`正如预期的那样，正确地获取适当的 。然而，`foo.getBar().getFoo()`是`null`。这种关系的另一面似乎没有被 JPA/hibernate 正确初始化。任何想法为什么会发生这种情况以及我该如何解决？

我使用 Hibernate 3.2.1 作为我的 JPA 实现，我们通过 EJB3 bean 使用它（尽管这可能无关紧要）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:30:04.263

你确定你的协会吗？ManyToOne 通常意味着 oneToMany 对其他。

# symfony - nginx 会缓存我的响应吗？

> ID：13646047
> 
> 赞同：0
> 
> 时间：2012-11-30T13:17:13.680
> 
> 标签：symfony, nginx, symfony-2.1

我正在使用 Symfony2 和 nginx 作为 http 服务器（我对反向代理了解不多，我只是安装它并没有接触任何东西），没有 Apache 也没有 Varnish。

我需要知道 nginx 是否正在缓存我发送的带有正确标头的响应，例如 public、max-age 和 s-max-age，或者我必须向堆栈添加其他内容，例如 Varnish。

我在某处读到，如果添加 Varnish，则必须添加其他内容以进行 gzip 压缩。所以它会是 nginx -> Varnish -> ???

那么nginx缓存呢？我该如何检查？我`grep cache`在 nginx 日志上做了，什么也没找到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:20:06.677

要使用 nginx 缓存，您应该对其进行配置。

*   [http://nginx.org/r/fastcgi_cache_path](http://nginx.org/r/fastcgi_cache_path)
*   [http://nginx.org/r/proxy_cache_path](http://nginx.org/r/proxy_cache_path)

[除非需要 ESI，否则您不需要 Varnish。](http://todsul.com/nginx-varnish)

# ruby-on-rails - Rspec：没有路由匹配 {:action=>"show", :controller=>"posts", :id=>nil}

> ID：13646051
> 
> 赞同：1
> 
> 时间：2012-11-30T13:17:23.163
> 
> 标签：ruby-on-rails, rspec, tdd

我正在尝试使用 Rails 创建一个非常简单的博客，用于我自己的教育。这是我创建的第一个 Rails 应用程序，而不是通过教程工作。

到目前为止，我只有一个非常简单的模型，其中每个帖子只有一个标题字符串和一个内容字符串。在浏览器中一切正常且符合预期，但我无法通过测试。

这是我的 Rspec 代码 (spec/requests/post_spec.rb) 中的失败测试：

```
require 'spec_helper'

describe "Posts" do

  .
  .
  .

  describe "viewing a single post" do

    @post = Post.create(title: "The title", content: "The content")

    before { visit post_path(@post) }

    it { should have_selector('title',    text: @post.title) }
    it { should have_selector('h1',       text: @post.title) }
    it { should have_selector('div.post', text: @post.content) }

  end

end 
```

这给了我所有 3 个相同的错误消息：

```
Failure/Error: before { visit post_path(@post) }
     ActionController::RoutingError:
       No route matches {:action=>"show", :controller=>"posts", :id=>nil} 
```

所以在我看来，问题在于 @post = Post.create(...) 行正在创建一个没有 id 的帖子，或者它没有正确地将帖子保存到测试数据库中。我该如何解决？我是否首先以正确的方式解决这个问题，还是有更好的方法可以创建测试帖子/测试页面？

这只是测试中的一个问题。当我在浏览器中查看单个帖子时，一切看起来都很好。Posts 控制器是：（自发布原始问题以来，我已对其进行了编辑）

```
class PostsController < ApplicationController
  def new
    @post = Post.new
  end

  def create
    @post = Post.new(params[:post])
    if @post.save
      redirect_to posts_path, :notice => "Post successfully created!"
    end
  end

  def index
  end

  def show
    @post = Post.find(params[:id])
  end
end 
```

这是整个 Post 模型：

```
class Post < ActiveRecord::Base
  attr_accessible :content, :title

  validates :content, presence: true
  validates :title,   presence: true
end 
```

配置/路线：

```
Blog::Application.routes.draw do
    resources :posts

    root to: 'posts#index'
end 
```

应用程序/views/posts/show.html.erb：

```
<% provide(:title, @post.title) %>

<h1><%= @post.title %></h1>

<div class="post"><%= @post.content %></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T17:05:22.463

您的实例变量需要进入 before 块。（测试试图转到 /posts/:id/show 和 params[:id] 在这种情况下是 nil，因为 @post 尚未创建）

尝试：

```
before do
    @post = Post.create(title: "The title", content: "The content") 
    visit post_path(@post)
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:52:40.850

好的，看来您的 new 和 create 操作是空的？尝试

```
def new
@post =Post.new
end

def create
@post = Post.new(params[:post])
if @post.save
  redirect_to posts_path, :notice => " Post successfully created."
end
end 
```

然后你的新观点需要有一个 form_for @post

没有这个你不能创建一个新帖子，只有当这个成功时，你的帖子才会被分配 id

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T15:18:15.327

你需要把你的“之前”的东西放在测试之外吗？这对我有用：

```
require 'spec_helper'
describe "Posts" do

  before(:each) do 
    @post = Post.create(title: "The title", content: "The content")    
  end

  describe "viewing a single post" do
    it "should show the post details" do
      get post_path(@post) 
      response.status.should be(200)
      # do other tests here .. 
    end
  end
end 
```

# php - 如何删除特殊/重音字符和带数字的单词？

> ID：13646057
> 
> 赞同：1
> 
> 时间：2012-11-30T13:17:32.250
> 
> 标签：php, regex

我正在尝试创建蛞蝓。我的字符串是这样的：`$string='möbel#*-jérôme-mp3-how?';`

**第1步**

首先，我想从此字符串中删除特殊字符、非字母数字和非拉丁字符。

像这样：`$string='möbel-jérôme-mp3-how';`

以前，我曾经在字符串中只有英文字符。

所以，我曾经这样做：`$string = preg_replace("([^a-z0-9])", "-", $string);`

但是，由于我也想保留外来字符，所以这是行不通的。

**第2步**

然后，我想删除所有包含一个或多个数字的单词。

在这个示例字符串中，我想删除单词 mp3，因为它包含一个或多个数字。

因此，最终的字符串如下所示：`$string='möbel-jérôme-how';`

我曾经这样做过：

```
$words = explode('-',$string);
$result = array();

foreach($words as $word) 
{
if( ($word ==preg_replace("([^a-z])", "-", $word)) && strlen($word)>2)  
$result[]=$word;
}
$string = implode(' ',$result); 
```

这现在不起作用，因为它包含外来字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:27:26.263

在 PHP 中，您可以访问 Unicode 属性：

```
$result = preg_replace('/[^\p{L}\p{N}-]+/u', '', $subject); 
```

将为您执行第 1 步。（`\p{L}`匹配任何 Unicode 字母，`\p{N}`匹配任何 Unicode 数字）。

删除带数字的单词同样简单：

```
$result2 = preg_replace('/\b\w*\d\w*\b-?/', '', $result); 
```

（`\b`匹配单词的开头和结尾）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T13:36:32.643

如果您实际上是在为链接做 slug，我强烈建议您音译 unicode 字符。您可以使用[PHP 的 iconv](http://www.php.net/manual/en/function.iconv.php)来实现。

* * *

类似的问题[在这里](https://stackoverflow.com/questions/10315560/regex-to-delete-words-with-numbers)。我认为，票数最高的答案的独创性和简单性很棒:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:26:25.070

我建议分多个步骤执行此操作：

1.  创建一串允许的字符（全部），并通过仅保留它们来遍历字符串。（这需要一些时间，但这是一次性的）

2.  做一个爆炸`-`并浏览所有的单词，只保留那些不包含数字的单词。然后再次内爆。

我相信，你可以从现在开始自己编写脚本。

# c# - 仅使用正则表达式 C#删除标签

> ID：13646063
> 
> 赞同：-2
> 
> 时间：2012-11-30T13:17:58.717
> 
> 标签：c#, .net, html, regex

我只想删除类为“邻居”的跨度标签。而且我不想删除其余的跨度标签。我只想使用正则表达式，我别无选择。

```
 <span class="latitude">34.008253</span>
  <span class="longitude">-118.414593</span>     
  <span class="neighborhood">Neighborhood: Clarkdale</span> 
```

请帮帮我。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:23:50.593

试试这个：

```
@"<span class=""neighborhood"">[^<]*</span>" 
```

假设在 span 之前没有关闭其他标签，这将起作用。此外，HTML 允许大量空白，因此您可能需要对其进行调整。

# java - 我如何在android中使用画布画一条线？

> ID：13646072
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:18:46.043
> 
> 标签：java, android

我想在 android 的 ontouch 事件中使用画布画一条线。

这是我的代码：

```
switch (event.getAction()) {
    case MotionEvent.ACTION_DOWN:
        mPath.reset();
        mPath.moveTo(x, y);
        mX = x;
        mY = y;
        invalidate();
    break;
    case MotionEvent.ACTION_MOVE:
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
            mPath.quadTo(mX, mY, (x + mX)/2, (y + mY)/2);
            mX = x;
            mY = y;
        }
        invalidate();
    break;
    case MotionEvent.ACTION_UP:
        mPath.lineTo(mX, mY);
        mCanvas.drawPath(mPath, mPaint);
        mPath = new Path();
        paths.add(mPath);
        mPath.reset();
        invalidate();
    break;
} 
```

但是当我将手指从鼠标按钮上移开时，这条线出现了，这意味着这条线只出现在`touchesup`动作中。我想像徒手画一样画一条线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:25:26.433

仅当您执行操作时才调用 drawPath。因此，如果您将 drawPath 复制到所有案例，则应该可以

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:26:02.603

在您的`MotionEvent.ACTION_UP`事件处理代码中，您`mCanvas.drawPath(mPath, mPaint);`用来画线。

在其他事件处理代码部分（`MotionEvent.ACTION_MOVE`和`MotionEvent.ACTION_DOWN`）中添加这行代码，它也会更早地绘制该行。

# c# - 递归搜索字符串中的模式

> ID：13646077
> 
> 赞同：7
> 
> 时间：2012-11-30T13:19:06.983
> 
> 标签：c#, string

我正在使用 c#。我有以下字符串

```
<li> 
    <a href="abc">P1</a> 
    <ul>
        <li><a href = "bcd">P11</a></li>
        <li><a href = "bcd">P12</a></li>
        <li><a href = "bcd">P13</a></li>
        <li><a href = "bcd">P14</a></li>
    </ul>
</li>
<li> 
    <a href="abc">P2</a> 
    <ul>
        <li><a href = "bcd">P21</a></li>
        <li><a href = "bcd">P22</a></li>
        <li><a href = "bcd">P23</a></li>
    </ul>
</li>
<li> 
    <a href="abc">P3</a> 
    <ul>
        <li><a href = "bcd">P31</a></li>
        <li><a href = "bcd">P32</a></li>
        <li><a href = "bcd">P33</a></li>
        <li><a href = "bcd">P34</a></li>
    </ul>
</li>
<li> 
    <a href="abc">P4</a> 
    <ul>
        <li><a href = "bcd">P41</a></li>
        <li><a href = "bcd">P42</a></li>
    </ul>
</li> 
```

我的目标是从上面的字符串中填写以下列表。

```
List<class1> 
```

class1 有两个属性，

```
string parent;
List<string> children; 
```

它应该在 parent 中填写 P1，在 children 中填写 P11,P12,P13,P14，并列出它们。

任何建议都会有所帮助。

**编辑**

样本

```
public List<class1> getElements()
{
    List<class1> temp = new List<class1>();
    foreach(// <a> element in string)
    {
        //in the recursive loop
        List<string> str = new List<string>();
        str.add("P11");
        str.add("P12");
        str.add("P13");
        str.add("P14");

        class1 obj = new class1("P1",str);
        temp.add(obj);
    }
    return temp;
} 
```

这些值在这里是硬编码的，但它是动态的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:05:03.000

你想要的是一个递归下降解析器。使用库的所有其他建议基本上都是建议您对他人编写的 HTML 或 XML 使用递归下降解析器。

递归下降解析器的基本结构是对令牌列表（在您的情况下为字符串）进行线性搜索，并在遇到分隔子实体的令牌时再次调用解析器以处理令牌子列表（子字符串）。

你可以谷歌搜索“递归下降解析器”这个词，并找到很多有用的结果。在这种情况下，即使是 Wikipedia 文章也相当不错，并且包含 C 中递归下降解析器的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T14:07:08.477

如果你不能像我推荐的那样使用第三方工具，[**`Html Agility Pack`**](http://htmlagilitypack.codeplex.com/)你可以使用 [`Webbrowser`](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)类和[`HtmlDocument`](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.aspx)类来解析 HTML：

```
WebBrowser wbc = new WebBrowser();
wbc.DocumentText = "foo"; // necessary to create the document
HtmlDocument doc = wbc.Document.OpenNew(true);
doc.Write((string)html); // insert your html-string here
List<class1> elements = wbc.Document.GetElementsByTagName("li").Cast<HtmlElement>()
    .Where(li => li.Children.Count == 2)
    .Select(outerLi => new class1
    {
        parent = outerLi.FirstChild.InnerText,
        children = outerLi.Children.Cast<HtmlElement>()
            .Last().Children.Cast<HtmlElement>()
            .Select(innerLi => innerLi.FirstChild.InnerText).ToList()
    }).ToList(); 
```

这是调试器窗口中的结果：

![在此处输入图像描述](../Images/7a423833b9b5e1bee129636c1e72427e.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:27:16.030

您还可以使用 XmlDocument：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(yourInputString);
XmlNodeList colNodes = xmlSource.SelectNodes("li");
foreach (XmlNode node in colNodes)
{
    // ... your logic here
    // for example
    // string parentName = node.SelectSingleNode("a").InnerText;
    // string parentHref = node.SelectSingleNode("a").Attribures["href"].Value;
    // XmlNodeList children = 
    //       node.SelectSingleNode("ul").SelectNodes("li");
    // foreach (XmlNode child in children)
    // {
    //         ......
    // }
} 
```

# c# - 我想获取节点中选择的子节点的计数，包括子目录

> ID：13646079
> 
> 赞同：0
> 
> 时间：2012-11-30T13:19:14.030
> 
> 标签：c#, treeview

我有递归程序来添加节点 t 树视图，但我希望有自下而上的方法来做到这一点。

到目前为止我已经这样做了，但它不起作用

```
private void TreeviewCountCheckedNodes(TreeNodeCollection treeNodeCollection)
{
    TreeNode node = treeNodeCollection[0];
    int countchecked = 0;
    if (node != null)
    {
        foreach (TreeNode childnode in node.Nodes)
        {
            if (childnode.Nodes.Count == 0 && childnode.Checked)
            {
                countchecked++;
            }
            else if (childnode.Nodes.Count > 0)
            {
                TreeviewCountCheckedNodes(childnode.Nodes);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:08:40.017

```
private int TreeviewCountCheckedNodes(TreeNodeCollection treeNodeCollection)
        {
            int countchecked = 0;
            if (treeNodeCollection != null)
            {
                foreach (TreeNode node in treeNodeCollection)
                {
                    if (node.Nodes.Count == 0 && node.Checked)
                    {
                        countchecked++;
                    }
                    else if (node.Nodes.Count > 0)
                    {
                        countchecked += TreeviewCountCheckedNodes(node.Nodes);
                    }
                }
            }
            return countchecked;
        } 
```

称呼：

```
int coount = TreeviewCountCheckedNodes(treeView.Nodes); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-21T09:07:39.873

我在这里发布此代码，认为它可能对某人有所帮助。

该代码检索树视图中所有检查节点的计数。

```
int checkedNodesCount = 0;

private int GetCheckedNodesCount(TreeNodeCollection treeNodeCollection)
    {

        TreeNode node = treeNodeCollection[0];

        if (node != null)
        {
            if (node.Nodes.Count > 0)
            {
                foreach (TreeNode childnode in node.Nodes)
                {
                    if (childnode.Nodes.Count == 0 && childnode.Checked)
                    {
                        checkedNodesCount++;
                    }
                    else if (childnode.Nodes.Count > 0)
                    {
                        checkedNodesCount += GetCheckedNodesCount(childnode.Nodes);
                    }
                }
            }
            else
            {
                if (node.Checked)
                {
                    checkedNodesCount++;
                }
            }
        }
        return checkedNodesCount;
    } 
```

# vb.net - 如何扩展此重新着色功能？

> ID：13646086
> 
> 赞同：1
> 
> 时间：2012-11-30T13:19:47.113
> 
> 标签：vb.net, visual-studio-2010, scrollbar

我创建了一个重新着色功能来重新着色我的图片框，

我的功能是红色的，它把一切都变成红色。

但现在我想输入一些滚动条功能来控制它。

如果我想要 3 个代表 R、G、B 的滚动条

我该如何根据我当前的功能做到这一点？

```
 Try
        ' Retrieve the image.
        image1 = New Bitmap("C:\Users\Anons\Desktop\Winter.jpg", True)

        Dim x, y As Integer

        ' Loop through the images pixels to reset color.
        For x = 0 To image1.Width - 1
            For y = 0 To image1.Height - 1
                Dim pixelColor As Color = image1.GetPixel(x, y)
                Dim newColor As Color = _
                    Color.FromArgb(pixelColor.R, 0, 0)
                image1.SetPixel(x, y, newColor)
            Next
        Next

        ' Set the PictureBox to display the image.
        PictureBox1.Image = image1

        ' Display the pixel format in Label1.
        Label1.Text = "Pixel format: " + image1.PixelFormat.ToString()

    Catch ex As ArgumentException
        MessageBox.Show("There was an error." _
            & "Check the path to the image file.")
    End Try
End Sub$ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:26:12.420

您只需将所有三个颜色分量（R、G 和 B）乘以由滚动条确定的分数因子。例如，因子 1 将使其保持相同的颜色。0.5 的系数会使颜色亮度减半。2 倍的亮度会使亮度增加一倍，以此类推。

```
Dim rFactor As Single = rScroll.Value / 100
Dim gFactor As Single = gScroll.Value / 100
Dim bFactor As Single = bScroll.Value / 100
Dim newColor As Color = Color.FromArgb(pixelColor.R * rFactor, pixelColor.R * gFactor, pixelColor.B * bFactor) 
```

# routes - Umbraco 4.10 + 扩展 Global.ascx

> ID：13646093
> 
> 赞同：3
> 
> 时间：2012-11-30T13:20:06.823
> 
> 标签：routes, umbraco, global-asax, extend

有谁知道如何在 umbraco 4.10 以后扩展 Global.ascx？我想将自定义路由注册到我的应用程序。

我已将代码添加到 global.ascx 并继承如下：

```
 public class Global : Umbraco.Web.UmbracoApplication
{

    protected override void OnApplicationStarting(object sender, EventArgs e)
    {
        base.OnApplicationStarting(sender, e);

    }

    //protected void Application_Start(object sender, EventArgs e)
    //{

    //}..... 
```

如果我理解错误并且您不能扩展 global.ascx 文件，请更正。

编辑：我知道你可以用 config 做到这一点，但我认为在 global.ascx 中做未来复杂的路由会更好。

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T09:26:55.307

你肯定走在正确的道路上。您可以按照与通常情况类似的方式执行此操作：

```
protected override void OnApplicationStarted(object sender, EventArgs e)
{
    base.OnApplicationStarted(sender, e);

    RegisterRoutes(RouteTable.Routes);

}

public static void RegisterRoutes(RouteCollection routes)
{
    routes.MapRoute("SitemapXml", "sitemap.xml", new { controller = 
        "SitemapSurface", action = "XmlSitemap" });
} 
```

# sql - 尝试从 SQL 查询中提取列名

> ID：13646094
> 
> 赞同：2
> 
> 时间：2012-11-30T13:20:07.353
> 
> 标签：sql, regex, perl

我有一组非常庞大且令人讨厌的查询，我想从中提取列名，它们都将采用以下格式`<table>.<column>`

我是正则表达式的新手，似乎看不到我的模式匹配失败的地方，它不会返回任何东西。

```
# Read file in and parse out all column names, they must be of the
# form <table>.<column> 
$data_file="C:\\VW_DEP_MTHLY_PROJTD_UNPROJTD_STK_FACT.sql";
open SQL_FILE, $data_file or die "Could not open file: $data_file";

while (<SQL_FILE>) {
    if((/ \w+\.\w+/)) {
        print $1;
    }
}

close SQL_FILE; 
```

您可以像这样想象部分查询：

```
 SELECT PHARMACY_FACT.REC_TYP_ID,
         PHARMACY_FACT.PACK_ID,
         ("VARCHAR"(DATE_PART('YEAR'::"VARCHAR", ASSET.MTHLY_CYC_END_DT)) || LPAD("VARCHAR"(ASSET.IMS_CYC_WK_NBR), 2, '0'::"VARCHAR")) AS IMS_CYC_WK_NBR,
         ASSET.WKLY_CYC_END_DT,
         PHARMACY_FACT.TAX_PCT_RT,
         CASE WHEN ((CASE WHEN (PHARMACY_FACT.INDIR_PUR_AMT NOTNULL) THEN PHARMACY_FACT.INDIR_PUR_AMT WHEN (0 NOTNULL) THEN '0'::"NUMERIC"
    ELSE NULL::"NUMERIC"
    END + CASE WHEN (PHARMACY_FACT.DIR_PUR_AMT NOTNULL) THEN PHARMACY_FACT.DIR_PUR_AMT WHEN (0 NOTNULL) THEN '0'::"NUMERIC"
    ELSE NULL::"NUMERIC"
    END) <> '0'::"NUMERIC") THEN (CASE WHEN (PHARMACY_FACT.INDIR_PUR_AMT NOTNULL) THEN PHARMACY_FACT.INDIR_PUR_AMT WHEN (0 NOTNULL) THEN '0'::"NUMERIC"
    ELSE NULL::"NUMERIC"
    END + CASE WHEN (PHARMACY_FACT.DIR_PUR_AMT NOTNULL) THEN PHARMACY_FACT.DIR_PUR_AMT WHEN (0 NOTNULL) THEN '0'::"NUMERIC"
    ELSE NULL::"NUMERIC"
    END)
    ELSE NULL::"NUMERIC"
    END AS UNPRJ_TOT_PUR_AMT
    ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T15:37:14.257

为了设置 $1，您需要通过将其放在括号中来“捕获”正则表达式的某些部分。

```
while (<SQL_FILE>) {
    if (/ (\w+\.\w+)/) {
        print $1;
    }
} 
```

看起来你在匹配运算符之外而不是在它里面有括号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T13:46:50.353

您的代码只会在每一行中找到第一列名称。您可以用空格分割每一行并解析原语

```
use strict;

my $data_file='/tmp/sosql';
open my $sql_file, $data_file or die "Could not open file: $data_file";

while (my $line = <$sql_file>) {
    foreach my $word (split(/\s/,$line)) {
        if ($word =~ /(\w+\.\w+)/) {
            print $1."\n";
        }
    }
}

close $sql_file; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T14:09:44.533

您必须使用括号捕获组中的列名，并在每一行中的所有列上循环：

```
while (<SQL_FILE>) {
    while(/(\w+\.\w+)/g) {
        print $1,"\n";
    }
} 
```

# sharepoint - SPUserCodeSolutionExecutionFailedException

> ID：13646097
> 
> 赞同：1
> 
> 时间：2012-11-30T13:20:15.883
> 
> 标签：sharepoint, sharepoint-2010, sandbox-solution

我有一个带有 webpart 的简单沙盒解决方案（它通过 Linq 加载数据，但这不是我认为的重点），并且在我的开发机器上一切正常。

当我在另一台机器上安装此解决方案并将 web 部件添加到页面时，出现以下异常。但我不知道为什么以及该怎么做，我认为这与我的解决方案无关，因为我在堆栈跟踪中看不到对我的应用程序的任何引用。

任何想法？

* * *

Web 部件错误：部分信任应用程序域中的沙盒代码包装器的 Execute 方法引发了未处理的异常：发生了意外错误。

[SPUserCodeSolutionExecutionFailedException：部分信任应用程序域中沙盒代码包装器的 Execute 方法引发了未处理的异常：发生了意外错误。]

**服务器堆栈跟踪：**

在 Microsoft.SharePoint.UserCode.SPUserCodeApplicationHostAppDomainRef.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext、Boolean shouldUsageLog、Int32 currentProcessId）

在 Microsoft.SharePoint.UserCode.SPUserCodeApplicationHostAppDomainRef.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext、Boolean shouldUsageLog、Int32 currentProcessId）

在 Microsoft.SharePoint.UserCode.SPUserCodeAppDomain.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext、Boolean shouldUsageLog、Int32 currentProcessId）

在 Microsoft.SharePoint.UserCode.SPUserCodeWorkerProcessProxyForShim.ExecuteInternal（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodeWorkerProcessProxy.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext）

在 System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)

在 System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage（IMessage msg，Int32 methodPtr，布尔 fExecuteInContext）

**在 [0] 处重新抛出异常：**

在 System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage（IMessage reqMsg，IMessage retMsg）

在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke（MessageData& msgData，Int32 类型）

在 Microsoft.SharePoint.UserCode.SPUserCodeWorkerProcess.ExecuteDelegate.EndInvoke（IAsyncResult 结果）

在 Microsoft.SharePoint.UserCode.SPUserCodeWorkerProcess.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、SPUserToken userToken、String currentAffinity、SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodePoolableProcessConnection.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、SPUserToken userToken、字符串关联、SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodeExecutionHost.Execute（类型 userCodeWrapperType，Guid siteCollectionId，SPUserToken userToken，字符串亲和性，SPUserCodeExecutionContext executionContext）

在 System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)

在 System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage（IMessage msg，Int32 methodPtr，布尔 fExecuteInContext）

**在 [1] 处重新抛出异常：**

在 System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage（IMessage reqMsg，IMessage retMsg）

在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke（MessageData& msgData，Int32 类型）

在 Microsoft.SharePoint.Administration.ISPUserCodeExecutionHostProxy.Execute（键入 userCodeWrapperType，Guid siteCollectionId，SPUserToken userToken，字符串 affinityBucketName，SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodeExecutionManager.Execute（键入 userCodeWrapperType，SPSite 站点，SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodeWebPartRemoteExecutionHelper.<>c_ *DisplayClassa.b* _9()

在 Microsoft.SharePoint.Utilities.SecurityContext.RunAsProcess（CodeToRunElevated 安全代码）

在 Microsoft.SharePoint.UserCode.SPUserCodeWebPartRemoteExecutionHelper.ExecuteRequestInSandBox（HttpContext 上下文、SPWeb web、SPWebPartManager 管理器、SPUserCodeWebPart userCodeWebPart）

**[NullReferenceException：对象引用未设置为对象的实例。]**

服务器堆栈跟踪：

在 Microsoft.SharePoint.Utilities.SPThreadContext.get_UserCodeContext()

在 Microsoft.SharePoint.Utilities.SPThreadContext.get_Items()

在 Microsoft.SharePoint.Utilities.SPThreadContext.Get（字符串键）

在 Microsoft.SharePoint.Utilities.SPThreadContext.GetT

在 Microsoft.SharePoint.Library.SPRequest.Dispose（布尔处理）

在 Microsoft.SharePoint.Library.SPRequest.Dispose()

在 Microsoft.SharePoint.SPWeb.InvalidateRequest()

在 Microsoft.SharePoint.SPWeb.Invalidate()

在 Microsoft.SharePoint.SPWeb.Close()

在 Microsoft.SharePoint.SPSite.Close()

在 Microsoft.SharePoint.SPSite.Dispose()

在 Microsoft.SharePoint.SPSite_SubsetProxy.Dispose__Inner()

在 System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)

在 System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage（IMessage msg，Int32 methodPtr，布尔 fExecuteInContext）

**在 [0] 处重新抛出异常：**

在 System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage（IMessage reqMsg，IMessage retMsg）

在 System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke（MessageData& msgData，Int32 类型）

在 Microsoft.SharePoint.SPSite_SubsetProxy.Dispose()

在 Microsoft.SharePoint.SPSite.Dispose__Inner()

在 Microsoft.SharePoint.SPSite.Dispose()

在 Microsoft.SharePoint.UserCode.SPUserCodeWebPartWrapper.Execute（SPUserCodeExecutionContext executionContext）

在 Microsoft.SharePoint.UserCode.SPUserCodeApplicationHostAppDomainRef.ExecuteWrapper（SPUserCodeWrapper 包装器，SPUserCodeExecutionContext executionContext）

在 System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)

在 System.Runtime.Remoting.Messaging.StackBuilderSink.AsyncProcessMessage（IMessage 消息，IMessageSink replySink）

**在 [1] 处重新抛出异常：**

在 System.Runtime.Remoting.Proxies.RealProxy.EndInvokeHelper（消息 reqMsg，布尔 bProxyCase）

在 System.Runtime.Remoting.Proxies.RemotingProxy.Invoke（对象未使用，消息数据和 msgData）

在 Microsoft.SharePoint.UserCode.SPUserCodeApplicationHostAppDomainRef.CodeToExecuteWrapper.EndInvoke（IAsyncResult 结果）

在 Microsoft.SharePoint.UserCode.SPUserCodeApplicationHostAppDomainRef.Execute（类型 userCodeWrapperType、SPUserCodeCachedAssemblyGroup userAssemblyGroup、Guid siteCollectionId、Byte[] binaryUserCodeToken、Byte[] proxyOperationToken、SPUserCodeExecutionContext executionContext、Boolean shouldUsageLog、Int32 currentProcessId）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T23:53:59.647

检查是否启用了沙盒解决方案（相应的服务正在您的服务器上运行）。还要检查您是否真的将此解决方案安装为沙盒，而不是常规安装，反之亦然。

# javascript - jScrollPane 错误，不是函数

> ID：13646100
> 
> 赞同：3
> 
> 时间：2012-11-30T13:20:22.030
> 
> 标签：javascript

我正在尝试使用 jScrollPane 并且总是收到 Javascript 错误“jScrollPane 不是函数”。我的标题看起来像这样

```
... 
<link rel="stylesheet" type="text/css" href="assets/css/jquery.jscrollpane.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Ruda" media="all" />
<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.mousewheel.js"></script>
<script type="text/javascript" src="assets/js/jquery.jscrollpane.min.js"></script>
<script type="text/javascript" src="assets/js/script.js"></script> 
```

script.js 包含这行代码：

```
$(window).load(function() {
    $(function(){ $('.scrollbar').jScrollPane(); });
}); 
```

我的 div 看起来像这样：

```
<div class="scrollbar"><p>...</p></div> 
```

并有以下款式：

```
.scrollbar {
    background: none repeat scroll 0 0 #FFFFFF;
    max-height: 550px;
    overflow: auto;
} 
```

无论我尝试了什么，我都会不断收到此错误并且完全不知道如何让 jScrollpane 正常运行。对此的任何帮助将不胜感激。

# css - 视口底部的侧边栏粘性 div

> ID：13646102
> 
> 赞同：1
> 
> 时间：2012-11-30T13:20:30.127
> 
> 标签：css, footer, sidebar, sticky

我想在屏幕视口/可见区域底部的侧边栏中放置一个 div。正如您在 jsfiddle 中看到的那样，有一个徽标 div、一个导航 div 和侧边栏页脚 div 应该贴在页面底部 - 但如果屏幕太小而无法显示所有元素，导航应该推动页脚下。如果我将页脚绝对定位为底部：0 - 如果可见区域不够大，则导航和页脚重叠。

```
<div id="left">
<div id="branding">Logo</div>
<div id="navigation">Variable height Navi</div>
<div id="sidebar-footer">Fixed Height, Stuck to bottom Footer</div> 
```

小提琴：http: [//jsfiddle.net/marknolan/HvcQW/](http://jsfiddle.net/marknolan/HvcQW/)

实际实现： [http ://contao.marknolan.ch](http://contao.marknolan.ch)

任何帮助appriciated！谢谢

# c# - CsvHelper 没有向内存流写入任何内容

> ID：13646105
> 
> 赞同：59
> 
> 时间：2012-11-30T13:20:34.137
> 
> 标签：c#, csvhelper

我有以下方法：

```
public byte[] WriteCsvWithHeaderToMemory<T>(IEnumerable<T> records) where T : class
{
    using (var memoryStream = new MemoryStream())
    using (var streamWriter = new StreamWriter(memoryStream))
    using (var csvWriter = new CsvWriter(streamWriter))
    {
        csvWriter.WriteRecords<T>(records);

        return memoryStream.ToArray();
    }
} 
```

使用对象列表调用它 - 最终来自数据库，但由于某些东西不起作用，我只是填充一个静态集合。传递的对象如下：

```
using CsvHelper.Configuration;

namespace Application.Models.ViewModels
{
    public class Model
    {
        [CsvField(Name = "Field 1", Ignore = false)]
        public string Field1 { get; set; }

        [CsvField(Name = "Statistic 1", Ignore = false)]
        public int Stat1{ get; set; }

        [CsvField(Name = "Statistic 2", Ignore = false)]
        public int Stat2{ get; set; }

        [CsvField(Name = "Statistic 3", Ignore = false)]
        public int Stat3{ get; set; }

        [CsvField(Name = "Statistic 4", Ignore = false)]
        public int Stat4{ get; set; }
    }
} 
```

我想要做的是将集合写入 csv 以在 MVC 应用程序中下载。不过，每次我尝试写入该方法时，MemoryStream 都会以零长度返回，并且没有任何内容传递给它。我以前用过这个，但由于某种原因它不起作用——我有点困惑。谁能指出我在这里做错了什么？

干杯

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2014-04-10T19:54:42.257

你已经有了一个`using`很棒的块。那会为你冲洗你的作家。您只需稍微更改代码即可使其正常工作。

```
using (var memoryStream = new MemoryStream())
{
    using (var streamWriter = new StreamWriter(memoryStream))
    using (var csvWriter = new CsvWriter(streamWriter))
    {
        csvWriter.WriteRecords<T>(records);
    } // StreamWriter gets flushed here.

    return memoryStream.ToArray();
} 
```

如果你打开`AutoFlush`，你需要小心。这将在每次写入后刷新。如果您的流是网络流并且通过网络传输，它会非常慢。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-11-30T16:30:14.717

`csvWriter.Flush();`在您返回以刷新写入器/流之前放置。

编辑：根据杰克的回应。它应该是被刷新的流，而不是 csvWriter。`streamWriter.Flush();`. 保留原始解决方案，但添加此更正。

编辑 2：我的首选答案是：[https](https://stackoverflow.com/a/22997765/1795053) ://stackoverflow.com/a/22997765/1795053让 using 语句为您完成繁重的工作

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-10-26T06:41:14.830

将所有这些放在一起（以及更正的评论），包括重置内存流位置，我的最终解决方案是；

```
 using (MemoryStream ms = new MemoryStream())
        {
            using (TextWriter tw = new StreamWriter(ms))
            using (CsvWriter csv = new CsvWriter(tw))
            {
                csv.WriteRecords(errors); // Converts error records to CSV

                tw.Flush(); // flush the buffered text to stream
                ms.Seek(0, SeekOrigin.Begin); // reset stream position

                Attachment a = new Attachment(ms, "errors.csv"); // Create attachment from the stream
                // I sent an email here with the csv attached.
            }
        } 
```

以防万一帮助别人！

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-12-19T08:10:57.040

csvWriter中没有flush，flush在streamWriter中。调用时

> csvWriter.Dispose();

它将刷新流。另一种方法是设置

> streamWriter.AutoFlush = true;

每次都会自动刷新流。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-11-01T22:01:32.727

这是工作示例：

```
void Main()
{
    var records = new List<dynamic>{
       new { Id = 1, Name = "one" },
       new { Id = 2, Name = "two" },
    };

    Console.WriteLine(records.ToCsv());
}

public static class Extensions {
    public static string ToCsv<T>(this IEnumerable<T> collection)
    {
        using (var memoryStream = new MemoryStream())
        {
            using (var streamWriter = new StreamWriter(memoryStream))
            using (var csvWriter = new CsvWriter(streamWriter))
            {
                csvWriter.WriteRecords(collection);
            } // StreamWriter gets flushed here.

            return Encoding.ASCII.GetString(memoryStream.ToArray());
        }
    }
} 
```

基于[这个](https://stackoverflow.com/a/22997765/147613)答案。

# java - Java 泛型使用反射从方法（创建对象）中获取类型

> ID：13646109
> 
> 赞同：0
> 
> 时间：2012-11-30T13:20:42.590
> 
> 标签：java, generics

我想创建一个 GenericBuilder，它可用于检索在我的类中定义的 Builder 类。我创建了以下接口和类

```
public interface BuilderType<T> {
}

public class MyObject implements BuilderType<MyObject.MyObjectBuilder> {
private int i;
private MyObject() {}
public int getI() {
    return i;
}
public static MyObjectBuilder buildMyObject() {
    MyObjectBuilder builder = new MyObjectBuilder();
    return builder;
}
public static class MyObjectBuilder {
    private final MyObject obj;
    MyObjectBuilder() {
        obj = new MyObject();
    }
    public MyObjectBuilder withI(int i) {
        obj.i = i;
        return this;
    }
    public MyObject build() {
        return obj;
    }
}
public class GenericBuilder {
 public static <T extends BuilderType<S>, S> S getBuilder(Class<T> t) {
 S s = null;
 try {
     s = (S) t.getDeclaredMethod("build" + t.getSimpleName(), null)
                .invoke(null, null);
 } catch (Exception e) {
     e.printStackTrace();
 }
 return s;
 }
} 
```

我的 GenericBuilder 中的语句 s=(S)t.get... 给出了强制转换警告： Unchecked Cast from Object to S，有没有办法消除它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:28:41.967

没有办法消除警告，因为`S`它不是真正的类型。到运行时，它将被擦除到它的上限，这就是`Object`你的情况。所以“沮丧”实际上并没有做任何事情。您可以通过调用适当的方法来检查`Method`' 的返回类型，然后进行反射向下转换（对您的方案不是很有帮助）。当您在运行时动态获取方法时，不可能实现类型安全。

# powershell - Copy-Item 解析项

> ID：13646116
> 
> 赞同：0
> 
> 时间：2012-11-30T13:21:10.963
> 
> 标签：powershell

我想以递归方式将一个文件夹中的所有项目复制到另一个位置，但我也想将以“release.php”结尾的文件重命名为“.php”，并将旧的“.php”文件替换为这些文件，有没有办法可以处理 Copy-Item 看到的每个文件？那我可以重命名吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:08:30.047

尝试类似的东西？

```
PS>ls c:\temp -recurse |
      ForEach-Object {
      if($_.FullName -match "relase.php"){
         Rename-Item $_.FullName -NewName "$($_.baseName).php" -whatif;
         move-item "$($_.DirectoryName)\$($_.Basename).php" $destination -whatif
      }
      else{
         move-item $_.Fullname $detination -whatif
      } 
```

# c# - 将现有代码库移植到不同的芯片组

> ID：13646119
> 
> 赞同：1
> 
> 时间：2012-11-30T13:21:20.143
> 
> 标签：c#, c++, c, arm, chipset

我听说微软在 ARM 芯片组上移植了 Windows。

*我只是想知道将程序移植*到不同的芯片组意味着什么。作为一名 Java 程序员，我对底层细节知之甚少。

我天真地认为 Windows 是用 C、C++ 和 C# 混合编写的。我很确定 ARM 已经有了它的 C 和 C++ 编译器，所以这些代码应该只使用这些编译器重新编译。C# 需要 .NET 解释器，该解释器也可以用较低级别的语言编写，理论上可以使用 ARM 特定的 C 或 C++ 编译器重新编译。

我当然知道这个过程不是那么简单，所以我想了解一下理论上的限制、可能的问题等等，这可能会使这个过程变得困难。

注意：问题并不特定于我提到的示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T15:53:21.250

计算机程序在本质上往往完全不同。你可以有一个微不足道的“你好世界！” 例如，您还可以拥有一个成熟的操作系统。

具有“作为扩展机器的操作系统”和“作为资源管理器的操作系统”的经典定义（来自 Tanenbaum）的操作系统需要提供很多东西。

当操作系统需要充当资源管理器时，它只是在底层机器的基础上运行，控制其功能，如启动、中断、I/O、安全模式等。虽然我们无法查看 Windows 的源代码来查看这些方面有什么区别，我们可以看看它的一个开源竞争对手，它已经在 x86 和 ARM 架构上运行 - Linux！

在 Linux 上，对不同架构的支持位于[arch](https://github.com/torvalds/linux/tree/master/arch)目录中。例如，我们有[x86](https://github.com/torvalds/linux/tree/master/arch/x86)和[ARM](https://github.com/torvalds/linux/tree/master/arch/arm)目录以及许多其他目录。我相信即使检查那里的目录名称也会提示您所需的工作（启动、电源、内存管理等）

ARM 和 x86 世界之间存在很大差异。在 x86 中，几乎所有东西都是标准化的（听说过[兼容 IBM PC](http://en.wikipedia.org/wiki/IBM_PC_compatible)吗？），许多供应商都在构建架构的克隆。相反，在 ARM 生态系统中，ARM 公司本身只是一个 IP 提供商，每个供应商之间都有细微到很大的差异（只需检查 arch 文件夹中以 mach 开头的子目录名称 - 用于机器，或 plat - 用于平台） . [对于 ARM，在UEFI](http://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface)的最新开发尚未广泛实施之前，您没有 BIOS 之类的东西（我并不是说 BIOS 是好还是坏，只是一个例子）。

对于操作系统的“扩展机器”角色，它使 Windows 成为现在的样子，移植应该相对容易一些。这主要是关于调用硬盘分区“c：”等功能 - 具有只读或隐藏等文件权限，并保持 Win32 API 等核心 API 大部分功能。再一次，这不是[直截了当](http://getwired.com/2011/09/20/win32-the-reports-of-my-death-are-greatly-exaggerated/)的。

我期待 MS 严格定义 Windows 可以在什么样的 ARM 机器上运行，与非常开放的 Linux 世界相比，可以在什么样的外围设备上运行，以确保质量和上市速度。

这是我能想象到的两大问题，但是每转一圈都会出现一些小问题，比如；ARM 是 32 位 RISC 架构，char 是无符号的，即使是最近的高端 ARM 内核也不支持整数除法（性能？），所有那些 Windows 代码认为理所当然的小东西可能会咬他们回来......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:37:21.957

问题有所不同，但通常属于以下领域：

1.  使用非标准功能的地方。例如，在块中的可执行代码之后声明变量在 ANSI C 中无效，但在 C99 和 C++ 中有效。但是 Microsoft 编译器不支持 C99。与此相关的是标准中未涵盖的任何地方，例如进程创建 CreateProcess v. fork/exec、信号处理等。

2.  程序员做出不正确的假设。例如，假设 a`long`是 32 位。这些可以是真正的猪找到和修复。

3.  编译器不符合标准。这些天不太常见。更常见的是在某些平台上缺乏库实现。当然，标准并不完美，有时对同一标准可能会有不同的解释。

4.  真正的架构差异：例如，大端/小端问题、文件名格式等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T15:52:24.453

尽管操作系统上的绝大多数代码都是用 C 编写的，但仍有相当一部分是用汇编程序编写的。这将需要移植到新平台。其中一些刚刚完成的是汇编，因为它更有效（比如 memcpy），但是一些汇编是因为没有等效的 C 指令（比如进行系统调用或正确处理自旋锁）而编写的。所有这些都需要移植。

操作系统也直接访问硬件，并且会有一小部分硬件，如计时器等，这些对于操作系统的工作至关重要。所有这些都需要移植。

在需要内存管理单元 (MMU) 的保护模式操作系统中，必须移植执行 MMU 处理的代码。

其中大部分将在某种程度上从操作系统的其余部分中抽象出来，但其中一些抽象可能基于某些假设。在这种情况下，需要修复这些说明才能使所有这些工作。

然后是需要移植到新硬件的大量驱动程序。

# svn - 个人网站的开源免费颠覆

> ID：13646122
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:21:28.357
> 
> 标签：svn, hosting, public

我正在建立我的个人网站，并希望通过该网站上传和分享我的代码。我正在寻找的是一个免费的颠覆，我将只有提交访问权限，但其余用户将拥有下载访问权限。该网站不会描述一个特定的项目，做一些特定的事情，但我将编写的教程示例，我经常重复使用的代码，可以重复使用的小型独立模块等。我查看了网络，发现太多免费的颠覆存储库，但是，有些提到对用户的限制，有些像“谷歌项目托管”就像创建一个特定的项目，等等。如果不是全部的话，大多数对我来说都是好的，但如果有人有的话，我想得到一些建议/反馈已经做过类似的事情以及他会提出什么建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:26:13.173

您可以考虑使用 GitHub，因为它除了 git[还支持 SVN 。](https://github.com/blog/1178-collaborating-on-github-with-subversion)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:34:36.820

[Assembla](https://www.assembla.com/home)有一个免费的 SVN 存储库（和一些付费选项）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:02:54.330

带有“我将编写的教程示例、我经常重复使用的代码、可以重复使用的小型独立模块”的个人网站不是 SCM，而是博客或 Wiki

# erlang - 在 CPU 时间内使用 fprof 进行 Erlang 性能分析

> ID：13646128
> 
> 赞同：5
> 
> 时间：2012-11-30T13:22:09.600
> 
> 标签：erlang, profiling

我正在尝试使用 fprof 对我的软件进行更好的性能可视化。但是，默认值是使用挂钟测量的，但我想用 cpu 时间测量它。因此，我在 shell 上运行以下命令，但出现错误。在 Internet 或 erlang 文档中无法真正找到它失败的原因。有人有任何提示吗？

```
% fprof:trace([start, {cpu_time, true}]).
{error,not_supported} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T09:56:31.970

fprof 的 cpu_time 标志被转换为 trace 的 cpu_timestamp，如上面的代码片段所示：

根据[http://erlang.org/doc/man/erlang.html#trace-3](http://erlang.org/doc/man/erlang.html#trace-3)：

> cpu_timestamp
> 
> Erlang 节点的全局跟踪标志，使所有跟踪时间戳都在 CPU 时间，而不是挂钟。仅允许使用`PidSpec==all`. 如果主机操作系统不支持高分辨率 CPU 时间测量，`trace/3`则以`badarg`.

因此，如果调用`erlang:trace(all, true, [cpu_timestamp])`返回 badarg 异常，则意味着您的平台不支持此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T21:27:45.643

以下代码来自文件`fprof.erl`，它显示了错误消息的来源。但我不知道如何继续查找`erlang:trace`. 它可以由 c 编写。如果能找到trace的源代码，就可以揭开这个秘密。

```
trace_on(Procs, Tracer, {V, CT}) ->
    case case CT of
         cpu_time ->
         try erlang:trace(all, true, [cpu_timestamp]) of _ -> ok
         catch
             error:badarg -> {error, not_supported} ％％ above error message is shown here
         end;
         wallclock -> ok
     end
    of ok ->
        MatchSpec = [{'_', [], [{message, {{cp, {caller}}}}]}],
        erlang:trace_pattern(on_load, MatchSpec, [local]),
        erlang:trace_pattern({'_', '_', '_'}, MatchSpec, [local]),
        lists:foreach(
          fun (P) ->
              erlang:trace(P, true, [{tracer, Tracer} | trace_flags(V)])
          end,
          Procs),
        ok;
    Error ->
        Error
    end. 
```

# iphone - 如何在打开应用程序时将第一个 viewController 屏幕设置为默认打开屏幕

> ID：13646132
> 
> 赞同：0
> 
> 时间：2012-11-30T13:22:27.580
> 
> 标签：iphone, objective-c, ios, xcode, uitabbarcontroller

嗨，我是 iPhone 开发的新手，我正在开发一个 TabBar 应用程序，它包含**5 个 tabbar Items**。

当我在**第三个 TabBar viewController 屏幕****关闭应用程序**时，当我再次打开应用程序时，同样的**第三个 TabBar viewController**屏幕仅打开。

 ****如何在 iphone**中将 App 首屏设置** 为默认的 App 打开屏幕。

打开应用程序时，我需要将**第一个屏幕**设置为默认打开屏幕。

你能在这里分享你的想法吗..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:28:57.007

当您关闭应用程序时，它不会*杀死*它，它只是暂停它。除非您在关闭它时设置了将其杀死的选项。

我建议您阅读[Apple Documentation For Application Flow](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)

如果您不熟悉这一切，还可以阅读 Apple 为您提供的其他文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:36:08.623

在您的应用程序中，添加一个值为 YES`Info.plist`的布尔键。`UIApplicationExitsOnSuspend`

当您关闭它时，这将始终退出应用程序（而不是在后台运行）。再次打开应用程序时，将出现第一个视图控制器，而不是您上次离开的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:30:12.710

如果应用程序默认被杀死，它会加载 Application Delegate 方法中的所有设置：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

在这里你可以修改你的根视图控制器，我认为它是某种标签栏视图控制器。

因此，该方法中可能有一些代码定义了要加载的选项卡。

但是，如果您想在应用程序进入前台后显示特定选项卡，请使用应用程序委托方法：

```
- (void)applicationWillEnterForeground:(UIApplication *)application 
```

或者

```
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T13:33:00.997

这是因为您将应用程序设置为在后台运行，因此每当您关闭应用程序时，应用程序将在后台运行并在启动时恢复。

所以只需做一件事转到您的 info.plist 并为
`Application does not run in background`to设置值`YES`

![看一看](../Images/e77ab735e0fe3f0e13037b2ea7573aa6.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T13:36:14.797

例如，通过按下 iPhone 上的主页按钮退出应用程序时，应用程序不会终止。相反，执行被暂停，但应用程序将保留在内存中，直到 iOS 决定将其删除。这意味着当您再次进入应用程序时，它将处于与您离开时相同的状态。您可以通过双击主页按钮来查看应用程序是否仍在内存中。

当您的应用程序激活时`applicationDidBecomeActive:`，您的方法`UIApplicationDelegate`将被调用。您可以实现该方法来设置您希望应用程序在恢复时所处的状态。

我不建议在暂停时明确终止该应用程序。这会强制应用程序在每次启动时重新加载，这会降低性能。

有关更多信息，请参阅[Apple 关于应用程序状态的文档](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)。****

# ios - iOS - UISupportedInterfaceOrientations 和 shouldAutorotateToInterfaceOrientation

> ID：13646134
> 
> 赞同：2
> 
> 时间：2012-11-30T13:22:52.953
> 
> 标签：ios, xcode, cocoa-touch, orientation

我正在寻找有关如何仅允许您的 iOS 应用程序使用某些方向的说明。我知道，`UISupportedInterfaceOrientations`但`shouldAutorotateToInterfaceOrientation`我对它们的用途以及它们如何组合在一起有点困惑。

我试图使用`UISupportedInterfaceOrientations`只允许横向方向，这似乎没有影响，直到我研究它并读到它会影响初始方向。经过测试，我的应用似乎只在横向打开，但如果屏幕是纵向的，它会快速旋转。

我知道你可以`shouldAutorotateToInterfaceOrientation`用来限制允许的方向，例如：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || 
           (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

但是，在进行一些在线阅读时，我阅读`shouldAutorotateToInterfaceOrientation`的内容从 iOS6 开始已被弃用。

基本上我的问题是：

1.  跨多个 iOS 版本限制屏幕方向的正确方法是什么？
2.  是唯一用于`UISupportedInterfaceOrientations`限制初始方向的吗？

**编辑：**

要扩展已接受的答案，`shouldAutorotate`可在 iOS6 中使用。如果您已经在其中实现了逻辑`shouldAutorotateToInterfaceOrientation`和/或想要支持早期版本的 iOS，作为快速修复，您可以执行以下操作：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft) || 
           (interfaceOrientation == UIInterfaceOrientationLandscapeRight);
}

- (BOOL)shouldAutorotate {
    return [self shouldAutorotateToInterfaceOrientation:self.interfaceOrientation];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:38:05.090

您需要用于旋转而不是的`shouldAutorotateToInterfaceOrientation`方法只是`shouldAutorotate`

根据 ViewControllers 的 AppleDoc 处理旋转：

> 在 iOS 6 中，您的应用支持在应用的 Info.plist 文件中定义的界面方向。视图控制器可以覆盖supportedInterfaceOrientations 方法来限制支持的方向列表。一般情况下，系统只会在窗口的根视图控制器或呈现为填满整个屏幕的视图控制器上调用该方法；子视图控制器使用其父视图控制器为它们提供的窗口部分，并且不再直接参与有关支持哪些旋转的决策。应用程序的方向掩码和视图控制器的方向掩码的交集用于确定视图控制器可以旋转到哪些方向。
> 
> 你可以覆盖一个视图控制器的 preferredInterfaceOrientationForPresentation，该视图控制器旨在以特定方向全屏显示。

该方法`shouldAutorotateToInterfaceOrientation`已弃用，某些处理设备旋转响应的方法也已弃用。

对于iOS多版本的支持方法，这里还有苹果说的：

> 为了兼容性，仍然实现 shouldAutorotateToInterfaceOrientation: 方法的视图控制器不会获得新的自动旋转行为。（换句话说，它们不会回退到使用应用程序、应用程序委托或 Info.plist 文件来确定支持的方向。）相反，shouldAutorotateToInterfaceOrientation: 方法用于合成将由 supportedInterfaceOrientations 方法返回的信息.

取自[发行说明](https://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T10:24:35.280

回答你的第二个问题：

是的，Info.plist 中的“UISupportedInterfaceOrientations”条目仅用于您的应用程序的初始启动，确保它不会以它不支持的方向启动您的应用程序，因此不需要执行旋转权限离开。

此外，如果您的应用不想使用特定的方向（例如，对于只做横向的游戏），在您的 AppDelegate 中覆盖“application:supportedInterfaceOrientationsForWindow”非常有用。

最后，这是一个常见错误，在 iPhone 和 iPod Touch 设备上，设备*永远不*应该旋转到 UIInterfaceOrientationPortraitUpsideDown！这是因为这些设备（与 iPad 不同）不允许用户使用*Lock*软按钮将设备锁定为横向模式 - 该按钮仅锁定为纵向。因此，如果用户侧躺，想要在横向模式下使用应用程序，如果您的应用程序进入倒置方向，他就无法执行此操作。但是，如果您不允许这种轮换，那么它就可以工作。

# concatenation - 如何在 vhdl 中将位分成不同的信号？

> ID：13646135
> 
> 赞同：1
> 
> 时间：2012-11-30T13:22:53.577
> 
> 标签：concatenation, vhdl, verilog, bit

我有以下要转换为 vhdl 的 verilog 代码行：

```
assign   {cout,sum} = ( add ) ? ( in_a + in_b + cin ) : ( in_a - in_b - cin ); 
```

我将如何在 vhdl 中执行此操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T15:50:44.357

实际上，您以相同的方式执行此操作，您只需要记住增加输入值的宽度以便为输出进位“腾出空间”。

```
(cout, sum) <= ('0'&in_a) + ('0'&in_b) + cin when(add='1') else ('0'&in_a) - ('0'&in_b) - cin; 
```

由于该行非常非常难看且难以理解，我建议将整个事情转换为一个过程：

```
process(in_a, in_b, cin) begin
    if(add='1') then
        (cout, sum) <= ('0'&in_a) + ('0'&in_b) + cin;
    else
        (cout, sum) <= ('0'&in_a) - ('0'&in_b) - cin;
    end if;
end process; 
```

这至少更清晰一些。

编辑：

请注意，这仅适用于 VHDL 2008。对于早期版本，您必须创建一个比输入宽一个的中间信号，将结果分配给该信号，然后提取 cout 和 sum。

```
process(in_a, in_b, cin)
    -- Assumes in_a and in_b have the same width, otherwise
    -- use the wider of the two.
    variable result : unsigned(in_a'length downto 0);
begin
    if(add='1') then
        result := ('0'&in_a) + ('0'&in_b) + cin;
    else
        result := ('0'&in_a) - ('0'&in_b) - cin;
    end if;
    cout <= result(result'high);
    sum  <= result(result'high-1 downto 0);
end process; 
```

# .net - 数据存储对象的性能

> ID：13646136
> 
> 赞同：2
> 
> 时间：2012-11-30T13:23:02.843
> 
> 标签：.net, sql, sql-server, vb.net, sql-server-2008

我从我的同事（<-spelling）那里继承了一些编程职责，我得到了一个这样的用户表：

```
userID BigInt (1,1)
Username Nvarchar(100)
UserPass Nvarchar(100)
Profile  Nvarchar(max) 
```

他们已经为用户名/密码编写了所有逻辑，客户回过头来告诉他们“我们现在需要用户配置文件”。由于客户端已经控制了数据库，我们不允许修改现有的存储对象，但是，它们确实为我们提供了新的 Profile 字段。

我想知道的是：什么对性能更好......？任何地方都有基准吗？

```
A)Storing profile data as XML
B)Storing profile data as JSON
C)Storing profile data as a comma-delimited list
D)Other that I have not thought of...maybe store a XML file in the filesystem tied to the userID? 
```

对于上述任何一项，我将输入并分解为对象。我个人会说 JSON，我可以使用 JSON.Net 库

ps 这将在 Win2k8 R2 服务器上的 .Net 4 和 SQL 2008 R2 中（这是他们个人的，并且非常强大）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:39:10.547

我认为在这种情况下 XML 和 Json 都是可以接受的，因为您被迫以这种方式存储配置文件。

我过去曾为此使用 XML，主要是为了在查找相关配置文件属性时的结构和可读性。

如果您担心它的大小（我想它会非常小），请将 xml 存储在压缩状态。

# java - 带有 JRE 7 的 Eclipse Juno 导致启动时出现问题

> ID：13646140
> 
> 赞同：1
> 
> 时间：2012-11-30T13:23:13.047
> 
> 标签：java, eclipse, jvm, jvm-arguments, javaw

所解释的问题似乎是一个常见问题，并且已经提出了不同的解决方案，其中许多都有效。[可以在此处找到此讨论的一个示例](https://stackoverflow.com/questions/7302604/eclipse-error-failed-to-create-the-java-virtual-machine)。

我的问题更多是关于*为什么*而不是*如何*。

我们自己也一直在努力解决这个问题，发现如果我们使用 javaw.exe 启动 eclipse 会出现问题，但如果我们使用 jvm.dll 调用 Eclipse 则不会出现问题。尽管在这两种情况下都`eclipse.ini`保持不变。

为了解释我的情况，我将使用`eclipse.exe`从带有单个`-vm`参数的命令行启动的示例。以下是`eclipse.ini`我们正在使用的供参考：

```
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.win32.win32.x86_1.1.200.v20120522-1813
--launcher.XXMaxPermSize
256m
-vmargs
-Xms128m
-Xmx1280m
-XX:MaxPermSize=512m
-Dderby.stream.error.field=java.lang.System.err 
```

您可以看到，heap (1280m) 和 PermGen (512m) 请求分配的内存都相当多。如果您无法重现该问题，您可以尝试增加内存，直到出现错误。

您可以使用三种不同的命令行：

```
eclipse.exe -vm ..\jre\bin\javaw.exe
eclipse.exe -vm ..\jre\bin
eclipse.exe -vm ..\jre\bin\client\jvm.dll 
```

只有*第*一个导致错误（javaw.exe）。其余两个选项成功启动 eclipse。减少 eclipse.ini 中的内存需求也明显解决了这个问题。

所以我的问题是，当其他两个命令行工作时，为什么 javaw.exe 会失败？选择这些不同的路径有什么区别？一个人是否比其他人更严格地执行参数？

环境：Eclipse：3.8-win32，JRE：7u7-win32，Windows 7 x64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:15:21.593

我无法解释为什么将 Eclipse 指向可执行文件失败但 dll 没有，但我可以提供[这个](https://stackoverflow.com/a/9304270/639520)来解释问题。它的要点是，在 Windows 上，JVM 需要为您的堆分配一块连续的内存，如果不能，则无法启动。

也许[这个页面](http://wiki.eclipse.org/Equinox_Launcher#Finding_a_VM.2C_Using_JNI_Invocation_or_Executing_Java)将有助于弄清楚为什么指向 dll 似乎有效。否则，我会在[Eclipse Equinox 论坛](http://www.eclipse.org/forums/index.php/f/31/)上提问。

# java - 使用 GSON 序列化 Hibernate DTO 时出错

> ID：13646146
> 
> 赞同：0
> 
> 时间：2012-11-30T13:23:33.310
> 
> 标签：java, json, gson

尝试在我的 JAVA 代码中使用 GSON 将 DTO 序列化为 JSON。DTO 扩展了一个抽象类并且还实现了 java.io.Serializable。作为其成员之一的 DTO 具有受保护的 String [][] （二维数组）

收到以下错误，到目前为止还没有找到清晰的帮助。

严重：servlet jsp 的 Servlet.service() 抛出异常 java.lang.UnsupportedOperationException：尝试序列化 java.lang.Class：org.hibernate.proxy.HibernateProxy。忘记注册类型适配器？在 com.google.gson.internal.bind.TypeAdapters$1.write(TypeAdapters.java:62) 在 com.google.gson.internal.bind.TypeAdapters$1.write(TypeAdapters.java:59) 在 com.google.gson .internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:68) 在 com.google.gson.internal.bind.ArrayTypeAdapter.write(ArrayTypeAdapter.java:93) 在 com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write (TypeAdapterRuntimeTypeWrapper.java:68) 在 com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:

任何帮助解释或解决它表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:35:41.193

您应该注意，当您尝试序列化 Hibernate DTO 时，它可能与您最初声明的对象不同。Hibernate 将根据您的 DTO 编写一个代理类，但具有不同的字段来执行与持久性相关的操作。因此，如果您的 DTO 参与任何休眠操作，它将不是您的 DTO，而是代理。您应该在尝试序列化之前将对象的内容复制到新的普通 DTO 中。您可以通过打印对象 getClass() 方法输出来测试这一点，它将是一个代理对象，GSON 不知道如何序列化一些代理字段。希望这可以帮助。

# android - 从 ListView 隐藏行而不占用空间

> ID：13646147
> 
> 赞同：10
> 
> 时间：2012-11-30T13:23:35.543
> 
> 标签：android, android-listview

我有一个带有关联 ArrayAdapter 的 ListView，它在多个活动中显示其内容。不幸的是，现在有必要在其中一个设置中的 ListView 不显示其所有元素，而只是显示“属性”未设置为 true 的元素。我想避免使用两个具有不同内容的 ArrayAdapter，因为那时我需要以某种方式使它们保持同步。我是这样尝试的（这个方法现在只是假设在我们想要隐藏某些元素的设置中调用 getView）：

```
public View getView(int position, View convertView, Context context) {
....

    if(!arrayitems[position].isProperty()) { //arrayitems is the underlying array
        convertView.setVisibility(View.VISIBLE); 
    } 
    else {
        convertView.setVisibility(View.GONE); 
    }
    return convertView;
} 
```

这可行，但是如果元素具有 isProperty == true，我会得到一个白行。我想让该行在某种意义上不可见，它不再占用任何空间。那可能吗？

convertView 使用的 xml 文件如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:orientation="vertical">
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/text_item_time"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginRight="4dp"
            android:maxLines="1"
            android:ellipsize="none"
            android:textSize="12sp"
            android:textStyle="bold" />

        <TextView
            android:id="@+id/text_item_status"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textSize="12sp"
            android:textStyle="bold" />

    </LinearLayout>

     <TextView android:id="@+id/text_item_text"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:textSize="12sp"
         android:maxLines="3"
         android:ellipsize="none" />

     <LinearLayout
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:layout_marginTop="2dp"
         android:orientation="horizontal" >

         <TextView
             android:id="@+id/text_item_rating"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_marginRight="4dp"
             android:textSize="10sp" />

         <TextView
             android:id="@+id/text_item_voted"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:textSize="10sp" />

     </LinearLayout>

</LinearLayout> 
```

我试图用“fill_parent”重播所有 android:layout_height="wrap_content" 但它没有改变任何东西......

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-22T18:35:29.753

将列表视图的所有内容的可见性设置为消失，然后将视图的可见性设置为消失......这将隐藏行而不占用空间......即使我一直在搜索它也对我有用这个但是经过研究我发现了这个....

**编辑 1：** 将 View 的可见性设置为 GONE 就足够了。无需设置子元素的可见性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-07-10T10:09:11.610

我和你有同样的问题

我已经想通了`inflating another layout layout with no height and width`

*适配器.java*

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    // TODO Auto-generated method stub
    LayoutInflater inflater = (LayoutInflater) mContext
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    if (YOUR_CONDITION) {
            return inflater.inflate(R.layout.blank_layout, parent,
                    false);
    } else {
            View vi = inflater.inflate(R.layout.list_item, parent, false);
            return vi;
    }

} 
```

空白布局会是这样的，

*空白布局.xml*

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:orientation="vertical" >

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-23T23:27:40.653

所以 Romain 的意思是给你的 LinearLayout 添加一个 id

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" 
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:orientation="vertical"
    android:id="@+id/linear_layout"> 
```

然后在你的Java中你会做

```
 public View getView(int position, View convertView, Context context) {
    ....
    holder.lLayout = (LinearLayout) convertView.findViewById(R.id.linear_layout);
    ....
    if(!arrayitems[position].isProperty()) { //arrayitems is the underlying array
        holder.lLayout.setVisibility(View.VISIBLE); 
    } 
    else {
        holder.lLayout.setVisibility(View.GONE); 
    }
    return convertView;
    } 
```

如果你以不同的方式夸大你的观点，你可能需要稍微改变一下。我自己做过，效果很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-30T13:50:09.470

您可以使用 android:layout_height="wrap_content" 的 getview 布局并使用 Visibility gone 来隐藏您的布局

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-30T13:43:08.253

另一位用户遇到了同样的问题，他以这种方式解决了它：[https](https://stackoverflow.com/a/7928923/1548679) ://stackoverflow.com/a/7928923/1548679 。

我希望这可以帮助你。

问候

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2015-10-22T09:08:32.623

通过使用您的逻辑修改 getCount() 以及 getView() 中的位置，您可以使其适用于示例检查[http://www.sherif.mobi/2012/01/listview-with-ability-to-hide-rows。 html](http://www.sherif.mobi/2012/01/listview-with-ability-to-hide-rows.html)由 @sherif-elkhatib

# java - Java Mail - 电子邮件客户端中未显示附件？

> ID：13646161
> 
> 赞同：1
> 
> 时间：2012-11-30T13:24:23.293
> 
> 标签：java, email, jakarta-mail

好的，所以我不得不更改另一个开发人员发送的一些旧代码，这些代码用于从我们的应用程序使用 Java Mail 发送电子邮件。这已经工作了很长时间，但现在我们也需要发送 pdf 附件。

所以基本上在下面，假设有一个对象“mail”具有文本和 html 消息的 getter，现在还有一个用于从文件系统加载并附加到邮件的 pdf 文件名的 getter。

我已经更改了以下标记的代码，因此如果要附加 pdf，请从文件系统加载并附加。我尝试使用与前面的代码相同的结构，尽管我怀疑它不是全部必需的？

```
 Multipart mp = new MimeMultipart("alternative");

            // Create a "text" Multipart message
            BodyPart textPart = new MimeBodyPart();
            textPart.setContent(mail.getText(), "text/plain");
            mp.addBodyPart(textPart);

            // Create a "HTML" Multipart message
            Multipart htmlContent = new MimeMultipart("related");
            BodyPart htmlPage = new MimeBodyPart();

            htmlPage.setContent(mail.getHtml(), "text/html; charset=UTF-8");
            htmlContent.addBodyPart(htmlPage);
            BodyPart htmlPart = new MimeBodyPart();
            htmlPart.setContent(htmlContent);
            mp.addBodyPart(htmlPart);

            // NEW CODE STARTS HERE
            if(StringUtils.isNotBlank(mail.getPdfAttachmentFileName())) {
                Multipart pdfContent = new MimeMultipart("mixed"); //<---- this appears to be an issue???
                BodyPart pdfPage = new MimeBodyPart();

                File file = new File(uploadDir + "/" + mail.getPdfAttachmentFileName());
                DataSource dataSource = new ByteArrayDataSource(new FileInputStream(file), "application/pdf");

                pdfPage.setDataHandler(new DataHandler(dataSource));
                pdfPage.setFileName(mail.getPdfAttachmentFileName());
                pdfContent.addBodyPart(pdfPage);

                BodyPart pdfPart = new MimeBodyPart();
                pdfPart.setContent(pdfContent);
                mp.addBodyPart(pdfPart);
            }
            // NEW CODE ENDS HERE

            mimeMessage.setContent(mp); 
```

无论如何，上述工作，有点。没有错误或异常，并且消息被发送。但是附件不会出现，具体取决于您收到邮件的电子邮件客户端。

使用上面的代码，Outlook 接收到的邮件是可读的，并且附件是可见的和可下载的。太棒了。但是在GMail中，邮件仍然可读，回形针出现表明有附件，但没有附件可供下载？

如果您切换 `Multipart pdfContent = new MimeMultipart("mixed");' 要“相关”而不是“混合”，则完全相反。GMail 完美接收，但 Outlook 只收到邮件和回形针，没有实际附件。

显然，我们需要在不知道他们用来打开它们的电子邮件客户端的情况下向我们的客户发送电子邮件！显然，我是 Java Mail 的新手，所以只是简单地复制了建议的代码，但这与我们现有的代码并不一致！

任何想法如何更改上述内容以使其完全独立于电子邮件客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T16:49:21.653

好的，原来 Spring 有一个帮助类来隐藏所有这些混乱。

我已将上述所有代码重构为以下代码，效果很好；

```
 MimeMessageHelper message = new MimeMessageHelper(mimeMessage, true, "UTF-8");
            message.setTo(mail.getTo());
            message.setFrom(mail.getFrom());
            message.setSubject(mail.getSubject());
            message.setText(mail.getText(), mail.getHtml());

            if(StringUtils.isNotBlank(mail.getPdfAttachmentFileName())) {
                File file = new File(uploadDir + "/" + mail.getPdfAttachmentFileName());
                DataSource dataSource = new ByteArrayDataSource(new FileInputStream(file), "application/pdf");
                message.addAttachment(mail.getPdfAttachmentFileName(), dataSource);
            } 
```

# java - 如何在java中获取包含iframe内容的body

> ID：13646163
> 
> 赞同：1
> 
> 时间：2012-11-30T13:24:25.337
> 
> 标签：java, html, iframe, selenium

我正在获取 iframe 标签下的数据。我想要 body 标签下的数据。但我没有得到正确的输出。这是我的 HTML 页面如下所示：

```
<iframe id="sharetools-iframe" width="100%" height="100%" frameborder="0" style="z-index: 1000; position: relative; visibility: visible; " scrolling="no" allowtransparency="true" src="some url here"></iframe>
#document
<html><head><script type="text/javascript">window.WIDGET_ID = 'sharepopup';</script>
<base href="href here">
<link rel="stylesheet" href="href here">
<script src="url here"></script>

<script type="text/javascript" src="url here"></script></head>
<body>
body contents are here........
..............................
</div></div></body></html> 
```

我使用了以下代码：

```
WebDriver webDriver = new FirefoxDriver();
webDriver.get("url to open");
String htmlPage = webDriver.getPageSource();
Tidy tidy = new Tidy();
InputStream inputStream = new ByteArrayInputStream(htmlPage.getBytes());
Document doc = tidy.parseDOM(inputStream, null);
Element element = doc.getElementById("sharetools-iframe"); 
```

在这里，我得到了元素 null。我还按如下方式进行了类型转换：

```
HTMLIFrameElement iframeElement = (HTMLIFrameElement) doc.getElementById("sharetools-iframe"); 
```

但是让 iframeElement 为空。

我还使用了 jsoup 解析器，如下所示：

```
Document doc = Jsoup.parse(htmlPage);
org.jsoup.nodes.Element iframeElement= doc.getElementById("sharetools-iframe"); 
```

在这里，我将输出`<iframe id="sharetools-iframe" width="100%" height="100%" frameborder="0" style="z-index: 1000; position: relative; visibility: visible; " scrolling="no" allowtransparency="true" src="some url here"></iframe>`作为 iframeElement 但没有获取正文内容。

请指导我如何获取 iframe 的正文内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T07:17:14.093

您需要切换到 iframe，然后才能与内容进行交互。例如获取身体：

```
driver.switchTo().frame(driver.findElement(By.id("sharetools-iframe"))).findElement(By.tagName("body")); 
```

# c# - 如何在 C# 中从 Ftp 下载 Zip 文件

> ID：13646164
> 
> 赞同：0
> 
> 时间：2012-11-30T13:24:25.853
> 
> 标签：c#, ftp

我必须使用 c# 代码从 ftp 下载 zip 文件。我使用了以下代码。

```
 Uri url = new Uri("ftp://ftpurl");
        if (url.Scheme == Uri.UriSchemeFtp)
        {

            FtpWebRequest objRequest = (FtpWebRequest)FtpWebRequest.Create(url);
            //Set credentials if required else comment this Credential code
            NetworkCredential objCredential = new NetworkCredential(userid, Pwd);
            objRequest.Credentials = objCredential;
            objRequest.Method = WebRequestMethods.Ftp.DownloadFile;

            FtpWebResponse objResponse = (FtpWebResponse)objRequest.GetResponse();

            StreamReader objReader = new StreamReader(objResponse.GetResponseStream());
            byte[] buffer = new byte[16 * 1024];
            int len = 0;
            FileStream objFS = new FileStream(@"E:\ftpwrite", FileMode.Create, FileAccess.Write, FileShare.Read);
            while ((len = objReader.BaseStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                objFS.Write(buffer, 0, len);
            }
            objFS.Close();
            objResponse.Close();

        } 
```

但是这段代码没有给我正确的响应，因为我想从 ftp 保存文件，而这段代码正在将文件中的数据以字节为单位写入我的文件。我的文件是 zip 文件而不是文本文件。请帮助我该怎么做，否则我误解了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:08:27.923

如果您不反对使用免费的 3rd 方库，可以使用[http://www.enterprisedt.com/products/edtftpnet/download.html](http://www.enterprisedt.com/products/edtftpnet/download.html)

它使访问 FTP 更简单 IMO。示例代码（取自他们的[文档](http://www.enterprisedt.com/products/edtftpnet/doc/manual/index.html)并稍作修改）：

```
using (FTPConnection ftp = new FTPConnection())
{
    ftpConnection.ServerAddress = "myserver";
    ftpConnection.UserName = userName;
    ftpConnection.Password = password; 
    ftpConnection.Connect();
    ftpConnection.DownloadFile(localFilePath, remoteFileName);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:27:43.827

我的*猜测*是，这与您使用`StreamReader`. 有可能在构建时它正在从流中读取以尝试确定编码。由于您并没有真正*使用*它 - 只是`BaseStream`- 它没有意义并导致代码不清楚。

只需使用：

```
Stream inputStream = objResponse.GetResponseStream(); 
```

此外，您应该对*所有*流和响应使用`using`语句。

 *哦，如果您使用的是 .NET 4 或更高版本，请使用它`Stream.CopyTo`来节省一些时间。*

# android - 如何在 SharedPreferences Android 中存储 GPS 位置

> ID：13646172
> 
> 赞同：0
> 
> 时间：2012-11-30T13:24:55.853
> 
> 标签：android, gps, android-sharedpreferences

我的应用程序中有五个固定的 GPS 位置。当您靠近它们时，它将存储在应用程序中并解锁某种奖章。我在我的测验和奖牌中使用了 SharedPreferences，但我有点不确定如何将 GPS 存储在 SharedPreferences 中。到目前为止，这是我的代码。

```
 package com.example.norskattraksjon;

    import java.util.ArrayList;

    import android.content.Context;
    import android.content.SharedPreferences;
    import android.location.Location;
    import android.location.LocationListener;
    import android.os.Bundle;

    import com.google.android.maps.GeoPoint;

    public class MyLocationListener implements LocationListener {
private ArrayList<GeoPoint> gplist;

public MyLocationListener(ArrayList<GeoPoint> gpList2) {
    gplist = gpList2;   
}

public void onLocationChanged(Location location) {
    System.out.println("Den kommer hits");
    for(GeoPoint gp : gplist){

        //SÂ henter vi ut latitude og longitude.
        //Det forvirrende her er at klassen "Location" bruker float-koordinater
        //mens "GeoPoint" bruker mikrokoordinater. Dermed mÂ man konvertere mellom de.
        float latitude = (float) (gp.getLatitudeE6() / 1E6);
        float longitude = (float) (gp.getLongitudeE6() / 1E6);

        //Vi lager en "location" for hvert av punktene i gplist, utifra latitude og longitude.
        Location test = new Location("tester");
        test.setLatitude(latitude); 
        test.setLongitude(longitude);

        //location.distanceTo() er en metode som sjekker avstanden til punkter.
        //Her skal distansen vÊre under 10 000 meter.
        if(location.distanceTo(test) <= 70){
            //Om distansen er under 10 000m, sÂ lager du en toast som gir den faktiske avstanden til punktet.
            System.out.println("Her er du");

            SharedPreferences prefs = getSharedPreferences("com.example.norskattraksjon",
                    Context.MODE_PRIVATE);

                    // Lagre en tekst... først trenger vi en editor                     
                SharedPreferences.Editor editor = prefs.edit();
                editor.putBoolean("location", true);

                   //Lagrer verdien
                    editor.commit();            

        };

    }

    };

private SharedPreferences getSharedPreferences(String string,
        int modePrivate) {
    // TODO Auto-generated method stub
    return null;
}

public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub
}

public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub
}

public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub
}

} 
```

这是我的另一个连贯代码；

```
 package com.example.norskattraksjon;

    import java.util.ArrayList;
    import java.util.List;

    import android.content.Context;
    import android.content.SharedPreferences;
    import android.graphics.drawable.Drawable;
    import android.location.LocationListener;
    import android.location.LocationManager;
    import android.os.Bundle;
    import android.view.Menu;

    import com.google.android.maps.GeoPoint;
    import com.google.android.maps.MapActivity;
    import com.google.android.maps.MapController;
    import com.google.android.maps.MapView;
    import com.google.android.maps.Overlay;
    import com.google.android.maps.OverlayItem;

    public class MainActivityMap extends MapActivity {

private MapController mc;
MapOverlays overlay;
ArrayList<GeoPoint> gplist;
List<Overlay> overlayList;
 LocationListener mlocListener; //Denne klassen lytter etter lokasjonen din
  LocationManager mlocManager; //Mens denne kobler deg opp mot telefonens GPS.

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    System.out.println("WEEEEEEE");
    setContentView(R.layout.mapview);

    MapView mapView = (MapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
    mapView.setSatellite(true);

    mc = mapView.getController();
    gplist = new ArrayList<GeoPoint>();

    overlayList = mapView.getOverlays();
    Drawable drawable = this.getResources().getDrawable(R.drawable.ic_launcher);
    overlay = new MapOverlays(drawable, this);
    double lat = 60.39403;
    double lon = 5.330579;

    GeoPoint point = new GeoPoint ((int) (lat * 1E6), (int) (lon*1E6));
    gplist.add(point);
    OverlayItem punkt1 = new OverlayItem(point, "Du har kommet til!", "Domkyrkja i Bergen!");

    double lat2 = 60.702251;
    double lon2 = 5.333685;

    GeoPoint point1 = new GeoPoint ((int) (lat2 * 1E6), (int) (lon2 *1E6));
    gplist.add(point1);
    OverlayItem punkt2 = new OverlayItem(point1, "Her ble", "Noen som drepte kongen begravd");

    double lat3 = 60.37829;
    double lon3 = 5.335665;

    GeoPoint point3 = new GeoPoint ((int) (lat3 * 1E6), (int) (lon3 *1E6));
    gplist.add(point3);
    OverlayItem punkt3 = new OverlayItem(point3, "Her ble", "Himmelfarten med tran i maga!");

    double lat4 = 60.213789;
    double lon4 = 5.369895;

    GeoPoint point4 = new GeoPoint ((int) (lat4 * 1E6), (int) (lon4 *1E6));
    gplist.add(point4);
    OverlayItem punkt4 = new OverlayItem(point4, "Her ble", "Flygelet skapt");

    double lat5 = 60.413619;
    double lon5 = 5.37579;

    GeoPoint point5 = new GeoPoint ((int) (lat5 * 1E6), (int) (lon5 *1E6));
    gplist.add(point5);
    OverlayItem punkt5 = new OverlayItem(point5, "Her ble", "Bergensbakken bakt");

    overlay.addOverlay(punkt1);
    overlay.addOverlay(punkt2);
    overlay.addOverlay(punkt3);
    overlay.addOverlay(punkt4);
    overlay.addOverlay(punkt5);
    overlayList.add(overlay);

    mc.animateTo(point);
    mc.setZoom(11);

    //Dette er metoden man bruker for Â koble opp til mobilens GPS
      mlocManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);

      //Her lager vi en instans av vÂr egen LocationListener. Dette gj¯r at vi kan bestemme selv hva som skjer
      //nÂr man trykker pÂ overlays.
      mlocListener = new MyLocationListener(gplist);

      //Her sier vi at vÂr LocationListener skal sp¯rre om GPS-signaler fra en GPS_PROVIDER.
      //0 stÂr for minimumstiden mellom oppdateringer
      //Den andre 0 stÂr for minimumsdistansen mellom oppdateringer
      //mLocListener er instansen vi lagde av vÂr egen LocationListener.
      mlocManager.requestLocationUpdates( LocationManager.GPS_PROVIDER, 0, 0, mlocListener);
}

public GeoPoint newGeo(double x, double y){
    int a = (int) (x * 1E6);
    int b = (int) (y * 1E6);
    GeoPoint z = new GeoPoint(a,b);
    return z;
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:32:24.667

```
 SharedPreferences p = PreferenceManager.getDefaultSharedPreferences(context);
    int latE6 = (int) (lat * 1e6);
int lonE6 = (int) (lon * 1e6);
    p.edit().putInt("Lat", latE6).commit();
    p.edit().putInt("Long", lonE6).commit(); 
```

在上面的代码中，lat 和 lon 是您所在位置的纬度和经度。然后您可以将它们检索为 int 变量并通过再次将它们除以 1e6 来获取位置值。

```
 int lat= p.getInt("Lat", "");
int lon = p.getInt("Long", ""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:28:22.567

您可以将 Lat 和 Long 直接存储在`SharedPreference`如下：

```
SharedPreferences p = PreferenceManager.getDefaultSharedPreferences(context);

p.edit().putString("Lat", YOUR_LATTITUDE).commit();
p.edit().putString("Long", YOUR_LONGITUDE).commit(); //SECURITY HAZARD: read below... 
```

然后你可以像这样检索它：

```
String username = p.getString("Lat", "");
String password = p.getString("Long", ""); 
```

希望它会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:37:10.117

制作这样的方法，只需将值作为参数传递。

```
private void SavePreferences(String key, String value){
    SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);
    SharedPreferences.Editor editor = sharedPreferences.edit();
    editor.putString(key, value);
    editor.commit();
   } 
```

你可以放很长时间。改成这个

```
private void SavePreferences(String key, long value)
editor.putInt(key,value) 
```

# jquery - 在下拉列表之间移动可拖动

> ID：13646173
> 
> 赞同：0
> 
> 时间：2012-11-30T13:24:59.503
> 
> 标签：jquery, jquery-ui, draggable, droppable

我正在制作一个导航菜单编辑界面，我有一个简单的多级菜单，鼠标悬停在展开子菜单上。

```
<nav>
    <ul class="sortable1 connectedSortable">
        <li class="droppable"><a href="#">Menu Item 1</a></li>
        <li class="droppable"><a href="#">Menu Item 2</a>
            <ul class=" sortable2 connectedSortable">
                <li><a href="#">Submenu Item 1</a></li>
                <li><a href="#">Submenu Item 2</a></li>
                <li><a href="#">Submenu Item 3</a></li>
            </ul>
        </li>
        <li class="droppable"><a href="#">Menu Item 3</a></li>
        <li class="droppable"><a href="#">Menu Item 4</a>
            <ul class=" sortable2 connectedSortable">
                <li><a href="#">Submenu Item 4</a></li>
                <li><a href="#">Submenu Item 5</a></li>
                <li><a href="#">Submenu Item 6</a></li>
            </ul>
        </li>
        <li class="droppable"><a href="#">Menu Item 5</a></li>
    </ul>
</nav>​ 
```

我想要的功能是当我将一个项目拖出子菜单时，子菜单将隐藏，当我将其拖入`li`具有子菜单的项目时，它将打开。

```
$(".droppable").hover(
    function () {
        $("ul", this).slideDown(100);
    },
    function () {
        $("ul", this).slideUp(100);
    }
).droppable({

    tolerance: 'intersect',
    over: function(event, ui) {
        if($(ui.draggable).parent() !== $(this)){
            $(ui.draggable).appendTo($(this));
        }

        $("ul", this).slideDown(100);
    },
    out: function(event, ui) {
        if($(ui.draggable).parent() !== $(this)){
            $(ui.draggable).appendTo($(this));
        }

        $("ul", this).slideUp(100);
    }
});​ 
```

问题是，当我使用 jQuery UI 可排序方法时，当我将鼠标`over:`悬停在`li`带有子菜单`ul`的我设置关闭菜单`li`的方法。`out:`

`ul`将可拖动对象移到其父对象之外后，如何保持打开状态`li`？

[http://jsfiddle.net/6pgHa/6/](http://jsfiddle.net/6pgHa/6/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:27:02.783

```
$(".sortable1, .sortable2").sortable({
    connectWith: ".connectedSortable",
    placeholder: "sortable-nav-items-placeholder"
}).disableSelection();

var dontClose = false;
$(".droppable").hover(
    function () {
        $("ul", this).slideDown(100);
    },
    function () {        
        $("ul", this).slideUp(100);
    }
).droppable({

    tolerance: 'intersect',
    activate: function(event, ui) {
        dontClose = !!(ui.draggable[0]);        
    },
    over: function(event, ui) {
        if($(ui.draggable).parent() !== $(this)){
            $(ui.draggable).appendTo($(this));
        }

        $("ul", this).slideDown(100);
    },
    out: function(event, ui) {
        if(dontClose) return;
        if($(ui.draggable).parent() !== $(this)){
            $(ui.draggable).appendTo($(this));
        }

        $("ul", this).slideUp(100);
    },
    drop : function(event, ui) {
        dontClose = false;        
    }
});​ 
```

好的，我已经用一些布尔标志修改了它们。现在没有时间进行测试，但它至少应该为您提供实验指导。如果有任何问题随时问我会在几个小时后看看这是 jsfiddle [http://jsfiddle.net/6pgHa/18/](http://jsfiddle.net/6pgHa/18/)

# ios - 应用内购买在 Apple Store 中不起作用，但在沙盒中起作用

> ID：13646175
> 
> 赞同：4
> 
> 时间：2012-11-30T13:25:08.463
> 
> 标签：ios, in-app-purchase

我正在开发一个带有应用内购买 (IAP) 的 iOS 应用程序。我已经测试了 IAP（在沙盒环境中）并且运行良好。Apple 接受了申请，我的 IAP 已准备好出售。但是当用户下载应用程序并尝试购买时，他们会收到**产品尚不可用**的警报。

有关信息，我有两个 Apple 帐户，一个用于客户，一个用于我。我在两个帐户中添加了相同的 productID。在我的帐户中，它仅用于测试，并且我使用相同的 productID 与客户帐户一起发布应用程序。

你认为在 Apple Store 中使用相同的 productID 会导致这个错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T15:38:28.467

最后它是Apple Store的一个错误，等待（6天）之后就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T20:32:35.660

批准后等了多久？我的经验是 4 小时的等待，请在此处查看 --- 另外，您可以通过链接中的一些内容查看是否有任何内容没有为您的应用正确设置。 [发布后 IAP 失败，但在开发阶段没有](https://stackoverflow.com/questions/13574037/iap-fails-after-release-but-no-in-development-stage)

# sql-server - 在 SQL Server Management Studio 中连接到 TFS 服务器

> ID：13646196
> 
> 赞同：2
> 
> 时间：2012-11-30T13:26:23.753
> 
> 标签：sql-server, sql-server-2008, tfs, ssms

我有一个 TFS 项目，可以在`http://machinename:8080/tfs/tfs.project`

我可以通过`http://machinename:8080/tfs/web`.

我安装了带有 Visual Studio Team Foundation Server MSSCCI Provider 和 Team Explorer 2010 的 SQL Server Management Studio 2008。

但是，当我将 TFS 服务器添加到列表时，我会看到一个非常严格的窗口，只允许我输入服务器名称和端口号。有了这个，我无法连接到我的 TFS 服务器，任何人都可以就如何解决这个问题提供一些建议吗？

我不断收到 HTTP 404 错误，因为它正在查看根目录 -`http://machinename:8080`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-17T22:17:01.467

我用相同的确切参数遇到了同样的问题。我发现如果您在服务器文本框中输入完整的 URL，它会解析。例子：`http://machinename:8080/tfs/DefaultCollection`

没有什么能清楚地解释这一点。

# python - 发送电子邮件以交换带有俄语文件名的附件

> ID：13646202
> 
> 赞同：1
> 
> 时间：2012-11-30T13:26:34.200
> 
> 标签：python, encoding, exchange-server, attachment, smtplib

我正在使用 python 2.7.3。我有以下代码用于发送带有附件的电子邮件。

```
# coding: cp1251
import os
import smtplib

from email import Encoders
from email.MIMEBase import MIMEBase
from email.MIMEMultipart import MIMEMultipart
from email.Utils import formatdate

def sendEmail(to_address, mail_settings, attachment_file_path, subject = 'my_subject'):

HOST = mail_settings['host']
port = mail_settings['port']
username = mail_settings['login']
password = mail_settings['pass']

msg = MIMEMultipart()
msg["From"] = mail_settings['from_address']
msg["To"] = ','.join(to_address)
msg["Subject"] = subject.decode('cp1251')
msg['Date'] = formatdate(localtime=True)
msg['Content-Type'] = "text/html; charset=cp1251"

# attach a file
part = MIMEBase('application', "octet-stream")
part.set_payload( open(attachment_file_path,"rb").read() )
Encoders.encode_base64(part)    
part.add_header('Content-Disposition', 'attachment; filename="%s"' % os.path.basename(attachment_file_path))
msg.attach(part)

server = smtplib.SMTP(host=HOST, port=port)           

try:
    failed = server.sendmail(mail_settings['from_address'], to_address, msg.as_string())        
    print('sent')
    server.close()
except Exception, e:
    errorMsg = "Unable to send email. Error: %s" % str(e)
    print(errorMsg) 
```

我的问题是，通过此代码接收电子邮件的交换用户如果有俄文字母（例如 пример.txt），则看不到附件文件名，否则如果它有英文字母，则一切正常。我只有使用 Exchange 的客户才会遇到这个问题（gmail 工作正常）。我做错了什么？我应该在哪里更改编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T11:36:00.980

我终于找到了解决方案。我只是为标题设置了编码。

```
mail_coding = 'utf-8'
att_header = Header(os.path.basename(attachment_file_path), mail_coding);
part.add_header('Content-Disposition', 'attachment; filename="%s"' % att_header) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-11T14:14:50.367

带着同样的问题来到这里，Savva Sergey 自己的解决方案对我不起作用。编码`os.path.basename(email_attach1).encode('utf-8')`也没有用。我很肯定这是因为 python 的版本而发生的。我的是 3.8，虽然我做的几乎一样，但它是有效的：

```
import os
from email.mime.application import MIMEApplication
email_attach1 = './path/to/文件.pdf'
part = MIMEApplication(
        open(email_attach1,"rb").read(),
        Name=os.path.basename(email_attach1),_subtype="pdf"
  )
part.add_header('Content-Disposition',
         'attachment',filename=os.path.basename(email_attach1)) 
```

# c# - ServiceStack DTO 组装

> ID：13646204
> 
> 赞同：8
> 
> 时间：2012-11-30T13:26:46.757
> 
> 标签：c#, .net-4.0, servicestack

我们正在构建 ServiceStack 的第一个小型实现，我们需要对位于客户端和服务器之间共享的单独程序集中的 DTO 进行一些说明。

[新 API 的 WIKI 页面](https://github.com/ServiceStack/ServiceStack/wiki/New-API)为 DTO 推荐以下内容

> *在服务开发中，您的服务 DTO 提供了与技术无关的服务层，您希望保持清洁并尽可能“无依赖”，以实现最大的可访问性和潜在的重用。我们的建议是将您的服务 DTO 保留在一个单独的、很大程度上无 dep 的程序集中。*

还有这个片段

> *但是，假设您采用复制 DTO 的正常路线（以二进制形式的任一源），因此您在客户端上有这样的东西：

```
[Route("/reqstars")]
public class AllReqstars : IReturn<List<Reqstar>> { }

The code on the client now just becomes:

var client = new JsonServiceClient(BaseUri);
List<Reqstar> response = client.Get(new AllReqstars()); 
```

> *它向 /reqstars 路由发出 GET Web 请求。当客户端上不存在自定义路由时，它会自动回退到使用 ServiceStack 的预定义路由。*

我的问题是……由于 DTO 类的路由属性，“很大程度上无依赖”的程序集是否仍然需要对 ServiceStack 的依赖？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-30T17:53:48.473

该`[Route]`属性存在于[ServiceStack.Interfaces](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/ServiceHost/RouteAttribute.cs)项目中，因此您仍然只需要对依赖项和 impl-free **ServiceStack.Interfaces.dll**的引用。这是设计使然，我们希望确保尽可能减少依赖关系，这就是为什么我们将尝试保留您可能在 Interfaces 项目中的 DTO 上使用的所有元数据属性。

想要将 DTO 保存在单独的程序集中的原因是为了减少客户使用它所需的依赖关系。这使其侵入性更小，客户更容易访问。此外，您的 DTO 代表您的服务合同，将它们分开会鼓励将它们与实现分离的良好实践，您希望继续自由地对其进行重构。

# linux-kernel - 更改linux内核系统调用号

> ID：13646207
> 
> 赞同：6
> 
> 时间：2012-11-30T13:26:54.593
> 
> 标签：linux-kernel, glibc, system-calls

我想用不同的系统调用表构建我自己的自定义内核。（相同的系统调用，但位置/编号不同）

我正在研究内核 3.2.29。

更改内核非常简单：

1) 在arch/x86/kernel/syscall_table_32.S中改变系统调用位置</p>

2) 更改 arch/x86/include/asm/unistd_32.h 中的系统调用宏号

3）编译安装新内核

我切换了系统调用：`sys_open`取代了 的位置和数量`sys_read`，反之亦然。

我想如果我`glibc`使用修改后的内核头文件进行编译，我可以拥有一个正在运行的系统，但不幸的是，这还不够，我的系统无法启动。

我错过了什么吗？为了拥有一个正在运行的系统，我还需要做什么？

* * *

我采取的步骤是：

1）如我的问题中所述构建和安装内核

2）使用提取新的内核头文件`make headers_install INSTALL_HDR_PATH=[path]`

3) 使用参数构建 glibc`--with-headers=[path/include]`

4）我使用live cd从外部访问文件系统以安装新的`glibc`，使用`make install install_root=[the original file system]`（因此系统在安装过程中不会中断）

我希望新`glibc`的建造得当，但我不确定。

之后，在引导系统时，引导停止在 (initrafms) shell 屏幕中：我想我需要重新构建`initrd`，但是如何根据新的 syscall 表编译它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:41:47.290

你将不得不重建*一切*。即使您的所有二进制文件都是动态链接的，旧的系统调用也有可能被内联到二进制文件中，因为许多 C 函数只是`return syscall(__NR_somecall,...)`.

您*可以*手动执行此操作，但除非您使用像 buildroot、aboriginal 或类似工具这样的交叉编译工具链，否则很难保持工具链正常。选择最适合您的（我更喜欢 Rob Landley 的原住民 - [http://landley.net/aboriginal/](http://landley.net/aboriginal/)）

然后使用 {z,bz,xz}cat oldinit.rd |cpio -id; 使您的 initrd 扩展旧的 rm oldinit.rd。用新的和 cpio 替换旧的内核模块、库和二进制文件并将其压缩回来（cpio 需要 -H newc 选项）...或者现在您可以重建内核并将 initramfs 指向该目录，但不推荐如果您的 initrd 可能需要经常更改，例如您正在测试一个全新的系统调用结构并且必须进行大量调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:58:00.460

您还没有说引导在什么时候失败，但是即使内核启动，initrd 压缩 ramdisk 中包含的关键程序也可能会失败，因为它们具有硬编码的原始系统调用号。您还需要重建和重新打包它们。

您可能会考虑首先将 init 替换为静态的 hello-world 类型的程序，以验证您的内核是否完全支持用户空间；然后研究使现代 linux 用户空间的所有复杂性匹配的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:54:05.607

打乱系统调用号码真的会很痛苦。您至少需要重建系统和 initrd 上的所有静态链接二进制文件（如果您使用的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-12T01:54:38.953

你必须学会​​阅读 pansic dump 的信息并向我们展示什么是 kenrel 恐慌。没有这些信息，人们几乎无法帮助您或为您提供有用的建议。

# java - 在休眠中从集合中删除实体

> ID：13646209
> 
> 赞同：2
> 
> 时间：2012-11-30T13:26:56.800
> 
> 标签：java, database, hibernate

我正在尝试手动删除实体集合中的每个实体。问题是，实体不会从数据库中删除，即使它们已从任务的集合中删除。

下面是我用来实现这一点的代码：

```
public int removeExistingCosts(final DataStoreTask task) {

    int removedAccumulator = 0;
    Query query = entityManager.createNamedQuery(DataStoreCost.GET_COSTS_FOR_TASK);
    query.setParameter(DataStoreCost.TASK_VARIABLE_NAME, task);

    try {

        List costsForTask = query.getResultList();
        for(Object cost : costsForTask) {
            task.getCosts().remove(cost);
            removedAccumulator++;
        }

    } catch (NoResultException e) {
        logger.debug("Couldn't costs for task: {}", task.getId());
    }

    entityManager.flush();
    entityManager.persist(task);

    return removedAccumulator;
} 
```

有任何想法吗？

PS集合表示为：

```
@OneToMany(targetEntity = DataStoreCost.class, mappedBy = "task", cascade = CascadeType.ALL)
private Collection<DataStoreCost> costs; 
```

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:34:08.500

它没有删除实体，因为它不知道是否有其他东西在引用它。

您需要启用删除孤儿。在 jpa2 中，使用[orphanRemoval](http://docs.oracle.com/cd/E19798-01/821-1841/giqxy/index.html)属性。如果您使用的是休眠注释，请使用 CascadeStyle 删除孤儿。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:35:20.403

我认为您需要`Cost`通过`entityManager`. 当您`Cost`从`Tasks`成本列表中删除时，您实际上只删除了对该实例的引用。它不知道该特定`Cost`内容不会在其他任何地方使用。

# mysql - 在 Office Excel 中自定义 Mysql DB 提取

> ID：13646210
> 
> 赞同：0
> 
> 时间：2012-11-30T13:27:06.257
> 
> 标签：mysql, excel, ms-office

我可以使用 odbc 连接从 excel 中获取 sql 查询：

但问题是，我希望我可以在结果之前有一些字段，而不是只提供堆栈查询设置并使用户只能单击刷新按钮，以便用户可以输入一些自定义变量（例如日期从、日期到）

因此，当他们单击刷新按钮时，excel 将获取用户输入到预定义 sql 查询中的变量，并从我的 sql 服务器中获取结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:48:28.270

要执行此类操作，您需要运行一个查询以从 DBMS 获取自定义变量的初始值。例如，如果您想让用户更改日期范围，请执行此操作。

1.  使用查询从表的日期列中获取最小和最大日期。

    ```
    SELECT MIN(date) mindate, MAX(date) maxdate
      FROM table 
    ```

2.  显示这些日期并让用户在您的表单上编辑它们。

3.  将这些已编辑项目的结果放入您的第二个查询中，并检索用户要求的数据。

    ```
    SELECT (whatever) 
      FROM table
     WHERE date BETWEEN user-min-date AND user-max-date 
    ```

相同类型的步骤将用于填充具有类别的下拉列表或列表框

```
 SELECT DISTINCT category
      FROM table
     ORDER BY category 
```

然后

```
 SELECT (whatever)
      FROM table
     WHERE category = user-selected-category 
```

我*认为*这解决了你的问题。如果不是，请澄清。

# java - 数组元素的 JAXB XmlElement maxOccurs 问题

> ID：13646211
> 
> 赞同：2
> 
> 时间：2012-11-30T13:27:12.597
> 
> 标签：java, xml, web-services, xsd, jaxb

我使用下面的 getter 方法级别 XmlElement 注释从 Java 类生成 xsd。

**@XmlElement(type=Integer.class, required=true)**

*公共 int [] getTestArrayInt () { .... }*

**生成的 XML 元素：**

```
<xsd:element name="testArrayInt" type="xsd:int"/> 
```

minOccurs 的默认值为 1。因此，此处不显示。但是缺少应该为 Array 元素列出的**maxOccurs="unbounded" 。**Soap UI 期望 maxOccurs="unbounded" 出现在数组元素中。因此，在 Soap UI 中，此元素不会被视为数组。

当我从注释中删除**type=Integer.class**时，我开始在 XML 中获取**maxOccurs="unbounded" 。**

**@XmlElement(required=true)**生成以下元素：

```
<xsd:element name="testArrayInt" type="xsd:int" maxOccurs="unbounded"/> 
```

但我需要这种***类型***专门用于原始数据类型。如果没有***输入***注释，**minOccurs=1**会丢失不需要的元素**（即 required =true 未设置）**。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:00:56.823

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

您描述的问题似乎发生在 EclipseLink JAXB (MOXy) 中，而不是 JAXB 参考实现中。MOXy 是 WebLogic 12.1.1 中的默认 JAXB 提供程序（请参阅： [http](http://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html) ://blog.bdoughan.com/2011/12/eclipselink-moxy-is-jaxb-provider-in.html ）。您可以使用以下错误跟踪我们在此问题上的进展。如果您是 WebLogic 客户，请输入错误，以便您收到相应的补丁。

*   [http://bugs.eclipse.org/395480](http://bugs.eclipse.org/395480)

**Java 模型**

```
package forum13646211;

import javax.xml.bind.annotation.XmlElement;

public class Root {

    private int[] testArrayInt;

    @XmlElement(type=Integer.class)
    public int [] getTestArrayInt () {
        return testArrayInt;
    }

    public void setTestArrayInt(int[] array) {
        this.testArrayInt = array;
    }

} 
```

**架构（由 JAXB RI 生成）**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<xs:schema version="1.0" xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:complexType name="root">
    <xs:sequence>
      <xs:element name="testArrayInt" type="xs:int" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
</xs:schema> 
```

**模式（由 EclipseLink JAXB (MOXy) 生成）**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <xsd:complexType name="root">
      <xsd:sequence>
         <xsd:element name="testArrayInt" type="xsd:int" minOccurs="0"/>
      </xsd:sequence>
   </xsd:complexType>
</xsd:schema> 
```

**模式生成代码**

```
package forum13646211;

import java.io.IOException;
import javax.xml.bind.*;
import javax.xml.transform.Result;
import javax.xml.transform.stream.StreamResult;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Root.class);

        jc.generateSchema(new SchemaOutputResolver() {

            @Override
            public Result createOutput(String namespaceUri,
                    String suggestedFileName) throws IOException {
                StreamResult result = new StreamResult(System.out);
                result.setSystemId(suggestedFileName);
                return result;
            }

        });

    }

} 
```

# ruby - 记录到 rake 的跟踪日志

> ID：13646213
> 
> 赞同：2
> 
> 时间：2012-11-30T13:27:21.243
> 
> 标签：ruby, rake

是否可以将自定义消息打印到输出`rake --trace`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-11-28T16:21:55.790

便宜又讨厌的方法（对于任何阅读的人）是使用 --verbose 选项运行 rake，然后使用标准`puts`Ruby 函数写出您的调试行。

但这很讨厌。

# jquery - jQuery + CSS | 水平滚动

> ID：13646214
> 
> 赞同：0
> 
> 时间：2012-11-30T13:27:22.393
> 
> 标签：jquery, css

我试图让我的 div 水平滚动。我的 div 是 100%，我希望整个 div 大小 (100%) 滚动以显示更多 div。像这样：

![在此处输入图像描述](../Images/0f5b185ed9e1a6161837977da0697a57.png)

我已经有按钮告诉 JS 滚动 +150%，但我不能正常工作。

现在，情况是这样，我的 div 是 100%，但是，在那个 div 中，是一个 800x500 的图像，我想在 100& div 内垂直/水平居中。

所以当我按下箭头时，我希望它移动 div1 到 div2，然后 div2，到 div3... 等。

谢谢

[这是我的代码](http://jsfiddle.net/oliverj777/xh4xA/)

HTML：

```
<div class= "edge_container" data-stellar-ratio="3">

        <div class = "edge_wrapper">

            <div class="OLLIEJ_Welcome"> <!--id="stage0" data-slide="0">-->
                Hello &amp; Test
            </div>

            <div class="EDGE_idea"> <!--id="stage1" data-slide="1">-->
                IDEAS &amp; CONCEPTS
            </div>

            <div class="OLLIEJ_002"> <!--id="stage2" data-slide="2">-->
                RESEARCH &amp; DEVELOPMENT
            </div>

            <div class="OLLIEJ_003"> <!--id="stage3" data-slide="3">-->
                BUILD &amp; PRODUCTION
            </div>

        </div>

    </div> 
```

CSS：

```
.edge_container{
    position:absolute;
    height: 550px;
    overflow: hidden;   
    width:100%;
    white-space: nowrap;

    display:block;

    top: 50%;
    margin-top: -250px;

    background-color:#00FFFF;
}

.edge_wrapper{
    /*position:absolute;*/
    width: 300%;
    white-space: nowrap;
    vertical-align: top;
    background-color:#3366FF;

}

.OLLIEJ_Welcome{
    height: 500px;
    width: 800px;
    display: inline-block;
    white-space: normal;
    margin-left: 50%;
    left: -400px;
    padding-left: 2px;

}

.EDGE_idea{
    height: 500px;
    width: 800px;

    display: inline-block;
    white-space: normal;
    margin-left: 50%;
    left: -400px;
    padding-left: 2px;

}

.OLLIEJ_002{
    height: 500px;
    width: 800px;
    display: inline-block;
    white-space: normal;
    margin-left: 50%;
    left: -400px;
    padding-left: 2px;
}

.OLLIEJ_003{
    height: 500px;
    width: 800px;

    display: inline-block;
    white-space: normal;
    margin-left: 50%;
    left: -400px;
    padding-left: 2px;

} 
```

JS：

```
button_right_0.click(function (e) {
        //dataslide = $(this).attr('data-slide');

        if(horSlide_0 < 3){
            console.debug("Button Pressed");
            $('.edge_wrapper').animate({marginLeft: '-=100%'},1000, 'easeInOutQuint'); 
            //horSlide_0 ++;
        }
        //hideButtons(dataslide);

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:47:49.747

你需要有两个`div`元素。第一个用作掩码，仅显示您希望的内容（即每张幻灯片）。然后你有另一个`div`内部包含所有元素。像这样的东西应该可以满足您的需求：

```
<div id="slider_mask">
    <div id="slider_content">
        <img src="src/to/img1.jpg" />
        <img src="src/to/img2.jpg" />
    </div>
</div> 
```

你的 CSS 应该看起来像这样（你可以使用 jQuery 来计算 的总宽度`#slider_content`，基于`outerWidth()`其子节点的 ：

```
#slider_mask {
    width: 100%;
    height: 500px;
    overflow: hidden;
    position: relative;
}

#slider_content {
    width: 2400px; /* 800 * 3 */
    height: 500px;
    position: absolute;
    top: 0;
    left: 0;
}
    #slider_content img {
        width: 800px;
        height: 500px;
        float: left;
    } 
```

现在使用您的标记，您可以`keypress`通过 jQuery 处理事件，对以下`left`属性进行动画处理`#slider_content`：

```
var curr_left = 0,
      content = $('#slider_content');

$(window).keyup(function(e) {
    // Right arrow key:
    if(e.which == 39)
    {
        // Animate to the left if it's not already set:
        if(curr_left <= 0 && curr_left > -1600)
        {
            content.animate({ 'left': (curr_left - 800) }, 'fast', function() { 
                curr_left -= 800 
            });
        }
    }

    // Left arrow key:
    else if(e.which == 37)
    {
        if(curr_left < 0)
        {
            content.animate({ 'left': (curr_left + 800) }, 'fast', function() { 
                curr_left += 800 
            });
        }
    }
});​ 
```

我整理了一个快速的 jsFiddle 来向您展示一个工作示例：http: [//jsfiddle.net/Y2Ese/](http://jsfiddle.net/Y2Ese/)

# breeze - 嵌套查询/导航属性集合

> ID：13646217
> 
> 赞同：1
> 
> 时间：2012-11-30T13:27:30.083
> 
> 标签：breeze

假设以下模型：（示例取自 Breeze DocCode）

```
public class Customer {

    public Guid CustomerID { get; internal set; }
    public ICollection<Order> Orders { get; set; }
}

public class SomeDetail{
    public string name{ get; set; }
}

public class Order {

    public int OrderID {get; set;}
    public Guid? CustomerID {get; set;}

    public SomeDetail detail {get; set;}
} 
```

我很清楚针对单个导航属性的嵌套查询。如果导航属性是一个集合，怎么能做到这一点？像这样的东西：

```
var query = EntityQuery.from("Customers")
                 .where("Orders.detail.name", "==", someName); 
```

作为“文本”：选择该客户拥有的任何订单的详细信息名称等于 someCondition 的所有客户？

我在这里遇到错误，因为

```
.where("Orders.detail.name, "=", someCondition) 
```

由于收集是不可能的。有没有一种简单的方法来检查这种情况，而不需要建立一个数量的集合和每手过滤？

在这里非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-26T19:30:50.453

从 Breeze 1.4.6 开始，我们添加了对两个新查询运算符的支持：“any”和“all”

这意味着您的查询现在看起来像这样。

```
var query = EntityQuery.from("Customers")
   .where("Orders", "any", "detail.name", "==", someName); 
```

请参阅：[http ://www.breezejs.com/documentation/query-examples](http://www.breezejs.com/documentation/query-examples)

# java - 使用 jpa 持久化实体时哪个 java 集合对象最好

> ID：13646220
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:27:34.723
> 
> 标签：java, jpa, jpa-2.0

我正在编写一个应用程序，它解析 n 条记录，每条记录有 m 个字段。它类似于从 ip 数据包中解析头信息。一个区别是我正在使用的记录具有用于可选用户评论的字段数组。我的问题是，持久化字段集合的最佳 java.util.collection 对象是什么？一个集合可能最适合我想要做的事情，因为多个“评论”字段必须是唯一的，但是在选择一种集合类型而不是另一种集合类型时是否存在任何性能或序列化问题？下面是我正在尝试做的伪代码：

```
@Entity
public class MyRecord implements Serializable{
    @Id
    private int id;
    private String filename;
    @OneToMany(targetEntity=MyField.class, mappedBy="filename") 
    private Set<MyField> field;
}

public class MyField implements Serializable{

    private int id;
    private String filename;
    private String filePath;
    private String fieldName;
    private String fieldType;
    private String fieldValue;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:48:22.727

您可以自己控制最终的序列化性能，看看`Externalizable`界面（[http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html](http://docs.oracle.com/javase/7/docs/api/java/io/Externalizable.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:40:20.540

您可以`Collection`为未来的变化做好准备。也许有一天`MyField`被允许不唯一。

# javascript - 在移动版网站中集成 OAuth 工作流程

> ID：13646221
> 
> 赞同：4
> 
> 时间：2012-11-30T13:27:39.383
> 
> 标签：javascript, jquery, mobile

我们为 twitter 和 facebook 等服务提供以下工作流程：

1.  用户点击“发布”按钮。
2.  我们在服务器上获取 auth url
3.  我们发送到客户端验证 url
4.  **客户端在标准 javascript 弹出窗口**中打开 auth url
***   客户端通过回调url授权并返回*   在回调 url 上，我们与社交服务交互。**

 **我们在手机上的第 4 步遇到了很大的麻烦。

标准 javascript 弹出窗口无法在移动设备上运行。我们可以为外部身份验证网址使用哪些替代方案？

**UPD**临时解决方案是生成身份验证链接作为锚点并将它们放置在文档中。它解决了问题，但我们想要更好的用户体验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-04T08:02:16.570

我正在为这个移动网站使用[jquery 移动弹出窗口](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/popup/)，它看起来也很完美的桌面浏览器。我希望你使用这样的回调（我使用这样的东西）

```
var jsonp = document.createElement("script");
        jsonp.type = "text/javascript";
        jsonp.src = "http://foo.com/api/ad?foo_var=4345&callback=displayinfo";
        document.getElementsByTagName("body")[0].appendChild(jsonp); 
```

在回调函数中，您可以使用那些弹出窗口，如

```
function displayinfo(data) {    
$("#somepopup").html('<div data-role="popup">
                        '+data+'
                    <div id="ok" data-inline=true data-role=button>
                        <a class="ui-link-inherit" href="">Ok</a>
                    </div>
                    <div id="cancel" data-inline=true data-role=button>
                        <a class="ui-link-inherit" href="">Cancel</a>
                    </div>
                    </div>');

                $('#ok').button();
                $('#cancel').button();

                $("#somepopup").popup();
} 
```

您的文档中应该有一个 id 为 somepopup 的 div，如果您实现 jquery mobile，所有这些都可以正常工作。我希望这有帮助。**

# ios - HTTP 实时流式传输。“跳过自动播放，没有足够的缓冲跟上。”

> ID：13646224
> 
> 赞同：2
> 
> 时间：2012-11-30T13:27:54.433
> 
> 标签：ios, ios6, http-live-streaming, buffering

在新的 iOS 6 中，我开始出现 MPAVController 的奇怪行为。我的应用通过 HTTP Live Streaming 从服务器接收视频。现在我经常看到这样的消息：

```
[MPAVController] Autoplay: Disabling autoplay
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: Likely to keep up or full buffer: 0
[MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
[MPCloudAssetDownloadController] Prioritization requested for media item ID: 0
[MPAVController] Autoplay: Likely to keep up or full buffer: 0
[MPAVController] Autoplay: Skipping autoplay, not enough buffered to keep up.
[MPAVController] Autoplay: Enabling autoplay
[MPAVController] Autoplay: _streamLikelyToKeepUp: 0 -> 1
[MPAVController] Autoplay: Likely to keep up or full buffer: 1
[MPAVController] Autoplay: Enabling autoplay 
```

并且视频经常停滞不前。此外，有时会出现一个很大的 QuickTime 标志而不是视频播放。

没有找到有关这些问题的任何官方信息，所以我恳请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T13:18:18.517

我最近遇到了类似的问题，删除 EXT-X-PLAYLIST-TYPE:EVENT 帮助解决了这个问题。目前我的 m3u8 播放列表中没有 EXT-X-PLAYLIST-TYPE，一切正常。

# asp.net - 向数据表添加行时出现 StackOverflowException

> ID：13646226
> 
> 赞同：1
> 
> 时间：2012-11-30T13:27:55.133
> 
> 标签：asp.net, vb.net, exception

使用递归来建立层次结构。

此递归在 windows server 2003 + IIS6 中运行良好，但在 windows server 2008 R2 和 IIS 7.0 中抛出异常

这是代码片段：

```
Public Sub Expand(ByVal SE_Index As Int64)

    Dim row As DataRow

    If aryHierarchyData(SE_Index).Visable = True Then
        aryHierarchyData(SE_Index).Target_Row = gvCurrent_Row_Number
        gvCurrent_Row_Number = gvCurrent_Row_Number + 1

        Try
            row = dtExpand.NewRow
            row("SE_NO") = aryHierarchyData(SE_Index).SE_No
            row("Selection_Index") = aryHierarchyData(SE_Index).Selection_Index
            **dtExpand.Rows.Add(row)**--->>>throwing error "stackoverflow"

        Catch ex As StackOverflowException
            If (ex.Message.Contains("Column 'SE_NO, Selection_Index' is constrained to  be unique.")) Then
                Exit Sub
            End If

        Catch ex As Exception

        Finally
            row = Nothing
        End Try

        ' expand this SE's children  -  first
        If aryHierarchyData(SE_Index).Child > 0 Then
            Expand(aryHierarchyData(SE_Index).Child)
        End If
    End If

    ' expand this SE's Siblings  -  second

    If aryHierarchyData(SE_Index).Sibling > 0 Then
        Expand(aryHierarchyData(SE_Index).Sibling)
    End If

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T07:45:35.727

```
Stackoverflow problem could be solved using thread.
Call expand() under recursivethread function.

Private Sub RecurseThread(totalSeCount As Long)
 For iIdx = 1 To totalSeCount
    If aryHierarchyData(iIdx).Target_Row = 0 Then
    dtExpand.Clear()
    dtExpand.AcceptChanges()
    Expand(iIdx)
  End If
Next iIdx
End Sub

Dim t As Thread = New Thread(AddressOf RecurseThread, 1024 * 1024)
t.Start(totalSeCount)
t.Join() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:02:34.443

此异常取决于计算机内存和框架。它与 IIS 和 windows 服务器无关。

**执行堆栈溢出时抛出的异常，因为它包含*太多的*嵌套方法调用。这个类不能被继承。**[MSDN](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception%28v=vs.80%29.aspx)

我对您的代码进行了一些更改。我根据我的经验更改上述声明

Framework 4.0 **执行堆栈溢出时抛出的异常，因为它包含*7573 个*嵌套方法调用。这个类不能被继承。**

Framework 2.0 **执行堆栈溢出时抛出的异常，因为它包含*7038 个*嵌套方法调用。这个类不能被继承。**

# git - git中奇怪的远程分支

> ID：13646228
> 
> 赞同：1
> 
> 时间：2012-11-30T13:28:09.620
> 
> 标签：git, remote-branch

该`git branch -a`命令给了我以下输出：

```
master
stable
remotes/origin/master
remotes/origin/restoring_entered_information_from_post
remotes/origin/stable 
```

但是`restoring_entered_information_from_post`在 Github 上没有这样的分支，我从来没有在本地创建它，并且尝试用`git push origin :restoring_entered_information_from_post`它删除它时响应：

```
error: unable to push to unqualified destination: restoring_entered_information_from_post
The destination refspec neither matches an existing ref on the remote nor
begins with refs/, and we are unable to guess a prefix based on the source ref.
error: failed to push some refs to 'git@github.com:MyCompany/mywebsite.git' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T13:34:10.377

该分支很可能在过去有时确实存在，并在 Github 上被删除。Git 默认不会删除这些陈旧的分支。要删除不存在的远程分支，您可以使用：

```
git remote prune origin 
```

你可能想先在空运行模式下运行它，看看它会删除什么：

```
git remote prune -n origin 
```

# java - 从java应用程序到applet？

> ID：13646237
> 
> 赞同：0
> 
> 时间：2012-11-30T13:28:36.927
> 
> 标签：java, jakarta-ee, applet

我从未使用过小程序并且有以下问题：

*   是否可以通过提供不同的界面将现有的 Java 桌面应用程序移植到 Applet？我可以重用 GUI 背后的所有东西（服务、注入、数据库）吗？

*   Java EE 应用程序是否也一样？只是提供不同的 UI 并重用其余代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:31:49.017

基本上，您只需将 JFrame 或您之前使用的任何内容嵌入到扩展 Applet 的类中。不，您不能使用所有东西，Applets 有一些安全限制（例如访问文件系统），直到它们被签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:37:19.687

UI 等大部分是“可重复使用的”，但小程序也受到更严格的沙盒；小程序仅限于用户允许的权限和/或添加到用户机器上的 JVM 设置。（对于诸如数据库连接之类的小程序的端口访问也有限制 - 以及可能的防火墙注意事项。

因此，答案是“是的，但仍有很多工作要做。了解基于您的用户群的工作类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:09:41.683

基本上，当您制作小程序时，您不能使用框架或菜单。您应该使用面板并对其进行处理。之后的大部分事情都是简单而相同的。

# asp.net-mvc - 使用 ASP.Net MVC 在超链接中分配变量

> ID：13646240
> 
> 赞同：0
> 
> 时间：2012-11-30T13:28:43.613
> 
> 标签：asp.net-mvc, hyperlink

我已经定义了一个变量：

```
 <%int imageTypSelected = 0; %> 
```

我有这些：

```
 <div class="imageToEdit" >
         <img src='<%: Url.Action("getImg", "Pr", new{Id = Model.Id}) %>'   alt="" />
         <a href="#" onclick="jQuery('#dialog').dialog('open'); return false; ">A</a>             
        </div>

        <div class="imageToEdit" >
         <img src='<%: Url.Action("getImg_Alt1", "Pr", new{Id = Model.Id}) %>'   alt="" />
         <a href="#" onclick="jQuery('#dialog').dialog('open'); return false">B</a>           
        </div>

        <div class="imageToEdit" >
         <img src='<%: Url.Action("getImg_Alt2", "Pr", new{Id = Model.Id}) %>'   alt="" />
         <a href="#" onclick="jQuery('#dialog').dialog('open'); return false">C</a>            
        </div> 
```

现在我希望当用户选择第一个超链接“1”时分配给变量。对于第二个超链接“2”和最后一个“3”。但是怎么做？此变量稍后将发布到控制器中的方法。我怎么能有这个任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:19:45.640

您需要将控制器中的值传递回您的视图；要么将其作为模型的一部分，要么将其添加到`ViewBag`. 然后，您可以像这样分配它：

```
<% int imageTypSelected = Model.ImageTypeSelected; %> 
```

...或者像这样：

```
<% int imageTypSelected = (int)ViewBag.ImageTypeSelected; %> 
```

# scala - 如何减少在 Scala 中创建的对象数量？

> ID：13646243
> 
> 赞同：11
> 
> 时间：2012-11-30T13:28:47.193
> 
> 标签：scala, memory, memory-management, garbage-collection, jvm

我正在用 Scala 编写一个计算机图形应用程序，它使用 RGB 类返回图像中某个点的颜色。可以想象，返回颜色 RGB 对象的函数被多次调用。

```
class RGB(val red: Int, val green: Int, val blue: Int) { } 
```

有一个函数 getPixelRGB 经常使用如下

```
val color:RGB = getPixelRGB(image, x, y) 
```

问题是我可能会调用这个函数一百万次，然后我相信它会生成一百万个唯一的 RGB 对象实例，这是一个非常没有吸引力的情况。对此我有一些想法：

1.  如果 getPixelRGB 被调用无数次，它可能会创建无限数量的对象，但它不一定是无限数量的对象，因为 RGB 最多只能生成 255 * 255 * 255 种可能的组合。所以创建的对象数量“应该”是有限的。可以调整此函数以使用对象池，如果它要返回与某个时间相同的颜色，则它可以返回该颜色的相同池对象实例。

2.  我可以将此 RGB 编码为 Int。Int 的内存开销比普通的 Scala/Java 对象少，Java 对象有额外的内存开销。由于 Scala Int 类型是 4 个字节宽，前 3 个字节可以存储 RGB 值。我假设只从 getPixelRGB 方法返回 Int 而不是 RGB 会减少内存开销。但是，如何在仍然具有 RGB 类的说服力的同时做到这一点？

3.  据说，它们是短命的对象，我已经读过垃圾收集器应该迅速回收它们。不过我还是很担心。GC 怎么知道我很快就把它扔掉了？如此混乱。

所以总的来说，我的问题是如何让这个 getPixelRGB 对内存更友好？我也应该担心吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-30T13:48:11.380

您可以使用单个 long或[int](https://stackoverflow.com/a/13646533/298389)[对 RGB 进行编码](http://www.pbdr.com/pbtips/ps/rgblong.htm)。此外，在 scala 2.10 中，您可以为原始值定义[值类](http://docs.scala-lang.org/sips/pending/value-classes.html)，例如

```
class RGB private(val underlying: Long) extends AnyVal {
  def toTriple = /*decoding to (red, green, blue)*/
} 
object RGB {
  def apply(red: Int, green: Int, blue: Int) = /* encode and create class with new RGB(longvalue)*/
} 
```

使用值类，您仍然可以拥有类型信息并享受 JVM 中的无类内存布局。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-30T14:11:57.110

您的问题 #3 尚未解决，所以我会试一试。

> GC 是如何知道我正在快速扔掉 [short living objects] 的？

现代 GC 的工作是基于对不同生命周期的对象的行为非常不同的观察。所以它在所谓的*几代人中*管理它们。刚刚创建的对象存储在*eden*空间中。当它填满时，其中仍然被引用的所有对象（即它们是活动的）都被复制到所谓*的年轻代*空间。因此，所有死物都被留下，它们占据的空间几乎是零努力地回收。这就是使短期对象对 JVM 来说如此便宜的原因。并且大多数由普通程序创建的对象都是临时变量或局部变量，它们很快就会超出范围。

在第一轮 GC 之后，以类似的方式管理年轻代空间，只是它们可能更多。GC 可以配置为让对象在年轻代空间中花费一轮或多轮。然后最终，最后的幸存者被迁移到*幸存者*（又名*老一代*）空间，他们将在那里度过余生。这个空间是通过定期应用经典*标记和扫描的一些变体来管理的*技术：遍历所有活动引用的图表并标记活动对象，然后通过将幸存者压缩成一个连续的内存块来清除所有未标记（死）的对象，从而对空闲内存进行碎片整理。这是一项昂贵的操作，会阻塞程序的执行，并且很难正确实现，尤其是在现代多线程 VM 中。这就是发明分代 GC 的原因，以确保创建的所有对象中只有一小部分能够到达这个阶段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-30T13:47:48.010

就内存友好性而言，最有效的解决方案是将完整的颜色信息存储在一个 Int 中。正如您正确提到的，颜色信息只需要三个字节，所以四个字节的 Int 就足够了。您可以使用位操作对来自一个 Int 的 RGB 信息进行编码和解码：

```
def toColorCode(r: Int, g: Int, b: Int) = r << 16 | g << 8 | b

def toRGB(code: Int): (Int, Int, Int) = (
  (code & 0xFF0000) >> 16, 
  (code & 0x00FF00) >> 8, 
  (code & 0x0000FF)
) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-30T14:08:38.197

> 据说，它们是短命的对象，我已经读过垃圾收集器应该迅速回收它们。不过我还是很担心。GC 怎么知道我很快就把它扔掉了？如此混乱。

它不知道。它*假设*它。这被称为构建所有世代垃圾收集器的*世代假设：*

*   几乎所有的物体都会英年早逝
*   几乎没有旧对象包含对新对象的引用

满足这个假设的对象*非常*便宜（实际上甚至比C`malloc`等`free`语言更便宜），只有违反一个或两个假设的对象才是昂贵的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-30T13:39:29.377

您可以有一个返回简单`Int`. 然后，您可以在需要时使用*隐式*转换将 a`Int`视为`RGB`对象。

```
case class RBGInt(red: Int, green: Int, blue: Int) {
   // ...
}

object Conversions { 

  implicit def toRGBInt(p: Int) = {
    val (r, g, b) = /* some bitmanipulation to turn p into 3 ints */
    RGBInt(r, g, b)
  }

} 
```

然后，您可以将 any`Int`视为`RGBInt`您认为有意义的地方：

```
type RGB = Int // useful in documenting interfaces that consume
               // or returns Ints which represent RGBs

def getPixelRGB(img: Image, x: Int, y: Int): RGB = {
  // returns an Int
}

def someMethod(..) = {
  import Conversions._
  val px: RGB = getPixelRGB(...) // px is actually an Int
  px.red // px, an Int is lifted to an RGBInt
} 
```

# python - 是否可以在 Python 中创建抽象类？

> ID：13646245
> 
> 赞同：417
> 
> 时间：2012-11-30T13:29:16.500
> 
> 标签：python, class, inheritance, abstract-class, abstract

如何在 Python 中创建类或方法抽象？

我尝试`__new__()`像这样重新定义：

```
class F:
    def __new__(cls):
        raise Exception("Unable to create an instance of abstract class %s" %cls) 
```

但是现在如果我创建一个`G`继承自`F`这样的类：

```
class G(F):
    pass 
```

那么我也不能实例化`G`，因为它调用了它的超类的`__new__`方法。

有没有更好的方法来定义抽象类？

* * *

## 回答 #1

> 赞同：702
> 
> 时间：2012-11-30T13:30:44.927

使用该[`abc`](http://docs.python.org/library/abc.html)模块创建抽象类。使用[`abstractmethod`](https://docs.python.org/library/abc.html#abc.abstractmethod)装饰器声明方法抽象，并使用三种方式之一声明类抽象，具体取决于您的 Python 版本。

在 Python 3.4 及更高版本中，您可以从[`ABC`](https://docs.python.org/3/library/abc.html#abc.ABC). 在早期版本的 Python 中，您需要将类的元类指定为[`ABCMeta`](https://docs.python.org/library/abc.html#abc.ABCMeta). 在 Python 3 和 Python 2 中指定元类有不同的语法。三种可能性如下所示：

```
# Python 3.4+
from abc import ABC, abstractmethod
class Abstract(ABC):
    @abstractmethod
    def foo(self):
        pass 
```

```
# Python 3.0+
from abc import ABCMeta, abstractmethod
class Abstract(metaclass=ABCMeta):
    @abstractmethod
    def foo(self):
        pass 
```

```
# Python 2
from abc import ABCMeta, abstractmethod
class Abstract:
    __metaclass__ = ABCMeta

    @abstractmethod
    def foo(self):
        pass 
```

无论您使用哪种方式，您都无法实例化具有抽象方法的抽象类，但能够实例化提供这些方法的具体定义的子类：

```
>>> Abstract()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: Can't instantiate abstract class Abstract with abstract methods foo
>>> class StillAbstract(Abstract):
...     pass
... 
>>> StillAbstract()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: Can't instantiate abstract class StillAbstract with abstract methods foo
>>> class Concrete(Abstract):
...     def foo(self):
...         print('Hello, World')
... 
>>> Concrete()
<__main__.Concrete object at 0x7fc935d28898> 
```

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2014-08-14T04:33:19.530

执行此操作的老式（[PEP 3119](http://www.python.org/dev/peps/pep-3119/)之前）方法只是`raise NotImplementedError`在调用抽象方法时在抽象类中进行。

```
class Abstract(object):
    def foo(self):
        raise NotImplementedError('subclasses must override foo()!')

class Derived(Abstract):
    def foo(self):
        print 'Hooray!'

>>> d = Derived()
>>> d.foo()
Hooray!
>>> a = Abstract()
>>> a.foo()
Traceback (most recent call last): [...] 
```

`abc`这与使用模块没有相同的好属性。您仍然可以实例化抽象基类本身，并且在运行时调用抽象方法之前不会发现错误。

但是，如果您正在处理一小组简单的类，可能只有几个抽象方法，那么这种方法比尝试浏览`abc`文档要容易一些。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2018-01-16T05:30:33.340

这是一个非常简单的方法，无需处理 ABC 模块。

在`__init__`你想成为抽象类的类的方法中，你可以检查self的“类型”。如果 self 的类型是基类，则调用者正在尝试实例化基类，因此引发异常。这是一个简单的例子：

```
class Base():
    def __init__(self):
        if type(self) is Base:
            raise Exception('Base is an abstract class and cannot be instantiated directly')
        # Any initialization code
        print('In the __init__  method of the Base class')

class Sub(Base):
    def __init__(self):
        print('In the __init__ method of the Sub class before calling __init__ of the Base class')
        super().__init__()
        print('In the __init__ method of the Sub class after calling __init__ of the Base class')

subObj = Sub()
baseObj = Base() 
```

运行时，它会产生：

```
In the __init__ method of the Sub class before calling __init__ of the Base class
In the __init__  method of the Base class
In the __init__ method of the Sub class after calling __init__ of the Base class
Traceback (most recent call last):
  File "/Users/irvkalb/Desktop/Demo files/Abstract.py", line 16, in <module>
    baseObj = Base()
  File "/Users/irvkalb/Desktop/Demo files/Abstract.py", line 4, in __init__
    raise Exception('Base is an abstract class and cannot be instantiated directly')
Exception: Base is an abstract class and cannot be instantiated directly 
```

这说明可以实例化继承自基类的子类，但不能直接实例化基类。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2018-09-10T05:01:32.950

大多数以前的答案都是正确的，但这里是*Python 3.7 的答案和示例。*是的，您可以创建一个抽象类和方法。提醒一下，有时一个类应该定义一个逻辑上属于一个类的方法，但该类不能指定如何实现该方法。例如，在下面的“父母”和“婴儿”课程中，他们都吃，但每个人的实施方式会有所不同，因为婴儿和父母吃的食物种类不同，他们吃的次数也不同。因此，eat 方法子类覆盖 AbstractClass.eat。

```
from abc import ABC, abstractmethod

class AbstractClass(ABC):

    def __init__(self, value):
        self.value = value
        super().__init__()

    @abstractmethod
    def eat(self):
        pass

class Parents(AbstractClass):
    def eat(self):
        return "eat solid food "+ str(self.value) + " times each day"

class Babies(AbstractClass):
    def eat(self):
        return "Milk only "+ str(self.value) + " times or more each day"

food = 3    
mom = Parents(food)
print("moms ----------")
print(mom.eat())

infant = Babies(food)
print("infants ----------")
print(infant.eat()) 
```

输出：

```
moms ----------
eat solid food 3 times each day
infants ----------
Milk only 3 times or more each day 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2019-07-28T15:09:46.030

正如其他答案中所解释的，是的，您可以使用[`abc`模块](https://docs.python.org/3.6/library/abc.html)在 Python 中使用抽象类。[`@classmethod`](https://docs.python.org/3.6/library/abc.html#abc.abstractclassmethod)下面我给出了一个使用 abstract和[`@property`](https://docs.python.org/3.6/library/abc.html#abc.abstractproperty)（[`@abstractmethod`](https://docs.python.org/3.6/library/abc.html#abc.abstractmethod)使用 Python 3.6+）的实际示例。对我来说，从我可以轻松复制和粘贴的示例开始通常更容易；我希望这个答案对其他人也有用。

让我们首先创建一个名为的基类`Base`：

```
from abc import ABC, abstractmethod

class Base(ABC):

    @classmethod
    @abstractmethod
    def from_dict(cls, d):
        pass

    @property
    @abstractmethod
    def prop1(self):
        pass

    @property
    @abstractmethod
    def prop2(self):
        pass

    @prop2.setter
    @abstractmethod
    def prop2(self, val):
        pass

    @abstractmethod
    def do_stuff(self):
        pass 
```

我们的`Base`类将始终具有 a `from_dict` `classmethod`、 a `property` `prop1`（只读）和 a `property` `prop2`（也可以设置）以及一个名为 的函数`do_stuff`。现在基于任何类构建`Base`都必须实现所有这四个方法/属性。请注意，对于抽象的方法，需要两个装饰器 -`classmethod`和 abstract `property`。

现在我们可以创建一个这样的类`A`：

```
class A(Base):
    def __init__(self, name, val1, val2):
        self.name = name
        self.__val1 = val1
        self._val2 = val2

    @classmethod
    def from_dict(cls, d):
        name = d['name']
        val1 = d['val1']
        val2 = d['val2']

        return cls(name, val1, val2)

    @property
    def prop1(self):
        return self.__val1

    @property
    def prop2(self):
        return self._val2

    @prop2.setter
    def prop2(self, value):
        self._val2 = value

    def do_stuff(self):
        print('juhu!')

    def i_am_not_abstract(self):
        print('I can be customized') 
```

所有必需的方法/属性都已实现，我们当然可以添加不属于的附加功能`Base`（此处：）`i_am_not_abstract`。

现在我们可以这样做：

```
a1 = A('dummy', 10, 'stuff')
a2 = A.from_dict({'name': 'from_d', 'val1': 20, 'val2': 'stuff'})

a1.prop1
# prints 10

a1.prop2
# prints 'stuff' 
```

根据需要，我们不能设置`prop1`：

```
a.prop1 = 100 
```

将返回

> AttributeError：无法设置属性

我们的`from_dict`方法也可以正常工作：

```
a2.prop1
# prints 20 
```

如果我们现在`B`像这样定义第二个类：

```
class B(Base):
    def __init__(self, name):
        self.name = name

    @property
    def prop1(self):
        return self.name 
```

并尝试像这样实例化一个对象：

```
b = B('iwillfail') 
```

我们会得到一个错误

> TypeError：无法使用抽象方法 do_stuff、from_dict、prop2 实例化抽象类 B

列出所有`Base`我们没有在`B`.

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2015-12-11T15:47:27.623

这个将在 python 3 中工作

```
from abc import ABCMeta, abstractmethod

class Abstract(metaclass=ABCMeta):

    @abstractmethod
    def foo(self):
        pass

Abstract()
>>> TypeError: Can not instantiate abstract class Abstract with abstract methods foo 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-01-12T14:00:15.653

这也有效并且很简单：

```
class A_abstract(object):

    def __init__(self):
        # quite simple, old-school way.
        if self.__class__.__name__ == "A_abstract": 
            raise NotImplementedError("You can't instantiate this abstract class. Derive it, please.")

class B(A_abstract):

        pass

b = B()

# here an exception is raised:
a = A_abstract() 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-11-25T11:22:42.560

```
 from abc import ABCMeta, abstractmethod

 #Abstract class and abstract method declaration
 class Jungle(metaclass=ABCMeta):
     #constructor with default values
     def __init__(self, name="Unknown"):
     self.visitorName = name

     def welcomeMessage(self):
         print("Hello %s , Welcome to the Jungle" % self.visitorName)

     # abstract method is compulsory to defined in child-class
     @abstractmethod
     def scarySound(self):
         pass 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-09-27T22:07:02.417

我发现接受的答案，以及所有其他的奇怪，因为它们传递`self`给一个抽象类。抽象类未实例化，因此不能有`self`.

所以试试这个，它有效。

```
from abc import ABCMeta, abstractmethod

class Abstract(metaclass=ABCMeta):
    @staticmethod
    @abstractmethod
    def foo():
        """An abstract method. No need to write pass"""

class Derived(Abstract):
    def foo(self):
        print('Hooray!')

FOO = Derived()
FOO.foo() 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-05-10T00:45:28.733

您还可以利用 __new__ 方法来发挥自己的优势。你只是忘记了什么。__new__ 方法总是返回新对象，因此您必须返回其超类的新方法。执行以下操作。

```
class F:
    def __new__(cls):
        if cls is F:
            raise TypeError("Cannot create an instance of abstract class '{}'".format(cls.__name__))
        return super().__new__(cls) 
```

使用新方法时，您必须返回对象，而不是 None 关键字。这就是你错过的一切。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-04-29T00:19:09.480

在这里回答迟了，但为了回答这里指出的另一个问题“如何制作抽象*方法*”，我提供以下内容。

```
# decorators.py
def abstract(f):
    def _decorator(*_):
        raise NotImplementedError(f"Method '{f.__name__}' is abstract")
    return _decorator

# yourclass.py
class Vehicle:
    def add_energy():
       print("Energy added!")

    @abstract
    def get_make(): ...

    @abstract
    def get_model(): ... 
```

类基 Vehicle 类仍然可以实例化以进行单元测试（与 ABC 不同），并且存在 Pythonic 引发的异常。哦，是的，为方便起见，您还可以使用此方法获得异常中抽象的方法名称。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2012-11-30T14:58:17.040

在您的代码片段中，您还可以通过为子类中的方法提供实现来解决此问题`__new__`，同样：

```
def G(F):
    def __new__(cls):
        # do something here 
```

但这是一个 hack，我建议你不要这样做，除非你知道你在做什么。对于几乎所有情况，我建议您使用`abc`我之前的其他人建议的模块。

此外，当您创建一个新的（基）类时，将其设为 subclass `object`，如下所示：`class MyBaseClass(object):`. 我不知道它是否有那么重要了，但它有助于保持代码风格的一致性

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2017-08-07T23:10:04.693

只是对@TimGilbert 的老派答案的快速补充......你可以让你的抽象基类的**init** () 方法抛出一个异常，这会阻止它被实例化，不是吗？

```
>>> class Abstract(object):
...     def __init__(self):
...         raise NotImplementedError("You can't instantiate this class!")
...
>>> a = Abstract()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 3, in __init__
NotImplementedError: You can't instantiate this class! 
```

# spring - 从 Spring 3.0.5 更新到 Spring 3.1.2 不包括 aspectjrt 作为依赖项

> ID：13646246
> 
> 赞同：1
> 
> 时间：2012-11-30T13:29:28.567
> 
> 标签：spring, spring-security, aspectj

我正在从 Spring 3.0.5 更新到 Spring 3.1.2，并且在更新 Spring 安全核心的同时也更新到 3.1.2，这反过来又依赖于 aspectjrt（在其 pom 中提到）但是在更新到 3.1.2 之后，如果我生成依赖项树使用

```
dependency:tree 
```

它没有在树中列出 aspectjrt，但如果我使用 3.0.5 版生成相同的树，aspectjrt 会在依赖树中列出。

此外，如前所述，我已经验证了两个 pom（版本 3.0.5 和 3.1.2）中都存在 aspectjrt 依赖项。

由于 aspectjrt 未列为依赖项，因此我的代码未编译，因为它需要来自 aspectjrt 的类。

如果我在我的 pom 中明确包含 aspectjrt 依赖项，我的代码将成功编译。

有谁知道为什么更新到 3.1.2 后会出现这个问题？为什么在更新到 3.1.2 后没有将 aspectjrt 作为依赖项包含在内

是否有任何解决方法，否则我将不得不通过在我的 pom.xml 中包含 aspectjrt 作为显式依赖项来工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:21:11.997

AspectJ在 spring POM 中被声明为[可选依赖项。](http://maven.apache.org/guides/introduction/introduction-to-optional-and-excludes-dependencies.html)这意味着构建 Spring JAR 需要 AspectJ，但当您将 Spring 作为依赖项包含时，构建项目不需要 AspectJ。如果您需要 AspectJ 功能，请将其包含在您的 POM 中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-03T10:01:18.827

我已经解决了这个问题。这是预期的行为，因为 spring security core 3.0.5 aspectjrt 不是可选的，但在 spring securoty core 3.1.2 中，它们已将 aspectjrt 标记为可选。

因此，如果您在代码中使用了一些 aspectjrt，则必须在 pom.xml 中包含 aspectjrt 依赖项。

希望有帮助。

# php - 理解正则表达式

> ID：13646248
> 
> 赞同：18
> 
> 时间：2012-11-30T13:29:31.867
> 
> 标签：php, regex

我厌倦了害怕正则表达式。这篇文章的主题仅限于正则表达式的 PHP 实现，但是，任何通用正则表达式建议显然都会受到赞赏（即不要将我与不适用于 PHP 的范围混淆）。

以下（我相信）将删除数字之间的任何空格。也许有更好的方法可以做到这一点，但我仍然想了解发生了什么。

```
$pat="/\b(\d+)\s+(?=\d+\b)/";
$sub="123 345";
$string=preg_replace($pat, "$1", $sub); 
```

通过模式，我的解释是：

*   `\b`一个词的边界
*   `\d+`1 个或多个数字的子模式
*   `\s+`一个或多个空格
*   `(?=\d+\b)`一个或多个数字后跟单词边界的前瞻断言？
*   把它们放在一起，搜索任何单词边界，后跟一个或多个数字，然后是一些空格，然后对其进行某种前瞻断言，并将结果保存在 $1 中以便它可以替换模式？

问题：

*   我的上述解释正确吗？
*   那个前瞻断言到底是关于什么的？
*   前导`/`和尾随的目的是什么`/`？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-30T13:35:43.457

> **我的上述解释正确吗？**

是的，你的解释是正确的。

> **那个前瞻断言到底是关于什么的？**

该前瞻断言是一种让您匹配前面具有特定模式的字符的方法，而无需实际匹配该模式。

所以基本上，使用正则表达式`abcd(?=e)`来匹配字符串`abcde`会给你匹配：`abcd`。

匹配的原因是该字符串`abcde`实际上包含：

1.  一个`a`
2.  紧随其后的是`b`
3.  紧随其后的是`c`
4.  后跟一个`d that has an e after it`（这是单个字符！）

需要注意的是，在第 4 项之后，它还包含一个实际的“e”字符，我们不匹配。

另一方面，尝试将字符串与正则表达式匹配`abcd(?=f)`将失败，因为序列：

```
"a", followed by "b", followed by "c", followed by "d that has an f in front of it" 
```

没有找到。

> **前导/和尾随/的目的是什么**

这些是分隔符，在 PHP 中用于区分字符串的模式部分和字符串的修饰符部分。分隔符可以是任何字符，尽管我`@`自己更喜欢符号。请记住，如果在您的模式中使用您用作分隔符的字符，则需要对其进行转义。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-30T13:39:51.587

观看此视频以及随后的 4 个视频是个好主意：http: [//blog.themeforest.net/screencasts/regular-expressions-for-dummies/](http://blog.themeforest.net/screencasts/regular-expressions-for-dummies/) 该系列的其余部分可在此处找到： [http:// /blog.themeforest.net/?s=regex+for+dummies](http://blog.themeforest.net/?s=regex+for+dummies)

一位同事给我发了这个系列，看完之后，我对使用正则表达式感到更加自在。

另一个好主意是安装 RegexBuddy 或 Regexr。尤其是 RegexBuddy 对于理解正则表达式的工作原理非常有用。

# objective-c - 使用适用于 iOS 的 PayPal Express Checkout 库直接付款

> ID：13646249
> 
> 赞同：1
> 
> 时间：2012-11-30T13:29:32.847
> 
> 标签：objective-c, ios, xcode, paypal

我一直在使用 paypal express checkout 库从我开发的 iPhone 应用程序中购买一些商品。通过使用 MECL（Mobile Express 结帐库），Paypal 将要求用户输入他/她的帐户凭据。如果用户在 Paypal 中没有帐户怎么办。所以，在这方面，我想介绍使用信用卡/借记卡的“直接支付”，而不是登录方式。

那么，我该如何更新我的 MECL，它也支持直接付款。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:50:07.403

来自 App Store 指南：

11.2 应用程序使用除应用内购买 API (IAP) 以外的系统购买应用程序中的内容、功能或服务的应用程序将被拒绝

11.3 使用 IAP 购买实体商品或在应用程序外使用的商品和服务的应用程序将被拒绝

你的应用程序是用于越狱手机的吗？如果不是，您将无法通过审核获得您的应用程序。

# database - 避免两个字段具有相同的值

> ID：13646253
> 
> 赞同：3
> 
> 时间：2012-11-30T13:29:54.770
> 
> 标签：database, ms-access, ms-access-2007, vba, ms-office

我正在使用 Access 2010。

我有一个名为`Person`:的表`Id(key), field1(int), field2(int)`。

我想避免那`field1`将等于`field2`.

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T15:03:39.920

在设计视图中使用您的表格，打开其属性表并将表格验证规则设置为`[field1]<>[field2]`像这样......

![在此处输入图像描述](../Images/663c87f7771ebdc92de96871ab887067.png)

请注意，如果省略字段名称周围的方括号，Access 可能会将它们转换为文本值 ... `"field1"<>"field2"`。你不想要那个。

顺便说一句，我通常将 Subdatasheet Name 属性更改为`[None]`，但这不是与验证规则相关的问题。

# iphone - 内存增加而没有释放内存

> ID：13646261
> 
> 赞同：1
> 
> 时间：2012-11-30T13:30:33.387
> 
> 标签：iphone, objective-c, ios, ipad, memory-leaks

我搜索如何找到我的问题。在我的 iPad 应用程序中，当我处理数据时，我增加了内存并且从不释放内存，我尝试仪器泄漏内存但没有发现内存泄漏（我尝试使用配置文件和分析）。

所以我的问题是他们有其他工具来查找内存泄漏或其他方法吗？

提前感谢您的考虑。

PS：我没有发布代码，因为这涉及我的代码的很大一部分，但内存增加的部分是我从 FTP 下载一些 zip 文件的部分（基于 Apple Doc 中的 SimpleFTPSample）我解压缩这些文件（使用框架minizip）这个 zip 文件包含一些图像和 XML 文件我解析这个 XML 文件（大约 7200 个 XML 文件和 35 000 个图像文件保存）我在数据库中保存了一些信息（解析问题）和它。如果你需要我的部分代码来帮助我问我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:16:08.640

确保您是否在 Scheme:Diagnostics 中关闭了 Zombies。使用 Zombies 时，不会删除任何记忆。内存泄漏测试应始终在 Zombies 关闭的情况下进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:24:16.293

这通常发生在您将对象保存在数据结构（例如 NSDictionary、NSArray 等）中时，即使您不再需要它们。检查 Instruments 的 Allocations 哪些对象是累积的，并签入您保存这些对象实例的代码。

另一个原因可能是长时间运行的线程。如果您提到的加载和解析是在一个需要很长时间的单个线程中完成的，那么您可能需要在某个循环中执行[@autoreleasepool](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html)以强制定期清理临时对象。

也可能完全没有问题。你说你加载了很多图像。默认情况下，图像由 iOS 缓存，并且仅在需要清理内存时才释放。如果 Instruments “Trace Highlights” 显示大量内存使用，但 “Allocations” 没有，那么这可能是原因。

# asp.net - 在数据库中存储的图像在 asp.net 中受到干扰

> ID：13646262
> 
> 赞同：3
> 
> 时间：2012-11-30T13:30:41.107
> 
> 标签：asp.net, database, image

我正在做一个需要将 32x32 大小的图标（png）存储在表中的项目。我将图像存储在表格中，但是当我将其显示在页面上时，感觉有些失真。这些是 png 图像，因此在某个地方它可能是透明的。但是当我在 asp.Net 页面列表中显示该图像时，透明空间被黑色填充。

是否有任何方法/方法可以将 png 图像存储在表格中而不会扭曲其质量。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:50:04.123

当您将 Image 保存到具有错误 ImageFormat 的字节数组时会发生这种情况。使用此代码：

```
 public byte[] imageToByteArray(string imagePath)
    {
        return imageToByteArray(System.Drawing.Image.FromFile(imagePath));
    }

    public byte[] imageToByteArray(System.Drawing.Image imageIn)
    {
        byte[] result = null;
        using (MemoryStream ms = new MemoryStream())
        {
            imageIn.Save(ms, System.Drawing.Imaging.ImageFormat.Png);
            result = ms.ToArray();
        }
        return result;
    } 
```

# android - 在android中播放音频

> ID：13646265
> 
> 赞同：1
> 
> 时间：2012-11-30T13:30:55.097
> 
> 标签：android, android-intent, android-audiomanager

在我的应用程序中，我使用以下代码播放音频文件

```
Uri data = Uri.parse("file:/" + songnameandpath);
                intent.setDataAndType(data, "audio/*");

                            PackageManager packageManager = getActivity()
                                    .getPackageManager();
                            List<ResolveInfo> activities = packageManager
                                    .queryIntentActivities(intent, 0);
                            boolean isIntentSafe = activities.size() > 0;

                            if (isIntentSafe) {
                                startActivity(intent); 
```

所以现在当用户点击后退按钮音频停止时，如果我想播放音频，即使用户按下活动上的后退按钮，而且它必须在后台播放音频在手机中的确切方式。

示例代码对我有很大帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:02:25.483

您是否尝试过使用媒体播放器？

这是对我有用的代码，只需删除 on pause/destroy 方法或重新定义它们，即使用户按下回，您也会播放声音..

```
public class MainActivity extends Activity {

    private MediaPlayer mp;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);
        mp= MediaPlayer.create (this, R.raw.sound); // sound is for example your mp3 song
        mp.start ();      
    }

    protected void onDestroy() {
        super.onDestroy();
        mp.release();
    }

    protected void onPause() {
        super.onPause();
        mp.pause();
    }

    protected void onResume() {
        super.onResume();
        mp.start();
    }

    protected void onStart() {
        super.onStart();
    }

} 
```

**更新**

即使活动完成，MediaPlayer 仍将继续播放文件，除非您通过停止功能明确停止 **它**

# python - Python 2.7 和 OpenCV 使用 64 位和 32 位的结果不同，可能的错误？

> ID：13646267
> 
> 赞同：1
> 
> 时间：2012-11-30T13:31:04.070
> 
> 标签：python, debugging, opencv, geometry

我正在使用两个 Windows 操作系统测试以下代码，一个是 64 位，一个是 32 位。[两台机器都安装了 Python 2.7 和来自Unofficial Windows Binaries for Python Extension Packages](http://www.lfd.uci.edu/~gohlke/pythonlibs/)的 openCV

```
opencv-python-2.4.3.win32-py2.7.‌exe = 32 bit 
opencv-python-2.4.3.win-amd64-py2.7.‌exe = 64 bit 
```

在**64 位**中，拟合椭圆的结果是

```
(center, size, angle)
((560030.1875, 6362089.0), (21.186540603637695, 56.54529571533203), 176.27346801757812) 
```

在**32 位**中，拟合椭圆的结果是

```
(center, size, angle)
((560030.625, 6362066.5), (10.480490684509277, 17.20206642150879), 144.34889221191406) 
```

我用于测试的代码如下：

```
import numpy as np
import cv

points = [(560036.4495758876, 6362071.890493258),
 (560036.4495758876, 6362070.890493258),
 (560036.9495758876, 6362070.890493258),
 (560036.9495758876, 6362070.390493258),
 (560037.4495758876, 6362070.390493258),
 (560037.4495758876, 6362064.890493258),
 (560036.4495758876, 6362064.890493258),
 (560036.4495758876, 6362063.390493258),
 (560035.4495758876, 6362063.390493258),
 (560035.4495758876, 6362062.390493258),
 (560034.9495758876, 6362062.390493258),
 (560034.9495758876, 6362061.390493258),
 (560032.9495758876, 6362061.390493258),
 (560032.9495758876, 6362061.890493258),
 (560030.4495758876, 6362061.890493258),
 (560030.4495758876, 6362061.390493258),
 (560029.9495758876, 6362061.390493258),
 (560029.9495758876, 6362060.390493258),
 (560029.4495758876, 6362060.390493258),
 (560029.4495758876, 6362059.890493258),
 (560028.9495758876, 6362059.890493258),
 (560028.9495758876, 6362059.390493258),
 (560028.4495758876, 6362059.390493258),
 (560028.4495758876, 6362058.890493258),
 (560027.4495758876, 6362058.890493258),
 (560027.4495758876, 6362058.390493258),
 (560026.9495758876, 6362058.390493258),
 (560026.9495758876, 6362057.890493258),
 (560025.4495758876, 6362057.890493258),
 (560025.4495758876, 6362057.390493258),
 (560023.4495758876, 6362057.390493258),
 (560023.4495758876, 6362060.390493258),
 (560023.9495758876, 6362060.390493258),
 (560023.9495758876, 6362061.890493258),
 (560024.4495758876, 6362061.890493258),
 (560024.4495758876, 6362063.390493258),
 (560024.9495758876, 6362063.390493258),
 (560024.9495758876, 6362064.390493258),
 (560025.4495758876, 6362064.390493258),
 (560025.4495758876, 6362065.390493258),
 (560025.9495758876, 6362065.390493258),
 (560025.9495758876, 6362065.890493258),
 (560026.4495758876, 6362065.890493258),
 (560026.4495758876, 6362066.890493258),
 (560026.9495758876, 6362066.890493258),
 (560026.9495758876, 6362068.390493258),
 (560027.4495758876, 6362068.390493258),
 (560027.4495758876, 6362068.890493258),
 (560027.9495758876, 6362068.890493258),
 (560027.9495758876, 6362069.390493258),
 (560028.4495758876, 6362069.390493258),
 (560028.4495758876, 6362069.890493258),
 (560033.4495758876, 6362069.890493258),
 (560033.4495758876, 6362070.390493258),
 (560033.9495758876, 6362070.390493258),
 (560033.9495758876, 6362070.890493258),
 (560034.4495758876, 6362070.890493258),
 (560034.4495758876, 6362071.390493258),
 (560034.9495758876, 6362071.390493258),
 (560034.9495758876, 6362071.890493258),
 (560036.4495758876, 6362071.890493258)]

x = np.array(points)[:,0]
y = np.array(points)[:,1]

PointArray2D32f = cv.CreateMat(1, len(points), cv.CV_32FC2)
for (i, (x, y)) in enumerate(points):
    PointArray2D32f[0, i] = (x, y)
    # Fits ellipse to current contour.
    (center, size, angle) = cv.FitEllipse2(PointArray2D32f)

print (center, size, angle) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:33:12.463

拟合椭圆通常是通过随机过程完成的，因为有很多自由度。您可能会看到不同的结果，因为该算法根本不是确定性的。

OpenCV 用来拟合椭圆的算法是[随机霍夫变换](http://en.wikipedia.org/wiki/Randomized_Hough_transform)。

# java - 使用 Application Api Key 将注释发布到 facebook 页面

> ID：13646271
> 
> 赞同：0
> 
> 时间：2012-11-30T13:31:34.853
> 
> 标签：java, facebook, facebook-graph-api

我通过这个请求获得了一个应用程序 api 密钥：

```
GET https://graph.facebook.com/oauth/access_token?client_id=YOUR_APP_ID
&client_secret=YOUR_APP_SECRET&grant_type=client_credentials 
```

我想在用户页面上创建注释，但失败了。我正在发送带有主题和消息的发布请求到：

```
https://graph.facebook.com/[PAGE_ID]/notes/access_token=[APP_TOKEN] 
```

但我得到的是：

```
{
   "error": {
      "message": "(#281) Requires extended permission: create_note",
      "type": "OAuthException",
      "code": 281
   }
} 
```

使用具有所有权限的用户 api 密钥，我只是向 /accounts/ 发送请求，然后获取页面密钥，我就能够创建笔记。但我对应用程序密钥感到困惑。也许我只需要额外的权限，但我不知道该怎么做。

这是应用程序在用户应用中心中的外观： ![在此处输入图像描述](../Images/da42519c2364bbae3eb877712969f360.png)

有任何想法吗？

PS：我使用APP密钥的原因是它不会过期。简单的用户密钥在大约 2 小时后过期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T16:48:48.610

您不能请求*应用*访问令牌的权限。

您想要做的事情*需要*一个*页面*访问令牌。

> PS：我使用APP密钥的原因是它不会过期。简单的用户密钥在大约 2 小时后过期。

*正如之前在关于多次*弃用offline_access的各种讨论中所说的那样：

*默认情况下，使用长期*用户访问令牌获取的页面访问令牌**不会**过期。

# f# - 在声明函数之前使用函数

> ID：13646272
> 
> 赞同：2
> 
> 时间：2012-11-30T13:31:38.957
> 
> 标签：f#

为了在 F# 中使用文学编程（即 cweb），我需要能够转发声明函数（即在定义它们之前使用它们）。我想出了两种方法，它们都令人不快。你能想出更好的东西（程序员更容易使用）吗？

## 不错，但不适用于多态函数

```
// This can be ugly
let declare<'a>  = ref Unchecked.defaultof<'a>

// This has to be beautiful
let add = declare<float -> float>

let ``function I want to explain that depends on add`` nums = nums |> Seq.map !add

add := fun x -> x + 1. 
```

## 丑陋，但适用于一切

```
// This can be ugly
type Literate() =
static member Declare<'a, 'b>  (ref : obj ref) (x : 'a) : 'b =
                                    unbox <| (unbox<obj -> obj> !ref)
static member Define<'a, 'b> (func : 'a -> 'b) (ref : obj ref) (f : 'a -> 'b) =
                                    ref := box (unbox<'a> >> f >> box)

// This has to be beautiful
let rec id (x : 'a) : 'a = Literate.Declare idImpl x
and idImpl = ref null

let f () = id 100 + id 200

Literate.Define id idImpl (fun x -> x) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T19:06:25.210

在创建[www.tryjoinads.org](http://www.tryjoinads.org)时，我使用了一个与识字编程相同想法的工具。文档只是一个带有代码片段的 Markdown，这些代码片段可以转换为您可以运行的 F# 源代码，并且片段必须按正确的顺序排列。（在一些有文化的编程工具中，文档是写在注释中的，但是思路是一样的。）

现在，我认为让你的代码*更复杂*以便你可以用文学编程风格编写它（并记录它）会引入很多意外的复杂性，它违背了文学编程的主要目的。

所以，如果我想解决这个问题，我会用一些注释来扩展我的文学编程工具，这些注释指定使脚本工作所需的代码块的顺序（并且一个简单的预处理工具可以在生成时重新排序它们F# 输入）。您可以查看 TryJoinads 的 [查看我的构建脚本][1]，它可以很容易地扩展来执行此操作。

我用于 TryJoinads 的工具已经提供了一些元标记，可用于隐藏输出中的代码块，因此您可以编写如下内容：

```
## This is my page heading

    [hide]
    // This function will be hidden from the generated HTML
    // but it is visible to the F# compiler
    let add a b = a + b 

Here is the description for the other function:

   let functionThatUsesAdd x = add x x

And later on I can repeat `add` with more comments (and I can add an annotation
`module` to avoid conflicts with the previous declaration):

   [module=Demo]
   let add a b =
     // Add a and b
     a + b 
```

这也不是完美的，因为您必须复制功能，但至少您生成的博客文章或 HTML 文档不会被无关紧要的事物所掩盖。但是，当然，添加一些元命令`module`或`hide`指定块的顺序不会太难，这将是一个干净的解决方案。

总之，我认为你只需要一个更好的识字编程工具，而不是不同的 F# 代码或 F# 语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T06:51:30.970

也许我错过了一些东西，但你为什么不一直走下去并“正确地做”？

> 先使用函数：
> 
> ```
> <<test.fs>>=
> <<add>>
> let inc = add 1 
> ```
> 
> 之后声明函数：
> 
> ```
> <<add>>=
> let add a b = a + b 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T15:30:35.193

由于函数是 F# 中的第一类对象，因此您可以将它们传递给周围——这提供了比前向引用更好（并且仍然不可变）的解决方案。

```
let dependentFunction f nums = nums |> Seq.map f

let ``function I want to explain that depends on add`` nums =
    dependentFunction (fun x -> x + 1.) nums 
```

此外，在大多数情况下，您应该能够使用 currying（部分函数应用程序）来进一步简化代码，但类型推断`seq<'T>`在 F# 中有点奇怪，因为它通常用作灵活类型（类似于 C# 4.0 中的协变）。为了显示：

```
// This doesn't work because of type inference on seq<'T>,
// but it should work with most other types.
let ``function I want to explain that depends on add`` =
    dependentFunction (fun x -> x + 1.) 
```

`ref`最后，在 F# 中使用or的一个好的经验法则`mutable`是，如果您只分配一次值（初始化它），那么可能有一种更简洁、更实用的方式来编写代码（将值作为函数传递参数（如上），`lazy`是两种这样的方法）。显然，这条规则也有例外，但即便如此，也应该非常谨慎地使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T15:34:51.633

正如我所说，这是错误的（你应该发表一篇博客文章或一篇 FPish 文章，说明你为什么这样做），但这是我的看法：

```
let ``function I want to explain that depends on add``
      (add : float -> float) = nums |> Seq.map add

let add = (+) 1.

let ``function I want to explain that depends on add`` = ``function I want to explain that depends on add`` add 
```

# r - 在ggplot中的常用值周围添加矩形

> ID：13646273
> 
> 赞同：7
> 
> 时间：2012-11-30T13:31:41.030
> 
> 标签：r, ggplot2

当我进行实验设计时，我使用 ggplot 来显示布局。这是一个简单的例子：

```
df <- data.frame(Block=rep(1:2, each=18),
            Row=rep(1:9, 4),
            Col=rep(1:4, each=9),
            Treat=sample(c(1:6),replace=F)) 
```

我会像这样绘制：

```
df.p <- ggplot(df, aes(Row, Col)) + geom_tile(aes(fill=as.factor(Treat))) 
```

给：

![设计](../Images/548c704f1389d712fc90401279f9dc4c.png)

有时我在设计中有一个结构，我想通过在其周围放置一个框来突出显示它，例如主图。在这种情况下：

```
df$Mainplot <- ceiling(df$Row/3) + 3*(ceiling(df$Col/2) - 1) 
```

然后，我使用 geom_rect 和一些需要针对每个设计进行调整的杂乱代码来生成如下内容：

![主情节设计](../Images/e996e7039e09c087599e3e8c6c74fe7b.png)

问题：如何以简单的方式在主图周围添加矩形？这似乎是一个足够简单的问题，但我还没有找到明显的方法。我可以将颜色或其他美学映射到主图，但我似乎无法用盒子包围它们。任何指针都非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T01:35:37.700

这是一个可能的解决方案，我创建了一个辅助 data.frame 用于绘制边界`geom_rect()`。我不确定这是否像您想要的那样简单！我希望计算矩形坐标的代码只需付出一点额外的努力就可以重用/推广。

```
library(ggplot2)

# Load example data.
df = data.frame(Block=rep(1:2, each=18),
            Row=rep(1:9, 4),
            Col=rep(1:4, each=9),
            Treat=sample(c(1:6),replace=F))
df$Mainplot = ceiling(df$Row/3) + 3*(ceiling(df$Col/2) - 1)

# Create an auxiliary data.frame for plotting borders.
group_dat = data.frame(Mainplot=sort(unique(df$Mainplot)),
                       xmin=0, xmax=0, ymin=0, ymax=0)
# Fill data.frame with appropriate values.
for(i in 1:nrow(group_dat)) {
    item = group_dat$Mainplot[i]
    tmp = df[df$Mainplot == item, ]
    group_dat[i, "xmin"] = min(tmp$Row) - 0.5
    group_dat[i, "xmax"] = max(tmp$Row) + 0.5
    group_dat[i, "ymin"] = min(tmp$Col) - 0.5
    group_dat[i, "ymax"] = max(tmp$Col) + 0.5
}

p2 = ggplot() + 
     geom_tile(data=df, aes(x=Row, y=Col, fill=factor(Treat)), 
               colour="grey30", size=0.35) +
     geom_rect(data=group_dat, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax),
               size=1.4, colour="grey30", fill=NA)

ggsave(filename="plot_2.png", plot=p2, height=3, width=6.5) 
```

![在此处输入图像描述](../Images/75f42423528ea656e6d39bf4bc4e6875.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T23:32:21.307

这是一个可能更容易的解决方案。只需`geom_tile`在 alpha 设置为 0 的情况下使用。我没有花时间给你一个确切的解决方案，但这里有一个例子。为了实现你想要的，我猜你需要实际创建一个新的数据框，这应该很容易。

```
df <- data.frame(Block=rep(1:2, each=18),Row=rep(1:9, 4),Col=rep(1:4, each=9),Treat=sample(c(1:6),replace=F))
df$blocking <- rep(sort(rep(1:3,3)),4)
df.p <- ggplot(df, aes(Row, Col)) + geom_tile(aes(fill=as.factor(Treat)))
df.p+ geom_tile(data=df,aes(x=Row,y=blocking),colour="black",fill="white",alpha=0,lwd=1.4) 
```

将`alpha=0`创建一个空白图块，然后您可以使用`lwd`. 这可能比指定所有矩形更容易。希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T03:23:51.930

我认为发布我自己的（非理想）解决方案是值得的，因为我似乎没有什么明显的遗漏。我将留下未回答的问题，希望有人能提出一些建议。

目前，我以一种可能可以通用的方式使用 geom_rect （可能是在 ggplot 中添加 geom_border ？？）。对于我的问题中的示例，基本信息是每个主图都是 3 x 2。

从原始问题添加`df.p`，这就是我目前所做的：

```
df.p1 <- df.p + geom_rect(aes(xmin=((Mainplot- 3*(ceiling(Col/2)-1) )-1)*3 + 0.5,
                         xmax=((Mainplot - 3*(ceiling(Col/2)-1))-1)*3 + 3.5,
                         ymin=ceiling(ceiling(Col/2)/2 + 2*(ceiling(Col/2)-1))-0.5,
                         ymax=2*ceiling(Col/2)+0.5),
                     colour="black", fill="transparent",size=1) 
```

丑陋，我知道 - 所以这个问题。该代码从问题中生成第二个图。也许最好的选择是将这一切都构建到一个函数中。

# jsf-2 - JSF2 我有 2 个<h:panelgroup用于条件文本显示。当我在 id="" 为空的情况下运行时，这个条件执行得很好#{empty="" personbean.person.id}，并且我看到了其中的文本。如果我放入<h2="">#{bu 问问题 问问题 2012-11-30T13:31:53.217 1447 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有 2 个<h:panelgroup用于条件文本显示。当我在 id="" 为空的情况下运行时，这个条件执行得很好#{empty="" personbean.person.id}，并且我看到了其中的文本。如果我放入<h2="">#{buttonText}</h:panelgroup用于条件文本显示。当我在></h:panelgroup用于条件文本显示。当我在>

面板，我会看到 buttonText 正确显示在 h2 标记中。 现在问题： 在下面的代码中，如果我

## #{buttonText}

像下面这样放在最后，我总是会得到值更新成员，因此我不能使用buttonText下面页面中任何地方的值。有人告诉我该怎么办？ <h:panelgroup rendered="#{empty personBean.person.id}"># Add Information

*Use the form below to add your information.*<ui:param name="buttonText" value="Add member"></ui:param></h:panelgroup> <h:panelgroup rendered="#{not empty personBean.person.id}"># Update Information

*Use the form below to edit your information.*<ui:param name="buttonText" value="Update member"></ui:param></h:panelgroup>

## #{buttonText}

我无法<ui:param像使用<c:set var="buttonText" value="Add member">JSTL 设置变量一样使用。 不会在<ui:param>视图渲染期间进行评估（问问自己；它是否一定会生成任何 HTML？），而是在视图构建期间。所以这个rendered属性根本没有被考虑在内，你实际上最终会被解释，而后一个总是会覆盖前一个。 从技术上讲，您需要有条件地使用视图构建时间标签（例如<c:if>. 但是，在您的特定构造中，最好只检查<ui:param>' 值中的相同条件，并且只使用其中一个而不是两个： <ui:param name="buttonText" value="#{empty personBean.person.id ? 'Add' : 'Update'} member">或者直接在需要的地方进行评估

## #{empty personBean.person.id ? 'Add' : 'Update'} member

也可以看看： JSF2 Facelets 中的 JSTL...有意义吗？- 不完全是您的问题，只是为了更好地理解“查看构建时间”与“查看渲染时间”。 jsf-2 4 1 回答 1 This answer is useful 2 不会在<ui:param>视图渲染期间评估（问问自己；它是否一定会生成任何 HTML？），而是在视图构建期间。所以这个rendered属性根本没有被考虑在内，你实际上最终会被解释，而后一个总是会覆盖前一个。 从技术上讲，您需要有条件地使用视图构建时间标签（例如<c:if>. 但是，在您的特定构造中，最好只检查<ui:param>' 值中的相同条件，并且只使用其中一个而不是两个： <ui:param name="buttonText" value="#{empty personBean.person.id ? 'Add' : 'Update'} member">或者直接在需要的地方进行评估

## #{empty personBean.person.id ? 'Add' : 'Update'} member

也可以看看： JSF2 Facelets 中的 JSTL...有意义吗？- 不完全是您的问题，只是为了更好地理解“查看构建时间”与“查看渲染时间”。 于 2012-11-30T13:35:53.843 回答 Related 0 android - android是否会记录启动时间？ 2 tridion - 动态查询已翻译的关键词 1 android - 如何在 jni 函数中访问图像文件夹 2 javascript - 表单重新设计后 Javascript 不再有效 2 android - 无法创建新的 AVD 2 c - 如何修改recv来实现IO/非阻塞？ 1 jqgrid - JQGrid Grouping GroupText 格式化和修改 2 android - 我如何更改我的 AndroidManifest，因为它正在由 maven 打包 1 javascript - 无需单击 jQuery 即可创建摘要 2 oracle - 无法在存储过程中运行大型动态选择查询 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13646278
> 
> 赞同：0
> 
> 时间：
> 
> 标签：jsf-2

我有 2 个`<h:panelGroup`用于条件文本显示。当我在 id 为空的情况下运行时，这个条件执行得很好`#{empty personBean.person.id}`，并且我看到了其中的文本。如果我放入`<h2>#{buttonText}</h2>`面板，我会看到 buttonText 正确显示在 h2 标记中。

**现在问题：**

在下面的代码中，如果我`<h2>#{buttonText}</h2>`像下面这样放在最后，我总是会得到值**更新成员**，因此我不能使用`buttonText`下面页面中任何地方的值。有人告诉我该怎么办？

```
 <h:panelGroup rendered="#{empty personBean.person.id}">
                        <h1>Add Information</h1>
                        <i>Use the form below to add your information.</i>
                        <ui:param name="buttonText" value="Add member" />
                    </h:panelGroup>
                    <h:panelGroup rendered="#{not empty personBean.person.id}">
                        <h1>Update Information</h1>
                        <i>Use the form below to edit your information.</i>
                        <ui:param name="buttonText" value="Update member" />
                    </h:panelGroup>
                    <h2>#{buttonText}</h2> 
```

我无法`<ui:param`像使用`<c:set var="buttonText" value="Add member" />`JSTL 设置变量一样使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:35:53.843

不会在`<ui:param>`视图渲染期间评估（问问自己；它是否一定会生成任何 HTML？），而是在视图构建期间。所以这个`rendered`属性根本没有被考虑在内，你实际上最终会被解释，而后一个总是会覆盖前一个。

从技术上讲，您需要有条件地使用视图构建时间标签（例如`<c:if>`. 但是，在您的特定构造中，最好只检查`<ui:param>`' 值中的相同条件，并且只使用其中一个而不是两个：

```
<ui:param name="buttonText" value="#{empty personBean.person.id ? 'Add' : 'Update'} member" /> 
```

或者直接在需要的地方进行评估

```
<h2>#{empty personBean.person.id ? 'Add' : 'Update'} member</h2> 
```

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)- 不完全是您的问题，只是为了更好地理解“查看构建时间”与“查看渲染时间”。</ui:param></ui:param></c:if></ui:param></ui:param></ui:param></c:if></ui:param></ui:param像使用<c:set>

# javascript - 如何将自定义图像叠加层添加到谷歌街道地图？

> ID：13646279
> 
> 赞同：0
> 
> 时间：2012-11-30T13:31:54.477
> 
> 标签：javascript

有什么办法可以将自定义叠加层添加到谷歌街道地图？

这是我想放置叠加层的示例： [JSFiddle](http://jsfiddle.net/YjGVG/)

这是代码

```
<html><head><style type="text/css">@media print {  .gmnoprint {    display:none  }}@media screen {  .gmnoscreen {    display:none  }}</style>
    <meta charset="utf-8">
    <title>Google Maps JavaScript API v3 Example: Street View Layer</title>

    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=false"></script>

    <script>
var caffe = new google.maps.LatLng(37.869085,-122.254775);

function initialize() {

  var panoramaOptions = {
    position:caffe,
     linksControl: false,       // disables link control
     panControl: false,
     enableCloseButton: false,
    pov: { 
      heading: 270,
      pitch:0,
      zoom:1
    },
    visible:true
  };
  var panorama = new google.maps.StreetViewPanorama(document.getElementById("pano"), panoramaOptions);

  google.maps.event.addListener(panorama, 'pano_changed', function() {
      //var panoCell = document.getElementById('pano_cell');
     // panoCell.firstChild.nodeValue = panorama.getPano();
  });

  google.maps.event.addListener(panorama, 'links_changed', function() {
      /*var linksTable = document.getElementById('links_table');
      while(linksTable.hasChildNodes()) {
        linksTable.removeChild(linksTable.lastChild);
      };
      var links =  panorama.getLinks();
      for (var i in links) {
        var row = document.createElement("tr");
        linksTable.appendChild(row);
        var hCell = document.createElement("td");
        var hText = "Link: " + i + "";
        hCell.innerHTML = hText;
        var vCell = document.createElement("td");
        var vText = links[i].description;
        vCell.innerHTML = vText;
        linksTable.appendChild(hCell);
        linksTable.appendChild(vCell);
      }*/
  });

  google.maps.event.addListener(panorama, 'position_changed', function() {
     // console.log(panorama.getPosition());
  });

  google.maps.event.addListener(panorama, 'pov_changed', function() {
      console.log(panorama.getPov().heading);

  });

}
    </script>
  <script type="text/javascript" charset="UTF-8" src="https://maps.gstatic.com/cat_js/intl/en_us/mapfiles/api-3/11/1/%7Bcommon,map%7D.js"></script><script type="text/javascript" charset="UTF-8" src="https://maps.gstatic.com/cat_js/intl/en_us/mapfiles/api-3/11/1/%7Butil,onion%7D.js"></script><script type="text/javascript" charset="UTF-8" src="https://maps.gstatic.com/cat_js/intl/en_us/mapfiles/api-3/11/1/%7Bcontrols,stats%7D.js"></script><script type="text/javascript" charset="UTF-8" src="https://maps.gstatic.com/cat_js/intl/en_us/mapfiles/api-3/11/1/%7Bmarker%7D.js"></script></head>
  <body onload="initialize()">

    <div id="pano" style="width: 400px; height: 300px; position: relative; background-color: rgb(229, 227, 223); overflow: hidden; -webkit-transform: translateZ(0);"></div>

</body></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T15:16:31.907

您需要将地图位置设置为相对位置，然后您绝对可以在地图上放置一个 div 请在此处查看我的示例

[http://jsfiddle.net/YjGVG/1/](http://jsfiddle.net/YjGVG/1/)

```
#pano{position:relative;}

.overlay{position:absolute;top:0;left:0;width:100%;height:30px;background-color:#000; opacity:0.5;z-index:100;color:red;} 
```

确保您设置的 z-index 大于地图以确保它显示。

# windows - 无法连接到 URL 'svn://localhost' 的存储库

> ID：13646281
> 
> 赞同：2
> 
> 时间：2012-11-30T13:31:56.957
> 
> 标签：windows, svn

我使用管理员帐户在 Windows 7 操作系统上安装了 Subversion 包 1.7 版

我使用以下命令创建了存储库：`svnadmin create "c:\svn_repository"`

我修改了`svnserve.conf`和 passwd 文件：`anon-access = read`、、`auth-access = write`和`password-db = passwd`

我将 Subversion 安装为 Windows 服务，并使用以下命令启动它：

```
sc create svnserver binpath= "C:\Program Files (x86)\Subversion\bin\svnserve.exe --service -r c:\svn_repository" DisplayName= "Subversion" depend= tcpip start= auto 
```

我还将变量设置`SVN_EDITOR`为：`set SVN_EDITOR=c:\windows\system32\notepad.exe`

我遇到的问题是当我调用以下命令时：

```
svn mkdir svn://localhost/myproject 
```

我收到以下错误：

```
svn: E200002: Unable to connect to a repository at URL 'svn://localhost'
svn: E200002: C:\svn_repository\conf\svnserve.conf:19: Option expected 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-30T13:38:24.087

检查 svnserve.conf 中您指定的每个选项的行首的空格（在您的情况下，检查 svnserve.conf 的第 19 行，如果该行之前有空格，请将其删除）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:57:10.187

`-r c:\svn_repository"`并且`svnadmin create c:\svn_repository`不兼容

-r 定义**存储库的公共根**并且不能是存储库本身

# asp.net-mvc-4 - 编辑器 UI 小部件未将输入传递给模型

> ID：13646289
> 
> 赞同：-2
> 
> 时间：2012-11-30T13:32:34.023
> 
> 标签：asp.net-mvc-4, kendo-ui

我是“ASP.NET MVC 的 Kendo UI”的新手，目前正在使用编辑器 UI 小部件从数据库中获取数据并将更改保存到数据库。编辑器正确显示控制器返回的模型数据。

但是，在对编辑器进行更改后，编辑器中的内容不会传递给控制器​​的 HttpPost 方法，因此会显示所需的验证消息。

关于编辑器为什么不将输入传递给底层模型的任何想法？

这是一些代码：

```
**@* Create Customer View *@**

@model KendoTest.Models.Customer
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <div class="editor-label">
            @Html.LabelFor(model => model.CustomerName)
            @Html.EditorFor(model => model.CustomerName)
            @Html.ValidationMessageFor(model => model.CustomerName)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Notes)
            @(Html.Kendo().EditorFor(model => model.Notes).Name("NotesEditor").HtmlAttributes(new { style = "width:400px" }))
            @Html.ValidationMessageFor(model => model.Notes)
        </div>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

**// Customer Controller**

    public class CustomerController : Controller
    {
        private KendoTestDbContext db = new KendoTestDbContext();

        //
        // GET: /Customer/Create

        [HttpGet]
        public ActionResult Create()
        {
            return View();
        }

        //
        // POST: /Customer/Create

        [HttpPost]
        public ActionResult Create(Customer customer)
        {
            if (ModelState.IsValid)
            {
                db.Customers.Add(customer);
                db.SaveChanges();
                return RedirectToAction("Index");
            }

            return View(customer);
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T18:41:14.407

以下是 Telerik 团队的 Daniel 的解决方案：

如果属性名称与编辑器名称不匹配，则无法将编辑器中的值传递给发布操作。编辑器名称用于文本区域名称，如果名称不同，ModelBinder 将无法关联该值。您可以使用 EditorFor 帮助程序并跳过 Name 方法来生成正确的名称：

```
@Html.Kendo().EditorFor(model => model.PropertyName) 
```

# ios - 使用 nsattributedstring 和 nslocalizedstring

> ID：13646298
> 
> 赞同：9
> 
> 时间：2012-11-30T13:33:03.027
> 
> 标签：ios, nsattributedstring, nslocalizedstring

我的旧代码使用 NSLocalizedString 来显示以下内容，其中 outputText 是一个 NSMutableString，它在单个输出会话中包含许多这样的行：

```
[outputText appendFormat: NSLocalizedString(@"\n\n%@ and %@ are identical.  No comparison required.", @"\n\n%@ and %@ are identical.  No comparison required."), self.ipAddress, secAddress.ipAddress]; 
```

我正在尝试更改各种 ipAddress 字符串的颜色，但在使用 NSMutableAttributedString 时找不到类似的方法。

我面临的最大问题是，由于整个字符串都将被本地化，如果不破坏格式化输出的每个部分，我就无法可靠地设置 NSRange。

我是否需要剖析这个字符串的每一部分，将其转换为 NSAttributedString 并将每一部分附加到 outputText 中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T06:45:02.823

答案是：是的。

是的，您需要分别本地化具有不同属性的部分。

# java - 玩家走向左上角

> ID：13646299
> 
> 赞同：2
> 
> 时间：2012-11-30T13:33:10.593
> 
> 标签：java

我的游戏循环中有这段代码：

```
 new Thread(new Runnable() {

            @Override
            public void run() {
                while (true) {
                    if (aPress) {
                        rotate -= rotSpd;
                        rotate = rotate < 0 ? 360 + rotate : rotate;
                    }
                    if (dPress) {
                        rotate += rotSpd;
                        rotate = rotate > 360 ? rotate - 360 : rotate;
                    }
                    if (wPress) {
                        x += (rotate < 180 ? speed : -speed) * Math.abs(Math.sin(Math.toRadians(rotate)));
                        y += (rotate < 270 ? (rotate < 90 ? -speed : speed) : -speed) * Math.abs(Math.cos(Math.toRadians(rotate)));
                    }
                    if (sPress) {
                        x -= (rotate < 180 ? speed : -speed) * Math.abs(Math.sin(Math.toRadians(rotate)));
                        y -= (rotate < 270 ? (rotate < 90 ? -speed : speed) : -speed) * Math.abs(Math.cos(Math.toRadians(rotate)));
                    }
                    repaint();
                    try {
                        Thread.sleep(20);
                    } catch (InterruptedException annoyingUncheckedException) {}
                }
            }

        }).start(); 
```

它做了它应该做的事情：当你按下 A 时，它会逆时针转动。当你按下 D 时，它会顺时针转动。按 W 时前进，按 S 时后退。但是，如果我按住 W 和 D，起初它会像它应该的那样绕一个圆圈，但它会慢慢开始向左上角的方向移动。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T01:50:26.683

首先，我会使用模运算符，以便更好地理解整个代码（也许它也不太容易出错）。

```
if (aPress) {
    rotate = (rotate - rotSpd + 360) % 360;
}
if (dPress) {
    rotate = (rotate + rotSpd) % 360;
}
if (wPress) {
    x += Math.cos(Math.toRadians(rotate));
    y += Math.sin(Math.toRadians(rotate));
}
if (sPress) {
    x -= Math.cos(Math.toRadians(rotate));
    y -= Math.sin(Math.toRadians(rotate));
} 
```

关于你的问题，[我做了一个快速的 jsFiddle](http://jsfiddle.net/zoom/AumcZ/)看看我是否可以重现这个问题，但我不能，所以我想这与按键（向下/向上/按住）事件的处理方式有关。也许您可以尝试记录每次迭代时按下的按键集，并尝试查看是否存在某种不一致。

注意：在我的 jsFiddle 中，W/A/S/D 键已被 UP/DOWN/LEFT/RIGHT 取代，以最大限度地减少键盘布局问题。我还重构了循环代码以反映我的逻辑和[SJuan76](https://stackoverflow.com/users/598289/sjuan76)的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:42:08.887

这确实是一个评论，但为了更好的格式，我将使用一个答案。

我发现这段代码（以及其他类似的）有点奇怪：

```
x += (rotate < 180 ? speed : -speed) * Math.abs(Math.sin(Math.toRadians(rotate))); 
```

x（水平值）应该取决于余弦，而不是窦。此外，奇怪的是，您必须更改速度的符号，然后将值设为`sin`绝对值。

不是更好吗？

```
x+= speed * Math.cos(Math.toRadians(rotate)) 
```

当然，您可能想使用垂直指向的 0 标题，但即使这样我也觉得更容易

```
x+= speed * Math.cos(Math.toRadians(rotate) + Math.PI/4) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:40:47.140

你可以通过做这样的事情来决定你想要的行为吗？

```
if(wPress && dPress)
{
    //code for both being hit
} 
```

我的猜测是，您当前的问题是由于 aw 和 d 压力机的速度不相等导致非圆形运动路径。

# php - XPath 2.0 和 LibXML2

> ID：13646303
> 
> 赞同：3
> 
> 时间：2012-11-30T13:33:29.427
> 
> 标签：php, xslt, xpath, xslt-2.0, libxml2

我最近遇到了应该支持 XPATH 2.0 标准的**libx** [http://www.explain.com.au/libx/ 。](http://www.explain.com.au/libx/)但是链接都死了。所以我的问题是我们在哪里可以得到构建或者这个项目完全死了，如果它**有替代品**吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-01T17:15:32.930

Steve Ball 在 2011 年初勇敢地启动了一个为 libxml 添加 2.0 支持的项目，但很快发现这是一个比他有时间做的更大的项目，据我所知，他没有取得任何进展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T17:16:19.523

我不确定 libxml，但您可以使用 saxon 库来获得 XPATH 2.0 支持

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T17:48:32.517

XPath 2.0 支持绝对不在 libxml2 中，而且不会很快出现。我能确定的最新官方说法是：

[http://www.mail-archive.com/xml@gnome.org/msg04082.html](http://www.mail-archive.com/xml@gnome.org/msg04082.html)

```
 Sorry, no support for 2.0 planned, the spec change is far too big and
intrusive. Look at the EXSLT extensions which are supported by libxslt
and xsltproc, they are likely to provide the needed extensions. 
```

# javascript - Google Maps api v3 获取街道的起点和终点坐标

> ID：13646304
> 
> 赞同：2
> 
> 时间：2012-11-30T13:33:55.040
> 
> 标签：javascript, google-maps, google-maps-api-3

我想按名称突出显示特定街道。我可以用街道的起点和终点坐标来做到这一点。我不想传递坐标，而是传递街道名称。谷歌地图将返回街道坐标，但我需要起点和终点坐标。

```
request = {
   origin: "streetname",
   destination: "streetname",
   travelMode: google.maps.TravelMode.DRIVING
}; 
```

在此示例中，它将返回相同的起点和终点坐标。

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T15:22:49.813

Google Maps API v3 不这样做。您需要找到不同的数据源或手动确定坐标。

# android - 定位在相对布局中不起作用

> ID：13646317
> 
> 赞同：0
> 
> 时间：2012-11-30T13:34:35.693
> 
> 标签：android, android-layout, android-relativelayout

我有一个小问题。请看下图：

![在此处输入图像描述](../Images/f771a76bcddc12d76808d837cb122201.png)

我在将 TextView1 定位在 edittext 上方时遇到了问题，所以我查看了这个论坛以获得很好的解决方案。我正在使用`android:layout_above="@id/edittext"`，但它似乎不起作用。然后我试了一下`android:layout_below="@id/textview"`，效果很好。但现在我有其他问题。我无法在下面的 edittext 顶部中心对齐 TextView1。我尝试了 layout_align 选项，但它们中的大多数都会抛出异常“一些循环的东西”。

问题在哪里？下面是我的 XML（相对布局）

```
 <RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal"
    android:gravity="center"
    android:padding="10dp" >

    <TextView
       android:id="@+id/workingTimeTV"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"    
       android:text="TextView1" />

     <EditText
        android:id="@+id/hoursET"
        android:layout_width="100dp"
        android:text="1"
        android:gravity="center"
        android:maxLength="6"
        android:layout_below="@id/workingTimeTV"
        android:layout_height="wrap_content"
        android:inputType="number" >
        <requestFocus />
    </EditText>

    <TextView
       android:id="@+id/hoursTV"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:textSize="25sp"
       android:layout_toRightOf="@id/hoursET"
       android:layout_alignBaseline="@id/hoursET"
       android:text="h" /> 
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:52:48.273

问题是您假设如果 **`android:gravity="center"`**将子元素设置在中心，但它不适用于相对布局，因此您可以使用 **`android:layout_centerVertical="true"`**每个子元素，无论您想在中心放置什么。以下修改后的代码将满足您的期望。

```
 <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:padding="10dp" >

        <TextView
            android:id="@+id/workingTimeTV"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:text="TextView1" />

        <EditText
            android:id="@+id/hoursET"
            android:layout_width="100dp"
            android:layout_height="wrap_content"
            android:layout_below="@id/workingTimeTV"
            android:layout_centerHorizontal="true"
            android:gravity="center"
            android:inputType="number"
            android:maxLength="6"
            android:text="1" >

            <requestFocus />
        </EditText>

        <TextView
            android:id="@+id/hoursTV"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignBaseline="@id/hoursET"
            android:layout_toRightOf="@id/hoursET"
            android:text="h"
            android:textSize="25sp" />
    </RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:38:25.130

下面的代码可以帮助你

```
<TextView
    android:id="@+id/workingTimeTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:layout_centerHorizontal="true"
    android:text="TextView1" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:46:59.820

使用 android:layout_centerInParent="true" 将您的文本框放在中心，并使用相对布局来执行此操作。

# c++ - 数组订阅运算符的使用

> ID：13646321
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:34:52.037
> 
> 标签：c++, variable-assignment, operator-keyword

我定义了一个类`complex`和类`signal`。我已经为复杂的类重载了 + 和 - 。信号类是用复杂类型的成员定义的`complex *sig_Data;`，我使用数组订阅信号如下

```
complex &operator[](int i)
    {
        if(i >= range_start && i <= range_end) return sig_Data[zero_pt+i];
        else return complex(0);
    } 
```

`zero_pt`用作参考。

对于信号类的 + 运算符重载，我使用了这个

```
signal operator+(signal &a, signal &b)
{
    int r_start = min(a.range_start, b.range_start);
    int r_end = max(a.range_end, b.range_end);
    int z_pt = max(a.zero_pt, b.zero_pt);
    signal temp(r_start, r_end, z_pt);
    for(int i = r_start; i <= r_end; i++)
    {
        temp[i] = a[i] + b[i];
    }
    return temp;
} 
```

当我在调试中使用 VC++ 检查值但它们没有被分配给 temp 时，添加似乎在这里正确发生。我什至尝试使用带有复制交换成语的赋值重载（[什么是复制交换成语](https://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom)）。

函数中使用的构造`signal operator[](int i)`函数是。

```
signal(int r_start, int r_end, int z_pt)
    {
        range_start = r_start;
        range_end = r_end;
        zero_pt = z_pt;
        int arr_ind = r_end - r_start;

        sig_Data = new complex [arr_ind];
    } 
```

请帮助我确定我哪里出错了。

更完整的代码：

```
 #include <iostream>
    #include <conio.h>
    #include <string>

    #include <cstdlib>
    #include <cctype>
    #include <cstring>

    using namespace std;

    namespace Complex
    {
        class complex
        {
            double real;
            double imag;

        public:
            complex(double re = 0, double im = 0)
            {
                real = re;
                imag = im;
            }

            complex(complex &t)
            {
                real = t.real;
                imag = t.imag;
            }

            void StrtoComplex(const char *temp)
            {
                int i;

                for(i = 0; i < strlen(temp); i++)
                {
                    if(temp[i] == 'j' || temp[i] == 'i')
                        break;
                }

                real = atof(temp);//takes till the last valid char so after + or whitespace it ignores
                if(*(temp + i - 1) == '-')
                    imag = -atof(temp + i + 1);
                else
                    imag = atof(temp + i + 1);

            }

            friend complex operator+(complex &a, complex &b);
                    friend ostream &operator<<(ostream &s, complex &t);
            friend istream &operator>>(istream &s, complex &t);
            };
        //overloading + to add complex numbers
        complex operator +(complex &a, complex &b)
        {
            complex t;
            t.real = a.real + b.real;
            t.imag = a.imag + b.imag;
            return(t);
        }

        ostream &operator<<(ostream &s, complex &t)
        {
            s<<t.real<<" +j"<<t.imag;
            return s;
        }

        istream &operator>>(istream &s, complex &t)
        {
            std::string temp;

            std::getline(s, temp);
            t.StrtoComplex(temp.c_str());
            return s;
        }
    }

    namespace Discrete
    {
        using Complex::complex;
        class signal
        {
            complex *sig_Data;

            int range_start, range_end, zero_pt;

        public:
            signal()
            {
                sig_Data = NULL;
                range_start = range_end = zero_pt = 0;
            }

            signal(complex i)
            {
                sig_Data = new complex(i);
                range_start = range_end = zero_pt = 0;
            }

            signal(int r_start, int r_end, int z_pt)
            {
                range_start = r_start;
                range_end = r_end;
                zero_pt = z_pt;
                int arr_ind = r_end - r_start;

                sig_Data = new complex [arr_ind];
            }

            void StrtoSig(char *temp)
            {
                int arr_ind = 0;
                char *tok;

                if(!*temp) return;

                tok = temp;
                zero_pt = 0;
                //
                int flag;

                for(int i = 0; i < (flag = strlen(temp)); i++)
                {
                    tok++;
                    if(*tok == '^') zero_pt = arr_ind;
                    if(*tok == ',') arr_ind++;
                }
                range_start = 0 - zero_pt;
                range_end = arr_ind - zero_pt;

                sig_Data = new complex [arr_ind];
                tok = temp+1;
                for(int i = 0; i <= arr_ind; i++)
                {
                    if(*tok == ',') tok++;
                    while(isspace(*tok)) tok++;
                    if(*tok == '^') tok++;
                    sig_Data[i].StrtoComplex(tok);
                    while(*tok != ',' && *tok != '}'&& *tok != '\0') tok++;
                }
            }

            complex &operator[](int i)
            {
                if(i >= range_start && i <= range_end) return sig_Data[zero_pt+i];
                //else return complex(0);
            }

            friend signal operator+(signal &a, signal &b);
                    friend ostream &operator<<(ostream &s, signal &t);
    friend istream &operator>>(istream &s, signal &t);
        };

        //Overloading + operator
        signal operator+(signal &a, signal &b)
        {
            int r_start = min(a.range_start, b.range_start);
            int r_end = max(a.range_end, b.range_end);
            int z_pt = max(a.zero_pt, b.zero_pt);
            signal temp(r_start, r_end, z_pt);
            for(int i = r_start; i <= r_end; i++)
            {
                temp[i] = a[i] + b[i];
            }
            return temp;
        }

            ostream &operator<<(ostream &s, signal &t)
{
    s<<"{";
    for(int i = t.range_start; i <= t.range_end; i++)
    {
        if(i == (t.range_start + t.zero_pt))
            s<<" ^"<<t[i];
        else if(i == t.range_end)
            s<<" "<<t[i];
        else
            s<<" "<<t[i]<<",";
    }
    s<<"}";
    return s;
}

        istream &operator>>(istream &s, signal &t)
        {
            char *ip;
            s>>ip;
            t.StrtoSig(ip);
            return s;
        }
    }

   void main()
{
    using Discrete::signal;
    signal a,b,c;
    a.StrtoSig("{1+i5, ^7+i6}");
    b.StrtoSig("{5+i4, 7+i5}");

    c = a+b;
    cout<<c;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:52:37.123

如果你希望能够通过 修改类`operator[]`，它必须返回一个引用：

```
complex &operator[](int i)
{
    if(i >= range_start && i <= range_end) return sig_Data[zero_pt+i];
    else throw std::range_error("invalid index to operator[]");
} 
```

当您返回一个值时，它会被复制到一个临时值中，因此对结果的赋值`operator[]`会在表达式的末尾被丢弃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:11:53.043

好的，让我在心里为你调试你的代码

想象一下你有两个信号

```
signal s1 (5, 20, 8);
signal s2 (3, 25, 9); 
```

现在您正在尝试添加

```
signal s = s1 + s2; 
```

会发生什么：

1.  你构造一个`temp`信号：

    信号温度（3、25、9）；

2.  它创建了一个内部数组

    sig_Data = 新复合体 [22];

3.  你的循环看起来像这样

    对于 (i = 3; i < 25; ++i)

4.  对于每一个`i`你`operator[]`这样做

    if(i >= range_start && i <= range_end) return sig_Data[9+i];

5.  现在想象一个步骤`i = 15`，它将执行此操作

    返回 sig_Data[9+15];

这违反了未定义行为的数组边界。

现在，我将把它留给你来解决这个烂摊子。

PS Besies，你有内存泄漏，你从来没有`delete[] sig_Data`。即使你这样做了，你也会有一个堆损坏，因为你在你的复制构造函数中做了一个浅拷贝

# pixels - 在特定颜色范围内使用 imagesetpixel 设置随机像素

> ID：13646324
> 
> 赞同：0
> 
> 时间：2012-11-30T13:35:20.037
> 
> 标签：pixels

我想知道是否可以设置图像中像素的颜色，其中像素的坐标是在定义的颜色中随机选择的。

例如包含 3 种颜色的图像 (100x100)，红色（4000 像素）、黑色（3000 像素）和紫色（3000 像素）。现在我想将 100 个随机红色像素变为黄色。

我玩过 imagesetpixel，但不知道是否可以在颜色范围内随机设置 $x 和 $y。

```
imagesetpixel ($image , $x , $y , $color ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:56:57.223

我假设我们不知道图像中不同颜色的像素是如何排列的。在您有许多红色像素的情况下，有一个简单的方法。

```
while(!exit):
   pixel = select random pixel
   if pixel.color = red:
       pixel.color = yellow
       exit = true
   end if
end while 
```

这将改变一个像素，因此您需要这样做 100 次。

如果您只有几个颜色像素要更改，您最好先找到一种颜色的所有像素并将它们的坐标存储在列表或数组中，然后随机选择该数据结构的一个元素。

# radio-button - 使用 jQuery ui 滑块和单选按钮执行计算

> ID：13646328
> 
> 赞同：2
> 
> 时间：2012-11-30T13:35:36.280
> 
> 标签：radio-button, jquery-ui-slider

我正在尝试在[http://www.andyloos.co.uk/calculator/](http://www.andyloos.co.uk/calculator/)上复制计算器。是否有可能看到他们是如何进行计算的？看看他们的Java-Script？

我已经到了[http://jsfiddle.net/jstyl_es/Sqsuu/](http://jsfiddle.net/jstyl_es/Sqsuu/)但我对 Java-Script 的了解还不够深入，无法推动它向前发展。任何人都可以帮忙吗？

```
<div id="slider1"></div>

<div id="slider2"></div>

<div id="option">
  <input type="radio"  name="timeselect" value="optionA" />
  Less than 6 hours
  <input type="radio"  name="timeselect" value="optionB" />
  More than 6 hours
</div>

<input class="submit" type="submit" name="submit" value="Estimate">        

</div>

`$(function() {
  $( "#slider1" ).slider({
    value:0,
    min: 0,
    max: 100000,
    step: 50,
    slide: function( event, ui ) {
      $( "#amount1" ).val( ui.value );
    }
  });
  $( "#amount1" ).val($( "#slider1" ).slider( "value" ) );
});

$(function() {
  $( "#slider2" ).slider({
    value:0,
    min: 0,
    max: 100000,
    step: 50,
    slide: function( event, ui ) {
      $( "#amount2" ).val( ui.value );
    }
  });
  $( "#amount2" ).val($( "#slider2" ).slider( "value" ) );
}); 
```

# magento - 如何强制具有某些数据类型的模型属性

> ID：13646329
> 
> 赞同：0
> 
> 时间：2012-11-30T13:35:37.200
> 
> 标签：magento

数据库表中有“date_stamp”字段。字段类型为 bigint(20)。我在我的代码中得到了这个值。

```
 $dateStamp = $model->getDateStamp(); 
```

我需要 $dateStamp 是 int 或 long。但它是字符串。如何强制它为 int 或 long？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T02:25:38.603

由于我需要快速解决方案，我在模型中添加了新功能。

```
public function getFloatDateStamp(){
    $dateStamp = (float) $this->getDateStamp();
    return $dateStamp;   
} 
```

# google-drive-api - 使用自定义域发布 Google Drive 网站

> ID：13646334
> 
> 赞同：6
> 
> 时间：2012-11-30T13:35:43.973
> 
> 标签：google-drive-api

[我听说](http://www.slashgear.com/google-drive-launches-website-publishing-29258945/)你可以在公共文件夹中的谷歌驱动器中发布一个静态网站，我想知道如何将我的域配置到驱动器中托管的那个网站。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-30T18:21:31.597

目前，您无法将自己的自定义域映射到 Google Drive 托管（即使用 CNAME 或 A 记录），但您可以执行以下操作之一：

*   在您的域上设置重定向到 Google Drive，例如通过上传`index.php`文件`<?php header("Location: https://googledrive.com/host/VERYLONGFOLDERID"); ?>`
*   使用免费服务[G Drives](http://gdriv.es)，它为 Google Drive 托管提供自定义短 URL（别名）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T13:55:06.027

链接到关于此的博文：http: [//googleappsdeveloper.blogspot.nl/2012/11/announcing-google-drive-site-publishing.html](http://googleappsdeveloper.blogspot.nl/2012/11/announcing-google-drive-site-publishing.html)

链接到 Google Drive SDK 文档：http: [//developers.google.com/drive/publish-site](http://developers.google.com/drive/publish-site)

# events - 子元素的 Prototype.js event.target.id

> ID：13646335
> 
> 赞同：2
> 
> 时间：2012-11-30T13:35:47.273
> 
> 标签：events, onclick, prototypejs, hide

单击页面中的其他位置时，我想隐藏一个 div。为此，我有：

```
$(document.body).observe('click', function(e){
    if(e.target.id != 'myDiv') {
        $('myDiv').hide();
    }
}); 
```

工作正常，唯一的问题是在这个 div 里面我有其他元素，点击它们也会关闭#myDiv。我想要它，以便单击此 div 内的任何内容都不会触发隐藏。搜索后，我在这里找到了如何使用 jQuery 执行此操作的答案：[https](https://stackoverflow.com/a/12222263/548524) ://stackoverflow.com/a/12222263/548524 。但是，我似乎无法在 Prototype 中使用它，显然 has() 在这里无效。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T20:36:38.267

```
document.observe('click', function(event) {
  if (!event.findElement('#myDiv')) {
    $('myDiv').hide();
  }
}); 
```

1.  你不需要`$(document.body)`- 已经有[文档范围的观察](http://api.prototypejs.org/dom/document/observe/)
2.  有一种[从事件中查找元素的方法](http://api.prototypejs.org/dom/Event/prototype/findElement/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:42:45.857

使用“向上”功能：

```
$(document.body).observe('click', function(e){
    if(e.target.id != 'myDiv' && !$(e.target.id).up('#myDiv')) {
        $('myDiv').hide();
    }
}); 
```

# zend-framework2 - 使用 tableGateway 返回表主键名称

> ID：13646338
> 
> 赞同：2
> 
> 时间：2012-11-30T13:35:59.223
> 
> 标签：zend-framework2

我正在尝试为我的表对象创建一个抽象对象。

今天我有很多对象，例如：`CategoriaTable`，`FornecedoresTable`等，实现`$this->tableGateway->insert()`，`$this->tableGateway->update()`等

我创建了一个`TableAbstract`包含大部分这些功能的，但我遇到了一个问题：

```
// In CategoriaTable my table id is named cat_id
$this->tableGateway->update($object->getArrayCopy(),array('cat_id' => $object->getId()))

// But in FornecedoresTable my table id is named for_id
$this->tableGateway->update($object->getArrayCopy(),array('for_id' => $object->getId())) 
```

如何从 tableGateway 获取表的 id？有更好的方法来做我想做的事吗？

我想我可以在我的对象中注入 id 名称，但我不认为这是一个好方法......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-18T17:35:33.990

您可以创建新的 TableGateway 类参数。（在我的例子中，我创建了 $this->primary;）

如果未设置，请使用 Zend\Db\Metadata\Metadata 直接从 db 结构中找到它。

```
<?php
//...
use Zend\Db\TableGateway\AbstractTableGateway;
use Zend\Db\Metadata\Metadata;

class AbstractTable extends AbstractTableGateway
{
    protected $primary;

    public function getPrimary()
    {
        if (null === $this->primary) {
            $metadata = new Metadata($this->adapter);
            $constraints = $metadata->getTable($this->getTable()->getTable())
                                    ->getConstraints();

            foreach ($constraints AS $constraint) {
                if ($constraint->isPrimaryKey()) {
                    $primaryColumns = $constraint->getColumns();
                    $this->primary = $primaryColumns;
                }
            }
        }

        return $this->primary;
    }
}
?> 
```

# vb.net - 更快/更简洁的方法来计算文本框的宽度/左侧，具体取决于显示的数量

> ID：13646342
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:36:18.243
> 
> 标签：vb.net, math, textbox, positioning, activereports

嘿，我目前正在寻找一种方法来计算我的报告表单上 MAX 12 txtboxes 的宽度和左侧位置。高度将始终为**0.206**，顶部将始终为**0**。

这是带有 12 个（最大）txtbox 的代码的样子：

```
txtData1.Width = 0.7
txtData1.Left = 0

txtData2.Width = 0.7
txtData2.Left = 0.708

txtData3.Width = 0.7
txtData3.Left = 1.416

txtData4.Width = 0.7
txtData4.Left = 2.124

txtData5.Width = 0.7
txtData5.Left = 2.832

txtData6.Width = 0.7
txtData6.Left = 3.54

txtData7.Width = 0.7
txtData7.Left = 4.248

txtData8.Width = 0.7
txtData8.Left = 4.956

txtData9.Width = 0.7
txtData9.Left = 5.664

txtData10.Width = 0.7
txtData10.Left = 6.372

txtData11.Width = 0.7
txtData11.Left = 7.08

txtData12.Width = 0.7
txtData12.Left = 7.788 
```

根据我的计算（我喜欢数学……数学就是不爱我：o））总宽度为**8.4 英寸**，总宽度为**7.788 英寸**。工作表宽 8.5 英寸（横向视图）。

![布局](../Images/601edd27137f99a77ab4d924bd704783.png)

所以现在困难的部分开始发挥作用。对于 11 个盒子，宽度会增加一点，左边的位置也会增加，以容纳不再有第 12 个盒子的额外空间。

我正在尝试用最少的代码找到一种很好的方法，因为我知道我可以对每个级别（12 到 2 个文本框）执行与上述相同的操作，但这将是很多代码。

因此，计算剩余 11-2 个 txtboxes 的任何帮助都会有很大帮助！:o)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:31:37.287

我不确定我是否完全理解你的问题，但我收集到的是你总是希望文本框完全填满 8.5 英寸。

如果是这样的话，我会做如下的事情：

```
 Dim NumberOfBoxes As Integer = 11 ' Number of textboxes you'll have next to each other
    Dim AssignedWidthPerBox As Double = 8.5 / NumberOfBoxes
    Dim CurrentLeft As Double = 0   ' How Far left you are on your form - Increment this by AssignedWidthPerBox for each textbox 
```

然后通过循环（首选）或手动分配 Textbox 属性，如下所示：

```
 txtData1.Width = AssignedWidthPerBox
    txtData1.Left = CurrentLeft
    CurrentLeft += AssignedWidthPerBox 
```

希望这可以帮助

# html - div定位在同一行

> ID：13646344
> 
> 赞同：0
> 
> 时间：2012-11-30T13:36:32.487
> 
> 标签：html, css

我有一些 div 的问题。简而言之，这就是我需要的：2 个具有一定宽度（相同宽度）的 div - 一个向左浮动，一个向右浮动，第三个 div 占据所有剩余空间。div 使用 display : inline-block 将它们放在同一行。

我试过这个：

```
 <div class="wrapper">
        <div class="control leftControl"></div>
        <div class="display"></div>         
        <div class="control rightControl"></div>
    </div> 
```

这是我的CSS：

```
.wrapper {
    width: 100%;
    height: 100%;
    min-width: 960px;
    background-color: #E8E8E8;
}

.control {
    width: 10%;
    height: 100%;
    display: inline-block;
    background-color: #ADADAD;
}

.leftControl {
    float: left;
}

.rightControl {
    float: right;
}

.display {
    width: 80%;
    height: 100%;
    display: inline-block;
} 
```

问题是在某些分辨率上使用 % 会导致最后一个 div (controlRight) 移动到新的一行。我可以理解为什么并发现如果我在显示上使用 79% 的 div 显示几乎正确（1% 未使用。）我很清楚，这不是一个正确的解决方案。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:57:54.053

您可以放置​​所有元素`float:left`，并且您的 100% 将始终适合：[小提琴](http://jsfiddle.net/f39zH/)

HTML

```
<div class="control"></div>
<div class="display"></div>         
<div class="control"></div> 
```

CSS

```
.control {
    width: 10%;
    height: 200px;
    background-color: green;
    float:left;
}

.display {
    width: 80%;
    height: 200px;
    background-color:blue;
    float:left; 
}​ 
```

把所有东西都放在上面`float left`只会把div一个一个地推到右边。

# css - 有没有办法在css中使用变量？

> ID：13646346
> 
> 赞同：4
> 
> 时间：2012-11-30T13:36:34.773
> 
> 标签：css

我想写这样的css代码。有没有可用的插件？

```
mcolor = #ff00ff;

body
{
    color: mcolor;
}

.ele
{
    width: body.width / 2;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T13:37:36.870

看看 LESS： http: [//lesscss.org/](http://lesscss.org/)或 SASS：[http ://sass-lang.com/](http://sass-lang.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:39:17.890

在纯 CSS 中这是不可能的。但是有一个[规范的工作草案](http://dev.w3.org/csswg/css-variables/)。它不会很快在浏览器中可用，因此同时按照@Logan Serman 的建议使用 LESS 或 SASS

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-30T13:40:55.537

不，没有办法在 css 中使用变量。

如果你想使用变量，那么你想在 php 或 javascript 或其他语言中使用 css。

了解更多信息。你学习这个

[http://lesscss.org/](http://lesscss.org/)

或者

[http://sass-lang.com/](http://sass-lang.com/)

# python - Python除以零错误

> ID：13646347
> 
> 赞同：8
> 
> 时间：2012-11-30T13:36:41.800
> 
> 标签：python, divide-by-zero

我在 python 中有一个类，具有以下属性：

> ```
>  self.number1 = 0
>     self.number2 = 0
>     self.divided = self.number1/self.number2 
> ```

这当然会引发零错误：

> ZeroDivisionError：整数除法或以零为模

这个想法是我稍后会增加 number1 和 number2，但是 self.divided 会自动更新吗？如果它是自动更新的，那么我该如何解决零错误？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-30T13:38:12.510

不，`self.divided`是一个简单的属性，不会自动更新。对于动态属性，请改用 a [`property`](http://docs.python.org/2/library/functions.html#property)：

```
class Foo(object):
    number1 = 0
    number2 = 0

    @property
    def divided(self):
        return self.number1 / self.number2 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-30T13:41:59.667

避免 ZeroDivisionError 的自动更新：

```
@property
def divided(self):
    try:
        #suppose that number2 is a float
        return self.number1/self.number2
    except ZeroDivisionError:
        return None 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-13T16:00:49.183

正如我所展示的，您可以单独执行以下操作：

```
self.divided = self.number1/(self.number2  or not self.number2) 
```

这可确保如果您的值为 0，则不会出现错误。但请确保，仅当您使用整数值或大于 1 的值时才使用此选项。

# javascript - Twitter API 在发推文后注销用户

> ID：13646349
> 
> 赞同：1
> 
> 时间：2012-11-30T13:36:50.740
> 
> 标签：javascript, twitter

我需要让用户登录 Twitter 并发布状态，然后自动将其注销。

我浏览了 Twitter API 并找不到任何东西。

当前代码：

```
 twttr.ready(function (twttr) {
        twttr.events.bind('tweet', function(event) {
            if(!code){
                jQuery('#voucher-container').show();
                var data = {sessionId: sessionId, type: 'twitter'};
                jQuery.post('checkTweet.php', data, function(response){
                    response = jQuery.parseJSON(response);
                    if(response.error){
                        alert(response.error);
                    }
                    else{
                        window.location.href = 'stage3.php';
                    }
                });
                code = true;
            }
        });
    }); 
```

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:34:45.923

您不能通过他们的 API 将用户从 Twitter 中注销。

[Twitter API - 注销](https://stackoverflow.com/questions/1960957/twitter-api-logout)

# gdb - eclipse-cdt: how to suppress some GDB commands?

> ID：13646357
> 
> 赞同：0
> 
> 时间：2012-11-30T13:37:20.503
> 
> 标签：gdb, eclipse-cdt

**I have** a remote GDB stub to which my GDB debugger connects over TCP/IP under the control of Eclipse-CDT. The debugger doesn't support `set auto-solib-add` command. So when I start the application Eclipse (among other commands) sends: `-gdb-set auto-solib-add on` command to the debugger and it responds with `^error,msg="No symbol \"auto\" in current context."` That **causes launch to fail**.

I tryed to reset `Load shared library symbols automatically` flag under *Run->Debug Configurations...->C/C++ Remote Application->Debugger->Shared libraries*. But despite my expectations instead of ommiting the command it sent `-gdb-set auto-solib-add off` and it didn't work, too.

**I need** to find a way to influence Eclipse and make it suppress (or in general to gain the full control of Eclipse's behaviour) this command.

Or maybe it is possible to make GDB debugger reply with a warning instead of the error to this command?

*Eclipse-CDT: Juno, 4.1.2*
*GDB debugger: arm-elf-gdb, 6.1*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:15:57.580

I checked CDT source and apparently there is no way to do it short of implementing custom GDB connector (or forking CDT).

This command is issued as a part of the "final launch sequence" - see org.eclipse.cdt.dsf.gdb.launching.FinalLaunchSequence:370\. The reason it still sends the command when you uncheck the launch configuration box is to override whatever you may have in gdbinit.

# android - 在 SQL lite 中为 android devlopment 创建列

> ID：13646359
> 
> 赞同：0
> 
> 时间：2012-11-30T13:37:30.573
> 
> 标签：android, database, eclipse, sqlite

我正在使用扩展 SQL Lite 开放助手的数据处理程序类创建数据库。我复制了一个示例，但此示例只有三列 ID、名称和技能。我想再添加三列力量、忠诚度和武器。该代码适用于这三列，但是一旦我再添加三列，它就不起作用了，并说它在创建数据库时找不到新列。我正在使用的代码如下..

公共类 DatabaseHandler 扩展 SQLiteOpenHelper {

```
private static final String DATABASE_NAME = "Cards.db";

private static final String TABLE_NAME = "card";

private static final String COL_ID = "id";

private static final String COL_NAME = "name";

private static final String COL_SKILL = "skill";

private static final String COL_STRENGTH = "strength";

private static final String COL_LOYALTY = "loyalty";

private static final String COL_WEAPON = "weapon";

public DatabaseHandler(Context context) {
    super(context, DATABASE_NAME, null, 1);
}

@Override
public void onCreate(SQLiteDatabase db) {
    String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_NAME + "("
            + COL_ID + " INTEGER PRIMARY KEY," + COL_NAME + " TEXT,"
            + COL_SKILL + " TEXT" + 
            COL_STRENGTH + "TEXT" 
            + COL_LOYALTY + "TEXT" + COL_WEAPON + "TEXT"+
            ")";
    db.execSQL(CREATE_CONTACTS_TABLE);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldNum, int newNum) {
    // Drop older table if exist and create fresh
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);
    onCreate(db);
}

public void addCard(Card card) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues values = new ContentValues();
    values.put(COL_ID, card.getID());
    values.put(COL_NAME, card.getName());
    values.put(COL_SKILL, card.getSkill());
    values.put(COL_STRENGTH, card.getStrength());
    values.put(COL_LOYALTY, card.getLoyalty());
    values.put(COL_WEAPON, card.getWeapon());
    db.insert(TABLE_NAME, null, values);
    db.close();
}

public List<Card> getAll() {
    List<Card> list = new ArrayList<Card>();
    String selectQuery = "SELECT  * FROM " + TABLE_NAME;
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);
    if (cursor.moveToFirst()) {
        do {
            Card card = new Card(cursor.getInt(0),
                    cursor.getString(1), cursor.getString(2))
                    cursor.getString(3), cursor.getString(4),
                    cursor.getString(5)
                    );
            list.add(card);
        } while (cursor.moveToNext());
    }
    return list;
}

public void removeAll() {
    SQLiteDatabase db = this.getWritableDatabase();
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);
    onCreate(db);
}

public void deleteCard(Card card) {
    SQLiteDatabase db = this.getWritableDatabase();
    db.delete(TABLE_NAME, COL_ID + " = ?",
            new String[] { String.valueOf(card.getID()) });
    db.close();
}

public int updateCard(Card card) {
    SQLiteDatabase db = this.getWritableDatabase();
    ContentValues values = new ContentValues();
    values.put(COL_NAME, card.getName());
    values.put(COL_SKILL, card.getSkill());
    values.put(COL_STRENGTH, card.getStrength());
    values.put(COL_LOYALTY, card.getLoyalty());
    values.put(COL_WEAPON, card.getWeapon());
    return db.update(TABLE_NAME, values, COL_ID + " = ?",
            new String[] { String.valueOf(card.getID()) });
}

public Card getCard(int id) {
    SQLiteDatabase db = this.getReadableDatabase();
    Cursor cursor = db.query(TABLE_NAME, new String[] { COL_ID, COL_NAME,
            COL_SKILL, 
            COL_STRENGTH, COL_LOYALTY, COL_WEAPON 
            }, COL_ID + "=?",
            new String[] { String.valueOf(id) }, null, null, null, null);
    if (cursor != null) {
        cursor.moveToFirst();
    }
    Card card = new Card(Integer.parseInt(cursor.getString(0)),
            cursor.getString(1), cursor.getString(2),
            cursor.getString(3), cursor.getString(4),
            cursor.getString(5)
            );
    return card;
} 
```

}

我只是不知道它什么时候不喜欢我要插入的其他列。

我还有一个如下所示的卡片类。

公共类卡{

```
private int ID;

private String name;

private String skill;

private String strength; 

private String loyalty; 

private String weapon;

public Card(int ID, String name, String skill, String strength, String loyalty, String weapon) {
    this.ID = ID;
    this.name = name;
    this.strength = skill;
    this.skill = strength;
    this.loyalty = loyalty;
    this.weapon = weapon;
}

public String getName(){
    return this.name;
}

public void setName(String name){
    this.name = name;
}

public String getSkill(){
    return this.skill;
}

public void setSkill(String skill){
    this.skill = skill;
}

public String getStrength() {
    return this.strength;
}

public void setStrength(String strength) {
    this.strength = strength;
}

public String getLoyalty() {
    return this.loyalty;
}

public void setLoyalty(String loyalty) {
    this.loyalty = loyalty;
}

public String getWeapon() {
    return this.weapon;
}

public void setWeapon(String weapon) {
    this.weapon = weapon;
}

public int getID() {
    return ID;
}

public void setID(int iD) {
    ID = iD;
} 
```

}

目前，我只是通过将数据库写入浏览类的日志来测试数据库的工作原理。我在这里使用的代码是。

公共类浏览扩展活动{

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.layout2);
    DatabaseHandler dh = new DatabaseHandler(this);

    Log.d("Database: ", "Dropping old table");
    dh.removeAll();

    Log.d("Database: ", "Inserting values..");
    dh.addCard(new Card(1, "Trevor", "11", "22", "33", "44"));
    dh.addCard(new Card(2, "Joseph", "49", "65", "87", "12"));
    dh.addCard(new Card(3, "Paul", "87", "12", "90", "01"));
    dh.addCard(new Card(4, "Mary", "30", "43", "12", "98"));

    Log.d("Database: ", "Listing all cards..");
    List<Card> list = dh.getAll();  
    for (Card lr : list) {
        String log = "ID:" + lr.getID() +" Name: " + lr.getName() + " Phone: " + lr.getSkill() + " Strength " + lr.getStrength()
                + " Loyalty: " + lr.getLoyalty() + " Weapon: " + lr.getWeapon();
        Log.d("Database: ", log); 
    }

    dh.deleteCard(new Card(1, "Trevor", "11", "22", "33", "44"));

    dh.updateCard(new Card(2, "Joseph", "36", "27", "87", "11"));

    Log.d("Database: ", "Re-listing all cards..");
    list = dh.getAll();
    for (Card lr : list) {
        String log = "ID:" + lr.getID() +" Name: " + lr.getName() + " Skill: " + lr.getSkill() + " Strength: " +lr.getStrength()
                + " Loyalty: " + lr.getLoyalty() + " Weapon: " + lr.getWeapon();
        Log.d("Database: ", log); 
    }

    Card retrieved = dh.getCard(3);
    Log.d("Database: ", "SINGLE: " + retrieved.getName());
} 
```

}

有谁知道为什么它不会添加其他列？感谢您提供的任何帮助。

编辑**

我正在使用所有代码。当我运行应用程序时，我在 Log Cat 中得到以下信息

11-30 12:44:19.193：I/Database(364)：sqlite 返回：错误代码 = 1，msg = 表卡没有名为忠诚度的列

11-30 12:44:19.213: E/Database(364): 插入 id=1 忠诚度=33 技能=11 力量=22 武器=44 名称=Trevor 时出错

11-30 12:44:19.213: E/Database(364): android.database.sqlite.SQLiteException: 表卡没有名为忠诚度的列：，编译时：插入卡（id，忠诚度，技能，力量，武器，名称）值（？，？，？，？，？，？）；

11-30 12:44:19.213: E/Database(364): at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:91)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteCompiledSql.(SQLiteCompiledSql.java:64)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteProgram.(SQLiteProgram.java:80)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteStatement.(SQLiteStatement.java:36)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteDatabase.compileStatement(SQLiteDatabase.java:1145)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteDatabase.insertWithOnConflict(SQLiteDatabase.java:1536)

11-30 12:44:19.213: E/Database(364): 在 android.database.sqlite.SQLiteDatabase.insert(SQLiteDatabase.java:1410)

11-30 12:44:19.213: E/Database(364): at uk.ac.tees.L1024329.DatabaseHandler.addCard(DatabaseHandler.java:96)

11-30 12:44:19.213: E/Database(364): at uk.ac.tees.L1024329.Browse.onCreate(Browse.java:22)

11-30 12:44:19.213: E/Database(364): 在 android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)

11-30 12:44:19.213: E/Database(364): 在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)

11-30 12:44:19.213: E/Database(364): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)

11-30 12:44:19.213: E/Database(364): at android.app.ActivityThread.access$2300(ActivityThread.java:125)

11-30 12:44:19.213: E/Database(364): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)

11-30 12:44:19.213: E/Database(364): 在 android.os.Handler.dispatchMessage(Handler.java:99)

11-30 12:44:19.213: E/Database(364): 在 android.os.Looper.loop(Looper.java:123)

11-30 12:44:19.213: E/Database(364): 在 android.app.ActivityThread.main(ActivityThread.java:4627)

11-30 12:44:19.213: E/Database(364): at java.lang.reflect.Method.invokeNative(Native Method)

11-30 12:44:19.213: E/Database(364): 在 java.lang.reflect.Method.invoke(Method.java:521)

11-30 12:44:19.213: E/Database(364): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)

11-30 12:44:19.213: E/Database(364): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)

11-30 12:44:19.213: E/Database(364): at dalvik.system.NativeStart.main(Native Method)

编辑* ******

我已经尝试卸载/重新安装应用程序，我也尝试清除应用程序的数据，但都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:46:56.593

看起来好像您错过了各个列名之间的逗号。它应该是

```
@Override
public void onCreate(SQLiteDatabase db) {
    String CREATE_CONTACTS_TABLE = "CREATE TABLE " + TABLE_NAME + "("
            + COL_ID + " INTEGER PRIMARY KEY," + COL_NAME + " TEXT,"
            + COL_SKILL + " TEXT," + 
            COL_STRENGTH + " TEXT, " 
            + COL_LOYALTY + " TEXT, " + COL_WEAPON + " TEXT"+
            ")";
    db.execSQL(CREATE_CONTACTS_TABLE);
} 
```

希望这可以帮助。

**更新** 这也是因为您没有在列名变量和列类型之间放置空格，因此您需要在 TEXT 一词之前放置一个空格，如我上面修改的代码中所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T17:24:37.817

我有完全运行的代码。您可以尝试根据使用情况对其进行修改。

```
public class Database {

    static final String TAG="database";

    static final String DATABASE_NAME="YourDataBaseName";

    static final int DATABASE_VERSION=1;

    static final String DATABASE_COLLECT_TABLE="YourTableName1";
    static final String DATABASE_FOLLOWUP_TABLE="YourTableName2";

    static final String LeadNo="LeadNo";

    static final String Name="Name";

    static final String Process="Process";

    static final String NextAptDate="NextAptDate";

    static final String Time="Time";

    static final String ChequeNo="ChequeNo";

    static final String ChequeDate="ChequeDate";

    static final String Amount="Amount";

    static final String Bank="Bank";

    static final String Status="Status";

    static final String Remarks="Remarks";

    static final String id="ID";

    static final String CREATE_COLLECT_TABLE= "CREATE TABLE " + DATABASE_COLLECT_TABLE + "("
            + id + " INTEGER PRIMARY KEY AUTOINCREMENT, " + LeadNo + " TEXT NOT NULL, " + Name + " TEXT NOT NULL, "
            + Process + " TEXT NOT NULL, " + ChequeNo + " TEXT NOT NULL, " + ChequeDate + " TEXT NOT NULL, "
            + Amount + " TEXT NOT NULL, "+ Bank + " TEXT NOT NULL, "+ Status + " TEXT NOT NULL, "+ Remarks +" TEXT NOT NULL)";

    static final String CREATE_FOLLOWUP_TABLE= "CREATE TABLE " + DATABASE_FOLLOWUP_TABLE + " ("
            + id + " INTEGER PRIMARY KEY AUTOINCREMENT, " 
            + LeadNo + " TEXT NOT NULL, " 
            + Name + " TEXT NOT NULL, "
            + Process + " TEXT NOT NULL, " 
            + NextAptDate + " TEXT NOT NULL, " 
            + Time + " TEXT NOT NULL, "
            + Status + " TEXT NOT NULL, "
            + Remarks +" TEXT NOT NULL)";

    private final Context ctx;

    private DatabaseHelper dbHelper;

    private SQLiteDatabase sqlDB;

    private class DatabaseHelper extends SQLiteOpenHelper
    {

        public DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
            // TODO Auto-generated constructor stub
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub
            Log.i(TAG, "Creating Collect Database :-"+CREATE_COLLECT_TABLE);
            Log.i(TAG, "Creating FollowUp Database :-"+CREATE_FOLLOWUP_TABLE);

            db.execSQL(CREATE_COLLECT_TABLE);
            db.execSQL(CREATE_FOLLOWUP_TABLE);
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            Log.w(TAG, "Upgrading Database from version "+ oldVersion + " to " + newVersion);
        }

    }

    public Database(Context context)
    {
        ctx=context;
    }

    public Database open() throws SQLException
    {
        dbHelper=new DatabaseHelper(ctx);
        sqlDB=dbHelper.getWritableDatabase();
        return this;
    }

    public void close()
    {
        dbHelper.close();
    }

    public long createCollect(String LeadNo,String Name,String Process,
            String ChequeNo,String ChequeDate,String Amount,
            String Bank,String Status,String Remarks)
    {
        ContentValues initialValues=new ContentValues();
        initialValues.put("LeadNo", LeadNo);
        initialValues.put("Name", Name);
        initialValues.put("Process", Process);
        initialValues.put("ChequeNo", ChequeNo);
        initialValues.put("ChequeDate", ChequeDate);
        initialValues.put("Amount", Amount);
        initialValues.put("Bank", Bank);
        initialValues.put("Status", Status);
        initialValues.put("Remarks", Remarks);

        //Checking Values
        Log.i("LeadNo", LeadNo);
        Log.i("Name", Name);
        Log.i("Process", Process);
        Log.i("ChequeNo", ChequeNo);
        Log.i("ChequeDate", ChequeDate);
        Log.i("Amount", Amount);
        Log.i("Bank", Bank);
        Log.i("Status", Status);
        Log.i("Remarks", Remarks);

        return sqlDB.insert(DATABASE_COLLECT_TABLE, null, initialValues);
    }

    public long createFollowUp(String LeadNo,String Name,String Process,
            String NextAptDate,String Time,String Status,String Remarks)
    {
        ContentValues values=new ContentValues();
        values.put("LeadNo", LeadNo);
        values.put("Name", Name);
        values.put("Process", Process);
        values.put("NextAptDate", NextAptDate);
        values.put("Time", Time);
        values.put("Status", Status);
        values.put("Remarks", Remarks);

        //Checking Values
        Log.i("LeadNo", LeadNo);
        Log.i("Name", Name);
        Log.i("Process", Process);
        Log.i("NextAptDate", NextAptDate);
        Log.i("Time", Time);
        Log.i("Status", Status);
        Log.i("Remarks", Remarks);

        return sqlDB.insert(DATABASE_FOLLOWUP_TABLE, null, values);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:45:23.583

如果我理解正确，似乎您忘记实现**onUpgrade()**方法在数据库上执行更改表以添加新列...或者如果您还没有发布应用程序，您可以只做一个清除数据和在不实现**onUpgrade()**的情况下重试...因为您的数据库已经使用旧列集创建，并且在您更新数据库版本号（这将触发**onUpgrade()**）方法调用之前它不会创建新的.

# linux-kernel - Linux 块驱动程序合并 bio 的

> ID：13646361
> 
> 赞同：4
> 
> 时间：2012-11-30T13:37:38.093
> 
> 标签：linux-kernel, linux-device-driver, device-driver, block-device, pci-e

我有一个正在工作的块设备驱动程序，经过一段时间。它适用于 PCIe 设备，我直接使用 make_request_fn 处理 bios，而不是使用请求队列，因为该设备没有寻道时间。但是，它仍然有事务开销。

当我从设备连续读取时，我得到包含许多段的 bios（通常我最多 32 个），每个段由 2 个硬件扇区（所以 2 * 2k）组成，然后将其作为设备的一个分散-收集事务处理，节省大量的信令开销。然而，在写入时，每个 bios 都只有一个 2 个扇区的段，因此操作总共需要更长的时间。我希望以某种方式使传入的 bios 由许多段组成，或者我自己将 bios 明智地合并在一起。这里的正确方法是什么？

的当前内容`make_request_fn`大致如下：

*   确定生物的读/写
*   对于 bio 中的每个部分，在`scatterlist*`with中添加一个条目`sg_set_page`
*   将此散点列表映射到 PCI`pci_map_sg`
*   对于 scatterlist 中的每个段，添加到定义多段 DMA scatter-gather 操作的设备特定结构
*   将该结构映射到 DMA
*   进行交易
*   取消映射结构和 SG DMA
*   如果失败和`bio_endio`成功则调用。`-EIO``0`

请求队列设置如下：

```
#define MYDEV_BLOCK_MAX_SEGS 32
#define MYDEV_SECTOR_SIZE 2048

blk_queue_make_request(mydev->queue, mydev_make_req);

set_bit(QUEUE_FLAG_NONROT, &mydev->queue->queue_flags);
blk_queue_max_segments(mydev->queue, MYDEV_BLOCK_MAX_SEGS);
blk_queue_physical_block_size(mydev->queue, MYDEV_SECTOR_SIZE);
blk_queue_logical_block_size(mydev->queue, MYDEV_SECTOR_SIZE);

blk_queue_flush(mydev->queue, 0);

blk_queue_segment_boundary(mydev->queue, -1UL);
blk_queue_max_segments(mydev->queue, MYDEV_BLOCK_MAX_SEGS);
blk_queue_dma_alignment(mydev->queue, 0x7); 
```

# sql - SQL 多个一对多连接

> ID：13646363
> 
> 赞同：0
> 
> 时间：2012-11-30T13:37:44.097
> 
> 标签：sql, join

我几乎可以肯定我以前遇到过这种情况并且只是有一个扩展的高级时刻，但我试图从 SQL 实例上跨 2 个数据库的三个不同表中提取工作订单数据并将其全部合并到一个报告中，我'正在寻找包含以下列的最终结果：

WO | 生产记录数量 | 库存数量 | 方差

方差部分很简单，我可以嵌套 select 语句，然后减去外部语句中的两个数量，但我遇到的问题是，当我将生产和库存表加入相应数据库中时，我最终得到了总和我所定位的列比它们应有的大得多

样本数据：

```
Work Order, Short P/N, and Long P/N in Work Order Table:
dba.1       
WO  ShortPN LongPN
152 1234    Part1

Short P/N, Quantity on hand, location, and lot # in inventory table:
dba.2           
ShortPN Qty Loc   Lot
1234    31  Loc1  456
1234    0   Loc2  456
1234    0   Loc4  456
1234    19  Loc1  789
1234    25  Loc4  789

Work Order, Long P/N, and production count of the last 5min in Production table:
dbb.3       
WO  LongPN  Count
152 Part3   6
152 Part3   8
152 Part3   9
152 Part3   4
152 Part3   6
152 Part3   7

With this example I've tried:

SELECT 1.WO AS WO
   ,SUM(2.Qty) AS "Qty On Hand"
   ,SUM(3.Count) AS "Produced Qty"

FROM dba.1
INNER JOIN dbb.2 ON 1.ShortPN=2.ShortPN
INNER JOIN dbb.3 ON 1.WO = 3.WO    
GROUP BY 1.WO 
```

我还尝试从 3 中进行选择，在 WO 上加入 1 到 3，然后在 shortPN 上加入 2 到 1，并且两者都产生 SUM() 数字比它们应有的指数高（即应该是 15，xxx 变成了2,000,000），但是如果我从报告中删除一个数据点并仅选择库存或生产数量，我会得到正确的最终结果。我发誓我以前遇到过这个问题，但是我一生都不记得它是如何解决的，如果这也是一个重复的问题，对不起，通过搜索找不到任何东西。

提前感谢您的帮助，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:16:25.747

你可以做这样的事情

```
select
    WO.WO, isnull(i.Qty, 0) as Qty, isnull(p.[Count], 0) as [Count]
from WorkOrder as WO
    left outer join (select t.ShortPN, sum(t.Qty) as Qty from inventory as t group by t.ShortPN) as i on
        i.ShortPN = WO.ShortPN 
    left outer join (select t.WO, sum(t.[Count]) as [Count] from Production as t group by t.WO) as p on
        p.WO = WO.WO 
```

[**SQL FIDDLE 示例**](http://sqlfiddle.com/#!3/b251d/7)

如果你有 SQL Server 2005 或更高版本，你可以这样写

```
select
    WO.WO, isnull(i.Qty, 0) as Qty, isnull(p.[Count], 0) as [Count]
from WorkOrder as WO
    outer apply (select sum(t.Qty) as Qty from inventory as t where t.ShortPN = WO.ShortPN) as i
    outer apply (select sum(t.[Count]) as [Count] from Production as t where t.WO = WO.WO) as p 
```

[**SQL FIDDLE 示例**](http://sqlfiddle.com/#!3/b251d/8)

发生这种情况是因为当你加入`WO`和`inventory`你得到的表时

```
WO  SHORTPN QTY
-------------------
152 1234    31
152 1234    0
152 1234    0
152 1234    19
152 1234    25 
```

并且您看到现在您有 5 行 WO = 152。当您添加与`Production`表的联接时，对于此联接中 WO = 152 的每一行，表中将有 6 行 WO = 152 `Production`，因此您总共将有 30 行并且`QTY`从库存中将列出 6 次。当你总结时，你将有 75 * 6 = 450 而不是 75。因为`Count`你将拥有每个`Count`* 5，所以你将拥有 200 而不是 40。

# c# - DataTable 使用列号而不是列名进行排序

> ID：13646366
> 
> 赞同：5
> 
> 时间：2012-11-30T13:37:58.683
> 
> 标签：c#, .net, performance

我想通过使用列索引而不是列名来对数据表进行排序。我可以通过使用`ORDER BY 2`或使用 SQL 来做到这一点`ORDER BY 3 DESC, 4 DESC`。但是对于数据库性能问题，我想通过使用 CPU 性能来做到这一点。

那么我该如何在 c# 中做到这一点？

示例，这对我不起作用：

```
sortColumn = "3 desc, 4 desc";
dt.DefaultView.Sort = sortColumn.ToString(); 
dt = dt.DefaultView.ToTable(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T13:40:41.013

试试这个方法：

```
dt.DefaultView.Sort = sortColumn; 
dt = dt.DefaultView.ToTable(); 
```

代替

`sortColumn = "3 desc, 4 desc";`

您可以使用

`sortColumn = dt.Columns[3].ColumnName + " DESC," + dt.Columns[4].ColumnName + " DESC";`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:45:22.683

dt.DefaultView.Sort = dt.Columns[index].ColumnName + "DESC";

# git - 如何删除目录？

> ID：13646368
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:38:06.260
> 
> 标签：git, web, github, directory

我正在处理合作伙伴的存储库代码，并且一直在使用 github.com Web 界面直接更改现有文件 - 这一切都非常简单。

但是，我现在需要删除存储库中的一个目录，但这似乎无法通过 github.com Web 界面进行。

我尝试过分叉和克隆存储库，进行更改，提交，同步，然后执行拉取请求 - 但问题是合作伙伴（拥有原始存储库）不在接受拉取请求，并且我只是坐在这里不必要地等待......

与修改单个文件的内容一样，是否有删除目录的实时/即时解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:28:59.810

由于您似乎对原始存储库具有写入权限，因此无需分叉它。只需直接克隆 repo（GitHub 将在 repo 页面顶部显示适当的 url），使用 删除文件夹/文件[`git rm`](http://git-scm.com/docs/git-rm)，然后提交更改，然后推送到 GitHub 远程。

# android - 有没有什么好工具可以让开发者同时开发IOS和Android设备？

> ID：13646371
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:38:18.437
> 
> 标签：android, ios, ide

> **可能重复：**
> [Android 和 iOS：如何为两者开发？](https://stackoverflow.com/questions/4100969/android-ios-how-to-develop-for-both)

基本上我正在寻找一种工具（最好在 Windows 上，因为我目前没有 Mac），它可以让我为 android 和 IOS 编写应用程序。我对 Java 和 C# 有一点点 C++ 的熟练程度，但我还没有研究过移动环境。是否有 IDE/工具可以让我在一台机器上开发两种类型的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:51:40.583

除了我相信使用 C# 的 Monotouch 之外，还有其他一些。有Phonegap，它使用HTML5 和jquery mobile。在 iO 上运行良好，在 Android 上运行良好。然后是 Titanium，编码主要是在 JS 中完成的。两者都很好用，但是使用 JS 来构建界面非常困难。

# c# - 使用 GET 方法提交表单

> ID：13646372
> 
> 赞同：0
> 
> 时间：2012-11-30T13:38:20.340
> 
> 标签：c#, asp.net, asp.net-mvc, model-binding, http-get

好吧，我整个上午都在这上面迷路了，我无处可去。

我对 MVC 有很好的体验，自 2008 年第一个测试版以来一直在使用它，但我无法真正弄清楚这一点。

我基本上有 2 个 GET 方法：第一个呈现表单。第二个是表单指向的方法。我使用 GET 提交，因为它是一个搜索表单，并且我想要一个带有参数的可收藏 URL。

像这样的东西

```
[HttpGet]
public ActionResult DisplayForm()
{
    Contract.Ensures(Contract.Result<ActionResult>() != null);
    Contract.Ensures(Contract.Result<ActionResult>() is ViewResult);

    return this.View();
}

[HttpGet]
public ActionResult Search(MyViewModel viewModel)
{
    Contract.Requires<ArgumentNullException>(viewModel != null);
    Contract.Ensures(Contract.Result<ActionResult>() != null);
    Contract.Ensures(Contract.Result<ActionResult>() is ViewResult || Contract.Result<ActionResult>() is RedirectToRouteResult);

    var result = this.validator.Validate(viewModel); //FluentValidation validation
    if (!result.IsValid)
    {
        result.FillModelState(this.ModelState); //extension method that uses AddModelError underneath for ValidationMessageFor helpers on search form
        return this.RedirectToAction(c => c.DisplayForm()); //MvcContrib redirect to action
    }

    ViewData.Model = viewModel;
    return View();
} 
```

第一次提交表单时，目标方法中的 viewData 会正确填充。

如果我回去再做一次搜索，就像模型绑定器“缓存”了我第一次提交的数据：viewData 总是具有第一次搜索的值。它仅重置重新启动应用程序。

我尝试检查 ModelState 和 HttpContext.Request 并且它们确实包含新数据（不是陈旧的），但 viewData 仍然填充了旧数据。我还尝试重写 OnActionExecuting 和 OnActionExecuted 只是为了在其中放置一个断点并在这些步骤中检查 ModelState，并没有发现任何奇怪的东西。

我还尝试通过浏览器栏直接调用 Search 方法，因为它在 GET 中，我可以做到。尽管如此，ModelState 和 Request 包含我输入的数据，但 viewData 有旧数据。

这真的让我很紧张，因为我无法真正理解发生了什么。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T12:30:31.137

我做了很多实验，发现问题出在我不知道的基类上的 actionfilter 上。MvcContrib 的“PassParametersDurignRedirect”过滤器。没有它一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:43:17.750

你试过 ModelState.Clear()

当你完成搜索电话？

# vb.net - 确定构成文件夹特殊权限的构成

> ID：13646375
> 
> 赞同：1
> 
> 时间：2012-11-30T13:38:30.190
> 
> 标签：vb.net

我正在尝试确定是什么构成了 Windows 7 中文件夹属性中的“特殊权限”选项。

我可以使用 VB .net 中的代码获取文件夹的权限，例如读/写、列出目录、读取和执行...

但我不知道如何确定您在 Windows 7 的文件夹权限属性框中看到的复选框的代码等效项以获得特殊权限。

有谁知道要测试什么是等价的。

我想在 VS 2010 中以 windows 窗体显示文件夹的属性，该窗体显示类似于 windows 7 GUI 的属性。

谢谢。

# java - 动态 web 项目路径

> ID：13646377
> 
> 赞同：1
> 
> 时间：2012-11-30T13:38:37.350
> 
> 标签：java, eclipse, dynamic, web, path

我在 Eclipse 中有一个动态 Web 项目，它使用了一些配置文件，但是当我发现 Eclipse(Juno) 使用 eclipse 文件夹作为动态 Web 项目的根文件夹时（尝试创建一个新项目，结果相同），这是然而，普通的 Java 项目并非如此。我的问题：如何将动态 Web 项目的根文件夹更改为给定路径（例如项目的实际文件夹）？谢谢！

# playframework-2.0 - 如何在 Play 2 中进行 http 有线登录

> ID：13646388
> 
> 赞同：5
> 
> 时间：2012-11-30T13:39:10.417
> 
> 标签：playframework-2.0, playframework-2.1

我想在 play 2 中记录每个 HTTP 请求和响应（用于调试/开发）（目前为 2.0，但一旦可用，我愿意切换到 2.X；首选语言是 Scala）。

我发现我可以使用[onRouteRequest](http://www.playframework.org/documentation/2.0.3/ScalaInterceptors)来获取 requestHeader，但这错过了正文。

[ActionComposition](http://www.playframework.org/documentation/2.0.3/ScalaActionsComposition)可能是另一种选择，但这似乎也不是简单的要求。

获取 HTTP 响应似乎更加复杂。显然，最好根据内容类型自定义/截断日志记录，以避免记录图像/二进制数据。

响应日志记录也应该与异步结果一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T15:40:17.923

您可以使用过滤器（Play 2.1 中引入的一项新功能）。在“更强大的过滤器”中查看[http://www.playframework.com/documentation/2.1.1/ScalaHttpFilters](http://www.playframework.com/documentation/2.1.1/ScalaHttpFilters)

# javascript - 将消息从弹出窗口发送到内容脚本？

> ID：13646389
> 
> 赞同：4
> 
> 时间：2012-11-30T13:39:11.103
> 
> 标签：javascript, events, google-chrome, google-chrome-extension, message

假设我想在单击 google chrome 扩展的弹出页面中的按钮时运行内容脚本？

我尝试了以下方法：

```
//popup.js
document.addEventListener('DOMContentLoaded', function () {
  document.querySelector('button').addEventListener('click', clicked);
  main();
});

function clicked(){
    chrome.tabs.getCurrent(
        function(tab){
            console.log(tab);
            chrome.tabs.sendMessage(tab.id, "doSomething");     
        }
    ); 
} 
```

在内容脚本中：

```
chrome.extension.onMessage.addListener(
    function(message, sender, sendResponse){
        console.log("hello world");
    }
); 
```

问题是`tab`回调`chrome.tabs.getCurrent( )`中的未定义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T14:43:46.983

您是否授予了 manifest.json 中选项卡的权限，如此处所示。

```
 "permissions": [
    "tabs"
  ], 
```

此外，以下代码返回的 tab.id 是弹出视图**（不是内容脚本 TAB.ID）**

```
chrome.tabs.getCurrent(
        function(tab){
            console.log(tab);
            chrome.tabs.sendMessage(tab.id, "doSomething");     
        }
    ); 
```

如果您想向您正在浏览的选项卡发送消息，请使用以下代码的 tab.id，它会给出正确的结果

```
chrome.tabs.query({"status":"complete","windowId":chrome.windows.WINDOW_ID_CURRENT,"active":true}, function(tabs){
     console.log(JSON.stringify(tabs[0]));
     console.log(tabs[0].id); 
}); 
```

如果您需要更多信息，请与我们联系

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T19:10:04.573

@Sudarshan 提供的答案是有效的并且工作正常，但我刚刚找到了另一个解决我的问题的方法。只是想我把它放在这里：

```
function clicked() {
    chrome.tabs.executeScript(null,
      {code:"console.log('hello world');"});
} 
```

它将注入并执行脚本。

# javascript - 在 Javascript 中查找由 - 分隔的值

> ID：13646390
> 
> 赞同：-4
> 
> 时间：2012-11-30T13:39:15.553
> 
> 标签：javascript

如果我得到两个用“-”分隔的值，例如：

```
"first value-second value" 
```

在 JS 中找到两者的好方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:41:21.853

```
var str = "first value-second value",
    arr = str.split('-');
console.log(arr[0]); //'first value'
console.log(arr[1]); //'second value' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T13:42:05.843

split() 方法用于将字符串拆分为子字符串数组，并返回新数组。

```
var str = "first value-second value",
var value = str.split("-");
alert(value[0]);// print first value
alert(value[1]);// print second value 
```

# c# - 如何在 DataRow 中嵌入属性？

> ID：13646391
> 
> 赞同：2
> 
> 时间：2012-11-30T13:39:15.820
> 
> 标签：c#

我正在做我的项目，其中我有一个书籍数据库。我已将该数据库加载到 DataTable“书籍”中。还有另一个数据表“Watermark_books”，其中包含“Books”数据表所具有的所有属性，以及一个额外的属性，即每一行的水印。我必须计算水印，现在我必须将该水印属性嵌入“Watermark_books”数据表中。

请看看我写的代码。

```
int ky= 0;

double attrib = CalculateWatermarkAttribute(i, j, out ky);

DataRow dataRow = dataSet.Tables["Watermark_Books"].NewRow();

DataRow tmpRow = dataSet.Tables["Books"].Select("id=" + ky)[0];

dataRow.ItemArray = tmpRow.ItemArray; // this copies all columns of one row to new row

dataRow.ItemArray[7] = attrib; // this line of code is not working

dataSet.Tables["Watermark_Books"].Rows.Add(dataRow); 
```

谁能指出上面提到的代码行有什么问题......

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:49:52.440

试试下面的代码：

```
 int ky= 0;
        double attrib = CalculateWatermarkAttribute(i, j, out ky);
        DataRow dataRow = dataSet.Tables["Watermark_Books"].NewRow();
        DataRow tmpRow = dataSet.Tables["Books"].Select("id=" + ky)[0];

        foreach (System.Data.DataColumn column in dataSet.Tables["Watermark_Books"].Columns)
        {
            if (column.ColumnName == "WatermarkColumn")
                dataRow["WatermarkColumn"] = attrib;
            else
                dataRow[column.ColumnName] = tmpRow[column.ColumnName];
        } 
```

# android - 在 Android 中的活动之间传递数据（BIG JSON DATA STRING）

> ID：13646399
> 
> 赞同：1
> 
> 时间：2012-11-30T13:40:04.790
> 
> 标签：android, json, android-intent

如何在活动之间快速传递一个大的 json 字符串？

**a）我的活动一看起来像这样。**

```
JsonDataTask jdt = new JsonDataTask(c);

AsyncTask<String, Integer, String> rdataJSON = jdt.execute("https://job.jobnet.dk/FindJobService/V1/Gateway.ashx/annonce?fritekst=akutjob&sortering=match");

try {   
   Intent i = new Intent(c, JoblistActivity.class);
   i.putExtra("rdataJSON", rdataJSON.get());
   startActivity(i);
} catch (InterruptedException e1) {
   e1.printStackTrace();
} catch (ExecutionException e1) {
   e1.printStackTrace();
} 
```

**b) 然后是下面的活动二。**

```
Intent intent = getIntent();
JobPosting_json = intent.getStringExtra("rdataJSON"); 
```

问题是 'jdt.execute()' aka json-string 返回也必须数据.. 然后'getStringExtra("rdataJSON")' 不能保存 hule 字符串..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:43:37.457

您想将 Parcelable 类用于一个活动到另一个活动，请参阅[http://developer.android.com/reference/android/os/Parcelable.html](http://developer.android.com/reference/android/os/Parcelable.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:44:17.960

所以有两个解决方案：

*   或者您在第一个活动中缓存数据，然后在第二个活动中获取它
*   或者您在第二个活动中提出请求

我通常选择第二个选项，但这完全取决于您的要求。

# asp.net - 重新加载根 web.config 而不重新启动 IIS

> ID：13646400
> 
> 赞同：0
> 
> 时间：2012-11-30T13:40:06.530
> 
> 标签：asp.net, .net-4.0, iis-7.5, partial-trust

我的应用程序正在从运行 IIS6 的服务器移动到运行 IIS7.5 的服务器。

新服务器默认为中信任。由于这是一个共享服务器并且我正在使用一些第三方程序集，我不想要求在完全信任下运行我的应用程序。

我已经复制`web_mediumtrust.config`到`mycustom_mediumtrust.config`.

我已将第二行添加到根目录`web.config`，但新的`MyCustom`信任级别仍然不可用。

```
<trustLevel name="High" policyFile="web_hightrust.config" />
<trustLevel name="MyCustom" policyFile="mycustom_mediumtrust.config" />
<trustLevel name="Medium" policyFile="web_mediumtrust.config" /> 
```

`web.config` **有没有办法在不**重新启动 IIS 和所有其他应用程序的情况下强制重新加载根目录？

# c++ - 为什么将内存从 VRAM 复制到 RAM 比从 RAM 复制到 VRAM 慢？(OpenGL)

> ID：13646401
> 
> 赞同：4
> 
> 时间：2012-11-30T13:40:12.367
> 
> 标签：c++, opengl, gpgpu

我正在创建类似于 CUDA 的东西，但我看到将内存从 RAM 复制到 VRAM 非常快，就像从 RAM 复制到自身一样快。但是从 VRAM 复制到 RAM 比从 RAM 到 VRAM 慢。

顺便说一句，我`glTexSubImage2D`用来从 RAM 复制到 VRAM 以及`glGetTexImage`从 VRAM 复制到 RAM。

为什么？有没有办法提高它的性能，比如将 RAM 复制到 VRAM？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T13:52:37.953

将数据从 GPU 传输到 CPU 始终是一个非常缓慢的操作。

> [GPU -> CPU](http://www.opengl.org/discussion_boards/showthread.php/168710-Why-is-GPU-CPU-transfer-slow)回读引入了一个“同步点”，CPU 必须等待 GPU 完成其计算。在此期间，CPU 停止向 GPU 提供数据，导致其停止。
> 
> 现在，请记住，现代 GPU 是以高度并行的方式设计的，在任何给定时刻都有数千个线程在运行。同步点必须等待所有这些线程完成处理，然后才能回读它们的计算结果。回读完成后，所有这些线程必须从零开始重新执行……糟糕！
> 
> 异步读回结果（几帧后），允许 GPU 继续执行而不会导致其线程饥饿（上面概述的停止和恢复问题）。这极大地提高了性能 - GPU 的并行度越高，性能提升就越高。

根据您的图形芯片和驱动程序，使用[PBO](http://www.songho.ca/opengl/gl_pbo.html)可能会获得更好的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T15:12:37.320

> 顺便说一句，我使用 glTexSubImage2D 从 RAM 复制到 VRAM 和 glGetTexImage 从 VRAM 复制到 RAM。

那么你不是在*复制*数据。您正在执行[像素传输操作](http://www.opengl.org/wiki/Pixel_Transfer)，这可能需要 CPU 修改，具体取决于[图像的内部格式](http://www.opengl.org/wiki/Image_Format)、像素传输格式和像素传输类型参数。

由于您没有提供实际代码，因此无法知道您是否选择了错误的参数。

如果要测试直接*复制*性能，请使用[缓冲区对象](http://www.opengl.org/wiki/Buffer_Object)。

# grails - 无法运行 Grails 应用程序？

> ID：13646407
> 
> 赞同：5
> 
> 时间：2012-11-30T13:40:46.600
> 
> 标签：grails

当我尝试运行我的 grails 应用程序时，出现以下错误：

```
Error 2012-11-30 15:35:57,948 [localhost-startStop-1] ERROR context.ContextLoader  - Context initialization failed
Message: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsServiceClass
   Line | Method
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsServiceClass
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by InvocationTargetException: null
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by NoClassDefFoundError: com/lp/labs/scconnector/GitConnector
->> 2427 | privateGetDeclaredMethods in java.lang.Class
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   1791 | getDeclaredMethods in     ''
|   303 | innerRun in java.util.concurrent.FutureTask$Sync
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by ClassNotFoundException: com.lp.labs.scconnector.GitConnector
->> 202 | run      in java.net.URLClassLoader$1
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   190 | findClass in java.net.URLClassLoader
|   306 | loadClass in java.lang.ClassLoader
|   247 | loadClass in     ''
|   2427 | privateGetDeclaredMethods in java.lang.Class
|   1791 | getDeclaredMethods in     ''
|   303 | innerRun in java.util.concurrent.FutureTask$Sync
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
| Error 2012-11-30 15:35:58,068 [localhost-startStop-1] ERROR context.GrailsContextLoader  - Error executing bootstraps: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsServiceClass
Message: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsServiceClass
   Line | Method
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsServiceClass
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by InvocationTargetException: null
->> 303 | innerRun in java.util.concurrent.FutureTask$Sync
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by NoClassDefFoundError: com/lp/labs/scconnector/GitConnector
->> 2427 | privateGetDeclaredMethods in java.lang.Class
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   1791 | getDeclaredMethods in     ''
|   303 | innerRun in java.util.concurrent.FutureTask$Sync
|   138 | run      in java.util.concurrent.FutureTask
|   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
|   908 | run      in     ''
^   680 | run . .  in java.lang.Thread
Caused by ClassNotFoundException: com.lp.labs.scconnector.GitConnector
    ->> 202 | run      in java.net.URLClassLoader$1
    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    |   190 | findClass in java.net.URLClassLoader
    |   306 | loadClass in java.lang.ClassLoader
    |   247 | loadClass in     ''
    |   2427 | privateGetDeclaredMethods in java.lang.Class
    |   1791 | getDeclaredMethods in     ''
    |   303 | innerRun in java.util.concurrent.FutureTask$Sync
    |   138 | run      in java.util.concurrent.FutureTask
    |   886 | runTask  in java.util.concurrent.ThreadPoolExecutor$Worker
    |   908 | run      in     ''

^   680 | run . .  in java.lang.Thread 
```

这是我的 build.config 文件：

```
grails.servlet.version = "2.5" // Change depending on target container compliance (2.5 or 3.0)
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
grails.project.target.level = 1.6
grails.project.source.level = 1.6
//grails.project.war.file = "target/${appName}-${appVersion}.war"

grails.project.dependency.resolution = {
    // inherit Grails' default dependencies
    inherits("global") {
        // specify dependency exclusions here; for example, uncomment this to disable ehcache:
        // excludes 'ehcache'
    }
    log "warn" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
    checksums true // Whether to verify checksums on resolve

    repositories {
        inherits true // Whether to inherit repository definitions from plugins

        grailsPlugins()
        grailsHome()
        grailsCentral()

        mavenLocal()
        mavenCentral()

        // uncomment these (or add new ones) to enable remote dependency resolution from public Maven repositories
        //mavenRepo "http://snapshots.repository.codehaus.org"
        //mavenRepo "http://repository.codehaus.org"
        //mavenRepo "http://download.java.net/maven/2/"
        //mavenRepo "http://repository.jboss.com/maven2/"
    }
    dependencies {
        // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

        // runtime 'mysql:mysql-connector-java:5.1.20'
        compile 'org.eclipse.jgit:org.eclipse.jgit:2.0.0.201206130900-r'
        compile 'SC-Connector:SC-Connector:1.0'
        compile 'AccountConnector:AccountConnector:1.0'

        // runtime
        runtime 'org.springframework.ws:spring-xml:2.0.4.RELEASE'
        runtime 'org.springframework.ws:spring-ws-core:2.0.4.RELEASE'
        runtime 'com.thoughtworks.xstream:xstream:1.4.2'
        runtime 'org.springframework.ws:spring-oxm:3.1.0.RELEASE'
        runtime 'org.springframework.ws:spring-oxm-tiger:1.5.10'
        runtime 'com.sun.xml.bind:jaxb-impl:2.1.12'
        runtime 'javax.xml.bind:jaxb-api:2.1'
        runtime 'com.google.guava:guava:13.0.1'
        runtime 'xmlpull:xmlpull:1.1.3.1'

    }

    plugins {
        runtime ":hibernate:$grailsVersion"
        runtime ":jquery:1.7.2"
        runtime ":resources:1.1.6"

        build ":tomcat:$grailsVersion"

        runtime ":database-migration:1.1"

        compile ':cache:1.0.0'
    }
} 
```

我认为这些课程在我的课程路径上，所以我认为这不是课程路径问题。有人知道如何解决吗？

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-30T18:02:27.217

是`com.lp.labs.scconnector.GitConnector`在lib目录下的jar文件中吗？如果是这样，运行`grails compile --refresh-dependencies`让 Grails 将其添加到类路径中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T15:20:39.890

也许您的问题可能源于其他原因，我遇到了同样的错误，在到处咨询后，我建议制作一个 Grails-CLEAN 并且一切都解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-20T13:04:20.523

使用命令

```
grails clean-all 
```

之后使用：

```
grails refresh-dependencies
grails-compile 
```

比运行

```
grails run-app 
```

# android - Google Nexus 7 无法通过 USB 识别

> ID：13646412
> 
> 赞同：1
> 
> 时间：2012-11-30T13:41:10.153
> 
> 标签：android, adb, nexus-7

请帮我。我正在尝试将我的 Google Nexus 7 连接到我的 PC 以进行 Android 开发。

我试过用不同的电缆连接到我的电脑。当我将设备连接到我的 Windows 7 PC 时，我没有在 Android 或我的 PC 上收到任何设备已连接的通知。在“其他设备”中，我的电脑显示`Unknown device`. 我尝试使用**MTP**和**PTP**，以及禁用和启用 USB 调试。我使用过**Nexus Root Toolkit**、**Universal Naked Driver**、**Nexus 7 toolkit**，并且我尝试过本教程和许多其他**http://www.youtube.com/watch?v=IjWjCQXlWDc**并没有任何帮助。

我不明白为什么Android上没有任何通知。会不会是硬件问题？我怎样才能检查它？

请帮助我，因为我还没有找到任何方法来解决它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:38:23.580

您可能需要为 Nexus 7 安装 ADB 驱动程序。查看此[SO](https://stackoverflow.com/questions/3731871/adb-driver-for-htc-incredible)解决方案。

这是所有[Android ADB 驱动程序](http://developer.android.com/tools/extras/oem-usb.html)的链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T18:41:50.147

您还需要确保在 Nexus7 上启用了“USB 调试”设置。您可以使用 SDK 管理器下载 USB 驱动程序（与下载不同 SDK 和工具的方式相同）。

# sql - 使用不同参数循环查询

> ID：13646417
> 
> 赞同：0
> 
> 时间：2012-11-30T13:41:17.513
> 
> 标签：sql, sql-server, tsql

我需要执行 6 次查询，但每次使用不同的参数，有什么方法可以以某种形式的循环执行它。还是我必须单独执行 6 次？我试着在网上搜索答案，但我找不到任何相关的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:20:54.783

```
declare @idx int = 0

declare @parameter1 varchar(10) = 'foo'
declare @parameter2 varchar(10) = 'bar'
declare @parameter3 varchar(10) = 'sql'
declare @parameter4 varchar(10) = 'star'
declare @parameter5 varchar(10) = 'maa'
declare @parameter6 varchar(10) = 'baa'

while (@idx < 6)
begin
    --example query using parameter based on loop counter
    select case 
        when @idx = 0 then @parameter1
        when @idx = 1 then @parameter2
        when @idx = 2 then @parameter3
        when @idx = 3 then @parameter4
        when @idx = 4 then @parameter5
        when @idx = 5 then @parameter6
    end
    set @idx = @idx + 1
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:49:54.257

在循环中执行 6 次查询***是***分别执行 6 次。每次循环都是一个单独的执行。而且，每次通过循环，您都可以提供不同的参数。

T-SQL 有一个 While 语句，它允许您执行查询或任何代码，根据需要多次，并且每次通过循环，您可以提供不同的参数值。

# facebook - Facebook 要求对测试用户进行帐户验证

> ID：13646418
> 
> 赞同：3
> 
> 时间：2012-11-30T13:41:19.337
> 
> 标签：facebook, roles, facebook-test-users

正如文档中所说，“请注意，无需验证用户即可将其作为测试人员添加到应用程序中。”

我在我的沙盒应用程序中赋予测试者角色的所有用户，没有经过验证帐户的用户都会看到一条消息，上面写着“注册为开发人员以接受您待处理的开发人员请求”。如果他们单击该链接，则会要求他们验证他们的帐户。

这怎么可能？

# java - 杰克逊反序列化具有未知属性名称的泛型

> ID：13646423
> 
> 赞同：1
> 
> 时间：2012-11-30T13:41:27.920
> 
> 标签：java, android, json, jackson

我有以下`JSON`。我正在使用 `Jackson`Parser解析它

```
 {
  "code": 0,
  "response": {
    "pagination": {
        "page": 1,
        "limit": 20,
        "count": 5,
        "pageCount": 1
    },
   "random": [
      ....
     ]
  }
} 
```

现在我 `POJO` 为各种`random`对象创建了简单的类。我预计有 3-4 种不同类型的 `random` 对象。因此，我没有为不同类型的“随机”对象创建不同的包装类，而是创建了一个通用的

**编辑类：**

```
public class PaginatedResponse<E> {

   private Pagination pagination;
   private List<E> responseList;

   public Pagination getPagination() {
       return pagination;
   }

   public void setPagination(Pagination pagination) {
       this.pagination = pagination;
   }

   public List<E> getResponseList() {
       return responseList;
   }

   public void setResponseList(List<E> responseList) {
       this.responseList = responseList;
   }
} 
```

现在为了映射它我使用，

```
 JsonNode tree = mapper.readTree(response);
  TypeReference<PaginatedResponse<LocationParent>> ref = new TypeReference<PaginatedResponse<LocationParent>>() {   };
  PaginatedResponse<LocationParent> resp = mapper.convertValue(tree.get("response"), ref); 
```

但我无法映射`responseList`。我得到了 `pagination` 对象，但`responseList`始终为空。现在如何动态`property name`提供`responseList`.

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T00:12:18.280

变量值类型需要的是处理多态类型。单独的泛型类型无济于事，因为反序列化方不知道要使用什么类型。

您可以使用注释启用多态类型处理`@JsonTypeInfo`；但是在这种特殊情况下的一个问题是你想要一个`List`任意类型的东西——由于类型擦除，所有的 Java 列表实际上都是`List<Object>`; 没有元素的类型。

如果是我，我可能会子类`PaginatedResponse`并添加`@JsonTypeInfo`基类，例如：

```
@JsonTypeInfo(...) // see javadocs for properties needed
public abstract class PaginatedResponse<T> {
  public Pagination pagination;
  // .. and so on
}

public class PaginatedFooResponse<Foo> { } 
```

在这里使用子类化的原因仅仅是让反序列化器能够确定元素类型，给定响应对象的类型。响应对象将具有类型 ( `PaginatedFooResposne`)，并且从该类型的元素中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:47:02.493

试试这个：：

```
JSONObject objJSON = JSONObject.fromString("urString");

String code = objJSON.get("code"); 
```

# php - 无法在 Windows 资源管理器中打开由 PHP Zip 存档生成的 zip 文件

> ID：13646426
> 
> 赞同：2
> 
> 时间：2012-11-30T13:41:44.457
> 
> 标签：php, windows, zip, ziparchive

当我尝试打开由 PHP Zip Archive 生成​​的 zip 文件时，会显示一条警报

> “Windows 无法打开文件夹。压缩（压缩）文件夹‘文件名’无效。” 在 Windows 资源管理器中打开错误。

但我可以通过 7-zip 打开文件。出于某种原因，我必须确保 zip 文件可以通过 Windows 资源管理器打开。生成 zip 文件时有什么问题吗？请帮忙！

```
function create_a_zip($files = array(),$dest = '',$root_folder,$overwrite = false) {
        if(file_exists($dest) && !$overwrite) {
            return false;
        }
        $valid_files = array();
        if(is_array($files)) {
            foreach($files as $file) {
                if(file_exists($file)) {
                    $valid_files[] = $file;
                }
            }
        }

        if(count($valid_files)) {
            $zip = new ZipArchive();
            if($zip->open($dest,$overwrite ? ZIPARCHIVE::OVERWRITE : ZIPARCHIVE::CREATE) !== true) {
                return false;
            }
            foreach($valid_files as $valid_file) {
                if(is_dir($valid_file) === true){
                    foreach(glob($valid_file . '/*') as $file){
                        $zip->addFile($file, $root_folder . $file);
                    }

                }else if (is_file($valid_file) === true){
                    $zip->addFile($valid_file, $root_folder . $valid_file);
                }
            }
            $zip->close();

            return file_exists($dest);
        }
        else
        {
            return false;
        }
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-08-22T02:28:31.447

对我来说，解决方案是`ob_end_clean()`在输出 zip 文件内容之前使用（正如@Ywis 在评论中指出的那样）......

```
ob_end_clean();
readfile($zipfilename); // outputs zip file's content 
```

...即使您在此之前不输出任何字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:44:57.130

我认为问题源于：

```
$zip->addFile($file,$file); 
```

除非您的 php 脚本与要添加到 zip 的文件位于同一目录中，否则您将需要包含文件路径。addFile 中的第二个参数是 zip 中文件的名称，因此如果您的 $file var 包含路径，则问题可能来自于此。尝试将代码更改为：

```
$filenameonly = preg_replace("/(.*)\/?([^\/]+)/","$2",$file);
$zip->addFile($file,$filenameonly ); 
```

这将去掉文件路径（如果有的话），只留下 addFile 中第二个变量的文件名。

如果这能解决您的问题，您将确定问题出在您的文件名中，并且可以轻松查明问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-09T16:13:41.793

例如，只需作为参数发送到绝对路径`$abspath`。然后用在

```
$filenameonly = str_replace($abspath,"",$file);
$zip->addFile($file, $filenameonly); 
```

即使在 Window 8 中它也可以 100% 工作，甚至您压缩的文件也在文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-03T05:29:23.547

您可以使用内置文件系统函数，而不是使用 str_replace 字符串函数。

```
$zip->addFile(realpath($file), pathinfo($file, PATHINFO_BASENAME)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-13T14:04:44.287

Windows zip 无法识别以“/”开头的路径

只需删除文件路径中的第一个“/”。

像这样：

```
if ( substr($root_folder,0,1) == '/' ) {
    $root_folder = substr($root_folder,1);
}
$zip->addFile($file, $root_folder . $file); 
```

# spring-mvc - 使控制器方法与 Spring 3.2.RC2 异步的问题

> ID：13646428
> 
> 赞同：2
> 
> 时间：2012-11-30T13:41:46.423
> 
> 标签：spring-mvc, asynchronous, controller

我正在尝试测试**Spring MVC 控制器的最新异步功能，**但我无法让它工作。

这是我的异步方法的代码：

```
@RequestMapping(value = "/hello")
    public Callable<String> async(final Model model) {
        System.out.println("entered async controller method");
        return new Callable<String>() {
            public String call() throws Exception {
                Thread.sleep(2000L);
                model.addAttribute("message", "asyncRequest dealt with");
                System.out.println("about to return from call()");
                return "hello";
            }
        };
} 
```

以下是 web.xml 中的相关部分：

```
<servlet>
    <servlet-name>SpringMVC</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/webmvc-config.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
    <async-supported>true</async-supported>
</servlet> 
```

但是，控制台中永远不会打印**“即将从 call() 返回”**，我也永远不会看到这样的日志： 08:25: **17 [MvcAsync1] WebAsyncManager** - ...在控制台中......

仅供参考，我使用 Spring 3.2.RC2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-07-27T02:14:52.413

为了进一步配置`async-support`工具`AsyncTaskExecutor`

> 默认情况下，Spring MVC 使用 a`SimpleAsyncTaskExecutor`来执行控制器方法返回的 Callable 实例。对于生产，您必须将其替换`AsyncTaskExecutor`为为您的环境适当配置的实现。

创建 AsyncTaskExecutor

```
<beans:bean id="asyncTaskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor">
    <beans:property name="corePoolSize" value="5" />
    <beans:property name="maxPoolSize" value="10" />
    <beans:property name="queueCapacity" value="25" />
</beans:bean> 
```

然后分配`task-executor`

```
<mvc:annotation-driven >
    <mvc:async-support default-timeout="30000" task-executor="asyncTaskExecutor" />
</mvc:annotation-driven> 
```

[http://blog.springsource.org/2012/05/10/spring-mvc-3-2-preview-making-a-controller-method-asynchronous/](http://blog.springsource.org/2012/05/10/spring-mvc-3-2-preview-making-a-controller-method-asynchronous/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T20:02:32.867

我终于找到了我的示例不起作用的原因：必须将以下内容添加到 web-mvc 配置文件中：

```
<mvc:annotation-driven>
    <mvc:async-support default-timeout="3000"/>
</mvc:annotation-driven> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-28T08:49:38.293

嗨，使用以下代码执行类似的应用程序：

```
public String doSlowWork() {

     System.out.println("Start  slow work");
    try {
      Thread.sleep(3000);
    } catch (InterruptedException e) {
      e.printStackTrace();
    }
    System.out.println("finish slow work");

    return "index";       // return view's name
  } 
```

返回索引但不给出方法的日志信息

# windows-8 - WinJS Listview 快速导航时显示未定义

> ID：13646431
> 
> 赞同：0
> 
> 时间：2012-11-30T13:41:52.747
> 
> 标签：windows-8, windows-runtime, winjs

我有一个带有列表视图的 WinJS 应用程序，如果在列表视图完全加载之前在页面之间快速导航，则下一页显示列表视图，其中所有元素绑定为“未定义”。

假设我有一个带有“待办事项”的中心页面，该页面被过滤为仅显示 6 个项目，并且有一个标题导航到完整的“待办事项”页面，当显示中心页面但在它完全加载之前我单击“待办事项”页面的标题链接，然后应用程序转到“待办事项”页面，但项目显示在磁贴中的所有属性为“未定义”。

我使用 IndexedDB 作为我的数据存储。

我的主页代码如下所示：

```
WinJS.UI.Pages.define("/pages/home/home.html", {
    ready: function (element, options) {
        WinJS.Utilities.query("a").listen("click", function (e) {
            e.preventDefault();
            WinJS.Navigation.navigate(e.currentTarget.href);
        }, false); 

        viewModel = new HomeViewModel(element);
        viewModel.load(); //loads from indexed db

    },
    //etc... 
```

待办事项页面：

```
 WinJS.UI.Pages.define("/pages/ToDo/ToDo.html", {
        ready: function (element, options) {    
            viewModel = new ToDoViewModel(element);

            viewModel.load();
        },
etc// 
```

我知道没有什么可做的，但任何想法都会受到赞赏。

还有关于如何调试这样的东西的提示也会很棒。

## 更新

我从中心页面将其缩小到这一行：

```
myLib.GetData(todaysDate, function (result) {
  that.trendsModel.today = result;
  WinJS.Binding.processAll(that.el.querySelector("#dataPanel"), that.trendsModel); //<--Right Here
}); 
```

如果我删除它，那么当我加载第二页时，数据不会显示为未定义。有趣的是数据最初在第二页上正确显示，然后变为“未定义”。

## 解决方案

我的修复：

```
myLib.GetData(todaysDate, function (result) {
  var element = that.el.querySelector("#dataPanel");

  that.trendsModel.today = result;

  if(element) {
    WinJS.Binding.processAll(element, that.trendsModel); 
  }
}); 
```

当回调返回时，我已经在第二页了。所以没有找到选择器返回null。如果您将 null 传递给 processAll，它会尝试绑定整个页面，这就是为什么我能够在一秒钟内看到正确的数据，然后它会变为未定义......哇，真是太棒了。我想这是有道理的，但很难找到。

希望它在未来对某人有所帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:32:29.990

您的 ToDoViewModel 和 HomeViewModel 需要是*observable*。这意味着它们需要混合 from `WinJS.Binding.mixin`，并且对于您异步拉入的属性，它们需要`this.notify("propertyName", newVal, oldVal)`从属性设置器中调用。

请注意，您需要具有 getter/setter 属性。例如

```
var bindingBase = WinJS.Class.mix(function() {}, WinJS.Binding.mixin);
WinJS.Namespace.define("YourNamespace", {
    ToDoViewModel: WinJS.Class.derive(bindingBase, function constructor() {
    }, {
        _titleStorage: "",
        title: {
            get: function() { return this._titleStorage; },
            set: function(newValue) {
                if(newValue === this._titleStorage) {
                    return;
                }

                var old = this._titleStorage;
                this._titleStorage = newValue;
                this.notify("title", newValue, old);
             }
        }
    }),
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T17:20:29.067

```
myLib.GetData(todaysDate, function (result) {
  var element = that.el.querySelector("#dataPanel");

  that.trendsModel.today = result;

  if(element) {
    WinJS.Binding.processAll(element, that.trendsModel); 
  }
}); 
```

当回调返回时，我已经在第二页了。所以没有找到选择器返回null。如果您将 null 传递给 processAll，它会尝试绑定整个页面，这就是为什么我能够在一秒钟内看到正确的数据，然后它会更改为未定义......哇，真是太棒了。我想这是有道理的，但很难找到。

# jquery - 计算进度

> ID：13646432
> 
> 赞同：2
> 
> 时间：2012-11-30T13:41:54.207
> 
> 标签：jquery

我正在尝试用 jQuery 编写一个基本的进度条。我得到了所有以百分比显示进度的部分，只需要调试我的数学。

因此，如果我从 130 个问题开始，则每次回答问题时，我都需要重新计算并显示进度。

所以这就是我所做的

```
var questID // is current question ID, from 1 to 130

var startCount = 130;
var currentCount = startCount - questID;
var progress = Math.floor(currentCount / startCount * 100);
$("#progressBar").width(progress); 
```

我想我得到了一些倒退，因为当我测试时，我在第一个问题后得到了 99%……可能需要更多的咖啡因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:43:50.310

你的`currentCount`逻辑是错误的。如果您已回答 1 个问题，则：

```
var currentCount = 130 - 1 = 129. 
```

然后`129/130`会给你99%。你只需要`1/130`. 因此，您可以使用`questID`：

```
var questID // is current question ID, from 1 to 130

var startCount = 130;
var progress = Math.floor(questID / startCount * 100);
$("#progressBar").width(progress); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T13:44:13.973

是的，你把它弄反了。questID*是*您尝试计算的 currentCount。无需从 startCount 中减去它。

```
var questID // is current question ID, from 1 to 130

var startCount = 130;
var progress = Math.floor(questID/ startCount * 100);
$("#progressBar").width(progress); 
```

是时候喝杯咖啡了。

# pdf - 如何使用 iTextSharp 访问具有相同名称的多个复选框

> ID：13646433
> 
> 赞同：1
> 
> 时间：2012-11-30T13:41:55.987
> 
> 标签：pdf, itextsharp

我有一个包含多个同名复选框的 pdf。这使我可以要求您检查一个或多个复选框，但是我找不到任何方法来解决代码中的各个复选框。我知道有一个 radiogroup 对象，但我没有找到任何如何使用它的示例，也不知道它是否适用于我的情况。我能做的最好的事情就是设置第一个复选框。（是的，它们都具有独特的导出值）

我尝试解决单个框的一些方法没有运气：（字段名称是“位置”）

```
location#0
location[0]
location = "value1, value2" 
```

任何帮助将不胜感激！

# android - 对于nexus 7，图像尺寸太大？

> ID：13646435
> 
> 赞同：4
> 
> 时间：2012-11-30T13:42:01.633
> 
> 标签：android, image, background

我有一个`1092 x 1596` `2.23mb png`我想设置为我活动的背景。当我使用 Galaxy s 和 Galaxy Tab 2 10.1 测试它时它可以工作，但是当我使用 nexus 7 测试它时，我收到一个错误：

```
11-30 08:37:36.961: W/OpenGLRenderer(25918): Bitmap too large to be uploaded into a texture (1454x2125, max=2048x2048) 
```

有人有什么建议吗？我不应该使用这么大的图像作为背景吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T15:06:04.153

`res/drawable`由于您将图像放在文件夹中的位置，因此可能正在为 nexus 7 设备放大图像。

尝试将图像移动到`res/drawable-xhdpi`文件夹并重试，这应该将图像缩小一点而不是放大到 Nexus 7 显示器（Nexus 7 显示器是**tvdpi**，而我相​​信您使用的两个银河设备是**mdpi**，所以图像可能如果您已经将其放置在 mdpi 文件夹中，则不会对其进行放大。）。

除此之外，[@Qw4z1](https://stackoverflow.com/users/1166813/qw4z1)所说的使用太大的图像是完全正确的。尝试为每个可绘制密度文件夹创建不同大小的资源，然后从那里开始，效率更高，并且也会导致更小的 .apk 文件大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T14:22:56.103

嗯..那个错误代码不是说你的图像是1454x2125吗？2125 > 2048 阿法克。

但是，要回答您的问题，是的，这是一个坏主意。有些设备无法处理太大的图像。

检查[此 SO question](https://stackoverflow.com/questions/12823020/is-there-a-bitmapfactory-resolution-to-fix-bitmap-too-large-to-be-uploaded-into)以获取有关该主题的更多详细信息。

# xml - 使用 xpath/xslt 的 Xades 签名

> ID：13646437
> 
> 赞同：1
> 
> 时间：2012-11-30T13:42:07.063
> 
> 标签：xml, xslt, xpath, xades4j

如果可能的话，有人可以向我发布使用 xpath 或 xslt 转换的 xades4j 签名示例吗？

例如：如果我有这个文件：

```
<a>
  <b>text</b>
  <c>zzz</c>
  <b>yyy</b>
</a> 
```

*我想要一个只签名b*元素的 xades 签名，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T23:03:30.557

有关转换[的文档](http://code.google.com/p/xades4j/wiki/DefiningSignedResources#Transforms)中有一节。

此外，还有一个[包含算法定义的包](http://xades4j.googlecode.com/svn/release/1.3.0/javadoc/reference/xades4j/algorithms/package-summary.html)，包括[XPath 转换](http://xades4j.googlecode.com/svn/release/1.3.0/javadoc/reference/xades4j/algorithms/XPathTransform.html)，您可以在定义签名数据对象时使用它。

在您的示例中，您可能希望 a`DataObjectReference`带有一个空 URI（整个文档），然后`XPathTransform`带有一个像 /a/b 这样的表达式。

# uml - UML - 在并发状态图中显示依赖关系

> ID：13646440
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:10.080
> 
> 标签：uml, state-diagram

我正在建模一个用户界面，其中有一个 3 x 3 网格。网格中的每个正方形都是一个状态 [ **edit:** ]，除了 (left, top) 和 (middle, top) 正方形，它们一起是单个状态 [ **/edit** ]，初始状态是中心（鼠标光标“开始”）。当鼠标光标越过边界进入新状态时，将触发该状态的事件。

我正在考虑单独对轴进行建模，因此会有一个 X 状态和一个 Y 状态；但是，如何将 X 状态和 Y 状态映射回网格的 9 个方形状态之一（即在状态图中）？换句话说，我如何证明实际的最终状态取决于 X 状态和 Y 状态（是它们的组合）？我有更好的方法吗？

请指教。

```
___________________
|           |     |
|     1     |  2  |
|___________|_____|
|     |     |     |
|  3  |  4  |  5  |
|_____|_____|_____|
|     |     |     |
|  6  |  7  |  8  |
|_____|_____|_____| 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:48:13.573

听起来您的实际状态不是`X`或`Y`只是一个 tuple `{X,Y}`。我建议你基于这样的元组而不是`X`and来创建你的状态图`Y`。每个状态都可以有一个内部划分为`X`和`Y`。如果需要，这些可以是对应于元组的内部状态图的状态。

# matlab - 生成可能角度的矩阵

> ID：13646442
> 
> 赞同：2
> 
> 时间：2012-11-30T13:42:19.063
> 
> 标签：matlab, matrix, octave, intervals

我需要生成属于 3 个区间的所有可能角度（以弧度表示的 theta）的矩阵 [1xn]：[0, pi/6], [pi/4, pi/2] 和 [pi, -3*pi/ 4]。有一刻，我有一个想法，如何使用生成 3 个不同的矩阵

```
theta1 = 0:0.1:pi/6;
theta2 = pi/4:0.1:pi/2;
theta3 = pi:0.1:(-3*pi/2); 
```

然后加入他们......还有其他更优化的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:53:52.553

就是这么简单：`[theta1 theta2 theta3]`

如果你只想在一行中做，你当然可以做

```
[0:0.1:pi/6 pi/4:0.1:pi/2 -pi:-0.1:(-3*pi/2)] 
```

如果您的问题是如何以更“优雅”的方式制作它，我认为没有，因为您的间隔没有恒定的长度。

# php - PHP / MySql / 变量循环？

> ID：13646443
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:19.637
> 
> 标签：php, mysql, pdo

我有以下代码使用从 A 到 B 的邮政编码的前 5 个字符检查“固定票价”。

所以如果`LE675FE`是输入，`$full_post_code_a = LE675F;`

基本上我想做的是一个循环，它将使用前 4 个和 3 个字符检查数据库，所以`$full_post_code_a = LE675F / LE675 and LE67`

只是想知道怎么可能做到这一点？

```
private static function checkFixedFarePC($post_codes) {

    self::$arr_postcodes = explode(",", $post_codes);

    // Get full postcode of Pickup

    $full_post_code_a = (self::$arr_postcodes[0]);

    // Get full postcode of Destination

    $full_post_code_b = (self::$arr_postcodes[1]);

    // Get first 5 characters of pickup & destination postcode

    $post_code_a = substr($full_post_code_a,0 ,5);

    $post_code_b = substr($full_post_code_b,0 ,5);

    // Pass postcodes to check if a fixed fare is possible

    return self::getFixedFare($post_code_a, $post_code_b);

} 
```

哪个被发送到以下功能：

```
private static function getFixedFare($post_code_a, $post_code_b) {

$pdo = new SQL();
$dbh = $pdo->connect(Database::$serverIP, Database::$serverPort, Database::$dbName, Database::$user, Database::$pass);

try {

    $query =   "SELECT VehicleSystemId, Fare FROM tblfixedfares
                WHERE ShortPostCodeA = '$post_code_a'
                AND ShortPostCodeB = '$post_code_b'
                AND DayHalf = :day_half
                AND VehicleSystemId IN ('Car', '6B')";

    $stmt = $dbh->prepare($query);

    $stmt->bindParam(':day_half', self::$day_half, PDO::PARAM_STR);

    $stmt->execute();

    $result = $stmt->fetchAll(PDO::FETCH_ASSOC|PDO::FETCH_GROUP);

    $stmt->closeCursor();

    $dbh = null;

    return $result;

}

catch (PDOException $pe) {
    die("Error: " .$pe->getMessage(). " Query: ".$stmt->queryString);
} 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:56:15.163

我只是想，我可以这样做：

```
$post_code_c = substr($full_post_code_a,0 ,4);
$post_code_d = substr($full_post_code_a,0 ,3); 
```

然后将这些传递给查询：`return self::getFixedFare($post_code_a, $post_code_b, $post_code_c);`

然后将查询更改为：

`WHERE ShortPostCodeA = '$post_code_a' OR ShortPostCodeA = '$post_code_c' OR ShortPostCodeA = '$post_code_d`

虽然可能有更好的方法来做到这一点......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:23:39.117

```
 WHERE 
 ShortPostCodeA IN 
 ('{$post_code_a}','{$post_code_b}') 
```

# sql-server - '>' 附近的语法不正确。在案例陈述中-无法弄清楚原因。有什么我想念的吗？SQL Server 2008

> ID：13646444
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:29.250
> 
> 标签：sql-server, sql-server-2008, syntax-error

```
SELECT field1, field2,
        Budget = CASE field2
         WHEN field2> 20.00 THEN 'Expensive'
          WHEN field2 BETWEEN 10.00 AND 19.99 THEN 'Moderate'
          WHEN field2< 10.00 THEN 'Inexpensive'
          ELSE 'Unknown'
        END
FROM table1 
```

该表存在。字段存在。但是这些都用红色下划线：< BETWEEN AND

有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:44:14.317

删除“CASE”之后的第一个“field2”

```
SELECT field1, field2,
        Budget = CASE
         WHEN field2 > 20.00 THEN 'Expensive'
          WHEN field2 BETWEEN 10.00 AND 19.99 THEN 'Moderate'
          WHEN field2 < 10.00 THEN 'Inexpensive'
          ELSE 'Unknown'
        END
FROM table1 
```

编辑：如果你的情况是不变的，你可以使用不同的语法。

```
SELECT field1, field2,
        Budget = CASE field2
         WHEN 20 THEN 'Expensive'
          WHEN 15 THEN 'Moderate'
          WHEN 10 THEN 'Inexpensive'
          ELSE 'Unknown'
        END
FROM table1 
```

这显然对整数更有效。

# javascript - JavaScript Date.toJSON() 产生的日期有错误的小时和分钟

> ID：13646446
> 
> 赞同：9
> 
> 时间：2012-11-30T13:42:33.147
> 
> 标签：javascript

我想将日期打印到`ISO-8601`标准：`YYYY-MM-DDTHH:mm:ss.sssZ`所以我使用了以下代码行，但我得到了意外的输出

```
var date = new Date(2012, 10, 30, 6, 51);
print('UTC Format: '+date.toGMTString());
print('toString() method: '+date.toString());
print('toJSON() method: '+date.toJSON());//print hours and minutes incorrectly
print('to UTCString() method: ' + date.toUTCString()); 
```

对应的输出是

```
UTC Format: Fri, 30 Nov 2012 01:21:00 GMT
toString() method: Fri Nov 30 2012 06:51:00 GMT+0530 (India Standard Time)
toJSON() method: 2012-11-30T01:21:00.000Z
to UTCString() method: Fri, 30 Nov 2012 01:21:00 GMT 
```

toJSON() 方法错误地打印小时和分钟，但 toString() 正确打印它，我想知道这是什么原因。我是否必须向 Date 对象添加时间偏移量，如果是，那么如何？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-08-29T17:06:50.270

```
var date = new Date();
console.log(date.toJSON(), new Date(date.getTime() - (date.getTimezoneOffset() * 60000)).toJSON()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-30T13:50:35.530

`date.toJSON()`将 UTC-Date 打印为格式为 json-date 的字符串。

如果要打印本地时间，则必须使用[getTimezoneOffset()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)，它以分钟为单位返回偏移量。您必须将此值转换为秒并将其添加到日期的时间戳中：

```
var date = new Date(2012, 10, 30, 6, 51);
new Date(date.getTime() - (date.getTimezoneOffset() * 60000)).toJSON() 
```

在此答案的先前版本中，偏移量被错误地添加而不是减去。

# css - 使用 % 定位的水平菜单

> ID：13646450
> 
> 赞同：1
> 
> 时间：2012-11-30T13:42:37.983
> 
> 标签：css, html, responsive-design

我正在制作一个带有`with:100%;`和的 div 菜单`height:45px;`

菜单中的每个元素都是 div。我的目标是让它适应任何屏幕分辨率，所以我首先将第一个 div 与 a`margin-left:2%;`但对于下一个我不确定我必须使用什么。

我可以制作第一个元素`float:left;`并使用边距，`margin-left:10%;`但是如果我们更改屏幕分辨率，它就不再好用了。如果我不放任何东西，它会在第一个按钮下。如果我使用`margin-left`in px 它不会很好，因为第一个`margin-left:2%;`我怎样才能做到这一点？

这就是我目前拥有的（您可以看到按钮位于第一个下方）： ![在此处输入图像描述](../Images/7d2f4050c875e0d5a128e111e5f6d1b0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:00:22.163

你为什么不使用 display:inline-block; 以及对您来说有利的利润是多少？这意味着，第一个元素可以有 2%，第二个元素也可以：

```
<div id="menu">
<div class="element">1</div>
<div class="element">2</div>
</div> 
```

​</p>

```
#menu{
    width:100%;
    height:45px;    
    background:#f00;
}
.element{
    background:#0f0;
    display:inline-block;
    margin-left:2%;
} 
```

​</p>

我认为你应该在问这些类型的问题时提供类似 jsfiddle 源的东西:)

# android - java.lang.ArrayIndexOutOfBoundsException：长度=1；指数=-1

> ID：13646451
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:38.700
> 
> 标签：android, listview, arraylist

我有一个 listView 可以让用户跟踪某些内容并删除项目行。当我按下删除按钮时，它显示问题如下。我已经检查并在网上找到了解决方案，但我无法理解他们的解决方法，也许我的情况与他们不同。对这个问题有什么想法吗？？

Logcat 输出（错误）：

```
java.lang.ArrayIndexOutOfBoundsException: length=1; index=-1
  at java.util.ArrayList.get(ArrayList.java:306)
  at android.widget.ArrayAdapter.getItem(ArrayAdapter.java:337)
  at com.example.android.project.ThirdActivity$3$2
      .onClick(ThirdActivity.java:295)
  at com.android.internal.app.AlertController$ButtonHandler
      .handleMessage(AlertController.java:174)
  at android.os.Handler.dispatchMessage(Handler.java:99)
  at android.os.Looper.loop(Looper.java:156)
  at android.app.ActivityThread.main(ActivityThread.java:4987)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:511)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller
      .run(ZygoteInit.java:784)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
  at dalvik.system.NativeStart.main(Native Method) 
```

第三活动.java

```
 friend = new ArrayList<String>(Arrays.asList(result.split("[*]")));  

 public void onListItemClick(ListView parent, View v, final int position, long id){
        AlertDialog.Builder adb = new AlertDialog.Builder(ThirdActivity.this);
               adb.setItems(item, new DialogInterface.OnClickListener() {                   
               public void onClick(DialogInterface dialog, int which) {                                        
                   if(item[which].equals("Track Location")){
                       ...
                   }else{
                       AlertDialog.Builder adb=new AlertDialog.Builder(ThirdActivity.this);
                       adb.setTitle("Delete?");
                       adb.setMessage("Are you sure you want to delete " + (String) lv.getItemAtPosition(position));
                       final int positionToRemove = position;
                       adb.setNegativeButton("Cancel", null);
                       adb.setPositiveButton("Ok", new AlertDialog.OnClickListener() {
                           public void onClick(DialogInterface dialog, final int which) {                                                                                               
                               new Thread(){
                                    public void run(){
                                        try{
                                             httpclient = new DefaultHttpClient();
                                             httppost = new HttpPost("http://www.kryptoquest.com/tracker/remove.php");
                                             nameValuePairs = new ArrayList<NameValuePair>(2);
                                             Log.d("12345678",user); 
                                             nameValuePairs.add(new BasicNameValuePair("Targetname", (String) lv.getItemAtPosition(position)));
                                             nameValuePairs.add(new BasicNameValuePair("Username", user));
                                             httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
                                             response = httpclient.execute(httppost);
                                             is = response.getEntity().getContent();
                                        }catch(Exception e){
                                            Log.e("log_tag", "Error:"+e.toString());
                                        }

                                        //convert response to string
                                        try{
                                                reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
                                                sb = new StringBuilder();
                                                line = null;
                                                while ((line = reader.readLine()) != null) {

                                                        sb.append(line + "\n");

                                                }
                                                Log.d("test",sb.toString());
                                                is.close();

                                                result = sb.toString();                                                     

                                            runOnUiThread(new Runnable()
                                           {
                                               public void run()
                                               {
                                                 Toast.makeText(ThirdActivity.this, result +  lv.getItemAtPosition(position), Toast.LENGTH_LONG).show();
                                               }
                                           });
                                        }catch(Exception e){
                                                Log.e("log_tag", "Error converting result "+e.toString());
                                        }
                                    }
                                }.start();
                               String delete = (String) ((lv.getAdapter()).getItem(which));
                               friend.remove(delete);
                               friend.trimToSize();
                               adapter.notifyDataSetChanged();   

                           }});
                       adb.show();
                   }
               }  
        });  
         AlertDialog ad = adb.create(); 
         ad.show();       
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:47:23.540

```
if(item[which].equals("Track Location")) 
```

它“ `item`”是您提交给的数据集`Adapter`，您应该使用`position`而不是`which`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:57:38.910

代替

```
String delete = (String) ((lv.getAdapter()).getItem(which)); 
```

和

```
String delete = (String) ((lv.getAdapter()).getItem(position)); 
```

# css - 水平居中 在 div 内，同时保持文本左对齐

> ID：13646452
> 
> 赞同：12
> 
> 时间：2012-11-30T13:42:39.027
> 
> 标签：css, alignment, text-alignment

我有多个具有固定宽度的 div，`<p>`其中包含包含各种长度文本的标签。

我希望此文本保持左对齐，但如果文本占用的空间不及 div 宽度，我想将此文本居中对齐。

我认为实现这一点的最佳方法是`<p>`在 div 内水平居中，同时保持文本左对齐，但我不知道如何做到这一点。

我已经尝试过设置`margin:0 auto;`，但`<p>`总是调整到 div 的宽度（除非我另有说明，但我不想这样做，因为如果文本运行的时间比 div 长，我不想提前打破它。 ..)

我在这里设置了一个 JSfiddle 来演示：http: [//jsfiddle.net/VDhUa/](http://jsfiddle.net/VDhUa/)

（基本上在这个例子中我想“Lorem ipsum ...”的东西在不使用的情况下集中对齐`text-align:center;`）

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-30T13:51:52.473

将外部 div 设置为`text-align: center;`，将内部 p 设置为`display: inline-block;`

小提琴：http: [//jsfiddle.net/ZL4GM/](http://jsfiddle.net/ZL4GM/)

# jsp - 会话到期实施问题

> ID：13646455
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:47.330
> 
> 标签：jsp, session, session-cookies

我正在尝试在我的应用程序中实现会话到期。我遵循 MVC 模式。我在 web.xml 文件中设置了超时。这是我的会话到期实现

```
protected void doPost(HttpServletRequest request, HttpServletResponse response)    throws    ServletException, IOException 
{
HttpSession session = request.getSession(false);
if (session != null)
{
// controller code
}
else
response.sendRedirect("JSP/HomePage.jsp?message=Your Session Has Expired");     
} 
```

AFAIK，如果请求的会话不是已经创建的会话，request.getSession(false) 将返回一个空对象。

上面的代码在以下情况下运行良好（即重定向到 HomePage.jsp）：
1.我在任何 jsp 页面中提交一些表单（会话过期后）
2.我刷新一些页面（会话过期后）

现在我的问题是，（会话过期后）当我单击一个 jsp 页面中的锚标记链接时，它导航到一些新的 jsp 页面，在那里我提出了一些表单请求，代码不会转移到**HomePage.jsp**。

**在HttpListener**的帮助下，我可以看到创建了一个新会话，并且 request.getSession(false) 在导航新 jsp 页面时返回新创建的会话（但在前两种情况下， request.getSession(false) 返回 null ）。

谁能让我知道我在做什么可以吗？我现在应该以什么方式进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:24:19.477

您可以将以下行添加到您的 jsp 文件中：

```
<%@ page session="false" %> 
```

它将指示 servlet 容器在提供 jsp 时**不要**创建会话。

# jsf - Spring Webflow JSF 查看位置

> ID：13646456
> 
> 赞同：0
> 
> 时间：2012-11-30T13:42:53.953
> 
> 标签：jsf, jsf-2, spring-webflow

我正在尝试使用 Spring Web Flow 设置 JSF 应用程序。

我正在使用 Spring 3.1 Spring faces 2.3.1 JSF (api,impl) 2.1.6

我的问题是程序没有采用我的 jsf 视图的正确位置。

我找到了一些教程，例如

或[http://dgparsons.org/jsf-and-spring-webflow.html](http://dgparsons.org/jsf-and-spring-webflow.html) 用于集成 jsf 和 spring web flow。

在这些视图之一中，解决方法是：

```
<bean id="faceletsViewResolver"  class="org.springframework.web.servlet.view.UrlBasedViewResolver">
<property name="viewClass" value="org.springframework.faces.mvc.JsfView"/>
<property name="prefix" value="/WEB-INF/views" />
<property name="suffix" value=".xhtml" />
</bean> 
```

所以我把我的 xhtml 文件放在文件夹 /WEB-INF/views/

我的流程位于目录 /WEB-INF/config/flow/start.flow

当我尝试时，程序总是想从文件夹 /WEB-INF/config/flow/start.xhtml 打开 start.xhtml

所以它似乎完全忽略了 UrlBasedViewResolver。

我的 FlowBuilderServices 配置如下：

```
<beans:bean id="flowBuilderServices"
    class="org.springframework.webflow.engine.builder.support.FlowBuilderServices">
...
<beans:property name="viewFactoryCreator"> 
       <beans:bean
         class="org.springframework.faces.webflow.JsfViewFactoryCreator" /> 
     </beans:property>

...
 </beans:bean> 
```

在教程中没有 JsfViewFactoryCreator，我找不到关于它的教程。

从 javadoc JsfViewFactoryCreator/JsfViewFactory 负责 RESTORE_VIEW 阶段。所以我深入研究了 JsfViewFactory 的 getView() 方法的源代码。

[JsfViewFactory.java](http://www.jarvana.com/jarvana/view/org/springframework/webflow/org.springframework.faces/2.0.4.RELEASE/org.springframework.faces-2.0.4.RELEASE-sources.jar!/org/springframework/faces/webflow/JsfViewFactory.java?format=ok)

在第 105 行

```
UIViewRoot viewRoot = viewHandler.restoreView(facesContext, viewName); 
```

调用 FlowViewHandler，它会生成相对于我的流文件路径的错误路径。

```
resourcePath = resolveResourcePath(RequestContextHolder.getRequestContext(), viewId); 
```

所以我的问题是现在。如何将 UrlBasedViewResolver 与 flowRegistry/flowbuilderservices 正确关联，以便将 /WEB-INF/views/*.xthml 作为 xhtml 文件的路径。

或者，如果使用 UrlBasedViewResolver 可能是老式的（因为我在 jsf 的 spring web flow 文档中没有看到它）如何正确配置 webflow bean 以使用我定义的目录。

为了完整起见，这是我的 webflow-config.xml 文件

```
<!-- Executes flows: the central entry point into the Spring Web Flow system -->
  <flow-executor id="flowExecutor">
    <flow-execution-listeners>
      <listener ref="facesContextListener" />
      <listener ref="securityListener" />
    </flow-execution-listeners>
  </flow-executor>

  <!-- The registry of executable flow definitions -->
  <flow-registry id="flowRegistry" flow-builder-services="flowBuilderServices"
    base-path="/WEB-INF/config/flow">
    <flow-location-pattern value="/*.xml" />
  </flow-registry>

  <beans:bean id="flowBuilderServices"
    class="org.springframework.webflow.engine.builder.support.FlowBuilderServices">
    <beans:property name="expressionParser">
      <beans:bean
        class="org.springframework.webflow.expression.el.WebFlowELExpressionParser">
        <beans:constructor-arg>
          <beans:bean class="com.sun.el.ExpressionFactoryImpl" />
        </beans:constructor-arg>
      </beans:bean>
    </beans:property>
    <beans:property name="viewFactoryCreator"> 
       <beans:bean
         class="org.springframework.faces.webflow.JsfViewFactoryCreator" /> 
     </beans:property>
    <beans:property name="conversionService">
      <beans:bean
        class="org.springframework.binding.convert.service.DefaultConversionService">
      </beans:bean>
    </beans:property>
  </beans:bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T13:22:19.860

所以最后我自己找到了方法，这很简单。

正如在 Spring Webflow 的文档中所写 - 指定视图标识符 [Spring Webflow 文档](http://static.springsource.org/spring-webflow/docs/2.3.x/reference/htmlsingle/spring-webflow-reference.html#views-introduction)

解决方案是在流定义中使用绝对视图标识符：

```
<view-state id="enterBookingDetails" view="/WEB-INF/hotels/booking/bookingDetails.xhtml"> 
```

因此不需要 URLBasedViewResolver 或 JSFViewFactoryCreator 的特殊配置。

# java - 在形状程序中实现用户定义的异常以调整框架的大小

> ID：13646461
> 
> 赞同：0
> 
> 时间：2012-11-30T13:43:15.270
> 
> 标签：java, exception, resize, dimension, jslider

我正在制作一个绘制形状的程序。单击菜单中的形状后，它会根据 jSlider 中的值绘制下面的形状。

我正在尝试创建一个异常，以便当用户尝试将框架调整为小于 DrawPanel 上绘制的形状时。

为此，我想创建一个 if 语句，因此如果框架的宽度或高度小于 xy 位置加上滑块的值，它将引发异常。

绘图：

```
package ShapesProgram;
//adding the imports
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import javax.swing.JPanel;

/**
 *
 * @
 */
public class DrawShape extends JPanel {

//Declaring variables 
private boolean isCircle;
private boolean isSquare;
private boolean isTriangle;
private int xPosition = 50;
private int yPosition = 50;
MyFrame shapeFrame;
int length;

//making the frame
public DrawShape(MyFrame f) {
    shapeFrame = f;
    initComponents();
    isCircle = false;
    isSquare = false;
    isTriangle = false;
    this.setBackground(Color.LIGHT_GRAY);
    repaint();
}

public void setLength(int length) {
    this.length = length;
}

//setting the shapes to false
public void setIsCircle(boolean isCircle) {
    this.isCircle = isCircle;
    this.isSquare = false;
    this.isTriangle = false;

}

public void setIsSquare(boolean isSquare) {
    this.isSquare = isSquare;
    this.isCircle = false;
    this.isTriangle = false;
}

public void setIsTriangle(boolean isTriangle) {
    this.isTriangle = isTriangle;
    this.isSquare = false;
    this.isCircle = false;
}

@Override
public void paintComponent(Graphics g) {

    Graphics2D g2 = (Graphics2D) g;
    super.paintComponent(g);

    if (isSquare == true) {
        // draw a Square
        g2.drawRect(xPosition, yPosition, length, length);
        repaint();
    } else if (isCircle == true) {

        // draw a Circle
        g2.drawOval(xPosition, yPosition, length, length);
        repaint();
    } else if (isTriangle == true) {

        // draw a Trianlge
        int[] xPoints = new int[3];
        int[] yPoints = new int[3];
        xPoints[0] = xPosition;
        xPoints[1] = xPoints[0];
        xPoints[2] = xPoints[1] + length;
        yPoints[0] = yPosition;
        yPoints[1] = yPoints[0] + length;
        yPoints[2] = yPoints[1];
        g2.drawPolyline(xPoints, yPoints, xPoints.length);
        g2.drawLine(xPoints[0], yPoints[0], xPoints[2], yPoints[2]);

        repaint();
    }

}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
    this.setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );
}// </editor-fold>                        
// Variables declaration - do not modify                     
// End of variables declaration                   
} 
```

我的控制面板：

```
package ShapesProgram;
//adding the imports
import java.awt.Color;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.text.DecimalFormat;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JSlider;
import javax.swing.JTextField;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

/**
*
* @
*/
public class MyControlPanel extends JPanel {

//making a new slider
private ChangeListener sliderAction = new MyChangeAction();
JSlider thejSlider = new JSlider(0, 100);
//creating the labels for Boundary Length, Slider and Area
JLabel lblLenght = new JLabel("Boundary Length");
JLabel lblSlider = new JLabel("Slider");
JLabel lblArea = new JLabel("Area");
//creating the textFields for the Area and Boundary Lengrth
JTextField txtArea = new JTextField(8);
JTextField txtBLength = new JTextField(8);
MyFrame MyControlPanelFrame;
//Constraints required for GridBagLayout
GridBagConstraints gbc = new GridBagConstraints();

public MyControlPanel(MyFrame f) {

    MyControlPanelFrame = f;
    initComponents();

    //setting background color and layout for the frame
    this.setBackground(Color.gray);
    this.setLayout(new GridBagLayout());

    //setting up slider and adding it to the frame 
    thejSlider.setMajorTickSpacing(10);
    thejSlider.setPaintLabels(true);
    thejSlider.setPaintTicks(true);
    gbc.gridx = 14;
    gbc.gridy = 11;
    this.add(thejSlider, gbc);

    //addig the label for the slider to the frame
    this.add(lblSlider, gbc);
    gbc.gridx = 4;
    gbc.gridy = 11;

    //adding the label for the area to the frame
    this.add(lblArea, gbc);
    gbc.gridx = 10;
    gbc.gridy = 11;

    //adding the textField for area to the frame
    this.add(txtArea, gbc);
    gbc.gridx = 2;
    gbc.gridy = 10;
    gbc.gridwidth = 4;

    //adding the label for boundary length to the frame
    this.add(lblLenght, gbc);
    gbc.gridx = 10;
    gbc.gridy = 10;

    //adding the textField for boundary length to the frame
    this.add(txtBLength, gbc);
    gbc.gridx = 14;
    gbc.gridy = 10;

    linkEventHandler();

}
//creating the event handler for the slider action

public void linkEventHandler() {
    thejSlider.addChangeListener(sliderAction);

}

class MyChangeAction implements ChangeListener {

    @Override
    public void stateChanged(ChangeEvent e) {

        //obtain jslider value
        int currentValue = thejSlider.getValue();
        //passing the value of the slider to the draw panel
        MyControlPanelFrame.getDrawPanel().setLength(currentValue);
        //setting the format for the numbers
        DecimalFormat df = new DecimalFormat("0.0");

        //obtain the shape
        //calculate Area
        double x = MyControlPanelFrame.getMyShape().computeArea(currentValue);
        //display area
        txtArea.setText(df.format(x));

        //obtain the shape
        //calculate boundary length
        double y = MyControlPanelFrame.getMyShape().computeBLength(currentValue);
        //display boundary length
        txtBLength.setText(df.format(y));

        //repaint the shape
        MyControlPanelFrame.getDrawPanel().repaint();

    }

}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
    this.setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );
}// </editor-fold>                        
// Variables declaration - do not modify                     
// End of variables declaration                   
} 
```

我的框架：

```
package ShapesProgram;
//adding the imports
import MyShape.Circle;
import MyShape.MyShape;
import MyShape.Square;
import MyShape.Triangle;
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DecimalFormat;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;

/**
*
* @
*/
public final class MyFrame extends javax.swing.JFrame {

MyShape myShape = new MyShape();

//creating a new JMenuBar
JMenuBar jMenuBar1 = new JMenuBar();
JMenu shape = new JMenu("Shape");

//creating new JMenuItems dor the shapes
JMenuItem circle = new JMenuItem("Circle");
JMenuItem square = new JMenuItem("Square");
JMenuItem triangle = new JMenuItem("Triangle");

MyControlPanel panel1 = new MyControlPanel(this);
DrawShape drawPanel = new DrawShape(this);

//Creates new form MyFrame
public MyFrame() {

    //setting the size, title and minimum size of the frame
    this.setSize(400, 400);
    this.setMinimumSize(new Dimension(400, 400));
    this.setTitle("Shapes Program");

    initComponents();
    linkListeners();

    //setting the layout for the frame
    this.setLayout(new BorderLayout());

    //adding the components to the frame
    shape.add(square);
    shape.add(circle);
    shape.add(triangle);
    jMenuBar1.add(shape);

    setJMenuBar(jMenuBar1);

    //adding the panels to the frame 
    this.add(panel1, BorderLayout.SOUTH);
    this.add(drawPanel, BorderLayout.CENTER);

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
}

//creating a new action listener for the shapes
public void linkListeners() {
    MyActionListener l = new MyActionListener();
    circle.addActionListener(l);
    square.addActionListener(l);
    triangle.addActionListener(l);

}

class MyActionListener implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {

        Object obj = e.getSource();

        //when square is selected, it is set to visable 
        //and outputs "Square Selected
        if ((JMenuItem) obj == square) {
            myShape = new Square();
            drawPanel.setIsSquare(true);
            System.out.println("Square Selected");

            //when circle is selected, it is set to visable 
            //and outputs "Circle Selected
        } else if ((JMenuItem) obj == circle) {
            myShape = new Circle();
            drawPanel.setIsCircle(true);
            System.out.println("Circle Selected");

            } 

            //when triangle is selected, it is set to visable 
            //and outputs "Triangle Selected
          else if ((JMenuItem) obj == triangle) {
            myShape = new Triangle();
            drawPanel.setIsTriangle(true);
            System.out.println("Triangle Selected");

        }
    }
}

public DrawShape getDrawPanel() {
    return drawPanel;

}

public MyShape getMyShape() {
    return myShape;
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );

    pack();
}// </editor-fold>                        

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /* Set the Nimbus look and feel */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code        (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look    and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new MyFrame().setVisible(true);
            DecimalFormat oneDigit = new DecimalFormat("#,##0.0");

        }
    });
}
// Variables declaration - do not modify                     
// End of variables declaration                   
} 
```

我的框架：

```
package ShapesProgram;
//adding the imports
import MyShape.Circle;
import MyShape.MyShape;
import MyShape.Square;
import MyShape.Triangle;
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.DecimalFormat;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;

/**
*
* @
*/
public final class MyFrame extends javax.swing.JFrame {

MyShape myShape = new MyShape();

//creating a new JMenuBar
JMenuBar jMenuBar1 = new JMenuBar();
JMenu shape = new JMenu("Shape");

//creating new JMenuItems dor the shapes
JMenuItem circle = new JMenuItem("Circle");
JMenuItem square = new JMenuItem("Square");
JMenuItem triangle = new JMenuItem("Triangle");

MyControlPanel panel1 = new MyControlPanel(this);
DrawShape drawPanel = new DrawShape(this);

//Creates new form MyFrame
public MyFrame() {

    //setting the size, title and minimum size of the frame
    this.setSize(400, 400);
    this.setMinimumSize(new Dimension(400, 400));
    this.setTitle("Shapes Program");

    initComponents();
    linkListeners();

    //setting the layout for the frame
    this.setLayout(new BorderLayout());

    //adding the components to the frame
    shape.add(square);
    shape.add(circle);
    shape.add(triangle);
    jMenuBar1.add(shape);

    setJMenuBar(jMenuBar1);

    //adding the panels to the frame 
    this.add(panel1, BorderLayout.SOUTH);
    this.add(drawPanel, BorderLayout.CENTER);

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
}

//creating a new action listener for the shapes
public void linkListeners() {
    MyActionListener l = new MyActionListener();
    circle.addActionListener(l);
    square.addActionListener(l);
    triangle.addActionListener(l);

}

class MyActionListener implements ActionListener {

    @Override
    public void actionPerformed(ActionEvent e) {

        Object obj = e.getSource();

        //when square is selected, it is set to visable 
        //and outputs "Square Selected
        if ((JMenuItem) obj == square) {
            myShape = new Square();
            drawPanel.setIsSquare(true);
            System.out.println("Square Selected");

            //when circle is selected, it is set to visable 
            //and outputs "Circle Selected
        } else if ((JMenuItem) obj == circle) {
            myShape = new Circle();
            drawPanel.setIsCircle(true);
            System.out.println("Circle Selected");

            } 

            //when triangle is selected, it is set to visable 
            //and outputs "Triangle Selected
          else if ((JMenuItem) obj == triangle) {
            myShape = new Triangle();
            drawPanel.setIsTriangle(true);
            System.out.println("Triangle Selected");

        }
    }
}

public DrawShape getDrawPanel() {
    return drawPanel;

}

public MyShape getMyShape() {
    return myShape;
}

/**
 * This method is called from within the constructor to initialize the form.
 * WARNING: Do NOT modify this code. The content of this method is always
 * regenerated by the Form Editor.
 */
@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">                          
private void initComponents() {

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
    );

    pack();
}// </editor-fold>                        

/**
 * @param args the command line arguments
 */
public static void main(String args[]) {
    /* Set the Nimbus look and feel */
    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(MyFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    /* Create and display the form */
    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new MyFrame().setVisible(true);
            DecimalFormat oneDigit = new DecimalFormat("#,##0.0");

        }
    });
}
// Variables declaration - do not modify                     
// End of variables declaration                   
} 
```

圆圈：

```
package MyShape;

/**
*
* @
*/
public class Circle extends MyShape {

@Override
public double computeArea(int length) {
    return length*length*Math.PI;
}

@Override
public double computeBLength(int length) {
    return 2*length*Math.PI;
}

} 
```

正方形：

```
package MyShape;

/**
*
* @
*/
public class Square extends MyShape {

@Override
public double computeArea(int length) {
  return length*length;
}

@Override
public double computeBLength(int length) {
   return 4*length;
}

} 
```

三角形：

```
package MyShape;

/**
*
* @
*/
public class Triangle extends MyShape {

@Override
public double computeArea(int length) {
    return length * 2 + Math.sqrt (2 * length * length);
}

@Override
public double computeBLength(int length) {
    return length * length / 2;
}

} 
```

# java - 如何使用鼠标与 Java3D 元素交互？

> ID：13646467
> 
> 赞同：0
> 
> 时间：2012-11-30T13:43:23.193
> 
> 标签：java, java-3d

我希望用户能够通过单击并拖动鼠标来更改圆柱体的长度。我应该如何开始呢？任何形式的帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T19:05:40.053

[在此处](http://www.java3d.org/selection.html)查看示例代码。基本思想是：

*   使用 mousePressed() 侦听器来检测鼠标按下。
*   使用 Java3D 拾取 API 来检测鼠标是否按下相交形状。
*   使用 mouseDragged() 侦听器来检测变化量并相应地更新您的形状。

# html - CSS 未在 Mozilla/Firefox 中加载

> ID：13646470
> 
> 赞同：0
> 
> 时间：2012-11-30T13:43:31.200
> 
> 标签：html, css

我创建了一个包含静态内容的网页。我的样式在 Internet Explorer 中加载，但在 Safari 和 Mozilla 中未加载。

**HTML 中的 CSS 参考链接是：**

```
<link rel="stylesheet" type="text/css" href="/stylesheets/style.css"> 
```

**CSS是：**

```
.linkText{
font-family : Verdana, Geneva, Arial, Helvetica, sans-serif;
font-size: 9 pt;
font-weight: normal;
font-style: normal;
color: #015C28;
text-decoration: none;
} 
```

代码：

```
<td bgcolor="#ffffff" width="25%"> <a href="../serverName/xxxxxx.html">
<strong class="linkText"><b>Winback Offers</b></strong></a></td> 
```

请给我提意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:48:44.770

您需要将类添加到 a 标签。喜欢`<a class="linkText" href=""></a>`。

我还看到添加的 css 颜色不正确。喜欢`##015C28`。存在 2 个哈希值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T13:45:12.413

除了使用 HTML 属性的内联样式（这是一个可怕的想法）......</p>

*   首先，9 和 'pt in' 之间没有空格`font-size: 9 pt;`
*   二，删除一个哈希`color: ##015C28;`

**PS**为什么你有`<b>`内`<strong>`？？？这就像对浏览器说“我想要你能给我的最大胆的 MF 文本”。不好，伙计，不好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-30T13:49:36.103

您应该将标签数量减少到：

```
<td bgcolor="#ffffff" width="25%"> 
  <a href="../serverName/xxxxxx.html" class="linkText">
     Winback Offers
  </a>
</td> 
```

然后将 CSS 中的拼写错误更正为：

```
.linkText{
  font-family : Verdana, Geneva, Arial, Helvetica, sans-serif;
  font-size: 9pt;
  font-weight: normal;
  font-style: normal;
  color: #015C28;
  text-decoration: none;
} 
```

你做了

*   `#`在颜色代码前面使用两个
*   `9`在 the和它的单位之间使用一个空格`pt`

您的输出将看起来像这个[小提琴](http://jsfiddle.net/G6e8f/1/)中的那个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T13:46:19.500

你还没有给你的 HTML 类...

HTML应该是..

```
<td bgcolor="#ffffff" width="25%" class="linkText"> <a href="../serverName/xxxxxx.html">Winback Offers</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-30T13:53:44.990

这是因为您在无效的锚标记内提供类试试这个，这将起作用

```
<style type="text/css">
.linkText a{
    font-family : Verdana, Geneva, Arial, Helvetica, sans-serif;
    font-size: 9 pt;
    font-weight: normal;
    font-style: normal;
    color: #015C28;
    text-decoration: none;
}
</style>
<td bgcolor="#ffffff" width="25%">
<span class="linkText">
    <a href="../serverName/xxxxxx.html">Winback Offers</a>
</span>
</td> 
```

# c# - StreamWriter 所有行到文件

> ID：13646473
> 
> 赞同：2
> 
> 时间：2012-11-30T13:43:51.737
> 
> 标签：c#, linq, streamwriter

**C#** 我有一个控制台应用程序，它读取和写入“人员”详细信息的获取/设置列表。在我尝试将其写入文本文件之前，它都可以正常工作。有人能告诉我为什么这会将“人员”详细信息的最后一行写入我的文本文件而不是整个列表吗？

```
 loadData();

        Console.WriteLine("All People");
        //1st query - just select all people
        var queryAllPeople = from person in people  select person;

        foreach (Person p in queryAllPeople)
        {
            using (StreamWriter writer = new StreamWriter("people.txt"))
            {

                writer.WriteLine(p);

            }
            Console.WriteLine(p);
        }

        Console.ReadLine(); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-30T13:45:27.193

将 foreach 放在 using 语句中。您在循环的每次迭代中都覆盖了文件

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-30T13:45:45.190

您正在为每次迭代编写一个具有相同名称的新文件。您将需要创建`StreamWriter`循环外部：

```
using (StreamWriter writer = new StreamWriter("people.txt"))
{
    foreach (Person p in queryAllPeople)
    {
        writer.WriteLine(p);
        Console.WriteLine(p);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-30T13:46:25.880

您每次都在重新创建文件。尝试：

```
using (StreamWriter writer = new StreamWriter("people.txt"))
{
    foreach (Person p in queryAllPeople)
    {
        writer.WriteLine(p);
        Console.WriteLine(p);
    }

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-30T13:46:44.350

使用接受 append 作为参数的[StreamWriter](http://msdn.microsoft.com/en-us/library/36b035cb.aspx)的重载，以便每次都将值附加到文件中。

```
foreach (Person p in queryAllPeople)
{
  using (StreamWriter writer = new StreamWriter("people.txt", true))
  {

     writer.WriteLine(p);

  }
  Console.WriteLine(p);
} 
```

或者只是将 foreach 包装在`using`语句中。

# eclipse - 无法在 Eclipse 中使用 RSE shell 输入命令

> ID：13646474
> 
> 赞同：2
> 
> 时间：2012-11-30T13:43:57.970
> 
> 标签：eclipse, eclipse-rse

我正在尝试使用 Eclipse 中的远程系统资源管理器输入命令。

我打开了一个本地 shell 并尝试输入基本命令，例如`pwd`and `ls`，但没有任何反应。

当我按下`enter`没有任何反应。

我安装了 3.4 版的 RSE。

# wpf - 访问 WPF DataGrid 组标题的项目

> ID：13646477
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:00.080
> 
> 标签：wpf, datagrid, header

我有一组显示在分组 WPF 中的对象`DataGrid`。每个组中的所有项目都有两个项目属性相同，我想将它们都放在组标题中。我可以显示用于与`Name`绑定进行分组的属性，但是如何显示另一个呢？我看不到任何访问分组项目的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T20:47:29.150

使用组项的**Items**属性。您可能需要一个值转换器。

# html - 电话号码下拉列表中的州代码+电话号码

> ID：13646481
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:12.140
> 
> 标签：html, forms

![在此处输入图像描述](../Images/8175f533587c0fcf4fbc90e9454db4bc.png)

我不确定如何问这个问题。所以，我希望你能通过看我这里的照片来理解。

我正在创建 HTML 表单以在第一阶段获取订户的电话号码。现在，我想通过在前面使用状态代码`<select>`和`<option>`后面的电话号码来更改它`<input>`。

例如：+6010123456789

电话号码字段具有`name="telephone"`和`id="telephone"`。我不确定如何写这个。希望你能帮我解决这个问题。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T17:50:14.980

首先，最好区分ID和name属性。另一个是您应该对服务器端代码执行的操作。因此，这里是您当前数据的示例，假设您使用的是使用字符串比较和子字符串方法的原生 PHP。

```
$phone = 6010123456789; 
```

在选择组合框内：

```
<select name="stateCode" id="stateCode">
        <option value="6011" <?php if(!(strcmp(substr($phone,0,4),6011))){ echo "selected=\"selected\"";}?>>6011</option>
        <option value="6012" <?php if(!(strcmp(substr($phone,0,4),6012))){ echo "selected=\"selected\"";}?>>6012</option>
        <option value="6013" <?php if(!(strcmp(substr($phone,0,4),6013))){ echo "selected=\"selected\"";}?>>6013</option>
        <option value="6014" <?php if(!(strcmp(substr($phone,0,4),6014))){ echo "selected=\"selected\"";}?>>6014</option>
        <option value="6016" <?php if(!(strcmp(substr($phone,0,4),6016))){ echo "selected=\"selected\"";}?>>6016</option>
        <option value="6017" <?php if(!(strcmp(substr($phone,0,4),6017))){ echo "selected=\"selected\"";}?>>6017</option>
        <option value="6019" <?php if(!(strcmp(substr($phone,0,4),6019))){ echo "selected=\"selected\"";}?>>6019</option>
        <option value="6010" <?php if(!(strcmp(substr($phone,0,4),6010))){ echo "selected=\"selected\"";}?>>6010</option>
      </select> 
```

和输入框：

```
<input type="number" name="cellNumber" id="cellNumber" value="<?php echo substr($number,4,11) ?>" required/> 
```

所以，如果电话号码是**6010123456789**，选择框会自动选择值相同的区号，输入框会填充 cellNumber。

就是这样，在提交时，您只需要将选择和输入框中的数据连接起来，形成一个新的变量。

希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:30:43.387

我认为您希望将选定的值和文本框的内容作为单个连接值发布到服务器，尽管是两个单独的表单字段，以便您的服务器端代码可以保持不变，阅读 POST名为“电话”的变量？

如果那是您的目标，我认为您不能不修改服务器端代码。您可以同时拥有 the`<select>`和 the`<input>`具有相同的`name`属性值，并且服务器端代码将接收名为“telephone”的变量的逗号分隔值。没有任何更复杂的东西，这几乎是你能得到的。

（记住`<select>`和`<input>`不能共享一个`id`属性值）

# c# - 是否可以订阅任何页面的实时更新？

> ID：13646486
> 
> 赞同：-2
> 
> 时间：2012-11-30T13:44:27.053
> 
> 标签：c#, facebook

我不想订阅任何页面的实时更新。

可能吗？如果不是，我不确定我可以允许订阅哪个页面。我可以订阅以下页面的实时更新吗？

[https://www.facebook.com/platform](https://www.facebook.com/platform)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:45:00.027

[https://developers.facebook.com/docs/reference/api/realtime/](https://developers.facebook.com/docs/reference/api/realtime/)：

> 更新类型
> 
> 可以订阅以下类型的更新：[…]
> 
> *   **页面 - 当已将您的应用安装为选项卡的页面**更改其某些公共属性时获取通知

现在读完之后还有什么不清楚的……？

# css - 视网膜图像的CSS调整大小

> ID：13646488
> 
> 赞同：4
> 
> 时间：2012-11-30T13:44:37.990
> 
> 标签：css, media-queries, retina-display

我收到了一个网站设计，分为三个 psd：一个用于台式机，一个用于平板电脑，一个用于智能手机。我正在通过媒体查询使所有内容都响应，并使所有内容都成为视网膜。让我困扰的一件事是以下内容。

因此，例如，您有一个 Facebook 链接（图标）的背景图像。这个图标在桌面 psd 中是 48x48px。这将使用以下 css 自动使视网膜大小为 96x96px：

```
@media only screen and (-webkit-min-device-pixel-ratio: 2), only screen and ( min--moz-device-pixel-ratio: 2), only screen and (-o-min-device-pixel-ratio: 2/1), only screen and (min-device-pixel-ratio: 2), only screen and (min-resolution: 192dpi), only screen and (min-resolution: 2dppx) { 
   #fb {
       background: url("../images/fb_2x.png") no-repeat;
       background-size: 48px 48px;
       width: 48px;
       height: 48px;
   }
} 
```

但是，当我查看平板电脑和/或智能手机 psd 时，我注意到图标已调整大小以适应设计的其余部分。该图标现在是 28x28px。我怎样才能同时定位这个图标的视网膜版本和每个分辨率的大小差异。我在想我会将我的视网膜媒体查询 css 更改为：

```
#fb {
    background: url("../images/fb_2x.png") no-repeat;
    background-size: 28px 28px;
    width: 28px;
    height: 28px;
} 
```

..但这意味着所有支持视网膜的屏幕（还有ipad视网膜和macbook pro视网膜）都将具有28px的小图标大小（尽管视网膜）；但这不是原始尺寸：它是 48x48px。

感谢您的阅读和建议！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-30T18:36:59.927

这种渐进式方法怎么样：

```
 #fb {
      background: url("../images/fb_28.png") no-repeat;
      background-size: 100% auto;
      width: 28px;
      height: 28px;
    }

    /* bigger image for desktop OR high resolution */
    @media (min-width: $desktop-size), -webkit-min-device-pixel-ratio: 2),  ( min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1),  (min-device-pixel-ratio: 2), (min-resolution: 192dpi), (min-resolution: 2dppx) { 
      #fb {
        background-image: url("../images/fb_48.png");
      }
    }

    /* bigger size for desktop */
    @media (min-width: $desktop-size) {
      #fb {
        width: 48px;
        height: 48px;
      }
    }

    /* bigger image for high resolution desktop */
   @media (min-width: $desktop-size) and (-webkit-min-device-pixel-ratio: 2),  ( min--moz-device-pixel-ratio: 2), (-o-min-device-pixel-ratio: 2/1),  (min-device-pixel-ratio: 2), (min-resolution: 192dpi), (min-resolution: 2dppx)) {
      #fb {
        background-image: url("../images/fb_96.png");
      }
    } 
```

# php - 通过运行联合和交集来组合 5 个 sql 查询的结果

> ID：13646489
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:43.667
> 
> 标签：php, mysql, sql, union, intersect

我有 5 个查询，如下所示，我需要对所有查询执行联合

```
 if($dv_state_ids!="")//check if no state is entered
    $state_sql="SELECT pkg_id FROM package_state where state_id in ($dv_state_ids)  ";
  if($dv_city_ids!="")//check if no city is entered
    $city_sql="SELECT pkg_id FROM package_city where  city_id in ($dv_city_ids)";
  if($dv_category_ids!="")//check if nocategory is entered
    $category_sql="SELECT pkg_id FROM package_category where category_id in ($dv_category_ids) ";
  if($dv_sub_category_ids!="")//check if no subcategory is found
    $sub_category_sql="SELECT pkg_id FROM package_category where subcategory_id in ($dv_sub_category_ids) ";
  if($dv_category_ids!="")
    $package_sql="SELECT pkg_id FROM package where id in ($dv_category_ids) "; 
```

我可以通过以下语句对上述查询运行联合

```
$sql_get_any_packages=$state_sql." union ".$city_sql." 
union 
".$category_sql." union ".$sub_category_sql." union ".$package_sql ; 
```

但是如果任何查询为空，那么这将在 mysql 中产生错误。一种方法是我构建 32 个条件（这将由这 5 个查询形成以检查不同的条件）

任何人都可以建议我另一种出路吗

**我还需要对这 5 个查询的结果执行交集，**并且 sql 不支持 INTERSECT

请在这件事上给予我帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T17:33:41.060

“查询为空”显然是指 PHP 变量为`null`. 这绝不是特定于 SQL 或 SQL 联合的。

# 重复`if`_

所以你可以做的是：

```
$sql_get_any_packages = "";
if (!is_null($state_sql))
 $sql_get_any_packages .= " union " . $state_sql;
if (!is_null($city_sql))
 $sql_get_any_packages .= " union " . $city_sql;
if (!is_null($category_sql))
 $sql_get_any_packages .= " union " . $category_sql;
if (!is_null($sub_category_sql))
 $sql_get_any_packages .= " union " . $sub_category_sql;
if (!is_null($package_sql))
 $sql_get_any_packages .= " union " . $package_sql;
$sql_get_any_packages = substr($sql_get_any_packages, strlen(" union ")); 
```

这只是收集所有非`null`部分，包括每个部分的前导`" union "`，并在最后删除首字母`" union "`。如果所有查询可能`null`同时进行，那么最终结果将是`FALSE`.

# 使用数组

作为替代方案，您可以将您的零件放入一个数组中，用于[`array_filter`](http://de3.php.net/manual/en/function.array-filter.php)放置`null`元素，然后[`implode`](http://de3.php.net/manual/en/function.implode.php)将结果`" union "`用作胶水。相应的代码可能如下所示（另请参见[ideone 上的示例](http://ideone.com/xFHew7)）：

```
$sql_get_any_packages = array(
    $state_sql,
    $city_sql,
    $category_sql,
    $sub_category_sql,
    $package_sql);
$sql_get_any_packages = array_filter($sql_get_any_packages);
$sql_get_any_packages = implode(" union ", $sql_get_any_packages); 
```

# 关于相交

如果你想与结果*相交*，你不想计算他们的联合。一旦你做了一个联合，你就不能再访问它的各个部分，所以你不能将它们相互比较。要实现交集，您可以在 SQL 中使用*连接。*一个完整的示例可能如下所示：

```
SELECT package_state.pkg_id
FROM package_state, package_city, package_category, package_category, package
WHERE package_state.state_id IN ($dv_state_ids)
  AND package_city.city_id IN ($dv_city_ids)
  AND package_category.category_id IN ($dv_category_ids)
  AND package_category.subcategory_id IN ($dv_sub_category_ids)
  AND package.id in ($dv_category_ids)
  AND package_state.pkg_id == package_city.pkg_id
  AND package_state.pkg_id == package_category.pkg_id
  AND package_state.pkg_id == package.pkg_id 
```

您可以使用我上面描述的解决方案来构建这样的查询，但它们会变得稍微复杂一些。特别是，`package_state`上述查询中的表与所有其他表所起的作用有些不同：这是`SELECT`您输出值的表形式，以及`s also the table which occurs on the left hand side of all the`pkg_id `comparisons, where the other tables appear on the right hand side. So you might want to collect several arrays, one of table names and one of`foo IN (bar)` 条件。然后你可以使用表名数组的第一个元素来扮演这个特殊的角色。

# 小心 SQL 注入

将用户请求中的字符串粘贴到查询中时要小心。它们可能包含会破坏您的数据的丑陋的东西。确保输入是健全的，例如通过检查它是否只是一个以逗号分隔的整数值列表。或者[使用prepared statements](https://stackoverflow.com/a/9006268/1468366)，它可以让你远离大多数这些问题。

# php - 用小时和分钟倒计时 - 计算差异

> ID：13646490
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:45.830
> 
> 标签：php, date

我有两个日期：

```
$today = '2012-12-01 10:40:00';
$check = '2012-12-03 12:00:00'; 
```

如何显示此日期的倒计时？应该告诉我：

计数：**49**小时**20**分钟。我可以用函数 mktime 只检查几小时或几分钟，但我该如何比较呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:47:03.850

尝试使用[`DateTime::diff`](http://us3.php.net/manual/en/datetime.diff.php)

```
<?php
$datetime1 = new DateTime('2012-12-01 10:40:00');
$datetime2 = new DateTime('2012-12-03 12:00:00');
$interval = $datetime1->diff($datetime2);
echo $interval->format('%1 day %h hours %i minutes');
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T13:46:53.687

您可以使用 将这些日期更改为 unix 时间戳`strtotime`。然后您可以以秒为单位计算它们之间的差异。

一分钟60秒，一小时60分钟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T13:50:55.057

假设您希望时钟在用户停留在页面上时保持滴答作响，您真的不想使用 PHP 来执行此操作（除非您想每秒向服务器发送 AJAX 调用以更新时钟，这会很糟糕）。做它客户端，使用javascript。

这里有 25 个使用 jQuery 的漂亮脚本：[http ://www.tripwiremagazine.com/2012/11/jquery-countdown-scripts.html](http://www.tripwiremagazine.com/2012/11/jquery-countdown-scripts.html)

# jquery - html5播放视频chrome问题PC

> ID：13646491
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:49.220
> 
> 标签：jquery, windows, html, google-chrome, video

我对 Windows 上的 chrome 中的 html5 视频有疑问。视频播放正常。但如果它结束，视频不会淡出。“divx”图标并没有消失，而是显示并且没有任何反应。chrome似乎没有注意到视频结束了。

如果我将视频设置为循环，则视频会一直在 Chrome 中循环播放（在 Mac 上，所有浏览器都可以正常运行/Win 上的 firefox 也可以）。

这是我的javascrip：

```
<script type="text/javascript">
            $(document).ready(function(){
                var video = $('video')[0];
                video.addEventListener('ended', function () {
                    $('video').fadeOut(200);
                }, false);
                video.play();     
            });
        </script> 
```

这是我的html：

```
<video id="video" autoplay preload>
            <source src="animation/animation.mp4" width="100%" height="100%" type="video/mp4";>
            <source src="animation/Komp.ogv" width="100%" height="100%" type="video/ogg";>
</video> 
```

如果有人可以帮助我，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T17:34:33.777

**谢谢你们的帮助。** 我最终通过禁用 Divx-Webplayer 插件来修复它。视频对淡出或隐藏或类似的东西没有反应。没有插件一切正常！

# c++ - c++ pi 近似的不同输出

> ID：13646493
> 
> 赞同：0
> 
> 时间：2012-11-30T13:44:53.380
> 
> 标签：c++

> **可能的重复：**
> [输出 C++ 蒙特卡罗近似有很大不同](https://stackoverflow.com/questions/13592502/vastly-different-output-c-monte-carlo-approximation)

在我的 64 位 ubuntu 计算机上，以下代码按预期工作，并使用两种算法返回 pi 的近似值。但是，在我必须演示代码的实验室机器上，一台 32 位 rhel 3 机器上，第二个算法总是返回 4，我不知道为什么。任何见解将不胜感激。

```
/*
 * RandomNumber.h
 *
 *  
 *      
 */

#ifndef RANDOMNUMBER_H_
#define RANDOMNUMBER_H_

class RandomNumber {
public:
RandomNumber() {
    x = time(NULL);
    m = pow(2, 31); //some constant value
    M = 65915 * 7915; //multiply of some simple numbers p and q
    method = 1;
}
RandomNumber(int seed) {
    x = ((seed > 0) ? seed : time(NULL));
    m = pow(2, 31); //some constant value
    method = 1; //method number
    M = 6543 * 7915; //multiply of some simple numbers p and q
}
void setSeed(long int seed) {
    x = seed; //set start value
}

void chooseMethod(int method) {
    this->method = ((method > 0 && method <= 2) ? method : 1); //choose one of two method
}

long int linearCongruential() { //first generator, that uses linear congruential method
    long int c = 0; // some constant
    long int a = 69069; //some constant
    x = (a * x + c) % m; //solution next value
    return x;
}

long int BBS() { //algorithm Blum - Blum - Shub
    x = (long int) (pow(x, 2)) % M;
    return x;
}
double nextPoint() { //return random number in range (-1;1)
    double point;
    if (method == 1) //use first method
        point = linearCongruential() / double(m);
    else
        point = BBS() / double(M);
    return point;
}
private:
long int x; //current value
long int m; // some range for first method
long int M; //some range for second method
int method; //method number
};

#endif /* RANDOMNUMBER_H_ */ 
```

和测试类：

```
#include <iostream>
#include <stdlib.h>
#include <math.h>
#include <iomanip>
#include "RandomNumber.h"
using namespace std;

int main() {
cout.setf(ios::fixed);
cout.precision(6);
RandomNumber random;
srand((unsigned) time(NULL));
cout << "---------------------------------" << endl;
cout << "   Monte Carlo Pi Approximation" << endl;
cout << "---------------------------------" << endl;
cout << " Enter number of points: ";
long int k1;
cin >> k1;
cout << "Select generator number: ";
int method;
cin >> method;
random.chooseMethod(method);
cout << "---------------------------------" << endl;
long int k2 = 0;
double sumX = 0;
double sumY = 0;
for (long int i = 0; i < k1; i++) {
    double x = pow(-1, int(random.nextPoint() * 10) % 2)
            * random.nextPoint();
    double y = pow(-1, int(random.nextPoint() * 10) % 2)
            * random.nextPoint();
    sumX += x;
    sumY += y;
    if ((pow(x, 2) + pow(y, 2)) <= 1)
        k2++;

}
double pi = 4 * (double(k2) / k1);
cout << "M(X)  = " << setw(10) << sumX / k1 << endl; //mathematical expectation of x
cout << "M(Y)  = " << setw(10) << sumY / k1 << endl; //mathematical expectation of y
cout << endl << "Pi = " << pi << endl << endl; //approximate Pi

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:18:45.033

问题是`pow`返回 a `double`，它在低端失去精度。转换为`long int`for`%`运算符始终返回相同的结果，因此您的 RNG 输出常量 -60614748。

```
x = time(0)                 1354284781
pow(x, 2)                  1.83409e+18   0x1.973fdc9dc7787p+60
(long int) pow(x, 2)       -2147483648    0x80000000
(long int) pow(x, 2) % M     -60614748 
```

解决方法是更改`x = (long int) (pow(x, 2)) % M;`​​为`x = x * x % M`，在 中执行所有算术运算`long int`。请注意，严格来说这仍然是不正确的，因为有符号溢出是未定义的；更正确的是使用`unsigned long`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:04:17.007

截断到`long`in`BBS()`会导致生成相同的“随机”数。

PS。该`pow`函数的返回是一个数字，它太大而无法以您的机器`long`类型表示。进行转换时会`long`导致未定义的行为。未定义行为的一个特殊影响可能是转换结果是`0x80000000`或者`0x7fffffff`你最终得到一个相同数字的序列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:39:57.850

```
x = time(0)                 1354284781
pow(x, 2)                  1.83409e+18   0x1.973fdc9dc7787p+60 
```

一个 32 位 int 的值最大为 2^31-1，x^2 的值大于该值。

# asp.net - 网址重写：www 重写应该在应用程序中还是 Web 服务器中？

> ID：13646496
> 
> 赞同：0
> 
> 时间：2012-11-30T13:45:04.003
> 
> 标签：asp.net, url-rewriting, iis-7.5

我必须重定向非 www 网址才能使用 www。我可以选择在 IIS 7 中执行此操作，或者在我的 ASP.Net 应用程序中编写此逻辑。

在可移植性方面，我认为在应用程序本身中编写它可能会更好。

是否有实现这一目标的首选方法，或者只是偏好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T13:48:55.070

当您在 IIS7 中执行此操作时，它所做的只是为您修改 Web.Config 文件。我会说这是传统的做事方式。

[http://www.iis.net/learn/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module](http://www.iis.net/learn/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:52:04.123

我认为，在应用程序中这样做更合理。例如，我们这样定义它：

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "User", // Route name
            "u/{user}/{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
            );

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

    } 
```

因此，我们有足够的灵活性，并且可以在我们的链接等中使用特定的标记。但是，如果不需要，我们将使用 IIS 基础。所以，我猜 - 无论在这里让你的泡菜发痒：）

# css - 只有横向模式适用于 iPad 纵向 (CSS)

> ID：13646497
> 
> 赞同：8
> 
> 时间：2012-11-30T13:45:06.383
> 
> 标签：css, ipad, orientation, landscape, portrait

如果您在 iPad 上访问[此处](http://eastcoworldwide.com/Proofs/mint/index.html)，然后单击进入，`Chapter1 > Chapter 1 > Get started...`您将在加载屏幕后看到第 1 章页面。

基本上这是什么，是嵌入到 iframe 中的 html 被 HTML5 和 JavaScript 组合在一起。此 iframe 中的 html 调用其自己的名为 other.css 的 CSS 表。将这一切组合在一起的 html 文件调用了一个名为 styles.css 的样式表。

显然，我希望在纵向视图中此 iframe 的内容区域小于横向视图。我在 other.css 中使用 css：

```
@media only screen and (device-width: 768px) and (orientation:landscape) {
    #content {background:green;}
}

@media only screen and (device-width: 768px) and (orientation:portrait) {
    #content {background:blue;}
} 
```

问题是它甚至看不到肖像CSS。我已经尝试了十几种不同的方法（这应该是正确的方法，并且适用于对整个页面的 styles.css 调整）但它不会识别它。它只会使用景观。它不像不会看到媒体查询，它会拉景观 CSS。但不会使用肖像。真的很奇怪。如果您在纵向和横向中看到背景为绿色，则忽略纵向。如果你看到蓝色，它正在工作。我怎样才能做到这一点？

如果我摆脱横向 CSS，它更喜欢默认的纵向。没有意义。iframe 会阻碍它在方向改变时引入新的 CSS 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T16:49:25.573

您应该以最小或最大设备宽度为目标，否则您将错过设备。

```
/* iPads (landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : landscape) {
/* Styles */
}

/* iPads (portrait) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) 
and (orientation : portrait) {
/* Styles */
} 
```

来自[http://css-tricks.com/snippets/css/media-queries-for-standard-devices/](http://css-tricks.com/snippets/css/media-queries-for-standard-devices/)

这是一个解释为什么你甚至不应该是那么具体[http://catharsis.tumblr.com/post/501657271/ipad-orientation-css-revised](http://catharsis.tumblr.com/post/501657271/ipad-orientation-css-revised)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T22:50:39.133

您可以尝试做的是专门为台式机和平板电脑创建两个不同的样式表； `<link rel="stylesheet" media="screen" href="css/stylesheet1.css"> <!--Desktop-->` `<link rel="stylesheet" href="css/tablet-nav.css" media="screen and (min-width: 800px) and (max-width: 1024px)"> <!--tablet-->`

并且不要忘记添加；

`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">`

[http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/](http://webdesign.tutsplus.com/tutorials/htmlcss-tutorials/quick-tip-dont-forget-the-viewport-meta-tag/) http://webdesignerwall.com/tutorials/css3-media-queries

# batch-file - 解析 .ini 文件

> ID：13646498
> 
> 赞同：1
> 
> 时间：2012-11-30T13:45:06.817
> 
> 标签：batch-file, cmd, ini

我的问题是关于使用 Windows 命令行解析 ini 文件。

我在尝试从文件中删除包含所有键的部分时卡住了。该部分的名称是已知的并保存在变量中。

我试图保存行（开始，结束）以删除它们之间的东西，但它对我不起作用。

这里有人可以帮助我吗？

**编辑：**

这是一个示例 ini 文件：

```
[Example]
cycle = value
cycle2 = value
cycle_bu = value

[Example2]
key1 = value
key2 = value
key3 = value
key4 = value

[something3]
key1 = value
key2 = value
key3 = value
key4 = value
key5 = value
key6 = value 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:57:53.577

[http://www.robvanderwoude.com/sourcecode.php?src=readini_nt](http://www.robvanderwoude.com/sourcecode.php?src=readini_nt)

你能检查一下这是否能奏效吗？

**编辑：** 这未经测试：

```
break >new.ini
set skip_this_section=[something]
set skip_flag=0
for /f  %%I in (myini.ini) do (
   call :print_to_file %%I
)
goto :eif

:print_to_file
setlocal enabledelayedexpansion 
    set line=%1
    set first_char=!line:~0,1!
    if "!first_char!" EQU "[" (
        if "!line!" EQU "!skip_this_section!" (
           set skip_flag=1
        ) else (
           set skip_flag=0
        )
    )
endlocal & set skip_flag=%skip_flag%
if %skip_flag% EQU %0% (
   echo %1 >> new.ini
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-08-12T14:37:26.347

有一个 CLI`crudini`可以按组和键操作 ini 条目：

[https://github.com/pixelb/crudini/blob/master/EXAMPLES](https://github.com/pixelb/crudini/blob/master/EXAMPLES)

# scala - Scala 对象和单例的兴起

> ID：13646504
> 
> 赞同：20
> 
> 时间：2012-11-30T13:45:31.277
> 
> 标签：scala, functional-programming

一般风格问题。

随着我在编写函数式代码方面变得更好，我的更多方法正在变成纯函数。我发现我的许多“类”（在代码容器的松散意义上）正在变得无状态。因此，我将它们设为对象而不是类，因为不需要实例化它们。

现在在 Java 世界中，拥有一个充满“静态”方法的类似乎很奇怪，并且通常只用于“帮助”类，就像你在 Guava 和 Commons-* 等中看到的那样。

所以我的问题是，在 Scala 世界中，“对象”内部有很多逻辑，而不是“类”很正常，或者是否有另一个首选的成语。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-30T15:08:57.927

正如您在标题中提到的那样，对象是单例类，而不是您在问题文本中提到的具有静态方法的类。

并且有一些东西使 scala 对象比 java-world 中的静态和单例更好，所以在 scala 中使用它们是非常“正常的”。

一方面，与静态方法不同，对象方法是多态的，因此您可以轻松地将对象作为依赖项注入：

```
scala> trait Quack {def quack="quack"}
defined trait Quack

scala> class Duck extends Quack
defined class Duck

scala> object Quacker extends Quack {override def quack="QUAACK"}
defined module Quacker

// MakeItQuack expects something implementing Quack
scala> def MakeItQuack(q: Quack) = q.quack
MakeItQuack: (q: Quack)java.lang.String

// ...it can be a class
scala> MakeItQuack(new Duck)
res0: java.lang.String = quack

// ...or it can be an object
scala> MakeItQuack(Quacker)
res1: java.lang.String = QUAACK 
```

这使得它们可以在没有紧密耦合和提升全局状态的情况下使用（这是通常归因于静态方法和单例的两个问题）。

然后是他们取消了所有使单例在 java 中如此丑陋和单调的样板。在我看来，这是一个经常被忽视的点，也是使单例在 Java 中如此不受欢迎的部分原因，即使它们是无状态的并且不用作全局状态。

此外，您必须在所有 java 单例中重复的样板文件赋予该类两项职责：确保只有一个自身实例并执行它应该执行的任何操作。scala 有一种声明式的方式来指定某物是单例，这一事实使类和程序员免于破坏单一责任原则。在 scala 中，你知道一个对象是一个单例，你可以推断它的作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T16:11:52.217

您还可以使用包对象，例如在这里查看 scala.math 包对象 [https://lampsvn.epfl.ch/trac/scala/browser/scala/tags/R_2_9_1_final/src//library/scala/math/package .scala](https://lampsvn.epfl.ch/trac/scala/browser/scala/tags/R_2_9_1_final/src//library/scala/math/package.scala)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-30T14:29:21.283

是的，我会说这是正常的。

对于我的大多数类，我创建了一个伴随对象来处理一些初始化/验证逻辑。例如，如果参数验证在构造函数中失败，则可以在伴随对象的应用方法中返回 an`Option`或 an ，而不是抛出异常：`Either`

```
class X(val x: Int) {
  require(x >= 0)
}
// ==>
object X {
  def apply(x: Int): Option[X] =
    if (x < 0) None else Some(new X(x))
}
class X private (val x: Int) 
```

在伴生对象中可以添加许多额外的逻辑，例如不可变对象的缓存。

如果不需要发送消息，对象也适用于在实例之间发送信号：

```
object X {
  def doSomething(s: String) = ???
}
case class C(s: String)

class A extends Actor {
  var calculateLater: String = ""
  def receive = {
    case X => X.doSomething(s)
    case C(s) => calculateLater = s
  }
} 
```

对象的另一个用例是缩小元素的范围：

```
// traits with lots of members
trait A
trait B
trait C

trait Trait {

  def validate(s: String) = {
    import validator._
    // use logic of validator
  }

  private object validator extends A with B with C {
    // all members of A, B and C are visible here
  }
}

class Class extends Trait {
  // no unnecessary members and name conflicts here
} 
```

# sharepoint - 显示 GUID 的 Sharepoint 优化面板

> ID：13646506
> 
> 赞同：0
> 
> 时间：2012-11-30T13:45:47.730
> 
> 标签：sharepoint, search, sharepoint-2010

我和这篇文章有同样的问题：[social.msdn.com](http://social.msdn.microsoft.com/Forums/lv-LV/sharepointgeneralprevious/thread/b8697442-bd82-4746-9df6-7782d5c12ba6)。我知道他们有答案，但我似乎无法理解他们的意思。

因此，我设置了一个托管属性，然后使用以下代码将其添加到我的优化面板中：

```
<Category    Title="Loan Category"    Description="Use this filter to restrict results by Loan Category"    Type="Microsoft.Office.Server.Search.WebControls.ManagedPropertyFilterGenerator"    MetadataThreshold="5"    NumberOfFiltersToDisplay="4"    MaxNumberOfFilters="20"    SortBy="Frequency"    SortByForMoreFilters="Name"    SortDirection="Descending"    SortDirectionForMoreFilters="Ascending"    ShowMoreLink="True"    MappedProperty="LoanCategory"    MoreLinkText="show more"    LessLinkText="show fewer"  /> 
```

但是，当我进行搜索时，它会显示类别的各种 GUID 以及我正在寻找的类别。我很确定当我刚刚在测试中设置此设置时不会发生这种情况。

我已映射到此托管属性的爬网属性如下：Loan Category(Text)、ows_Loan_x0020_Category(Text)、Loan_x0020_Category(Text)

我最初也映射了“ows_taxId_Loan_x0020_Category(Text)”，但是在阅读这可能是问题后我删除了它。跑了一个完整的爬，仍然没有运气。我还重置了搜索索引并运行了完整的爬网。

任何建议将不胜感激。

这是细化面板生成的链接：

```
<a title="Refine By: #96dbf06d-8bf8-4ec5-971b-36e27fba1f62;Loan Sale:Participation and Servicing Agreement;#4ac5410c-79e9-4a9a-99fb-66592342ed16;#51e388cd-62df-4e50-98b4-01af5f776aea;#04ac5410c-79e9-4a9a-99fb-66592342ed16" class="ms-searchref-filterlink" id="ext-gen151" href="/Search/Pages/results.aspx?k=LoanCategory%3AServicing&r=loancategory%3D%22%2396dbf06d%2D8bf8%2D4ec5%2D971b%2D36e27fba1f62%3BLoan%20Sale%3AParticipation%20and%20Servicing%20Agreement%3B%234ac5410c%2D79e9%2D4a9a%2D99fb%2D66592342ed16%3B%2351e388cd%2D62df%2D4e50%2D98b4%2D01af5f776aea%3B%2304ac5410c%2D79e9%2D4a9a%2D99fb%2D66592342ed16%22"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:17:21.887

我确定 GUID 显示在我的优化面板中，因为它们实际上是映射到我的托管属性的爬网属性之一的内容。

为了确定哪一个，我为每个爬网属性创建了一个托管属性并单独添加它们。然后，我从中央管理部门重置了搜索索引，并重新进行了全面爬网。

我在数据库中找到了让我注意的指南。在数据库中转到您的搜索数据库并查找表 MSSManagedProperties。**您的数据库名称可能不同。**

```
Select * from [_SearchDB].[dbo].[MSSManagedProperties] 
```

获取所需的托管属性，然后根据 Pid 对 PropertyStore 数据库表 MSSDocProps 进行查询。

```
Select strVal2 FROM [_SearchDB_PropertyStore].[dbo].[MSSDocProps]  where Pid = ? 
```

这让您了解您正在为该托管属性获取哪些数据。

# ios - 在 UIBezierPath 的两侧应用阴影

> ID：13646507
> 
> 赞同：5
> 
> 时间：2012-11-30T13:45:53.790
> 
> 标签：ios, drawing, core-graphics, uibezierpath

我目前正在屏幕上绘图。我得到流畅的线条，我可以改变我的图画的颜色。但我找不到如何对该线应用阴影。

要绘制它，我使用：

```
[path strokeWithBlendMode:[path blendMode] alpha:1.0]; 
```

我看到我可以使用`CGContextSetShadowWithColor()`，但尽管如此，我不确定如何使用它，因为这是 CGPath 参考中所说的`strokeWithBlendMode`：

> 此方法在绘制之前自动保存当前图形状态，并在绘制完成后恢复该状态，因此您不必自己保存图形状态。

因此，如果我可以使用它，我真的不知道该放在哪里`CGContextSetShadowWithColor()`或其他任何东西。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T10:04:12.533

如果要使用`CGContextSetShadowwithColor()`，则需要更改将 bezierpath 绘制到视图的方式，以便将`CGPath`表示绘制到`CGContext`. 下面是一个例子：

```
UIBezierPath *path;     // this is your path as before
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextAddPath(context, path.CGPath);
CGContextSetLineWidth(context, 2.0);
CGContextSetBlendMode(context, path.blendMode);
CGContextSetShadowWithColor(context, CGSizeMake(1.0, 1.0), 2.0, [UIColor blackColor].CGColor);
CGContextStrokePath(context); 
```

您可以执行此操作的另一种方法是创建一个新`CAShapeLayer`路径并通过将其设置为路径属性来绘制路径。这将很容易让您添加一个只会影响您的路径的阴影。

# python - Django ModelForm 不调用 clean

> ID：13646508
> 
> 赞同：9
> 
> 时间：2012-11-30T13:46:00.313
> 
> 标签：python, django, eclipse

我正在执行一个基本的 Django ModelForm 创建/验证/保存操作。在 Eclipse 调试器下运行代码时调用 is_valid() 时不会调用我的自定义清理方法，并且我在创建表单和调用 is_valid() 之后设置了断点。

我已经多次跟踪 Django 基本代码，似乎 ModelForm 类上的错误字典从未设置为 None，这会触发验证。我怀疑这是由于与访问 ModelForm 的 _errors 属性以显示在变量窗格中的调试器的交互。

当我删除所有断点并让代码自然流动时，我可以通过发出打印语句来证明自定义干净代码正在运行。

这是 Django ModelForm 设计中的缺陷、Eclipse 问题还是我找错了树？

模型.py

```
from django.db import models

class TestModel1(models.Model):
    field1 = models.CharField(max_length=45)
    field2 = models.IntegerField(default=2)
    field3 = models.CharField(max_length=45, null=True, blank=True) 
```

表格.py

```
from order.models import TestModel1
from django.forms import ModelForm

class OrderTestForm(ModelForm):

    def clean_field1(self):
        return self.cleaned_data['field1']

    def clean_field2(self):
        return self.cleaned_data['field2']

    class Meta:
        model = TestModel1 
```

我的测试工具：

```
from forms import OrderTestForm

row = {'field1': 'test value', 'field2': '4', }

ff = OrderTestForm(row)

#ff.full_clean()
if ff.is_valid():
    ff.save()
else:
    print ff.errors 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:47:37.850

如果你尝试：

```
from order.models import TestModel1
from django.forms import ModelForm

class OrderTestForm(ModelForm):
    class Meta:
        model = TestModel1

    def clean_field1(self):
        value = self.cleaned_data['field1']
        print value 
        return value

    def clean_field2(self):
        value = self.cleaned_data['field2']
        print value 
        return value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T14:01:41.587

I have found the "answer" which is sort of a non-answer. The exact use case was receiving a CSV file from a customer. After inspection of the customer's actual data file, the data fields were padded with spaces -- many spaces. I trimmed the input and shoved that trimmed dictionary into the form and everything worked. Still does not explain why eclipse choked on this.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T18:15:02.357

我遇到了同样的问题，并试图深入挖掘并调试框架。

常规表单和模型表单之间可能存在差异，导致它不起作用，但是这个 hack（覆盖`is_valid()`而不是`clean(...)`）对我有用：

```
def is_valid(self):
    #run whatever ModelForm validations you need
    return super(OrderTestForm, self).is_valid() 
```

# android - 检测拉取列表视图并刷新

> ID：13646513
> 
> 赞同：0
> 
> 时间：2012-11-30T13:46:27.503
> 
> 标签：android, listview, pull-to-refresh

我什至不知道，在标题栏中写什么。

我希望我的应用程序实现此功能：

![在此处输入图像描述](../Images/15985e170ba080fb8d8aa07f3f0ba323.png)

对于那些不明白我在说什么的人：

我有一个`LitsView`. `ListView`如果用户拉出“边界” ，我想加载更多数据。

也许有一些教程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:50:36.403

看看[那个图书馆](https://github.com/chrisbanes/Android-PullToRefresh)。它是 Android 上最好的下拉刷新库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T18:11:24.740

正如 Romain 建议的那样，有许多开源库可以实现此功能。列出几个开源项目链接和如何实现它的教程。

[http://www.recursiveawesome.com/blog/2011/04/29/implementing-pull-to-refresh-in-your-android-app/](http://www.recursiveawesome.com/blog/2011/04/29/implementing-pull-to-refresh-in-your-android-app/)

[https://github.com/erikwt/PullToRefresh-ListView](https://github.com/erikwt/PullToRefresh-ListView)

# android - acra 的替代品（Android 应用程序崩溃报告）

> ID：13646515
> 
> 赞同：2
> 
> 时间：2012-11-30T13:46:46.557
> 
> 标签：android

我需要一个库来自动将崩溃应用程序用户的日志发送到我的电子邮件帐户。

我使用 acra，但它使用意图发送电子邮件（所以不是自动的）。

应该使用什么来发送（静默）崩溃报告？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:53:57.687

[查看ACRA](http://code.google.com/p/acra/source/browse/trunk/examples/CrashReport/src/org/acra/sender/HttpPostSender.java?r=385)的示例

`HttpPostSender`是一个很好的示例，说明如何实现`ReportSender`将静默发布数据，位于此处：

[http://code.google.com/p/acra/source/browse/trunk/examples/CrashReport/src/org/acra/sender](http://code.google.com/p/acra/source/browse/trunk/examples/CrashReport/src/org/acra/sender)

# java - 标记用户提供的内容的编码约定（提高对 XSS 漏洞的认识）

> ID：13646521
> 
> 赞同：0
> 
> 时间：2012-11-30T13:46:59.667
> 
> 标签：java, coding-style, xss

您是否知道任何好的编码约定可以快速警告程序员某些变量（或配置条目等）包含用户提供的内容？我正在尝试提高对将未转义内容粘贴到 HTML/JavaScript/HTTP 中的几种攻击媒介（如 XSS）的认识。

例如：

```
String UserName_UNTRUSTED = readUrlParam("username"); 
```

**补充说明：** 我专门寻找 Java 编码约定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:26:07.290

GWT 使用像[SafeHtml](https://developers.google.com/web-toolkit/doc/latest/DevGuideSecuritySafeHtml)这样的类。

只要正确创建了 SafeHtml 实例，这将使用 Java 的强类型来帮助防止未转义的用户内容到达页面。有多种方法可以转义、连接和使用安全常量。通过以一致的方式使用 SafeHtml，可以更轻松地跟踪变量的来源以及需要转义的内容。

相同的想法可以用于一般的 Java 程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:54:53.360

一个不错的选择是：

> 来自用户的所有字符串都必须存储在变量（或数据库列）中，其名称以前缀“us”（表示不安全字符串）开头。所有经过 HTML 编码或来自已知安全位置的字符串都必须存储在名称以前缀“s”（安全字符串）开头的变量中。

这取自 Joel 关于命名约定的帖子，您可以阅读全文： [http ://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)

# java - 什么是递归

> ID：13646526
> 
> 赞同：4
> 
> 时间：2012-11-30T13:47:19.733
> 
> 标签：java, recursion

> **可能重复：**
> [递归函数示例](https://stackoverflow.com/questions/126756/examples-of-recursive-functions)

我一直在尝试将编程中的递归作为一个概念来研究（尽管我专门研究 Java），这是我最好理解的：

> 例如，在现实生活中，递归就是我们将两个镜子放在彼此的前面，并且它们之间产生的图像是递归的。

但是我在编程中没有得到这个算法？有人可以给我一个简化的例子来理解递归吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-30T13:50:19.407

递归是一种编程技术，其中方法可以调用自身作为其计算的一部分（有时您可以拥有多个方法 - 然后这些方法通常会循环调用彼此）。

一个流行的例子是计算[斐波那契数](http://introcs.cs.princeton.edu/java/23recursion/Fibonacci.java.html)：

```
public static long fib(int n) {
    if (n <= 1) return n;
    else return fib(n-1) + fib(n-2);
} 
```

两个基本组件是基本案例（`n<=1`在示例中）和递归案例。

在创建递归算法时，您需要考虑基本情况以及如何使用递归情况来达到基本情况（否则最终会出现无限递归并破坏堆栈）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-30T13:54:46.573

基本上，一个函数是递归的

1.  一个函数有一个简单的基本情况，当
2.  所有其他情况都有减少到基本情况的规则。

例如，计算阶乘：

```
public static long factorial(int i)
{
    // This is the base case
    if(i == 0)
    {
         return 1;
    }
    else
    {
        // This reduces the problem to something closer to the base case
        return i * factorial(i - 1);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-30T14:07:03.317

一些计算问题可以这样描述，即问题可以分解为更小的子问题。使用与主要问题相同的方法解决较小的子问题。如果较小的子问题只是较大问题的较小情况，那么它本身可以进一步分解。

最终，问题是如此之小，以至于无需进一步分解即可解决。这被称为基本情况。通过基本案例的解决方案，您可以构建更大问题的解决方案。

假设您想找到 a ^b其中 a 和 b 是正整数。您可以看到这与 a * a ^((b-1))相同。也就是说，a ^((b-1))是比原始问题更小的问题，但仍需要与原始问题相同的技术来解决。要解决 a ^((b-1))你会看到它是 a * a ^((b-2))。

等等。

最终你会得到 a * a * a * ... * a ^((bb))。我们知道 bb = 0 和 a ⁰ = 1。所以我们不必计算最后一点，因为我们已经知道答案。最终，a ^b = a * a * a * ... * 1。

所以 2 ⁴ = 2 * 2 ³ = 2 * 2 * 2 ² = 2 * 2 * 2 * 2 ¹ = 2 * 2 * 2 * 2 * 2 ⁰ = 2 * 2 * 2 * 2 * 1。

要编写此程序，您首先要处理基本情况，然后使用递归来处理其他所有情况。

```
 pow(a, b){
       if(b == 0){
          return 1;
       }else{

          return a * pow(a, b - 1);
       }
   } 
```

需要注意的是，这只是递归的基本思想。您在诸如斐波那契数问题的各种答案中看到的这些示例非常低效。您可以使用动态编程技术构建更高效的程序，该技术使用递归作为解决问题的机制之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-30T13:57:05.057

递归编程是一种基于[数学归纳](http://en.wikipedia.org/wiki/Mathematical_induction)思想的技术，其中方法或函数重复调用自身。因此，可以按如下方式实现阶乘函数：

```
int fact(int n) {
    if (n < 2) {
            return 1;
    }

    return n * fact(n-1);
} 
```

请注意，为了确保递归终止，您应该确保处理基本情况，即您为一些已知的简单输入定义了常量输出，并且您应该确保在每次迭代时使函数的参数更简单（在上面的例子中减少`n`1)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-30T13:51:57.167

非常简单的“递归”代码。

处理列表的顶部项目。从列表中删除它并调用代码来处理列表的顶部项目。

树根有一定的长度，每2/3根就分裂成单独的根。分裂的部分每 2/3 个根分裂成单独的根。分裂片的分裂片分裂每个..等等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-30T14:37:03.997

# 递归

一个方法可以调用自己，这就是*递归*。经常使用方法的递归实现，因为它们会产生紧凑优雅的代码，这比不使用递归的对应实现更容易理解。

递归编程技术知道三个重要的规则（经验法则）：

1.  *基本情况*：递归有*基本情况*。总是第一个语句是有条件的并且有一个'return'。
2.  *子*问题：递归调用解决在某种意义上更小的子问题，使其收敛到*基本情况*。
3.  *无重叠*：递归调用不应处理重叠的子问题。

从性能的角度来看，非递归解决方案更快，并且通常需要更少的内存。（例如二分搜索）
但是有些任务非常复杂，只有递归解决方案才能产生（或多或少可理解的）代码。

递归二分查找示例：

```
public static int binSearch(int[] a, int key) {
   return binSearch0(a, key, 0, a.length - 1);
}

public static int binSearch0(int[] a, int key, int from, int to) {
    if (from > to) return -1;
    // looks strange but (from + to) / 2 can oveflow
    // (java bug which was active more than 10 years)
    int mid = from + (to - from) / 2;
    if (key < a[mid]) 
        return binSearch0(a, key, from, mid - 1);
    else if (key < a[mid]) 
        return binSearch0(a, key, mid + 1, to);
    else return mid;
 } 
```

在该示例中，您会看到所有三个规则（base、sub、non oberlap）。
并不是说递归函数通常有一个启动函数，例如示例中的“binSearch”。其中 'binSearch0' 是递归函数。

# facebook - 如何为 facebook 画布应用程序配置 spring-social-facebook

> ID：13646536
> 
> 赞同：0
> 
> 时间：2012-11-30T13:48:05.030
> 
> 标签：facebook, spring, spring-mvc, spring-social

看[Keith Donald](https://github.com/SpringSource/spring-social-samples/tree/master/spring-social-quickstart)和[Roger Hughes 的](http://www.javacodegeeks.com/2012/07/getting-started-with-spring-social-part.html)spring 教程，流程如下；

```
IF user is signed in to to application THEN 
    IF user is signed in to Facebook
        read Facebook data, 
        display Facebook data
    ELSE (facebook handles) 
        ask user to loging to Facebook
        goto if user is signed in to Facebook step
    ENDIF
ELSE 
    ask user to sign in
    create user object with an id 
    when user has signed in, go back to the beginning
END IF 
```

但是，由于我的应用程序将在 facebook 画布上运行，我想跳过登录到应用程序阶段（因为作为用户显式登录到已经在 facebook 上运行的我的应用程序是没有意义的），流程是会是这样的；

```
 create a user (session scope)
    IF user is signed in to Facebook
        update user object with facebook id
        read Facebook data, 
        display Facebook data
    ELSE (facebook handles) 
        ask user to loging to Facebook
        goto if user is signed in to Facebook step
    ENDIF 
```

真的很感激样品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T15:14:57.197

我刚刚注意到[gitspring-social-samples](https://github.com/SpringSource/spring-social-samples/tree/master/spring-social-canvas/)上有一个专门用于画布的示例。

# c# - 捆绑和缩小发现错误的文件

> ID：13646538
> 
> 赞同：0
> 
> 时间：2012-11-30T13:48:12.557
> 
> 标签：c#, .net-4.5, asp.net-optimization, bundling-and-minification

所以我突然遇到了麻烦，当我进行捆绑和缩小时，它会提取错误的文件版本。

```
bundles.Add(new ScriptBundle("~/bundles/jquery").Include("~/Scripts/jquery-{version}.js"));

bundles.Add(new ScriptBundle("~/bundles/scripts").Include(
                             "~/Scripts/bootstrap.js",
                             "~/Scripts/knockout-{version}.js",
                             "~/Scripts/jquery.signalR-{version}.js",
                             "~/Scripts/underscore.js",
                             "~/Scripts/Code/vLib.js"
                             ));

bundles.Add(new ScriptBundle("~/bundles/jqueryui").Include(
                             "~/Scripts/jquery-ui-{version}.js")); 
```

我的解决方案中的文件是：jquery-1.8.3.js、jquery-ui-1.9.2.js、knockout-2.2.0.js、jquery.signalR-0.5.3.js。

我部署时网站正在寻找的文件是：jquery-1.7.2.js、jquery-ui-1.8.22.js、knockout-2.1.0.js、jquery.signalR-0.5.2.js。

我的理解是，当您使用该版本时，它会寻找最新版本....但我猜有些东西搞砸了。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:37:28.767

{version} 模式基本上只是一个正则表达式，因此它将匹配并包含当前所有版本的 jquery。我们肯定会考虑在未来添加类似 {highest-version} 的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:55:37.717

它不使用最新的，但如果您将 jquery 更新到最新版本，则无需重新编译。我相信它会寻找第一个满足要求的文件。

[http://weblogs.asp.net/jgalloway/archive/2012/08/16/asp-net-4-5-asp-net-mvc-4-asp-net-web-pages-2-and-visual- studio-2012-web-developer-features.aspx](http://weblogs.asp.net/jgalloway/archive/2012/08/16/asp-net-4-5-asp-net-mvc-4-asp-net-web-pages-2-and-visual-studio-2012-web-developer-features.aspx) 在该链接中 Jon Galloway 指出“我最喜欢的部分之一是我们可以制作包含脚本名称中版本号的包，因此更新 jQuery（如果你是很棒）不需要*任何*代码/标记更改：”

# string - 从字符串中解析年份

> ID：13646542
> 
> 赞同：0
> 
> 时间：2012-11-30T13:48:26.423
> 
> 标签：string, parsing, substring, vb.net-2010

我有 12-13 个字符串，例如

*   FVS1012 **09** GO5
*   OCGG **85** 0827KU9

根据长度，我必须得到**粗体**部分，表示年份，在示例中为 2009 年和 1985 年。

如何获得“年”？

```
Dim str As String
Dim ResultStr As String
str = "FVS101209GO5"
Dim number As Integer = str.Length()
Select Case number
    Case 12
        ResultStr = str.Substring(8, 12)
        ResultStr = ResultStr.Substring(1, ResultStr.Length() )
    Case 13
        ResultStr = str.Substring(5, 13)
        ResultStr = ResultStr.Substring(1, ResultStr.Length() )
    Case Else
        Debug.WriteLine("other")
End Select 
```

还有其他更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T02:37:49.623

你可能会这样做......

```
Select Case number
  Case 12
    ResultStr = mid(str, 8 ,2)
  Case 13
    ResultStr = mid(str, 5, 2)
  Case Else
    Debug.WriteLine("other")
End Select 
```

请注意，每个案例语句只保存一行，所以是否值得做？我不知道

# perl - LWP::UserAgent、mod_perl 导致大量 Apache 错误日志

> ID：13646547
> 
> 赞同：0
> 
> 时间：2012-11-30T13:48:54.897
> 
> 标签：perl, apache, ubuntu, mod-perl, lwp

每次将 LWP::UserAgent 或 LWP::Simple 与 mod_perl (PerlRun)、Ubuntu 10.04.4 和 Apache 2.2.14 一起使用时，我都会在 Apache 错误日志中收到大约 50 条左右的错误消息：

> 常量子程序 ModPerl::ROOT::ModPerl::PerlRun::home_user_public_html_index_2ecgi::RC_NOT_IMPLEMENTED 在 /usr/lib/perl5/ModPerl/Util.pm 第 69 行重新定义。

我试图将我将使用的函数定义为：

> 使用 LWP::UserAgent qw(代理请求);

但是我仍然收到这些错误消息。他们正在快速填满 Apache 错误日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T03:26:01.487

我认为没有警告“重新定义”；将工作。

```
use strict;
use warnings;
no warnings 'redefine'; 
```

是我平时的做法。

# java - 如何计算 HQL 中的子查询？

> ID：13646548
> 
> 赞同：2
> 
> 时间：2012-11-30T13:48:57.060
> 
> 标签：java, spring, hibernate, jpa, hql

我需要用 HQL 计算这个子查询（在 JPA 中使用 Hibernate）

```
SELECT DISTINCT s.customerName, s.customerCode, MAX(s.orderDate) as last_order_date 
FROM XoopsSalesOrder s 
GROUP BY s.customerCode 
HAVING MAX(s.orderDate) 
BETWEEN '2012-7-1' AND '2012-10-1' AND MAX(s.orderDate) NOT BETWEEN '2012-10-1' AND CURRENT_DATE " 
```

我没有使用 Hibernate lib ，所以我必须设法只用 HQL 来计算。有人可以帮我吗？提前谢谢了 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T05:59:29.733

也许应该在回答您的问题之前询问更多详细信息，但似乎我在这里没有足够的积分（或声誉）来像其他人一样做到这一点。无论如何，以下是我的想法。

假设有 XoopsSalesOrder.Id 作为主键并且 XoopsSalesOrder.customerCode 是唯一的。

```
select s.customerName, s.customerCode, s.orderDate as last_order_date 
from XoopsSalesOrder s 
where s.Id in (
  select s2.Id from XoopsSalesOrder s2 
  where 
  s2.orderDate = max(s2.orderDate) 
  and s2.orderDate between '2012-7-1' AND '2012-10-1' 
  and s2.orderDate not between '2012-10-1' AND current_date 
  group by s2.customerCode
) 
```

# php - PHP in_array 看看是否有更好的方法来做到这一点

> ID：13646550
> 
> 赞同：0
> 
> 时间：2012-11-30T13:49:02.283
> 
> 标签：php, arrays

我的许多网站共享相同的资产，信用卡就是其中之一。所以我创建了一个包含所有信用卡图标的精灵。

在我的信息文件中，我有一个像这样的变量：

```
$credit_cards = array("visa", "mastercard", "discover", "amex"); 
```

然后在我显示图标的页脚中，我有这样的东西：

```
<?php
if (in_array("visa", $credit_cards)) {
    echo "<span class='card-visa'></span>";
}
if (in_array("mastercard", $credit_cards)) {
    echo "<span class='card-mastercard'></span>";
}
if (in_array("discover", $credit_cards)) {
    echo "<span class='card-discover'></span>";
}
if (in_array("amex", $credit_cards)) {
    echo "<span class='card-amex'></span>";
}
?> 
```

所以在我的起始模板上，我所要做的就是编辑信息文件并选择我想要显示的信用卡。如果将来客户想要添加或删除他们不再接受的卡，我只需将其从阵列中取出。

您可能会认为这很疯狂，但它不仅仅是 4 大信用卡。这是针对汽车行业的，还有很多其他的卡片，例如 wright、goodyear、carcare、GE、shell 等。我只是粘贴了 4 个主要卡片的片段。

有一个更好的方法吗？我知道上面的解决方案真的很混乱，我觉得那里必须有一个更清洁的解决方案。我只需要一些关于你认为最好的建议。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-30T13:51:23.050

```
foreach ($credit_cards as $card) {
    echo "<span class='card-$card'></span>";
} 
```

这是一致的命名方案得到回报的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:54:40.540

不确定您所说的“更好”是什么意思，但您至少可以排除共享代码：

```
<?php
function print_card($card) {
    if (in_array($card, $GLOBALS['credit_cards'])) {
        echo "<span class='card-$card'></span>";
    }
}

print_card('visa');
print_card('mastercard');
print_card('discover');
print_card('amex');
?> 
```

# javascript - 正则表达式获取字符串的一部分作为数字

> ID：13646551
> 
> 赞同：0
> 
> 时间：2012-11-30T13:49:04.927
> 
> 标签：javascript, jquery, regex, jquery-selectors

我有一个类似的字符串

```
<dt>Source:</dt>
<dd>
    Emergence: Title; 2005, Vol. 9 Issue 30, p120-203, 12p
</dd> 
```

现在我是一个正则表达式，可以为它获取不同的值，即：音量、问题、日期等，所以我使用以下方法获取整个文本：

```
var attr = jQuery("dl dt:contains('Source:') ~ dd:eq(0)").text(); 
```

并使用正则表达式来获取不同的值，例如：

要获取我使用的起始页面，请遵循正则表达式：

```
var regex = new RegExp("p\\d+(?=[-\\s]{1})");

var regexValPS = attr.match(regex); 
```

返回值：p120，预期：120

同样，为了获取卷信息，我使用以下正则表达式：

```
var regexVol = new RegExp("Vol.\\s\\d+");
var regexValVol = attributeVal.match(regexVol); 
```

我得到：**卷。9**、我要：**9**

同样，我得到带有“问题”文本的问题编号：

```
var regEx = new RegExp("Issue\\s\\d+");
var regExVal = attributeVal.match(regEx); 
```

我应该得到：**30**而不是：**第 30 期**

问题是我不能使用另一个正则表达式来获取所需的值，不能剥离/parseInt 等，并且模式必须能够在单个正则表达式中获取信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T13:55:21.207

要使用单个正则表达式获取所需的信息，您需要利用正则表达式分组：

```
var regEx = new RegExp("Issue\\s(\\d+)");
var regExVal = attributeVal.match(regEx)[1]; 
```

如果您无法修改正则表达式，您可以解析结果数字：

```
var number = "Issue 30".replace(/\D/g, ''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:59:34.650

如果我理解正确，您不想对`.match()`调用返回的字符串值进行进一步解析，但如果它在一个语句中返回必要的值，则可以接受不同的正则表达式。

您的正则表达式需要一个捕获组`()`来检索所需的数字，并将它们放在数组索引中`[]`（第一个索引`[0]`将保存整个匹配的字符串，随后的索引保存`()`捕获的子字符串）。

`new RegExp()`在这种情况下，您可以使用更简单的正则表达式文字代替您`/pattern/`，并且可以在所有情况下在单个语句中提取所需的值。

```
var yourString = '<dt>Source:</dt>\
<dd>\
    Emergence: Title; 2005, Vol. 9 Issue 30, p120-203, 12p\
</dd>';

// Match the page, captured in index [1]
yourString.match(/p(\d+)(?=[-\s]{1})/)[1];
// "120"

// Match the Vol captured in index [1]
yourString.match(/Vol\.\s(\d+)/)[1];
// "9"

// Match the issue captured in index [1]
yourString.match(/Issue\s(\d+)/)[1];
// "30" 
```

[**这是在jsfiddle上**](http://jsfiddle.net/TTM7g/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:12:38.453

使用分组`(...)`并阅读其匹配 »

### 演示：

```
var str = "Emergence: Title; 2005, Vol. 9 Issue 30, p120-203, 12p";
var re = /p(\d+)(?=[\-\s])/;
document.writeln(re.exec(str)[1]); // prints: 120
re = /Vol\.\s(\d+)/;
document.writeln(re.exec(str)[1]); // prints: 9 
```

[**在这里**](http://jsfiddle.net/HBpEg/)测试一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:27:24.560

尝试这个：

```
var attr = jQuery("dt:contains('Source:') ~ dd:eq(0)").text();
console.log(attr);
console.log(attr.match(/p(\d+)(?=[-\s]{1})/)[1]);
console.log(attr.match(/Vol\.\s(\d+)/)[1]);
console.log(attr.match(/Issue\s(\d+)/)[1]); 
```

有关更多详细信息：[与 .MATCH() 一起使用的 JQUERY 正则表达式示例](http://www.jquery4u.com/syntax/jquery-basic-regex-selector-examples/)。

# email - 如何注意邮件是否为转发邮件？

> ID：13646559
> 
> 赞同：4
> 
> 时间：2012-11-30T13:50:04.137
> 
> 标签：email, outlook, exchangewebservices

我有一个非常特殊的问题。

如果我们在 Outlook 中创建邮件，我们添加一个 UserProperty，其中包含我们系统的 DataBase-ID，因此我们可以将邮件链接到表示的 DataBase-Item。在读取每个邮箱中的邮件并自动导入它们的服务上，我可以使用 ExtendedPropertyDefinitions 读取此属性。到目前为止一切都很好...

如果用户现在在 Outlook 中转发邮件，Olk 会将 UserProperty 复制到新邮件中。现在我的问题开始了。现在我的服务认为新消息也链接到我们的数据库，并使用新的正文和新的主题更新 DB-Entry。

那么现在有人如何确定邮件是否为转发邮件或如何告诉 Outlook 不要将用户属性复制到转发的（新）邮件？

谢谢。周杰伦

我们想到的，但不适用于我们的案例
- 第二个用户属性包含一个简单的标签链接“fromSystem”。因为这也会被复制。
- 第二个用户属性，包含从主题和正文计算的哈希和。因为两者都可以由用户更改。我们只是创建消息，添加所有属性并显示它。从这一点开始，在服务处理邮件之前，我们不再控制邮件发生了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T14:00:25.720

使用 EWS 的服务应检查并仅在数据库**长度为 22 字节**[`ConversationIndex`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.conversationindex%28v=exchg.80%29.aspx)时才更新数据库（*原始源消息*）。转发电子邮件和回复电子邮件不断附加 5 个字节（*10 个字符*），使其超过 22 个字节。****`ConversationIndex`****

 ****### 示例对话索引

```
原装：01CDD15D80E51C1D4522172840ACA96287DA28A15D97
回复：01CDD15D80E51C1D4522172840ACA96287DA28A15D970000018630
转发：01CDD15D80E51C1D4522172840ACA96287DA28A15D970000018630000000FC30

```

`ConversationIndex``ConversationTopic`表示（*本质上是 GUID + 时间戳*）的顺序。请参阅[MSDN 上的使用对话](http://msdn.microsoft.com/en-us/library/ms528195%28v=exchg.10%29)。`ConversationIndex`在 MSDN here上[明确定义](http://msdn.microsoft.com/en-us/library/office/cc765583.aspx)。

```
 if (message.ConversationIndex.Length == 22)
 {
   // update DB body, subject, etc.
 } 
```

还要确保[`EmailMessageSchema.ConversationIndex`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessageschema.conversationindex%28v=exchg.80%29.aspx)在尝试访问其值之前加载。****

# php - 使用 PHP 重写 URL？

> ID：13646561
> 
> 赞同：0
> 
> 时间：2012-11-30T13:50:09.173
> 
> 标签：php, .htaccess, url-rewriting

我想使用几个 PHP-MySQL 制定自己的 url 重写规则。这个概念是在我的 .htaccess 中有一条规则，将所有请求发送到我的 index.php 文件，例如：

```
RewriteRule ^([a-zA-Z0-9_-]+)/$     index.php
RewriteCond %{REQUEST_URI}  !\.(.+)$
RewriteRule ^(.*)([^/])$ http://%{HTTP_HOST}/$1$2/ [L,R=301]. 
```

并且 php 将通过一个超级全局变量（如`$_SERVER['REQUEST_URI']`and ）获取所有参数`explode("/", $_SERVER['REQUEST_URI'])`。

```
函数重写（）{
    $paramKeys = 数组（“”、“区域设置”、“页面”、“par1”、“par2”、“par3”、“par4”、“par5”）；   
    $paramValues = explode("/", $_SERVER['REQUEST_URI']);   

    foreach($paramValues as $key => $value){
        if (!is_array($key)) {
            $paramValues[$key] = htmlspecialchars(stripslashes(trim($value)));  
            if($key == 0){ //但是第一个斜杠在 URL 的末尾
                继续;
            }
            elseif($key == sizeof($paramKeys)){
                休息;
            }
            否则 $params[$paramKeys[$key]] = $value;
        }
        否则继续；

    }
    返回$参数；
}

```

并将请求的 URL 与我的数据库中的 URL 进行比较，以按请求的文件找到 200、移动 301 或未找到 404 的顺序发送 http statut。

我有坏主意吗？如果没有，我该如何完善它。谢谢 ！

# javascript - jQuery AJAX 结果块不会立即触发

> ID：13646565
> 
> 赞同：3
> 
> 时间：2012-11-30T13:50:27.577
> 
> 标签：javascript, jquery, ajax, loops, xml-parsing

我在循环中有一个 jQuery POST 函数（多个 post 调用）。
出于某种原因，jQuery 正在发布，但在循环结束并立即解析所有结果之前不会返回所有数据。

```
FOREACH arg_value IN args
{
console.log('Do stuff');

    $.post('https://blah.com/xml.php',
           {arg: arg_value},
           function(xml) {
                $(xml).find('tag').each(function() {
                        console.log('Do more stuff');
                });
           });
} 
```

这个输出是...

> 做事
> 做事
> 做事
> 做更多事
> 做更多事
> 做更多事

似乎 jQuery 正在缓存结果或直到最后才执行它。

我期待着...

> 做事
> 做更多事 做事
> 做
> 更多事 做事
> 做
> 更多事

Is there an option to tell jQuery to pause execution until there is a result from the AJAX? It appears to be running asynchronously as usual, but I don't want that in this case.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T13:58:41.263

A AJAX call is asynchronous. This means your callback:

```
function(xml) {
    $(xml).find('tag').each(function() {
        console.log('Do more stuff');
    });
} 
```

Only gets executed when the server returns a response.

Meanwhile, your `for-each` loop will keep running, and logging `Do stuff`.
~~Unless you're doing crazy stuff in your loop, the loop will be faster than the server response~~
Like [Jan Dvorak](https://stackoverflow.com/users/499214/jan-dvorak) mentioned, Even if you do crazy stuff, the AJAX callbacks will wait for the loop to finish, resulting in `Do stuff` always appearing before any of the AJAX responses.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:01:57.293

Your ajax call is asyncronous, which means that the ajax call is fired off, then the execution flow of further code continues. It does not wait around for the response. When the response is finally received, the callback is executed.

What you could do is to have your ajax calls all stack up in a queue and as each response is received, fire off the next call in the queue. This would achieve your diesired effect, whereby the next ajax call is not sent until the current one is done.

If you have many calls, this would be much slower than firing them all off as soon as they are needed because browsers can easily handle multiple ajax calls at the same time.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:02:48.107

$.post() is async call...will not work in loops the way u want..To get the way u want..here is the solution..

```
var i=0;
callbackfunc(i) {
console.log('Do stuff');
$.post('https://blah.com/xml.php',
        {arg: args[i]},
        function(xml) {
            $(xml).find('tag').each(function() {
              //something related to xml data  
            });
             console.log('Do more stuff');
              i++;
              if(i<args.length)callbackfunc(i)
           }
        });
} 
```

take care of variables..may create closures here...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T13:57:46.257

you are asynchronous here, if you want to do that probably the easiest way to achieve this is to use [async.js](https://github.com/eligrey/async.js)

# iphone - 使用 Core Image 过滤器时攀爬 CFData 内存使用情况

> ID：13646570
> 
> 赞同：4
> 
> 时间：2012-11-30T13:50:44.977
> 
> 标签：iphone, automatic-ref-counting, dealloc, core-image, cfdata

我遇到了分配内存过多的问题。我的应用程序分配内存达到 100MB！是的......我正在使用`ARC`. 分配的大部分内存是由`CFData`（据我所知是`CoreImage`过滤器）。对图像应用过滤器后，`CFData`分配的内存增加了 ~1.3mb 并且不会释放：

![显示内存使用情况的仪器](../Images/b2472b299ce069fa4499f5f8542c2248.png)

代码如下所示：

```
+(UIImage*)BWFilter:(UIImage *)imgFX
{
    CIImage *sourceImage = [[CIImage alloc] initWithImage:imgFX];

    CIImage *blackAndWhite = [CIFilter filterWithName:@"CIColorControls" keysAndValues:kCIInputImageKey, sourceImage, @"inputBrightness", [NSNumber numberWithFloat:0.0], @"inputContrast", [NSNumber numberWithFloat:1.1], @"inputSaturation", [NSNumber numberWithFloat:0.0], nil].outputImage;
    CIImage *output = [CIFilter filterWithName:@"CIExposureAdjust" keysAndValues:kCIInputImageKey, blackAndWhite, @"inputEV", [NSNumber numberWithFloat:0.7], nil].outputImage;

    CIContext *context = [CIContext contextWithOptions:nil];
    CGImageRef cgiimage = [context createCGImage:output fromRect:output.extent];
    imgFX = [UIImage imageWithCGImage:cgiimage];

    if (cgiimage) {
        CGImageRelease(cgiimage);
    }

    return imgFX;
} 
```

内存警告后内存使用量不会下降，因此它不应该是缓存问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-01T19:21:25.453

我在一个示例项目（使用 ARC）上运行了您的代码，它没有给出任何泄漏或额外分配。`CFData`本质上与`CIFilter`子类无关，而是与`CIImage`. 问题出在其他地方。

# c++ - 适用于大文件和 512 KB 块的最快和轻量级散列算法 [C、Linux、MAC、Windows]

> ID：13646574
> 
> 赞同：2
> 
> 时间：2012-11-30T13:50:56.707
> 
> 标签：c++, hash, hashalgorithm

我正在研究一个涉及文件哈希计算的项目。该项目就像一个文件备份服务，所以当一个文件从客户端上传到服务器时，我需要检查该文件是否已经在服务器中可用。我为文件生成一个 CRC-32 哈希，然后将哈希发送到服务器以检查它是否已经可用。

如果文件不在服务器中，我曾经将文件作为 512 KB 块 [for Dedupe] 发送，我必须为每个 512 KB 块计算哈希。文件大小有时可能只有几 GB，并且多个客户端将连接到服务器。所以我真的需要一个快速和轻量级的文件散列算法。有任何想法吗 ..？

PS：我已经注意到 StackOverflow 中的一些 Hashing Algorithm 问题，但答案并不能完全比较此类任务所需的 Hashing Algorithms。我敢打赌这对一群人来说真的很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T17:08:28.057

实际上，CRC32 既没有最好的速度，也没有最好的分布。

这是意料之中的：按照今天的标准，CRC32 已经很老了，并且是在 CPU 不是 32/64 位宽也不是 OoO-Ex 的时代创建的，分布属性也没有错误检测那么重要。从那以后，所有这些要求都发生了变化。

为了评估哈希算法的速度和分布特性，Austin Appleby 创建了出色的[SMHasher](http://code.google.com/p/smhasher/wiki/SMHasher)包。[此处提供](http://cyan4973.github.io/xxHash/#benchmarks)了结果的简短摘要。我建议选择 Q.Score 为 10（完美分布）的算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:33:37.690

您说您正在使用 CRC-32 但想要更快的哈希值。CRC-32 非常基础而且非常快。我认为 I/O 时间会比哈希时间长得多。您还需要一个不会发生冲突的哈希。也就是说，两个不同的文件或 512 KB 块获得相同的哈希值。您可以查看任何加密哈希，例如 MD5（不要用于安全应用程序）或 SHA1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-04T07:17:00.867

如果您只使用 CRC-32 来检查文件是否重复，您将得到错误的重复，因为不同的文件可以具有相同的 crc-32。你最好用sha-1，crc-32和md5都太弱了。

# c++ - 数组存储并要求用户搜索它

> ID：13646576
> 
> 赞同：0
> 
> 时间：2012-11-30T13:51:00.870
> 
> 标签：c++

问题是编写一个程序，要求用户输入 10 个整数，将这些数字存储在一个数组中。程序应该询问用户是否想在数组中搜索一个元素，在这种情况下，程序应该提示用户输入要查找的数字。使用递归函数 find( int index, int array[] ) 顺序搜索此数组中的目标。搜索元素后向用户显示适当的消息。程序应该再次询问用户是否想搜索同一数组中的另一个元素，并在必要时重复此过程。

我是一名初学者程序员......到目前为止已经完成了。我需要一些帮助..我已尽力解决它

> ```
> #include<stdio.h>
> #include<conio.h>
> int main (int,int)
> {
>     int i,n;
>      int size[10];
>      printf("\nPls Enter 10 numbers for Arrays \n");
>      scanf("%d",&n);
>      for(i=0; i<10 ;i++)
>      {
>       return 0;
> 
>       }      
>  getch();   
> } 
> ```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-30T14:02:22.647

这是您需要的代码：

```
#include <cstdio>
#include <cstdlib>

int n = 10,num;

void find(int index,int arr[]) {
  if(index == n) printf("Number %d not found\n");
  else if(arr[index] == num) printf("Number %d found, position %d\n.",num,index);
  else find(index + 1, arr);
}

int main() {
  int arr[n];
  printf("Please, enter 10 numbers for the array: \n");
  for(int i = 0; i < n; ++i) {
    scanf("%d",&arr[i]);
  }
  printf("Please insert the number you want to search: ");
  scanf("%d",&num);
  find(num,arr);
  system("pause"); //To pause the program before it finishes
  return 0;
} 
```

# php - 找不到 Joomla 分页模板

> ID：13646577
> 
> 赞同：2
> 
> 时间：2012-11-30T13:51:05.763
> 
> 标签：php, joomla, pagination

我要疯了这个。我正在尝试更改 Joomla 中的分页样式和布局。所以，我找到了这个文件：libraries\joomla\html\pagination.php，但我知道分页被这个文件覆盖：templates\gk_yourshop\html\pagination.php。然而，如果我修改 gk_yourshop\html\pagination.php 中的某些内容，我看不到页面的变化。joomla 是否缓存模板并且我必须重新加载它们（如 phpBB）？我不明白。

我试图检查是否从 joomla\html\pagination.php 调用了 writePagesLinks：

```
function getPagesLinks()
{
            echo "test";
    global $mainframe; 
```

我看不到消息。我也在另一个 pagination.php 文件中这样做了，就像我可以删除它们一样，没关系。你能帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-30T14:38:40.880

看起来我前段时间在这里改变了它：
`\libraries\joomla\html\pagination.php`

但是，那是系统文件，所以我只是对其进行“修补程序”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-13T07:51:04.733

在 Joomla 3.x 中，您可以从 Extensions > Templates > Default Template > Create Overrides > Layouts > Pagination 创建分页覆盖。

覆盖文件在“默认模板”“html\layouts\joomla\pagination”文件夹中创建。

您可以根据需要编辑覆盖文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-01T11:43:39.703

你从哪里得到 WritePageLinks？这不是支持的方法之一。

[http://docs.joomla.org/Understanding_Output_Overrides#Pagination_Links_Overrides](http://docs.joomla.org/Understanding_Output_Overrides#Pagination_Links_Overrides)

有四个可以使用的功能：

> pagination_list_footer
> 
> 此函数负责显示每页要显示的项目数的选择列表。
> 
> pagination_list_render
> 
> 此函数负责在开始、结束、上一个和下一个链接处显示页码链接列表。
> 
> pagination_item_active
> 
> 此功能显示指向“当前”页面以外的其他页码的链接。
> 
> pagination_item_inactive
> 
> 该函数显示当前页码，通常没有超链接。
> 
> [编辑]

您可能还想以 Protostar 为例。

# sorting - 排序钻取报表

> ID：13646578
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:51:08.743
> 
> 标签：sorting, ssas, ssas-2008, drillthrough

我在钻取操作是 SSAS 2008 时遇到问题。

我想按特定的钻取列设置钻取报表的排序顺序，但找不到问题的解决方案。我正在寻找它，但找不到任何东西。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T08:33:17.130

我已经收集了有关此问题的更多信息，似乎这是不可能的。如果有人在他的详细报告中也需要此功能，他可能会在[https://connect.microsoft.com/SQLServer/Feedback提供反馈](https://connect.microsoft.com/SQLServer/Feedback)

问候，

传统知识

# c - 根据点旋转一个对象

> ID：13646583
> 
> 赞同：0
> 
> 时间：2012-11-30T13:51:29.897
> 
> 标签：c, math, opengl, graphics

```
 O
                 position 2

 O                             Y
 object                      ( x,y,z )
 position 1 
```

我想根据具有 Q 角的固定点 (x,y,z) 旋转对象。使用opengl，我该怎么做？

对象从位置 1 移动到位置 2 。

我知道 Q, (x,y,z)。

我已经做好了 ：

```
glPushMAtrix ()
glTranslatef ( -x, -y, -z ) ;
glRotatef ( Q, 1.0f, 0.0f, 0.0f );

glCylinder ( /*argument*/ ) 
glPopMatriX () 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:17:48.090

如果您在 3D 空间中旋转并且只知道对象、角度和旋转中心，那么您的任务是未定义的。在 3D 空间中，您只能围绕某个轴旋转，而不是点。

从您的代码示例中，您正在围绕 X 轴旋转。让我猜这才是你真正想要的。

为此，您应该将坐标系的原点平移到旋转中心，执行旋转并将坐标系平移回来。

```
glTranslatef(-x, -y, -z);
glRotatef(Q, 1.0, 0.0, 0.0);
glTranslatef(x, y, z);
// draw the object 
```

如果您知道对象的初始位置和最终位置，则可以计算旋转轴。（因为 3 点总是定义一个平面及其法线。）在矢量符号中，它应该看起来像这样（在轴方向上可能是错误的。如果对象在相反方向上旋转，则改变轴或角度的符号）。

```
axis = vec(center_of_rotation - initial_position, center_of_rotation - final_position) 
```

或者多一点“傻瓜”

```
float X1[3]; // initial position
float X2[3]; // final position
float O[3]; // orign of rotation

float OX1[3]; OX1[0] = X1[0] - O[0]; OX1[1] = X1[1] - O[1]; OX1[2] = X1[2] - O[2];
float OX2[3]; OX2[0] = X2[0] - O[0]; OX2[1] = X2[1] - O[1]; OX2[2] = X2[2] - O[2];

float axis[3]; // vector product OX1 and OX2
axis[0] = OX1[1]*OX2[2]-OX1[2]*OX2[1];
axis[1] = OX1[2]*OX2[0]-OX1[0]*OX2[2];
axis[2] = OX1[0]*OX2[1]-OX1[1]*OX2[0]; 
```

# unit-testing - 如何使用保存依赖项制作 mocha 手表、编译和测试咖啡脚本

> ID：13646589
> 
> 赞同：3
> 
> 时间：2012-11-30T13:51:55.577
> 
> 标签：unit-testing, node.js, tdd, coffeescript, mocha.js

我正在开发一个使用咖啡脚本进行开发和测试的项目。我在带有 mocha 的 --watch 标志的节点中运行测试，这样我可以在我进行更改时自动运行测试。

虽然这在某种程度上有效，但只有 ./test/test.*.coffee 文件在保存某些内容时会被重新编译。这是我的目录结构：

```
/src/coffee
-- # Dev files go here
/test/
-- # Test files go here 
```

mocha watcher 响应 /src 和 /test 目录中的文件更改，但只要重新编译 /test 目录中的文件，连续测试就有点无聊。如果我退出并重新启动观察程序，源文件也会重新编译。如何让 mocha 让咖啡编译器在每次运行时在测试文件中列为依赖项的开发文件运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T12:57:16.910

这是我使用 grunt.js 的答案

你将不得不安装 grunt 和一些额外的包。

```
npm install grunt grunt-contrib-coffee grunt-simple-mocha grunt-contrib-watch 
```

并编写这个 grunt.js 文件：

```
module.exports = function(grunt) {

  grunt.loadNpmTasks('grunt-contrib-coffee');
  grunt.loadNpmTasks('grunt-simple-mocha');
  grunt.loadNpmTasks('grunt-contrib-watch');

  grunt.initConfig({
    coffee:{
      dev:{
        files:{
          'src/*.js':'src/coffee/*.coffee',
        }
      },
      test:{
        files:{          
          'test/test.*.js':'test/test.*.coffee'
        }
      }
    },
    simplemocha:{
      dev:{
        src:"test/test.js",
        options:{
          reporter: 'spec',
          slow: 200,
          timeout: 1000
        }
      }
    },
    watch:{
      all:{
        files:['src/coffee/*', 'test/*.coffee'],
        tasks:['buildDev', 'buildTest', 'test']
      }
    }
  });

  grunt.registerTask('test', 'simplemocha:dev');
  grunt.registerTask('buildDev', 'coffee:dev');
  grunt.registerTask('buildTest', 'coffee:test');
  grunt.registerTask('watch', ['buildDev', 'buildTest', 'test', 'watch:all']);

}; 
```

注意：我没有关于如何构建/运行测试的一些细节，所以你当然必须添加 ;)

然后运行 ​​grunt watch 任务：

```
$>grunt watch 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-04T04:24:47.287

使用带有[面粉](http://github.com/ricardobeat/cake-flour)的 Cakefile ：

```
flour = require 'flour'
cp    = require 'child_process'

task 'build', ->
    bundle 'src/coffee/*.coffee', 'lib/project.js'

task 'watch', ->
    invoke 'build'
    watch 'src/coffee/', -> invoke 'build'

task 'test', ->
    invoke 'watch'
    cp.spawn 'mocha --watch', [], {stdio: 'inherit'} 
```

摩卡已经看`test/`文件夹了，所以你只需要看`src/`。

# node.js - 无法让 node-apn 连接

> ID：13646591
> 
> 赞同：5
> 
> 时间：2012-11-30T13:52:01.147
> 
> 标签：node.js, apn-node

我正在尝试与 APN 建立连接。它根本不会连接。我得到以下变化：

```
 apn Socket error occurred +609ms { [Error: socket hang up] code: 'ECONNRESET' } 
```

和

```
apn Connection error occurred before TLS Handshake +0ms 
```

这是存折通行证。不是应用程序。我正在使用 Passbook 证书。

我的代码是：

```
var apns = require('apn');

var root = process.cwd();

var fs = require('fs');

var options = {
    cert: root + '/certs/new/cert.pem',                 /* Certificate file path */
    certData: null,                   /* String or Buffer containing certificate data, if supplied uses this instead of cert file path */
    key:  root + '/certs/new/key.pem',                  /* Key file path */
    keyData: null,                    /* String or Buffer containing key data, as certData */
    passphrase: 'secret',                 /* A passphrase for the Key file */
    ca: null,                         /* String or Buffer of CA data to use for the TLS connection */
    gateway: 'gateway.sandbox.push.apple.com',/* gateway address */
    port: 2195,                       /* gateway port */
    enhanced: true,                   /* enable enhanced format */
    errorCallback: undefined,         /* Callback when error occurs function(err,notification) */
    cacheLength: 100                  /* Number of notifications to cache for error purposes */
};

var apnsConnection = new apns.Connection(options);

var myDevice = new apns.Device('token');

var note = new apns.Notification();

note.payload = {};
note.device = myDevice;

apnsConnection.sendNotification(note); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T13:58:11.493

看来我混淆了我的证书。我确定我早些时候尝试过交换它们，但显然没有。

* * *

**cert**：您的应用程序证书。
**关键**：苹果的 WWDR

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T13:55:03.820

你在代理后面吗？这可能是问题（至少在我的情况下经常如此）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T15:11:35.527

尝试以下结构：手动读取`.cert`and文件并将它们分别设置为and属性。这是核心：`.key``certData``keyData`

```
var key = root + '/certs/new/key.pem'
var cert = root + '/certs/new/cert.pem';

var certData = fs.readFileSync(cert, encoding='ascii');
var keyData = fs.readFileSync(key, encoding='ascii');

var apnsConnection = new apns.Connection({
    certData: certData,
    keyData: keyData,
    gateway: 'gateway.sandbox.push.apple.com',
    port: 2195,
    ... /* other configs of course */
}); 
```

# jquery - 如何在一行代码中隐藏多个 div？

> ID：13646592
> 
> 赞同：1
> 
> 时间：2012-11-30T13:52:00.040
> 
> 标签：jquery, html, hide

```
function switch01(){
  $("#contact").hide();
  $("#about").hide();
  $("#mail").hide();
}; 
```

这可行，但我希望所有三行都写在一行中。
我尝试了`+`和`,`- 没有结果。
事实上，我有五个 div 要隐藏。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-30T13:53:47.150

看到这个：[http ://api.jquery.com/multiple-selector/](http://api.jquery.com/multiple-selector/)

```
$("#contact,#about,#mail").hide(); 
```

应该管用

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-30T13:56:42.687

你可以像这样用逗号分隔你的答案

```
$("#contact, #about, #mail").hide(); 
```

例子在这里

[http://jsfiddle.net/c4swG/](http://jsfiddle.net/c4swG/)

我通常会为此使用一个类，例如隐藏

```
<div id="contact" class="hidden">contact</div>
<div id="about" class="hidden">about</div>
<div id="mail" class="hidden">mail</div>

$(".hidden").hide(); 
```

[http://jsfiddle.net/fBucw/](http://jsfiddle.net/fBucw/)

# iphone - 重新加载表格时如何更改 TableViewcell 的出口

> ID：13646603
> 
> 赞同：1
> 
> 时间：2012-11-30T13:52:45.287
> 
> 标签：iphone, ios, uitableview, ios5.1

我正在制作一个应用程序，它的地址有一个列表页面和一个详细信息页面。

![地址簿的列表页](../Images/40ac84c0afaa61c946a1fc1bcd844360.png)

![通讯录详细信息页](../Images/88024feb367fa7e3d4bfb5df8278bfdc.png)

如果我点击详细页面的电子邮件地址，它会弹出到列表页面。我想在其电子邮件被选中的列表页面上显示一个勾号。（如下所示）。单元格有图像（打勾）

![在此处输入图像描述](../Images/c51e8afb2307159bdb01f594d4f13c9f.png)

.我想在重新加载lising页面时更改单元格中图像的出口。重新加载表格时显然不会调用 cellforrowatindexapath。有什么方法可以获取单元格的索引路径。这样我可以在重新加载表格时更改单元格的出口。谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:01:03.020

为什么不更改附件视图类型？将`accessoryViewType`属性设置`UITableViewCell`为以下之一：

```
UITableViewCellAccessoryDisclosureIndicator
UITableViewCellAccessoryDetailDisclosureButton
UITableViewCellAccessoryCheckmark    // you want this one 
```

默认值为`UITableViewCellAccessoryNone`。

您可能必须`[tableView reloadData]`在适当的时候调用以重新加载表数据。

有很多关于附件视图的问题，例如自定义附件视图：例如[，为 UITableViewCell 的附件视图使用自定义图像并让它响应 UITableViewDelegate](https://stackoverflow.com/questions/869421/using-a-custom-image-for-a-uitableviewcells-accessoryview-and-having-it-respond)。

# c# - C# If...Else 比较字符串值与类型

> ID：13646606
> 
> 赞同：1
> 
> 时间：2012-11-30T13:53:05.830
> 
> 标签：c#, .net

我有以下示例代码。最佳做法是什么？比较值或比较类型以执行某种业务逻辑：

```
public Customer
{
    public Category {get;set;}
    public CategoryName {get;set;}  //e.g. "Category A" or "Category B"
}

public Category{}

public CategoryA : Category {}

public CategoryB : Category {}

public void Main()
{
    Customer customer = new Customer();

// Option 1:
if(customer.CategoryName == "Category A")
{
    CategoryA catA= customer.Category as CategoryA;     
    DoSomething(catA)
}

// Option 2:
CategoryA catA= customer.Category as CategoryA;
if(catA != null)
{
    DoSomething(catA)
}

// Option 3:
if(customer.Catgeory is Category A)
{
    CatgeoryA catA= customer.Category as CategoryA;
    DoSomething(catA)
}
} 
```

本守则仅作说明之用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:55:19.130

鉴于这 3 个选项，我会选择**Option 2**。
例如 - 尝试进行转换并检查它是否不是`Null`。

它比最后一个选项更好的原因是**选项 3**导致您进行 2 次转换，一个用于下一行`is`，一个用于`as`下一行。

最后，**选项 1**是最糟糕的 IMO - 它要求你有某种逻辑，你不能确定以后会坚持下去（没有人阻止某人创建具有`Category`类别 A 和`CategoryName`类别 B的客户”）。此外，这是额外的逻辑，可以通过**Option 2**以更清晰的方式完成。

我应该提到，正如其他评论/答案中所指出的那样，还有一些可以考虑的选项。使用**[多态](http://en.wikipedia.org/wiki/Polymorphism_%28computer_science%29)**可能是最好的设计策略。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T14:20:16.283

我认为你的设计有问题。IMO 有多个检查和演员表是一个[臭的设计。](http://en.wikipedia.org/wiki/Code_smell)

```
CategoryA catA = customer.Category as CategoryA;
if(catA != null)
{
    DoSomething(catA)
} 
```

所以大概你有一个`DoSomething(CategoryA cat)`，`DoSomething(CategoryB cat)`等等。

在这种情况下，我强烈建议您考虑将`DoSomething`移至类别类。

```
customer.Category.DoSomething(); 
```

然后可以通过 和 以不同的方式`CategoryA`实现`CategoryB`它`CategoryC`。

如果只有一个实现`CategoryA`，则在基类中只有一个空实现，并且不要在 B 和 C 中覆盖。

**额外推荐：使用接口**

我个人不会实现基本类型。我总是选择接口。当代码不在多个类层次结构中时，它的限制较少且更容易遵循。

```
public interface ICategory{
  void DoSomething();
}

public class CategoryA : ICategory {...}

public class CategoryB : ICategory {...} 
```

接口实现者之间的通用功能？没问题，只需创建一个新对象来执行该功能并将其组合到两个实现者中。然后可以单独对该功能进行单元测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:29:37.673

除了其他回答者解释的关于性能或演员一两次或其他的其他观点，我想提出一些考虑。

这绝对取决于企业在您的特定情况下会做什么：

### 一个。类别只是一个鉴别器

不要使用类型。它应该是一个字符串，或者一个标识符，如 a `Guid`or `int`。您的 UI 本地化会将标识符转换为人类可读的名称。这足以区分*类别*。

解决方案：*客户将拥有`CategoryName`财产。比较`Id`*。

### 湾。类别是一个鉴别器，可能的类别数量有限

一个词：**枚举**。定义一个`Category`枚举：

```
public enum Category { A, B, C }

if(customer.Category == Category.A)
{
    // Whatever
} 
```

解决方案：*`Customer`将有一个`Category`属性。通过枚举值进行比较*。

### C。类别是一个实体

我不会为每个类别创建一个类。类别是*实体*，有零个或多个具有特定标识符或名称的类别。

因此，分别`Category`具有and和or类型的`Name`and`Id`属性。`string``int``Guid`

解决方案：*`Customer`将有一个 1:1 的关联`Category`并且`Category`会有一个`Name`属性。比较`Id`*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:05:05.277

**编辑3：**

我认为在这个问题中作者并不是说对象是 POCO，因为如果`Category`是 POCO，那么它就不能是多态的。`CategoryA`正因为如此，继承和继承是没有意义`CategoryB`的`Category`——为什么我们想要没有多态的相同接口？！所以结论是这个问题的作者犯了一个设计错误，或者他应该考虑我的*原始*答案。

**编辑2：**

我刚刚注意到，在`Customer`我们不知道具体类型的`Category`. 所以我们不能`CategoryService`用作：

```
new CategoryService().DoSomething(customer.Category); // compile-time error 
```

所以*编辑 1*对这种情况无效。

**编辑1：**

因为`POCO`您可以使用带有方法重载的服务类：

```
public class Customer {
    public Category Category { get; set; }
}

public abstract class Category {
}

public class CategoryA : Category {
}

public class CategoryB : Category {
}

public class CategoryService {
    public void DoSomething(CategoryA c) {
        Console.WriteLine("A");
    }

    public void DoSomething(CategoryB c) {
        Console.WriteLine("B");
    }
} 
```

**原来的：**

最佳做法是使用`polymorphism`. 当您需要比较类型时，这表明您做错了什么或者这是非常特殊的情况。

```
public class Customer {
    public Category Category { get; set; }
}

public abstract class Category {
    public abstract void DoSomething();
}

public class CategoryA : Category {
    public override void DoSomething()
    {
        Console.WriteLine("A");
    }
}

public class CategoryB : Category {
    public override void DoSomething()
    {
        Console.WriteLine("B");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T13:57:33.917

根据您的情况，这有点主观。在我看来，按类型而不是按字符串进行比较总是更好，**因为您可能会错误地输入字符串**，但编译器会检查您是否输入错误的类型。在选项 2 和 3 之间，除了使用选项 2 跳过第二次演员表之外，真的没有什么关系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T13:57:35.773

选项 2 总是比选项 3 好，因为它节省了第二次施法。因此，我们可以排除选项 3。

至于选项 1，我不得不问你为什么要在属性中复制类型名称？这是多余的代码（因为您已经有了类型名称）。

因此，考虑到您所描述的情况，选项 2 是最好的。但是，关于您正在检查的内容、更改的可能性、类别名称与类名称的关联程度等的更多细节可能会影响决定......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-30T14:36:22.113

为什么不在父类中实现这样的覆盖方法：

```
public override bool Equals(System.Object obj)
{
    bool equal=true;

    //any kind of business logic here on the object values andor types

    return equal;
} 
```

我们一直这样做，效果很好:)

# css - CSS 三角形边框使用 :after 伪选择器渲染错误

> ID：13646607
> 
> 赞同：0
> 
> 时间：2012-11-30T13:53:26.377
> 
> 标签：css, geometry, border

在 Firefox 和 IE 中，当我使用带有伪选择器的 CSS 边框三角形解决方案时，`:after`边框看起来会磨损。请参阅此图像进行比较：

![网络套件](../Images/9bb6917de9784b9227078dfc3d877959.png)
![三角形效果图](../Images/19dbf07221e645aef0b98a1ea5cc7763.png)

这是来自 Chrome 和 Firefox。相关代码如下：

```
li.active::after {
   content: "";
   width: 0;
   height: 0;
   position: absolute;
   bottom: -8px;
   left: 40%;
   border-style: solid;
   border-width: 8px 10px 0 10px;
   border-color: #FFF200 transparent transparent transparent;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:33:14.783

该问题是由 Firefox 使用锯齿呈现对角线的方式引起的。最简单的解决方法是简单地稍微改变三角形的形状，使所有边框宽度都相同，然后向上移动以补偿大小的差异。

```
li.active::after {
   content: "";
   width: 0;
   height: 0;
   position: absolute;
   bottom: -6px;
   left: 40%;
   border-style: solid;
   border-width: 10px 10px 0 10px;
   border-color: #FFF200 transparent transparent transparent;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T08:47:19.157

您可以尝试使用以下方法更改透明：

rgba(255,242,0,0)

这对我有用。

# azure - Microsoft.WindowsAzure.Storage 与 Microsoft.WindowsAzure.StorageClient

> ID：13646612
> 
> 赞同：31
> 
> 时间：2012-11-30T13:53:56.713
> 
> 标签：azure, azure-storage, azure-table-storage, azure-sdk-.net

这两个程序集有什么区别，我应该什么时候使用它们？我发现它们之间存在类名冲突，所以我想我应该只使用一个。

**例子**
`Microsoft.WindowsAzure.Storage`有`Microsoft.WindowsAzure.Storage.Table.CloudTableClient`

`Microsoft.WindowsAzure.StorageClient`有`Microsoft.WindowsAzure.StorageClient.CloudTableClient`

这似乎非常令人困惑。我无法想象微软打算将它们都用于同一个项目。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-11-30T14:03:55.353

Microsoft.WindowsAzure.Storage 是存储客户端库的 2.0 版，而 Microsoft.WindowsAzure.StorageClient 是旧版本。库的 2.0 版有很多变化（其中一些是破坏性的）。如果您是新手，我实际上建议您使用该库的 2.0，因为我发现它比旧版本更直观且易于使用。如果您有一个使用 1.7 版本库的应用程序，那么在您决定升级之前，我实际上建议您阅读以下 Windows Azure 存储团队的博客文章：

[http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/introducing-windows-azure-storage-client-library-2-0-for-net-and-windows-runtime.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/introducing-windows-azure-storage-client-library-2-0-for-net-and-windows-runtime.aspx)

[http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/windows-azure-storage-client-library-2-0-break-changes-amp-migration-guide.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/windows-azure-storage-client-library-2-0-breaking-changes-amp-migration-guide.aspx)

[http://blogs.msdn.com/b/windowsazurestorage/archive/2012/11/06/windows-azure-storage-client-library-2-0-tables-deep-dive.aspx](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/11/06/windows-azure-storage-client-library-2-0-tables-deep-dive.aspx)

但是请注意，您的应用程序可能仍在使用某些组件，这些组件依赖于存储客户端库 1.7。Windows Azure 诊断程序就是其中之一。所以有一段时间你需要同时使用这两个版本。好消息是您可以在项目中同时使用这两个版本。

希望这可以帮助。

**编辑**：

我还写了一些关于将代码从存储客户端库 1.7 迁移到 2.0 的博客文章，其中介绍了一些基本场景。你可以在这里阅读这些帖子：

**迁移 blob 存储代码**： http: [//gauravmantri.com/2012/11/28/storage-client-library-2-0-migrating-blob-storage-code/](http://gauravmantri.com/2012/11/28/storage-client-library-2-0-migrating-blob-storage-code/)

**迁移队列代码**： http: [//gauravmantri.com/2012/11/24/storage-client-library-2-0-migrating-queue-storage-code/](http://gauravmantri.com/2012/11/24/storage-client-library-2-0-migrating-queue-storage-code/)

**迁移表存储代码**： http: [//gauravmantri.com/2012/11/17/storage-client-library-2-0-migrating-table-storage-code/](http://gauravmantri.com/2012/11/17/storage-client-library-2-0-migrating-table-storage-code/)

# java - 通过 3g 网络同步播放的最佳方式

> ID：13646618
> 
> 赞同：2
> 
> 时间：2012-11-30T13:54:21.820
> 
> 标签：java, android, mobile, time

我正在尝试找出一种在 2+ 移动 android 设备上同步节奏播放的方法。

在 WiFi / LAN 上实现良好的精度很简单（非常低的延迟），但我需要一个针对具有可变高延迟的 3G 网络的良好解决方案。

我想出的一个想法是发送和定时消息并使用平均时间跨度来补偿延迟，但这个想法似乎很荒谬，我有点确定还有更好的其他方法来解决这个问题..

关心帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:06:25.630

我首先会尝试在您可以用作参考的所有设备上创建一个尽可能接近的同步时钟。

当设备进行通信时，它们总是会在消息中包含本地同步时间，这样您就可以始终找出收到消息的时间和发送消息的时间之间的差异，并且始终知道消息表明您应该播放节拍的时间在所有设备上都是相同的。

这里真正的困难是同步手表。我将从阅读这篇文章开始[http://en.wikipedia.org/wiki/Network_Time_Protocol](http://en.wikipedia.org/wiki/Network_Time_Protocol)

这里有一个基于 JAVA 的 NTP 客户端：http: [//commons.apache.org/net/examples/ntp/NTPClient.java](http://commons.apache.org/net/examples/ntp/NTPClient.java)

如果你让它工作，世界上有许多 NTP 服务器。 [http://www.pool.ntp.org/en/use.html](http://www.pool.ntp.org/en/use.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:03:21.217

如果您的设备足够靠近，您可以查看是否能够使用蓝牙来加速对等同步，同时使用 NTP 来获取全球时间——可能通过在您的设备中添加蓝牙连接的电话作为额外的遥控器NTP 配置。这将需要配对最终用户设备，这对您来说可能是个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:40:25.023

我最近实际上试图自己解决同样的问题。我找到的最佳解决方案是 NTP（网络时间协议）。

主要缺点是在高延迟网络上同步可能需要很长时间。因此，在需要同步设备之前，您需要有一个运行了很长时间的应用程序。

我正在开发的应用程序尚未以完美的时间进行测试，因此我不能保证这是一个可行的解决方案。但值得一试。

# c++ - 如何使用 C++ 在 Windows 中获取 MAC 地址？

> ID：13646621
> 
> 赞同：16
> 
> 时间：2012-11-30T13:54:40.870
> 
> 标签：c++, windows, mac-address

我需要一些有关 MAC 地址的帮助。我必须通过在 C++ 中使用一些代码来获得它，所以有人可以帮助我吗？我已经尝试了很多无用的代码。如果存在我应该研究查找 MAC 地址的任何特定方法或库，如果有人通过我的链接或其他内容了解更多信息，我将非常高兴。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-03T17:08:57.203

我明白了人！我和工作中的一个人使用以下代码解决了这个问题：

```
#include <stdio.h>
#include <Windows.h>
#include <Iphlpapi.h>
#include <Assert.h>
#pragma comment(lib, "iphlpapi.lib")

char* getMAC();

int main(){ 
  char* pMac = getMAC();
  system("pause");
  free(pMac);
}
char* getMAC() {
  PIP_ADAPTER_INFO AdapterInfo;
  DWORD dwBufLen = sizeof(IP_ADAPTER_INFO);
  char *mac_addr = (char*)malloc(18);

  AdapterInfo = (IP_ADAPTER_INFO *) malloc(sizeof(IP_ADAPTER_INFO));
  if (AdapterInfo == NULL) {
    printf("Error allocating memory needed to call GetAdaptersinfo\n");
    free(mac_addr);
    return NULL; // it is safe to call free(NULL)
  }

  // Make an initial call to GetAdaptersInfo to get the necessary size into the dwBufLen variable
  if (GetAdaptersInfo(AdapterInfo, &dwBufLen) == ERROR_BUFFER_OVERFLOW) {
    free(AdapterInfo);
    AdapterInfo = (IP_ADAPTER_INFO *) malloc(dwBufLen);
    if (AdapterInfo == NULL) {
      printf("Error allocating memory needed to call GetAdaptersinfo\n");
      free(mac_addr);
      return NULL;
    }
  }

  if (GetAdaptersInfo(AdapterInfo, &dwBufLen) == NO_ERROR) {
    // Contains pointer to current adapter info
    PIP_ADAPTER_INFO pAdapterInfo = AdapterInfo;
    do {
      // technically should look at pAdapterInfo->AddressLength
      //   and not assume it is 6.
      sprintf(mac_addr, "%02X:%02X:%02X:%02X:%02X:%02X",
        pAdapterInfo->Address[0], pAdapterInfo->Address[1],
        pAdapterInfo->Address[2], pAdapterInfo->Address[3],
        pAdapterInfo->Address[4], pAdapterInfo->Address[5]);
      printf("Address: %s, mac: %s\n", pAdapterInfo->IpAddressList.IpAddress.String, mac_addr);
      // print them all, return the last one.
      // return mac_addr;

      printf("\n");
      pAdapterInfo = pAdapterInfo->Next;        
    } while(pAdapterInfo);                        
  }
  free(AdapterInfo);
  return mac_addr; // caller must free.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-30T14:00:21.017

C++ 没有任何内置的“MAC 地址”概念，它不是为了让 C++ 代码运行而必须存在的东西。因此，它是特定于平台的。您必须告诉我们您要为哪个平台执行此操作，并且（当然）还必须阅读与该平台匹配的文档。

如果您想以可移植的方式执行此操作，您应该寻找支持所有所需平台的合适库。

另外，请注意，一台计算机可以有任意数量的网络适配器，因此并不要求只有*一个*MAC 地址。

# deployment - Ant 提示用户输入 git 分支

> ID：13646624
> 
> 赞同：0
> 
> 时间：2012-11-30T13:54:49.997
> 
> 标签：deployment, ant

我正在使用 Ant 作为我们登台服务器的部署工具，现在我想提示正在部署他想要部署哪个分支的用户。Ant 中有没有办法显示分支并让用户通过输入数字来选择一个？就像你在很多 CLI 向导中看到的那样。

```
What branch would you like to deploy (default: master)
 [0] master
 [1] develop
 [2] feature/reporting
 [3] feature/corerefactor 
```

这可能与蚂蚁？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T01:45:30.937

看看[Ant Input 任务](https://ant.apache.org/manual/Tasks/input.html)

```
<input
  message="What branch would you like to deploy?"
  validargs="0,1,2,3"
  defaultvalue="0"
  addproperty="branch.choice"
/> 
```

为了使其与您的问题中的示例相似，`echo`首先选择。

您可以同时添加`taskname="blah"`和`input`任务`echo`以使它们在用户看来一致。

# java - Android arp表——开发题

> ID：13646625
> 
> 赞同：5
> 
> 时间：2012-11-30T13:54:51.207
> 
> 标签：java, android

我正在编写的 android 应用程序有两个问题。

我正在读取本地 arp 表`/proc/net/arp`并将 ip 和相应的 mac 地址保存在哈希图中。看我的功能。它工作正常。

```
 /**
     * Extract and save ip and corresponding MAC address from arp table in HashMap
     */
    public Map<String, String> createArpMap() throws IOException {      
        checkMapARP.clear();
        BufferedReader localBufferdReader = new BufferedReader(new FileReader(new File("/proc/net/arp")));
        String line = "";       

        while ((line = localBufferdReader.readLine()) != null) {            
            String[] ipmac = line.split("[ ]+");
            if (!ipmac[0].matches("IP")) {
                String ip = ipmac[0];
                String mac = ipmac[3];
                if (!checkMapARP.containsKey(ip)) {
                    checkMapARP.put(ip, mac);               
                }                   
            }
        }
        return Collections.unmodifiableMap(checkMapARP);
    } 
```

1.  第一个问题：

    我也在使用广播接收器。当我的应用收到状态时，`WifiManager.NETWORK_STATE_CHANGED_ACTION`我检查是否建立了与网关的连接。如果为真，我调用我的函数来读取 arp 表。但是在这个阶段系统还没有建立起arp表。有时当我收到连接状态时，arp 表仍然是空的。

    有人有解决这个问题的想法吗？

2.  第二个问题：

    我想以持久的方式保存网关的 ip 和 mac 地址。现在我正在为此使用[共享首选项](http://developer.android.com/guide/topics/data/data-storage.html)。也许最好写入内部存储？

    有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:50:41.663

对于第一个问题，您可以启动一个新线程，在休眠一段时间后或直到它有一些条目（`Runnable`使用邮箱获取地图）之后运行该方法 - 除非您需要直接使用地图，然后我认为唯一的方法是等待条目。例如（如果需要直接使用地图）：

```
public Map<String, String> createArpMap() throws IOException {      
    checkMapARP.clear();
    BufferedReader localBufferdReader = new BufferedReader(new FileReader(new File("/proc/net/arp")));
    String line = "";       
    while ((line = localBufferdReader.readLine()) == null) {
        localBufferdReader.close();
        Thread.sleep(1000);
        localBufferdReader = new BufferedReader(new FileReader(new File("/proc/net/arp")));
    }
    do {            
        String[] ipmac = line.split("[ ]+");
        if (!ipmac[0].matches("IP")) {
            String ip = ipmac[0];
            String mac = ipmac[3];
            if (!checkMapARP.containsKey(ip)) {
                checkMapARP.put(ip, mac);               
            }                   
        }
    } while ((line = localBufferdReader.readLine()) != null);
    return Collections.unmodifiableMap(checkMapARP);
} 
```

# puppet - 检查变量是否是 Puppet DSL 中的数字

> ID：13646627
> 
> 赞同：0
> 
> 时间：2012-11-30T13:54:53.827
> 
> 标签：puppet

如何检查变量是否是 Puppet DSL 中的数字？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T22:43:31.827

使用标准库中的 is_numeric 函数：[https ://github.com/puppetlabs/puppetlabs-stdlib](https://github.com/puppetlabs/puppetlabs-stdlib)

# android - 将十六进制 NDEF 消息写入 NFC 标签

> ID：13646631
> 
> 赞同：1
> 
> 时间：2012-11-30T13:55:06.050
> 
> 标签：android, tags, hex, nfc, ndef

我们可以使用十六进制表示将整个 NDEF 消息写入 NFC 标签吗？ [http://www.developer.nokia.com/Community/Wiki/Understanding_NFC_Data_Exchange_Format_(NDEF)_messages](http://www.developer.nokia.com/Community/Wiki/Understanding_NFC_Data_Exchange_Format_(NDEF)_messages)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:11:44.957

我自己没有尝试过，但是：如果无法创建十六进制消息，请使用 toBytes / toByteArray 或不使用

```
 NdefMessage(byte[] data) 
```

通过解析原始字节构造一个 NDEF 消息。考虑到十六进制只是字节的表示，这应该适合您。

更多信息 [http://developer.android.com/reference/android/nfc/NdefMessage.html](http://developer.android.com/reference/android/nfc/NdefMessage.html)

# python - Python SQLite如何获取正在执行的SQL字符串语句

> ID：13646633
> 
> 赞同：17
> 
> 时间：2012-11-30T13:55:12.837
> 
> 标签：python, sql, sqlite

假设我们有一个 SQL 语句，它只需要在对 DB 执行之前使用参数完成。例如：

```
sql = '''
      SELECT  id, price, date_out
      FROM sold_items
      WHERE date_out BETWEEN ? AND ?
      '''

database_cursor.execute(sql, (start_date, end_date)) 
```

如何获取已解析和执行的字符串？，如下所示：

```
SELECT  id, price, date_out
FROM sold_items
WHERE date_out BETWEEN 2010-12-05 AND 2011-12-01 
```

在这个简单的情况下，它不是很重要，但我还有其他更复杂的 SQL 语句，出于调试目的，我想自己在我的 sqlite 管理器中执行它们并检查结果。

提前致谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2018-03-04T21:37:37.160

更新。我从[这个网页](https://nelsonslog.wordpress.com/2016/03/18/python-sqlite3-query-logging/)了解到，从 Python 3.3 开始，您可以使用触发执行 SQL 的打印

```
connection.set_trace_callback(print) 
```

如果您想恢复到静默处理，请使用

```
connection.set_trace_callback(None) 
```

您可以使用另一个函数来代替`print`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-30T14:42:35.123

SQLite 从不实际将参数替换为 SQL 查询字符串本身；执行命令时直接读取参数值。（格式化这些值只是为了再次将它们解析为相同的值将是无用的开销。）

但是如果你想知道参数是如何用 SQL 编写的，你可以使用[`quote`函数](http://www.sqlite.org/lang_corefunc.html#quote); 像这样的东西：

```
import re
def log_and_execute(cursor, sql, *args):
    s = sql
    if len(args) > 0:
        # generates SELECT quote(?), quote(?), ...
        cursor.execute("SELECT " + ", ".join(["quote(?)" for i in args]), args)
        quoted_values = cursor.fetchone()
        for quoted_value in quoted_values:
            s = s.replace('?', quoted_value, 1)
            #s = re.sub(r'(values \(|, | = )\?', r'\g<1>' + quoted_value, s, 1)
    print "SQL command: " + s
    cursor.execute(sql, args) 
```

（如果有一个`?`不是参数的代码，即在文字字符串中，则此代码将失败。除非您使用 re.sub 版本，否则它将仅匹配 ? 在 'values (' ', ' 或 ' = ' 之后。 '\g<1>' 将文本放回 ? 之前并使用 '\g<>' 避免与以数字开头的quoted_values 发生冲突。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-31T20:33:06.597

我编写了一个函数，它只用参数填充问号。

奇怪的是，每个人都向您发送使用位置参数的方向，但没有人考虑需要记录或预览或检查全部查询。

无论如何，下面的代码假设

*   没有'？查询中不用作后置参数标记的标记。我不确定是否总是这样。
*   参数的值将用引号括起来。例如，当您使用表名的参数时，情况就不会如此。不过，这个用例不太可能。

```
 def compile_query(query, *args):
        # test for mismatch in number of '?' tokens and given arguments
        number_of_question_marks = query.count('?')
        number_of_arguments = len(args)

        # When no args are given, an empty tuple is passed
        if len(args) == 1 and (not args[0]):
            number_of_arguments = 0

        if number_of_arguments != number_of_question_marks:
            return f"Incorrect number of bindings supplied. The current statement uses {number_of_question_marks}, and there are {number_of_arguments} supplied."

        # compile query
        for a in args:
            query = query.replace('?', "'"+str(a)+"'", 1)

        return query 
```

建议用法

```
query = "INSERT INTO users (name, password) VALUES (?, ?)"

# sensitive query, we need to log this for security
query_string = compile_query(query, username, password_hash)
fancy_log_function(query_string)

# execute
cursor.execute(query, username, password_hash) 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-11-30T15:52:30.507

字符串格式化呢？

```
sql = """
  SELECT  id, price, date_out
  FROM sold_items
  WHERE date_out BETWEEN {0} AND {1} """.format(start_date, end_date)
  """
database_cursor.execute(sql) 
```

# regex - Node.js：正则表达式

> ID：13646637
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:55:27.987
> 
> 标签：regex

我在 Node.js/ 中的正则表达式遇到了一些问题

这就是我所拥有的：

```
Using pin #4
Data (40): 0x1 0xb5 0x0 0xd1 0x87
Temp =  20.9 *C, Hum = 43.7 % 
```

我想获得 Temp= 和 *C 之间的值（在这种情况下为 20.9）以及 Hum = 和 % 之间的值（在这种情况下为 43.7）。

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:31:28.520

您可以使用这些模式：

```
(?<=[ ,]?(?:Temp|Hum)\s*\=\s*)([^\s]+) 
```

或者：

```
(?:\=\s*)([^\s]+) 
```

或者：

```
(\d+(\.\d+)?)(?=\s*.?(?:C|%)) 
```

# java - maven依赖版本？

> ID：13646648
> 
> 赞同：1
> 
> 时间：2012-11-30T13:56:17.083
> 
> 标签：java, maven, pom.xml

我是新手。我有一个项目，它有一个 pom。在 pom 内部有一个依赖项，如下所示：

```
 <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>some-project</artifactId>
        <version>${originalVersion}</version>
        <scope>compile</scope>
    </dependency> 
```

我的问题是 ${originalVersion} 值来自哪里？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:59:08.410

它要么[在 pom 中的其他地方](http://maven.apache.org/pom.html#Properties)定义，在[parent-pom](http://maven.apache.org/pom.html#Inheritance)中（可以有几个，因为父母也可以有父母），或者通过[配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)（可能在其他地方定义，比如 your [`settings.xml`](http://maven.apache.org/settings.html)）。它也可以作为[命令行参数](http://www.sonatype.com/books/mvnref-book/reference/running-sect-options.html)传递给 maven，但您可能已经注意到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T13:59:55.387

`originalVersion`不是标准的 Maven 属性，因此它必须出现在其他地方，例如父 pom 中，如下所示：

```
<properties>
    <originalVersion>1.2</originalVersion>
</properties> 
```

请参阅[Maven 属性指南](http://docs.codehaus.org/display/MAVENUSER/MavenPropertiesGuide)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T13:59:33.200

它来自您的 pom.xml 中的一个属性。像这样的东西：

```
<properties>
   <originalVersion>1.0</originalVersion>
</properties> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:03:03.160

在 pom.xml 文件中查找一个`<properties>`部分，必须有一个类似`<originalVersion>...</originalVersion>`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-02T09:44:51.730

检查[Maven 教程页面](http://maven.apache.org/settings.html#Activation)`properties`上的子部分。它说，以下是引用变量的可能方法

> 1.  env.X：以“env”作为变量的前缀。将返回 shell 的环境变量。例如，${env.PATH} 包含 $path 环境变量（在 Windows 中为 %PATH%）。
> 2.  project.x：POM 中以点 (.) 表示的路径将包含相应元素的值。例如：1.0 可通过 ${project.version} 访问。
> 3.  settings.x：settings.xml 中用点 (.) 表示的路径将包含相应元素的值。例如：false 可通过 ${settings.offline} 访问。
> 4.  Java System Properties: All properties accessible via java.lang.System.getProperties() are available as POM properties, such as ${java.home}.
> 5.  x: Set within a element or an external files, the value may be used as ${someVar}.

# php - 致命错误：找不到类“RecursiveRegexIterator”

> ID：13646649
> 
> 赞同：0
> 
> 时间：2012-11-30T13:56:18.673
> 
> 标签：php, zend-framework, zend-framework2, socialengine

我最近重新安装了 SE4，在设置文件夹权限后，我不断收到以下错误：致命错误：第 248 行未找到 Class 'RecursiveRegexIterator' Adapter.php

如果任何熟悉 SocialEngine 4 的人能在这个问题上帮助我，我将不胜感激

非常感谢萨米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:50:36.637

`SE4`用途[`RecursiveRegexIterator`](http://www.php.net/manual/en/class.recursiveregexiterator.php)是 `PHP 5 >= 5.2.0`

您需要升级您的 PHP 版本才能使其正常工作....请注意`PHP 5.1.6`不再受支持。

# r - R - 混合效应模型中的均方根误差

> ID：13646654
> 
> 赞同：10
> 
> 时间：2012-11-30T13:56:24.057
> 
> 标签：r

您能否告诉我在执行混合效应模型时如何获取/计算 R 中的值 RMSE（均方根误差）

```
Data: na.omit(binh) 
       AIC      BIC    logLik
  888.6144 915.1201 -436.3072

Random effects:
 Formula: ~1 | Study
        (Intercept) Residual
StdDev:    3.304345 1.361858

Fixed effects: Eeff ~ ADF + CP + DE + ADF2 + DE2 
                Value Std.Error  DF   t-value p-value
(Intercept)  -0.66390 18.870908 158 -0.035181  0.9720
ADF           1.16693  0.424561 158  2.748556  0.0067
CP            0.25723  0.097524 158  2.637575  0.0092
DE          -36.09593 12.031791 158 -3.000046  0.0031
ADF2         -0.03708  0.011014 158 -3.366625  0.0010
DE2           4.77918  1.932924 158  2.472513  0.0145
 Correlation: 
     (Intr) ADF    CP     DE     ADF2  
ADF  -0.107                            
CP   -0.032  0.070                     
DE    0.978 -0.291 -0.043              
ADF2  0.058 -0.982 -0.045  0.250       
DE2  -0.978  0.308  0.039 -0.997 -0.265

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.28168116 -0.45260885  0.06528363  0.57071734  2.54144168 

Number of Observations: 209
Number of Groups: 46 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-30T14:53:48.220

您没有提供用于制作模型的函数的详细信息，但他们倾向于使用相同的名称存储残差，您可以使用 进行检查`str()`，并且 RMSE 很容易从残差中计算出来：

```
#make a model
library(nlme)
r <- lme(conc ~ age, data=IGF)

#get the RMSE
r.rmse <- sqrt(mean(r$residuals^2)) 
```

在下面的评论中，Ben Bolker 指出，由模型拟合函数制作的对象应该有一个残差方法，从而可以做到这一点（尽管某些类型的模型可能会返回已转换的残差）：

```
r.rmse <- sqrt(mean(residuals(r)^2)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-06-25T11:46:05.533

可以从以下获得相同的结果：

```
library(nlme)
library(sjstats)

fit <- lmer(Yield  ~ Species + (1|Population/variety), data = df1,REML=T)
rmse(fit) 
```

# kendo-ui - 剑道菜单不会为附加项目绘制箭头图标

> ID：13646655
> 
> 赞同：0
> 
> 时间：2012-11-30T13:56:25.863
> 
> 标签：kendo-ui

为了动态地将项目添加到剑道菜单中，[在论坛中，剑道团队建议使用](http://www.kendoui.com/forums/ui/menu/need-to-create-dynamic-kendo-menu.aspx#2393407)[本示例](http://docs.kendoui.com/api/web/menu#methods)中描述的 append 方法来附加子菜单。

我已经这样做了，现在我遇到了箭头不为节点渲染的问题。在此示例中可以看到问题：http: [//jsfiddle.net/MMRCf/16/](http://jsfiddle.net/MMRCf/16/)如果您将鼠标悬停在“项目 1”上，然后单击“子项目 2”，“子项目 2”将填充一个子菜单。此子菜单缺少用于扩展节点的箭头。

也许这是一个需要报告的错误，但我不能在剑道菜单论坛上发帖。

有谁知道我如何获得箭头图标来渲染？

我认为 append 方法是可以应用修复的地方：

```
 append: function (item, referenceItem) {
        referenceItem = this.element.find(referenceItem);

        var inserted = this._insert(item, referenceItem, referenceItem.length ? referenceItem.find("> .k-group, .k-animation-container > .k-group") : null);

        each(inserted.items, function (idx) {
            inserted.group.append(this);

            var contents = inserted.contents[idx];
            if (contents) {
                $(this).append(contents);
            }

            updateArrow(this);
        });

        updateArrow(referenceItem);
        updateFirstLast(inserted.group.find(".k-first, .k-last").add(inserted.items));

        return this;
    }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:41:41.193

实际上似乎 updateArrow 功能已损坏。我已经为下一个版本更新了它，同时你也可以更新它来让它工作，从这里：

```
item.find(".k-icon").remove(); 
```

对此：

```
item.find("> .k-link > .k-icon").remove(); 
```

# cocos2d-iphone - Cocos2d：有没有办法将同一个选择器调度 n 次？

> ID：13646657
> 
> 赞同：0
> 
> 时间：2012-11-30T13:56:33.073
> 
> 标签：cocos2d-iphone, scheduler

我目前在一个对象上安排相同的选择器 n 次的解决方案是通过创建一个“messanger”类的实例数组，其中作为属性我有调用时间和我想调用的选择器的类型以及应该调用的对象引用选择器。

然后，我在添加所有这些对象的父节点类的更新方法中检查该数组。

有没有办法通过 schedule 方法做到这一点？

共享导演没有给我任何帮助的方法。我对我的解决方案相当满意，但不确定它是否是最好的解决方案。

编辑：我尝试了建议的答案，但不幸的是没有奏效。

这是代码：

```
 [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:1.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:3.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:5.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:7.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:9.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:12.0f];
     ....
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:152.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:177.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:199.0f];
    [f schedule:@selector(activateForShort) interval:0 repeat:0 delay:212.0f]; 
```

f 是一个对象，它只调用一次选择器“activateForShort”。

我尝试将间隔和重复值修改为 1，但没有奏效。

**我想要实现的是在特定时间调用它（例如1.0f，212.0f）。**

任何建议都会受到欢迎:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T09:22:12.523

如果你使用 cocos2d 2.0，你可以使用[schedule:interval:repeat:delay](http://www.learn-cocos2d.com/api-ref/latest_2.x/cocos2d-iphone/html/interface_c_c_node.html#ae12c910d6f81e4734aa575d70b3d4d45)方法。

重复参数是选择器在初始运行后再次运行的次数。即如果repeat 为10，则选择器将运行11 次。

delay 参数确定初始延迟，因此您可以让它在选择器第一次运行之前等待更长或更短。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T14:46:10.490

遗憾的是，建议的解决方案没有奏效。见编辑。

我创建了一个特定的操作类并创建了一个填充此类实例的 NSMutableArray，并且在我需要安排这些操作的类的更新方法中，我执行以下操作：

```
-(void ) update:(ccTime) delta
{
timeElapsed+=delta;

for(int i=lastButtonCallIndex; i<[callsSchedulers count]; i++ )
{
    Call * buttonCall = [callsSchedulers objectAtIndex:i];
    if (buttonCall.callingTime<timeElapsed)
    {
        if(buttonCall.called==FALSE)
        {
            [buttonCall call]; //Where the call method has a reference to the button object I wanted to activate - a Call object is initialized with this reference.
            lastButtonCallIndex++;
        }
    }
    else
    {
        break;
    }
} 
```

}

# javascript - 如何使用 Angular 处理 202、204 等代码状态？

> ID：13646660
> 
> 赞同：1
> 
> 时间：2012-11-30T13:56:45.240
> 
> 标签：javascript, angularjs

根据 Angular http API 的文档，当服务器响应状态为 400 及以上时调用“错误”方法。

这是否意味着当我想检查 202、204 ... 到 400 的状态代码时，我需要使用 If(status = 202) 、 if (status 204) ... 检查它们

没有像 GWT RPC 和 RequestFactory 中的 onViolationContrains 之类的东西吗？如果没有，你是怎么做到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T18:28:55.337

我认为响应拦截器可能是您正在寻找的。[检查http://docs.angularjs.org/api/ng.$http](http://docs.angularjs.org/api/ng.%24http)中的“响应拦截器”部分。

从链接的文档中：

> 出于**全局错误处理**、身份验证或接收响应的任何类型的同步或异步预处理的目的，希望能够在 http 请求的响应被移交给发起这些请求的应用程序代码之前拦截它们。

# android - android中的Googlemaps“无法启动活动ComponentInfo”

> ID：13646666
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:57:07.817
> 
> 标签：android, google-maps, maps, runtimeexception

我为什么要这样做？应用程序运行得很好，当我决定使用 tracaRota 方法来构建从 uma ponit 到另一个的路线时，它开始这样做并且应用程序甚至没有启动

```
11-30 10:45:28.836: E/AndroidRuntime(14114): FATAL EXCEPTION: main
11-30 10:45:28.836: E/AndroidRuntime(14114): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.aplicacaoteste1/com.example.aplicacaoteste1.Main}: java.lang.NullPointerException
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.os.Handler.dispatchMessage(Handler.java:99)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.os.Looper.loop(Looper.java:123)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread.main(ActivityThread.java:4627)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at java.lang.reflect.Method.invokeNative(Native Method)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at java.lang.reflect.Method.invoke(Method.java:521)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at dalvik.system.NativeStart.main(Native Method)
11-30 10:45:28.836: E/AndroidRuntime(14114): Caused by: java.lang.NullPointerException
11-30 10:45:28.836: E/AndroidRuntime(14114):    at com.example.aplicacaoteste1.Main.tracaRota(Main.java:167)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at com.example.aplicacaoteste1.Main.onCreate(Main.java:77)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-30 10:45:28.836: E/AndroidRuntime(14114):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
11-30 10:45:28.836: E/AndroidRuntime(14114):    ... 11 more

    package com.example.aplicacaoteste1;

import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.List;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.w3c.dom.Document;
import org.xml.sax.SAXException;

import android.content.Context;
import android.graphics.Color;
import android.graphics.drawable.Drawable;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;

public class Main extends MapActivity {

private MapController mControl;
private MapView mapV;
private LocationManager lManager;
private MyLocationOverlay myLOverlay;
private MyOverlays itemizedOverlay;

@Override
protected void onCreate(Bundle bundle) {
    super.onCreate(bundle);
    setContentView(R.layout.activity_main);

    mapV = (MapView) findViewById(R.id.mapView);
    //mapV.displayZoomControls(true);
    mapV.setBuiltInZoomControls(true);
    //mapV.setSatellite(true);

    mControl = mapV.getController();
    mControl.setZoom(5);

    lManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    lManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, new GeoUpdateHandler());

    myLOverlay = new MyLocationOverlay(this, mapV);
    mapV.getOverlays().add(myLOverlay);

    List<Overlay> mapOverlays = mapV.getOverlays();
    Drawable drawable = this.getResources().getDrawable(R.drawable.androidmarker);
    PontoTurísticos pontoTuristico = new PontoTurísticos(drawable, this);

    GeoPoint point1 = new GeoPoint(19240000,-99120000);
    OverlayItem novoPontoTuristico = new OverlayItem(point1, "Hola, Mundo!", "I'm in Mexico City!");

    GeoPoint point2 = new GeoPoint(-80535835, -348788191);
    OverlayItem novoPontoTuristico2 = new OverlayItem(point2, "SJCC!", "Olá, tudo bem?!");

    pontoTuristico.addOverlay(novoPontoTuristico);
    pontoTuristico.addOverlay(novoPontoTuristico2);
    mapOverlays.add(pontoTuristico);

    tracaRota(myLOverlay.getMyLocation(), novoPontoTuristico2.getPoint(), Color.GREEN, mapV);

    myLOverlay.runOnFirstFix(new Runnable() {

        @Override
        public void run() {
            mapV.getController().animateTo(myLOverlay.getMyLocation());

        }
    });

    //Drawable drawable = this.getResources().getDrawable(R.drawable.ic_launcher);
    //itemizedOverlay = new MyOverlays(this, drawable);
    //createMarker();

//      double lat = -8.0556;
//      double longi = 34.8911;
}

public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

protected boolean isRouteDisplayed() {
    return false;
}

public class GeoUpdateHandler implements LocationListener{

    @Override
    public void onLocationChanged(Location location) {
        int lat = (int) (location.getLatitude());
        int log = (int) (location.getLongitude());

        GeoPoint point = new GeoPoint(lat, log);
        //createMarker();
        //mControl.animateTo(point); 
        mControl.setCenter(point);

    }

    @Override
    public void onProviderDisabled(String arg0) {

    }

    @Override
    public void onProviderEnabled(String arg0) {

    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {

    }

}

//private void createMarker(){
//  GeoPoint p  = mapV.getMapCenter();
//  OverlayItem overlayitem = new OverlayItem(p, "", "");
//  itemizedOverlay.addOverlay(overlayitem);
//  if(itemizedOverlay.size() < 0){
//      mapV.getOverlays().add(itemizedOverlay);
//  }
//}

protected void onResume(){
    super.onResume();
    myLOverlay.enableMyLocation();
    myLOverlay.enableCompass();
}

protected void onPause(){
    super.onPause();
    myLOverlay.disableMyLocation();
    myLOverlay.disableCompass();
}

private void tracaRota(GeoPoint src,GeoPoint dest, int color, MapView mV) 
{ 
    // connect to map web service 
    StringBuilder urlString = new StringBuilder(); 
    urlString.append("http://maps.google.com/maps?f=d&hl=en"); 
    urlString.append("&saddr=");//from 
    urlString.append( Double.toString((double)src.getLatitudeE6()/1.0E6 )); 
    urlString.append(","); 
    urlString.append( Double.toString((double)src.getLongitudeE6()/1.0E6 )); 
    urlString.append("&daddr=");//to 
    urlString.append( Double.toString((double)dest.getLatitudeE6()/1.0E6 )); 
    urlString.append(","); 
    urlString.append( Double.toString((double)dest.getLongitudeE6()/1.0E6 )); 
    urlString.append("&ie=UTF8&0&om=0&output=kml"); 
    //Log.d("xxx","URL="+urlString.toString()); 
    // get the kml (XML) doc. And parse it to get the coordinates(direction route). 
    Document doc = null; 
    HttpURLConnection urlConnection= null; 
    URL url = null; 
    try 
    { 
        url = new URL(urlString.toString()); 
        urlConnection=(HttpURLConnection)url.openConnection(); 
        urlConnection.setRequestMethod("GET"); 
        urlConnection.setDoOutput(true); 
        urlConnection.setDoInput(true); 
        urlConnection.connect(); 

        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance(); 
        DocumentBuilder db = dbf.newDocumentBuilder(); 
        doc = db.parse(urlConnection.getInputStream()); 

        if(doc.getElementsByTagName("GeometryCollection").getLength()>0) 
        { 
            //String path = doc.getElementsByTagName("GeometryCollection").item(0).getFirstChild().getFirstChild().getNodeName(); 
            String path = doc.getElementsByTagName("GeometryCollection").item(0).getFirstChild().getFirstChild().getFirstChild().getNodeValue() ; 
            //Log.d("xxx","path="+ path); 
            String [] pairs = path.split(" "); 
            String[] lngLat = pairs[0].split(","); // lngLat[0]=longitude lngLat[1]=latitude lngLat[2]=height 
            // src 
            GeoPoint startGP = new GeoPoint((int)(Double.parseDouble(lngLat[1])*1E6),(int)(Double.parseDouble(lngLat[0])*1E6)); 
            mV.getOverlays().add(new pontosRota(startGP,startGP,1)); 
            GeoPoint gp1; 
            GeoPoint gp2 = startGP; 
            for(int i=1;i<pairs.length;i++) // the last one would be crash 
            { 
                lngLat = pairs[i].split(","); 
                gp1 = gp2; 
                // watch out! For GeoPoint, first:latitude, second:longitude 
                gp2 = new GeoPoint((int)(Double.parseDouble(lngLat[1])*1E6),(int)(Double.parseDouble(lngLat[0])*1E6)); 
                mV.getOverlays().add(new pontosRota(gp1,gp2,2,color)); 
                //Log.d("xxx","pair:" + pairs[i]); 
            } 
            mV.getOverlays().add(new pontosRota(dest,dest, 3)); // use the default color 
        } 
    } 
    catch (MalformedURLException e) 
    { 
        e.printStackTrace(); 
    } 
    catch (IOException e) 
    { 
        e.printStackTrace(); 
    } 
    catch (ParserConfigurationException e) 
    { 
        e.printStackTrace(); 
    } 
    catch (SAXException e) 
    { 
        e.printStackTrace(); 
    } 
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T17:30:11.230

似乎在这条线上：

```
tracaRota(myLOverlay.getMyLocation(), novoPontoTuristico2.getPoint(), Color.GREEN, mapV); 
```

`mLOverlay.getMyLocation`返回空值。

尝试将其移入`myLOverlay.runOnFirstFix runner`

# android - Android：securityException：“目标必须在外部存储上”

> ID：13646669
> 
> 赞同：7
> 
> 时间：2012-11-30T13:57:14.947
> 
> 标签：android, mobile, securityexception

我已经彻底搜索了网络以找到答案，但没有结果。

我在我的 Android 应用程序中实现了一些“首选项”，包括将文件保存在您想要的任何位置的能力。

如果我在所谓的“集成 sdcard”上选择一条路径，则一切正常。但是我也有一个“真正的”外部 sdcard，它（在我的情况下）以符号链接的形式安装`/storage/sdcard1`到`/extSdCard`and `/mnt/extSdCard`（而“内部”sdcard`/storage/sdcard0`带有符号链接到`/sdcard`and `/mnt/sdcard`）。

在 ICS 上，我有外部`/emmc`链接以及一些我不记得的链接。

问题是，如果我选择指向 this 的路径`extSdCard`，应用程序会创建文件夹结构，但不会写入下载的文件，以“SecurityException”“目标必须在外部存储上”结尾。

但是这条路径在外部存储上！更多：如果写入权限有问题，为什么要创建文件夹？（`android.permission.WRITE_EXTERNAL_STORAGE`存在于清单中）。

很可能我做错了什么；或者可能是一些错误？

日食日志：

```
11-30 11:58:29.143: D/ShareActivity(24752): doInBackground...
11-30 11:58:33.813: D/ShareActivity(24752): The response is: 200
11-30 11:58:50.283: D/ShareActivity(24752): location: Downloads
11-30 11:58:50.443: D/ShareActivity(24752): User defined folders created
11-30 11:58:50.443: D/ShareActivity(24752): path: /storage/sdcard1/temp
11-30 11:59:07.053: D/ShareActivity(24752): downloadUri: file:/storage/sdcard1/temp/test.3gpp
11-30 11:59:07.313: D/AndroidRuntime(24752): Shutting down VM
11-30 11:59:07.318: W/dalvikvm(24752): threadid=1: thread exiting with uncaught exception (group=0x41ce3300)
11-30 11:59:07.318: E/AndroidRuntime(24752): FATAL EXCEPTION: main
11-30 11:59:07.318: E/AndroidRuntime(24752): java.lang.SecurityException: Destination must be on external storage: file:/storage/sdcard1/temp/test.3gpp
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.os.Parcel.readException(Parcel.java:1425)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:188)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:140)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.content.ContentProviderProxy.insert(ContentProviderNative.java:420)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.content.ContentResolver.insert(ContentResolver.java:864)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.app.DownloadManager.enqueue(DownloadManager.java:904)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at dentex.youtube.downloader.ShareActivity$AsyncDownload$1$1.onClick(ShareActivity.java:269)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:166)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.os.Handler.dispatchMessage(Handler.java:99)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.os.Looper.loop(Looper.java:137)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at android.app.ActivityThread.main(ActivityThread.java:4931)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at java.lang.reflect.Method.invokeNative(Native Method)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at java.lang.reflect.Method.invoke(Method.java:511)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
11-30 11:59:07.318: E/AndroidRuntime(24752):    at dalvik.system.NativeStart.main(Native Method)
11-30 11:59:09.248: I/Process(24752): Sending signal. PID: 24752 SIG: 9 
```

相关代码：

```
lv.setOnItemClickListener(new OnItemClickListener() {

            private File userFolder;

                public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

                String location = settings.getString("download_locations", "Downloads");
                Log.d(DEBUG_TAG, "location: " + location);

                boolean userLocationEnabled = settings.getBoolean("enable_user_location", false);

                if (userLocationEnabled == false) {
                    if (location.equals("DCIM") == true) {
                        path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DCIM);
                    }
                    if (location.equals("Movies") == true) {
                        path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_MOVIES);
                    } 
                    if (location.equals("Downloads") == true) {
                        path = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS);
                    }
                    Log.d(DEBUG_TAG, "path: " + path);
                } else {
                        userFolder = new File(settings.getString("user_location", ""));
                        path = userFolder;
                }

                Log.d(DEBUG_TAG, "path: " + path.toString());

                pos = position;
                AlertDialog.Builder helpBuilder = new AlertDialog.Builder(ShareActivity.this);

                helpBuilder.setIcon(android.R.drawable.ic_dialog_info);
                helpBuilder.setTitle("Confirm Download for:");
                helpBuilder.setMessage(" *** msg *** ");

                helpBuilder.setPositiveButton("Download here", new DialogInterface.OnClickListener() {

                    @TargetApi(11)
                    public void onClick(DialogInterface dialog, int which) {
                        mLink = links[pos];
                        downloadManager = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);

                        Request request = new Request(Uri.parse(mLink));
                        uri = Uri.parse(path.toURI() + title + "." + mExt);
                        Log.d(DEBUG_TAG, "downloadUri: " + uri);
                        request.setDestinationUri(uri);
                        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
                            request.allowScanningByMediaScanner();
                            request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
                        }

                        if (isExternalStorageWritable() == true) {
                            enqueue = downloadManager.enqueue(request);
                        }
                    }
                });

                helpBuilder.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                   //...
                });

                AlertDialog helpDialog = helpBuilder.create();
                helpDialog.show();

            }
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-07T13:25:30.310

根据Jeremy Meiss ( **jerdog** )的[THIS ARTICLE和](https://www.xda-developers.com/android/android-3-2-code-inadvertently-preventing-write-access-to-external-storage/)**Chainfire的**[THIS LINK](http://www.chainfire.eu/articles/113/Is_Google_blocking_apps_writing_to_SD_cards_/)，这种行为目前应该是“正常的”。应该需要 WRITE_MEDIA_STORAGE 权限，但这仅授予系统应用程序。

 ****作为一种解决方法，在我的活动中，我这样处理`SecurityException`（在伪代码中）：

```
Intent intent = new Intent(MyActivity.this, DownloadsService.class);

try {
    intent.putExtra("COPY", false);
    enqueue = dm.enqueue(request);
    Log.d(DEBUG_TAG, "_ID " + enqueue + " enqueued");
} catch (SecurityException e) {
    Log.w(DEBUG_TAG, e.getMessage());

    // handle the path on etxSdCard here:
    showSomeInfo();
    intent.putExtra("COPY", true);
    tempDownloadToSdcard(request);
}

startService(intent); 
```

在`DownloadsService`我有一个 BroadcastReceiver 来处理完成的下载；在其中`onStartCommand`我检索布尔额外为：

```
doCopy = intent.getBooleanExtra("COPY", false); 
```

然后在接收器内部：

```
if (doCopy) copyFileToExtSdCard(); 
```

希望这可以澄清和帮助。****

# regex - PCRE正则表达式匹配字符串的第一个字母

> ID：13646672
> 
> 赞同：1
> 
> 时间：2012-11-30T13:57:22.977
> 
> 标签：regex, mongodb, pcre

您能否指出一个仅匹配字符串的第一个字母的 PCRE RegEx。我需要传递给 Mongo DB，我担心我正在使用`^a`.

例子：

**匹配**

苹果

鳄鱼

**不匹配**

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T13:59:34.360

PCRE 中有特殊的标记来表示字符串的开头和结尾

```
/^a/ => will match all strings that start with "a" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T13:59:09.427

您可以使用字符串[anchor](http://www.regular-expressions.info/anchors.html) `^`的开头。

```
^a 
```

# php - 在视图中包含其他视图的最佳方法

> ID：13646679
> 
> 赞同：-1
> 
> 时间：2012-11-30T13:57:57.350
> 
> 标签：php, codeigniter

我有一个用 mvc Codeigniter 编写的网站。我希望在特定位置的视图中调用另一个视图，因为例如菜单在许多页面中重复并且对所有人都是相同的。

在我的控制器中，我写了这个：

```
public function home()
    {
      $data['menu_function'] = $this->load->view('backend/include/menu_function_view');
      $data['menu'] = $this->load->view('backend/include/menu_view');
      $this->load->view('backend/include/header_view_logged');
      $this->load->view('backend/home_view',$data);
      $this->load->view('backend/include/footer_view');
    } 
```

进入我的 home_view

```
<?php 
echo($menu_function);
?>
<div id="page">
    <?php 
    echo($menu);
    ?>
     <div id="content">
.... 
```

问题是 $menu 中的内容不在表单页面中。我在firebug中看到html是这样的：

```
<div id="menu">
...
</div>
   <div id="page">
    ...
   </div> 
```

代替：

```
<div id="page">
     <div id="menu">
      ...
     </div>
   </div> 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:15:17.143

不知道这是否是最好的方法，但通常我用来创建在其中加载视图的模板文件。这里的基本思想：

在文件夹视图中，我创建了包含以下内容的文件 template.php：

```
$this->load->view('includes/header');
$this->load->view( $main_content );
$this->load->view('includes/footer'); 
```

然后我创建文件夹视图/包含，其中包含：

文件`header.php and footer.php`

在控制器中我调用：

```
$data['main_content'] = 'user/dashboard';
$this->load->view('template', $data); 
```

编辑：菜单问题

将诸如 $menu_config 之类的数据传递给您的标题或视图模板怎么样。

头文件.php

```
<html>
<head>
    <title>$title</title>
</head>
<body>

<?php 
    if($menu_position == 'top1') { 
        $this->load->view($menu);
    }
?> 
```

在控制器上：

```
$data['main_content'] = 'user/dashboard';
$data['menu'] = 'top_menu';
$data['menu_position'] = 'top1';
$this->load->view('template', $data); 
```

# ios - 将 UIWeb 页面渲染为屏幕外的 OpenGL 纹理

> ID：13646680
> 
> 赞同：3
> 
> 时间：2012-11-30T13:57:59.237
> 
> 标签：ios, opengl-es

这个问题已经被问过好几次了，但我相信我可能错过了一些东西。我想将 UIWebView 渲染为 2D 纹理并使用 OpenGL 将其绘制为 3D。全部在 iOS 上。

所以主要思想是使用 CALayer 上可用的 renderInContext 函数。但是，这不起作用（至少在 iOS 5 上），除非您将视图添加到窗口并因此显示 ui(web) 视图。任何机构都会有解决方案来避免这种情况。在实践中，UIWebview 作为 UIView 和 renderInContext 渲染两次。

我已经尝试过 drawRect 方法，但是这个函数只在 UIView 显示时被调用......

# javascript - Firefox 中的绿色与 Chrome 中的颜色不同吗？

> ID：13646685
> 
> 赞同：0
> 
> 时间：2012-11-30T13:58:25.133
> 
> 标签：javascript, html5-canvas, rgba

我在 MS Paint 中制作了一个 0x00FF00 (RGB) 像素。出于某种原因，Mozilla Firefox 将其解释为 0x01FF00FF，而 Chrome 将其解释为 0x00FF00FF。（在 RGBA 中）。

只是我，它是一个错误，还是一个预期的功能？

# c++ - ACE_Mutex 从不调用 pthread_mutex_destroy

> ID：13646686
> 
> 赞同：2
> 
> 时间：2012-11-30T13:58:29.490
> 
> 标签：c++, pthreads, ace

在我的代码中，我`ACE_Mutex`在具有 pthread 的系统 (QNX) 上使用 ACE 库。现在我遇到了一个问题，它的析构函数`ACE_Mutex`似乎没有调用`pthread_mutex_destroy`. 当初始化相同内存位置的后续互斥体时，这会带来麻烦，因为`pthread_mutex_init`返回`errno=16`( `EBUSY`)。

`ACE_Mutex::remove`查看（在[Mutex.inl](http://doxygen.theaceorb.nl/libace-doc/a01466_source.html)中）的代码，我看到一组奇怪的预编译器指令：

```
ACE_INLINE int
ACE_Mutex::remove (void)
{
// ACE_TRACE ("ACE_Mutex::remove");
  int result = 0;
#if defined (ACE_HAS_PTHREADS) || defined (ACE_HAS_STHREADS)
  // In the case of a interprocess mutex, the owner is the first
  // process that created the shared memory object. In this case, the
  // lockname_ pointer will be non-zero (points to allocated memory
  // for the name).  Owner or not, the memory needs to be unmapped
  // from the process.  If we are the owner, the file used for
  // shm_open needs to be deleted as well.
  if (this->process_lock_)
    {
      if (this->removed_ == false)
        {
          this->removed_ = true;
          // Only destroy the lock if we're the ones who initialized
          // it.
          if (!this->lockname_)
            ACE_OS::munmap ((void *) this->process_lock_,
                            sizeof (ACE_mutex_t));
          else
            {
              result = ACE_OS::mutex_destroy (this->process_lock_);
              ACE_OS::munmap ((void *) this->process_lock_,
                              sizeof (ACE_mutex_t));
              ACE_OS::shm_unlink (this->lockname_);
              ACE_OS::free (
                static_cast<void *> (
                  const_cast<ACE_TCHAR *> (this->lockname_)));
            }
        }
    }
  else
  {
#else /* !ACE_HAS_PTHREADS && !ACE_HAS_STHREADS */
    if (this->removed_ == false)
      {
        this->removed_ = true;
        result = ACE_OS::mutex_destroy (&this->lock_);
      }
#endif /* ACE_HAS_PTHREADS || ACE_HAS_STHREADS */
#if defined (ACE_HAS_PTHREADS) || defined (ACE_HAS_STHREADS)
  }
#endif /* ACE_HAS_PTHREADS || ACE_HAS_STHREADS */
  return result;
} 
```

具体来说，我不明白为什么调用`ACE_OS::mutex_destroy`是有条件的，因此在启用 pthread 时不会调用。这有效地使`remove`非进程间互斥体的方法为空体。有人可以解释这段代码的基本原理吗？

# java - 在 Google Analytics（分析）数据查询过滤器中通过 OR、AND 运算符组合两个条件集

> ID：13646687
> 
> 赞同：2
> 
> 时间：2012-11-30T13:58:31.050
> 
> 标签：java, google-analytics, google-analytics-api

我想在 Google Analytics（分析）数据查询过滤器中组合两组单独的条件，例如 (A) OR (B AND c AND d) 这就是我想要的

**排除所有访问：**

```
*coming from the US* 
```

**或者**

```
*`coming from source=xyz AND medium=pqr AND keyword contaning 'abc'`* 
```

我目前正在尝试使用此查询，但它不起作用

*`"a:country!=United States,ga:source!=xyz;ga:medium!=pqr;ga:keyword!=abc"`*

这个你能帮我吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T12:18:50.997

我得到了答案，只需将细分和过滤条件设置如下

```
segment = dynamic::ga:country!=United States 
```

和

```
filter = ga:source!=xyz,ga:medium!=pqr,ga:keyword!=key1;ga:keyword!=key2 
```

这对我有用，谢谢大家

# php - 如何从访客那里获得真实 IP？

> ID：13646690
> 
> 赞同：103
> 
> 时间：2012-11-30T13:58:40.807
> 
> 标签：php, ip

我正在使用这个 PHP 代码来获取访问者的 IP 地址：

```
<?php echo $_SERVER['REMOTE_ADDR']; ?> 
```

*但是，当他们使用代理时*，我无法从访问者那里获得真实的 IP 地址。在这种情况下，有什么方法可以获取访问者的 IP 地址吗？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2012-11-30T14:01:13.630

试试这个 php 代码。

```
<?PHP

function getUserIP()
{
    // Get real visitor IP behind CloudFlare network
    if (isset($_SERVER["HTTP_CF_CONNECTING_IP"])) {
              $_SERVER['REMOTE_ADDR'] = $_SERVER["HTTP_CF_CONNECTING_IP"];
              $_SERVER['HTTP_CLIENT_IP'] = $_SERVER["HTTP_CF_CONNECTING_IP"];
    }
    $client  = @$_SERVER['HTTP_CLIENT_IP'];
    $forward = @$_SERVER['HTTP_X_FORWARDED_FOR'];
    $remote  = $_SERVER['REMOTE_ADDR'];

    if(filter_var($client, FILTER_VALIDATE_IP))
    {
        $ip = $client;
    }
    elseif(filter_var($forward, FILTER_VALIDATE_IP))
    {
        $ip = $forward;
    }
    else
    {
        $ip = $remote;
    }

    return $ip;
}

$user_ip = getUserIP();

echo $user_ip; // Output IP address [Ex: 177.87.193.134]

?> 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-11-30T14:08:55.413

这是我见过的最常见的技术：

```
function getUserIP() {
    if( array_key_exists('HTTP_X_FORWARDED_FOR', $_SERVER) && !empty($_SERVER['HTTP_X_FORWARDED_FOR']) ) {
        if (strpos($_SERVER['HTTP_X_FORWARDED_FOR'], ',')>0) {
            $addr = explode(",",$_SERVER['HTTP_X_FORWARDED_FOR']);
            return trim($addr[0]);
        } else {
            return $_SERVER['HTTP_X_FORWARDED_FOR'];
        }
    }
    else {
        return $_SERVER['REMOTE_ADDR'];
    }
} 
```

请注意，它并不能保证您将始终获得正确的用户 IP，因为有很多方法可以隐藏它。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-03-03T23:36:53.647

这是我的方法：

```
 function getRealUserIp(){
    switch(true){
      case (!empty($_SERVER['HTTP_X_REAL_IP'])) : return $_SERVER['HTTP_X_REAL_IP'];
      case (!empty($_SERVER['HTTP_CLIENT_IP'])) : return $_SERVER['HTTP_CLIENT_IP'];
      case (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) : return $_SERVER['HTTP_X_FORWARDED_FOR'];
      default : return $_SERVER['REMOTE_ADDR'];
    }
 } 
```

如何使用：

```
$ip = getRealUserIp(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-30T13:59:33.903

代理可能会发送`HTTP_X_FORWARDED_FOR`标头，但即使是可选的。

还要记住，访问者可能会共享 IP 地址；大学网络、大公司和第三世界/低预算的 ISP 倾向于与许多用户共享 IP。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-02-22T08:51:15.313

应用此代码获取 IP 地址：

```
 if (getenv('HTTP_X_FORWARDED_FOR')) { $pipaddress = getenv('HTTP_X_FORWARDED_FOR');
 $ipaddress = getenv('REMOTE_ADDR'); 
    echo "Your Proxy IP address is : ".$pipaddress. "(via $ipaddress)" ; } 
    else { $ipaddress = getenv('REMOTE_ADDR'); echo "Your IP address is : $ipaddress"; }
    ------------------------------------------------------------------------ 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-05-02T12:47:33.680

This is my function.

benefits :

*   Work if $_SERVER was not available.
*   Filter private and/or reserved IPs;
*   Process all forwarded IPs in X_FORWARDED_FOR
*   Compatible with CloudFlare
*   Can set a default if no valid IP found!
*   Short & Simple !

* * *

```
/**
 * Get real user ip
 *
 * Usage sample:
 * GetRealUserIp();
 * GetRealUserIp('ERROR',FILTER_FLAG_NO_RES_RANGE);
 * 
 * @param string $default default return value if no valid ip found
 * @param int    $filter_options filter options. default is FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE
 *
 * @return string real user ip
 */

function GetRealUserIp($default = NULL, $filter_options = 12582912) {
    $HTTP_X_FORWARDED_FOR = isset($_SERVER)? $_SERVER["HTTP_X_FORWARDED_FOR"]:getenv('HTTP_X_FORWARDED_FOR');
    $HTTP_CLIENT_IP = isset($_SERVER)?$_SERVER["HTTP_CLIENT_IP"]:getenv('HTTP_CLIENT_IP');
    $HTTP_CF_CONNECTING_IP = isset($_SERVER)?$_SERVER["HTTP_CF_CONNECTING_IP"]:getenv('HTTP_CF_CONNECTING_IP');
    $REMOTE_ADDR = isset($_SERVER)?$_SERVER["REMOTE_ADDR"]:getenv('REMOTE_ADDR');

    $all_ips = explode(",", "$HTTP_X_FORWARDED_FOR,$HTTP_CLIENT_IP,$HTTP_CF_CONNECTING_IP,$REMOTE_ADDR");
    foreach ($all_ips as $ip) {
        if ($ip = filter_var($ip, FILTER_VALIDATE_IP, $filter_options))
            break;
    }
    return $ip?$ip:$default;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-08T02:15:55.940

如果代理是您信任的，您可以尝试：（假设代理 IP 是`151.101.2.10`）

```
<?php

$trustProxyIPs = ['151.101.2.10'];

$clientIP  = isset($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : NULL;

if (in_array($clientIP, $trustProxyIPs)) {

    $headers = ['HTTP_CLIENT_IP', 'HTTP_X_FORWARDED_FOR'];

    foreach ($headers as $key => $header) {

        if (isset($_SERVER[$header]) && filter_var($_SERVER[$header], FILTER_VALIDATE_IP)) {

            $clientIP = $_SERVER[$header];

            break;
        }
    }
}

echo $clientIP; 
```

这将防止直接请求的客户端伪造转发头，并通过受信任的代理获取真实 IP。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-11-30T14:03:15.140

是的，`$_SERVER["HTTP_X_FORWARDED_FOR"]`这是我在我的 nginx 服务器上的代理下查看我的 ip 的方式。

但是你最好的选择是`phpinfo()`在代理下请求的页面上运行，这样你就可以查看所有可用的变量并查看带有你真实 ip 的那个是什么。

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2015-11-17T13:45:37.640

这适用于 Windows 和 Linux！不管是本地主机还是在线..

```
 function getIP() {
    $ip = $_SERVER['SERVER_ADDR'];

    if (PHP_OS == 'WINNT'){
        $ip = getHostByName(getHostName());
    }

    if (PHP_OS == 'Linux'){
        $command="/sbin/ifconfig";
        exec($command, $output);
        // var_dump($output);
        $pattern = '/inet addr:?([^ ]+)/';

        $ip = array();
        foreach ($output as $key => $subject) {
            $result = preg_match_all($pattern, $subject, $subpattern);
            if ($result == 1) {
                if ($subpattern[1][0] != "127.0.0.1")
                $ip = $subpattern[1][0];
            }
        //var_dump($subpattern);
        }
    }
    return $ip;
} 
```

# wcf - Linux 上的 WCF 服务无法通过 NetTcp 与 Windows 上的客户端通信

> ID：13646692
> 
> 赞同：1
> 
> 时间：2012-11-30T13:58:43.787
> 
> 标签：wcf, mono, nettcpbinding

那里

**上下文：** 我编写了一个演示控制台应用程序 - 一个在 Linux 上通过 mono 运行的 WCF 服务，以及一个在 Windows 7 上运行的控制台客户端。

Linux Versoin：Ubuntu 和 Match-box

单声道版本：2.10.8.1（在 Ubuntu 上）和 2.10.6（在火柴盒上）

**问题：** 客户端可以通过 basicHttpBinding**而不是**netTcpBinding 与 Service 通信。

**异常信息：** 无法连接到 net.tcp://192.168.1.220/。连接尝试持续了 00:00:14.0408031 的时间跨度。TCP错误码10060：连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应192.168.1.220:808。

**服务代码：**

```
class Program
 {
    static void Main(string[] args)
    { 
        try
        {
            ServiceHost sh = new ServiceHost(typeof(DynIPService.DynIPService));
            //sh.AddServiceEndpoint("DynIPServiceContract.IDynIPService", binding, "net.tcp://10.161.66.213:808");
            sh.Open();
            foreach (var ep in sh.Description.Endpoints)
            {
                Console.WriteLine("Address: {0}, ListenUri: {1}, ListenUriMode: {2} ", ep.Address, ep.ListenUri, ep.ListenUriMode);
            }
            Console.WriteLine("Service is running");               
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error:" + ex.Message);
            throw;
        }
        finally
        {
           Console.ReadKey();
        }
    }
} 
```

**服务 app.config**（部分，这里我只列出端点和绑定）

```
<services>
  <service name="DynIPService.DynIPService" behaviorConfiguration="MyServiceTypeBehaviors" >
    <endpoint address="net.tcp://127.0.0.1:808"  
              binding="netTcpBinding" bindingConfiguration="TCP_Binding"
              contract="DynIPServiceContract.IDynIPService"/>
    <endpoint address="http://127.0.0.1:123"
              binding="basicHttpBinding" bindingConfiguration="HTTP_Binding"
              contract="DynIPServiceContract.IDynIPService"/>
  </service>
</services>
<bindings>
  <basicHttpBinding>
    <binding name="HTTP_Binding">
      <security mode="None"></security>
    </binding>
  </basicHttpBinding>
  <netTcpBinding>
    <binding  name="TCP_Binding">
      <security mode="None"></security>
    </binding>
  </netTcpBinding>
</bindings> 
```

**客户代码：**

```
class Program
 {
    static void Main(string[] args)
    {
        //var ip = "localhost.localdomain";
        var ip = "192.168.1.220";

        //Tcp
        Binding tcpBinding = new NetTcpBinding(SecurityMode.None);
        var tcpUri = new Uri(string.Format("net.tcp://{0}:808", ip));

        //http
        Binding httpBinding = new BasicHttpBinding();  
        var httpUri = new Uri(string.Format("http://{0}:123",ip));

        EndpointAddress address = new EndpointAddress(httpUri.ToString());
        IDynIPService proxy = ChannelFactory<IDynIPService>.CreateChannel(httpBinding, address);
        var hostIP = proxy.ReadHostIp();
        Console.WriteLine(hostIP);
        Console.ReadKey();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T13:37:04.810

如果要使用 net.tcp 远程连接到主机，则需要使用在网络上公开可见的主机 IP 地址。

我刚刚在 Windows 上对此进行了测试，net.tcp 和 http 在使用时实际上表现不同`127.0.0.1`：而无论您在端点上使用哪个 IP 地址，HTTP 似乎总是在所有接口上侦听，使用特定 IP，例如`127.0.0.1`使 NetTCP 仅侦听具体地址。

但是，您可以使用`net.tcp://localhost:<port>/<path>`它来监听所有接口（这是在 Mono 2.10.10 中实现的，请参阅[bug #275](https://bugzilla.xamarin.com/show_bug.cgi?id=275)）。

因此，要么`net-tcp://localhost:808/`在您的所有接口上使用监听，要么使用（或任何机器的 IP 地址）`app.config`将其显式设置为特定的 IP 地址（在网络上公开可见）。`net-tcp://192.168.1.200:808/`

# android - Spinner：增加/减少显示项目的大小

> ID：13646693
> 
> 赞同：0
> 
> 时间：2012-11-30T13:58:49.597
> 
> 标签：android, spinner, text-size

关于如何更改微调器中条目的“文本大小”，我已经阅读了堆栈溢出中的各种帖子，但它们似乎都没有帮助。

我正在为 Galaxy Tab 10.1“模板化”我的主要布局。所以我希望我的物品显示得更大，例如在手机上。

好的，我检查了一下，90% 的人都在谈论 android:textSize="....." 但它对我不起作用（？？？）我不明白！

这是我的 xml 定义：

```
<Spinner
    android:id="@+id/spinner1"
    android:layout_width="fill_parent"
    android:layout_height="75dp"
    android:textSize="30sp"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:drawSelectorOnTop="true"
    android:contentDescription="@string/test"
    android:prompt="@string/choose_one"
    tools:listitem="@android:layout/simple_spinner_item" 
/> 
```

如您所见，我添加了 textSize 标签，甚至 textAppearance ......没有任何积极的结果......项目保持小字体，我猜是默认字体......

有想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-10T13:04:40.550

不要使用`@android:layout/simple_spinner_item`在 中呈现您`Spinner`的项目，而是创建您自己的项目布局并设置`padding`为选择项目提供空间。

例子：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE TextView>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/spinner_item_text"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="10dp"
    android:text="Example"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="30sp" >
</TextView> 
```

并且您的微调器使用此布局：

```
<Spinner
    android:id="@+id/spinner1"
    android:layout_width="fill_parent"
    android:layout_height="75dp"
    android:drawSelectorOnTop="true"
    android:contentDescription="@string/test"
    android:prompt="@string/choose_one"
    tools:listitem="@layout/your_own_spinner_item" 
/> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-30T14:01:20.680

您可以尝试添加 layout_height="wrap_content" 吗？

# excel - 属性（上下文）键在 Excel 工作表中的任何单元格上都不起作用

> ID：13646694
> 
> 赞同：0
> 
> 时间：2012-11-30T13:58:54.160
> 
> 标签：excel, vba, excel-2010, autohotkey

我的属性键在 Excel 中不再起作用：right-ctrl 和 right-windows 之间的键，显示上下文菜单（该单元格的选项列表，包括“删除评论”等）。

我的鼠标右键仍然有效。

我在可以重新分配的地方使用自动热键

```
appskey::  ;some code 
```

但是我没有在 Autohotkey 中做这个任务。我还关闭了所有正在运行的 .ahk，但问题仍然存在。所以它似乎与 Autohotkey 完全无关。

有人说他可以重新启用鼠标右键

```
Application.CommandBars("cell").Reset
Application.CommandBars("cell").Enabled = True 
```

但这也不起作用。（当然，我自己的鼠标右键单击仍然有效。）

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:21:35.323

糟糕，事情是这样的：

```
application.onkey "+{f10}", "One_Of_My_Macros" 
```

然后上下文键也被重新分配给这个宏......我删除了这段代码并且它起作用了。

# objective-c - CoreData 崩溃，主队列上下文设置为私有队列上下文的子级

> ID：13646696
> 
> 赞同：0
> 
> 时间：2012-11-30T13:58:58.050
> 
> 标签：objective-c, ios, core-data, concurrency

我的问题是这样的。我想异步保存到磁盘。设置核心数据堆栈的代码如下所示。

```
- (NSManagedObjectContext *)managedObjectContext {
NSPersistentStoreCoordinator *coordinator = self.persistentStoreCoordinator;
static dispatch_once_t onceToken;
dispatch_once(&onceToken, ^{
    NSManagedObjectContext *privateMOC = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    [privateMOC setPersistentStoreCoordinator:coordinator];
    __managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
    [__managedObjectContext setParentContext:privateMOC];

});
return __managedObjectContext;
} 
```

当我执行这样的提取时：

```
NSMutableArray *result = [NSMutableArray array];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:[DataObject entityName]
                                          inManagedObjectContext:self.managedObjectContext];

[request setEntity:entity];
[request setPredicate:[NSPredicate predicateWithFormat:@"SUBQUERY(threadEntities, $emp, $emp.thread = %@).@count>0 AND tags.@count!=0", self, nil ]];
[request setPropertiesToFetch:@[@"creationDate", @"data"]];
[request setSortDescriptors:@[[NSSortDescriptor sortDescriptorWithKey:@"creationDate" ascending:YES]]];
NSError *error = nil;

[result addObjectsFromArray:[self.managedObjectContext executeFetchRequest:request error:&error]]; 
```

它因此错误而崩溃：

```
Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM objectAtIndex:]: index 375961053 beyond bounds [0 .. 7]' 
```

另一方面，像这样的堆栈设置效果很好：

```
 - (NSManagedObjectContext *)managedObjectContext {
NSPersistentStoreCoordinator *coordinator = self.persistentStoreCoordinator;
static dispatch_once_t onceToken;
dispatch_once(&onceToken, ^{
    __managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
    [__managedObjectContext setPersistentStoreCoordinator:coordinator];
});
return __managedObjectContext;
} 
```

数据库内部有一个 DataObject 和一些用于管理它的附加对象。问题是，为什么这个 fetch 会受到影响，而应用程序之前使用相同参数执行的计数两次都有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T02:02:42.910

看起来 CoreData 内部的某些东西变得不一致，好像您也在处理错误的合并通知（使用父子时您不应该这样做，也不应该尝试！）。不幸的是，如果没有完整的堆栈跟踪，就很难重建这里发生的事情。

但是，我认为没有*理由*在 dispatch_once 块内设置主队列上下文。上下文很便宜，没有理由每次你需要一个新的子上下文时不生成一个新的子上下文 - 这是使用它们的推荐方式。[NSManagedObjectContext](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html)是：

> NSManagedObjectContext 的一个实例代表应用程序中的单个“对象空间”或便笺簿。它的主要职责是管理托管对象的集合。这些对象形成一组相关的模型对象，代表一个或多个持久存储的内部一致视图。

并与[父子](https://developer.apple.com/library/ios/releasenotes/DataManagement/RN-CoreData/index.html#//apple_ref/doc/uid/TP40010637)：

> 当您在上下文中保存更改时，更改只会“一次存储”提交。如果您保存子上下文，则会将更改推送到其父上下文。在保存根上下文之前，这些更改不会保存到持久存储中。（根托管对象上下文是其父对象为 nil 的上下文。）此外，父对象在保存之前不会从子对象中提取更改。如果要最终提交更改，则必须保存子上下文。
> 
> 嵌套上下文比以往任何时候都更重要的是，采用“传递接力棒”的方法来访问上下文（通过将上下文从一个视图控制器传递到下一个视图控制器）而不是直接从应用程序委托中检索它。

如果您想查看设置父子上下文和使用队列限制的简单示例： [https ://github.com/quellish/QueuedCoreData](https://github.com/quellish/QueuedCoreData)

# jakarta-ee - Weblogic 数据源池大小

> ID：13646698
> 
> 赞同：0
> 
> 时间：2012-11-30T13:59:00.377
> 
> 标签：jakarta-ee, weblogic, datasource, pool

我正在尝试确定 Weblogic Server 的数据源池大小。我的应用程序应该每秒接受 1000 个请求。每个请求只是简单的数据库操作，如读/写。我将数据源的最大容量设置为 100。我如何衡量这是否可以接受？有办法吗？对于我的流量测试，100 还不够，但我们的数据库管理员说它应该是最大 150。我想听听有关它的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T13:35:42.617

由于无法准确计算出每秒这 1000 个请求中有多少实际在执行数据库作业，以及有多少将处理数据，您需要从 100 个连接开始并在需要时增加它。

如果数据库任务本身很简单（如您所说），那么您无需配置大量数据库连接，但建议将池中数据库连接的最小值和最大值设置为相同。

另请注意，您在池中设置的最大连接数是每个托管服务器，因此，如果您有超过 1 个托管服务器，则 WLS 将打开池中配置的托管服务器数量 x 到数据库的最大连接数。

# python - 矢量图像的图像比较（基于边缘检测）？

> ID：13646699
> 
> 赞同：6
> 
> 时间：2012-11-30T13:59:05.477
> 
> 标签：python, image, image-processing, computer-vision, python-imaging-library

在过去的两天里，我一直在浏览帖子和示例，我尝试过并经过广泛测试的所有片段都被证明是毫无用处的，至少对我来说是这样。

我想做的是比较从墙上或纸上拍摄的黑色矢量符号（质量类似于人们可能会说的扫描不良的图像），并将其与相同或相似符号的电子版本（将存储在本地和与照片相比）。请看一下所附的两张图片，第一张干净的（参考图片）是符号的数据库版本，第二张是我在一张纸上画的蹩脚的图画，然后用我的 iPad 拍照。

![参考图像](../Images/4bd144eabe6370fc4ab12f569f09d2d0.png)

![测试图像](../Images/bf16e7dec5d4aa1fcf7071ca908f62b2.png)

我希望程序如下：

*   加载这两个图像，然后使用我在此处找到的此修剪算法的修改版本进行修剪：[使用 PIL 修剪图像](https://stackoverflow.com/questions/7528816/trim-scanned-images-with-pil)。我发现 50 的“阈值”值和 20 的“明显性”值（链接脚本中的参数）为这些图像提供了良好的结果
*   然后将图像调整为相同大小并进行比较

现在为了比较，我尝试了很多不同的建议方法，但到目前为止结果很糟糕。实际上，我可以通过随机图像获得比测试图像更好的比较结果。我已经尝试了基于实际图像的[RMS 差异比较，它们的边缘（使用 ImageFilter.CONTOUR 或 ImageFilter.FIND_EDGES 的“过滤器”函数创建），](http://code.activestate.com/recipes/577630-comparing-two-images/)[基于像素的比较](http://pythonicprose.blogspot.ch/2009/07/python-compare-two-images.html)，但到目前为止我在网上找不到任何东西（尽管我不断地谷歌搜索）或者在 StackOverflow 中给了我不错的结果。

我认为问题在于测试图像的嘈杂背景，但我无法证明这一点。有谁知道是否有办法从这些图像的边缘中获取矢量轮廓，并将它们不仅作为图像进行比较，而且作为图像矢量进行比较？尽管我的画很糟糕，但我发现这两张图片非常相似，应该可以从中得到一个很好的比较。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T21:15:39.830

为了获得更好的响应，您需要更好地限制应用程序的范围。这里有一些可以帮助你的东西。我想您的“糟糕的绘图”输入始终与您提供的输入相似，因为它具有很强的边缘，并且其上存在的颜色无关紧要。要以简单的方式解决（或者更好地接近解决方案）您的问题，您需要根据尺度不变描述符来描述这两个图像。

我对此的看法：对两个图像进行二值化，计算两个图像中的连接组件（CC）的数量，丢弃不相关大小的 CC（离中位数太远，平均值，与 stddev 相关等，你决定）。您可能想要补充第二步，以便更好地将您的图像与其他输入区分开来，即，您希望您的方法越强大，您需要的判别描述符就越多。在某些时候，您可能还想考虑使用 SVM 或其他机器学习技术。

因此，二值化步骤：执行形态梯度并丢弃弱梯度。如果输入与发布的内容相似，这将非常容易。这是我在强度为 60 时得到的阈值（我还假设您的输入在 [0, 255] 范围内）：

![在此处输入图像描述](../Images/98cb6af1e6b484db4d229d2cd35c0ca5.png) ![在此处输入图像描述](../Images/35a60f6789768e8c5cc108b783f1d3b5.png)

我很快尝试了直到 90 的阈值，所有这些阈值都适用于这些图像。裁剪这些很容易，您还可以填充背景和对象：

![在此处输入图像描述](../Images/c3588e1a03b1f5ab9b5f04baf800283e.png) ![在此处输入图像描述](../Images/ea449fe6503bab8f5215762fd4a491f8.png)

现在您可以提取白色的连接组件并对其进行分析。在这种情况下，最简单的方法就是对它们进行计数。对于这些输入，我们在“完美”图像中得到 12 个，在“坏”图像中得到 14 个。但是，在“坏”的部分中，我们有 2 个大小为 1 的组件（每个组件中只有一个像素），它们被简单地消除了。还有许多其他方法可以比较连接的组件，但我希望这可以帮助您入门。如果您需要这些任务的代码，我可以将其包含在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T15:01:12.627

我不确定如何专门使用 PIL 来做到这一点，但我可以为您指出一些很好的工作示例来帮助您自学（这是图像处理的一项重要任务！）。

一个很好的工作示例是[DeTeXify](http://detexify.kirelabs.org/classify.html)，这是一个将鼠标绘制的符号与大量已知符号库相匹配的程序（在这种情况下，符号可以在排版程序 LaTeX 中创建）。前端和后端的源代码都可用。

另一个例子是[ShapeCatcher](http://shapecatcher.com/about.html)，它：

> ... 使用所谓的“形状上下文”来查找两个形状之间的相似性。形状上下文是描述形状之间相似性概念的一种强大的数学方法，是由 Serge Belongie 和 Jitendra Malik 首次提出的特征描述符。

可以在他们的[伯克利网站](http://www.eecs.berkeley.edu/Research/Projects/CS/vision/shape/sc_digits.html)上找到关于形状上下文的免费研究论文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T11:05:59.093

有一种方法称为[SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)。OpenCV 使用它，并且在 Python OpenCV 中也有一个实现。实现是OpenCV中的SURF，各种问题和例子都能找到，效果很好。[这个](https://stackoverflow.com/questions/10984313/opencv-2-4-1-computing-surf-descriptors-in-python)问题有一个例子。

*（发布此答案作为额外参考）*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:11:58.173

我认为，如果您将线可视化为图形上的边，而将交叉点可视化为节点，即使一个很丑，计算机也应该能够看到它们是相同的符号。只需使用关卡来获得您的白人和黑人，然后尝试分析连续的黑点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-13T18:28:04.943

我知道这已经得到了回答，但也许有人仍然会找到这个。

与公认的答案不同，我不会处理梯度来执行二值化，而是查看[Otsu 的 Thresholding](http://docs.opencv.org/trunk/d7/d4d/tutorial_py_thresholding.html)。如果您的所有图像仅包含非常暗和非常亮的区域，这应该会很好，因为它会查找图像直方图中的两个峰值（一个用于所有亮像素，一个用于所有暗像素），然后在值上设置阈值两峰之间。

# algorithm - 药物输送经济学：长度 k 的最大路径？

> ID：13646704
> 
> 赞同：2
> 
> 时间：2012-11-30T13:59:10.597
> 
> 标签：algorithm, graph

我是一名毒贩，有一张运送路线图，每条路线都价值一定。但我不能覆盖整个区域，我只需要争夺我的一小块地盘。但是，我可以选择我可以争吵的地盘。

该图的顶点是街道拐角，所有街道的长度**和 1 way**相同。有些街道比其他街道更有价值。我想找到最大的步行节拍，这样我必须经过的街角数量最少。所有路径都从第 42 街地铁开始，到罗斯福岛电车结束。

我快速浏览了一下网，但似乎不像我记得在任何地方看到过的东西。

使用动态规划**在 DAG 上**计算最大重量/流量/成本路径很容易。

但是，如果我们还需要找到尽可能短的最大路径怎么办？**好吧，我们可以迭代所有长度为 k 的最大路径，以使 k 接近某个近似值。但是，如何获得长度为 k 的最大路径？**

任何想法在哪里可以找到指向这个的指针？

**编辑 1**

好的..我有一种感觉 Floyd-Warshall 可以在特定长度下完成最大路径。这可能已经足够好了，我可以在所有可能的长度上运行它。但是……有更好的主意吗？

**编辑 2**

修改为仅引用 DAG。

**编辑 3**

Floyd-Warshall 可以做特定长度的最大路径，k ：含义，将 DAG 最大路径与使用 Floyd Warshall 相结合，以获得任何顶点和终点之间的最短（以边数计）路径。因此，在最大路径算法中的任何顶点处，当当前边数（当前最大路径的）+（Floyd-Warshall 确定的）该顶点之间的最小边数之和时，终止该顶点处的搜索分支最后一站将超过我们的特定长度，k。

**编辑 4**

我想我有一个答案。

为了找到该图的长度为 k 的最大路径，我们假设对于图中的任何节点，我们知道该节点和端点之间的最小边数。

所以我们只是像这样运行最大路径算法，确保我们检查给定分支可能的最小边数是否低于我们的排除界限

在这段代码中，图是一个由它们的起始顶点索引的边的字典，每条边都是一个元组（destination_edge,weight）。该算法最大化权重，但确保它返回的路径不超过参数 k：

```
def maxpathoflength(k,start_vertex,graph_out_edges,memory,frame_size):
    # first of all we leverage dynamic programming to save any results we have checked before
    if start_vertex in memory:
        return memory[start_vertex]
    # otherwise we calculate it
    # first we set the current maximum gold at this vertex
    maxgold = 0
    # corresponding to the following maximum path
    maxpath = [start_vertex]
    #then we check to see if we have broken our k-length path constraint
    if k < 0:
        # we failed, yet somehow we should never make it to here anyway
        return { 'gold' : maxgold, 'path' : maxpath }
        # if on the other hand k were equal to zero and this was the end point
        # we would have succeeded
    # we save this size since we can use it to calculate the lower bound 
    # on the number of edges required to get to the finish from this vertex 
    graph_size = len(graph_out_edges)
    # we get the edges adjacent to start_vertex
    # they are all out_edges, the graph has the DAG property

    # the graph also has this property : there are no out edges from the last vertex :
    if start_vertex > graph_size - 1:
        return { 'gold' : maxgold, 'path' : maxpath }
    out_edges = graph_out_edges[start_vertex]
    print 'Out edges: ' + str(out_edges)
    for edge in out_edges:
        # each edge is stored as a 2-tuple (to_vertex,edge_weight)
        arrival_vertex = edge[0]
        edge_weight = edge[1]
        # the following property holds for this graph, hence we can know the lower bound on edges of any path from this vertex
        min_edges_from_arrival_vertex_to_end = ceil((1.0*graph_size - int(arrival_vertex))/frame_size)
        # and so we can determine if we want should search it or not
        if min_edges_from_arrival_vertex_to_end > k-1:
            print 'Skipping this edge'
            continue
        # or if this branch is ok
        # we search down this branch and take 1 off the edges
        # remaining
        # we search it and find the result of searching it is...
        result = maxpathoflength(k-1,arrival_vertex,graph_out_edges,memory,frame_size)  
        gold = edge_weight + result.get('gold')
        path = result.get('path') 
        # if that result is greater than our current best
        if gold > maxgold:
            # we make that result our new personal best
            maxgold = gold
            maxpath = [start_vertex] + path

    # our return value is what we found the maximum to be from this vertex
    returnvalue = { 'gold' : maxgold, 'path' : maxpath }
    # we save this so we never ever have to do this again
    memory[start_vertex] = returnvalue
    # and send it back to up to the calling function 
    return returnvalue 
```

# android - 我的应用程序下载器的奇怪 NumberFormatException

> ID：13646705
> 
> 赞同：0
> 
> 时间：2012-11-30T13:59:18.757
> 
> 标签：android, exception

我最近在 google play 中发布了一个 Android 游戏，我收到了这个**NumberFormatException的崩溃报告**

我什至指出了它来自的代码。但最让我担心的是，在我测试过的任何设备中都没有抛出异常（我已经在许多设备上测试过）。

我有一个这样排列的字符串文件...“10.48,1.6,90.0,1.155,1.73”，其中每个浮点数用逗号分隔...我不知道为什么我的应用程序的用户会发生这种奇怪的异常:(

这是我用来从文件中解析的代码

```
 while(j<line.length())
        {
            if(line.charAt(j) == ',')
            {
                endingPoint = j;
                planetList[i].add(Float.valueOf(line.substring(startingPoint, endingPoint)));
                startingPoint = j+1;
            }
            else if(line.charAt(j) == 's')
            {
                i++;
                startingPoint = j+1;
            }
            j++;
        } 
```

这是引发异常的行...

```
cam = new Camera(Float.valueOf(df.format(worldWidth)),fourPointEightFixer); 
```

这是我的应用程序的善良用户发送的堆栈跟踪：

```
java.lang.NumberFormatException
at  org.apache.harmony.luni.util.FloatingPointParser.parseFltImpl(Native Method) 
at org.apache.harmony.luni.util.FloatingPointParser.parseFloat(FloatingPointParser.java:321) 
at java.lang.Float.parseFloat(Float.java:323) 
at java.lang.Float.valueOf(Float.java:362) 
at com.OnMyOwn.Game.WackyGravity.<init>(WackyGravity.java:97) 
at com.OnMyOwn.Game.LevelChooserMod.initiateGame(LevelChooserMod.java:550) 
at com.OnMyOwn.Game.LevelChooserMod.onButtonTouchUp(LevelChooserMod.java:576) 
at com.OnMyOwn.Game.LevelChooserMod.update(LevelChooserMod.java:384) 
at com.OnMyOwn.framework.impl.GLGame.onDrawFrame(GLGame.java:165) 
at android.opengl.GLSurfaceView$GLThread.guardedRun(GLSurfaceView.java:1363) 
at android.opengl.GLSurfaceView$GLThread.run(GLSurfaceView.java:1118) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:08:21.640

如果此行导致问题：

```
cam = new Camera(Float.valueOf(df.format(worldWidth)),fourPointEightFixer); 
```

你应该用（假设`worldWidth`是浮动/双）替换它：

```
cam = new Camera(/*cast (float) if worldWidth is double*/worldWidth,fourPointEightFixer); 
```

第一：无需将此值更改为字符串并再次解析，第二：我很确定`df.format(double/float)`可以在使用逗号将 Language/Locale 设置为 Locale 的设备上以逗号作为小数分隔符返回 double/float 的字符串表示形式作为分隔符（几乎整个非英语欧洲）

或者您可以在创建/获取实例时强制语言环境`DecimalFormat`：

```
DecimalFormat df = (DecimalFormat)NumberFormat.getNumberInstance(Locale.US); 
```

我认为 Ali 提供的快速修复（捕获异常）不是好的解决方案（因为捕获预期的异常是不好的编程习惯）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:07:42.553

此问题是由语言引起的，因此请在“。”的情况下捕获此异常。并用逗号“，”替换它， **如果你使用**这样的模式“##.###”

# asp.net - 在应用程序中踢出问题

> ID：13646706
> 
> 赞同：0
> 
> 时间：2012-11-30T13:59:23.623
> 
> 标签：asp.net, c#-3.0, out

我们的应用程序已经投入生产。我们对同一应用程序进行了维护和增强。当我们的 QA 现场团队测试应用程序时（一次在同一个应用程序中多次登录），他们在一些随机场景中遇到了踢出问题。有时，很少有用户被注销并被重定向到登录页面（带有会话超时消息）。尽管会话超时尚未发生。

我们正在尝试分析errorLog文件并分析案例。

如果您有任何类似的情况和任何解决方案，请提供帮助。对于相同的。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:06:58.250

我不确定它是否是相同的场景，但我曾经遇到过一个问题，即保存为 PDF 的报告必须编写大量物理文件（图形），并且创建这么多动态文件会触发应用程序池重启。这仅在我的应用程序部署到共享服务器（托管）时发生，我不确定您的是否是，但是当我在本地部署到测试服务器时没有发生这种情况意味着存在某些策略/设置可以更改以控制应用程序池重新启动。

如果您按照以下 Scott Guthrie 的博客文章所示记录应用程序关闭事件，您可能会发现有关您的问题的更多信息：

[http://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx](http://weblogs.asp.net/scottgu/archive/2005/12/14/433194.aspx)

# iphone - 将字符串数组与按钮单击进行比较

> ID：13646707
> 
> 赞同：1
> 
> 时间：2012-11-30T13:59:24.713
> 
> 标签：iphone, ios, xcode, ios4

我正在尝试通过创建测验应用程序来学习新东西

我创建了一系列问题和答案

但答案只有“是”或“否”。

我可以创建随机出现的问题，但我很震惊如何确认或获取屏幕上出现的特定问题是否有解决方案

这是一个非常简单的应用程序，只是想确认所选问题的真实答案是是还是不是？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:15:42.343

有几种方法可以完成这个简单的任务。

一种是用键（问题，答案）制作字典并添加到数组中

```
NSArray *questions = @[@{@"Question":@"Question 1 Text", @"Answer":@YES},
                       @{@"Question":@"Question 1 Text", @"Answer":@NO}]; 
```

并生成一个随机数并从数组中获取问题字典并保存问题字典的引用以供进一步比较。

```
NSDictionary *curQuestion = questions[(rand()%questions.count)];
NSString *question = curQuestion[@"Question"];
BOOL answer = [curQuestion[@"Answer"] boolValue]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:39:58.597

创建一个字典数组（字典有两个键“问题”和“答案”），当一个问题被回答时，您可以从数组中访问相应的字典，然后得到该问题的答案。

# java - 属性文件不会在静态代码中加载，得到 NullPointerException

> ID：13646713
> 
> 赞同：0
> 
> 时间：2012-11-30T13:59:49.940
> 
> 标签：java, properties, nullpointerexception, static-methods

我正在尝试在静态初始化代码中加载 Java 中的属性文件：

```
public class NFWConfiguration {

private static final Properties PROPS = new Properties();

static {
    try {

        InputStream IS = NFWConfiguration.class.getClassLoader()
            .getResourceAsStream(
                "/net/nfw/Configuration/NFWConfiguration.properties");

        PROPS.load(IS);

    } catch (IOException ex) {
        Logger.getLogger(NFWConfiguration.class.getName())
            .log(Level.SEVERE, null, ex);
    }
}

    // ...

} 
```

然而，我收到以下错误消息：

```
Caused by: java.lang.NullPointerException
at java.util.Properties$LineReader.readLine(Properties.java:418)
at java.util.Properties.load0(Properties.java:337)
at java.util.Properties.load(Properties.java:325)
at net.nfw.Configuration.NFWConfiguration.<clinit>(NFWConfiguration.java:28) 
```

确实`IS`如此`null`，但它没有理由如此`null`。我已经仔细检查了`.jar`，并且属性文件在正确的目录中。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:09:05.147

`/`删除路径中的前导后尝试：

```
 InputStream IS = NFWConfiguration.class.getClassLoader()
        .getResourceAsStream(
            "net/nfw/Configuration/NFWConfiguration.properties"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:09:10.170

除了设置文件路径之外，您做得对。仔细检查。我通过静态属性加载在本地检查了这种情况，一切正常。

# group-by - 关于 GROUP BY 和 ORDER BY

> ID：13646714
> 
> 赞同：2
> 
> 时间：2012-11-30T13:59:51.473
> 
> 标签：group-by, sql-order-by

我对 group by 的查询顺序有疑问。

我有一个表 download_category 并下载。下载表有一个名为“thumb”的列（它是一个图像 - varchar）。我想获取类别名称和插入的最后一个拇指。

我正在这样做：

```
 SELECT download_category.id
             , download_category.link
             , download.thumb
      FROM download  

RIGHT JOIN download_category ON (download_category.id = download.idCategoria )   
     WHERE download_category.link IN ('link-of-category') 

GROUP BY download_category.id
       , download_category.link
ORDER BY download.id DESC 
```

如果不存在下载，则需要 RIGHT JOIN。

问题是：拇指列返回第一个插入的记录，而不是最后一个“download.id DESC”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:49:02.370

试试这个：

```
SELECT download_category.id
         , download_category.link
         , download.thumb
from download_category 
left join (select max(id) maxId,
                  idCategoria 
           from download 
           group by idCategoria) t
      ON (download_category.id = t.idCategoria ) 
left join download 
      ON t.maxid=download.id

 WHERE download_category.link IN ('link-of-category') 

 GROUP BY download_category.id
        , download_category.link
 order by t.maxid DESC; 
```

# sql - 连接表并投影到新模型中

> ID：13646716
> 
> 赞同：4
> 
> 时间：2012-11-30T13:59:56.803
> 
> 标签：sql, asp.net-mvc, linq, join, razor

我是Linq的新手。我一直在使用强类型数据集，但喜欢 Linq 创建对象的想法。

目前，我使用数据集来检索连接来自 tblProducts 和 tblProductSettings 的数据的表。

这是一对多的关系，因为产品服务于多个网站，每个网站都有一个唯一的 tblSettings 行，但是它假设每个网站总是有一行 tblSettings。

例子 ：

```
Select * from tblproducts, tblProductSettings where tblproducts.ProdID = tblProductSettings.ProdID and tblProductSettings.CreatorID = @CreatorID 
```

数据集将提供一个很好的表格来循环并显示带有设置的产品。

Linq 会给我一个带有 tblProductSettings 作为集合的 tblProducts 对象。我不想每次都循环一个集合来获取设置，我相信为每个产品创建一个新的 sql 查询并使访问设置变得痛苦。

我可以创建一个自定义对象 tblProductsAll，但我可以填充这个对象的唯一方法是......

```
var Product = from p in context.tblProducts
              join ps in context.tblProductSettings on p.ProdID equals ps.ProdID
              where p.CreatorID == 1 && ps.ProdCreatorDisplay == 1
              select new tblProductsAll() 
              { 
                   ProdTitle = p.ProdTitle,
                   ProdPrice = ps.ProdPrice
              }; 
```

然后我可以将此模型传递给剃刀模板。

我的问题是......有没有更好的方法来设置属性？有 20 个或更多不同的属性，我不想每次都在站点中使用具有不同 where 子句的相同对象时不断设置它们，重复代码。有没有办法阻止这种重复？即自动映射对象，或重用select new 语句。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:24:49.987

由于您已标记此[sql](/questions/tagged/sql "显示标记为“sql”的问题")，我猜您正在使用实体框架。在这种情况下，您可以告诉 linq 它为您的产品加载设置，而无需明确指定连接。我在这里假设您的产品与您的产品设置表有关系，该表通过您的产品实体上的 Settings 属性公开。

```
var allProducts = context.tblProducts
    .Where(p => p.CreatorID == 1 && p.Settings.ProdCreatorDisplay == 1)
    .Include(p = p.Settings)
    .Select(p => CreateViewModelFromFullyPopulatedProductModel(p))
    .ToList(); 
```

一旦你加载了完整的设置，你就可以编写一个映射函数来为你做映射。当然，这将加载产品的**所有**属性以及每个产品的设置。这可能是一个主要问题，具体取决于您正在加载多少产品以及它们有多少未使用的属性，但从您的问题来看，听起来您已经为视图模型加载了大部分这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-02T10:16:57.510

当有导航属性时，使用它们！您的`Product`实体有一个导航属性`ProductSettings`。这意味着查询可能如下所示：

```
var products = from p in context.Products
               from ps in p.ProductSettings
               where p.CreatorID == 1 && ps.ProdCreatorDisplay == 1
               select new ProductsAll() 
               { 
                    ProdTitle = p.ProdTitle,
                    ProdPrice = ps.FirstOrDefault().ProdPrice
               }; 
```

（请注意，我固执地拒绝使用`tbl`前缀）

但这并不能解决重复代码问题。

输入[自动映射器](http://automapper.org/)。这是一个不错的小工具，它通过定义和执行对象之间的映射来从代码中删除样板属性复制语句。默认映射基于名称约定。例如，该语句配置和`Mapper.CreateMap<Product,ProductDto>();`的所有同名属性之间的映射。并且会从.`Product``ProductDto``Mapper.Map<ProductDto>(product);``ProductDto``product`

但是您的`ProductsAll`班级有一个`ProdPrice`来自`ProductSettings`. 如何处理？

这里可以使用 AutoMapper 的一个不错的功能。它还根据名称约定解析嵌套对象的属性。假设您的类`Product`有一个属性`Title`，AutoMapper 可以将其解析为`ProductTitle`目标对象中的属性。让我们使用它：

```
class ProductsAll
{
    // ProductSetting should have a Product property.
    public string ProductTitle { get; set; }
    // Assuming ProductSetting has a property ProdPrice.
    public decimal ProdPrice { get; set; }
}

...

Mapper.CreateMap<ProductSetting,ProductsAll>(); // ProductSetting!

var q = from ps in context.ProductSettings
        where ps.Product.CreatorID == 1 && ps.ProdCreatorDisplay == 1;

// Now the magic!
var products = q.Project().To<ProductsAll>(); 
```

`Project()`是 . 上的扩展方法`IQueryable`。好处是 SQL 语句只包含投影中使用的属性。如您所见，您可以定义一次映射，其余的使用`Project().To()`代码中的构造。

AutoMapper 还有更多功能。这是一个快速的开始。

# javascript - 事件在画布上不起作用

> ID：13646718
> 
> 赞同：0
> 
> 时间：2012-11-30T14:00:01.330
> 
> 标签：javascript, html, canvas

我创建了一个画布。我想在鼠标进入和离开画布时触发一些事件。我的代码不起作用。我错过了什么吗？

```
var d = dojo.create(
            "canvas",
            {
                width: 0,
                height: 0,
                style: {border: "1px solid #3399ff", position: "absolute", visibility:"hidden"},
                ondragenter: vp.handleDrag,
                ondragover: vp.handleDrag,
                ondrop: handleDrop
            }
    );
d.addEventListener("mouseout", function(evt)
    {    //code inside function     }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:48:03.680

如果您满足以下条件，您的代码可以正常工作：

1.  将您的画布附加到 DOM（也许您在真实代码中这样做，但您的示例不完整）。

2.  Remove `visibiltiy: "hidden"`，因为隐藏元素不会触发鼠标事件。

我还建议让你的画布大于 0×0，但如果你实现其他两个点，你的代码在技术上仍然可以工作，因为画布有边框。[我在这里](http://jsfiddle.net/kKHnJ/2)创建了一个功能性的 jsFiddle 。

# c# - 如何将方法移动到另一个类并调用它？

> ID：13646719
> 
> 赞同：-1
> 
> 时间：2012-11-30T14:00:05.697
> 
> 标签：c#

我正在为我的编程课制作一款名为“Lingo”的游戏。我已经完成了大部分工作。但是我们应该在表单类中包含尽可能少的代码。所以我必须将大部分内容转移到另一个班级。关于我应该如何做的任何想法？

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Text.RegularExpressions;
using System.IO;

namespace Lingo
{
    public partial class Form1 : Form
    {
        Random r = new Random();
        AboutBox1 about = new AboutBox1();
        int gissningar, x, score, highcsore;
        Label[] labels = new Label[25];
        string ord;
        public Form1()
        {
            InitializeComponent();
            gissningar = 0;
            x = 0;
            score = 1000;
            highcsore = 0;
            labels[0] = label1;
            labels[1] = label2;
            labels[2] = label3;
            labels[3] = label4;
            labels[4] = label5;
            labels[5] = label6;
            labels[6] = label7;
            labels[7] = label8;
            labels[8] = label9;
            labels[9] = label10;
            labels[10] = label11;
            labels[11] = label12;
            labels[12] = label13;
            labels[13] = label14;
            labels[14] = label15;
            labels[15] = label16;
            labels[16] = label17;
            labels[17] = label18;
            labels[18] = label19;
            labels[19] = label20;
            labels[20] = label21;
            labels[21] = label22;
            labels[22] = label23;
            labels[23] = label24;
            labels[24] = label25;
            String[] ordLista = File.ReadAllLines(("words.txt").ToString());
            ord = ordLista[r.Next(r.Next(ordLista.Length))];
            ord = ord.ToUpper();
            labels[0].Text = Convert.ToString(ord[0]);
        }

        private void quitToolStripMenuItem_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void aboutToolStripMenuItem_Click(object sender, EventArgs e)
        {
            about.Show();
        }

        private void addWordsToolStripMenuItem_Click(object sender, EventArgs e)
        {
            new Form2().Show();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string ordet = ord;
            string svar = textBox1.Text.ToUpper();
            if (Regex.IsMatch(svar, "^[a-zA-Z]{5}$"))
            {
                if (x <= 20)
                {

                    if (svar == ord)
                        for (int i = 0; i <= 4; i++)
                        {

                            labels[i + x].Text = Convert.ToString(svar[i]);
                            labels[i + x].BackColor = Color.Green;
                            highcsore = score;
                        }
                    else
                    {
                        gissningar++;
                        score = score / gissningar;
                        for (int i = 0; i <= 4; i++)
                        {
                            labels[i + x].BackColor = Color.Red;
                        }
                        for (int i = 0; i <= 4; i++)
                        {
                            labels[i + x].Text = Convert.ToString(svar[i]);
                            if (svar[i] == ord[i])
                            {

                                labels[i + x].BackColor = Color.Green;
                                ordet = ordet.Insert(i, "?");
                                ordet = ordet.Remove(i + 1, 1);
                                if (x < 20)
                                {
                                    labels[x + 5].Text = Convert.ToString(ord[0]);
                                    labels[i + x + 5].Text = Convert.ToString(svar[i]);
                                }
                            }
                        }
                        for (int i = 0; i <= 4; i++)
                        {
                            for (int k = 0; k <= 4; k++)
                            {
                                if (svar[i] == ordet[k])
                                {

                                    labels[i + x].BackColor = Color.Orange;
                                    svar = svar.Insert(i, "#");
                                    svar = svar.Remove(i + 1, 1);
                                }

                            }
                        }

                    }
                    //kod för att jämföra chars

                    x = x + 5;
                }
                else
                {
                    MessageBox.Show("Du förlorade! \r\n Ordet var: " + ord);
                }

            }
            else
            {
                MessageBox.Show("Ordet måste ha 5 bokstäver");
            }

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:06:22.963

我不确定在另一个类/方法中复制/粘贴所有内容是答案。

你最好在“层”中重构你的代码：游戏逻辑，渲染/图形逻辑，与用户的动作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:06:01.477

我建议制作一个“游戏”课程。此类将保存所有游戏初始化和设置逻辑。所以在其中你可能有一个`init()`执行你在构造函数中的大部分内容。您在课程开始时拥有的大多数属性也应该移到这个新课程中。

我不确定其中的代码是`button1_Click`做什么的，但也会有一种`doGameLogic`方法。此处的此类应创建游戏的新实例并通过游戏类访问特定于游戏的成员和逻辑。您的表单类应该与您的游戏所需的控件一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:02:34.290

选择要移动到类的代码块，然后右键单击 -> 重构 -> 生成方法..

这将生成一个所有依赖项作为输入的方法，然后您可以将函数移动到另一个类或类库！

**更新：**
在重构之前，如丹尼尔在评论中所说，将逻辑代码与控件分开。这将帮助您将逻辑保存在类文件中并控制表单类！您可以将控件的输入作为参数发送到类函数/方法！

# r - week day week-percent from time-series

> ID：13646726
> 
> 赞同：0
> 
> 时间：2012-11-30T14:00:33.903
> 
> 标签：r, time-series, tapply

我有一些每日时间序列数据，我需要提取相对于一周平均值的“工作日百分比”。例如，如果第一周有`mean = 100`并且本周的*星期日*值为 20，则星期日变为 0.2。

这是一些随机数据：

```
set.seed(0)
y = rnorm(1705)
date = seq(as.Date('2008-01-01'), by = 'day', length = length(y))
data.df = data.frame(y, date) 
```

我需要一个名为 的新列`pecent`，即上面解释的值。我尝试添加一些列然后使用`tapply`，但失败了。感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:16:03.273

首先`week`使用创建一个变量`format`。然后使用`ddply`和`transform`。

```
library(plyr)
data.df$week <- format(data.df$date,'%W %Y') #week begins with Monday
data.df <- ddply(data.df,~week,transform,percent=y/mean(y))
head(data.df)

           y       date    week    percent
1  1.2629543 2008-01-01 00 2008  3.1395415
2 -0.3262334 2008-01-02 00 2008 -0.8109741
3  1.3297993 2008-01-03 00 2008  3.3057095
4  1.2724293 2008-01-04 00 2008  3.1630952
5  0.4146414 2008-01-05 00 2008  1.0307451
6 -1.5399500 2008-01-06 00 2008 -3.8281172 
```

请注意，第 00 周通常不像一年中的最后一周那样是一整周。如果重要的话，合并随后几年的最后几周和第一周。

# java - 如何在 JBoss AS7 中使用 hibernate-infinispan 的 write behind 方法

> ID：13646728
> 
> 赞同：3
> 
> 时间：2012-11-30T14:00:43.957
> 
> 标签：java, hibernate, java-ee-6, jboss7.x, infinispan

我在独立的 JBoss AS7 中创建了一个 REST API，使用 hibernate 作为 JPA 提供程序，使用 Infinispan 作为二级缓存。

我在[https://docs.jboss.org/author/display/ISPN/Write-Through+And+Write-Behind+Caching](https://docs.jboss.org/author/display/ISPN/Write-Through+And+Write-Behind+Caching)中看到 Infinispan 可以使用 write-behind 方法，将数据从缓存异步保存到db，这是我的项目需要的东西。

我想启用此功能，但我无法在任何地方找到如何做到这一点。

如果有帮助，我可以解释为什么我需要这种行为。我有一个名为 Stat 的实体类。在那个类中，我有一个 int balance 值，例如：

```
@Entity
public class Stat{
    private int balance;
} 
```

REST 方法之一同时访问该余额，从中减去一个并在数据库中更新它。这在项目中造成了瓶颈，因为许多线程试图获取锁来读取和更新数据库的余额。

所以，我认为我可以使用 Infinispan 来更新内存中的余额，并让 Infinispan 异步持久化对数据库的更改。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T08:06:56.720

From what I'm seeing, there is not property you can pass to either the JPA configuration or Hibernate configuration that would let you enable this functionality (the list of properties for hibernate can be found [here](http://docs.jboss.org/hibernate/core/4.0/javadocs/constant-values.html#org.hibernate.cache.infinispan.InfinispanRegionFactory.INFINISPAN_CONFIG_RESOURCE_PROP)).

You'll need to make your own infinispan xml configuration file (possibly copying [this](http://anonsvn.jboss.org/repos/hibernate/core/trunk/cache-infinispan/src/main/resources/org/hibernate/cache/infinispan/builder/infinispan-configs.xml)), create a new namedCache with the properties you want taken from the [inifnispan configuration](https://docs.jboss.org/author/display/ISPN/Write-Through+And+Write-Behind+Caching) you gave, and then in your JPA or hibernate configuration add the "hibernate.cache.infinispan.cfg" property with the location of your new configuration xml.

You will also need to change the cache used for your Stat entity by adding the following property to your hibernate or JPA config:

```
<property name="hibernate.cache.infinispan.com.package.Stat.cfg"  value="yourNewNamedCache"/> 
```

# sql - 改进和加速 SQL Server 2008 中的搜索结果

> ID：13646729
> 
> 赞同：0
> 
> 时间：2012-11-30T14:00:50.207
> 
> 标签：sql, sql-server, sql-server-2008

我在从复杂的搜索算法中获得良好的搜索结果时遇到问题。可以理解，我应该使用 FREETEXT，但我对 SQL Server 还很陌生，我不知道如何创建全文搜索索引，而且服务器的硬盘空间也不足。所以，我必须使用我现在拥有的东西。数据库成员表有超过一百万个条目，因此检索结果很慢。

**示例输入**

```
@CriteriaStr = 'Attorney New York'
@PageSize = 10
@PG = 1 
```

请允许我向您展示代码：

**主搜索 SQL 脚本**

```
IF @MODE = 'MEMBER-MAIN-SEARCH'
    BEGIN
        SELECT @TotalPages = CEILING(COUNT(*)/@PageSize)
        FROM Member
        WHERE MemberID IN (SELECT MemberID FROM sbuser.tf_MemberSearchCriteria(REPLACE(@CriteriaStr,' ',',')))
        AND Claimed = 'Y'
        AND Viewable = 'Y';

        WITH MemberSearchResults AS
        (
            SELECT ROW_NUMBER() OVER(ORDER BY a.Claimed DESC) AS RowNum,
            a.MemberID,                                 -- 1    
            a.FirstName,                                -- 2
            a.LastName,                                 -- 3
            a.MemberDisplayName AS DisplayName,         -- 4
            a.UserName,                                 -- 5
            a.LastLogin,                                -- 6
            a.PrCity,                                   -- 7
            a.BusinessName,                             -- 8
            a.ShortDesc,                                -- 9
            a.PrAddr1,                                  -- 10
            a.PrAddr2,                                  -- 11
            a.PrZip,                                    -- 12
            b.Abbr,                                     -- 13
            c.Country,                                  -- 14
            a.AvatarMed,                                -- 15
            a.Gender,                                   -- 16
            d.Domain,                                   -- 17
            a.Claimed,                                  -- 18
            a.PrPhone,                                  -- 19
            a.PrShowAddress,                            -- 20
            a.ProfileTypeID,                            -- 21
            @TotalPages AS TotalPages                   -- 22
            FROM Member a
            RIGHT JOIN State b ON b.StateID = a.PrStateID
            INNER JOIN Country c ON c.CountryID = a.PrCountryID
            INNER JOIN Region d ON d.RegionID = a.MemberRegionID
            WHERE a.MemberID IN (SELECT MemberID FROM sbuser.tf_MemberSearchCriteria(REPLACE(@CriteriaStr,' ',',')))
            AND Claimed = 'Y'
            AND Viewable = 'Y'
        )
        SELECT * 
        FROM MemberSearchResults
        WHERE RowNum BETWEEN (@PG - 1) * @PageSize + 1 AND @PG * @PageSize
        ORDER BY Claimed DESC
    END 
```

**TF_MEMBERSEARCHCRITERIA**

```
USE [storeboard]
GO
/****** Object:  UserDefinedFunction [sbuser].[tf_MemberSearchCriteria]    Script Date: 11/30/2012 08:22:34 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER FUNCTION [sbuser].[tf_MemberSearchCriteria](@CriteriaStr varchar(255))
RETURNS @OUT TABLE (MemberID bigint)

AS

BEGIN
    DECLARE @Keyword varchar(150)

    DECLARE CUR CURSOR FOR SELECT Keyword from sbuser.tf_Keywords(@CriteriaStr)
    OPEN CUR
    FETCH NEXT FROM CUR INTO @Keyword
    WHILE @@FETCH_STATUS = 0
        BEGIN
            --INSERT INTO @OUT
            --SELECT MemberID FROM Member WHERE ShortDesc LIKE '%' + @Keyword + '%' AND Claimed = 'Y'  AND MemberID NOT IN (Select MemberID FROM @OUT)

            --INSERT INTO @OUT
            --SELECT MemberID FROM Member WHERE UserName LIKE '%' + @Keyword + '%' AND Claimed = 'Y'  AND memberID NOT IN (Select MemberID FROM @OUT)

            INSERT INTO @OUT
            SELECT MemberID FROM Member WHERE BusinessName LIKE '%' + @Keyword + '%' AND Claimed = 'Y' AND memberID NOT IN (SELECT MemberID FROM @OUT)

            INSERT INTO @OUT
            SELECT MemberID FROM Member WHERE FirstName + LastName LIKE '%' + REPLACE(@Keyword,' ','') + '%' AND Claimed = 'Y' AND memberID NOT IN (SELECT MemberID FROM @OUT)

            INSERT INTO @OUT
            SELECT a.MemberID
            FROM MemberBusinessCat a
            LEFT JOIN BusinessCat b ON b.BusinessCatID = a.BusinessCatID
            LEFT JOIN BusinessCat c ON c.BusinessCatID = b.ParentID
            WHERE b.CategoryName LIKE '%' + @Keyword + '%' OR c.CategoryName LIKE '%' + @Keyword + '%'
            AND a.MemberID NOT IN (SELECT MemberID FROM @OUT)

            FETCH NEXT FROM CUR INTO @Keyword

        END
    CLOSE CUR
    DEALLOCATE CUR

    DELETE FROM @OUT WHERE MemberID IS NULL

    RETURN
END 
```

**TF_KEYWORDS**

```
USE [storeboard]
GO
/****** Object:  UserDefinedFunction [sbuser].[tf_Keywords]    Script Date: 11/30/2012 08:50:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER FUNCTION [sbuser].[tf_Keywords] 
    (@KeywordList varchar(4000)
)
RETURNS @OUT TABLE (
    Keyword varchar(50))

AS
    BEGIN
        DECLARE @NEXTPOS bigint
        DECLARE @NEXTWORD varchar(50)
        DECLARE @LISTLEN int
        DECLARE @FAILSAFE int

        SET @FAILSAFE = 0

        SET @KeywordList = @KeywordList + ','
        WHILE @KeywordList <> '' AND @FAILSAFE < 50
            BEGIN
                SET @NEXTPOS = CHARINDEX(',',@KeywordList)
                SET @LISTLEN = LEN(@KEYWORDLIST)
                SET @NEXTWORD = LTRIM(RTRIM(REPLACE(LEFT(@KeywordList,@NEXTPOS),',','')))
                SET @KEYWORDLIST = RIGHT(@KEYWORDLIST,@LISTLEN-@NEXTPOS)

                INSERT INTO @OUT
                SELECT @NEXTWORD

                SET @FAILSAFE = @FAILSAFE + 1

            END

    RETURN
    END 
```

我想知道是否可以通过任何一个成员的结果数来订购 TF_MEMBERSEARCHCRITERIA。会员可以通过律师并且在纽约，这将使他们在结果中显示 3 次。该脚本删除重复，但是否有办法计算 3 个结果，然后按 DESC 顺序排序。

我还比较新，所以我还没有完全理解 SQL 的复杂部分，所以请放轻松。

非常感谢，neojakey

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T20:35:19.730

嗨，如果有任何错误让我知道我评论了改进区域，我对此很抱歉

Advice1 :-
1) 使用索引视图并将可搜索列添加到 1 个列中，例如您必须将列 memberID 作为主要列，并且 searchtext nvarchar(MAX) -- 添加所有搜索列，如 exm
-- FirstName + LastName + BusinessName 2) 创建全文索引在它上面并使用 contains 进行部分单词搜索或对结果进行排序 freetextable 您可以在如何编写查询方面提供很多帮助
3) 如果您提供较小的磁盘空间，它就简单易行

Advice2 :- 1) 仅对最后 10 行使用所有连接。INTHEMO_Authentication 你的代码

```
 ;    WITH 
    MemberSearchResults AS
        (
            SELECT ROW_NUMBER() OVER(ORDER BY a.Claimed DESC) AS RowNum,
           a.MemberID,  ----   bring  the primary  and  the columns need to  orderby  only  dont join  with unnessary tables inthis step 
           a.Claimed

            FROM Member a
            --RIGHT JOIN State b ON b.StateID = a.PrStateID
            --INNER JOIN Country c ON c.CountryID = a.PrCountryID
            --INNER JOIN Region d ON d.RegionID = a.MemberRegionID
            WHERE a.MemberID IN (SELECT MemberID FROM sbuser.tf_MemberSearchCriteria(REPLACE(@CriteriaStr,' ',','))  group by MemberID)
    ----  in that   function   dont use like --NOT IN (SELECT MemberID FROM @OUT)     its a small improvement  u can do here 
            AND Claimed = 'Y'    ----  ur checking this condition  on function tooo  then no need here  i think 
            AND Viewable = 'Y'  ----  ur checking this condition  on function tooo  then no need here  i think 
        )
        SELECT   --a.MemberID,                                 -- 1    
            --a.FirstName,                                -- 2
            --a.LastName,                                 -- 3
            --a.MemberDisplayName AS DisplayName,         -- 4
            --a.UserName,                                 -- 5
            --a.LastLogin,                                -- 6
            --a.PrCity,                                   -- 7
            --a.BusinessName,                             -- 8
            --a.ShortDesc,                                -- 9
            --a.PrAddr1,                                  -- 10
            --a.PrAddr2,                                  -- 11
            --a.PrZip,                                    -- 12
            --b.Abbr,                                     -- 13
            --c.Country,                                  -- 14
            --a.AvatarMed,                                -- 15
            --a.Gender,                                   -- 16
            --d.Domain,                                   -- 17
            --a.Claimed,                                  -- 18
            --a.PrPhone,                                  -- 19
            --a.PrShowAddress,                            -- 20
            --a.ProfileTypeID,                            -- 21
            --@TotalPages AS TotalPages                   -- 22
        FROM MemberSearchResults cross join (SELECT  COUNT(*) FROM MemberSearchResults) AS @TotalPages --  u have to do total page count like this 
          --RIGHT JOIN State b ON b.StateID = a.PrStateID
            --INNER JOIN Country c ON c.CountryID = a.PrCountryID
            --INNER JOIN Region d ON d.RegionID = a.MemberRegionID
        WHERE RowNum BETWEEN (@PG - 1) * @PageSize + 1 AND @PG * @PageSize 
        ORDER BY Claimed DESC 
```

如果您对 dity 读取没问题，您可以使用 nolock 最后一件事。

# c# - Infragistics UltraGridBand CardView 在空数据集上保留标头

> ID：13646731
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:03.907
> 
> 标签：c#, winforms, infragistics, ultrawingrid

我有一个 UltraGrid，它绑定到我的数据库中的一些数据。
有时网格绑定的数据集是空的。
发生这种情况时，标题在网格顶部正常显示，不显示任何行。
当用户想要转置网格时，他们将行视为列，他们单击我们绑定到这段代码的按钮。

```
grid.Rows.Band.CardView = true; 
```

这在所有情况下都很好，但是当数据集为空时。
当数据集中没有数据时，标题消失。

如何强制标头与空数据集一起留在那里？

到目前为止，我已经尝试使用网格或乐队的属性来尝试强制它们保持可见，但没有运气。
我还发现我可以在网格中添加一个空行，作为一种解决方法。然而，这是不可取的，因为尽管我尽了最大努力，我还是无法向用户隐藏该行。如果将行的 Hidden 属性设置为 true，网格的标题就会消失。

[这](http://www.infragistics.com/community/forums/t/69041.aspx)是我能找到的唯一类似的问题，但遗憾的是它也没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-01T19:12:26.603

据我所知，当空数据集绑定到网格时，网格无法知道要显示什么类型的对象（因此是什么列）。如果您的空集合可以提供此信息，我想它会起作用。

一种方法（正如我所使用的）是实现一个自定义集合，它通过 ITypedList 接口将绑定项的属性（作为 PropertyDescriptor）公开为网格的模板。类似于[this](http://winterdom.com/2006/07/itypedlistandpropertydescriptors)或[this](http://jopinblog.wordpress.com/2007/04/30/implementing-itypedlist-for-virtual-properties/)的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:28:29.473

在没有卡片时显示标题是一个功能请求，您应该联系 Infragistics 为您创建一个功能请求。Mike Saltzman 在以下论坛主题中提供了更多详细信息：http: [//www.infragistics.com/community/forums/p/59862/330102.aspx#330102](http://www.infragistics.com/community/forums/p/59862/330102.aspx#330102)

# asp.net - 在页面中设置 CustomValidator 的 ControlToValidate 以使 USercontrol 内的文本框使用 ValidatorCalloutExtender 显示消息

> ID：13646732
> 
> 赞同：1
> 
> 时间：2012-11-30T14:01:04.717
> 
> 标签：asp.net

我在 ASP.net 和 UserControl 中有一个页面，我在此页面中注册。

用户控件包含一个 texbox、ajax calendarextender 和 rangeValidator，它们验证文本框中的日期。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="DatePicker.ascx.cs"
Inherits="Root_Webspace.WebControls.DatePicker" %>

<table>
<tr>
    <td  >
        <asp:RangeValidator ID="rvDate" runat="server" Text="!" ErrorMessage="Message..." ControlToValidate="txtDate"
            Type="Date" ></asp:RangeValidator>
        <ajx:ValidatorCalloutExtender ID="vcalSaleDateRange" runat="server" TargetControlID="rvDate">
                                    </ajx:ValidatorCalloutExtender>
    </td>
    <td >
        <asp:TextBox ID="txtDate"   runat="server"></asp:TextBox>
    </td>
    <td>
        <asp:ImageButton ID="imgbtnDate" runat="server" CausesValidation="false" ImageUrl="~/App_Themes/Default/Images/icon-calendar.gif" />
        <ajx:CalendarExtender ID="cextDate"  runat="server" PopupButtonID="imgbtnDate"
                                        TargetControlID="txtDate">
        </ajx:CalendarExtender>
    </td>
</tr>
</table> 
```

后面的代码：

```
public TextBox TxtDate
    {
        get { return txtDate; }
    } 
```

该页面包含此用户控件和 CustomValidator。有了这个 CustomValidator ，我想将他的 ControlToValidate 设置为 UserControl textDate。

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Masterpages/Default.Master" AutoEventWireup="true"
CodeBehind="Test.aspx.cs" Inherits="Root_Webspace.Test" UICulture="auto" Culture="auto"
Async="true" %>

<%@ Register Src="~/WebControls/DatePicker.ascx" TagName="DatePicker" TagPrefix="uc1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">

<asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="btnSend" EventName="Click" />
        <asp:AsyncPostBackTrigger ControlID="btnCancel" EventName="Click" />
    </Triggers>
    <ContentTemplate>
        <div>
            <asp:CustomValidator ID="cvalDate" runat="server" ControlToValidate="How to set with usercontrol txtDate ???? "
                Display="Dynamic" Text="!" OnServerValidate="cvalDate_ServerValidate" ValidateEmptyText="true"> </asp:CustomValidator>
            <ajx:ValidatorCalloutExtender ID="vcalDateBris" runat="server" TargetControlID="cvalDate">
            </ajx:ValidatorCalloutExtender>
            <uc1:DatePicker ID="FromDatePicker" runat="server" />
        </div>
          </ContentTemplate>
</asp:UpdatePanel>
<div>
    <div class="buttonzone">
        <div id="idButtons" style="margin-right: 5px;">
            <asp:Button ID="btnSend" runat="server" TabIndex="10" Text="Send" Width="85px" meta:resourcekey="btnSend"
                OnClick="btnSend_Click" />
            <asp:Button ID="btnCancel" runat="server" CausesValidation="false" TabIndex="11"
                Text="Cancel" OnClick="btnCancel_Click" Width="85px" meta:resourcekey="btnCancel" />
        </div>
    </div>
</div>
</asp:Content> 
```

背后的代码

```
 protected void btnSend_Click(object sender, EventArgs e)
    {
        if (Page.IsValid)
        {
            //Do Something
        }
    }

    protected void cvalDate_ServerValidate(object source, ServerValidateEventArgs args)
    {
        cvalDate.ErrorMessage = string.Empty;
        args.IsValid = true;
        if (!IsDate(this.FromDatePicker.TxtDate.Text))
            cvalDate.ErrorMessage = Root.Resources.WebMessages.INVALIDDATE;
        else if (!string.IsNullOrEmpty(FromDatePicker.TxtDate.Text) && DateTime.Parse(FromDatePicker.TxtDate.Text) > DateTime.Now)
            cvalDate.ErrorMessage = Root.Resources.WebMessages.BIGGERTHAN;

        args.IsValid = string.IsNullOrEmpty(cvalDate.ErrorMessage);
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            cvalDate.ControlToValidate = FromDatePicker.TxtDate.ID;
        }
    } 
```

错误 => InnerException 类型：System.Web.HttpException 找不到由“cvalDate”的“ControlToValidate”属性引用的控件 ID“txtDate”。

当我更改为： cvalDate.ControlToValidate = FromDatePicker.TxtDate.ClientID;

错误=> InnerException 类型：System.Web.HttpException 找不到由“cvalDate”的“ControlToValidate”属性引用的控件 ID“ctl00_ContentPlaceHolder1_FromDatePicker_txtDate”。

如果我不设置 cvalDate.controlToValidate，则 vcalDateBris (ValidatorCalloutExtender) 在必须显示无效日期消息时将失败，因为此 ValidatorCalloutExtender 通过 TargetControlID 链接到 CustomValidator，其中 CustomValidator 没有 controlToValidate 控件集。那么如何将Page中CustomValidator的ControlToValidate设置为FromDatePicker（USerControl）内部的txtDate，以在ValidatorCalloutExtender中显示消息。

任何想法？

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:04:28.463

```
ControlToValidate="FromDatePicker$txtDate" 
```

# c# - 将 C# 委托翻译成 TypeScript

> ID：13646736
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:19.630
> 
> 标签：c#, javascript, typescript

你能告诉我如何把它翻译成`TypeScript`? 使用 SharpKit.JavaScript；

```
namespace MyNamespace
{
    [JsType(JsMode.Prototype)]
    public class JsEventArgs
    {
    }

    public delegate void JsEventHandler<in T>(object sender, T args) where T : JsEventArgs;
    public delegate void JsEventHandler(object sender, JsEventArgs args);
} 
```

以及在其他类中的用法：

```
public event JsEventHandler<LayerVisivilityEventArgs> Changed; 
```

我试过了：

```
module JsEvent {

    export class JsEventArgs {
    }

    public JsEventHandler: (sender: Object, args: any) => void;
    public JsEventHandler: (sender: Object, args: JsEventArgs) => void;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T11:03:14.997

我写了一个小类，其行为类似于 .NET Delegate 类（它是为 .NET 中的事件隐式创建的）

```
export interface IDelegate {
    (sender: any, ...parameters: any[]): void;
}

export class DelegateBuilder {
    private callees: IDelegate[];

    constructor() {
        this.callees = [];
    }

    invoke(sender: any, ...parameters: any[]) {
        for (var i = 0; i < this.callees.length; i++) {
            var callee = this.callees[i];
            if (caller)
                callee(sender, parameters);
        }
    }

    contains(callee: IDelegate) : bool {
        if (!callee)
            return false;

        return this.callees.indexOf(callee) >= 0;
    }

    add(callee: IDelegate): DelegateBuilder {
        if (!callee)
            return this;

        if (!this.contains(callee))
            this.callees.push(callee);

        return this;
    }

    remove(callee: IDelegate): DelegateBuilder {
        if (!callee)
            return this;

        var index = this.callees.indexOf(callee);
        if (index >= 0)
            this.callees.splice(index, 1);

        return this;
    }

    toDelegate() : IDelegate {
        return (sender: any, ...parameters: any[]) => this.invoke(sender, parameters);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-30T14:39:50.127

我认为你需要停止思考 C#，而开始思考 TypeScript。

这段代码：

```
module JsEvent {

    export class JsEventArgs {
    }

    public JsEventHandler: (sender: Object, args: any) => void;
    public JsEventHandler: (sender: Object, args: JsEventArgs) => void;
} 
```

...尝试向模块添加两个属性，但属性只允许在类（或接口）上。

TypeScript 并不真正使用委托 - 您可以连接一个事件（例如，在 JQuery 中），如下所示：

```
$('selector').click((e:JQueryEventObject) => {
     // Do something here.
}); 
```

...或者，避免使用 JQuery：

```
var div: HTMLDivElement = new HTMLDivElement();
div.onclick = (e: MouseEvent) => {
    // Do something here.
}; 
```

...或者，没有匿名函数：

```
div.onclick = doSomething;
function doSomething(e:MouseEvent):void{
    // Do something here.
} 
```

我认为最接近委托的模式是这样的（摘自[http://forum.unity3d.com/threads/9679-Javascript-Delegates](http://forum.unity3d.com/threads/9679-Javascript-Delegates)！）：

```
module JSEvents {
    class JSEventClass {

        public delegate:(e:string) => any;

        constructor() => {
            this.delegate = this.doSomething;
            this.delegate("Hello, Delegate World");
        }

        public doSomething(e: string): any {
            console.log("Doing Something: " + e);
        }
    }
} 
```

...但是在 TypeScript / JavaScript 世界中，我看不到这种模式通过`doSomething()`直接调用实现了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-23T00:38:19.433

我认为这是对相关代码的密切翻译。但是，这并没有解决事件处理，[另一个答案](https://stackoverflow.com/a/15680110/238753)已经涵盖了这一点。

```
module MyNamespace
{
    export class JsEventArgs
    {
    }

    export interface JsEventHandler<T extends JsEventArgs> {
        (sender: any, args: T): void;
    }

    export interface JsEventHandler {
        (sender: any, args: JsEventArgs): void;
    }
} 
```

# classloader - Weblogic 11G：java.lang.NoSuchMethodError：javax.persistence.OneToMany.orphanRemoval()

> ID：13646737
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:20.240
> 
> 标签：classloader, weblogic11g

使用 Weblogic 11G 时，我面临以下错误。

```
weblogic.application.ModuleException: 
at weblogic.servlet.internal.WebAppModule.startContexts(WebAppModule.java:1514)
at weblogic.servlet.internal.WebAppModule.start(WebAppModule.java:486)
at weblogic.application.internal.flow.ModuleStateDriver$3.next(ModuleStateDriver.java:425)
at weblogic.application.utils.StateMachineDriver.nextState(StateMachineDriver.java:41)
at weblogic.application.internal.flow.ModuleStateDriver.start(ModuleStateDriver.java:119)
Truncated. see log file for complete stacktrace

Caused By: java.lang.NoSuchMethodError: javax.persistence.OneToMany.orphanRemoval()Z
at org.hibernate.cfg.AnnotationBinder.processElementAnnotations(AnnotationBinder.java:1912)
at org.hibernate.cfg.AnnotationBinder.processIdPropertiesIfNotAlready(AnnotationBinder.java:79
at org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:707)
at org.hibernate.cfg.Configuration$MetadataSourceQueue.processAnnotatedClassesQueue(Configuration.java:4035)
at org.hibernate.cfg.Configuration$MetadataSourceQueue.processMetadata(Configuration.java:3989) 
```

让我给你更多的细节。我的 web 应用程序包含**ejb3-persistence-1.0.2.GA.jar**和**hibernate-jpa-2.0-api-1.0.1.Final.jar** jar 文件，在这个**hibernate-jpa-2.0-api-1.0.1.Final 中。 jar**包含**orphanRemoval()**方法，而**ejb3-persistence-1.0.2.GA.jar**没有。

我已通过以下规范将 weblogic 配置为加载应用程序库而不是 weblogic 库。

**weblogic-application.xml**

```
<prefer-application-packages>
    <package-name>antlr.*</package-name>
    <package-name>org.mozilla.javascript.*</package-name>
    <package-name>org.mozilla.classfile.*</package-name>
    <package-name>javax.persistence.*</package-name>
</prefer-application-packages> 
```

所以看来我需要告诉服务器从**hibernate-jpa-2.0-api-1.0.1.Final.jar**而不是**ejb3-persistence-1.0.2.GA.jar**文件加载所需的类，但我不知道方式要做到这一点？

您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T13:54:05.400

似乎在类路径上有不同版本的类，在类加载器层次结构中更高。Weblogic 本身有一堆库嵌入到标准 weblogic 安装中。要验证使用 -verbose JVM 选项来查看类的加载位置。如果是这种情况，那么使用 weblogic 部署描述符类加载过滤应该可以解决您的问题。（因为库中提供的库位于系统类路径中，它们优先于存档中的任何其他库）。使用这个类加载过滤，您可以打破它并加载正确的版本。我猜不同的容器有不同的标签。检查 weblogic 文档。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:18:18.833

如果加载的 jar 出现问题，则会发生 java.lang.NoSuchMethodError。我认为在您尝试运行此代码的系统上，已将**CLASSPATH**设置为加载旧版本 jar 的某个路径。使用以下代码找出 ClassLoader 解析依赖项的路径

```
public static void main(String[] args) {
            URLClassLoader classLoader = (URLClassLoader)Main.class.getClassLoader();
            System.out.println(Arrays.toString(classLoader.getURLs()));
    } 
```

将此方法放在 Main 类中并在出现此错误的系统中执行它。它将向您显示解决依赖关系的所有路径。找出是否有任何路径具有旧版本的 jar。

希望这对您的事业有所帮助。

# c#-4.0 - 来自 C# 的 HttpWebRequest 请求/响应的低级访问

> ID：13646740
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:27.370
> 
> 标签：c#-4.0, httpwebrequest

我使用如下代码在 C#/.Net 4.0 中执行 http get 请求：

```
HttpWebRequest webRequest = WebRequest.Create(uri);
HttpWebResponse webResponse = webRequest.GetResponse() as HttpWebResponse;
Stream responseStream = webResponse.GetResponseStream(); 
```

但我还需要在我自己的代码中监控请求/响应的完整低级数据（未解码的标头和正文）。

有没有办法在 .Net 中轻松地做到这一点（即不使用 FiddlerCore 之类的东西）？

# java - 检查文件是否已经保存java

> ID：13646741
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:27.620
> 
> 标签：java, file, boolean, save

我有一个可以保存一些文件的应用程序。**当用户关闭应用程序时，如果**用户尚未将文件保存为当前文件，我想要求保存。
如果我不够清楚，我想以某种方式检查文件是否已从上次保存中修改。
我考虑过创建一个`Boolean`变量，`true`如果文件被保存，然后在`false`每次以任何方式修改文件（写入或删除文件中的元素）时返回。
我的问题是是否有更简单的解决方案来做到这一点。在我看来，将变量设置为很多无用的工作`true`每次文件更改时（对我和机器都有效），我不希望这样，因为我有一个相当广泛和复杂的应用程序，并且文件更改可能经常发生。

回答后编辑：谢谢大家，这真的很有帮助。最终我意识到我需要一个在我对文件所做的大多数更改中都需要的函数，所以我不需要做太多工作。其他的变化不是很多，所以我只是对`Boolean`.
再次感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:03:15.767

如果更改不太可能经常发生，那么设置布尔变量的每次更改开销肯定也可以忽略不计。

理想情况下，您将在您的代码中有一个点，所有更改都必须经过（例如您处理撤消/重做的位置），并且您可以将布尔变量更新代码放在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T14:06:13.540

另一种方法是读取文件并根据程序的内容检查它的内容，这似乎会产生不必要的开销。或者节省保存某些内容的时间，并检查此后是否进行了更改。

考虑到我认为您的布尔解决方案是迄今为止最有效的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:06:00.307

我的建议是让*FileWriter*类记住文件的状态（已保存/已更改），因此您只需要使用此编写器，而无需在每次写入文件时处理布尔操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:04:38.090

如果文档不是很大，您可以在后台将其副本与用户可以编辑的副本分开，然后在应用程序关闭之前比较两者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T14:07:58.170

布尔变量是最好的主意。

```
boolean isDataChanged 
```

很好读，不会混淆代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T14:21:46.853

我刚刚在谷歌上为你找到了这个二进制比较方法，不保证它是否有效；）

```
/**
* Compare binary files. Both files must be files (not directories) and exist.
* 
* @param first  - first file
* @param second - second file
* @return boolean - true if files are binery equal
* @throws IOException - error in function
*/
public boolean isFileBinaryEqual(
  File first,
  File second
) throws IOException
{
  // TODO: Test: Missing test
  boolean retval = false;

  if ((first.exists()) && (second.exists()) 
     && (first.isFile()) && (second.isFile()))
  {
     if (first.getCanonicalPath().equals(second.getCanonicalPath()))
     {
        retval = true;
     }
     else
     {
        FileInputStream firstInput = null;
        FileInputStream secondInput = null;
        BufferedInputStream bufFirstInput = null;
        BufferedInputStream bufSecondInput = null;

        try
        {            
           firstInput = new FileInputStream(first); 
           secondInput = new FileInputStream(second);
           bufFirstInput = new BufferedInputStream(firstInput, BUFFER_SIZE); 
           bufSecondInput = new BufferedInputStream(secondInput, BUFFER_SIZE);

           int firstByte;
           int secondByte;

           while (true)
           {
              firstByte = bufFirstInput.read();
              secondByte = bufSecondInput.read();
              if (firstByte != secondByte)
              {
                 break;
              }
              if ((firstByte < 0) && (secondByte < 0))
              {
                 retval = true;
                 break;
              }
           }
        }
        finally
        {
           try
           {
              if (bufFirstInput != null)
              {
                 bufFirstInput.close();
              }
           }
           finally
           {
              if (bufSecondInput != null)
              {
                 bufSecondInput.close();
              }
           }
        }
     }
  }

  return retval;
} 
```

来源：[http ://www.java2s.com/Code/Java/File-Input-Output/Comparebinaryfiles.htm](http://www.java2s.com/Code/Java/File-Input-Output/Comparebinaryfiles.htm)

当您想保存文件并将其与您现有的文件进行比较时，您只需创建当前文件的文件对象；）

# mysql - 如果是数字，则按 ABS 排序 MySQL

> ID：13646743
> 
> 赞同：2
> 
> 时间：2012-11-30T14:01:32.737
> 
> 标签：mysql, sql-order-by

我需要在 MySQL 查询中使用 order by 订购一些信息。只有当第一个字符是数字时，是否有可能使用 ABS 函数？

伪示例：

```
SELECT * FROM table 
ORDER BY
(( name[0] = numeric ) ? ABS(name) : name)
ASC 
```

* * *

感谢您到目前为止的答案，尝试了很多您的答案，但我没有得到我想要的结果。

当前代码：

```
<?php
$filters = $this->db->query("
    SELECT
        tb_spec_feature.feature_id,
        tb_spec_feature.name
    FROM
        tb_spec_feature
    WHERE
        filter=1
");
$filters = $filters->result_array();
foreach($filters as $key=>$filter)
{
    $filters_sub = $this->db->query("
        SELECT DISTINCT
            tb_spec_value.value_id,
            tb_spec_value.name as value_name,
            tb_spec_sign.name as sign_name
        FROM
            tb_spec_fk
        INNER JOIN
            tb_spec_value
        ON
            tb_spec_value.value_id = tb_spec_fk.value
        LEFT JOIN
            tb_spec_sign
        ON
            tb_spec_sign.sign_id = tb_spec_fk.sign
        WHERE
            feature=".$this->db->escape($filter['feature_id'])."
        ORDER BY
            ABS(tb_spec_value.name) ASC
    ");
    $filters[$key]['values'] = $filters_sub->result_array();
}
?> 
```

这将输出（tb_spec_feature.name，然后是 tb_spec_value.name）：

**屏幕英寸**

*   7
*   7.7
*   7.9
*   8.9
*   9.7
*   10
*   10.1
*   12.1

**解析度**

*   800 x 480
*   1024×600
*   1024 x 768
*   1280 x 800
*   1280 x 768
*   1920 x 1200
*   2048 x 1536

**操作系统**

*   安卓 3.1
*   安卓
*   黑莓平板操作系统
*   安卓 3.2
*   安卓 2.3
*   安卓4.0
*   iOS 5
*   安卓 4.0.3
*   iOS 4
*   安卓 2.2
*   视窗 7 专业版
*   视窗 8
*   视窗 8 专业版
*   iOS 6

如您所见，英寸和分辨率都还可以，但操作系统的排序不好。如果我删除 ABS，结果将是：

**屏幕英寸**

*   10
*   10.1
*   12.1
*   7
*   7.7
*   7.9
*   8.9
*   9.7

**解析度**

*   1024×600
*   1024 x 768
*   1280 x 768
*   1280 x 800
*   1366 x 768
*   1920 x 1200
*   2048 x 1536
*   800 x 480

**操作系统**

*   安卓
*   安卓 2.2
*   安卓 2.3
*   安卓 3.1
*   安卓 3.2
*   安卓4.0
*   安卓 4.0.3
*   黑莓平板操作系统
*   iOS 4
*   iOS 5
*   iOS 6
*   视窗 7 专业版
*   视窗 8
*   视窗 8 专业版

正如您现在所看到的，操作系统的顺序很好，但英寸和分辨率却没有。我希望有人能帮助我:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:08:02.150

此代码是您的问题的 MySql 方式：

```
SELECT * FROM table 
ORDER BY
CASE WHEN LEFT(name, 1)>='0' AND LEFT(name, 1)<='9' THEN ABS(name) 
     ELSE name 
     END ASC 
```

（**编辑**）
但根据评论，对你更好：

```
ORDER BY ABS(name), name 
```

以这种方式工作：
如果 ABS() 可以应用于“name”，则数字结果值将被排序，但在相反的情况下，如果 ABS(name) 计算结果为 null（因为非数字没有 abs 值）然后order by 的第二个字段（名称）与排序相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:05:18.170

试试这个：-

```
CASE WHEN LEFT(name[0], 1) LIKE [0-9] then ABS(name) ELSE name END 
```

假设`name`为`numeric`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:09:25.827

你可以使用转换功能：

```
SELECT * FROM table ORDER BY CONVERT(name, SIGNED) 
```

这会将所有非数字转换为 0，因此您可以安全地将其结果传递给假定整数参数的函数：

```
ABS(CONVERT(name, SIGNED)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T20:10:29.987

知道了！但是，不是 SQL .. 我从查询中删除了 ABS，在处理查询时我使用了这个：

```
<?
function order_it($a,$b)
{
    return $a["value_name"] - $b["value_name"];
}

foreach($filters as $key=>$filter)
{
    if(isset($filter['values'][0]['value_name'][0]) AND is_numeric($filter['values'][0]['value_name'][0]))
    {
        usort($filter['values'],'order_it');
    }
    foreach($filter['values'] as $item)
    {
        echo $item['value_name'].'<br />';
    }
}
?> 
```

现在一切都正确订购了:)

# java - Gradle - Java 项目的多个依赖项

> ID：13646745
> 
> 赞同：0
> 
> 时间：2012-11-30T14:01:38.357
> 
> 标签：java, maven, gradle

刚刚开始尝试使用 gradle，但还没有走多远。请帮忙。

我遵循了文档，但它只显示了我无法工作的单个依赖项或依赖项。这是我的 build.gradle 文件：

```
apply plugin: 'java'
sourceCompatibility = 1.7
OFFICEDB_VERSION = 'JAN12R2'

repositories {
    mavenCentral()
}

dependencies {
    compile group:
            'org.hibernate:hibernate-validator:5.0.0.Alpha1',
            'javax.validation:validation-api:1.1.0.Alpha1',
            'com.exlogs.officedb:common:${OFFICEDB_VERSION}',
            'com.exlogs.officedb:officedb-service:${OFFICEDB_VERSION}',
            'com.exlogs:eventhub:1.0.0-RC1',
            'commons-httpclient:commons-httpclient:3.1'

testCompile group: 'junit', name: 'junit', version: '4.+'
} 
```

问题是当我在`gradle build`命令行上输入时，我得到：

```
FAILURE: Build failed with an exception.

* Where:
Build file 'C:\Dev\Code\officedb\manpower\build.gradle' line: 10

* What went wrong:
A problem occurred evaluating root project 'manpower'.
> Could not create a dependency using notation: {group=org.hibernate:hibernate-validator:5.0.0.Alpha1} 
```

但是查看文档应该没问题。此外，我发现的所有示例构建文件都相当小或只有一个依赖项。有没有人对使用 gradle 进行大型商业项目有任何看法。

谢谢亚当

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:32:37.333

您需要为每个依赖项指定配置（类似于 Maven 范围，即`compile`,`testCompile`等）：

```
dependencies {
    compile 'org.hibernate:hibernate-validator:5.0.0.Alpha1'
    compile 'javax.validation:validation-api:1.1.0.Alpha1'
    compile "com.exlogs.officedb:common:${OFFICEDB_VERSION}"
    compile "com.exlogs.officedb:officedb-service:${OFFICEDB_VERSION}"
    compile 'com.exlogs:eventhub:1.0.0-RC1'
    compile 'commons-httpclient:commons-httpclient:3.1'

    testCompile group: 'junit', name: 'junit', version: '4.+'
    testCompile 'org.mockito:mockito-all:1.9.0'
} 
```

`group`是提供依赖坐标 ( `group: 'junit', name: 'junit', version: '4.+'`) 的替代语法的一部分，而不是特殊关键字。

另请注意，您需要双引号才能在字符串中使用变量：

```
compile "com.exlogs.officedb:common:${OFFICEDB_VERSION}" 
```

# c++ - 为什么这个多集打印代码会导致永远循环？

> ID：13646757
> 
> 赞同：2
> 
> 时间：2012-11-30T14:02:44.940
> 
> 标签：c++, algorithm, multiset

我想打印出多重集中的每个重复项，但不知何故迭代器对我来说表现得很奇怪。如何修复此代码？这段代码导致了一个永远的循环，这让我感到惊讶。

```
#include <set>
#include <iostream>
#include <sstream>

static void print_duplicate(const std::multiset<int>& mset)
{
  std::stringstream error_msg;
  for (auto it = mset.begin(); it != mset.end(); ++it)
    {
      unsigned count = mset.count(*it);
      if (count < 2)
        continue;

      error_msg << "Duplicated numbers found:\n";

      for (unsigned i = 0; i < count; ++it, ++i)
        error_msg << "\tNum:" << *it << "\n";
    }

  std::cout << error_msg.str();
}

int main()
{
  std::multiset<int> mset;

  // fill it
  mset.insert(1);
  mset.insert(1);
  mset.insert(1);

  print_duplicate(mset);
} 
```

**编辑** 我在周期结束时添加了一个 --it

```
 for (unsigned i = 0; i < count; ++it, ++i)
    error_msg << "\tNum:" << *it << "\n";
  --it; // this line fix it
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:08:23.477

在您的外部循环内，您可能会增加`it`不止一次。因此，条件`it != mset.end()`可能永远不会为真，因为结尾已经被跳过。增加一个过去的迭代器是未定义的行为，这意味着它也可能静默失败。

一个可能的解决方案可能是也检查`it != mset.end()`内部`for`循环：

```
for (unsigned i = 0; (i < count) && (it != mset.end()); ++it, ++i)
    error_msg << "\tNum:" << *it << "\n"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T14:08:32.527

`for (unsigned i = 0; i < count; ++it, ++i)`当此循环结束时，`it`将等于，`mset.end()`并且由于您仍然拥有`++it`主循环中的另一个，因此您将得到不同的东西，`mset.end()`因此程序永远不会结束。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-30T14:08:33.787

问题似乎是您在没有发现的情况下滑过了终点。在`mset`你创建的，只有`1`s。这意味着`count`将是 3 并且嵌套`for`（一个 over `i`）将执行 3 次；当它完成时，`it`将等于`mset.end()`。然后控制到达外部的末尾`for`并`it`递增，变得非法，更重要的是，不同于`mset.end()`. 这意味着外循环永远不会终止。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T14:19:28.567

快速修复：在内循环之后添加一个额外的行：it--;

Angew 的回答中解释了原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T14:11:17.593

将 for 循环更改为：

```
for(std::container::iterator it=mset.begin(), it_next=it; it!=mset.end(); it=it_next) {
  ++it_next;
  ...
} 
```

本质上，您正在跳过循环的末尾，因为您正在根据迭代器检查变量。仅增加辅助迭代器将防止这种情况发生。

# maven - 我可以用 maven 创建一个 jar，并将其用作对主项目的依赖项吗？

> ID：13646761
> 
> 赞同：1
> 
> 时间：2012-11-30T14:03:00.117
> 
> 标签：maven, jar, wsdl, war

我有一个带有 web 服务和 WSDL 的项目。我已经使用axistools-maven-plugin 正确地创建了java 源代码，并且还为找到的每个WSDL 创建了一个文件夹。我现在必须遵循的步骤是：

1-为每个文件夹创建一个 Jar 并将其放在我项目的“lib”文件夹中

2-用这些罐子编译项目并创建一个战争

我怎样才能做到这一点？我可以在一个 POM 上完成所有工作吗？或者我需要为每个 WSDL 创建一个 POM 并将它们包含在父 POM 中？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:26:58.450

**只需通过mvn install**将您创建的包含 WSDL 的 jar 部署到您的位置存储库中，另一方面将其用作依赖项。

但最好像这样使用多模块构建：

```
 +--- root
        +--- p-wsdl
        +--- p-war 
```

# c# - 如何对仅使用子实体创建的域实体进行编程

> ID：13646771
> 
> 赞同：0
> 
> 时间：2012-11-30T14:03:49.313
> 
> 标签：c#, architecture, orm, domain-driven-design

需要很酷的软件架构师:)

我有两个实体：公司和用户。

当用户被添加到公司时，会创建一个员工实体。员工代表用户和公司之间的联系。没有访问列表，员工实体是无用的。换句话说，我有一些不变量：父实体（员工）必须与子实体（访问列表）一起创建。

我正在寻找在 c# 代码中实现这个不变量的设计解决方案。

Employee 实体具有带有必需参数的构造函数：

```
public class Employee
{
    public Employee(EmployeeCreationParams creationParams)
    {
        this.Company = creationParams.Company;
        this.User = creationCommand.User;
    }

    public Company { get; protected set; }

    public User { get; protected set; }

    // other state and logic
} 
```

子实体：

```
public class EmployeeAccessList
{
    public EmployeeAccessList(EmployeeAccessListCreationParams creationParams)
    { /* initialization logic */ }

    public Employee { get; protected set; }

    public OperationEnum Operation { get; protected set; }
} 
```

有通用存储库服务：

```
public class Repository
{
    public void Persist<TEntity>(TEntity entity)
    {
        // internal stuff
    }
} 
```

Employee 被创建然后持久化：

```
var employee = new Employee(creationParams);

_repository.Persist(employee); 
```

并且 acl 也得到了持久化：

```
var accessList = CreateAccessList();

foreach(var acl in accessList)
{
    _repository.Persist(acl);
} 
```

我找不到在员工创建逻辑中注入访问列表创建登录的正确方法。因此，父母和孩子都被视为一个整体。

我尝试将子创建逻辑添加到父构造函数中：

```
public class Employee
{
    public Employee(EmployeeCreationParams creationParams)
    {
        this.Company = creationParams.Company;
        this.User = creationCommand.User;

        var accessList = CreateAccessList();

        foreach(var acl in accessList)
        {
            _repository.Persist(acl);
        }
    }
} 
```

..但这个解决方案看起来不正确。子对象在父实体之前被持久化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T16:25:54.057

我认为您正试图将大量非常不同的东西放入太少的对象中。创建 Employee 时，您应该区分 3 个单独的职责：

*   员工**实例化**逻辑，换句话说，更新员工和所有相关实体。这与应用程序无关，应在域层中定义。由于创建 Employee 看起来有些复杂，因此[Factory](http://xebee.xebia.in/2009/12/23/domain-driven-design-creating-domain-objects/)可能是该工作的理想人选，而不是臃肿的 Employee 构造函数。

*   员工**坚持**。这属于基础设施层，在您的 ORM 和存储库实现中。在保存 Employee 时，最好利用 DDD 中的聚合概念和 ORM 来自动保存聚合中的所有实体（包括 AccessLists）。

*   决定**何时保存**新员工。这是特定于应用程序的，可以在创建员工的用例结束时在您的应用程序层服务中执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:21:52.937

那这个呢？

```
public class Employee
{
    public Employee(EmployeeCreationParams creationParams, EmployeeAccessList accessList)
    {
        this.Company = creationParams.Company;
        this.User = creationCommand.User;
        this.Access = accessList
    }
}

public class Repository
{
    public void Persist<TEntity>(TEntity entity)
    {
        // encapsulate the fact that ACLs are stored in a separate way than Employees
    }
} 
```

然后，您将获得作为公司-用户关系一部分的访问权限，这是有道理的。作为实现细节，您可能希望将它们存储在单独的表中，但客户端`Repository<Employee>`不需要关心这一点，您可以稍后更改该实现细节而无需更改这些客户端。您还可以控制这两个数据库调用的事务性，而无需向`Repository`客户端公开事务性实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-01T05:15:18.033

这是混合有界上下文的一个相当“经典”的案例。你有一个身份和访问控制 BC，你有一个员工 BC（或任何对你来说有意义的东西——人力资源、组织等）。在您的 Employee 中有一个 UserId 是可以的，但是通过在您的 Employee BC 中包含一个 User 对象，您可能会让生活变得比需要的更难。不过，拥有一个用户值对象是可以的。

希望有帮助。

# postgresql - 删除所有视图 postgres

> ID：13646772
> 
> 赞同：0
> 
> 时间：2012-11-30T14:03:53.223
> 
> 标签：postgresql

我有一个数据库，其中安装了旧版本的 PostGIS。我想轻松删除数据库中的所有视图（它们都来自 PostGIS）。有没有一种简单的方法可以做到这一点？即使只是简单地提取视图名称列表也是可以接受的，因为我可以只做一个大的 DROP VIEWS 语句。？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:11:59.903

这应该为您提供公共模式中的一组视图名称。将“沙盒”替换为您的数据库名称。

```
select table_name
from information_schema.views
where table_catalog = 'sandbox'
  and table_schema = 'public' 
```

# css - Visual Studio 中的 SASS 语法高亮显示

> ID：13646775
> 
> 赞同：22
> 
> 时间：2012-11-30T14:04:01.350
> 
> 标签：css, visual-studio-2010, visual-studio, visual-studio-2012, sass

[目前我在 Visual Studio http://www.mindscapehq.com/products/web-workbench](http://www.mindscapehq.com/products/web-workbench)中使用这个插件进行语法高亮

就个人而言，我根本不喜欢它。与其他编辑器相比，它的功能有限且格式较差。在我的自由职业者工作中，我使用对 SASS 有很好的支持的 Sublime Text 2 和 Aptana。但在我的工作中，我必须使用 Visual Studio。有没有人知道有 SASS 支持的好插件？

我不在乎它是否构建了我通过命令行执行的文件。我只想要具有良好语法支持的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-09T15:56:16.870

试试 SassyStudio。它是免费的，适用于 VS 2012/13：

[http://visualstudiogallery.msdn.microsoft.com/85fa99a6-e4c6-4a1c-9f00-e6a8129b6f4d?SRC=VSIDE](http://visualstudiogallery.msdn.microsoft.com/85fa99a6-e4c6-4a1c-9f00-e6a8129b6f4d?SRC=VSIDE)

我也不想为 Web Workbench 每年支付 39 美元。SassyStudio 非常适合我。

这是我正在使用的设置（[由开发人员提供给我](https://github.com/darrenkopp/SassyStudio/issues/27)）：

*   环境
    *   字体和颜色
    *   向下滚动
    *   “显示项目”
    *   单击一个项目，即“SCSS CSS 属性名称”
    *   更改“项目前景”颜色（不理会背景）
*   野蛮
    *   工作室实验智能感知：真
*   文本编辑器
    *   文件扩展名
    *   确保没有 css、scss 或 sass 文件扩展名（删除任何存在的文件）

重新启动 VS 以使这些更改生效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-16T08:56:01.330

试试这个 ：

在 VS 2012 打开菜单工具 > 选项，在左侧选择菜单文本编辑器 > 文件扩展名，然后添加 scss 作为扩展名并从下拉菜单中选择 CSS 源编辑器作为编辑器

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-03T10:33:35.720

Visual Studio 2013 Update 2 添加了 sass 语法高亮：

[http://blogs.msdn.com/b/webdev/archive/2014/04/02/announcing-new-web-features-in-visual-studio-2013-update-2-rc.aspx](http://blogs.msdn.com/b/webdev/archive/2014/04/02/announcing-new-web-features-in-visual-studio-2013-update-2-rc.aspx)

我只是在研究如何让指南针与它一起使用。:)

# sharepoint - 对扩展类使用 FindByIdentity 方法的目录服务

> ID：13646779
> 
> 赞同：2
> 
> 时间：2012-11-30T14:04:32.580
> 
> 标签：sharepoint, active-directory

从最近几天开始，我一直在使用目录服务。

使用 UserPrincipal 对象，我尝试从当前 AD 用户获取电子邮件和公司字段。电子邮件不是问题，因为默认情况下它是公开的。公司是另一回事。

我在这里找到了一篇解释如何执行此操作的帖子：[Get job title using System.DirectoryServices.AccountManagement](https://stackoverflow.com/questions/9540436/get-job-title-using-system-directoryservices-accountmanagement)

虽然，我对这种方法有一个不幸的问题。该帖子显示了如何在扩展类中创建 FindByIdentity 方法，但为了使其工作，您必须将搜索类型设置为您的扩展类类型，结果必须找不到我的特定用户的条目。如果我在 FindByIdentityWithType 中将搜索类型设置为 UserPrincipal，它确实会找到我的 AD 用户，但正如您所料，我遇到了转换错误。

所以我的问题很简单，有没有已知的方法可以在扩展类中按身份查找？

参考这里是我的扩展类：

```
[DirectoryObjectClass("group")]
[DirectoryRdnPrefix("CN")]
public class UserPrincipalClassExtensions : System.DirectoryServices.AccountManagement.UserPrincipal
{
    PrincipalContext context;

    public UserPrincipalClassExtensions(PrincipalContext context)
        : base(context)
    { this.context = context; }

    public UserPrincipalClassExtensions(PrincipalContext context, string samAccountName, string Password,bool enabled)
        : base(context, samAccountName, Password, enabled)
    {

    }

    [DirectoryProperty("company")]
    public string Company
    {
        get
        {
            if (ExtensionGet("company").Length != 1)
                return null;

            return (string)ExtensionGet("company")[0];

        }
        set { this.ExtensionSet("company", value); }
    }

    // Implement the overloaded search method FindByIdentity.
    public static new UserPrincipalClassExtensions FindByIdentity(PrincipalContext context, string identityValue)
    {
        return (UserPrincipalClassExtensions)FindByIdentityWithType(context, typeof(UserPrincipalClassExtensions), identityValue);
    }

    // Implement the overloaded search method FindByIdentity. 
    public static new UserPrincipalClassExtensions FindByIdentity(PrincipalContext context, IdentityType identityType, string identityValue)
    {
        return (UserPrincipalClassExtensions)FindByIdentityWithType(context, typeof(UserPrincipalClassExtensions), identityType, identityValue);
    }
} 
```

这是一个返回 null 的调用：

```
 SPUser user = SPContext.Current.Web.CurrentUser;
        using (PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, getUserDomain(user)))
        {
            UserPrincipalClassExtensions UserInfos = UserPrincipalClassExtensions.FindByIdentity(principalContext,IdentityType.SamAccountName,user.Name);

        } 
```

这是一个返回 UserPrincipal 但没有公司字段值的调用：

```
 SPUser user = SPContext.Current.Web.CurrentUser;
        using (PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, getUserDomain(user)))
        {
            UserPrincipal UserInfos = UserPrincipal.FindByIdentity(principalContext,IdentityType.SamAccountName,user.Name);

        } 
```

如果您需要任何进一步的信息，请告诉我！

提前感谢您！

编辑

在 IL Spy 中搜索并反编译 de DLL 后，我注意到我的代码有一个问题：

```
[DirectoryObjectClass("Person")]
[DirectoryRdnPrefix("CN")] 
```

DirectoryObjectClass 必须是“人”

希望这会帮助其他人！

# visual-studio-2010 - WinDbg 是如何使用的，它到底是什么，它与 .dmp 文件有关系吗？

> ID：13646781
> 
> 赞同：3
> 
> 时间：2012-11-30T14:04:42.917
> 
> 标签：visual-studio-2010, visual-c++, windbg

过去，我听说过使用 WinDbg 解析 .dmp 文件的参考资料（我认为 - 我可能错了）。

在 .map 文件的帮助下，我还进行了相当广泛的调试，并使用标准逻辑启发式和 Visual Studio 调试器进行了广泛的调试。

但是，有时，我正在开发的程序会崩溃并创建一个 .dmp 文件。我一直无法解释 .dmp 文件。前段时间，我发布了一个关于如何解释 .dmp 文件的 SO 问题（[如何在 Windows 7 上查看 .dmp 文件？](https://stackoverflow.com/questions/6318447/how-to-view-dmp-file-on-windows-7)），但经过一番努力后，我无法弄清楚如何使用答案来解释 .dmp 文件那个问题。

今天，我正在查看一个不相关的 SO 问题（[C++ try/throw/catch => machine code](https://stackoverflow.com/questions/1331220/c-try-throw-catch-machine-code)），并且在已接受答案下方的有用评论再次引用了 WinDbg。

> 如果你真的想找到它，这很容易 - 只需在 WinDbg 中追踪它

我想听从这个建议。*然而，对我来说，“只在 WinDbg 中追踪它*”并不容易。我过去曾尝试过，但无法弄清楚这到底意味着什么或该怎么做！

所以，我再试一次。“一劳永逸”，我希望得到关于以下方面的简单明了的说明：

1.  什么是WinDbg
2.  假设 WinDbg 与 .dmp 文件有关，转储文件到底是什么以及它与 WinDbg 有什么关系（如果我的假设错误，请纠正我）
3.  如何创建 .dmp 文件，以及如何使用 WinDbg 分析它们（再次，如果我对 WinDbg 和 .dmp 文件之间的关系有误，请纠正我）。

如果您可以请从仅安装和运行 Visual Studio 的程序员的“起点”回答这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:26:11.660

1.  WinDbg 是一个多用途的调试器。它可以像使用任何其他调试器一样通过附加、设置断点等来调试实时进程。它还可以分析故障转储文件，即 .dmp 文件。它通过你给它命令来发挥作用。

2.  .dmp 文件是某事的内存转储。那是什么取决于内存转储的用途。例如，它可以用于一个过程。它也可以用于内核。内存转储中的内容也取决于。在您的情况下，这可能是您的进程在崩溃时的样子。内存转储包含的内容可能因转储类型而异。

3.  有多种方式。在 Windows Vista+、Server 2008+ 上 - 您可以直接从任务管理器中执行此操作。右键单击该进程，然后单击“创建内存转储”。WinDbg 也可以使用该`.dump`命令从实时进程中进行内存转储。其他工具（如 adplus）可用于在某些条件下自动创建内存转储，例如当进程超过内存或 CPU 阈值时，或者当它崩溃时。

WinDbg 可以很容易地打开崩溃转储。重要的是您首先要正确加载符号。通常以 .pdb 文件的形式或来自符号服务器的形式（尽管不是必需的，或者总是可能的，但它非常有帮助）。

运行 WinDbg 后，查看可在故障转储中查找[的命令列表。](http://windbg.info/doc/1-common-cmds.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T14:41:16.400

1.  WinDbg 是命令行调试器 cdb.exe 的 Gui 版本，两者都是用户进程和内核模式调试器，它使用 DbgHelp.dll 向您的应用程序或 NT 内核发出命令（您也可以这样做，因为它有一个 api ）。
2.  .dmp 文件是不同细节的内存转储，有些可能只有最少的细节，足以用于所有线程的调用堆栈，而其他文件将放置整个用户模式内存、句柄信息、线程信息、内存信息等。有关更多信息，请参阅[此](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms680519%28v=vs.85%29.aspx). 所以dump文件跟WinDbg没什么关系，除了能打开外，还可以在[Visual Studio中打开.dmp文件](http://msdn.microsoft.com/en-us/library/fk551230.aspx)
3.  就像@vcsjones 已经说过你可以使用任务管理器来做到这一点（至少你可以从Vista 开始），你可以使用[procdump](http://technet.microsoft.com/en-gb/sysinternals/dd996900.aspx)，一旦附加了WinDbg，你就可以做到这一点，我通常会像这样做一个完整的迷你转储：`.dump /ma c:\mem.dmp`，你可以还使用[Dr. Watson](http://support.kaspersky.com/6443)将 Windows 设置为在发生崩溃时执行此操作

但是，您必须拥有 Windows 和应用程序的符号才能生成合理的调用堆栈，请注意，由于显而易见的原因，您不能在内存转储中单步执行或设置断点，您只能对实时进程执行此操作。您还可以非侵入式附加 WinDbg，因此可以附加 Visual Studio，您可以非侵入式附加 WinDbg 并使用 WinDbg 中的工具集来协助调试。

对我来说，WinDbg 的主要优点是它免费，下载和安装小，速度快，它有一个非常丰富的工具集，用于诊断使用 Visual Studio 很难或不可能解决的问题。

# vba - 将 VBA 转换为 VBS

> ID：13646782
> 
> 赞同：1
> 
> 时间：2012-11-30T14:04:54.570
> 
> 标签：vba, ms-access, vbscript, converter

我有一个小 VBA 脚本，其中包含一些我想转换为单个 VBS 文件的功能。

这是我得到的一个例子：

```
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long

Private Function ReadIniFileString(ByVal Sect As String, ByVal Keyname As String) As String
    Dim Worked As Long
    Dim RetStr As String * 128
    Dim StrSize As Long
    Dim iNoOfCharInIni As Integer
    Dim sIniString, sProfileString As String

    iNoOfCharInIni = 0
    sIniString = ""
    If Sect = "" Or Keyname = "" Then
        MsgBox "Erreur lors de la lecture des paramètres dans " & IniFileName, vbExclamation, "INI"
        Access.Application.Quit
    Else
        sProfileString = ""
        RetStr = Space(128)
        StrSize = Len(RetStr)
        Worked = GetPrivateProfileString(Sect, Keyname, "", RetStr, StrSize, IniFileName)
        If Worked Then
            iNoOfCharInIni = Worked
            sIniString = Left$(RetStr, Worked)
        End If
    End If
    ReadIniFileString = sIniString
End Function 
```

然后，我需要使用此函数将一些值放入字符串中。VBS 似乎不喜欢我的任何 var 声明 ( `(Dim) MyVar As MyType`)。

如果我能够使该代码适应 VBS，我也应该能够完成我的其余功能。如何将其调整/转换为 VBS？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T17:02:36.333

遗憾的是，我之前没有看到这一点，无论如何，为了将来的参考，这里是一个纯 vbscript 解决方案，用于从 ini 文件中读取值。如果有人需要对使用的正则表达式进行解释，请发表评论。

```
'this is the contents of test.ini'
' [Brussels]
' Address = "Postbox 3245_58348 Brussels"

' [Copenhagen]
' Address = "Postbox 2455_5478347 Copenhagen"

' [Paris]
' Address = "Postbox 8546_5412557 Paris"

section = "Brussels"
key = "Address"

const ForReading = 1
set fso = CreateObject("Scripting.FileSystemObject")
set file = fso.OpenTextFile("test.ini", ForReading)

'returns "Postbox 3245_58348 Brussels"'
wscript.echo get_key_of_ini(file.readall, section, key)

function get_key_of_ini(readFile, section, key)
  set regEx = New RegExp
  with regEx
    .Pattern = "(\[" & section & "\]\r\n)([^\[]+)"
    .IgnoreCase = True 
    .Global = True
  end With

  set matches  = regEx.execute(readFile)
  for x = 0 to matches.count-1
    set match = matches(x)
    For i = 1 To match.subMatches.count-1
      subMatches = match.SubMatches(i)
      if trim(split(match.SubMatches(i),"=")(0)) = key then
        get_key_of_ini = trim(split(match.SubMatches(i),"=")(1))
      end if
    Next
  next
end function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T15:22:07.590

由于您有一个 MDB 可以执行您想要的操作，因此运行 VBS 脚本以打开此 mdb 并设置 AutoExec 宏以运行压缩这些数据库的函数，然后自行关闭 MDB。这有点hacky，但可能被证明是最不麻烦的。

# java - 卡在 AVD 中运行的 android 应用程序

> ID：13646788
> 
> 赞同：2
> 
> 时间：2012-11-30T14:05:10.347
> 
> 标签：java, android, mobile

所以我在 android 网站上下载了 ADT 包。我尝试制作一个简单的项目，即带有 HelloWord 程序的项目。我已经添加了一个 AVD 并尝试运行我的应用程序。起初，我被困在

“等待 HOME ('android:process:acore') 启动”

但是在网上搜索后，我了解到我必须右键单击我的项目并单击作为 Android 应用程序运行，然后它才能在控制台中继续下一个 lnes。

但是经过几行之后，它卡在控制台中的行上

“在设备模拟器上启动 activity.com.example.myfirstapp.MainActivity:5554”

从那条线到现在已经一个小时了，AVD 中什么也没发生。我尝试使用 2 个 ADT 捆绑包，一个用于我的 32 位计算机，一个用于我的 64 位计算机。两者都卡在同一条线上。我该如何解决这个问题？我整天都在处理这个问题。就在我认为这将是一个简单的安装时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T22:22:02.133

可以真正坚持您的程序的一件事是消耗太多资源的虚拟设备。尝试降低虚拟设备的 RAM 容量。还要确保您安装了最新的 JDK/JRE。刚刚拿起这本书： [http:](https://rads.stackoverflow.com/amzn/click/com/B00EEI5NHO) //www.amazon.com/Android-Development-From-Eclipse-ebook/dp/B00EEI5NHO/ 写得很好，很容易理解。详细介绍如何构建应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-11T22:32:26.950

实际上 AVD 在正常配置系统上运行速度很慢，它需要非常高配置的 PC 才能顺利运行，您必须等待一段时间才能继续使用 AVD，它会启动不用担心。但我建议您使用 USB 调试功能在真正的 android 设备上运行和测试您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:27:24.317

从 Android Virtual Device(AVD) Manager 启动您的模拟器并运行您的应用程序

# ios - 您可以从 IOS 应用程序内的 UIWebView 下载存折优惠券吗？

> ID：13646795
> 
> 赞同：5
> 
> 时间：2012-11-30T14:05:34.247
> 
> 标签：ios, uiwebview, passbook

是否可以在不修改应用程序以支持新的 MIME 类型或像 Sparrow 那样的未知 MIME 类型的情况下从 web 视图中下载和添加存折？

我有一个带有 webview 的新闻 ios 应用程序。在 webview 中，我显示新闻项目和横幅。当您单击横幅时，我想打开 .pkpass 文件的 url 并将其添加到我的存折中。相反，我得到一个 FrameLoadInterrupted 错误，并且没有任何可见的事情发生。如果我从 safari 打开 url 这工作正常，chrome，因为本周早些时候（版本 23）也会按预期打开 url。

这可能是苹果的一些奇怪策略吗？不允许此 MIME 类型从 web 视图正确打开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T15:26:34.817

我最好的选择是它`UIWebView`无法处理 Passbook 通行证。`UIWebViewDelegate`但是，您可以尝试在方法中捕获下载`-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType`。

我的意思是你必须自己处理这部分，因为我使用的[http://passkit.com/samples/](http://passkit.com/samples/)不会返回一个结束的 url，`pkpass`因此它完全取决于你如何请求存折文件。

如果您确实包含`.pkpass`扩展名，则可以在请求中检查扩展名。

如果您知道存折文件的 URL 类型，您可以在此处编写自己的下载代码并通过[存折 api](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/PassKit_PG/Chapters/Introduction.html)将其传递给存折。

* * *

对此似乎没有什么好的解决方法，您可以在 safari 中加载失败的 ULR：

```
- (void) webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error {
    NSLog(@"Webview: %@", error);

    if ([error.domain isEqualToString:@"WebKitErrorDomain"] && error.code == 102) {
        NSString *failedURL = [error.userInfo objectForKey:NSURLErrorFailingURLStringErrorKey];

        if (failedURL == nil) {
            return;
        }
        NSURL *url = [NSURL URLWithString:failedURL];

        [[UIApplication sharedApplication] openURL:url];
    }
} 
```

但这只是非常糟糕的编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-10T22:58:30.533

好的，与 WWDC 的工程师交谈，这是 UIWebView 中的一个已知错误，但 Apple 可能不会修复它，因为他们鼓励人们采用新的 SFSafariViewController。如果您需要支持 iOS 6-8，我们确实想出了一个 hack 来修复它：

1.  如果尚未将 PassKit 框架添加到项目中。

    ```
    #import <PassKit/PassKit.h> 
    ```

2.  为 UIWebView 设置委托（例如启动 UIWebView 的视图控制器）

    ```
    <UIWebViewDelegate> 
    ```

3.  添加一个类变量来缓存 UIWebView 请求

    ```
    NSURLRequest *_lastRequest; 
    ```

4.  设置委托

    ```
    self.webView.delegate = self; 
    ```

5.  添加回调以抓取所有请求并在失败时缓存

    ```
    - (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
        _lastRequest = request;
        return YES;
    } 
    ```

6.  添加失败回调并重新获取 URL 以查看它是否是通过，如果是，则向用户呈现该通行证

    ```
    - (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error {
        // try to get headers in case of passbook pass
        NSOperationQueue *queue = [[NSOperationQueue alloc] init];
        [NSURLConnection sendAsynchronousRequest:_lastRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *connectionError) {
            // check for PKPass
            if ([response.MIMEType isEqualToString:@"application/vnd.apple.pkpass"]) {
                NSError *error;
                PKPass *pass = [[PKPass alloc] initWithData:data error:&error];
                if (error) {
                    NSLog(@"Error: %@", error);
                } else {
                    PKAddPassesViewController *apvc = [[PKAddPassesViewController alloc] initWithPass:pass];
                    [self presentViewController:apvc animated:YES completion:nil];
                }
            }
        }];
    } 
    ```

对于应该支持的内容来说，这是一个可怕的黑客攻击，但无论扩展名如何，它都可以工作，并且应该支持重定向。如果想堆上bug train，可以参考radar://21314226

# javascript - 我应该使用什么来代替 document.write 弹出窗口

> ID：13646800
> 
> 赞同：3
> 
> 时间：2012-11-30T14:06:10.780
> 
> 标签：javascript, html, document.write

在我的网页中，我打开一个弹出窗口并使用 JavaScript/jQuery 为弹出窗口生成 HTML：

```
var site="<html> ............. </html>";
var popupWindow = window.open("","","menubar=0,scrollbars=0");
popupWindow.document.write(site); 
```

问题是，弹出窗口在状态栏中显示“正在阅读”。我应该使用什么来代替 document.write()？

编辑：

```
document.close(); 
```

应该做的工作，谢谢。不幸的是，我的框架可能会干扰，所以它在 FF 中不适合我。IE 工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:11:31.540

写完后必须关闭文档：

```
var site="<html> ............. </html>";
var popupWindow = window.open("","","menubar=0,scrollbars=0");
popupWindow.document.write(site);
popupWindow.document.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:22:47.240

```
popupWindow.document.close(); 
```

将其添加到末尾将解决问题。我以前在这里找到它：http: [//p2p.wrox.com/javascript-how/36703-javascript-popup-keeps-loading.html](http://p2p.wrox.com/javascript-how/36703-javascript-popup-keeps-loading.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T15:53:14.450

你应该使用 jQuery 的`append()`

```
var win = window.open();
    var popup = win.document.body;
    $(popup).append('site html'); 
```

或者`innerHTML`

```
var popup = window.open();
popup.document.body.innerHTML = 'site data here'; 
```

# django - 防止创建社交帐户

> ID：13646805
> 
> 赞同：6
> 
> 时间：2012-11-30T14:06:42.383
> 
> 标签：django, django-authentication, django-allauth

是否可以在某些情况下阻止帐户创建，最好使用 pre_social_login 信号？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-11T10:17:59.697

使用当前的开发分支，您可以轻松地做到这一点。在您的设置中：

```
SOCIALACCOUNT_ADAPTER = 'my.adapter.MySocialAccountAdapter' 
```

然后使用这个adapter.py：

```
from django.http import HttpResponse

from allauth.socialaccount.adapter import DefaultSocialAccountAdapter
from allauth.exceptions import ImmediateHttpResponse

class MySocialAccountAdapter(DefaultSocialAccountAdapter):
    def pre_social_login(self, request, sociallogin):
        raise ImmediateHttpResponse(HttpResponse('Closed for the day')) 
```

或者，从您的信号中引发类似的异常`pre_social_login`（尽管我不喜欢这种方法 - 请参阅[https://github.com/pennersr/django-allauth/blob/master/allauth/socialaccount/adapter.py的文档说明# L15](https://github.com/pennersr/django-allauth/blob/master/allauth/socialaccount/adapter.py#L15)

# jakarta-ee - JBoss(Tomcat)/Apache 连接

> ID：13646806
> 
> 赞同：0
> 
> 时间：2012-11-30T14:06:48.407
> 
> 标签：jakarta-ee, jboss, web-deployment

我正在运行 JBOSS AS 7.1.1 服务器和单独的 apache Web 服务器。我在 JBoss 服务器上有两个 EAR 部署，每个部署在 Web 服务器上都有一个 apache 虚拟主机配置。一个有效，另一个无效。两种部署都使用 RESTEasy（尽管我认为这不是问题所在），并且都使用 jboss-server:8080 接口。

在我看来，最显着的区别是一个使用 2.4 版本，另一个使用新的 3.0 版本。

这是 2.4 版的网络应用程序，工作部署：

```
<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
 version="2.4">

  <display-name>Sokoban Mobile WAR</display-name>

  <servlet-mapping>
    <servlet-name>javax.ws.rs.core.Application</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping>

</web-app> 
```

这是不工作的 3.0 部署：

```
<web-app
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0" >

  <display-name>Voyager Web Application</display-name>

  <listener>
    <listener-class>
      org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap
    </listener-class>
  </listener>

  <servlet>
    <servlet-name>Resteasy</servlet-name>
    <servlet-class>
      org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher
    </servlet-class>
    <init-param>
      <param-name>
    javax.ws.rs.Application
      </param-name>
      <param-value>
    com.nutrastat.voyager.web.VoyagerApplication
      </param-value>
    </init-param>
  </servlet>

  <servlet-mapping>
    <servlet-name>Resteasy</servlet-name>
    <url-pattern>/*</url-pattern>
  </servlet-mapping>

</web-app> 
```

两种部署都有一个 jboss-web，看起来像这样：

```
<?xml version="1.0"?>
<jboss-web>
  <context-root>/dir</context-root>
</jboss-web> 
```

`dir`替换为 apache 设置中配置的适当上下文。

那么使用 3.0 版本的 web-app 部署需要做什么呢？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T13:59:17.613

我找到了解决我的问题的方法。这不是配置问题，而是 URL 中的错误。我的手指麻烦。

我感谢丹尼尔的帮助。他强迫我仔细观察我在做什么，从而我发现了我的愚蠢错误。

# eclipse - 无法禁用规则

> ID：13646807
> 
> 赞同：3
> 
> 时间：2012-11-30T14:06:49.733
> 
> 标签：eclipse, pmd

我对在 Eclipse 中使用 PMD 感到有点困惑。

我已经从我的规则集中删除并添加了规则，但看起来 PMD 没有考虑我的更改，而只是针对删除的规则，也就是说，它在检查时应用了我的新规则，但仍然应用删除的规则。

此外，当我单击*“清除违规评论”*时，它什么也不做。

知道我做错了什么吗？提前致谢。

# php - 特殊字符竖线（|）在php中自动更改为HEX代码？

> ID：13646811
> 
> 赞同：0
> 
> 时间：2012-11-30T14:07:12.350
> 
> 标签：php, special-characters, domdocument

我使用 php domDocument 来解析 HTML 内容并将文本附加到图像标签的 url 并将其保存为 HTML。

我的PHP代码如下：

```
$dom = new domDocument;
libxml_use_internal_errors(true);
$dom->loadHTMLFile('test.html');
libxml_use_internal_errors(false);
$dom->preserveWhiteSpace = false;
$images = $dom->getElementsByTagName('img');
foreach($images as $img)
{
    $url = $img->getAttribute('src');   
    $alt = $img->getAttribute('alt');
    echo $src = 'http://api.imgble.com/resize|0.5|0.5/'.$url;
    $img->setAttribute( 'src' , $src);
}
$str=$dom->saveHTML();
print $str; 
```

问题是当我`$src`在保存之前打印 url() 时，它显示的特殊字符与它显示的完全一样。

```
http://api.imgble.com/resize|0.5|0.5|0/http://farm1.static.flickr.com/57/197881059_aeb724b1cf.jpg 
```

但是当我保存并打印它时，它显示了那个特殊字符的十六进制代码，即那个垂直条的 %7C **|** 如下：

```
http://api.imgble.com/resize%7C0.5%7C0.5%7C0/http://farm1.static.flickr.com/57/197881059_aeb724b1cf.jpg 
```

我什至使用了那个特殊字符的数字代码，甚至使用`html_entity_decode()`. 但没有任何效果。有人遇到过这个问题吗？

# linux - Bash-创建一个数组并增加每个索引-然后是最大索引

> ID：13646814
> 
> 赞同：0
> 
> 时间：2012-11-30T14:07:28.563
> 
> 标签：linux, arrays, bash

知道问题一目了然，我有这张表：

```
 ID Start End
   1  1     4
   2  2     5
   3  4     9
   4  8     10 
```

我想按顺序设置这些（下图）。我需要一个数组，它的索引将相对于开始和结束位置增加一，并获得最大的索引。例如：

```
1\. ####
2\.  ####
3\.    ######
4\.        ### 

so array will be;
    array =(1,2,2,3,2,1,1,2,2,1) 
```

我没有开始写任何东西，因为我不知道 bash 是否可行。请指教..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:28:56.777

只需遍历每个区间的所有元素：

```
#! /bin/bash

array=()
while read id start end ; do
    for (( i=start ; i<=end ; i++ )) ; do
        let array[i]++
    done
done << EOF
1  1     4
2  2     5
3  4     9
4  8     10
EOF

echo "${array[@]}" 
```

# sql-server-2008 - 多个 BIT 列的逗号分隔值

> ID：13646816
> 
> 赞同：0
> 
> 时间：2012-11-30T14:07:30.670
> 
> 标签：sql-server-2008, tsql

Hy，我有多个值，我需要一个检查列表，
例如：
`1,2,4,`
`3,4,`应该是：

```
day1 day2 day3 day4  
_1____1____0____1
_0____0____1____1 
```

一种方法是

```
CAST(CASE WHEN PATINDEX('1,', [day]) > 0 THEN 1 ELSE 0 END AS BIT) as [day1],  
CAST(CASE WHEN PATINDEX('2,', [day]) > 0 THEN 1 ELSE 0 END AS BIT) as [day2],  
CAST(CASE WHEN PATINDEX('3,', [day]) > 0 THEN 1 ELSE 0 END AS BIT) as [day3],  
CAST(CASE WHEN PATINDEX('4,', [day]) > 0 THEN 1 ELSE 0 END AS BIT) as [day4] 
```

请帮助我更好的方法，因为我有多个列
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:06:23.733

您可以将您选择的字符串拆分功能与 pivot 一起使用。

```
declare @T table
(
  ID int identity,
  day varchar(20)
)

insert into @T values
('1,2,4,'),
('3,4,')

select isnull(P.[1], 0) as day1,
       isnull(P.[2], 0) as day2,
       isnull(P.[3], 0) as day3,
       isnull(P.[4], 0) as day4
from 
  (
  select T.ID, S.s, 1 as x
  from @T as T
    cross apply dbo.Split(',', T.day) as S
  ) as T
pivot (min(T.x) for T.s in ([1],[2],[3],[4])) as p 
```

结果：

```
day1  day2  day3  day4
1     1     0     1
0     0     1     1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:17:24.923

[您可以使用此处](http://blog.logiclabz.com/sql-server/split-function-in-sql-server-to-break-comma-separated-strings-into-table.aspx)概述的拆分功能，然后将值转换为列。

或者！

[这个](https://stackoverflow.com/questions/10581772/sql-server-2008-how-to-split-a-comma-seperated-value-to-columns)答案看起来和你想做的一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:21:10.420

使用第二个表存储有效日期，然后对其进行查询。看到这个[小提琴](http://sqlfiddle.com/#!3/4915a/1)。

**编辑** 见更新的[小提琴](http://sqlfiddle.com/#!3/39889/9)，或下面的代码：

```
create table test (day1 varchar(8), day2 varchar(8), day3 varchar(8), day4 varchar(8));
insert into test (day1, day2, day3, day4) values ('day1', 'day2', 'day3', 'day4');

create table valid_days (valid_day_no int);
insert into valid_days values (1), (2), (4);

select cast (case when exists(select 1 from valid_days where valid_day_no = substring(day1, 4, len(day1))) then 1 else 0 end as bit) day1,
       cast (case when exists(select 1 from valid_days where valid_day_no = substring(day2, 4, len(day2))) then 1 else 0 end as bit) day2,
       cast (case when exists(select 1 from valid_days where valid_day_no = substring(day3, 4, len(day3))) then 1 else 0 end as bit) day3,
       cast (case when exists(select 1 from valid_days where valid_day_no = substring(day1, 4, len(day4))) then 1 else 0 end as bit) day4
from test; 
```

请注意，SQL 是一种固定列语言，您需要使用一种编程语言来动态构建可变长度的列查询。

# c++ - c++ 中的类的链接器错误

> ID：13646821
> 
> 赞同：0
> 
> 时间：2012-11-30T14:07:55.560
> 
> 标签：c++, class

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我已经创建了这段代码

```
 class Game{
    static SDL_Surface* screen;
public:
    //Initiate Game(SDL_Graphics, folder for output.....) 
    static void initialize();
    static void initializeScreen();

};

void Game::initializeScreen()
{

    Game::screen = SDL_SetVideoMode( SCREEN_WIDTH, SCREEN_HEIGHT, 32,  SDL_DOUBLEBUF |SDL_HWSURFACE |SDL_SWSURFACE);
    SDL_Init(SDL_INIT_VIDEO);
    Game::screen == NULL ? printf("SDL_Init failed: %s\n", SDL_GetError()):printf("SDL_Init initialized\n");
    SDL_WM_SetCaption("SDL Animation", "SDL Animation");
} 
```

它编译但我得到 e 链接器错误，我该如何解决这个问题？

```
1>game.obj : error LNK2001: unresolved external symbol "private: static struct SDL_Surface * Game::screen" (?screen@Game@@0PAUSDL_Surface@@A) 
```

**编辑：**这就是我修复它的方式，在 game.cpp 中添加了这个

```
SDL_Surface* Game::screen; 
```

在任何功能之外*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:11:51.273

您需要在您的 cpp 文件中添加以下定义`SDL_Surface* Game::screen = NULL`。

* * *

这是一个示例代码，您可以在其中`static`使用函数在 cpp 文件中定义变量而无需定义它。

```
#include <iostream>

struct Lazy {
    static int& GetValue() {
        static int a = 0;
        return a;
    }
};

int main() {
    std::cout << Lazy::GetValue() << std::endl;
    int& a = Lazy::GetValue();
    a = 1;
    std::cout << Lazy::GetValue() << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:24:49.117

您必须在单独的源文件（*.cpp）中定义静态（变量）成员（不是函数）并链接它们。

例如：

```
//MyClass.h
class MyClass {
    static int x;
};

//MyClass.cpp
#include "MyClass.h"
int MyClass::x; 
```

# jquery - Backbone.js - 自定义 JQuery 事件

> ID：13646826
> 
> 赞同：0
> 
> 时间：2012-11-30T14:08:07.560
> 
> 标签：jquery, backbone.js, marionette, jquery-events, backbone-events

我对 Backbone (Marionette) 和 jQuery 自定义 DOM 事件有疑问。

我有自定义插件，当`changed_currency`在文档上触发事件时更新元素的 html 内容。

```
$(document).on
  changed_currency: ->
    # omitted code
    $(@).html("some html")
, '.currency-change' 
```

这里没有什么花哨的。它适用于不使用 Backbone 的页面。但是，在主干视图中，此代码根本不起作用（未捕获事件）。所以我的问题是，我可以从我的 Backbone 视图中触发自定义事件吗？

骨干代码：

```
#omitted code
ui: 
   currency_change: '.currency_change'

onRender: () =>
  #omitted code
  @ui.currency_change.trigger('changed_currency') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T17:58:06.367

这不起作用，因为该`onRender`函数是在函数的 Marionette 实现结束时调用的`render`。该`render`函数将视图的 HTML 呈现为不属于 DOM 的元素。

**直到您将其实际插入到 DOM 中，您的事件处理程序`document`才会捕获您触发的事件。**

如果您正在利用 Marionette 的区域概念，那么您可以通过将`trigger`调用移至`onShow`函数来解决您的问题。否则，您需要将`trigger`调用移动到实际插入`view.el`DOM 的任何位置之后。

```
// In view
onShow : function () {
  this.ui.currency_change.trigger('changed_currency');
}

// View instantiation code
var view = new SomeView();
App.someRegion.show(view); 
```

# asp.net-mvc - 用于 EnyimMemcached 问题的 protobuf-net 转码器

> ID：13646827
> 
> 赞同：3
> 
> 时间：2012-11-30T14:08:08.750
> 
> 标签：asp.net-mvc, protobuf-net, enyim.caching

从 protobuf-net 到 enyim 缓存的转码器是否已弃用？[使用 protobuff-net 进行分布式缓存](http://marcgravell.blogspot.com.br/2010/01/distributed-caching-with-protobuf-net.html)

当我尝试启动 MemcachedClient() 时，像这个[app.config一样设置我的 Enyim 配置会导致错误](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/app.config)

> 转码器类型="ProtoBuf.Caching.Enyim.NetTranscoder"/

```
System.TypeInitializationException was unhandled by user code
HResult=-2146233036
Message=The type initializer for 'Enyim.Caching.MemcachedClient' threw an exception.
Source=Enyim.Caching
TypeName=Enyim.Caching.MemcachedClient
StackTrace:
   at Enyim.Caching.MemcachedClient..ctor()
   at Global.asax.cs:line 31
InnerException: System.Configuration.ConfigurationErrorsException
   HResult=-2146232062
   Message=The value of the property 'transcoder' cannot be parsed. The error is: Object reference   not set to an instance of an object. (\web.config line 207)
   Source=System.Configuration
   BareMessage=The value of the property 'transcoder' cannot be parsed. The error is: Object reference not set to an instance of an object.
   StackTrace:
        at System.Configuration.BaseConfigurationRecord.EvaluateOne(String[] keys, SectionInput input, Boolean isTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult)
        at System.Configuration.BaseConfigurationRecord.Evaluate(FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentResult, Boolean getLkg, Boolean getRuntimeObject, Object& result, Object& resultRuntimeObject)
        at System.Configuration.BaseConfigurationRecord.GetSectionRecursive(String configKey, Boolean getLkg, Boolean checkPermission, Boolean getRuntimeObject, Boolean requestIsHere, Object& result, Object& resultRuntimeObject)
        at System.Configuration.BaseConfigurationRecord.GetSection(String configKey)
        at System.Web.HttpContext.GetSection(String sectionName)
        at System.Web.Configuration.HttpConfigurationSystem.GetSection(String sectionName)
        at System.Web.Configuration.HttpConfigurationSystem.System.Configuration.Internal.IInternalConfigSystem.GetSection(String configKey)
        at System.Configuration.ConfigurationManager.GetSection(String sectionName)
        at Enyim.Caching.MemcachedClient..cctor() in MemcachedClient.cs:line 25
   InnerException: 
```

两者都通过 nuget 安装并使用可用的最新版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:19:49.190

是的（咳嗽），当然有！只看“protobuf-net.Enyim”，即

> PM> Install-Package protobuf-net.Enyim

（或使用 GUI 客户端）

要初始化，您需要将转码器配置为`ProtoBuf.Caching.Enyim.NetTranscoder`（按照原始说明）的一个实例。如果您通过配置执行此操作，请注意此类型的程序集现在是`protobuf-net.Enyim`. 如果我假设配置文件使用标准符号，那么这意味着您需要指定（在配置中）：

```
<transcoder type="ProtoBuf.Caching.Enyim.NetTranscoder,protobuf-net.Enyim" /> 
```

* * *

原答案：

enyim 转码器当前不在 nuget 中；但是 - 我*现在*将通过添加一个单独的 NuGet 包（参考 EnyimMemcached 和 protobuf-net）来恢复它，将其重新添加回来。

随机问题...您是否有机会将我指向二进制 memcached 下载进行测试？

这已经滞后的一个原因是，当我*第一次*编写 enyim 转码器时，memcached 是一个简单的“运行这个” - 但上次我看起来它已经全部“企业”了，我无法找到一个刚刚拥有的简单包memcached 服务器。如果你能告诉我它现在在哪里*，*我会在这个周末让它工作。

# c++ - 使用 cygwin 从 C++ 调用 matlab

> ID：13646829
> 
> 赞同：1
> 
> 时间：2012-11-30T14:08:15.613
> 
> 标签：c++, windows, matlab, makefile, cygwin

我在 Windows 中工作，想将数据从 C++ 发送到 Matlab。我得到的印象是创建一个makefile最容易完成。因此我安装了 cygwin 来使用 make 命令。

我的makefile如下：

```
CXX = g++
CFLAGS = -O3 -I /cygdrive/c/Program\ Files/MATLAB/R2011a/extern/include
LIBS = -L /cygdrive/c/Program\ Files/MATLAB/R2011a/extern/lib/win64/microsoft/
LIBS2 = -L /cygdrive/c/Program\ Files/MATLAB/R2011a/extern/lib/win64/microsoft/libmx.lib
LDFLAGS = -leng -lmx

RKspace2d: RKspace2d.o
    $(CXX) -o $@ $^ $(LDFLAGS) $(LIBS)

RKspace2d.o: RKspace2d.cpp
    $(CXX) -c $(CFLAGS) $(LIBS) $<
# $@ name of the target
# $^ name of all prerequisites with duplicates removed
# $< name of the first prerequisite 
```

当我在 cygwin 终端中输入“make”时，在正确的目录中，我收到以下错误：

```
$ make
g++ -o RKspace2d RKspace2d.o -leng -lmx -L /cygdrive/c/Program\ Files/MATLAB/R2011a/extern/lib/win64/microsoft/
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -leng
/usr/lib/gcc/i686-pc-cygwin/3.4.4/../../../../i686-pc-cygwin/bin/ld: cannot find -lmx
collect2: ld returnerede afslutningskoden 1
makefile:8: recipe for target `RKspace2d' failed
make: *** [RKspace2d] Error 1 
```

我相信路径是正确的，因为 libeng.lib 和 libmx.lib 都包含在 microsoft 文件夹中。

希望你们能帮助托马斯

# c++ - 防止 C 整数溢出

> ID：13646835
> 
> 赞同：9
> 
> 时间：2012-11-30T14:08:26.143
> 
> 标签：c++, c, linux

我在函数中有一些代码，它将使用增量/减量运算符更改/更新值。例如：

```
static void update_value(char op)
{
    if (op == '+')
        value++;    // uint32_t global value
    else
        value--;
} 
```

该函数不检查我们是否超过/低于最大值/最小值。因此，当值为 16 时，调用者可以调用它 20 次。结果为 2^32 - 1 - 4。

我想提防这种情况，但我想使用标准库常量。我记得有一个 size_t （或类似的）变量表示 uint32_t 可以容纳的最大数字。

我不记得确切的常量或定义它们的标题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-30T14:12:06.113

在 C 中，你想要的头文件是`<stdint.h>`，常量是`UINT32_MAX`

```
static void update_value(char op)
{
    if (op == '+')
        if ( value < (UINT32_MAX - 1))
            value++;    // uint32_t global value
        else
            printf("too big!\n");
    else
       if (value > 0)
           value--;
       else
           printf("too small!\n");
} 
```

对于 C++，您可以使用此处找到的任意数量的解决方案：[UINT32_MAX 的 C++ 等价物是什么？](https://stackoverflow.com/questions/1471353/whats-the-c-equivalent-of-uint32-max)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-30T16:51:05.263

我发现最通用的解决方案是检查增加的值是否实际上大于先前的值，或者减少的值是否小于先前的值。这**仅在值是 unsigned 时才**有效，与变量的大小无关，并且几乎与 C 代码一样可移植。

```
static void update_value(char op)
{
  if (op == '+') {
    if (value + 1 > value) value ++;
  } else {
    if (value - 1 < value) value --;
  }
} 
```

请注意，代码**可能碰巧使用有符号值**，但根据 C 标准，这将是未定义的行为，编译器可以自由替换`if (value + 1 > value) ...`为`if (1) ...`. 您不应**将此**代码与签名值一起使用，除非您有适当的流程在*链接生成的目标代码后对其*进行审核。

使用 gcc 和 clang，您需要添加`-fwrapv`选项以让此代码适用于有符号值；使用其他编译器，您的里程可能会有所不同。

一种明智的做法是指定类型并使用来自`limits.h`. 例如：

```
#include "limits.h"

static void update_int(char op, int *value)
{
  int val = *value; // ignoring NULL pointer dereference

  if (op == '+') {
    if (val != INT_MAX) *value = val + 1;
  } else {
    if (val != INT_MIN) *value = val - 1;
  }
}

static void update_int(char op, unsigned int *value)
{
  unsigned int val = *value; // ignoring NULL pointer dereference

  if (op == '+') {
    if (val != UINT_MAX) *value = val + 1;
  } else {
    if (val != UINT_MIN) *value = val - 1;
  }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-30T14:10:16.557

也许您正在寻找`<limits>`：[http ://www.cplusplus.com/reference/limits/numeric_limits/](http://www.cplusplus.com/reference/limits/numeric_limits/)

你可以做这样的事情来得到你想要的：

`unsigned int n = numeric_limits<unsigned int>::max()`

你也有这个`<cstdint>`：[http ://www.cplusplus.com/reference/cstdint/](http://www.cplusplus.com/reference/cstdint/)

UINTN_MAX：精确宽度无符号类型的最大值（正好 2^N-1）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-30T14:10:05.373

如果您使用的是 C，那么您正在寻找[limits.h](http://www.cplusplus.com/reference/climits/)。你想要的宏是`UINT_MAX`.

如果你在 C++ 世界，你想要[`std::numeric_limits<uint32_t>::max()`](http://www.cplusplus.com/reference/limits/numeric_limits/).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-30T14:12:30.887

检查`#include <stdint.h>`和[http://en.wikipedia.org/wiki/C_data_types#Fixed_width_integer_types](http://en.wikipedia.org/wiki/C_data_types#Fixed_width_integer_types)

您正在寻找的是`UINT32_MAX`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-30T16:33:42.390

```
static void update_value(char op)
{
    if (op == '+')
        if (value == UINT_MAX)
            printf("Maximum value achieved.\n");
        else
            value ++;
    else
       if (value == 0)
           printf("Minimum value achieved.\n");
       else
           value --;
} 
```

`UINT_MAX`，对于这个常数，你必须包括`limits.h`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-30T14:12:57.110

您需要limits.h（INT_MIN和INT_MAX）：更多信息：[http ://www.cplusplus.com/reference/climits/](http://www.cplusplus.com/reference/climits/)

# matlab - Matlab将输出分成2个变量

> ID：13646836
> 
> 赞同：4
> 
> 时间：2012-11-30T14:08:27.720
> 
> 标签：matlab, output

我有两个浮点变量：

```
x = 0.5;
y = 1.5; 
```

我想把它们放在地板上：

```
x = floor(x);
y = floor(y); 
```

我可以在一个命令中完成吗？这会引发错误：

```
[x y] = floor([x y]); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-30T14:21:03.073

您可以为地板编写自己的包装器：

```
function varargout = myFloor(varargin)
for k = 1:nargin
    varargout{k} = floor(varargin{k});
end 
```

如果您提供 x 和 y 作为两个单独的参数，此函数将显示所需的行为

```
[a, b] = myFloor(x,y) 
```

这导致

```
a =

     0

b =

     1 
```

如果您想使用串联数组`[x y]`作为输入（如在您的示例中），您可以使用以下函数：

```
function varargout = myFloor(x)
for k = 1:numel(x)
    varargout{k} = floor(x(k));
end 
```

然后你会打电话

```
[a, b] = myFloor([x y]) 
```

这导致

```
a =

     0

b =

     1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T14:36:46.447

只是在这里添加一个随机的想法......

在 H.Muster 解决方案的基础上，您可能想要定义一个个性化的`deal`函数，这就像`deal`但也将一个函数应用于每个参数：

```
function varargout = myDeal(fun, varargin)
    if nargin == 2
        varargout(1:nargout) = {feval(fun, varargin{1})};
    elseif nargin-1 == nargout
        for k = 1:nargout
            varargout{k} = feval(fun, varargin{k}); end
    else
        error('Argument count mismatch.');
    end
end 
```

这样，您可以多重分配*任何*功能：

```
>> [x,y,z] = myDeal(@floor, 0.5, 0.6, 2.7)
x =
     0
y =
     0
z =
     2

>>  [x,y,z] = myDeal(@sin, pi/6)
x =
     4.999999999999999e-01
y =
     4.999999999999999e-01
z =
     4.999999999999999e-01

>> [a, b] = myDeal(@fix, 10*rand(2), 8*rand(5))         
a =
     7     2
     7     6
b =
     5     2     4     1     6
     1     4     5     1     1
     0     1     7     2     7
     3     6     7     6     2
     7     2     4     2     1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:13:53.607

不，这是不可能的。
Floor 只能接受一个参数，从语法中可以看出。您可以查看下面的参考来验证：

[http://www.mathworks.in/help/symbolic/mupad_ref/floor.html](http://www.mathworks.in/help/symbolic/mupad_ref/floor.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:14:44.997

如果

```
 A = [0.5 1.5] 
```

那么你可以做

```
 floor(A) 
```

这将导致

```
 ans = [0 1] 
```

这是一个例子： http: [//www.matlabtutorials.com/functions/floor.html](http://www.matlabtutorials.com/functions/floor.html)

# ruby - 使用 :sql 模式格式时如何使 rake db:migrate 生成 schema.rb

> ID：13646840
> 
> 赞同：10
> 
> 时间：2012-11-30T14:08:33.173
> 
> 标签：ruby, ruby-on-rails-3, rake, dbmigrate, schema.rb

如果在中使用此选项`config/application.rb`：

```
config.active_record.schema_format = :sql 
```

那么当你这样做时：

```
rake db:migrate 
```

它只会转储`db/structure.sql`. 我知道它没有使用，`db/schema.rb`因为它正在使用该`:sql`选项，但是你怎么能`rake db:migrate`生成生成`db/schema.rb`呢？

我们需要它，因为 RubyMine 4.5 和 IntelliJ IDea 11`db/schema.rb`用于自动完成列。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-30T14:08:33.173

`db/schema.rb`即使使用该选项也要生成/更新`:sql`，您可以将其放入您的`Rakefile`：

```
Rake::Task["db:migrate"].enhance do
  if ActiveRecord::Base.schema_format == :sql
    Rake::Task["db:schema:dump"].invoke
  end
end 
```

这对 IDea 和 RubyMine 来说应该没问题。

对于只希望文件作为参考的其他人，您可能希望将其重命名为其他类似的名称`db/schema.rb.backup`，以免造成混淆。要做到这一点：

```
Rake::Task["db:migrate"].enhance do
  if ActiveRecord::Base.schema_format == :sql
    Rake::Task["db:schema:dump"].invoke
    File.rename(File.expand_path('../db/schema.rb', __FILE__), File.expand_path('../db/schema.rb.backup', __FILE__))
  end
end 
```

（注意：`../`在路径中使用，`Rakefile`因为`__FILE__`计算结果为以 结尾的路径`/Rakefile`。）

# .net - 如何找到 .NET SQL Client Provider 的排序规则

> ID：13646853
> 
> 赞同：0
> 
> 时间：2012-11-30T14:09:29.357
> 
> 标签：.net

如何查找 .NET SqlClient Provider 使用的排序规则并更改 .NET SqlClient Provider 中的排序规则。

# c++ - OpenCV：findContours 函数错误

> ID：13646855
> 
> 赞同：5
> 
> 时间：2012-11-30T14:09:39.313
> 
> 标签：c++, image, image-processing, opencv, error-handling

我正在使用 2.4.3 版本的 opencv，并尝试在精明边缘检测后使用“findContours”功能，如下所示：

```
struct Component
{
    cv::Rect boundingBox;
    double area;
    double circularity;
}

cv::vector < Component > components;
cv::vector < cv::Vec4i > hierarchy;
cv::findContours ( cannyEdges, components, hierarchy, CV_RETR_CCOMP, CV_CHAIN_APPROX_NONE); 
```

然后它会为“cv::findContours”行抛出一个错误，如下所示：

```
OpenCV Error: Assertion failed (mtype == type0 || ( CV_MAT_CN(mtype) == CV_MAT_CN(type0) && ((1((type0) & fixedDepthMask) != 0 )) in unknown function, file ...\opencv\modeuls\core\src\matrix.cpp, line 1421 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-30T16:09:58.370

cv::findcontours 将每个轮廓作为点向量返回（参见[http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html#findcontours](http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html#findcontours)）。

您必须自己将这些向量转换为您的数据结构（组件），就像我创建的这个最小示例一样：

```
#include <opencv2/opencv.hpp>
#include <iostream>
struct Component
{
    cv::Rect boundingBox;
    double area;
    double circularity;
};
int main()
{
    // Create a small image with a circle in it.
    cv::Mat image(256, 256, CV_8UC3, cv::Scalar(0, 0, 0));
    cv::circle(image, cv::Point(80, 110), 42, cv::Scalar(255,127, 63), -1);

    // Find canny edges.
    cv::Mat cannyEdges;
    cv::Canny(image, cannyEdges, 80, 60);

    // Show the images.
    cv::imshow("img", image);
    cv::imshow("cannyEdges", cannyEdges);

    // Find the contours in the canny image.
    cv::vector<cv::Vec4i> hierarchy;

    // "Each contour is stored as a vector of points."
    // http://docs.opencv.org/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html#findcontours
    typedef cv::vector<cv::vector<cv::Point> > TContours;
    TContours contours;
    cv::findContours(cannyEdges, contours, hierarchy, CV_RETR_CCOMP, CV_CHAIN_APPROX_NONE);
    // cannyEdges is destroyed after calling cv::findContours

    // Print number of found contours.
    std::cout << "Found " << contours.size() << " contours." << std::endl;

    // Convert contours to Components.
    typedef cv::vector<Component> TComponents;
    TComponents components;
    for (TContours::const_iterator it( contours.begin() ); it != contours.end(); ++it)
    {
        Component c;
        c.area = cv::contourArea(*it);
        c.boundingBox = cv::boundingRect(*it);
        c.circularity = 0.0; // Insert whatever you mean by circularity;
        components.push_back(c);
    }

    for (TComponents::const_iterator it( components.begin() ); it != components.end(); ++it)
        std::cout << it->area << std::endl; // and whatever you want.

    // Wait for user input.
    cv::waitKey();
} 
```

# .net - 从进程标准输出异步读取到内存流

> ID：13646858
> 
> 赞同：1
> 
> 时间：2012-11-30T14:09:47.153
> 
> 标签：.net, asynchronous, process, stdout, memorystream

**更新：**关键部分是我们使用的流对于 copyto\copytoasync 使用的缓冲区来说太大了，所以我们需要异步处理部分流，而不是异步运行整个任务，就像下面链接的问题

请原谅这里的 VB.net 代码。我也会说 C#，所以可以随意用任何一种语言来回答。

我一直在关注这个例子，[ProcessStartInfo 挂在“WaitForExit”上？为什么？](https://stackoverflow.com/questions/139593/processstartinfo-hanging-on-waitforexit-why)为了尝试解决我们遇到的缓冲区空间不足的问题

以前我们尝试过这段代码：

```
 Dim buffer As Byte() = New Byte(32767) {}
        Dim file As Byte()
        Using ms = New MemoryStream()
            While True
                Dim read As Integer = Process.StandardOutput.BaseStream.Read(buffer, 0, buffer.Length)

                If read <= 0 Then
                    Exit While
                End If
                ms.Write(buffer, 0, read)
            End While
            file = ms.ToArray()
        End Using

        If Not Process.WaitForExit(timeOut) Then
            Throw New Exception("Html to PDF conversion timed out.")
        End If 
```

现在我已经开始将其转换为链接问题中的 aynch 方法，但是在写入内存流而不是 stringbuilder 时遇到了麻烦。这是我到目前为止所得到的：

```
Dim output = new MemoryStream()
Dim errorOutput = new StringBuilder()

Using process = New Process()

    Using outputWaitHandle As New AutoResetEvent(False)
        Using errorWaitHandle As New AutoResetEvent(False)

            process.OutputDataReceived = Function(sender, e)
                If e.Data Is Nothing Then
                    outputWaitHandle.Set()
                Else
                    output.Write(e.Data); //compile error here
                End If

            End Function

        End Using
    End Using

End Using 
```

当然 e.Data 是一个字符串，但不仅我还需要一个缓冲区和一个偏移量......而且不知道在这里提供什么。

欢迎任何建议，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:09:28.543

您可以直接使用流，而不是 using `OutputDataReceived`：

```
static async Task<MemoryStream> ReadProcessOutput(ProcessStartInfo psi)
{
    MemoryStream ms = new MemoryStream();

    using (Process p = new Process())
    {
        p.StartInfo = psi;

        TaskCompletionSource<int> tcs = new TaskCompletionSource<int>();
        EventHandler eh = (s, e) => tcs.TrySetResult(0);

        p.Exited += eh;

        try
        {
            p.EnableRaisingEvents = true;
            p.Start();

            await p.StandardError.BaseStream.CopyToAsync(ms);
            await tcs.Task;
        }
        finally
        {
            p.Exited -= eh;
        }
    }

    return ms;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:11:11.993

您可能想研究使用[StreamWriter](http://msdn.microsoft.com/en-us/library/ce2kyyb4.aspx)类，而不仅仅是 MemoryStream。这将允许您执行以下操作：

```
MemoryStream output = new MemoryStream();
StreamWriter outputWriter = new StreamWriter(output);

...[snip]...

outputWriter.Write(e.Data); 
```

# crystal-reports - 水晶报告：将分隔字段拆分为列

> ID：13646859
> 
> 赞同：0
> 
> 时间：2012-11-30T14:09:49.080
> 
> 标签：crystal-reports

如何在 Crystal Reports XI 中将分隔字段拆分为列？

字段中的数据如下所示：

> 值1 \t 值2 \t 值3 \r\n
> 
> 值1 \t 值2 \t 值3 \r\n

我想将其格式化为

> 价值 1 价值 2 价值 3

我尝试将字段放入 Crystal 但制表符分隔符格式不正确。

它显示为：

> 值 1 值 2 值 3

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:45:50.917

您将需要三个公式：

```
//{@one}
Split({table.field}, " \t")[1];

//{@two}
Split({table.field}, " \t")[2];

//{@three}
Split(Split({table.field}, " \t")[3], " ")[1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-31T15:48:02.937

这也适用于 Cyrstal Reports 2013 版。我有一列由“，”分隔，并且创建了多个公式。谢谢@craig :)

```
Split({table.field}, ",")[1]; 
```

# c# - 检查 Crystal Reports 参数是否来自子报表

> ID：13646860
> 
> 赞同：3
> 
> 时间：2012-11-30T14:09:49.447
> 
> 标签：c#, .net, crystal-reports

如果它们在代码中设置并显示带有剩余未填充参数的参数表单，我正在循环通过 Crystal Reports 参数集合并为它们分配值。

此代码工作正常，但是当添加使用链接参数的子报表时，它们也会显示出来。这是因为子报表参数包含在主报表参数集合中。

是否有*子报告参数*类型可以将它们过滤掉？

# android - 如何使用他们的 Facebook id 在多个朋友墙上发帖

> ID：13646861
> 
> 赞同：0
> 
> 时间：2012-11-30T14:10:00.897
> 
> 标签：android, facebook

在我的应用程序中，我需要将图像和消息发布到多个朋友的墙上。

我已经看到有关此问题的 stackoverflow 帖子。我发现需要批处理请求概念来执行此操作。

我不明白，我怎样才能创建 jsonobjects。

我在一些帖子中看到，我们一次不能发布超过 10 个帖子。我对这个 Batch Request 概念没有太多想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:22:49.593

您可以使用以下代码在连续请求之间创建延迟。

```
 int count = 10;
    new Timer().schedule(new TimerTask() {

        @Override
        public void run() {
            if (count>=10) {
                this.cancel();
            }

        MainActivity.this.runOnUiThread(new Runnable() {

            public void run() {
                //Do the facebook request.

            }
        });

        }
    }, 1000 , 1000); 
```

# python - 向敌人的精灵添加碰撞检测？

> ID：13646865
> 
> 赞同：0
> 
> 时间：2012-11-30T14:10:10.010
> 
> 标签：python, pygame

我想将玩家精灵使用的相同碰撞检测添加到敌人精灵或“蠕动”我添加了我可以看到的所有相关代码但碰撞仍然没有被检测和处理，请在类下面找到，我有不知道目前出了什么问题，要碰撞的墙壁列表是“wall_list”

```
import pygame
import pauseScreen as dm
import re
from pygame.sprite import Sprite
from pygame import Rect, Color
from random import randint, choice
from vec2d import vec2d
from simpleanimation import SimpleAnimation
import displattxt
black = (0,0,0)
white = (255,255,255)
blue = (0,0,255)
green = (101,194,151)
global currentEditTool
currentEditTool = "Tree"
global editMap

editMap = False
open('MapMaker.txt', 'w').close()
def draw_background(screen, tile_img):
        screen.fill(black)
        img_rect = tile_img.get_rect()
        global rect
        rect = img_rect

        nrows = int(screen.get_height() / img_rect.height) + 1
        ncols = int(screen.get_width() / img_rect.width) + 1

        for y in range(nrows):
            for x in range(ncols):
                img_rect.topleft = (x * img_rect.width,
                                    y * img_rect.height)
                screen.blit(tile_img, img_rect)

def changeTool():
        if currentEditTool == "Tree":
                None
        elif currentEditTool == "Rock":
                None

def pauseGame():
        red   = 255,  0,  0
        green =   0,255,  0
        blue  =   0,  0,255  
        screen.fill(black)
        pygame.display.update()
        if editMap == False:
                choose = dm.dumbmenu(screen, [
                                'Resume',
                                'Enable Map Editor',
                                'Quit Game'], 64,64,None,32,1.4,green,red)

                if choose == 0:
                        print("hi")
                elif choose ==1:
                        global editMap
                        editMap = True
                elif choose ==2:
                        print("bob")
                elif choose ==3:
                        print("bob")
                elif choose ==4:
                        print("bob")
                else:
                        None      
        else:
                choose = dm.dumbmenu(screen, [
                                'Resume',
                                'Disable Map Editor',
                                'Quit Game'], 64,64,None,32,1.4,green,red)

                if choose == 0:
                        print("Resume")
                elif choose ==1:
                        print("Dis ME")
                        global editMap
                        editMap = False
                elif choose ==2:
                        print("bob")
                elif choose ==3:
                        print("bob")
                elif choose ==4:
                        print("bob")
                else:
                        None                   

class Wall(pygame.sprite.Sprite):
    # Constructor function
    def __init__(self,x,y,width,height):
        pygame.sprite.Sprite.__init__(self)   
        self.image = pygame.Surface([width, height])
        self.image.fill(green)
        self.rect = self.image.get_rect()
        self.rect.y = y
        self.rect.x = x

class insertTree(pygame.sprite.Sprite):

    def __init__(self,x,y,width,height, typ):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.image.load("images/map/tree.png").convert()
        self.image.set_colorkey(white)
        self.rect = self.image.get_rect()
        self.rect.y = y
        self.rect.x = x

class insertRock(pygame.sprite.Sprite):

    def __init__(self,x,y,width,height, typ):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.image.load("images/map/rock.png").convert()
        self.image.set_colorkey(white)
        self.rect = self.image.get_rect()
        self.rect.y = y
        self.rect.x = x

class Creep(pygame.sprite.Sprite):
    """ A creep sprite that bounces off walls and changes its
        direction from time to time.
    """
    change_x=0
    change_y=0
    def __init__(   
            self, screen, creep_image, explosion_images, 
            field, init_position, init_direction, speed):
        """ Create a new Creep.

            screen: 
                The screen on which the creep lives (must be a 
                pygame Surface object, such as pygame.display)

            creep_image: 
                Image (surface) object for the creep

            explosion_images:
                A list of image objects for the explosion 
                animation.

            field:
                A Rect specifying the 'playing field' boundaries.
                The Creep will bounce off the 'walls' of this 
                field.

            init_position:
                A vec2d or a pair specifying the initial position
                of the creep on the screen.

            init_direction:
                A vec2d or a pair specifying the initial direction
                of the creep. Must have an angle that is a 
                multiple of 45 degres.

            speed: 
                Creep speed, in pixels/millisecond (px/ms)
        """
        Sprite.__init__(self)

        self.screen = screen
        self.speed = speed
        self.field = field
        self.rect = creep_image.get_rect()

        # base_image holds the original image, positioned to
        # angle 0.
        # image will be rotated.
        #
        self.base_image = creep_image
        self.image = self.base_image
        self.explosion_images = explosion_images

        # A vector specifying the creep's position on the screen
        #
        self.pos = vec2d(init_position)

        # The direction is a normalized vector
        #
        self.direction = vec2d(init_direction).normalized()

        self.state = Creep.ALIVE
        self.health = 15

    def is_alive(self):
        return self.state in (Creep.ALIVE, Creep.EXPLODING)

    def changespeed(self,x,y):
        self.change_x+=x
        self.change_y+=y

    def update(self, time_passed, walls):
        """ Update the creep.

            time_passed:
                The time passed (in ms) since the previous update.
        """
        if self.state == Creep.ALIVE:
            # Maybe it's time to change the direction ?
            #
            self._change_direction(time_passed)

            # Make the creep point in the correct direction.
            # Since our direction vector is in screen coordinates 
            # (i.e. right bottom is 1, 1), and rotate() rotates 
            # counter-clockwise, the angle must be inverted to 
            # work correctly.
            #
            self.image = pygame.transform.rotate(
                self.base_image, -self.direction.angle)

            # Compute and apply the displacement to the position 
            # vector. The displacement is a vector, having the angle
            # of self.direction (which is normalized to not affect
            # the magnitude of the displacement)
            #
            displacement = vec2d(    
                self.direction.x * self.speed * time_passed,
                self.direction.y * self.speed * time_passed)

            self.pos += displacement

            # When the image is rotated, its size is changed.
            # We must take the size into account for detecting 
            # collisions with the walls.
            #
            self.image_w, self.image_h = self.image.get_size()
            bounds_rect = self.field.inflate(
                            -self.image_w, -self.image_h)

            if self.pos.x < bounds_rect.left:
                self.pos.x = bounds_rect.left
                self.direction.x *= -1
            elif self.pos.x > bounds_rect.right:
                self.pos.x = bounds_rect.right
                self.direction.x *= -1
            elif self.pos.y < bounds_rect.top:
                self.pos.y = bounds_rect.top
                self.direction.y *= -1
            elif self.pos.y > bounds_rect.bottom:
                self.pos.y = bounds_rect.bottom
                self.direction.y *= -1

        # collision detection
        old_x=bounds_rect.left
        new_x=old_x+self.direction.x
        bounds_rect.left = new_x

        # hit a wall?
        collide = pygame.sprite.spritecollide(self, walls, False)
        if collide:
            # yes
            bounds_rect.left=old_x

        old_y=self.pos.y
        new_y=old_y+self.direction.y
        self.pos.y = new_y

        collide = pygame.sprite.spritecollide(self, walls, False)
        if collide:
            # yes
            self.pos.y=old_y

        elif self.state == Creep.EXPLODING:
            if self.explode_animation.active:
                self.explode_animation.update(time_passed)
            else:
                self.state = Creep.DEAD
                self.kill()

        elif self.state == Creep.DEAD:
            pass

        #------------------ PRIVATE PARTS ------------------#

    # States the creep can be in.
    #
    # ALIVE: The creep is roaming around the screen
    # EXPLODING: 
    #   The creep is now exploding, just a moment before dying.
    # DEAD: The creep is dead and inactive
    #
    (ALIVE, EXPLODING, DEAD) = range(3)

    _counter = 0

    def _change_direction(self, time_passed):
        """ Turn by 45 degrees in a random direction once per
            0.4 to 0.5 seconds.
        """
        self._counter += time_passed
        if self._counter > randint(400, 500):
            self.direction.rotate(45 * randint(-1, 1))
            self._counter = 0

    def _point_is_inside(self, point):
        """ Is the point (given as a vec2d) inside our creep's
            body?
        """
        img_point = point - vec2d(  
            int(self.pos.x - self.image_w / 2),
            int(self.pos.y - self.image_h / 2))

        try:
            pix = self.image.get_at(img_point)
            return pix[3] > 0
        except IndexError:
            return False

    def _decrease_health(self, n):
        """ Decrease my health by n (or to 0, if it's currently
            less than n)
        """
        self.health = max(0, self.health - n)
        if self.health == 0:
            self._explode()

    def _explode(self):
        """ Starts the explosion animation that ends the Creep's
            life.
        """
        self.state = Creep.EXPLODING
        pos = ( self.pos.x - self.explosion_images[0].get_width() / 2,
                self.pos.y - self.explosion_images[0].get_height() / 2)
        self.explode_animation = SimpleAnimation(
            self.screen, pos, self.explosion_images,
            100, 300)
        global remainingCreeps

        remainingCreeps-=1

        if remainingCreeps == 0:
                print("all dead")

    def draw(self):
        """ Blit the creep onto the screen that was provided in
            the constructor.
        """
        if self.state == Creep.ALIVE:
            # The creep image is placed at self.pos. To allow for 
            # smooth movement even when the creep rotates and the 
            # image size changes, its placement is always 
            # centered.
            #
            self.draw_rect = self.image.get_rect().move(
                self.pos.x - self.image_w / 2, 
                self.pos.y - self.image_h / 2)
            self.screen.blit(self.image, self.draw_rect)

            # The health bar is 15x4 px.
            #
            health_bar_x = self.pos.x - 7
            health_bar_y = self.pos.y - self.image_h / 2 - 6
            self.screen.fill(   Color('red'), 
                                (health_bar_x, health_bar_y, 15, 4))
            self.screen.fill(   Color('green'), 
                                (   health_bar_x, health_bar_y, 
                                    self.health, 4))

        elif self.state == Creep.EXPLODING:
            self.explode_animation.draw()

        elif self.state == Creep.DEAD:
            pass

    def mouse_click_event(self, pos):
        """ The mouse was clicked in pos.
        """
        if self._point_is_inside(vec2d(pos)):
            self._decrease_health(3)
#begin new player

class Player(pygame.sprite.Sprite):

    change_x=0
    change_y=0
    frame = 0

    def __init__(self,x,y):

        pygame.sprite.Sprite.__init__(self)
        # LOAD PLATER IMAGES
        # Set height, width
        self.images = []
        for i in range(1,17):
            img = pygame.image.load("images/player/" + str(i)+".png").convert() #player images
            img.set_colorkey(white)
            self.images.append(img)
        self.image = self.images[0]
        self.rect = self.image.get_rect()
        self.rect.y = y
        self.rect.x = x
        self.health = 15
        self.image_w, self.image_h = self.image.get_size()
        health_bar_x = self.rect.x - 7
        health_bar_y = self.rect.y - self.image_h / 2 - 6
        screen.fill(   Color('red'), 
                                (health_bar_x, health_bar_y, 15, 4))
        screen.fill(   Color('green'), 
                                (   health_bar_x, health_bar_y, 
                                    self.health, 4))

    def changespeed(self,x,y):
        self.change_x+=x
        self.change_y+=y

    def _decrease_health(self, n):
        """ Decrease my health by n (or to 0, if it's currently
            less than n)
        """
        self.health = max(0, self.health - n)
        if self.health == 0:
            self._explode()

    def update(self,walls):
        # collision detection
        old_x=self.rect.x
        new_x=old_x+self.change_x
        self.rect.x = new_x

        # hit a wall?
        collide = pygame.sprite.spritecollide(self, walls, False)
        if collide:
            # yes
            self.rect.x=old_x

        old_y=self.rect.y
        new_y=old_y+self.change_y
        self.rect.y = new_y

        collide = pygame.sprite.spritecollide(self, walls, False)
        if collide:
            # yes
            self.rect.y=old_y

        # right to left
        if self.change_x < 0:
            self.frame += 1
            if self.frame > 3*4:
                self.frame = 0                 
            # Grab the image, divide by 4
            # every 4 frames. 
            self.image = self.images[self.frame//4]

        # Move left to right.
        # images 4...7 instead of 0...3.
        if self.change_x > 0:
            self.frame += 1
            if self.frame > 3*4:
                self.frame = 0
            self.image = self.images[self.frame//4+4]

        if self.change_y > 0:
            self.frame += 1
            if self.frame > 3*4:
                self.frame = 0
            self.image = self.images[self.frame//4+4+4]

        if self.change_y < 0:
            self.frame += 1
            if self.frame > 3*4:
                self.frame = 0
            self.image = self.images[self.frame//4+4+4+4]

score = 0
# initialize pyGame
pygame.init()

# 800x600 sized screen
global screen
screen = pygame.display.set_mode([800, 600])
screen.fill(black)
#bg_tile_img = pygame.image.load('images/map/grass.png').convert_alpha()
#draw_background(screen, bg_tile_img)
#pygame.display.flip()
# Set title
pygame.display.set_caption('Test')

#background = pygame.Surface(screen.get_size())
#background = background.convert()
#background.fill(black)

# Create the player
player = Player( 50,50 )
player.rect.x=50
player.rect.y=50
movingsprites = pygame.sprite.RenderPlain()
movingsprites.add(player)

# Make the walls. (x_pos, y_pos, width, height)
global wall_list
wall_list=pygame.sprite.RenderPlain()
wall=Wall(0,0,10,600) # left wall
wall_list.add(wall)
wall=Wall(10,0,790,10) # top wall
wall_list.add(wall)
#wall=Wall(10,200,100,10) # poke wall 
wall_list.add(wall)
wall=Wall(790,0,10,600) #(x,y,thickness, height)
wall_list.add(wall)
wall=Wall(10,590,790,10)  #(x,y,thickness, height)
wall_list.add(wall)

f = open('MapMaker.txt')
num_lines = sum(1 for line in f)
print(num_lines)
lineCount = 0
with open("MapMaker.txt") as infile:
    for line in infile:
       f = open('MapMaker.txt')
       print(line)

       coords = line.split(',')
       #print(coords[0])
       #print(coords[1])
       #print(coords[2])
       #print(coords[3])
       #print(coords[4])
       if "tree" in line:
          print("tree in")
          wall=insertTree(int(coords[0]),int(coords[1]), int(coords[2]),int(coords[3]),coords[4])
          wall_list.add(wall)
       elif "rock" in line:
          print("rock in")
          wall=insertRock(int(coords[0]),int(coords[1]), int(coords[2]),int(coords[3]),coords[4] )
          wall_list.add(wall)

width = 20
height = 540
height = height - 48
for i in range(0,23):
    width = width + 32
    name = insertTree(width,540,790,10,"tree")
    #wall_list.add(name)
    name = insertTree(width,height,690,10,"tree")
    #wall_list.add(name)

CREEP_SPAWN_TIME = 200 # frames

creep_spawn = CREEP_SPAWN_TIME

clock = pygame.time.Clock()
bg_tile_img = pygame.image.load('images/map/grass.png').convert()
img_rect = bg_tile_img
FIELD_RECT = Rect(50, 50, 700, 500)
CREEP_FILENAMES = [
     'images/player/1.png', 
    'images/player/1.png', 
    'images/player/1.png']
N_CREEPS = 3

creep_images = [
    pygame.image.load(filename).convert_alpha() 
    for filename in CREEP_FILENAMES]
explosion_img = pygame.image.load('images/map/tree.png').convert_alpha()
explosion_images = [
    explosion_img, pygame.transform.rotate(explosion_img, 90)]

creeps = pygame.sprite.RenderPlain()

done = False
#bg_tile_img = pygame.image.load('images/map/grass.png').convert()
#draw_background(screen, bg_tile_img)

totalCreeps = 0
remainingCreeps = 3
while done == False:

    creep_images = pygame.image.load("images/player/1.png").convert()
    creep_images.set_colorkey(white)
    draw_background(screen, bg_tile_img)

    if len(creeps) != N_CREEPS:

        if totalCreeps < N_CREEPS:
                        totalCreeps = totalCreeps + 1
                        print(totalCreeps)
                        creeps.add(
                        Creep(  screen=screen,
                        creep_image=creep_images, 
                        explosion_images=explosion_images,
                        field=FIELD_RECT,
                        init_position=( randint(FIELD_RECT.left, 
                                                FIELD_RECT.right), 
                                        randint(FIELD_RECT.top, 
                                                FIELD_RECT.bottom)), 
                        init_direction=(choice([-1, 1]), 
                                        choice([-1, 1])),
                        speed=0.01))

    for creep in creeps:

                    creep.update(60,wall_list)
                    creep.draw()

    for event in pygame.event.get():

        if event.type == pygame.QUIT:
            done=True

        if event.type == pygame.KEYDOWN:
            if event.key == pygame.K_LEFT:
                player.changespeed(-2,0)
                creep.changespeed(-2,0)
            if event.key == pygame.K_RIGHT:
                player.changespeed(2,0)
                creep.changespeed(2,0)
            if event.key == pygame.K_UP:
                player.changespeed(0,-2)
                creep.changespeed(0,-2)
            if event.key == pygame.K_DOWN:
                player.changespeed(0,2)
                creep.changespeed(0,2)
            if event.key == pygame.K_ESCAPE:
                pauseGame()
            if event.key == pygame.K_1:
                global currentEditTool
                currentEditTool = "Tree"
                changeTool()
            if event.key == pygame.K_2:
                global currentEditTool
                currentEditTool = "Rock"
                changeTool()

        if event.type == pygame.KEYUP:
            if event.key == pygame.K_LEFT:
                player.changespeed(2,0)
                creep.changespeed(2,0)
            if event.key == pygame.K_RIGHT:
                player.changespeed(-2,0)
                creep.changespeed(-2,0)
            if event.key == pygame.K_UP:
                player.changespeed(0,2)
                creep.changespeed(0,2)
            if event.key == pygame.K_DOWN:
                player.changespeed(0,-2)
                creep.changespeed(0,-2)

        if event.type == pygame.MOUSEBUTTONDOWN and pygame.mouse.get_pressed()[0]:
                for creep in creeps:
                        creep.mouse_click_event(pygame.mouse.get_pos())

                if editMap == True:
                    x,y = pygame.mouse.get_pos()
                    if currentEditTool == "Tree":

                        name = insertTree(x-10,y-25, 10 , 10, "tree")
                        wall_list.add(name)
                        wall_list.draw(screen)          
                        f = open('MapMaker.txt', "a+")
                        image = pygame.image.load("images/map/tree.png").convert()
                        screen.blit(image, (30,10))
                        pygame.display.flip()
                        f.write(str(x) + "," + str(y) + ",790,10, tree\n")
                        #f.write("wall=insertTree(" + str(x) + "," + str(y) + ",790,10)\nwall_list.add(wall)\n")

                    elif currentEditTool == "Rock":

                        name = insertRock(x-10,y-25, 10 , 10,"rock")
                        wall_list.add(name)
                        wall_list.draw(screen)
                        f = open('MapMaker.txt', "a+")
                        f.write(str(x) + "," + str(y) + ",790,10,rock\n")
                        #f.write("wall=insertRock(" + str(x) + "," + str(y) + ",790,10)\nwall_list.add(wall)\n")

                else:
                    None

    #pygame.display.flip()  
    player.update(wall_list)

    movingsprites.draw(screen)
    wall_list.draw(screen)
    pygame.display.flip()

    clock.tick(60)

pygame.quit() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-24T03:17:02.907

Sprite collide 是正确的方法，您只是错误地处理了返回数据。基本上，sprite collide 不会返回一个布尔值，表明你是否与组的成员发生碰撞。它返回一个精灵列表。基本上，它会给你一个在该组中与你发生碰撞的精灵列表。需要注意的另一件事是该列表也将始终包含精灵本身。毕竟，它是在与自己相撞。这是一种测试您是否与墙壁碰撞的有效方法。

```
def is_colliding_with_wall():                                    #this is a function that will determine if you are touching a wall. You have repeated code to test collisions with walls multiple times, so it is best just to have a function
    collide = pygame.sprite.spritecollide(self, walls, False)    #this gets the list, it is the exact same code as in yours
    for collision in collide:                                    #goes through the list, checking each collision
        if collision != self:                                    #filters out self collision
            return True                                          #if there is a collision that is not self, returns True, that there is a collision with a wall
    return False                                                 #if it has checked all the collisions and there is only a self collision, then it is not colliding with a wall, so it returns False 
```

# java - java.awt.dialog 是如何实现模态的？

> ID：13646867
> 
> 赞同：13
> 
> 时间：2012-11-30T14:10:24.560
> 
> 标签：java, user-interface, awt, modal-dialog

我想了解如何`java.awt.Dialog`实现模态（阻止其他窗口）？

是的，我尝试阅读 的代码`java.awt.Dialog`，但我有点迷失在其中。所以我想简要了解他们的工作。他们是否禁用所有其他窗口的所有事件？

谢谢普雷姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T19:41:33.557

它的系统依赖。在 Windows 上，主事件循环被修改。大多数情况下，您最好打开非模态对话框并手动锁定底层窗口（例如，将玻璃窗格设置为根窗格并禁用它，或阻止所有事件设置自定义焦点管理器）。

# c++ - 从静态函数调用非静态类函数

> ID：13646868
> 
> 赞同：0
> 
> 时间：2012-11-30T14:10:31.293
> 
> 标签：c++

我们的代码中有一个静态类函数，其中包含大量代码。在最初使用并且仍然使用此代码的地方，无法创建该类的实例，因此它是静态的。这个函数的功能现在在我们的代码库的其他地方需要，其中已经创建了类的实例。

无论如何，如果不制作同一函数的非静态和静态版本，我们就可以创建一个非静态函数，该函数包含所有可以在无法初始化类实例的地方使用静态函数轮询的代码，同时允许它使用其他地方的实际实例来调用。

例如

```
#include <iostream>

class Test
{
public:
    Test(){};
    ~Test(){};
    void nonStaticFunc(bool calledFromStatic);
    static void staticFuncCallingNonStaticFunc();
};

void Test::nonStaticFunc(bool calledFromStatic)
{
    std::cout << "Im a non-static func that will house all the code" << std::endl;
    if(calledFromStatic)
    // do blah
    else
    // do blah
}

void Test::staticFuncCallingNonStaticFunc()
{
    std::cout << "Im a static func that calls the non static func that will house all `the code" << std::endl;
    nonStaticFunc(true);
}

int main(int argc, char* argv[])
{
   // In some case this could be called as this     
   Test::staticFuncCallingNonStaticFunc();

   // in others it could be called as 
   Test test;
   test.nonStaticFunc(false);
} 
```

取决于它是否静态调用，代码可能会在非静态函数中略有改变，所以我们不能一直简单地使用静态函数，因为有时我们需要访问代码中其他地方使用的非静态成员。但是，大部分代码将保持不变。干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T14:20:22.870

将公共部分重构为一个类方法并从两个方法中调用它。当然，您不能在公共部分方法中访问非静态成员。

```
class Test
{
public:
    Test(){};
    ~Test(){};
    void nonStaticFunc();
    static void staticFunc();
private:
    static void commonParts();
};

void Test::commonParts()
{
    std::cout << "Im a static func that will house all common parts" << std::endl;
    // do common stuff
}

void Test::nonStaticFunc()
{
    std::cout << "Im a non-static func that will call the common parts and do other things then" << std::endl;
    commonParts();
    // do non-static stuff
}

void Test::staticFunc()
{
    std::cout << "Im a static func that will call the common parts and then do other things" << std::endl;
    commonParts();
    // do static stuff
}

int main(int argc, char* argv[])
{
   // In some case this could be called as this     
   Test::staticFunc();

   // in others it could be called as 
   Test test;
   test.nonStaticFunc();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T15:17:55.563

我倾向于不提供解决方法，因为我认为这是一个应该解决的设计问题，而不是被破解才能工作。

无论如何，您可以将通用代码分解为一个静态函数，该函数接受一个指向对象的指针。从传递的非静态成员调用它`this`时，从静态函数调用时不传递对象：

```
class test {
   void impl( test* p ) {
       // ...
       if (p) {           // we have an object: use it
          p->dosomething();
       }
   }
public:
   void nonStaticVersion() {
      impl(this);
   }
   static void staticVersion() {
      impl(0);
   }
}; 
```

但是你应该重新考虑你是否真的想要这样做。想想做什么`impl`，给它一个名字。如果您找不到简单的名称和简短的解释，请重构，直到您拥有执行易于描述的简单任务的函数。请注意，如果函数的描述开始有条件，那就是代码异味（即*根据 Z 执行 X 或 Y，并且 if...*暗示该函数没有明确的责任。

# php - android webview 可以看到我的受保护页面

> ID：13646886
> 
> 赞同：0
> 
> 时间：2012-11-30T14:12:07.563
> 
> 标签：php, android, session, webview

我有一个受保护的页面及其代码，例如；

```
<?php
if (session_id() == "")
 {
 session_start();
 }
if (!isset($_SESSION['username']))
 {
 header('Location: ./index.php');
  exit;
 }
else
 {
    //something after user entered
 }
?> 
```

在用户进入系统之前，我的 android webview 可以看到这个页面。为什么会这样？我该如何解决？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:18:48.840

您可能应该使用

```
webView.clearCache(true); 
```

清除缓存。还有其他有用的东西，比如 clearHistory(); clearFormData(); 等等

像这样的事情：

```
WebSettings webSettings = webView.getSettings();
webSettings.setCacheMode(WebSettings.LOAD_NO_CACHE); 
```

更多信息：http: [//developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

哦，正如其他人提到的，PHP 是服务器端的，所以如果你试图从应用程序本地使用它们，它不会顺利。

# c++ - iostream 限制要读取的最大字符数

> ID：13646887
> 
> 赞同：0
> 
> 时间：2012-11-30T14:12:19.220
> 
> 标签：c++, iostream, manipulators

在 Bruce Eckel “Thinking in C++”的帮助下学习 C++。陷入“Iostreams”一章的练习 05：

## 练习文本

> 我们知道 setw( ) 允许读取最少的字符，但是如果您想读取最多的字符怎么办？编写一个效应器，允许用户指定要提取的最大字符数。让您的效应器也用于输出，如果需要，输出字段会被截断，以保持在宽度限制内。

我了解如何创建不带参数和带参数的操纵器（在本书术语中称为效应器）。但是不明白如何限制要提取的最大字符数。`std::ios_base::width`指定最小字符数。

我应该对底层`streambuf`对象做一些技巧吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T08:13:21.980

```
#include <iostream>
#include <iomanip>
#include <string>
#include <cstring>
using namespace std;    
class fixW{
    char* chrP;
    char str[1024];
    size_t Max;
    public:
    fixW(char* p,size_t m=25):chrP(p),Max(m){}

    friend istream& operator >>(istream& is,fixW fw){
        is >>fw.str;
        size_t n=strlen(fw.str);
        cout <<" n= "<<n << endl;
        if(n>=25){
            fw.str[fw.Max]='\0';
        }

        strcpy(fw.chrP,fw.str);
        return is;
    }

    friend ostream& operator<<(ostream& os, fixW fw){
        for(size_t i= 0; i<fw.Max; ++i){
            fw.str[i] = fw.chrP[i];
        }

        fw.str[fw.Max]='\0';
        return os <<fw.str;
    }
};
int main(){
    char s[80];
    cin >> fixW(s,25);
    cout << s << endl;
    cout << fixW(s,10)<<endl;
    cout << s <<endl;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:58:50.003

它不是一个完美的解决方案（但如果不阅读 iostream 库，我现在想不出另一种方法）。

假设你的机械手是：

```
class MaxFieldSize {/*STUFF*/}; 
```

当您编写流操作符时，您会编写一个稍微时髦的操作符，它不会返回实际的流（而是返回一个带有包装器的流）。

```
MaxFieldWdithStream operator<<(std::ostream&, MaxFieldSize const& manip); 
```

现在，您重载此类的所有流运算符以在返回普通流对象之前截断它们的输入。

```
class MaxFieldWithStream { std::ostream& printTruncatedData(std::string& value);}; 
```

那么你所需要的只是泛型重载：

```
template<typename T>
std::ostream& operator<<(MaxFieldWithStream& mfwstream, T const& value)
{
    std::stringstream  trunStream;
    trunStream << value;

    return mfwstream.printTruncatedData(trunStream.substr(0, mfwstream.widthNeeded));
}
// You will probably need another overload for io-manipulators. 
```

我还将添加一个转换运算符，自动将 MaxFieldWithStream 转换为 std::iostream ，这样如果将其传递给函数，它的行为仍然像流一样（尽管它会失去其最大宽度属性）。

```
class MaxFieldWithStream
{
    std::ostream& printTruncatedData(std::string& value);};
    operator st::ostream&() const { return BLABLAVLA;}
}; 
```

# javascript - 使用选择选项的值作为 Javascript 中变量的名称

> ID：13646888
> 
> 赞同：0
> 
> 时间：2012-11-30T14:12:20.963
> 
> 标签：javascript, variables, select, d3.js, option

我有一个带有不同选项的选择表单。我想获取更改时选择的选项的值。该值与放入函数的变量具有相同的名称。

所以我想将所选选项的值作为变量放入我的函数中。我该怎么做？

这是我的选择表格

```
<select class="select">
      <option  value="value1" >option 1</option>
      <option  value="value2" >option 2</option>
      <option  value="value3" >option 3</option>
</select> 
```

这是我的 javascript

```
var value1 = ['item1', 'item2', "item3", ...]

$(".select").change(function (){
    $(".select option:selected").each(function(){

          var dataset = $(this).val();          

              d3.select(".chart")
               .selectAll("div")
               .data(dataset)
               .enter();
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:16:29.887

不要泛滥你的全局范围，而是使用一个对象来保存可能的组合。用值引用对象。

```
var dataPoints = {
    value1 : ['item1', 'item2', "item3", ...],
    value2 : ['item1', 'item2', "item3", ...]
};

$(".select").change(function (){
    $(".select option:selected").each(function(){

          var dataset = $(this).val();          

              d3.select(".chart")
               .selectAll("div")
               .data(dataPoints[dataset])
               .enter();
    });
}); 
```

# android - 增强现实方向

> ID：13646889
> 
> 赞同：0
> 
> 时间：2012-11-30T14:12:29.403
> 
> 标签：加速度计, 磁强, 方向, android, augmented-reality

你好，我想问一下哪个传感器最能找到你当前的方向？方向传感器或[加速度计](/questions/tagged/accelerometer "显示标记为“加速度计”的问题")和[磁强](/questions/tagged/magnometer "显示标记为“万能表”的问题")计（罗盘）的组合。我看过很多增强现实版本，我想知道哪一个是最好的！其中一些使用[方向](/questions/tagged/orientation "显示标记为“方向”的问题")来找到方位角，而其他使用加速度计和磁力计。据我所知，方向传感器已被弃用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:15:30.900

我发现如果你需要免费的框架，[MIXARE](http://code.google.com/p/mixare/)真的很棒

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-26T19:13:32.250

您可以使用陀螺仪传感器来查找旋转矢量。它可以用来获取方位角。

```
SensorManager mSensorManager = (SensorManager)
getSystemService(Context.SENSOR_SERVICE);
rSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ROTATION_VECTOR); 
```

在 onSensorChanged 函数中，

```
SensorManager.getRotationMatrixFromVector(mRotationMatrix, event.values);
SensorManager.getOrientation(mRotationMatrix, mValues);

azimuth = Math.toDegrees(mValues[0])); 
```

但在某些设备中，此传感器可能不可用。在这种情况下，您可以使用加速度计和磁力计的组合。

```
mSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD);
aSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER); 
```

在 onSensorChaged 函数中，

```
switch (event.sensor.getType()) {
    case Sensor.TYPE_MAGNETIC_FIELD:
        magnetic = event.values.clone();
        break;
    case Sensor.TYPE_ACCELEROMETER:
        accelerometer = event.values.clone();
        break;
}

if (magnetic != null && accelerometer != null) {
    Rot = new float[9];
    I = new float[9];
    SensorManager.getRotationMatrix(Rot, I, accelerometer, magnetic);

    float[] outR = new float[9];
    SensorManager.remapCoordinateSystem(Rot, SensorManager.AXIS_X,
            SensorManager.AXIS_Z, outR);
    SensorManager.getOrientation(outR, values);

    azimuth = values[0];
    magnetic = null;
    accelerometer = null;
} 
```

陀螺仪提供了两个选项中的最佳结果。

# android - MediaPlayer 流媒体错误

> ID：13646893
> 
> 赞同：1
> 
> 时间：2012-11-30T14:12:47.193
> 
> 标签：android, media-player, android-mediaplayer

我正在尝试从我的 PC 上的 VLC 流式传输到在 Android 4.0.3 上运行的 Android 设备，但不知何故它无法正常工作，我搜索了互联网，我的错误意味着我使用了错误的格式。但是我已经得到了正确的格式，这个错误不应该发生。所以我希望你们能帮助我解决问题所在。

```
MediaPlayer player;
SurfaceHolder holder;
SurfaceView surfaceView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    surfaceView = (SurfaceView) findViewById(R.id.rtspStream);
    holder = surfaceView.getHolder();
    holder.addCallback(this);
    player = new MediaPlayer();
    player.setOnErrorListener(this);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
@Override
public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
    // TODO Auto-generated method stub

}
@Override
public void surfaceCreated(SurfaceHolder arg0) {
    try
    {
        if(holder.equals(holder))
        {
            player.setDataSource(this,Uri.parse("rtsp://192.168.0.3:8080/test.sdp"));
            player.setDisplay(holder);          
            player.prepare();
            player.start();
        }
    }
    catch(Exception e){
        Log.e("MEDIA", e.toString());
    }
}
@Override
public void surfaceDestroyed(SurfaceHolder arg0) {
    // TODO Auto-generated method stub  
}
@Override
public boolean onError(MediaPlayer arg0, int arg1, int arg2) {
    if(arg0.equals(player)){
        if(arg1 == MediaPlayer.MEDIA_ERROR_UNKNOWN){
            Log.d("onError","extra "+arg2);
        }

    }
    return false;
} 
```

这是我的测试课。我的 Logcat 看起来像这样

```
01-01 03:02:05.571: D/libEGL(2554): loaded /system/lib/egl/libGLES_android.so
01-01 03:02:05.571: D/libEGL(2554): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
01-01 03:02:05.587: D/libEGL(2554): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
01-01 03:02:05.595: D/libEGL(2554): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
01-01 03:02:05.720: D/OpenGLRenderer(2554): Enabling debug mode 0
01-01 03:02:05.727: D/MediaPlayer(2554): Couldn't open file on client side, trying server side
01-01 03:02:08.837: E/MediaPlayer(2554): error (1, -2147483648)
01-01 03:02:08.837: E/MediaPlayer(2554): Error (1,-2147483648)
01-01 03:02:08.837: D/onError(2554): extra -2147483648 
```

我的测试视频的信息是这样的：

```
General
Complete name                            : testing.mp4
Format                                   : MPEG-4
Format profile                           : Base Media
Codec ID                                 : isom
File size                                : 84.0 MiB
Duration                                 : 2mn 1s
Overall bit rate mode                    : Variable
Overall bit rate                         : 5 776 Kbps
Writing application                      : Lavf53.21.0

Video
ID                                       : 1
Format                                   : AVC
Format/Info                              : Advanced Video Codec
Format profile                           : Baseline@L4.0
Format settings, CABAC                   : No
Format settings, ReFrames                : 3 frames
Codec ID                                 : avc1
Codec ID/Info                            : Advanced Video Coding
Duration                                 : 2mn 1s
Bit rate                                 : 5 740 Kbps
Width                                    : 1 920 pixels
Height                                   : 1 080 pixels
Display aspect ratio                     : 16:9
Frame rate mode                          : Constant
Frame rate                               : 29.970 fps
Color space                              : YUV
Chroma subsampling                       : 4:2:0
Bit depth                                : 8 bits
Scan type                                : Progressive
Bits/(Pixel*Frame)                       : 0.092
Stream size                              : 83.4 MiB (99%)
Writing library                          : x264 core 120 r2171 01f7a33
Encoding settings                        : cabac=0 / ref=3 / deblock=1:0:0 / analyse=0x1:0x111 / me=hex / subme=7 / psy=1 / psy_rd=1.00:0.00 / mixed_ref=0 / me_range=16 / chroma_me=1 / trellis=1 / 8x8dct=0 / cqm=0 / deadzone=21,11 / fast_pskip=1 / chroma_qp_offset=-2 / threads=1 / sliced_threads=0 / nr=0 / decimate=1 / interlaced=0 / bluray_compat=0 / constrained_intra=0 / bframes=0 / weightp=0 / keyint=250 / keyint_min=25 / scenecut=40 / intra_refresh=0 / rc_lookahead=40 / rc=crf / mbtree=1 / crf=23.0 / qcomp=0.60 / qpmin=0 / qpmax=69 / qpstep=4 / ip_ratio=1.25 / aq=1:1.00
Language                                 : English

Audio
ID                                       : 2
Format                                   : AAC
Format/Info                              : Advanced Audio Codec
Format profile                           : LC
Codec ID                                 : 40
Duration                                 : 2mn 1s
Bit rate mode                            : Variable
Bit rate                                 : 33.3 Kbps
Channel(s)                               : 2 channels
Channel positions                        : Front: L R
Sampling rate                            : 16.0 KHz
Compression mode                         : Lossy
Stream size                              : 493 KiB (1%)
Language                                 : English 
```

我在终端中运行 VLC：

```
vlc -vvv testing.mp4 --sout '#rtp{dst=192.168.0.7,port=1234,sdp=rtsp://192.168.0.3:8080/test.sdp}' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:03:54.693

从互联网流式传输时，使用 prepareAsync 而不是 prepare 并从 onPrepared 方法调用 start：

```
player.setOnPreparedListener( new StreamPlayerListener() );         
player.prepareAsync(); 
```

和 StreamPlayerListener 类：

```
private class StreamPlayerListener implements OnPreparedListener {

    @Override
    public void onPrepared(MediaPlayer mp) {
        player.start();
    }
} 
```

# html - 为什么 CSS 中的边距不一致？奇怪的行为

> ID：13646895
> 
> 赞同：4
> 
> 时间：2012-11-30T14:12:51.930
> 
> 标签：html, css

我今天在 jQuery 中玩幻灯片。当我注意到奇怪的事情时，我设法创建了它。放置幻灯片的 div`#feature`似乎以某种方式粘在其父元素`#content`上。当我添加`margin: 10px auto`到`#feature`div 时，`#content`div 也相对于其父元素降低了 10px。

谁能告诉我我在这里做错了什么？

为您提供整个代码会造成混乱，但这里有一个链接：

[https://dharman.eu/sites/daftpunk/](https://dharman.eu/sites/daftpunk/)

用于`#feature`：

```
#feature {
    width:940px;
    margin: 10px auto;
    position: relative;
    height:500px;
    overflow: hidden;
    clear: both;
    box-shadow: 0px 0px 5px 2px #000;
} 
```

和CSS `#content`：

```
#content{
    min-height:800px;
    background-color: #fff;
} 
```

我的朋友注意到一件有趣的事情。如果你在内容中添加`margin-bottom: 30px`到`#menu`空白的 10px 空间，虽然边距问题仍然没有解决，但它会被正确填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T14:16:54.180

`position: relative`只是这样做...使任何适用于它的元素的位置变得与其父容器“相对”。

`#feature`是 的子级`#content`，因此`#feature`的位置相对于 的位置`#content`。当您将 10 像素的边距添加到 #feature 时，它​​会从`#content`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:16:28.383

尝试添加`overflow:auto;`到`#content`. 它可能会有所帮助。

添加溢出可防止边距折叠

> 在 CSS 中，两个或多个框（可能是或不是兄弟）的相邻边距可以组合形成一个边距。

来自[https://www.w3.org/TR/CSS2/box.html#collapsing-margins](https://www.w3.org/TR/CSS2/box.html#collapsing-margins)

# rdf - 在 XML 语法中使用 OWl。第一步

> ID：13646898
> 
> 赞同：3
> 
> 时间：2012-11-30T14:12:57.140
> 
> 标签：rdf, owl

我刚开始在大学的一个项目中使用 OWL。该项目是关于披萨的，这似乎是 RDF 和 OWL 的常见问题。所以我们首先要做的是模拟一个由两种配料组成的比萨饼：西红柿和奶酪。我使用该属性`madeof`将它们连接起来。这是我尝试验证的最小代码片段：[http ://www.mygrid.org.uk/OWL/Validator](http://www.mygrid.org.uk/OWL/Validator)

```
<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns="http://example.org/pizzeria#">

    <owl:Ontology rdf:about=""/>  

    <!-- ========================= -->

    <owl:Class rdf:ID="Topping"/>

    <Topping rdf:ID="Cheese"/>
    <Topping rdf:ID="Tomato"/>

     <owl:ObjectProperty rdf:ID="madeOf">
            <rdfs:range rdf:resource="#Topping"/>
            <rdfs:domain rdf:resource="#Pizza"/>
     </owl:ObjectProperty>

     <!-- Pizza -->
     <owl:Class rdf:ID="Pizza">
         <!-- comes with Cheese and Tomato -->
         <rdfs:subClassOf>
                 <owl:Restriction>
                     <owl:onProperty rdf:resource="#madeOf"/>
                     <owl:hasValue rdf:resource="#Tomato"/>
                 </owl:Restriction>
         </rdfs:subClassOf>
         <rdfs:subClassOf>
             <owl:Restriction>
                 <owl:onProperty rdf:resource="#madeOf"/>
                 <owl:hasValue rdf:resource="#Cheese"/>
             </owl:Restriction>
         </rdfs:subClassOf>
     </owl:Class>
 </rdf:RDF> 
```

但是，验证器告诉我：

OWL DL
个人价值：restriction(a:madeOf value (a:Cheese))
个人价值：restriction(a:madeOf value (a:Tomato))

OWL 完整
无类型类：[http ://example.org/pizzeria#Topping](http://example.org/pizzeria#Topping)

这意味着，我猜，这个`Toppings`类没有定义（我想我这样做了......）并且该`madeof`属性有问题。我想我在这里做错了什么，现在几乎被困住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:24:51.567

您的 OWL 很好，唯一的问题是 RDF 的 XML 编码。一般来说，如果可以，请避免直接使用 RDF/XML。Turtle 是一种更紧凑、更易读的语法，并且比 RDF/XML 具有更少的陷阱。

因此，您遇到的问题是，虽然您确实为空前缀定义了扩展：

```
xmlns="http://example.org/pizzeria#" 
```

您没有为文档定义基本 URI。主题资源，例如：

```
<Topping rdf:ID="Cheese"/> 
```

将被解释为相对于基本 URI，而不是好像它们具有默认的空白前缀。见上文第一段！

修复方法是定义基本 URI 以及默认前缀：

```
<rdf:RDF
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
 xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
 xmlns:owl="http://www.w3.org/2002/07/owl#"
 xmlns="http://example.org/pizzeria#"
 xml:base="http://example.org/pizzeria#"
> 
```

# javascript - 我正在尝试在正方形周围绘制坐标

> ID：13646901
> 
> 赞同：-1
> 
> 时间：2012-11-30T14:13:43.917
> 
> 标签：javascript, math, loops

我正在尝试以编程方式在正方形周围绘制坐标，它很难编码以显示我所追求的。

[http://jsfiddle.net/zwkny/](http://jsfiddle.net/zwkny/)

```
// amount of chairs
var aoc = 4;
// table width
var tw = 200;
// table height
var th = 200;

// chair width height
var cwh = 60 / 2;

var space = tw * 4 / aoc;

var left = [-30,100,-30,-160];
var top = [-160,-30,100,-30];

// straing point
var sp = 12;

for(var i=0; i<aoc; i++){

    var x = cwh + space * i / aoc;
    console.log(x);
    //var y = space / 2 - cwh * i;

    $("#center").append("<div class='chair' style='left:"+left[i]+"px;top:"+top[i]+"px;'>"+i+"</div>");

} 
```

数学绝对不是我的强项，只是想我会在这里发帖，看看是否有人可以帮助我指出正确的方向，如果我得到它，我会继续前进并更新？？？

我需要这种方式来代表站在大广场周围的小圆圈，但会有随机数量的人，他们都需要等距。

我昨天发布了关于圆形物体的同一篇文章，现在我在正方形上，我无法理解数学，任何帮助。

Sore that this has been voted down just thought i would update with a post putting all these together [http://devsforrest.com/116/plot-positions-around-shapes-with-javascript](http://devsforrest.com/116/plot-positions-around-shapes-with-javascript) Hope it helps someone else

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:52:42.720

```
var x,y;

// amount of chairs
var totalChairs = 12;
// square size
var squareSize = 200;
var chairSize = 20;

for(var i=0; i<totalChairs; i++){

var angle = 2*Math.PI * i/totalChairs;

if (angle > Math.PI/4 && angle <= Math.PI* 3/4){
    x = (squareSize/2) / Math.tan(angle);
    y = -squareSize/2;
} else if (angle > Math.PI* 3/4 && angle <= Math.PI* 5/4){
    x = -squareSize/2;
    y = (squareSize/2) * Math.tan(angle);
} else if (angle > Math.PI* 5/4 && angle <= Math.PI* 7/4){
    x = -(squareSize/2) / Math.tan(angle);
    y = -squareSize/2 + squareSize;
} else {
    x = -squareSize/2 + squareSize;
    y = -(squareSize/2) * Math.tan(angle);
}

x -= chairSize/2;
y -= chairSize/2;

$("#center").append("<div class='chair' style='left:"+x+"px;top:"+y+"px;'></div>");
} 
```

[Demo](http://jsfiddle.net/Ld769/)

# css - CSS3 滑动图片

> ID：13646903
> 
> 赞同：0
> 
> 时间：2012-11-30T14:13:48.797
> 
> 标签：css, css-transitions

我在这里有一些简单的 CSS3 动画：http: [//chooseavirb.com/strat/](http://chooseavirb.com/strat/)。它们在 Firefox 上运行良好，但在 Chrome、Safari 或 IE 中根本没有动画效果。有人可以对 css 再看一眼吗，这里有一段摘录（使用了供应商前缀）：

```
@-webkit-keyframes slideup {
0% {transform: translate(0px, 0px);}
20% {transform: translate(0px,0px);}
25% {transform: translate(0px, -150px);}
45% {transform: translate(0px,-150px);}
50% {transform: translate(0px,-300px);}
70% {transform: translate(0px,-300px);}
75% {transform: translate(0px,-150px);}
95% {transform: translate(0px,-150px);}
100% {transform: translate(0px,px);}
}  

@-moz-keyframes slideup {
0% {transform: translate(0px, 0px)}
20% {transform: translate(0px,0px)}
25% {transform: translate(0px, -150px)}
45% {transform: translate(0px,-150px)}
50% {transform: translate(0px,-300px)}
70% {transform: translate(0px,-300px)}
75% {transform: translate(0px,-150px)}
95% {transform: translate(0px,-150px)}
100% {transform: translate(0px,px)}
}  

@keyframes slideup {
0% {transform: translate(0px, 0px)}
20% {transform: translate(0px,0px) }
25% {transform: translate(0px, -150px)}
45% {transform: translate(0px,-150px) }
50% {transform: translate(0px,-300px) }
70% {transform: translate(0px,-300px)}
75% { transform: translate(0px,-150px)}
95% {transform: translate(0px,-150px)}
100% {transform: translate(0px,px)}
}  

.slideup {
-webkit-animation-name: slideup;
-moz-animation-name: slideup;
-o-animation-name: slideup;
animation-name: slideup;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:22:43.273

实际上你应该使用 translate3d(x,y,0); 启用 GPU 加速。许多设备上的动画会更流畅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:16:31.553

只有 Firefox[`transform`不带前缀](http://caniuse.com/#search=transform)才能理解。不仅在@keyframes 中需要前缀，在定义转场时也需要在这些前缀中。像这样的东西

```
 @-moz-keyframes slideup {
      0% {  -moz-transform: translate(0px, 0px); transform: translate(0px, 0px); }
      20% { -moz-transform: translate(0px,0px); transform: translate(0px,0px); }
      25% { -moz-transform: translate(0px, -150px); transform: translate(0px, -150px); }
      45% { -moz-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      50% { -moz-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      70% { -moz-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      75% { -moz-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      95% { -moz-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      100% { -moz-transform: translate(0px,px); transform: translate(0px,px); }
  }
  @-webkit-keyframes "slideup" {
      0% {   -webkit-transform: translate(0px, 0px); transform: translate(0px, 0px); }
      20% {  -webkit-transform: translate(0px,0px); transform: translate(0px,0px); }
      25% {  -webkit-transform: translate(0px, -150px); transform: translate(0px, -150px); }
      45% {  -webkit-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      50% {  -webkit-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      70% {  -webkit-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      75% {  -webkit-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      95% {  -webkit-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      100% { -webkit-transform: translate(0px,px); transform: translate(0px,px); }
  }
  @-ms-keyframes "slideup" {
      0% {   -ms-transform: translate(0px, 0px); transform: translate(0px, 0px); }
      20% {  -ms-transform: translate(0px,0px); transform: translate(0px,0px); }
      25% {  -ms-transform: translate(0px, -150px); transform: translate(0px, -150px); }
      45% {  -ms-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      50% {  -ms-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      70% {  -ms-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      75% {  -ms-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      95% {  -ms-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      100% { -ms-transform: translate(0px,px); transform: translate(0px,px); }
  }
  @-o-keyframes "slideup" {
      0% {   -o-transform: translate(0px, 0px); transform: translate(0px, 0px); }
      20% {  -o-transform: translate(0px,0px); transform: translate(0px,0px); }
      25% {  -o-transform: translate(0px, -150px); transform: translate(0px, -150px); }
      45% {  -o-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      50% {  -o-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      70% {  -o-transform: translate(0px,-300px); transform: translate(0px,-300px); }
      75% {  -o-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      95% {  -o-transform: translate(0px,-150px); transform: translate(0px,-150px); }
      100% { -o-transform: translate(0px,px); transform: translate(0px,px); }
  }
  @keyframes "slideup" {
      0% {   transform: translate(0px, 0px); }
      20% {  transform: translate(0px,0px); }
      25% {  transform: translate(0px, -150px); }
      45% {  transform: translate(0px,-150px); }
      50% {  transform: translate(0px,-300px); }
      70% {  transform: translate(0px,-300px); }
      75% {  transform: translate(0px,-150px); }
      95% {  transform: translate(0px,-150px); }
      100% { transform: translate(0px,px); }
  } 
```

# perl - 可编程 SIP 软电话的多个实例

> ID：13646905
> 
> 赞同：0
> 
> 时间：2012-11-30T14:14:06.480
> 
> 标签：perl, sip, voip

我最近搬到了电信行业，致力于开发自动化框架来自动化 VoIP 电话。

在当前框架中，对于简单的呼叫/会议场景，正在使用额外的辅助电话。当前的框架配置了这些额外的物理助手电话，这需要相当多的时间和资源消耗。

我正在尝试用可编程的软电话替换这些物理助手电话，以便测试执行会有点快。

请让我们知道这是否可行。

我不是在寻找基于 GUI 的软 SIP 客户端，因为自动化 UI 操作将是另一个挑战并且容易出错。

这个框架是用 Perl 开发的

您的帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T02:59:59.100

看看SIPp。[http://sipp.sourceforge.net/](http://sipp.sourceforge.net/)

我认为它会做你想做的事，它甚至可以处理 RTP 数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:16:46.053

如果 perl 不是严格要求，[KitCAT](http://echarts.org/KitCAT)框架对 (Java) 开发人员非常友好。测试用例是用 JUnit 编写的，以便于与其他工具集成。它提供不同级别的日志（包括 SIP 消息），并支持多个用户代理，所有这些都可以在一个测试用例中进行协调。（后者在其他 SIP 测试工具中没有得到很好的支持，例如 sipp）。它还提供与其他协议（例如，RTP、HTTP）的协调。

有一个（有些过时的）[截屏视频](http://echarts.org/KitCATScreencast/kitcat.htm)，显示了该工具的安装和基本用法。

# c++ - IT++ 中的 Elementwise Power

> ID：13646906
> 
> 赞同：-4
> 
> 时间：2012-11-30T14:14:21.120
> 
> 标签：c++, exponential, elementwise-operations

我想知道是否有可能在它++中做元素明智的力量。我没有看到内置函数，如果我忽略了它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:28:22.600

这个/http://itpp.sourceforge.net/devel/group__logexpfunc.html

具有所有各种指数函数。我确定您需要的可以在这里找到

# c - mongodb C驱动程序查询以选择特定字段

> ID：13646908
> 
> 赞同：1
> 
> 时间：2012-11-30T14:14:30.993
> 
> 标签：c, mongodb, field

我读过可以在 MongoDB 中只选择一个字段：

```
db.records.find({TimeStampSec {$lt:10} , {ch11:1}) 
```

例如，此查询返回 TimeStampSec<10 的所有对象的字段 ch11。但我不知道如何翻译成 C 驱动程序。我试过这个：

```
bson_init( &query );
 bson_append_start_object( &query, "TimeStampSec" );
 bson_append_int( &query, "$lt", 10 );
 bson_append_finish_object( &query );

 bson_append_int( &query, "node_id", 1 );

 bson_finish( &query ); 
```

但是，它不起作用。我应该创建另一个对象吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:50:44.647

这对我有用。

```
bson query,selection;
bson_init( &query );
  bson_append_start_object( &query, "TimeStampSec" );
    bson_append_int( &query, "$lt", 10 );
  bson_append_finish_object( &query );
bson_finish( &query );

bson_init( &selection);
    bson_append_int( &selection, "ch11", 1 );
bson_finish( &selection);

    mongo_cursor *cursor=NULL;

    cursor = mongo_find( conn, "db.records",query ,selection,0,0,0);

    if(cursor!=NULL)
    {
        while( mongo_cursor_next( cursor ) == MONGO_OK )
            bson_print( &cursor->current );
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:40:04.360

我对 c api 并不完全熟悉，但我想你应该添加第二个 json obj。

所以最终是这样的：

```
bson_init( &query );
  bson_append_start_object( &query, "TimeStampSec" );
    bson_append_int( &query, "$lt", 10 );
  bson_append_finish_object( &query );

  bson_append_start_object( &query, "$query" );
    bson_append_int( &query, "ch11", 1 );
  bson_append_finish_object( &query );
bson_finish( &query ); 
```

?

# asp.net - 跨多个通配符子域的 ASP.NET 共享会话

> ID：13646909
> 
> 赞同：1
> 
> 时间：2012-11-30T14:14:44.233
> 
> 标签：asp.net, session, iis, wildcard, subdomain

案子：

IIS 7.5 本身不处理通配符子域，因此工作是通过直接固定到特定 IP 地址的 DNS 和 IIS 域完成的。

问题：

会话变量不在主 domain.com 和 sobdomain1.domain.com 之间共享

互联网上最突出的解决方案似乎依赖于将以下代码行添加到 web.config

```
<httpCookies domain=".domain.com" httpOnlyCookies="true" requireSSL="false" /> 
```

但是，它并没有解决问题。

期待一些聪明的想法。谢谢

# vb.net - 什么样的函数可以让我找出任何给定像素的颜色 RGB 分量？

> ID：13646911
> 
> 赞同：-1
> 
> 时间：2012-11-30T14:14:45.993
> 
> 标签：vb.net, visual-studio-2010, mouse, pixel

我的函数中有一个 picbox 存储

图像作为位图，

我现在需要一个可以

当我将鼠标移到它上面时，找出任何给定像素的颜色 RGB 分量

我该怎么做才能得到这个？

* * *

我已成功在选定的文本框中显示 RGB 和像素，但是当我将鼠标移出图片框的一侧时，出现了错误消息：

参数必须为正且 < 宽度。参数名称：x

我尝试使用 If eX > 300 Then eX = 300 但它说“eX”是只读的

我的代码当前看起来像这样：

```
 If pixBox1.Image Is Nothing Then Exit Sub
    txtColourPixel.Text = String.Format("x,y = {0},{1}; Color={2}", e.X, e.Y, DirectCast(pixBox1.Image, Bitmap).GetPixel(e.X, e.Y).ToString) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:32:35.917

你可以这样做：

**更新：**有时移动处理程序会给出实际图像之外的坐标。Oned 可以处理这个问题，或者只是忽略：

```
Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    Dim ofd As New OpenFileDialog
    ofd.ShowDialog()
    PictureBox1.ImageLocation = ofd.FileName
End Sub

Private Sub PictureBox1_MouseMove(sender As Object, e As MouseEventArgs) Handles PictureBox1.MouseMove
    If PictureBox1.Image Is Nothing Then Exit Sub
    Try
        TextBox1.Text = String.Format("x,y = {0},{1}; Color={2}", e.X, e.Y, DirectCast(PictureBox1.Image, Bitmap).GetPixel(e.X, e.Y).ToString)
    Catch ex As ArgumentOutOfRangeException
        ' this can happen, we just swallow it and show an error text
        TextBox1.Text = "out of bounds"
    End Try
End Sub 
```

`GetPixel`是你想要的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:33:29.193

向鼠标移动事件添加处理程序，以获取鼠标移动时的 x、y 位置。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousemove.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.mousemove.aspx)

用于`Bitmap.GetPixel`检索该位置的颜色。

[http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:37:05.393

您可以使用 Bitmap.GetPixel 来确定像素颜色。 [http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.getpixel.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

然后使用 Color 的 R、G 和 B 分量得到 R、G abd B 值：http: [//msdn.microsoft.com/en-us/library/system.drawing.color.r.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.color.r.aspx)

# firefox - 如何只验证一次机器？

> ID：13646914
> 
> 赞同：2
> 
> 时间：2012-11-30T14:15:01.907
> 
> 标签：firefox, authentication, mac-address

我只需要验证一台机器，说这台机器可以访问我的 SAAS。我使用 aspx.net，现在使用超级 cookie 来验证机器。但是在清除 cookie 时，即使共享文件夹的 cookie 也会被删除，超级 cookie 也会被删除。

所以现在我更喜欢使用它的 MAC 地址来验证机器。我找不到任何成功的方法来做到这一点。还发现MAC地址很容易被欺骗。

任何人都可以建议我解决这个问题的方法吗？

PS：由于我的大多数客户都使用 Firefox，我什至在考虑开发一个 FF 扩展来进行身份验证并让我的客户安装该扩展。这行得通吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:20:36.730

尝试[evercookie](http://samy.pl/evercookie/)我认为非常适合您描述的问题。

# python - python：来自函数的迭代器

> ID：13646918
> 
> 赞同：12
> 
> 时间：2012-11-30T14:15:29.597
> 
> 标签：python

从函数创建无限迭代器的[惯用方法是什么？](https://stackoverflow.com/questions/302459/what-is-a-programming-idiom)例如

```
from itertools import islice
import random
rand_characters = to_iterator( random.randint(0,256) )
print ' '.join( islice( rand_characters, 100)) 
```

会产生 100 个随机数

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-30T14:19:27.960

您想要一个不断产生值的迭代器，直到您停止向它询问新值？只需使用

```
it = iter(function, sentinel) 
```

它要求`function()`每个迭代步骤直到结果`== sentinel`。

所以选择一个你想要的函数永远不会返回的哨兵，例如`None`，在你的情况下。

```
rand_iter = lambda start, end: iter(random.randint(start, end), None)
rand_bytes = rand_iter(0, 256) 
```

如果您想监视机器上的某些状态，您可以这样做

```
iter_mystate = iter(getstate, None) 
```

这反过来又无限地调用`getstate()`每个迭代步骤。

但要注意函数`None`作为有效值返回！在这种情况下，您应该选择一个保证唯一的哨兵，也许是为这个工作创建的对象：

```
iter_mystate = iter(getstate, object()) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-30T14:34:38.890

每次我看到`iter`2 个参数时，我都需要挠头并查看文档以弄清楚到底发生了什么。正因为如此，我可能会自己动手：

```
def call_forever(callback):
    while True:
        yield callback() 
```

* * *

或者，正如 Jon Clements 在评论中所述，您可以使用`itertools.repeatfunc`允许您将参数传递给函数的配方：

```
import itertools as it
def repeatfunc(func, times=None, *args):
    """
    Repeat calls to func with specified arguments.
    Example:  repeatfunc(random.random)
    """
    if times is None:
        return it.starmap(func, it.repeat(args))
    return it.starmap(func, it.repeat(args, times)) 
```

虽然我觉得函数签名`def repeatfunc(func,times=None,*args)`有点别扭。我更喜欢将元组作为 args 传递（对我来说这似乎更明确，并且“显式优于隐式”）：

```
import itertools as it
def repeatfunc(func, args=(),times=None):
    """
    Repeat calls to func with specified arguments.
    Example:  repeatfunc(random.random)
    """
    if times is None:
        return it.starmap(func, it.repeat(args))
    return it.starmap(func, it.repeat(args, times)) 
```

这允许它被称为：

```
repeatfunc(func,(arg1,arg2,...,argN),times=4) #repeat 4 times
repeatfunc(func,(arg1,arg2,...))                #repeat infinitely 
```

而不是来自的香草版本`itertools`：

```
repeatfunc(func,4,arg1,arg2,...)    #repeat 4 times
repeatfunc(func,None,arg1,arg2,...) #repeat infinitely 
```

# weblogic9.x - 无需重启即可将新 jar 部署到 weblogic 9.2

> ID：13646919
> 
> 赞同：1
> 
> 时间：2012-11-30T14:15:30.473
> 
> 标签：weblogic9.x

我必须开发一个基于 Spring AOP 的应用程序，该应用程序将跟踪 Id 和记录器添加到现场生产中的现有应用程序。

新的 aop 应用程序需要打包到 jar 中，并且要部署在生产中的代码上。但是生产代码正在 weblogic 服务器上运行，我没有选择停止已经运行的 weblogic 服务器。

任何人都可以帮助或给我有关如何将这个新 jar 引入 weblogic 上正在运行的应用程序的线索。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T09:34:50.810

有点晚了，但我在搜索同样的东西时发现了这个问题。该`nostage`模式可以帮助您解决这个问题，我在 JSP 上尝试过，效果很好，但不确定 jars 虽然这些链接很有用，它们可能会有所帮助 ——http: [//docs.oracle.com/cd/E11035_01/wls100/部署/deploy.html#wp1024366](http://docs.oracle.com/cd/E11035_01/wls100/deployment/deploy.html#wp1024366)

[如何在 weblogic 上刷新 jsp](https://stackoverflow.com/questions/1476461/how-do-i-refresh-jsps-on-weblogic)

# ms-access-2010 - 为什么我的表没有记录我在访问中传递给它的值

> ID：13646924
> 
> 赞同：1
> 
> 时间：2012-11-30T14:15:52.937
> 
> 标签：ms-access-2010

在单击按钮打开第二个表单后，我试图将表单 1 上的字段 ReportID（这是一个数字字段）中的值传递给名为 Budget_fsub 的表单上的字段 ReportID。我已经尝试使用此代码将值传递给第二种形式，并且看起来它可以工作，但是当我转到保存第二种形式的值的表时，该值尚未被记录。我究竟做错了什么？

Form1 带有打开 form2 的按钮：

```
Private Sub cmdEnterBudgetInfo_Click()

On Error GoTo Err_EnterBudgetInfo_Click

    Dim stDocName As String
    Dim stLinkCriteria As String

    stDocName = "Budget_fsub"
    DoCmd.OpenForm stDocName, , , , acFormAdd, , Me![ReportID]

Exit_cmdEnterBudgetInfo_Click

    Exit Sub

Err_EnterBudgetInfo_Click:

    MsgBox Err.Description
    Resume Exit_cmdEnterBudgetInfo_Click

End Sub 
```

这是 Budget_fsub 表单上的代码：

```
Private Sub Form_Open(Cancel As Integer)

Dim defaultID As Long

defaultID = CLng(Nz(Me.OpenArgs, 0))

If defaultID = 0 Or IsNull(Me.OpenArgs) Then

    Cancel = True
    Exit Sub
End If

Me.ReportID.DefaultValue = defaultID

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T21:31:18.687

所以，这是一个可行的解决方案。我假设您已绑定表单并且 ReportID 文本框已绑定到该列。请注意，我从来都不喜欢使用宏来操作数据。

这是您的 Form1 的代码：

```
Private Sub cmdEnterBudgetInfo_Click()
On Error GoTo Err_EnterBudgetInfo_Click

Dim stDocName As String
Dim stLinkCriteria As String

stDocName = "Budget_fsub"
'close the form first
DoCmd.Close acForm, stDocName, acSaveYes

DoCmd.OpenForm stDocName, , , , acFormAdd, , Me![ReportID]

Exit_cmdEnterBudgetInfo_Click:

    Exit Sub

Err_EnterBudgetInfo_Click:

    MsgBox Err.Description
    Resume Exit_cmdEnterBudgetInfo_Click

End Sub 
```

这是您的子表单（Budget_fsub）的代码：

```
Option Compare Database
Option Explicit

'global variable
Dim repID As Long

'form load event
Private Sub Form_Load()

Me.ReportID.Value = repID

DoCmd.RunCommand acCmdSave

End Sub

'form open event
Private Sub Form_Open(Cancel As Integer)

SetReportID

If repID = 0 Then
    Cancel = True
    Exit Sub
End If

End Sub

'function to set reportID from the openargs
Private Function SetReportID()

repID = CLng(Nz(Me.OpenArgs, 0))

End Function 
```

希望这可以帮助。

# linux - 允许非 root 用户删除缓存

> ID：13646925
> 
> 赞同：6
> 
> 时间：2012-11-30T14:15:55.457
> 
> 标签：linux, sudoers, clear-cache

我正在一个系统上进行性能测试，我需要确保我正在从磁盘读取数据，并且它不只是缓存（比如来自早期测试）。[我在这里](http://www.linuxatemyram.com/play.html)读到我可以使用命令删除缓存

```
echo 3 | sudo tee /proc/sys/vm/drop_caches 
```

但是，请注意，即使我的帐户是管理员帐户（登录 peter），它仍然需要我的密码。我希望能够在不需要输入密码的情况下在批处理脚本中运行它（因为这显然是手动的）

更多的[研究](http://ubuntuforums.org/showthread.php?t=1132821)使我找到了 sudoers 文件。我的计划是将上述命令放入一个名为 dropCache 的单行脚本中，然后编辑 sudoers，这样我就可以在不输入密码的情况下运行它。所以我添加了这一行

```
ALL ALL=(ALL)NOPASSWD:/home/peter/dropCache 
```

在我的 sudoers 文件的末尾（使用 visudo）。使用我的管理员帐户，如果我运行

```
sudo -l 
```

我明白了

```
(ALL) NOPASSWD: /home/peter/dropCache 
```

但是，如果我运行我的 dropCache 脚本，我仍然会被要求输入密码

```
./dropCache
[sudo] password for peter: 
```

对此的任何帮助将不胜感激。我正在运行 Ubuntu 12.04

谢谢彼得

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-30T14:23:00.580

当我需要这个时，我做了一个小 C 程序，将编译文件的所有者更改为 root，并设置 setuid 位。

这是源代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/types.h>

extern void sync(void);

int main(void) {
    if (geteuid() != 0) {
        fprintf(stderr, "flush-cache: Not root\n");
        exit(EXIT_FAILURE);
    }
    printf("Flushing page cache, dentries and inodes...\n");
    // First: the traditional three sync calls. Perhaps not needed?
    // For security reasons, system("sync") is not a good idea.
    sync();
    sync();
    sync();
    FILE* f;
    f = fopen("/proc/sys/vm/drop_caches", "w");
    if (f == NULL) {
        fprintf(stderr, "flush-cache: Couldn't open /proc/sys/vm/drop_caches\n");
        exit(EXIT_FAILURE);
    }
    if (fprintf(f, "3\n") != 2) {
        fprintf(stderr, "flush-cache: Couldn't write 3 to /proc/sys/vm/drop_caches\n");
        exit(EXIT_FAILURE);
    }
    fclose(f);
    printf("Done flushing.\n");

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-14T18:41:11.867

我在 Ubuntu 21.04 上试过这个并且它有效： 第 1 步：创建一个如下所示的小脚本（假设名称为 clear_drop_cacahes.sh）：

```
#!/bin/sh

# Run a sync to reduce dirty caches
sync

# Tell the OS to clear caches
echo 3 > /proc/sys/vm/drop_caches 
```

第 2 步：使脚本可执行：`chmod 744 clear_drop_caches.sh`

第 3 步：需要与具有 sudo 权限的人一起执行此操作：

`sudo visudo`

添加以下行（到文件末尾）

```
ALL      ALL=(ALL) NOPASSWD:/path-to-the-small-script/clear_drop_caches.sh 
```

第 4 步：现在任何用户都可以运行 drop caches 脚本，如下所示：

```
sudo /path-to-the-small-script/clear_drop_caches.sh 
```

我不确定做这样的事情的安全性。

# javascript - 里面的标签href 上带有 javascript 功能的标记无法运行

> ID：13646929
> 
> 赞同：2
> 
> 时间：2012-11-30T14:16:21.963
> 
> 标签：javascript, html, internet-explorer, text-to-speech

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:23:29.733

出于安全原因，请不要将 Javascript 放在`href`某些浏览器中禁用的 Javascript 中。

使用`onclick`事件运行代码：

```
<a href="#" onclick="onHello();return false;"><label style="cursor:pointer">Hello2</label></a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T14:36:24.173

我认为这是一个纯粹的语法问题。标签旨在与表单一起使用，用户可以单击以与表单输入进行交互。

我知道你说没有“为什么”和“为什么不”，但在链接中使用标签绝对不是一个好主意......这不仅仅是标签内的标签，因为标签标签应该被点击所以你有 2 个标签可以点击。IE 似乎在您的示例中更加重视标签，因此它不会在链接中运行您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-30T14:19:49.070

您应该在 onClick 事件上运行 javascript，不要将其放在 href 上（使用 # 或其他东西作为 href）。

另外，如果您想阻止链接被跟踪，请不要忘记返回 false；（或 event.preventDefault()）。例如

```
 <a href="#" onClick="onHello(); return false;">Hello1</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-30T14:20:36.900

而是在 href 中使用 onclick

```
<a href='#' onclick="onHello(); return false;">Hello1</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-30T14:21:37.427

你为什么不跳过a-tag，在标签上绑定javascript片段？

```
<label style="cursor:pointer" onclick="onHello();">Hello2</label> 
```

# c# - 使用 MoveWindow 后保留新的窗口设置

> ID：13646931
> 
> 赞同：1
> 
> 时间：2012-11-30T14:16:26.380
> 
> 标签：c#

经过长时间的搜索和尝试，我终于成功地将所有屏幕从第二屏幕移动到主屏幕。

```
[DllImport("user32.dll", SetLastError = true)]
    internal static extern bool MoveWindow(IntPtr hWnd, int X, int Y, int nWidth, int nHeight, bool bRepaint);
    [DllImport("user32.dll")]
    public static extern bool GetWindowRect(IntPtr hwnd, ref Rectangle rectangle);

private void putAllWindowsOnPrimairyScreen(){

int procesWidth, procesHeight;

    foreach (Process p in Process.GetProcesses())
    {
       IntPtr id = p.MainWindowHandle;
       Rectangle rect = new Rectangle();
       GetWindowRect(id, ref rect);
       if (!string.IsNullOrEmpty(p.MainWindowTitle))
       {
          if (rect.Height > Screen.PrimaryScreen.Bounds.Height) procesHeight = Screen.PrimaryScreen.Bounds.Height;
          else procesHeight = rect.Height;
          if (rect.Width > Screen.PrimaryScreen.Bounds.Width) procesWidth = Screen.PrimaryScreen.Bounds.Width;
          else procesWidth = rect.Width;
          System.Console.WriteLine(p.MainModule.FileVersionInfo.ProductName);
          MoveWindow(id, 0, 0, procesWidth, procesHeight, true);
        }
    }
} 
```

但是，屏幕，在我的情况下是 Firefox，不会停留在主屏幕......我可以打开它一次，第二次尝试，它恢复到第二个屏幕。

我怎样才能让它留在主屏幕上？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T10:18:18.697

经过长时间的搜索、跟踪和错误，我通过编辑代码解决了这个问题：

```
[DllImport("user32.dll")]
        private static extern bool GetWindowRect(IntPtr hwnd, ref Rectangle rectangle);
[DllImport("user32.dll", SetLastError = true)]
            internal static extern bool MoveWindow(IntPtr hWnd, int X, int Y, int nWidth, int nHeight, bool bRepaint);
[DllImport("user32.dll")]
            public static extern bool ShowWindow(IntPtr hwnd, int nCmdShow);
    public const uint WM_SYSCOMMAND = 0x0112;
    public const int SC_MINIMIZE = 0xF020;
    public const int SC_NEXTWINDOW = 0xF040;
    public const int SW_FORCEMINIMIZE = 11;
    public const int SW_HIDE = 0;
    public const int SW_MAXIMIZE = 3;
    public const int SW_MINIMIZE = 6;
    public const int SW_RESTORE = 9;
    public const int SW_SHOW = 5;
    public const int SW_SHOWDEFAULT = 10;
    public const int SW_SHOWMAXIMIZED = 3;
    public const int SW_SHOWMINIMIZED = 2;
    public const int SW_SHOWMINNOCATIVE = 7;
    public const int SW_SHOWNA = 8;
    public const int SW_SHOWNOACTIVATE = 4;
    public const int SW_SHOWNORMAL = 1;

    [StructLayout(LayoutKind.Sequential)]
    public struct WINDOWRECTANGLE
    {
        public int Left;        // x position of upper-left corner
        public int Top;         // y position of upper-left corner
        public int Right;       // x position of lower-right corner
        public int Bottom;      // y position of lower-right corner
    }

    /// <summary>
    /// Puts all the active screens on the primairy screen.
    /// </summary>
    public static void putAllWindowsOnPrimairyScreen()
    {
        foreach (Process p in Process.GetProcesses())
        {
            int procesWidth, procesHeigth, defaultProcesWidth, defaultProcesHeigth;
            IntPtr id = p.MainWindowHandle;
            if (!string.IsNullOrEmpty(p.MainWindowTitle))
            {
                WINDOWRECTANGLE rect = new WINDOWRECTANGLE();
                WINDOWRECTANGLE defaultrect = new WINDOWRECTANGLE();
                GetWindowRect(id, ref rect);
                ShowWindow(id, SW_SHOWNOACTIVATE);
                GetWindowRect(id, ref defaultrect);
                if (rect.Left > Screen.PrimaryScreen.Bounds.Width || rect.Left < 0 || rect.Right > Screen.PrimaryScreen.Bounds.Width || rect.Right < 0 || rect.Top > Screen.PrimaryScreen.Bounds.Height || rect.Top < 0 || rect.Bottom > Screen.PrimaryScreen.Bounds.Height || rect.Bottom < 0)
                {
                    procesWidth = rect.Right - rect.Left;
                    procesHeigth = rect.Bottom - rect.Top;
                    defaultProcesWidth = defaultrect.Right - defaultrect.Left;
                    defaultProcesHeigth = defaultrect.Bottom - defaultrect.Top;
                    PostMessage(p.Handle, WM_SYSCOMMAND, SC_NEXTWINDOW, 0);
                    MoveWindow(id, 0, 0, defaultProcesWidth, defaultProcesHeigth, true);
                    p.Refresh();
                    if (procesHeigth >= Screen.PrimaryScreen.Bounds.Height || procesWidth >= Screen.PrimaryScreen.Bounds.Width) ShowWindow(id, SW_MAXIMIZE);
                }
            }
        }
    } 
```

因此，可以将外部窗口强制到另一个屏幕并让它停留在那里。复制并粘贴此代码完成后，只需激活该方法`putAllWindowsOnPrimairyScreen()`

# umbraco - Umbraco Lucene.Net.Index.MergePolicy.MergeException 这是什么原因造成的？

> ID：13646938
> 
> 赞同：3
> 
> 时间：2012-11-30T14:17:11.057
> 
> 标签：umbraco, lucene.net, lucene

我正在使用 Umbraco，出于某种原因，我突然出现 Visual Studio JIT 调试器弹出窗口，询问我是否要使用 w3wp.exe 进行调试和异常，我附加到它并发现以下异常，我找不到任何原因是因为我没有添加任何新内容。

```
Lucene.Net.Index.MergePolicy.MergeException was unhandled
  Message=Exception of type 'Lucene.Net.Index.MergePolicy+MergeException' was thrown.
  Source=Lucene.Net
  StackTrace:
       at Lucene.Net.Index.ConcurrentMergeScheduler.HandleMergeException(Exception exc)
       at Lucene.Net.Index.ConcurrentMergeScheduler.MergeThread.Run()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: Lucene.Net.Index.CorruptIndexException
       Message=doc counts differ for segment _3qw: fieldsReader shows 1025 but segmentInfo shows 1
       Source=Lucene.Net
       StackTrace:
            at Lucene.Net.Index.IndexWriter.HandleMergeException(Exception t, OneMerge merge)
            at Lucene.Net.Index.IndexWriter.Merge(OneMerge merge)
            at Lucene.Net.Index.ConcurrentMergeScheduler.DoMerge(OneMerge merge)
            at Lucene.Net.Index.ConcurrentMergeScheduler.MergeThread.Run()
       InnerException: 
```

有谁知道是什么原因造成的或如何解决？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:34:44.573

我从这个链接中找到了答案：

[http://our.umbraco.org/forum/ourumb-dev-forum/bugs/16066-Missing-LuceneNet-assembly](http://our.umbraco.org/forum/ourumb-dev-forum/bugs/16066-Missing-LuceneNet-assembly)

在 Dunfee 上 6 个月前发布了此回复 刚刚经历了从一个位置到另一个位置的迁移。我删除了 App_Data/TEMP/ExamineIndexes 的内容，并在观看浏览器微调器（在重建 Lucene 缓存时）大约一分钟后，该站点出现了。

# eclipse - 如何配置 Eclipse 以更好地编写 C++？

> ID：13646939
> 
> 赞同：0
> 
> 时间：2012-11-30T14:17:13.147
> 
> 标签：eclipse, autocomplete, header

我曾经使用[Qt Creator](http://en.wikipedia.org/wiki/Qt_Creator)在 Linux 上做 C++ 开发。在其中开发 C/C++ 项目很棒，但最近我不得不切换到[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)。如何使用 Eclipse 更有效地编写 C++ 代码？

1.  自动完成。Eclipse有什么好的插件吗？在 Eclipse 中，这与`Alt`+有关`/`，有时我认为键入几个字符后的快速下拉列表更酷。

2.  C++ 头文件列表。当我想包含其他库的标头时，例如[ACE](http://en.wikipedia.org/wiki/Adaptive_Communication_Environment)标头，我必须输入整个标头名称。有什么方法可以配置 Eclipse，比如 Qt Creator，当我键入`#include "../ "`父头文件时，将显示在下拉列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-02T00:34:50.100

> 1.  自动完成 [...] 我认为输入几个字符后的快速下拉列表更酷。

`Ctrl`如果您正在输入姓名，如果您按+ ，则会出现自动完成下拉菜单`Space`。

此外，下拉菜单配置为在键入 、 或 后不久`.`自动`->`出现`::`。如果这对您不起作用，请在“C/C++ → 编辑器 → 内容辅助”下检查您的偏好。有一个部分称为“自动激活”。确保选中这些框。

> 2) C++ 头文件列表 [...]

只需在键入后的某个时间按`Ctrl`+或获取下拉菜单。它会给你它找到的文件和文件夹的列表。`Space``#include<``#include "`

我假设您使用的是 Eclipse CDT（即用于 C++ 开发的标准 Eclipse IDE）。

# html - 在 Jekyll/Ruby 中缩进生成的标记

> ID：13646945
> 
> 赞同：16
> 
> 时间：2012-11-30T14:17:34.910
> 
> 标签：html, ruby, jekyll, liquid

好吧，这可能是一个愚蠢的问题，但我想知道是否有任何方法可以在 Jekyll 中生成标记来保留 Liquid-tag 的缩进。如果无法解决，世界就不会结束。我只是好奇，因为我喜欢我的代码看起来整洁，即使编译。:)

例如我有这两个：

base.html：

```
<body>
    <div id="page">
        {{content}}
    </div>
</body> 
```

索引.md：

```
---
layout: base
---
<div id="recent_articles">
    {% for post in site.posts %}
    <div class="article_puff">
        <img src="/resources/images/fancyi.jpg" alt="" />
        <h2><a href="{{post.url}}">{{post.title}}</a></h2>
        <p>{{post.description}}</p>
        <a href="{{post.url}}" class="read_more">Read more</a>
    </div>
    {% endfor %}    
</div> 
```

问题是导入的 {{content}}-tag 是在没有上面使用的缩进的情况下呈现的。

所以而不是

```
<body>
    <div id="page">
        <div id="recent_articles">  
            <div class="article_puff">
                <img src="/resources/images/fancyimage.jpg" alt="" />
                <h2><a href="/articles/2012/11/14/gettin-down-with-rwd.html">Gettin' down with responsive web design</a></h2>
                <p>Everyone's talking about it. Your client wants it. You need to code it.</p>
                <a href="/articles/2012/11/14/gettin-down-with-rwd.html" class="read_more">Read more</a>
            </div>
        </div>
    </div>
</body> 
```

我明白了

```
<body>
    <div id="page">
        <div id="recent_articles">  
<div class="article_puff">
<img src="/resources/images/fancyimage.jpg" alt="" />
    <h2><a href="/articles/2012/11/14/gettin-down-with-rwd.html">Gettin' down with responsive web design</a></h2>
    <p>Everyone's talking about it. Your client wants it. You need to code it.</p>
    <a href="/articles/2012/11/14/gettin-down-with-rwd.html" class="read_more">Read more</a>
</div>
</div>
    </div>
</body> 
```

似乎只有第一行正确缩进。其余的从行首开始......那么，多行液体模板导入？:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T05:18:13.020

**使用液体过滤器**

我设法使用液体过滤器完成了这项工作。有几个注意事项：

*   您的输入必须是干净的。我有一些弯引号和不可打印的字符，在一些文件中看起来像空格（来自 Word 的 copypasta 等），并且将“UTF-8 中的无效字节序列”视为 Jekyll 错误。

*   它可能会破坏一些东西。我正在使用`<i class="icon-file"></i>`来自 twitter bootstrap 的图标。它将空标签替换为`<i class="icon-file"/>`引导程序不喜欢那样。此外，它搞砸了我内容中的 octopress `{% codeblock %}`。我并没有真正研究为什么。

*   虽然这将清除液体变量的输出，例如`{{ content }}`它实际上并不能解决原始帖子中的问题，即在周围 html**的上下文中缩进 html。**这将提供格式良好的 html，但作为一个片段，不会相对于片段上方的标签缩进。如果您想在上下文中格式化所有内容，请使用 Rake 任务而不是过滤器。

-

```
require 'rubygems'
require 'json'
require 'nokogiri'
require 'nokogiri-pretty'

module Jekyll
  module PrettyPrintFilter
    def pretty_print(input)
      #seeing some ASCII-8 come in
      input = input.encode("UTF-8")

      #Parsing with nokogiri first cleans up some things the XSLT can't handle
      content = Nokogiri::HTML::DocumentFragment.parse input
      parsed_content = content.to_html

      #Unfortunately nokogiri-pretty can't use DocumentFragments...
      html = Nokogiri::HTML parsed_content
      pretty = html.human

      #...so now we need to remove the stuff it added to make valid HTML
      output = PrettyPrintFilter.strip_extra_html(pretty)
      output
    end

    def PrettyPrintFilter.strip_extra_html(html)
      #type declaration
      html = html.sub('<?xml version="1.0" encoding="ISO-8859-1"?>','')

      #second <html> tag
      first = true
      html = html.gsub('<html>') do |match|
        if first == true
          first = false
          next
        else
          ''
        end
      end

      #first </html> tag
      html = html.sub('</html>','')

      #second <head> tag
      first = true
      html = html.gsub('<head>') do |match|
        if first == true
          first = false
          next
        else
          ''
        end
      end

      #first </head> tag
      html = html.sub('</head>','')

      #second <body> tag
      first = true
      html = html.gsub('<body>') do |match|
        if first == true
          first = false
          next
        else
          ''
        end
      end

      #first </body> tag
      html = html.sub('</body>','')

      html
    end
  end
end

Liquid::Template.register_filter(Jekyll::PrettyPrintFilter) 
```

**使用 Rake 任务**

在生成 jekyll 站点后，我在我的 rakefile 中使用一个任务来漂亮地打印输出。

```
require 'nokogiri'
require 'nokogiri-pretty'

desc "Pretty print HTML output from Jekyll"
task :pretty_print do
  #change public to _site or wherever your output goes
  html_files = File.join("**", "public", "**", "*.html")

  Dir.glob html_files do |html_file|
    puts "Cleaning #{html_file}"

    file = File.open(html_file)
    contents = file.read

    begin
      #we're gonna parse it as XML so we can apply an XSLT
      html = Nokogiri::XML(contents)

      #the human() method is from nokogiri-pretty. Just an XSL transform on the XML.
      pretty_html = html.human
    rescue Exception => msg
      puts "Failed to pretty print #{html_file}: #{msg}"
    end

    #Yep, we're overwriting the file. Potentially destructive.
    file = File.new(html_file,"w")
    file.write(pretty_html)

    file.close
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T22:38:58.623

我们可以通过编写一个自定义的 Liquid 过滤器来整理 html，然后`{{content | tidy }}`包含 html 来实现这一点。

快速搜索[表明](https://stackoverflow.com/questions/5584893/cleaning-html-with-nokogiri-instead-of-tidy)，红宝石 tidy gem 可能无法维护，但 nokogiri 是要走的路。这当然意味着安装 nokogiri gem。

请参阅[有关编写液体过滤器的建议](https://github.com/Shopify/liquid/wiki/)和[Jekyll 示例过滤器](https://github.com/mojombo/jekyll/wiki/Liquid-Extensions)。

一个示例可能如下所示： 在 中`_plugins`，添加一个名为 tidy-html.rb 的脚本，其中包含：

```
require 'nokogiri'
module TextFilter
  def tidy(input)
  desired = Nokogiri::HTML::DocumentFragment.parse(input).to_html
  end
end
Liquid::Template.register_filter(TextFilter) 
```

（未经测试）

# android - 内存影响片段创建（在每个片段事务中创建）

> ID：13646947
> 
> 赞同：0
> 
> 时间：2012-11-30T14:17:38.003
> 
> 标签：android, android-fragments, performance, android-memory

我对片段的记忆含义有疑问。就内存而言，最佳解决方案是什么：

1）为每个片段创建一个对象，并在事务管理器中使用这些对象。

```
MyFragment myFrag=new MyFragment();
fragmentTransaction.replace(R.id.mainPager, myFrag); 
```

2）直接在事务管理器中创建片段并让垃圾收集器考虑这个对象，我的意思是这样的：

```
fragmentTransaction.replace(R.id.mainPager, new MyFragment()); 
```

在可能的内存泄漏和性能优化方面，这两个选项之间是否有任何区别。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:42:10.693

```
MyFragment myFrag=new MyFragment();
fragmentTransaction.replace(R.id.mainPager, myFrag); 
```

这不会使内存负载加倍。myFrag 只是对新片段的引用，它只存储片段的内存位置，因此重载可以忽略不计。

# windows - 不在 %homepath% 上时在 VIM 中打开文件不起作用

> ID：13646948
> 
> 赞同：0
> 
> 时间：2012-11-30T14:17:37.350
> 
> 标签：windows, development-environment, vim

我是使用 Vim 的新手，现在已经修改了一两天了。现在，我正在填写和自定义我的 vimrc 文件。

我是一个狂热的 Windows Powershell 用户，我更喜欢它而不是旧的命令提示符。

现在，当我每次尝试在 vim 中打开文件时。它从我的 C:\Users\ 打开文件，而不是打开我所在的当前目录。

说： - 当我打开 powershell 时，我在 C:\Users\MDF - 然后我命令： cd $env:www 去我的 WWW wamp 路径进行 Web 开发 - 现在我在 C:\wamp\www 上。 . - 但是当我发出命令时：vim ./index.php（与 no ./ 相同）在 vim 中打开的文件是我的 C:\Users\ 上存在的 index.php 文件

有什么办法可以解决这个问题吗？

我寻找解决方案并找到了“set autochdir”，它可以自动设置当前工作目录。

但该解决方案仅适用于普通的旧 Windows CMD，不适用于 Powershell

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:38:41.067

哇！我想我已经为这个问题找到了一个平凡的解决方案。真正的问题在于 Powershell 处理目录和环境的方式。

现在让一切正常工作： - 使用 $pwd 魔法变量，它是 Powershell 中的当前目录

*   所以当你想打开一个文件说 index.php （它不在 %homepath% 目录中）时，只需使用以下命令：

    vim $pwd/index.php

这个想法是打开/

# cakephp - 我应该只向 CakePHP 中的用户输入添加验证条件吗？

> ID：13646950
> 
> 赞同：0
> 
> 时间：2012-11-30T14:17:41.677
> 
> 标签：cakephp, validation

在 CakePHP 中烘焙模型时，我应该只向用户输入的数据添加验证条件吗？还是对一切？还是针对某些特定数据？该数据库主要由管理员添加的内容组成。只有 1 个与用户相关的表。我不确定。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:29:53.217

**验证一切！：**

验证一切。没有理由不对所有内容添加验证。如果管理员知道他们在做什么，并且按照要求插入数据，那么他们无论如何都不会看到任何验证错误。但是 - 如果他们有片刻的精神错乱，或者只是不知道什么是允许/不允许的，那么进行验证是一个很好的后备。

**我们都做到了（或者……没有做到）：**

对于一个小/简单的项目来说，不想花时间添加验证是可以理解的——我们可能都已经完成了……但是当被问到“你应该为所有东西添加验证吗？”时，我认为答案必须是“是的！”。

**验证 - 不仅适用于用户生成的内容：**

验证总体上很棒——不仅适用于用户输入的数据，还适用于抓取的、代码生成的数据、管理员输入的数据以及介于两者之间的所有数据。

**可以稍微松懈......如果你必须**

如果您的大部分数据不是用户生成的，您总是可以考虑让验证比其他情况稍微宽松一些，但是 - 拥有它总比没有好。

# c# - 如何获取索引

> ID：13646951
> 
> 赞同：0
> 
> 时间：2012-11-30T14:17:45.193
> 
> 标签：c#, arrays, picturebox, indexof

对于一个学校项目，我必须做一个餐桌预订系统，我做了以下（只是一小部分）。

```
PictureBox[] pb = new PictureBox[70] { pictureBox1, pictureBox2, pictureBox3,etc..  };
foreach (PictureBox p in pb)
{
    p.BorderStyle = BorderStyle.Fixed3D;
    p.BackColor = Color.White;
    p.MouseEnter += new EventHandler(mouseOn);
    p.MouseClick += new MouseEventHandler(mouseClick);
}

private void mouseOn(object sender, EventArgs e)
{
    ((PictureBox)sender).BackColor = Color.Green;
}

private void mouseClick(object sender, EventArgs e)
{
    reservationForm rf = new reservationForm();
    rf.ShowDialog();
} 
```

我选择了图片框来表示表格，默认`BackColor`为白色，当鼠标进入时`BackColor`变为绿色。

当您单击其中一个`PictureBox`我会打开的 es`reservationForm`时，您可以在此处进一步填写详细信息以预订餐桌。

但我现在卡住的部分是我不知道`PictureBox`我点击的预订表格，所以我需要得到类似`PictureBox`数组索引的东西。

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:20:08.447

检查发件人

```
private void mouseClick(object sender, EventArgs e)
{
    PicterBox pb = (PicterBox)sender;
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:20:48.897

你知道怎么做！:)

您已经在`mouseOn`事件处理程序上正确执行了此操作。只需对`sender`参数进行相同的转换即可。

```
private void mouseClick(object sender, EventArgs e)
{
    PictureBox clickedBox = (PictureBox)sender;

    reservationForm rf = new reservationForm();
    rf.ShowDialog();
} 
```

如果您需要索引，则可以使用`Array.IndexOf`，假设您的`pb`数组是类级别变量而不是本地方法。

```
int index = Array.IndexOf(pb, clickedBox); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T14:22:04.263

在您的“MouseOn”中，您已经使用它`(PictureBox)sender`来获取对图片框*的引用*。然后，您可以遍历数组以将特定索引处的图片框与单击的图片框进行比较。当你有匹配时，你找到了索引。

```
var clicked = (PictureBox)sender;
int index = 0;
while (index < pb.Length && pb[index] != clicked) index = index+1;
// now index is either 70 (if not found) or the position you want (0..69) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:26:13.967

也许你可以在每个图片框上设置一个循环名称，等于对应索引。所以在听众中你可以使用

> PicterBox pb = (PicterBox)sender;

并获取作为索引的名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T14:26:32.063

你有很多选择。我会推荐其中一些：

*   创建一个公共类变量或属性，并将当前选中的Picturebox存储在点击事件上，这样就可以从表单中访问了；
*   为表单的构造函数传入 Picturebox（创建一个接受此信息并将其存储在内部变量中的构造函数）。

# c++ - swig生成代码，为C++ API的python包装器生成非法存储类

> ID：13646954
> 
> 赞同：1
> 
> 时间：2012-11-30T14:18:17.967
> 
> 标签：c++, python, visual-studio-2010, swig

我正在尝试采用将 swig 与主头文件一起使用的方法。似乎 swig 可以做到这一点，但我遇到了一些问题。[我在 stackoverflow 上](https://stackoverflow.com/questions/13581600/compiling-swig-extension-with-coledatetime-for-python)问了第一个问题，虽然我还没有成功，但我已经取得了足够的进展，感到鼓励继续......

所以现在，这是我的接口文件：

```
/* File : myAPI.i */
%module myAPI

%{
#include "stdafx.h"
#include <boost/algorithm/string.hpp>
... many other includes ...
#include "myAPI.h"
#include <boost/algorithm/string/predicate.hpp>
#include <boost/filesystem/path.hpp>
#include <boost/filesystem/operations.hpp>
using boost::format;
using namespace std;
using namespace boost::algorithm;
using namespace boost::serialization;
%}

/* Let's just grab the original header file here */
%include "myAPI.h" 
```

据我所知，swig 运行良好。但是，在生成的代码中，它会产生许多像这样的定义：

```
SWIGINTERN int Swig_var_ModState_set(PyObject *_val) {
  {
    void *argp = 0;
    int res = SWIG_ConvertPtr(_val, &argp, SWIGTYPE_p_MY_API,  0  | 0);
    if (!SWIG_IsOK(res)) {
      SWIG_exception_fail(SWIG_ArgError(res), "in variable '""ModState""' of type      '""MY_API""'");
    }
    if (!argp) {
      SWIG_exception_fail(SWIG_ValueError, "invalid null reference " "in variable    '""ModState""' of type '""MY_API""'");
    } else {
      MY_API * temp;
      temp  = reinterpret_cast< MY_API * >(argp);
      ModState = *temp;
      if (SWIG_IsNewObj(res)) delete temp;
    }
  }
  return 0;
fail:
  return 1;
} 
```

Visual Studio 2010 抱怨每个代码块都有一个错误。该错误基于`temp`var：

```
2>c:\svn\myapi\myapi_wrap.cxx(3109): error C2071: 'temp' : illegal storage class 
```

我试图将此变量的全局声明作为 int 添加到 swig 生成的 _wrap.cxx 文件中，但它不起作用。（显然是一种天真的方法......）。

有没有人知道我需要做什么来避免这个错误？

提前致谢！

# apache-camel - 使用拦截的骆驼测试

> ID：13646956
> 
> 赞同：2
> 
> 时间：2012-11-30T14:18:23.643
> 
> 标签：apache-camel

我正在尝试拦截一条消息以跳过 Http 请求并继续我的路线。下面是您可以复制/粘贴来试用的课程。

使用 camel-test、camel-core、camel-http4 2.10.2 和 httpclient-osgi、httpcore-osgi 4.2.2

这是代码：

```
import org.apache.camel.Exchange;
import org.apache.camel.Processor;
import org.apache.camel.builder.AdviceWithRouteBuilder;
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.test.junit4.CamelTestSupport;
import org.junit.Test;

/**
 * Created with IntelliJ IDEA.
 * User: lleclerc
 * Date: 12-11-28
 * Time: 16:34
 * To change this template use File | Settings | File Templates.
 */
public class IsUseAdviceWithJUnit4Test extends CamelTestSupport {

    private String providerEndPointURI = "http://stackoverflow.com";
    private String timerEndPointURI = "timer://myTimer";
    private String mockEndPointURI = "mock:myMock";
    private String directEndPointURI = "direct:myDirect";
    private boolean messageIntercepted;

    @Override
    protected RouteBuilder createRouteBuilder() throws Exception {

        return new RouteBuilder() {
            @Override
            public void configure() throws Exception {

                from(timerEndPointURI + "?fixedRate=true&delay=1000&period=1000")
                        .to(providerEndPointURI + "?throwExceptionOnFailure=false")
                        .to(mockEndPointURI);
            }
        };
    }

    @Test
    public void testIsUseAdviceWith() throws Exception {

        messageIntercepted = false;

        context.getRouteDefinitions().get(0).adviceWith(context, new AdviceWithRouteBuilder() {
            @Override
            public void configure() throws Exception {

                replaceFromWith(directEndPointURI);

                mockEndpoints();

                interceptSendToEndpoint(providerEndPointURI)
                        .skipSendToOriginalEndpoint()
                        .process(new Processor() {
                            @Override
                            public void process(Exchange exchange) throws Exception {
                                messageIntercepted = true;
                                System.out.println("INTERCEPTED");
                            }
                        });
            }
        });

        // we must manually start when we are done with all the advice with
        context.start();

        getMockEndpoint(mockEndPointURI).expectedMessageCount(1);

        template.sendBody(directEndPointURI, "a trigger");

        assertMockEndpointsSatisfied();

        assertEquals(true, messageIntercepted);

        assertNotNull(context.hasEndpoint(directEndPointURI));
        assertNotNull(context.hasEndpoint("mock:" + directEndPointURI));

        assertNotNull(context.hasEndpoint(mockEndPointURI));
    }

    @Override
    public boolean isUseAdviceWith() {
        return true;
    }

    @Override
    public boolean isUseRouteBuilder() {
        return true;
    }
} 
```

感谢您的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T14:48:06.557

camel-http4 内部存在错误。

[http://camel.465427.n5.nabble.com/Found-a-bug-with-camel-http4-td5723733.html](http://camel.465427.n5.nabble.com/Found-a-bug-with-camel-http4-td5723733.html)

[http://camel.465427.n5.nabble.com/Test-Intercept-with-adviceWith-and-http-td5723473.html](http://camel.465427.n5.nabble.com/Test-Intercept-with-adviceWith-and-http-td5723473.html)

# selenium - Selenium IDE：如何使用 XPath 对动态 id 进行模式检查

> ID：13646959
> 
> 赞同：2
> 
> 时间：2012-11-30T14:18:29.883
> 
> 标签：selenium, pattern-matching, selenium-ide

在我的网站上有一个最近上传的图片部分。在此部分中，所有最近上传的图像都是随机显示的

使用firepath我追踪了那个位置的xpath

```
//div[@id='udtkbdf50']/a/div[2]/div 
```

所以每次页面刷新时这个 `@id='udtkbdf50'`值都会改变，只有一件事是共同的，那就是这个值总是以 `u`

所以我想使用模式匹配技术[正则表达式或 Globbing Patterns]

`@id='udtkbdf50'` 对于这个值和路径的其余部分，ie `/a/div[2]/div`将保持不变。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T14:25:34.577

`//div[contains(@id,'u')]/a/div[2]/div`将工作。

**更新：**

`//div[starts-with(@id,'u')]/a/div[2]/div`会更具体。

最好的。

# iphone - iOS - 从 MFMailComposeViewController 中删除 UIImageView

> ID：13646960
> 
> 赞同：0
> 
> 时间：2012-11-30T14:18:35.143
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uinavigationcontroller

我`ViewController`有一个`navigationBar`with Promt 并且在它之上我添加了一个自定义图像：

```
- (void)changeNavBar
{
    UIImage *image = [UIImage imageNamed: @"logo_home.png"];
    imageView = [[UIImageView alloc] initWithImage:image];
    imageView.contentMode = UIViewContentModeLeft;

    [[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"logo_home.png"] forBarMetrics:UIBarMetricsDefault];

    imageView.frame = CGRectMake(0, 0, 320, 70);

    [self.navigationController.navigationBar insertSubview:imageView atIndex:0];

    self.navigationController.navigationBar.backItem.backBarButtonItem.tintColor = [UIColor blackColor];
} 
```

但是当用户单击“发送电子邮件”按钮时，我`MFMailComposeViewController`会以模态方式创建并呈现它。

```
- (IBAction)emailPressed:(id)sender
{
    NSString *emailTitle = event.title;
    NSString *messageBody = [NSString stringWithFormat:@"%@ - %@", event.title, event.concertUrl.absoluteString];

    MFMailComposeViewController *mc = [[MFMailComposeViewController alloc] init];

    mc.mailComposeDelegate = self;
    NSLog(@"subviews: %d", mc.navigationBar.subviews.count);

    [mc setSubject:emailTitle];
    [mc setMessageBody:messageBody isHTML:NO];

    // Present mail view controller on screen
    [self presentModalViewController:mc animated:YES];
} 
```

`MFMailComposeViewController`的导航栏在没有提示的情况下自动调整为普通导航栏，但我以前 VC 中的自定义图像不会消失。如何删除它并将标准黑色样式设置为我的 navigationBar ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T14:52:14.663

您已经使用 UIAppearance 代理设置了背景图像，这将对应用程序中的每个导航栏产生影响。

改变

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"logo_home.png"] forBarMetrics:UIBarMetricsDefault]; 
```

和

```
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"logo_home.png"] forBarMetrics:UIBarMetricsDefault]; 
```

# php - php 中 mysql 查询的结果与 mysql 不同

> ID：13646963
> 
> 赞同：0
> 
> 时间：2012-11-30T14:19:12.013
> 
> 标签：php, mysql, sql, database, select

您好，我很难意识到出了什么问题..

当我在 mysql 中运行此语句时..

```
select brand_id,   brand_name,   
max(case when group_row_number = 1 then linecode end) Code1,   
max(case when group_row_number = 2 then linecode end) Code2,   
max(case when group_row_number = 3 then linecode end) Code3,   
max(case when group_row_number = 4 then linecode end) Code4,   
max(case when group_row_number = 5 then linecode end) Code5,   
max(case when group_row_number = 6 then linecode end) Code6,   
max(case when group_row_number = 7 then linecode end) Code7,   
max(case when group_row_number = 8 then linecode end) Code8,   
max(case when group_row_number = 9 then linecode end) Code9,   
max(case when group_row_number = 10 then linecode end) Code10 
from (   select brand_id,     brand_name,     linecode,     
@num := if(@brand_id = `brand_id` AND @brand_name = `brand_name`, @num + 1, 1) as 
group_row_number,     @brand_id := `brand_id` as dummy,   
@brand_name := `brand_name` as linedummy   from linecodes_temp ) 
src group by brand_id, brand_name order by if(linecode = '' or linecode is null,1,0), 
brand_name ASC; 
```

我收到了我想要的结果。

```
 +----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| brand_id | brand_name                                         | Code1 | Code2 | Code3 | Code4 | Code5 | Code6 | Code7 | Code8 | Code9 | Code10 |
+----------+----------------------------------------------------+-------+-------+-------+-------+-------+-------+-------+-------+-------+--------+
| DPQT     | 1-800 Tow Truck                                    | DCF   | DCA   | AAA   | DDD   | DER   | NULL  | NULL  | NULL  | NULL  | NULL   |
| BLGR     | 1-800-Radiator                                     | Curt  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| BGVM     | 100+ Manufacturing/Coyote                          | ASC   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| DPQS     | 10C Technologies Inc                               | ASQ   | AQW   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| FDJG     | 2 Cool AirVents                                    | CAS   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| DWFD     | 31 Incorporated                                    | ASD   | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   |
| BBBB     | 3M                                                 | snoop | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL  | NULL   | 
```

太棒了。

但是当我转身并在 php.ini 中调用它时。

```
$result = mysql_query("select brand_id,   brand_name,   max(case when group_row_number = 1 then linecode end) Code1,   max(case when group_row_number = 2 then linecode end) Code2,   max(case when group_row_number = 3 then linecode end) Code3,   max(case when group_row_number = 4 then linecode end) Code4,   max(case when group_row_number = 5 then linecode end) Code5,   max(case when group_row_number = 6 then linecode end) Code6,   max(case when group_row_number = 7 then linecode end) Code7,   max(case when group_row_number = 8 then linecode end) Code8,   max(case when group_row_number = 9 then linecode end) Code9,   max(case when group_row_number = 10 then linecode end) Code10 from (   select brand_id,     brand_name,     linecode,      @num := if(@brand_id = `brand_id` AND @brand_name = `brand_name`, @num + 1, 1) as group_row_number,     @brand_id := `brand_id` as dummy,     @brand_name := `brand_name` as linedummy   from linecodes_temp ) src group by brand_id, brand_name order by if(linecode = '' or linecode is null,1,0), brand_name ASC",$dbh); 
```

并做一个

```
while($row = mysql_fetch_assoc($result)) { 
```

并通过桌子

我得到的结果是

```
 brand_id       brand_name                  Code1   Code2 Code3 Code4 Code5 to Code 10
 DPQT           1-800 Tow Truck             DER         
 BLGR           1-800-Radiator              Curt            
 BGVM           100+ Manufacturing/Coyote   ASC         
 DPQS           10C Technologies Inc        ASQ         
 FDJG           2 Cool AirVents             CAS         
 DWFD           31 Incorporated             ASD         
 BBBB           3M                          snoop 
```

当我执行 var_dump($row) 时，上面的 php 查询的结果会显示出来，所以我知道我在这方面没有做错任何事情

我在 mysql 和 php 中使用完全相同的查询我假设在调用我缺少的 mysql_query 时 php 中存在语法差异

如果有人可以提供帮助，我将不胜感激

感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:53:55.007

在您选择的列中包含该`group_row_number`列并回显它们，以查看这是否真的按预期工作。

另一个区别可能在于`linecodes_temp`，这取决于在普通 MySQL 或 PHP 版本中是如何设置的。

我将您的子选择重写为

```
$sql0 = 'set @num := 0';
$result = mysql_query($sql0, $dbh);
// error handling
$sql = 'select brand_id, brand_name, @num := @num + 1 as group_row_number from linecodes_temp';
$result = mysql_query($sql, $dbh);
// error handling
while ($row = mysql_fetch_assoc($result)) {
    // process result set
} 
```

现在 group_row_number 按预期增加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T15:03:35.043

您拥有的最内在的预查询

```
 @brand_name := `brand_name` as linedummy   
       from 
          linecodes_temp ) src 
```

您需要在此处添加您的 ORDER BY 子句

```
 @brand_name := `brand_name` as linedummy   
       from 
          linecodes_temp
       order by
          `brand_id`, `brand_name` ) src 
```

如果您不这样做，内部查询会以原始顺序读取数据，这可能会使它们从 ID 1、2、2、1、3、1、2、1、2 等交错排列。每次切换回来时，它都会重置您的counter 回到 1，从而覆盖您之前的 Code 1 设置。

您甚至可能需要在内部 order by 之后将计数器添加到 OUTER 结果中。

# android - 内存不足加载图像视图

> ID：13646965
> 
> 赞同：4
> 
> 时间：2012-11-30T14:19:15.813
> 
> 标签：android, imageview

我有一个滚动视图，其中包含通过 AsyncTask 加载的图像的小缩略图，并将图像 URL 抛出到 imageView。

它们是动态添加的，然后在顶部是一个主 imageView，其中包含您单击的缩略图的图像。

在缩略图中有大约 10 多张图像之前，一切都运行良好……

我正在通过与缩略图相同的方式加载 mainImage url，因此当他们单击缩略图中的图像时，它会将其加载到顶部。

我在方法本身中回收位图，但它似乎内存不足并在加载超过 10 个图像时崩溃（缩略图加载正常，但当我单击加载主图像时崩溃）

任何帮助表示赞赏

这是我正在使用加载图像的代码（缩略图+主）：

```
 private class DownloadImageTask extends AsyncTask<String, Void, Bitmap> {
      ImageView bmImage;

      public DownloadImageTask(ImageView bmImage) {
          this.bmImage = bmImage;
      }

  protected Bitmap doInBackground(String... urls) {
      String urldisplay = urls[0];
      Bitmap mIcon11 = null;
      try {
        InputStream in = new java.net.URL(urldisplay).openStream();
        mIcon11 = BitmapFactory.decodeStream(in);
      } catch (Exception e) {
          Log.e("Error", e.getMessage());
          e.printStackTrace();
      }
      return mIcon11;
  }

  protected void onPostExecute(Bitmap result) {
      bmImage.setImageBitmap(result);
  }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:23:33.890

只需在你的图像上实现这个......它会将你的图像缩小 4 倍

```
public static Bitmap getImage(byte[] image) {
        BitmapFactory.Options config = new BitmapFactory.Options();
        config.inPreferredConfig = Bitmap.Config.RGB_565;
        config.inSampleSize = 4;
        return BitmapFactory.decodeByteArray(image, 0, image.length,config);

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:38:20.083

您应该阅读以下两个 Android 官方教程。他们将教您如何有效地加载大型位图，并提供我们在生产应用程序中使用的工作代码示例

[有效地显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)

[有效加载大型位图](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-30T14:39:39.563

您没有关闭输入流。因此，当图像 url 执行创建的输入流对象时，这些对象总是很昂贵并导致您出现 OutofMemoryError。在 catch 块之后添加以下代码。

```
in.close();
in = null; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-30T14:49:10.883

您不应该为此使用 ScrollView。您应该使用 ListView。当您使用 ScrollView（其中带有 LinearLayout 或类似的东西）时，列表中的所有元素（无论它有多大）都将尝试立即加载。尝试使用 ListView （正是出于这个原因，它只在内存中加载可见行的 ui 元素）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-19T08:09:16.920

您可以使用 android:largeHeap="true" 请求更大的堆大小

[回答](https://stackoverflow.com/a/11275719/483988)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-01T08:25:12.590

我用这个。。

```
Options opt = new Options();
opt.inPurgeable = true;
opt.inInputShareable = true;
opt.inPreferredConfig = Bitmap.Config.RGB_565; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-30T14:23:28.647

您可能必须为位图使用某种缓存策略，尝试查看[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)库，它非常适合您的需要

仅当您确定不再使用位图时，才应自行回收位图。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-30T14:38:16.680

尝试将位图的大小调整为更小的尺寸（例如 1.5 的因子：width=widt*1.5），然后在您的视图中拉伸（适合 xy 或其他）。由于您决定的因素，它会降低图像的质量。这是一种快速肮脏的方式。也像 Niun Goia 提到的那样制作位图 rgb 效果很好。

# css - 使用 web (@font-face) 字体

> ID：13646966
> 
> 赞同：3
> 
> 时间：2012-11-30T14:19:23.027
> 
> 标签：css, fonts, font-face, webfonts

我有一个基本问题，可能更多地涉及设计领域，但它仍然是一个网络编程。

假设我需要在我的 Web 应用程序中使用 Palatino-Linotype 字体。如何更好地将其嵌入到我的网页应用程序中？

我知道的方法：
1) 去 font.com 购买各种 palatino-linotype: normal, bold, italic, italic-bold。4个不同的文件。
2）然后我通过字体样式加载字体

```
@font-face {
    font-family: "Palatino-Linotype-normal";
    src: "..."
}
@font-face {
    font-family: "Palatino-Linotype-italic";
    src: "..."
} 
```

3) AI 有 4 种不同的字体，在 HTML 标记中，我需要明确设置元素的字体，使其变为粗体、斜体或斜体粗体（这是我最不喜欢的）。

问题：
1）是使用自定义网络字体的工作流程吗？
2）也许有一种方法可以将此字体视为普通字体，即在父元素上仅设置一种字体，并且仅用于内部设置 style="font-style: italic;" 如果我希望它们是斜体的。
3）关于性能的问题，网络字体渲染速度与普通字体的渲染速度有什么不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T17:04:25.630

浏览器通常支持的逻辑方式是在单独的规则中声明每种字体，如

```
@font-face {
    font-family: foobar;
    src: url("foobar-regular.woff");
}
@font-face {
    font-family: foobar;
    font-style: italic;
    src: url("foobar-italic.woff");
} 
```

然后通过,和其他导致默认呈现斜体的标记直接或间接地声明`font-family: foobar`和使用。`font-style: italic``<i>``<em>`

我以一种明显的方式简化了代码；自然，您通常应该使字体以浏览器识别的不同格式提供。

像 FontSquirrel 这样的服务会生成不同的代码，但修复它们生成的代码或从头开始编写代码相当简单。

我故意使用“foobar”而不是“Palatino Linotype”，因为后者在法律上不能用作可下载字体；至少在证明并非如此之前，这是假定的。（网络上有许多非法分发或销售字体的网站。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T14:22:32.733

查看 Fontsquirrel [http://www.fontsquirrel.com/](http://www.fontsquirrel.com/)它帮助我生成兼容多种浏览器的字体和 css:s。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-30T14:28:18.650

如果您只使用 Palatino Linotype Normal，然后在 CSS 中将其更改为粗体，您将不会得到与 Palatino Linotype Bold 相同的结果。这里的事情是浏览器渲染将用于实现这一点，它会很糟糕。我的意思是，对我来说，可能对你来说，它看起来是一样的——但对设计师来说却不是 :)

此外，一种字体比普通字体、粗体和斜体要多得多。有浅色、半浅色、黑色等。设计师往往会经常使用这些。

所以总的来说，对于第一个和第二个问题：不同的风格使用不同的字体，不同的风格没有办法使用不同的字体，需要另一个字体族指示。

至于第三个：性能是嵌入字体的问题。但主要不是因为渲染，而是因为字体文件下载量很大。所以一定要缓存它们并只使用那些需要的。例如，上一个答案中的[http://www.fontsquirrel.com/](http://www.fontsquirrel.com/)实际上默认添加了太多已下载的文件，因此请进行一些研究以了解不同的格式以及您需要嵌入的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T11:34:06.770

您在 Web 应用程序中使用 Palatino-Linotype 字体，使用来自 google 的 Web 字体。 [https://developers.google.com/webfonts/docs/webfont_loader](https://developers.google.com/webfonts/docs/webfont_loader)

Web Font Loader 是一个 JavaScript 库，与 Google Web Fonts API 相比，它可以让您更好地控制字体加载。Web Font Loader 还允许您使用多个 Web 字体提供程序。它是由 Google 和 Type kit 共同开发的。

更多信息请点击此链接**到我的博客**： [http ://webtemplatesmonster.blogspot.in/2013/02/how-to-use-font-face.html](http://webtemplatesmonster.blogspot.in/2013/02/how-to-use-font-face.html)

```
 @font-face {   font-family: 'Awesome Font';   src:
       url('awesome-font.eot');  /* IE9 Compat Modes */   src:
       url('awesome-font.eot?#iefix') format('embedded-opentype'), /*
       IE6-IE8 */
                url('awesome-font.woff') format('woff'), /* Modern Browsers */
                url('awesome-font.ttf')  format('truetype'), /* Safari, Android, iOS */
                url('awesome-font.svg#svgFontName') format('svg'); /* Legacy iOS */  } 
```

# c#-4.0 - 在配置中模拟多个数据库的设置

> ID：13646969
> 
> 赞同：0
> 
> 时间：2012-11-30T14:19:35.453
> 
> 标签：c#-4.0, app-config, configuration-files, identity, impersonation

我有一个连接到两个不同 SQL 数据库的控制台应用程序。我在配置文件中使用“模拟”标签来强制应用程序以“APP_USER”身份登录。APP_USER 帐户使用 Windows 身份验证并已在两个数据库中授予权限。

第一个数据库连接工作正常，但第二个数据库连接失败，因为它试图以我没有访问权限的帐户登录。

```
System.Data.SqlClient.SqlException: Login failed for user 'DOMAIN\CURRENT_USER'. 
```

我需要在配置中进行哪些更改才能使应用程序以另一个用户身份登录到两个数据库？

```
<configuration>
  <connectionStrings>
    <add name="Connection1" connectionString="metadata=res://*/Models.Model1.csdl|res://*/Models.Model1.ssdl|res://*/Models.Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=DB1;initial catalog=DBcat1;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    <add name="Connection2" connectionString="metadata=res://*/Models.Model2.csdl|res://*/Models.Model2.ssdl|res://*/Models.Model2.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=DB2;initial catalog=DBcat2;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>
  <system.web>
    <identity impersonate="true" userName="DOMAIN\APP_USER" password="password"/>
  </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T18:37:10.463

显然配置设置路由只能在 asp.net 项目中使用。为了在控制台应用程序中完成此操作，您必须编写代码来利用 advapi32.dll 库中的 LogonUser。

类似的问题：[StackOverflow：来自 C# 的 Windows 模拟](https://stackoverflow.com/questions/559719/windows-impersonation-from-c-sharp)

我的最终代码基于以下项目：[代码项目：用于模拟用户的小型 C# 类](http://www.codeproject.com/Articles/4051/Windows-Impersonation-using-C)

现在一切似乎都运行良好。

# c# - MonoTouch 和 Objc @Synchronized 和 makeObjectsPerformSelector

> ID：13646970
> 
> 赞同：2
> 
> 时间：2012-11-30T14:19:36.110
> 
> 标签：c#, objective-c, xamarin.ios, objective-c-blocks

`Objective-C`我只是将一些代码移植到，`MonoTouch`但我被困在这里

```
UIColor *color = ARandomColor(); // ARandomColor Returns a Random UIColor ;)
@synchronized(self) {
    [_annotationDict enumerateKeysAndObjectsUsingBlock:^(NSNumber *page, NSArray *annotations, BOOL *stop) {
        [annotations makeObjectsPerformSelector:@selector(setColor:) withObject:color];
        [self.providerDelegate updateAnnotations:annotations originalAnnotations:nil animated:YES];
    }];
} 
```

什么是`MonoTouch`等价于`@synchronized`and `enumerateKeysAndObjectsUsingBlock`？

亚历克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-30T14:40:10.173

`@synchronized(self)`应该翻译成`lock(this)`c#。

我相信`-enumerateKeysAndObjectsUsingBlock:`或多或少只是一个 foreach 或 for 循环，所以你只需要做类似的事情

```
foreach (Type t in _annotationDict) {

} 
```

# java - 如何在黑莓 Eclipse 中创建 jar

> ID：13646971
> 
> 赞同：0
> 
> 时间：2012-11-30T14:19:36.310
> 
> 标签：java, blackberry, jar

我们如何创建一个完整的包到 jar 文件，以便我们可以在另一个应用程序中使用特定包的所有功能。我正在做的是，我正在选择所有java文件（在特定包中）并右键单击并选择导出选项，然后选择jar并按照其他步骤..最后我得到jar文件..但这不起作用我的黑莓项目..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-30T23:42:55.010

你可以很容易地 将一个 BlackBerry 项目变成一个**库项目。**

如果您使用的是 Eclipse 插件，那么您的 BlackBerry 项目应该有一个 BlackBerry_App_Descriptor.xml 文件。在 Eclipse 中打开它，在**Application**选项卡上，选择**Application type**然后选择**Library**。

如果您手动编辑该 xml 文件，您将拥有如下内容：

```
<Properties ModelVersion="1.1.2">
  <General Title="" Version="1.0.0" Vendor="BlackBerry Developer" Description=""/>
  <Application Type="Library" 
               MainMIDletName="" MainArgs="" HomeScreenPosition="0" StartupTier="7" IsSystemModule="true" IsAutostartup="false"/> 
```

如果您使用的是旧的 JDE 工具集，[这里有一些说明](http://blackberry-tips-bikas.blogspot.com/2010/02/how-to-create-library-jar-file-and-use.html)。

你的库项目不应该有一个`public static void main(String[] args)`方法，就像一个普通的 App 项目。

# groovy - 使用 Groovy 解析 XML：解析 XML 文件时如何保留 CDATA

> ID：13646974
> 
> 赞同：3
> 
> 时间：2012-11-30T14:19:43.437
> 
> 标签：groovy, xml-parsing, cdata

使用 Groovy 2.0.5 JVM 1.6.0_31，我创建了一个将现有 XML 文件作为输入的脚本

```
def root = new XmlParser().parse(new File('filename')) 
```

我解析文件并替换像这样的某些属性

```
root.Settings.Setting.each {
if (it.'@NAME' =~ 'CASEID_SEQUENCE_SIZE') {
   it.'@VALUE' = '100' 
```

然后最后将更改写入这样的新文件

```
def outputfile = new File( levelConfig.RESULTFILE )
new XmlNodePrinter(new PrintWriter(outputfile)).print(root) 
```

这一切都很好，没问题，除非XML有CDATA，像这样

```
<HandlerURL>
   <![CDATA[admin/MainWindow.jsp]]>
</HandlerURL> 
```

结果是

```
<HandlerURL>
    admin/MainWindow.jsp
</HandlerURL> 
```

### 问题是

如何让我的脚本不对 CDATA 执行任何操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:13:36.517

发现你可以这样做：

```
import groovy.xml.*
import groovy.xml.dom.DOMCategory

def xml = '''<root>
            |  <Settings>
            |    <Setting name="CASEID_SEQUENCE_SIZE">
            |      <HandlerURL>
            |        <![CDATA[ admin/MainWindow.jsp ]]>
            |      </HandlerURL>
            |    </Setting>
            |    <Setting name="SOMETHING_ELSE">
            |      <HandlerURL>
            |        <![CDATA[ admin/MainWindow.jsp ]]>
            |      </HandlerURL>
            |    </Setting>
            |  </Settings>
            |</root>'''.stripMargin()

def document = DOMBuilder.parse( new StringReader( xml ) )
def root = document.documentElement

use(DOMCategory) {
  root.Settings.Setting.each {
    if( it.'@name' == 'CASEID_SEQUENCE_SIZE' ) {
      it[ '@value' ] = 100
    }
  }
}

def result = XmlUtil.serialize( root )

println result 
```

要获得输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
  <Settings>
    <Setting name="CASEID_SEQUENCE_SIZE" value="100">
      <HandlerURL>
        <![CDATA[ admin/MainWindow.jsp ]]>
      </HandlerURL>
    </Setting>
    <Setting name="SOMETHING_ELSE">
      <HandlerURL>
        <![CDATA[ admin/MainWindow.jsp ]]>
      </HandlerURL>
    </Setting>
  </Settings>
</root> 
```

# jquery - 淘汰赛模型 + jQuery UI 范围滑块

> ID：13646978
> 
> 赞同：0
> 
> 时间：2012-11-30T14:19:49.277
> 
> 标签：jquery, jquery-ui, knockout.js

我正在使用 Knockout 模型，我希望使用 jQuery UI 范围滑块更新此模型中的值。考虑以下示例：

模型：

```
var ViewModel = function () {
    var self = this;
    self.MinTerm = ko.observable();
    self.MaxTerm = ko.observable();
}

ko.applyBindings(new ViewModel()); 
```

现在，一个 jQuery UI 范围滑块应该更新这两个值。这个（非常丑陋的）解决方案接近了，我的 ViewModel 中的值正在更新，但不知何故这并没有反映在绑定到这些值的控件中，例如：

HTML

```
<div id="sliderTerms"></div>
<span data-bind="text: MinTerm"></span>
<span data-bind="text: MaxTerm"></span> 
```

脚本：

```
 $("#sliderTerms").slider({
        range: true,
        min: 6,
        max: 120,
        values: [6, 120],
        step: 1,
        slide: function (event, ui) {
            ViewModel.MinTerm = ui.values[0];
            ViewModel.MaxTerm = ui.values[1];
        }
    }); 
```

现在，如果我可以绑定到像这样的自定义 bindingHandler 那就太好了，它非常适合将滑块绑定到我的 KO 模型中的奇异值：

```
ko.bindingHandlers.slider = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var options = allBindingsAccessor().sliderOptions || {};
        $(element).slider(options);
        ko.utils.registerEventHandler(element, "slidechange", function (event, ui) {
            var observable = valueAccessor();
            observable(ui.value);
        });
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).slider("destroy");
        });
        ko.utils.registerEventHandler(element, "slide", function (event, ui) {
            var observable = valueAccessor();
            observable(ui.value);
        });
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        if (isNaN(value)) value = 0;
        $(element).slider("value", value);

    }
}; 
```

这就是我卡住的地方。例如，是否可以分配一个 valueAccessors 数组，这样我就可以执行以下操作：

```
<div id="sliderTerms" data-bind="rangeSlider: [MinTerm, MaxTerm], sliderOptions: {min: 6, max: 120, range: true, step: 1}"></div> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T15:50:54.370

我根据你的写了我自己的，它是一个快速的模型，所以它可能有错误

[http://jsfiddle.net/N9uwx/](http://jsfiddle.net/N9uwx/)

```
ko.bindingHandlers.slider = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var options = allBindingsAccessor().sliderOptions || {};
        var observable = valueAccessor();

        if(observable().splice) {
            options.range = true;        
        }        

        options.slide = function(e, ui) {
            observable(ui.values ? ui.values : ui.value);
        };

        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).slider("destroy");
        });

        $(element).slider(options);
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
        $(element).slider(value.slice ? "values" : "value", value);

    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T10:57:39.087

谢谢！您的代码启发了我编写这个 bindingHandler：

```
ko.bindingHandlers.rangeSlider = {
    init: function (element, valueAccessor, allBindingsAccessor) {
        var options = allBindingsAccessor().sliderOptions || {};
        var observable = valueAccessor();

        ko.utils.registerEventHandler(element, "slidechange", function (event, ui) {
            observable[0](ui.values[0]);
            observable[1](ui.values[1]);
        });
        ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
            $(element).slider("destroy");
        });
        ko.utils.registerEventHandler(element, "slide", function (event, ui) {
            observable[0](ui.values[0]);
            observable[1](ui.values[1]);
        });

        $(element).slider(options);
    },
    update: function (element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());
         if(value instanceof Array)
        {
            var value1= ko.utils.unwrapObservable(value[0]);
            var value2= ko.utils.unwrapObservable(value[1]);
            if(value1)
            {
                value = [value1, value2];
            }
            else value = 0;
        }
        else if (isNaN(value)) value = 0;
        $(element).slider(value.slice ? "values" : "value", value);
    }
}; 
```

现在我可以将 rangeSlider 绑定到我的 Knockout 模型，如下所示：

```
<div id="sliderTerms" data-bind="rangeSlider: [MinTerm, MaxTerm], sliderOptions: {min: 6, max: 120, range: true, step: 1, values: [6,120]}"></div> 
```

这有点臭，因为我认为 values[i] 应该绑定到 valueAccessor[i] 但这对我来说已经足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-22T18:01:58.080

对于@Nico Beemster 在他自己的代码中发现的错误，我们需要“更新” update: 部分，如下所示：

```
 update: function (element, valueAccessor, allBindingsAccessor) {
            console.log("update fired");
            var value = ko.utils.unwrapObservable(valueAccessor());
              if(value instanceof Array)
        {
            var value1= ko.utils.unwrapObservable(value[0]);
            var value2= ko.utils.unwrapObservable(value[1]);
            if(value1)
            {
                value = [value1, value2];
            }
            else value = 0;
        }
        else if (isNaN(value)) value = 0;
            $(element).slider(value.slice ? "values" : "value", value);
             $(element).slider("option", allBindingsAccessor().sliderOptions);
        } 
```

[这](http://jsfiddle.net/adr8G/12/)是更新的小提琴。如果您想更新最大和最小范围元素（如果它们是可观察元素）。

# java - 使用 SuperCSV 一次性验证每个字段

> ID：13646982
> 
> 赞同：10
> 
> 时间：2012-11-30T14:20:18.707
> 
> 标签：java, csv, supercsv

我正在尝试使用 SuperCSV 将大量行（约 200 万行）从数据库写入 CSV 文件。我需要在编写每个单元格时对其执行验证，并且内置的 CellProcessors 做得非常好。我想捕获 CellProcessors 抛出的所有异常，以便我可以返回源数据并进行更改。

问题是当单行中有多个错误时（例如第一个值超出范围，第二个值为 null 但不应该），只有第一个 CellProcessor 会执行，所以我只会看到一个的错误。我想一次处理整个文件，并在它的末尾有一套完整的异常。

这是我正在尝试的方法：

```
for (Row row : rows) {
    try {
        csvBeanWriter.write(row, HEADER_MAPPINGS, CELL_PROCESSORS);
    } catch (SuperCsvCellProcessorException e) {
        log(e);
    }
} 
```

我怎样才能做到这一点？谢谢！

编辑：这是我编写的类似于 Hound Dog 的代码，以防它帮助任何人：

```
import java.util.List;

import org.supercsv.cellprocessor.CellProcessorAdaptor;
import org.supercsv.cellprocessor.ift.CellProcessor;
import org.supercsv.exception.SuperCsvCellProcessorException;
import org.supercsv.util.CsvContext;

public class ExceptionCapturingCellProcessor extends CellProcessorAdaptor {

    private final List<Exception> exceptions;

    private final CellProcessor current;

    public ExceptionCapturingCellProcessor(CellProcessor current, CellProcessor next, List<Exception> exceptions) {
        super(next);
        this.exceptions = exceptions;
        this.current = current;
    }

    @Override
    public Object execute(Object value, CsvContext context) {
        // Check input is not null
        try {
            validateInputNotNull(value, context);
        } catch (SuperCsvCellProcessorException e) {
            exceptions.add(e);
        }

        // Execute wrapped CellProcessor
        try {
            current.execute(value, context);
        } catch (SuperCsvCellProcessorException e) {
            exceptions.add(e);
        }

        return next.execute(value, context);
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-01T10:23:45.563

我建议[编写一个自定义 CellProcessor](http://supercsv.sourceforge.net/examples_new_cell_processor.html)来实现这一点。可以将以下处理器放置在每个 CellProcessor 链的开头——它将简单地委托给链接在它之后的处理器，并抑制任何单元处理异常。

```
package example;

import java.util.ArrayList;
import java.util.List;
import org.supercsv.cellprocessor.CellProcessorAdaptor;
import org.supercsv.cellprocessor.ift.CellProcessor;
import org.supercsv.exception.SuperCsvCellProcessorException;
import org.supercsv.util.CsvContext;

public class SuppressException extends CellProcessorAdaptor {

    public static List<SuperCsvCellProcessorException> SUPPRESSED_EXCEPTIONS = 
            new ArrayList<SuperCsvCellProcessorException>();

    public SuppressException(CellProcessor next) {
        super(next);
    }

    public Object execute(Object value, CsvContext context) {
        try {
            // attempt to execute the next processor
            return next.execute(value, context);

        } catch (SuperCsvCellProcessorException e) {
            // save the exception
            SUPPRESSED_EXCEPTIONS.add(e);

            // and suppress it (null is written as "")
            return null;
        }
    }
} 
```

它在行动中：

```
package example;

import java.io.StringWriter;
import java.util.Arrays;
import java.util.List;

import org.supercsv.cellprocessor.constraint.NotNull;
import org.supercsv.cellprocessor.constraint.StrMinMax;
import org.supercsv.cellprocessor.ift.CellProcessor;
import org.supercsv.exception.SuperCsvCellProcessorException;
import org.supercsv.io.CsvBeanWriter;
import org.supercsv.io.ICsvBeanWriter;
import org.supercsv.prefs.CsvPreference;

public class TestSuppressExceptions {

    private static final CellProcessor[] PROCESSORS = {
            new SuppressException(new StrMinMax(0, 4)),
            new SuppressException(new NotNull()) };

    private static final String[] HEADER = { "name", "age" };

    public static void main(String[] args) throws Exception {

        final StringWriter stringWriter = new StringWriter();
        ICsvBeanWriter beanWriter = null;
        try {
            beanWriter = new CsvBeanWriter(stringWriter,
                    CsvPreference.STANDARD_PREFERENCE);

            beanWriter.writeHeader(HEADER);

            // set up the data
            Person valid = new Person("Rick", 43);
            Person nullAge = new Person("Lori", null);
            Person totallyInvalid = new Person("Shane", null);
            Person valid2 = new Person("Carl", 12);
            List<Person> people = Arrays.asList(valid, nullAge, totallyInvalid,
                    valid2);

            for (Person person : people) {
                beanWriter.write(person, HEADER, PROCESSORS);

                if (!SuppressException.SUPPRESSED_EXCEPTIONS.isEmpty()) {
                    System.out.println("Suppressed exceptions for row "
                                        + beanWriter.getRowNumber() + ":");
                    for (SuperCsvCellProcessorException e :
                                        SuppressException.SUPPRESSED_EXCEPTIONS) {
                        System.out.println(e);
                    }
                    // clear ready for next row
                    SuppressException.SUPPRESSED_EXCEPTIONS.clear();
                }

            }

        } finally {
            beanWriter.close();
        }

        // CSV will have empty columns for invalid data
        System.out.println(stringWriter);

    }

} 
```

这是抑制的异常输出（第 4 行有两个异常，每列一个）：

```
Suppressed exceptions for row 3:
org.supercsv.exception.SuperCsvConstraintViolationException: null value 
encountered processor=org.supercsv.cellprocessor.constraint.NotNull
context={lineNo=3, rowNo=3, columnNo=2, rowSource=[Lori, null]}
Suppressed exceptions for row 4:
org.supercsv.exception.SuperCsvConstraintViolationException: the length (5) 
of value 'Shane' does not lie between the min (0) and max (4) values (inclusive)
processor=org.supercsv.cellprocessor.constraint.StrMinMax
context={lineNo=4, rowNo=4, columnNo=2, rowSource=[Shane, null]}
org.supercsv.exception.SuperCsvConstraintViolationException: null value 
encountered processor=org.supercsv.cellprocessor.constraint.NotNull
context={lineNo=4, rowNo=4, columnNo=2, rowSource=[Shane, null]} 
```

和 CSV 输出

```
name,age
Rick,43
Lori,
,
Carl,12 
```

请注意无效值是如何写入的，`""`因为`SuppressException`处理器返回`null`了这些值（无论如何您都不会使用 CSV 输出，因为它无效！）。

# jquery - 如何递归移动相同类的DOM元素（jquery）

> ID：13646983
> 
> 赞同：0
> 
> 时间：2012-11-30T14:20:18.913
> 
> 标签：jquery

如何递归移动相同类的 DOM 元素？例如，我在 DOM 中有这段代码

```
<div class="container">
   <div class="mask">
        Content 1
    </div>
   <div class="thumbnail">
      some content here...
    </div>
</div>

<div class="container">
   <div class="mask">
        Content 2
    </div>
   <div class="thumbnail">
      some content here...
    </div>
</div>

<div class="container">
   <div class="mask">
        Content 3
    </div>
   <div class="thumbnail">
      some content here...
    </div>
</div> 
```

我想将掩码类的 div 移动到缩略图类的 div 中，以便代码变成这样：

```
<div class="container">
   <div class="thumbnail">
     <div class="mask">
          Content 1
      </div>
      some content here...
    </div>
</div>

<div class="container">
   <div class="thumbnail">
     <div class="mask">
         Content 2
      </div>
      some content here...
    </div>
</div>

<div class="container">
   <div class="thumbnail">
     <div class="mask">
          Content 3
      </div>
      some content here...
    </div>
</div> 
```

我正在尝试用 jquery 做到这一点：

```
$('.mask').prependTo('.thumbnail'); 
```

但没有成功。我在所有缩略图中复制了“内容 1”

有人请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:42:00.323

它是如此简单。尝试这个：

```
$(".mask").siblings(".thumbnail").prepend($(".mask")); 
```

即使 .mask 和 .thumbnail 之间的元素很少，也可以工作！

**更新：**

以防万一，您想为所有元素执行此操作：

```
$(".mask").each(function() {
  $(this).siblings(".thumbnail").prepend(this);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T14:21:55.467

这会将所有`.mask`s 移动到所有`.thumbnail`s 中。相反，用于`.each`单独处理每个元素：

```
$(".mask").each() {
  $(this).next(".thumbnail").prepend(this);
}); 
```

# java - 如何从 Netbeans 上的 Servlet 中的项目类路径获取图像

> ID：13646985
> 
> 赞同：3
> 
> 时间：2012-11-30T14:20:31.417
> 
> 标签：java, image, servlets

我`/header`在 Netbeans 的网页目录中创建了一个文件夹，并添加了一个名为`header.png`. 现在我想使用以下代码在 servlet 中访问此图像文件：

```
BufferedImage image = ImageIO.read(getClass().getResource(" /header/header.png")); 
```

但这没有发生，它给出了以下错误：

> java.lang.IllegalArgumentException：输入 == 空！

下面是我的项目的目录结构：

![在此处输入图像描述](../Images/958edfc331ae489c3f53bb9b5ea8748b.png)

这个错误是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:58:31.937

从类路径返回资源，而`Class#getResource()`不是从公共 Web 内容。

你需要[`ServletContext#getResource()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResource%28java.lang.String%29)，或者更好，[`getResourceAsStream()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getResourceAsStream%28java.lang.String%29)而不是。

```
BufferedImage image = ImageIO.read(getServletContext().getResourceAsStream("/header/header.png")); 
```

*（请注意，我也从路径中删除了尾随空格）*

请注意，有些用户可能会建议您使用`ServletContext#getRealPath()`，但在这种特殊情况下您不应该使用它，因为`null`当容器配置为将部署的 WAR 扩展到内存而不是本地磁盘文件系统时，可能会返回。

### 也可以看看：

*   [servletcontext.getRealPath("/") 是什么意思，我应该什么时候使用它](https://stackoverflow.com/questions/12160639/what-does-mean-in-the-function-servletcontext-getrealpath/12160863#12160863)

# asp.net - 加入 2 个选择查询，无论是否。记录

> ID：13646986
> 
> 赞同：1
> 
> 时间：2012-11-30T14:20:36.030
> 
> 标签：asp.net, sql-server-2005

我有 2 张桌子

```
table 1                               table 2
------------------                   ----------------------
description   paidamt                description recievedamt
ele. bill     200                    donation    1000
stationary    500                    fees        200
salary        1000 
```

我想要以下格式的结果（数据将根据日期排序）

```
description  debit credit
---------------------------
ele. bill    200
donation            1000
stationary   500
fees                200
salary       1000 
```

问题是，当我将 amt 设置为借方时，我无法将贷方列设置为空白，或者当我将 amt 设置为特定列的贷方时，我无法将借方列设置为空白。我正在处理以下查询....

```
WHEN Payment_Voucher_Master.grand_tot <> '0' 
  THEN '' 
  ELSE 'dgf'
END credit 
FROM Receipt_Voucher_Master,Payment_Voucher_Master
GROUP BY Payment_Voucher_Master.PaidTo,Payment_Voucher_Master.grand_tot

SELECT Receipt_Voucher_Master.PaidTo 
    AS description, Receipt_Voucher_Master.grand_total as credit,
CASE 
WHEN Receipt_Voucher_Master.grand_total <> '0'
  THEN '' 
  ELSE 'dgf'
END debit 
FROM Receipt_Voucher_Master,Payment_Voucher_Master
GROUP BY Receipt_Voucher_Master.PaidTo,Receipt_Voucher_Master.grand_total; 
```

我试图加入这两个查询

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T14:48:13.083

这应该对你有用，

```
SELECT 
    COALESCE(a.[description],b.[description]) AS [description],
    ISNULL(a.[paidamt],'') AS debit, 
    ISNULL(b.[recievedamt],'') AS credit
FROM [table1] AS a
FULL OUTER JOIN [table2] AS b
    ON a.[description] = b.[description] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T14:58:32.920

```
declare @table1 table (
[description] varchar(20),
paidamt money
)

declare @table2 table (
[description] varchar(20),
recievedamt money
)

insert @table1 values 
('ele. bill',200),
('stationary',500),
('salary',1000)

insert @table2 values 
('donation',1000),
('fees',200)

select [description],paidamt as [debit],null as [credit]  from @table1
union all
select [description],null as [debit],recievedamt as [credit] from @table2 
```

# scala - Scala：使用构造函数参数扩展具体类

> ID：13646993
> 
> 赞同：5
> 
> 时间：2012-11-30T14:20:52.917
> 
> 标签：scala, parameters, constructor, extend

我有这个具体的课程：

```
class Person (var name: String, var surname: String) 
```

我想创建另一个扩展 Person 的类：

```
class Son (name: String, surname: String) extends Person(name, surname) 
```

好的。但我确实希望 Son 的构造函数中的字段必须是 var 而不是 val。我该如何解决？这些字段必须保留构造函数参数。

**更新#2**

我的问题如下：如果我在 Son 中定义一个方法，如果我将值更改为 Son 实例的参数，这将不起作用。

```
class Son (name: String, surname: String) extends Person(name, surname){
  def printSon = {
  if(this.name=="name")println("Error name Person")
  if(this.surname=="surname")println("Error surname Person")
  }
}

object main {
  def main(args: Array[String]): Unit = {}

  val Marco = new Son("Marco","Bianchi")
  Marco.printSon // So far everything is ok
  Marco.name="name"
  Marco.printSon // Here in control is not done, because Marco.name="name" writes in Person
  println("FINE")
} 
```

Son 中的 name e surname 属于 val 类型。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-30T15:18:06.340

如果我理解正确，您希望`name`and`surname`字段`Son`是不可变的，而不是 Person 中的字段，它们是 vars。

那根本不可能。唯一的方法是覆盖：

```
class Person (var name: String, var surname: String)

//this won't compile
class Son(override val name: String, override val surname: String) extends Person(name, surname) 
```

在 Scala 中，您不能用 val 覆盖 var - 这很明显为什么 -[子类只能覆盖或向超类添加功能](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。如果我们允许 vals 覆盖 vars，我们将从父类中删除被覆盖字段的设置器。这打破了继承隐含的“is-a”关系。

你可以做的是这样实现：

```
trait Person {
    def name: String
    def surname: String
}

//this is fine now
class Son(val name: String, val surname: String) extends Person

//in case you want a type of person which can be changed.
class MutablePerson(var name: String, var surname: String) extends Person 
```

`Person`now 是一个特征 - 它只是提供了一种获取`name`or的方法`surname`。`Son`通过使用 vals覆盖`Person`- 因此您可以保证没有人会`Son`再次更改字段。

从您的示例中，我假设您仍然希望拥有一种`Person`可以修改的类型。你可以使用`MutablePerson`上面的类来做到这一点，它确实允许它的字段被改变。

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-30T15:28:21.870

您必须将参数命名为不同的名称，否则儿子主体中的方法将尝试访问参数而不是`Person`类中的字段。如果您在正文中访问参数，Scala 将自动为参数创建字段。当你做这样的事情时它会起作用（这也是一种常用的模式）：

```
class Son (_name: String, _surname: String) extends Person(_name, _surname){
  def printSon = {
  if(name == "name")println("Error name Person")
  if(surname == "surname")println("Error surname Person")
  }
} 
```