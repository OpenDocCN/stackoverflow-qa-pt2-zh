# StackOverflow 问答 14714000-14714999

# highcharts - 工具提示中的 URL 链接

> ID：14714000
> 
> 赞同：1
> 
> 时间：2013-02-05T18:05:48.037
> 
> 标签：highcharts

我在工具提示中有一个 url 链接，但是，如果工具提示超出图表区域并且您尝试单击该 url，则工具提示会消失。

有什么解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:13:19.160

我发现在这样的情况下，最好手动定位工具提示：

[http://api.highcharts.com/highcharts#tooltip.positioner](http://api.highcharts.com/highcharts#tooltip.positioner)

这样，不需要的隐藏是可控的。

编辑：

如果你扩展工具提示原型，你可以操纵 X 和 Y

```
Tooltip.prototype.move = function (x, y, anchorX, anchorY) {
    var tooltip = this,
        now = tooltip.now,
        animate = tooltip.options.animation !== false && !tooltip.isHidden;

            if(x > ?????)
            {
               x = x - 50; // or how ever many pixels you want to move it to
            }

    // get intermediate values for animation
    extend(now, {
        x: animate ? (2 * now.x + x) / 3 : x,
        y: animate ? (now.y + y) / 2 : y,
        anchorX: animate ? (2 * now.anchorX + anchorX) / 3 : anchorX,
        anchorY: animate ? (now.anchorY + anchorY) / 2 : anchorY
    });

    // move to the intermediate value
    tooltip.label.attr(now);

    // run on next tick of the mouse tracker
    if (animate && (mathAbs(x - now.x) > 1 || mathAbs(y - now.y) > 1)) {

        // never allow two timeouts
        clearTimeout(this.tooltipTimeout);

        // set the fixed interval ticking for the smooth tooltip
        this.tooltipTimeout = setTimeout(function () {
            // The interval function may still be running during destroy, so check that the chart is really there before calling.
            if (tooltip) {
                tooltip.move(x, y, anchorX, anchorY);
            }
        }, 32);

    }
} 
```

# php - Symfony2 Twig 注入额外的块

> ID：14714001
> 
> 赞同：3
> 
> 时间：2013-02-05T18:05:56.363
> 
> 标签：php, templates, symfony, twig

Symfony2 和 Twig 有没有办法让只包含块的文件始终可用。

例如，如果我想让一个名为“cookie”的块在我的系统中的任何模板中始终可用，而不必总是在我正在使用的模板中包含或扩展它。

有任何想法吗？

* * *

澄清

假设我有一个通用块可以做一些事情，比如：

```
{% block myBlock %}
    ABC Examples
{% endblock %} 
```

我有一个知道它想用这个块渲染的类。我的模板本身并不一定知道这一点。

```
 {{ block(myObj.blockName) }} 
```

然后我想拥有它，以便我的控制器/服务/等。可以注册包含该块的文件，而我的模板实际上不需要直接知道它（所以我可以有多个这样的文件，每个文件都使用一些通用接口）。

类似于使用 TwigExtension 注册自定义 Twig 函数。我的模板不需要明确知道它的存在，它只需要在运行时可用。

那有意义吗？

* * *

为了进一步澄清，我本质上是想做一些事情，就像在 Symfony2 中如何使用默认的 Twig 块来呈现表单一样。我不必每次都包含默认表单文件，只是在我想更改某些内容时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T00:25:18.940

我在 Symfony 源代码中四处挖掘，试图找到我的答案。看起来没有什么花哨、简洁的方法可以直接从配置文件或控制器中嵌入它，这有点令人失望，但也不是什么大不了的事。

因此，为了解决我的情况，我将使用“use”关键字将我的块文件包含在我的基本模板中，这样它就可以用于其他所有内容。

```
{# widget_blocks.html.twig #}
{# Widgets #}
{% block my_widget %}
    ABC Cookies
{% endblock %}

{# base.html.twig #}
{% use widget_blocks.html.twig %}
{{ block(my_widget.block) }} 
```

不完全是我想要的，但足够接近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:38:09.317

```
{% render 'MyMainBundle:Default:credits' with {'arg1': $myObj } %} 
```

这就是我说的。上面的行或有什么区别

```
{{ block(myObj.blockName) }} 
```

您可以注册一个自定义过滤器，但据我所知，它只返回字符串值。[http://twig.sensiolabs.org/doc/advanced.html#id2](http://twig.sensiolabs.org/doc/advanced.html#id2)

# sql - 命名表的 SQL where 子句

> ID：14714002
> 
> 赞同：0
> 
> 时间：2013-02-05T18:05:57.913
> 
> 标签：sql, oracle11g

当我没有年龄字段来检查它时，如何使用 where 子句检查下面的年龄显示？我正在使用 oracle 数据库。

```
select LNAME || ', ' || FNAME as "Name", 
       TO_CHAR(sysdate,'YYYY') - TO_CHAR(DOB,'YYYY') as AGE 
  from STAFF
 where AGE = (select min(TO_CHAR(sysdate,'YYYY') - TO_CHAR(DOB,'YYYY')) 
                from STAFF); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:08:48.920

要选择最年轻的员工：

```
select  *
from    (
        select  *
        from    STAFF
        order by
                DOB desc
        ) SubQueryAlias
where   rownum = 1 
```

[SQL Fiddle 的示例。](http://sqlfiddle.com/#!4/6aafa/1/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:26:07.610

以下是现有 Oracle 表的一些示例：

```
SELECT * FROM 
(
 SELECT ename as "Name"
      , TO_CHAR(sysdate,'YYYY') - TO_CHAR(hiredate,'YYYY') as AGE 
  FROM scott.emp
)
WHERE age = (SELECT min(TO_CHAR(sysdate,'YYYY') - TO_CHAR(hiredate,'YYYY')) FROM scott.emp)
/

Name    AGE
----------------
SCOTT   26
ADAMS   26 
```

例如，您还可以添加分析函数以按年龄或任何其他字段进行分区，或者简单地按年龄 asc 排序以查看输出中的所有 emp 删除 where...

# objective-c - json ObjectForKey 换行

> ID：14714006
> 
> 赞同：0
> 
> 时间：2013-02-05T18:06:11.423
> 
> 标签：objective-c, cocoa

问题：`UIAlertView`节目`\n`改为从 Json 响应中换行。

* * *

json响应：

```
{"error":"Line 1.\\nLine 2."} 
```

代码

```
[self setLastError:[dictJsonResult jsonObjectForKey:@"error"]];

UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"Registration Failed"
    message:[ParseHelper lastError] delegate:nil
    cancelButtonTitle:@"OK"
    otherButtonTitles:nil] autorelease]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:07:36.130

问题在于，`\\`它`\`优先，因为它是第一位的。

进一步解释

`ABC\\nDEF`好像：

```
ABC\nDEF 
```

`ABC\nDEF`好像：

```
ABC
DEF 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:08:58.487

所以伊斯梅尔已经解释了哪里出了问题；我告诉你如何解决它：

```
[self setLastError:[[dictJsonResult jsonObjectForKey:@"error"]
    stringByReplacingOccurrencesOfString:@"\\n" withString:@"\n"]]; 
```

# c# - DotNetOpenAuth 示例 OpenID 错误：未找到 OpenID 端点

> ID：14714008
> 
> 赞同：0
> 
> 时间：2013-02-05T18:06:23.763
> 
> 标签：c#, openid, dotnetopenauth

我使用 DotNetOpenAuth 并且当我打电话时：

```
this.openIdRelyingParty.CreateRequest(userSuppliedIdentifier, realm, returnToUrl); 
```

我得到了上面的错误......我正在使用我自己的 OpenID 提供程序，我刚刚在 localhost 中运行。有谁知道那可能是什么？内部异常说序列不包含任何项目或类似的东西。

我在想也许我将我的 RP 指向了我运行本地主机的错误位置。将 RP 指向 XRDS 文件是否正确？

谢谢尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:12:17.987

通常`userSuppliedIdentifier`应该是 OpenID 提供者网站的 URL——而不是直接在 XRDS 文件中。提供者的主页应该检测到对 XRDS 文档的调用并做出适当的响应。OpenIdProvider[Mvc] 示例演示了这一点。

由于您在 localhost 上托管，因此很可能出现的问题是 RP 拒绝连接到 localhost 端点（默认情况下是安全的，因为当您在生产中时，这并不是一个真正有效的场景）。因此，当您在本地开发时，您必须在 web.config 文件中将 localhost 列入白名单。请参阅 OpenIdRelyingParty[WebForms/Mvc] 示例的 web.config 文件了解如何执行此操作。

# asp.net-mvc - DotNetOpenAuth 并使用 MVC 4 刷新令牌

> ID：14714009
> 
> 赞同：1
> 
> 时间：2013-02-05T18:06:29.733
> 
> 标签：asp.net-mvc, asp.net-mvc-4, dotnetopenauth

我正在尝试实现一个`OAuth2Authorization Server`并且我正在尝试通过`DotNetOpenAuth.AspNet.Clients.OAuth2Client`在 MVC 4 webclient 项目中连接到它。

在我的 SPA 网络客户端中，我能够`AccessToken`获得.`QueryAccessToken``OAuth2Client`

有了我`AccessToken`，我可以调用 REST API 服务并获得成功的结果作为用户额外数据。

```
....
HttpWebRequest apiRequest = 
   (HttpWebRequest)WebRequest.Create(".....://localhost:4314/api/TodoList");
DotNetOpenAuth.OAuth2.ClientBase.AuthorizeRequest(apiRequest, AccessToken);
.... 
```

但是，过了一段时间，我`AccessToken`的过期了，我收到一个错误，所以我需要刷新我`AccessToken`的下一个 REST 服务调用。

如何刷新我的`AccessToken`内部方法`OAuth2Client`？可以使用`ClientBase.RefreshAuthorization(....)`吗？

谢谢卡梅罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T04:22:01.227

使用`DotNetOpenAuth.AspNet`命名空间进行授权（重复使用访问令牌进行 Web 请求）正在逆流而上。该名称空间具有仅用于登录（身份验证）的客户端。

更适合您正在做的事情是使用`WebServerClient`该类，它是核心 DotNetOpenAuth 库的一部分。它会根据需要自动刷新访问令牌。

# ruby-on-rails - 将属性附加到 Rails 中的模型对象

> ID：14714016
> 
> 赞同：0
> 
> 时间：2013-02-05T18:06:49.790
> 
> 标签：ruby-on-rails, json, rails-activerecord

我有一个`Place`模型和一个`PlacesController`. 目前，控制器使用某些对象响应 JSON。我想为响应的对象添加更多字段。例如，我想添加每个地方的标签，通过方法查询`Place.tags`。

我正在考虑两种解决方案：将对象列表转换为哈希列表并添加我想要的属性，或者在模型中添加一个新列，将其填充到迭代对象列表的控制器中。我不确定是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:17:42.180

我假设：

```
 class Place < ActiveRecord:Base
   has_many :tags 
```

如果是这样，您是否只是尝试将关联的标签添加到地点对象的 json 中？如果是这样，您可以使用（其中 'place' 是 Place 对象）：

```
 place.to_json(:include=>:tags) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:24:46.660

您也可以使用模板来生成 JSON。它可以让您控制 JSON 中出现的内容，并且比通过 to_json 或 render :json 渲染要快得多。

在此处查看我关于呈现 JSON 的最快方法的问题：[What is the faster way to render json in rails](https://stackoverflow.com/questions/10451722/what-is-the-fastest-way-to-render-json-in-rails)。

我发现 RABL ( [https://github.com/nesquena/rabl](https://github.com/nesquena/rabl) ) 快速且易于设置。

对于您的示例，在 RABL 中，您将执行以下操作：

```
class PlacesController < ApplicationController
  def show
    @place = Place.find(params[:id])
  end
end 
```

在视图中：

```
object @place => :place
attributes :id, :name

children :tags => :tags do
  attributes :id, :name
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:12:24.537

在这种情况下，我可能会使用演示者模式。看看这里：[http ://blog.jayfields.com/2007/03/rails-presenter-pattern.html](http://blog.jayfields.com/2007/03/rails-presenter-pattern.html)

如果您有专业帐户，还有一个 railscast：[http ://railscasts.com/episodes/287-presenters-from-scratch](http://railscasts.com/episodes/287-presenters-from-scratch)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-05T18:17:31.043

我不确定我的解决方案是更好的方法

```
# in controller
@place = Place.first
@place[:place_tags] = @place.tags.map(&:attributes)
render :json => @place 
```

# sql - sql：根据另一个表2中的查找匹配更新表1

> ID：14714017
> 
> 赞同：0
> 
> 时间：2013-02-05T18:06:55.523
> 
> 标签：sql, replace, matching, sql-like

我有 2 张桌子：

表格1：

```
NULL    NULL    Cat.XX 23   Cow.XX 87
NULL    NULL    Tiger.XX 99 Elephant.XX 
```

Column1 和 Column2 是 ID 号，分别与 column3 和 column4 中的值相关联。

表2：

```
84048713    Cat.XX 23   Blah1   Blah2   Blah3   Blah4   
44008714    Elephant.XX 77  Blah1   Blah2   Blah3   Blah4   
64038715    Cow.XX 87   Blah1   Blah2   Blah3   Blah4
34058716    Tiger.XX 99 Blah1   Blah2   Blah3   Blah4
74038717    Zebra.XX 34 Blah1   Blah2   Blah3   Blah4
94098719    Whale.XX 47 Blah1   Blah2   Blah3   Blah4 
```

我想用适当的 ID 号更新 table1 中的每一行。生成的 table1 应如下所示：

```
84048713    64038715    Cat.XX 23   Cow.XX 87
34058716    44008714    Tiger.XX 99 Elephant.XX 
```

我尝试了使用 select、where 和 select replace 的各种组合（我使用 replace 是因为包含动物名称的字段中有空格）。例如，我尝试了以下操作：

```
select IDs from table2 where 
(select replace("Name", ' ', '') from table2
LIKE
(select replace("Name", ' ', '') from table1) 
```

但我收到以下错误：

```
Msg 512, Level 16, State 1, Line 1
Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. 
```

我感谢您的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:14:20.607

```
update table1 set Column1ID = (select ID from table2 where column2 = table1.column3),Column2ID = (select ID from table2 where column2 = table1.column4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:25:23.350

尝试这个;

```
Update t1
Set t1.col1 = case t1.col3 when t2.col2 then t2.col1 else t1.col1, 
    t1.col2 = case t1.col4 when t2.col2 then t2.col1 else t1.col2
From table1 t1 join table2 t2 
    on t1.col3 = t2.col2 or t1.col4 = t2.col2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:41:31.523

![在此处输入图像描述](../Images/52bd919c006879368396b79790dc0239.png)

> 更新 TABLE_1 SET ID = B.ID ， ID2 = C.ID 从 TABLE_1 作为左外连接 TABLE_2 作为 B ON A.TEMPID = B.TEMPID 左外连接 TABLE_2 作为 C ON A.TEMPUD2 = C.TEMPID

# sql - 具有多个条件计数的 SQL Server Distinct 查询

> ID：14714019
> 
> 赞同：2
> 
> 时间：2013-02-05T18:06:57.880
> 
> 标签：sql, sql-server, distinct, aggregate

我正在尝试创建一个查询，以便为我提供多行测试数据的周转时间（以分钟为单位）。

该表的简洁版本是：

测试名称、开始日期时间、结束日期时间

我正在寻找一个可以给我输出的查询，例如：

```
Distinct TestName 
, StartDate[not time]
, Count(rows) as Total
, Count(rows where datediff(minute, StartDateTime, EndDateTime) <=60) as NonBreach
, Count(rows where datediff(minute, StartDateTime, EndDateTime) >60) as Breach
, Count(rows where datediff(minute, StartDateTime, EndDateTime) >60) / Count(rows) as BreachRate 
```

这个原则甚至可能吗？

任何方向将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:13:33.187

你可以使用这样的东西：

```
SELECT  TestName,
        CAST(StartdateTime AS DATE) AS StartDate,
        COUNT(*) AS Total,
        COUNT(CASE WHEN DATEDIFF(MINUTE, StartDateTime, EndDateTime) <= 60 THEN 1 END) AS NonBreach,
        COUNT(CASE WHEN DATEDIFF(MINUTE, StartDateTime, EndDateTime) > 60 THEN 1 END) AS Breach,
        1.0 * COUNT(CASE WHEN DATEDIFF(MINUTE, StartDateTime, EndDateTime) > 60 THEN 1 END) / COUNT(1) AS BreachRate
FROM    YourTable
GROUP BY TestName, CAST(StartdateTime AS DATE) 
```

尽管根据您的 DBMS，您可能需要使用不同的方法从日期中删除时间。

* * *

从日期中删除时间：

* * *

**[SQL-Server 2008](http://www.sqlfiddle.com/#!3/78a77/1)**及更高版本：

```
SELECT  CAST(CURRENT_TIMESTAMP AS DATE) 
```

* * *

**[SQL-Server 2005](http://www.sqlfiddle.com/#!3/78a77/2)**及更早版本

```
SELECT  DATEADD(DAY, DATEDIFF(DAY, 0, CURRENT_TIMESTAMP), 0) 
```

* * *

**[MySQL](http://www.sqlfiddle.com/#!2/78a77/21)和[SQLite](http://www.sqlfiddle.com/#!5/78a77/4)**

```
SELECT  DATE(CURRENT_TIMESTAMP) 
```

* * *

**[甲骨文](http://www.sqlfiddle.com/#!4/78a77/6)**

```
SELECT  TRUNC(CURRENT_TIMESTAMP) 
```

* * *

**[PostgreSQL](http://www.sqlfiddle.com/#!1/78a77/5)**

```
SELECT  CURRENT_TIMESTAMP::DATE 
```

* * *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:13:16.573

使用 SQL Server 2008 语法（其他数据库对`datediff`and的方法略有不同`cast(... as date)`：

```
select  TestName 
,       cast(StartDateTime as date) as StartDate
,       count(*) as Total
,       sum(case when datediff(minute, StartDateTime, EndDateTime) <= 60 
            then 1 end) as NonBreach
,       sum(case when datediff(minute, StartDateTime, EndDateTime) > 60 
            then 1 end) as Breach
,       1.0 * sum(case when datediff(minute, StartDateTime, EndDateTime) > 60 
            then 1 end) / count(*) as BreachRate
from    YourTable
group by
        TestName 
,       cast(StartDateTime as date) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:15:49.603

据我所知，这样做是不可能的。也许你可以做这样的事情：

```
Select TestName 
    , StartDate[not time]
    , Count(rows) as Total
    , SUM(CASE WHEN  datediff(minute, StartDateTime, EndDateTime) <=60 THEN 1 ELSE 0 END ) as NonBreach
    , SUM(CASE WHEN datediff(minute, StartDateTime, EndDateTime) >60 THEN 1 ELSE 0 END ) as Breach 
```

# php - 数据库导出问题

> ID：14714021
> 
> 赞同：1
> 
> 时间：2013-02-05T18:07:01.807
> 
> 标签：php, mysql, sql, database, phpmyadmin

试图克隆我当前的 wordpress 站点并将其放在第二台服务器上以测试新插件和更新。一直在尝试不同的克隆方法，但我一直遇到数据库问题。

我可以在 phpMyAdmin 中从服务器 A 导出数据库，但是当我在服务器 B 上恢复它时，它只会给我一个同名的空数据库。我选择导出的所有表和数据都消失了。

有谁知道我做错了什么？

下面是我设置导出的方法： [数据库导出](http://i.imgur.com/ODEKyS5.png?1)

下面是我设置导入的方法： [数据库导入](http://i.imgur.com/iZtghIi.png?1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T15:35:32.397

我建议学习如何在命令行上使用[mysqldump](http://www.thegeekstuff.com/2008/09/backup-and-restore-mysql-database-using-mysqldump/)，这几乎可以肯定是 phpMyAdmin 在后台使用它来进行数据库导出。如果您使用的是`mysqldump`，则可以通过 SSH（或其他方式）传输转储文件，而不必处理最大上传大小或类似的事情。

一般来说，精通低级工具是很好的，这样您就不必依赖 Web GUI 来做事了。

当然，如果您在没有 shell 访问权限的情况下使用共享主机，我的评论毫无用处，而且据我所知，您已经知道如何`mysqldump`使用 phpMyAdmin，并且由于托管环境的限制，您被迫违背自己的意愿使用 phpMyAdmin。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:28:09.260

这可能会有所帮助：http: [//support.tigertech.net/mysql-duplicate](http://support.tigertech.net/mysql-duplicate)

它说您需要在导出之前单击左侧的数据库名称，没有明显的原因，否则您将无法将导出的文件导入新数据库。

此外，您必须将输入文件切成小块。UI 显示小于 50MB。根据我的经验，10 MB 是行不通的。不知道文件有多大，但小于 10 MB。

# azure - 使用没有发布设置文件的 Windows Azure CLI？

> ID：14714022
> 
> 赞同：1
> 
> 时间：2013-02-05T18:07:13.120
> 
> 标签：azure

是否可以在不使用 .publishsettings 文件的情况下配置 Windows Azure CLI 工具？“azure account -h”命令仅列出用于下载和导入 .publishsettings 文件的选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:30:37.070

据我所知，这是一种耻辱，因为它在 PowerShell 中是可能的（使用`Set-AzureSubscription`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-27T20:26:33.913

当前版本 - Azure CLI 2 - 可以毫无问题地做到这一点。您必须使用`az login`来提供您的凭据，并且您可以使用 cli、切换帐户等。

# file-io - 规划文档生成项目；寻找输出格式建议

> ID：14714025
> 
> 赞同：0
> 
> 时间：2013-02-05T18:07:33.017
> 
> 标签：file-io

我目前正在处理一个项目，我们有一个相当大的文档，我们手动填写结果，在我看来，这似乎是过时且不必要的耗时。

我决定自己起草一份提案，以简化此流程，并在我进一步充实后将其提交给我的上级。我正在为我正在编写的文档寻找输出格式的建议。

该文档主要是带有通过/失败字段的表格。我希望自动检查结果并正确填补空白（假设我有这样做的方法）。我需要一种方法来输出可以在生成后编辑的文件，因为由于故障的性质，我们仍然需要手动评估故障。

我的第一个想法是 Latex，但我不相信有一种易于编辑的输出格式。我的下一个想法是 word，但我读过通过自动化生成 word 文档是一个痛苦的过程。

任何建议都会很棒，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:12:34.930

如果您需要输出文件看起来合理，我会考虑纯 HTML，它在简单的文本编辑器中是完全可编辑的，只要它是干净生成的（即像人类编写的那样带有换行和缩进）。如果这对您很重要，您可以对其应用静态样式表来美化它，但样式表将是静态的，不需要编辑。简单的 HTML 在没有样式表的标准浏览器中看起来应该是可读的，但会相当简单。

编辑结果可能需要对非技术用户进行少量培训，但不需要太多 - 您可能会发现您可以在 Word 中成功编辑页面，但如果保存时它没有破坏它们，我不会感到惊讶他们退出。修改可能不会成为人类可读性的问题，但可能会使稍后尝试自动解析它的工具复杂化。这是你必须尝试的东西。

另一种选择是写出简单的 CSV 文件，这些文件可以使用文本编辑器或电子表格应用程序轻松编辑 - 这些对于非技术 Windows 用户来说可能更容易，因为他们可以使用 Excel 或开源等价物。然而，这些的呈现有点混乱，除非您将它们加载到电子表格应用程序中 - 您可以有一个单独的“发布”阶段，它会自动将它们转换为更漂亮的只读形式。

如果您有其他限制因素导致这些建议不合适，请详细说明，以便我们提供更多帮助。

# background-repeat - 背景图像水平或垂直平铺而不是整个背景

> ID：14714031
> 
> 赞同：0
> 
> 时间：2013-02-05T18:07:44.197
> 
> 标签：background-repeat

当我使用 x 作为背景重复时，图块沿页面顶部水平运行，而当我使用 y 时，它们垂直运行在页面左侧。

我假设我现有的样式表中有一些东西导致了冲突，但我找不到它。

这是正文代码：

```
<body style="background-color:#FFFFFF;background-image:url('images/wallpaper_bg.png');
background-repeat:repeat-x;"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:13:57.093

我在想 y 表示是，x 表示否，而不是 xy 坐标！

应该重复——当然是的

# jdbc - 使用数据库中的 Mule ESB 处理大型数据集：如何根据一定的批量大小更新处理过的记录？

> ID：14714032
> 
> 赞同：0
> 
> 时间：2013-02-05T18:07:44.353
> 
> 标签：jdbc, mule, esb

我有大量要处理的记录，例如：100,000 条记录。我的用例有 4 个步骤：

1.  使用 jdbc 入站适配器从数据库表中选择记录
2.  将记录转换为xml格式
3.  将消息发布到队列
4.  然后用一些状态标志更新相同的记录，因为它已经被处理了，这样它就不会被再次拾取

我不想一次性从表中选择所有记录进行处理：有没有办法可以分批选择并且不想为一条记录更新表？是否有批量级别的批量/批量更新选项？

或者有没有其他更好的方法来处理这个用例？任何建议高度赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:24:42.020

我会编写 SQL 选择查询以仅返回 N 条记录（类似`LIMIT 100`或等价的），其中的 where 子句根据状态标志排除已处理的记录。

# html - 在 CSS 中自动调整倾斜背景的大小（+ 图像？）

> ID：14714033
> 
> 赞同：12
> 
> 时间：2013-02-05T18:07:49.060
> 
> 标签：html, css, background-image, autoresize, skew

我要将此 PSD 图像转换为 CSS。我在多个页面中有多个 h2，因此内部文本长度和背景颜色可能会有所不同。因此背景应该自动适应“任何”长度。

![倾斜的背景演示](../Images/c4d19faf6a874fafbf07b9cb6f0397b6.png)

到目前为止，标记类似于：

```
<h2 class="sub-heading lab-heading">Laboratori</h2> 
```

我最终可能会将内部文本包装成一个`<span>`，但是保持语义有效的标记没有任何额外的元素将是♥ly。

内部文本是旋转的，但这不是强制性的。我现在关注的是倾斜的背景。

我对使用缩放背景 png（例如 background-size:cover）、伪元素、画布等的任何解决方案持开放态度。但它必须是模块化的。

非常感谢您的任何建议。

* * *

[更新]我正在寻找的图形示例：

![我不是图形演示](../Images/cdb7d035825fd7228c6662dca57d5951.png)

* * *

[重要提示] h2 后面有一个**不规则的图案**（不是“纯”色背景）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T13:56:00.417

对于任何感兴趣的人，这是我的临时解决方案：**[现场演示](http://jsfiddle.net/gionaf/G75Fe/)**。

我使用了这个精灵图像：

![倾斜的 bg 精灵](../Images/b17d6fcaafdc83abc3e69673e1a88666.png)

html:

```
<div class="container">
<h2 class="sub-heading"><span class="sub-heading-txt">Short title</span></h2>
</div>
<div class="container">
<h2 class="sub-heading"><span class="sub-heading-txt">A bit longer title</span></h2>
</div>
<div class="container">
<h2 class="sub-heading"><span class="sub-heading-txt">A damn long title is here!</span></h2>
</div> 
```

（`.container`只有变体需要 div）

CSS：

```
.sub-heading, .sub-heading:after, .sub-heading:before {
    background:url(tha-sprite-url.png) 0 0 no-repeat;
}

.sub-heading {
    position:relative;
    display:inline-block; clear:both;
    margin-left:31px; padding:0 18px 10px 0;
    font-size:25px; font-weight:normal; color:#FFF; line-height:47px;
    background-position:0 -75px;
    background-size:100% 282px; /* the sprite's height */
}

.sub-heading:before, .sub-heading:after { content:" "; position:absolute; top:0; }
.sub-heading:before { left:-31px; width:31px; height:57px; }
.sub-heading:after { right:-12px; width:12px; height:42px; background-position:-150px 0; }

.sub-heading-txt {
    display:block;
    -webkit-transform:rotate(-2deg); -ms-transform:rotate(-2deg); transform:rotate(-2deg);
}

/* variations */
.container { margin-bottom:10px; }
.container:nth-child(3n+2) .sub-heading { background-position:0 -150px; }
.container:nth-child(3n+2) .sub-heading:before { background-position:-50px 0; }
.container:nth-child(3n+2) .sub-heading:after { background-position:-175px 0; }
.container:nth-child(3n+3) .sub-heading { background-position:0 -225px; }
.container:nth-child(3n+3) .sub-heading:before { background-position:-100px 0; }
.container:nth-child(3n+3) .sub-heading:after { background-position:-200px 0; } 
```

适用于 IE9+

不幸的是，`background-size`属性不支持“继承”值，因此必须在 css 中设置实际精灵的高度 :-( 我仍在寻找更有效的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T11:51:51.930

通过结合 CSS 形状、定位`:before`和`:after`选择器，我设法使容器可扩展到任何内容。但是，这种方法只适用于现代浏览器，似乎没有 js 就没有合适的解决方案。此外，在这种情况下，svg 的使用可能非常少，但您再次受限于浏览器兼容性。

这是使用纯 CSS 的演示：http: [//jsfiddle.net/qaWKX/](http://jsfiddle.net/qaWKX/)

**编辑**

如果没有额外的 JS 函数，使用`svg`是无用的。所以我放弃了这种方法。然而，唯一合适的解决方案依赖于 CSS3，但不使用`:before`和`:after`选择器。`h3`我以前的方法是依靠创建隐藏标题两侧的伪元素。当背景没有纯色时，隐藏是不够的。

有了这个逻辑，我需要一个`background`将透明度和实心填充结合起来的东西。答案在 CSS3 上`linear-gradient` `background`。

详细说明： 1\. 我旋转了标题 2\. 我用它的容器（或）`h3`遮住了顶部区域3\. 我在每一侧设置了 2 个背景图像`top:-value``margin-top:-value``linear-gradient`

这是演示：http: [//jsfiddle.net/P5gLE/1/](http://jsfiddle.net/P5gLE/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T22:57:45.700

我认为不可能只使用`h2`. 倾斜边的不同角度会出现问题，这意味着您需要一个用于倾斜和变换的“容器”。

鉴于你的例子，我想出了以下内容：

[http://jsfiddle.net/Cbx2q/1/](http://jsfiddle.net/Cbx2q/1/)

如您所见，这有几个维护问题：

*   “魔术数字” - 这些将需要根据您选择的倾斜 + 大小进行调整。
*   使用变换的字体渲染有些糟糕。

否则，它似乎工作。除了使用伪元素和 CSS3 之外，最好的解决方案可能是坚持使用普通的旧图像作为每个菜单项的背景。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-08T21:05:29.940

这是html：

```
<br>
<div class="scewed-shape">
    <div class="text-align">here is a very long text adsadsad</div>
</div>
<br>
<br>
<div class="scewed-shape">
    <div class="text-align">this one is shorter</div>
</div> 
```

这是制作自定义形状的css：

```
.scewed-shape {
    display:inline-block;
    -webkit-transform: perspective(500px) rotateY(34deg);
    -ms-transform: perspective(500px) rotateY(34deg);
    left: -25px;
    height: 0;
    border-style: solid;
    border-color: red transparent transparent transparent;
    border-width: 70px 50px 0 50px;
}
.scewed-shape .text-align {
    position: relative;
    top: -25px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T19:14:31.927

What about using CSS shapes? I haven't worked with them a ton, but it seems like a good place to start.

[http://css-tricks.com/examples/ShapesOfCSS/](http://css-tricks.com/examples/ShapesOfCSS/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T21:26:16.913

我能想到的一个简单的解决方案是使用 3 个元素（我会使用 div）来表示形状的三个不同的底部角度，让左右的具有固定的大小，而中间的元素只是与包含的文本（标题）一起缩放在里面。也许不是最优雅的解决方案，但它肯定会奏效。缺点是您需要大量图像，特别是如果您想要不同颜色的形状。（我知道没有办法给背景图像上色）。

但是，如果形状周围的空间具有纯色背景色，您实际上可以将 3 个元素的背景色设置为您想要的颜色，并让您使用的实际图像具有与背景相同的颜色作为负空间，是透明的你想要实际形状的地方。

另外，如果你真的不想要比你需要的更多的元素，你总是可以使用 :after 和 :before 选择器来伪造它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-14T21:54:52.903

```
<!--[if lt IE 9]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]--> 
```

就页面中的样式/功能而言，上述代码将使 IE 5.5 到 8 像现代兼容浏览器一样运行。此脚本专门用于解决 IE 过去版本中的 CSS/渲染错误。

这是脚本的文档：http: [//www.charlescooke.me.uk/web/lab_notes/ie7_script.html](http://www.charlescooke.me.uk/web/lab_notes/ie7_script.html)

这是一种“IE 后备”，但是解决问题的更好方法。与其制作大量版本的内容以使用不同的浏览器以完全相同的方式呈现，这只是在早期版本的 IE 上强制实现现代兼容性。

我过去曾使用此脚本来修复类似的 CSS 渲染错误。上面的这个特定脚本是将 IE5.5-8 升级到 9。如果您有意将 IE5.5-7 升级到 8（不知道为什么需要，但如果您愿意的话），附加脚本位于下面的 URL 可以做到这一点。

这是 Google 的页面及其上的文档（也包括此页面上的链接） [http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

# elasticsearch - 尽管有 4GB ES_MAX_MEM，但 ElasticSearch 反复崩溃“HeapDumpOnOutOfMemoryError”

> ID：14714036
> 
> 赞同：3
> 
> 时间：2013-02-05T18:07:59.077
> 
> 标签：elasticsearch

我正在通过以下方式启动 ElasticSearch

```
echo "export ES_HEAP_SIZE = 4096" >> /root/setenv
echo "export ES_MAX_MEM = 4096" >> /root/setenv
echo "export ES_MAX_MEM = 4096" >> /root/setenv

# finally,  we can start the app
echo 'Starting ElasticSearch...'
bin/elasticsearch -Xmx4g -Xms4g 
```

然而，在没有时间（20分钟）之后，它变得没有响应，显然是由于`HeapDumpOnOutOfMemoryError`......

```
[root@ip-***** api]# ps -ax | grep elasticsearch
 6225 ?        SLl    5:35 java -Xms256m -Xmx1g -Xss256k -Djava.awt.headless=true -XX:+UseParNewGC -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75 -XX:+UseCMSInitiatingOccupancyOnly -XX:+HeapDumpOnOutOfMemoryError -Delasticsearch -Des.path.home=/root/elasticsearch/elasticsearch-0.20.3 -cp :/root/elasticsearch/elasticsearch-0.20.3/lib/elasticsearch-0.20.3.jar:/root/elasticsearch/elasticsearch-0.20.3/lib/*:/root/elasticsearch/elasticsearch-0.20.3/lib/sigar/* -Xmx4g -Xms4g org.elasticsearch.bootstrap.ElasticSearch 
```

编辑——我刚刚注意到这里输出的 -Xms 大小只有 256m，尽管在上面的启动中传递了 4g。我是不是误会了什么？

FWIW，我在运行 CentOS 和 Java v1.6.0_14-b08 的 Amazon EC2（m1.large 实例 => 8GB 内存）上

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T07:02:20.873

首先，设置`ES_HEAP_SIZE`本身并不能帮助您防止内存不足错误。Elasticsearch 使用的内存量取决于您执行的查询类型：您是否使用分面、排序、过滤、有多少字段、这些字段有多大、它们的基数是多少等。

其次，最好使用[`ES_INCLUDE`](https://github.com/elasticsearch/elasticsearch/blob/master/bin/elasticsearch.in.sh)脚本或[服务包装器](https://github.com/elasticsearch/elasticsearch-servicewrapper)，而不是将命令行上所需的所有选项传递给`elasticsearch`脚本。

第三，正确设置`ES_HEAP_SIZE`环境变量时，不需要将`-X`选项传递给*elasticsearch*脚本。事实上，这些选项没有任何作用——脚本不会将它们传递给 Java。使用该`ES_HEAP_SIZE`变量来控制内存，并使用`ES_JAVA_OPTIONS`来控制您想要传递给 Java 的其他变量。

# c# - 将 MetadataType 与属性网格控件一起使用？

> ID：14714037
> 
> 赞同：2
> 
> 时间：2013-02-05T18:07:59.687
> 
> 标签：c#, attributes, metadata

我有一些自动生成的类，需要使用 MetadataType 属性将各种数据注释应用于类。这在我的 MVC 应用程序中效果很好，现在我需要在 WinForms 应用程序中使用相同的类，并且需要使用属性网格控件来显示/修改对象属性。似乎属性网格没有观察 MetadataType，有没有一种简单的方法可以让属性网格查看我的数据注释？

# python - Python 简单的网络服务器

> ID：14714039
> 
> 赞同：1
> 
> 时间：2013-02-05T18:08:08.627
> 
> 标签：python, python-2.7

我正在尝试使用 Python 中的内置 HTTP 服务器打印一些简单的变量

```
class WebServer:
    def __init__(self):
        from BaseHTTPServer import HTTPServer
        import urlparse
        server = HTTPServer(('', 8080), self.do_GET)
        server.serve_forever()

    def do_GET(self):
        parsed_path = urlparse.urlparse(self.path)
        message_parts = [
                'CLIENT VALUES:',
                'client_address=%s (%s)' % (self.client_address, self.address_string()),
                'command=%s' % self.command,
                'path=%s' % self.path,
                'real path=%s' % parsed_path.path,
                'query=%s' % parsed_path.query,
                'request_version=%s' % self.request_version,
                '',
                'SERVER VALUES:',
                'server_version=%s' % self.server_version,
                'sys_version=%s' % self.sys_version,
                'protocol_version=%s' % self.protocol_version,
                '',
                'HEADERS RECEIVED:',
                ]
        for name, value in sorted(self.headers.items()):
            message_parts.append('%s=%s' % (name, value.rstrip()))
        message_parts.append('')
        message = '\r\n'.join(message_parts)
        self.send_response(200)
        self.end_headers()
        self.wfile.write(message)
        return 
```

但我似乎得到了这个错误：

```
Exception happened during processing of request from ('10.0.1.3', 52251)
Traceback (most recent call last):
  File "/usr/lib/python2.7/SocketServer.py", line 295, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python2.7/SocketServer.py", line 321, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python2.7/SocketServer.py", line 334, in finish_request
    self.RequestHandlerClass(request, client_address, self)
TypeError: do_GET() takes exactly 1 argument (4 given)
---------------------------------------- 
```

def do_GET(self): 似乎收到的不仅仅是 self，我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:14:59.990

`BaseHTTPRequestHandler`当预期a 时，您正在传递一个函数。换句话说，Python 正在尝试使用一种`BaseHTTPRequestHandler` `__init__`方法来实例化您的对象，但是您提供了一个接受不同数量参数的函数。

而不是传递一个普通的函数， sublcas `BaseHTTPRequestHandler`。@dm03514 在评论中链接的示例将帮助您入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:16:09.377

`WebServer`从请求处理程序继承，如下所示：

```
class WebServer(BaseHTTPRequestHandler): 
```

您可能必须为此更改导入。

然后将它作为参数传递给`HTTPServer`这样的：

```
server = HTTPServer(('', 8080), WebServer) 
```

# objective-c - 自定义 UIAlertView：CODialog 显示在左上角

> ID：14714041
> 
> 赞同：1
> 
> 时间：2013-02-05T18:08:10.473
> 
> 标签：objective-c, ios5, ios6, uialertview, custom-view

我正在为我的自定义 UIAlertView 使用[CODialog](https://github.com/eaigner/CODialog)并且它可以工作（意味着它会弹出），但我的问题是它没有在屏幕中央弹出，并且在弹出后按钮不起作用。我在示例文件中实现了它，但似乎找不到问题。

我在我的项目中添加了“CODialog.h”和“CODialog.m”。然后做了以下事情：

**ViewController.h 文件：**

```
 #import "CODialog.h" 
```

...

```
@property (nonatomic, strong) CODialog * dialog 
```

...

```
@synthesize dialog;

- (void) viewDidLoad{
self.dialog = [CODialog dialogWithWindow:self.view.window];
}

- (void)showDefault:(id)sender {  
  [self.dialog resetLayout];

  self.dialog.dialogStyle = CODialogStyleDefault;
  self.dialog.title = @"Title";
  self.dialog.subtitle = @"Lorem ipsum dolor sit amet, consectetur adipiscing elit.";

  [self.dialog addButtonWithTitle:@"Done" target:self selector:@selector(hideDialog:)];
  [self.dialog addButtonWithTitle:@"Ok" target:self selector:@selector(hideDialog:) highlighted:YES];
  [self.dialog showOrUpdateAnimated:YES];
}

- (void)hideDialog:(id)sender {
  [self.dialog hideAnimated:YES];
} 
```

showDefault被另一种方法调用**。**我的目标是 iOS5 - iOS6 并使用带有 ARC 的故事板。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-22T18:35:32.330

关于什么：

self.dialog = [CODialog dialogWithWindow:self.navigationController.view.window];

它会解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:14:23.010

Have you tried setting the .center property of that view to half size of parent view ?

# git - 如何获取更新的 github 存储库

> ID：14714044
> 
> 赞同：0
> 
> 时间：2013-02-05T18:08:22.750
> 
> 标签：git, github

我克隆了一个 github repo，从那时起原始 repo 已经更新。我如何“克隆”新的仓库？

我很确定删除我本地的旧仓库然后重新克隆，这是错误的方法。

另外，我没有对原始克隆进行任何更改，所以我不担心丢失任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:10:00.620

如果您没有对原始文件进行任何更改，那么简单的`git pull`应该会更新您的本地存储库。

如果您是 git 新手，也许这会有所帮助：[http ://de.gitready.com/beginner/2009/01/21/pushing-and-pulling.html](http://de.gitready.com/beginner/2009/01/21/pushing-and-pulling.html)

# android - 如何更改hackerskeyboard项目的字体大小？

> ID：14714046
> 
> 赞同：0
> 
> 时间：2013-02-05T18:08:26.893
> 
> 标签：android, android-softkeyboard

我安装了[https://code.google.com/p/hackerskeyboard/](https://code.google.com/p/hackerskeyboard/)项目并将以下行添加到文件 kbd_full.xml

```
 <Row  >
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="GMAIL"
                android:keyOutputText="GMAIL"
                android:keyWidth="10.0%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="Hotmail"
                android:keyOutputText="Hotmail"
                android:keyWidth="19.0%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="YAHOO"
                android:keyOutputText="YAHOO"

                android:keyWidth="19.0%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="LIVE"
                android:keyOutputText="LIVE"
                android:keyWidth="13.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="MAIL"
                android:keyOutputText="MAIL"
                android:keyWidth="13.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="\@"
                android:keyOutputText="\@"
                android:keyWidth="12.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel=".COM"
                android:keyOutputText=".COM"
                android:keyWidth="13.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel=".CO.UK"
                android:keyOutputText=".CO.UK"
                android:keyWidth="17.0%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel=".EU"
                android:keyOutputText=".EU"
                android:keyWidth="13.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="-"
                android:keyOutputText="-"
                android:keyWidth="13.185714%p" />
            <Key
                android:horizontalGap="1.1%p"
                android:keyLabel="_"
                android:keyOutputText="_"
                android:keyWidth="13.185714%p" />
        </Row> 
```

但它看起来很大，所以我想减小这一行的字体大小，我试图改变属性 android:labelTextSize="6dp" 但没有任何反应，我怎样才能减少这个项目的字体大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T10:15:11.570

我使用以下方法解决了我的问题

```
 <Row  android:rowEdgeFlags="top"   android:keyHeight="4%p"     android:horizontalGap="1.8%p">
        <Key
             android:codes="300"

            android:keyIcon="@drawable/icon_gmail"
            android:keyOutputText="gmail"
             />
        <Key
            android:codes="301"

             android:keyOutputText="hotmail"
            android:keyIcon="@drawable/icon_hotmail" />
        <Key
             android:codes="302"

            android:keyOutputText="yahoo"
           android:keyIcon="@drawable/icon_yahoo"

            />

      <Key
           android:codes="303"

            android:keyIcon="@drawable/icon_live"
            android:keyOutputText="live"
            />
        <Key
               android:codes="304"

             android:keyIcon="@drawable/icon_mail"
            android:keyOutputText="mail"
           />
        <Key
               android:codes="305"

              android:keyIcon="@drawable/icon_at"
            android:keyOutputText="\@"
           />
        <Key
               android:codes="306"

             android:keyIcon="@drawable/icon_com"
            android:keyOutputText=".com"
            />
        <Key
               android:codes="307"

            android:keyIcon="@drawable/icon_co_uk"
            android:keyOutputText=".co.uk"
            />
        <Key
               android:codes="308"

           android:keyIcon="@drawable/icon_eu"
            android:keyOutputText=".eu"
            />
        <Key
               android:codes="309"

             android:keyIcon="@drawable/icon_dash"
            android:keyOutputText="-"
           />
        <Key
               android:codes="310"

            android:keyIcon="@drawable/icon_underscore"
            android:keyOutputText="_"
            />
     </Row> 
```

并且有图标 [https://docs.google.com/file/d/0B01ew9ECCvc8eVZYVTVzZVhvNUk/edit?usp=sharing](https://docs.google.com/file/d/0B01ew9ECCvc8eVZYVTVzZVhvNUk/edit?usp=sharing)

# ruby-on-rails - 使用 Rails 上传 AJAX 文件

> ID：14714050
> 
> 赞同：1
> 
> 时间：2013-02-05T18:08:37.987
> 
> 标签：ruby-on-rails, ajax, carrierwave

我有一个带有上传字段的表单，它显示在模式框中，当我提交它时，会显示错误而不关闭此模式，但是当发生错误并且文件字段中已经上传了一个文件时，请求在 HTML 而不是 JavaScript 中处理。有谁知道我能做些什么来解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-10T18:59:58.163

application_controller.rb

```
skip_before_action :verify_authenticity_token, if: :json_request? #add this line to json request 
```

your_action.html.erb

```
<%= form_for @object, :html => {:multipart => true}, remote: true do |f| %>
    <%= f.file_field :file%>
    <%= f.submit "Save" %>
<% end %> 
```

your_object_controller

```
@object = Object.new(object_params)

respond_to do |format|
    if @object.save
        format.js
    end
end 
```

your_action.js.erb

```
<% if remotipart_submitted? %>
    alert('submitted via remotipart');
<% else %>
    alert('submitted via native jquery-ujs');
<% end %> 
```

有关更多文档，请访问[https://github.com/JangoSteve/remotipart](https://github.com/JangoSteve/remotipart)

# css - 导航栏显示不同的 Chrome/Firefox

> ID：14714057
> 
> 赞同：0
> 
> 时间：2013-02-05T18:08:53.250
> 
> 标签：css, google-chrome

我面临一个奇怪的问题，我创建的导航栏在 Chrome 中的显示方式与在 Firefox 中不同。这是每个的屏幕截图。Firefox 正确显示它：

![火狐导航栏](../Images/aaf6c31b9978a365ca09b90e2c518829.png)

虽然背景颜色在 Chrome 中消失了：

![铬导航栏](../Images/284e37d0f68dc16ae8d14bb165517274.png)

我在[这里](http://jsfiddle.net/Nick_B/5axap/13/)创建了一个小提琴，但是当使用 Chrome 在 jsfiddle 站点上查看时问题并不明显。在实时 Chrome 浏览器中，`body`声明覆盖了导航栏的定义，即使`z-index`使用了。关于如何解决这个奇怪问题的任何想法？我现在使用旧版本的 Chrome（21.0.1180.90），试图确保向后兼容性。谢谢你的想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:04:52.287

您的代码在 OS X 10.8.2 上的“实时 Chrome 浏览器”21.0.1180.89（找不到 21.0.1180.90）中运行良好。

而且我认为您错过了以下要点`z-index`：

> 对于定位框，“z-index”属性指定：
> 
> *   当前堆栈上下文中盒子的堆栈级别。
> *   盒子是否建立堆叠上下文。

[http://www.w3.org/TR/CSS2/visuren.html#z-index](http://www.w3.org/TR/CSS2/visuren.html#z-index)

`z-index`不用于覆盖任何其他 css 声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:40:13.647

您的代码在 Chrome 版本 24 、 Firefox 和 Internet Explorer 10 中运行。也许问题只出在那个版本的 Chrome 中，或者你在其他地方覆盖了它。

# extjs - Sencha Architect：扩展 Ext.form.field.Picker

> ID：14714062
> 
> 赞同：5
> 
> 时间：2013-02-05T18:09:27.593
> 
> 标签：extjs, extjs4, sencha-architect

在 Sencha Architect 中，我想扩展`Ext.form.field.Picker`创建自定义组件。但`Ext.form.field.Picker`不在可用的工具箱元素中。我能以某种方式做到吗？

我尝试覆盖触发字段，并更改：

```
extend: 'Ext.form.field.Trigger' 
```

至

```
extend: 'Ext.form.field.Picker' 
```

但它什么也没做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-10T22:19:07.253

在您的 Sencha Architect（最好是 3.1 版）中，单击 Project Inspector 内的加号（右上角），选择 Class and View。

您将获得一个新的空类，该类从`Ext.Base`. 将扩展属性更改为`Ext.form.field.Picker`，您应该会看到一个弹出窗口，询问“您是否愿意将此类转换为 Ext.form.field.Picker，以启用完整的配置和行为”。单击是，您应该一切顺利。

# webview - pyobjc webidelegate 函数未调用

> ID：14714063
> 
> 赞同：1
> 
> 时间：2013-02-05T18:09:29.963
> 
> 标签：webview, pyobjc

我已将我的 WebView UIDelegate 链接到界面构建器中的 BrowserWindowController，这是我实现 webidelegate 功能的委托。在我的 browserwindowcontroller 类中，我也这样做：

类浏览器窗口控制器（NSWindowController）：

```
webView = objc.IBOutlet()

def windowDidLoad(self):
    self.webView.setUIDelegate_(self)

def webViewDidStartLoad_(self, webView):
    print "DID LOAD START"

def webView_didFailLoadWithError_(self, webView, error):
    print "ERROR"

def webViewDidFinishLoad_(self, webView):
    print "DID FINISH LOAD"

 def webView_shouldStartLoadWithRequest_navigationType_(self, webView, request, nav_type):
    print "LOAD REQ" 
```

作为 WebUIDelegate 一部分的最后四个函数都没有被调用。我什至尝试过（什么是正式协议，即使这是非正式的）：class BrowserWindowController(NSWindowController, WebKit.protocols.WebUIDelegate)：

但这不起作用。我已经以相同的方式实现了 WebView WebPolicyDelegate 并且它确实有效。为什么 WebUIDelegate 不起作用？我已经按照我在文档中阅读的方式链接了它。我错过了这个非正式协议的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:38:10.950

根据 Apple 的文档 (1)，委托协议没有名为 webviewDidStartLoad: 的选择器。选择器是“UIWebViewDelegate”协议，但它用于 iOS，而不是 OSX。

1： [https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/WebKit/Protocols/WebUIDelegate_Protocol/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/WebKit/Protocols/WebUIDelegate_Protocol/Reference/Reference.html)

# security - 忘记密码功能

> ID：14714065
> 
> 赞同：1
> 
> 时间：2013-02-05T18:09:35.257
> 
> 标签：security, passwords, change-password

我已经搜索并查看了有关在网站上实现忘记密码功能的大多数其他问题和答案。

但是，我们有一个独特的情况。当用户注册并使用其基于公司的电子邮件作为主要电子邮件帐户时，如果他们不再为该公司工作并且无法访问该帐户，如何实施忘记密码方案？

我们目前向他们的主电子邮件帐户发送一封带有重置链接的电子邮件。大多数人没有辅助帐户，我们不希望他们能够输入任何电子邮件地址来发送链接。

是否有一个简单的方案，我们可以让用户输入一些信息并被带到允许他们更改电子邮件地址以发送重置链接的页面？顺便说一句，我们不想使用/存储安全问题。

这种事情以前是怎么做的？我真的看不到任何这样做的网站，因为它们中的大多数都需要向用户的帐户发送电子邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:22:41.477

如果您不想在注册时要求用户提供备用电子邮件、安全问题或 SMS/手机号码，那么您将被那些拥有孤立帐户的用户所困。

您可以尝试以下方法，但用户仍然会忘记将其打印出来或不在乎。

*   当用户注册时，给他们一个一次性使用的“秘密令牌”（基本上是一个序列号）
*   *   告诉他们打印出来并妥善保管
*   *   允许他们使用“秘密令牌”来重置他们的电子邮件地址
*   *   一旦他们验证了他们的新电子邮件地址，删除旧的“秘密令牌”并向他们发送一个新的

# facebook - 使用 facebook api 从用户错误中获取生日和位置

> ID：14714072
> 
> 赞同：0
> 
> 时间：2013-02-05T18:10:24.550
> 
> 标签：facebook, facebook-graph-api

我在这里也试过搜索： [https ://developers.facebook.com/docs/howtos/login/signed-request/](https://developers.facebook.com/docs/howtos/login/signed-request/)

我的代码运行良好，我需要获取我的应用程序用户的生日和位置。所以我在范围内添加了：

```
https://www.facebook.com/dialog/oauth/?client_id='.$appId.'&redirect_uri=https://www.facebook.com/'.$pagename.'?sk=app_'.$appId.'&scope=email,publish_stream,user_location,user_birthday 
```

并尝试获取两个额外的字段，如下所示：

```
$first_name = $me['first_name']; 
$last_name = $me['last_name']; 
$email = $me['email']; 
$age = $me['birthday']; 
$location = $me['location']; 
```

3个第一个工作但不是生日，打印位置时我得到“数组”

# php - Mac localhost 上的 Laravel 4：找不到 SQLSRV 的驱动程序

> ID：14714074
> 
> 赞同：3
> 
> 时间：2013-02-05T18:10:37.473
> 
> 标签：php, macos, laravel, laravel-4

我正在尝试将 Laravel 4 连接到 SQL Server 数据库。我收到一个错误，但我认为这是一个 PHP 错误，而不是 Laravel 错误。它说`PDOException: could not find driver`。我将驱动程序设置为`sqlsrv`喜欢文件中的另一个示例`database.php`。就像我说的，我认为这是一个 PHP 错误，而不是 Laravel。

我在我的 Mac 上的本地主机上。我需要在我的`php.ini`文件中配置一些东西吗？我发现[另一篇文章](http://forums.laravel.io/viewtopic.php?id=2291)说我需要在 PDO 下注释掉一个 MySQL 驱动程序。我也无法在我的`php.ini`. 但无论如何，我还需要连接到 MySQL 数据库。我需要在我的`php.ini`文件中更改什么？

我发现这一行：

`pdo_mysql.cache_size = 2000`

但是即使在重新启动 Apache 之后，将其注释掉也无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-09T00:15:31.010

根据 PHP 手册 (www.php.net/manual/en/sqlsrv.requirements.php)，sqlsrv 驱动程序是仅限 Windows 的驱动程序。因此，您不能在 Mac、Linux、Unix 或任何其他操作系统上使用该驱动程序，而不是该页面上列出的那些。

我假设您正在尝试连接到某个地方的远程 SQL Server？如果你在 Mac 上，那么 SQL Server 就不会在你的本地机器上运行，所以我想第一个问题是你是否有一个 SQL Server 在某个地方运行。

其次，从运行 PHP 的服务器，您需要使用 FreeTDS 或 ODBC 与 FreeTDS 进行连接。

由于 Laravel 4 使用 PDO，你需要安装 FreeTDS 和 ODBC。Laravel 4 不使用 mssql PHP 扩展。它使用 PDO，因此 mssql 不会让您使用 Laravel 4。

如果您从 Mac 提供 PHP，我想说通常有 4 种不同的方式可以使用：

1.  简单但昂贵的方法：访问 (www.macupdate.com/app/mac/23152/openlink-odbc-driver-for-sybase) 并下载并安装 OpenLink ODBC 驱动程序。这允许您在 XNIX 机器上使用 Sybase (MSSQL) 驱动程序创建新的 ODBC 连接。这里有一个安装演练 (wikis.openlinksw.com/dataspace/owiki/wiki/UdaWikiWeb/InstallSybaseExpressOSX)。它带有 15 天的试用期，之后您必须购买它。在撰写本文时，它的成本似乎在 30 美元到 50 美元之间，具体取决于您选择的许可证。

2.  更难但免费的方法：按照[http://blog.benjaminwalters.net/?p=10](http://blog.benjaminwalters.net/?p=10)（稍微过时）将 FreeTDS 支持重新编译到 Mac 上的 PHP 中（假设您使用的是 MAMP）

3.  更好，但工作量更大的方法：找到像 VMWare Fusion 这样的虚拟机主机软件，并安装像 Ubuntu 12.4 这样的 Linux 服务器。确保在安装过程中安装 apache2 和 PHP，然后按照[此处](http://davejamesmiller.com/blog/connecting-php-to-microsoft-sql-server-on-debian-ubuntu)的步骤让 FreeTDS 在您的新服务器机器上运行。

4.  从运行 SQL Server 的 Windows Server 运行 PHP

里程数会因每种解决方案而异，并且无论如何都有一个学习曲线。我从事 PHP 开发已经有很长时间了，我花了好几天的时间才弄清楚如何从 Linux 第一次连接到 SQL Server。值得庆幸的是，现在有很多演练，从那时起，FreeTDS 已经走了很长一段路。

希望有帮助。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-07T13:23:54.217

我实际上在我的设置上运行了这个。我最好的建议是乘坐[Homebrew](http://brew.sh/)巴士。

[https://github.com/josegonzalez/homebrew-php](https://github.com/josegonzalez/homebrew-php)是您要查找安装 PHP 和相关项目的地方。我不记得我到底做了什么，但这并不是特别困难。

首先你需要 FreeTDS。

```
brew install freetds 
```

然后，将[Jose 的](https://github.com/josegonzalez/homebrew-php)公式添加到您的自制程序中（github 页面上的说明）。在那之后，

```
brew install php5x --with-mssql  

brew options php5x 
```

如果您需要更多扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T17:26:53.013

根据乔恩沃森的评论，

我已经尝试了第2步，但它不起作用。在这里检查我的问题[https://github.com/laravel/laravel/issues/2180](https://github.com/laravel/laravel/issues/2180)

第 3 步是断开的链接，我认为它与第 2 步相同。

我还尝试了 Laravel 的 linux ODBC 驱动程序（有 2 个，google it），**两者都不起作用**。虽然我的简单测试 php 在 DBLIB 和 ODBC 中都可以工作（使用官方的 microsoft odbc unix 驱动程序编译）。

第 4 步绝对有效，但您必须使用 IIS 以获得最佳稳定性。

这留下了第 1 步。或者，

抛弃 Laravel4 并使用自 2006 年以来我一直在使用的良好的 AdoDB [http://adodb.sourceforge.net/](http://adodb.sourceforge.net/)并且仍然可以出色地工作（尽管不像 Laravel 那样现代）使用[http://docs.moodle 中的教程对其进行配置。 org/20/en/Installing_MSSQL_for_PHP](http://docs.moodle.org/20/en/Installing_MSSQL_for_PHP)

我想知道为什么他们也不为 linux 构建 sqlsrv 驱动程序......

# css - WebKit / Mozilla 浏览器中的奇怪 CSS 选择器覆盖问题（至少）

> ID：14714078
> 
> 赞同：0
> 
> 时间：2013-02-05T18:10:53.770
> 
> 标签：css, css-selectors

我遇到了一个奇怪的选择器覆盖问题。我正在尝试覆盖`.request-desc-download`下面 HTML/CSS 中类的 padding-left。添加其他类似乎没有帮助。

**教义**

```
<!DOCTYPE html> 
```

**HTML**

```
<ul class="letter-list">
    <li>
        <dl class="pers-data">
            <dt>Person:</dt>
            <dd>John Doe</dd>
        </dl>
        <span class="request-desc request-desc-download">
            <a href="#">Download</a>
        </span>
    </li> 
```

**CSS：**

```
.letter-list .request-desc{
    padding-bottom: 12px;
    padding-left: 25px;
    background: url(../img/icons-request-desc.gif) no-repeat 0 5px;
}
.letter-list > li .request-desc-download{
    background-position:0 -55px;
    padding-left:18x !important;
} 
```

**我尝试过的选择器：**

```
.letter-list > li .request-desc-download
.letter-list li span.request-desc-download
body .letter-list .request-desc-download 
```

他们都没有修复`.request-desc-download`类左侧的填充。有什么想法吗？唯一可行的方法是将其添加`padding-left`到`style`实际跨度的属性中，我不想这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:15:25.443

你写`18x`的不是`18px`!

它工作得很好：http: [//jsfiddle.net/Qcfah/](http://jsfiddle.net/Qcfah/)

```
.letter-list .request-desc{
    padding-bottom: 12px;
    padding-left: 25px;
}
.letter-list > li .request-desc-download{
    padding-left: 18px;
} 
```

# asp.net-mvc - 如何从 SelectList 中获取选定的文本

> ID：14714079
> 
> 赞同：2
> 
> 时间：2013-02-05T18:10:56.000
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在为具有以下签名的下拉列表创建自定义帮助器方法：

```
public static MvcHtmlString MyCustomDropDownListFor<TModel, TProperty>(this HtmlHelper<TModel> html, Expression<Func<TModel, TProperty>> expression, IEnumerable<SelectListItem> selectList, string optionLabel, object htmlAttributes) 
```

在该方法中，我可以执行以下操作来获取所选值：

```
var Value = ((SelectList)selectList).SelectedValue); 
```

在我的辅助方法中，我还需要找出所选文本是什么，而不仅仅是值。我将如何得到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:39:51.527

如果您已经选择了值，则可以遍历`IEnumerable`尝试查找 selected `SelectListItem`：

```
 SelectListItem[] items = selectList.ToArray();
        SelectListItem selectedItem = items.FirstOrDefault(i => i.Value == valueAsString) 
            ?? items[0];
        string selectedText = selectedItem.Text; 
```

在我看来，转换`SelectList`为不是找到选定值的最佳选择，`InvalidCastException`当变量的真实类型`selectList`不是`SelectList`.

在大多数情况下，您的模型包含一个应在下拉列表中选择的值。您可以使用以下类获取此值`ModelMetadata`：

```
 //Get value from model or from ModelState
        object modelValue = ModelMetadata
             .FromLambdaExpression(expression, html.ViewData).Model;

        SelectListItem[] items = selectList.ToArray();

        string selectedValue = modelValue == null ? null : modelValue.ToString();

        SelectListItem selectedItem = items.FirstOrDefault(i => i.Value == selectedValue) 
            ?? items.FirstOrDefault();

        string selectedText = selectedItem == null ? null : selectedItem.Text;

        //Rest code goes here 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-07T00:31:06.343

```
 public static string getText(SelectList selectList)
  {            
    string text =  selectList.Where(x => x.Selected).FirstOrDefault().Text;
    return text; 
  } 
```

# ruby-on-rails - 无法在 ruby 代码中的字符串中保留反斜杠

> ID：14714081
> 
> 赞同：1
> 
> 时间：2013-02-05T18:11:00.000
> 
> 标签：ruby-on-rails, ruby, slash

我的 ruby​​ 代码中有一个以反斜杠结尾的字符串：

```
acc.secret_key = "ASJSJJDSJFJJFFJJFJF\"
acc.save 
```

以上是代码片段，当我尝试使用活动记录保存它时出现错误，我尝试添加另一个斜杠

```
acc.secret_key = "ASJSJJDSJFJJFFJJFJF\\"
acc.save 
```

但现在我在数据库中有两个斜线。我错过了什么？多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:58:50.047

您在控制台中看到了吗？如果是这种情况，您只是看到转义而不是两个实际的反斜杠。

```
string = "1234\\" 
# => "1234\\"
string.length 
# => 5 (if there were two \\'s the length would be 6)
string 
# => "1234\\"
puts string
# 1234\
# => nil 
```

如果您在数据库控制台中查找带有转义反斜杠的记录，您应该会看到一个反斜杠。

```
tests_development=> select * from tests WHERE tests.id = 1;
 id |      name       |         created_at         |         updated_at         | public 
----+-----------------+----------------------------+----------------------------+--------
  1 | this is a test\ | 2013-02-05 21:44:12.339854 | 2013-02-05 21:44:12.339854 | t
(1 row) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:15:07.350

```
acc.secret_key = "ASJSJJDSJFJJFFJJFJF//".to_string
acc.save 
```

这会将带有反斜杠的字符串推送到数据库中

# css - 悬停时不显示背景颜色

> ID：14714082
> 
> 赞同：0
> 
> 时间：2013-02-05T18:11:02.430
> 
> 标签：css, background-color

我正在开发一种新的响应式设计，但我的菜单出现了我无法弄清楚的问题。基本上，当您将鼠标悬停在菜单项上时，我希望菜单项的背景变为白色，文本变为蓝色。现在，文本变为蓝色，但背景不会变为白色。

HTML 代码：

```
<div class="header">
  <div class="header_content">
    <div class="logo">
      <img src="images/new_logo.png" class="hdr_logo">
    </div>
    <div class="main_menu">
      <ul>
        <li>ABOUT US</li>
        <li>OPERATIONS BRANCH</li>
        <li>LOGISTICS BRANCH</li>
        <li style="border-right:0;">COMMUNITY</li>
      </ul>
    </div>
  </div>
</div> 
```

CSS：

```
 .header {
    background: url('images/header2.png') repeat-x top left;
    width: 100%;
    height: 150px;
    color: #FFF;
    margin: 0;
    padding: 0;
  }

  .header_content {
    width: 960px;
    margin: 0 auto;
    height: 150px;
    padding: 0; 
  }

  .logo {
    float:left;
    width:120px;
  }

  .main_menu {
    float:left;
    height: 30px;
    margin-top: 120px;
    line-height: 30px;
    padding: 0;
    width: 830px;
  }

  .main_menu ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
    text-align: center;
    overflow: hidden;
    height: 30px;
  }

  .main_menu li {
    float: left;
    border-right: 1px solid #FFF;
    text-align: center;
    padding: 0;
    margin: 0;
    padding-left: 2%;
    padding-right: 2%;
    overflow: hidden;
    height: 30px;
    cursor: pointer;
  }

  .main_menu li:hover {
    background-image: none;
    background-color: #FFF;
    color: rgb(33,47,57);
  } 
```

**编辑：问题已解决**

浮动的 li 不是块元素，因此您无法更改它的背景颜色。一旦我添加`display:block;`到 li ，它就解决了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:21:46.083

对我来说似乎工作正常：http: [//jsfiddle.net/s3JT9/](http://jsfiddle.net/s3JT9/)

```
.main_menu li:hover {
background-image: none;
background-color: #FFF;
color: red;
} 
```

我将颜色更改为红色以进行说明。

# java - 在 2 部手机之间建立连接

> ID：14714083
> 
> 赞同：-1
> 
> 时间：2013-02-05T18:11:12.893
> 
> 标签：java, android, android-networking

我想在定义为电话 A 和电话 B 的两部电话之间建立连接。

A 询问 B 的位置，然后 B 生成其位置并将其发送给 A。

我知道如何生成位置，但是如何在 A 和 B 之间建立连接？需要数据库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:21:51.600

通常你需要一个中间的服务器。如果你想在没有服务器的情况下完成这项工作，你必须让其中一部手机成为服务器，但目前运营商会阻止所有传入连接，因此你的手机无法相互连接。所以设置一个服务器，让2部手机连接到它，然后传输位置数据。

# c# - 在 JSON.NET 中使用未知属性名解析 JSON

> ID：14714085
> 
> 赞同：13
> 
> 时间：2013-02-05T18:11:20.563
> 
> 标签：c#, json, parsing, json.net

我有一些 JSON 数据，如下所示：

```
{
   "response":{
   "_token":"StringValue",
   "code":"OK",
   "user":{
     "userid":"2630944",
     "firstname":"John",
     "lastname":"Doe",
     "reference":"999999999",
     "guid":"StringValue",
     "domainid":"99999",
     "username":"jdoe",
     "email":"jdoe@jdoe.edu",
     "passwordquestion":"",
     "flags":"0",
     "lastlogindate":"2013-02-05T17:54:06.31Z",
     "creationdate":"2011-04-15T14:40:07.22Z",
     "version":"3753",
     "data":{
       "aliasname":{
         "$value":"John Doe"
       },
       "smsaddress":{
         "$value":"5555555555@messaging.sprintpcs.com"
       },
       "blti":{
         "hideemail":"false",
         "hidefullname":"false"
       },
       "notify":{
         "grades":{
            "$value":"0"
          },
          "messages":{
            "$value":"1"
          }
       },
       "beta_component_courseplanexpress_1":{
         "$value":"true"
       }
    }
  }
} 
```

我使用 C# 和 JSON.NET 来解析数据。我已经能够使用此算法成功获取数据：

```
User MyUser = new User();
JToken data = JObject.Parse(json);
MyUser.FirstName = (string) data.SelectToken("response.user.firstname");
//The same for all the other properties. 
```

问题出在`data`球场上。该字段主要基于用户偏好，并且仅在使用时插入数据。这些字段都是自定义的，开发人员可以不受限制地输入任意数量的字段。本质上，它都是自由形式的数据。此外，正如您所注意到的，它们可以与数据嵌套得很远。

我试图运行：

```
MyUser.Data = JsonConvert.DeserializeObject<List<JToken>>((string) data.SelectToken("response.user.data"); 
```

这是行不通的。

您将如何将其转换为在 C# 对象中使用？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T18:23:11.490

您可以通过`JToken`//方法访问它`JArray`。`JObject`例如，这将列出数据下的所有键：

```
public class StackOverflow_14714085
{
    const string JSON = @"{
                          ""response"": {
                            ""_token"": ""StringValue"",
                            ""code"": ""OK"",
                            ""user"": {
                              ""userid"": ""2630944"",
                              ""firstname"": ""John"",
                              ""lastname"": ""Doe"",
                              ""reference"": ""999999999"",
                              ""guid"": ""StringValue"",
                              ""domainid"": ""99999"",
                              ""username"": ""jdoe"",
                              ""email"": ""jdoe@jdoe.edu"",
                              ""passwordquestion"": """",
                              ""flags"": ""0"",
                              ""lastlogindate"": ""2013-02-05T17:54:06.31Z"",
                              ""creationdate"": ""2011-04-15T14:40:07.22Z"",
                              ""version"": ""3753"",
                              ""data"": {
                                ""aliasname"": {
                                  ""$value"": ""John Doe""
                                },
                                ""smsaddress"": {
                                  ""$value"": ""5555555555@messaging.sprintpcs.com""
                                },
                                ""blti"": {
                                  ""hideemail"": ""false"",
                                  ""hidefullname"": ""false""
                                },
                                ""notify"": {
                                  ""grades"": {
                                    ""$value"": ""0""
                                  },
                                  ""messages"": {
                                    ""$value"": ""1""
                                  }
                                },
                                ""beta_component_courseplanexpress_1"": {
                                  ""$value"": ""true""
                                }
                              }
                            }
                          }
                        }";

    public static void Test()
    {
        var jo = JObject.Parse(JSON);
        var data = (JObject)jo["response"]["user"]["data"];
        foreach (var item in data)
        {
            Console.WriteLine("{0}: {1}", item.Key, item.Value);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-02-05T18:19:06.833

如果这对您有用，Json.NET 实际上可以解析为动态。这意味着你可以做类似的事情。

```
dynamic parsedObject = JsonConvert.DeserializeObject("{ test: \"text-value\" }");

parsedObject["test"]; // "text-value"
parsedObject.test; // "text-value"
parsedObject.notHere; // null 
```

编辑：如果您不知道自己在寻找什么，可能更适合您迭代值。

```
dynamic parsedObject = JsonConvert.DeserializeObject("{ test: { inner: \"text-value\" } }");
foreach (dynamic entry in parsedObject)
{
    string name = entry.Name; // "test"
    dynamic value = entry.Value; // { inner: "text-value" }
} 
```

# sql - SQL Server - 包含多个值

> ID：14714088
> 
> 赞同：0
> 
> 时间：2013-02-05T18:12:09.377
> 
> 标签：sql, sql-server, tsql

我需要使用 SELECT 检索列的值。但是，我有多个值......我不知道用户在复选框中选择什么......

前任：

```
**Insert Into MyTable (dados) Values ('a1')** 
```

我想要结果 = Angulo 1

```
**Insert Into MyTable (dados) Values ('a2';'a3')** 
```

我想要结果 = Angulo 2

```
**Insert into MyTable (dados) Values ('a3'; a1)** 
```

我想要结果 = Angulo 3; 安古洛 1

```
**Insert into MyTable (dados) Values ('a6'; 'a7'; 'a4')** 
```

我想要结果 = Angulo 6; 安古洛 7；安古洛 4

我正在尝试 SELECT CASE WHEN。但它仍然失败......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:19:13.353

当你说：

```
 insert into MyTable(dados)
    Values ('a6', 'a7', 'a4') 
```

您是在说“我有一列可以将数据放入称为 dados 的列”。然后，您将提供三个值。这在任何数据库中都会失败（即使分号应该是逗号这一事实除外）。

也许你想要：

```
insert into MyTable(dados)
    Values ('a6;a7;a4') 
```

那只是一个值，一个字符串。

这表明了一个非规范化的数据库。您可能需要一个表中的三个不同的行，每个值一个，通过某个键连接在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:24:31.487

我怀疑你在问如何在你的陈述中使用`IN`关键字？`SELECT`有点不清楚您要做什么。

尝试这个：

```
SELECT * 
FROM MyTable
WHERE dados IN ('a6','a7','a4') 
```

假设您有一个名为 MyTable 的表和一个名为 dados 的列，该表中有 3 行用于 a6、a7 和 a4，这将返回所有匹配项（在本例中为所有三行）。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:29:31.467

如果您使用的是 sql server 2008 及更高版本，以下是一些示例：

if(OBJECT_ID('tempdb..#dados') 不为空) DROP TABLE #dados

select top 100 * INTO #dados FROM ( values(1,2,3), (4,5,6), (7,8,9) ) t(a,b,c)

选择 * FROM #dados

插入 #dados (a,b,c) 值 (11,22,33), (44,55,66), (77,88,99)

从#dados中选择*

插入 #dados (a,b,c) SELECT * FROM (值(111,222,333), (444,555,666), (777,888,999)) t(a,b,c)

从#dados中选择*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T18:31:29.140

如果要插入多行（不是列），语法是

```
Insert Into 
MyTable (dados) 
Values 
('a1'), 
('a2') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T18:40:30.743

看起来你想问两件事。

如何插入多个值将通过以下方式完成：

```
Insert Into MyTable (dados) Values ('a6'),('a7'),('a4') 
```

如果要返回实际值 'Angulo' + 数字，可以使用以下命令：

```
CREATE TABLE MyTable 
(
    Dados varchar(255)
)   

Insert Into MyTable (dados) Values ('a12') 
Insert Into MyTable (dados) Values ('a2'),('a3')
Insert Into MyTable (dados) Values ('a3'),('a1') 
Insert Into MyTable (dados) Values ('a6'),('a7'),('a4') 

SELECT 'Angulo'+ SUBSTRING(dados,PATINDEX('%[0-9]%',dados),LEN(dados))
FROM MyTable 
```

它将找到第一个数字（假设它始终是您所追求的第一个数字）并获取其余数字。然后它会附加前缀“Angulo”（例如 Angulo1、Angulo7 等）

如果这些不是你所追求的。请你能进一步解释你需要什么。

# javascript - 使用 Javascript 写入系统文件

> ID：14714090
> 
> 赞同：0
> 
> 时间：2013-02-05T18:12:13.237
> 
> 标签：javascript, macos

我正在使用一个 API，其功能只能使用 Javascript（轻松）访问，但我想使用 API 将 .txt 文件保存到我的服务器。有没有办法在 Mac OSX 机器上实现这一点？我知道禁止在浏览器中运行的 JS 这样做，所以我想这实际上是一个两部分的问题：（1）在 Mac OSX 上运行 10 行 JS 脚本的最简单方法是什么以及（2）我将如何编写数据到一个txt文件这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:28:41.767

`headless browser`例如，您可以选择[PhantomJS](http://phantomjs.org)。我没用过，但是应该可以很好的运行JS。

但是，同样的限制也适用，没有来自 JS 的文件系统访问。除非您使用 FF 中的插件框架之类的东西，否则在这种情况下您对脚本具有更高的权限。

除此之外，您可以用 php、perl 或其他语言创建一个包装器，并通过 ajax 调用将数据从 JS 传递给它们，它们会为您编写 txt。

# spring - Spring 3.2 AOP - 通过注解拦截方法

> ID：14714092
> 
> 赞同：7
> 
> 时间：2013-02-05T18:12:28.510
> 
> 标签：spring, annotations, aop

我正在尝试拦截任何带有自定义注释标记的方法，您阅读此内容的原因是因为我无法让它工作。我一直在关注简单的示例，但无法使其正常工作。

这是我的代码。

**MyAnnotation.java：**

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface MyAnnotation {
  String value() default "";
  String key() default "";
  String condition() default "";
} 
```

**MyAspect.java：**

```
@Aspect
public class MyAspect {

  @Pointcut(value="execution(public * *(..))")
  public void anyPublicMethod() { }

  @Around("anyPublicMethod() && @annotation(myAnnotation)")
  public Object process(ProceedingJoinPoint jointPoint, MyAnnotation myAnnotation) throws Throwable {
    System.out.println("In AOP process");
    return 5; //jointPoint.proceed();
  }
} 
```

**弹簧配置.xml：**

```
<beans xmlns="http://www.springframework.org/schema/beans"
           xmlns:mvc="http://www.springframework.org/schema/mvc"
           xmlns:c="http://www.springframework.org/schema/c"
           xmlns:context="http://www.springframework.org/schema/context"
           xmlns:tx="http://www.springframework.org/schema/tx"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:aop="http://www.springframework.org/schema/aop"
           xmlns:p="http://www.springframework.org/schema/p"
           xmlns:cache="http://www.springframework.org/schema/cache"
           xmlns:task="http://www.springframework.org/schema/task"
           xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
           http://www.springframework.org/schema/mvc
           http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-3.2.xsd
           http://www.springframework.org/schema/tx
           http://www.springframework.org/schema/tx/spring-tx-3.2.xsd
           http://www.springframework.org/schema/aop 
           http://www.springframework.org/schema/aop/spring-aop-3.2.xsd
           http://www.springframework.org/schema/cache 
           http://www.springframework.org/schema/cache/spring-cache-3.2.xsd
           http://www.springframework.org/schema/task
           http://www.springframework.org/schema/task/spring-task-3.2.xsd">

    ...

  <context:component-scan base-package="com.myapp">
    <context:include-filter type="annotation" expression="org.aspectj.lang.annotation.Aspect"/>
  </context:component-scan>

  <aop:aspectj-autoproxy proxy-target-class="true" />
  <bean id="myAspect" class="com.myapp.annotation.MyAspect" />

    ... 
```

**我的组件.java：**

```
@Component
public class MyComponent {
  @MyAnnotation(value="valtest", key="keytest", condition="contest")
  public int add(int i, int j) {
    System.out.println("Executing annotation.add");
    return i+j;
  }
} 
```

测试代码：

```
final MyComponent m = new MyComponent();
assertTrue(5 == m.add(0, 1)); // Here m.add(...) always returns 1 instead of 5. 
```

作为旁注，我尝试以多种不同的方式定义我的切入点，无论是否使用 anyPublic() 方法及其执行切入点，但这些都不适合我：

1.  `@Around("@annotation(com.myapp.annotation.MyAnnotation)") public Object process(ProceedingJoinPoint jointPoint) throws Throwable { .. }`

2.  `@Around(value="@annotation(myAnnotation)", argNames="myAnnotation") public Object process(ProceedingJoinPoint jointPoint, MyAnnotation myAnnotation) throws Throwable { .. }`

3.  `@Around("execution(* com.myapp.*.*(..)) && @annotation(com.myapp.annotation.MyAnnotation)") public Object process(ProceedingJoinPoint jointPoint) throws Throwable { .. }`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T18:16:33.353

在您的测试代码中，您不允许 Spring 创建您的`MyComponent`，而是使用`new`运算符。您应该`MyComponent`从 Spring 的`ApplicationContext`.

```
public class SomeTest {
    public static void main(String[] args) throws Exception {
        final ApplicationContext appContext = new ClassPathXmlApplicationContext("spring-config.xml");
        final MyComponent myComponent = appContext.getBean(MyComponent.class);
        //your test here...
    }
} 
```

如果你没有从 Spring 获取你的组件，你希望它如何被代理？

# facebook - Facebook 在 404 链接上请求 {url}/no_facebook_preview_picture.jpg

> ID：14714094
> 
> 赞同：10
> 
> 时间：2013-02-05T18:12:36.393
> 
> 标签：facebook, web-crawler, facebook-wall

我们运行了一个 URL 缩短器，在过去一周左右，我们开始看到`{normal url}/no_facebook_preview_picture.jpg`来自 Facebook 拥有的 IP 和用户代理的许多奇怪请求`facebookexternalhit/1.0 (+http://www.facebook.com/externalhit_uatext.php)`

如果我在墙上发布了指向我们网站的正常链接（设置为`Only Me`我可以测试），我会在访问日志中看到以下条目

```
66.220.152.6 - - [05/Feb/2013:16:31:36 +0000] "GET /44_U HTTP/1.1" 200 1314 "-" "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "-" 
```

但是，如果我发布返回 404 或 410 的链接（创建后删除垃圾邮件链接），我会得到这个

```
69.171.237.15 - - [05/Feb/2013:16:49:16 +0000] "GET /notexistURL HTTP/1.1" 404 1319 "-" "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "-" 
```

然后在一个小时左右

```
173.252.110.113 - - [05/Feb/2013:17:15:15 +0000] "GET /notexistURL/no_facebook_preview_picture.jpg HTTP/1.1" 404 0 "-" "facebookexternalhit/1.0 (+http://www.facebook.com/externalhit_uatext.php)" "-" 
```

该 IP 的 WhoIs 报告

```
NetName FACEBOOK-INC
NetHandle   NET-173-252-64-0-1 
```

所以它们绝对是 Facebook 的 IP。

我们每天会收到大约 10 到 20 个这样的请求，而且都是一样的。我们只能取回 7 天的日志文件，但这些请求是在 7 天前发生的。

我已经测试了唯一的链接，因此没有其他方法可以找到该链接。我个人不太使用 Facebook，除了我的测试链接之外的所有链接都是由其他用户创建/发布的，但我认识到所有链接到我的 Facebook 帐户的应用程序并且没有什么异常，所以我认为这不是第 3 方应用程序（如果需要，我可以提供一个列表，但它们都是大牌应用程序）

在我检查日志文件的过程中，Facebook 似乎并没有智能地创建这些请求，它只是盲目地将字符串粘贴在`/no_facebook_preview_picture.jpg`URL 的末尾，即使是查询字符串也是如此。例如;

```
69.171.228.114 - - [05/Feb/2013:17:19:13 +0000] "GET /iAmNotARealURL1234777?ref=fb&cows_go=moo HTTP/1.1" 404 1118 "-" "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "-"
69.171.228.114 - - [05/Feb/2013:17:19:13 +0000] "GET /iamnotarealurl1234777 HTTP/1.1" 404 1118 "-" "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "-"
173.252.103.4 - - [05/Feb/2013:17:44:41 +0000] "GET /iAmNotARealURL1234777?ref=fb&cows_go=moo/no_facebook_preview_picture.jpg HTTP/1.1" 404 1118 "-" "facebookexternalhit/1.1 (+http://www.facebook.com/externalhit_uatext.php)" "-" 
```

谷歌似乎显示了很多随机结果，主要来自链接发起者，但我找不到任何关于这些请求是什么的信息。

这些要求是什么？Facebook 需要它们做什么？这是我们的应用程序中的错误还是可以安全地忽略这些请求？

更新：

有时我们现在对这些 URL 有 2-300 次点击

```
[sr@ns309372 nginx]$ for DAYLOG in `find ./ | grep "dftbashort.log-"`; do COUNT=`cat $DAYLOG | grep no_facebook_preview_picture | wc -l`; echo "${DAYLOG} has ${COUNT} occurences"; done
./dftbashort.log-20130201 has 0 occurences
./dftbashort.log-20130130 has 2 occurences
./dftbashort.log-20130129 has 2 occurences
./dftbashort.log-20130128 has 2 occurences
./dftbashort.log-20130202 has 378 occurences
./dftbashort.log-20130207 has 222 occurences
./dftbashort.log-20130205 has 257 occurences
./dftbashort.log-20130209 has 178 occurences
./dftbashort.log-20130131 has 2 occurences
./dftbashort.log-20130203 has 266 occurences
./dftbashort.log-20130206 has 667 occurences
./dftbashort.log-20130204 has 12 occurences
./dftbashort.log-20130127 has 4 occurences
./dftbashort.log-20130208 has 260 occurences 
```

我们不提供任何开放图元标记，并且该页面除了元/javascript 重定向之外没有其他内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T15:33:52.737

我很确定这是试图构建 URL 预览的共享抓取工具，通过[Facebook 的调试工具](https://developers.facebook.com/tools/debug)运行 URL ，你会看到 Facebook 看到/正在寻找什么

我不确定`/notexistURL/no_facebook_preview_picture.jpg`请求是什么，假设您的代码中没有任何内容指向这样的 URL；如果我不得不猜测，我会说这是在没有元标记时使用的某种默认或后备；可能是一个错误 - 如果您为 Facebook 包含正确的元标记，我相当有信心，它会抓取这些而不发出无效请求，并且您的 URL 共享在 Facebook.com 和其他支持的网站上看起来更好的额外好处相同的标签

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-14T14:47:36.570

今天早上我遇到了同样的事情并做了一些挖掘。您可以使用[本网站](http://johnliu.net/blog/2013/9/10/fixing-facebook-preview-picture-of-your-sharepoint-site.html)上的信息来帮助指导您朝着正确的方向前进。似乎有助于我的网站被这些错误杀死。

# php - 如何编辑 htacess 文件以支持文件上传

> ID：14714095
> 
> 赞同：0
> 
> 时间：2013-02-05T18:12:43.933
> 
> 标签：php, .htaccess, file-upload, webserver

我有一个用 php 编写的示例图片上传代码。ios 开发人员调用 Web 服务。文件上传适用于一台服务器，但无法在另一台服务器上上传。

检查权限、目录列表等。在尝试上传图像时，服务器会抛出 500 内部错误。

我认为 .htaccess 可能存在问题

任何人都可以指导我编辑 htaccess 以便它支持图像上传。

谢谢你。通过浏览器上传时，文件上传工作正常。它没有返回任何错误

这是错误日志 PHP Warning: fopen(xml/) [function.fopen]: failed to open stream: No such file or directory in /home/appsimon/public_html/api/import.php on line 271

实际上直到上周它都在这台服务器上工作。突然文件上传失败

htaccess 中的代码

```
#old php Handler
#deny from all 
#allow from ip address 
```

只有这 3 条注释行来自应用程序控制台的错误

```
 <Warning>: aResponse:<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
 <html><head>
 <title>500 Internal Server Error</title>
 </head><body>
 <h1>Internal Server Error</h1>
 <p>The server encountered an internal error or
 misconfiguration and was unable to complete
 your request.</p>
 <p>Please contact the server administrator,
  webmaster@appsimon.com and inform them of the time the error occurred,
 and anything you might have done that may have
 caused the error.</p>
 <p>More information about this error may be available
 in the server error log.</p>
 <p>Additionally, a 500 Internal Server Error
 error was encountered while trying to use an ErrorDocument to handle the request.</p>
 </body></html>
Feb  6 00:30:48 Varmas-iPhone SNMC[1944] <Warning>: -JSONValue failed. Error trace is: (
     "Error Domain=org.brautaset.JSON.ErrorDomain Code=3 \"Unrecognised leading character\" UserInfo=0x541a40 {NSLocalizedDescription=Unrecognised leading character}"
 )
Feb  6 00:30:49 Varmas-iPhone SNMC[1944] <Warning>: fail 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:54:06.730

在你的 htaccess 中尝试添加这些值，看看会发生什么

```
php_value upload_max_filesize 100M
php_value post_max_size 100M
php_value max_execution_time 180
php_value max_input_time 180 
```

根据需要调整值

# php - 如果条件是具有节 id 的 CSS 类

> ID：14714096
> 
> 赞同：3
> 
> 时间：2013-02-05T18:12:45.243
> 
> 标签：php, css, if-statement

我正在尝试在 HTML 部分 id 代码的帮助下编辑“浏览到”时显示文本的方式。这是我的代码片段：

```
<span class="headerqmain"><ul><li><a href="#ID001">Question</a></ul></li></span>

<section id="ID001"></section>
<span class="headerq">Question repeated</span>
<span class="answerq">Answer to the question</span> 
```

请注意，有 100 多个问题，页面底部的答案很长。这意味着当有人点击问题时，他们会转储到一个包含相同问题的列表及其下方的答案。（这是一个常见问题解答部分）。但很难只见树木不见森林。

所以我的目标是标记被点击的问题+答案。也许用颜色标记它，或者用更大的文本大小。任何人都知道在这种情况下是否可以在 CSS 上使用条件？记住它在同一页上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:04:14.060

跳转到时可以对标记执行的操作的示例代码：

```
:target .headerq { /* :target would refer to #ID001 in this case */
    font-size: 1.5em;
    color: blue;
}
:target .answerq {
    color: blue;
} 
```

[http://css-tricks.com/on-target/](http://css-tricks.com/on-target/)有关此技术的更多信息。另请查看[http://37signals.com/svn/archives/000558.php](http://37signals.com/svn/archives/000558.php)了解黄色渐变技术。对这种行为的一个很好的增强

# php - 显示目录中存储的目录

> ID：14714103
> 
> 赞同：0
> 
> 时间：2013-02-05T18:13:10.140
> 
> 标签：php, directory, file-handling

我刚刚观看了有关显示目录中图像的这些视频，并希望在修改代码方面得到一些帮助。

[http://www.youtube.com/watch?v=dHq1MNnhSzU](http://www.youtube.com/watch?v=dHq1MNnhSzU) - 第 1 部分

[http://www.youtube.com/watch?v=aL-tOG8zGcQ](http://www.youtube.com/watch?v=aL-tOG8zGcQ) -第 2 部分

视频显示的几乎正是我想要的，但我想到的系统是用于照片画廊的。

我计划有一个名为画廊的文件夹，其中将包含其他文件夹，每个文件夹用于每个不同的照片集，即

*   画廊
    *   专辑 1
    *   专辑 2

我需要一些帮助来修改代码，以便它可以识别和仅显示一页上的目录。这样，我可以将这些目录转换为链接，将您带到相册本身，并使用原始代码从那里提取图像。

对于那些想要视频代码的人，这里是

```
$dir = 'galleries';
$file_display = array('bmp', 'gif', 'jpg', 'jpeg', 'png');

if (file_exists($dir) == false) {
echo 'Directory \'', $dir , '\' not found!';
} else {
$dir_contents = scandir($dir);

foreach ($dir_contents as $file) {
    $file_type = strtolower(end(explode('.', $file)));

    if ($file !== '.' && $file !== '..' && in_array($file_type, $file_display) == true) {
        echo '<img src="', $dir, '/', $file, '" alt="', $file, '" />';
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:23:38.660

您需要使用这样的函数来列出所有目录：

```
function getDirectory( $path = '.', $level = 0 ){ 

$ignore = array( 'cgi-bin', '.', '..' ); 
// Directories to ignore when listing output. Many hosts 
// will deny PHP access to the cgi-bin. 

$dh = @opendir( $path ); 
// Open the directory to the handle $dh 

while( false !== ( $file = readdir( $dh ) ) ){ 
// Loop through the directory 

    if( !in_array( $file, $ignore ) ){ 
    // Check that this file is not to be ignored 

        $spaces = str_repeat( '&nbsp;', ( $level * 4 ) ); 
        // Just to add spacing to the list, to better 
        // show the directory tree. 

        if( is_dir( "$path/$file" ) ){ 
        // Its a directory, so we need to keep reading down... 

            echo "<strong>$spaces $file</strong><br />"; 
            getDirectory( "$path/$file", ($level+1) ); 
            // Re-call this same function but on a new directory. 
            // this is what makes function recursive. 

        } else { 

            echo "$spaces $file<br />"; 
            // Just print out the filename 

        } 

    } 

} 

closedir( $dh ); 
// Close the directory handle 

} 
```

然后，将用户选择的目录作为 $dir 变量传递给您当前拥有的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:28:29.563

我现在无法测试任何代码，但很想在这里看到一个解决方案：

```
$directory = new RecursiveDirectoryIterator('path/galleries');
$iterator = new RecursiveIteratorIterator($directory);
$regex = new RegexIterator($iterator, '/^.+\.(bmp|gif|jpg|jpeg|png)$/i', RecursiveRegexIterator::GET_MATCH); 
```

SPL 功能强大，应该更多地使用。

**RecursiveDirectoryIterator**提供了一个用于递归地遍历文件系统目录的接口 。[http://www.php.net/manual/en/class.recursivedirectoryiterator.php](http://www.php.net/manual/en/class.recursivedirectoryiterator.php)

# c++ - 何时在 C++ 中删除/取消引用

> ID：14714105
> 
> 赞同：0
> 
> 时间：2013-02-05T18:13:17.497
> 
> 标签：c++, pointers, dereference

```
myObj* var = new myObj;
var = other1; 
```

不再需要它

```
delete var;
var = new myObj;
var = other2; 
```

为什么不能取消引用而不是再次删除和分配？

```
var->other2; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:23:53.670

取消引用并不意味着删除：[http ://en.wikipedia.org/wiki/Dereference](http://en.wikipedia.org/wiki/Dereference)

我建议您阅读一些有关 C++ 的教程，因为您似乎误解了很多词汇的实际含义。

记得使用谷歌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:19:19.520

你的问题很愚蠢，绝对没有冒犯的意思。换句话说，您在这里有一个潜在的困惑，无法通过简单的询问回答来解决。

我强烈建议您阅读 C 或 C++ 的介绍性材料。网络充斥着精彩的讲座和免费的电子书。你不会后悔的！

谷歌周围:)，也许，你会在几天后回来回答你自己的问题。

快乐编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:41:51.653

其他人评论了您对术语的困惑。我会评论你的代码。

当你这样做时：

```
myObj* var = new myObj;
var = other1; 
```

您正在创建[内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)。`new myObj`为结构分配内存，并设置`var`指向那里。然后，当您重新分配`var`时，您不再有指向已分配结构的变量。C++ 没有自动垃圾回收，因此无法再访问此内存，但您也没有可`delete`用于回收它的变量。

`var = other1`重新分配指针，它不*复制*内容；如果要复制结构，则必须编写：

```
*var = *other1; 
```

当你这样做时：

```
delete var; 
```

您不是在删除原始结构，而是在删除`other`指向的任何内容。仅当该结构是使用创建的时才有效`new`。

您肯定需要返回并查看所有关于 C++ 指针的教学材料。

# python - 如何加快此功能？

> ID：14714108
> 
> 赞同：0
> 
> 时间：2013-02-05T18:13:24.593
> 
> 标签：python, pygame

这会检查某些点是否在矩形内，并且无论何时运行它都会大大降低我的程序速度。我们如何改变它以提高效率？

```
def draw_grid(self, box):
    for element in self.map_layout.all_map_objects:
        if element not in self.build_grid and box.area.collidepoint(element.checkpoint):
            self.build_grid.append(element)
        elif not box.area.collidepoint(element.checkpoint):
            if element in self.build_grid:
                self.build_grid.remove(element) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:17:32.570

一项微不足道的更改是存储 的结果`box.area.collidepoint`：

```
def draw_grid(self, box):
    for element in self.map_layout.all_map_objects:
        collidepoint = box.area.collidepoint(element.checkpoint)
        if element not in self.build_grid and collidepoint:
            self.build_grid.append(element)
        elif not collidepoint:
            if element in self.build_grid:
                self.build_grid.remove(element) 
```

其他更改取决于您需要的数据结构。例如，`self.build_grid`似乎是一个`list`. `__contains__`（在运算符中）列表上的平均**操作是 O(N)**，而如果您可以使用 a `set`，**那将是 O(1)！**. 同样的事情`list.remove`- 在这里您可以使用一个`try-except`子句从紧密循环中删除一个 O(N) 操作，如果元素*通常*在列表中，这可能会有所帮助：

```
 elif not collidepoint:
            try:
                self.build_grid.remove(element)
            except ValueError:
                pass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:16:46.847

您能否仅在移动元素时而不是在绘制时检查碰撞等？

此外，您可能同时调用了两次`box.area.collidepoint(element.checkpoint):`，`element in self.build_grid:`一次用于 if，另一次用于 elseif。如果它的计算成本很高，你能缓存那个答案吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:24:24.737

如果将这些点保存在某种排序的数据结构中，则无需检查每一个。按 Y 排序，在矩形的 Y 范围内查找所有内容，然后按 X 对新列表进行排序，并在矩形的 X 范围内查找所有内容。

# haskell - 使用 attoparsec 解析固定长度的文本

> ID：14714112
> 
> 赞同：1
> 
> 时间：2013-02-05T18:14:00.523
> 
> 标签：haskell, monads, applicative, attoparsec

我需要用 attoparsec 解析固定长度的字段，但我现在正在努力使用编译器。我还是个新手，下面的代码是我最接近的解决方案：

```
> {-# LANGUAGE OverloadedStrings #-}
> import Control.Applicative
> import Data.Text as T
> import Data.Attoparsec.Combinator
> import Data.Attoparsec.Text hiding (take)
> import Data.Char
> import Prelude hiding (take)
>
> type City = Text
> type Ready = Bool
> data CityReady = CR City Ready deriving Show
>
> input = T.unlines ["#London              1",
>                    "#Seoul               0",
>                    "#Tokyo               0",
>                    "#New York            1"]
>
> parseCityReady = many $ CR <$> cityParser <*> readyParser <* endOfLine
>
> cityParser = char '#' *>
>              takeTill isSpace <*
>              skipWhile isHorizontalSpace
>
>
> readyParser = char '1' *> pure True  <|> char '0' *> pure False
>
> main =
>   case parseOnly parseCityReady input of
>      Left err  -> print err
>      Right xs  -> mapM_ print xs
> 
```

这一切都很好，但它只是返回没有空间的城市。

```
CR "London" True
CR "Seoul" False
CR "Tokyo" False 
```

我尝试使用 applicative 为 City 文本字符串取 20 个字符

```
> cityParser = char '#' *>
>              take 20 
```

乃至`do syntax`

```
> cityParser = do char '#'
>                 city <- take 20
>                 return city 
```

但两种方法都无法编译并出现此错误：

```
Couldn't match expected type `attoparsec-0.10.4.0:Data.Attoparsec.Internal.Types.Parser
                                Text b0'
            with actual type `Text -> Text'
In the return type of a call of `take'
Probable cause: `take' is applied to too few arguments
In the second argument of `(*>)', namely `take 20'
In the expression: char '#' *> take 20 
```

是什么导致 ghc 在有 类型`Text -> Text`时询问？`take``Int -> Text -> Text`

如何在 applicative 和 do-syntax 中解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:30:03.147

因此，您的问题是您隐藏了该`take` 功能的多个版本。特别是，您隐藏了`take`from`attoparsec`而不是模块中的`take`功能`Text`。您需要做的就是像这样更改您的导入

```
> import Control.Applicative
> import Data.Attoparsec.Combinator
> import Data.Attoparsec.Text
> import Data.Char
> import Data.Text as T hiding (take)
> import Prelude hiding (take) 
```

# python - 我在哪里提交对 QAbstractTableModel 中的数据库的更改？

> ID：14714113
> 
> 赞同：0
> 
> 时间：2013-02-05T18:14:02.217
> 
> 标签：python, qt, qabstracttablemodel, python-elixir

我正在使用 python2、qt 和 elixir 编写一个应用程序。该应用程序从 sqlite 数据库中获取数据到 elixir 对象列表，并将其存储在我为处理数据而创建的 QAbstractTableModel 子类内的变量中。

我可以很好地查看和更新​​内存中的数据。但是，为了提交对数据库文件的更改（使用 elixir），需要调用函数 session.commit()。

我的问题是，我在哪里称呼它？QAbstractTableModel 中是否有在数据更改后发出的信号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:12:49.683

您有很多信号，例如`dataChanged`（可能是您想要的）`QAbstractItemModel`：

[http://doc.qt.digia.com/stable/qabstractitemmodel.html](http://doc.qt.digia.com/stable/qabstractitemmodel.html)

# qt - 特殊“+”选项卡的名称和实现

> ID：14714114
> 
> 赞同：0
> 
> 时间：2013-02-05T18:14:05.947
> 
> 标签：qt, user-interface, tabs, widget, wxwidgets

我一直想知道用于添加其他选项卡（如在 Internet 浏览器中）的特殊“+”选项卡是否具有特殊名称。

此外，是否有任何流行的框架（Qt、wxWidgets 等）在其 Notebook/TabWidget 中具有内置功能？

编辑：有人问为什么会存在这样的功能，而实现起来很简单。嗯，答案很简单：每个广泛使用的功能都应该有一个专用组件。在经典的选项卡小部件中实现可能很简单，但是当我们可以移动选项卡（这个特殊的应该始终是最后一个）或者可以关闭选项卡而不必选择它们时（在一些选项卡小部件，每个选项卡上都有一个关闭选项卡的叉号）。好吧，考虑到不同的框架，实现起来可能更简单或更难。因此，这个问题是要知道该功能是否足够标准以在某些框架中具有专用名称和一些“内置”实现:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:07:19.847

使用 Qt，您可以使用如下代码：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    connect(ui->tabWidget, SIGNAL(currentChanged(int)), this, SLOT(changedTab(int)));
}

void MainWindow::changedTab(int tabId) {
    if (tabId == ui->tabWidget->count() - 1) {
        QWidget *newTab = new QWidget;
        ui->tabWidget->insertTab(tabId, newTab, "new label");
        ui->tabWidget->setCurrentIndex(tabId);
    }
} 
```

对于关闭选项卡，请参阅 setTabsClosable()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T21:22:57.850

对于当前版本的 WPF、Winform 和 Qt，没有任何选项卡控件具有此功能，但可以轻松添加。检查[WPF](https://stackoverflow.com/questions/3468866/tabcontrol-with-add-new-tab-button)和 [Winform](http://www.codeproject.com/Articles/20050/FireFox-like-Tab-Control)中类似示例的链接。

# c++ - 奇怪的 pow(x, y); 行为

> ID：14714115
> 
> 赞同：6
> 
> 时间：2013-02-05T18:14:06.140
> 
> 标签：c++, pow

在做作业时，我注意到一些非常奇怪的东西，我就是不知道为什么。

```
int x = 5;
cout << pow(x, 2); 
```

结果是 25。没关系。但是，如果我像这样编写相同的程序：

```
int x = 5;
int y = pow(x, 2);
cout << y; 
```

结果是24！

当 x 为 2, 3, 4, 6, 7, 8 时没问题，但对于 5, 10, 11, 13 等，结果比应有的低 1。

与 if() 相同。

```
for (int x = 1; x <= 20 ; x++) {
    if (x * x == pow(x, 2)) 
    cout << x << endl;
} 
```

它打印出数字 1、2、3、4、6、8、12、16。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T18:16:32.090

[`std::pow()`](http://en.cppreference.com/w/cpp/numeric/math/pow)返回一个浮点数。如果结果是例如`24.99999999`并且您将其转换为`int`，它将被截断为 `24`。

这就是您在第二个代码示例中所做的。在第一个代码示例
`cout`中不转换并输出正确的结果。`int`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T18:16:25.477

'pow' 返回一个双精度值，而不是一个 int。当转换为 int 时，double 值会被截断。

[http://www.cplusplus.com/reference/cmath/pow/](http://www.cplusplus.com/reference/cmath/pow/)

不建议将 double 与 int 进行比较。

[http://www.cplusplus.com/reference/cmath/pow/](http://www.cplusplus.com/reference/cmath/pow/)

对您的代码进行小幅编辑以使其正常工作：

```
int x = 5;
double y = pow(x,2);   // correct datatype
cout << y; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-05T18:16:57.210

[pow 函数](http://www.cplusplus.com/reference/cmath/pow/)适用于`float`and ，而`double`不是整数。当您将其分配给整数时，该值可能会被截断，因为浮点数据在其表示中存在精度问题。

我建议阅读[What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)，因为这描述了您看到这种行为的原因*。*

话虽如此，如果您使用`double`values 而不是`int`，您可能会看到您期望的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:05:12.610

pow() 函数通常在数学库中实现，可能使用目标处理器中的特殊指令，对于 x86，请参阅 [How to: pow(real, real) in x86](https://stackoverflow.com/questions/4638473/how-to-powreal-real-in-x86)。但是，诸如`fyl2x`和`f2xm1`之类的指令并不快，因此整个过程可能需要 100 个 CPU 周期。出于性能原因，像 gcc 这样的编译器提供了“内置”函数，这些函数可以[降低强度](http://en.wikipedia.org/wiki/Strength_reduction)以在特殊情况下更快地执行计算。当幂`N`是整数（如您的情况）且较小（如您的情况）时，乘以`N`时间比调用库函数更快。

为了检测幂是整数的情况，数学库提供了重载函数，例如`double pow(double,int)`. 你会发现 gcc 转换

```
double x = std::pow(y,4); 
```

在内部进行 2 次乘法运算，这比库调用快得多，并且在两个操作数都是整数时给出您期望的精确整数结果

```
double tmp = y * y;
double x = tmp * tmp; 
```

为了获得这种类型的强度降低，你应该

1.  # 包括 <cmath>

2.  编译优化 -O2
3.  显式调用库中的 pow 函数`std::pow()`以确保这是您获得的版本，而不是来自 math.h 的版本

然后，您将匹配 < cmath > 中的重载 pow 函数，如下所示

```
inline double pow(double __x, int __i) { return __builtin_powi(__x, __i); } 
```

请注意，这个函数是用它来实现的，`__builtin_powi`当幂是一个小整数时，它知道 pow() 到乘法的强度减少。

# python - 将文本与模板进行比较以检测异常（反向模板）

> ID：14714117
> 
> 赞同：8
> 
> 时间：2013-02-05T18:14:09.553
> 
> 标签：python, perl, validation, templates, text

我正在寻找一种算法，甚至是一种算法空间来处理验证短文本（电子邮件）与已知模板匹配的问题。编码可能是 python 或 perl，但这很灵活。

这是问题所在：

有权访问生产数据的服务器需要能够发送将到达 Internet 的电子邮件：

```
Dear John Smith,

We received your last payment for $123.45 on 2/4/13\. We'd like you to be aware of the following charges:
      $12.34 Spuznitz, LLC on 4/1
      $43.21 1-800-FLOWERS on 4/2
As always, you can view these transactions in our portal. 
Thank you for your business! 
```

显然，某些电子邮件内容会有所不同——称呼（“John Smith”）、“2/4/13 上的 $123.45”以及打印出交易的行。其他部分（“我们收到了您的最后一笔付款”）非常静态。我希望能够匹配文本的静态部分并量化动态部分是否在某些合理的范围内（例如，我可能知道要打印的最多交易行是 5 行）。

因为我担心数据泄露，所以我想确保与此模板不匹配的电子邮件永远不会消失 - 我想检查电子邮件并隔离任何与我预期不符的邮件。所以我需要自动化这个模板匹配并阻止任何离匹配足够远的电子邮件。

所以问题是，我在哪里寻找过滤机制？贝叶斯过滤试图验证特定消息和非特定语料库之间的足够相似性，这是一种相反的问题。Perl 的 Template 模块之类的东西非常匹配——但用于输出，而不是用于输入或比较。简单的“差异”类型比较不能很好地处理有限的动态信息。

我如何测试这些传出的电子邮件是否“像鸭子一样嘎嘎”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T16:48:53.470

您可以使用语法进行紧密匹配。可以在语法中组织正则表达式以便于抽象：[http ://www.effectiveperlprogramming.com/blog/1479](http://www.effectiveperlprogramming.com/blog/1479)

或者您可以使用专用的语法引擎[Marpa](https://metacpan.org/module/Marpa%3a%3aR2)。

如果您想要更统计的方法，请考虑[n-grams](https://en.wikipedia.org/wiki/Ngram)。首先，标记文本并用有意义的占位符替换变量块，比如`CURRENCY`and `DATE`。然后，构建*n-gram*。现在您可以使用[Jaccard 索引](https://en.wikipedia.org/wiki/Jaccard_index)来比较两个文本。

这是一个适用于三元组的 Pure-Perl 实现：

```
#!/usr/bin/env perl
use strict;
use utf8;
use warnings;

my $ngram1 = ngram(3, tokenize(<<'TEXT1'));
Dear John Smith,

We received your last payment for $123.45 on 2/4/13\. We'd like you to be aware of the following charges:
      $12.34 Spuznitz, LLC on 4/1
      $43.21 1-800-FLOWERS on 4/2
As always, you can view these transactions in our portal. 
Thank you for your business!
TEXT1

my $ngram2 = ngram(3, tokenize(<<'TEXT2'));
Dear Sally Bates,

We received your last payment for $456.78 on 6/9/12\. We'd like you to be aware of the following charges:
      $123,43 Gnomovision on 10/1
As always, you can view these transactions in our portal. 
Thank you for your business!
TEXT2

my %intersection =
    map { exists $ngram1->[2]{$_} ? ($_ => 1) : () }
    keys %{$ngram2->[2]};
my %union =
    map { $_ => 1 }
    keys %{$ngram1->[2]}, keys %{$ngram2->[2]};

printf "Jaccard similarity coefficient: %0.3f\n", keys(%intersection) / keys(%union);

sub tokenize {
    my @words = split m{\s+}x, lc shift;

    for (@words) {
        s{\d{1,2}/\d{1,2}(?:/\d{2,4})?}{ DATE }gx;
        s{\d+(?:\,\d{3})*\.\d{1,2}}{ FLOAT }gx;
        s{\d+}{ INTEGER }gx;
        s{\$\s(?:FLOAT|INTEGER)\s}{ CURRENCY }gx;
        s{^\W+|\W+$}{}gx;
    }

    return @words;
}

sub ngram {
    my ($size, @words) = @_;
    --$size;

    my $ngram = [];
    for (my $j = 0; $j <= $#words; $j++) {
        my $k = $j + $size <= $#words ? $j + $size : $#words;
        for (my $l = $j; $l <= $k; $l++) {
            my @buf;
            for my $w (@words[$j..$l]) {
                push @buf, $w;
            }
            ++$ngram->[$#buf]{join(' ', @buf)};
        }
    }

    return $ngram;
} 
```

您可以使用一个文本作为模板并将其与您的电子邮件相匹配。检查[String::Trigram](https://metacpan.org/module/String%3a%3aTrigram)以获得有效的实现。[Google Ngram Viewer](http://books.google.com/ngrams)是一个很好的资源来说明*n-gram*匹配。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T17:25:36.763

如果您想将预先存在的模板与例如控制流元素（例如`{% for x in y %}`从它的假定输出）匹配，您将不得不解析模板语言 - 这似乎需要做很多工作。

另一方面，如果您准备为验证目的编写第二个模板 - 例如：

```
Dear {{customer}},

We received your last payment for {{currency}} on {{full-date}}\. We'd like you to be aware of the following charges:
(      {{currency}} {{supplier}} on {{short-date}}
){,5}As always, you can view these transactions in our portal\. 
```

...这只是正则表达式语法的简单扩展，将一些东西组合在一起非常简单，可以验证：

```
import re

FIELDS = {
    "customer": r"[\w\s\.-]{,50}",
    "supplier": r"[\w\s\.,-]{,30}",
    "currency": r"[$€£]\d+\.\d{2}",
    "short-date": r"\d{,2}/\d{,2}",
    "full-date": r"\d{,2}/\d{,2}/\d{2}",
}

def validate(example, template_file):
    with open(template_file) as f:
        template = f.read()
    for tag, pattern in FIELDS.items():
        template = template.replace("{{%s}}" % tag, pattern)
    valid = re.compile(template + "$")
    return (re.match(valid, example) is not None) 
```

无论如何，上面的示例都不是有史以来最伟大的 Python 代码，但它足以让您了解总体思路。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-18T18:44:36.363

我会选择“最长的公共子序列”。可以在此处找到标准实现：

[http://en.wikibooks.org/wiki/Algorithm_implementation/Strings/Longest_common_subsequence](http://en.wikibooks.org/wiki/Algorithm_implementation/Strings/Longest_common_subsequence)

如果您需要更好的算法和/或更多关于字符串不精确匹配的其他想法，标准参考书是这本书：

[http://www.amazon.com/Algorithms-Strings-Trees-Sequences-Computational/dp/0521585198](https://rads.stackoverflow.com/amzn/click/com/0521585198)

不要被标题所迷惑。计算生物学主要是关于长字符串（也称为 DNA 序列）的大型数据库的匹配。

# ios - 在 iOS 中绘制到加载的 UIImage

> ID：14714124
> 
> 赞同：4
> 
> 时间：2013-02-05T18:14:37.957
> 
> 标签：ios, objective-c, image, uiimage, draw

我有一些问题。

我有一个加载的 UIImage，我想：

1st - 在我加载的 UIImage 上绘制另一个图像

第二 - 在我加载的 UIImage 上画一条线（带有颜色和粗细）

如果您能提出一些基本的东西，我将不胜感激，我仍然是菜鸟:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:28:56.767

还有另一种选择，它使用核心图形。

```
UIGraphicsBeginImageContextWithOptions(size, NO, 0.0);
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSaveGState(context);
UIImage *bottomImage = ...;
CGRect bottomImageRect = ...;
CGContextScaleCTM(context, 1.0, -1.0);
CGContextTranslateCTM(context, 0, -bottomImageRect.size.height);
CGContextDrawImage(context, bottomImageRect, bottomImage.CGImage);
CGContextRestoreGState(context);

CGContextSaveGState(context);
UIImage *topImage = ...;
CGRect topImageRect = ...;
CGContextScaleCTM(context, 1.0, -1.0);
CGContextTranslateCTM(context, 0, -topImageRect.size.height);
CGContextDrawImage(context, topImageRect, topImage.CGImage);
CGContextRestoreGState(context);

CGPoint origin = ...;
CGPoint end = ...;
CGContextMoveToPoint(context, origin.x, origin.y);
CGContextAddLineToPoint(context, end.x, end.y);
CGContextSetStrokeColorWithColor(context, [UIColor whatever].CGColor);
CGContextStrokePath(context);

UIImage *result = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext(); 
```

**编辑：** 稍微更改了代码，以便图像不会倒置

# android - Android：是否可以显示 jquery 或 javascript 弹出窗口？

> ID：14714134
> 
> 赞同：0
> 
> 时间：2013-02-05T18:15:14.993
> 
> 标签：android, jquery, popup

是否可以在 android WebView 中显示 jquery 或 javascript 弹出消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:58:32.400

`alert()`您可以使用 JavaScript 、`confirm()`或显示弹出消息`prompt()`。如果他们不工作，那么还有其他问题。确保您的 JavaScript 正确到达这些语句。用于`console.log()`将消息写入 LogCat 以跟踪您的执行。还要确保 JavaScript 已启用。IE：

```
myWebView.getSettings().setJavaScriptEnabled(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:10:47.617

您可以简单地使用下面给出的行在 webview 中显示警报：

```
wv.loadUrl("javascript:alert('hello Android');"); 
```

如果您想在 UI 中进行一些更改，您可以在覆盖函数 onPageFinished() 中调用如下所示的 javascript

```
wv.setWebViewClient(new MyWebViewClient(){

@Override
public void onPageFinished(WebView view, String url) {
super.onPageFinished(view, url);

   wv.loadUrl("javascript:document.getElementById('client').style.visibility ='hidden';");

   }
} 
```

# node.js - Node.js 内存泄漏，尽管堆 + RSS 大小恒定

> ID：14714151
> 
> 赞同：7
> 
> 时间：2013-02-05T18:16:25.260
> 
> 标签：node.js

根据我的服务器监控，我的内存使用量随着时间的推移而逐渐增加：

![在此处输入图像描述](../Images/6c10ea4eada08b3df3b05a6d630e6229.png)

在大约 4 周的正常运行时间之后，它最终导致问题/崩溃（这是有道理的，因为我在 EC2 上使用 m1.large 实例 => 8GB RAM，并且 RAM 似乎以大约 1.5 GB / 周的速度增加）。

如果我重新启动我的 node.js 应用程序，内存使用会重置。然而......我正在通过 跟踪我的内存使用情况`process.memoryUsage()`，甚至在大约 1 周后，我看到

```
{"rss":"693 Mb","heapTotal":"120 Mb","heapUsed":"79 Mb"} 
```

我错过了什么？显然泄漏在节点中，但该过程似乎没有意识到它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T12:04:47.277

您可以尝试[node-memwatch](https://github.com/lloyd/node-memwatch)模块，它有助于在 Node.js 中进行泄漏检测和堆差异。

堆差异看起来类似于：

```
{
  "before": { "nodes": 11625, "size_bytes": 1869904, "size": "1.78 mb" },
  "after":  { "nodes": 21435, "size_bytes": 2119136, "size": "2.02 mb" },
  "change": { "size_bytes": 249232, "size": "243.39 kb", "freed_nodes": 197,
    "allocated_nodes": 10007,
    "details": [
      { "what": "String",
        "size_bytes": -2120,  "size": "-2.07 kb",  "+": 3,    "-": 62
      },
      { "what": "Array",
        "size_bytes": 66687,  "size": "65.13 kb",  "+": 4,    "-": 78
      },
      { "what": "LeakingClass",
        "size_bytes": 239952, "size": "234.33 kb", "+": 9998, "-": 0
      }
    ]
  } 
```

# javascript - Windows 8 Javascript App，控制滚动条样式？

> ID：14714155
> 
> 赞同：2
> 
> 时间：2013-02-05T18:16:38.570
> 
> 标签：javascript, html, windows-8, winjs

通过设置`overflow: scroll`一个元素，我可以让滚动功能​​在 Windows 8 Javascript 应用程序中运行。

我注意到有两种类型的滚动条，见下图。

![滚动条](../Images/e93315016dfe5009bb4e42ef4f743d66.png)

悬停元素时，会出现图像右侧的滚动条。几秒钟后它会消失。此时，如果我选择使用鼠标滚轮或手势滚动，就会出现左侧的滚动条。

是否可以控制滚动行为，以便只出现左侧类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:28:20.403

否。这由操作系统决定，具体取决于您使用的是触摸输入还是鼠标/键盘输入。

[每条评论：请参阅本文中](http://msdn.microsoft.com/en-us/library/windows/apps/hh465310.aspx)的“滚动控件” 。

# java - Android/ArduinoBT 连接

> ID：14714156
> 
> 赞同：1
> 
> 时间：2013-02-05T18:16:38.317
> 
> 标签：java, android, bluetooth

我正在尝试使用蓝牙将我的三星 Galaxy Tab 连接到我的 ArduinoBT。

我的代码：

```
 public void run()
{
    if (adapter == null)
    {
        return;
    }

    device = adapter.getRemoteDevice(macAddress);
    try {
        socket = device.createRfcommSocketToServiceRecord(UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"));
        socket.connect();
    } catch (Exception e) {
        e.printStackTrace();
    }

} 
```

当我启动应用程序时，我有这个窗口：http: [//i.stack.imgur.com/tlc3x.png](http://i.stack.imgur.com/tlc3x.png)

我写密码：0000

在日食中，我可以看到：

```
02-05 19:14:36.828: V/BluetoothSocket.cpp(4952): connectNative
02-05 19:14:41.296: V/BluetoothSocket.cpp(4952): ...connect(52, RFCOMM) = 111 (errno 111)
02-05 19:14:41.296: W/System.err(4952): java.io.IOException: Connection refused
02-05 19:14:41.296: W/System.err(4952):     at android.bluetooth.BluetoothSocket.connectNative(Native Method)
02-05 19:14:41.296: W/System.err(4952):     at android.bluetooth.BluetoothSocket.connect(BluetoothSocket.java:236)
02-05 19:14:41.296: W/System.err(4952):     at iut.robot.BluetoothThread.run(BluetoothThread.java:38) 
```

我不明白，当我使用这个应用程序时：https: [//play.google.com/store/apps/details?id=mobi.dzs.android.BluetoothSPP&hl=fr](https://play.google.com/store/apps/details?id=mobi.dzs.android.BluetoothSPP&hl=fr) 它工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:54:17.700

您的蓝牙代码看起来不错。

以下是一些可能会解决您的问题的建议：

*   在启动应用程序之前，从蓝牙设置中配对您的 ArduinoBT。

*   确保只有*一个*应用程序连接到您的 ArduinoBT（重新启动平板电脑中的蓝牙以断开所有当前连接）

*   确保蓝牙 Mac 地址格式正确，即`xx:xx:xx:xx:xx:xx`

*   检查android应用程序是否具有所需的权限`android.permission.BLUETOOTH`，您也可以添加`android.permission.BLUETOOTH_ADMIN`，但您的情况**不需要**

**编辑：**

如果您与AurdionoBT正确配对并且在配对过程中已经进入`pin`，您可以尝试连接`insecure RFcomm`

```
socket = device.createInsecureRfcommSocketToServiceRecord(UUID.fromString("00001101-0000-1000-8000-00805F9B34FB")); 
```

# cookies - 使用 cookie 过滤 Google Analytics 中的数据

> ID：14714158
> 
> 赞同：2
> 
> 时间：2013-02-05T18:16:44.243
> 
> 标签：cookies, google-analytics

我正在尝试根据 cookie 过滤我公司网站的 Google Analytics 数据。我不想跟踪内部流量，但我不能只根据 IP 地址范围进行过滤，因为我们仍想跟踪一些内部用户。我有一些用于添加 cookie 的非常简单的代码，但我只是不确定在哪里添加代码。我对 cookie 真的很陌生，在网上找不到任何关于如何实际添加或使用 cookie 的明确内容。

```
<html>
<head>

<title>Remove My Internal Traffic from Google Analytics</title>

<script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-XXXXX-YY']);
          _gaq.push(['_setVar','employee']);
          _gaq.push(['_trackPageview']);
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })(); 
```

所以我的问题是，这段代码实际上去哪里了？谢谢你用饼干帮助我的新手技能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T20:40:17.087

不要使用 setVar（不推荐使用），使用 _setCustomVar：

```
_setCustomVar(index, name, value, opt_scope) 
```

该调用在 _trackPageview 调用之前进行。

标准 GA 中有五个自定义变量（高级版 50 个），即“索引”。“名称”和“价值”应该清楚。

CustomVars 对当前页面、会话或访问者有效（在最后一种情况下，它们在访问者清除浏览器中的 cookie 之前有效，除非他等待六个月才能再次访问您的站点）。

就像每条带有异步 GA 代码的指令一样，它被“推送”到 gaq-Array 上，因此正确的调用应该是：

```
 _gaq.push(['_setCustomVar',
      1,                   // This custom var is set to slot #1\.  Required parameter.
      'Items Removed',     // The name acts as a kind of category for the user activity.  Required parameter.
      'Yes',               // This value of the custom variable.  Required parameter.
      2                    // Sets the scope to session-level.  Optional parameter.
   ]); 
```

取自此处的 Google 文档： [https](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables#setup) ://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables#setup 。

我仍然认为，对于您的用例，选择退出插件是更好的解决方案。

更新：考虑一下，我认为您根本不需要 setCustomVar 或自定义 cookie。让您的员工通过以下链接访问您的网站：

```
mywebsite.com?utm_source=allyourbasearebelongtous 
```

然后转到配置文件设置并创建自定义过滤器，设置为排除，过滤字段“活动来源”，过滤模式“allyourbasearebelongtous”（或您为活动参数提供的任何名称）。

这也使用 cookie（标准的 google cookie），但根本不需要任何自定义代码。活动来源参数在他们访问另一个针对您网站的活动之前有效，因此如果有人想要测试 GA 代码，他们需要删除他们的 cookie 或使用隐身模式（但这与设置自定义 cookie 或 setCustomVar-方法）。

# javascript - 使用格式键入文本效果：跳过 HTML 标记，但不要删除

> ID：14714162
> 
> 赞同：1
> 
> 时间：2013-02-05T18:16:48.930
> 
> 标签：javascript, jquery, html, strip

我试图提供一种简单的方法来获得打字文本效果，但也可以允许 HTML 标签。我有一些有效的代码，但我看到标签被认为是文本的一部分。

例如，如果文本是`"Anyone is <b>awesome</b>`，当它到达粗体部分时，我会看到以下内容：

```
<
<b
<b>
<b>a
<b>aw
<b>awe
<b>awes
<b>aweso
<b>awesom
<b>awesome
<b>awesome<
<b>awesome</
<b>awesome</b
<b>awesome</b> 
```

如何跳过 html 节点而不从字符串中删除它们？我想保持格式化工作。

这是我到目前为止所做的：

`<div id="foo"></div>`

```
$.fn.typer = function (text, options) {
    options = $.extend({}, {
        delay: 1000,
        duration: 1000,
        easing: 'linear',
        endless: false
    }, options);
    var elem = $(this);
    (function loop(i) {
        var e = typeof text === 'string' ? text : text[i];
        // strip html tags, might be helpful
        // e.replace(/(<.*?>)/ig,"")
        $({len: 0}).delay(options.delay).animate({len: e.length}, {
            duration: options.duration,
            easing: options.easing,
            step: function (now) {
                var pos = Math.ceil(now),
                    char = e.substr(pos, 0);
                elem.html(e.substr(0, pos));
            },
            complete: function () {
                i++;
                if (i === text.length && !options.endless) {
                    return;
                } else if (i === text.length) {
                    i = 0;
                }
                loop(i);
            }
        });
    })(0);
};

$('#foo').typer(['<i>Anyone</i> <u>is</u> <b>awesome</>!', 'Foo bar.']); 
```

工作演示：

[http://jsfiddle.net/ARTsinn/RED9H/2/](http://jsfiddle.net/ARTsinn/RED9H/2/)

**更新**

[知道了！](https://github.com/yckart/jquery.typer.js/blob/master/jquery.typer.js#L34)

没有`jQuery`' 动画功能的[示例。](http://jsfiddle.net/ARTsinn/RED9H/4/)

如果您有任何改进，请在此处分享！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:25:01.810

有点像“让我为你准备那个！” 做？[例子](http://letmebingthatforyou.com/?q=how%20to%20get%20a%20typing%20effect%20like%20on%20bing%20that)

可以下载执行打字效果的 Javascript - 但请先检查许可条款。[http://letmebingthatforyou.com/scripts/lmbtfy.js](http://letmebingthatforyou.com/scripts/lmbtfy.js)似乎完成了大部分工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:25:11.920

要从 中剥离标签`e`，请使用：

```
e = $(e).text(); 
```

这假设 e 已知包含 HTML 开头。如果它可能包含纯文本，请先将其包装在 DIV 中：

```
e = $('<div>'+e+'</div>').text(); 
```

否则，jQuery 将尝试将其解释为选择器。

# compact-framework - 如何在 Visual Studio (2003) 中运行我的 Windows CE 项目？

> ID：14714163
> 
> 赞同：5
> 
> 时间：2013-02-05T18:16:50.943
> 
> 标签：compact-framework, windows-ce, barcode, xp-mode

我正在开发一个需要在 VS 2003 中继续的遗留应用程序；但是，我无法有效地调试它，因为当我尝试运行它时，会出现以下对话框：

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ~~~~~~~~~~~~~~~~~~

部署

选择要定位的设备。如果 .NET Compact Framework 尚未在所选设备上，它将与您的应用程序一起部署。

```
Pocket PC 2002 Emulator
Pocket PC Device
Windows CE .NET Device
Windows CE .NET Emulator (Default) 
```

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ~~~~~~~~~~~~~~~~~~

我在 Windows 7 上以 XP 模式（虚拟机）运行此（VS 2003）。我没有（从 XP 模式）到设备的连接 - 符号/摩托罗拉 PDT 3090 - 所以我得到“无法连接”尝试在 VS 2003 中运行/调试/部署时。

到目前为止，开发人员将构建二进制文件，添加调试消息，然后将二进制文件复制到设备并运行它。与其继续这种方法，我更希望能够从 VS 2003 中对其进行调试。有没有办法做到这一点？所有选项（Pocket PC 2002 Emulator 等）似乎都不起作用……该设备通过 USB 连接到计算机。模拟器无法工作，因为它们没有必要的硬件（条形码扫描仪）。所以我需要使用 *Device 选项之一，但无法将 USB 端口连接到 XP Mode。

是否有人对如何在不不断复制和替换二进制文件以及使用“显示消息”的情况下进行调试有任何想法？

## 更新

或者，如果我不能在 VS 2003 / XP 模式中作为模拟器运行该应用程序，也可以在连接的摩托罗拉手持设备上运行它，通过 USB 电缆从底座连接到台式计算机；我更喜欢前者，因为它提供了调试功能，但即使是后者也会比我目前的困境更好（将文件复制到手持设备，将其与计算机分离，将其连接到带式打印机，启动它，测试和无限重复，令人作呕）。尽快（在两个小时内），我将在这个问题上设置赏金。

## 更新 2

如果我尝试在模拟器中从 VS 2003 运行，并选择“Windows CE .NET Emulator (Default)”，我会得到：

*“Emulator for Windows CE 不会在 Emulator for Windows CE 的另一个副本中运行。您只需要尝试一下，不是吗？”*

？！？这是因为我在虚拟机（XP 模式）会话中这样说吗？

然后我选择“OK”（唯一的选项），然后得到“有部署错误。继续吗？” 这个技巧永远不会奏效；它甚至会导致构建失败（不过，重建修复了该问题）。

## 更新 3

也许我无法通过连接到设备本身进行调试的问题与我今天早上启动时看到的这个消息有关（但我不知道该怎么做，如果这是问题 - 我需要正在寻找摩托罗拉 MC3100 的新驱动程序？）：

```
Devices or applications disabled.
Virtual PC/Windows CE Emulator will cause Windows to become unstable. Windows has prevented these drivers from loading. click here for more details. 
```

“更多细节”是：

```
Virtual PC/Windows CE Emulator 
Microsoft 

--------------------------------------------------------------------------------

Issue Description: 

    A driver is installed that causes stability problems with your system. This driver will be disabled. Please contact the driver manufacturer for an update that is compatible with this version of Windows. 

    Contact Information: 

    Web Site: http://go.microsoft.com/fwlink/?LinkId=26320
    Telephone: 1-800-936-5800 
```

该链接 ( [http://go.microsoft.com/fwlink/?LinkId=26320](http://go.microsoft.com/fwlink/?LinkId=26320) ) 最终显示为：“Internet Explorer 无法显示该网页”

## 更新 4

连接到设备前端有一些进展（或者可能只是错误的希望）：

我的台式机上有 4 个 USB 端口。不久前，我第一次将 USB 电缆从顶部插入第 3 根。然后它说它已被识别，并且 ActiveSync 终于能够建立连接。

所以我然后尝试再次部署该应用程序。第四个选项（默认 - CE Device Emulator）一如既往地失败。倒数第二个选择（CE 设备）也是如此。不过，第二个选项（Pocket PC 设备）似乎可行。

然而，我得到了一个神秘的错误消息，它刚刚说：

```
#183: 
```

我忽略了这一点，从那时起（现在已经过去了十分钟），VS 输出窗口的底部一直在说“正在启动应用程序”（下方有一个闪烁的光标），并且任务栏一直在声称“部署开始.. 。”

然而，这是否真的有任何价值，它似乎没有，因为我只是“卡”在那里......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T14:26:40.250

> Windows CE .NET 模拟器（默认）

如果您运行的是 Windows CE，这应该是您想要的。

条形码阅读器获取代码并将其转换为字符串，因此您的代码永远不需要“解码”条形码。

因此，当您使用 CE 仿真器测试您的软件时，只需选择要读取条形码的文本框，然后使用键盘输入该值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T19:34:23.327

在您的 Windows 7 主机 PC 的**任务栏中**，右键单击 XP Mode VS2003 应用程序。在出现的菜单中选择“管理 USB 设备”。

![显示右键菜单](../Images/e90b01960f2fa0ef47f063eeadf2fa01.png)

选择您的 Windows Mobile 设备并点击“附加”按钮。您的 XP Mode PC 应通过 ActiveSync 连接。（假设您已经在 XP Mode VM 上安装了 ActiveSync。如果没有，您应该先安装。）

尝试重新启动虚拟机。（与关闭并重新打开它不同）。如果这不起作用，请尝试使用其他 USB 端口。您最终可能会重新安装 XP 模式。

另请参阅：[如何在适用于 Windows 7 的 Windows Virtual PC 中访问 USB 设备](http://www.dummies.com/how-to/content/how-to-access-usb-devices-in-windows-virtual-pc-fo.html)

# android - 如何从模拟器或 PC 中的任何 android 项目中获取数据库文件

> ID：14714173
> 
> 赞同：1
> 
> 时间：2013-02-05T18:17:18.707
> 
> 标签：android

我在 android n 上开发了一个项目，使用 sql lite 创建了数据库，但是如何在 pc 或 emulato 中找到数据库的物理文件

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T19:50:07.287

1.选择`DDMS`

2.选择`Device`

3.选择`File Explorer`

4.探索`data`

5.再次探索另一个`data`层次结构

6.寻找你的`package`并选择它

7.在你的包里面你会看到`databases`文件夹

8.选择你的`database`

9.选择`pull a file from device`

但是文件不可读，要读取文件，您必须使用工具或终端![这张快照可以帮助你](../Images/c4c48ba7e50c3e9fe95a4642759537df.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:33:46.110

您可以为 Eclipse 下载这个很棒的插件，并且无论何时运行模拟器，您都可以使用文件资源管理器导航到存储数据库的数据文件夹并打开插件。它会在一个精彩的电子表格中为您显示 sqlite 数据库

[Eclipse 的 SQLite 浏览器](http://marketplace.eclipse.org/content/cellobject-sqlite-xml-browser#.URFQOGfw6RM)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:20:18.477

一种选择是使用 DDMS 或 adb pull 下载数据库文件，然后使用桌面 SQLite 客户端对其进行检查。

adb 拉 /path/to/your/db

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T18:38:29.237

通过 Eclipse：

窗口-->打开透视图-->（如果未选择，请选择您的模拟器或设备）文件资源管理器-->数据-->数据-->选择您的包名称-->数据库->您将能够看到数据库.db 扩展名的文件。

是的，要在本地文件夹中获取此文件，请选择您的 db 文件，然后在右侧您将看到图标，选择从设备中提取文件，将其存储在您想要的位置。

要查看此 db 文件的内容，您可以使用 @Jade Byfield 建议的插件，也可以对其进行修改

# java - 瘦控制器

> ID：14714174
> 
> 赞同：9
> 
> 时间：2013-02-05T18:17:20.643
> 
> 标签：java, javafx-2

我被 javafx 弄湿了。这就是我正在做的事情。

```
FXML Views
DI Controllers
Weld-SE Managed Services and Models
Trying to confine UI to FXML
Trying keep the Controllers thin 
```

**问题：**

在尝试编写 UI 代码时，大多数静态 UI 都被限制在 fxml 中。但是在某些情况下，我会发现自己添加、删除、显示、隐藏元素等。

我发现自己在控制器内部执行此操作，因为 fx 允许我在视图中配置控制器方法，它将调用特定的操作/事件。所有这些代码都处理动态 UI 构建/操作，并且属于视图层。但是，它最终导致控制器变胖。

javafx 提供 javascript 集成。这是一种抽象视图操作代码的可能方式。但这会在组合中添加不那么完美的javascript。

如何在 java 或 fxml 中抽象出代码，以免破坏 Thin Controller Paradigm ？

**编辑**

***@assylias***

同意，我已经考虑过这种方式，Java 类和 fxml 一起成为可重用的小部件。但是，我如何将它连接到 FXML。FXML 除了控制器什么都不懂。假设我使用 fx:controller 将此视图类连接到 fxml 中，而不是将其命名为控制器。所以我有这样的东西。

![在此处输入图像描述](../Images/283530947c7da130451e89cd55da7a22.png)

这个视图类只有视图操作代码。然后我会创建另一个控制器类。但后来我希望以某种方式将表单数据填充到这个控制器中。这应该只在用户提交表单时发生。所以在某种程度上，我需要以某种方式告诉 javafx UI 操作请求/事件不同于实际的数据操作请求/事件。

你的想法，对不起，如果它很冗长。我试图用尽可能少的词来表达它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-27T17:09:57.573

我认为最简单的解决方案是记住 FXML 中指定的控制器是视图控制器。它的目的是包含修改和更新视图的代码，而不是包含传统的 MVC 控制器代码或业务逻辑。

例如，在我目前正在进行的一个项目中，我将 JavaFX 与[Akka Actors](http://doc.akka.io/docs/akka/snapshot/scala/actors.html)一起使用。该应用程序是用 scala 编写的。JavaFX 视图控制器包含修改视图所需的任何代码。一个屏幕包含一个登录表单。当用户单击登录按钮时，视图控制器会简单地创建一条包含用户名和密码的消息，并将该消息发送给负责执行业务逻辑的参与者。如果该actor确定存在错误，那么它将向视图控制器发送一条消息，并且视图控制器可以决定需要在屏幕上进行哪些类型的更新。

我发现使用带有 JavaFX 的 akka Actor 可以大大简化应用程序的编码，至少有两个原因。

1.  因为使用参与者系统要求参与者之间发送消息，所以表示代码和业务代码之间存在自然边界。来回传递的消息形成了这个自然边界。
2.  使用演员完全取代了使用线程/任务的复杂性。它完全消除了`javafx.concurrent.Task`为长时间运行的进程编写代码的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:05:37.657

将您的视图操作代码放在 Main Class 中怎么样？

主要课程：

```
public class SampleJavaFXApp extends Application{

public static void main(String[] args) {
    launch(args);
}
@Override
public void start(Stage primaryStage) throws IOException {
    FXMLLoader loader = new FXMLLoader(getClass().getResource(
            "SampleUI.fxml"));
    Parent root = (Parent) loader.load();
    Controller controller = loader.getController();
    viewManipulationLogic(controller);
    primaryStage.setScene(new Scene(root));
    primaryStage.show();    
}
       // view manipulation logic
private void viewManipulationLogic(Controller controller) { 
controller.getBlueButton().setOnAction(new EventHandler<ActionEvent>() {
        @Override
        public void handle(ActionEvent arg0) {
            System.out.println(" I am just about button!");
        }
    }); 
} 
```

控制器 ：

```
public class Controller implements Initializable {
    @FXML
    private Button blueButton;
    public Button getBlueButton() {
        return blueButton;
    }
@Override
    public void initialize(URL arg0, ResourceBundle arg1) {
         //real data manipulation
}
} 
```

缺点：您需要在控制器类中为您想要操作的所有节点获取 getter。

# c++ - 限制标头中变量的范围

> ID：14714175
> 
> 赞同：0
> 
> 时间：2013-02-05T18:17:21.650
> 
> 标签：c++, scope, header-files

我有一个多文件程序，包括

```
main.cpp
ext1.cpp
ext2.cpp
ext3.cpp
vars.h 
```

顾名思义，main.cpp 是主文件，extX.cpp 包含各种函数和 vars.h 一些全局常量。

但是，在 main.cpp 中也有（一些！）变量声明，但它们必须只在 main.cpp 的范围内——这就是我没有将它们放在 vars.h 中的原因

我想减少 main.cpp 中的代码量（为了清晰起见）。我正在寻找一种在某种标头中声明这些变量的方法，但它只对 main.cpp 可见。

是否正确理解，如果我将它们全部放在例如 vars_main.h（*没有*外部关键字）并且只包含“vars_main.h”，那么我已经实现了我的目标？

这样做是否被认为是“正确的”C++风格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:30:16.273

通常的做法是继续在 main.cpp 中定义它们，因为它们位于不同的块中并且不会影响代码的可读性。但是，您当然可以将它们移到一个单独的包含文件中，该文件仅包含在一个 .cpp 中，这完全取决于您的风格选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:30:25.070

如果您正在谈论的变量是main私有的全局变量，我认为您应该将它们放在main.cpp中。如果它们没有在其他任何地方使用，那么在标题中声明它们是没有意义的

您还可以使用私有范围内的变量创建一个实现“主要”功能的类，这样它们就不会被实现的其他部分使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:30:35.163

如果这些变量仅在 中使用`main()`，那么是的，您*可以*这样做。但我**不会**认为它是“正确的 C++ 风格”。

如果有一天您最终将该头文件包含到另一个翻译单元中（可能是因为您只需要共享**其中一个**变量），链接器将开始抱怨**多个定义**。

此时，为了克服这个问题，您*可以*使用`static`关键字为这些变量提供内部链接并解决多个定义的问题。但是，这样一来，每个翻译单元（`.cpp`文件）都将拥有自己的这些变量的**副本**，这可能不是您想要的，特别是如果它们*不是常量*- 只是为了记录，全局常量默认具有内部链接，所以您不需要明确地将它们限定为`static`.

这里的常规做法是将这些变量定义保留在 中`main()`，或者拥有一个仅包含这些变量`extern` **声明**的标头和一个包含其**定义**的翻译单元。然后，所有需要访问这些变量的文件只需导入带有声明的标头。

# eclipse - 在eclipse中的特定包内搜索行

> ID：14714177
> 
> 赞同：0
> 
> 时间：2013-02-05T18:17:27.117
> 
> 标签：eclipse

我正在使用 eclipse 并希望找到在错误消息中输出的特定行。该行不在我编写的任何代码中，但我相信它来自我包含的特定库。Eclipse 能够浏览库中的类，因此它具有来自某个地方的源代码，jar 是从 Mavin 获取的，我假设它获取的 jar 是源 jar？

问题是，默认情况下，简单的 java 搜索不会在 jar 中搜索行，而且我没有看到一个明显的方法来告诉它。此外，我不想搜索所有的罐子，甚至是一个可疑罐子中的所有代码，因为这可能需要一段时间。有没有办法告诉 eclipse 只对特定包中的每个文件进行文本搜索？如果失败了，我将如何告诉它对特定 jar 中的所有代码进行文本搜索？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:07:17.267

您需要在文件中查找任意文本的 Eclipse 的“文件搜索”不会“查看”JAR。另一方面，它的“Java 搜索”并不专门查看源代码，但允许搜索类型、方法、字段等（即 Eclipse 不需要源代码的东西）。因此，Eclipse 在这里无法为您提供帮助。

您并没有要求替代方案，但在 Unix 上有[zipgrep](http://www.info-zip.org/mans/zipgrep.html)，对于 Windows，我*相信* [Actual Search & Replace](http://www.divlocsoft.com/)也是如此。

# git - 将 sftp 文件系统与版本控制同步

> ID：14714178
> 
> 赞同：4
> 
> 时间：2013-02-05T18:17:28.690
> 
> 标签：git, sync, sftp

我最近开始为大学社团管理一个（小型）网站，显然（根据最后一个管理它的人）访问该网站文件的方式是通过 SFTP。我使用 Linux Mint/Nautilus，所以这没问题。但是，我也有一个本地副本，可以在上传之前使用 Apache/localhost 测试我的更改（暂时忽略我无法真正让它工作的那一刻......）。我使用 Git 来跟踪我的更改。

有什么方法可以区分 SFTP 版本和我自己的版本，然后只更新更改的文件（基本上是通过 SFTP 进行的某种同步），并可能将版本控制也纳入其中？

顺便说一句，我对此的经验很少，因此将不胜感激。这同样适用于相当简单的方法来做事，而不一定是最时尚但最可怕的配置方式。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:59:00.107

## 通过 SSH 使用 Rsync

如果他们运行的是真正的 SSH 服务器，而不是纯 SFTP 服务器，那么您可以使用 rsync 将本地更改推送到远程。例如：

```
cd /my/project/directory
rsync -PSauve ssh --exclude=.git * $LOGNAME@example.com:/var/www/ 
```

您可能还想使用该`--delete`选项，但如果可能存在仅存在于服务器端的文件需要保留，请谨慎。

## 使用 SFTP 进行树操作

如果您不能使用 rsync，您可以将上游文件复制到本地分支，对它们进行比较，合并您想要的任何更改，然后将结果推送回来。例如：

```
cd /my/project/directory
git checkout -b upstream
sftp -r user@example.com:/var/www/\* .
git add .
git commit -m 'Import current files from upstream.'
git checkout master
git diff upstream
: # merge or modify files as needed
sftp user@example.com:/var/www < <(echo 'put -r *') 
```

## 使用 SCP 而不是 SFTP

如果你不能使用 rsync，SCP 在非交互式操作方面通常比 SFTP 好得多。例如：

```
scp -r . user@example.com:/var/www/ 
```

SCP 提供更简洁的界面，并支持符号链接（SFTP 不支持），但可能对您的用例有其他限制。特别是，它可能不会打印它复制的空目录的名称；这是否重要取决于您。

# python - Pandas DataFrame 上的条件逻辑

> ID：14714181
> 
> 赞同：40
> 
> 时间：2013-02-05T18:17:37.657
> 
> 标签：python, pandas

如何将条件逻辑应用于 Pandas DataFrame。

请参阅下面显示的 DataFrame，

```
 data desired_output
0     1          False
1     2          False
2     3           True
3     4           True 
```

我的原始数据显示在“数据”列中，并且desired_output 显示在它旁边。如果 'data' 中的数字低于 2.5，则 desired_output 为 False。

我可以应用一个循环并重新构建 DataFrame ......但这将是“un-pythonic”

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-02-05T18:35:28.293

```
In [1]: df
Out[1]:
   data
0     1
1     2
2     3
3     4 
```

您想要应用一个函数，该函数根据选定的数据框列有条件地返回一个值。

```
In [2]: df['data'].apply(lambda x: 'true' if x <= 2.5 else 'false')
Out[2]:
0     true
1     true
2    false
3    false
Name: data 
```

然后，您可以将该返回的列分配给数据框中的新列：

```
In [3]: df['desired_output'] = df['data'].apply(lambda x: 'true' if x <= 2.5 else 'false')

In [4]: df
Out[4]:
   data desired_output
0     1           true
1     2           true
2     3          false
3     4          false 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-02-05T21:34:52.340

只需将该列与该值进行比较：

```
In [9]: df = pandas.DataFrame([1,2,3,4], columns=["data"])

In [10]: df
Out[10]: 
   data
0     1
1     2
2     3
3     4

In [11]: df["desired"] = df["data"] > 2.5
In [11]: df
Out[12]: 
   data desired
0     1   False
1     2   False
2     3    True
3     4    True 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2017-03-17T02:47:57.750

```
In [34]: import pandas as pd

In [35]: import numpy as np

In [36]:  df = pd.DataFrame([1,2,3,4], columns=["data"])

In [37]: df
Out[37]: 
   data
0     1
1     2
2     3
3     4

In [38]: df["desired_output"] = np.where(df["data"] <2.5, "False", "True")

In [39]: df
Out[39]: 
   data desired_output
0     1          False
1     2          False
2     3           True
3     4           True 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-02-05T21:58:25.553

在这个特定示例中，DataFrame 只有一列，您可以优雅地将其编写为：

```
df['desired_output'] = df.le(2.5) 
```

*`le`测试元素是否小于或等于 2.5，`lt`对于小于`gt`和`ge`.*

# c# - Visual Studio 2012 不能在 C# 网站中包含 VB 页面？

> ID：14714182
> 
> 赞同：0
> 
> 时间：2013-02-05T18:17:38.437
> 
> 标签：c#, visual-studio-2012

在 Visual Studio 2010 中，我可以在同一个网站中混合使用 VB 和 C# 页面以及用户控件。Visual Studio 2012 似乎不允许这样做。我创建了一个 C# web 项目，当我添加一些在 VB 中完成的旧页面时，它分别列出了 .ascx 和 .ascx.vb 文件并且不会编译。

我有一堆用 VB 完成的旧东西，所以请不要告诉我，我必须先将它们全部转换为 C#，然后才能使用 VS2012。

谢谢！

它是 ASP.NET Web 表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:31:48.927

您的问题可能是您自己说过，您创建了“Web 项目”与“网站”。Web Project 由 c# 或 vb 编译器编译成 DLL，不能包含不同的语言。网站由 ASP.NET 编译，每个页面都自行编译。

相信你正面临这种“现象”

# entity-framework - 在实体框架 5 查询中替换字符串

> ID：14714186
> 
> 赞同：3
> 
> 时间：2013-02-05T18:17:49.380
> 
> 标签：entity-framework

我正在使用 Entity Framework 5，当从数据库执行查询时，我想替换字段中的几个字符。

有什么办法可以用say may a 来做到这一点`EntityTypeConfiguration`？

或者以某种透明的方式？

# vim - VIMRC 未加载到 :tabe

> ID：14714187
> 
> 赞同：2
> 
> 时间：2013-02-05T18:17:57.847
> 
> 标签：vim, tabs

我有一些不同的配置，`~/.vimrc`例如突出显示空白问题等。当我通过创建新选项卡时`:tabe <file_name>`，后续选项卡会丢失所有这些。我可以`:so $MYVIMRC`让它加载，但这显然不理想。知道为什么会发生这种情况，或者我如何在创建新标签时加载它？

编辑：[这是我的 .vimrc](http://pastebin.com/GpSp4WK0)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:50:46.653

要突出显示和去除尾随空格，您可能对我的 [ShowTrailingWhitespace](http://www.vim.org/scripts/script.php?script_id=3966) 和[DeleteTrailingWhitespace](http://www.vim.org/scripts/script.php?script_id=3967)插件感兴趣，它们以更健壮的方式实现了这一点。（这些页面也包含指向替代插件的链接。）

# c# - 如何在 Windows 8 Metro 应用程序中从 WebView 获取 HTML 元素 onClick？

> ID：14714191
> 
> 赞同：2
> 
> 时间：2013-02-05T18:18:17.223
> 
> 标签：c#, html, windows-8, microsoft-metro

我有一个简单的 Win8 Metro 应用程序，它有三个页面，其中一个是 WebView。假设我有一些在 WebView 中显示的 html 代码，其中包含类似

```
<a href="http://www.mysite.com">Go to site</a> 
```

如何检测对该 HTML 元素的点击、识别元素并从该元素获取数据（比如说“ [http://www.mysite.com](http://www.mysite.com) ”）？这在 Metro 应用程序中是否可行？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:23:42.797

使用这些成员：

[LoadCompleted](http://msdn.microsoft.com/en-US/library/windows/apps/windows.ui.xaml.controls.webview.loadcompleted.aspx) - 等待页面加载完毕，

[InvokeScript](http://msdn.microsoft.com/en-US/library/windows/apps/windows.ui.xaml.controls.webview.invokescript.aspx) - 订阅 HTML 中的事件，

[ScriptNotify](http://msdn.microsoft.com/en-US/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx) - 从 JS 得到通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:21:24.477

如果您控制 mysite.com 的内容，就可以做到。您可以在您的网站上添加 Javascript 以触发事件，通过该事件可以使用[WebView.ScriptNotify](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.webview.scriptnotify.aspx)`window.external.notify`在您的 C# 中引发事件。有关示例，请参阅[本文](http://blogs.msdn.com/b/wsdevsol/archive/2012/10/18/nine-things-you-need-to-know-about-webview.aspx)中的如何从 WebView 接收信息。

不幸的是，没有办法拦截导航（与其他 Web 视图不同）。

# c++ - 如何修改由 Visual Studio 项目向导创建的窗口的标题

> ID：14714196
> 
> 赞同：0
> 
> 时间：2013-02-05T18:18:37.567
> 
> 标签：c++, visual-studio-2010, project, wizard

我已经使用 studio 2010 向导创建了一个 Visual C++ 项目，在向导的帮助下，我在其中添加了 FileView、ClassView、PropertiesWindow、OutputWindow 等内容。现在我有兴趣更改其中一项的默认标题/名称，比如 FileView。FileView 具有与其关联的资源字符串“IDS_FILE_VIEW”，其值“File View”显示为 FileView 窗口的标题。如果我在资源中更改上述字符串的值，它不会更改该标题，并且仍将“文件视图”显示为标题。谁能建议我如何自定义通过工作室向导创建的此类常见窗口的字幕和其他功能？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:31:55.097

您没有说，但我从“IDS”中假设您正在使用 MFC 库。

在 MFC 中，像 IDS_FILE_VIEW 这样的资源字符串是由设计人员定义和使用的，但很有可能覆盖它们。更改 IDS_FILE_VIEW 资源的值确实会更改使用该资源时显示的内容，但您可能（无意中）阻止了该资源在您期望的地方使用。

我将检查您的项目文件以查看此名称和相关名称出现的位置，并验证没有不一致之处。

HtH

露丝

# c# - 在中继器中查找和更改特定项目

> ID：14714198
> 
> 赞同：0
> 
> 时间：2013-02-05T18:18:38.543
> 
> 标签：c#, asp.net, repeater

我有以下内容`<asp:Repeater>`：

```
<asp:Repeater ID="repMenuParent" runat="server" DataSourceID="odsMenuParent" OnItemCommand="repMenuParent_OnItemCommand" OnItemDataBound="repMenuParent_OnItemDataBound" >
                <ItemTemplate>                        
                    <asp:Button id="btnRepeaterParent" runat="server" SkinID="btnAgroquimicos" CssClass="celdasMenusDinamicas" Text='<%# Eval("NOMBRE") %>' CommandName='<%# Eval("NOMBRE") %>' />
                 </ItemTemplate>
            </asp:Repeater> 
```

当 commandEvent 被触发时，我使用 commandName 和 uniqueId 建立了一个会话：

```
protected void repMenuParent_OnItemCommand(object source, RepeaterCommandEventArgs e)
{
    Session.Add("nombreSubMenuAgro", e.CommandName);

    String id = e.Item.UniqueID;
    Session.Add("souceId", id);        
} 
```

问题如下：我需要更改用户点击的中继器内按钮的前景色。在开始时，所有按钮（中继器中的项目）都是灰色的。单击某人时，我需要将其前景色更改为红色（如面包屑）。

我试图在 中找到该项目`itemDataBound`并比较 uniqueId 但它不起作用，我不知道如何找到单击以更改前景色的特定项目：

```
protected void repMenuParent_OnItemDataBound(object Sender, RepeaterItemEventArgs e)
{        
    String sessionID = "";
    Button btnRepeater;

    if ((e.Item.ItemType == ListItemType.Item) ||  (e.Item.ItemType == ListItemType.AlternatingItem))
    {
        btnRepeater = (Button)e.Item.FindControl("btnRepeaterParent");

        if (btnRepeater != null)
        {                
            if(btnRepeater.UniqueID.Equals(sessionID))
            {
                btnRepeater.ForeColor = System.Drawing.Color.FromArgb(69, 187, 32);
            }
        }
     }            
} 
```

我已经阅读了许多关于中继器的博客主题并找到了它的项目，但找不到任何解决我的问题的东西，可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:46:37.067

我认为这个问题最好用 Javascript 解决，尽管我确实为你提供了服务器端解决方案。

命令事件对象有一个名为 CommandSource 的属性。这使您可以访问触发命令事件的按钮。

```
protected void repMenuParent_OnItemCommand(object source, RepeaterCommandEventArgs e)
{
    Button btnRepeater=e.CommandSource;
    btnRepeater.ForeColor = Drawing.Color.Red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:12:47.753

如果您维护按下按钮的 ID 列表，则可以执行以下操作：

首先，将中继器中的按钮更改为使用`CommandArgument` ***not*** `CommandName`。像这样：

```
<asp:Button id="btnRepeaterParent" ... CommandArgument='<%# Eval("NOMBRE") %>' /> 
```

创建用于访问 ID 列表的页面级属性。像这样：

```
public List<string> ClickedIds
{
   get
   {
      if(Session("ClickedIds") == null)
         Session("ClickedIds") = new List<string>();

      return (List<string>)Session("ClickedIds");
   }
} 
```

单击中继器中的一个按钮时，请按以下方式处理：

```
protected void repMenuParent_OnItemCommand(object source, RepeaterCommandEventArgs e)
{
    this.ClickedIds.Add(e.CommandArgument);       
} 
```

现在，当您在代码隐藏中绑定中继器时，检查每个按钮，如下所示：

```
protected void repMenuParent_OnItemDataBound(object Sender, RepeaterItemEventArgs e)
{        

   if ((e.Item.ItemType == ListItemType.Item) ||  (e.Item.ItemType == ListItemType.AlternatingItem))
   {
      //retrieve the id of the data item
      //I am not sure of your data item structure, but it will be something to this effect
      int nombre = e.Item.DataItem("NOMBRE");

      if(this.ClickedIds.Contains(nombre))
      {
         ((Button)e.Item.FindControl("btnRepeaterParent")).ForeColor = System.Drawing.Color.FromArgb(69, 187, 32);
      }
   }            
} 
```

**免责声明：** 我没有测试过这段代码。

# c++ - 指向地址和内存堆栈的指针

> ID：14714200
> 
> 赞同：0
> 
> 时间：2013-02-05T18:18:50.407
> 
> 标签：c++, memory-management

```
void EventsStack::push(Event *e){
    EventNode *q = new EventNode();
    q->data = e;
    q->next = _top;
    _top = q;
}

void main() {
    EventsStack eventStack;
    Event e1(1);
    eventStack.push(&e1);
    Event e2(2);
    eventStack.push(&e2);
} 
```

第一个问题：我什么时候做

```
eventStack.push(&e1); 
```

我是否将 e1 的地址发送到 push 函数，而 push 函数将其作为指针接收？好像我在做：

```
Event *e = 1000 (1000 is the offset (address) of e1 for example on the stack) 
```

?

第二个问题：我被要求在运行 main 函数时说明堆栈。当我到达线路时

```
eventStack.push(&e1); 
```

是否将 4 字节返回地址和指向 e1 的 4 字节指针分配为函数的激活帧，或者在这种情况下没有激活帧，因为 eventStack 是 EventsStack 类的对象，并且 push 是其成员函数之一？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:54:55.553

关于您的第一个问题：表达式`&e1`采用 的地址`e1`，它是一个指针。换句话说，`e1` 有 type `Event`，并且`&e1`有 type`Event*`和一个值，这样取消引用它（一元运算`*`符）将具有与 using 相同的效果`e1`。这是您传递给 push 函数的内容。

并且指针不能只是堆栈上的偏移量，因为它必须可以从其他地方访问对象，而堆栈不一定可用。大多数现代台式机使用线性寻址，这意味着指针只是一个整数，但情况并非总是如此，在某些嵌入式处理器上可能并非如此（并且由于历史原因在某些大型机上）。

关于第二个问题：形式上，完全没有*说明*函数是如何调用的。必要的是编译器将返回地址和参数放在被调用函数可以找到它们的地方。在表达式`eventStack.push( &e1 )`中，函数有两个参数，地址`eventStack`（将成为 `this`函数中的指针）和表达式`&e1`。编译器如何传递这些变化很大，几乎总是取决于它们的类型，但*通常*，在大多数现代机器上，如果前 3 到 5 个参数适合（并且您传递的两个地址都适合），则它们将进入机器寄存器，因此推送到机器堆栈上的所有内容都是返回地址。并且参数通常不被视为当前帧的一部分，尽管在一些较旧的处理器上，编译器确实如此对待它们。（你说你被“要求说明堆栈”。这个问题是指特定的机器架构，还是什么？堆栈上实际发生的事情在编译器之间会有很大差异，Linux 下的 g++ 通常会做一些与 Visual 完全不同的事情工作室，即使在同一处理器上运行。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:25:39.847

关于您的第一个问题，是的：`&`运算符产生您的事件的内存地址。

至于你的第二个问题，嗯，很复杂。您所做的描述似乎表明了堆栈如何工作的潜在混淆。我强烈建议您阅读有关该主题的一些介绍性材料，这将使您有更深入的理解。

如果你去谷歌一下，几个小时后你就可以回答你自己的问题了:)。

# javascript - 使用 Bootstrap、Scrollspy 和 Collapse 嵌套、折叠侧边栏导航？

> ID：14714209
> 
> 赞同：3
> 
> 时间：2013-02-05T18:19:20.760
> 
> 标签：javascript, twitter-bootstrap, navigation, sidebar

我想创建带有子导航的侧边栏导航，当用户进入页面上的父部分时出现子导航：

例如[https://parse.com/docs/ios_guide#queries/iOS](https://parse.com/docs/ios_guide#queries/iOS)

![在此处输入图像描述](../Images/df8f0974a5792dc61b205490544c897d.png)

我认为使用引导程序的方法是结合`affix`,`scrollspy`和`collapse`插件，但是我不确定`collapse`当用户滚动到或单击到正确的父部分时如何触发正确的事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T22:51:52.947

对于其他想知道的人，我最终使用了[Tocify](https://github.com/gfranko/jquery.tocify.js)插件。不完全是我的想法，但做了我需要的。

# r - hasTsp(x) 中的回溯测试交易/错误：R 中指定的时间序列参数无效

> ID：14714210
> 
> 赞同：1
> 
> 时间：2013-02-05T18:19:22.363
> 
> 标签：r, testing, xts

[我在上一个问题（ Automatic vlookup and multiply coefficients with R](https://stackoverflow.com/questions/14694574/automatic-vlookup-and-multiply-coefficients-with-r) ）中对 Joshua Ulrich 的回答应用了不同的数据集，它给出了一个我无法解决的错误。

新数据集：巴西的 Bovespa 指数

（sp<-read.csv（“ [http://www.bolsapt.com/download/historico/%5EBVSP/de-01-01-2000-a-04-02-2013/](http://www.bolsapt.com/download/historico/%5EBVSP/de-01-01-2000-a-04-02-2013/) ”）

```
spLag <- lag(sp)

Error in hasTsp(x) : invalid time series parameters specified 
```

此致

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T18:49:04.380

@JoshuaUlrich 使用默认`getSymbols`返回一个`xts`对象。 `xts`对象专门设计用于处理时间序列数据。您正在尝试将相同的代码应用于`data.frame`更通用的数据类。要创建`xts`对象，您必须提供基于时间的索引。

```
sp.xts <- xts(sp[, 5:9], order.by=as.Date(sp[, 3], format="%Y%m%d"))
spLag <- lag(sp.xts) 
```

以上将 YYYYMMDD 列转换为正确`Date`的 s 并将其用作索引。请注意，`xts`对象的所有列必须属于同一类，因此我只包括数字列。

# iphone - Storyboard 中的 UITableView 显示为空

> ID：14714216
> 
> 赞同：0
> 
> 时间：2013-02-05T18:20:24.953
> 
> 标签：iphone, objective-c, ios5

这是我第一次使用 Storyboard 构建应用程序。我正在尝试使用自定义单元格创建 UITableView。我在 IB 中创建了单元格并为其创建了自定义 tableViewCell 类（添加了一些标签，创建了适当的插座，在 IB 中连接它们并将自定义类分配给 IB 中的自定义单元格）。

在负责 TableView 的 ViewController 中，我创建了数据源（带有一些数组的 dict）并填写了所有必需的方法（我已经尝试使用 UITableViewControler 和设置为 tableview 的委托和数据源的 UIViewController )

当我运行应用程序时 - 表格视图是空的。在做了一些 NSLogging 之后，我注意到数据源方法永远不会执行。我不知道为什么。

我现在为此疯狂了几个小时。请帮帮我:)

如果您需要查看代码或情节提要或其他任何内容，请告诉我。

**更新：**好的，经过一番挖掘，我决定测试相同的代码，但使用 NSMutableArray 作为数据源而不是 NSMutableDictionary。它有效！现在，有人可以向我解释为什么它不适用于 dict 吗？

这是做了什么。我有一个包含 5 个数组的字典，每个数组有 5 个字符串。

在 numberOfRowsForSection 方法中，我返回了 [dict count]

在 cellForRowAtIndexPath 方法中，我使用了这段代码

```
NSArray * routeArray = [dealsDict objectForKey:@"route"];
cell.routeName.text = [routeArray objectAtIndex:indexPath.row];

NSArray * companyArray = [dealsDict objectForKey:@"company"];
cell.companyName.text = [companyArray objectAtIndex:indexPath.row];

NSArray * priceArray = [dealsDict objectForKey:@"price"];
cell.priceLabel.text = [priceArray objectAtIndex:indexPath.row];

NSArray * dateArray = [dealsDict objectForKey:@"date"];
cell.dateLabel.text = [dateArray objectAtIndex:indexPath.row];

NSArray * monthArray = [dealsDict objectForKey:@"month"];
cell.monthLabel.text = [monthArray objectAtIndex:indexPath.row];
NSLog(@"I'm in here");

return cell; 
```

为什么它不想显示任何东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:23:09.493

在 IB 中，选择您的表格视图，并确保为您的控制器设置了`delegate`和出口`dataSource`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:22:46.017

UITableView 需要一些集合数据集作为数据源。它的委托方法“cellForRowAtIndexPath”被调用等于集合元素的数量（ARRAY）。像 numberOfRowsInSection 委托告诉表视图它需要为集合中的每个元素调用 cellForRowAtIndexPath。并且它还需要一些迭代器来每次读取下一个元素，如果是字典，它总是在每次调用 cellForRowAtIndexPath 时坚持相同的数据元素。我希望它能给你它工作的想法，如果你还需要知道什么，请告诉我。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
   return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
   return [self.data count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath  *)indexPath
{
  MessagesCell *cell = [tableView dequeueReusableCellWithIdentifier:@"messageCellIdentifier"];

  Message *msg = [self.data objectAtIndex:indexPath.row];
  cell.Name.text = msg.Name;
  cell.Message.text = msg.MessageText;
  cell.Time.text = msg.Time;

  return cell;
} 
```

# javascript - 由于 Ext Direct 和动态语言环境加载，如何避免嵌套异步回调？

> ID：14714217
> 
> 赞同：2
> 
> 时间：2013-02-05T18:20:28.553
> 
> 标签：javascript, extjs, asynchronous, extjs4, ext-direct

我正在使用 Ext JS 4.1 创建一个 CRM 类型的应用程序。为了连接到服务器端，我通过`RemotingProvider`.

在应用程序启动和渲染之前，我想通过 Ext Direct 从服务器检索一些全局变量，主要是当前登录用户的配置语言及其配置的权限。然后，根据用户的语言（根据该结果），我需要加载 Ext JS 语言环境文件和我自己的自定义语言环境文件。（请注意，必须在创建任何组件之前加载它们，因为之后不会应用它们。）

所以，程序是：

1.  通过获取 Globals`Ext.php.Globals.getGlobals`
2.  通过获取 Ext 语言环境`Ext.loader.loadScript`，
3.  通过获取应用程序语言环境`Ext.loader.loadScript`
4.  设置视口

从 1.-3 开始。是异步的，除了嵌套回调我没有其他方法：

```
Ext.application({
  name: 'MyApp',

  launch: function() {
    var app = this;

    // Welcome to callback hell...
    Ext.php.Globals.getGlobals(function(data) {
      // insert globals into app namespace
      Ext.apply(MyApp, data);

      // load ext locale
      Ext.Loader.loadScript({
        url: 'ext/locale/ext-lang-'+MyApp.currentUser.culture.toLowerCase()+'.js',
        onLoad: function() {
          // load app locale
          Ext.namespace('MyApp.locale');
          Ext.Loader.loadScript({
            url: 'app/locale/'+MyApp.currentUser.culture.toUpperCase()+'.js',
            onLoad: function() {

              // FINALLY, set up viewport
              var viewport = Ext.create('MyApp.view.Viewport', {
                controller: app
              });

              if (MyApp.util.hasPermission('usermgmt'))
                app.getController('Locations');

              // and so on ...

            }
          });
        }
      });
    });
  }
}); // end application 
```

有没有其他更优雅的方式来编写这段代码？我知道有用于异步流的库，但是这些库中的任何一个都可以在这里与 Ext JS API 一起使用吗？或者我可以以某种方式强制`Ext.syncRequire`为我加载语言环境（所以我只有一层嵌套用于`getGlobals`调用）？我自己的语言环境定义了一个类，但 Ext 语言环境没有。另外，这会以某种方式弄乱使用*Sencha Cmd*编译源文件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:10:25.647

你的概念有点奇怪，所以我有一些建议给你。我在许多项目中直接使用，其中大多数都需要本地化和相当复杂的 AC 管理。

*   您的应用程序甚至不需要在启动之前解析或加载某些内容。
*   应在加载主应用程序视图时提供语言和本地化
*   你的前端永远不应该解决任何访问控制。您可以（在大多数情况下）使用直接 API 完美地实现这一点
    *   将 API 减少到用户可以访问的这些操作（当应用程序主视图准备好时也会发生这种情况）

这使您的应用程序更快，您的生活更轻松。

**更新**

用户登录或仅请求主视图的时间，您应该有大量信息，例如支持的浏览器语言，或者至少在用户选择一种语言时。有了这些知识，您只需要准备视图。

前端中的 acl 不安全，需要在服务器端重新检查，因此应该避免或简单。直接使用最简单的方法是提供与用户访问权限匹配的 API，并在前端进行检查。那是一种隐式访问控制。如何实现这取决于 UI，但有很多方法

**更新 2**

为什么不为每种语言提供一个构建？我看不出有任何反对的理由。或者将框架从您的应用程序和类中分离出来，这样您就可以在客户端仍然可以使用缓存的框架库时进行更新。

可以轻松检查 API 的控制器（后端）访问和方法（后端）访问。控制器可能是您的选项卡，而操作可能是您的菜单元素。由于 API 是全局可用的，您只需要检查对象或属性是否存在。假设我们有一个名为`Car`和 Method的后端控制器，`Drive`我们可以像这样检查

```
if (Car) {
    // has controller access
    if (Car.Dirve) {
        // has access to the 'drive' action
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T01:43:47.793

除非我遗漏了一些非常明显的东西，否则我对此的看法将完全不同。

我在用户可能是 a`superuser`或 an的系统中有类似的场景`admin`，并且基于此主菜单将更改。

但我不会从 Ext 应用程序代码中向服务器查询此信息。相反，我的标题包含与直接加载方式非常相似的内容：

```
<script type="text/javascript" src="globals.php"></script> 
```

然后`globals.php`有一些类似的东西：

```
<?php
if ( $iUserIsSuperuser ) {
?>

gUserIsSuperuser = true;

<?php
}
?> 
```

那么对于语言环境 js 文件 - 你不能简单地使用条件在 index.php 中包含正确的文件吗？

# html - div 内的 100% 高度

> ID：14714222
> 
> 赞同：0
> 
> 时间：2013-02-05T18:20:39.380
> 
> 标签：html, css

我得到了以下代码，但它不起作用：

```
<div id="wrap">
    <div class="navigation">    
        <ul>      
            <li>
            </li>
        </ul>
     </div>

     <div id="main">
       Content
     </div>
</div> 
```

我希望包装是 100% 的高度。这工作得很好。但是，一旦我尝试将#main div 也设为 100% 高度，它就不会。这个 div 总是折叠到内容的高度。

```
html{height:100%;}
body{overflow-y:scroll; margin:0px; padding:0px; height:100%;}
#wrap{
    min-height: 100%; /* Mindesthöhe für moderne Browser */
    height:auto !important; /* Important Regel für moderne Browser */ 
    height:100%; /* Mindesthöhe für den IE */ 
    width:100%;
    position:absolute;
    overflow:hidden;
}

#main{
    width: 980px !important;

    height:100%; /* IE6: treaded as min-height*/
    min-height:100%; /* real browsers */
    height:auto !important;

} 
```

有人可以帮我解决这个问题吗？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:36:11.290

更改`wrap`. [现场演示](http://jsfiddle.net/PrH8S/)

```
#wrap {
    min-height: 100%; /* Minimum height for modern browsers */
    height:100%; /* Minimum height for IE */ 
    width:100%;
    position:absolute;
    overflow:hidden;
    border:1px solid blue;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:05:00.167

在您的情况下，#main div 似乎不一定需要扩展到 100%。需要扩展的是红色背景。

我建议使用“人造背景”。使用`position:fixed`，您可以添加不会随页面滚动的红色背景。其余的内容可以滚动它。像[这样](http://jsbin.com/izasil/1/)的东西。

```
html,
body {
  margin: 0px;
  padding: 0px;
  width: 100%;
  height: 100%;
}

div#background {
  position: fixed;
  width: 100%;
  height: 100%;
}

div#background div#color {
  position: relative;
  background-color: red;
  width: 980px;
  height: 100%;
  margin: 0px auto;
}

div#nav {
  position: relative;
  background-color: #FFF;
}

div#main {
  position: relative;
  width: 950px;
  margin: 0px auto;
}
```

```
<div id="background">
  <div id="color"></div>
</div>

<div id="nav">NAVIGATION<br />even two lines<br /> or more</div>

<div id="main">
  <p>CONTENT GOES HERE</p>
</div>
```

# php - 大型php文件上传

> ID：14714226
> 
> 赞同：1
> 
> 时间：2013-02-05T18:21:02.850
> 
> 标签：php, upload, ram

嘿伙计们。

所以...我有一个需要上传文件的网站，比如 500MB 大。

我的问题是……我需要什么样的系统要求？特别是关于记忆。要上传 500MB 的文件，我需要 500MB 内存吗？这种上传成功需要多少内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:22:54.837

PHP，或者更好的网络服务器，不会在 RAM 中缓冲整个上传。

上传大小不直接取决于 RAM 大小。我不能说你的系统到底应该是什么样子，但我可以说我几年前用低成本工作站处理了 GB 大小的更新。

请注意，如果要支持大上传，则必须更改以下 php.ini 设置：

```
upload_max_filesize = '500M';

post_max_size = '500M'; 
```

再次关于内存：注意不是PHP会消耗内存。Web 服务器将处理下载。在 PHP 中您无需担心这一点。

如果您使用 Linux 系统，您可以在键入时查看 tcp 缓冲区大小

```
cat /proc/sys/net/ipv4/tcp_rmem 
```

在终端。你会看到 3 个数字。以字节为单位的最小、中等和最大缓冲区大小。在我的系统上是：

```
4096    87380   4115680 
```

这意味着最大缓冲区大小约为 3.9MB，比您拥有的 500MB 小得多。

所以在这种情况下不用担心内存。网络很可能是瓶颈。

# ant - Ant获取文件创建时间戳

> ID：14714228
> 
> 赞同：3
> 
> 时间：2013-02-05T18:21:08.367
> 
> 标签：ant

我正在`manifest.xml`为 OpenCMS 项目构建 Ant 期间编写文件。

我需要能够提取文件的创建日期和文件的最后修改日期。（尽管当前进程`Wed, 31 Dec 1969 19:00:00 EST`无论如何都会给每个文件一个时间戳——至少在 Windows 机器上运行构建时是这样。）

有没有办法可以在 Ant 中提取文件的创建日期时间戳？我正在使用标准 Ant 任务和 Ant-Contrib 任务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T22:15:33.080

我有这个工作。

正如[Mark O'Connor](https://stackoverflow.com/a/14718827/368630)所指出的，您无法从早期版本的 Java 中获取文件创建时间。但是，用于此任务的原始 Java 程序对创建日期和最后修改日期^(1都使用了)[lastModified](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#lastModified())方法。我做同样的事情很好。

我创建了一个`<scriptdef>`从文件中提取上次修改日期的方法。在 Java 1.6 及更高版本中，您可以直接访问 Rhino JavaScript 库，因此您不再需要 BeanShell 库。

```
<scriptdef name="file.mdate" language="javascript"> 
    <attribute name="file"/> 
    <attribute name="property"/> 
        file_name = attributes.get("file"); 
        property_to_set = attributes.get("property");

        file = new java.io.File(file_name); 
        file_date = file.lastModified();

        date_format = new java.text.SimpleDateFormat("EEE, dd MMM YYYY HH:mm:ss zzz");
        formated_date = date_format.format(new java.util.Date(file_date));
        project.setNewProperty(property_to_set, formated_date);
</scriptdef> 
```

定义后，我可以将其用作 Ant 任务：

```
<file.mdate
    file="${file.name}"
    property="file.modified.date"/>
<echo>The file "${file}" was modified on ${file.modified.date}</echo> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T23:11:23.343

这取决于您的操作系统，fe Unix 不存储文件创建时间，[请参阅此处](https://unix.stackexchange.com/questions/24441/get-file-created-creation-time)
的详细信息 两种可能的解决方案：

解决方案 1，仅适用于 Java >= 6 的 Windows，无需插件

```
<project>
  <!-- Works on Windows only, uses the jdk builtin
       rhino javascript engine (since jdk6)
       use dir command without /T:C to get lastmodificationtime
  -->
  <macrodef name="getFileTimes">
    <attribute name="dir" />
    <attribute name="file" />
    <attribute name="setprop" default="@{file}_ctime" />
    <sequential>
      <exec executable="cmd" dir="@{dir}" outputproperty="@{setprop}">
        <arg value="/c" />
        <arg line="dir @{file} /T:C|find ' @{file}'" />
      </exec>
      <script language="javascript">
     tmp = project.getProperty("@{setprop}").split("\\s+") ;
     project.setProperty("@{setprop}", tmp[0] + "/" + tmp[1]) ;
   </script>
    </sequential>
  </macrodef>

  <getFileTimes dir="C:/tmp" file="bookmarks.html" />

  <echo>
  $${bookmarks.html_ctime} => ${bookmarks.html_ctime}
  </echo>
</project> 
```

解决方案 2，需要 Java 7 和 groovy-all-xxxjar（包含在[groovy 二进制版本](https://dl.bintray.com/groovy/maven/apache-groovy-binary-2.4.6.zip)中）
根据自己的喜好调整 SimpleDateFormat。
在 Unix 文件系统上，当询问创建时间时，您将获得最后修改时间。

```
<project>
  <taskdef name="groovy" classname="org.codehaus.groovy.ant.Groovy"/>

  <!-- Solution for Java 7, uses the nio package
       needs groovy-all-2.1.0.jar
  -->
  <macrodef name="getFileTimes">
    <attribute name="file"/>
    <attribute name="ctimeprop" default="@{file}_ctime"/>
    <attribute name="mtimeprop" default="@{file}_mtime"/>
    <sequential>
      <groovy>
      import java.nio.file.*
      import java.nio.file.attribute.*
      import java.text.*
      import java.util.date.*

      Path path = Paths.get("@{file}")
      BasicFileAttributeView view = Files.getFileAttributeView(path, BasicFileAttributeView.class)
      BasicFileAttributes attributes = view.readAttributes()
      lastModifiedTime = attributes.lastModifiedTime()
      createTime = attributes.creationTime()
      DateFormat df = new SimpleDateFormat("dd-MMM-yyyy hh:mm:ss", Locale.US)
      df.format(new Date(createTime.toMillis()))

      properties.'@{ctimeprop}' = df.format(new Date(createTime.toMillis()))
      properties.'@{mtimeprop}' = df.format(new Date(lastModifiedTime.toMillis()))
     </groovy>
    </sequential>
  </macrodef>

  <getFileTimes file="C:/tmp/bookmarks.html"/>

  <echo>
    $${C:/tmp/bookmarks.html_ctime} => ${C:/tmp/bookmarks.html_ctime}
    $${C:/tmp/bookmarks.html_mtime} => ${C:/tmp/bookmarks.html_mtime}
  </echo>
</project> 
```

我也尝试使用内置的 javascript 引擎，但出现如下错误：

```
sun.org.mozilla.javascript.internal.EvaluatorException: missing name after . operator 
```

IMO，对于简单的事情，使用 javascript`<script language="javascript">`就足够了，但如果你需要导入 java 包等......它是一个 PITA。Groovy 很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T23:20:59.117

问题是标准 Java File 对象只支持返回最后修改日期的方法：

*   [如何使用 Java 发现文件的创建时间？](https://stackoverflow.com/questions/32586/how-to-discover-a-files-creation-time-with-java)
*   [在 Java 中确定文件创建日期](https://stackoverflow.com/questions/2723838/determine-file-creation-date-in-java)

Java 7 使用新的 NIO 类解决了这个问题：

*   [http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html](http://docs.oracle.com/javase/tutorial/essential/io/fileAttr.html)

显然，要在 ANT 中利用这一点，您需要编写自定义任务或嵌入脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-16T15:50:53.080

[David Ws 的回答](https://stackoverflow.com/a/14739920/1930509)中有一个错误：它在第二次运行时不起作用，因为该属性在第二次运行时不会被覆盖。

变化：`project.setNewProperty`应该是`project.setProperty`

完整的代码片段：

```
<scriptdef name="filedate" language="javascript">
    <attribute name="file"/>
    <attribute name="property"/>
        <![CDATA[
            file_name = attributes.get("file");
            property_to_set = attributes.get("property");

            file = new java.io.File(file_name);
            file_date = file.lastModified();

            date_format = new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            formated_date = date_format.format(new java.util.Date(file_date));
            project.setProperty(property_to_set, formated_date);
        ]]>
</scriptdef> 
```

# jquery - 悬停在同一行中展开一个 Div 并缩小另一个 Div

> ID：14714229
> 
> 赞同：3
> 
> 时间：2013-02-05T18:21:12.930
> 
> 标签：jquery, css, html, jquery-animate

我正在一个网站上工作，每行有 2 个 div，每个 45%。我想设置它，以便如果您连续悬停在一个 DIV 上，该行中的另一个 DIV 将随着悬停的 DIV 展开而缩小，然后在悬停离开时恢复。缩小的 DIV 可能在行中悬停的 DIV 之前或之后，这就是我被卡住的地方。

HTML 将如下所示，一遍又一遍地重复：

```
<div class="row">
    <div class="cell upcoming">
        <img src="stills/press/press-logo-gdc2013.jpg" class="general"><p class="one">Panelist - Game Developers Conference 2013</p>
        <p class="two">[Panel Name TBD]</p>
        <p class="three"><b>Panel Date/Location:</b> [TBD] on March 25-29, 2013 at GDC (San Francisco, California)</p>
        <p class="three"><b>Panelists:</b> [TBD]</p>
        <p class="three"><b>Panel Blurb:</b> [TBD]</p>
    </div>

    <div class="cell upcoming">
        <img src="stills/press/press-logo-wizard-world-st-louis.jpg" class="general"><p class="one">Panelist - Wizard World St. Louis 2013</p>
        <p class="two">[Panel Name TBD]</p>
        <p class="three"><b>Panel Date/Location:</b> [TBD] on March 22-24, 2013 at Wizard World (St. Louis, Missouri)</p>
        <p class="three"><b>Panelists:</b> [TBD]</p>
        <p class="three"><b>Panel Blurb:</b> [TBD]</p>
    </div>
</div> 
```

“行”没有 CSS，但“单元格”的 CSS 是

```
div.cell { position:relative; margin:2px; float:left; width:45%; text-align:justify; vertical-align:top; border:2px solid; padding:10px; border-radius:25px; -moz-border-radius:25px; } 
```

部分JQUERY是这样的：

```
 $('.cell')
    .on('mouseenter', function(){
        $(this).animate ({width:"75%"},"slow);
    })
    .on('mouseleave', function(){
        $(this).animate ({width:"45%"},"slow);
    }); 
```

当然，我希望“行”中的另一个“单元格”（无论是左边还是右边）随着另一个的增长而缩小，但我不知道如何确定该行中“其他 DIV”的标识符" 或者让两件东西同时制作动画。

帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:26:18.950

您可以`siblings()`在这种情况下使用来获取其他`.cell`元素。

```
$('.cell')
    .on('mouseenter', function(){
        $(this).animate ({width:"75%"},"slow").siblings('.cell').animate({'width': '15%'}, "slow");
    })
    .on('mouseleave', function(){
        $(this).add($(this).siblings('.cell')).animate ({width:"45%"},"slow");
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:36:15.370

这是手风琴效果：[http ://components.developers4web.com/accordion-effect#TSAccordionHead695732](http://components.developers4web.com/accordion-effect#TSAccordionHead695732)

你也可以玩这个：[http ://www.w3schools.com/jquery/eff_fadeout.asp](http://www.w3schools.com/jquery/eff_fadeout.asp)

# vb.net - .Net / Windows 事件日志：设置“根据需要覆盖事件”时如何保留特定日志

> ID：14714230
> 
> 赞同：0
> 
> 时间：2013-02-05T18:21:15.060
> 
> 标签：vb.net, event-log

我们有一个记录大量事件的 VB.Net 2.0 应用程序。

按照惯例，为了在 HDD 空间用完时阻止应用程序失败，我们设置了“根据需要覆盖事件”选项。

这意味着我们在任何时候都只有大约 6 小时的日志可供我们使用。

大多数日志只是信息，可以丢弃，但是我们希望保留一些日志以进行故障排除。

由于业务政策，我们无法降低日志记录级别。

示例代码：

```
Private Shared Sub WriteToEventLog(ByVal message As String,
                                   ByVal type As EventLogEntryType,
                                   ByVal componentName As String)

    Dim eventLog As New EventLog("OurAppEvents")
    eventLog.Source = componentName 
    eventLog.WriteEntry(message, type)
End Sub 
```

有没有办法“保留”一个日志条目，以便在覆盖发生时它不会被删除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:21:15.060

当前的解决方法是记录到辅助日志：

```
Private Shared Sub WriteToEventLog(ByVal message As String,
                                   ByVal type As EventLogEntryType,
                                   ByVal componentName As String)

    Dim eventLog As New EventLog("OurAppEvents")
    eventLog.Source = componentName 
    eventLog.WriteEntry(message, type)

    If type = EventLogEntryType.Error Then

        Dim errorLog As New EventLog("OurAppErrors")
        errorLog.Source = componentName + "Error"
        errorLog.WriteEntry(message, type)

    End If

End Sub 
```

# asp.net - 编译器错误消息，因为类型存在于 GAC 中的两个版本的 DLL 中

> ID：14714231
> 
> 赞同：0
> 
> 时间：2013-02-05T18:21:17.987
> 
> 标签：asp.net, gac, episerver

我收到此错误消息：

```
Compiler Error Message: CS0433: The type 'EPiServer.Web.WebControls.LogGenerator' exists in both 'c:\WINDOWS\assembly\GAC_MSIL\EPiServer\5.2.375.236__8fe83dea738b45b7\EPiServer.dll' and 'c:\WINDOWS\assembly\GAC_MSIL\EPiServer\6.1.379.0__8fe83dea738b45b7\EPiServer.dll'

Source Error:

Line 387:           </div>
Line 388:       </form>
Line 389:       <EPiServer:LogGenerator ID="PixelImg" runat="server" />
Line 390:<script type="text/javascript">
Line 391:    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");

Source File: c:\Prokom\inter.oppdal.kommune.no_CMS6R2Blank\templates\Oppdal\MasterPages\MasterPage.master    Line: 389 
```

web.config 的一部分：

我需要第二个`bindingRedirect`，因为项目的 dll 正在使用它。是否可以在不从 GAC 中删除文件且不重新编译项目的情况下解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:01:03.150

重新编译不会帮助您，也不会将程序集移动到您的 bin 文件夹。您正在尝试同时使用我认为不支持的两个主要版本的 CMS。

我相信在 EPiServer CMS 7 中，LogGenerator API 和控件已被弃用。我认为您可以安全地完全删除该特定行。您可以使用 Google Analytics 或其他工具来收集统计信息。

你以后会遇到更多的麻烦。你为什么同时使用这两个版本？也许SO可以为您解决这个问题。

# javascript - 调整窗口大小的 Chrome 扩展

> ID：14714233
> 
> 赞同：2
> 
> 时间：2013-02-05T18:21:18.303
> 
> 标签：javascript, google-chrome, google-chrome-extension, window

我正在尝试制作一个非常简单的 Chrome 扩展程序。我想要的只是以下内容：一个“browser_action”工具栏图标，单击该图标时会执行以下任一操作（两者都可以）：

*   显示一个带有“全屏”链接的弹出窗口，单击该链接可将 chrome 窗口的大小调整为屏幕的完整大小。（优选）
*   只需单击工具栏图标本身即可使屏幕全尺寸。（还可以）

这应该很容易，我以前做过 chrome 扩展，但我无法让它工作。每次我尝试从我的 popup.html、popup.html 中包含的 js 或类似的 Chrome 中使用 chrome.windows api 时，都会阻止做任何事情。我什至尝试将代码注入到这样的虚拟选项卡中：

```
chrome.browserAction.onClicked.addListener(function(tab) {
var bkg = chrome.extension.getBackgroundPage();
chrome.tabs.create({url: "http://www.google.com"}, function(tab) {
    chrome.tabs.executeScript(tab.id, {file: "newtab.js"}, function() {
        //Callback
    });
}); 
```

});

其中`app.js`包含用于调整窗口大小的 chrome.windows 代码。每次我什么都得不到。我有`"permissions" : ["tabs","http://*/*", "https://*/*"]`，但我仍然无法完成这个非常简单的任务。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:00:22.383

我使用的是 Chrome 19，更新到 26 并且可以正常工作。Windows API 必须添加在全屏之间的某个位置，看起来像这样（在后台脚本中）：

```
chrome.windows.getCurrent(function(wind) {
alert(wind.id);
var maxWidth = window.screen.availWidth;
var maxHeight = window.screen.availHeight;
var updateInfo = {
    left: 0,
    top: 0,
    width: maxWidth,
    height: maxHeight
};
chrome.windows.update(wind.id, updateInfo);}); 
```

# sql - sql 如果存在则插入，如果两个表之间不存在则删除

> ID：14714235
> 
> 赞同：1
> 
> 时间：2013-02-05T18:21:30.030
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

寻找 SQL 查询来执行以下操作：

1.  如果它们在 table2 中不存在，则将列`x`的所有值插入`table1`到列`y``table2`
2.  `table2`如果 clumn 的值在列中`y`不再存在，则从列中删除记录`x``table1`

我尝试插入或忽略插入查询，但在 sql server 2008 R2 中没有运气

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:36:09.633

听起来非常适合 SQL Server [`MERGE`](http://msdn.microsoft.com/en-us/library/bb522522(v=sql.105).aspx)；

```
MERGE table2 AS t2
USING table1 AS t1
ON (t2.y = t1.x)
WHEN NOT MATCHED BY TARGET 
  THEN INSERT (y) VALUES(t1.x)
WHEN NOT MATCHED BY SOURCE
  THEN DELETE; 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!3/71290/1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:29:08.793

这会将 Table1 colX 中的所有记录插入到 Table2 colY 中：

```
INSERT INTO Table2 (ColY)
SELECT ColX 
FROM Table1
WHERE ColX NOT IN (SELECT ColY FROM Table2) 
```

您不能删除列中的所有记录。但是，您可以将它们设置为 NULL，或者如果您想删除行，您也可以这样做。让我们知道。

```
DELETE FROM Table2
WHERE ColY NOT IN (SELECT ColX From Table1) 
```

或者

```
UPDATE Table2
SET ColY = NULL
WHERE ColY NOT IN (SELECT ColX From Table1) 
```

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:38:10.900

您可以使用[合并语句](http://technet.microsoft.com/en-us/library/bb522522%28v=sql.105%29.aspx%22Merge%20Statement%22)

```
MERGE table2 AS t2
USING table1 AS t1
ON (t2.y = t1.x) 
WHEN NOT MATCHED BY TARGET 
    THEN INSERT(y) VALUES(t1.x)
WHEN NOT MATCHED BY SOURCE
    THEN DELETE 
OUTPUT $action, inserted.*, deleted.*; 
```

# html - 防止在onverflow中单击并拖动

> ID：14714239
> 
> 赞同：2
> 
> 时间：2013-02-05T18:21:42.533
> 
> 标签：html, css

我试图制作一个滑块，一切都很顺利，直到我把它放进`input`去。

如果我在输入中单击然后向右拖动，我的所有内容都会随着滚动而移动，即使他被设置`overflow`为`hidden`.

我用这个问题做了一个[**演示。**](http://jsfiddle.net/CqUtA/)

这是来源：

```
<div class="modal-content">
<div class="modal-content-slide">
    <div class="center-slide-content">               
        <div class="right-content">
            <div class="inside-content">
                <p>
                    Click inside the input and drag to the right
                </p>
                <p class="morrow-url-input-wrapper">
                    <input type="text" />
                </p>
            </div>  
        </div>
    </div>
</div> 
```

和CSS：

```
.modal-content {
  background-color: #ccc;
  position: relative;
  width: 550px;
  border-radius: 5px;
  margin: 20px;
  height: 240px;
  overflow: hidden;
}

.modal-content-slide {
  position: absolute;
  width: 2100px;
}

.right-content {
  background-color: #515151;
  width: 220px;
  height: 180px;
  padding: 10px;
  border-radius: 5px;
  box-shadow: #285b76 0 1px 1px;  
} 
```

我错过了什么，我该如何防止这种情况？

# php - 获取登录用户信息 - 调用未定义的函数

> ID：14714241
> 
> 赞同：0
> 
> 时间：2013-02-05T18:21:45.997
> 
> 标签：php, wordpress, login, runtime-error

我有一个 wordpress 网站，我想在 php 页面中显示登录用户的信息（例如他的用户名）。我已经看到了与此相关的帖子，我尝试了这个：

```
 <?php 
     global $current_user;
     get_currentuserinfo();
     echo $current_user->user_login;
    ?> 
```

但是，我收到一个错误“调用未定义的函数”......我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:29:03.977

您可能应该在调用 get_currentuserinfo() 函数之前插入 pluggable.php。更多信息[在这里](http://www.saphod.net/2009/01/28/call-to-undefined-function-get_currentuserinfo/)。

# excel - 如何在 Excel 中使用 VBA 获取当前行和访问列？

> ID：14714247
> 
> 赞同：2
> 
> 时间：2013-02-05T18:22:06.670
> 
> 标签：excel, vba

我在 Excel 电子表格中有一个表格。假设它有两列“Id”和“Name”。使用 VBA，我想使用工作表上的双击事件来捕获当前行中的“Id”和“Name”。

我使用 Intersect 函数来确定我感兴趣的表中是否发生了双击，但我不知道如何使用表列名访问​​行数据。

IE

```
Private Sub Worksheet_BeforeDoubleClick(ByVal target As Range, Cancel As Boolean)
   Dim user_rge as Range
   Set user_rge = Me.Worksheets("Data").Range("Users")
   If Not Intersects(user_rge, target) is Nothing Then
        Dim id as Integer
        Dim name as String
        ` What goes in here?
   End
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:32:32.413

您可以使用`ActiveCell.Row`. 对于列，您必须通过将其与源范围进行比较来检查用户是否单击了 ID 或名称。

IE

```
If ActiveCell.Column = users_rge.Columns(1) Then
   ID = ActiveCell.Value
   Name = ActiveCell.Offset(ColumnOffset:=1).Value
Else
   Name = ActiveCell.Value
   ID = ActiveCell.Offset(ColumnOffset:=-1).Value
End If 
```

注意：我还没有尝试过这段代码，我是根据我的想法写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T17:09:40.267

这就是我做的。在此示例中，“Main”是上面有表格的工作表。表的名称是“TableName”，其中有“columnXXXX”、“columnYYYY”和“columnZZZZ”列

我可能会创建一个名为 TableLookupByRange(tablename, columnname, range) 的辅助函数，您可以在其中传入表的名称、列的名称和包含您想要执行的行中任何位置的单元格的范围抬头。这也会清理代码。

```
Dim table_lo as ListObject
Dim main_ws as Worksheet
Set main_ws = Me.Worksheets("Main")
Set table_lo = main_ws.ListObjects("TableName")

rownum = target.Row - 1
columnXXXX_colnum = table_lo.ListColumns("columnXXXX").index
columnYYYY_colnum = table_lo.ListColumns("columnYYYY").index
columnZZZZ_colnum = table_lo.ListColumns("columnZZZZ").index

Dim columnXXXX As String
Dim columnYYYY As String
Dim columnZZZZ As Double

columnXXXX = trades_rge.Cells(rownum, columnXXXX_colnum).Value
columnYYYY = UCase(trades_rge.Cells(rownum, columnYYYY_colnum).Value)
columnZZZZ = trades_rge.Cells(rownum, columnZZZZ_colnum).Value 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T18:54:05.670

试试这个，因为你的代码几乎就在那里：使用[Range.Columns 属性](http://msdn.microsoft.com/en-us/library/office/ff837125.aspx)将 Target 与 user_range 列 1 和 2 进行比较。

```
Option Explicit
Private Sub Worksheet_BeforeDoubleClick(ByVal target As Range, Cancel As Boolean)
   Dim id as Integer
   Dim name as String
   Dim user_rge as Range

   Set user_rge = Me.Worksheets("Data").Range("Users")
   If Not Intersects(user_rge, target) is Nothing Then
      Select Case Target.Column
         Case user_rge.Columns(1)
              id = Target.Offset(0,0).Value
              name = Target.Offset(0,1).Value   
         Case user_rge.Columns(2)             
              id = Target.Offset(0,-1).Value
              name = Target.Offset(0,0).Value     
      End Select
   End If
End Sub 
```

# html - 正文中有动态数据时如何在LAST页面底部放置页脚

> ID：14714248
> 
> 赞同：6
> 
> 时间：2013-02-05T18:22:15.617
> 
> 标签：html, css

我正在尝试创建一个要求页脚必须放在最后一页底部的报告。报告正文根据从数据库返回的记录数动态加载。报告可以是 1 页或更多。

我尝试使用粘性页脚，这对于在网站上查看 HTML 是可以的，但是当报告的长度大于 1 页并且查看打印预览屏幕时，页脚与报告的正文和页脚重叠保留在第一页而不是移动到最后一页。

有没有人知道在创建可打印屏幕时在最后一页底部放置页脚的方法，该屏幕的格式正确，用户可以在不使用粘性页脚的情况下打印。

当有多个页面要打印时，我实现的粘性页脚在打印预览屏幕中无法正确显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:31:17.153

CSS

```
#sticky-footer 
{
    position: fixed;
    bottom: 0px;
}
@media print 
{
    #sticky-footer 
    {
        position: static;
        bottom: auto;
    }
} 
```

HTML

```
<div id="report-content">...</div>
<div id="sticky-footer">...</div> 
```

# wpf - TextBlock 背景属性删除拉伸

> ID：14714249
> 
> 赞同：3
> 
> 时间：2013-02-05T18:22:33.223
> 
> 标签：wpf, xaml, background, textblock, visualbrush

我有一个这样定义的 TextBox：

```
<TextBox>
    <TextBox.Background>
        <VisualBrush>
            <VisualBrush.Visual>
                <StackPanel>
                    <TextBlock Background="Blue" Opacity="0.5" Text="155"/>
                </StackPanel>
            </VisualBrush.Visual>
        </VisualBrush>
    </TextBox.Background>
</TextBox> 
```

它看起来像这样：

![在此处输入图像描述](../Images/f695cb4ccbd1716ad32477b140983440.png)

但是，当我删除该`Background`属性时，文本会像这样延伸：

![在此处输入图像描述](../Images/95330a9687bd0676c21cc239e9bb90b6.png)

有没有办法在不改变文本外观的情况下添加背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:35:50.850

如果您使用`Background="Transparent"`它将使用相同的布局但没有背景颜色。那是你想要做的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:42:55.630

我不知道为什么会发生此问题的解决方法是从文本块中删除背景属性并将其放在它后面，如下所示

```
 <Grid>
            <Rectangle Fill="Blue"/>
            <TextBox Height="100">
                <TextBox.Background>
                    <VisualBrush Stretch="Fill" TileMode="None" AlignmentX="Left" AlignmentY="Top">
                        <VisualBrush.Visual>
                            <StackPanel>
                                <TextBlock Margin="0" Padding="0" Opacity="0.5" Text="155"/>
                            </StackPanel>

                        </VisualBrush.Visual>
                    </VisualBrush>
                </TextBox.Background>
            </TextBox>
        </Grid> 
```

# php - 使用 php mysql 创建一个图片库网站

> ID：14714254
> 
> 赞同：-1
> 
> 时间：2013-02-05T18:23:05.193
> 
> 标签：php, mysql, e-commerce

我想开发一个部分是电子商务网站的网站。部分是电子商务，因为没有产品销售或任何支付网关要做。但是应该显示所有图像，用户注册等，就像任何其他网站一样。正如指定的那样，我不应该使用任何 CMS 。我想知道不使用任何 CMS 来拥有这样一个定制的网站是否可行。因为网站上要显示大约 150 张高质量的图像。

任何形式的建议都会非常有帮助和赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:27:06.203

是的，这应该不是问题。取决于您是否希望您的网站是静态的？您可以轻松地创建一个可以满足您要求的网站。如果你熟悉 Php 和 Mysqli，你应该没有问题。

**这就是我将如何解决您的问题：**

1- 创建一个简单的 $_SESSION 登录脚本（允许管理员获得访问权限，这将有自己的表）

2- 使用 Mysqli 数据库表来保存您上传的图像的所有记录。

3- 编写一个 Php 类来处理登录和用户管理（更改密码等），以及第二个类处理关于站点图像的 CRUD。该类应该/将把图像移动到指定的目录中，并且还将有效地更新数据库表。

4- 使用编写一个函数来获取所有图像并设置一个限制（例如 LIMIT 20）

5- 然后使用 Php 在 HTML 中对结果进行分页。创建第二个函数，它将从最后显示的结果中检索接下来的 20 个结果。

我相信这是做你想做的最简单的方法。

# c - libev 网络服务器读取文件

> ID：14714260
> 
> 赞同：1
> 
> 时间：2013-02-05T18:23:15.117
> 
> 标签：c, file, webserver, reactor, libev

在 C 中使用 libev 创建小型网络服务器时，在不阻塞反应器的情况下提供文件（打开、准备好、写入套接字）的最佳策略是什么？

我有一些建议一次阅读几个块，但我不确定这是否是正确的方法。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:23:32.100

> 我有一些建议一次阅读几个块，但我不确定这是否是正确的方法。

是的，这是一种非常标准的方法。

如果您在 Linux 上，您可能喜欢使用[`sendfile()`](http://www.kernel.org/doc/man-pages/online/pages/man2/sendfile.2.html). 这样，您就不必维护一个缓冲区，它以块的形式读取文件，然后通过套接字将其发送到该缓冲区中。

# jquery - 浏览器本地存储获取和设置 json 对象问题

> ID：14714262
> 
> 赞同：0
> 
> 时间：2013-02-05T18:23:34.197
> 
> 标签：jquery, json

我从网络服务接收到一个 json 格式的字符串。使用`jQuery.parseJSON`即时消息在客户端创建 JSON 对象（我可以毫无问题地访问它）。

在我使用`localStorage.setItem`将我的 JSON 对象添加到浏览器本地存储之后。当我做 a`localStorage.getItem`并且我得到一个`[object object]`并且我不知道如何像 JSON 对象一样访问我的对象时，我的问题就出现了。

你知道这是什么原因和解决办法吗？

谢谢

何塞。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:28:21.310

没错，您需要解析从中返回的 JSON，`localStorage.getItem()`然后您可以像使用类对象一样使用它。`localStorage.getItem()`重新调整 JSON 对象，您将不得不再次解析它以便使用它。您可以在 Firebug 中检查它是否是相同的 json。希望这会有所帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:33:38.630

您可以在存储对象之前对其进行字符串化，然后在检索它时对其进行解析：

```
var testObject = { 'one': 1, 'two': 2, 'three': 3 };
// Put the object into storage
localStorage.setItem('testObject', JSON.stringify(testObject));

//retrieve the object and parse it again
var retrievedObject = JSON.parse(localStorage.getItem('testObject')); 
```

# javascript - Javascript读取复选框并保存为数组

> ID：14714268
> 
> 赞同：0
> 
> 时间：2013-02-05T18:23:50.280
> 
> 标签：javascript, arrays, checkbox

我有许多像这样格式化的复选框......

```
<input type="checkbox" name="mybox" value="box1">Box 1</input>
<input type="checkbox" name="mybox" value="box2">Box 2</input>
<input type="checkbox" name="mybox" value="box3">Box 3</input>
<input type="checkbox" name="mybox" value="box4">Box 4</input>
<input type="checkbox" name="mybox" value="box5">Box 5</input> 
```

我正在尝试使用javascript读取哪些框被勾选并将它们保存为数组，我正在使用以下代码....

```
 function handleNotifyButtonClick() {
    var type = $.trim($("input[@name='mybox']:checked").each(function()
    {
    add $(this).val() to your array;
    })); 
```

但是由于某种原因它不起作用，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:26:56.287

> 将 $(this).val() 添加到您的数组中；

这是英语，不是 JavaScript。

试试这个：

```
var type = [];
$("input[name=mybox]:checked").each(function() {type.push(this.value)}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:26:41.107

这不是您执行[属性 equals selector](http://api.jquery.com/attribute-equals-selector/)的方式，并且您在那里有各种语法错误。但你在正确的轨道上。

```
function handleNotifyButtonClick() {
    var values = $('input[name="mybox"]:checked').map(function() {
        return this.value;
    }).get();
} 
```

[实例](http://jsbin.com/ofopas/1)| [源代码](http://jsbin.com/ofopas/1/edit)- 该示例还更正了 HTML 并演示了如何将`label`标签用于我认为您正在尝试做的事情。

我在那里做了什么：

*   使用属性等于选择器 ( `name="value"`)
*   用于[`map`](http://api.jquery.com/map/)获取值的映射
*   在我传递给的迭代器函数中`map`，我返回每个复选框的值（`this`是原始 DOM 对象，在元素`value`上是完全可靠的跨浏览器）`input`
*   用于[`get`](http://api.jquery.com/get)将返回的地图（奇怪的是，它是一个 jQuery 实例）转换为一个真正的数组

作为旁注，您永远不会使用`</input>`. `input`是一个[void 元素](http://www.w3.org/TR/html5/syntax.html#void-elements)，它不需要结束标签。

# machine-learning - 什么是最好的分类器

> ID：14714270
> 
> 赞同：0
> 
> 时间：2013-02-05T18:23:53.800
> 
> 标签：machine-learning, classification

例如，如果给定一个训练集，其中包含超过 10000 个数据点（训练集的大小）并且没有超过 100000 个的特征和接近 20 的类标签。那么在这种情况下，哪个分类器（决策树、svm、Naive 等方法贝叶斯，神经网络，提升）会给我最准确的分类测试数据的类标签。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T07:50:19.007

如评论中所述，没有一般规则。

但是，由于您有相当多的训练示例和非常多的特征，您可能需要某种鼓励特征稀疏的分类器。我会首先尝试使用 L1 或弹性网络惩罚的 SGD 线性分类器。

另请参阅[Andreas Mueller 的算法流程图来尝试](http://peekaboo-vision.blogspot.com/2013/01/machine-learning-cheat-sheet-for-scikit.html)：

![](../Images/676a1fc7d4ce0313efc4d67085978ed6.png)

# javascript - 在 HTML 画布内悬停时显示数值

> ID：14714272
> 
> 赞同：1
> 
> 时间：2013-02-05T18:24:14.383
> 
> 标签：javascript, canvas, graph, hover

这次没有代码。我已经成功地在画布中创建了一些从 mySQL 数据库中提取的图形。

我的问题是，我将如何沿着图表显示数据值？可能吗？

不找人给我写代码。只是在正确方向上的有用提示。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:26:38.237

您可以参考[https://developer.mozilla.org/en-US/docs/Drawing_text_using_a_canvas](https://developer.mozilla.org/en-US/docs/Drawing_text_using_a_canvas)在画布本身上绘制文本。

*或者*，您可以获取 x、y 位置并使用`position: absolute;`DIV 等在画布顶部覆盖工具提示等信息。

编辑：同意 Shmiddty 的评论，这可能更适合 SVG 的优势。如果您有兴趣，请参阅[gRaphael](http://g.raphaeljs.com/)以获取矢量图形填充。

# powershell-2.0 - Powershell：使用 PowerShell 计算文件夹中的项目

> ID：14714284
> 
> 赞同：112
> 
> 时间：2013-02-05T18:25:01.493
> 
> 标签：powershell-2.0

我正在尝试编写一个非常简单的 PowerShell 脚本，以提供给定文件夹 ( ) 中的项目总数（文件和文件夹`c:\MyFolder`）。这是我所做的：

```
Write-Host ( Get-ChildItem c:\MyFolder ).Count; 
```

问题是，如果我有 1 个或 0 个项目，该命令不起作用——它什么也不返回。

有任何想法吗？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2013-02-05T20:46:39.277

你应该`Measure-Object`用来数东西。在这种情况下，它看起来像：

```
Write-Host ( Get-ChildItem c:\MyFolder | Measure-Object ).Count; 
```

或者如果那太长了

```
Write-Host ( dir c:\MyFolder | mo).Count; 
```

并且在 PowerShell 4.0 中使用`measure`别名而不是`mo`

```
Write-Host (dir c:\MyFolder | measure).Count; 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-02-05T18:40:04.863

我终于找到了这个链接：

[https://blogs.perficient.com/microsoft/2011/06/powershell-count-property-returns-nothing/](https://blogs.perficient.com/microsoft/2011/06/powershell-count-property-returns-nothing/)

> 好吧，事实证明这是一个怪癖，正是因为目录中只有一个文件。一些搜索显示，在这种情况下，PowerShell 返回一个标量对象而不是一个数组。该对象没有 count 属性，因此没有任何可检索的内容。

解决方案——强制 PowerShell 返回一个带有`@`符号的数组：

```
Write-Host @( Get-ChildItem c:\MyFolder ).Count; 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-11-13T05:48:22.800

如果您需要加快进程（例如计算 30k 或更多文件），那么我会选择这样的东西..

```
$filepath = "c:\MyFolder"
$filetype = "*.txt"
$file_count = [System.IO.Directory]::GetFiles("$filepath", "$filetype").Count 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2015-08-13T12:22:02.383

仅文件

```
Get-ChildItem D:\ -Recurse -File | Measure-Object | %{$_.Count} 
```

仅文件夹

```
Get-ChildItem D:\ -Recurse -Directory | Measure-Object | %{$_.Count} 
```

两个都

```
Get-ChildItem D:\ -Recurse | Measure-Object | %{$_.Count} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-12-24T02:28:43.397

您也可以使用别名

```
(ls).Count 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-11T23:01:02.287

在 PowerShell 2.0 中递归计算目录中的文件

```
ls -rec | ? {$_.mode -match 'd'} | select FullName,  @{N='Count';E={(ls $_.FullName | measure).Count}} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-14T19:33:14.357

在 powershell 中，您可以使用多个命令来查找此命令 digit: `Get-Alias`;

所以可以使用的cammands是：

```
write-host (ls MydirectoryName).Count 
```

或者

```
write-host (dir MydirectoryName).Count 
```

或者

```
write-host (Get-ChildrenItem MydirectoryName).Count 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-27T13:02:53.557

计算文件夹中特定文件类型的数量。示例是统计 F: 盘上的 mp3 文件。

```
( Get-ChildItme F: -Filter *.mp3 - Recurse | measure ).Count 
```

在 6.2.3 中测试，但应该工作 >4。

# java - 数据库填充下拉菜单

> ID：14714288
> 
> 赞同：0
> 
> 时间：2013-02-05T18:25:14.053
> 
> 标签：java, jsp

大家好 我已经创建了一个 jsp 页面，其中我创建了两个从数据库填充的下拉菜单。当我测试页面时它工作正常，但我的经理告诉我下拉菜单中的字段需要如下图所示的背景颜色。我该怎么做呢？如果这些字段是硬编码的，我知道该怎么做，但我不知道在这种情况下怎么做。我的代码也在底部.. 谢谢！

```
 `<form:form method="POST" commandName="excsAnaSelNav">
      <br>
     <table width="100%">
         <tr>
     <td width="20%"></td>
  <td width="20%"> Type:
   <form:select id="type" onChange = 'checkType()'path="analysisEvents">
    <form:option value="All" label="--- All ---" />
                    <form:options items="${analysisEvents}" />
                </form:select>
                </td>

            <td width="20%"> Forecast ISC:<form:select path="iscCodes">
                <form:option value="All" label="--- All ---" />
                    <form:options items="${iscCodes}" />
                </form:select>
                </td>

          <td width="30%"><div id="sctry" style="visibility:hidden">
        Actual ISC: <select style="width:50px" id="actualisc">
        <option value="ALL" selected>All</option></select></div>` 
```

![下拉式菜单](../Images/ba279f5060d284baa24c7ac20301e98f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:29:58.457

您需要数据库中的表/列来指定与相应条目一起使用的颜色，或者脚本中引用这些内容的数组。创建 DropDown 时，您只需查询数据库/数组以获取与您放入选择框中的条目相对应的颜色。

我不擅长 JSP，所以这里有一些伪代码：

```
dropDownEntry = Query->Select Drop Down Entry
dropDownColor = Query->Select dropDownEntry Color

<select>
For Every dropDownEntry
  <option style='background-color: dropDownColor'>dropDownEntry</option>
End For
</select> 
```

# asp.net-mvc-3 - 如何使用 Html.ValidationSummary 只显示一条错误消息？

> ID：14714290
> 
> 赞同：2
> 
> 时间：2013-02-05T18:25:16.440
> 
> 标签：asp.net-mvc-3, razor, validation

我有一个观点（为简单起见跳过冗余代码）：

```
@model CompetencyModel
@using (Html.BeginForm())
{
    @Html.ValidationSummary()
    @Html.EditorFor(model => model.Results)
} 
```

当我提交时，如果内部验证失败`EditorFor`，ValidationSummary会显示来自 的每个项目**的所有验证消息的列表**`EditorFor`。

此屏幕截图是一个视图，其中`EditorFor`单行带有单选按钮：

![在此处输入图像描述](../Images/9f78352a6a2714006f2538aab95ef88c.png)

但我需要一条**错误消息**，只是说某事失败了。我试过：

```
@Html.ValidationSummary(true)
@Html.EditorFor(model => model.Results) 
```

但它没有显示任何东西。我试过

```
@Html.ValidationSummary(true)
@Html.EditorFor(model => model.Results)
@Html.ValidationMessageFor(model => model.Results, "ERROR !!!") 
```

但它没有显示任何东西。

我究竟做错了什么？谢谢你。

**解决方案** 这可以解决问题。

```
<style>.validation-summary-errors ul { display: none; }</style>
@Html.ValidationSummary("Can't save, you must answer all questions !!") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:35:00.297

[ValidationExtensions.ValidationSummary 方法](http://msdn.microsoft.com/en-us/library/dd460185%28v=vs.108%29.aspx)将始终返回项目的无序列表。

另一个人问了这个问题并选择使用JQuery隐藏项目： [https ://stackoverflow.com/a/10837702/1220302](https://stackoverflow.com/a/10837702/1220302)

您可以做的另一个解决方案是仅使用 CSS 的[nth-child](https://developer.mozilla.org/en-US/docs/CSS/:nth-child)伪标记显示列表中的第一项。这当然取决于您使用的浏览器版本：

我认为是这样的：

```
.validation-summary-errors ul li:nth-child(-n+1) {
    display:none;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-22T02:48:36.067

我认为您可以使用以下规则隐藏除第一条消息之外的所有消息：

```
.validation-summary-errors ul li:nth-child(n+2) {
    display:none;
} 
```

# phalcon - 设置成功后额外属性消失

> ID：14714292
> 
> 赞同：0
> 
> 时间：2013-02-05T18:25:26.547
> 
> 标签：phalcon

我正在尝试通过查找表获取与父对象相关的所有记录，并将它们直接插入模型中。我有一个对象 Role，它有很多（） RoleEndpoints。RoleEndpoints 属于 Role 和 hasMany() 端点。所有数据都完全按照我的预期检索，但是，在我设置后它似乎消失了。

```
<?php
class ACL {
    private $_di;

    public function __construct($di) {
        $this->_di = $di;
    }

    public function createACL() {
        if(!$this->_acl) {
            $this->_acl = new stdClass();

            $roles = $possibleRoles = Roles::find();

            /**
             * Check if there is at least one role out there
             */
            if($roles->count() > 0) {
                /**
                 * Iterate over all of the records
                 */
                while($roles->valid()) {
                    $endpoints = array();

                    /**
                     * Grab each role's endpoints through the relationship
                     */
                    foreach($roles->current()->getRoleEndpoints() as $roleEndpoint) {
                        $endpoints[] = Endpoints::findFirst($roleEndpoint->endpoint_id);
                    }

                    /**
                     * At this point, the endpoints exist in the current Role model;
                                            I tried several different approaches; this seemed the best
                     */
                    $roles->current()->endpoints = $endpoints;
                }

                /**
                 * Set object to loop through from the beginning
                 */
                $roles->rewind();

                /**
                 * Here is where my issue lies.
                 * 
                 * The endpoints attribute, which is set as a public attribute in the model class 
                 * gets unset for some reason
                 */
                while($roles->valid()) {
                    echo '<pre>';
                    var_dump($roles->current());
                    exit;
                } 
```

正如评论所说，在结果集的第二次迭代期间，端点属性 drop 出于某种原因变为空。我在这里做错了吗？我错过了一步吗？

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:12:24.930

迭代器遍历中缺少next()：

```
while ($roles->valid()) {

    $endpoints = array();

    /**
     * Grab each role's endpoints through the relationship
     */
    foreach ($roles->current()->getRoleEndpoints() as $roleEndpoint) {
        $endpoints[] = Endpoints::findFirst($roleEndpoint->endpoint_id);
    }

    /**
     * At this point, the endpoints exist in the current Role model;
     *  I tried several different approaches; this seemed the best
     */
    $roles->current()->endpoints = $endpoints;

    //Missing next
    $roles->next();
} 
```

此外，您不需要以这种方式迭代光标，只需一个 foreach 即可轻松阅读和维护：

```
$roles = Roles::find();

$roleEndpoints = array();

if (count($roles)) {
    foreach ($roles as $role) {

        $endpoints = array();

        /**
         * Grab each role's endpoints through the relationship
         */
        foreach ($role->getRoleEndpoints() as $roleEndpoint) {
            $endpoints[] = Endpoints::findFirst($roleEndpoint->endpoint_id);
        }

        /**
         * At this point, the endpoints exist in the current Role model;
         *  I tried several different approaches; this seemed the best
         */
        $roleEndpoints[$role->id] = $endpoints;    
    }
}

//Get the endpoints
foreach ($roleEndpoints as $roleId => $endpoint) {
    //...
} 
```

此外，如果这是一项常见任务，您可以向模型添加一个方法以重用该逻辑：

```
class Roles extends Phalcon\Mvc\Model
{

    public function getEndpoints()
    {
        $endpoints = array();
        foreach ($this->getRoleEndpoints() as $roleEndpoint) {
            $endpoints[] = Endpoints::findFirst($roleEndpoint->endpoint_id);
        }
        return $endpoints;
    }

    public function initialize()
    {
        //...
    }
} 
```

所以你可以得到你的端点：

```
$roles = Roles::find();
if (count($roles)) {
    foreach ($roles as $role) {                    
        $endpoints = $role->getEndpoints();    
    }
} 
```

# java - 为什么第一个 for 循环迭代被跳过？

> ID：14714293
> 
> 赞同：0
> 
> 时间：2013-02-05T18:25:37.897
> 
> 标签：java

我的代码产生了意想不到的结果。似乎我的 for 循环跳过了第一次迭代，我不明白为什么。

```
public static void main(String[] args) {

    Scanner get = new Scanner(System.in);
    int number;

    // Ex.1.

    String family_name;
    String[] family_array;

    System.out.println("Enter number of family members: ");
    number = get.nextInt();
    family_array = new String[number];

    for(int i = 0; i < number; i++){
        System.out.println("Enter family member name: ");
        family_name = get.nextLine();
        family_array[i] = family_name;
    }

    for(int i = 0; i < number; i++){
        System.out.println(family_array[i]);
    }

} 
```

返回...（假设输入的数字是名称）

```
Enter number of family members: 
5
Enter family member name: 
Enter family member name: 
1
Enter family member name: 
2
Enter family member name: 
3
Enter family member name: 
4

1
2
3
4 
```

为什么第一个 get.nextLine() 被跳过？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:29:04.983

目前，您对[Scanner#nextInt](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#nextInt%28%29)的调用不使用换行符，因此它被传递给您的第一次调用`Scanner#nextLine`，因此它不会*阻塞*。

您将需要添加

```
get.nextLine(); 
```

在调用之后，`nextInt`以便您的第一次调用`nextLine`将阻止`IO`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T18:29:42.497

注意到 4 和 1 之间的空白行了吗？

```
4
       //this is it
1 
```

当您调用 get.NextInt() 时，您不会吃掉整行，而只会吃下一个 int。该行的剩余部分在您的第一次循环迭代中被吃掉。读取 int 后添加对 get.nextLine() 的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:33:26.803

对我有用的是`Scanner`在每次迭代中实例化一个新的：

```
for(int i = 0; i < number; i++)
{
    System.out.println("Enter family member name: ");

    Scanner loopGet = new Scanner(System.in);
    family_name = loopGet.nextLine();
    family_array[i] = family_name;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T18:34:18.193

```
 number = get.nextInt();
     // if i enter 4 then it will 4\n and nextInt will take only 4 
     // and the \n will be taken as input by the getline.
    get.nextLine();  
     //this will return the "" from ""\n . so adding this will solve your problem
    family_array = new String[number]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T18:35:26.150

我要说这是因为你仍然有一个缓冲的 CR/LF - 所以第一个设置为空白。请注意打印您的姓氏（数字）时的空白行。那是你的空白姓氏。

键盘输入是一个缓冲流——它有你的 5，它有一个 CR/LF（或者可能只是一个 LF，取决于你的操作系统）。

您可能想要获取 LINE，然后执行 string.convert、atoi、system.convert（无论哪个用于 Java）来获取 #。

# visual-studio-2010 - 是否可以仅从键盘访问 Visual Studio 中的 Diamond 指南？

> ID：14714296
> 
> 赞同：0
> 
> 时间：2013-02-05T18:25:50.133
> 
> 标签：visual-studio-2010, keyboard-shortcuts

我已经开始参加无鼠标星期一和星期五的活动。我已将窗口浮动和停靠选项卡设置为热键，以便我将它们拉出或放回；但是，我希望能够选择将选项卡式文档放在哪个位置。我在横向模式下操作，所以我经常在 Visual Studio 中有一个底部和一个顶部窗口。我想按一个热键并将选定的文档发送到钻石指南的那个部分。任何人都知道一个插件或我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:06:44.290

有一整篇文章专门介绍了[仅使用键盘来导航 IDE](http://msdn.microsoft.com/en-us/library/k8hcfy22%28v=vs.100%29.aspx)，其中有一节介绍了使用键盘上的菱形指南来停靠窗​​口和选项卡。所以是的，这是可能的，你不需要插件：

> ### 从键盘移动和停靠工具窗口
> 
> 1.  导航到您打算移动的工具窗口并为其提供焦点。
>     
>     
> 2.  在**窗口**菜单上，单击**可停靠**。
>     
>     
> 3.  按**ALT** +**空格键**，然后选择**移动**。
>     
>     
>     
>     出现对接指南菱形。
>     
>     
> 4.  使用**箭头**键将窗口移动到新位置。
>     
>     
>     
>     当您使用**箭头**键时，鼠标指针随窗口移动。
>     
>     
> 5.  到达新位置后，使用**箭头**键将鼠标指针移到引导菱形的正确部分上。
>     
>     
>     
>     工具窗口的轮廓出现在新的停靠位置。
>     
>     
> 6.  按**ENTER**。
>     
>     
>     
>     工具窗口在新的停靠位置卡入到位。

或者，您可以通过一个名为[MouseKeys](http://windows.microsoft.com/en-US/windows7/Use-Mouse-Keys-to-move-the-mouse-pointer)的漂亮系统辅助功能来简单地用键盘控制鼠标指针来作弊。

# c# - C#图像处理很慢

> ID：14714297
> 
> 赞同：1
> 
> 时间：2013-02-05T18:25:50.993
> 
> 标签：c#, winforms, image, processing

在过去的几个月里，我一直在开发一个应用程序，它的一个功能是它可以裁剪图像。所以，我编写了一个绘制透明橙色矩形的函数，以向用户显示裁剪区域，但它的工作速度非常慢 - 任何人都可以帮助我/告诉我一种让它更快的方法吗？

这是代码：

```
Image source;

private void pictureBox1_MouseDown(object sender, MouseEventArgs e) {
    mousePos = e.Location;
}

Point mousePos;

private void pictureBox1_MouseMove(object sender, MouseEventArgs e) {
    if (e.Button == MouseButtons.Left) {
        Image editSource = new Bitmap(source);
        Graphics g = Graphics.FromImage(editSource);
        SolidBrush brush = new SolidBrush(
            Color.FromArgb(128, Color.Orange.R, Color.Orange.G, Color.Orange.B));

        int width = e.X - mousePos.X;
        if (width < 0) {
            width *= -1;
        }

        int height = e.Y - mousePos.Y;
        if (height < 0) {
            height *= -1;
        }

        Size cropRectSize = new Size(width, height);
        Rectangle cropRect = new Rectangle(mousePos, cropRectSize);
        g.FillRectangle(brush, cropRect);
        pictureBox1.Image = editSource;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:29:54.597

使其更快的方法是不要在鼠标移动时创建位图。如果您需要在图形表面上绘图，请不要创建新的位图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T18:33:58.707

1.  不要使用图片框。添加您自己的[用户绘制控件](http://msdn.microsoft.com/en-us/library/b818z6z6.aspx)。
2.  On`MouseMove`只是[使](http://msdn.microsoft.com/en-us/library/8dtk06x2.aspx)更改的区域无效
3.  在 Draw 中，直接写入图形对象，不要玩内存位图

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:19:11.963

所以，除了不使用图片框的所有建议......我会给你一个方法来做它;）

这背后的想法是只使用鼠标移动、鼠标按下等来存储应该绘制的内容。然后在绘制它时使用存储的状态。每当您在图片框上按下鼠标时，这都会绘制一个橙色矩形（即使建议不要使用图片框，也可以将相同的方法用于其他表面。）。

```
 Point startPoint;
    Point currentPoint;
    bool draw = false;
    private void pictureBox1_MouseDown(object sender, MouseEventArgs e)
    {
        startPoint = e.Location;
        draw = true;
    }

    private void pictureBox1_MouseUp(object sender, MouseEventArgs e)
    {
        draw = false;
    }

    private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
    {
        currentPoint = e.Location;
        pictureBox1.Invalidate();
    }

    private void pictureBox1_Paint(object sender, PaintEventArgs e)
    {
        if (draw)
        {
            int startX = Math.Min(startPoint.X, currentPoint.X);
            int startY = Math.Min(startPoint.Y, currentPoint.Y);
            int endX = Math.Max(startPoint.X, currentPoint.X);
            int endY = Math.Max(startPoint.Y, currentPoint.Y);
            e.Graphics.DrawRectangle(Pens.Orange, new Rectangle(startX, startY, endX-startX, endY-startY));
        }
    } 
```

# ruby - 当放入网页文本文件时，Ruby 可以识别这些值

> ID：14714298
> 
> 赞同：0
> 
> 时间：2013-02-05T18:25:51.530
> 
> 标签：ruby, selenium-webdriver

我的 Excel 中有一些值如下：

```
1136-ΑΓΙΩΝ ΑΝΑΡΓΥΡΩΝ
1137-ΑΙΓΑΛΕΩ 
```

但是当我将这些脚本放入网页文件时，它们将保存到如下字段中：

```
136-αΓ?Ω? α?α?Γ??Ω?
1137-α?Γα?εΩ 
```

我正在使用 Ruby 1.9.3 最新版本。我正在使用带有 Excel - 2010 的 win32ole 库。

```
until number_of_list_values == 0

  number_of_list_values = number_of_list_values - 1
  element = driver.find_element :id => "codeExt"
  element.send_keys wbs.cells(rows,2).value
  element = driver.find_element :id => "descriptionExt"
  element.send_keys wbs.cells(rows,3).value
  driver.find_element(:name, "btnSaveandNew").click if 
number_of_list_values != 0
  wbs.cells(rows,5).value = "done"
  rows = rows + 1
  driver.find_element(:name, "btnSave").click if number_of_list_values 
== 0

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:50:57.623

您必须以某种方式设置正确的编码才能读取这些值

# php - Wordpress 调整图像大小并在帖子中显示为拇指

> ID：14714299
> 
> 赞同：0
> 
> 时间：2013-02-05T18:26:01.587
> 
> 标签：php, wordpress

我在functions.php中设置了裁剪来调整帖子图像的大小。

来自 Wordpress 的法典：[add_image_size](http://codex.wordpress.org/Function_Reference/add_image_size)，[post_thumbnail](http://codex.wordpress.org/Post_Thumbnails)

```
 add_theme_support('post-thumbnails');
  set_post_thumbnail_size(100, 100, true); //size of thumbs
  add_image_size( 'post-thumb', 180, 180, true ); //(cropped) 
```

用法如下

```
<?php if ( has_post_thumbnail() ) { the_post_thumbnail( 'post-thumb' ); } ?> 
```

但它不会调整拇指大小并显示原始大小。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:30:30.587

Wordpress 只会在上传时调整图像大小，您可以使用[此插件](http://austinmatzko.com/wordpress-plugins/filosofo-custom-image-sizes/)即时调整图像大小，因此第一次调用不存在的图像大小时，此插件将调整图像大小，以便下次图像大小存在。

# c++ - 10.6.8 上 Xcode 中 Cinder 教程早期部分的 getOpenFilePath 错误

> ID：14714305
> 
> 赞同：0
> 
> 时间：2013-02-05T18:26:13.807
> 
> 标签：c++, xcode, boost, osx-snow-leopard, cinder

我刚刚在运行 OSX 10.6.8 的 Macbook Pro 上下载了 Cinder v0.8.4，并开始使用 Xcode 完成 Welcome to Cinder 的第 1 章。我使用 Tinderbox 工具创建了一个名为 CinderProjectApp 的带有默认选项的新项目。我还按照说明确保我的 boost 库与默认库 (1.4.2) 相同。

当我开始学习本教程时，我想看看是否可以从 /resources 文件夹加载我自己的图像，因此我下载了一个图像“Broccoli.jpg”并将其添加到我的 CinderProjectApp/resources/ 目录中。

这是我的 draw() 函数：

```
void CinderProjectApp::draw()
{
    gl::clear( Color( 0, 0, 0 ), true );

    try
    {    
        std::string p = FilePath( "", ImageIo::getLoadExtensions() );    

        if( ! p.empty() ) 
        { // an empty string means the user canceled    
            myImage = gl::Texture( loadImage( p ) );
        }
    }

    catch( ... ) 
    {
        console() << "Unable to load the image." << std::endl;
    }

    gl::draw(myImage, getWindowBounds());
} 
```

当我编译整个小型 CinderProjectApp.cpp 代码时，**出现错误：从 'boost::filesystem3::path' 转换为非标量类型 'std::basic_string, std::allocator >' 请求**的行我指定文件的路径。由于这在语法上看起来是有效的，我想知道 getOpenFilePath 出了什么问题。

如果您需要查看其余代码，请告诉我。顺便说一句，我[在这里](https://forum.libcinder.org/#Topic/23286000001471037)交叉发布了我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T19:12:51.820

感谢[Paul 和 Sansumbrella](https://forum.libcinder.org/topic/problem-implementing-getopenfilepath-in-first-part-of-tutorial)在 forum.libcinder.org 的帮助，我已将我的 try-catch 移至 setup 函数（为了提高效率），并使用 ci::fs::path 对象来保存路径。这是我的新 setup() 函数（假设除了 try-catch 逻辑的重新排序之外，上面的 draw() 中的所有内容都没有改变）：

```
void CinderProjectApp::setup()
{

    try 
    {   
        ci::fs::path p = getOpenFilePath( "", ImageIo::getLoadExtensions());

        if( ! p.empty() ) 
        { // an empty string means the user canceled
            myImage = gl::Texture( loadImage( p ) );
        }
    }

    catch( ... ) 
    {
        console() << "Unable to load the image." << std::endl;
    }
} 
```

# http - nginx反向代理上的应用程序重定向错误

> ID：14714310
> 
> 赞同：2
> 
> 时间：2013-02-05T18:26:36.627
> 
> 标签：http, redirect, nginx, go, reverse-proxy

我正在运行 nginx (0.7.67) 作为反向代理和 golang 应用程序。nginx服务器配置如下：

```
...
location /bar/ {
  proxy_pass http://localhost:8088/;
  proxy_redirect off;
  proxy_set_header  Host               $host;
  proxy_set_header  X-Real-IP          $remote_addr;
  proxy_set_header  X-Forwarded-For    $proxy_add_x_forwarded_for;
  proxy_set_header  X-Forwarded-Proto  https;
}
... 
```

我的golang应用的源码（没有意义，只是一个例子）：

```
func root(w http.ResponseWriter, r *http.Request) {
  fmt.Fprint(w, "You reached root")
}

func foo(w http.ResponseWriter, r *http.Request) {
  http.Redirect(w, r, "/", http.StatusFound)
}

func main() {
  http.HandleFunc("/", root)
  http.HandleFunc("/foo", foo)
  http.ListenAndServe("localhost:8088", nil)
} 
```

**问题：**当我将浏览器定向到应用程序的 URL ( [https://domain.tld/bar/](https://domain.tld/bar/) ) 时，我可以看到文本“您已到达根目录”。但是，如果我尝试打开[https://domain.tld/bar/foo](https://domain.tld/bar/foo)，我会被重定向到[https://domain.tld](https://domain.tld)而不是[https://domain.tld/bar](https://domain.tld/bar)。似乎我的应用程序正在重定向到 nginx 服务器的根目录，而不是应用程序。

**问题：**如何从应用程序内部（在 nginx 反向代理后面运行）重定向到应用程序的根目录，而不是服务器的根目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:34:38.533

这是任何语言都无法自动解决的问题，即使是 PHP。诸如 wordpress 之类的应用程序所做的是具有指定根的设置。某些应用程序需要完整的 url ( [https://domain.tld/bar](https://domain.tld/bar) ) 或者可以只有一个路径 (/bar)。

无论哪种方式，您都需要创建一个设置，然后从那里手动配置所有重定向。您可以创建自己的重定向功能，这样您就不需要在每次进行重定向时都实现它。

# javascript - 如何在 YUIDoc 中评论对象文字

> ID：14714314
> 
> 赞同：2
> 
> 时间：2013-02-05T18:26:55.663
> 
> 标签：javascript, yui, javadoc

在 YUIDoc 中，我想注释作为参数传递的对象文字。请参阅以下代码片段：

```
@param {Array} colDefs Array of object literal column definitions for the grid<ul>
    <li>title -  Column header display</li>
    <li>key -  The key of the column from the JSON data array</li>
    <li>type - The data type of the column.  </li></ul> 
```

我要添加哪些标签到列表项，以便我可以指定属性的类型（字符串、对象等）？如果我添加 {String} 它只是显示为文本，而不是我使用 @param 标签获得的漂亮格式。

也许这甚至不可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T18:38:55.523

您可以通过首先指定配置对象然后将所有属性指定为`object.property`参数来记录配置对象。它看起来像这样：

```
 /**
 @param {Object}  config          Object literal containing configuration parameters
 @param {Boolean} config.useFoo   Whether to use Foo or not
 @param {String}  [config.option] An optional string parameter
 */ 
```

# r - 在SPSS中同时选择行和列

> ID：14714322
> 
> 赞同：0
> 
> 时间：2013-02-05T18:27:45.443
> 
> 标签：r, spss

我在 SPSS 中有一个数据集，它有 100K+ 行和 100 多列。我想同时将行和列过滤到一个新的 SPSS 数据集中。

我可以使用`subset`R 中的命令轻松完成此操作。例如：

```
new_data = subset(old_data, select = ColumnA >10, select = c(ColumnA, ColumnC, ColumnZZ)) 
```

更容易的是：

```
new data  = old_data[old_data$ColumnA >10, c(1, 4, 89)] 
```

我在哪里传递列索引。

SPSS中的等价物是什么？

我喜欢 R，但 SPSS 的读/写和数据管理速度要好得多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T05:45:02.997

我不确定您在写“SPSS的读/写和数据管理速度明显优于R”时所指的是什么。您的问题本身证明了R在数据管理方面的灵活性！而且，10 万行 100 列的数据集绝不是一个大数据集。

但是，要回答你的问题，也许你正在寻找这样的东西。我提供的是“程序化”解决方案，而不是 GUI 解决方案，因为您在 Stack Overflow 上提出问题，其中重点更多地放在事物的编程方面。我正在使用可以在此处找到的示例数据文件：http: [//www.ats.ucla.edu/stat/spss/examples/chp/p004.sav](http://www.ats.ucla.edu/stat/spss/examples/chp/p004.sav)

将该文件保存到 SPSS 工作目录，打开 SPSS 语法编辑器，然后键入以下内容：

```
GET FILE='p004.sav'.
SELECT IF (lactatio <= 3).
SAVE OUTFILE= 'mynewdatafile.sav'
  /KEEP currentm previous lactatio.
GET FILE='mynewdatafile.sav'. 
```

但是，更有可能的是，您将不得不经历这样的事情：

```
FILE HANDLE directoryPath /NAME='C:\path\to\working\directory\' . 
FILE HANDLE myFile /NAME='directoryPath/p004.sav' . 
GET FILE='myFile'.
SELECT IF (lactatio <= 3).
SAVE OUTFILE= 'directoryPath/mynewdatafile.sav'
  /KEEP currentm previous lactatio.
FILE HANDLE myFile /NAME='directoryPath/mynewdatafile.sav'.
GET FILE='myFile'. 
```

您现在应该创建了一个只有三列的新文件，并且“lactatio”列中的任何值都不大于 3。

所以，基本步骤是：

1.  加载您要使用的数据。
2.  您感兴趣的所有案例的所有列的子集。
3.  保存一个仅包含您感兴趣的变量的新文件。
4.  在继续之前加载该新文件。

使用 R，基本步骤是：

1.  加载您要使用的数据。
2.  使用您的行和列子集创建一个对象（您知道该怎么做）。

嗯....我不了解你，但我知道*我*更喜欢哪种方法；）

如果您在 R 中使用正确的工具，如果速度确实是个问题，您也可以直接*读取*您感兴趣的特定子集，而无需先加载整个数据集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-26T07:10:37.813

在 spss 中，您不能在一个命令中组合这两个操作，但很容易将其分为两个：

```
dataset copy old_data. /* delete this if you don't need to keep both old and new data.
select if ColumnA>10.
add files /file=* /keep=ColumnA ColumnC ColumnZZ. 
```

# google-maps - 信息框标签未按预期偏移

> ID：14714323
> 
> 赞同：0
> 
> 时间：2013-02-05T18:27:51.607
> 
> 标签：google-maps

我正在使用 Google Maps V3 API 的实用程序库中的 InfoBox 类来制作与点关联的标签。

现在，我的目标是让标签整齐地围绕一个点流动，但正如您所见，这并没有发生：

[图片](http://i47.tinypic.com/w0kode.jpg)

从 InfoBox 规范中可以看出，pixelOffset 采用 Size 对象（[https://developers.google.com/maps/documentation/javascript/reference#Size](https://developers.google.com/maps/documentation/javascript/reference#Size)）。文档并没有详细说明接受哪些值。（我当然想要负值。）

首先，我有一个带有偏移值的数组：

```
var arr = [
  {x: -25, y: -25},
  {x: -25, y: 0},
  {x: -25, y: 25},
  {x: 0, y: -25},
  {x: 0, y: 0},
  {x: 0, y: 25},
  {x: 25, y: -25},
  {x: 25, y: 0},
  {x: 25, y: 25}
]; 
```

然后，一个位置：

```
var lat = 58.9030277;
var lng = 5.7114827999999990; 
```

最后，循环生成标记和偏移量：

```
for (i = 0; i < arr.length; i++) {
   marker = new google.maps.Marker({
    position: new google.maps.LatLng(lat, lng)
  });

  var myOptions = {
    content: '#' + (i + 1),
    disableAutoPan: true,
    pixelOffset: new google.maps.Size(arr[i].x, arr[i].y),
    position: new google.maps.LatLng(lat, lng)
  };

  ib = new InfoBox(myOptions);
} 
```

有人理解这种行为吗？有没有更好的方法来获得这个结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:51:48.183

您的偏移量的问题是您假设标签的默认位置错误，标签未以该位置为中心，它位于该点下方（信息框上边框的中间位于该位置）

要获得准确的结果，您必须知道标记和信息框的宽度/高度（假设两者都是正方形）。此外，标记的宽度/高度必须能被 2 整除，标签的宽度/高度必须能被 3 整除（这里的第一个问题，好像信息框的宽度/高度是 25）。

第一个标记（左上角）必须放置在：

```
{x:-(widthOrHeightOfInfoBox*1.5),
 y:-((widthOrHeightOfInfoBox*1.5)+(widthOrHeightOfMarker/2))} 
```

对于其他标记，将 widthOrHeightOfInfoBox 添加到 x 或 y（取决于行/列）

假设标记的宽度/高度为 10，信息框的宽度/高度为 24（请记住，它必须能被 3 整除），这应该会给出所需的结果：

```
var arr = [
  {x: -36, y: -41},
  {x: -36, y: -17},
  {x: -36, y:   7},
  {x: -12, y: -41},
  {x: -12, y: -17},
  {x: -12, y:   7},
  {x:  12, y: -41},
  {x:  12, y: -17},
  {x:  12, y:   7}
]; 
```

# c - 为什么调用退出函数会创建一个新的基本块

> ID：14714325
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:02.117
> 
> 标签：c, parsing, compiler-construction, clang

我有一个函数定义为：

```
int f_2() {
  rand();
  return 10;
} 
```

clang 将其分成 3 个基本块。这是可以理解的。

但是，当我用 exit(0) 替换对 rand() 的调用时，它会将其分成 4 个基本块。维基百科 ( [http://en.wikipedia.org/wiki/Basic_block](http://en.wikipedia.org/wiki/Basic_block) ) 说不能返回的函数可以在基本块的末尾。

clang 怎么知道 exit() 函数没有返回？我正在用 clang -c 编译我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:29:59.390

`clang`是一个 C 编译器；允许利用语言标准为标准库函数做出的保证。

`<stdlib.h>`在特定实现中也可能有一些东西`exit()`作为不返回的函数，可能使用语言扩展或`_Noreturn`2011 ISO C 标准添加的关键字。

另一个例子：调用`sin(0.0)`， with`-O1`或更高，编译为文字`0.0`，因为编译器知道`sin`函数。（这意味着调用的程序只有在你不优化的情况下才`sin(0.0)`需要链接。）`-lm`

这都是允许的，因为定义自己的（非`static`）函数与标准库函数同名的程序具有未定义的行为；编译器不需要考虑调用`exit`或`sin`执行除标准为这些函数指定的之外的任何操作的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:30:40.343

`clang`是一只非常聪明的野兽。你会惊讶于它可以计算出的东西的数量。

该`exit`函数是标准的，并且已知不会返回。编译器利用了这一事实。

# javascript - JavaScript 调整高度问题

> ID：14714327
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:07.173
> 
> 标签：javascript

我陷入了一个 JavaScript 问题，我不知道如何解决。

我在博客中有一个联系模式：[http](http://www.northernvirginiapaintingcontractor.com/blog) ://www.northernvirginiapaintingcontractor.com/blog 点击“发送页面”

当您单击它时，您将看到问题。联系模式不会一直打开。

将其与父应用程序上功能正常的相同“发送页面”按钮进行比较。[http://www.northernvirginiapaintingcontractor.com](http://www.northernvirginiapaintingcontractor.com)

这利用了 Eric Martin 的 Simple Modal 的修改版本。

修改了 Contact.js 以启用动态高度，以及与同一脚本一起使用的几种不同的联系模式。

其他 3 个 .js 文件包括：actual.js jquery-easing-1.3.pack.js jquery-easing-compatibility.1.2.pack.js

这是有问题的contact.js：我没有丝毫线索，如果其他人这样做会很棒。

```
jQuery(function ($) {
var contact = {
    message: null,
    init: function () {
        $('#contact-form input.contact, a.contact').click(function (e) {
            e.preventDefault();

            // Create the 1stModal dialog with the data

            $('#modal-contact-form').modal({
                closeHTML: "<a href='#' title='Close' class='modal-close'>Close Pager Modal</a>",
                //maxHeight: 62,
                //maxWidth: 62,
                //minHeight: 62,
                //minWidth: 62,
                position: [98, 377],
                //autoPosition: false,
                autoResize: true,
                //overlayId: 'contact-overlay',
                containerId: 'contact-container',
                containerCss: { 'width': '350px'},
                onOpen: contact.open,
                onShow: contact.show,
                onClose: contact.close
            });
        });

        $('#contact-form input.suportecontacto, a.suportecontacto').click(function (e) {
            e.preventDefault();

            // Create the 2nd Modal dialog with the data

            $('#modal-soporte-form').modal({
                closeHTML: "<a href='#' title='Close' class='modal-close'>Close Ticket Modal</a>",
                //maxHeight: 62,
                //maxWidth: 62,
                //minHeight: 62,
                //minWidth: 62,
                position: [98, 377],
                //autoPosition: false,
                autoResize: true,
                //overlayId: 'contact-overlay',
                containerId: 'contact-container',
                containerCss: { 'width': '350px' },
                onOpen: contact.open,
                onShow: contact.show,
                onClose: contact.close
            });
        });

        $('#contact-indivform input.indivcontacto, a.indivcontacto').click(function (e) {
            e.preventDefault();

            // Create the 3rd Modal dialog with the data

            $('#modal-indivcontact-form').modal({
                closeHTML: "<a href='#' title='Close' class='modal-close'>Close Contacto Modal</a>",
                //maxHeight: 62,
                //maxWidth: 62,
                //minHeight: 62,
                //minWidth: 62,
                position: [98, 377],
                //autoPosition: false,
                autoResize: true,
                //overlayId: 'contact-overlay',
                containerId: 'contact-container',
                containerCss: { 'width': '350px' },
                onOpen: contact.open,
                onShow: contact.show,
                onClose: contact.close
            });
        });

        $('#HeadLogin').click(function (e) {
            e.preventDefault();

            // Create the Login modal

            $('#login_form').modal({
                closeHTML: "<a href='#' title='Cerrar' class='modal-close' style='padding-right:15px'>Cerrar Login Modal</a>",
                //maxHeight: 62,
                //maxWidth: 62,
                //minHeight: 62,
                //minWidth: 62,
                position: [110, 364],
                //autoPosition: false,
                autoResize: true,
                //overlayId: 'contact-overlay',
                containerId: 'contact-container',
                containerCss: { 'width': '310px' },
                onOpen: contact.open,
                onShow: contact.login,
                onClose: contact.close
            });
        });
    },
    open: function (dialog) {
        $('#ajax_loading').hide();
        $('.simplemodal-wrap').css('overflow-x', 'visible').css('overflow-y', 'visible');
        // add padding to the buttons in firefox/mozilla
        if ($.browser.mozilla) {
            $('#contact-container .contact-button').css({
                'padding-bottom': '2px'
            });
        }
        // input field font size
        if ($.browser.safari) {
            $('#contact-container .contact-input').css({
                'font-size': '.9em'
            });
        }

        // Dynamically determine Modal Height

        //var h = 280;
        //var h = 220;
        //if ($('#contact-subject').length) {
        //    h += 26;
        //}
        //if ($('#contact-cc').length) {
        //    h += 22;
        //}

        var h = $('#contact-container form').actual('outerHeight') + 30;

        var title = $('#contact-container .contact-title').html();
        $('#contact-container .contact-title').html('Loading...');
        dialog.overlay.fadeIn(200, function () {
            dialog.container.fadeIn(200, function () {
                dialog.data.fadeIn(200, function () {
                    $('#contact-container .contact-content').animate({
                        height: h
                    }, function () {
                        $('#contact-container .contact-title').html(title);
                        $('#contact-container form').fadeIn(200, function () {
                            $('#contact-container #contact-name').focus();

                            $('#contact-container .contact-cc').click(function () {
                                var cc = $('#contact-container #contact-cc');
                                cc.is(':checked') ? cc.attr('checked', '') : cc.attr('checked', 'checked');
                            });

                            // fix png's for IE 6
                            if ($.browser.msie && $.browser.version < 7) {
                                $('#contact-container .contact-button').each(function () {
                                    if ($(this).css('backgroundImage').match(/^url[("']+(.*\.png)[)"']+$/i)) {
                                        var src = RegExp.$1;
                                        $(this).css({
                                            backgroundImage: 'none',
                                            filter: 'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="' + src + '", sizingMethod="crop")'
                                        });
                                    }
                                });
                            }
                        });
                    });
                });
            });
        });
    },
    login: function() {
    $('#contact-container .contact-send').click(function (e) {
            e.preventDefault();
        // Hide 'Submit' Button
     if (contact.validateLogin()) {
        $('.contact-send').hide();
        $('.contact-cancel').hide();

        // Show Gif Spinning Rotator
        $('#ajax_loading').show();

        // 'this' refers to the current submitted form  
        var url ='';
        var str = $('#frmlogin').serialize();
        var path = window.location.pathname;
        var sub = 'Account';

        if(path.toUpperCase().indexOf(sub.toUpperCase()) != -1) {
            url = 'Login.aspx';
            var image = $('#ajax_loading img');
            image.attr('src','../images/spinner.gif');
        }
        else {
            url = 'Account/Login.aspx';
        }

        // -- Start AJAX Call --
        var form = $('#status form');
        $.ajax({
            type: "POST",
            //url: form[0].action,
            url: url,
            data: str,
            success: function (msg) {

            $("#status").ajaxComplete(function (event, request, settings) {

                // Show 'Submit' Button
                $('.contact-send').show();
                $('.contact-cancel').show();
                // Hide Gif Spinning Rotator
                $('#ajax_loading').hide();

                if (msg != 'False') // LOGIN OK?
                {
                    var login_response = '<div style="color:green; margin: 1px; float: right; width: 300px;">Ya Estás Conectado!<br />Por favor, espera mientras estas redirigido...</div>';
                    $('.contact-title').hide();

                    $('a.modalCloseImg').hide();
                    $('#frmlogin').hide();

                    $('#simplemodal-container').css("width", "500px");
                    $('#simplemodal-container').css("height", "140px");

                    $('#login_form .contact-message').html(login_response).show();      // Refers to 'status'

                    // After 1 second redirect the Logged-in User 
                    setTimeout(contact.redirect, 500);
                }
                else // ERROR?
                {
                    $('#login_form .contact-content').css("height", "150px");

                    $('#login_form .contact-message').html("Login failed!").css('color','red').show();
                }

            });

        }

    });
    }
    // -- End AJAX Call --

    else {
                if ($('#login_form .contact-message:visible').length > 0) {
                    var msg = $('#login_form .contact-message div');
                    msg.fadeOut(200, function () {
                        msg.empty();
                        contact.showError();
                        msg.fadeIn(200);
                    });
                }
                else {
                    $('#login_form .contact-message').animate({
                        height: '30px'
                    }, contact.showError);
                }

            }
    });

    },
    redirect: function() {
        window.location = '/'; // Members Area
    },
    show: function (dialog) {
        $('#contact-container .contact-send').click(function (e) {
            e.preventDefault();

            var form = $('#contact-container form');

            // validate form
            if (contact.validate()) {
                var msg = $('#contact-container .contact-message');
                msg.fadeOut(function () {
                    msg.removeClass('contact-error').empty();
                });
                $('#contact-container .contact-title').html('Sending...');
                $('#contact-container form').fadeOut(200);

                $('#contact-container .contact-content').animate({
                    height: '80px'
                }, function () {

                    var uname = $('#contact-container #contact-name').val();
                    var email = $('#contact-container #contact-email').val();
                    var cntx = $('#contact-container #contact-message').val();

                    var docc = "false";
                    if ($('#contact-container #contact-cc').is(':checked')) {
                        docc = "true";
                    }

                    $.ajax({
                      url: "blog/api/Blogs.asmx/SendMail",
                      data: "{'uname':'" + uname + "', 'email':'" + email + "','cntx':'" + cntx + "','docc':'" + docc + "'}",
                      type: "POST",
                      contentType: "application/json",
                      success: function (msg) {
                         //contact.close(dialog);
                         $('#contact-container .contact-loading').fadeOut(200, function () {
                            $('#contact-container .contact-title').html('Thank you!');
                            msg.html(data).fadeIn(200);
                            setTimeout(function () {
                                contact.close(dialog);
                            }, 1500);
                        });
                      }
                   });

                    contact.close(dialog);
                });
            }
            else {
                if ($('#contact-container .contact-message:visible').length > 0) {
                    var msg = $('#contact-container .contact-message div');
                    msg.fadeOut(200, function () {
                        msg.empty();
                        contact.showError();
                        msg.fadeIn(200);
                    });
                }
                else {
                    $('#contact-container .contact-message').animate({
                        height: '30px'
                    }, contact.showError);
                }
            }
        });
    },

    close: function (dialog) {

        $('#contact-container .contact-message').fadeOut();
        $('#contact-container .contact-title').html('Closing...');
        $('#contact-container form').fadeOut(200);

        $('#contact-container .contact-content').animate({
            height: 40
        }, function () {
            dialog.data.fadeOut(200, function () {
                dialog.container.fadeOut(200, function () {
                    dialog.overlay.fadeOut(200, function () {
                        $.modal.close();
                    });
                });
            });
        });
    },
    error: function (xhr) {
        alert(xhr.statusText);
    },
    validateLogin: function () {
        contact.message = '';

        if (!$('#username').val()) {

             contact.message += 'User name is required. ';
        }

        var pass = $('#password').val();
        if (!pass) {

            contact.message += 'Password is required. ';
        }
        if (contact.message.length > 0) {
            return false;
        }
        else {
            return true;
        }

    },
    validate: function () {
        contact.message = '';
        if (!$('#contact-container input[name="name"]').val()) {
            contact.message += 'Name is required. ';
        }

        var email = $('#contact-container input[name="email"]').val();
        if (!email) {
            contact.message += 'Email is required. ';
        }
        else {
            if (!contact.validateEmail(email)) {
                contact.message += 'Email is invalid. ';
            }
        }

        if (!$('#contact-container textarea[name="message"]').val()) {
            contact.message += 'Message is required.';
        }

        if (contact.message.length > 0) {
            return false;
        }
        else {
            return true;
        }
    },
    validateEmail: function (email) {
        var at = email.lastIndexOf("@");

        // Make sure the at (@) sybmol exists and  
        // it is not the first or last character
        if (at < 1 || (at + 1) === email.length)
            return false;

        // Make sure there aren't multiple periods together
        if (/(\.{2,})/.test(email))
            return false;

        // Break up the local and domain portions
        var local = email.substring(0, at);
        var domain = email.substring(at + 1);

        // Check lengths
        if (local.length < 1 || local.length > 64 || domain.length < 4 || domain.length > 255)
            return false;

        // Make sure local and domain don't start with or end with a period
        if (/(^\.|\.$)/.test(local) || /(^\.|\.$)/.test(domain))
            return false;

        // Check for quoted-string addresses
        // Since almost anything is allowed in a quoted-string address,
        // we're just going to let them go through
        if (!/^"(.+)"$/.test(local)) {
            // It's a dot-string address...check for valid characters
            if (!/^[-a-zA-Z0-9!#$%*\/?|^{}`~&'+=_\.]*$/.test(local))
                return false;
        }

        // Make sure domain contains only valid characters and at least one period
        if (!/^[-a-zA-Z0-9\.]*$/.test(domain) || domain.indexOf(".") === -1)
            return false;

        return true;
    },
    showError: function () {
        $('#contact-container .contact-message')
            .html($('<div class="contact-error"></div>').append(contact.message))
            .fadeIn(200);
    }
};

contact.init();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:35:41.703

这：

```
$('.contact-send').hide();
$('.contact-cancel').hide(); 
```

添加的显示：无；到这些元素，当您调用“打开”时它们不会被删除

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:15:56.760

simpleModal 插件以编程方式为 .simplemodal-wrap 类分配 100% 的高度，但 jquery.actual 插件因此在页面调整大小期间无法找到模态表单的正确高度。作为一种解决方法，我将最小高度重新设置为无论如何都显示完整形式的值。

.simplemodal-wrap { 最小高度：350px; 高度：自动！重要；/* IE6 及以下需要*/ height: 350px; /* IE6 及以下需要 */ }

网站.cshtml：

第 129 行的元素：具有内联样式 == "display: none;"。这没有被更改为 display: block; 当联系人模式打开时。我选择删除内联样式，因为其中一个祖先元素已经具有 display: none; 指定以及何时打开正确更改的模式。

# java - Jackson：如何在不修改 POJO 的情况下向 JSON 添加自定义属性

> ID：14714328
> 
> 赞同：78
> 
> 时间：2013-02-05T18:28:10.217
> 
> 标签：java, json, serialization, jackson, customization

我正在为我的应用程序开发一个 REST 接口，使用 Jackson 将我的 POJO 域对象序列化为 JSON 表示。我想为某些类型自定义序列化，以向 POJO 中不存在的 JSON 表示添加额外的属性（例如添加一些元数据、参考数据等）。我知道如何编写我自己的，但在这种情况下，我需要为我的对象的**每个**`JsonSerializer`属性显式调用`JsonGenerator.writeXXX(..)`方法，而我只需要**添加**一个附加属性。换句话说，我希望能够写出类似的东西：

 ****```
@Override
public void serialize(TaxonomyNode value, JsonGenerator jgen, SerializerProvider provider) {
    jgen.writeStartObject();
    jgen.writeAllFields(value); // <-- The method I'd like to have
    jgen.writeObjectField("my_extra_field", "some data");
    jgen.writeEndObject();
} 
```

或者（甚至更好）以某种方式在`jgen.writeEndObject()`调用之前拦截序列化，例如：

```
@Override void beforeEndObject(....) {
    jgen.writeObjectField("my_extra_field", "some data");
} 
```

我以为我可以扩展`BeanSerializer`和覆盖它的`serialize(..)`方法，但是它被声明了`final`，而且我找不到一种简单的方法来创建一个新实例，`BeanSerializer`而不提供所有类型元数据细节，实际上复制了 Jackson 的很大一部分。所以我已经放弃这样做了。

**我的问题是**- 如何自定义 Jackson 的序列化以向特定 POJO 的 JSON 输出添加额外的内容，而不引入过多的样板代码并尽可能多地重用默认的 Jackson 行为。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2017-02-25T11:22:12.457

Jackson 2.5 引入了[`@JsonAppend`](http://fasterxml.github.io/jackson-databind/javadoc/2.8/com/fasterxml/jackson/databind/annotation/JsonAppend.html)注解，可用于在序列化过程中添加“虚拟”属性。它可以与 mixin 功能一起使用，以避免修改原始 POJO。

以下示例`ApprovalState`在序列化期间添加了一个属性：

```
@JsonAppend(
    attrs = {
        @JsonAppend.Attr(value = "ApprovalState")
    }
)
public static class ApprovalMixin {} 
```

使用以下命令注册 mixin `ObjectMapper`：

```
mapper.addMixIn(POJO.class, ApprovalMixin.class); 
```

在序列化过程中使用 an`ObjectWriter`设置属性：

```
ObjectWriter writer = mapper.writerFor(POJO.class)
                          .withAttribute("ApprovalState", "Pending"); 
```

使用编写器进行序列化会将`ApprovalState`字段添加到输出中。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-03-12T15:55:38.187

从（我认为）杰克逊 1.7 开始，您可以使用 a`BeanSerializerModifier`和扩展来做到这一点`BeanSerializerBase`。我已经用 Jackson 2.0.4 测试了下面的例子。

```
import java.io.IOException;

import org.junit.Test;

import com.fasterxml.jackson.core.JsonGenerationException;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.BeanDescription;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationConfig;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.BeanSerializerModifier;
import com.fasterxml.jackson.databind.ser.impl.ObjectIdWriter;
import com.fasterxml.jackson.databind.ser.std.BeanSerializerBase;

public class JacksonSerializeWithExtraField {

    @Test
    public void testAddExtraField() throws Exception
    {
        ObjectMapper mapper = new ObjectMapper();

        mapper.registerModule(new SimpleModule() {

            public void setupModule(SetupContext context) {
                super.setupModule(context);

                context.addBeanSerializerModifier(new BeanSerializerModifier() {

                    public JsonSerializer<?> modifySerializer(
                            SerializationConfig config,
                            BeanDescription beanDesc,
                            JsonSerializer<?> serializer) {
                        if (serializer instanceof BeanSerializerBase) { 
                              return new ExtraFieldSerializer(
                                   (BeanSerializerBase) serializer);
                        } 
                        return serializer; 

                    }                   
                });
            }           
        });

        mapper.writeValue(System.out, new MyClass());       
        //prints {"classField":"classFieldValue","extraField":"extraFieldValue"}
    }

    class MyClass {

        private String classField = "classFieldValue";

        public String getClassField() { 
            return classField; 
        }
        public void setClassField(String classField) { 
            this.classField = classField; 
        }
    }

    class ExtraFieldSerializer extends BeanSerializerBase {

        ExtraFieldSerializer(BeanSerializerBase source) {
            super(source);
        }

        ExtraFieldSerializer(ExtraFieldSerializer source, 
                ObjectIdWriter objectIdWriter) {
            super(source, objectIdWriter);
        }

        ExtraFieldSerializer(ExtraFieldSerializer source, 
                String[] toIgnore) {
            super(source, toIgnore);
        }

        protected BeanSerializerBase withObjectIdWriter(
                ObjectIdWriter objectIdWriter) {
            return new ExtraFieldSerializer(this, objectIdWriter);
        }

        protected BeanSerializerBase withIgnorals(String[] toIgnore) {
            return new ExtraFieldSerializer(this, toIgnore);
        }

        public void serialize(Object bean, JsonGenerator jgen,
                SerializerProvider provider) throws IOException,
                JsonGenerationException {           
            jgen.writeStartObject();                        
            serializeFields(bean, jgen, provider);
            jgen.writeStringField("extraField", "extraFieldValue"); 
            jgen.writeEndObject();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-08-18T09:58:49.460

您可以这样做（以前的版本在 2.6 之后无法与 Jackson 一起使用，但在 Jackson 2.7.3 中可以使用）：

```
public static class CustomModule extends SimpleModule {
    public CustomModule() {
        addSerializer(CustomClass.class, new CustomClassSerializer());
    }

    private static class CustomClassSerializer extends JsonSerializer {
        @Override
        public void serialize(Object value, JsonGenerator jgen, SerializerProvider provider) throws IOException {
            //Validate.isInstanceOf(CustomClass.class, value);
            jgen.writeStartObject();
            JavaType javaType = provider.constructType(CustomClass.class);
            BeanDescription beanDesc = provider.getConfig().introspect(javaType);
            JsonSerializer<Object> serializer = BeanSerializerFactory.instance.findBeanSerializer(provider,
                    javaType,
                    beanDesc);
            // this is basically your 'writeAllFields()'-method:
            serializer.unwrappingSerializer(null).serialize(value, jgen, provider);
            jgen.writeObjectField("my_extra_field", "some data");
            jgen.writeEndObject();
        }
    }
} 
```

### 更新：

我在 Jackson 2.9.0 和 2.9.6 上进行了尝试，两者都按预期工作。也许试试这个： http: [//jdoodle.com/a/z99](http://jdoodle.com/a/z99)（在本地运行 - jdoodle 显然无法处理杰克逊）。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-03-31T12:40:45.063

虽然这个问题已经得到解答，但我找到了另一种不需要特殊杰克逊钩子的方法。

```
static class JsonWrapper<T> {
    @JsonUnwrapped
    private T inner;
    private String extraField;

    public JsonWrapper(T inner, String field) {
        this.inner = inner;
        this.extraField = field;
    }

    public T getInner() {
        return inner;
    }

    public String getExtraField() {
        return extraField;
    }
}

static class BaseClass {
    private String baseField;

    public BaseClass(String baseField) {
        this.baseField = baseField;
    }

    public String getBaseField() {
        return baseField;
    }
}

public static void main(String[] args) throws JsonProcessingException {
    Object input = new JsonWrapper<>(new BaseClass("inner"), "outer");
    System.out.println(new ObjectMapper().writerWithDefaultPrettyPrinter().writeValueAsString(input));
} 
```

输出：

```
{
  "baseField" : "inner",
  "extraField" : "outer"
} 
```

对于编写集合，您可以简单地使用视图：

```
public static void main(String[] args) throws JsonProcessingException {
    List<BaseClass> inputs = Arrays.asList(new BaseClass("1"), new BaseClass("2"));
    //Google Guava Library <3
    List<JsonWrapper<BaseClass>> modInputs = Lists.transform(inputs, base -> new JsonWrapper<>(base, "hello"));
    System.out.println(new ObjectMapper().writerWithDefaultPrettyPrinter().writeValueAsString(modInputs));
} 
```

输出：

```
[ {
  "baseField" : "1",
  "extraField" : "hello"
}, {
  "baseField" : "2",
  "extraField" : "hello"
} ] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-02-20T12:44:18.480

另一个也许是最简单的解决方案：

使序列化成为一个两步过程。首先创建一个`Map<String,Object>`like：

```
Map<String,Object> map = req.mapper().convertValue( result, new TypeReference<Map<String,Object>>() {} ); 
```

然后添加您想要的属性：

```
map.put( "custom", "value" ); 
```

然后将其序列化为 json：

```
String json = req.mapper().writeValueAsString( map ); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-16T05:30:30.060

对于我的用例，我可以使用更简单的方法。在我所有的“Jackson Pojos”的基类中，我添加：

```
protected Map<String,Object> dynamicProperties = new HashMap<String,Object>();

...

public Object get(String name) {
    return dynamicProperties.get(name);
}

// "any getter" needed for serialization    
@JsonAnyGetter
public Map<String,Object> any() {
    return dynamicProperties;
}

@JsonAnySetter
public void set(String name, Object value) {
    dynamicProperties.put(name, value);
} 
```

我现在可以反序列化到 Pojo，处理字段并重新序列化 witjout 丢失任何属性。我还可以添加/更改非 pojo 属性：

```
// Pojo fields
person.setFirstName("Annna");

// Dynamic field
person.set("ex", "test"); 
```

（从[Cowtowncoder 获得](http://www.cowtowncoder.com/blog/archives/2011/07/entry_458.html)）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-10-16T11:38:10.580

我们可以使用反射来获取要解析的对象的所有字段。

```
@JsonSerialize(using=CustomSerializer.class)
class Test{
  int id;
  String name;
  String hash;
} 
```

在自定义序列化程序中，我们有这样的序列化方法：

```
 @Override
        public void serialize(Test value, JsonGenerator jgen,
                SerializerProvider provider) throws IOException,
                JsonProcessingException {

            jgen.writeStartObject();
            Field[] fields = value.getClass().getDeclaredFields();

            for (Field field : fields) {
                try {
                    jgen.writeObjectField(field.getName(), field.get(value));
                } catch (IllegalArgumentException | IllegalAccessException e) {
                    e.printStackTrace();
                }

            }
            jgen.writeObjectField("extra_field", "whatever_value");
            jgen.writeEndObject();

        } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-20T23:05:34.930

灵感来自 wajda 在此[要点](https://gist.github.com/charlouze/6f093a313ca7d76f39d2)中所说和所写的内容：

这是在杰克逊 1.9.12 中添加 bean 序列化侦听器的方法。在此示例中，侦听器被视为命令链，其接口为：

```
public interface BeanSerializerListener {
    void postSerialization(Object value, JsonGenerator jgen) throws IOException;
} 
```

MyBeanSerializer.java：

```
public class MyBeanSerializer extends BeanSerializerBase {
    private final BeanSerializerListener serializerListener;

    protected MyBeanSerializer(final BeanSerializerBase src, final BeanSerializerListener serializerListener) {
        super(src);
        this.serializerListener = serializerListener;
    }

    @Override
    public void serialize(final Object bean, final JsonGenerator jgen, final SerializerProvider provider) throws IOException, JsonGenerationException {
        jgen.writeStartObject();
        if (_propertyFilterId != null) {
            serializeFieldsFiltered(bean, jgen, provider);
        } else {
            serializeFields(bean, jgen, provider);
        }

        serializerListener.postSerialization(bean, jgen);

        jgen.writeEndObject();
    }
} 
```

MyBeanSerializerBuilder.java：

```
public class MyBeanSerializerBuilder extends BeanSerializerBuilder {
    private final BeanSerializerListener serializerListener;

    public MyBeanSerializerBuilder(final BasicBeanDescription beanDesc, final BeanSerializerListener serializerListener) {
        super(beanDesc);
        this.serializerListener = serializerListener;
    }

    @Override
    public JsonSerializer<?> build() {
        BeanSerializerBase src = (BeanSerializerBase) super.build();
        return new MyBeanSerializer(src, serializerListener);
    }
} 
```

MyBeanSerializerFactory.java：

```
public class MyBeanSerializerFactory extends BeanSerializerFactory {

    private final BeanSerializerListener serializerListener;

    public MyBeanSerializerFactory(final BeanSerializerListener serializerListener) {
        super(null);
        this.serializerListener = serializerListener;
    }

    @Override
    protected BeanSerializerBuilder constructBeanSerializerBuilder(final BasicBeanDescription beanDesc) {
        return new MyBeanSerializerBuilder(beanDesc, serializerListener);
    }
} 
```

下面的最后一个类显示了如何使用 Resteasy 3.0.7 提供它：

```
@Provider
public class ObjectMapperProvider implements ContextResolver<ObjectMapper> {
    private final MapperConfigurator mapperCfg;

    public ObjectMapperProvider() {
        mapperCfg = new MapperConfigurator(null, null);
        mapperCfg.setAnnotationsToUse(new Annotations[]{Annotations.JACKSON, Annotations.JAXB});
        mapperCfg.getConfiguredMapper().setSerializerFactory(serializerFactory);
    }

    @Override
    public ObjectMapper getContext(final Class<?> type) {
        return mapperCfg.getConfiguredMapper();
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-06T02:11:00.323

我们可以扩展`BeanSerializer`，但需要一点小技巧。

首先，定义一个 java 类来包装你的 POJO。

```
@JsonSerialize(using = MixinResultSerializer.class)
public class MixinResult {

    private final Object origin;
    private final Map<String, String> mixed = Maps.newHashMap();

    @JsonCreator
    public MixinResult(@JsonProperty("origin") Object origin) {
        this.origin = origin;
    }

    public void add(String key, String value) {
        this.mixed.put(key, value);
    }

    public Map<String, String> getMixed() {
        return mixed;
    }

    public Object getOrigin() {
        return origin;
    }

} 
```

然后，实现你的自定义`serializer`。

```
public final class MixinResultSerializer extends BeanSerializer {

    public MixinResultSerializer() {
        super(SimpleType.construct(MixinResult.class), null, new BeanPropertyWriter[0], new BeanPropertyWriter[0]);
    }

    public MixinResultSerializer(BeanSerializerBase base) {
        super(base);
    }

    @Override
    protected void serializeFields(Object bean, JsonGenerator gen, SerializerProvider provider) throws IOException {
        if (bean instanceof MixinResult) {
            MixinResult mixin  = (MixinResult) bean;
            Object      origin = mixin.getOrigin();

            BeanSerializer serializer = (BeanSerializer) provider.findValueSerializer(SimpleType.construct(origin.getClass()));

            new MixinResultSerializer(serializer).serializeFields(origin, gen, provider);

            mixin.getMixed().entrySet()
                    .stream()
                    .filter(entry -> entry.getValue() != null)
                    .forEach((entry -> {
                        try {
                            gen.writeFieldName(entry.getKey());
                            gen.writeRawValue(entry.getValue());
                        } catch (IOException e) {
                            throw new RuntimeException(e);
                        }
                    }));
        } else {
            super.serializeFields(bean, gen, provider);
        }

    }

} 
```

这样，我们可以处理源对象使用杰克逊注解来自定义序列化行为的情况。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-16T21:28:36.753

我也需要这种能力；就我而言，支持 REST 服务的字段扩展。[我最终开发了一个小框架来解决这个问题，它在github](https://github.com/Russell-Allen/jackson-morphed-result)上开源。它也可以在[Maven 中央存储库](http://mvnrepository.com/artifact/com.allenru/jackson-morphed-result/1.0.0)中找到。

它负责所有工作。只需将 POJO 包装在一个 MorphedResult 中，然后随意添加或删除属性。序列化后，MorphedResult 包装器会消失，并且任何“更改”都会出现在序列化的 JSON 对象中。

```
MorphedResult<?> result = new MorphedResult<>(pojo);
result.addExpansionData("my_extra_field", "some data"); 
```

有关更多详细信息和示例，请参阅 github 页面。请务必使用 Jackson 的对象映射器注册库“过滤器”，如下所示：

```
ObjectMapper mapper = new ObjectMapper();
mapper.setFilters(new FilteredResultProvider()); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-02-07T13:28:50.560

在查看了更多关于*Jackson*源代码后，我得出结论，如果不编写我自己的 ，根本不可能实现`BeanSerializer`，`BeanSerializerBuilder`并`BeanSerializerFactory`提供一些扩展点，例如：

```
/*
/**********************************************************
/* Extension points
/**********************************************************
 */

protected void beforeEndObject(T bean, JsonGenerator jgen, SerializerProvider provider) throws IOException, JSONException {
    // May be overridden
}

protected void afterStartObject(T bean, JsonGenerator jgen, SerializerProvider provider) throws IOException, JSONException {
    // May be overridden
} 
```

不幸的是，我不得不将整个*Jackson*的`BeanSerializer`源代码复制并粘贴到，`MyCustomBeanSerializer`因为前者不是为将所有字段和一些重要方法（如`serialize(...)`）声明为的扩展而开发的`final`****

# javascript - 如何使用 Javascript 读取 Rails tmp 中的文件？

> ID：14714335
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:27.010
> 
> 标签：javascript, ruby-on-rails, tmp

我现在的方式是使用 JavaScript 读取文件，提供硬编码路径。我告诉它看`/public`。我打算`tmp`用 Rails 在目录中生成一个文件，我想用 JavaScript 读取它。我怎样才能做到这一点？Rails 的 tmp 目录是什么？

我已经尝试将文件放入`/tmp`并硬编码 JavaScript 以从中读取`/tmp`，但它不会加载文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:40:06.877

我可能错了，但我认为浏览器只能访问公用文件夹中的文件，除非它通过 Rails 路由。因此，您可以更改 tmp 文件夹的位置，也可以在控制器中创建一个方法，该方法将读取该 JS 文件并将其发送回浏览器（有点像代理）。

# c# - 在 C# 中读取 JSON - 将一些节点值连接成字符串和其他逗号分隔

> ID：14714338
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:33.703
> 
> 标签：c#, json

我在 JSON 中有以下示例记录并使用 C#，我需要将其转换为逗号分隔的字符串。如果节点是“primitiveValue”，它将用逗号分隔，但如果节点是“conversionPathValue”，我需要将后代“nodeValue”值连接在一起。

```
 [
   {
    "primitiveValue": "20130122"
   },
   {
    "conversionPathValue": [
     {
      "interactionType": "CLICK",
      "nodeValue": "MET"
     },
     {
      "interactionType": "CLICK",
      "nodeValue": "MET"
     },
     {
      "interactionType": "CLICK",
      "nodeValue": "MET"
     },
     {
      "interactionType": "CLICK",
      "nodeValue": "MET"
     },
     {
      "nodeValue": "(none)"
     }
    ]
   },
   {
    "primitiveValue": "1"
   },
   {
    "primitiveValue": "3857.0"
   }
  ] 
```

对于上面的 JSON 提取，我需要将其转换为一行字符串，如下所示：

'20130122','MET-MET-MET-MET-(无)','1','3857.0'

JSON 输出有很多记录，所以我需要遍历每条记录来执行此操作。

将conversionpathvalue 元素分别连接到primitiveValue 元素并每行连接在一起的最佳方法是什么？此外，同一行中可能有一组以上的 conversionpathValue 元素，因此需要将它们分开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:52:35.770

您可以使用[Servicestack](https://github.com/ServiceStack/ServiceStack.Text)的`JsonSerializer`. `ServiceStack.Text`是一个独立的、无依赖的序列化库，包含 ServiceStack 的所有文本处理功能，包括：

```
 1\.  JsonSerializer
    2\.  TypeSerializer (JSV-Format)
    3\.  CsvSerializer
    4\.  T.Dump extension method
    5\.  StringExtensions - Xml/Json/Csv/Url encoding, BaseConvert, etc.
    6\.  Stream, Reflection, List, DateTime, etc extensions and utils 
```

**使用结构自定义 JSON**

这使得自定义序列化例程并提供更紧凑的线路格式成为可能。

例如，而不是使用 JSON 对象来表示一个点

```
{ Width=20, Height=10 } 
```

您可以使用 a`struct`并将其简化为：

```
"20x10" 
```

通过覆盖`ToString()`并提供一个`static Size ParseJson()`方法：

```
public struct Size
{
    public double Width { get; set; }
    public double Height { get; set; }

    public override string ToString()
    {
        return Width + "x" + Height;
    }

    public static Size ParseJson(string json)
    {
        var size = json.Split('x');
        return new Size { 
            Width = double.Parse(size[0]), 
            Height = double.Parse(size[1]) 
        };
    }
} 
```

这会将其更改为更紧凑的 JSON 输出：

```
new Size { Width = 20, Height = 10 }.ToJson() // = "20x10" 
```

这允许您以相同的方式反序列化它：

```
var size = "20x10".FromJson<Size>(); 
```

**使用自定义 IEnumerable 类序列化 JSON 数组**

除了使用 a 之外，`Struct`您还可以选择使用自定义`C# IEnumerable`类型来提供围绕 JSON 数组的强类型包装器：

```
public class Point : IEnumerable
{
    double[] points = new double[2];

    public double X 
    {
        get { return points[0]; }
        set { points[0] = value; }
    }

  public double Y
    {
        get { return points[1]; }
        set { points[1] = value; }
    }

    public IEnumerator GetEnumerator()
    {
        foreach (var point in points) 
            yield return point;
    }
}

Which serializes the Point into a compact JSON array:

new Point { X = 1, Y = 2 }.ToJson() // = [1,2] 
```

希望您可以将此作为参考来完成您的任务。最需要注意的一点是，它`Servicestack's JsonSerializer`是地球上最快的`protocol-buffers.`

# sql - 'Master-Detail' 类型查询，默认 'Detail' 值

> ID：14714340
> 
> 赞同：2
> 
> 时间：2013-02-05T18:28:46.307
> 
> 标签：sql, sql-server, tsql

我正在尝试使用主从类型结构查询预先存在的数据模型，如下所示：

```
Master
-----
MasterId (PK)
Description

Detail
-----
DetailId (PK)
MasterId (FK)
DetailCategoryId (FK)    
Description 
```

还有一系列 MasterId 为 -1 的详细信息记录，表示每个详细信息类别的默认值。因此，如果对于指定的类别，Master 没有详细信息，则应检索默认值。

我已经设法以几种不同的方式为给定的主记录做到这一点，但到目前为止我提出的解决方案通常需要我，找出“指定”的细节，然后与一组缺失的默认值结合.

我的问题是如何为所有/多个主记录执行此操作？

（这是我为报告目的而查询的现有数据模型。我可能能够进行微小的修改，但没有机会进行全面重新设计，因此问题实际上是“我该如何处理？”而不是“如何做我重新建模这个？'）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:38:00.837

我认为这会奏效。您只需将 15 替换为任何类别即可。

```
SELECT
    m.MasterId,ISNULL(d.DetailId,dflt.DetailId)
FROM Master m
LEFT JOIN Detail d ON d.masterid=m.masterid and d.DetailCategoryId=15
LEFT JOIN Detail dflt on dflt.masterid=-1 and d.DetailCategoryId=15 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:20:07.057

**第一个解决方案：**

```
DECLARE @MasterID INT;
SET @MasterID=123;

SELECT  d.DetailID, d.DetailCategoryID, d.Description
FROM    Detail d
WHERE   d.MasterID=@MasterID;

IF @@ROWCOUNT=0 -- If no rows then fetch default rows
BEGIN
    SELECT  d.DetailID, d.DetailCategoryID, d.Description
    FROM    Detail d
    WHERE   d.MasterID=-1;
END; 
```

[@@ROWCOUNT](http://technet.microsoft.com/en-us/library/ms187316.aspx)

**第二种解决方案：**

```
SELECT *
FROM (
    SELECT *, DENSE_RANK() OVER(ORDER BY x.MasterID DESC) AS Rnk
    FROM (
        SELECT  d.MasterID, d.DetailID, d.DetailCategoryID, d.Description
        FROM    Detail d
        WHERE   d.MasterID=@MasterID
        UNION ALL
        SELECT  d.MasterID, d.DetailID, d.DetailCategoryID, d.Description
        FROM    Detail d
        WHERE   d.MasterID=-1
    ) x
) y
WHERE y.MasterID=-1 AND y.Rnk=1
OR y.MasterID>0; 
```

注意：最后一个解决方案假定所有`MasterID`非默认值都大于 0 ( `MasterID>0`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:31:10.600

尝试这个：

```
WITH CTE AS (
    SELECT M.MasterId, M.Description, D.DetailId
    FROM Master M
      LEFT JOIN Detail D ON M.MasterId = D.MasterId AND D.DetailCategoryId = @CatId
  )
SELECT  MasterId, Description, DetailId
FROM CTE
WHERE DetailId IS NOT NULL
UNION 
SELECT CTE.MasterId, CTE.Description, D.DetailId
FROM CTE 
  JOIN Detail D ON D.MasterId = -1 AND D.DetailCategoryId = @CatId
WHERE CTE.DetailId IS NULL 
```

这是用于测试的[SQL Fiddle 。](http://sqlfiddle.com/#!3/90672/9)

祝你好运。

# sql-server-2008 - 至少 30 天前的所有记录的 SQL 查询

> ID：14714341
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:52.457
> 
> 标签：sql-server-2008, datediff, teamsite, interwoven

我正在尝试跟踪用户登录应用程序时的用户数据。我试图从我的查询（如下）中提取的是过去 30 天或更长时间未登录的所有用户。但是，它正在吸引最近登录的用户。帮助？

```
SELECT UserNM AS [UserID], MAX(EventDT) AS [Last Log-in Date]
FROM dbo.USREventLog
WHERE ABS(DATEDIFF([day], EventDT, GETDATE())) > 30

    AND (UserNM NOT LIKE 'user1') AND (UserNM NOT LIKE 'user2')
    AND (UserNM NOT LIKE 'user3') AND (UserNM NOT LIKE 'user4')

GROUP BY UserNM 
```

顺便说一句，我使用他们最近的活动记录作为他们的最后一次登录日期，并且我有一小部分绝对不应该包含在结果中的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:34:34.007

试试这个：

```
SELECT UserNM AS [UserID], MAX(EventDT) AS [Last Log-in Date]
FROM dbo.USREventLog
WHERE EventDT < GETDATE() - 30

    AND (UserNM NOT LIKE 'user1') AND (UserNM NOT LIKE 'user2')
    AND (UserNM NOT LIKE 'user3') AND (UserNM NOT LIKE 'user4')

GROUP BY UserNM, EventDT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T22:47:33.793

我在其他地方找到了另一种解决方案。查询粘贴在下面。

```
SELECT UserID, [Last Login Date] from (
    SELECT UserNM AS [UserID], MAX(EventDT) AS [Last Login Date]
    FROM dbo.TSEventLog 
    WHERE (UserNM NOT LIKE 'user 1') AND (UserNM NOT LIKE 'user2')
    GROUP BY UserNM) x
WHERE ABS(DATEDIFF(day, [Last Login Date], GETDATE())) > 30
ORDER BY [UserID] ASC 
```

# github - 如何在 HTML 文件中嵌入文件要点？

> ID：14714342
> 
> 赞同：8
> 
> 时间：2013-02-05T18:28:52.910
> 
> 标签：github, gist

我曾经使用如下代码在 HTML 中嵌入一个 gist 文件：

```
<script src="https://gist.github.com/4577639.js?file=hello_world_addr.wsdl"></script> 
```

这不再有效，因为显示的是所有文件而不是单个文件。任何人都知道为什么会发生这种情况以及如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-05T18:36:03.867

在这里你很好先生

```
<script
  src="https://gist.github.com/claudemamo/4577639.js?file=hello_world_addr.wsdl">
</script> 
```

# javascript - 提交表单后关闭弹出窗口

> ID：14714344
> 
> 赞同：0
> 
> 时间：2013-02-05T18:28:56.733
> 
> 标签：javascript, html, popup, submit

这似乎是一个有多个回复的常见问题，但我无法让他们中的任何一个工作。

我正在研究WP。目前，我正在使用一个插件，该插件会在未登录的用户登陆该网站时立即显示一个弹出窗口。在弹出窗口中，我使用了一个 optin 表单（通过 MailChimp 创建）。当用户提交他的信息时，会打开一个新选项卡，将他移动到电子邮件验证页面。

问题是弹出窗口在第一个选项卡中保持打开状态。

我希望它在提交数据后立即关闭。那可能吗？

这是该网站的[链接。](http://deals.karditsa.topgreekgyms.gr)

这是我的表单代码：

```
<div id="mc_embed_signup">  
<form action="http://fitnessforum.us6.list-manage.com/subscribe/post?u=d6acf8949532b107b7b21c9d0&amp;id=1304ea7322" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">

<div class="mc-field-group">
<input id="firstname3" style="width:260px;margin:5px 0;background-position:95% center" type="text" value="" name="FNAME" placeholder="'Ονομα">
</div>

<div class="mc-field-group">
<input id="primaryemail3" style="width:260px;margin:5px 0;background-position:97% center" type="email" value="" name="EMAIL" placeholder="Email">
</div>

<div id="mce-responses" class="clear">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> 

<div class="clearfix">                  
<input name="subscribe" style="width:305px;margin:4px 5px 0 0" class="simplemodal-close button_link hover_fade large_button silver button_widget" type="submit" value="ΣΤΕΙΛΤΕ ΤΟ ΔΩΡΟ ΜΟΥ!"></div>
</form>
</div>

<div style="text-align: center">
<p class="under_button2"> Το email σου είναι ασφαλές στα χέρια μας.</p>

<div class="af-clear">
</div>

</div>
</div>                  
<!--End mc_embed_signup--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:44:34.360

只要确保你的“谢谢”页面有*上面*提到的代码。它是一个实际的弹出窗口还是像 shadowbox 一样的 javascript？你可能需要这样的东西：

父.Shadowbox.close();"

# c - 使用函数计算C中2个双数的调和平均值

> ID：14714352
> 
> 赞同：1
> 
> 时间：2013-02-05T18:29:11.240
> 
> 标签：c

我试图创建一个计算 2 个输入数字的函数。

例如，当我输入`1.0`并`5.0`输入`0.00`输出时..

您可能会发现问题对您来说非常明显，但请理解我是一个完全的新手，而我现在才得到指针。

这是我的代码：

```
#include <stdio.h>
#define MAXNUMS 50
double harmonic_mean(double number1, double number2);

int main(void)

{
    double num1, num2;
    printf("please enter two numbers to get the harmonic mean:\n");
    while ((scanf("%lf%lf", &num1, &num2)) == 2)
    {
        printf("%.2lf", harmonic_mean(num1, num2));
    }
    return 0;
}

double harmonic_mean(double number1, double number2)

{
    double harmonic, totalHarmonic;
    int total;
    int x, y;
    double numbers[MAXNUMS];
    for (x = 1, y = 0; x <= number2; x++, y++)

    {
        total = x;
        numbers[y] = number1++;
    }

    for (x = 0; x <= total; x++)
    {
        harmonic += (1/numbers[x]);
    }

    totalHarmonic = total/harmonic;

    return totalHarmonic;
} 
```

tnx

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:42:22.010

不确定当你说调和平均值时你到底在想什么，但两个数字的调和平均值是它们倒数的算术平均值的倒数。

您不需要为它编写 for 循环和其他复杂的代码。下面的代码应该可以。

```
double harmonic_mean(double number1, double number2) {
    double r1 = 1 / number1;    // reciprocals
    double r2 = 1 / number2;

    double hm = 2 / (r1 + r2);  // reciprocal of the arithmetic mean of the two
    return hm;
} 
```

# ruby - ActiveRecord 格式验证未触发

> ID：14714353
> 
> 赞同：0
> 
> 时间：2013-02-05T18:29:21.837
> 
> 标签：ruby, ruby-on-rails-3, activerecord

我正在尝试对模型应用格式验证，但是当我创建模型时，它并没有返回为无效。我添加了一个长度验证，它工作得很好。我究竟做错了什么？

```
require 'rubygems'
require 'active_record'

class User < ActiveRecord::Base
  validates :username, :format => { :with => /[A-Za-z]+/, :message => "Only letters a-z are allowed" }
  validates :username, :length => { :maximum => 20, :too_long => "%{count} letters is too many"}
end  

ActiveRecord::Base.establish_connection( ... )

user = User.create!(:username => 'johnsmith1234', :signupdate => '2010-11-12')
puts user.valid? 
```

除非我的长度超过 20 个字符，否则输出始终为真，然后我收到长度错误。那么为什么格式验证不会触发呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:36:18.267

`/[A-Za-z]/`检查给定字符串中的一个或多个字母。如果您只想要字母，则需要指定`^`and `$`。（IE）`/^[A-Za-Z]$/`

```
validates :username, :format => { :with => /^[A-Za-z]+$/, :message => "Only letters a-z are allowed" } 
```

还有一件事用于`new`创建新用户。因为`create`or`create!`会在你的验证失败时抛出错误。

```
user = User.new(:name => "john123")
if user.valid?
  #do something
else
  #do something          `user.errors.full_messages` will have your validation messages if it has error
end 
```

# python - 在 Python 中从文本文件中读取某些段落？

> ID：14714354
> 
> 赞同：0
> 
> 时间：2013-02-05T18:29:23.233
> 
> 标签：python

我正在尝试从文本文件中解析某些段落。我试图解析的段落被标记为：

抽象主义

PAL 耐磨层压板是通过在传统印刷纸的表面上提供超薄的矿物颗粒和微晶纤维素涂层，然后用传统的层压树脂浸渍纸，然后使用如此获得的印刷纸制成的。层压工艺，无需使用覆盖板。

PARN

到目前为止，我得到的是：

```
with open('file.txt', 'r+') as f:
   for line in f:
        if line.startswith("ABST"):
            print f.next() 
```

这只是给我留下了该段落的第一行。我想要的是类似的东西：

```
with open('file.txt', 'r+') as f:
   for line in f:
        if line.startswith("ABST"):
            *print lines until next header* 
```

我意识到这并不太复杂，但我一直陷入困境，所以任何建议都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:38:02.670

```
with open('file.txt', 'r+') as f:
   flag = False
   for line in f:
        if line.startswith("PARN"):
            flag = False
        if flag:
            print line
        if line.startswith("ABST"):
            flag = True 
```

应该做的伎俩......直截了当。在任何情况下，您都可以让循环为您处理迭代，只要确保您记住是否应该打印。

# jquery - jQuery在选择菜单中获取选项的值

> ID：14714356
> 
> 赞同：1
> 
> 时间：2013-02-05T18:29:36.650
> 
> 标签：jquery

我想找到具有“未定义”值的选择菜单的所有选项，然后隐藏它们。

如果有帮助，这是我的 jSFiddle。

```
<select id="tinynav1" class="tinynav tinynav1"><option>Navigation</option><option value="http://example.com/">Home</option><option value="undefined">Philosophy</option><option value="http://example.com/shop/">Shop</option><option value="undefined">Winemakers</option><option value="undefined">- Czech Republic</option><option </select> 
```

[http://jsfiddle.net/huwrowlands/6SDWY/](http://jsfiddle.net/huwrowlands/6SDWY/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:15:36.040

$('#tinynav1 option[value="undefined"]').remove(); - By @jahuna

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:44:15.020

像这样：http: [//jsfiddle.net/38NSL/](http://jsfiddle.net/38NSL/)

基本上：

```
jQuery(document).ready(function($)
{
    $('option').each(function(e)
    {
        if($(this).val() == "undefined")
        {
            $(this).remove();
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T18:30:58.633

```
$('#tinynav1 option[value="undefined"]').hide(); 
```

显然 IE 不尊重`display`选项元素的属性。在这种情况下，您可以使用在 Applied style="display:none" in <option> 中找到的`remove()`代替`hide()` *或*建议[在 IE 中不工作但在 Mozilla 中工作，](https://stackoverflow.com/questions/5187300/applied-style-displaynone-in-option-not-working-in-ie-but-working-mozilla)并[在 MSIE 下将选择的选项显示样式更改为无](https://stackoverflow.com/questions/2225021/changing-selects-option-display-style-to-none-under-msie)。

# extjs - 为具有大量数据的 ExtJS 树网格实现过滤器

> ID：14714360
> 
> 赞同：2
> 
> 时间：2013-02-05T18:29:50.963
> 
> 标签：extjs, extjs4.1

我正在开发一个使用 ExtJS 4.1 的项目

我需要用过滤器实现一个树形网格。根据我阅读各种文章、博客和 SO 帖子的理解，ExtJS 不提供带有树存储的过滤机制，我们需要编写自己的过滤机制。

对于过滤，建议使用两种方法：1）将数据加载到树形网格中，然后根据过滤条件显示/隐藏节点 2）操作存储（复制数据并从存储中删除记录）

我尝试了第一种方法。它与测试数据（大约 30 个节点）完美配合。但是对于生产数据的快照，我在 IE 和 FireFox 中遇到了“无响应的脚本”错误。使用 Chrome，它运行良好。

基本上生产数据库有大量数据，大约 3500 条记录，在树形网格中形成大约 900 个节点。我怀疑，一旦填充了树存储，在将所有 900 个节点渲染到树网格中时，我会收到“无响应脚本”错误。

我是 ExtJS 的新手，不确定解决这个问题的最佳方法是什么。我想知道，过滤如何在网格上工作。我可以为树网格复制相同的过滤机制吗？

欢迎任何解决此问题的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:01:33.990

如果您可以使用带有分组的网格而不是树，那么您可以使用带有分页的过滤的网[格](http://cdn.sencha.com/ext-4.1.1a-gpl/examples/grid-filtering/grid-filter-local.html)。如果没有，那么您可以使用类似[Ext.grid.plugin.BufferedRenderer](http://www.sencha.com/blog/first-look-at-ext-js-4-2-grid/)的东西，它也可以用于 TreePanel，但它仅在 4.2 上可用。如果这些都不是您的解决方案，那么您必须创建自己的自定义过滤才能为您处理分页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T22:48:10.380

我发现在每个节点的展开事件上加载子节点是最小化树面板的 dom 交互的一种不错的方法。这样，当您过滤时，它只需要过滤树结构的第一级而不是整个事物。我现在让它在一个访问控制管理应用程序中工作，该应用程序在一个树面板中处理大约 350 个资源，另外两个具有大约 75 个节点，每个节点通过事件链接在一起。这种方法没有明显的 UI 滞后，但我还没有将它扩展到你的规模，这在很大程度上取决于你的树的第一级中有多少项目是否适合你。

# .net - 如何编写 .NET 控制台应用程序来访问 SkyDrive？

> ID：14714366
> 
> 赞同：0
> 
> 时间：2013-02-05T18:29:58.160
> 
> 标签：.net, onedrive

我正在尝试研究如何创建一个简单的 .NET 控制台应用程序来访问 skydrive，以便我可以从命令行发送和接收文件。

Live Connect SDK 和文档似乎有点模糊，通常针对 Metro 或 HTML 应用程序。

如果有人知道如何进行身份验证然后列出内容，我认为这应该很简单，那么其余的可能会很容易。

理想情况下，我想使用 API，但如果我必须恢复驱动 REST API，那也没关系。

这是我正在尝试使用的代码块

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Microsoft.Live;

namespace SkyDriveCmd
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                var task = Run();
                task.Wait();
            }
            catch (Exception ex)
            {
                Console.Error.WriteLine(ex);
            }
        }

        private static async Task Run()
        {
            var auth = new LiveAuthClient("XXXXXXXXXXXXX");
            var client = new LiveConnectClient(auth.Session);
            var result = await client.GetAsync("/");
            Console.WriteLine(result.RawResult);
        }
    }
} 
```

我知道这是错误的，因为 auth.Session 为空，但我发现大量缺乏关于它如何工作的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-15T18:48:49.443

这是使用从[http://skydriveapiclient.codeplex.com/releases/view/103081下载的 Api 的示例](http://skydriveapiclient.codeplex.com/releases/view/103081)

```
 static void Main(string[] args)
    {
        var client = new SkyDriveServiceClient();

        client.LogOn("YourEmail@hotmail.com", "password");
        WebFolderInfo wfInfo = new WebFolderInfo();

        WebFolderInfo[] wfInfoArray = client.ListRootWebFolders();

        wfInfo = wfInfoArray[0];
        client.Timeout = 1000000000;

        string fn = @"test.txt";
        if (File.Exists(fn))
        {
            client.UploadWebFile(fn, wfInfo);
        }

    } 
```

# java - 以 Object... 作为参数的 Java 反射

> ID：14714368
> 
> 赞同：0
> 
> 时间：2013-02-05T18:29:58.637
> 
> 标签：java, reflection

我想使用 Java 反射来调用我的一个具有以下签名的类的方法：

```
public Object execute(Object...params) 
```

在我的加载器类中，我已经加载了类，但我不确定如何设置我的 getMethod 调用。目前，我有这样的事情：

```
Method classEntry = _loadedClass.getMethod("execute", new Class[]{Object[].class}); 
```

然后，我尝试在创建我的类的 newInstance 后调用此方法，方法是：

```
Object classObj = _loadedClass.newInstance();
classEntry.invoke(classObj, params); // params comes in from the method as Object...params 
```

这给了我一个`java.lang.NoSuchMethodException`例外。我知道我的问题在于我的 getMethod 调用。我应该如何设置它以接受 params 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:32:22.227

如果`params`是类型，`Object []`那么你需要这样调用`invoke`：

```
classEntry.invoke(classObj, new Object [] {params}); 
```

但这并不能说明`NoSuchMethodException`

# ios - 如何将 UIBezierPath 带到 MKAnnotation 对象的后面？

> ID：14714374
> 
> 赞同：5
> 
> 时间：2013-02-05T18:30:23.910
> 
> 标签：ios, objective-c, mkmapview, uibezierpath

在我的应用程序中，用户在地图上绘制了一个形状并使用 UIBeizerPath 我绘制了该路径。然后根据路径的坐标，我显示仅在该区域中的结果。一切都很好，除了现在当注释掉到地图视图上时，大头针看起来就像它们在路径后面，这意味着路径看起来在前面。

我正在使用此代码来显示注释和路径：

```
 -(void)clearAnnotationAndPath:(id)sender {
    [_mapView removeAnnotations:_mapView.annotations];
    path = [UIBezierPath bezierPath];
    [shapeLayer removeFromSuperlayer];
}

- (void)handleGesture:(UIPanGestureRecognizer *)gesture
{

    CGPoint location = [gesture locationInView:_pathOverlay];

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        shapeLayer = [[CAShapeLayer alloc] init];
        shapeLayer.fillColor = [[UIColor clearColor] CGColor];
        shapeLayer.strokeColor = [[UIColor greenColor] CGColor];
        shapeLayer.lineWidth = 5.0;
        //[_mapView.layer addSublayer:shapeLayer];
        [pathOverlay.layer addSublayer:shapeLayer];
        path = [UIBezierPath bezierPath];
        [path moveToPoint:location];
    }

    else if (gesture.state == UIGestureRecognizerStateChanged)
    {
        [path addLineToPoint:location];
        shapeLayer.path = [path CGPath];
    }

    else if (gesture.state == UIGestureRecognizerStateEnded)
    {
        // MKMapView *mapView = (MKMapView *)gesture.view;

        [path addLineToPoint:location];
        [path closePath];
        allStations = [RoadmapData sharedInstance].data;
        for (int i=0; i<[allStations count]; i++) {
            NSDictionary * itemNo = [allStations objectAtIndex:i];

            NSString * fullAddress = [NSString stringWithFormat:@"%@,%@,%@,%@",[itemNo objectForKey:@"address"],[itemNo objectForKey:@"city"],[itemNo objectForKey:@"state"],[itemNo objectForKey:@"zip"]];
            CLGeocoder * geoCoder = [[CLGeocoder alloc]init];
            [geoCoder geocodeAddressString:fullAddress completionHandler:^(NSArray *placemarks, NSError *error) {

                if (error) {
                    NSLog(@"Geocode failed with error: %@", error);
                    return;
                }

                if(placemarks && placemarks.count > 0)
                {
                    CLPlacemark *placemark = placemarks[0];
                    CLLocation *location = placemark.location;
                    CLLocationCoordinate2D coords = location.coordinate;
                    CGPoint loc = [_mapView convertCoordinate:coords toPointToView:_pathOverlay];
                    if ([path containsPoint:loc])
                    {
                        NSString * name = [itemNo objectForKey:@"name"];
                        stationAnn = [[LocationAnnotation alloc]initWithCoordinate:coords Title:name subTitle:@"Wells Fargo Offer" annIndex:i];
                        stationAnn.tag = i;
                        [_mapView addAnnotation:stationAnn];
                    }
                    else{
                        NSLog(@"Out of boundary");
                    }
                }
            }];
            [self turnOffGesture:gesture];
        }
    }
}

- (void)mapView:(MKMapView *)aMapView didAddAnnotationViews:(NSArray *)views{
    if (views.count > 0) {
        UIView* firstAnnotation = [views objectAtIndex:0];
        UIView* parentView = [firstAnnotation superview];
        if (_pathOverlay == nil){
            // create a transparent view to add bezier paths to
            pathOverlay = [[UIView alloc] initWithFrame: parentView.frame];
            pathOverlay.opaque = NO;
            pathOverlay.backgroundColor = [UIColor clearColor];
            [parentView addSubview:pathOverlay];
        }

        // make sure annotations stay above pathOverlay
        for (UIView* view in views) {
            [parentView bringSubviewToFront:view];
        }
    }
} 
```

同样，一旦我从这里返回并查看并再次出现，它甚至都没有绘制路径。

请帮忙。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T10:38:59.473

显然，当您通过以下方式将贝塞尔路径添加到地图时：

```
 [_mapView.layer addSublayer:shapeLayer]; 
```

它被添加**到**一些`MKMapView`用于绘制注释的内部层之上。如果[你看一下这个有点相关的问题](https://stackoverflow.com/a/2071337/119114)，你会发现你可以实现`MKMapViewDelegate`协议，并在添加新站注释时获得回调。发生这种情况时，您基本上检查新添加注释的视图层次结构，并在它们**下面**`UIView`插入一个新的透明层。您注意将所有注释带到这个透明的前面。**`UIView`**

 **```
 // always remember to assign the delegate to get callbacks!
  _mapView.delegate = self; 
```

...

```
#pragma mark - MKMapViewDelegate

- (void)mapView:(MKMapView *)aMapView didAddAnnotationViews:(NSArray *)views{
    if (views.count > 0) {
        UIView* firstAnnotation = [views objectAtIndex:0];
        UIView* parentView = [firstAnnotation superview];
        // NOTE: could perform this initialization in viewDidLoad, too
        if (self.pathOverlay == nil){
            // create a transparent view to add bezier paths to
            pathOverlay = [[UIView alloc] initWithFrame: parentView.frame];
            pathOverlay.opaque = NO;
            pathOverlay.backgroundColor = [UIColor clearColor];
            [parentView addSubview:pathOverlay]; 
        }

        // make sure annotations stay above pathOverlay
        for (UIView* view in views) {
            [parentView bringSubviewToFront:view];
        }
    }
} 
```

然后，不是将形状图层添加到`_mapView.layer`，而是将其添加到透明视图图层，也在坐标转换中使用这个新图层：

```
- (void)handleGesture:(UIPanGestureRecognizer*)gesture
{
    CGPoint location = [gesture locationInView: self.pathOverlay];

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        if (!shapeLayer)
        {
            shapeLayer = [[CAShapeLayer alloc] init];
            shapeLayer.fillColor = [[UIColor clearColor] CGColor];
            shapeLayer.strokeColor = [[UIColor greenColor] CGColor];
            shapeLayer.lineWidth = 5.0;
            [pathOverlay.layer addSublayer:shapeLayer];   // <- change here !!!
        }
        self.path = [[UIBezierPath alloc] init];
        [path moveToPoint:location];
    }
    else if (gesture.state == UIGestureRecognizerStateChanged)
    {
        [path addLineToPoint:location];
        shapeLayer.path = [path CGPath];
    }
    else if (gesture.state == UIGestureRecognizerStateEnded)
    {
        /*
         * This code is the same as what you already have ...
         */

             // But replace this next line with the following line ...
             //CGPoint loc = [_mapView convertCoordinate:coords toPointToView:self];
             CGPoint loc = [_mapView convertCoordinate:coords toPointToView: self.pathOverlay];

        /*
         * And again use the rest of your original code
         */            
    }
} 
```

我还为新的透明层添加了一个*ivar （和属性）：*

```
UIView* pathOverlay; 
```

我用一个虚假的站点网格对此进行了测试，得到了以下结果：

![在此处输入图像描述](../Images/ab82780d6bddc4c908cf44ddf143d826.png)

PS我还建议摆脱你的`static`变量。只需将它们设为您班级的 ivars/properties。**

# c# - 生命周期长于页面生命周期的 MVVM 和异步任务

> ID：14714381
> 
> 赞同：4
> 
> 时间：2013-02-05T18:30:55.333
> 
> 标签：c#, windows-phone-7, design-patterns, windows-phone-8

MVVM 方法很好并且很成熟。但是想象一下场景：您有一个应用程序页面，用户可以在其中启动一些长时间运行的任务。就像本地和远程数据库的同步。此任务可能很长，只能优雅地中断。然后用户离开页面，转到一些详细信息页面。取消那个长时间的异步操作没有意义，因为应用程序仍在运行。但是突然用户接到一个电话，因此该应用程序被停用。

在我对 MVVM 的（可能过于原始）的理解中，视图模型应该用于控制与模型的交互（尤其是长时间的操作）。但是 View Model 不需要了解应用程序生命周期事件，因为这会限制代码的可重用性（在 Windows 8 上没有 PhoneApplicationService 这样的类）。在这里看到矛盾了吗？VM 启动操作，但不应用于取消操作。

当然，View 可以承担这个责任来处理生命周期事件。所以关于应用程序停用的事件是这样传播的：`View -> ViewModel -> (cancels long operation) -> Model`. 但是，如果用户已经从 View 导航，并且在该 View 中启动的一些操作仍在运行，则无法再取消它 - View 可以随时处置。

我只想到了一个想法，那就是在 View Models 中处理应用程序生命周期事件。但是，正如我之前所说，我不喜欢这种方法，因为它限制了 View Models 的可移植性。谁能提供更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:39:50.003

> 我只想到了一个想法，那就是在 View Models 中处理应用程序生命周期事件。但是，正如我之前所说，我不喜欢这种方法，因为它限制了 View Models 的可移植性。谁能提供更好的解决方案？

我实际上在这里没有看到问题。在 MVVM 中，ViewModel 传统上是将 View 与 Model 联系起来的“粘合剂”。

为每个平台拥有少量自定义 ViewModel 代码并不一定会限制 ViewModel 其余部分的可移植性，尤其是当它被抽象并包含在每个平台的自己的项目中时。

> VM 启动操作，但不应用于取消操作。

这强烈表明 VM*应该*是取消它的那个。如果虚拟机创建了这些操作，它实际上拥有它们的所有权，这表明它也应该管理它们的生命周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T00:35:34.887

我不确定这是否违反了 MVVM 原则，但我只是这样想。

关于在VM中订阅PhoneApplicationService，有什么理由不采取这种方法吗？

应用程序 -> 视图模型

应用程序是虚拟机的所有者，如果应用程序通过类似于视图对其虚拟机的界面告诉虚拟机激活/停用，虚拟机可以保持可重用性。但是一旦VM在其中订阅PhoneApplicationService，这不是真的吗，这意味着VM依赖于应用程序，这意味着VM和应用程序相互依赖并且限制了可重用性？

关于长时间任务，如果它需要根据应用程序生命周期而不是页面生命周期生存，它可以作为应用程序模型在 App 范围内，或者可以从 VM 共享但不在页面（视图）范围内的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:35:19.373

您给出的描述向我表明，缺少抽象层。

尤其是：

您的 ViewModel 当然可以启动影响模型的长期运行的事件，但它们对这些长期运行的事件没有任何所有权。这是完全正确的，不应该被打破。如果您启动一个长时间运行的事件（并且您的数据库同步示例在这里非常好），那么模型应该处理这个。

这里缺少的部分是我相信的模型。当有影响模型的长时间运行的任务时，有一个单独的层来处理这些任务。`Transaction`为了简单起见，让我们称呼它们。

所以：你在模型域中开始你的长期运行的任务。然后模型执行此任务，如果一切正常并且没有被某些用户或系统交互中断，则可以将任务数据应用于模型（或者可以提交事务）。

如果用户或系统以某种方式取消任务，则模型中的任何数据都不应更改。模型本身不会改变！

另一方面，如果模型成功更改，则应通知 ViewModel 并更新视图。但这只是您在这里拥有的两个主要执行分支之一。它就是你的 MVVM 和 ViewModel 实现可能已经处理的那个。

总体：您的视图模型应该启动和取消在模型上运行的任务，但它不需要特别控制它们的生命周期。如果您提出取消长时间运行的任务的可能性，您可以触发取消事件，但应该优雅地结束模型中的任务。

# javascript - HTML 5 视频结束

> ID：14714385
> 
> 赞同：0
> 
> 时间：2013-02-05T18:31:04.290
> 
> 标签：javascript, html, video

我试图从 HTML 5 视频标签中收听视频“结束”事件。它似乎在测试期间被非常不定期地触发。大多数时候它根本不会发送。我已使用 Adob​​e Midea Encoder 将我的 .mov 编码为 mp4。

有谁知道为什么它可能不起作用，我是否应该在媒体编码器上对我的文件进行编码以获得更好的结果。

这就是我收听结束的方式（Nel 是视频元素；）：

```
el.addEventListener("ended", this.endHandler); 
```

这是使用的基本 HTML 即时消息：

```
<video id="v1"></video> 
```

我用代码动态设置视频 src。它玩得很好，有时我会得到结束的事件，但并非总是如此。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:28:41.277

似乎视频有时会在实际持续时间之前停止播放。大约 0.0000025 秒之前，这意味着未发送结束的事件。

要解决这个问题，我会舍入持续时间并检查 setInterval 上的当前时间。

```
//duration = 5.26 ( rounded down from 5.2600041)
if(this.video.currentTime >= this.duration) {
  //VIDEO ENDED
} 
```

# sql - 避免左连接中的空表

> ID：14714392
> 
> 赞同：1
> 
> 时间：2013-02-05T18:31:18.547
> 
> 标签：sql, join

如果我用左连接将两个表连接在一起并且其中一个表完全为空，我会在连接表中得到一堆空列。

这是一个演示我的意思的[小提琴。](http://sqlfiddle.com/#!4/67da6/8/1)

我希望生成的连接表不包含所有这些空列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:32:29.793

查询返回的列数是固定的。它不能根据表是否为空而改变。所以答案是否定的。

# php - 将时间插入php表单并提交到mysql

> ID：14714394
> 
> 赞同：0
> 
> 时间：2013-02-05T18:31:30.013
> 
> 标签：php, html, mysql, forms

我知道这可能比听起来容易，但我已经在网上搜索了几个小时的解决方案。我想在表单中添加一个简单的 html 文本框，用户可以在其中输入“到达时间”并提交给 mysql。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:37:02.447

将文本框验证为已知形式，例如：

```
2007-06-05 15:26:0 
```

使用 strtotime() 将提交和验证的值解析为 PHP 日期对象，如下所示：

```
 $timestamp = strtotime($_POST['userinput']);
 $mysql_date = date("Y-m-d H:m:s", $timestamp); 
```

strtotime 文档：http: [//php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)

然后只需将 $mysql_date 变量放入数据库中的 datetime 列。

编辑：为如何验证 mysql 时间字符串的值添加代码

```
function TimeIsValid(){
    var field = document.getElementById('timeid');
    if(field.value.match("/^([0-9]{2,4})-([0-1][0-9])-([0-3][0-9]) (?:([0-2][0-9]):([0-5][0-9]):([0-5][0-9]))?$/")) 
        return true;
} 
```

我不确定那个正则表达式有多好，我没有写它，从：[http ://www.dzone.com/snippets/regular-expression-match](http://www.dzone.com/snippets/regular-expression-match)

# java - 如何向企业解释为什么重构很重要

> ID：14714397
> 
> 赞同：2
> 
> 时间：2013-02-05T18:31:33.910
> 
> 标签：java, spring, architecture, exception-handling, entities

我目前正在从事一个有一些（在我看来）架构问题的项目。

例如 - 每个对象都可以通过静态方法访问的公共框架 Bean 在需要时检索每个依赖项。这实际上只是一个将返回 Spring bean 的 spring 包装器。没有依赖注入。

实体引用 DAO 来检索关系数据 - 隐藏在实体 getter 中。

异常具有对解析和翻译错误消息的服务的引用。

每个服务或 DAO 都继承自一些通用的抽象框架 bean，这些 bean 有自己的依赖关系和配置要求。如果您尝试执行其他任何操作，您将收到“未初始化框架”错误。还应该提到的是，框架是一个没人敢碰的黑匣子。

每个测试实际上都是一个集成测试，因为它们都需要一个工作数据库连接到一个中央共享数据库。

我们有一个依赖图，基本上，一切都连接到一切。

并且没有测试。

想象一下在这种环境中设置单元测试是多么困难。事实上，每个测试都试图插入测试数据并自行清理——不使用任何类型的事务。

我只是在这里触及表面。

不用说，我有点担心代码质量。该项目（当然）时间和资源不足，并且截止日期即将到来。

那么 - 如果我们希望交付类似于功能软件的东西，如何用他们理解的语言说服管理层需要重构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:41:24.617

在我看来，最好的方法是：

1.  Metrics：收集所有可能的关于使用当前架构引起的问题的数据。分析信息并将其划分为感兴趣的主题，例如：可靠性、效率、安全性和可维护性。（参见：[软件质量](http://en.wikipedia.org/wiki/Software_quality#Measurement)）

2.  视觉：使用分析的信息制作漂亮的条形图和饼图。

3.  差异：将您的结果与标准或理想指标进行比较。

有了这个，您就可以向管理层展示您对项目的看法。

通常这项工作是项目经理、团队经理或团队负责人的职责。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:42:45.857

实际上，在许多情况下，重构可能对业务不利，因为收益小于成本。在其他情况下，收益可能大于成本，但成本太高，无法立即支付。尝试估计一些业务可以转换为$$$的单位的重构收益和成本，即开发人员、测试人员和支持团队的工时，系统不可用的小时数等，并让业务决定是否值得进行重构， 或不。这样的决策是业务比开发人员更强大的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:10:23.007

我正在开发一个依赖项相似的项目。单元测试并不理想。我在每个测试中都模拟了这么多类，因此在开发环境中简单地运行完整的应用程序是一个更好的解决方案。

我想这取决于您的应用程序。我的是一个服务 HTTP 请求的自定义 Web 应用程序。我打开它并发送各种请求以尝试遵循所有可能的路径。它更像是一个功能测试而不是单元测试，但我发现这个过程要快得多，而且我的日志语句提供的信息足以让我发现特定类或方法中的错误。

我写了我的代码，在开发中对其进行了功能测试。环境，然后找时间，慢慢的给类加了单元测试。

与他们讨论可能影响应用程序未来的预期变化、新功能、需求、技术等。如果项目永远不会发展，则可能不值得重构。

**我并不是说功能测试是单元测试的替代品。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-27T09:50:41.813

如果您认为需要说服“业务”了解重构的好处，那么您的想法**并不是**重构。重构是一种重新设计，但并非所有的重新设计都是重构。重构是一种小的、增量的设计改进。因为它很小，所以便宜又快。所以它不需要“业务”的批准：你可以*去做*。听起来您在这里真正拥有的是现有代码*不适合目的*。所以你应该试图说服他们，而不是试图说服他们需要做一些听起来像是不必要的“抛光”的事情。

# android - 翻译的按钮没有给出正确的结果

> ID：14714398
> 
> 赞同：0
> 
> 时间：2013-02-05T18:31:41.277
> 
> 标签：android, animation, button, onclick

我的活动中有一个按钮，并使用 TranslateAnimation 更改其位置。

我正在使用 anim.setFillAfter(true); 为了保持最终的翻译，按钮会移动其位置，但触摸区域保持不变。
现在，当我触摸按钮时，它不起作用，而是触摸按钮的先前位置调用其侦听器..

这是我的代码：
MainActivity.java

```
public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Animation anim=new TranslateAnimation(0, 100, 0, 0);
        anim.setDuration(500);
        anim.setFillAfter(true);
        Button mybtn = (Button)findViewById(R.id.btn);
        mybtn.startAnimation(anim);
    }

    public void myFunc(View v){
        Toast.makeText(this, "btn clicked", Toast.LENGTH_SHORT).show();
    }
} 
```

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
            xmlns:tools="http://schemas.android.com/tools"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            tools:context=".MainActivity" >

            <Button
                android:id="@+id/btn"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_centerHorizontal="true"
                android:layout_centerVertical="true"
                android:text="@string/hello_world" 
                android:onClick="myFunc"/>

        </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:54:15.793

我在这个页面 [vogella](http://www.vogella.com/articles/AndroidAnimation/article.html#animations_viewpropertyanimator)找到了我的查询的答案 ，[这里](http://developer.android.com/guide/topics/graphics/prop-animation.html)android 已经解释过了，按钮需要属性动画而不仅仅是视图动画：

这是我使用的代码：

```
Button mybtn = (Button)findViewById(R.id.btn);
mybtn.animate().translationX(400).setDuration(500); 
```

感谢您的帮助...如果其他人需要帮助，我将离开此职位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:15:26.497

I have re-generated your case and it seems like only 50% of the button shows the selected color. Is that right ? Try this :

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button sampleButton = (Button)findViewById(R.id.btn);
    sampleButton.animate().translationX(somevalue).setDuration(someduration);
} 
```

# ios - 是否可以使具有复杂子视图的表格视图像黄油一样滚动平滑

> ID：14714399
> 
> 赞同：0
> 
> 时间：2013-02-05T18:31:42.737
> 
> 标签：ios, uitableview

在我的表格视图中，我使用了自定义单元格，其中有许多子视图，两个 egoimageviews（imageview 的子类，它接受一个 URL 并从 web 获取图像然后缓存它们以供以后使用），一个打开链接检测的 textview， 4 个标签和一个按钮。我在 egoimageview 和 textview 中添加了点击手势。textview 的高度是根据它所包含的文本的大小计算的。高度计算是提前完成的，因此滚动性能不会因用户滚动时即时计算高度而受到影响。所有这些数据都是从网络上获取的，然后计算文本高度和单元格高度并将其存储在一个数组中，然后将 tableview 作为子视图添加。对于某些单元格，没有要显示的图像，所以在这些情况下，我只是在将其框架设置为 cgrectzero 后隐藏我的 egoimageview。这些图像在 iphone 屏幕上占据大约 170 px X 100 px，每个大约 250 KB。当我滚动时，滚动非常生涩。我对慢速滚动单元进行了一些研究，到目前为止，我已经实现了以下功能，但没有显着提高性能：

1.  高度是提前计算好的，而不是使用 heightforrow 方法。
2.  单元格背景及其子视图的背景是不透明的。
3.  数据布局有两种方式，所以我有两种相似的自定义单元格类，但有一些不同，所以根据内容，决定返回的单元格类型，虽然 90% 的时候，只有使用第一种。

我对这个生涩的滚动不太满意，尽管布局如此复杂，但我一直在沮丧地查找网络以使其滚动黄油平滑，但到目前为止没有任何帮助。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:55:05.333

代码是

```
 - (UITableViewCell *) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
if([type intValue] == POSTS) {
    Feed *feed = [postsArray objectAtIndex:indexPath.row];
    FeedCellFormattedDataObject *feedCellFormattedDataObject=[postsCellFormattedDataArray objectAtIndex:indexPath.row];
    if(feed.feedTypeIndex==0){//SIMPLEST CELL
        SimplestCell *simplestCell=[tableView dequeueReusableCellWithIdentifier:@"simplestcell"];
        if(!simplestCell){
            simplestCell=[[SimplestCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"simplestcell"];
            simplestCell.delegate=self;
            simplestCell.isInDetailedPostView=NO;
            simplestCell.selectionStyle = UITableViewCellSelectionStyleNone;
            [simplestCell.likeBtn addTarget:self action:@selector(likeButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
        }
        simplestCell.cellIndex=indexPath.row;
        [simplestCell setDataWithFeed:feed andFeedCellFormattedDataObject:feedCellFormattedDataObject];
        return simplestCell;
    }
    if(feed.feedTypeIndex==1){//SIMPLEFEEDCELL WITH IMAGE
        SimpleFeedCell *simpleCellWithImage=[tableView dequeueReusableCellWithIdentifier:@"imagecell"];
        if(!simpleCellWithImage){
            simpleCellWithImage=[[SimpleFeedCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"imagecell"];
            simpleCellWithImage.delegate=self;
            simpleCellWithImage.isInDetailedPostView=NO;
            UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(photoOrVideoTapped:)];
            [simpleCellWithImage.feedImageView addGestureRecognizer:tapGesture];
            simpleCellWithImage.selectionStyle = UITableViewCellSelectionStyleNone;
            [simpleCellWithImage.likeBtn addTarget:self action:@selector(likeButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
        }
        simpleCellWithImage.cellIndex=indexPath.row;
        [simpleCellWithImage setDataWithFeed:feed andFeedCellFormattedDataObject:feedCellFormattedDataObject];
        return simpleCellWithImage;
    }

    if(feed.feedTypeIndex==2){//SIMPLEFEEDCELL WITH VIDEO
        SimpleFeedCell *simpleCellWithVideo=[tableView dequeueReusableCellWithIdentifier:@"videocell"];
        if(!simpleCellWithVideo){
           simpleCellWithVideo=[[SimpleFeedCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"videocell"];
            simpleCellWithVideo.delegate=self;
            simpleCellWithVideo.isInDetailedPostView=NO;
            UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(photoOrVideoTapped:)];
            [simpleCellWithVideo.feedImageView addGestureRecognizer:tapGesture];
            simpleCellWithVideo.selectionStyle = UITableViewCellSelectionStyleNone;
            [simpleCellWithVideo.likeBtn addTarget:self action:@selector(likeButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
            simpleCellWithVideo.playVideoImageView.hidden=NO;
        }
        simpleCellWithVideo.cellIndex=indexPath.row;
        [simpleCellWithVideo setDataWithFeed:feed andFeedCellFormattedDataObject:feedCellFormattedDataObject];
        return simpleCellWithVideo;
    }

    if(feed.feedTypeIndex==3){//LINKFEEDCELL
        LinkFeedCell *linkFeedCell=[tableView dequeueReusableCellWithIdentifier:@"linkcell"];
        if(!linkFeedCell){
            linkFeedCell=[[LinkFeedCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"linkcell"];
            linkFeedCell.delegate=self;
            linkFeedCell.isInDetailedPostView=NO;
            linkFeedCell.selectionStyle = UITableViewCellSelectionStyleNone;
            [linkFeedCell.likeBtn addTarget:self action:@selector(likeButtonClicked:) forControlEvents:UIControlEventTouchUpInside];

        }
        linkFeedCell.cellIndex=indexPath.row;
        [linkFeedCell setDataWithFeed:feed andFeedCellFormattedDataObject:feedCellFormattedDataObject];
        return linkFeedCell;
    }

}
else {
    EventCell * eventCell=(EventCell*)[tableView dequeueReusableCellWithIdentifier:@"eventcell"];
    if(!eventCell){
        eventCell=[[EventCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"eventcell"];
        eventCell.selectionStyle=UITableViewCellSelectionStyleGray;
    }
    [eventCell setCellDataWithEvent:[eventsArray objectAtIndex:indexPath.row]];
    return eventCell;
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:10:07.180

设置数据的代码

```
 //set data and properties
self.dateLabel.text=feed.when;
self.msgTextView.text=feed.message;
self.likesCountLabel.text=feedCellFormattedDataObject.likesString;
self.commentsCountLabel.text=feedCellFormattedDataObject.commentsString;
self.userImageView.imageURL=feedCellFormattedDataObject.posterPicURL;
self.feedImageView.tag=self.cellIndex;
self.feedImageView.imageURL=feedCellFormattedDataObject.imageURL;
self.likeBtn.tag=self.cellIndex;
if(feed.canUserLike){
    self.likeBtn.hidden=NO;
    [self.likeBtn setBackgroundImage:feedCellFormattedDataObject.likeButtonImage forState:UIControlStateNormal];
}
else self.likeBtn.hidden=YES;

//adjust frames on the fly
self.msgTextView.frame=feedCellFormattedDataObject.msgTextViewFrame;
self.feedImageView.frame=feedCellFormattedDataObject.feedImageViewFrame;
self.likeBtn.frame=feedCellFormattedDataObject.likeBtnFrame;
self.likesCountLabel.frame=feedCellFormattedDataObject.likesCountLabelFrame;
self.commentsCountLabel.frame=feedCellFormattedDataObject.commentsCountLabelFrame;
self.commentsImageView.frame=feedCellFormattedDataObject.commentsImageViewFrame;
self.bgView.frame=feedCellFormattedDataObject.bgViewFrame; 
```

# java - 如何在多维数组中找到所有可能的递增顺序路径？

> ID：14714400
> 
> 赞同：-7
> 
> 时间：2013-02-05T18:31:50.030
> 
> 标签：java, traversal

我想知道 Java 代码以找到多维数组的所有可能路径。我们应该从`[0][0]`节点开始，往前走。要记住的是，无论元素顺序如何，路径都必须按递增顺序排列。如果下一个元素等于（或小于）当前元素，我们不应该遍历。

### 示例数组：

```
3   5   1
6   7   4
8   2   9 
```

### 结果：

```
3,5,6,7,8
3,5,6,7,9
3,5,7,8
3,5,7,9
3,6,7,8
3,6,7,9
3,7,8
3,7,9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:47:25.053

您应该从起点开始构建一棵树。在您的示例数组中，从左上角开始，树可能如下所示：

```
 3
   / \ \ 
  5  6  7 
 / \  \  \
7   6  ..  .. 
```

一旦你有了那棵树，你只需要走下树中的每条路径。

尽管它可能看起来很吓人，但您可以将其分为两部分：

*   构建树。
*   遵循路径。

* * *

*   首先，尝试想出一种方法来让您的起点开始打印。这很容易。

*   一旦你做到了那么远，打印你的起点的邻居>它的价值。

*   然后，为每个邻居做同样的事情！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:37:14.537

我认为以下代码可以满足您的描述。它开始检查第一个节点 (0,0)。对于检查的每个节点，都会创建一个邻居向量。邻居是有资格成为路径延续的节点（即表中具有较高值的​​相邻节点）。然后对于每个邻居，克隆路径，并检查新邻居。这一直持续到被检查节点没有合格的邻居，此时路径被打印并且算法终止。

尝试这个：

```
import java.util.Arrays;
import java.util.Vector;

class Main {
  class Coords {
    int x;
    int y;
    Coords(int x, int y) {
      this.x = x;
      this.y = y;
    }
  }
  int [][] array = { {3,5,1},{6,7,4},{8,2,9}};
  Vector<Coords> getNeighbors(Coords coords) {
     int x = coords.x;
     int y = coords.y;
     Vector<Coords> result = new Vector<Coords>();
     if (x < array.length - 1) {
        if (array[x + 1][y] >= array[x][y])
          result.add(new Coords(x + 1, y));
     }
     if (x > 0) {
        if (array[x - 1][y] >= array[x][y])
          result.add(new Coords(x - 1, y));
     }
     if (y < array[x].length - 1) {
        if (array[x][y + 1] >= array[x][y])
          result.add(new Coords(x, y + 1));
     }
     if (y > 0) {
        if (array[x][y - 1] >= array[x][y])
          result.add(new Coords(x, y - 1));
     }
     if (x < (array.length - 1 ) &&  (y < array[x].length - 1)) {
        if (array[x + 1][y + 1] >= array[x][y])
          result.add(new Coords(x + 1, y + 1));
     }
     if (x < (array.length - 1 ) &&  (y > 0)) {
        if (array[x + 1][y - 1] >= array[x][y])
          result.add(new Coords(x + 1, y - 1));
     }
     if (x > 0 &&  (y < array[x].length - 1)) {
        if (array[x - 1][y + 1] >= array[x][y])
          result.add(new Coords(x - 1, y + 1));
     }
     if (x > 0 &&  y > 0) {
        if (array[x -1][y - 1] >= array[x][y])
          result.add(new Coords(x - 1, y - 1));
     }
     return result;
  }
  void checkNode(Vector<Integer> path, Coords coords) {
    path.add(array[coords.x][coords.y]);
    Vector<Coords> neighbors = getNeighbors(coords);
    if (neighbors.size() == 0) {
       for (Integer i : path) {
         System.out.print(i+"\t");
       }
       System.out.println();
    }
    for (Coords c : neighbors) {
      Vector<Integer> newpath = (Vector<Integer>) path.clone();
      checkNode(newpath, c);
    }
  }
  Main() {
    System.out.println ("Array: " + Arrays.deepToString(array));
    checkNode(new Vector<Integer>(),new Coords(0,0));
  }

  public static void main(String args[]) {
    new Main();
  }
} 
```

输出：

```
Array: [[3, 5, 1], [6, 7, 4], [8, 2, 9]]
3   6   8   
3   6   7   9   
3   6   7   8   
3   5   7   9   
3   5   7   8   
3   5   6   8   
3   5   6   7   9   
3   5   6   7   8   
3   7   9   
3   7   8 
```

它还为我提供了路径 3、6、8，这不在您的示例输出中

# objective-c - MonoMac/Cocoa 全屏应用

> ID：14714401
> 
> 赞同：2
> 
> 时间：2013-02-05T18:32:08.683
> 
> 标签：objective-c, cocoa, fullscreen, monomac

我正在尝试通过在 NSWindow 的 ContentView 上使用 EnterFullScreenModeWithOptions 来全屏显示 MonoMac/Cocoa 应用程序。以下效果很好：

```
Window.ContentView.EnterFullscreenModeWithOptions(NSScreen.MainScreen, new NSDictionary()); 
```

但是，我想在选项字典中进行一些特定的更改，因此我尝试使用这些更改创建一个 NSDictionary：

```
var keys = new NSObject [] {
    NSView.NSFullScreenModeWindowLevel
};

var values = new NSObject [] {
    NSObject.FromObject(NSWindowLevel.Normal)
};

var dict = NSDictionary.FromObjectsAndKeys(values, keys); 
```

这只是给出了一个黑屏，而不是视图中的内容。结果与以下 Objective-C 相同：

```
NSDictionary* options = [NSDictionary
                         dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithInt:kCGNormalWindowLevel],
                         NSFullScreenModeWindowLevel, nil];

[test.contentView enterFullScreenMode:[NSScreen mainScreen]
                   withOptions:options]; 
```

我的总体目标是尝试允许启动外部应用程序，而我的应用程序在后台继续全屏显示，并且不出现停靠栏或菜单栏。这条路能走吗？

# javascript - 来自asp经典中提交值的IE中的“NaN”错误

> ID：14714402
> 
> 赞同：0
> 
> 时间：2013-02-05T18:32:11.183
> 
> 标签：javascript, internet-explorer, asp-classic, nan

我有一个小脚本可以刷新 div 标签内的页面。有一个与 url 一起发送的值（数组中的最大数）。

```
<script type="text/javascript">
    function refreshmydiv() {
var v=[<%=portos %>]
var porto=parseInt((Math.max.apply(0,v)), 10)
        new Ajax.Request('shop/wk.asp?varp=' + porto, {
            method: 'post' ,
            onSuccess: function(request) {
                $('Container').update(request.responseText);
            }
        });
    }
</script> 
```

Firefox 没有任何问题地打开文件 wk.asp 并使用它应该做的值。...格式化，计算，等等...例如：

```
<% porto = int(request.querystring("varp")) %>
<%= Formatnumber(porto,2,0,0,-1)%> 
```

只要我尝试用它做一些数字，Internet Explorer 就会给我一个“NaN”错误。

有什么方法可以传输 IE 也播放的这个数字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:03:17.617

谢谢bfavaretto！
IE 不喜欢 Math.max.apply(0,arr) 稍后用作数值。
为了找到数组中的最高数字，我使用了 RobG 从[我的另一个问题](https://stackoverflow.com/questions/14697693/find-2nd-highest-value-in-array-during-loop-in-asp-classic-with-java)中的解决方案。再次感谢他。NaN 解决了​​:)

# charts - ExtJS/Raphael 可以使用十字准线散点图吗？

> ID：14714405
> 
> 赞同：0
> 
> 时间：2013-02-05T18:32:17.940
> 
> 标签：charts, extjs4, graphael

我想创建一个散点图并使用十字准线，如下所示：

![在此处输入图像描述](../Images/d3c7572c44e17e7bf8d6070486f13434.png)

是否可以将y轴向右移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T15:01:10.993

Ext.chart.Chart 是一个 Ext.draw.Component，因此可以在存储加载事件时以这种方式将精灵添加到其表面

```
var chart = this.down('chart');
var vlinesprite = { /* vertical line sprite config */ },
    hlinesprite = { /* horizontal line sprite config */ };
chart.surface.add([vlinesprite, hlinesprite]); 
```

现在你必须准备精灵来画线。我想这将是路径精灵。

# javascript - JQuery - 加载外部文本文件

> ID：14714412
> 
> 赞同：0
> 
> 时间：2013-02-05T18:32:36.613
> 
> 标签：javascript, jquery, html

我希望在选择选项卡时将外部文本文件的内容加载到 div 中，但它似乎没有加载内容。问题是什么？

HTML：

```
<!DOCTYPE html> 
<html lang="en"> 
  <head> 
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="CSS/common.css" />
    <script src="JS/common.js"></script>
    <title></title> 
  </head>
  <body>
    <nav>
      <ul id="tabs">
        <li><a href="#" id="tab1" name="#tab1">Home</a></li>
        <li><a href="#" id="tab2" name="#tab2">History</a></li>
        <li><a href="#" id="tab3" name="#tab3">Specifications</a></li>
        <li><a href="#" id="tab4" name="#tab4">Gallery</a></li>    
      </ul>
    </nav>
    <div id="content">
      <div id="tabContent1"></div>
      <div id="tabContent2"></div>
      <div id="tabContent3"></div>
      <div id="tabContent4"></div>
    </div>
  </body>
</html> 
```

外部 JS（common.js）：

```
$(document).ready(function() {
  $("#tab1").click(function() {
    $("#tabContent1").load("test.txt");
  });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:37:41.213

您的语法似乎正确

确保文件的 Url 正确
确保 test.txt 包含某些内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:50:56.963

你有这样的代码：

```
 $("#tab1").click(function() {
    $("#tabContent1").load("test.txt");
  }); 
```

但是有一条线

```
 $("#tabs li:first a").attr("id", "current"); // Activate first tab 
```

它将其 id 从更改`#tab1`为`#current`，因此您需要像这样更新您的代码：

```
 $("#current").click(function() {
    $("#tabContent1").load("test.txt");
  }); 
```

或者，更好的是，添加当前类而不是更改 id：

```
$("#tabs li:first a").addClass("current") 
```

# java - 为什么我的 Cassandra 节点卡在 MutationStage 增加？

> ID：14714413
> 
> 赞同：14
> 
> 时间：2013-02-05T18:32:50.753
> 
> 标签：java, performance, optimization, cassandra, deadlock

我正在使用 Cassandra 来存储图片。我们目前正在从旧系统中大规模迁移图片。一切都工作了一段时间，但最终我们会`TimedOutException`在保存时得到一个，我认为这是因为工作队列已满。

但是，在等待（几个小时）完成后，情况仍然如此（停止迁移后它不会自行恢复）

似乎只有 1 个节点有问题，其`tpstats`命令显示以下数据

![卡桑德拉 tpstats](../Images/c3021b322efd016eaf5f0e8892484105.png)

即使我们在几小时前停止了插入，未决的 MutationStage 操作仍在增加。

这到底是什么意思呢？什么是突变阶段？

我可以检查什么，看看为什么这么长时间后它没有稳定下来？环中的所有其他服务器都处于 0 未决操作。

我们尝试的任何新插入都会引发`TimedOutException`... 异常。

这是响铃信息以防万一

![在此处输入图像描述](../Images/4e47be9ba7663c3679463cde6c606712.png)
（有问题的节点是第一个）

**编辑**：日志中的最后几行如下

```
INFO [OptionalTasks:1] 2013-02-05 10:12:59,140 MeteredFlusher.java (line 62) flushing high-traffic column family CFS(Keyspace='pics_persistent', ColumnFamily='master') (estimated 92972117 bytes)  
INFO [OptionalTasks:1] 2013-02-05 10:12:59,141 ColumnFamilyStore.java (line 643) Enqueuing flush of Memtable-master@916497516(74377694/92972117 serialized/live bytes, 141 ops)
INFO [OptionalTasks:1] 2013-02-05 10:14:49,205 MeteredFlusher.java (line 62) flushing high-traffic column family CFS(Keyspace='pics_persistent', ColumnFamily='master') (estimated 80689206 bytes)
INFO [OptionalTasks:1] 2013-02-05 10:14:49,207 ColumnFamilyStore.java (line 643) Enqueuing flush of Memtable-master@800272493(64551365/80689206 serialized/live bytes, 113 ops)
WARN [MemoryMeter:1] 2013-02-05 10:16:10,662 Memtable.java (line 197) setting live ratio to minimum of 1.0 instead of 0.0015255633589225548
INFO [MemoryMeter:1] 2013-02-05 10:16:10,663 Memtable.java (line 213) CFS(Keyspace='pics_persistent', ColumnFamily='master') liveRatio is 1.0 (just-counted was 1.0).  calculation took 38ms for 86 columns
INFO [OptionalTasks:1] 2013-02-05 10:16:33,267 MeteredFlusher.java (line 62) flushing high-traffic column family CFS(Keyspace='pics_persistent', ColumnFamily='master') (estimated 71029403 bytes)
INFO [OptionalTasks:1] 2013-02-05 10:16:33,269 ColumnFamilyStore.java (line 643) Enqueuing flush of Memtable-master@143498560(56823523/71029403 serialized/live bytes, 108 ops)
INFO [ScheduledTasks:1] 2013-02-05 11:36:27,798 GCInspector.java (line 122) GC for ParNew: 243 ms for 1 collections, 1917768456 used; max is 3107979264
INFO [ScheduledTasks:1] 2013-02-05 13:00:54,090 GCInspector.java (line 122) GC for ParNew: 327 ms for 1 collections, 1966976760 used; max is 3107979264 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-20T14:02:54.703

我猜你只是用写来超载你的一个节点 - 即你写得比它能够消化的快。如果你的文章很大，这很容易。

即使在您停止写入集群后，MutationStage 仍在增加，因为其他节点仍在处理排队的突变请求*并将副本发送到此过载节点*。

我不知道为什么其中一个节点会过载，因为可能有几个原因：

*   节点比其他节点慢（不同的硬件或不同的配置）
*   集群未正确平衡（但是，nodetool ring 输出的开头表明情况并非如此）
*   您将所有写入定向到此特定节点，而不是将它们平均分配到所有节点，例如通过循环
*   您配置了太大的内存表总大小限制/或缓存大小，总堆空间太小，并且您的节点正在与 GC 作斗争，而恰好这个节点是第一个陷入 GC 死亡螺旋的节点

# ember.js - 使用 {{action}} 在不同的路由中定位事件

> ID：14714414
> 
> 赞同：3
> 
> 时间：2013-02-05T18:32:53.680
> 
> 标签：ember.js, handlebars.js

假设我有一条带有类似事件的路线

```
App.FooRoute = Ember.Route.extend({
  events: {
    anAction: function(){
    }
  }
}) 
```

如何从另一个路由/控制器的角度触发它？

```
<a {{action anAction target='???'}}> a link </a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T18:07:02.203

假设您有这样的路线：

```
App.Router
  |
  + FooRoute
  |
  + BarRoute 
```

`FooRoute`将动作从 发送到意味着什么`BarRoute`？用户已前往`/foo`，因此`FooModel`、`FooController`和`FooView`已初始化，但尚未初始化`Bar*`。行动会做什么？

### 案例 1：Action 操作 Bar

在这种情况下，有一个`BarModel`around 是`FooRoute`. 解决这个问题的最类似于 Ember 的方法是使用嵌套路由：

```
App.Router.map(function() {
  this.resource('bar', function() {
    this.route('foo');
  }
}); 
```

用户去`/bars/123/foo`并点击链接，触发`anAction`. Ember 会自动将该动作冒泡到路由层次结构中，因此您可以简单地定义`anAction`on `BarRoute`。

### 案例2：行动不需要酒吧

在这种情况下，`BarModel`不需要 a。`anAction`做一些不是真正`Foo`相关的事情，但也不是`Bar`相关的。我们可以使用相同的冒泡技巧，但不是定义`anAction`on `BarRoute`，而是在主路由器上定义它。

### 案例 3：动作需要一个全局对象

假设该操作需要“当前用户”。这种情况很像＃2，因为您不需要嵌套路由。但是，它确实需要您拥有一个可全局寻址的控制器，例如`App.currentUserController`. 您可以直接将其指定`target`为`{{action}}`.

### 案例 4：你*真的*想定位 BarController

如果上述选项似乎都不正确，您可以使用`controllerFor`在 上设置`barController`属性`fooController`：

```
App.FooRoute = Ember.Route.extend({
  setupController: function(controller) {
    var barController = this.controllerFor('bar');
    controller.set('barController', barController);
  }
}); 
```

然后你可以做`{{action anAction target=barController}}`。

### 概括

Ember 将自动尝试对控制器执行该操作，然后冒泡路由层次结构。如果模型依赖于其他模型，您可能需要嵌套路由或全局控制器来确保连接您的先决条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-05T17:01:10.133

正如[Ember Docs](http://emberjs.com/api/classes/Ember.ViewTargetActionSupport.html#property_target)中所解释的，您可以使用名为 Ember.ViewTargetActionSupport 的内置 mixin 将操作发送到应用程序中的不同控制器或视图或路由。

处理您的问题的简单方法如下：

1.  模板中调用的事件在当前视图中处理
2.  这个视图混合了 Em.ViewTargetActionSupport
3.  这个事件，写在你的视图中，调用 this.triggerAction 函数，指定你试图在不同的视图/控制器/路由（目标）中调用的操作

当前模板：

```
<a {{action 'actionInView' target='view'}}>Click me</a> 
```

风景：

```
App.CurrentView = Em.View.extend(Em.ViewTargetActionSupport, { // Note the mixin
  actions: { // Actions hash
    actionInView: {
      this.triggerAction({ // Without a target this will bubble through the routes
        action: 'theActionToCall', // Name of the action you *actually* want to call
        target: App.TargetController, // Or whatever the name of your target is
      });
    },
  },
}); 
```

目标控制器：

```
App.TargetController = Em.ObjectController.extend({
  actions: {
    theActionToCall: {
      // This is where you do the action stuff that you *actually* are trying to do
    },
  },
}); 
```

本质上，名为 actionInView 的操作除了调用您真正想要但无法访问的操作之外什么都不做，因为它位于应用程序的不同部分。如果您没有指定目标，那么您可以将操作放在父路由或应用程序路由上，它将被调用。

# java - 如何在edittext中放置图像？

> ID：14714415
> 
> 赞同：3
> 
> 时间：2013-02-05T18:32:58.577
> 
> 标签：java, android

我想在我的应用程序中放置实现搜索，因为我需要制作一个搜索栏，就像我们在文本字段末尾的谷歌栏图像中看到的那样。我尝试使用 FrameLayout 并放置 EditText 和图像，但它不起作用..我该如何制作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:34:20.837

只需使用 RelativeLayout 在 EditText 顶部放置一个小的 ImageView。不要忘记调整 EditText 的填充，使文本不会出现在 ImageView 下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:36:53.640

在您的 EditText 中使用它

```
android:drawableRight="@drawable/search" 
```

这会将图像放在您的 EditText 中..我希望这会对您有所帮助..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:44:19.787

以编程方式您可以做到这一点。

```
EditText editText = findViewById(R.id.myEditText);

// Set drawables for left, top, right, and bottom - send 0 for nothing
editTxt.setCompoundDrawablesWithIntrinsicBounds(0, 0, R.drawable.myDrawable, 0); 
```

或者也

```
android:drawableRight="@drawable/search" 
```

正如普拉尼亚尼所建议的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T18:38:33.647

我认为解决这个问题的最好方法是使用行动项目。在 Android 操作栏上查看此[链接。](http://developer.android.com/guide/topics/ui/actionbar.html)

将搜索视图添加到操作栏中非常简单：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/menu_search"
          android:title="@string/menu_search"
          android:icon="@drawable/ic_menu_search"
          android:showAsAction="ifRoom|collapseActionView"
          android:actionViewClass="android.widget.SearchView" />
</menu> 
```

正如上面提到的链接中所解释的，这里是如何访问它：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.options, menu);
    SearchView searchView = (SearchView) menu.findItem(R.id.menu_search).getActionView();
    // Configure the search info and add any event listeners
    ...
    return super.onCreateOptionsMenu(menu);
} 
```

# javascript - 强制请求到不同域上的 URL

> ID：14714416
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:12.870
> 
> 标签：javascript, jquery

当用户单击链接以使会话在该域上保持活动状态时，我需要向不同域上的页面发出请求。我不关心响应数据（状态码除外，因此*我*可以确保页面没有关闭）。我尝试通过发出请求，`$.ajax`但同源策略不允许它。

使请求通过的最佳方式是什么？

我应该在我的页面上写一个 iframe 吗？脚本标签？有没有`$.ajax`可以让它工作的选项？

**编辑：**我还需要知道请求何时通过，以便之后我可以做一些事情（即，我想要一个回调）。

* * *

添加`dataType: 'jsonp'`某种使其工作，除了我不希望它执行站点返回的任何内容，这似乎是这样做的。我请求的页面是一个普通的旧 HTML 页面，但它会在他们的服务器上触发一些东西，使会话保持活动状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:12:50.713

您可以使用图像“类”发送请求：

```
var img = new Image();
img.onerror = img.onload = function() { console.log('Sended') }
img.src = "http://google.com?hey=google&rnd=" + Math.random() // random is used to prevent caching 
```

但除非响应不是图片，否则您将无法获得有关资源可用性的任何信息。

另外，我不确定这个解决方案是否是跨浏览器的。它似乎在最近的 Opera 和 Chrome 中工作，但我还没有在任何其他浏览器中测试过它。

顺便说一句，这种图像方法似乎是唯一安全的方法。如果您包含脚本或加载 iframe，它们可能会对您的页面造成不良影响，而简单的图像则保持无害。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:09:57.517

这似乎有效：

```
$('#myelement').on('click',function() {
    $('<iframe>', {src:'http://otherdomain.com/page'}).hide().load(function() {
        $(this).remove(); //clean up the DOM
        // do stuff
    }).appendTo('body');
}); 
```

# php - 在php中从url获取参数会添加特殊字符

> ID：14714417
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:23.753
> 
> 标签：php, url, parameters, character, add

我有一个 JavaScript 代码，它调用 PHP api 的函数在我的数据库中插入一行。

```
var url = 'http://myapi/OfertasVentaOnline/api.php?method=update&function=categoria&id='+id+'&idCategoria='+id_categoria+'&descripcion='+descripcion+'&format=json';

    $.getJSON(url, function (data){     

    }); 
```

此网址的示例：

```
"http://myapi/OfertasVentaOnline/api.php?method=create&function=categoria&id=9999&idCategoria=3&descripcion=test%new%category&format=json" 
```

在 url 中，我替换了描述参数中 % 的空格，如此处所示，url 已正确创建。

然后我得到了我的 api，他接到电话并对其进行解码。在我用来解码和获取参数的函数中：

```
$descripcion_cool = str_replace("%"," ",$_GET['descripcion']);

echo utf8_decode($descripcion_cool);

$query = 'INSERT INTO `Categorias`(`idCamping`, `idCategoria`, `descripcion`) VALUES (
                    "'.mysql_real_escape_string($_GET['id']).'",
                    "'.mysql_real_escape_string($_GET['idCategoria']).'",
                    "'.mysql_real_escape_string($descripcion_cool).'")'; 
```

这输出：

```
test new?tegoryINSERT INTO `Categorias`(`idCamping`, `idCategoria`, `descripcion`) VALUES (
                    "9999",
                    "3",
                    "test new�tegory")null 
```

如您所见，php 在 url 参数中添加了一些特殊字符。我在做什么错？谢谢

PD：在我的 php 文件中，我尝试添加：

```
header('Content-type: text/plain; charset=utf-8'); 
```

但它一直在做同样的事情。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:46:23.647

假设您发送的参数值包含空格，您通过将空格替换为`%`. 实际上，您不必这样做。`encodeURIComponent()`如果要对传递的参数/查询进行编码，可以使用方法。如果你想编码 url，那么使用`encodeURI()`

```
 description = encodeURIComponent(description);

var url = 'http://myapi/OfertasVentaOnline/api.php?method=update&function=categoria&id='+id+'&idCategoria='+id_categoria+'&descripcion='+descripcion+'&format=json';

    $.getJSON(url, function (data){     

    }); 
```

这将安全地对 url 进行编码。

# regex - 正则表达式匹配最外层模式

> ID：14714421
> 
> 赞同：1
> 
> 时间：2013-02-05T18:33:29.063
> 
> 标签：regex

我想知道匹配里面所有东西的正则表达式`{}`。字符串可能包含嵌套的`{}`; 我不在乎他们。

示例字符串：`{Don't} trust me. I'm a {very very {evil}} good guy.`

我希望结果是`Don't`and `very very {evil}`。

我目前拥有的唯一正则表达式是`/{\w+}/`仅捕获`evil`. `Dont`如果它没有撇号，它也会返回。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:43:02.853

由于您有嵌套的大括号，因此提取大括号之间部分的正则表达式不像： - 那样直接`\{.+?\}`。`}`这个正则表达式将在它找到的第一个位置停止。因此，对于嵌套大括号，它不会表现得很好。为此，您需要一个稍微复杂的正则表达式。但是，我建议不要将 Regex 用于此类问题。正则表达式不足以考虑匹配括号对。他们只能解析常规语言。对于任何高于此的内容，您应该编写自己的解析器。

话虽这么说，你可以试试这个正则表达式： -

```
"/\{((?:[^{}]*\{[^{}]*\})*[^{}]*?)\}/" 
```

并得到`group 1`. 这将考虑您的嵌套大括号，前提是它们是平衡的。而且您没有大括号作为实际字符串的一部分。

* * *

除了上述解决方案之外，您还可以查看此示例解析器，它适用于您的特定情况。事实上，这应该适用于任何形式的嵌套大括号，只要你有平衡的大括号： -

```
String str = "{Don't} trust me. I'm a {very very {evil}} good guy.";

List<String> words = new ArrayList<>();
int openCount = 0;

StringBuilder builder = new StringBuilder();

for (int i = 0; i < str.length(); i++) {
    char ch = str.charAt(i);

    if (ch == '{') {
        if (openCount == 1) {
            builder.append(ch);
        }
        openCount += 1;

    } else if (ch == '}') {

        if (openCount > 1) {
            openCount--;
            builder.append(ch);

        } else {
            words.add(builder.toString());
            openCount--;
            builder = new StringBuilder();
        }

    } else {
        if (openCount >= 1) {
            builder.append(ch);
        }
    }
}

System.out.println(words); 
```

**输出： -**

```
[Don't, very very {evil}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T06:53:22.950

@Rohit 是正确的。

如果您使用 js 或 java，并且没有嵌套括号的深度，则必须编写自己的解析器。

但是如果你使用C#或perl，你可以使用“平衡组”来实现，这是一个高级的正则表达式功能，js不支持。:(

# javascript - 使用 jQuery 存储来自单选按钮输入的数值

> ID：14714424
> 
> 赞同：1
> 
> 时间：2013-02-05T18:33:36.693
> 
> 标签：javascript, jquery, html, forms, radio-button

我正在做一个`HTML5`测验，我使用单选按钮`yes`或`no`问题，然后为每个单选按钮分配一个值`0`or `1`，然后将数值存储为变量，然后将所有变量加在一起以对测验进行评分。

**更新！！！**

嘿！我进行了您建议的更改，但是当我调用变量时，它仍然显示为未定义：

这是我的html：

```
<form class="answer" id="question_one">
  <input type="radio" class="styled" name="first_answer" value="1"/><!-- POSITIVE ANSWER -->
  <div class="answer_text">Yes</div>
  <input type="radio" class="styled" name="first_answer" value="0" /><!-- NEGATIVE ANSWER -->
  <div class="answer_text">No</div>
</form> 
```

这是我的 JavaScript：

```
$('#question_one input:radio[name=first_answer]').on('change', function () {
var first_question = parseInt(
    $("input[name=first_answer]:checked").val()
    ); 
```

}); 我试图通过仅针对 name=first_asnwer 的单选按钮来为 jQuery 对象包含更多的特殊性。也许我搞砸了？

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:59:46.830

我认为您的问题是对`$(document).ready()`功能的理解。一旦加载了页面的所有依赖项 - CSS、JavaScript 等，就会执行此函数...

执行此函数后，您已经设置了变量，这可能在您单击第一个单选按钮之前！这里的解决方案是仅在用户完成回答后计算值。可能在无线电元素的更改事件上 -

```
$(document).ready(function () {
  $('input:radio').on('change',function(){
    var $first_question = parseInt($("input[name=first_answer]:checked").val());
    var $second_question = parseInt($("input[name=second_answer]:checked").val());
    $first_question = $first_question? $first_question : 0; 
    $second_question = $second_question? $second_question : 0;
    var $total_score = $first_question + $second_question;
    alert($total_score);
  });
}); 
```

### [这是一个简单的演示](http://jsfiddle.net/ETNDw/)

# javascript - ember 适配器问题

> ID：14714429
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:43.083
> 
> 标签：javascript, recursion, ember.js, ember-data

我已经设置了一个[jsFiddle](http://jsfiddle.net/Ahnrs/)来演示我在尝试学习 Ember.js 时遇到的问题

我有这些模型：

```
App.User = DS.Model.extend({
    firstName: DS.attr('string'),
    lastName: DS.attr('string'),
    account: DS.belongsTo('App.Account')
});

App.Account = DS.Model.extend({
    user: DS.belongsTo('App.User'),
    transactions: DS.hasMany('App.Transaction'),
    balance: function() {
      return this.get('transactions').getEach('amount').reduce(function(accum, item) {
          return accum + item;
      }, 0);
  }.property('transactions.@each.amount')
});

App.Transaction = DS.Model.extend({
    account: DS.belongsTo('App.Account'),
    amount: DS.attr('number'),
    description: DS.attr('string')
}); 
```

使用 FixtureAdapter，Account 会加载它的 hasMany 事务，但不会加载它的 belongsTo 用户。

使用 RESTAdapter 帐户可以很好地加载它的关系，但是当我尝试删除它时，它会给出错误太多递归。

谁能帮我解决这些问题？谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:05:32.720

我已经解决了您使用 FixtureAdapter 的问题。您的 Account 装置有一个*user_id*属性，而不仅仅是以 id 作为值的*用户。*

```
App.Account.FIXTURES = [
{
    id: 10001,
    user: 1,
    transactions: [1, 2, 3]
}
]; 
```

你可以在这里看到它：http: [//jsfiddle.net/ianpetzer/pGeGw/](http://jsfiddle.net/ianpetzer/pGeGw/)

关于您在使用 RestAdapter 时遇到的递归问题……我很可能是错的……但我认为这是 ember-data 的错误。

请参阅以下链接：

[https://github.com/emberjs/data/issues/671](https://github.com/emberjs/data/issues/671)

[Ember-Data clearRelationships 中的无限循环？](https://stackoverflow.com/questions/14552589/infinite-loop-in-ember-data-clearrelationships)

# visual-studio-2010 - Visual Studio 在当前网站设计视图中加载另一个网站的母版页

> ID：14714432
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:48.717
> 
> 标签：visual-studio-2010, visual-studio, master-pages

所以我有一个包含两个网站的解决方案。这些不是网站项目，只是网站。它们有自己的母版页，它们的名称不同，并且引用的样式表也有不同的名称。无论出于何种原因，两个项目都加载相同的母版页和样式。我尝试切换“设置为启动项目”菜单选项并查看项目和解决方案属性，但在互联网上找不到任何内容。在 Visual Studio 2010 和 Visual Studio 2012 中都会出现此问题。

如果我添加一个新网站、一个新样式表和一个新母版页，它们都具有唯一名称，甚至是具有唯一名称的新 css 类，当切换到新添加的网站中的设计视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T02:25:52.037

因此，在单个解决方案中拥有多个基于文件的网站并不能很好地与 Visual Studio 2010 或 2012 的设计器视图相结合。不过我找到了一个解决方法。我刚刚将网站切换到在 IIS Express 上运行，并且设计器视图停止显示幻像样式、图像等。确保您已安装 Visual Studio 2010 SP1，只需右键单击每个网站并从菜单中选择 IIS Express 选项。

# excel - Excel VBA 宏显示来自后端表的过滤信息

> ID：14714433
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:53.493
> 
> 标签：excel, vba

我正在为我目前正在从事的项目寻求一些帮助。我正在创建一个演示工作表，其中显示了已达到各种状态的部件的数量。即，零件已逾期，零件需要合同，零件带有设计等。总的来说，我有8种不同的状态，单个零件可以根据某些标准处于。我已经创建了切换来指示特定部件所处的状态，并且我使用该切换在我的显示器中显示我的计数。

目前，我已将显示编​​码为根据下拉菜单进行切换，因此数据由我们的工作组更改。我想要做的是创建代码，单击后将查看单击的单元格中的计数，并显示在与之相关的特定部分下方。例如，如果第 1 组在单元格中的计数为 5，状态为“零件符合设计”，我希望将这 5 个特定零件和与它们相关的一些其他数据显示在我在此主显示下方创建的表格中。所有数据都存放在单独的数据表上，所以我只需要知道如何过滤，然后复制我想要的数据的特定部分并重新显示它。

我要在其中显示它的表称为“选择”，目前有 3 个 clomun、ID、Part 和 Bid#。我将从中提取数据的表位于名为 Data 的单独工作表上，最终将对用户隐藏。这里有人可以帮助我吗？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:47:03.773

做到这一点的一种方法是将您的数据全部放在当前的电子表格中 - 并使用过滤来筛选出与您想要的条件相匹配的行。为此，向工作表添加一个隐藏列，并将其公式设置为：

=IF(PArea="- 所有区域路径 -",TRUE,IFERROR(IF(FIND(PArea,[@[Producing Area]])>0,TRUE,FALSE),FALSE))

您的选择器下拉列表应该是一个命名范围（此处为 PArea）。

然后，您可以添加一个运行以下代码的按钮 - 我将该按钮标记为“过滤器” - 以便用户知道选择过滤条件，然后单击过滤器。这将运行如下代码：

```
'Consumer Area
If Range("PArea") = "- ALL AREA PATHS -" Then
    ActiveSheet.ListObjects("Table_Dependenciesl").Range.AutoFilter Field:=22
Else
    ActiveSheet.ListObjects("Table_Dependenciesl").Range.AutoFilter Field:=22, _
        Criteria1:="TRUE"
End If 
```

隐藏列中的单元格（值 = 匹配时为真，不匹配时为空白）和 VBA 代码的组合然后隐藏所有未将过滤器列设置为真的行。在该示例中，文本“-ALL AREA PATHS-”被添加到驱动下拉框@PArea 的下拉范围中-并且单元格公式中的逻辑知道如果选择了所有值，则该值应该为真-否则有以匹配特定的选定值。

autoFilter 命令采用一个或两个参数 - 字段 # 是列 #（从 @ 1 开始），可选条件会导致过滤器设置为我们公式的隐藏列显示“True”的任何位置。省略条件时，将撤消过滤器，并且该列不再有助于过滤的行。注意上面的续行字符 _ - 所以你不会把头发拉出来。

# ruby-on-rails - 无法呈现与 formtastic 的关联

> ID：14714434
> 
> 赞同：0
> 
> 时间：2013-02-05T18:33:54.243
> 
> 标签：ruby-on-rails, ruby, formtastic

我正在构建一个页面来管理一组资源，其中一些资源与“效果”记录有关联。我正在尝试这样做，以便我可以让一个表单模板处理资源上效果记录的存在，但我的条件遇到了一些问题。

某些记录使用此代码效果很好，但某些记录会产生参数不匹配错误。

这是我正在尝试创建的表单的部分内容：

```
<%= semantic_form_for [ :manage, resource ], :html => {:class => 'default-manage-form' } do |f| %>
  <%= f.inputs do %>

    <% attributes.each do |attr| %>
      <%= f.input attr.to_sym %>
    <% end %>

    <% if resource.effects != nil && !resource.effects.empty? %>
      <%= f.inputs :modifier, :name, :value, :for => resource.effects, :name => "Effects" %>
    <% end %>

    <%= f.actions do %>

      <%= f.action :submit %>
    <% end %>
  <% end %>
<% end %> 
```

有些记录（但不是全部）会在我创建效果输入的地方产生此错误：

```
wrong number of arguments (4 for 3) 
```

我怎样才能更正这里的代码，以免崩溃？我对 Rails 也比较陌生，因此感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:06:28.733

我通过使用 responds_to 方法解决了这个问题：

```
<% if resource.respond_to? :effects %>
  <% resource.effects.each do |effect| %>
    <hr>
    <%= f.inputs :modifier, :name, :value, :for => effect %>
  <% end %>
<% end %> 
```

# c - 数组打包的效率：8 位（字节）与 16 位元素？

> ID：14714436
> 
> 赞同：1
> 
> 时间：2013-02-05T18:34:04.457
> 
> 标签：c, memory, avr, 8-bit

我目前正在为 atmel (Atmega328) 的 8 位微控制器编写 c 语言。在程序中，我有一个存储数千个 2 位整数的 8 位数组，因此它位于程序存储空间中。目前，我在每个字节中放置了四个 2 位整数，但现在当我更仔细地考虑它时，它似乎很愚蠢......

使用具有 16 位值的数组并在每个位置存储八个 2 位变量不是更有效吗？

微控制器 (atmega328p) 是一个 8 位 IC，每个机器指令有 16 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:52:59.113

由于这是一个带有 8 位寄存器的 8 位处理器，因此在用汇编语言编程时，它不会改善对 16 位操作数的操作。但是对于 c 编译器来说，事情要复杂得多。编译器绝对有可能将 8 位操作数转换为执行 16 位算术的 16 位操作数，因为对于我所知道的几乎所有编译器，int 大小通常至少为 16 位。

所以拆机才是真正的出路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:39:49.963

怎样才能更有效率？

# 空间效率

2 位整数占用 2 位。您对此无能为力。

# 时间效率

无论您如何打包它们，您仍然需要执行相同数量的按位运算来从较大的值中提取您的 2 位数字。

# javascript - 单击链接时维护主题标签值的干净方法是什么？

> ID：14714441
> 
> 赞同：0
> 
> 时间：2013-02-05T18:34:27.143
> 
> 标签：javascript, jquery, html

我的网站上没有外部链接，所以我正在考虑选择所有锚标签：`$('a')`并将当前标签值附加到所有这些标签的 href 中，但这似乎是一种混乱的方法。有一个更好的方法吗？我网站的 url 看起来像这样：`www.rsadler.com/html/home.html#chairsAndTables`但是当你点击我的任何链接时，url 会更新，很明显，没有标签。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:38:43.960

OP 实际上意味着页面会发生变化，但哈希需要结转到每个后续页面。

```
$('a').each(function(){
    var href=this.href.split('#')[0];
    $(this).attr('href', href + window.location.hash);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:55:06.953

方法一：jQuery

```
$(document).ready(function() {
    $("a").each(function(){ this.src += window.location.hash; });
}); 
```

方法 2：会话 Cookie

```
window.onload = function() { 
    var winHash = window.location.hash;
    var cookieHash = unescape((document.cookie.match(new RegExp('\bhash=(.*?)(?:;|$)','i')) || [null,''])[1]);
    if(winHash == "" && cookieHash.length > 0)
        window.location.hash = cookieHash;
    else if(winHash != "")
        document.cookie = "hash=" + escape(winHash) + "; path=/";
} 
```

**注意**我没有测试上面的JavaScript，所以可能有语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:36:30.790

在链接的单击事件处理程序内的事件上调用[preventDefault将阻止浏览器更新当前 URL。](http://api.jquery.com/event.preventDefault/)

# javascript - 将 html 插入到 contenteditable 中，但在其后添加新文本

> ID：14714446
> 
> 赞同：1
> 
> 时间：2013-02-05T18:34:53.900
> 
> 标签：javascript, jquery, html

我有一个 contenteditable div 和一个添加简单跨度的按钮。

```
<button id="insert-span">Insert</button>
<div id="edit-box" contenteditable="true"></div>
<script>
    $('#insert-span').on('click', function() {
        document.execCommand('insertHTML', null, '<span class="inserted">Hi</span>');
    });
</script> 
```

当我单击按钮时，跨度被正确添加到 div 中，但是当我输入更多文本时，它位于插入的跨度内，所以我最终得到了这个

```
<div id="edit-box" contenteditable="true">
    <span class="inserted">Hi and then all the other text I enter</span>
</div> 
```

有什么方法可以在 span 标签之外开始输入文本，所以我最终会得到这样的结果

```
<div id="edit-box" contenteditable="true">
    <span class="inserted">Hi</span> and then all the other text I enter
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:51:14.053

我不知道你为什么要这样做，但应该这样做：

```
var text = document.createTextNode('your text after the span');
edit_box.appendChild(text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:44:29.023

既然您已经在使用 jQuery，为什么不考虑在这里使用 jquery prepend 方法？

```
$('#insert-span').on('click', function() {     
    $('#edit-box').prepend('<span class="inserted">Hi</span> and then all the other text I enter');
}); 
```

# regex - 将数据拆分为列，同时忽略前导空格。PERL

> ID：14714447
> 
> 赞同：0
> 
> 时间：2013-02-05T18:34:54.593
> 
> 标签：regex, perl, split

这是我的原始数据的片段：

```
 PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND            
     1 root      16   0  2160  604  520 S  0.0  0.1   0:01.60 init               
     2 root      RT  -5     0    0    0 S  0.0  0.0   0:00.00 migration/0        
     3 root      34  19     0    0    0 S  0.0  0.0   0:00.00 ksoftirqd/0        
     4 root      10  -5     0    0    0 S  0.0  0.0   0:00.39 events/0           
     5 root      12  -5     0    0    0 S  0.0  0.0   0:00.00 khelper            
     6 root      14  -5     0    0    0 S  0.0  0.0   0:00.00 kthread            
     9 root      10  -5     0    0    0 S  0.0  0.0   0:00.36 kblockd/0          
    10 root      20  -5     0    0    0 S  0.0  0.0   0:00.00 kacpid             
   174 root      14  -5     0    0    0 S  0.0  0.0   0:00.00 cqueue/0           
   177 root      10  -5     0    0    0 S  0.0  0.0   0:00.00 khubd 
```

请注意左列如何具有前导空格。我想将此数据的每一列拆分为自己的数组。在使用拆分功能时，那个领先的空白给我带来了麻烦。

我正在使用这个：

```
foreach my $line (@data) {
    my @column = split(/\s+/,$line);
    chomp (@column);
    print "$column[0]\n";

} 
```

当我打印所有元素时，我想要发生的`column[0]`是它打印所有没有空格的 PID 编号。当我打印`column[1]`时，它会打印所有没有空格的用户。因为列是正确的，所以一切都搞砸了。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:42:48.717

这是一种非常普遍的需求，以至于特殊的拆分调用`split(' ', ...)`（否则等同于`split(/\s+/, ...)`）会丢弃前导空格。

尾随空格被任何一方丢弃，因此不需要 chomp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:38:45.347

在拆分之前在 $line 处左修剪字符串：

```
#... 
$line =~ s!^\s+!!;
my @column = split(/\s+/,$line);
#... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-01T16:50:46.980

为了添加到 Miguel Prz，我遇到了类似的问题，数组的第一个元素使用*split(/\s+/,$line)*返回了一个空值。这是我使用 grep 使用模式 !/^$/ 过滤空行的解决方案。

```
#... 
my @column = grep {!/^$/} split(/\s+/,$line);
#... 
```

# java - 如何将 Play 框架模型转换为 XML 和 JSON？

> ID：14714455
> 
> 赞同：12
> 
> 时间：2013-02-05T18:35:32.617
> 
> 标签：java, scala, playframework, playframework-2.0

Play 框架是否有将 Play 模型转换为 XML/JSON的本**机**或**推荐方式？**类似于 JAXB 或 Jackson 的东西。

有些人推荐[模板方法](http://coffeebean.loicdescotte.com/2010/05/how-to-write-restxml-api-with-play.html)，但这非常冗长，并且不能保证格式正确的 XML/JSON。

XML 上的[播放文档](http://www.playframework.org/documentation/2.0.4/JavaXmlRequests)仅显示使用字符串连接构建的 XML 响应，如下所示：

```
return ok("<message \"status\"=\"OK\">Hello " + name + "</message>"); 
```

类似地，JSON 上的播放文档显示了一个 JSON 对象一次构建一行。

```
ObjectNode result = Json.newObject();
result.put("status", "OK");
result.put("message", "Hello " + name); 
```

是否有使用 Play 将模型序列化为 XML/JSON的**标准方法？**

有没有关于这个主题的**官方游戏文档？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-11T10:17:29.330

简短回答：[Jackson](http://jackson.codehaus.org/) for **JSON**和[JAXB](http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding) for **XML**

[Play](http://www.playframework.com/documentation/2.0/Home)本身不提供任何关于**编组**模型的文档，但它确实附带了可以完成这项工作的**3rd 方库。**

* * *

**JSON：**

该模型：

```
public class User extends Model {
    public String username;
    public Long   age; 

    @JsonIgnore
    public String password; // field won't be marshalled
} 
```

使用杰克逊的[ObjectMapper.writeValueAsString()](http://jackson.codehaus.org/1.4.2/javadoc/org/codehaus/jackson/map/ObjectMapper.html#writeValueAsString%28java.lang.Object%29)方法将其编组为 JSON。

```
import org.codehaus.jackson.map.ObjectMapper;
//
ObjectMapper mapper     = new ObjectMapper();
String       jsonString = mapper.writeValueAsString(country); 
```

JSON输出：

```
{
    "username" : "John Smith",
    "age"      : "25"
} 
```

* * *

**XML:**

必须小心，因为 Play 如何在后台为其模型[生成 getter 和 setter 。](http://www.playframework.com/documentation/1.0/model)您不会在代码中看到 getter 和 setter，但它们在运行时存在。

在模型上，将[XmlAccessorType](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlAccessType.html)注释设置为[PROPERTY](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlAccessType.html#PROPERTY)很重要。这告诉 JAXB 从**getter/setter**序列化，而不是从**底层字段**序列化。

```
@XmlAccessorType(XmlAccessType.PROPERTY) 
```

我们还必须添加一个[@XmlRootElement](http://jaxb.java.net/nonav/2.2.3/docs/api/javax/xml/bind/annotation/XmlRootElement.html)注释，它指定根 XML 节点的名称：

```
@XmlRootElement(name = "UserRoot") 
```

要省略字段，我们必须将[@XmlTransient](http://jaxb.java.net/jaxb20-ea/docs/api/javax/xml/bind/annotation/XmlTransient.html)注释添加到 getter。由于源代码中没有 getter，我们必须为要省略的每个字段添加一个。

```
@XmlAccessorType(XmlAccessType.PROPERTY)
public class User extends Model {
    public String username;
    public Long   age;

    @JsonIgnore
    public String password;

    @XmlTransient // This means ignore this property
    public String getPassword() {
        return this.password;
    }
} 
```

编组由 JAXB 类[Marshaller](http://docs.oracle.com/javaee/5/api/javax/xml/bind/Marshaller.html)和[JAXBContext执行](http://docs.oracle.com/javaee/5/api/javax/xml/bind/JAXBContext.html)

```
JAXBContext context    = JAXBContext.newInstance(User.class);
Marshaller  marshaller = context.createMarshaller();

// Use linefeeds and indentation in the outputted XML
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);

marshaller.marshal(user, System.out); 
```

**输出：**

```
<UserRoot>
    <name>John Smith</name>
    <age>25</age>
</UserRoot> 
```

* * *

**概括：**

[XML 上](http://www.playframework.com/documentation/2.0/JavaXmlRequests)的[Play 文档和 JSON](http://www.playframework.com/documentation/2.0/JavaJsonRequests)上的Play 文档确实提供了一些有关使用 json/xml 的信息，但似乎没有任何 Play Docs 描述如何进行**Marshalling**。为此，我们必须查看**第 3 方库**和文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:15:29.620

对于 JSON，我建议使用 ... `org.codehaus.jackson`，因为它`play.libs.Json`在`Play 2/x` [@see: Json Doc中可用](http://www.playframework.org/documentation/2.0.4/JavaJsonRequests)

For `XML`- 模板方法足够公平，因为您可以使用视图呈现适当的 XML。

**编辑：**

**Json 和 Ebean**

遗憾的是，Ebean 在将其对象序列化为 JSON 时存在问题，因此我总是使用专用的内部类（在目标模型中，它只包含应该在 Json 中发送的字段），即`User`模型：

```
public static class ForJson {
    public Long id;
    public String name;
    public String email;

    public ForJson(User user) {
        this.id = user.id;
        this.name = user.name;
        this.email=user.email;
    }
} 
```

路线：

```
GET     /users/all.json            controllers.Application.listUsersJson
GET     /users/all-details.json    controllers.Application.listUsersJsonWithDetails
GET     /users/:id.json            controllers.Application.singleUserJson(id: Long) 
```

行动：

```
public static Result listUsersJson() {
    List<User.ForJson> usersToJson = new ArrayList<>();
    for (User user : User.find.all()) {
        usersToJson.add(new User.ForJson(user));
    }
    return ok(Json.toJson(usersToJson));
}

public static Result singleUserJson(Long id) {
    User.ForJson userForJson = new User.ForJson(User.find.byId(id));
    return ok(Json.toJson(userForJson));
}

public static Result listUsersJsonWithDetails() {
    Map<String, Object> details = new LinkedHashMap<>();

    List<User.ForJson> usersToJson = new ArrayList<>();
    for (User user : User.find.all()) {
        usersToJson.add(new User.ForJson(user));
    }

    details.put("date", new Date());
    details.put("count", usersToJson.size());
    details.put("users", usersToJson);

    return ok(Json.toJson(details));
} 
```

*是的，我知道这可能是冗余编码，但我至少总是有正确的 JSON 输出，而且我不需要在每个操作中逐行创建 JSON。*.

**XML:**

HTML 字符不会破坏正确的 XML 渲染，因为默认情况下 Play 的模板会转义它们，因此它将在XML 节点内使用,代替`<`, ：`>``"``&lt;``&gt``&quot;`

```
<sample>Say &quot;ellou&quot;<sample> 
```

检查[模板文档中的转义段落](http://www.playframework.com/documentation/2.0.4/JavaTemplates)（页面底部）。

更重要的是，您可以使用部分模板 -[标记](http://www.playframework.com/documentation/2.0.4/JavaTemplateUseCases)来确保单个项目在两者中的格式完全相同：`users/1.xml`和`users/all.xml`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-26T05:46:42.070

JSON转换有更好的方法。

```
User user = new User("...");
String jsonString = Ebean.json().toJson(user); 
```

# python - 计算列表中相邻余弦值之间的差异

> ID：14714466
> 
> 赞同：1
> 
> 时间：2013-02-05T18:36:15.830
> 
> 标签：python

我想找出值 1 到 10 的差余弦函数值。所以：

```
import math
import sys
import string
import os

for n in range (1,11): 
        x = math.cos (n)
        print x 
```

这个简单的脚本打印 n = 1 到 10 的余弦值现在我需要确定各个值之间的差异，并从 n = 2 的值和 n = 1 的值中获取它然后获取 n = 的值3 和 n =2 所以：

```
Math.cos (2) - Math.cos (1)

Math.cos (3) - Math.cos (2)

Math.cos (4) - Math.cos (3)

.

.

Math.cos (10) - Math.cos (9) 
```

最后

```
Math.cos (10) - Math.cos (1) 
```

然后我想把这些值加起来......但我可能已经把它们放在一起了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:44:29.417

未经测试：

```
import math

cosines = map(math.cos, xrange(1, 11))
cosines.append(cosines[0])

from operator import sub
print map(sub, cosines[1:], cosines[:-1]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:41:02.320

我可能会做类似的事情：

```
for x,y in zip(range(2,11)+[10],range(1,10)+[1]):
    print math.cos(x) - math.cos(y) 
```

当然，这只适用于`range`返回列表的python2.x。为了解决这个问题，您可以使用`itertools.chain`. 即： `range(2,11)+[10]`变成`chain(range(2,11),[10])`. 这里要学习的关键功能是[`zip`](http://docs.python.org/2/library/functions.html#zip)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:59:38.337

```
from math import cos

cosines = [cos(i) for i in range(1,11)]

print [b-a for a,b in zip(cosines, cosines[1:]+cosines[0])] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T18:41:04.520

您可以一起使用多个`for`循环，如下所示：

```
for x in range(1, 11):
    for y in range(1, 11):
        print("x is %s, y is %s" % (x, y)) 
```

# php - 正则表达式括号表达式排除字符串

> ID：14714468
> 
> 赞同：-1
> 
> 时间：2013-02-05T18:36:20.740
> 
> 标签：php, regex

我正在尝试使用正则表达式查找字符串的子字符串。我的字符串是：

```
<p><a class="twitter-share-button" RANDOM STUFF HERE </script> 
```

我知道随机内容中没有脚本标签，所以我制作了一个如下所示的正则表达式：

```
<p><a class="twitter-share-button"[^</script>]* 
```

但`[^</script>]`排除所有字符：`<`, `/`, `s`, `c`, `r`, `i`, `p`, `t`,`>` 我如何告诉正则表达式继续搜索，直到找到结束脚本标记的出现？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:38:32.653

取决于引擎，但您可以进行不贪婪的匹配：

```
<p><a class="twitter-share-button"(.*?)</script> 
```

使`?`不`*`贪心，因此它将匹配所有内容，直到第一个`</script>`。

# android - 在android中连接2个图像

> ID：14714470
> 
> 赞同：11
> 
> 时间：2013-02-05T18:36:36.200
> 
> 标签：android

我想在android中连接2个图像。例子，

![在此处输入图像描述](../Images/adb98b441f06d46c26a71591de25f6d2.png)

![在此处输入图像描述](../Images/df5c52d1a5c535c650dfca2b6452a270.png)

我希望他们是这样的， ![在此处输入图像描述](../Images/48501b23cfbd5107af995d37ce5da0f1.png)

我已经通过硬编码完成了。首先我找到绿色图像的左上角，然后找到绿色边的最左下角。我使用触摸事件的 event.gerRawX() 和 event.getRawY() 参数来完成。现在我知道这两点之间的 x 和 y 距离。我也为红色做类似的事情。现在，当绿色块靠近红色时，我只计算红色块的左上点是否靠近绿色块的左下角。如果是这样，我将绿色的/红色的一个翻译成另一个。但是对于相同尺寸的平板电脑或具有不同分辨率的手机，这种硬编码计算应该会失败。我只想知道如何概括解决方案。谢谢。

编辑：我尝试连接两个图像的 GameActivity 和 ImageInfo 类。我实际上有 6 个这样的图像。我想要连接它们。像图像 1 将连接到图像 2 和图像 2 到 3，依此类推。

游戏活动类

```
package com.example.JigSawPuzzle;

import com.example.test.R;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.Dialog;
import android.content.Context;    
import android.content.DialogInterface;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.res.Configuration;
import android.graphics.Point;
import android.media.AudioManager;
import android.media.SoundPool;
import android.os.Bundle;
import android.util.DisplayMetrics;
import android.util.Log;
import android.view.Display;
import android.view.MotionEvent;
import android.view.Surface;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.View.OnTouchListener;
import android.view.ViewGroup.LayoutParams;

import android.widget.Button;
import android.widget.ImageView;
import android.widget.RelativeLayout;
import android.widget.Toast;

@SuppressLint("NewApi")
public class GameActivity extends Activity implements OnTouchListener
{
static double screenInches;
int touchStartX = 0;
int touchStartY = 0;

int diffX = 0;
int diffY = 0;
int attachedPieces=0;
int imageX = 0;
int imageY = 0;
int height,width;
boolean [] flag = new boolean[7];
boolean isPortait;
RelativeLayout relataivelayoutLayout;
RelativeLayout.LayoutParams paramsA,paramsB,paramsC,paramsD,paramsE,paramsF;
ImageView imageA,imageB,imageC,imageD,imageE,imageF;
ImageInfo [] imageInfoArray = new ImageInfo[7];

// added for sound effect
private SoundPool soundPool;
private int correctPieceAttachSoundId,gameFinishSoundId;
private boolean loaded = false;

//for 10inch landscape height = 752, width = 1280; portrait height = 1232 width = 800

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    isPortait = (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) ?  false : true;
    Display display = getWindowManager().getDefaultDisplay();
    height = display.getHeight();
    width = display.getWidth();     

    imageA = new ImageView(this);
    imageB = new ImageView(this);
    imageC = new ImageView(this);
    imageD = new ImageView(this);
    imageE = new ImageView(this);
    imageF = new ImageView(this);

    DisplayMetrics dm = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(dm);
    double x = Math.pow(dm.widthPixels/dm.xdpi,2);
    double y = Math.pow(dm.heightPixels/dm.ydpi,2);
    screenInches = Math.sqrt(x+y);

    if(screenInches>9.0)
    {

        imageA.setBackgroundResource(R.drawable.a); 
        imageB.setBackgroundResource(R.drawable.b);
        imageC.setBackgroundResource(R.drawable.c);
        imageD.setBackgroundResource(R.drawable.d);
        imageE.setBackgroundResource(R.drawable.e);
        imageF.setBackgroundResource(R.drawable.f);
    }
    else
    {
        imageA.setBackgroundResource(R.drawable.aa);    
        imageB.setBackgroundResource(R.drawable.bb);
        imageC.setBackgroundResource(R.drawable.cc);
        imageD.setBackgroundResource(R.drawable.dd);
        imageE.setBackgroundResource(R.drawable.ee);
        imageF.setBackgroundResource(R.drawable.ff);
    }

    imageA.setId(1);
    imageA.setTag("a");
    paramsA = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)                
    imageA.setLayoutParams(paramsA);
    imageA.setOnTouchListener(this);
    //Log.d("GameActivity", "")

    imageB.setId(2);
    imageB.setTag("b");
    paramsB = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)
    imageB.setLayoutParams(paramsB);
    imageB.setOnTouchListener(this);

    imageC.setId(3);
    imageC.setTag("c");
    paramsC = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)
    imageC.setLayoutParams(paramsC);
    imageC.setOnTouchListener(this);

    imageD.setId(4);
    imageD.setTag("d");
    paramsD = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)
    imageD.setLayoutParams(paramsD);
    imageD.setOnTouchListener(this);

    imageE.setId(5);
    imageE.setTag("e");
    paramsE = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)
    imageE.setLayoutParams(paramsE);
    imageE.setOnTouchListener(this);

    imageF.setId(6);
    imageF.setTag("f");
    paramsF = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT); //The WRAP_CONTENT parameters can be replaced by an absolute width and height or the FILL_PARENT option)
    imageF.setLayoutParams(paramsF);
    imageF.setOnTouchListener(this);
    setupPieces();

    // Set the hardware buttons to control the music
    this.setVolumeControlStream(AudioManager.STREAM_MUSIC);
    // Load the sound
    soundPool = new SoundPool(10, AudioManager.STREAM_MUSIC, 0);
    soundPool.setOnLoadCompleteListener(new SoundPool.OnLoadCompleteListener()
    {
        @Override
        public void onLoadComplete(SoundPool soundPool, int sampleId, int status) {

            loaded = true;
        }
    });

    gameFinishSoundId = soundPool.load(this, R.raw.bells, 1);
    correctPieceAttachSoundId= soundPool.load(this, R.raw.bell, 1);

}

public void playSound(int soundId)
{
    AudioManager audioManager = (AudioManager) getSystemService(AUDIO_SERVICE);
    float actualVolume = (float) audioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
    float maxVolume = (float) audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
    float volume = actualVolume / maxVolume;
    // Is the sound loaded already?
    if (loaded) 
    {
        soundPool.play(soundId, volume, volume, 1, 0, 1.0f);
    }
}

public void onConfigurationChanged(Configuration newConfig) 
{
    super.onConfigurationChanged(newConfig);

    // Checks the orientation of the screen
    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) 
    {
//        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    }
    else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT)
    {
//        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
 //   Toast.makeText(this, "in OnConfiguaration Changed", Toast.LENGTH_SHORT).show();
    isPortait = (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE) ?  false : true;
    ((RelativeLayout)imageA.getParent()).removeAllViews();
    Log.d("GameActivity", "in onconfigurationChanged");
    setupPieces();
}
public void setupPieces()
{
    RelativeLayout relataivelayoutLayout = new RelativeLayout(this);
    Display display = getWindowManager().getDefaultDisplay();
    height = display.getHeight();
    width = display.getWidth();

    if(!isPortait)
    {
        paramsA.leftMargin = 10; //Your X coordinate
        paramsA.topMargin = 30; //Your Y coordinate
    }
    else
    {
        paramsA.leftMargin = 30; //Your X coordinate
        paramsA.topMargin = 10; //Your Y coordinate
    }

    imageA.setLayoutParams(paramsA);
    imageA.setOnTouchListener(this);
    //Log.d("GameActivity", "")

    if(!isPortait)
    {
        paramsB.leftMargin = 650; //Your X coordinate
        paramsB.topMargin = 300; //Your Y coordinate
    }
    else
    {
        paramsB.leftMargin = 300; //Your X coordinate
        paramsB.topMargin = 750; //Your Y coordinate
    }
    imageB.setLayoutParams(paramsB);
    imageB.setOnTouchListener(this);

    if(!isPortait)
    {
        paramsC.leftMargin = 400; //Your X coordinate
        paramsC.topMargin = 380; //Your Y coordinate
    }
    else
    {
        paramsC.leftMargin = 400; //Your X coordinate
        paramsC.topMargin = 350; //Your Y coordinate
    }
    imageC.setLayoutParams(paramsC);
    imageC.setOnTouchListener(this);

    if(!isPortait)
    {
        paramsD.leftMargin = 750; //Your X coordinate
        paramsD.topMargin = 20; //Your Y coordinate
    }
    else
    {
        paramsD.leftMargin = 20; //Your X coordinate
        paramsD.topMargin = 750; //Your Y coordinate
    }
    imageD.setLayoutParams(paramsD);
    imageD.setOnTouchListener(this);

    if(!isPortait)
    {
        paramsE.leftMargin = 900; //Your X coordinate
        paramsE.topMargin = 400; //Your Y coordinate
    }
    else
    {
        paramsE.leftMargin = 475; //Your X coordinate
        paramsE.topMargin = 700; //Your Y coordinate
    }
    imageE.setLayoutParams(paramsE);
    imageE.setOnTouchListener(this);

    if(!isPortait)
    {
        paramsF.leftMargin = 90; //Your X coordinate
        paramsF.topMargin = 300; //Your Y coordinate
    }
    else
    {
        paramsF.leftMargin = 90; //Your X coordinate
        paramsF.topMargin = 300; //Your Y coordinate
    }
    imageF.setLayoutParams(paramsF);
    imageF.setOnTouchListener(this);
    ImageInfo imageAinfo = new ImageInfo(imageA.getId(),imageA,1,2);
    imageInfoArray[0] = imageAinfo;
    ImageInfo imageBinfo = new ImageInfo(imageB.getId(),imageB,1,3);
    imageInfoArray[1] = imageBinfo;
    ImageInfo imageCinfo = new ImageInfo(imageC.getId(),imageC,2,4);
    imageInfoArray[2] = imageCinfo;
    ImageInfo imageDinfo = new ImageInfo(imageD.getId(),imageD,3,5);
    imageInfoArray[3] = imageDinfo;
    ImageInfo imageEinfo = new ImageInfo(imageE.getId(),imageE,4,6);
    imageInfoArray[4] = imageEinfo;
    ImageInfo imageFinfo = new ImageInfo(imageF.getId(),imageF,5,6);
    imageInfoArray[5] = imageFinfo;

    relataivelayoutLayout.addView(imageA);
    relataivelayoutLayout.addView(imageB);
    relataivelayoutLayout.addView(imageC);
    relataivelayoutLayout.addView(imageD);
    relataivelayoutLayout.addView(imageE);
    relataivelayoutLayout.addView(imageF);

    setContentView(relataivelayoutLayout);

}
private void updatePosition(int id)
{
    if(flag[imageInfoArray[id-1].id])
        return;
    flag[imageInfoArray[id-1].id] = true;

    RelativeLayout.LayoutParams param = (RelativeLayout.LayoutParams)imageInfoArray[id-1].imageView.getLayoutParams();
    param.leftMargin = imageInfoArray[id-1].imageView.getLeft() + diffX;
    param.topMargin  = imageInfoArray[id-1].imageView.getTop() + diffY;
    imageInfoArray[id-1].imageView.setLayoutParams(param);
    if(imageInfoArray[id-1].isTopConnected)
        updatePosition(imageInfoArray[id-1].topPieceId);
    if(imageInfoArray[id-1].isBottomConnected)
        updatePosition(imageInfoArray[id-1].bottomPieceId);
    return;
}
@Override
public boolean onTouch(View v, MotionEvent event) 
{

    if(v instanceof ImageView)
    {

        ImageView imageView = (ImageView) v;
        ImageInfo imageInfo = imageInfoArray[imageView.getId()-1];

        switch (event.getAction() & MotionEvent.ACTION_MASK) 
        {

            case MotionEvent.ACTION_DOWN:

                touchStartX = (int) event.getRawX();
                touchStartY = (int) event.getRawY();
                imageX = imageView.getLeft();
                imageY = imageView.getTop();
                //Toast.makeText(this, "x = "+event.getRawX()+" y = "+event.getRawY(), Toast.LENGTH_SHORT).show();
                break;

            case MotionEvent.ACTION_UP:

                touchStartX = (int) event.getRawX();
                touchStartY = (int) event.getRawY();
                imageX = imageView.getLeft();
                imageY = imageView.getTop();
                int id = imageInfo.id;
                while(imageInfo.isTopConnected)
                {
                    if(imageInfo.id == imageInfo.topPieceId)
                        break;
                    imageInfo = imageInfoArray[imageInfo.topPieceId-1];                     
                }
                if(!imageInfo.isTopConnected)
                {
                    imageView = imageInfo.imageView;
                    int topConnectingPieceId = imageInfo.topPieceId;
                    int topConnectingX=0,topConnectingY=0;
                    topConnectingX = imageInfo.calculateTopX(imageView.getLeft(), imageView.getId());
                    topConnectingY = imageInfo.calculateTopY(imageView.getTop(), imageView.getId());

                    ImageInfo topImageInfo = imageInfoArray[topConnectingPieceId-1];
                    int bottomConnectingX = topImageInfo.calculateBottomX(topImageInfo.imageView.getLeft(),topConnectingPieceId);
                    int bottomConnectingY = topImageInfo.calculateBottomY(topImageInfo.imageView.getTop(),topConnectingPieceId);
                    diffX = (bottomConnectingX-topConnectingX);
                    diffY = (bottomConnectingY-topConnectingY);
                    if(Math.abs(diffX)<=20 && Math.abs(diffY)<=20)
                    {
                        for(int i=0;i<7;i++)
                            flag[i]=false;
                        updatePosition(imageInfo.id);
                        imageInfo.setIsTopConnected(true);
                        topImageInfo.setIsBottomConnected(true);
                        attachedPieces++;
                        if(attachedPieces==5)
                        {
                            setupFinishDialogue();
                            playSound(gameFinishSoundId);
                        }
                        else
                            playSound(correctPieceAttachSoundId);
                        break;
                    }
                }
                imageInfo = imageInfoArray[id-1];
                while(imageInfo.isBottomConnected)
                {
                    if(imageInfo.id == imageInfoArray[imageInfo.bottomPieceId-1].id)
                        break;
                    imageInfo = imageInfoArray[imageInfo.bottomPieceId-1];                      
                }
                imageView = imageInfo.imageView;
                if(!imageInfo.isBottomConnected)
                {
                    int topConnectingX=0,topConnectingY=0; 
                    int bottomConnectingX = imageInfo.calculateBottomX(imageView.getLeft(), imageView.getId());
                    int bottomConnectingY = imageInfo.calculateBottomY(imageView.getTop(), imageView.getId());
                    int bottomConnectingPieceId = imageInfo.bottomPieceId;
                    ImageInfo bottomImageInfo = imageInfoArray[bottomConnectingPieceId-1];
                    topConnectingX = bottomImageInfo.calculateTopX(bottomImageInfo.imageView.getLeft(),bottomConnectingPieceId);
                    topConnectingY = bottomImageInfo.calculateTopY(bottomImageInfo.imageView.getTop(), bottomConnectingPieceId);
                    diffX = (topConnectingX-bottomConnectingX);
                    diffY = (topConnectingY-bottomConnectingY);
                    if(Math.abs(diffX)<=20 && Math.abs(diffY)<=20)
                    {
                        for(int i=0;i<7;i++)
                            flag[i]=false;
                        updatePosition(imageInfo.id);
                        imageInfo.setIsBottomConnected(true);
                        bottomImageInfo.setIsTopConnected(true);
                        attachedPieces++;
                        if(attachedPieces==5)
                        {
                            setupFinishDialogue();
                            playSound(gameFinishSoundId);
                        }
                        else
                            playSound(correctPieceAttachSoundId);
                    }
                }

                break;

            case MotionEvent.ACTION_MOVE:

                diffX = (int) (event.getRawX() - touchStartX);
                diffY = (int) (event.getRawY() - touchStartY);
                touchStartX = (int)event.getRawX();
                touchStartY = (int)event.getRawY();

                for(int i=0;i<7;i++)
                    flag[i]=false;                  
                updatePosition(imageInfo.id);       
                break;

            default:
                break;
        }

    }

    return true;
}

void lockOrientation()
{
    switch (getResources().getConfiguration().orientation)
    {
        case Configuration.ORIENTATION_PORTRAIT:
            if(android.os.Build.VERSION.SDK_INT < android.os.Build.VERSION_CODES.FROYO)
            {
                setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
            }
            else 
            {
                int rotation = getWindowManager().getDefaultDisplay().getRotation();
                if(rotation == android.view.Surface.ROTATION_90|| rotation == android.view.Surface.ROTATION_180)
                {
                    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_PORTRAIT);
                }
                else 
                {
                    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
                }
            }   
            break;

        case Configuration.ORIENTATION_LANDSCAPE:
            if(android.os.Build.VERSION.SDK_INT < android.os.Build.VERSION_CODES.FROYO)
            {
                setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
            }
            else 
            {
                int rotation = getWindowManager().getDefaultDisplay().getRotation();
                if(rotation == android.view.Surface.ROTATION_0 || rotation == android.view.Surface.ROTATION_90){
                    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
                } 
                else 
                {
                    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_LANDSCAPE);
                }
            }
            break;
    }
}

void setupFinishDialogue()
{
    /*if(getWindowManager().getDefaultDisplay().getRotation()==3)
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    else if(getWindowManager().getDefaultDisplay().getRotation()==1)
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_PORTRAIT);
    else if(getWindowManager().getDefaultDisplay().getRotation()==2)
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_REVERSE_LANDSCAPE);
    else setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_NOSENSOR);*/

    lockOrientation();

    AlertDialog.Builder builderForAlertBox = new AlertDialog.Builder(this);
    builderForAlertBox.setCancelable(false).setMessage("Good Job!").setPositiveButton("Restart", dialogClickListner).setNegativeButton("Quit", dialogClickListner).
    setCancelable(true).show(); 
}
DialogInterface.OnClickListener dialogClickListner = new DialogInterface.OnClickListener() 
{       
    public void onClick(DialogInterface dialog, int which) 
    {
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR);
        switch (which) {
        case DialogInterface.BUTTON_POSITIVE:
            finish();
            Intent intent = new Intent(getApplicationContext(),GameActivity.class);
            startActivity(intent);
            break;

        case DialogInterface.BUTTON_NEGATIVE:
            finish();
        default:
            break;
        }

    }
}; 
```

}

图像信息类

```
package com.example.JigSawPuzzle;

import android.widget.ImageView;
import android.widget.Toast;

public class ImageInfo 
{
ImageView imageView;
int imageATopLeftDifferenceX = -1;
int imageATopLeftDifferenceY = -1;
int imageABottomRightDifferenceX = 113;
int imageABottomRightDifferenceY = 140;

int imageBTopLeftDifferenceX = 0;
int imageBTopLeftDifferenceY = 0;
int imageBBottomRightDifferenceX = 0;
int imageBBottomRightDifferenceY = 111;

int imageCTopLeftDifferenceX = 14;
int imageCTopLeftDifferenceY = 0;
int imageCBottomRightDifferenceX = 0;
int imageCBottomRightDifferenceY = 88;

int imageDTopLeftDifferenceX = 92;
int imageDTopLeftDifferenceY = 2;
int imageDBottomRightDifferenceX = 0;
int imageDBottomRightDifferenceY = 70;

/*int imageETopLeftDifferenceX = 0;
int imageETopLeftDifferenceY = 0;
int imageEBottomRightDifferenceX = 55;
int imageEBottomRightDifferenceY = 112;*/
int imageETopLeftDifferenceX = 55;
int imageETopLeftDifferenceY = 112;
int imageEBottomRightDifferenceX = 0;
int imageEBottomRightDifferenceY = 0;

/*int imageFTopLeftDifferenceX = 0;
int imageFTopLeftDifferenceY = 26;
int imageFBottomRightDifferenceX = 0;
int imageFBottomRightDifferenceY = 109;
int id,topPieceId,bottomPieceId;*/
int imageFTopLeftDifferenceX = 0;
int imageFTopLeftDifferenceY = 109;
int imageFBottomRightDifferenceX = 0;
int imageFBottomRightDifferenceY = 26;
int id,topPieceId,bottomPieceId;

boolean isTopConnected = false;
boolean isBottomConnected = false;
public ImageInfo(int id,ImageView imageView,int topPieceId,int bottomPieceId)
{
    this.topPieceId = topPieceId;
    this.bottomPieceId = bottomPieceId;
    this.imageView = imageView;
    this.id = id;
    if(id==1)
        isTopConnected = true;
    else if(id==6)
        isBottomConnected = true;
    if(GameActivity.screenInches>9.0)
        initializePiecesInfo();
}
private void initializePiecesInfo() 
{

    imageATopLeftDifferenceX = 0;
    imageATopLeftDifferenceY = 0;
    imageABottomRightDifferenceX = 150;
    imageABottomRightDifferenceY = 184;

    imageBTopLeftDifferenceX = 0;
    imageBTopLeftDifferenceY = 0;
    imageBBottomRightDifferenceX = 0;
    imageBBottomRightDifferenceY = 148;

    imageCTopLeftDifferenceX = 23;
    imageCTopLeftDifferenceY = 0;
    imageCBottomRightDifferenceX = 0;
    imageCBottomRightDifferenceY = 115;

    imageDTopLeftDifferenceX = 121;
    imageDTopLeftDifferenceY = 0;
    imageDBottomRightDifferenceX = 0;
    imageDBottomRightDifferenceY = 91;

    /*int imageETopLeftDifferenceX = 0;
    int imageETopLeftDifferenceY = 0;
    int imageEBottomRightDifferenceX = 55;
    int imageEBottomRightDifferenceY = 112;*/
    imageETopLeftDifferenceX = 74;
    imageETopLeftDifferenceY = 147;
    imageEBottomRightDifferenceX = 0;
    imageEBottomRightDifferenceY = 0;

    /*int imageFTopLeftDifferenceX = 0;
    int imageFTopLeftDifferenceY = 26;
    int imageFBottomRightDifferenceX = 0;
    int imageFBottomRightDifferenceY = 109;
    int id,topPieceId,bottomPieceId;*/
    imageFTopLeftDifferenceX = 0;
    imageFTopLeftDifferenceY = 144;
    imageFBottomRightDifferenceX = 0;
    imageFBottomRightDifferenceY = 26;
}

int calculateTopX(int realX,int id)
{
    if(id==2)
        return realX+imageBTopLeftDifferenceX;
    if(id==3)
        return realX+imageCTopLeftDifferenceX;
    if(id==4)
        return realX+imageDTopLeftDifferenceX;
    if(id==5)
        return realX+imageETopLeftDifferenceX;
    if(id==6)
        return realX+imageFTopLeftDifferenceX;
    return realX;

}
int calculateTopY(int realY,int id)
{
    if(id==2)
        return realY+imageBTopLeftDifferenceY;
    if(id==3)
        return realY+imageCTopLeftDifferenceY;
    if(id==4)
        return realY+imageDTopLeftDifferenceY;
    if(id==5)
        return realY+imageETopLeftDifferenceY;
    if(id==6)
        return realY+imageFTopLeftDifferenceY;
    return realY;
}

int calculateBottomX(int realX,int id)
{
    if(id==1)
        return realX+imageABottomRightDifferenceX;
    if(id==2)
        return realX+imageBBottomRightDifferenceX;
    if(id==3)
        return realX+imageCBottomRightDifferenceX;
    if(id==4)
        return realX+imageDBottomRightDifferenceX;
    if(id==5)
        return realX+imageEBottomRightDifferenceX;
    return realX+imageFBottomRightDifferenceX;      
}
int calculateBottomY(int realY,int id)
{
    if(id==1)
        return realY+imageABottomRightDifferenceY;
    if(id==2)
        return realY+imageBBottomRightDifferenceY;
    if(id==3)
        return realY+imageCBottomRightDifferenceY;
    if(id==4)
        return realY+imageDBottomRightDifferenceY;
    if(id==5)
        return realY+imageEBottomRightDifferenceY;
    return realY+imageFBottomRightDifferenceY;
}
void setIsTopConnected(boolean isTopConnected)
{
    this.isTopConnected = isTopConnected;
}
void setIsBottomConnected(boolean isBottomConnected)
{
    this.isBottomConnected = isBottomConnected;
}

} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-10T21:19:14.080

鉴于您提供的图像，以通用方式连接它们很简单，因为图像具有相同的宽度并且它们具有透明背景，这是这个想法：

1-您需要两个图像之间的重叠距离，您可以从底部或顶部图像计算

![在此处输入图像描述](../Images/c29963f74b80f2080c1eb950c485daf3.png)

下图中的绿线应等于上图中的红线

![底部图像](../Images/7e38c7097eb297c22cbbb6631fb7ff2c.png)

鉴于您的图像具有透明背景，您可以轻松计算此距离，我将在此处使用底部图像。

这个想法是检查底部位图的最后一列中的每个像素（即宽度 - 1），并在遇到不透明像素时停止。

```
 private int getOverlapDistance(Bitmap bottomBitmap) {
    int height = bottomBitmap.getHeight();
    int width = bottomBitmap.getWidth();
    int distance = 0;
    for (int i = 0; i < height; i++) {
        if (Color.alpha(bottomBitmap.getPixel(width - 1, i)) != 0) {
            distance = (i + 1);
            break;
        }
    }
    return distance;
} 
```

要连接它们，您可以执行以下操作（假设您`ImageView`将顶部和底部图像分开）：

```
bitmap = ((BitmapDrawable) bottomImage.getDrawable()).getBitmap();
int overlapDistance = getOverlapDistance(bitmap);
bottomImage.setTop(topImage.getBottom() - overlapDistance); 
```

实际上我用一个简单的活动尝试了这个并且它正在工作，这是连接两个图像之前和之后的样子：

![连接前的图像](../Images/90e47e151fce092e1cb2b314bab6eb1e.png)

`connect`我只是在单击按钮时执行上面的代码

![连接后](../Images/c9e769164add8f894c0d8b1d1a4a0e8e.png)

# iphone - 如何在 iPhone 的主屏幕上显示红色状态？

> ID：14714474
> 
> 赞同：0
> 
> 时间：2013-02-05T18:36:52.247
> 
> 标签：iphone, notifications, status

我正在制作一个计数器的应用程序。

我想显示用户进入主屏幕的时间，如下所示：

[https://dl.dropbox.com/u/8455739/SCR/IMG_2696.PNG](https://dl.dropbox.com/u/8455739/SCR/IMG_2696.PNG)

[https://dl.dropbox.com/u/8455739/SCR/IMG_2697.PNG](https://dl.dropbox.com/u/8455739/SCR/IMG_2697.PNG)

可以使用吗？如果是，在哪里可以找到它以及如何使用它？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:43:17.613

您无法更改主屏幕的内容。

您可以在应用程序中显示这样的状态栏。
您展示的示例在应用程序中有这样一个栏。

要创建这样一个栏，您需要在其中实现`drawRect()`. 在 drawRect 中，您使用 CGFillRect() 或 CoreGraphics / Quartz2D 的类似方法绘制一个红色矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:46:09.467

您应该在后台使用 VOIP 或录制音频。检查此[LINK voip](http://blog.toshsoft.de/index.php?/archives/4-Adding-Background-Audio-and-VoIP-to-your-iPhone-App.html)和[LINK 录音](https://stackoverflow.com/questions/3848172/ios-multitasking-for-an-audio-recording-application)

# silverlight-4.0 - Silverlight 4 中 ListBox 中的嵌套复选框

> ID：14714477
> 
> 赞同：0
> 
> 时间：2013-02-05T18:37:00.213
> 
> 标签：silverlight-4.0, listbox, observablecollection, nested-checkboxes

以 Silverlight 4 作为技术平台，使用 ObservableCollection 作为 ItemSource，假设 ObservableCollection 中的每个项目都有一个名为 SubLayers 的属性，其中包含子项，那么 ListBox.ItemTemplate 应该是什么，使得列表框中的复选框按照ObservableCollection 内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T04:26:56.817

> 您可以使用样式表通过树视图完成相同的要求。

# c# - 如何在浏览器中直接打开 pdf 文件？

> ID：14714486
> 
> 赞同：19
> 
> 时间：2013-02-05T18:37:40.247
> 
> 标签：c#, asp.net-mvc

我想`PDF`直接在浏览器中查看文件。我知道这个问题已经被问过了，但我还没有找到适合我的解决方案。

到目前为止，这是我的操作的控制器代码：

```
public ActionResult GetPdf(string fileName)
{
    string filePath = "~/Content/files/" + fileName;
    return File(filePath, "application/pdf", fileName);
} 
```

这是我的看法：

```
@{
   doc = "Mode_d'emploi.pdf";
} 

<p>@Html.ActionLink(UserResource.DocumentationLink, "GetPdf", "General", new { fileName = doc }, null)</p> 
```

当我将鼠标悬停在这里的链接是链接：

![在此处输入图像描述](../Images/7945e4ac3f503438c91f15d31072719e.png)

我的代码的问题是`pdf`文件没有在浏览器中查看，但我收到一条消息，询问我是否要打开或保存文件。

![在此处输入图像描述](../Images/25f9b2b18e2c17e108853c141ffebda2.png)

我知道这是可能的，并且我的浏览器支持它，因为我已经在另一个网站上对其进行了测试，允许我`pdf`直接在浏览器中查看。

例如，这是我将鼠标悬停在链接上时的链接（在另一个网站上）：

![在此处输入图像描述](../Images/e38232b2ce46ae1bc9fbb457773f8b79.png)

如您所见，生成的链接有所不同。我不知道这是否有用。

`pdf`知道如何直接在浏览器中查看我的吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2016-11-23T22:02:25.960

您收到要求您打开或保存文件的消息的原因是您正在指定文件名。如果您不指定文件名，PDF 文件将在您的浏览器中打开。

因此，您需要做的就是将您的操作更改为：

```
public ActionResult GetPdf(string fileName)
{
    string filePath = "~/Content/files/" + fileName;
    return File(filePath, "application/pdf");
} 
```

或者，如果您需要指定文件名，则必须这样做：

```
public ActionResult GetPdf(string fileName)
{
    string filePath = "~/Content/files/" + fileName;
    Response.AddHeader("Content-Disposition", "inline; filename=" + fileName);        

    return File(filePath, "application/pdf");
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-02-05T18:48:15.613

不要返回 a `File`，而是尝试返回 a`FileStreamResult`

```
public ActionResult GetPdf(string fileName)
{
    var fileStream = new FileStream("~/Content/files/" + fileName, 
                                     FileMode.Open,
                                     FileAccess.Read
                                   );
    var fsResult = new FileStreamResult(fileStream, "application/pdf");
    return fsResult;
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-04-05T19:08:57.460

将您的代码更改为：

```
 Response.AppendHeader("Content-Disposition","inline;filename=xxxx.pdf");
       return File(filePath, "application/pdf"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-19T09:41:20.580

如果您读取存储在数据库图像列中的文件，您可以像这样使用：

```
public ActionResult DownloadFile(int id)
{
    using (var db = new DbContext())
    {
        var data =
            db.Documents.FirstOrDefault(m => m.ID == id);
        if (data == null) return HttpNotFound();
        Response.AppendHeader("content-disposition", "inline; filename=filename.pdf");
        return new FileStreamResult(new MemoryStream(data.Fisier.ToArray()), "application/pdf");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-04T17:25:11.347

如果您使用**Rotativa**包生成 PDF，则不要将名称添加到具有**FileName**属性的文件中，如下例所示。

```
 return new PartialViewAsPdf("_JcPdfGenerator", pdfModel); 
```

希望这对某人有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-21T09:00:49.737

尽管以前的帖子通常是正确的；我认为他们中的大多数都不是最佳实践！我想建议将动作返回类型更改为`FileContentResult`并`return new FileContentResult(fileContent, "application/pdf");` 在动作主体的末尾使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-30T07:35:08.587

**是的，您只需重定向即可。它像你需要的那样结束扩展，.pdf ..**

```
protected void OpenPdfPdf_Click(object sender, EventArgs e)
        {
            Response.Redirect("jun.pdf");
        } 
```

**或另一种方法，其打开方式类似于 .aspx 页面——**

```
 protected void OpenPdf_Click(object sender, EventArgs e)
        {
            string path = Server.MapPath("jun.pdf");
            //or you want to load from url change path to
//string path="https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf";   
            WebClient client = new WebClient();
            Byte[] buffer = client.DownloadData(path);
            if (buffer != null)
            {
                Response.ContentType = "application/pdf";
                Response.AddHeader("content-length", buffer.Length.ToString());
                Response.BinaryWrite(buffer);
            }
        } 
```

# android - Android Fragments 中容器的用途

> ID：14714489
> 
> 赞同：9
> 
> 时间：2013-02-05T18:37:45.933
> 
> 标签：android, android-fragments, containers, fragment

我正在学习 Fragments，但我无法理解为什么 Fragments 需要一个 Container 背后的意义。

我理解 Fragments 工作的方式如下：

1.  FragmentActivity setContentview 是指定义片段所在位置的 xml 文件。

2.  FragmentActivity 创建片段的实例

3.  然后将片段分配给容器。

4.  FragmentManager 然后显示它们。

5.  实际的 Fragment 类然后膨胀一个布局，正是这个布局包含了所有的应用程序 UI 组件。

（如果我在这里遗漏了什么，请纠正我，因为我现在只是在学习）。

那么为什么容器的目的是我们为什么需要，因为在我看到的所有示例中，它只是一个空白的相对布局 xml 文档。

不同的片段可以共享同一个 Container（因为它只是一个 RelativeLayout xml 文件）吗？

所以在google [http://developer.android.com/training/basics/fragments/creating.html提供的例子中](http://developer.android.com/training/basics/fragments/creating.html)

他们有一个 ListFragment ，当通过使用 CallBack 接口选择项目时，我们最终会回到这行代码：

```
// Replace whatever is in the fragment_container view with this fragment,
// and add the transaction to the back stack so the user can navigate back
transaction.replace(R.id.fragment_container, newFragment); 
```

我的另一个问题是：

1）为什么这行代码没有用文章片段替换ListFragment（左侧Fragment）。自从它被初始化以来，我们看到：

```
getSupportFragmentManager().beginTransaction()
                    .add(R.id.fragment_container, firstFragment).commit(); 
```

相反... ListFragment 保留在左侧，右侧 Fragment 已更新。但是容器fragment_container属于firstFragment这是ListFragment。这不是更新的。

你明白我为什么有这个问题吗？这在教程中没有解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:41:24.443

在这里： http: [//marakana.com/s/post/1250/android_fragments_tutorial](http://marakana.com/s/post/1250/android_fragments_tutorial)

在这里：http: [//developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)

阅读本文，一切都会清楚:)

Fragment 是 Activity 的一部分，只能存在于 Activity 内部。所以你需要一种可以处理片段的特殊类型的活动——它是FragmentActivity。

没有 Fragments 的 FragmentActivity 几乎就像一个普通的 Activity。但它有一个 FragmentManager 来管理（添加、删除、替换）片段。当您想将 Fragment 添加到 FragmetnActivity 时，您应该指定它应该放置的位置（因为 Fragment 不需要全屏，就像 GooglePlay 一样 - 有多个小片段）。所以这就是为什么你需要一个容器。

> 不同的片段可以共享同一个 Container（因为它只是一个 RelativeLayout xml 文件）吗？

是的，他们可以，您可以在同一个容器中将一个片段替换为另一个片段。

# python - 删除线型

> ID：14714491
> 
> 赞同：1
> 
> 时间：2013-02-05T18:37:49.640
> 
> 标签：python, csv

我需要从具有特定模式的 csv 中删除一行

这就是我的 csv 文件的外观。

```
lbm,16730,0
namd,16733,6
namd,16731,2
namd,16732,4 
```

如果我想删除带有模式的行`16730`并按原样输出文件的其余部分..

所以，输出是这样的：

```
namd,16733,6
namd,16731,2
namd,16732,4 
```

我怎么做？

这是我在互联网上的一些文件的帮助下编写的一个小脚本

```
def delete_line(dello):
    opener = open(input_csv, 'rb')
    dataset = csv.reader(opener, delimiter=',')
    output = []
    for line in dataset:
            if 'dello' == line[1]:
                    print line[1]
                    #i dont know how to strip it here
                    output.append(line)
    opener.close()
    fn = input_csv
    f = open(fn,'w')
    f.writelines(output)
    f.close() 
```

任何提示我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:47:01.130

如果您选择遵循 uʍop ǝpısdn 的建议并使用 grep，这将起作用：

```
grep -v ",16370," path/to/file > path/to/new_file 
```

假设文件的结构类似于示例中的结构并且在所有文件中都是一致的，但是......

仅供参考，在 grep 中，-v 表示反向匹配，返回所有**不**包含指定模式的结果。

EDIT: If you need to preserve the original file, you can use a temporary and then restore its name to the original one:

```
grep -v ",16370," path/to/file > path/to/new_file && rm path/to/file && mv path/to/new_file path/to/file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:59:20.343

If you need python, then use this:

```
def delete_line(dello):
    data = open("abc.csv").readlines()

    i = 0
    for line in data:
        if dello in line:
            data.pop(i)
        i += 1

    open("abc.csv", "w").write("".join(data))

delete_line("16732") 
```

Input:

```
lbm,16730,0
namd,16733,6
namd,16731,2
namd,16732,4 
```

Output:

```
lbm,16730,0
namd,16733,6
namd,16731,2 
```

Note: this will remove all the entries matching the string.

* * *

**Update**

Modifying your code:

```
import csv

def delete_line(dello):
    opener = open("abc.csv", 'rb')
    dataset = csv.reader(opener, delimiter=',')
    output = []
    for line in dataset:
        # Add to output only if not matching the string
        if dello != line[1]:
            # Need join as line is a list
            output.append(",".join(line) + "\n")
    opener.close()

    fn = "abc.csv"
    f = open(fn,'w')
    f.writelines(output)
    f.close()

delete_line("16730") 
```

If you need to strip out an entry, you can use `dataset.pop(index)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:01:25.790

there are two ways to run a python script like that:

first: adding a **main** section to the file like:

```
if __name__ == "__main__":
    delete_line(some_paramter) 
```

and then running from the command line:

```
python scriptfilename.py 
```

or from python shell:

```
from scriptfilename import delete_line
delete_line(some_parameter) 
```

do you use one of those? a script doesn't run itself.

some more unclarified business with your script:

1.  what exactly is the input variable dello used in your script. there is a line using the string 'dello' but not the parameter dello. what did you try to do here

2.  are you running it in the same folder with the input_csv file. is input_csv the full file name or is it input_csv.csv.

3.  you are using input_csv as a variable, which is empty and would fail, if this isn't a variable holding the file name (from some place else in the file) you should call the file name as a string: `'input_csv.csv'`

4.  you commented: #i dont know how to strip it here? what exactly is the question and what do you mean by that? using strip(). something else?

5.  did your script import csv before the function? if not.. nothing would work.

6.  It is always more recommanded to work with `with` when working with files. handles exceptions and automatic file closing. you can read about that in numerous places.

something like:

```
with open('file.csv','rb') as f:
    dataset = csv.reader(f)
    #the rest. and you don't need closing etc..' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:21:36.547

The first problem:

```
if 'dello' == line[1]: 
```

1.  You refer to `dello` with quote
2.  You have the logic reverse.

Therefore, the correct test should be:

```
if dello != line[1]: 
```

The second problem: you read the file as a CSV, but write it out as an ordinary file. You should be consistent by either read and write as an ordinary text file, or as CSV. Mixing them up makes it hard to get the right output.

The third is not really a problem, but a suggestion: don't hard code the file name, pass it into your function. That way, your function is more versatile.

Here is my proposed code:

```
def delete_line(input_csv, dello):
    with open(input_csv, 'rb') as f:
        csv_reader = csv.reader(f)
        output = []
        for line in csv_reader:
            if dello not in line:
                output.append(line)

    with open(input_csv, 'wb') as f:
        csv_writer = csv.writer(f)
        csv_writer.writerows(output) 
```

# c# - Webrequest 代理超时值

> ID：14714495
> 
> 赞同：1
> 
> 时间：2013-02-05T18:38:00.557
> 
> 标签：c#, .net, vb.net, proxy

我正在尝试设置代理超时值，以便如果代理在 10 秒后无法工作，它应该取消请求。我如何在 HTTPWebRequest 或 WebRequest 中这样做？

```
WebProxy webProxy = new WebProxy("http://testserver:80/");
WebRequest webRequest = WebRequest.Create("http://www.google.com");
webRequest.Proxy = webProxy;
webRequest.Timeout = 5000; 
```

它只是 Timeout 属性吗？它似乎对我不起作用。

问候

# c++ - 在 C++ 扩展中解析 python 参数

> ID：14714502
> 
> 赞同：1
> 
> 时间：2013-02-05T18:38:10.727
> 
> 标签：c++, python, python-c-api

有没有类似于 PyArg_ParseTuple 和 PyArg_ParseTupleAndKeywords 的函数，不使用变量参数列表？

我有一个 c++ 扩展，它需要一长串输入参数。以 PyArg_ParseTuple 和 PyArg_ParseTupleAndKeywords 的格式解析它们看起来很难看。我希望能够以 ([keyword1, format1, ptr1], [keyword2, format2, ptr2], ...) 的形式传递我的参数列表。是否有现有的功能或包可以这样做？

# netbeans - 编辑 netbeans.config 设置 jdk 路径会导致错误

> ID：14714503
> 
> 赞同：0
> 
> 时间：2013-02-05T18:38:14.160
> 
> 标签：netbeans, netbeans-7, netbeans-platform

嗨，我最近升级到了 Windows 8。

由于某种原因，在我安装了 netbeans 之后，它并没有指向我安装了 jdk。

我之前在 Windows 7 下遇到过这个问题，我通过编辑 netbeans.config 文件修改了路径。

我尝试做同样的事情，但由于某种原因，当我尝试将文件保存在记事本++中时，我收到一条错误消息，指出该文件已在另一个程序中打开。

我尝试用写字板做同样的事情，但我得到了访问被拒绝的错误。

我重新启动了我的电脑两次同样的问题仍然存在。

有没有其他方法可以设置 jdk 的路径？也许来自任何 netbeans 选项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-28T14:13:43.750

我正在尝试这样做，但这对我不起作用，因为我需要特权..

我的解决方案：

只需以管理员身份打开记事本++，然后你就可以做任何你想做的事情。如果这不起作用，请删除文件，然后创建一个具有相同内容的新文件（不要忘记以管理员身份运行记事本++）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-27T09:24:11.973

1.  复制 netbeans.confg 的内容
2.  删除它
3.  创建具有相同名称的新文件
4.  过去并执行您的编辑

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:04:26.703

编辑配置文件时，使舒尔 netbeans 未打开。

如果`netbeans_jdkhome`in 的设置`netbeans.conf`不起作用，您可以将其注释掉（在`#`前面插入）。现在 netbeans 将使用*默认*安装的 JDK。但是，您需要适合`path`java （和`JAVA_HOME`）。

也可以通过命令行参数设置 JDK：`--jdkhome <dir>`

**看：**

*   [通过命令行设置JDK](http://wiki.netbeans.org/FaqJdkHome)
*   [Netbeans.conf - 见 JDK 部分](http://wiki.netbeans.org/FaqNetbeansConf)

# delphi - 在 Delphi 2007 中重新安装一级方程式组件 (TF1Book)，未找到 TF1Book 的许可证信息错误

> ID：14714505
> 
> 赞同：0
> 
> 时间：2013-02-05T18:38:15.880
> 
> 标签：delphi, delphi-2007

我正在将使用 Delphi 2007 开发的旧项目和一堆 3rd 方组件从旧计算机转移到我自己的安装中。除了 TF1Book 组件（来自 VCF132.ocx 库，版本 4.1.1.2）之外的所有内容都可以正常工作。我在新计算机和相同的补丁中使用完全相同版本的 Delphi。（旧电脑属于离开公司的开发人员，无法使用且无法访问）

我在设计时遇到的错误，就在设计时是：

> 未找到 TF1Book 的许可信息。您不能在设计模式下使用此控件。

所以，我仍然可以在记事本中编译和编辑 .dfm 表单，并且在运行时可以正常工作，但我无法在 Delphi 中正常工作。

请注意，我已阅读与此问题相关的每个 google 搜索的前 30 个条目，其中有几个变体。他们中的大多数人说我应该简单地运行 regsvr32 在 Windows 中注册 OCX，这将解决问题。而且，我发现的大多数帖子或博客都比较老，而且他们谈论的是组件的 3.x 版本。我使用的是 4.1.1.2 版本。这是其他开发人员在他的计算机中的内容。

我重复了将 VCF132.ocx 放置在 \windows\system32 或 windows\syswow64（对于 x64 窗口）上的假定过程，然后运行适当的 regsvr32 版本以在 3 台计算机中注册组件：Win 7 x86、Win 7 x64、 Win 8 和 WinXP SP3 并在所有这些中得到相同的结果。

我开始认为这是一个真正的许可问题，而不是 ocx windows 注册问题。实际上，如果我不在 Windows 中注册 de OCX，我在 Delphi 中得到的错误是非常不同的，它是关于找不到类或类似的东西。

公司中没有其他人（一家小型 3 人公司）知道或记得这是如何获得组件的，因此我们找不到合适的组件安装程序。

不过，通过研究该计算机中的 Windows 注册表，我发现了有关某种注册过程的信息，例如用户、公司和序列号。旧计算机中没有与此 ocx 关联的“.lic”文件。

但到目前为止，我无法在那台计算机上找到这样的安装程序。我很乐意简单地获得一个新的许可证，但这个产品不再销售了。

所以，这是我的问题。对于 VcF132.ocx，版本 4.1.1.2，是否有人知道/记得是否有复制保护或注册机制会禁止我简单地将组件移动到其他计算机？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:50:37.777

我以前曾经使用过这个组件。我记得，注册 OCX 只会为您提供运行时支持。为了在设计时让它全部工作，您需要在您的开发机器上运行供应商提供的安装程序。

我还清楚地记得每台开发人员机器上都安装了一个 .lic 文件。所以你应该在旧机器上找到它们，但我不确定它们是否可以轻松转移。

# .net - WebMethod 调用导致客户端出现 OutOfMemoryException。结果可以直接写入硬盘吗？

> ID：14714510
> 
> 赞同：0
> 
> 时间：2013-02-05T18:38:38.033
> 
> 标签：.net, web-services, out-of-memory

我正在.net Web 服务上调用 WebMethod。它可以提取足够的数据以在客户端上引发 OutOfMemoryException，因为它超出了 Windows 进程允许的 2GB 限制。

由于截止日期，我不想通过添加代码将调用拆分成更小的块来解决这个问题。我可以在客户端上使用 LARGEADDRESSAWARE 标志，但是客户端的进程仍然会有限制（3GB-4GB）。在这一点上，我只能说这样会更好，但我不能说永远就足够了（客户端是一个 WinForm，将通过 CD 发布给客户，所以我只尝试过一次） .

最好的方法是调用 WebMethod 并将方法的结果直接写入硬盘驱动器上的文件，而不是写入我的 .NET 代码中的变量。然后我可以一次从文件中读取一个内存友好的文件块。据我所知，Web 服务没有办法做到这一点。

有没有办法用 Web 服务做到这一点？您是否可以想出其他创造性的解决方案来解决我的 OOM 问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:15:09.057

您还没有说要写入哪个磁盘。您可以想象将输出写入服务上的文件夹，并通过文件共享公开该文件夹。然后，您的服务会将服务器上（临时）文件的路径返回给客户端。

我想您是在谈论传统的 ASMX 服务？他们在创建请求和响应消息的多个副本时存在序列化问题。尝试在客户端上使用“添加服务引用”而不是“添加 Web 引用”。

# android - 安卓分布式文件系统

> ID：14714511
> 
> 赞同：2
> 
> 时间：2013-02-05T18:38:40.150
> 
> 标签：android, dropbox, fuse, distributed-filesystem

我正在尝试为 android OS 开发一个无服务器分布式文件系统（类似于 Dropbox 但无服务器的功能）。我正在寻找有关如何处理它的建议。我在 android 上看到了 FUSE，但没有清楚地了解它如何帮助我的事业。我看到了一个名为 mobiDFS 的现有系统，但没有得到任何有关它的信息。请为我提供一些教程、论文或现有解决方案以帮助我入门。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:46:10.230

[和弦算法](http://en.wikipedia.org/wiki/Chord_%28peer-to-peer%29)可能是一个很好的提示。它解释了如何保持连接设备的“手指环”，以便每个设备拥有自己的数据部分，当每个设备只知道其他一些设备（而不是全部）时，任何其他设备都可以检索这些数据。

该算法解决了支持注册和注销设备的目标，并具有从未能正确从环中注销的设备意外丢失中恢复的方法。似乎正是您需要的。

据我了解，在您的系统中，设备将直接相互通信。可能这是可能的，一些关于技术解决方案的商品建议对我来说也很有趣（所以在这个问题上 +1）。在概念验证的初始阶段，可能可以使用一些没有任何软件堆栈的无线路由器（就像路由器一样）。

# ssis - 为什么在 SQL Server 代理作业中运行的 SSIS 包不能将文件传输到网络文件夹？

> ID：14714516
> 
> 赞同：5
> 
> 时间：2013-02-05T18:38:47.393
> 
> 标签：ssis

我现在已经遇到过两次这种情况，我可以在 BIDS 和集成服务中运行我的 SSIS 包，但是当它通过 SQL Server 代理运行时它会失败。这两个包都将文件作为最后一步传输到我们网络上的文件夹。

我收到的错误是`Could not find a part of the path`路径和文件名。当我在 Windows 任务计划程序中安排它们时，它们执行得很好，但我宁愿让它们通过 sql server 代理运行。

有没有人遇到这个问题并找到解决方法？sql server 中是否缺少我的设置？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T19:05:51.817

您需要使用`proxy account`配置为运行类型为 的作业来运行 SQL Server 作业`SQL Server Integration Services Packages`。作业通常在*`SQL Server Agent Service account`*无权访问网络文件夹的 下运行。要访问网络文件夹，您需要使用域帐户凭据（最好）设置代理，以便您可以访问网络路径。

SO question中的以下答案包含有关如何设置代理帐户的详细步骤

**[如何在我的 SQL Server 代理作业中创建一个将运行我的 SSIS 包的步骤？](https://stackoverflow.com/questions/6712811/how-do-i-create-a-step-in-my-sql-server-agent-job-which-will-run-my-ssis-package)**

# python - 如何从数据文件中提取特定行

> ID：14714528
> 
> 赞同：1
> 
> 时间：2013-02-05T18:39:47.390
> 
> 标签：python, file-io

我有一个问题，但我觉得解决方案应该很简单。我正在构建一个模型，并希望通过 10 倍交叉验证来测试它的准确性。为此，我必须将我的训练语料库 90%/10% 分成训练和测试部分，然后在 90% 上训练我的模型并在 10% 上进行测试。我想这样做十次，每次都采用不同的 90%/10% 拆分，以便最终将语料库的每一位都用作测试数据。然后我将平均每个 10% 测试的结果。

我试图编写一个脚本来提取 10% 的训练语料库并将其写入一个新文件，但到目前为止我还没有让它工作。我所做的是计算文件中的总行数，然后将此数字除以 10 以了解我要提取的十个不同测试集的大小。

```
trainFile = open("danish.train")
numberOfLines = 0

for line in trainFile:
    numberOfLines += 1

lengthTest = numberOfLines / 10 
```

对于我自己的训练文件，我发现它由 3638 行组成，因此每个测试应该大致由 363 行组成。

如何将第 1-363 行、第 364-726 行等写入不同的测试文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:50:27.517

未经测试，但这是基本思想：

```
def getNthSeg(fpath, n, segSize):
    """Get the nth segment of segSize many lines"""
    answer = []
    with open(fpath) as f:
        for i,line in enumerate(f):
            if (segSize-1)*n <= i < segSize*n:
                answer.append(line)
    return answer

def getFolds(fpath, k):
    """ In your case, k is 10"""
    with open(fpath) as f:
        numLines = len(f.readlines())
    segSize = numLines/k
    answer = []
    for n in xrange(k):
        fold = getNthSeg(fpath, n, segSize)
        answer.append(fold)
    return answer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:50:50.823

计算完行数后，返回文件的开头，然后开始将行复制到`danish.train.part-01`. 当行号是 10% 测试集大小的倍数时，为下一部分打开一个新文件。

```
#!/usr/bin/env python2.7

trainFile = open("danish.train")
numberOfLines = 0

for line in trainFile:
    numberOfLines += 1

lengthTest = numberOfLines / 10

# rewind file to beginning
trainFile.seek(0)

numberOfLines = 0
file_number = 0
for line in trainFile:
    if numberOfLines % lengthTest == 0:
        file_number += 1
        output = open('danish.train.part-%02d' % file_number, 'w')

    numberOfLines += 1
    output.write(line) 
```

在这个输入文件上（对不起，我不会说丹麦语！）：

```
one
two
three
four
five
six
seven
eight
nine
ten
eleven
twelve
thirteen
fourteen
fifteen
sixteen
seventeen
eighteen
nineteen
twenty
twenty-one
twenty-two
twenty-three
twenty-four
twenty-five
twenty-six
twenty-seven
twenty-eight
twenty-nine
thirty 
```

这会创建文件

```
danish.train.part-01
danish.train.part-02
danish.train.part-03
danish.train.part-04
danish.train.part-05
danish.train.part-06
danish.train.part-07
danish.train.part-08
danish.train.part-09
danish.train.part-10 
```

例如，第 5 部分包含：

```
thirteen
fourteen
fifteen 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:54:04.240

如果您的文件不是很大，您可以像这样将其拆分为 90/10：

```
trainFile = open("danish.train")
lines = list(trainFile)
N = len(lines)
testing = lines[:N/10]
training = lines[N/10:] 
```

# git - github连接在mac上超时

> ID：14714533
> 
> 赞同：0
> 
> 时间：2013-02-05T18:39:53.780
> 
> 标签：git, github, connection, vpn

```
git pull origin master
ssh: connect to host github.com port 22: Connection timed out
fatal: The remote end hung up unexpectedly 
```

尝试从 github 拉取时，我不断收到以下错误，我没有尝试推送，但我认为会发生同样的情况。如何在 Mac 上更新我的连接，以允许使用 github 存储库进行推/拉？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:48:13.937

这里的问题实际上是 Github 端的一个远程问题。正如他们的状态站点所指出的，他们的负载均衡器存在轻微问题，导致连接超时几分钟。正如提问者在评论中确认的那样，现在一切正常。

# entity-framework - EF5 CodeFirst + 非键列之间的关系

> ID：14714535
> 
> 赞同：1
> 
> 时间：2013-02-05T18:39:59.037
> 
> 标签：entity-framework, ef-code-first

在有两个类；

```
public class Item
{
    [Key]
    public int Id { get; set; }
    [Required]
    public string Name { get; set; }

    public virtual BinCard BinCard { get; set; }
} 
```

和

```
public class BinCard
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    [Required]
    public int ItemId { get; set; }
    [Required]
    public DateTime Date { get; set; }
    [Required]
    public double Qty { get; set; }

    public ObservableCollection<Item> Item { get; set; }
} 
```

BinCard.Id**是****PK**和**自动**增量。

**我想要使​​用Item.Id**和**BinCard.ItemId**使用* *FluentAPI* *的两个表之间的关系。

请帮助我正确地建立这种关系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:51:35.047

EF 不支持非 PK 主体 ID，因为它尚不支持 PK 以外的唯一键。`BinCard.Id`要完成这项工作，您`BinCardId`必须基于`Item`实体创建关系 - 顺便说一句。它看起来像是在模型中建立关系的正确方法。您当前的模型看起来很奇怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T08:04:34.590

感谢所有回复。这是我的问题的解决方案。

```
public class BinCard
{
    [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    [Required]
    public int ItemId { get; set; }
    [Required]
    public DateTime Date { get; set; }
    [Required]
    public double Qty { get; set; }

    public virtual Drug Drug { get; set; }
}

public class Item
{
    [Key]
    public int Id { get; set; }
    [Required]
    public string Name { get; set; }

    public ObservableCollection<BinCard> BinCard { get; set; }
}

protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<Drug>()
            .HasRequired(s => s.Stock)
            .WithRequiredPrincipal(s => s.Drug);
} 
```

# post - Scheme中的邮政编码验证（Dr. Racket）

> ID：14714538
> 
> 赞同：2
> 
> 时间：2013-02-05T18:40:14.447
> 
> 标签：post, scheme, racket, postal-code

我正在用 Scheme (Dr. Racket) 编写一个程序来验证加拿大的邮政编码。用户输入邮政编码并得到有效与否的响应。我把布尔逻辑记下来了，但我不知道如何真正告诉它正确的格式是什么。

前任。（有效的邮政编码？N2L 3G1）=> 真

我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:54:52.040

如果您想知道字符串是否具有有效邮政编码的格式，可以使用正则表达式。加拿大邮政编码由六个字符组成，交替的字母和以字母开头的数字，在第三个和第四个字符之间嵌入一个空格。一个合适的正则表达式是`^[A-Z][0-9][A-Z] [0-9][A-Z][0-9]$`.

如果您想知道具有有效格式的字符串是否在邮政编码列表中，最简单的解决方案是布隆过滤器。[我在我的博客](http://programmingpraxis.com/2009/04/21/probabilistic-spell-checking/)中提供了一个用 Scheme 编写的布隆过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:47:01.137

我不知道加拿大邮政编码是如何工作的，但我认为你要问的是你可能只有一长串有效代码，需要告诉程序它们没问题，没有其他代码。

使用可变哈希映射将非常适合您的目的：[http ://docs.racket-lang.org/guide/hash-tables.html](http://docs.racket-lang.org/guide/hash-tables.html)

# asp.net-mvc - MVC4 捕获对控制器操作的所有请求

> ID：14714541
> 
> 赞同：0
> 
> 时间：2013-02-05T18:40:32.167
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我的应用程序需要能够让用户使用 foo.com/pubid 约定导航到页面，其中 pubid 是随机生成的字符串，例如“wgwrfwrcwrf”。

我的`Home`控制器定义了一个 Index ActionResult：

```
 public ActionResult Index(string id)
    {
         //do stuff
    } 
```

当我在我的网站上导航到此操作而不指定 ID 时，一切都很好。我返回与 home 关联的视图。这就是 bit.ly 所做的。我正在尝试在我的应用程序中翻译该 ID。

但是，如果我请求诸如 foo.com/wgwrfwrcwrf 之类的 URL，我会得到 404。我需要能够捕获此字符串以将其发送到正确的视图。这需要自定义路线吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:45:21.350

```
routes.MapRoute(
    "id", // Route name
    "{id}", // id route
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-05T10:23:09.533

你应该写一个像这样的包罗万象的路线......

```
 routes.MapRoute("catchall", "{*id}", 
                               new {
                                      controller = "Home", 
                                      action = "Index", 
                                      id = UrlParameter.Optional
                                   }); 
```

享受 ：）

# javascript - UTC 日期字符串是否需要格式说明符“Z”，即使该字符串包含时间偏移？

> ID：14714548
> 
> 赞同：18
> 
> 时间：2013-02-05T18:41:07.140
> 
> 标签：javascript, parsing, date, utc

例如，

```
const d = new Date("2012-08-20T15:00:00-07:00"); 
```

`d`这是一个*UTC*时间，时间偏移 = `07:00`。还需要`Z`这样`2012-08-20T15:00:00-07:00Z`吗？它是否正确？

如果我使用这个字符串`Z`并使用 JavaScript 中的方法解析它`Date.parse()`，它会引发错误。不知道出了什么问题！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-05T18:45:02.347

不，您不应该包含带有时区偏移的“Z”。

从[rfc3339](http://www.ietf.org/rfc/rfc3339.txt)：

```
 Z           A suffix which, when applied to a time, denotes a UTC
              offset of 00:00; often spoken "Zulu" from the ICAO
              phonetic alphabet representation of the letter "Z". 
```

“Z”是零时间偏移，因此将其包含在显式偏移（尤其是非零偏移）是没有意义的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-05T18:47:57.993

引用[W3C 关于日期和时间格式的说明](http://www.w3.org/TR/NOTE-datetime)：

> YYYY-MM-DDThh:mm:ss.sTZD（例如 1997-07-16T19:20:30.45+01:00）
> 
> 在哪里：
> 
> [...]
> 
> ```
> TZD  = time zone designator (Z or +hh:mm or -hh:mm) 
> ```

注意上面的*or*词。您*可以*指定时区偏移量或*Zulu* *（*无偏移量）。`Z`

# visual-studio-2012 - 用于 NVelocity 语言的 Visual Studio 2012 Colorizer 和 IntelliSense

> ID：14714549
> 
> 赞同：1
> 
> 时间：2013-02-05T18:41:09.313
> 
> 标签：visual-studio-2012, nvelocity

[CVSI（Castle Visual Studio 集成）](http://www.jonorossi.com/projects/cvsi/) （在VS2010 之前可用）是处理 NVelocity 内容文件的一个很好的解决方案。没有VS2012的版本。是否有任何其他 VS2012 扩展来处理 NVelocity 内容？通过 HTML 编辑器添加 .vm 扩展支持是一种临时解决方案，可为内容中的 HTML 格式提供一些支持……但不是 NVelocity 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T10:38:55.350

实际上，我在去年年底为 Visual Studio 2012 升级了 CVSI，但我从未发布过它，因为我不知道如何使单个 .vsix 同时支持 VS2010 和 VS2012，因此我可以将其上传到 Visual Studio Gallery。

我很高兴通过电子邮件向您发送（或上传）预览 .vsix，您可以试用并告诉我您的进展情况。由于仍然对 CVSI 感兴趣，我将在接下来的几周内尝试找一些时间在画廊上发布更新版本。

**编辑 2014-05-25：**我发布了支持 Visual Studio 2012 和 2013 的 0.5.0，您可以在此处下载它们：http: [//jonorossi.com/projects/cvsi/](http://jonorossi.com/projects/cvsi/)

# php - 在 for 循环中选择 SUM() 作为变量

> ID：14714550
> 
> 赞同：0
> 
> 时间：2013-02-05T18:41:12.837
> 
> 标签：php, mysql, variables, for-loop, sum

我正在尝试从数据库生成 XML，并且需要根据列的平均值收集特定数量的数据。这可以在 5 到 30 个变量查询之间`$numItems`变化。

我需要执行一个 for 循环并在其中分配列名，`SUM($variable)`但我没有得到任何数据（但也没有错误）。

这是我的代码：

```
for ($t = 1; $t <= $numItems; $t++){

$query = mysql_fetch_assoc(mysql_query("SELECT SUM(column'".$t."') AS value_sum FROM scoring WHERE ID='" . $userID . "' AND name ='" . $name . "'")); 

$q = $query['value_sum'] / $totalUsers;

echo "<output".$t.">" . $q . "</output".$t.">\n";

} 
```

问题是`SUM(column1)`为我从中获取数据的列分配变量名称，当我单独编写查询时它可以工作，但是在语句中分配变量会导致问题。任何人都可以给我任何指示吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:47:22.197

看起来您的查询中可能有额外的单引号。我认为应该是：

```
"SELECT SUM(column".$t.")..." 
```

您还应该考虑进行单选。在 for 循环中执行多个数据库调用将是一个巨大的性能问题。您可以像这样编写单个选择：

```
"SELECT SUM(column1), SUM(column2), SUM(column3),..." 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:45:10.740

看起来像列名周围的错误转义/连接......

```
"SELECT SUM(column{$t}) AS value_sum FROM scoring WHERE ID='{$userID}' AND name ='{$name}'" 
```

那是你要的吗？

也使用[**PDO**](https://stackoverflow.com/questions/13569/mysqli-or-pdo-what-are-the-pros-and-cons)！

# actionscript-3 - 如何在 Flash Builder 中导入自己的包？

> ID：14714555
> 
> 赞同：0
> 
> 时间：2013-02-05T18:41:46.227
> 
> 标签：actionscript-3, flash, import, flash-builder, package

我是 Flash Builder 的新手，所以对于任何对 flash builder 和 actionscript 3.0 有一定经验的人来说，这都是一个简单的问题。

所以基本上我有一个包含 .as 文件的文件夹。它的目录是 -

```
...\src\assets\Stadium\MyClass 
```

现在我想在我的 Flash Builder 项目中使用它，但是当我像这样导入时 -

```
import assets.Stadium.MyClass.PrefabProject; 
```

有警告......请看下图。我怎么可能在我的 as3 代码中使用文件夹的内容。如何将文件夹用作包？

![点击这里查看图片](../Images/e4d39bcaabcba950e933a33373ba8ffd.png)

编辑：我继续尝试在代码中使用包中的东西 - 这是我得到的错误 -

```
A file found in a source-path must have the same package structure 'assets.Stadium.MyClass', as the definition's package, ''.   MyClass.as  /proj_away_alpha_new/src/assets/Stadium/MyClass Unknown Flex Problem 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:35:51.420

您在编辑中发布的错误似乎暗示您的`package`陈述`MyClass`是空的。该`package`语句应包含您的类所在的相同路径。

由于`MyClass.as`位于路径中（相对于您的项目）：`assets/Stadium/MyClass`

包声明（在 MyClass.as 的顶部）应该是相同的：

`package assets.Stadium.MyClass`

我可能错误地解释了该错误。只需确保 MyClass.as 中的 package 语句与磁盘上类文件的位置相同（相对于项目的 src 目录）。

PS：您使用空包语句的唯一时间是您的类驻留在那个特殊的“默认包”（您的主应用程序所在的位置）中。

# asp.net - 可搜索的文本框？

> ID：14714558
> 
> 赞同：0
> 
> 时间：2013-02-05T18:41:53.587
> 
> 标签：asp.net, textbox, ajaxcontroltoolkit

我想要两个文本框，一个大且只读，包含来自服务器的内容，另一个是一行并搜索第一个文本框。用户在 TextBox2 中输入的单词将在 TextBox1 中突出显示/加粗/任何内容。

例子：

文本框1：

> 这是我的只读文本**框**可能内容的一个示例。它会持续一堆线......

文本框2：

> 盒子

有什么办法可以做到这一点吗？我考虑过使用AjaxControlToolkit中的[AutoComplete TextBox ，并将服务路径设置为获取 TextBox1 内容的任何位置。](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/AutoComplete/AutoComplete.aspx)但这并不是我想要的，因为我想打断建议并使用它们来搜索 TextBox1。有任何想法吗？我对 asp.net 还是很陌生，只是四处寻找可以开始使用这个的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:04:35.283

我会推荐一个[这样的 JQuery 插件](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)。我认为它不适用于文本框，但您可以尝试。你必须为第一个使用文本框吗？如果它不起作用，你可以改用 DIV 吗？

使用示例：

```
$('target').highlight('box'); 
```

# javascript - jQuery获取数据并求和

> ID：14714561
> 
> 赞同：0
> 
> 时间：2013-02-05T18:42:09.267
> 
> 标签：javascript, jquery

我正在尝试做的是检查每个输入的价格，并从中得出一个总和。

这是我的代码

```
 function totalSum(e) {
    e.preventDefault();
    var unit = $("input:checked").parent("dt").siblings("dd").find("span"); 
    total = 0;
    $.each(unit, function(index, obj){
        total += parseInt($(obj).text(), 10);
    });
    $("#totalPrice").html('<span class="count">€ ' + total + '</span> â‚¬');
} 
```

每个单元都在其跨度内找到。Total 设置为 0。我尝试在每个检查的对象上调用 parseInt，然后将总数添加到 span 内。在 HTML 中，价格是这样表示的：

```
 <dd><span class="costo">€199</span></dd> 
```

如您所见，有欧元标记。恐怕无法解析，是这样吗？因为什么都没有改变！我应该怎么写？提前致谢

好吧，我感到很惭愧，但我无法让它发挥作用。我决定将代码放在最低限度，所以我尝试了这种方式

```
 <body>
    <div class="bla"><span class="count">1</span></div>
    <div class="bla"><span class="count">1</span></div>
    <div class="bla"><span class="count">1</span></div>

    <div id="total"></div>
    <script type="text/javascript" src="js/jquery-1.9.0.min.js" /></script> 
    <script>
    $(document).ready(function(){

    function sum() {
        var prices = $("div.bla").find(".count");
        total= 0;
        $.each(prices, function(index, obj){
    total += parseFloat($(obj).text());
});

$("#total").html('<span class="count">'+total +'</span> €');
    };

}); 
```

这应该工作，但没有出现。有人能这么好心地告诉我出了什么问题吗？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:44:47.510

您可以简单地从文本中删除单位：

```
var text = $(obj).text().replace(/[€\$]/,''); // add other units if needed
total += parseInt(text, 10); // are you sure you don't prefer parseFloat ? 
```

或者，如果您只想保留数字 and `+`，`-`请执行

```
var text = $(obj).text().replace(/[^\d\-\+]/g, ''); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:45:59.347

您可以替换任何非数字字符：

```
total += parseInt($(obj).text().replace(/[^\d.-]/, ''), 10); 
```

此外，您可以`unit.each()`代替`$.each(unit`，但这对您尝试执行的操作没有影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:45:48.643

更改您的 parseInt 以跳过第一个字符。

```
total += parseInt($(obj).text().substring(1),10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T01:19:59.637

经过几天的尝试和阅读最好的方法，我相信这可能是我试图实现的一个优雅的解决方案:)

```
$("input").on("click", function() {
    var j = $("input:checked");
    t = 0;
    $(j).each(function() {

        t += parseInt(this.value, 10);
    });
    $("#total").html("<span>€ " + t + "</span>");
    }); 
```

# tsql - 如果没有值，如何排除列显示？

> ID：14714562
> 
> 赞同：0
> 
> 时间：2013-02-05T18:42:09.043
> 
> 标签：tsql, ssms

关于我尝试在 SQL Server Management Studio 2008 中编写的查询的问题。我正在拉 2 行。第一行是标题信息，第二行是某个行项目的信息。请记住，实际的标题信息读作“Column 0, 1, 2, 3, 4,.... etc.”

数据看起来像这样：

```
ROW 1: Model # | Item Description| XS |  S  |  M  | L  | XL|
ROW 2:  3241   |  Gray Sweatshirt|    |  20 | 20  | 30 |   | 
```

基本上，这表明该特定项目有 20 个小件、20 个中件和 30 个大件。没有 XS 或 XL。

我想创建一个子查询，将这些信息放在一行中，但同时不包括具有空白数量的尺寸，如 XS 和 XL 尺寸下所示。

当一切都说完了，我希望它看起来像这样：

```
ROW 1: MODEL #| 3241 | ITEM DESCRIPTION | Gray Sweatshirt | S | 10 | M | 20 | L | 30 | 
```

请注意，不包括 XS 或 XL。我该怎么做才能使这些列不出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:23:16.630

由于您没有发布您的查询，也没有发布您的表结构，我猜它与列 ID、描述、大小有关。如果是这样，您可以这样做，只需用您的表和列名替换：

```
DECLARE @columns varchar(8000)    
SELECT @columns = COALESCE (@columns + ',[' + cast(Size as varchar) + ']', '[' + cast(Size as varchar) + ']' )
            FROM   YourTableName
            WHERE     COUNT(Size) > 0

            DECLARE @query varchar(8000) = 'SELECT Id, Description, '
                + @columns +'
                FROM
                (SELECT Id, Description, Size
                 FROM YourTableName) AS Source
                PIVOT
                (
                    COUNT(Size)
                    FOR Size IN ('+ @columns +')
                ) AS Pvt'

            EXEC(@query) 
```

无论如何，我也同意@MichaelFredickson。我已经实现了这个枢轴解决方案，但是在从 SQL 中提取原始数据之后让表示层来处理这个绝对更好。如果没有，您将处理数据两次，一次在 SQL 上创建表，另一次在演示文稿中使用您的 c#/vb/other 代码读取和显示值。

# postgresql - 通过终端连接 Postgresql - pgadmin

> ID：14714563
> 
> 赞同：3
> 
> 时间：2013-02-05T18:42:15.833
> 
> 标签：postgresql, connection, postgresql-9.1

我在连接（使用 SSH）到我的 virtualbox(ubuntu) postgres 服务器时遇到问题。我设置得很好而且正确。

PostgreSQL 设置：

*   `postgresql.conf`-> 允许所有传入连接 (*) 并设置 ssl TRUE
*   `pg_hba.con`f -> 经过大量更改后，我发现它似乎可以使用以下设置：

IP4

```
host all all 0.0.0.0/0 trust
hostssl all all 0.0.0.0/0 trust
host all all 192.168.x.x/32 trust 
hostssl all all 192.168.x.x/32 trust 
```

我试过了：

1.  在虚拟机上重新启动了我的 postgres 服务器。

2.  然后我去我的主机（Snow Leopard），建立一个到虚拟机（ubuntu）的ssh连接，它正在工作。

3.  在端口 5432 上 ping 我的访客机器也可以。

4.  在我的主机（雪豹）上打开 pgadmin -> 添加服务器 192.68.56.1 和数据库`pluto`，用户`pippo`。连接有效，我看到了数据库。

5.  尝试在雪豹中打开终端并执行以下命令：

    ```
    psql -h 192.168.56.1 -U pippo -d pluto 
    ```

    错误：

    ```
    psql: FATAL:  no pg_hba.conf entry for host "192.168.56.1", 
                  user "pippo", database "pluto", SSL off 
    ```

我也尝试通过我的 Java 程序进行连接，但遇到了同样的错误。
我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:20:16.063

`pgAdmin`默认情况下尝试使用和不使用 SSL 进行连接。

我怀疑您只尝试在*没有*SSL 的情况下通过 连接`psql`，而服务器似乎需要 SSL 进行连接。尝试：

```
psql "sslmode=require host=192.168.56.1 dbname=pluto" pippo 
```

[更多关于`sslmode`手册。](http://www.postgresql.org/docs/8.4/static/libpq-connect.html#LIBPQ-CONNECT-SSLMODE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-30T17:23:08.243

从命令行打开我的查询到 pgAdmin：

**-f**包含要在查询窗口中加载的 SQL 脚本的文件

**-qc**不带密码的连接字符串（也可以使用ssl连接）

```
"C:\Program Files\PostgreSQL\9.4\bin\pgAdmin3.exe" -f "C:\slqFiles\FindFunctionByName.sql" -qc "host=localhost port=5432 dbname=myDatabase user=postgres" 
```

密码将从位于应用程序文件夹中 的**密码文件中收集：** *%APPDATA%\postgresql\pgpass.conf*

您需要连接**权限**。尝试添加到 C:\Program Files\PostgreSQL\9.6\data\pg_hba.conf 下一行：

*托管所有所有 ::/0 信任*

# assembly - 查看单个位

> ID：14714564
> 
> 赞同：0
> 
> 时间：2013-02-05T18:42:20.977
> 
> 标签：assembly, mips

在 MIPS 汇编中，是否可以仅提取字符串的第 i 位和第 j 位，然后将这些单独的位放回其原始位置。

考虑：**1100**

提取：*第 2*位和*第 3*位并交换它们以获得结果**1010**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T01:30:49.613

查看 AND 真值表结果 r = a AND b

```
ab r
00 0
01 0
10 0
11 1 
```

看看这两个案例：

```
10 0
11 1 
```

任何与 1 相加的东西就是它本身，现在这两种情况

```
00 0
01 0 
```

任何与零相加的东西都是零。

用 4 位 abcd 提取 c 位，知道与与与零的这两个特征，与零与与与与任何事物与一。

```
 abcd
AND 0010
=========
    00c0 
```

我们已经隔离了位 c，我们不在乎它是零还是一位，我们已经隔离了它。与零相加的位被强制为零，与 1 相加的位保持不变。

同样，将 abcd 与 0100 与运算得到 0b00 隔离位 b。

所以现在我们有两个中间结果 0b00 和 00c0。你想交换他们的位置，移位会做到这一点，这取决于你的指令集（我知道你说 mips 但请遵循）一些指令集可能会在进位位中旋转或移位，而一些指令集可能会旋转或移位零或算术移位 vs逻辑移位可能会复制最高有效位而不是移入零。因此，您需要检查您正在使用的指令集中有哪些移位可用，如果零解决方案中没有干净的移位，那么您需要添加更多操作来清除移位的任何副作用。在这种情况下，我们要将 b 位向右移动一位，将 c 位向左移动一位，因此您需要查找和使用的操作是

```
0b00 >> 1 = 00b0
00c0 << 1 = 0c00 
```

现在这些位在正确的位位置我们有三件事

```
abcd
0c00
00b0 
```

所以我们有两个真值表要检查，一个是上面的 AND 真值表，我们知道任何与一相加的东西，任何与零相加的东西。另一个是 OR 真值表

```
ab r
00 0
01 1
10 1
11 1 
```

特别是前两个

```
00 0
01 1 
```

任何与零相或的东西都是它自己。并注意后两个

```
10 1
11 1 
```

任何与 1 的 OR 都是 1。

我们如何使用 AND 和 OR 来获取位？好吧，我们有两个选择，任何与 0 的 OR 都是它自己，另一个是任何与 1 的 AND 就是它自己。我们需要做的是操纵原始数字 abcd 并使其成为 a00d 或 a11d。这需要 AND 和 OR 表的另一半。与 0 相加的任何东西都是 0，与 1 相加的任何东西都是 1。所以要将 abcd 转换为 a00d，我们需要将其与 1001 相加

```
 abcd
AND 1001
=========
    a00d 
```

a 和 d 加 1 本身就是 b 和 c 加 0 是 0

另一种选择是

```
 abcd
OR  0110
=========
    a11d 
```

a 和 d 与 0 相或，因此它们不会改变 b 和 c 与 1 相或，因此这些位位置变为 1

最后一步是获取我们的其他中间值并将它们混合

```
 a00d
OR  0c00
=========  
    ac0d

    ac0d
OR  00b0
=========  
    acbd 
```

另一个选择更复杂，如果我们只是这样做

```
 a11d
AND 0c00
========
    0c00 
```

为了使用该身份，我们需要修改 0c00 并将其设为 1c11

```
0c00 OR 1011 = 1c11
1c11 AND a11d = ac1d
00b0 OR 1101 = 11b1
11b1 AND ac1d = acbd 
```

简而言之，传统的解决方案是用 1 来隔离，用 0 来清除位位置，然后或在新值中：

```
abcd AND 0100 = 0b00
abcd AND 0010 = 00c0
0b00 >> 1 = 00b0
00c0 << 1 = 0c00
abcd AND 1001 = a00d
a00d OR 0c00 = ac0d
ac0d OR 00b0 = acbd 
```

在 C 中，这将是这样的（这显示了您的临时变量）

```
//abcd is our original variable
tempb = abcd & 4;
tempc = abcd & 2;
tempb = tempb >> 1;
tempc = tempc << 1;
result = abcd & 9; 
result = result | tempc;
result = result | tempb;
//and finished, result contains the...result. 
```

您已经从 gusbro 那里得到了完整的答案，这是答案的一半，我假设使用逻辑运算的任务是问题的一半，问题的另一半是为相关指令集选择指令和寄存器（注意我是如何到目前为止已经解决了这个问题而无需指定指令集，因为此时我们可以使用任何指令集，每一步可能需要多条指令，但在这一点上它是通用的）。

请注意，这是一个四位解决方案，您可能会使用寄存器中超过四位的指令集，因此您需要知道在这些等式中的操作数左侧要添加哪些位，以免弄乱另一个位。

gusbro 使用的另一个我没有使用的身份是任何与自身异或的东西为零。他的两个异或运算可以用一个常数来实现，这取决于指令集可能需要多条指令或需要额外的内存周期。

这类工作的关键是理解这些逻辑身份并应用它们。当有人说（掩码和移位）掩码意味着与一个在您想要保留的位位置有一个的常量进行与运算时，然后移位将该位置于特定位置，例如，您想要采用 abcd 并将 c 位隔离在这样的结果是一个零或一个你会“掩盖和转移”

```
abcd AND 0010 = 00c0
00c0 >> 1 = 000c 
```

和是掩码，移位是移位，如果 c 为 0，则结​​果为 0，如果 c 为 1，则结果为 1。

同样你可以

```
abcd >> 1 = 0abc
0abc AND 0001 = 000c 
```

移位然后掩码。

你的家庭作业可以重新安排为

```
abcd >> 1 = 0abc
abcd << 1 = bcd0
0abc AND 0010 = 00b0
bcd0 AND 0100 = 0c00
abcd AND 1001 = a00d
00b0 OR 0c00 = 0cb0
a00d OR 0cb0 = acbd 
```

你可以开始看到这个主题的其他变化。这些变化可以根据您所针对的指令集转化为优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:54:01.350

您可以通过应用蒙版和班次来做到这一点。假设您的数据存储在寄存器中，要获得第 i 位，您将应用带有常数 2^i 的 AND 来清除除第 i 位之外的所有位。然后，您可以使用左移或右移轻松地将该位“移动”到其他位置。

现在，要交换 2 位将需要更多的摆弄。例如，您可以将这两个位提取到某些寄存器中，从原始寄存器中清除这些位，然后移动两个寄存器中的每一个以将它们定位在“交换”位置，最后对所有内容进行 OR。

例如：

```
 li $t0, 12         # Our constant, 1100b, is stored in $t0
  andi $t1, $t0, 2   # Mask the second bit and put it in $t1
  andi $t2, $t0, 4   # Mask the third bit and put it in $t2
  xor $t0, $t0, $t1  # Ensures the second bit $t0 is zero 
  xor $t0, $t0, $t2  # Ensures the third bit $t0 is zero 
  sll $t1, $t1, 1    # Moves $t1 one position to the left (second bit goes to third bit)
  srl $t2, $t2, 1    # Moves $t2 one position to the right (third bit goes to second bit)
  or $t1, $t1, $t2   # now we OR everything
  or $t0, $t0, $t1   # to get the final result, in this case 1010b 
```

# php - Kohana 路由（和重新路由）问题

> ID：14714578
> 
> 赞同：0
> 
> 时间：2013-02-05T18:43:16.177
> 
> 标签：php, kohana, kohana-3

我正在使用 PHP 5.5 和 Kohana 3.3

我正在开发一个网站结构，它始终将用户的语言偏好作为 uri 的第一个“项目”。

例如：

`mydomain.com/en/products` `mydomain.com/de/store`

现在，我确信一些用户会尝试并聪明地输入以下内容：

`mydomain.com/products`

很好，我只是希望他们被重新路由到

`mydomain.com/en/products`保持一切一致。

只要uri在URI中只有一个“目录”，我下面的代码就可以工作，例如

`mydomain.com/products`

`mydomain.com/store`

但不适用于 uris，例如以下子目录：

`mydomain.com/products/something` `mydomain.com/store/purchase/info`

这是我的路线：

```
Route::set('home_page', '(<lang>)')
    ->defaults(array(
        'controller' => 'Index'
    ));

Route::set('default', '(<lang>(/<controller>(/<action>(/<subfolder>))))')
    ->defaults(array(
        'controller' => 'Index',
        'action' => 'index'
    )); 
```

这是我的父控制器中的代码，每个其他控制器都继承自：

```
public function before()
        {           
            $this->uri = $this->request->uri();

            $this->lang = $this->request->param('lang');

            //If user directly inputted url mydomain.com without language information, redirect them to language version of site
            //TODO use cookie information to guess language preferences if possible
            if(!isset($this->lang))
            {
                $this->redirect('en/', 302);
            }

            //If the first part of path does not match a language redirect to english version of uri
            if(!in_array($this->lang, ContentManager::getSupportedLangs()))
            {
                $this->redirect('en/'.$this->uri, 302);
            }
          } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:25:54.910

您可以用这个替换给出的两条路线：

```
Route::set('default', '(<lang>/)(<controller>(/<action>(/<subfolder>)))',
array(
    'lang' => '(en|fr|pl)'
))
->defaults(array(
    'controller' => 'Index',
    'action' => 'index'
)); 
```

其中字符串 (en|fr|pl) 是您支持的语言的串联，即`'('.implode('|', ContentManager::getSupportedLangs()).')'`.

如果这个解决方案仍然晦涩难懂，我很乐意更详细地解释它，但我希望你能在反思中看到你的问题出现了，因为你的**第一**条路线 ,`home_page`与 eg 匹配`mydomain.com/products`。

你的控制器的`before()`功能也应该修改。重定向将无法正常工作，因为您最终将重定向到 eg `en/ru/Index`。那么为什么不保持简单并使用：

```
 public function before()
    {           
        $default_lang = 'en';
        $this->lang = $this->request->param('lang', $default_lang);
    } 
```

# android - 在nexus7上应用程序崩溃但适用于模拟器android

> ID：14714580
> 
> 赞同：0
> 
> 时间：2013-02-05T18:43:24.100
> 
> 标签：android, nexus-7

我创建了一个有 3 个按钮的主屏幕。其中之一是打开另一个页面，该页面在文本视图中显示我的数据库中的数据。它在我笔记本电脑上的模拟器上完美运行，但是当我将文件复制到我的 Nexus 7 时，该按钮会使应用程序崩溃。所有其他按钮工作正常。

这是代码，非常基本：

```
viewFlare = (Button)findViewById(R.id.bViewFlare);

viewFlare.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent openViewFlare = new Intent("com.example.project.SQLFLAREVIEW");
                startActivity(openViewFlare);
            }
        }); 
```

它调用此页面：

```
public class SQLFlareView extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        setContentView(R.layout.sqlflareview);

        TextView textView = (TextView) findViewById(R.id.tvSQLFlareinfo);

        Calms info = new Calms(this);
        info.open();
        //System.out.print("THIS IS THIS OPEN");
        String data = info.getFlareData();
        //System.out.print("ABOUT TO CLOSE");
        info.close();
        textView.setText(data);

    }
} 
```

如果有人有任何想法，我将非常感激，我已经为这个问题猛烈抨击了一段时间。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T20:27:02.003

改变这个：

```
Intent openViewFlare = new Intent("com.example.project.SQLFLAREVIEW"); 
```

对此：

```
Intent openViewFlare = new Intent(name_of_current_class.this, SQLFLAREVIEW.class"); 
```

# entity-framework - MVC 4 代码优先数据库初始化程序不起作用

> ID：14714581
> 
> 赞同：2
> 
> 时间：2013-02-05T18:43:24.300
> 
> 标签：entity-framework, asp.net-mvc-4, ef-code-first

由于数据库初始化失败，我不得不在不同的 MVC 4 代码优先技术教程的相同阶段停下来。

使用连接

```
<add name="DefaultConnection" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-DbTestApp-20130205173443;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-DbTestApp-20130205173443.mdf" providerName="System.Data.SqlClient" /> 
```

我什至无法创建或管理我想从我的模型中生成的数据库

```
public class Category
    {
        public int Id { get; set; }

        [Required]
        [MinLength(4)]
        [MaxLength(64)]
        public string Name { get; set; }

        public virtual IEnumerable<Article> Articles { get; set; }
    }

    public class Article
    {
        public int Id { get; set; }

        public int CategoryId { get; set; }
        public virtual Category Category { get; set; }

        [Required]
        [MinLength(4)]
        [MaxLength(64)]
        public string Title { get; set; }

        [Required]
        [MinLength(16)]
        [MaxLength(1024)]
        [DataType(DataType.MultilineText)]
        public string Content { get; set; }

        [Required]
        [Display(Name = "Post Anonymous?")]
        public bool IsAnonymous { get; set; }

        public int AuthorId { get; set; }
        public virtual Author Author { get; set; }

        public virtual IEnumerable<Comment> Comments { get; set; }

    }

    public class Author
    {
        public int Id { get; set; }

        [MinLength(3)]
        [MaxLength(64)]
        public string AuthorName { get; set; }

        public virtual IEnumerable<Article> Articles { get; set; }

        public virtual IEnumerable<Category> Categories { get; set; }
    }

    public class Comment
    {
        public int Id { get; set; }

        public int ArticleId { get; set; }
        public virtual Article Article { get; set; }

        [Required]
        [MinLength(3)]
        [MaxLength(64)]
        public string Author { get; set; }

        [MaxLength(64)]
        public string Title { get; set; }

        [Required]
        [MinLength(4)]
        [MaxLength(512)]
        public string Content { get; set; }
    } 
```

使用下面的上下文

```
 public class BlogContext : DbContext
    {
        public DbSet<Category> Categories { get; set; }
        public DbSet<Article> Articles { get; set; }
        public DbSet<Author> Authors { get; set; }
        public DbSet<Comment> Comments { get; set; }

        public BlogContext()
            : base("DefaultConnection")
        {
            Configuration.ProxyCreationEnabled = false;
        }
    } 
```

我还在 Global.asax Application_Start() 方法中设置了初始化程序：

```
Database.SetInitializer(new DropCreateDatabaseIfModelChanges<BlogContext>()); 
```

当我试图打电话时问题就来了

```
var articles = db.Articles.Include(a => a.Category).Include(a => a.Author); 
```

在我的 BlogController 的 Index() 方法中返回一个包含存储文章列表的视图。每次调用数据库相关方法时都会发生这种情况，错误消息是：

```
Model compatibility cannot be checked because the database does not contain model metadata. Model compatibility can only be checked for databases created using Code First or Code First Migrations. 
```

在教程中，我没有发现任何关于此类问题的信息，而我阅读的解决方案也无法解决问题。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:45:58.353

`DropCreateDatabaseIfModelChanges` requires there to be a previous model already in place before it will compare the two. To start up the database you'll need to use the `DropCreateDatabaseAlways` initializer.

# ios - 如何确定切换视图值是由用户交互还是由 IOS 中的代码更改的？

> ID：14714582
> 
> 赞同：0
> 
> 时间：2013-02-05T18:43:26.070
> 
> 标签：ios, objective-c, switch-statement, ibaction

我的 UI 上有一个切换视图，我想在其值更改时处理该事件。为此，我创建了一个 IBAction 方法来处理值更改事件。到现在为止还挺好。

我的问题是我无法确定更改是否由 - 代码（它可能发生在我的应用程序中） - 用户交互

我如何确定它是由用户交互还是由代码更改的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:45:46.873

仅通过代码完成时，是否有特定方法可以更改开关值？如果是这样，也许您可​​以使用该方法设置一个布尔值/标志来检查您何时需要决定/处理事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:48:24.647

在 Apple ScrollView / ScrollPages 示例中，他们有类似的情况：
他们必须决定事件是由自己（=代码）触发还是由用户触发。
他们只需设置一个变量（在以编程方式调用之前）来区分这两种情况。

# java - 几乎 JSON 的正则表达式，但不完全

> ID：14714584
> 
> 赞同：2
> 
> 时间：2013-02-05T18:43:35.723
> 
> 标签：java, regex

大家好，我正在尝试将一个格式良好的字符串解析为它的组件。该字符串非常类似于 JSON，但严格来说它不是 JSON。它们是这样形成的：

```
createdAt=Fri Aug 24 09:48:51 EDT 2012, id=238996293417062401, text='Test Test', source="Region", entities=[foo, bar], user={name=test, locations=[loc1,loc2], locations={comp1, comp2}} 
```

输出就像文本块一样，此时不需要做任何特别的事情。

```
createdAt=Fri Aug 24 09:48:51 EDT 2012 
id=238996293417062401 
text='Test Test' 
source="Region"
entities=[foo, bar] 
user={name=test, locations=[loc1,loc2], locations={comp1, comp2}} 
```

使用以下表达式，我可以将大部分字段分开

```
,(?=(?:[^\"]*\"[^\"]*\")*(?![^\"]*\"))(?=(?:[^']*'[^']*')*(?![^']*')) 
```

它将拆分所有逗号而不是任何类型的引号，但我似乎无法跳到它拆分逗号而不是括号或大括号的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:34:32.060

因为您要处理嵌套的括号/括号，所以处理它们的“正确”方法是分别标记它们，并跟踪您的嵌套级别。因此，对于不同的令牌类型，您确实需要多个正则表达式，而不是单个正则表达式。

这是 Python，但转换为 Java 应该不会太难。

```
# just comma
sep_re = re.compile(r',')

# open paren or open bracket
inc_re = re.compile(r'[[(]')

# close paren or close bracket
dec_re = re.compile(r'[)\]]')

# string literal
# (I was lazy with the escaping. Add other escape sequences, or find an
# "official" regex to use.)
chunk_re = re.compile(r'''"(?:[^"\\]|\\")*"|'(?:[^'\\]|\\')*[']''')

# This class could've been just a generator function, but I couldn;'t
# find a way to manage the state in the match function that wasn't
# awkward.
class tokenizer:
  def __init__(self):
    self.pos = 0

  def _match(self, regex, s):
    m = regex.match(s, self.pos)
    if m:
      self.pos += len(m.group(0))
      self.token = m.group(0)
    else:
      self.token = ''
    return self.token

  def tokenize(self, s):
    field = '' # the field we're working on
    depth = 0  # how many parens/brackets deep we are
    while self.pos < len(s):
      if not depth and self._match(sep_re, s):
        # In Java, change the "yields" to append to a List, and you'll
        # have something roughly equivalent (but non-lazy).
        yield field
        field = ''
      else:
        if self._match(inc_re, s):
          depth += 1
        elif self._match(dec_re, s):
          depth -= 1
        elif self._match(chunk_re, s):
          pass
        else:
          # everything else we just consume one character at a time
          self.token = s[self.pos]
          self.pos += 1
        field += self.token
    yield field 
```

用法：

```
>>> list(tokenizer().tokenize('foo=(3,(5+7),8),bar="hello,world",baz'))
['foo=(3,(5+7),8)', 'bar="hello,world"', 'baz'] 
```

这个实现有一些捷径：

*   字符串转义真的很懒惰：它只支持`\"`双引号字符串和`\'`单引号字符串。这很容易解决。
*   它只跟踪嵌套级别。它不*验证*括号是否与括号匹配（而不是括号）。如果您关心这一点，您可以更改`depth`为某种堆栈并将其推入/弹出括号/括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:36:50.663

您可以使用以下正则表达式来匹配您想要的块，而不是用逗号分割。

```
(?:^| )(.+?)=(\{.+?\}|\[.+?\]|.+?)(?=,|$) 
```

Python：

```
import re
text = "createdAt=Fri Aug 24 09:48:51 EDT 2012, id=238996293417062401, text='Test Test', source=\"Region\", entities=[foo, bar], user={name=test, locations=[loc1,loc2], locations={comp1, comp2}}"
re.findall(r'(?:^| )(.+?)=(\{.+?\}|\[.+?\]|.+?)(?=,|$)', text)

>> [
    ('createdAt', 'Fri Aug 24 09:48:51 EDT 2012'), 
    ('id', '238996293417062401'), 
    ('text', "'Test Test'"), 
    ('source', '"Region"'), 
    ('entities', '[foo, bar]'), 
    ('user', '{name=test, locations=[loc1,loc2], locations={comp1, comp2}}')
   ] 
```

我已经设置了分组，因此它将“键”和“值”分开。它会在 Java 中做同样的事情 - 在这里查看它在 Java 中的工作：

[http://www.regexplanet.com/cookbook/ahJzfnJlZ2V4cGxhbmV0LWhyZHNyDgsSBlJlY2lwZRj0jzQM/index.html](http://www.regexplanet.com/cookbook/ahJzfnJlZ2V4cGxhbmV0LWhyZHNyDgsSBlJlY2lwZRj0jzQM/index.html)

正则表达式解释：

*   `(?:^| )`匹配行首或空格的非捕获组
*   `(.+?)`匹配...之前的“key”
*   `=`等号
*   `(\{.+?\}|\[.+?\]|.+?)`匹配一组`{`字符`}`、`[`字符`]`或最后只是字符
*   `(?=,|$)`向前看，匹配 a`,`或行尾。

# django - 在 Django 单元测试中使用会话对象

> ID：14714585
> 
> 赞同：7
> 
> 时间：2013-02-05T18:43:37.223
> 
> 标签：django, session

我正在编写一个登录视图，并想为该视图添加一个单元测试。我的观点是这样的：

```
def login(request):

    if request.POST:
            usrname = request.POST.get('username')
            password = request.POST.get('password')
            user = authenticate(username=usrname, password=password)

            if user is not None:
                    auth_login(request, user)
                    return redirect('/core/home/')
            else:
                    context = {'error_message': "Invalid username or password"}
                    return render(request, 'core/login.html', context)
    else:
            c = {}
            c.update(csrf(request))
            return render_to_response('core/login.html',c)

def home(request):
    if request.user.is_authenticated():
        context = {'user' : request.user}
        return render(request, 'core/home.html', context)
    else:
        return render(request, 'core/login.html') 
```

我的单元测试如下所示：

```
class CoreViewTests(TestCase):
    def setUp(self):
            self.factory = RequestFactory()

    def test_login_view_with_valid_user(self):
            uf = UserFactory()
            user = uf.make_user("ValidUser1", "12345", "user@abc.com")
            self.assertEqual(user.username, "ValidUser1")
            request = self.factory.post('/core/login', {"username": "ValidUser1", "password": "12345"})
            response = login(request)
            self.assertEqual(response.status_code, 200) 
```

单元测试崩溃，因为他们找不到会话对象。我通过定义一个虚拟会话字典来遵循网站上的几个教程，但它没有帮助。

谁能告诉我如何为需要处理会话对象的视图编写单元测试？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T19:50:07.830

从`RequestFactory`对象的文档中：

> 它不支持中间件。如果视图正常运行需要，会话和身份验证属性必须由测试本身提供。

`request.session`正如您所说，您可以尝试手动设置为包含适当内容的字典。不过，使用老式的[Django 测试客户端](https://docs.djangoproject.com/en/dev/topics/testing/overview/#module-django.test.client)可能会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-19T06:32:00.750

像这样：request.session = {'num_visits': 0}

# ios - iOS：将大区域设置为 MKMapView 时应用程序崩溃

> ID：14714587
> 
> 赞同：1
> 
> 时间：2013-02-05T18:43:48.933
> 
> 标签：ios, objective-c

我必须做错事，我的代码如下：

```
[_mapView setRegion:region animated:YES]; 
```

当我为它设置一个非常大的区域时，该应用程序在 5.0、5.1 和 6.1 模拟器中崩溃。

该地区的中心是

*   纬度：39.0055301546386
*   伦敦：-96.8836582904965
*   跨度：纬度 75382.1245843343 经度 96613.0758612126

然后我将代码更改为

```
[_mapView setRegion:[_mapView regionThatFits:region] animated:YES]; 
```

该代码适用于 OS 5.0、5.1，但在 OS 6.1 上仍会崩溃。

任何想法？

*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Invalid Region ' *** First throw call stack: (0x2570012 0x206ee7e 0x25f8fb1 0x1f8078d 0xab41f 0xc8a1c7 0xc8a232 0xc8a4da 0xca18e5 0xca19cb 0xca1c76 0xca1d71 0xca289b 0xca2e93 0xca2a88 0xffee63 0xff0b99 0xc8add2 0x91456 0xd7f23 0x2082705 0xbac2c0 0xbac258 0xc6d021 0xc6d57f 0xc6c6e8 0xe701d3 0x2538afe 0x2538a3d 0x25167c2 0x2515f44 0x2515e1b 0x2c227e3 0x2c22668 0xba8ffc 0x4c2fd 0x2725 0x1）libc++abi.dylib：终止调用抛出异常

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:53:20.557

我怀疑这个区域的“跨度”是`75382.1245843343`引发`96613.0758612126`问题的原因。该地区将覆盖一个周长超过 800 万公里的世界——而不是我们自己的世界。尝试使用实际定义地球上一个区域的较小跨度？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:06:52.833

您应该从 API 返回的跨度中减去一些纬度/经度

# vbscript - 在 VBScript 变量中无法识别回车（从 SQL Server 传递）

> ID：14714590
> 
> 赞同：0
> 
> 时间：2013-02-05T18:44:01.880
> 
> 标签：vbscript

我有一个接受各种参数的 VBScript 文件，其中一个是来自 SQL Server 中 varchar(max) 字段的文本字符串，在脚本中用作电子邮件的 .HTMLBody。

但是，在创建和显示电子邮件消息时，所有文本都混杂在一起，由于忽略了所有换行符，因此阅读起来有些困难。

实际的脚本是从 Java 应用程序调用的，如下所示：

```
Runtime.getRuntime().exec(arguments) 
```

其中 arguments 是传入 VBScript 文件的参数列表，它也是参数字符串的一部分，如下所示：

```
wscript filepath\sendEmail + arguments 
```

每个参数都用引号括起来，以分割 VBScript 文件中的每个唯一参数，该文件的结构如下：

```
Set objArgs = WScript.Arguments
Arg1 = objArgs(0)
...
Set MyApp = CreateObject("Outlook.Application")
...
.HTMLBody = Arg8 
```

非常感谢您提供的任何帮助。

-布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:33:39.693

根据[HTMLBody Property 的这个文档](http://msdn.microsoft.com/en-us/library/office/aa171418%28v=office.11%29.aspx)，`.HTMLBody`处理 HTML：

```
.HTMLBody = "<HTML><BODY>Enter the message text here. </BODY></HTML>" 
```

由于空格在 HTML 中的重要性降低，您应该用`<br>`（或`<br />`）替换（无论如何）输入文本的行尾。

# mysql - MySQL EXISTS 和 ORDER BY

> ID：14714591
> 
> 赞同：0
> 
> 时间：2013-02-05T18:44:02.627
> 
> 标签：mysql, sql, subquery

我有两个表“评论”和“喜欢”，我可以显示所有被喜欢的评论，并在添加评论时对它们进行排序。我目前似乎无法做的是根据评论被喜欢的时间来排序。

这就是我目前所拥有的：

```
SELECT * 
FROM comments AS c 
WHERE EXISTS (
    SELECT * 
    FROM likes AS l 
    WHERE c.commentID=l.commentID) 
```

任何人都可以帮助我使用 SQL 来按顺序显示评论以及最近最喜欢的评论，依此类推...

只是添加 - 我只想显示一次评论，避免显示任何未被喜欢的评论。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:47:53.803

你想加入表格。

```
SELECT comments.*
FROM comments JOIN likes ON comments.commentID = likes.commentID
GROUP BY comments.commentID
ORDER BY MAX(likes.date) DESC; 
```

使用`JOIN`评论和喜欢的所有字段创建行。如果您使用`LEFT JOIN`它，它将包含未被喜欢的评论，但使用纯文本`JOIN`应该可以满足您的需求。

折叠行，`GROUP BY`因此每个评论只有一个。

按类似日期对`ORDER BY`行进行排序。我之所以使用`MAX(likes.date)`，是因为每条评论可能会有很多喜欢的日期，并且您想选择一个特定的日期。您也可以尝试`MIN(likes.date)`，具体取决于您要查找的内容（最近喜欢与首次喜欢）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T18:51:28.110

如果您对给定评论有多个喜欢，那么您需要一个聚合，例如：

```
SELECT c.*
FROM comments c join
     (select l.commentId, MIN(likedate) as FirstLikeDate, MAX(likedate) as MaxLikeDate
      from likes l
      group by l.commentId
     ) l
     on c.commentId = l.CommentId
order by MaxLikeDate desc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:52:20.590

由于您只想显示喜欢的评论，您可以这样做：

```
SELECT * FROM comments INNER JOIN likes USING(commentID) ORDER BY like_date DESC; 
```

# php - 将 PHP 的伪代码转换为 Tornado/Python

> ID：14714594
> 
> 赞同：2
> 
> 时间：2013-02-05T18:44:08.623
> 
> 标签：php, python, tornado

我非常习惯于使用 PHP——创建一个新的 .php 文件，输入所有内容，将其与一些 HTML 混合，包含/需要不同的 .php/.html 文件等。

我刚开始学习使用 Tornado，我很难理解 Tornado 的基本原理和构造。

为了开始了解 Tornado 的具体工作原理（是的，当然，除了阅读他们的文档之外），我尝试在 PHP 中获取一些基本的东西并在 Tornado 中重新创建它。

例如，在 PHP 中，我有我的`index.php`页面。在那个页面上，我有一个`email`输入和`password`输入。当用户提交表单时，`action`设置为`login.php`，我们将被发送到`login.php`调用“登录函数”的位置，该函数对用户进行身份验证。如果一切正常，`$_SESSION`则设置变量并登录。如果出现错误，则会出现错误消息`login.php`

与 Tornado 相关的等效“伪代码”是什么？

一些基本的、非常不完美的python：

```
import os

import tornado.web
import tornado.ioloop

root = os.path.dirname(__file__)
port = 8888

class MainHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("index.html")

class LoginHandler(tornado.web.RequestHandler):
    def get(self):
        self.render("login.html", title="Login to your account!")

    def post(self):
        useremail = self.get_argument("useremail", None)
        password = self.get_argument("password", None)
        self.render("login.html", title="Login to your account!")

def main():
    application = tornado.web.Application([
        (r"/", MainHandler),
        (r"/login", LoginHandler),
        (r"/css/(.*)", tornado.web.StaticFileHandler, {"path": os.path.join(root, 'css')}),
        (r"/pictures/(.*)", tornado.web.StaticFileHandler, {"path": os.path.join(root, 'pictures')}),
    ])
    application.listen(port)
    tornado.ioloop.IOLoop.instance().start()

if __name__ == "__main__":
    main() 
```

非常感谢我在此处转换的任何帮助。这只是一种与我习惯的非常不同的做事方式，像这样的简单过程的伪代码肯定会有所帮助。无论如何，谢谢大家。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-01-22T06:04:06.853

您可以使用PHP 将其作为事件驱动的非阻塞 I/O[反应。](http://reactphp.org/)

下面是一个简单的 HTTP 服务器监听 1337 端口的例子：

```
<?php

  $i = 0;

  $app = function ($request, $response) use (&$i) {
      $i++;

      $text = "This is request number $i.\n";
      $headers = array('Content-Type' => 'text/plain');

      $response->writeHead(200, $headers);
      $response->end($text);
 };

 $loop = React\EventLoop\Factory::create();
 $socket = new React\Socket\Server($loop);
 $http = new React\Http\Server($socket);

 $http->on('request', $app);

 $socket->listen(1337);
 $loop->run(); 
```

# javascript - jQuery 选择器

> ID：14714604
> 
> 赞同：0
> 
> 时间：2013-02-05T18:44:30.433
> 
> 标签：javascript, jquery, html

我有以下 HTML 表：

```
<table class="display" style="width: 1000px;" id="failoverServers">
    <thead>
        <tr>
            <th class="row_selector_head"> <input type='checkbox' class='select_all_chkbx'/></th>
            <th><div>{% trans "IP ADDRESS" %}</div></th>
            <th><div>{% trans "VIRTUAL IP ADDRESS" %}</div></th>
            <th><div>{% trans "USERNAME" %}</div></th>
            <th><div></div></th>
        </tr>
    </thead>

    <tbody>
    {% for i in list %}
        <tr rel="{{ i.id }}">
            <td class="row_selector"><input type='checkbox'/></td>
            <td rel="ip">{{ i.ipAddress }}</td>
            <td rel="virtualIP">{{ i.virtualIpAddress }}</td>
            <td rel="username">{{ i.username }}</td>

        </tr>
    {% endfor %}

    </tbody>
</table> 
```

如果我执行以下操作：

```
var list = "";
            $('#failoverServers td.row_selector.selected').each(function() {
            var row = $(this).closest('tr');
            var id = row.attr('rel');
            list += id + " ";           
        }); 
```

然后我在第一个复选框列中有一个数字列表。

我想从表中获取以下列表：

```
<td rel="ip">{{ i.ipAddress }}</td> 
```

我为此使用什么 jquery 选择器？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:50:09.537

尝试这个：

```
var list = [];

$('#failoverServers td.row_selector.selected').each(function() {
    var row = $(this).closest('tr');
    list.push($(row).children("td[rel=ip]")[0].text());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:19:56.487

感谢所有的评论。我有以下工作：

```
 var list = [];
  $('#failoverServers td.row_selector.selected').each(function() {
        var row = $(this).closest('tr');
        var serverIp = row.find('td[rel=ip]').text();
        list += serverIp + " ";         
    }); 
```

我想要做的是从表中获取所有 ip 项目，无论它们是被选中的还是现在（只是得到它们）我该怎么做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T09:22:08.137

这是您的工作示例（静态以便我可以测试）。相应地放置您的模板占位符并更改您的标记（如果您想成为标准兼容）：您的表头包含 5 个单元格，但行中的 td 只有 4 个，不应将 div 放置在 td s 中 - 我的 IDE 正在尖叫 :)而这些'rel's - 你为什么使用它们 - rels 应该在链接中使用。我认为“id”和“class”足以实现您需要的一切（“id's”用于独特元素，“class”用于您想要的任意数量）。

```
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="jquery181min.js" type="text/javascript"></script>
        <script>

        $(document).ready(function(){

        var values = '';    
            $('input:checkbox:checked.row_selector').parent().siblings(".ip").each(function() {
            values += '  ' + $(this).text();    
            });

        console.log(values);
        });    

        </script>
    </head>
    <body>

        <table class="display" style="width: 1000px;" id="failoverServers" border =1>
        <thead>
            <tr>
                <th class="row_selector_head"> <input type='checkbox' name="name" value="asdf" class='select_all_chkbx' checked="checked"/></th>
                <th>IP Address</th>
                <th>Virtual Ip Address</th>
                <th>Username</th>
            </tr>
        </thead>

        <tbody>
            <tr id="id1">
                <td><input class="row_selector" type='checkbox' name="name" value="val1" checked="checked" /></td>
                <td class="ip">123.123.123.123</td>
                <td class="virtualIP">55.55.55.55</td>
                <td class="username">Jean Valzean</td>
            </tr>
            <tr id="id2">
                <td><input class="row_selector" type='checkbox' name="name" value="val2"/></td>
                <td class="ip">125.125.125.124</td>
                <td class="virtualIP">22.22.22.22</td>
                <td class="username">Peter Meter</td>
            </tr>
                    <tr id="id3">
                <td><input class="row_selector" type='checkbox' name="name" value="val3" checked="checked" /></td>
                <td class="ip">192.168.33.24</td>
                <td class="virtualIP">33.33.33.33</td>
                <td class="username">Joe Schmoe</td>
            </tr>
        </tbody>
        </table>
    </body>
</html> 
```

结果是： ![jquery选中的td数据检索结果](../Images/d48a48301c2112ba7938ca52738f0249.png)

# javascript - jQuery - Div 跟随 touchmove/mousemove + 自动对齐

> ID：14714615
> 
> 赞同：3
> 
> 时间：2013-02-05T18:45:11.963
> 
> 标签：javascript, jquery, html, touch, mousemove

我想在我的 jQuery 脚本中创建一个非常简单的函数。当手指/光标触摸/点击屏幕时，我希望页面随着手指/光标的移动而水平滑动。我知道有很多人创建了很多插件，但我真的不需要其他人的解决方案。该图像是我的 HTML 外观的可视化视图。这真的很简单。

jQuery sciprt 显然不正确，但我希望它能让您了解我需要的简单功能。我没有额外的课程或淡入淡出功能或任何东西。

```
$(document).live('touchmove' or 'mousemove', function() {
    $('div[class=page_*], div[class=page_^]').[follow movements horizontally, and auto align to nearest edge when let go.];
}); 
```

我也希望能够对一个大 div 做同样的事情，所以移动元素的宽度变量可能应该等于`$(window).width();`. 实际上，我认为这将是最好的主意。我总是可以在大 div 中放入更多内容并使其更大，所以保持它。它应该更简单，并且只关注一个元素。

![数字](../Images/8dd17d07a70779c8ee3b0f8dc950295f.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T13:29:10.183

所以，这是我的解决方案。我进行了一些更改，现在您可以拥有超过 3 页。此外，我还定义了一个名为**threshold**的变量，设置为页面的一半。如果您希望阈值大于或小于页面的 hakf，则必须进行更多更改。

**HTML 代码：**

```
<div class="container">
    <div class="wrap">
        <div class="page page1"></div>
        <div class="page page2"></div>
        <div class="page page3"></div>
        <div class="page page4"></div>
    </div>
</div> 
```

**代码：**

```
.container, .page, .wrap {
    width: 300px;
    height: 400px;
}
.container {
    background: #efefef;
    box-shadow: 0px 0px 10px black;
    overflow: hidden;
    position: relative;
    margin: 5px auto;
}
.wrap {
    width: 1200px;
    position: absolute;
    top: 0;
    left: 0;
}
.page {
    float: left;
    display: block;
    -moz-user-select: none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
}
.page1 {
    background: yellow;
}
.page2 {
    background: green;
} 
.page3 {
    background: blue;
}
.page4 {
    background: red;
} 
```

至于 CSS 代码，请记住，如果您想更改**页面**大小，您还必须更改**容器**和**包装**大小。

**JS代码：**

```
var mouseDown = false, right;
var xi, xf, leftX = 0;
var nPages = $(".page").size();
var pageSize = $(".page").width();
var threshold = pageSize/2;
var currentPage = 0;

$(".container").on("mousedown", function (e) {
    mouseDown = true;
    xi = e.pageX;
});

$(".container").on("mouseup", function (e) {
    if (mouseDown) {
        mouseDown = false;
        xf = e.pageX;
        leftX = parseInt($(".wrap").css("left").split("px")[0]);
        if ((e.pageX - xi) < -threshold || (e.pageX - xi) > threshold) {
            setFocusedPage();
        } else {
            restore();
        }
    }
});

$(".container").on("mouseleave", function (e) {
    if (mouseDown) {
        mouseDown = false;
        xf = e.pageX;
        leftX = parseInt($(".wrap").css("left").split("px")[0]);
        if ((e.pageX - xi) < -threshold || (e.pageX - xi) > threshold) {
            setFocusedPage();
        } else {
            restore();
        }
    }
});

$(".container").on("mousemove", function (e) {
    if (mouseDown) {
        $(".wrap").css({
            "left": (leftX + (e.pageX - xi))
        });
        right = ((e.pageX - xi) < 0) ? true : false;
    }
});

function restore() {
    $(".wrap").stop().animate({
        "left": -(currentPage * pageSize)
    }, 200, function () {
        leftX = parseInt($(".wrap").css("left").split("px")[0]);
    });
}

function setFocusedPage() {
    if (leftX >= (-threshold)) { // First Page
        currentPage = 0;
    } else if (leftX < (-threshold) && leftX >= (-(nPages + 1) * threshold)) { // Second to N-1 Page
        (right) ? currentPage++ : currentPage--;
    } else if (leftX < -((nPages + 1) * threshold)) { // Third Page
        currentPage = nPages - 1;
    }
    $(".wrap").stop().animate({
        "left": -(currentPage * pageSize)
    }, 200, function () {
        leftX = parseInt($(".wrap").css("left").split("px")[0]);
    });
} 
```

请记住，如果您想要不同的**阈值**，则必须进行一些更改，尤其是在**`setFocusedPage()`**函数中。

这是我的最后一个[**DEMO**](http://jsfiddle.net/Dim13i/RjTTx/7/)

# ruby - 解析和编写 YAML

> ID：14714616
> 
> 赞同：2
> 
> 时间：2013-02-05T18:45:19.320
> 
> 标签：ruby, yaml, middleman

我有一个我似乎无法解决的基本问题。

我想在 YAML 文件中存储一小组 Quote，然后使用 Ruby Middlemanapp 在网站中迭代它。我不确定这是我的 YAML 文件组合还是我试图通过它迭代的方式或两者兼而有之。

YAML (quotes.yml)

```
---
quote: "This is a quote"
attribution: "Kate Something"
extras: "Braintree"
---
quote: "Blah blah"
attribution: "Donna Doe"
extras: "Essex"
---
quote: "Blah blah"
attribution: "Donna Doe"
extras: "Essex" 
```

再培训局

```
<% data.quotes.each do |f| %>
  <%= f["quote"] %> #f.quote <%= f["attribution"] %> 
<% end %> 
```

如果我只使用 <%= f %> 如果一个接一个地获取所有项目，而不管键如何，但找不到迭代它们并指定我想要的键或字段的方法。

[http://middlemanapp.com/advanced/local-data/](http://middlemanapp.com/advanced/local-data/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:47:21.533

在 Yaml中，`---`在 Yaml 流中启动一个新文档，因此在您的文档中`quotes.yaml`有三个单独的文档，而您只阅读第一个文档。

我认为你想要的是这样的：

```
- quote: "This is a quote"
  attribution: "Kate Something"
  extras: "Braintree"

- quote: "Blah blah"
  attribution: "Donna Doe"
  extras: "Essex"

- quote: "Blah blah"
  attribution: "Donna Doe"
  extras: "Essex" 
```

这是包含地图列表的单个 Yaml 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T20:09:57.900

问题是您的 YAML 文件格式。

`---`是文档的标记。`YAML.load`并且`YAML.load_file`不想阅读多个文档，只阅读第一个，因此您需要采取不同的轨道。

尝试`YAML.load_documents(File.read('quotes.yml'))`改用：

```
irb(main):005:0> asdf = YAML.load_documents(File.read('quotes.yml'))
[
    [0] {
              "quote" => "这是一个报价",
        “归属” => “凯特某事”，
             “附加” => “布伦特里”
    },
    [1] {
              "报价" => "废话",
        “归属” => “唐娜·多伊”，
             “附加”=>“埃塞克斯”
    },
    [2] {
              "报价" => "废话",
        “归属” => “唐娜·多伊”，
             “附加”=>“埃塞克斯”
    }
]

```

换句话说，您将收到特定数据文件的哈希数组。每个数组元素都是一个不同的文档，被解析回它的 Ruby 对象。

# visual-studio - VS2012 无法更新或卸载 NuGet 包管理器

> ID：14714619
> 
> 赞同：46
> 
> 时间：2013-02-05T18:45:25.693
> 
> 标签：visual-studio, visual-studio-2012, nuget

我无法更新或卸载 Visual Studio 2012 的 NuGet 包管理器。我查看了多种解决方案，但没有找到一个可行的。

*以管理员身份*运行 Visual Studio 2012 ...

尝试更新 NuGet 包管理器失败，并在日志末尾收到此错误对话框，并显示以下内容：

![在此处输入图像描述](../Images/ed985db8c7fda9dc5d14bec7ccb8a0fc.png)

> 2013 年 2 月 5 日上午 10:38:09 - 开始安装 Microsoft Visual Studio Ultimate 2012 的扩展... 2013 年 2 月 5 日上午 10:38:09 - 将“NuGet 包管理器”版本 2.0.30625.9003 升级到版本2.2.31210.9045。2013 年 2 月 5 日上午 10:38:10 - 安装错误：System.IO.IOException：该进程无法访问该文件，因为它正被另一个进程使用。在 System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) 在 System.IO.__Error.WinIOError() 在 System.IO.File.InternalMove(String sourceFileName, String destFileName, Boolean checkHost) 在 Microsoft.VisualStudio.ExtensionManager。 ExtensionManagerService.AtomicallyDeleteFiles(IEnumerable `1 filePaths, Boolean justMarkForDeletion) at Microsoft.VisualStudio.ExtensionManager.ExtensionManagerService.DeleteDiscoverableFiles(IInstalledExtension extension) at Microsoft.VisualStudio.ExtensionManager.ExtensionManagerService.UninstallInternal(IInstalledExtension extension, Boolean forceDelete) at Microsoft.VisualStudio.ExtensionManager.ExtensionManagerService.CommitInstalledAndUninstalledExtensions(IEnumerable`1 installedExtensions, IEnumerable`1 uninstalledExtensions, IEnumerable`1 packComponentChanges) 在 Microsoft.VisualStudio.ExtensionManager.ExtensionManagerService.BeginInstall(IInstallableExtension installableExtension, Boolean perMachine, AsyncOperation asyncOp) 在 Microsoft.VisualStudio.ExtensionManager.ExtensionManagerService.InstallWorker(IInstallableExtension extension, Boolean perMachine, AsyncOperation asyncOp)

随后弹出一个告诉我：

> 该进程无法访问该文件，因为它正被另一个进程使用。

![在此处输入图像描述](../Images/1717005b73c6c8759f6c7faf122e2d97.png)

当我尝试首先卸载扩展程序时（根据[某些解决方案](https://stackoverflow.com/questions/8483624/nuget-package-manager-errors-when-trying-to-update)），我收到与上面相同的弹出消息，告诉我正在使用该进程！

我为使其正常工作而采取的步骤：

1.  我已经多次重新启动 VS2012，加载和不加载项目。
2.  我已经重新启动了几次计算机，除了 VS2012 之外什么都没有启动。
3.  我已经从网上下载了 NuGet 安装程序，并尝试在不启动 VS2012 的情况下安装它（重启后的第一件事）。

对于第 3 步，我收到与尝试在 Visual Studio 2012 中更新时相同的一系列对话框/错误。

无论我尝试什么，我都无法获得最新版本！有人有其他技巧吗？

我还注意到 NuGet 现在根本无法正常工作。“包管理器控制台”或“包管理器设置”都不做任何事情。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-10-18T09:21:07.197

资源：

*   [http://www.paraesthesia.com/archive/2013/07/30/upgrading-nuget-the-process-cannot-access-the-file-because-it.aspx](http://www.paraesthesia.com/archive/2013/07/30/upgrading-nuget-the-process-cannot-access-the-file-because-it.aspx)

这对我有帮助：

1.  关闭 Visual Studio 的所有实例。
2.  转到您的全局 Visual Studio 扩展文件夹。NuGet 不会安装在您的每个用户文件夹中；相反，您会在 Program Files 中看到它。类似于：C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions
3.  看那个文件夹。你会看到很多随机命名的文件夹，比如“sdjfksiov.djd”等等。其中大多数（如果不是全部）是 NuGet。您需要知道哪些是 NuGet，哪些不是，尤其是在您安装了其他扩展的情况下。（您可以判断它是否是 NuGet，因为其中会有一堆 NuGet.*.dll 文件。如果您在其中看不到 NuGet 的东西，您会想要保留它。）
4.  将该 Extensions 文件夹重命名为：C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions_RENAMED
5.  直接从 Visual Studio 扩展库下载 NuGet。
6.  执行刚刚下载的 NuGet.Tools.vsix 文件。不要通过 Visual Studio 执行此操作。只需双击 .vsix 文件即可安装它。
7.  NuGet 应该成功安装。作为该安装的一部分，它将再次创建 Extensions 文件夹，因此您将再次看到 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\Extensions
8.  打开重命名的扩展文件夹并将所有非 NuGet 扩展移动到新的扩展文件夹中。
9.  现在打开 Visual Studio。您应该会看到新版本的 NuGet 已安装并正常工作。
10.  确认一切正常后，您可以删除重命名的 Extensions 文件夹。
11.  下载 VSIX 并右键单击取消阻止文件并再次安装

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-07-05T04:43:25.573

我正在使用 VS2010，我最终通过“添加删除程序”卸载 NuGet 包管理器来解决此问题，然后删除此目录：

```
C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\Extensions\Microsoft Corporation\Nuget Package Manager 
```

然后我就可以运行 NuGet.Tools.vsix 了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-06T06:13:34.877

我安装了 VS 2013 Pro。为我解决这个问题的方法是重新启动到安全模式并在那里重新安装 NuGet。

您可能还想在下面的链接中查看 Adam D 的帖子（插件被反恶意软件阻止）：

[VS2012 无法更新或卸载 NuGet 包管理器](https://stackoverflow.com/questions/14714619/cant-update-or-uninstall-nuget-package-manager-in-vs2012)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-25T21:13:50.257

[我在https://kc.mcafee.com/corporate/index?page=content&id=KB85636&snspd-1015&locale=en_GB&viewlocale=en_GB](https://kc.mcafee.com/corporate/index?page=content&id=KB85636&snspd-1015&locale=en_GB&viewlocale=en_GB)找到了解决此问题的方法

**原因：**

Microsoft Visual Studio (VS) 进程 devenv.exe 必须在 EEFF/FRP 进程排除注册表项中排除。

**解决方案：** 遇到此问题的用户必须联系英特尔安全技术支持并引用此文章编​​号，以获得将 devenv.exe 进程添加到正确的 EEFF/FRP 进程排除注册表项的帮助。

# html - 防止文本在复选框下换行

> ID：14714621
> 
> 赞同：35
> 
> 时间：2013-02-05T18:45:40.973
> 
> 标签：html, css, layout, checkbox

我正在布置一组复选框，如果文本太长，我会遇到一个古老的问题，即文本在复选框下方换行。

我的 HTML：

```
<div class="right">
    <form id="updateProfile">
        <fieldset class="checkboxes">
            <p>4\. What is your favorite type of vacation?</p>
            <label><input type="checkbox" name="vacation" value="Ski Trips"> Ski Trips</label>
            <label><input type="checkbox" name="vacation" value="Beach Visits"> Beach Visits</label>
            <label><input type="checkbox" name="vacation" value="Cruises"> Cruises</label>
            <label><input type="checkbox" name="vacation" value="Historical and educational trips"> Historical and educational trips</label>
            <label><input type="checkbox" name="vacation" value="Yachting"> Yachting</label>
            <label><input type="checkbox" name="vacation" value="Road Trip"> Road Trip</label>
            <label><input type="checkbox" name="vacation" value="Spa Weekend"> Spa Weekend</label>
            <label><input type="checkbox" name="vacation" value="Bed and Breakfast"> Bed and Breakfast</label>
            <label><input type="checkbox" name="vacation" value="Stay home and relax"> Stay home and relax</label>
            <label><input type="checkbox" name="vacation" value="Gambling Trips"> Gambling Trips</label>
            <label><input type="checkbox" name="vacation" value="Volunteer"> Volunteer</label>
        </fieldset>
    </form>
</div> 
```

我的 CSS：

```
div.right{width:580px;}

form#updateProfile fieldset label{
    display: block;
    margin-bottom: 5px;
    font-size: 16px;
    float: left;
    width: 33%;
} 
```

在这里查看我的小提琴：http: [//jsfiddle.net/fmpeyton/7WmGr/](http://jsfiddle.net/fmpeyton/7WmGr/)

在不同的网站上进行大量搜索后，我似乎无法找到合理的解决方案。我愿意接受有关更改我的标记/样式的建议，但我希望尽可能保持代码的简洁和语义化。

谢谢！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-05T23:06:21.320

这似乎有效：

[http://jsfiddle.net/7WmGr/5/](http://jsfiddle.net/7WmGr/5/)

我给了`label`18px`margin-left`的 a`margin-left`和 -18px 的复选框 a。

似乎适用于 Chrome 和 IE9。

```
div.right {
  width: 598px;
}

form#updateProfile fieldset label {
  display: block;
  margin-bottom: 5px;
  font-size: 16px;
  float: left;
  width: 30%;
  margin-left: 18px;
}

form#updateProfile fieldset label input[type='checkbox'] {
  margin-left: -18px;
}
```

```
<div class="right">
  <form id="updateProfile">
    <fieldset class="checkboxes">
      <p>4\. What is your favorite type of vacation?</p>
      <label><input type="checkbox" name="vacation" value="Ski Trips"> Ski Trips</label>
      <label><input type="checkbox" name="vacation" value="Beach Visits"> Beach Visits</label>
      <label><input type="checkbox" name="vacation" value="Cruises"> Cruises</label>
      <label><input type="checkbox" name="vacation" value="Historical and educational trips"> Historical and educational trips</label>
      <label><input type="checkbox" name="vacation" value="Yachting"> Yachting</label>
      <label><input type="checkbox" name="vacation" value="Road Trip"> Road Trip</label>
      <label><input type="checkbox" name="vacation" value="Spa Weekend"> Spa Weekend</label>
      <label><input type="checkbox" name="vacation" value="Bed and Breakfast"> Bed and Breakfast</label>
      <label><input type="checkbox" name="vacation" value="Stay home and relax"> Stay home and relax</label>
      <label><input type="checkbox" name="vacation" value="Gambling Trips"> Gambling Trips</label>
      <label><input type="checkbox" name="vacation" value="Volunteer"> Volunteer</label>
    </fieldset>
  </form>
</div>
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-01-30T18:44:09.357

我喜欢这个 ...

HTML：

```
<input type="checkbox" name="vacation" value="Ski Trips"><label>very long label ...</label> 
```

CSS：

```
input[type="checkbox"] { 
    position: absolute;
}
input[type="checkbox"] ~ label { 
    padding-left:1.4em;
    display:inline-block;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-05T19:05:15.457

一种选择是这样的。

```
form#updateProfile fieldset label{
    display: block;
    margin-bottom: 5px;
    font-size: 16px;
    float: left;
    width: 30%;
    padding-left: 3%;
    position: relative;
}

input {
    position: absolute;
    left: -5px;
} 
```

演示在这里：http: [//jsbin.com/opoqon/1/edit](http://jsbin.com/opoqon/1/edit)

我倾向于这样做的方式不同，这不是`inputs`用包裹`labels`，而是做类似的事情

```
<input id="ski-trips" type="checkbox" name="vacation" value="Ski Trips"><label for="ski-trips">Ski Trips</label> 
```

然后可以更轻松地进行造型。

这是这种方式的一个例子：http: [//jsbin.com/otezut/1/edit](http://jsbin.com/otezut/1/edit)

但无论哪种方式都行得通。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-03-07T11:47:26.457

这是一个不太依赖输入元素大小的方法。

```
div {width: 12em;}

label {
  display: block;
  white-space: nowrap;
  margin: 10px;
}

label input {
  vertical-align: middle;
}

label span {
  display: inline-block;
  white-space: normal;
  vertical-align: top;
  position: relative;
  top: 2px;
}
```

```
<div>

<label><input type="radio"><span>I won't wrap</span></label>
<label><input type="checkbox"><span>I won't wrap</span></label>

<label><input type="radio"><span>I am a long label which will wrap</span></label>
<label><input type="checkbox"><span>I am a long label, I will wrap beside the input</span></label>

</div>
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-10-16T09:28:32.520

**最简单的选择**

HTML：

```
<form id="updateProfile">
    <fieldset class="checkboxes">
        <p>4\. What is your favorite type of vacation?</p>
        <label><input type="checkbox" name="vacation" value="Ski Trips"> Ski Trips</label>
        <label><input type="checkbox" name="vacation" value="Beach Visits"> Beach Visits</label>
        <label><input type="checkbox" name="vacation" value="Cruises"> Cruises</label>
        <label><input type="checkbox" name="vacation" value="Historical and educational trips"> Historical and educational trips</label>
        <label><input type="checkbox" name="vacation" value="Yachting"> Yachting</label>
        <label><input type="checkbox" name="vacation" value="Road Trip"> Road Trip</label>
        <label><input type="checkbox" name="vacation" value="Spa Weekend"> Spa Weekend</label>
        <label><input type="checkbox" name="vacation" value="Bed and Breakfast"> Bed and Breakfast</label>
        <label><input type="checkbox" name="vacation" value="Stay home and relax"> Stay home and relax</label>
        <label><input type="checkbox" name="vacation" value="Gambling Trips"> Gambling Trips</label>
        <label><input type="checkbox" name="vacation" value="Volunteer"> Volunteer</label>
    </fieldset>
</form> 
```

CSS：

```
label {
    display:flex;
    align-items: baseline;
}

input[type=checkbox] {
    margin-right: 8px;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-19T09:07:57.727

我尝试了所有选项，最好的解决方案是：

```
<div>
  <label><input type="checkbox"><span>Text</span></label>
  <label><input type="checkbox"><span>Text</span></label>
</div> 
```

建议使用像 Pudica 和 Fillip 这样的 HTML。

并且您仅将 CSS 设置`float:left`为`checkboxes`and 以防止文本环绕您可以简单地`overflow:hidden`在`span`.

```
[type="checkbox] {
   float: left;
}
span {
   overflow: hidden;
} 
```

您可以使用`margin-left`从文本到复选框提供所需的空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-05T19:31:11.477

这是另一种选择。它非常简单但有效。你接受包装的部分。`<label><input type="checkbox" name="vacation" value="Historical and educational trips"> Historical and educational <span class="antiWrap">trips</span></label>`然后添加一个带类的跨度。我称这个类为antiWrap。然后你使用 css 为它添加一个左边距。`.antiWrap { margin-left: 18px; }`这是基于使用您的代码的 myfiddle 。[http://jsfiddle.net/alexhram/7WmGr/3/](http://jsfiddle.net/alexhram/7WmGr/3/)我想这就是你想要的？让我知道。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-17T20:15:49.447

在这种情况下，最简单的解决方案是使用表格进行布局。与其摆弄一千种不同的 CSS 可能排列，因为据说表格是邪恶的，这只是 100% 的时间。

```
<table>
  <tr>
    <td><input type=checkbox id=blah><label ='blah'></label></td>
    <td><label for='blah'>Long label here...</td>
   </tr>
</table> 
```

如果您需要复选框旁边的标签用于样式设置，那么只需在此处使用空标签标签并在第二个表格单元格中使用真实标签。（是的，您可以为同一个复选框使用多个标签）

# perl - 如何安装 Perl 模块 WWW-Mechanize-Firefox？

> ID：14714626
> 
> 赞同：0
> 
> 时间：2013-02-05T18:45:51.880
> 
> 标签：perl, perl-module, www-mechanize-firefox

你能告诉我在哪里可以找到关于如何安装 perl 模块的指南吗？

我正在尝试安装 perl 模块： [http ://metacpan.org/pod/WWW::Mechanize::Firefox::Installation](http://metacpan.org/pod/WWW%3a%3aMechanize%3a%3aFirefox%3a%3aInstallation)

我被困在第 7 步。我不确定问题出在哪里，尽管我可以让 mozrepl 出现在工具下。我所知道的是，当我运行时使用**WWW::Mechanize::Firefox**；我得到以下类型的结果：

> 找不到 www/mechanize/firefox.pmin @INC<@INC contains: C:/Perl/site/lib C:/Perl/lib

在我有 perl 的目录中，如果我输入 ppm install WWW-Mechanize-Firefox 我得到

> “ppm 安装归档：找不到任何提供 WWW-Mechanize-Firefox 的软件包”

我使用 Windows XP。

我将不胜感激任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T21:13:11.720

基于此错误：

> 找不到 www/mechanize/firefox.pmin @INC<@INC contains: C:/Perl/site/lib C:/Perl/lib

您需要安装模块。

例如，如果您使用 Strawberry Perl，您应该能够简单地：

`cpan WWW::Mechanize::Firefox`

我相信 ActiveState 支持上述内容，以及`ppm install WWW::Mechanize::Firefox`

编辑：[ActiveState 的说明](http://www.activestate.com/blog/2010/10/how-install-cpan-modules-activeperl)

编辑：

在安装过程中，一些测试失败了。然后我继续按照您链接到的步骤进行操作。那时我回去并使用以下方法运行测试：

`cpan -t WWW::Mechanize::Firefox`

测试在 FF 中打开和关闭各种窗口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T08:40:50.313

我只在Linux下愤怒地使用了这个。

问题（当时）是 WWW 模块不包含 MozRepl 模块的硬依赖关系，因此需要手动安装。

我自己的指示（大约 3 年前）

```
cpan WWW::Mechanize::Firefox
cpan MozRepl
cpan MozRepl::RemoteObject 
```

但是，如果它对 Craig 有效，那么现在可能一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-16T03:33:12.707

我在 64 位 Active Perl 中遇到了 IPC-Run 问题。ActiveState 说它不起作用。但我发现对于 WWW::Mechanize::Firefox 的基本使用没有必要。如果您安装 App::cpanminus 并运行 cpanm -n WWW::Mechanize::Firefox 我发现它会推动 IPC-Run 的安装，您可以继续在 64 位 Windows 实例中使用 mechanize firefox。

希望这对某人有帮助！-lta

# java - 永久内存未清除

> ID：14714633
> 
> 赞同：1
> 
> 时间：2013-02-05T18:46:17.500
> 
> 标签：java, tomcat

系统详情：

*   红帽企业 Linux 6.3
*   Sun Java JDK 1.6.0_38
*   Apache Tomcat 7.0.34
*   VMWare 环境

我：中等经验的 Linux 管理员，试用过 Java/Tomcat 管理员，几乎不了解 Java 编程/代码。

我设置的环境变量是数月挖掘 stackoverflow 帖子、oracle 文档和 300 多篇其他网络帖子的结果，其中大部分包含相互冲突的信息或有关不同版本的 java VM 的详细信息。

问题有时，Tenured Generation（也称为 Old）不会清空/垃圾收集。这会导致我们的最终用户性能下降。从 Visual VM 启动垃圾收集*有时会*解决问题，但并不经常。我通常能够进行堆转储，但不幸的是我不知道我在寻找什么。我应该寻找什么信息？我确定代码存在问题，但“修复代码”不是一个直接的选择。如果它像投入更多内存/金钱一样简单，我会这样做，但我希望 Java 只是清空该死的垃圾。如果需要更多详细信息，我很乐意提供，我可能不得不审查一些内容，因为有“一些”私人信息。

setenv.sh 内容

```
export JAVA_HOME="/usr/java/jdk1.6.0_38"
export CATALINA_OPTS="$CATALINA_OPTS -verbose:gc -XX:+PrintGCTimeStamps -XX:+PrintGCDetails"
export CATALINA_OPTS="$CATALINA_OPTS -Xms512m -Xmx512m"
export CATALINA_OPTS="$CATALINA_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m"
export CATALINA_OPTS="$CATALINA_OPTS -XX:+CMSClassUnloadingEnabled"
export CATALINA_OPTS="$CATALINA_OPTS -XX:CMSInitiatingOccupancyFraction=75"
export CATALINA_OPTS="$CATALINA_OPTS -XX:+UseConcMarkSweepGC -XX:+CMSIncrementalMode"
export CATALINA_OPTS="$CATALINA_OPTS -server"
export CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.port=8008"
export CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.ssl=false"
export CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.authenticate=true"
export CATALINA_OPTS="$CATALINA_OPTS -Dcom.sun.management.jmxremote.password.file=/home/otrack/tomcat7/conf/management.jmxremote.password"
export CATALINA_OPTS="$CATALINA_OPTS -Djava.rmi.server.hostname=10.47.10.113"
export JPDA_OPTS="-agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=n" 
```

# javafx-2 - javaFx 2.0 中的键输入

> ID：14714637
> 
> 赞同：0
> 
> 时间：2013-02-05T18:46:24.593
> 
> 标签：javafx-2, game-development

我目前正在开发一个 javaFX 2.0 游戏，我想知道如何制作它，所以当我输入一个特定的键时会发生一些事情。感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:21:58.687

使您的根节点集中，然后在`setOnKeyPressed`方法中编写您的逻辑。

示例代码：

```
root.setFocusTraversable(true);
root.setOnKeyPressed(new EventHandler<KeyEvent>() {

    @Override
    public void handle(KeyEvent kEvent) {
        if (kEvent.getCode() == KeyCode.SPACE) {
            System.out.println("Space Bar pressed");
        }
    }
}); 
```

# asp.net-mvc-3 - 没有插件的 MVC3 和 Twitter Bootstrap TypeAhead

> ID：14714644
> 
> 赞同：0
> 
> 时间：2013-02-05T18:46:53.930
> 
> 标签：asp.net-mvc-3, entity-framework, twitter-bootstrap, typeahead

我已经让 TypeAhead 可以正常处理静态数据，并且能够正确调用我的控制器函数并获取数据，但它要么是 A：没有正确解析数据，要么是 B：没有正确设置 TypeAhead。

JavaScript：

```
<input type="text" id="itemSearch" data-provide="typeahead" value="@ViewBag.Item" name="itemSearch"/>

    $('#itemSearch').typeahead({
    source: function (query, process) {
        parts = [];
        map = {};

        $.ajax({
                url: '@Url.Action("MakePartsArray")',
                dataType: "json",
                type: "POST",
                data: {query: query},
                success: function (data) {
                                $.each(data, function (i, part) {
                                map[part.description] = part;
                                parts.push(part.description);
                            });

                            typeahead.process(parts);
                }
            });
    },
    updater: function (item) {
        selectedPart = map[item].itemNumber;
        return item;
    },
    matcher: function (item) {
        if (item.toLowerCase().indexOf(this.query.trim().toLowerCase()) != -1) {
            return true;
        }
    },
    sorter: function (items) {
        return items.sort();
    },
    highlighter: function (item) {
        var regex = new RegExp('(' + this.query + ')', 'gi');
        return item.replace(regex, "<strong>$1</strong>");
    }
}); 
```

控制器 ：

```
 public ActionResult MakePartsArray(string query)
    {
        var possibleItem = query.ToLower();
        var allItems = Db.PartInventorys.Where(l => l.ItemNumber.Contains(possibleItem)).Select(x => new { itemNumber = x.ItemNumber, description = x.Description });
        return new JsonResult
        {
            ContentType = "text/plain",
            Data = new { query, total = allItems.Count(), suggestions = allItems.Select(p => p.itemNumber).ToArray(), matches = allItems, },
            JsonRequestBehavior = JsonRequestBehavior.AllowGet
        };
    } 
```

在我的控制器中，我看到数据被正确检索，并且似乎可以正确解析，但我的 TypeAhead 没有显示任何内容。

关于如何准确验证故障发生位置的任何想法，或者是否有人在我的代码中看到直接错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T18:09:29.303

问题出在ajax调用中-

```
 $.ajax({
           url: '@Url.Action("MakePartsArray")',
           dataType: "json",
           type: "POST",
           data: {query: query},
           success: function (data) {
               $.each(data.matches, function (i, part) {
                   var composedInfo = part.description + ' (' + part.itemNumber + ')';
                   map[composedInfo] = part;
                   parts.push(composedInfo);
                });

                process(parts);
           }
       }); 
```

并在返回类型的控制器中

```
 return new JsonResult
        {
            ContentType = "application/json",
            Data = new { query, total = allItems.Count(), suggestions = allItems.Select(p => p.itemNumber).ToArray(), matches = allItems },
            JsonRequestBehavior = JsonRequestBehavior.AllowGet
        }; 
```

# php - PHP：正则表达式匹配完整的匹配括号？

> ID：14714647
> 
> 赞同：4
> 
> 时间：2013-02-05T18:46:59.867
> 
> 标签：php, regex, nested

在 PHP 中，我有以下字符串：

```
 $text = "test 1
          {blabla:database{test}}
          {blabla:testing}
          {option:first{A}.Value}{blabla}{option:second{B}.Value}
          {option:third{C}.Value}{option:fourth{D}}
          {option:fifth}
          test 2
         "; 
```

我需要`option`从这个字符串中取出所有 { ...} （这个字符串中总共 5 个）。有些有多个嵌套括号，有些则没有。有些在同一条线上，有些则不在。

我已经找到了这个正则表达式：

```
(\{(?>[^{}]+|(?1))*\}) 
```

所以以下工作正常：

```
preg_match_all('/(\{(?>[^{}]+|(?1))*\})/imsx', $text, $matches); 
```

不在大括号内的文本被过滤掉，但匹配项还包括`blabla`我不需要的 -items。

有什么办法可以将这个正则表达式更改为只包含`option`-items？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:50:45.413

这个问题更适合合适的解析器，但是如果你真的想的话，你可以用正则表达式来解决。

只要您不将选项嵌入其他选项中，这应该可以工作。

```
preg_match_all(
    '/{option:((?:(?!{option:).)*)}/',
    $text,
    $matches,
    PREG_SET_ORDER
); 
```

快速解释。

```
{option:               // literal "{option:"
  (                    // begin capturing group
    (?:                // don't capture the next bit
      (?!{option:).    // everything NOT literal "{option:"
    )*                 // zero or more times
  )                    // end capture group
}                      // literal closing brace 
```

`var_dump`带有示例输入的 ed 输出如下所示：

```
array(5) {
  [0]=>
  array(2) {
    [0]=>
    string(23) "{option:first{A}.Value}"
    [1]=>
    string(14) "first{A}.Value"
  }
  [1]=>
  array(2) {
    [0]=>
    string(24) "{option:second{B}.Value}"
    [1]=>
    string(15) "second{B}.Value"
  }
  [2]=>
  array(2) {
    [0]=>
    string(23) "{option:third{C}.Value}"
    [1]=>
    string(14) "third{C}.Value"
  }
  [3]=>
  array(2) {
    [0]=>
    string(18) "{option:fourth{D}}"
    [1]=>
    string(9) "fourth{D}"
  }
  [4]=>
  array(2) {
    [0]=>
    string(14) "{option:fifth}"
    [1]=>
    string(5) "fifth"
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:54:14.737

试试这个正则表达式 - 它使用 .NET 正则表达式进行了测试，它也可以与 PHP 一起使用：

```
\{option:.*?{\w}.*?} 
```

请注意 - 我假设您只有 1 对括号里面，并且在那对里面您只有 1 个字母数字字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T18:53:21.430

我修改了您的初始表达式以搜索附加了非空白字符 (\S*) 的字符串 '(option:)'，并以花括号 '{}' 为界。

```
\{(option:)\S*\} 
```

给定您的输入文本，以下条目在正则表达式中匹配：

测试 1

{blabla：数据库{测试}}

{blabla：测试}

**{option:first{A}.Value}** **{option:second{B}.Value}**

**{option:third{C}.Value}**

**{选项：第四{D}}**

**{选项：第五}**

测试 2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:40:47.573

如果您在同一级别上没有多对括号，则应该可以

```
/(\{option:(([^{]*(\{(?>[^{}]+|(?4))*\})[^}]*)|([^{}]+))\})/imsx 
```

# iphone - UITable 视图到详细视图 JSON 解析与 AFNetworking

> ID：14714653
> 
> 赞同：0
> 
> 时间：2013-02-05T18:47:22.387
> 
> 标签：iphone, ios, json, youtube-api, afnetworking

我设法使用 AFNetworking 在 UITable 视图上解析来自 YouTube API 的数据，但我不知道如何使用

```
didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

如何将 JSON 数据传递到下一个视图？

这是文件的链接：[google drive](http://docs.google.com/folder/d/0B1EPIKZI6a5sSzVWdXh6VU1POWs/edit?usp=sharing)

这是我的代码

```
#import "KKViewController.h"

#import "AFNetworking.h"

#import "AFJSONRequestOperation.h"

@interface KKViewController ()

@end

@implementation KKViewController

@synthesize  movies = _movies, count = _count;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.movies = [[NSArray alloc] init];

    NSURL *url = [[NSURL alloc] initWithString:@"http://gdata.youtube.com/feeds/api/playlists/PL0l3xlkh7UnvLdr0Zz3XZZuP2tENy_qaP?v=2&alt=jsonc&max-results=50"];
    NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {

        self.movies = [JSON valueForKeyPath:@"data.items.video"];

        // NSLog(@@, video)

        //

        self.count = [JSON valueForKeyPath:@"data.items.video.thumbnail"];
        [self.activityIndicatorView stopAnimating];
        [self.tableView setHidden:NO];
        [self.tableView reloadData];

    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
        NSLog(@"Request Failed with Error: %@, %@", error, error.userInfo);
    }];

    [operation start];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{

    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.

    if (self.movies && self.movies.count) {
        return self.movies.count;
    } else {
        return 0;
    }

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *cellID = @"Cell Identifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellID];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:cellID];
    }

    NSDictionary *movie = [self.movies objectAtIndex:indexPath.row];

    NSDictionary *countt = [self.count objectAtIndex:indexPath.row];
    cell.textLabel.text = [movie objectForKey:@"title"];
    cell.detailTextLabel.text = [movie objectForKey:@"uploader"];

    NSURL *url = [[NSURL alloc] initWithString:[countt objectForKey:@"hqDefault"]];
    [cell.imageView setImageWithURL:url placeholderImage:[UIImage imageNamed:@"placeholder"]];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:13:25.820

您可以：

1.  在你的故事板原型中为有问题的单元定义一个segue，你根本不需要写一个`didSelectRowAtIndexPath`；

2.  已经`didSelectRowAtIndexPath`做了一个`performSegueWithIdentifier`（给它你在情节提要中为你的segue设置的唯一字符串“情节提要标识符”；

然后，您可以编写一个`prepareSegue`查看表格[`indexPathForSelectedRow`](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/indexPathForSelectedRow)以确定选择了哪一行的代码。然后，您可以从应用程序的模型中获取适当的信息，并在`destinationViewController`.

您也可以`didSelectRowAtIndexPath`设置`instantiateViewControllerWithIdentifier`属性，然后执行适当的`pushViewController`or `presentViewController`，但我个人更喜欢利用您在情节提要中定义的 segues 的上述技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:42:08.380

我希望这个示例代码能帮助您轻松完成您的需求。请问您是否有任何模棱两可的地方。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath   *)indexPath
 {
  [self.leadsTableView deselectRowAtIndexPath:indexPath animated:YES];
  id object = [[self.tableData objectAtIndex:indexPath.section]    objectAtIndex:indexPath.row];
self.leadforLeadDetails = (Lead*)object;

self.selectedLeadID = self.leadforLeadDetails.ID;
[self performSegueWithIdentifier:@"openLeadDetails" sender:self];

// Navigation logic may go here. Create and push another view controller.
/*
 <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
 // ...
 // Pass the selected object to the new view controller.
 [self.navigationController pushViewController:detailViewController animated:YES];
 */
}

 - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
 {
   //NSIndexPath *indexPath = [self.tableView2 indexPathForCell:sender];
   //[self.tableView2 deselectRowAtIndexPath:indexPath animated:YES];
   if ([segue.identifier isEqualToString:@"openLeadDetails"])
{
       LeadsDetailsTableViewController *destViewController = segue.destinationViewController;
       destViewController.dictLeadDetails = self.dictLeadDetails;

       destViewController.leadID = self.leadforLeadDetails.ID;
       destViewController.Name = self.leadforLeadDetails.Name;
       destViewController.leadDetails.ID = self.leadforLeadDetails.ID;
       destViewController.leadDetails.Name = self.leadforLeadDetails.Name;
     }
 } 
```

# c++ - VS2008 中的 C++ 项目有效，但在 VS2010 中无效

> ID：14714654
> 
> 赞同：2
> 
> 时间：2013-02-05T18:47:24.460
> 
> 标签：c++, visual-studio-2010, odbc

我在 VS2008 中构建了 PostgreSQL ODBC 驱动程序，然后运行 ​​odbcad32.exe，创建 DSN 并单击测试按钮。它工作正常。然后我复制文件夹并在 VS2010 中重建它，然后执行相同的操作：我收到错误消息 COuld not send query(Connection dead)。

然后我做了：在VS2005中编译-一切正常。在 Vs2012 - 不起作用。我检查了调试器：是的，在短查询执行期间套接字已关闭，按钮测试生成类似以下查询序列的内容：

```
set DateStyle to 'ISO'
....
set extra_float_digits to 2
...
[5912-1.471]CC_send_query: conn=04460048, query='select oid, typbasetype from pg_type where typname = 'lo''
[5912-1.472]send_query: done sending query 63bytes flushed
[5912-1.473]in QR_Constructor
[5912-1.473]exit QR_Constructor
[5912-1.473]read -1, global_socket_buffersize=4096
[5912-1.474]Lasterror=10035
[5912-1.474](5)Error while reading from the socket. ERRNO=10035
[5912-1.475]CC_error_statements: self=04460048
[5912-1.475]CONN ERROR: func=CC_send_query, desc='', errnum=107, errmsg='No response from the backend'
...
[5912-1.481]CC_lookup_characterset: entering...
[5912-1.481]CC_send_query: conn=04460048, query='select pg_client_encoding()'
[5912-1.482]CC_error_statements: self=04460048
[5912-1.482]CONN ERROR: func=CC_send_query, desc='', errnum=104, errmsg='Could not send Query(connection dead)' 
```

这种不同行为的原因可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:11:57.477

“问题”是由于VS2010 EWOULDBLOCK（在errno.h中定义）！= WSAEWOULDBLOCK，而开发人员依赖这两个值是相同的，类似于：

```
r = recv( ... );
if (r == -1 && WSAGetLastError() == EWOULDBLOCK) { ... } 
```

过去适用于旧版本 VS 的功能不再适用。

# sql-server - 有没有办法让竹子的树枝有多个连接字符串？

> ID：14714668
> 
> 赞同：0
> 
> 时间：2013-02-05T18:48:17.160
> 
> 标签：sql-server, sql-server-2008, svn, bamboo

使用 sql server 2008 运行与竹子的持续集成。
有没有办法为竹子中的分支提供多个连接字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T00:20:35.127

是的。但并不像你想象的那样直接。做这个。创建多个 Web.config 文件，命名为 Web.Test.config、Web.QA.config、Web.Stage.config、Web.Prod.config 等。每个文件都有连接字符串和其他设置，每个文件都需要那些环境。在构建和部署之后，按分支，使用 Ant/NAnt 脚本将 Web.config 替换为您想要用于该环境的配置。

我想这就是你的意思。问题有点模糊。

# xml - 使用 XML 数据源时没有数据时显示 Jasper 报告而不是空白页

> ID：14714671
> 
> 赞同：1
> 
> 时间：2013-02-05T18:48:23.040
> 
> 标签：xml, web-applications, xpath, jasper-reports, ireport

我使用**Jasper**作为报表引擎（使用**iReport** -4.0.0）
我的数据源是**XML 文件数据源**，并在填写报表时使用**XPath**表达式
例如
示例数据

```
<StudentList>
<Student>   
    <StdntCd>cd11</StdntCd>
    <StdntNm>ee11</StdntNm>
    <Schl>Schl11</Schl>
    <Cty>Cty11</Cty>
</Student>
<Student>   
    <StdntCd>cd22</StdntCd>
    <StdntNm>ee22</StdntNm>
    <Schl>Schl22</Schl>
    <Cty>Cty22</Cty>
</Student>
</StudentList> 
```

我的 XPath 表达式是

```
/StudentList/Student 
```

问题发生在没有数据时

```
<StudentList>

</StudentList> 
```

我需要*显示报告的所有部分而不显示详细信息*（因为没有数据）
虽然我将“当没有数据”属性设置为“所有部分，没有详细信息”
但仍然不起作用
注意
没有数据等同于以前的 XML**不喜欢那**

```
<StudentList>
 <Student></Student>
</StudentList> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:14:39.700

为了避免这种情况，最好的方法是`printWhenExpression`为细节带定义一个。

在 iReport 中：单击详细信息带上的报告检查器，在属性面板中修改`printWhenExpression`为`$F{StdntCd} != null`：这将仅显示具有除`null`.

如果您使用该`REPORT_COUNT`变量，则需要添加一个自定义变量：

*   类型：`java.lang.Integer`
*   计算：`Sum`
*   表达：`$F{StdntCd} == null ? 0 : 1`
*   初始值：`0`

这将允许您始终正确输出，假设如果提供了有效数据，则该字段`StdntCd`永远不会出现。`null`

如果您的报告使用与 groovy 不同的语言运行，您可能需要调整表达式。

# java - 使用 JAXB 将对象的内容铲到不同类型的新实例中

> ID：14714674
> 
> 赞同：0
> 
> 时间：2013-02-05T18:48:39.140
> 
> 标签：java, xml, jaxb

有没有一种简单的方法可以将一个对象的内容复制到不同类/目标类型的新对象中。这些对象至少共享一个超类以及许多属性/属性。

我将此方法用于不同的目标类：[https](https://stackoverflow.com/a/3899882/1949775) ://stackoverflow.com/a/3899882/1949775 。我没有得到异常，但不知何故我得到了错误的目标类型......

我正在寻找的是一种简单的方法，可以将一个对象内容铲入一个与源不同的目标类型的新实例中。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:56:34.573

你可以试试 Apache commons-beanutils

BeanUtils.copyProperties（源，目标）；

**API**

将给定源 bean 的属性值复制到目标 bean。

注意：源类和目标类不必匹配，甚至不必相互派生，只要属性匹配即可。源 bean 公开但目标 bean 未公开的任何 bean 属性都将被静默忽略。

这只是一种方便的方法。对于更复杂的传输需求，请考虑使用完整的 BeanWrapper。

# svg - 动画导入的 SVG 对象

> ID：14714676
> 
> 赞同：0
> 
> 时间：2013-02-05T18:48:56.397
> 
> 标签：svg, raphael

我决定使用 svg.js 而不是 raphael.js，因为我的 SVG 图像只需要简单的动画函数，而且它的大小要小得多，语法也很好。

我的 SVG 导入工作成功，但我无法确定我应该指的是哪个对象来为其设置动画。

导入后我的代码的最后一点说

```
var rawSvg = 'svg raw data here'
var draw = svg('paper').size('100%', '100%');
    draw.import(rawSvg); 
```

我检查了 Google Chrome 中的元素，我只能看到 SVG 对象“g”、#path1layer1 和 Path2993。所以尝试将 animate 方法应用于它们中的每一个，但我得到一个错误，说该对象没有 animate 方法。那么我应该将动画方法绑定到哪个对象？

这是我尝试的最后一件事

```
path2993.animate().move(150, 150); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:46:41.347

svg.import.js[插件](https://github.com/wout/svg.import.js)已更新。现在所有导入的元素都在 import() 方法返回的对象中引用，如下[所述](https://github.com/wout/svg.import.js#references)：

```
var rawSvg = '<?xml version="1.0" encoding="utf-8"?><!-- Generator: Adobe Illustrator 16.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"    width="500px" height="500px" viewBox="0 0 500 500" enable-background="new 0 0 500 500" xml:space="preserve"><line id="line1234" fill="none" stroke="#FF7BAC" stroke-width="20" stroke-linecap="round" stroke-miterlimit="10" x1="138.682" y1="250" x2="293.248" y2="95.433"/><rect id="rect1235" x="22.48" y="19.078" fill="#F7931E" stroke="#C1272D" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" width="94.972" height="94.972"/><path id="path1236" opacity="0.5" fill="#29ABE2" d="M189.519,131.983c0,5.523-4.477,10-10,10H92.257c-5.523,0-10-4.477-10-10V53.659 c0-5.523,4.477-10,10-10h87.262c5.523,0,10,4.477,10,10V131.983z"/><circle id="circle1237" opacity="0.8" fill="#8CC63F" cx="201.603" cy="159.508" r="69.067"/><polygon id="polygon1238" fill="none" stroke="#8C6239" stroke-width="20" stroke-linecap="round" stroke-miterlimit="10" points="286.331,287.025  227.883,271.365 212.221,212.915 255.009,170.127 313.459,185.789 329.119,244.237 "/></svg>';
var draw = svg('paper');
var store = draw.import(rawSvg);
store.polygon1238.fill('#f06'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:06:44.247

我正在阅读文档，但我不清楚。但是您不能向`this.SVG`对象添加一个 id 属性，然后通过标准 DOM 方法访问 svg 元素吗？或者您是否试图检索 js 对象本身？那不是你称之为 draw 的 var，还是为时已晚？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:16:33.793

svg.js[导入](http://svgjs.com)插件非常年轻。所有导入的元素实际上都是用[svg.js](http://svgjs.com)构建的，因此它们都使用 children() 方法在[svg.js中公开：](http://svgjs.com)

```
var draw = svg('paper');
draw.import('... svg data ... ');
draw.children().forEach(function(element) {
  console.log(element.attr('id');
}); 
```

但是如果你想单独引用元素，最好单独创建它们，而不是导入一个巨大的 SVG 文档。假设您想使用 Inkscape 中生成的路径，只需创建单个形状并将其保存为纯 svg。打开 svg 文件，找到`<path>`标签并复制`d="..."`属性的内容，可能如下所示：

```
M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z 
```

然后您可以创建路径并为其设置动画：

```
var pathData = 'M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z';
var draw = svg('paper');
var path = draw.path(pathData).size(30).move(10,10);
path.animate().move(100,100); 
```

# c++ - 单步退货声明或多步退货声明

> ID：14714684
> 
> 赞同：0
> 
> 时间：2013-02-05T18:49:56.783
> 
> 标签：c++, coding-style

示例 1：

```
int length()  
{  
        return strlen(random_string);  
} 
```

示例 2：

```
int length()  
{  
        int str_length = 0;  
        str_length = strlen(random_string);  
        return str_length;  
} 
```

问题：
我遇到过许多函数，其中一行代码就可以满足该函数的要求，但我记得一些关于避免这种快捷方式的事情。

在某些情况下，一个比另一个更合适，还是我应该总是选择更简单的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:52:28.857

我永远不会去你的第二个例子，因为初始化然后分配只是无缘无故地占用空间。

我*可能会*做以下事情：

```
int length()  
{  
    const int str_length = strlen(arbitrary_string);  
    return str_length;  
} 
```

这有两个原因：

1.  您允许您的编译器执行命名返回值优化；和
2.  您的返回值现在可以通过名称进行自我记录。

但是，这对我来说更像是一个*默认*规则。

在这个具体的实际案例中：

1.  您的返回类型只是微不足道的 little `int`，因此无论如何都不允许命名返回值优化，即使是这样也基本上没有意义；和
2.  该函数已经很简单并且命名适当。

所以我会使用第一个例子：

```
int length()  
{  
    return strlen(arbitrary_string);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T18:57:06.827

采用多步骤方法的一个原因是，如果您决定添加一行来打印长度值，那么麻烦会少得多：

```
int length()
{
    const int str_length = strlen(something);
    printf("str_length = %d\n", str_length);
    return str_length;
} 
```

或者如果你想添加一些额外的断言：

```
int length()
{
    const int str_length = strlen(something);
    assert(str_length >= 0);
    return str_length;
} 
```

除此之外，这完全取决于您认为最合适的内容[当然，除非您有严格的编码标准要遵循！]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T18:52:32.883

我说总是使用示例 1。它读起来更好。如果中间变量名称有助于可读性或者表达式应该被拆分为多个语句，我永远不会将表达式放在 return 语句中。

不过，我绝不会建议示例 2 - 初始化为 0 是没有意义的。中间地带更好：

```
int length()  
{  
    int str_length = strlen(random_string);  
    return str_length;  
} 
```

但是，很明显，它`str_length`并没有比函数名更能告诉你`strlen`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T18:53:26.357

一般来说，代码应该易于阅读并明确目的。在您的示例中，我更喜欢较短的版本。长版本的语义没有额外的信息增益。

与往常一样，可能会有例外。特别是当返回值来自一个冗长而复杂的表达式时。然后命名一些中间结果可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T18:58:28.533

要回答这个问题，请始终选择更易于阅读的解决方案，这在每种编程语言中都很重要，但在 C++ 中极为重要。

对于您的特定问题，C++ 开发人员最容易阅读的是选项 1，它简洁明了。但是如果碰巧你必须写的单行是这样的：

```
return (classA *)(function1(data1)->function2())->function3(); 
```

在这种情况下，总是选择拆分线路，因为即使您了解它现在的作用，您也很难弄清楚将来会发生什么。

希望能帮助到你

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-05T18:52:40.870

在大多数情况下，可读性总是胜过性能。如果你有性能关键的代码，那就去追求性能。然而，这是一个例外，而不是规则。

始终追求可读性。

# java - Spring 3.xx MVC jsp 组合框麻烦

> ID：14714687
> 
> 赞同：0
> 
> 时间：2013-02-05T18:50:18.563
> 
> 标签：java, spring, spring-mvc

        几天来，我一直在兜圈子，在尝试使用 Spring-MVC 3.xx 和 jsp 获得一个简单的组合框（由表单：select 制作）方面没有任何进展。有几个示例是通过扩展现已弃用的“SimpleFormController”来实现的，但是我没有找到任何使用 Spring 3.0.x 注释的简洁示例。此外，我已经查看了 Spring 的参考 [文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/)，但我无法获得可以引导我运行组合框组件的控制器和视图 (jsp) 的片段。
        到目前为止，我没有成功的尝试是这样的：（任何评论都将不胜感激）

**控制器类（例如 MyController.java）**

```
@Controller
public class MyController {
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String showHomePage(ModelMap model) {

        Map<String,String> country = new LinkedHashMap<String,String>();
        country.put("US", "United Stated");
        country.put("CHINA", "China");
        country.put("SG", "Singapore");
        country.put("MY", "Malaysia");
        model.put("countryList", country);
        return "home";
    }
} 
```

**主页.jsp**

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%><br>
<html>
<body>
<form:form method="POST" commandName="country">
    <form:select path="country">
        <form:options items="${countryList}" />
    </form:select>
</form:form>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:45:42.893

感谢 Manuel 的澄清，我终于想出了一个实用且令人满意的**解决方案**。在这里，我将其复制到使其工作的主要组件：

**CountryBean 类（例如 CountryBean.java）**

```
@Component
public class CountryBean {
    private String value;
    private String description;

public CountryBean(){
}
public CountryBean(String value, String description){
    this.value=value;
    this.description=description;
}

public String getValue() {
    return value;
}
public void setValue(String value) {
    this.value = value;
}
public String getDescription() {
    return description;
}
public void setDescription(String description) {
    this.description = description;
}
} 
```

**CountryFormBean 类（例如 CountryFormBean.java）**

```
public class CountryFormBean {

private CountryBean countryBean;

public setCountryBean (CountryBean countryBean){
    this.countryBean=countryBean;
}

public CountryBean getCountryBean(){
    return countryBean
} 
```

**控制器类（例如 MyController.java）**

```
@Controller
public class AttendanceController {
private List<CountryBean> countryBeanList;
public List<CountryBean> getCountryBeanList() {
    return countryBeanList;
}
@Autowired
public void setCountryBeanList(List<CountryBean>  countryBeanList) {
    this.countryBeanList = countryBeanList;
}
@RequestMapping(value = "/", method = RequestMethod.GET)
public String showHomePage(@ModelAttribute("countryFormBean") CountryFormBean countryFormBean, BindingResult result, ModelMap model) {

    countryBeanList.add(new CountryBean("US", "United Stated"));
    countryBeanList.add(new CountryBean("CHINA", "China"));
    countryBeanList.add(new CountryBean("SG", "Singapore"));
    countryBeanList.add(new CountryBean("MY", "Malaysia"));

    model.addAttribute("countryBeanList", countryBeanList);
    return "home";
}
} 
```

**主页.jsp**

```
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<html>
<body>
<form:form method="POST" commandName="countryFormBean">
 <form:select path="countryBean"  items="${countryBeanList}" itemValue="value" itemLabel="description"/>
</form:form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:10:31.263

我过去使用的方法是创建一个名为 OptionValue 的 bean，它具有两个属性 value 和 description。将 OptionValue 的列表添加到模型中。表单选项标签需要知道要查找哪些属性的值和描述。我在下面添加了一个示例。

```
@Controller
public class MyController {
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String showHomePage(ModelMap model) {

        List<OptionValue> country = new ArrayList<OptionValue>();
        country.add(new OptionValue("US", "United Stated"));
        country.add(new OptionValue("CHINA", "China"));
        country.add(new OptionValue("SG", "Singapore"));
        country.add(new OptionValue("MY", "Malaysia"));
        model.put("countryList", country);
        return "home";
    }
} 
```

在你的jsp中。

```
<form:options items="${countryList}" itemValue="value" itemLabel="description"/> 
```

# iphone - UIWindow 不需要 makeKeyAndVisible 的示例

> ID：14714688
> 
> 赞同：2
> 
> 时间：2013-02-05T18:50:19.513
> 
> 标签：iphone, ios, uiwindow

我想知道在所有 iOS 应用程序中我们必须为我们的 UIWindow 对象编写 makeKeyAndVisible 。那么是否有一个我们不希望我们的应用程序 makeKeyAndVisible 的示例。

如果我们总是在任何应用程序中都需要它，那么为什么苹果会自动为我们编写它，就像他们为 @synthesize 作为 iOS 6 的一部分所做的那样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T18:55:29.030

Apple 使用情节提要自动处理 makeKeyAndVisible

使用故事板，iOS 执行以下步骤：

*   它为您实例化一个窗口。
*   它加载主故事板并实例化其初始视图控制器。
*   它将新的视图控制器分配给窗口的 rootViewController 属性，然后使窗口在屏幕上可见。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-05T18:53:50.203

一个应用程序可以有多个窗口。调用`makeKeyAndVisible`用于指定哪个是当前的。

尽管大多数应用程序只有一个窗口，但无法假设您的主窗口是关键窗口。因此，您必须显式调用`makeKeyAndVisible`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-13T01:39:54.313

如果您使用故事板来启动您的应用程序，则不需要调用**makeKeyAndVisible**。

您可以尝试在 Xcode 6 中创建一个新项目。该项目没有使用**makeKeyAndVisible**，如果您尝试获取 keyWindow，您将获得 nil。

# ruby-on-rails-3 - 使用远程 Postgres 数据库安装 Postgres Gem PG

> ID：14714691
> 
> 赞同：2
> 
> 时间：2013-02-05T18:50:32.430
> 
> 标签：ruby-on-rails-3, postgresql, rubygems

我刚刚在 Debian Squeeze 服务器上安装了 Ruby 1.9 和 Rails 3 的新副本。Rails Web 应用程序需要连接到远程 Postgres 数据库，因此我尝试安装 Postgres 适配器，但似乎安装程序正在寻找本地 PostgreSQL 数据库和不存在的配置，因为 Postgres 数据库位于不同的位置主持人。

当实际的 Postgres 数据库位于另一台机器上时，有人可以解释如何安装 Postgres 适配器吗？

谢谢

```
gem1.9.1 install pg

Building native extensions.  This could take a while...
ERROR:  Error installing pg:
ERROR: Failed to build gem native extension.

/usr/bin/ruby1.9.1 extconf.rb
checking for pg_config... no
No pg_config... trying anyway. If building fails, please try again   with
--with-pg-config=/path/to/pg_config

checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***

Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:57:31.810

您的环境中缺少库。`pg`在尝试安装gem之前尝试安装所有这些。
或者，如果所有库都已安装并且您仍然遇到相同的错误，请尝试使用`--with-pg-config`上面显示的错误命令安装 gem 指定 postgres 配置文件。

```
gem install pg --with-pg-config=TYPE_HERE_YOUR_postgresql.conf_PATH 
```

# sorting - 如何按每 60 天的时间范围对 SOLR 搜索结果进行排序？

> ID：14714698
> 
> 赞同：1
> 
> 时间：2013-02-05T18:50:57.810
> 
> 标签：sorting, search, solr, range

我喜欢 solr 搜索结果根据它的年龄按以下顺序排序，按每 60 天的范围分组：

*   {0 ~ 59 天，组内随机}
*   {60 ~ 119 天，随机 }
*   {120 ~ 179 天，随机 }
*   ...

在我们的文档中，我们有一个名为**publishDate**的字段，它的 fieldType 为“日期”。我在想我是否可以使用排序功能来做到这一点（只是一些伪代码）：

`sort=((Today - publishDate) / 60 ) asc, rand_## desc, score desc`

另外，如果可行，是否仅在当前 SOLR 版本中支持？3.x 还是 4？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T04:06:29.447

[正如上面提到的函数查询](http://wiki.apache.org/solr/FunctionQuery)和[随机排序](http://lucene.apache.org/solr/api-4_0_0-BETA/org/apache/solr/schema/RandomSortField.html)字段，这应该是可行的，并且支持 3.x 和 4.0

您可以检查[sub](http://wiki.apache.org/solr/FunctionQuery#sub)、[div](http://wiki.apache.org/solr/FunctionQuery#div)、[ms](http://wiki.apache.org/solr/FunctionQuery#ms)函数来执行减法、除法和毫秒以达到日期范围值并对其进行排序。
使用 RandomSort 字段作为辅助排序来随机化它。

# android - 如何在 Android 中将字符数组设置为 TextView 的文本？

> ID：14714699
> 
> 赞同：2
> 
> 时间：2013-02-05T18:51:09.980
> 
> 标签：android, textview, character-arrays

```
 userString=(EditText)findViewById(R.id.letter);
    checkButton=(Button)findViewById(R.id.go);
    text=(TextView)findViewById(R.id.display);
    checkButton.setOnClickListener(new View.OnClickListener(){
    @SuppressWarnings("null")
public void onClick(View v){
    char answer[]=null;int i;
    String userEntry=userString.getText().toString();
    for(i=0;i<userEntry.length();i++)
    {
    answer[i]='_';
    }
    text.setText(answer, 0, i);
    }
    }}); 
```

当我运行上面的代码时，它说“应用程序已意外停止。请再试一次”。我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:53:49.853

您正在尝试将项目（字符）放入尚未分配的数组中。你需要类似的东西

```
char answer[] = new char[size]; 
```

在将字符放入其中之前的某个时间点。

# sql-server - 如何快速调查表列（不同值的计数）

> ID：14714702
> 
> 赞同：2
> 
> 时间：2013-02-05T18:51:16.987
> 
> 标签：sql-server, r

高级用户经常使用 SQL 和其他语言（例如，R）。在探索一个表（例如，带有疾病数据）时，可能有一个严重性列，其值为轻度、中度、重度。

在许多语言（例如，R）中，用户可以编写

```
table(diseasedata$severity) 
```

并查看一个快速表，每个严重性有多少行（行数）。

```
mild      20321
moderate  3512
severe    35135 
```

一个没有权限编写自己的函数而只​​有普通 tsql 权限的用户，是否有一个类似于 table(column) 的智能 TSQL 命令来生成一个很好的列概览？

我正在寻找比 'select severity, count(*) from tbl group by severity' 更高级和更短的东西！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:07:37.603

如果不创建自己的函数/视图......那么不，这就像开箱即用的 Sql 一样简洁：

```
select severity, count(*) from tbl group by severity 
```

也许我只是习惯了 Sql，但这对我来说似乎很短而且很甜蜜......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:06:25.787

抱歉批评，但如果“更高级”的意思是“更复杂”，为什么你想要更复杂的代码 - 让你得到相同的答案（作为一个群体）？我确定不是这样。

假设您的意思是您只需要近似分布，并且在没有任何好的索引的非常大的数据集列（即> = 数十亿行）上。我使用的另一种方法是尝试使用命令 DBCC SHOW_STATISTICS ( [http://msdn.microsoft.com/en-us/library/ms174384.aspx](http://msdn.microsoft.com/en-us/library/ms174384.aspx) ) 在该表上查找一些列统计信息。如果幸运的话，速度会非常快，在几毫秒内返回超过 100,000,000,000 行的分布。但是，它们只是近似值，可能已经过时，或者如果你不走运 - 根本不存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T07:04:51.353

您可以使用带有一些动态 SQL 的代码片段，您只需更改几个变量的分配即可查询不同的表和不同的字段。

```
declare @TableName sysname = 'diseasedata'
declare @FieldName sysname = 'severity'

declare @SQL nvarchar(max)
set @SQL = 'select '+quotename(@FieldName)+', count(*) as C
            from '+quotename(@TableName)+'
            group by '+quotename(@FieldName)
exec (@SQL) 
```

# python - 对 QTableWidgetItem 进行数字排序

> ID：14714704
> 
> 赞同：0
> 
> 时间：2013-02-05T18:51:17.667
> 
> 标签：python, pyqt, qtablewidget

我正在尝试使用 python 和 pyqt4 创建一个表。

目前它会像这样对项目进行排序

```
100, 10, 1, 2 
```

ETC..

它需要这样排序：

```
1,2,10,100 
```

ETC

我目前正在使用

```
self.table.setSortingEnabled(True) 
```

但我认为这就是导致它排序的原因？有人可以帮我正确排序吗

窗口的完整代码在这里：

```
def BuildCustomerDetails(self):

    # Create Table
    self.mainLayout = QtGui.QGridLayout()

    # Construct table items

    db = sqlite3.connect("Database")
    cursor = db.cursor()

        #ID
    cursor.execute("""SELECT ID FROM Customer;""")
    items = cursor.fetchall()
    ID = []
    for row in items:
        item = row[0]
        ID.append(item)

        #First name
    cursor.execute("""SELECT FirstName FROM Customer;""")
    items = cursor.fetchall()
    firstName = []
    for row in items:
        item = row[0]
        firstName.append(item)
    height = len(items)

        #Surname
    cursor.execute("""SELECT Surname FROM Customer;""")
    items = cursor.fetchall()
    Surname = []
    for row in items:
        item = row[0]
        Surname.append(item)

        #First Line Address
    cursor.execute("""SELECT firstLineAddress FROM Customer;""")
    items = cursor.fetchall()
    firstLineAddress = []
    for row in items:
        item = row[0]
        firstLineAddress.append(item)

        #Second Line Address
    cursor.execute("""SELECT SecondLineAddress FROM Customer;""")
    items = cursor.fetchall()
    SecondLineAddress = []
    for row in items:
        item = row[0]
        SecondLineAddress.append(item)

        #Town
    cursor.execute("""SELECT Town FROM Customer;""")
    items = cursor.fetchall()
    Town = []
    for row in items:
        item = row[0]
        Town.append(item)

        #Postcode
    cursor.execute("""SELECT Postcode FROM Customer;""")
    items = cursor.fetchall()
    Postcode = []
    for row in items:
        item = row[0]
        Postcode.append(item)

    # TABLE
    self.table = QtGui.QTableWidget(height,7,self)

    self.horizontalHeaderItem1 = QtGui.QTableWidgetItem("ID")
    self.horizontalHeaderItem2 = QtGui.QTableWidgetItem("First Name")
    self.horizontalHeaderItem3 = QtGui.QTableWidgetItem("Surname")
    self.horizontalHeaderItem4 = QtGui.QTableWidgetItem("Address Line 1")
    self.horizontalHeaderItem5 = QtGui.QTableWidgetItem("Address Line 2")
    self.horizontalHeaderItem6 = QtGui.QTableWidgetItem("Town")
    self.horizontalHeaderItem7 = QtGui.QTableWidgetItem("Post Code")

    self.table.setHorizontalHeaderItem(0,self.horizontalHeaderItem1)
    self.table.setHorizontalHeaderItem(1,self.horizontalHeaderItem2)
    self.table.setHorizontalHeaderItem(2,self.horizontalHeaderItem3)
    self.table.setHorizontalHeaderItem(3,self.horizontalHeaderItem4)
    self.table.setHorizontalHeaderItem(4,self.horizontalHeaderItem5)
    self.table.setHorizontalHeaderItem(5,self.horizontalHeaderItem6)
    self.table.setHorizontalHeaderItem(6,self.horizontalHeaderItem7)

    self.table.setWindowFlags(Qt.Dialog)
    self.table.setSortingEnabled(True)

    ## ADD DATABASE ITEMS TO TABLE

        #ID
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(ID[i])
        self.table.setItem(i,0,item)

        #product code
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(firstName[i])
        self.table.setItem(i,1,item)

        #Surname
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(Surname[i])
        self.table.setItem(i,2,item)

        #firstLineAddress
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(firstLineAddress[i])
        self.table.setItem(i,3,item)

        #SecondLineAddress
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(SecondLineAddress[i])
        self.table.setItem(i,4,item)

        #Town
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(Town[i])
        self.table.setItem(i,5,item)

        #Postcode
    for i in range(1, height):
        item = QtGui.QTableWidgetItem(Postcode[i])
        self.table.setItem(i,6,item)

    # Create Widgets
    self.AddButton = QtGui.QPushButton("Add Customer",self)
    self.RemoveButton = QtGui.QPushButton("Remove Customer",self)
    self.MoreButton = QtGui.QPushButton("More Details",self)
    self.BackButton = QtGui.QPushButton("Back",self)

    # Create Layouts
    self.VLayout = QtGui.QVBoxLayout()
    self.HLayout = QtGui.QHBoxLayout()

    # Assemble

    self.VLayout.addWidget(self.AddButton)
    self.VLayout.addWidget(self.RemoveButton)
    self.VLayout.addWidget(self.MoreButton)
    self.VLayout.addWidget(self.BackButton)

    self.HLayout.addWidget(self.table)

    self.mainLayout.addLayout(TopBar(self),0,0,1,5)
    self.mainLayout.addLayout(self.VLayout,2,4)
    self.mainLayout.addLayout(self.HLayout,1,0,4,4)

    self.table.itemSelectionChanged.connect(self.getCell)

    self.MoreButton.clicked.connect(self.MoreCustomerDetailsLaunch)
    self.BackButton.clicked.connect(self.Back)
    self.AddButton.clicked.connect(self.AddCustomerLaunch)

    Menu(self)

    return self.mainLayout 
```

谢谢

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T11:51:34.707

像这样重新实现 QTableWidgetItem：

```
class MyTableWidgetItem(QtGui.QTableWidgetItem):
    def __init__(self, number):
        QtGui.QTableWidgetItem.__init__(self, number, QtGui.QTableWidgetItem.UserType)
        self.__number = number

    def __lt__(self, other):
        return self.__number < other.__number 
```

因此，如果您需要按数字排序，请使用 MyTableWidgetItem 而不是 QTableWidgetItem，如下所示：

```
for i in range(1, height):
        item = MyTableWidgetItem(numbers[i])
        self.table.setItem(i,0,item) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:41:24.383

该类`QTableWidget`不提供自定义排序过程的 API。如果您愿意，可以尝试重新实现`QTableWidgetItem`的`__lt__`运算符，至少这似乎适用于 C++，如[本](https://stackoverflow.com/questions/7848683/how-to-sort-datas-in-qtablewidget)答案所示。

实现此目的的另一种方法是在从 python 端将项目添加到表时对项目进行排序，并避免在视图中设置启用排序。当您从数据库中获取数据时，您应该按您想要的列对列进行排序，然后才`QTableWidgetItem`为它们创建 s。显然，如果您想动态更新列表，或者如果您想将顺序从升序更改为降序，这将变得相当复杂。

# tomcat - 名为 [create_subscription] 和 [servlet.create] 的 servlet 都映射到不允许的 url-pattern [/create]

> ID：14714706
> 
> 赞同：3
> 
> 时间：2013-02-05T18:51:22.163
> 
> 标签：tomcat, servlets, war

我在 JDK 7 中使用 Tomcat 7 和 Eclipse 来创建这个简单的 servlet 应用程序。但是当我将war文件复制到tomcat时，我无法启动它并得到这个错误：

> > 名为 [create_subscription] 和 [servlet.create] 的 servlet 都映射到不允许的 url-pattern [/create]

web.xml 是：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">
<display-name>CC</display-name>
  <welcome-file-list>
  <welcome-file>index.html</welcome-file>
  <welcome-file>index.htm</welcome-file>
  <welcome-file>index.jsp</welcome-file>
  <welcome-file>default.html</welcome-file>
  <welcome-file>default.htm</welcome-file>
  <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>

<servlet>
  <servlet-name>create_subscription</servlet-name>
  <servlet-class>servlet.create</servlet-class>
</servlet>

<servlet-mapping>
  <servlet-name>create_subscription</servlet-name>
  <url-pattern>/create</url-pattern>
</servlet-mapping>

</web-app> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-15T01:42:03.893

如果您在 web.xml 和注释中声明了相同的映射，那么在更高版本的 Tomcat 中您将得到这个精确的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-23T09:26:52.373

检查您的 servlet 类。它会有@WebServlet("/xyz")。评论这一行，然后它应该可以正常工作。

或者您可以将其用作 @WebServlet(value="/create",name="create_subscription")

实际上，当您使用 @WebServlet("/xyz") 时，它会将 servlet 名称视为完全限定的 servlet 名称。所以tomcat认为你有一个URL有两个servlet映射，这就是它给你错误的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T11:34:44.800

我怀疑 servlet.create 可能还有另一个条目 你能查看 web.xml 里面的 war 吗？

如果结果没问题，可能会将包声明从 servlet.create 更改为其他内容，例如 com.test 并重新运行。

至于为什么 2 个 servlet 不能映射到完全相同的 Url 模式

> servlet 规范没有明确说明，但有些服务器不允许这样做。此外，有两个具有完全相同的 URL 没有意义，因为 servlet 匹配的 url 在第一次匹配时停止。

[Servlet 2.4](https://jira.sakaiproject.org/secure/attachment/16135/servlet-2_4-fr-spec.pdf)规范 PDF 参见 p. 85+

# java - 无法在 JUnit 测试用例中访问父类方法

> ID：14714708
> 
> 赞同：2
> 
> 时间：2013-02-05T18:51:26.707
> 
> 标签：java, unit-testing, inheritance, junit

我正在尝试测试一个具有几十个继承类的抽象类“Comando”。我真正想要测试的是许多不同的 chuld 类，以测试每种不同的行为（“Comando”转换为命令），我的测试用例类似于：

```
public void testComandoGetInfo() {
    ComandoGetInfo cmd = new ComandoGetInfo(equip);
    equip.executarComando(cmd, true, true);
    cmd.getStatus();
} 
```

注意线`cmd.getStatus()`。当我写这行时，NetBeans 给了我一个“找不到方法”的编译错误。当我切换代码完成时，我看不到任何 Comando 的方法，只有 TestCase 测试方法和 ComandoGetInfo 类上的单个方法。

ComandoGetInfo 是一个扩展 Comando 的类，它有很多很多的方法和变量，包括公共的和私有的。

那么为什么我不能访问父类 Comando 的任何方法（我的意思是任何方法，甚至是 getter、setter、公共方法或变量，任何东西，甚至不是静态方法），如果我不能访问它如何测试呢？

**编辑：**发现错误是什么。我只是将测试类命名为与原始类完全相同，因此 Comando.java 的测试类是... Comando.java，位于测试文件夹的同一包中。在我将文件重命名为正确的名称“ComandoTest.java”后，一切都恢复了正常。

# java - 为什么要为域实体使用接口？

> ID：14714715
> 
> 赞同：2
> 
> 时间：2013-02-05T18:51:52.080
> 
> 标签：java, interface, entity

为域实体使用接口的目的是什么？

在我们的项目中，我们使用域实体的接口。在接口内部，只有 getter 和 setter 方法，甚至没有任何领域逻辑。

为这样的实体使用接口有用吗？这是好习惯吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T19:18:20.550

*有时*它是一个好主意的原因有很多，但这实际上取决于项目的范围。

首先：您的陈述“......甚至没有任何领域逻辑。” 没有意义，接口中不能有任何逻辑，接口不能有任何逻辑，只有方法签名。

这样做的主要原因是为了支持不同用途的域对象的多种实现。

您可能希望将域对象编码为接口的原因：

1.  序列化 - 有时您想要创建域对象的可序列化版本，但不想将该代码与您用于核心应用程序的代码混合在一起。例如，您可能有一个 Person 对象的实现，您只是使用它来为您的 webapp 序列化为 JSON。

2.  共享 API - 您可能希望分发具有不同对象实现的代码的公共 API 版本，或者您甚至可能只想将接口提供给另一个组（或客户端或供应商）

3.  支持遗留实现 - 也许您在旧数据库中有一些数据，您需要为此构建一个连接器，这涉及到您的域对象的不同实现以提取数据。

4.  测试 - 为您的核心类提供接口使单元测试变得更加容易，因为您可以快速排除测试不需要的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T18:55:15.410

*   我从来没有参与过发生这种事情的项目。
*   它不是典型的设计；
*   我从未听过或读过有人声称这是一种好习惯；
*   我想不出这样的设计有什么好处。
*   我**能**想到它造成的麻烦。

当您访问数据对象的公共实例字段时，您已经在“按合同编程”——这就是您从 bean 获得的所有合同。访问器层什么也没增加，更不用说另一层接口了。Java Beans 承认了这样一个事实，即很多数据就是这样——数据——并且将其封装在合约后面只会损害它的实用性。FP，可能是现存最好的编程范式，正确地理解了这一点。

有人可能会问（实际上是@pst :)，如果不同的实体实现不同的序列化策略会怎样？如果他们在内部以不同的方式存储数据怎么办？也许一个人是超级聪明的，并且出于“性能”的原因做了很多位玩弄。

是的，我们当然可以想象**一些**实际需要这样做的场景，但它反过来：**首先**你意识到你将做这样一个项目，**然后**你围绕 bean 引入接口。你不会提前做，因为“也许，只是也许，这个疯狂的需求会出现在我们项目的中间”。实践清楚地表明，这几乎不会发生。

另外，不要忘记构造函数在这样的设计中是不可能的。强制执行一个项目范围的策略来为每一个领域数据编写抽象工厂——并且没有明确的原因——绝对不是人们可以称之为合理的设计选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:02:21.807

我见过一些开发人员将“代码到接口”的建议走得太远了。他们认为他们应该**始终**使用界面，以防万一有一天它会派上用场。

# mysql - 一个我不知道怎么写的 SQL 查询（aMember wordpress 插件）

> ID：14714717
> 
> 赞同：0
> 
> 时间：2013-02-05T18:51:57.087
> 
> 标签：mysql, amember

我目前正在使用 aMember 来管理 WordPress 网站的付款，以强制实施付费墙。我不是设置它的管理员，我仍在学习他们的数据库。另外，我的 SQL-fu 很弱；我不是受过培训的工程师，但我是组织中唯一一个完全了解任何 SQL 的人。

我的 CFO 想要一份报告，按天细分新注册的数量，可以追溯到两年前。据我所知，aMember 没有对此进行简单的细分。它所拥有的是我们收到的每一笔付款的完整记录。

我可以轻松地按日期分解此付款记录，以查看我们在给定日期收到了多少付款。问题是，其中许多付款来自现有用户。此外，我们还有订阅、取消和重新订阅的用户。我们的门槛是 30 天，因为我们认为这是“完全失效”。因此，我们希望忽略在 [日期] 30 天内付款已过期的用户在 [日期] 支付的任何款项。

示例：John Smith 于 2012 年 12 月 1 日订阅。John Smith 的最后一笔付款于 2013 年 1 月 1 日到期。约翰的帐户没有更新。约翰于 2013 年 1 月 5 日重新订阅。约翰的付款应在 2012 年 12 月 1 日算作“新”付款（因为他之前没有记录在案），但不是在 2013 年 1 月 5 日（因为他的付款在 1 月 1 日到期，在 30 天内） 1/5 付款）。

架构如下。当前查询不会过滤掉现有会员的续订并且只是收到的付款计数，如下所示。如果需要任何其他信息，或者有人知道我以外的成员，请让我知道我还能提供什么来帮助回答。我在我的头上，尽我所能！

```
SELECT begin_date, COUNT( payment_id ) 
FROM  [foo] 
WHERE amount >0
GROUP BY begin_date
ORDER BY begin_date DESC 

payment_id
member_id
product_id
begin_date
expire_date
paysys_id
receipt_id
amount
completed
remote_addr
data 
time 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T06:16:33.793

我认为这会做到。它可能需要一些调整。我不确定amount > 0 的*确切*作用，但它也包含在子查询中。

针对一些好的测试数据运行它以确保它产生正确的结果可能是一个好主意。

```
SELECT begin_date, COUNT( payment_id ) 
FROM  [foo] f1
WHERE amount > 0
AND 
-- don't count it if there's another subscription from this member that expires between the 30 days previous to this one and the end of this one.
(select count(expire_date) from [foo] f2 where f1.member_id = f2.member_id and 
    f2.expire_date BETWEEN DATE_ADD(f1.begin_date, INTERVAL -30 day) and f1.expire_date 
    and f1.payment_id <> f2.payment_id and amount > 0) = 0
GROUP BY begin_date
ORDER BY begin_date DESC 
```

# javascript - 使用 jquery append() 对标签进行网格布局

> ID：14714719
> 
> 赞同：0
> 
> 时间：2013-02-05T18:52:04.170
> 
> 标签：javascript, jquery, html

我有一个包含一些地址信息的对象，我想将其添加`append()`到 HTML 表中。

表是这样开始的：

```
<table class="shipping_information" border="1">

</table> 
```

然后我将我的地址信息放入另一个表（此处为第 5 行），并将该表放入`<td>`. 我正在努力做到这一点，以便有最大数量的`<td>`s（这里是 2）。如果超过2，`<tr>`将追加一个新的。

```
function add_shipping_address_to_shipping_container(address_obj, shipping_container) {
    var append_to_table = "";
    var table = shipping_container.find('table.shipping_information');
    var max_td = 2;
    var formatted_address = format_address(address_obj); //returns a table with the address

    //are there any rows in the table
    var is_tr = table.find('tr.shipping_address_container_table').length;
    if (!is_tr) {
        //no tr so append tr and td
        //colspan should be max_td
        append_to_table = "<tr class='add_container'><td class='add_container'>" + formatted_address +"</td></tr>"
    } else {
        //there is a tr
        var last_tr = table.find('tr.add_container:last');
        //number of tds in the last row
        var num_td = last_tr.find('td.add_container').length;
        if (num_td >= max_td) {
            append_to_table = "<tr class='add_container'><td class='add_container'>" + formatted_address + "</td></tr>";
        } else {
            append_to_table = "<td class='add_container'>" + formatted_address + "</td>";
        }

    }
    table.append(append_to_table);
} 
```

但是，`<td>`s 并没有像我想象的那样附加。它`<tr>`每次都会做一个新的。当我打印变量时`append_to_table to the console`，它看起来是正确的。`<tr><td></td></tr>`什么时候应该有，`<td></td>`什么时候应该有。jquery 或 chrome 是否`<tbody>`每次都会自动附加一个新的？

[jsbin](http://jsbin.com/ozemog/1/edit)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:09:59.040

当您检查新行时，您正在搜索一个类`shipping_address_container_table`，但是当您创建新行时。您只是添加一个带有 class 的 tr `add_container`。

`!is_tr`您当前的代码除了第一部分（总是 == `true`）之外什么也没做。那可能是你的问题。

另外，我将现有`tr`元素的追加移到了，`tr`而不是 ，`table`以确保 jquery 不会自动将 包装`td`在新的`tr`.

这对我有用：

```
function add_shipping_address_to_shipping_container(address_obj, shipping_container) {
    var append_to_table = "";
    var table = shipping_container.find('table.shipping_information');
    var max_td = 2;
    var formatted_address = format_address(address_obj); //returns a table with the address
    //are there any rows in the table
    var is_tr = table.find('tr.add_container').length;
    if (!is_tr) {
        //no tr so append tr and td
        //colspan should be max_td
        append_to_table = "<tr class='add_container'><td class='add_container'>" + formatted_address + "</td></tr>";
    table.append(append_to_table);
    } else {
        //there is a tr
        var last_tr = table.find('tr.add_container:last');
        //number of tds in the last row
        var num_td = last_tr.find('td.add_container').length;
        if (num_td >= max_td) {
            append_to_table = "<tr class='add_container'><td class='add_container'>" + formatted_address + "</td></tr>";
    table.append(append_to_table);
        } else {
            append_to_table = "<td class='add_container'>" + formatted_address + "</td>";
    last_tr.append(append_to_table);
        }

    }
}

function format_address(address_obj){

    var address_table = "<table border='1'>";

    address_table += ("<tr><td class='shipping_address_table'>" + address_obj.attn + "</td></tr>");
    address_table += ("<tr><td class='shipping_address_table'>" + address_obj.company_name + "</td></tr>");
    address_table += ("<tr><td class='shipping_address_table'>" + address_obj.address_1 + "</td></tr>");

    address_table += "</table>";

    return address_table;
}

$(document).ready(function(){
  $('body').on('click', '#button', function(){
  var address_obj = {
    attn : "sample attention",
    company_name : "sample company",
    address_1 : "sample line 1"
  },
  shipping_container = $('#wrapper');

  add_shipping_address_to_shipping_container(address_obj, shipping_container);
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:12:40.697

`<tr>`当您尝试附加`<td>`到元素时， jQuery 会自动添加标签`<table>`，因此您必须将其附加到 last `<tr>`。

[http://jsbin.com/exutaq/1/edit](http://jsbin.com/exutaq/1/edit)

此外，您对现有行的检查是错误的：

```
var is_tr = table.find('tr.shipping_address_container_table').length; 
```

应该：

```
var is_tr = table.find('tr.add_container').length; 
```

# python - 高效的阵列存储

> ID：14714720
> 
> 赞同：1
> 
> 时间：2013-02-05T18:52:16.917
> 
> 标签：python, arrays, numpy, replace, storage

我有一个大（300,000 行 x 25 列）数组，我读过

```
dataset = numpy.genfromtxt(DataFileName,dtype="string",delimiter=',') 
```

然后清理换行符和引用。我尝试通过两种方式做到这一点：

**第一种清理方法**

```
for i in range(len(dataset)): 
    for j in range(len(dataset[i])):
        dataset[i][j] = dataset[i][j].replace("\n", "").replace("\"", "") 
```

**第二种清理方法**

```
dataset = [ [word.replace('\n','').replace('"','') for word in dataset[i]] for i in range(len(dataset))] 
```

在此之后，我对数组进行了一些密集搜索以计算一堆东西。如果我用第二种方式而不是第一种方式进行清理，搜索速度会*快 5 倍。*是什么原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:45:45.950

一般来说，列表推导（第二种方式）比 for 循环更快。我忘记了它的原因。

此外，如果您有一个大型数据集，使用 xrange() 比使用 range() 更快，因为 xrange() 返回一个小型生成器，它会即时生成数据。而 range() 返回整个列表 [0 .. 300,000]。

最后，您应该考虑完全取消 range()、xrange()：

```
dataset = [[word.replace('\n','').replace('"','') for word in line] for line in dataset] 
```

这样做更干净，应该更快，因为您不处理数组订阅，这需要时间。

# c# - ListView isSelected

> ID：14714723
> 
> 赞同：9
> 
> 时间：2013-02-05T18:52:27.150
> 
> 标签：c#, xaml, windows-8, winrt-xaml

我有一个列表视图，我`xaml`用这样的项目填充：

```
List<DataLayer.Models.Dictionary> dicts = DataLayer.Manager.getDictionaries();

if (dicts != null)
{
    foreach (DataLayer.Models.Dictionary dict in dicts)
    {
         this.itemListView.Items.Add(dict);
    }
} 
```

我的`DataLayer.Models.Dictionary`对象有一个`isSelected`属性以及 a`Name`和 a `SubName`。

Name 和 SubName 在模板中工作正常，但是当用户单击一个项目时，我怎样才能让项目被选中并更新？

谢谢！

**编辑：**

我的 xaml 现在看起来像这样，但该项目仍未选中

```
 <ListView
        x:Name="itemListView"
        TabIndex="1"
        Grid.Row="1"
        Margin="0,60,0,0"
        Padding="0,0,0,0"
        IsSwipeEnabled="False"
        ScrollViewer.VerticalScrollBarVisibility="Hidden"
        SelectionChanged="itemListView_SelectionChanged_1"
        SelectionMode="Multiple"
        FontFamily="Global User Interface">
        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="IsSelected" Value="{Binding Source=Selected,Mode=TwoWay}"/>
            </Style>
        </ListView.ItemContainerStyle>
        <ListView.ItemTemplate>
            <DataTemplate>
                <Grid Margin="6">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Margin="0,0,0,0">
                        <TextBlock Text="{Binding Name}"/>
                        <TextBlock Text="{Binding SubName}" Style="{StaticResource CaptionTextStyle}" TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T09:50:16.773

[编辑] 刚刚注意到这个问题实际上并没有标记 WPF；但我希望它仍然适用。

WPF 本质上是 MVVM。直接在代码后面操作控件通常不是一个好主意。因此建议创建一个名为 ViewModel 的“视图友好”模型；[见这里](http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial)。此外，要使绑定发挥作用，在不断变化的环境中，您必须通知属性和/或集合的更改，以便可以更新控件。

首先，您有一个字典集合，因此您创建了这个集合，以便它可以通知更改；[ObservableCollection](http://msdn.microsoft.com/en-GB/library/ms668604.aspx)可以做到这一点。作为一般经验法则，WPF 使用的任何集合都应该只使用 ObservableCollection，和/或从它派生。

所以这是竞争工作示例：

请记住，我正在使用[FODY](https://github.com/Fody/PropertyChanged)来注入我的 PropertyChanged raisers；[见手动完成](http://msdn.microsoft.com/en-gb/library/system.componentmodel.inotifypropertychanged%28v=vs.95%29.aspx)

```
public class Dict : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    public string Name { get; set; }
    public string SubName { get; set; }
    public bool Selected { get; set; }
}

public class ViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    public ObservableCollection<Dict> Dictionaries { get; set; }

    public ViewModel()
    {
        Dictionaries = new ObservableCollection<Dict>()
        {
            new Dict()
                {
                    Name = "English",
                    SubName = "en",
                    Selected = false,
                },

                new Dict()
                {
                    Name = "English-British",
                    SubName = "en-uk",
                    Selected = true
                },

                new Dict()
                {
                    Name = "French",
                    SubName = "fr",
                    Selected = true
                }
        };

        Dictionaries.CollectionChanged += DictionariesCollectionChanged;
    }

    private void DictionariesCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch(e.Action)
        {
            case NotifyCollectionChangedAction.Add:
                foreach(var dict in e.NewItems.Cast<Dict>())
                    dict.PropertyChanged += DictionaryChanged;
                break;
            case NotifyCollectionChangedAction.Remove:
                foreach (var dict in e.OldItems.Cast<Dict>())
                    dict.PropertyChanged -= DictionaryChanged;
                break;
        }
    }

    private void DictionaryChanged(object sender, PropertyChangedEventArgs e)
    {
        Dict dictionary = (Dict)sender;

        //handle a change in Dictionary
    }
} 
```

有了它，您可以随时添加或删除对象，尽管这里我只是在构造函数中初始化它们。

然后你会在你的窗口或控件中有这个。我已经包含了命名空间以使其更加独立；但这适用于 WPF 命名空间。

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
        xmlns:local="clr-namespace:WpfApplication1">

    <Window.Resources>
        <local:ViewModel x:Key="viewmodel"/>
    </Window.Resources>

    <ListView
        x:Name="itemListView"
        DataContext="{StaticResource ResourceKey=viewmodel}"
        ItemsSource="{Binding Path=Dictionaries}"
        SelectionMode="Multiple">

        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="IsSelected" Value="{Binding Path=Selected, Mode=TwoWay}"/>
            </Style>
        </ListView.ItemContainerStyle>

        <ListView.ItemTemplate>
            <DataTemplate>
                <Grid Margin="6">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Margin="0,0,0,0">
                        <TextBlock Text="{Binding Name}"/>
                        <TextBlock Text="{Binding SubName}" TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </DataTemplate>
        </ListView.ItemTemplate>
    </ListView>
</Window> 
```

如果您不为您的集合使用 ObservableCollection，然后在 WPF 加载*后*开始向其中添加元素，它将永远不会通知绑定管理器应该更新 ListView。

上面的启动：

![开始时，注意力不集中](../Images/bc334008fc0f1c09b09b80c12ae05615.png)

你可以很容易地看到底层的字典集合正在被改变（即不仅仅是 ListView），通过覆盖选择的返回值：

```
public bool Selected { get { return true; } set {/* do nothing*/ }} 
```

这意味着始终选择所有内容，即使您尝试在视图中取消选择它。它总是看起来像这样：

![始终选中](../Images/ac86108f275fc89a90aaef08ff200611.png)

样式是一个不同的问题，如果没有焦点，列表看起来会有所不同。[看这里](https://stackoverflow.com/questions/4217735/wpf-selected-unfocused-color-of-listviewitem-with-a-gridview?lq=1)

现在可以在代码隐藏中对选择更改做出反应，但这会将逻辑与视图混合。

[编辑] 更新以包括检测任何字典中的更改的能力（包括选择更改时）

[您可以研究一下以简化它](https://stackoverflow.com/questions/8490533/notify-observablecollection-when-item-changes)

希望这可以帮助。

# android - 恢复由 for 循环创建的表的状态

> ID：14714728
> 
> 赞同：0
> 
> 时间：2013-02-05T18:52:43.507
> 
> 标签：android

大家好，我使用表格布局创建了一个动态表格，方法是添加我在不同活动中的编辑文本中输入的值。我使用 for 循环不断地向表中添加值。所以我的问题是如何保存这些值和包含这些值的整个活动，并能够从活动停止的点继续，因为当活动退出时，值会丢失，所以这是一个很大的问题问题。预先感谢您的任何回复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:18:57.783

您可以使用[共享首选项](http://developer.android.com/reference/android/content/SharedPreferences.html)。

# c# - 为什么我的 RunWorkerCompleted 没有收到 RunWorkerCompletedEventArgs？

> ID：14714730
> 
> 赞同：1
> 
> 时间：2013-02-05T18:52:53.430
> 
> 标签：c#, backgroundworker, .net-4.5

我可以从我的调试消息中看到，通过 DoWorker 方法，e.Result 一直等于“Success”，但在 RunWorkerCompleted 方法的开头，e.Result 根本不返回任何内容。

这是 WinForm 的 __construct

```
public LicenseValidator()
{
    // Initialize the UI
    InitializeComponent();

    // Start the background worker
    BackgroundWorker worker = new BackgroundWorker();
    worker.DoWork += new DoWorkEventHandler(worker_DoWork);
    worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(worker_RunWorkerCompleted);
    worker.RunWorkerAsync();

    // Tell debug log that the UI thread is still processing
    Debug.WriteLine("UI thread running");  
} 
```

这是我的 worker_DoWork 方法

```
public async void worker_DoWork(object sender, DoWorkEventArgs e)
{
    // Tell debug log that the worker thread is now running
    Debug.WriteLine("Worker thread running");

    // Define variables
    String HWID = Security.FingerPrint.Value();
    String APIPath = "http://xxxxxxxxx.net/api.php";
    String Serial;
    HttpClient client = new HttpClient();
    HttpResponseMessage response;
    String responseString;

    // Check for license in AppData
    try{
        // Get license path
        String licensePath = Environment.GetEnvironmentVariable("APPDATA") + @"\UniLeech\License.txt";
        // License exists, validate it
        if (File.Exists(licensePath))
        {
            Serial = File.ReadAllText(licensePath);
            Debug.WriteLine(Serial);
            response = await client.GetAsync(APIPath + "?hwid=" + HWID + "&serial=" + Serial);
            responseString = await response.Content.ReadAsStringAsync();
            Debug.WriteLine(responseString);
            dynamic jObj = JsonConvert.DeserializeObject(responseString);
            if (jObj.success == "true")
            {
                Debug.WriteLine("License validation was successful");
                e.Result = "Success";
            }
            else
            {
                e.Result = jObj.error;
            }
            Debug.WriteLine(e.Result);
        }
        // License does not exist, prompt for one
        else
        {
            Debug.WriteLine("License file not found");
            e.Result = "Unregistered";
        }
    } 
```

最后我的 worker_RunWorkerCompleted 方法

```
public void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    Debug.WriteLine("Worker completed");
    String result = e.Result as String;
    if ((e.Error == null))
    {
        Debug.WriteLine("No errors");
        Debug.WriteLine("Result = " + result);
        if (e.Cancelled)
        {
            Debug.WriteLine("Worker cancelled");
        }
        switch ((String)e.Result.ToString())
        {
            case "Success":
                this.Hide();
                this.ShowInTaskbar = false;
                Main mainForm = new Main();
                mainForm.Show();
                break;

            case "Banned":
                popupError("ERROR: License revoked!",
                           "Your license has been revoked, contact Time Sheep for more information. You can purchase a new one by visiting the ordinary order link."
                          );
                break;

            case "Invalid":
                popupError("ERROR: Invalid serial/HWID",
                           "Either your serial number or hardware identifier was invalid. If you purchased UniLeech, please contact Time Sheep with proof of purchase."
                          );
                break;

            case "Unregistered":
                this.Hide();
                this.ShowInTaskbar = false;
                Register registerForm = new Register();
                registerForm.Show();
                break;

            default:
                MessageBox.Show((string)e.Result, "ERROR");
                break;
        }
    }
} 
```

执行时会出现以下调试消息（案例：我有文件并且 e.Result 应该是“成功”）：

```
UI thread running
Worker thread running
0123-1234-1234 (The value of Serial)
Worker completed
No errors
{"success": "true","action": "validate","error": "None"} (Returned from web API)
License validation was successful
Success
RunWorkerCompleted finished 
```

我怀疑这个问题是由于 DoWork 方法是异步的，但我不知道如何同步使用 HttpClient。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T18:56:53.320

你不能有一个`async` `DoWork`. `BackgroundWorker`假设`DoWork`返回时，它已完成。

你根本不需要`BackgroundWorker`。改用就好`Task.Run`了。

# ruby-on-rails - rspec 预期不符合我的预期

> ID：14714734
> 
> 赞同：4
> 
> 时间：2013-02-05T18:53:10.030
> 
> 标签：ruby-on-rails, ruby, unit-testing, rspec, factory-bot

所以我有两个规格，我认为它们正在测试相同的东西，但一个失败而另一个通过。我正在开发一个具有重复计划的应用程序。如果用户创建重复的行程，它将继续并为指定的每一天创建新行程。这是第一个失败的测试：

```
it "makes future trips" do
  expect{FactoryGirl.create(:recurring_transportation_trip)}.to change(Trip, :count).by(4)
end 
```

recurring_transportation_trip 创建一个行程，它将通过 after_save 回调进行三个未来行程。此测试失败并出现错误“计数应该已更改 4，但已更改 1”。

这是另一个通过的测试：

```
it "makes future trips" do
  count = Trip.count
  FactoryGirl.create(:recurring_transportation_trip)
  Trip.count == count + 4
end 
```

表明存在正确的功能。

第一个测试当然更具可读性，但实际上并没有测试我认为它做了什么。任何人都可以提供并解释原因吗？

- - - -编辑 - - - -

按要求添加工厂代码：

```
FactoryGirl.define do
  factory :recurring_transportation_trip, :class => :trip do
    collection_time "09:00"
    estimated_duration "60"
    status "Confirmed"
    mileage "30"
    association :collection, :factory => :location
    association :destination, :factory => :location
    association :call, :factory => :recurring_call
  end
end 
```

对于 recurring_call

```
FactoryGirl.define do
  factory :recurring_call, :class => "Call" do
    recurring true
    recurring_start_date Date.today
    recurring_end_date Date.today + 1.week
    recurring_config [1, 3, 5]
  end
end 
```

-------EDIT2--------

事实证明`Trip.count == count + 4`实际上并没有断言任何东西，并且测试`Trip.count.should == count + 4`确实失败了。感谢@BenediktDeicke 指出这一点。

--------EDIT3--------

最后这是我的应用程序代码中的一个错误，我应该从一开始就信任原始测试。感谢所有看过的人。@boulder 和 @BenediktDeicke 感谢您指出 edit2 中提到的缺少断言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:17:48.767

您的第二个测试实际上没有测试任何东西，因为它没有定义任何期望。

该行 `Trip.count == count + 4` 只是一个计算结果为假的表达式。

你想要做的是：

```
Trip.count.should == count + 4 
```

无论如何，第一个测试是您应该信任的；它告诉您您的应用程序代码中存在需要调查的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:58:35.333

by 链匹配器是预期应该改变的量。

```
expect{FactoryGirl.create(:recurring_transportation_trip)}.to change(Trip, :count).by(1) 
```

这是[文档](https://www.relishapp.com/rspec/rspec-expectations/v/2-12/docs/built-in-matchers/expect-change!)。

# java - 远程api gae祖先查询

> ID：14714735
> 
> 赞同：1
> 
> 时间：2013-02-05T18:53:16.613
> 
> 标签：java, google-app-engine, remoteapi

当使用祖先执行查询时，我尝试使用远程 api 并获得异常。

例外：

> 查询必须与包含的祖先键具有相同的应用程序 ID (app)：query.app:'firtsAppId' != query.ancestor.app:'secondAppId'

其中 firtsAppId, secondAppId - 这是我在 appengine-web.xml 上的“远程”和“客户端”中的应用程序 ID

*   AppEngine SDK 1.7.4
*   视窗 8 x64
*   jdk1.6.0_38 x64

下面的代码：

```
RemoteApiOptions options = new RemoteApiOptions().server(appId, 443).credentials(username, password);

installer = new RemoteApiInstaller();
installer.install(options);

DatastoreService service = DatastoreServiceFactory.getDatastoreService();

Entity parentEntity = new Entity("ParentEntity", 1);
parentEntity.setProperty("name", "parent");
Key parentKey = service.put(parentEntity);

Entity childEntity = new Entity("ChildEntity", 1, parentKey);
childEntity.setProperty("name", "child");
service.put(childEntity);

Query q = new Query("ChildEntity").setAncestor(parentKey);
Iterable<Entity> values = DatastoreServiceFactory.getDatastoreService().prepare(q).asIterable();
Iterator<Entity> i = values.iterator();

while (i.hasNext())
{
     Entity e = i.next();
     //some code
}

installer.uninstall(); 
```

堆栈跟踪：

```
java.lang.IllegalArgumentException: query must have same application id (app) as the contained ancestor key: query.app:'firtsAppId' != query.ancestor.app:'secondAppId'
    at com.google.appengine.api.datastore.DatastoreApiHelper.translateError(DatastoreApiHelper.java:33)
    at com.google.appengine.api.datastore.DatastoreApiHelper$1.convertException(DatastoreApiHelper.java:70)
    at com.google.appengine.api.utils.FutureWrapper.get(FutureWrapper.java:94)
    at com.google.appengine.api.utils.FutureWrapper.get(FutureWrapper.java:86)
    at com.google.appengine.api.datastore.FutureHelper.getInternal(FutureHelper.java:71)
    at com.google.appengine.api.datastore.FutureHelper.quietGet(FutureHelper.java:32)
    at com.google.appengine.api.datastore.QueryResultsSourceImpl.peekQueryResultAndIfFirstRecordIndexList(QueryResultsSourceImpl.java:161)
    at com.google.appengine.api.datastore.QueryResultsSourceImpl.loadMoreEntities(QueryResultsSourceImpl.java:104)
    at com.google.appengine.api.datastore.QueryResultsSourceImpl.loadMoreEntities(QueryResultsSourceImpl.java:91)
    at com.google.appengine.api.datastore.QueryResultIteratorImpl.ensureLoaded(QueryResultIteratorImpl.java:142)
    at com.google.appengine.api.datastore.QueryResultIteratorImpl.hasNext(QueryResultIteratorImpl.java:62) 
```

上面的代码在本地和部署时都不起作用。

# java - Gson 解析冻结

> ID：14714738
> 
> 赞同：0
> 
> 时间：2013-02-05T18:53:21.267
> 
> 标签：java, json, gson

我有这个 .json 类型

```
{"paging":{"page":1,"total":2015,"page_size":20,"pages":101},

"loans":[
    {
    "id":519729,
    "name":"Hefseba Group",
    "description":{"languages":["en"]},
    "status":"fundraising",
    "funded_amount":3125,
    "basket_amount":0,
    "image":{"id":1280581,"template_id":1},
    "activity":"Cafe",
    "sector":"Food",
    "use":"to buy more stock for her cafe, and to buy more fabrics and liquid soap.",
    "location":{"country_code":"TZ",
    "country":"Tanzania",
    "geo":{"level":"country","pairs":"-6 35","type":"point"}},
    "partner_id":87,
    "posted_date":"2013-02-01T09:14:17Z",
    "planned_expiration_date":"2013-03-03T09:14:17Z",
    "loan_amount":4025,
    "borrower_count":16
    },

    {
    "id":520550,"name":"Waridi Pendo Group",
    "description":{"languages":["en"]},
    "status":"fundraising",
    "funded_amount":800,
    "basket_amount":0,
    "image":{"id":1282077,"template_id":1},
    "activity":"Music Discs & Tapes",
    "sector":"Retail",
    "use":"to buy music equipment and DVDs and CDs, as well as to start building his house. ",
    "location":{"country_code":"TZ",
    "country":"Tanzania",
    "geo":{"level":"country","pairs":"-6 35","type":"point"}},
    "partner_id":87,
    "posted_date":"2013-02-01T09:18:11Z",
    "planned_expiration_date":"2013-03-03T09:18:11Z",
    "loan_amount":6100,
    "borrower_count":11
    }
]

} 
```

然后我有这段代码试图解析它。

```
try{
    JsonReader runThrough = getJsonReader(fileName);
    System.out.println("File found");
    Gson myGson = new Gson();
    JsonParser jsonParser = new JsonParser();
    JsonArray infoArray =  jsonParser.parse(runThrough).getAsJsonArray();
    System.out.println("Finished Parsing");
    for (JsonElement piece : infoArray){

    }
} catch (Exception e){
    System.out.println(e);
} 
```

我希望每笔贷款最终都保存到 kLoan 的数组列表中，但我现在只有一个空循环。我得到的错误冻结在这一行：

```
JsonArray infoArray =  jsonParser.parse(runThrough).getAsJsonArray(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:58:27.343

1.  它不是有效的 JSON 文件。所以也许这就是解析器卡住的原因。有关详细信息，请使用 JSON lint 检查。少了一个逗号。

2.  整个对象不是数组。您需要获得财产贷款并在此元素上调用 getAsJsonArray 方法。像这样：

    ```
    try{
        JsonReader runThrough = getJsonReader(fileName);
        System.out.println("File found");
        Gson myGson = new Gson();
        JsonParser jsonParser = new JsonParser();
        JsonObject jsonObj =  jsonParser.parse(runThrough).getAsJsonObject();
        JsonArray infoArray = jsonObj.getAsJsonArray("loans");
        System.out.println("Finished Parsing");
        for (JsonElement piece : infoArray){

        }
    } catch (Exception e){
        System.out.println(e);
    } 
    ```

# matlab - 直线与矩形相交

> ID：14714739
> 
> 赞同：1
> 
> 时间：2013-02-05T18:53:23.823
> 
> 标签：matlab, line, intersection, rectangles

在matlab中，如何判断一条线是否与矩形相交？

![线条和矩形](../Images/2bf1138c6f131ca40908df61a16774dd.png)

例如，上面的线不与矩形相交，而下面的两条线与矩形相交，

**然后：**我如何通过知道直线的两个点和矩形的另外两个点来确定交叉点的存在？

我的工作：

**方式1：**我正在尝试求解直线和矩形对角线的两个方程，然后检查解点是否在矩形内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:44:19.930

如果线与矩形的任何边相交，则线和矩形相交。您所需要的只是一个线/线相交算法。如需帮助，请尝试在此处或网络上的其他地方搜索。

# python - 如何为 Heroku 添加 git 支持的发行版

> ID：14714741
> 
> 赞同：0
> 
> 时间：2013-02-05T18:53:29.660
> 
> 标签：python, git, heroku

如何将我自己的私有模块添加到 Heroku 的 python 中，以便我的主项目可以`import`我自己的自定义包？

**前任。**我有 1)`git`用于我的 Web 应用程序的存储库和 2) 其他无法通过 使用的存储库，`pip`我想将其添加`import`到我的主项目 (1) 中。

在此处阅读更多信息：[Heroku：由 git 支持的发行版](https://devcenter.heroku.com/articles/python-pip#gitbacked-distributions)

[使用git 子模块](http://git-scm.com/book/en/Git-Tools-Submodules)更好吗？

谢谢。

# html - 如何给 div 一个响应高度

> ID：14714744
> 
> 赞同：15
> 
> 时间：2013-02-05T18:53:33.647
> 
> 标签：html, css, responsive-design

我说要学习响应式设计，但到目前为止，我似乎无法弄清楚一件事......

这是一个工作示例：[http ://ericbrockmanwebsites.com/dev1/](http://ericbrockmanwebsites.com/dev1/)

我希望其中包含文本的 div 元素 (contactBg) 下降到左侧图像的底部。显然，我可以通过以 px 为单位定义高度来做到这一点，但是当窗口的其余部分调整大小而不是流动时，该高度将保持不变。

如果那里有任何好的文章，您可能知道解释如何做到这一点，那将非常有帮助，谢谢！

这是标记：

```
<div class="row-fluid">
        <div class="span10 offset1">
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span5">
                        <img src="images/logo.jpg" alt="logo" />
                        <img src="images/store.jpg" alt="store" />
                    </div><!-- /span5 -->
                    <div class="span7">
                        <img src="images/portal.jpg" alt="portal">
                        <div class="contactBg">
                            Administration: Emma Jane Julien<br />
                            <a href="mailto:ej@emmajulien.com">ej@emmajulien.com</a>
                        </div><!-- /contactBg -->
                    </div><!-- /span7 -->
                </div><!-- /row-fluid -->
            </div><!-- /container-fluid -->
        </div><!-- /span10 offset1 -->
    </div> <!-- /row-fluid --> 
```

这是CSS：

```
 body {
        background: url(../images/3D2A1698A177AF9B71_218.png) repeat;
    }

    img {
        max-width:100%;
        padding-bottom:1%;
    }

     .container-fluid {
        background:#fff;
        padding: 1%;
    }

      .row-fluid {
        width: 100%;
        *zoom: 1;
 }
      .row-fluid [class*="span"] {
        display: block;
        float: left;
        width: 100%;
        min-height: 30px;
        margin-left: 1%;
        *margin-left: 2.709239449864817%;
        -webkit-box-sizing: border-box;
           -moz-box-sizing: border-box;
                box-sizing: border-box;
}

      .row-fluid .span10 {
        width: 82.87292817679558%;
        *width: 82.81973668743387%;
      }

      .row-fluid .span7 {
        width: 58.06353591160195%;
        *width: 57.12912895262725%;
      }

      .row-fluid .span5 {
        width: 40.93646408839753%;
        *width: 40.00205712942283%;
      }
      .row-fluid .span4 {
        width: 31.491712707182323%;
        *width: 31.43852121782062%;
      }

    .contactBg {
        background: #282624;
        padding: 3%;
        max-width:100%;
        height:auto;
    } 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2017-04-05T22:33:16.500

我知道这有点晚了，但你可以使用视口单位

来自 caniuse.com：

视口单位：vw、vh、vmin、vmax - CR 长度单位表示视口宽度 (vw)、高度 (vh)、两者中较小者 (vmin) 或两者中较大者 (vmax) 的 1% ）。

支持：[http ://caniuse.com/#feat=viewport-units](http://caniuse.com/#feat=viewport-units)

```
div {
/* 25% of viewport */
  height: 25vh;
  width: 15rem;
  background-color: #222;
  color: #eee;
  font-family: monospace;
  padding: 2rem;
}
```

```
<div>responsive height</div>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T20:31:21.653

要使 div 的高度具有响应性，它必须位于具有定义高度的父元素内，才能从中得出它的相对高度。

如果您设置右侧包含图像和文本框的容器的高度，您可以随后将其两个子项的高度设置为 75% 和 25%。

但是，当站点布局变窄并且事情变得不稳定时，这将变得有点棘手。尝试将 .contentBg 上的填充设置为 5.5%。

我的建议是使用媒体查询来调整不同屏幕尺寸的填充，然后在适当的时候将所有内容放在一个列中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:15:18.853

我不认为这是最好的解决方案，但它似乎确实有效。我将不使用背景颜色，而是嵌入背景图像，将其相对定位，然后将文本包装在子元素中并将其绝对定位 - 在中心。

# jquery - 使用 jQuery 发布到 Sinatra

> ID：14714745
> 
> 赞同：1
> 
> 时间：2013-02-05T18:53:39.627
> 
> 标签：jquery, ruby, post, sinatra, slim-lang

我有以下路线

主文件

```
get '/' do
    slim :initial
end

post '/' do
    params.inspect
end 
```

初始.slim

```
input id="coolBtn" type='button' value='POST Me'

javascript:
    $("#coolBtn").click(function() {
        $.post("/", { name: "John", age: 27 });
    }); 
```

这里

```
post '/' do
   params.inspect
end 
```

单击按钮后，我想被重定向并查看我传递的 JS 对象（或类似的对象）。但是上面的代码没有做到这一点。单击按钮时，没有任何反应。没有错误，没有消息...我在这里仔细阅读了一些相关主题，但到目前为止没有任何帮助。我在这里遗漏了一些误解吗？如何在 JavaScript 中向 Sinatra App 发出 POST 请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:28:24.170

打开您的页面检查器（Firebug 等），您应该会看到一个 POST 请求。问题是 $.post 是异步的（一个 AJAX 请求），并且不会重定向页面。

而是使用带有提交按钮的表单元素来进行重定向 POST 请求。

# java - 将持续时间转换为季度

> ID：14714747
> 
> 赞同：1
> 
> 时间：2013-02-05T18:53:48.177
> 
> 标签：java, android, datetime

我需要将时间差计算为季度、周、天、小时和秒。我无法得到正确的公式。以下公式应返回：3 个季度、12 周、6 天、23 小时和 59 分钟。我绝不是数学奇才，所以任何帮助都会很棒。

```
long difference = 31535872360L;/*A few seconds short of a year*/

long min =   (int) ((difference / (1000*60))%60);/*Returns 59 Minutes*/
long hours = (int) ((difference / (1000*60*60)) % 24);/*Returns 23 Hours*/
long days =  (int) ((difference / (1000*60*60*24)) % 7);/*Returns 0 Days*/
long weeks = (int) ( difference / (1000*60*60*24*7)% 12);/*Returns 4 Weeks*/
long quarters = (int) (((difference / (1000*60*60*24*7)%12)/3)+1);/*Returns 2 Quarters*/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:50:13.467

我相信这种方式更干净，更不容易出错：

```
private static final long MIN_MS = 1000 * 60;
private static final long HOUR_MS = MIN_MS * 60;
private static final long DAY_MS = HOUR_MS * 24;
private static final long WEEK_MS = DAY_MS * 7;
private static final long QUARTER_MS = WEEK_MS * 12;

public static void main(String[] args) throws Exception {
    long msecs = 31535872360L;/*A few seconds short of a year*/
    long q = msecs / QUARTER_MS;
    msecs -= q * QUARTER_MS;
    long w = msecs / WEEK_MS;
    msecs -= w * WEEK_MS;
    long d = msecs / DAY_MS;
    msecs -= d * DAY_MS;
    long h = msecs / HOUR_MS;
    msecs -= h * HOUR_MS;
    long min = msecs / MIN_MS;
    msecs -= min * MIN_MS;
    long secs = msecs / 1000;
    System.out.printf("%d q,%d w, %d d, %d:%d:%d \n", q, w, d, h, min, secs);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:59:55.913

我认为你的季度公式应该是

```
long quarters = (int) ((difference / (1000*60*60*24*7*12) % 4); 
```

# mysql - 如何获取 MySQL 数据库的真实大小？

> ID：14714750
> 
> 赞同：148
> 
> 时间：2013-02-05T18:53:50.667
> 
> 标签：mysql, database, size, byte, storage

我想知道我的 MySQL 数据库使用了多少空间，以便选择一个网络主机。我找到了该命令`SHOW TABLE STATUS LIKE 'table_name'`，所以当我进行查询时，我得到如下信息：

```
Name       | Rows | Avg. Row Length | Data_Length | Index Length
----------   ----   ---------------   -----------   ------------
table_name   400          55            362000        66560 
```

*   数字四舍五入。

那么这张表是否有**362000** 或 400*362000 = **144800000**字节的数据？索引长度是什么意思？谢谢 ！

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2014-01-16T17:46:59.707

[来自MySQL 论坛](http://forums.mysql.com/read.php?108,201578,201578 "从 MYSQL 查询浏览器获取数据库大小")上的 S. Prakash ：

```
SELECT table_schema "database name",
    sum( data_length + index_length ) / 1024 / 1024 "database size in MB",
    sum( data_free )/ 1024 / 1024 "free space in MB"
FROM information_schema.TABLES
GROUP BY table_schema; 
```

或者在一行中以便于复制粘贴：

```
SELECT table_schema "database name", sum( data_length + index_length ) / 1024 / 1024 "database size in MB", sum( data_free )/ 1024 / 1024 "free space in MB" FROM information_schema.TABLES GROUP BY table_schema; 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2015-07-29T06:10:52.590

您可以通过在 Mysql 客户端中运行以下命令来获取 Mysql 数据库的大小

```
SELECT  sum(round(((data_length + index_length) / 1024 / 1024 / 1024), 2))  as "Size in GB"
FROM information_schema.TABLES
WHERE table_schema = "<database_name>" 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-02-05T19:03:31.103

如果您使用 phpMyAdmin，它可以告诉您这些信息。

只需转到“数据库”（顶部菜单）并单击“启用统计信息”。

你会看到这样的东西：

![phpMyAdmin 截图](../Images/b911f2b0304b313544bf334a651baf6b.png)

随着尺寸的增加，这可能会失去一些准确性，但它应该足以满足您的目的。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-07-20T16:41:57.347

如果您想在 MB 中找到它，请执行此操作

```
SELECT table_schema                                        "DB Name", 
   Round(Sum(data_length + index_length) / 1024 / 1024, 1) "DB Size in MB" 
FROM   information_schema.tables 
GROUP  BY table_schema; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-05T18:57:49.197

基本上有两种方法：查询DB（数据长度+索引长度）或检查文件大小。索引长度与存储在索引中的数据有关。

一切都在这里描述：

[http://www.mkyong.com/mysql/how-to-calculate-the-mysql-database-size/](http://www.mkyong.com/mysql/how-to-calculate-the-mysql-database-size/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-09T11:07:13.353

没有一个答案包括开销大小和表的元数据大小。

这是对数据库分配的“磁盘空间”的更准确估计。

```
SELECT ROUND((SUM(data_length+index_length+data_free) + (COUNT(*) * 300 * 1024))/1048576+150, 2) AS MegaBytes FROM information_schema.TABLES WHERE table_schema = 'DATABASE-NAME' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-20T13:51:44.520

如果要查找所有 MySQL 数据库的大小，使用此命令，它将显示它们各自的大小（以兆字节为单位）；

```
SELECT table_schema "database", sum(data_length + index_length)/1024/1024 "size in MB" FROM information_schema.TABLES GROUP BY table_schema; 
```

如果您有大型数据库，可以使用以下命令以 GB 为单位显示结果；

```
SELECT table_schema "database", sum(data_length + index_length)/1024/1024/1024 "size in GB" FROM information_schema.TABLES GROUP BY table_schema; 
```

如果您只想显示特定数据库的大小，例如`YOUR_DATABASE_NAME`，您可以使用以下查询；

```
SELECT table_schema "database", sum(data_length + index_length)/1024/1024/1024 "size in GB" FROM information_schema.TABLES WHERE table_schema='YOUR_DATABASE_NAME' GROUP BY table_schema; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-22T02:16:50.390

`SUM(Data_free)` **可能有效也可能无效**。这取决于`innodb_file_per_table`. 更多讨论可在[*此处*](https://stackoverflow.com/a/42381448/1766831)找到。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-26T18:57:44.770

Oracle 的 MySQL Utilities 有一个名为 mysqldiskusage 的命令，它显示每个数据库的磁盘使用情况：[https ://dev.mysql.com/doc/mysql-utilities/1.6/en/mysqldiskusage.html](https://dev.mysql.com/doc/mysql-utilities/1.6/en/mysqldiskusage.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-17T09:03:24.420

如果您使用的是 MySql Workbench，很容易获得数据库大小、每个表大小、索引大小等的所有详细信息。

1.  右键单击架构
2.  选择**架构检查器**选项

    [![在此处输入图像描述](../Images/a39d1d10814c4784543f2bedee3faef6.png)](https://i.stack.imgur.com/LTdAd.png)

3.  它显示了 Schema 大小的所有细节

4.  选择**表格**选项卡以查看每个表格的大小。

    [![在此处输入图像描述](../Images/352a70d001fe88e24b8cb1c39e14c7ae.png)](https://i.stack.imgur.com/Tkpy9.png)

5.  数据长度列中显示的表大小

# c++ - 什么是 C++ 中的模块？

> ID：14714751
> 
> 赞同：10
> 
> 时间：2013-02-05T18:53:51.250
> 
> 标签：c++, module, definition

以下句子中的术语*模块*指的是什么？

> 不允许异常跨模块边界传播。

这是Herb Sutter 和 Andrei Alexandrescu在[C++ 编码标准](http://www.gotw.ca/publications/c++cs.htm)中的第 62 条规则。

* * *

我现在已经阅读了这本书，所以我想引用部分摘要，我认为这会增加一些清晰度：

> 不要往邻居的花园里扔石头：C++ 异常处理没有普遍的二进制标准。除非您控制用于构建双方的编译器和编译器选项，否则不允许异常在两段代码之间传播；否则，模块可能不支持异常传播的兼容实现。通常，这归结为： 不要让异常跨模块/子系统边界传播。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:05:19.510

这是个好问题。C++ 标准不使用模块一词（至少我不这么认为），通常的日常含义类似于翻译单元。除了这不是 Herb 和 Andrei 的意思，因为使用异常的真正目的是从本地代码体中向上传播——否则，您将使用返回码。

我只能猜测，但它们可能意味着可以在不同的 DLL 中合理实现的东西。如果 DLL 是用不同的编译器编译的，或者使用不同的语言，跨 DLL 边界传播异常*可能是个问题。*否则...

通常认为最佳实践是在 main 中（或在每个线程中的其他一些高级函数中）有一个 try/catch 块，并在那里捕获所有异常，无论它们来自哪里。当你这样做时，现代编译器没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-07T19:20:46.923

我没有读过那本书，但听起来它很可能是[密歇根大学的这个 pdf 中](http://www.umich.edu/~eecs381/handouts/CppHeaderFileGuidelines.pdf)详细介绍的模块概念。

IE。模块是单个编译单元，通常由头文件和源文件组成。

这在您引用本书的上下文中是有道理的，因为强调了对编译的控制。如果您在单个编译单元（模块）中具有自包含功能，那么您永远不必担心由于依赖特定编译器功能而导致编译功能变得不完整。

# java - java.lang.UnsatisfiedLinkError：java.library.path 中没有胶水根-rt

> ID：14714755
> 
> 赞同：2
> 
> 时间：2013-02-05T18:54:04.300
> 
> 标签：java, eclipse, path, native, libraries

尝试为我的 Windows Eclipse 安装安装 JOGL，我发现了标题中描述的错误。

这就是我尝试安装 JOGL 时所做的：

1.  下载了 jogamp-all-platforms.7z
2.  按照http://jogamp.org/wiki/index.php/Downloading_and_installing_JOGL使用本机库进行完整安装 [：](http://jogamp.org/wiki/index.php/Downloading_and_installing_JOGL)
    1.  制作了一个名为 jogl-2.0 的新目录
    2.  将显示的 .dll 文件复制到 jogl-2.0\lib
    3.  将显示的 .jar 文件复制到 jogl-2.0\jar
    4.  将显示的 .zip 文件复制到 jogl-2.0\src
3.  在 Eclipse 中，转到 Build Path => Add Libraries... => User Library
4.  创建了一个新的用户库，将其设置为系统库
5.  从外部 JAR 添加 jar
6.  通过为每个 JAR 指定库来添加 dll
7.  从 URL 添加 javadocs
8.  从 .zips 添加源

然而它仍然认为我没有添加库来完成安装。我还将 jogl-2.0\lib 添加到我的 %PATH% 中，但这也没有任何作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T18:54:04.300

在输入这个问题时，我找到了解决方案！

问题是在“添加库”对话框中选中“系统库”框。这需要保持不变。如果有人能告诉我原因，我将不胜感激。

当我取消设置时，它很好，但是因为找不到更多的 JAR 文件而大喊大叫。

我将这些 JAR 文件添加到我的 jogl-2.0\jar 目录中，并且它起作用了：

```
gluegen-rt-natives-windows-amd64.jar
jogl-all-natives-windows-amd64.jar 
```

我不需要在 Eclipse 中做更多的事情。

# php - explorer - 基于 IIS 的 FTP 的文件权限

> ID：14714759
> 
> 赞同：0
> 
> 时间：2013-02-05T18:54:11.157
> 
> 标签：php, iis

我已经在基于 IIS 7 的服务器上设置了 extplorer PHP 脚本，该服务器也运行 FTP 服务。该应用程序工作文件，即使用本地用户帐户连接到 FTP 服务器并能够上传文件。

但是，列出的文件没有读/写权限 ( `chmod 0`)。一旦文件被上传，就无法删除或修改它。当我尝试手动 chmod（使用 explorer）时，我收到`CHMOD Failure`错误消息。

我已经`Anonymous Authentication`在 IIS 管理器的 explorer 站点上启用了，但这似乎没有多大帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:14:45.160

IIS FTP 提供*零*所有权/权限支持。时期。

一些第三方 FTP 服务器软件*可能会*在功能上强加，但事实仍然是 FTP 基于 Unix 风格的权限，这与 Windows NTFS 风格的权限完全不兼容。

# vb.net - VB 位置 0 没有行

> ID：14714764
> 
> 赞同：0
> 
> 时间：2013-02-05T18:54:32.710
> 
> 标签：vb.net, data-binding

我有一个目前没有任何内容的数据库，我正在尝试创建并保存第一条记录，但最终收到一条错误消息，提示“位置 0 处没有行”。

我所做的不是拥有一个允许用户选择发货人或接收人名称的文本框，而是将它们拉出并放入我已绑定到其他两个数据库中的适当字段的组合框（shippers.mdb和接收器.mdb）。

因此，在单击“保存”按钮时，我想将这些组合框中的选定项目（保存到字符串）保存到我想要的数据库中的每个列单元格中。但是，系统根本不允许我保存记录。我一直在试图弄清楚如何保存正在编辑或输入的“当前”记录的信息，因此出于某种原因我决定使用 (0)，认为这可能有效，但似乎不正确。这是代码：

```
Private Sub Button16_Click_1(sender As System.Object, e As System.EventArgs) Handles Button16.Click

        Me.OrdersDataSet.orders(0).orderstatus = ComboBox13.SelectedItem.ToString()
        shipper1 = ComboBox8.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).SHIPPER1 = shipper1
        RECEIVER1 = ComboBox9.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).RECEIVER1 = RECEIVER1
        billtoacct = ComboBox7.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).BILLTOACCT = billtoacct
        driverassigned = ComboBox10.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).DRIVERASSIGNED = driverassigned
        truckassigned = ComboBox11.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).TRUCKASSIGNED = truckassigned
        trailerassigned = ComboBox12.SelectedItem.ToString()
        Me.OrdersDataSet.orders(0).TRAILERASSIGNED = trailerassigned

        Me.Validate()
        Me.OrdersBindingSource.EndEdit()
        Me.TableAdapterManager12.UpdateAll(Me.OrdersDataSet)
    End Sub 
```

我应该改用什么，因为我似乎找不到让我保存（或替换）当前记录的组合框项目的东西？我确实在表适配器中检查了 CRUD 是否存在，并且我通过确保它已设置为填充、更新等。

谢谢你看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:24:10.150

试一试......将所有这些放在您的按钮单击事件中并根据需要进行更改......

```
Dim customerOrders As DataSet = New DataSet("CustomerOrders")
Dim ordersTable As DataTable = customerOrders.Tables.Add("Orders")

'ADD YOUR COLUMNS YOU NEED TO...'
ordersTable.Columns.Add("OrderQuantity", Type.GetType("System.Int32"))
ordersTable.Columns.Add("CompanyName", Type.GetType("System.String"))

'AND WHATEVER ELSE YOU NEED TO ADD, CHANGE AS NEEDED'

    ' Add YOUR ROWS to those columns for the datatable.
ordersTable .Rows.Add(25, "Indocin")
ordersTable .Rows.Add(50, "Enebrel")
ordersTable .Rows.Add(10, "Hydralazine")
ordersTable .Rows.Add(21, "Combivent")
ordersTable .Rows.Add(100, "Dilantin") 
```

然后，您将数据集与表和数据设置为表适配器管理器

谢谢！

# html - 标头无法正常运行 Firefox / Internet Explorer

> ID：14714768
> 
> 赞同：0
> 
> 时间：2013-02-05T18:54:46.310
> 
> 标签：html, css

我正在研究一个网站的标题。我正在使用菜单模板；但是它在 IE9 和 FireFox 中开始出现故障，但在 webkit 浏览器中运行良好。

在 IE9 中，环选项卡不会下拉；在 Firefox 中它被切断了。

我有一种感觉，我可能已经更改了导致此错误的 1 或 2 个属性，但我找不到它们。有任何想法吗？

[这是该网站的链接。](http://morzi.com/hfe/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:07:48.827

你听说过开发者工具吗？按 F12。

> HTML1527：需要 DOCTYPE。最短的有效文档类型是“ `<!DOCTYPE html>`”。
> hfe，第 1 行字符 1
> 
> HTML1511：在“”之外遇到了意外的头级元素`<head>`。
> hfe，第 5 行字符 3
> 
> HTML1511：在“”之外遇到了意外的头级元素`<head>`。
> hfe，第 7 行字符 2
> 
> HTML1511：在“”之外遇到了意外的头级元素`<head>`。
> hfe，第 8 行字符 2
> 
> HTML1511：在“”之外遇到了意外的头级元素`<head>`。
> hfe，第 9 行字符 2

主要问题是您`</head>`在第 4 行有一个标签，`<body>`在第 22 行有一个标签，两者都不应该存在。您还缺少一个 DOCTYPE，这会导致浏览器处于 Quirks 模式。这也可能导致 Firefox 中的截止菜单（和 IE 被告知强制标准模式）

# r - 非对角线和对角线对称性检查，在不重复矩阵的情况下获取非对角线和对角线元素

> ID：14714775
> 
> 赞同：0
> 
> 时间：2013-02-05T18:55:01.850
> 
> 标签：r, matrix

假设我有这个矩阵

```
8 3 1 1 2 2 1 1 1 1 1 1 2 2 1 1 3
3 8 3 1 1 2 2 1 1 1 1 1 1 2 2 1 1
1 3 8 3 1 1 2 2 1 1 1 1 1 1 2 2 1
1 1 3 8 3 1 1 2 2 1 1 1 1 1 1 2 2
2 1 1 3 8 3 1 1 2 2 1 1 1 1 1 1 2
2 2 1 1 3 8 3 1 1 2 2 1 1 1 1 1 1
1 2 2 1 1 3 8 3 1 1 2 2 1 1 1 1 1
1 1 2 2 1 1 3 8 3 1 1 2 2 1 1 1 1
1 1 1 2 2 1 1 3 8 3 1 1 2 2 1 1 1
1 1 1 1 2 2 1 1 3 8 3 1 1 2 2 1 1
1 1 1 1 1 2 2 1 1 3 8 3 1 1 2 2 1
1 1 1 1 1 1 2 2 1 1 3 8 3 1 1 2 2
2 1 1 1 1 1 1 2 2 1 1 3 8 3 1 1 2
2 2 1 1 1 1 1 1 2 2 1 1 3 8 3 1 1
1 2 2 1 1 1 1 1 1 2 2 1 1 3 8 3 1
1 1 2 2 1 1 1 1 1 1 2 2 1 1 3 8 3
3 1 1 2 2 1 1 1 1 1 1 2 2 1 1 3 8 
```

我想检查

1.  非对角线是否对称？（在上面的矩阵中，这些是对称的）

2.  元素出现在非对角线（不重复）？- 在上面的矩阵中，这些元素是 1,2,3

3.  对角线上的元素是对称的吗？如果是打印元素？（如上述矩阵中的 8 ）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:37:16.963

```
# 1
all(mat == t(mat))
[1] TRUE

# 2
unique(mat[upper.tri(mat) | lower.tri(mat)])
[1] 3 1 2

# 3
if(length(unique(diag(mat))) == 1) print(diag(mat)[1])
[1] 8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:39:05.870

```
mat <- as.matrix(read.table('abbas.txt'))
isSymmetric(unname(mat)) 
```

'请注意，矩阵只有在其'rownames'和'colnames'相同时才是对称的。

```
unique(mat[lower.tri(mat)])

all(diag(mat) == rev(diag(mat)))
# I assume you mean the diagonal is symmetric when its reverse is the same with itself. 
```

# php - 使用 Yii 框架的数据库特性

> ID：14714781
> 
> 赞同：1
> 
> 时间：2013-02-05T18:55:21.510
> 
> 标签：php, activerecord, yii

我最近开始使用 Yii PHP MVC 框架。我正在寻找有关如何通过框架继续使用数据库的建议：我应该使用框架的基类 CActiveRecord 来处理数据库，还是应该使用经典的 SQL 查询函数（在我的例子中是 mssql）？

显然与否，对我来说，通过经典的 SQL 查询处理数据库似乎更容易，但是，在某些时候，我认为使用框架的方式必须有一个优势。一些 SQL 查询经常会变得相当复杂。我只是无法理解该框架如何帮助我并且不会使事情变得比实际更复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T21:52:09.337

根据我对 Yii 和海量数据库的经验，非常普遍的规则：

**在以下情况下使用 Yii Active Record：**

1.  您想检索并发布数据库中的几行（例如，用户更改他/她的设置、更新用户余额、添加投票、获取在线用户数、获取主题下的帖子数、检查是否有模型存在）
2.  您想在表格之间快速设计分层模型结构（例如，$user->info->email、$user->settings->currency），允许您在每次使用时快速调整显示的货币/设置。

**在以下情况下远离 Yii Active Record：**

1.  您想一次更新 100 条记录。（模型开销太大）

    ```
    Yii::app()->db->command() 
    ```

    允许您避免重物并以简单数组的形式检索数据。

2.  您想要执行涉及多个表的高级连接和查询。

3.  任何批处理作业！！（例如检查付款表以查看哪些客户逾期付款，更新数据库值等）

我喜欢 Yii Active Record，但我会根据应用程序的要求在 Active Record 模型和普通 SQL 之间进行交换（使用 Yii::app()->db）。

最后，我可以选择是否要更新单个用户的货币

```
$user->info->currency = 'USD';
$user->info->save(); 
```

或者如果我想更新所有用户的货币：

```
Yii::app()->db->command('UPDATE ..... SET Currency="USD" where ...'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:01:02.370

在任何语言中处理数据库时，框架都可以通过提供对数据库的抽象来帮助您。

这是我知道我在早期开发期间多次发现自己的场景：

1.  我有一个需要数据库的应用程序。
2.  我写了大量的代码。
3.  我将 SQL 语句与其他所有内容一起放入代码中。
4.  数据库以某种方式更改。
5.  我不得不返回并对我的所有 SQL 语句进行 100 次更改。

这非常令人沮丧。

我发现的另一个场景：

1.  我针对数据库编写了大量代码。
2.  虫子进来了。很多虫子。我无法全部弄清楚。
3.  我被要求为我的代码编写测试。
4.  这是不可能的，因为我所有的代码都依赖于数据库的直接实现。当 SQL 语句与实际代码一起使用时，您如何测试它们？

所以我的建议是使用框架，因为它可以提供对数据库的抽象。这为您提供了两个非常大的优势：

1.  您可以稍后换出数据库，并且您的代码保持不变！如果您使用接口/某些框架，那么很可能您正在处理对象而不是直接处理 SQL 语句。给定的实现可能知道如何写入 MySQL 或 SQL Server，但通常您的代码只是说“写入此对象”、“读取该列表”。

2.  你可以测试你的代码！一个处理数据的好框架可以让您模拟数据库，以便您可以轻松地对其进行测试。

尽量避免直接在应用程序中编写 SQL 语句。以后会减轻你的痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:23:16.897

我不熟悉与 Yii 捆绑的数据库系统，但建议您先使用它一点。我的经验是使用流行的 PHP ORM Propel。通常，ORM 系统的每个表都有一个类（Propel 每个表有三个）。

现在，可能会有一种语法来进行查找和连接等，但首先要做的是弄清楚如何在查询中使用原始 SQL（对于任何 CRUD 操作）。在您的模型类中放置执行这些查询的方法，这样至少您将受益于代码的集中化。

一旦你完成了这项工作，你可以在以后迁移到推荐的方法，而不会被你必须一次性学习的大量材料所淹没。学习 Yii（尤其是如何在控制器之间共享代码，以及编写可维护的视图模板）需要一段时间，因此不要将它与许多其他事情过度复杂化可能是明智的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T20:33:13.120

为什么要使用 Yii：

试想一下，您有很多模块，并且您必须为每个模块编写分页代码；用老式的方式写作，需要很多时间；

为什么不使用 Yii ClistView 小部件？哦，这个小部件有一个好处：数据提供者和自动检查即将打印的文章的存在；

当使用 Yii CListView 与来自 ... Sphinx 搜索引擎的结果时，小部件将检查文章是否确实存在，因为结果可能不正确

为不存在的注册编写检测代码需要多长时间？

当你有不同类型的项目时，你会添加方法吗？

不！Yii 为你做这件事。

您以 crud 风格编写代码需要多长时间？创建、读取、更新、删除？

你打算改编另一个项目的旧代码吗？

Yii 有一个名为 Gii 的奇迹模块，它可以生成模型、模块、表单、控制器、crud ......等等

一开始可能看起来很难，但是当你有经验时，这很容易

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T06:57:22.760

我建议你应该使用 CActiveRecord。它会带来很多好处 -

1.  如上所述，您可以直接在 yii 中使用许多小部件。（用于分页、网格等）

2.  Yii ORM 生成的查询是高度优化的。

3.  您不需要将从 SQL 中提取的结果放入您的 VO 对象中。

4.  如果由于某种原因修改了表（添加/删除列，更改数据类型），您只需要使用 yii 提供的工具重新生成模型。请确保您尽量避免对 yii 生成的模型进行任何代码更改，这将节省您的合并工作。

5.  如果您打算在未来将数据库从 MYSQL 更改为其他供应商，那么您只需更改配置即可。

6.  您和您的团队也将节省您宝贵的开发时间。

# visual-studio - 如何让 MSDeploy 将其他文件发布到 Azure？

> ID：14714782
> 
> 赞同：4
> 
> 时间：2013-02-05T18:55:23.160
> 
> 标签：visual-studio, tfs, msdeploy, tfsbuild

我有一个 ASP.NET Web API 项目，它绑定到托管在 tfs.visualstudio.com 上的 TFS 源代码控制存储库，以及一个将输出发布到 Azure 的持续集成构建（也在 tfs.visualstudio.com 上）。CI 构建触发正确，构建输出部署到 Azure，但我希望部署还包括 XML 文档文件，因为它们驱动我的 Web API 项目的帮助页面。

做了一些谷歌搜索后，我发现一篇[博](http://sedodream.com/2010/05/01/WebDeploymentToolMSDeployBuildPackageIncludingExtraFilesOrExcludingSpecificFiles.aspx)文指出我应该将以下内容添加到我的 pubxml 文件中：

```
<PropertyGroup>
    <CopyAllFilesToSingleFolderForMsdeployDependsOn>
        CustomCollectFiles;
        $(CopyAllFilesToSingleFolderForMsdeployDependsOn);
    </CopyAllFilesToSingleFolderForMsdeployDependsOn>
</PropertyGroup>
<Target Name="CustomCollectFiles">
    <ItemGroup>
        <_CustomFiles Include="bin\**\*.xml" />
        <FilesForPackagingFromProject Include="%(_CustomFiles.Identity)">
              <DestinationRelativePath>bin\%(RecursiveDir)%(Filename)%(Extension)</DestinationRelativePath>
        </FilesForPackagingFromProject>
     </ItemGroup>
</Target> 
```

如果我从 Visual Studio 2012 手动发布，则此方法有效，但在我的 CI 构建发布其输出时不起作用。CI 构建不发布 XML 文档文件。

为什么这在 Team Build 服务器上的行为与在我的开发框上的行为不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:27:05.270

根据[http://blogs.msdn.com/b/aaronhallberg/archive/2007/06/07/preserving-output-directory-structures-in-orcas-team-build.aspx](http://blogs.msdn.com/b/aaronhallberg/archive/2007/06/07/preserving-output-directory-structures-in-orcas-team-build.aspx)，您的 Team Build 服务器用于`$(OutDir)`确定在哪里这些文件应该在您的构建期间进行。在您的开发盒上，它通常使用`$(OutputPath)`.proj 文件。

`$(OutputPath)`通常是项目文件夹下的 bin 文件夹；看起来您已经指向 bin （不使用`$(OutputPath)`变量）作为`Include`自定义文件的值。尝试使用类似的东西`$(OutDir)\**\*.xml`在构建时获取实际输出路径，而不管环境如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-10T16:36:20.867

发布 XML 文档文件所需的唯一更改是：

```
<ExcludeXmlAssemblyFiles>False</ExcludeXmlAssemblyFiles> 
```

# javascript - 面向初学者的 node.js 问题

> ID：14714783
> 
> 赞同：1
> 
> 时间：2013-02-05T18:55:26.330
> 
> 标签：javascript, node.js, command-prompt, read-eval-print-loop

我是 nodeJS 的初学者，我有一些问题想回答。

1.  首先，当我去安装 nodeJS 时，它安装了两个不同的命令提示符。第一个命令提示符为空白，并显示“>”。第二个命令提示符是 Windows 命令提示符，但显示消息“您的环境已设置为使用 Node.js 0.8.18 (ia32) 和 NPM”。通过输入代码`node code.js`，我可以使用第二个命令提示符开始运行 nodeJS，但我不知道如何使用上面描述的第一个命令提示符。有人可以向我解释第一个命令提示符的用途吗？

2.  作为 nodeJS 的初学者，我的第二个问题是关于创建服务器的。我还没有深入了解 nodeJS 可以做什么。但是，如果 nodeJS 可以创建服务器，那么假设 nodeJS 可以用于创建数据库软件以供 PHP 或 Python 之类的东西进行交互是否安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:05:41.210

1.  第一个命令提示符是[REPL](http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop)，这意味着您只需输入命令，它就会评估并继续运行。它就像一个实时控制台来测试某些功能。

2.  NodeJS 可以做很多事情，它的事件驱动模型是类似系统的一个很好的替代品。NodeJS 可以与数据库、另一台计算机或用户进行通信。它只是一个使用 Javascript 编程语言的平台。正如nodejs网站上所说，它是“ `lightweight and efficient, perfect for data-intensive real-time applications that run across distributed devices.`”

编辑：与 REPL 的示例交互

```
$ nodejs
> process.version
'v0.8.18'
> var a = 5;
undefined
> var b = 5
undefined
> a + b
10
> var dns = require("dns");
undefined
> dns.resolve4("www.google.com",function(err,address){console.log(address); })
{ oncomplete: [Function: onanswer] }
> [ '173.194.35.144',
  '173.194.35.145',
  '173.194.35.146',
  '173.194.35.147',
  '173.194.35.148' ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:05:31.650

1.  第一个“命令提示符”是一个 node.js 解释器。您也可以通过在窗口控制台中执行节点来运行它。当您输入“node code.js”时，您将启动“第一个命令提示符”来执行 code.js 文件。如果您在没有任何脚本的情况下启动它，您可以直接在解释器中输入您的脚本
2.  是的，node.js 可用于访问 php 或 python 等数据库。主要区别在于您不需要像 PHP 或 Python 那样为解释器安装 webserver(apache, nginx)，因为 node.js 可以为您创建 webserver

# php - 如何从大型数据集中进行搜索推荐

> ID：14714786
> 
> 赞同：1
> 
> 时间：2013-02-05T18:55:33.930
> 
> 标签：php, javascript, jquery, mysql, sql

我最近一直在思考的事情是，当我在搜索栏中键入内容时，imdb 或 github 等网站如何提供如此快速的搜索建议。我发现大多数 jQuery 插件都会将数据集转储到页面上，然后在那里使用它。但这不适用于大型数据库集，因为它会使页面权重变得巨大。我的第一个想法可能是同步 ajax 调用，但有人告诉我这可能会导致冻结，直到执行完成。

问题：如何在输入表单时从大型数据集中提取类似记录，然后显示结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T15:00:51.177

我最近为常见问题解答构建了类似的内容，您面临的两个最大问题如下：

*   数据库读取时间，在数据库上运行搜索查询所需的时间
*   您的通话时间，如果有人在一秒钟内输入 3 个字符，那么您在一秒钟内进行 3 次 ajax 调用。

如果这是一个非常基本的搜索，那么第一个问题并不是什么大问题，您可以在几毫秒内轻松查询一个小表，但是当搜索大量文本时它会变慢。最好的方法是使用像 Sphinx 或 Solr 这样的搜索引擎。他们为您的数据库中的数据编制索引，以便进行快速和相关的查找。

第二个是通过感知来解决的，当用户击键之间的间隔不到一秒（这取决于您的听众的计算机知识）时，您不会进行查找。这意味着只有当他们稍微暂停时才会进行查找。这意味着更少的查询和更少的系统压力。下面的例子：

```
var typingTimer;
var doneTypingInterval = 1000;

$('.huge-input').stop().keyup(function(e){
    if ((e.which <= 90 && e.which >= 48) || e.which == 8){
        var myHugeInput = $(this);

        clearTimeout(typingTimer);
        typingTimer = setTimeout(
        function(){
                //Do the look up and set data
            },
            doneTypingInterval
        );
    }
}); 
```

所以在这里我们检查一个输入框是否有一个有效的键输入，我们清除计时器，然后设置一个 1000 毫秒（1 秒）的超时时间，当时间用完时，它会搜索并设置数据，但如果有在那一秒钟内的另一个有效击键将清除计时器并重置它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:09:54.787

这就是我想象的可以做到的方式。

我会记录用户之前的搜索，并使用某种树结构来即时记录人们在开始输入与您相同的内容时最终输入的内容。然后你只需要在字典中查找，速度似乎不是什么大问题。当然，你需要大量的存储容量，但我想这对大公司来说不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:01:46.707

我个人非常喜欢 Dojo 处理“数据存储”的方式。也就是说，大多数解决方案可能都围绕 jQuery UI 的[自动完成](http://jqueryui.com/autocomplete/)。正如建议的那样，解决方案依赖于 AJAX 请求返回到服务器进行匹配。这就是力学的基础。通常你会需要一些缓存方案，这样当用户输入一两个退格键时，你就可以重用之前已经检索到的结果。现在就速度而言，根据您正在搜索的数据集的大小，您可能需要一种索引搜索方法。想到了Lucene。或者一个 mongoDB 解决方案，其中您的数据被构建到优化搜索的东西中。

# c++ - 将 C 程序转换为 C++

> ID：14714787
> 
> 赞同：-4
> 
> 时间：2013-02-05T18:55:39.200
> 
> 标签：c++, c

帮助！我正试图弄清楚我们教授给我们的这段代码——

```
#include <stdio.h>
#include <string.h>

void encrypt(int offset, char *str) {

    int i,l;

    l=strlen(str);

    printf("\nUnencrypted str = \n%s\n", str);

    for(i=0;i<l;i++)
        if (str[i]!=32)  
            str[i] = str[i]+ offset;

    printf("\nEncrypted str = \n%s \nlength = %d\n", str, l);
}

void decrypt(int offset, char *str) {

    // add your code here
}

void main(void) {

    char str[1024];

    printf ("Please enter a line of text, max %d characters\n", sizeof(str));

    if (fgets(str, sizeof(str), stdin) != NULL)
    {
        encrypt(5, str);    // What is the value of str after calling "encrypt"?

        // add your method call here:
    }
} 
```

我们假设执行以下操作：

*   将`C`代码转换为`C++`.

*   将代码添加到“解密”方法以破译加密的文本。

*   更改代码以使用`pointer`操作而不是`array`操作来加密和解密消息。

*   在main方法中，调用“decrypt”方法对密文（str）进行解密。

这是我设法做到的，但我现在几乎被困住了。特别是因为我没有`C`语言背景。任何帮助，将不胜感激。

```
#include <iostream>
#include <string.h>

void encrypt(int offset, char *str)
{   
    std::cout << "\nUnencrypted str = \n" << str;

    char *pointer = str;

    while(*pointer)
    {
        if (*pointer !=32)  
            *pointer = *pointer + offset;
        ++pointer;
    }

    std::cout <<"\nEncrypted str =\n" << str << "\n\nlength = ";
}

void decrypt(int offset, char *str) {

    // add your code here
}

void main(void) {

    char str[1024];

    std::cout << "Please enter a line of text max " << sizeof(str) << " characters\n";

    if (fgets(str, sizeof(str), stdin) != NULL)
    {
        encrypt(5, str);    // What is the value of str after calling "encrypt"?

        // add your method call here:
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:39:18.820

大多数格式良好的 C 代码都可以编译为 C++，将文件重命名为 .cpp，使用 C++ 编译来编译代码并修复中断的地方。main() 作为返回 void 的声明至少应该中断（它充其量是有问题的 C 代码，并且显式不正确的 C++）。

这完全取决于您的教授对您的期望；“将其转换为 C++”的要求太模糊了。您希望使用 C++ 的哪些功能？虽然作为 C++ 的简单重新编译在技术上使其成为 C++ 代码（即使它也是有效的 C 代码），但我不知何故怀疑这是练习的意图。

关键是，虽然通过重新编译进行表面转换是可能的，但 C++ 提供了以不同方式对其进行编码的机会。例如：

*   头文件名`<stdio.h>`和`<string.h>`在 C++ 中已弃用，您可以使用`<cstdio>`and`<cstring>`代替。这段代码中说的`<string.h>`是多余的；没有任何代码依赖于它。

*   如果您使用未弃用的标头，则所有标准库都位于`std::`名称空间中，因此所有标准库符号都需要通过为其添加前缀`std::`或（不太有利）使用`using namespace std'`指令来进行范围解析。

*   代码使用 C 标准库，它也是 C++ 标准库的一部分，但 C++ 有许多替代方案在许多方面都更胜一筹。`<cstdio>`例如，在很大程度上被替换为`<iostream>`及其派生词，例如`<stringstream>`and`<fstream>`和字符串处理，实际上字符串数据类型由`<string>`. 使用`<iostream>`和`<string>`实现此代码可以大大简化它。

*   如果要使用`std::string`该类，则可以使用迭代器来遍历字符串内容。

*   C++ 支持 OOP。在这种情况下，您可能会创建一个包含加密和解密方法的类。尽管在这种情况下这样做的论据可能很弱，除了举例说明您对这个概念的理解。

所以你看到“转换”的范围非常广泛，从几乎没有工作到完全重新设计。在设计说明中，我要做的一件事是将加密/解密方法与输出操作分开。如果这些方法不坚持将结果输出到控制台，它们将是可重用的。他们最好将数据返回给调用者，调用者可以用它来做它需要的事情。当然，这也可能超出了本练习的范围，因为这就是将作业呈现给您的方式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:04:35.143

您发布的代码应该在 C++ 和 C 中工作。应该不需要“转换”任何东西，除非有您没有告诉我们的特定要求。

您的数组到指针的转换看起来是正确的，尽管我认为代码在数组形式中更具可读性。

对于您的`decrypt`方法，您将需要编写与`encrypt`方法相反的代码。解决此问题的最佳方法是运行一些示例文本`encrypt`并检查输出的外观。该函数一次将输入转换为一个字符，因此您应该能够逐字节地将输入映射到输出。使用此信息，您可以检测模式并构造一个函数，使转换在另一个方向。

# sql - 编辑前 200 行中缺少记录，但可以在选择前 1000 行中查看记录 SQL Server 2008 R2

> ID：14714788
> 
> 赞同：2
> 
> 时间：2013-02-05T18:55:40.477
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在尝试使用“编辑前 200 行”在表中插入新数据，我可以通过选择前 1000 行来查看插入的数据。到目前为止，一切都很好。但是当我试图通过再次选择“编辑前 200 行”来查找（关闭编辑 200 行窗口）同一个表中的那些插入数据时，这些数据丢失了，我无法找到它们。

（但我可以通过选择前 1000 行来查看同一张表中的那些缺失数据。）

我正在使用 SQL Server 2008 R2。

我观察到我的数据表行超过“200”，这可能是一个原因。我需要对默认大小进行任何更改吗？Tool---options---sql server object explorer 并且他们对默认行值进行了更改？）如果我的问题不够清楚，请原谅。

我感谢任何输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:02:22.377

编辑前 200 行将完全做到这一点 - 所以当然您不会看到超过 200 行。编辑前 200 行不是检查表中是否存在数据的好方法。

也就是说，您可以通过执行以下操作来增加“编辑顶部 NNN”中可见的行数：

在 Sql Server Management Studio 中：

1.  打开“工具”菜单
2.  点击“选项”
3.  展开“Sql Server 对象资源管理器”
4.  展开“表格和视图选项”
5.  将“编辑前行命令的值”的值更改为您希望在编辑时显示的行数。

如果您正在处理大型表，最好只使用 SQL 进行修改，而不是使用编辑界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:03:29.000

您可以通过转到工具 | 来增加在编辑器中查看的行数。选项，然后展开 SQL Server 对象资源管理器节点并更改“命令”节点下的“表和视图选项”。您要更改的设置是“编辑前行命令的值”。

或者，您可以在显示 200 条记录时在编辑器中“显示 SQL 窗格”，并使用 ORDER BY 或 WHERE 子句查找要编辑的记录。

# asp.net - 可以在网页中使用 HandleExternalEvent

> ID：14714789
> 
> 赞同：0
> 
> 时间：2013-02-05T18:55:42.070
> 
> 标签：asp.net, workflow, workflow-foundation

我想知道网页控件是否可以使用 HandleExternalEvent，例如通过运行按钮的 Click 事件。

我尝试在没有令人满意的结果的情况下实现这一点，但是对于 Windows 窗体项目我没有问题。

```
 private string InstanciaGuid
    {

        get { return ViewState["instancia"].ToString(); }
        set { ViewState.Add("instancia", value); }
    }

    public BFPrueba01 _FacadePrueba01
    {
        get
        {
            return ViewState["facade"] as BFPrueba01;
        }

        set { ViewState["facade"] = value; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
            ConeccionWWF();
    }

    private void ConeccionWWF()
    {
        WorkflowRuntime runtime = new WorkflowRuntime();

        Session.Add("runtime", runtime);

        ExternalDataExchangeService dataExchange = new ExternalDataExchangeService();
        runtime.AddService(dataExchange);
        _FacadePrueba01 = new BFPrueba01();
        dataExchange.AddService(_FacadePrueba01);

        runtime.StartRuntime();
        parameters.Add("oUsuario", oUsuario);
        WorkflowInstance instancia = runtime.CreateWorkflow(typeof(WWFsecuencial));
        instancia.Start();
        InstanciaGuid = instancia.InstanceId.ToString();

    }

    protected void btnComenzarWWF_Click(object sender, EventArgs e)
    {
        WorkflowRuntime runtime = Session["runtime"] as WorkflowRuntime;
        WorkflowInstance instance = runtime.GetWorkflow(new Guid(InstanciaGuid));
        _FacadePrueba01.RaiseEventSecuencial(new ComunicacionEventArgs(instance.InstanceId, MovementChangeType.Accelerate));
    } 
```

# javascript - 模拟对 img 的 onclick

> ID：14714791
> 
> 赞同：0
> 
> 时间：2013-02-05T18:55:47.953
> 
> 标签：javascript, jquery, javascript-events

我想在页面中的所有图像上模拟 onclick 功能。问题是每个 img 都有一个唯一的 onclick 调用，而且 img 没有 ID 或类。

每个 img 都在一个 div 内：

```
<div id="339949822">
<img src="button.png" onclick="addUser('339949822');">
</div> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:00:34.677

您可以向 img 标签添加自定义属性

```
<img src="button.png" data-user-id="339949822"/> 
```

然后通过在事件处理程序中引用该属性（您将拥有该元素）

```
element.attr("data-user-id") 
```

或者你可以遍历 DOM 并从封闭的 div 中获取 id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:01:27.843

使用 jquery：

```
$("img[onclick]").each(function(index, element){
  eval( $(element).attr("onclick") );
}); 
```

# python - 将过滤和编码校正的数据重新插入数据帧

> ID：14714793
> 
> 赞同：0
> 
> 时间：2013-02-05T18:55:58.437
> 
> 标签：python, pandas

我有一个需要更正的 DataFrame。我想将包含该单词的任何列中的空值更改`TRAINER`为`0`.

我的数据框看起来像这样：

```
ID,ENROLLMENT_DATE,TRAINER_MANAGING,TRAINER_OPERATOR,FIRST_VISIT_DATE
1536D,12-Feb-12,"06DA1B3-Lebanon NH",,15-Feb-12
F15D,18-May-12,"06405B2-Lebanon NH",,25-Jul-12
8096,8-Aug-12,"0643D38-Hanover NH","0643D38-Hanover NH",25-Jun-12
A036,1-Apr-12,"06CB8CF-Hanover NH","06CB8CF-Hanover NH",9-Aug-12
8944,19-Feb-12,"06D26AD-Hanover NH",,4-Feb-12
1004E,8-Jun-12,"06388B2-Lebanon NH",,24-Dec-11
11795,3-Jul-12,"0649597-White River VT","0649597-White River VT",30-Mar-12
30D7,11-Nov-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",30-Nov-11
3AE2,21-Feb-12,"06405B2-Lebanon NH",,26-Oct-12
B0FE,17-Feb-12,"06D1B9D-Hartland VT",,16-Feb-12
127A1,11-Dec-11,"064456E-Hanover NH","064456E-Hanover NH",11-Nov-12
161FF,20-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",3-Jul-12
A036,30-Nov-11,"063B208-Randolph VT","063B208-Randolph VT",
475B,25-Sep-12,"06D26AD-Hanover NH",,5-Nov-12
151A3,7-Mar-12,"06388B2-Lebanon NH",,16-Nov-12
CA62,3-Jan-12,,,
D31B,18-Dec-11,"06405B2-Lebanon NH",,9-Jan-12
20F5,8-Jul-12,"0669C50-Randolph VT",,3-Feb-12
8096,19-Dec-11,"0649597-White River VT","0649597-White River VT",9-Apr-12
14E48,1-Aug-12,"06D3206-Hanover NH",,
177F8,20-Aug-12,"063B208-Randolph VT","063B208-Randolph VT",5-May-12
553E,11-Oct-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",8-Mar-12
12D5F,18-Jul-12,"0649597-White River VT","0649597-White River VT",2-Nov-12
C6DC,13-Apr-12,"06388B2-Lebanon NH",,
11795,27-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",19-Jun-12
17B43,11-Aug-12,,,22-Oct-12
A036,11-Aug-12,"06D3206-Hanover NH",,19-Jun-12 
```

以下代码为我提供了正确的值。

```
numpy.where(test.filter(regex='TRAINER') == '', 0, test.filter(regex='TRAINER')) 
```

我只是不确定如何用新的更正数据覆盖我的 DataFrame 中的原始数据？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:22:03.863

我不会`numpy`在这里使用；我认为这只会让事情变得更复杂。这个怎么样 - 首先，读入文件：

```
>>> df = pd.read_csv("train.csv")
>>> df[:4]
      ID ENROLLMENT_DATE    TRAINER_MANAGING    TRAINER_OPERATOR FIRST_VISIT_DATE
0  1536D       12-Feb-12  06DA1B3-Lebanon NH                 NaN        15-Feb-12
1   F15D       18-May-12  06405B2-Lebanon NH                 NaN        25-Jul-12
2   8096        8-Aug-12  0643D38-Hanover NH  0643D38-Hanover NH        25-Jun-12
3   A036        1-Apr-12  06CB8CF-Hanover NH  06CB8CF-Hanover NH         9-Aug-12 
```

然后选择要修复的列：

```
>>> to_fix = [c for c in df.columns if 'TRAINER' in c]
>>> to_fix
['TRAINER_MANAGING', 'TRAINER_OPERATOR'] 
```

然后使用该`.fillna`方法将`NaN`s 替换为 0，然后分配列：

```
>>> df[to_fix] = df[to_fix].fillna(0)
>>> df[:4]
      ID ENROLLMENT_DATE    TRAINER_MANAGING    TRAINER_OPERATOR FIRST_VISIT_DATE
0  1536D       12-Feb-12  06DA1B3-Lebanon NH                   0        15-Feb-12
1   F15D       18-May-12  06405B2-Lebanon NH                   0        25-Jul-12
2   8096        8-Aug-12  0643D38-Hanover NH  0643D38-Hanover NH        25-Jun-12
3   A036        1-Apr-12  06CB8CF-Hanover NH  06CB8CF-Hanover NH         9-Aug-12 
```

或者，你可以简单地做

```
df.fillna({c: 0 for c in df.columns if 'TRAINER' in c}, inplace=True) 
```

但这似乎有点太神奇了。

# asp.net - “/”应用程序中的服务器错误。没有找到您要查的资源

> ID：14714796
> 
> 赞同：1
> 
> 时间：2013-02-05T18:56:22.263
> 
> 标签：asp.net, .net, http-status-code-404, orchardcms

我在主机上上传了我的果园网站。在“wwwroot”中，我创建了一个新文件夹“slider”并将 jpg 文件上传到其中。当我尝试使用网址“example.com/slider/1.jpg”访问它们时，我不断收到`Server Error in '/' Application. The resource cannot be found.`
文件在那里。我可以在ftp上看到它。我尝试在 localhost 上做同样的事情，它给了我同样的错误。

我尝试从“主题”文件夹中打开图像。我找到了一个文件“Theme.png”，我可以在浏览器中打开它。我将“1.jpg”添加到我找到 Theme.png 的同一个文件夹中，但我无法打开 1.jpg，它给了我相同的错误消息。

那是我的 web.config 文件：

```
<?xml version="1.0"?>
<configuration>

  <configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <remove name="host" />
      <remove name="pages" />
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
  </configSections>

  <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <pages pageBaseType="Orchard.Mvc.ViewEngines.Razor.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
        <add namespace="System.Linq"/>
        <add namespace="System.Collections.Generic"/>
        <add namespace="Orchard.Mvc.Html"/>
      </namespaces>
    </pages>
  </system.web.webPages.razor>

  <system.web>
    <compilation targetFramework="4.0">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
        <add assembly="System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
        <add assembly="System.Web.WebPages, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      </assemblies>
    </compilation>
  </system.web>

</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T11:43:54.340

您是否已将 web.config 文件添加到滑块文件夹中，如本[答案中所述，关于带有 JavaScript 文件的 404](/a/9721841/31569)。

# java - 尝试 Fork 一个 java 进程并将 rmi 作为客户端连接，但 fork 进程正在退出

> ID：14714798
> 
> 赞同：-1
> 
> 时间：2013-02-05T18:56:27.700
> 
> 标签：java, rmi

## ** 首先查看更新，因为原始实现包含一些错误假设

## **背景故事**

我有一个必须分叉进程的问题，原因是我使用的是 jni 和单线程 R 进程。我还需要一种监控内存和 CPU 的方法，分叉似乎是唯一真正的解决方案。你不能实现每个进程有多个 R 调用，我已经明确地试图绕过这个限制，但我很确定这是不可能的，因为 rinside 设置方法。

## 当前实施

我目前正在尝试分叉一个进程并将一个 rmi 连接连接到它并将它们存储在一个堆叠池中。问题是 registry.bind() 方法没有按应有的方式阻塞。在主进程中绑定到注册表时，进程将阻塞并等待远程方法调用，但从 RunTime.getRuntime().exec() 启动时，进程不会阻塞并退出。这会导致我的端点守护程序关闭，并且在尝试与守护程序通信时收到套接字错误。我正在使用 gfork 库来分​​叉我的进程，只是为了能够在分叉进程启动时接收异常等。

```
public class JRIDaemon  implements IROperationRemoteProvider, Serializable, Runnable {

    /**
     * Serialization Id
     */
    private static final long serialVersionUID = 2279972098306474322L;

    /**
     * Daemon logger
     */
    private static final Logger logger = Logger.getLogger(JRIDaemon.class.getName());

    /**
     * This is the exeuctor service used to execute our job, the option for
     * newSingleThreadExecutor is important because R is single threaded and JRI
     * puts check in and will kill us if the thread is manipulated.
     */
    private static ExecutorService executorService = Executors.newSingleThreadExecutor();

    /**
     * This implemenation uses the exeuctor service to run the analytics
     * operation. The executor service is used because R is single threaded and
     * cannot be called from outside.
     */
    private JRIExecutionTask callableOperation;

    /**
     * This is the unique id that can to fetch this daemon.
     */
    private final String daemonId;

    private JRIDaemon() {
        this(UUID.randomUUID().toString());
    }

    private JRIDaemon(String daemonId) {
        this.daemonId = daemonId;
    }

    private String getDaemonId() {
        return daemonId;
    }

    @Override
    public void run() {
        logger.info("Starting the jri daemon");

        System.out.println("Starting the jri daemon");
        try {
            IROperationRemoteProvider stub = (IROperationRemoteProvider) UnicastRemoteObject.exportObject(this, 0);

            Registry registry = LocateRegistry.getRegistry();
            registry.rebind(daemonId, stub);
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException("Exception occurred when initializing the rmi agent ", e);
        }
        System.out.println("Daemon is done");
        logger.fine("Exiting JRIDaemon#run");
    }

    /**
     * Close the connection to R services.
     * @throws NotBoundException 
     * @throws RemoteException 
     * @throws AccessException 
     */
    public void close() throws Exception {
        logger.info("Calling close !!!!!!!!!");
        //if (registry != null) {
        //    registry.unbind(daemonId);
        //}
        //System.exit(0);
    }

    /**
     * @see IROperationProvider#execute(IAnalyticsOperation, List, List)
     */
    @Override
    public Map<String, IMetric> execute(IAnalyticsOperation operation, List<IAnalyticsOperationInput> inputs, List<? extends IDataProvider> dataProvider) throws Exception {
        callableOperation = new JRIExecutionTask(inputs, operation, dataProvider);
        Future<Map<String, IMetric>> execution = executorService.submit((Callable<Map<String, IMetric>>) callableOperation);
        return execution.get();
    }

    /**
     * @see IROperationProvider#interrupt()
     * 
     *      TODO come to a solution on stopping and restarting the thread in the
     *      Rengine implementation.
     */
    @Override
    public void interrupt() {
        System.out.println("Calling interrupt on executor service");
        executorService.shutdown();
        // Can't do this yet because it causes a segfault in the task engine
        // process.
        // callableOperation.interrupt();
    }

    @Override
    public Boolean isAllGood() {
        return true;
    }

    @Override
    public void activate() {
    }

    @Override
    public void passivate() {

    }

    /**
     * This is here only for testing purposes.
     * @param args
     * @throws Exception
     */
    public static void main(String args[] ) throws Exception {
        IROperationRemoteProvider provider = create();
        Thread.sleep(10000);
        System.out.println(" ALL GOOD " + provider.isAllGood());

    }

    /**
     * This creates a daemon and initializes returns the client that can be used
     * to talk to the server. The daemon is useless for the calling process as
     * it is a separate process and we use the client to communicate with the
     * jri daemon process.
     * 
     * @return
     */
    public static IROperationRemoteProvider create() throws Exception {
        LocateRegistry.createRegistry(1099);
        String daemonId = UUID.randomUUID().toString();

        JRIDaemon daemon = new JRIDaemon(daemonId);
        Fork<JRIDaemon, org.gfork.types.Void> forkedDaemon = new Fork<JRIDaemon, org.gfork.types.Void>(daemon);

        //forkedDaemon.setJvmOptions("-Djava.security.manager -Djava.security.policy=\"taskenginesecurity.policy\"");

        logger.info("Calling run task");
        forkedDaemon.addListener(new Listener<JRIDaemon, org.gfork.types.Void>() {

            @Override
            public void onFinish(Fork<JRIDaemon, Void> fork, boolean wasKilled) throws IllegalAccessException, InterruptedException {

                logger.info("Task is finished exit value -> " + fork.getExitValue() + " killed ->" + wasKilled);

            }

            @Override
            public void onError(Fork<JRIDaemon, Void> fork) throws IllegalAccessException, InterruptedException {
                logger.info("Error was " + fork.getStdErr());
            }

            @Override
            public void onException(Fork<JRIDaemon, Void> fork) throws IllegalAccessException, InterruptedException, IOException, ClassNotFoundException {
                logger.log(Level.SEVERE, " Erorro occurred in daemon ", fork.getException());
            } 
        });

        Fork.setLoggingEnabled(true);

        forkedDaemon.execute();

        forkedDaemon.waitFor();

        logger.info("Standard out was " + forkedDaemon.getStdOut());

        if (forkedDaemon.isException()) {
            throw new RuntimeException("Unble to create Remote Provider ", forkedDaemon.getException());
        }

       //Thread.sleep(2000);

        Registry registry = LocateRegistry.getRegistry();

        IROperationRemoteProvider process = (IROperationRemoteProvider) registry.lookup(daemonId);

        return process;
    }
} 
```

我使用 create 方法来创建我的分析提供程序的新实现，Fork 类调用在执行时运行以生成新的守护程序。如果我将这个完全相同的代码放在 public static void main(String[] args) 中，该进程会进行守护进程并等待 rmi 调用，但是当通过 for 操作执行时它不会。

这是 Gfrork 执行方法，您可以看到它使用 Runtime.exec

```
/**
     * Starts a new java process which runs the task. 
     * The subprocess inherits the environment including class path an
     * system properties of the current process. The JVM is launched using
     * executable derived from standard system property 'java.home'.
     * <p>
     * Standard output (System.out) of the task can be red by {@link #getStdOut()} or
     * forwarded to a file, see {@link #setStdOutWriter(Writer)}.
     * The same is possible for Standard error (System.err), 
     * see {@link #getStdErr()} and {@link #setStdErrWriter(Writer)}.
     * 
     * @throws Exception
     */
    public synchronized void execute() throws Exception {
        if (isExecuting()) {
            throw new IllegalStateException(FORK_IS_ALREADY_EXECUTING);
        }
        exec = Runtime.getRuntime().exec(createCmdArray(), null, workingDir);

        taskStdOutReader = new BufferedReader(new InputStreamReader(exec.getInputStream()));
        taskErrorReader = new BufferedReader(new InputStreamReader(exec.getErrorStream()));
        readError();
        readStdOut();

        waitForFinishedThread = new Thread("jforkWaitForFinishedThread") {
            // needed to notify listeners after execution
            @Override
            public void run() {
                try {
                    waitFor();
                } catch (final Exception e) {
                    e.printStackTrace();
                    stdErrText.append(String.format("ERROR jforkListenerNotifier: %s%n", e.toString()));
                }
            }
        };
        waitForFinishedThread.start();
    } 
```

我已经添加了睡眠计时器来监视进程，它确实开始了，不久之后它就退出了，没有错误，状态为 0。我已经验证，如果在 run 方法中配置 rmi 时出现问题，它将返回异常。RMI 似乎正在正确初始化，但不会阻塞，因此分叉的进程不会退出。我在 Runtime.exec 上有 RTFM，但不知道是什么导致它退出。任何帮助，将不胜感激。

## 更新

谢谢EJP，尽管您的言论居高临下，但它们是正确的。我做了一个错误的假设，即绑定被阻塞是因为进程没有死掉，但这是因为它创建了一个单独的线程来处理 rmi 通信。这就是使过程保持活力的原因。

```
import java.rmi.Remote;
import java.rmi.RemoteException;
import java.rmi.registry.LocateRegistry;
import java.rmi.registry.Registry;
import java.rmi.server.UnicastRemoteObject;

public class RunnableRMIDaemon implements Remote {

        public static void main(String args[]) throws InterruptedException {
            String daemonID = "123";
            System.out.println("STARTING");
            Registry registry;
            try {
                RunnableRMIDaemon daemon = new RunnableRMIDaemon();
                registry = LocateRegistry.getRegistry();
                final Remote stub = (Remote) UnicastRemoteObject.exportObject(daemon, 0);
                registry.rebind(daemonID, stub);

                Thread.sleep(1000);

            } catch (RemoteException e) {
                throw new RuntimeException("Remote Exception occurred while running " + e);
            } 
            System.out.println("ENDING");
        }
    }

import java.io.IOException;

public class ForkRMIDaemon {

    public static void main(String args[]) throws IOException, InterruptedException {
        System.out.println("Starting fork");
        Runtime.getRuntime().exec("java -cp . RunnableRMIDaemon");
        Thread.sleep(10000);
        System.out.println("Completed fork");
    }
} 
```

当第一个进程死亡时， Runtime.getRuntime().exec() 进程仍然存在。

```
thanatos:testingrmifork chris$ java ForkRMIDaemon
Starting fork
Completed fork
tv-mini:testingrmifork chris$ ps -ef | grep java
  501 25499     1   0   0:00.10 ttys007    0:00.72 /usr/bin/java -cp . RunnableRMIDaemon
  501 25501 25413   0   0:00.00 ttys007    0:00.00 grep java
thanatos:testingrmifork chris$ 
```

我的调查尚未完成，但似乎简单的 gfork 库实际上正在做一些事情来关闭返回过程。我查看了 gfork 代码，但没有看到这可能发生在哪里。

感谢 EJP，我对不正确的信息表示感谢。我猜 gfork 正在做一些诡计，因为它允许你调用一个不是 main 的方法。

我假设 java 处理线程更像 c pthreads 并且我总是不得不在 main() 中创建一个 while 循环，否则我的线程将在 main 退出时被杀死。我的错

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:04:45.453

> 问题是 registry.bind() 方法没有按应有的方式阻塞。在主进程中绑定到注册表时，该进程将阻塞并等待远程方法调用。

不，不会的。这是幻想。你编的。文档中没有任何内容可以说明任何事情。它不是阻塞调用（除了它与注册表通信的时刻）；它不会“阻塞并等待远程方法调用”。它返回到您的代码。如果你编造了行为而系统没有表现出来，你一定不要感到惊讶。

> 这会导致我的端点守护程序关闭

不，它没有。您的端点守护程序以某种方式导致自身关闭。RMI 启动非守护线程来处理传入的连接，因此已导出远程对象的 JVM 不会退出，直到这些远程对象被显式或通过 GC 或应用程序调用 System.exit() 取消导出。防止远程对象 GC 的方法是存储对它们的静态引用。

我必须说我不明白你为什么要执行一个子进程，如果你在主进程中要做的就是等待它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:40:15.100

想出了一个半肮脏的方法来做到这一点，这将无限期地阻塞，但我必须找到一个可靠的方法来关闭分叉的守护进程，在正常环境中，当我从单元测试中运行它时，进程应该得到一个 sigkill . 我想我快到了。

```
@Override
public void run() {
    logger.info("Starting the jri daemon");

    Registry registry;
    try {
        registry = LocateRegistry.getRegistry();
        final IROperationRemoteProvider stub = (IROperationRemoteProvider) UnicastRemoteObject.exportObject(this, 0);
        registry.rebind(daemonId, stub);
    } catch (RemoteException e) {
        throw new RuntimeException("Remote Exception occurred while running " + e);
    }

    final Object waitObj = new Object();

    synchronized (waitObj) {
        while (!closed)
            try {
                waitObj.wait();
            } catch (InterruptedException e) {
                closed = true;
            }
    }
    logger.fine("Exiting JRIDaemon#run");
} 
```

# matlab - 使用函数的 Matlab 模糊过滤器

> ID：14714801
> 
> 赞同：0
> 
> 时间：2013-02-05T18:56:31.460
> 
> 标签：matlab

我正在尝试在 Matlab 中创建一个模糊我的图像的函数。我正在使用 Matlabs 演示图像`peppers.png`。

这是我的功能：

```
 function g = myfilter(f, h)

    f = double(f); %convert to double
    g = zeros(size(f)); %new array (size of f)
    a = (size(h, 1) - 1) / 2; %padding on edges

    for row = (a + 1) : (size(f,1) - a)
        for col = (a + 1) : (size(f,2) - a)

            gxy = 0; %running sum

            for m = -a:a
                for n = -a:a

                    gxy = gxy + f(row - m, col - n) + h(m + a+1, n + a+1);
                end
            end

            g(row, col) = gxy;
        end
    end

    g = uint8(g); %convert back to int 
```

这是我的命令：

```
 >> img = imread('peppers.png');
    >> imshow(img)
    >> imgGray = rgb2gray(img);
    >> imshow(imgGray)
    >> 
    >> filt1 = (1/9)*ones(3)

       filt1 =

        0.1111    0.1111    0.1111
        0.1111    0.1111    0.1111
        0.1111    0.1111    0.1111

   >> test = myfilter(imgGray, filt1);
   >> imshow(test) 
```

它成功地将彩色图像转换为灰色并应用过滤器。

不幸的是，过滤器只会创建一个几乎完整的白色图像（太亮）......我根本不明白为什么......它应该使用 3x3 过滤器对每个像素进行平均......对你们来说有什么明显的为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:10:39.080

您需要查看 MATLAB 的 conv2 函数。以下用于 2D 卷积的函数已从 conv2 中提取，并且非常适合您给定的过滤器。

```
function c = myfilter(a, b)
 [ma, na] = size(a);
 [mb, nb] = size(b);
c = zeros( ma+mb-1, na+nb-1 );
    for i = 1:mb
        for j = 1:nb
            r1 = i;
            r2 = r1 + ma - 1;
            c1 = j;
            c2 = c1 + na - 1;
            c(r1:r2,c1:c2) = c(r1:r2,c1:c2) + b(i,j) * a;
        end
    end
c = uint8(c) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:58:00.623

简单的算术错字。

`gxy = gxy + f(row-m, col-n) + h(m+a+1, n+a+1);`

应该是：`gxy = gxy + f(row-m, col-n) * h(m+a+1, n+a+1);`。

它工作正常，现在创建一个模糊的图像。

`f`不是将和相乘`h`，而是在上面的代码中求和，这不符合由 2D 卷积定义的空间域图像过滤器。Matlab 正确执行了该函数，但是即使过滤器使用不同的算术运算符正确运行，也会引入异常（或意外结果）。

问题解决了。

# algorithm - OCR 分词

> ID：14714802
> 
> 赞同：1
> 
> 时间：2013-02-05T18:56:31.867
> 
> 标签：algorithm, statistics, ocr, text-segmentation

我正在开发一个 OCR 系统，在分词方面需要一些帮助。

目前，OCR 系统检测一行中的 blob（使用连接组件标记算法）。每个 blob 代表一个单独的字母，并在其周围有一个边界框。某些字符可能在其边界框中重叠。

我怎样才能将这些字母组合成单词？如何确定将单词彼此分开的最佳距离，以便： 1.单词不会被剪切 2.单词不会与其他单词连接据我所见 - 字母和单词之间的距离可能会有所不同很多。

这部分是在字母分类之前完成的，因此无法按实际词义进行区分。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:34:58.067

如果您对每个垂直列的像素进行直方图，您可能会发现单词之间的间隔往往是最低的。如果您坚持在字母本身之前处理单词分隔符，那么将此类技术与某种二进制分类器结合在一起可能是一个很好的起点。（例如，你可以用这个直方图来衡量你的语料库中单词的平均长度。）

见： [http ://www.ijcaonline.org/rtippr/number1/SPE96T.pdf](http://www.ijcaonline.org/rtippr/number1/SPE96T.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:39:27.763

我倾向于先尝试阅读角色。这将允许您使用（取决于语言的）工具来检查词尾以帮助确认您已经到达结尾。此信息将允许您对“空白”检测进行偏向，从而提高词尾的质量。它还具有增强准确性的额外用途-实际上，它可以帮助您在错误时更加自信；）

空格很难处理，而且我所知道的大多数 API（包括我们自己的 API）都会返回一个空格字符，而不管有多少空间。如果您尝试处理以表格形式排列的信息（例如，左上角和右上角带有地址块的字母），您通常会在两组数据之间获得一个空格。当然，存储每个角色的位置将有助于后期处理。

祝你好运！

# facebook - Canvas App Like Button - 使用应用 URL 或社区页面 URL？

> ID：14714803
> 
> 赞同：1
> 
> 时间：2013-02-05T18:56:34.073
> 
> 标签：facebook, facebook-like, facebook-canvas

我试过两者都用。如果我喜欢应用程序的 URL ( [http://apps.facebok.com/myapp](http://apps.facebok.com/myapp) )，它会计算喜欢，但我没有从社区页面获取内容。社区页面是从此应用的开发者应用工具生成的。如果我使用生成的社区页面的 URL，我确实会收到社区页面的帖子。我唯一的问题是 Facebook 会在您现在喜欢它时自动提供共享 URL，并且共享的 URL 不会将用户直接带到我的应用程序。有没有我错过的设置来使这一切都与 APP URL 一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:02:43.943

我也有类似的问题。您可以将 URL 共享到社区页面，并让该页面将用户重定向到您的应用程序。这样，任何共享链接都会将用户引导至应用程序，您将从社区页面获取内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T20:03:37.700

经过大量研究（并查看其他 Facebook 应用程序的源代码）后，答案是创建一个与您的应用程序名称相同的社区页面，并在您的应用程序中使用带有社区页面 URL 的“赞”按钮。如果您正确设置它，社区页面可以有一个指向您的应用程序的链接（如果它在 Facebook 上）。

**在页面 URL 和社区页面之间没有更好的连接感觉对 Facebook 来说是一个巨大的错误。也许这在未来会有所改善。**

# php - 检索 td 标签后的标签编号

> ID：14714808
> 
> 赞同：-2
> 
> 时间：2013-02-05T18:56:52.693
> 
> 标签：php, dom, tags

在 php 中，我想检索 TD 标记之后和 php 文件中下一个 TD 标记之前的 A 标记的数量。这是一个示例

```
<td>Title 1</td>
<div></div>
<a> 1</a>
<a>2</a>
<td> title 2</td>
<a>1</a>
<div></div> 
```

对于 TD Title 1 = 2 一个标签 对于 TD Title 2 = 1 一个标签

我尝试了一切..但我没有更多的解决方案。它需要在 php 中完成（可能使用 DOM :) 感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:15:41.813

You can use any php data scrapping library or class for finding number of tags in your pages.

try

[http://code.google.com/p/phpquery/](http://code.google.com/p/phpquery/) or [http://php.net/manual/en/class.domxpath.php](http://php.net/manual/en/class.domxpath.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:06:11.230

```
$text = '<td>Title 1</td> <div></div><a> 1</a><a>2</a><td> title 2</td><a>1</a><div></div>'; 
```

现在，如果你想`1`从`<td>Title 1</td>`

```
<?php 
function get_between($text, "<td>", </td>) 
{ 
  $substr = substr($input, strlen($start)+strpos($input, $start), (strlen($input) - strpos($input, $end))*(-1)); 
  return $substr; 
} 

//Example: 

$foo = get_between($text,"<td>", </td>);
echo (int)$foo;
//will output "1"
?> 
```

# ajax - 表单提交期间单个字段的多个/单独条目

> ID：14714811
> 
> 赞同：0
> 
> 时间：2013-02-05T18:56:53.413
> 
> 标签：ajax, asp.net-mvc-3, jquery, asp.net-ajax

我的 ASP MVC3 网站上有一个表单，需要在提交表单之前允许其中一个字段的多个条目。这是针对销售代理的信息，但是由于我们将销售人员外包，因此一个代理可能与多家公司合作。

此表单过去由 Access 数据库提供。使用以下表格输入公司信息，该表格内置在主表格中：

![在此处输入图像描述](../Images/f3ae3d3e189e1c9b62b2f58336558167.png)

这将允许用户从 DSS 公司名称中进行选择并输入公司（或机构统计）ID，点击前进箭头，然后输入下一个直到完成。用户还可以在提交表单之前来回循环浏览他们的条目。

有谁知道我可以用来在 ASP MVC3 页面上实现此功能的任何特定 Ajax 或 JQuery 插件或技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:35:06.890

您可以考虑使用[`variable length list`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)允许您将记录动态添加/删除到视图模型集合的方法。

您的视图模型可能如下所示：

```
public class CompanyViewModel
{
    public int SelectedCompanyId { get; set; }
    public IEnumerable<selectListItem> Companies { get; set; }
    public string AgencyStat { get; set; }
} 
```

然后当然您的视图将被强输入到`IEnumerable<CompanyViewModel>`. 您将添加/删除链接，允许用户向此列表添加或删除记录，最后当他决定提交表单时，您的 HttpPost 控制器操作将接收集合以进行进一步处理。

# c# - FtpWebRequest WebException：“无法连接到远程服务器”

> ID：14714815
> 
> 赞同：2
> 
> 时间：2013-02-05T18:57:06.950
> 
> 标签：c#, ftpwebrequest, system.net.webexception

我在 Windows 服务中有代码，当我通过测试工具在本地运行它时成功连接到 FTP 服务器（FTP 服务器位于本地网络上的另一台机器上）。

但是，当我在生产托管环境中安装它时，我得到了可怕的 WebException “无法连接到远程服务器”。[`ACTV`无论我使用的是 FTP还是`PASV`FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol#Protocol_overview)似乎都无关紧要，我都得到了这个 WebException。但是，如果我尝试从 Windows 命令行 FTP，它工作得非常好（所以不是防火墙有问题）。

我正在使用的代码（改编自[How to List Directory Contents with FTP in C#?](https://stackoverflow.com/questions/3298922/how-to-list-directory-contents-with-ftp-in-c)）内容如下：

```
private static readonly string __ftpSourceServer = "ftp://"
  + ConfigurationManager.AppSettings["FtpServer"] + "/";
private static readonly NetworkCredential __ftpCreds = new NetworkCredential(
  ConfigurationManager.AppSettings["Username"],
  ConfigurationManager.AppSettings["Password"]);

// And now the method MediaSyncDaemon.GetFilesToFetch:
bool usePassive = Boolean.TryParse(ConfigurationManager.AppSettings["UsePassive"]
  , out usePassive) && usePassive;

Uri ftpSrv = new Uri(__ftpSourceServer + Uri.EscapeUriString(
  ConfigurationManager.AppSettings["FtpPath"]));
Logger.Debug("Connecting to FTP server at " + ftpSrv + "; PASV? " + usePassive);

FtpWebRequest listRequest = (FtpWebRequest) WebRequest.Create(ftpSrv);
listRequest.Method = WebRequestMethods.Ftp.ListDirectory;
listRequest.Credentials = __ftpCreds;
listRequest.UsePassive = usePassive;
listRequest.UseBinary = false;

using (FtpWebResponse listResponse = (FtpWebResponse) listRequest.GetResponse())
{
    // ReSharper disable AssignNullToNotNullAttribute
    return new StreamReader(listResponse.GetResponseStream())
        .ReadToEnd().Split(new[] { '\n', '\r' },
            StringSplitOptions.RemoveEmptyEntries)
        .Where(s => s.EndsWith(".zip", true, CultureInfo.InvariantCulture))
        .ToList();
    // ReSharper restore AssignNullToNotNullAttribute
} 
```

异常在该行（语句之外）的`FtpWebRequest.GetResponse()`调用中引发，堆栈跟踪中没有其他内容：`using``return`

> `System.Net.WebException`: 无法连接到远程服务器
>    at `System.Net.FtpWebRequest.GetResponse()`
>    （该文件中的行号）

我的测试工具（有效）和生产环境（无效）之间唯一真正的区别是生产环境中存在防火墙——所有四台服务器都位于稍微不同的子网上：

```
Dev client    10.16.6.155     subnet 255.255.255.128
Dev server    10.16.7.242     subnet 255.255.255.0
Prod client   192.168.102.107 subnet 255.255.255.0
Prod server   192.168.203.110 subnet 255.255.255.0 
```

但防火墙不是问题，我可以交互地从 Prod 客户端 FTP 到 Prod 服务器，只是不能以编程方式。

我已经尝试更改`bool`appSettings 的值，`UsePassive`并且没有任何区别，并且在每种情况下，FTP 服务器日志中都没有显示任何内容（所以它没有走那么远）。

现在我不指望任何人能够调试我的托管环境的硬件基础设施，但我正在努力思考我可以改变什么来让它工作。我已经看到它在我的测试工具中本地工作，调用相同的方法。如果有帮助，测试工具代码如下所示：

```
[NUnit.Framework.Test]
public void FtpFileListTest()
{
    ICollection<string> files = MediaSyncDaemon.GetFilesToFetch();
    Assert.IsNotNull(files);
    Assert.Greater(files.Count, 0);
} 
```

请问有人知道我还能尝试什么吗？

谢谢！

* * *

## 更新

在评论中有一些可以查看的地方的建议后，我可以进一步更新一下：

1.  问题似乎不是用户权限 - 该服务正在本地系统帐户的上下文中运行（该帐户[比管理员拥有更多权限](https://stackoverflow.com/a/510225/205245)）

2.  问题似乎不是代码访问安全性。我已经为这段代码添加了对 entry 方法的调用：[`SocketPermission`](http://msdn.microsoft.com/en-gb/library/system.net.socketpermission(v=vs.100).aspx)`.`[`Demand`](http://msdn.microsoft.com/en-gb/library/system.security.codeaccesspermission.demand(v=vs.100).aspx)

    ```
    System.Security.CodeAccessPermission socketPermission;
    socketPermission = new SocketPermission(NetworkAccess.Connect,
      TransportType.Tcp, ConfigurationManager.AppSettings["FtpServer"], 20);
    socketPermission.Demand();
    socketPermission = new SocketPermission(NetworkAccess.Connect,
      TransportType.Tcp, ConfigurationManager.AppSettings["FtpServer"], 21);
    socketPermission.Demand(); 
    ```

    而且我没有看到任何[SecurityException](http://msdn.microsoft.com/en-gb/library/system.security.securityexception(v=vs.100).aspx)被抛出；在相同代码位置的新行号处，我仍然得到相同的 WebException。

有人对我可以尝试什么有任何进一步的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-08-01T18:49:18.597

我想分享我们的问题和解决方案：我们无法在公司 PC 上使用 ftpwebrequest 连接到 FTP 服务器，但在我们的 PC 上它可以正常工作。问题在于 ftpwebrequest() 正在获取公司 IT 强制在 PC 上的代理配置。为了解决这个问题，我们添加了 (ftpwebrequest object).proxy = null; 在连接之前。

# android - 不将 EditText 值存储在字符串中

> ID：14714816
> 
> 赞同：-2
> 
> 时间：2013-02-05T18:57:06.670
> 
> 标签：android

我在将可编辑文本值存储在字符串中时遇到问题。我只想存储用户输入的值，将其存储在某个变量中。我在存储一个值后使用 toast 来检查该值是否存储在其中，并且 toast 没有显示任何值。我尝试以下代码，但没有发现它有帮助。

```
 package com.example.electropollsys;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class CreateAcc extends Activity {
    protected void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);

    requestWindowFeature(Window.FEATURE_NO_TITLE);
     this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,  
             WindowManager.LayoutParams.FLAG_FULLSCREEN);

     setContentView(R.layout.create_acc);

     final Button b = (Button) findViewById(R.id.button3);
     b.setOnClickListener(new View.OnClickListener() {
         public void onClick(View v) {

             Intent i = new Intent(CreateAcc.this, SignIn.class);
            i.addFlags(
                Intent.FLAG_ACTIVITY_CLEAR_TOP |
                Intent.FLAG_ACTIVITY_NEW_TASK);
                startActivity(i);
         }

     });

     final Button a = (Button) findViewById(R.id.button1);
     a.setOnClickListener(new View.OnClickListener() {

            @SuppressLint("ShowToast")
            public void onClick(View v){

                EditText input1= (EditText)findViewById(R.id.fname1); 
                String fname = input1.getEditableText().toString();

                EditText input2= (EditText) findViewById(R.id.lname1); 
                String lname = input2.getEditableText().toString();

                Toast.makeText(CreateAcc.this,"...."+fname+"...." , Toast.LENGTH_LONG);
                Toast.makeText(CreateAcc.this,"...."+lname+"...." , Toast.LENGTH_LONG);

              }
         });
    }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T18:58:21.183

尝试：

```
Toast.makeText(CreateAcc.this,"...."+fname+"...." , Toast.LENGTH_LONG).show();
Toast.makeText(CreateAcc.this,"...."+lname+"...." , Toast.LENGTH_LONG).show(); 
```

`show()`除非调用该方法，否则不会显示 Toast 。该`makeText()`方法返回一个 Toast 对象，您必须使用它来显示 toast。

您通常会收到有关此问题的 lint 警告，但您似乎已使用`@SuppressLint("ShowToast")`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:01:25.047

你确实喜欢这种方式。

```
Toast.makeText(CreateAcc.this,"...."+fname+"...." , Toast.LENGTH_LONG); 
```

使用它启动 toast 对象并返回对象，但要显示 toast 通知，您需要在该对象上调用 show 方法。

而不是这个写这个。

```
Toast.makeText(CreateAcc.this,"...."+fname+"...." , Toast.LENGTH_LONG).show(); 
```

或者

```
Toast toast = Toast.makeText(CreateAcc.this,"...."+fname+"...." , Toast.LENGTH_LONG);
toast.show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:04:37.763

你忘了在最后添加 .show() 。

参考[http://developer.android.com/guide/topics/ui/notifiers/toasts.html](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)

[http://thedevelopersinfo.wordpress.com/2009/10/23/showing-toast-in-android/](http://thedevelopersinfo.wordpress.com/2009/10/23/showing-toast-in-android/)

# prestashop - Prestashop 1.5。货币登录 blockspecials 模块

> ID：14714818
> 
> 赞同：0
> 
> 时间：2013-02-05T18:57:08.310
> 
> 标签：prestashop

我正在使用 blockspecials 模块，如图所示，显示了货币。据我所知，如果你从这里删除货币符号，你就会从商店的任何地方删除它。也许有一种方法可以将其从特别版中删除？这样看起来不太好。

![在此处输入图像描述](../Images/1e6b2b594c8a11184145010d53fa9a2a.png)

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T14:05:08.943

该模块正在调用名为 displayWtPrice 的自定义 prestashop smarty 函数（位于 /classes/Tools.php 中）。此函数将数字正确格式化为货币。如果您不想要这种格式，请从 blockspecials.tpl 中删除 smarty 函数。

默认情况下，它看起来像 ;

```
{if !$PS_CATALOG_MODE}
    <span class="price-discount">{if !$priceDisplay}{displayWtPrice p=$special.price_without_reduction}{else}{displayWtPrice p=$priceWithoutReduction_tax_excl}{/if}</span>
    <span class="price">{if !$priceDisplay}{displayWtPrice p=$special.price}{else}{displayWtPrice p=$special.price_tax_exc}{/if}</span>
{/if} 
```

删除 smarty 标签。

```
{if !$PS_CATALOG_MODE}
    <span class="price-discount">{if !$priceDisplay}{$special.price_without_reduction}{else}{$priceWithoutReduction_tax_excl}{/if}</span>
    <span class="price">{if !$priceDisplay}{$special.price}{else}{$special.price_tax_exc}{/if}</span>
{/if} 
```

这将为您留下一个未格式化的号码。

如果您需要格式化但没有符号并且它只针对这一功能，您将不得不修改 prestashop 的核心。

您必须通过覆盖/扩展 Tools.php 来复制 /classes/Tools.php 中的 displayPrice 函数 - 创建新类 /overrides/classes/Tools.php

```
<?php

/**
* Tools
*/
class Tools extends ToolsCore
{

    /**
    * Return price with currency sign for a given product
    *
    * @param float $price Product price
    * @param object $currency Current currency (object, id_currency, NULL => context currency)
    * @return string Price correctly formated (sign, decimal separator...)
    */
    public static function displayPrice($price, $currency = null, $no_utf8 = false, Context $context = null, $showSymbol = true)
    {
        if (!is_numeric($price))
            return $price;
        if (!$context)
            $context = Context::getContext();
        if ($currency === null)
            $currency = $context->currency;
        // if you modified this function, don't forget to modify the Javascript function formatCurrency (in tools.js)
        elseif (is_int($currency))
            $currency = Currency::getCurrencyInstance((int)$currency);

        if (is_array($currency))
        {
            $c_char = $currency['sign'];
            $c_format = $currency['format'];
            $c_decimals = (int)$currency['decimals'] * _PS_PRICE_DISPLAY_PRECISION_;
            $c_blank = $currency['blank'];
        }
        elseif (is_object($currency))
        {
            $c_char = $currency->sign;
            $c_format = $currency->format;
            $c_decimals = (int)$currency->decimals * _PS_PRICE_DISPLAY_PRECISION_;
            $c_blank = $currency->blank;
        }
        else
            return false;

        $blank = ($c_blank ? ' ' : '');
        $ret = 0;
        if (($is_negative = ($price < 0)))
            $price *= -1;
        $price = Tools::ps_round($price, $c_decimals);
        switch ($c_format)
        {
            /* X 0,000.00 */
            case 1:
                $ret = (($showSymbol) ? $c_char : '').$blank.number_format($price, $c_decimals, '.', ',');
                break;
            /* 0 000,00 X*/
            case 2:
                $ret = number_format($price, $c_decimals, ',', ' ').$blank.(($showSymbol) ? $c_char : '');
                break;
            /* X 0.000,00 */
            case 3:
                $ret = (($showSymbol) ? $c_char : '').$blank.number_format($price, $c_decimals, ',', '.');
                break;
            /* 0,000.00 X */
            case 4:
                $ret = number_format($price, $c_decimals, '.', ',').$blank.(($showSymbol) ? $c_char : '');
                break;
            /* 0 000.00 X  Added for the switzerland currency */
            case 5:
                $ret = number_format($price, $c_decimals, '.', ' ').$blank.(($showSymbol) ? $c_char : '');
                break;
        }
        if ($is_negative)
            $ret = '-'.$ret;
        if ($no_utf8)
            return str_replace('€', chr(128), $ret);
        return $ret;
    }

} 
```

现在您需要以与工具相同的方式覆盖，但这次`displayWtPrice`是 Product 类中的函数。

我们将覆盖这个函数，如下所示；

```
public static function displayWtPrice($params, &$smarty)
    {
        return Tools::displayPrice($params['p'], Context::getContext()->currency, false, null, (($params['showsymbol'] == false) ? false : true));
    } 
```

我们已经指定了附加的函数参数，如果提供，它将从 smarty 中获取。

现在你需要`blockspecials.tpl`用额外的参数来修改你`displayWtPrice`的`showsymbol=false`

```
{if !$PS_CATALOG_MODE}
    <span class="price-discount">{if !$priceDisplay}{displayWtPrice p=$special.price_without_reduction showsymbol=false}{else}{displayWtPrice p=$priceWithoutReduction_tax_excl showsymbol=false}{/if}</span>
    <span class="price">{if !$priceDisplay}{displayWtPrice p=$special.price showsymbol=false}{else}{displayWtPrice p=$special.price_tax_exc showsymbol=false}{/if}</span>
{/if} 
```

# django - 如何使 redistogo 在heroku 上工作？

> ID：14714820
> 
> 赞同：1
> 
> 时间：2013-02-05T18:57:16.327
> 
> 标签：django, heroku, python-2.7, redis, redistogo

我通过 redis 进行后台处理的 Django 开发网站在本地工作，但在 heroku 上不起作用。我的 requirements.txt 包含“redis==2.7.2”和“rq==0.3.2”，我在 heroku 上启动了 web=1 和 worker=1。我有 'redistogo:nano' 附加组件。验证它在 heroku 控制台上工作的说明不起作用：没有“redis.set()”或“redis.get()”。所以我尝试了 [运行 Heroku 后台任务中的代码，只有 1 个 web dyno 和 0 个 worker dyno](https://stackoverflow.com/questions/12634447/running-heroku-background-tasks-with-only-1-web-dyno-and-0-worker-dynos?rq=1) ，如下所示。在 settings.py 中：

```
import os
import os.path
import socket
import sys
import urlparse
from rq import Queue
from worker import conn

redis_q = Queue(connection=conn)
... 
```

这是worker.py：

```
import os
import redis
from rq import Worker, Queue, Connection
listen = ['high', 'default', 'low']
redis_url = os.getenv('REDISTOGO_URL', 'redis://localhost:6379')
conn = redis.from_url(redis_url)
if __name__ == '__main__':
    with Connection(conn):
        worker = Worker(map(Queue, listen))
        worker.work() 
```

以下是执行后台调用的视图片段：

```
from upload import *  # where process_upload_file() lives
...
    catchall = {...}
    catchall_string = str(catchall)
    redis_q.enqueue(process_upload_file, catchall_string)
... 
```

upload.py 有：

```
def process_upload_file(catchall_string):
    ... 
```

为什么这不起作用？

（对于额外的功劳，如果有人可以给我一个更好的方法将参数作为字符串传递，将不胜感激。）

档案：

```
web: gunicorn exim.wsgi -b "0.0.0.0:$PORT"
worker: python worker.py 
```

这是设置 S3 存储桶并将 heroku 指向它之后的最新尝试的 heroku 日志。它找不到“ [http://s3.amazonaws.com/mycompany/sample.csv](http://s3.amazonaws.com/mycompany/sample.csv) ”（此处显示）或“ [http://mycompany.s3.amazonaws.com/sample.csv](http://mycompany.s3.amazonaws.com/sample.csv) ”。

```
 0:46:31+00:00 app[worker.1]: [2013-02-09 00:46] INFO: worker: 
    2013-02-09T00:46:44+00:00 heroku[web.1]: Starting process with command `gunicorn myapp.wsgi -b "0.0.0.0:27999"`
    2013-02-09T00:46:45+00:00 app[web.1]: 2013-02-09 00:46:45 [2] [INFO] Starting gunicorn 0.15.0
    2013-02-09T00:46:45+00:00 app[web.1]: 2013-02-09 00:46:45 [2] [INFO] Listening at: http://0.0.0.0:27999 (2)
    2013-02-09T00:46:45+00:00 app[web.1]: 2013-02-09 00:46:45 [2] [INFO] Using worker: sync
    2013-02-09T00:46:45+00:00 app[web.1]: 2013-02-09 00:46:45 [5] [INFO] Booting worker with pid: 5
    2013-02-09T00:46:50+00:00 heroku[web.1]: State changed from starting to up
    2013-02-09T00:47:15+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=3ms service=3132ms status=404 bytes=30
    2013-02-09T00:47:15+00:00 heroku[router]: at=info method=GET path=/upl/upload75/ host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=6ms service=980ms status=200 bytes=958
    2013-02-09T00:47:15+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=16ms status=404 bytes=30
    2013-02-09T00:47:21+00:00 heroku[router]: at=info method=POST path=/upl/upload75/ host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=4ms service=244ms status=302 bytes=5
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/upl/upload77/ host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=162ms status=200 bytes=44024
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/css/bootstrap.min.css host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=1ms connect=3ms service=26ms status=200 bytes=95438
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/css/style.css host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=15ms status=200 bytes=515
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/js/jquery-1.7.2.min.js host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=3ms service=17ms status=200 bytes=94840
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/js/scripts.js host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=1ms connect=6ms service=5ms status=200 bytes=509
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/js/bootstrap.min.js host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=7ms status=200 bytes=22323
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/snippets/footer.html host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=16ms status=200 bytes=537
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/img/groovepaper.png host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=1ms service=11ms status=200 bytes=74596
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/static/font/fontawesome-webfont.woff host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=3ms service=12ms status=200 bytes=41752
    2013-02-09T00:47:22+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=1ms service=15ms status=404 bytes=30
    2013-02-09T00:47:37+00:00 heroku[router]: at=info method=POST path=/upl/upload77/ host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=2ms service=182ms status=200 bytes=98
    2013-02-09T00:47:37+00:00 app[worker.1]: [2013-02-09 00:47] INFO: worker: default: upload.process_upload_file("{'server_file': u'/app/myapp/myapp/uploads/d27/org20130208194721.csv', 'client_file': u'aorg.csv', 'myco_id': 27, 'user_email': u'me.myself@mycompany.com', 'ignore_header_line': True, 'content_type': 'org', 'column_choices': {u'org_name': 0, u'addr1': 1, u'country_code': 8}}") (eb79ed7e-cff8-4071-a0c8-b1d4b1bd834f)
    2013-02-09T00:47:37+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=chewy-chiclet-3186.herokuapp.com fwd=71.184.228.19 dyno=web.1 queue=0 wait=0ms connect=1ms service=9ms status=404 bytes=30
    2013-02-09T00:47:42+00:00 app[worker.1]: [2013-02-09 00:47] ERROR: horse: IOError: [Errno 2] No such file or directory: 'http://s3.amazonaws.com/mycompany/sample.csv'
    2013-02-09T00:47:42+00:00 app[worker.1]:     rv = job.perform()
    2013-02-09T00:47:42+00:00 app[worker.1]:   File "/app/refactor.py", line 72, in read_uploaded_file
    2013-02-09T00:47:42+00:00 app[worker.1]:     allrows = csv.reader(open(filepath, 'rU'), dialect='excel')
    2013-02-09T00:47:42+00:00 app[worker.1]: IOError: [Errno 2] No such file or directory: 'http://s3.amazonaws.com/mycompany/sample.csv'
    2013-02-09T00:47:42+00:00 app[worker.1]:   File "/app/refactor.py", line 41, in read_csv
    2013-02-09T00:47:42+00:00 app[worker.1]: [2013-02-09 00:47] WARNING: horse: Moving job to failed queue.
    2013-02-09T00:47:42+00:00 app[worker.1]: Traceback (most recent call last):
    2013-02-09T00:47:42+00:00 app[worker.1]:     output, nrows, error = acceptable_upload_filetypes[ext](filepath, **kwargs)
    2013-02-09T00:47:42+00:00 app[worker.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/rq/worker.py", line 393, in perform_job
    2013-02-09T00:47:42+00:00 app[worker.1]: 
    2013-02-09T00:47:42+00:00 app[worker.1]: [2013-02-09 00:47] DEBUG: horse: Invoking exception handler <bound method Worker.move_to_failed_queue of <rq.worker.Worker object at 0x12cb310>>
    2013-02-09T00:47:42+00:00 app[worker.1]:   File "/app/.heroku/python/lib/python2.7/site-packages/rq/job.py", line 328, in perform
    2013-02-09T00:47:42+00:00 app[worker.1]:     self._result = self.func(*self.args, **self.kwargs)
    2013-02-09T00:47:42+00:00 app[worker.1]:   File "/app/upload.py", line 248, in process_upload_file
    2013-02-09T00:47:42+00:00 app[worker.1]:     all_rows, nrows, error = read_uploaded_file(server_file, maxrows=maxrows)
    2013-02-09T00:47:42+00:00 app[worker.1]: [2013-02-09 00:47] INFO: worker: 
    2013-02-09T00:47:42+00:00 app[worker.1]: [2013-02-09 00:47] INFO: worker: *** Listening on high, default, low...
    (venv)me@host:~/myapp$ 
```

# php - php postgresql pg_fetch_all

> ID：14714821
> 
> 赞同：2
> 
> 时间：2013-02-05T18:57:25.787
> 
> 标签：php, postgresql

我在`pg_fetch_all`( `postgresql`) 遇到了一个奇怪的问题：它永远不会返回我更多的棕褐色 2 列

例如，此代码：

```
 $dbh = pg_connect("host=localhost dbname=dbname user=user password=passwd");
    $query = "SELECT m.id, v.nom, v.id FROM machine m, version v WHERE m.id_version = v.id;";
    $result = pg_query($dbh, $query);
    $array = pg_fetch_all($result);
    print_r($array); 
```

只打印我`m.id`，`v.nom`！

如果我在 pg_my_admin 中粘贴完全相同的 SQL 请求，则会返回每个列。

如果我将结果解析为

```
 $array = array();
    while ($row = pg_fetch_row($result)) {
      $array[] = $row;
    } 
```

它完美地工作。为什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T18:59:18.087

这是因为您有两个同名的列（在两个不同的表中）。您需要使用这样的别名：

```
$query = "SELECT m.id AS mId, v.nom, v.id AS vId FROM machine m, version v WHERE m.id_version = v.id;"; 
```

然后，您将能够检索`m.id`具有名称`mId`和`v.id`名称的列您可以在[此处](http://beginner-sql-tutorial.com/sql-aliases.htm)`vId` 找到有关 SQL 中别名的更多信息

它与[pg_fetch_row()](http://www.php.net/manual/en/function.pg-fetch-row.php)一起使用的原因是因为它根据查询中列的索引返回结果，而不是作为关联数组。

# matlab - 如何在不使用“accumarray”命令的情况下对与另一列的唯一值相对应的列的特定值求和？

> ID：14714822
> 
> 赞同：1
> 
> 时间：2013-02-05T18:57:27.757
> 
> 标签：matlab

我在matlab中有一个矩阵：

```
a=[1 1; 1 2; 1 3; 2 1; 2 5; 2 7; 3 2; 3 1; 3 4]; 
```

如果

```
a1=[1 1 1 2 2 2 3 3 3]; is the first column 
```

和

```
a2=[1 2 3 1 5 7 2 1 4]; is the second column 
```

对于这个矩阵，我希望 a1 的重复值“unique(a1)”对 a2 的相应值求和，从而得到：

```
a3=[1+2+3 1+5+7 2+1+4]=[6 13 7] 
```

但不使用“accumarray”命令有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:42:18.757

我的[整合](http://www.mathworks.com/matlabcentral/fileexchange/8354-consolidator)器工具会为您执行此操作，甚至提供容差。

```
[a1cons,a2cons] = consolidator(a1',a2',@sum)
a1cons =
     1
     2
     3

a2cons =
     6
    13
     7 
```

# svg - 自定义 SVG 光标不会单击下面的元素

> ID：14714823
> 
> 赞同：0
> 
> 时间：2013-02-05T18:57:31.343
> 
> 标签：svg, html5-canvas, raphael, game-physics

我正在尝试使用 Raphaël.js 制作一个简单的游戏，我在开发的早期就遇到了一个问题，我通过在光标位置附加一个圆圈来瞄准目标，但是当我单击目标时它没有触发目标点击事件，但目标。

```
background.mousemove(function(e){
    ePointer.attr({
        'fill':'none',
        'stroke':'none'
    }); 

    nx = e.clientX - $('#canvas').offset().left;
    ny = e.clientY - $('#canvas').offset().top;

    pointer.attr({
        'fill':'none',
        'stroke':'#CC0000',
        'stroke-width': 3,
        'cx':nx,
        'cy':ny
    });

});
background.click(function(e){
    pointer.animate(bClick);
    pointer.animate(bUnclick.delay(250));
    pointer.animate(bUnclick);
});

enemies.mousemove(function(e){
    pointer.attr({
        'fill':'none',
        'stroke':'none'
    });
    nx = e.clientX - $('#canvas').offset().left;
    ny = e.clientY - $('#canvas').offset().top;
    ePointer.attr({
        'cx':nx,
        'cy':ny,
        'fill': '#00CC00',
        'stroke':'none'
    });
}); 
```

jsfiddle 链接会比我说的更多：http: [//jsfiddle.net/Uuqgx/6/](http://jsfiddle.net/Uuqgx/6/)

提前感谢，乔瓦尼。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:48:47.410

Raphael 的纸对象有一个名为[Paper.getElementByPoint(x, y)](http://raphaeljs.com/reference.html#Paper.getElementByPoint)的方法，该方法获取鼠标下方的顶部对象。当然，仅此一项并不能帮助您，因为圆圈仍在鼠标下方。但是，如果你隐藏它，输入当前鼠标坐标运行这个方法，然后取消隐藏圆圈，你会得到它下面的矩形，没有任何可见的中断：

```
ePointer.click(function(e){
    score++
    tScore.attr({
        'text': 'Score: ' + score 
    });
    nx = e.clientX - document.getElementById('canvas').offsetLeft;
    ny = e.clientY - document.getElementById('canvas').offsetTop;

    //get targeted rectangle
    this.hide();    
    console.log(paper.getElementByPoint(nx, ny));
    this.show();

    ePointer.animate(eClick);
    ePointer.animate(eUnclick.delay(150));
    ePointer.animate(eUnclick);
}); 
```

在这里，我刚刚将目标矩形记录到控制台，但是一旦你找到它，你就可以对它做任何你想做的事情。

请注意，offset().Top 变为 offsetTop 以便在 jsFiddle 中工作，因为 jQuery 不存在于 fiddle 中。

[更新了小提琴](http://jsfiddle.net/Uuqgx/7/)。

# c# - 如何将值 aspx 文件传递 给 class.cs 文件

> ID：14714832
> 
> 赞同：-2
> 
> 时间：2013-02-05T18:58:02.960
> 
> 标签：c#, asp.net

我们可以使用会话、查询字符串等将值从 aspx 传递到 aspx 文件。但是我想将值从 aspx 传递到 class.cs 文件。在 class.cs 文件中，我想获取该值。如何获得价值。有谁能够帮助我。预先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:23:55.390

在 aspx.cs 中

```
 decimal Total=textbox1.Text+textbox2.Text 
```

在班上

```
class sample
{
 Public void Display(decimal total)
 {
 }
 } 
```

将总计传递给类方法，将其写在 aspx.cs 文件中的第一条语句之后

```
 new sample().Display(Total) 
```

# web-services - 配置 Glassfish 3.1.2 服务器以允许 PUT、DELETE

> ID：14714846
> 
> 赞同：0
> 
> 时间：2013-02-05T18:58:36.283
> 
> 标签：web-services, configuration, glassfish-3, restful-authentication

我在配置 Glassfish 3.1.2 服务器以允许对使用 Netbeans“从数据库创建新的 RESTful webservice”向导创建的 RESTful webservice 的 PUT、DELETE 请求时遇到问题。奇怪的是，我设法让一个 web 服务正常工作，而其他网络服务却没有。谁能阐明我在哪里/如何配置它？

```
HTTP/1.1 405 Method Not Allowed
X-Powered-By: Servlet/3.0 JSP/2.2 (GlassFish Server Open Source Edition 3.1.2.2 Java/Oracle Corporation/1.7)
Server: GlassFish Server Open Source Edition 3.1.2.2
Allow: GET,DELETE,OPTIONS,HEAD
Content-Type: text/html
Content-Length: 1153
Date: Tue, 05 Feb 2013 18:35:05 GMT 
```

有效的请求标头如下：

```
Accept:application/json, text/javascript, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-GB,en-US;q=0.8,en;q=0.6
Connection:keep-alive
Content-Length:133
Content-Type:application/json
Cookie:JSESSIONID=b8ec1fb7ae9de4b5536363f4041d; JSESSIONID=b80bb2fbf45363cfe1b61b625890; treeForm_tree-hi=treeForm:tree:configurations:server-config:networkConfig:networkListeners:http-listener-2
Host:localhost:8080
Origin:http://localhost:8080
Referer:http://localhost:8080/mtpStories/faces/index.jsp
User-Agent:Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko)    Chrome/24.0.1312.57 Safari/537.17
X-Requested-With:XMLHttpRequest 
```

这是失败的请求（不同的网络服务）：

```
Accept:application/json, text/javascript, */*; q=0.01
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-GB,en-US;q=0.8,en;q=0.6
Connection:keep-alive
Content-Length:88
Content-Type:application/json
Cookie:JSESSIONID=ba3ad55776f2c7ea35f6dcbe56d2; JSESSIONID=b9fe5da81c67a083beb2001a6dbf; treeForm_tree-hi=treeForm:tree:configurations:default-config:httpService:httpListeners:http-listener-2
Host:localhost:8080
Origin:http://localhost:8080
Referer:http://localhost:8080/mtpUsers/faces/index_users.jsp
User-Agent:Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko)    Chrome/24.0.1312.57 Safari/537.17
X-Requested-With:XMLHttpRequest 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:49:31.830

看看你的 web.xml。任何**<security-constraint>**定义？例如

```
 <security-constraint>
        ...
        <web-resource-collection>
            <web-resource-name>test</web-resource-name>
            <description/>
            <url-pattern>/mtpStories/*</url-pattern>
            <http-method>GET</http-method>
            <http-method>DELETE</http-method>
            <http-method>OPTIONS</http-method>
            <http-method>HEAD</http-method>
        </web-resource-collection>
        ....
   </security-constraint> 
```

# java - 原始数组写入的 Java 并发可见性

> ID：14714847
> 
> 赞同：15
> 
> 时间：2013-02-05T18:58:40.493
> 
> 标签：java, concurrency, memory-barriers, java-memory-model

我最近在我的代码库中发现了这个 gem：

```
/** This class is used to "publish" changes to a non-volatile variable.
 *
 * Access to non-volatile and volatile variables cannot be reordered,
 * so if you make changes to a non-volatile variable before calling publish,
 * they are guaranteed to be visible to a thread which calls syncChanges
 *
 */
private static class Publisher {
    //This variable may not look like it's doing anything, but it really is.
    //See the documentaion for this class.
    private volatile AtomicInteger sync = new AtomicInteger(0);

    void publish() {
        sync.incrementAndGet();
    }

    /**
     *
     * @return the return value of this function has no meaning.
     * You should not make *any* assumptions about it.
     */
    int syncChanges() {
        return sync.get();
    }
} 
```

这是这样使用的：

线程 1

```
float[][] matrix;
matrix[x][y] = n;
publisher.publish(); 
```

线程 2

```
publisher.syncChanges();
myVar = matrix[x][y]; 
```

线程 1 是一个持续运行的后台更新线程。线程 2 是一个 HTTP 工作线程，它不关心它读取的内容是否一致或原子，只关心写入“最终”到达那里并且不会丢失作为并发神灵的祭品。

现在，这触发了我所有的警钟。自定义并发算法编写在不相关代码的深处。

不幸的是，修复代码并非易事。Java 对并发原始矩阵的支持不好。看起来解决此问题的最清晰方法是使用 a `ReadWriteLock`，但这可能会对性能产生负面影响。显然，正确性更重要，但似乎我应该在将其从性能敏感区域中剥离出来之前证明这是*不正确的。*

根据[java.util.concurrent 文档](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/package-summary.html#MemoryVisibility)，以下创建`happens-before`关系：

> 线程中的每个动作都发生在该线程中的每个动作之前，这些动作按程序的顺序出现在后面。
> 
> 对 volatile 字段的写入发生在对同一字段的每次后续读取之前。volatile 字段的写入和读取具有与进入和退出监视器类似的内存一致性效果，但不需要互斥锁定。

所以听起来像：

*   矩阵写入发生在发布之前（）（规则 1）
*   publish() 发生在 syncChanges() 之前（规则 2）
*   syncChanges() 发生在矩阵读取之前（规则 1）

所以代码确实已经为矩阵建立了一个happens-before链。

但我不相信。并发很难，而且我不是领域专家。我错过了什么？这真的安全吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:22:31.473

就可见性而言，您只需要在任何易失性字段上进行易失性读写操作。这会起作用

```
final    float[][] matrix  = ...;
volatile float[][] matrixV = matrix; 
```

线程 1

```
matrix[x][y] = n;
matrixV = matrix; // volatile write 
```

线程 2

```
float[][] m = matrixV;  // volatile read
myVar = m[x][y];

or simply
myVar = matrixV[x][y]; 
```

但这仅适用于更新一个变量。如果写入线程正在写入多个变量，而读取线程正在读取它们，则读取器可能会看到不一致的画面。通常它由读写锁处理。Copy-on-write 可能适用于某些使用模式。

Doug Lea 为 Java8 提供了一个新的“StampedLock” [http://gee.cs.oswego.edu/dl/jsr166/dist/jsr166edocs/jsr166e/StampedLock.html](http://gee.cs.oswego.edu/dl/jsr166/dist/jsr166edocs/jsr166e/StampedLock.html)，这是一个读写锁的版本，读起来要便宜得多锁。但它也更难使用。基本上读者得到当前版本，然后继续读取一堆变量，然后再次检查版本；如果版本没有更改，则在读取会话期间没有并发写入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T19:53:29.767

这对于向矩阵发布单个更新看起来确实是安全的，但当然它不提供任何原子性。这是否可行取决于您的应用程序，但它可能应该记录在这样的实用程序类中。

但是，它包含一些冗余，可以通过制作`sync`字段来改进`final`。该`volatile`字段的访问是两个内存屏障中的第一个；按照约定，调用`incrementAndGet()`对内存的影响与对 volatile 变量的写入和读取具有相同的效果，而调用`get()`与读取具有相同的效果。

所以，代码可以单独依赖这些方法提供的同步，自己制作字段`final`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:29:05.843

使用`volatile`并不是同步一切的灵丹妙药。可以保证，如果另一个线程读取 volatile 变量的更新值，他们也会看到在此之前对非 volatile 变量所做的每一次更改。但**没有什么能保证其他线程会读取更新的值**。

在示例代码中，如果您多次写入`matrix`然后调用`publish()`，而另一个线程调用`synch()`然后读取矩阵，则另一个线程可能会看到一些、全部或没有更改：

*   所有更改，如果它从 publish() 读取更新的值
*   没有任何更改，如果它读取旧的发布值并且没有任何更改泄漏
*   一些变化，如果它读取之前发布的值，但是一些变化已经通过

看[这篇文章](http://jeremymanson.blogspot.com/2008/11/what-volatile-means-in-java.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T06:52:51.250

您正确地提到了发生在关系之前的规则#2

> 对 volatile 字段的写入发生在对同一字段的每次后续读取之前。

但是，它不能保证在绝对时间轴上的 syncChanges() 之前会调用 publish()。让我们稍微改变一下你的例子。

*线程 1：*

```
matrix[0][0] = 42.0f;
Thread.sleep(1000*1000); // assume the thread was preempted here
publisher.publish(); //assume initial state of sync is 0 
```

*线程 2：*

```
int a = publisher.syncChanges();
float b = matrix[0][0]; 
```

a 和 b 变量有哪些可用选项？

*   a 为 0，b 可以是 0 或 42
*   a 是 1，b 是 42，因为之前发生的关系
*   a 大于 1（线程 2 由于某种原因很慢，线程 1 很幸运地多次发布更新）， b 的值取决于业务逻辑和矩阵的处理方式 - 它是否取决于先前的状态？

如何处理？这取决于业务逻辑。

*   如果线程 2 不时轮询矩阵的状态，并且在两者之间有一些过时的值是完全可以的，如果最终将处理正确的值，则保持原样。
*   如果线程 2 不关心错过的更新，但它总是想观察最新的矩阵，那么使用写时复制集合或使用上面提到的 ReaderWriteLock。
*   如果线程 2 确实关心单个更新，那么它应该以更智能的方式处理，您可能需要考虑 wait() / notify() 模式并在矩阵更新时通知线程 2。

# php - 在 Laravel 4 中使用命名空间

> ID：14714848
> 
> 赞同：45
> 
> 时间：2013-02-05T18:58:46.877
> 
> 标签：php, namespaces, laravel, laravel-4

我是 Laravel 的新手，通常使用 PHP 命名空间。在我决定制作一个名为 File 的模型之前，我没有遇到任何问题。我将如何正确地进行命名空间以便我可以使用我的 File 模型类？

文件是`app/controllers/FilesController.php`和`app/models/File.php`。我正在尝试制作一个新`File`的`FilesController.php`.

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-02-06T22:01:31.090

一旦你掌握了它的窍门，命名空间就很容易了。

举个例子：

*应用程序/模型/File.php*

```
namespace App\Models;

class File {

    public function someMethodThatGetsFiles()
    {

    }
} 
```

*应用程序/控制器/FileController.php*

```
namespace App\Controllers;

use App\Models\File;

class FileController {

    public function someMethod()
    {

        $file = new File();
    }
} 
```

**声明命名空间：**

```
namespace App\Controllers; 
```

请记住，一旦您将一个类放入命名空间以访问任何 PHP 的内置类，您需要从根命名空间调用它们。eg: `$stdClass = new stdClass();`will become `$stdClass = new \stdClass();`(see the `\`)

**“导入”其他命名空间：**

```
use App\Models\File; 
```

这允许您使用`File`没有命名空间前缀的类。

或者，您可以致电：

```
$file = new App\Models\File(); 
```

但是最好将它放在`use`语句的顶部，因为这样您就可以查看所有文件的依赖项，而无需扫描代码。

完成后，您需要运行它们`composer dump-autoload`以更新 Composer 的自动加载功能，以考虑您新添加的类。

请记住，如果您想通过 URL 访问 FileController，那么您需要定义一个路由并指定完整的命名空间，如下所示：

```
Route::get('file', 'App\\Controllers\\FileController@someMethod'); 
```

这会将所有 GET /file 请求定向到控制器的`someMethod()`

[查看有关命名空间](http://uk3.php.net/manual/en/language.namespaces.php)的 PHP 文档， Nettut始终是本文的一个很好的[资源](http://net.tutsplus.com/tutorials/php/namespacing-in-php-2/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T23:01:04.633

首先，加载你的类：

```
$ composer dump-autoload 
```

然后

```
$file = new File;

// your stuff like:
$file->name = 'thename';
$file->active = true;

$file->save(); 
```

[部分：Laravel 4 Eloquent 文档上的插入、更新、删除](http://four.laravel.com/docs/eloquent)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T12:37:16.100

要命名您的模型，请在打开后立即在模型类的顶部

然后，当您从控制器调用时，您将调用 new What\Model;

您可能必须第一次使用 composer 进行转储自动加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-28T06:58:55.470

看看它..希望能清除您的查询....

```
<?php

 namespace app\controllers;
 use yii\web\Controller;
 use app\models\users;
  class UserController extends Controller{
 public function actionIndex()
 {
echo "working on .....";
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-21T00:01:44.003

命名空间定义在 PHP 类的顶部，紧跟在打开的 php 脚本标记之后，如下所示：

```
 <?php
   namespace MyNameSpace; 
```

当你想在其他类中使用命名空间类时，你可以这样定义它：

```
new MyNameSpace\PhpClass; 
```

或将其导入文件顶部（如果存在命名空间），如下所示：

```
 <?php

   //namespace

   use MyNameSpace\MyPHPClass;

   //then later on the code you can instantiate the class normally
   $myphpclass = new MyPHPClass(); 
```

在 Laravel 中，可以在 composer 可以自动加载它们的任何地方定义命名空间，我建议在 app 目录中定义命名空间。因此，您可以通过在 app 目录中创建 Utils 目录、创建实用程序类并像上面那样定义命名空间来定义像 Utils 这样的命名空间来保存实用程序类。

之后，您运行命令要求作曲家自动加载类：

```
 $ composer dump-autoload 
```

# mysql - 我是否需要 GROUP BY 中的此字段不显示重复行

> ID：14714849
> 
> 赞同：2
> 
> 时间：2013-02-05T18:58:49.483
> 
> 标签：mysql, sql, database

我正在下面创建一个查询，它根据用户在搜索栏中输入的术语检索数据。现在我要做的是不显示重复数据，所以如果有 2 行所有字段都完全相同，那么它就是重复行，所以它只显示一次而不是多次。现在我认为它似乎这样做了，因为我没有看到重复的行，但我所做的只是对除 Answer 字段之外的所有 SELECT 字段进行 GROUP BY，因为它不允许我在 GROUP BY 子句中使用组连接。

但我的问题是，我是否需要 GROUP Y 子句中的该字段不显示重复的行，或者它真的不需要？

```
SELECT
      q.QuestionContent, 
      o.OptionType, 
      q.NoofAnswers, 
      GROUP_CONCAT(DISTINCT Answer ORDER BY Answer SEPARATOR ',') AS Answer, 
      r.ReplyType, 
      q.QuestionMarks
    FROM Question q
    LEFT JOIN Answer an
      ON q.QuestionId = an.QuestionId
    LEFT JOIN Reply r 
      ON q.ReplyId = r.ReplyId 
    LEFT JOIN Option_Table o 
      ON q.OptionId = o.OptionId 
    WHERE ".implode(" AND ", array_fill(0, $numTerms, "q.QuestionContent LIKE ?"))."
    GROUP BY   q.QuestionContent, 
      o.OptionType, 
      q.NoofAnswers, 
      r.ReplyType, 
      q.QuestionMarks
    ORDER BY ".implode(", ", array_fill(0, $numTerms, "IF(q.QuestionContent LIKE ?, 1, 0) DESC"))." 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T18:59:43.607

我认为[`DISTINCT`](http://www.mysqlfaqs.net/mysql-faqs/SQL-Statements/Select-Statement/How-does-DISTINCT-work-in-MySQL)可能会更好/更简单：

```
SELECT
  DISTINCT q.QuestionContent, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:02:00.193

不，您不需要`group_concat()`. `select`这`group by`将确保任何特定的值组合将在`group by`. 因为这些保证是不同的，所以您不必担心任何其他列。

这`group_concat()`是一个基于摘要的计算列。您不得在`group by`语句中包含此类列。如果要再次聚合它们，则需要使用子查询。

# scala - 从 Lift rest 会话中使用 Lift web 会话

> ID：14714850
> 
> 赞同：0
> 
> 时间：2013-02-05T18:58:57.197
> 
> 标签：scala, lift

我有一个 Lift web 应用程序，我想在其中提供一个 csv 下载链接。csv 由 Lift rest 服务提供。

设置这个没问题。然而; 为了使它安全和顺利地工作，我需要使用已经建立的经过身份验证的 Web 会话。

这是我当前与其他休息服务的休息身份验证。我可以在下面的???中添加网络用户的任何角色；还是我完全错过了重点？

```
LiftRules.authentication = HttpBasicAuthentication("lift") {
  case (`webshopUser`, `webshopPwd`, _) =>
    userRoles(webshopRole :: Nil)
    true
  case (`mailingListUser`, `mailingListPwd`, _) =>
    userRoles(mailingListRole :: Nil)
    true
}

LiftRules.httpAuthProtectedResource.append {
  case Req("rest" :: "mailingLists" :: _, _, _) => Full(mailingListRole)
  case Req("rest" :: "mamberships" :: "year" :: _, _, _) => ???
  case Req("rest" :: "memberships" :: _, _, _) => Full(webshopRole)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:23:31.347

该角色只是一个允许您控制对资源的访问的任意权限。在您的应用程序中的某个地方，您已经定义`webshopRole`并`mailingListRole`作为实现[`net.liftweb.http.auth.Role`](http://main.scala-tools.org/mvnsites/liftweb-2.0/framework/scaladocs/index.html). 为了保护第二个请求，您需要决定是否：

1.  您只想授予对两个用户帐户之一的访问权限。然后，假设您要允许允许由 定义的帐户 `webshopUser`。在这种情况下，您将使用`Full(webshopRole)`.

2.  您希望两个用户都具有访问权限。在这种情况下，您将定义一个类似于定义方式的新角色`webshopRole`，在本例中 - 我们将其命名为`csvRole`。然后您将该角色添加到`HttpBasicAuthentication`规则中，例如：`userRoles(webshopRole :: csvRole :: Nil)`。在映射中，您将使用：`Full(csvRole)`

# php - 检测 javascript 内容中的 ajax 代码

> ID：14714854
> 
> 赞同：-2
> 
> 时间：2013-02-05T18:59:08.453
> 
> 标签：php, javascript, html, ajax, json

我们如何在 Web 服务器返回的 javascript 代码内容中检测到允许客户端 Web 进行 AJAX 调用的代码部分？换句话说，我想知道是否有现有的库可以将Web服务器返回的javascript代码中包含的URL返回给Web客户端。Web 服务器向 Web 客户端返回的 URL 将允许 Web 客户端对 Web 服务器进行 Ajax 调用。

这是一个 web 服务器返回给 web 客户端的 javascript 代码示例，有以下几行：

```
$.ajax({
        type: "POST",
        url: '/index.php?option=com_rechercheperso&view=recupeSecteur&format=raw',
        data: 'style='+value_style+'&type='+value_type,
        success: function(response){
        $('#secteur').html(response);}
    });
} 
```

问题是，有没有一个库可以让我们在分析javascript代码的内容时返回url（'/index.php?com_rechercheperso option = & view = & format = raw recupeSecteur'）。

谢谢您的回答

图菲克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:30:11.190

根据我假设的描述，服务器正在返回一个页面，其中有使用带有预定义 url 的 ajax 调用的脚本，并且您想要获取这些 url。

如果正确，您可以使用任何语言来调用加载脚本（php、perl 甚至 JS ajax）的页面，并使用正则表达式搜索 responseText 中的所有 url，然后尝试匹配的那些进行 ajax 调用针对服务器。

看起来像蛮力解决方案，但应该工作。

# c# - 在汇编中存储大量数据

> ID：14714857
> 
> 赞同：0
> 
> 时间：2013-02-05T18:59:17.853
> 
> 标签：c#

我正在尝试制作一个可以在多个程序中使用的程序集。大会包含大量国家和该国大量城镇。国家的数据不是什么大问题，因为我只计算了 249 个国家，但我也有大量的城镇数据。

例如，法国有近 50.000 个城镇。比利时有近2500个城镇。英国近 150.000 个城镇。...

我已经拥有了我需要的所有数据，但我的问题是。我不知道如何将数据存储在我的程序集中。- 我尝试了 XML，但加载 xml 会给我带来性能问题。加载数据需要很长时间。- 我尝试了一个 MS Access 数据库，但是当我尝试将数据保存在我的程序集中时，数据存储在我的程序集之外的数据库中。这意味着那不是我的解决方案。- 我尝试将数据直接加载到脚本中的数组中，但是我的 Visual Studio 整天都在加载，检查我输入的数据，但我不能再使用它了

任何人都可以给我一种在我的程序集中存储数据而不会出现这些性能问题的方法吗？

欢迎任何帮助。

我使用 C# 语言使用 Visual Studio 2010

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T15:41:56.443

如果您决定将其硬编码到一个程序集中，您可以沿着包含每个国家/地区的多个 Dll 的路线走下去。

如果您只需要访问 France 文件，您可以创建一个 France 类的实例，而不是整个世界。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T19:08:57.283

您可能想查看地理编码。我曾经使用过一个 dat 文件，其中包含一堆美国邮政编码和该信息。我确信其他地方也存在类似的事情。

你可能只是想看看谷歌地理编码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T19:15:25.060

将所有数据保存在程序集中并不是一个好主意。1\. 它使它变得非常大。2\. 更新困难。

如果您担心其他人在您的程序集之外看到数据库或 xml 文档中的信息，您应该研究一些基本的加密。

编辑： 1\. 拥有一个非常大的程序集将是一个糟糕的主意，因为必须将所有这些信息不必要地加载到内存中。这是假设程序每次运行时都不需要 100% 的信息。

# c - 如何省略字符串中的空格

> ID：14714860
> 
> 赞同：-2
> 
> 时间：2013-02-05T18:59:22.393
> 
> 标签：c, string, spaces

我需要编写一个程序来读取一个句子并输出句子中的单词数。我已经完成了程序，但问题是我的程序将单词之间的空格计算为字符。如何省略这些空格并仅显示字符串中的单词数？我在想我需要某种类型的循环，但我不知道如何执行它。

```
#include<stdlib.h>
#include<stdio.h>
#include<string.h>
#define pause system("pause")

main() {
char mystring[155];
int counter = 0;

printf("Enter your name: ");
scanf("%[^\t\n]", &mystring); 
printf("Your name is %s\n", mystring);

// find out the number of characters in the string
counter = strlen(mystring); 
printf("There are %i words in the sentence. \n", counter);

// find out how many WORDS are in the sentence. Omit spaces

pause;
} // end of main 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:51:34.083

你的函数看起来像这样：

```
_getNumberOfWords(char[] string) {
    int count = 0;
    for (int i=0; string[i] != '\0'; i++) {
        if (string[i] == " ") {
        for (int j=i; string[j] != '\0'; j++) {
            // This is to handle multiple spaces
            if (string[j] != " ") break;
        }
        count++;
    }
    return count;
} 
```

你也可以尝试做一个：

```
char * strtok ( char * string, const char * " " ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:30:33.780

同样，正如有人已经说过的，使用 strtok。如果您需要了解更多信息， [请访问 http://www.cplusplus.com/reference/cstring/strtok/](http://www.cplusplus.com/reference/cstring/strtok/)

如果您想在不使用任何现有 API 的情况下执行此操作（我不知道您为什么要这样做，除非它是一个类项目），然后创建一个带有指针的简单算法来遍历字符串并在递增计数时跳过空格。

正如人们之前所说，这对你来说将是一个很好的练习，所以不要要求代码。而且总是有谷歌..

# python - Python BaseHTTPServer 停止脚本的其余部分

> ID：14714865
> 
> 赞同：0
> 
> 时间：2013-02-05T18:59:44.450
> 
> 标签：python, python-2.7

我正在使用 BaseHTTPServer 来提供一个简单的变量，问题是之后的其余部分`server.serve_forever()`没有执行。
BaseHTTPServer 似乎没有分叉？
我怎样才能解决这个问题？

BaseHTTPServer 正在服务的变量（http 输出）由脚本的另一部分持续更新。

这是一个pastebin：[http://pastebin.com/v4xEuHBs](http://pastebin.com/v4xEuHBs)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:33:54.240

```
from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler
import SocketServer
import os

def main():
  try:
    startserver(self)

def startserver(self):
    newpid = os.fork()
    if newpid == 0:
        server = HTTPServer(('',8080), ThreadingHTTPServer)
        server.serve_forever()

class ThreadingHTTPServer(SocketServer.ThreadingMixIn,BaseHTTPRequestHandler):
        def do_GET(self):
            self.loop = loop
            self.send_response(200)
            self.send_header('Content-type','text/html')
            self.end_headers()
            self.wfile.write('hello, world')
            return 
```

# vim - 当我在 Vim 中关闭一个窗口时，如何更改光标移动到的窗口？

> ID：14714867
> 
> 赞同：0
> 
> 时间：2013-02-05T18:59:53.590
> 
> 标签：vim

我经常在 Vim 中同时打开几个窗口：一个是我的代码，一个是侧边栏，一个是底部打开的 quickfix 窗口。

每当我用 关闭底部窗口时`<C-W> C`，光标就会移动到侧边栏，就像它在左侧一样。

有没有办法让光标移动到右侧的主窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T07:53:23.180

您可以重新映射关闭命令以始终返回上一个窗口：

```
:nnoremap <C-w>c <C-w>c<C-w>p 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:26:29.297

你说底部窗口是quickfix。您不必将光标移动到该窗口，然后键入`C-W c`以将其关闭。您可以将光标留在主窗口（上一个）中，然后`:cclose`，快速修复窗口将关闭，并且您的光标停留在原来的位置。

`:h cclose`查看详细信息。如果经常使用，您也可以为此进行映射。

我不确定你是否会接受这个。

# c# - 树加载器扩展函数内部的异步函数调用

> ID：14714869
> 
> 赞同：0
> 
> 时间：2013-02-05T18:59:56.690
> 
> 标签：c#, asynchronous, callback, hierarchical-data

我有一个函数可以加载节点的子节点。它在内部调用 WCF 异步服务进行加载。签名如下。

```
public void AddChildElements(Node parentElement, 
                                    Action<IEnumerable<Node>> callback)
{

} 
```

这可以像这样使用

```
_nodeBuilder.AddChildElements(parentElement, (elements) =>
              {
                 //do something with elements 
              }); 
```

现在我想编写一个函数来根据某些条件扩展层次结构。所以我写了一个这样的扩展函数

```
public static T LoadHierarchyUntilItemFound<T>(
         this  IEnumerable<T> sequence, Func<T, List<T>> loadaction, 
         Func<T, string> searchstring)
{
  //...
} 
```

loadaction 参数期望节点的加载函数。用法如下

```
 Elements.LoadHierarchyUntilItemFound(LoadChildren,                               
                                   "root.UK.England.London"); 
```

问题是我将如何编写加载函数？

```
 private List<Node> LoadChildren(Node parent)
   {
           // _nodeBuilder.AddChildElements(parent, here it expects a callback 
                        //which gives the result, how to use this?); 
   } 
```

简而言之，问题是如何使用回调函数返回包装函数的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:15:04.390

If you really want it *is* possible to just make a function that calls the async method and blocks until it returns:

```
private List<Node> LoadChildren(Node parent)
{
    var tcs = new TaskCompletionSource<IEnumerable<Node>>();

    AddChildElements(parent, nodes => tcs.SetResult(nodes));

    return tcs.Task.Result.ToList();
} 
```

However, in many contexts it would be preferable to do this entire thing asynchronously, rather than synchronously.

```
public static async Task<T> LoadHierarchyUntilItemFoundAsync<T>(
    this  IEnumerable<T> sequence, Func<T, Task<IEnumerable<T>>> loadaction,
    Func<T, string> selector, string searchstring)
{
    var stack = new Stack<T>(sequence);
    while (stack.Any())
    {
        var item = stack.Pop();

        if (selector(item) == searchstring)
            return item;

        foreach (var child in await loadaction(item))
        {
            stack.Push(child);
        }
    }

    return default(T);
} 
```

Given a function like that you can call it using:

```
Elements.LoadHierarchyUntilItemFound(AddChildElements,                               
                               "root.UK.England.London"); 
```

# jquery - jquery .after() , .toggle() 函数在 div 点击

> ID：14714871
> 
> 赞同：0
> 
> 时间：2013-02-05T19:00:14.737
> 
> 标签：jquery

我在 div click 上添加新 div 时遇到问题。我编写了以下代码。我在单击 div 后创建新 div 并且第二次单击必须关闭新 div。当我单击 div 时，它会创建一个新 div 并在第二次单击关闭创建的 div 时。但它只在第一次单击 div 时起作用。我的代码如下。感谢您的回答:)

```
$(document).ready(function () {

   var NewContent = '<div class=""><input name="name" type="text" id="name" size="20" value="" style="height:20px; margin-top:10px; width:480px;margin-left:90px; font-size:14px;" /></div>'
   $('.comment-body').click(function () {

       var index2 = $('.comment-body').index(this);
       if (NewContent != '') {
           $('.comment-body').eq(index2).after(NewContent);
           NewContent = '';
       }
       else {
           $('.comment-body').eq(index2).next().toggle();

       }
   });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:26:10.340

看起来您的索引总是为零，因为唯一可用的 div 是默认 div。考虑重新措辞你的问题或发布评论小提琴，因为不清楚你在追求什么。特别是“当我单击 div 时，它会创建一个新的 div，然后在第二次单击关闭创建的 div 时。但它只在第一次单击 div 时起作用。我的代码如下”

# haskell - 使用箭头生成深度嵌套的记录

> ID：14714872
> 
> 赞同：2
> 
> 时间：2013-02-05T19:00:22.527
> 
> 标签：haskell, arrows

我有一个深度嵌套的记录，我正在尝试从数据库中重建它。例如，`A`包含许多`B`记录。`B`记录有很多`C`记录。`C`有很多`D`s。我有查询每种类型对象的子对象（`f0`、`f1`和`f2`以下）的函数。

```
f0 :: A -> [B]
f1 :: B -> [C]
f2 :: C -> [D] 
```

我正在寻找一种优雅的方式来实现`f3`.

```
f3 :: A -> (A, [(B, [(C, [D])])]) 
```

[我在Arrows](http://www.haskell.org/ghc/docs/latest/html/libraries/base//Control-Arrow.html)上读过一些东西，感觉它们可能很合适。但是，当我尝试将它们结合起来时，我总是遇到障碍。

我从这样的事情开始：

```
f4 :: A -> (A, [B])
f4 = id &&& f0 
```

这让我达到了第一级。但是，我无法找到一种方法将其链接到另一个箭头，该箭头将映射`[B]`、返回`[(B, [C])]`并将其用作原始元组的第二个元素。

我对 Haskell 有点陌生，所以如果我需要包含任何其他信息，请告诉我。

谢谢！

**更新**

稍微修改一下sclv的答案，我现在有了

```
data A = A
data B = B
data C = C
data D = D

f0 :: A -> [B]
f0 = undefined

f1 :: B -> [C]
f1  = undefined

f2 :: C -> [D]
f2 = undefined

pairFun f = id &&& f

foo :: A -> (A, [(B, [C])])
foo = fmap (map (pairFun f1)) . pairFun f0 
```

我仍然不知道如何组合最后一个函数（`f2`）。

**最终更新**

感谢 sclv，事实证明可以这样完成：

```
foo = (fmap . map) ((fmap . map) (pairFun f2) . pairFun f1) . pairFun f0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:20:02.467

像这样的东西应该可以工作（未经测试）：

```
pairFun f = id &&& f

foo = (fmap . map) ((fmap . map) (pairFun f2) . pairFun f1) . pairFun f0 
```

编辑：顺便说一下，考虑这个问题的一种方法是使用conal的语义编辑器组合器模型——http: [//conal.net/blog/posts/semantic-editor-combinators](http://conal.net/blog/posts/semantic-editor-combinators)

# c# - 我如何检测向下箭头键是否被按下了一段时间？

> ID：14714873
> 
> 赞同：0
> 
> 时间：2013-02-05T19:00:24.560
> 
> 标签：c#, wpf

我有一个不知道如何解决的问题...我有一个可能包含很多项目的列表框。

当用户选择一个项目时，我会进行异步调用并获取一些数据并填充屏幕。用户可以按向下箭头键或向上箭头键在项目之间导航，问题是当用户按住向下箭头键时，选择变化很快，我的应用程序遇到问题....有没有干净的方法检测到用户按住向下键一段时间，暂停更新视图，并仅在他释放后更新它？

如果我解释不清楚，我很抱歉，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T08:31:46.967

您是否尝试异步...

1.  ...更新填充列表框的集合，或者...
2.  ...根据列表框中当前选定的项目更新单独的视图？

我猜是#2，当你开始大量异步调用来更新单独的视图时，你会遇到问题。正如@Ramhound 指出的那样，通过按住按钮和快速点击相同的按钮（或者只是作为韩国育雏战职业玩家点击离开）来快速更改选择没有区别。要解决这两个问题，您可以执行以下操作：

1.  设置一个您在选择更改时重置的计时器。仅在超时后才启动异步查询。这将过滤掉*非常*快速的选择更改。**和**
2.  确保一次只有一个正在进行的查询，因此在开始新的异步调用之前，请取消并清理前一个。

这样用户可以对选择做任何事情，你仍然只有在她实际选择了一些东西后才更新。调整时间以确保 UI 仍然活泼 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:03:45.693

如果控件是可聚焦的，您可以覆盖 [UIElement.OnKeyDown](http://msdn.microsoft.com/en-us/library/system.windows.uielement.keydown.aspx)

所以在这种情况下，这实际上意味着创建列表框的子类，然后覆盖 OnKeyDown 函数。您可以通过这种方式捕捉到它，但这会使事情变得更加混乱。

或者您可以使用[Keyboard.GetKeyStates](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.getkeystates.aspx)查询键状态。

恕我直言，您应该只预加载数据。ListBoxes 使用[“虚拟化堆栈面板”](http://msdn.microsoft.com/en-us/library/system.windows.controls.virtualizingstackpanel.aspx)，它足够智能，不会显示不需要的信息。

# javascript - 每次点击都会弹出新窗口

> ID：14714875
> 
> 赞同：8
> 
> 时间：2013-02-05T19:00:25.097
> 
> 标签：javascript

我有一个弹出窗口，我正在使用下面的脚本打开它。在每次点击时，我都想打开新的弹出窗口。我了解，为窗口设置唯一名称将解决问题（在本例中为“SampleWindow”）。保持窗口唯一性的最佳方法是什么？有没有其他方法来管理 javascript 弹出窗口？

```
window.open(url, 'SampleWindow', 'WIDTH=300,HEIGHT=250'); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T19:18:06.427

**将值传递`_blank`给`name`参数会将传递的值加载`URL`到新窗口**中。像这样：

```
window.open(url, '_blank', 'width=300,height=250'); 
```

参数的其他选项`name`（*可选*）包括：

*   **`_blank`**- *URL 被加载到一个新窗口中。这是默认的*
*   **`_parent`**- *URL 被加载到父框架中*
*   **`_self`**- *URL 替换当前页面*
*   **`_top`**- *URL 替换任何可能加载的框架集*
*   **`name`**- *窗口的名称*

*请注意，如果您将此 JavaScript 传递给`A`IE 浏览器期望返回值的锚标记，否则它将引用`A`标记本身。您的代码如下所示：*

```
<a href="javascript:var w=window.open(url, '_blank', 'width=300,height=250');">test</a> 
```

*或更好（以避免在状态栏中向用户显示您的代码）：*

```
 <a href="javascript:void(0);" onclick="window.open(url, '_blank', 'width=300,height=250');">test</a> 
```

* * *

链接：

*   ***[窗口打开（）方法参考](http://www.w3schools.com/jsref/met_win_open.asp)***
*   ***[JSFiddle 演示](http://jsfiddle.net/8AuLJ/)***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:15:11.130

您可以将时间戳附加到您的窗口名称以创建真正唯一的窗口名称并将其分配给变量。作为...

`var myWindow = window.open(url, 'SampleWindow'+new Date().getTime(), 'WIDTH=300,HEIGHT=250');`

既然你想要的不仅仅是 windows，那么通过数组来管理 windows 会更好。

```
var myWindow = [];
myWindow.push(window.open(url, 'SampleWindow'+new Date().getTime(), 'WIDTH=300,HEIGHT=250')); 
```

这些窗口可以由`myWindow[index]`like管理`myWindow[2].close();`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:17:12.997

您可能每次都更改名称

```
var i = 0;
window.open(url, 'SampleWindow' + i, 'WIDTH=300,HEIGHT=250');
i++; 
```

# c++ - 检测到“RuntimeLibrary”不匹配

> ID：14714877
> 
> 赞同：144
> 
> 时间：2013-02-05T19:00:39.190
> 
> 标签：c++, hash, compilation, sha256, crypto++

我在 C:\cryptopp 中下载并提取了 Crypto++。我使用 Visual Studio Express 2012 构建了里面的所有项目（按照自述文件中的说明），一切都构建成功。然后我在其他文件夹中创建了一个测试项目，并添加了 cryptolib 作为依赖项。之后，我添加了包含路径，以便我可以轻松地包含所有标题。当我尝试编译时，我收到一个关于未解析符号的错误。

为了解决这个问题，我添加`C:\cryptopp\Win32\Output\Debug\cryptlib.lib`了链接其他依赖项。现在我得到这个错误：

```
Error   1   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(cryptlib.obj)    CryptoTest
Error   2   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(iterhash.obj)    CryptoTest
Error   3   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(sha.obj) CryptoTest
Error   4   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(pch.obj) CryptoTest
Error   5   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(misc.obj)    CryptoTest
Error   6   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(queue.obj)   CryptoTest
Error   7   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(algparam.obj)    CryptoTest
Error   8   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(filters.obj) CryptoTest
Error   9   error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(fips140.obj) CryptoTest
Error   10  error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(cpu.obj) CryptoTest
Error   11  error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in program.obj    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\cryptlib.lib(mqueue.obj)  CryptoTest 
```

我也得到：

```
Error   12  error LNK2005: "public: __thiscall std::_Container_base12::_Container_base12(void)" (??0_Container_base12@std@@QAE@XZ) already defined in cryptlib.lib(cryptlib.obj)    C:\Data\Work\C++ VS\CryptoTest\CryptoTest\msvcprtd.lib(MSVCP110D.dll)   CryptoTest
Error   13  error LNK2005: "public: __thiscall std::_Container_base12::~_Container_base12(void)" (??1_Container_base12@std@@QAE@XZ) already defined in cryptlib.lib(cryptlib.obj)   C:\Data\Work\C++ VS\CryptoTest\CryptoTest\msvcprtd.lib(MSVCP110D.dll)   CryptoTest
Error   14  error LNK2005: "public: void __thiscall std::_Container_base12::_Orphan_all(void)" (?_Orphan_all@_Container_base12@std@@QAEXXZ) already defined in cryptlib.lib(cryptlib.obj)   C:\Data\Work\C++ VS\CryptoTest\CryptoTest\msvcprtd.lib(MSVCP110D.dll)   CryptoTest
Error   15  error LNK2005: "public: __thiscall std::locale::id::id(unsigned int)" (??0id@locale@std@@QAE@I@Z) already defined in cryptlib.lib(iterhash.obj) C:\Data\Work\C++ VS\CryptoTest\CryptoTest\msvcprtd.lib(MSVCP110D.dll)   CryptoTest
Warning 16  warning LNK4098: defaultlib 'LIBCMTD' conflicts with use of other libs; use /NODEFAULTLIB:library   C:\Data\Work\C++ VS\CryptoTest\CryptoTest\LINK  CryptoTest
Error   17  error LNK1169: one or more multiply defined symbols found   C:\Data\Work\C++ VS\CryptoTest\Debug\CryptoTest.exe 1   1   CryptoTest 
```

我试图编译的代码很简单（我从另一个站点得到的）：

```
#include <iostream>
#include <string>
#include "sha.h"
#include "hex.h"
using namespace std;

string SHA256(string data) {
    byte const* pbData = (byte*) data.data();
    unsigned int nDataLen = data.size();
    byte abDigest[32];

    CryptoPP::SHA256().CalculateDigest(abDigest, pbData, nDataLen);

    return string((char*)abDigest);
}

int main(void) {

    return 0;
} 
```

任何想法如何解决这一问题？我现在真的只需要 SHA-256，没有别的。我用的是Windows 7 64位，今天下载了VS C++，应该是最新版本。

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2013-09-05T12:00:09.600

（这已经在评论中得到了回答，但由于它缺乏实际的*答案*，我正在写这个。）

这个问题出现在新版本的 Visual C++ 中（旧版本通常只是默默地链接程序，它会在运行时崩溃和烧毁。）这意味着您正在与程序链接的一些库（甚至是一些源程序本身内的文件）正在*使用不同版本的 CRT（C 运行时库。）*

要更正此错误，您需要进入您的`Project Properties`（和/或您正在使用的库），然后进入`C/C++`，然后`Code Generation`检查 ; 的值`Runtime Library`。对于您链接在一起的*所有*文件和库，这应该完全相同。（与 DLL 链接的规则稍微宽松一些，但我不打算在这里讨论“为什么”和更多细节。）

此设置目前有四个选项：

1.  多线程调试
2.  多线程调试 DLL
3.  多线程发布
4.  多线程发布 DLL

您的特定问题似乎源于您将使用“多线程调试”（即静态多线程调试 CRT）构建的库与使用“多线程调试*DLL* ”设置（即动态多线程调试 CRT）构建的程序链接。您应该更改这个设置要么在库中，要么在你的程序中。现在，我建议在你的程序中改变它。

请注意，由于 Visual Studio 项目对调试和发布版本（以及 32/64 位版本）使用不同的项目设置集，因此您应该确保所有这些项目配置中的设置匹配。

有关（一些）更多信息，您可以查看这些（从上面的评论链接）：

1.  MSDN 上的[链接器工具警告 LNK4098](http://msdn.microsoft.com/en-us/library/6wtdswk0%28v=vs.110%29.aspx)
2.  MSDN 上[的 /MD、/ML、/MT、/LD（使用运行时库）](http://msdn.microsoft.com/en-us/library/2kzt1wy3%28v=vs.110%29.aspx)
3.  [使用 VC11 Beta 构建错误 - 将 MTd 库与 MDd exe 混合无法链接](https://bugzilla.mozilla.org/show_bug.cgi?id=732124)到 Bugzilla@Mozilla

**更新**：（这是对评论的回应，该评论询问了为什么必须如此小心。）

如果我们链接在一起的两段代码本身链接并使用标准库，那么它们的标准库必须相同，除非*非常*注意我们的两个代码段如何交互和传递数据。一般来说，我会说，对于几乎所有情况，只需使用完全相同版本的标准库运行时（关于调试/发布、线程，显然是 Visual C++ 的版本，以及迭代器调试等）

问题的最重要部分是：*对函数调用两侧的对象大小有相同的想法*。

例如，考虑上述两段代码被称为`A`和`B`。A 是针对标准库的一个版本*编译*的，而 B 是针对另一个版本的。在 A 看来，标准函数返回给它的一些随机对象（例如内存块或迭代器或`FILE`对象或其他）具有特定的大小和布局（请记住，结构布局在 C/C/ C++。）出于多种原因，B 对相同对象的大小/布局的想法是不同的（这可能是因为额外的调试信息、数据结构随时间的自然演变等）

现在，如果 A 调用标准库并取回一个对象，然后将该对象传递给 B，并且 B 以任何方式接触该对象，则 B 很可能会弄乱该对象（例如，写入错误的字段，或超过结尾等等）

以上不是唯一可能发生的问题。标准库中的内部全局或静态对象也可能导致问题。还有更多晦涩难懂的问题。

当使用 DLL（动态运行时库）而不是 libs（静态运行时库）时，这一切在某些方面变得更加奇怪。

这种情况可以适用于两个协同工作的代码使用的任何库，但是标准库被大多数（如果不是几乎所有）程序使用，这增加了冲突的机会。

如果您混合库版本，我所描述的显然是等待您的实际混乱的淡化和简化版本。我希望它能让您了解为什么不应该这样做！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-07-22T19:03:34.207

我遇到了这个问题以及 ITERATOR_DEBUG_LEVEL 中的不匹配。作为一个周日晚上的问题，毕竟看起来还不错，很好，我被放了一段时间。在 de VS2017 IDE（解决方案资源管理器）中工作我最近从另一个项目添加/复制了对我的项目（ctrl-drag）的源文件引用。查看属性 - > C/C++/预处理器 -**在源文件级别，而不是项目级别**- 我注意到在发布配置中指定了 _DEBUG 而不是 NDEBUG 用于此源文件。这就是摆脱问题所需的所有改变。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-10-24T02:06:51.053

> 我在 C:\cryptopp 中下载并提取了 Crypto++。我使用 Visual Studio Express 2012 构建了里面的所有项目（按照自述文件中的说明），一切都构建成功。然后我在其他文件夹中创建了一个测试项目，并添加了 cryptolib 作为依赖项。

转换可能不成功。唯一成功的是 VCUpgrade 的运行。实际的转换本身失败了，但在您遇到所看到的错误之前您不知道。有关一些详细信息，请参阅Crypto++ wiki 上的[Visual Studio 。](http://cryptopp.com/wiki/Visual_Studio)

* * *

> 任何想法如何解决这一问题？

要解决您的问题，[`vs2010.zip`](http://cryptopp.com/wiki/Visual_Studio#Downloads)如果您想要静态 C/C++ 运行时链接（`/MT`或`/MTd`），或者[`vs2010-dynamic.zip`](http://cryptopp.com/wiki/Visual_Studio#Downloads)如果您想要动态 C/C++ 运行时链接（`/MT`或`/MTd`），您应该下载。两者都修复了 VCUpgrade 产生的潜在的、无声的故障。

* * *

[`vs2010.zip`](http://cryptopp.com/wiki/Visual_Studio#Downloads)，[`vs2010-dynamic.zip`](http://cryptopp.com/wiki/Visual_Studio#Downloads)并且[`vs2005-dynamic.zip`](http://cryptopp.com/wiki/Visual_Studio#Downloads)是从[最新的 GitHub 源](http://github.com/weidai11/cryptopp)构建的。在撰写本文时（2016 年 6 月 1 日），这实际上是 Crypto++ 5.6.4 之前的版本。如果您使用较低级别的 Crypto++（如 5.6.2 或 5.6.3）的 ZIP 文件，那么您会遇到一些小问题。

我知道有两个小问题。首先是[`bench.cpp`to`bench1.cpp`](http://groups.google.com/d/msg/cryptopp-users/Inz3uhNxd4g/Y6VJPUg4EQAJ)的重命名。它的错误是：

*   `C1083: Cannot open source file: 'bench1.cpp': No such file or directory`
*   `LNK2001: unresolved external symbol "void __cdecl OutputResultOperations(char const *,char const *,bool,unsigned long,double)" (?OutputResultOperations@@YAXPBD0_NKN@Z)`

解决方法是 (1)`cryptest.vcxproj`在记事本中打开，找到`bench1.cpp`，然后将其重命名为`bench.cpp`. 或 (2) 在文件系统上重命名`bench.cpp`为`bench1.cpp`。请不要删除此文件。

第二个问题有点棘手，因为它是一个移动的目标。下级版本，如 5.6.2 或 5.6.3，缺少[GitHub](http://github.com/weidai11/cryptopp)中可用的最新类。缺失的类文件包括HKDF（5.6.3）、RDRAND（5.6.3）、RDSEED（5.6.3）、ChaCha（5.6.4）、BLAKE2（5.6.4）、Poly1305（5.6.4）等。

修复方法是从 Visual Studio 项目文件中删除缺少的源文件，因为它们对于下级版本不存在。

另一种选择是从最新来源添加缺少的类文件，但可能会出现复杂情况。例如，许多来源巧妙地依赖于最新的`config.h`,`cpu.h`和`cpu.cpp`. “微妙”是你不会意识到你正在上一个表现不佳的课程。

表现不佳的一个例子是 BLAKE2。`config.h`添加编译时 ARM-32 和 ARM-64 检测。`cpu.h`并`cpu.cpp`添加了运行时 ARM 指令检测，这取决于编译时检测。如果您在没有其他文件的情况下添加 BLAKE2，则不会发生任何检测，您将获得直接的 C/C++ 实现。您可能不会意识到您错过了 NEON 机会，它每字节运行大约 9 到 12 个周期，而普通 C/C++ 大约每字节 40 个周期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-20T09:30:50.430

可以通过在链接器库中添加 msvcrtd.lib 的 CRT 来解决问题。因为 cryptlib.lib 使用了 CRT 版本的调试。

# php - 使用 array_splice 时形成的非格式良好的数值

> ID：14714878
> 
> 赞同：0
> 
> 时间：2013-02-05T19:00:49.033
> 
> 标签：php, arrays, pagination, array-splice

我在 PHP 中使用 array_slice，如下所示：

```
if (isset($_GET['page']) && !isset($no_pagination)) {
        $page_num = mysql_real_escape_string($_GET['page']);
        $limit_value_from = $page_num * 10;
        $limit_value_to = $limit_value_from + 10;
        $limit_query = $limit_value_from.", ".$limit_value_to;
    }

if (!isset($no_pagination) && isset($limit_query)) {
        $usernames_new = array_splice($usernames, $limit_query);
        $usernames = $usernames_new;
    } 
```

当我运行脚本时，它给了我这个错误：遇到格式不正确的数值。当我回显 $limit_query 字符串时，它会为我提供正确的 0、10 10、20 20、30 值，如果我在函数中手动输入 0、10 10、20 等，它可以正常工作。即使格式正确，为什么会发生此错误？

注意：当我在数组拼接线之前放置@符号时，代码工作正常......只是想知道为什么会发生这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:30:09.970

您看起来为该方法传递了错误的参数。第二个参数是一个 INT。

```
array array_slice ( array $array , int $offset [, int $length = NULL [, bool $preserve_keys = false ]] ) 
```

尝试这个：

```
$usernames_new = array_splice($usernames, $limit_value_from, $limit_value_to); 
```

# dart - 你如何确保 Callback.dispose 被调用？

> ID：14714879
> 
> 赞同：3
> 
> 时间：2013-02-05T19:00:51.740
> 
> 标签：dart

我正在查看 js-interop 库（[http://www.dartlang.org/articles/js-dart-interop/](http://www.dartlang.org/articles/js-dart-interop/)）和（[http://dart-lang.github.com/js-interop/docs/ js/回调.html](http://dart-lang.github.com/js-interop/docs/js/Callback.html) )。我想使用`new Callback.many`. 它说我必须确保调用，`dispose()`否则我可能会出现内存泄漏。确保`dispose()`在我的页面卸载时被调用的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:39:38.930

当您的页面被卸载时，您实际上并不需要显式地处理[回调。](http://dart-lang.github.com/js-interop/docs/js/Callback.html)浏览器应该将它们作为页面中使用的其他 javascript 变量进行清理。

当您知道将不再使用[回调](http://dart-lang.github.com/js-interop/docs/js/Callback.html)时，应该使用[dispose() 。](http://dart-lang.github.com/js-interop/docs/js/Callback.html#dispose)这就像删除对未使用对象的引用以允许对其进行垃圾收集。

从技术上讲，所有回调都在 Map 中引用，以允许 js 和 dart 之间进行通信。因此，即使您的代码不保留回调的引用，它也不会被垃圾收集。调用`dispose()`将删除该引用并使回调免费被垃圾收集。

# python - 使用 cv.fromarray 在 Python 中将转置的 NumPy 数组转换为 CvMat 类型

> ID：14714881
> 
> 赞同：3
> 
> 时间：2013-02-05T19:00:54.503
> 
> 标签：python, opencv, numpy

我有一个问题，一些 numpy 数组不使用 cv.fromarray() 转换为 cvMat。每当转置 numpy 数组时，似乎就会出现问题。

```
import numpy as np
import cv

# This works fine:
b = np.arange(6).reshape(2,3).astype('float32')
B = cv.fromarray(b)
print(cv.GetSize(B))

# But this produces an error:
a = np.arange(6).reshape(3,2).astype('float32')
b = a.T
B = cv.fromarray(b)
print(cv.GetSize(B))

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "test_err.py", line 17, in <module>
    B = cv.fromarray(b)
TypeError: cv.fromarray array can only accept arrays with contiguous data 
```

有什么建议么？我的许多数组都在某个时候被转置了，所以错误经常出现。

我在 MacOS X Lion 上使用 Python2.7，并从 MacPorts 安装了 NumPy 1.6.2 和 OpenCV 2.4.2.1。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T19:20:36.403

您可以使用该属性检查您的数组`flags.contiguous`，如果不是，请让它们使用`copy()`：

```
>>> a = np.arange(16).reshape(4,4)
>>> a.flags.contiguous
True
>>> b = a.T
>>> b.flags.contiguous
False
>>> b = b.copy()
>>> b.flags.contiguous
True 
```

当您要求转置时，numpy 实际上并没有转置数据，只有用于访问它的步幅，除非您专门使用`copy()`.

# internet-explorer - Symfony2 favicon 不显示 IE9

> ID：14714884
> 
> 赞同：0
> 
> 时间：2013-02-05T19:01:04.880
> 
> 标签：internet-explorer, symfony, favicon

我们正在解决 Symfony2 上的 favicon 问题，它没有在 IE9 上显示。这是我们正在使用的代码：

```
 <!-- Favicon-->
    <link rel="apple-touch-icon" href="{{ asset('images/favicon.png') }}">
    <link rel="icon" href="{{ asset('images/favicon.png') }}">
    <!--[if IE]><link rel="shortcut icon" href="{{ asset('images/favicon.ico') }}"><![endif]--> 
```

其余的浏览器都在显示它，但对 IE 没有任何提示？提前致谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-06T02:17:54.220

IE 只支持根目录下的 favicon。

# python - 从用户输入中提取足球比分

> ID：14714886
> 
> 赞同：0
> 
> 时间：2013-02-05T19:01:11.500
> 
> 标签：python, regex, python-2.7

我正在用 python 编写一个程序，它将处理用户输入的足球比分。例如： `Newcastle United 4 - 6 Manchester united`

上面的分数也可以写成

`NUFC 4-6 MUFC`还有 as`newcastle 4-6 manu`等等……

我的目的是提取队名和分数： `Newcastle United`, `4`, `6`, `Manchester United`.

我需要关于如何做到这一点的建议。我能想到的一种方法是正则表达式，但我并不精通正则表达式，所以我在这里寻求帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:06:04.257

以下正则表达式会做到这一点：

```
^(.*?) *(\d+) *- *(\d+) *(.*)$ 
```

团体：

*   第一组：左队
*   第 2 组：左队得分
*   第 3 组：正确的球队得分
*   第 4 组：正确的团队

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:05:55.983

这似乎工作......

```
>>> re.match(r'(.*?)\s*(\d+)\s*\-\s*(\d+)\s*(.*)',s).groups()
('Newcastle United', '4', '6', 'Manchester united') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:07:04.333

一般来说，一个分数看起来可以描述为一个包含 5 个项目的列表：

1.  任意文本
2.  一串数字
3.  连字符
4.  一串数字
5.  任意文本

并且连字符的两边可能有也可能没有空格。

以下应该有效：

```
g = re.match("(.*) ([0-9]+) ?- ?([0-9]+) (.*)", user_input)
if g:
    team1 = g.group(1)
    team1_score = g.group(2)
    team2_score = g.group(3)
    team2 = g.group(4) 
```

调用中的数字`group()`对应于正则表达式中的括号，从左到右。

# java - KeyTypedEvent KeyEvent的KeyCode总是0？

> ID：14714888
> 
> 赞同：18
> 
> 时间：2013-02-05T19:01:12.587
> 
> 标签：java, swing, keylistener, keyevent

我在 NetBeans IDE 中有一个 Java Swing 应用程序。

我制作了一个表单并将 KeyListener 附加到我的各种控件中：

```
 jButton1.addKeyListener(new java.awt.event.KeyAdapter() {
        public void keyTyped(java.awt.event.KeyEvent evt) {
            keyTypedEvent(evt);
        }
    }); 
```

并被`keyTypedEvent`定义为：

```
private void keyTypedEvent(java.awt.event.KeyEvent evt) 
{                               
System.out.println(evt);
appendDisplay(String.valueOf(evt.getKeyChar()));
} 
```

我添加了一个`println`以`evt`查看会发生什么并验证我的 keylistener 是否有效。当我构建并运行我的应用程序时，我意识到输出似乎总是有一个`keycode = 0`

为了验证这一点，我将 println 更改为`evt.getKeyCode()`，它始终返回 0。

我可能完全误解了 KeyCode 的作用，但我认为它会与此处的 Oracle 文档中的值相一致：

[http://docs.oracle.com/javase/7/docs/api/constant-values.html#java.awt.event.KeyEvent.VK_ESCAPE](http://docs.oracle.com/javase/7/docs/api/constant-values.html#java.awt.event.KeyEvent.VK_ESCAPE)

例如，VK_ESCAPE 的值为 27。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-05T19:07:06.760

该`keyTyped()`事件仅用于产生字符输入的键。如果您想知道何时按下或释放任何键，则需要实现`keyPressed()`or `keyReleased()`。

从[KeyEvent](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html) API：

> “按键类型”事件是更高级别的，通常不依赖于平台或键盘布局。它们是在输入 Unicode 字符时生成的，并且是查找字符输入的首选方式......
> 
> 对于按键按下和按键释放事件，getKeyCode 方法返回事件的 keyCode。对于键类型事件，getKeyCode 方法总是返回 VK_UNDEFINED。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:15:57.780

*   all suggestion about `KeyListener` for `JButton` are wrong, meaning `Button1.addKeyListener(new java.awt.event.KeyAdapter() {`

*   [these events are implemented and correctly in `JButtons API`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JButton.html), use [`SwingAction`](http://docs.oracle.com/javase/tutorial/uiswing/misc/action.html) or add [`ActionListener`](http://docs.oracle.com/javase/tutorial/uiswing/events/actionlistener.html) for listening `Mouse and Key Event` from/to `JButton`

*   basically everything is described in Oracle tutorial about [How to Use Buttons, Check Boxes, and Radio Buttons](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:08:23.717

这很大程度上取决于已按下的键。可能您需要`KeyListener`使用`keyPressed`方法覆盖，因为`keyTyped`不会在不可打印的字符上触发。

`keyTyped`看看和这里的区别`keyPressed`： [KeyListener, keyPressed vs keyTyped](https://stackoverflow.com/questions/7071757/keylistener-keypressed-versus-keytyped)

# ios - 如何一次解析一个 RSS 提要列表？

> ID：14714889
> 
> 赞同：1
> 
> 时间：2013-02-05T19:01:13.310
> 
> 标签：ios, parsing, rss

我本质上是将 RSS 提要中的项目保存到一个数组中，然后将该数组放入另一个数组中以包含它们。例如，我正在按章节保存一堆教育视频（每个章节都有一个 RSS 提要），所以我使用 MWFeedParser 使用以下逻辑一次解析它们：

```
for (NSString *url in videosArray) {    
        NSURL *feedURL = [NSURL URLWithString:url];
        feedParser = [[MWFeedParser alloc] initWithFeedURL:feedURL];
        feedParser.delegate = self;
        feedParser.feedParseType = ParseTypeFull;
        feedParser.connectionType = ConnectionTypeAsynchronously;
        [feedParser parse];
        } 
```

虽然这样做了，但如果第 3 章 RSS 提要在第 2 章之前完成解析，第 3 章的内容将保存在第 2 章的位置。虽然这听起来像是一个不必要的复杂解释，但我的要求很简单：

有没有办法从提要列表中一次解析一个提要，并且在提要完全解析之前不继续，它的内容被插入到数组中？

如果有帮助，这里有 4 个可能有用的委托方法：

```
- (void)feedParserDidStart:(MWFeedParser *)parser {
NSLog(@"Started Parsing: %@", parser.url);
}

- (void)feedParser:(MWFeedParser *)parser didParseFeedInfo:(MWFeedInfo *)info {
NSLog(@"Parsed Feed Info: “%@”", info.title);
self.title = info.title;
}

- (void)feedParser:(MWFeedParser *)parser didParseFeedItem:(MWFeedItem *)item {
NSLog(@"Parsed Feed Item: “%@”", item.title);
if (item) [parsedItems addObject:item];
}

- (void)feedParserDidFinish:(MWFeedParser *)parser {
NSLog(@"Finished Parsing%@", (parser.stopped ? @" (Stopped)" : @""));
[courseBeingBuilt.mediaCollection addObject:parsedItems]; // Place chapter contents into Course's Chapter w/contents array
parsedItems = [[NSMutableArray alloc] init]; // Create new array for new chapter
} 
```

多谢你们！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:11:17.827

`videosArray`听起来您可以在变量（例如）中跟踪索引，`NSUInteger currentIndex`并在`feedParserDidFinish:`方法中使用它来开始解析下一个提要。

编写以下方法：

```
- (void) parseNextVideo
{
    NSURL *feedURL = [NSURL URLWithString:[videosArray objectAtIndex:currentIndex++]];
    feedParser = [[MWFeedParser alloc] initWithFeedURL:feedURL];
    feedParser.delegate = self;
    feedParser.feedParseType = ParseTypeFull;
    feedParser.connectionType = ConnectionTypeAsynchronously;
    [feedParser parse];
} 
```

而不是你的`for`循环，只是：

```
currentIndex = 0;
[self parseNextVideo]; 
```

然后在`feedParserDidFinish:`：

```
NSLog(@"Finished Parsing%@", (parser.stopped ? @" (Stopped)" : @""));
[courseBeingBuilt.mediaCollection addObject:parsedItems]; // Place chapter contents into Course's Chapter w/contents array
parsedItems = [[NSMutableArray alloc] init]; // Create new array for new chapter
if (currentIndex < videosArray.count) {
    [self parseNextVideo];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:09:17.227

与其让所有这些解析器同时松动，不如让您的委托对象更聪明一点：让它保留一个尚未解析的提要 URL 的可变数组。当您调用 时`feedParserDidFinish:`，创建下一个解析器并从列表中删除其 URL。如果数组中没有任何提要，您就完成了。

您还应该实现指示失败的委托方法，因为您可能会遇到单个提要的不可恢复错误（提要在 URL 中不存在）、影响所有网络操作的瞬态错误（网络连接断开）或其他一些不良情况. 您需要适当地处理这些情况。

# c# - 在文档准备好之前隐藏元素？

> ID：14714892
> 
> 赞同：1
> 
> 时间：2013-02-05T19:01:20.200
> 
> 标签：c#, javascript, jquery, asp.net, html

我有一个需要默认隐藏的 div。然后可以通过按钮进行切换：

```
 <script type="text/javascript">
        function toggle() {
            text = document.getElementById('add_view');
            var isHidden = text.style.display == 'none';
            text.style.display = isHidden ? 'block' : 'none';
        }

        $(document).ready
    (

              function () {
                  toggle();
                  $("#add_view, #btnToggle").click(function (e) {
                      e.stopPropagation();
                  });
                  $(document).click(function () {
                      toggle();
                  });
              }
    );

</script> 
```

它工作正常。唯一的问题是，当我刷新页面时，我会在隐藏之前暂时看到 div。

我能做些什么来防止这种情况发生？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T19:05:23.577

您可能需要默认隐藏元素，然后使用按钮切换可见性。尝试这个：

```
<div id="add_view" style="display:none">....</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T19:05:54.553

首先将元素隐藏在您的 html 中。

```
<div id="add_view" style="display: none;"></div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T09:20:17.763

最初，您必须通过设置`style="display:none;"`div 来隐藏它。一旦你想切换它，你必须将它用作

```
document.getElementById(Id).style.display=""; 
```

在 JavaScript 中。

# powershell-2.0 - 为什么 Powershell 会写入控制台，而不是文件？

> ID：14714896
> 
> 赞同：1
> 
> 时间：2013-02-05T19:01:32.263
> 
> 标签：powershell-2.0, output

我有一个 PowerShell 脚本，它根据文件的各种条件设置标志。为了简洁起见，我会缩写。

```
$path = "c:\path"
$srcfiles = Get-ChildItem $path -filter *.htm*

ForEach ($doc in $srcfiles) {

$s = $doc.Fullname

Write-Host "Processing :" $doc.FullName

if (stuff) {flag 1 = 1} else {flag 1 = 0}
if (stuff) {flag 1 = 1} else {flag 1 = 0}
if (stuff) {flag 1 = 1} else {flag 1 = 0}

$t = "$s;$flag1;$flag2;$flag2"

Write-Host "Output: " $t 
```

这一切都很好。我的文件处理，标志设置正确，并生成一个整洁的分号分隔行作为 $t。但是，如果我在函数的末尾拍打这两行，

```
$stream = [System.IO.StreamWriter] "flags.txt"
$stream.WriteLine $t 
```

我得到这个错误。

```
Unexpected token 't' in expression or statement.
At C:\CGC003a.ps1:53 char:25
+     $stream.WriteLine $t <<<<
    + CategoryInfo          : ParserError: (t:String) [], ParseException
    + FullyQualifiedErrorId : UnexpectedToken 
```

如果我正在阅读这篇文章，它似乎在`write-host`我的变量`$t`到达`WriteLine`. 不过，在我尝试之前`out-file`，我想了解`$t`Write-Host 之后发生了什么，这阻止`Write Line`了它被视为有效。还是我还缺少其他东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T19:42:10.127

尝试：

```
$stream.WriteLine($t) 
```

writeline 是`streamwriter`.net 对象的一种方法。要传递值，您需要将其包含在`( )`

-如果您需要附加到流写入器，则需要像这样创建它：

```
$a = new-object 'System.IO.StreamWriter' -ArgumentList "c:\path\to\flags.txt",$true 
```

其中布尔参数可以为 true 以将数据附加到文件或 false 以覆盖文件。

我建议通过完整路径：

```
$stream = [System.IO.StreamWriter] "c:\path\to\flags.txt" 
```

否则，您将在 .net 当前文件夹中创建文件（如果以管理员身份运行当前的 powershell 控制台，则可能是 c:\windows\system32，以了解它的类型`[System.IO.Directory]::GetCurrentDirectory()`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T23:21:10.617

你可以试试

```
$t > c:\path\to\flags.txt 
```

# javascript - 原型函数中未定义的符号

> ID：14714899
> 
> 赞同：1
> 
> 时间：2013-02-05T19:01:38.690
> 
> 标签：javascript, d3.js

我在原型函数中得到一个未定义的符号。我将'this'和'self'值写入console.log。值从通过直接调用的第一次调用更改为通过来自“缩放”的回调的后续调用。我有一个 jsfiddle，[http://jsfiddle.net/eric_l/kQSTH/](http://jsfiddle.net/eric_l/kQSTH/)，打开控制台可以看到错误消息。来自“this”和“self”的任何想法都不能正常工作？

```
<!DOCTYPE html>
<meta charset="utf-8">
<title>Zoom by Rectangle</title>
<script src="http://d3js.org/d3.v3.min.js"></script>
<style>

body {
  font-family: sans-serif; 
}

svg {
  font: 10px sans-serif;
  shape-rendering: crispEdges;
}

rect {
  fill: #ddd;
}

.axis path, .axis line {
  fill: none;
  stroke: #fff;
}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 3.0px;
}
</style>
<p><label for="zoom-rect"><input type="checkbox" id="zoom-rect"> zoom by rectangle</label>
<table><tr><td> <div id="chart1"> </div> </td></tr></table>
<script>

var zoomRect = false;

d3.select("#zoom-rect").on("change", function() {
      zoomRect = this.checked;
    });

var Chart = function( _width, _height, _anchor )
{
var self = this;
this.anchor = _anchor;
this.margin = {top: 0, right: 12, bottom: 12, left: 36},
this.width = _width - this.margin.left - this.margin.right,
this.height = _height - this.margin.top - this.margin.bottom;

this.data = [ {x:0         , y:0},
              {x:this.width*0.25, y:this.height},
              {x:this.width*0.5 , y:this.height/2},
              {x:this.width*0.75, y:this.height},
              {x:this.width     , y:0} ];

this.xscale = d3.scale.linear()
    .domain([0, this.width])
    .range([0, this.width]);

this.yscale = d3.scale.linear()
    .domain([0, this.height])
    .range([this.height, 0]);

this.xAxis = d3.svg.axis()
    .scale(this.xscale)
    .orient("bottom")
    .tickSize(-this.height);

this.yAxis = d3.svg.axis()
    .scale(this.yscale)
    .orient("left")
    .ticks(5)
    .tickSize(-this.width);

this.zoom = d3.behavior.zoom().x(this.xscale).y(this.yscale).on("zoom", this.refresh);

this.svg = d3.select(this.anchor).append("svg")
    .attr("width", this.width + this.margin.left + this.margin.right)
    .attr("height", this.height + this.margin.top + this.margin.bottom)
  .append("g")
    .attr("transform", "translate(" + this.margin.left + "," + this.margin.top + ")")
    .call(this.zoom)
  .append("g")
    .on("mousedown", function() {
      if (zoomRect)
      {
          d3.event.stopPropagation();
      }
    })
    .on("mousemove", function() {
      if (zoomRect)
      {
          d3.event.stopPropagation();
      }
    });

this.svg.append("rect")
    .attr("width", this.width)
    .attr("height", this.height);

this.line = d3.svg.line()
    .x(function (d) { return self.xscale(d.x) } )
    .y(function (d) { return self.yscale(d.y) } )

this.path = this.svg.append("path")
    .attr("class", "line")
    .datum(this.data)
    .attr("d", this.line);

this.svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + this.height + ")")
    .call(this.xAxis);

this.svg.append("g")
    .attr("class", "y axis")
    .call(this.yAxis);
}; // Chart

Chart.prototype.refresh = function() {
  console.log("this=" + this);
  console.log("self=" + self);
  console.log("this.svg=" + this.svg);
  console.log("self.svg=" + self.svg);
  self.svg.select("path").attr("d", self.line );
  self.svg.select(".x.axis").call(self.xAxis);
  self.svg.select(".y.axis").call(self.yAxis);
}

var charts = [];

charts.push( new Chart( 760, 400, "#chart1"));

for( var i = 0; i < charts.length; ++i ) {
    charts[ i ].refresh();
}

</script> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:17:11.343

`this`是保留关键字，`self`不是。Self 通常用于在可能不会在对象本身上调用的函数中关闭 this 的值。但是，`console.log(this)`在您的刷新函数中执行操作表明它确实是一个`Chart`对象。

在该函数内部使用`this`，而不是 self；或者执行这一行（虽然它是多余的）

```
var self = this; 
```

编辑：虽然 self 不是保留字，但`window.self` **它是**一个全局属性。因此，为什么`self`在没有其他上下文的情况下，它本身将是`window`

编辑 2：此行将导致所述错误

```
this.zoom = d3.behavior.zoom().x(this.xscale).y(this.yscale).on("zoom", this.refresh); 
```

特别是，它是缩放事件的绑定。从[wiki](https://github.com/mbostock/d3/wiki/Selections#wiki-on)中，该功能将具有

> 指定的侦听器以与其他运算符函数相同的方式调用，传递当前数据 d 和索引 i，**并将 this 上下文作为当前 DOM 元素**。

（强调我的）。

您需要通过 Chart 对象代理事件，因此将绑定更改为如下所示：

```
this.zoom = d3.behavior.zoom().x(this.xscale).y(this.yscale).on("zoom", function() {
    self.refresh();
}); 
```

[更新的 js 小提琴](http://jsfiddle.net/kQSTH/1/)

# scala - 最优 HashSet 初始化 (Scala | Java)

> ID：14714900
> 
> 赞同：2
> 
> 时间：2013-02-05T19:01:38.923
> 
> 标签：scala, optimization, hashset

我正在编写一个人工智能来解决“[生命迷宫](http://www.clickmazes.com/life/ixlife.htm)”难题。尝试将状态存储到 a`HashSet`会减慢一切。在没有一组探索状态的情况下运行它会更快。我相当有信心我的节点（状态存储）实现了 equals 并且`hashCode`测试显示 a`HashSet`不会添加重复状态。我可能需要重新设计该`hashCode`功能，但我相信减慢它的速度是`HashSet`重新散列和调整大小。

我尝试将初始容量设置为一个非常大的数字，但它仍然非常慢：

```
 val initCapacity = java.lang.Math.pow(initialGrid.width*initialGrid.height,3).intValue()
 val frontier = new QuickQueue[Node](initCapacity) 
```

这是快速队列代码：

```
class QuickQueue[T](capacity: Int) {

val hashSet = new HashSet[T](capacity)
val queue = new Queue[T]
    //methods below 
```

有关更多信息，这里是哈希函数。我将网格值以字节为单位存储在两个数组中，并使用元组访问它：

```
override def hashCode(): Int = {
  var sum = Math.pow(grid.goalCoords._1, grid.goalCoords._2).toInt
  for (y <- 0 until grid.height) {
     for (x <- 0 until grid.width) {
        sum += Math.pow(grid((x, y)).doubleValue(), x.toDouble).toInt
     }
     sum += Math.pow(sum, y).toInt
  }
  return sum
} 
```

关于如何设置`HashSet`不会减慢速度的任何建议？也许另一个关于如何记住探索状态的建议？

PS 使用`java.util.HashSet`，即使设置了初始容量，也需要 80 秒 vs < 7 秒 w/o

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T20:00:43.410

好的，首先，请更换

```
override def hashCode(): Int = 
```

和

```
override lazy val hashCode: Int = 
```

所以每次需要访问散列码时都不需要计算 ( `grid.height*grid.width`) 浮点幂。这应该会大大加快速度。

然后，除非您以某种方式依赖具有紧密哈希码的紧密单元，否则不要重新发明轮子。使用`scala.util.hashing.MurmurHash3.seqHash`或类似的东西来计算你的哈希。这应该将您的哈希速度提高 20 倍左右。（仍然保留懒惰的 val。）

然后，您只有所需的集合操作的开销。现在，除非您有很多 0x0 网格，否则您将花费​​绝大多数时间等待 math.pow 给您一个结果（并且冒着一切风险变成`Double.PositiveInfinity`or `0.0`，这取决于值的大小，这将创建哈希冲突会进一步减慢速度）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T20:38:47.573

请注意，以下假设您的所有对象都是不可变的。在使用散列时，这是一个合理的假设。

此外，您应该在应用优化之前分析您的代码（例如使用 JDK 附带的免费 jvisualvm）。

# 快速记忆`hashCode`

计算哈希码通常是一个瓶颈。通过为每个对象只计算一次哈希码并存储结果，您可以将哈希码计算的成本降至最低（在对象创建时一次），但会增加空间消耗（可能适中）。为了实现这一点，将 the`def hashCode`变成`lazy val`or `val`。

# 快速实习`equals`

`hashCode`一旦消除了成本，计算`equals`就会成为问题。`equals`一般来说，对于收集领域和深层结构来说，成本特别高。

`equals`您可以通过*实习*将成本降至最低。这意味着您通过工厂方法获取类的新对象，该方法检查请求的新对象是否已经存在，如果存在，则返回对现有对象的引用。如果您断言这种类型的每个对象都是以这种方式构造的，那么您就知道每个不同对象只有一个实例，并且`equals`等效于对象标识，这是一种廉价的引用比较（`eq`在 Scala 中）。

# php - 在 PHP 中读取 XML 属性

> ID：14714902
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:01:44.240
> 
> 标签：php, xml, properties

我对 PHP 和 XML 有疑问。我有一个要导入数据库的 XML 数据馈送。大多数值都可以正常工作，但属性不起作用。

我试图选择“品牌”属性，`$brand = $allData[$key]->property->brand->value;`但它不起作用。

这是读取 data.xml 的 PHP。在代码之后是 XML。

```
$xml = simplexml_load_file("data.xml");
foreach($xml->children() as $child)
{ 
$allData[] = $child;
}

foreach($allData as $key=>$value)
{
$naam = $allData[$key]->name;
$image = $allData[$key]->images->image;

} 
```

--- XML 代码的一部分 ----

```
<images>
<image>afbeelding.jpg</image>
</images>
<description>beschrijving</description>
<categories>
<category path="categorie"> Categorie </category>
</categories>

<properties>
<property name="brand">
<value>Merk</value>
</property> 
```

我可以很容易地得到描述和图像标签。但是品牌不行。

`$brand = $allData[$key]->property->brand->value;`

有没有人可以帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:48:47.133

我不明白你为什么通过强制将它放入数组来迭代某些东西。您的问题的简短（但不好）答案是： $brandProperty = (string) $allData[$key]->property->attributes()->name;

更好：遵循 Jerry 的建议和 RTM - 阅读精美的手册。手册和用户提供的注释包含您需要的所有信息以及更多信息。`foreach ($xml->children() as $node)`SimpleXML 本身实现了迭代，使用类似遍历文档之类的东西更容易。

希望有帮助。

# php - 表单没有将信息插入mysql表？

> ID：14714903
> 
> 赞同：0
> 
> 时间：2013-02-05T19:01:44.163
> 
> 标签：php, html, mysql

嗨，我的论坛评论表有问题。基本上我试图让用户阅读用户的帖子并对其发表评论，表单数据应该被插入到 mysql 中。

我需要插入的值是comment_id，它是用户的会话ID，而post_id是他们评论的帖子的ID和他们输入的内容。

出于某种原因，这没有被插入到 mysql 中，并且没有任何错误地提出我的回显成功消息。有人可以告诉我我哪里出错了。

谢谢

```
<?php
        $page_title = "Read Post";
        include('includes/header.php'); 
        include ('includes/mod_login/login_form2.php');  ?>

        <?php
        confirm_logged_in();

        if (isset ($_GET['post'])) {
        $forum_id = $_GET['post'];
    }

    ?>

    <?php include('includes/copyrightbar.php'); ?>
    <?
    $read_forum_set = read_forum_set();
            while ($forum = mysql_fetch_array($read_forum_set)) {?>
    <div class="modtitle">
    <div class="modtitle-text"><?php echo "{$forum['display_name']}"; ?>'s Forum Post</div>
    <? } ?>
    </div>

    <div class="modcontent57">

    <br /><br /><br/><br/>

    <div class="forum">
    <div class="forum-pic"><?php echo "<img src=\"data/photos/{$_SESSION['user_id']}/_default.jpg\" width=\"100\" height=\"100\" border=\"0\" align=\"right\" class=\"img-with-border-forum\" />";?>
    </div>

    <div class="message-links">
    <strong><a href="forum.php"><< Back to Forum</a>
    </div> 
    <br /><br /><br/><br/>
    <?php 

        $datesent1 = $forum['date_sent'];  ?>

    <?php
            $read_forum_set = read_forum_set();
            while ($forum = mysql_fetch_array($read_forum_set)) {
            $prof_photo = "data/photos/{$forum['user_id']}/_default.jpg";

            $result = mysql_query("UPDATE ptb_forum SET ptb_forum.read_forum='1' WHERE ptb_forum.id='$forum'") 
    or die(mysql_error()); 

    ?>
    <div class="message-date">
    <?php echo "".date('D M jS, Y  -  g:ia', strtotime($forum['date_sent'])).""; ?></div>

    <div class="img-with-border-frm-read"><?php echo "<a href=\"profile.php?id={$forum['from_user_id']}\"><img width=\"60px\" height=\"60px\" src=\"{$prof_photo}\"></a><br />"; ?></div>

    <?php echo "<div class=\"forum-content2\"><div class=\"forum_subject\"><strong>Subject:</strong></div><div class=\"forum_subject2\"><i>{$forum['title']}</i></div><div class=\"forum_body\"><strong>Post:<br/></strong></br ><i>{$forum['content']}</i></div></div>";?>

     <?php 
    // check if the review form has been sent
    if(isset($_POST['forum_comment']))
    {
        $content = $_POST['forum_comment'];
            //We remove slashes depending on the configuration
            if(get_magic_quotes_gpc())
            {
                    $content = stripslashes($content);
            }
            //We check if all the fields are filled
            if($_POST['forum_comment']!='')
            {

                {
                $sql = "INSERT INTO ptb_forum_comments (comment_id, post_id, content) VALUES (NULL, '".$_SESSION['user_id']."', '".$profile_id."', '".$content."');";
                mysql_query($sql, $connection);

                echo "<div class=\"infobox-profile4\"><strong>Thank You</strong> - Your review has been sent for approval.</div>";
            } }
    }

    ?> 

     <?php if(isset ($_SESSION['user_id'])) { ?>

    <div class="forum-comment-box">
    <form action="<?php $_SERVER['PHP_SELF'] ?>" method="post">
    <textarea name="forum_comment" id="forum_comment" style="resize:none; height:100px; width:543px;"></textarea><input type="submit" name="send_button" id="send_button" style="float:right; margin-right:30px; text-align:center;" value="Reply to {$message['display_name']}" /></form></div>

    <? } } ?>

          </div>
          </div>

    <?php include('includes/footer.php'); ?>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:10:19.740

您在这里缺少一些表名：

```
$sql = "INSERT INTO ptb_forum_comments (comment_id, post_id, content) VALUES (NULL, '".$_SESSION['user_id']."', '".$profile_id."', '".$content."');"; 
```

如您所见，您有 3 个表名和 4 个值。

# vb.net - 如果未处置非托管资源怎么办？

> ID：14714905
> 
> 赞同：0
> 
> 时间：2013-02-05T19:01:46.450
> 
> 标签：vb.net, memory

在我的应用程序中，有很多 oledbConnections 和数据表和数据源以及更多非托管资源 .. 其中一些被处置（在不再需要它们时通过调用 Dispose() ）而另一个没有 Dispose() （只是为了使代码行更少！）。问题是：如果这些非托管资源在使用后不处理，应用会有什么问题吗？

我有时（并非所有时间）错误“appname 已停止工作..”，此错误是由未处置的对象引起的吗？

最后，在调用 Dispose() 时发生错误的情况有哪些？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:07:32.580

这在某种程度上取决于非托管资源是什么。如果是数据库连接，您最终会用完连接。也就是说，连接池中的所有连接都将打开但未使用。此时的数据库服务器将不允许任何新连接。因此，您将无法再连接到数据库。

其他类型的资源也会出现类似的问题。你会泄露它们，你会让自己陷入各种奇怪的、难以调试的情况。

最佳做法是始终调用`Dispose`，或者`Close`当你完成它时，如果类具有该方法。`using`在 C# 中，您可以出于这个原因使用语句。我不知道 VB.net 等效语法是什么，但不管它是什么，你都应该使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:09:45.210

使用完所有东西后，最好将它们处理掉。当您使用 dispose 时，您会清理托管和非托管资源。不正确处理这些可能会导致问题和内存泄漏，这可能是您收到该错误消息的原因。只需添加 Dispose() 方法 :) 几行额外的代码最终可以节省您的时间。

# node.js - Node.js 崩溃

> ID：14714906
> 
> 赞同：3
> 
> 时间：2013-02-05T19:01:48.587
> 
> 标签：node.js

我的 node.js 应用程序不断崩溃。这是一个从 mysql 数据库获取数据的简单 Web 服务。我每天收到大约 20k 到 30k 个查询。我不确定它是否崩溃了，因为我需要给它更多资源，或者我的代码有问题。它托管在 AppFog 中，这是崩溃日志。

我不确定 hashish 包是什么，但我尝试使用“npm install hashish”安装它，但没有解决问题。

有什么想法吗？

```
C:\Users\Tom\\nodejs>af crashlogs TomsApp
====> /logs/staging.log <====

# Logfile created on 2013-02-05 00:53:01 +0000 by logger.rb/25413
Installing dependencies. Node version 0.8.14
Installing mysql@mysql@0.9.6 from local path
Installing hashish@hashish@0.0.4 from registry
Package is not found in npm registry hashish@hashish@0.0.4
Failed getting the requested package: hashish@hashish@0.0.4
Installing require-all@require-all@0.0.5 from local path

====> /logs/stderr.log <====

events.js:71
        throw arguments[1]; // Unhandled 'error' event
                       ^
Error: Connection lost: The server closed the connection.
    at Protocol.end (/mnt/var/vcap.local/dea/apps/ta-0-365d7313671d4e40105a4d158
f1247d5/app/node_modules/mysql/lib/protocol/Protocol.js:63:13)
    at Socket.onend (stream.js:66:10)
    at Socket.EventEmitter.emit (events.js:126:20)
    at TCP.onread (net.js:417:51) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:24:04.957

你怎么得到你的连接？你得到它一次，还是为每个请求获取一个新的，然后将它返回到池中？池应该在幕后处理陈旧的连接。

```
var mysql = require('mysql');
var pool  = mysql.createPool({
  host     : 'example.org',
  user     : 'bob',
  password : 'secret'
});

// for each request where you need the database connection, wrap it with
pool.getConnection(function(err, connection) {
  // do something with connection here
  ...
  connection.end();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:15:37.973

我会说mysql服务器拒绝连接也许你想调查一下

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T21:38:53.637

您可能必须为所有连接处理套接字 ( [http://nodejs.org/api/net.html#net_event_error_1](http://nodejs.org/api/net.html#net_event_error_1) ) 上的错误事件。

这样可以防止它崩溃，然后您应该会看到实际问题。

# mysql - mysql 按名称查询组

> ID：14714907
> 
> 赞同：2
> 
> 时间：2013-02-05T19:01:50.187
> 
> 标签：mysql

我需要一些有关 MySQL 查询的帮助。

我有这张桌子：

```
姓名 | 日期 | 城市
------+------------+------
彼得 | 2013-04-01 | 柏林
保罗 | 2013-03-01 | 伦敦
彼得 | 2013-03-01 | 纽约
彼得 | 2013-01-28 | 东京

```

对于每个名称，我需要表中的第一个日期和相应的城市。

我试过了：

```
SELECT Name, MIN(Date) as MD, MIN(City) as CN FROM table GROUP BY Name 
```

但是日期与城市名称不对应，结果是：

```
Peter, 2013-01-028, Berlin 
```

任何人都可以给我一个提示吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:04:38.920

您将需要使用子查询来获取`min(date)`by`name`然后将该结果加入到您的表中`name`and上`date`：

```
SELECT t1.Name, 
  t1.Date as MD, 
  t1.City as CN 
FROM yourtable t1
inner join
(
  select min(date) MinDate, name
  from yourtable
  group by name
) t2
  on t1.name = t2.name
  and t1.date = t2.mindate 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/2c7bb/2)

结果是：

```
|  NAME |                             MD |     CN |
---------------------------------------------------
|  Paul |   March, 01 2013 00:00:00+0000 | London |
| Peter | January, 28 2013 00:00:00+0000 |  Tokio | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:00:11.227

您可以使用 IN 子句：

```
SELECT yourtable.*
FROM   yourtable
WHERE  (Name, Date) IN (SELECT Name, Min(Date)
                        FROM yourtable
                        GROUP BY Name) 
```

子查询将为每个名称返回名称及其最短日期。外部查询返回名称和日期与子查询返回的行相对应的所有行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:04:11.043

尝试这个：：

```
SELECT Name, MIN(Date) as MD, City as CN FROM table GROUP BY Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:06:09.243

A`LEFT JOIN`应该给出你想要的结果，而不会使查询过于复杂；

```
SELECT m1.* FROM myTable m1
LEFT JOIN myTable m2
  ON m1.Name = m2.Name
 AND m1.`date` > m2.`date`
WHERE m2.Name is NULL 
```

[一个用于测试的 SQLfiddle](http://sqlfiddle.com/#!2/c0407/2)。

它基本上会选择没有同名的旧行的所有行。

```
NAME    DATE          CITY
Paul    2013-03-01    London
Peter   2013-01-28    Tokio 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T19:08:06.503

这是你如何做到的。

```
SELECT
  m.Name,
  m.Date,
  m.City
FROM mytable as m
INNER JOIN (select min(date) as LDate, name from mytable group by name) as l
    on l.LDate = m.date
      and l.name = m.name
group by m.name 
```

## [演示](http://sqlfiddle.com/#!2/9b53b/2)

输出

```
Name  | Date        | City
-----------------------------
Paul  | 2013-03-01  | London
Peter | 2013-01-28  | Tokio 
```

# php - 为什么readyState为4时，我在脚本中调用的Ajax函数连续运行两次？

> ID：14714908
> 
> 赞同：5
> 
> 时间：2013-02-05T19:01:56.683
> 
> 标签：php, javascript, ajax

全部，

我正在使用 Head First Ajax 书学习 Ajax。在第一章中，他们给出了一些我稍微简化的代码示例。我添加了一堆`alert`以了解发生了什么。这是代码：

HTML + Ajax ( `index.php`):

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Rob's Rock 'n' Roll Memorabilia</title>
<link rel="stylesheet" href="css/default.css" />
<script>
  function createRequest() {
    try {
      request = new XMLHttpRequest();
    } catch (tryMS) {
      try {
        request = new ActiveXObject("Msxml2.XMLHTTP");
      } catch (otherMS) {
        try {
          request = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (failed) {
          request = null;
        }
      }
    }
  return request;
}

function getDetails(img){
  var title = img.title;
  alert("getDetails1");
  request = createRequest();
  alert("getDetails2");
  if (request == null) {
    alert("Unable to create request");
    return;
  }
  var url= "getDetails.php?ImageID=" + escape(title);
  alert("getDetails3");
  request.open("GET", url, true);
  alert("getDetails4");
  request.onreadystatechange = displayDetails;
  alert("getDetails5");
  request.send(null);
  alert("getDetails6");
}

function displayDetails() {
  alert("displayDetails1");
  if (request.readyState == 4) {
    alert("Request.readyState is 4");
    if (request.status == 200) {
      alert("Request.status is 200");
      detailDiv = document.getElementById("description");
      alert("displayDetails2");
      detailDiv.innerHTML = request.responseText;
      alert("displayDetails3");
    }else{
      alert("Request.status not 200");
      return;
    }
  }else{
    alert("Request.readystate not 4");
    return;
  }
}
</script>  
</head>
<body>
  <div id="wrapper">
    <div id="thumbnailPane">  
      <img src="images/SISL_Avatar2.JPG"
           title="SISL" id="SISL" onclick="getNextImage()" />  
      <img src="images/itemGuitar.jpg" width="301" height="105" alt="guitar" 
           title="itemGuitar" id="itemGuitar" onclick="getDetails(this)"/>
      <img src="images/itemShades.jpg" alt="sunglasses" width="301" height="88" 
           title="itemShades" id="itemShades" onclick="getDetails(this)" />
      <img src="images/itemCowbell.jpg" alt="cowbell" width="301" height="126" 
           title="itemCowbell" id="itemCowbell" onclick="getDetails(this)" />
      <img src="images/itemHat.jpg" alt="hat" width="300" height="152" 
           title="itemHat" id="itemHat" onclick="getDetails(this)" />
    </div>

    <div id="detailsPane">
      <img src="images/blank-detail.jpg" width="346" height="153" id="itemDetail" />
      <div id="description"></div>
    </div>

  </div>
</body>
</html>

<?php    
$details = array (
    'itemGuitar'    =>  "<p>Pete Townshend once played this guitar while his own axe was in the shop having bits of drumkit removed from it.</p>",
    'itemShades'    =>  "<p>Yoko Ono's sunglasses. While perhaps not valued much by Beatles fans, this pair is rumored to have been licked by John Lennon.</p>",
    'itemCowbell'   =>  "<p>Remember the famous \"more cowbell\" skit from Saturday Night Live? Well, this is the actual cowbell.</p>",
    'itemHat'       =>  "<p>Michael Jackson's hat, as worn in the \"Billie Jean\" video. Not really rock memorabilia, but it smells better than Slash's tophat.</p>"
);    
if (isset($_REQUEST['ImageID'])){echo $details[$_REQUEST['ImageID']];}
?> 
```

这是 Ajax ( `getDetails.php`) 调用的 URL：

```
<?php

$details = array (
    'itemGuitar'    =>  "<p>Pete Townshend once played this guitar while his own axe was in the shop having bits of drumkit removed from it.</p>",
    'itemShades'    =>  "<p>Yoko Ono's sunglasses. While perhaps not valued much by Beatles fans, this pair is rumored to have been licked by John Lennon.</p>",
    'itemCowbell'   =>  "<p>Remember the famous \"more cowbell\" skit from Saturday Night Live? Well, this is the actual cowbell.</p>",
    'itemHat'       =>  "<p>Michael Jackson's hat, as worn in the \"Billie Jean\" video. Not really rock memorabilia, but it smells better than Slash's tophat.</p>"
);
echo $details[$_REQUEST['ImageID']];
?> 
```

**问题：为什么函数`displayDetails`在就绪状态 4 运行两次？**

当我运行上面的代码时，代码似乎运行了`displayDetails()`两次该函数。我首先收到`displayDetails1`我已输入该功能的警报信号。然后，我收到与不是 4 相关的警报`readyState`，然后又不是 4，然后是 4 ( `Request.readyState is 4`)。然后状态警报告诉我状态是 200。到目前为止，没有什么意外。

**在那之后，我得到了一些奇怪的东西。** 我收到`displayDetails2`警报，然后根据功能修改页面并收到`displayDetails3`警报。然后我希望退出该功能。相反，我再次得到`displayDetails1`, `Request.readyState is 4`（**第二次！**）、`Request.status is 200`、`displayDetails2`和`displayDetails3`警报，就好像整个函数已经第二次运行了一样。这是为什么？

PS：
1）在第二轮之后，我得到了`getDetails6`我期望的警报。
2) 页面功能正常 - 从用户的角度来看，如果禁用警报并没有什么异常。3）我在 WampServer 上本地开发，在 WinXP 机器上（我知道......）。
4）如果我添加：

```
function alert(msg) {
  console.log(msg);
} 
```

在我的脚本中，日志只记录一个`readyState is 4`...

**解析度**

我已经完成了 3 次测试：
1 - 仅使用警报，我收到两个`readyState is 4`警报。
2 - 如果我记录警报，则日志仅显示一个`readyState is 4`警报。
3 - 如果我同时记录并显示警报弹出窗口（使用[此功能](https://stackoverflow.com/questions/14716439/javascript-function-to-both-log-and-show-pop-up-alerts)），我会收到两个`readyState is 4`警报（并且日志显示）。

我对此的看法是，警报本身会导致脚本执行延迟并导致函数有效地运行两次。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T20:23:37.227

javascript`alert`阻塞了您的 UI 线程，可能足够长的时间让您的浏览器完成加载 AJAX 请求。由于您在警报之后不检查`request.readyState`直到，它可以在您检查之前由浏览器更新。

尝试修改您的事件处理程序：

```
function displayDetails() {
  var rs = request.readyState;
  alert("displayDetails1");
  if (rs == 4) {
    alert("Request.readyState is 4");
    //rest of code... 
```

您只会看到一条“Request.readyState 为 4”的警报

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T19:09:03.267

该`onreadystatechange`事件不仅在请求完成后触发。为 XMLHttpRequest 定义了 5 种状态：

*   0 未初始化 初始值。
*   1 打开 open() 方法已成功调用。
*   2 Sent UA 成功完成请求，但尚未收到数据。
*   3 接收 在收到消息正文（如果有）之前立即接收。已收到所有 HTTP 标头。
*   4 已加载

通常在开发 AJAX 应用程序时，您只会对状态 4 感兴趣 - 已加载，因为它表示请求已完成，但您可以观察到其他状态。

因此，您不必担心对事件处理程序的第二次调用。**这是正常行为**。它只是意味着请求在其工作期间改变了它的内部状态。

如果您对这些状态感兴趣，我建议您将所有状态记录到 javascript 控制台以查看发生了什么。在加载大数据时，我也会给你tipp测试。您很可能会看到多个 3 - 接收 - 状态。

* * *

更新，也许我理解你的问题是错误的（但不是你的代码；）..你在评论中告诉你看到两次就绪状态 4。我已经在家里测试过这个，100 的警报对我来说看起来很奇怪。

然后，我将以下函数添加到您的 javascript 部分：

```
function alert(msg) {
    console.log(msg);
} 
```

这会将所有警报重定向到 javascript 调试控制台。我得到以下输出：

![在此处输入图像描述](../Images/3c4986b7e312a66006c9f4bff0ed3029.png)

我只看到一次就绪状态 4。似乎你因为太多 alert() 而变得自私；）

* * *

Update2：正如我在评论中提到的，@thanks Jeff-Meadows 也指出了这一点：请注意，`alert()`除非您按下确定按钮，否则该函数将阻止 javascript 线程。由于异步 XHR 请求将由单独的浏览器线程处理，因此 XHR 将继续加载，而 javascript 会阻止警报消息。您会看到这可能/会产生不必要的副作用，并使 alert() 对调试的价值降低。

# c# - 如何使这个答案适应非泛型类？

> ID：14714911
> 
> 赞同：1
> 
> 时间：2013-02-05T19:02:18.187
> 
> 标签：c#, .net, reflection, properties, lambda

我想[将此解决方案](https://stackoverflow.com/a/491486/963396)改编为我现有的实用程序类 - 只是`GetProperty`方法。问题是，我的实用程序类不是通用类型的（即类声明没有`<T>`像那样的参数`PropertyHelper`），我暂时无法添加。

换句话说，我只希望该`GetProperty`方法是通用类型的，而不是整个类。

那么我需要进行哪些修改才能使该方法有效？我尝试将 T 添加到该方法的泛型类型列表中：

```
public static PropertyInfo GetProperty<T, TValue>(Expression<Func<T, TValue>> selector) 
```

但是当我尝试执行以下操作时，它给了我错误：

```
PropertyInfo prop = MyUtilClass.GetProperty<Foo>(x => x.Bar); 
```

显然，这是因为`GetProperty`期望 a`T`和 a `TValue`...

我只是希望能够像上面那样称呼它。如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:23:36.447

我可能不在这个基础上，但如果你想要代码的话：

```
PropertyInfo prop = MyUtilClass.GetProperty<Foo>(x => x.Bar); 
```

工作（假设您正在尝试获取有关该“x.Bar”的属性信息），您只需将您的函数定义为：

```
public static PropertyInfo GetProperty<T>(Expression<Func<T, Object>> selector) 
```

然后从您的函数中读取成员的名称，如

```
MemberExpression member = (MemberExpression)selector.Body;
String propertyName = member.Member.Name;
PropertyInfo info = typeof(T).GetProperty(propertyName, BindingFlags.Public 
            |  BindingFlags.Instance)
return info; 
```

就像我说的，我可能不在基地，但这似乎是你想要做的。

# performance - websocket 可扩展性

> ID：14714915
> 
> 赞同：8
> 
> 时间：2013-02-05T19:02:35.770
> 
> 标签：performance, websocket, cluster-computing

我在 websockets 上看了一些，我有一个非常具体的问题：websockets 实际上可以在不同的服务器上扩展，还是它们总是仅限于一个服务器？

似乎这是我在我发现的文档中反复遇到的一个问题，但也许它们不完整或事情发生了变化。例如，似乎heroku甚至根本不支持websockets（？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:49:05.177

这取决于您的应用程序，但总的来说，您没有理由不能像任何其他 TCP 连接一样对多台机器的 websocket 连接进行负载平衡。

# vba - 是否可以使用不连续的命名范围填充列表框？

> ID：14714920
> 
> 赞同：0
> 
> 时间：2013-02-05T19:02:51.560
> 
> 标签：vba, excel, listbox, userform

我有一个单列列表框，我想用一个工作表上的表名填充它。我已经按 Ctrl 单击了所有名称并命名了它们，但是当我将范围名称输入到用户窗体的属性表中时，它们不会显示出来。我做错了什么？

我还要声明我想避免在另一个工作表上创建单独的列表。

有趣的是，当您复制非连续数据并粘贴时，它会连续粘贴。excel是如何做到这一点的？我已经录制了宏，它只是“activesheet.paste”。你可以粘贴到数组中吗？...然后将数组用作列表，而不必创建另一个列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:55:08.410

你可以这样做：

```
arrayname = rangename.value 'set named range to array
sheet1.listbox1.list = arrayname 'set array to listbox values 
```

# c - 使用双向链表插入排序

> ID：14714921
> 
> 赞同：0
> 
> 时间：2013-02-05T19:03:05.117
> 
> 标签：c, sorting, linked-list

我一直在研究一组用于双向链表的函数，我遇到的一个问题是将元素插入到列表中但保持列表的排序顺序。所以如果我有一个 {3, 4, 6} 列表并插入 5 那么列表将变为 {3, 4, 5, 6}

我昨晚重写后刚刚完成了最新的代码，请评论告诉我是否有更好的方法，我同时发布头文件和c文件。我要指出的一件事是，我不使用指向当前节点的指针，而只在插入函数中创建一个指针，该指针创建一个具有临时位置的新节点。

列表.H

```
/* custom types */

typedef struct node
{
    int val;
    struct node * next;
    struct node * prev;
}Node;

typedef struct list
{
    Node * head;
    Node * tail;
}List;

/* function prototypes */

/* operation: creates a list */
/* pre: set equal to a pointer to a list*/
/* post: list is initialized to empty */
List* NewList();

/* operation: Insert a number into a list sorted */
/* pre: plist points to a list, num is an int */
/* post: number inserted and the list is sorted */
void Insert(List * plist, int x); 
```

列表.C

```
/* c file for implentation of functions for the custome type list */
/* specifically made for dueling lists by, Ryan Foreman */

#include "List.h"
#include <stdlib.h> /* for exit and malloc */
#include <stdio.h>

List* NewList()
{
    List * plist = (List *) malloc(sizeof(List));
    plist->head = NULL;
    plist->tail = NULL;
    return plist;
}

void Insert(List * plist, int x)
{
    /* create temp Node p then point to head to start traversing */
    Node * p = (Node *) malloc(sizeof(Node));
    p->val = x;

    /* if the first element */
    if ( plist->head == NULL) {
        plist->head = p;
        plist->tail = p;
    }
    /* if inserting into begining */
    else if ( p->val < plist->head->val ) {
        p->next = plist->head;
        plist->head->prev = p;
        plist->head = p;
    }

    else {
        p->next = plist->head;
        int found = 0;
        /* find if there is a number bigger than passed val */
        while((p->next != NULL) && ( found == 0)) {
            if(p->val < p->next->val)
                found = 1;
            else {
                p->next = p->next->next;
            }
        }
        /* if in the middle of the list */
        if(found == 1)
        {
            p->prev = p->next->prev;
            p->next->prev = p;
        }
        /* if tail */
        else {
            plist->tail->next = p;
            p->prev = plist->tail;
            plist->tail = p;
        }
    }
} 
```

感谢您对代码的任何输入，感谢您的任何评论

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:48:34.810

malloc() 不会将内存归零，您不会将第一个节点设置为 next/prev，因此如果第二个节点 >= 第一个节点值，即退出条件 p->next != NULL 不满足，您的 while 循环可能会永远持续下去.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:13:55.830

关于您的 C' 利用率的一些评论。

*   在 C 中，从指针转换`void`为指向对象的指针是不必要的。
*   `malloc`在此类库中检查返回可能是个好主意。

# c# - 为来自另一个控制器的列表中的下拉列表设置默认值

> ID：14714923
> 
> 赞同：0
> 
> 时间：2013-02-05T19:03:19.220
> 
> 标签：c#, asp.net-mvc, drop-down-menu

我有这个网页，它显示了一个对象的属性，以便我可以编辑它，我`DropDownList`用来自另一个类的字符串填充一个。

这是我用来填充的方法`DropDownList`：

```
private void PopulateOBJSetDropdownList(object selectedobj = null)
        {
            List<string> listOBJSetName = m_OBJSetManager.GetListOBJSets().OrderBy(x => x.m_Name)
                                                           .Select(x => x.m_Name.ToString())
                                                           .Distinct()
                                                           .ToList();
            ViewBag.objSetID = new SelectList(listOBJSetName );
        } 
```

该`ViewBag`属性很好地完成了它的工作，但是在编辑项目时列表为空。

我很确定这是因为这条线：

```
<div class="editor-label">
            @Html.LabelFor(model => model.m_OBJSetID, "Obj Set")
        </div>
        <div class="editor-field">
            @Html.DropDownList("objSetID ", String.Empty)
            @Html.ValidationMessageFor(model => model.m_OBJSetID)
        </div> 
```

因为下拉列表填充了`String.Empty`. 这来自 objs 的控制器。

基本上，我希望它`DropDownList`向我显示所有可用 objSet 的名称，但我也希望它在编辑 obj 时默认选择正确的 objSet。

有人可以帮忙吗？我够清楚吗？谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:19:53.890

我会避免viewbag。您可能想要创建一个视图模型，然后传递它。但这也可以通过 viewbag 来完成。

首先，在您看来，我会将您的下拉列表更改为以下内容

```
@Html.DropDownListFor(model => model.m_OBJSetID, DDLSelectitemListGoesHere) 
```

如果你做一个视图模型，你可以在一个类中包含这个页面需要使用的所有东西，并将它发送到视图

```
public class MyViewModel{
    public List<YourModel> theModel { get; set; }
    public IEnumerable<SelectListItem> DDLItems { get; set; }
} 
```

然后在你看来，在顶部

```
@model PROJECTNAME.NAMESPACE.MyViewModel 
```

你可以像这样填写下拉列表

```
@Html.DropDownListFor(model => model.theModel.m_OBJSetID, model.DDLItems) 
```

希望其中一个能让你度过难关

# java - JasperFillManager.fillReportToFile 的内存不足问题

> ID：14714924
> 
> 赞同：1
> 
> 时间：2013-02-05T19:03:19.857
> 
> 标签：java, jasper-reports

在生成多个小型 PDF 报告（例如 50000 个报告，每个 2-3 页，文件大小为 50 到 60 KB）时，我面临**内存不足的问题。**生成 3000 报告后出现内存不足错误。

执行以下行后，我看到内存没有被清理。

```
JasperFillManager.fillReportToFile(compiledPath,
        file.getPath(), null, dataSource); 
```

我已经使用 JRSwapFileVirtualizer 尝试了下面的替代代码，但它对这个问题没有帮助。

```
dataSource = new JRBeanArrayDataSource(myBean);
swapFile =  new JRSwapFile(outputFileLocation, 1024, 1024);
virtualizer = new JRSwapFileVirtualizer(3,swapFile, true);

parameterMap = new HashMap();
parameterMap.put(JRParameter.REPORT_VIRTUALIZER, virtualizer);

JasperFillManager.fillReportToFile(compiledPath,
        file.getPath(), parameterMap, dataSource);

dataSource = null;
virtualizer.cleanup();

jasperPrint = (JasperPrint) JRLoader.loadObject(file);

compiledPath = null;
file = null;

pdfExporter = new JRPdfExporter();
pdfExporter.setParameter(JRExporterParameter.JASPER_PRINT,
    jasperPrint);
pdfExporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME,
    finalOutputfile.toString());

pdfExporter.exportReport(); 
```

任何关于如何在生成每个报告后清理内存的建议都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:19:44.403

不确定 pojo 或传统的 JSP Web 应用程序，但是对于我的 spring 应用程序，它曾经有同样的内存不足问题。我退出了跟踪日志并找到了很多关于渲染模板的信息。它让我记得这`jrxml`是一个预编译模板，而不是`.jasper`. 所以我替换了我所有的模板，然后内存不足的问题就再也不会发生了。请将此视为对@Joop Eggen 建议的补充。

# domain-driven-design - 与操作关闭的一些混淆

> ID：14714925
> 
> 赞同：1
> 
> 时间：2013-02-05T19:03:20.933
> 
> 标签：domain-driven-design

来自 DDD：解决软件核心的复杂性（第 268 页）：

> 如果实现者具有用于计算的状态，那么实现者实际上是操作的参数，因此参数和返回值应该与实现者的类型相同。这样的操作在该类型的实例集下是关闭的。

a）我知道制作相同类型的*参数*、*返回值*和*实现*者会简化对操作的解释，但作者是否建议即使从概念上讲，*参数*和*返回值*不属于同一类型（比如`ImplType`）更有意义作为实现者，我们仍然应该尝试强迫它们成为`ImplType`，即使这意味着我们必须牺牲一点概念上的清晰性？

b) 我的想法是，如果*参数*和*返回值*的类型更有意义，那么我们已经将它们定义为这样，即使我们*对操作闭包*及其好处`ImplType`一无所知。我们最初使它们具有不同类型的事实不应该表明在概念上它们不是类型更好吗？*`ImplType`*

 *谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T19:48:22.440

我认为关于关闭操作的关键引用是：

> **在合适**的地方，定义一个返回类型与其参数类型相同的操作。

这个想法是操作的关闭对行为建立了一些理想的限制，但它应该应用在它适合的地方。关于将状态视为操作参数的实现者的声明是基于 OOP 的实现方式。在幕后，运行时将初始化的**this**参数传递给所有类方法。这样，每个实现一个操作的方法都可以看作是一个静态方法，它接受实现类型作为第一个参数。以这种方式查看操作试图使有关它的所有内容都变得明确，从而减少依赖关系。

运算闭包的概念是专门从数学、抽象代数和群论中借来的。在数学中，作为一个纯粹的声明模型，这个原理比在企业开发中的应用要多得多，但是我们仍然可以从中获得一些好处。*

# html - FALLBACK 缓存清单不起作用

> ID：14714928
> 
> 赞同：1
> 
> 时间：2013-02-05T19:03:27.033
> 
> 标签：html, fallback

我是一名 asp.net 开发人员，我正在使用 HTML5 离线功能，但 FALLBACK 没有按预期工作：当服务器关闭时，列出的在 FALLBACK 中打开页面的页面显示为浏览器标准页面没有联系的。

在我尝试的清单文件中： FALLBACK: * /Default.htm

我试过了： FALLBACK: //Default.htm

当服务器关闭时，“default.html”页面永远不会打开。

我在 Google Chrome 和 Firefox 中尝试过，结果是一样的。

我做错了什么？有人可以帮助我吗？

问候， 卡洛斯·皮涅罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T23:10:30.963

我有一个类似的问题。在线跟踪每个资源，使我的清单工作的唯一细节是删除后备网址之前的前缀“/”。

在您的示例中，将 /Default.htm 更改为 Default.htm。

回退：/ Default.htm

# java - 监控数据库的连接数

> ID：14714933
> 
> 赞同：1
> 
> 时间：2013-02-05T19:03:47.470
> 
> 标签：java, mysql, hibernate, monitoring

我们使用休眠和 C3PO 进行连接。有时，数据库负载增加，我们开始面临问题。

我们如何在不超过池限制的情况下监控我们建立的连接数？

可以进行哪些其他监控来避免数据库负载？几个例子如下：

一种。线程数。

湾。CPU使用率。

C。剩余空间。

C。我不知道大量交易是否会导致任何问题。如果他们这样做，如何获得他们的计数。等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:16:55.307

可以通过 JMX 管理访问 c3p0 数据源。PooledDataSource有大量通过 JMX 公开的有趣操作[。](http://www.mchange.com/projects/c3p0/apidocs/com/mchange/v2/c3p0/PooledDataSource.html)

[有关通过 JMX 配置和管理 c3p0](http://www.mchange.com/projects/c3p0/index.html#jmx_configuration_and_management)的更多信息。

请不要让监控做它所做的事情，它会监控数据源的执行。监控并不能避免数据库上的负载。它可用于分析运行时性能并在适当时调整连接池。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:42:24.937

试试 JavaMelody - [http://code.google.com/p/javamelody/](http://code.google.com/p/javamelody/)

在许多其他有用的事情中，它可以报告使用的连接数。

# javascript - 本地图像到 base64 和 IE

> ID：14714935
> 
> 赞同：0
> 
> 时间：2013-02-05T19:04:12.993
> 
> 标签：javascript, image, internet-explorer, local

对于我正在编写的 wep 应用程序，我需要在不向服务器发送任何信息的情况下获取文件的 de base64 编码。我的一切都在 Firefox 和 chrome 上工作，但当然 IE 不工作。

代码如下：

```
1  $(document).ready(function() {
2      $("#in").change(load_picture);
3  });
4 
5  function loaded_picture(evt)
6  {
7      var data = evt.target.result;
8      $("body").append("<img src='"+data+"' width='100'  />");
9      console.log(data);
10 }
11 
12 function load_picture(evt)
13 {
14     console.log(evt);
15     var f = evt.target.files[0];
16     var reader = new FileReader();
17     reader.onload = loaded_picture;
18     reader.readAsDataURL(f);
19 } 
```

我正在使用最新的jquery，正文中有一个id =“#in”的文件类型输入框。

Firefox 就像一个魅力，但在 IE 中似乎没有 evt.target.files 数组。有没有办法在 IE 中做同样的事情？

坦克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:48:38.800

我可能是错的，但我认为您最好的选择是使用 Chrome 框架或类似[Dean](http://dean.edwards.name/weblog/2005/06/base64-sexy/) Edwards 的框架。由于 IE9- 版本不支持您正在寻找的功能。

# ruby - 如何强制 Ruby 字符串为 n 个字符

> ID：14714936
> 
> 赞同：54
> 
> 时间：2013-02-05T19:04:18.397
> 
> 标签：ruby, string, variables, string-length

如何强制使用最多`puts`n 个字符输出 Ruby 字符串变量，以便如果变量较长，它将被截断，如果较短，它将通过尾随或前导空格扩展？

有没有一些标准的方法来做到这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-02-05T19:10:12.137

Ruby 支持使用格式字符串，就像许多其他语言一样：

```
[11]（撬）主：0>'%3.3s'%'f'
=> "f"
[12] (pry) main: 0> '%3.3s' % 'foo'
=> “富”
[13] (pry) main: 0> '%3.3s' % 'foobar'
=> “富”

```

如果要在右侧填充，请`-`在格式字符串中使用 a：

```
[14]（撬）主：0>'%-3.3s'%'f'
=> "f"
[15]（撬）主要：0>'%-3.3s'%'foo'
=> “富”
[16] (pry) main: 0> '%-3.3s' % 'foobar'
=> “富”

```

您也可以使用`printf`or `sprintf`，但我更喜欢更通用[`%`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-25)的，例如[`sprintf`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-sprintf).

从`sprintf`文档：

```
  小号 | 参数是要替换的字符串。如果格式
      | 序列包含一个精度，最多多少个字符
      | 将被复制。

```

和：

```
- | 全部 | 左对齐此转换的结果。

```

* * *

> 如果我不想用空格而是用其他字符填充怎么办？

底层的 Ruby 代码是用 C 编写的，它被硬编码`' '`为填充字符，所以这是不可能的，除非你想修改源代码，重新编译你的 Ruby，并使用一次性版本的语言. 相反，您可以执行以下操作：

```
[17] (pry) main: 0> ('%-3.3s' % 'f').gsub(' ', '.')
=> “f..”

```

这比简单的要复杂得多`gsub`。如果您需要提供特殊字符，通常最好在不使用格式字符串的情况下调整字符串。格式字符串非常强大，但它们并不完全灵活。

否则，我会选择类似@steenslag 的解决方案，这是您自己的解决方案的基础。你失去了使用格式字符串的能力，不得不依靠连接你的字符串或类似的东西来获得列输出，但它也可以工作。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-02-05T19:24:41.960

使字符串固定长度**更短**：

```
 str_var.slice(0..10) # starts at the first letter 
```

使字符串固定长度**更长**：

```
 str_var.ljust(10, ' ') 
```

它们可以组合成类似的东西：

```
 (str_var.length > 10) ? str_var.slice(1..10) : str_var.ljust(10, ' ') 
```

`str_var`当然，你的字符串在哪里

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-05T19:37:09.820

```
class String
  def fix(size, padstr=' ')
    self[0...size].rjust(size, padstr) #or ljust
  end
end

p 'lettersletters'.fix(9) #=> "lettersle"
p 'letters'.fix(10, '.')  #=> "...letters" 
```

将`slice`方法（[]）与`rjust`.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-01-07T11:24:24.557

对于纯 Ruby one 班轮，您可以这样做：

```
(str + ' ' * length)[0,length] 
```

这将产生：

```
str = "Hello"
length = 10
=> "Hello     " 
```

或者：

```
str = "Hello"
length = 2
=> "He" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T19:15:15.217

If you're talking about a method to truncate strings I would check out [ActionView::Helpers::TextHelper#truncate](http://apidock.com/rails/v2.3.8/ActionView/Helpers/TextHelper/truncate)

From the examples:

```
truncate("Once upon a time in a world far far away")

# => Once upon a time in a world... 
```

# git - 我使用 GUI 工具重置丢失了我在 Git 上的所有工作，有没有办法恢复我的文件？

> ID：14714937
> 
> 赞同：2
> 
> 时间：2013-02-05T19:04:21.523
> 
> 标签：git, github

附上截图来说明我的意思。![2012 年 7 月 12 日至 2013 年 2 月 2 日](../Images/9c327240a8de2f43babd9c97923f0355.png)在这两个日期之间，我使用 GUI 工具丢失了所有工作，不知道如何恢复它们。有人可以帮忙吗？

**Git 日志**

```
commit eb64161f29fff57ab861880c4cd1cdf7641c39bf
Author: unknown <DIAMONS@DIAMONS-PC.(none)>
Date:   Fri Dec 7 02:00:10 2012 -0500

A

commit e7850a9c4218b8853b95fff72b08d81c9de1a493
Author: unknown <DIAMONS@DIAMONS-PC.(none)>
Date:   Fri Dec 7 01:59:09 2012 -0500

A

commit 76c81938af7ec183a306e5377ad503b84371dbc7
Author: unknown <DIAMONS@DIAMONS-PC.(none)>
Date:   Fri Dec 7 01:57:27 2012 -0500

A

commit a98041150974116addf1edb867c3481140a16633
Author: unknown <DIAMONS@DIAMONS-PC.(none)>
Date:   Fri Dec 7 01:56:23 2012 -0500

A 
```

**Git 参考日志**

```
eb64161 HEAD@{0}: checkout: moving from fe2772d3a363fc7ca348d936bd3a5ac97ccf9dc2
fe2772d HEAD@{1}: checkout: moving from 096491742d37c885ed93db2bb06b3fbe65b69499
0964917 HEAD@{2}: checkout: moving from 6eb9a8e66561d2e72b8391fec823df6d6999cceb
6eb9a8e HEAD@{3}: checkout: moving from master to 6eb9a8e
eb64161 HEAD@{4}: checkout: moving from 4d6a18311433a9bee737eda9bf6114f8bc35fa2c
4d6a183 HEAD@{5}: checkout: moving from 13a4a7e00c15986e07c48969f026afb2fe02f60b
13a4a7e HEAD@{6}: checkout: moving from 4374fecebf215eb868beb881af8909922d45e764
4374fec HEAD@{7}: checkout: moving from 49f004a3d08ee52ee24334c07fc9d35c40480dbb
49f004a HEAD@{8}: checkout: moving from 8e58a900f13132e0dcaa39ae980f7868184cbf65
8e58a90 HEAD@{9}: checkout: moving from 60299f452350c05d22e6bd703f1a7658112c171f
60299f4 HEAD@{10}: checkout: moving from 7e1ae4e7907f446d7d238741933509d4d64e071
7e1ae4e HEAD@{11}: checkout: moving from bec6e9bab96300e4a5d11b5fb1f381659bffe16
bec6e9b HEAD@{12}: checkout: moving from 60299f452350c05d22e6bd703f1a7658112c171
60299f4 HEAD@{13}: checkout: moving from 4d6a18311433a9bee737eda9bf6114f8bc35fa2
4d6a183 HEAD@{14}: checkout: moving from eb64161f29fff57ab861880c4cd1cdf7641c39b
eb64161 HEAD@{15}: checkout: moving from master to eb64161
eb64161 HEAD@{16}: checkout: moving from 4d6a18311433a9bee737eda9bf6114f8bc35fa2
4d6a183 HEAD@{17}: checkout: moving from master to HEAD@{3}
eb64161 HEAD@{18}: checkout: moving from eb64161f29fff57ab861880c4cd1cdf7641c39b
eb64161 HEAD@{19}: checkout: moving from master to master@{2013-01-19}
eb64161 HEAD@{20}: pull: Fast-forward
4d6a183 HEAD@{21}: checkout: moving from 7e1ae4e7907f446d7d238741933509d4d64e071
7e1ae4e HEAD@{22}: checkout: moving from 60299f452350c05d22e6bd703f1a7658112c171
60299f4 HEAD@{23}: checkout: moving from 8e58a900f13132e0dcaa39ae980f7868184cbf6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:45:31.227

Git 不会立即删除提交和其他对象。因此，如果您的数据已提交，您可以通过检查 last good commit 来获取它们。

浏览您发布的 reflog 并检查每个版本（从最新开始）。迟早你会发现你的数据有一个好的版本。然后将该提交标记为分支 ( `git checkout HASH -b my-lost-master`)。

**编辑1：**

另一种选择是以`git fsck --lost-found`与 reflog 相同的方式运行并检查其输出。

**编辑2：**

另一个救援工具是这样的：

```
git rev-list --objects --all \
| awk '{cmd="git cat-file -t "$1;cmd |& getline t; printf("%s %-7s %s\n", $1, t, $2); close(cmd);}' \
| less 
```

它将扫描整个 git 对象存储并在其中描述所有内容。您应该在那长长的列表中的某处看到您的文件。

# node.js - 在NodeJS中打开文件时没有国家字符

> ID：14714940
> 
> 赞同：0
> 
> 时间：2013-02-05T19:04:29.673
> 
> 标签：node.js, http, fs

我来自波兰。波兰语字符在 UTF-8 和 ISO 8859-2 编码中可用，但是当我打开文件时，站点内容中没有国家字符（ę、ó、ą、ś、ł、ż、ź、ń）。当我打开文件并发送到客户端时，这是我在 NodeJS 中的代码：

```
var include = function(path) {
    var code = fs.readFileSync(ROOT+path, 'ascii');
 return code;
}.bind(this); 
```

代码示例：

```
<!DOCTYPE html>
<html>
 <head>
     <title>Ninja World :: Strona główna</title>
   <meta http-equiv="content-type" content="text/html; charset=iso-8859-2" />
</head>
<body>
Cześć, tu Kongo i to jest próbny tekst stworzony dla Stack Overflow.
</body> 
```

（英语：嗨，我是 Kongo，它是为 Stack Overflow 创建的尝试文本。）此代码返回它（编码格式：ISO-8859-2）： [http](http://scr.hu/7wh/ntq98) ://scr.hu/7wh/ntq98 当我转换时UTF-8 这个代码返回它： [http](http://scr.hu/7wh/zva6s) ://scr.hu/7wh/zva6s （这是一个很好的结果；））任何人都可以帮助我展示我的国家字符吗？:)

PS：抱歉英语不好；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:20:20.663

那条线

```
var code = fs.readFileSync(ROOT+path, 'ascii'); 
```

我认为你应该使用 utf-8 编码而不是 ascii .. 你试过吗？

# mysql - 如何在我的 sql 中创建一元多对多关系

> ID：14714948
> 
> 赞同：0
> 
> 时间：2013-02-05T19:04:43.133
> 
> 标签：mysql, database, database-design

我知道如何创建多对多关系，但我专门寻找一元多对多关系。我可以查看任何想法或教程吗？还是真的很好的解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:18:39.443

真正做多对多一元关系与二元多对多关系并没有太大区别。您仍然需要一个连接表来表达多对多关系，但是这个连接表的列都将与单个主题表相关联。

一个典型的例子可能是电子商务环境中的产品捆绑包，其中产品捆绑包可能有自己的产品 ID，但也与该捆绑包中包含的一组产品相关。当然，任何产品都可以以任何方式捆绑（因此是多对多关系）。表结构可能如下所示：

```
product
---------
product_id (primary_key)
product_name
...other product attributes

bundle
---------
product_id (foreign key to product table)
product_component (also a foreign key to product table)
....any bundle specific attributes not derivable from component attributes 
```

类似地，应用程序中用户之间的关系（即“朋友”、“喜欢”等）也可以以类似的方式表达。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:11:53.007

就像多对多一样，您将需要连接表。例如：

您有 5 个表：TblA、TblB、TblC、TblD、TblE

他们每个人都有 id 作为 PK。

您创建带有字段的连接表：

援助、出价、Cid、Did、Eid

# android - 在 Nexus 4 上启动应用程序失败

> ID：14714950
> 
> 赞同：0
> 
> 时间：2013-02-05T19:04:54.633
> 
> 标签：android, nexus-4

我正在编写 ICS+ 应用程序，它在 Nexus S、Nexus Galaxy、Nexus 7、Galaxy Tab、Galaxy S3 和许多其他设备上运行良好。昨天我得到了 Nexus 4，应用程序在启动过程中崩溃了。

堆栈跟踪如下。我查看了源代码（android.view.ViewConfiguration），设备试图做的是获取褪色的选框资源 - 这里是

```
mFadingMarqueeEnabled = res.getBoolean(
            com.android.internal.R.bool.config_ui_enableFadingMarquee); 
```

有谁知道会发生什么？

```
02-04 17:54:09.727: E/AndroidRuntime(16932): java.lang.RuntimeException: Unable to start activity ComponentInfo{myapp/myapp.Main}: android.content.res.Resources$NotFoundException: Resource ID #0x1110013
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.os.Looper.loop(Looper.java:137)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread.main(ActivityThread.java:5039)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at java.lang.reflect.Method.invokeNative(Native Method)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at java.lang.reflect.Method.invoke(Method.java:511)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at dalvik.system.NativeStart.main(Native Method)
02-04 17:54:09.727: E/AndroidRuntime(16932): Caused by: android.content.res.Resources$NotFoundException: Resource ID #0x1110013
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.content.res.Resources.getValue(Resources.java:1014)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.content.res.Resources.getBoolean(Resources.java:796)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.view.ViewConfiguration.<init>(ViewConfiguration.java:301)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.view.ViewConfiguration.get(ViewConfiguration.java:323)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.view.View.<init>(View.java:3234)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.view.ViewGroup.<init>(ViewGroup.java:420)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.widget.FrameLayout.<init>(FrameLayout.java:93)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.policy.impl.PhoneWindow$DecorView.<init>(PhoneWindow.java:1816)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.policy.impl.PhoneWindow.generateDecor(PhoneWindow.java:2585)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.policy.impl.PhoneWindow.installDecor(PhoneWindow.java:2867)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at com.android.internal.policy.impl.PhoneWindow.getDecorView(PhoneWindow.java:1568)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.Activity.initActionBar(Activity.java:1861)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.Activity.getActionBar(Activity.java:1848)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at myapp.Main.onCreate(Main.java:75)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.Activity.performCreate(Activity.java:5104)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-04 17:54:09.727: E/AndroidRuntime(16932):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
02-04 17:54:09.727: E/AndroidRuntime(16932):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:18:11.200

我不会使用内部资源，因为看起来它们不是公开的（并且可能会发生变化）。

查看[The import com.android.internal.R cannot be resolved](https://stackoverflow.com/questions/8683411/the-import-com-android-internal-r-cannot-be-resolved)以获取有关如何使其以您想要的方式工作的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:11:49.803

似乎 LG Nexus 4 上安装的 android 框架缺少`com.android.internal.R.bool.config_ui_enableFadingMarquee`

# postgresql - 如何使用 psql 命令列出、创建、使用和检查数据库？

> ID：14714953
> 
> 赞同：24
> 
> 时间：2013-02-05T19:05:01.810
> 
> 标签：postgresql, psql

我是 postgreSQL 新手，我找不到任何关于使用 psql 命令的有用介绍。至少我认为这是我想要使用的命令。

在 postgreSQL 中是否可以简单地连接到服务器，然后列出、创建、使用和检查数据库？

我希望能够使用 psql 对 MySQL 执行类似的操作（我删除了许多额外的行）：

在不指定数据库的情况下进行连接 - 我似乎无法用 psql 做到这一点：

```
$ mysql -u root -prootpassword
Welcome to the MySQL monitor.  Commands end with ; or \g.
Server version: 5.5.28 MySQL Community Server (GPL) 
```

我可以使用 mysql 列出数据库，但 posgreSQL 命令 SHOW 似乎没有这样做。

```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| ocdp               |
| performance_schema |
| test               |
+--------------------+
5 rows in set (0.04 sec) 
```

我可以切换数据库。

```
mysql> use ocdp;
Database changed 
```

我无法在 psql 中弄清楚这个命令：

```
mysql> show tables;
+---------------------------------+
| Tables_in_ocdp                  |
+---------------------------------+
| OCAddresses                     |
| OCStreets                       |
+---------------------------------+
2 rows in set (0.00 sec) 
```

我想我可以用'createdb'和'dropdb'命令在psql中做到这一点：

```
mysql> create database foo;
Query OK, 1 row affected (0.00 sec)

mysql> drop database foo;
Query OK, 0 rows affected (0.03 sec) 
```

我使用 \quit

```
mysql> quit
Bye 
```

对于了解 postgreSQL 的人来说，这些问题的答案应该只需要一点时间，但我只是无法在任何地方找到说明如何执行这些简单操作的文档。也许我什至不应该为此使用 psql ？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-05T19:34:54.650

连接到服务器：

```
$ mysql -u root -prootpassword

$ su - postgres
$ psql 
```

列出数据库：

```
mysql> show databases;

postgres=# \l 
```

切换数据库：

```
mysql> use ocdp;

postgres=# \c ocdp 
```

显示表格：

```
mysql> show tables;

postgres=# \dt 
```

创建数据库：

```
mysql> create database foo;

postgres=# create database foo; 
```

删除数据库：

```
mysql> drop database foo;

postgres=# drop database foo; 
```

辞职：

```
mysql> quit

postgres=# \q 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-18T06:22:53.130

如果您使用的是 Mac-OS-X 和 postgres 9.4，请尝试使用此命令

psql --list

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:47:03.500

### *在不指定数据库的情况下进行连接 - 我似乎无法用 psql 做到这一点：*

[从手册中](http://www.postgresql.org/docs/current/static/app-psql.html)引用

> *默认用户名是您的 Unix 用户名，默认数据库名也是如此*

* * *

### *我可以切换数据库*

[从手册中](http://www.postgresql.org/docs/current/static/app-psql.html)引用

> *\connect [ dbname [ username ] [ host ] [ port ] ] 建立到 PostgreSQL 服务器的新连接*

* * *

### *显示表格*

[从手册中](http://www.postgresql.org/docs/current/static/app-psql.html)引用

> *\d[S+] [ pattern ] 对于每个关系（表、视图、索引、序列或外部表）或匹配模式的复合类型，显示所有列*

* * *

### *创建数据库 foo；*

这是 PostgreSQL 中的相同语句，[在手册中有记录](http://www.postgresql.org/docs/current/static/sql-createdatabase.html)

* * *

### *辞职*

[从手册中](http://www.postgresql.org/docs/current/static/app-psql.html)引用

> *\q 或 \quit 退出 psql 程序。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-22T04:44:43.600

带有终端的 Postgresql

进入postgresql

```
 sudo -u postgres psql 
```

在 postgresql 中查找数据库列表

```
 $ \l 
```

通过以下命令连接到数据库

```
 $ \c databasename 
```

查看数据库中的模型

```
 $ \dt 
```

现在显示数据库中存在的表列表并对表执行操作，例如

```
 $ select * from table; 
```

# ruby-on-rails - 如果我有多个数据库，“bundle exec rake db:migrate”如何工作？

> ID：14714954
> 
> 赞同：0
> 
> 时间：2013-02-05T19:05:08.137
> 
> 标签：ruby-on-rails, rake, dbmigrate

我是rails/ruby的新手。我有两个数据库，用于开发/测试的 sqlite 和用于生产/部署的 postgres。当我运行“bundle exec rake db:migrate”时，哪个数据库会使用我当前的数据模型、sqlite 或 postgres 进行更新？命令输出并没有说明它与之交互的数据库。啊。当我将代码推送到heroku时它不起作用，所以我假设更新的数据库是sqlite。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:12:55.953

在您的默认环境（通常是开发）下配置的数据库。

# iphone - 如何将 .h 和 .m 文件链接到 Xcode 4.5 中的新 ViewController？

> ID：14714957
> 
> 赞同：1
> 
> 时间：2013-02-05T19:05:16.597
> 
> 标签：iphone, ios, uiviewcontroller, storyboard

好的，所以我一直在阅读教程并浏览 StackOverflow，但我无法得到这个问题的答案。

我最近开始开发 iOS 应用程序（这是我的第一个）。我有一个标签栏控制器和 5 个不同的视图控制器。默认情况下，它带有 FirstViewController 和 SecondViewController，我可以在 StoryBoard 中修改它们的视图，并且我现在让它们“正常”工作。现在我的问题是如何将其他 3 个缺少的 ViewController 连接到它们各自的 .h 和 .m 文件？我尝试使用 XIB 用户界面创建一个新的 Objective-C 类，但我无法将该 XIB 文件连接到 MainStoryboard.storyboard 中的主选项卡栏控制器，所以我认为我遗漏了一些东西。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T19:06:35.113

不要混合使用 XIB 和故事板。您所要做的就是创建从没有 XIB 文件的 UIViewController 继承的类（在 h 和 m 文件中声明），并在情节提要的对象检查器中指定类名。文件的“链接”是通过在检查器中引用类名。

![在此处输入图像描述](../Images/e47f9e565270f5d8152bfc5aebd8b182.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-17T10:32:46.537

Stavash 的回答实际上是正确的，但你需要做更多的事情。

您必须将视图属性链接到相应文件的引用出口。

将类名链接到 xib 后，请执行以下操作。

在 xib 文件中选择视图控制器 -> 在连接检查器中 -> 拖动视图属性并将其连接到 xib 中的视图。

我希望这将有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:09:55.727

基本上从对象库中添加一个新的 ViewController，将其自定义类设置为您的视图控制器的类 (ThirdViewController)，最后将一个关系 segue 从您的标签栏控制器拖到这个新的视图控制器，它将嵌入到标签栏中。

# javascript - 编写将所有内容都包含在变量中的 Javascript 代码

> ID：14714963
> 
> 赞同：1
> 
> 时间：2013-02-05T19:05:31.090
> 
> 标签：javascript, jquery, cordova

我之前从正在查看的 PhoneGap/cordova 文件中遇到了这个问题：

```
 var app = {
    initialize: function() {
        this.bind();
    },
    bind: function() {
        document.addEventListener('deviceready', this.deviceready, false);
    },
    deviceready: function() {
        // This is an event handler function, which means the scope is the event.
        // So, we must explicitly called `app.report()` instead of `this.report()`.
        app.report('deviceready');
        app.handleLogin();
    },
  } 
```

我只是想知道这样做与在身体负载上执行的独立功能相比有什么好处？另外，如果我要在 jquery mobile 的“pagebeforeload”上运行一个函数，我将如何将其集成到上述模式中？如：

```
 $( '#mainMenu' ).live( 'pagebeforeshow', function(event){
    alert('pagebeforeshow');
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:13:41.210

简而言之，命名空间。

在 JavaScript 中，一切都是全局的，除非你明确地使它不是全局的。这意味着事物的名称可能会发生冲突，或者您可以覆盖您不想要的事物。在大型程序中这是一个大问题。

您将应用程序的所有功能显示在一个`app`“对象”中的命名空间模式。因此，在全局范围内覆盖的任何内容`bind`都不会影响`app.bind`. 命名空间保护它。

一个好的经验法则是尽可能少地污染全局命名空间。在这种情况下，你使`app`全局化，就是这样。您的所有代码都与该全局值挂钩。干净整洁。

* * *

至于如何整合你的例子。我可能会做这样的事情：

```
 var app = {
    initialize: function() {
        app.bindEventHandlers();
        // other setup code called here...
    },
    bindEventHandlers: function() {
        $( '#mainMenu' ).live( 'pagebeforeshow', app.pageBeforeShow );
        // other event handlers bound here...
    },
    pageBeforeShow: function() {
        alert('pagebeforeshow');
    },

    // other event handler functions declared here...
    // or whatever other functions or data your app needs here...
  }

  // start your app when the document is ready
  $(document).ready(function() {
    app.initialize();
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:16:56.560

如果您使用 OOP 语言，那么您就会知道类的定义。JS 不支持 class-keyword，因此要使用方法创建对象，应使用以下代码。然后你可以调用 app.initialize() 。它还可以为您提供应用程序架构中的高级功能。

要将您的代码集成到现有功能中，您应该原型化。

```
app.prototype = { nameOfFunctionHere: function() { alert('pagebeforeshow'); } } 
```

然后打电话

```
app.nameOfFunctionHere(); 
```

执行你的功能

# ios - 创建处理视图/按钮大小的逻辑

> ID：14714966
> 
> 赞同：0
> 
> 时间：2013-02-05T19:05:34.817
> 
> 标签：ios, ios5, uiview, uiscreen, mainscreen

我想根据主屏幕大小创建一些逻辑来处理子视图和一些按钮的视图大小。

所以我想做这样的事情：//发现主屏幕尺寸（这会因方向而异

//根据宽度除以3计算子视图大小

//根据主屏宽度计算按钮大小 //根据主屏大小宽度计算按钮左右间距padding，按钮宽度...

设置它的正确方法是什么？另外，我如何创建一个保存屏幕大小的对象/var/值，然后可以再次使用。理想情况下，我想在实现文件的顶部进行一次计算，并将变量多次用于应用程序中的不同按钮。所有这些都将以编程方式完成，而不是使用界面生成器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:49:34.507

您是否考虑过使用自动布局？. 它更干净，更容易指定大小关系。

# python - Pycrypto AES-CTR 实现

> ID：14714968
> 
> 赞同：3
> 
> 时间：2013-02-05T19:05:36.827
> 
> 标签：python, encryption, cryptography, aes, pycrypto

我是 python 和 pycrypto 的新手。我正在尝试实现 AES-CTR。为了检查我的程序是否正确加密，我尝试使用 NIST SP 800-38A 标准（第 F.5 节）中的测试序列。但我没有得到正确的结果。我究竟做错了什么？

```
from Crypto.Cipher import AES
from Crypto.Utils import Counter

CTRkey="2b7e151628aed2a6abf7158809cf4f3c"
ctr=Counter.new(128, initial_value=int("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff",16))
cipherCTR=AES.new(CTRkey, AES.MODE_CTR, counter=ctr)
print(cipherCTR.encrypt("f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff".decode("hex")).encode("hex")) 
```

结果：

```
0008007df81ad564b9aadd6b883fef16 
```

但预期的结果（*密文*）是：

```
874d6191b620e3261bef6864990db6ce 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T22:20:27.070

在 NIST SP 800-38A 标准（第 F.5.1 节）中，对 CTR-AES128 加密操作的输入称为*plaintext* not *input block*。

如果您使用*明文*( `6bc1bee22e409f96e93d7e117393172a`)，您会得到正确的结果，即*密文* `874d6191b620e3261bef6864990db6ce`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-15T08:48:43.760

我试过这个。

```
import Crypto.Cipher.AES
import Crypto.Util.Counter

import binascii

key = b'\x2b\x7e\x15\x16\x28\xae\xd2\xa6\xab\xf7\x15\x88\x09\xcf\x4f\x3c'
iv = b'\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff'
text = b'\x6b\xc1\xbe\xe2\x2e\x40\x9f\x96\xe9\x3d\x7e\x11\x73\x93\x17\x2a'

ctr = Crypto.Util.Counter.new(128, initial_value=int(binascii.hexlify(iv), 16))
cipher = Crypto.Cipher.AES.new(key, Crypto.Cipher.AES.MODE_CTR, counter=ctr)
print(cipher.encrypt(text).encode("hex")) 
```

得到结果

```
874d6191b620e3261bef6864990db6ce 
```

使用二进制数据对我有用，不推荐使用 str.encode("hex")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-24T13:16:16.823

除了使用 SquareRootOfTwentyThree 提到的适当的纯文本值之外，您还应该考虑代码中使用的数据类型。[PyCrypto 文档](https://pycryptodome.readthedocs.io/en/latest/src/cipher/classic.html#ctr-mode)建议密钥的数据类型为字节*，*而计数器的类型可以是*int*或*bytes*。

您将需要使用适当的数据类型来获取 NIST SP 800-38A 中提到的密文。Kameel 的代码有效，我也将代码包含在我的答案中。

```
from Crypto.Cipher import AES
import Crypto.Utils.Counter
import binascii

CTRkey     = b'\x2b\x7e\x15\x16\x28\xae\xd2\xa6\xab\xf7\x15\x88\x09\xcf\x4f\x3c'
iv         = b'\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff'
plain_text = b'\x6b\xc1\xbe\xe2\x2e\x40\x9f\x96\xe9\x3d\x7e\x11\x73\x93\x17\x2a'

ctr       = Crypto.UtilsCounter.new(128, initial_value=int(binascii.hexlify(iv), 16))
cipherCTR = AES.new(CTRkey, AES.MODE_CTR, counter=ctr)
print(cipherCTR.encrypt(plain_text).encode("hex")) 
```

# php - 无法从 REST CLIENT PHP 或 Mozilla Rest Client 访问 WCF REST API POST METHOD

> ID：14714971
> 
> 赞同：0
> 
> 时间：2013-02-05T19:05:49.883
> 
> 标签：php, wcf, rest, post, service

我使用 WCF 创建 Web 服务，但无法从 PHP 或 Mozilla Client Rest API 访问 POST 方法。我尝试更改 bodyStyle 并且不声明它，但我无法完成它。我总是收到 400 错误请求。GET 方法正在工作。这是我的定义：

```
[OperationContract]
        [WebInvoke(Method = "POST",
            UriTemplate = "/InsertMember",
            RequestFormat = WebMessageFormat.Json,
            ResponseFormat = WebMessageFormat.Json,
            BodyStyle = WebMessageBodyStyle.Wrapped)]
        InsertMemberResponse InsertMember(string city, string address, string state, string zipcode, string country_code, string email, string firtname, string lastname, string password, string national_document_id, string phone, string restaurant_id, string birthday,bool email_checked, bool want_adverts, bool want_notifications, bool want_offers, bool want_thidparty_offers, bool want_newletter, string company_name,string auth ); 
```

我的服务模式：

```
<system.serviceModel>
<services>
  <service name="Mellizos.Fidelidad.Services.RestService">
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:8733/Design_Time_Addresses/Mellizos.Fidelidad.Services/Service1/" />
      </baseAddresses>
    </host>
    <!-- Service Endpoints -->
    <!-- Unless fully qualified, address is relative to base address supplied above -->
    <endpoint address="" binding="basicHttpBinding" contract="Mellizos.Fidelidad.Services.IRestService">
      <!-- 
          Upon deployment, the following identity element should be removed or replaced to reflect the 
          identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
          automatically.
      -->
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <!-- Metadata Endpoints -->
    <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. -->
    <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior>
      <!-- To avoid disclosing metadata information, 
      set the value below to false before deployment -->
      <serviceMetadata httpGetEnabled="True" />
      <!-- To receive exception details in faults for debugging purposes, 
      set the value below to true.  Set to false before deployment 
      to avoid disclosing exception information -->
      <serviceDebug includeExceptionDetailInFaults="False" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:06:22.493

我终于在 MVC4 上更改为 Web Api 并且没有更多问题。

最后，我得到了一个理论解释，即在 WCF 中有一个使用协议的协商，它解决了所有问题。

# c# - 我需要将 asp.net fileupload 的值获取到 Ajax 参数中

> ID：14714976
> 
> 赞同：0
> 
> 时间：2013-02-05T19:06:07.080
> 
> 标签：c#, javascript, jquery, asp.net, ajax

我需要将 asp.net fileupload 的值获取到 Ajax 参数中，我正在尝试这样做：

```
$('#<%=fileUpload.ClientID%>').val() 

//and in the WebMethod  
[WebMethod]
public static List<AjaxCategory> AddCategory(FileUpload categoryImage) 
```

我不知道这是否可能，但是这样不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:29:51.723

异步文件上传需要一些额外的设置。考虑使用如下实用程序：

*   AJAX 控制工具包[AsyncFileUpload](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/AsyncFileUpload/AsyncFileUpload.aspx)
*   [上传](http://www.uploadify.com/)
*   HTML 5[文件 API](http://www.html5rocks.com/en/features/file_access)（也在[这里](http://www.sitepoint.com/html5-file-drag-and-drop/)）
*   其他

# django - 自定义身份验证后端使我无法在 django 中使用管理页面

> ID：14714986
> 
> 赞同：0
> 
> 时间：2013-02-05T19:06:45.473
> 
> 标签：django, authentication, admin

我无法登录到管理页面。在 setting.py 中删除以下语句后，我可以照常登录。

AUTHENTICATION_BACKENDS = ('chula.models.MyCustomBackend', )

这是这个 authen 后端来自 [http://www.djangorocks.com/tutorials/creating-a-custom-authentication-backend/creating-the-imap-authentication-backend.html的来源](http://www.djangorocks.com/tutorials/creating-a-custom-authentication-backend/creating-the-imap-authentication-backend.html)

我想同时使用这个 authen bakend 和管理页面。谁能帮我 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:15:29.540

`AUTHENTICATION_BACKENDS`应该包含**所有**要使用的身份验证后端。因此，如果您想使用默认后端以及自定义后端，您应该同时指定它们：

```
AUTHENTICATION_BACKENDS = (
    'django.contrib.auth.backends.ModelBackend',
    'chula.models.MyCustomBackend',
)

```

有关详细信息，请参阅有关[指定身份验证后端](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#specifying-authentication-backends)的文档。

# java - 使用 Spring 注释为每个枚举值创建一个 bean

> ID：14714987
> 
> 赞同：0
> 
> 时间：2013-02-05T19:06:48.977
> 
> 标签：java, spring

有没有一种优雅的方法来创建多个相同类型的 bean 实例，每个实例都根据枚举值进行参数化？例如：

```
//MyEnum.java
enum MyEnum
{
 VALUE1,
 VALUE2;
}

//MyClass.java
class MyClass
{
  MyClass(MyEnum myEnum){ ... }
}

//Context.java
@Configuration
class Configuration
{
  @Bean
  public MyClass myClass1()
  {
    return new MyClass(MyEnum.VALUE1);
  }

  @Bean
  public MyClass myClass2()
  {
    return new MyClass(MyEnum.VALUE2);
  }
} 
```

有没有比为每个枚举值显式创建一个新 bean 更好的方法？请注意，bean 的名称并不重要，因为稍后我将使用 getBeanNamesForType(MyClass.class) 从它们中进行搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T19:00:03.413

我讨厌回答我自己的问题。我能够使用 DefaultListableBeanFactory 实现我想要的。

```
@Bean
public ApplicationContextAware pseudoFactory()
{
return new ApplicationContextAware()
  {
    @Override
    public void setApplicationContext( ApplicationContext ac )
    {
      GenericApplicationContext gac = (GenericApplicationContext) ac;

      DefaultListableBeanFactory beanFactory = (DefaultListableBeanFactory) gac.getBeanFactory();

      for( EnumType enumType : EnumType.values())
      {
        ParameterizedClass pc = new ParameterizedClass(enumType);

        String beanName = enumType.getName() + "ParameterizedClass";

        beanFactory.registerSingleton(beanName, pc);
      }
    }
  };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:14:27.283

最简单的方法是返回一个`List<MyEnum>`：

```
@Bean
public List<MyEnum> myEnums() {
    return Arrays.asList(MyEnum.values());
} 
```

您不能使用`@Autowired`注入，但`@Resource`只要您按名称执行它就可以工作（在[Spring Reference](http://static.springsource.org/spring/docs/2.5.x/reference/beans.html#beans-autowired-annotation-qualifiers)中有更多信息）：

```
@Resource(name = "myEnums") List<MyEnum> enumValues; 
```

您显然可以对任何 bean 列表使用相同的方法。

# batch-file - 如何使用批处理命令检查文件中是否存在行？

> ID：14714989
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:03.340
> 
> 标签：batch-file

我有一个文本文件，其中有一些文本。我想使用批处理命令检查文本文件中是否存在“系统找不到指定的文件”。

我已经尝试在我的本地机器上使用 FINDSTR 命令，它按预期工作。但是当我在远程机器上尝试它时，即使文本文件中不存在该字符串，它也总是显示匹配。

下面是我的代码：

```
--> Getting the latest folder in a directory.

FOR /F "delims=" %%i IN ('dir /b /ad-h /o "\\BuildServer\xyz_build\Daily Build (Main)\"') DO (
    SET a=%%i
)

findstr /c:"The system cannot find the file specified" "F:\Deploy\FreshBuild\%a%.txt" (where %a% is the file name)
    if %errorlevel%==0 (
    ECHO String exists.
) 
```

仅供参考：我通过回显“F:\Deploy\FreshBuild\%a%.txt”路径检查了文件路径。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:31:31.740

首先，听起来您正在检查文件是否存在。您可以使用：

```
if exist {insert file name here} (
    rem file exists
) else (
    rem file doesn't exist
) 
```

接下来，如果将其更改`SET a=%%i`为`ECHO a=%%i`. （你的文件夹出现了吗？）

之后，您的 findstr 发生在循环之外。所以它只会检查 a 的最后一个值，对吗？这似乎不是你的意图。

# xcode - 为什么在查看 xib 时 Xcode 仍然显示旧的对象库？

> ID：14714990
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:03.647
> 
> 标签：xcode, xcode4.6

随着 Xcode 的最新更新，有一个更新的对象库。当我打开我的项目时，我转到我的 .m 文件，当我打开实用程序窗格时，它会显示新的对象库。但是当我单击我的 .xib 文件以实际更改 UI 时，它会返回到旧的对象库，并且不会显示更新的对象。

我无法找到有关可能出现问题或如何解决问题的任何信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T17:42:31.470

我意识到我看到的这些对象实际上是用于 Mac 开发而不是 iOS 开发。愚蠢的错误！

# javascript - 将两个图像绘制到 HTML5 Canvas

> ID：14714993
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:14.740
> 
> 标签：javascript, html, canvas

目前我正在制作一个色度键 HTML5 相机测试应用程序。

[http://jsfiddle.net/XuScp/](http://jsfiddle.net/XuScp/)

目前它有点工作（它会在你的背景中选择绿色并像任何其他色度键一样将其删除，目前我取出绿色并将其替换为一种灰色作为我目前拥有的背景）。

我遇到的问题是在与相机所在的同一画布中绘制背景。目前它绘制到画布上，但是一旦加载了相机，图像就会消失，我猜它正在被相机取代。

```
var bckg;
    bckg = new Image();
    bckg.src = 'https://raw.github.com/haywars/greenscreen/master/cambackgrounds/background1.jpg';
    function getImage(url){
        bckg= new Image();
        bckg.src = url;
    };

var processes = {
    timerCallback: function() {
        if (this.myVideo.paused || this.myVideo.ended) {
            return;
        }
        this.ctxInput.drawImage(this.myVideo, 0, 0, this.width, this.height);
        this.pixelScan();
        var self = this;
        setTimeout(function () {
            self.timerCallback();
        }, 0);
    },

    doLoad: function() {
        var video = document.querySelector('video');
        var canvas = document.querySelector('canvas');
        var ctx = canvas.getContext('2d');
        this.myVideo = document.getElementById("myVideo");
        this.cInput = document.getElementById("cInput");
        this.ctxInput = this.cInput.getContext("2d");
        this.cOutput = document.getElementById("cOutput");
        this.ctxOutput = this.cOutput.getContext("2d");
        var self = this;
        this.ctxOutput.drawImage(bckg,0,0);
        this.myVideo.addEventListener("playing", function() {
            self.width = self.myVideo.videoWidth;
            self.height = self.myVideo.videoHeight;
            self.timerCallback();
        }, false);
    },
    pixelScan: function() {
        var frame = this.ctxInput.getImageData(0, 0, this.width, this.height);
        for (var i = 0; i < frame.data.length; i++) {
            var r = frame.data[i];
            var g = frame.data[i+1];
            var b = frame.data[i+2];
            if (g > 0 && r > 50   && r < 165 && b < 60)
            frame.data[i + 3] = 0;
        }
        this.ctxOutput.putImageData(frame, 0, 0);

        //var img= new Image();
        //img.src = "images/cambackgrounds/background1.jpg";
        //this.ctxOutput.putImageData(img, 0, 0);
        return;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T03:22:41.873

据我所知，您只绘制`this.ctxOutput.drawImage(bckg,0,0);`一次背景（），那是在`doLoad`函数期间。您的循环确实将更改后的视频绘制到`ctxOutput`看似正确的位置，它只是不会在下一个循环中重新绘制背景。这可能是原因。

还，

我不会为每个循环绘制背景，而是使用 Image 或 Canvas 元素将图像简单地放在主画布后面。您已经使绿色像素透明，因此您应该能够通过主画布看到所有内容。我可能会从设置每个的 z-index 开始，并且可能将它们`style.position`的 s 设置为`'absolute'`以确保一个正好在另一个后面。

这将消除由于在每个循环中将背景图像绘制到同一画布而导致的任何延迟。

我遇到过多个建议使用画布分层的教程和基准测试。背景通常是静态的，所以为什么要不断更新它。只需让它成为自己的画布。一层在另一层之上，每个都包含某些类型的元素（静态、匀速运动、独立运动等）以确保最佳性能。

我希望这会有所帮助！

真挚地，

疯狂的人

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T05:47:59.240

@shayward - 我同意@TheCrzyMan，使用隐藏和显示画布标签来着色键

我相信你已经看过这个[mozilla tut on chroma key 了](https://developer.mozilla.org/samples/video/chroma-key/index.xhtml)。

Jeffrey Burtoft 对此也有一个[循序渐进的步骤](http://tech.pro/tutorial/1281/chroma-key-video-effects-using-javascript-and-the-html5-canvas-element)。

希望这可以帮助。

# microcontroller - 发送UART中断

> ID：14714995
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:25.900
> 
> 标签：microcontroller, uart, gpio

我需要与需要 UART 在其 RXD 引脚（我的 TXD）上中断 1 秒的芯片交谈。

我使用 ZW0301 控制器，它的 UART 控制器**不**支持中断命令。是否可以*模拟*break 命令？禁用 UART 控制器（将引脚置于 GPIO 模式）并将 TXD 置于低电平可能就足够了。或者这行不通？

一个好的描述的链接表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T14:34:50.890

是的，正如 Joachim 所说，将 TXD 拉低超过字符时间会起作用。是的，这些引脚需要处于 GPIO 模式才能工作。

生成中断的另一个选项是设置较低的波特率，并发送 0 字符。（因此对于 >1 个字符，TXD 会很低），但对于您的情况，这并不是一个真正的选择。

对于 1 秒的中断条件，您几乎肯定必须采用 GPIO 方式。

# jquery - 在ajax调用循环中使用jQuery更新页面元素

> ID：14714996
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:28.373
> 
> 标签：jquery, ajax, wordpress

我正在尝试创建一个 jquery 函数，它将 XML 数据导入到 wordpress 站点。在此过程中，我希望它单独导入帖子，然后在每次导入完成时更新进度条和/或计数器。

我遇到的问题是进度更新似乎都被推迟了，直到整个过程完成，然后同时更新。

例如：不是用 1/100 完成，然后 2/100 完成来更新页面，而是等待到最后，然后同时添加所有 100 个更新。

希望我的代码能比我更好地解释它：S

```
// Send inital data to check XML feed
$.ajax({
    url: ajaxurl,
    type: 'POST',
    data: ajaxdata
}).done( function(response) {

    ...

    // Process XML data
    $('#progress').html('<h3>Import Progress</h3><p id="import_status"></p>');

    data2 = $("#form_name").serialize();

    finished = false;
    count = 0;

    while (!finished) {

        var ajax = $.ajax({
            url: ajaxurl,
            data: data2,
            type: 'POST',
            async: false
        }).done(
            function(response2) {
                if (response2 == 0) {
                    finished = true;
                } else {
                    count++;
                    split = response2.toString().split("::");
                    $('#progress').append('<p><strong>Item'+count+'/'+split[0]+'</strong><br/><strong>Status:</strong> '+split[1]+'</p>');
                    if (count >= split[0]) {
                        finished = true;
                    }
                }
            }
        );

    } // while

    $('#progress').append('<p>Import Complete!</p>');

    ...

} 
```

ajaxurl 的 php 文件在正确的位置返回它应该返回的内容。对于上下文，在 while 循环期间，php 文件返回如下字符串：

```
 100::Some Status Information 
```

其中 100 是将返回的总行数。

循环运行正确的次数并在完成时输出所有正确的信息......但它不会逐项输出......它同时输出所有信息。

我错过了什么？我怎样才能让它分别输出每个项目的状态报告？

谢谢你的尽心帮助。

编辑：只是一些额外的信息，`<h3>ImportProgress</h3>`直到while循环完成后才会出现！全部出现一次！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:15:10.397

据我了解，Javascript 在单个线程中运行，因此`while`迭代会阻止页面的执行和呈现。

为了在进程运行时显示 Javascript 的进度，您应该重构代码，以下答案显示了一种方法：[显示 javascript 执行进度](https://stackoverflow.com/questions/2995805/show-javascript-execution-progress)。

希望能帮助到你。

# javascript - Mustache.js：大型 JSON 字典和较小的已知条目列表以随机显示？

> ID：14714997
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:31.067
> 
> 标签：javascript, templates, handlebars.js, mustache

我刚开始使用 mustache.js，我有我的 json 字典、我的 html 模板和我的 mustache.js 启动代码来注入整个。我的 html-mustache 模板是这样的：

```
<script id="tpl" type="text/html">
    <div class="body">
        <p>{{口.zht}}</p>
        <p>{{口.sam.pyn}}</p>
        <p>{{口.sam.fra}}</p>
    </div>
</script> 
```

在我的具有给定现有条目“口”的测试用例中，它可以工作（[1](http://jsfiddle.net/hugolpz/jKQUM/6/)）。但我注意到 Mustache 似乎旨在迭代**所有**JSON 条目。但是，我想处理一个小的焦点列表条目

```
var focusList = ['們','火山口','火']; 
```

我想从我的较大（约 1000 个条目）JSON 字典中选择相应的数据。

**如何根据我的 focusList 更改或制作变量 {{#口}} 和 {{/口}}，以便我可以使用正确的数据打印我的模板？**

模板中是否有某些类型的变量，例如：

```
<script id="tpl" type="text/html">
    <div class="body">
        <p>{{{{entry}}.zht}}</p>
        <p>{{{{entry}}.sam.pyn}}</p>
        <p>{{{{entry}}.sam.fra}}</p>
    </div>
</script> 
```

在 JS 中我添加：

```
var entry = focusList[Math.floor(Math.random() * focusList.length)]] 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T09:12:31.177

**解决方案：给定一个小的键列表，从较大的 JSON 数据中打印相关条目：**

```
//1\. Suggest a smaller custom list of keys existing in the larger data. 2\. Randomize.
var focusList = ['們','火山口','火'];
var randomKey = focusList[Math.floor(Math.random() * focusList.length)];
//3\. variable + Template + variable. 4\. printing.
var template = ('{{#'+ randomKey +'}}'+ $('#tpl').html() +'{{/'+randomKey+'}}'); // as {{#火}} ... {{/火}}
var output = Mustache.render(template, myBigJSON);
$('#main').append(output) 
```

**或者 1：您还可以使用 Object.keys (** [2](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys) )获取整个条目列表，以**从 WHOLE 列表中打印一个随机条目：**

```
//1\. Get and create the list of all keys
var focusList = Object.keys(myBigJSON); 
```

**最后，您可以打乱****[给定的列表](https://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array-in-javascript/6274381#6274381)****并****[系统地迭代打乱的列表以系统](https://stackoverflow.com/questions/14697371/how-to-retrieve-random-json-object-by-key-from-json-dictionary#14697612)****地打印每个项目**，而不是随机化和循环可能会重复一些条目。