# StackOverflow 问答 14467000-14467999

# eclipse - 如何在 Delphi 2010 IDE 中模拟 Eclipse Preferences Windows

> ID：14467001
> 
> 赞同：2
> 
> 时间：2013-01-22T20:00:10.167
> 
> 标签：eclipse, delphi, user-interface, interface

我是德尔福的新手。我真的很想在我的公司遗留系统（今天使用'Delphi 2010'）中构建一个Preferences Windows，就像Eclipse 的一样。 ![日食截图](../Images/c6c6585a93321ea75a4323d5175fa4aa.png)

我已经可以模仿几乎所有的项目：

将整个屏幕分为 3 个面板（一个在左侧，一个在右侧，一个在底部），在左侧面板内的 TTreeView 上，以及右侧面板上的一个 TScrollBox 以便能够滚动内容，如果他们不这样做' t 出于任何原因（显示器分辨率低或选项过多）都无法安装在窗口上。甚至在右侧面板和左侧面板之间使用了 TSplitter。

这是我能得到的： ![我的应用程序的屏幕截图](../Images/05b3dfad034ed6b8ae73f025f0866123.png)

我的疑问是：一旦选择了 TreeView 中的项目，我应该怎么做才能加载多个选项？我应该使用哪个 delphi 组件来模仿右侧面板中的所有这些信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:47:39.623

使用[`TPageControl`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TPageControl). [`TTabSheet`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TTabSheet)为您计划拥有的每组控件添加一个- 为树控件中的每个项目添加一个。为每个工作表设置[`TabVisible := False`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TTabSheet.TabVisible)以防止选项卡出现在页面控件的顶部。每次选择树控件中的项目时，通过设置页面控件的[`ActivePage`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ComCtrls.TPageControl.ActivePage)属性使相应的选项卡表可见。根据与工作表类别关联的首选项，在工作表上放置控件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T20:48:13.480

为每一页制作一个[框架。](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.Forms.TFrame)这是一种您可以直观地设计的“子表单”。在运行时在树视图的适当事件处理程序中创建和销毁它们。

# android - Android 如何将 SqlCipher 与预捆绑的 Sqllite 数据库一起使用？

> ID：14467005
> 
> 赞同：0
> 
> 时间：2013-01-22T20:00:28.677
> 
> 标签：android, database, sqlite, encryption, sqlcipher

我正在创建一个带有预捆绑数据库的应用程序，我正在使用本教程来实现相同的目标，

[http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

现在我应该如何使用 SQLcipher 保护这个预捆绑数据库？与 sqlcipher 教程一样，它假定您正在创建一个新数据库而不是使用现有数据库。

我的目标是防止任何人看到我的预捆绑数据库的内容。

这个问题有一些技巧，但对这个人不起作用

[使用 sqlcipher 加密已经存在的数据库并在 android 上打开它](https://stackoverflow.com/questions/13443093/using-sqlcipher-to-encrypt-already-existing-database-and-opening-it-on-android)

谢谢普拉内

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:04:03.677

> 我的目标是防止任何人看到我的预捆绑数据库的内容。

那就不要打扰了。任何人都可以从您的 APK 中获取您的加密密钥并解密数据库。SQLCipher 是为了帮助*用户*保护*用户的*数据免受攻击。

如果您不希望用户访问数据，请不要将数据放在他们的设备上。

# php - 将 id 存储为 RDMS 中的逗号分隔字符串是否有任何性能原因？

> ID：14467007
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:00:39.130
> 
> 标签：php, mysql, database-design

> **可能重复：**
> [在数据库列中存储分隔列表真的那么糟糕吗？](https://stackoverflow.com/questions/3653462/is-storing-a-delimited-list-in-a-database-column-really-that-bad)

我一直在处理几个 PHP/MySQL 项目，其中所有关系都存储为逗号分隔的字符串。

例如，一个共同的关系就像

（在伪代码中）

```
table people
id - integer
name - string
age - integer
teams - string (CSV OF integers, ex '1,3,9,21')

table teams
name - String
id - integer 
```

管理关系变得很麻烦。

要为一个人获取所有团队：

`$person = 'SELECT * FROM People WHERE id= x';`

然后在php中我一直在做类似的事情

```
$person['teams'] = SELECT * FROM teams WHERE id IN ($person['teams']); 
```

当我写这篇文章时，我意识到我可以将它们组合在一个 mysql 查询中，比如：

```
SELECT 
  people.id, 
  people.name, 
  people.teams, 
  teams.name 
FROM people 
JOIN teams ON FIND_IN_SET(teams.id, people.teams) WHERE people.id=x 
```

使用这种类型的设置，我发现自己`FIND_IN_SET`经常使用

最后，我的问题是：**创建这样的关系是否有性能优势？**

到目前为止，根据我的经验，FIND_IN_SET 通常会进行全表扫描。如果没有性能优势，**在哪些情况下使用逗号分隔的整数列表是有益的？** 似乎 mysql 设计者在创建 FIND_IN_SET 时有一些想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T20:13:04.570

没错，FIND_IN_SET() 不能使用索引，因此会导致全表扫描。从技术上讲，该功能是关系数据库的虚假操作，但毫无疑问对它有很多需求，因此 MySQL 实现了它。

将数据存储在逗号分隔的列表中是非**规范化**的一个示例。任何与规范化设计的偏离*都可以*提高一种查询的性能，但通常以针对相同数据的所有其他类型的查询为代价。

例如，如果您将球员和他们的球队存储为逗号分隔的列表，则无需加入即可轻松获取给定球员的球队列表。这是一个性能改进。但是获取给定球员球队的详细信息要困难得多。同样搜索给定球队的所有球员。

仅当该列表被视为离散的“黑盒”数据时，才使用逗号分隔的列表。即，您的应用程序需要将该列表作为一个整体来获取，而不是列表的子集，并且您永远不需要编写 SQL 来使用该列表中的元素进行搜索、连接、排序、小计等。

另请参阅我对[在数据库列中存储分隔列表真的那么糟糕吗？](https://stackoverflow.com/questions/3653462/is-storing-a-delimited-list-in-a-database-column-really-that-bad/3653574#3653574)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:06:48.653

表扫描在任何时候都不能被视为一种好处。

此外，据我在学校的记忆，它打破了常规形式（[http://en.wikipedia.org/wiki/Database_normalization ）。](http://en.wikipedia.org/wiki/Database_normalization)

我认为将所有主/外键列编入索引以提高性能是一种很好的做法。

在这种情况下，我唯一的想法是礼貌地询问特定项目的架构师他的解决方案背后的想法，并解释他/她背后的性能灾难:)

# ios - 删除文件后，iOS 仍然可以引用文件

> ID：14467008
> 
> 赞同：2
> 
> 时间：2013-01-22T20:00:39.637
> 
> 标签：ios, uiimage

问这个问题我觉得很愚蠢，但我花了大约两个小时试图弄清楚。我有一堆图片包含在我的 xcode 项目中。我将它们命名为`background1.png`,`background2.png`等`background3.png`。我正在重命名并弄乱照片的编号等等，由于某种原因，当我运行我的代码并打电话给我时，`[UIImage imagenamed @"background7.png"]`我得到了`background9.png`代替。所以我想我的项目中有重复的图像。

我删除了我可以在我的项目中找到的所有背景图像。当我运行代码时，即使我认为它们应该都消失了，这些图像仍然出现。我打开查找器并删除了`background*.png`我在整个计算机上可以找到的任何引用，我尝试将项目移动到不同的目录，它仍然可以找到这些照片。我想也许模拟器/手机正在缓存图像，所以我删除了应用程序，没有帮助。关于这些图像可能隐藏在哪里我无法在任何地方找到它们但它们仍然可以被引用的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:02:44.717

您需要遵循两个简单的步骤：-

1.  清理你的项目。（Xcode->产品->清理）
2.  从设备/模拟器中删除应用程序

再次运行。

希望这可以帮助你..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:04:13.707

您需要再次清理并构建项目。按`command`+ `shift`+`K`然后再次运行 ( `command`+ `R`) 代码。您也可以尝试重置模拟器或从那里删除应用程序。如果您使用的是设备，则可以从那里删除该应用程序。

# jsf-2 - 托管 Bean 的上下文初始化参数

> ID：14467013
> 
> 赞同：1
> 
> 时间：2013-01-22T20:00:53.890
> 
> 标签：jsf-2, el, oracle-adf, jdeveloper, adfc-config

# 背景

托管 bean 必须通过其 web.xml 文件配置参数。web.xml 文件定义了在 JDeveloper (11.1.2.3) 中配置的上下文初始化参数，如下所示：

![在此处输入图像描述](../Images/9cab274ac7e6d21974431a2d867d9a66.png)

定义的来源`reporting.server.protocol`如下：

```
 <context-param>
    <description>Defines the data transport mechanism to ret...</description>
    <param-name>reporting.server.protocol</param-name>
    <param-value>http</param-value>
  </context-param> 
```

bean 为`reportServerProtocol`.

bean 的来源类似于：

```
@ManagedBean
@RequestScoped
public class OracleReportBean extends ReportBean {

  @ManagedProperty("#{initParam['reporting.server.protocol']}")
  private String reportServerProtocol = URLReportImpl.DEFAULT_PROTOCOL;

  // ...
} 
```

# 问题

我想使用上下文初始化参数来初始化 bean，而不是通过[FacesContext](https://stackoverflow.com/a/4533483/59087)。在`adfc-config.xml`（注：不是`faces-confg.xml`）中，一些示例显示了对 的引用`initParam`：

```
<managed-bean>
  <managed-bean-name>reportBean</managed-bean-name>
  <managed-bean-class>ca.corp.report.view.OracleReportBean</managed-bean-class>
  <managed-bean-scope>request</managed-bean-scope>
  <managed-property>
    <property-name>reportServerProtocol</property-name>
    <property-class>java.lang.String</property-class>
    <value>#{initParam['reporting.server.protocol']}</value>
  </managed-property>
...
</managed-bean> 
```

关键线是价值元素`#{initParam['reporting.server.protocol']}`。但是，JDeveloper 显示该行不正确。也就是说，`initParam`上下文在`adfc-confing.xml`.

错误是：“EL 令牌`initParam`未知。”

# 问题

使用[EL](http://en.wikipedia.org/wiki/Unified_Expression_Language)，如何使用上下文初始化参数来配置托管 bean，在 ADFc 中以声明方式？

# 相关链接

*   [如何通过@ManagedProperty 注解注入整个托管bean？](https://stackoverflow.com/questions/5165567/how-to-inject-entire-managed-bean-via-managedproperty-annotation)
*   [http://balusc.blogspot.ca/2011/09/communication-in-jsf-20.html](http://balusc.blogspot.ca/2011/09/communication-in-jsf-20.html)
*   [https://stackoverflow.com/tags/el/info](https://stackoverflow.com/tags/el/info)
*   [http://www.oracle.com/technetwork/developer-tools/adf/learnmore/43-remote-task-flow-169185.pdf](http://www.oracle.com/technetwork/developer-tools/adf/learnmore/43-remote-task-flow-169185.pdf)
*   [http://docs.oracle.com/cd/E25178_01/web.1111/b31974/taskflows_activities.htm](http://docs.oracle.com/cd/E25178_01/web.1111/b31974/taskflows_activities.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T18:21:37.377

JDeveloper 中的一个错误会导致显示错误：

![JDeveloper 错误](../Images/c762290b6c3f273623a24138bd7d8c64.png)

但是，即使 IDE 显示错误，代码也会按预期执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T12:17:44.170

在 ui 层你可以尝试这样的事情：

```
<c:set target="${BeanName}" property="PropertyName" value="${true}"/> 
```

# nuget - Hammock.dll 有什么作用？

> ID：14467022
> 
> 赞同：0
> 
> 时间：2013-01-22T20:01:43.223
> 
> 标签：nuget, couchbase, hammock

我在我的项目中使用**NuGET**引用了**Couchbase**程序集，它依赖于**Hammock.dll**。这个大会是做什么的？它真的需要吗？在简单的单元测试中，我的应用程序可以在不存在的情况下正常工作。但是，当我将此应用程序投入生产时，我不希望有任何意外。****`Hammock.dll`****

 ***** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:13:04.387

我会说 [couchbase][仍然需要它](https://github.com/couchbase/couchbase-net-client/blob/master/src/Couchbase/HammockHttpClient.cs)，因为有一个`HammockHttpclient`.

要回答原始问题：

> [Hammock](http://nuget.org/packages/Hammock)是一个用于 .NET 的 HTTP API 库，它极大地简化了 RESTful 服务的使用和包装。

这可以通过转到[CouchbaseNetClient](http://nuget.org/packages/CouchbaseNetClient)页面并在*Dependancies*单击 Hammock 轻松重新搜索。您还可以访问[Couchbase 项目](https://github.com/couchbase/couchbase-net-client)并浏览源代码以查看该库是否/在何处仍在使用（正如我在第一句中链接的那样）。****

# c# - 为什么这个条件等于假？

> ID：14467028
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:02:23.097
> 
> 标签：c#, checkbox, contextmenu, windows-store-apps

在此代码的“if”行上设置断点：

```
if ((ckbx.Content != null) && (!ckbx.Content.ToString().Contains("(Empty list)")))
{
    string groupName = ckbx.Content.ToString();
    var contextMenu = new PopupMenu();

    contextMenu.Commands.Add(new UICommand("Edit this Group", contextMenuCmd => Frame.Navigate

    (typeof(LocationGroupCreator), groupName)));

    contextMenu.Commands.Add(new UICommand("Delete this Group", async (contextMenuCmd) =>
    {
        await SQLiteUtils.DeleteGroupAsync(groupName); 
    }));

    await contextMenu.ShowAsync(args.GetPosition(this));
} 
```

...ckbx.Content 是“（空列表）”，但条件被视为错误 - 条件失败。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:04:40.597

> ...ckbx.Content 是“（空列表）”，但条件被视为错误 - 条件失败。为什么？

您的条件具有[逻辑否定运算符](http://msdn.microsoft.com/en-us/library/f2kd6eb2.aspx)( `!`) 否定结果`Contains`：

```
 (!ckbx.Content.ToString().Contains("(Empty list)")) 
```

因此，如果内容中包含“(Empty list)”，`Contains`将返回`true`，并且`!`将使其成为`false`，这使得条件失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:05:45.220

`(ckbx.Content != null)`是真的

`(!ckbx.Content.ToString().Contains("(Empty list)")`是错误的 - 你刚刚说它是空列表......并且这会检查这不是空列表（感谢前面的“！” - “！”表示不是）。

true && false 当然等于 false

# python - Python：用属性覆盖成员？

> ID：14467032
> 
> 赞同：1
> 
> 时间：2013-01-22T20:02:39.633
> 
> 标签：python, inheritance, properties

我试图用属性覆盖 Python (2.7) 类的成员，如以下代码所示：

```
class Base:
    def __init__(self):
        self.foo = 1

class Derived(Base):
    foo = property(lambda self: 2)

print Derived().foo 
```

但是，最后一行打印的是 1 而不是 2。从​​我认为属性应该工作的方式（即，稍后轻松地将成员更改为函数），这对我来说似乎违反直觉。我错过了什么吗？有一些解决方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-22T20:03:03.310

这不起作用，因为您没有使用新样式的类。属性`descriptors`仅适用于新型类。你的代码在做什么是这样的：

您创建一个`Derived`具有类属性的类`foo`。然后，当您创建类的实例时，`Base.__init__`接管因为`Derived`has no`__init__`并且您添加`foo`优先于类属性的实例属性。

如果你改变：

```
class Base: #old style class 
```

到：

```
class Base(object):  #new style class 
```

你会遇到一个全新的问题，主要是你的属性没有适当定义`setter`，所以当你这样做时`self.foo = 1`，`Base.__init__`你会得到一个`AttributeError`

# sql - typeof 等价于 PL/SQL 中的对象类型

> ID：14467034
> 
> 赞同：3
> 
> 时间：2013-01-22T20:02:41.277
> 
> 标签：sql, oracle, plsql, oracle11g

我正在尝试在 Oracle 内部使用 OOP 和 TDD。是的，我知道这听起来很疯狂。而且，我需要一些建议。

我正在为以下构造函数方法编写测试（为本问题的目的进行了简化）：

```
CONSTRUCTOR FUNCTION PERSON(p_pidm NUMBER, p_throw_exception NUMBER DEFAULT 0, p_program_id NUMBER DEFAULT 0)
RETURN SELF AS RESULT IS

BEGIN

    -- Attach constructor parameters to internal attributes
    self.throw_exception := p_throw_exception;
    self.program_id := p_program_id;

    -- TESTING STUDENT INSTANTIATION
    self.student := NEW STUDENT(self.a_pidm);

    RETURN;
END; 
```

在相应的测试中，我需要验证`self.student`是否设置为`STUDENT`. 在其他语言中，我使用 typeof 方法执行此操作，但我不知道 PL/SQL 中有一个方法。

所以，问题是，有谁知道我可以将用户定义的类型传入并取回其类/类型名称的函数/过程？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:13:33.167

您可能想要使用[`IS OF <<type>>`语法](http://docs.oracle.com/cd/B19306_01/appdev.102/b14260/adobjbas.htm#sthref381)。

就像是

```
IF l_variable IS OF( student )
THEN
  <<do something>>
END IF; 
```

# java - 为什么 Java MD5 和 PHP MD5 提供完全不同的结果？

> ID：14467037
> 
> 赞同：-3
> 
> 时间：2013-01-22T20:02:52.177
> 
> 标签：java, php, md5, sha1

在为一个网站准备访问数据时，我突然意识到Java创建的MD5加密密码与PHP MD5创建的密码完全不同。浏览此处和其他地方的帖子，我发现了几种 Java 解决方案，确保它们提供与 PHP 完全相同的结果 - 但所有 Java 实现在它们之间提供相同的结果，但与 PHP 提供的结果完全不同。

因此，我编写了一个小型 Java 程序，将相同的密码发送到我的本地服务器以供 PHP 转换，同时使用 Java 自行转换。这里的程序：

```
public PHPDriver() {
  String pwd = "aabbccdd";
  String p = encodeByPHP("http://localhost/testsite/md5.php?pwd=" + pwd);
  System.out.println("PHPDriver:       " + pwd + " -> " + p);

  System.out.println("md5:             " + pwd + " -> " + md5(p));
...
public String encodeByPHP(String url) {
  try {
    // create a link to  a URL
    URL urlAddress = new URL(url);
    URLConnection link = urlAddress.openConnection();
    BufferedReader inStream = new BufferedReader(new InputStreamReader(link.getInputStream()));
    return inStream.readLine();  
  } catch (MalformedURLException e) {
...
public String md5(String input)  {
  String result = input;
  try {
    if(input != null) {
      MessageDigest md = MessageDigest.getInstance("MD5"); //or "SHA-1"
      md.update(input.getBytes());
      BigInteger hash = new BigInteger(1, md.digest());
      result = hash.toString(16);
      while(result.length() < 32) {
        result = "0" + result;
      }
    }
  } catch (NoSuchAlgorithmException nsa) { 
```

还有（极其复杂的;-) PHP 页面：

```
<?php
  $pwd = $_GET['pwd'];
  // echo $pwd . ' -> ';
  echo sha1($pwd); 
?> 
```

结果如下所示：

```
PHPDriver:       aabbccdd -> 527bee2730bf234e9a78bde5af091ece9c6302d5
md5:             aabbccdd -> ab86815613f7f321001efef1935dbe7d 
```

这里出了什么问题？这是一个错误编码问题吗？为什么 PHP 结果的长度是 40 字符而不是通常的 32？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:05:36.070

您从 PHP 脚本返回的 sha1

而是使用：

```
<?php
  $pwd = $_GET['pwd'];
  // echo $pwd . ' -> ';
  echo md5($pwd); 
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:39:54.033

除了`sha1`在一个和另一个中使用之外，您在 Java 中调用时`md5`没有指定 a 。这可能导致不可预测的行为。指定类似的 UTF-8 将获得一致的结果，然后您可以在 PHP 中检查如何确保您使用 UTF-8 对字符串进行哈希处理。`Charset``String.getBytes()``Charset`

# java - 不能模拟方法（类）

> ID：14467038
> 
> 赞同：3
> 
> 时间：2013-01-22T20:02:58.093
> 
> 标签：java, junit, easymock

我正在尝试模拟一个枚举：

```
public enum SomeEnum implements BaseEnum{

    SOME_VALUE("Description", SomeClass.class);

    private Class<? extends IConsignador> integracao;
    private String descricao;

    TipoIntegracao(String descricao, Class<? extends IConsignador> integracao){
        this.descricao = descricao;
        this.integracao = integracao;
    }

    @Override 
    public String getDescricao() {
        return descricao;
    }

    public Class<? extends IConsignador> getIntegracao() {
        return integracao;
    }
} 
```

我的模拟：

```
SomeEnum mock = createMock(SomeEnum.class);
expect(mock.getIntegracao()).andReturn( (Class<? extends IConsignador>) eq(ClassWithOutPublicConstructor.class ) );
replay(mock); 
```

但是日食说：

```
The method andReturn(Class<capture#1-of ? extends IConsignador>) in the type IExpectationSetters<Class<capture#1-of ? extends IConsignador>> is not applicable for the arguments (Class<capture#2-of ? extends IConsignador>) 
```

他建议演员表，但仍然不接受该值。会是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T03:32:30.740

与其他难以模拟的事情一样，考虑从 Enum 中提取接口并直接模拟接口。模拟 Enum 是一个坏主意，因为它破坏了 Enum 上的静态和实例方法的一般合同（例如`ordinal()`和`values()`）。

就 EasyMock 而言，EasyMock 显然在有界通配符方面存在一些问题。尝试使用[这种语法](http://tech.groups.yahoo.com/group/easymock/message/929)：

```
EasyMock.<Class<? extends IConsignador>>expect(
    mock.getIntegracao())
    .andReturn(ClassWithOutPublicConstructor.class); 
```

`eq`你还在你的 中留下了一个`thenReturn`EasyMock 不喜欢的东西。匹配器仅适用于 within`expect`的参数。抱歉我之前没看到。

# javascript - 单击联系表单字段时的图像更改

> ID：14467040
> 
> 赞同：0
> 
> 时间：2013-01-22T20:03:07.057
> 
> 标签：javascript, image, replace, onclick, contact

我目前在我的网站上有一个联系表格，单击该表格时会以橙色突出显示边框。

目前字段中的图标是灰色的（请参阅此处的打印屏幕：http: [//i47.tinypic.com/2d6mvwp.jpg](http://i47.tinypic.com/2d6mvwp.jpg)），我正在尝试获取它，以便在单击字段时图像从灰色变为橙色版本。因此，基本上字段图标和边框会同时突出显示，具体取决于单击了哪一个。

我希望这对某人来说很简单，我认为我挣扎的主要问题是图像是通过 CSS 引用的

表单的 HTML 部分在这里：

```
 <form method="post" action="contactengine.php">

            <label for="Name"></label>
            <input type="text" placeholder="Name" name="Name" id="Name" 

            <label for="Email"></label>
            <input type="text" placeholder="E-mail" name="Email" id="Email" />

            <label for="Message"></label><br />
            <textarea name="Message" placeholder="Enter your message here..." rows="20" cols="20"></textarea>

            <input type="image" name="submit" value="" src="Button_Static.png" onmouseover="this.src='Button_Hover.png'" onmouseout="this.src='Button_Static.png'" class="submit-button"/>

        </form> 
```

并且名称和电子邮件字段后面的 CSS 在这里（很抱歉代码块无法让我正确插入）：

```
#Name{
    background-image: url(NameIcon.png);
    background-repeat: no-repeat;
    background-size:32px 24px;
    background-position-x: 10px;
    background-position-y: 40%;
    padding: 5px;
    height: 30px;
    width: 350px;
    font-family: Helvetica, sans-serif;
    font-size: .8em;
    margin: 0px 0px 10px 0px;
    border: 2pt solid #ccc;
    text-indent: 50px;

    /* Curved Boxes - Browser Compatability */

    -moz-border-top-left-radius: 8px;
    border-top-left-radius: 8px;
    -moz-border-top-right-radius: 8px;
    border-top-right-radius: 8px;
    -moz-border-bottom-left-radius: 8px;
    border-bottom-left-radius: 8px;
    -moz-border-bottom-right-radius: 8px;
    border-bottom-right-radius: 8px;
}

#Email {
    background-image: url(EmailIcon.png);
    background-repeat: no-repeat;
    background-size:30px 17px;
    background-position-x: 12px;
    background-position-y: 40%;
    padding: 5px;
    height: 30px;
    width: 350px;
    font-family: Helvetica, sans-serif;
    font-size: .8em;
    margin: 0px 0px 10px 0px;
    border: 2pt solid #ccc;
    text-indent: 50px;

    /*Curved text Boxes - Browser Compatability*/

    -moz-border-top-left-radius: 8px;
    border-top-left-radius: 8px;
    -moz-border-top-right-radius: 8px;
    border-top-right-radius: 8px;
    -moz-border-bottom-left-radius: 8px;
    border-bottom-left-radius: 8px;
    -moz-border-bottom-right-radius: 8px;
    border-bottom-right-radius: 8px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:12:41.067

做另一种 CSS 样式并使用 :focus 将应用于具有焦点的输入元素。只需将其中的图像和边框更改为橙色：

```
#Name:focus{
    background-image: url(OrangeIcon.png);
    border: 1px solid orange
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:16:43.103

您要做的是为触发 javascript 的字段设置 onclick 或 onfocus 事件，该 javascript 更新了背景图像属性

```
document.getElementById("email").style.backgroundImage = "url(EmailIconSelected.png)"; 
```

# python - 使用自定义工作流程访问门户内容且没有“查看”权限

> ID：14467043
> 
> 赞同：1
> 
> 时间：2013-01-22T20:03:17.720
> 
> 标签：python, plone, zodb

我有一个问题，我需要能够让匿名用户通过 portal_catalog 搜索和检索自定义内容，但他们无法查看。

我使用了自定义内容类型和自定义工作流程，我得到的很可能是权限问题。我通过 ZMI -> portal_workflow 定义了一个自定义工作流，然后将其作为 XML 定义导出到源代码中。我将匿名用户的权限设置为“访问内容信息”而不是“查看”。请注意，代码片段中的“活动”是启用了该权限的工作流状态[——sales_workflow](https://gist.github.com/4599120 "销售工作流")

大脑查找适用于“经理”角色，但当角色切换为“匿名”时，目录返回一个空列表。

```
import unittest2 as unittest

from . import INTEGRATION_TESTING
from AccessControl import getSecurityManager

from plone.app.testing import setRoles, logout
from plone.app.testing import TEST_USER_ID

from Products.CMFCore.utils import getToolByName

def drop_to_anonymous(self):
    """
    Drop site roles to anonymous user only.
    Note this is a class method and not a function
    assign this method as a class member and then call it
    """
    logout()
    setRoles(self.portal, TEST_USER_ID, ['Anonymous'])
    user = getSecurityManager().getUser()
    roles =  user.getRolesInContext(self.portal)
    self.assertListEqual(['Anonymous'], roles)

class TestSalesRepWorkflow(unittest.TestCase):
    layer = INTEGRATION_TESTING
    drop_to_anonymous = drop_to_anonymous
    def setUp(self):
        self.portal = self.layer['portal']
        self.wftool = getToolByName(self.portal, 'portal_workflow')
        self.catalog = getToolByName(self.portal, 'portal_catalog')
    def test_workflow_lookup_anon(self):
        setRoles(self.portal, TEST_USER_ID, ['Manager'])
        self.portal.invokeFactory(
                                'CustomProduct',
                                'prod1',
                                title="Product 1"
                                )
        prod1 = self.portal['prod1']
        self.wftool.doActionFor(prod1, action='activate')
        review_state = self.wftool.getInfoFor(prod1, 'review_state')
        prod1.reindexObject()
        self.assertEqual('active', review_state)
        lookup = self.catalog(portal_type='CustomProduct', Title='Product 1',
                            review_state='active')
        #This test passes with managerial permissions
        self.assertEqual(len(lookup), 1)
        #Repeat the same test in 'Anonymous' role
        self.drop_to_anonymous()
        lookup1 = self.catalog(portal_type='CustomProduct', Title='Product 1',
                            review_state='active')
        #When dropped to anonymous role, the test fails, 
        #lookup returns an empty list
        self.assertEqual(len(lookup1), 1) 
```

有没有办法在不彻底修改权限的情况下解决这个问题？

使用 unrestrictedSearchResults 似乎可以修复搜索，但是每当我尝试在大脑上运行“getObject”时，都会引发以下错误：

```
Unauthorized: You are not allowed to access 'XXX' in this context 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:27:07.717

您的`active`州需要将查看权限授予匿名。目前它仅限于以下角色：

```
<state state_id="active" title="">
 <!-- other information elided here --> 
 <permission-map name="View" acquired="False">
   <permission-role>Manager</permission-role>
   <permission-role>Owner</permission-role>
   <permission-role>Reviewer</permission-role>
   <permission-role>SalesRep</permission-role>
   <permission-role>Site Administrator</permission-role>
  </permission-map> 
```

如果没有查看权限，即使指定`active`状态，匿名也无法查看您的对象，该用户也无法在目录中找到它们。

您可以使用目录的方法覆盖目录的这种行为`.unrestrictedSearchResults()`：

```
lookup1 = self.catalog.unrestrictedSearchResults(
    portal_type='SalesProduct', Title='Product 1', review_state='active') 
```

此方法不能从受限代码中使用。

返回的大脑对象完全可以被匿名用户访问，但你不能`getObject()`在它们上使用该方法，因为这将使用当前用户的权限来遍历它。如果您需要从大脑中获取实际对象，还有一种特殊的私有方法可以不受这些限制地获取实际对象，称为`._unrestrictedGetObject()`：

```
obj = brain._unrestrictedGetObject() 
```

再一次，此方法仅适用于不受限制的代码。

# sql - 加入表格以引入另一个字段

> ID：14467044
> 
> 赞同：-4
> 
> 时间：2013-01-22T20:03:17.737
> 
> 标签：sql, oracle

我目前有这个查询：

```
select f.chainid,count(f.player_uuid) as Favorites
from deals_player_favorite f
group by f.chainid
order by 2 desc 
```

结果是：

```
CHAINID            FAVORITES
25                 2771
2207               2282
3940               1954 
```

ETC...

我有另一个名为 Deals_deals 的表，其中还包括 CHAINID 字段。从这个表中，我想加入一个名为 VENUE 的字段，这样每个 CHAIN ID 都有一个 Venue 描述，输出看起来像这样

```
CHAINID    VENUE           FAVORITES    
25        Amazon.com        2771
2207       Walmart          2282
3940       CVS              1954 
```

ETC...

我如何正确地将场地字段加入查询中，使用 CHAIN id 作为 Deals_deals 表和 Deals_player_favorite 表中的键。

我尝试了一个内部连接，它导致了太多的结果。

deal_deals 表具有字段 CHAINID 和 VENUE..

Deals_player_favorite 表具有字段 CHAINID 和 PLAYER_UUID，但不包括 deal_deals 表中的所有 CHAINID，仅包含 player_uuid 访问过的 CHAINID。

样本数据：

deal_deals 表

```
VENUE        CHAINID
Walmart         235
Aeropostale     1467
Checker's       881 
```

Deals_player_favorite 表

```
PLAYER_UUID         CHAINID
23rjior23-32fjdf     235 
```

请记住，deals_player_favorite 仅包括已点击的特定 CHAINID，而不是所有链 ID....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T20:07:21.853

```
SELECT F.chainid, V.Venue, COUNT(f.player_uuid) as Favorites
FROM deals_player_favorite F
INNER JOIN Venues V
    ON F.chainid = V.chainid
GROUP BY F.chainid, V.Venue
ORDER BY COUNT(f.player_uuid) DESC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T20:09:58.140

如果您的问题是计数中的记录太多，那么您可能需要考虑使用子查询，然后加入子查询以获得`venue`：

```
select f.chainid,
  v.venue,
  f.Favorites
from
(
  select chainid, count(player_uuid) Favorites
  from deals_player_favorite
  group by chainid
) f
inner join deals_deals v
  on f.chainid = v.chainid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/08517/2)

子查询将首先获得您的总收藏夹，然后使用`chainid`您将获得`venue`

# php - 移动设备上的 Facebook 注册插件提供 API 错误代码：4202“此对话框在此设备上不可用。”

> ID：14467048
> 
> 赞同：2
> 
> 时间：2013-01-22T20:03:28.977
> 
> 标签：php, facebook, facebook-javascript-sdk, registration

我正在 Symfony 1.4/PHP 上构建一个独立网站，该网站使用 Facebook 注册插件进行用户注册。

我正在使用 XBML Facebook 注册插件，它在网络浏览器上运行良好。但是，当我尝试在移动触摸屏设备 (android) 浏览器上注册我的网站时，注册表单对话框会显示我自动填充的 facebook 信息，但是当我单击注册按钮时，会出现以下错误：

> 此对话框在此设备上不可用。API 错误代码：4202 API 错误描述：此对话框无法在此设备上显示错误消息：此显示类型不支持此方法

这是我的代码：

```
<fb:registration 
    fields="[{'name':'name'}, {'name':'first_name'}, {'name':'last_name'}, {'name':'email'}, {'name':'gender'}, {'name':'birthday'}, {'name':'location'}]" 
    redirect-uri="<?php echo <REDIRECT URL>?>"
    display="touch"
    width="530"
    fb_only=true>
</fb:registration> 
```

我已经尝试过使用和不使用 display="touch"，因为我读到这可能是一个问题，但它仍然给出了错误。

注册插件可以在移动设备上使用吗？我怀疑问题是当点击注册按钮时，有一个弹出窗口说以下内容并且移动浏览器不知道如何处理弹出窗口？

> “您刚刚使用 Facebook 帐户注册了 XXX。如果您不是故意的，您可以在下面撤消此操作。”

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T11:11:41.877

这个问题是*故意*的，并且已经在*Facebook 开发人员*中报告过：

[https://developers.facebook.com/bugs/507406422635550?browse=search_511bd57f912f84e18364257](https://developers.facebook.com/bugs/507406422635550?browse=search_511bd57f912f84e18364257)

# mysql - mysql加入虚拟表

> ID：14467050
> 
> 赞同：0
> 
> 时间：2013-01-22T20:03:44.150
> 
> 标签：mysql, join

好的，所以我有一个评级表。为每个留下评分的用户创建一个新行。我试图做的是创建一个查询，该查询将返回现在和 7 天前存在的每个特定行的评级值。

广义的观点是，我想计算总平均评分与 7 天前的总平均评分的差异。

我有这个，我认为这是正确的道路，但我得到了

```
Unknown column 'start_ratings.menu_item_id' in 'on clause' 
```

* * *

```
SELECT *
FROM ratings end_ratings
JOIN (
SELECT menu_item_id as end_menu_item_id, AVG(value) AS end_rating
    FROM ratings
    WHERE  
        created_at > current_date - 7
        AND menu_item_id IS NOT NULL
        AND location_id IS NOT NULL
    GROUP BY menu_item_id
) start_ratings ON (end_ratings.menu_item_id = start_ratings.menu_item_id)
WHERE menu_item_id IS NOT NULL
AND location_id IS NOT NULL; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:05:38.573

您已为该列添加别名`as end_menu_item_id`。只需使用它，因为`()`在`ON`子句、`SELECT`列表等中的派生表之外，只有别名是已知的......

因为这：

```
SELECT menu_item_id as end_menu_item_id, 
/*-----------------^^^^^^^^^^^^^^^^^^^^^^ */ 
```

用这个：

```
...) start_ratings ON (end_ratings.menu_item_id = start_ratings.end_menu_item_id)
/*----------------------------------------------------------^^^^^^^^^^^^^^^^^^^^^^^ */ 
```

# sql-server - 实体框架和 SQL Server 日期时间

> ID：14467051
> 
> 赞同：0
> 
> 时间：2013-01-22T20:03:44.997
> 
> 标签：sql-server, sql-server-2008, entity-framework, entity-framework-4

我将 EF 与 SQL Server 一起使用，当我在 MSSQL 和 EF 上获取 DateTime 字段时，我会得到如下信息：

```
"UpdateTime":"\/Date(1358716865533+0200)\/" 
```

我不知道这是什么格式（只是它显示了一些时间与 GMT+2 偏移）。

有什么建议么？

其次，我尝试在 LINQ 中获取记录的那些字段上使用 ToString("") 并得到一个错误，即 SQL 不支持以这种方式格式化 - 所以我没有简单的方法来格式化我想要的日期. 有没有办法应用格式？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:55:50.740

正如评论中所说，这是一种 Unix 格式。`DateTime`当您使用[`JavaScriptSerializer`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)(JSON)序列化 a 时，您将获得类似的字符串。

至于你的第二个问题。是的，EF 不允许`ToString`在 linq 查询中使用它可能会令人讨厌。另一方面，EF 用于数据访问，格式化用于 UI。因此，您最好在将数据从数据库中提取到内存中后进行格式化，然后将它们显示在某处。

# c# - 第三方库中的 MonoTouch 绑定通知

> ID：14467054
> 
> 赞同：3
> 
> 时间：2013-01-22T20:04:04.970
> 
> 标签：c#, ios, objective-c, binding, xamarin.ios

我正在为 IDTech CC swipers 创建绑定。一段时间以来，我一直在努力解决这个问题。我被困在如何订阅 3rd 方库引发的事件上。具体来说，我需要知道刷卡发生的时间。

```
//Notification identifiers used with NSNotificationCenter
//physical attachment related
extern NSString * const uniMagAttachmentNotification;
extern NSString * const uniMagDetachmentNotification;
//connection related
extern NSString * const uniMagInsufficientPowerNotification;
extern NSString * const uniMagPoweringNotification;
extern NSString * const uniMagTimeoutNotification;
extern NSString * const uniMagDidConnectNotification;
extern NSString * const uniMagDidDisconnectNotification;
//swipe related
extern NSString * const uniMagSwipeNotification;
extern NSString * const uniMagTimeoutSwipeNotification;
extern NSString * const uniMagDataProcessingNotification;
extern NSString * const uniMagInvalidSwipeNotification;
extern NSString * const uniMagDidReceiveDataNotification;
//command related
extern NSString * const uniMagCmdSendingNotification;
extern NSString * const uniMagCommandTimeoutNotification;
extern NSString * const uniMagDidReceiveCmdNotification;
//misc
extern NSString * const uniMagSystemMessageNotification; 
```

文档说这应该有效：

```
 [Notification]
    [Field ("uniMagAttachmentNotification")]
    NSString uniMagAttachmentNotification { get; } 
```

它不编译。

```
obj/Debug/ios/magTechBinding/uniMag.g.cs(637,95): error CS0117: `MonoTouch.Constants' does not contain a definition for `magTechBindingLibrary'
obj/Debug/ios/magTechBinding/uniMag.g.cs(637,77): error CS1502: The best overloaded method match for `MonoTouch.ObjCRuntime.Dlfcn.dlopen(string, int)' has some invalid arguments
obj/Debug/ios/magTechBinding/uniMag.g.cs(637,77): error CS1503: Argument `#1' cannot convert `object' expression to type `string' 
```

任何想法或帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:50:01.630

尝试：

```
[Field ("uniMagAttachmentNotification", "__Internal")] 
```

第二个参数告诉在哪个库中查找该字段。如果没有一个，生成器会*假定*您已经为它做好了准备。

现在，由于您将链接第 3 方**静态**(.a) 库，它将成为最终可执行文件的一部分。这就是为什么`__Internal`必须用作库名称的原因（这意味着在主可执行文件中查找）。

# jquery - jQuery 从它的中心切换对象的可见性

> ID：14467061
> 
> 赞同：0
> 
> 时间：2013-01-22T20:04:40.707
> 
> 标签：jquery

**剧情解释：**

*   有一堆具有不同大小和属性的 div，它们都有一个`box`类。
*   所有的盒子都用 隐藏`display: none`。
*   这些框不能有“绝对”位置。
*   页面加载时，这些框将开始一一切换。
*   jQuery 的切换效果从元素的左上角开始。

**问题：**

我希望切换效果从框的中心（高度和宽度）开始。我的意思是如果盒子大小是 100px*100px，效果应该从顶部 50px 和左侧 50px 开始。我怎么能用 jQuery 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:09:27.390

如果理解你的意思，这应该做到。

运行示例可以在[这里](http://www.charlottecoleman.co.uk/wp-content/uploads/2011/08/jquery-show-element-from-centre-demo.html)找到。

首先写你的html：

```
<div id="container">
 <div id="link">
     <a href="javascript:void(0)" id="boxOne">Click Me</a>
 </div>
 <div id="boxOneContent" class="box">
     <div class="content">
         <h1>Hello World</h1>
         <p>Lorem ipsum dolor sit amet, consectetur adipiscingelit. Ut ullamcorper consequat dui tempor euismod.</p>
         <p>Nam vel odio massa, sed lacinia sapien. Cras ac
         nisi.</p>
     </div>
 </div> 
```

链接的 id 与相应框的 id 的第一部分匹配。对于我在容器 div 中添加的演示，用户可以单击页面上的任意位置以关闭框。盒子内还有一个内容容器，用于在盒子展开时停止内容包装。

*现在是您的 CSS，它将框定位在链接的中央。我只把它的关键方面放在这里，查看完整代码的演示：*

```
#link {
float: left;
border: 1px solid red;
text-align: center;

width: 40px;
height: 40px;
padding: 5px;

margin-left: 125px;
margin-top: 125px;
}

#boxOneContent
{
background-color: #000;
color: #fff;

padding: 20px;
width: 160px;
height: 160px;
position: absolute;

top: 150px;
left: 150px;

margin-left: -100px;
margin-top: -100px;

display: none;} 
```

通过为#link 定义宽度、高度、内边距和边距，该元素的中心距顶部150 像素，距左侧150 像素。这是工作原理：125+((40+(5*2))/2) = 150。

包括填充在内，#boxOneContent 的总宽度和高度为 200 像素。因此，边距设置会将 div 向上和向左移动框大小的一半。这就是当 div 出现在右下角（像往常一样）扩展但也向左上角移动以到达这些边距时，div 向外“增长”的原因。

*最后是 jQuery 将它们组合在一起：*

```
$(document).ready(function($) {

    $('a').click(function(){

        if($('.box#'+$(this).attr('id')+'Content').hasClass('active') == true) {
            $('.box#'+$(this).attr('id')+'Content').removeClass('active').hide(200);
        } else {
             $('.box.active').removeClass('active').hide(200);
             $('.box#'+$(this).attr('id')+'Content').addClass('active').show(1000);
        }
     });

     $("body").click(function(){
          $(".box").removeClass("active").hide(200);
     });

     $("a").click(function(e){
          e.stopPropagation();
     });
 }); 
```

如果与单击的链接对应的框是可见的（活动的），那么它是隐藏的。否则，任何可见框都将被隐藏，并显示与单击的链接对应的框。如果用户单击页面上的任何位置（链接除外），则所有打开的框都将关闭。快乐编码！

[参考](http://www.charlottecoleman.co.uk/wp-content/uploads/2011/08/jquery-show-element-from-centre-demo.html)

# c# - 从字符串中将新行插入“RichTextBox”？

> ID：14467066
> 
> 赞同：3
> 
> 时间：2013-01-22T20:05:11.097
> 
> 标签：c#, string, formatting, richtextbox, lines

目前在我的应用程序中，我有一个从 XML 文件中读取的字符串，但是整个字符串连接在一起，我希望能够在我选择的特定点将字符串拆分为“RichTextBox”的多行该字符串的 XML 节点。

*例如，我的字符串在格式化之前位于 XML 节点中：*

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Vivamus eleifend arcu vel tellus aliquam eget aliquet orci dignissim。整数 volutpat congue elementum。在 commodo porta sem 中。Phasellus commodo consectetur hendrerit。整数 bibendum consequat elit nec ultricies。Fusce facilisis elit in justo facilisis sagittis。Aenean eget risus placerat dui hendrerit pharetra sed in neque。Maecenas vehicula iaculis lectus eget scelerisque。Fusce sed consequat 精英。

*在我的应用程序中格式化后我想要的结果：*

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Vivamus eleifend arcu vel tellus aliquam eget aliquet orci dignissim。整数 volutpat congue elementum。在 commodo porta sem 中。
> 
> Phasellus commodo consectetur hendrerit。整数 bibendum consequat elit nec ultricies。Fusce facilisis elit in justo facilisis sagittis。
> 
> Aenean eget risus placerat dui hendrerit pharetra sed in neque。Maecenas vehicula iaculis lectus eget scelerisque。Fusce sed consequat 精英。

是否可以通过将格式直接包含在 XML 节点/字符串本身中而不是硬编码每个新行需要的位置来将一个长连接字符串拆分为多行这样的“RichTextBox”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T09:59:46.267

我最终找到了自己解决这个问题的方法；它类似于已经说过的内容，但它所做的是检查字符串中的特定字符，然后将其删除并在其位置放入新行。

```
myLongString = myLongString.Replace("@", "" + System.Environment.NewLine); 
```

上面的示例只是检查字符串中的 @ 符号，然后将其删除并添加一个新行。然后，这允许在出现指定关键字或符号的任何位置使用新行格式化字符串，这意味着可以使用 XML 节点存储字符串的格式，然后进行解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:10:10.647

是的。您可以使用`Environment.NewLine`

```
richTextBox1.Text += "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus eleifend arcu vel tellus aliquam eget aliquet orci dignissim. Integer volutpat congue elementum. In commodo porta sem."
    + Environment.NewLine + Environment.NewLine + 
    " Phasellus commodo consectetur hendrerit. Integer bibendum consequat elit nec ultricies. Fusce facilisis elit in justo facilisis sagittis."
    + Environment.NewLine + Environment.NewLine + 
    " Aenean eget risus placerat dui hendrerit pharetra sed in neque. Maecenas vehicula iaculis lectus eget scelerisque. Fusce sed consequat elit."; 
```

嵌入新行是`\n`

```
richTextBox1.Text += "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus eleifend arcu vel tellus aliquam eget aliquet orci dignissim. Integer volutpat congue elementum. In commodo porta sem.\n\n Phasellus commodo consectetur hendrerit. Integer bibendum consequat elit nec ultricies. Fusce facilisis elit in justo facilisis sagittis.\n\n Aenean eget risus placerat dui hendrerit pharetra sed in neque. Maecenas vehicula iaculis lectus eget scelerisque. Fusce sed consequat elit."; 
```

# java - Java硬币计数器

> ID：14467069
> 
> 赞同：0
> 
> 时间：2013-01-22T20:05:23.207
> 
> 标签：java, algorithm

我和我的朋友正在尝试编写一个程序来计算用于赚取 x 金额的最低硬币组。到目前为止我有这个，但我们现在迷路了，不知道为什么要去。我知道你必须用钱做一些事情才能使它成为一个整数，然后说它可以赚到 Wholemoney，然后你把 Wholemoney 除以季度并找到 rem，但我不知道如何为它编写代码。任何帮助，将不胜感激。

```
import java.util.Scanner;

class Coins {
    public static void main(String[] args) {
        double money;
        double dollars=1.00;
        double quarters=0.25;
        double dimes=0.10;
        double nickels=0.05;
        double pennies=0.01;
        Scanner in=new Scanner(System.in);
        System.out.println("Enter amount of given money():");
        money=in.nextFloat();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:09:45.493

您首先将金额除以最有价值硬币的价值。整数部分是最有价值硬币的硬币数量，剩余金额是您除以下一个有价值硬币的剩余价值。你这样做，直到没有更多的硬币或小数部分为零。

请注意，这里的剩余金额是除法乘以除法硬币值的小数部分。

# ios - uitextview 字体不随 fontWIthName 改变

> ID：14467072
> 
> 赞同：0
> 
> 时间：2013-01-22T20:05:24.993
> 
> 标签：ios, xcode, fonts, uitextview

我正在尝试使用 textview.font = [UIFont fontWithName:etc] 更改 UITextView 的字体；但由于某种原因，它什么也没做，它总是显示相同的字体和大小。这是代码：

```
UITextView *descriptionTextView = [[UITextView alloc] initWithFrame:rect];
descriptionTextView.editable = NO;
descriptionTextView.scrollEnabled = NO;
descriptionTextView.text = description;
titleTextView.font = [UIFont fontWithName:@"Veranda" size:17.0]; //<- this line isn't working
[cell.contentView addSubview:descriptionTextView]; 
```

知道问题可能是什么吗？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:11:50.450

可能是您更改其他文本字段的字体的错误？您使用名为“descriptionTextView”的文本视图进行操作，但更改了“titleTextView”的字体

或者该默认字体被命名为“Verdana”，而不是“Veranda”

# android - Android App 会自动回复收到的消息

> ID：14467081
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:05:49.320
> 
> 标签：android

我正在创建一个 Android 应用程序，它将自动回复传入的消息。我正在使用双 SIM 卡电话，我如何确定消息发送到哪个位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:18:33.693

默认情况下，消息将由 SIM 1 发送

您可以使用 getSimOperator() 检查它，它将返回 SIM 提供商的 MCC+MNC（移动国家代码 + 移动网络代码）。或者您也可以使用 String getSimSerialNumber() 获取 sim 序列号

更多功能在这里-> [TelephonyManager](http://developer.android.com/reference/android/telephony/TelephonyManager.html)

不要忘记添加 READ_PHONE_STATE 权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:16:01.137

尝试这个：

```
 TelephonyManager phoneManager = (TelephonyManager) 
          getApplicationContext().getSystemService(Context.TELEPHONY_SERVICE);
    String phoneNumber = phoneManager.getLine1Number(); 
```

这需要 READ_PHONE_STATE 权限。

# java - 如何使用 Scala 类作为跨类加载器的共享根对象？

> ID：14467082
> 
> 赞同：2
> 
> 时间：2013-01-22T20:05:49.893
> 
> 标签：java, scala, classloader

我在 Scala 中实现了一个自定义类加载器，用于将插件与主应用程序隔离开来。目前，我需要一个 Java 接口作为共享根对象，以便我的主应用程序可以使用插件代码。

充当共享根的接口（我希望这是 Scala）：

```
public interface Handler {
    public List<HandlerInfo> getHandlers();
} 
```

示例插件：

```
class MyPlugin extends Handler {
  def getHandlers: java.util.List[HandlerInfo] = // get some handlers
} 
```

应用中的用法：

```
val jarFile     = new File(System.getProperty("user.dir") + "/plugins/" + jarName)
val cl          = new PluginLoader(jarFile, this.getClass.getClassLoader) // my custom classloader
val classToLoad = Class.forName(className, true, cl)
val handler     = classToLoad.newInstance.asInstanceOf[Handler]
val handlers    = handler.getHandlers 
```

这很好用，但我的问题是我必须保留这个 Java 类（以及生成的构建配置）。我想改为使用 Scala 特征或抽象类，如下所示：

```
trait Handler {
  def getHandlers : List[HandlerInfo]
} 
```

然后我的插件可能如下所示：

```
class MyPlugin extends Handler {
  def getHandlers: List[HandlerInfo] = // no more java.util.List
} 
```

但我不能这样做，因为这条线

```
val handler     = classToLoad.newInstance.asInstanceOf[Handler] 
```

抛出 a `ClassCastException`，大概是因为 Scala 编译器没有生成漂亮干净的 Java 接口。有什么办法可以解决这个问题，所以我可以拥有一个仅限 Scala 的项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:58:13.433

问题不在于您认为的问题所在；它在你的类加载器的某个地方。默认的类加载器工作得很好，即使是 Java 的。证据：

```
// File Handler.scala
trait Handler { def getHandlers: List[String] }

// File MyPlugin.scala
class MyPlugin extends Handler { def getHandlers = List("salmon", "cod") }

// File Interop.java
public class Interop {
  public static void main(String[] args) {
    try {
      Class classToLoad = Class.forName("MyPlugin");
      Handler handler = (Handler)classToLoad.newInstance();
      System.out.println("Class loader = "+handler.getClass().getClassLoader());
      System.out.println(handler.getHandlers());
    }
    catch (Exception e) { System.out.println("Uh-oh: "+e); }
  }
} 
```

在这里我们运行它：

```
$ java -cp .:/usr/share/scala/2.10/lib/scala-library.jar Interop
Class loader = sun.misc.Launcher$AppClassLoader@1f3e8d89
List(salmon, cod)
$ 
```

使用 Scala`List`和一切，以及由默认 Java 类加载器加载的新类。

# iphone - iPhone 上的 ARP 请求

> ID：14467088
> 
> 赞同：9
> 
> 时间：2013-01-22T20:06:12.700
> 
> 标签：iphone, ios, arp

我正在尝试在 iPhone 上生成 ARP（地址解析协议）请求数据包并侦听返回的相关响应。

谷歌搜索让我陷入了死胡同。为了发送逻辑层数据包，我需要类似于原始套接字的东西，但需要超级用户权限才能创建它们。我试图避免越狱我的手机。

有很多 c 代码可以做到这一点，但由于权限，我找不到任何可以转换为 iOS 的东西。

当我决定 Wireshark 我拥有的几个网络发现应用程序时，我已经准备好认输了。即“Fing”和“Pinggy”（顺便说一句，向 Fing 和 Pinggy 致敬……很棒的应用程序！）

[https://itunes.apple.com/us/app/pinggy/id562201096?mt=8](https://itunes.apple.com/us/app/pinggy/id562201096?mt=8)

[https://itunes.apple.com/us/app/fing-network-scanner/id430921107?mt=8](https://itunes.apple.com/us/app/fing-network-scanner/id430921107?mt=8)

与这些 iPhone 应用程序一起运行 Wireshark 表明它们会执行从 XXX.XXX.X.0 一直到 XXX.XXX.X.255 的 ARP 扫描。我没有看到任何 ICMP 数据包与“ARP”同时发出。这让我相信在 iOS 上确实可以发送和接收 ARP 数据包。

我考虑过 ping 扫描，假设它会自行生成 ARP 请求。但是，我仍然需要一个原始套接字来收听响应，对吗？

**问题**：在逻辑层发送/接收数据包有什么可用的？专门用于发送接收ARP数据包？我错过了什么基本的东西吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T19:49:48.010

当我尝试 ping 有问题的设备时，ARP 请求确实会发出。与 ping 扫描仪一起运行的 Wireshark 会话可以看到这一点。我发现我无法重现我之前看到的“丢失的设备”，这导致我问了我原来的问题。

所以，回答我自己的问题：在我的子网上进行简单的 ping 扫描时，ARP 请求是按 IP 地址发送的。我会看到 ARP 请求发出（使用 Wireshark）以及 ping 请求。如果您需要生成 ARP 请求，只需发送 ping 即可。

即使“有问题的”设备不会响应 ping 请求，也会通知 ARP 表它的存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T19:57:06.657

你不能做你想做的事，并在 AppStore 中获取应用程序，因为你想要做的事情不在公共 API 中。

因此，为了在您自己的网络或企业分布式应用程序上进行测试，您可以做的一件事是查看私有/未记录的 API。

[在https://github.com/nst/iOS-Runtime-Headers](https://github.com/nst/iOS-Runtime-Headers)维护了一个这样的列表，但我不能保证它的准确性。

祝你好运！

# c# - 如何序列化 ViewModel 并将其推送到 HTML 页面以使用 JSON 结构？

> ID：14467090
> 
> 赞同：0
> 
> 时间：2013-01-22T20:06:22.130
> 
> 标签：c#, javascript, asp.net-mvc, json, razor

我喜欢将我的视图模型结构推送到我的视图中，然后在 javascript 中使用它们。有什么更优雅的方法来做到这一点？这些代码行有点难看。

```
<script type="text/javascript">
       var PartChangeModel = @Html.Raw(Json.Encode(Model.PartChange));
       var PartModel = @Html.Raw(Json.Encode(Model.Part));
       var BOMItemModel = @Html.Raw(Json.Encode(Model.BOMItem));
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:21:11.740

根据 A-Dubb 的建议，我将其放入扩展方法中。哪种方式更有意义？大概有六六打之类的东西。

```
 public static MvcHtmlString ToJson(this Object ObjectToSerialize, string JavascriptVariableName)
        {
            return MvcHtmlString.Create(String.Format("var {0} = {1};", JavascriptVariableName, Json.Encode(ObjectToSerialize)));
        } 
```

然后你可以像这样从 Razor 调用它：

```
<script type="text/javascript">
    @Model.PartChange.ToJson("PartChangeModel")
    @Model.Part.ToJson("PartModel")
    @Model.BOMItem.ToJson("BOMItemModel")
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:05:44.593

为此试验一些 HTML 助手。这似乎有效。

```
 public static MvcHtmlString SerializeJsonForClient(this HtmlHelper helper, string JavascriptVariableName, object ObjectToSerialize)
        {
            return MvcHtmlString.Create(String.Format("var {0} = {1};", JavascriptVariableName, Json.Encode(ObjectToSerialize)));
        } 
```

然后你可以像这样从 Razor 调用它：

```
<script type="text/javascript">
    @Html.SerializeJsonForClient("PartChangeModel", Model.PartChange)
    @Html.SerializeJsonForClient("PartModel", Model.Part)
    @Html.SerializeJsonForClient("BOMItemModel", Model.BOMItem)
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T20:19:30.240

如果您不想将 Razor 标记与 JavaScript 混合，那么 AJAX 调用可能是最好的。使用 jQuery，您可以向返回序列化模型的控制器端点发出 get 请求。当然，主要的警告是这种方法需要在初始页面加载之上额外往返服务器，但我不会让这阻止我。

客户端

```
$(function() {
    $.getJSON('part/get', function(data) {
      // do something with response
    });
} 
```

服务器端

```
public class PartChangeModel { }

public class PartModel { }

public class BOMItemModel { }

public class PartViewModel { }

public class PartController : Controller {
    public ActionResult Get() {
        var partChangeModel = new PartChangeModel { /* init properties via repo, etc. */ }
        var partModel = new PartModel { /* init properties via repo, etc. */ }
        var bomItemModel = new BOMItemModel { /* init properties via repo, etc. */ }

        var viewModel = new PartViewModel {
            PartChangeModel = partChangeModel,
            PartModel = partModel,
            BOMItemModel = bomItemModel
        }

        return Json(viewModel);
    }
} 
```

# jquery - 如何设置从editform动态计算的jqgrid值

> ID：14467093
> 
> 赞同：1
> 
> 时间：2013-01-22T20:06:30.380
> 
> 标签：jquery, jqgrid

我有 jqgrid 列交易 id、借方、贷方和余额。借方和贷方是从数据库中填充的，余额是通过计算贷方 - 借方的差异来设置的。编辑在editform中完成。有一次，用户更改了借方或贷方的值之一，我需要在网格的选定行中更新余额列。

任何帮助是极大的赞赏。

```
$myGrid.jqGrid({                
url: myURL + '?method=GetTranactions', 
postData: { 
    prID: function() { return getProv(); },
    mn: function() { return $("#month option:selected").val(); },
    yr: function() { return $("#year option:selected").val(); }
},
datatype: 'json', 
mtype: 'POST',
colNames:['Trx ID','Debit','Credit','Balance',],
colModel :[
    {name:'accttrx_id',index:'accttrx_id', width:75, sorttype:"int", editable:true},
    {name:'debit',index:'debit', 
        width:70, 
        align:"right",
        formatter:'number',
        sorttype:"number",
        editable:true,
        edittype:"text",
        editoptions:{
            size:20,
            defaultValue:'0',                                       
            dataEvents: [   
                {
                    type: 'change',
                    fn: function(e) {
                        var db = $(e.target).val();
                        var cr = $('#credit').val();
                        bal = cr - db;  // got the balance 
                        alert(bal); // how to update balance column for current row?
                        }
                    }
                ]

            },
        editrules:{required:true},
        formoptions:{elmprefix:"(*)"}
        },
    {name:'balance',index:'balance',
        width:70, 
        align:"right",
        formatter:'number',
        sorttype:"number",
        editable:false},.... 
```

..................................................... .....................

```
$myGrid.navGrid('#pager', {
search:false,
edit:true,edittitle:"Edit Transation",
add:true,addtitle:"Add Transaction",
refresh:true,
del:true,deltitle:"Delete Transaction"
},
{
beforeShowForm: 
    function(form) { 
        $('#tr_accttrx_id', form).hide();                           
    },
    afterSubmit:
    ..... update balance after submit? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:20:31.827

对于editForm中的自定义计算，就像你在这里描述的那样，我通常把代码放在`beforeShowForm`你在这里描述的函数中。请使用类似的东西：

```
beforeShowForm: function() {
    $('#debit,#credit').change(function(){
        $('#balance').val( parseFloat($('#credit').val()) - parseFloat($('#debit').val()) );
    });
},
reloadAfterSubmit: true,
... 
```

jQuery 选择器（`$('#balance')`例如）使用 jqGrid 列的名称作为 ID 选择器。我这样做是因为我知道 jqGrid 使列名成为编辑表单中的输入元素 ID。

**提交后重新加载（在网格中显示更新的信息）**

为了在网格中看到您的新余额值，请使用`reloadAfterSubmit`我在上面的示例中包含的编辑表单的属性。请确认，您使用的是表单编辑还是内联编辑？如果您正在使用表单编辑，那么我的答案中的代码应该可以工作，如果应该与该`editGridRow`方法一起使用。见这里：[http ://www.trirand.com/jqgridwiki/doku.php?id=wiki:form_editing](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:form_editing)

**parseFloat 和 money 的小问题**

虽然上面的代码在大多数情况下应该可以工作，但请不要使用 parseFloat 命令来进行金钱计算。我之前遇到过四舍五入的问题。相反，您可以使用[BigDeciaml 包](https://github.com/iriscouch/bigdecimal.js)。

# c# - 我需要帮助构建 SQL 查询以根据我的日期列返回 Jan-Dec 的列计数

> ID：14467094
> 
> 赞同：1
> 
> 时间：2013-01-22T20:06:38.610
> 
> 标签：c#, sql, sql-server, sql-server-2008, pivot

我不是 SQL 专家，我什至不确定这种查询是否可行。

我想根据“MediaDate”为每个月的每个“MediaTypeID”返回一个计数（*）。

任何帮助将不胜感激！

谢谢。

我的表看起来像：

![媒体表](../Images/b700cebca170b8651745bb0d7e0e3a1e.png)

表数据如下所示：

```
1 | 1 | Funny Cat Video     | 2006-01-25 00:00:00.000
2 | 1 | Funny Dog Video     | 2006-01-20 00:00:00.000
3 | 2 | Angry Birds Game    | 2006-03-13 00:00:00.000
4 | 4 | Blonde Joke         | 2006-03-16 00:00:00.000
5 | 3 | Goofy Clown Picture | 2006-02-27 00:00:00.000
6 | 2 | Racing Game         | 2006-02-10 00:00:00.000
7 | 1 | Star Wars Video     | 2006-07-15 00:00:00.000 
```

该查询将返回一月至十二月的 12 行结果，如下所示：

```
Month | MediaTypeID1Count | MediaTypeID2Count | MediaTypeID3Count | MediaTypeID4Count
Jan   | 400               | 255               | 15                | 65
Feb   | 100               | 25                | 75                | 35
Mar   | 320               | 155               | 50                | 99
Apr   | 56                | 0                 | 98                | 313 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:50:09.150

这种类型的数据转换称为[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx). SQL Server 2005+ 有一个可以实现的数据透视函数：

```
select month,
  [1] MediaType1_count,
  [2] MediaType2_count,
  [3] MediaType3_count,
  [4] MediaType4_count
from 
(
  select 
    mediatypeid,
    datename(m, mediadate) Month,
    datepart(m, mediadate) monnum
  from yourtable
) src
pivot
(
  count(mediatypeid)
  for mediatypeid in ([1], [2], [3], [4])
) piv
order by monnum 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/169f3/13)

如果您有未知数量的值要转置为列，则可以使用动态 sql：

```
DECLARE @cols AS NVARCHAR(MAX),
    @colNames AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(mediatypeid) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

select @colNames = STUFF((SELECT distinct ', ' + QUOTENAME(mediatypeid) +' as MediaType' + cast(mediatypeid as varchar(50))+'_Count' 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT month,' + @colNames + ' from 
             (
                select mediatypeid,
                  datename(m, mediadate) Month,
                  datepart(m, mediadate) monnum
                from yourtable
            ) x
            pivot 
            (
                count(mediatypeid)
                for mediatypeid in (' + @cols + ')
            ) p 
            order by monnum'

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/169f3/16)

结果将如下所示：

```
|    MONTH | MEDIATYPE1_COUNT | MEDIATYPE2_COUNT | MEDIATYPE3_COUNT | MEDIATYPE4_COUNT |
----------------------------------------------------------------------------------------
|  January |                2 |                0 |                0 |                0 |
| February |                0 |                1 |                1 |                0 |
|    March |                0 |                1 |                0 |                1 |
|     July |                1 |                0 |                0 |                0 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:35:16.903

我想这可能是你正在寻找的。以下将简单地返回基于媒体类型 id 的计数，然后按年分组，然后按月分组

```
Select MediaTypeID, datepart(year, MediaDate), datepart(month, MediaDate), count(*)
From Media
Group by MediaTypeID, datepart(year, MediaDate), datepart(month, MediaDate) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-22T20:25:47.900

在我看来，这可能是您从以下代码开始的一个很好的挑战：

```
Declare @T  Table   (
    MediaID     BigInt  Primary Key Identity(1, 1)
,   MediaTypeID BigInt
,   MediaTitle  Nvarchar(50)
,   MediaDate   DateTime
);

Insert  @T  (
    MediaTypeID
,   MediaTitle
,   MediaDate
)   Select  1
    ,   'Funny Cat Video'
    ,   '2006-01-25 00:00:00.000'
Union
    Select  1
    ,   'Funny Dog Video'
    ,   '2006-01-20 00:00:00.000'
Union
    Select  2
    ,   'Angry Birds Game'
    ,   '2006-03-13 00:00:00.000'
Union
    Select  4
    ,   'Blonde Joke'
    ,   '2006-03-16 00:00:00.000'
Union
    Select  3
    ,   'Goofy Clown Picture'
    ,   '2006-02-27 00:00:00.000'
Union
    Select  2
    ,   'Racing Game'
    ,   '2006-02-10 00:00:00.000'
Union
    Select  1
    ,   'Star Wars Video'
    ,   '2006-07-15 00:00:00.000'
;

Select  Month.Title
,   Count(Type01_Result.MediaID)    As  MediaTypeID_1
,   Count(Type02_Result.MediaID)    As  MediaTypeID_2
,   Count(Type03_Result.MediaID)    As  MediaTypeID_3
,   Count(Type04_Result.MediaID)    As  MediaTypeID_4
    From    (
        Select  1       As  Id
        ,   'Jan'       As  Title
    Union
        Select  2
        ,   'Feb'
    Union
        Select  3
        ,   'March'
    Union
        Select  4
        ,   'April'
    Union
        Select  5
        ,   'May'
    Union
        Select  6
        ,   'June'
    Union
        Select  7
        ,   'July'
    Union
        Select  8
        ,   'Aug'
    Union
        Select  9
        ,   'Sept'
    Union
        Select  10
        ,   'Nov'
    Union
        Select  11
        ,   'Oct'
    Union
        Select  12
        ,   'Dec'
    )   As  Month
    Left    Outer   Join
        @T  As  Type01_Result
    On  Type01_Result.MediaTypeID           =   1
    And DatePart(Month, Type01_Result.MediaDate)    =   Month.Id
    Left    Outer   Join
        @T  As  Type02_Result
    On  Type02_Result.MediaTypeID           =   2
    And DatePart(Month, Type02_Result.MediaDate)    =   Month.Id
    Left    Outer   Join
        @T  As  Type03_Result
    On  Type03_Result.MediaTypeID           =   3
    And DatePart(Month, Type03_Result.MediaDate)    =   Month.Id
    Left    Outer   Join
        @T  As  Type04_Result
    On  Type04_Result.MediaTypeID           =   4
    And DatePart(Month, Type04_Result.MediaDate)    =   Month.Id
    Group   By  Month.Title
    ; 
```

唯一的事情是您应该注意年份值以及要在输出中包含多少年，因为无论记录日期是哪一年，此结果都会为您提供每个月所有记录的总和。这可能会导致结果有些混乱。

（记住我在Management Studio的Options中总是将tab size设置为8个字符，所以我建议你这样做看看正确的T-SQL编写方式）

希望它可以帮助你。

干杯

# ios - AFNetworking UIAlertView 在后台且无网络时

> ID：14467095
> 
> 赞同：0
> 
> 时间：2013-01-22T20:06:40.307
> 
> 标签：ios, objective-c, cocoa-touch, uialertview, afnetworking

我正在使用 AFNetworking 在后台将位置详细信息更新到服务器（使用重大位置更改）。一切正常，除了开车时它试图上传到我的服务器并且我的手机没有数据信号，当我稍后重新启动应用程序时，它在屏幕上显示 UIAlertViews 说“互联网连接似乎已脱机”。

我已经在我的项目中搜索了该字符串，但它不存在。那么它是从哪里来的呢？

我想在应用程序后台运行时停止显示此内容。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:12:14.533

`[NSURLConnection connection:didFailWithError:]`当 Internet 处于脱机状态时，将传递该错误消息。我相信 AFNetworking 会根据您的实现将此传递给失败代码块或委托回调。您在某处有代码可以`UIAlertView`从对象制作显示文本，`NSError`但该字符串不在您的项目中，所以这就是您找不到它的原因。

# java - 数据库中的网址

> ID：14467097
> 
> 赞同：1
> 
> 时间：2013-01-22T20:06:42.927
> 
> 标签：java, sql-server, web-services, shiro

我们对 Apache Shiro 有一点问题。我们将 Shiro 与 JDBC 领域一起使用：用户、角色和权限存储在我们的 SQL 服务器数据库中。我们有一个用作后台的 java 应用程序，用于插入、更新或删除用户、角色和权限。但是我们需要对 Urls 过滤器做同样的事情。

我发现了一些关于它的东西，但我真的是 Shiro 的初学者，我不理解它们，而且通常，这些例子是 servlet 和 JSP（我们只使用 HTML/CSS/JS 和数据收集与网页服务）。

有人可以解释如何在数据库中而不是在 INI 文件中存储 url 和过滤器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:51:37.730

Shiro 使用[FilterChainManager](http://shiro.apache.org/static/current/apidocs/org/apache/shiro/web/filter/mgt/FilterChainManager.html)接口的默认实现来管理和创建过滤器。您可以创建此接口的自定义实现以委托给您的数据库以获取配置信息。有关想法，请参阅[DefaultFilterChainManager](http://svn.apache.org/repos/asf/shiro/trunk/web/src/main/java/org/apache/shiro/web/filter/mgt/DefaultFilterChainManager.java)实现。

以下是这些东西在运行时的工作方式：

1.  当一个请求进入 servlet 容器时，它会被`ShiroFilter`.
2.  ShiroFilter 委托给[FilterChainResolver](http://shiro.apache.org/static/1.2.1/apidocs/org/apache/shiro/web/filter/mgt/FilterChainResolver.html)以获取`FilterChain`应为任何给定请求执行的内容。
3.  默认情况下`FilterChainResolver`，[PathMatchingFilterChainResolver](http://svn.apache.org/repos/asf/shiro/trunk/web/src/main/java/org/apache/shiro/web/filter/mgt/PathMatchingFilterChainResolver.java)实现依次检查请求路径并使用该路径执行查找`FilterChainManager`。
4.  解析后的 FilterChain 返回，然后由 master 执行`ShiroFilter`。

您可以将任何`FilterChainResolver`您想要的插件插入到`ShiroFilter`. 您可以使用默认值`FilterChainResolver`并将其委托给您的自定义`FilterChainManager`实例，或者您可以根据需要实现其中一个（或两个）接口。

# java - Java：从 FTP 服务器访问文件

> ID：14467107
> 
> 赞同：11
> 
> 时间：2013-01-22T20:07:24.133
> 
> 标签：java, file, url, ftp

所以我有这个 FTP 服务器，里面有一堆文件夹和文件。

我的程序需要访问这个服务器，读取所有文件，并显示它们的数据。

出于开发目的，我一直在处理硬盘驱动器上的文件，就在“src”文件夹中。

但是现在服务器已经启动并运行，我需要将软件连接到它。

基本上我想要做的是获取服务器上特定文件夹中的文件列表。

这是我到目前为止所拥有的：

```
URL url = null;
File folder = null;
try {
    url = new URL ("ftp://username:password@www.superland.example/server");
    folder = new File (url.toURI());
} catch (Exception e) {
    e.printStackTrace();
}
data = Arrays.asList(folder.listFiles(new FileFilter () {
    public boolean accept(File file) {
        return file.isDirectory();
    }
})); 
```

但我收到错误“URI 方案不是‘文件’。”

我知道这是因为我的 URL 以“ftp://”而不是“file:”开头

但是我似乎无法弄清楚我应该怎么做！

也许有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-22T20:14:42.197

`File`对象无法处理`FTP`连接，您需要使用`URLConnection`：

```
URL url = new URL ("ftp://username:password@www.superland.example/server");
URLConnection urlc = url.openConnection();
InputStream is = urlc.getInputStream();
... 
```

考虑作为[Apache Commons Net](http://commons.apache.org/net/)`FTPClient`的替代方案，它支持许多协议。这是一个[FTP 列表文件示例](http://www.kodejava.org/examples/357.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:20:52.037

如果您将 URI 与文件一起使用，您可以使用您的代码但是，但是当您想使用 ftp 时，您需要这种代码；code 列出你的 ftp 服务器下的文件名

```
import java.net.*;
import java.io.*;

public class URLConnectionReader {
    public static void main(String[] args) throws Exception {
        URL url = new URL("ftp://username:password@www.superland.example/server");
        URLConnection con = url.openConnection();
        BufferedReader in = new BufferedReader(new InputStreamReader(
                                    con.getInputStream()));
        String inputLine;
        while ((inputLine = in.readLine()) != null) 
            System.out.println(inputLine);
        in.close();
    }
} 
```

**EDITED** [Demo 代码属于 Codejava](http://www.codejava.net/java-se/networking/ftp/using-urlconnection-to-list-files-and-directories-on-ftp-server)

```
package net.codejava.ftp;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;
import java.net.URLConnection;

public class FtpUrlListing {

    public static void main(String[] args) {
        String ftpUrl = "ftp://%s:%s@%s/%s;type=d";
        String host = "www.myserver.com";
        String user = "tom";
        String pass = "secret";
        String dirPath = "/projects/java";

        ftpUrl = String.format(ftpUrl, user, pass, host, dirPath);
        System.out.println("URL: " + ftpUrl);

        try {
            URL url = new URL(ftpUrl);
            URLConnection conn = url.openConnection();
            InputStream inputStream = conn.getInputStream();
            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));

            String line = null;
            System.out.println("--- START ---");
            while ((line = reader.readLine()) != null) {
                System.out.println(line);
            }
            System.out.println("--- END ---");

            inputStream.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }
} 
```

# hadoop - hdfs连接失败

> ID：14467110
> 
> 赞同：0
> 
> 时间：2013-01-22T20:07:31.490
> 
> 标签：hadoop, hdfs

我知道这个问题已经讨论过很多次了，但是没有一个解决方案对我有用。我仍然收到此错误。

hadoop 版本是 2.0.2-alpha

```
$ jps
24107 NameNode
24314 DataNode
25299 Jps
24720 NodeManager
24520 ResourceManager

$ hdfs dfs ... any command gives me this error 
<command>: Call from jeet/192.168.1.26 to jeet:9000 failed on connection exception: java.net.ConnectException: Connectionrefused; 
```

* * *

tcp 0 0 192.168.1.26:9620 0.0.0.0:* LISTEN 24520/java
tcp 0 0 0.0.0.0:58932 0.0.0.0:* LISTEN 24720/java
tcp 0 0 0.0.0.0:21 0.0.0.0:* LISTEN 26020/ vsftpd
tcp 0 0 127.0.1.1:53 0.0.0.0:* LISTEN 1610/dnsmasq
tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 614/sshd
tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 713 /cupsd
tcp 0 0 0.0.0.0:8088 0.0.0.0:* LISTEN 24520/java
tcp 0 0 0.0.0.0:50010 0.0.0.0:* LISTEN 24314/java
tcp 0 0 192.168.1.26:9210 0.0.0.0:* LISTEN 24107/java
tcp 0 0 0.0.0.0:50075 0.0.0.0:* LISTEN 24314/java
tcp 0 0 192.168.1.26:9600 0.0.0.0.0:* LISTEN java
tcp 0 0 0.0.0.0:8033 0.0.0.0:* LISTEN 24520/java
tcp 0 0 0.0.0.0:50020 0.0.0.0:* LISTEN 24314/java
tcp 0 0 192.168.1.26:9220 0.0.0.0:* LISTEN 2410 /java
tcp 0 0 0.0.0.0:8040 0.0.0.0:* LISTEN 24720/java
tcp 0 0 192.168.1.26:9610 0.0.0.0:* LISTEN 24520/java
tcp 0 0 0.0.0.0:8042 0.0.0.0:* LISTEN 24720/java
tcp 0 0 0.0.0.0:8080 0.0.0.0:* LISTEN 24720/java
tcp 0 0 192.168.1.26:9200 0.0.0.0:* LISTEN 24107 java
tcp6 0 0 :::22 :::* LISTEN 614/sshd
tcp6 0 0 :::23 :::* LISTEN 11765/xinetd

--------------------- 核心站点.xml

```
 <property>
    <name>fs.default.name</name>
    <value>hdfs://jeet:9000</value>
    <description>
      The name of the default file system.  Either the
      literal string "local" or a host:port for NDFS.
    </description>
    <final>true</final>
  </property>

  <property>
    <name>fs.trash.interval</name>
    <value>360</value>
    <description>Number of minutes between trash checkpoints.
      If zero, the trash feature is disabled.
    </description>
  </property>

  <property>
    <name>hadoop.security.groups.cache.secs</name>
    <value>14400</value>
  </property>

  <property>
    <name>hadoop.tmp.dir</name>
    <value>/app/hadoop/tmp</value>
    <description>
     Temporary directories.
    </description>
  </property> 
```

# ios - 使用 TouchesMoved 绘制形状

> ID：14467111
> 
> 赞同：2
> 
> 时间：2013-01-22T20:07:35.403
> 
> 标签：ios, cocoa-touch

我正在尝试用手指在屏幕上绘制箭头。我的想法是通过触摸屏幕设置箭头的初始坐标，当我在屏幕上拖动时，箭头会延伸并跟随我的手指。箭头的高度和宽度将相同，重要的是箭头的大小。当我将它拖离起点时，箭头会变长。我试过用这样的东西东它：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UIGraphicsBeginImageContext(CGSizeMake(1536, 2048));

    UITouch *touch = [touches anyObject];
    CGPoint p1 = [touch locationInView:self.view];

    CGSize size;
    size.width = 50;
    size.height = 400;

    CGContextRef context = UIGraphicsGetCurrentContext();

    [self drawArrowWithContext:context atPoint:p1 withSize:size lineWidth:4 arrowHeight:20 andColor:[UIColor whiteColor]];

    // converts your context into a UIImage
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();

    // Adds that image into an imageView and sticks it on the screen.
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    [self.view addSubview:imageView];
} 
```

和

```
- (void) drawArrowWithContext:(CGContextRef)context atPoint:(CGPoint)startPoint withSize: (CGSize)size lineWidth:(float)width arrowHeight:(float)aheight andColor:(UIColor *)color
{
    float width_wing = (size.width - width) / 2;
    float main = size.height-aheight;

    CGContextSetFillColorWithColor(context, [color CGColor]);
    CGContextSetStrokeColorWithColor(context, [color CGColor]);

    CGPoint rectangle_points[] = {
        CGPointMake(startPoint.x + width_wing, startPoint.y + 0.0),
        CGPointMake(startPoint.x + width_wing, startPoint.y + main),
        CGPointMake(startPoint.x + 0.0, startPoint.y + main), // left point
        CGPointMake(startPoint.x + size.width / 2, startPoint.y + size.height),

        CGPointMake(startPoint.x + size.width, startPoint.y + main), // right point

        CGPointMake(startPoint.x + size.width-width_wing, startPoint.y + main),

        CGPointMake(startPoint.x + size.width-width_wing, startPoint.y + 0.0),
        CGPointMake(startPoint.x + width_wing, startPoint.y + 0.0),
    };

    CGContextAddLines(context, rectangle_points, 8);

    CGContextFillPath(context);
} 
```

如果我从在普通 IBOutlet 中移动的触摸运行代码，箭头确实会出现在屏幕上，但这不是我的想法。我还没有设法让这段代码工作，但我认为即使它工作，它也会导致崩溃，因为我每次都在删除和重绘形状。这是正确的方法吗？我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:41:30.383

基本上，有一些不同的选择。

*   坚持使用 UIImageView 方法并一直停止重新创建图像视图。在检测触摸事件的类中保留对该 UIImageView 的引用，如果发生更改，只需替换图像。如果您需要图像用于其他用途，可能值得为屏幕外绘图付出额外的努力。
*   在额外的视图中动态实现箭头绘制。

我将在这里简要介绍第二个：

检测事件的类需要一个成员变量/属性，ArrowView *arrowView 和一些记住起点的东西，也许是 CGPoint startPoint。ArrowView 需要箭头参数的属性，CGPoint arrowStart，CGSize arrowSize。在触摸事件处理程序中，执行

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *touch = [touches anyObject];
    CGPoint position = [touch locationInView:self.view];

    [self.startPoint startFrom:position];
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

    UITouch *touch = [touches anyObject];
    CGPoint next = [touch locationInView:self.view];

    CGSize size;
    size.width = next.x - self.startPoint.x;
    size.height = next.y - self.startPoint.y;

    self.arrowView.arrowPoint = self.startPoint;
    self.arrowView.arrowSize = size;

    [self.arrowView setNeedsDisplay];
} 
```

在箭头视图中：

```
- (void)drawRect:(CGRect)rect {
    [super drawRect:rect];

    CGContextRef context = UIGraphicsGetCurrentContext();
    // Now do the drawing stuff here using that context!
    // self.arrowSize / self.arrowPoint do contain your drawing parameters.
    ...
} 
```

我希望这能给你一个想法。

如需进一步阅读，请[从这里开始。](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-BBCDGJHF)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:22:48.207

哟可以尝试使用`UIPanGestureRecognizer`跟随你的手指并在它上面画图。

# javascript - 任务管理器显示内存泄漏，但堆快照没有

> ID：14467112
> 
> 赞同：5
> 
> 时间：2013-01-22T20:07:36.197
> 
> 标签：javascript, memory-leaks

我每 5 秒运行一次繁重的 JavaScript，任务管理器显示内存使用量不断增加。但是堆快照没有。如果我停止脚本，大约~~半分钟~~两分钟后清除内存。

更新：

如果我长时间离开脚本，内存会增加，直到浏览器崩溃。我还尝试运行 chrome 开发工具的时间线测试，它们也没有显示内存使用量的增加，与堆快照相同。所以我想这是某种泄漏，但我不明白是什么泄漏。

由于无法安装以前的 Chrome 版本，我无法确认的另一件事是，我不记得以前（<24 个 Chrome 版本）发生过这种情况。并且 IE10 在不增加内存的情况下运行这个测试。这可能是新 Chrome 的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:16:26.460

假设您指的是 Chrome 开发人员工具，您可能看不到堆快照中的内存增加，因为堆快照分析器在快照之前运行垃圾收集器。

看到内存使用量增加，尤其是在主动处理期间，是很正常的。垃圾收集器不会不必要地运行。如果你的机器有空闲内存，它会让保留的内存增长。如果您开始推动可用内存的限制，则收集器应该运行。您应该允许这种情况发生，看看是否会发生。

由于您报告内存在空闲期后下降到原来的水平，这表明没有内存泄漏，并且垃圾收集器能够正确收集所有分配的堆对象。

但是，IANAGE（我不是 Google 工程师）。我建议阅读[Heap Profiler 文档](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)和相关的[Memory 101 页面](https://developers.google.com/chrome-developer-tools/docs/memory-analysis-101)作为背景信息。

# php - 制作/链接到不同的目录 VHost, PHP MVC

> ID：14467115
> 
> 赞同：0
> 
> 时间：2013-01-22T20:07:41.143
> 
> 标签：php, apache, directory-structure, vhosts

我正在尝试创建自己的 MVC。我的文件夹结构如下：

```
 localhost (root, htdocs)
   - Project_1
     - images
       - test.jpg
     - App
       - Controllers
       - Models
       - Views
     - Classes 
```

现在，如果我在视图文件夹下创建一个索引文件并添加：

```
 <img src="/images/test.jpg" /> 
```

这不会加载 test.jpg 因为`/`指向`localhost (root/htdocs)`文件夹而不是指向`Project_1`

我的问题是我需要做什么才能`/`指向`Project_1`目录而不是根目录，我知道它必须对 VHosts 做一些事情，但不幸的是我不知道任何可以解释该问题的教程。

任何想法/建议或教程链接将不胜感激。谢谢

**注意**：我不想做以下事情：

```
 define('ROOT', '/localhost/Project_1/'); 
```

然后像这样使用它

```
 <img src="<?=ROOT?>images/test.jpg" /> 
```

这就是我试图避免的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:17:01.850

如果您要做的只是更改图像的基本路径，那么您可能能够摆脱使用`<base>`HTML 元素。

> [取自 MDN](https://developer.mozilla.org/en/docs/HTML/Element/base) -
> HTML 元素指定用于文档中包含的所有相对 URL 的基本 URL。

至于 PHP 方面，**您断然拒绝的选项可能是最好的方法**- 定义一个指向正确路径的常量 -

```
define('ROOT', '/localhost/Project_1/'); 
```

如果您想进入虚拟主机的设置，那么您将能够直接从虚拟主机的定义中设置文档根目录。这是一个简单的例子 -

```
<VirtualHost *:80>
    DocumentRoot /var/www/localhost/Project_1/
    ServerName Project_1.com
</VirtualHost> 
```

在这个虚拟主机中，您`$_SERVER['DOCUMENT_ROOT']`现在将是`/var/www/localhost/Project_1/`.

# javascript - 是否有一种有用的模式来管理事件的“量子状态变化”？（特别是在 JavaScript 中）

> ID：14467116
> 
> 赞同：2
> 
> 时间：2013-01-22T20:07:42.807
> 
> 标签：javascript, events, observer-pattern

有各种各样的方法可以单独响应事件。但是，我反复遇到这种现象，我想更改几个属性，然后在进行所有更改后响应状态。

经典案例 - 我有一个包含帐户交易的数据网格。当我从一个帐户更改为另一个帐户时，我还会更改日期范围和排序键/顺序。这是三个属性（accountID、sorting、dateRange），但我不想独立触发三个更改事件——至少在我切换帐户时不会。然而，这些状态确实有潜在的观察者，当最后两个状态发生变化时，来自用户交互。

是否有任何智能方法来管理参数的量子变化，与参数的个别变化分开？您总是可以拥有一个全局 state_is_changing 属性来中和事件，因为您一一更改事件，但是当您“取消挂钩” state_is_changeing 属性时，您必须从更高级别重新轮询您的状态或让事件效果“排队” “在变化期间触发。

这些解决方案似乎都不优雅。

有谁知道一种设计模式，您可以在其中优雅地管理事件系统中的战术和量子状态变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:11:55.457

你已经用观察者模式标记了它，但听起来你想要的是中介者模式......它监听各种来源并提供更高级别的逻辑。

读一读，看看它是否适合您的想法：[http ://addyosmani.com/largescalejavascript/#mediatorpattern](http://addyosmani.com/largescalejavascript/#mediatorpattern)

# windows-phone-8 - 以编程方式缩放 AudioVideoCaptureDevice？

> ID：14467117
> 
> 赞同：1
> 
> 时间：2013-01-22T20:07:46.220
> 
> 标签：windows-phone-8

有人知道如何在 Windows Phone 8 中以编程方式缩放 AudioVideoCaptureDevice 吗？

我正在使用 AudioVideoCaptureDevice（是的，我想要那个特定的设备，这样我就可以控制 VideoTorchMode 属性）。我不能为我的生活弄清楚缩放虽然。我正在使用映射到 AudioVideoCaptureDevice 的 VideoBrush 绘制画布。我想实现 Pinch-Zoom 甚至是一个简单的 +/- 按钮来缩放相机。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:29:38.260

我不熟悉 WP8 中允许您以编程方式在 PhotoCaptureDevice/AudioVideoCaptureDevice 上设置缩放的任何 API。我的理论是，您可以通过实现自己的捏合缩放功能并确保该区域被聚焦来手动完成。

有关如何使用 WP8 相机 API 专注于某个区域的信息，请参阅诺基亚的[相机资源管理器](http://projects.developer.nokia.com/cameraexplorer)。您正在寻找的核心内容可以在[此架构指南](http://projects.developer.nokia.com/cameraexplorer/wiki/Implementation)中的“点击聚焦”下找到。

```
private async void videoCanvas_Tap(object sender, GestureEventArgs e)
{
    System.Windows.Point uiTapPoint = e.GetPosition(VideoCanvas);
    if (_focusSemaphore.WaitOne(0))
    {
        // Get tap coordinates as a foundation point
        Windows.Foundation.Point tapPoint = new Windows.Foundation.Point(uiTapPoint.X, uiTapPoint.Y);

        double xRatio = VideoCanvas.ActualWidth / _dataContext.Device.PreviewResolution.Width;
        double yRatio = VideoCanvas.ActualHeight / _dataContext.Device.PreviewResolution.Height;

        // adjust to center focus on the tap point
        Windows.Foundation.Point displayOrigin = new Windows.Foundation.Point(
            tapPoint.X - _focusRegionSize.Width / 2,
            tapPoint.Y - _focusRegionSize.Height / 2);

        // adjust for resolution difference between preview image and the canvas
        Windows.Foundation.Point viewFinderOrigin = new Windows.Foundation.Point(displayOrigin.X / xRatio, displayOrigin.Y / yRatio);
        Windows.Foundation.Rect focusrect = new Windows.Foundation.Rect(viewFinderOrigin, _focusRegionSize);

        // clip to preview resolution
        Windows.Foundation.Rect viewPortRect = new Windows.Foundation.Rect(0, 0, _dataContext.Device.PreviewResolution.Width, _dataContext.Device.PreviewResolution.Height);
        focusrect.Intersect(viewPortRect);

        _dataContext.Device.FocusRegion = focusrect;

        // show a focus indicator
        FocusIndicator.SetValue(Shape.StrokeProperty, _notFocusedBrush);
        FocusIndicator.SetValue(Canvas.LeftProperty, uiTapPoint.X - _focusRegionSize.Width / 2);
        FocusIndicator.SetValue(Canvas.TopProperty, uiTapPoint.Y - _focusRegionSize.Height / 2);
        FocusIndicator.SetValue(Canvas.VisibilityProperty, Visibility.Visible);

        CameraFocusStatus status = await _dataContext.Device.FocusAsync();
        if (status == CameraFocusStatus.Locked)
        {
            FocusIndicator.SetValue(Shape.StrokeProperty, _focusedBrush);
            _manuallyFocused = true;
            _dataContext.Device.SetProperty(KnownCameraPhotoProperties.LockedAutoFocusParameters,
                AutoFocusParameters.Exposure & AutoFocusParameters.Focus & AutoFocusParameters.WhiteBalance);
        }
        else
        {
            _manuallyFocused = false;
            _dataContext.Device.SetProperty(KnownCameraPhotoProperties.LockedAutoFocusParameters, AutoFocusParameters.None);
        }
        _focusSemaphore.Release();
    }
} 
```

以下是如何在 WP8 中实现您自己的捏合缩放功能@Windows [Phone 8 中的捏合缩放功能](https://stackoverflow.com/questions/13969400/pinch-to-zoom-functionality-in-windows-phone-8/14026341#14026341)

在您的情况下，我要添加到捏合缩放代码示例中的一件事是父控件上的**[Clip](http://msdn.microsoft.com/en-us/library/system.windows.uielement.clip.aspx)**规范，以确保您不会意外渲染比屏幕大数十或数百倍的图像并破坏您的应用程序的性能.

# sql - 相互引用两个表

> ID：14467119
> 
> 赞同：1
> 
> 时间：2013-01-22T20:07:57.773
> 
> 标签：sql, sql-server

出于好奇；

如果我有两张桌子，A 和 B；

```
A
ID int (PK)
B_ID int (FK)

B
ID int (PK)
A_ID int (FK) 
```

A 引用了 B。B 引用了 A。A_ID 和 B_ID 不可为空。

如何向这些表中添加行？我不能在不向 B 添加一行的情况下向 A 添加一行，反之亦然，但是如果表包含此数据；

```
A
ID   B_ID
1    100

B
ID   A_ID
100  1 
```

那么显然这很好。如果我想插入这些数据，我是否必须首先禁用数据完整性，或者我可以以某种方式一次添加这两行？

谢谢，并为标题道歉 - 我不知道这叫什么，或者我自己查一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:44:25.560

msdn上有一篇解释清楚的文章：

[http://blogs.msdn.com/b/sqlazure/archive/2010/07/01/10033575.aspx](http://blogs.msdn.com/b/sqlazure/archive/2010/07/01/10033575.aspx)

另一个在维基百科上：

[http://en.wikipedia.org/wiki/Circular_reference](http://en.wikipedia.org/wiki/Circular_reference)

看看两者并仔细阅读它们。

希望它可以帮助你。

干杯

# c# - MEF 加载和卸载特定插件？

> ID：14467124
> 
> 赞同：2
> 
> 时间：2013-01-22T20:08:05.793
> 
> 标签：c#, winforms, plugins, mef

我是插件世界的新手，不得不理解 mef。目前我知道如何从特定文件夹加载插件。现在我有一些问题：

*   我可以从配置文件（序列化）中指定的文件夹加载插件吗？
*   我如何卸载插件？
*   如何在最小和最大版本之间加载特定版本的插件？
*   我如何包装目录并撰写例如“MEF Manager”之类的东西

可选：

*   我如何显示插件中的表单？

感谢帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T11:29:37.213

> 我可以从配置文件（序列化）中指定的文件夹加载插件吗？

[是的，您可以使用 MEF 的DirectoryCatalog](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition.hosting.directorycatalog.aspx)类从文件夹加载插件。不过，您必须在配置文件中添加自己的部分，并`DirectoryCatalog`为插件所在的每个文件夹创建一个。[Unraveling the Mysteries of .NET 2.0 Configuration](http://www.codeproject.com/Articles/16466/Unraveling-the-Mysteries-of-NET-2-0-Configuration)包含有关如何使用`System.Configuration`命名空间中的类的重要信息。

> 我如何卸载插件？

这取决于卸载插件的含义。

*   从文件夹中删除程序集时卸载插件可以使用`AllowRecomposition`MEF 的导入属性的属性和每个插件文件夹的[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)来监视已删除的 .dll 文件并调用该`DirectoryCatalog.Refresh`方法以强制更新 MEF 容器。请注意，默认情况下您不能删除由 .NET 加载的程序集。为了克服这个问题，.NET 支持[Shadow Copying](http://msdn.microsoft.com/en-us/library/ms404279.aspx)。查看 Glenn Block 的[The Way of MEF](http://codebetter.com/glennblock/2010/06/13/way-of-mef-slides-and-code/)代码。这`PartUpdatesInPlace`是如何做到这一点的一个很好的例子。

*   在没有文件系统的情况下卸载插件是另一回事。你必须自己做这件事。通常你需要一个可以随意卸载插件的插件管理器。

请注意，加载的程序集不会仅卸载插件。

> 如何在最小和最大版本之间加载特定版本的插件？

您可以使用 MEF 的[导出元数据](http://mef.codeplex.com/wikipage?title=Exports%20and%20Metadata)来添加插件元数据。然后您使用 CompisitionContainer 的[GetExports](http://msdn.microsoft.com/en-us/library/system.componentmodel.composition.hosting.compositioncontainer.aspx)[方法](http://msdn.microsoft.com/en-us/library/dd833149.aspx)并在访问实际插件之前检查元数据。这是基于 MEF 的插件解决方案的标准程序。另请查看在 MEF2 中添加的[ExportFactory](http://msdn.microsoft.com/en-us/library/ff382807%28v=vs.95%29.aspx)类以获得更好的方法。

> 我如何包装目录并撰写例如“MEF Manager”之类的东西

从一个非常简单的插件管理器类开始，它提供了基础知识（取决于你想要做什么）并以此为基础构建。

> 我如何显示插件中的表单？

您可以采用与没有 MEF 的情况相同的方式进行操作。例如，您可以将表单属性添加到插件接口/基类，并让每个插件负责创建/处理它。

在开始执行所有这些操作之前，我建议您检查`Prism`（复合应用程序指南）和`Smart Client Software Factory`. 这些是需要极大灵活性的 WPF 和 WinForms 应用程序的强大框架。如果您决定检查它们，我认为最好的方法是使用样品。

祝你好运

# ruby-on-rails - 正确使用“form_for”，使用 :url 参数还是可以直接输入 :action？

> ID：14467127
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:08:13.790
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我很难理解下面两行的区别。唯一的区别是***:url =>的用法***

1-在我看来，以下行正在生成错误（删除 form_for 会删除错误并且渲染完成且没有错误）：

```
<%= form_for( [@company, @appointment], :action => 'company_edit', :html => {:class => "form-horizontal"}) do |f| %> 
```

我花了很多时间试图弄明白这个错误，但我不知道“company_edit”是从哪里来的。

```
ActionView::Template::Error (undefined method `company_appointment_path' for #<#<Class:0x5047cc8>:0x5045070>):
9:       </div>
10:       <div class="widget-content nopadding">
11:         <!--form action="#" method="get" class="form-horizontal"-->
12:         <%= form_for([@company, @appointment], :action => 'company_edit', :html => {:class => "form-horizontal"}) do |f| %>
13:           <% if @appointment.errors.any? %>
14:             <div class="control-group">
15:                 <div id="error_explanation">
app/views/appointments/company_edit.html.erb:12:in `_app_views_appointments_company_edit_html_erb___287242072_42128364' 
```

这是我的路线文件的***片段：***

```
resources :companies do

  resources :appointments, only: [:company_edit] do
    member do
      get 'company_edit', :as => :company_edit
    end
  end
end 
```

2-我发现使用 :url 后，一切都恢复了，但为什么呢？

```
<%= form_for([@company, @appointment], :url => {:action => 'company_edit'}, :html => {:class => "form-horizontal"}) do |f| %> 
```

我试图理解这一点，因为我在很多地方都使用过 'form_for' 而我之前从未使用过 ':url =>' 并且我想知道我是否没有正确使用 'form_for' 并且我现在需要更新我的正确使用帮助程序的代码。

* * *

## 编辑

这是我的控制器：

```
def company_edit
    @appointment = Appointment.find(params[:id])
    @company = Company.find(params[:company_id])

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:45:57.397

恐怕你的问题的答案是否定的。

`:action`不是 可识别的选项参数`form_for`。

这是API：

[http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for)

`:url`是它识别的一个选项，它本身包含一个选项哈希，其中包括`:action`.

我希望这会有所帮助。

# linux - 想要运行 .sh Linux shell 脚本来重命名文件

> ID：14467130
> 
> 赞同：1
> 
> 时间：2013-01-22T20:08:20.280
> 
> 标签：linux, shell, unix, batch-file

我想运行一个 .sh 脚本来重命名`desktop/reports/don`我计算机目录中的文件。我需要的一个例子是重命名：

```
TACOS_2013-Jan-22__00-50-00_UTC.csv 
```

至

```
TACOS_20130122_005000.csv 
```

我有以下使用 Windows 批处理脚本（.bat 文件）创建的脚本。我想把它转换成 linux shell 脚本。

```
@echo off
setlocal
for /f "tokens=2-7 delims=_.-" %%A in ('dir /B TACOS_*') do (
  setlocal enabledelayedexpansion
  call :getmonth %%B
  ren TACOS*_*%%A-%%B-%%C*_*%%D-%%E-%%F_UTC.csv TACOS_%%A!mon!%%C_%%D%%E%%F.csv
  endlocal
)

:getmonth
if "%1" equ "Jan" set mon=01
if "%1" equ "Feb" set mon=02
if "%1" equ "Mar" set mon=03
if "%1" equ "Apr" set mon=04
if "%1" equ "May" set mon=05
if "%1" equ "Jun" set mon=06
if "%1" equ "Jul" set mon=07
if "%1" equ "Aug" set mon=08
if "%1" equ "Sep" set mon=09
if "%1" equ "Oct" set mon=10
if "%1" equ "Nov" set mon=11
if "%1" equ "Dec" set mon=12
goto :eof
endlocal 
```

这是我到目前为止所做的......请帮忙

```
#!/bin/bash
month["Jan"]=01
month["Feb"]=02
month["Mar"]=03
month["Apr"]=04
month["May"]=05
month["Jun"]=06
month["Jul"]=07
month["Aug"]=08
month["Sep"]=09
month["Oct"]=10
month["Nov"]=11
month["Dec"]=12

directory="desktop/reports/Don/"
for path in "${directory}TACOS_"*; do

    path=${path#${directory}}
    newpath=${path:0:10}${month[${path:11:3}]}${path:15:2}
    newpath=${newpath}__$(tr -d '-' <<< ${path:19:8}).csv

    echo "${directory}${path}" "${directory}${newpath}" # Run this one first!!!
    # mv "YOUR/PATH/${path}" "YOUR/PATH/${newpath}"
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:43:33.960

现在你说得更清楚了，我想这就是你想要的：

*   将“MONTH NAME”映射到“MONTH NUMBER”的关联数组；
*   将文件从“TACOS_YYYY-month-dd__HH-MM-SS*.csv”重命名为“TACOS_YYYYmmdd_HHMMSS.csv”。

bash 脚本中的解决方案：

```
#!/bin/bash
declare -A month
month["Jan"]=01
month["Feb"]=02
month["Mar"]=03
month["Apr"]=04
month["May"]=05
month["Jun"]=06
month["Jul"]=07
month["Aug"]=08
month["Sep"]=09
month["Oct"]=10
month["Nov"]=11
month["Dec"]=12

directory="YOUR/PATH/TACOS_"
for path in "${directory}"*; do

    path=${path#${directory}}
    newpath=${path:0:4}${month[${path:5:3}]}${path:9:2}
    newpath=${newpath}__$(tr -d '-' <<< ${path:13:8}).csv

    echo "${directory}${path}" "${directory}${newpath}" # Run this one first!!!
    # mv "YOUR/PATH/${path}" "YOUR/PATH/${newpath}"

done 
```

这会将字符串`path=TACOS_2013-Jan-22__00-50-00_UTC.csv`转换为`newpath=TACOS_20130122__005000.csv`，并将初始文件重命名为`mv`构造的新路径。

如解释一样，`bash`为您提供关联数组，您**必须**在任何操作之前使用`declare -A assoc_array`.

在`bash`您可以采用字符串间隔，设置 an `offset`， a`length`和doing `${string:offset:length}`。连接是通过字符串的并置来执行的，并且赋值之间不能有空格`left_value=right_value`。

此外，您有`tr`命令，将您的字符串从`initial`to翻译`initial_without_characters`，因为该标志`-d`已被使用。您可以查看以`man tr`供进一步参考。

**编辑：**

由于您没有更新版本的`bash`，您可以使用以下代码：

```
#!/bin/bash
function month() {

    case $1 in
        "Jan") echo "01" ;;
        "Feb") echo "02" ;;
        "Mar") echo "03" ;;
        "Apr") echo "04" ;;
        "May") echo "05" ;;
        "Jun") echo "06" ;;
        "Jul") echo "07" ;;
        "Aug") echo "08" ;;
        "Sep") echo "09" ;;
        "Oct") echo "10" ;;
        "Nov") echo "11" ;;
        "Dec") echo "12" ;;
    esac

}

directory="YOUR/PATH/TACOS_"
for path in "${directory}"*; do

    path=${path#${directory}}
    newpath=${path:0:4}$(month ${path:5:3})${path:9:2}
    newpath=${newpath}__$(tr -d '-' <<< ${path:13:8}).csv

    echo "${directory}${path}" "${directory}${newpath}" # Run this one first!!!
    # mv "YOUR/PATH/${path}" "YOUR/PATH/${newpath}"

done 
```

# ruby - 动作控制器：不兼容的字符编码：ASCII-8BIT 和 UTF-8？

> ID：14467131
> 
> 赞同：0
> 
> 时间：2013-01-22T20:08:29.313
> 
> 标签：ruby, ruby-on-rails-3, encoding, utf-8

我有一个文本文件，其中包含一些®（注册商标）符号。该文件采用 UTF-8 格式。

我正在尝试导入此文件并使用 Rails 3 填充 MySQL 数据库。数据库似乎设置得很好，可以采用 UTF-8

```
+-------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+
| Field       | Type         | Collation       | Null | Key | Default | Extra          | Privileges                      | Comment |
+-------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+
| id          | int(11)      | NULL            | NO   | PRI | NULL    | auto_increment | select,insert,update,references |         |
| user_id     | int(11)      | NULL            | YES  | MUL | NULL    |                | select,insert,update,references |         |
| title       | varchar(255) | utf8_general_ci | YES  |     | NULL    |                | select,insert,update,references |         |
| translation | text         | utf8_general_ci | YES  |     | NULL    |                | select,insert,update,references |         |
| created_at  | datetime     | NULL            | NO   |     | NULL    |                | select,insert,update,references |         |
| updated_at  | datetime     | NULL            | NO   |     | NULL    |                | select,insert,update,references |         |
+-------------+--------------+-----------------+------+-----+---------+----------------+---------------------------------+---------+ 
```

然而，当我尝试这样做时：

```
trans_file = params[:descriptions] #coming from file_field_tag
trans = trans_file.read.split("\r\n")
trans.each do |tran|
  ttl = ''
  desc = ''
  tran.split(']=').each do |title|
    if title =~ /\[/ #it's the title
      ttl = title.sub('[','')
    else
      desc = title.gsub('FFF', "\r\n")
    end
  end
  @current_user.cd_translations.build(title: ttl, translation: desc).save 
```

我收到错误“操作控制器：不兼容的字符编码：ASCII-8BIT 和 UTF-8”。

我在 application.rb 文件中使用 utf-8 编码，并且使用 mysql2 gem。

如果我删除注册商标字符，错误就会消失。但是，将其从传入的文本中剥离并不是一个真正的选择。

我在这里尝试了解决方案：[https](https://stackoverflow.com/a/5215676/102372) ://stackoverflow.com/a/5215676/102372 ，但这没有任何区别。

堆栈跟踪：

```
app/controllers/users_controller.rb:28:in `block in update_cd_translations'
app/controllers/users_controller.rb:15:in `each'
app/controllers/users_controller.rb:15:in `update_cd_translations'
config/initializers/quiet_assets.rb:7:in `call_with_quiet_assets' 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:12:56.393

看来ruby认为上传文件的编码是ascii-8bit（也就是二进制）。

如果您知道文件的编码，则可以使用`force_encoding!`更改字符串的编码（无需转码）。如果您并不总是确定文件的编码，`charguess`可以使用 gem 来猜测它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:17:55.833

尝试添加一个

```
# -*- encoding : utf-8 -*- 
```

在每个文件的开头，包含在整个过程中

# php - 4倍？随机图像表php

> ID：14467133
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:08:37.233
> 
> 标签：php

所以我试图创建一个图像库，在 4 列表的每个单元格中显示一个随机图像，并随着更多图像添加到文件夹中而自动扩展，并尝试对其进行设置，以便每次加载时都会随机化图像。是的，它只是按顺序读取图像，并在每一行重新开始，而不是继续浏览图像。我的代码：

```
 $file = null;

    $fileList = glob("./upload/*.*");
    //create table tag
    echo '<table border=1 cellspacing=1 cellpadding=2 width=100%>'; 
    //create tr tag
    echo '<tr>';  
    # Print each file
    echo "Files found:"; foreach($fileList as $file) {   
    echo " - ". $file;   
    echo '<td width="25%"><img src="' . $file . '" width="100%" /></td>'; }

    echo '</tr>'; 
    echo '</table>'; 
```

那是我的第一次尝试，它只是创建了我的第二次尝试的单行：

```
 //create table
    echo '<table border=1 cellspacing=1 cellpadding=2 width=100%>';
    echo '<tr>';

    $x = 1;
    $y = 1;

    //  Display  the  results 
    do { 

    do {
    foreach($fileList as $file) 
    echo '<td width="25%"><img src="' . $file . '" width="100%" /></td>';
    $x = $x +1;
    $y = $y +1;
    }
    while ($x <= 3);

    do {
    foreach($fileList as $file) 
    echo '<td width="25%"><img src="' . $file . '" width="100%" /></td>';
    echo '</tr>';
    echo '<tr>';
    $x = $x - 4;
    $y = $y +1; 
}
    while ($x = 5);
    } 
    while ($y <= 20);

    echo '</tr>';   
    echo '</table>'; 
```

这次它只是在每一行重新开始并为多行创建方式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:30:27.157

每次调用时，您的 foreach 循环都会重新开始。您应该放弃 do/while 循环并改用 for 循环。一个用于行，一个用于列：

```
$fileList = glob("./upload/*.*");
echo '<table border=1 cellspacing=1 cellpadding=2 width=100%>'

// Determine max rows:
$max_rows = ceil(count($fileList) / 4);

// Keep an index
$index = 0;

// First loop for rows
for ($row = 0; $row < $max_rows; $row++) {
    // Start a new table row
    echo '<tr>';
    // Second loop for columns
    for ($col = 0; $col < 4; $col++) {
        if ($index < count($fileList)) {
            echo '<td width="25%"><img src="' . $fileList[$index++] . '" width="100%" /></td>';
        }
        else {
           echo '<td></td>';
        }
    }
    echo '</tr>';
}
echo '</table>'; 
```

# perl - 通常不解码到 STDERR 的输出吗？

> ID：14467134
> 
> 赞同：1
> 
> 时间：2013-01-22T20:08:52.433
> 
> 标签：perl, character, encode, dbi, stderr

当我运行这个脚本（或使用 DBD::SQLite 或 DBD::MySQL 的类似脚本）时，看起来返回的错误消息没有被解码。
通常不解码到 STDERR 的输出吗？

```
#!/usr/bin/env perl
use warnings;
use strict;
use utf8;
use open qw( :encoding(UTF-8) :std );
use DBI;

my $dbh = DBI->connect( "DBI:Pg:dbname=my_test_db", 'username', 'password', {
    PrintError => 0,
    RaiseError => 1,
    AutoCommit => 1,
    pg_enable_utf8 => 1,
} ) or die DBI->errstr;

my $sth = $dbh->prepare( "S☺LECT * FROM abteilung" );
$sth->execute(); 
```

输出：

```
#DBD::Pg::st execute failed: FEHLER:  Syntaxfehler bei Â»SâºLECTÂ«
#ZEILE 1: SâºLECT * FROM abteilung
#         ^ at ./perl2.pl line 16. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T23:54:45.373

这可能是双重编码的情况。驱动程序使用 UTF-8 对您的查询进行编码，然后将该查询包含在错误消息中，然后您（正确）为输出进行编码。

# ruby-on-rails - 嵌套属性无法让我访问关联的模型数据

> ID：14467137
> 
> 赞同：0
> 
> 时间：2013-01-22T20:09:11.687
> 
> 标签：ruby-on-rails, form-for, nested-form-for

我正在寻找为以下数据结构构建表单的正确方法：

```
class Profile < ActiveRecord::Base
  attr_accessible :name
  has_many :weights
  accepts_nested_attributes_for :weights
end

class Tag < ActiveRecord::Base
  attr_accessible :name
  has_many :weights
end

class Weight < ActiveRecord::Base
  attr_accessible :weight, :profile_id, :tag_id
  belongs_to :profile
  belongs_to :tag
end 
```

在编辑配置文件表单中，我想提取所有权重并允许用户更新它们。我已经能够使用这样的嵌套属性来做到这一点：

```
<%= form_for [:admin, @profile] do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :name %>
    <%= f.text_field :name %>
  </p>
  <div class='weights'>
    <%= f.fields_for :weights do |ff| %>
      <%= ff.label :weight %>
      <%= ff.text_field :weight %>
    <% end %> 
  </div>

  <%= f.submit %> 
<% end %> 
```

问题是我实际上也想在每个权重行上提取相关 tag_id 的标题（这样人们就知道他们正在更改哪个权重的标签）。我看不到提取此信息的方法，我是否应该在写出此表格之前进行某种形式的加入？这是一种愚蠢的方法吗？

感谢大家

-尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:14:09.157

You should be able to get at the weight through `ff.object` and tag through `ff.object.tag.title`. Have you tried this?

# c# - 在 C# 中从类型转换为接口

> ID：14467138
> 
> 赞同：0
> 
> 时间：2013-01-22T20:09:18.557
> 
> 标签：c#, asp.net, entity-framework

我正在构建一个 ASP.NET 应用程序，它将查询捕获产品中的制造错误的三个表之一。当然，每个表都反映在一个 EF 实体中。在提交页面并设置一个标志来指示要查询哪些错误之前，不会确定将查询哪个表。

这三个实体中的每一个都有许多共同的属性。这些共性已在接口中定义并由实体实现（通过部分类定义）。所以那些部分类看起来像......

```
public partial class ProductException : IExceptionEntity { }
public partial class PartException : IExceptionEntity { }
public partial class RebuildException: IExceptionEntity { } 
```

在存储库类中，我定义了一个通用方法，允许我查询我指定的异常实体。这是必要的，因为 WHERE 子句作为参数传入方法，可能包含未在接口中定义的字段，并且特定于单个异常实体（产品、部件和重建）。所以称那些看起来像..

```
IQueryable<ProductException> prodQuery = Repository.GetFilteredQuery<ProductException>(query, whereClause);
IQueryable<PartException> partQuery = Repository.GetFilteredQuery<PartException>(query, whereClause);
IQueryable<RebuildException> rebuildQuery = Repository.GetFilteredQuery<RebuildException>(query, whereClause); 
```

网页永远不会定义一个查询，并且无论查询结果如何，它对查询结果的处理方式都非常相似，因此我希望能够分配一个变量/属性，可以用于访问查询/结果，无论查询的是哪个实体。像下面的东西......

```
 protected override void OnPreLoad(EventArgs e)
    {
         InitializeExceptionQuery();
    }

    List<IExceptionEntity> _exceptionList = null;
    public List<IExceptionEntity> ExceptionList
    {
        get 
        { 
            if(_exceptionList == null)
                _exceptionList = LookupQuery.ToList();

            return _exceptionList;
        }
    }

    IQueryable<IExceptionEntity> _query = null;
    public IQueryable<IExceptionEntity> LookupQuery
    {
        get 
        { 
            if(_query == null)
                _query = GetExceptionQuery(this.ExceptionCategory); 

            return _exceptionList;
        }
        set
    { this._query = value; }
    }

    private void InitializeExceptionQuery()
    {
        String whereClause = "Filters defined here from user control properties.";

        switch (this.ExceptionCategory)
        {
            case ExceptionCategories.Product:
                this.LookupQuery = base.Repository.GetFilteredQuery<ProductException>(this.LookupQuery, whereClause, this.SortField, this.SortDirection).Cast<IExceptionEntity>();
                break;
            case ExceptionCategories.Part:
                this.LookupQuery = base.Repository.GetFilteredQuery<PartException>(this.LookupQuery, whereClause, this.SortField, this.SortDirection).Cast<IExceptionEntity>();
                break;
            case ExceptionCategories.Rebuild:
                this.LookupQuery = base.Repository.GetFilteredQuery<RebuildException>(this.LookupQuery, whereClause, this.SortField, this.SortDirection).Cast<IExceptionEntity>();
                break;
            case ExceptionCategories.UNKNOWN:
                throw new ArgumentException("Exception Category is undefined");
        }
    }

    private void BindQueryResults()
    {

        switch (this.ExceptionCategory)
        {
            case ExceptionCategories.Product:
                listView.DataSource = this.ExceptionList.Cast<ProductException>();
                listView.DataBind(); 
                break;
            case ExceptionCategories.Part:
                listView.DataSource = this.ExceptionList.Cast<PartException>();
                listView.DataBind();
                break;
            case ExceptionCategories.Rebuild:
                listView.DataSource = this.ExceptionList.Cast<RebuildException>();
                listView.DataBind();
                break;
            case ExceptionCategories.UNKNOWN:
                throw new ArgumentException("Exception Category is undefined");
        }
    } 
```

整个目标是我希望能够调用 ExceptionList 属性，将其转换为实现 IExceptionEntity 接口的类型之一，瞧！无论我要查询的三个实体中的哪一个，都有一个点可以从中检索结果……即参见 BindQueryResults()。

然而，事实并非如此。当我运行它时，ExceptionList 属性在尝试将 Query 转换为列表 (.ToList()) 时抛出异常

```
Unable to cast the type 'PartException' to type 'IExceptionEntity'. LINQ to Entities only supports casting EDM primitive or enumeration types. 
```

我认为您可以根据需要来回转换接口和实现它的类。显然情况并非如此，我认为这是有道理的，但是还有其他方法可以完成我想要做的事情吗？我必须相信有。其他人有同样的难题吗？

谢谢你，G

**更新：2013-01-22**

我的印象是，如果我从基类而不是接口派生，我将能够将 ExceptionList 从基类转换为派生类，然后再返回。

为此，我一直在遵循 HighCores 的建议。我有 ...

*   在概念模型 (EDMX) 中创建一个实体，其中包含三个“异常”实体（ProductException、PartException、RebuildException）之间共享的所有属性。我将其命名为“ExceptionBase”
*   从三个异常扩展中删除了这些字段并从“ExceptionBase”派生它们

我现在遇到的问题是每个异常实体与其基础表之间的映射被破坏了。我需要将基类中的字段映射到派生实体的基础表。我希望能够在“映射详细信息”窗口中从基类中选择值/属性以映射到相应的表列，但是唯一可用的值是派生类的值，而不是基类的值班级。

**更新：2013-01-23**

事实证明，我使用的概念模型使用 TPT（按类型表策略），这就是以这种方式实现继承不起作用的原因。必须将公共字段拆分到数据库中自己的表中，以便我从它们继承。不幸的是，数据库模式无法更改。

我参考了以下文章，希望有人也会觉得有用：

*   [在 ASP.NET MVC 应用程序中使用实体框架实现继承](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-inheritance-with-the-entity-framework-in-an-asp-net-mvc-application)
*   [EF Code First 的继承：第 2 部分 – 每种类型的表 (TPT)](https://stackoverflow.com/questions/9564972/how-to-implement-inheritance-table-per-type-in-entity-framework-4-3-via-code-fir)

因此，如果有人有任何其他想法，我仍在寻找一种方法来实现这一点，我欢迎任何进一步的建议。

**更新：2013-01-23**

谢谢马修的回复！我的表结构看起来像......

*产品异常*

*   身份证 [PK]
*   产品名称
*   **异常消息**
*   **异常服务**

*零件异常*

*   身份证 [PK]
*   零件名称
*   零件制造商
*   零件成本
*   产品编号 [FK]
*   **异常消息**
*   **异常服务**

*重建异常*

*   身份证 [PK]
*   重建原因
*   重建制造商
*   产品编号 [FK]
*   **异常消息**
*   **异常服务**

基本上我想创建一个带有 ExceptionMsg、ExceptionSev 和 ID(?) 的 BaseEntity，因为这些字段由所有三个异常实体共享。

* * *

**注意：**是否有人否决了这篇文章，请提供解释？只有当我能从错误中吸取教训时，投反对票才有用，以免重蹈覆辙。

# asp.net-mvc - 设置 devexpress mvc Gridview 组合框的高度

> ID：14467150
> 
> 赞同：1
> 
> 时间：2013-01-22T20:10:16.500
> 
> 标签：asp.net-mvc, combobox, devexpress

我正在使用带有几个组合框的 DEvExpress mvc 网格，我想知道如何设置下拉部分的最大/最小高度（在多行中）。

例如，我是否可以在必须滚动之前设置可见的行，或者即使只有一行数据可以将下拉高度设置为一定数量的行。

我现在拥有的组合的当前代码是

```
@Html.DevExpress().ComboBox(edtSettings =>
{
    edtSettings.ControlStyle.CssClass = "employeeDetailsGridEditField";
    edtSettings.Name = "DepartmentID";
    edtSettings.Width = 350;
    //edtSettings.Height = 200; 
    //THIS sets the height of the initial control not the drop down part
    edtSettings.Properties.TextField = "DepartmentName";
    edtSettings.Properties.ValueField = "DepartmentID";
    edtSettings.Properties.ValueType = typeof(int);
    edtSettings.Properties.DropDownStyle = DropDownStyle.DropDown;
    edtSettings.ShowModelErrors = true;
}).BindList(Model.DepartmentList).Bind(Model.EmployeeSingle.DefaultDepartmentID).GetHtml() 
```

下拉部分高度是否有属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T09:30:59.797

使用[ComboBoxProperties.DropDownRows](http://help.devexpress.com/#AspNet/DevExpressWebASPxEditorsComboBoxProperties_DropDownRowstopic)属性来获取或设置同时显示在编辑器的可滚动下拉窗口中的列表项的数量：

```
@Html.DevExpress().ComboBox(edtSettings =>
{
    //...
    edtSettings.Properties.DropDownRows = 5; // default is 7 
    //...        
}).BindList(Model.DepartmentList).Bind(Model.EmployeeSingle.DefaultDepartmentID).GetHtml() 
```

# php - 需要有关编写此 php 练习的逻辑的建议

> ID：14467155
> 
> 赞同：1
> 
> 时间：2013-01-22T20:10:29.720
> 
> 标签：php, logic

我在一个文本文件中有一个列表，其中包含英语中使用的前 1000 个单词。每行有一个最多 50 个单词的列表，如下所示：

> the,stuff,is,thing,hi,bye,hello,a,stuffs
> cool,free,awesome,the,pray,is,crime
> 等。

我需要使用该文件作为输入编写代码，以制作一个输出文件，其中包含一组单词对，这些单词对至少出现在五十个不同的列表中。例如，在上面的例子中，THE & IS 一起出现了两次，但每隔一对只出现一次。

我无法存储所有可能的单词对，所以没有蛮力。

我正在努力学习这门语言，但我一直坚持这本书的练习。请帮忙。对此的任何逻辑、指导或代码都会对我有所帮助。

这就是我到目前为止所拥有的。它没有达到预期的效果，但我被困住了：

代码：

```
//open the file
$handle = fopen("list.txt", 'r');

$count = 0;
$is = 0;
while(!feof($handle)) {

    $line = fgets($handle); 

    $words = explode(',', $line);

    echo $count . "<br /><br />";
    print_r($words);
    foreach ($words as $word) {
        if ($word == "is") {
            $is++;
        }
    }
    echo "<br /><br />";

$count++;
}

echo "Is count: $is";

//close the file
fclose($handle);

$fp = fopen('output.txt', 'w');
fwrite($fp, "is count: " . $is);
fclose($fp); 
```

这是我想出的，但我认为它太臃肿了：

计划：
检查数组的第一个值`$words`将
值存储到`$cur_word`
存储`$cur_word`中作为数组中的键（`$compare`）并将
计数器（行号）存储为该键的值， 此时
它将为1如果然后 将值与键一起放入，就 好像数组至少有50个值然后继续 否则转到数组的下一个值 如果它有50个值然后 转到下一个值并做同样的事情 比较两个列表查看 至少有 50 个匹配的值，然后将 单词附加到输出文件
`$cur_word`
`$compare``$cur_word`
`$words`

对每个单词重复这个过程

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T01:43:06.760

这个问题可能有 100 种解决方案。这是一个

```
$contents = file_get_contents("list.txt");

//assuming all words are separated by a , and converting new lines to word separators as well
$all_words = explode(",", str_replace("\n", ",", $contents)); 
$unique_words = array();    
foreach ($all_words as $word) {
    $unique_words[$word] = $word;
} 
```

这将为您提供数组中文件中的所有唯一单词。

您也可以使用相同的技术来计算单词

```
$word_counts = array();
foreach ($all_words as $word) {
    if (array_key_exists($word, $word_counts)) {
        $word_counts[$word]++;
    } else {
        $word_counts[$word] = 1;
    }
} 
```

然后您可以循环并保存结果

```
$fp = fopen("output.txt", "w");
foreach ($word_counts as $word => $count) {
    fwrite($fp, $word . " occured " . $count . " times" . PHP_EOL);
}
fclose($fp); 
```

# html - div（如果里面有另一个 div）+ div { }

> ID：14467159
> 
> 赞同：0
> 
> 时间：2013-01-22T20:10:42.263
> 
> 标签：html, css

如何制定将执行以下操作的规则：

.container .unit:first-child(如果里面有 div.box1.extra) + .box2 { top: 50px;}

```
<div class="container">
   <div class="unit">
       <div class="box1 extra"><!-- content --></div>
   </div>

   <div class="unit">
       <div class="box1"><!-- content --></div>
   </div>

   <div class="box2"><!-- content --></div>                 
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:13:49.367

This is unfortunately not possible with CSS at present. What you are referring to is DOM traversal with CSS. What you can do is simply declare the rule anyway.

```
.container .unit:first-child .box1.extra + .box2 { top: 50px;} 
```

if the `.box2` element does not exist, nothing will change. for the units that do have a `.box2`, the rule will apply.

EDIT: Note that this only works if `.box2` is a child of `.unit`. If `.unit` and `.box2` are siblings, this unfortunately impossible.

# ruby - 当任何 .. 值已知时，是否可以找到 .. 文本？

> ID：14467164
> 
> 赞同：0
> 
> 时间：2013-01-22T20:11:24.397
> 
> 标签：ruby, mechanize, mechanize-ruby

我有一个类似于`html`以下格式的网页：

```
<form name="test">

<td> .... </td>
  .
  .
  .
<td> <A HREF="http://www.edu/st/file.html">alo</A> </td>
<td> <A HREF="http://www.dom/st/file.html">foo</A> </td>
<td> bla bla </td>

</form> 
```

现在，我只知道 value `bla bla`，我们可以根据 value 跟踪或找到`3rd last` .. value （这里是`alo`）？我可以在价值观的帮助下追踪这些，`HREF`但这些`HREF`价值观并不总是固定的，它们可以是任何时候的任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:15:58.237

见[http://nokogiri.org/](http://nokogiri.org/)

它可以帮助您解析 html 代码，然后通过选择器找到元素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:26:29.453

从 HTML 文档中提取所有`<td>`内容很容易，但它并不是浏览 DOM 的万无一失的方法。但是，鉴于示例 HTML 的局限性，这里有一个解决方案。我怀疑它会在现实世界的情况下工作。

Mechanize 在内部使用 Nokogiri 进行繁重的工作，因此`require 'nokogiri'`如果您已经需要 Mechanize，则无需这样做。

```
require 'nokogiri'

doc = Nokogiri::HTML::DocumentFragment.parse(<<EOT)
<td> <A HREF="http://www.edu/st/file.html">alo</A> </td>
<td> <A HREF="http://www.dom/st/file.html">foo</A> </td>
<td> bla bla </td>
EOT

doc.search('td')[-3].at('a')['href']
=> "http://www.edu/st/file.html" 
```

如何从 Mechanize“代理”获取 Nokogiri 文档留给用户练习。

# sql - SQL MIN() 更小/更大无法正常工作

> ID：14467165
> 
> 赞同：2
> 
> 时间：2013-01-22T20:11:30.610
> 
> 标签：sql

我在数据库中有这个数据

```
CREATE TABLE Stu_Table
(
    Stu_Id VARCHAR(2),
    Stu_Name VARCHAR(15), 
    Stu_Class VARCHAR(10),
    sub_id VARCHAR(2),
    marks VARCHAR(3)
);

INSERT INTO Stu_Table VALUES (1, 'Komal', 10, 1, 45);
INSERT INTO Stu_Table VALUES (2, 'Ajay', 10, 1, 56);
INSERT INTO Stu_Table VALUES (3, 'Rakesh', 10, 1, 67);
INSERT INTO Stu_Table VALUES (1, 'Komal', 10, 2, 47);
INSERT INTO Stu_Table VALUES (2, 'Ajay', 10, 2, 53);
INSERT INTO Stu_Table VALUES (3, 'Rakesh', 10, 2, 57);
INSERT INTO Stu_Table VALUES (1, 'Komal', 10, 3, 45);
INSERT INTO Stu_Table VALUES (2, 'Ajay', 10, 3, 56);
INSERT INTO Stu_Table VALUES (3, 'Rakesh', 10, 3, 67);
INSERT INTO Stu_Table VALUES (1, 'Komal', 10, 4, 65);
INSERT INTO Stu_Table VALUES (2, 'Ajay', 10, 4, 56);
INSERT INTO Stu_Table VALUES (3, 'Rakesh', 10, 4, 37);
INSERT INTO Stu_Table VALUES (1, 'Komal', 10, 5, 65);
INSERT INTO Stu_Table VALUES (2, 'Ajay', 10, 5, 46);
INSERT INTO Stu_Table VALUES (3, 'Rakesh', 10, 5, 63); 
```

我正在对这些数据进行查询。

```
SELECT *
FROM
(
    SELECT
        Stu_Id,
        MIN(marks) AS mini,
        AVG(marks) AS per
    FROM stu_table
    GROUP BY stu_id
    HAVING MIN(marks) > 45
); 
```

我得到了这个：

```
Stu_Id| mini  |  per
   1  |  45   |  53.4
   2  |  46   |  53.4
   3  |  37   |  58.2 
```

我不明白为什么当我在查询中清楚地看到**Stu_Id时仍然看到 min(mark)=45 。** `1``HAVING min(marks)>45`

[可运行演示](http://ideone.com/h97DqT)

**修复：** 感谢@sybkar 和@Martin Smith！

我将标记类型设置为字符串。应该是INT...

多谢你们！工作完美！

```
create table Stu_Table(Stu_Id INT(2), Stu_Name varchar(15), 
Stu_Class  varchar(10),sub_id INT(2),marks INT(3));<--INT!!! 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:56:37.343

> 我不明白为什么当我在查询中清楚地看到**Stu_Id时仍然看到 min(mark)=45 。** `1``HAVING min(marks)>45`

你没有。或者至少您提供的演示没有。

一般来说，你得到的任何奇怪的结果都是因为`marks`被存储为一个字符串，所以`MIN(marks)`会按字母顺序最早带回。

例如`HAVING MIN(marks) > 45`还会带回`5`, `6`, `7`,`8`和`9`

# vb.net - 数据访问层返回 DataTable

> ID：14467167
> 
> 赞同：1
> 
> 时间：2013-01-22T20:11:35.470
> 
> 标签：vb.net, design-patterns

请看一下我前段时间问过的以下问题：[Breaking BLL (Business Logic Layer) to BLL and DAL (Data Access Layer)](https://stackoverflow.com/questions/14112392/breaking-bll-business-logic-layer-to-bll-and-dal-data-access-layer)

如果我从数据访问层返回一条记录，即 getNameByID 返回一条记录，这种方法（数据传输对象）似乎效果很好。

如果您有一个名为 getName() 的数据访问层函数，该函数返回许多记录，例如要在业务逻辑层处理的数千或数百万条记录，会发生什么情况？（这是一个计划任务）。当需要这样做时，我目前正在返回一个 DataTable（因为数据读取器不能超过 VB.NET 2008 中的连接）。但是，这个问题和答案似乎否定了这种方法：[Is returned DataTable or DataSet from DAL is wrong approach](https://stackoverflow.com/questions/9705794/is-returning-datatable-or-dataset-from-dal-is-wrong-approach)。这是一个糟糕的方法吗？

我意识到有像 NHibernate 这样的 ORM 工具，我计划在未来的项目中更多地使用它们。但是，我当前项目中的数据访问代码已经由其他人编写，但我想在进行过程中对其进行重构。

更新这里是一些代码（由 Stephen Doggart 建议）：

```
Imports Microsoft.VisualBasic

        Public Class PersonBLL
            Private Name As String
            Private Age As Integer

            Dim objPersonDAL As New PersonDAL
            Dim personList As List(Of Person)

            'Option 2
            Public Function getPersonByID() As List(Of Person)
                personList = objPersonDAL.getPersonByID()
                Return personList
            End Function

    Public Function ShowMessageBox(ByVal listPersonBLL As List(Of Person))
        For Each p As Person In listPersonBLL
            Me.Age = p.Age
            Me.Name = p.Name
            MsgBox(Me.Age)
            MsgBox(Me.Name)
        Next
    End Function

        End Class

        Public Class PersonDAL
            Private Name As String
            Private Age As Integer

            Public Function getPersonByID() As List(Of Person)
                'Connect to database and get Person.  Return a person object
                Dim personList As List(Of Person) = New List(Of Person)
                Dim p1 As New Person
                p1.Name = "Ian"
                p1.Age = 30
                personList.Add(p1)
                Dim p2 As New Person
                p2.Name = "Steven"
                p2.Age = 28
                personList.Add(p2)
                Dim p3 As New Person
                p3.Name = "Sharon"
                p3.Age = 29
                personList.Add(p3)
                Return (personList)
            End Function
        End Class

        Public Class Person
            Private _Name As String
            Private _Age As Integer

            Public Property Name() As String
                Get
                    Return _Name
                End Get
                Set(ByVal value As String)
                    _Name = value
                End Set
            End Property

            Public Property Age() As Integer
                Get
                    Return _Age
                End Get
                Set(ByVal value As Integer)
                    _Age = value
                End Set
            End Property
        End Class

    Public Class Form1

            Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
                'If Environment.GetCommandLineArgs(0) = "Test" Then
                'MsgBox("Test")
                'End If
                Dim p1 As PersonBLL = New PersonBLL
                Dim p2 As List(Of Person) = p1.getPersonByID()
                Dim p3 As PersonBLL = New PersonBLL
                p3.ShowMessageBox(p2)
            End Sub
        End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:23:02.163

返回 a`DataTable`并不完全糟糕——当然还有更糟糕的方法——它只是部分糟糕。但是，除非他们别无选择，否则谁愿意吃部分糟糕的食物呢？

因此，除非出于某种原因您需要使用 a ，否则`DataTable`我建议您坚持使用自定义 DTO 类并让您的 DAL 返回这些对象的列表。例如：

```
Public Function GetNames() As List(Of NameDto)
    '...
End Function 
```

# javascript - JavaScript 等价于 Membership.GetUser()

> ID：14467170
> 
> 赞同：0
> 
> 时间：2013-01-22T20:11:49.000
> 
> 标签：javascript, asp.net-membership, membership-provider

我正在使用 ASP.NET Membership Provider JavaScript 库使用以下内容对用户进行身份验证：

```
Sys.Services.AuthenticationService.login(...) 
```

为了检查他们的登录状态，我使用：

```
Sys.Services.AuthenticationService.get_isLoggedIn() 
```

但是有没有办法通过 JavaScript 获取 User 对象呢？我可以很容易地在服务器端使用：

```
MembershipUser u = Membership.GetUser(); 
```

但我正在寻找一种在 JavaScript 中执行上述操作的方法（如果可能的话）。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T10:56:26.087

您必须将数据序列化为 Javascript 变量。

（警告：即时输入。不想登录工作以通过编辑器运行它。）

```
// Copy the important user fields over.

var UserInfo = new {
  field1 = "field1"
};

JavaScriptSerializer serializer = new JavaScriptSerializer();
<script>
  var userInfo = <%= serializer.Serialize(UserInfo ) %>
</script> 
```

# c - Ansi C 中的位设置和位移

> ID：14467173
> 
> 赞同：17
> 
> 时间：2013-01-22T20:11:52.793
> 
> 标签：c, bit-manipulation, bitwise-operators, bit-shift, ansi

任何人都可以解释这种按位运算语法吗？

```
#define Bitset(var,bitno) ((var) |=1UL<<(bitno)) 
```

我知道它设置了 的位`var`，但我无法理解语法。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-22T20:17:49.110

让我们逐个分解：

`1UL`是`unsigned long int`一个值为 1 的位级别表示为：

```
00000000000000000000000000000001 
```

这`<<`是一个“位移”运算符，它将将该值中的所有位向左移动`bitno`次数。如果是`1UL<<5`，你最终会得到：

```
00000000000000000000000000100000 
```

一旦你有了这个值，`|=`（这是一个带有赋值的[按位或运算](http://en.wikipedia.org/wiki/Bitwise_operation#OR)`var`）将基本上强制与它一致的位`1`为 a`1`并且不会触及任何其他位，因为 ( `X | 0 = X`)

可以说`var`是`37`和`bitno`是`7`。然后位级别的所有内容将如下所示：

```
00000000000000000000000000100101  // var
00000000000000000000000010000000  // 1UL<<7

00000000000000000000000010100101  // var | (1UL<<7) 
```

最后，如果不清楚，`#define`标记`Bitset`为类似[函数的宏](http://en.wikipedia.org/wiki/C_preprocessor#Macro_definition_and_expansion)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-22T20:16:29.100

这是一个宏。每当预处理器遇到一个像`Bitset(var,bitno)`它一样的语句时，它都会忠实地将其替换为

```
var = var | 1UL << (bitno) 
```

进一步解释这一点。

**UL**这里的意思是**Unsigned Long**。

运算符`|`用于`bitwise OR`操作。所以变量`var`被`OR`编辑 `1UL << bitno`并分配回`var`

然后在**运行时**或**编译时**取决于程序的性质，

说`var`是`01000110` 和`bitno`是`5`

然后`1UL << 5 = 32`或`00100000`

然后

```
var = 01000110 | 00100000 
```

IE`var = 01100110`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T20:17:24.190

说 var=8，即`0000 1000`二进制。

如果你这样做

`8 | 16`您将拥有`0000 1000 | 0001 0000`which 会给您`0001 1000`，因为`|`如果任一位为 1，则操作员会设置该位。

因此，您将`|`运算符应用于您的值`1<<n`，即`0000 0001`向左移动 n 位。

例如`1 << 3`是`0000 0001 << 2 = 0000 0100`.

本质上：doing`Bitset(8,3)`将生成一个掩码，其中只有第三位通过doing `1 << 3`、getting设置`0000 0100`。然后它会将这个掩码“或”为 8，给出: `0000 1000 | 0000 0100`，结果是`0000 1100`，也就是说，你设置了 8 的第 3 位。

# html - 下拉菜单在 IE8 css 中不起作用

> ID：14467181
> 
> 赞同：0
> 
> 时间：2013-01-22T20:12:29.023
> 
> 标签：html, css, internet-explorer-8

我有一个在除 IE8 之外的所有浏览器中都可以使用的下拉 ul 菜单。我曾尝试弄乱 Z 索引，但运气不佳。当用户将鼠标悬停在第一个元素上时，它会将第二个列表显示为下拉列表，但是一旦用户尝试导航到它，它就会消失。还有什么我可能会错过的吗？请帮忙。

这是生成的 HTML：

```
<div id="topNav" class="topNavMenu">
<ul>
    <li><a href="/Main">Home</a></li>
    <li><a rel="submenu1">Account Information</a></li>
    <li><a rel="submenu2">Financial</a></li>
    <li><a rel="submenu3">Pricing</a></li>
    <li><a rel="submenu4">Operations</a></li>
    <li><a rel="submenu5">Support</a></li>
    <li><a rel="submenu6">Document Management</a></li>
    <li><a rel="submenu7">Administration</a></li>
</ul>
<ul id="submenu1" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/19">Bill To/Ship To Search</a></li>
    <li><a href="/Display/Page/Index/33">Customer Account Information</a></li>
</ul>
<ul id="submenu2" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/29">Statement Search</a></li>
</ul>
<ul id="submenu3" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/30">Price Notification Summary</a></li>
</ul>
<ul id="submenu4" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/31">Online Environmental Compliance</a></li>
</ul>
<ul id="submenu5" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/32">Manage Profile</a></li>
    <li><a href="/Display/Page/Index/15">Administrative Interfaces</a></li>
</ul>
<ul id="submenu6" class="ddsubmenustyle">
    <li><a href="/Display/Page/Index/45">HES</a></li>
    <li><a href="/Display/Page/Index/52">Marketing Services</a></li>
    <li><a href="/Display/Page/Index/54">Sunoco University Classes</a></li>
    <li><a href="/Display/Page/Index/43">Credit Card Program Information</a></li>
</ul>
<ul id="submenu7" class="ddsubmenustyle">
    <li><a href="/Administration/UserAdmin/CreateUser">Create a New User</a></li>
    <li><a href="/Administration/UserAdmin">User Administration</a></li>
    <li><a href="/Administration/UserAdmin/CreateRole">Create a New Role</a></li>
    <li><a href="/Administration/MenuItem">Maintain Menu Items</a></li>
    <li><a href="/Administration/MenuItem/RefreshMenu">Refresh Menu</a></li>
</ul>

</div> 
```

和CSS：

```
/* Top navigation menu
   topNavMenu = the class used on the menu div.
   ddsubmenustyle = dropdown div css.
-----------------------------------------------------------*/

.topNavMenu ul
{
    margin: 0;
    padding: 0;
    font: bold 12px Verdana;
    list-style-type: none;
    background: #C3C9D9;  /* #153371 */
    overflow: hidden;
    width: 100%;
    background-image:url(../images/menu_bg.png);
    height:35px;
    float:left;

}

.topNavMenu li
{
    display: inline;
    margin: 0;
    z-index: 100;

}

.topNavMenu li a
{
    float: left;
    display: block;
    text-decoration: none;
    margin: 0;
    padding: 0px 10px; /*padding inside each tab*/
    border-right: 1px solid white; /*right divider between tabs*/
    color: black;
    background: #6c94b0;  /* #153371 */
    background-image:url(../images/menu_bg.png);
    height:35px;
    line-height:35px;
    font-family:Verdana, Arial, Helvetica, sans-serif;
    /*font-size:10px;*/
}

.topNavMenu li a:visited
{
    color: black;
}

.topNavMenu li a:hover
{
    background:#4D77A7; /*background of tabs for hover state */
    color:White;
    text-decoration:bold;

}

.topNavMenu a.selected
{
    background: #4D77A7; /*background of tab with "selected" class assigned to its LI */
    color:White;
}

.ddsubmenustyle, .ddsubmenustyle div
{ /*topmost and sub DIVs, respectively*/
    font: normal 12px Verdana;
    margin: 0;
    font-weight:bold;
    padding: 0;
    position: absolute;
    left: 0;
    top: 0;
    list-style-type: none;
    background: white;
    border-bottom-width: 0;
    visibility: hidden;
    z-index: 300;

}

.ddsubmenustyle ul
{
    margin: 0;
    padding: 0;
    position: absolute;
    left: 0;
    top: 0;
    list-style-type: none;
    border: 0px none;
    z-index: 300;
}

.ddsubmenustyle li a
{
    display: block;
    width: 170px; /*width of menu (not including side paddings)*/
    color: white;
    background-color: #aec6f6;
    text-decoration: none;
    padding: 4px 5px;
    border-bottom: 1px solid white;
    background-color:#4D77A7;
    line-height:24px;
    z-index: 300;
}

.ddsubmenustyle li ul li a, .ddsubmenustyle li ul li:first-child a
{
    display: block;
    width: 170px; /*width of menu (not including side paddings)*/
    color: white;
    background-color: #aec6f6;
    text-decoration: none;
    padding: 4px 5px;
    border-bottom: 1px solid white;
    background-color:#4D77A7;
    line-height:24px;
    background-image:none;
     -moz-border-bottom-radius: none;
    -webkit-border-bottom-radius: none;
    -khtml-border-bottom-radius: none;
   border-bottom-radius: none;
}

.ddsubmenustyle li:first-child a
{
    display: block;
    width: 170px; /*width of menu (not including side paddings)*/
    color: white;
    background-image:url(../images/arrow_first-child.png);
    background-repeat:no-repeat;
    background-position:top left;
    background-color: #4D77A7;
    text-decoration: none;
    padding: 16px 5px 4px 5px;
    border-bottom: 1px solid white;
    background-color:#4D77A7;
}

.ddsubmenustyle li ul li:last-child a
{

     -moz-border-bottom-right-radius: 0px;
    -webkit-border-bottom-right-radius: 0px;
    -khtml-border-bottom-right-radius: 0px;
   border-bottom-right-radius: 0px;
     -moz-border-bottom-left-radius: 0px;
    -webkit-border-bottom-left-radius: 0px;
    -khtml-border-bottom-left-radius: 0px;
   border-bottom-left-radius: 0px;
    border-bottom: none;
}

.ddsubmenustyle li ul li a:hover
{
    background-color:#4D77A7;
    color: 40638A;
    line-height:24px;

}

.ddsubmenustyle li:last-child a
{

     -moz-border-bottom-right-radius: 5px;
    -webkit-border-bottom-right-radius: 5px;
    -khtml-border-bottom-right-radius: 5px;
   border-bottom-right-radius: 5px;
     -moz-border-bottom-left-radius: 5px;
    -webkit-border-bottom-left-radius: 5px;
    -khtml-border-bottom-left-radius: 5px;
   border-bottom-left-radius: 5px;
}

* html .ddsubmenustyle li
{ /*IE6 CSS hack*/
    display: inline-block;
    width: 170px; /*width of menu (include side paddings of LI A*/
}

.ddsubmenustyle li a:hover
{
    background-color:#38587C;
    color: white;
    line-height:24px;

}

/* Neutral CSS */

.downarrowpointer
{ /*CSS for "down" arrow image added to top menu items*/
    padding-left: 4px;
    border: 0;
}

.rightarrowpointer
{ /*CSS for "right" arrow image added to drop down menu items*/
    position: absolute;
    padding-top: 3px;
    left: 100px;
    border: 0;
}

.ddiframeshim
{
    position: absolute;
    z-index: 500;
    background: transparent;
    border-width: 0;
    width: 0;
    height: 0;
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:50:15.077

我试图在 Chrome 中查看它，但无法正常工作。为什么子菜单是分开的 ul 的？也许您可以尝试嵌套列表，如下所示：

```
<nav>
  <ul class="top-nav">
    <li>
      <a href="#">Item 1</a>
      <ul class="sub-nav">
        <li><a href="#">Item 1a</a></li>
        <li><a href="#">Item 1b</a></li>
        <li><a href="#">Item 1c</a></li>
      </ul>
    </li>
    <li>
      <a href="#">Item 2</a>
      <ul class="sub-nav">
        <li><a href="#">Item 2a</a></li>
        <li><a href="#">Item 2b</a></li>
        <li><a href="#">Item 2c</a></li>
      </ul>
    </li>
  </ul>
</nav> 
```

这里有一些 CSS 让它工作：

```
* { 
margin: 0; 
padding: 0; 
list-style: none; 
color: inherit; 
text-decoration: none; 
}
body { 
font-family: sans-serif; 
}
nav { 
margin: 0 auto; 
}
.sub-nav { 
display: none; 
}
.sub-nav li { 
background: #333; 
color: #fff; 
padding: 4px 2px; 
border-bottom: 1px solid #e0e0e0; 
}
.top-nav { 
overflow: hidden; 
}
.top-nav > li { 
float: left; 
width: 100px; 
padding: 4px 0; 
background: #e0e0e0; 
}
.top-nav > li:hover ul { 
display: block; 
} 
```

刚刚在 Chrome 和 IE 中测试过，运行良好。

# php - 从 100 倒计时到 0，PHP 中没有分配

> ID：14467186
> 
> 赞同：3
> 
> 时间：2013-01-22T20:12:48.723
> 
> 标签：php, variables, variable-assignment, countdown

我很难弄清楚我的老板给我的作为个人知识丰富的练习。不幸的是，我一直在网络上到处寻找答案，但没有成功，现在我求助于各位程序员。

他让我做的是从 100 到 0 的简单倒计时（可以一次显示全部）。到目前为止足够容易吧？只需制作一个简单的 for 循环或一段时间即可。这里的问题是他要求代码中没有分配，例如：`$[var]=[value]`。

一个人怎么能在没有分配的情况下制作一个循环呢？既然`$i--;`是等价的，`$i = $i - 1;`我们怎么能倒数呢？

我对这个我无法解决的问题感到困惑，我真的很想找到答案，因为我很好奇如何做到这一点。

非常感谢您的帮助。

# 编辑

请注意，这个问题是一种 2 部分，其中第一部分是使其工作 100 到 0，而在第二部分 x 到 0 中，x 由用户输入

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:24:24.690

我会给你一些提示，编写确切的代码对你来说是一个练习。

1.  没有赋值，所以你必须有一些可以容纳多个值的类型。像整数这样的原始类型不能在这里直接使用，想想数组。

2.  现在，您不能使用变量，因此不允许使用循环然后打印值。使用多种方法中的一种打印数组（或对数组进行操作的结果）。

3.  该[`range()`](http://php.net/range)函数不接受负步长值，您需要反转数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:40:24.420

我的猜测是你的老板正试图鼓励你使用[递归](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29)而不是迭代。递归作为一种技术，对于某些问题非常有效，并且是作为程序员在你的军械库中拥有的极好工具。

在不放弃所有内容的情况下，尝试定义一个接受参数的函数——“倒计时”数字——然后以某种方式调用*自身*。一旦定义了它，您还需要通过调用它来单独启动它。

请记住，递归必须定义某种终止，否则事情可能会出错。这是一个让您入门的非常错误的示例：：D

```
<?php
  function infinity() {
    print "Whoah.";
    infinity();
  }
  infinity(); 
```

# java - 无法调用原始类型 int

> ID：14467187
> 
> 赞同：-5
> 
> 时间：2013-01-22T20:12:56.103
> 
> 标签：java, arrays

它提出“无法在原始类型 int 上调用 getNumber()。为什么？

公共卡 findLargest() {

```
 ArrayList<Card> cardStack;}
    public Card getLargest() {
      Card largest;
      Card c;
      for (int i = 1, largest = cardStack.get(0); i < cardStack.size(); i++) {
        c = cardStack.get(i);
        if (largest.getNumber() > c.getNumber()) {
          largest = c;
          continue;
        } else if (largest.getNumber() == c.getNumber()) {
          if(largest.getSuit().equals("Diamonds"))
              largest = c;
            continue; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:53:20.167

```
largest = c; 
```

由于您现在需要让您的`largest`变量引用具有新最大​​值的卡片，您只需要将变量指向它。

下一次`largest.getNumber()`将返回`c.getNumber()`现在返回的内容。

但是，请确保 for 的声明`Card largest;`在您的循环之外。

编辑：

我将为您添加一些解释，并希望回答您的问题。

当您这样声明对象时：

```
Card c; 
```

您正在创建一个可以引用 Card 类型的任何对象（或子类）的引用变量。通过创建该对象的实例...

```
Card c = new Card(); 
```

您正在保留内存并初始化其子对象/原语。

因此，当您编写这样的函数时：

```
List<Card> cardStack; //Just assuming you have a List of cards
public Card getLargest() {
  Card largest;
  Card c;
  for (int i = 1, largest = cardStack.get(0); i < cardStack.size(); i++) {
    c = cardStack.get(i);
    if (largest.getNumber() > c.getNumber()) {
      largest = c;
    } else if (largest.getNumber() == c.getNumber()) {
      if(...)//Check suits as you would
    }
  }
  return largest;
} 
```

您正在创建引用堆栈中存在的 Card 对象的变量。引用没有发生新的内存分配（除了它们需要保存引用的内存）。

结果，您将拥有一个在别处创建的卡片对象列表，以及两个引用，`c`它们`largest`只是指向存储在不同位置的对象。从函数返回`Card`会返回该引用，因此您对其执行的任何操作都会影响它所引用的卡片。

或者，您将`clone`对象发送回一个相同但不同的对象，您对其进行的任何修改都不会影响原始卡。在许多对象中，只创建新对象而不修改旧对象的能力称为不可变。例如，字符串对象是不可变对象。

当我谈到需要`Card largest;`在循环之外编写时，这意味着分配给保存引用的内存只存在于循环的范围内。如果我们这样做：

```
for (....) {
  Card largest;
  //...
} 
```

...每次循环迭代时，`largest`变量被销毁并重新创建，删除和引用或我们保存在其中的数据。对于我上面的更大示例，我们可以放入`Card c;`循环，因为我们只关心`c`循环持续时间的内容，而最大的问题稍后再考虑。这称为变量范围。

# c# - 将内容拆分为页面 MVC 4 Razor

> ID：14467188
> 
> 赞同：2
> 
> 时间：2013-01-22T20:12:58.320
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, razor

我正在尝试将内容拆分为页面，并且正在寻找最聪明的方法。所以我的控制器发送一个模型，例如 45 条记录我想在 3 个页面中显示它们，每个页面有 15 行，底部有导航按钮。（[1] ， [2] ... 像链接）应该我愿意？拆分控制器中的内容并制作 3 个具有不同名称的分隔视图，例如`/Home/Action/page1`.... `/Home/Action/page2`？或者有更聪明的方法来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T07:58:16.860

我在这里找到了我想要的东西：[在 ASP.NET MVC 应用程序中使用实体框架进行排序、过滤和分页 (3 of 10)](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application)。

# header - Jmeter响应头值处理

> ID：14467192
> 
> 赞同：1
> 
> 时间：2013-01-22T20:13:28.250
> 
> 标签：header, response, jmeter

我通过 Jmeter 进行了 REST Web 服务调用。发出请求后，我收到了带有响应标头的响应。

要查看响应标头值，我正在使用 View Results Tree 侦听器。
我可以在查看结果树的 SamplerResult 选项卡下看到所需的参数。
该参数是一个整数值。

我的问题是：如何从“查看结果树”部分中为我提交的所有请求（5000 个请求）获取该参数的平均值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T22:25:40.107

做你想做的事：

*   声明一个用户定义的变量 (nbIterations)
*   使用[正则表达式提取器](http://jmeter.apache.org/usermanual/component_reference.html#Regular_Expression_Extractor)（检查标题，称之为时间）
*   使用[JSR223 采样器](http://jmeter.apache.org/usermanual/component_reference.html#JSR223_Sampler)（将 Groovy 添加到 jmeter/lib/ext/），它将执行以下操作：

    ```
    Long time = (Long) vars.get("time");
    Long sum = (Long) vars.get("sum");
    if(sum == null) {
        sum = new Long(0);
    }
    sum = new Long(sum.longValue()+time.longValue);
    vars.put("sum", sum); 
    ```

*   最后你通过 {__BeanShell(${sum}/${nbIterations})}

# linux - 为什么 repoquery 输出错误的文件列表？

> ID：14467196
> 
> 赞同：0
> 
> 时间：2013-01-22T20:13:34.710
> 
> 标签：linux, rpm, yum

在我的 YUM 服务器上，我有这个 RPM ...

```
redcricket@rpo-dev:/usr/RED/docs/yum/CEL6/RIE$ rpm -q --filesbypkg -p development/RPMS/ooo-audit-1.0-10.noarch.rpm 
ooo-audit                 /apps/RED/red_apps/server/ooo-audit.pl 
```

...并且我已将其安装在我的系统上，并且 rpm 说明了该 RPM ...

```
[redcricket@dev-006 src]$ rpm -q --filesbypkg ooo-audit
ooo-audit                 /apps/RED/red_apps/server/ooo-audit.pl 
```

...但是 repoquery 列出旧版本 RPM 上的文件 ...

```
[redcricket@dev-006 src]$ repoquery -l ooo-audit
/apps/RED/data/ooo-audit/exceptions.txt
/apps/RED/red_apps/server/ooo-audit.pl 
```

...即使在我做了“sudo yum clean all”之后...

```
[redcricket@dev-006 src]$ sudo yum clean all
Loaded plugins: fastestmirror, merge-conf
Cleaning repos: ...
Cleaning up Everything 
```

... 看 ...

```
[redcricket@dev-006 src]$ repoquery -l ooo-audit
/apps/RED/data/ooo-audit/exceptions.txt
/apps/RED/red_apps/server/ooo-audit.pl 
```

这是我安装的 yum-utils ....

```
[redcricket@dev-006 src]$ rpm -q yum-utils
yum-utils-1.1.30-10.el6.noarch 
```

... 这里发生了什么？yum conf 是正确的。RPM ooo-audit 仅在我的 YUM 服务器 rpo-dev 上可用。我还更新了 YUM 服务器上的 repodata。我应该报告错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T00:26:22.870

听起来YUM存储库数据本身是不正确的，它是YUM服务器上独立于RPM数据库的数据库。根据您的用户名和示例路径，我假设它是您自己的 yum 服务器和自定义 repo；您需要重新运行`makerepo`或用于将 RPM 导入 YUM 存储库的任何命令。

（我什至会猜测，`ooo-audit`在创建 repo 时，旧版本的包中包含其他文件。）

# ruby - 使用机械化获取文本节点？

> ID：14467198
> 
> 赞同：1
> 
> 时间：2013-01-22T20:13:49.430
> 
> 标签：ruby, xpath, web, nokogiri, mechanize

使用[Mechanize](http://mechanize.rubyforge.org/)我想获取 HTML 元素之后的文本节点：

```
<b>test</b>THIS IS THE TEXT I WANT. 
```

`<b>`使用节点后如何获取该文本`page.at('b')`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:41:55.247

那将是：

```
page.at('b').next 
```

# iis - iis 8 元数据库是否向后兼容 7.5

> ID：14467199
> 
> 赞同：1
> 
> 时间：2013-01-22T20:14:00.447
> 
> 标签：iis, iis-7.5, iis-8, windows-server-2012

我将 IIS 8 元数据库 (Windows Server 2012) 复制到 IIS 7.5 (Windows 2008 R2) 框中。它工作正常。Microsoft 是否有官方声明确认 IIS 8 元数据库向后兼容 IIS 7.5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:08:12.397

我们已经运行了一段时间，没有任何问题。我们使用的唯一不向后兼容的设置是`sslFlags`(on `configuration/system.applicationHost/sites/site/bindings/binding[protocol="https`)。所以在复制元数据库之后，我们只是删除了那个属性，一切都很好。

# c - C string declaration

> ID：14467200
> 
> 赞同：4
> 
> 时间：2013-01-22T20:14:02.113
> 
> 标签：c, string

I am confused about some basics in C string declaration. I tried out the following code and I noticed some difference:

```
char* foo(){
    char* str1="string";
    char str2[7]="string";
    char* str3=(char)malloc(sizeof(char)*7);
    return str1;
    /* OR: return str2; */
    /* OR: return str3; */
    }
void main()  {
    printf("%s",foo());
    return 0;
    } 
```

I made foo() return str1/2/3 one at a time, and tried to print the result in the main. str2 returned something weird, but str1 and str3 returned the actual "string".

1.Now, what's the difference between the three declarations? I think the reason why str2 didn't work is because it is declared as a local variable, is that correct?

2.Then what about str1? If the result remains after the foo() ended, wouldn't that cause memory leak?

3.I'm simply trying to write a function that returns a string in C, and use the value returned by that function for other stuff, which str declaration above should I use?

Thanks in advance!

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-22T20:34:08.013

```
char* str1="string"; 
```

这会产生`str1`一个指针；它指向字符串文字的第一个字符。您应该将其定义为`const`，因为您不允许修改字符串文字：

```
const char *str1 = "string"; 
```

...

```
char str2[7]="string"; 
```

这将创建`str2`一个数组`char`（不是指针），并将字符串文字的内容复制到其中。无需将其定义为`const`; 数组本身是可写的。您也可以省略大小并让它由初始化程序确定：

```
char str2[] = "string"; 
```

然后`sizeof str2 == 7`（6 字节`"string"`加 1 用于终止`'\0'`）。

这个：

```
char* str3=(char)malloc(sizeof(char)*7); 
```

写错了，甚至不应该编译；至少，你应该从你的编译器那里得到一个警告。您正在将结果转换`malloc()`为 type `char`。您应该将其转换为`char*`：

```
char *str3 = (char*)malloc(sizeof(char) * 7); 
```

但是强制转换是不必要的，并且在某些情况下可以掩盖错误；[请参阅comp.lang.c FAQ](http://www-c.faq.com/)中的问题 7.7 和以下内容：

```
char *str3 = malloc(sizeof(char) * 7); 
```

但是`sizeof(char)`根据定义是 1，所以你可以写：

```
char *str3 = malloc(7); 
```

`malloc()`分配内存，但不会初始化它，所以如果你尝试打印`str3`指向的字符串，你会得到垃圾——如果分配的空间碰巧不包含终止 null，甚至会导致运行时崩溃字符`'\0'`。您可以使用 初始化它`strcpy()`，例如：

```
char *str3 = malloc(7);
if (str3 == NULL) {
    fprintf(stderr, "malloc failed\n");
    exit(EXIT_FAILURE);
}
strcpy(str3, "string"); 
```

您必须非常小心，您要复制的数据不大于分配的空间。（不，[`strncpy() 不是这个问题的答案](http://the-flat-trantor-society.blogspot.com/2012/03/no-strncpy-is-not-safer-strcpy.html)。）

`void main()`是不正确的; 它应该是`int main(void)`。如果您的教科书告诉您要使用，请`void main()`找到更好的教科书；它的作者不太了解 C。

`#include`并且您需要为您正在使用的任何库函数提供适当的指令： `<stdio.h>`for `printf()`、`<stdlib.h>`for`exit()`和`malloc()`和`<string.h>`for `strcpy()`。每个函数的文档都应该告诉您要包​​含哪个标头。

我知道这需要吸收很多；不要指望马上就明白。

我提到了[comp.lang.c 常见问题解答](http://www.c-faq.com/)；这是一个极好的资源，特别是第 6 节，它讨论了数组和指针以及它们之间经常令人困惑的关系。

至于你的问题 3，如何从 C 函数返回一个字符串，由于 C 进行内存分配的方式（基本上它留给自己管理），结果出奇地复杂。您不能安全地返回指向局部变量的指针，因为当函数返回时该变量不再存在，给调用者留下一个悬空指针，所以返回你的`str2`是危险的。返回字符串文字是可以的，因为它对应于在整个程序执行过程中存在的匿名数组。您可以声明一个数组`static`并返回一个指向它的指针，或者您可以使用`malloc()`（这是最灵活的方法，但这意味着调用者需要`free()`内存），或者您可以要求调用者传递一个指向缓冲区的指针，您的函数会将结果复制到该缓冲区中。

某些语言允许您构建一个字符串值并简单地从函数中返回它。正如您现在发现的那样，C 不是这些语言之一。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-22T20:17:03.620

```
char* str1="string"; 
```

这将创建一个指向文本字符串的指针，该字符串将位于一个`.data`或`.text`多个段上，并且始终可以访问。每当你做这样的事情时，一定要声明它`const`，因为如果你试图修改它，可能会发生令人讨厌的事情。

```
char str2[7]="string"; 
```

这会在堆栈上创建一个带有文字字符串副本的本地缓冲区。一旦函数返回，它就变得不可用。这解释了你得到的奇怪结果。

```
char* str3=(char)malloc(sizeof(char)*7); 
```

这会在堆上创建一个缓冲区（未初始化），直到您释放它为止。你必须释放它，否则你会得到内存泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T20:27:43.400

*字符串文字* `"string"`存储为具有静态范围的 7 元素数组，`char`这意味着它的内存在程序启动时分配并保持到程序终止。

宣言

```
char *str1 = "string"; 
```

将字符串文字的*地址*`str1`分配给. 即使`str1`当函数退出时变量不再存在，它的*值*（字面量的地址`"string"`）在函数之外仍然有效。

宣言

```
char str2[7] = "string"; 
```

声明`str2`为 的数组，并将字符串文字的*内容*`char`复制到其中。当函数退出时，不再存在，其内容不再有意义。 *`str2`*

 *宣言

```
char *str3 = (char*) malloc(sizeof(char) * 7); 
```

可以简化为

```
char *str3 = malloc(sizeof *str3 * 7); 
```

分配一个未初始化的 7 字节内存块并将其地址复制到`str3`. 当函数退出时，变量`str3`不再存在，但它指向的内存仍然被分配。正如所写，这*是*内存泄漏，因为您没有在调用代码中保留指针的值。请注意，由于您没有将任何内容复制到此块中，因此输出`main`将是随机的。

此外，除非您的编译器文档*明确*列出该函数`void main()`的合法签名，否则请改用。 `main``int main(void)`*

# recursion - Recursive Function Composition in Scheme

> ID：14467201
> 
> 赞同：3
> 
> 时间：2013-01-22T20:14:04.147
> 
> 标签：recursion, functional-programming, scheme, racket

Below is an attempt I've made to create a procedure that returns the function composition given a list of functions in scheme. I've reached an impasse; What I've written tried makes sense on paper but I don't see where I am going wrong, can anyone give some tips?

```
; (compose-all-rec fs) -> procedure 
; fs: listof procedure
; return the function composition of all functions in fs:
; if fs = (f0 f1 ... fN), the result is f0(f1(...(fN(x))...))
; implement this procedure recursively

(define compose-all-rec (lambda (fs)
     (if (empty? fs) empty
     (lambda (fs)
         (apply (first fs) (compose-all-rec (rest fs)))
     ))))

where ((compose-all-rec (list abs inc)) -2) should equal 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:47:13.720

我会尝试不同的方法：

```
(define (compose-all-rec fs)
  (define (apply-all fs x)
    (if (empty? fs)
        x
        ((first fs) (apply-all (rest fs) x))))
  (λ (x) (apply-all fs x))) 
```

请注意，`lambda`最后需要返回一个，并且它在那个 lambda（它捕获`x`参数和`fs`列表）中发生了所有函数的实际应用 - 使用`apply-all`帮助程序。另请注意，`(apply f x)`可以更简洁地表示为`(f x)`。

如果允许高阶过程，则可以用[`foldr`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket/private/list..rkt%29._foldr%29%29)一些语法糖来表示更短的解决方案，以返回一个[柯里](https://en.wikipedia.org/wiki/Currying)化函数：

```
(define ((compose-all-rec fs) x)
  (foldr (λ (f a) (f a)) x fs)) 
```

无论哪种方式，建议的解决方案都能按预期工作：

```
((compose-all-rec (list abs inc)) -2)
=> 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T14:29:36.167

发布复选标记，但到底是什么：

```
(define (compose-all fns)
  (assert (not (null? fns)))
  (let ((fn (car fns)))
    (if (null? (cdr fns))
        fn
        (let ((fnr (compose-all (cdr fns))))
          (lambda (x) (fn (fnr x))))))) 
```

# ios - Cocos2d for iOS: show EULA in PDF or PNG

> ID：14467204
> 
> 赞同：0
> 
> 时间：2013-01-22T20:14:20.523
> 
> 标签：ios, pdf, cocos2d-iphone, eula

I would like to [show an EULA in my Cocos2d app.](https://stackoverflow.com/questions/5894228/showing-eula-when-app-starts-and-quiting-if-user-doesnt-accept-it) Is there any recommended way in Cocos2d and if so could you guide me to some tutorial? It is a one page document which fits perfectly in a PDF - is there any way to show a PDF on a Cocos2d App?

I tried adding a PNG file but I was not able to allow to "zoom in" with the pinch movements. Also PNG files are less resolution when compared to PDF.

Consideration: In both cases (PDF & PNG) the user will need to "pinch zoom" the image in order to be able to read the text properly. I am a bit afraid that this might put off the user as haven't found one iOS APP yet that does use this mechanism.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:47:44.293

将 EULA 放在您的用户面前会让他们望而却步。问问自己为什么没有其他 iOS 应用程序这样做。

充其量，应用程序会添加一个指向其“服务条款”的超链接，点击该链接时会在 Safari 中打开，并且可能会注明如果您登录即表示您同意。如果您想了解如何设计的示例，请查看 Game Center 帐户创建过程。

PDF 或 PNG 是糟糕的想法，显示 HTML webview 或简单的文本视图。

# c# - How do i add a Clear Text Field button to my android app in C#?

> ID：14467207
> 
> 赞同：0
> 
> 时间：2013-01-22T20:14:27.470
> 
> 标签：c#, android, xml, xamarin.android

i'm very much a beginner with programming.. but i'm trying to develop a small android app using monodroid to store contacts in and call contacts from the address book.

Please forgive me if this is very simple but i have a text field and a button, both of which are in my Resources XML file and i want to be able to CLEAR the text in the textbox by clicking the button which will obviously be called 'Clear'.. all help is much appreciated as i'm looking forward to learning more.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T22:12:40.807

假设您有以下布局，我假设它与您已经拥有的类似：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView
        android:id="@+id/TextField"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" />
    <Button
        android:id="@+id/Clear"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Clear"/>
</LinearLayout> 
```

然后在您的活动代码中，您可以执行以下操作：

```
var clear = FindViewById<Button>(Resource.Id.Clear);
var textField = FindViewById<TextView>(Resource.Id.TextField);

clear.Click += (src, args) =>
               {
                   textField.Text = "";
               }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:22:48.957

这个怎么样？

```
 Button ClearText=(Button) findViewById(R.id.ClearText);
  ClearText.setOnClickListener(new View.OnClickListener(){
  public void onClick(View v){
    EditText textedit=(EditText) findViewById(R.id.textedit);
    textedit.setText("");
  }
 }); 
```

clear 必须像这样在布局文件中注册为按钮的 onclick 处理程序

```
 <ImageButton android:id="@+id/ClearText"
    android:text="@string/ClearText"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    **android:onClick="clear"**          
    android:src="@drawable/clear"
    /> 
```

# sql-server - Cannot find the error

> ID：14467209
> 
> 赞同：-5
> 
> 时间：2013-01-22T20:14:32.210
> 
> 标签：sql-server

The code I have is

```
 SELECT     dbo.COL_TBL_WAGES.[Job Group], SUM(CASE WHEN RRDD NOT LIKE '12%' AND RRDD NOT LIKE '13%' AND RRDD NOT LIKE '16%' AND RRDD NOT LIKE '17%' AND 
                      RRDD NOT LIKE '2706%' AND RRDD NOT LIKE '2707%' AND RRDD NOT LIKE '2331' THEN DUR_IN_HOURS ELSE 0 END) AS SP_DOM_HOURS, SUM(CASE WHEN RRDD NOT LIKE '12%' AND RRDD NOT LIKE '13%' AND RRDD NOT LIKE '16%' AND RRDD NOT LIKE '17%' AND RRDD NOT LIKE '2706%' AND RRDD NOT LIKE '2707%' AND RRDD NOT LIKE '2331%' THEN CAST([2011 Total] AS FLOAT)*CASE WHEN IsNumeric([DUR_IN_HOURS]) =1 THEN CAST([DUR_IN_HOURS] AS FLOAT) ELSE 0 END)) AS SP_DOM_COST
FROM         dbo.COL_v_STD_REP_FullCourseDetail INNER JOIN
                      dbo.COL_TBL_WAGES ON dbo.COL_v_STD_REP_FullCourseDetail.Job_Group_Code = dbo.COL_TBL_WAGES.[Job Group Code] INNER JOIN
                      dbo.COL_TBL_WAGES_INTL ON dbo.COL_TBL_WAGES.[Job Group Code] = dbo.COL_TBL_WAGES_INTL.[Job Group Code] 
```

The errors that arise Incorrect Syntax Near ')'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:19:26.687

你错过了`END`第一个`CASE`：

```
 SUM(CASE 
        WHEN RRDD NOT LIKE '12%' 
            AND RRDD NOT LIKE '13%' 
            AND RRDD NOT LIKE '16%' 
            AND RRDD NOT LIKE '17%' 
            AND RRDD NOT LIKE '2706%' 
            AND RRDD NOT LIKE '2707%' 
            AND RRDD NOT LIKE '2331%' 
        THEN CAST([2011 Total] AS FLOAT) 
      END -- this is missing
    *
    CASE 
        WHEN IsNumeric([DUR_IN_HOURS]) =1 
        THEN CAST([DUR_IN_HOURS] AS FLOAT) 
        ELSE 0 END) AS SP_DOM_COST 
```

您的完整查询将是：

```
SELECT dbo.COL_TBL_WAGES.[Job Group], 
    SUM(CASE 
            WHEN RRDD NOT LIKE '12%' 
                AND RRDD NOT LIKE '13%' 
                AND RRDD NOT LIKE '16%' 
                AND RRDD NOT LIKE '17%' 
                AND RRDD NOT LIKE '2706%' 
                AND RRDD NOT LIKE '2707%' 
                AND RRDD NOT LIKE '2331' 
            THEN DUR_IN_HOURS 
            ELSE 0 END) AS SP_DOM_HOURS, 
    SUM(CASE 
            WHEN RRDD NOT LIKE '12%' 
                AND RRDD NOT LIKE '13%' 
                AND RRDD NOT LIKE '16%' 
                AND RRDD NOT LIKE '17%' 
                AND RRDD NOT LIKE '2706%' 
                AND RRDD NOT LIKE '2707%' 
                AND RRDD NOT LIKE '2331%' 
            THEN CAST([2011 Total] AS FLOAT) END
        *
        CASE 
            WHEN IsNumeric([DUR_IN_HOURS]) =1 
            THEN CAST([DUR_IN_HOURS] AS FLOAT) 
            ELSE 0 END) AS SP_DOM_COST
FROM  dbo.COL_v_STD_REP_FullCourseDetail 
INNER JOIN dbo.COL_TBL_WAGES 
    ON dbo.COL_v_STD_REP_FullCourseDetail.Job_Group_Code = dbo.COL_TBL_WAGES.[Job Group Code] 
INNER JOIN dbo.COL_TBL_WAGES_INTL 
    ON dbo.COL_TBL_WAGES.[Job Group Code] = dbo.COL_TBL_WAGES_INTL.[Job Group Code] 
```

# jquery - Exporting not working using jqueryTabs and TableTool

> ID：14467211
> 
> 赞同：2
> 
> 时间：2013-01-22T20:14:40.397
> 
> 标签：jquery, jquery-ui, datatable, tabletools

I have a problem with my Exporting buttons: it works just for the first jQuery Table, but in other tables it doesn't work.

I have included all what needs to be included.

Here is an example for 2 jqueryTabs:

```
var jQuery2 = jQuery.noConflict();
jQuery2(document).ready(function() {

    jQuery2('#t1').dataTable( {
        "bJQueryUI": true,
        "bScrollCollapse": true,
        "sDom": 'T<"clear">lfrtip',

        "oTableTools": {
            "aButtons": [
                "copy",
                "csv",
                "xls",
                {
                    "sExtends": "pdf",
                    "sPdfOrientation":"landscape",
                    "sPdfMessage": "Your custom message would go here."
                },
                "print"
            ]
        }
    });
    jQuery2('#t2').dataTable( {
        "bJQueryUI": true,
        "bScrollCollapse": true,
        "sDom": 'T<"clear">lfrtip',
        "oTableTools": {
            "aButtons": [
                "copy",
                "csv",
                "xls",
                {
                    "sExtends": "pdf","sPdfOrientation": "landscape",
                    "sPdfMessage": "Your custom message would go here."
                },
                "print"
            ]
        }
    } );

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:27:47.040

我建议单独调用数据表，而不对两个表都使用 jQuery2 变量。

```
 $(document).ready(function() {
      $('#t1').dataTable( { ... });
      $('#t2').dataTable( { ... });
 }); 
```

# php - regex syntax to get data into separated variables

> ID：14467215
> 
> 赞同：-4
> 
> 时间：2013-01-22T20:14:53.477
> 
> 标签：php, mysql, regex

I have this code inserted into the database: `{"2":{"qty":1,"price":"10.00","room_id":{"1002":"1"}},"1":{"qty":2,"price":"35.00","room_id":["2"]},"3":{"qty":1,"price":"18.00","room_id":["1"]}}`

I want to get the values FROM `{"2":{"qty":1,"price":"10.00","room_id":{"1002":"1"}} TO "3":{"qty":1,"price":"18.00","room_id":["1"]}}` and store each digit in a separate variable.

What would be the regular expression to match this?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-22T20:16:07.460

> 请问我应该使用什么语法作为正则表达式？

答案是“没有”。您不应该尝试使用正则表达式解析 JSON。请改用该[`json_decode()`](http://php.net/manual/en/function.json-decode.php)功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:20:05.557

如果您需要将数据存储在数据库中，`json`为什么不使用内部存储的数据呢？`noSQL``json`

我会去`MongoDB`。或者可能是这些中的任何一个：[使用 JSON 作为存储/传输格式的数据库](https://stackoverflow.com/questions/853265/databases-using-json-as-storage-transport-format)

# hosting - Is it possible to expand host capacity or bandwidth automatically?

> ID：14467218
> 
> 赞同：0
> 
> 时间：2013-01-22T20:15:07.247
> 
> 标签：hosting, cpanel

I have a reseller account hosting, using WHM cPanel. I want to sell "expandable hosting service", that mean it flexible.

First, every plan is started with 500MB for example. But when they use nearly 400MB, can we make it automatic grow/expand hosting to 600MB or higher? If they not reach the limit, the host still remain 500MB.

Second, is it possible to do that? Even if I have to hire some developer, can I do it?

Thank you so much.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T08:47:14.173

如果您使用 WHM / Cpanel 和 cron 任务的 API 创建系统，可以。

*   克朗
*   任务的目的。使用API​​获取每个账户的磁盘消耗。如果帐户 AAAA> XXX 使用 API 增加该值。

[http://docs.cpanel.net/twiki/bin/vief/SoftwareDevelopmentKit/WebHome#cPanel WHM 的 API](http://docs.cpanel.net/twiki/bin/vief/SoftwareDevelopmentKit/WebHome#cPanel%20%20WHM%27s%20API)

# android - Android菜单操作栏：为什么其中一个元素不听点击？

> ID：14467220
> 
> 赞同：0
> 
> 时间：2013-01-22T20:15:18.733
> 
> 标签：android, menu, menuitem

我有一个 FragmentActivity 类，它有一个从超类继承的 2 选项菜单，用于代码重用。

在这个 FragmentActivity 中，我添加了第三个菜单项并将 onOptionsItemSelected 设置为对共享菜单项执行我想要的操作（第三个有自己的 onMenuItemClick 侦听器）。但是，当我运行该应用程序时，第二个和第三个选项（一个导致菜单和新的选项）会注册点击并执行他们被告知的操作，但第二个选项（一个设置为调用共享意图）没有。点击它什么也没做。

这是我的菜单 xml

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
<item
    android:id="@+id/ab_comparte"
    android:icon="@android:drawable/ic_menu_share"
    android:showAsAction="always|withText"
    android:title="@string/menu_share" 
    android:menuCategory="container" 
    android:orderInCategory="1"
    android:actionProviderClass="com.actionbarsherlock.widget.ShareActionProvider"
    />
<item
    android:id="@+id/ab_menu"
    android:icon="@drawable/ic_action_bar_menu"
    android:showAsAction="always|withText"
    android:title="@string/menu_menu" 
    android:menuCategory="container" 
    android:orderInCategory="2"/>

</menu> 
```

这是片段活动（仅与菜单相关的位）

```
public boolean onCreateOptionsMenu(Menu menu) {
    /*
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.menu_detalle_tapa, (Menu) menu);
    */
    menu.add("Me Gusta")
        .setOnMenuItemClickListener(this)
        .setIcon(R.drawable.like_blanco)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    return super.onCreateOptionsMenu(menu);
}
.....
@Override
public boolean onMenuItemClick(MenuItem item) {
    Crouton.makeText(this, "ME GUSTA", Style.ALERT).show();
    return false;
}
...................
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    int itemId = item.getItemId();

    Log.d(CData.LOGTAG, "pulsado en menú item " + itemId);
    if (itemId == R.id.ab_comparte){
        // cerrar sesión
        Log.d(CData.LOGTAG, "pulsado en menú item Comparte" + itemId);
        Crouton.makeText(this, "ahora se abriría el menú de compartir ", Style.INFO).show();
        Intent i=new Intent(android.content.Intent.ACTION_SEND);

        i.setType("text/plain");
        /*i.putExtra(Intent.EXTRA_SUBJECT,
                    Tappabook.getAppContext().getResources().getString(R.string.asunto_compartir_tapa)
                );*/
        String en = Tappabook.getAppContext().getResources().getString(R.string.en);
        String comparteTapa = 
                tapaDetallada.getNombre() + " " 
                        + " " + en + " " 
                        + tapaDetallada.getBarNombre() + " "
                        + CData.urlCompartirTapa + tapaDetallada.getId()
                        ;

        i.putExtra(Intent.EXTRA_TEXT,comparteTapa);

        startActivity(
                Intent.createChooser(
                        i, 
                        Tappabook.getAppContext().
                        getResources().getString(R.string.titulo_compartir_tapa)
                        )
                );
        return true;
    }else{
        Log.d(CData.LOGTAG, "pulsado en menú item " + itemId);
        return super.onOptionsItemSelected(item);
    }
} 
```

这是与超类菜单相关的位

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.menu_activity_login, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    int itemId = item.getItemId();
    if (itemId == R.id.ab_menu){
        // cerrar sesión
        Log.d(CData.LOGTAG, "pulsado en menú item Menú" + itemId);

        Intent intent = new Intent(this, MenuFA.class);
        //intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);
        return true;
    }else{
            Log.d(CData.LOGTAG, "pulsado en menú item " + itemId);
            return super.onOptionsItemSelected(item);
    }
} 
```

那么我做错了什么？选项 ab_menu 可以正常工作。选项“Me gusta”（带有自己的监听器）也有效。但是选项 ab_comparte，虽然它出现在操作栏上，但它甚至不“听”点击。

任何帮助将不胜感激。

更新：我已经在共享项目的 xml 上更改了这个

```
android:showAsAction="collapseActionView|always" 
```

现在，当我单击共享菜单项时，操作栏会发生变化，并显示另一个带有（不同）共享图标的项目。如果我单击第二个共享项目，它确实有效，它会调用共享意图。但是，我不想这样做。只需单击第一个项目应该调用共享意图，而不是更改操作栏以显示第二个共享项目....我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T11:10:34.883

好的，所以我已经让它工作了。看来我在活动中缺少一些代码，即：

在这里我给菜单充气

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {

    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.menu_detalle_tapa, (Menu) menu);
    MenuItem item = menu.findItem(R.id.ab_comparte);
    mShareActionProvider = (ShareActionProvider) item.getActionProvider();

    this.menu = menu;
    return true;
} 
```

当我已经获得远程数据时会发生这种情况（因此您不能尝试共享空/空对象

```
 /** Getting the target intent */
        Intent intent = getDefaultShareIntent();
        Log.d(CData.LOGTAG, "check if intent is null ");
        /** Setting a share intent */
        if(intent!=null)
            mShareActionProvider.setShareIntent(intent);
        else
            Log.d(CData.LOGTAG, "intent was null "); 
```

这里是我决定分享什么的地方

```
private Intent getDefaultShareIntent(){

    Intent intent = new Intent(Intent.ACTION_SEND);
    intent.setType("text/plain");
    //intent.putExtra(Intent.EXTRA_SUBJECT, "SUBJECT");
    String en = Tappabook.getAppContext().getResources().getString(R.string.en);
    String comparteTapa = 
            tapaDetallada.getNombre() + " " 
                    + " " + en + " " 
                    + tapaDetallada.getBarNombre() + " "
                    + CData.urlCompartirTapa + tapaDetallada.getId()
                    ;
    intent.putExtra(Intent.EXTRA_TEXT,comparteTapa);
    return intent;
} 
```

原来我是个白痴：P

# r - Generate directed lattice with equal number of neighbours for each node

> ID：14467222
> 
> 赞同：1
> 
> 时间：2013-01-22T20:15:20.710
> 
> 标签：r, igraph

I would like to generate a lattice with 100 nodes but would like to ensure that all nodes have the same number of neighbours.

However when I do:

```
d=graph.lattice(100,0,nei=10,directed=TRUE,circular=TRUE)
get.edgelist(d) 
```

then I can see that many of the nodes do not have the same number of neighbours.

Is there any way to ensure that every node has the same number of connections assuming that the first column represents nodes and the second column connections?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T02:58:51.013

这是因为对于有向图来说，默认的边方向`graph.lattice`并不是最好的。您可以做的是创建一个无向图，然后将其转换为有向图：

```
d <- as.directed(graph.lattice(100, 0, nei=10, directed=FALSE, circular=TRUE))
unique(degree(d, mode="in"))
#  [1] 20 
unique(degree(d, mode="out"))
#  [1] 20 
```

如果您想要非相互边缘，那么最简单（但可读性较差）的解决方案是

```
d <- graph(sapply(1:100, function(i) {
  rbind(i, ((i+1):(i+10)-1) %% 100 + 1)
}))
unique(degree(d, mode="in"))
# [1] 10 
unique(degree(d, mode="out"))
# [1] 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T22:29:58.790

您可以创建一个边缘列表并从中制作图表。在这种情况下，假设您只考虑链接到（定向）的邻居，那么您可以执行以下操作：

```
el <- do.call(rbind,
              lapply(1:100,
                     function(e) {cbind(rep(e,10),
                                        sample(setdiff(1:100, e),10))}))
d <- graph.edgelist(el) 
```

这会选择 10 个随机节点（除了自身）来链接一个节点。

# android - android listview adapter throw exception

> ID：14467225
> 
> 赞同：0
> 
> 时间：2013-01-22T20:15:24.717
> 
> 标签：android, android-listview, android-adapter, android-adapterview

i build an adapter for a listview_item which contains image, textview and textbox, i don't know why the application throw an exception,

```
class RestaurantAdapter extends BaseAdapter {
    private static LayoutInflater inflater = null;
    private ArrayList<HashMap<String, String>> data;
    Activity activity;

    public RestaurantAdapter(Activity activity,
            ArrayList<HashMap<String, String>> data) {
        // TODO Auto-generated constructor stub
        this.activity = activity;
        this.data = data;
        inflater = (LayoutInflater) activity
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return data.size();
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub
        View vi = convertView;
        if (vi == null)
            inflater.inflate(R.layout.restaurant_multi_select_list_item, null);
         TextView name = (TextView) vi
                .findViewById(R.id.restaurant_multi_select_title);
        ImageView image = (ImageView) vi
                .findViewById(R.id.restaurant_multi_select_list_item_image);
        CheckBox cb = (CheckBox) vi
                .findViewById(R.id.restaurant_multi_select_checkBox);
        HashMap<String, String> restaurant = data.get(position);
        name.setText(restaurant.get("name"));
        cb.setSelected(false);
        image.setId(Integer.parseInt(restaurant.get("image")));
        return vi;

    }
} 
```

when i made the `getview` contains just this code

```
View vi = convertView;
            if (vi == null)
                inflater.inflate(R.layout.restaurant_multi_select_list_item, null); 
```

it still throws the exception

if you want any another code i will give it to you

thanks

# edit

exception

```
01-23 19:45:27.021: E/AndroidRuntime(24106): FATAL EXCEPTION: main
01-23 19:45:27.021: E/AndroidRuntime(24106): java.lang.NullPointerException
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.AbsListView.obtainView(AbsListView.java:1521)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.ListView.makeAndAddView(ListView.java:1749)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.ListView.fillDown(ListView.java:674)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.ListView.fillFromTop(ListView.java:731)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.ListView.layoutChildren(ListView.java:1602)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.AbsListView.onLayout(AbsListView.java:1349)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.View.layout(View.java:7320)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1263)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1137)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1051)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.View.layout(View.java:7320)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.FrameLayout.onLayout(FrameLayout.java:342)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.View.layout(View.java:7320)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1263)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1137)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1051)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.View.layout(View.java:7320)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.widget.FrameLayout.onLayout(FrameLayout.java:342)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.View.layout(View.java:7320)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.ViewRoot.performTraversals(ViewRoot.java:1162)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.view.ViewRoot.handleMessage(ViewRoot.java:1882)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.os.Looper.loop(Looper.java:130)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at android.app.ActivityThread.main(ActivityThread.java:3701)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at java.lang.reflect.Method.invokeNative(Native Method)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at java.lang.reflect.Method.invoke(Method.java:507)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:866)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:624)
01-23 19:45:27.021: E/AndroidRuntime(24106):    at dalvik.system.NativeStart.main(Native Method) 
```

# the new exception

```
01-22 12:36:37.994: E/AndroidRuntime(318): FATAL EXCEPTION: main
01-22 12:36:37.994: E/AndroidRuntime(318): java.lang.NullPointerException
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.eattel.syriatel.RestaurantAdapter.getView(Select_Multi_Restaurants.java:113)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.AbsListView.obtainView(AbsListView.java:1294)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.ListView.makeAndAddView(ListView.java:1727)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.ListView.fillDown(ListView.java:652)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.ListView.fillGap(ListView.java:623)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.AbsListView.trackMotionScroll(AbsListView.java:2944)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.AbsListView.onTouchEvent(AbsListView.java:2065)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.widget.ListView.onTouchEvent(ListView.java:3315)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.View.dispatchTouchEvent(View.java:3766)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:897)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1671)
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.app.Activity.dispatchTouchEvent(Activity.java:2086)
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1655)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1785)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.os.Looper.loop(Looper.java:123)
01-22 12:36:37.994: E/AndroidRuntime(318):  at android.app.ActivityThread.main(ActivityThread.java:4627)
01-22 12:36:37.994: E/AndroidRuntime(318):  at java.lang.reflect.Method.invokeNative(Native Method)
01-22 12:36:37.994: E/AndroidRuntime(318):  at java.lang.reflect.Method.invoke(Method.java:521)
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-22 12:36:37.994: E/AndroidRuntime(318):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-22 12:36:37.994: E/AndroidRuntime(318):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:28:38.437

我认为...

```
vi = inflater.inflate(R.layout.restaurant_multi_select_list_item, null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:28:54.330

如果`vi == null`那么你必须将充气机设置为`vi`. 否则你试图从无到有或`null`

例如

```
if (vi == null)
       vi = inflater.inflate(R.layout.restaurant_multi_select_list_item, null); 
```

# thunderbird - Thunderbird inbox: How to auto-scroll to latest email in incoming list?

> ID：14467226
> 
> 赞同：6
> 
> 时间：2013-01-22T20:15:26.267
> 
> 标签：thunderbird

my emails in Thunderbird (V 17.0.2 on Win 8) are sorted by date, the newest mails are on the bottom of the inbox-list.

I want this behavior: As soon as new emails show up in my inbox, the inbox-list shall directly scroll to the newest emails on the bottom of the inbox list. Currently new incoming emails are added to the inbox-list in the correct date-order BUT the list does not auto-scroll to the last (newest) element in this list. I always have to manually scroll down to see the new incoming emails as they are just below my second-newest emails from my previous mail-fetch.

Alternative way to solve my problem and to clarify: After the email-fetch-task has finished, I would need a plugin that automatically presses the END-key on the keyboard (above the cursor keys).

Is it possible to enable this behavior maybe by a special config-flag in "about:config" (edit configuration)?

Thank you a lot!!!

Thomas

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-29T15:59:50.350

目前报告的行为是一个已知的错误[外部参照 bugzilla #539468](https://bugzilla.mozilla.org/show_bug.cgi?id=539468)，没有什么可做的

# c++ - Get base address of process

> ID：14467229
> 
> 赞同：16
> 
> 时间：2013-01-22T20:15:31.587
> 
> 标签：c++, windows, pointers

I want to access a certain address of a process. But for that i need to get the base address of the process first. I'm using a tool to see if i'm actually doing it right. The tool shows i need the following: `"app.exe"+0x011F9B08 = 0x119F8300`

I thought i could obtain the base address of a process through `OpenProcess()`, but that gives me: `0x0000005c` as a result. I don't think that is right? Atleast, not what i need.

I think the base address i need is: `0x119F8300 - 0x011F9B08 = 0x107FE7F8 <-- base?`

This is my code:

```
hWindow = FindWindow(NULL, lpWindowName);
if(hWindow)
{
    GetWindowThreadProcessId(hWindow, &dwProcId);
    if(dwProcId != 0)
    {
            // hProcHandle -> 0x0000005c
            hProcHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, dwProcId);
    }
    else
    {
        return 0;
    }
} 
```

How can i get the base address of the process that i've opened?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-22T20:34:10.680

如果要*在其他进程的地址空间*中获取虚拟地址，可以这样做：

1.  使用 -- 打开进程[`OpenProcess`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684320%28v=vs.85%29.aspx)，如果成功，返回的值是进程的句柄，它只是内核用来标识内核对象的不透明标记。它的确切整数值（在您的情况下为 0x5c）对用户空间程序没有任何意义，除了将其与其他句柄和无效句柄区分开来。
2.  调用[`GetProcessImageFileName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683217%28v=vs.85%29.aspx)以获取进程的主要可执行模块的名称。
3.  用于[`EnumProcessModules`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682631%28v=vs.85%29.aspx)枚举目标进程中所有模块的列表。
4.  对于每个模块，调用[`GetModuleFileNameEx`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683198%28v=vs.85%29.aspx)以获取文件名，并将其与可执行文件的文件名进行比较。
5.  找到可执行文件的模块后，调用[`GetModuleInformation`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683201%28v=vs.85%29.aspx)以获取可执行文件的原始入口点。

这将为您提供虚拟地址，但您无法使用它做很多事情，因为它没有映射到您当前进程的地址空间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-08-08T15:24:47.437

我想详细说明@Adam Rosenfield 的回答。我将在这里以英雄联盟为例。

* * *

为了打开进程（获取句柄），我们需要它的 PID（进程 ID）。我们可以通过窗口句柄（HWND）来做到这一点，因为通常窗口的标题是已知的

```
//You will need to change this the name of the window of the foreign process
HWND WindowHandle = FindWindow(nullptr, L"League of Legends (TM) Client");
DWORD PID;
GetWindowThreadProcessId(WindowHandle, &PID);
PVOID hProcess = OpenProcess(PROCESS_VM_READ | PROCESS_QUERY_INFORMATION, 0, PID); 
```

现在我们能够掌握该过程，让我们继续

```
HMODULE Module = GetModule();
DWORD BaseAddress = (DWORD)Module; 
```

GetModule 函数

```
HMODULE GetModule()
{
    HMODULE hMods[1024];
    HANDLE pHandle = GetHandle();
    DWORD cbNeeded;
    unsigned int i;

    if (EnumProcessModules(pHandle, hMods, sizeof(hMods), &cbNeeded))
        {
        for (i = 0; i < (cbNeeded / sizeof(HMODULE)); i++)
        {
            TCHAR szModName[MAX_PATH];
            if (GetModuleFileNameEx(pHandle, hMods[i], szModName, sizeof(szModName) / sizeof(TCHAR)))
            {
                wstring wstrModName = szModName;
                //you will need to change this to the name of the exe of the foreign process
                wstring wstrModContain = L"League of Legends.exe"; 
                if (wstrModName.find(wstrModContain) != string::npos)
                {
                    CloseHandle(pHandle);
                    return hMods[i];
                }
            }
        }
    }
    return nullptr;
} 
```

至于我个人，我喜欢编写 2 个单独的函数，一个用于获取句柄，一个用于获取模块。

好了，我们已经成功获得了一个外部进程的基地址。

# gwt - GWT ViewWithUiHandlers with DialogBox Uibinder

> ID：14467230
> 
> 赞同：0
> 
> 时间：2013-01-22T20:15:36.267
> 
> 标签：gwt, uibinder, gwt-platform

I have been extending all my Views with ViewWithUiHandlers. So, from the View to invoke a presenter method I call

```
 getUiHandlers().OnUserSelect(); 
```

How do i get the getUiHandlers() when one of view has to extend DialogBox, as a class can't have multiple extends.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T13:15:40.160

这是一个基本弹出窗口的示例。首先，您必须创建一个`PresenterWidget`关联到您的`PopupViewWithUiHandler`：

```
 public class MyPopupPresenter extends PresenterWidget<MyPopupPresenter.MyView>
        implements MyPopupUiHandlers {
    public interface MyView extends PopupView, HasUiHandlers<MyPopupUiHandlers> {
    }

    @Inject
    public MyPopupPresenter(EventBus eventBus,
                            MyView view) {
        super(eventBus, view);

        getView().setUiHandlers(this);
    }
} 
```

这是你的`PopupViewWithUiHandlers`：

```
public class MyPopupView extends PopupViewWithUiHandlers<MyPopupUiHandlers>
        implements MyPopupPresenter.MyView, {
    public interface Binder extends UiBinder<PopupPanel, MyPopupView> {
    }

    @Inject
    public MyPopupView(Binder binder,
                       EventBus eventBus) {
        super(eventBus);

        initWidget(binder.createAndBindUi(this));
    }
} 
```

这是与您的`PopupViewWithUiHandlers`. 注意`<g:PopupPanel>`：

```
<ui:UiBinder xmlns:ui='urn:ui:com.google.gwt.uibinder'
             xmlns:g='urn:import:com.google.gwt.user.client.ui'>
    <g:PopupPanel>
        <g:HTMLPanel>
            ...
        </g:HTMLPanel>
    </g:PopupPanel>
</ui:UiBinder> 
```

而且，您可以通过调用`addToPopupSlot(myPopupPresenter)`parent来显示弹出窗口`Presenter`：

```
public class MyPresenter extends Presenter<MyPresenter.MyView, MyPresenter.MyProxy>       implements MyUiHandlers {
    public interface MyView extends View, HasUiHandlers<MyUiHandlers> {
    }

    @ProxyStandard
    @NameToken(NameTokens.myNameToken)
    public interface MyProxy extends ProxyPlace<MyPresenter> {
    } 

    private final MyPopupPresenter myPopupPresenter;

    @Inject
    public MyPresenter(EventBus eventBus,
                       MyView view,
                       MyProxy proxy,
                       MyPopupPresenter myPopupPresenter) {
        super(eventBus, view, proxy, ApplicationPresenter.MainContentSlot);

        this.myPopupPresenter = myPopupPresenter;

        getView().setUiHandlers(this);
    }

    private void showPopup() {
        addToPopupSlot(myPopupPresenter); // this will show your popup
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T22:58:11.293

看着`PopupViewWithUiHandler`

# grails - 作为 Grails 应用程序功能的一部分，是否可以允许编辑 GSP（包括布局）？

> ID：14467233
> 
> 赞同：2
> 
> 时间：2013-01-22T20:15:42.503
> 
> 标签：grails, content-management-system, gsp

我正在一个 Grails 站点上工作，尽管它需要包含许多类似 CMS 的功能，但尚未（由于各种原因）作为实际 CMS 安装的一部分构建。我需要允许用户做的一件事是编辑 HTML 布局——在 Grails 应用程序中，布局在 GSP 文件中——以及不同页面的其他通常静态元素，它们都不会被绑定到任何特定的域对象，也不构成处理域对象的 CRUD 页面之一的任何部分。

我知道既[可以指定视图目录](https://stackoverflow.com/questions/7840439/grails-how-to-change-compiled-gsps-gsp-class-files)，也可以从应用程序的某处写入正在运行的应用程序中的实际文件。我进一步知道，如果我要这样做，可能需要非常小心，以确保用户不会严重破坏页面的整个布局和内容，我已准备好处理这个问题。但是是否可以允许用户编辑用于创建 Grails 页面的布局和其他 GSP 文件？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-25T15:53:18.863

如果您将模板/布局存储在数据库中（正如上面的一些建议），您可以使用 GroovyPagesTemplateEngine 呈现它：

```
package com.mycompany

import groovy.text.Template;
import org.codehaus.groovy.grails.web.pages.GroovyPagesTemplateEngine 

class TemplatingService {
  GroovyPagesTemplateEngine groovyPagesTemplateEngine

  def render(String templateString, Map model) {
    ByteArrayInputStream bais = new ByteArrayInputStream(templateString.getBytes());
    Template template = groovyPagesTemplateEngine.createTemplate(bais)

    try {
      def writer = new StringWriter()
      template.make(model).writeTo(writer)
      return writer.toString()
    } catch (Exception e) {
      // handle exception
      return ""    // or "[an error occurred]" or rethrow the exception
    }
  }
} 
```

现在，虽然您可以**这样**做，但请务必考虑其中的含义。您可以在 gsp 中执行的任何操作都可以在此上下文中执行。例如写入或删除文件、执行命令等。

我从来没有想过如何利用 SecurityManager 来限制模板中可以做的事情，所以我的解决方案是不允许用户将模板输入数据库。如果我想要一个新模板，我会在检查安全隐患后自己把它放在那里。

您还可以通过缓存结果来提高性能，`createTemplate()`以避免每次都重新编译。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:41:12.333

一种简单的方法是将 HTML 块作为域对象存储在数据库中。然后，您的视图可以自动拉入 html。可以创建一个简单的界面来允许用户编辑 html。有关此问题的更多讨论，请参阅[此线程](http://grails.1312388.n4.nabble.com/Ideas-needed-for-quick-Grails-page-updates-td3313708.html)另一个可能的选择是使用[Weceem 插件](http://grails.org/plugin/weceem)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T06:14:00.693

布局也是一个 gsp 视图，根据定义，它负责处理动态视图内容。

但是，直接编辑 gsp 文件并在运行时编译它们并不是一个好习惯。

相反，您可以定义一个域类，其中自定义内容被持久化并从预定义的 gsp 布局加载。

具体来说，您可以定义类似以下域类的内容来保存自定义 Web 元素：

```
class Module {
    Integer positionLeft
    Integer positionTop
    Integer width
    Integer height
    String  className   //CSS class
    String  border      
    String  borderColor 
    Integer borderSize  
    Integer seq
    String  content
    String  type
    static  hasMany = [components: Component]        //inner elements within a module
    Module  parentModule                    //support nested module structure to ensure flexibility
    User    owner
}

class Component {
    String title
    String content
    String methodName
    String url
    String type     //I-image，A-attachment，L-external link，T-text，G-graph report，D-data table，R RSS FEED...
    String font
    String fontFamily
    String fontBold
    String fontUnderline
    String color    
    String textAlign
    String source      //uri -- enables ajax call to some method to get dynamic data
    Integer seq
} 
```

使用客户端 javascript，该应用程序可以轻松地使用户通过拖动、调整大小、从某些菜单中选择不同的元素类型以及提交给对这些元素执行 CRUD 操作的后端控制器来生成自定义视图。

然后在布局中，将那些自定义的元素一一渲染：

```
<%@ page import="com.app.Module" %>
<g:each in="${Module.findAllByOwnerAndParentModuleIsNull(session.user,[fetch:[components:'join']]).collect {[
            id:it.id,
            posLeft:it.posLeft,
            posTop:it. posTop,
            width:it.width,
            height:it.height,
            className:it.className,
            border:it.border,
            borderColor:it.borderColor,
            borderSize:it.borderSize,
            seq:it.seq,
            content:it.content,
            type:it.type,
            components:it.components,
            innerModules:Module.findAllByParentModule(it)
        ]}}" var="module" status="i">
    <div class="${module.className?module.className:''}" style="position: absolute; left: ${module.posLeft}px; top: ${module.posTop}px; width: ${module.width}px; height: ${module.height}px; border: ${module.borderColor} ${module.borderSize?(module.borderSize+'px'):''} ${module.border};">
        <g:each in="${module.innerModules}" var="inner">  
             <div class="${inner.className?inner.className:''}"  style="position: absolute; left: ${inner.posLeft-module.posLeft}px; top: ${inner.posTop-module.posTop}px; width: ${inner.width}px; height: ${inner.height}px; border: blue 1px solid;">
                  <g:render template="/home/module" model="[
                      module: inner
                  ]"/>
            </div>
        </g:each> 
        <g:render template="/home/module" model="[
             module: module
        ]"/>
    </div>
</g:each> 
```

这样，每个用户都可以管理其个性化的布局。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T17:06:32.993

在 Grails 下呈现 GSP 文件的正确方法是使用 Grails 的 GSP bean。有了这个，您可以访问*所有*标签库功能。以下是我的 Grails 插件中处理 GSP 文件的片段：

```
GroovyPagesTemplateEngine gsp = (GroovyPagesTemplateEngine)appCtx.getBean(GROOVY_PAGES_TEMPLATE_ENGINE);
Template template = gsp.createTemplate(new ByteArrayResource(bufferStr.getBytes(encoding)), false);
Writable w = template.make();
StringWriter sw = new StringWriter();
w.writeTo(new PrintWriter(sw)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-23T03:57:21.640

虽然可能，但我没有将类似 cms 的功能集成到 Grails 应用程序中，而是看到了不同的方法。

一种方法是将 CMS 放在一边并确保它能够：

*   在转换过程之后读取 gsp，通常是自动或计划的作业

*   生成 Grails 应用程序使用的 gsp 文件。在这种情况下，正如您提到的，您可以覆盖视图位置。

为了避免我所描述的方法出现严重的 UI 问题或 CMS 限制，您不会使用布局。CMS 供应商提供模块来导入/导出 GSP 文件，如果不是您自己编写该层。

希望对你有帮助，祝你好运。

# java - 如何判断数据库是否已关闭或不可用？

> ID：14467235
> 
> 赞同：3
> 
> 时间：2013-01-22T20:15:55.140
> 
> 标签：java, spring, hibernate, jms

我正在使用 Spring DefaultMessageListenerContainer 来使用队列中的消息。然后将消息保存到 Oracle 数据库。

当数据库出现故障时，我从 onMessage 方法中抛出一个异常，并将消息留在队列中以进行重新处理。在下面您可以看到，在 DataAccessResourceFailureException 和 CannotCreateTransactionException 异常中，我将异常从方法中抛出，这会将其放回队列中。其他异常不保存消息；它们对应于数据问题等。

```
public void onMessage(javax.jms.Message mqMessage) {
    ...get the message blah, blah, blah
    try {
        this.theService.doMessage(tmaticMessage, theHandler);
    } catch (DataAccessResourceFailureException e) {
        this.slowDown(mqMessage);
        throw e;
    } catch (CannotCreateTransactionException e) {
        this.slowDown(mqMessage);
        throw e;
    } catch (DataAccessException e) {
        ...
    } catch (TmUnusableMessageException e) {
        ...
    } catch (Exception e) {
        ...
    }
} 
```

阅读 Spring 文档，我发现应该抛出 DataAccessResourceFailureException “......当资源完全失败时：例如，如果我们无法使用 JDBC 连接到数据库。” 问题是我刚刚做了一个测试，让 DBA 关闭数据库并得到一个新异常：CannotCreateTransactionException。所以这是另一个可以抛出的异常。我想知道是否还有其他人。

我正在使用 Spring Connections 和 getHibernateTemplate() 拨打电话。这是问题。我如何知道数据库出现故障时会引发哪些异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T00:31:34.197

也许复杂性是由您可以“关闭数据库”的各种方式引起的。例如：

*   删除表
*   删除整个数据库
*   禁用 db 用户帐户
*   关闭数据库服务器

所有都可以被认为是“关闭数据库”，但每个都可能导致抛出不同的异常

如果您浏览 spring javadoc 中的以下部分，则会出现可能引发的异常列表：

[http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/dao/package-frame.html](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/dao/package-frame.html)

[http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/package-frame.html](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/package-frame.html)

# c# - 在 EnvDTE 中调试时捕获 VS 局部变量

> ID：14467241
> 
> 赞同：2
> 
> 时间：2013-01-22T20:16:08.827
> 
> 标签：c#, visual-studio-2010, visual-studio-debugging, envdte, visual-studio-extensions

是否可以将 EnvDTE 用于 .vsix Visual Studio 扩展来捕获本地和调试窗口使用的调试数据？或者可以通过其他方法吗？

我想创建一个自定义的 Locals 窗口，我们可以对其进行修改以显示我们喜欢的一些更重的内容，而不会牺牲高级用户的原始 Locals 窗口。理想的解决方案是获取发送到本地窗口的数据，这样我就可以构建自己的树。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T22:48:41.530

原来这实际上很简单！

```
DTE dte = (DTE).Package.GetGlobalService(typeof(DTE));
if(dte.Debugger.CurrentStackFrame != null) // Ensure that debugger is running
{
    EnvDTE.Expressions locals = dte.Debugger.CurrentStackFrame.Locals;
    foreach(EnvDTE.Expression local in locals)
    {
        EnvDTE.Expressions members = expression.DataMembers;
        // Do this section recursively, looking down in each expression for 
        // the next set of data members. This will build the tree.
        // DataMembers is never null, instead just iterating over a 0-length list.
    }
} 
```

每个表达式包含：

*   **名称**（字符串）
*   **值**（显示在本地窗口中的字符串值）
*   **类型**（类型的字符串名称）
*   **Parent**（类型是父类型）
*   **DataMembers**（其子项的可迭代集合（从不为空））
*   **有效**（布尔）

希望这可以帮助其他想要做类似事情的人！

# debugging - 为什么我的 VLC 插件崩溃这么多

> ID：14467245
> 
> 赞同：2
> 
> 时间：2013-01-22T20:16:28.137
> 
> 标签：debugging, plugins, lua, vlc

所以我决定在 Lua 中编写一个 VLC 插件......我对这两种技术都是全新的，我有一个插件可以工作，但是我使用它每 25 或 30 次它就会崩溃。它的目标是让播放头到达曲目的最后 5、7 或 10 秒。

这是来源：

```
function activate() 
    initialize()
    index=0 -- when activate already playing.

    local d = vlc.dialog("Begin-End" )
    d:add_button("begin",do_begin,1,1,1,1)
    d:add_button("end 10",do_end,3,1,1,1)
    d:add_button("end 7",do_end_7,4,1,1,1)
    d:add_button("end 5", do_end_5,4,2,1,1)

    d:add_button("prev playlist",do_prevplaylist,1,2,1,1)
    d:add_button("next playlist",do_nextplaylist,3,2,1,1)
    d:show()
    update()
end

function initialize()
    input=vlc.object.input()
    d=vlc.input.item():duration()
    index=0
end

function input_changed()
    initialize()
    update()
end
function meta_changed()
end

function deactivate()

end

function close()
    vlc.deactivate()
end

function update()
    if index==1 then
        vlc.var.set(input,"time",0)
    end
    if index==2 then
        vlc.var.set(input,"time",d-10)
    end
    if index==3 then
        vlc.var.set(input, "time", d-7) 
    end
    if index==4 then
        vlc.var.set(input, "time", d-5)
    end
end
function do_nextplaylist()
    vlc.playlist.next()
end
function do_prevplaylist()
    vlc.playlist.prev()
end
function do_begin()
    index = 1
    update()
end
function do_end()
    index = 2
    update()
end
function do_end_7() 
    index = 3
    update()
end
function do_end_5()
    index = 4
    update()
end 
```

任何帮助将不胜感激。

# c# - 是否有与 Java deployment.properties 文件等效的 Adob e？

> ID：14467248
> 
> 赞同：1
> 
> 时间：2013-01-22T20:16:52.687
> 
> 标签：c#, java, flash, adobe-reader

正如标题所述，是否存在与 Java deployment.properties 文件等效的 Adob​​e？

我正在编写 ac# 应用程序来测试我们网络中应用程序的安装。我老板名单上的前三名是java、flash和reader。我需要能够找出每个应用程序的哪些版本安装在机器上以便生成报告（强制用户更新/等）。

我知道我可以通过检查“\Sun\Java\Deployment\deployment.properties”来检查版本号并确认 IE 访问我的 JRE 的能力。我会检查什么文件来确认 adobe reader 和 flash 是否相同？

提前感谢您提供的任何帮助或提供更多信息的链接。

编辑：我需要从浏览器执行此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T22:52:35.940

这不是一个非常干净的解决方案，但由于唯一的“官方”方法似乎是从 Windows 注册表中检查它，也许这会有所帮助：

我们知道 Flash 文件位于（windows 目录）\system32\Macromed\Flash（或 64 位系统上的 SysWow64\Macromed\Flash）中。

每次闪存更新时，它都会在日志文件中跟踪进度。根据 flash 版本，您将拥有 a) install.log（非常旧的 flash 版本）或 b) FlashInstall.log

**a)**如果您浏览文件，您会看到各种完整的内容，其中一种类型如下所示：`WriteRegStr: "HKEY_CURRENT_USER\SOFTWARE\Macromedia\FlashPlayer" "FlashPlayerVersion"="10.0.45.2"`.

现在您可以从下到上浏览该文件并匹配`"FlashPlayerVersion"=`字符串以获取最新版本。

但是，这是针对真正旧版本的 flash 并且 install.log 文件从未从该目录中删除，因此请确保您也检查**FlashInstall.log**！

**b)**使用类似的方法，除了新的安装日志不保留“WriteRegStr”信息。现在您可以改为查找 dll 文件名本身，例如我上次更新创建了一个安装日志`0009 [I] 00000014 C:\WINDOWS\system32\Macromed\Flash\NPSWF32_11_5_502_146.dll`，这意味着我的闪存版本是 11.5.502.146

**另一种选择**是

*   检查插件核心文件的创建日期并与版本发布日期进行比较（如果有人以某种方式设法安装旧版本，则非常不可靠）
*   检查 NPSWF[..version..].dll 文件的实际属性。您可以在“版本”选项卡中查看所有完整且准确的版本详细信息。![属性](../Images/d6dc0f8964bf608ae38f0b87d06dfa73.png)但是，我不知道如何从脚本中访问 rightclick->properties，所以如果你决定选择这个选项，你必须自己找出来
*   问独角兽

# javascript - 确定 GET 请求的要求

> ID：14467250
> 
> 赞同：1
> 
> 时间：2013-01-22T20:17:03.097
> 
> 标签：javascript, ajax, http-get

雅虎！Sports 提供了一项新功能，可以为特定的一天设置您的梦幻球队阵容。它通过一个简单的 URL 工作，如下所示：

```
http://hockey.fantasysports.yahoo.com/hockey/{leagueId}/{teamId}/startactiveplayers?date={yyyy}-{mm}-{dd}&crumb={crumb} 
```

如果我填写参数并**在浏览器中**访问该页面，它工作正常。

如果我尝试并**自动化**这个过程（我的想法是我可以在本赛季剩下的时间里设置我的阵容，并且只根据需要进行调整）它不起作用。

我尝试使用 AJAX 调用提交请求，该调用返回一个没有响应对象的非描述性错误，以及一个返回成功响应的 Phantom JS 调用，尽管阵容更改实际上并未生效。

我怎样才能弄清楚缺少什么？

*编辑*：这是一个示例 AJAX 请求：

```
Request URL:http://hockey.fantasysports.yahoo.com/hockey/56377/3/startactiveplayers?date=2013-1-22&crumb=DmhVvCa0WXX
Request Headersview source
Accept:*/*
Origin:null
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.52 Safari/537.17
Query String Parametersview sourceview URL encoded
date:2013-1-22
crumb:DmhVvCa0WXX 
```

和回应：

```
readyState: 0
responseText: ""
status: 0
statusText: "error" 
```

# c# - 在 Silverlight 中请求 GZipped 内容

> ID：14467252
> 
> 赞同：0
> 
> 时间：2013-01-22T20:17:09.403
> 
> 标签：c#, silverlight, httpwebrequest

我在使用 Silverlight 5 请求 Gzipped 内容时遇到问题。为了减少使用的带宽，我想对从我们的 Web 服务请求的内容使用 gzip，但不幸的是，这不起作用。

我正在使用客户端堆栈并发送一个 HttpWebRequest。我尝试设置 Accept-Encoding 标头，但它告诉我不允许我直接更改它 - 并且没有其他属性！

那么如何发送自定义的 Accept-Encoding 标头？

这是我在 App-Constructor 中的代码：

```
WebRequest.RegisterPrefix("http://", WebRequestCreator.ClientHttp);
WebRequest.RegisterPrefix("https://", WebRequestCreator.ClientHttp); 
```

这就是我创建请求并设置标头的方式：

```
var webRequest = (HttpWebRequest)WebRequest.Create(requestUri);
webRequest.Headers["Accept-Encoding"] = "gzip, deflate"; 
```

这是一个例外：

```
{System.ArgumentException: The 'Accept-Encoding' header cannot be modified directly.
Parameter name: name
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at MyClass} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T23:20:50.827

不幸的答案是：如果你想 gzip，不要使用客户端堆栈（浏览器堆栈已经为你处理了这个）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:10:47.680

在这种情况下，我很幸运能够控制服务端和客户端。我现在所做的是添加一个额外的自定义标头，它将基本上覆盖 Accept-Encoding 标头。我称之为“接受-编码-覆盖”。当我的服务遇到此标头时，无论 Accept-Encoding 标头中有什么内容，它都会压缩内容。在客户端 silverlight 端，我检查响应中的 Content-Encoding 标头，并在必要时使用 SharpZipLib 解压缩（DotNetZip 不起作用）。

我仍然将 dotMorten 标记为他的回答是我问题的实际答案。使用 ClientStack 时无法设置标头。

# arrays - 在 perl 数组中移动元素

> ID：14467256
> 
> 赞同：3
> 
> 时间：2013-01-22T20:17:38.277
> 
> 标签：arrays, perl

我在数组中有一个元素，我想相应地移动它。

```
@array = ("a","b","d","e","f","c"); 
```

基本上我想找到“c”的索引，然后根据“d”的索引再次将它放在“d”之前。我以这些字符为例。它与按字母顺序排序无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:31:49.963

尝试使用*数组切片*执行此操作并`List::MoreUtils`查找数组元素索引：

```
use strict; use warnings;
use feature qw/say/;

# help to find an array index by value
use List::MoreUtils qw(firstidx);

my @array = qw/a b d e f c/;

# finding "c" index
my $c_index = firstidx { $_ eq "c" } @array;

# finding "d" index
my $d_index = firstidx { $_ eq "d" } @array;

# thanks ysth for this
--$d_index if $c_index < $d_index;

# thanks to Perleone for splice()
splice( @array, $d_index, 0, splice( @array, $c_index, 1 ) );

say join ", ", @array; 
```

见 [拼接（）](http://perldoc.perl.org/functions/splice.html)

## 输出

```
a, b, c, d, e, f 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T20:50:39.230

```
my @array = qw/a b d e f c/;
my $c_index = 5;
my $d_index = 2;

# change d_index to what it will be after c is removed
--$d_index if $c_index < $d_index;
splice(@array, $d_index, 0, splice(@array, $c_index, 1)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T20:46:15.130

好吧，这是我的尝试:-)

```
#!/usr/bin/perl
use strict;
use warnings;
use List::Util qw/ first /;

my @array = ("a","b","d","e","f","c");
my $find_c = 'c';
my $find_d = 'd';

my $idx_c = first {$array[$_] eq $find_c} 0 .. $#array;
splice @array, $idx_c, 1;

my $idx_d = first {$array[$_] eq $find_d} 0 .. $#array;
splice @array, $idx_d, 0, $find_c;

print "@array"; 
```

这打印

```
C:\Old_Data\perlp>perl t33.pl
a b c d e f 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:26:07.830

你可以试试这个

```
my $search = "element";
my %index;
@index{@array} = (0..$#array);
 my $index = $index{$search};
 print $index, "\n"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-22T20:32:52.850

您可以使用`splice`在数组中的特定索引处插入元素。还有一个简单的 for 循环来查找您寻找的索引：

```
my @a = qw(a b d e f c);
my $index;

for my $i (keys @a) { 
    if ($a[$i] eq 'c') { 
        $index = $i; 
        last; 
    } 
} 

if (defined $index) { 
    for my $i (keys @a) { 
        if ($a[$i] eq 'd') { 
            splice @a, $i, 1, $a[$index];
        } 
    } 
}

use Data::Dumper; 
print Dumper \@a; 
```

**输出：**

```
$VAR1 = [
          'a',
          'b',
          'c',
          'e',
          'f',
          'c'
        ]; 
```

请注意，此代码不会删除该`c`元素。为此，您需要跟踪是插入`c`before 还是 after `d`，因为您正在更改数组的索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-22T20:37:25.063

另一种使用数组切片的解决方案。这假设您知道数组中元素的期望。

```
use strict;
use warnings;

my @array = qw(a b d e f c);
print @array;

my @new_order = (0, 1, 5, 2, 3, 4);
my @new_list = @array[@new_order];

print "\n";
print @new_list; 
```

[有关详细信息，请参阅PerlMonks](http://www.perlmonks.org/?node_id=564363)的此链接。

# c# - 使用 lambda 查找所有实体

> ID：14467266
> 
> 赞同：3
> 
> 时间：2013-01-22T20:18:12.143
> 
> 标签：c#, linq

我有一个`List<Person>`（人）每个人都有一个`List<Kid>`（孩子）

如果我想找到所有的孩子，在 LINQ 中我会这样做

```
var kids=new List<Kids>();

foreach(var p in people)
{
    foreach(var kid in p.Kids)
    {
         kids.Add(kid);
    }
} 
```

有没有一种使用 LINQ 的方式来做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-22T20:20:08.740

它就像[SelectMany](http://msdn.microsoft.com/en-us/library/bb534336.aspx)一样简单：

> 将序列的每个元素投影到 IEnumerable 并将生成的序列展平为一个序列。

```
var kids = people.SelectMany(p => p.Kids); 
```

（如果您想要 a`List<Kid>`而不是`IEnumerable<Kid>`，只需调用`.ToList()`结果即可。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T20:21:04.433

您可以使用[SelectMany](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.selectmany.aspx)扩展方法

```
var kids = new List(people.SelectMany(person => person.Kids)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T20:23:14.813

的“LINQ-non-lambda-style”版本`SelectMany`：

```
var allKids = 
  from p in people
  from k in p.Kids  // secondary "from" makes SelectMany (aka flat map)
  select k;

// Result from above is IEnumerable, to Force evaluation as a List:
List<Kid> allKidsList = allKids.ToList(); 
```

# jquery - 使用 Visual Force 的 Twitter Bootstrap 无法正常工作（无法加载资源）

> ID：14467267
> 
> 赞同：0
> 
> 时间：2013-01-22T20:18:12.717
> 
> 标签：jquery, twitter-bootstrap, salesforce, visualforce

我试图与之集成`Twitter Bootstrap`这`Visual Force` 是我的 Visual Force 代码

```
 <apex:page standardStylesheets="false" showHeader="false" sidebar="false">
  <!-- Begin Default Content REMOVE THIS -->
  <head>
   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js"
        type="text/javascript"></script> 
  <apex:stylesheet value="{!URLFOR($Resource.Bootstrap, 'css/bootstrap.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.Bootstrap, 'css/bootstrap.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.Bootstrap, 'css/bootstrap-responsive.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.Bootstrap, 'css/bootstrap-responsive.min.css')}" />

  <apex:includeScript value="{!URLFOR($Resource.Bootstrap, 'js/bootstrap.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.Bootstrap, 'js/bootstrap.min.js')}"/>
</head>
  <body>
  <div id="force">

  <div class="navbar navbar-inverse navbar-fixed-top"> 
      <div class="navbar-inner" style="background-image: -webkit-linear-gradient(top, #FF7F24, #DC143C);"> 
        <div class="container"> 
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse"> 
            <span class="icon-bar"></span> 
            <span class="icon-bar"></span> 
            <span class="icon-bar"></span> 
          </a> 
          <a class="brand" href="#">mypro</a> 
          <div class="nav-collapse collapse"> 
            <ul class="nav"> 
              <li class="active"><a href="http://twitter.github.com/bootstrap/examples/hero.html#">Home</a></li> 
              <li><a href="#">About</a></li> 
              <li><a href="#">Contact</a></li> 
              <li class="dropdown"> 
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">Blogs <b class="caret"></b></a> 
                <ul class="dropdown-menu"> 
                  <li><a href="#">Thoughts</a></li> 
                  <li class="divider"></li>                  
                  <li><a href="#">Team Blog</a></li> 
                </ul> 
              </li> 
            </ul> 
            <form class="navbar-form pull-right"> 
              <input class="span2" placeholder="Email" type="text" /> 
              <input class="span2" placeholder="Password" type="password" /> 
              <button class="btn" type="submit">Simple form</button> 
            </form> 
          </div> 
        </div> 
      </div> 
    </div> 

    <div class="container"> 

      <div class="hero-unit"> 
        <h1>Hello, kjhkkhj!</h1> 
        <p>This is a one page demo, showing you how to use Twitter Bootstrap with VF pages, enjoy!</p> 
        For more info on Bootstrap, <a class="btn-custom btn-primary btn-large" href="http://twitter.github.com/bootstrap/">Learn more &raquo;</a> 
      </div> 
    </div> 

    <hr /> 

      <footer><label> 
khkjhkhj, 2012</label> 
      </footer> 

  </div>
  </body>
  <!-- End Default Content REMOVE THIS -->
</apex:page> 
```

但我得到的一点也不像`bootstrap`。当我在 chrome 中检查 url 时，开发者控制台`failed to load resource`显示所有引导文件。任何一点我会出错的地方

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T00:00:10.247

我已经下载了图书馆。看起来 zip 文件包含 1 个名为“bootstrap”的目录，并且只有在该目录下才有“css”、“js”等。这意味着你必须重新打包它或引用完整的相对路径（听起来很愚蠢，“完整的相对“， 我知道）。我推荐后者，因为每当您想上传新版本的库时，这意味着更少的工作。我对 jQuery mobile 也有同样的看法。

如果前缀类似于`{!URLFOR($Resource.Bootstrap, 'bootstrap/css/bootstrap.css')}`不起作用 - 试试这个：

1.  单击静态资源上的“查看文件”（应该使用 zip 文件保存窗口提示您的内容）。复制路径。看起来类似于`https://na5.salesforce.com/resource/1354306153000/jquerymobile`。
2.  您可以删除时间戳的东西，仍然可以工作：（`https://na5.salesforce.com/resource/jquerymobile`我猜他们这样做是为了确保在您上传新资源后缓存被破坏）。
3.  继续添加目录组件，尝试导航文件夹结构，直到找到可行的东西。在我的情况下，它`https://na5.salesforce.com/resource/jquerymobile/jquery.mobile-1.2.0/images/ajax-loader.gif`给了我一个很好的提示，我应该在 URLFOR 中输入什么。

# asp.net-mvc - 带有MVC4模型绑定的Angular JS因日期/日期时间而失败？

> ID：14467277
> 
> 赞同：3
> 
> 时间：2013-01-22T20:19:00.830
> 
> 标签：asp.net-mvc, asp.net-mvc-4, angularjs

使用 Angular JS 将日期时间和日期时间的复杂对象回传到服务器时？值没有正确绑定。我试过 JSON.stringify 无济于事。我已经发布了一个相关的问题，尽管它可能太笼统了。我真正需要知道的是如何正确传递这些日期。我目前正在做的是在 js 中使用解决方法来转换日期，但我宁愿不这样做，而只是在 Angular 中以我需要的形式获取日期然后传回正确的值。

你如何绑定到那些日期时间/日期时间？值正确吗？请参阅以下代码示例和 Fiddler 发布结果。

C#类：

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime BirthDate { get; set; }
    public DateTime? ApprovedForSomething { get; set; }
} 
```

Angular JS 控制器：

```
function PersonController($scope, $http) {
    $scope.getPerson = function () {
        $http.get('../../Home/GetPerson/1').success(function (data) {
            $scope.Person = data;
        });
    }
    $scope.updateApprovedForSomething = function () {
        $http.post('../../Home/UpdatePerson', { person: $scope.Person }).success(function (data) {
            console.log(data);
        });
    }
} 
```

提琴手帖子：

> HTTP/1.1 200 OK 缓存控制：私有内容类型：应用程序/json；charset=utf-8 Server: Microsoft-IIS/8.0 X-AspNetMvc-Version: 4.0 X-AspNet-Version: 4.0.30319 X-SourceFiles: =?UTF-8?B?YzpcdXNlcnNcbmlja1xkb2N1bWVudHNcdmlzdWFsIHN0dWRpbyAyMDEyXFByb2plY3RzXFZhbGlkYXRpb25UZXN0XEhvbWVcR2V0UGVyc29uXDE=?= X-Powered-By: ASP.NET 日期：2013 年 1 月 16 日，星期三 14:48:34 GMT 内容长度：124
> 
> {"FirstName":"Bob","LastName":"Smith","BirthDate":"/Date(695573315098)/","ApprovedForSomething":"/Date(1358261315098)/"}

这是服务器端的结果。日期时间绑定到不正确的新日期时间值和日期时间？一片空白。

![在此处输入图像描述](../Images/0532d0586a9a7ebc2531711fcd8705f6.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T20:31:24.097

如果有人有更好的解决方案，请随时更新答案。

那里可能有更好的解决方案，但我所做的是非常简单的解决方法。只需为 DateTime 对象创建一个封装属性以将其用于字符串并将其用于绑定目的。

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime BirthDate { get; set; }
    public DateTime? ApprovedForSomething { get; set; }
    public DateTime BirthDateAsString 
    {
        get { return BirthDate.ToShortDateString();}
        set { DateTime.Parse(value, BirthDate);}
   }
} 
```

通过 http，所有对象都被视为字符串，但 ASP.NET 足够智能，可以提供模型绑定功能。但是，它无法将 JavaScript Date 对象绑定到 .NET`DateTime`对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-12T10:56:21.060

更强大的方法是使用模型绑定器来处理所有传入的日期。

```
public class DateTimeBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var name = bindingContext.ModelName;
        var value = bindingContext.ValueProvider.GetValue(name);
        if (value == null) 
            return null;

        DateTime date;
        if (DateTime.TryParse(value.AttemptedValue, null, DateTimeStyles.RoundtripKind, out date))
            return date;
        else
            return base.BindModel(controllerContext, bindingContext);
    }
} 
```

添加全局 ASAX。

```
var dateTimeBinder = new DateTimeBinder();

ModelBinders.Binders.Add(typeof(DateTime), dateTimeBinder);
ModelBinders.Binders.Add(typeof(DateTime?), dateTimeBinder); 
```

# javascript - 从 Node 和 Browser 运行时都需要 Javascript 模块

> ID：14467282
> 
> 赞同：2
> 
> 时间：2013-01-22T09:26:18.280
> 
> 标签：javascript, node.js

我正在使用 Nodejs 编写一些示例程序，这些示例程序也应该可以从浏览器中调用。我在从 Nodejs 中调用 JavaScript 文件时遇到了问题，这种方式也与浏览器 JS 语义兼容（因此`require`，特定于 Node 的，不会完成这项工作）。

假设我有三个 .js 文件：“A.js”、“B.js”和“C.js”。“A.js”是用 Node.js 编写的。“B.js”和“C.js”是用纯 JavaScript 编写的（也就是说，它们应该可以从浏览器调用）。

我需要从“A.js”调用“B.js”中存在的函数 b()。所以我 eval() "B.js" 导出方法 b()。这工作正常。当我在“B.js”中的函数 b() 调用“C.js”中的函数 c() 时，就会出现问题。

```
B.js:

function b()
{
    console.log('In function b');
    c();
}

C.js:

function c()
{
    console.log('In function c');
} 
```

我如何确保解决依赖关系？任何帮助，将不胜感激。谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T10:03:48.780

在 node.js 中，有一个[`require`](http://nodejs.org/api/modules.html)功能，允许您要求一个文件并使用导出的内容。

C.js：

```
function c() {
    console.log('In function c');
}

// This is the exported object
module.exports = {
    c: c
}; 
```

B.js：

```
function b() {
    var c = require('./c.js');
    // "c" is now the exported object

    console.log('In function b');
    c.c();
}

module.exports = {
    b: b
}; 
```

A.js：

```
var b = require('./b.js');

b.b(); // "In function b" "In function c" 
```

您绝对应该阅读如何处理 node.js 中的模块：[http ://nodejs.org/api/modules.html](http://nodejs.org/api/modules.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T10:52:54.507

您可以手动加载普通的 javascript 文件`eval`。在您的情况下，您可以创建一个加载纯 javascript 文件的节点模块。像这样：

**bc.js**：

```
var fs = require('fs');

// load and eval b.js and c.js
eval(fs.readFileSync('./b.js','utf8') + fs.readFileSync('./c.js','utf8'));

// put function b and c in exports
module.exports = {
    b : b,
    c : c
}; 
```

因此，每当您需要 bc.js 时，您将同时获得`b`and`c`函数并`b`可以使用该`c`函数。

有关更多详细信息，请参阅以下问题：[Load "Vanilla" Javascript Libraries into Node.js](https://stackoverflow.com/questions/5171213/load-vanilla-javascript-libraries-into-node-js)

# android - Android - 强制 Facebook 连接

> ID：14467289
> 
> 赞同：0
> 
> 时间：2013-01-22T20:19:44.027
> 
> 标签：android, facebook

我是法国人，所以请原谅我的英语！

我正在开发一个 Android 应用程序，我想让我的用户通过 Facebook 与我们联系。但 ！但是，我想“强制”代码使用 facebook 网络而**不是**启动 facebook 应用程序！

我清楚了吗？:)

非常感谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:48:54.070

通常，不建议仅使用 webview 进行登录，因此除非您有非常具体的用例，否则应始终使用 SSO。

也就是说，您可以通过将[SessionLoginBehavior.SUPPRESS_SSO](https://developers.facebook.com/docs/reference/android/3.0/SessionLoginBehavior#SUPPRESS_SSO)传递给[Session.OpenRequest](https://developers.facebook.com/docs/reference/android/3.0/Session.OpenRequest)来禁用 SSO 。

首先，您需要熟悉[适用于 Android 的 Facebook SDK](https://developers.facebook.com/android/)。请务必阅读[入门指南](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)，然后阅读[使用 Facebook 登录](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/)教程。

按照教程，如果您使用的是 LoginButton，那么您只需调用

```
LoginButton authButton = (LoginButton) view.findViewById(R.id.authButton);
authButton.setLoginBehavior(SessionLoginBehavior.SUPPRESS_SSO); 
```

在您的 onCreateView() 方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T03:11:04.730

如果您不需要为用户自动登录，那么只需触发一个启动 Web 浏览器并转到 facebook 登录页面的意图。

# c++ - 错误 C2064。我已经尝试了我能想到的一切都没有成功

> ID：14467290
> 
> 赞同：0
> 
> 时间：2013-01-22T20:19:52.143
> 
> 标签：c++

错误 C2064：术语不计算为采用 1 个参数的函数

我试图检查几乎所有内容，包括 double 和 int 定义，但我不断收到此错误。我检查了有关此错误的其他问题，但我找不到任何东西。如果你们能帮助我，那就太好了。

```
// Bonus.cpp : main project file.

#include "stdafx.h"
#include <iostream>
#include <cmath>

using namespace System;
using namespace std;

double Per_Pay(double L, double r, double m, double t);
double After_Pay(double L, double r, double m, double t, double k);

int main()
{
int L,m,t,k;
double r;
cout << "Please input the values of L (the loan amount), r (the doubleerest rate per     year),\nm (the number of paymenst in a year), t (how many years the loan is for), and\nk (the amount of payments that have been made).\n\n";
cin >> L >> r >> m >> t >> k;
cout << "The amount to be payed each time is $" << Per_Pay(L,r,m,t) << " and the amount to be payed after " << k << " amount of payments is $" << After_Pay(L,r,m,t,k) << endl;
return 0;
}

double Per_Pay(int L, double r, int m, int t)
{
double R,i;
i=(r/m);
R=(L*i)/(1-(pow((1+i),(-m*t))));
return R;
}

double After_Pay(int L, double r, int m, int t, int k)
{
double R,L_prime,i;
i=(r/m);
R=(L*i)/(1-(pow((1+i),(-m*t))));
L_prime=R((1-(pow((1+i),(-m*t))))/i);
return L_prime;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:21:54.230

```
double R,L_prime,i;
//....
L_prime=R((1-(pow((1+i),(-m*t))))/i); 
```

让我们进一步修剪它：

```
double R, L_prime;
L_prime=R(whatever); 
```

问题相当明显。`R`是变量，不是函数。更有趣的是你期望这段代码做什么。

# javascript - 如何更新 RoundRectDataList（在 Dojo +1.7 中）？

> ID：14467291
> 
> 赞同：1
> 
> 时间：2013-01-22T20:19:54.357
> 
> 标签：javascript, dojo

我正在尝试来自此链接的示例[http://livedocs.dojotoolkit.org/dojox/mobile/RoundRectDataList](http://livedocs.dojotoolkit.org/dojox/mobile/RoundRectDataList)我放在这里：

```
require([
    "dojo/ready",
    "dojo/data/ItemReadStore",
    "dojox/mobile/RoundRectDataList",
    "dojox/mobile",
    "dojox/mobile/parser"
], function(ready, ItemFileReadStore, RoundRectDataList){
    ready(function(){
        var storeData = {
            "items": [
                { "label": "Wi-Fi", "icon": "images/i-icon-3.png", "rightText": "Off",  "moveTo": "bar" },
                { "label": "VPN", "icon": "images/i-icon-4.png", "rightText": "VPN",  "moveTo": "bar" }
            ]
        };
        var sampleStore = new ItemFileReadStore({data:storeData});
        var dataList = new RoundRectDataList({store:sampleStore}, "dataList");
        dataList.startup();
    });
}); 
```

和html部分：

```
<ul id="dataList"></ul> 
```

问题是我不能把它放在一个按钮上并重复相同的代码。因为得到这个错误：

```
Uncaught Error: Tried to register widget with id==dataList but that id is already registered 
```

如果我销毁或清空它不再出现的节点......我该怎么办？`<ul>`在 DOM 上销毁并创建相同的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T04:34:49.567

非常遗憾。但我刚刚找到了一种方法来做我正在尝试的事情：

```
 require([
    "dojo/on",
    "dojo/dom",
    "dojo/dom-construct",
    "dojox/mobile/parser",    // This mobile app uses declarative programming with fast mobile parser
    "dojox/mobile",           // This is a mobile app.
    "dijit/dijit",
    "dijit/registry",         
    "dojo/data/ItemFileReadStore",
    "dojox/mobile/RoundRectDataList",
    "dojo/_base/array",
    "dojo/domReady!"
  ], function(on, dom, domConstruct, parse, mobile, dijit, registry, itemFileReadStore, roundRectDataList) {
    self = this;

    populateVistoriasList = function() {
      var idx = 'vistoriasList'
      var vistoriasList = dijit.byId( idx );
      if ( vistoriasList && vistoriasList instanceof roundRectDataList )
        vistoriasList.destroyRecursive(false);

      domConstruct.destroy( idx );
      domConstruct.create('ul', {id: idx }, 'vistoriasListContainer');

      self.storeData = {
          "items": [
              { "label": "Wi-Fi", "icon": "images/i-icon-3.png", "rightText": "Off", "moveTo": "bar" },
              { "label": "VPN", "icon": "images/i-icon-4.png", "rightText": "VPN", "moveTo": "bar" }
          ]
      };
      self.sampleStore = new itemFileReadStore({data:storeData});
      self.dataList = new roundRectDataList({store:sampleStore}, idx );
      self.dataList.startup();
    } 
```

它工作得非常好......;）再一次，抱歉问和回答同样的问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T15:38:31.057

使用 RoundRectDataList.refresh 函数有一种更简单的方法可以将 ItemFileReadStore 重新加载到[RoundRectDataList中。](http://dojotoolkit.org/reference-guide/1.8/dojox/mobile/RoundRectList.html#dojox-mobile-roundrectlist)

```
 require([
"dojo/on",
"dojo/dom",
"dojo/dom-construct",
"dojox/mobile/parser",    // This mobile app uses declarative programming with fast mobile parser
"dojox/mobile",           // This is a mobile app.
"dijit/dijit",
"dijit/registry",         
"dojo/data/ItemFileReadStore",
"dojox/mobile/RoundRectDataList",
"dojo/_base/array",
"dojo/domReady!"
], function(on, dom, domConstruct, parse, mobile, dijit, registry, itemFileReadStore, roundRectDataList) {
var self = this;

populateVistoriasList = function() {
  var idx = 'vistoriasList',
      vistoriasList = dijit.byId( idx );

  self.storeData = {
      "items": [
          { "label": "Wi-Fi", "icon": "images/i-icon-3.png", "rightText": "Off", "moveTo": "bar" },
          { "label": "VPN", "icon": "images/i-icon-4.png", "rightText": "VPN", "moveTo": "bar" }
      ]
  };
  self.sampleStore = new itemFileReadStore({data:storeData});

  if ( vistoriasList && vistoriasList instanceof roundRectDataList ) {
    vistoriasList.store = self.sampleStore;
    vistoriasList.refresh(); 
  } else {
    self.dataList = new roundRectDataList({store:self.sampleStore}, idx );
    self.dataList.startup();
  }
} 
```

# asp.net-mvc - 序列化表单 GetJSON 返回空模型

> ID：14467293
> 
> 赞同：1
> 
> 时间：2013-01-22T20:19:59.083
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery, serialization, model-binding

我有一个表格，我试图通过 GetJSON 调用发送。当我到达控制器时，与视图绑定的模型是空值。当我得到一个空对象但从来没有一个空值时，我在与返回数据不一致之前遇到了问题。下面是我用来发送表格的代码

```
 var cqvdata = $("form").serialize();

  $.getJSON('@Url.Action("GetEmailByAdvanced", "CustomerEmails")', { cqv: cqvdata }, function (contacts) {
       var emails = "";
       $.each(contacts, function (index, contact) {
           $('#BCCText').tagit('createTag', contact.Email)
       });

       return false;
   }); 
```

以下是我在控制器方面的内容

```
 public JsonResult GetEmailByAdvanced(MassEmailViewModel cqv)
 {

 } 
```

如果我把我的论点变成一个字符串，这就是我得到的结果

```
"EmailFromAddressID=1&ToAddresses=&CCAddresses=bclairmont%40harr.com&BCCAddresses=adunn%40harr.com&Subject=&Body=" 
```

下面是 MassEmailViewModelClass 和所有子类

```
public class MassEmailViewModel
{
    public MassEmailViewModel()
    {
        ComplexQuery = new CustomerQueryViewModel();
    }

    public int EmailFromAddressID { get; set; }

    public CustomerQueryViewModel ComplexQuery { get; set; }

    public string ToAddresses { get; set; }
    public string CCAddresses { get; set; }
    public string BCCAddresses { get; set; }
    public string Subject { get; set; }
    [AllowHtml]
    public string Body { get; set; }

}

 public class CustomerQueryViewModel
{
    public CustomerQueryViewModel()
    {
        Products = new List<CustomerProductQueryProduct>();
        Details = new List<CustomerQueryDetail>();
    }

    public Boolean IncludeOnAll { get; set; }
    public Boolean ExcludeOnAll { get; set; }

    public List<CustomerProductQueryProduct> Products { get; set; }
    public List<CustomerQueryDetail> Details { get; set; }
}

public class CustomerProductQueryProduct
{
    public CustomerProductQueryProduct()
    {
        ProductDetails = new List<CustomerProductQueryProductDetail>();
        ProductVersions = new List<ProductVersion>();
    }

    public ProductType ProductType { get; set; }
    public Boolean Exclude { get; set; }
    public Boolean Include { get; set; }
    public int VersiondID { get; set; }

    public List<CustomerProductQueryProductDetail> ProductDetails { get; set; }
    public List<ProductVersion> ProductVersions { get; set; }
}

public class CustomerProductQueryProductDetail
{
    public ProductTypeDetail ProductDetail { get; set; }
    public Boolean Exclude { get; set; }
    public Boolean Include { get; set; }
    public string Value { get; set; }
    public string Value2 { get; set; }
}

public class CustomerQueryDetail
{
    public string Description { get; set; }
    public string Type { get; set; }
    public Boolean Exclude { get; set; }
    public Boolean Include { get; set; }
    public string Value { get; set; }
    public string Value2 { get; set; }
} 
```

唯一没有返回的是序列化中的 ComplexQuery，因为我使用的是 JQuery 对话框，因此它将这些元素从表单中取出。我想我会得到一个 MassEmaikViewModel ，它包含除了 ComplexQuery 之外的所有 vlaues 并且有一个空值，但我只是得到一个空值，因为如果参数甚至没有被初始化。

关于可能导致这种情况的任何想法？

另一件事，我不知道这是否有助于给任何人任何见解，但我可以从表单中发布并将 MassEmailViewModel 作为帖子中的参数，它可以很好地填写除 ComplexQuery 之外的所有值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:56:38.730

经过大量的试验和错误，我想通了。似乎 GetJSON 无法处理传递数据。我为正确获取信息所做的就是更改为 AJAX 获取调用。我将在下面发布代码

```
 $.ajax({
                            url: '@Url.Action("GetEmailByAdvanced", "CustomerEmails")',
                            type: 'GET',
                            data: cqvdata,
                            success: function (data) {
                                //called when successful
                                var emails = "";
                                $.each(contacts, function (index, contact) {
                                    $('#BCCText').tagit('createTag', contact.Email)
                                });

                                return false;
                            },
                            error: function (e) {
                                //called when there is an error
                                //console.log(e.message);
                            }
                        }); 
```

我使用了 GetJSON 中的确切数据。事实上，我注释掉了 GetJSON，然后把它放在它下面，然后我在控制器端填充了我的模型。

# c++ - 3d三角形上的重心坐标钳位

> ID：14467296
> 
> 赞同：3
> 
> 时间：2013-01-22T20:20:15.710
> 
> 标签：c++, math, geometry

我将计算从一个点到一个三角形的最短距离（3d）。我已将该点投影到三角形平面上，然后采用该点投影的重心坐标。但是我找不到将坐标固定在三角形内的方法。

搜索时我只找到了 0 <= [u,v,w] 和 u+v+w = 1。但是如何解决呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-06-20T13:33:18.630

我意识到这是一个老问题，但它还没有真正得到回答，而且它目前是谷歌上“钳重心坐标”的第一个热门话题。

下面，`p0`, `p1`,`p2`是三角形的顶点，`u`, `v`,`w`是点 的重心坐标`p = p0*u + p1*v + p2*w`。我假设`u+v+w = 1`.

正如 MSN 指出的那样，三角形上最近的点取决于三角形，所以任何对`u`, `v`,的操作`w`都不起作用。

如果所有`u`, `v`,`w`都是正数，则该点在三角形中，无事可做。

如果其中任何一个为负数，则该点位于相应边的错误一侧。我们需要将点移动到该边上。对于相应的重心坐标，三角形边缘上的点为零。另外两个只是点从一端到另一端的距离。

```
if ( u < 0)
{
    float t = Dot(p-p1,p2-p1)/Dot(p2-p1,p2-p1);
    t = Clamp01( t );
    return Vector3( 0.0f, 1.0f-t, t );
}
else if ( v < 0 )
{
    float t = Dot(p-p2,p0-p2)/Dot(p0-p2,p0-p2);
    t = Clamp01( t );
    return Vector3( t, 0.0f, 1.0f-t );
}
else if ( w < 0 )
{
    float t = Dot(p-p0,p1-p0)/Dot(p1-p0,p1-p0);
    t = Clamp01( t );
    return Vector3( 1.0f-t, t, 0.0f );
}
else
{
    return Vector3( u, v, w );
} 
```

`Clamp01()``t`如果它介于`0`和之间`1`，`0`如果它是负数，或者`1`如果它大于，则返回`1`。`Dot( a, b )`是两个向量`a`和的点积`b`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T23:31:19.030

如果您想找到从点到三角形的最短距离，则不能以这种方式将点夹在三角形上。距离在笛卡尔空间中，而重心坐标不在。

为了确定一个点到三角形外部的三角形的距离，您需要确定该点最接近三角形的哪个特征（线段或角），然后确定到该特征的距离。以任何不考虑转换回笛卡尔空间的方式来钳制重心坐标根本行不通。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T20:58:15.187

尝试钳位`u`和`v`到`0..1`，然后设置`w = 1 - u - v`以保持规范化约束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:51:25.280

`u`，`v`并且`w`需要夹在 之间`0..1`。就是这样。

所以例如

```
[u,v,w] = [-0.17, 0.64, 1.85] 
```

在三角形上将是

```
[u,v,w] = [0, 0.64, 1] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T23:03:52.027

万一有人想知道，我通过首先夹紧`u`和`v`而`w = 1 - u - v`不是夹紧`u`和`w`而`v = 1 - u - w`不是夹紧`v`和`w`和来解决它`u = 1 - v - w`

其他 2 个建议的解决方案给了我奇怪的输出，并且似乎正确地夹住了。

可能有更好/更快的方法，但现在这项工作。

# mysql - 获取有关选择多个表的最新行

> ID：14467298
> 
> 赞同：0
> 
> 时间：2013-01-22T20:20:22.330
> 
> 标签：mysql, sql, greatest-n-per-group

我有这个查询：

```
SELECT DISTINCT 
    enc.id, enc.cus_id, enc.createdon, enc.status, enc.segment, enc_task.orderid, 
    enc_task.taskid, enc.currentstep, enc.groupid, enc.fdprotocol, 
    enc_task.linkfile, cus.fname, cus.lname, login.first_name, login.last_name, 
    login.username, login.user_code, login.id as assigned_id, fp.protocol, 
    init.typename, table4.allowtotal 
FROM 
    mob_encounters enc 
    JOIN mob_encounters_task enc_task ON enc_task.encounterid=enc.id
    JOIN mob_customer cus ON cus.id=enc_task.cus_id
    JOIN mob_login login ON login.id=enc.createdby
    LEFT JOIN mob_protocol_type fp ON fp.id=enc.fdprotocol
    LEFT JOIN initiation_type init ON init.id=enc.groupid
    LEFT JOIN mob_table4 table4 ON table4.encid=enc.id

GROUP BY 
    enc.id 
```

`enc_task.encounterid`该查询正在运行，除了我需要它在进行此匹配时返回最新行： `enc_task.encounterid = enc.id`。是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:24:52.590

子查询可能会满足您的需求：

```
SELECT DISTINCT 
                enc.id, enc.cus_id, enc.createdon, enc.status, enc.segment, enc_task.orderid, enc_task.taskid,
                enc.currentstep, enc.groupid, enc.fdprotocol, enc_task.linkfile, cus.fname, 
                cus.lname, login.first_name, login.last_name, login.username, login.user_code,
                login.id as assigned_id, fp.protocol, init.typename, table4.allowtotal 
            FROM 
                mob_encounters enc 
            JOIN 
                (select encounterid, orderid, taskid, linkfile from mob_encounters_task order by [FIELD THAT DESIGNATES LATEST VALUE] desc) AS enc_task ON enc_task.encounterid=enc.id
            JOIN 
                mob_customer cus ON cus.id=enc_task.cus_id
            JOIN 
                mob_login login ON login.id=enc.createdby
            LEFT JOIN 
                mob_protocol_type fp ON fp.id=enc.fdprotocol
            LEFT JOIN 
                initiation_type init ON init.id=enc.groupid
            LEFT JOIN 
                mob_table4 table4 ON table4.encid=enc.id
            GROUP BY 
                enc.id 
```

# .net - 使用模块处理表单类元素是否正确？

> ID：14467301
> 
> 赞同：2
> 
> 时间：2013-01-22T20:20:32.890
> 
> 标签：.net, vb.net, winforms

我有`Private Sub Modify()`一个表单类*A*来处理按钮或标签的行为（两者都属于同*一个 A*类）。假设它这样做：

```
Private Sub Modify()
    btnFoo.Enabled = True
    lblBar.Text = "labelbar"
 End Sub 
```

如果我将我`Private Sub Modify()`的表单类 A 移动到模块 B 并命名它，`Public Sub Modify`我所要做的就是改变同一个按钮或标签的行为是这样的：

```
Public Sub Modify()
    A.btnFoo.Enabled = True
    A.lblBar.Text = "labelbar"
End Sub 
```

但是，考虑到模块是某种*静态*元素，这是否合适？我想知道正确的方式，所以我可以跟上良好的做法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:34:40.073

对于一个模块、类或其他任何东西来说，像这样深入访问另一个对象的属性几乎从来都不是一个好主意。如果不出意外，它违反[了德墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)。更一般地说，让表单之外的任何东西直接操作任何表单控件都不是一个好主意。我认为很遗憾控制是公开的，默认情况下，首先。最好将`Modify`方法留在表单上，`Public`​​如果您需要从表单外部调用它，只需创建它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:36:28.070

如果你沿着这条路走下去，你最终会得到很多模块，在很多表单中改变很多东西......如果你想用新功能扩展程序或修复错误，你会讨厌这种代码复杂性。

一个更好的规则是：在那个表单中做所有关于表单的事情。

为什么您实际上想将该代码提取到模块中？是不是因为你会在很多形式中做同样的事情？在这些情况下，提取这样的代码*可能*是有意义的，但不要让模块知道特定的形式。相反，你可以做

```
Public Sub Modify(button As Button, label As Label)
    button.Enabled True
    label.Text = "labelbar"
End Sub 
```

并以多种形式调用它

```
Private Sub ChangeElements()
    Modify(btnFoo, lblBar)
End Sub 
```

但同样，最好将这些东西留在表单中。

# java - 如果 LinkedList 为空，则从返回 int 的方法中不返回任何内容？

> ID：14467314
> 
> 赞同：3
> 
> 时间：2013-01-22T20:21:35.667
> 
> 标签：java, linked-list, return

编辑：解决。显然，返回一个 0 作品！

好吧，长话短说，我必须返回一个 int 值，但当链接列表为空时什么也没有。我该怎么做？

```
public int countDuplicates() {

int duplicates = 0;

ListNode current = front;

int num = current.data;
current = current.next;

while(current != null) {
    if(current.data == num) {
        duplicates++;
    } else {
        num = current.data;
    }
    current = current.next;
}
return duplicates;
} 
```

当我尝试这个时：

```
if(front == null) {
    return ;
} 
```

这行不通。我能做些什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:23:03.503

你宁愿扔一个[`IllegalArgumentException`](http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html)： -

```
if(front == null) {
    throw new IllegalArgumentException("List is empty");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:25:20.027

如果您的方法返回一个，`int`您必须确定一个可接受的值来表示“无”。例如，`0`如果有效结果为`>= 0`，则使用负值，例如`-1`表示“无”。

或者，修改您的方法以返回一个`Integer`对象，在这种情况下您可以返回`null`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-22T20:24:35.170

您可以定义一个固定值，例如`Integer.MIN_VALUE`表示列表为空，或者将方法的声明更改为`public Integer countDuplicates()`，并`null`在列表为空时返回。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-22T20:24:44.483

要保持现在的代码，您必须返回一个 int、抛出异常或退出。

> 1.  返回一个 int：您必须将某个 int 值指定为“失败”值，并确保在“正常”执行期间绝不会遇到此值。
>     
>     
> 2.  抛出异常：在另一个答案中详细说明-您已经将其击落。
>     
>     
> 3.  退出程序……如果这样做有意义的话。

最好的选择可能是更改代码 - 例如，使函数返回一个整数，因此该`null`选项就在那里。当然还有其他方法可以解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-22T20:25:56.923

如果您不想（或不能）抛出异常，请返回一些“异常值”，例如负数。例如，Java 有很多`indexOf(Object somethingToLookFor)`方法，如果找不到该项目，则返回 -1。

在您的示例中， -1 非常有效，因为永远不会有 -1 重复项。

就个人而言，我只会为空列表返回 0。一个空列表有 0 个重复项。但是，如果规范坚持某些特殊的东西，则返回 -1。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-22T20:27:02.953

您可以像这样将返回值从 int 更改为 object

```
public Object countDuplicates() {
    if(////condition)
        return ///int;
    else 
        return null; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-22T20:29:43.850

您可以返回负值或将返回类型更改为字符串并将结果解析为 int。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-07-23T07:14:01.143

```
public boolean isEmpty(){
    if (head == null) return true;
    else return false ;
} 
```

# mongodb - 在 mongo 中进行 upsert，我可以为“插入”案例指定自定义查询吗？

> ID：14467317
> 
> 赞同：0
> 
> 时间：2013-01-22T20:21:43.970
> 
> 标签：mongodb, mongoose, upsert

> **可能重复：**
> [Mongodb upsert 仅更新选定字段，但插入所有](https://stackoverflow.com/questions/14069897/mongodb-upsert-only-update-selected-fields-but-insert-all)

说我有这个：

```
db.Person.update({ name: "Ignacio" }, { $inc: { age: 1 } }, { upsert: true }); 
```

它将加载人“Ignacio”并增加他的年龄。

我需要的是...如果找不到此人，则在插入时添加字段

```
{ phone: "12345" } 
```

如果此人已经存在，则不会对“电话”进行任何处理。

我在 mongo 文档中找不到如何实现这一点。我是否被迫首先查找对象，然后手动插入或更新？

# ajax - ajax调用链接到新页面不返回新页面

> ID：14467318
> 
> 赞同：0
> 
> 时间：2013-01-22T20:21:48.793
> 
> 标签：ajax, grails

我有这个 ajax 代码：

```
$.ajax({
       type: "POST",
       url: "${createLink(controller:'MyController', action:'downloadFile') } target=\"_blank\" ",
       data: {'names':JSON.stringify(names)},
       dataType: 'json'
}); 
```

调用此控制器方法，该方法有效

```
def downloadFile =
{
    List<JSON> Mynames = JSON.parse(params.names)
    Mynames.each{println "MY ID is: $it"}

    [Mynames:Mynames]
} 
```

它会打印出 MY ID Is Lines，但不会呈现如下所示的 downloadFile 视图：

```
<%@ page contentType="text/html;charset=UTF-8" %>
<html>
   <head>
    <title></title>
   </head>
   <body>
    test
   </body>
</html> 
```

但是，它没有渲染它。我怎样才能解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T02:23:56.307

请花一些时间阅读 Ajax 及其用途和工作原理。你有一个根本性的误解。

```
$.ajax({
       type: "POST",
       url: "${createLink(controller:'MyController', action:'downloadFile') } target=\"_blank\" ",
       data: {'names':JSON.stringify(names)},
       dataType: 'json'
}); 
```

上面的代码向您的控制器提交请求。这是关键点；**它不会刷新您的页面或在您的页面上放置任何数据。它仅在 JavaScript 中向您返回数据。**

您的控制器甚至没有根据您的 $.ajax() 函数`dataType`参数返回正确的响应。该`dataType`属性告诉 $.ajax() 函数期望什么样的数据作为响应。

[jQuery $.ajax() 文档](http://api.jquery.com/jQuery.ajax/)

如果您需要呈现 HTML 作为对 ajax 请求的响应，最简单的方法是使用[$.load()](http://api.jquery.com/load/)函数。

还有一些其他的方法，但为了让你保持简单，我不会在这里讨论它们。说真的，不要试图变得粗鲁，但我已经阅读了你的其他一些问题。您确实需要更好地了解您正在使用的工具。

# c - 如何将文件中的数据加载到C中的float *

> ID：14467319
> 
> 赞同：0
> 
> 时间：2013-01-22T20:21:49.220
> 
> 标签：c, file, pointers, file-io

我有一个 ASCII 文件，其中存储了向量的条目。我不知道文件的长度（行数），也无法估计它的大小，因为它可能从几行到几万行不等。我需要一种有效的方法来读取存储在该文件中的数据并将它们加载到 float* 变量中。代码应该在 C 中。

我的问题是如何为我需要创建的向量分配内存，因为我事先不知道它的大小？你能举个例子吗？

最后，您认为最适合此类功能的原型是什么？它应该是这样的：

```
load_data(const char* filename, float* data, int* vector_size); 
```

?

**更新 1.：**在进行一些初始测试时，我编写了以下代码：

```
void create_random_matrix(float* matrix, const int nrows) {
    matrix = (float *) malloc(sizeof (float) * nrows);
    short i;
    for (i = 0; i < nrows; i++) {
        matrix[i] = 7.0f;
    }
} 
```

它应该返回一个所有元素都等于 7.0f 的数组。相反，当我从 main.c 调用它时：

```
float *a;
create_random_matrix(a, 10);    
printf("%f",a[0]); 
```

它打印**0.0f**。这怎么可能？！

**更新 2。**如果不是您的帮助，就不会编写以下（工作）代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/types.h>

#define LINE_SIZE 10
#define ALLOCATION_CHUNK 50

int load_vector_data(const char* filename, float** vector, int* length) {
    *vector = malloc(sizeof (float) * ALLOCATION_CHUNK);
    int allocated_rows = ALLOCATION_CHUNK;
    u_short i = 0;
    FILE* fr = fopen(filename, "r");
    if (fr == NULL) {
        exit(FILE_NOT_FOUND);
    }
    char line[LINE_SIZE];
    while (fgets(line, LINE_SIZE, fr) != NULL) {
        if (i >= allocated_rows){           
            allocated_rows += ALLOCATION_CHUNK;
            *vector = realloc(*vector, sizeof (float) * allocated_rows);
        }
        strip_newline(&line, LINE_SIZE);
        (*vector)[i] = strtod(line, (char **) NULL);
        i++;
    }
    *length = i;
    *vector = realloc(*vector, sizeof (float) * i);
    fclose(fr);
}

void strip_newline(char *str, int size) {
    u_short i;
    for (i = 0; i < size; ++i) {
        if (str[i] == '\n') {
            str[i] = '\0';
            return;
        }
    }
} 
```

我用一个 8000 行的文件试了一下，似乎工作得很好！请随意发表评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:31:33.943

[fgets](http://pubs.opengroup.org/onlinepubs/007904875/functions/fgets.html)是您从文件中读取数据的朋友（如果我假设每一位数据都在换行符上是正确的）。逐一阅读每一行，并在您阅读的文本上使用[strtof 。](http://pubs.opengroup.org/onlinepubs/007904975/functions/strtod.html)阅读文本并转换为浮点数本质上是一个缓慢的过程，所以我认为上面的内容已经足够好了。

至于你的第二个问题，有几种方法可以做到。您可以传入一个 float** 并在函数内创建 malloc。尽管这有一个缺点，即您需要在函数之外释放它，这并不十分明显。我能想到的唯一另一种方法是扫描文件并计算换行数，然后为此预先分配数组长度。

很难说做一个 malloc 和一堆 realloc 是否比扫描来计算行数更有效，可能值得尝试这两种方法（都不是特别难），看看哪种方法对你来说更快.

# c++ - Why does gcc optimise away this C++11 foreach loop using my custom iterator?

> ID：14467324
> 
> 赞同：11
> 
> 时间：2013-01-22T20:21:59.677
> 
> 标签：c++, c++11, foreach, iterator

I was trying to write some code for doing functional-style creation of sequences. I wrote one function, `range(a, b)`, which returns an object that you can iterate over, foreach-style, to go through the numbers a, a + 1, ..., b - 1\. Then I wrote another function, `map(f, t)`, which returns another iterable object where each element in the sequence is the result of calling `f` with the corresponding element of the iterable object `t`.

This works as expected if I compile using `-O1` or lower; with `-O2` or higher, my foreach loop (in `main` at the bottom) gets completely optimised away and nothing is printed. Why does this happen, what have I done wrong? Here's my code:

```
template<typename T>
struct _range {
    T a;
    T b;

    _range(T a, T b):
        a(a),
        b(b)
    {
    }

    struct iterator {
        T it;

        iterator(T it):
            it(it)
        {
        }

        bool operator!=(const iterator &other) const
        {
            return it != other.it;
        }

        void operator++()
        {
            ++it;
        }

        T operator*() const
        {
            return it;
        }
    };

    iterator begin() const
    {
        return iterator(a);
    }

    iterator end() const
    {
        return iterator(b);
    }
};

template<typename T>
_range<T> range(const T a, const T b)
{
    return _range<T>(a, b);
}

template<typename F, typename T>
struct _map {
    const F &f;
    const T &t;

    _map(const F &f, const T &t):
        f(f),
        t(t)
    {
    }

    struct iterator {
        const F &f;
        typename T::iterator it;

        iterator(const F &f, typename T::iterator it):
            f(f),
            it(it)
        {
        }

        bool operator!=(const iterator &other) const
        {
            return it != other.it;
        }

        void operator++()
        {
            ++it;
        }

        int operator*() const
        {
            return f(*it);
        }
    };

    iterator begin() const
    {
        return iterator(f, t.begin());
    }

    iterator end() const
    {
        return iterator(f, t.end());
    }
};

template<typename F, typename T>
_map<F, T> map(const F &f, const T &t)
{
    return _map<F, T>(f, t);
}

#include <algorithm>
#include <cstdio>

int main(int argc, char *argv[])
{
    for (int i: map([] (int x) { return 3 * x; }, range(-4, 5)))
        printf("%d\n", i);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T22:25:34.780

[Summarizing the existing comments:]

`range(-4, 5)` creates a temporary, and (in most cases) temporaries only live until the end of the full-expression in which they are created. So in your case, the returned `_range` object is valid during the construction of the `_map`, but as soon as said `_map` is returned from `map`, the full-expression ends and the `_range` object is destroyed.

That said, because `_map` holds the arguments passed to its constructor by const ref rather than by value, this means that by the time the range-based `for` begins executing, your `_map::t` is already a dangling reference – classic [undefined behavior](http://en.wikipedia.org/wiki/Undefined_behavior).

To fix this, simply have `_map` store its data members by value.

# java - Maven：将多个模块 jar 组合成一个战争文件？

> ID：14467325
> 
> 赞同：15
> 
> 时间：2013-01-22T20:22:01.053
> 
> 标签：java, maven

我有一个`babybird`包含 3 个组件的项目`persistence`，`business`并且`service`

在`babybird`我`pom.xml`有以下

```
 <modules>
        <module>persistence</module>
        <module>business</module>
        <module>service</module>
    </modules> 
```

当我跑的时候`mvn clean install`，我看到

```
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO] 
[INFO] babybird  ......................................... SUCCESS [2.801s]
[INFO] persistence ....................................... SUCCESS [3.321s]
[INFO] business .......................................... SUCCESS [0.832s]
[INFO] service ........................................... SUCCESS [0.694s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 8.168s
[INFO] Finished at: Tue Jan 22 12:09:48 PST 2013
[INFO] Final Memory: 18M/50M
[INFO] ------------------------------------------------------------------------ 
```

这些模块中的每一个都会生成一个 jar 文件。

**问题**：如何将它们合二为一`babybird.war`？
我是 Maven 新手，不知道要寻找什么来完成这项任务，请提供指点

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-22T20:26:54.463

这很简单。创建另一个名为`web`或类似的模块：

```
<modules>
    <module>persistence</module>
    <module>business</module>
    <module>service</module>
    <module>web</module>
</modules> 
```

`web`模块应该依赖于所有其他：

```
<dependencies>
    <dependency>
        <groupId>...</groupId>
        <artifactId>persistence</artifactId>
    </dependency>
    ...
</dependencies> 
```

并有`war`包装：

```
<packaging>war</packaging> 
```

您还需要`web.xml`在`/src/main/webapp/WEB-INF`. 就是这样。

# msbuild - 如何评估 MS 构建变量？

> ID：14467326
> 
> 赞同：0
> 
> 时间：2013-01-22T20:22:02.957
> 
> 标签：msbuild

例如，如果我想输出

```
 $(SolutionRoot) 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:31:07.237

In a Target, use Task 'Message'

```
 <Target Name="PrintCurrentSettings">
    <Message Text="   $SolutionRoot     : $(SolutionRoot)"/>
  </Target> 
```

# c# - 如何使用三元运算符来增加一个值

> ID：14467328
> 
> 赞同：0
> 
> 时间：2013-01-22T20:22:13.440
> 
> 标签：c#, ternary-operator

我希望有人能指出我哪里出错了？我没有太多使用三元运算符的经验，但我觉得这里有充分的理由使用它，因为它减少了代码长度。

但是，我收到上述错误。谁能看到我哪里出错了？

```
Colour.R <= 255 ? Colour.R+=10 : Colour.R+=11; 
```

编译器返回

```
只有赋值、调用、递增、递减和新对象表达式可以用作语句

```

其中 Color 表示颜色向量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T20:23:20.853

编译器会准确地告诉您出了什么问题——您不能单独使用条件表达式作为语句。这只是一种表达。

幸运的是，在这种情况下，您不需要这样做。你可以写：

```
Colour.R += Colour.R <= 255 ? 10 : 11; 
```

这也有更清晰的好处:)

（我怀疑你的数字在这里不正确，但那是另一回事。）

# apache-flex - BlazeDS 因大量对象而变慢

> ID：14467340
> 
> 赞同：0
> 
> 时间：2013-01-22T20:23:10.197
> 
> 标签：apache-flex, air, blazeds, amf

我正在使用 Flex 开发移动应用程序，但在使用 BlazeDS 时遇到了一些问题。一些用户从我的服务器请求（相对）相当大量的数据，大约 2 秒后返回。数据由一些非常简单的对象组成（客户端，具有姓名/电话/电子邮件，以及一些其他属性，其中一些是具有更多属性的其他嵌套对象）。最大的请求包含不超过 10,000 个这样的对象，大小只有几 MB。我遇到的问题是，一旦服务器发送响应，移动屏幕就会在处理数据时锁定。对于 10,000 个对象，这可能需要几分钟时间，有时甚至会导致设备崩溃，并且充其量只能让用户一直处于冻结状态。对于一般用户来说，至少是2-5秒的卡屏。这不仅是功能有限的设备的问题。这也发生在我的 PC 上（i5 处理器，8GB RAM）。据我所知，这种停机时间发生在设备收到响应和我可以访问数据之间的某个时间。在以下 RemoteObject 结果处理程序的第一行设置断点会在到达断点之前锁定屏幕：

```
protected function myResultHandler(event:ResultEvent):void
{
    var result:ArrayCollection = event.result as ArrayCollection;
    //Do other stuff here
} 
```

我对 BlazeDS 和 AMF 知之甚少，所以我唯一的猜测是在设备上创建对象时会发生冻结。有什么办法可以加快这个过程吗？我通常应该期望看到像这样非常糟糕的表现吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:25:56.243

经过几个小时的挖掘，我找到了解决问题的方法：在服务器端，我发送的对象有大量与我在移动应用程序上需要的信息无关的属性。此外，表单中的这些类上还有一些帮助方法，`getMyHelper()`它们会尝试在 Flex 端生成属性。这导致在下载过程中抛出大量引用错误，因为 AS 对象中不存在具有这些名称的属性。我创建了我需要发送的对象的精简版，没有额外的属性或方法。现在，在收到服务器的响应后，海量列表几乎会立即显示。

# sql - 计算数据库上频繁更改的值

> ID：14467343
> 
> 赞同：1
> 
> 时间：2013-01-22T20:23:15.060
> 
> 标签：sql

我正在建立一个用于教育目的的社交网站，并且想知道我应该如何有效地计算用户的“推文”（例如，在推文表上他有 100k 个条目）。我应该通过 SQL Count() 来完成，还是应该为每个用户添加一个“推文数量”字段以便在用户添加/删除推文时轻松获取并更新它？或者，如果对此有更好的方法，我将非常感谢您的意见。

计算总数的情况如何。这些“推文”的字符？SUM(CHAR_LENGTH(arg)) 有效吗？或者更好地缓存更新的值？

假设这些值（推文数和所有推文的字符数）总是被调用，因为它们公开显示在他们的个人资料中，**平均而言**，这些数字每秒被调用一次，它们的值每 30 次更改一次秒。

我只是在试验涉及大数据的算法，如果你能提供帮助，非常感谢！

另一件事，PHP 和 MariaDB 是否适合这种流程？还是其他堆栈更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T11:54:57.107

首先使用计数查询。考虑到数据量（100K）条目，它很可能足够有效。它也将少得多的工作和维护。就数据库大小而言，100K 是一个非常小的数字。当你达到数百万或数十亿或更多的 100 时，事情就会变得有点有趣。

数据库性能的主要考虑因素是数据库，是的 MariaDB 或 MySql 都可以。您对编程语言使用什么是一个更大的问题。php 可以正常工作。

# c# - 在 String.Format() 中显式转换 int 的原因是什么

> ID：14467349
> 
> 赞同：3
> 
> 时间：2013-01-22T20:23:58.060
> 
> 标签：c#

在我遇到的大多数代码中，他们在使用 String.Format() 时显式地将 int 或其他数字转换为字符串，尽管据我所知，这不是必需的。我是否缺少某些东西，需要在将数字用作字符串之前将其显式转换为字符串？

**显式：**

```
int i = 13;
string example = String.Format("If a Friday lands on the {0}th of the month, it is generally considered to be an unlucky day!",
                               i.ToString()); 
```

产生`example`如下：`"If a Friday lands on the 13th of the month, it is generally considered to be an unlucky day!"`

**非显式：**

```
int i = 13;
string example = String.Format("If a Friday lands on the {0}th of the month, it is generally considered to be an unlucky day!",
                                i); 
```

产生`example`为：（`"If a Friday lands on the 13th of the month, it is generally considered to be an unlucky day!"`与显式转换相同）。那么为什么我看到的大多数程序员都这样做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T20:25:59.530

如果您使用隐式转换，则将`int`首先装箱`object`。这对性能造成的影响*很小*，但有些人似乎认为这很重要，并且可以解释代码。

事实上，Jeffrey Richter 在他通过 C# 编写的出色的 CLR 中写到了这一点（鼓励使用这种东西）。这让我很恼火，以至于我[在博客上写了它](http://msmvps.com/blogs/jon_skeet/archive/2008/10/08/why-boxing-doesn-t-keep-me-awake-at-nights.aspx):)

当然，在*某些*地方，拳击可能是相关的——但鉴于`string.Format`需要遍历格式字符串并做各种其他事情，我不认为它在这里很重要......那是在你考虑你是什么之前接下来将处理字符串:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:24:46.113

我真的没有理由这样做。`String.Format()`正如您所指出的那样，既然已经这样做了，那么如果您只是`String.Format()`照顾它，它就会更紧凑并且 IMO 更容易阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T20:29:40.437

因为我们习惯了规则，你最好也习惯。`String.Format()`是一个聪明的方法，不是每个方法。请记住，它`String.Format()`需要对象，因此您不需要转换，但是如果您这样做，您仍然会发送一个对象。

# php - 非常大的数字使 bcpowmod 溢出

> ID：14467351
> 
> 赞同：1
> 
> 时间：2013-01-22T20:24:02.020
> 
> 标签：php

我需要在 PHP 中将 8 提高到 17 的幂。我在我的电脑计算器上检查了这个是 2251799813685248，但是`pow()`和`bcpowmod()`函数似乎都溢出了；`pow()`进入科学记数法，并与 的结果相呼应`bcpowmod()`，即使第三个参数很高，也会给我一个空白屏幕。还有其他方法可以执行此计算吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:29:09.050

你可以试试[`gmp_pow`](http://php.net/gmp_pow)

```
gmp_pow("8", 17); 
```

有[`h2ooooooo`](https://stackoverflow.com/users/247893/h2ooooooo)建议 - 获得结果使用：

```
gmp_strval(gmp_pow("8", 17)); 
```

也[`bcpow`](http://php.net/bcpow)适合我

```
bcpow("8", "17") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:40:55.627

使用`pow()`. 你说的“科学记数法”只是一个记数法，以后可以格式化。

```
echo number_format(pow(8,17), 0, '', ''); 
```

[http://php.net/number-format](http://php.net/number-format)

除此之外，我无法重现给定值的“科学符号”行为

[http://codepad.viper-7.com/AwM3CS](http://codepad.viper-7.com/AwM3CS)（使用更大的值来执行科学记数法）

# c++ - 关于在 C++ 中比较两个与指针相关的整数值的意外结果

> ID：14467352
> 
> 赞同：1
> 
> 时间：2013-01-22T20:24:04.613
> 
> 标签：c++, pointers

我有一个包含三个元素 {1、2、3} 的 BST。它的结构看起来像

```
 2
 / \
1   3 
```

现在我尝试使用下面定义的 BS​​THeight() 计算每个节点的高度，并且在计算“2”的高度时遇到了一些问题，该值应该为 1，因为“1”和“3”的高度被定义为0\. 我的问题是，**直接使用'2 的两个孩子的高度（见下面突出显示的第 2 部分），它的高度总是 0**。但是，如果我使用两个临时整数变量，它的值是正确的（参见下面突出显示的第 1 部分）。在功能方面，我看不出这两种方法有什么区别。谁能帮忙解释一下为什么？

```
void BSTHeight(bst_node *p_node)
{
    if (!p_node) 
        return;

    if (!p_node->p_lchild && !p_node->p_rchild) {
        p_node->height = 0;
    } else if (p_node->p_lchild && p_node->p_rchild) {
        BSTHeight(p_node->p_lchild);
        BSTHeight(p_node->p_rchild);
#if 0   // part 1
        int lchild_height = p_node->p_lchild->height;
        int rchild_height = p_node->p_rchild->height;
        p_node->height = 1 + ((lchild_height > rchild_height) ? lchild_height : rchild_height);
#else   // part 2
        p_node->height = 1 + ((p_node->p_lchild->height) > (p_node->p_rchild->height)) ? (p_node->p_lchild->height) : (p_node->p_rchild->height);
#endif
    } else if (!p_node->p_lchild) {
        BSTHeight(p_node->p_rchild);
        p_node->height = 1 + p_node->p_rchild->height;
    } else {
        BSTHeight(p_node->p_lchild);
        p_node->height = 1 + p_node->p_lchild->height;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:29:23.743

问题在于运算符优先级。加法的绑定比三元运算符强，因此您必须用括号将三元运算符 (?:) 括起来。

下面是修正版。请注意，您使用的所有括号都是多余的，我已将其删除。我添加了唯一需要的对：

```
1 + (p_node->p_lchild->height > p_node->p_rchild->height ?
     p_node->p_lchild->height : p_node->p_rchild->height); 
```

更好的是使用`std::max`(from `<algorithm>`) 代替：

```
1 + std::max(p_node->p_lchild->height, p_node->p_rchild->height) 
```

# java - Java Swing 对象静态初始化的首选习惯用法？

> ID：14467353
> 
> 赞同：1
> 
> 时间：2013-01-22T20:24:20.307
> 
> 标签：java, swing, concurrency, initialization, constants

我想要一个应用程序来创建一组固定的 Swing 对象，例如在定义明确的/中央/应用程序范围的位置中的实例`Font`和，例如和。`Color``GuiFonts.java``GuiColors.java`

这样，我的应用程序可以引用类似的内容：`GuiFonts.SMALL_FONT`和例如。`GuiColors.BACKGROUND``#FFEF88``#AAAAFFF`

那么，我应该如何编写这些默认值呢？特别是，我应该如何编写它们以确保它们在 Swing Event Dispatch Thread (EDT) 可见性方面被正确初始化？

我相信在 EDT 上创建和引用 Swing GUI 对象是正确的，并且只在 EDT 上 - 是吗？

那么，这样的事情就足够了吗，还是因为代码将在类加载器线程而不是 EDT 上运行而在某种程度上不够？或者只要引用在非 EDT 线程上运行就足够了`static final`？

```
import java.awt.Font;

public class GuiFonts {
    // not running on EDT, but is it correct anyhow?
    public static final Font = new Font(Font.SANS_SERIF, Font.PLAIN, 16);
} 
```

或者，我是否应该确保在 EDT 上创建对象，可能像这样：

```
import java.awt.*;
import java.util.concurrent.*;
import javax.swing.*;

public class GuiFonts {
    // intended to run on EDT, but is EDT running yet? In all cases?
    public static final Font MEDIUM_FONT = new Callable<Font>() {
        @Override
        public Font call() {
            final RunnableFuture<Font> future = new FutureTask<Font>(new Callable<Font>() {
                    @Override
                    public Font call() {
                        return new Font(Font.SANS_SERIF, Font.PLAIN, 16);
                    }
                });
            try {
                SwingUtilities.invokeAndWait(future); // Could be invokeLater() because of the Future...
                return future.get();
            } catch (final Exception e) {
                throw new RuntimeException(e);
            }
        }
    }.call();
} 
```

当然，这很冗长，但其中很多可以打包到一个接受 a`Callable`并将其提交给 EDT 的例程中：

```
 public static final Font MEDIUM_FONT = runOnEDT(new Callable<Font>() {
            @Override
            public Font call() {
                return new Font(Font.SANS_SERIF, Font.PLAIN, 16);
            }
        }); 
```

除了 Swing EDT 发布问题之外，如果常量在多个文件中相互引用，这种方法还有一个容易出错的初始化排序方面：未使用 be 初始化的常量`null`。

请注意，这样的例程`runOnEDT`应该捕获并记录所有异常，特别是，日志记录应该发生在`catch`子句中而 **不是**在某些子句中，`UncaughtExceptionHandler`因为`UncaughtExceptionHandler`通常已经安装在 EDT 上。

或者，最好`static`一起放弃初始化。支持一些延迟加载方案，其中对象由`enum`常量表示，并且某些访问器在第一次引用时在 Swing EDT 上创建 GUI 对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:38:31.517

字体和颜色是 AWT 的一部分，而不是 Swing。

话虽如此，我已经完成了您用字体概述的内容。

```
public class GuiFonts {
    // not running on EDT, but is it correct anyhow?
    public static final Font = new Font(Font.SANS_SERIF, Font.PLAIN, 16);
} 
```

只要您在 EDT 上使用此变量，就可以了。您正在 EDT 上执行方法代码。

您可以将字体代码放入方法中。

```
public static Font getNormalFont() {
    return new Font(Font.SANS_SERIF, Font.PLAIN, 12);
} 
```

这样，当从 EDT 调用时，您可以确定代码正在 EDT 上执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:51:49.930

Swing 已经为这些东西提供了一个“定义明确的/中央/应用程序范围的位置”：[UIManager](http://docs.oracle.com/javase/7/docs/api/javax/swing/UIManager.html)。

使用它的好处是字体、颜色等将由 Swing 自动设置，您不必设置它们。

另请参阅：[设置 Swing 程序的默认字体](https://stackoverflow.com/questions/7434845/setting-the-default-font-of-swing-program-in-java)

编辑：如果您需要创建 Swing 组件，它们肯定**必须**在 EDT 上创建。请注意，一些较旧的文档说，如果它们尚未“实现”，那么在其他线程上创建组件是安全的，但这是过时的建议。

# apache - 如何使用 htaccess 重写 url 并保持相关链接正常工作

> ID：14467361
> 
> 赞同：2
> 
> 时间：2013-01-22T20:24:46.510
> 
> 标签：apache, .htaccess, url, mod-rewrite

我正在使用以下 .htaccess 规则：

```
RewriteRule ^!([a-zA-Z0-9_-]+)$ index.php?p=$1
RewriteRule ^!([a-zA-Z0-9_-]+)/$ index.php?p=$1
RewriteRule ^!([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)$ index.php?p=$1&s=$2
RewriteRule ^!([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/$ index.php?p=$1&s=$2 
```

为了从这里重写 url：*/index.php?p=SOMETHING&s=SOMETHING*

对此：*/某事/某事*

问题是 - 我对几乎所有东西都使用相对 url - css 样式、脚本、图像等。当前的 htaccess 规则破坏了 url，因为它们试图从真实路径访问文件。

所以我想知道是否有任何方法可以仍然使用这些规则并保持相关链接同时工作。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:42:36.803

您需要在页面标题中包含 URI 基础。您可以在页面标题中添加类似这样的内容（在`<head> </head>`标签之间：

```
<base href="/"> 
```

要么，要么您可以将所有链接更改为绝对链接。

# java - Scrollview XML 布局问题

> ID：14467362
> 
> 赞同：1
> 
> 时间：2013-01-22T20:24:48.310
> 
> 标签：java, android, xml

希望这是一个简单的。

我有一个使用滚动视图的布局。这很好，直到我想在它上面放一个图像和文本视图，然后在它下面放一个带有我的编辑文本的滚动视图。

目前我收到以下错误：

```
01-22 20:13:32.228: E/AndroidRuntime(275): FATAL EXCEPTION: main
01-22 20:13:32.228: E/AndroidRuntime(275): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.flybase2/com.example.flybase2.addAppointment}: java.lang.RuntimeException: Binary XML file line #26: You must supply a layout_width attribute. 
```

我试图更改滚动视图宽度属性（我相信错误也指向）但没有运气。

这是我的 XML。谁能看到我做错了什么？：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="84dp"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imgLink"
        android:layout_width="78dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:src="@drawable/viewcon" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="75dp"
        android:gravity="center"
        android:text="Appointments"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="35sp" />
</LinearLayout>

\\ERROR: On width attribute
<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Name:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<EditText
    android:id="@+id/inputAppName"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Type:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<Spinner
    android:id="@+id/spinner1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Time:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TimePicker
    android:id="@+id/timePicker1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Time:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<DatePicker
    android:id="@+id/datePicker1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Comments:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<EditText
    android:id="@+id/inputAppCom"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Set Appointment Date Alarm:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<ToggleButton
    android:id="@+id/toggleButton1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="ToggleButton"
    android:textOff="Alarm Off"
    android:textOn="Alarm On" />

<TextView
    android:id="@+id/textView7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Add Appointment"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<Button
    android:id="@+id/btnAddAppointment"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Add" />

</ScrollView>
</LinearLayout> 
```

编辑：

![在此处输入图像描述](../Images/6f7d1ae98d200a4bd8967b7419cd82ac.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:31:24.803

您只能将一个子布局设置为 ScrollView。我不知道为什么它显示你没有设置`android:layout_width`属性，但你的问题肯定是你的 ScrollView 中有多个子视图。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:orientation="vertical" >
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="84dp"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imgLink"
        android:layout_width="78dp"
        android:layout_height="wrap_content"
        android:layout_gravity="center_vertical"
        android:src="@drawable/viewcon" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="75dp"
        android:gravity="center"
        android:text="Appointments"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:textSize="35sp" />
</LinearLayout>

<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Name:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<EditText
    android:id="@+id/inputAppName"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Type:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<Spinner
    android:id="@+id/spinner1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Time:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TimePicker
    android:id="@+id/timePicker1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Appointment Time:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<DatePicker
    android:id="@+id/datePicker1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Comments:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<EditText
    android:id="@+id/inputAppCom"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" />

<TextView
    android:id="@+id/textView6"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Set Appointment Date Alarm:"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<ToggleButton
    android:id="@+id/toggleButton1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="ToggleButton"
    android:textOff="Alarm Off"
    android:textOn="Alarm On" />

<TextView
    android:id="@+id/textView7"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Add Appointment"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<Button
    android:id="@+id/btnAddAppointment"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Add" />

 </LinearLayout>
 </ScrollView>
 </LinearLayout> 
```

# c# - 我应该如何解决 WinRT JS 说 null 是“null”？

> ID：14467365
> 
> 赞同：2
> 
> 时间：2013-01-22T20:24:57.313
> 
> 标签：c#, javascript, null, windows-runtime, projection

因此，我最近与 Javascript 和 WinRT 面对面交流。基本上，我正在开发一个 WinRT API，所以它应该可以很好地与 Javascript、C++ 和 C# 配合使用。如果传入的值为空，我在 API 中有一个属性可以执行特殊操作。因此，例如：

```
public string Foo
{
  get
  {
    return foobar.ToString();
  }
  set
  {
    if(string.IsNullOrEmpty(value))
    {
      foobar=SomeSpecialValue;
      return;
    }
    ParseIntoFoobar(value);
  }
} 
```

对我来说，这似乎是一个非常好的财产。但是，当您在 Javascript 中使用类似这样的内容时：

```
myFoobar.foo=null; 
```

结果是从`ParseIntoFoobar`为什么抛出解析异常？因为显然 Javascript 中的 null 值`"null"`就像在**包含单词 null` 的字符串中一样**

从我看到的文档来看，这应该导致 C# 转换为 null，或者它应该导致一个空字符串，而不是这个愚蠢的结果。事实上，你可以做出一些对我来说毫无意义的非常不直观的行为。投影：

```
public string Biz{get;set;} 
```

Javascript：

```
myObject.biz=null;
log(myObject.biz==null); //results in false 
```

解决此“功能”的最佳方法是什么？`"null"`对于我想要检测空值但字符串并非完全无效的情况，我应该怎么做？（想想用户名或类似的东西）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:33:53.583

您可以只使用将被普遍接受的空字符串 "" (string.Empty)。

我关于为什么 null 不可接受的“猜测”可能是因为某些类型映射技巧正在发生以使所有内容兼容。C++ 可能会做一些奇怪的事情，比如将空引用转换为 '\0'（空字符），这将是一个空字符串。

# jquery - 带有 2 个按钮的 jQuery 表单插件

> ID：14467367
> 
> 赞同：0
> 
> 时间：2013-01-22T20:25:00.843
> 
> 标签：jquery, forms, plugins

我正在使用 jQuery 表单插件
[http://malsup.com/jquery/form/](http://malsup.com/jquery/form/)

```
<form id="form1" name="form1" method="post" action="" enctype="multipart/form-data">
<input name="submit" id="submit1" type="submit" class="submit_button" value="Save" />
<input name="submit2" id="submit2" type="submit" class="submit_button" value="Send Sale" />
</form> 
```

好的，所以有两个按钮，一个是通过 ajax 表单发送邮件，另一个是将数据保存到表中。这是我使用的 Jquery。

```
$(document).ready(function() { 
// bind form using ajaxForm 
$('#submit2').click(function() {
    alert('ffff');
    $('#form1').ajaxForm({ 
        // target identifies the element(s) to update with the server response 
        target: '.loading',
        beforeSubmit:  showImg,
        success: showResponse,
        url:       'send_sale.php',
    });
});
}); 
```

当我单击“保存”按钮时，它工作正常，但是当我先单击“发送销售”然后单击“保存”按钮时，“保存”按钮执行与发送销售相同的过程。

有谁知道怎么了？

**UPDATE**
得到了使用 ajaxSubmit 而不是 ajaxForm 的解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:58:09.423

只需作为表单标签内的提交按钮，两个按钮都在提交表单。您可能想要尝试的是将输入提交转换为按钮并将它们移到表单之外。

```
<form id="form1" name="form1" method="post" action="" enctype="multipart/form-data">
</form>
<button id="submit1" class="submit_button">Save</button>
<button id="submit2" class="submit_button">Send Sale</button> 
```

然后分别定义您的点击处理程序。

```
$(document).ready(function () {
    $('#submit1').click(function () {
    alert("action 1")
    $('#form1').ajaxForm({
        target: '.loading',
        beforeSubmit: showImg,
        success: showResponse,
        url: 'send_sale.php',
    });
    });
    $('#submit2').click(function () {
    alert("action 2")
    });
}); 
```

# ruby-on-rails-3 - 机架谷歌分析

> ID：14467369
> 
> 赞同：0
> 
> 时间：2013-01-22T20:25:12.947
> 
> 标签：ruby-on-rails-3, rack

我在我的 rails 项目中使用 gem rack-google-analytics，但是当我在生产模式下运行它时出现错误。

rack-google-analytics-0.11.0/lib/rack/google-analytics.rb:11:in `initialize': 必须设置跟踪器！（参数错误）

我试图找出这意味着什么。初始化'：必须设置跟踪器！

在我的 application.rb 文件中，我在它的底部有这个。

```
if Rails.env == "production"
    config.middleware.use("Rack::GoogleAnalytics", :web_property_id => "UA-18760745-1")
    end 
```

如果 O 把它拿出来，错误就会消失，所以它与初始化这个行为有关，但不太清楚为什么。

任何人都遇到了这个问题并有解决方案，他们可以分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:52:12.197

我能找到的唯一答案是不要使用那个 Gem 而是使用这个 Gem，因为它开箱即用。也许其他人可以证明我错了，我希望。

希望这个其他链接可以帮助其他人。

[https://github.com/bgarret/google-analytics-rails#readme](https://github.com/bgarret/google-analytics-rails#readme)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T17:26:05.863

不知道它是否有帮助，但这是我的代码：

```
config.middleware.use Rack::GoogleAnalytics, :tracker => 'UA-XXXXXXXX-1' 
```

在应用程序.rb

我假设它在初始化时需要 :tracker 符号的值（我在 gem 的 GitHub 上遵循这个自述文件：[https](https://github.com/kangguru/rack-google-analytics) ://github.com/kangguru/rack-google-analytics ）

显然，将 XXXXXXXXX 替换为您组织的跟踪代码。

似乎设置 :web_property_id 符号是另一个（但名称相似）gem rack-google_analytics 的功能：[https ://github.com/ambethia/rack-google_analytics](https://github.com/ambethia/rack-google_analytics)

# javascript - 在 contenteditable 中模拟拖动类型文本/普通行为

> ID：14467373
> 
> 赞同：1
> 
> 时间：2013-01-22T20:25:20.883
> 
> 标签：javascript, html, drag-and-drop, draggable, contenteditable

如果您拖动例如 text/plain 或 text/html，您想要放置的 contenteditable 元素会将插入符号/光标放置在您将放置拖动的内容的位置。

一个非常基本的小提琴来说明我的意思：[示例](http://jsfiddle.net/nspTj/)

```
<div contenteditable="true">DROP TEXT HERE</div>
This text wants to be dropped. 
```

如何模拟自定义数据类型的这种行为？或者：如何在悬停时始终将插入符号放在鼠标指针旁边？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-22T09:30:03.627

你可以使用 CSS :empty 伪选择器

```
[contenteditable="true"] {
    border: 2px solid #ccc;
    min-height: 1em;
}
[contenteditable="true"]:empty:before {
    content: 'DROP TEXT HERE';
    color: #999;
} 
```

[例子](http://jsfiddle.net/dmitrismirnov/nspTj/1/)

# sql - 是否有更优雅的方法可以根据存储在属性值表中的值来查询数据？

> ID：14467376
> 
> 赞同：0
> 
> 时间：2013-01-22T20:25:37.620
> 
> 标签：sql, tsql, entity-attribute-value, sap-ase

我有一个如下所示的属性值表`av`：

```
| attribute | value |
~~~~~~~~~~~~~~~~~~~~~
| a1        | A1    |
| b1        | BB1   |
| b2        | BB2   | 
```

为简单起见，假设`varchar(255)`在`attribute`和`value`列上，唯一索引在`attribute`.

我需要在查询中使用特定属性的值，如下所示：

```
SELECT *
FROM   t1
      ,t2
WHERE  t1.a1 = "A1"  -- Value of "a1" attribute
 AND   t1.id = t2.id
 AND   t2.b1 = "BB1"  -- Value of "b1" attribute
 AND   t2.b2 = "BB2"  -- Value of "b2" attribute 
```

**在 Sybase ASE（12 或 15）中是否有一种优雅的方法可以随着我们增加表和属性的数量而*很好地扩展？***

“规模”是指 4-5 个连接表需要约 10-20 个属性

我可以想到以下解决方案，所有这些似乎都很糟糕：

* * *

解决方案 1：显而易见：加入 AV 表，每个属性一次

```
SELECT *
FROM   t1
      ,t2
      ,av AS 'av_a1'
      ,av AS 'av_b1'
      ,av AS 'av_b2'
WHERE  t1.a1 = av_a1.value
 AND   t1.id = t2.id
 AND   t2.b1 = av_b1.value
 AND   t2.b2 = av_b2.value
 AND   av_a1.attribute = "a1"
 AND   av_b1.attribute = "b1"
 AND   av_b2.attribute = "b2" 
```

**优点：**很明显。

**缺点：**就代码质量和性能而言，扩展性非常差。

* * *

解决方案 2：避免使用变量进行多次连接的麻烦

```
declare @a1 varchar(255)
select  @a1 = value FROM av WHERE attribute = "a1"
declare @b1 varchar(255)
select  @b1 = value FROM av WHERE attribute = "b1"
declare @b2 varchar(255)
select  @b2 = value FROM av WHERE attribute = "b2"

SELECT *
FROM   t1
      ,t2
WHERE  t1.a1 = @a1
 AND   t1.id = t2.id
 AND   t2.b1 = @b1
 AND   t2.b2 = @b2 
```

**优点：**不再有额外的连接使查询变得丑陋且性能不佳。

**缺点：**就代码质量而言，扩展性有些差（需要添加具有新属性的新变量）。

* * *

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:34:49.157

我不确定`where`语句中的附加子句是做什么用的（将一个表中的值与另一个表中的属性进行比较）。以下内容在联接之前展平了属性：

```
SELECT *
FROM   t1 join
       t2
       on t1.id = t2.id join
       (select av.id,
               MAX(case when av.attribute = 'a1' then av.value end) as a1,
               MAX(case when av.attribute = 'b1' then av.value end) as b1,
               MAX(case when av.attribute = 'b2' then av.value end) as b2
        from av
        group by av.id
       ) attr
       on attr.id = t1.id 
```

这是可行的，假设属性中没有重复项——使用属性表时通常没有重复项。您可以添加`where`条件，如果您愿意，我只是不明白他们为什么在那里。

此外，您应该切换到 ANSI 标准连接语法。

如果你没有 id，你可以做同样的事情：

```
SELECT *
FROM   t1 join
       t2
       on t1.id = t2.id cross join
       (select MAX(case when av.attribute = 'a1' then av.value end) as a1,
               MAX(case when av.attribute = 'b1' then av.value end) as b1,
               MAX(case when av.attribute = 'b2' then av.value end) as b2
        from av
       ) attr
       on attr.id = t1.id
where <whatever you want> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T22:43:19.577

使用 Entity-Attribute-Value 设计本质上是非关系型的，因此在 SQL 中查询它必然是笨拙和低效的，就好像行描述了一个逻辑实体的属性一样。

为了降低在 SQL 中执行此操作的成本，我经常建议获取存储在数据库中的所有行，然后将属性应用于应用程序代码中的实体实例，一次一行。

这是另一个 SO 问题，示例 PHP 代码演示了我的意思：
[使用一个查询创建摘要结果](https://stackoverflow.com/questions/3515286/create-a-summary-result-with-one-query/3515379#3515379)

* * *

重新发表您的评论并投反对票：

你在这里射信使。

您询问：

> 在 Sybase ASE（12 或 15）中是否有一种优雅的方法可以随着我们增加表和属性的数量而很好地扩展？

将多行 EAV 数据查询到一行结果集中的每种方法，无论是通过连接还是通过旋转，都需要您知道属性集，并且这些属性在您准备查询时就已确定。因为 SQL 基于关系模型，所以结果集的列不能在查询执行时动态扩展。

因此，如果您有一个数据模型，其中表和属性的数量会不时增加，您会发现每次添加属性时都会更改数据透视查询代码。

您可以根据不同属性的数量动态生成数据透视查询，但这也需要应用程序代码，因为您需要查询当前属性然后构建查询。

另一种方法是获取所有数据，每行结果集一个属性，然后编写代码将它们“重新组装”成应用程序端的逻辑实体。

**动态数据透视查询总是需要应用程序代码**——在查询之前或之后。

很抱歉你不喜欢这个答案。

# php - MOODLE 2 备份不存储表

> ID：14467379
> 
> 赞同：2
> 
> 时间：2013-01-22T20:25:47.110
> 
> 标签：php, moodle

我一直在为我的邮件模块开发备份功能。我遵循了 MOODLE 备份 2.0 开发指南。但是，除了模块活动表“邮件”之外，备份不会保存任何表。这是我的实现：

```
 class backup_mail_activity_structure_step extends backup_activity_structure_step {

    protected function define_structure() {

        // To know if we are including userinfo
        $userinfo = $this->get_setting_value('userinfo');

        // Define each element separated
        $mail = new backup_nested_element('mail', array('id'), array(
          'course', 'name', 'intro', 'introformat', 'timecreated', 'timemodified'));

        $folders = new backup_nested_element('folders');
        $folder = new backup_nested_element('folder', array('id'), array(
          'mailid', 'userid', 'name', 'type', 'timemodified'));

        $messages = new backup_nested_element('messages');
        $message = new backup_nested_element('message', array('id'), array(
          'mailid', 'userid', 'fromid', 'folderid', 'subject', 'content',
          'file', 'isread', 'replied', 'forwarded', 'deleted', 'timecreated',
          'timemodified'));

        $groups = new backup_nested_element('groups');
        $group = new backup_nested_element('group', array('id'), array(
          'mailid', 'name', 'timemodified'));

        $members = new backup_nested_element('members');
        $member = new backup_nested_element('member', array('id'), array(
          'groupid', 'userid', 'timemodified'));

        $recipients = new backup_nested_element('recipients');
        $recipient = new backup_nested_element('recipient', array('id'), array(
          'messageid', 'toid', 'timemodified'));

        // Build the tree
        $mail->add_child($folders);
        $folders->add_child($folder);
        $folder->add_child($messages);
        $messages->add_child($message);
        $message->add_child($recipients);
        $recipients->add_child($recipient);

        $mail->add_child($groups);
        $groups->add_child($group);
        $group->add_child($members);
        $members->add_child($member);

        // Define sources
        //$mail->set_source_table('mail', array('id' => backup::VAR_ACTIVITYID));
        $mail->set_source_table('mail', array('id' => backup::VAR_ACTIVITYID));
        /*
        $folder->set_source_sql('
          SELECT *
          FROM {mail_folder}
          WHERE mailid = ?',
          array(backup::VAR_PARENTID));
         */
        if ($userinfo) {
          $folder->set_source_table('mail_folder', array('mailid' => backup::VAR_ACTIVITYID));
          $message->set_source_table('mail_messages', array('mailid'=>backup::VAR_ACTIVITYID));
          $recipient->set_source_table('mail_to_messages', array('messageid'=>backup::VAR_PARENTID));
          $group->set_source_table('mail_groups', array('mailid'=>backup::VAR_ACTIVITYID));
          $member->set_source_table('mail_members', array('groupid'=>backup::VAR_PARENTID));
        }
        /*
        print("ray_test:\n");
        print_object($groups);
         */

        // Define id annotations
        $folder->annotate_ids('user', 'userid');
        $message->annotate_ids('user', 'userid');
        $member->annotate_ids('user', 'userid');
        $recipient->annotate_ids('user', 'toid');

        // Define file annotations
        $mail->annotate_files('mod_mail', 'intro', null);

        // Return the root element (mail), wrapped into standard activity structure
        return $this->prepare_activity_structure($mail);

    }
} 
```

这是生成的 xml 文件：

```
 <?xml version="1.0" encoding="UTF-8"?>
    <activity id="3" moduleid="87" modulename="mail" contextid="196">
    <mail id="3">
    <course>12</course>
    <name>Course Email</name>
    <intro></intro>
    <introformat>1</introformat>
    <timecreated>1351542231</timecreated>
    <timemodified>0</timemodified>
    <folders>
    </folders>
    <groups>
    </groups>
  </mail>
</activity> 
```

# django - 对 POST 处理视图的 GET 请求

> ID：14467381
> 
> 赞同：1
> 
> 时间：2013-01-22T20:25:50.473
> 
> 标签：django, django-views

我有一个视图打算只处理以开头的 POST 请求

```
user = User.objects.get(username=request.POST['name']) 
```

我是否需要确保视图不是通过 GET 请求调用的？不确定我是在考虑良好的实践/安全类型的事情还是强迫症。

我正在使用`@require_POST`装饰器，因为使用 GET 调用视图会导致`"Key 'name' not found in <QueryDict: {}>`500 错误。

我想发生这种情况的唯一机会是，如果用户查看了页面的 HTML，并且出于某种原因考虑尝试`action`在地址栏中尝试表单的属性——这似乎不太可能。

我自己在几个网站上尝试过这个并得到一个错误页面，而不是一个带有 405 错误的空白页面`@require_POST`给我。

如果模板设计者错误地创建了指向我的视图的超链接或忘记了，那么防范 GET 请求可能是一种好习惯`method="post"`？（在这种情况下，我想我应该`get_object_or_404`在上面使用）

我假设添加`@require_GET`到仅用于处理 GET 请求的视图是不必要的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:57:09.963

似乎您明白为什么要使用`@requirePOST`. 如果您不想在 上引起错误，另一种选择`GET`是使用以下内容：

```
def view(request):
    if request.method == 'POST':
        ..code for post..
    else:
        *redirect, or other code* 
```

至于您是否需要使用`@requireGET`，唯一可能造成伤害的方法是您需要一个视图来执行`GET`和`POST`。即在 上引起操作的表单`POST`，但只是在 上为用户显示`GET`。但是，如果您需要`GET`，那么视图中不应该有任何可能通过`POST`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T23:59:09.390

> 我是否需要确保视图不是通过 GET 请求调用的？不确定我是在考虑良好的实践/安全类型的事情还是强迫症。

是的。我认为您涉及回答自己的问题。您的视图需要`request.POST`获取请求错误。如果您想创建无错误代码，您将确保没有获取请求访问此视图。Django 提供了一个方便的、pythonic 的装饰器来做到这一点。我不认为你是强迫症。此外，我不知道在生产中触发错误（通过电子邮件发送给您、记录它等）的代价有多大，但这是需要考虑的事情。

> 我想发生这种情况的唯一机会是，如果用户查看了页面的 HTML，并且出于某种原因考虑尝试在地址栏中尝试表单的 action 属性——这似乎不太可能。

我认为用户如何对此提出 GET 请求并不重要，我认为只有这个视图必须是一个发布请求才重要。

> 如果模板设计者错误地创建了指向我的视图的超链接或忘记了 method="post"，那么防范 GET 请求可能是一种好习惯？（在这种情况下，我想我应该使用上面的 get_object_or_404 ）

在这种情况下，我认为考虑可以对此视图提出获取请求的多种方式并不重要。重要的部分是它需要一个 Post 请求。您可以使用可用的工具来确保进入函数的所有请求都是发布请求。

一件事是，`name`没有假设。你仍然可以得到一个`KeyError`. 即使您确保请求是 POST，您也无法确保发布请求将具有参数`name`

这就是为什么[`get`](http://docs.python.org/2/library/stdtypes.html#dict.get)如此频繁地使用

```
if not request.POST.get('name'):
  # raise some sort of error?
user = User.objects.get(username=request.POST['name']) 
```

# java - 为什么我的 Ant 类路径在 Eclipse 中正常，但在 Jenkins 中为空？

> ID：14467388
> 
> 赞同：1
> 
> 时间：2013-01-22T20:26:22.990
> 
> 标签：java, eclipse, ant, jenkins

我在`build.xml`本地和运行 Jenkins 的服务器上运行我的 Ant 文件。

在本地，在 Eclipse 中，构建工作得非常好。我使用以下方法设置类路径：

```
<path id="classpath">
    <fileset dir="${lib.dir}" includes="**/*.jar" />
</path> 
```

然后我在运行目标时使用以下内容：

```
<javac srcdir="${src.dir}" destdir="${build.dir}" includeantruntime="false">
    <classpath refid="classpath" />
</javac> 
```

当我使用类路径进行调试时，会显示我文件夹`echo`中的所有可用 jar 。`project/lib`

但是，当我 Jenkins 获取此`build.xml`文件并远程运行它时，它会打印一个空的类路径（使用相同的`echo`目标）。

为什么我的类路径因 Eclipse 和 Jenkins 不同而不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:31:02.447

您在 Jenkins 服务器上的构建环境看起来与您的桌面开发环境有点不同。

健全性检查：${lib.dir} 在哪里/如何提供值？通常它在构建文件中设置了一个属性 - 你也可以在这里发布吗？

# sql - SQL查询在两个日期字段之间选择数据不起作用

> ID：14467390
> 
> 赞同：0
> 
> 时间：2013-01-22T20:26:29.640
> 
> 标签：sql, sql-server

我的表中有以下值

![有哪些数据](../Images/12f25261b82f1dad6063c4bdc8fbe110.png)

```
Select * From TimeSheetLogs where InTimeStamp <= '1/22/2013' 
```

当我执行上述查询时，我得到空值

但如您所见，我有 3 个数据，日期字段为 2013 年 1 月 22 日

那我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:28:44.450

这是正确的，因为

```
'1/22/2013 19:21' > '1/22/2013 00:00' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:10:28.730

您可能需要先截断日期以删除时间部分。然后将双方转换为日期数据类型。字符串 '1/22/2013' 是字符串，而不是日期。通过查看数据，您的 InTimeStamp 是时间戳数据类型。您无法将日期或时间戳与字符进行比较，而无需将字符转换为日期。我不确定您使用的是什么数据库。这就是您在 Oracle 中使用 to_date 函数进行转换的方式。

```
SELECT in_date, compare_date
  FROM
 (-- This is your InTimeStamp on the fly
  SELECT trunc(to_timestamp('2013-01-22 16:21:19.273', 'yyyy-mm-dd hh24:mi:ss.ff')) in_date -- this is your InTimeStamp  
      , to_date('1/22/2013', 'mm/dd/yyyy') compare_date
   FROM dual
 )
 WHERE in_date <= compare_date
/

Now you can compare two dates below - this is the output of above query:

in_date     compare_date
----------  ------------
1/22/2013   1/22/2013 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T07:28:44.183

```
Select * From TimeSheetLogs 
where InTimeStamp <= select convert(datetime,'1/22/2013',101) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:36:07.980

根据我对@Zdravko 的好回答的评论，您只需要输入您的日期：

```
Select * From TimeSheetLogs where CAST(InTimeStamp as Date) <= '1/22/2013' 
```

# python - 为什么 python 的 sqlite3 模块试图从我的项目目录中导入日期时间？

> ID：14467391
> 
> 赞同：2
> 
> 时间：2013-01-22T20:26:33.910
> 
> 标签：python, sqlite, python-module

我正在尝试遵循[python 手册](http://docs.python.org/2/library/sqlite3.html)提供的与 SQLite 交互的示例。第一行代码似乎无法正常工作：

```
import sqlite3 
```

因此，尝试导入 python 的 sqlite3 模块是试图从调用脚本目录而不是它所在的任何位置导入 python 的日期时间，如下面的回溯所示。我不知道为什么。我错过了什么？

```
Traceback (most recent call last):
  File "sqlite_test.py", line 3, in <module>
    import sqlite3
  File "/usr/lib/python2.7/sqlite3/__init__.py", line 24, in <module>
    from dbapi2 import *
  File "/usr/lib/python2.7/sqlite3/dbapi2.py", line 24, in <module>
    import datetime
  File "/home/brian/dev/py/datetime.py", line 3, in <module>
    now = datetime.now()
AttributeError: 'module' object has no attribute 'now' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:33:00.883

只需将`/home/brian/dev/py/datetime.py`模块重命名为 以外`datetime.py`的名称，因为它与 datetime 内置模块具有相同的名称。

请避免使用与标准库或内置模块名称相同的名称来命名您的模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:36:54.513

更详细一点，有一个名为 的 Python 内置模块`datetime`，用于管理——嗯，你知道的。

您已经创建了一个名为 的文件`datetime.py`，它对应于一个名为`datetime`. 由于`sqlite`要使用 Python 内置`datetime`模块，它会导入它——但是您在同一目录中创建了一个具有相同名称的文件这一事实意味着 Python 的优先级规则将选择它而不是内置模块。

打个比方，如果您`sqlite3.py`在工作目录中创建了一个文件，`import sqlite3`则会为您提供该模块而不是内置模块。

故事的寓意：不要隐藏内置名称。

# c++ - 快速的字符串搜索

> ID：14467396
> 
> 赞同：15
> 
> 时间：2013-01-22T20:26:56.980
> 
> 标签：c++, search

我有一个问题，我正在寻找一些指导来解决最有效的方法。我有 2 亿个数据字符串，大小从 3 个字符到 70 个字符不等。字符串由字母数字和几个特殊字符（如破折号和下划线）组成。我需要能够快速搜索整个字符串或字符串中的任何子字符串（最小子字符串大小为 3）。快速在这里定义为小于 1 秒。

作为我的第一次剪辑，我做了以下事情：

1.  创建了 38 个索引文件。索引包含以特定字母开头的所有子字符串。前 4mb 包含 100 万个哈希桶（哈希链的开始）。索引的其余部分包含来自哈希桶的链表链。我的散列分布非常均匀。100 万个哈希桶保存在 RAM 中并镜像到磁盘。

2.  当一个字符串被添加到索引中时，它被分解成它的非重复（在其自身内）3-n 个字符的子字符串（当 n 是字符串 1 的长度时）。因此，例如，“apples”作为 pples,pple,ppl,pp 存储在“A”索引中（子字符串也存储在“L”和“P”索引中）。

搜索/添加服务器作为守护程序运行（在 C++ 中）并且像冠军一样工作。典型的搜索时间小于 1/2 秒。

问题出在流程的前端。我通常一次添加 30,000 个密钥。这部分过程需要很长时间。作为基准，加载到 180,000 个可变长度键的空索引的时间约为 3 1/2 小时。

除了很长的加载时间外，该方案有效。

在我疯狂优化（或尝试）之前，我想知道是否有更好的方法来解决这个问题。对于这么大的数据集，前后通配符搜索（即：DBMS 中的“%ppl%”之类的字符串非常慢（例如，在 MySQL 中大约为几个小时）。所以看起来 DBMS 解决方案是不可能的。我不能使用全文搜索，因为我们处理的不是普通单词，而是可能由也可能不是由真实单词组成的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:53:17.343

根据您的描述，加载数据需要花费所有时间，因为您正在处理 I/O，将*膨胀*的字符串镜像到硬盘。这肯定会是一个瓶颈，主要取决于你读写数据到磁盘的方式。

`mmap`使用一些 LRU 策略可以实现对执行时间的可能改进。我很确定复制数据的想法是使搜索速度更快，但是由于您使用 - 似乎是 - 只有一台机器，所以您的瓶颈将从内存搜索跳到 I/O要求。

另一个您可能不感兴趣的解决方案——它非常有趣和令人不安（：——，是将数据拆分到多台机器上。考虑到您构建数据的方式，实现本身可能需要一点时间的时间,但这将是非常简单的。你有：

*   每台机器都由一组桶负责，使用接近的东西选择`hash_id(bucket) % num_machines`；
*   从每台机器本地执行插入；
*   搜索可以通过某种*类型*的查询 - 应用程序进行接口，或者简单地聚集成查询集 - 如果应用程序不是交互式的；
*   考虑到您可能从一个节点发送启动请求，并将请求转发到另一个节点（也是集群请求，以避免过多的 I/O 开销），搜索甚至可能具有分布式接口。

另一个好处是，正如你所说，数据是均匀分布的——已经 \o/; 这通常是分布式实现中最挑剔的部分之一。此外，这将是高度可扩展的，因为您可以在数据大小增加时添加另一台机器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:25:39.080

与其一次性做完所有事情，不如用 38 遍解决问题。

读取 180,000 个字符串中的每一个。在每个字符串中找到“A”，并仅将内容写入“A”哈希表。完成后，将“A”哈希表的整个完成结果写入磁盘。（有足够的 RAM 将整个“A”哈希表存储在内存中——如果你不这样做，制作更小的哈希表。即，在成对的起始字母上有 38^2 个哈希表，并有 1444 个不同的表。你可以甚至可以根据前缀的常见程度动态更改哈希表的键控字母数量，因此它们的大小都适中。跟踪这些前缀的长度并不昂贵。）

然后读取 180,000 个字符串中的每一个，寻找“B”。等等。

我的理论是，由于大量表的缓存抖动，您的速度比您可能的要慢。

接下来可能有帮助的事情是限制您对字符串进行哈希处理的时间长度，以缩小表的大小。

如果您将散列的长度限制为 10 个字符，则不是对长度为 70 的字符串执行所有 2278 个长度为 3 到 70 的子字符串，而是只有 508 个长度为 3 到 10 的子字符串。字符串上的冲突可能不会那么多长度大于 10。再次，您可以让散列的长度是动态的——长度 X 散列可能有一个标志“如果你的字符串长于 X，请尝试长度 X+Y 散列，这太常见了"，否则简单地终止散列。这可能会减少表中的数据量，但在某些情况下会降低查找速度。

# ruby-on-rails - 运行 rake db:populate 时出错

> ID：14467402
> 
> 赞同：0
> 
> 时间：2013-01-22T20:27:29.943
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, rake

运行 rake db:reset 后我运行 rake db:populate 并且我收到此错误不知道它来自哪里

```
rake aborted!
undefined method `+' for 4..5:Range

Tasks: TOP => db:populate
(See full trace by running task with --trace) 
```

**在我的任务文件夹中**

```
namespace :db do
  desc " Fill database with sample data"
  task populate: :environment do
     admin = User.create!(name: "Emple User", 
                          email: "exampel@railstuttorial.org",    
                          password: "password",
                          password_confirmation: "password")
  admin.toggle!(:admin)                 
     99.times do |n|
        name = Faker::Name.name
        email = "example-#{n + 1}@railstutorial.org"
        password = "password"
        User.create!(name: name, email: email, password: password,     
                     password_confirmation: password)
     end   
     users = User.all(limit: 6)
     50.times do
       content = Faker::Lorem.sentence(4..5)
       users.each { |user| user.microposts.create!(content: content) }
       content = nil 
     end             
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:32:17.890

`Faker::Lorem.sentence`您在`50.times`循环中传递了一个范围。

我不确定您要实现什么，但该方法需要一个整数（您的意思是 4 还是 5？），并且当它尝试在`Faker::Lorem`代码中添加一些内容时，它会导致该错误。

# opencl - 如何在 OpenCL 中处理超大图像？

> ID：14467413
> 
> 赞同：0
> 
> 时间：2013-01-22T20:28:15.357
> 
> 标签：opencl, gpgpu, pyopencl

我一直在研究一个 PyOpenCL 程序，它将接收一个 OpenCL 内核（代表一个图像过滤器）和一个图像，并应用所述过滤器来生成一个输出图像。问题是我需要让这个程序在任何大小的图像上运行。

我之前使用 Cloo (http://sourceforge.net/projects/cloo/) 框架使用 C# 和 OpenCL 编写了一个类似的程序，但我想让一些东西更便携（因为 Cloo 框架无法在 Linux 上正常运行）。

现在，在我的 C# 实现中，我只是将图像分成块并在每个块上运行内核。我通过在内核中将图像作为纯字节数组处理来做到这一点。但是，我现在遇到的问题是我试图在我的 PyOpenCL 实现中使用 image2d_t 数据类型，但我不确定如何将图像分成块并将它们传递给内核。

image2d_t 类是否为返回的图像添加了填充（我需要对其进行后处理），或者它可能支持某种可以为我处理这个问题的自动化方法？

非常感谢任何可以为我指明正确方向的资源！

编辑：我想我应该提到我想要这样做的原因是因为我在当前构建中遇到了内存分配异常（因为图像太大）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:19:01.983

我设法通过使用 Python Imaging Library 的裁剪和粘贴功能拆分图像来处理子图像并在处理后将它们替换为输出图像来解决它。

# c# - 调整半透明位图大小时的白色像素

> ID：14467416
> 
> 赞同：0
> 
> 时间：2013-01-22T20:28:29.067
> 
> 标签：c#, .net, gdi+, system.drawing

有时，当我调整半透明 png 的大小时，我会在形状边缘上看到奇怪的白色像素。这只发生在具有形状的图像（不是照片）并且 when `InterpolationMode`设置为`HighQualityBicubic`. 有谁知道为什么这个白色像素显示？我只在一些图像上得到它们。

这是我得到的结果：

![在此处输入图像描述](../Images/e58618dcbff9e65441b45218c4298874.png)

这是源文件：

![在此处输入图像描述](../Images/782e9a963c7d83bcdf14a9a27eb59d1a.png)

这是类似的文件，不会导致“白色像素”效果。

![在此处输入图像描述](../Images/507bab370d47a75ea176be872067c1fa.png)

绘制代码很简单：

```
Bitmap resize = new Bitmap(1024, 177, PixelFormat.Format32bppArgb);
using (Graphics g = Graphics.FromImage(resize))
{
    g.InterpolationMode = InterpolationMode.HighQualityBicubic;
    g.DrawImage(Properties.Resources.Wave01, 0, 0, 1024, 177);
} 
```

请注意，我使用`HighQualityBicubic`该代码是因为该代码用于调整各种类型的图像（包括照片）的大小。使用`InterpolationMode.Default`似乎可以解决问题，但是调整某些图像类型的大小可能会产生比`HighQualityBicubic`.

# php - 带有 IndexController 的友好 URL

> ID：14467417
> 
> 赞同：1
> 
> 时间：2013-01-22T20:28:30.247
> 
> 标签：php, url-routing

我当前的路由器 / FrontController 设置为以以下格式剖析 URL：

```
http://localhost/controller/method/arg1/arg2/etc... 
```

但是，我不确定如何将某些请求默认为 IndexController，以便我可以键入：

```
http://localhost/contact
or
http://localhost/about/portfolio 
```

代替：

```
http://localhost/index/contact
or
http://localhost/index/about/portfolio 
```

这是如何实现的？

```
<?php

namespace framework;

class FrontController {
    const DEFAULT_CONTROLLER = 'framework\controllers\IndexController';
    const DEFAULT_METHOD     = 'index';

    public $controller       = self::DEFAULT_CONTROLLER;
    public $method           = self::DEFAULT_METHOD;
    public $params           = array();
    public $model;
    public $view;

    function __construct() {
        $this->model = new ModelFactory();
        $this->view = new View();
    }

    // route request to the appropriate controller
    public function route() {
        // get request path
        $basePath = trim(substr(PUBLIC_PATH, strlen($_SERVER['DOCUMENT_ROOT'])), '/') . '/';
        $path = trim(parse_url($_SERVER["REQUEST_URI"], PHP_URL_PATH), '/');
        if($basePath != '/' && strpos($path, $basePath) === 0) {
            $path = substr($path, strlen($basePath));
        }

        // determine what action to take
        @list($controller, $method, $params) = explode('/', $path, 3);
        if(isset($controller, $method)) {
            $obj = __NAMESPACE__ . '\\controllers\\' . ucfirst(strtolower($controller)) . 'Controller';
            $interface = __NAMESPACE__ . '\\controllers\\' . 'InterfaceController';
            // make sure a properly implemented controller and corresponding method exists
            if(class_exists($obj) && method_exists($obj, $method) && in_array($interface, class_implements($obj))) {
                $this->controller = $obj;
                $this->method = $method;

                if(isset($params)) {
                    $this->params = explode('/', $params);
                }
            }
        }
        // make sure we have the appropriate number of arguments
        $args = new \ReflectionMethod($this->controller, $this->method);
        $totalArgs = count($this->params);
        if($totalArgs >= $args->getNumberOfRequiredParameters() && $totalArgs <= $args->getNumberOfParameters()) {
            call_user_func_array(array(new $this->controller, $this->method), $this->params);
        } else {
            $this->view->load('404');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:47:53.553

根据您的代码片段，我会这样做（伪 php 代码）：

```
$handler = get_controller($controller);
if(!$handler && ($alias = lookup_alias($path))) {
    list($handler, $method) = $alias;
}
if(!$handler) error_404();

function lookup_alias($path) {
    foreach(ALL_CONTROLLERS as $controller) {
        if(($alias = $controller->get_alias($path))) {
            return $alias;
        }
    }
    return null;
} 
```

所以基本上如果没有控制器来处理某个位置，您检查是否有任何控制器配置为将给定路径作为别名处理，如果是，则返回该控制器及其映射到的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T21:34:36.127

您可以通过以下两种方法之一使用您的 URL：

**按照路由定义控制器的方式建立控制器**

example.com/contact => 有一个带有默认或索引操作的“联系人”控制器

example.com/about/portfolio => 有一个带有“portfolio”操作的“about”控制器

因为您当前可用的路由表明您的 URL 被视为“/controller/method”，所以没有其他方法。

**建立动态路由以允许单个控制器处理多个 URL**

显然，这需要一些配置，因为无法知道哪些 URL 是有效的，哪些应该重定向到通用控制器，哪些不应该。这在某种程度上可以替代任何重写或重定向解决方案，但由于它是在 PHP 级别处理的，因此更改可能更容易处理（由于性能原因，某些 Web 服务器配置不提供 .htaccess，而且通常需要更多的努力创建这些）。

您的配置输入是：

1.  您要处理的 URL 和
2.  您希望将 URL 传递到的控制器，以及它的操作。

你最终会得到一个这样的数组结构：

```
$specialRoutes = array(
    "/contact" => "IndexController::indexAction",
    "/about/portfolio" => "IndexController::indexAction"
); 
```

缺少的是此操作应将当前 URL 作为参数传递，或者路径部分成为 URL 架构中的指定参数。

总而言之，这种方法编码起来要困难得多。要了解一个想法，请尝试查看常见 MVC 框架的路由，例如 Symfony 和 Zend Framework。它们提供高度可配置的路由，因此，路由发生在多个类中。如果检测到匹配，主路由器只读取配置，然后将任何 URL 的路由传递给配置的路由器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T20:31:53.587

您可以在您的网络服务器中为这些异常创建重写。例如：

```
RewriteRule ^contact$ /index/contact
RewriteRule ^about/portfolio$ /about/portfolio 
```

这将允许您拥有映射到常规结构的简化 URL。

如果您能够精确定义应该重写到 /index 的内容，则可以有一个动态规则。例如：

```
RewriteRule ^([a-z]+)$ /index/$1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-22T20:36:52.473

试试这个动态 htaccess 重写规则：

```
RewriteRule ^(.+)/?$ /index/$1 [QSA] 
```

[`QSA`](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_qsa)如果需要，上述规则中的标志还允许您在末尾添加查询字符串，如下所示：

```
http://localhost/contact?arg1=1&arg2=2 
```

**编辑：**此规则还将处理以下情况`/about/portfolio`：

```
RewriteRule ^(.+)/?(.+)?$ /index/$1 [QSA] 
```

# postgresql - PostgreSQL Extract() DOW：为什么除了时间戳之外没有日期数据类型？

> ID：14467418
> 
> 赞同：4
> 
> 时间：2013-01-22T20:28:35.473
> 
> 标签：postgresql, date, extract, dayofweek, ordinal

根据 PostgreSQL 版本 8.1 日期时间函数[文档](http://www.postgresql.org/docs/8.1/static/functions-datetime.html)：

> dow 星期几（0 - 6；星期日为 0）（*仅适用于时间戳值*）
> 
> ```
> SELECT EXTRACT(DOW FROM TIMESTAMP '2001-02-16 20:38:40');
> Result: 5 
> ```

为什么**Date**数据类型也不是此函数的有效参数？如果星期几的顺序不因语言环境而改变：

```
 0 - 6; Sunday is 0 
```

为什么需要组合日期类型值的时间分量来确定一周中一天的序数？单独的日期块还不够吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-06-01T15:12:59.230

原始问题引用了 8.1 版，9.5 文档指出：

> `EXTRACT(field FROM source)`
> 
> extract 函数从日期/时间值中检索子字段，例如年或小时。source 必须是时间戳、时间或间隔类型的值表达式。（日期类型的表达式转换为时间戳，因此也可以使用。）字段是一个标识符或字符串，用于选择从源值中提取的字段。extract 函数返回双精度类型的值。以下是有效的字段名称：

再后来，特别是在 dow 下：

> 道琼斯指数
> 
> 星期天 (0) 到星期六 (6)
> 
> ```
> SELECT EXTRACT(DOW FROM TIMESTAMP '2001-02-16 20:38:40');
> Result: 5 
> ```
> 
> 请注意，extract 的星期几编号与 to_char(..., 'D') 函数的不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:36:19.490

这只是一个文档错误。

# c# - 快速比较两个对象的属性c#

> ID：14467423
> 
> 赞同：-2
> 
> 时间：2013-01-22T20:28:44.420
> 
> 标签：c#, performance, linq, comparison

我有两个具有不同值的相同类型的对象：

```
 public class Itemi
    {
    public Itemi()
    {

    }

    public int Prop1Min { get; set; }
    public int Prop1Max { get; set; }

    public int Prop2Min { get; set; }
    public int Prop2Max { get; set; }

    public int Prop3Min { get; set; }
    public int Prop3Max { get; set; }
    ...................................
    public int Prop25Min { get; set; }
    public int Prop25Max { get; set; }

    } 
```

现在我实例化两个这种类型的对象并向它们的属性添加一些值。

```
Itemi myItem1 = new Itemi();

myItem1.Prop1Min = 1;
myItem1.Prop1Max = 4;

myItem1.Prop2Min = 2;
myItem1.Prop2Max = 4;

myItem1.Prop3Min = -1;
myItem1.Prop3Max = 5;

.............................

myItem1.Prop25Min = 1;
myItem1.Prop25Max = 5;

Itemi myItem2 = new Itemi();

myItem2.Prop1Min = 1;
myItem2.Prop1Max = 5;

myItem2.Prop2Min = -10;
myItem2.Prop2Max = 3;

myItem2.Prop3Min = 0;
myItem2.Prop3Max = 2;

................................

myItem2.Prop25Min = 3;
myItem2.Prop25Max = 6; 
```

进行此比较的最佳和最快方法是什么：

*   从 myItem1 获取每个属性并检查 Prop1-25 Min 和 Max 的值是否在 myItem2 Prop1-25 Min 和 Max 的值范围内

例子：

```
 myItem1.Prop1Min = 1
   myItem1.Prop1Max = 4

   myItem2.Prop1Min = 1
   myItem2.Prop1Max = 5 
```

这是真的，因为 mtItem1 Prop1 min 和 max 在 myItem2 min 和 max 的范围内。

条件应该是 AND 在所有属性之间，所以最后在我们检查所有 25 个属性之后，如果它们都在第二个对象的范围内，我们返回 true。

除了传统的 if-else 之外，有没有使用 Linq 或其他算法的快速方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:38:41.677

我会重构这些属性，使其更符合以下方面：

```
public class Item
{
    public List<Range> Ranges { get; set; }
}

public class Range
{
    public int Min { get; set; }
    public int Max { get; set; }
} 
```

那么您的比较方法可能是：

```
if (myItem1.Ranges.Count != myItem2.Ranges.Count)
{
    return false;
}

for (int i = 0; i < myItem1.Ranges.Count; i++)
{
    if (myItem1.Ranges[i].Min < myItem2.Ranges[i].Min ||
        myItem1.Ranges[i].Max > myItem2.Ranges[i].Max)
    {
        return false;
    }
}        
return true; 
```

否则，您将不得不使用反射，这绝不是快速的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:42:29.773

Linq 正在使用标准语句，例如 if...then，对于彼此而言，没有任何魔力 :)

如果最终目标只是比较，而不用说，哪些属性不在范围内，那么你不需要全部检查它们，对第一个不等于你可以结束检查。

因为您有这么多属性，所以您必须考虑将其保存在 Dictionary 或 List 中。或者使用动态属性（[ITypedList](http://msdn.microsoft.com/ru-ru/library/system.componentmodel.itypedlist.aspx)），如果它将用于绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:43:42.567

为了完整起见，这里有一个 LINQ 解决方案（但它的性能和可读性都比 Ginosaji 的解决方案差！）

```
public class Range
{
    public int Min { get; set; }
    public int Max { get; set; }

    public static bool IsContained(Range super, Range sub)
    {
        return super.Min <= sub.Min
            && super.Max >= sub.Max;
    }
}

public class Itemi
{
    public Itemi()
    {
        properties = new Range[25];
        for (int i = 0; i < properties.Length; i++)
        {
            properties[i] = new Range();
        }
    }

    private Range[] properties;

    public IEnumerable<Range> Properties { get { return properties; } }

    public static bool IsContained(Itemi super, Itemi sub)
    {
        return super.properties
            .Zip(sub.properties, (first, second) => Tuple.Create(first, second))
            .All((entry) => Range.IsContained(entry.Item1, entry.Item2));
    }

    public Range Prop1 
    { 
        get { return properties[0]; }
        set { properties[0] = value; }
    }

    public Range Prop2
    {
        get { return properties[1]; }
        set { properties[1] = value; }
    }

    // ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:48:44.477

你真的应该像 Ginosaji 提议的那样做。

但是，如果您想使用当前的数据模型，这就是我将如何解决它。快乐打字。:)

```
public static bool RangeIsContained(int outerMin, int outerMax, int innerMin, int innerMax)
{
    return (outerMin <= innerMin && outerMax >= innerMax);
}

public bool IsContained(Itemi outer, Itemi inner)
{
    return RangeIsContained(outer.Prop1Min, outer.Prop1Max, inner.Prop1Min, inner.Prop1Max)
        && RangeIsContained(outer.Prop2Min, outer.Prop2Max, inner.Prop2Min, inner.Prop2Max)
        // ...
        && RangeIsContained(outer.Prop25Min, outer.Prop25Max, inner.Prop25Min, inner.Prop25Max);
} 
```

对于您的数据模型，这基本上是除了反射之外的唯一方法（慢！）。LINQ 无法帮助您，因为您的数据不可枚举。

# javascript - HTML5 + JavaScript - 将字符移向鼠标位置？

> ID：14467426
> 
> 赞同：1
> 
> 时间：2013-01-22T20:28:59.480
> 
> 标签：javascript, html, rotation, move

我的画布中间有一个角色，他旋转以始终面向我的鼠标位置——无论它在画布上的哪个位置。

我现在想做的是，当我按 W 或向上箭头时，我的角色会走向鼠标。我不确定这背后的数学原理，所以我寻求一点帮助。

现在，我有这个功能可以监听 WASD/箭头键：

```
Player.prototype.playerAnimation = function (){

    //UP
    if(this.isUpKey){

        //Character movement [drawX/Y is the position of character]
        this.drawY = mouseY;
} 
```

当然，这只会将角色移动到鼠标的 Y 位置——根本不是我要找的。我只是不知道需要什么样的公式？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:39:03.733

如果您已经成功地向鼠标旋转，则必须计算字符和光标之间的角度，所以现在`=mouseY`不要以绝对值（特点。`this.drawY``this.drawX`

但是，您希望 X 和 Y 移动的**对角线**为该值，因此类似这样的操作会将其分解为 X 和 Y 分量：

```
this.drawX=this.drawX+this.speed*Math.cos(d2r(angle));
this.drawY=this.drawY+this.speed*Math.sin(d2r(angle)); 
```

如果您以度数而不是弧度工作：

```
function d2r(d){
    var r=d*(Math.PI/180);
    return r;   
} 
```

根据您的角度是如何确定的，您可能必须使用公式中的符号。哦，如果您希望它在按键保持按下状态时继续移动，您需要添加一些`setTimeout`以在一段时间后重新触发该`playerAnimation`功能

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T00:34:21.223

你不应该使用 sin 和 cos 因为这些函数很慢，因此你不能在计算数据时使用角度（你只需要它来旋转精灵或类似的东西）。

首先，您应该使用 x、y、xspeed、yspeed、速度（每秒 px）和方向属性制作对象。

假设您的角色在位置 (10,10)，速度 = 5。现在您在位置 (50,40) 上单击（或悬停）鼠标。首先，您必须获得 dx 和 dy（增量）。

```
dx = mouse.x - character.x // 50 - 10 = 40
dy = mouse.y - character.y // 40 - 10 = 30 
```

接下来获取从字符位置到鼠标位置的距离。

```
distance = sqrt(dx*dx + dy*dy) // sqrt(40*40 + 30*30) = sqrt(1600 + 900) = 
                               // = sqrt(2500) = 50 (Pythagorean theorem) 
```

现在我们可以计算字符的 xspeed 和 yspeed。

```
factor = distance / character.speed // 50 / 5 = 10
character.xspeed = dx / factor // 40 / 10 = 4
character.yspeed = dy / factor // 30 / 10 = 3 
```

现在假设您每秒有 60 个物理循环的滴答声（可能您的物理循环没有与主循环分离，所以它只是您的 fps 计数）。你的字符 x 的每一个刻度都会增加 xspeed，y 增加 yspeed（如果你当然是按键的话）。所以一秒钟后（需要 60 个滴答声）你的角色将在 position `(10 + 60*4, 10 + 60*3) = (250, 190)`。它非常快，因此您可以降低角色速度或降低 fps（我不推荐）。

如果您希望您的角色停在鼠标位置（如在 cRPG 中），请使用计时器或计数器。角色到达鼠标位置所需的刻度数是先前计算的`factor`，等于`10`. 循环 10 次后，字符位置将为 (50,40)。因此，您可以在字符对象中创建 var 刻度，并且每个循环刻度将其减 1，当它变为 0 时，将字符的 xspeed 和 yspeed 重置为 0，这样它就不会再移动了。另一种方法是使用超时，但情况更糟。就在 10/60s = 1/6s ~= 0.18s 超时回调函数将字符的 xspeed 和 yspeed 重置为 0。

如果需要角度，可以使用 dx/dy 和 tan 计算。

这种运动方式比使用 sin 和 cos 快得多。

当然，您可以通过在 (character.x, character.y) 位置绘制字符来渲染运动。

# android - 自定义 ImageView 未实例化 java.lang.UnsupportedOperationException

> ID：14467430
> 
> 赞同：1
> 
> 时间：2013-01-22T20:29:11.470
> 
> 标签：android, android-layout, actionbarsherlock

抛出以下错误。

```
The following classes could not be instantiated:
- com.m.widget.CustomImageView (Open Class, Show Error Log)
See the Error Log (Window > Show View) for more details.
Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse

java.lang.UnsupportedOperationException: Unsupported Service: accessibility
    at com.android.layoutlib.bridge.android.BridgeContext.getSystemService(BridgeContext.java:448)
    at com.actionbarsherlock.internal.widget.IcsProgressBar.<init>(IcsProgressBar.java:340)
    at com.actionbarsherlock.internal.widget.IcsProgressBar.<init>(IcsProgressBar.java:273)
    at com.actionbarsherlock.internal.widget.IcsProgressBar.<init>(IcsProgressBar.java:269)
    at com.m2catalyst.widget.CustomImageView.<init>(CustomImageView.java:32)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(    at sun.reflect.NativeConstructorAccessorImpl.newInstance(    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(    at java.lang.reflect.Constructor.newInstance(    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.instantiateClass(ProjectCallback.java:413)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.loadView(ProjectCallback.java:170)
    at android.view.BridgeInflater.loadCustomView(BridgeInflater.java:207)
    at android.view.BridgeInflater.createViewFromTag(BridgeInflater.java:135)
    at android.view.LayoutInflater.rInflate_Original(LayoutInflater.java:746)
    at android.view.LayoutInflater_Delegate.rInflate(LayoutInflater_Delegate.java:64)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:718)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:372) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:42:17.690

错误消息告诉您发生了什么：

> 在 com.actionbarsherlock.internal.widget.IcsProgressBar.(IcsProgressBar.java:340

这与您正在使用的 UI 编辑器不兼容。做这个：

```
public CustomImageView(Context context) {
    this(context, null);
}

public CustomImageView(Context context, AttributeSet attrs){
    this(context, attrs, 0);
}

public CustomImageView(Context context, AttributeSet attrs, int defStyle){
    super(context, attrs, defStyle);
    imageView = new ImageView(context, attrs, defStyle);
    if (!isInEditMode()) progressBar = new IcsProgressBar(context, attrs, defStyle);
    init();
} 
```

类似的东西应该会有所帮助。基本上检查视图是否在带有 isInEditoMode 的 UI 编辑器中，并且不要运行该模式不支持的代码。

# casting - 在 F# 中强制转换类型参数

> ID：14467431
> 
> 赞同：4
> 
> 时间：2013-01-22T20:29:22.420
> 
> 标签：casting, f#, inline

我刚开始使用 F#，一些关于强制转换的问题让我非常困惑。不幸的是，我的背景阅读试图弄清楚为什么让我更加困惑，所以我正在寻找一些可以融入一般解释的具体答案......

我有一个 ReadOnlyCollection<'T> 枚举，由这个函数产生：

```
let GetValues<'T when 'T :> Enum> () =
    (new ReadOnlyCollection<'T>(Enum.GetValues (typeof<'T>) :?> 'T[])) :> IList<'T> 
```

我想要用它做的是找到枚举中被其值使用的所有位（即，按位或列表中的所有值一起），并将其作为通用枚举类型“T”返回。在我看来，这样做的明显方法是：

```
let UsedBits<'T when 'T :> Enum> () =
    GetValues<'T>()
    |> Seq.fold (fun acc a -> acc ||| a) 0 
```

...除了编译失败，出现错误“声明的类型参数'T'不能在此处使用，因为类型参数无法在编译时解析。”

我可以通过首先转换为 Int32 来完成实际工作（我真的不想这样做，因为我希望这个函数适用于所有枚举，而不管底层类型如何），即：

```
let UsedBits<'T when 'T :> Enum> () =
    GetValues<'T>()
    |> Seq.map (fun a -> Convert.ToInt32(a))
    |> Seq.fold (fun acc a -> acc ||| a) 0 
```

...但结果生成为 Int32。如果我尝试将其转换回 'T，我会再次遇到编译错误。

我不想在我的问题中*过于*具体，因为我不确定我应该询问哪些细节，所以 - 这种方法的缺陷在哪里？我应该怎么做？

**（编辑添加：**，发布@Daniel的答案

唉，这似乎是我不能很好地理解上下文以理解答案的情况之一，所以......

我*想*我理解你的回答中内联和不同的约束在做什么，但是作为一个 F# 新手，你介意在这些事情上稍微扩展一下，这样我就可以检查我的理解是否偏离了基础？谢谢。

**)**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T21:05:22.613

你可以这样做：

```
let GetValues<'T, 'U when 'T : enum<'U>>() = 
  Enum.GetValues(typeof<'T>) :?> 'T[]

let inline GetUsedBits() =
  GetValues() |> Seq.reduce (|||) 
```

`inline`允许更灵活的约束，即`'T (requires member ( ||| ))`。没有它，编译器必须选择一个可以用 IL 表示的约束，或者，如果不能这样做，则选择一个具体类型。在这种情况下，它选择`int`，因为它支持`(|||)`.

这是一个更简单的复制：

```
let Or a b = a ||| b //add 'inline' to compare 
```

有关详细信息，请参阅MSDN 上的[静态解析类型参数。](http://msdn.microsoft.com/en-us/library/dd548046.aspx)

# javascript - JavaScript 中的货币格式

> ID：14467433
> 
> 赞同：40
> 
> 时间：2013-01-22T20:29:31.883
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何在 JavaScript 中将数字格式化为货币？](https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript)

我有一个带有一些简单 JavaScript 的表单来执行即时计算。我的问题是我正在努力格式化它以使用逗号和 2 个小数位正确显示。

任何帮助将不胜感激。谢谢你。

```
 <p>
    <label>My Daily Rate is:</label><br />
<input class="poundsBox" name="shares" id="shares" type="text" /><br />
<br />
<strong>Your Gross Contract Take Home:</strong></p>
<p><span class="result">&pound; <span id="result"></span></span></p>
The above illustration is provided for guidance only. Please complete the request form below for a detailed personal illustration.

<script type="text/javascript">
$("#shares").keyup(function() {
   var val = parseFloat($(this).val());
   // If val is a good float, multiply by 260, else show an error
   val = (val ? val * 260 * 0.88 : "Invalid number");
   $("#result").text(val);
})
</script> 
```

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-01-22T20:31:46.847

您可以使用标准的 JS`toFixed`方法

```
var num = 5.56789;
var n=num.toFixed(2);

//5.57 
```

为了添加逗号（以分隔 1000's），您可以按如下方式添加正则表达式（其中`num`是数字）：

```
num.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,")

//100000 => 100,000
//8000 => 8,000
//1000000 => 1,000,000 
```

完整示例：

```
var value = 1250.223;
var num = '$' + value.toFixed(2).replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");

//document.write(num) would write value as follows: $1,250.22 
```

分隔符取决于国家和地区。对于某些国家/地区，可能需要`.`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:35:11.277

您可以使用 Number 类型的 toPrecision() 和 toFixed() 方法。检查此链接[如何在 JavaScript 中将数字格式化为货币？](https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript)

# c++ - 旋转点的球面系统

> ID：14467434
> 
> 赞同：2
> 
> 时间：2013-01-22T20:29:33.647
> 
> 标签：c++, rotation, geometry

假设我在一个球体上有 10 个点（随机分布），我想旋转整个系统以确保一个点位于北极。我将如何使用 c++ 做到这一点？

我通过查看 3D 旋转矩阵来解决这个问题：

[http://en.wikipedia.org/wiki/Rotation_matrix](http://en.wikipedia.org/wiki/Rotation_matrix)

我围绕 x 轴旋转我的点，直到 y 分量为零，然后围绕 y 轴旋转，直到 x 分量为零。这应该将问题点留在北极或南极，对吗？

我的代码如下所示：

```
#include <stdio.h> 
#include <string.h>
#include <math.h>
#include <iostream>
#include <iomanip>
#include <fstream>
#include <time.h>
#include <stdlib.h>
#include <sstream>
using namespace std;
#define PI 3.14159265358979323846

int main()
{

  int a,b,c,f,i,j,k,m,n,s;
  double p,Time,Averagetime,Energy,energy,Distance,Length,DotProdForce,Forcemagnitude,
         ForceMagnitude[101],Force[101][4],E[1000001],En[501],x[101][4],y[101][4],
         Dist[101][101],Epsilon,z[101],theta,phi;

    /*  set the number of points */
    n=10;

    /* check that there are no more than 100 points */
    if(n>100){
      cout << n << " is too many points for me :-( \n";
      exit(0);
    }

    /* reset the random number generator */
    srand((unsigned)time(0));  

    for (i=1;i<=n;i++){
      x[i][1]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
      x[i][2]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;
      x[i][3]=((rand()*1.0)/(1.0*RAND_MAX)-0.5)*2.0;

      Length=sqrt(pow(x[i][1],2)+pow(x[i][2],2)+pow(x[i][3],2));

      for (k=1;k<=3;k++){
        x[i][k]=x[i][k]/Length;
      }
    }

    /* calculate the energy */
    Energy=0.0;

    for(i=1;i<=n;i++){
      for(j=i+1;j<=n;j++){
        Distance=sqrt(pow(x[i][1]-x[j][1],2)+pow(x[i][2]-x[j][2],2)
                    +pow(x[i][3]-x[j][3],2));

        Energy=Energy+1.0/Distance;
      }
    }

   cout << fixed << setprecision(10) << "energy=" << Energy << "\n";  

  /* Save Values so far */

  for(i=1;i<=n;i++){
    for(j=1;j<=3;j++){
      y[i][j]=x[i][j];
    }
  }

  /* Choose each point in turn and make it the north pole note this is what the while loop os for, but have set it to a<2 to just look at first point */

  a=1;
  b=0;
  c=0;

  while(a<2){

  /* Find theta and phi to rotate points by */

  cout << fixed << setprecision(5) << "x[" << a << "][1]=" << x[a][1] << 
  " x[" << a << "][2]=" << x[a][2] << " x[" << a << "][3]=" << x[a][3] << "\n";

  theta=x[a][2]/x[a][3];
  theta=b*PI+atan(theta);

  /* Rotate Points by theta around x axis and then by phi around y axis */

  for(i=1;i<=n;i++){
    x[i][1]=x[i][1];
    x[i][2]=x[i][2]*cos(theta)-x[i][3]*sin(theta);
    x[i][3]=x[i][2]*sin(theta)+x[i][3]*cos(theta);
  }

  phi=x[a][1]/x[a][3];
  phi=c*PI+atan(phi);

  for(i=1;i<=n;i++){
    x[i][1]=x[i][1]*cos(phi)-x[i][3]*sin(phi);
    x[i][2]=x[i][2];
    x[i][3]=x[i][1]*sin(phi)+x[i][3]*cos(phi);
  }

  cout << fixed << setprecision(5) << "x[" << a << "][1]=" << x[a][1] << 
  " x[" << a << "][2]=" << x[a][2] << " x[" << a << "][3]=" << x[a][3] << "\n";

   if(x[a][3]==1.0 && x[a][2]==x[a][3]==0)
    a=a+1;
  else if(b==0 && c==0)
    for(i=1;i<=n;i++){
      for(j=1;j<=3;j++){
        x[i][j]=y[i][j];
        c=1;
      }
    }
  else if(b==0 && c==1)
    for(i=1;i<=n;i++){
      for(j=1;j<=3;j++){
        x[i][j]=y[i][j];
        b=1;
        c=0;
      }
    }
  else if(b==1 && c==0)
    for(i=1;i<=n;i++){
      for(j=1;j<=3;j++){
        x[i][j]=y[i][j];
        c=1;
      }
    }
  else if(b==1 && c==1)
    break;

  }

  energy=0.0;

  for(i=1;i<=n;i++){
    for(j=i+1;j<=n;j++){

      Distance=sqrt(pow(x[i][1]-x[j][1],2)+pow(x[i][2]-x[j][2],2)
                    +pow(x[i][3]-x[j][3],2));
      energy=energy+1.0/Distance;
    }
  }  

  cout << fixed << setprecision(10) << "ENERGY=" << energy << "\n";  
  cout << fixed << setprecision(5) << "x[" << a << "][1]=" << x[a][1] << 
  " x[" << a << "][2]=" << x[a][2] << " x[" << a << "][3]=" << x[a][3] << "\n";

  /* Output to help with gnuin.txt */
  ofstream File4 ("mypoints");
  for(i=1;i<=n;i++){
    File4 << x[i][1] << " " <<   x[i][2] << " " << x[i][3] << "\n";
  }
  File4.close(); 

  return 0;

} 
```

好的，所以这里有很多问题，比如 if 语句（第 103 行）不应该真的有等于 double 的条件，因为它永远不会起作用，但我可以稍后使用间接比较来解决这个问题（一些 epsilon 的东西）。我真正的疑问是为什么旋转即使作用于所有点也会使点脱离球体？（如您所见，这些值已被标准化以使它们都在第 38 行的单位球体上）。

注意：b、c 的东西是检查点是在北极还是南极。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:33:10.247

您的轮换代码有问题。例如：

```
x[i][1]=x[i][1];
x[i][2]=x[i][2]*cos(theta)-x[i][3]*sin(theta);
x[i][3]=x[i][2]*sin(theta)+x[i][3]*cos(theta); 
```

您`x[i][2]`在第 2 行进行修改，然后在第 3 行使用它。您应该对中间结果使用临时存储，以避免在完成引用之前修改值。

第一行是相当多余的，其余的应该看起来更像：

```
double new_y, new_z;
new_y=x[i][2]*cos(theta)-x[i][3]*sin(theta);
new_z=x[i][2]*sin(theta)+x[i][3]*cos(theta);
x[i][2] = new_y;
x[i][3] = new_z; 
```

（显然在你执行这样的计算的地方这样做）

定位球体的更好方法可能是以与“查看”矩阵相同的方式计算变换矩阵。在查看矩阵中，框架被旋转以将某个向量与 z 轴对齐。在您的情况下，您可能希望沿 y 轴对齐，但原理是相同的。

我还要评论您似乎忽略了数组中的第 0 个元素......恕我直言，这是一个坏习惯 - 您应该习惯数组从零开始的事实。迟早你会得到错误的索引，或者你将不得不与其他人的代码交互。

# sql - 主键是复合时的 SQL Server 搜索算法是什么

> ID：14467439
> 
> 赞同：-3
> 
> 时间：2013-01-22T20:29:47.767
> 
> 标签：sql, sql-server, performance, algorithm, binary-search-tree

我们知道最好的搜索算法是[二叉搜索树](http://en.wikipedia.org/wiki/Binary_search_tree)。考虑一个复合表中的主键。SQL Server 是否`BST`用于数据搜索？如果是，它如何搜索多个列`BST`？如果它不使用它使用`BST`什么其他算法剂量？该算法的[时间复杂度](http://en.wikipedia.org/wiki/Time_complexity)是多少？

请分享你知道的任何东西:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:46:39.757

它使用完全相同的算法，具有完全相同的复杂性。

想象一下，您有一个字段 PK，其值为“A”、“B”、“C”等等——没问题，对吧？

现在想象这些键是“AA”、“BB”、“CC”等等——没问题，对吧？这只是一个两个字符的键。

与“A”相比，复合 PK 就像“AA” - 从概念上讲。如果您的 PK 跨越两个值为“A”和“B”的 1 字符列，则可以将您的键与单列值“AB”进行比较。

简单地说，您的关键比较现在比较 X 字段，而不仅仅是一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:46:21.250

树搜索依赖于键的抽象概念。密钥需要与其他密钥具有可比性，仅此而已。搜索算法不需要知道键是否由多个字段组成。它只知道密钥是可比的。

# vb.net - 克隆一个列表（类）

> ID：14467442
> 
> 赞同：6
> 
> 时间：2013-01-22T20:30:04.973
> 
> 标签：vb.net, list, class, clone, icloneable

我已经阅读了一些内容，但似乎无法理解在我的 VB2010 项目中克隆 List(of class) 的最佳方法是什么。我有三个像这样相关的类

```
Public Class City
    'here are many fields of type string and integer
    Public Roads As New List(Of Road)
End Class
Public Class Road
    'here are many fields of type string and integer
    Public Hazards As New List(Of Hazard)
End Class
Public Class Hazard
    Implements ICloneable

    'here are many fields of type string and integer and double
    Public Function Clone() As Object Implements System.ICloneable.Clone
        Return Me.MemberwiseClone
    End Function
End Class 
```

因此，假设我有一个正在开发的城市，在某些情况下，我想创建一条道路及其危险，然后添加另一条道路，但使用先前的道路危险作为起点，然后调整字段.

```
Dim rd As New Road
'add road fields

dim hz1 as New Hazard
'add hazard fields
dim hz2 as New Hazard
'add hazard fields

'add the hazard objects to the road
rd.Hazards.Add(hz1)
rd.Hazards.Add(hz2)

'add the road to the city
myCity.Roads.Add(rd)

'here I want to start a new road based on the old road
Dim rdNew As New Road

'copy or clone the hazards from old road
rdNew.Hazards = rd.Hazards '<============

'over-write some of the hazard fields
rdNew.Hazards(0).Description = "temp" 
```

所以我知道复制一个类将复制指针而不是内容。我在危险类中使用了 ICloneable 接口，但不能说我使用正确。Hazards 变量是 Hazard 类别的列表。我将如何克隆该课程？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-22T20:38:31.063

实现`IClonable`并不意味着它取代了常规赋值，它仍然只是复制引用。而且您甚至没有复制项目，而是在复制列表，这意味着您仍然只有一个列表，但是对它的两个引用。

要使用该`Clone`方法，您必须为列表中的每个项目调用它：

```
rdNew.Hazards = rd.Hazards.Select(Function(x) x.Clone()).Cast(Of Hazard).ToList() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-27T16:12:45.810

```
Imports System.IO
Imports System.Xml.Serialization        

 Public Function CopyList(Of T)(oldList As List(Of T)) As List(Of T)

            'Serialize
            Dim xmlString As String = ""
            Dim string_writer As New StringWriter
            Dim xml_serializer As New XmlSerializer(GetType(List(Of T)))
            xml_serializer.Serialize(string_writer, oldList)
            xmlString = string_writer.ToString()

            'Deserialize
            Dim string_reader As New StringReader(xmlString)
            Dim newList As List(Of T)
            newList = DirectCast(xml_serializer.Deserialize(string_reader), List(Of T))
            string_reader.Close()

            Return newList
        End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-01T19:42:10.317

我知道这是旧的。

```
rdNew.Hazards = rd.Hazards.ToList() 
```

即使它已经是一个列表，ToList 也会基于它创建一个新列表。

在 VB 2019 中，这将创建一个*浅拷贝*，但这在某些情况下很有用。这意味着列表是新的，但两者的元素都`rd.Hazards`指向`rdNew.Hazards`同一个东西。

如果您编辑任何特定的危险，更改将在两者中看到。

如果您将危害添加到一个列表，则另一个列表将没有它。

如果您从一个列表中删除危害，则另一个列表仍将包含它。

如果 Hazard 是原始类型（如字符串或整数），则编辑项目不会反映在其他列表中。

# php - 正则表达式查找并替换为 preg_match_all

> ID：14467449
> 
> 赞同：1
> 
> 时间：2013-01-22T20:30:37.880
> 
> 标签：php, regex

我对这个有点盲目，试图使用 preg_match_all 来查找放置在哈希之间的文本

```
##START of the text##
the text <b>starts</b> here etc
##END of the the text##
##START of the text 2##
Other version stringtext <b>starts</b> here etc
##END of the the text 2## 
```

无论我尝试什么，一次我得到`of the text`，另一次只在哈希之间，有人可以帮助我使用正则表达式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:40:43.937

```
$string = '##START of the text##
the text <b>starts</b> here etc
##END of the the text##
##START of the text 2##
Other version stringtext <b>starts</b> here etc
##END of the the text 2##';

preg_match_all('/##START.+?##[\n](.+?)##END/s', $string, $matches);
// look for any characters between ##START and ##END, 's' will make it match newlines as well

print_r($matches[1]); 
```

将输出：

```
Array
(
    [0] => the text <b>starts</b> here etc

    [1] => Other version stringtext <b>starts</b> here etc

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T08:48:07.713

```
$str = '##START of the text##
the text <b>starts</b> here etc
##END of the the text##
##START of the text 2##
Other version stringtext <b>starts</b> here etc
##END of the the text 2##';

preg_match_all( '~##(.+)##~', $str, $matches ); 
```

print_r( $matches ) 屈服于：

```
Array ( [0] => START of the text [1] => END of the the text [2] => START of the text 2 [3] => END of the the text 2 ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:36:03.613

我对正则表达式不太好，但这是我的解决方案，我不匹配以哈希开头的行，^ 用于行开头，(?!#) 是负前瞻寻找# 字符，m 修饰符用于多-线。

```
$string = <<<EOD
##START of the text##
the text <b>starts</b> here etc
##END of the the text##
##START of the text 2##
Other version stringtext <b>starts</b> here etc
##END of the the text 2##
EOD;

preg_match_all('~^(?!#).*~m',$string,$match);
echo "<pre>";
print_r($match); 
```

正如我所说，我是正则表达式的新手，所以如果我错了，专家会警告我。

# java - 使用 jsoup 获取谷歌结果时出现 403 错误

> ID：14467459
> 
> 赞同：6
> 
> 时间：2013-01-22T20:31:46.080
> 
> 标签：java, jsoup, http-status-code-403

我正在尝试使用以下代码获取 Google 结果：

```
Document doc = con.connect("http://www.google.com/search?q=lakshman").timeout(5000).get(); 
```

但我得到了这个例外：

```
org.jsoup.HttpStatusException: HTTP error fetching URL. Status=403,URL=http://www.google.com/search?q=lakshman 
```

403 错误意味着服务器禁止访问，但我可以在 Web 浏览器中加载此 URL。为什么 Jsoup 会出现 403 错误？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2014-03-18T02:44:52.660

您只需将 UserAgent 属性添加到 HTTP 标头，如下所示：

```
Jsoup.connect(itemUrl)
     .userAgent("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.152 Safari/537.36")
     .get() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-12-16T22:01:25.250

谷歌不允许机器人，你不能用jsoup连接谷歌。您可以使用[Google Web Search API（已弃用）](https://developers.google.com/web-search/docs/)，但您每天可以提出的请求数量将受到限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-10T22:10:14.807

实际上，您可以通过添加用户代理来规避 403 错误

```
doc = Jsoup.connect(url).timeout(timeout)
                    .userAgent("Mozilla") 
```

但这违反了我认为的谷歌政策。

编辑：谷歌捕捉机器人的速度比你想象的要快。但是，您可以将其用作临时解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-23T23:11:18.407

试试这个：

```
Document doc =con.connect("http://www.google.com/search?q=lakshman").ignoreHttpErrors(true).timeout(5000).get(); 
```

万一 userAgent 不起作用就像它不适合我一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-29T21:13:48.000

在某些情况下，您需要设置推荐人。它对我的情况有所帮助。

完整的来源[在这里](https://www.javacodeexamples.com/jsoup-set-referrer-example/765)

```
 try{

        String strText = 
                Jsoup
                .connect("http://www.whatismyreferer.com")
                .referrer("http://www.google.com")
                .get()
                .text();

        System.out.println(strText);

    }catch(IOException ioe){
        System.out.println("Exception: " + ioe);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-29T20:00:33.953

替换语句

```
Document doc =con.connect("http://www.google.com/search?q=lakshman").timeout(5000).get(); 
```

与声明

```
Document doc=Jsoup.connect("http://www.google.com/search?q=lakshman").userAgent("Chrome").get(); 
```

# java - ArrayList.remove(int) vs ArrayList.remove(Object) 在不同的线程

> ID：14467464
> 
> 赞同：1
> 
> 时间：2013-01-22T20:31:52.783
> 
> 标签：java, android, multithreading, list, arraylist

我有一个 Minion 对象的 ArrayList，当盾牌与 Minion 碰撞时，我想从 ArrayList 中删除该 Minion。但是，我只能让它以一种方式工作，而不能以另一种方式工作。谁能解释一下为什么？

在所有 3 种情况下，我都使用 Android 的 Renderer 的 onDrawFrame() 方法......所以我无法控制它何时被调用。但这是所有 3 种方式的代码：

方法一：（无效）

```
public void onDrawFrame(GL10 gl) {
    List<Integer> indexesToRemove = new ArrayList<Integer>();
    int len = minions.size();
    for(int i=0; i<len; i++){
        if( OverlapTester.overlapCircleRectangle( (Circle)shield1.bounds,  (Rectangle)minions.get(i).bounds) ){ //this tests out to work just fine
            indexesToRemove.add(i);
        }
    }
    for(int i=indexesToRemove.size()-1; i>=0; i--){
        minions.remove(indexesToRemove.get(i)); //<------ why doesn't this work?
    }
} 
```

问题是最后一行`minions.remove(indexesToRemove.get(i));`实际上并没有删除奴才。它确实被调用，具有适当的索引。我已经通过调试器，直接运行它，并且 arraylist 根本没有修改。为什么是这样？实际上，在调试器中，该行“minions.remove(indexesToRemove.get(i));” 被称为数十亿次。

方法二：（还是不行）

```
public void onDrawFrame(GL10 gl) {
    synchronized(minions){
        List<Integer> indexesToRemove = new ArrayList<Integer>();
        int len = minions.size();
        for(int i=0; i<len; i++){
            if( OverlapTester.overlapCircleRectangle( (Circle)shield1.bounds,  (Rectangle)minions.get(i).bounds) ){ //this tests out to work just fine
                indexesToRemove.add(i);
            }
        }
        for(int i=indexesToRemove.size()-1; i>=0; i--){
            minions.remove(indexesToRemove.get(i)); //<------ why doesn't this work?
        }
    }
} 
```

在这里，我想......“哦，也许因为它不完全同步，drawFrame有时被调用太多次并且在错误的时间访问arraylist，我需要锁定它。但它仍然不起作用。再次,该行`minions.remove(indexesToRemove.get(i));`被正确的索引正确调用,但实际上并没有删除对象.我正在看着我的盾牌在屏幕上猛烈撞击奴才,奴才没有任何反应(它没有从数组列表中删除)

方法#3（这确实有效）

```
public void onDrawFrame(GL10 gl) {
    ArrayList<Minion> colliders = new ArrayList<Minion>(minions);
    int len = colliders.size();
    for(int i=0; i<len; i++){
        GameObject collider = colliders.get(i);
        if(OverlapTester.overlapCircleRectangle((Circle)shield1.bounds, (Rectangle)collider.bounds)){
            minions.remove(collider); // <---- why does THIS work instead?
        }
    }
} 
```

此代码完美运行。盾牌击打仆从，仆从倒地死亡。正如您在此处看到的，唯一的区别是我使用的是重载`ArrayList.remove(object)`方法而不是按索引删除。如行中`minions.remove(collider);`。为什么这行得通？

谁能解释一下？

附带说明一下，除了存储arraylist的另一个实例变量副本之外，还有更好的管理方法`ArrayList<Minion> colliders = new ArrayList<Minion>(minions);`吗？

注意：Shield 和 Minion 都是以矩形为边界的常规 Java 对象。所有这些数学检查都很好。我已经在调试器中对其进行了测试，并且碰撞检测是准确的。我也在更新`onDrawFrame()`方法中准确的边界/位置。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T20:36:22.177

因为`ArrayList`提供了两种方法：

```
public E remove(int index)
public boolean remove(Object o) 
```

当您调用 时`minions.remove(indexesToRemove.get(i))`，因为`indexesToRemove`is a `List<Integer>`，调用绑定到您通过直接指定对象来删除元素的第二个签名，自动拆箱不会将您`Integer`变成 a ，`int`因此找不到该元素并且没有任何反应。

尝试：`minions.remove((int)indexesToRemove.get(i))`以便正确应用方法的静态绑定。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-22T20:38:44.467

@Jack 的回答是正确的。对于后代，您应该使用可以在循环*内*`Iterator`删除的此处：

 *```
// synchronization wrapper here
Iterator<Minion> iterator = minions.iterator();
while (iterator.hasNext()) {
    Minion minion = iterator.next();
    if( OverlapTester.overlapCircleRectangle(..., minion.bounds)) {
        iterator.remove();
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-22T20:35:45.050

它在第一个两个示例中将 Integer 视为对象 ref，将其转换为 int*

# r - 如何在 igraph 中解释 get.edgelist() 的输出

> ID：14467468
> 
> 赞同：2
> 
> 时间：2013-01-22T20:32:21.430
> 
> 标签：r

我想知道如何在 R中解释`get.edgelist()`命令的输出。`igraph`

例如我生成一个随机图：

```
a=erdos.renyi.game(100,0.5, directed=TRUE)
a=get.edgelist(a) 
```

这给了我两列，我认为第一列代表节点，第二列代表相应的连接。

但情况似乎并非如此，因为某些数字仅在第二列中表示，而不是在第一列中。怎么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:00:39.107

通过创建一个小例子，它可能变得很明显吗？

```
set.seed(45)
g <- erdos.renyi.game(10, 0.5, directed = TRUE)
> get.adjacency(g)
10 x 10 sparse Matrix of class "dgCMatrix"

 [1,] . 1 . 1 . . 1 1 1 1
 [2,] . . . 1 . 1 1 1 1 .
 [3,] 1 1 . 1 . 1 . . 1 .
 [4,] 1 1 . . . . 1 1 1 1
 [5,] . 1 . . . . 1 . . 1
 [6,] . 1 1 1 1 . 1 . . .
 [7,] 1 . 1 . . 1 . . 1 .
 [8,] . 1 1 1 . 1 . . 1 .
 [9,] 1 . 1 1 . 1 . . . 1
[10,] 1 . 1 . 1 1 . . 1 .

edges <- as.data.frame(get.edgelist(g))
edges <- edges[order(edges$V1, edges$V2), ]
> head(edges, 11)
   V1 V2
7   1  2
18  1  4
34  1  7
39  1  8
42  1  9
1   1 10
19  2  4
28  2  6
35  2  7
40  2  8
43  2  9 
```

从邻接矩阵可以看出，从 到 有边`row 1`，`2,4,7,8,9,10`这也反映在从 的输出中`get.edgelist`。它准确地为您提供了邻接矩阵中的内容。

```
> table(edges$V1)
# 1  2  3  4  5  6  7  8  9 10 
# 6  5  5  6  3  5  4  5  5  5 
```

# jquery - 在此导航菜单上使用 jQuery 最接近/同级

> ID：14467473
> 
> 赞同：1
> 
> 时间：2013-01-22T20:32:59.843
> 
> 标签：jquery, navigation, closest, siblings

我有大部分工作 - 单击标题（例如，Business Jet Traveler）时，这些部分会展开。我正在努力解决的是 - 当您展开不同的部分时，然后单击其中一个子链接，我希望 OTHER 部分 - 您刚刚所在的部分 - 折叠并变为非活动状态（没有浅色背景） . 这有意义吗？

[http://jsfiddle.net/velcrobots/B6d35/](http://jsfiddle.net/velcrobots/B6d35/)

我正在尝试使用最接近（）和兄弟姐妹（），但我想我错过了一些东西。有任何想法吗？

HTML：

```
<div id="mk-menu">

        <div class="mk-ribbon"></div>

        <h1><?php print $yr; ?><br/>Media Kits</h1>
        <h2>Advertise With AIN</h2>            

    <div><!-- wrapper to separate menu items for jquery -->

        <div class="mk-menu-item">
            <a class="menu-head" id="ain-menu">Aviation International News</a>
            <ul id="ain-menu-sub" class="mk-submenu">
                <li><a href="#" name="ain-cal">Calendar</a></li>
                <li><a href="#" name="ain-rates">Print Rates</a></li>
                <li><a href="#" name="ain-orates">Online Rates</a></li>
                <li><a href="#" name="ain-specs">Print Specs</a></li>
                <li><a href="#" name="ain-ospecs">Online Specs</a></li>
            </ul>            
        </div>

        <div class="mk-menu-item">
            <a class="menu-head" id="bjt-menu">Business Jet Traveler</a>
            <ul id="bjt-menu-sub" class="mk-submenu">
                <li><a href="#" name="bjt-cal">Calendar</a></li>
                <li><a href="#" name="bjt-rates">Print Rates</a></li>
                <li><a href="#" name="bjt-orates">Online Rates</a></li>
                <li><a href="#" name="bjt-specs">Print Specs</a></li>
                <li><a href="#" name="bjt-ospecs">Online Specs</a></li>
            </ul>            
        </div>

        <div class="mk-menu-item">
            <a class="menu-head" id="cnd-menu">Convention News<br/>Daily Editions</a>
            <ul id="cnd-menu-sub" class="mk-submenu">
                <li><a href="#" name="cnd-cal">Calendar</a></li>
                <li><a href="#" name="cnd-rates">Print Rates</a></li>
                <li><a href="#" name="cnd-orates">Online Rates</a></li>
                <li><a href="#" name="cnd-specs">Print Specs</a></li>
                <li><a href="#" name="cnd-ospecs">Online Specs</a></li>
            </ul>            
        </div>

        <div class="mk-menu-item">
            <a class="menu-head" id="and-menu">Airshow News<br/>Daily Editions</a>
            <ul id="and-menu-sub" class="mk-submenu">
                <li><a href="#" name="and-cal">Calendar</a></li>
                <li><a href="#" name="and-rates">Print Rates</a></li>
                <li><a href="#" name="and-orates">Online Rates</a></li>
                <li><a href="#" name="and-specs">Print Specs</a></li>
                <li><a href="#" name="and-ospecs">Online Specs</a></li>
            </ul>            
        </div>

        <div class="mk-menu-item">
            <a class="menu-head" id="enews-menu">Emailed Newsletters</a>
            <ul id="enews-menu-sub" class="mk-submenu">
                <li><a href="#" name="enews-rates">Rates</a></li>
                <li><a href="#" name="enews-specs">Specs</a></li>
            </ul>            
        </div>

      </div><!-- end wrapper div to separate for jquery -->  

        <div class="mk-ribbon-end"></div>

    </div><!-- end #mk-menu --> 
```

CSS：

```
#mk-menu {color:#FFF; background:#556B80; float: left; margin-top: -39px; position: relative; width: 204px; font-family: Verdana,Geneva,sans-serif; padding-bottom:20px}
.mk-ribbon {height:18px; width:25px; background:url(http://www.ainonline.com/sites/all/themes/ain_core/images/mk-ribbon.png) no-repeat; position:absolute; right:-25px}
.mk-ribbon-end {width:204px; height:51px; background:url(http://www.ainonline.com/sites/all/themes/ain_core/images/mk-ribbon-end.png) no-repeat; position:absolute; bottom:-51px}
#mk-menu h1 {font-family: Georgia, "Times New Roman", Times, serif;border-bottom: 1px solid #FFF; font-size: 25px; font-weight: bold; line-height: 32px; margin: 40px 15px 0; text-align: center; text-transform: uppercase;}
#mk-menu h2 {font-family: Georgia, "Times New Roman", Times, serif;font-size: 12px; margin: 6px 0 35px; text-align: center; text-transform: uppercase;}
a.menu-head {color: #FFF; display: block; font-size: 10px; margin: 10px 5px 0; padding: 5px; text-transform: uppercase; line-height:12px}
a.mk-selected, a.menu-head:hover {background: #6E8193; line-height:12px}
a.menu-head:hover {cursor:pointer; color:#FFF !important}
#mk-menu ul {font-size: 14px; margin: 10px 0 15px 60px;}
#mk-menu li {font-size: 12px; line-height: 16px;}
#mk-menu li a {color:#FFF; text-decoration:none}
#mk-menu li:hover, #mk-menu li a:hover, #mk-menu li.active {list-style:disc; font-weight:bold; color:#FFF !important}
.mk-submenu {display:none} 
```

jQuery：

```
jQuery(document).ready(function(){

jQuery(".menu-head").click(function (a) {
    var myid = jQuery(this).attr("id");
    jQuery("#"+myid+"-sub").slideToggle(100);
    jQuery(this).toggleClass("mk-selected");
    a.preventDefault();
    });

jQuery(".mk-submenu li").click(function (b) {
    jQuery(".mk-submenu li").removeClass("active");
    jQuery(this).addClass("active");
    b.preventDefault();
    });

jQuery(".mk-submenu li a").click(function (c) {
    jQuery(this).closest(".mk-menu-item").siblings().removeClass("mk-selected");
    var myname = jQuery(this).attr("name");
    jQuery(".mk-section").hide();
    jQuery("#"+myname).show();
    c.preventDefault();
    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:45:49.953

改变这个 -

```
jQuery(".mk-submenu li a").click(function (c) {
        var myname = jQuery(this).attr("name");
        jQuery(this).closest(".mk-menu-item").siblings().removeClass("mk-selected");
        jQuery(".mk-section").hide();
        jQuery("#"+myname).show();
        c.preventDefault();
        }); 
```

对此——

```
jQuery(".mk-submenu li a").click(function (c) {
        var myname = jQuery(this).attr("name");
        jQuery(this).parents('.mk-menu-item').siblings().find('.mk-submenu:visible').slideToggle();
        jQuery(".mk-section").hide();
        jQuery("#"+myname).show();
        c.preventDefault();

        }); 
```

[http://jsfiddle.net/B6d35/8/](http://jsfiddle.net/B6d35/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:50:53.603

您需要搜索兄弟姐妹并使用`.slideUp()`方法

试试这个

```
jQuery(".menu-head").click(function (a) {
        var myid = jQuery(this).attr("id");
        jQuery("#" + myid + "-sub").slideToggle(100);
        jQuery(this).toggleClass("mk-selected");
        jQuery(this).closest('.mk-menu-item').siblings().find('ul.mk-submenu').removeClass('mk-selected').slideUp();
        a.preventDefault();
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:00:11.260

您需要搜索兄弟姐妹并使用`.slideUp()`方法

试试这个

```
jQuery(".menu-head").click(function (a) {
        var myid = jQuery(this).attr("id");
        jQuery("#" + myid + "-sub").slideToggle(100);
        jQuery(this).toggleClass("mk-selected");
        jQuery(this).closest('.mk-menu-item').siblings().find('ul.mk-submenu').removeClass('mk-selected').slideUp();
        a.preventDefault();
    }); 
```

**[检查小提琴](http://jsfiddle.net/B6d35/12/)**

# asp.net-mvc - 从 ASP MVC3 下拉列表中获取所选项目

> ID：14467479
> 
> 赞同：0
> 
> 时间：2013-01-22T20:33:32.663
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在尝试使用控制器下拉列表中的选定项目，但没有任何运气。我单步执行了代码，可以看到每个字符串值在分配后都是“null”。

以下是视图中的代码

```
<span id="searchBox" class="boxMe" >
      <select id="Table" title="Table" style="font-size:8pt;">
        <option value="default">--Table Name--</option>
        <option value="CE">CE</option>
        <option value="PT">PT</option>
      </select>
      <select id="IssueType" style="font-size:8pt;">
        <option value="default">--Issue Type--</option>
        <option value="W">Warning</option>
        <option value="E">Error</option>
      </select>
      <select id="Status" style="font-size:8pt;">
        <option value="default">--Status Type--</option>
        <option value="O">Open</option>
        <option value="U">Under Review</option>
      </select>

    <input type="image" src="@Url.Content("~/Content/Images/Filter.bmp")" alt="Filter" style="padding-top: 0px;" />
    <a href="#" style="padding-left: 30px;"></a>
</span> 
```

这就是我在控制器中的内容。由于这是一个搜索过滤器，我目前在 Index() 方法中有这个。

```
 public ViewResult Index(FormCollection dropDownSelection)
    {
        string table = dropDownSelection["Table"];
        string issue = dropDownSelection["IssueType"];
        string status = dropDownSelection["Status"];

        return View(db.FollowUpItems.ToList());
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:41:03.717

您应该在标签`name`上使用该属性`<select>`，而不是`id`. 这`name`是表单帖子中用作键的内容：

```
<select name="Table" title="Table" style="font-size:8pt;"> 
```

如果您还没有，您还应该将输入包装在`<form>`标签中：

```
<span ...>
    <form method="post">
        <!-- Inputs -->
    </form>
</span> 
```

# database-connection - 使用 Apache DBCP 进行连接池

> ID：14467480
> 
> 赞同：25
> 
> 时间：2013-01-22T20:33:32.913
> 
> 标签：database-connection, apache-commons-dbcp

我想使用[Apache Commons DBCP](http://commons.apache.org/dbcp/)在 Java 应用程序中启用连接池（这里没有容器提供的数据源）。在 Web 的许多站点（包括[Apache 站点](http://svn.apache.org/viewvc/commons/proper/dbcp/trunk/doc/BasicDataSourceExample.java?view=markup)）中，该库的使用基于以下代码段：

```
BasicDataSource ds = new BasicDataSource();
ds.setDriverClassName("oracle.jdbc.driver.OracleDriver");
ds.setUsername("scott");
ds.setPassword("tiger");
ds.setUrl(connectURI); 
```

然后你通过 getConnection() 方法获得你的数据库连接。但在其他站点上 - 以及[Apache 站点也是](http://svn.apache.org/viewvc/commons/proper/dbcp/trunk/doc/PoolingDataSourceExample.java?view=markup)- Datasource 实例是通过以下方式创建的：

```
ConnectionFactory connectionFactory = new DriverManagerConnectionFactory(connectURI,null);
PoolableConnectionFactory poolableConnectionFactory = new PoolableConnectionFactory(connectionFactory);
ObjectPool objectPool = new GenericObjectPool(poolableConnectionFactory);
PoolingDataSource dataSource = new PoolingDataSource(objectPool); 
```

他们之间有什么区别？我正在使用连接池`BasicDataSource`，或者我需要一个实例`PoolingDataSource`来使用连接池？是`BasicDataSource`线程安全的（我可以将它用作类属性）还是我需要同步它的访问？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-09-02T12:45:47.537

这更像是对 ivi 上述答案的（大）支持评论，但由于需要添加快照，因此将其发布为答案。

> BasicDataSource 是满足基本需求的一切。它在内部创建一个 PoolableDataSource 和一个 ObjectPool。

我想查看 BasicDataSource 中的代码来证实该陈述（事实证明这是真的）。我希望以下快照对未来的读者有所帮助。

* * *

当第一次执行 a 时会发生以下情况 `basicDatasource.getConnection()`。第一次围绕 DataSource 创建如下：

![在此处输入图像描述](../Images/969326d1f9a26ab602c8e3a9edd899f6.png)

* * *

1.  这是原始的连接工厂。

2.  这是在其余步骤中使用的通用对象池 ('connectionPool')。 ![在此处输入图像描述](../Images/b7dd9cdcb7d125e2e155e41bdd94c8ec.png)

3.  这结合了上述两个（connectionFactory + 一个 Object Pool）来创建一个 PoolableConnectionFactory。
    ![在此处输入图像描述](../Images/51b6dcd1859ecaebf2cd8f411cb5805a.png)

    值得注意的是，在创建 PoolableConnectionFactory 期间，connectionPool 与 connectionFactory 链接，如下所示：
    ![在此处输入图像描述](../Images/7a9d22584ee722ce7695ed21cf42e2a2.png)

4.  最后，从 connectionPool 创建一个 PoolingDataSource
    ![在此处输入图像描述](../Images/1d99c59c798f85500fbab6e4d4f785d9.png)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-01-22T21:19:43.587

BasicDataSource 是满足基本需求的一切。它在内部创建一个 PoolableDataSource 和一个 ObjectPool。

PoolableDataSource 使用提供的 ObjectPool 实现 DataSource 接口。PoolingDataSource 负责连接，而 ObjectPool 负责持有和计数这个对象。

我建议使用 BasicDataSource。只是，如果你真的需要一些特别的东西，那么你可以将 PoolingDatasource 与 ObjectPool 的另一个实现一起使用，但这将是非常罕见和具体的。

BasicDataSource 是线程安全的，但您应该注意使用适当的访问器，而不是直接访问受保护的字段以确保线程安全。

# java - 如何在屏幕点击时删除 GWT 菜单栏？

> ID：14467481
> 
> 赞同：3
> 
> 时间：2013-01-22T20:33:33.723
> 
> 标签：java, events, gwt, menubar

我是使用 GWT 的初学者。我有一个`menubar`弹出窗口`Label click`。当用户单击屏幕上的任何位置（导致它显示的标签除外）时，我需要将其删除（合法）我尝试了各种方法，例如将这个事件连接到

`RootPanel.get().addDomHandler(clickDetectHandler, ClickEvent.getType());`

```
public void onClick(ClickEvent event) {
            Object source = event.getSource();
            if (!(source instanceof MenuBar))
                  panel.remove(menu); 
```

![在此处输入图像描述](../Images/d3dd9ebb20454e53db8d9ee7cc7b8dbf.png)

我什至尝试使用，`MouseOutEvent`但它没有检测到点击。我可以通过单击返回将其删除`legal label`。但是我需要在检测到屏幕上的点击时将其删除。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:42:40.813

GWT 有一个名为 PopupPanel 的面板，它会自动准确地处理您想要的行为。引用javadoc：

*“PopupPanel 的构造函数将 'auto-hide' 作为其布尔参数。如果设置了此项，则当用户在其外部单击时，面板会自动关闭。”*

是否可以在 PopupPanel 内显示弹出菜单？

[http://google-web-toolkit.googlecode.com/svn/javadoc/2.5/com/google/gwt/user/client/ui/PopupPanel.html](http://google-web-toolkit.googlecode.com/svn/javadoc/2.5/com/google/gwt/user/client/ui/PopupPanel.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-22T23:32:03.257

看看[这个](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwMenuBar)GWT 示例。这似乎有你描述的行为。它带有源代码。

或者，您可以尝试处理菜单小部件上的[模糊事件。](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/event/dom/client/BlurEvent.html)

# android - 如何在 Android 中定位 ListView？

> ID：14467485
> 
> 赞同：1
> 
> 时间：2013-01-22T20:33:45.697
> 
> 标签：android, android-layout, android-listview

我想`ListView`在我的活动顶部放一个，在底部放一些其他的东西而不`ListView`“吞下”底部的小部件？我试过这个（“其他东西”是一个`RelativeLayout`带有一个按钮的），但它不起作用。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="bottom" >

    </ListView>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="fill_parent"
        android:layout_gravity="bottom" >

        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:text="Button" />

    </RelativeLayout>

</LinearLayout> 
```

[我在这里](http://thinkandroid.wordpress.com/2010/01/14/how-to-position-views-properly-in-layouts/)寻找了一些提示，非常有用，但没有说任何关于`ListView`s 的内容。我可以`ListView`毫无问题地将小部件放在 a 上方，但不能放在下方。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T20:38:34.460

使用 RelativeLayout 作为根布局，然后将 ListView 与`layout_above`Button 与`layout_alignParentBottom`：

```
<RelativeLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ListView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_above="@+id/button" >

    <Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:text="Button" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:38:32.540

我敢肯定这已经在SO上回答了好几次......

像这样改变你的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:layout_gravity="bottom" >

    </ListView>

    <RelativeLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="bottom" >

        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:text="Button" />

    </RelativeLayout>

</LinearLayout> 
```

# python - Django 时间日期模型

> ID：14467486
> 
> 赞同：1
> 
> 时间：2013-01-22T20:33:46.267
> 
> 标签：python, django

对于只应包含日期和月份的模型，最佳字段类型/字段选项是什么。

```
class Reminder(models.Model):
    person = models.OneToOneField(Person)
    reminder_one = models.???
    reminder_two = models.??? 
```

因为我想输入一个每年作为提醒的日期，所以我想确保没有输入年份。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:12:04.090

只有两个标准的 Django 日期字段-

`DateField` `DateTimeField`

我建议您使用 datefield 并使用默认查询集按月和日排序：

[查询集 - 月](https://docs.djangoproject.com/en/dev/ref/models/querysets/#month)

否则，您将需要将月份和日期存储为字符串，这会变得混乱并且是不必要的。

# magento - 请求的 URL 的长度超过了此服务器的容量限制

> ID：14467489
> 
> 赞同：0
> 
> 时间：2013-01-22T20:33:55.620
> 
> 标签：magento

该错误出现在我的自定义网格上，我在其中为所有记录（超过 3000 条）“全选”并尝试转到下一个网格页面。如我所见，我所有的 IDS 都设置为 URL 的 internal_import 参数

```
/internal_import_ids/1,2,3,4,5,6,7,8,... 
```

如何将此 internal_import_ids 放到 POST 中，而不是放到 URL 中？

在 massaction 部分中声明的 internal_import_ids

```
...
$this->getMassactionBlock()->setFormFieldName('import_ids');
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:35:37.590

[这里有一个线程]关于最大URL长度。（[不同浏览器中URL的最大长度是多少？](https://stackoverflow.com/questions/417142/what-is-the-maximum-length-of-a-url)）

> 简短回答 - 事实上限制为 2000 个字符。

以下是Boutell在其常见问题解答中“URL 的最大长度是多少？”标题下的[更多信息：](http://www.boutell.com/newfaq/misc/urllength.html)

> 极长的 URL 通常是一个错误。超过 2,000 个字符的 URL 将无法在最流行的网络浏览器中使用。如果您打算让您的网站为大多数 Internet 用户服务，请不要使用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:07:44.033

我发现的解决方案之一是使用 AJAX。使用 AJAX Grid 可以很好地工作。

```
public function __construct()
{
    ...
    $this->setUseAjax(true);
} 
```

所以，我的问题解决了。但是，如果有人会在没有 AJAX 的情况下找到解决方案 - 很高兴看到它。

# clojure - 如何在 Clojure + Compojure + Ring Web 应用程序中重用/包含现有的 java servlet 和过滤器？

> ID：14467491
> 
> 赞同：1
> 
> 时间：2013-01-22T20:34:05.737
> 
> 标签：clojure, leiningen, compojure, ring

我有一堆 Java EE 工件，例如 gzip servlet 过滤器、文件上传 servlet 等，这些都可以，我想在基于 Compojure 和 Ring 的 Clojure Web 应用程序中重用它们。

这可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:08:25.010

Compojure 所在的 Ring 生成一个 servlet，然后您可以将其与您的 tomcat 配置中的其余 servlet 线程化。**Ring+Compujure servlet 与您的其他 servlet 是对等**的，其他 servlet 不需要知道 Clojure 参与其中。“缺点”是它们只能在 servlet 级别进行组合，在我看来这不如中间件等组合在 Ring 中与其他中间件和 Compojure 等框架组合。

# ruby - 在 Ruby 中动态查找包含当前文件的文件

> ID：14467495
> 
> 赞同：0
> 
> 时间：2013-01-22T20:34:24.720
> 
> 标签：ruby, dependency-management

**语境**

我通过自动要求目录结构中的所有文件

```
# base.rb
dir = File.dirname(__FILE__)
path = File.join(dir, '**', '*.rb')
Dir[path].each { |file| require File.expand_path(file, __FILE__) } 
```

`require`并通过单独文件中的语句调用此代码段， `api.rb`.

**问题**

此代码片段包括其自身 ( `base.rb`) 以及`api.rb`.

**问题**

是否有一种“干净”的方式来执行这种类型的自动要求，同时动态避免包含调用自动要求的文件（即`api.rb`）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:51:00.323

请记住，当您`require`通过某个路径多次识别文件时，每个后续调用都`require`将返回`false`，并且不会重新评估该文件。因此，如果您的`base.rb`（即`require`其他所有内容）本身就是`require`d，则进一步尝试`require`它不应导致重新评估。

让我们用一个例子来演示它。创建一个`lib`包含 3 个文件的目录。

```
# lib/a.rb

  require 'base'
  puts :a

# lib/b.rb

  require 'base'
  puts :b

# lib/base.rb

  $counter ||= 0
  puts "Evaluated base.rb #{$counter += 1} times"
  dir = File.dirname(__FILE__)
  path = File.join(dir, '**', '*.rb')
  Dir[path].each { |file| require File.expand_path file } 
```

直接执行`lib/base.rb`。`base.rb`将被评估两次：首先，当它直接执行时；其次，当它是`require`d 时`a.rb`。请注意，当它*需要*从`b.rb`.

```
$ ruby -I lib lib/base.rb 
Evaluated base.rb 1 times
Evaluated base.rb 2 times
a
b 
```

比较`require`一下。Now`base.rb`只评估一次，因为尝试在`require`它`a.rb`之前使用命令行开关`b.rb`让文件d 进入它。`require``-r`

```
$ ruby -I lib -r base -e 'puts :ok'
Evaluated base.rb 1 times
a
b
ok 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T01:09:14.367

[Kernel.caller](http://www.ruby-doc.org/core-2.0/Kernel.html#method-i-caller) 以字符串数组的形式返回当前执行堆栈。您可以避免对在该数组中找到的文件名调用 require。具有相同基本名称的多个文件会导致此问题。我看不到获得更精确的祖先文件列表的方法。

```
$ head *.rb
==> A.rb <==
require 'base'
puts :A

==> B.rb <==
require 'base'
puts :B

==> CA.rb <==
require 'base'
puts :CA

==> base.rb <==
dir = File.dirname(__FILE__)
path = File.join(dir, '**', '*.rb')
required = caller.map { |frame| /^(.+):\d+:in `require'$/.match(frame) and File.basename $1 }.compact
Dir[path].each { |file| required.include?(File.basename file) or require File.expand_path file }
$ ruby A.rb
B
CA
A
$ ruby B.rb
A
CA
B
$ ruby CA.rb
A
B
CA
$ ruby base.rb
B
CA
A
$ 
```

# ruby-on-rails - 如何从任何控制器提交表单 - Rails？

> ID：14467505
> 
> 赞同：2
> 
> 时间：2013-01-22T20:35:16.450
> 
> 标签：ruby-on-rails, rails-activerecord

我想在我网站的每个页面的页脚中放置一个简单的电子邮件注册表单。所以我创建了一个订阅脚手架并做了以下部分：

```
<%= form_for @subscription, :url => {:controller => 'subscriptions', :action => 'create'} do |f| %>
 <div class="input-append">
   <%= f.text_field(:email, :id => "appendedInputButton", :placeholder => 'Subscribe', :class => 'span4') %><button class="btn" type="submit" name="commit">Subscribe</button>
 </div>
<% end %> 
```

但是，尽管指定了控制器和操作，但我收到以下错误：

```
undefined method `model_name' for NilClass:Class 
```

该表单在订阅/新页面上工作正常，但我如何制作它以便我可以从任何控制器和任何页面提交表单，而不必在任何地方定义 @subscription？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:52:28.997

最简单的事情就是简单地改变：

```
<%= form_for @subscription ... 
```

到：

```
<%= form_for Subscription.new ... 
```

而且，就像已经指出的那样，我怀疑您需要 url 选项。

# java - 将 Eclipse 与 Subversion 和 Maven 一起使用

> ID：14467507
> 
> 赞同：0
> 
> 时间：2013-01-22T20:35:16.517
> 
> 标签：java, eclipse, svn, maven

我正在尝试为我的项目使用 Eclipse、Subversion 和 Maven，每个人都告诉我永远不要签入以下文件：

```
target/
.classpath
.project
.settings 
```

但是，如果我不签入它们并且其他一些项目从 Eclipse 中签出该项目，Eclipse 不知道它是什么类型的项目。我们做错了什么吗？

你如何工作的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T20:38:01.233

Eclipse 有一个 Maven 插件；我相信它被称为m2eclipse。安装后，您可以选择 Import from Maven project 并选择`pom.xml`将您的项目导入到 Eclipse 的选项，即使它`.project`不`.settings`存在。因此，您无需将它们提交给 svn。这带来了 IDE 中立性的优势；您团队的其他成员可以毫无顾虑地使用 Intellij IDEA 或 NetBeans。

Maven还有一个eclipse插件；你可以去哪里`pom.xml`，打开一个终端并输入`mvn eclipse:eclipse`，它会自动生成`.project`和`.settings.`。但是更推荐第一个选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:41:44.427

我对 eclipse、maven 和 git 有同样的问题，所以也许它对你有帮助：

1.  尝试在 svn 中设置你的 repo 并检查它，但不要导入它。
2.  您必须通过 File -> Import -> Existing Maven Project 将项目导入您的工作区。
3.  最后一步是分享项目。右键单击 -> 团队 -> 共享 -> SVN -> 并将现有的设置为 repo。

这就是我在 Eclipse 中处理这个问题的方式。希望它足够清楚？顺便说一句，您不应该签入这些文件，因为类路径等在其他机器上可能会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T20:41:49.523

我签入 .classpath 和 .project 但不经常签入。您必须确保从事该项目的每个人都拥有足够接近的 eclipse 版本（包括包含的特定插件和 eclipse 功能）。有时，如果您确保几乎没有人签入这些文件，并且每个人都只是比较并在更新时从版本控制手动更新这些文件，则有时您可以使用非常不同的 eclipse 版本。

如果您不签入，每个人都必须创建一个空项目，然后将源文件（以及所有版本控制文件或文件夹）加载到项目中。如果您小心，您可以复制这两个文件，然后使用选项设置来使它们匹配。

请注意，Maven 对此有很大帮助，因为它处理了 .classpath 文件的大部分内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:42:10.883

不签入这些文件的主要原因是 IDE 很可能会更改这些文件以适应您的本地开发环境。如果每个人都一直在提交他们的版本，这可能会导致冲突并因此“破坏”项目。

就是说，eclipse 应该通过 m2eclipse 插件（我相信这些天默认情况下可能会嵌入）具有不错的 maven 集成。

Maven 背后的部分想法正是如此——可重现的跨平台构建、跨 IDE 等——因此构建项目不需要像这样的 IDE 特定文件。使用 m2eclipse 插件导入项目应该可以很好地解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-22T20:43:01.127

如果您的意思是其他成员签出项目并且它对他们不起作用，他们可以在不使用 eclipse 的情况下单独签出 maven 项目，然后使用`m2eclipse`插件将其作为现有 maven 项目导入 eclipse。这很干净，没有任何问题（至少对我来说）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-22T20:45:04.763

如果您团队中的每个人都在使用 Eclipse，并且同意该项目永远不会使用其他任何东西，那么您也可以检查这些文件。但是如果有人使用 IntelliJ、Netbeans 的其他工具或拥有他的Eclipse 非常定制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-26T07:20:30.217

这取决于。

Maven 文档明确表示“不要签入 .project/.classpath/.settings/，因为它们可以从 pom.xml 重新生成”。句子的后半部分（“它们可以再生”）不正确，因此句子的第一部分（建议）可能会也可能不会，这取决于情况。并非 Eclipse 配置的每一点都可以从 pom.xml 重新生成，因此我的观点是，该决定是基于您从中获得多少收益与与特定 IDE 绑定之间的权衡。

所以这取决于。

对于“社区项目”，通常每个开发人员都会使用不同的 IDE 和不同版本的 IDE，我建议不要签入这些文件。否则，不使用您的 IDE 和您的 IDE 版本的开发人员会很痛苦。

对于大型“企业项目”，IDE 和 IDE 版本不是由开发人员自由选择的，而是由项目管理人员严格规定的。诸如编译器（1）、代码格式、验证规则、警告和错误配置、自定义内部插件配置和许多其他内容也是如此。其中许多东西不能在 pom.xml 中设置（也不应该设置，因为 Maven 不是 IDE，而是一个构建工具）。所以在这种情况下，我建议检查这些文件并责怪遵守规定的开发人员，因为他试图不听从指令。

（注意，本案中我故意使用了“口授”和“责备”等词语，因为企业项目的项目管理人员不仅有“口授”和“责备”的权利，而且还有义务）

另一方面，对于一个人的项目，你不必担心你的同事，所以去检查他们。

但关键是你必须知道你的情况和后果，然后自己决定。

(1) 不，“maven.compiler.source”不是要使用的编译器。

# ios - 如何在 tabbarcontroller 中旋转一个视图？

> ID：14467508
> 
> 赞同：1
> 
> 时间：2013-01-22T20:35:23.890
> 
> 标签：ios, objective-c, rotation

我觉得我的问题在[iOS6 中得到了回答：supportedInterfaceOrientations not working (is invoked but the interface still rotates)](https://stackoverflow.com/questions/12447552/ios6-supportedinterfaceorientations-not-working-is-invoked-but-the-interface-s)，但我不够先进，无法理解如何实现响应。

我正在使用 iOS6 编写一个选项卡式应用程序，我希望其中一个视图控制器旋转，其余的保持不动。我知道我需要使用`supportedInterfaceOrientations`，但我不知道如何或在哪里使用它，而且我无法破译有关它的 Apple 文档。被`UITabBarController`设置为 中的根视图控制器`AppDelegate`，如果相关的话。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:07:56.683

这个问题让我死了一个星期。我有完全相同的情况，也只想能够旋转一个视图。在选项卡式应用程序中绕过它的方法是注册方向通知。在 TabController（和任何其他超级视图）和要旋转的 VC 中为 shouldAutoRotate 返回 NO。然后在 viewWillAppear 中注册通知：

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(orientationChanged:)name:UIDeviceOrientationDidChangeNotification
          object:[UIDevice currentDevice]]; 
```

被调用的函数将如下所示：

```
- (void) orientationChanged:(NSNotification *)note
{
    UIDevice * device = note.object;
    switch(device.orientation)
    {
        case UIDeviceOrientationPortrait:
            break;

        case UIDeviceOrientationPortraitUpsideDown:
            break;
        case UIDeviceOrientationLandscapeLeft:
            if(viewHasAppeared==true){
                [self performSegueWithIdentifier:@"firstToLandscape" sender:self];}
            break;
        case UIDeviceOrientationLandscapeRight:
            if(viewHasAppeared==true){
                [self performSegueWithIdentifier:@"firstToLandscape" sender:self];}
            break;
        default:
            break;
    };
} 
```

- 在 ViewDidAppear 中放置一个布尔值，因为在视图实际出现之前您无法继续。

现在，如果您在横向模式下更改为的视图不是选项卡式视图控制器，那么处理该问题的最佳方法是只允许在该视图中进行 AutoRotation，然后在 willAnimate 中您只需像这样关闭 VC：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if(UIInterfaceOrientationIsPortrait(toInterfaceOrientation))
    {
       [self dismissViewControllerAnimated:YES completion:nil];     
    }
} 
```

如果它是选项卡式视图，那么也只需在该视图中注册方向更改。但是，请确保在离开视图时删除orientationChange 通知。如果你不这样做，那么你也会从其他视图控制器中切换到横向。

当你离开去另一个选项卡时，你需要实现 tabBarController 委托，并确保你像这样删除观察者：

```
-(void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController
{
    if(![NSStringFromClass([viewController class])isEqualToString:@"FirstViewController"])
    {
            [[NSNotificationCenter defaultCenter]removeObserver:self name:UIDeviceOrientationDidChangeNotification object:[UIDevice currentDevice]];             
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:54:49.540

`supportedInterfaceOrientations`在您的 UITabBarController 子类中实现。这是一个示例，其中第一个 View Controller 不会自动旋转出纵向：

```
- (NSUInteger)supportedInterfaceOrientations {
    if ( self.selectedIndex == 0 )
        return UIInterfaceOrientationMaskPortrait ;
    else
        return UIInterfaceOrientationMaskAll ;
} 
```

但是，如果您切换到 View Controller #2（索引 1），旋转到横向，然后切换回 View Controller #1，您将看到 View Controller #1 以横向显示。我正在寻找解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-22T20:52:23.377

实现此目的的一种简单方法是正确加载视图并在 viewDidLoad: 方法结束时使用转换旋转整个 UIView

```
[self.view setTransform:CGAffineTransformMakeRotation(-M_PI / 2)]; 
```

# c# - C# Excel 互操作 - 如何测试互操作对象是否仍在工作并执行任务？

> ID：14467510
> 
> 赞同：5
> 
> 时间：2013-01-22T20:35:32.827
> 
> 标签：c#, excel, interop, marshalling

我正在循环浏览一个包含数百个 excel 文件的目录，并尝试一次刷新一个 excel 文件。例如，我不断收到此错误，这表明刷新操作仍在文件 A 上运行，而 FileB 正在尝试启动刷新操作。循环太快了，不知何故，我必须等待文件 A 上的先前刷新操作完成，然后才能开始刷新文件 B。

> 未处理的异常：System.Runtime.InteropServices.COMException：消息过滤器指示应用程序正忙。（来自 HRESULT 的异常：0x8001010A (RPC_E_SERVERCALL_RETRYLATER)）在 Microsoft.Office.Interop.Excel._Workbook.RefreshAll() 在 RefreshExcelFiles.Program.RefreshFile(String fileName)

这是我的代码。如何在开始处理循环中的新文件之前等待刷新操作完成？或者，等待 wb 对象上的封送释放操作完成，然后再开始新文件？

```
using System;
using System.Configuration;
using System.IO;
using System.Runtime.InteropServices;
using Microsoft.Office.Interop.Excel;

namespace RefreshExcelFiles
{
    internal class Program
    {
        private static string _fileDirectory;
        private static Application _excelApp;

        private static void Main(string[] args)
        {
            _fileDirectory = ConfigurationManager.AppSettings["FileDirectory"];
            _excelApp = new Application();
            _excelApp.DisplayAlerts = false;

            Console.WriteLine("starting to refresh files");
            int i = 0;
            int total = Directory.GetFiles(_fileDirectory).Length;

            foreach (string file in Directory.GetFiles(_fileDirectory))
            {
                i += 1;
                Console.WriteLine("File " + file + " " + i.ToString() + "/" + total.ToString());
                RefreshFile(file);
            }

            _excelApp.Quit();
            Marshal.FinalReleaseComObject(_excelApp);

            Console.WriteLine("press any key to exit");
            Console.ReadLine();
        }

        private static void RefreshFile(string fileName)
        {
            _Workbook wb = _excelApp.Workbooks.Open(fileName, false);
            wb.RefreshAll();

            wb.Save();
            wb.Close(Type.Missing, Type.Missing, Type.Missing);

            Marshal.FinalReleaseComObject(wb);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T14:52:02.433

我找到了我的问题的答案。我需要[实现 IMessageFilter RetryRejectedCall](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/70ef972b-51b6-4ece-a4af-d6b4e111eea5/)。有关使用 IMessageFilter::RetryRejectedCall 的 C# 和 VB.NET 代码示例，[请参阅此博客文章（回程机器存档链接）](https://web.archive.org/web/20130517131109/http://www.summsoft.com/blogs/melodys_vsta_blog/archive/2007/08/07/using-a-messagefilter-to-avoid-ide-threading-and-timing-issues.aspx)。

如果您自己没有注册 MessageFilter（通过调用 CoRegisterMessageFilter），您将获得默认行为，如果调用被拒绝，则调用失败。.Net 将失败 HRESULT 转换为异常。为了处理尝试调用时服务器忙的可能性，您需要在客户端代码中实现 IMessageFilter::RetryRejectedCall 并注册消息过滤器。在大多数情况下，您只需要等待几秒钟，然后重试呼叫 - 通常这将有足够的时间让 Word 完成它正在执行的任何操作，以便它可以处理您的呼叫。

# rally - SDK2：链接到网格中的投资组合项目子故事

> ID：14467511
> 
> 赞同：1
> 
> 时间：2013-01-22T20:35:33.203
> 
> 标签：rally

我有一个 SDK2 Rally 网格功能级别的投资组合项目。我想直接链接到子用户故事列表。以下曾经工作：

```
 columnCfgs: [
                    {dataIndex: 'FormattedID', text:'ID', width: 50,
                        renderer: function(value, style, item, rowIndex) {
                            var link = Rally.util.Navigation.createRallyDetailUrl(item);

                            return Ext.String.format("<a target='_top' href='{1}/userstories'>{0}</a>", value, link);
                        }
                    }
                    .... 
```

这将返回以下链接：

```
 https://rally1.rallydev.com/<id>/detail/portfolioitem/feature/<id>/userstories 
```

但最近它坏了（它以前工作过），现在正确的链接似乎如下：

```
 https://rally1.rallydev.com/#/<id>/detail/portfolioitem/feature/<id>/userstories 
```

看到第二个链接中的“#”了吗？

我希望 Rally.util.Navigation.createRallyDetailUrl(item) 会产生一个工作链接，但似乎不再。这只是一个新错误，还是有更好的方法来做到这一点？

我正在使用 2.0p5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T03:44:27.350

Rally Support 已经审查了这个问题，它实际上似乎是一个缺陷。请[向 Rally 支持提交案例，](http://www.rallydev.com/support-resources)以跟踪并收到有关此问题的更新通知。

# sql - 为 SQL Server 创建运行小计

> ID：14467516
> 
> 赞同：0
> 
> 时间：2013-01-22T20:35:42.190
> 
> 标签：sql, sql-server

我正在尝试获取一个正在运行的小计（了解这与组的小计和汇总方法不同）。

尝试使用

```
Row_Number() over (order by ID_Number) as Row_Count 
```

并将其嵌套在 select 语句中并`LEFT OUTER JOIN`在其自身上使用 a （这只是搅动）。

我想要得到的是：

```
if ROW_COUNT > 1 THEN RUNNINGTOTAL = Volume_Category + (RUNNINGTOTAL for ID_Number where ROW_COUNT= ROW_COUNT(for this ID_Number*)-1) 
```

我有一张表，其中列出了唯一的“ID 号”，这是这里的重点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:39:06.523

除非您使用的是 SQL Server 2012，否则进行累积和的最简单方法是使用相关子查询。这是代码的模板：

```
select t.*,
       (select sum(val) from t t2 where t2.ordercol <= t.ordercol) as cumesum
from t 
```

在 2012 年，您可以：

```
select t.*,
       sum(val) over (order by ordercol) as cumesum
from t 
```

在这两个中，`val`是您要求和的列，并且`ordercol`是指定顺序的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:44:00.070

尝试这个：

```
SELECT
   T1.Id,
   SUM(T2.Amount) Total
FROM tbl T1
   JOIN Tbl T2
      ON T1.Id>= T2.Id
GROUP BY T1.Id 
```

# ruby-on-rails - RSpec 测试类方法调用实例方法

> ID：14467518
> 
> 赞同：1
> 
> 时间：2013-01-22T20:35:46.153
> 
> 标签：ruby-on-rails, testing, rspec

我正在寻找测试一个类方法是否调用了一个特定的实例方法。有没有办法做到这一点？这是我所拥有的最好的，但它失败了。

```
describe '#foo' do
  let(:job) { create :job }
  it 'calls job.bar' do
    job.should_receive(:bar)
    Job.foo
  end
end 
```

我需要确保调用了正确的作业实例，而不仅仅是任何实例。我很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:37:13.880

`.foo`您可以在获取实例的方法上使用存根。

例如：

```
describe '.foo' do
  let(:job) { create :job }
  it 'calls job.bar' do
    Job.stub(:find).and_return job
    job.should_receive(:bar)
    Job.foo
  end
end 
```

这样做是为了确保您期望调用方法的实例是实际使用的实例`.foo`。

您可以为此添加期望或参数匹配器，因此：

`Job.should_receive(:find).with(job.id).and_return(job)`

# ruby-on-rails - 通过rails3中的json上传图片

> ID：14467524
> 
> 赞同：0
> 
> 时间：2013-01-22T20:36:09.287
> 
> 标签：ruby-on-rails, ruby-on-rails-3

1.  我正在使用载波进行图像上传并尝试通过 json 上传图像，但它不会将值保存到数据库中。虽然图像名称在控制器中正确输入 @Employee_events.external_doc=params[:external_doc] 。但它不会在这个 @Employee_events.external_doc 变量中设置，因为我的问题可能是多部分的。但不知道如何在 json 中使用。

    > .js 文件

    ```
    $(document).ready(function() {
         var evnt = {};
            $("#Event_dialog-form").dialog({
                autoOpen : false,
                height : 400,
                width : 600,
                modal : true,
                buttons : {
                    "Enter" : function() {

                        evnt.external_doc = $('#imgid').val();

                        $.post("/employee_management/add_event", evnt, function(data) {
                            if (data) {
                                alert("Data entered successfully");
                            } else {
                                alert("Oops! some error occured");
                            }
                        });
                        return false;
                    },
                    Cancel : function() {
                        $(this).dialog("close");
                    }
                },
                close : function() {
                    //allFields.val( "" ).removeClass( "ui-state-error" );
                }
            });
            $(".EventEntryDialog").click(function() {
                var Ed = $(this).attr("id");

                 $('#user_id').val(Ed);

                $("#Event_dialog-form").dialog("open");
            });
            }); 
    ```

    > **控制器**

    ```
    def add_event

              result=TRUE
            @Employee_events=EmployeeEvent.new

             @Employee_events.external_doc= params[:external_doc]

             puts  @Employee_events.external_doc.to_s

             respond_to do |format|

               if @Employee_events.save

              format.json { render :json => result }
             else
              return FALSE 
             end
            end

           end 
    ```

# ruby - 为什么我们需要带有机械化对象的 user_agent_alias？

> ID：14467526
> 
> 赞同：2
> 
> 时间：2013-01-22T20:36:16.977
> 
> 标签：ruby, mechanize-ruby

我只是想知道一些信息`mechanize`并从互联网上找到以下代码：

```
require 'mechanize'
require 'logger'
agent = Mechanize.new
agent.user_agent_alias = 'Windows IE 9'
agent.follow_meta_refresh = true
agent.log = Logger.new(STDOUT) 
```

任何人都可以解释为什么`user_agent_alias`以及`follow_meta_refresh`何时需要，`mechanize`它本身就是一个浏览器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T23:02:57.017

Mechanize 不是浏览器。它是一个页面解析器，它为您提供了足够的方法来轻松/方便地浏览网站。但是，它绝不是浏览器。

`user_agent_alias`设置 Mechanize 在运行和发出页面请求时的签名。在您的示例中，它试图通过伪装成“IE 9”来欺骗站点，但该签名不会欺骗任何嗅探 User-Agent 标头的系统。

`follow_meta_refresh`，好吧，您应该花时间搜索带有“刷新”参数的“元”标签。了解它是微不足道的，然后你就会明白。或者只是[阅读](http://mechanize.rubyforge.org/Mechanize.html#method-i-follow_meta_refresh-3D)它的文档。

# git - 使 git status 显示带有修改文件的文件夹

> ID：14467531
> 
> 赞同：0
> 
> 时间：2013-01-22T20:36:29.633
> 
> 标签：git

我的工作树中有很多修改过的文件。但我只想查看哪些文件实际上是为提交而暂存的，所以我不会意外推送我仍在处理的文件。我怎样才能做到这一点？

**编辑：** 很抱歉造成混淆 - 如果无法只看到分阶段的更改，那么是否可以只看到包含修改文件的文件夹列表而不是所有修改文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:48:10.983

您可以解析以下输出`git status`：

```
git status --porcelain | grep "^[MADRCU]" | cut -c 4- 
```

该`--porcelain`选项确保不同 git 版本之间的向后兼容性，并且类似于`--short`输出。该`grep`模式处理对文件的不同类型的更改。参见`git help status`进一步解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:39:58.943

git status 将向您显示两者，首先是暂存提交的文件，然后是修改后的文件，但未暂存提交

请注意，新文件总是暂存

您应该避免太多修改的文件，尽早提交并经常提交

如果您有很多不相关的更改需要跟踪，您应该真正考虑分支

# php - 简单的 HTML Dom 和 Curl

> ID：14467534
> 
> 赞同：0
> 
> 时间：2013-01-22T20:36:35.733
> 
> 标签：php, curl, simple-html-dom

嗨，curl 是使用带有 cookie 的 POST 并导航到另一个页面进行报废的最佳方法吗？我正在使用下面的编码，但我无法让它工作。

```
include('simple_html_dom.php');

    $data = array(
     '__EVENTTARGET' => '',
     '__EVENTARGUMENT' => '',
     '__VIEWSTATE' => '%2FwEPDwUKLTcyODA2ODEwMGRk',
     'Myname' => 'justdev12345',
     'Mypassword' => '12345',
     'idLogin' => 'Login',
     'tmplang2' => '6',
     'fm' => '',
     'jc' => '',
     'LoginRef' => ''
     );

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "https://secure.site.com/mainframe.aspx");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true );
curl_setopt($ch, CURLOPT_COOKIEJAR, "sdc_cookies.txt");
curl_setopt($ch, CURLOPT_COOKIEFILE, "sdc_cookies.txt");
curl_setopt($ch, CURLOPT_COOKIESESSION, true);

$output = curl_exec($ch);
$info = curl_getinfo($ch);
curl_close($ch);

$output = new simple_html_dom();   
$output = file_get_html('http://profiles.site.com/profile_900.aspx?AccountID=ShopCartUpdate');
print $output; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T01:58:36.137

您的代码一直很好，直到您丢弃 curl 响应并使用 simple-html-dom 加载 url。如果你想使用 curl 响应，它应该如下所示：

```
$html = str_get_html($output);
$html->find('title'); 
```

否则，您可能应该删除所有 curl 代码。

# ruby-on-rails - 为 MySQL Rail 应用程序安装包

> ID：14467540
> 
> 赞同：0
> 
> 时间：2013-01-22T20:37:11.507
> 
> 标签：ruby-on-rails, gem, ruby-on-rails-3.2

当我说`bundle install`一段时间后我得到错误：

> 结果记录到/Users/JonyIve/.rvm/gems/ruby-1.9.3-p362@railsbabak/gems/mysql2-0.3.11/ext/mysql2/gem_make.out 安装mysql2（0.3.11）时出错，并且 Bundler 无法继续。`gem install mysql2 -v '0.3.11'`在捆绑之前确保成功。

所以我按照它说的做，我运行这个命令：

```
gem install mysql2 -v '0.3.11' 
```

然后我再次运行 Bundle Install 但我再次遇到相同的错误。

我应该从哪里着手解决这个问题？

这是我的 GemFile 的样子：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'
gem 'sqlite3'
#START:mysql
group :production do
  gem 'mysql2'
end
#END:mysql

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',    '~> 3.2.3'
  gem 'coffee-rails',  '~> 3.2.1'
  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
#START_HIGHLIGHT
gem 'capistrano'
#END_HIGHLIGHT

# To use debugger
# gem 'debugger'

gem 'will_paginate', '~> 3.0' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:38:56.997

此错误的原因可能是缺少 mysql 标头，因此请确保您已正确安装 mysql 标头。

对于 Ubuntu/Linux 风格，使用以下命令安装 MySQL 客户端和开发包

```
sudo apt-get install mysql-client libmysqlclient-dev 
```

对于 Mac 操作系统：

```
http://www.djangoapp.com/blog/2011/07/24/installation-of-mysql-server-on-mac-os-x-lion/ 
```

问候！

# forms - 如何将此表格（时尚联系表格）发送给多个收件人？

> ID：14467541
> 
> 赞同：0
> 
> 时间：2013-01-22T20:37:18.727
> 
> 标签：forms, contact, email-address

我希望将联系表发送到 1 个以上的地址。目前的代码是

```
$to = 'email@email.com'; 
```

再往下的代码是

```
function xmail($to,$subject,$message,$headers){
    global $usesmtp,$smtphost,$smtpport,$smtpuser,$smtppass,$smtpsecure,$_POST;
    if($usesmtp!=1){
        if(@mail($to,$subject,$message,$headers)){
            return 1;
        }
    }else{
        require_once('mail/class.phpmailer.php');
        $mail             = new PHPMailer();
        $body             =$message;
        $mail->IsSMTP();
        $mail->SMTPDebug  = 0; 
        $mail->SMTPAuth   = true;   
        $mail->SMTPSecure = $smtpsecure;       
        $mail->Host       = $smtphost;     
        $mail->Port       = $smtpport;                
        $mail->Username   = $smtpuser;  
        $mail->Password   = $smtppass;          
        $mail->SetFrom($_POST['email'], $_POST['name']);
        $mail->Subject    = $subject;
        $mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; 
        $mail->MsgHTML($body);
        $address        = $to;
        $mail->AddAddress($address, "Administrator");
        if($mail->Send()) {
          return 1;
        }
    }
} 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-05T15:52:51.960

改变了

```
$to = 'email@email.com'; 
```

至

```
$to = 'email@email.com, email2@email2.com'; 
```

# entity-framework - EF5 一对一列表并没有具体化每个实体

> ID：14467547
> 
> 赞同：0
> 
> 时间：2013-01-22T20:37:55.947
> 
> 标签：entity-framework, linq-to-entities, entity-framework-5

我正在使用 EF5.0 CF 让我们考虑这些实体（此处简化）：

```
public class Catalog 
{
    public int Id { get; set; }
    public bool IsActive { get; set; }
    public string Name { get; set; }
    public ICollection<PricedProduct> Products { get; set; }    
}

public class PricedProduct 
{
    public int Id { get; set; }
    public bool IsActive { get; set; }
    public Product Product { get; set; }
    public Price Price { get; set; }
}

public class Price 
{
    public int Id { get; set; }
}

public class Product 
{
    public int Id { get; set; }
    public string Name {get; set;}
} 
```

它们使用 fluent API 进行配置：

```
//For the Catalog entity
 ToTable("Catalog", "Catalog");
 this.Property(t => t.Name).HasColumnType("nvarchar").HasMaxLength(100).IsRequired();

 this.HasMany<PricedProduct>(t => t.Products).WithMany().
 Map(mc =>
        {
        mc.ToTable("CatalogPricedProduct", "Catalog");
        mc.MapLeftKey("PricedProductID");
        mc.MapRightKey("CatalogID");
        });

//For the PricedProduct entity
ToTable("PricedProducts", "Catalog");
HasRequired(t => t.Product).WithOptional().Map(m=>m.MapKey());
HasRequired(t => t.Price).WithOptional().Map(m => m.MapKey());

//For the Product entity
ToTable("Products", "Catalog");
this.Property(t => t.Name).HasColumnType("nvarchar").HasMaxLength(100).IsRequired();

//For the Price entity
ToTable("Prices", "Catalog"); 
```

所以基本上我有一个与 PricedProduct 有 n:n 关系的目录，它与 Product 和 Price 有两个 1:1 关系

我通过这个 linq 查询获得了这些实体：

```
var qy = from cata in this.Set<Catalog>().Include("Products")
                    .Include("Products.Product")
                    .Include("Products.Price")
                    where cata.Name == "name" 
                     select cata;
return qy.FirstOrDefault(); 
```

只要两个 PricedProduct 不共享相同的产品或相同的价格，一切都会运行良好。

这意味着，在 PricedProducts 表中，只要 Product 或 Price FK 是“唯一的”，PriceProduct 就会被正确检索和具体化，例如，如果另一个 PricedProduct 在 price 上具有相同的 FK 值，则不会将 price 加载到相关的 PricedProduct 中。

我快速检查了生成的 SQL 查询，它看起来很好，感觉就像 EF 无法在同一个图中实现同一个对象的两个实例？？

任何人都知道我的代码该怎么做或有什么问题？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T09:32:15.677

那是因为您对模型的理解不正确。如果多个`PricedProduct`可以具有相同`Price`或相同`Product`，则不能将其映射为一对一关系，而是映射为一对多（一个价格可以分配给许多定价产品 - 产品相同）。你需要：

```
ToTable("PricedProducts", "Catalog");
HasRequired(t => t.Product).WithMany();
HasRequired(t => t.Price).WithMany(); 
```

# java - 如何使用 java RMI 转发消息？

> ID：14467562
> 
> 赞同：0
> 
> 时间：2013-01-22T20:38:52.660
> 
> 标签：java, rmi

我有以下问题：

我有两个客户端使用一个接口，一个服务器运行该接口的 java rmi 实现，该接口由方法 msgPass(String host, String msg) 组成。我想要做的是当客户端 A 使用方法 msgPass(String host,String msg) 时，rmi 服务器接收到该 msg 并发送到客户端 B。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:41:17.080

客户端 B 还公开一个接口供服务器使用，或者您通过其他方式发送它，例如套接字、Web 服务等。
即您的客户端 B 必须同时充当客户端和服务器

# android - 多个按钮一次启动多个活动

> ID：14467563
> 
> 赞同：2
> 
> 时间：2013-01-22T20:38:51.910
> 
> 标签：android, button, onclick, android-activity

我目前正在编写一个小 Android 应用程序，并发现了一个关于多个按钮的奇怪问题。我有一个带有 4 个按钮的 Activity。当我一次按下多个按钮时，两个动作都会被执行。所以我可以按下所有 4 个按钮并启动所有 4 个以下活动。

这是我的 onButtonClick 方法

```
public void onButtonClick(View view) {
    Intent intent = new Intent(this, RunActivityConfirm.class);

    switch(view.getId()) {
        case R.id.btnRunAcceleration:
            intent.putExtra("DisciplineName", "Acceleration");
            startActivity(intent);
            break;
        case R.id.btnRunSkidPad:
            intent.putExtra("DisciplineName", "Skid Pad");
            startActivity(intent);
            break;
        case R.id.btnRunAutocross:
            intent.putExtra("DisciplineName", "Autocross");
            startActivity(intent);
            break;
        case R.id.btnRunEndurance:
            intent.putExtra("DisciplineName", "Endurance");
            startActivity(intent);
            break;
    }

} 
```

首先我认为问题在于我总是在每个“案例”中调用 startActivity() 但即使我尝试以下所有 4 个活动同时开始

```
public void onButtonClick(View view){   
    Intent intent = new Intent(this, RunActivityConfirm.class);

    switch(view.getId()) {
        case R.id.btnRunAcceleration:
            intent.putExtra("DisciplineName", "Acceleration");
            break;
        case R.id.btnRunSkidPad:
            intent.putExtra("DisciplineName", "Skid Pad");
            break;
        case R.id.btnRunAutocross:
            intent.putExtra("DisciplineName", "Autocross");
            break;
        case R.id.btnRunEndurance:
            intent.putExtra("DisciplineName", "Endurance");
            break;
    }
    startActivity(intent);
} 
```

这发生在我的应用程序中。无论我按下哪个按钮，每个关联的 Action 都会执行并且每个关联的 Activity 都会启动。

我能做些什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:46:01.023

> 当我一次按下多个按钮时，两个动作都会被执行。

This is expected behavior. Your code starts an activity when a button is pressed. Multiple buttons are pressed, so multiple activities are started.

If you want to change this so that only one button can be pressed, then you need to add code to do so. You could disable the other buttons in `onButtonClick` (and re-enable them when appropriate).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T20:46:40.140

As this is the same Activity add

```
android:finishOnTaskLaunch="true" 
```

in your manifest under your activity tag.It will prevent to make the multiple instances of same activity.

# c++ - Arduino将SD文件名作为字符串打开

> ID：14467568
> 
> 赞同：5
> 
> 时间：2013-01-22T20:39:16.250
> 
> 标签：c++, file-io, arduino

我正在尝试打开一个将名称计算为字符串的文件。但是，它只是给我编译错误，如图所示。

```
for(int i=1;;i++)
{
   String temp = "data";
   temp.concat(i);
   temp.concat(".csv");
   if(!SD.exists(temp))//no matching function for call to sdclass::exists(String&)
   {
      datur = SD.open(temp,FILE_WRITE);
   }
} 
```

我是一个 java 人，所以我不明白为什么这不起作用。我尝试了一些字符串对象方法，但似乎都没有奏效。我对 arduino 编程有点陌生，但我对 java 的理解要好得多。这个 for 循环的重点是每次 arduino 重新启动时创建一个新文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-22T20:59:58.883

`SD.open`需要一个字符数组而不是 a `String`，您需要先使用该[`toCharArray`](http://arduino.cc/en/Reference/StringToCharArray)方法对其进行转换。尝试

```
 char filename[temp.length()+1];
  temp.toCharArray(filename, sizeof(filename));
  if(!SD.exists(filename)) { 
   ...
  } 
```

完成代码：

```
for(int i=1;;i++)
{
   String temp = "data";
   temp.concat(i);
   temp.concat(".csv");
   char filename[temp.length()+1];
   temp.toCharArray(filename, sizeof(filename));
   if(!SD.exists(filename))
   {
      datur = SD.open(filename,FILE_WRITE);
      break;
   }
} 
```

您会发现许多函数采用 char 数组而不是字符串。

# php - Codeigniter：重写以删除 index.php 不起作用

> ID：14467570
> 
> 赞同：0
> 
> 时间：2013-01-22T20:39:21.233
> 
> 标签：php, apache, .htaccess, codeigniter, mod-rewrite

我刚刚从本地服务器 (XAMPP) 上传了我的网站。它在本地工作，但由于某种原因，将 index.php 添加到我的 SEF URL 的重写在我的公共服务器中不起作用。这就是我现在所拥有的：

```
# Avoid listing directory
Options -Indexes

<IfModule mod_rewrite.c>
Options +FollowSymlinks
RewriteEngine on

# manage language segment 
RewriteRule ^(es|en)/(.*) $2?lang=$1 [L]

# code that allows to get rid of index.php from URL
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php/$0 [PT,L]

</IfModule> 
```

这些 URL 的工作：

**www.example.com**

**www.example.com/index.php/aboutme**

而像这样的 URL 会产生**500 错误**：

**www.example.com/aboutme**

这是我试图解决 index.php 删除的条件和规则的另一种组合：

```
RewriteCond $1 !^(index.php|css|img|scripts|ckeditor|robots.txt|sitemap.xml) 
RewriteRule ^(.*)$ index.php/$1 [L] 
```

但它会为任何没有 index.php 的 URL 生成 500 错误，包括根 URL www.example.com

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:46:28.020

您的 RewriteRule 中似乎有一个错字。

试试这个：

```
RewriteCond $1 !^(index.php|css|img|scripts|ckeditor|robots.txt|sitemap.xml) 
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

它适用于我们的 Code Igniter。与第二个示例相比，唯一的区别是 index.php 前面的斜线。

# c++ - WM_GETFONT 返回类型 LRESULT 而不是预期的 HFONT

> ID：14467573
> 
> 赞同：1
> 
> 时间：2013-01-22T20:39:53.867
> 
> 标签：c++, winapi

[当MSDN 声明](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632624%28v=vs.85%29.aspx)返回类型为 HFONT时，这样做`HFONT childfont = SendMessage (childwin, WM_GETFONT, NULL, NULL);`会导致错误“从 'LRESULT' 到 'HFONT__*' 的转换无效” 。这个函数的正确返回类型是什么？我应该只使用 LRESULT 还是我必须做一些特别的事情，因为如果我不这样做，我的程序稍后会回来咬我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:44:44.420

由于`SendMessage`用于许多用途，它不可能对所有东西都有完美的返回类型。在这种情况下，您必须将其转换为您需要的类型：

```
HFONT childfont = reinterpret_cast<HFONT>(SendMessage(...)); 
```

在 的处理程序中`WM_GETFONT`，您会期望看到类似这样的内容：

```
HFONT whateverFont;
...
return (LRESULT)whateverFont; 
```

所以回到`HFONT`原来的状态是可以的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T20:45:10.520

`SendMessage`是一把瑞士军刀：它做了很多不同的事情，所有这些都返回不同类型的值。由于 C 不支持重载返回值（请记住 Win32 API 是 C API），它必须返回泛型`LRESULT`类型。

因此，您需要将结果转换为实际类型。该文档指出，此消息返回一个`HFONT`，因此您必须将结果转换为`HFONT`：

```
HFONT childFont = (HFONT)SendMessage(childWin, WM_GETFONT, ...); 
```

或者，您可以使用`GetWindowFont()`头文件中定义的宏`<WindowsX.h>`，其中包含许多实用宏：

```
// From WindowsX.h.  SNDMSG is a macro which expands to either SendMessage or
// AfxSendMessage.
#define GetWindowFont(hwnd) FORWARD_WM_GETFONT((hwnd), SNDMSG)
#define FORWARD_WM_GETFONT(hwnd, fn) \
    (HFONT)(UINT_PTR)(fn)((hwnd), WM_GETFONT, 0L, 0L)

// Example usage:
HFONT childFont = GetWindowFont(childWin); 
```

# php - 如何从某个数字/偏移量开始自动增量？

> ID：14467577
> 
> 赞同：0
> 
> 时间：2013-01-22T20:40:21.543
> 
> 标签：php, mysql, auto-increment, fgetcsv

我正在运行 fgetcsv 查询以将一堆数据从 CSV 导入 WordPress。

我想知道如何从某个数字开始自动递增，例如从 1000 开始。

```
$import1="INSERT into wp_postmeta (meta_id,post_id,meta_key,meta_value) values(',',',','first_name','$data[1]')"; 
```

这是代码的示例。meta_id 应该使用正常的自动增量，但 post_id 我想从某个数字开始。

我将如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:42:11.483

要设置自动增量字段的起始值，可以使用 alter table

```
ALTER TABLE wp_postmeta AUTO_INCREMENT = 1000; 
```

据我所知，在 mysql 的同一个表上不可能有两个自动递增字段，所以你必须自己进行编程（例如使用触发器）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:43:01.427

要更改表上的 AUTO_INCREMENT 值：

```
ALTER TABLE wp_postmeta AUTO_INCREMENT = 1000; 
```

# jsf - 选项卡显示默认，需要显示我们选择的选项卡

> ID：14467580
> 
> 赞同：0
> 
> 时间：2013-01-22T20:40:23.150
> 
> 标签：jsf, primefaces

我使用的是 prime face 3.4 版，问题出在标签视图显示上。

```
<p:messages id="messages"/>
<p:tabView id="tabView" dynamic="false">

    <p:tab id="tab1" title="Navigation"> 
```

```
 <p:tab id="tab2" title="Email Address"> 
```

```
 <p:tab id="tab3" title="Password"> 
```

```
</p:tabView> 
```

这是一个带有 3 个选项卡（通知、电子邮件和密码）的选项卡式页面，如果在电子邮件选项卡上没有输入任何值我单击提交，它会在顶部显示错误消息并默认为第一个选项卡，我需要显示电子邮件选项卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T03:14:31.210

使用 ajax=false，在您单击按钮后整个页面都会刷新，并且选项卡视图会将您带到第一页，就像您第一次导航到该页面一样。

您可以将 Ajax 设置为 true 或使用 bean 上的整数作为选项卡视图的选定索引（如果内存没有让我失望，则选项卡视图上有一个名为 selectedIndex 的属性）。然而，第二个选项仅适用于视图、会话和应用程序范围的 bean。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:20:28.840

将`<p:messages id="messages">`标签放在标签内`<p:tab id="tab2" title="Email Address">`。请注意，它将显示来自同一表单内（或任何选项卡）内任何经过验证的组件的消息。您应该使用`<p:message for="componentId">`来显示特定于组件的消息。

# c# - 在我的 MVC 应用程序中使用 SignalR 实时获取用户最新信息

> ID：14467588
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:40:37.797
> 
> 标签：c#, asp.net-mvc, ravendb, signalr

我一直在寻找可以执行类似操作的服务，通知用户（特定用户）他们有新的好友请求。我遇到了 SingalR，并认为这可能对我的应用程序有用。我看到很多 SignalR 的示例和实时使用都是聊天应用程序，这是有道理的。无论如何，这就是我要在这里完成的事情。我有一个使用 RavenDB 作为数据存储的 MVC 社交应用程序，一个用户可能会请求与另一个用户建立友谊，我想实时更新该客户端他们有一个新请求（每 X 秒检查一次）。我要么正在寻找一个好的 SignalR 示例，要么正在寻找可能为我指明正确方向的文档（希望是示例），或者是比 SignalR 更适合我的应用程序的良好服务。感谢您的任何回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T00:43:54.563

SignalR 绝对适合您的应用程序。例如，JabbR (http://jabbr.net/, [https://github.com/davidfowl/JabbR](https://github.com/davidfowl/JabbR) ) 可能是一个聊天室，但它会不断地访问数据库以更新/检索其记录。

对于您的情况，我建议在数据库写入时排队一个命令以通知其他用户，而不是定期检查。意思是说用户 A 请求与用户 B 成为朋友。首先将该请求写入数据库，然后通过 SignalR 向所有相关方广播一条消息。

但是，如果您仍然希望每 X 秒执行一次计时器检查，这仍然是可能的。参见 ShootR (shootr.signalr.net, [https://github.com/NTaylorMullen/ShootR](https://github.com/NTaylorMullen/ShootR) )，这是一款多人游戏，它利用游戏计时器并在检测到碰撞时广播碰撞。当然，ShootR 在服务器上以更高的间隔（50+ 次/秒）进行计算，它基本上是相同的。

因此，如果您想检查每个 Xs 方法，我建议您混合使用两个项目（JabbR 和 ShootR）并实现一个线程计时器（而不是用于高频更新的自定义计时器，这是 ShootR 使用的）和然后从数据库中检索数据并使用该数据向用户发送更新。

希望这可以帮助！

# wcf - Web 服务版本控制

> ID：14467591
> 
> 赞同：0
> 
> 时间：2013-01-22T20:41:02.320
> 
> 标签：wcf, web-services, versioning

> **可能重复：**
> [使用 WCF 对服务进行版本控制的最佳实践？](https://stackoverflow.com/questions/36999/best-practices-for-versioning-your-services-with-wcf)

好吧，这一直是我的弱点，真的不知道如何解决这个问题。我设计了一个 WCF Web 服务，但无法弄清楚应用程序版本的最佳方式（即，如果我使用正确的词），因此当对一个客户端进行更改时，我不必让所有其他客户端更新和重新编译他们的应用程序，直到他们真正想要进行更改，然后他们将获得其他人可能正在使用的新版本。我希望消除客户特定的服务。Web 服务引用业务层的公共库。我不知道我是否应该遵循特定的标准或完全错误地这样做，所以我希望你能帮助我或指出我做 Web 服务版本控制的最佳方式的正确方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:47:53.963

对您的 WS 进行版本化的最常见和最有用的方法之一（从我的角度来看）是根据每个版本将版本号放在 URL 中。

例如，这是 Twitter API 的 url

```
https://api.twitter.com/1.1/ 
```

所以其中一项功能在这里托管

```
https://api.twitter.com/1.1/statuses/mentions_timeline.json 
```

如果您需要更新它并在新版本中工作，您可以在此处发布它：

```
https://api.twitter.com/2.0/statuses/mentions_timeline.json 
```

让我知道这是否对您有所帮助。

问候，

# ruby-on-rails - 创建评论时在 Rails 应用程序中发送电子邮件通知

> ID：14467593
> 
> 赞同：0
> 
> 时间：2013-01-22T20:41:07.250
> 
> 标签：ruby-on-rails, ruby, email, ruby-on-rails-3.2

我正在为我的应用程序使用 gem 'foreigner' 和设置评论，一切正常。但是，我还想在创建评论时通知我的用户。我有两个用户，客户和开发人员。客户可以发表评论，开发者可以发表评论。

我将如何设置我的 comments_controller.rb 文件来确定是客户还是开发人员发布了评论，然后使用正确的模板发送电子邮件。

到目前为止，我已经尝试了以下没有工作；

```
 def create
    @comment = Comment.new(params[:comment])

    respond_to do |format|
      if @comment.save
        if current_user.is_developer?
           Notifier.developer_notify(@developer).deliver
        elsif current_user.is_customer?
           Notifier.customer_notify(@customer).deliver
        end
        format.html { redirect_to :back, notice: 'Comment was successfully created.' }
        # format.json { render json: @comment, status: :created, location: @comment }
      else
        format.html { render action: "new" }
        # format.json { render json: @comment.errors, status: :unprocessable_entity }
      end
    end
  end 
```

“developer_notify”和“customer_notify”是我的通知程序邮件中定义的类。

到目前为止，我的“通知程序”邮件看起来像这样；

```
 def developer_notify(joblisting)
    @joblisting = joblisting
    mail(:to => @joblisting.current_user.email, :subject => "There's a new comment.")
  end 
```

@Joblisting 是被引用的工作，因为每个 Joblisting 都有来自客户和开发人员的评论。

执行上述操作，给我一个错误 -`undefined method 'current_user' for nil:NilClass`

所以我猜它没有找到 Joblisting ID，也没有找到客户的电子邮件地址，那么如果客户对同一个工作发表了评论，它会向开发人员发送电子邮件，通知发布了新的评论。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:56:26.423

你已经`joblisting`从你的控制器传递过来：

```
def create
 @comment = Comment.new(params[:comment])
 #you have define here joblisting for example:
  joblisting = JobListing.first #adapt the query to your needs
 respond_to do |format|
  if @comment.save
    if current_user.is_developer?
       #here add joblisting as argument after @developer
       Notifier.developer_notify(@developer, joblisting).deliver
    elsif current_user.is_customer?
       #here add joblisting as argument after @developer
       Notifier.customer_notify(@customerm, joblisting).deliver
    end
    format.html { redirect_to :back, notice: 'Comment was successfully created.' }
    # format.json { render json: @comment, status: :created, location: @comment }
  else
    format.html { render action: "new" }
    # format.json { render json: @comment.errors, status: :unprocessable_entity }
  end
 end
end 
```

在通知邮件程序上

```
def developer_notify(@developer, joblisting)
    @joblisting = joblisting
    mail(:to => @joblisting.current_user.email, :subject => "There's a new comment.")
  end 
```

问候！

# bash - 从此处开始的 SSH 会话 Doc 未正确退出

> ID：14467595
> 
> 赞同：4
> 
> 时间：2013-01-22T20:41:10.423
> 
> 标签：bash, shell, ssh, terminate

在此处文档中执行时，SSH 会话不会终止并返回 tty。下面是我的 shell 脚本中的代码片段：

```
ssh -t -t root@$HOST_ADDRESS <<TERM_STRING
cd /tmp/
sleep 2
exit 0
TERM_STRING 
```

命令 exit 0 后，终端卡住了，不给我回 tty。有什么我做错了吗？

这是我在尝试使用 -v 标志的 SSH 后得到的

```
[root ~]# ssh -v -t -t 10.215.194.38
OpenSSH_4.3p2, OpenSSL 0.9.8e-fips-rhel5 01 Jul 2008
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: Applying options for *
debug1: Connecting to 10.215.194.38 [10.215.194.38] port 22.
debug1: Connection established.
debug1: permanently_set_uid: 0/0
debug1: identity file /root/.ssh/identity type -1
debug1: identity file /root/.ssh/id_rsa type 1
debug1: identity file /root/.ssh/id_dsa type -1
debug1: loaded 3 keys
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.2
debug1: match: OpenSSH_5.2 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_4.3
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-cbc hmac-md5 none
debug1: kex: client->server aes128-cbc hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Host '10.215.194.38' is known and matches the RSA host key.
debug1: Found key in /root/.ssh/known_hosts:5
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received

debug1: Authentications that can continue: publickey,gssapi-with-mic,password
debug1: Next authentication method: gssapi-with-mic
debug1: Unspecified GSS failure.  Minor code may provide more information
Unknown code krb5 195

debug1: Unspecified GSS failure.  Minor code may provide more information
Unknown code krb5 195

debug1: Unspecified GSS failure.  Minor code may provide more information
Unknown code krb5 195

debug1: Next authentication method: publickey
debug1: Trying private key: /root/.ssh/identity
debug1: Offering public key: /root/.ssh/id_rsa
debug1: Server accepts key: pkalg ssh-rsa blen 277
debug1: read PEM private key done: type RSA
debug1: Authentication succeeded (publickey).
debug1: channel 0: new [client-session]
debug1: Entering interactive session.
debug1: Sending environment.
debug1: Sending env LANG = en_US

Last login: Wed Jan 23 14:02:39 2013 from 10.134.232.195
[root@10.215.194.38 ~]# exit 0 
```

对我来说唯一突出的是这条线：

```
debug1: Next authentication method: gssapi-with-mic
debug1: Unspecified GSS failure.  Minor code may provide more information
Unknown code krb5 195 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T16:25:29.310

Just tried on my server and it works (Ubuntu connecting to Centos 6).

Try disabling GSSAPI in the server configuration (comment it out and restart sshd, you won't lose the connection)

If the connection hangs try this:

1.  Look at the PID of the ssh process
2.  Have a look under /proc/ for hints
3.  Look lsof and see if ssh keeps anything open
4.  Check that the client is not configured to automatically setup port forwarding

Regards Alessandro

# c++ - bad_alloc 在初始化和填充向量时？

> ID：14467597
> 
> 赞同：5
> 
> 时间：2013-01-22T20:41:16.003
> 
> 标签：c++, exception, memory-management, vector

在尝试生成随机数向量时，我偶然发现了 std::bad_alloc 错误。这是我的代码：

```
#include "search.h"
#include "gtest/gtest.h"

int _size = 100;

std::vector<int> GetSortedVector(int size){
    //init vector
    std::vector<int> v(size);
    //fill with random numbers
    for (std::vector<int>::size_type i=0; i < v.size(); i++)
        v.push_back( std::rand()%(2*size) );
    //return the setup vector
    return v;
}

//triggered automatically
TEST(BinarySearch, NonUniqueSorted){
    std::vector<int> v = GetSortedVector(_size);//nothing moves farther than this line
} 
```

**PS：**我`generate()`现在确实在使用，但仍然很好奇为什么它失败了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T20:43:19.110

`v.push_back`增加尺寸，所以`i<v.size()`从来没有`false`。

由于您的矢量已经很`size`长，因此您需要用

```
for (std::vector<int>::size_type i=0; i < v.size(); i++)
    v[i] = std::rand()%(2*size); 
```

或`reserve`改用：

```
std::vector<int> v;
v.reserve(size); 
```

保留`push_back`并检查`size`。我不会建议`std::generate`，因为你说你已经这样做了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:43:41.873

放大以下部分：

```
for (std::vector<int>::size_type i=0; i < v.size(); i++)
        v.push_back( std::rand()%(2*size) ); 
```

每次调用时`push_back()`，vector 的大小都会增加 1。因此，`i < v.size()`永远不会评估为 false，并且您的循环将继续进行，直到内存不足。修复它的一种可能方法是捕获`size()`一次，例如：

```
for (std::vector<int>::size_type i=0, s = v.size(); i < s; i++)
        v.push_back( std::rand()%(2*size) ); 
```

# asp.net - ASP.NET OutputCacheAttribute 好得令人难以置信？

> ID：14467601
> 
> 赞同：1
> 
> 时间：2013-01-22T20:41:24.720
> 
> 标签：asp.net, performance, caching

所以我一直在寻找有效的方法来减轻我的 ASP.NET 应用程序中数据库的负载，并且我遇到了`System.Web.Mvc.OutputcCacheAttribute`. 我以前使用过缓存`System.Web.HttpRuntime.Cache`，它似乎在功能上几乎是等效的。我已经对它进行了大量研究，只要你有效地配置它，我所看到的一切都将它描述为缓存请求的某种灵丹妙药。我觉得这很难相信。我知道，一些有效的缓存真正需要（在一定程度上）是根据某些条件存储输出数据，但是仅仅添加一个属性并让你的应用程序神奇地性能更好似乎仍然太容易了。

有没有人对在 ASP.NET 中使用输出缓存的好处/缺点有任何经验？如果是这样，使用这种方法进行缓存的痛点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:21:52.800

根据我的经验，关于这个属性有一件非常明显且经常被遗忘的事情。

事实上，输出被缓存的方法在被缓存后甚至不会被执行。因此，如果操作背后的代码有一些副作用，它们就不会发生（例如，将用户访问页面的事实记录到数据库 DB）。

因此，我至少看到了一些**非常讨厌的**错误。

简短的建议：少量使用它，并 101% 确保团队中的每个开发人员都非常了解它的工作原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:02:51.497

通过用延迟换取内存，缓存*可以创造奇迹。*魔鬼在于“有效地配置它”。

重要的是自己确定应用程序中可接受的行为，例如，如果首页上的“前 3 个帖子”出现 1 分钟之前是否可以？如果“当前用户在线”列表最多 30 秒，可以吗？如果主页需要 0.75 秒加载，是否可以，还是需要更快？您对这些问题的回答将决定什么应该或不应该被缓存。分析您的应用程序，以便您了解真正的性能瓶颈在哪里以及它们存在的原因，以便您知道将优化/缓存工作集中在哪里

.Net 应用程序中有多种形式的缓存可用。 `OutputCache`只是一种形式：

*   应用程序级缓存（由应用程序中的所有内容共享 - `Application[Key]`）
*   对象缓存（通过缓存失效回调自动管理 - `Cache[Key]`）
*   输出缓存（缓存生成的 aspx 页面/部分的输出 -`OutputCache`属性）
*   Per-Request Caching（在单个请求期间缓存计算的数据 - `Context[key]`）
*   会话缓存（缓存特定于用户会话的数据 - `Session[key]`）

它们各有优缺点，设计良好的应用程序可能会使用大部分或所有这些形式的缓存。如果您想考虑一些要点`OutputCache`，这里有一些：

*   尝试缓存页面的一部分而不是整个页面，因为它们更有可能被重用。使用像 a 这样的组件来构建您的页面在`UserControl`这里会有所帮助。
*   使用一组变化很大的参数时要小心，例如`QueryString`每个项目 id 不同的参数，因为您最终会生成大量不经常使用的缓存副本，消耗大量内存而没有什么好处。
*   请注意，这`OutputCache`只是保存生成的 ASPX 标记输出。因此，它不会像动态页面中的其他缓存类型那样工作，这些缓存类型会根据用户输入更改表单。

# php - codeigniter 在同一页面上显示错误消息

> ID：14467602
> 
> 赞同：1
> 
> 时间：2013-01-22T20:41:29.763
> 
> 标签：php, codeigniter

另一个关于codeigniter的问题，这里有一些细节：

查看页面：

```
<?php if (isset($error)){echo $error; } ?>
<form action="<?php echo site_url('mem_posting/post');>" method="post">  
<input type="text" name="fname">
some fields goes here...
</form> 
```

控制器页面（mem_posting）：

```
public function post_form()  
{
$this->load->view('header');  
$this->load->view(form_page);
}

public function post()  
{  
    $post_data=array(  
    'mem_id'=>$this->input->post('mem_id'),  
    //other inputs... 
    )
    $this->load->model('member_model');  
    if ($this->member_model->check_member($post_data)===true)  
    {  

   //row exist  
   // **i would like to load the same page but 
   // **with error message "like already exist".  

    }else{  
         $this->member_model->inset_member($post_data);
    }
} 
```

型号页面：

```
public function insert_member($post_data=array())  
{  
 extract($post_data);
 $this->db->where('member_id', $member_id);
 $this->db->insert('membership', $post_data); 

}

public function check_member($post_data=array())  
{  
    extract($post_data);
    $this->db->select('mem_id');
    $this->db->where('mem_id', $mem_id);
    $query = $this->db->get('membership'); 

    if ($query->num_rows() > 0){
        return true;            
    }else{
         return false;  
    }
} 
```

如您所见，视图页面包含表单，现在我想要实现的是回显像“已经存在”这样的错误，所以我不必在内部编写另一个 $this->load->view('post_form') if 语句。

先感谢您..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:48:17.770

你的意思是只是向视图发送一个变量？

```
$data['error'] = "error message";
$this->load->view('some/view', $data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T23:07:55.670

出色地！您应该在提交表单时运行验证。因此，假设您提交了 2 个字段。它会是这样的：

```
$this->form_validation->set_rules('name', 'Name', 'required|trim|xss_clean');
$this->form_validation->set_rules('mem_id', 'ID Member', 'required|trim|is_unique[yourtable.mem_id]|xss_clean');
    if ($this->form_validation->run()){
       // Do your cool stuff now because validation passed
    }else{
       // Whatever...validation fails, load your view.
    } 
```

所以在你看来，你应该在表格顶部有这样的东西：

```
<?php echo validation_errors(); ?> 
```

is_unique[yourtable.mem_id] 将验证输入在您的数据库中是否唯一。所以如果真的是独一无二的，OK。

# python - python tkinter 列表框事件绑定

> ID：14467604
> 
> 赞同：0
> 
> 时间：2013-01-22T20:41:35.483
> 
> 标签：python, listbox, widget, tkinter

我无法让事件绑定与 python/tkinter 一起使用。我只是想点击并打印位置，但每次我这样做时，结果都是“-1”。

这是我的代码

```
from Tkinter import *
import Tkinter

class make_list(Tkinter.Listbox):

    def __init__(self,master, **kw):
        frame = Frame(master)
        frame.pack()
        self.build_main_window(frame)

        kw['selectmode'] = Tkinter.SINGLE
        Tkinter.Listbox.__init__(self, master, kw)
        master.bind('<Button-1>', self.click_button)
        master.curIndex = None

    #display the clicked location
    def click_button(self, event):
        self.curIndex = self.nearest(event.x)
        print self.curIndex

    #display the window, calls the listbox
    def build_main_window(self, frame):
        self.build_listbox(frame)

    #listbox
    def build_listbox(self, frame):
        listbox = Listbox(frame)
        for item in ["one", "two", "three", "four"]:
            listbox.insert(END, item)    
        listbox.insert(END, "a list entry")
        listbox.pack()
        return

if __name__ == '__main__':
    tk = Tkinter.Tk()
    make_list(tk)
    tk.mainloop() 
```

**更新的代码 - 我摆脱了框架，但我似乎无法弄清楚为什么我在函数 click_button 中的第一个打印语句得到 -1**

```
from Tkinter import *
import Tkinter

class make_list(Tkinter.Listbox):

    #display the clicked location
    def click_button(self, event):
        ##this block works
        w = event.widget
        index = int(w.curselection()[0])
        value = w.get(index)
        print value
        ##this doesn't
        self.curIndex = self.nearest(event.y)
        print self.curIndex
        self.curIndex = event.widget.nearest(event.y)
        print self.curIndex

    #display the window, calls the listbox
    def build_main_window(self):
        self.build_listbox()

    #listbox
    def build_listbox(self):
        listbox = Listbox()
        listbox.bind('<<ListboxSelect>>', self.click_button)
        for item in ["one", "two", "three", "four"]:
            listbox.insert(END, item)    
        listbox.insert(END, "a list entry")
        listbox.pack()
        return

if __name__ == '__main__':
    tk = Tkinter.Tk()
    start = make_list(tk)
    start.build_main_window()
    start.mainloop() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T14:09:44.057

在答案的评论中，您要求最佳实践。最佳做法是绑定到`<<ListboxSelect>>`在列表框中选择项目后立即触发的哪个。

[This answer](https://stackoverflow.com/a/12936031/7432) to a similar question有一个例子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:46:56.740

`listbox`找到最近的项目`y`，而不是`x`。

```
 self.nearest(event.x)     # wrong
 self.nearest(event.y)     # right 
```

更新：我首先没有注意到真正的问题：

```
 listbox = Listbox(frame) 
```

它与您子类化的列表框不同，它是另一个不相关的列表框。*您的*列表框（即*make_list*）是空的，这就是为什么它总是返回 -1 表示最近的。

也许子类化一个框架是一个好主意（无论如何，比子类化列表框并在其中添加一个带有另一个列表框的框架更好）。然后你必须在那个不为空的*真实列表框上绑定事件。*

*查看修复后*如何工作的快速方法是调用`nearest`一个真正的列表框`event.widget`：

```
self.curIndex = event.widget.nearest(event.y) 
```

# c# - ModelState.isValid 为 false，因为 Id 模型属性与传递的参数冲突

> ID：14467605
> 
> 赞同：4
> 
> 时间：2013-01-22T20:41:39.780
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我对 MVC 还是很陌生，很难弄清楚如何最好地解决这个问题。

我有一个自动脚手架`"Create" (GET)`操作的修改版本，它采用可选参数（下拉列表的默认值）。然后它将其表单提交给`"Create" (HTTPPost)`操作。

```
public ActionResult Create(string id = null)
{ 
    //use id to pick a default item in a drop down list.
}

[HttpPost]
public ActionResult Create(Registration registration)
{ 
    //this method doesn't care one iota what was passed to the GET method
    // but registration.id is invalid because it's trying to set it to the value that was passed to the get method.  If id in the get method is not passed, then everything is fine
} 
```

问题是，如果将值传递给 GET 创建操作，则`ModelState.isValid`该操作为 false，`POST create`因为它试图将传递给 GET 操作的值填充到 POST 操作中模型的主键 (Id) 字段中（应该省略，因为它是自动生成的。

我知道我可以将主键列名更改为 Id 以外的名称，但我无法控制数据库，并且正在尝试找出解决此问题的另一种方法。

如果我尝试将 GET 操作上的参数从 'id' 重命名为其他名称，那么我必须将链接从 `CREATE/paramValue` to更改为`CREATE/?paramName=paramValue`我宁愿不这样做。（尽管如果这是唯一简单的方法，我会这样做）。

有没有办法让 POST 操作忽略传递给 GET 操作的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:44:07.160

我认为您要做的是使用它应该创建的对象类型的 ID 参数化控制器的 Create 方法。

虽然 ASP.NET MVC 中的参数名称没有硬性规定，但我认为大多数人希望调用的参数`id`引用正在处理的对象，而不是它的属性。

考虑到这一点，我对您的建议是执行以下操作：

1.  将 Create 方法的 GET 版本中的参数重命名为合适的类型，例如 typeId 或其他名称，因此签名看起来像`public ActionResult Create(string typeId = null)`

2.  向 中添加自定义路由`MvcApplication`，这将让您拥有良好的格式`/Create/typeId`，而不是强制拥有`/Create?typeId=value`

您可以通过在默认路由之前添加以下代码行来做到这一点：

```
routes.MapRoute
(
    name: "CreateGet",
    url: "Controller/Create/{typeId}",
    defaults: new
    {
        controller = "Controller",
        action = "Create",
        typeId = UrlParameter.Optional
    }
); 
```

默认路由如下所示：

```
routes.MapRoute
(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new
    {
        controller = "Site",
        action = "Index",
        id = UrlParameter.Optional
    }
); 
```

我认为这将解决您的问题，但请确保我建议的自定义路线位于默认路线之前。

**更新：**

您有一个 Get 方法和一个 Post 方法。

Get 方法（可能）创建一个视图模型对象并将其发送到视图，视图呈现它。或者，您的视图可以在 HTML 中硬编码或通过 AJAX 调用注入各种输入。不管他们是如何到达那里的，你呈现给 Web 浏览器的视图看起来像这样：

```
<html>
<head />
<body>
<form>
<input id="Input1" ... />
<select id="Select1" ... />
</form>
</body>
</html> 
```

上面是一个大大简化的 HTML 结构。

输入的 ID 与回发此页面时将创建的视图模型对象内的属性名称相匹配，即`Registration`类的实例。

在返回的途中（返回 Post 方法），模型绑定器从请求中获取值（查询字符串参数、表单值等）并将它们绑定回提供给 Post 方法的模型对象。

在您的情况下，最有可能发生的事情是`id`Get 方法（和呈现的视图）`id`中的含义与`Registration`提供给 Post 方法的对象中的含义不匹配。

不匹配的原因是`Registration.Id`属性名称是由数据库决定的，并且`Create(string id)`是由默认路由决定的，但它们实际上是不同的东西，所以应该命名不同。

这使得您需要有一个干净的 /Create/id 表单的 URL，这可以通过自定义路由轻松完成。

现在，如果您真的想从模型绑定逻辑中排除一个参数，那么您将使用另一个答案，它使用`Registration`Post 方法的参数上的属性来明确告诉`DefaultModelBinder`从绑定逻辑中排除该参数。

完成此操作后，在实例化和运行构造函数之后，它所绑定的属性将保留 CLR 赋予它的默认值。

ASP.NET MVC 还支持自定义模型绑定器，如果需要，它可以显着改变模型绑定逻辑，尽管这不适用于您的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:21:26.543

尝试使用`BindAttribute`：

```
[HttpPost]
public ActionResult Create([Bind(Exclude = "RegistrationId")]Registration registration)
{ 

} 
```

绑定到模型时，它将省略`RegistrationId`POSTed with 表单...

# css - 防止 CSS3 动画重新启动

> ID：14467616
> 
> 赞同：3
> 
> 时间：2013-01-22T20:42:27.253
> 
> 标签：css, css-transitions

很多人需要重新启动他们的 CSS3 动画；好吧，我想要完全相反的：

如果我通过添加正确的 css 类来启动动画，动画就会启动；如果我随后使用一系列 parentNode.insertBefore 调用（并重用相同的节点实例）对容器进行排序，则动画每次都会重新启动。

我能做些什么来防止这种行为吗？

这是一个显示这种行为的小提琴：http: [//jsfiddle.net/v66G5/17/](http://jsfiddle.net/v66G5/17/)

单击全部添加，让动画播放几秒钟，然后单击随机播放：任何移动的节点都会重新启动动画。

```
container.insertBefore(node, childrenClone[Math.floor(Math.random() * childrenClone.length)]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:22:07.980

取自[http://dev.w3.org/csswg/css3-animations/](http://dev.w3.org/csswg/css3-animations/)

> 通过在文档加载后修改样式在元素上指定的动画将在解析样式时开始。这可能是在诸如悬停之类的伪样式规则的情况下立即发生，或者可能是在脚本引擎将控制权返回给浏览器时（在脚本应用样式的情况下）。
> 
> 如果元素具有引用有效关键帧规则的“动画名称”值，则动画应用于元素。一旦动画开始，它就会继续，直到它结束或“动画名称”被删除。用于关键帧和动画属性的值在动画开始时进行快照。在动画执行期间更改它们没有效果

删除和插入节点会导致元素重新计算样式，所以我认为简单的 css 无法实现您想要的。

使用 jQuery 实现它的一种可能方法是在删除节点时拍摄不透明度和动画结束时间的快照，并在插入节点后将其设置回来（即，对于 10 秒动画，如果单击随机播放，则在 5 秒后，从 50% 的不透明度开始，动画的持续时间为 5s）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T02:25:18.510

当您可以改组它们的 CSS 位置时，为什么还要操作 DOM 元素？

[http://jsfiddle.net/v66G5/19/](http://jsfiddle.net/v66G5/19/)

```
children.each(function() {
    var $node = $(this),
        $node2 = $(children[Math.floor(Math.random() * children.length)]),
        tmp = $node.position().top;

    $node.css("top", $node2.position().top + 'px');
    $node2.css("top", tmp + 'px');
}); 
```

# verilog - Verilog，通用加法器树

> ID：14467617
> 
> 赞同：4
> 
> 时间：2013-01-22T20:42:27.847
> 
> 标签：verilog

所以，我正在尝试在verilog中编写一个加法器树。它的通用部分是它具有可配置数量的要添加的元素和可配置的字长。但是，我遇到一个又一个问题，我开始质疑这是解决我的问题的正确方法。（我将在一个更大的项目中使用它。）绝对可以对加法器树进行硬编码，尽管这会占用大量文本。

所以，我虽然会和你核对一下你对它的看法。这是“这样做的方法”吗？我也愿意就不同的方法提出建议。

我还可以提到我对verilog很陌生。

如果有人感兴趣，这是我当前的非工作代码：（我不指望你解决问题；我只是为了方便起见。）

```
module adderTree(
    input clk,
    input [`WORDSIZE * `BANKSIZE - 1 : 0] terms_flat,
    output [`WORDSIZE - 1 : 0] sum
);

genvar i, j;

reg [`WORDSIZE - 1 : 0] pipeline [2 * `BANKSIZE - 1 : 0];   // Pipeline array
reg clkPl = 0;                                              // Pipeline clock

assign sum = pipeline[0];

// Pack flat terms
generate
    for (i = `BANKSIZE; i < 2 * `BANKSIZE; i = i + 1) begin
        always @ (posedge clk) begin
            pipeline[i] <= terms_flat[i * `WORDSIZE +: `WORDSIZE];
            clkPl = 1;
        end
    end
endgenerate

// Add terms logarithmically
generate
    for (i = 0; i < $clog2(`BANKSIZE); i = i + 1) begin
        for (j = 0; j < 2 ** i; j = j + 1) begin
            always @ (posedge clkPl) begin
                pipeline[i * (2 ** i) + j] <= pipeline[i * 2 * (2 ** i) + 2 * j] + pipeline[i * 2 * (2 ** i) + 2 * j + 1];
            end
        end
    end
endgenerate

endmodule 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T21:43:32.100

以下是一些您可能会觉得有用的评论：

## 时钟

在您的设计中使用尽可能少的时钟通常是件好事（最好只有一个）。

在这种特殊情况下，您似乎正在尝试生成新时钟**clkPl**，但这不起作用，因为它永远不会返回到 0。（“reg clkPl=0;”将在时间 0 将其重置为 0，然后设置在“clkPl = 1;”中永久为 1。）

您可以通过简单地替换来解决此问题

```
always @ (posedge clkPl) 
```

和

```
always @ (posedge clk) 
```

## 作业

仅在组合块中使用阻塞分配，在时钟块中使用非阻塞是一种很好的形式。您在“打包扁平术语”部分中混合了阻塞和非阻塞分配。

由于您不需要**clkPl**，您可以简单地删除带有阻塞分配的行 ("clkPl = 1;")

## 树结构

你的双 for 循环：

```
for (i = 0; i < $clog2(`BANKSIZE); i = i + 1) begin
    for (j = 0; j < 2 ** i; j = j + 1) begin
        always @ (posedge clkPl) begin
            pipeline[i * (2 ** i) + j] <= pipeline[i * 2 * (2 ** i) + 2 * j] + pipeline[i * 2 * (2 ** i) + 2 * j + 1];
        end
    end
end 
```

看起来它将访问不正确的元素。

例如，对于 BANKSIZE = 2 **8，**i**将计数到 7，此时 "pipeline[i * (2 ** i) + j]"="pipeline[7*2**7+j]"=" pipeline[896+j] 将超出数组的范围。（数组中有 2*BANKSIZE=512 个元素。）

我认为您实际上想要这种结构：

```
assign sum = pipeline[1];
for (i = 1; i < `BANKSIZE; i = i + 1) begin
    always @ (posedge clk) begin
        pipeline[i] <= pipeline[i*2] + pipeline[i*2 + 1];
        end
    end 
```

## 更低的延迟

请注意，大多数 Verilog 工具非常擅长合成多个元素的添加，因此您可能需要考虑在层次结构的每个级别组合更多术语。

（添加更多项的成本比人们预期的要低，因为这些工具可以使用诸如[进位保存加法器](http://en.wikipedia.org/wiki/Carry-save_adder)之类的优化来减少门延迟。）

# jquery - jquery阻止元素在点击时隐藏

> ID：14467620
> 
> 赞同：0
> 
> 时间：2013-01-22T20:42:32.220
> 
> 标签：jquery

我有一个简单的函数，它插入一个动画“工作”图像，然后显示“完成！” POST 完成后。但是，我希望这一次发生在多个地方。

示例：http: [//veretekk.com/developer/temp/](http://veretekk.com/developer/temp/)

更多详细信息在上面的页面中进行了概述，但基本上 #dialog 元素在单击其中包含的按钮时隐藏。另外... jquery 使用`.on`而不是`$(document).ready(function() {`在加载 DOM 后，此内容可能会出现在我的网站上，因此需要始终可用。帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T22:16:18.590

我认为您的很多问题都在于您确定是否隐藏对话框的复杂方式。

与其尝试拦截每个文档点击并确定其目标，不如让 jQuery 处理细节：

```
$(document).on('click', function (event) {
    // If the document is clicked, hide the dialog
    $('#dialog').hide();
});

$(document).on('click', '#dialog', function (event) {
    // If the dialog is clicked, stop the propagation
    // of the click event to the document
    // The first handler will never be called
    event.stopPropagation();
}); 
```

简化演示：http: [//jsfiddle.net/jtbowden/M93dZ/](http://jsfiddle.net/jtbowden/M93dZ/)

# c# - 传输大型实时分析数据

> ID：14467622
> 
> 赞同：0
> 
> 时间：2013-01-22T20:42:35.623
> 
> 标签：c#, javascript, asp.net, ajax, socket.io

我目前正在使用 Asp.Net + C# 设计一个实时分析站点，我想知道将数据从服务器传输到客户端的最佳方法是什么，这是我到目前为止所想到的；

1.  使用 Asp.Net AJAX UpdatePanel，并使用 JavaScript 使用计时器定期更新它。

2.  创建一个服务器应用程序（在 C#、Java、Node.Js 或 Ruby 中）并使用 Socket IO 从中检索恒定的数据流。

3.  创建一个返回大量数据的 JSON Web 服务，我可以使用 JQuery/AJAX 来请求它并在页面上实时处理它。

这些中的任何一个似乎是个好主意，或者他们还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:52:31.687

我永远不会使用更新面板，它对你的工作来说太重了。常规的 ajax 调用可以正常工作并编写一个 webApi 服务。Websockets 也可以很好地工作，但有点复杂。根据您的时间，您可能需要查看[SignalR](http://www.asp.net/vnext/overview/signalr/signalr-and-web-sockets)，它是一个 websocket 客户端解决方案，如果浏览器不支持 websocket，它可以退回到轮询。

# sql - 如何将 X% 的行更新为 A，将 Y% 的行更新为 B，将 Z% 的行更新为 C

> ID：14467626
> 
> 赞同：7
> 
> 时间：2013-01-22T20:42:54.517
> 
> 标签：sql, sql-server, sql-server-2008

我有一张这样的桌子：

```
Products
(
   ID int not null primary key,
   Type int not null,
   Route varchar(20) null
) 
```

我在客户端上有一个这种格式的列表：

```
Type=1, Percent=0.4, Route=A
Type=1, Percent=0.4, Route=B
Type=1, Percent=0.2, Route=C
Type=2, Percent=0.5, Route=A
Type=2, Percent=0.5, Route=B
Type=3, Percent=1.0, Route=C
...etc 
```

完成后，我想将 40% 的 1 类产品分配给 Route A，40% 分配给 Route B，20% 分配给 Route C。然后 50% 的 2 类产品分配给 Route A，50% 的 2 类产品分配给 Route乙等。

有没有办法在单个更新语句中做到这一点？

如果不是在一个巨大的语句中，是否可以在每个类型一个语句或每个路由一个语句中完成？目前我们正在为每种类型+路线做一个，以上任何一项都会是一种改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:00:18.750

这是我在您发布您正在使用 SQL-Server 之前准备的 Oracle 声明，但它可能会给您一些想法，尽管您必须使用 CTE 和自联接来滚动您自己的 ratio_to_report 分析函数。我们计算产品和客户端路由表中每种类型的累积比例，并对匹配的比例带进行非等连接。我使用的样本数据有一些四舍五入，但对于较大的数据集，这些数据会减少。

这是设置：

```
create table products (id int not null primary key, "type" int not null, route varchar (20) null);
create table clienttable ( "type" int not null, percent number (10, 2) not null, route varchar (20) not null);
insert into clienttable ("type", percent, route) values (1, 0.4, 'A');
insert into clienttable ("type", percent, route) values (1, 0.4, 'B');
insert into clienttable ("type", percent, route) values (1, 0.2, 'C');
insert into clienttable ("type", percent, route) values (2, 0.5, 'A');
insert into clienttable ("type", percent, route) values (2, 0.5, 'B');
insert into clienttable ("type", percent, route) values (3, 1.0, 'C');

insert into products (id, "type", route) values (1, 1, null);
insert into products (id, "type", route) values (2, 1, null);
insert into products (id, "type", route) values (3, 1, null);
insert into products (id, "type", route) values (4, 1, null);
insert into products (id, "type", route) values (5, 1, null);
insert into products (id, "type", route) values (6, 1, null);
insert into products (id, "type", route) values (7, 1, null);
-- 7 rows for product type 1 so we will expect 3 of route A, 3 of route B, 1 of route C (rounded)

insert into products (id, "type", route) values (8, 2, null);
insert into products (id, "type", route) values (9, 2, null);
insert into products (id, "type", route) values (10, 2, null);
insert into products (id, "type", route) values (11, 2, null);
insert into products (id, "type", route) values (12, 2, null);
-- 5 rows for product type 2 so we will expect 3 of route A and 2 of route B (rounded)

insert into products (id, "type", route) values (13, 3, null);
insert into products (id, "type", route) values (14, 3, null);
-- 2 rows for product type 3 so we will expect 2 of route C 
```

这是声明

```
select prods.id, prods."type", client.route cr from
(
select
p.id, 
p."type", 
row_number () over (partition by p."type" order by p.id) / count (*) over (partition by p."type") cum_ratio
from
products p
) prods
inner join 
(
select "type", route, nvl (lag (cum_ratio, 1) over (partition by "type" order by route), 0) ratio_start, cum_ratio ratio_end from 
(select "type", route, sum (rr) over (partition by "type" order by route) cum_ratio
from (select c."type", c.route, ratio_to_report (c.percent) over (partition by "type") rr from clienttable c))) client 
on prods."type" = client."type" 
and prods.cum_ratio >= client.ratio_start and prods.cum_ratio < client.ratio_end 
```

这给出了以下结果：-

```
+----+------+----+
| ID | type | CR |
+----+------+----+
|  1 |    1 | A  |
|  2 |    1 | A  |
|  3 |    1 | B  |
|  4 |    1 | B  |
|  5 |    1 | B  |
|  6 |    1 | C  |
|  8 |    2 | A  |
|  9 |    2 | A  |
| 10 |    2 | B  |
| 11 |    2 | B  |
| 13 |    3 | C  |
+----+------+----+ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:17:04.587

像这样的东西怎么样

```
--For updating type 1, set every route for type 1 as null.

UPDATE MyTable
SET [Route] = null
WHERE [Type] = '1'

--Update Route A(40%)
DECLARE @myVal int;
SET @myVal  =CAST(0.4*(SELECT COUNT(*) FROM myTable WHERE [Type]='1') AS INT);
WITH    tab AS
    (
    SELECT  TOP (@myVal) *
    FROM myTable
    )
UPDATE  tab
SET     [Route] = 'A'
WHERE [Route] is null

--Update Route B (40%)
DECLARE @myVal int;
SET @myVal  =CAST(0.4*(SELECT COUNT(*) FROM myTable WHERE [Type]='1') AS INT);
WITH    tab AS
    (
    SELECT  TOP (@myVal) *
    FROM myTable
    )
UPDATE  tab
SET     [Route] = 'B'
WHERE [Route] is null

--Update Route C (20%)
DECLARE @myVal int;
SET @myVal  =CAST(0.2*(SELECT COUNT(*) FROM myTable WHERE [Type]='1') AS INT);
WITH    tab AS
    (
    SELECT  TOP (@myVal) *
    FROM myTable
    )
UPDATE  tab
SET     [Route] = 'C'
WHERE [Route] is null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:26:16.720

我不知道 SQL Server 中是否存在类似的功能。在 Oracle 中有 SAMPLE 子句。下面的查询从表中选择 10% 的行：

```
SELECT empno
  FROM scott.emp
SAMPLE (10)
/ 
```

那么你的更新会很容易......也许SQL Server中存在类似的东西。您还可以计算行数或数据，然后计算百分比然后更新...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T22:17:33.853

```
WITH po AS
  ( SELECT 
        ID,
        Type,
        ROW_NUMBER() OVER ( PARTITION BY Type
                            ORDER BY ID
                          ) AS Rn,
        COUNT(*) OVER (PARTITION BY Type) AS CntType
    FROM
          Products
  )    
, ro AS
  ( SELECT 
        Type,
        Route,
        ( SELECT SUM(rr.Percent) 
          FROM Route AS rr 
          WHERE rr.Type = r.Type 
            AND rr.Route <= r.Route
        ) AS SumPercent 
    FROM
          Routes AS r
  )
UPDATE p
SET p.Route =
            ( SELECT MIN(ro.Route) 
              FROM ro 
              WHERE ro.Type = po.Type 
                AND ro.SumPercent >= po.Rn / po.CntType
            )
FROM    Products AS p
    JOIN
        po   ON po.ID = p.ID ; 
```

# javascript - 将对象转换为字符串值

> ID：14467627
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:42:56.150
> 
> 标签：javascript, jquery

```
jQuery.each(input, function(key, value){
    jQuery('<div/>', {
        class: 'info',
        id: value.id,
        text: jQuery('<div/>', {class: 'image', text: '<img src="'+value.image+'">'})+jQuery('<div/>', {class: 'text_data', text: value.name})
    }).appendTo('#list');
}); 
```

是否有可能以某种方式将对象转换为`text`属性中的字符串（应该没有循环）。如果需要，可以用函数包装。

**更新：**

```
<div class="info" id="29">[object Object][object Object]</div>
<div class="info" id="30">[object Object][object Object]</div>
<div class="info" id="31">[object Object][object Object]</div> 
```

所以我需要更新这一行`jQuery('<div/>', {class: 'image', text: '<img src="'+value.image+'">'})+jQuery('<div/>', {class: 'text_data', text: value.name})`，以便有一个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:47:59.300

尝试

```
 $('<div>').append($('#item-of-interest').clone()).html(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T20:49:32.137

你可以使用`JSON.stringify`，它序列化一个对象。大多数现代浏览器都天真地支持这种方法，但对于那些不支持的浏览器，您可以包含一个 JS 版本：

```
var obj = {
  name: 'myObj'
};

JSON.stringify(obj); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T20:57:34.523

我将扩展雷切尔的答案

您在这里创建两个元素

```
jQuery('<div/>', {class: 'image', text: '<img src="'+value.image+'">'})+jQuery('<div/>', {class: 'text_data', text: value.name}) 
```

要将其作为字符串获取.. 创建一个容器元素并附加这两个元素.. 这样您就可以通过调用 .html() 将其作为 html 字符串返回

```
$('<div/>') // create a div container
   .append(jQuery('<div/>', {class: 'image', text: '<img src="'+value.image+'">'})) // append objects
   .append(jQuery('<div/>', {class: 'text_data', text: value.name}))
   .html() // <-- now you have it as a string 
```

# multithreading - 澄清 OpenSSL 0.9.8L 并发支持 - 如果非并发完成，SSL 实例是否可以被多个线程使用？

> ID：14467630
> 
> 赞同：8
> 
> 时间：2013-01-22T20:43:05.647
> 
> 标签：multithreading, ssl, concurrency, openssl

我们有一个使用套接字 10 年的多线程网络应用程序，现在我们正尝试使用 OpenSSL 0.9.8L 保护该应用程序。多年来，应用程序的网络协议被设计为利用单套接字连接的双工特性；应用程序同时在同一个套接字上读取和写入。应用程序自己管理底层套接字，并通过 SSL_set_fd 将套接字描述符传递给 OpenSSL。

我们为多线程支持配置了 OpenSSL，同时设置了静态和动态锁定回调，例如 CRYPTO_set_id_callback()、CRYPTO_set_locking_callback() 等。在大多数情况下，应用程序运行良好，但我们看到了一些异常情况。为了帮助我们确定原因，对几个问题的明确回答会有所帮助。

OpenSSL 常见问题页面声明 OpenSSL 是线程安全的，但坚持单个“SSL 连接可能不会被多个线程同时使用”。

[http://www.openssl.org/support/faq.html#PROG1](http://www.openssl.org/support/faq.html#PROG1)

1.  对或错。OpenSSL 连接 API 调用（SSL_Read、SSL_Write 等）可能在同一个 SSL 实例上同时执行（SSL_new 调用返回的指向 SSL 的指针）？
2.  对或错。对于启用 SSL_MODE_AUTO_RETRY 的阻塞套接字，线程 A 可以在 SSL 实例 X 上调用 SSL_Read() 而线程 B 在 SSL 实例 X 上同时调用 SSL_Write()？
3.  对或错。当应用程序使用非阻塞套接字并防止在同一 SSL 实例上同时执行 SSL_Read 和 SSL_Write（以及其他连接 API 调用）时，OpenSSL 可以正常工作吗？
4.  对或错。SSL_new 返回的 OpenSSL SSL 实例绑定到名为 SSL_new 的单个线程；绑定意味着 SSL 实例不能与任何其他线程共享，SSL 实例仅对调用 SSL_new 的线程有效？
5.  对或错。如果线程A i) 调用SSL_new，获得一个SSL 实例X 并且ii) 使用SSL 实例X 调用SSL_Read。如果线程B 非并发地使用同一个SSL 实例X 调用SSL_Read/SSL_Write，最终会失败？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T05:47:05.520

1.对或错。OpenSSL 连接 API 调用（SSL_Read、SSL_Write 等）可能在同一个 SSL 实例上同时执行（SSL_new 调用返回的指向 SSL 的指针）？

***错误。不，您不能在同一个 SSL 实例上同时使用 SSL_read / SSL_write。***

2.对或错。对于启用 SSL_MODE_AUTO_RETRY 的阻塞套接字，线程 A 可以在 SSL 实例 X 上调用 SSL_Read() 而线程 B 在 SSL 实例 X 上同时调用 SSL_Write()？

***与上述相同的答案。使用或不使用 SSL_MODE_AUTO_RETRY，您不能同时使用同一个 SSL 实例 X 来并行执行 SSL_read 和 SSL_write***

3.对或错。当应用程序使用非阻塞套接字并防止在同一 SSL 实例上同时执行 SSL_Read 和 SSL_Write（以及其他连接 API 调用）时，OpenSSL 可以正常工作吗？

***真的。如果没有并发执行，那么 OpenSSL 可以很好地用于阻塞和非阻塞套接字。***

4.对或错。SSL_new 返回的 OpenSSL SSL 实例绑定到名为 SSL_new 的单个线程；绑定意味着 SSL 实例不能与任何其他线程共享，SSL 实例仅对调用 SSL_new 的线程有效？

***错误的。SSL 实例未通过 OpenSSL 本身绑定到任何线程。只要在任何一个时间点只有一个线程使用单个 SSL 实例，您就可以在另一个线程中使用在一个线程中创建的 SSL 实例。***

5.对或错。如果线程A i) 调用SSL_new，获得一个SSL 实例X 并且ii) 使用SSL 实例X 调用SSL_Read。如果线程B 非并发地使用同一个SSL 实例X 调用SSL_Read/SSL_Write，最终会失败？

***错误的。线程 A 和线程 B 都可以使用同一个 SSL 实例 X，只要两者都不对 SSL 实例 X 进行并发操作。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-25T09:31:32.660

实验证明，如果 SSL 连接已经通过了协商阶段，并且之后没有重新协商，那么 SSL_read 和 SSL_write 同时使用证明是没有害处的。这是根据我的测试，我将 OpenSSL 与 Push Framework（一个多线程网络库）集成在一起。然而，在我们阅读的任何地方，OpenSSL 专业人士都坚持认为同一上下文不能被多个线程同时使用。

# gmp - += 用于 GMP 浮点函数？

> ID：14467632
> 
> 赞同：0
> 
> 时间：2013-01-22T20:43:11.113
> 
> 标签：gmp

是否可以像这样使用 GMP 浮点函数执行“+=”？

```
mpf_add (op1, op1, op2); 
```

或者三个参数必须总是不同的（需要使用临时变量）？

（同样的问题也适用于乘法、减法和除法，尽管我确信所有四种情况的答案都是相同的。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:20:55.577

GMP手册指出：

> GMP 允许您在一次调用中为输入和输出使用相同的变量。

我已经使用各种 GMP 功能做到了这一点，并且它一直都能正常工作，但我不知道我是否曾经使用 mpf 功能做到过。我通常使用 MPFR 库，它声明您也可以将相同的变量用于输入和输出。

# jquery - jQuery 自动完成 - 多项选择

> ID：14467634
> 
> 赞同：1
> 
> 时间：2013-01-22T20:43:12.967
> 
> 标签：jquery, autocomplete, jquery-autocomplete

我正在尝试将 jQuery 与多个选择一起使用

[http://jqueryui.com/autocomplete/#multiple-remote](http://jqueryui.com/autocomplete/#multiple-remote)

**js 完美运行，但是，当我将上述 url 中第58 行**的占位符更改为 分号时，它不起作用。

> this.value = terms.join( **";"** );

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:50:25.223

此脚本设置为使用逗号分隔符，而不是分号，因此您还需要更改第 19 行：

```
return val.split( /,\s*/ ); 
```

对此：

```
return val.split( /;\s*/ ); 
```

# oracle - 如何在 SSIS 数据流源中设置 SDE 版本

> ID：14467641
> 
> 赞同：0
> 
> 时间：2013-01-22T20:43:58.240
> 
> 标签：oracle, ssis, gis

我有一个 GIS oracle 数据库，我需要在 SSIS 数据流任务中引用。理想情况下，我通常会做这样的事情（在 Oracle SQL Developer 中完美运行）：

```
execute sde.version_util.set_current_version('SAFE.mvedits')
SELECT CAD_EVENTID
FROM SAFE.INCIDENT_POINT_MV 
```

但是，当我尝试将其用作我的 OLE DB 数据源的 SQL 命令时，它会引发“无效 SQL”错误。

如何在 SSIS 数据流任务数据源中设置 SDE 版本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:52:00.577

对甲骨文一无所知，您可能会尝试的是

1.  在您的 Oracle Connection Manager 中，将该属性更改`RetainSameConnection`为 True。这意味着Oracle 的所有连接都将使用同一个线程。

2.  在与 Oracle 对话的数据流之前添加一个执行 SQL 任务。在那里使用您的查询来修改当前版本的东西。此设置应保留在连接上。

3.  在您的 OLE DB 数据源中，从 SELECT 语句开始。

您可能还需要将 DelayValidation 设置为 true。

如果这不起作用，请告诉我，我会看看我是否能想出其他办法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T18:20:37.573

事实证明，这是通过第三方应用程序与 GIS Oracle 数据库交互的不足之处。在我的情况下，我们通过将更改捆绑在位于 oracle 服务器上的存储过程中并从 SSIS 内部调用该存储过程来解决这个问题。

# mysql - Mysql，数据透视表在 sqlfiddle 中工作，但在 phpmyadmin 中不工作

> ID：14467644
> 
> 赞同：1
> 
> 时间：2013-01-22T20:44:00.677
> 
> 标签：mysql, pivot, sqlfiddle

我最近发布了一个关于旋转 mysql 结果的问题，该问题得到了奇迹般的回答。尽管它已在随附的 sqlfiddle 中解决并运行，但当我将它带回我的数据库（在 phpmyadmin 中）时，我似乎无法使查询正常工作。我检查了版本，小提琴是 5.1.61 版本，我的 MySql 是 5.1.66-cll。有什么想法吗？这是小提琴：[http](http://sqlfiddle.com/#!8/59727/1) : //sqlfiddle.com/#!8/59727/1 感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:13:38.103

根据您的评论和之前关于旋转的问题。听起来您需要增加[`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数的长度。

默认长度为 1024。

要更改长度，您需要在代码生成动态 sql 查询之前使用以下内容：

```
SET [GLOBAL | SESSION] group_concat_max_len = val; 
```

您可以更改`GLOBAL`或`SESSION`长度并将 替换为`val`您需要的长度。

# css - 如何使边缘变圆

> ID：14467646
> 
> 赞同：-3
> 
> 时间：2013-01-22T20:44:05.947
> 
> 标签：css

我有这个 css 代码，用于 JSF 页面中的标题背景。

```
.container{
    background: rgb(180,221,180); /* Old browsers */
    background: -moz-linear-gradient(45deg, rgba(180,221,180,1) 0%, rgba(95,163,9,1) 0%, rgba(95,163,9,1) 48%, rgba(0,87,0,1) 68%, rgba(0,0,0,1) 86%); /* FF3.6+ */
    background: -webkit-gradient(linear, left bottom, right top, color-stop(0%,rgba(180,221,180,1)), color-stop(0%,rgba(95,163,9,1)), color-stop(48%,rgba(95,163,9,1)), color-stop(68%,rgba(0,87,0,1)), color-stop(86%,rgba(0,0,0,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(45deg, rgba(180,221,180,1) 0%,rgba(95,163,9,1) 0%,rgba(95,163,9,1) 48%,rgba(0,87,0,1) 68%,rgba(0,0,0,1) 86%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(45deg, rgba(180,221,180,1) 0%,rgba(95,163,9,1) 0%,rgba(95,163,9,1) 48%,rgba(0,87,0,1) 68%,rgba(0,0,0,1) 86%); /* Opera 11.10+ */
    background: -ms-linear-gradient(45deg, rgba(180,221,180,1) 0%,rgba(95,163,9,1) 0%,rgba(95,163,9,1) 48%,rgba(0,87,0,1) 68%,rgba(0,0,0,1) 86%); /* IE10+ */
    background: linear-gradient(45deg, rgba(180,221,180,1) 0%,rgba(95,163,9,1) 0%,rgba(95,163,9,1) 48%,rgba(0,87,0,1) 68%,rgba(0,0,0,1) 86%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b4ddb4', endColorstr='#000000',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
    /*
        background:-webkit-gradient(linear, left top, left bottom, color-stop(0, #5fa309), color-stop(1, #3b8018));
        background:-webkit-linear-gradient(top, #5fa309 0%, #3b8018 100%);
        background:-moz-linear-gradient(top, #5fa309 0%, #3b8018 100%);
        background:-o-linear-gradient(top, #5fa309 0%, #3b8018 100%);
        background:-ms-linear-gradient(top, #5fa309 0%, #3b8018 100%);
        background:linear-gradient(top, #5fa309 0%, #3b8018 100%);
    */
    position:relative;
    display:inline-block;
    padding:0 20px 0 10px;
    width:270px;
    line-height:20px;
    font-size:12px;
    font-family:sans-serif;
    text-shadow:0 1px 0 #264400;
    font-weight:bold;
    color:#fff
} 
```

我怎样才能使图形的边缘更圆？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:45:58.147

您需要使用各种边框半径样式。这是一个生成 CSS 的好工具：

[http://border-radius.com/](http://border-radius.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:47:39.023

```
.roundcorners {
  /* older webkit */
  -webkit-border-radius: 12px; 

  /* Older firefox */
  -moz-border-radius: 12px; 

  /* General support */
  border-radius: 12px; 
} 
```

您可以在[caniuse.com上查看浏览器支持](http://caniuse.com/#feat=border-radius)

是`12px`可调的，将确定边界的半径。

[像往常一样，在MDN 文档](https://developer.mozilla.org/en-US/docs/CSS/border-radius)中有更详细的信息

# c# - 仅允许内容控件（C# webcontrols）

> ID：14467650
> 
> 赞同：6
> 
> 时间：2013-01-22T20:44:15.740
> 
> 标签：c#, asp.net, master-pages, code-behind, web-controls

所以，我不确定发生了什么。我的老板对我使用 MVC 和 Razor 不满意，所以我被迫使用这种讨厌的 webcontrol/codebehind 风格进行编码。=/

错误是：

```
Only Content controls are allowed directly in a content page that contains Content controls. 
```

这是母版页：

```
<%@ Master Language="C#"%>
<!DOCTYPE html>
<html>
<head>
    <title>Application Form</title>
</head>
 <body>
    <div id="container">
        <asp:contentplaceholder id="contentPlaceHolder" runat="server" />
    </div>
</body>
</html> 
```

这是引发错误的 Default.aspx 页面。

```
<%@ Page Language="C#" Inherits="dumb.Default" MasterPageFile="MasterPage.master" %>

<h2>Application Form</h2>
<asp:Content id="content" ContentPlaceHolderID="contentPlaceHolder" runat="server">
    <p>Please complete this application.</p>

    <form action="Default.aspx" method="post" runat="server">
            <div>
                    <span class="spaced">Name:</span><asp:TextBox id="name" runat="server" />
            </div>
    </form>
    <p>
            <asp:Label id="finalmessage" runat="server" />
    </p>
</asp:Content> 
```

还有愚蠢的 Default.aspx.cs 代码隐藏......

使用系统；使用 System.Web；使用 System.Web.UI；

```
namespace dumb
{
    public partial class Default : System.Web.UI.Page
    {
            protected void Page_Load (object sender, EventArgs e)
            {
                    if (IsPostBack) {
                            finalmessage.Text = "Submission Processed Successfully!";
                    }
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T20:50:30.370

您的所有内容（包括静态 HTML）都必须`Content`位于内容页面的标签内。你有一个`<h2>`外部：

```
<h2>Application Form</h2>
<asp:Content id="content" ContentPlaceHolderID="contentPlaceHolder" runat="server"> 
```

应该：

```
<asp:Content id="content" ContentPlaceHolderID="contentPlaceHolder" runat="server">
    <h2>Application Form</h2> 
```

# android - Android：ListView 条件滚动

> ID：14467660
> 
> 赞同：1
> 
> 时间：2013-01-22T20:44:43.370
> 
> 标签：android

我有一个 2 窗格布局。左边是一个`ListView`，右边是一些与列表链接的内容。内容是可滚动的。如果内容向前移动，我希望列表仅在该项目尚未显示时向前移动。这可以防止列表必须在每次内容更改时更新。我还希望该列表继续一整页。有没有类似的东西

```
listView.isThisElementCurrentlyShown(int nr) 
```

和

```
listView.moveAheadOnePage(int direction) 
```

?

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:12:17.250

这是一个例子`isThisElementCurrentlyShown(Element e)`：

```
 public boolean isThisElementCurrentlyShown(Element e){
                ListView lv = getListView();
                int start = lv.getFirstVisiblePosition();
                for(int i=start, j=lv.getLastVisiblePosition();i<=j;i++){
                    if(e==lv.getItemAtPosition(i)){
                        return true;
                    }
                }
                return false;
} 
```

这将告诉您该元素是否可见。

对于`moveAheadOnePage`您应该能够使用 listview 的内置函数`getFirstVisiblePosition()`并`getLastVisiblePosition()`计算该设备上可见的行数，然后将 listview 推进这么多位置。像这样的伪代码（你必须写这个）：

```
public void moveAheadOnePage(int direction){//direction: 0-up, 1-down
    int numVisibleRows = getLastVisiblePosition() - getFirstVisiblePosition();
    this.setSelected(currentSelection + numVisibleRows) // +/- depending on direction
} 
```

请注意，这些都是在滚动列表视图时进行的昂贵调用，因此您必须明智地实施~

编辑：更新的代码包括`return false`

# c# - 绘制长度超过 65536 的字符串时 GDI+ DrawString 通用异常？

> ID：14467663
> 
> 赞同：2
> 
> 时间：2013-01-22T20:44:49.443
> 
> 标签：c#, gdi+

这是一些用 linqpad 编写的 C# 代码，用于重现该问题。

```
var font = new System.Drawing.Font("Arial", 8);
using (var g = System.Drawing.Graphics.FromHwnd(IntPtr.Zero))
{
    //65536 characters is fine
    g.DrawString("a".PadLeft(65535, 'a'), font, System.Drawing.Brushes.Black, new System.Drawing.RectangleF(0, 0, 1, 1));
    //65537 characters causes an error.
    g.DrawString("a".PadLeft(65536, 'a'), font, System.Drawing.Brushes.Black, new System.Drawing.RectangleF(0, 0, 1, 1));
    //65537 characters is however fine if the width is over 600581
    g.DrawString("a".PadLeft(65536, 'a'), font, System.Drawing.Brushes.Black, new System.Drawing.RectangleF(0, 0, 600582, 1));
} 
```

有人知道字符串的长度和布局矩形的宽度之间的确切关系吗？600581 这个数字似乎很随意。虽然 65536 更有意义，因为它是 0x10000。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T06:42:58.580

> 有人知道字符串的长度和布局矩形的宽度之间的确切关系吗？600581 这个数字似乎很随意。

数字 600581 确实是任意的，在这种情况下，它反映了字体字符宽度（或字体的字形）。

举个例子`600581 / 65536`，它给出了每个字符 9.16 像素的平均字符宽度，当你包括间距时，这对于像 Arial 这样的相当平方的字体是合理的。除此之外，GDI+ 还为文本的边界框添加了填充。

如果您尝试更宽（或更窄的字体，但除非减少数字，否则您不会注意到）以及不同的字母组合，您应该会得到不同的结果。尝试使用等距字体，您应该能够非常准确地预测所需的边界（不要忘记填充）。

如果您确实需要打印长字符串，请尝试缓冲打印，但是在这些情况下，GDI+ 并不是您最好的朋友。尝试`TextRenderer`已经建议的类（一个 GDI 包装器）：http:
[//msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.textrenderer.aspx)

# java - Java Keylisteners 和 Key Bindings 速度比较

> ID：14467664
> 
> 赞同：0
> 
> 时间：2013-01-22T20:44:53.687
> 
> 标签：java, performance, comparison, key, keylistener

我目前正在开发一个简单的软件合成器，它使用用户的键盘来控制音高，就像“钢琴”一样。问题是，我正在为每个键代码使用一个键监听器和一个庞大的 switch 语句来获取频率。这是相当过分的。按下特定键时会触发键绑定，这似乎应该比搜索大量代码更快，但它在引擎盖下的工作方式有什么不同吗？效率是必不可少的，因为我想在 pi 上运行它。

# ios - 在 iOS 中同时切换控制器和视图

> ID：14467665
> 
> 赞同：0
> 
> 时间：2013-01-22T20:44:56.573
> 
> 标签：ios, xcode, cocoa

我的项目中有以下控制器和视图：

```
PortraitController.m
PortraitView.xib
LandscapeController.m
LandscapeView.xib 
```

纵向控制器用作纵向视图的控制器，横向控制器用作横向视图的控制器。

**当设备方向发生变化时，我需要切换两个控制器并查看。** Apple 建议采用这种方法，但他们没有提供可用的通用示例！

我找到了各种示例，但它们并不是我所需要的 - 一个控制器 + 同一个 xib 中的两个视图，从导航控制器推送 + 弹出，将第二个视图放在前一个视图上，......它们都不是我需要的。

当设备方向发生变化时，在这两个 Controller+View 组合之间切换（使用动画）的最简单方法是什么？

是否有适用于 iOS 5 和 iOS 6 的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:00:10.567

Apple 提供的示例使用 Storyboard 的 segue 机制从一个视图转到另一个视图，如果您使用的是 NIB 文件，则需要使用 UINavigationViewController 方法，您甚至可以设置要从一个 UIControllerView 转到另一个的转换

例如，此代码将通过翻页动画从一个 UIViewController 切换到另一个

```
[UIView  beginAnimations:nil context:NULL];
[UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
[UIView setAnimationDuration:0.75];
[self.navigationController pushViewController:yourViewController animated:NO];
[UIView setAnimationTransition:UIViewAnimationTransitionCurlDown forView:navController.view cache:NO];
[UIView commitAnimations]; 
```

为了实现知道何时推送一个视图或另一个视图的事实（或者如果切换到故事板，则使用 segue），您可以注册以从导航控制器或当前视图监听 UIDeviceOrientationDidChangeNotification 事件，以注册某种方法来处理屏幕例如旋转

```
-(void)viewWillAppear:(BOOL)animated {
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(methodToChangeViewController) name:UIDeviceOrientationDidChangeNotification object:nil];

}

-(void)viewWillDisappear:(BOOL)animated {
    [[NSNotificationCenter defaultCenter] removeObserver:self name:UIDeviceOrientationDidChangeNotification object:nil];
} 
```

取消注册活动非常重要

希望这可以让您对如何实现您的目标有所了解

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T23:16:33.733

这是解决您问题的好方法： [Rotating to Show different iOS Views](http://vastdevblog.vast.com/blog/2012/02/12/rotating-to-show-different-ios-views/)。使用 NSNotificationCenter，您可以管理旋转事件并推送/弹出控制器，或更改您想要的任何视图。希望这可以帮到你。

# c# - MVVM 数据绑定

> ID：14467666
> 
> 赞同：0
> 
> 时间：2013-01-22T20:44:56.270
> 
> 标签：c#, data-binding, mvvm

我已经开始了一个 MVVM 项目，现在我坚持使用正确的 DataBinding。我的项目有：

带有 ViewModel 作为 DataContext 的 UserControl，例如：

```
public partial class TestUserControl: UserControl
{
   public TestUserControl()
   {
       this.DataContext = new TestUserControlViewModel();
   }
} 
```

ViewModel 代码为（BaseViewModel 类包含 PropertyChangedEventHandler）：

```
public class TestUserControlViewModel : BaseViewModel
{
   public KrankenkasseControlViewModel()
   {}

   public IEnumerable<DataItem> GetAllData
   {
      get
      {
          IGetTheData src= new DataRepository();
          return src.GetData();
      }
   }
} 
```

IGetTheData 是 DataContext 的接口：

```
public interface IGetTheData
{
   IEnumerable<DataItem> GetData();
} 
```

}

最后是 DataRepository 代码：

```
public class DataRepository : IGetTheData
{
   private TestProjectDataContext dax = new TestProjectDataContext();

   public IEnumerable<DataItem> GetData()
   {
       return (from d in this.dax.TestData
               select new DataItem
               {
                  ID = d.ID,
                  SomeOtherData = d.SomeOtherData
               });
   }
} 
```

我的 UserControl 有几个文本框，但正确绑定的最佳方法是什么？

谢谢你的帮助，问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:05:40.133

**编辑：将数据绑定到多个文本框**

阅读您的评论后，我将详细说明我的文本框示例。

第一个重要的事情是 ViewModel 将对 View 中的事物进行建模，以便 View 在它需要*的结构中*获得它需要的所有信息。这意味着，如果视图中有多个文本框，则视图模型中需要多个字符串属性，每个文本框一个。

在你的 XAML 中，你可以有类似的东西

```
<TextBox Text="{Binding ID, Mode=TwoWay}" />
<TextBox Text="{Binding SomeOtherData, Mode=TwoWay}" /> 
```

在你的 ViewModel

```
public class TestUserControlViewModel : BaseViewModel {
    private string id;
    private string someOtherData;

    public TestUserControlViewModel() {
        DataItem firstItem = new DataRepository().GetData().First();
        this.ID = firstItem.ID;
        this.SomeOtherData = firstItem.SomeOtherData;
    }

    public string ID {
        get {
            return this.id;
        }
        set {
            if (this.id == value) return;
            this.id = value;
            this.OnPropertyChangedEvent("ID");
        }
    }

    public string SomeOtherData {
        get {
            return this.someOtherData;
        }
        set {
            if (this.someOtherData == value) return;
            this.someOtherData = value;
            this.OnPropertyChangedEvent("SomeOtherData");
        }
    }
} 
```

在这里，我假设您`BaseViewModel`有一种`OnPropertyChangedEvent`方法可以触发相应的事件。这告诉视图该属性已更改，它必须自行更新。

请注意`Mode=TwoWay`XAML 中的 。这意味着，无论值在哪一侧发生变化，另一侧都会立即反映变化。所以如果用户在一个`TwoWay`bound中改变了一个值`TextBox`，那么对应的 ViewModel 属性就会自动改变！反之亦然：如果您以编程方式更改 ViewModel 属性，则 View 将刷新。

如果要为多个数据项显示多个文本框，则必须在 ViewModel 中引入更多属性并相应地绑定它们。也许 a里面`ListBox`有灵活数量的`TextBox`es 是一个解决方案，就像@Haspemulator 已经回答一样。

**将数据绑定到集合控件**

在`TestUserControl`我猜你有一个控件（比如 a `ListView`）来显示加载的东西的列表。因此，将该控件与 ViewModel 中的列表绑定

```
<ListView ... ItemsSource="{Binding GetAllData}" ... /> 
```

首先你必须明白*Binding*的意思不是“读取数据然后忘记 ViewModel”。相反，只要 View 存在，您就可以将 View 绑定到 ViewModel（及其属性）。从这个角度来看，这`AllData`是一个比`GetAllData`（感谢@Malcolm O'Hare）更好的名字。

现在在您的代码中，每次视图读取`AllData`属性时，`DataRepository`都会创建一个新属性。由于 Binding，这不是您想要的，而是您希望`DataRepository`在 View 的整个生命周期内拥有一个实例，用于读取初始数据，以后可以用于更新 View，如果底层数据库变化（可能有事件）。

要启用这样的行为，您应该将`AllData`属性的类型更改为`ObservableCollection`，以便在发生更改时 View 可以自动更新列表。

```
public class TestUserControlViewModel : BaseViewModel
    private ObservableCollection<DataItem> allData;

    public TestUserControlViewModel() {
         IGetTheData src = new DataRepository();
         this.allData = new ObservableCollection<DataItem>(src.GetData());
    }

    public ObservableCollection<DataItem> AllData {
        get {
            return this.allData;
        }
    }

    public void AddDataItem(DataItem item) {
        this.allData.Add(item);
    }
} 
```

现在，如果您`AddDataItem`稍后调用，ListView 将自动更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:05:11.090

您的物业名称不好。您应该将其称为 AllData，而不是 GetAllData。

由于您要返回一个集合，因此您可能应该使用某种列表控件（ListBox、ListView）。

在那种情况下，你会做

```
<ListBox ItemsSource="{Binding GetAllData}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:13:37.917

古腾阿本德。:) 正如已经提到的，由于您要返回集合，因此最好使用 ListBox。关于将 ObservableCollection 作为缓存的评论也是绝对有效的。我要补充一点，如果您需要让您的数据可编辑，您应该在 ItemTemplate 中使用 TextBox：

```
<ListBox.ItemTemplate>
    <DataTemplate>
        <TextBox Text={Binding SomeOtherData,Mode=TwoWay} />
    </DataTemplate>
</ListBox.ItemTemplate> 
```

在这种情况下，如果用户编辑框中的文本，数据将在您的数据对象中更新，以便以后可以将其保存在数据库中。

# vb.net - vb .net CDATA 用于存储 SQL 多行字符串，与 VB 变量混合

> ID：14467667
> 
> 赞同：2
> 
> 时间：2013-01-22T20:44:59.940
> 
> 标签：vb.net, xml-literals

我正在使用 CDATA 来“按原样”存储所有多行 SQL 字符串（感谢一些 stackoverflow 旧答案），如下所示：

```
Dim cmd As String = <![CDATA[
INSERT INTO devices
VALUES (
    NULL , 
    'ONE', 
    'TWO', 
    (
        SELECT manufacturer_id FROM manufacturers WHERE manufacturer_name = "Bloom"
    )
)
]]>.Value() 
```

问题是我需要使用 VB 变量来阻止它。还有另一种方法而不是多个 CDATA 吗？

```
<![CDATA[ ...... ]]>.Value() + myVBvar +  <![CDATA[ ...... ]]>.Value() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T21:22:14.233

尝试使用 SqlParameters

```
Dim commandString As String = <![CDATA[
  INSERT INTO blah VALUES (@One, @Two, @Three, @n)
 ]]>,Value()

Using command As SqlCommand = new SqlCommand(commandString, connection)
  command.Parameters.AddWithValue("@One", valueOne)
  command.Parameters.AddWithValue("@Two", valueTwo) '  etc...

  '  command.execute
End Using 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-06T17:40:55.673

[我正在从“ VB.NET 中的多行字符串](https://stackoverflow.com/questions/706382/multiline-strings-in-vb-net)”重新发布我的答案的变体，因为它是相关的。

您基本上必须在 VB 变量之前终止 CDATA 标记，然后在之后重新添加它，这样 CDATA 就不会捕获 VB 代码。您需要将整个代码块包装在标签中，因为您将拥有多个 CDATA 块。

```
Dim cmd As String = <sql><![CDATA[
INSERT INTO devices
VALUES (
  NULL , 
  ']]><%= varOne %><![CDATA[', 
  ']]><%= varTwo %><![CDATA[', 
  (
    SELECT manufacturer_id
    FROM manufacturers
    WHERE manufacturer_name = "]]><%= manufacturerName %><![CDATA["
  )
)
]]></sql>.value 
```

# php - 在 .htaccess 中启用 cors

> ID：14467673
> 
> 赞同：87
> 
> 时间：2013-01-22T20:45:28.973
> 
> 标签：php, apache, .htaccess, cors, slim

我已经使用 SLIM PHP 框架创建了一个基本的 RESTful 服务，现在我正在尝试将它连接起来，以便我可以从 Angular.js 项目访问该服务。我已经读到 Angular 支持开箱即用的 CORS，我需要做的就是将这一行添加`Header set Access-Control-Allow-Origin "*"`到我的 .htaccess 文件中。

我已经这样做了，我的 REST 应用程序仍在工作（没有来自错误的 .htaccess 的 500 内部服务器错误），但是当我尝试从[test-cors.org](http://test-cors.org)对其进行测试时，它抛出了一个错误。

```
Fired XHR event: loadstart
Fired XHR event: readystatechange
Fired XHR event: error

XHR status: 0
XHR status text: 
Fired XHR event: loadend 
```

我的 .htaccess 文件看起来像这样

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ /index.php [QSA,L]
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods: "GET,POST,OPTIONS,DELETE,PUT" 
```

我还需要在我的 .htaccess 中添加其他内容以使其正常工作，还是有其他方法可以在我的服务器上启用 CORS？

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2013-01-22T22:44:07.033

因为无论如何我都将所有内容转发到 index.php，所以我想我会尝试在 PHP 中设置标头而不是 .htaccess 文件，它确实有效！耶！这是我为遇到此问题的其他人添加到 index.php 的内容。

```
// Allow from any origin
if (isset($_SERVER['HTTP_ORIGIN'])) {
    // should do a check here to match $_SERVER['HTTP_ORIGIN'] to a
    // whitelist of safe domains
    header("Access-Control-Allow-Origin: {$_SERVER['HTTP_ORIGIN']}");
    header('Access-Control-Allow-Credentials: true');
    header('Access-Control-Max-Age: 86400');    // cache for 1 day
}
// Access-Control headers are received during OPTIONS requests
if ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') {

    if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD']))
        header("Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS");         

    if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']))
        header("Access-Control-Allow-Headers: {$_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']}");

} 
```

归功于 slashingweapon 对[这个问题的回答](https://stackoverflow.com/questions/8719276/cors-with-php-headers)

因为我使用的是 Slim，所以我添加了这条路由，以便 OPTIONS 请求获得 HTTP 200 响应

```
// return HTTP 200 for HTTP OPTIONS requests
$app->map('/:x+', function($x) {
    http_response_code(200);
})->via('OPTIONS'); 
```

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2013-12-30T11:20:41.263

不应该`.htaccess`使用`add`代替`set`吗？

```
Header add Access-Control-Allow-Origin "*"
Header add Access-Control-Allow-Methods: "GET,POST,OPTIONS,DELETE,PUT" 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2016-02-06T05:43:06.943

这对我有用：

```
Header add Access-Control-Allow-Origin "*"
Header add Access-Control-Allow-Headers "origin, x-requested-with, content-type"
Header add Access-Control-Allow-Methods "PUT, GET, POST, DELETE, OPTIONS" 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-03-18T11:32:45.340

如在this answer [Custom HTTP Header for a specific file](https://stackoverflow.com/questions/42316222/custom-http-header-for-a-specific-file)中，您可以使用`<File>`以下代码为单个文件启用CORS：

```
<Files "index.php">
  Header set Access-Control-Allow-Origin "*"
  Header set Access-Control-Allow-Methods: "GET,POST,OPTIONS,DELETE,PUT"
</Files> 
```

而不是`"*"`您可以放置​​特定的来源（协议+域+可选端口）。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-11-27T01:16:35.913

> 将 100% 工作，在 .htaccess 中应用：

```
# Enable cross domain access control
SetEnvIf Origin "^http(s)?://(.+\.)?(1xyz\.com|2xyz\.com)$" REQUEST_ORIGIN=$0
Header always set Access-Control-Allow-Origin %{REQUEST_ORIGIN}e env=REQUEST_ORIGIN
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
Header always set Access-Control-Allow-Headers "x-test-header, Origin, X-Requested-With, Content-Type, Accept"

# Force to request 200 for options
RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule .* / [R=200,L] 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-02-29T18:35:10.103

看起来您正在使用旧版本的 slim(2.x)。您只需将以下行添加到 .htaccess 中，而无需在 PHP 脚本中执行任何操作。

```
# Enable cross domain access control
SetEnvIf Origin "^http(s)?://(.+\.)?(domain_one\.com|domain_two\.net)$" REQUEST_ORIGIN=$0
Header always set Access-Control-Allow-Origin %{REQUEST_ORIGIN}e env=REQUEST_ORIGIN
Header always set Access-Control-Allow-Methods "GET, POST, PUT, DELETE"
Header always set Access-Control-Allow-Headers: Authorization

# Force to request 200 for options
RewriteEngine On
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule .* / [R=200,L] 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-10-27T14:26:36.143

感谢 Devin，我为我的 SLIM 应用程序找到了多域访问的解决方案。

在 htaccess 中：

```
SetEnvIf Origin "http(s)?://(www\.)?(allowed.domain.one|allowed.domain.two)$" AccessControlAllowOrigin=$0$1
Header set Access-Control-Allow-Origin %{AccessControlAllowOrigin}e env=AccessControlAllowOrigin
Header set Access-Control-Allow-Credentials true 
```

在 index.php 中

```
// Access-Control headers are received during OPTIONS requests
if ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') {

    if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD']))
        header("Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS");         

    if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']))
        header("Access-Control-Allow-Headers: {$_SERVER['HTTP_ACCESS_CONTROL_REQUEST_HEADERS']}");
}
// instead of mapping:
$app->options('/(:x+)', function() use ($app) {
    //...return correct headers...
    $app->response->setStatus(200);
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-01-12T20:42:03.237

我尝试了@abimelex 解决方案，但在 Slim 3.0 中，映射 OPTIONS 请求如下：

```
$app = new \Slim\App();
$app->options('/books/{id}', function ($request, $response, $args) {
    // Return response headers
}); 
```

[https://www.slimframework.com/docs/objects/router.html#options-route](https://www.slimframework.com/docs/objects/router.html#options-route)

# c# - C# lambda 表达式，子子查询

> ID：14467674
> 
> 赞同：-2
> 
> 时间：2013-01-22T20:45:30.293
> 
> 标签：c#, linq, lambda

我正在尝试查询如下对象层次结构：

客户 -->`IList`订单和订单 -->`IList`产品

我的`Customer`对象有一个订单集合，我的`Order`对象有一个产品集合。

我想做的是让订购特定产品的客户。我会查询这个`product id`。在查询结束时，我想获得一个`Customer list`.

我试过这个，但它没有用。

```
public ICollection<Customer> GetByParticularProduct(int productId)
{

    return allCustomers
    .Where(customer => customer.Orders
.Any(order => order.Products
.Any(prod => prod.Id == productId)))
    .ToList();
} 
```

我怎样才能度过这个难关？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:40:20.090

如果您的收藏可能包含`null`'s，您可以试试这个

```
public ICollection<Customer> GetByParticularProduct(int productId)
{
    return (from cust in allCustomers.Where(x => x != null)
            let orders = cust.Orders.Where(x => x != null)
            let prods = orders.SelectMany(x => x.Products).Where(x => x != null)
            where prods.Any(x => x.Id == productId)
            select cust)
           .ToList();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-22T20:50:14.520

```
return allCustomers
    .Where(customer => customer.Orders
        .Any(order => order.Products
            .Any(prod => prod.Id == productId))).ToList(); 
```

或者

```
return allCustomers
    .Where(customer => customer.Orders
        .Any(order => order.ProductId == productId))).ToList(); 
```

# asp.net - 在 ASP.Net 中单击按钮时加载融合图表

> ID：14467675
> 
> 赞同：0
> 
> 时间：2013-01-22T20:45:31.347
> 
> 标签：asp.net, fusioncharts

我试图在特定区域显示我的融合图表，特别是在单击按钮时我在我的 aspx 文件中调用 CreateChart 函数的地方。我现在拥有的方式是图表在页面加载后立即加载，但我想看到的是图表仅在单击按钮时加载。我尝试了不同的方法，但由于我对融合图表不太熟悉，因此无法做到正确。谢谢 这是我的 ASPX 文件：

```
<table class="style1">

<td class="style8">
                <asp:Button ID="btnClick" runat="server" Height="29px" Text="Button" 
                    Width="158px" onclick="btnClick_Click" />
            </td>

 <td class="style4" colspan="2">
               <% =CreateChart() %> </td>
        </tr>
    </table> 
```

这是我的代码：

```
public string CreateChart()
    {
        SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString);
        string sqlStatement = "select   Status1, Count(Status1) as TotalCount from  MyTable where Closing_Date =  '" + txtStartClosingDate.Text + "' and Closing_Date <= '" + txtEndClosingDate.Text + "' and Status1 is not null group by  Status1";
        SqlCommand cmd = new SqlCommand(sqlStatement, con);
        con.Open();
        SqlDataReader reader = cmd.ExecuteReader();
        string strXML;
        strXML = "<graph labelDisplay='auto' useEllipsesWhenOverflow='1' decimals='2' decimalPrecision='0' showValues='1' enablesmartlabels='0' showlabels='0'  legendAllowDrag='1' numberSuffix=' Days' showLegend='1' pieSliceDepth='45' formatNumberScale='0'>";
        while (reader.Read())
        {
            strXML += "<set name='" + reader["Category"].ToString() + "' value='" + reader["AvgNumbers"].ToString() + "' />";
        }
        strXML += "</graph>";
        return FusionCharts.RenderChart("../FusionCharts/Pie2D.swf", "ChartID", strXML, "FactorySum", "450", "450", false, false);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:07:22.557

试试这个

代替

```
<td class="style4" colspan="2">
           <% =CreateChart() %> </td> 
```

采用

```
<td class="style4" colspan="2">
           <asp:Literal mode="PassThrough" runat="server" ID="literalPlaceHolder"/> </td> 
```

并在按钮的事件处理程序中

```
public void btnClick_Click(...)
{
       literalPlaceHolder.Text = CreateChart();
} 
```

# c++ - 递归函数中通过引用传递的数组 - 最后一列重新初始化

> ID：14467678
> 
> 赞同：2
> 
> 时间：2013-01-22T20:45:43.607
> 
> 标签：c++, c

我的一个功能有一个相当出乎意料的问题。让我解释。我正在编写一个校准算法，因为我想做一些网格搜索（非连续优化），我正在创建自己的网格 - 不同的概率组合。网格的大小和网格本身是**递归**计算的（我知道......）。所以按顺序：

1.  获取变量
2.  递归计算对应大小
3.  为网格分配内存
4.  通过引用传递空网格并递归填充

一旦我尝试检索此网格，我遇到的问题是在第 4 步之后。在第 4 步中，我在控制台上“打印”结果以检查它们，**一切**都很好。我计算了几个带有几个变量的网格，它们都与我期望的结果相匹配。然而，一旦网格**从递归**函数中取出，**最后一个**列用 0 填充（之前的所有值仅在此列中替换）。我尝试在步骤 3 中为网格分配一列额外的列，但这只会使问题变得更糟（-3e303 等值）。此外，无论我计算它的大小（非常小到非常大），我都会遇到错误，所以我认为这不是内存错误（或至少是“内存不足”错误）。最后，下面列出了使用的两个函数及其调用，这已经被快速编程，所以一些变量可能看起来有点无用 - 我知道。但是，我总是对您的评论持开放态度（而且我不是 C++ 专家——因此这个线程）。

```
void size_Grid_Computation(int nVars, int endPoint, int consideredVariable, int * indexes, int &sum, int nChoices)
{
/** Remember to initialize r at 1 !! - we exclude var_0 and var_(m-1) (first and last variables) in this algorithm **/
 int endPoint2 = 0;

 if (consideredVariable < nVars - 2)
 {
    for (indexes[consideredVariable] = 0; indexes[consideredVariable] < endPoint; indexes[consideredVariable] ++)
    {
        endPoint2 = endPoint - indexes[consideredVariable];
        size_Grid_Computation(nVars, endPoint2, consideredVariable + 1, indexes, sum, nChoices);
    }

 }
 else
 {
    for (int i = 0; i < nVars - 2; i++)
    {
        sum -= indexes[i];
    }
    sum += nChoices;
    return;

 }
} 
```

上面的函数是针对网格大小的。下面是网格本身 -

```
void grid_Creation(double* choicesVector, double** varVector, int consideredVariable, int * indexes, int endPoint, int nVars, int &r)
{
 if (consideredVariable > nVars-1)
    return;
 for (indexes[consideredVariable] = 0; indexes[consideredVariable] < endPoint; indexes[consideredVariable]++)
 {

    if (consideredVariable == nVars - 1)
    {   
        double sum = 0.0;
        for (int j = 0; j <= consideredVariable; j++)
        {
            varVector[r][j] = choicesVector[indexes[j]];
            sum += varVector[r][j];
            printf("%lf\t", varVector[r][j]);
        }
        varVector[r][nVars - 1] = 1 - sum;
        printf("%lf row %d\n", varVector[r][nVars - 1],r+1);
        r += 1;

    }
    grid_Creation(choicesVector, varVector, consideredVariable + 1, indexes, endPoint - indexes[consideredVariable], nVars, r);
 }

} 
```

终于打电话了

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
 int nVars = 5;
 int gridPrecision = 3;

int sum1 = 0;
int r = 0;

int size = 0;
int * index, * indexes;

index = (int *) calloc(nVars - 1, sizeof(int));
indexes = (int *) calloc(nVars, sizeof(int));

for (index[0] = 0; index[0] < gridPrecision + 1; index[0] ++)
{
    size_Grid_Computation(nVars, gridPrecision + 1 - index[0], 1, index, size, gridPrecision + 1);
}

double * Y;

Y = (double *) calloc(gridPrecision + 1, sizeof(double));

for (int i = 0; i <= gridPrecision; i++)
{
    Y[i] = (double) i/ (double) gridPrecision;
}

double ** varVector;

varVector = (double **) calloc(size, sizeof(double *));

for (int i = 0; i < size; i++)
{
    varVector[i] = (double *) calloc(nVars, sizeof(double *));
}

grid_Creation(Y, varVector, 0, indexes, gridPrecision + 1, nVars - 1, r);
for (int i = 0; i < size; i++)
{
    printf("%lf\n", varVector[i][nVars - 1]);
}
} 
```

我离开了我的野蛮人'printf'，他们帮助缩小了问题范围。很可能，我忘记或破坏了一个内存分配。但我看不出是哪一个。无论如何，感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:44:47.073

在我看来，你有一个主要的错误设计，即你的二维数组。你在这里编程的*不是*二维数组，而是它的仿真。仅当您想要一种稀疏数据结构时才有意义，您可能会遗漏部分。在您的情况下，它看起来好像只是您需要的普通旧矩阵。

如今，在 C 和 C++ 中这样编程都不合适。

在 C 中，因为这似乎是您所追求的，所以在函数内部您声明矩阵，即使具有动态边界为

```
double A[n][m]; 
```

如果您担心这会破坏您的“堆栈”，您可以动态分配它

```
double (*B)[m] = malloc(sizeof(double[n][m])); 
```

您可以通过将边界放在参数列表中的第一个来将这些野兽传递给函数

```
void toto(size_t n, size_t m, double X[n][m]) {
 ...
} 
```

一旦你有干净和可读的代码，你会发现你的错误更容易。

# python - 制作一个输出不是线性的控制台应用程序

> ID：14467681
> 
> 赞同：1
> 
> 时间：2013-01-22T19:32:12.617
> 
> 标签：python, command-line

当我之前制作任何类型的基于命令行的应用程序时，我用来显示输出的唯一方法是类似`print(stuff);`or `System.Console.print(moreStuff);`。

但是，我已经看到并使用`nano`了控制整个控制台窗口的控制台应用程序（是一个示例）。

我正在编写一个我认为可能适合这种方法的控制台应用程序（在 python 中）。

那么，我怎样才能实现这一点（在 python 中）（最好让它在 Windows 和 Linux 上工作）？

该技术有名称吗？

线性我的意思是这样的：

```
->Searching for files...
->10 files found...
->Analyzing files... 
```

当我想要更多类似的东西时：

```
->Searching files in directory [current_dir_goes_here]
->10 files found
->Analyzing [filename.txt] 
```

# math - 创建一个密钥以从中生成随机值

> ID：14467686
> 
> 赞同：0
> 
> 时间：2013-01-22T20:46:01.773
> 
> 标签：math, random

有可能以某种方式创建一个密钥或种子，您可以使用它来初始化随机数生成器，从而确保使用此密钥的所有随机数都是相同的。

或者我可以使用另一种技术来获得类似的结果吗？

我喜欢做的是创建一个随机种子。然后使用这个种子来初始化一个随机数生成器，使用这个随机数生成器来构建一个瓷砖地图或其他需要大量随机数的东西。

然后将相同的种子发送到另一个能够生成完全相同的地图的客户端，因为随机数是相同的？

我只是好奇这样的事情是否可能，并不真正关心平台等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T20:51:45.823

只要您使用的随机数生成器不执行*您*不告诉它的任何操作，这将起作用。例如，如果您使用种子“4”为 c 的 RNG 播种，然后打印 10 个随机数 100 次，那么相同的 10 个数字将被打印 100 次。这是因为 RNG 仅基于种子工作，并对种子进行一些算法转换以产生一组值。如果每次都给它相同的种子，那么每次都会重复相同的算法过程，从而导致相同的结果。

我没有强调*任何内容*，因为现代 RNG 可能会在生成过程中自动使用时间或某些随机系统规格，而您却不知道，这样对于那些*不*想要您想要的效果的人来说，就不会得到它。

# json - Play Framework 2.1 中的 Scala 到 JSON

> ID：14467689
> 
> 赞同：21
> 
> 时间：2013-01-22T20:46:03.900
> 
> 标签：json, scala, playframework-2.1

我正在尝试在 2.1RC Play Framework 中将 Scala 转换为 JSON。

我可以执行以下操作并获取 JSON：

```
import play.api.libs.json._

val a1=Map("val1"->"a", "val2"->"b")
Json.toJSon(a1) 
```

因为 a1 只是 Map[String,String] 可以正常工作。

但是如果我有一些更复杂的东西，比如我有 Map[String,Object]，那是行不通的：

```
val a = Map("val1" -> "xxx", "val2"-> List("a", "b", "c"))
Json.toJSon(a1)
>>> error: No Json deserializer found for type scala.collection.immutable.Map[String,Object] 
```

我发现我可以执行以下操作：

```
val a2 = Map("val1" -> Json.toJson("a"), "val2" -> Json.toJson(List("a", "b", "c")))
Json.toJson(a2) 
```

那行得通。

但是我怎么能以一般的方式做到这一点？我认为我可以执行以下操作：

```
a.map{ case(k,v)=> (k, Json.toJson(v) )}
>>> error: No Json deserializer found for type Object 
```

但我仍然收到无法反序列化的错误

* * *

**附加信息：**

Json.toJson 可以将 Map[String, String] 转换为 JsValue：

```
scala> val b = Map( "1" -> "A", "2" -> "B", "3" -> "C", "4" -> "D" )
b: scala.collection.immutable.Map[String,String] = Map(1 -> A, 2 -> B, 3 -> C, 4 -> D)

scala> Json.toJson(b)
res31: play.api.libs.json.JsValue = {"1":"A","2":"B","3":"C","4":"D"} 
```

但是，它无法尝试转换 Map[String, Object]：

```
scala> a
res34: scala.collection.immutable.Map[String,Object] = Map(val1 -> xxx, val2 -> List(a, b, c))

scala> Json.toJson(a)
<console>:12: error: No Json deserializer found for type scala.collection.immutable.Map[String,Object]. Try to implement an implicit Writes or Format for this type.
          Json.toJson(a) 
```

使用此 Play Framework 页面中关于将 Scala 转换为 Json 的“提示”，我发现以下内容（[http://www.playframework.org/documentation/2.0.1/ScalaJson](http://www.playframework.org/documentation/2.0.1/ScalaJson)）：

如果不是 Map[String, Object]，而是 Map[String, JsValue]，那么 Json.toJson() 将起作用：

```
scala> val c = Map("aa" -> Json.toJson("xxxx"), "bb" -> Json.toJson( List("11", "22", "33") ) )
c: scala.collection.immutable.Map[String,play.api.libs.json.JsValue] = Map(aa -> "xxxx", bb -> ["11","22","33"])

scala> Json.toJson(c)
res36: play.api.libs.json.JsValue = {"aa":"xxxx","bb":["11","22","33"]} 
```

所以，我想要的是，给定一个 Map[String, Object]，我知道 Object 值最初都是 String 或 List[String] 类型，如何将函数 Json.toJson() 应用于所有映射中的值并获取 Map[String, JsValue]。

我还发现我可以过滤掉那些纯粹是字符串的值和那些（曾经）是 List[String] 类型的值：

```
scala> val a1 = a.filter({case(k,v) => v.isInstanceOf[String]})
a1: scala.collection.immutable.Map[String,Object] = Map(val1 -> xxx)

scala> val a2 = a.filter({case(k,v) => v.isInstanceOf[List[String]]})
<console>:11: warning: non-variable type argument String in type List[String] is unchecked since it is eliminated by erasure
   val a2 = a.filter({case(k,v) => v.isInstanceOf[List[String]]})
                                                 ^
a2: scala.collection.immutable.Map[String,Object] = Map(val2 -> List(a, b, c)) 
```

List[String] 过滤会给出警告，但似乎给出了我想要的答案。如果可以应用这两个过滤器，然后将 Json.toJson() 用于结果的值，并将结果组合起来，也许这会起作用？

但是过滤后的结果仍然是 Map[String, Object] 类型，这会导致问题：

```
scala> Json.toJson(a1)
<console>:13: error: No Json deserializer found for type scala.collection.immutable.Map[String,Object]. Try to implement an implicit Writes or Format for this type.
          Json.toJson(a1) 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-23T02:12:14.680

Play 2.1 JSON API 不为 Type 提供序列化程序`Map[String, Ojbect]`。

为特定类型定义`case class`and`Format`而不是`Map[String, Object]`：

```
// { "val1" : "xxx", "val2" : ["a", "b", "c"] }
case class Hoge(val1: String, val2: List[String])

implicit val hogeFormat = Json.format[Hoge] 
```

如果您不想创建案例类。以下代码为 Map[String, Object] 提供 JSON 序列化器/反序列化器：

```
implicit val objectMapFormat = new Format[Map[String, Object]] {

  def writes(map: Map[String, Object]): JsValue =
    Json.obj(
      "val1" -> map("val1").asInstanceOf[String],
      "val2" -> map("val2").asInstanceOf[List[String]]
    )

  def reads(jv: JsValue): JsResult[Map[String, Object]] =
    JsSuccess(Map("val1" -> (jv \ "val1").as[String], "val2" -> (jv \ "val2").as[List[String]]))
} 
```

* * *

## 更动态

```
import play.api.libs.json._
import play.api.libs.json.Reads._
import play.api.libs.json.Json.JsValueWrapper

implicit val objectMapFormat = new Format[Map[String, Object]] {

  def writes(map: Map[String, Object]): JsValue = 
    Json.obj(map.map{case (s, o) =>
      val ret:(String, JsValueWrapper) = o match {
        case _:String => s -> JsString(o.asInstanceOf[String])
        case _ => s -> JsArray(o.asInstanceOf[List[String]].map(JsString(_)))
      }
      ret
    }.toSeq:_*)

  def reads(jv: JsValue): JsResult[Map[String, Object]] =
    JsSuccess(jv.as[Map[String, JsValue]].map{case (k, v) =>
      k -> (v match {
        case s:JsString => s.as[String]
        case l => l.as[List[String]]
      })
    })
} 
```

示例代码：

```
 val jv = Json.toJson(Map("val1" -> "xxx", "val2" -> List("a", "b", "c"), "val3" -> "sss", "val4" -> List("d", "e", "f")))
  println(jv)
  val jr = Json.fromJson[Map[String, Object]](jv)
  println(jr.get) 
```

输出：

```
> {"val1":"xxx","val2":["a","b","c"],"val3":"sss","val4":["d","e","f"]}
> Map(val1 -> xxx, val2 -> List(a, b, c), val3 -> sss, val4 -> List(d, e, f)) 
```

# php - 运行 git post-commit 钩子

> ID：14467691
> 
> 赞同：0
> 
> 时间：2013-01-22T20:46:06.243
> 
> 标签：php, git, githooks, post-commit, post-commit-hook

我在本地运行 MAMP。我有一个 php 脚本，用于构建网站、生成静态 HTML 文件，然后将其推送到 Web 服务器。

这个过程很像 github 页面上的 Jekyll。

现在，我只需更改 Markdown 文件（我的内容），然后点击本地 url，localhost/mysite/build，生成 html 文件。简单的。

我确实在本地安装了 git 来对 PHP 脚本本身以及 markdown 文件进行版本控制。

理想情况下，我想创建一个提交后挂钩，它将简单地“ping”构建 URL 以允许它运行。

几件事。我一直在尝试，但提交后没有运行 URL。我想在 post-commit 文件中使用 PHP，可以吗？我不需要任何验证或任何东西，只是想在我提交时调用 URL 以运行该过程。

我已经完成了 chmod 以确保脚本是可执行的。

提交后文件名为“提交后”，没有扩展名。

我想我可以只添加一个简单的行，比如 file_get_contents(myurl)，或者类似的东西。

我已经在谷歌上搜索了几个小时，发现了一些接近但不完全正确的东西。它真的很简单，只是一个带有 git 钩子的菜鸟。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:06:42.087

提交挂钩是 shell 脚本，因此绝对可以运行 php 脚本（就像您从 cmd 行执行的操作一样）或使用 curl: 向您的 URL 发出请求`curl --request GET --url http://stackoverflow.com -v`以触发构建。根据构建时间，您可能希望在后台运行 curl。

首先，尝试准备一个运行构建的 shell 脚本。然后设置钩子本身。请参阅[Simple git post-commit hook 以将提交的文件复制到某个文件夹](https://stackoverflow.com/questions/7633299/simple-git-post-commit-hook-to-copy-committed-files-to-a-certain-folder)作为示例 hook。

# java - 如何显示插入到主面板内的子面板中的 jbutton？

> ID：14467692
> 
> 赞同：0
> 
> 时间：2013-01-22T20:46:08.037
> 
> 标签：java, swing, jbutton

我似乎无法正确处理。该代码没有任何语法错误，但没有显示我想要显示的内容。这是我写的代码。预先感谢您的帮助。我想在游戏面板（子面板）中显示图像 jbuttons.. 那里应该有 9 个 jbuttons 但它没有显示。框架只是灰色的。我不知道如何让子面板显示。

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class midterm extends JFrame
{
    JPanel mainpanel;
    JButton image1=new JButton();
    JButton image2=new JButton();
    JButton image3=new JButton();
    JButton image4=new JButton();
    JButton image5=new JButton();
    JButton image6=new JButton();
    JButton image7=new JButton();
    JButton image8=new JButton();
    JButton image9=new JButton();   

    JLabel text=new JLabel("Please select a photo above.");

    public midterm()
    {
        super("Girls' Generation - I GOT A BOY 4th Korean Album");
        setSize(700,700);
        setLocation(200,30);
        setDefaultCloseOperation(EXIT_ON_CLOSE);
        setVisible(true);
        setResizable(false);

        panel();
    }

    public static void main(String[] args)
    {
        midterm frame=new midterm();
    }

    void panel()
    {
        mainpanel=new JPanel();
        mainpanel.setLayout(new BorderLayout());

        JPanel gamepanel=new JPanel();
        gamepanel.setBorder(BorderFactory.createTitledBorder("Photo Puzzle"));
        gamepanel.setLayout(new GridLayout(3,3));

        ImageIcon sica = new ImageIcon("jung.jpg");
        image1.setBorder(BorderFactory.createLineBorder(Color.blue));
        image1.setIcon(sica);
        image1.setSize(200,200);
        image1.setVisible(true);
        image1.setToolTipText("Jessica Jung Sooyeon");
        gamepanel.add((image1));

        ImageIcon yuri = new ImageIcon("kwon.jpg");
        image2.setIcon(yuri);
        image2.setSize(200,200);
        image2.setVisible(true);
        image2.setToolTipText("Kwon Yuri");
        gamepanel.add(image2);

        ImageIcon tiff = new ImageIcon("hwang.jpg");
        image3.setIcon(tiff);
        image3.setSize(200,200);
        image3.setVisible(true);
        image3.setToolTipText("Tiffany Hwang Miyoung");
        gamepanel.add(image3);

        ImageIcon sunny = new ImageIcon("lee.jpg");
        image4.setIcon(sunny);
        image4.setSize(200,200);
        image4.setVisible(true);
        image4.setToolTipText("Sunny Lee Sunkyu");      
        gamepanel.add(image4);

        ImageIcon soo = new ImageIcon("choi.jpg");
        image5.setIcon(soo);
        image5.setSize(200,200);
        image5.setVisible(true);
        image5.setToolTipText("Choi Sooyoung");
        gamepanel.add(image5);

        ImageIcon hyo = new ImageIcon("kimh.jpg");
        image6.setIcon(hyo);
        image6.setSize(200,200);
        image6.setVisible(true);
        image6.setToolTipText("Kim Hyoyeon");
        gamepanel.add(image6);

        ImageIcon yoona = new ImageIcon("im.jpg");
        image7.setIcon(yoona);
        image7.setSize(200,200);
        image7.setVisible(true);
        image7.setToolTipText("Im Yoona");      
        gamepanel.add(image7);

        ImageIcon taeng = new ImageIcon("kimt.jpg");
        image8.setIcon(taeng);
        image8.setSize(200,200);
        image8.setVisible(true);
        image8.setToolTipText("Kim Taeyeon");
        gamepanel.add(image8);

        ImageIcon hyunnie = new ImageIcon("seo.jpg");
        image9.setIcon(hyunnie);
        image9.setSize(200,200);
        image9.setVisible(true);
        image9.setToolTipText("Seohyun Seo Juhyun");
        gamepanel.add(image9);

        JPanel controls = new JPanel();
        controls.setLayout(new BorderLayout());
        controls.setBorder(BorderFactory.createTitledBorder("Control"));

        JButton newGame = new JButton("New Game");
        controls.add(newGame, BorderLayout.NORTH);

        JButton exitGame = new JButton("Exit");
        controls.add(exitGame, BorderLayout.SOUTH);

        mainpanel.add(gamepanel, BorderLayout.CENTER);
        mainpanel.add(controls, BorderLayout.EAST);

        process jj = new process(); 

        image1.addActionListener(jj);
        image2.addActionListener(jj);
        image3.addActionListener(jj);
        image4.addActionListener(jj);
        image5.addActionListener(jj);
        image6.addActionListener(jj);
        image7.addActionListener(jj);
        image8.addActionListener(jj);
        image9.addActionListener(jj);

    }

    class process implements ActionListener
    {
        public void actionPerformed (ActionEvent e)
        {
            if(e.getSource().equals(image1))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image2))
            {
                image1.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image3))
            {
                image2.setVisible(false);
                image1.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image4))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image1.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image5))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image1.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image6))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image1.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image7))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image1.setVisible(false);
                image8.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image8))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image1.setVisible(false);
                image9.setVisible(false);
                text.setVisible(false);

            }

            else if(e.getSource().equals(image9))
            {
                image2.setVisible(false);
                image3.setVisible(false);
                image4.setVisible(false);
                image5.setVisible(false);
                image6.setVisible(false);
                image7.setVisible(false);
                image8.setVisible(false);
                image1.setVisible(false);
                text.setVisible(false);

            }

        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:52:38.423

你永远不会添加`mainpanel`到你的`JFrame`. 还要确保在添加所有组件`JFrame.setVisible(true)` *后调用。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:52:31.110

主要问题是您没有将显示面板添加到`JFrame`.

`Swing`您需要将其添加到`content pane`.

之后，您要调用`pack()`它会调整窗格的大小并使其中的所有内容“适合”。

最后调用`setVisible(true)`不是必需的，但这是一种很好的做法。

我一直觉得这些[教程](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)很有帮助。

```
public midterm()
{
    super("Girls' Generation - I GOT A BOY 4th Korean Album");
    setSize(700,700);
    setLocation(200,30);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setResizable(false);

    panel();
    this.getContentPane().add(mainpanel);//<-- add panel to content pane
    this.pack();                         //<-- resize everything
    setVisible(true);                    //<-- display
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T20:56:09.547

只需将 Jpanel ( **mainpanel** ) 添加到您的 Jframe

```
panel();    
this.getContentPane().add(mainpanel);
setVisible(true); 
```

# python - 在没有时区信息的情况下，pythons mktime 如何工作？

> ID：14467697
> 
> 赞同：0
> 
> 时间：2013-01-22T20:46:23.680
> 
> 标签：python, time

我有工作代码。我的问题是*为什么*这行得通？

```
#"04/13/05 2:30pm EDT" <- original date string
from datetime import datetime, timedelta
from pytz import timezone
import pytz
import time

T= time.struct_time((2005,4,13,14,30,0,0,0,1))
t = time.mktime(T)

print(t) 
```

这打印

```
1113417000, 
```

根据在线转换器[http://www.epochconverter.com/](http://www.epochconverter.com/)打印

```
Your time zone: 4/13/2005 2:30:00 PM GMT-4 
```

哪个是对的。我的问题是，它怎么知道 EDT 的时间是 GMT-4？9 元组中的最后一个是“dst 标志”，但有许多使用 DST 的时区。那么它如何检测正确的时区呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:49:59.907

[它通过 stdlib C 时间函数](http://en.wikipedia.org/wiki/C_date_and_time_functions)向您的操作系统询问该信息。

引用[`time`模块文档](http://docs.python.org/2/library/time.html)：

> 该模块中定义的大部分函数都调用同名的平台 C 库函数。有时查阅平台文档可能会有所帮助，因为这些函数的语义因平台而异。

您可以为 DST 标志传入 -1 以让库为您设置它，请参阅[`time.struct_time`](http://docs.python.org/2/library/time.html#time.struct_time). 在我为欧洲/奥斯陆时区配置的 Mac OS X 10.7.5 设置中，这给了我：

```
>>> import time
>>> time.mktime((2005,4,13,14,30,0,0,0,-1))
1113395400.0 
```

或者，作为 epochconverter 的“翻译”：

```
Your time zone: 4/13/2005 2:30:00 PM GMT+2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-28T12:11:10.733

根据[文档](https://docs.python.org/2/library/time.html?highlight=mktime#time.mktime)，函数 time.mktime(t) 采用以本地时间而不是 UTC 表示的参数 (struct_time)。本地时间取自您的操作系统。您可以使用例如[time.tzname来查看您的本地 DST 时区](https://docs.python.org/2/library/time.html?highlight=time.tzname#time.tzname)

# asp.net-mvc - 我的 ASP.NET MVC 应用程序的 ASP.NET 预编译在 AppHarbor 上失败，错误在哪里？

> ID：14467703
> 
> 赞同：2
> 
> 时间：2013-01-22T20:46:53.150
> 
> 标签：asp.net-mvc, build, appharbor

我的 ASP.NET MVC 应用程序的 ASP.NET 预编译在部署到 AppHarbor 时失败，表面上是因为在 Razor 视图中引用了不存在的类型。这可能是正确的，但哪个文件有误！？

```
Microsoft (R) ASP.NET Compilation Tool version 4.0.30319.17929
Utility to precompile an ASP.NET application
Copyright (C) Microsoft Corporation. All rights reserved.

d:\temp\0kxqxggv.qii\temp\root\aecd3928\90d8ef26\App_Web_24m5b001.0.cs(36): error CS0234: The type or namespace name 'User' does not exist in the namespace 'MyApp.Models' (are you missing an assembly reference?)

[HttpCompileException]: d:\temp\0kxqxggv.qii\temp\root\aecd3928\90d8ef26\App_Web_24m5b001.0.cs(36): error CS0234: The type or namespace name 'User' does not exist in the namespace 'MyApp.Models' (are you missing an assembly reference?)
   at System.Web.Compilation.AssemblyBuilder.Compile()
   at System.Web.Compilation.WebDirectoryBatchCompiler.CompileAssemblyBuilder(AssemblyBuilder builder)
   at System.Web.Compilation.WebDirectoryBatchCompiler.<CompileNonDependentBuildProviders>b__0(AssemblyBuilder assemblyBuilder)
   at System.Web.Compilation.CompilationUtil.CompileParallel(ICollection assemblyBuilders, Action`1 action)
   at System.Web.Compilation.WebDirectoryBatchCompiler.CompileNonDependentBuildProviders(ICollection buildProviders)
   at System.Web.Compilation.WebDirectoryBatchCompiler.Process()
   at System.Web.Compilation.BuildManager.BatchCompileWebDirectoryInternal(VirtualDirectory vdir, Boolean ignoreErrors)
   at System.Web.Compilation.BuildManager.BatchCompileWebDirectory(VirtualDirectory vdir, VirtualPath virtualDir, Boolean ignoreErrors)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileWebDirectoriesRecursive(VirtualDirectory vdir, Boolean topLevel)
   at System.Web.Compilation.BuildManager.PrecompileAppInternal(VirtualPath startingVirtualDir, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManager.PrecompileApp(VirtualPath startingVirtualDir, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManager.PrecompileApp(ClientBuildManagerCallback callback, IEnumerable`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManagerHost.PrecompileApp(ClientBuildManagerCallback callback, List`1 excludedVirtualPaths)
   at System.Web.Compilation.BuildManagerHost.PrecompileApp(ClientBuildManagerCallback callback, List`1 excludedVirtualPaths)
   at System.Web.Compilation.ClientBuildManager.PrecompileApplication(ClientBuildManagerCallback callback, Boolean forceCleanBuild)
   at System.Web.Compilation.ClientBuildManager.PrecompileApplication(ClientBuildManagerCallback callback)
   at System.Web.Compilation.Precompiler.Main(String[] args)

Website precompilation failed with exit code 1\. Precompilation can optionally be disabled in application settings 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-21T12:51:50.413

您是否尝试过在 Visual Studio 上启用视图编译？如果您启用它，您可以在您的 ide 上调试错误

在项目内的 .csproj 文件中将 MvcBuildViews 更改为 true -> 属性组

```
<Project ToolsVersion="3.5" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
 <PropertyGroup>
  <MvcBuildViews>true</MvcBuildViews>
 </PropertyGroup> 
```

[在 ASP.NET MVC 中编译视图](https://stackoverflow.com/questions/383192/compile-views-in-asp-net-mvc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-10T10:10:15.027

这可能很旧，但它可能会帮助其他人知道如何阅读这种日志以及将来在哪里查找错误。

因为它位于错误日志的第 4 行。

```
d:\temp\0kxqxggv.qii\temp\root\aecd3928\90d8ef26\App_Web_24m5b001.0.cs(36): error CS0234: The type or namespace name 'User' does not exist in the namespace 'MyApp.Models' (are you missing an assembly reference?) 
```

有足够的信息可以知道错误发生的*位置*和*原因。*

*哪里：*在这个名为的文件上`App_Web_24m5b001.0.cs`位于`d:\temp\0kxqxggv.qii\temp\root\aecd3928\90d8ef26\App_Web_24m5b001.0.cs`在线`(36)`

*为什么：* `The type or namespace name 'User' does not exist in the namespace 'MyApp.Models' (are you missing an assembly reference?)`

**注意**如果您使用源代码控制部署到 appharbor，可能是您已更改`User`并忘记包含导致此错误的提交更改。至少那是发生在我身上的事情。

# java - 在我认可的目录中添加和删除 jars 后，Eclipse 给我所有项目的错误

> ID：14467710
> 
> 赞同：1
> 
> 时间：2013-01-22T20:47:47.813
> 
> 标签：java, eclipse

我在 Java 1.6 上使用 JAXWS 2.2.7，所以我需要按照[本文档](http://docs.oracle.com/javase/6/docs/technotes/guides/standards/)将 jars 添加到 jre/lib/endorsed 目录来升级 API 。

这工作得很好，但经过一番考虑，我决定通过从背书目录中删除库来回滚到旧版本的 API。但这给我的所有项目留下了以下错误。

```
The container 'JRE System Library [JavaSE-1.6]' references non existing library '/usr/java/jdk1.6.0_21/jre/lib/endorsed/jaxws-api.jar' 
```

显然，eclipse 添加了某种引用 jar 文件的元数据，但是当我们删除 JAR 文件时，它还不够聪明，无法删除元数据属性。

我在项目目录和 eclipse 安装目录中搜索这个元数据是徒劳的。任何人都可以帮忙吗？

这些是我的平台详细信息：

```
Eclipse Juno   Build id: 20120614-1722
Fedora 15
jdk1.6.0_21 
```

# java - 在 Java 中显示数百万张图像的最佳方式是什么？

> ID：14467719
> 
> 赞同：23
> 
> 时间：2013-01-22T20:48:08.047
> 
> 标签：java, swing, imageview, javafx

你看到了吗？

![在此处输入图像描述](../Images/bdda232f1e91e238220d2cf78e6b2136.png)

每栋房屋的每块砖都是 16x16 像素的图像。

你可以在这里看到一个基于简单 JavaFX 的版本，其中一些`Imageview`在 X 和 Y 上移动以产生“构造”的效果。

我只是将其调整为`Swing`使用`paintComponent`.

问题： - 使用 JavaFX：我的电脑有问题。您在图片上看到的内容需要 2 秒才能加载，然后它的移动非常缓慢且不稳定。- With `Swing`: 我不知道如何根据亮度、阴影等调整每个块。所以它看起来像这样：

![在此处输入图像描述](../Images/2408fcdc27156225a833372ca02e498f.png)

我应该选择什么方法？两者都有很大的缺点。我本来希望保留 JavaFX 方法，但也想找到`Imageview`. 这不应该是个好主意。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-01-22T22:22:54.283

有关 Swing 优化和实现的信息，请参阅其他答案，因为我的答案是 JavaFX 特定的。

如果您坚持使用 JavaFX 实现，可以尝试以下几点：

1.  使用[node.setCache(true)](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#setCache%28boolean%29)打开节点缓存。
2.  使用[node.setCacheHint(CacheHint.SPEED)](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#setCacheHint%28javafx.scene.CacheHint%29)启用高速节点转换。
3.  提供一个没有效果的实现和另一个有效果的实现，看看没有效果的实现是否明显更好。（如果是这种情况，您可能需要使用更有效的效果链或完全放弃某些效果）。
4.  检查[JavaFX 系统要求](http://docs.oracle.com/javafx/2/system_requirements_2-2/jfxpub-system_requirements_2-2.htm)，以确保您的设置在硬件/操作系统/驱动程序组合方面满足硬件加速的最低要求。
5.  如果您正在使用基于[区域](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/Region.html)和 css 的处理，请注意[css 系统](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html)不会造成太多开销（例如，拥有不使用 css 的代码版本并比较其性能）。
6.  如果需要，实现细节级别的缩放，（例如，缩小时为整个房子提供单个图像，而不是为每个房子瓷砖提供单独的图像）。
7.  确保您只加载一次给定的[Image并在多个](http://docs.oracle.com/javafx/2/api/javafx/scene/image/Image.html)[ImageViews](http://docs.oracle.com/javafx/2/api/javafx/scene/image/ImageView.html)中重用它。
8.  使用分析器来识别瓶颈。
9.  改变测试 CPU 或显卡以查看其中任何一个是否是瓶颈。
10.  试用[Java 8 预览版](http://jdk8.java.net/)，其中包含许多针对 JavaFX 的内部[性能优化。](http://fxexperience.com/2012/09/preliminary-performance-numbers-in-javafx-8/)
11.  如果要加载大量图像，请使用[背景加载](http://docs.oracle.com/javafx/2/api/javafx/scene/image/Image.html#isBackgroundLoading%28%29)，并在加载图像时在前面播放动画或进度条。
12.  如果要加载大量图像，[请在 Image 构造函数中预先缩放它们，](http://docs.oracle.com/javafx/2/api/javafx/scene/image/Image.html#Image%28java.lang.String,%20double,%20double,%20boolean,%20boolean,%20boolean%29)这样它们就不会占用太多内存或（可能）需要额外的处理能力来处理额外的像素（只有在使用大量图像时才需要考虑）不同的非常高分辨率的纹理 - 你似乎没有这样做）。

例如：

```
Image tile = new Image("tile.png");

Group house = new Group();
house.setCache(true);
house.setCacheHint(CacheHint.SPEED);

Effect lighting = new Lighting();

for (int i = 0; i < houseWidth; i++) {
  // here is the critical part => don't do new ImageView(new Image("tile.png"))
  ImageView tileView = new ImageView(tile));
  tileView.setEffect(lighting);
  tileView.setCache(true);
  tileView.setCacheHint(CacheHint.SPEED);

  house.add(tileView);  
} 
```

* * *

Mantrid 的建议很有趣。我确实相信，使用 JavaFX，您不需要自己实现脏矩形算法（因为底层平台能够为您处理脏区域处理）。可能是因为它是一种通用机制，它没有提供特定情况所需的优化级别，在这种情况下，您需要自己处理脏处理（例如，通过从场景图中删除节点并重新添加视情况而定）。

此外，可以通过在 JavaFX 中定义效果，将效果应用到屏幕外 ImageView 节点，然后[拍摄屏幕外 ImageView 节点的快照](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#snapshot%28javafx.scene.SnapshotParameters,%20javafx.scene.image.WritableImage%29)以获得预先计算的图像，来预先计算图像上的模糊/亮度/等。这种技术将允许您重用现有的 JavaFX 效果管道，而无需使用 ConvolveOp 机制重新实现它。也许您可以通过在 ImageView 节点上将 cache 设置为 true 并将 cacheHint 设置为加速来获得相同的性能水平，因为我相信这在幕后做了类似的事情（即以增加内存使用为代价来提高速度）。

* * *

JavaFX 场景图非常高效，可以处理数千个节点。但是，您的应用程序中可能有更多。如果上述优化点对您没有帮助，您可能需要计算您的节点数并将您的问题的参考（可能还有一些来源）发布到[open-jfx 邮件列表](http://openjdk.java.net/projects/openjfx/)，其中 JavaFX 开发人员了解 JavaFX 应用程序的详细信息优化是。

JavaFX 8 对[3D 场景图](https://wikis.oracle.com/display/OpenJDK/3D+Features)的支持比 JavaFX 2.2 中的（大部分没用的）3D 场景图要好得多。您当前的应用程序似乎是 psuedo-3d，您可以在其中转换 2D 对象、单独应用照明效果并调整每个图块的亮度以获得 3D 外观。如果是这种情况，使用具有统一 3D 照明模型的完全硬件加速的 3D 场景图最终*可能会*表现得更好、看起来更好并且更容易使用 - 您必须在应用程序的上下文中对其进行评估以查看它是否是值得将您的应用程序从 2D JavaFX 场景图切换到 3D JavaFX 场景图，或从 JavaFX 切换到 Swing 或[libgdx](http://libgdx.badlogicgames.com/)等其他技术。

**附录**

对 Mizur 的一些附加问题的回答：

> 那么为什么它们如此耗电呢？

从我的回答中可以看出，性能有很多方面，因此找出一个特定的原因来解释为什么某些东西耗电有时很困难，而且通常是不可能的。有时它是导致性能问题的因素的组合。最大的胜利通常来自优化在最内部循环中执行的内容或通过更改用于解决问题的策略。

> 如果他们需要这么多，请让我移动瓷砖，或者只是展示，不是吗？

就只为移动的东西消耗资源而言，JavaFX 场景图对此进行了一些优化，缓存提示之类的东西可以进一步提高性能。对于您的特定用例或您使用系统的方式，它们可能还不够。您可能需要更改算法以减少系统负载。

> 有没有办法用这种 Imageview 技术生成每个建筑物的图像，然后将这些建筑物的图像整合到最终场景中？

是的 - 您可以使用许多图像和节点将建筑物渲染到屏幕外场景，[对屏幕外场景进行快照](http://docs.oracle.com/javafx/2/api/javafx/scene/Scene.html#snapshot%28javafx.util.Callback,%20javafx.scene.image.WritableImage%29)以创建单个图像，然后将该图像覆盖在您的最终场景上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:10:42.323

> 在绘制图像之前修改图像的模糊/亮度/等

我自己没有使用过，但这里有一个提示——使用 Swing/AWT Kernel+ConvolveOp 机制：[http ://www.java-tips.org/java-se-tips/java.awt.image/styling-digital-带有 convolveop.html 的图像](http://www.java-tips.org/java-se-tips/java.awt.image/styling-digital-images-with-convolveop.html)

```
BufferedImage biSrc = ...
BufferedImage biDest = ...

float[] data = new float[] { 0.0625f, 0.125f, 0.0625f, 0.125f, 0.25f, 0.125f, 0.0625f, 0.125f, 0.0625f };
Kernel kernel = new Kernel(3, 3, data);
ConvolveOp convolve = new ConvolveOp(kernel, ConvolveOp.EDGE_NO_OP, null);
convolve.filter(biSrc, biDest); 
```

操作通过 3x3 矩阵（数据）定义。您可以搜索亮度、模糊等的示例。

> 图片加载需要 2 秒，但之后移动非常缓慢且生涩

使用脏矩形算法：[脏矩形](https://stackoverflow.com/questions/76651/dirty-rectangles)

# ios - 将 OpenCV 的 findHomography 透视矩阵转换为 iOS 的 CATransform3D

> ID：14467724
> 
> 赞同：4
> 
> 时间：2013-01-22T20:48:34.770
> 
> 标签：ios, opencv, matrix, perspective, catransform3d

我想采用从 OpenCV[`findHomography`](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findhomography)函数返回的透视变换矩阵并将其（在 C++ 或 Objective-C 中）转换为 iOS' `CATransform3D`。我希望它们在准确再现核心图形方面的“扭曲”效果方面尽可能接近。示例代码将不胜感激！

来自 iOS 的 CATransform3D.h：

```
/* Homogeneous three-dimensional transforms. */

struct CATransform3D
{
    CGFloat m11, m12, m13, m14;
    CGFloat m21, m22, m23, m24;
    CGFloat m31, m32, m33, m34;
    CGFloat m41, m42, m43, m44;
}; 
```

类似的问题：

[使用 Core Graphics 应用单应矩阵](https://stackoverflow.com/questions/8993012/apply-homography-matrix-using-core-graphics)

[将 opencv 仿射矩阵转换为 CGAffineTransform](https://stackoverflow.com/questions/14387806/convert-an-opencv-affine-matrix-to-cgaffinetransform)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T23:29:04.837

**免责声明**

我从来没有试过这个，所以把它和一粒盐一起吃。

CATRansform3D 是一个 4x4 矩阵，它对 3 维齐次向量 (4x1) 进行运算以生成另一个相同类型的向量。我假设在渲染时，由 4x1 向量描述的对象的每个元素除以第 4 个元素，而第 3 个元素仅用于确定哪些对象出现在哪些对象之上。假设这是正确的......

**推理**

findHomography 返回的 3x3 矩阵对二维齐次向量进行运算。该过程可以分为 4 个步骤

1.  单应性的第一列乘以 x
2.  单应性的第二列乘以y
3.  单应性第三列乘以1
4.  得到的第一个和第二个向量元素除以第三个

您需要在 4x4 向量中复制此过程，我假设结果向量中的第三个元素对您的目的没有意义。

**解决方案**

像这样构造你的矩阵（H是你的单应矩阵）

```
[H(0,0), H(0,1), 0, H(0,2),
 H(1,0), H(1,1), 0, H(1,2),
      0,      0, 1,      0
 H(2,0), H(2,1), 0, H(2,2)] 
```

这显然满足 1,2 和 3。满足 4 是因为齐次元素总是最后一个。这就是为什么“同质行”如果你不得不被撞到一条线上。第 3 行的 1 是让向量的 z 分量不受干扰地通过。

以上所有内容均以行主要符号（如 openCV）完成，以尽量避免混淆。您可以查看 Tommy 的答案以了解转换为主要列的外观（您基本上只是转置它）。但是请注意，目前汤米和我在如何构建矩阵方面存在分歧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T21:08:45.160

根据我对文档的阅读，`m11`in`CATransform3D`相当于`a`in `CGAffineTransform`，`m12`相当于`b`等等。

根据您在下面的评论，我了解 OpenCV 返回的矩阵为 3x3（回想起来，这是您期望的大小）。因此，您将使用与单位矩阵等效的元素填充其他元素。根据 Hammer 的回答，您希望保留处理（通常是隐含的）同质坐标的部分，同时用身份填充其他所有内容。

[旁白：我原来的答案是*错误*的。我已经将其编辑为正确，因为我已经发布了代码而 Hammer 没有。这篇文章被标记为社区 wiki，以反映这绝不是我的回答]

所以我想你会想要：

```
CATransform3D MatToTransform(Mat cvTransform)
{
    CATransform3D transform;

    transform.m11 = cvTransform.at<float>(0, 0);
    transform.m12 = cvTransform.at<float>(1, 0);
    transform.m13 = 0.0f;
    transform.m14 = cvTransform.at<float>(2, 0);

    transform.m21 = cvTransform.at<float>(0, 1);
    transform.m22 = cvTransform.at<float>(1, 1);
    transform.m23 = 0.0f;
    transform.m24 = cvTransform.at<float>(2, 1);

    transform.m31 = 0.0f;
    transform.m32 = 0.0f;
    transform.m33 = 1.0f;
    transform.m34 = 0.0f;

    transform.m41 = cvTransform.at<float>(0, 2);
    transform.m42 = cvTransform.at<float>(1, 2);
    transform.m43 = 0.0f;
    transform.m44 = cvTransform.at<float>(2, 2);

    return transform;
} 
```

或者`cvGetReal1D`，如果您不使用 C++，请使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-14T02:21:49.873

汤米的回答对我有用，但我需要使用双精度，而不是浮点数。这也是代码的缩短版本：

```
CATransform3D MatToCATransform3D(cv::Mat H) {
    return {
        H.at<double>(0, 0), H.at<double>(1, 0), 0.0, H.at<double>(2, 0),
        H.at<double>(0, 1), H.at<double>(1, 1), 0.0, H.at<double>(2, 1),
        0.0, 0.0, 1.0, 0.0,
        H.at<double>(0, 2), H.at<double>(1, 2), 0.0f, H.at<double>(2, 2)
    };
} 
```

# wpf - WPF 网格布局错误

> ID：14467725
> 
> 赞同：1
> 
> 时间：2013-01-22T20:48:39.217
> 
> 标签：wpf, layout, grid

在下面的 WPF 网格中，中间的列不是 6。文本 B 一直向右，而不是距离文本 A 6。我已经尝试 * 而不是 Auto 其他列，但结果是一样的。

如何使中间列 6？有解决方法吗？为什么会这样？它是预期的行为还是错误？

我以这种方式制作网格，这样我就不必为每个元素设置边距。

```
<ScrollViewer HorizontalScrollBarVisibility="Auto">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="6" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="6" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock Grid.ColumnSpan="3" Grid.Column="0" HorizontalAlignment="Left">xxxxxxxxxxxxxxxxxxxxxxxxxxxx</TextBlock>
        <TextBlock Grid.Row="2">Text A</TextBlock>
        <Rectangle Fill="YellowGreen" Grid.Column="1" Grid.Row="2" HorizontalAlignment="Stretch" />
        <TextBlock Grid.Row="2" Grid.Column="2"  Background="LightCoral">Text B</TextBlock>
    </Grid>
</ScrollViewer> 
```

注意：我的窗口宽度是自动的。

编辑：使用[@flq 的解决方案](https://stackoverflow.com/a/14468144/868538)，但添加了水平滚动的滚动查看器，问题又回来了。这可能与解决方案无法在设计器中正确显示的原因相同，这与 WPF 不知道如何在没有约束宽度的情况下计算宽度有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:14:59.577

我无法确认将第三列设置为 * 不起作用。使用以下 XAML：

```
<Grid HorizontalAlignment="Left">
  <Grid.ColumnDefinitions>
      <ColumnDefinition Width="Auto" />
      <ColumnDefinition Width="6" />
      <ColumnDefinition Width="*" />

  </Grid.ColumnDefinitions>

  <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="6" />
      <RowDefinition Height="Auto" />
  </Grid.RowDefinitions>

  <TextBlock Grid.ColumnSpan="3" Grid.Column="0" HorizontalAlignment="Left">xxxxxxxxxxxxxxxxxxxxxxxxxxxx</TextBlock>
  <TextBlock Grid.Row="2">Text A</TextBlock>
  <Rectangle Fill="YellowGreen" Grid.Column="1" Grid.Row="2" HorizontalAlignment="Stretch" />
  <TextBlock Grid.Row="2" Grid.Column="2"  Background="LightCoral">Text B</TextBlock>
</Grid> 
```

我明白了：

![截屏](../Images/94fd42b580e7652c73f10e48c7df25e9.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:11:05.237

我认为您想在其他非固定长度的列上使用“*”

```
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="*" />
    <ColumnDefinition Width="6" />
    <ColumnDefinition Width="*" />
</Grid.ColumnDefinitions> 
```

![在此处输入图像描述](../Images/82a720bc996afe2b2795f5af477aab46.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T22:49:02.310

> 如何使中间列 6？有解决方法吗？

`MaxWidth`通过在里面设置a来解决`ScrollViewer`（我用了最大的double值）。

> 为什么会这样？它是预期的行为还是错误？

在 ScrollViewer（或设计器）中，没有最大宽度。在布局计算中的某处，它将列宽分配为 6 + *。

我认为最终这是一个错误，因为可以在不需要最大宽度的情况下计算列宽（它被指定为固定值，甚至不需要计算）。

```
<ScrollViewer HorizontalScrollBarVisibility="Auto">
    <Grid MaxWidth="1.79769E308">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="6" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="6" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock Grid.ColumnSpan="4">xxxxxxxxxxxxxxxxxxxxxxxxxxxx</TextBlock>
        <TextBlock Grid.Row="2">Text A</TextBlock>
        <Rectangle Fill="YellowGreen" Grid.Column="1" Grid.Row="2" />
        <TextBlock Grid.Row="2" Grid.Column="2" Background="LightCoral">Text B</TextBlock>
    </Grid>
</ScrollViewer> 
```

![这是结果](../Images/0120c4f3e20fac5f5dc1a8f2dc43cd6b.png)

# java - java中组合框的自动刷新

> ID：14467727
> 
> 赞同：0
> 
> 时间：2013-01-22T20:48:47.437
> 
> 标签：java, swing, combobox, jframe

大家好，这里只需要一点帮助：

```
 JComboBox comboBox = new JComboBox();
        comboBox.setModel(new DefaultComboBoxModel(new String[] {"Select", "Single", "Twin", "Double", "Suit", "Conference"}));

        String[] single = d.getAvaSinglelist().toArray(new String[d.getAvaSinglelist().size()]);
        String[] Dbroon = d.getAvaDoublelist().toArray(new String[d.getAvaDoublelist().size()]);
        String[] Twin = d.getAvaTwinlist().toArray(new String[d.getAvaTwinlist().size()]);
        String[] Suit = d.getAvaSuitslist().toArray(new String[d.getAvaSuitslist().size()]);
        String[] conf = d.getAvaConferencelist().toArray(new String[d.getAvaConferencelist().size()]);
        JComboBox comboBox_1 = new JComboBox();

            if(comboBox.getSelectedItem().equals("Single")){
                comboBox_1.setModel(new DefaultComboBoxModel(single));
            }

            if(comboBox.getSelectedItem().equals("Twin")){
                comboBox_1.setModel(new DefaultComboBoxModel(Dbroon));
            }
            if(comboBox.getSelectedItem().equals("Double")){
                comboBox_1.setModel(new DefaultComboBoxModel(Twin));
            }
            if(comboBox.getSelectedItem().equals("Suit")){
                comboBox_1.setModel(new DefaultComboBoxModel(Suit));
            }
            if(comboBox.getSelectedItem().equals("Conference")){
                comboBox_1.setModel(new DefaultComboBoxModel(conf));
            } 
```

所以我想做什么并且无法找出如何在动态模式下根据第一个组合框的选定项目刷新第二个组合框，但正如你们所看到的，我不知道每个提示都是受欢迎的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T20:51:04.560

在您`ActionListener`的第一个`JComboBox`. 然后在该代码中添加用于更新第二个组合框的逻辑。

# html - css - 背景图像而不是图标字体

> ID：14467733
> 
> 赞同：0
> 
> 时间：2013-01-22T20:49:09.200
> 
> 标签：html, css, button, pseudo-element

截至目前，我的按钮使用图标字体。我想删除图标字体，改用图像。

这就是我的代码的样子

```
.zocial::before {
content: "";
/* some code goes here */
}
.zocial.plus::before {
content: "p";
} 
```

我创建了一个 jsfiddle 来向您展示演示。[点这里观看](http://jsfiddle.net/Viruthagiri/gF6ys/9/)

如您所见，该按钮现在具有图标字体（即 p）和搜索图标。

现在我想删除那个“p”字符并将搜索图标移到那里。

非常感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:09:10.523

试一试。

```
.zocial.plus::before {
    content: "\0000a0";
    background: url("http://twitter.github.com/bootstrap/assets/img/glyphicons-halflings-white.png") -48px 8px no-repeat;
} 
```

这是小提琴：http: [//jsfiddle.net/VJsHb/](http://jsfiddle.net/VJsHb/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:14:58.430

代替

```
content:"p" 
```

您可以使用

```
content: url("http://twitter.github.com/bootstrap/assets/img/glyphicons-halflings-white.png"); 
```

当然，使用正确的图像。

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:04:10.730

你可以使用这样的东西：

```
content: url("url/to/image.png"); 
```

或者`:before`像处理元素一样在选择器中创建背景。

```
.zocial.plus::before {
    background-image: url("url/to/image.png");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T20:58:37.700

只是我在列表中使用的示例。试试这个，适合您的解决方案：

```
<div class="Info">
    <ul>
    <li>Text here</li>
    <li>Text here</li>
    <li>Text here</li>
    <li>Text here</li>
    </ul>
</div>

.Info ul li
{
padding-bottom:10px;
list-style-type:none; /* Switch the list bullet off altogether. */
background-image:url("images/yourImage.png"); /* The replacement bullet image */
background-position:0px 2px; /* Place bullet 0px from left and 4px from top */
background-repeat:no-repeat; /* Stops bullet tiling, important */
padding-left:22px; /* separation from li txt and bullet */

} 
```

# objective-c - 在 iOS6 中关闭呈现的 UINavigationController

> ID：14467734
> 
> 赞同：3
> 
> 时间：2013-01-22T20:49:09.400
> 
> 标签：objective-c, uiviewcontroller, ios6, uinavigationcontroller, uiimagepickercontroller

在我的根 UIViewController 中，我展示了一个 UINavigationController。UINavigationController 最终推送另一个视图（我们称之为 MyViewController）。如何从 MyViewController 中关闭整个 UINavigationController（以及它推送的视图）？

从 MyViewController，我尝试调用`[[self.navigationController presentingViewController] dismissViewControllerAnimated:NO completion:nil]`但没有任何反应。我还尝试过首先将所有视图控制器从导航控制器中弹出，但导航控制器仍然没有被解除。

谢谢！

**更新**：

我已经找到了导致此问题的原因，但无法解决。上面描述的 UINavigationController 是 UIImagePickerController（我们称之为 CameraController）的自定义子类，源类型为 UIImagePickerControllerSourceTypeCamera。一切都按预期工作（使用下面提供的答案），直到我`cameraOverlayView`在`viewDidLoad`. 注释掉以下几行可以使事情正常进行：

```
self.showCameraControls = NO;
UIView *overlay = [[[NSBundle mainBundle] loadNibNamed:@"CameraController" owner:self options:nil] objectAtIndex:0];
self.cameraOverlayView = overlay; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T00:26:27.757

你可以调用`dismissViewControllerAnimated:NO`你`self.navigationController`自己。

```
[self.navigationController dismissViewControllerAnimated:NO completion:nil]; 
```

# java - 正则表达式 - 将所有匹配项作为单个匹配项返回

> ID：14467743
> 
> 赞同：1
> 
> 时间：2013-01-22T20:49:55.063
> 
> 标签：java, regex

我正在使用一段将正则表达式应用于字符串并返回第一个匹配项的代码。我无权修改代码以返回所有匹配项，也无权实现替代代码。

我有以下示例目标字符串：

> usera,userb,,userc,,userd,usere,userf,

这是从多个来源加入的以逗号分隔的用户名列表，其中一些是空白的，导致在某些地方有两个逗号。我正在尝试编写一个正则表达式，它将返回除特定值之外的所有逗号分隔的用户名。

例如，考虑以下表达式：

```
[^,]\w{1,},(?<!(userb|userc|userd),) 
```

> 这导致三个匹配：
> 
> 用户，
> 
> 用户，
> 
> 用户，

有没有办法将这些结果作为单个匹配而不是匹配集合，例如具有文本 'usera,usere,userf,' 的单个匹配？

如果我可以用任何语言编写代码，这将是微不足道的，但我仅限于输入目标字符串和模式，并且我需要一个匹配项，该匹配项包含除我省略的项之外的所有项。我不确定这是否可能，我用正则表达式所做的一切都涉及处理匹配集合中的多个项目。

这是 Regex Coach 中的一个示例。这张图片显示了我想要的三个匹配项，但我的要求是将文本放在一个匹配项中，而不是三个单独的匹配项。

![在此处输入图像描述](../Images/d6f834c149550790b6750bd914b5f79a.png)

**EDIT1：** 为了澄清这张票，专门用于解决仅使用正则表达式语法的用例。用代码解决这个问题是微不足道的，但考虑到执行代码是我不想逆向工程、包装或替换的第 3 方产品的一部分，因此只使用正则表达式解决它是必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:11:16.743

> 有没有办法将这些结果作为单个匹配而不是匹配集合，例如具有文本的单个匹配`'usera,usere,userf,'`？

不，正则表达式匹配是连续的。

正则表达式从头到尾匹配（子）字符串。你不能放弃中间部分，这不是正则表达式引擎的工作方式。但是您可以再次应用该表达式来查找另一个匹配的子字符串（增量搜索 - 这就是 Regex Coach 所做的）。这将导致匹配集合。

* * *

话虽如此，您也可以匹配您不想保留的所有内容*并将*其删除，例如

```
,(?=[\s,]+)|(userb|userc|userd)[\s,]* 
```

[http://rubular.com/r/LOKOg6IeBa](http://rubular.com/r/LOKOg6IeBa)

# objective-c - 更改 NSTableHeader 中的字体颜色

> ID：14467754
> 
> 赞同：2
> 
> 时间：2013-01-22T20:50:34.147
> 
> 标签：objective-c, macos, cocoa, nstableview

如何更改标题中的字体颜色`NSTableView`？

在 Xcode Interface Builder 中 -属性中`Font Panel`的任何颜色修改都将被忽略/丢弃。 我也无法在 Apple 文档中找到我的问题的正确信息。`Table Column`

有谁知道这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-16T14:17:16.840

对于 中的每个`NSTableColumns`，`[NSTableView tableColumns]`请执行以下操作：

```
[[yourColumn headerCell] setAttributedStringValue:yourNSAttributedString]. 
```

字体颜色将`NSForegroundColorAttributeName`在您的字符串属性字典中键入。

# c# - 为什么我的事件处理程序不会被调用？

> ID：14467756
> 
> 赞同：2
> 
> 时间：2013-01-22T20:50:43.910
> 
> 标签：c#, winrt-xaml, windows-store-apps

我有这个 xaml：

```
<Button VerticalAlignment="Bottom"
        Click="SaveAndGoBack"
        IsEnabled="{Binding Frame.CanGoBack,
                            ElementName=pageRoot}"
        Style="{StaticResource BackButtonStyle}" /> 
```

...但是在“点击”（单击）后退按钮时，虽然它确实返回到上一页，但`SaveAndGoBack()`没有被调用 - 我在第一行有一个断点，但没有到达。

该按钮显然已启用，因为我可以选择它并“返回”。那么为什么无法到达事件处理程序呢？

## 更新

将点击更改为点击没有区别。这是现在的 XAML：

```
<Button VerticalAlignment="Bottom"
        Tapped="SaveAndGoBack"
        IsEnabled="{Binding Frame.CanGoBack,
                            ElementName=pageRoot}"
        Style="{StaticResource BackButtonStyle}" /> 
```

...这就是方法，在第一行有一个断点，永远不会到达（但返回主页）：

```
private async void SaveAndGoBack(object sender, Windows.UI.Xaml.Input.TappedRoutedEventArgs args)
{
    SOs_Locations sos_locs = new SOs_Locations { GroupName = txtbxGroup.Text };
    int locNum;
    int.TryParse(txtbxLocationNum.Text, out locNum);
    sos_locs.LocationTitle = txtbxTitle.Text;
    sos_locs.CivicAddress = txtbxAddress.Text;
    double lat;
    double.TryParse(txtbxLatitude.Text, out lat);
    sos_locs.Latitude = lat;
    double lng;
    double.TryParse(txtbxLongitude.Text, out lng);
    sos_locs.Longitude = lng;
    if (cmbxDisplayColor.SelectedValue != null)
        sos_locs.LocationColor = cmbxDisplayColor.SelectedValue.ToString();
    await SQLiteUtils.UpdateLocationAsync(sos_locs);
    Frame.Navigate(typeof(MainPage));
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:54:26.473

`Click`是与 Tap 不同的事件。您应该寻找一个被调用的事件`Tapped`并为其创建一个 OnTapped 处理程序。

我的猜测是你的问题。该事件没有冒泡，因为在 LayoutAwarePage.cs 中该事件被设置为已处理。

您可以修改此页面以满足您的需要。寻找`CoreWindow_PointerPressed`方法并寻找它设置的区域`args.Handled = true`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:09:53.167

改用[Tapped](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.uielement.tapped.aspx)事件，因为它处理单击、点击和触控笔事件，而`Click`专门处理鼠标（有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/13493147/1203388)）。

[以下是](http://blogs.msdn.com/b/windowsappdev/archive/2012/07/02/modernizing-input-in-windows-8.aspx)有关他们如何尝试统一围绕触摸的不同指向输入模式的事件的一些信息。

# c# - 如何使用 C# for WP8 在网格中显示图像？

> ID：14467762
> 
> 赞同：1
> 
> 时间：2013-01-22T20:51:16.503
> 
> 标签：c#, xaml, windows-phone-8

我需要在 WP8 中插入图像。我有一堆图像。单击图像后，必须将其设置为网格的背景。所以我创建了一个空的“grid1”和按钮。在按钮单击事件中编写了以下代码，但图像没有显示！

```
 private void bg6_Click(object sender, RoutedEventArgs e)
    {
        System.Windows.Media.ImageBrush myBrush = new System.Windows.Media.ImageBrush();
        Image image = new Image();
        image.Source = new System.Windows.Media.Imaging.BitmapImage(
            new Uri("\\PhoneApp2\\PhoneApp2\\Assets\\bg\\bg5.jpg"));
        myBrush.ImageSource = image.Source;
       // Grid grid1 = new Grid();
        grid1.Background = myBrush;          
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T01:11:47.407

很难知道您的图像文件是否在正确的位置并设置为正确的构建类型。我建议向[Image failed 事件](http://msdn.microsoft.com/en-us/library/system.windows.controls.image.imagefailed%28v=vs.95%29.aspx)添加一个事件处理程序。

```
private void bg6_Click(object sender, RoutedEventArgs e)
{
  System.Windows.Media.ImageBrush myBrush = new System.Windows.Media.ImageBrush();
  Image image = new Image();
  image.ImageFailed += (s, e) => MessageBox.Show("Failed to load: " + e.ErrorException.Message);
  image.Source = new System.Windows.Media.Imaging.BitmapImage(
  new Uri("\\PhoneApp2\\PhoneApp2\\Assets\\bg\\bg5.jpg"));
  myBrush.ImageSource = image.Source;
  // Grid grid1 = new Grid();
  grid1.Background = myBrush;          
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T10:10:09.047

首先，您不需要使用 Image 从 URI 填充背景。

```
private void bg6_Click(object sender, RoutedEventArgs e)
{
    System.Windows.Media.ImageBrush myBrush = new System.Windows.Media.ImageBrush(new Uri("\\PhoneApp2\\PhoneApp2\\Assets\\bg\\bg5.jpg"));
   // Grid grid1 = new Grid();
    grid1.Background = myBrush;          
} 
```

其次，通过创建具有可见性和源属性的帮助器类，在 XAML 中设计它并从代码中操纵它的可见性和源代码是一种更好的方式。不要忘记在该类中实现 INotifyPropertyChanged 接口。

```
<Grid x:Name="myGrid" DataContext="{Binding}" Visibility="{Binding Path=VisibleProperty}">
<Grid.Background>
<ImageBrush x:Name="myBrush" ImageSource="{Binding Path=SourceProperty}"></ImageBrush>
</Grid.Background> 
```

在代码中：

```
private void bg6_Click(object sender, RoutedEventArgs e)
{
   myGrid.DataContext=new myImagePresenterClass(new Uri("\\PhoneApp2\\PhoneApp2\\Assets\\bg\\bg5.jpg"), Visibility.Visible)
}

public class myImagePresenterClass:INotifyPropertyChanged
{
private URI sourceProperty
Public URI SourceProperty
{
get
 {
  return sourceProperty;
 }
set
 {
   sourceProperty=value;
   if(PropertyChanged!=null){PropertyChanged(this, new PropertyChangedEventArgs("SourceProperty"));}
 }
}

//Don't forget to implement the Visible property the same way as SourceProperty and the class constructor.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T05:37:28.570

我发现了错误……对不起，伙计们。我没有正确遵循语法。我错过了 Uri 方法中的“@”。表示这一点的正确方法是

```
 private void bg1_Click(object sender, RoutedEventArgs e)
    {
        System.Windows.Media.ImageBrush myBrush = new System.Windows.Media.ImageBrush();
        Image image = new Image();
        image.ImageFailed += (s, i) => MessageBox.Show("Failed to load: " + i.ErrorException.Message);
        image.Source = new System.Windows.Media.Imaging.BitmapImage(new Uri(@"/Assets/bg/bg1.jpg/", UriKind.RelativeOrAbsolute));
        myBrush.ImageSource = image.Source;
        grid1.Background = myBrush;

    } 
```

# javascript - 从复选框选择中显示 KML 图层 - 在谷歌地图中绘制图层时出现问题

> ID：14467764
> 
> 赞同：0
> 
> 时间：2013-01-22T20:51:24.190
> 
> 标签：javascript, google-maps, google-fusion-tables

我正在尝试根据用户通过复选框的选择在谷歌地图上显示多个 KML 图层（全部存储在同一个 Fusion 表中）。地图和复选框已经出现，但 KML 图层没有出现（通常我会在地图窗口中收到平铺的“数据可能仍在加载”响应）。我基于谷歌融合表示例（IN：披萨店）的编码。

我对 html 和 java 很陌生，所以即使我无法在我的脚本中找到任何错误，或者与像[这样的其他“帮助”页面有任何明显差异，但这](https://stackoverflow.com/questions/9855067/toggle-kml-layers-in-google-maps-v3)并不意味着某处没有错误。

我为每种图层类型写了一堆：

```
google.maps.event.addDomListener(document.getElementBId('trail'),
        'click', function() {
            filterMap(layer, tableId, map);
    }); 
```

然后尝试过滤地图：

```
 function filterMap(layer, tableId, map) {
        var where = generateWhere();

        if (where) {
            if (!layer.getMap() ) {
                layer.setMap(map);
            }
            layer.setOptions({
                query: {
                    select: 'geometry',
                    from: tableId,
                    where: where
                }
            });
        } else {
            layer.setMap(null);
        }
    }

    function generateWhere() {
        var filter = [];
        var stores = document.getElementsByName('store');
        for (var i = 0, store; store = stores[i]; i++) {
            if (store.checked) {
                var storeName = store.value.replace(/'/g, '\\\'');
                filter.push("'" + storeName + "'");
            }
        }
        var where = '';
        if (filter.length) {
            where =  "'descripion' IN (" + filter.join(',') + ')';
        }
        return where;
    }

    google.maps.event.addDomListener(window, 'load', initialize); 
```

然后是 div 正文中的这些人：

```
<input type="checkbox" checked="checked" name="store"
            id="trail" value="trail">
        <label>trail</label>
        <input type="checkbox" checked="checked" name="store"
            id="Historic" value="Historic">
        <label>Historic</label>
        <input type="checkbox" checked="checked" name="store"
            id="Energy" value="Energy">
        <label>Energy</label>
        <input type="checkbox" checked="checked" name="store"
            id="Hunting/Fishing" value="Hunting/Fishing">
        <label>Hunting/Fishing</label> 
```

我的融合表是：[https ://www.google.com/fusiontables/DataSource?docid=1J8YjRYnWprhLdL0YMP6lxxb_encjkowSlqi1G3Y#rows:id=1](https://www.google.com/fusiontables/DataSource?docid=1J8YjRYnWprhLdL0YMP6lxxb_encjkowSlqi1G3Y#rows:id=1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T19:00:25.390

有一个错字：

```
    where = "'描述' IN (" + filter.join (',') + ')';
    //----------------^

```

您的代码中缺少**t 。**

# iphone - 发射了多少颗子弹？

> ID：14467768
> 
> 赞同：0
> 
> 时间：2013-01-22T20:51:33.950
> 
> 标签：iphone, ios, xcode, cocos2d-iphone, sprite

我非常沮丧，我知道这只是因为我不知道我在用 cocos2d 做什么。我正在关注关于 cocos2d 的 Ray Wenderlich 教程，我正在尝试将它们放在一起。轻按屏幕时，向轻按方向发射一颗子弹。我在用

```
- (void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint touchLocation = [self convertTouchToNodeSpace:touch];
    [self.officer shootToward:touchLocation];
    [self.officer shootNow];
}

- (void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint touchLocation = [self convertTouchToNodeSpace:touch];
    [self.officer shootToward:touchLocation];
    [self.officer shootNow];
} 
```

在我的军官类中调用这些方法

```
- (void)shootNow {
    // 1
    CGFloat angle = ccpToAngle(_shootVector);
    _gun.rotation = (-1 * CC_RADIANS_TO_DEGREES(angle)) + 90;

    // 2
    CGSize winSize = [[CCDirector sharedDirector] winSize];
    float mapMax = MAX(winSize.width, winSize.height);
    CGPoint actualVector = ccpMult(_shootVector, mapMax);

    // 3
    float POINTS_PER_SECOND = 300;
    float duration = mapMax / POINTS_PER_SECOND;

    // 5
    for(id item in self.children) {
    NSString *bulletName = [NSString stringWithFormat:@"bullet.png"];
    CCSprite * bullet = [CCSprite spriteWithSpriteFrameName:bulletName];
    //bullet.tag = _type;
    bullet.position = ccpAdd(self.position, ccpMult(_shootVector, _gun.contentSize.height));
    CCMoveBy * move = [CCMoveBy actionWithDuration:duration position:actualVector];
    CCCallBlockN * call = [CCCallBlockN actionWithBlock:^(CCNode *node) {
        [node removeFromParentAndCleanup:YES];
    }];
    [bullet runAction:[CCSequence actions:move, call, nil]];
    [self.batchNode addChild:bullet];

        //[self addChild:bullet];
        [_shotsFired addObject:bullet];
    }
} 
```

所以我认为这将是一个简单的 for 循环，经过第 5 步 x 次，然后调用重新加载方法。好吧，那没有用。所以我试着计算屏幕上的触摸，我想如果我有 x 次点击然后调用 reload 方法（还没有写）？问题是每次您按下屏幕的不同区域时，计数都会从 1 开始。有些人请帮助我完成这周的拔头发过程？我如何计算我开枪的次数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:57:42.443

难道你不能在你的视图控制器上创建一个属性，然后每次调用立即拍摄方法时只需将 1 添加到你的属性，然后在调用 reload 方法时将其重置为 0？

# visual-studio - 为什么我需要在 Azure 中显式启用数据迁移？

> ID：14467769
> 
> 赞同：0
> 
> 时间：2013-01-22T20:51:36.287
> 
> 标签：visual-studio, azure, asp.net-mvc-4, azure-sql-database

我正在完成本教程：

[将 ASP.NET Web 应用程序部署到 Windows Azure 网站和 SQL 数据库](http://www.windowsazure.com/en-us/develop/net/tutorials/web-site-with-sql-database/)

在第二部分“Enable Migrations and create the database”中我需要使用 NuGet Package Manager 控制台输入一系列推荐：

1.  启用迁移 -ContextTypeName ToDoListApp.Models.ToDoDb
2.  添加迁移初始
3.  更新数据库

为什么我需要明确地这样做？这不应该包含在发布过程中吗？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:10:08.407

迁移过程独立于 Azure。您可以拥有一个使用数据库迁移但数据库未托管在 Azure 上的 MVC 4 项目。您引用的命令只是在任何 MVC 4 项目中启用迁移。

我发现更新数据库很危险，所以我实际上更喜欢将它与发布过程分开，因为这样您团队中的某个人就能够更新网站的逻辑，而无需将更新推送到数据库。

# php - 如何从 PHP 中的字符串中删除 'ï»¿'？

> ID：14467777
> 
> 赞同：0
> 
> 时间：2013-01-22T20:52:01.557
> 
> 标签：php

这个字符来自数据库。我有一个包含图像标签和文本的描述，但`ï»¿`出现在该描述的开头。

# swing - 如何在 griffon 中使用我自己的 swing 类的子类

> ID：14467789
> 
> 赞同：1
> 
> 时间：2013-01-22T20:52:51.057
> 
> 标签：swing, groovy, jtable, griffon

我需要使用我自己的 JTable 子类，但不确定如何在视图中使用它，无论如何都找不到它。

我必须在这里使用什么来代替表格：

```
scrollPane (constraints: "growx, growy, gapy 0:0:0, gapx 0:0:0") {
                table(id: 'thesublcass') {
                    tableFormat = defaultTableFormat(columns: model.columns)
                    ...
                }
} 
```

编辑：这工作得很好，谢谢。

> 表（新 YourClass（））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:27:58.590

您应该能够`widget`按照本页底部所示的方式使用：

[http://groovy.codehaus.org/SwingBuilder+with+custom+widgets+and+observer+pattern](http://groovy.codehaus.org/SwingBuilder+with+custom+widgets+and+observer+pattern)

IE：

```
 widget( new YourClass(), id: 'thesublcass') {
                tableFormat = defaultTableFormat(columns: model.columns)
                ...
            } 
```

# php - 在运行 OS X 10.8 的 MAMP 上安装 gearman 时出现问题

> ID：14467791
> 
> 赞同：0
> 
> 时间：2013-01-22T20:53:01.520
> 
> 标签：php, macos, terminal, mamp, gearman

正如标题所述，我在 MAMP 环境中为 PHP 安装 gearman 时遇到了一些问题。这是我到目前为止所做的：

我已经下载了最新的 PECL 版本并根据[文档](http://www.gearman.org/getting_started)运行这些命令：

```
tar xzf gearman-X.Y.tgz
cd gearman-X.Y
phpize
./configure
make
make install 
```

我到达`phpize`步骤并收到错误`configure: error: Please install libgearman`

我对 Mac 产品、终端/命令行执行等非常陌生。有人可以帮我解决这个问题吗？谷歌搜索时，我真的找不到任何关于这个问题的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:05:49.457

即使您没有在该机器上运行 gearman，您也需要编译 gearman 守护程序。这将提供您将用于 pecl gearman 扩展的 libgearman。

你可以在这里得到齿轮：[https ://launchpad.net/gearmand/](https://launchpad.net/gearmand/)

# css - CSS 嵌套 UL 菜单，4 级

> ID：14467793
> 
> 赞同：0
> 
> 时间：2013-01-22T20:53:06.873
> 
> 标签：css

我正在重新设计我们的管理菜单（它目前是垂直的并且很长/令人困惑），所以我想做一个浓缩的水平菜单。我已经摆弄这个一个星期了，我正要扯掉我的头发。

这是您可以看到的版本：

[带有 3 个子菜单的水平菜单](https://www.fromnaturewithlove.com/menuitems.asp)

我的 CSS 可以在这里查看：

[CSS 文件](https://www.fromnaturewithlove.com/menu.css)

只是一些怪癖，我不知道如何解决它们。我将在这里分别列出：

1级（主要按钮）很好

2级（蒂娜）看起来不错

第 3 级（蒂娜/库存），第 3 级选项在第 2 级选项之后。我如何让那些在 2 级的东西前面？理想情况下，我希望 3 级具有 #E4F683 的背景颜色和 #F6ED83 的悬停颜色（用于 Adjust On Hand、Component Report、Manage OOS）

第 4 级（客户/订单/Handpost），当您将鼠标悬停在第 2 级上时会显示第 4 级的内容……此时应该显示第 3 级，但在悬停之前应该隐藏第 4 级；与上述相同的问题是第 4 级落后于第 3 级。理想情况下，我想要#E0F574 的背景颜色和#AEC245 的悬停颜色（交易、运输、信用）

如果 3/4 级不超过 2 级，我真的不介意，但只是与他们排队 - 这将解决“后面/前面”问题，但我似乎无法弄清楚如何更改为让它这样工作

我还希望 2/3/4 级不要太高（我需要添加更多条目），但我似乎无法弄清楚如何更改我的 css 来解决这个问题

如果有人可以帮助我重新编写我的 CSS 以按照我真正想要的方式工作，我会......好吧，我不知道，给你一些 cookie 或其他东西！我看了又看这个CSS，直到我睁大眼睛！

我试图发布图像以使其更清晰，但系统不允许我这样做。

马哈洛！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:37:41.900

我创建了这个小提琴，删除了所有表格。

HTML：

```
<ul id="tinamenu">
<li><span class="mainmenu">Tina</span>

    <ul>
        <li><a href="#">Admin</a>

            <ul>
                <li><a href="/Other/importcal.asp">Calendar Import</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Inventory</a>

            <ul>
                <li><a href="/Inventory/InventoryAdj.asp">Adjust On Hand</a>

                </li>
                <li><a href="/Inventory/InventoryItems.asp">Component Report</a>

                </li>
                <li><a href="/warehouse/backorder.asp">Manage OOS</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Marketing</a>

            <ul>
                <li><a href="Javascript:OnClick=openWin('/email/CountIncomplete.asp','450','250','lefttosend')">Count Incomplete</a>

                </li>
                <li><a href="/Email/email-Reset-promo.asp">Send Promo Email</a>

                </li>
                <li><a href="/Email/email-CheckOne.asp">Validate Emails</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Miscellaneous</a>

            <ul>
                <li><a href="http://www.google.com/calendar/">FNWL Calendar</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Orders</a>

            <ul>
                <li><a href="/">All Un-Processed</a>

                </li>
                <li><a href="/Orders/hand-post.asp">Hand Post Transaction</a>

                </li>
                <li><a href="/orders/vieworder.asp?orderid=15516913">View Test Order</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Personnel</a>

            <ul>
                <li><a href="/Reports/timecard.asp">Timecard Activity</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Products</a>

            <ul>
                <li><a href="/Other/ManageCat.asp">Categories</a>

                </li>
                <li><a href="/products/list-fodata.asp">FO Data</a>

                </li>
                <li><a href="/products/statusreport.asp">New Product Checklist</a>

                </li>
                <li><a href="/Other/ManagePriceTable.asp">Price Table</a>

                </li>
                <li><a href="/Products/confprices.asp">Sizes/Weights/Prices</a>

                </li>
                <li><a href="/SpecialsNew/">Specials</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Reports</a>

            <ul>
                <li><a href="/Reports/CartCount.asp">Carts</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Web Site</a>

            <ul>
                <li><a href="/Other/ManagePageText.asp">Page Text</a>

                </li>
            </ul>
        </li>
        <li><a href="/personalize.asp">Personalize Menu</a>

        </li>
    </ul>
</li>
<li><span class="mainmenu">Customers</span>

    <ul>
        <li><a href="#">Orders</a>

            <ul>
                <li><a href="/">All Un-Processed</a>

                </li>
                <li><a href="#">Hand Post</a>

                    <ul>
                        <li><a href="/Orders/hand-post.asp">Transaction</a>

                        </li>
                        <li><a href="/Orders/hand-post-ship.asp">Shipping</a>

                        </li>
                        <li><a href="/Orders/hand-post-credit.asp">Credit</a>

                        </li>
                    </ul>
                </li>
                <li><a href="/menu.asp?ToPrint=0">Processed/Not Printed</a>

                </li>
                <li><a href="/menu.asp?MailPay=0">Awaiting Mail Payment</a>

                </li>
                <li><a href="/menu.asp?PayPalPay=0">Awaiting PayPal</a>

                </li>
                <li><a href="/menu.asp?OnAccount=0">On Account</a>

                </li>
                <li><a href="/warehouse/process-credit.asp?function=1">Process Credit</a>

                </li>
                <li><a href="/Orders/searchorder.asp">Search</a>

                </li>
                <li><a href="/Orders/searchnotes.asp">Search Order Notes</a>

                </li>
                <li><a href="/Orders/del-report1.asp">Cancelled Orders</a>

                </li>
                <li><a href="/Orders/vieworderhist.asp">Archived Orders</a>

                </li>
                <li><a href="/warehouse/returns-view.asp?type=0">Returns</a>

                </li>
                <li><a href="/DamageClaims/">Damage Claims</a>

                </li>
                <li><a href="/Orders/rmalist.asp">Outstanding RMAs</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Customers</a>

            <ul>
                <li><a href="/emailcustomer.asp">Email Customer</a>

                </li>
                <li><a href="/Orders/viewunfinished.asp">Save Cart</a>

                </li>
                <li><a href="/Orders/custlist.asp">Database</a>

                </li>
                <li><a href="/Orders/searchcustomer.asp">Search</a>

                </li>
                <li><a href="/searchemail.asp">Search Emails</a>

                </li>
                <li><a href="/Orders/ct_input.asp">Add</a>

                </li>
                <li><a href="/Reports/billing.asp">Monthly Billing</a>

                </li>
                <li><a href="Javascript:OnClick=openWin('https://www.naturalsourcing.com/admin/email/SetNoHtml.asp','450','250','NoHTML')">Set Non-HTML Status</a>

                </li>
                <li><a href="/Orders/combine-cust.asp">Combine Customer #s</a>

                </li>
                <li><a href="/chargeback/default.asp">Chargebacks</a>

                </li>
                <li><a href="/CallTags/CallTaglist.asp">Prepaid Returns</a>

                </li>
            </ul>
        </li>
    </ul>
</li>
<li><span class="mainmenu">Products</span>

    <ul>
        <li><a href="#">New</a>

            <ul>
                <li><a href="/ProductQual/">Qualify Products</a>

                </li>
                <li><a href="/Products/add-product.asp">Ingredient</a>

                </li>
                <li><a href="/Products/add-product.asp?non=1">Non-Ingredient</a>

                </li>
                <li><a href="/Products/add-fo.asp">Price Table</a>

                </li>
                <li><a href="/noncatalog/add-product.asp">Non-Catalog</a>

                </li>
                <li><a href="/Hidden/add-product.asp">Hidden</a>

                </li>
                <li><a href="/products/statusreport.asp">New Product Checklist</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Edit</a>

            <ul>
                <li><a href="/products/edit-product.asp">Product</a>

                </li>
                <li><a href="/Hidden/edit-product.asp">Hidden</a>

                </li>
                <li><a href="/noncatalog/edit-product.asp">Non-Catalog</a>

                </li>
                <li><a href="/Products/confprices.asp">Sizes/Weights/Prices</a>

                </li>
                <li><a href="/products/list-fodata.asp">FO Data</a>

                </li>
                <li><a href="/products/CheckPthalate.asp">Pthalate/Vanillin</a>

                </li>
                <li><a href="/Products/HideProd.asp">Hide</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Delete</a>

            <ul>
                <li><a href="/Products/DeleteProd.asp">Catalog</a>

                </li>
                <li><a href="/Hidden/delete-product.asp">Hidden</a>

                </li>
                <li><a href="/noncatalog/delete-product.asp">Non-Catalog</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Price Table</a>

            <ul>
                <li><a href="/Other/ManagePriceTable.asp">Manage</a>

                </li>
                <li><a href="/Products/Edit-Product-Pricetable.asp?menu=1">Edit</a>

                </li>
                <li><a href="/Products/CheckCFO-FOData.asp">FO/CFO Check</a>

                </li>
                <li><a href="/Products/fo-cfopricecheck.asp">FO/CFO Catalog Price Check</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Organic</a>

            <ul>
                <li><a href="/OrganicProducts/">Products</a>

                </li>
                <li><a href="/products/edit-product-organic.asp">Edit</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Inventory</a>

            <ul>
                <li><a href="/warehouse/viewback.asp">View OOS w/Sizes</a>

                </li>
                <li><a href="/warehouse/viewbacksummary.asp">View OOS Products</a>

                </li>
                <li><a href="/warehouse/backorder.asp">Manage OOS</a>

                </li>
                <li><a href="/warehouse/viewbackorderlog.asp">OOS Log</a>

                </li>
                <li><a href="/Inventory/InventoryAdj.asp">Adjust On Hand</a>

                </li>
                <li><a href="">Component Report</a>

                </li>
                <li><a href="/Inventory/InventorybyVendor.asp">By Vendor</a>

                </li>
                <li><a href="/Inventory/InventorybyVendor-reclog.asp">Vendor Receive Log</a>

                </li>
                <li><a href="/Inventory/InventorybyCategory.asp">By Category</a>

                </li>
            </ul>
        </li>
        <li><a href="#">Miscellaneous</a>

            <ul>
                <li><a href="/Products/addsearch.asp">Search Criteria</a>

                </li>
                <li><a href="/Products/Edit-MSDS.asp">Edit MSDS/Spec Sheet</a>

                </li>
                <li><a href="/PRODUCTS/listmsds.asp">List MSDS/Spec Files</a>

                </li>
                <li><a href="/Sapon/default.asp">Saponification Values</a>

                </li>
                <li><a href="/Products/noimage.asp">Missing Images</a>

                </li>
                <li><a href="Javascript:OnClick=openWin('/imagezip.asp','450','110','imagezip')">Upload Image</a>

                </li>
            </ul>
        </li>
        <li><a href="/SpecialsNew/">Specials</a>

        </li>
        <li><a href="/Other/ManageCat.asp">Categories</a>

        </li>
        <li><a href="/warehouse/ClearanceItemProcess.asp">Clearance</a>

        </li>
        <li><a href="/warehouse/ExtraProductsList.asp">Extra Products</a>

        </li>
        <li><a href="/Products/ProductsOnOrder.asp">On Order</a>

        </li>
    </ul>
</li>
<li><span class="mainmenu">Warehouse</span>

    <ul>
        <li><a href="/reports/shiplog_in.asp">Orders Shipped</a>

        </li>
        <li><a href="/warehouse/process-ship.asp?function=1">Shipping Charges</a>

        </li>
        <li><a href="/warehouse/Receiving.asp">Manage Receiving</a>

        </li>
        <li><a href="/ProdNeeded/default.asp">Products Needed</a>

        </li>
        <li><a href="/Samples/default.asp">Samples Received</a>

        </li>
    </ul>
</li>
<li><span class="mainmenu">Marketing</span>

    <ul>
        <li><a href="#">Promotional Emails</a>

            <ul>
                <li><a href="/Email/email-CheckOne.asp">Validate Emails</a>

                </li>
                <li><a href="/Email/email-Reset-promo.asp">Send Promo Email</a>

                </li>
                <li><a href="Javascript:OnClick=openWin('/email/CountIncomplete.asp','450','250','lefttosend')">Count Incomplete</a>

                </li>
                <li><a href="/email/SearchPromo.asp">Search Mailing List</a>

                </li>
            </ul>
        </li>
    </ul>
</li>
<li><span class="mainmenu">Web Site</span>

    <ul>
        <li><a href="/Other/ManagePageText.asp">Page Text</a>

        </li>
    </ul>
</li>
<li><span class="mainmenu">Reports</span>

    <ul>
        <li><a href="#">Orders</a>

            <ul>
                <li><a href="/Reports/CartCount.asp">Carts</a>

                </li>
            </ul>
        </li>
    </ul>
</li>
<li><span class="mainmenu">Miscellaneous</span>

    <ul>
        <li><a href="http://www.google.com/calendar/" target="_blank">FNWL Calendar</a>

            <ul>
                <li><a href="http://www.google.com/calendar/" target="_blank">Test Calendar</a>
                </li>
            </ul>
        </li>
    </ul>
</li> 
```

CSS和HTML：

[http://jsfiddle.net/andyjh07/cKnKL/](http://jsfiddle.net/andyjh07/cKnKL/)

请到最后的 misc 菜单查看它的实际效果（由于 jsFiddle 的屏幕小）

请随意对似乎有效的 HTML 和 CSS 代码进行删减 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:11:49.523

您可能希望使用相对和绝对定位来移动您的子项目并启用 z-index 以使它们彼此顶部/下方。

这是我使用的大型菜单的示例；看看他们如何显示子项目。它没有多个子项，但概念是相同的。您甚至可能希望使用它来将所有子项放在一起，而不是使用子项：

[http://nettuts.s3.amazonaws.com/819_megamenu/demo/index.html](http://nettuts.s3.amazonaws.com/819_megamenu/demo/index.html)

# java - 使用 Opengl 的第三人称透视相机

> ID：14467796
> 
> 赞同：-1
> 
> 时间：2013-01-22T20:53:17.927
> 
> 标签：java, opengl, camera

我想为我的项目实现一个 TPP 相机，但有些东西不起作用 + 我不知道我是否使用了正确的概念。

我应该旋转除我的主模型之外的整个场景模型视图矩阵，它将在屏幕上居中还是旋转lookAt相机？

另一件事是如何使模型在旋转后沿给定方向移动？（我认为移动整个场景会更容易？） + 如何添加碰撞检测？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T23:18:34.567

碰撞检测与openGL无关，您可以使用游戏状态变量来解决问题，您可以在与您进行用户输入和显示的游戏相同的循环中对其进行管理。

您应该为第三人称相机使用 LookAtMatrix，您将在玩家后面和前面某处有眼睛组件。透视可以通过使用[透视矩阵](http://www.arcsynthesis.org/gltut/Positioning/Tut04%20The%20Matrix%20Has%20You.html)来实现。

所以矩阵乘法看起来像。

透视矩阵 * LookAtMatrix * worldSpacePosition

这是 gamedev 的一个很好的答案，解释了一个[lookatmatrix](https://gamedev.stackexchange.com/a/8845)，大多数 OpenGL / 计算机图形学书籍也将涵盖这一点。

您使用的是新的还是旧的管道模型？

# jquery - 单选按钮上的 jQuery 验证

> ID：14467798
> 
> 赞同：1
> 
> 时间：2013-01-22T20:53:22.387
> 
> 标签：jquery, jquery-validate

我的表单中有两个单选按钮用于性别选择。

我正在使用[这个](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)插件进行验证。当我对单选按钮应用验证时，此插件会在两个单选按钮之间放置错误标签。

这是小提琴：http: [//jsfiddle.net/wyFQp/1/](http://jsfiddle.net/wyFQp/1/)

HTML：

```
<head>
    <body>
        <form id='registration_form'>
            <input type="radio" value="M" name="gender" class="gender" id="genderm"
            />Male
            <input type="radio" value="F" name="gender" class="gender ml_10" id="genderf"
             />Female
            <input type='submit' />
        </form>
    </body> 
```

如何在两个单选按钮之后放置错误标签？或者至少在一些体面的地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T20:59:40.923

在您希望显示错误的标记中添加错误标签：

```
<label class="error" generated="true" for="gender" style="display:none;"></label> 
```

[**小提琴**](http://jsfiddle.net/wyFQp/13/)

将其与无线电输入相关联时，错误标签的`for`属性对应于无线电' `name`- 这有助于实现相同名称的无线电一次仅选择一个无线电并且与该组关联的一个错误标签。
但是，对于文本输入（和`select`/ `textarea`/ `type="checkbox"`），`id`必须使用 。

* * *

另一种不那么骇人听闻的方法是使用[`errorPlacement`](http://docs.jquery.com/Plugins/Validation/validate#options)带有错误容器的选项，例如：

```
<div id="genderErrorContainer"></div> 
```

```
$("#registration_form").validate({
    rules: {[...]},
    messages: {[...]},
    submitHandler: fn,
    errorPlacement: function(error, element) {
        if (element.prop('name') === 'gender') {
            error.appendTo('#genderErrorContainer');
        }
    }
}); 
```

[**更新的小提琴**](http://jsfiddle.net/wyFQp/15/)

当然，您也可以使用其他 DOM 操作方法将错误元素添加到 DOM，例如`.append`, `.prepend`, `.after`, `insertAfter`，结合基于验证错误的 DOM 遍历，这可能不需要额外的标记，具体取决于您的`.before`HTML结构体。`.insertBefore``element`

# winforms - 在 Winform 和 WebAPI 中处理 AntiForgery 令牌

> ID：14467804
> 
> 赞同：3
> 
> 时间：2013-01-22T20:53:42.310
> 
> 标签：winforms, asp.net-web-api, antiforgerytoken

`ValidateAntiForgeryTokenAttribute`从非浏览器客户端调用时，在具有属性的方法上处理 Antiforgery 的最佳方法是什么`WinForm`？

据我所知，以下是防伪的工作原理：

1.  隐藏的输入字段被添加到页面，例如

2.  一个同名的cookie也被发送到客户端

3.  在下一个请求中，cookie 和隐藏的输入字段都被发送到服务器。服务器调用`AntiForgery.Validate(token, cookie)`以确认请求是合法的。

在网络应用程序中一切正常。它似乎在 WinForm 中不起作用。这是我所做的：

1.  使用`HttpClient`，我可以访问包含令牌的页面。
2.  我解析页面并抓取隐藏的输入字段。我也拿起饼干。
3.  我按原样传递cookie。最重要的是，我添加了一个`__RequestVerificationToken`带有隐藏字段值的新标题。
4.  我进入服务器代码。
5.  `AntiForgery.Validate(xx,yy)`失败并出现错误： 提供的**防伪令牌用于用户 X，但当前用户是 Y。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:51:58.793

我想到了。它需要事先完成表单身份验证，并在随后的 WebAPI 调用中传递 cookie。所以这是修改后的流程：

1) 使用 HttpWebRequest (GET) 加载登录表单

2) 使用凭据在登录表单上进行 POST。在 HttpWebRequest 中提供一个**cookiecontainer**

3) cookiecontainer 现在包含 Auth cookies 和 **__RequestVerificationToken**

4) 从任何后续 GET 甚至从登录结果的输出中获取 __RequestVerificationToken

5) 对于 WebAPI Post 调用，按原样传递 cookiecontainer。还包括一个**标头**__RequestVerificationToken ，其中包含上一步中的值。

# hash - 加密哈希算法可以用作 PRNG 吗？

> ID：14467805
> 
> 赞同：5
> 
> 时间：2013-01-22T20:53:43.223
> 
> 标签：hash, random, prng

MD5/SHA256/SHA512等可以作为PRNG吗？例如，给定一个整数种子，是伪代码：

```
random_number = truncate_to_desired_range(
    sha512( seed.toString() + ',' + i.toString() ) 
```

......一个体面的PRNG？(`i`是一个递增的整数，例如，输出是：

```
convert(sha512("<seed>,0"))
convert(sha512("<seed>,1"))
convert(sha512("<seed>,2"))
convert(sha512("<seed>,3"))
… 
```

在这个问题的上下文中，“体面”仅指输出的分布：当以这种方式使用时，密码散列函数的输出是否均匀？（虽然我认为这取决于散列函数，但所有加密散列也应该有统一的输出，对吧？）

**注意：**我承认这将是一个缓慢的 PRNG，与 Mersenne-Twister 相比，由于使用了加密哈希。我对速度不感兴趣，我对结果是否安全也不感兴趣——只是分布是正确的。

在我的特定用例中，我正在寻找类似于[XKCD 的 geohashing 的东西](http://xkcd.com/426/)，因为它很容易由分布式各方实现，他们都会得到相同的答案。Mersenne-Twister 可以被替代，但它在许多目标语言中不太可用。（有些语言完全没有它，有些语言无法访问它的原始 U32 输出，等等。SHA512 要么是内置的，要么很容易获得。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:06:36.143

假设加密散列函数满足其设计目标，输出将（可证明）在其周期内遵循均匀分布，因为散列函数的每个输入在设计上都是唯一的。

散列函数的目标之一是近似随机预言，也就是说，对于任何两个不同的输入 A 和 B，输出 H(A) 和 H(B) 应该（对于真正的随机预言）是不相关的。散列函数非常接近这一点，但随着时间和密码分析，弱点当然会逐渐消失。

也就是说，就质量而言，加密原语本质上是我们可用的最好的数学算法，因此可以肯定地说，如果它们不能解决您的问题，*那就什么也做不*了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:10:39.227

它可以工作（如其他答案/评论中提到的那样，具有良好大小的输入、填充等）并且会提供相当好的结果，但它会很*慢*，所以如果你正在做模拟，请不要这样做或需要大量使用 PRNG 的东西......

# android - Android SQLite 通过 utf8 整理/排序

> ID：14467806
> 
> 赞同：3
> 
> 时间：2013-01-22T20:53:44.100
> 
> 标签：android, sqlite

我在 Android 上的 SQLite 表中有以下项目（表选项卡有 1 列 - '名称' 文本）

```
Beta
Work
Úpal
User 
```

如果我在 SQL Server 中有这些项目以及斯洛伐克语的排序规则`select * from tab order by name`，它会正确输出排序为的项目：

```
Beta
User
Úpal
Work 
```

在斯洛伐克语中，带有重音符号的 U - Ú 应排在 U 之后。

在 Android 上的 SQLite 中，它按以下顺序输出它们：

```
Beta
User
Work
Úpal 
```

我了解发生了什么，SQLite 可能正在使用字符代码比较字符，而 Ú 在 W 之后。

我该怎么做才能让它按我的方式排序？甚至可能吗？ [COLLATION 上的 SQLite 文档](http://www.sqlite.org/datatype3.html#collation)指出，基本上所有排序规则都是二进制比较的变体，并且使用 memcmp() 比较字符串数据，而不管文本编码如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:58:37.437

SQLite 的 C API 允许安装[新的排序规则](http://www.sqlite.org/c3ref/create_collation.html)。Android API 没有公开这些函数，但至少它安装了两个额外的排序规则：

> 除了 SQLite 的默认排序器之外`BINARY`，Android 还提供了两个`LOCALIZED`，它们随系统的当前语言环境而变化，以及`UNICODE`Unicode 排序算法，不针对当前语言环境量身定制。

# html - 无循环运行 flv 文件

> ID：14467807
> 
> 赞同：0
> 
> 时间：2013-01-22T20:53:44.543
> 
> 标签：html, flv, flash-video

我是运行**.flv**文件的新手。我为此使用了一个教程。教程链接[http://www.fieg.nl/embed-html5-video-with-flash-fallback#file-index.html](http://www.fieg.nl/embed-html5-video-with-flash-fallback#file-index.html)

在这里，*视频*文件不时重复。我认为这是一个循环。打开窗口时视频文件如何运行一次。运行*flv*文件的代码如下。

```
<script type="text/javascript">
            jQuery(document).ready(function() {
                 var v = document.createElement("video"); // Check if the browser supports the video tag
                 if ( !v.play ) { // If no, use Flash.
                        var params = {
                             allowfullscreen: "false",
                             allowscriptaccess: "always",
                             wmode: "transparent"
                        };

                        var flashvars = {
                             src: "demo.flv"
                        };

                        swfobject.embedSWF("http://localhost/TantraProjects/Ranjit/html5/demo_flv.SWF", "demo-video-flash", "270", "296", "9.0.0", "http://localhost/TantraProjects/Ranjit/html5/expressInstall.swf", flashvars, params);
                 }
                 else {
                        // fix for firefox not looping
                        var myVideo = document.getElementById('demo-video');

                        if ((typeof myVideo.loop == 'boolean')) { // loop supported
                             myVideo.addEventListener('ended', function () {
                                  this.currentTime = 0;
                                  this.play();
                             }, false);
                        }
                 }
            });
</script> 
```

请帮助我了解更多。

嗨，我对视频也有同样的看法。视频中有一个循环，我不想循环播放视频。我的 html 代码。

```
<div id="demo-video-flash"><!-- wrapped in a div for the flash fallback -->
   <video id="demo-video" height="155" width="270" autoplay loop>
      <source src="http://localhost/TantraProjects/Ranjit/html5/demo.mp4" type="video/mp4" /> <!-- MPEG4 for Safari -->
      <source src="http://localhost/TantraProjects/Ranjit/html5/demo.ogv" type="video/ogg" /> <!-- Ogg Theora for Firefox 3.1b2 -->

      <!-- this is the image fallback in case flash is not support either -->
      <img src="http://localhost/TantraProjects/Ranjit/html5/demoo.png"/>
   </video>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:00:20.650

看起来您正在使用 JW Player，对吗？然后你应该添加`repeat: none`到 flashvars，让它看起来像这样。

```
var flashvars = {
      src: "demo.flv",
      repeat: "none"
}; 
```

有关“flashvars”参数的更多详细信息请[点击此处。](http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12536/configuration-options/)

# javascript - 在 javascript 中使用 Thymeleaf 显示消息

> ID：14467808
> 
> 赞同：2
> 
> 时间：2013-01-22T20:53:54.810
> 
> 标签：javascript, spring-mvc, thymeleaf

我正在使用 thymeleaf 和 spring 3 mvc。当我尝试执行 Ajax POST 请求时，我不明白如何在我的 html 页面上显示来自控制器的响应消息：

这是一个代码片段：

```
$.ajax({
    type: "POST",
    url: "/settings",
    data: "request=" + request,
    success: function (response) {
        $('#msg').replaceWith('<div id="msg" th:text="response"></div>');
    },
}); 
```

“响应”是来自控制器的 i18n 消息。现在，我想在使用 thymeleaf (th:text="response") 时显示此消息。当然，这段代码不起作用，因为它认为响应变量是一个纯字符串。

问题是如何使用 thymeleaf 显示 i18n 响应消息。或者也许还有其他方法可以通过 js 在 html 页面（不使用 jsp）上显示 i18n 消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T15:05:32.133

Thymeleaf 属性（例如 th:text）只会在服务器上解析和替换。由于这个 ajax 响应是在浏览器上处理的，th:text 不会被处理。如果“设置”已经是 Thymeleaf 解析的页面，它可能已经 i18n'd 并且您可以简单地执行以下操作：

```
$('#msg').html(response); 
```

但是，如果您真的在寻找 Thymeleaf 标签的客户端 javascript 处理，请考虑[Thymol](http://sourceforge.net/u/jjbenson/wiki/thymol/)。

# bash - 通过命令行运行 /bin/bash 时如何将 $TERM 设置为一个值？

> ID：14467809
> 
> 赞同：5
> 
> 时间：2013-01-22T20:53:57.530
> 
> 标签：bash

当我`/bin/bash`使用 2 个参数运行该过程时`-c`，`SomeUserInput`

SomeUserInput 在哪里`echo $TERM`

输出是

`xterm-256color`

有没有办法可以通过**命令行参数`/bin/bash`**设置 $TERM 的值，以便上面的调用`echo $TERM`会打印我指定的其他内容？

（是的，我`man bash`在其他地方做了很多挖掘和搜索，但找不到答案；尽管我认为它可能在那里。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T21:01:08.437

首先，由于您使用了双引号，因此会在当前 shell 中打印 TERM 的值，而不是您调用的 bash。为此，请使用`/bin/bash -c 'echo $TERM'`.

要设置 TERM 的值，您可以`export TERM=linux`在运行该命令之前，仅使用`TERM=linux /bin/bash -c 'echo $TERM'`(shell 表达式) 或`/usr/bin/env TERM=linux /bin/bash -c 'echo $TERM'`(execve compatible (as for find -exec)) 为该 shell 设置它。

更新：至于您仅使用命令行参数的编辑`/bin/bash`，您可以在不修改输入的情况下执行此操作，如下所示：

```
/bin/bash -c 'TERM=something; eval "$1"' -- 'SomeUserInput' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T20:57:45.923

好吧，您可以在`.bashrc`文件上设置变量，也可以简单地使用 bash 调用进行设置：

```
/bin/bash -c "TERM=something-else; echo $TERM" 
```

# c++ - 动态生成对象的 glewInit() 错误？

> ID：14467810
> 
> 赞同：2
> 
> 时间：2013-01-22T20:53:59.123
> 
> 标签：c++, opengl, glew

我正在使用 freeglut 和 glew 制作 Connect4 游戏。这就是我的游戏的外观。圆圈（白色/红色/蓝色）是在每次调用 display() 函数时呈现的唯一对象。

```
Circle * ChessPiece = new Circle(0.08f); 
```

![在此处输入图像描述](../Images/3cde3741443f4cd6d4a34d149e1bf5f8.png)

一切都很好，除了如果我让应用程序静置约 2 分钟，它会崩溃并显示以下错误消息：

![在此处输入图像描述](../Images/ac70285303d8639529739c0f6c4abd1b.png)

我解决这个问题的方法是在 glGenVertexArrays() 正上方添加这两行

glewExperimental = GL_TRUE;

glewInit();

这行得通。但是，它会导致性能下降（因为 glewInit() 每次渲染一个圆圈时都会调用一次 display() 回调）。

我尝试将 glewExperimental 和 glewInit() 放在 display() 回调函数中，希望提高性能，但应用程序在运行 2 分钟后仍然崩溃。

另一种解决方法是在一开始就预渲染所有圆圈，然后随着游戏的进行更改颜色。这也有效。但是，我更喜欢在游戏过程中动态生成圆圈，而不是在游戏开始时。

所以，我的问题是：

这是一个 GLEW 错误吗？或者这是我的代码问题？我之所以认为它是一个 glew 错误是因为当我在 glGenVertexArrays() 之前添加 glewExperimental 和 glewInit() 时，游戏不再崩溃。唯一的缺点是对性能的巨大打击。

将 glewExperimental 和 glewInit() 放在 main() 函数或 display() 回调函数中也不起作用。该应用程序将在崩溃前的前 2 分钟编译并运行良好。

如果是 GLEW 错误，我该如何解决这个问题？（无需在游戏开始时预渲染圆圈）。

绘制圆圈的代码片段：

```
void Circle::draw(float x, float y, float z)
{
    //Codes to generate circle vertices 

    //These stop the app from crashing after 2 minutes, but I don't want to use them
    //glewExperimental = GL_TRUE;
    //glewInit();

    glGenVertexArrays(1, &vertexArray_Circle);
    glBindVertexArray(vertexArray_Circle);
    glGenBuffers(1, &vertexBuffer_Circle);

    glBindBuffer(GL_ARRAY_BUFFER, vertexBuffer_Circle);
    glBufferData(GL_ARRAY_BUFFER, (sizeof(Circle_vertices)/sizeof(float))*sizeof(GLfloat), Circle_vertices, GL_STATIC_DRAW);
    glVertexAttribPointer((GLuint)0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glEnableVertexAttribArray(0);

   //Draw circle
   glBindVertexArray(vertexArray_Circle);
   glVertexAttrib3f((GLuint)1, RED, GREEN, BLUE);
   glDrawArrays(GL_TRIANGLE_FAN, 0, index/3);

   glDisableVertexAttribArray(0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:02:08.707

很高兴看到实际代码，而不仅仅是它的屏幕截图，但看起来你每次绘制时都会生成一个新的顶点数组，并且在此之后它失败了......

我怀疑您实际上并没有删除那些顶点数组，并且给定足够长的时间，您的资源不足并且调用失败。如果不检查错误，您最终会崩溃。

实际上，除非必要，否则您不应该重新生成数组，如果是，请确保删除旧数组。

# ssl - 为什么 Heroku 上的自定义域 SSL 每月要花费 20 美元？

> ID：14467819
> 
> 赞同：10
> 
> 时间：2013-01-22T20:55:14.727
> 
> 标签：ssl, heroku

*请注意，这不是投诉。*我只是想知道 Heroku 提供自定义域 SSL 的成本是多少，如果有的话，因为他们不提供 SSL 证书。据我了解，免费提供 SSL 支持并为证书本身收费是很常见的。

供参考：[自定义域 SSL](https://devcenter.heroku.com/articles/ssl#customdomain-ssl)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-22T20:57:09.637

为了在共享服务器上使用您自己的 SSL 证书，您的站点必须在其自己的专用公共 IP 地址上运行。
（因为服务器需要在浏览器告诉它正在连接哪个主机之前发送 SSL 证书）

IP 地址是一种稀缺商品。

# php - Wkhtmltopdf 不显示 TrueType 字体

> ID：14467820
> 
> 赞同：6
> 
> 时间：2013-01-22T20:55:17.030
> 
> 标签：php, fonts, wkhtmltopdf

我们正在使用 wkhtmltopdf 从 HTML 页面呈现 PDF，但是 Verdana 和 Georgia 等字体无法正确显示。[我们使用这些](http://corefonts.sourceforge.net/)说明在我们的服务器上安装了 TrueType 字体。使用样式标签内联设置字体： style="font-family: verdana, geneva;"

任何关于我们接下来可以尝试什么来显示这些字体的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-06T21:15:37.917

试试 Arman H. 在这个问题上发布的解决方案：[Google Web Fonts and PDF generation from HTML with wkhtmltopdf](https://stackoverflow.com/questions/6721295/google-web-fonts-and-pdf-generation-from-html-with-wkhtmltopdf)

Base64 将字体编码到你的 CSS 中对我们来说就像是一种魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:21:11.330

您是否正确设置了css中的字体？

例如

```
@font-face {
 font-family: 'Verdana';
 src: url('verdana-webfont.eot');
 src: url('verdana-webfont.eot?#iefix') format('embedded-opentype'),
 url('verdana-webfont.woff') format('woff'),
 url('verdana-webfont.ttf') format('truetype'),
 url('verdana-webfont.svg#Verdana') format('svg');
 font-weight: normal;
 font-style: normal;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-04T10:28:21.543

我不确定这是否适用于这个问题，但我通过安装 true type 字体解决了我的问题。之后 wkhtmltopdf 能够显示这些字体。

Ubuntu (18.04)

```
apt install fonts-droid-fallback ttf-dejavu fonts-freefont-ttf fonts-liberation ttf-ubuntu-font-family 
```

高山 Linux (3.9)

```
apk add ttf-dejavu ttf-droid ttf-freefont ttf-liberation ttf-ubuntu-font-family 
```

# jquery - 将图像缩放到浏览器大小...然后滚动到下一个图像

> ID：14467823
> 
> 赞同：0
> 
> 时间：2013-01-22T20:55:41.620
> 
> 标签：jquery, image, responsive-design

这里有点长镜头，但希望有人能够帮助我解决这个问题。

我正在寻找将图像缩放到浏览器大小（移动设备），我可以实现这一点，但我想知道如果你向下滚动是否有可能，它会将你拉到下一个图像，如果有意义的话，它也会被缩放以适应浏览器的大小？（道歉）。

我目前使用 backstretch 插件实现缩放图像，如下所示：

```
$(document).ready(function(){
$("#test").backstretch("../images/background-v2.jpg");
}); 
```

将它们嵌套在 div 中，因为我希望它们大约是浏览器大小的 95%，以便在图像周围留下白色边框。
但由于我计划将该网站放入 wordpress 以制作内容可管理的网站，我不希望通过 jQuery 插入图像标签。

理想情况下是这样的：

```
<div id="project-images">
<img src="../images/image-01.jpg" width="" height="" />
<img src="../images/image-02.jpg" width="" height="" />
<img src="../images/image-03.jpg" width="" height="" />
<img src="../images/image-04.jpg" width="" height="" />
</div> 
```

缩放 image-01 以适应浏览器大小，然后在滚动时它会将您下拉到 image-02，然后它也将缩放到浏览器大小。
有点远射，但我完全不知道如何实现这一点，任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:52:29.253

这可能是一种方式，一定有很多

您将窗口高度设置为所有图像的高度，

但是您将图像设置为显示：无

然后制作一个插件

*   显示一张图片/隐藏另一张图片
*   将窗口滚动到该图像 ($(window).scrollTop(...))
*   重新定位回到顶部：0 所有图像

然后

使用插件显示第一张图片

然后

```
var lastScrollTop = 0;

//how much must the user scroll before next/prev image is shown :
var minscrolling = 50;

$(window).on({
       "scrollstart" : function(){
             lastScrollTop = $(this).scrollTop();

       },
       "scroll" : function (e) {
             var currentscrollpos= $(this).scrollTop();
             //reposition visible image so it seems it doesn't scroll
             // top : lastScrollTop -currentscrollpos
             // 
            if (lastScrollTop - currentscrollpos > minscrolling)  

                 // use  plugin to show next img
                 // set lastscrolltop to  currentscrollpos

            else if (lastScrollTop -  currentscrollpos < -minscrolling) 
                  //use plugin to show previous img
                   // set lastscrolltop to  currentscrollpos
       }

 }); 
```

# vb.net - 在访问/数据表查询中使用 ADO.Net

> ID：14467824
> 
> 赞同：1
> 
> 时间：2013-01-22T20:55:41.853
> 
> 标签：vb.net, ms-access, ado.net

我试图用 ADO.net 和访问来理解几个概念。我了解如何使用 ADO 查询表或设置记录，并且我查看了有关拉表和处理查询的各种在线文章。我想知道 VBA 表单、数据表和表之间的关系是什么。

我是否理解 UserForm 可以包含 DataSheet？那本质上是一张桌子但分开吗？从“表单视图”更改为“数据表视图”会显示表单中记录的信息。然而，按“TABLE”对导航视图进行排序将不会显示与记录到数据表中相同的信息。

ADO 如何从 DataSheet 对象（不一定是表）中访问信息？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:50:33.177

数据表是一种形式。您可以完全删除记录源，您仍然会有一个表单。在运行时设置表单的记录源属性并不少见。

Access 在许多情况下确实可以很好地工作。不要被坏消息推迟。改变的唯一原因是当前的设置不起作用——因为它已经变得太大了，因为公司已经变得太大了，等等。甚至这些案例中的一些也可以通过保持（工作）前沿来处理-end 并用更强大的东西替换后端（数据库）。在大多数情况下，Access 的问题不在于前端，而在于小型办公室大小的数据库，即 Jet/ACE。

# join - SSIS Merge Join 组件写了 0 行

> ID：14467825
> 
> 赞同：2
> 
> 时间：2013-01-22T20:55:45.970
> 
> 标签：join, ssis, merge, metadata

首先，感谢社区在网站上提供的大量信息，在 C# 和 SSIS 方面帮助了我很多。第二件事是我的英语不是很好，所以请耐心等待，如果您有不明白的地方，请问，我会努力使它变得更好。

我从不同的数据库中获得了 2 个 OLEDB 连接源，两个表都有一个带有 ID 的列，我将其用作连接键。在 RUT CRUZADOS 中，ID 是浮点数据类型，而在其他源（CTACTE AÑO PAS）中，我不知道它是哪种类型的数据（我无法使用 sql server 打开数据库，我只能执行 SELECT 操作）。

当我在合并中合并它们时，它不会返回任何错误，但是当我运行程序时，会发生这种情况。

[![](../Images/b1720cf20513de34708c5c9551e06310.png)](https://i.stack.imgur.com/hcShj.jpg)

> [SSIS.Pipeline] 信息：“组件“CARGOS ABONOS”(239)”写入 0 行。

在 Microsoft Access 中，“内部联接”返回 4 百万行。我认为问题在于元数据，但我不知道如何使用“数据转换”。有人能帮助我吗。

谢谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:17:06.520

您可以通过双击连接线来查看数据类型，至少就 SSIS 而言。在弹出的数据流路径编辑器中，元数据选项卡将描述列类型。

也就是说，这并不重要，因为 Merge Join 转换只允许您合并相同类型的数据。

[合并联接](http://msdn.microsoft.com/en-us/library/ms141775.aspx)需要对源系统数据进行排序。这可以通过将排序组件添加到流中来完成（不推荐，因为这是一种异步转换，会占用所有内存并降低性能），或者通过在源系统中显式排序，然后在“高级”选项卡中将它们标记为已排序。

由于我没有看到排序，这让我相信排序是在源系统中完成的。或者，排序*没有*在那里完成，但有人将输出标记为已排序。这些源查询中**必须**有明确`ORDER BY`的子句。有时，SQL Server 会以相同的顺序返回数据，但除非有 ORDER BY，否则*无法*保证。（我希望我可以使用 flash 标签来强调最后一点）。

未来的读者，如果您在两个系统中都有排序并且它们都在同一列上排序，那么您需要检查排序规则。不区分大小写是与区分大小写不同的野兽，基于 ASCII 的系统上的排序产生的排序不同于使用 EBCIDIC 处理混合字母数字的排序，就像我曾经拥有的那样......

由于源数据类型似乎是浮点数，因此排序可能不是罪魁祸首。我开始意识到，你可能有一个更丑陋和更阴险的比较问题，而不是排序问题。浮点数是近似值。1=1 但 1.00000000000(etc) 可能等于也可能不等于 1.0000000000(etc)1

你真的需要小数位来匹配吗？如果不是，则在两个系统中都转换为整数（并按 CAST 值排序）应该使这些匹配起作用。如果有重要的小数位，那么您将需要将其转换为精确的数字类型（并祈祷它们都以相同的方式转换）。Access 确实做到了这一事实让我相信整数数据类型将是你的救星。

# c# - 是否可以将方法作为委托传递？

> ID：14467831
> 
> 赞同：0
> 
> 时间：2013-01-22T20:56:11.040
> 
> 标签：c#, generics, methods, casting, delegates

这是我的场景：

```
Class Test  
{  
    public int TestMethod(string s)  
    {
        return s.length; 
    }  

    public void TestInvoker()  
    {    
        var result = Invoker.Call( (new Test()).TestMethod,"String");  
    }  
}

Class Invoker  
{  
    public static object Call(Delegate method, object input) {... Do stuff ...} 

} 
```

我怎样才能做到这一点？因为“TestMethod”不是一个委托，我可以用 Func<> 来做，但我想避免在每次使用调用程序时实例化一个 Func<> 委托。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T20:58:19.877

这是可能的，但前提是该方法接受具体的委托类型；不是`Delegate`自己。

如果您将方法更改为

```
public static TReturn Call<TInput, TReturn>(Func<TInput, TReturn> method, TInput input) 
```

，它会正常工作。

* * *

更准确地说，C# 具有从方法组到匹配委托类型的隐式转换。

# java - jTable 在程序中按两个按钮更新以检查 java gui 中的总工资

> ID：14467832
> 
> 赞同：0
> 
> 时间：2013-01-22T20:56:17.873
> 
> 标签：java, swing, user-interface, event-handling, jtable

这里在 Total Salary 列中的 JTable 中的输出在两次按键时更新，但我只希望在一次按键中更新它。它是在 Netbeans 中使用 swing 实现的。该程序旨在计算员工的总工资。我的总工资代码：

```
package learn;

import javax.swing.JOptionPane;

public class Taxtry extends javax.swing.JFrame {

    public Taxtry() {
        initComponents();
    }

    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jTextField2 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jTextField4 = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel1.setText("Name");

        jLabel2.setText("Emp Code");

        jTextField2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField2ActionPerformed(evt);
            }
        });

        jLabel3.setText("Financial year");

        jLabel4.setText("Department");

        jTextField3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField3ActionPerformed(evt);
            }
        });

        jTextField4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(52, 52, 52)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel4)
                    .addComponent(jLabel1))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jTextField1, javax.swing.GroupLayout.DEFAULT_SIZE, 52, Short.MAX_VALUE)
                    .addComponent(jTextField3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 397, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel2)
                    .addComponent(jLabel3))
                .addGap(91, 91, 91)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(62, 62, 62))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel1)
                    .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 92, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel4)
                        .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel3)))
                .addContainerGap())
        );

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"March 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"April 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"May 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"June 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"July 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"August 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"September 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"October 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"November 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"December 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"January 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"February 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                {"Total", "0", "0", "0", "0", "0", "0", "0", "0"}
            },
            new String [] {
                "Months", "Basic+GP", "DA", "TA", "HRA", "Arrear & Others", "Children Education Allowance", "Total Salary", "Employee contribution to NFS"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, true, true, true, true, true, true, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jTable1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTable1KeyPressed(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(45, 45, 45)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1163, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(70, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 57, Short.MAX_VALUE)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 235, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(107, 107, 107))
        );

        pack();
    }// </editor-fold>

    private void jTextField3ActionPerformed(java.awt.event.ActionEvent evt) {
        // TODO add your handling code here:
    }

    private void jTextField2ActionPerformed(java.awt.event.ActionEvent evt) {
        // TODO add your handling code here:
    }

    private void jTextField4ActionPerformed(java.awt.event.ActionEvent evt) {

    }

    private void jTable1KeyPressed(java.awt.event.KeyEvent evt) {
        // The values get updated on pressing the enter button
        int i;
        int j;
        String gf;
        Object z;
        float q;
        for (i=0;i<12;i++)
        {
            q=0;
            for( j=1;j<7;j++)
            {   String sw=(jTable1.getValueAt(i,j)).toString();

            try
{
  Float.parseFloat(sw);
}
catch(NumberFormatException e)
{

    JOptionPane.showMessageDialog(null,"Please enter a float number",null,
                                    JOptionPane.ERROR_MESSAGE);
     j=1;
    continue;

}
                //if(sw!=null) {
                    q=q+Float.parseFloat(sw);
                //}
        }
            gf=Float.toString(q);
            //z= gf;
            System.out.println(jTable1.getValueAt(i,7));
            jTable1.setValueAt(gf,i,7);
            //z=gf;
    }
      for (i=1;i<9;i++)
        {
            q=0;
            for( j=0;j<12;j++)
            {   String sw=(jTable1.getValueAt(j,i)).toString();

                if(sw!=null) {
                    q=q+Float.parseFloat(sw);
                }
        }
            gf=Float.toString(q);
            z= gf;

            jTable1.setValueAt(z,12,i);

    }

    }

    public static void main(String args[]) {

        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Taxtry.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Taxtry.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Taxtry.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Taxtry.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }

        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Taxtry().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    // End of variables declaration
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T23:44:40.157

你真的不应该以这种方式更新你的模型。模型负责确定应该显示的数据，视图用于确定模型的显示方式。

您应该允许模型自行更新并向视图提供反馈。

```
public class BadTable01 extends javax.swing.JFrame {

    public BadTable01() {
        initComponents();
        jTable1.setModel(new MyTableModel());
    }

    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTextField1 = new javax.swing.JTextField();
        jTextField2 = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jTextField3 = new javax.swing.JTextField();
        jTextField4 = new javax.swing.JTextField();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel1.setText("Name");

        jLabel2.setText("Emp Code");

        jLabel3.setText("Financial year");

        jLabel4.setText("Department");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(52, 52, 52)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jLabel4)
                .addComponent(jLabel1))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                .addComponent(jTextField1, javax.swing.GroupLayout.DEFAULT_SIZE, 52, Short.MAX_VALUE)
                .addComponent(jTextField3))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 397, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jLabel2)
                .addComponent(jLabel3))
                .addGap(91, 91, 91)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(62, 62, 62)));
        jPanel1Layout.setVerticalGroup(
                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel1)
                .addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jLabel2)
                .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 92, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel4)
                .addComponent(jTextField3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jTextField4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jLabel3)))
                .addContainerGap()));

        jScrollPane1.setViewportView(jTable1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                .addGap(45, 45, 45)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1163, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(70, Short.MAX_VALUE)));
        layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 57, Short.MAX_VALUE)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 235, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(107, 107, 107)));

        pack();
    }// </editor-fold>

//    private void jTable1KeyPressed(java.awt.event.KeyEvent evt) {
//        // The values get updated on pressing the enter button
//        int i;
//        int j;
//        String gf;
//        Object z;
//        float q;
//        for (i = 0; i < 12; i++) {
//            q = 0;
//            for (j = 1; j < 7; j++) {
//                String sw = (jTable1.getValueAt(i, j)).toString();
//
//                try {
//                    Float.parseFloat(sw);
//                } catch (NumberFormatException e) {
//
//                    JOptionPane.showMessageDialog(null, "Please enter a float number", null,
//                            JOptionPane.ERROR_MESSAGE);
//                    j = 1;
//                    continue;
//
//                }
//                //if(sw!=null) {
//                q = q + Float.parseFloat(sw);
//                //}
//            }
//            gf = Float.toString(q);
//            //z= gf;
//            System.out.println(jTable1.getValueAt(i, 7));
//            jTable1.setValueAt(gf, i, 7);
//            //z=gf;
//        }
//        for (i = 1; i < 9; i++) {
//            q = 0;
//            for (j = 0; j < 12; j++) {
//                String sw = (jTable1.getValueAt(j, i)).toString();
//
//                if (sw != null) {
//                    q = q + Float.parseFloat(sw);
//                }
//            }
//            gf = Float.toString(q);
//            z = gf;
//
//            jTable1.setValueAt(z, 12, i);
//
//        }
//
//    }
    public static void main(String args[]) {

        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (Exception ex) {
        }

        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new BadTable01().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextField jTextField1;
    private javax.swing.JTextField jTextField2;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField4;
    // End of variables declaration

    public class MyTableModel extends DefaultTableModel {

        public MyTableModel() {
            super(new Object[][]{
                        {"March 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"April 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"May 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"June 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"July 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"August 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"September 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"October 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"November 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"December 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"January 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"February 2012", "0", "0", "0", "0", "0", "0", "0", "0"},
                        {"Total", "0", "0", "0", "0", "0", "0", "0", "0"}
                    },
                    new String[]{
                        "Months", "Basic+GP", "DA", "TA", "HRA", "Arrear & Others", "Children Education Allowance", "Total Salary", "Employee contribution to NFS"
                    });

            for (int colIndex = 1; colIndex < getColumnCount(); colIndex++) {
                updateColumnTally(colIndex);
            }
        }
        Class[] types = new Class[]{
            String.class,
            String.class,
            String.class,
            String.class,
            String.class,
            String.class,
            String.class,
            String.class,
            String.class,};
        boolean[] canEdit = new boolean[]{
            false, true, true, true, true, true, true, true, true
        };

        public Class getColumnClass(int columnIndex) {
            return types[columnIndex];
        }

        public boolean isCellEditable(int rowIndex, int columnIndex) {
            return canEdit[columnIndex];
        }

        @Override
        public void setValueAt(Object aValue, int row, int column) {
            super.setValueAt(aValue, row, column);
            if (row != getRowCount() - 1) {
                updateColumnTally(column);
                fireTableCellUpdated(getRowCount() - 1, column);
            }
        }

        private void updateColumnTally(int colIndex) {
            double tally = 0;
            for (int rowIndex = 0; rowIndex < getRowCount(); rowIndex++) {
                String value = (String) getValueAt(rowIndex, colIndex);
                try {
                    double dValue = Double.parseDouble(value);
                    tally += dValue;
                } catch (NumberFormatException exp) {
                    exp.printStackTrace();
                }
            }
            setValueAt(NumberFormat.getNumberInstance().format(tally), getRowCount() - 1, colIndex);
        }
    }
} 
```

附带说明一下，我强烈建议您尝试使用 NetBeans 自动生成的代码手动让这些 UI 工作（我喜欢 NetBeans 表单设计器，但您确实需要了解所有各种 UI 元素如何单击在它变得真正有用​​之前一起使用）

# javascript - 如何将信息从 html 导入到 javascript

> ID：14467833
> 
> 赞同：0
> 
> 时间：2013-01-22T20:56:18.080
> 
> 标签：javascript, html

我是 JS 新手，我的脚本有问题。我想在我的网站上显示员工的资历日期。这是我的JS代码来计算它。

```
var dateObj1 = new Date( '1992/07/07 18:00:00' );
var dateObj2 = new Date();

//get difference in milliseconds
var diffMilliseconds = dateObj1.getTime() - dateObj2.getTime();

//make the difference positive
if( diffMilliseconds < 0 ) diffMilliseconds *= -1;

//convert milliseconds to hours
var diffYears = ( diffMilliseconds / 1000 ) / 60 / 60 / 24 / 365;

//print on console
var num = diffYears;
num = Math.floor(num);

if (num > 1)
{
document.write(num + ' years');
}
else if (num < 1)
{
document.write('less than one year');
}
else
{
document.write(num + ' year');
} 
```

将有大约 45-50 名员工，而不是创建 50 个 js 文件，而是想`var dateObj1 = new Date( '1992/07/07 18:00:00' );`在 HTML 中定义就业日期，但并不真正知道如何做到这一点。

有人可以发布要使用的部分 HTML 代码和必须更改的部分 JS。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:00:37.937

您可以创建一个包含员工姓名及其指定日期的地图（对象）。然后，您采用计算剩余时间的逻辑（然后显示它），并将其放入循环中。对于地图中的每个员工，计算数量然后打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:40:31.827

通过将代码放在一个函数中，并通过它传递来自 HTML 的数据，它应该会产生一些好的结果。

**HTML**

```
<table>
    <thead>
        <tr>
            <td>Name</td>
            <td>Startdate</td>
            <td>Date in years</td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Employee #1</td>
            <td>1992/07/07 18:00:00</td>
        </tr>
        <!-- More employees -->
    </tbody>
</table> 
```

**JavaScript**

```
var rows = document.querySelectorAll("tbody tr"); // Get all the rows

for(var i = 0; i < rows.length; i++) {
    // For each row, get the start date
    var startdate = rows[i].cells[1].innerText,
        years = calculateYears(startdate);

    // Create a DOM element with the result, and add it to the table
    var td = document.createElement("td"),
        result = document.createTextNode(years);
    td.appendChild(result);
    rows[i].appendChild(td);
}

// Years calculation
function calculateYears(startdate) {
    // Your function, slightly modified
} 
```

**[这是结果！](http://jsfiddle.net/V7jt9/)**

# visualization - 像单元格一样使用热图可视化数据

> ID：14467839
> 
> 赞同：0
> 
> 时间：2013-01-22T20:56:45.777
> 
> 标签：visualization, data-visualization, diagram, heatmap, treemap

我正在寻找一种算法或方法，可以从数据中可视化/创建漂亮的图表。数据具有大小和质量属性（并且有一些类别）。我发现树图/热图对此很有用。但我需要一个极端的解决方案。像细胞一样的东西。我有一个很好的例子： [https ://www.destatis.de/Voronoi/PriceKaleidoscope.svg](https://www.destatis.de/Voronoi/PriceKaleidoscope.svg)

是否可以生成这样的图表（使用不断变化的数据）？有算法吗？我应该在哪里寻找更多信息？有没有类似的程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T00:59:07.003

**您可以通过d3.js** [http://d3js.org/](http://d3js.org/)制作这种地图，并且有一个树形图示例 [http://mbostock.github.com/d3/talk/20111018/treemap.html](http://mbostock.github.com/d3/talk/20111018/treemap.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:50:46.557

您想要的称为 vornonoi 树图。查看其他[stackoverflow 帖子](https://stackoverflow.com/questions/838265/how-can-i-make-voronoi-treemaps)和[SoftVis 2005 中的这篇论文的链接](http://dx.doi.org/10.1145/1056018.1056041)。

# python - Django Admin - 如何防止删除一些内联

> ID：14467848
> 
> 赞同：6
> 
> 时间：2013-01-22T20:57:20.883
> 
> 标签：python, django, django-models, django-admin

我有 2 个模型 - 例如 Book 和 Page。Page 有一个 Book 的外键。

每个页面都可以标记为“was_read”（布尔值），我想防止删除已读取的页面（在管理员中）。

在管理员中 - Page 是 Book 中的内联（我不希望 Page 成为管理员中的独立模型）。

我的问题 - 我怎样才能实现读取的页面不会被删除的行为？我正在使用 Django 1.4，我尝试了几个选项：

1.  覆盖“删除”以引发 ValidationError - 问题是管理员在删除时没有“捕获” ValidationError 并且您得到一个错误页面，因此这不是一个好的选择。
2.  在 PageAdminInline 中覆盖该方法 - has_delete_permission - 这里的问题 - 它是每个类型的，所以我允许删除所有页面，或者我不允许。

在不覆盖 html 代码的情况下，还有其他好的选择吗？

谢谢，李

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-11T19:54:31.373

解决方案如下（无需HTML代码）：

在管理文件中，定义以下内容：

```
from django.forms.models import BaseInlineFormSet

class PageFormSet(BaseInlineFormSet):

    def clean(self):
        super(PageFormSet, self).clean()

        for form in self.forms:
            if not hasattr(form, 'cleaned_data'):
                continue                     

            data = form.cleaned_data
            curr_instance = form.instance
            was_read = curr_instance.was_read

            if (data.get('DELETE') and was_read):            
                raise ValidationError('Error')

class PageInline(admin.TabularInline):
    model = Page
    formset = PageFormSet 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-11T08:01:36.437

您可以通过为内联模型创建自己的自定义表单集来禁用删除复选框 UI，并将其设置`can_delete`为`False`那里。例如：

```
from django.forms import models 
from django.contrib import admin 

class MyInline(models.BaseInlineFormSet): 
    def __init__(self, *args, **kwargs): 
        super(MyInline, self).__init__(*args, **kwargs) 
        self.can_delete = False 

class InlineOptions(admin.StackedInline): 
    model = InlineModel 
    formset = MyInline 

class MainOptions(admin.ModelAdmin): 
    model = MainModel 
    inlines = [InlineOptions] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-03T10:13:31.830

另一种技术是禁用`DELETE`复选框。此解决方案的好处是向用户提供视觉反馈，因为她会看到一个灰色的复选框。

```
from django.forms.models import BaseInlineFormSet

class MyInlineFormSet(BaseInlineFormSet):

    def add_fields(self, form, index):
        super().add_fields(form, index)
        if some_criteria_to_prevent_deletion:
            form.fields['DELETE'].disabled = True 
```

此代码利用了Django 1.9 中添加的[Field.disabled属性。](https://docs.djangoproject.com/en/dev/ref/forms/fields/#disabled)正如文档所说，“即使用户篡改了提交给服务器的字段值，它也会被忽略，取而代之的是表单初始数据中的值”，因此您无需添加更多代码来防止删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-26T08:27:09.897

我找到了一个非常简单的解决方案，可以悄悄地避免不必要地删除一些内联。您可以覆盖 delete_forms 属性方法。这不仅适用于管理员，也适用于常规内联。

```
from django.forms.models import BaseInlineFormSet

class MyInlineFormSet(BaseInlineFormSet):

    @property
    def deleted_forms(self):
        deleted_forms = super(MyInlineFormSet, self).deleted_forms

        for i, form in enumerate(deleted_forms):
            # Use form.instance to access object instance if needed
            if some_criteria_to_prevent_deletion:
                deleted_forms.pop(i)

        return deleted_forms 
```

# jquery - 协助更好的 Jquery 导航

> ID：14467849
> 
> 赞同：0
> 
> 时间：2013-01-22T20:57:24.777
> 
> 标签：jquery, html

我一直在尝试使用 Jquery 作为站点导航的一种方式，但是在将页面引用附加到 url 时遇到了一些问题。在决定使用 Jquery 时，我有两个主要目标......

目标 1：我想要一个 index.html 页面，它使用 Jquery 在触发时隐藏和显示不同的元素（通过链接）。- 完成（过度设计......但仍然完成）。

目标 2：我还希望将这些不同的页面附加到 URL，以便它们可以直接链接到（或者当刷新发生时，它不会默认为初始页面）。

这是一个[JSFiddle](http://jsfiddle.net/3P8Wt/)示例，显示了我当前如何为不同的页面实现我的 Jquery。我希望有人能够对我如何将页面（表示为多个 div）附加到 URL 提供一些见解。

我的代码示例：

HTML

```
<head>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
</head>

<div id="wrapper">

<div id="nav">
    <ul>
        <li><a href="#" id="projects-link">Projects</a></li>
        <li><a href="#" id="about-link">About</a></li>
        <li><a href="#" id="contact-link">Contact</a></li>

    </ul>

</div>

<div id="main-area">  

    <!-- Content 1 page -->    

    <div id="content-1" class="content-area">

    Content 1 - Main content

    </div>

    <!-- Content 2 page -->

    <div id="content-2" class="content-area">

        Content 2

    </div>

    <!-- Projects page -->
    <div id="projects" class="content-area">
        Projects
    </div>

    <!-- About page -->
    <div id="about" class="content-area">
        About
    </div>

    <!-- Contact page -->
    <div id="contact" class="content-area">
        Contact
    </div>

</div> 
```

Javascript

```
$(document).ready(function() {
$(".content-area").hide();
$("#content-1").show();

$("#projects-link").click(function() {
    $(".content-area").hide();
    $("#projects").show();
});

$("#about-link").click(function() {
    $(".content-area").hide();
    $("#about").show();
});

$("#contact-link").click(function() {
    $(".content-area").hide();
    $("#contact").show();
});

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:29:55.983

我建议稍微调整一下您处理整个场景的方式。首先，您已将链接全部设置为空哈希。将它们设置为您要显示的内容的 ID 怎么样？事实证明`location.hash`，一旦您这样做，将为您提供方便的选择器。您可以绑定到窗口的`hashchange`事件并在首次加载时手动触发它以显示您正在寻找的内容，如下所示：

```
$(window).on("hashchange", function(e) {
    $(location.hash.length > 1 ? location.hash : "#home").siblings().hide().end().show();
}).trigger("hashchange"); 
```

您会注意到，如果哈希实际上的长度比“#”长，我会尝试查找具有匹配 ID 的元素（否则我会找到 ID 为“home”的元素），隐藏其兄弟，然后显示请求的内容。

查看您的小提琴的[**这个分支**](http://jsfiddle.net/lthibodeaux/mMWhR/)，并注意锚点中 URL 的更改以及它们如何与您的内容元素的 ID 相关联。强制 hashchange 事件在页面加载时触发一次的好处是，如果有人在 处导航到页面`index.html#contact`，事件处理程序将立即评估并发现 ID 为“contact”的容器应该被显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:14:05.383

对于 url 更改，请查看“location.hash”，您可以将其写入页面更改并在页面加载时阅读它也可以使用更改事件（或旧导航的计时器）检查它以管理上一个下一个按钮

对于您的 jquery 代码，请尝试将其编写得更全球化，例如：

```
$("#nav a").click(function(event)
{    var id = $(this).attr("id");
     var content = $("#content-"+id);
     $("#main-area > div").not(content).hide();
     content.show();
     event.preventDefault(); // no real click please
}); 
```

不要忘记 event.preventDefault，否则你的 location.hash 将被链接的 # 覆盖

# java - 如何使 JFormattedTextField 接受不带小数点（逗号）的整数？

> ID：14467858
> 
> 赞同：5
> 
> 时间：2013-01-22T20:58:01.297
> 
> 标签：java, swing, integer, number-formatting, jformattedtextfield

我以这种方式使用`JFormattedTextField`with ：`NumberFormat`

- 创建`JFormattedTextField`参考

```
JFormattedTextField integerField; 
```

- 创建`NumberFormat`参考

```
NumberFormat integerFieldFormatter; 
```

- 在构造函数中：

```
integerFieldFormatter = NumberFormat.getIntegerInstance();
integerFieldFormatter.setMaximumFractionDigits(0);

integerField = new JFormattedTextField(integerFieldFormatter );
integerField.setColumns(5); 
```

…………

我的意思是只将它与整数一起使用，但是当我输入像 1500 这样的数字时，它会在失去焦点到 1,500 后被转换，并且抛出异常这是它的第一行：

> 线程“AWT-EventQueue-0”java.lang.NumberFormatException 中的异常：对于输入字符串：“1,500”

当我使用`JTextField`而不是`JFormattedTextField`通常接受的所有整数时，但我想使用的原因`JFormattedTextField`是受益于它的输入限制优势。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-05-29T14:44:48.537

我意识到这是一个老问题，但我只是通过同样的问题偶然发现了它。由于其他答案对我来说似乎是解决方法，因此我仔细研究了 NumberFormat 方法。

我发现最简单的方法实际上是简单地停用 NumberFormat实例**上的分组：**

```
NumberFormat integerFieldFormatter = NumberFormat.getIntegerInstance();
integerFieldFormatter.setGroupingUsed(false); 
```

这样，文本字段输出中将不会出现组分隔符。

当然，您也无法将它们用于您的输入，但这不是问题的本意，对吧？

此外，对于 NumberFormat 的整数实例，您不需要显式设置MaximumFractionDigits(0)，因为这是 getIntegerInstance() 为您所做的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T06:36:46.510

我发现了我的问题的解决方案；**这**是：

确切的问题是，当我使用`JFormattedTextField`with时`NumberFormat`，JFormattedTextField在接下来的 3 位数字之前**添加逗号“，”**

> 1000 呈现为 1,000
> 
> 10000 呈现为 10,000
> 
> 1000000 呈现为 1,000,000

当我从 JFormattedTextField 读取整数值时，请使用这行代码

```
 int intValue = Integer.parseInt(integerField.getText()); 
```

逗号作为字符串的一部分被读取；1000 读为 1000 并且这个字符串值不能转换为整数值，所以抛出异常。

老实说，解决方案在这个[答案](https://stackoverflow.com/a/3465681/1576401)中，但我会在这里重复一遍

采用`str.replaceAll(",","")`

```
 int intValue = Integer.parseInt(integerField.getText().replaceAll(",", "")); 
```

这将替换返回字符串中的任何逗号字符，并将按预期`','`正常转换。`int`

问候

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:04:26.467

您可以通过（至少）两种方式做到这一点：

*   使用 keyListener
*   使用文档过滤器

如果你想使用 KeyListener：

```
KeyListener listener = new KeyAdapter(){
    public void keyTyped(KeyEvent e){
        if(e.getKeyCode()<KeyEvent.VK_0||e.getKeyCode()>KeyEvent.VK_9{//input<'0' or input>'9'?
            e.consume();//delete the typed char
        }
    }
}

yourTextField.addKeyListener(listener); 
```

要使用 DocumentFilter，请检查此链接：[如何允许在 jTextField 中仅引入数字？](https://stackoverflow.com/questions/9477354/how-to-allow-introducing-only-digits-in-jtextfield)

**编辑：**我忘了说这个。正如 MadProgrammer 在对该答案的第一条评论中所说， KeyListener 不是正确的方法，因为

> 您不知道 KeyListeners 将按什么顺序收到事件通知，并且密钥可能在到达您之前已经到达文本组件（或者它可能在到达您之前已被使用）

**编辑#2：另一种快捷方式**

```
MaskFormatter formatter = new MaskFormatter("#####");
JFormattedTextField field = new JFormattedTextField(formatter); 
```

这个技巧应该完成。有了这个，您可以在游览文本字段中插入最多 5 位数字，在格式化程序的字符串参数中插入更多“#”=用户可以输入更多数字

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-14T20:08:41.093

试试这个，这是创建和验证号码的完整解决方案`JTextField`

```
NumberFormat format = NumberFormat.getInstance();
format.setGroupingUsed(false);//Remove comma from number greater than 4 digit
NumberFormatter sleepFormatter = new NumberFormatter(format);
sleepFormatter.setValueClass(Integer.class);
sleepFormatter.setMinimum(0);
sleepFormatter.setMaximum(3600);
sleepFormatter.setAllowsInvalid(false);

sleepFormatter.setCommitsOnValidEdit(true);// committ value on each keystroke instead of focus lost

JFormattedTextField textFieldSleep = new JFormattedTextField(sleepFormatter);
textFieldSleep.setText("0"); 
```

# regex - Vim — 在不以 'character' 开头的行上用 'bar' 替换 'foo'

> ID：14467859
> 
> 赞同：6
> 
> 时间：2013-01-22T20:58:05.137
> 
> 标签：regex, vim, replace

在 Vim 正则表达式中，我知道可以在所有以using开头的行上替换`foo`为`bar``%`

```
:g/^%/s/foo/bar/g 
```

但我想在所有不以.开头的行上替换`foo`为 有没有办法轻松做到这一点？`bar``%`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-22T21:03:08.033

尝试`:vglobal`：

```
:v/^%/s/foo/bar/g 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-22T21:00:04.090

您可以`%`使用以下命令来否定角色`character class`：-

```
:g/^[^%]/s/foo/bar/g 
```

`[^%]`匹配`%`字符串开头的除 , 之外的任何字符。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-22T21:05:57.060

`:g`is的倒数`:g!`，因此您的示例可以表示为：

```
:g!/^%/s/foo/bar/g 
```

请注意，这`:g!`只是另一种写作方式`:v`（参见 Jim Davis 的回答）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-22T20:59:55.657

尝试`:g/^[^%]/s/foo/bar/g`匹配所有不以 % 开头的行

# ruby-on-rails - rails as_json 没有为 JSON.parse 正确编码

> ID：14467865
> 
> 赞同：4
> 
> 时间：2013-01-22T20:58:21.600
> 
> 标签：ruby-on-rails, json

因此，在我看来，我正在使用 ruby​​ 将一个相当复杂的对象转换为 JSON 格式`object.as_json`，然后在客户端使用`JSON.parse()`javascript 对其进行解析，以将对象反序列化为可用的东西。但是，输出`as_json`似乎使用了单引号编码，`&quot;`而不是 JSON 结构所需的双引号。任何建议我在 as_json 上做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T22:19:01.297

啊，弄清楚发生了什么：它实际上是两个不同问题的组合：

首先，引号由 rails 自动编码（以防止 XSS 和类似情况）。这可以通过使用`html_safe`方法或`raw`函数来逃避（但这可能会引入 XSS 漏洞，因此请谨慎使用）。

其次，我使用`as_json`的是`to_json`. 在 Rails 中将 ActiveSupport 对象转换为 JSON 需要两个单独的操作：将对象渲染为可以序列化为 JSON 的结构，然后实际序列化对象。`to_json`两者都做，但`as_json`只做第一个。这解释了为什么我要`=&gt`进入我的输出。

# user-interface - 剑道滑块更改事件参数未定义

> ID：14467866
> 
> 赞同：1
> 
> 时间：2013-01-22T20:58:29.320
> 
> 标签：user-interface, knockout.js, kendo-ui

我在一个页面上有多个剑道滑块。当滑块的值发生变化时，我想确定是哪个滑块触发了更改事件，以便我可以根据所选值更改其颜色。

```
<div id="div_slider">
    <input id="slider1" data-bind="kendoSlider: { value: myValue, min: 0, max: 5,change: changeSlider }" />
    <input id="slider2" data-bind="kendoSlider: { value: myValue,  min: 0, max: 5,change: changeSlider }" />
    <input id="slider3" data-bind="kendoSlider: { value: myValue,  min: 0, max: 5,change: changeSlider }" />
</div> 
```

我的淘汰赛绑定如下

```
<script type="text/javascript">

    var ViewModel = function () {
        this.myValue = 5;

        this.changeSlider = function(data, event) {
            console.log(data);
            console.log(event);
        };
    };

    ko.applyBindings(new ViewModel());
</script> 
```

问题是滑块更改函数的事件参数始终未定义。有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T23:10:44.140

我想通了，必须使用'this'来获取元素ID。下面的代码：（根据 Pechka 的建议更新了代码以使用包装器）

```
 this.changeSlider = function (data, event) {

        if (data.value === 1) {
            this.wrapper.find('.k-slider-selection').css('background-color', 'red');
        } else if (data.value === 2) {
            this.wrapper.find('.k-slider-selection').css('background-color', 'orange');
        } else if (data.value === 3) {
            this.wrapper.find('.k-slider-selection').css('background-color', 'yellow');
        } else if (data.value === 4) {
            this.wrapper.find('.k-slider-selection').css('background-color', 'green');
        } else if (data.value === 5) {
            this.wrapper.find('.k-slider-selection').css('background-color', 'blue');
        }    
 }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T23:33:15.450

**您可以通过小部件的wrapper**字段访问包装的 html 元素，这是处理程序函数中的 this。

例如

```
this.changeSlider = function(){
   this.wrapper.find('.k-slider-selection').css('background-color', 'red');
} 
```

# php - 更新查询php

> ID：14467867
> 
> 赞同：-2
> 
> 时间：2013-01-22T20:58:30.687
> 
> 标签：php, sql

我有这个功能：

```
function updateinfos($id) {
    parametrs();
    $Log_query = mysql_query("SELECT max(recent) FROM song") or die(mysql_error());
    $Res_user = mysql_fetch_array($Log_query);
    $max = $Res_user[0] + 1;
    $Log_query2 = mysql_query("UPDATE song SET recent = '$max' AND number = number + 1 WHERE id = '$id'") or die(mysql_error());
} 
```

我在查询更新中遇到问题，因为它不起作用而且我不知道为什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:02:07.410

您的 UPDATE 语法错误。

```
UPDATE song
SET   recent = '$max' AND number = number + 1
WHERE id = '$id' 
```

通过使用 AND，您将创建一个布尔表达式，而不是设置两列的值。

您应该编写一个 UPDATE 语句来更改多个列，如下所示：

```
UPDATE song
SET   recent = '$max',
      number = number + 1
WHERE id = '$id' 
```

换句话说，使用逗号，而不是 AND。

# google-drive-api - 没有 Ouath 的 Google Drive API 和接收文件

> ID：14467868
> 
> 赞同：3
> 
> 时间：2013-01-22T20:58:30.740
> 
> 标签：google-drive-api, yql, google-drive-realtime-api

我们正在构建一个 Web 应用程序，该应用程序应该从 Drive 中的特定文件夹中获取所有文件（只读）。问题是我找不到不使用 OAuth 来访问我们的文件的方法。基本上我想使用 AJAX 请求我们的文件并在页面上显示它们的内容（用户无需做任何事情）。这有可能吗？我错过了什么吗？

每当我在不使用 OAuth 的情况下尝试某些事情时，我都会得到一个全局 internalError（根据当前文档与授权相关）。

我想要达到的体验：

用户输入[http://domain.com/posts](http://domain.com/posts) > 从文件夹 Y 获取所有公共文件 > 按日期排序 > 在 HTML 中显示标题 > 用户单击标题 > 用户以 HTML 格式显示文件的全部内容。

**这可能吗？**

提前致谢！:)

**更新：** 澄清：我只想依赖我们的 API 密钥。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:33:21.457

You can do it this way, without using Google Drive API:

1.  Make the folder public
2.  Copy the *folder ID* from the URL
3.  Append it to [https://googledrive.com/host/](https://googledrive.com/host/) e.g. [https://googledrive.com/host/0BzEbtMoF6IXbaVN2Qmx1em9qS0k/](https://googledrive.com/host/0BzEbtMoF6IXbaVN2Qmx1em9qS0k/)

You will get a directory index with all files listed and if the (sub)folder contains an *index.html* file, it will be rendered instead.

To get the JSON or XML file list, use [YQL](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20html%20where%20url%3D%22https%3A//googledrive.com/host/0B_p1jUoXa8fqVG9sd0dXdFl5R2c/%22%20and%20xpath%3D%27//div%5b@class%3D%22folder-cell%22%5d/a%27).

# android - android乘法按钮案例开关

> ID：14467871
> 
> 赞同：1
> 
> 时间：2013-01-22T20:58:41.927
> 
> 标签：android, button, toast

我一直在看一些帖子，但我仍然无法让我的代码工作（我是初学者）.. 我只是想用我的两个按钮和一个案例开关来使用 toast.. 编译时它只是崩溃了.. 一个有什么想法吗？

代码 ：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_menu);

    TextView et = (TextView) findViewById(R.id.txtHeader);

    Button btnAdd = (Button) findViewById(R.id.btnAdd);
    Button btnDis = (Button) findViewById(R.id.btnDisplay);

    btnAdd.setOnClickListener((OnClickListener) this);
    btnDis.setOnClickListener((OnClickListener) this);

}

public void OnClick(View v) {

        switch (v.getId()) {
          case R.id.btnAdd:
        //  Toast msg = Toast.makeText(getBaseContext(), "Torben", Toast.LENGTH_LONG);
        //   msg.show();
            break;

          case R.id.btnDisplay:
        //    Toast msg1 = Toast.makeText(getBaseContext(), "Henriksen", Toast.LENGTH_LONG);
        //       msg1.show();
            break;

           default:

              break;
        }
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:06:56.397

我看到两个主要问题：

```
((OnClickListener) this 
```

确保您的类实现`OnClickListener`了，因为如果您实际实现接口，则永远不需要强制转换。

类的声明应该是这样的：

```
public class MyActivity extends Activity implements OnClickListener 
```

然后 `OnClick`改为小写`o`。

```
@Override
public void onClick(View v) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:24:19.830

添加按钮侦听器的示例：

```
Button b = ((Button)findViewById(R.id.button_name));
b.setOnClickListener(new OnClickListener(){
            @Override
            public void onClick(View v) {   
                //do something
            }
        }); 
```

并确保在您的 xml 文件中使用 id @+id/button_name 或 @id/button_name 定义按钮（只要确保它们匹配）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:06:03.807

一些日志输出会很有帮助！

一个疯狂的猜测是您的活动没有实现 OnClickListener，为什么还要将它转换为 OnClickListener？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T21:13:39.587

只需在您的布局清单中检查按钮 id 是否正确并给出您正在使用的相同 id，如果是，请使用 LogCat 输出更新问题。

并且还要检查活动是否在清单中定义，因为您的代码中没有错误为多个按钮实现 onclick 侦听器。

享受！！

# c# - 图像未显示在 ASP 页面上

> ID：14467874
> 
> 赞同：0
> 
> 时间：2013-01-22T20:59:05.477
> 
> 标签：c#, asp.net, image

我创建了一个动态图像，该图像保存在该`Page_Load(object sender, EventArgs e)`方法中。
我像这样加载图像：

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" Runat="Server">
    <p>
       &nbsp;</p>
    <img alt="aa" class="style1" longdesc="aa"
        src="file:///C:/project/Image/hours.png" />
</asp:Content> 
```

但唯一显示的是：
![在此处输入图像描述](../Images/61c31fe7aaa0b6eb7e5fca55e6e57f2b.png)

我知道这是一个愚蠢的问题，但我无法让它发挥作用..有人能指出我在哪里做错了吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T21:00:09.050

您无法与客户端上的文件系统进行交互。

您需要使用相对或绝对路径引用服务器上的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:02:11.053

您需要在服务器上使用相对或绝对路径。看起来像“~/../Image/hours.png”的东西。

# jqgrid - jqgrid在重新加载时保留过滤器

> ID：14467883
> 
> 赞同：3
> 
> 时间：2013-01-22T20:59:38.037
> 
> 标签：jqgrid, filter, reload, persist

这个问题已经很多了，所以请原谅我再问一次。

我有一个从 url 加载的网格。

我使用 loadonce: true

我使用过滤器工具栏：

```
$("#status").jqGrid('filterToolbar', { stringResult:true, searchOnEnter:false, autosearch: true, defaultSearch: "cn" }); 
```

我有一个下拉搜索列表，我可以从中选择我要查找的内容。效果很好。

我有一个导航按钮，每 30 秒单击一次以启动重新加载。效果很好。

```
$("#status").jqGrid('navButtonAdd','#statuspager', { caption: '', buttonicon: 'ui-icon-play', onClickButton: function ()
{
stint = setInterval (function() {
      postfilt = $("#status").jqGrid('getGridParam', 'postData').filter;

      $("#status").jqGrid('setGridParam',{
             url: './ar_status.cgi?systemtype=' + systype,
             datatype: "json",
             postData: postfilt,
             search: true,
             loadtext: "Refreshing grid...",
             loadonce: true,
             loadui: "block"
      });
      $("#status").jqGrid().trigger("reloadGrid");
}, 30000);
},
title: 'Start Auto Refresh (every 30 sec.)'
}); 
```

使用谷歌浏览器，我可以看到指定的过滤器被发布到服务器：

```
systemtype:production
_search:true
nd:1358887757603
rows:1000
page:1
sidx:system
sord:asc
totalrows:700
filters:{"groupOp":"AND","rules":[{"field":"system","op":"eq","data":"ATTDA02"}]} 
```

我可以在重新加载之间更改过滤器并查看新的甚至多个过滤器：

```
systemtype:production
_search:true
nd:1358887847592
rows:1000
page:1
sidx:system
sord:asc
totalrows:700
filters:{"groupOp":"AND","rules":[{"field":"system","op":"eq","data":"ATTDA02"},{"field":"dow","op":"cn","data":"MO"}]} 
```

我在初始加载时使用 multipleSearch: true 。我很确定在重新加载时会保留

在网格上，过滤器工具栏保留了我的过滤条件，包括文本和选择，但是当网格重新加载时，过滤器被忽略并且整个数据集都显示在网格中。

我已经尝试过在 SO 上发布的许多示例。我尝试将 [{current:true}] 添加到 reloadGrid 调用 - 没有区别。我似乎无法在重新加载时保留和应用过滤器。

我希望重新加载始终从服务器返回完整的数据集（这很好），并允许当前的过滤器设置控制重新加载后显示的内容。我不想使用 postdata 来构建新的 SQL 选择语句 - 服务器端过滤，因为在任何时候用户可能想要单击暂停按钮，选择一个新的过滤器并从整个数据集中查看其他内容，而无需再次重新加载。

```
$("#status").jqGrid('navButtonAdd','#statuspager', { caption: '', buttonicon: 'ui-icon-pause', onClickButton: function ()
{
   clearInterval(stint);
},
title: 'End Auto Refresh'
}); 
```

正如我在一篇文章中所看到的，如何在不使用 cookie 的情况下做到这一点？

我可以尝试使用 jqGridExport'ing postfilt var，然后 jqGridImport'ing 它，但希望有更直接的方法。我什至不确定这会有所帮助，因为我已经通过 postData 在网格中拥有了我需要的一切。

附带说明一下，在我上面的 setGridParam 中，我指定的 loadtext 永远不会显示。而是显示默认的“正在加载...”。所有其他参数都在工作。

非常感谢，迈克

解决方案。从服务器重新加载 [json] 后保留过滤器、排序索引和排序顺序的完整 loadComplete：

```
 loadComplete: function() {
                            var $this = $(this);
                            postfilt = $this.jqGrid('getGridParam','postData').filters;
                            postsord = $this.jqGrid('getGridParam','postData').sord;
                            postsort = $this.jqGrid('getGridParam','postData').sidx;

                            if ($this.jqGrid("getGridParam", "datatype") === "json") {
                                    setTimeout(function () {
                                            $this.jqGrid("setGridParam", {
                                                    datatype: "local",
                                                    postData: {filters: postfilt, sord: postsord, sidx: postsort},
                                                    search: true
                                            });

                                            $this.trigger("reloadGrid");
                                    }, 50);
                            }
                    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T12:22:08.467

非常感谢！！！！

我只在您的解决方案中添加了一些内容以保留页码：

```
 loadComplete: function () {
                var $this = $(this);
                var postfilt = $this.jqGrid('getGridParam', 'postData').filters;
                var postsord = $this.jqGrid('getGridParam', 'postData').sord;
                var postsort = $this.jqGrid('getGridParam', 'postData').sidx;
                var postpage = $this.jqGrid('getGridParam', 'postData').page;

                if ($this.jqGrid("getGridParam", "datatype") === "json") {
                    setTimeout(function () {
                        $this.jqGrid("setGridParam", {
                            datatype: "local",
                            postData: { filters: postfilt, sord: postsord, sidx: postsort },
                            search: true
                        });
                        $this.trigger("reloadGrid", [{ page: postpage}]);
                    }, 25);
                }
            } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T22:03:11.747

我不确定，但我想你的第一个问题的根源可能是混合`postData.filters`和`postData`使用`filter`属性而不是过滤器``。你用

```
postfilt = $("#status").jqGrid('getGridParam', 'postData').filter; 
```

获得`filter`财产而不是`filters`. 你得到了`undefined`价值。所以设置`postData`为`postfilt`没有任何意义。

下一个问题是服务器响应包含未过滤的数据。*要在本地*强制过滤数据，您必须在从服务器加载完成后重新加载网格一次。您可以在`loadComplete`. 正是在这里，您可以`postData.filter`根据需要设置、设置`search: true`和触发 reloadGrid 事件。重要的是只执行**一次**就没有递归，并且在这种情况下您不能`datatype`返回`"json"`。在使用选项的情况下，`datatype`将更改为`"local"`并结束从服务器加载。`loadonce: true`如果要*在本地*应用过滤，则必须使用选项重新加载网格`datatype: "local", search: true`并`postData`具有`filters`指定需要应用的过滤器。查看[答案](https://stackoverflow.com/a/13679698/315935)中的代码或[另一个](https://stackoverflow.com/a/10287338/315935)执行其他操作的代码，但您需要的代码将非常接近。

# asp.net-mvc - Subversion“忘记”提交类文件和查看文件

> ID：14467884
> 
> 赞同：1
> 
> 时间：2013-01-22T20:59:39.687
> 
> 标签：asp.net-mvc, visual-studio, svn, tortoisesvn, visualsvn

我正在开发一个 ASP.NET MVC 应用程序并使用 Visual Studio、TortoiseSVN 和 VisualSVN。当我尝试将我的项目提交到 Subversion 服务器时，除了类 (.cs) 和视图 (.cshtml) 文件之外的所有文件都已提交。Subversion 是否有理由忘记提交这些文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:02:34.803

Subversion 不会自动添加要提交的文件。一些与 IDE 集成的客户端可能会这样做作为一种便利功能，但标准的 SVN 行为是*不*这样做。

在 Windows 资源管理器中，通过 TortoiseSVN 检查项目是否已添加。如果没有，这样做（右键单击，TortoiseSVN，添加），然后提交。

# jquery - 我可以更新 Twitter Bootstrap 数据内容的一部分吗？

> ID：14467892
> 
> 赞同：0
> 
> 时间：2013-01-22T21:00:01.970
> 
> 标签：jquery, twitter-bootstrap

我正在使用一个弹出框，我需要动态更改其中的内容，但只是其中的一部分。更具体地说，我正在使用[bootstrapx-clickover](http://www.leecarmichael.com/bootstrapx-clickover/examples.html)所以我不能简单地更新数据内容，因为我的关闭弹出窗口的按钮将被删除。

我当前的代码如下所示：

```
<span class="label label-importan" rel="clickover" data-content="NEW TEXT HERE<button class='btn' data-toggle='button' data-dismiss='clickover'>Close</button>" data-original-title="Title">data</span> 
```

如果我只是打电话：

```
....
var el = $(this);
el.attr('data-content', "New Data");
.... 
```

不幸的是，这删除了按钮代码。有没有办法只更新数据内容的文本而不是按钮 HTML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:09:33.873

假设`data-content`属性的内容与您的示例相同，IE 中总会有一些文本后跟一个`<button>`元素，您可以使用一些类似的代码 -

```
var attributeContent = el.data('content');
var withoutText = txt.replace(/.*<button/,'<button');
el.data('content','SOME NEW TEXT HERE'+withoutText); 
```

这是一种技术含量低的解决方案，它取决于`data-content`价值的一致性，但这可能只适用于您的特定情况。

因为您实际上每次都添加一个新元素（`<button>`元素），所以您可能需要利用`delegate()`父元素上的函数来允许自己将事件处理程序附加到动态生成的元素。

# java - 像id这样的动态数据类型？

> ID：14467894
> 
> 赞同：1
> 
> 时间：2013-01-22T21:00:08.000
> 
> 标签：java, android, ios

我正在开发 iOS 和 Android 上的应用程序。我想检查什么是类似于 Java (android) 中 Objective-C 的“id”的等效数据类型，例如“id”如何支持动态绑定和键入。

有人可以指导我吗，因为我还找不到答案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:34:51.337

Java 中没有鸭子类型，因此不能调用 Java 中任意对象的任意方法，因此没有像`id`.

必须显式转换为所需的类型，然后才调用所需的方法。

但是`invokedynamic`Java 7 中引入了它，但我不确定您现在是否可以直接在 Java 代码中使用它。

我建议分析你需要那种鸭子打字`id`魔法的情况，并考虑如何避免它。

# java - 如何在 Java 中使用循环

> ID：14467900
> 
> 赞同：-2
> 
> 时间：2013-01-22T21:00:31.907
> 
> 标签：java, loops, selection

**我需要有关如何在 Java 中使用 for 循环的帮助**

**这是课堂作业，所以我宁愿指出正确的方向而不是给出答案。**

“有效的七个小矮人列表：瞌睡、害羞、医生、打喷嚏、快乐、脾气暴躁、笨拙 随机字符池，无效小矮人：Lion-O、Cheetara、Panthro、Tigra、Snarf、唐老鸭、米老鼠、米妮老鼠, 高飞, 希斯克利夫, 休伊, 杜威, 路易, 斯克罗吉·麦克杜克,

声明这些变量：

```
int counter = 7;
boolean firstSelection = false;
boolean secondSelection = false;
boolean thirdSelection = false;
boolean fourthSelection = false;
boolean fiveSelection = false;
boolean sixSelection = false;
boolean sevenSelection = false; 
```

将三个选项的列表打印到控制台。要求用户在三个选项中选择正确的侏儒。三个选项的列表将包括随机字符列表中的两个名字和七个小矮人中的一个名字。You will create a switch statement to handle the choice selection When the wrong case is selected then decrement the int variable called counter and print to the console “wrong selection” When the correct case is selected then change the corresponding boolean variable to true (ie. . firstSelection, secondSelection 等）并打印到控制台“Hi Ho，你选对了” 默认情况下会在控制台打印一条语句“invalid selection” 创建一个循环，执行此操作七次，直到涵盖所有七个小矮人。

*   使用 for 循环
*   使用 do-while 循环重新创建循环
*   使用 while 循环重新创建循环最后，创建 if-else 语句。该语句将具有短路 && 将测试所有布尔变量。如果属实，请在控制台上打印一条语句“您获得了金星！”。否则，在控制台上打印一条语句“你没有完全正确”。"

我完成了之前的作业，也就是没有循环的这个规范，没有问题。但是我真的不明白教授希望我们如何将循环整合到问题中。我唯一能想到的是，他想创建一个循环七次，以某种方式询问七次中的每一个不同的侏儒。这甚至可能吗？您可以在运行循环时更改循环的内容吗？我觉得我什至没有正确地思考这个问题。

这是我之前分配的代码，无循环：

```
import java.util.Scanner;

public class SevenDwarfs {

    public static void main(String[] args) {
        int counter = 7;
        boolean firstSelection = false;
        boolean secondSelection = false;
        boolean thirdSelection = false;
        boolean fourthSelection = false;
        boolean fiveSelection = false;
        boolean sixSelection = false;
        boolean sevenSelection = false;

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Sleepy");
        System.out.println("2 Lion-O");
        System.out.println("3 Cheetara");

        Scanner input = new Scanner(System.in);
        int choice = input.nextInt();
        switch (choice) {

        case 1:
            System.out.println("Hi Ho, you picked the correct one");
            firstSelection = true;
            break;
        case 2:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Panthro");
        System.out.println("2 Bashful");
        System.out.println("3 Tigra");

        Scanner input2 = new Scanner(System.in);
        int choice2 = input2.nextInt();
        switch (choice2) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            secondSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Snaf");
        System.out.println("2 Doc");
        System.out.println("3 Donald Duck");

        Scanner input3 = new Scanner(System.in);
        int choice3 = input3.nextInt();

        switch (choice3) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            thirdSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Mickie Mouse");
        System.out.println("2 Sneezy");
        System.out.println("3 Minie Mouse");

        Scanner input4 = new Scanner(System.in);
        int choice4 = input4.nextInt();
        switch (choice4) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            fourthSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Heathcliff");
        System.out.println("2 Happy");
        System.out.println("3 Goofy");

        Scanner input5 = new Scanner(System.in);
        int choice5 = input5.nextInt();
        switch (choice5) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            fiveSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Huey");
        System.out.println("2 Grumpy");
        System.out.println("3 Dewey");

        Scanner input6 = new Scanner(System.in);
        int choice6 = input6.nextInt();
        switch (choice6) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            sixSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        System.out
                .println("Which of the following is one of the seven drawfs?");
        System.out.println("1 Scrooge McDuck");
        System.out.println("2 Dopey");
        System.out.println("3 Louie");

        Scanner input7 = new Scanner(System.in);
        int choice7 = input7.nextInt();
        switch (choice7) {

        case 1:
            System.out.println("Wrong selection");
            --counter;
            break;
        case 2:
            System.out.println("Hi Ho, you picked the correct one");
            sevenSelection = true;
            break;
        case 3:
            System.out.println("Wrong selection");
            --counter;
            break;
        default:
            System.out.println("Invalid selection");
            --counter;
            break;
        }

        if (firstSelection == true && secondSelection == true
                && thirdSelection == true && fourthSelection == true
                && fiveSelection == true && sixSelection == true
                && sevenSelection == true) {
            System.out.println("You earned a gold star!");
        } else {
            System.out.println("\nYou did not get all correct.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:21:40.833

你意识到你可能错误地思考了这个概念并寻求帮助这一事实是一件好事。

阅读以下内容以熟悉 Java 中的循环。

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/while.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/while.html)

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/for.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/for.html)

要回答您的问题，是的，您可以在运行时更改循环的内容。这就是变量的用途。您可以在程序运行时修改它们的值。看看这个样本。变量 i 随着循环的每次迭代而递增。变量 outsideLoop 在循环内部也会发生变化。玩这个，你会开始明白的。

```
class ForDemo
{
    public static void main(String[] args)
    {
        int outsideLoop = 0;
        for (int i = 1; i < 11; i++)
        {
            outsideLoop += i;
            System.out.println("Count is: " + i);
        }
        System.out.println("Outside loop is: " + outsideLoop);
    }
} 
```

对于打印选择、获取用户输入和验证用户输入的过程，您已经有了一个很好的起点。重复该块（循环）7次。

# javascript - 如何删除 window.alert 弹出窗口？

> ID：14467901
> 
> 赞同：-2
> 
> 时间：2013-01-22T21:00:33.647
> 
> 标签：javascript, mailto

这是我复制的一些脚本，用于创建一个 mailto 链接，该链接获取浏览器 URL 并将其插入到电子邮件的主题中。它工作完美，但我进入 Javascript 警报框的每一页都会弹出：

mailto:address@address.ca?Subject="浏览器地址栏中的内容"

我对JS很垃圾。如何让脚本在没有弹出警报的情况下工作，甚至在有生命周期的情况下也能正常工作？

```
<script type='text/javascript' src='http://code.jquery.com/jquery-1.7.1.js'>
</script>
  <script type='text/javascript'>
//<![CDATA[ 
  $(window).load(function(){
  var url = "mailto:address@address.ca?Subject=" + window.location;
  $('#mailtoLink').attr('href', url);
  window.alert($('#mailtoLink').attr('href')); // = url;
  });//]]>

  </script> 
```

这是一个示例页面：

[http://www.door9.co.uk/bex/his-thoughts/](http://www.door9.co.uk/bex/his-thoughts/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:02:09.453

只需删除此行`window.alert($('#mailtoLink').attr('href')); // = url;`，您就剩下：

```
<script type='text/javascript' src='http://code.jquery.com/jquery-1.7.1.js'>
</script>
<script type='text/javascript'>
//<![CDATA[ 
$(window).load(function(){
var url = "mailto:address@address.ca?Subject=" + window.location;
$('#mailtoLink').attr('href', url);
});//]]>

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:02:31.710

取出这条线；这显然仅用于演示目的

```
window.alert($('#mailtoLink').attr('href')); // = url; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T21:01:59.050

只需删除 window.alert 函数调用。

[https://developer.mozilla.org/en-US/docs/DOM/window.alert](https://developer.mozilla.org/en-US/docs/DOM/window.alert)

# oracle - 自定义 Oracle 访问管理器

> ID：14467906
> 
> 赞同：1
> 
> 时间：2013-01-22T21:00:44.740
> 
> 标签：oracle, jsp, authentication, oracle11g

我想知道如何更改 Oracle Access Manager 的登录页面。我不想构建一个新的自定义页面，而只是将一些 UI 组件更改为默认的 Oracle 页面（如图像和 CSS）。

我正在谈论的“登录页面”是：`console/login/LoginForm.jsp`，但我在我的服务器上找不到它，有人知道我在哪里可以找到这个 LoginForm.jsp 吗？

我实际上是`login/LoginForm.jsp`在这个[Oracle 文档](http://docs.oracle.com/cd/E14571_01/web.1111/e13745/rebrand.htm#i1068655)中寻找。

任何帮助将不胜感激，谢谢！

**请注意，我无法在该服务器上安装任何其他程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T21:31:11.913

您不需要在服务器上安装任何额外的软件，您只需要能够将文件[复制`WAR`到控制台扩展目录即可](http://docs.oracle.com/cd/E14571_01/web.1111/e13745/deploy.htm)。

您可以在任何地方构建`WAR`，而不必在服务器上完成。[展开外观模板](http://docs.oracle.com/cd/E14571_01/web.1111/e13745/rebrand.htm#BABIJIJH)，它将为您提供`login/login.jsp`您正在寻找的文件、进行更改、[构建存档](http://docs.oracle.com/cd/E14571_01/web.1111/e13745/rebrand.htm#BABEDEGD)并[部署](http://docs.oracle.com/cd/E14571_01/web.1111/e13745/deploy.htm)到您的服务器。

祝你好运！

# jquery - TypeScript Jquery Promise 参数不匹配

> ID：14467915
> 
> 赞同：4
> 
> 时间：2013-01-22T21:01:23.133
> 
> 标签：jquery, typescript

我正在使用来自[https://github.com/borisyankov/DefinitelyTyped/tree/master/jquery的 TypeScript 0.8.2 和最新的 JQuery 1.9 .d.ts 定义](https://github.com/borisyankov/DefinitelyTyped/tree/master/jquery)

为了隔离问题，我有一个简单的 TypeScript 类定义，它尝试使用 .when() 和 .then() 语法进行单个 $.ajax 调用。这是我的代码：

```
/// <reference path="../../jquery.d.ts" />

module Demo {

    // Class
    export class TestDeferred {
        // Constructor
        constructor() {

            $.when(this.testAjaxCall()).then((data, status, jqXHR: JQueryXHR) => {
                alert(jqXHR.statusText);
            });

            $.when($.ajax("test.htm")).then(() => {
                console.log("yay");
            });
        }

        testAjaxCall() {
            return $.ajax("Test.aspx");
        }
    }
} 
```

在这两个测试用例中，我得到一个编译时错误，上面写着：

提供的参数与调用目标的任何签名都不匹配，红色波浪线位于 .when() 方法的第一个参数上。他是截图：

![TypeScript JQuery 延迟编译问题](../Images/9b06ee35d557846cdb061fa557f8d760.png)

据我所知，.d.ts 文件中的 .when() 方法具有 .when(options: any) 的重载，并且 .ajax 被定义为实现 JQueryPromise 接口的 JQueryXHR 类型。

从理论上讲，这应该可以正常工作，因为它反映了 .when() [http://api.jquery.com/jQuery.when/的 jQuery 文档](http://api.jquery.com/jQuery.when/)

```
$.when( $.ajax("test.aspx") ).then(function(data, textStatus, jqXHR){
     alert( jqXHR.status ); // alerts 200
}); 
```

那么我错过了什么？我定义错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T21:37:27.703

jQuery 的类型文件中可能存在细微的错误。以下作品：

```
$.when( $.ajax("test.aspx") ).then(function(data, textStatus, jqXHR){
     alert( jqXHR.status );
}, null); 
```

这是因为类型文件希望您同时传递成功处理程序和失败处理程序。我将检查文档并更新定义以显示故障处理程序是可选的。

*更新*

我已向 jQuery 类型定义提交了以下更改：

```
then(doneCallbacks: any, failCallbacks: any, progressCallbacks?: any): JQueryPromise; 
```

变成

```
then(doneCallbacks: any, failCallbacks?: any, progressCallbacks?: any): JQueryPromise; 
```

# java - Java硬币计数器代码

> ID：14467916
> 
> 赞同：-2
> 
> 时间：2013-01-22T21:01:25.380
> 
> 标签：java

您好，到目前为止，我有这段代码可以找到给定数量的较少变化，但我不断收到静态错误消息。我不知道为什么。

```
 import java.util.Scanner;

 public class Coin{
  public static void main (String[] Args){
  Scanner sc = new Scanner (System.in);
  System.out.print("Enter a number");
  int i = sc.nextInt();
  int q = 25;
  int d = 10;
  int n = 5;
  int p = 1;
  int quarters = (i/q);
  int dimes = i - quarters*25/d;
  int nickels = i - (quarters*25) - (dimes*10)/n;
  int pennies = i - (quarters*25) - (dimes*10) - (nickels*5)/p;
  System.out.println ("Your amount contain the following");
  System.out.println ("quarters:   " + quarters);
  System.out.println ("dimes:    " + dimes);
  System.out.println ("nickels:    " + nickels);
  System.out.println ("pennies:    " + pennies);

}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:09:48.833

冒着解决看起来非常像家庭作业问题的风险，我只想指出我看到的最大错误是运算符优先级。换句话说，我相信你需要更多的括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:44:00.430

根据您的评论，您正在使用`nextInt()`Scanner 类的方法，该方法只会获得一个整数。如果你输入一个浮点数（比如 3.54），它会抛出一个异常。您需要改为使用[nextFloat()](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#nextFloat%28%29)并将变量更改`i`为浮点数。

# youtube - youtube ie菜单修复

> ID：14467917
> 
> 赞同：0
> 
> 时间：2013-01-22T21:01:26.093
> 
> 标签：youtube, youtube-api, youtube-javascript-api

我有以下代码

```
<script>
window.onload = function(){
var a = document.getElementsByTagName("a");
for(var i=0; i<a.length; i++){
    if(!/#ytplayer/.test(a[i].href)) continue;
    var link = a[i].innerHTML.match(/\/vi\/([^\/]+)/);
    if(link) (function(vidId){
        a[i].onclick = function(){
            player.loadVideoById(vidId);
        }
    })(link[1]);
}
}

// 2\. This code loads the IFrame Player API code asynchronously.
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/player_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

// 3\. This function creates an <iframe> (and YouTube player)
//    after the API code downloads.
var player;

function onYouTubePlayerAPIReady() {
player = new YT.Player('player', {
    height: '480',
    width: '853',
    videoId: '963puDdR0bY',
    wmode: 'transparent',
    rel: '0',
    events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
    }
});
}

// 4\. The API will call this function when the video player is ready.

function onPlayerReady(event) {
event.target.playVideo();
}

// 5\. The API calls this function when the player's state changes.
//    The function indicates that when playing a video (state=1),
//    the player should play for six seconds and then stop.
var done = false;

function onPlayerStateChange(event) {
if (event.data == YT.PlayerState.PLAYING && !done) {
    setTimeout(stopVideo, 60000);
    done = true;
}
}

function stopVideo() {
player.stopVideo();
}
</script>

<script>

$(document).ready(function() {

$.ajax({
  type: "POST", 
  url: "/publicPortal/restservices/tracking/click", 
  data: { docId: "enPubIntentionalInvesting", docType: "tvSpots" },
  contentType: "text/plain"
});

});
</script> 
```

我在这里调用图像

```
<div id="player" style="padding-left:40px; z-index:-1;"></div>  
</div>

<div id="nav" style="height:200px; padding-top:20px; padding-left:40px !important;">

<a href="#ytplayer" >
<img src="image.png" id="vid1" class="vidThumb" rel="http://www.youtube.com/watch?v=963puDdR0bY" />
<img style="display:none;" src="http://img.youtube.com/vi/963puDdR0bY/default.jpg" /></a>

    <a href="#ytplayer" >
<img src="image.png" id="vid1" class="vidThumb" rel="http://www.youtube.com/watch?v=963puDdR0bY" />
<img style="display:none;" src="http://img.youtube.com/vi/963puDdR0bY/default.jpg" /></a>

    <a href="#ytplayer" >
<img src="image.png" id="vid1" class="vidThumb" rel="http://www.youtube.com/watch?v=963puDdR0bY" />
<img style="display:none;" src="http://img.youtube.com/vi/963puDdR0bY/default.jpg" /></a>
 </div> 
```

您可能会注意到我在那里有两张图片，但似乎代码需要从您的管中提取，但我想要一个自定义图像。

我的问题在于，菜单区域位于 youtube 播放器下方，我四处寻找修复，但大多数都针对单独的 iframe。

我尝试将 wmode 添加到 api 调用中，但它似乎不起作用！任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:59:34.180

所以我想通了！您需要将 playerVars 添加到函数中，如下所示；

```
function onYouTubePlayerAPIReady() {
player = new YT.Player('player', {
height: '480',
width: '853',
videoId: '5hewAwxIy9k',
playerVars: {
    controls: 1,
    showinfo: 0 ,
    modestbranding: 0,
    rel: 0,
    wmode: "opaque"
},
events: {
'onReady': onPlayerReady,
'onStateChange': onPlayerStateChange
}
});
} 
```

# ruby - 如何在 google-api-ruby-client 中设置搜索参数

> ID：14467918
> 
> 赞同：0
> 
> 时间：2013-01-22T21:01:27.763
> 
> 标签：ruby, google-drive-api

为了检索文件夹的内容，我必须使用以下网址 [https://www.googleapis.com/drive/v2/files?q='root](https://www.googleapis.com/drive/v2/files?q=) ' 所以我认为它应该通过传递一个附加参数来工作

```
 @client.execute(
    :api_method => @drive.files.list ,
    :parameters =>{q=> "title='root'" }) 
```

但这不起作用

发生错误：{"errors"=>[{"domain"=>"global", "reason"=>"invalid", "message"=>"Invalid Value", "locationType"=>"parameter", " location"=>"q"}], "code"=>400, "message"=>"无效值"}

当我看到请求 uri 时，这很明显

```
https://www.googleapis.com/drive/v2/files?q=title%253D%27levelA%27 
```

我的第一次尝试是用户 URI.encode "title='root'" 这也不起作用。我真的不知道如何保留单引号？

最好的，菲利普

ps：提到的gem的链接[http://rubydoc.info/github/google/google-api-ruby-client/frames](http://rubydoc.info/github/google/google-api-ruby-client/frames)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:40:15.753

好的，现在我找到了一个可行的解决方案，尽管它非常麻烦。

```
search = CGI.escape("q='root'")
u.query = search
u= Addressable::URI.parse "https://www.googleapis.com/drive/v2/files"
req=Google::APIClient::Request.new(:uri=> u)
client.execute req 
```

我希望这可以帮助别人..

# php - __callStatic 方法的神秘行为

> ID：14467919
> 
> 赞同：1
> 
> 时间：2013-01-22T21:01:37.613
> 
> 标签：php

SO question[从非静态方法触发 __callStatic()](https://stackoverflow.com/questions/9469317/weird-behaviour-with-triggering-callstatic-from-non-static-method)的奇怪行为很好，因为它解释了 __callStatic 没有从类本身中调用的奇怪行为（请注意，我在 5.3.3 中没有看到这种行为，但在 5.3 .8 和 5.3.12）。似乎 __callStatic 只能从类外部调用。现在这是事实。但是，如果我真的希望在我的班级中调用 __callStatic，我该怎么办？我应该使用什么语法来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:25:44.637

它不必来自类外部，而不必来自对象上下文（即`$this`类的实例在哪里）。因此，您可以将此调用包装在静态方法中，例如：

```
class TestCallStatic
{
    public function __call($func, $args)
    {
        echo "__call($func)";
    }

    public static function __callStatic($func, $args)
    {
        echo "__callStatic($func)";
    }

    public function test()
    {
        self::_test();
    }
    protected static function _test()
    {
        self::i_am_static();
    }
}

$test = new TestCallStatic();
$test->test(); 
```

输出：

> __callStatic(i_am_static)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:12:18.687

您可以将功能抽象为另一个方法，例如 Class::magicCall($method, $args)，并在 __callStatic() 中调用它。这样，您还可以通过直接调用 Class::magicCall() 来访问该功能。

# c# - Linq 无法投射问题

> ID：14467920
> 
> 赞同：5
> 
> 时间：2013-01-22T21:01:46.820
> 
> 标签：c#, linq, casting

当我尝试跑步时

`InvTotal = g.Sum(d => d.Field<double>("Total")) < 0 ? "W" : "N"`，我得到一个

`Unable to cast object of type 'System.Double' to type 'System.String'`错误。

我需要如何更改代码才能成功编译。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T21:04:19.513

我认为你需要正确的括号。

```
var InvTotal = (g.Sum(d => d.Field<double>("Total")) < 0) ? "W" : "N" 
```

没有它们，编译器将`0 ? "W" : "N"`首先编译，其结果将用于比较。

有时，如果涉及到 ? 操作员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:07:52.317

InvTotal 的类型是什么？我猜它目前是双。如果您将类型更改为字符串，或者删除 InvTotal 的声明并将您的行更改为“var InvTotal = g.Sum ...”，则应该可以工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:40:44.983

我认为在这种情况下，括号没有问题。

问题是类型的`InvTotal`，如果你写`var InvTotal =....`一切都会好的。

对 Maarten 的解释：

在 C# 中，我们不能写这样的东西：

```
int x = 2;
var tmp = x ? "W" : "N"; 
```

如果我们尝试，我们将收到以下错误：

> 错误：“无法将类型 'int' 隐式转换为 'bool'”

C# 不是 C++，其中零表示假，非零值表示真。

所以你可以写这样的东西：

```
g.Sum(d => d.Field<double>("Total")) < 0 ? "W" : "N" 
```

您还可以在三元运算符的第一部分有多个不带括号的逻辑运算符：

```
g.Sum(d => d.Field<double>("Total")) < 0 && 1 == 1 && 2 != 4 && 9 != 0 ? "W" : "N"; 
```

# jsf - 仅对特定页面执行 managedBean 方法

> ID：14467921
> 
> 赞同：1
> 
> 时间：2013-01-22T21:01:46.990
> 
> 标签：jsf, managed-bean

对于一个页面，我可能需要初始化一个巨大的对象列表。现在，我在 @PostConstruct 方法中填充这个列表

是否可以仅在特定页面上执行方法？

或者是否有一个 JSF 标记来简单地执行一个方法，仅此而已？

这对我来说不是一个重要的问题，但必须有一个解决方案。

我正在使用 JSF 2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:05:56.043

您可以将其添加到您的页面：

```
<f:event type="preRenderView" listener="#{backingBean.desiredMethod()}" /> 
```

这将`desiredMethod()`在 RenderView 生命周期阶段之前执行。

# python - 如何按照 Python 教科书的要求实现“类卡”

> ID：14467933
> 
> 赞同：3
> 
> 时间：2013-01-22T21:02:34.490
> 
> 标签：python, class, python-3.x

我目前正在阅读 John Zelle 的 Python Programming: An Introduction to Computer Science 并在第 10 章遇到了障碍。我在理解这个练习的原因和方式方面遇到了一个概念性问题，并且需要一些关于如何解决问题的帮助. 该练习要求我创建一个程序，该程序使用一个名为的类来显示*n*`Card`个卡片，并且需要以下方法。它还应该可以从生成*n*个随机卡片的应用程序中调用：

1.  `__init__(self, rank, suit):`
2.  `getRank(self)`
3.  `getSuite(self)`
4.  `BJValue(self)`
5.  `__str__(self)`

尽管这应该很容易，但我试图实现这个类却碰壁了。我创建了一个简单的应用程序，它会生成一副 52 张卡片，提示用户输入他们想要的卡片数量，然后用这些卡片填充手牌。一旦生成手牌，我就是看不到我会从卡片特定类别中受益的地方。到目前为止，这是我的工作代码：

```
import random

class Card:
    def __init__(self, rank, suite):
        self.rank = rank
        self.suite = suite

    def getRank(self):
        return self.rank

    def getSuite(self):
        return self.suite

    def BJValue(self):
        if self.rank == 'Ace':
            return 1
        elif self.rank == 'Jack' or self.rank == 'Queen' or self.rank == 'King':
            return 10
        else:
        return int(self.rank)

    def __str__(self):
        return ('{0} of {1}'.format(self.rank, self.suite))

def shuffled_deck():
    deck = []
    for suite in ['Clubs', 'Diamonds', 'Hearts', 'Spades']:
        for num in ['Ace', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Jack', 'Queen', 'King']:
            deck.append([num, suite])
    random.shuffle(deck)
    return deck

def main():
    deck = shuffled_deck()
    hand = []
    print('>> Card Generator v1 <<')
    while True:
        try:
            n = int(input('Please enter the number of cards to display (1-7): '))
        except ValueError:
            print('Invalid input, please enter a number!\n')
        else:
            if n < 1 or n > 7:
                print('Please enter a number between 1-7!\n')
            else:
                break
    print('Your hand is:')
    for i in range(n):
        hand.append(deck[i])

main() 
```

因此，一旦我生成了随机*n*张牌，我就看不出使用 Card 类会如何受益，甚至看不到在哪里实现它。由于*n*是 1-7 之间的随机数，因此我需要*n*个变量来存储每个卡片对象，然后将每个变量分配给`Card`. 我可以在不需要特殊类的情况下展示手中的每张卡片以及`hand[i]`我迭代到的位置，但这不是这个项目所期望的。我正在寻找有关如何考虑这个问题的建议，以便我可以使用这个必需的课程。`range(n)``Card`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-22T21:10:23.783

看起来您需要在代码中更改的唯一一件事就是更改该行：

```
deck.append([num, suite]) 
```

到

```
deck.append(Card(num, suite)) 
```

这使`deck`变量成为 52 个`Card`对象的列表。这很有用，因为`Card`对象具有一些内置功能，而两个项目的列表（如`[num, suite]`）没有。

* * *

两个例子：如果你添加行

```
print hand 
```

在您的代码之后，您当前的代码将打印类似

```
[["Jack", "Clubs"], ["9", "Spades"]] 
```

而您的新代码将打印

```
[Jack of Clubs, 9 of Spades] 
```

（这条线`print "\n".join(map(str, hand)))`可能更接近你在实践中想要的）。您还可以通过以下行获得您手牌的总二十一点值：

```
sum(c.BJValue() for c in hand) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-09T04:04:28.780

我认为 python 中的任何卡片类都应该有一个使用 u"\u2263" 等的 __unicode__ 方法——只是为了好玩。我还建议使用 @functools.total_ordering 以及 __eq__ 和 __gt__ 方法来装饰它，以便可以比较卡片；此外，“排序”内置将适当地对卡片列表进行排序。

# php - Apache 在 30 秒后抛出 500

> ID：14467934
> 
> 赞同：3
> 
> 时间：2013-01-22T21:02:34.943
> 
> 标签：php, apache, timeout

我在专用 VPS 上运行 Apache2 和 PHP5。

我有一个脚本应该在 20-50 秒内完成。它工作得很好，但如果由于它选择的行而需要超过 30 秒，它会立即终止脚本并说：

> “服务不可用 - 服务暂时不可用。请稍后再试。”

我有`max_execution_time=60`，`max_input_time=60`并且`memory_limit=256M`在我的 php.ini 中。

在 apache2.conf 中，我有`Timeout=300`.

在脚本本身中，我也在使用`set_time_limit(0); ignore_user_abort(true); ini_set('max_execution_time', 0); ini_set('memory_limit', '512M');`

无论我更改什么脚本，只要加载超过 30.00 秒，脚本就会死掉，并且我的任何日志中都没有出现任何内容。

关于尝试其他设置的任何建议？

此脚本仅供内部使用，最终将从命令行运行，但我更喜欢从浏览器调试/测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:25:30.000

您列出的错误：“服务不可用 - 服务暂时不可用。请稍后再试。” 听起来不像是 500 响应，听起来像 503。您确定要返回 500 吗？503的[原因](https://stackoverflow.com/questions/6299086/how-to-detect-cause-of-503-service-temporarily-unavailable-error-and-handle-it)会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:23:16.543

您是否安装了 Mod_Security 或 php-suhosin？这些可能会干扰默认配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:09:07.850

内部服务器错误。检查您的所有指令是否正确。如果您有一个**.htaccess**文件，请确保您没有任何拼写错误。除此之外，您可以调试脚本。您可能会更改触发错误或与服务器上其他内容冲突的设置。

# c# - 获取缓存实体的对象上下文

> ID：14467939
> 
> 赞同：1
> 
> 时间：2013-01-22T21:03:13.427
> 
> 标签：c#, entity-framework, caching, objectcontext

我想手动创建与从缓存中获取的对象的实体关系。

```
Car car = Cache.GetCarById(1); // takes this from cache
SteeringWheel steeringWheel = Cache.GetSteeringWheelById(1); //takes this from DB 
                                                             //also saves in cache
car.SteeringWheel = steeringWheel; 
```

关于上述任务

> 无法定义这两个对象之间的关系，因为它们附加到不同的 ObjectContext 对象。

我尝试了以下方法：

*   `steeringWheel`保存后从缓存返回（因此为同一实体发出 2 个缓存请求）
*   在缓存之前将每个实体从它自己的上下文中分离出来

以上都不起作用。如果我能够获得上下文，`car`我会附加`steeringWheel`到它，但是......什么上下文？上下文是否与缓存中的对象一起保存，我该如何获取它？

请注意，我真的不需要上下文，我只是按原样显示这些数据。

**LE**：上下文是跨一个http请求共享的，从静态方法使用

```
public static myEntities Context
    {
        get
        {
            string ocKey = "ocm_" + HttpContext.Current.GetHashCode().ToString("x");
            if (!HttpContext.Current.Items.Contains(ocKey))
                HttpContext.Current.Items.Add(ocKey, new myEntities());
            return HttpContext.Current.Items[ocKey] as myEntities;
        }
    } 
```

# perl - 从另一个变量中获取变量的值

> ID：14467940
> 
> 赞同：0
> 
> 时间：2013-01-22T21:03:20.873
> 
> 标签：perl

你能帮我确定正确的 $string = line 以包含 4165867111 的 partial_phone 吗？

```
sub phoneno {
my ($string) = @_;
$string =~  s/^\+*0*1*//g;
return $string;
}

my $phone = "<sip:+4165867111@something;tag=somethingelse>";

my $partial_phone = phoneno($phone); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:12:19.720

```
$string =~ s{
    \A          # beginning of string
    .+          # any characters
    \+          # literal +
    (           # begin capture to $1
        \d{5,}  # at least five digits
    )           # end capture to $`
    \@          # literal @
    .+          # any characters
    \z          # end of string
}{$1}xms; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:10:04.063

您的替换以 a 开头`^`，这意味着它不会执行替换，除非您的模式的其余部分与您的字符串的开头匹配。

有很多方法可以做到这一点。怎么样

```
my ($partial) = $phone =~ /([2-9]\d+)/;
return $partial; 
```

这将返回任何不以 0 或 1 开头的数字字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-22T21:27:39.583

这将捕获之前的所有数字`@`：

```
use strict;
use warnings;

sub phoneno {
    my ($string) = @_;
    my ($phoneNo) = $string =~ /(\d+)\@/;
    return $phoneNo;
}

my $phone = '<sip:+4165867111@something;tag=somethingelse>';

my $partial_phone = phoneno($phone);

print $partial_phone; 
```

输出：

```
4165867111 
```

# mongodb - 点击事件更新模板

> ID：14467942
> 
> 赞同：1
> 
> 时间：2013-01-22T21:03:38.497
> 
> 标签：mongodb, meteor

我正在研究流星示例。我在链接上的点击事件中获得一个标签的值。该值与文档“pet”或“zoo”内的一个集合中存在的值相同。我想使用这个值来过滤模板上的内容。

一个最小的例子：

```
 {{#each Animal}}
        <div>
          <span> {{pet}} </span> 
        </div>
        <div>
          <span> {{zoo}} </span> 
        </div>
    {{/each}} 
```

点击后：

```
{{#each Animal}}
        <div>
          <span> {{zoo}} </span> 
        </div>
    {{/each}} 
```

在这种情况下，当我获得“zoo”中存在的值时，我只想使用包含 doc zoo 上元素的所有 span 更新模板，并且所有与 pet 相关的内容都消失了。

对 mongodb 的查询运行良好，我的问题是我有点困惑。

我应该使用助手吗？

**非常感谢。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T23:05:30.323

让我们看看我是否正确理解了您的问题。

您应该使用 Session 变量来存储您正在执行的操作。然后添加一个模板`if`并在此标签内打印您当时想要显示的任何内容。

让我们做一个最小的例子：

```
<template name="showAnimalsTemplate">
   {{if showAnimals}}
   {{#each Animal}}
      <div>
        <span> {{pet}} </span> 
      </div>
      <div>
        <span> {{zoo}} </span> 
      </div>
   {{/each}}
   {{/if}}
   {{if showZoo}}
   {{#each Animal}}
      <div>
        <span> {{zoo}} </span> 
      </div>
   {{/each}}
   {{/if}} 
```

按照此示例，您在客户端 javascript 中添加如下内容：

```
 Template.showAnimalsTemplate.showAnimals = function(){
     if( Session.get('action') == 'showingTheZoo')
           return true;
     return false;
 }

 Template.showAnimalsTemplate.showZoo = function(){
     if( Session.get('action') == 'showingTheZoo')
           return true;
     return false;
 } 
```

不要忘记在点击事件中设置会话值。

```
Session.set('action', 'showingTheZoo'); 
```

# c# - C# 列出控件中的所有方法

> ID：14467943
> 
> 赞同：1
> 
> 时间：2013-01-22T21:03:57.857
> 
> 标签：c#, reflection, user-controls

如果之前有人问过并回答过这个问题，我深表歉意，但我无法找到答案。

我知道如何浏览控件集合并获取所有控件的列表，包括子控件。

```
 void printControlTree(Control ctl, int indent)
    {
      string pad = "";
      for(int i=0; i < indent; i++)
      {
        pad += "   ";
      }

      Print(pad + "=> " + ctl.Name);

      if (ctl.Controls != null && ctl.Controls.Count > 0)
      {
        foreach (Control c in ctl.Controls)
        {
            printControlTree(c, indent+1);
        }
      }
     } 
```

我想做的是获得每个控件和子控件中所有方法的列表。这可能吗？我会这样认为，因为有 Control.ControlCollection.Find 方法可以按名称在控件中查找特定方法，但我想要列出所有方法而不提前知道它们的名称。此外，是否可以获得控件中所有内容的列表：方法、输入字段等？您的帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T21:09:18.053

```
static void PrintMethods(Object o) {

    Type t = o.GetType();
    MethodInfo[] methods = t.GetMethods();
    foreach(MethodInfo method in methods) {

        Print( method.Name );
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:23:26.743

首先，我们将从一个返回控件的所有子控件的方法开始（递归地），而不仅仅是打印它们。

```
public static IEnumerable<Control> GetAllControls(Control control)
{
    Stack<Control> stack = new Stack<Control>();
    stack.Push(control);

    while (stack.Any())
    {
        var next = stack.Pop();
        yield return next;
        foreach (var child in next.Controls.OfType<Control>())
        {
            stack.Push(child);
        }
    }
} 
```

接下来，我们将编写一个方法，给定一系列对象，将其转换为所有这些对象的所有方法的序列：

```
public static IEnumerable<MethodInfo> GetMethods<T>(IEnumerable<T> sequence)
{
    return sequence.GroupBy(obj => obj.GetType())
        .SelectMany(group => group.Key.GetMethods());
} 
```

现在我们只调用它们：

```
foreach(var methodInfo in GetMethods(GetAllControls(someControl))
{
    //print method name
} 
```

如果您认为您会使用这些方法足够多，您可能希望将它们转换为扩展方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-22T21:07:05.940

您可以在此处找到列出类成员的示例：

[查看类型信息](http://msdn.microsoft.com/en-us/library/t0cs7xez.aspx)

```
using System;
using System.IO;
using System.Reflection;

class Mymemberinfo
{
    public static void Main()
    {
        Console.WriteLine ("\nReflection.MemberInfo");
        // Gets the Type and MemberInfo.
        Type MyType = Type.GetType("System.IO.File");
        MemberInfo[] Mymemberinfoarray = MyType.GetMembers();
        // Gets and displays the DeclaringType method.
        Console.WriteLine("\nThere are {0} members in {1}.",
            Mymemberinfoarray.Length, MyType.FullName);
        Console.WriteLine("{0}.", MyType.FullName);
        if (MyType.IsPublic)
        {
            Console.WriteLine("{0} is public.", MyType.FullName);
        }
    }
} 
```

如果你已经有一个对象（比如一个控件），你可以像这样绕过上面的一些代码：

```
using System;
using System.IO;
using System.Reflection;

class Mymemberinfo
{
    public static void Main()
    {
        // Whatever kind of control you are using:
        Object l_control = new Object();

        Console.WriteLine ("\nReflection.MemberInfo");
        // Gets the Type and MemberInfo.

        // ----- Call l_control.GetType();
        Type MyType = l_control.GetType();
        MemberInfo[] Mymemberinfoarray = MyType.GetMembers();
        // Gets and displays the DeclaringType method.
        Console.WriteLine("\nThere are {0} members in {1}.",
            Mymemberinfoarray.Length, MyType.FullName);
        Console.WriteLine("{0}.", MyType.FullName);
        if (MyType.IsPublic)
        {
            Console.WriteLine("{0} is public.", MyType.FullName);
        }
    }
} 
```

您可以在 MSDN 网站上阅读有关反射的更多信息：

[.NET Framework 中的反射](http://msdn.microsoft.com/en-us/library/f7ykdhsy.aspx)

MSDN 上的文章包括如何使用每个功能的完整描述和示例。

# javascript - Angularjs 使用自定义指令 (mySlide) 为 ngClick + ngShow 设置动画

> ID：14467945
> 
> 赞同：1
> 
> 时间：2013-01-22T21:03:59.810
> 
> 标签：javascript, html, angularjs, directive

我试图获得与`ng-click`+相同的终极功能`ng-show`，除了我希望节目滑入而不是通过切换突然出现`display: block/none;`。我有我需要的 jQuery 动画，并且我已经设置了`ng-click`. 我有两个问题，但第二个可能是第一个的结果：

### 问题 1

`ng-click`不改变 的值`aside_users`。我看到了[SO#12202067](https://stackoverflow.com/q/12202067/758177)，这似乎是一个类似的情况，但我不明白他们的[自定义指令](http://jsfiddle.net/F3nfK/23/)如何/为什么工作而本机`ng-click`没有。

我看到了`scope: { … }`after `restrict: 'A',`，但这似乎使`$scope`新创建的 DOM 元素中的值可用（我的元素已经存在并且显示得很好，但没有发生触发器/事件）。

*信息框.html*

```
<aside
  class="users"
  ng-include src="'views/users.html'"
  my-slide={"direction":"left","condition":"aside_users"}
></aside>

<i
  class="icon icon-user"
  ng-click="aside_users=!aside_users"
  ng-init="aside_users=false"
></i> 
```

上面的代码是一个`$compile`'d 模板，在模板中的其他地方我打印出 $scope 参数的值`aside_users`（prints `false`）。

 ~~~~### 问题 2~~ 

~~`my-slide`似乎没有被启动/触发（`'elm: ', elm`Chrome 的控制台中没有出现的日志记录）。我验证了`directives.js`在我的`index.html`页面中链接。~~

**编辑**我记得要链接`directives.js`，`index.html`但我忘了将它添加到资源数组中`app.js`。

**[Plunkr](http://embed.plnkr.co/DNoeXk)**

PS我不确定是否`<aside attr={object}>`严格有效，但合法的浏览器似乎在测试用例中接受它（没有费心检查IE）。我的替代计划是使用 2 个属性：`<foo my-slide="direction" my-condition="boolean"></foo>`~~

# javascript - jQuery 或 JavaScript 在元素中使用嵌入字符串作为函数引用

> ID：14467947
> 
> 赞同：0
> 
> 时间：2013-01-22T21:04:14.680
> 
> 标签：javascript, function

是否有可能让我们说，我有它的链接看起来像

```
<a href="something/" class="something" data-callback="thisFunction">
<a href="something/" class="something" data-callback="thatFunction">
<a href="something/" class="something" data-callback="anotherFunction">
<a href="something/" class="something" data-callback="">

<script>
     $('.something').click(function(e)
     {
        e.preventDefault();
        var cb = $(this).data('callback');
        if(cb !== undefined && cb !== null && cb !== '')
        {
           //somehow use cb as a means to call another function
           //similar in effect to calling "thatFunction();"
        }
     });
    function thisFunction()
    {
       //code
    }
    function thatFunction()
    {
       //code
    }
    function anotherFunction()
    {
       //code
    }
</script> 
```

如果可能的话，我将如何实现使其工作，以及该类型调用的实际参考是什么，例如如果我忘记了，将来​​需要这样做的方法是什么，希望我能记住该方法是什么打电话给我，我可以查一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:05:12.957

您可以使用以下内容：

```
window[cb](); 
```

或者为了安全起见：

```
typeof window[cb] === "function" && window[cb](); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:09:59.080

在您的示例中，您可以从窗口对象调用此回调函数。像window[cb]这样的东西。但这不是分配此类全局函数的好习惯。我建议您将回调包装在某个对象中。

# asp.net-mvc - 在 ASP MVC/Entity Framework 中使用通用数据类型进行搜索

> ID：14467952
> 
> 赞同：1
> 
> 时间：2013-01-22T21:04:35.460
> 
> 标签：asp.net-mvc, entity-framework

下面是我在使用实体框架构建的 WCF 服务参考中使用的代码。如您所见，现在我一遍又一遍地使用相同的代码。是否有一种语法可以让我用泛型类型或其他可以减少使用的代码量的方法替换实体？

```
 var aI = (from AgentIdentification s in _db.AgentIdentification
                  where s.SymetraNumber == sNum
                  select s);

        foreach (var record in aI)
        {
            _db.AgentIdentification.DeleteObject(record);
        }

        _db.SaveChanges();

        var aG = (from Agent s in _db.Agent
                  where s.SymetraNumber == sNum
                  select s);

        foreach (var record in aG)
        {
            _db.Agent.DeleteObject(record);
        }

        _db.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:14:55.740

我相信这就是你想要的。

```
PerformChanges<YourDbObject, AgentIdentification>(x => x.AgentIdentification, sNum, _db);
PerformChanges<YourDbObject, Agent>(x => x.Agent, sNum, _db);

private void PerformChanges<DbType,TCollection>(Func<DbType,DbSet<TCollection>> FetchDbSetLambda, int sNum, DbType your_db)
        {
            var aI = (from s in FetchDbSetLambda(your_db)
                      where s.SymetraNumber == sNum
                      select s);

            foreach (var record in aI)
                FetchDbSetLambda(your_db).DeleteObject(record);
        } 
```

# git - 查看文件先前版本差异的速记

> ID：14467953
> 
> 赞同：19
> 
> 时间：2013-01-22T21:04:43.353
> 
> 标签：git, diff

我可以很容易地找出自上次提交以来文件的更改，`git diff HEAD^ -- <filename>`但是*是否有等效的速记来查看自上次提交以来特定文件的差异*，无论此后发生了多少次提交？或者返回那个特定文件的 N 次提交？

**上下文：**我在一个文件中发现了一个错误，我想在它潜入时追踪它。获取特定文件的日志报告很容易，`git log -<n> <filename>`只显示包含对该文件的更改的提交。很明显，我可以从该`log`报告中复制并粘贴 SHA，但我真正想要的是能够执行类似`git diff ^ -- <filename>`or的操作`git diff ~2 -- <filename>`。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-22T21:09:12.910

```
$ git log -p <filename> 
```

将向您显示日志消息以及触及命名文件的每个提交的差异。

要仅显示与以前版本的差异，只需在日志历史记录中询问一步：

```
$ git log -1 -p <filename> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-26T23:25:01.050

您可以使用`git log`格式化来获取以前提交到文件的哈希值。例如，

```
git log --pretty=format:'%h' -1 --skip=1 <filename> 
```

将使您获得第二次到最后一次提交以触摸特定文件。事实上，如果您不指定文件名，这将使您在整个存储库中获得倒数第二次提交。要获取较旧的哈希，您可以设置一个调用 shell 函数的 git 别名，如下所示：

```
[alias]
    prior-hash = "!ph() { git log --pretty=format:'%h' -1 --skip=$1 $2; }; ph" 
```

要使用它，您需要输入类似 的`git prior-hash n <filename>`内容，其中 n 是文件的第 (n+1) 个最新版本。所以 1 将是对文件的倒数第二次提交，2 将是倒数第三次，以此类推，而 0 将是最近一次提交到该文件。同样，如果您想从整体上检查 repo，文件名是可选的。

我相信你可以弄清楚如何从那里构建一个 diff 命令：

```
[alias]
    prior-hash = "!ph() { git log --pretty=format:'%h' -1 --skip=$1 $2; }; ph"
    diff-prev-easy = "!dp() { git diff $(git prior-hash $1 $2).. $2; }; dp" 
```

这将与先前哈希别名类似地使用，`git diff-prev-easy n <filename>`. 这会将第 (n+1) 个最后修订版与文件的最新修订版进行比较。如果您想将第 (n+1) 个最后一个修订版与第 n 个最后一个修订版进行比较，这是一个简单的更改：

```
[alias]
    prior-hash = "!ph() { git log --pretty=format:'%h' -1 --skip=$1 $2; }; ph"
    diff-prev = "!dp() { git diff $(git prior-hash $1 $2)..$(git prior-hash $(($1 - 1)) $2) $2; }; dp" 
```

再次以相同的方式使用它：`git diff-prev n <filename>`

但是，需要注意的一个潜在问题是`git log`按时间顺序列出提交，这可能不是您想要的。考虑这段历史：

```
1 - 2 - - - 4 - 5   master
      \       /
        3 - -       develop 
```

正如预期的那样，我们的`git diff-prev 1`命令将产生提交 4 和 5 之间的差异。但是`git diff-prev 2`会显示提交 3 和 4 之间的差异，这可能是不可取的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T21:50:14.887

`git blame`应该可以让您很快到达目的地。

# azure - “远程服务器返回错误：未找到”翻译 API Windows phone 8

> ID：14467954
> 
> 赞同：0
> 
> 时间：2013-01-22T21:04:44.097
> 
> 标签：azure, microsoft-translator

我正在尝试找出一种方法来制作 MSDN 博客中的教程，我在 Windows Phone 8 应用程序上使用 Microsoft Translator（Azure 市场）。这是链接：http: [//blogs.msdn.com/b/translation/p/windowsphone8.aspx](http://blogs.msdn.com/b/translation/p/windowsphone8.aspx)。我使用完全相同的代码，有时我会收到：“远程服务器返回错误：未找到”

我真的不明白我要做什么！有人可以帮我找到一种在 Windows 手机上使用该翻译 API 的稳定方法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-26T01:52:58.007

根据原始海报，问题出在需要提供给 API 服务的凭据上。

# vpn - 使用 OpenBSD（主机到网关）配置 IPSEC VPN 连接

> ID：14467955
> 
> 赞同：0
> 
> 时间：2013-01-22T21:04:45.907
> 
> 标签：vpn, openbsd

我正在尝试将带有 OpenBSD 的 IPsec VPN 连接配置为 VPN 服务器，其中 3-DES 用于加密，HMAC-SHA-1 用于完整性，PresharedKey 用于身份验证。

我的问题是：

*   如果有可能用 OpenBSD 来做，谁能给我一个工作教程来做这个？
*   如果使用 OpenBSD 无法做到这一点，任何人都可以为此提供其他解决方案和教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:29:23.343

过去我发现[这些指南](http://www.kernel-panic.it/openbsd/vpn/index.html)非常有用。
如果您想将 l2tp/ipsec 与 npppd 一起使用，请查看[这篇致命的文章](http://undeadly.org/cgi?action=article&sid=20120427125048)。
最后，如果您打算使用 openvpn，我们[在我们的网站上](http://www.2f30.org/guides/openvpn.html)整理了一份小指南。

# php - 在 PHP 中从 MySQL 查询创建数组

> ID：14467956
> 
> 赞同：-1
> 
> 时间：2013-01-22T21:04:47.220
> 
> 标签：php, mysql, arrays

抱歉 Q 略有重复，但我认为以前的答案现在已经贬值了（我已经看到在 PHP 5.3 中你需要使用 MySQLi_fetch_array()）

我正在使用 jpgraph 并尝试从 MySQL 数据库中提取数据。我有以下代码可以提取我需要的数字，当我回显结果时，它会一一吐出答案，但不会将其放入数组中。

我正在尝试替换一条线

```
$ydata = array(1,2,3,4,5,6,7);

//query
$sql = "SELECT CONCAT( 'Week ', WEEK( TimeofCompletion ) , ' ', YEAR( TimeofCompletion ) ) AS Week, Count( * ) AS VolumeOfAnswers
FROM table01
GROUP BY WEEK( TimeofCompletion ) , YEAR( TimeofCompletion ) 
ORDER BY TimeofCompletion";

$ydata = array();

while($row = mysql_fetch_array($sql)){
// Create a temporary array
 $temp = array();

 $temp[] = "".$row['VolumeOfAnswers']."";
$ydata = '['. implode(', ', $temp) . ']';   
} 
```

有什么建议我将如何按行将输出放入数组中？

问候莫迪斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:10:52.510

```
 $temp[] = "".$row['VolumeOfAnswers'].""; //what this suppose to do? 
```

我假设你想要引号我会在里面添加单引号

```
 $temp[] = "'".$row['VolumeOfAnswers']."'"; 
```

否则你根本不需要双引号，所以我会删除它们。之后，您的数组将保存数据库中的值。

根据[文档](http://php.net/manual/en/function.mysql-fetch-array.php) **mysql_fetch_array**已弃用，您应该使用 PDO 或 MySQLi。但是，如果您仍然想使用它，我建议您改用**mysql_fetch_assoc**。

**现在关于这个问题：**

```
 while($row = mysql_fetch_array($sql)){
  // Create a temporary array
  $temp = array();

  $temp[] = "".$row['VolumeOfAnswers']."";
  //why is this here? should be outside of while loop shouldnt it?
  $ydata = '['. implode(', ', $temp) . ']';   
 } 
```

你的 $ydata 总是被覆盖并且只保存**$temp**数组的最后一个元素。将 $ydata 移出 while 循环或使用`array_merge($ydata, $temp);`

# php - 用于检查列值并执行新操作的 mySQL 函数

> ID：14467958
> 
> 赞同：2
> 
> 时间：2013-01-22T21:04:51.120
> 
> 标签：php, mysql

是否可以在 mySQL 中编写一个函数来检查 SELECT 查询的值，如果它！= 0，继续运行该函数并添加到结果数组中？

我有几个条目标记为`related_id`=`0` 其余的附有实际的正数。

我正在尝试创建一个将不断循环通过 sql 函数的单个查询，检查并查看检索到的`related_id`结果是否为 0。如果不是，则它将再次运行，将新检查的行添加到结果数组并继续直到找到一个 0。

DB的设置方式，总是会出现0，并且会通过id进行搜索，所以应该只有一个结果。

我正在使用稍作修改的标记系统。

```
keywords_id | keyword  | related_id
------------------------------------
1           | sports   | 0
2           | baseball | 1
3           | football | 1
4           | pitchers | 2 
```

如果我传入`related_id`=`2`我希望返回一个产生的数组：

```
array 
[0]
   keyword => 'sports'
   keywords_id => '1'
   related_id => '0'
[1]
   keyword => 'baseball'
   keywords_id => '2'
   related_id => '1'
[2]
   keyword => 'pitcher'
   keywords_id => '4'
   related_id => '2' 
```

我尝试了使用 IF 和 THEN 的运气，但我只是没有看到足够的示例，而且很难在网上找到可靠的教程。谢谢！

```
SELECT k.* 
FROM keywords k
WHERE keywords_id = 2 
```

上面的查询基本上会启动它。`keywords_id`是`related_id`通过的。因此以上将返回`keywords_id: 2 |keyword: baseball |related_id: 1`

因为related_id 1 不是0，所以我需要再次运行它。

我意识到这可以通过一些额外的查询在 PHP 中完成……我应该这样做吗？我认为它可以在阅读有关函数后在 mySQL 中完成。我只是想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:36:07.737

我对上面示例的理解 - 需要检查所有记录，直到找到匹配项（上面的示例 related_id = 2 ）。

如果是这样，您可以尝试使用 mysql 游标[http://dev.mysql.com/doc/refman/5.0/en/cursors.html](http://dev.mysql.com/doc/refman/5.0/en/cursors.html) 来循环结果集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T22:20:55.060

MySQL 不支持从函数返回数组。建议创建一个表（或可能是一个临时表）来保存结果，然后编写一个存储过程来填充它。

不确定您要达到的具体目标，但可能与此类似？

```
CREATE TABLE results (keywords_id INT, keyword VARCHAR(2000), related_id INT);

CREATE PROCEDURE populateResults(IN keyword_id_in INT)
BEGIN
  DECLARE num_results INT;
  DECLARE max_results INT;
  DECLARE next_keyword_id INT;
  SET next_keyword_id = keyword_id_in;
  SET max_results = 5;
  SET num_results = 0;

  DELETE FROM results;

  the_loop: LOOP
    INSERT INTO results
    SELECT keywords_id, keyword, related_id
    FROM keywords
    WHERE keywords_id = next_keyword_id;

    SELECT related_id
    FROM keywords
    WHERE keywords_id = next_keyword_id
    INTO next_keyword_id;

    IF (next_keyword_id = 0) || (num_results >= max_results) THEN
      LEAVE the_loop;
    END IF;
    SET num_results = num_results + 1;
  END LOOP the_loop;
END 
```

请参阅[SQL Fiddle 演示](http://sqlfiddle.com/#!2/a3e82/1)

# ruby-on-rails-3 - 链接到当前页面轨道

> ID：14467959
> 
> 赞同：0
> 
> 时间：2013-01-22T21:04:54.220
> 
> 标签：ruby-on-rails-3, hyperlink, link-to

我想知道链接到同一页面上的属性的语法是什么

我有一个日期列表

```
 <ul>
     <% @response.each_pair do |date, movie| %>
      <li><%= link_to date_format(date), date, :class => 'scroll_to' %></li>
     <% end %>
   </ul> 
```

然后这些在每个日期下面都有电影，就像这样

```
<% @response.each_pair do |date, movie| %>
    <h3 class="resultTitle fontSize13">Available on&nbsp;<%= date_format(date) %></h3>
    <% movie.each do |m| %>
      <div class="thumbnail clearfix">
        <img class="pull-left" src=<% if m.image_link %> <%= m.image_link %> <% else %> "/assets/noimage.jpg" <% end %>>
        <div class="caption pull-right">
          <%= link_to m.name, m.title_id, :class => 'resultTitle fontSize11' %>
          <p class="bio"><%= m.bio %></p>
          <p class="resultTitle">Cast</p>
          <p class="bio"><%= m.cast.join(", ") unless m.cast.empty? %></p>
          <%= link_to "Remind me", reminders_path(:title_id => m.title_id), :method => :post, :class => 'links button' %>
        </div>
      </div>
    <% end %>
  <% end %> 
```

我想要实现的是，当用户单击列表中的日期时，它将带他们到该日期，电影在同一页面上

我每个日期的属性是

```
"release_date" 
```

我是否需要链接到那个，也许还有一段 Jquery 才能向下滚动到那个日期？还是会一步跳到日期？

任何建议表示赞赏，我之前已经链接到其他页面，但不是这样的相同页面

编辑

我已经尝试过了，但页面只是重新呈现

```
<li><%= link_to date_format(date), params.merge(:release_date => 'release_date'), :class => 'scroll_to' %></li> 
```

我在正确的轨道上吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:14:29.390

您只需为您的日期提供一个唯一标识符并链接到您列表中的那个。例如下面我们给每个日期的 h3 一个相对于日期对象的 id。浏览器知道如何处理内部链接，并且会简单地跳转到相应的标识符。请注意，当您单击链接时，您要链接到的字段的 id 是如何附加到 url 的末尾的。

```
<ul>
   <%- index = 0 %>
   <% @response.each_pair do |date, movie| %>
     <%- index += 1 %> 
     <li><%= link_to date_format(date), "##{index}", :class => 'scroll_to' %></li>
   <% end %>
</ul>
<%- index = 0 %>
<% @response.each_pair do |date, movie| %>
    <%- index += 1 %>
    <h3 class="resultTitle fontSize13" id="<%= index %>">Available on&nbsp;<%= date_format(date) %></h3>
    <% movie.each do |m| %>
      <div class="thumbnail clearfix">
        <img class="pull-left" src=<% if m.image_link %> <%= m.image_link %> <% else %> "/assets/noimage.jpg" <% end %>>
        <div class="caption pull-right">
          <%= link_to m.name, m.title_id, :class => 'resultTitle fontSize11' %>
          <p class="bio"><%= m.bio %></p>
          <p class="resultTitle">Cast</p>
          <p class="bio"><%= m.cast.join(", ") unless m.cast.empty? %></p>
          <%= link_to "Remind me", reminders_path(:title_id => m.title_id), :method => :post, :class => 'links button' %>
        </div>
      </div>
    <% end %>
<% end %> 
```

对于添加的 JQuery 转换，您可以替换

```
<li><%= link_to date_format(date), "##{index}", :class => 'scroll_to' %></li> 
```

和

```
<li><%= link_to_function date_format(date), "$('html, body').animate({scrollTop:$('##{index}').offset().top }, 'slow');", :class => 'scroll_to'%></li> 
```

以上内容并不完全是一种 DRY 方法，但要从中抽象出来的重要一点是，您要链接到页面上其他地方的唯一 ID，而不是代码本身。

# sql-server - 执行更新操作时如何从触发器中获取存储过程名称？

> ID：14467961
> 
> 赞同：9
> 
> 时间：2013-01-22T21:04:59.697
> 
> 标签：sql-server

> **可能重复：**
> [触发器是否可以找到修改数据的存储过程的名称？](https://stackoverflow.com/questions/4261278/is-it-possible-for-a-trigger-to-find-the-name-of-the-stored-procedure-that-modif)

我有一个带有触发器（更新时）的表。执行触发器时，我想知道更新相关表的存储过程的名称。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-22T21:21:04.360

这并不总是 100% 可靠，有时它会捕获外部过程调用，即使该过程调用了内部过程。但是您至少可以了解用户在触发器中所调用的内容。

```
ALTER TRIGGER dbo.whatever
ON dbo.something
FOR UPDATE
AS
BEGIN
    ... other trigger logic

    DECLARE @ExecStr varchar(50), @Qry nvarchar(255)

    CREATE TABLE #inputbuffer 
    (
      EventType nvarchar(30), 
      Parameters int, 
      EventInfo nvarchar(255)
    )

    SET @ExecStr = 'DBCC INPUTBUFFER(' + STR(@@SPID) + ')'

    INSERT INTO #inputbuffer 
    EXEC (@ExecStr)

    SET @Qry = (SELECT EventInfo FROM #inputbuffer)

    SELECT @Qry AS 'Query that fired the trigger', 
     SYSTEM_USER as LoginName, 
     USER AS UserName, 
     CURRENT_TIMESTAMP AS CurrentTime

   -- of course you can store this somewhere instead of select
END 
```

从 Vyas K 窃取：http: [//vyaskn.tripod.com/tracking_sql_statements_by_triggers.htm](http://vyaskn.tripod.com/tracking_sql_statements_by_triggers.htm)

您可能还想查看这个问题，它有一个与使用相关的答案`sys.dm_exec_query_stats`- 您可以使用 公开的对象 id 追溯过程名称`sys.dm_exec_sql_text`，并且可以将最近的调用限制`GETDATE()`为“最近”的指南。还有一个使用扩展事件来完成它的冗长示例。

[创建触发器以记录影响表的 SQL？](https://stackoverflow.com/questions/3094735/create-trigger-to-log-sql-that-affected-table)

或者这些使用`CONTEXT_INFO`（但这需要更改所有更新表的存储过程）：

[查找触发触发器的查询](https://stackoverflow.com/questions/14456306/find-query-that-fired-a-trigger/)

[触发器是否可以找到修改数据的存储过程的名称？](https://stackoverflow.com/questions/4261278/is-it-possible-for-a-trigger-to-find-the-name-of-the-stored-procedure-that-modif)

最后，您可以查看这些帖子以获取一些想法：

[http://www.thecodepage.com/post/TIP-A-Call-Stack-in-SQL-Server.aspx](http://www.thecodepage.com/post/TIP-A-Call-Stack-in-SQL-Server.aspx)

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2013-01-22T21:09:21.660

这是不可能的 - 无论您的要求如何，都没有快速的解决方法。触发器与更新耦合，它与 SP 没有关系（甚至可能不存在）。在该级别，您无法使用堆栈跟踪。

# javascript - 4 navlinks需要关闭所有内容并打开自己的

> ID：14467962
> 
> 赞同：0
> 
> 时间：2013-01-22T21:05:00.993
> 
> 标签：javascript, hyperlink

我有一个几乎可以工作的脚本，但我不太了解脚本，使其无法在所有链接上工作。

当您查看我的小提琴并单击**前两个**链接时，一切正常。当您单击其他两个时，其他内容字段不会关闭。我需要关闭所有，只打开一个..

[http://jsfiddle.net/fourroses666/8y7Sr/100/](http://jsfiddle.net/fourroses666/8y7Sr/100/)

这是脚本的一部分：

```
$('#activator-werkwijze').click(function(){
    $('#overlay-werkwijze').fadeIn('fast',function(){
        $('#box-werkwijze').animate({'bottom':'0px'},800);
    });
     $('#box-bureau').animate({'bottom':'-600px'},800,function()
             {
        $('#overlay-bureau').fadeOut('fast');
    });
}); 
```

我实际上不需要覆盖

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T23:10:08.207

这是有效的脚本，（覆盖没用）jsfiddle.net/8y7Sr/126/

# php - 将已创建的属性分配给 magento 的所有属性集

> ID：14467965
> 
> 赞同：0
> 
> 时间：2013-01-22T21:05:03.067
> 
> 标签：php, magento, attributes

在网上无休止的搜索后，我终于放弃了这件事。我试图为 magento （在我的情况下为 1.6.2.0 ）制作一个脚本，以便以编程方式将已创建的属性（在我的情况下为“techpage”）分配给“常规”组中的所有属性集。

从一开始就进行 Goog 计划可以节省大量时间，我正在努力学习这一点！

有人可以告诉我我做错了什么吗？

```
<?php
require_once('app/Mage.php'); //Path to Magento
umask(0);
Mage::app('default'); // Change default to whatever store you want to run

$model=Mage::getModel('eav/entity_setup','core_setup');
$attributeId=$model->getAttribute('catalog_product','techpage');

$allAttributeSetIds=$model->getAllAttributeSetIds('catalog_product');
foreach ($allAttributeSetIds as $attributeSetId) {
try{
$attributeGroupId=$model-    >getAttributeGroup('catalog_product',$attributeSetId,'General');
}
catch(Exception $e)
{
$attributeGroupId=$model->getDefaultArrtibuteGroupId('catalog/product',$attributeSetId);
}
$model-   >addAttributeToSet('catalog_product',$attributeSetId,$attributeGroupId,$attributeId);
}
?> 
```

当我在浏览器中运行它时，该死的瘦子吐出来了

> “致命错误：未捕获的异常‘PDOException’

带消息

> 'SQLSTATE [23000]：完整性约束违规：1452 无法添加或更新子行：外键约束失败“

当谈到 php 和 magento 时，我并不完全是你所说的“棚子里最锋利的工具”，但在我的搜索中，我发现很多像我一样的新手在寻找同样的东西，但对这个困境没有答案。

对此的任何帮助都会大大增加我的夜间睡眠时间:) 我也打赌其他人，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T21:26:28.173

该异常是数据库约束异常。您应该查看 catalog_product 表，看看它是否有上述代码（间接）违反的任何约束。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:41:18.497

问题是，您的变量 $attributeId 不是数字而是数组。使用这个小修复，它应该可以工作。

```
$model->addAttributeToSet('catalog_product', $attributeSetId, $attributeGroupId, $attributeId['attribute_id']); 
```

你使用调试器吗？你可以用 xdebug 在几分钟内解决这个问题。

# image - 元素（图像）之间 在水平

> ID：14467966
> 
> 赞同：0
> 
> 时间：2013-01-22T21:05:06.047
> 
> 标签：image, html-lists, separator

我需要在 [ li ] 标签之间放置图像分隔符。经过一小时的谷歌搜索，我找到了两种添加分隔符的常用方法：

*   使右（左）[ li ] 边框可见（在我的情况下不是）
*   为 [ li ] 设置背景： url(../images/separator.png) no-repeat left;

第二种方法让我不满意，因为我的图像几何和 [li] 几何不同。那么，我怎样才能实现这个目标呢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:09:26.457

您可以尝试在其他元素之间放置额外的 [li] 元素。

```
<li class="seperator"> 
```

现在您可以编辑 css 以使它们适合您的背景 img。

# html - 为什么这个页面在 IE8 中看起来像垃圾，但在 Firefox 和 Chrome 中加载正常？

> ID：14467969
> 
> 赞同：0
> 
> 时间：2013-01-22T21:05:08.450
> 
> 标签：html, internet-explorer, internet-explorer-8, cross-browser

请注意，主页在 IE8 中看起来很糟糕：

[http://www.amateurgourmet.com/](http://www.amateurgourmet.com/)

...但是单个帖子看起来不错，具有相同的样式表：

[http://www.amateurgourmet.com/2013/01/brittany-cake-aux-pruneaux.html](http://www.amateurgourmet.com/2013/01/brittany-cake-aux-pruneaux.html)

这是它在 IE8（也可能是 IE9）中的样子： ![在此处输入图像描述](../Images/383660ee252c555521aed4baac6dd51b.png)

这是为什么？我试过验证代码，虽然有很多警告（这是我继承的一些糟糕的代码，还有很多 3rd 方插件），但我看不到任何明显的东西。

在 Firefox、Chrome、Safari 中，一切看起来都很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:12:14.690

至少其中一个问题是您在 DOCTYPE 声明之前的注释。这会使所有版本的 IE 进入怪癖模式。删除它，你应该是金色的。

此外，IE 不会截断页面（如您所见，版权内容仍然存在）。包装器正在崩溃，部分原因是处于怪癖模式。

# scala - 将列表头作为选项的紧凑语法

> ID：14467972
> 
> 赞同：6
> 
> 时间：2013-01-22T21:05:13.630
> 
> 标签：scala, scala-option

当列表非空时，是否有一种紧凑的方法可以将列表的头部作为 Some ，否则获取 None ？

这是我目前正在做的，

```
val ms = moves.filter { ...some predicate... }
if (ms.nonEmpty) Some(ms.head) else None 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-22T21:09:39.300

试试`headOption`。[API 文档](https://www.scala-lang.org/api/current/scala/collection/immutable/List.html)是您的朋友。

另请注意，这`find`确实是一个`filter`加号`headOption`：如果存在则将一个项目放入选项中，否则给出`None`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T23:33:27.967

上面的答案对于这种情况是正确的，但是您只需要简化第二行，我还推荐[这里提到](https://stackoverflow.com/questions/12728678/simplify-if-x-somey-else-none)的这个方便的实用程序（从 Scalaz 采用）：

```
implicit class boolean2Option(val value: Boolean) extends AnyVal {
  def option[A](f: => A) = if (value) Some(f) else None
} 
```

允许这样做：

```
if (condition) Some(result) else None 
```

变成这样：

```
condition option result 
```

# c++ - 使用 shared_ptr 将 base 抽象为带有 boost.python 的持有者

> ID：14467974
> 
> 赞同：5
> 
> 时间：2013-01-22T21:05:16.513
> 
> 标签：c++, abstract-class, shared-ptr, boost-python

我们小组正在使用 C++ 开发一个数字框架。我们现在想包装我们框架的基本部分，以便在 Python 中可用。我们选择的武器是 Boost.Python，因为我们已经将 Boost 用于其他目的。我们只使用 smart_ptrs 来支持多态性。以下片段是我们如何应用策略模式的简单示例：

```
#include <boost/shared_ptr.hpp>
struct AbsStrategy
{
  virtual std::string talk( ) = 0;
};

typedef boost::shared_ptr<AbsStrategy> StrategyPtr;

struct Foo : AbsStrategy
{
  std::string talk( )
  {
    return "I am a Foo!";
  }
};

struct Bar : AbsStrategy
{
  std::string talk( )
  {
    return "I am a Bar!";
  }
};

struct Client
{
  Client( StrategyPtr strategy ) :
          myStrategy( strategy )
  {
  }

  bool checkStrategy( StrategyPtr strategy )
  {
    return ( strategy == myStrategy );
  }

  StrategyPtr myStrategy;
}; 
```

如果我像这样使用 Boost.Python 包装整个东西

```
#include <boost/python.hpp>
using namespace boost::python;

BOOST_PYTHON_MODULE( BoostPython )
{
  class_<Foo>( "Foo" )
      .def( "talk", &Foo::talk );

  class_<Bar>( "Bar" )
      .def( "talk", &Bar::talk );

  class_<Client>( "Client", init<StrategyPtr>( ) )
      .def( "checkStrategy", &Client::checkStrategy );
} 
```

编译时弹出以下警告

```
C:/boost/include/boost-1_51/boost/python/object/instance.hpp:14:36: warning: type attributes ignored after type is already defined [-Wattributes] 
```

当我尝试在 python 中使用包装器时，出现以下错误

```
>>> from BoostPython import *
>>> foo = Foo()
>>> bar = Bar()
>>> client = Client(foo)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
Boost.Python.ArgumentError: Python argument types in
    Tree.__init__(Tree, Foo)
did not match C++ signature:
    __init__(_object*, boost::shared_ptr<AbsStrategy>)
>>> client = Client(bar)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
Boost.Python.ArgumentError: Python argument types in
    Tree.__init__(Tree, Bar)
did not match C++ signature:
    __init__(_object*, boost::shared_ptr<AbsStrategy>) 
```

在不改变我们的框架的情况下让整个事情工作起来缺少什么？当然，包装器可以自由调整。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T13:23:52.157

好的，我找到了解决方案。一个必须`implicitly_convertible`在模块声明中使用，如下所示。

```
#include <boost/python.hpp>
using namespace boost::python;

BOOST_PYTHON_MODULE( BoostPython )
{
  class_<Foo>( "Foo" )
      .def( "talk", &Foo::talk );

  class_<Bar>( "Bar" )
      .def( "talk", &Bar::talk );

  class_<Client>( "Client", init<StrategyPtr>( ) )
      .def( "checkStrategy", &Client::checkStrategy );

  implicitly_convertible<boost::shared_ptr<Foo> , StrategyPtr>();
  implicitly_convertible<boost::shared_ptr<Bar> , StrategyPtr>();
} 
```

# c++ - 线性搜索类对象数组

> ID：14467976
> 
> 赞同：1
> 
> 时间：2013-01-22T21:05:17.800
> 
> 标签：c++, arrays, linear-search

我设置了一个线性搜索算法来搜索它工作的类对象数组，但输出不匹配，当我在数组中搜索特定名称时，找到数组中的第一个和第三个值，但第二个值是未找到。

以下是我的代码，感谢您的帮助。

```
int linsearch(string val)
{
    for (int j=0; j <= 3; j++)
    {
        if  (player[j].getLastName()==val)
         return j ;         
    }
        return 1 ;
}   

void showinfo()
{
    string search;
    int found ;

    cout << "Please Enter The Player's Last Name : " ;
    cin >> search ;

    found=linsearch(search);

    if (found==1)
    {
        cout << "\n There is no player called " << search ;
    }
    else
    {
        cout << "\n First Name : " << player[found].getFirstName() << "\n" << "Last Name : " << player[found].getLastName() <<
            "\n" << "Age : " << player[found].getAge() << "\n" << "Current Team : " << player[found].getCurrentTeam() << 
            "\n" << "Position : " << player[found].getPosition() << "\n" << "Status :  " << player[found].getStatus()  << "\n\n";
    }

    cin.get() ;

    menu() ;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T21:07:56.653

因为您将第二个元素的索引用作“未找到”代码：

```
int linsearch(string val)
{
    for (int j=0; j <= 3; j++)
    {
        if  (player[j].getLastName()==val)
         return j ;         
    }
        return 1 ;
} 
```

您应该返回一些不能作为索引的东西，例如`-1`. 或者更好的是，使用[std::find_if](http://en.cppreference.com/w/cpp/algorithm/find)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:08:23.707

第二个元素的索引与标记“未找到”条件的值相同。

使用无效索引`-1`来标记“未找到”条件：

```
int linsearch(string val)
{
    for (int j=0; j <= 3; j++)
    {
        if  (player[j].getLastName()==val)
         return j ;         
    }

    return -1;
} 
```

然后`-1`在调用函数中检查：

```
if (found==-1)
{
    cout << "\n There is no player called " << search ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T21:11:28.863

做这样的事情......如果找不到，则返回任何其他整数，如'-1'

```
int linsearch(string val)
{
for (int j=0; j <= 3; j++)
{
    if  (player[j].getLastName()==val)
     return j ;         
}
    return -1 ;
} 

void showinfo()
{
string search;
int found ;

cout << "Please Enter The Player's Last Name : " ;
cin >> search ;

found=linsearch(search);

if (found == -1)
{
    cout << "\n There is no player called " << search ;
}

[...] 
```

# ruby-on-rails - 如何使用 Fabricator-gem 设置多态关系？

> ID：14467981
> 
> 赞同：0
> 
> 时间：2013-01-22T21:05:42.013
> 
> 标签：ruby-on-rails, mongoid, fabrication-gem

我正在尝试设置 fabricator-gem 来处理我的模型进行测试。我遇到的问题是它似乎无法处理多态关系。我使用 MongoDB 作为我的数据库，使用 Mongoid 作为我的 ORM。考虑这个例子：

```
class Description
  include Mongoid::Document
  include Mongoid::Timestamps

  embeds_many :images, as: :photo, cascade_callbacks: true
end

class Image
  include Mongoid::Document
  include Mongoid::Timestamps

  embedded_in :photo, polymorphic: true
end 
```

使用此代码，您可以将 Image 文档嵌入到许多不同类型的文档中，因为您设置了`polymorphic: true`. 这在使用fabricator时是个问题，因为你想做这样的事情：

```
Fabricator(:description) do |f|
  f.images(count: 1) { |description, i| Fabricate(:image, photo: description) }
end 
```

但是 Fabricator-gem 自动假定必须有一个名为 Photo 的类。因此，当您运行测试时，会引发以下错误：

```
NameError:
       uninitialized constant Photo 
```

我如何告诉 Fabricator 这是一个多态关联？

编辑：这里的堆栈跟踪：

```
NameError: uninitialized constant PhotoOf
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/activesupport-3.2.11/lib/active_support/inflector/methods.rb:230:in `block in constantize'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/activesupport-3.2.11/lib/active_support/inflector/methods.rb:229:in `each'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/activesupport-3.2.11/lib/active_support/inflector/methods.rb:229:in `constantize'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/activesupport-3.2.11/lib/active_support/core_ext/string/inflections.rb:54:in `constantize'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/relations/metadata.rb:602:in `klass'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/relations/builders/nested_attributes/one.rb:33:in `build'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:170:in `block in process_relations'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:167:in `each_pair'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:167:in `process_relations'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:153:in `process_pending'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:32:in `block in process_attributes'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:193:in `with_mass_assignment'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/attributes/processing.rb:22:in `process_attributes'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/document.rb:148:in `block in initialize'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/threaded/lifecycle.rb:84:in `_building'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/mongoid-3.0.17/lib/mongoid/document.rb:143:in `initialize'
... 33 levels...
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/generator/base.rb:91:in `block in process_attributes'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/generator/base.rb:90:in `each'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/generator/base.rb:90:in `process_attributes'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/generator/base.rb:6:in `build'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/generator/base.rb:26:in `create'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/schematic/definition.rb:62:in `block in fabricate'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/schematic/definition.rb:61:in `instance_eval'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/schematic/definition.rb:61:in `fabricate'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication/fabricator.rb:10:in `fabricate'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/fabrication-2.5.4/lib/fabrication.rb:51:in `Fabricate'
    from (irb):1
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
    from /Users/max/.rvm/gems/ruby-1.9.3-p362/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:34:24.827

我认为问题实际上在于您如何定义 embeds_many 关联。尝试完全删除“as”选项，看看是否能解决问题。

```
class Description
  include Mongoid::Document
  include Mongoid::Timestamps

  embeds_many :images, cascade_callbacks: true
end

class Image
  include Mongoid::Document
  include Mongoid::Timestamps

  embedded_in :photo, polymorphic: true
end 
```

Fabrication 不会尝试将属性名称转换为类。只要您定义了 Fabricator(:image)，最好没有`photo`关联，那么您应该能够做到这一点：

```
Fabricator(:description) do
  images(count: 1)
end 
```

# android - 将当前日期保存到数据库中

> ID：14467984
> 
> 赞同：2
> 
> 时间：2013-01-22T21:05:45.003
> 
> 标签：android, date

我想在我的数据库中保存系统日期，但它返回 : `22/0/2013`。这是我的代码：

```
Calendar cal = Calendar.getInstance(); 

               int year = cal.get(Calendar.YEAR);
               int month_ = cal.get(Calendar.MONTH);
               int day_ = cal.get(Calendar.DATE);

               String  FullDate = (""+day_+"/"+month_+"/"+year);

                String text_Rate=(String.valueOf(FullDate));                                
                Log.d("System Date show", text_Rate); 
```

我在哪里做错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T21:06:55.160

这是正确的行为。[Java`Calendar`月份是从 0 开始的（一月是 0，十二月是 11）](https://stackoverflow.com/questions/344380/why-is-january-month-0-in-java-calendar)。

如果您真的想将其存储为`22/1/2013`，只需添加`+1`到您的月份：

```
int month_ = cal.get(Calendar.MONTH) + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T21:10:17.910

您应该将日期保存到 sqlite。这更容易，更不容易出错。看[这里](http://docs.oracle.com/javase/6/docs/api/java/util/Calendar.html#getTime%28%29)日历长。

# android-pay - 回复：JWT，PURCHASE_CANCELED

> ID：14467995
> 
> 赞同：1
> 
> 时间：2013-01-22T21:06:33.953
> 
> 标签：android-pay

遇到`PURCHASE_CANCELED`电子钱包中的错误问题。

A. 我可以成功地在 JWT 之间往返

[https://sandbox.google.com/checkout/customer/gadget/inapp/demo.html](https://sandbox.google.com/checkout/customer/gadget/inapp/demo.html)

和

[https://developers.google.com/commerce/wallet/digital/docs/jwtdecoder](https://developers.google.com/commerce/wallet/digital/docs/jwtdecoder)

...当然可以，它们都是 Google 工具。

B. 我可以成功地从 PyJWT 传递到解码器，似乎没有信息变化。

C. 我可以成功地从演示传递到 PyJWT，似乎没有信息变化。

D.`.buy()`失败回调中的请求是正确的。

这是非常令人沮丧的，当它有来自谷歌钱包的反馈时`PURCHASE_CANCELED`。

*   我无法在 PyJWT 和演示编码器之间创建相同的 JWT。即使以完全相同的顺序使用完全相同的数据，结果在长字符串的末尾也会有所不同。这有关系吗？

*   有没有办法独立生成`signature (encoded)`要验证的？

*   对象中要编码的键的顺序是否重要？

编辑：

*   在订单历史记录中，电子钱包显示“Google 已向客户发送了一封订单确认电子邮件”。我的测试买家没有收到任何电子邮件。

*   同样在订单历史记录中，Wallet 显示“客户的信用卡已获得 3.00 美元的授权，并通过了所有风险检查”。看起来很有希望。

*   我记得读过，在沙盒中，不需要银行或税务信息。然而，由于缺乏银行/税务信息，Google Books 让我在 Google Play 中“出售”一本 0 美元（免费）的书让我耽搁了几个月；没有它，这本书就无法通过审批程序，也没有给出其他解释。沙盒是否甚至需要虚假/占位符信息才能进行`.buy()`交易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:09:23.050

流程现在正在工作，回发出现在服务器上。

沙盒设置和回发活动开始之间的估计延迟为 5-6 小时。

沙盒税务/银行信息中未进行任何更改。

# java - 将超类转换为子类

> ID：14467999
> 
> 赞同：3
> 
> 时间：2013-01-22T21:06:42.723
> 
> 标签：java, class, object, inheritance, casting

想象一个类**Cottage 扩展 Building**和代码

```
Building building = new Building();
Cottage cottage = (Cottage)building; 
```

现在，考虑到 java 继承的性质，不能将**Building转换为****Cottage**是完全有道理的，但是（对我而言）没有意义的是它可以编译。为什么它编译然后抛出运行时**ClassCastException**？

在实际运行程序之前**building**是对**Building**对象的引用，这不是很明显吗？

作为一个普遍的问题，我知道我可能会得到一个重复的问题:) 但我找不到为什么它编译问题的答案:)

**EDIT2**我在这里接受了一个很好的答案（更不用说下面的讨论了:)），但我仍然发现在[Java 转换中接受的答案导致运行时错误而不是编译错误](https://stackoverflow.com/questions/10388136/java-casting-resulting-in-run-time-error-instead-of-compilation-error)是最有趣的......

**编辑**我编辑了**IllegalCastException**并放置了正确的**ClassCastException**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T21:08:43.170

那是因为，编译器不知道您的引用`Building`所指的是什么对象。

因此，在以下情况下，您有一个*基类*引用，指向*子类*对象：-

```
Building building = new Cottage();
Cottage cottage = (Cottage)building; 
```

它会工作得很好。所以，这完全是一个*运行时*的决定，至于它是否是一个有效的演员表。因此，编译器不会为此抛出错误。

> 在实际运行程序之前 building 是对 Building 对象的引用，这不是很明显吗？

**不**，绝对不是。被引用的对象的类型直到运行时才知道。永远记住，*编译器*总是检查*引用类型*。在运行时检查实际对象类型。

这个概念被称为*多态性*，您可以使用相同的引用类型来指向各种子类型的对象。你可以谷歌它，并且会得到很多资源来阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T21:10:53.763

转换的部分功能是它使编译器闭嘴，你是说你比编译器更清楚你要转换的对象是什么。如果演员表不准确，则会出现异常。

也许您希望编译器跟踪事物所指向的对象，并确定引用是否合理。编译器不是那么聪明，很容易被愚弄，请看这个片段：

```
 int i = 1;
    System.out.println((Number)i);        
    Object o = i;
    System.out.println((String)i); // won't compile (primitive-to-ref-type cast)
    System.out.println((String)o); // compiles (thanks to autoboxing) 
```

编译器只关心防止原语和引用类型之间的转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-22T21:10:40.467

考虑使用 Building(super class) 引用创建一个 Cottage(Subclass) 对象

```
Building b= new Cottage();
Cottage c = (Cottage) b; 
```

上面的代码是合法的，因此编译器在运行时不知道引用变量`c`引用的是什么对象，因此编译器不会抛出错误。

> 为什么它会编译然后抛出运行时 IllegalCastException？

顺便说一句，当您尝试将超类对象强制转换为子类时，它会抛出**ClassCastException ，而不是****IllegalCastException**。