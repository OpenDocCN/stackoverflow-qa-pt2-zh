# StackOverflow 问答 13299000-13299999

# java - JNA访问64位DLL（Windows7 64位）

> ID：13299001
> 
> 赞同：1
> 
> 时间：2012-11-08T22:30:14.180
> 
> 标签：java, dll, 64-bit, jna

能否请您指教。我有简单的 DLL（在 Windows 7 64 位下）和简单的 Java 代码，JNA 可以访问这个 DLL。问题是当我使用这个 DLL 的 64 位版本时，看起来我无法在我的 DLL 测试函数**giveIntGetInt**中从 Java 获取参数，而当我使用 32 位 DLL 时我没有问题。我哪里错了？谢谢！

```
import com.sun.jna.Library;
import com.sun.jna.Native;
import com.sun.jna.Platform;
import com.sun.jna.Pointer;

/** Simple example of native library declaration and usage. */
public class HelloWorld {
    public interface simpleDLL extends Library {
        simpleDLL INSTANCE = (simpleDLL) Native.loadLibrary(
            (Platform.isWindows() ? "simpleDLL" : "simpleDLLLinuxPort"), simpleDLL.class);
         int giveIntGetInt(int a);               // int giveIntGetInt(int a);
    }

    public static void main(String[] args) {
     int b = simpleDLL.INSTANCE.giveIntGetInt(2);
     System.out.println("Hello, World\n");

     System.out.println(String.format("Argument %d", b));

    }
} 
```

这是 C dll 方法：

```
int simpleDLL::giveIntGetInt(int a)
    {
        return 2*a;
    } 
```

例如，这是我使用 64 位 dll 获得的：

```
Hello, World 
Argument 181140 
```

32位dll：

```
Hello, World 
Argument 4 
```

# php - htaccess 有条件地重写未找到但基于 url 中提供的特定目录的文件

> ID：13299002
> 
> 赞同：0
> 
> 时间：2012-11-08T22:30:14.673
> 
> 标签：php, mysql, apache, .htaccess, mod-rewrite

不完全确定这是否可能，但我的任务是重建少数几个网站，它们的内部运作对于它们如何仍然正常工作是一个谜。在 MVC、CMS 等被真正了解之前提出。在 PHP 4 的时代，3 的风口浪尖，如果这能给你任何想法的话。所以..我有一个大问题，我正在尝试使用 MVC 进行重建，这并不是真正的问题。

问题是，文章中存储了大约 20,000 个文件和图像，以及该站点上的各种其他内容。因此，每个地方都有热链接图像和其他文件的网站，更不用说文章中的硬编码网址，这些网址最终会被正确转换，但数量很多。

反正。底线是我想知道是否有一种方法可以平均获取失败的图像和文件请求并将它们映射到一个新文件夹，该文件夹将包含所有这些图像或文件。这是 htaccess 可以单独完成的事情，还是我必须想出一种服务器端脚本和 htaccess 的方法？或者这是最坏的情况，我将不得不对未找到的文件进行打击，并将它们全部路由到一个错误页面，说文件已被移动？

不知道什么是解决这个问题的好方法，所以我还没有尝试过任何东西，有点想感受一下，看看我必须从那里去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:37:36.100

您可以将所有图像扩展名重定向到特定文件夹：

```
RewriteRule (.*)\.(gif|jpg|png)$ /my/new/folder/$1.$2 [R,L] 
```

希望这可以帮助...

# facebook - Facebook Graph API 搜索返回空数据

> ID：13299004
> 
> 赞同：3
> 
> 时间：2012-11-08T22:30:24.237
> 
> 标签：facebook, facebook-graph-api, web-applications

Facebook 搜索 API 自最近几天以来返回空数据集。这对我来说很好，直到 2-3 天前。

重现是一致的，即使与 Graph API 开发人员页面上的示例： [https ://graph.facebook.com/search?q=watermelon&type=post](https://graph.facebook.com/search?q=watermelon&type=post)

{ “数据”： [

] }

知道发生了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:05:04.253

这看起来像现在工作。可能是临时问题。

# sql-server-2008 - SQL Server 事务中的变量持久性

> ID：13299005
> 
> 赞同：1
> 
> 时间：2012-11-08T22:30:25.943
> 
> 标签：sql-server-2008, tsql

我有一个大型 T-SQL 脚本，可以打开和关闭一些事务。我已经读过使用 GO 语句提交批处理可以有效地清除其范围内的所有变量。

鉴于下面的脚本，在提交事务后是否会定义 @MyImportantVariable？

这是一个问题，如果是，我该如何克服它？

```
DECLARE @MyImportantVariable INT;
SET @MyImportantVariable = 42;

DECLARE @Counter INT;
SET @Counter = 0

DECLARE UpdateGarmentCursor CURSOR FAST_FORWARD
FOR
SELECT
        MyColumn
    FROM
        MyWonderfulTable

BEGIN TRANSACTION
    WHILE @@TRAN_STATUS = 0 
    BEGIN
        -- Do interesting work in here
    SET @Counter = @Counter +1
    IF(@Counter>10) 
    BEGIN
        COMMIT TRANSACTION
            -- What happens here to @MyImportantVariable?
           SET @Counter = 0
        BEGIN TRANSACTION
    END
END

-- Close the transaction one last time
COMMIT TRANSACTION 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:35:11.303

该变量仍将存在。

您的示例不包含`GO`命令，仅包含事务。

`GO`*表示批次*的结束……批次和交易完全是两个不同的东西。

[来自 MSDN](http://msdn.microsoft.com/en-us/library/ms188037.aspx)：

> GO 不是 Transact-SQL 语句；它是 sqlcmd 和 osql 实用程序以及 SQL Server Management Studio 代码编辑器识别的命令。
> 
> SQL Server 实用程序将 GO 解释为它们应该将当前批次的 Transact-SQL 语句发送到 SQL Server 实例的信号。当前批次的语句由自上次 GO 或自特别会话或脚本开始（如果这是第一个 GO）以来输入的所有语句组成。

# java - java中的比较问题[.equals()]

> ID：13299009
> 
> 赞同：0
> 
> 时间：2012-11-08T22:30:36.613
> 
> 标签：java, comparison

我正在尝试确定字符串是否包含正整数。我的代码是：

```
public void isInt(String str) throws NotIntException{
    String integer=str.replaceAll("\\d","");
    System.out.println(integer);
    if (!integer.equals("")){
        throw new NotIntException("Wrong data type-check fields where an integer"+
        " should be.");
    }//end if
    if (integer.equals("-")){
        System.out.println(integer);
        throw new NotIntException("Error-Can't have a negative count.");
    }//end if
}//end method 
```

我正在用字符串“-1”对此进行测试，它应该在 replaceAll() 之后变为“-”。这应该输入两个 if 语句。但它只进入第一个。我也尝试了 == 比较，以防万一，但它也不起作用。对我来说奇怪的是，无论我是要满足第二个 if 语句的条件还是满足它的否定 [即，!integer.equals("-")]，程序仍然没有进入 if....

谢谢，通常我的比较问题只是我缺少一些基本的东西，但我真的没有在这里看到任何东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:32:34.000

由于您在第一个 if 中抛出异常，因此，您的第二个 if 甚至都不会被测试。

```
if (!integer.equals("")){
    throw new NotIntException("Wrong data type-check fields where an integer"+
    " should be.");
}

if (integer.equals("-")){
    System.out.println(integer);
    throw new NotIntException("Error-Can't have a negative count.");
} 
```

如果您的代码输入第一个`if`，它将不会进一步执行。

* * *

但是，你为什么要使用这种方法来解决你的问题。

您可以轻松地使用`Integer.parseInt`来检查有效的`integer`. 然后如果它是有效的，然后测试它是否`less than 0`. 它会更容易和可读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T22:54:15.947

我的解决方案：

```
public static boolean isPositiveInt(String str) {
    try {
       int number = Integer.parseInt(str.trim());
       return number >= 0;
    } catch (NumberFormatException e) {
       return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:34:54.710

如果您想简单地从字符串中读取一个 int，请使用 Integer.parseInt()，尽管这仅在您想查看字符串是否“是”一个 int，而不包含一个 int 时才有效。

您可以使用 Integer.parseInt() 和循环策略的组合来相当容易地查看它是否包含一个 int ，然后只需检查它是否为正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T22:36:21.457

你的方法太复杂了。我会保持简单：

```
if (integer.startsWith("-")) {
    // it's a negative number
}

if (!integer.matches("^\\d+$")) {
    // it's not all-numbers
} 
```

忘记打电话给`replaceAll()`

# sql-server - 使用类似“Where”的注意事项删除另一个表中的相关记录

> ID：13299010
> 
> 赞同：0
> 
> 时间：2012-11-08T22:30:36.247
> 
> 标签：sql-server, database, database-design

我有一个带有主键的数据表，名为`OptDefID`. 当此表中的记录被删除时，我需要从`Permissions`表中删除字段中包含`OptDefID`该记录的所有记录`defID`（in `Permissions`）。对我来说棘手的部分是该`Permissions`表没有主键并且拥有许多不同类型的权限，并且有一个`permissiontype`字段。我需要删除具有`OptDefID`AND 的`permissiontype`行`OptDef`。

因为我需要考虑权限类型，所以我认为外键约束在这里不合适（或者是吗？）。

我也考虑过创建触发器，但不确定如何将 OptDefID 传递到触发器中。

我可以通过应用程序本身来做到这一点，但我觉得这应该是一个数据库级的解决方案。

最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T14:44:50.553

如果`OptDefId`仅在相关记录引用`Permissions`表时填充该列，则外键应该是合适的。即你有另一列`MemberId`，这又可能是`Members`表上的外键。

只有当您有一个列 - 我们称之为它`ObjectId`- 随着`type`列内容的变化而具有其他含义时，您才能使用外键。在这种情况下，触发器可能是最好的方法，正如您已经猜到的那样。我只知道 Oracle PL/SQL 中的触发器，它们作为单独的完整行传入，代表新旧状态。我想这在 MS-SQL-Server 中会类似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T14:50:30.257

除了使用 join with`SELECT`语句外，您还可以在`DELETE`&`UPDATE`语句中连接多个表。

据我了解这个问题，您应该能够将`Permissions`表连接到具有`OptDefID`列的表并添加`WHERE`类似于以下内容的子句：

```
DELETE MyTable
...
WHERE [Permissions].permissiontype = 'OptDef' 
```

此外，这些链接也可能很有趣：

*   [SQL DELETE with JOIN another table for WHERE 条件](https://stackoverflow.com/a/1980762/1796930) *（对于 MySQL，但仍然相关）*
*   [在 SQL DELETE 语句中使用 SQL JOIN](http://www.bennadel.com/blog/939-Using-A-SQL-JOIN-In-A-SQL-DELETE-Statement-Thanks-Pinal-Dave-.htm)
*   [在 SQL UPDATE 语句中使用 SQL JOIN](http://www.bennadel.com/blog/938-Using-A-SQL-JOIN-In-A-SQL-UPDATE-Statement-Thanks-John-Eric-.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T16:19:58.177

> 假设我想从 defID 为 20 且权限类型为“OptDef”的权限中删除。Permissions 中可能还有另一行，其 defID 为 20，但权限类型为“Member”。不应删除该节目，因为它与会员有关，而不是 Opt 数据。

正如您所发现的，在字段中存储表名会阻止外键正常工作。

我建议您解决根本问题并将这两个外键分开，以便可以单独强制执行它们中的每一个。例如：

```
CREATE TABLE Permissions (
    ...
    OptDefId int,
    MemberId int,
    FOREIGN KEY (OptDefId) REFERENCES OptDef ON DELETE CASCADE,
    FOREIGN KEY (MemberId) REFERENCES Members ON DELETE CASCADE,
    CHECK (
        (OptDefId IS NOT NULL AND MemberId IS NULL)
        OR (OptDefId IS NULL AND MemberId IS NOT NULL)
    )
) 
```

CHECK 确保只有一个 FK 是非 NULL 并且仅强制执行非 NULL FK。

或者，您可以避免更改当前设计并通过触发器强制执行此“特殊” FK，但在可能的情况下，应优先使用声明性约束而不是触发器 - 声明性约束往往留出更少的错误空间并且更加“自我记录”。

# c# - 我需要一次发送整个单词，但 Selenium webdriver 按字母发送键.. 任何建议

> ID：13299011
> 
> 赞同：0
> 
> 时间：2012-11-08T22:30:39.630
> 
> 标签：c#, asp.net, sql, selenium

这是我的示例代码：我正在从 SQL 中读取数据，对于每个记录，我需要访问网站并将数据输入到字段中，但它是一个字母一个字母地输入......就像打字一样

```
// Declare variables
                string tempaccount = "";
                string tempcounter = "";

                tempaccount = myReader2["acctno"].ToString();
                tempcounter = myReader2["counter"].ToString();

                string recipient_last_name = myReader2["last"].ToString();
                string recipient_first_name = myReader2["first"].ToString();
                //---------------------------------------------------------------------
                //------------------------ Data Entry ---------------------------------
                //---------------------------------------------------------------------

               IWebElement tPATIENT_LAST_NAME = driver.FindElement(By.Name("LAST_NAME"));
                tPATIENT_LAST_NAME.SendKeys(recipient_last_name);

                IWebElement FIRST_NAME = driver.FindElement(By.Name("tPATIENT_FIRST_NAME"));
                tPATIENT_FIRST_NAME.SendKeys(recipient_first_name); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T19:48:59.133

根据我的理解，如果有大写字母，那么对于每个发送键，司机发送班次然后发送字母..这就是为什么它需要一点时间......

由于现在我对我的代码进行了更改，如下所示，它会在几秒钟内发送密钥。

```
string recipient_last_name = myReader2["last"].ToString().ToLower();
IWebElement tPATIENT_LAST_NAME = driver.FindElement(By.Name("LAST_NAME"));  
          tPATIENT_LAST_NAME.SendKeys(recipient_last_name); 
```

# objective-c - iOS6：MFMailComposeViewController 偶尔产生数组突变错误

> ID：13299012
> 
> 赞同：2
> 
> 时间：2012-11-08T22:30:40.403
> 
> 标签：objective-c, ios6, mfmailcomposeviewcontroller, mfmailcomposer

在 iOS 6 系统上启动 MFMailComposeViewController 实例时，我偶尔会看到以下错误。在 iOS 5 上一切正常，它只在 iOS 6 上发生：

*** 由于未捕获的异常“NSGenericException”而终止应用程序，原因：“*** Collection [__NSArrayM: ...] 在枚举时发生了变异。”

错误发生在启动视图控制器的 viewWillDisappear() 函数被调用之后。

有没有其他人遇到过这个问题或遇到过修复？

谢谢！

代码很标准，但我还是把它包括在内：

```
-(IBAction)doEmailLog:(id)sender 
{    
    if( [self canSendMail] )
    {       
        // create the compose message view controller
        MFMailComposeViewController* mailComposer = [[MFMailComposeViewController alloc] init];

        // this class will handle the cancel / send results
        mailComposer.mailComposeDelegate = self;

        // fill in the header and body
        [mailComposer setSubject:@"My Subject"];
        [mailComposer setMessageBody:@"My message body" isHTML:NO];

        // attach log file
        if ([[NSFileManager defaultManager] fileExistsAtPath:filename])
        { 
            NSData *data = [NSData dataWithContentsOfFile:filename];
            [mailComposer addAttachmentData:data mimeType:@"text/plain" fileName:filename];
        }

        // show the view controller
        [self presentViewController:mailComposer animated:YES completion:^{LogTrace(@"Presented mail view controller");}];
    }
    else
    {
        ...
    }
}

-(void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error
{
    ...

    // dismiss the compose message view controller
    [self dismissViewControllerAnimated:YES completion:^{LogTrace(@"Finished dismissing mail controller");}];
} 
```

# javascript - 使用新的 HTML5 历史机制构建一个无需重新加载页面的网站

> ID：13299016
> 
> 赞同：3
> 
> 时间：2012-11-08T22:30:55.420
> 
> 标签：javascript, jquery, html, history, pushstate

我正在寻找一种在不导致整个页面重新加载的情况下更改浏览器地址位置的方法，因此我得到了一些有用的信息，如下所示：

[http://spoiledmilk.com/blog/html5-changeing-the-browser-url-without-refreshing-page/](http://spoiledmilk.com/blog/html5-changing-the-browser-url-without-refreshing-page/)

并尝试进入新的 HTML5 历史机制，我也得到了这个：

[HTML5/jQuery：pushState 和 popState - 深度链接？](https://stackoverflow.com/questions/8776614/html5-jquery-pushstate-and-popstate-deep-linking)

于是想到了一个完全不同的想法……

我在问是否有可能的方式（我不一定是“简单”）来构建，或者是否已经存在类似“框架”或类似的东西来构建一个能够完全避免页面的 web 项目重新加载....从而大量使用 ajax 和/或 jquery 等（我引用这个是因为它是我通常使用的）。

我认为这可以改善浏览此类网站时的“用户体验”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T09:18:52.727

“bbUI 工具包旨在基于 BB5/BB6/BB7/PlayBook 和 BlackBerry 10 上的 Web 渲染引擎的功能逐步增强其功能。[...] 通过不向屏幕元素添加任何类型的布局逻辑，然后，bbUI 可以根据需要以任何方式修改 DOM，以实现所需的结果。

所有 DOM 操作都是在 HTML 片段未附加到活动 DOM 时发生的。这允许 DOM 操作非常、非常、快速地发生，并且在将整个片段插入 DOM 之前不会产生任何 WebView 布局计算。JavaScript DOM 操作期间的布局计算是可能减慢基于 Web 的 UI 的最昂贵的操作之一。

您创建的每个屏幕都是一个 HTML 片段，它通过 AJAX 加载到应用程序中，以保持 DOM 的大小和内存使用量降至最低。

[https://github.com/blackberry/bbUI.js](https://github.com/blackberry/bbUI.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T01:03:02.633

[GitHub](https://github.com/)就是这样构建的。当您在项目中并单击链接（如“bin”）时，它会加载与该链接对应的新内容并更新地址栏 URL，但页面本身不会重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-23T18:13:34.607

只需查看[http://backbonejs.org/](http://backbonejs.org/)它应该对您的需求客户端绑定和浏览器历史记录都有帮助。

# javascript - JQuery ajax() 获取xml响应文本

> ID：13299017
> 
> 赞同：10
> 
> 时间：2012-11-08T22:31:00.870
> 
> 标签：javascript, jquery, html

我正在尝试从 Gmail API 中检索一些 XML。到目前为止我有这个：

```
$.ajax({
    url: "https://mail.google.com/mail/feed/atom/",
    success: function(data) {
        console.log(data.responseText);
    }
}); 
```

我确定数组数据有一个名为的值，`responseText`因为控制台告诉我，当我让我的代码记录数据时。但是，当我尝试 log 时`data.responseText`，它会记录数据并忽略我指定参数的事实（它没有说 responseText 未定义）。我究竟做错了什么？

编辑：这是控制台所说的屏幕截图`data`：

![](../Images/a5f8e976383a02e686b55dc672d0fd88.png) 编辑，回应凯文：我试过这个：

```
$.ajax({
    url: "https://mail.google.com/mail/feed/atom/",
    dataType: "xml",
    success: function(data) {
        console.log($("feed fullcount",data).html());
    }
}); 
```

它说它“不能调用未定义的方法'替换'”：o

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T22:44:00.733

`data`不是 xhr 对象，它是将您的 xml 字符串转换为`XML Document`. `responseText`因此，除非 xml 文档具有 responseText 节点，否则它没有属性。`dataType: "xml"`此外，如果您需要 xml ，请添加到您的 ajax 选项。

```
$.ajax({
    url: "https://mail.google.com/mail/feed/atom/",
    dataType: "xml",
    success: function(data) {
        console.log(data);
    }
}); 
```

~~编辑：现在我在你的问题（编辑后）中看到它实际上是一个 xhr 对象......这很奇怪......~~

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-05-11T06:02:00.403

如果您只想显示文本格式的响应，您可以简单地做`dataType: "text",`

```
$.ajax({
  url: "https://miranda-zhang.github.io/cloud-computing-schema/v1.0/ontology.xml",
  dataType: "text",
  success: function(text) {
    $('textarea').val(text);
  },
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<textarea cols="60" rows="10"></textarea>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T22:33:05.860

尝试使用 data.responseText[0] 而不是 data.responseText。

编辑：[https](https://mail.google.com/mail/feed/atom/) ://mail.google.com/mail/feed/atom/它要求我登录。

# html - 是否可以指定 CSS 类在所有成员中具有相同的宽度，但可以拉伸以适应？

> ID：13299018
> 
> 赞同：1
> 
> 时间：2012-11-08T22:31:10.410
> 
> 标签：html, css

假设我有多个元素（div 或 span），要么是`display: block`要么`display: inline-block`。我希望它们都具有相同的大小，但会拉伸以适应最大的内容。我知道这可以通过 JavaScript 来完成，但是是否有可用的纯 HTML/CSS 选项？

例子：

```
-----------------------
| Content A           |
-----------------------

-----------------------
| Content B Is Longer |
----------------------- 
```

但是，如果内容 B 更长，它们看起来像：

```
----------------------------------------
| Content A Is Now Even Longer Than B  |
----------------------------------------

----------------------------------------
| Content B Is Shorter                 |
---------------------------------------- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:37:17.437

如果你给它们`width: 100%;`并将它们包装在一个带有`display: inline-block;`. 示例：http: [//jsbin.com/ocifar/1/edit](http://jsbin.com/ocifar/1/edit)

# php - Apache/PHP 到 Nginx/Tornado/Python

> ID：13299023
> 
> 赞同：5
> 
> 时间：2012-11-08T22:31:59.217
> 
> 标签：php, python, django, nginx, tornado

我们的网站需要实时更新，我们正在考虑各种彗星/长轮询解决方案。经过研究，我们决定使用 nginx 作为 4 个龙卷风实例（托管在 Amazon EC2 上）的反向代理。我们目前使用的是传统的 LAMP 堆栈，并且已经用 PHP 编写了大量代码。我们愿意将我们的 PHP 代码转换为 Python 以更好地支持此解决方案。以下是我的问题：

1.  假设一个四核处理器，nginx 可以与 4 个 tornado 实例在同一台服务器上运行，还是建议运行两台单独的服务器：一台用于 nginx，一台用于 4 个 tornado 进程？

2.  在 Nginx 前面使用 HAProxy 有什么好处吗？Nginx 本身不能很好地处理负载平衡吗？

3.  根据我的研究，Nginx 似乎没有一个很好的 URL 重定向模块。是否首选使用 Redis 进行重定向？如果是这样，Redis 应该在 Nginx 前面还是后面？

4.  我们的大部分应用程序代码不会参与实时更新。此代码包含多个数据库查询和文件系统读取，因此它显然不适合非阻塞应用程序服务器。根据我的研究，我了解到阻塞问题可以通过拥有多个 Tornado 实例来缓解，而其他人建议使用单独的应用服务器（例如 Gunicorn/Django/Flask）来阻塞调用。使用非阻塞服务器时处理阻塞调用的最佳方法是什么？

5.  将我们的代码从 PHP 转换为 Python 将是一个漫长的过程。在 Nginx 后面同时运行 Apache/PHP 和 Tornado 是否可以接受，或者我们应该坚持使用语言（使用 gunicorn/django/flask 的龙卷风或单独使用龙卷风）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T08:53:13.787

我将逐点进行：

1.  是的。在一台服务器上运行tornado和nginx是可​​以的。您也可以使用 nginx 作为龙卷风的反向代理。

2.  如果您有多个服务器实例，Haproxy 会给您带来好处。此外，它还允许您将 websockets 直接代理到龙卷风。

3.  实际上，nginx 可以用于重定向，没有问题。我还没有听说过使用 redis 进行重定向——它是键/值存储……你的意思可能是别的吗？

4.  同样，您可以在 django 中编写阻塞部分，在 tornado 中编写非阻塞部分。龙卷风还有一些用于数据库查询的非阻塞库。不确定您是否需要 django 的强大功能。

5.  是的，在 nginx 后面运行 apache 就可以了。很多项目在 apache 前面使用 nginx 来提供静态文件。

实际上问题是非常基本的 - 也可以回答。如果您愿意，我可以更详细地说明任何一点。

# javascript - 在 HTML 中隐藏复选框

> ID：13299024
> 
> 赞同：5
> 
> 时间：2012-11-08T22:32:05.507
> 
> 标签：javascript, html

我有这两个复选框：

```
<label for="cell">3\. Do you currently have a cell phone? (Y/N)</label>
<input type="checkbox" name="cell" name="cell" id="cell" data-on="Yes" data-off="No" />

<label for="blackBerry">4.If YES, is the cell phone a BlackBerry? (Y/N)</label>
<input type="checkbox" name="blackBerry" name="blackBerry" id= "blackBerry" data-on="Yes" data-off="No" /> 
```

我怎样才能让第二个问题显示在页面上，只有当第一个问题被选为是时？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T22:57:48.730

You can do this using javascript

**Javascript**

```
​var elem = ​document.getElementById('cell');

​elem.addEventListener('click', function() {
      var divElem = document.getElementById('divPhone'); 
    if( this.checked){
        divElem.style.display = 'block'  ; 
    }
    else{
        divElem.style.display = 'none'  ;
    }
}); 
```

**HTML**

```
 <label for="cell">3\. Do you currently have a cell phone? (Y/N)</label>
    <input type="checkbox" name="cell" name="cell"
           id="cell" data-on="Yes" data-off="No" />

    <div id="divPhone" class="hidden">
      <label for="blackBerry">4.If YES, is the cell phone a BlackBerry?
                                                          (Y/N)</label>
      <input type="checkbox" name="blackBerry" name="blackBerry" 
            id= "blackBerry" data-on="Yes" data-off="No" />
    </div>

​.hidden 
{
    display: none;
}​ 
```

**[Check Fiddle](http://jsfiddle.net/sushanth009/999y9/)**

​It is still more simple using jQuery..

```
​$('#cell').on('click', function() {
    if(this.checked){
       $('#divPhone').removeClass('hidden');
    }
    else{
       $('#divPhone').addClass('hidden');
    }        
});​ 
```

**[jQuery Fiddle](http://jsfiddle.net/sushanth009/jcHUF/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T22:35:53.290

仅 CSS：

```
<label for="cell">3\. Do you currently have a cell phone? (Y/N)</label>
<input type="checkbox" name="cell" id="cell" data-on="Yes" data-off="No" />
<div class="hide_if_no">
    <label for="blackBerry">4\. If YES, is the cell phone a BlackBerry? (Y/N)</label>
    <input type="checkbox" name="blackBerry" id="blackBerry" data-on="Yes" data-off="No" />
</div> 
```

CSS：

```
input[type=checkbox] ~ div.hide_if_no {display:none}
input[type=checkbox]:checked ~ div.hide_if_no {display:block} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:36:04.933

使用 jQuery，

```
$('#cell').change(function() {
    var c = this.checked;
    if (c) {
        $("#blackBerry").show();
    } else {
        $("#blackBerry").hide();

    }
});​ 
```

# r - `rdist` 变体以进行更具体的比较

> ID：13299032
> 
> 赞同：0
> 
> 时间：2012-11-08T22:32:23.220
> 
> 标签：r, field

`rdist`在计算出 x 和 y 坐标的两个向量之间所有欧几里得距离的矩阵方面做得很好。

但是，`rdist`如果您只需要一些比较，想要比较所有可以提供超出您需要的输出的东西。例如

```
df <- data.frame(x1=c(0,0),y1=c(0,0),x2=c(0,2),y2=c(0,0))

# df
# x1 y1 x2 y2
# 1  0  0  0  0
# 2  0  0  2  0
# where   (x1,y1) are vectors for the first points and (x2,y2) are
# vectors for the second points. We want distances between points 1 and 
# points 2 for each row 
```

如果我们只想与同一行的那个谎言进行比较`x1,y1`，`x2,y2`那么下面的方法是一个杀手：

```
library(fields)
rdist(cbind(c(df[,1],df[,3]),c(df[,2],df[,4]))) 
```

所以我的问题是实现这一目标的最佳方法是什么？我能想到：

```
library(fields)

df <- data.frame(x1=c(0,0,0,5),y1=c(0,0,0,3),x2=c(0,2,3,6),y2=c(0,0,0,9))
results <- apply(df,1,function(x) rdist(cbind( c(x[1],x[3]),c(x[2],x[4])))) 
```

然后从我的距离偷走第二排或第三排`results`...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:58:58.927

我认为您的问题来自于您的数据采用无用的宽格式。

如果您将两个点集 1 和 2 拆分为单独的 data.frames

```
df1 <- data.frame(x = c(0,0), y = c(0,0))
df2 <- data.frame(x=c(0,2),y=c(0,0)) 
```

然后你的行指的是点，你的列指的是各自的 x 和 y 坐标

然后你可以使用某种`lapply`/`sapply`解决方案来逐行比较

```
#using lapply returns a list of matrices
lapply(1:2, function(x,d1 =df1,d2 = df2){rdist(d1[x,,drop=F], d2[x,,drop=F])})
[[1]]
      [,1]
[1,] 1e-10

[[2]]
     [,1]
[1,]    2
# sapply will simplify to a vector
sapply(1:2, function(x,d1 =df1,d2 = df2){rdist(d1[x,,drop=F], d2[x,,drop=F])})
[1] 1e-10 2e+00 
```

# rss - 最新博客的链接列表在顶部？

> ID：13299040
> 
> 赞同：3
> 
> 时间：2012-11-08T22:32:42.470
> 
> 标签：rss, feed, expressionengine

我想要一个简单的博客链接列表，其中包含最新条目、作者、博客名称和日期，按最新更新的顺序列出。所以，有点像 Blogger 在他们的侧边栏上的东西——只要他们有链接列表，它就会根据最近更新的博客自动重新排序（尽管它通常没有摘要，只有网站的标题）。

我想做的是将多个 RSS 提要插入一个地方，只检查每个提要中的最新条目，然后重新排序它们

EE 中的 magpie 插件或 RSS 插件目前只允许您插入 ONE feed。如果我多次重复 magpie 标签（每个博客一个），它将显示每个博客的最新条目，但这对重新排序没有帮助，而且有点混乱。

帮助？想法？

**更新：**我想确保每个博客仍然有特色，即使他们所做的最后一篇文章是一年前的。例如，这样的博客将是链接列表中的最后一个，而这一小时更新的条目/站点将位于顶部。因此，例如，如果我将链接列表限制为 5，那么如果该站点在一小时内更新了 5 次，它将不会仅显示来自该站点的 5 个最新条目（期间）。它将显示每个站点 1 个最近的条目。

示例行为：如按日期排序的 Flickr 朋友页面和每人 1 张照片。[http://www.flickr.com/photos/friends/](http://www.flickr.com/photos/friends/)除了这次，只有博客文章的标题和他们所属的网站、作者等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:25:05.357

有一个 RSS Aggregator EE Add-on 可以为您组合提要

[http://devot-ee.com/add-ons/rss-aggregator](http://devot-ee.com/add-ons/rss-aggregator)

```
{exp:rss_aggregator:items feed_ids="6|7" limit="10" order_by="pub_date" order="desc" pub_date_format="m-d-Y g:ia" cache_timeout="60"}
    <li>
        <a href="{link}">{title}</a><br />
        <small>{pub_date} - From {channel_title}</small><br />
    </li>
{/exp:rss_aggregator:items} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:01:56.587

您可以使用 Yahoo! 管道。事实上，我之前创建了一个：http: //pipes.yahoo.com/pipes/pipe.info?_id= [82e8b23b84bf2d6c3014f50c0f6b2f1d](http://pipes.yahoo.com/pipes/pipe.info?_id=82e8b23b84bf2d6c3014f50c0f6b2f1d)

只需用逗号分隔的 RSS 提要列表调用它，瞧！它为您提供所有 RSS 提要的最新条目，按时间倒序排序。

例子：

[http://pipes.yahoo.com/pipes/pipe.run?_id=82e8b23b84bf2d6c3014f50c0f6b2f1d&_render=json&feedurls=appleinsider.com.feedsportal.com/c/33975/f/616168/index.rss,feeds.foxnews.com/foxnews/最新的？格式=xml](http://pipes.yahoo.com/pipes/pipe.run?_id=82e8b23b84bf2d6c3014f50c0f6b2f1d&_render=json&feedurls=appleinsider.com.feedsportal.com/c/33975/f/616168/index.rss,feeds.foxnews.com/foxnews/latest?format=xml)

因此，现在您有了提要的 URL，您可以使用Phil Sturgeon的[REST 模块提取各个条目。](http://philsturgeon.co.uk/code/expressionengine/rest)

对于那些感兴趣的人，这是管道的设置方式：

![在此处输入图像描述](../Images/d5d7c05867ca3f43fcd88d6536f6baa8.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:15:48.223

相当肯定 Stash 可以通过 set_list 和 get_list 处理这个问题。我没有对此进行测试，但可能类似于：

```
 {exp:channel:entries channel="feed_urls"}
      {exp:magpie url="{url}" limit="1"}
         {items}
            {exp:stash:append_list name="feed_items"}
               {stash:title}{title}{/stash:title}
               {stash:pubdate}{pubdate}{/stash:pubdate}
            {/exp:stash:append_list}
         {/items}
      {/exp:magpie}
   {/exp:channel:entries}

   {exp:stash:get_list name="feed_items" orderby="pubdate"}
      <h3>{title}</h3>
      <p>{pubdate}</p>
   {/exp:stash:get_list} 
```

[https://github.com/croxton/Stash](https://github.com/croxton/Stash)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T22:36:51.823

如何使用具有多个通道的条目循环，从中提取最新的并存储它。然后获取 RSS 提要中的藏匿处？我认为那会奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T22:37:47.117

您可能可以使用[Datagrab](http://devot-ee.com/add-ons/datagrab)来做到这一点，因为它允许您将 XML 提要导入您自己的站点，然后您可以将它们作为 EE 频道条目进行排序。

# heatmap - Geotools：将 GridCoverage2D 渲染到热图

> ID：13299045
> 
> 赞同：4
> 
> 时间：2012-11-08T22:33:03.247
> 
> 标签：heatmap, geotools

我是使用地理工具的新手。现在我需要生成一个显示数据密度的热图。

我从这里找到了一个内核密度估计过程：[https](https://jira.codehaus.org/browse/GEOT-4175) : //jira.codehaus.org/browse/GEOT-4175，到目前为止，它为我提供了一组不规则数据点上的热图表面作为 GridCoverage2D。

我的问题是，如何以热图方式显示它？非常感谢！！！

# javascript - 通过 AJAX onclick 传递数据

> ID：13299052
> 
> 赞同：3
> 
> 时间：2012-11-08T22:33:29.077
> 
> 标签：javascript, jquery, ajax

当用户单击某个链接时，我想运行一个设置 `$_SESSION`变量的 AJAX 调用，同时仍将用户指向链接的`href`.

当我运行以下代码时，Firebug 显示有错误，但没有指定；`readyState=0, status=0, statusText="error"`是我从中得到的全部`console.log`。

如果我添加`e.preventDefault`并`window.location.href = linkPath;`进入我的`success`函数，脚本会将用户发送到正确的位置；但只有在等待 php 页面完成的延迟之后。

我怎样才能运行 AJAX 调用，同时仍然将用户传递到他们的链接而不延迟？

```
$(document).ready(function() {
$(".example_class").click(function(e) {
    //Stop the page from leaving until we start our ajax
    //e.preventDefault();

    //var linkPath = this.href;

    var form_data = new Object();

    //Set the application ID for insert into the DB
    form_data.variableName = encodeURIComponent('ExampleName');

    //Send the data out to be processed and stored
    $.ajax({
       url:'/mypath/myfile.php',
       type:'POST',
       data:form_data,
       success:function(return_data){
            //window.location.href = linkPath;
            return;
        },
       error:function(w,t,f){
           console.log(w);
           return;
       }
    }); 

    return;
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:58:16.190

正如评论中所说，当调用者页面被卸载时，ajax 调用被中止。但这并不意味着服务器没有收到呼叫，它只意味着服务器没有回复。为了最大限度地减少 ajax 调用所花费的时间，您可以使用“xhr.onprogress”（未在 jquery 的 $.ajax 中实现）等待对 ajax 调用的第一个响应，然后打开链接。

但是，如果您拥有服务器的控制权，只需将 '/mypath/myfile.php?redirect_url='+linkPath 重定向到 linkPath ：

```
header('location: '.$_GET['redirect_url']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T22:41:00.373

进行 ajax 调用，然后重定向用户。ajax 调用将在 window.location 更改之前发送。唯一不能解释的是 ajax 调用是否失败。

```
$(".example_class").click(function(e) {
    var linkPath = this.href; 
    var form_data = new Object();

    //Set the application ID for insert into the DB
    form_data.variableName = encodeURIComponent('ExampleName');

    //Send the data out to be processed and stored
    $.ajax({
       url:'/mypath/myfile.php',
       type:'POST',
       data:form_data,
       success:function(data){ alert('never alerts but request sent to server.'); },
       error:function(){  alert('page changes, but ajax request failed, sorry.'); }
    });
    window.location.href = linkPath;
    return;
}); 
```

另一个选项是使用 ajax 调用设置[onbeforeunload 事件。](http://upshots.org/javascript/window-onbeforeunload)

# datetime - 为什么 Data.Time.Clock 提供 DiffTime 和 NominalDiffTime？

> ID：13299054
> 
> 赞同：11
> 
> 时间：2012-11-08T22:33:33.210
> 
> 标签：datetime, haskell

`DiffTime` **提供和** [Data.Time.Clock](http://www.haskell.org/ghc/docs/7.0.4/html/libraries/time/Data-Time-Clock.html)背后的基本原理是`NominalDiffTime`什么？

目前，我认为两者都不需要。

另外，我不明白为什么`NominalDiffTime`有`diffUTCTime`，而`DiffTime`没有这样的功能。

`DiffTime`我的意思是，它看起来`NominalDiffTime`彼此并不真正“对称”。

也许总结一下：这些代数数据类型之间有什么区别？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-09T16:38:54.747

`NominalDiffTime`忽略闰秒，您可以确定`diffUTCTime`在 23:00 UTC 和第二天 01:00 UTC 之间始终是 2 小时，没有添加任何秒数。

的结果`DiffTime`可以被其他因素改变，例如闰秒。这与秒表一样测量：如果由于某些原因，UTC 23:00 和 UTC 01:00 之间不是 2 小时，则此类型将显示它。

在实践中，它们并没有什么不同。

**编辑：**他们有不同的目标。

*   `NominalDiffTime`用于计算时间之间的差异。
*   `DiffTime`用于测量时间（例如，使用秒表）。

# python - 如何使用 Python 在 Excel 2003 的工作表中嵌入绘图

> ID：13299058
> 
> 赞同：1
> 
> 时间：2012-11-08T22:33:48.377
> 
> 标签：python, excel, excel-2003, vba

我有以下函数做我想做的事情，除了我不想在新工作表上生成图表，我想将它嵌入到写入数据的工作表中。另外，如何删除图例？这是我所拥有的：

```
def Get_IV_Data(current_file):

    xlApp = win32com.client.Dispatch('Excel.Application')
    xlApp.Visible = True

    xlBook = xlApp.Workbooks.Add()

    xlSheet = xlBook.Sheets(1)
    xlSheet.Name = filename

    for i in range(0, 10):
        fluff = current_file.readline()

    Input_Parameters = fluff.split("\t")

    from operator import itemgetter
    Cal_Std_V = float(itemgetter(2)(Input_Parameters))

    xlSheet.Cells(1,1).Value = "V"
    xlSheet.Cells(1,2).Value = "I"
    xlSheet.Cells(1,3).Value = "P"

    output_line = 2

    # Assign the data to lists

    for line in current_file:
        try:
            a = line.split("\t")
            STD1, STD2, STD3, V, I, Vcorr, Icorr, v1, v2, v3 = a
            I = round(float(I) * (Cal_Std_V / float(STD1)), 6)
            P = round(float(V) * I, 3)
            xlSheet.Cells(output_line, 1).Value = V
            xlSheet.Cells(output_line, 2).Value = I
            xlSheet.Cells(output_line, 3).Value = P
            output_line += 1

        except ValueError:
            pass

    chart = xlApp.Charts.Add()
    chart.Name= "Plot "+xlSheet.Name
    series = chart.SeriesCollection(1)
    series.XValues= xlSheet.Range("A2:A200")
    series.Values= xlSheet.Range("B2:B200")
    series.Name= filename 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:44:34.220

`Chart`通过调用它的方法来设置 a 的位置，该`Location`方法有两个参数。

第一个被称为`Where`，它接受一个枚举，其名称`xlLocationAsNewSheet`分别为`xlLocationAsObject`、 和 ，`xlLocationAutomatic`其值分别为 1、2 和 3。

第二个参数是`Name`，它是工作表名称。

这是在 Python 中的：

```
xlLocation = {"AsNewSheet": 1,
              "AsObject": 2,
              "Automatic": 3 }
chart.Location(xlLocation["AsObject"], xlSheet.Name) 
```

如果您更喜欢幻数，可以将其更改为

```
chart.Location(2, xlSheet.Name) 
```

# php - 为什么我会从 Zend Studio 收到这些警告？

> ID：13299064
> 
> 赞同：1
> 
> 时间：2012-11-08T22:34:38.600
> 
> 标签：php, warnings, zend-studio

有几个类名让 Zend Studio 在我使用它们的任何地方都会给我如下警告：

```
Description                        Type
Class 'Column' not found           DLTK Problem 
```

但是，就像我的所有其他类一样，具有这些名称的类位于我的类文件夹中的文件中。任何想法为什么会发生这种情况以及如何避免它？

我在 Windows 上，我的 Zend Studio 版本是 9.0.4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T17:25:19.880

正如toxicate20 所注意到的，名称“Column”是 Zend API 的一部分，所以在我更改了类的名称后警告就消失了。无论如何，“列”可能不是一个好名字......

# c# - 使用 HTML Agility Pack 处理格式错误的 HTML

> ID：13299065
> 
> 赞同：1
> 
> 时间：2012-11-08T22:34:49.027
> 
> 标签：c#, html, html-parsing, html-agility-pack

我正在尝试在网站上抓取一个充满数据的 HTML 表格。不幸的是，该表的源代码如下所示：

```
<table border="1" cellspacing="0" cellpadding="3">

<tr>
<td bgcolor="silver"><font face="arial,helvetica" size="1">Last Name</font></td>

<td bgcolor="silver"><font face="arial,helvetica" size="1">First Name</font></td>

<td bgcolor="silver"><font face="arial,helvetica" size="1">Middle</font></td>
</tr>

<td valign="top"><font face="arial,helvetica" size="1">
Data</font></td>

<td valign="top"><font face="arial,helvetica" size="1">
Data</font></td>

<td valign="top"><font face="arial,helvetica" size="1">
Data</font></td>
</tr>   

<td valign="top"><font face="arial,helvetica" size="1">
More Data</font></td>

<td valign="top"><font face="arial,helvetica" size="1">
More Data</font></td>

<td valign="top"><font face="arial,helvetica" size="1">
More Data</font></td>
</tr>
</table> 
```

请注意标题后面的每一行都没有凝视的“tr”标签。该表在浏览器中显示良好，但 html 敏捷包将无法识别没有开始标记的 tr 元素。无论如何我可以获得html敏捷包来解决这个问题吗？我宁愿自己不插入 tr 标签，但如果必须的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:04:50.687

您可以尝试解析`td`s 并将它们按 3 个项目分组，

```
var list = doc.DocumentNode.Descendants("td")
            .Select((td, i) => new { td, i })
            .GroupBy(x => x.i / 3)
            .Select(g => g.Select(t => t.td.InnerText).ToList())
            .ToList(); 
```

# ruby - gruntjs vs 约曼 vs 守卫

> ID：13299068
> 
> 赞同：6
> 
> 时间：2012-11-08T22:35:01.170
> 
> 标签：ruby, node.js, guard, gruntjs, yeoman

我目前正在使用 guard 来观察我的 .coffee 和 .scss 文件的变化并适当地编译它们。

现在，gruntjs 和 yeoman 提供了类似的功能。

1.  从守卫转向 gruntjs 或 yeoman 的动机是什么？
2.  使用 yeoman 与 gruntjs 有什么好处，反之亦然？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-03T14:36:15.677

他们有完全不同的目的。

Guard 可与 grunt 任务[grunt-contrib-watch](https://github.com/gruntjs/grunt-contrib-watch)相媲美，后者在文件更改时运行任务。

Grunt 是一个基于任务的构建工具，它将枯燥的工作抽象为可重用的任务，因此您不必在每个项目中重新发明轮子。您可以做的不仅仅是观察变化。您可以连接、缩小 JS/CSS、编译 CoffeeScript/LESS/Sass 等。

Yeoman 建立在 grunt 和其他工具的基础上，并提供了一个自以为是的工作流程来构建前端 Web 应用程序。它不仅仅是咕噜声。

# python - Django在使用位置参数时如何确定模型中的字段顺序

> ID：13299072
> 
> 赞同：2
> 
> 时间：2012-11-08T22:35:12.560
> 
> 标签：python, django, model

我想知道在使用位置参数调用模型时是否有明确的字段顺序？

让我们以标准教程为例：

```
class Poll(models.Model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published') 
```

创建对象的标准方法是使用关键字参数，但我也可以这样做。

```
newPoll = Poll(123, "What is your favorite color?", timezone.now()) 
```

在这种情况下，值按以下顺序分配给字段：“id”、“question”和“pub_date”

我的问题是 Django 如何将这些位置参数映射到模型的字段变量？如果这有一个一致的逻辑，那么我可以在模型类或 manager.create 方法中使用位置参数吗？（这可能不是一个好主意，仅用于学术目的）

我曾尝试阅读 Django 源代码中的 base.py 文件，但由于我刚刚开始使用 Django，所以我需要一些时间来理解所有内容。因此，如果有人可以解释这一点，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T21:17:06.677

[该文档](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#create)仅将 create 方法称为`create(**kwargs)`，因此我将位置参数视为未记录的行为，并且对于可维护的代码不可靠。在我的 Django 版本中，这正是来源`QuerySet`所说的，所以位置参数不起作用，除非有一些我没有看到的魔法，但它可能与你的版本不同。

# php - Symfony2：在表单组件中注入 translation_domain 的位置

> ID：13299073
> 
> 赞同：6
> 
> 时间：2012-11-08T22:35:27.977
> 
> 标签：php, symfony

*我使用 Symfony 2 的表单组件*创建了一个表单。由于验证错误在不同的翻译域中翻译，我想在创建表单期间将此信息作为选项 (translation_domain) 注入，但找不到正确的 (成功) 点在哪里设置...任何提示？

我使用自定义类型来捆绑我的表单信息。

我的自定义类型类：

```
use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

use Symfony\Component\Validator\Constraints\Collection;
use Symfony\Component\Validator\Constraints\NotBlank;

class LoginType extends AbstractType
{

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $collectionConstraint = $collectionConstraint = new Collection(array(
            'password' => array(new NotBlank(array('message' => 'custom.error.blank'))),
            'username' => array(new NotBlank(array('message' => 'custom.error.blank')))
        ));

        $resolver->setDefaults(array(
            'constraints' => $collectionConstraint
        ));
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('username', 'text', array(
            'max_length'        => 250,
            'trim'              => true
        ));
        $builder->add('password', 'password', array(
            'max_length'        => 250,
            'trim'              => true
        ));
    }

    public function getName()
    {
        return 'login';
    }
} 
```

在控制器中创建表单的相关代码片段：

```
$loginForm = $this->createForm(new LoginType(), $loginDefaultData);

$loginForm->bind($request);

[...]

return $this->render(
    'MyBundle:SubFolder:login.html.twig',
    array(
        'loginForm' => $loginForm->createView()
    )
); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-13T19:26:24.903

过了一会又回到这个问题，我找到了原因：动态translation_domain可以在setDefaultOptions中设置如下。

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    // ...

    $resolver->setDefaults(array(
        'constraints'        => $collectionConstraint,
        'translation_domain' => 'customTranslationDomain'
    ));
} 
```

但是，在使用的 twig 模板中，此 translation_domain 用于标签和选项，但此 translation_domain 不提供错误消息。它们总是在默认的树枝模板中使用相同的固定设置域“验证器”进行翻译

> /Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig

将这些消息捆绑在一个域中通常是有意义的，但在我的情况下则不然，因为必须根据上下文以不同的方式翻译相同的约束（及其错误消息），并且每个上下文都组织在一个孤立的域中。

我的解决方案是[按照 Symfony2 文档中的描述自定义表单渲染](http://symfony.com/doc/2.0/cookbook/form/form_customization.html)，重新定义 form_errors 片段并使用动态 translation_domain twig 变量也用于错误消息输出。

# php - PHP URL 配置

> ID：13299078
> 
> 赞同：1
> 
> 时间：2012-11-08T22:35:47.500
> 
> 标签：php

我有一个快速的问题。

```
<a href="#/media/<?php echo $row['id'] ?>.<?php echo $row['news_title'] ?>">Read More</a> 
```

基本上，一旦我点击“阅读更多”，它就会显示我的网址。我添加了

```
.<?php echo $row['news_title'] ?> 
```

之前`">`

基本上，它会显示`ID.THE-TITLE-HERE`

但是，它不起作用，当我在“。”之后手动添加文章的网址中的“-”时，它确实起作用，但它不起作用。

[如果您访问http://www.krissales.com/#/media/blog](http://www.krissales.com/#/media/blog)，您会明白我的意思

点击“阅读更多”，它不会显示任何内容，但如果你在“测试”和“2”之间添加一个“-”，它会起作用。

有人知道我该如何解决这个问题吗？告诉我我能做什么，我想在做的同时学习。

完整的 .php 页面位于 krissales.com/blog.txt

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:09:31.043

我注意到在我打字的时候有人给出了简单的答案，但我认为我的回答会帮助你进一步理解。

首先是测试：

*   “http://www.krissales.com/media/3”作品
*   “http://www.krissales.com/#/media/3”作品
*   “http://www.krissales.com/#/media/3.Testing 3”不起作用。
*   “http://www.krissales.com/#/media/3.Testing-3”有效。
*   "http://www.krissales.com/#/media/3.Testing%203" 有效（%20 是 URL 编码的空格等价物）。

问题可能是您如何处理哈希标签等。

首先，据我所知，你可以让它以多种方式工作：

1.  而不是： `<?php echo $row['news_title'] ?>` 您可以使用 `<?php echo urlencode($row['news_title']) ?>` which 将确保没有使用空间。

2.  如果您喜欢用破折号替换空格，那么您可以像这样使用 str_replace() 函数 (http://www.php.net/str_replace)： `<?php echo str_replace(' ', '-', $row['news_title']); ?>`

这将起作用，但是，我认为这不能解决核心问题，这可能是您处理调用的地方（/_lib/_js/core.js 文件中的代码）等。

PS 你需要确保你转义 URL 变量、HTML 内容等——在 PHP urlencode()、htmlspecialchars() 中查看这些函数——但如果你用其他语言（如 javascript）构建代码，同样的逻辑适用. 这可能会以某种方式隐藏代码中处理 URL 等的核心问题。它是软件开发中多个问题的根源。;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T22:40:39.747

改变

```
echo $row['news_title'] 
```

至

```
echo str_replace(" ","-",$row['news_title']); 
```

这将用连字符替换空格

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T22:45:20.410

如果`$row['id']`是 99 并且`$row['news_title']`是“标题”，那么下面的代码将用于`str_replace`输出“99.The-title”。

```
<a href="#/media/<?php echo $row['id'] ?>.<?php echo str_replace(" ", "-", $row['news_title']); ?>">Read More</a> 
```

# time - 带有项目概述的时间跟踪软件

> ID：13299086
> 
> 赞同：0
> 
> 时间：2012-11-08T22:36:16.673
> 
> 标签：time, project-management

有谁知道像“toggl”这样的时间跟踪软件，它提供了非常基本的项目、任务、时间记录，但它可以让你为每个项目添加开始和结束日期，这样你就可以看到有多少项目在你的年历。我们不想要所有其他高级功能，只是时间跟踪和在年度日历中查看项目的能力。我在任何地方都找不到！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T02:19:50.707

你可以试试[时间医生](http://www.timedoctor.com)。它具有时间跟踪，可以随时随机截图，以及许多其他软件没有的有用功能。我们主要用它来监控我们的自由职业者，这样我们就可以了解他们如何将时间花在做富有成效的事情上。

# sql - 层次查询结果中的 PostgreSQL 排序记录

> ID：13299091
> 
> 赞同：2
> 
> 时间：2012-11-08T22:36:38.770
> 
> 标签：sql, postgresql, hierarchy, postgresql-9.1

我正在尝试做一些应该很简单的事情，但我错过了一些东西。我正在尝试以分组和有序的形式返回一些分层数据。a 我不是试图解释，而是附上一张图片……听说它们值一千字：

![数据库中数据的顺序与结果集需要的顺序。](../Images/03b8afc4c48ab4916caded69612faf7b.png)

请注意，硬编码值不好，因为主要选择标准将是 article_id，然后按照文章的第一个“根级别”article_comment_id 及其子节点排序，然后是下一个“根级别”article_comment_id及其子节点。

我提供了一个示例表和数据，以便您了解我的意思，以及显示我想要实现的目标的屏幕截图。

```
CREATE TABLE test_comment
(
  article_comment_id bigserial NOT NULL,
  article_id bigint NOT NULL,
  parent_comment_id bigint,
  comment text NOT NULL,
  comment_depth integer,
  CONSTRAINT test_comment_pkey PRIMARY KEY (article_comment_id )
)

INSERT INTO test_comment (article_comment_id, article_id, parent_comment_id, comment, comment_depth)
VALUES
 (1, 100, 0, 'First Root Comment', 0)
,(5, 100, 0, 'Second Root Comment', 0)
,(2, 100, 1, 'Reply 1 to Root Comment', 1)
,(3, 100, 2, 'Reply 2 to Reply 1', 2)
,(4, 100, 3, 'Reply 3 to Reply 2', 3)
,(6, 100, 2, 'Reply 4 to Reply 1', 2)
,(7, 100, 5, 'Reply 5 to Second Root Comment', 1); 
```

我试过这个，但它没有提供正确的顺序：

```
with recursive comment_list(article_comment_id, parent_comment_id, comment, article_id) AS (
    select c.article_comment_id, c.parent_comment_id, c.comment, c.article_id
    from test_comment c
    where article_id = 100
  union
    select c.article_comment_id, c.parent_comment_id, c.comment, c.article_id
    from test_comment c, comment_list cl
    where c.article_comment_id = cl.article_comment_id
    )
    select * from comment_list; 
```

无论如何，这个 PostgreSQL 特定查询可以与 JPA 一起使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T22:41:25.970

您需要将根文章 id “携带”到每个节点并计算层次结构级别才能获得该排序：

```
with recursive comment_list(article_comment_id, parent_comment_id, comment, article_id, level, root_id) AS (
    select c.article_comment_id, 
           c.parent_comment_id, 
           c.comment, 
           c.article_id, 
           0 as level,
           article_comment_id as root_id 
    from test_comment c
    where article_id = 100
      and parent_comment_id = 0

  union

    select c.article_comment_id, 
           c.parent_comment_id, 
           c.comment, 
           c.article_id, 
           cl.level + 1,
           cl.article_comment_id 
    from test_comment c
       join comment_list cl on c.parent_comment_id = cl.article_comment_id
)
select article_comment_id, 
     parent_comment_id, 
     comment, 
     article_id
from comment_list
order by root_id, level; 
```

SQLFiddle：[http ://www.sqlfiddle.com/#!12/af0d6/4](http://www.sqlfiddle.com/#!12/af0d6/4)

（顺便说一句：你在联合的递归部分加入错误）

# xml - XSL 中的格式化和计算

> ID：13299093
> 
> 赞同：2
> 
> 时间：2012-11-08T22:36:47.883
> 
> 标签：xml, math, xslt, format

我有这个使用 XSL 的 DataView。一栏是一个链接。我用作查询字符串键 {@Title} 的字段需要更改链接。

*   它目前是 9 位数字，我需要删除第一个数字。
*   剩下的8个数字需要乘以8

所以 N00000010 变成 00000080

下面的代码只是输出

[https://myserver.edu/zzz/r.aspx?key=N00000010](https://myserver.edu/zzz/r.aspx?key=N00000010)

但应该是

[https://myserver.edu/zzz/r.aspx?key=00000080](https://myserver.edu/zzz/r.aspx?key=00000080)

更新：如果溢出，如果需要，输出可以超过 8 位，实际上，这是可以接受的，甚至更可取。

[https://myserver.edu/zzz/r.aspx?key=80](https://myserver.edu/zzz/r.aspx?key=80)

```
 <td class="ms-vb">
            <xsl:value-of select="@Supervisor" /></td><td class="ms-vb">
            <xsl:value-of select="format-number(@StartingSickBalance, '#,##0.00;-#,##0.00')" /></td><td class="ms-vb">
            <xsl:value-of select="format-number(@FiscalStartingBalance, '#,##0.00;-#,##0.00')" /></td><td class="ms-vb">
            <a href="https://myserver.edu/zzz/r.aspx?key={@Title}">See Balances</a>
            </td><td class="ms-vb"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:57:06.773

**更新：**

如果不需要用前导 0 来限制输出，那么以下应该可以工作：

```
 <xsl:variable name="linkId" select="number(substring({@Title}, 2,8)) * 8" />
  <a href="https://myserver.edu/zzz/r.aspx?key={$linkId}">Test</a> 
```

或者，正如@DevNull 提到的，没有变量：

```
<a href="https://myserver.edu/zzz/r.aspx?key={number(substring(@Title, 2,8)) * 8}">Test</a> 
```

这将产生输出：

```
<a href="https://myserver.edu/zzz/r.aspx?key=80">Test</a> 
```

**较早的答案**

一种方法是对原始字符串进行子串化以删除前导字母：

```
substring({@Title}, 2, 8) 
```

这给了我们：`00000010`

然后我们在前面放置一个 1 以保持领先的 0：

```
concat(1, substring({@Title}, 2, 8)) 
```

给予：`100000010`

然后我们可以转换为数字并将其乘以 8：

```
number(concat(1, substring({@Title}, 2, 8))) * 8 
```

给予`800000080`

然后再次子串：

```
substring(number(concat(1, substring({@Title}, 2, 8))) * 8, 2, 8) 
```

给：`00000080`

把它们放在一起：

```
<xsl:value-of select="substring(number(concat(1, substring({@Title}, 2, 8))) * 8, 2, 8)" /> 
```

要在输出中使用它：

```
 <xsl:variable name="linkId" select="substring(number(concat(1, substring({@Title}, 2, 8))) * 8, 2, 8)" />
  <a href="https://myserver.edu/zzz/r.aspx?key={$linkId}">Test</a> 
```

似乎有点啰嗦，但有效。我无法`format-number`在我的 xsl 解析器（C#、.Net 4.0）中维护前导零

如果`format-number`对您有用，那么以下内容会更优雅：

```
 <xsl:variable name="linkId" select="format-number(number(concat(1, substring({@Title}, 2, 8))) * 8, '00000000')" />
  <a href="https://myserver.edu/zzz/r.aspx?key={$linkId}">Test</a> 
```

但是，正如@MvG 指出的那样，如果您乘以 8 会溢出原始的 8 位数字，则 8 位数字可能会变为 9。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:04:39.003

我得到了一个与破折号非常相似的解决方案，只是我使用了带有格式说明符“0”的 format-number() 而不是 concat()。

```
<xsl:value-of select="format-number(number(substring({@Title}, 2,8))*8, '00000000')" /> 
```

它在 VS2010 中对我有用。

# php - Yii - 在表单中保存 MANY_MANY 关系？

> ID：13299095
> 
> 赞同：0
> 
> 时间：2012-11-08T22:36:50.103
> 
> 标签：php, yii, many-to-many

我有 3 个表，联系人、组和联系人组。

所有模型关系均已正确设置：

联系方式.php

```
'groups' => array(self::MANY_MANY, 'Group', 'contact_group(contact_id,group_id)'), 
```

组.php

```
'contacts' => array(self::MANY_MANY, 'Contact', 'contact_group(group_id,contact_id)'), 
```

如果我手动创建关系，我可以使用 Yii 的 Active Record 很好地查询它们。

* * *

我想要完成的是构建一个表单，以便当用户创建联系人时，他们可以在开始时将联系人分配给一个组。我的表格如下所示：

```
<?php echo $form->dropDownListRow($model, 'groups', Group::getActiveGroups(), array('multiple'=>true)); ?> 
```

这完美显示，所有组都显示我想要的方式。当用户选择一两个组时，他们会被提交。我希望这就是将用户保存在`contact_group`表中所要做的一切，但事实并非如此。我可以启动一个`afterSave`事件来处理插入，但只是想检查 Yii 是否有任何事情可以自行处理。

# ruby-on-rails - 尝试从 gem 1.9.2 安装时 Rails 失败

> ID：13299100
> 
> 赞同：0
> 
> 时间：2012-11-08T22:37:07.180
> 
> 标签：ruby-on-rails, ruby, gem, rvm, ubuntu-12.04

我正在尝试在我今天刚刚安装的 Lubuntu 机器上安装 RoR，我已经安装了所有 rvm 要求安装的 Ruby。当我去安装rails时，我不断收到这个错误。

运行命令`sudo gem install rails -V`，它看起来像是在尝试为 ruby​​ 1.9.1 提取源代码，但我有 1.9.2，然后它失败了，无法加载此类文件 --mkmf (LoadError)。

任何帮助将不胜感激，这是我对 Ruby 的第一次冒险，所以这是我的第一次设置。问任何问题，我会回答。

![在此处输入图像描述](../Images/dcc6dcba587383dc2eba8d1625b68794.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:39:09.203

不要`sudo`用来安装您的 rails gem，因为这将切换到其他用户，该用户无权访问您的 RVM 安装。只需使用`gem install rails`.

我仍然建议卸载系统 Ruby。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T22:56:11.540

首先，您需要一些 RVM 预安装，打开终端并输入：

```
$> sudo apt-get install curl git ruby1.8 
```

然后下载并安装 RVM 本身：

```
$> curl -L get.rvm.io | bash -s stable 
```

安装完成后，加载 RVM：

```
$> source ~/.rvm/scripts/rvm 
```

要检查 RVM 是否作为函数安装，请键入：

```
$> type rvm | head -1

(it should output "rvm is a function") 
```

为了工作，RVM 需要安装一些它自己的依赖项。你可以看到这些在使用什么：

```
$> rvm requirements 
```

对于 Ruby / Ruby HEAD（MRI、Rubinius 和 REE），安装以下内容：

```
$> sudo apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion pkg-config 
```

一旦你使用了 RVM，安装 Ruby 就很容易了：

```
$> rvm install 1.9.3 
```

在较新版本的 Rails 中，您还需要一个 Javascript 运行时，因此：

```
$> sudo apt-add-repository ppa:chris-lea/node.js
$> sudo apt-get update
$> sudo apt-get install nodejs 
```

我们可以继续使用 RVM 安装 gems：

```
$> rvm rubygems current 
```

一切准备就绪后，就该安装 Rails 了：

```
$> gem install rails 
```

* * *

附言

安装后和故障排除。

当我们禁用 GNOME 终端的“作为登录 shell 运行命令”时，rvm 无法作为函数加载，因此输入：

```
$> type rvm | head -1 
```

输出类似“rvm is /home/mercurial/.rvm/bin/rvm”的内容。

为了解决这个问题，编辑 ~/.bashrc 并在文件末尾添加以下行：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" # This loads RVM into a shell session. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:43:28.450

首先：您似乎根本没有使用 rvm 安装它。使用 rvm 时，它应该安装在您的家中或 /usr/share 中。/usr/lib 上的这个安装是关于 ruby​​ 的正常安装。

要将它安装在系统上而不是 rvm 上，你应该安装 ruby​​ 包的开发版本，比如

```
apt-get install ruby1.9-dev 
```

但是，如果你想不使用 rvm，因为我认为你想要你应该安装它

```
rvm install 1.9.3. 
```

如果不是你的情况，请告诉我。

# c++ - 如何在 C++ 中对用户提交的变量列表执行多项操作

> ID：13299108
> 
> 赞同：0
> 
> 时间：2012-11-08T22:38:00.280
> 
> 标签：c++, function, input

该程序接受用户输入的一些基本棒球统计数据，并执行一些操作，最终输出一个复杂的统计数据。虽然我们才刚开始学习函数，但我第一次尝试用函数做这个程序，失败得很惨。我认为该程序可以在没有功能的情况下执行，到目前为止，这是我的代码：

（发布系统拒绝让我在 #include < 之后输入任何内容，但我使用的是 iostream、iomanip、conio.h 和 cmath。）

```
using namespace std;   

int main()   

{   
    int H, TB, BB, HBP, AB, YEAR, LGRS, LGPA;   
    double REqA, EqR, RA, WIN, AEqA, LGEqA, aWIN;   

    cout << "Enter the player's at bats." << endl;   
    cin >> AB;   

    cout << "Enter the player's hits." << endl;   
    cin >> H;   

    cout << "Enter the player's total bases." << endl;   
    cin >> TB;   

    cout << "Enter the player's walks." << endl;   
    cin >> BB;   

    cout << "Enter the player's times hit by pitch." << endl;   
    cin >> HBP;   

    cout << "Enter the year the player played." << endl;   
    cin >> YEAR;   

    if (YEAR != 2012)   
    {   
       cout << "Sorry, this program only supports the 2012 season." << endl;   
    }   

    else  

    {   
       LGRS = 21017;   
       LGPA = 184179;   
       LGEqA = 0.72401;   

    }      

    REqA = (H + TB + (1.5 * (BB + HBP))) / (AB + BB + HBP);   

    EqR = (2 * REqA / LGEqA - 1) * (AB + BB + HBP) * (LGRS / LGPA);   

    WIN = (EqR * EqR) / ((EqR * EqR) + (RA * RA));   

    aWIN = (WIN / (1 - WIN));   

    AEqA = pow(aWIN, 0.2) * 0.26;   

    cout << "The player had a " << AEqA << " EqA in " << YEAR << "." << endl;   

    getch();   

    return 0;   

} 
```

AEqA 的最终输出始终为 0，无论一开始输入什么数字。如果我将程序设置为输出 REqA，则程序正在输出它应该输出的数字。但是我需要为 AEqA 的最终输出执行之后的所有步骤，并且最终结果总是为零。我认为问题在于计算 EqR 的行，因为如果我设置程序输出 EqR，输出也始终为 0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:44:15.017

使用 getline 进行用户输入会是更好的做法

```
#include <iostream>
#include <string>
using namespace std;

int main ()
{

  int H, TB, BB, HBP, AB, YEAR, LGRS, LGPA;   
  double REqA, EqR, RA, WIN, AEqA, LGEqA, aWIN; 

  cout << "Enter the player's at bats.? " << endl;
  getline (cin, AB);

  //etc ...

   return 0; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T22:49:45.610

这条线

```
 WIN = (EqR * EqR) / ((EqR * EqR) + (RA * RA)); 
```

你的变量`RA`永远不会被初始化。在这种情况下，它可能默认初始化为零。在这种情况下，这将导致

```
WIN = 1 
```

所以当你这样做时

```
aWIN = (WIN / (1 - WIN)); 
```

所以你正在做一个浮点除以零，这应该导致无穷大。我不确定调用`pow`infinity 有什么作用，但我猜它不好。我不知道你的变量代表什么，但你总是会遇到这个问题

```
RA = 0 
```

所以将它初始化为某些东西或捕获用户输入值是个好主意。我强烈建议使用调试器来检查您的变量在程序运行时是否被正确设置/计算。

另请注意，您在这里通过整数除法得到零 - 您设置

```
LGRS = 21017;   
LGPA = 184179; 
```

然后在这条线上

```
EqR = (2 * REqA / LGEqA - 1) * (AB + BB + HBP) * (LGRS / LGPA); 
```

的结果

```
(LGRS / LGPA) 
```

始终等于零，因为`LGRS < LGPA`. 两种整数类型的除法结果毫无疑问是整数，当分子和分母都是正数，但分子小于分母时，结果将为零（在本网站或一般网络上研究**整数除法）。**因此，您的产品包含零项，因此`EqR == 0`

# android - 在资产文件夹中苦苦挣扎

> ID：13299110
> 
> 赞同：0
> 
> 时间：2012-11-08T22:38:24.703
> 
> 标签：android, directory, assets, directory-listing

我一直在努力处理一个简单的资产目录列表。我有以下结构（粗略地说）：

```
-dirA
--data.xml
--AudioSUBdir
---some files here
--VideoSUBdir
---some files here
-dirB
--data.xml
--AudioSUBdir
---some files here
-test    
--SUBtestDir 
```

我想要的只是父资产目录的列表（即 dirA、dirB 和 test；然后我将读取 data.xml 文件并在此基础上对子目录的内容做一些事情）。

我认为获得所需的两个字符串很容易：

```
try {
   String[] fileNames;
   fileNames = getAssets().list("");
   for(String name:fileNames){
      // process it, e.g. write it out }
} catch (IOException e) {} 
```

但是，我得到的是类似 AudioSUBdir、dirA、dirB、VideoSUBdir、webkit 的东西（根本没有该死的 webkit！）它似乎同时在做几件奇怪的事情：

*   它忽略目录结构，即甚至读取它不应该读取的子目录
*   它神奇地显示了一个 webkit 目录，尽管整个项目文件夹中没有任何内容
*   它完全忽略了“测试”目录

所以我的问题是两个（半）

1.  我如何只获取根文件夹（我想稍后测试它们是否存在文件夹/data.xml，它将被处理并且应用程序将执行它应该做的任何事情）
2.  对正在发生的事情的任何解释。我理论上可以处理它甚至写出子目录的事实，尽管我不想要它们。我什至可以克服它忽略测试文件夹的事实（也许是因为它们是空的？ - 好吧，空的，只包含一个子目录，而不是一个文件，但无论如何......）但是 webkit 文件夹到底是从哪里来的？它是由 apk 构建过程以某种方式“后生成”的吗？
3.  我感觉所有子文件夹实际上都折叠到一个根目录中。是不是意味着同名文件会在构建过程中发生冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T10:48:39.363

就我的问题的第一个（也是主要）问题而言，我想我已经弄清楚了。

```
try {
   String[] fileNames;
   fileNames = MyAudioGuideApplication.this.getAssets().list("");
   for(String name:fileNames){
       if (Arrays.asList(getResources().getAssets().list(name)).contains("data.xml"))
        process.the.file.here
   }
} catch (IOException e) {} 
```

我仍然不确定 getAssets 究竟是如何工作的，但至少结果如下：

*   如果文件夹不包含文件，则忽略它们
*   无论结构如何，输出都按字母顺序排序
*   当从根文件夹调用时 - 即 ...list("") - 它甚至列出子目录

也许它可以帮助像我一样挣扎的人。

# mysql - 无法安装 mysql2 gem。安装找不到mysql.h

> ID：13299113
> 
> 赞同：2
> 
> 时间：2012-11-08T22:38:36.247
> 
> 标签：mysql, ruby-on-rails-3, rubygems

我正在尝试安装mysql2：

```
sudo gem install mysql2 -v '0.2.7' -- --with-mysql-config=/usr/local/Cellar/mysql/5.5.25a/bin/mysql_config 
```

我收到此错误：

```
ERROR:  Error installing mysql2:
    ERROR: Failed to build gem native extension.

       /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb --    with-mysql-config=/usr/local/Cellar/mysql/5.5.25a/bin/mysql_config
checking for rb_thread_blocking_region()... no
checking for mysql.h... no
checking for mysql/mysql.h... no
-----
mysql.h is missing.  please check your installation of mysql and try again.
-----
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options. 
```

我的 mysql 安装是通过 brew 安装的，所以我的 mysql.h 文件位于：

```
/usr/local/Cellar/mysql/5.5.25a/bin/mysql_config 
```

这就是为什么我有 with-mysql-config 标志

mysql_config 文件正在这里寻找 mysql.h 文件：

```
$basedir/include/mysql/mysql.h 
```

应该补充一点，我更新了我的 gemfile

宝石'mysql2

宝石'mysql2'，'0.2.7'

因为，我收到了一些关于 mysql2 0.3.* 没有活动记录支持的弃用警告。所以要么必须将rails升级到3.1，要么降级mysql2。我选择了后者。

我应该编辑 mysql_config 还是我可以做些什么来解决这个问题？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-28T14:23:28.783

我意识到这是一个老问题，但对于从谷歌来到这里的任何人，我发现这个解决方案对我有用：[http://www.randomactsofsentience.com/2013/05/gem-install-mysql2-missing-mysqlh-on-os。 .html](http://www.randomactsofsentience.com/2013/05/gem-install-mysql2-missing-mysqlh-on-os.html) _

`-Wno-null-conversion -Wno-unused-private-field`简短的版本是从第 120 行左右删除编译器标志`/usr/local/Cellar/mysql/5.6.12/bin/mysql_config`（用你必须找到的文件替换 mysql 版本）。

我在 OSX 上使用 ruby​​ 1.9.3 自制 mysql 和 rvm。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T22:43:22.727

您应该安装`mysql-dev`软件包，这里有一些用于编译本机驱动程序的头文件。

# mysql - 在 ActiveRecord 中有效地批量更新？

> ID：13299114
> 
> 赞同：6
> 
> 时间：2012-11-08T22:38:55.790
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord

如何有效地批量更新 ActiveRecord 中的记录？我正在尝试填充依赖于另一列的列。

这是我现在的代码：

```
Tweet.find_in_batches do |group|
  to_be_saved = []
  group.each do |t|
    t.creation_date_posix = DateTime.strptime(t.creation_date_str, '%m/%d/%Y %H:%M').to_time.to_i
    to_be_saved << t
  end
  Tweet.transaction do
    to_be_saved.each{|t| t.save}
  end
end 
```

但它并没有提高效率。显然`transaction`不是正确的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T22:41:03.727

[通常，您可以使用update_all](http://apidock.com/rails/ActiveRecord/Relation/update_all)`n`将它们全部合并为一个，而不是将批量更新分散在sql 写入语句上。（取决于很多变量）这可以提高你的整体表现。

# jquery-ui - 从 href 链接到 jQuery 选项卡

> ID：13299115
> 
> 赞同：1
> 
> 时间：2012-11-08T22:38:59.443
> 
> 标签：jquery-ui, jquery-tabs

我正在尝试从**href**链接到 jQuery 选项卡，但它似乎不起作用。你如何去做这件事。我希望在用户单击链接时打开一个选项卡。到目前为止，这是我的代码：http: [//jsfiddle.net/AXEEe/](http://jsfiddle.net/AXEEe/)。

**HTML**

```
<a href="#Allocated">Allocated</a>
<a href="#Declined">Declined</a>
<a href="#Pending">Pending</a>
<a href="#Failed">Failed</a>

<div style="padding-top: 10px">
  <div id="tabs">
    <ul>
      <li><a href="#Allocated" id="#Allocated">Allocated Requests</a></li>
      <li><a href="#Declined">Declined Requests</a></li>
      <li><a href="#Pending">Pending Requests</a></li>
      <li><a href="#Failed">Failed Requests</a></li>
      </ul>
          <div id="Allocated">
              Content 1
          </div>
          <div id="Declined">
              Content 2
          </div>
          <div id="Pending">
              Content 3
          </div>    
          <div id="Failed">
              Content 4
          </div>
        </div>
</div> 
```

​<strong>JS

```
$(function() {
        $( "#tabs" ).tabs();
});​ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:44:45.377

要选择带有链接的选项卡，请执行以下操作：http: [//jsfiddle.net/AXEEe/1/](http://jsfiddle.net/AXEEe/1/)

```
<a id="0" href="#">Allocated</a>
<a id="1" href="#">Declined</a>
<a id="2" href="#">Pending</a>
<a id="3" href="#">Failed</a>

    $('a').click(function(){
       $("#tabs").tabs("option", "active", parseInt(this.id));
    }); 
```

对于此示例，我刚刚使用选项卡链接添加`id`到您的`<a>`链接。你可以做得更好。到你的项目。询问您是否有更多问题

**编辑**

更新选项卡部分方法以符合 JQUery UI 1.9

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:07:01.470

```
$(function() {
    $("#tabs").tabs();
    $("a[href=#Allocated]").click(function() {
        $("#tabs").tabs("option", "active", 0);
    });
    $("a[href=#Declined]").click(function() {
        $("#tabs").tabs("option", "active", 1);
    });
    $("a[href=#Pending]").click(function() {
        $("#tabs").tabs("option", "active", 2);
    });
    $("a[href=#Failed]").click(function() {
        $("#tabs").tabs("option", "active", 3);
    });
});​ 
```

[小提琴](http://jsfiddle.net/barmar/AXEEe/2/)

# android - 寻找一种在android中显示表格的简单方法，使用App Inventor

> ID：13299116
> 
> 赞同：3
> 
> 时间：2012-11-08T22:39:00.583
> 
> 标签：android, app-inventor

我一直在麻省理工学院网站上使用 App Inventor 来制作简单的计算器来进行工作估算。预先确定的公式嵌入到应用程序中，允许将用户输入的数据转换为可用信息 - 比使用常规计算器手动操作更快、更可靠。

我接下来想做的是根据标准化数据制作可滚动的参考图表——比如 AWG 图表。列可以是线规、线径、每英尺线重等。行将只是不同的线尺寸 - 即 8 号、10 号、12 号等。

目前，图表的每个“单元格”都是一个单独的文本标签。

表格排列将不起作用，因为它不会将各个列缩放到屏幕的宽度 - 仅缩放到每列中最大项目的宽度。到目前为止，水平排列的单行似乎是唯一的解决方案——因为它将缩放每一列并将其居中，将它们均匀地分布在整个屏幕宽度上——但这仍然非常耗时。

任何关于如何通过 App Inventor 在 Android 上获取可滚动表格的“更好”建议将不胜感激。我可能已经走在正确的轨道上，而前方任务的艰巨性就是如此令人生畏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T14:16:59.500

我为您准备了另一个示例，假设数据存储在 2 个列表中，它使用 1 个水平排列和 2 个标签（每列 1 个标签） ![在此处输入图像描述](../Images/f8d8c231516411cb643cec1c8661bc99.png)

![在此处输入图像描述](../Images/7734b89f3acf2c00fce44aa55673bf6e.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-09T23:28:30.383

在 YouTube 上找到了一个出色的解决方案 - TutorialMaster 于 2015 年 5 月 10 日发布。

它不是英文的，但很容易理解。全部使用 csv 文件和列表。

[Youtube 视频](https://www.youtube.com/watch?v=aDpub3elQ9c)

[![截屏](../Images/edcce9f0e761c49b236ee4814c44605e.png)](https://i.stack.imgur.com/BUWDl.png)

# c# - 如何将函数返回值编组到非托管 dll

> ID：13299119
> 
> 赞同：3
> 
> 时间：2012-11-08T22:39:22.567
> 
> 标签：c#, c++, com, marshalling, com-interop

我有一个用 C# 编写的 dll，并暴露给 COM。我在构建器中使用 dll ...我可以实例化该类，但在编组来自 C# 方法调用的返回值时遇到问题。

C＃

```
public string GetValue([MarshalAs(UnmanagedType.LPWStr)] string key)
{
   return "value";
} 
```

导入构建器时的翻译函数：

```
virtual HRESULT STDMETHODCALLTYPE GetValue(LPWSTR key/*[in]*/, 
                                           BSTR* pRetVal/*[out,retval]*/) = 0; 
```

我对C++知之甚少。'key' 参数可以很好地传递，因为我可以在参数上使用 'MarshalAs' 属性，但我要么不知道如何为返回值声明它，要么不知道如何调用C++ 端的函数（我已经尝试了几件事，只是猜测）。

更新：好的，我只是以安东的例子并尝试根据汉斯的评论进行修改来解决这个问题。Antons 的回答正如他所展示的那样工作，但由于对内存管理问题的担忧，我最终没有在 C# 中应用 return 属性，并且 C++ 代码调用该函数如下：

```
BSTR result;
obj->GetValue(key, &result);
SysFreeString(key);
SysFreeString(result); 
```

我希望我能将这两个答案归功于帮助我解决这个问题，它们都是为我提供所需信息所必需的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T00:58:03.580

您可以应用 [return:] 属性，但这是一个非常糟糕的主意。这个函数签名的问题是被调用者必须为字符串分配缓冲区，而调用者必须释放它。这要求两者都使用相同的堆。当您强制它使用 LPWSTR 时，情况**并非**如此，CLR 使用它自己的堆并且您无法从本机代码中获取它，您无法获得所需的堆句柄。

两段代码**必须**使用相同的堆。并且有一个专门用于此目的的 COM 堆。BSTR 是使用该堆的字符串类型，CLR 自动使用它，正如您从签名中可以看出的那样。要使用它，只需在调用后访问 pRetVal 指针，它实际上是一个 wchar_t*。然后你必须释放它，调用 SysFreeString()。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-09T00:08:41.913

要将属性应用于返回值：

```
[return: MarshalAs(UnmanagedType.LPWStr)]
public string GetValue([MarshalAs(UnmanagedType.LPWStr)] string key)
{
   return "value";
} 
```

您将需要使用（我认为）手动释放字符串`CoTaskMemFree`：

```
LPWSTR result ;
if (SUCCEEDED (obj->GetValue (key, &result)))
{
    // use result and free it when no longer needed
    CoTaskMemFree (result) ;
} 
```

# core-data - 更改谓词后，NSFetchedResultsController 的委托不会触发

> ID：13299120
> 
> 赞同：8
> 
> 时间：2012-11-08T22:39:36.147
> 
> 标签：core-data, delegates, nsfetchedresultscontroller, predicate

我已经解决这个问题几个小时了，到目前为止没有成功。我在这里阅读了所有可能与我的问题有关的问题。

我有两个实体（A，B），它们通过像这样的一对多关系以树状结构相互连接：A <--->> B。

有一个由 NSFetchedResultsController 支持的 UITableViewController 来显示与实体 A 的选定对象相关的实体 B 的所有对象。我为此使用谓词：

```
 - (NSFetchedResultsController *)fetchedResultsController
{
if (_fetchedResultsController != nil) {
    return _fetchedResultsController;
}

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"B" inManagedObjectContext:self.managedObjectContext];
[fetchRequest setEntity:entity];

[fetchRequest setFetchBatchSize:20];

NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"controlDate" ascending:NO];
NSArray *sortDescriptors = @[sortDescriptor];
[fetchRequest setSortDescriptors:sortDescriptors];

NSMutableArray *subpredicates = [NSMutableArray array];
NSPredicate *predicate1 = [NSPredicate predicateWithFormat:@"isRelatedTo = %@", selectedObjectOfA];
[subpredicates addObject:predicate1];
NSPredicate *predicate2 = [NSPredicate predicateWithFormat:@"syncStatus != %d", ObjectDeleted];
[subpredicates addObject:predicate2];

NSPredicate *predicate = [NSCompoundPredicate andPredicateWithSubpredicates:subpredicates];
[fetchRequest setPredicate:predicate];

NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.managedObjectContext sectionNameKeyPath:nil cacheName:nil];
aFetchedResultsController.delegate = self;
self.fetchedResultsController = aFetchedResultsController;

NSError *error = nil;
if (![self.fetchedResultsController performFetch:&error]) {
    NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    abort();
}

return _fetchedResultsController;
} 
```

一切都适用于添加、删除和编辑对象。该表会相应更新。我的类符合 NSFetchedResultsControllerDelegate 并且委托方法是样板文件。

但我希望用户能够通过点击“向上”/“向下”按钮来循环浏览实体 A 的所有对象，而无需返回导航堆栈（就像可以直接在邮件应用程序中循环浏览电子邮件一样）。B 的相关对象的数量取决于 A 的选定对象（在无和 20 之间）。

问题来了：我的意图是通过更改谓词来刷新 FRC 的结果（不是它的结构或语法，而只是 'selectedObjectOfA' 的值并调用

```
[self.fetchedResultsController performFetch:&error]; 
```

其余的应由 FRC 完成。

第一个问题是：这种方法正确吗？

以下是我已经尝试过的场景：

*   只需将“selectedObjectOfA”设置为一个新值并调用 performFetch 总是显示相同的结果（因为我想 fetchRequest 和谓词没有被更新）

*   像这样“重置” FRC 的 fetchrequest

    ```
    NSMutableArray *subprediactes = [NSMutableArray array];
    NSPredicate *predicate1 = [NSPredicate predicateWithFormat:@"isRelatedTo = %@",    self.selectedObjectOfA];
    [subprediactes addObject:predicate1];
    NSPredicate *predicate2 = [NSPredicate predicateWithFormat:@"syncStatus != %d", ObjectDeleted];
    [subprediactes addObject:predicate2];

    NSPredicate *predicate = [NSCompoundPredicate andPredicateWithSubpredicates:subprediactes];
    [self.fetchedResultsController.fetchRequest setPredicate:predicate]; 
    ```

更新 FRC 并返回正确的数据，但应用程序因行数不正确而崩溃

```
'Invalid update: invalid number of rows in section 0\.  The number of rows contained in an existing section after the update (1) must be equal to the number of rows contained in that section before the update (5), plus or minus the number of rows inserted or deleted from that section (0 inserted, 0 deleted) and plus or minus the number of rows moved into or out of that section (0 moved in, 0 moved out).' 
```

因为没有调用 NSFetchedResultsController 委托方法。因此 tableView 中的行数不会适应新结果（根据错误消息返回的对象数是正确的）。

第二个问题是：为什么委托在添加/删除对象时触发，而不是在谓词（以及结果）改变之后？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-02T11:30:55.257

在谓词更改后为您的表格视图设置动画：

```
NSFetchRequest* fetchRequest = self.fetchedResultsController.fetchRequest;
fetchRequest.predicate = newPredicate;

NSArray* objectsBefore = self.fetchedResultsController.fetchedObjects;

[self.fetchedResultsController performFetch:nil];

NSArray* objectsAfter = self.fetchedResultsController.fetchedObjects;

[self.tableView beginUpdates];

if (objectsBefore.count > 0)
{
    for (id objectBefore in objectsBefore)
    {
        if ([objectsAfter indexOfObject:objectBefore] == NSNotFound)
        {
            NSIndexPath* indexPath = [NSIndexPath indexPathForRow:[objectsBefore indexOfObject:objectBefore] inSection:0] ;

            [self.tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationMiddle];
        }
    }
}

if (objectsAfter.count > 0)
{
    for (id objectAfter in objectsAfter)
    {
        if ([objectsBefore indexOfObject:objectAfter] == NSNotFound)
        {
            NSIndexPath* indexPath = [NSIndexPath indexPathForRow:[objectsAfter indexOfObject:objectAfter] inSection:0];

            [self.tableView insertRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationMiddle];
        }
    }
}

[self.tableView endUpdates]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-09T08:57:26.007

你必须打电话

```
[tableView reloadData]; 
```

修改获取请求后。获取的结果控制器仅跟踪在`performFetch`.

您可以*尝试*以下方法来获取表格视图的动画更新（但我还没有尝试过，所以我不确定它是否有效）：

*   打电话`[tableView beginUpdates]`。
*   用于`[tableView deleteRowsAtIndexPaths:...]`删除所有“旧”行。
*   更新获取的结果控制器获取请求。
*   打电话`[fetchedResultsController performFetch:...]`。
*   要求`[tableView insertRowsAtIndexPaths:...]`所有对象`[fetchedResultsController fetchedObjects]`插入所有“新”行。
*   打电话`[tableView endUpdates]`。

# java - Java 复利计算器

> ID：13299123
> 
> 赞同：0
> 
> 时间：2012-11-08T22:39:52.230
> 
> 标签：java

我目前正在研究 Java 复利计算器。我对 Java 非常陌生，这个项目非常具有挑战性，现在我发现自己陷入了困境。

我担心我在做一些我应该知道的根本错误的事情（我把东西放在错误的地方了吗？）

我的行旁边出现“非法类型开始”错误：

```
for ( int i = 0; i<period; i++) 
```

我想我可能需要把它放在一个方法中？这是我的完整代码。

帐户.java：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Account extends JFrame {

private int period;
private int balance;
private int rate;
private String printstring;

@Override
public String toString() {
    return String.format("Period: " + period + ", Balance: " + balance);
}

public int getPeriod() {
    return period;
}

public void setPeriod(int period) {
    this.period = period;
}

public int getBalance() {
    return balance;
}

public void setBalance(int balance) {
    this.balance = balance;
}

public int getRate() {
    return rate;
}

public void setRate(int rate) {
    this.rate = rate;
}

public String getPrintstring() {
    return printstring;
}

public void setPrintString(String printstring) {
    this.printstring = printstring;
}

for ( int i = 0; i<period; i++)
{
    balance = (balance * rate) + balance;
}
} 
```

银行家.java

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Banker {

private static final int H = 400;       // Height of window pixels
private static final int W = 500;       // Width  of window pixels

public static void main(String[] args) {

    String period;
    String balance;
    String rate;

    period = JOptionPane.showInputDialog(null, "Interest period:");
    balance = JOptionPane.showInputDialog(null, "Current balance:");
    rate = JOptionPane.showInputDialog(null, "Interest rate:");
    JFrame frame = new JFrame("Savings Interest Calculator");
    JButton calculate = new JButton("Calculate");
    JLabel blabel = new JLabel("Period: " + period);
    JLabel plabel = new JLabel("Balance: " + balance);
    JLabel flabel = new JLabel("Balance: " + balance);
    frame.setLayout(new FlowLayout());
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.add(calculate);
    frame.add(plabel);
    frame.add(blabel);
    frame.pack();
    frame.setVisible(true);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:41:40.027

你必须写

```
 for ( int i = 0; i<period; i++)
{
    balance = (balance * rate) + balance;
} 
```

在方法体内。你不能在你的方法之外写出这样的语句。试着把它写在下面的方法体中。

```
public void myMethod() {
     for ( int i = 0; i<period; i++)
    {
        balance = (balance * rate) + balance;
    }

} 
```

# php - UTF-8、数字和正则表达式

> ID：13299124
> 
> 赞同：1
> 
> 时间：2012-11-08T22:39:52.910
> 
> 标签：php, regex, utf-8, kohana, kohana-3

这是我在 Kohana3 验证器规则中发现的：

```
public static function digit($str, $utf8 = FALSE)
{
    if ($utf8 === TRUE)
    {
        return (bool) preg_match('/^\pN++$/uD', $str);
    }
    else
    {
        return (is_int($str) AND $str >= 0) OR ctype_digit($str);
    }
} 
```

有人可以在传递`$utf8`参数时举一个例子吗？`true`并且`false`可以给出不同的结果（准确地说是误报`$utf8 == false`）？

据我记得 - 数字是 ascii 安全字符，任何 utf-8 字符都不会与它们混淆。

**PS**：更详细 - 是否有可能欺骗这个检查并通过一些在 UTF-8 中看起来不像数字的东西，但会通过检查`$utf-8 == false`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:42:22.673

尽管 0-9 是 ASCII 安全的，但 Unicode 中还有很多其他数字。

有关列表，请参阅[“数字、十进制数字”类别](http://www.fileformat.info/info/unicode/category/Nd/list.htm) 中的 Unicode 字符。一些例子是 U+0660 ARABIC-INDIC DIGIT ZERO (٠) 和 U+1D7EC MATHEMATICAL SANS-SERIF BOLD DIGIT ZERO ()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:22:39.463

只是给了你的第二个问题部分更多的酒精，我的结论是你不能在 UTF-8 序列中隐藏一个 ASCII 数字。数字必须是`0x30`..`0x39`或在位范围内`00110000`.. `00110110`.. `00111001`.

UTF-8 编码包括前缀，例如

```
 11110xxx  10xxxxxx  10xxxxxx 
```

因此，数字 ASCII 表示无法在任何地方匹配：

```
 00110000 
 ▲▲        00110000  ▼
           ▲         00110000 
```

所以它不可能在 Latin-1/ASCII 模式下匹配，但`\pN`在模式下也满足`/u`。当然忽略无效的编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T22:53:38.023

1.  [爱琴海数字](http://www.unicode.org/charts/PDF/U10100.pdf),

2.  [古希腊数字](http://www.unicode.org/charts/PDF/U10140.pdf)，

...ETC。

# php - ajax mysql调用，最大长度？

> ID：13299142
> 
> 赞同：0
> 
> 时间：2012-11-08T22:41:05.817
> 
> 标签：php, javascript, mysql, ajax

两天后的第二个问题。相同的脚本。在 while 循环中有两行构建两个表格单元格。第一个没有被评论的正在工作，结果最终出现在它应该是的地方。注释掉的那个不起作用，我不明白为什么。

我已经检查了 mysql 表中列的名称，这是正确的。表格中大约有 10 列有效。但最后9个没有。我唯一能看到的是 mysql 列的名称更长。名字会不会太长？

ajax 调用没有出错。当我使表格边框 = 1 时，我可以确定有一个单元格，但里面什么都没有。当他们都没有被评论时，第二个取消了第一个。但它自己的第一个给出一个结果。

有任何想法吗？

抱歉语法不好或者解决方案很简单。

欢迎任何建议。

**获取数据.inc.php：**

```
//Output results
if(!$facebook)
{
    mysql_close();
    echo json_encode('There was an error running the query: ' . mysql_error());
}
elseif(!mysql_num_rows($facebook))
{
    mysql_close();
    echo json_encode('No results returned');
}
else
{
    $output_string = '';
    $output_string .=  '<table border="0">';
    while($row = mysql_fetch_assoc($facebook))
    {

        $output_string .= '<tr>';
        $output_string .= '<td>'.$row['sombem_profiler_customers_first_name'].'</td>';
        //$output_string .= '<td>'.$row['sombem_profiler_customers_adress_sending_street'].'</td>';
        $output_string .= '</tr>';
    }
    $output_string .= '</table>';
}

mysql_close();
// This echo for jquery 
//$output_string = $_POST['personalNumber'];
echo json_encode($output_string);
?> 
```

**ajax.js：**

```
function ajaxCall(){

var pnumber = document.getElementById('search-personalNumber').value;

$.ajax({
    url: 'db/getdata.inc.php',
    type:'POST',
    dataType: 'json',
    data: { personalNumber: pnumber },
    success: function(output_string){
        $('#result_table').append(output_string);
    },
    error: function (xhr, ajaxOptions, thrownError) {
    alert(xhr.status);
    alert(thrownError);
  }
});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T11:18:33.370

问题出在特殊字符上。我在互联网上找到了这个脚本。

```
function umlaute($text){ 
    $returnvalue=""; 
    for($i=0;$i<strlen($text);$i++){ 
        $teil=hexdec(rawurlencode(substr($text, $i, 1))); 
        if($teil<32||$teil>1114111){ 
            $returnvalue.=substr($text, $i, 1); 
        }else{ 
            $returnvalue.="&#".$teil.";"; 
        } 
    } 
    return $returnvalue; 
} 
```

和

```
$output_string .= '<td>'.umlaute($row['comhem_profiler_customers_adress_sending_street']).'</td>'; 
```

这将字符转换为 html 变体。感谢您让我走上正确的道路。干杯!

# hadoop - 在客户端执行任何命令时，Zookeeper 客户端异常

> ID：13299144
> 
> 赞同：4
> 
> 时间：2012-11-08T22:41:16.527
> 
> 标签：hadoop, amazon-web-services, cassandra, hbase, apache-zookeeper

这是我的配置文件：

```
tickTime=2000
initLimit=20
syncLimit=5
dataDir=./store/data
clientPort=2181

server.1=A:3181:4181
server.2=B:3181:4181
server.3=C:3181:4181
server.4=D:3181:4181
server.5=E:3181:4181 
```

在此之后，我启动了所有服务器。然后我在其中一个节点中启动客户端。它显示已连接，但只要我输入任何命令，它就会抛出异常并停止。

```
WatchedEvent state:SyncConnected type:None path:null
[zk: 127.0.0.1:2181(CONNECTED) 0] ls /
2012-11-08 22:35:01,418 [myid:] - INFO  [main-SendThread(localhost:2181):ClientCnxn$SendThread@1083] - Client session timed out, have not heard from server in 20000ms for sessionid 0x13ae22116e50001, closing socket connection and attempting reconnect

WATCHER::

WatchedEvent state:Disconnected type:None path:null
Exception in thread "main" org.apache.zookeeper.KeeperException$ConnectionLossException: KeeperErrorCode = ConnectionLoss for /
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:99)
    at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
    at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1463)
    at org.apache.zookeeper.ZooKeeper.getChildren(ZooKeeper.java:1491)
    at org.apache.zookeeper.ZooKeeperMain.processZKCmd(ZooKeeperMain.java:725)
    at org.apache.zookeeper.ZooKeeperMain.processCmd(ZooKeeperMain.java:593)
    at org.apache.zookeeper.ZooKeeperMain.executeLine(ZooKeeperMain.java:365)
    at org.apache.zookeeper.ZooKeeperMain.run(ZooKeeperMain.java:323)
    at org.apache.zookeeper.ZooKeeperMain.main(ZooKeeperMain.java:282) 
```

*   所需端口已打开（2181、3181、4181）
*   正在放置 myid 并且具有与 IP 地址对应的正确 id
*   Java 版本：Java 版本“1.7.0_09”Java(TM) SE 运行时环境（内部版本 1.7.0_09-b05）

知道发生了什么吗？

提前致谢。

# css - div之间的额外空间，另一个

> ID：13299145
> 
> 赞同：0
> 
> 时间：2012-11-08T22:41:18.467
> 
> 标签：css, positioning

不知道为什么我的 div 之间有额外的空间

[http://jsfiddle.net/3cx8w/1/](http://jsfiddle.net/3cx8w/1/)

这很简单：

HTML：

```
<div id='menu'>
  <div id='menu-homepage'><a href='/?category=homepage'>Homepage</a></div>
  <div id='menu-prices'><a href='/?category=prices'>Prices</a></div>
  <div id='menu-contacts'><a href='/?category=contacts'>Contacts</a></div>
</div> 
```

CSS：

```
#menu {
    position: absolute;
    top: 16%;
    left: 5%;
    width: 90%;
    background-color: #343434;
    border: 1px solid black;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
}

#menu div {
    display: inline-block;
    height: 100%;
    padding: 1% 2%;
    margin: 0;
    border-left: 1px dotted gray;
    border-right: 1px dotted gray;
    font-size: 60%;
    font-weight: bold;
    text-align: center;
    cursor: pointer;
}

#menu a {
    color: white;
    text-decoration: none;
} 
```

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:43:34.313

给按钮 div 样式

```
float:left; 
```

代替

```
display:inline-block; 
```

并将这个 div 添加到 #menu 的末尾

```
<div style="clear:both"></div> 
```

# asp.net - 在 IIS6.0 中安装 ASP.NET 4.0 后，编辑配置按钮被禁用

> ID：13299147
> 
> 赞同：3
> 
> 时间：2012-11-08T22:41:21.357
> 
> 标签：asp.net, iis, iis-6

拥有多台运行 .NET 4.0 的 IIS6.0 服务器。在其中一些网站上，当右键单击特定网站并点击 ASP.NET 选项卡时，“编辑配置”和“全局配置”按钮被禁用。

尝试使用 -r 和 -iru 开关运行 aspnet_regiis，但似乎没有帮助。

请问有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-06T09:22:21.020

请下载并更新 .NET4.0 SP1，[http://www.microsoft.com/en-us/download/details.aspx?](http://www.microsoft.com/en-us/download/details.aspx?id=39257) id=39257 希望这有用。

# nhibernate - NHibenate。如何在 Projections.Constant 中设置 IType？

> ID：13299149
> 
> 赞同：2
> 
> 时间：2012-11-08T22:41:25.327
> 
> 标签：nhibernate, icriteria, ansistring

我有一个项目使用 NHibernate 2.1.2.4000 和 .Net OracleClient，连接到旧的 Oracle 8i 生产数据库。我已经实现了一个 ICriteria，它正在生成正确的查询，但是引发了以下内部异常：**System.Data.OracleClient.OracleException: ORA-12704: character set mismatch**。

```
return Session.
                CreateCriteria<Carrera>().
                SetProjection(Projections.SqlFunction("concat", NHibernateUtil.AnsiString, Projections.Property("Descripcion"), Projections.Constant(s), Projections.Property("Id"))).
                Add(Expression.InsensitiveLike("Descripcion", filter.Trim(), MatchMode.Anywhere)).
                SetMaxResults(cant).
                List<String>(); 
```

我的问题是：如何在 Projections.Constant(object, IType) 的参数中声明 IType AnsiString？我认为这可能会解决问题。我已经测试过删除 Projections.Constant()，一切正常。

示例生成的查询：

```
 select
    * 
from
    ( SELECT
        (this_.CARR_DESCRIPCION||:p0||this_.CARR_CODIGO) as y0_ 
    FROM
        CARRERAS this_ 
    WHERE
        lower(this_.CARR_DESCRIPCION) like :p1 ) 
where
    rownum <=:p2;
:p0 = ', código: ', :p1 = '%2451%', :p2 = 20 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T20:57:36.330

`Projections.Constant(s, NHibernateUtil.AnsiString)`也许？

# java - 如何使用 Java 准确地重新填充动态表单

> ID：13299152
> 
> 赞同：2
> 
> 时间：2012-11-08T22:41:30.560
> 
> 标签：java, javascript, forms, playframework

我正在开发一个简化工作数据输入的网络应用程序。我已经建立了一个长表单的网页，允许用户添加/删除某些字段。例如，要包含多个电子邮件地址，有一个使用 JQuery 向页面添加另一个输入的按钮（以及一个删除该输入的按钮）。

我的问题实际上只是一个高级别的概念性问题，而不是真正关于实施的问题。

用户填写表单并拥有多个电子邮件地址和其他字段。表单数据被发送到服务器并存储在数据库中。当用户稍后回来时，他们想要拉出一个包含他们输入的所有数据的页面。这对我来说很棘手：当数据最初由用户输入时，额外的字段是用 javascript 添加的，但是当用户稍后返回页面时，页面是用 Java 构建的（我正在使用 play框架，顺便说一下）基于模板和数据库中的数据。但是，例如，如果服务器用于创建页面的模板与 JQuery append() 函数中包含的名称/样式/等不同的名称/类/等用于附加输入，会发生什么情况。任何时候页面被 Javascript 修改，是否都存在更改的可能性？

如果 javascript 和 java 的 HTML 版本不同，那么原始输入页面和用户返回时看到的页面可能会有所不同。除了非常小心之外，是否有任何常见的方法来解决这个问题？也许有一些方法可以存储整个页面、HTML 和所有内容，然后将其返回？我已经搜索并搜索了某种编程范式来解释如何解决这个问题，但到目前为止我失败了。

感谢您抽出宝贵时间，希望我不是唯一想知道这一点的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:09:43.653

我会设计页面，以便始终使用 Ajax 异步生成网页。这样一来，您就可以用一段代码执行一项工作，而不是使用两个完全独立的代码来完成相同的工作。

当然，您可以让 Java 生成将加载 javascript 并发送 Ajax 数据的页面模板。

# c# - 无法获取托管类型的地址、大小或声明指向托管类型的指针

> ID：13299153
> 
> 赞同：12
> 
> 时间：2012-11-08T22:41:37.640
> 
> 标签：c#, pointers, unsafe

我已经进行了相当多的研究，但现在我仍然不知道为什么我仍然会收到此错误。我有一个具有以下属性的结构：

```
struct Account
{
    //private attributes
    private double mBalance;
    private int mAccountNumber;
    private string mName;
    private string mDateCreated;
} 
```

并尝试执行以下操作：

```
class BankManager
{
    //private attributes
    private unsafe Account *mAccounts;
    private unsafe bool *mAccountsAvailable;
    private int mNumberAccounts;
} 
```

即使将我的类 Account 转换为结构，对 BankManager 类中的属性使用“不安全”，并告诉编译器它可以使用不安全代码（在属性 -> 构建中），我仍然在

```
*mAccounts 
```

关于为什么的任何想法？我很确定我在结构中使用的所有类型在 c# 中都有指向的指针是合法的。提前致谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-09T00:44:11.607

Account 类中的字符串会导致此问题。要了解原因，您需要了解垃圾收集器的工作原理。它通过跟踪对对象的引用来发现垃圾。mName 和 mDateCreated 就是这样的引用。mBalance 和 mAccountNumber*不是*，这些字段是值类型。而且，最重要的是，BankManager.mAccounts 字段不是，它是一个指针。

所以编译器可以预先告诉垃圾收集器将**永远**无法看到字符串引用。因为这样做的唯一方法是通过 mAccount 字段而不是参考。

解决此问题的唯一方法是将自己严格限制为值类型。对字符串执行此操作的唯一方法是使用 Marshal.StringToCoTaskMemUni() 将它们分配到*非托管*内存中，并将 IntPtr 存储在该字段中。现在垃圾收集器无法触及它，并且无法被它移动。您现在还需要释放该字符串。

显然这不切实际并且容易导致泄漏，这种问题在 C 程序中很常见。不知道你为什么要追求这个，但请记住，对对象的引用已经是一个简单的指针，所以你自己使用指针不会获得任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T22:57:01.863

字符串是 .NET 中的引用类型，对于结构指针来说是不可 blittable 的。请参阅[Blittable 和 Non-Blittable 类型](http://msdn.microsoft.com/en-us/library/75dwhxf7.aspx)以获取您想要执行的值类型的列表。

除非您有特殊的业务需求，否则您应该坚持使用托管内存以实现可维护性和一般的理智。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T22:52:48.853

使用`private unsafe fixed char mName[126];`
字符串是托管类型，非固定数组也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T22:50:51.577

您对包含可以具有指针的类型的结构是错误的，因为 a`string`是不能具有指针引用的托管类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-21T18:03:37.207

托管数据不会停留在固定位置，因为复制收集器可以四处移动。这同样适用于托管盒装值类型。托管的未装箱值类型只能存在于堆栈或其他对象内部。如果它们在堆栈中，它们只有固定位置。

为了创建一个具有固定位置的堆分配结构，您可以从中获取一个将继续有效的指针，您必须在*非托管*内存中分配它。*但是*，一旦将它分配到非托管内存中，就不能再将托管指针放入其中（也就是不能使用字符串），因为垃圾收集器不会知道这些指针，因此它不会在何时更新它们它在压缩期间移动托管对象。

例如，这是一个有效的（尽管不一定是好的）事情：

```
[StructLayout(LayoutKind.Sequential, Pack=1)]
public unsafe struct Account {
    public int a;
    public char* mName;
}
public class BankManager {
    private unsafe Account* mAccounts;
    public unsafe int GetA() {
        return mAccounts->a;
    }
    public unsafe BankManager() {
        mAccounts = (Account*)Marshal.AllocHGlobal(sizeof(Account));
    }
    unsafe ~BankManager() {
        if (mAccounts != null) {
             Marshal.FreeHGlobal((IntPtr)mAccounts);
             mAccounts = null;
        }
    }
} 
```

在这里，我们在非托管内存中分配了结构。这允许我们持有一个指向它的指针，我们知道它不会改变或移动。完成后，我们必须手动释放结构。需要对 mAccounts->mName 执行相同的手动分配/释放和编组，因为它是非托管 char*（c 样式字符串）的方式。

我使结构具有打包的顺序布局，以使此代码的行为更接近于它的 C 对应物，因为像上面这样的代码通常只会在与需要特定结构布局的本机 C DllImport 入口点进行互操作时使用。

# java - 如何使用 JavaMail 发送 html 电子邮件？

> ID：13299155
> 
> 赞同：3
> 
> 时间：2012-11-08T22:41:54.507
> 
> 标签：java, html, email, smtp, mime

我已经在[此链接上尝试过字符集建议](https://stackoverflow.com/questions/5068827/how-do-i-send-html-email-via-java)

但是电子邮件显示了 messageText 的确切值......没有呈现任何 HTML。

这是我当前的代码

```
import java.util.Properties;
import javax.mail.Address;
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

String messageText = "<br/>THIS IS A TEST...<br/>!!!";

Properties props = new Properties();
props.setProperty("mail.transport.protocol", "smtp");
props.setProperty("mail.smtp.auth", "true"); 
props.setProperty("mail.smtp.ssl.enable", "true");

Session mailSession = Session.getInstance(props, null);
mailSession.setDebug(true);
Transport transport = mailSession.getTransport();

MimeMessage message = new MimeMessage(mailSession);
message.setSubject(messageSubject);
message.setContent(messageText, "text/html; charset=utf-8");

Address[] fromAddress = InternetAddress.parse ( "pleasedonotreplymessage@[removed]" ) ; 
message.addFrom( fromAddress );

message.addRecipient(Message.RecipientType.TO, new InternetAddress(toAddress));

transport.connect("[removed]", "", "");
transport.sendMessage(message, message.getRecipients(Message.RecipientType.TO));
transport.close(); 
```

我宁愿**不必**安装其他方工具.. 这将需要对我当前的代码进行彻底的返工。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-08T19:25:01.333

这是经过测试并确认可以工作的。

HTML 电子邮件有更优雅的结构可供更广泛的电子邮件客户端支持，但对于快速解决方案，这适用于我测试过的阅读器（Outlook、连接到 Exchange 的 Android 邮件客户端和 Gmail）。

```
public static void sendHtmlEmail(String server, String from, String to, String cc, String subject, String htmlBody) throws MessagingException {
    Properties props = new Properties();
    props.setProperty("mail.smtp.host", server);
    Session session = Session.getInstance(props);

    MimeMessage msg = new MimeMessage(session);
    msg.setFrom(from);
    msg.setRecipients(RecipientType.TO, to);
    msg.setRecipients(RecipientType.CC, cc);
    msg.setSubject(subject);
    msg.setSentDate(new Date());

    MimeMultipart mp = new MimeMultipart();
    MimeBodyPart part = new MimeBodyPart();
    part.setText(htmlBody);
    mp.addBodyPart(part);
    msg.setContent(mp);

    // Content type has to be set after the message is put together
    // Then saveChanges() must be called for it to take effect
    part.setHeader("Content-Type", "text/html");
    msg.saveChanges();

    Transport.send(msg);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T22:51:21.467

您可以使用 Thymeleaf 呈现丰富的 HTML 电子邮件并使用 Spring Mail 实用程序发送它。

教程：[http ://www.thymeleaf.org/doc/articles/springmail.html](http://www.thymeleaf.org/doc/articles/springmail.html)

教程源码：[https ://github.com/thymeleaf/thymeleafexamples-springmail](https://github.com/thymeleaf/thymeleafexamples-springmail)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:51:03.730

使用[Javamail API](http://www.oracle.com/technetwork/java/javamail/index.html)

[这是一个例子](http://www.jvmhost.com/articles/how-to-send-mail-with-javamail-and-tomcat)

# java - Java 反射 - 获取对象内嵌套对象、列表和数组的值

> ID：13299160
> 
> 赞同：3
> 
> 时间：2012-11-08T22:42:11.950
> 
> 标签：java, reflection

我是反射的新手，并试图创建一个通用函数，该函数将接收对象并解析所有类型`String`为`String[]`或的字段`List<String>`。嵌套对象中存在的任何`String`, `String[]`or`List<String>`也必须被解析。是否有任何实用程序可以帮助我做到这一点？从父对象 ( `User`) 获取值很简单 - 使用`BeanUtils.describe(user);`- 它给出了父对象中的值，`String`但不是嵌套对象。我确定我可能不是第一个需要此功能的人？是否有任何实用程序或代码可以帮助我做到这一点？`String[]``List<String>`

```
public class User {
    private String somevalue;
    private String[] thisArray;
    private List<String> thisList;
    private UserDefinedObject myObject;
    .
    .
    .

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:47:16.113

该方法将为您提供一个代表类的每个字段的 s[`Class.getDeclaredFields`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getDeclaredFields%28%29)数组。`Field`您可以遍历这些并检查返回的类型[`Field.getType`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Field.html#getType%28%29)。过滤类型`List`为 to的字段`List<String>`比较棘手 - 请参阅[这篇文章](https://stackoverflow.com/questions/1942644/get-generic-type-of-java-util-list)以获得帮助。

在对所需字段进行第一次动态查找后，您应该跟踪（记忆）相关`Field`对象以获得更好的性能。

这是一个简单的例子：

```
//for each field declared in User,
for (Field field : User.class.getDeclaredFields()) {
    //get the static type of the field
    Class<?> fieldType = field.getType();
    //if it's String,
    if (fieldType == String.class) {
        // save/use field
    }
    //if it's String[],
    else if (fieldType == String[].class) {
        // save/use field
    }
    //if it's List or a subtype of List,
    else if (List.class.isAssignableFrom(fieldType)) {
        //get the type as generic
        ParameterizedType fieldGenericType =
                (ParameterizedType)field.getGenericType();
        //get it's first type parameter
        Class<?> fieldTypeParameterType =
                (Class<?>)fieldGenericType.getActualTypeArguments()[0];
        //if the type parameter is String,
        if (fieldTypeParameterType == String.class) {
            // save/use field
        }
    }
} 
```

请注意，我使用了引用相等 ( `==`) 而不是`isAssignableFrom`匹配`String.class`，`String[].class`因为`String`is `final`。

**编辑：**刚刚注意到你关于查找嵌套`UserDefinedObject`s 的一点。您可以对上述策略应用递归以搜索这些策略。

# sql - matlab中的SQL错误

> ID：13299168
> 
> 赞同：0
> 
> 时间：2012-11-08T22:42:50.350
> 
> 标签：sql, image, matlab, ms-access

我是 sql 新手，

有人可以帮助我这是什么错误。

我在matlab中执行这个。

```
 exec(conn,'CREATE TABLE idb (Id int,Photo varbinary(max))') 
```

答案=

```
 Attributes: []
          Data: 0
DatabaseObject: [1x1 database]
      RowLimit: 0
      SQLQuery: 'CREATE TABLE idb (Id int,Photo varbinary(max))'
       Message: '[Microsoft][ODBC dBase Driver] Syntax error in field definition.'
          Type: 'Database Cursor Object'
     ResultSet: 0
        Cursor: 0
     Statement: 0
         Fetch: 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:22:40.873

它与以下代码一起使用

```
 exec(conn,'CREATE TABLE idb(Id int,Photo image)') 
```

# android - 开始使用 cocos2d for android

> ID：13299169
> 
> 赞同：2
> 
> 时间：2012-11-08T22:42:52.193
> 
> 标签：android, game-engine, cocos2d-android

你知道一些可以帮助我开始使用 cocos2d for android 的教程吗？我环顾四周，但找不到任何我希望它成为 android 版本的原因是因为我在 java 中的编程比 C++ 更好。感谢所有帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T08:04:19.057

如果我是你，我会使用`Cocos2d-x`，因为 cocos2d 不再支持。`Cocos2d-x`是基于`C++`并使用 JNI 来运行的`Android`。您不必知道它是如何工作的，只需编译它并用 C++ 编写您的游戏。要开始使用它，请查看：[最完整的 Cocos2d-x 教程和指南列表](https://stackoverflow.com/q/10711047/1077364)和项目的官方网站：http: [//www.cocos2d-x.org/](http://www.cocos2d-x.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T15:58:46.893

最好看 cocos2d 项目的[org.cocos2d.tests 包](https://github.com/ZhouWeikuan/cocos2d/tree/master/cocos2d-android/src/org/cocos2d/tests)。它将包含 cocos2d 的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-25T09:15:15.147

对于很多没有“丰富”C/C++ 编程经验、没有足够时间或学习意愿的开发人员（比如我）来说，用 Java 编写的 Cocos2D for Android 移植版是一个非常好的选择。是的，它可能不像 Cocos2d-x 项目那样更新（花里胡哨），但它绝对有足够的镜像功能让您入门。这是我所知道的最新存储库的 github 链接 [https://github.com/ZhouWeikuan/cocos2d](https://github.com/ZhouWeikuan/cocos2d)

这里有一套简短的教程可以帮助您入门..

如何在 Cocos2d for Android 中构建您的第一个滑块益智游戏的分步指南 - 第 1 部分 [http://denvycom.com/blog/step-by-step-guide-on-how-to-build-your-first-滑块拼图游戏在 cocos2d-for-android-part-1/](http://denvycom.com/blog/step-by-step-guide-on-how-to-build-your-first-slider-puzzle-game-in-cocos2d-for-android-part-1/)

如何使用 Cocos2D 制作简单的 Android 游戏 [http://dan.clarke.name/2011/04/how-to-make-a-simple-android-game-with-cocos2d/](http://dan.clarke.name/2011/04/how-to-make-a-simple-android-game-with-cocos2d/)

对于所有来到这个线程的人，我希望这很有用！

# database - 数据库连接错误（3）：无法连接到数据库'，

> ID：13299175
> 
> 赞同：0
> 
> 时间：2012-11-08T22:43:06.207
> 
> 标签：database, joomla, xampp

我通过卸载 1.7 将我的 xampp 从 1.7 升级到 1.8，但没有卸载 htdocs 和 mysql 数据文件夹。但我现在的问题是我的站点没有显示，我的 joomla 2.5 站点给出：数据库连接错误（3）：无法连接到数据库，而 joomla 1.5 站点给出如下错误：

> 严格标准：非静态方法 JLoader::import() 不应在第 29 行的 C:\xampp\htdocs\osu\libraries\joomla\import.php 中静态调用
> 
> 严格标准：非静态方法 JLoader::register() 不应在第 71 行的 C:\xampp\htdocs\osu\libraries\loader.php 中静态调用
> 
> 严格标准：非静态方法 JLoader::import() 不应在第 32 行的 C:\xampp\htdocs\osu\libraries\joomla\import.php 中静态调用
> 
> 严格标准：非静态方法 JLoader::register() 不应在第 71 行的 C:\xampp\htdocs\osu\libraries\loader.php 中静态调用
> 
> 严格标准：非静态方法 JLoader::load() 不应在第 161 行的 C:\xampp\htdocs\osu\libraries\loader.php 中静态调用
> 
> 严格标准：非静态方法 JLoader::register() 不应在第 138 行的 C:\xampp\htdocs\osu\libraries\loader.php 中静态调用
> 
> 严格标准：非静态方法 JRequest::clean() 不应在第 33 行的 C:\xampp\htdocs\osu\libraries\joomla\import.php 中静态调用
> 
> 严格的标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 中的第 463 行静态调用
> 
> 严格标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 中的第 464 行静态调用
> 
> 严格标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 中的第 465 行静态调用
> 
> 严格标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 中的第 466 行静态调用
> 
> 严格标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 中的第 467 行静态调用
> 
> 严格标准：非静态方法 JRequest::_cleanArray() 不应在 C:\xampp\htdocs\osu\libraries\joomla\environment\request.php 的第 468 行静态调用
> 
> 警告：无法修改标头信息 - 标头已由 C:\xampp\htdocs\osu\libraries\joomla\factory 中的（输出开始于 C:\xampp\htdocs\osu\libraries\joomla\import.php:46）发送。 php on line 566 Database Error: Unable to connect to the database: 无法连接到数据库

请问我的错误是什么。有没有一种特殊的方法来备份数据库。我现在在 Windows 7 上运行 xampp 1.8.1。从 xampp 1.7.0 升级

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T00:13:59.003

可以通过在包含在您的 Joomla 根目录中的 configuration.php 中输入正确的值来修复此错误。

文件如下所示。

![配置](../Images/bd454a854f754b071ba0e394a166f669.png)

**数据库连接错误（3）：无法连接数据库**

***问题：***此错误消息通常表示您连接到错误的数据库服务器。对于大多数 Joomla 安装，joomla 文件本身和它连接的数据库位于同一台服务器上。在这种情况下，应使用“localhost”作为数据库服务器。我们通过将数据库主机设置为“localhosttt”（localhost 拼写错误）重新创建了此错误消息。

***解决方案：***如果您的 Joomla 站点的设置与大多数类似，请检查您的 configuration.php 文件并确保您的数据库主机设置为“localhost”。此设置在您的配置文件中如下所示：

公共 $host = '本地主机';

**数据库连接错误（2）：无法连接到 MySQL。**

***问题：***此错误消息通常意味着您的 Joomla 的 configuration.php 文件具有错误的数据库名称或数据库用户名。在我们的测试环境中，我们更改了数据库用户名和密码，并且在每个单独的情况下都会出现相同的错误消息。

***解决方案：***您应该检查您的 configuration.php 文件并确保您使用的是正确的 MySQL 用户名和密码。这些设置将在文件中显示为：

公共 $user = 'userna5_dbuser'; 公共 $password = 'dbpass';

如果您确定设置正确，建议重置您的数据库用户密码并使用新密码更新您的 configuration.php 文件。这将有助于确保您设置了正确的数据库密码。

***仅当您仍然获得严格标准：非静态方法 JLoader::import() 时，才能修复严格标准：非静态方法 JLoader::import()***，

更改 php.ini 文件中的以下行：

```
Line 516: error_reporting = E_ALL | E_STRICT 
```

至

```
Line 516: error_reporting = E_ALL & ~E_NOTICE & ~E_DEPRECATED 
```

保存并重新启动 Apache，您应该可以很好地安装和使用 Joomla！在 XAMPP 上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T03:16:49.713

如果数据库用户没有授予数据库的权限，也会出现错误数据库连接错误（3）：无法连接到数据库。如果您使用的是 cPanel：

1.  选择 MySQL 数据库。
2.  向下滚动到页面底部的将用户添加到数据库。
3.  选择您要检查权限的用户。
4.  选择您要检查用户权限的数据库。
5.  确保至少检查了以下权限：

    *   插入
    *   选择
    *   更新
    *   删除

        要安装组件，还需要以下权限：

    *   创造
    *   改变
    *   降低
6.  单击进行更改按钮

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T02:59:09.407

Joomla给我**Database connection error (3): Could not connect to database** error 当我不小心忘记关闭PHP安全模式时。希望可以节省一些麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T22:48:48.073

如何修复严格标准错误：http: [//vuthakh.blogspot.gr/2012/07/how-to-fix-joomla-error-strict.html](http://vuthakh.blogspot.gr/2012/07/how-to-fix-joomla-error-strict.html)

对于“无法连接到数据库错误”，请检查您的配置文件以查看数据库名称、密码等是否正确

# html - 如何在 HTML 5 上显示 .flv 视频

> ID：13299176
> 
> 赞同：0
> 
> 时间：2012-11-08T22:43:16.627
> 
> 标签：html

是否可以在 HTML 5 上显示 .flv 视频（在 WAMP 本地主机中）？我已经阅读并使用了这篇文章中的代码，但它对我不起作用！ [http://gettingsoftware.posterous.com/html5flash-using-html5-video-and-audio-right](http://gettingsoftware.posterous.com/html5flash-using-html5-video-and-audio-right)

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:48:23.437

据我所知，唯一支持的格式是：Ogg Theora、H.264、WebM VP8。

您还需要检查浏览器对它们的支持。

[读一读。](http://en.wikipedia.org/wiki/HTML5_video#Browser_support)

# tridion-2011 - 为什么 OData PageContent.Content 字段为空？它在 Broker DB 中有数据

> ID：13299177
> 
> 赞同：0
> 
> 时间：2012-11-08T22:43:21.443
> 
> 标签：tridion-2011, tridion-content-delivery

我正在使用如下所示的 linq 语句来返回页面。页面返回，内容字段填充到数据库中，但 OData 响应中的内容为空。有任何想法吗？

```
 var pages = (from p in cds.PageContents
                 where p.PublicationId == 20 && p.PageId == 1397
                 select p).ToList<SDLODataClient.SDLOData.PageContent>();

    foreach (SDLODataClient.SDLOData.PageContent p in pages)
    {
        txtOutput.InnerHtml += p.Content;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:40:48.470

这原来是我的 cd_storage_conf.xml 配置文件的问题。一切都应该指向代理数据库，但一项映射定义如下：

```
<Item typeMapping="Page" cached="false" storageId="defaultFile"/ 
```

所以 OData 服务没有找对地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T01:11:53.510

如果您在 Broker 数据库中确实拥有所有需要的数据，那么您的代码就可以完美运行。代码无法正常工作的唯一情况是：您的 web 服务没有正确的配置，或者您在 Broker 数据库中没有 PageMeta（检查 PAGE 表中 PUBLICATION_ID=20 和 ITEM_REFERENCE_ID 的行） =1397）或者当您在 Broker 数据库中没有 PageContent 时（检查 PAGE_CONTENT 表中的 PUBLICATION_ID=20 和 PAGE_ID=1397 的行）。

您可以做的最简单的测试是通过在浏览器中进入“.../odata.svc/PageContents(PageId=1397,PublicationId=20)”来尝试自己访问该条目。如果此 URL 不起作用，那么您需要将 OData Webservice 日志记录设置为 DEBUG（检查 logback.xml）并搜索与页面/查询相关的错误消息。

希望这可以帮助。

# c# - 字符串的长度比字符串的字符长

> ID：13299187
> 
> 赞同：0
> 
> 时间：2012-11-08T22:43:47.650
> 
> 标签：c#, string, if-statement

为什么会这样？

我从另一个类中获取一个字符串以将其与当前字符串进行比较，但是 if 语句不起作用，因为该字符串有问题。当我尝试检查长度时，它们有所不同。这怎么可能？

receivedCom = "去";

```
 public string checkaction(string receivedCom)
        {

            print ("-------" + receivedCom + "-------" + receivedCom.Length); //Just to show there isnt any white spaces behind or infront --> OUTPUT IS "-------go-------3"
            print (receivedCom + receivedCom.Replace(" ", "").Length); //Tried removing white spaces if there were any --> OUTPUT "go3"
            string x = receivedCom.Remove(receivedCom.Length-1); 
            print (x + " " +x.Length); --> OUTPUT IS "go 2" (Correct lenght, but if still doesnt want to work with it)

            if("go".Equals(x)){
            return "yes";
            }
            else{return "";}
        } 
```

要么发生了一些奇怪的事情，要么我正在失去它。

这是在 CS 脚本中完成的。（由 Unity 使用。）

更新：

运行 Jon Skeet 提供的代码，这是我的结果

```
Lenght: 3
receivedCom[0] = 103
receivedCom[1] = 111
receivedCom[2] = 13 
```

更新：我是如何获得“回车”的

```
void Start () {

        player = GameObject.FindWithTag("Player");
        script = (PlayerScript) player.GetComponent(typeof(PlayerScript));

        Process p = new Process();
        p.StartInfo.FileName = @"F:\ReceiveRandomInput.exe"; //This exe generates random strings like "go" "start" etc as a console application

        p.StartInfo.Arguments = "arg0 arg1 arg2 arg3 arg4 arg5";
        p.StartInfo.RedirectStandardOutput = true;
        p.StartInfo.UseShellExecute = false;
        p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        //add event handler when output is received
        p.OutputDataReceived += (object sender, DataReceivedEventArgs e) => {

        data = e.Data;  //THIS DATA is what i sent though to the other class (one with the carriage return in
        received = true;
        };

        p.Start();
        p.BeginOutputReadLine();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:45:59.580

> 这怎么可能？

您已经证明没有任何空格。这并不意味着没有不可打印的字符。

最简单的诊断方法是打印出“奇数”的 Unicode 值：

```
print((int) receivedCom[receivedCom.Length - 1]); 
```

我猜它会是 0，这只是你如何读取数据的一个错误。

编辑：当然要*准确*显示字符串中的内容，只需打印所有内容：

```
print ("Length: " + receivedCom.Length);
for (int i = 0; i < receivedCom.Length; i++)
{
    print("receivedCom[" + i + "] = " + (int) receivedCom[i];
} 
```

如果您可以将结果编辑到问题中，我们可以取得进展。

# asp.net - Visual Studio 2012 Express：如何使用自定义 Web 服务器进行调试

> ID：13299192
> 
> 赞同：1
> 
> 时间：2012-11-08T22:44:10.870
> 
> 标签：asp.net, debugging, visual-studio-2012, visual-studio-debugging, visual-studio-express

我的机器上安装了 IIS 7。使用 Visual Studio 2010 Professional，我可以附加到 IIS 进程并正确调试。

我注意到 Visual Studio 2012 Express 似乎没有该选项。但是，它确实可以选择在调试期间使用自定义 Web 服务器。它只要求我假设的基本 URL 是`http://localhost/`. 但是，当我尝试使用该设置进行调试时出现以下错误：

```
"The web server is not configured correctly." 
```

感谢您的帮助！

![在此处输入图像描述](../Images/e675c27eeb876d6d45f227956fc8313b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:53:22.980

这不是自定义 Web 服务器。这是一个自定义网址。这允许您在执行调试器时指定要使用的 URL。这并不意味着调试器将使用该进程。

据我所知，VS Express 不允许附加到其他进程。您必须购买标准版，或者您可以尝试使用 SharpDevelop 等免费开发环境之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-30T10:11:01.940

以下是在使用 Visual Studio Express for Web 作为开发 IDE 时如何在 IIS 进程上使用附加到进程：

*   在 Visual Studio Express 2012 for Web 中打开您的网站项目，
    并在浏览器中浏览您的开发网站 - 您可以通过 VS 中的 Ctrl+F5 来完成（无需调试即可启动） - 这将运行 w3wp.exe（ISS 应用程序池进程 -此过程将在您的项目 Web 位置为 HTTP 时运行）
*   打开 Visual Studio express 2012 for **windows 桌面**。是的。对于“windows 桌面”- 诀窍就来了（-：
*   在桌面版 VS 中 - 按 Ctrl+O（打开文件） - 并浏览到要调试的网站中的文件 - 例如 [root]/Default.aspx.cs。
    现在在 Default.aspx.cs 代码中，设置断点 - 例如在 Page_Load 事件代码中
*   在桌面版 VS 中 - 转到调试菜单并选择附加到进程...
    在附加到进程对话框中 - 在可用进程列表中选择您的 IIS 进程： w3wp.exe
    现在按附加按钮
*   转到您的浏览器并运行 /Default.aspx 页面

结果：网站运行在IIS进程中，会停在桌面VS的断点处，可以调试了。

笔记：

*   这仅在您的网站项目 Web Location 是 HTTP 时才有效（在 VS.Google 中创建网站项目时配置此选项以[获取说明](http://www.google.com/search?q=Creating%20a%20Local%20IIS%20Web%20Site%20in%20Visual%20Studio)）
*   我是在 2012 版本上完成的，它可能也适用于其他版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T05:41:02.843

看看这篇文章是否可以帮助你。使用 IIS Express 使 Web 开发更轻松：http: [//www.codeproject.com/Articles/396569/Make-Web-Development-Easier-with-IIS-Express](http://www.codeproject.com/Articles/396569/Make-Web-Development-Easier-with-IIS-Express)

我的 PC 上没有 express，但据我所知，VS Express 支持使用本地 IIS Web 服务器或自定义 Web 服务器，这意味着您应该能够使用其中任何一个进行调试。如果您使用本地 IIS Web 服务器，则需要输入正确的 URL（通常是“http://localhost/applicationname”），如果您使用自定义 Web 服务器，您只需添加一个端口而不是 /applicationame，例如“http ://localhost:54124"

# python - 烧瓶 MongoDB 错误：“在应用程序上下文之外工作”

> ID：13299195
> 
> 赞同：4
> 
> 时间：2012-11-08T22:44:24.040
> 
> 标签：python, unit-testing, mongodb, flask, pymongo

我一直在尝试测试使用 PyMongo 的 Flask 应用程序。该应用程序运行良好，但是当我执行单元测试时，我不断收到一条错误消息，提示“在应用程序上下文之外工作”。每次我运行任何需要访问 Mongo 数据库的单元测试时都会抛出此消息。

我一直在遵循本指南进行单元测试： http: [//flask.pocoo.org/docs/testing/](http://flask.pocoo.org/docs/testing/)

我的应用程序设计很简单，类似于标准的 Flask 教程。

有没有人已经有同样的问题？

```
class BonjourlaVilleTestCase(unittest.TestCase):
    container = {}
    def register(self, nickname, password, email, agerange):
        """Helper function to register a user"""
        return self.app.post('/doregister', data={
            'nickname' :    nickname,
            'agerange' :    agerange,
            'password':     password,
            'email':        email
        }, follow_redirects=True)

    def setUp(self):        
        app.config.from_envvar('app_settings_unittests', silent=True)

        for x in app.config.iterkeys():
            print "Conf Key=%s, Value=%s" % (x, app.config[x])

        self.app = app.test_client()

        self.container["mongo"] = PyMongo(app)
        self.container["mailer"] = Mailer(app)
        self.container["mongo"].safe = True

        app.container = self.container

    def tearDown(self):
        self.container["mongo"].db.drop()
        pass    

    def test_register(self):
        nickname = "test_nick"
        password = "test_password"
        email    = "test@email.com"
        agerange = "1"
        rv = self.register(nickname, password, email, agerange)

        assert "feed" in rv.data

if __name__ == '__main__':    
    unittest.main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T09:14:03.373

我终于解决了这个问题，这是由于应用程序上下文造成的。似乎在使用 PyMongo 时，因为它为您管理连接，所以连接对象必须在初始化 PyMongo 实例的同一上下文中使用。

我不得不修改代码，因此 PyMongo 实例在可测试对象中初始化。稍后，此实例通过公共方法返回。

因此，为了解决这个问题，我在单元测试中的所有数据库请求都必须在 *with*语句下执行。示例如下

```
with testable.app.app_context():
    # within this block, current_app points to app.
    testable.dbinstance.find_one({"user": user}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:02:13.847

查看 Context Locals 和 test_request_context()： http: [//flask.pocoo.org/docs/quickstart/#context-locals](http://flask.pocoo.org/docs/quickstart/#context-locals)

# php - Ajax 不断返回调用页面

> ID：13299196
> 
> 赞同：0
> 
> 时间：2012-11-08T22:44:26.473
> 
> 标签：php, ajax, cakephp

我有这个 ajax 请求，每当我更改输入字段时都会调用它：

```
$(document).ready(function(){
    $('#PostTitle').change(function(){
        var inputstring=$("#PostTitle").val();
        submitData(inputstring);
    });
});

function submitData(inputstring){
$.ajax({
        type: 'POST',
        url: '/myWebsite/posts/set_post_images',
        data: inputstring,
        dataType: "text",
        success:function(data){
            $("#selectImage").replaceWith($('#selectImage', $(data)));
        },
        error:function(){
            $('#selectImage').html("You failed misserably.");
        },
        timeout: 5000
    });
} 
```

上面的代码在 add.ctp 文件（Posts 控制器的视图）中。调用的函数 set_post_images 位于 Posts Controller 本身中，如下所示：

```
public function set_post_images($url = null) {
    if($url!=null){
        $this->set('imageArray', $this->getImages($url));
    } else {
        $this->set('imageArray', array("/img/someImage.png"));
    }
    if ($this->RequestHandler->isAjax()) {
         $this->autoRender = false;
         $this->layout = 'ajax';
         $this->render('/elements/selectImageElement');
    }
    return;
} 
```

我想要做的是从 selectImage div 中获取现有元素，替换为新元素。问题是，ajax 不断返回 add.ctp 文件（调用请求的文件）的全部内容。

这可能是什么原因，我该如何解决？

**编辑**：**已解决**

$this->Auth->allow(array('set_post_images')); 没有设置，所以响应返回整个页面。修复后，可以对动作说话。

此外，在控制器中，变量不是通过 $url 而是通过 $this->data['url'] 访问的。

快乐编码！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:28:47.350

$this->Auth->allow(array('set_post_images')); 没有设置，所以响应返回整个页面。修复后，可以对动作说话。

此外，在控制器中，变量不是通过 $url 而是通过 $this->data['url'] 访问的。

快乐编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T07:26:03.897

请尝试以下代码，

```
public function set_post_images($url = null) {
    if($url!=null){
        $this->set('imageArray', $this->getImages($url));
    } else {
        $this->set('imageArray', array("/img/someImage.png"));
    }
    if ($this->RequestHandler->isAjax()) {
         $this->autoRender = false;
         $this->layout = 'ajax';
         $this->render('/elements/selectImageElement');
    }
    exit;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T00:31:29.913

请将 set_post_images 的返回值插入 id 为“returned-images”的 div，然后将您的 ajax 代码更改为此

```
function submitData(inputstring){
$.ajax({
    type: 'POST',
    url: '/myWebsite/posts/set_post_images',
    data: inputstring,
    dataType: "text",
    success:function(data){
        var images = data.find('#returned-images');
        var getResults=images.html();
        $("#selectImage").html(getResults);
    },
    error:function(){
        $('#selectImage').html("You failed misserably.");
    },
    timeout: 5000
}); 
```

}

干杯

# asp.net - 当我的表格中的特定条件不满足时如何自动发送电子邮件

> ID：13299198
> 
> 赞同：0
> 
> 时间：2012-11-08T22:44:33.503
> 
> 标签：asp.net, sql-server-2008

我只需要一些关于如何实现这一目标的指导、信息或链接。我不确定我是否可以从 ASP 或某种存储过程中做到这一点。例如，这只是示例，我的表中有 2 个字段：TargetDate 状态

期望用户必须通过目标日期字段中设置的 TargetDate 更新状态字段，无论它是 Complete 还是 Incomplete。如果目标日期已过且状态字段未更新，那么我想向该人发送电子邮件。我只需要关于从哪里开始以及使用什么方法的帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:53:59.423

我不确定 SQL Server 可以做什么（如果它可以做到，我不会感到惊讶）。

根据在发送电子邮件之前从 TargetDate 开始的时间，您可以在 Global.asax Application_Start 方法中编写一个方法来检查该方法并发送电子邮件。这取决于您的应用程序池的重置频率以及用户访问该站点的频率。

这确实具有将逻辑保留在应用程序中的优势，就像将业务逻辑移动到数据库一样（取决于程序的设计方式）。

这是我在类似情况下所做的一个示例：

全球.asax

```
protected void Application_Start(object sender, EventArgs e)
{
  using (var db = new DataContext())
  {

    //Get the last time e-mails where sent out.
    var temp = from s in db.SystemDatas
               select s;

    if (temp.Count() > 0)
    {
      var ts = (TimeSpan)(DateTime.Today - temp.First().LastUpdate);

      if ((DateTime.Today.DayOfWeek == DayOfWeek.Monday || DateTime.Today.DayOfWeek == DayOfWeek.Tuesday) && ts.Days > 5)
      {
        //Run President's Report
        Thread PresidentReport = new Thread(new ThreadStart(RunPresidentReport));
        PresidentReport.Start();
      }
    }
  }
}

private void RunPresidentReport()
{
  MailMessage oMsg = new MailMessage();
  oMsg.From = new MailAddress("from@at.com");
  oMsg.To.Add(new MailAddress("to@at.com"));
  oMsg.Subject = "Website - President's Report for " + DateTime.Today.ToString("dd MMM yyyy");

  var db = new DataContext();
  DataLoadOptions dlo = new DataLoadOptions();

  var members = from m in db.Members
                where m.status == 1     //1 = active, 2=inactive
                orderby m.lastName, m.firstName
                select m;

  var sb = new StringBuilder();

  /** Code to generate body cut for simplicity **/

  if (sb.Length > 0)
  {
    oMsg.Body = sb.ToString();

    var emailClient = new SmtpClient();
    emailClient.Send(oMsg);

    var Data = from s in db.SystemDatas
               select s;

    if (Data.Count() > 0)
    {
      Data.First().LastUpdate = DateTime.Today;
      db.SubmitChanges(ConflictMode.ContinueOnConflict);
    }
  }
} 
```

然后将 SMTP 设置放入 web.config：

```
<configuration>
  <system.net>
    <mailSettings>
      <smtp from="NO_REPLY@at.com">
        <network host="localhost"/>
      </smtp>
    </mailSettings>
  </system.net>
</configuration> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T03:00:57.637

您可以使用 SQL Server 执行此操作：

**第 1 步**：[配置组件“数据库邮件 XP”](http://microsoft.productiveedge.com/sending-email-from-sql-server/)

**第 2 步**：创建一个存储过程，如：

```
CREATE PROCEDURE MySP
AS

    IF NOT EXISTS(SELECT * FROM myTable WHERE myColumn = someValue)
    BEGIN

        DECLARE @Result INT
        EXEC 
        @Result =  msdb.dbo.sp_send_dbmail
        @RECIPIENTS     = 'EMAILADDRESS1,EMAILADDRESS2,EMAILADDRESSN',
        @SUBJECT        = 'Subject',
        @BODY           = 'Body',
        @BODY_FORMAT    = 'HTML'

        SELECT Result = @Result 
   END 
```

**您需要相应地修改此过程**。

# static-analysis - Coverity：静态分析 - 忽略第一次警告

> ID：13299202
> 
> 赞同：0
> 
> 时间：2012-11-08T22:44:48.630
> 
> 标签：static-analysis

我在 Windows 上运行覆盖，想知道有没有办法在第一次运行时忽略所有警告并重新开始，只显示新代码中添加的警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T15:58:36.877

在 Coverity 4.x 中，这很容易；只需查看第一次运行中的所有缺陷并将它们标记为“待处理”（*不是*错误的），然后仅查看未分类的缺陷。在以后的版本中，用户界面不太方便，但基本思想是一样的。（作为记录，我认为你不应该简单地忽略现有代码中的所有缺陷。如果它们的误报率很高，你需要调整你的配置；否则它们最终值得被研究。我说一下在[我的 Dobb 博士的文章](http://www.drdobbs.com/testing/deploying-static-analysis/240003801)中了解更多信息。）

# jquery - jquery jsonp 对谷歌地图的请求没有返回结果

> ID：13299203
> 
> 赞同：0
> 
> 时间：2012-11-08T22:44:53.783
> 
> 标签：jquery, ajax, google-maps-api-3, jsonp, getjson

> **可能重复：**
> [使用 jQuery 解析 Google Geo API（反向地理编码）](https://stackoverflow.com/questions/5564830/parsing-google-geo-api-reverse-geocoding-with-jquery)

```
 $(window).load(function() {

var purl =  "http://maps.googleapis.com/maps/api/geocode/json?latlng=32.759294499999996,-97.32799089999999&sensor=false";
  $.getJSON(purl,function(result){
    $.each(result, function(i, field){
      $("#data").append(field + " ");
    });
  });

}); 
```

如果您访问该 url，您将看到 json 格式的结果。当我将其作为 $.getJSON 请求发送时，它不会在萤火虫的响应下返回任何内容，它是空白的。有什么想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:53:20.000

请参阅此处的反向地理编码示例：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-reverse](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-reverse)

这是他们的例子（减去地图）：

```
 var geocoder;

  function initialize() {
    geocoder = new google.maps.Geocoder();
  }

  function codeLatLng(lat, lng) {
    var latlng = new google.maps.LatLng(lat, lng);
    geocoder.geocode({'latLng': latlng}, function(results, status) {
      if (status == google.maps.GeocoderStatus.OK) {
        if (results[1]) {
           alert(results[1].formatted_address);
        } else {
          alert('No results found');
        }
      } else {
        alert('Geocoder failed due to: ' + status);
      }
    });
  }

$().ready(function () {
    initialize();
    codeLatLng(32.759294499999996,-97.32799089999999);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T10:05:35.063

```
$.ajax({
        type : "GET",
        url : URL,
        dataType : "jsonp",
        jsonp : "jsoncallback",
        jsonpCallback : MSS,
        cache : true,
        success : function(service_data) {
            binding(service_data);

        },
        error : function(msg) {
            alert(JSON.stringify(msg));
        }
    }); 
```

# tweepy - 如何在 Tweepy 中跟踪多个术语？

> ID：13299206
> 
> 赞同：0
> 
> 时间：2012-11-08T22:45:04.667
> 
> 标签：tweepy

我正在使用 Tweepy 并想跟踪两个单独的术语，“wordA”和“wordB”（意味着每条推文都将包含其中任何一个），但我也想将它们的结果存储在单独的结构中。是否可以在同一个身份验证对象上有两个单独的流侦听器？任何演示如何执行此操作的代码示例将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T22:11:05.640

每个用户只允许一个流，因此您必须在收到数据后将它们分开。

我倾向于这样做：

```
import tweepy
from tweepy.utils import import_simplejson
json = import_simplejson()
tracklist1=[wordA, wordAA]
tracklist2=[wordB, wordBB]

class CustomStreamListener(tweepy.StreamListener):

    def on_data(self, data):
        if 'in_reply_to_status_id' in data:
            temp=json.loads(data)
            words = [word.lower().strip('!,.:?"') for word in temp['text'].split()]
            if set(words) & set(tracklist1):
                print 'match A'
            elif set(words) & set(tracklist):
                print 'match B'
            else:
                print 'no match found' 
```

对我来说效果很好，并且使用 tracklist1 和 tracklist2 的列表允许您为您所关注的每个主题构建更复杂的搜索。您总是会得到一些不匹配的内容，因为 twitter 与用户名以及流 API 上的文本匹配。

要正确执行此操作，您可能需要过滤掉所有不是字母数字的内容，而不是像我在上面的示例中所做的那样仅删除最常见的标点符号。

# c# - 有没有一种巧妙的方法来翻转列表 进入列表 没有循环？

> ID：13299209
> 
> 赞同：2
> 
> 时间：2012-11-08T22:45:33.900
> 
> 标签：c#

有没有一种巧妙的方法可以将`List<int?>`非空的地方变成`List<int>`没有循环的地方？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T22:49:06.433

*您的*代码中没有循环。这将根据问题的*where 非空*部分丢弃空值。

```
var values = given.Where(n => n.HasValue).Select(n => n.Value).ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T22:53:42.323

您可以使用[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)：

```
var result = myList.Select(x => x ?? default(int)).ToList(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T22:50:56.343

不，没有参考守恒演员来做到这一点。`List<int>`并且`List<int?>`是不同的不兼容类型。

您需要创建一个副本，这意味着使用循环（直接或间接）。使用 LINQ 可以避免代码中的显式循环，但显然它仍然在内部使用循环。

# ruby-on-rails - 在 http_basic_authenticate_with 之后删除会话

> ID：13299210
> 
> 赞同：0
> 
> 时间：2012-11-08T22:45:39.893
> 
> 标签：ruby-on-rails

我正在学习 ruby​​ on rails，嗯

我有白色的这段代码可以登录并验证编辑帖子，但我不知道如何注销，我只能登录，然后我不能注销，请帮帮我

```
class PostsController < ApplicationController

http_basic_authenticate_with :name => 'admin', :password => 'meteoro', :except => [:index, :show]
# GET /posts
# GET /posts.json
def index
@posts = Post.all

respond_to do |format|
  format.html # index.html.erb
  format.json { render json: @posts }
end
end 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-05T23:41:55.937

您需要通过强制客户端向`Authorization`另一个请求发出请求来强制客户端松开标头

这是我在 /logout 视图中使用 jQuery ajax 调用的方法：

```
$.ajax({ 
  url : '/empty_200_page', 
  method : 'GET', 
  beforeSend : function(req) { 
    req.setRequestHeader('Authorization', 'nope'); 
  } 
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T23:11:54.877

HTTP 是无状态的，因此它实际上是浏览器（客户端）和服务器的约定，使您“登录”给定请求。 [查看这篇文章中的答案](https://security.stackexchange.com/questions/755/how-does-basic-http-auth-work)——重要的是，一旦身份验证完成，服务器将响应一个`Authorization`标头，浏览器将回传该标头。`request.headers['Authorization'] = ''`我认为，通过执行类似的操作手动清除控制器中的标头应该可行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T06:31:22.157

默认情况下，您输入的凭据存储在静态标题中，实际上无法从系统注销...

阅读此维基百科条目[http://en.wikipedia.org/wiki/Basic_access_authentication#Disadvantages](http://en.wikipedia.org/wiki/Basic_access_authentication#Disadvantages)

# composition - 在 After Effects 中增加合成的持续时间

> ID：13299212
> 
> 赞同：3
> 
> 时间：2012-11-08T22:45:52.107
> 
> 标签：composition, after-effects

我想使用我下载的股票组合。它是落叶的，是在 After Effects 中使用 Particular 构建的。[在这里](http://www.motion-graphics-exchange.com/ufiles/4711/4bdd8e8577f5d/LeavesParticular.zip)找到它！

我需要增加作曲的时间以匹配我正在使用的音乐编号（00:05:12:15）。我已经完成了整个右击组合并增加了持续时间值，但它仍在播放它的默认时间长度。

最终目标是在 Encore 项目中使用具有不同背景的乐曲以及上述音乐编号作为菜单。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T05:56:27.283

如果您使用 RAM 预览，在合成设置对话框中编辑持续时间后，您需要缩小时间线（时间线底部的小山/大山滑块），并确保您已拖动工作区域上的把手以填充构图的长度。您应该能够及时拖动当前时间指示器（播放头）。

[https://community.adobe.com/t5/after-effects/how-to-extend-a-composition-in-after-effects/td-p/7973571?page=1](https://community.adobe.com/t5/after-effects/how-to-extend-a-composition-in-after-effects/td-p/7973571?page=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T04:30:12.313

在进一步调查该问题后，我发现我无法增加合成的持续时间是由于两个嵌套合成中使用的视频资产的长度。为了解决这个问题，我在这两个嵌套合成中复制了视频层，并在每个后续层上重新定位了剪辑，直到我填满了我需要的持续时间。问题解决了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-21T10:47:58.633

*伙计们......我也有这个问题。和往常一样，当你最终找到解决方案时，你会说，哇！看起来很简单。*

这里有一个问题：当您打开“合成设置”对话框并更改持续时间以延长时间线时，您必须确保新的持续时间在所有字段中都有数字，包括毫秒！

换句话说，它不像时钟。它不会“假设”您“打算”在毫秒字段中放置 2 个零。如果您不输入这些零，它会自动大大缩短您的构图。

这就是一直发生在我身上的事情，直到我发现每个数字都需要在那里。该程序不假设任何内容。

因此，例如，如果您现有的作品是 0:01:30:00 并且您想将其更改为 2 分钟，您不能只输入 0:02:00 并点击确定。你必须输入 0:02:00:00 然后点击确定。

确保所有的数字都在那里，否则 AE 会弄乱你的脑袋！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-07T06:55:32.990

转到框架，右键单击，然后在时间选项下检查时间重映射

# javascript - 无限滚动对 SEO 不利

> ID：13299216
> 
> 赞同：3
> 
> 时间：2012-11-08T22:46:06.657
> 
> 标签：javascript, html, seo

由于内容是通过 javascript 加载而不是初始 HTML 的一部分，因此无限滚动是否对 SEO 不利？这应该是一个问题吗？最好的做法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T22:50:29.040

如果您遵循最佳实践并为不使用 JavaScript 的浏览器和机器人优雅地降级，那么您的页面应该没问题。

在无限滚动的情况下，您应该有正常的 HTML 链接元素，这些元素会转到包含下一个内容的页面。通过拥有这些链接，即使 googlebot 或其他网络爬虫无法观察到页面上的无限滚动功能，它们也可以找到您的其他内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:03:21.090

同样的规则也适用于所有其他 Ajax 应用程序的无限滚动。

最佳实践是[渐进式增强](http://en.wikipedia.org/wiki/Progressive_enhancement)- 您的页面也应该在没有 JavaScript 的情况下工作。无论如何，您正在编写服务器端分页机制，因此将其第一页作为标准 HTML 输出提供。如果客户端支持所需的技术（基本 JS、XHR），请删除“下一页”链接并动态加载它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:51:41.803

我告诉你该怎么做从你的浏览器中禁用 javascript，如果你能看到另一个页面的链接，那么你就可以了。如果你不能，你有一个问题，你将不得不创建一个分页并让它只显示javascript被禁用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T20:59:59.677

谷歌不阅读 JavaScript 并不是真的，谷歌阅读了一些 JavaScript 代码，但不是全部。Ajax 对 SEO 没有用，但会读取一些 javascript。例如，如果您禁用了 JS，则带有 javascript 的典型菜单将不会显示典型级联菜单的某些链接。但是谷歌允许这种类型的 JS，所以爬虫不读取所有 JS 是不正确的。

所以如果你的内容是用 Ajax 加载的，它就不会被读取。但是如果加载了一些简单的JS就会被谷歌读取。

# sql - 如何在另一个查询中使用 SQL Server 查询的结果

> ID：13299218
> 
> 赞同：1
> 
> 时间：2012-11-08T22:46:19.313
> 
> 标签：sql, sql-server

我对 SQL Server 相当陌生，并试图做一些看起来应该相当基本的事情，但我一定错过了一个重要的概念。

**首先，这是故事：**

*   我有表 X，其中包含订单中的行项目
*   我有表 Y，其中包含订单本身

我想将订单项数除以订单数，从而生成平均订单的订单项数。

**我尝试了几个选项：**

1.  我尝试将两个表连接在一起，然后将 X 的 count() 除以 Y 的计数。不幸的是，通过 X 到 Y 它为每个 Y 创建一个条目，因此除法的结果是一个。

    ```
    select count(x) / count (y) 
    from x 
    join y 
    ```

2.  我尝试通过计算“不同”订单而不是不同的订单项来使选择语句的一半“不同”。事实证明，您不能使选择语句的一半不同。

    ```
    select count(x) / distinct count (y) 
    from x 
    join y 
    ```

3.  我尝试制作一个新表，并将订单数的总和输出到新表中。然后我尝试将行项目数除以该表的值。除非我将表格连接在一起，否则这不起作用，这让我回到了原来的问题。

    ```
    select count(x) / temptable
    from x
    join temptable 
    ```

4.  我尝试查找如何将`SQL`语句输出到变量，以便我可以使用该变量进行除法，但无处可去。

5.  我已经仔细阅读了许多暗示这个问题但实际上并没有解决它的堆栈溢出帖子。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:50:59.460

```
SELECT AVG(1.0 * line_item_count) 
FROM (
  SELECT order_id, COUNT(*) as line_item_count
  FROM line_items
  GROUP BY order_id
) line_item_counts 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T22:54:39.310

最简单的方法是不使用子查询：

```
select count(*) * 1.0 / count(distinct order_id)
from line_items 
```

这假设所有订单至少有一个订单项。如果不是这种情况，您可以这样做：

```
select count(*) * 1.0 / (select count(*) from orders)
from line_items 
```

或者，如果您不喜欢`select`子句中的子查询，您可以改用连接：

```
select count(li.line_item_id)*1.0/count(distinct o.order_id)
from orders o left outer join
     line_items li
     on o.order_id = li.order_id 
```

# random - 将一个随机生成的数字乘以另一个数字会改变随机性的分布吗？

> ID：13299219
> 
> 赞同：1
> 
> 时间：2012-11-08T22:46:21.493
> 
> 标签：random, distribution

我的问题本质上是：

```
double d = random.nextDouble() * 2 (generates a number from 0 to 1 and multiplies by 2) 
```

相当于：

```
random.nextDouble(2) (generates a number from 0 to 2) 
```

我只是想知道它的理论。将随机生成的数字相乘是否会以任何方式影响其均匀分布？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-09T06:39:23.457

绝对可以。

如果您没有注意到，`d`将始终是 2 的倍数。而在第二种情况下，数字将均匀分布在 [0,2) 之间。

即使您将两个真正的随机变量相乘，概率分布也会发生变化。请参阅[了解“随机性”](https://stackoverflow.com/questions/3956478/understanding-randomness)

# ruby-on-rails - 来自 jtv-apns gem 的模块未加载

> ID：13299220
> 
> 赞同：0
> 
> 时间：2012-11-08T22:46:30.423
> 
> 标签：ruby-on-rails, module, gem

我正在使用 jtv-apns gem 向 iOS 推送通知：[https ://github.com/justintv/APNS](https://github.com/justintv/APNS)

这个 gem 只是一个模块 APNS。

在我的两台开发机器上，我已将 gem 添加到我的 Gemfile 中，并且能够在 rails 控制台或 lib/initializers 中的文件中要求“APNS”

但是，当我将这些更改推送到我的服务器时，我无法访问“APNS”，我得到一个`/home/username/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in 'require': cannot load such file -- APNSS (LoadError)`

所有机器都在运行 rails 3.2.3

我尝试卸载 gem 并重新捆绑，并通过`gem install`.

是否有某些原因导致 gem 中的模块不会加载到我的环境中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T17:10:47.293

我的 2 台开发机器是 Mac (UNIX)，我的服务器是 Ubuntu Linux。出于某种原因，服务器要求我使用`require 'apns'`小写的模块。

# c - 打印 C 后结构成员的值发生变化

> ID：13299222
> 
> 赞同：3
> 
> 时间：2012-11-08T22:46:35.333
> 
> 标签：c, member

在打印节点的 id 成员变量时，我得到了这段代码和一个奇怪的行为。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct node
{
    int id;
    int visited;
//    struct node *neighbors_[];
};

struct graph
{
    struct node nodes[26];
    int adjMat[26][26];

};

struct stack_item
{
    struct node node;
    struct stack_item *next_;
};

struct myStack
{
    struct stack_item *anfang_;

};

void initGraph(struct graph *graph_);
void push(struct myStack *stack_, struct node node);

int main()
{

    struct graph graph;
    struct myStack stack;
    char ausgabe[26]="";

    initGraph(&graph);

    //READ DATA
    char line[200];
    int firstTime=1,first;

    first=0;
    push(&stack,graph.nodes[first]);

    printf("ID %i\n",stack.anfang_->node.id);
    printf("ID %i\n",stack.anfang_->node.id);

    //FINISHED DATA READING
     //CALL DFS
    //dfs(graph,stack,ausgabe);
}

void push(struct myStack *stack_, struct node node)
{
    struct stack_item item;
    item.node=node;
    item.next_=stack_->anfang_;

    stack_->anfang_=&item;
}

void initGraph(struct graph *graph_)
{
    int i,j;
    for(i=0; i<26; i++)
    {
        struct node node= {i,0};
        graph_->nodes[i]=node;

        for(j=0; j<26; j++)
        {

            graph_->adjMat[i][j]=0;

        }
    }
} 
```

如果我执行此操作，第一个打印命令会导致“ID 0”，第二个会导致“ID 1980796117”。这个值如何通过打印来改变？请任何人帮助我，我真的不知道！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T22:58:33.710

```
void push(struct myStack *stack_, struct node node)
{
    struct stack_item item;
    item.node=node;
    item.next_=stack_->anfang_;

    /* BAD! */
    stack_->anfang_=&item;
} 
```

`item` is a local variable which, when the `push` function returns, goes out of scope. Any existing pointers which refer to this object are now invalid, and dereferencing it results in undefined behavior.

You will need to dynamically allocate `item` (i.e., `malloc`) if you need it to persist once the function has returned.

# c++ - 使用宏减少代码重复

> ID：13299225
> 
> 赞同：0
> 
> 时间：2012-11-08T22:46:41.563
> 
> 标签：c++

我想知道是否有人可以在编码时给我一个减少重复的指针。

我需要多次调用函数来填充结构，例如：

```
typedef struct {
    uint16_t u16_a;
    bool b_org;
    char* c_c;
    uint16_t u16_d;

} TEntry; 
```

我需要用函数调用填充这些值的每个值，尽管返回值各不相同，但所有值都使用相同的函数。宏是否足以以某种方式创建模板，以便返回类型取决于特定参数（“字符串”）

例如：

```
Trrelevant::Trrelevant()
{
    TPoint* u_apoint = Insufficient::FindValue("A");
    if (u_bpoint != NULL) {
        int a = u_apoint;
    }

    TPoint* p_apoint = Insufficient::FindValue("borg");
    if (p_bpoint != NULL) {
        bool b = p_bpoint;
    }

    TPoint* p_cpoint = Insufficient::FindValue("C");
    if (etc != NULL) {
        char* c = etc;
    }

    TEct* etc = Insufficient::FindValue("ETC");
    if (etc != ETC) {
        etc = etc;
    }

    TEntry entry = {a,
                    b,
                    c,
                    etc};
} 
```

此代码未编译或不准确，我只是想说明一下。我在 C++ 方面很弱并且对宏不熟悉，但是有人知道用宏解决这个问题的方法吗？

感谢您的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:29:37.167

最近我遇到了同样的问题，我不确定您使用哪种来源进行输入。个人而言，我使用 XML 作为输入。然后我有一个解析 XML 的 Builder 类调用工厂函数来使用来自解析器的数据构建 c++ 中的每个结构。

我认为 MACRO 或模板不会有任何帮助（或者这将是一个糟糕的解决方案）。请注意，如果您想在不重新编译的情况下进行更改，那么外部资源（如 xml）非常好。

最好的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:31:31.697

你可以做这样的事情，虽然我不知道它真的给你买了什么。

```
#define QuickFindValue(NAME, TYPE, FUNCTION)             \
     TYPE *NAME##Value = Insufficient::FindValue(#NAME); \
     if (NAME##Value == NULL) { FUNCTION; } 
```

你会像这样使用它：

```
QuickFindValue(C, TPoint, { 
  char *c = CValue;
  // Do stuff..
}); 
```

# javascript - D3中带有圆圈的过渡

> ID：13299227
> 
> 赞同：1
> 
> 时间：2012-11-08T22:46:46.223
> 
> 标签：javascript, d3.js

我已经设置了一个带有过渡的 D3 圆形动画。我使用最小日期作为初始数据点，使用最大日期作为过渡的最终数据点。我的问题是：

我正在使用一个相当大的数据集，恐怕因为我只是告诉转换从最小值到最大值，它会错过中间的所有其他点，例如如果圆圈 A 有一个疯狂的跳跃怎么办之间？当我对其进行测试时，它似乎只是跳过了跳跃。

有没有更好的方法来设置过渡以考虑介于两者之间的所有点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T20:51:25.337

如果您告诉对象从 min 转换为 max，它将仅尊重这两个值，并且正如您所说，它将跳过其间的任何有趣的跳跃。

我猜你目前通过推入所有数据来绘制一次图表。相反，您可以逐步将数据推送到图表：

```
var data = [{id: o1, v: []}, {id: o2, v: []}]; // values for 2 objects

function getTransform(d) {
    return "translate(" + d.v[d.v.length-1] + ")";
}

function update() {
  var elems = d3.selectAll(...).data(data, function(d) {return d.id;})
  elems.enter()
      .append(...) //append DOM/SVG objects and
      .attr(...)   //initalize their start values and
      .attr("transform", getTransform )  //their start animation values

  // animate the existing elements to move to their new values
  elems.transition().attr("transform", getTransform )
}

function play(){
    // pushing in "crazy" values
    data[0].v.push( Math.random()*10 );
    data[1].v.push( Math.random()*10 );
    update();
}

setTimeout(play, 500)
setTimeout(play, 1000)
setTimeout(play, 1500) 
```

基本思想是不要一次将所有数据扔到 d3 中，而是按照您希望它动画化的顺序和及时性添加数据。

此外，或者您可以设置时间索引并在`getTransform`函数中使用它来动画到您想要的任何状态。如果您逐步执行此操作，则可以使动画使用您的“疯狂”值。

```
var time = 0;
var maxTime = 2;

function getTransform(d) {
    return "translate(" + d.v[time] + ")";
}

function next(){
    update();
    if(time++ < maxTime) setTimeout(next, 500)
}

play(); play(); play(); // add some data ;)
next()   // start index based playback from `time` to `maxTime` 
```

您可能需要将超时值`500`与您想要的动画`duration(..)`速度相匹配，以使动画达到您的疯狂峰值。否则 d3 可能会平滑动画路径（如果更新速度比动画快）。

# php - 使用 cookie 进行 mysql 查询是否安全？

> ID：13299229
> 
> 赞同：-3
> 
> 时间：2012-11-08T22:47:05.373
> 
> 标签：php, html, mysql, cookies

我在一个项目中工作，我需要将数据存储在 cookie 中并在 mysql 查询中使用该数据，但不确定安全性.. 好吧，这是我的代码..

```
if(isset($_COOKIE['user_phone_id'])){
   echo "";
   $user_phone = $_COOKIE['user_phone'];
   $user_phone_id = $_COOKIE['user_phone_id'];
   $user_phone_url = strtr($user_phone, " ", "-");
   echo "";
   echo "<div id='phonelist_1' class='phonelist'>       
      <a style='color:white;font:bold 15px arial,helvetica,sans-serif; ' href='$user_phone_url'>
         <img src='./phones/".$user_phone_id.".jpg' alt='$user_phone' title='$user_phone' width='100px' height='100px' />
      </a><br />
      <a style='color:white;font:bold 15px arial,helvetica,sans-serif; ' href='$user_phone_url' title='$user_phone'>
         $user_phone
      </a><br /><div class='mobilebg'>";
   require_once "./phonec.php";
   $sql = "select mobile_name, mobile_id, parent_id from mobiles where parent_id =" . 
      $user_phone_id . " ";
   $rsd = mysql_query($sql);
   while($rs = mysql_fetch_array($rsd)) {
      $cid = $rs['mobile_id'];
      $cname = $rs['name_name'];
      echo " <a href='./$cid' style='width: 100%; text-decoration:none;'>
         <div class='mobilatcat'>
         <em style='float: right;'></em>
         <em style='padding-right: 20%;float: right;'>$cname</em> 
         <hr style='margin: 5px;' /></div></a>";
   }
   echo "</div></div> ";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:30:57.023

不，这不安全。您不应在 cookie 中显式存储任何数据库查询或查询数据。

Cookie 只是 mario 所说的用户输入，而且很容易被篡改。考虑这样的数据的服务器端存储选项（会话？）。

如果您真的想将此类数据存储在 cookie 中，请始终在发送到数据库之前对其进行[验证和过滤。](http://en.wikipedia.org/wiki/Data_validation)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-08T23:14:29.550

使用跨浏览器 (IE8+) 广泛支持的[localStorage对象。](https://developer.mozilla.org/en/DOM/Storage)

localStorage.setItem( 'someData', 42 );稍后（即使网站或浏览器关闭）

localStorage.getItem('someData') // === 42

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-08T22:49:16.273

你为什么不使用 php 会话

```
<?php
 session_start();
 // store session data
 $_SESSION['views']=1;
 ?> 
```

# java - Android获取空图像数据

> ID：13299232
> 
> 赞同：0
> 
> 时间：2012-11-08T22:47:26.550
> 
> 标签：java, android

我正在尝试从相机中获取图像。它工作正常。我可以拍照并在图像视图中显示。实际上，我想在拍摄后将这张照片发送到我的服务器。为此，我尝试将图像拉入`onActivityResult`. 但是，当我检查 Intent 数据时，它总是返回 null。即使应用程序运行良好并显示图像。为什么我的 Intent 数据为空？请你帮助我好吗？

这是代码：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        switch (requestCode) {
        case ACTION_TAKE_PHOTO_B: {
            if (resultCode == RESULT_OK) {
                        Log.e("TAG","data: "+data);
                    display_Photo();            

            //Process the image to send but, data is null   
            }
            break;
        }

    } 
    } 
```

**日志猫：**

数据：空

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:10:04.173

在您使用的代码中，有两个按钮 onclick 处理程序调用： `dispatchTakePictureIntent(int actionCode)`

一个按钮用枚举调用它，`ACTION_TAKE_PHOTO_B`而另一个调用用枚举调用`ACTION_TAKE_PHOTO_S`

如果您要传入，则返回的意图中`ACTION_TAKE_PHOTO_B`的预期结果是.`data``null`

原因是在`dispatchTakePictureIntent`调用intent之前`MediaStore.ACTION_IMAGE_CAPTURE`，会根据`actionCode`传入的额外设置一个intent参数：

```
takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(f)); 
```

根据[ACTION_IMAGE_CAPTURE 的文档](http://developer.android.com/reference/android/provider/MediaStore.html#ACTION_IMAGE_CAPTURE)：

> 调用者可能会传递一个额外的 EXTRA_OUTPUT 来控制该图像将被写入的位置。如果 EXTRA_OUTPUT 不存在，则在额外字段中将小尺寸图像作为位图对象返回。

因此，由于`EXTRA_OUTPUT`正在设置参数，因此您的图像将被写入磁盘，*而不是*在意图中作为数据返回。要获取文件位置，您可以 `mCurrentPhotoPath`在启动意图之前检查写入的内容。

# module - 编译Ocaml游戏时未绑定模块事件错误

> ID：13299235
> 
> 赞同：1
> 
> 时间：2012-11-08T22:47:32.210
> 
> 标签：module, compiler-errors, ocaml

我是 Ocaml 的新手，我试图从[http://lambda-diode.com/software/ocaml/](http://lambda-diode.com/software/ocaml/)编译游戏 mltetris 。我正在使用带有 ocaml 版本 4.00.0 的 Windows 7，但是当我尝试使用下面的命令进行编译时。我收到这个错误

```
C:\Users\WASSWA SAM\ocaml stuff\mltetris>ocamlc -pp camlp4o -o tetris.exe human.
ml game.ml play.ml tetris.ml tetris.mli
File "play.ml", line 21, characters 16-26:
Error: Unbound module Event 
```

事件模块不应该是标准发行版的一部分。我使用此命令检查了库

```
C:\Users\WASSWA SAM\ocaml stuff\mltetris>ocamlfind list
bigarray            (version: [distributed with Ocaml])
camlp4              (version: [distributed with Ocaml])
camlp4.exceptiontracer (version: [distributed with Ocaml])
camlp4.extend       (version: [distributed with Ocaml])
camlp4.foldgenerator (version: [distributed with Ocaml])
camlp4.fulllib      (version: [distributed with Ocaml])
camlp4.gramlib      (version: [distributed with Ocaml])
camlp4.lib          (version: [distributed with Ocaml])
camlp4.listcomprehension (version: [distributed with Ocaml])
camlp4.locationstripper (version: [distributed with Ocaml])
camlp4.macro        (version: [distributed with Ocaml])
camlp4.mapgenerator (version: [distributed with Ocaml])
camlp4.metagenerator (version: [distributed with Ocaml])
camlp4.profiler     (version: [distributed with Ocaml])
camlp4.quotations   (version: [distributed with Ocaml])
camlp4.quotations.o (version: [distributed with Ocaml])
camlp4.quotations.r (version: [distributed with Ocaml])
camlp4.tracer       (version: [distributed with Ocaml])
compiler-libs       (version: [distributed with Ocaml])
compiler-libs.bytecomp (version: [distributed with Ocaml])
compiler-libs.common (version: [distributed with Ocaml])
compiler-libs.optcomp (version: [distributed with Ocaml])
compiler-libs.toplevel (version: [distributed with Ocaml])
dbm                 (version: [distributed with Ocaml])
dynlink             (version: [distributed with Ocaml])
findlib             (version: 1.3.3)
graphics            (version: [distributed with Ocaml])
labltk              (version: [distributed with Ocaml])
num                 (version: [distributed with Ocaml])
num-top             (version: 1.3.3)
num.core            (version: [internal])
ocamlbuild          (version: [distributed with Ocaml])
stdlib              (version: [distributed with Ocaml])
str                 (version: [distributed with Ocaml])
threads             (version: [distributed with Ocaml])
threads.posix       (version: [internal])
unix                (version: [distributed with Ocaml]) 
```

缺少什么我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:11:58.840

事件模块似乎是线程工具的一部分。手册是这样说的：

> 使用系统线程的程序必须按如下方式链接：

```
 ocamlc -thread other options unix.cma threads.cma other files  
   ocamlopt -thread other options unix.cmxa threads.cmxa other files 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:10:03.860

是的，`Event`是标准库的一部分。

在我的机器上，以下命令序列正在运行：

```
ocamlopt -thread  -c human.ml
ocamlopt -thread  -c game.ml
ocamlopt -thread  -c tetris.ml
ocamlopt -thread  -c play.ml
ocamlopt -thread  unix.cmxa threads.cmxa graphics.cmxa human.cmx game.cmx tetris.cmx play.cmx   -o tetris.opt 
```

* * *

而不是手动编译每个文件，这可能在这种情况下工作，更长期的方法是使用提供的 Makefile，只需发出命令

```
make 
```

（上面的命令实际上是`make`运行的）。看起来你在 Windows 下，在这种情况下，一个选项是安装 Cygwin，它提供了一个`make`. Cygwin 本身就是一个完整的章节，在开始之前阅读它。

# php - 如何使用 jQuery 排序、结果数、页码等处理搜索查询字符串 SELECT 菜单？

> ID：13299237
> 
> 赞同：0
> 
> 时间：2012-11-08T22:47:49.230
> 
> 标签：php, jquery, forms, parameters, query-string

我有多种形式用于提供各种搜索功能，例如排序选项、每页结果数、页码等。我使用 GET 方法，因此可以使用 URL 来记住页面的状态。我正在使用 PHP 将 REQUEST_URI 回显到每个表单的操作属性中。

更改每个 SELECT 菜单时处理传递参数的最佳方法是什么？例如，排序选择有它自己的形式。当用户在选择菜单中更改排序时，页面应重新加载并为所选排序值添加查询字符串。

以下是一些网址：

*   /搜索/?sort=desc
*   /search/?sort=desc&page=2
*   /search/?sort=desc&results=200&page=4

我遇到的主要问题之一是 ? 和&s。

# iphone - 为什么我的 Arduino 到 iPhone 串行通信会出现乱码？

> ID：13299245
> 
> 赞同：1
> 
> 时间：2012-11-08T22:48:14.580
> 
> 标签：iphone, xcode, serial-port

我有一个 Arduino Duemilanove 设置，可以通过串行 TX 端口发送一个基本的字符串。在另一端，我有一个 iPhone 设置，可以通过坞站连接器中的串行端口接收消息。

当我运行以下命令时`cat /dev/tty.iap 9600`，我看到 Arduino 发送的消息被打印在终端窗口上。消息`Hello iPhone`正在通过 while 循环发送，该循环在屏幕上重复打印消息。

因此，当我尝试在我正在开发的 iPhone 应用程序中阅读消息时，我的问题就开始了。我为应用程序中的基本串行控制台组合了一个简单的 GUI，我得到了如下字符，

**带有按钮的覆盖层在那里，因为物理主页按钮不起作用。**

![基本 iPhone 串行控制台](../Images/4d875770eaa2f2089127e3c5445d1873.png)

我正在使用从[本教程中找到的代码打开串行端口](http://inornate.springnote.com/pages/8139470?print=1)

串行接口文件如下所示，

**JailbrokenSerial.h**

```
#import <Foundation/Foundation.h>
#include <termios.h> /* POSIX terminal control definitions */

@protocol JailbrokenSerialDelegate
- (void) JailbrokenSerialReceived:(char)ch;
@end

@interface JailbrokenSerial : NSObject {
    NSThread *thread;
   __unsafe_unretained id<JailbrokenSerialDelegate> _receiver; // added "__unsafe_unretained" because of SO thread
    int fd;
    struct termios gOriginalTTYAttrs;
    BOOL debug;                         // will print debugging message if YES
    BOOL nonBlock;                      // will act as nonblocking mode. delegate 'receiver' required
    char receivedCh;
}

@property (nonatomic, assign) id<JailbrokenSerialDelegate> receiver;
@property (nonatomic, assign) BOOL debug;
@property (nonatomic, assign) BOOL nonBlock;

- (id)initWithReceiver:(id<JailbrokenSerialDelegate>) receiver;

- (BOOL)open:(int)baudRate;
- (BOOL)isOpened;
- (void)close;
- (ssize_t)read:(void *)buffer length:(size_t)len;
- (void)write:(const char *)message length:(int)len;
- (void)write:(NSString *)message;
@end 
```

**JailbrokenSerial.m**

```
#include <stdio.h>   /* Standard input/output definitions */
#include <string.h>  /* String function definitions */
#include <unistd.h>  /* UNIX standard function definitions */
#include <fcntl.h>   /* File control definitions */
#include <errno.h>   /* Error number definitions */

#include <sys/ioctl.h>

#import "JailbrokenSerial.h"

@interface JailbrokenSerial ()
- (void)readPoller;
@property (nonatomic, retain) NSThread *thread;
@end

@implementation JailbrokenSerial

//@synthesize receiver = _receiver;
@synthesize debug, nonBlock;
@synthesize thread;

- (id)init
{
    self = [super init];
    if (self) {
        // Initialization code here.
        fd = -1;
        debug = false;
        nonBlock = false;
        self.thread = nil;
    }

    return self;
}

- (id)initWithReceiver:(id<JailbrokenSerialDelegate>) receiver {
    self = [self init];
    if(self) {
        [self setReceiver:receiver];
    }

    return self;
}

- (void)dealloc {
    [thread cancel];
    //[thread release];

   // [super dealloc];
}

- (void)readPoller {
    //  // Top-level pool
    char ch;
    int buf_len;

   // NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    NSRunLoop* myRunLoop = [NSRunLoop currentRunLoop];

    while(![[NSThread currentThread] isCancelled]) {

        buf_len = read(fd,&ch,1); // Read 1 byte  over serial.  This will block
        //        NSLog(@"Loop");

        // If something can be read
        if(buf_len == 1) {
            receivedCh = ch;
            [self performSelectorOnMainThread:@selector(sendReadMessage) withObject:nil waitUntilDone:YES];
        }
        else if(buf_len == -1) {
            [NSThread sleepForTimeInterval:0.1]; // set the wait time for the read loop - IMPORTANT
        }
        [myRunLoop runUntilDate:[NSDate dateWithTimeIntervalSinceNow:1]];
    }
    //[pool release];
}

- (void)sendReadMessage {
    [self.receiver JailbrokenSerialReceived:receivedCh];
}

- (ssize_t)read:(void *)buffer length:(size_t)len {
    return read(fd, buffer, len);
}

- (BOOL)open:(int)baudRate {
    struct termios  options;

    int fileDescriptor = open("/dev/tty.iap", O_RDWR | O_NOCTTY | O_NONBLOCK);
    //    int fileDescriptor = open("/dev/tty.iap", O_RDWR | O_NOCTTY | O_NDELAY);
    if (fileDescriptor == -1)
    {
        if(debug) NSLog(@"Error opening serial port %@ - %s(%d).", @"/dev/tty.iap", strerror(errno), errno);
        close(fileDescriptor);
        return false;
    }

    if(ioctl(fileDescriptor, TIOCEXCL) == -1) {
        if(debug) NSLog(@"Error setting TIOCEXCL on %@ - %s(%d).", @"/dev/tty.iap", strerror(errno), errno);
        close(fileDescriptor);
        return false;
    }

    if(nonBlock) {
        if(fcntl(fileDescriptor, F_SETFL, O_NONBLOCK) == -1) {
            if(debug) NSLog(@"Error setting O_NONBLOCK on %@ - %s(%d).", @"/dev/tty.iap", strerror(errno), errno);
            close(fileDescriptor);
            return false;
        }
    }
    else {
        if(fcntl(fileDescriptor, F_SETFL, 0) == -1) {
            if(debug) NSLog(@"Error clearing O_NONBLOCK on %@ - %s(%d).", @"/dev/tty.iap", strerror(errno), errno);
            close(fileDescriptor);
            return false;
        }
    }
    tcgetattr(fileDescriptor, &gOriginalTTYAttrs);

    options = gOriginalTTYAttrs;

    if(debug) {
        NSLog(@"Current input baud rate is %d\n", (int) cfgetispeed(&options));
        NSLog(@"Current output baud rate is %d\n", (int) cfgetospeed(&options));
    }

    // Set raw input (non-canonical) mode, with reads blocking until either a single character
    // has been received or a one second timeout expires.
    // See tcsetattr(4) ("man 4 tcsetattr") and termios(4) ("man 4 termios") for details.
    cfmakeraw(&options);
    options.c_cc[VMIN] = 1;
    options.c_cc[VTIME] = 10;

    // The baud rate, word length, and handshake options can be set as follows:

    cfsetspeed(&options, baudRate);    // Set 19200 baud
    options.c_cflag &= ~PARENB;      // Set as 8-1-N
    options.c_cflag &= ~CSTOPB;
    options.c_cflag &= ~CSIZE;
    options.c_cflag |= CS8;

    if(debug) {
        NSLog(@"Input baud rate changed to %d\n", (int) cfgetispeed(&options));
        NSLog(@"Output baud rate changed to %d\n", (int) cfgetospeed(&options));
    }

    tcsetattr(fileDescriptor, TCSANOW, &options);

    fd = fileDescriptor;

    if(nonBlock) {
        self.thread = [[NSThread alloc] initWithTarget:self selector:@selector(readPoller) object:nil];
        [thread start];
    }

    return true;
}

- (BOOL)isOpened {
    if(fd==-1)
        return false;
    else
        return true;
}

- (void)close{
    if(fd != -1) {
        close(fd);
        fd = -1;
        [thread cancel];
        self.thread = nil;

        if(debug)
            NSLog(@"Closed");
    }
}

- (void)write:(const char *)message length:(int)len {
    if(fd != -1) {
        write(fd, message, len);
    }
    if(debug) {
        NSLog(@"%d bytes wrote", len);
    }
}

- (void)write:(NSString *)message {
    [self write:[message UTF8String] length:[message length]];
}

@end 
```

我像这样在串行控制台视图控制器中打开串行端口，

**ViewControllerSerialConsole.h**

```
#import <UIKit/UIKit.h>
// #import "Serial.c"
#import "JailbrokenSerial.h"

#define BUFFER_LEN 1024

@interface ViewControllerSerialConsole : UIViewController <JailbrokenSerialDelegate> {
    JailbrokenSerial *serial;

    UInt8 rxBuffer[BUFFER_LEN];
    UInt8 txBuffer[BUFFER_LEN];

}
@property (weak, nonatomic) IBOutlet UITextField *textEntry;
@property (weak, nonatomic) IBOutlet UIButton *btnSend;
@property (weak, nonatomic) IBOutlet UITextView *serialView;
/*
@property (weak, nonatomic) IBOutlet UIToolbar *btnOpen;
@property (weak, nonatomic) IBOutlet UIToolbar *btnClose;
@property (weak, nonatomic) IBOutlet UIToolbar *btnDone;
 */

- (IBAction)donePressed:(id)sender;
- (IBAction)sendString:(id)sender;
- (IBAction)openSerial:(id)sender;
- (IBAction)closeSerial:(id)sender;

@end 
```

**ViewControllerSerialConsole.m**

```
#import "ViewControllerSerialConsole.h"

@interface ViewControllerSerialConsole ()

@end

@implementation ViewControllerSerialConsole
@synthesize textEntry = _textEntry;
@synthesize btnSend = _btnSend;
@synthesize serialView = _serialView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [self setTextEntry:nil];
    [self setBtnSend:nil];
    [self setSerialView:nil];
    /*
    [self setBtnOpen:nil];
    [self setBtnClose:nil];
    [self setBtnDone:nil];
     */
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)donePressed:(id)sender
{
    [self dismissModalViewControllerAnimated:YES];    
}

- (IBAction)sendString:(id)sender {
    // dismiss keyboard
    [self.textEntry resignFirstResponder];
}

- (IBAction)openSerial:(id)sender
{
    serial.debug = YES; // debug messaages will be printed out using NSLog() if the flag is set to YES

    [serial open:B9600];
    NSLog(@"%c", [serial isOpened]);

    serial.nonBlock = true;

    serial.receiver = self;

    char buffer[12];
    [serial read:buffer length:12]; // will be blocked until read 5 characters.

    // print line to textview
    _serialView.text = [NSString stringWithFormat:@"%s",buffer];

}

- (IBAction)closeSerial:(id)sender
{
    [serial close];
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T19:21:38.513

我从分线板上取下了所有电线，并重新焊接了所有连接，这似乎解决了我的问题:)

# apache-flex - 谁能指出我正确的直接来解决这个问题？

> ID：13299253
> 
> 赞同：0
> 
> 时间：2012-11-08T22:48:27.903
> 
> 标签：apache-flex, flex4.5, flexbuilder

我收到错误

错误 #2044：未处理的 SQLErrorEvent：。errorID=3115，操作=执行，消息=错误 #3115：SQL 错误。，详细信息='TEXT' 附近：语法错误

我正在尝试学习编程，所以我完全按照视频教程进行操作。在过去的 3 个小时里，我一直在寻找这个语法错误，并试图继续进行培训。谁能指出我正确的方向“遗憾的是付费视频课程不提供帮助:(”来解决这个问题？如果我可以在自己的视图中创建数据库并让其他视图写入也很高兴知道它并从中提取数据我不知道培训是否会涉及到这一点，但想知道我可以在哪里学习如何在弹性环境中做到这一点。

```
 the error below
            statement.text = "INSERT INTO archive (variable TEXT, variable TEXT) VALUES ('"+variable+"','"+variable+"')"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:59:42.750

尝试将 SQL 语句的开头更改为：

```
INSERT INTO archive (title, journal) VALUES 
```

您不应该在插入语句中包含数据类型。

# mysql - 跨多个表连接和计数

> ID：13299262
> 
> 赞同：1
> 
> 时间：2012-11-08T22:49:01.593
> 
> 标签：mysql, sql, count, sum, self-join

我正在尝试编写一个复杂的（至少，就我的知识水平而言）字符串，但我有一个地狱般的时间。

这就是问题所在。我有两张表，一张名为 t1，一张名为 c1。

这些表定义如下：

```
table T1:

e_id, char(8),  
e_date, datetime,  
e_status, varchar(2)

table C1:

e_id, char(8),  
e_date, datetime,  
e_status, varchar(2) 
```

每个表都包含一个标识符列表，这些标识符可能会在两个表中找到，也可能不会（它们在每个表中可能是唯一的，也可能不是唯一的），以及相关的状态（在 T1 表中可以是“OK”或“R”，可以是C1 表中的“OK”或“C”），以及与 e_id 的每次出现相关联的日期时间 e_date

我正在尝试编写一个查询，它将：

*   检索 T1 表中具有`e_date`过去 24 小时内的所有 e_id 值。
*   **检索过去 30 天内（e_date > now - 30 天）内 T1 中过去 24 小时内（ e_date 大于当前时间 - 24h** ）发生的所有 e_id ，仍在表 T1 内（**例如：如果 e_id 的 AAAAAAA并且 BBBBBBBB 在 t1 中找到，并且 e_date 在过去 24 小时内，检索 e_id 的 AAAAAAAAA 和 BBBBBBBB 在同一个表中的所有出现，但 e_date 在过去 30 天内**）
*   将在整个中找到的`e_status = 'OK'`每个特定的计数附加到行结果中`e_id``T1 table`
*   将在整个中找到的`e_Status = 'OK'`每个特定的计数附加到行结果中`e_id``C1 table`

我会尽我所能在这里写一些示例数据/结果。为清楚起见，我将忽略表数据类型。假设当前日期和时间是 2012-Nov-08 19:00:00

T1：

1.  e_id: **'A'** , e_date: **2012-Nov-08 10:00:00** , e_status: **'OK'**
2.  e_id: **'A'** , e_date: **2012-Nov-08 10:00:00** , e_status: **'R'**
3.  e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'R'**
4.  e_id: 'B', e_date: **2012-Oct-15 10:00:00** , e_status: **'OK'**
5.  e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'OK'**
6.  e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'R'**
7.  e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'R'**
8.  e_id: **'A'** , e_date: **2010-Jan-01 10:00:00** , e_status: **'R'**
9.  e_id: **'A'** , e_date: **2010-Jan-01 10:00:00** , e_status: **'R'**

C1：

1.  e_id: **'A'** , e_date: **2012-Oct-01 10:00:00** , e_status: **'C**
2.  e_id: 'B', e_date: **2012-Oct-01 10:00:00** , e_status: **'OK'**
3.  e_id: **'A'** , e_date: **2012-Oct-01 10:00:00** , e_status: **'C**
4.  e_id: 'B', e_date: **2012-Oct-01 10:00:00** , e_status: **'OK'**
5.  e_id: **'A'** , e_date: **2012-Oct-01 10:00:00** , e_status: **'OK'**

运行查询将产生：

e_id, e_date, e_status, r_count, c_count
1\. e_id: **'A'** , e_date: **2012-Nov-08 10:00:00** , e_status: **'OK'** , r_count: **6** , c_count: **2**
2\. e_id: **'A'** , e_date: **2012-Nov-08 10:00:00** , e_status: **'R'** , r_count: **6** , c_count: **2**
3\. e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'R'** , r_count: **6** , c_count: **2**
4\. e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'OK'** ,r_count：**6** , c_count: **2**
5\. e_id: **'A'** , e_date: **2012-Oct-15 10:00:00** , e_status: **'R'** , r_count: **6** , c_count: **2**
6\. e_id: **'A'** , e_date: **2012 -Oct-15** 10:00:00 ，e_status：**'R'**，r_count：**6**，c_count：**2**

真的很抱歉，我不得不将 T1 第 3 行的日期更改为第 7 行（结果的第 3 4 5 6 行），因为这些值是错误的。

T1 的第 4 行未返回，因为`e_id: B`在过去 24 小时内未找到
T1 第 8 行和第 9 行未返回，因为它们在过去 30 天之外

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T02:54:34.157

是时候做一些 TDQD — 测试驱动的查询设计了。

### 过去 24 小时内 T1 中的行数

```
SELECT DISTINCT e_id
  FROM T1
 WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR) 
```

这将是查询的其他部分中普遍存在的子查询。

### 过去 30 天内 T1 中的行...

...在过去 24 小时内在 T1 中有一个条目。

```
SELECT a.e_id
  FROM t1 AS a
  JOIN (SELECT DISTINCT e_id
          FROM T1
         WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
       ) AS b ON b.e_id = a.e_id
 WHERE a.e_date >= DATE_SUB(NOW(), INTERVAL 30 DAY) 
```

我们可以根据需要添加其他列。

### T1 中状态为“R”的行数...

...在过去 24 小时内在 T1 中有一个条目

```
SELECT a.e_id, COUNT(*) AS r_count  -- Per question; why not t_count?
  FROM t1 AS a
  JOIN (SELECT DISTINCT e_id
          FROM T1
         WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
       ) AS b ON b.e_id = a.e_id
 WHERE a.e_status = 'R'
 GROUP BY a.e_id 
```

### C1 中状态为“C”的行数...

...在过去 24 小时内在 T1 中有一个条目

```
SELECT a.e_id, COUNT(*) AS c_count
  FROM c1 AS a
  JOIN (SELECT DISTINCT e_id
          FROM T1
         WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
       ) AS b ON b.e_id = a.e_id
 WHERE a.e_status = 'C'
 GROUP BY a.e_id 
```

### 组装查询集以产生结果

```
SELECT a.e_id, a.e_date, a.e_status, c.r_count, d.c_count
  FROM t1 AS a
  JOIN (SELECT DISTINCT e_id
          FROM T1
         WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
       ) AS b ON b.e_id = a.e_id
  LEFT JOIN -- Because there might be no OK rows in T1
       (SELECT a.e_id, COUNT(*) AS r_count
          FROM t1 AS a
          JOIN (SELECT DISTINCT e_id
                  FROM T1
                 WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
               ) AS b ON b.e_id = a.e_id
         WHERE a.e_status = 'OK'
         GROUP BY a.e_id
       ) AS c ON c.e_id = a.e_id
  LEFT JOIN -- Because there might be no OK rows in C1
       (SELECT a.e_id, COUNT(*) AS c_count
          FROM c1 AS a
          JOIN (SELECT DISTINCT e_id
                  FROM T1
                 WHERE e_date >= DATE_SUB(NOW(), INTERVAL 24 HOUR)
               ) AS b ON b.e_id = a.e_id
         WHERE a.e_status = 'OK'
         GROUP BY a.e_id
       ) AS d ON d.e_id = a.e_id
 WHERE a.e_date >= DATE_SUB(NOW(), INTERVAL 30 DAY) 
```

您可能可以编写没有 24 小时子子查询的子查询，但尽快消除尽可能多的行可能是有效的。

* * *

TDQD 背后的概念的一个优点是您可以检查中间结果。有一些基本上是微不足道的语法问题（部分原因是 MySQL 不是我的主要 DBMS），但是两个 COUNT 子查询从 JOIN 到 LEFT JOIN 的变化是您在组装查询时容易发现的事情. 第一次尝试把所有事情都做好是很困难的，如果不是徒劳的话。但是一步一步的积累可以让你对你所做的事情充满信心。如果不测试组件子查询，我永远不会从头开始构建如此复杂的查询。

感谢[FatalMojo](https://stackoverflow.com/users/309689/fatalmojo)的（次要）更新。

# r - 无处谋划

> ID：13299263
> 
> 赞同：2
> 
> 时间：2012-11-08T22:49:05.343
> 
> 标签：r, plot

我正在使用`plotMDS()`package 的功能，`limma`它通过 R 的简单`plot()`格式制作图，并将图上点的位置作为输出返回。我想使用 的输出`plotMDS()`来制作我自己的美丽情节。

有没有办法在`plotMDS()`没有真正生成情节的情况下运行？我这样问的原因是我已经将输出转换为 PDF 文件，我不希望原来的情节在`plotMDS()`那里！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:20:56.937

谢谢@BenBolker，可以这样做：

```
pdf("Some file")
...
dev.new() # Putting new plots to nowhere
mds <- plotMDS(data)
dev.off() # Restoring new plots to the PDF file
plot(...) # Making the desired plot using mds
...
dev.off() # Closing PDF file 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T02:12:03.017

查看您的答案，这似乎是一个合理的选择：

```
mds <- plotMDS(data)
pdf("Some file")
...
plot(...) # Making the desired plot using mds
...
dev.off() # Closing PDF file 
```

我不知道你在做什么，但如果你对可复制的文档感兴趣，那么你也可以使用这个`knitr`包来创建你的输出。很容易抑制单个绘图，然后稍后使用 knitr 绘图*。*

# ruby - Ruby heredoc 使整个文档在 eclipse ide 中成为字符串文字

> ID：13299270
> 
> 赞同：0
> 
> 时间：2012-11-08T22:49:21.327
> 
> 标签：ruby, eclipse, macos

我正在尝试用`heredoc`Ruby 发送电子邮件，但我的整个代码似乎变成了字符串文字。我正在使用`Eclipse`Ruby 插件，但我无法弄清楚问题所在。这里的代码直接取自教程，所以我不明白为什么它不起作用。任何人都可以对此有所了解吗？

这是我的代码：

```
require 'net/smtp'

filename = "/tmp/test.txt"
# Read a file and encode it into base64 format
filecontent = File.read(filename)
encodedcontent = [filecontent].pack("m")   # base64

marker = "AUNIQUEMARKER"

body = <<-EOF
This is a test email to send an attachement.
EOF

# Define the main headers.
part1 = <<-EOF
From: Private Person <me@fromdomain.net>
To: A Test User <test@todmain.com>
Subject: Sending Attachement
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary=#{marker}
--#{marker}
EOF

# Define the message action
part2 = <<-EOF
Content-Type: text/plain
Content-Transfer-Encoding:8bit

#{body}
--#{marker}
EOF

# Define the attachment section
part3 = <<-EOF
Content-Type: multipart/mixed; name=\"#{filename}\"
Content-Transfer-Encoding:base64
Content-Disposition: attachment; filename="#{filename}"

#{encodedcontent}
--#{marker}--
EOF

mailtext = part1 + part2 + part3

# Let's put our code in safe area
begin 
  Net::SMTP.start('localhost') do |smtp|
     smtp.sendmail(mailtext, 'me@fromdomain.net',
                          ['test@todmain.com'])
  end
rescue Exception => e  
  print "Exception occured: " + e  
end 
```

这是它的样子`Eclipse`：

![在此处输入图像描述](../Images/c9ee5d8670def1c2f62a56cb4dc4471d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T21:37:00.473

我知道这个问题有点老了，但我认为如果你在关闭“EOF”之前使用标签它应该可以工作。我认为，当您在“<<”之后添加“-”时，它会在结束词之前查找制表符，因此另一种方法可能是删除“-”。

我不太确定，我并没有真正使用 heredocs，因为它在字符串编码方面存在问题（如 á é í ...），但如果有人遇到这个问题，他们应该检查一下。

我希望这可以帮助别人。

# objective-c - 更新 NSOutlineView 的内容

> ID：13299271
> 
> 赞同：1
> 
> 时间：2012-11-08T22:49:23.350
> 
> 标签：objective-c, macos, cocoa, nsoutlineview, nstreecontroller

我有一个 NSOutlineView 显示由 NSTreeController 控制的内容，我将其绑定到 NSMutableArray (arrayOfFiles)。该数组包含 NSTreeNode 对象，其中代表对象（Fileobject 类）包含许多 ivars。我想为特定对象编辑和更新名为“direction”的 ivar。我设法使用为每个对象存储的 NSIndexPath 来获取我感兴趣的对象。

```
[self.myOutlineViewController.myTreeController setSelectionIndexPath:myIndexPath];

Fileobject *myObject =[[[self.myOutlineViewController.myTreeController.arrangedObjects descendantNodeAtIndexPath:myIndexPath] representedObject] representedObject];

[myObject setDirection:0]; 
```

这很好用，但是当我想更新刚刚在 NSIndexPath 提取的对象时遇到了问题。以下崩溃：`[self.myOutlineViewController.myTreeController removeObjectAtArrangedObjectIndexPath:myIndexPath];`带有错误消息

```
An uncaught exception was raised
2012-11-08 17:23:25.557 S3access[20379:12b03] *** -[NSKeyValueSlowMutableArray     removeObjectsAtIndexes:]: value for key myArrayOfFiles of object 0x40012e460 is nil 
```

[我知道我在这里的键值编码](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CocoaBindings/Concepts/CntrlContent.html)做错了，但我看不到它是什么。我试图在 Apple 的所有示例中寻求解决方案，但我只能找到不使用 NSTreeController 和 NSTreeNode 的示例。我的想法是 1）在 indexpath 处提取对象 2）编辑提取的对象 3）在 indexpath 处删除当前对象 4）使用 command 将我新编辑的对象插入 indexpath 中`[self.myOutlineViewController.myTreeController insertObject:myNode atArrangedObjectIndexPath:myIndexPath];`。当我不只替换 ivar 而是替换整个对象时，我看不到如何使用键值编码替换我的对象？

任何关于我做错了什么的建议以及关于我如何解决这个问题的建议都非常感谢。

干杯，谢谢！特隆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T04:01:40.133

我终于设法让我的 NSOutlineView 更新正常工作，因为我的问题是一种极端的风滚草，我想我至少会更新一个答案。事实证明，我的问题更多是缺乏对 KVC 的正确理解，而不是编程问题。在阅读了有关 Stackoverflow 和[Apple 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)的问题的答案后，我终于弄清楚了如何启用我的 NSOutlineView 及其使用 NSTreeNode 表示的 NSTreeController 内容（arrangedObjects）的动态更新。假设您知道对象的 NSIndexPath (myIndexPath)，以下代码对我有用：

```
[self.myOutlineViewController.myOutlineView willChangeValueForKey:@"direction"];
[[[[self.myOutlineViewController.myTreeController.arrangedObjects descendantNodeAtIndexPath:myIndexPath] representedObject] representedObject] setDirection:0];
[self.myOutlineViewController.myOutlineView didChangeValueForKey:@"direction"]; 
```

希望这可以帮助其他一些人。干杯，特隆德

# asp.net - 删除事件后GridView不刷新

> ID：13299274
> 
> 赞同：4
> 
> 时间：2012-11-08T22:49:29.010
> 
> 标签：asp.net, linq-to-sql, gridview, refresh

我对 asp.net 有一个奇怪的问题`GridView`。我有`GridView`那个绑定到一个`LinqDataSource`. 在`GridView`的行删除事件中，我正在从数据库中删除行，但网格没有刷新（即使在绑定到数据源之后）。

当我放置断点时，我可以看到`OnRowDeleting`事件在事件之后被触发`LinqDS_Selecting`。但是在删除事件之后它没有再次被触发！这可能是原因吗？我究竟做错了什么？

有人可以帮忙吗。提前谢谢了。

.aspx 文件：

```
<asp:LinqDataSource
    ID="LinqDS"
    runat="server"
    OnSelecting="LinqDS_Selecting">
</asp:LinqDataSource>

<asp:GridView
    DataSourceID = "LinqDS"
    ID = "gv1"
    runat = "server"  
    DataKeyNames = "InstructionId"
    EnableViewState = "false"
    OnRowDataBound = "gv1_RowDataBound" 
    OnRowDeleting = "gv1_RowDeleting" 
    OnRowCommand = "gv1_RowCommand"
    PageSize = "30" >
    <Columns>
        <!-- My colums --->
    </Columns>
</asp:GridView> 
```

.aspx.cs

```
protected void Page_Load(object sender, EventArgs e)
{

}

protected void LinqDS_Selecting(object sender, LinqDataSourceSelectEventArgs e)
{
    // my linq to sql query
    var query = from  .... .... ;
    e.Result = query;
}

protected void gv1_RowDeleting(object sender, GridViewDeleteEventArgs e)
{
    int instructionId = (int)gv1.DataKeys[e.RowIndex].Value;
    /// my delete logic
    CTX.SubmitChanges();
    gv1.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T10:34:59.837

I can't point out error in your code but I am giving you my code which i did to delete the data.

```
<asp:GridView ID="GridView1" runat="server" OnRowDeleting="Del" DataKeyNames="Clg_ID" BackColor="#DEBA84" 
                BorderColor="#DEBA84" BorderStyle="None" BorderWidth="1px" CellPadding="3" 
                CellSpacing="2">
                <Columns>
                    <asp:CommandField ShowDeleteButton="True" />
                </Columns>
                <FooterStyle BackColor="#F7DFB5" ForeColor="#8C4510" />
                <HeaderStyle BackColor="#A55129" Font-Bold="True" ForeColor="White" />
                <PagerStyle ForeColor="#8C4510" HorizontalAlign="Center" />
                <RowStyle BackColor="#FFF7E7" ForeColor="#8C4510" />
                <SelectedRowStyle BackColor="#738A9C" Font-Bold="True" ForeColor="White" />
                <SortedAscendingCellStyle BackColor="#FFF1D4" />
                <SortedAscendingHeaderStyle BackColor="#B95C30" />
                <SortedDescendingCellStyle BackColor="#F1E5CE" />
                <SortedDescendingHeaderStyle BackColor="#93451F" />
            </asp:GridView> 
```

.cs file

```
protected void Del(object sender, GridViewDeleteEventArgs e)
    {
        string i = GridView1.DataKeys[0].Value.ToString();
        SqlConnection cn = new SqlConnection();
        cn.ConnectionString = ConfigurationManager.ConnectionStrings["cn"].ConnectionString.ToString();
        cn.Open();
        SqlCommand cmd = new SqlCommand("Delete from Feedback where Clg_ID='" + i + "'", cn);
        cmd.ExecuteNonQuery();
        cmd.Dispose();
        cn.Close();
        Response.Redirect("MFeedback.aspx");
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T11:06:09.287

如果您的记录实际上被正确删除并且网格只是没有显示更改，我会尝试将 GridView 放在 UpdatePanel 中，看看这是否有帮助。

```
<asp:UpdatePanel runat="server" UpdateMode="Always">
    <ContentTemplate>
        // GridView
    </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T10:58:55.067

尝试`EditIndex`在 GridView 的方法上将 GridView 设置为 -1 `ItemDeleting`：

```
protected void gv1_RowDeleting(object sender, GridViewDeleteEventArgs e) {
    gv1.EditIndex = -1;
    gv1.DataBind();
} 
```

并将删除逻辑移至`RowCommand`GridView 的方法：

```
protected void gv1_RowCommand(object sender, GridViewDeleteEventArgs e) {
    If (e.CommandName == "Delete") {
        int instructionId = (int) gv1.DataKeys[e.RowIndex].Value;
        /// my delete logic
        CTX.SubmitChanges();
    }
} 
```

您对删除操作的控制应类似于：

```
<asp:LinkButton ID="lbDel" runat="server" Text="Delete" CommandName="Delete" /> 
```

# c# - SQLDataSource 插入方法在 CodeBehind .NET C# 中不起作用

> ID：13299282
> 
> 赞同：1
> 
> 时间：2012-11-08T22:49:59.337
> 
> 标签：c#, .net, insert, sqldatasource

我正在为学位模块编写一个 ASP Web 项目，我必须在登录表中插入一些登录详细信息。当我将它作为 .aspx 文件中的脚本运行时，它运行良好，但我需要对密码进行哈希处理，因此，不知道在代码隐藏文件之外执行此操作的方法，我移动了 SQLDataSource。这是插入，它不起作用。

```
SqlDataSource sqldsInsertPassword = new SqlDataSource();
sqldsInsertPassword.ConnectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
sqldsInsertPassword.ProviderName = ConfigurationManager.ConnectionStrings["ConnectionString"].ProviderName;
sqldsInsertPassword.InsertCommand = "INSERT INTO login (Password, Email) VALUES (@Password, @Email)";
sqldsInsertPassword.InsertCommandType = SqlDataSourceCommandType.Text;
sqldsInsertPassword.InsertParameters.Add("@Email", txtEmail.Text.ToString().ToLower());
sqldsInsertPassword.InsertParameters.Add("@Password", Convert.ToBase64String(getSHA256(txtPassword.Text.ToString())));
sqldsInsertPassword.Insert(); 
```

我看不出有什么问题，但也许你可以从班上的其他人身上看出。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.SqlClient;
using System.Data.Sql;
using System.Web.Security;
using System.Configuration;
using System.Security.Cryptography;
using System.Text;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }

public static byte[] getSHA256(string password)
{
    SHA256CryptoServiceProvider sha = new SHA256CryptoServiceProvider();
    return sha.ComputeHash(System.Text.Encoding.ASCII.GetBytes(password));
}

protected void btnRegister_Click(object sender, EventArgs e)
{//check email, insert user, SQL command get user ID, insert password

    SqlDataReader drExistingUsers = (SqlDataReader)sqldsCheckEmail.Select(DataSourceSelectArguments.Empty);
    drExistingUsers.Read();
    if (drExistingUsers.HasRows == false)
    {
        drExistingUsers.Close();
        bool fault = false;

        try
        {
            sqldsInsertUser.Insert();
        }
        catch (Exception error)
        {
            fault = true;
            lblError.Text = "Error: " + error;
        }

        if (fault == false)
        {
            try
            {
                SqlDataSource sqldsInsertPassword = new SqlDataSource();
                sqldsInsertPassword.ConnectionString = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
                sqldsInsertPassword.ProviderName = ConfigurationManager.ConnectionStrings["ConnectionString"].ProviderName;
                sqldsInsertPassword.InsertCommand = "INSERT INTO login (Password, Email) VALUES (@Password, @Email)";
                sqldsInsertPassword.InsertCommandType = SqlDataSourceCommandType.Text;
                sqldsInsertPassword.InsertParameters.Add("@Email", txtEmail.Text.ToString().ToLower());
                sqldsInsertPassword.InsertParameters.Add("@Password", Convert.ToBase64String(getSHA256(txtPassword.Text.ToString())));
                sqldsInsertPassword.Insert();
            }
            catch (Exception insertError)
            {
                fault = true;                    
                lblError.Text = "Error: " + insertError;
            }

            if (fault == false)
                Response.Redirect("Login.aspx");
        }
    }

    else
        lblError.Text = "Email already exists.";
} 
```

我很感激那里有很多我可能不需要的命名空间，但我稍后会整理它们。

感谢回复的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:47:22.273

好的，我修复了它，那里的插入参数的格式存在某种问题。基本上，我在 .aspx 文件中重新格式化了我的 SQLDataSource，看起来像这样，

```
<asp:SqlDataSource ID="sqldsInsertPassword" runat="server" 
ConnectionString="<%$ ConnectionStrings:ConnectionString %>" 
DeleteCommand="DELETE FROM [login] WHERE [UserID] = @UserID" 
InsertCommand="INSERT INTO [login] ([Password], [Email]) VALUES (@Password, @Email)" 
SelectCommand="SELECT [UserID], [Password], [Email] FROM [login]" 
UpdateCommand="UPDATE [login] SET [Password] = @Password, [Email] = @Email WHERE [UserID] = @UserID">
<DeleteParameters>
    <asp:Parameter Name="UserID" Type="Int64" />
</DeleteParameters>
<InsertParameters>
    <asp:Parameter Name="Password" Type="String" />
    <asp:Parameter Name="Email" Type="String" />
</InsertParameters>
<UpdateParameters>
    <asp:Parameter Name="Password" Type="String" />
    <asp:Parameter Name="Email" Type="String" />
    <asp:Parameter Name="UserID" Type="Int64" />
</UpdateParameters> 
```

之后，我把后面代码里的代码改成了这个；

```
try
{
    sqldsInsertPassword.InsertParameters["Email"].DefaultValue = txtEmail.Text.ToString().ToLower();
    sqldsInsertPassword.InsertParameters["Password"].DefaultValue = Convert.ToBase64String(getSHA256(txtPassword.Text.ToString()));
    sqldsInsertPassword.Insert();
} 
```

现在它可以工作了。我不知道插入参数的旧代码隐藏方法是否也能正常工作，但我不打算尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-04T20:28:39.267

删除@，它将起作用：

```
sqldsInsertPassword.InsertParameters.Add("Email", txtEmail.Text.ToString().ToLower()); 
```

# qt - Qt中的文件夹浏览器对话框

> ID：13299283
> 
> 赞同：14
> 
> 时间：2012-11-08T22:50:07.197
> 
> 标签：qt, folderbrowserdialog

有没有办法在 Qt 中打开文件夹浏览器对话框？当我使用`QFileDialog`文件`Directory`模式时，即使我指定了`ShowDirsOnly`选项，我也会得到标准文件对话框。我更喜欢使用一个对话框，要求用户从目录树中选择一个目录。

这是我正在使用的 PySide 代码：

```
from PySide import QtGui
app = QtGui.QApplication([])
dialog = QtGui.QFileDialog()
dialog.setFileMode(QtGui.QFileDialog.Directory)
dialog.setOption(QtGui.QFileDialog.ShowDirsOnly)
dialog.exec_() 
```

这是我在 Windows 7 上得到的结果： ![文件选择对话框](../Images/451ebd514198d5f26f5c6da1f7d56450.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T23:07:57.187

看来你打电话的顺序很`setFileMode()`重要`setOption()`。确保你`setFileMode()`先打电话：

```
QFileDialog dialog;
dialog.setFileMode(QFileDialog::Directory);
dialog.setOption(QFileDialog::ShowDirsOnly);
... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-09T09:16:50.727

我知道，我的答案有些棘手，看起来像小技巧，但是`QFileDialog`静态方法（例如`getExistingDirectory()`使用本机对话框），因此只能进行有限的自定义。

但是，如果您创建一个`QFileDialog`实例，您将获得一个可以自定义的对话框——只要您对实时对话框感到满意。

例如，这应该显示一个树形视图，其中包含您可以选择的可扩展目录（希望，将此代码移植到 PySide 一定不是问题）：

```
QFileDialog *fd = new QFileDialog;
QTreeView *tree = fd->findChild <QTreeView*>();
tree->setRootIsDecorated(true);
tree->setItemsExpandable(true);
fd->setFileMode(QFileDialog::Directory);
fd->setOption(QFileDialog::ShowDirsOnly);
fd->setViewMode(QFileDialog::Detail);
int result = fd->exec();
QString directory;
if (result)
{
    directory = fd->selectedFiles()[0];
    qDebug()<<directory;
} 
```

[从这里](http://www.riverbankcomputing.com/pipermail/pyqt/2009-July/023607.html)得到那个方法

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-29T09:19:17.513

试试这行代码，它会显示一个文件夹浏览对话框：

```
 ui->txtSaveAddress->setText(folderDlg.getExistingDirectory(0,"Caption",QString(),QFileDialog::ShowDirsOnly)); 
```

![在此处输入图像描述](../Images/941a65d221fe2d18337ec4b99972bef0.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-11-19T21:43:21.317

这对我有用：

```
def getDir(self):
    dialog = QtGui.QFileDialog()
    dialog.setFileMode(QtGui.QFileDialog.Directory)
    dialog.setOption(QtGui.QFileDialog.ShowDirsOnly)
    directory = dialog.getExistingDirectory(self, 'Choose Directory', os.path.curdir) 
```

# php - 使用复杂规则计算准时交货（不包括周末）

> ID：13299286
> 
> 赞同：1
> 
> 时间：2012-11-08T22:50:19.397
> 
> 标签：php, mysql, list, summary

我无法创建一个高效的 MySQL 查询，该查询根据特定规则计算准时交货。如果 PHP 解决方案更有效，我也愿意接受它。我还在学习，所以请放轻松。

这是我的工作表：

工作表：

```
+--------------+
|  Field       |
+--------------+
|  Job_ID      | 
|  Customer_ID |
|  Rep_ID      |<- Used for Filtering
|  Premium     |<- Tinyint(1) (0 by default, 1 if Premium)
|  Due_Date    |
|  Ship_Date   |
+--------------+ 
```

以下是计算准时交货的规则：

```
*Working Day = Weekdays (I would like to exclude holidays but for now, let's just go with all Weekdays)

Rule 1: (Simple) If a Job is of the Premium Type:
    Ship_Date before Due_Date = Early
    Ship_Date same as Due_Date = On Time
    Ship_Date after Due_Date = Late

Rule 2: (Complex) If a Job is of the Standard Type:
    Ship_Date before Due_Date minus 2 Working Days = Early
    Ship_Date within Due_Date minus 2 Working Days and Due_Date plus 1 Working Day = On Time
    Ship_Date after Due_Date plus 1 Working Day = Late

Example:
   Due_Date=Nov 9, 2012 and Premium=0
   if Ship_Date is Nov 1, 2012 then Status is Early by (4) Days
   if Ship_Date is Nov 6, 2012 then Status is Early by (1) Day
   if Ship_Date is Nov 7, 2012 then Status is On Time 
   if Ship_Date is Nov 12, 2012 then Status is On Time 
   if Ship_Date is Nov 13, 2012 then Status is Late by (1) Day
   if Ship_Date is Nov 20, 2012 then Status is Late by (6) Days 
```

所需的报告格式示例：我试图在标题处获取早期、准时和延迟作业的数量。订单以发货日期为准。

```
On Time Delivery Report    

October (Early: 1 / On Time: 2 / Late: 0) 
+------+-----------+---------+----------+-----------+-----------+------+--------+ 
| Job #| Cust Name | Premium | Due_Date | Ship_Date |Qty Shipped|Status|DaysDiff|
+------+-----------+---------+----------+-----------+-----------+------+--------+
 <List all jobs shipped in October> 

November (Early: 0 / On Time: 3 / Late: 0)
+------+-----------+---------+----------+-----------+-----------+------+--------+ 
| Job #| Cust Name | Premium | Due_Date | Ship_Date |Qty Shipped|Status|DaysDiff|
+------+-----------+---------+----------+-----------+-----------+------+--------+
 <List all jobs shipped in November> 
```

有人可以为我建议一个解决方案吗？如果是这样，我应该让 MySQL 或 PHP 完成大部分工作吗？我正在寻找一个优雅的解决方案，该解决方案还考虑到上面的规则 1 和 2。

我是否应该对表格进行非规范化并存储准时交货状态和日期差异以提高性能？我很抱歉发了这么长的帖子。我还在学习，我会很感激一些建议。

# javascript - Rails - Turbolinks - 回调

> ID：13299287
> 
> 赞同：2
> 
> 时间：2012-11-08T22:50:22.593
> 
> 标签：javascript, ruby-on-rails-3, function, callback, turbolinks

我想知道 turbolinks 是否有一个回调函数，当 turbolinks 完成渲染页面时，您可以使用它来调用函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T08:42:18.557

使用 page:change，查看更多事件的文档，[https://github.com/rails/turbolinks](https://github.com/rails/turbolinks)

# serial-port - MODBUS 自动地址分配

> ID：13299291
> 
> 赞同：3
> 
> 时间：2012-11-08T22:50:46.400
> 
> 标签：serial-port, communication, serial-communication, modbus

有谁知道可以自动设置MODBUS地址的方案？在我的情况下，我将启动许多从属设备，并且需要一些自动分配地址的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-09-11T14:22:10.240

我知道这是一篇旧帖子，但我只是遇到了这个，并认为我会给出答案，以防有人现在或将来尝试这样做。如果目标是将一个从 ID 分配给一个新的从设备（并且您正在为从设备开发固件），您可以将该 ID 存储在一个可以写入新 ID 的保持寄存器中。这确实需要：

1.  你已经知道这个ID了。也许所有新的奴隶都有一个默认 ID，比如 ID = 1，所以你事先知道 ID。
2.  您一次只能添加一个从属设备，并且必须在将另一个从属设备添加到网络之前更改 ID。例如：连接并打开第一个从设备，其默认 ID 为 1。发送一个写入命令，将 ID 更改为 2，并向主设备发送响应（在响应中使用从设备 ID 1，因此它不会'不超时）。现在从站 ID 为 2。接下来，将下一个从站添加到网络，其 ID 为 1。现在网络上有两个具有唯一 ID 的从站。只要重复你需要的次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-25T22:06:40.933

您是在谈论 SLAVE ID 吗？如果是这样，那将不会发生... SlaveID 对于客户端能够寻址串行网络上的所述从属至关重要。（RS485串行网络，大概……）。

因此，甚至无法发送 Modbus 消息并将其寻址到 SlaveID 1，然后以某种方式将该设备设为 SlaveID 1，因为在这种情况下，所有设备都会尝试响应。更不用说，在 Modbus 中没有任何方法可以为从站分配*ID* ……另一方面……

您是在谈论执行某种类型的查询以询问从设备它们拥有哪些 Modbus*寄存器*？同样，没有 Modbus 方法可以做到这一点，但是使用一些代码，您可以查询 40001，如果您收到错误 2，那么您知道该寄存器不可用。如果您然后遍历所有寄存器，跟踪哪些寄存器返回非错误，那么您可以执行一种“自动配置”形式，但是......老实说？我不建议这样做，而且我认为这样做没有多大价值，因为您不仅需要知道寄存器编号，**还必须知道** **寄存器中的数据实际上意味着什么！**

你到底想做什么？也许还有另一种方法可以实现这一目标？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-06-25T20:04:13.570

您认为您想要的：Modbus RTU 中的自动从站 ID 分配。

您真正想要的是：具有 Modbus TCP 的恒定、通用从站 ID。

简而言之，您所有的 Modbus Slave ID 都设置为一个固定的通用值，然后您将它们与支持链路本地寻址或 DHCP 之类的 TCP 堆栈桥接。然后可以动态处理 TCP 地址分配，同时为每个单元保留一个恒定的 SlaveID。

根据您已经拥有的硬件，这里有三种广泛的选择：

1.  有可以模拟 TCP over RTU 的商用现成设备（例如[this](https://ctlsys.com/support/modbus_tcp-rtu/)）。我没有深入研究他们支持的内容以及他们的工作情况。

2.  您还可以将大量 TCP 添加到 RTU 网桥，这些网桥将内置 TCP/IP 层管理，然后使用真正的以太网电缆。对于很多设备来说，这可能会很快变得昂贵，但是使用以太网，您可以获得各种奖励功能，例如基本上无限距离和改进的 CRC。如果您希望以便宜的方式执行此操作，请使用双端口 Linux SBC（例如[this](https://www.friendlyarm.com/index.php?route=product/product&product_id=248)或[this](https://wiki.radxa.com/RockpiE)）并将 mbusd （从[此处](https://github.com/3cky/mbusd)）扔到上面。

3.  如果您有权访问或正在自己开发固件，则可以调整 uIP（更简单）或 lwIP（更快）之类的东西来通过 RS-485 (UART) 进行通信。这肯定是最便宜的选择。请注意，您还应该能够检测 RS-485 上的冲突以正确实施 IP 堆栈——这涉及始终回显接收器并检查数据输入和数据输出是否匹配。

# matplotlib - 将集合添加到多个轴？

> ID：13299294
> 
> 赞同：2
> 
> 时间：2012-11-08T22:50:58.793
> 
> 标签：matplotlib

我正在尝试将 BrokenBarHCollection 添加到我的图上的多个轴，如下所示：

```
barcollection = collections.BrokenBarHCollection(...
ax1 = plt.subplot(211)
ax1.add_collection(barcollection)
ax2 = plt.subplot(212)
ax2.add_collection(barcollection)
plt.show() 
```

照原样，该图仅显示了第二个子图中的集合。如果我注释掉 ax2.add 行，它只会在第一个子图中显示集合。在第 3 行和第 4 行之间再次声明 barcollection 使其显示在两个子图中。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T02:21:33.357

这是因为`matplotlib`对象知道它们附加到什么地块，并且不会附加到多个地块。

如果您使用[复制模块](http://docs.python.org/2/library/copy.html)进行浅复制，那么您可以跨多个轴重用大部分数据结构。

```
import copy
bc2 = copy.copy(barcollection)
ax2.add_collection(bc2) 
```

最近还有一个关于这个的问题，但我很难找到它。

# jquery - 使用fancybox打开一个弹出的HTML页面

> ID：13299297
> 
> 赞同：7
> 
> 时间：2012-11-08T22:51:05.540
> 
> 标签：jquery, fancybox

我刚刚开始使用 Fancybox，并且可以从缩略图中打开更大的图像。

现在我想做的是从父窗口中的链接打开一个弹出窗口页面（HTML页面），以便弹出窗口（子窗口）获得焦点，并且后面的父页面变灰直到孩子再次关闭。

这可能很简单，就像我一样......希望有人能帮忙吗？

干杯。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T23:43:54.943

如果我理解正确，Fancybox 的网站上有一个例子：[http ://fancyapps.com/fancybox/#examples](http://fancyapps.com/fancybox/#examples)

查看 iframe 示例。基本上把你的`<a>`标签的href设置成你想要的页面，在Fancybox JS中，设置`type: 'iframe'`（不一定需要，但是如果Fancybox不能正确识别类型，你可以这样手动设置）。

另一个例子：http: [//jsfiddle.net/VWsRP/1/](http://jsfiddle.net/VWsRP/1/)

# vim - Vim：在小于一行的范围内替换

> ID：13299298
> 
> 赞同：6
> 
> 时间：2012-11-08T22:51:06.950
> 
> 标签：vim, replace, substitution

假设我有以下代码行：

```
something:somethingElse:anotherThing:woahYetAnotherThing 
```

我想用除了第一个之外的每个替换`:`，`;` *这样*该行看起来像这样：

```
something:somethingElse;anotherThing;woahYetAnotherThing 
```

有没有办法在不使用确认每个替换操作`:[range]s/[search]/[replace]/[options]`的选项的情况下使用命令执行此操作？`c`

据我所知，`s`作用的最小范围是单行。如果这是真的，那么完成上述任务的最快方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T23:50:12.553

我对自己很陌生；我认为您对范围仅是行（不是 100% 确定）是正确的，但是对于这个特定示例，您可以尝试用全局标志替换所有实例，然后通过省略全局标志来放回第一个实例——类似的东西`:s/:/;/g|s/;/:/`。

注意：如果该行在`;`第一行之前包含 a ，`:`那么这将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:55:27.577

以下是您如何使用单次击键来做您想做的事情（通过映射大写*Q*）：

`map Q :s/:/;/g\|:s/;/:<Enter>j`

每按一次`Q`当前行都会被修改，光标会移动到下一行。

换句话说，您可以连续点击`Q`多次来编辑每一行。

解释：

这将在当前行上全局运行：

`:s/:/;/g`

这会将第一个分号切换回冒号：

`:s/;/:`

@AlliedEnvy 的答案将这些组合成一个声明。

我的 map 命令将@AlliedEnvy 的答案分配给大写的 Q 字符。

* * *

另一种方法（如果我只需要这样做一次，我可能会这样做）：

`f``:``;``r``;``;``.`

然后您可以反复按`;``.`直到到达行尾。

（您选择替换分号使这有点令人困惑）

解释：

*   `f``:`- 转到第一个冒号
*   `;`- 转到下一个冒号（重复在线搜索）
*   `r``;`- 用分号替换当前字符
*   `;`- 重复最后一次内联搜索（再次）
*   `.`- 重复上一条命令（用分号替换当前字符）

长话短说：

*   `f``x``x`- 移动到当前行的下一个出现
*   `;`重复最后的内联搜索

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-09T00:05:43.977

干得好...

```
:%s/\(:.*\):/\1;/|&|&|&|& 
```

这是一个简单的正则表达式替代品，可以处理一个*not-the-first* `:`。

该`&`命令重复上一次替换。

该`|`语法将多个命令分隔在一行上。因此，每个替代品都会重复多少次`|&`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-09T07:29:40.303

虽然其他答案适用于这种特殊情况，但这里有一个更通用的解决方案：

创建从第二个元素开始到行尾的视觉选择。然后，通过包括以下内容将替换限制在可视区域`\%V`：

```
:'<,'>s/\%V:/;/g 
```

或者，您可以使用[vis.vim 插件](http://www.vim.org/scripts/script.php?script_id=1195)

```
:'<,'>B s/:/;/g 
```

# c++ - c++ 类之间的共享变量

> ID：13299299
> 
> 赞同：1
> 
> 时间：2012-11-08T22:51:09.760
> 
> 标签：c++, inheritance, static-members

我有多个类需要共享另一个类的单个实例。公开地，应该不知道这个类的存在。执行以下操作是否合适？（书面测试）

```
#include <iostream>

class hideme
{
    private:
        int a;

    public:
        void set(int b) { a = b; }
        void add(int b) { a += b; }
        int get() { return a; }

        hideme() : a(0) { }
};

class HiddenWrapper
{
    protected:
        static hideme A;

};

hideme HiddenWrapper::A;

class addOne : public HiddenWrapper
{
    public:
        void add() { A.add(1); }
        int get() { return A.get(); }
};

class addTwo : public HiddenWrapper
{
    public:
        void add() { A.add(2); }
        int get() { return A.get(); }
};

int main()
{
    addOne a;
    addTwo b;

    std::cout << "Initialized: " << a.get() << std::endl;

    a.add();
    std::cout << "Added one: " << a.get() << std::endl;

    b.add();
    std::cout << "Added two: " << b.get() << std::endl;

    return 0;
} 
```

值得一提的是，它`hideme`是我正在尝试围绕其设计外观的库的一部分，并且其他类具有库中与 static 交互的成员`hideme`。

另外，如果编写的头文件`HiddenWrapper`没有相应的源文件，那是定义其静态成员的最佳位置吗？带有一个包含警卫。

有没有其他方法可以解决这个问题？据我所知（不是很远），我只能通过友谊来解决它，我对此很警惕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:31:54.820

您可以通过不在使用它的翻译单元之外访问某个类来阻止对它的访问。

```
// public_header.h

class A {
    void bar();
};
class B {
    void foo();
}

// private_implementation.cpp
#include "public_header.h"

namespace {
  class hidden { void baz() {} };

  hidden h;
}

void A::bar() {
    h.baz();
}
void B::foo() {
    h.baz();
} 
```

这个类只能被 A::bar 和 B::foo 使用。类型`hidden`和变量`h`在技术上仍然具有外部链接，但没有其他翻译单元可以说出它们的名字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T22:57:08.457

有时通过构造函数（也称为组合而不是继承）注入共享资源（通过引用或指针）是一个更好的主意。这种方式使您能够共享或不共享（例如，拥有不是代码的线程安全变体）。有关详细信息，请参阅[http://de.wikipedia.org/wiki/Inversion_of_Control](http://de.wikipedia.org/wiki/Inversion_of_Control)原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:01:28.740

这实现了一个围绕其他类的单例并将其对用户隐藏：

```
class hideme {};

// fwd declarations
class x;

// library internal
class S
{
  S() = delete;
  S(S const&) = delete;
  void operator=(S const&) = delete;
private:
  static hideme& getInstance()
  {
    static hideme instance;
    return instance;
  }

  friend x;
};

// library classes
class x {
  hideme& s;
public:
  x() : s(S::getInstance()) {}
};

int main()
{
  x x;
  return 0;
} 
```

这不处理您实际上希望`hideme` 实例在没有其他对象不再使用它时被销毁的情况。为此，您需要使用引用计数获得更多创造性。

我还应该说，我认为这是一个坏主意。单身人士几乎总是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-05T18:18:22.480

通常，最好的方法是，如果您在主要部分中有一个变量，并且希望与所有类共享它。
例如，如果类 X 对此 var 进行了更改，则更改也发生在 main 中的 var 上：您可以使用**EXTEND**
********************* *** 主要的 *********************

```
#include <iostream>
using namespace std;

#include "Game.hpp"
//0: not specified yet; 1:singlemode; 2:multiplayerMode
int playingMode = 0;

int main()
{
    Game game;
    game.Run();
    std::cout<< playingMode << std::endl; 
    return 0;
} 
```

*********************** X 级 *****************

```
#include <iostream>
using namespace std;

extern int playingMode;

....
....

if(m_isSinglePressed)
    {
        playingMode = 1;
        ...

    }
    else if(m_isMultiPressed)
    {
        playingMode = 2;
        ...
    } 
```

# string - 如何使测试条件在 TCL 中工作

> ID：13299300
> 
> 赞同：1
> 
> 时间：2012-11-08T22:51:17.510
> 
> 标签：string, tcl

```
% set HI 1
1
% if { [ info exists HI] && { $HI == 1 } } { puts "Hello World "}
can't use non-numeric string as operand of "&&"
% 
```

任何一个条件都可以单独测试。如何使测试的 && 在 TCL 中工作？

仅此一项有效

```
% if  { $HI == 1 }  { puts "Hello World "}
Hello World 
```

这也单独起作用。

```
% if { [ info exists HI]  } { puts "Hello World "}
Hello World 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T08:51:09.567

测试的第二部分，即

```
{ $HI == 1 } 
```

是错误的，因为我想您对 Tcl 中大括号的含义感到困惑。大括号与 不同，它们*不能*`( ... )`在数学表达式中用于更改评估中使用的优先级。

大括号用于组成包含空格的字符串，并使其显示为 Tcl 命令的单个参数，但*不会*在其中执行替换。

在您的情况下，`$HI`不会用`HI`变量的值替换，因此您正在形成一个字符串，其中包含您在大括号内看到的所有确切字符，包括前导和尾随空格。

如果你这样做

```
if {{ $HI == 1 } eq {$HI == 1}} {
    puts "same"
} else {
    puts "not the same"
} 
```

你会得到`not the same`结果。（`eq`在表达式中执行字符串比较。）

如果您使用双引号字符作为字符串分隔符，您也不会得到正确的含义，即

```
" $HI == 1 " 
```

在这种情况下，您的变量实际上被其值替换，因此就像您直接编写的一样（假设`$HI`is `1`，如您的代码中所示）：

```
" 1 == 1 " 
```

但它又是*字符串*。

为什么 Tcl 抱怨？正如它所说，您正在尝试使用*非数字字符串*作为 的操作数`&&`，并且`{ $HI == 1 }`不是*数字*，因为无法将其视为数字，因此 Tcl 无法根据数字转换为真/假值（如果为 0，则为 false，如果不为 0，则为 true)，并且发生错误。

我想你真正想写的是

```
if { [ info exists HI] && ( $HI == 1 ) } { puts "Hello World "}
#                         ^          ^
#                         |__________|____ note ( ) instead of { } 
```

给予`==`相对于更高的优先级`&&`，或使条件更清晰。`expr`，它在 an 的测试条件中被隐式调用，它`if`知道*圆括号*的含义与您在其他编程语言和数学中找到的含义相同：更改评估顺序。

正如在其他答案和评论中所指出的那样，你真的不需要括号，因为（在 C 和许多其他语言中）等于运算符`==`的优先级高于布尔值 and `&&`。但如果你愿意，你可以放心使用`( ... )`：

```
if {2 - 1 * 2} { puts yes } { puts no } 
```

给出`no`，因为表达式的计算`2 - (1 * 2)`结果为 0。

```
if {(2 - 1) * 2} { puts yes } { puts no } 
```

给出，`yes`因为`(2 - 1) * 2`是 2。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T23:05:28.930

你不需要额外的花括号；这应该可以正常工作：

```
if { [info exists HI] && $HI == 1 } { puts "Hello World" } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:05:51.990

尝试`[expr $HI == 1]`代替`{ $HI == 1 }`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-09T09:29:34.330

在 Tcl 表达式中，`{`…<code>} 包含一个未替换的文字。（或者如果之前有一个变量名`$`。）当你有一个表达式时，这表明你应该执行以下任一操作：

*   `{`将...<code>}更改为`(`...<code>); 括号在表达式中具有其正常的数学解释。
*   `{`将...<code>}更改为... `[expr {`<code>}] 以便表达式真正被解释为这样。

这两种情况的字节码几乎是相同的，所以在性能方面它是一个洗牌。你应该写哪个对你来说更清楚。（我自己，我几乎从不使用第二种形式，`[expr]`在我想要一个*非常量*表达式片段的情况下在表达式上下文中保留嵌套。这实际上非常罕见。）

# ruby-on-rails - rails 接受多态关联的嵌套属性

> ID：13299302
> 
> 赞同：2
> 
> 时间：2012-11-08T22:51:28.207
> 
> 标签：ruby-on-rails, file-upload, nested-forms, polymorphic-associations

我有一个错误“无法批量分配受保护的属性：上传”，但我已将其分配为可访问。

这是具有多态关联的嵌套形式。

楷模

```
class Upload < ActiveRecord::Base
  attr_accessible :link, :post_id
  belongs_to :uploadable, polymorphic: true
end

class Post < ActiveRecord::Base
  attr_accessible :description, :title, :uploads_attributes
  has_many :uploads, as: :uploadable
  accepts_nested_attributes_for :uploads, :reject_if => lambda { |a| a[:content].blank? 
  }, :allow_destroy => true
end 
```

我也试过 put accept_nested ... for :uploadable 但告诉我不存在关联

控制器上的新动作是这个

```
def new
  @post = Post.new
  @post.uploads.new
end 
```

这是创建的表格

```
<%= form_for [:admin,@post], remote: true, :html => {:multipart => true}  do |f| %>
  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title%>
  </div>
  <div class="field">
    <%= f.label :description%><br />
    <%= f.text_area :description %>
  </div>
  <div>
    <%= f.fields_for :upload do |builder| %>
      <%= render 'upload_fields', f: builder %>
    <% end %>
    <%= link_to_add_fields "Add Upload", f, :uploads %>  
  </div>
  <div class="actions">
    <%= f.submit%>
  </div>
<% end %> 
```

部分...

```
<fieldset>
  <%= f.label :file %><br />
  <%= f.file_field :file %>
  <%= f.hidden_field :_destroy %>
  <%= link_to "remove", '#', class: "remove_fields" %>
</fieldset> 
```

不要认为 javascript 会影响，所以我不会把它放在这里。我如何解决多态关联上的“无法批量分配受保护的属性”？

请在这方面需要任何人的帮助。不敢相信我不能上传文件，在教程上看起来很简单，而且它不起作用，或者我得到一个不能批量分配或上传它没有保存....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T19:15:44.417

尝试使用`@post.uploads.build`而不是`@post.uploads.new`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T14:59:42.643

关联模型需要知道她父母的身份才能保存关系。我向您推荐以下 railscast：[多态关联。](http://railscasts.com/episodes/154-polymorphic-association)

```
#uploads_controller.rb
before_filter :load_uploadable

def create
  @upload = @uploadable.uploads.new(params[:upload])
....
end

private

def load_uploadable
  resource, id = request.path.split('/')[1, 2] # /posts/1
  @uploadable = resource.singularize.classify.constantize.find(id)
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-08T22:55:52.537

您视图中的这一行：

```
<%= f.fields_for :upload do |builder| %> 
```

应该是这样的：

```
<%= f.fields_for :uploadable do |builder| %> 
```

因为`Post`模型上的关联被称为“可上传”，而不是“上传”。

要使嵌套属性起作用，您需要指定模型确实接受此模型的嵌套属性，这可以通过将此行放在`belongs_to`模型中的下方来完成：

```
accepts_nested_attributes_for :uploadable 
```

然后您需要使这些属性可访问，您可以这样做：

```
attr_accessible :uploadable_attributes 
```

# django - Django syncdb，错误：一个或多个模型未验证

> ID：13299303
> 
> 赞同：0
> 
> 时间：2012-11-08T22:51:30.723
> 
> 标签：django, django-south

好问候 Django 的。

我是新手，在尝试确保数据库同步时，我得到了`Error: One or more models did not validate`.

有什么想法可以解决吗？

```
./manage.py syncdb --settings=settings.jacob
Error: One or more models did not validate:
users.userprofile: "uuid": Primary key fields cannot have null=True.
places.category: "uuid": Primary key fields cannot have null=True.
places.image: "uuid": Primary key fields cannot have null=True.
places.masterplace: "uuid": Primary key fields cannot have null=True.
places.place: "uuid": Primary key fields cannot have null=True.

./manage.py schemamigration appname --auto --settings=settings.jacob
Error: One or more models did not validate:
users.userprofile: "uuid": Primary key fields cannot have null=True.
places.category: "uuid": Primary key fields cannot have null=True.
places.image: "uuid": Primary key fields cannot have null=True.
places.masterplace: "uuid": Primary key fields cannot have null=True.
places.place: "uuid": Primary key fields cannot have null=True. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:44:06.707

修复`django-uuidfield==0.4`在 requirements.txt

或[https://stackoverflow.com/a/13859974/194515](https://stackoverflow.com/a/13859974/194515)

# xcode - locationManager didFailWithError null phonegap 模拟器

> ID：13299315
> 
> 赞同：8
> 
> 时间：2012-11-08T22:52:44.650
> 
> 标签：xcode, cordova, geolocation, ios-simulator

我在模拟器上使用 IOS 进行定位服务时遇到以下问题：

将 phonegap 2.2.0 与 xcode 4.5.2 一起使用，

Cordova.plist EnableLocation = YES

```
navigator.geolocation.getCurrentPosition(myPositionSuccess, myPositionError, {maximumAge: 300000, timeout:10000, enableHighAccuracy : true}); 
```

从未调用 myPositionSuccess，在 navigator.geolocation 处出现以下错误

```
locationManager::didFailWithError (null) 
```

我刚刚在模拟器上试了一下。任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-22T07:43:27.163

退出模拟器并再次运行您的应用程序。为我工作。

我在 XCode 版本 4.3.2 和 cordova/phonegap 2.1.0 中遇到了同样的错误

即使我在 Safari 中运行 Google 地图，模拟器也无法获取我的位置。这使我得出结论，不仅仅是我的项目有问题。

我仍然无法弄清楚**为什么**重新启动模拟器会起作用，但有一个**可能的**原因。

*我通常在不退出大多数*正在运行的应用程序的情况下关闭我的 Mac，并选中“重新登录时重新打开窗口”选项。然而，模拟器是我绝对退出的应用程序之一。但是我上次关闭时，我并没有退出它。所以，就像我说的，*可能的*原因。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-12-31T20:51:32.940

另一件事可能是检查模拟器中的位置设置，我相信默认设置是无，这意味着地理位置将找不到任何东西。如果您正在运行模拟器，请转到“调试”>“位置”>“城市运行”或其他选择，然后尝试再次使用地理定位功能，它应该可以正常工作。

我知道这有点旧，但是当我记得位置设置时，我正在寻找答案，所以我想我会在这里发布以供将来参考，以防有人需要它。

# shell - IO 重定向 - 交换标准输出和标准错误

> ID：13299317
> 
> 赞同：40
> 
> 时间：2012-11-08T22:52:50.360
> 
> 标签：shell, sh, io-redirection

给定一个shell脚本：

```
#!/bin/sh

echo "I'm stdout";
echo "I'm stderr" >&2; 
```

当命令的最后一部分是 2>/dev/null 时，有没有办法调用该脚本，只有 stderr 会打印出来，即

```
$ > sh myscript.sh SOME_OPTIONS_HERE 2>/dev/null
I'm stderr 
```

或者，或者：

```
$ > sh myscript.sh SOME_OPTIONS_HERE >/dev/null
I'm stdout 
```

这是一组演讲幻灯片末尾的一个问题，但经过将近一天的工作，我几乎可以肯定这是某种错字。旋转不起作用。2>&- 不起作用。我没主意了！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-08T22:59:10.447

```
% (sh myscript.sh 3>&2 2>&1 1>&3) 2>/dev/null
I'm stderr
% (sh myscript.sh 3>&2 2>&1 1>&3) >/dev/null 
I'm stdout 
```

解释`3>&2 2>&1 1>&3`：

*   `3>&2`表示**复制**文件描述符 2 (fd 2) (stderr)，命名为 fd 3（文件描述符 3）。它**复制文件描述符**，它不复制流`tee`。
*   `2>&1`意味着 fd 2 of`sh myscript.sh`成为它的 fd 1 (stdout) 的副本。现在，当 myscript 写入它的 stderr（它是 fd 2）时，我们会在 stdout（我们的 fd 1）上接收它。
*   `1>&3`表示 fd 1 of`sh myscript.sh`成为 fd 3 (stderr) 的副本。现在，当 myscript 写入它的 stdout（它是 fd 1）时，我们会在 stderr（我们的 fd 2）上接收它。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-11-18T12:20:25.060

为了完整起见，根据上面@200_success 的评论，最好使用以下方法[移动](http://www.gnu.org/software/bash/manual/bash.html#Moving-File-Descriptors)文件描述符 3 `1>&3-`：

```
$ (sh myscript.sh 3>&2 2>&1 1>&3-) 2>/dev/null
I'm stderr
$ (sh myscript.sh 3>&2 2>&1 1>&3-) >/dev/null 
I'm stdout 
```

而不是在每个进程的基础上交换文件描述符，`exec`您可以使用 stdin 和 stderr 交换当前 shell 启动的所有以下命令：

```
$ (exec 3>&2 2>&1 1>&3- ; sh myscript.sh ; sh myscript.sh ) 2>/dev/null
I'm stderr
I'm stderr
$ (exec 3>&2 2>&1 1>&3- ; sh myscript.sh ; sh myscript.sh ) >/dev/null 
I'm stdout
I'm stdout 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-12-12T00:31:44.507

移动文件描述符 ( `1>&3-`) 是不可移植的，并非所有 POSIX shell 实现都支持它。它是 ksh93 主义和 bash 主义。（更多信息在这里[https://unix.stackexchange.com/questions/65000/practical-use-for-moving-file-descriptors](https://unix.stackexchange.com/questions/65000/practical-use-for-moving-file-descriptors)）

也可以在执行重定向后关闭 FD 3。

```
ls 3>&2 2>&1 1>&3 3>&- 
```

将当前工作目录的内容打印出 stderr。

语法`3>&-`或`3<&-`关闭文件描述符 3。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-03-21T08:50:02.120

[bash 黑客 wiki](http://wiki.bash-hackers.org/syntax/redirection)在这类事情上非常有用。有一种方法在这些答案中没有提到，所以我会投入两分钱。

的语义`>&N`，对于数字 N，意味着*重定向到文件描述符 N的**目标***。**目标**这个词很重要，因为描述符可以稍后更改目标，但是一旦我们复制了该目标，我们就不再关心了。这就是为什么我们声明重定向的顺序是相关的原因。

所以你可以这样做：

```
./myscript.sh 2>&1 >/dev/null 
```

这意味着：

1.  将 stderr 重定向到 stdout 的目标，即 stdout 输出流。现在 stderr 复制了 stdout 的目标

2.  将标准输出更改为 /dev/null。这不会影响 stderr，因为它在我们更改目标之前“复制”了它。

不需要第三个文件描述符。

有趣的是我不能简单地做`>&-`，而不是`>/dev/null`。这实际上关闭了标准输出，所以我收到了一个错误（在标准错误的目标上，当然是实际的标准输出：D）

```
line 3: echo: write error: Bad file descriptor 
```

通过尝试交换重定向，您可以看到该顺序是相关的：

```
./myscript.sh >/dev/null 2>&1 
```

这不起作用，因为：

1.  我们将 stdout 的目标设置为`/dev/null`
2.  我们将 stderr 的目标设置为 stdout 的目标，`/dev/null`又是这样。

# sql - 如何从查询中选择最后 x% 的行？

> ID：13299320
> 
> 赞同：3
> 
> 时间：2012-11-08T22:52:57.083
> 
> 标签：sql, sqlite

我想从查询中选择行的最后 1/x 部分，以某种方式排序。我怎样才能做到这一点？

我想出了类似的东西

```
SELECT avg(smilies_count)
FROM posts AS p
WHERE time >= (???) -- I only want the last 25% of posts in this thread
GROUP BY thread_id; -- each thread can have more than 1 post, but I still only
                    -- want to consider the last 25% of posts in my average 
```

但我不太确定要放入什么`???`不会导致非常粗糙的表情。

**编辑**

我试过把

```
SELECT min(p2.time)
FROM posts AS p2
WHERE p2.thread_id = p.thread_id
ORDER BY p2.time DESC
LIMIT count(*) / 4 
```

在`???`，但它只给了我

```
Error: misuse of aggregate function count() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:12:23.047

我假设您基本上想要每个线程的最后帖子的 25%，以后的操作取决于您。

如果我是对的，那么这段代码应该适合你（为 MS-SQL 编写，应该很容易移植到 SQLite）：

```
CREATE TABLE posts (
    post_id INT,
    thread_id INT
)

INSERT INTO posts(post_id, thread_id) VALUES (1, 1)
INSERT INTO posts(post_id, thread_id) VALUES (2, 2)
INSERT INTO posts(post_id, thread_id) VALUES (3, 2)
INSERT INTO posts(post_id, thread_id) VALUES (4, 3)
INSERT INTO posts(post_id, thread_id) VALUES (5, 3)
INSERT INTO posts(post_id, thread_id) VALUES (6, 3)
INSERT INTO posts(post_id, thread_id) VALUES (7, 3)
INSERT INTO posts(post_id, thread_id) VALUES (8, 3)
INSERT INTO posts(post_id, thread_id) VALUES (9, 3)
INSERT INTO posts(post_id, thread_id) VALUES (10, 3)
INSERT INTO posts(post_id, thread_id) VALUES (11, 3)

SELECT src.*
FROM (
    SELECT post_number = (
        SELECT 1 + COUNT(*)
        FROM posts pp 
        WHERE p.post_id > pp.post_id 
        AND p.thread_id = pp.thread_id
    ), 
    post_id,
    thread_id
    FROM posts p
) src
JOIN (
    SELECT thread_id, cnt = COUNT(*)
    FROM posts
    GROUP BY thread_id
) counts
ON src.thread_id = counts.thread_id
WHERE (CONVERT(FLOAT, src.post_number) / CONVERT(FLOAT, counts.cnt)) >= 0.75 
```

请注意，它不是高性能查询，主要是由于子查询获取 post_number。对于支持它的 DBMS，它可以用 OVER 子句以更好的方式编写。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T23:11:55.890

如果您需要最后 25% 的帖子，这是一个版本：

```
select
  avg(1.0 * smilies_count) avg_count,
from (select top 25% * from posts order by time desc) last_posts 
```

这是每个线程最后 25% 的帖子的另一个：

```
select
  avg(1.0 * smilies_count) avg_smilies
from (
  select
    thread_id, post_id, smilies_count,
    row_number() over (partition by thread_id order_by time desc) row_num
  from posts
) p
join (select thread_id, count(*) cnt from posts group by thread_id) c on
  p.thread_id = c.thread_id
where
  p.row_num < 0.25 * c.cnt
group by
  p.thread_id 
```

# javascript - 正刮

> ID：13299323
> 
> 赞同：2
> 
> 时间：2012-11-08T22:53:12.080
> 
> 标签：javascript, facebook, google-chrome, google-chrome-extension, scrape

背景：我是 facebook 上一个音乐分享（盗版 gs/yt 的链接）组的一员。每天最多有 20 名成员发布他们认为社区会喜欢的歌曲的链接，因此我们越来越喜欢这种类型的音乐。在月底，我们想创建一个列表，列出我们每个月发布的所有歌曲的所有标题。

问题：Facebook 不提供此功能，它仅提供非常轻量级的搜索功能（无子过滤器），甚至该搜索也仅返回在帖子中找到的字符串的结果。所以，例如。搜索：“BB King”将返回包含该字符串的帖子，更糟糕的是，如果该帖子是该歌曲的，但在帖子中，用户没有评论“BBKing”，结果将不会返回该链接。Fb 也不允许标记帖子。

乱七八糟：通过使用一个名为 Stylish 的 Chrome 插件，我可以（有时）在 facebook 页面上隐藏某个类的大多数元素（又名自定义用户代理样式）并直观地收集我需要的东西。不幸的是，这不适用于我的示例。

我确实缩小了 div 类的名称，其中的 innerHTML 包含我需要的曲目和艺术家信息。

目标：我想创建一个 Chrome 插件，该插件将抓取该 div 的所有实例（具有此类名称）的页面，然后将其 innerHTML 内容存储在一个数组中，以便以后导出。这样做可以让我创建一整月的列表并将其作为文件发布在 Facebook 群组的“文件”选项卡中。

指出我正确的方向，我会开始修修补补！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:44:00.530

你甚至不需要求助于刮！Graph API 可提供帮助：

[https://developers.facebook.com/docs/reference/api/group/](https://developers.facebook.com/docs/reference/api/group/)

因此，假设您还没有 Facebook 应用程序，您可以通过以下方式查看可以获得的内容：

[https://developers.facebook.com/tools/explorer/?method=GET&path=me/groups](https://developers.facebook.com/tools/explorer/?method=GET&path=me/groups)

这是 Graph Explorer，一个简单的工具，它向您显示通过 Graph API 可用的数据，您需要单击 Get Access Token 并选中该`user_groups`框，然后接受 Permissions 对话框。

这将返回一个 JSON 对象，其中包含您所属的所有组。抓住`id`你试图获取所有这些链接的那个，然后转到它的 Graph API 提要节点：

[https://graph.facebook.com/114817635246802/feed](https://graph.facebook.com/114817635246802/feed)

您需要在此处使用访问令牌。您可以从 Graph Explorer 复制并粘贴一个。这将返回一个 JSON 对象，其中包含组中的最新帖子以及[分页](https://developers.facebook.com/docs/reference/api/pagination/)链接。使用这些，您可以检索 JSON 格式的完整列表，其中包含指向您的音乐的所有链接。

现在，您将要学习的内容： - 如何创建 Facebook 应用程序 - 如何生成您自己的访问令牌 - 如何以编程方式发出 API 请求

阅读[本教程](https://developers.facebook.com/docs/howtos/login/getting-started/)，如果您对 Javascript 和 HTML 有一点点熟悉，大约 10 分钟就可以掌握。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:36:51.450

您不需要构建 chrome 扩展，放置在书签中的一个小的 javascript 片段就可以完成这项工作：

```
javascript:var all_the_divs_content = '';
    var divs = document.getElementsByClassName('test'); 
    for( var i = 0 ; i < divs.length ; i++ ){
     all_the_divs_content += divs[i].innerHTML + '<br/> ---- <br/>';    
    }
    all_the_divs_content_window = window.open('about:blank','');
all_the_divs_content_window.document.write( all_the_divs_content ); 
```

[http://jsfiddle.net/gael/J8R6k/](http://jsfiddle.net/gael/J8R6k/)

但我认为facebook api应该更强大。

# php - 如何在 PHP 中将以下参数分解为数组？

> ID：13299329
> 
> 赞同：-1
> 
> 时间：2012-11-08T22:53:29.887
> 
> 标签：php, arrays

例如，我有以下参数：

```
max_image_width=100,max_image_height=200,image_proportion=1.75 
```

我想得到一个数组：

```
array('max_image_width'=>100,'max_image_height'=>200,'image_proportion'=175); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T22:59:18.683

```
$str = 'max_image_width=100,max_image_height=200,image_proportion=1.75';
$cfg = parse_ini_string(
    str_replace(',', "\n", $str)
);

print_r($cfg); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:00:56.590

5.4

```
$a=[];foreach(explode(',',$i)as$b){$a[explode('=',$b)[0]]=explode('=',$b)[1];} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T23:02:24.937

```
$output = array();
parse_str(str_replace(',', '&', 'max_image_width=100,max_image_height=200,image_proportion=1.75'), $output); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T22:57:51.777

E.g. by using [preg_match_all](http://docs.php.net/preg_match_all).

```
<?php
$t = 'max_image_width=100,max_image_height=200,image_proportion=1.75';

preg_match_all('!([^=]+)=([^,]+)!', $t, $m);
$x = array_combine($m[1], $m[2]);

var_export($x); 
```

prints

```
array (
  'max_image_width' => '100',
  ',max_image_height' => '200',
  ',image_proportion' => '1.75',
) 
```

( though there are tons of other ways to do it without regular expressions ;-) )

# c++ - 作业：带向量的 C++ 模板

> ID：13299330
> 
> 赞同：0
> 
> 时间：2012-11-08T22:53:30.920
> 
> 标签：c++, templates, vector

我必须创建一个接收未知项目类型向量的函数。这是我的代码：

```
template <typename S>
void printVector(vector<S*> c){
   typename vector<S>::const_iterator A = c.begin();
   for (int A; A != c.end(); A++){
       cout<<c[A]<<" ";
   }
   cout<<endl;
} 
```

在我的主要课程中，这里是我的向量和函数调用：

```
vector<int> x;
int j=5;
for(int i=0;i<j;i++){
    x.push_back(num[i]);
}
printVector(x); 
```

当我尝试编译此代码时，出现以下错误：

> 练习1_1.cpp：在函数“int main()”中：
> 练习1_1.cpp:33:15：错误：没有匹配函数调用“<code>printVector(std::vector<int>&)”<br>练习1_1。 cpp:33:15: 注意：候选人是：
> exercise1_1.cpp:13:7: 注意：`template<class S> void printVector(std::vector<S*>)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:12:02.253

您的代码中有一些错误。让我们看看它们：

*   在 的签名中`printVector`，您采用类型的参数`vector<S*>`。这意味着，对于给定的 type `S`，您需要一个指向 的指针向量`S`。因此，例如，如果类型是`int`，您应该“发送” a `vector<int*>`。在您的示例中，您正在尝试“发送” a `vector<int>`，因此 of 的签名`printVector`应如下所示：

    ```
    template <typename S>
    void printVector(vector<S> c) 
    ```

*   `A`在您的 for 循环中，您再次将变量声明为`int`. 在 C++ 标准库中，您可以使用迭代器访问向量中的每个项目，也可以像访问数组一样访问它们。你混合了这两种东西。

如果你想使用迭代器循环，它应该是这样的：

```
typename vector<S>::const_iterator a = c.begin();
for (; a != c.end(); a++){
    cout<<*a<<" ";
} 
```

这意味着，对于向量中的每个项目，打印它的值（注意我使用的`*a`是因为我使用的是迭代器）。

或者使用基于索引的方法：

```
for (int i = 0; i < c.size(); i++){
   cout<<c[i]<<" ";
} 
```

此外，作为 C++ 社区的常见做法，在接收非原始类型的变量时使用 const 引用。这可以防止执行对象的副本，因此在处理大量集合时可能会更快。例子：

```
 void printVector(const vector<S>& c) 
```

所以这是一个完整的工作示例：

```
#include <vector>
#include <iostream>

using namespace std;

template <typename S>
void printVector(const vector<S>& c){
   for (int i = 0; i < c.size(); i++){
       cout<<c[i]<<" ";
   }
   cout<<endl;
}

int main(int argc, char** args) {
    vector<int> x;
    int j=5;
    for(int i=0;i<j;i++){
        x.push_back(i);
    }
    printVector<int>(x); // Can be printVector(x); too
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:02:44.607

```
template <typename S>
void  printVector(const std::vector<S>& c){
   typename std::vector<S>::const_iterator A = c.begin();
   for (; A != c.end(); A++){
       std::cout<<*A<<" ";
   }
   std::cout<<"\n";
} 
```

修复：

*   您的函数被声明为采用 a`vector<S*>`但您显然希望它采用`vector<S>`。
    *   您的 main 函数调用 print_vector 的参数`std::vector<int>`。由于 an`int`不是`S*`任何类型的`S`，因此该模板不适用。
*   `A`当您打算仅使用第一个声明时，您已重新声明。
*   您将向量的索引访问与通过迭代器的访问混为一谈。
    *   如果你有一个int：`c[i]`
    *   如果你有一个迭代器：`*it`

不太重要的修复：

*   避免`using namespace std;`
*   `std::endl`当你的意思是永远不要使用`"\n"`。
*   您应该通过 const 引用而不是值来传递参数

# c++ - C++ 有人能解释一下这些 for 循环在说什么吗？

> ID：13299337
> 
> 赞同：0
> 
> 时间：2012-11-08T22:54:13.987
> 
> 标签：c++, for-loop, conditional-operator

所以这段代码是我从网上复制过来的一个boggle游戏的基本大纲。来源： http: [//www.codingfriends.com/index.php/2010/06/10/boggle/](http://www.codingfriends.com/index.php/2010/06/10/boggle/)

```
bool findUsersWord(string findThis, Grid<char> &theBoard, Vector<cell> &theRoute, string alreadyFound, int placeY, int placeX)
{  
  // need to find the findThis  base case
  if (findThis == alreadyFound)
    return true;
  // need to find the first letter within the board and then progress around that.
  if (alreadyFound.empty())
  {
    for (int rows = 0; rows < theBoard.numRows(); rows++)
      for (int cols = 0; cols < theBoard.numCols(); cols++)
        // find the each character within the 
        if (theBoard[rows][cols] == findThis[0])
        {
          alreadyFound = findThis[0];
          cell newR;
          newR.row = rows;
          newR.col = cols;
          theRoute.add(newR);
          if (findUsersWord(findThis, theBoard, theRoute, alreadyFound, rows, cols))
            return true;
          else
            // clear out the found Board 
            theRoute.clear();
        }
  }
  else
  {
    // try and find the next letters within the area around the base letter
    // spin around the letter 3 * 3 grid
    for (int y= (placeY > 0 ? placeY-1: placeY); y <=(placeY == (theBoard.numRows()-1) ? placeY : placeY+1);y++)
      for (int x=(placeX > 0 ? placeX-1: placeX); x<=(placeX == (theBoard.numCols()-1) ? placeX : placeX+1); x++)
        if ((theBoard[y][x] == findThis[alreadyFound.length()]) && (!(y==placeY && x ==placeX)))
          // already used letter
          if (!placeAlreadyUsed(y,x,theRoute))
          {
            alreadyFound += findThis[alreadyFound.length()];
            cell newR;
            newR.row = y;
            newR.col = x;
            theRoute.add(newR);
            if (findUsersWord(findThis, theBoard,theRoute, alreadyFound, y, x))
              return true;
            else
            {
              if (alreadyFound.length() > 1)
                alreadyFound = alreadyFound.substr(0, alreadyFound.length()-1);
              theRoute.removeAt(theRoute.size()-1);
            }
          }
    return false;
  }
  return false;
} 
```

下面的代码是有问题的代码，它是上面代码的一部分。

```
for (int y= (placeY > 0 ? placeY-1: placeY); y <=(placeY == (theBoard.numRows()-1) ? placeY : placeY+1);y++)
  for (int x=(placeX > 0 ? placeX-1: placeX); x<=(placeX == (theBoard.numCols()-1) ? placeX : placeX+1) 
```

我想知道是否有人可以将此代码转换为不涉及使用的更简单的代码？然后。我确实知道它的简单部分，例如“？” 表示返回，“：”表示下一行，但我迷失在它被用于 for 循环以及它看起来像

```
if(placeY > 0)
 return playceY-1
placeY; 
```

我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:00:36.823

The `? :` block is just a strange looking if statement. It's an *inline* if, if you will.

Here's the format

```
argument ? result evaluated to if true : result evaluated to if false 
```

Here's an example

```
1<2 ? "Hurray" : "boo" 
```

Will evaluate to `"Hurray"` because 1<2 is true. However, if we switch it to `1>2` it will evaluate to `"boo"`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:01:45.513

> 我确实知道它的简单部分，例如“？” 表示返回，“:”表示下一行

不。这根本不是它的意思。`?:`是一个具有三个操作数表达式的运算符，其中一个出现在`?`和之间`:`。

```
placeY > 0 ? placeY-1 : placeY 
```

是一个表达式，意思是：“如果`placeY > 0`然后评估`placeY-1`；否则评估`placeY`”。

代码的想法是，出于某种原因，我们希望遍历 (placeX,placeY) 旁边的所有棋盘位置。这些位置形成一个矩形，`?:`运算符用于计算该矩形的左、右、上和下限。例如，上面引用的表达式用于顶部坐标。通常是`placeY-1`，除非如果`placeY`已经是 0，则它上面的板上没有行，在这种情况下，`placeY`它本身就是顶行。

# sql - 转换 nvarchar 时转换失败

> ID：13299345
> 
> 赞同：1
> 
> 时间：2012-11-08T22:55:12.983
> 
> 标签：sql, vb.net

```
strSQL = "SELECT cdlAction, " & _
         "cdlSerial_Number, " & _
         "cdlRemedyProcess " & _
         "From tblCustodial " & _
         "WHERE cdlRemedyProcess IS NULL AND LEN(cdlAction)=7 AND cdlAction<>'Dispose' AND LEFT(cdlAction,2) BETWEEN 5 AND 35 " & _
         "ORDER BY cdlAction" 
```

调试时，我在此 sql 字符串中不断收到“转换 nvarchar 时转换失败”。我没有看到我在这里做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:57:27.100

我认为将 left(cdlAction,2) 转换为 int 可能会做到这一点。他无法将字符串与它自己的 int 进行比较。所以 cast(cdlAction AS INT) 可能会起作用。

# youtube - 智能电视或 TiVo 上的 YouTube 观看次数是否会被记录为特定类型的推荐？

> ID：13299349
> 
> 赞同：2
> 
> 时间：2012-11-08T22:55:20.183
> 
> 标签：youtube, youtube-api, referrals, tivo

我想查看来自智能电视或 TiVo 的所有视图。有谁知道他们是否有使用他们的视图登录的特定推荐代码？例如，我可以看到有多少人在移动设备上观看了我的视频，因为它显示“第一次从移动设备观看”，然后是观看次数。Smart TV 或 TiVo 的观点是否存在类似情况？

谢谢，泰勒

# castle-windsor - 如何将 Logging 拦截器注入 Windsor 控制器工厂？

> ID：13299351
> 
> 赞同：1
> 
> 时间：2012-11-08T22:55:29.180
> 
> 标签：castle-windsor, castle-dynamicproxy

如何使用流利的配置将异常或日志拦截器添加到 Windsor 控制器工厂？

在我的引导程序容器中，我更新了我的安装程序以传递诸如 assemblyName 之类的值。

在我的 ControllerInstaller 中，我这样做了，我认为这是错误的以及为什么它不起作用：

```
container.Register(
    Classes
        .FromAssemblyNamed(_assemblyName)
        .BasedOn<IController>()
        .LifestyleTransient(),
    Component
        .For<IController>()
        .ImplementedBy<Controller>()
        .Interceptors(InterceptorReference.ForType<LoggingAspect>())
        .Anywhere); 
```

在我的 loggingAspect 安装程序中，我这样做：

```
container.Register(
    Component
        .For<IInterceptor>()
        .ImplementedBy<LoggingAspect>()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T20:18:52.250

我认为这应该工作......

```
_container.Register(
    Classes
        .FromAssemblyNamed(_assemblyName)
        .BasedOn<IController>()
        .LifestyleTransient()
        .Configure(component => component.Interceptors<LoggingAspect>())); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T05:44:12.217

这是一篇关于创建自定义温莎控制器工厂的好文章。
[带有 Windsor 的 ASP.NET MVC – 编程控制器注册](http://blog.andreloker.de/post/2009/03/28/ASPNET-MVC-with-Windsor-programmatic-controller-registration.aspx)

下面是如何使用流畅配置注册拦截器的示例。

将两者放在一起应该很容易。您只需将该`.Interceptors<MyLoggingInterceptor>()`行添加到您的 Windsor 控制器工厂的注册和/或您的控制器的注册中。

```
container.Register(
    Component
        .For<IInterceptor>()
        .ImplementedBy<MyLoggingInterceptor>(),
    Component
        .For<IInterceptor>()
        .ImplementedBy<MyArgumentInterceptor>(),
    Component
        .For<IDoStuff>()
        .ImplementedBy<DoStuff>()
        .Interceptors<MyLoggingInterceptor>()
        .Interceptors<MyArgumentInterceptor>()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T23:37:40.013

另一种方法：

```
container.Register(
    Component.For<IInterceptor>()
        .ImplementedBy<ExceptionHandlerInterceptor>()
        .LifeStyle.Is(LifestyleType.Transient)
        .Named("ExceptionHandlerInterceptor"),
    Component.For<IController>()
        .ImplementedBy<Controller>()
        .LifeStyle.Is(LifestyleType.Transient)
        .Interceptors("ExceptionHandlerInterceptor")); 
```

# memory - 使用 free 解决内存泄漏

> ID：13299354
> 
> 赞同：2
> 
> 时间：2012-11-08T22:56:01.830
> 
> 标签：memory, memory-leaks, malloc, free

我正在尝试消除以下程序中的内存泄漏

```
int main (int argc, char **argv) {
   node_ref head = NULL;
   for (int argi = 0; argi < 5; ++argi) {
      node_ref node = malloc (sizeof (struct node));
      assert (node != NULL);
      node->word = argv[argi];
      node->link = head;
      head = node;
   }
   for (node_ref curr = head; curr->link != NULL; curr = curr->link) {
      printf ("%p->node {word=%p->[%s], link=%p}\n",
              curr, curr->word, curr->word, curr->link);
   }
   while(head != NULL){
   struct node* temp;
   temp = head;
   head++;
   free(temp);
   }
   return 9;
} 
```

然而，当我运行 valgrind 时，它会因内存泄漏而发疯，这里知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:59:37.900

You are allocating memory inside the loop which is resulting in multiple memory areas. It looks like you should be calling malloc() before your loop instead.

EDIT:

After looking at this again, I think the second loop that frees the memory is incorrect. You are incrementing with `head++;` rather than setting `head = temp->link;` It is incorrect to assume that `malloc` will give you contiguous memory segments.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:09:27.940

在你的`free`循环中，你使用`head++`which 会给你垃圾。你要`head = head->link`

# java - 平移后在android中更新图像坐标

> ID：13299356
> 
> 赞同：1
> 
> 时间：2012-11-08T22:56:14.073
> 
> 标签：java, android, eclipse, image-processing

我正在尝试使用 android 从我的研究工作中开发一些东西。但我不是编码人员，所以我很难弄清楚如何做事。我想出了实现我的功能的方法，但我对一个我自己无法解决的问题感到有点震惊。如果你们能帮助我，那就太好了。

我正在尝试显示大于屏幕尺寸的图像，并在我触摸图像中的特定颜色像素时使其播放声音或振动。我能够为图像的第一个实例执行此操作（即，一旦我启动我的应用程序就显示的图像），但是一旦我平移它就不起作用。例如，我的图像在屏幕中间有一个绿色像素，平移后它向左移动。一旦我触摸绿色像素，我就会让它振动。当绿色居中时设备会振动，但在我平移后它没有更新。当我触摸屏幕中心时它仍然会振动，即使有不同的颜色。我猜该程序修复了屏幕坐标并且没有使用图像坐标。我尝试使用 event.getX、getRawX。但两者都只引用屏幕坐标。我的问题是

*有没有办法定位图像坐标而不是屏幕坐标？

*如果没有，我还能如何完成这项任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:36:35.133

嗯，这是一种语义，但没有“图像坐标”的概念。

如果您考虑一下，触摸首先是由一块硬件处理的，除了它的物理像素之外，它完全不知道您正在触摸什么，这就是它向 Android 报告的内容。

反过来，Android 也不知道那块图像像素是什么。像素中特定图像*相*对于屏幕的位置仅在您的应用程序内部有意义。由于触摸事件源自您的应用程序之外，因此无法将两者关联起来......

....除非您建立关联。因此，您在代码中移动了图像以响应触摸事件。记住你移动了多远，使用在处理触摸事件的类中定义的变量，然后使用它作为在后续触摸事件中给你的 x 和 y 的偏移量。

例如，您将图像向左平移 200 像素。死点触摸现在对应于图像的中心像素 (x/2) + 200，因为触摸的物理像素现在位于图像中心右侧的 200 处。

[编辑] 对此进行了更多思考，您可能正在使用矩阵来平移图像，如果不是，请查看 Matrix 类。如果你是，那么你可以随时查询矩阵，随时获取 x 和 y 中平移的总量。如果你也在做缩放和/或旋转，事情会变得有点复杂，但这值得提出一个新问题。

[编辑]

要获得 x,y 的颜色：

```
int pixel = bitmap.getPixel(x,y);

int redValue = Color.red(pixel);
int blueValue = Color.blue(pixel);
int greenValue = Color.green(pixel); 
```

# python - ValueError：解包的值太多

> ID：13299357
> 
> 赞同：5
> 
> 时间：2012-11-08T22:56:21.330
> 
> 标签：python, loops

为什么这段代码是错误的？

```
for i,j in range(100),range(200,300):
    print i,j 
```

当我测试这个 for 语句时，我看到了这个错误

> ValueError：解包的值太多

但是当我测试时

```
for i, j in range(2),range(2):
     print i,j 
```

每件事都是正确的！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T23:00:07.717

`range(2)`给出一个列表 [0, 1]. 因此，您`i, j`将从第一个列表中获取，然后从第二个列表中获取。

因此，您的循环类似于：-

```
for i, j in [0, 1], [0, 1]:
    print i, j 
```

印刷： -

```
0 1
0 1 
```

现在，如果你`range(3)`有，那么它将失败，因为，`range(3)`给出了一个 3 元素列表，它不能在`two loop variables`.

所以，你不能这样做： -

```
for (i, j) in [[0, 1, 2]]:
    print i, j 
```

它会失败，给你你得到的错误。

尝试使用`zip`, 将两个列表压缩为一个。：-

```
>>> for (i, j) in (zip(range(2), range(3))):
    print i, j

0 0
1 1
>>> 
```

`zip``2`在上述情况下，将您的列表转换为包含元素的元组列表，因为您正在压缩 2 个列表。

```
>>> zip(range(2), range(3))
[(0, 0), (1, 1)] 
```

同样，如果你`zip`有三个列表，你将得到 3 元素元组的列表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T23:05:56.327

`range(200), range(300)`看起来太长了，但是我们可以通过查看^([1])`range(2), range(3)`来理解这种情况：

```
iterable = (range(2), range(3))
print(iterable)
for i, j in iterable:
     print(repr(i)) 
```

第一次打印

```
([0, 1], [0, 1, 2])    #<-- This is what your iterable looks like
0 
```

然后加注

```
ValueError: too many values to unpack 
```

在循环的第一遍中，`i`等于 0 和`j`等于 1。在第二遍中，`i,j`被分配给`[0,1,2]`。显然有太多的值需要解包，因此例外。

* * *

脚注^([1])：

```
for i, j in range(2), range(3): 
```

相当于

```
for i, j in (range(2), range(3)): 
```

这相当于

```
iterable = (range(2), range(3))
for i, j in iterable: 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-08T22:59:02.423

尝试使用`zip`：

```
for i, j in zip(range(2),range(2)):
     print i,j 
```

这只是 Python 语法。如果你想有两个循环变量，迭代对象必须包含长度为 2 的序列。但是，您的陈述与以下内容相同：

```
i, j = range(100) 
```

您正在迭代序列`[range(100), range(100)]`。第一次迭代返回`range(100)`，正如您在前面的示例中看到的那样，这显然失败了。

它可以使用，`range(2)`因为它返回一个长度为 2 的序列，您的`i,j`语句可以解压到该序列。

# ruby-on-rails - rails 与 amazon s3 一起设计如何限制每个用户的使用量

> ID：13299358
> 
> 赞同：0
> 
> 时间：2012-11-08T22:56:26.483
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, amazon-s3

我想在我的网站上设置视频和图像查看功能。我的想法是将所有视频、图像部署到亚马逊 s3。我知道我应该使用设计来设置用户注册功能。但我仍然很少担心安全问题和使用费问题

1.设计安全吗？

2.我如何保证只有用户登录并且在他们登录时只能通过我的网站访问我的 amazon-s3 上的视频/图像？

3.这是最难的问题。我们可以跟踪用户的使用情况吗？假设我不希望我网站中的每个用户从 s3 访问超过 100mb/天的内容，无论如何要实现此功能？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:29:59.523

Devise 无疑是一个允许您使用最佳实践来授权和验证用户的框架（例如，通过在存储密码时使用非常强大的加密方法等操作）。但是“安全”有点主观——将 Devise 视为一个非常好的工具箱，它可以让您轻松地做一些使您的网站安全的事情。

保证用户只能通过您的站点访问数据意味着您无法设置默认的 S3 权限以使 S3 存储桶中的内容可供所有人读取。我很确定 S3 在权限方面非常基础。相反，请考虑像[CarrierWave](https://github.com/jnicklas/carrierwave)这样的 gem，它可以轻松移动文件，包括从 S3 通过服务器到用户的流式传输文件，从而为您提供用户身份验证的钩子。这也是测量传输的位数的钩子。

如果我记得，CarrierWave（或者可能是 Fog？）为您提供了一种查询 S3 存储桶的方法，类似于您在文件系统中的查询方式，因此您可以检查大小。

# design-patterns - 将接口属性暴露为接口的模式

> ID：13299359
> 
> 赞同：1
> 
> 时间：2012-11-08T22:56:30.383
> 
> 标签：design-patterns, interface

在下面的代码中，我想在 IHedgehog 接口中将属性 Bristles of Hedgehog 作为 IBristles 公开，因为a）这样我可以只公开 getter 和 b）在外部程序集中我不必引用所有的程序集鬃毛用于更复杂的方法，如 FindBristleDNA。从直觉上看，这是正确的做法：

```
// straightforward interface for simple properties of Bristles -- 
// more complicated methods not exposed
public interface IBristles   {
    int Quantity{ get;  }
}
public class Bristles : IBristles {        

    public int Quantity{ get; set; }
    public MyObscureAssembly.ComplicatedObject FindBristleDNA(){ ... }
}

// simple interface for Hedgehog, which in turn exposes IBristles
public interface  IHedgehog {
    bool IsSquashed { get; }
    IBristles Bristles { get; }
}
// Here, Hedgehog does not properly implement IHedgehog, even though
// Bristles implement IBristles. Will not compile.
public class Hedgehog : IHedgehog {
    public bool IsSquashed { get; set; }
    public Bristles Bristles { get; set; }
} 
```

我的选择是直接在 IHedgehog 界面上公开 Bristle（我不想这样做），或者创建另一个名称不同的属性（我也不想这样做，我希望 IHedgehog拥有 Bristle 属性，就像 IBristles 拥有 IsSquashed 属性一样。）

```
public interface  IHedgehog {
    bool IsSquashed { get; }
    IBristles ReadOnlyBristles { get; }
}
public class Bar : IBar    {
    public bool IsSquashed { get; set; }
    public Bristles Bristles { get; set; }
    public IBristles ReadOnlyBristles { get { return this.Bristles; }
} 
```

这似乎相当不雅。

当然，在处理实际的 Hedgehog 对象时，我们需要 getter 和 setter 功能齐全，并且返回的对象是适当的 Bristle 对象。但是，IHedgehog 只需要从 Bristle getter 中返回 IBristles。

有没有更好/常用的模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T09:23:30.147

使用显式接口实现：

```
public class Hedgehog : IHedgehog 
{
    public bool IsSquashed { get; set; }

    // your public property
    public Bristles Bristles { get; set; }

    // implements the interface
    IBristles IHedgehog.Bristles { get { return Bristles; } }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:19:17.147

```
public class Hedgehog : IHedgehog 
{
    private Bristles _bristles;

    public bool IsSquashed { get; set; }

    public IBristles Bristles 
    { 
       get {return _bristles;}
       set {_bristles = value;}
    }
} 
```

我应该想想。要实现 IHedgehog，您需要一个返回 IBristles 而不是 Bristles 的 getter

# .net - 任务对象只能用于线程池线程吗？

> ID：13299360
> 
> 赞同：3
> 
> 时间：2012-11-08T22:56:36.483
> 
> 标签：.net, multithreading, asynchronous, task, c#-5.0

c# 5.0 中新的异步语言特性在很大程度上依赖于 Task 对象，许多示例表明，在 Task 中运行某些代码的一种常见方法是通过 Task.Run() 启动它，它将您的代码表示为任务并在线程池线程上运行它。

但是，我也读过不应该在线程池线程上启动长时间运行的代码，这让我想到了这个问题：是否仍然可以使用所有 C# 异步语言功能（例如 Task、'await'、'async ') 在“常规”线程上而不使用线程池？在这种情况下，如何获得一个代表在“常规”线程上运行的代码的 Task 对象？

作为关于不在线程池中运行长时间运行代码的规则的后续问题 - 该规则是否仅适用于 CPU 密集型代码？如果您的代码运行了很长时间（例如 72 小时），但大部分时间都花在做诸如“等待 Task.Delay()”之类的事情上怎么办……那么可以使用线程池线程，还是应该使用“常规”？并发代码需要长时间运行的所有情况下的线程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T22:58:41.743

You can run `Task`s wherever you want by making a custom `TaskScheduler`.

However, if all you're doing is `await Task.Delay()`, you shouldn't bother.
The whole purpose of asynchronous calls is to not hold up a thread while waiting for something to happen. While you're awaiting `Task.Delay()`, there aren't any threads running at all.

If you're actually running synchronous code for a long time, you can specify `TaskCreationOptions.LongRunning` to force it to create a new thread.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T00:10:16.293

> 我还读到不应在线程池线程上启动长时间运行的代码

线程池*将*正确响应长时间运行的代码，所以这并不是你*做不到*——这不是*最有效*的方法。

另请注意，这`Task.Delay`意味着与“长时间运行”相反 - 个人*实际上*`Task`在该点完成`await`并且不再在线程池中。另一个在完成`Task`时被创建并排队到线程池中`Task.Delay`。`Task`返回的（`Task.Run`当你传递一个`async`委托时）实际上是一个`Task`代表整个委托的“代理”。

> 是否仍然可以在“常规”线程上使用所有 C# 异步语言功能（例如 Task、'await'、'async'）而不使用线程池？

在你的情况下，你不需要它，但它*是*可能的。我的[AsyncEx 库](http://nitoasyncex.codeplex.com/)包含一个`AsyncContextThread`类型，该类型公开一个`TaskFactory`属性，您可以使用该属性`Task`在该线程上启动 s。

> 我正在使用 Task.Run() “并行”为所有实例提供服务

就您而言，您根本不需要`Task.Run`或根本不需要`TaskFactory`。您可以轻松地并行执行此操作，而无需显式将工作发送到线程池：

```
string[] instanceNames = ...;
var tasks = instanceNames.Select(ServiceInstanceAsync);
await Task.WhenAll(tasks);

private static async Task ServiceInstanceAsync(string name)
{
  await DownloadAndProcessFileAsync();
  await Task.Delay(15000);
  await ExecuteSSHAsync();
} 
```

# datagridview - DataGridView 数据错误

> ID：13299363
> 
> 赞同：1
> 
> 时间：2012-11-08T22:56:50.420
> 
> 标签：datagridview

我有一个带有一些海关列的datagridview，并且在currentcelldirtystatechanged 中提交更改后，引发了dataerror 事件，所以这可能是我无法从datagridview 中的单元格退出编辑模式的原因。尝试退出单元格的编辑模式时，我正在尝试一种奇怪的行为，我不确定问题是否是在 dataerror 事件中引发了错误。如果是这样，如何解决datagridview中的数据错误？

# css - 视差多个 CSS 背景

> ID：13299364
> 
> 赞同：8
> 
> 时间：2012-11-08T22:56:55.453
> 
> 标签：css, background, parallax

我已经看到了很多用于视差分层 div 或具有背景图像的部分的解决方案......我希望有人对现有插件有解决方案或知识，用于视差具有多个 CSS 背景的 div / 部分，例如：

```
background: url(foo.png), url(foo2.png), url(foo3.png);
background-position: x x, x x, x x; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T03:28:48.283

( **Stellar.js)** [http://markdalgleish.com/projects/stellar.js/](http://markdalgleish.com/projects/stellar.js/) ---> 这是一个专门用于视差多个 CSS 背景的 javascript 库。示例 --> [http://markdalgleish.com/projects/stellar.js/demos/backgrounds.html](http://markdalgleish.com/projects/stellar.js/demos/backgrounds.html)

这可能会对您的答案有所帮助。干杯！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-06T15:38:54.710

我没有答案（也没有评论前一个的声誉），但我知道 Stellar.js 不幸（仍然）无法完全满足您的需求：[https ://github.com/markdalgleish/stellar.js /问题/45](https://github.com/markdalgleish/stellar.js/issues/45)

Stellar.js 需要多个元素才能工作。

# c# - Specify address at runtime for generated workflow activities

> ID：13299378
> 
> 赞同：2
> 
> 时间：2012-11-08T22:57:50.787
> 
> 标签：c#, .net, wcf, workflow-foundation-4

I have a service that runs WF4 workflows using WorkflowApplication. These workflows make use of generated activities from WCF soap services. I'm looking for a way of specifying the endpoint address at runtime, for each workflow run, of the different soap services. Any idea how this is possible while still being able to use the generated activities?

**Notes**

*   Currently the consumed soap services have their bindings declared in the local app.config file.
*   This post on MSDN provides an overview on how to generate the services: [http://msdn.microsoft.com/en-us/library/gg281653.aspx](http://msdn.microsoft.com/en-us/library/gg281653.aspx)

# php - 从目录结构年/月/日/时间获取最新文件

> ID：13299390
> 
> 赞同：0
> 
> 时间：2012-11-08T22:58:36.893
> 
> 标签：php

我将数据库的备份存储在目录结构中

年/月/日/时间/备份名称

一个例子是

basics_mini/2012/11/05/012232/RATIONAL.0.db2inst1.NODE0000.20110505004037.001 basics_mini/2012/11/06/012251/RATIONAL.0.db2inst1.NODE0000.20110505003930.001

请注意，不能使用备份文件中的时间戳。在自动化测试开始之前，服务器时间设置为 5.5.2011

所以问题是如果我将“基本目录”（basics_mini）传递给我要编码的某个函数，我如何才能获得最新的文件。我的想法是列出基本目录并按时间排序以获取年份。然后我对月、日和时间做同样的事情。

我想知道 php.ini 中是否有任何“更简单”的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:12:16.420

好吧，您可以一次获取整个目录树并从中获取最后一个元素：

```
$baseFolder = './backup_mini' ;

$arr = glob("{$baseFolder}/*/*/*/*", GLOB_ONLYDIR);
$lastDir = array_pop($arr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:45:13.937

我不知道任何非常简单的单线，但看起来[这](https://stackoverflow.com/questions/7642191/php-directoryiterator-sort-files-by-date)可能会有所帮助：

```
$files = array();
$flags = FilesystemIterator::CURRENT_AS_SELF;
$dir = new RecursiveDirectoryIterator('/path/to/basics_mini', $flags);
foreach ($dir as $path) {
    if ($path->isFile()) {
        $files[$path->getPath()] = $path->getFilename();
    }
}

ksort($files); 
```

您可能想要使用 a[`RecursiveDirectoryIterator`](http://php.net/manual/en/class.recursivedirectoryiterator.php)因为您的目录结构有点复杂。常量也很有帮助
。[`FilesystemIterator`](http://www.php.net/manual/en/class.filesystemiterator.php#filesystemiterator.constants)

# android - getDeviceList() always empty

> ID：13299393
> 
> 赞同：5
> 
> 时间：2012-11-08T22:58:52.010
> 
> 标签：android, arduino, usb, device

I'm trying to use an Arduino Board along with my Odys Neo x8 tablet but it seems, that the UsbManager doesn't recognize the device alright. I connected the arduino to the tablet via an OTG-adapter so that the tablet will work in host mode, the Arduino is successfully receiving power from the device. I'm fetching the list of available USB-devices on the tablet as follows:

```
sUsbController = new UsbController(this, mConnectionHandler, 0, 0);
        HashMap<String, UsbDevice> devlist = sUsbController.mUsbManager.getDeviceList();
        TextView t = ((TextView)findViewById(R.id.textView));
        t.setText("Found " + Integer.toString(devlist.size()) + " devices"); 
```

And inside the class UsbController:

```
mUsbManager = (UsbManager) mApplicationContext
            .getSystemService(Context.USB_SERVICE); 
```

But unfortunately, the list remains empty, even if i start filtering using the VID and the PID (the two zeros). Any suggestions on how to fix this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T11:38:20.917

I have used the following code which works very fine with keyboard, mouse and Mass Storage device to connect with Pandaboard,

```
 UsbManager usbManager = (UsbManager) getSystemService(USB_SERVICE);
  HashMap<String, UsbDevice> devicelist = usbManager.getDeviceList();
  Iterator<UsbDevice> deviceIterator = devicelist.values().iterator();

  while(deviceIterator.hasNext()) {
    UsbDevice usbDevice = deviceIterator.next();
    Log.i(Log_Tag, "Model     : " +usbDevice.getDeviceName());
    Log.i(Log_Tag, "Id        : " +usbDevice.getDeviceId());
  } 
```

This should work with Arduino too.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T05:26:42.827

The Arduino board [needs a driver](http://www.arduino.cc/en/Main/Howto) which needs to be installed before it can be accessed.

I am not sure if you have a port of the driver for Android.

**Edit**:

Also check out [this answer](https://stackoverflow.com/a/9683684/24949) in another thread.

# c++ - is_constexpr 在 C++11 中是否可行？

> ID：13299394
> 
> 赞同：34
> 
> 时间：2012-11-08T22:58:52.837
> 
> 标签：c++, c++11, compile-time, constexpr

是否可以根据 C++11 表达式是否是 C++11 中的常量表达式（即`constexpr`）来生成编译时布尔值？关于 SO 的一些问题与此有关，但我在任何地方都没有看到直接的答案。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-09T09:14:14.073

我曾经写过它（编辑：见下文的限制和解释）。来自[https://stackoverflow.com/a/10287598/34509](https://stackoverflow.com/a/10287598/34509)：

```
template<typename T> 
constexpr typename remove_reference<T>::type makeprval(T && t) {
  return t;
}

#define isprvalconstexpr(e) noexcept(makeprval(e)) 
```

然而，常量表达式有很多种。上面的答案检测纯右值常量表达式。

* * *

### 解释

`noexcept(e)`表达式给出当`false`且仅当`e`包含

*   对没有非抛出异常规范的函数的潜在评估调用，除非调用是常量表达式，
*   一个可能被评估的`throw`表达式，
*   `dynamic_cast`or的一个潜在评估的可抛出形式`typeid`。

注意函数模板`makeprval`没有声明`noexcept`，所以调用需要是一个常量表达式，第一个子弹不适用，这是我们滥用的。我们还需要其他项目符号不适用，但谢天谢地，a`throw`和 throwable `dynamic_cast`or`typeid`也不允许在常量表达式中使用，所以这很好。

### 限制

不幸的是，有一个微妙的限制，这对您来说可能很重要，也可能无关紧要。“潜在评估”的概念比常量表达式应用的限制要保守得多。所以上面`noexcept`可能会给出假阴性。它将报告某些表达式不是纯右值常量表达式，即使它们是。例子：

```
constexpr int a = (0 ? throw "fooled!" : 42);
constexpr bool atest = isprvalconstexpr((0 ? throw "fooled!" : 42)); 
```

在上面`atest`是假的，即使初始化`a`成功了。这是因为作为一个常量表达式，“邪恶的”非常量子表达式“从不评估”就足够了，即使这些邪恶的子表达式在形式上*是*潜在的评估。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-11-28T18:05:54.357

截至 2017 年，`is_constexpr`在 C++11 中是不可能的。这听起来很奇怪，所以让我解释一下历史。

首先，我们添加了这个特性来解决一个缺陷：[http ://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1129](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1129)

Johannes Schaub - litb 发布了一个 constexpr 检测宏，该宏依赖于常量表达式隐式为 noexcept 的规定。这在 C++11 中有效，但至少有一些编译器（例如 clang）从未实现过。然后，作为 C++17 的一部分，我们评估了[Removing Deprecated Exception Specifications from C++17](http://wg21.link/p0003)。作为该措辞的副作用，我们不小心删除了该条款。当核心工作组讨论重新添加该条款时，他们意识到这样做存在一些严重问题。[您可以在LLVM 错误报告](https://bugs.llvm.org/show_bug.cgi?id=15481)中查看完整的详细信息。[因此，我们决定将其视为对所有标准版本的缺陷](https://xkcd.com/498/)，而不是重新添加，并追溯删除它。

这样做的效果是，据我所知，没有办法检测表达式是否可用作常量表达式。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2018-05-04T07:05:13.467

是的，这是可能的。一种方法（即使最近的`noexcept`更改也有效）是利用 C++11 缩小转换规则：

> *窄化转换*是从整数类型或无作用域枚举类型到整数类型的隐式转换 [...]，它不能表示原始类型的所有值，**除非源是一个常量表达式**，其整数提升后的值将适合进入目标类型。

（强调我的）。列表初始化通常不允许缩小转换，当与 SFINAE 结合使用时，我们可以构建小工具来检测任意表达式是否为常量表达式：

```
// p() here could be anything
template<int (*p)()> std::true_type is_constexpr_impl(decltype(int{(p(), 0U)}));
template<int (*p)()> std::false_type is_constexpr_impl(...);
template<int (*p)()> using is_constexpr = decltype(is_constexpr_impl<p>(0));

constexpr int f() { return 0; }
int g() { return 0; }
static_assert(is_constexpr<f>());
static_assert(!is_constexpr<g>()); 
```

[现场演示](https://godbolt.org/g/FsJS7X)。

这里的关键是`int{(expr, 0U)}`包含从`unsigned int`to的缩小转换`int`（因此格式不正确），*除非* `expr`是一个常量表达式，在这种情况下，整个表达式`(expr, 0U)`是一个常量表达式，其评估值适合 type `int`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-04-20T14:04:48.870

以下是用于 C++11 和 C++17的`is_constexpr` *for functions的实现，而不是任意表达式。*但是，它要求您要测试的函数的参数是默认可构造的。

```
#include <type_traits>

struct A {};  // don't make it too easy, use a UDT

          A f1(A a) { return a; }  // is_constexpr -> false
constexpr A f2(A a) { return a; }  // is_constexpr -> true

// The following turns anything (in our case a value of A) into an int.
// This is necessary because non-type template arguments must be integral 
// (likely to change with C++20).
template <class T> constexpr int make_int(T &&) { return 0; }

// Helper to turn some function type (e.g. int(float)) into a function
// pointer type (e.g. int (*)(float)).
template <class T> struct signature_from;
template <class R, class... Args> struct signature_from<R(Args...)> {
    using type = R(*)(Args...);
};

// See std::void_t for the idea. This does it for ints instead of types.
template <int...> using void_from_int = void;

// The fallback case: F is not a function pointer to a constexpr function
template <class T, typename signature_from<T>::type F, class = void_from_int<>>
struct is_constexpr {
    static constexpr bool value = false;
};
// If void_from_int<make_int(F(Args()...))> doesn't lead to a substitution
// failure, then this is the preferred specialization. In that case F must
// be a function pointer to a constexpr function. If it is not, it could
// not be used in a template argument.
template <class R, class... Args, typename signature_from<R(Args...)>::type F>
struct is_constexpr<R(Args...), F, void_from_int<make_int(F(Args()...))>>
{
    static constexpr bool value = true;
};

// proof that it works:
static_assert(!is_constexpr<A(A), f1>::value, "");
static_assert( is_constexpr<A(A), f2>::value, "");

#if __cplusplus >= 201703
// with C++17 the type of the function can be deduced:
template<auto F> struct is_constexpr2 : is_constexpr<std::remove_pointer_t<decltype(F)>, F> {};

static_assert(!is_constexpr2<f1>::value, "");
static_assert( is_constexpr2<f2>::value, "");
#endif 
```

[在https://godbolt.org/g/rdeQme](https://godbolt.org/g/rdeQme)上查看它的实际应用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-31T14:55:43.520

## 添加了 C++20[`std::is_constant_evaluated()`](https://en.cppreference.com/w/cpp/types/is_constant_evaluated)

这允许检查某个表达式是否为常数计算表达式，即在编译时被计算。

**使用示例：**

```
constexpr int foo(int num) {
    // below is true in case the condition is being evaluated at compile time
    // side note, using: if constexpr (std::is_constant_evaluated())
    // would be evaluated always to true, so you should use a simple if!
    if (std::is_constant_evaluated()) {
        return foo_compiletime(num);
    }
    else {
        return foo_runtime(num);
    }
}

int main() {
    constexpr auto t1 = foo(6); // reaches foo_compiletime
    const auto t2 = foo(6);     // reaches foo_compiletime
    int n = rand() % 10;
    const auto t3 = foo(n);     // reaches foo_runtime

    auto t4 = foo(6); // unfortunately, reaches foo_runtime
} 
```

上面示例中的最后一次调用将到达*foo_runtime*，因为该调用不在常量表达式上下文中（结果未用作常量表达式，另请参见此[SO answer](https://stackoverflow.com/a/14248310/2085626)）。

与将决定留给用户的情况相比，这可能会导致不希望的*悲观，用户可能会调用：*

```
 auto t4 = foo_compiletime(6); 
```

并且编译器可以在编译时执行*foo_compiletime*内的操作，如果它被声明为`constexpr`函数，或者如果它被声明则有义务这样做`consteval`。但是，一旦我们将决定留给编译器，我们将到达*foo_runtime*，除非我们通过将结果放入 a或变量中明确指示编译器执行*foo_compiletime 。*然后，如果需要用户帮助编译器查看正确的路径，那么在某种程度上，这忽略了在两种情况下都有一个函数的价值。`const``constexpr``constinit`

要优化调用的另一个可能选项是：

```
 constexpr auto temp = foo(6); // foo_compiletime
    auto t4 = temp; 
```

但同样，我们要求用户了解*foo*的内部行为，这并不是我们想要实现的。

请参阅[此代码中](https://coliru.stacked-crooked.com/a/fc577977de759326)的悲观化。

[在这篇关于该主题的精彩博客文章](https://gist.github.com/Som1Lse/5309b114accc086d24b842fd803ba9d2)中查看更多信息。

# python - 如何打开要写入的文件，写入新信息，然后关闭文件？

> ID：13299398
> 
> 赞同：-2
> 
> 时间：2012-11-08T22:59:14.207
> 
> 标签：python, file

> **可能重复：**
> [在python中替换四个字母的单词](https://stackoverflow.com/questions/13284291/replace-four-letter-word-in-python)

我想在 python shell 中编写一个文件，在其中运行一个程序，然后关闭该文件。

这是我现在拥有的代码。

```
def censor(fileName):
    file = open(fileName, "r")
    for i in len(myList):
        censoredFile = open("censored.txt", "w")
        outputFile.write(censoredFile)
    outputFile.close() 
```

我要运行的程序还没有在程序中，因为我只是想弄清楚如何处理文件。我有一些编程经验，但文件不多。任何输入将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:17:20.073

这是您需要读取文件，替换所有四个字母单词并将最终结果写入不同文件所需的代码。

```
def censor(fileName):
    output_content = ""
    with open(fileName, "r") as input_file:
        with open("censored.txt", "w") as output_file:
            output_content = ""
            for line in input_file:
                output_content += ' '.join([word if len(word) != 4 else "****" for word in line.split(" ")])
            output_file.write(output_content) 
```

应该是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:19:32.930

```
def censor(fileName):
    censoredFile = open("censored.txt", "w")
    for line in open(fileName, "r"):
        censoredLine= do_stuff_to_censor_line(line)
        censoredFile.write(censoredLine) 
```

简单地说，这里是函数的作用：

```
1\. open the output file

2\. go through the input file... for each line:
   2.1 figure out what the censored version of the line would be
   2.2 write the censored version of the line to the output file

3\. close both files (this happens automatically so you dont actually have to call close() 
```

现在对于一行的实际审查...如果您想正确审查内容，仅查看 4 个字母的单词可能还不够强大。这是因为并非所有的顽皮词都是四个字母长。还有一些不调皮的词是四个字母长[例如：'four','long','want','this','help']

```
def do_stuff_to_censor_line(line):
    list_of_naughty_words = ['naughty_word_1','naughty_word_2','etc']
    for naughty_word in list_of_naughty_words:
        line.replace(naughty_word,'*$#@!')
    return line 
```

我将由您来处理不同的大小写...

# java - 递归和 StackOverflow - 我应该改用什么？

> ID：13299399
> 
> 赞同：1
> 
> 时间：2012-11-08T22:59:16.907
> 
> 标签：java, algorithm

我有一段代码：

```
private void colorize(int color, int x, int y) {
    visited[x][y] = true;
    if (x + 1 < d)
        if (board[x + 1][y] == board[x][y] && visited[x + 1][y] == false)
            colorize(color, x + 1, y);
    if (x - 1 >= 0)
        if (board[x - 1][y] == board[x][y] && visited[x - 1][y] == false)
            colorize(color, x - 1, y);
    if (y + 1 < d)
        if (board[x][y + 1] == board[x][y] && visited[x][y + 1] == false)
            colorize(color, x, y + 1);
    if (y - 1 >= 0)
        if (board[x][y - 1] == board[x][y] && visited[x][y - 1] == false)
            colorize(color, x, y - 1);
    board[x][y] = color;
} 
```

我称之为：`colorize(int random, int 0, int 0)`。即使对于一张小桌子（20x20），这也给了我stackoverflow。我怎么能在没有递归的情况下做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:11:16.390

给出的代码似乎很好。

关于什么是一个问题`d`，但我假设它是正确的方形网格的宽度。

无论代码调用它，您都可能遇到问题，但是您给我们的代码不应该有堆栈溢出。

* * *

根据 Måns Rolandi Danielsson 的回答，这里有一个不使用显式堆栈，而是在堆上构建一个。我的java非常生锈，但这应该可以。如果有人对此代码进行了修复，请随时修复它。

在大表大小时，我没有得到堆栈溢出，而是得到一个`java.lang.OutOfMemoryError: Java heap space`错误。您可能可以使用集合或其他一些数据结构（而不​​是链表）来优化内存使用。

```
import java.util.Queue;
import java.util.LinkedList;

class Pair<L,R> {
    private L l;
    private R r;

    public Pair(L l, R r){
        this.l = l;
        this.r = r;
    }

    public L getL(){ return l; }
    public R getR(){ return r; }
}

public class HelloW {
    static int d = 20;
    static boolean[][] visited = new boolean[d][d];
    static int[][] board = new int[d][d];

    static Queue<Pair<Integer, Integer>> Q = new LinkedList<Pair<Integer, Integer>>();

    static void colorize(int color, int orig_x, int orig_y) {
        Q.add(new Pair<Integer, Integer>(orig_x, orig_y));

        while (Q.isEmpty() == false) {
            Pair<Integer,Integer> foo = Q.remove();
            int x = foo.getL();
            int y = foo.getR();
            int old_color = board[x][y];

            visited[x][y] = true;
            board[x][y]  = color;

            if (x + 1 < d)
                if (board[x + 1][y] == old_color && visited[x + 1][y] == false)
                    Q.add(new Pair<Integer, Integer>(x+1, y));
            if (x - 1 >= 0)
                if (board[x - 1][y] == old_color && visited[x - 1][y] == false)
                    Q.add(new Pair<Integer, Integer>(x-1, y));
            if (y + 1 < d)
                if (board[x][y + 1] == old_color && visited[x][y + 1] == false)
                    Q.add(new Pair<Integer, Integer>(x, y+1));
            if (y - 1 >= 0)
                if (board[x][y - 1] == old_color && visited[x][y - 1] == false)
                    Q.add(new Pair<Integer, Integer>(x, y-1));
        }
    }

    public static void main (String[] args) {
        colorize(1, 0, 0);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:13:40.697

我刚刚复制了您的代码并像您在下面看到的那样运行它，它运行良好，最终得到一个充满“真”的矩阵和一个充满“真”的矩阵：

```
static int d = 20;
static boolean[][] visited = new boolean[d][d];
static int[][] board = new int[d][d];

static void colorize(int color, int x, int y) {
    visited[x][y] = true;
    if (x + 1 < d)
        if (board[x + 1][y] == board[x][y] && visited[x + 1][y] == false)
            colorize(color, x + 1, y);
    if (x - 1 >= 0)
        if (board[x - 1][y] == board[x][y] && visited[x - 1][y] == false)
            colorize(color, x - 1, y);
    if (y + 1 < d)
        if (board[x][y + 1] == board[x][y] && visited[x][y + 1] == false)
            colorize(color, x, y + 1);
    if (y - 1 >= 0)
        if (board[x][y - 1] == board[x][y] && visited[x][y - 1] == false)
            colorize(color, x, y - 1);
    board[x][y] = color;
}

public static void main(String[] args)
{
    colorize(1, 0, 0);
} 
```

编辑：测试程序在我的计算机上运行良好 d = 20，但是如果我增加到 d = 100，我会得到 StackOverflow。看起来算法或多或少很好，但是递归不必要的深入，应该有一个更优雅的公式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:15:27.127

据我所知，您的代码可以正常工作；唯一可能影响它的是，如果另一个线程在递归期间出现并修改了您的一个数据结构，或者您在发布之前过度简化了它。

# c# - 常量联系人 C# 包装器 - 将联系人添加到列表

> ID：13299401
> 
> 赞同：1
> 
> 时间：2012-11-08T22:59:28.367
> 
> 标签：c#

我正在尝试使用 c# 包装器将联系人添加到列表中。我的问题是，如果我是第一次添加联系人，我可以成功添加到列表中。但是，如果我通过 Constant Contact Interface 删除联系人并尝试从我的 asp.net C# 函数再次添加联系人，它会失败。

我做了一些研究，我确实明白：1）我首先需要检查联系人电子邮件地址是否存在 2）然后，相应地更新或发布。

对上述任何帮助/建议表示赞赏。我花了很多时间试图完成这项工作，但没有运气。

代码

```
protected void Page_Load(object sender, EventArgs e)
    {
        ConstantContactBO.Contact c = new ConstantContactBO.Contact();

        AuthenticationData authdata = new AuthenticationData();
        authdata.Username = "";
        authdata.Password = "";
        authdata.ApiKey = "";

        c.EmailAddress = "joe@a.com";

        ContactOptInList theList = new ContactOptInList();
        c.OptInSource = ContactOptSource.ActionByContact;
        theList.ContactList = new ContactList("39");
        c.ContactLists.Add(theList);

        ConstantContactUtility.Utility.CreateNewContact(authdata, c); 
```

}

我希望能够检查电子邮件是否存在，然后更新或将联系人添加到列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:31:02.373

在这里[https://github.com/constantcontact/Constant-Contact-Dot-Net-ASP-Contact-Forms/blob/master/Web/UploadContactForm/AddContactSmallForm.aspx.cs](https://github.com/constantcontact/Constant-Contact-Dot-Net-ASP-Contact-Forms/blob/master/Web/UploadContactForm/AddContactSmallForm.aspx.cs)你可以找到你正在寻找的代码的美丽示例， 我相信。如果您正确使用了已识别的产品，您可以在此处找到更多文档[http://developer.constantcontact.com/ 。](http://developer.constantcontact.com/)

```
 string nextChunkId;
    IList<Contact> list = Utility.SearchContactByEmail(AuthenticationData, emailAddress, out nextChunkId);
    if (list.Count == 0)
    {
        // create new Contact
        Contact contact = GetContactInformation();

        Utility.CreateNewContact(AuthenticationData, contact);
        Response.Redirect("~/AddContactConfirmation.aspx");
    }
    else
    {
        throw new ConstantException(String.Format(CultureInfo.CurrentCulture,
            "Email address \"{0}\" is already a contact", txtEmail.Text.Trim()));
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:17:25.023

尝试使用 Lambda 表达式

```
int count = c.ContactLists.Count(cc => cc.EmailAddress == "joe@a.com");
if(count == 0) //does not exist
{
   //add this contact
}
else
{

} 
```

# css - CSS Drop Down Menu Not Working In ie8 Drop Down Vanishes

> ID：13299407
> 
> 赞同：2
> 
> 时间：2012-11-08T23:00:04.550
> 
> 标签：css

I am working on the website [http://www.oneluckymutt.com/](http://www.oneluckymutt.com/) and the drop downs appear when I hover over them and then disappear when I go to click on the submenu below. The drop downs work in Chrome, FireFox, Safari but not ie8\. Any help would be appreciated! Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:59:20.607

您的下拉菜单仅在用户将鼠标悬停在顶级列表项上时出现。Internet Explorer 中发生的情况是 li.top_level 和 ul.submenu 之间有一个小空间。当用户悬停在这个小空间上时，他们不再悬停在 li.top_level 上，并且 ul 消失了。

尝试重叠你的 li.top_level 和 ul.submenu 来解决这个问题。

```
li.top_level {
    height: 33px; /* Set a maximum height */
}

.submenu {
    top: 30px; /* Define the top position of the submenu */
} 
```

# image - 如何在opencv中获取真实位置的图像像素？

> ID：13299409
> 
> 赞同：22
> 
> 时间：2012-11-08T23:00:10.610
> 
> 标签：image, opencv, interpolation

我想检索图像中像素的 rgb。但该位置不是整数位置，而是实数值 (x,y)。我想要一个双线性插值。我怎么能做到opencv？

非常感谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-09T03:37:28.327

亚像素访问没有简单的功能，但我可以建议您几个选项：

1.  使用[getRectSubPix](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#getrectsubpix)并提取 1 个像素区域：

    ```
    cv::Vec3b getColorSubpix(const cv::Mat& img, cv::Point2f pt)
    {
        cv::Mat patch;
        cv::getRectSubPix(img, cv::Size(1,1), pt, patch);
        return patch.at<cv::Vec3b>(0,0);
    } 
    ```

2.  对单像素地图使用更灵活但不太精确的重[映射：](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#remap)

    ```
    cv::Vec3b getColorSubpix(const cv::Mat& img, cv::Point2f pt)
    {
        cv::Mat patch;
        cv::remap(img, patch, cv::Mat(1, 1, CV_32FC2, &pt), cv::noArray(),
            cv::INTER_LINEAR, cv::BORDER_REFLECT_101);
        return patch.at<cv::Vec3b>(0,0);
    } 
    ```

3.  自己实现双线性插值，因为它不是火箭科学：

    ```
    cv::Vec3b getColorSubpix(const cv::Mat& img, cv::Point2f pt)
    {
        assert(!img.empty());
        assert(img.channels() == 3);

        int x = (int)pt.x;
        int y = (int)pt.y;

        int x0 = cv::borderInterpolate(x,   img.cols, cv::BORDER_REFLECT_101);
        int x1 = cv::borderInterpolate(x+1, img.cols, cv::BORDER_REFLECT_101);
        int y0 = cv::borderInterpolate(y,   img.rows, cv::BORDER_REFLECT_101);
        int y1 = cv::borderInterpolate(y+1, img.rows, cv::BORDER_REFLECT_101);

        float a = pt.x - (float)x;
        float c = pt.y - (float)y;

        uchar b = (uchar)cvRound((img.at<cv::Vec3b>(y0, x0)[0] * (1.f - a) + img.at<cv::Vec3b>(y0, x1)[0] * a) * (1.f - c)
                               + (img.at<cv::Vec3b>(y1, x0)[0] * (1.f - a) + img.at<cv::Vec3b>(y1, x1)[0] * a) * c);
        uchar g = (uchar)cvRound((img.at<cv::Vec3b>(y0, x0)[1] * (1.f - a) + img.at<cv::Vec3b>(y0, x1)[1] * a) * (1.f - c)
                               + (img.at<cv::Vec3b>(y1, x0)[1] * (1.f - a) + img.at<cv::Vec3b>(y1, x1)[1] * a) * c);
        uchar r = (uchar)cvRound((img.at<cv::Vec3b>(y0, x0)[2] * (1.f - a) + img.at<cv::Vec3b>(y0, x1)[2] * a) * (1.f - c)
                               + (img.at<cv::Vec3b>(y1, x0)[2] * (1.f - a) + img.at<cv::Vec3b>(y1, x1)[2] * a) * c);

        return cv::Vec3b(b, g, r);
    } 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-02-11T22:07:35.353

不幸的是，我没有足够的分数将其发布为对已接受答案的评论...我调整了代码以适应我自己的问题，该问题需要在单通道浮点矩阵上进行插值。

我想我想知道哪种方法最快。

我实现了 Andrey Kamaev 的回答中的 3 种方法以及一个简单的最近邻（基本上只是四舍五入坐标）。

我用刚刚填充垃圾的矩阵 A(100x100) 进行了实验。然后，我制作了一个矩阵 B(400x400)，其中填充了从 a 中插入的值：B(i,j) = A(i/4, j/4)。

每次运行 1000 次，以下是平均次数：

*   最近邻居：2.173 毫秒
*   获取矩形子像素：26.506 毫秒
*   重映射：114.265 毫秒
*   手动：5.086 毫秒
*   无边框手动插值：3.842 毫秒

如果您不太关心实际插值并且只需要一个值 - 特别是如果您的数据变化非常平稳，那么最近的邻居可以获得超高速。对于其他任何事情，我都会使用手动双线性插值，因为它似乎始终比其他方法快。（OpenCV 2.4.9 - Ubuntu 15.10 回购 - 2016 年 2 月）。

如果您知道所有 4 个贡献像素都在矩阵的范围内，那么您可以使其在时间上基本等同于最近邻 - 尽管无论如何差异都可以忽略不计。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-09T02:58:35.710

双线性插值仅意味着根据与您正在检查的像素最近的 4 个像素对值进行加权。权重可以如下计算。

```
cv::Point2f current_pos; //assuming current_pos is where you are in the image

//bilinear interpolation
float dx = current_pos.x-(int)current_pos.x;
float dy = current_pos.y-(int)current_pos.y;

float weight_tl = (1.0 - dx) * (1.0 - dy);
float weight_tr = (dx)       * (1.0 - dy);
float weight_bl = (1.0 - dx) * (dy);
float weight_br = (dx)       * (dy); 
```

您的最终值计算为每个像素与其各自权重的乘积之和

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-29T01:52:15.620

如果您想重复或一致地执行此操作，使用映射会更有效。另一个优点是选择插值方法以及如何处理边界条件。最后，一些插值函数也在 GPU 上实现。 [重新映射](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html?highlight=remap#cv2.remap)

# objective-c - Mac OS X 相当于 SecureZeroMemory / RtlSecureZeroMemory？

> ID：13299420
> 
> 赞同：10
> 
> 时间：2012-11-08T23:00:55.140
> 
> 标签：objective-c, c, macos, security, memset

是否有 Mac OS X 等效的[`RtlSecureZeroMemory`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff562768.aspx)/ [`SecureZeroMemory`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366877.aspx)，一个将内存块归零的函数，但编译器不会优化调用？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T23:04:56.537

编写自己的函数：

```
void secure_zero(void *s, size_t n)
{
    volatile char *p = s;

    while (n--) *p++ = 0;
} 
```

**编辑：**对于评论中的问题，为什么不`memset`呢？如果`memset`不再访问数组对象，则编译器可以优化函数调用。

请注意，C11 添加了（可选）函数`memset_s`，并且标准保证函数调用不能被优化掉：

> (C11, K.3.7.4.1p4) “[...] 与 memset 不同，对 memset_s 函数的任何调用都应严格按照 (5.1.2.3) 中描述的抽象机规则进行评估。也就是说，任何对 memset_s 函数的调用应假定 s 和 n 指示的内存将来可以访问，因此必须包含 c 指示的值。”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-22T09:08:40.510

> 是否有 RtlSecureZeroMemory / SecureZeroMemory 的 Mac OS X 等价物，一个将内存块归零的函数，但编译器不会优化调用？

在 C 运行时的更新版本中，您拥有`memset_s`. 它保证不会被优化掉。

```
#define __STDC_WANT_LIB_EXT1__ 1
#include <string.h>
errno_t memset_s(void * restrict s, rsize_t smax, int c, rsize_t n) 
```

OS X 也包含该`bzero`功能。但是[`bzero(3)`手册页](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man3/bzero.3.html) *没有*说明它*不会*被优化器删除。

避免使用限定符的技巧，`volatile`因为它不可移植。它在 Windows 上按预期工作，但 GCC 人员将其解释`volatile`为由硬件支持的 I/O 内存。所以你不应该用来`volatile`驯服优化器。

* * *

这是您可以使用的内联汇编实现。奇怪的是，`__volatile__`在 ASM 语句和块上都可以。它在 OS X 上运行良好（这是最初编写的地方）。

```
// g++ -Og -g3 -m64 wipe.cpp -o wipe.exe
// g++ -Og -g3 -m32 wipe.cpp -o wipe.exe    
// g++ -Os -g2 -S -m64 wipe.cpp -o wipe.exe.S
// g++ -Os -g2 -S -m32 wipe.cpp -o wipe.exe.S

#include <iostream>
#include <iomanip>
#include <string>
using namespace std;

int main(int argc, char* argv[])
{
    string s("Hello world");
    cout << "S: " << s << endl;

    char* ptr = &s[0];
    size_t size = s.length();

    if(ptr && size)
    {
        /* Needed because we can't just say to GCC, */
        /*   "give me a register that you choose".  */
        void* dummy;

        __asm__ __volatile__
        (
         "%=:\n\t"                /* generate a unique label for TOP */

#if (__WORDSIZE == 64)
         "subq $1, %2\n\t"        /* 0-based index */
#elif (__WORDSIZE == 32)
         "subl $1, %2\n\t"        /* 0-based index */
#elif (__WORDSIZE == 16)
         "subw $1, %2\n\t"        /* 0-based index */
#else
# error Unknown machine word size
#endif

         "lea (%1, %2), %0\n\t"   /* calcualte ptr[idx] */
         "movb $0, (%0)\n\t"      /* 0 -> ptr[size - 1] .. ptr[0] */
         "jnz %=b\n\t"            /* Back to TOP if non-zero */

         : "=&r" (dummy)
         :  "r" (ptr), "r" (size)
         : "0", "1", "2", "cc"
         );
    }

#if 0
    cout.setf(ios::hex, ios::basefield);
    cout.fill('0');

    for(size_t i = 0; i < s.length(); i++)
        cout << "0x" << setw(2) << ((int)s[i] & 0xff) << " ";

    cout << endl;
#endif

    cout << "S: " << s << endl;

    return 0;
} 
```

# android - 如何终止 AsyncTask？

> ID：13299422
> 
> 赞同：2
> 
> 时间：2012-11-08T23:01:08.710
> 
> 标签：android, multithreading, android-asynctask

请不要认为这是一个多余的问题。请完整阅读。

我在 AsyncTask 的 doInBackground(Void...params) 中有一个无限循环。doInBackground() 中有一个回调函数。因此，我无法使用 cancel()、onCancelled() 和 isCancelled() 方法终止此任务。问题是执行永远在回调函数处等待。因此，无论我在哪里（在 doInBackground 内）编写这个 isCancelled() 检查以跳出无限循环，它都不会被执行。

有没有人有解决这种问题的方法？或者有人有类似的要求吗？

```
@Override
protected void onCancelled()
{
    // Socket Close
}

@Override
    protected Void doInBackground(Void... params)
    {
        try
        {
            // Socket Open

            while (true)
            {

                socket.receive();
            }
        }
        catch (Exception e)
        {

        }
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:22:51.360

您应该在您的 中使用超时`socket.receive()`，因此它会不时将控制权传递回`AsyncTask`，您可以在其中检查`isCancelled()`并终止循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:35:11.467

```
 @Override
    protected void onCancelled()
    {
        // Socket Close
    }

    @Override
        protected Void doInBackground(Void... params)
        {
            try
            {
                // Socket Open

                while (!isCancelled())
                {

                    socket.receive();
                    OnProgressUpdate(...);
                }
            }
            catch (Exception e)
            {

            }
            return null;
        }
    @Override
        protected void onProgressUpdate(...) {
                receiveing=true;
            }

boolean receiveing; 
```

由于我不知道您要达到什么目标，而且问题也不清楚，所以我不确定这是否是您要问的。您可以将 cancel() 放在您需要的地方。
无限循环不是一个好主意......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:42:23.513

在开始任何接收操作之前，`socket.setSoTimeout(int timeout)`根据您的需要调用并给它一个超时时间（如果您通常等待数据等待一点时间，您可以使用 1000ms 或更短。如果接收数据可能需要很长时间，请使用更大的值，例如 10000 毫秒）。

然后，在您的循环中，在`socket.receive`方法之后，检查任务是否被取消（`isCancelled() == true`），如果是，则从循环中退出。

# events - 如何在等待事件时暂时禁用 UISwitch？

> ID：13299424
> 
> 赞同：0
> 
> 时间：2012-11-08T23:01:16.013
> 
> 标签：events, bluetooth, controls, uiswitch

我试图在等待事件时暂时禁用我的 UISwitch 控件。在那次事件发生后，我希望我的开关重新启用。我正在尝试使控制切换蓝牙，所以我需要等到蓝牙通电才能再次将其关闭。如果我不禁用它，我的 UISwitch 可能会与蓝牙电源不同步。顺便说一句，我正在使用 Apple 的私有框架 BluetoothManager。（我确实意识到我无法将此应用上传到 App Store，但该应用仅供个人使用。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T05:14:34.263

`UISwitch`继承自`UIControl`，它有一个名为 的属性`enabled`。就设置这个。基本上得到与 Fry 的答案相同的结果，从你的评论中我不太确定你为什么不接受。例如：

```
// Presumably you're opening bluetooth using a block, so if it hasn't finished yet ...
if (!bluetooth) {
bluetoothSwitch.enabled = NO;
} 
```

然后当初始化它的块调用蓝牙设置器时：

```
// If initialisation was successful re-enable
if (_bluetooth) {
bluetoothSwitch.enabled = YES
// Then just update the view containing the switch
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T15:14:16.550

你试过吗

```
mySwitch.userInteractionEnabled = NO; 
```

?

# c# - 如何将 Dapper 查询结果绑定到 WPF DataGrid

> ID：13299425
> 
> 赞同：7
> 
> 时间：2012-11-08T23:01:17.730
> 
> 标签：c#, .net, wpf, data-binding, dapper

这是我的代码。它会生成一个具有正确行数的绑定网格，但是**单元格是空**的。

XAML

```
<DataGrid
  Name="grid" 
  ItemsSource="{Binding}"
  AutoGenerateColumns="True" /> 
```

背后的代码

```
grid.DataContext = cn.Query("select * from SomeTable"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:05:30.930

从[文档](http://code.google.com/p/dapper-dot-net/)中，您的语法 - `cn.Query("sql")`- 返回动态类型对象列表 ( `IEnumerable<dynamic>`)。这不适用于 DataGrid 自动列，它会寻找具体成员来生成其列。我建议为*SomeTable*创建一个简单的实体类来映射属性，然后使用`cn.Query<SomeTableEntity>("select * from SomeTable");`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-09T00:37:05.697

所以我想答案是：不可能。这是一个hacky解决方法。

```
 ...
        var items = cn.Query("select * from SomeTable");
        grid.DataContext = ConvertToDataTable(items);
    }

    public DataTable ConvertToDataTable(IEnumerable<dynamic> items) {
        var t = new DataTable();
        var first = (IDictionary<string, object>)items.First();
        foreach (var k in first.Keys)
        {
            var c = t.Columns.Add(k);
            var val = first[k];
            if (val != null) c.DataType = val.GetType();
        }

        foreach (var item in items)
        {
            var r = t.NewRow();
            var i = (IDictionary<string, object>)item;
            foreach (var k in i.Keys)
            {
                var val = i[k];
                if (val == null) val = DBNull.Value;
                r[k] = val;
            }
            t.Rows.Add(r);
        }
        return t;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-08T23:07:48.747

如果您使用 Query 的非通用版本，它会返回数据的动态表示。动态 API 不适用于大多数 UI 数据绑定。最好使用通用`Query<T>`API 将数据加载到已定义属性的类型中。

在*完全 push*中，理论上也可以在数据上实现 ITypedList 并相应地公开属性。但这是相当多的工作，没有那么多收获。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T18:04:59.487

*纯Linq*是不可能的！可以重用旧数据集并使用 System.Data.DataSetExtensions 转换回 linq。（不优雅但有效）

```
// Steal concrete connection from Linq
ModelDEmoWPFContainer l_ctx = new ModelDEmoWPFContainer();
var l_connection = (System.Data.EntityClient.EntityConnection)l_ctx.Connection)
                                   .StoreConnection;

System.Data.SqlClient.SqlCommand l_cmd = 
                  new System.Data.SqlClient.SqlCommand(query_arg);
l_cmd.Connection = (System.Data.SqlClient.SqlConnection) l_connection;
System.Data.SqlClient.SqlDataAdapter l_da = 
                 new    System.Data.SqlClient.SqlDataAdapter(l_cmd);
System.Data.DataSet l_ds = new System.Data.DataSet();     
l_da.Fill(l_ds); 
```

克隆元数据

```
System.Data.DataTable l_dt = l_ds.Tables[0].Clone(); 
```

通过 System.Data.DataSetExtensions 回到 linq

```
var dt = (from data in l_ds.Tables[0].AsEnumerable()
                  select data).ToList();

   foreach (DataColumn column in l_dt.Columns)
   {
      var binding = new Binding(string.Format("[{0}]", column.Ordinal));
      datagrid.Columns.Add(new DataGridTextColumn() 
                     { Header = column.ColumnName, Binding = binding });
   }

        datagrid.ItemsSource = dt; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-21T20:29:20.700

如果您使用的是 MVVM 模式，我认为这是更好的解决方案：

在您的 ViewModel 中创建 ObservableCollecion，它将绑定到`ItemSource`in `DataGrid`：

```
public ObservableCollection<T> bindableCollection; 
```

然后，从您的数据库中获取数据，例如：

```
public void RefreshDataGrid(){
    using (var conn = new SqlConnection(ConfigurationManager.ConnectionStrings[
        "RecipeManager.Properties.Settings.RecipeManagerConnectionString"].ConnectionString)){
       var fetchedData = conn.Query<Flavour>("select * from [Flavour]");
        ConvertToDataTable(fetchedData);

    }
} 
```

最后一步，也是最重要的一步，创建函数，它将 IEnumerable 添加到您的 ObservableCollection：

```
private void ConvertToObservableCollection(IEnumerable<Flavour> items){
    ObservableCollection<Flavour> flavours = new ObservableCollection<Flavour>();
    foreach (var item in items){
        Flavour flavour = item as Flavour;
        flavours.Add(new Flavour(flavour.Name,flavour.Company,flavour.Shop,flavour.Amount));
    }
    Flavours = flavours;
} 
```

我认为，这是 mvvm 的好方法。

# ssis - 如何使用 foreach 循环容器仅从文件夹中检索文件名？

> ID：13299426
> 
> 赞同：3
> 
> 时间：2012-11-08T23:01:20.920
> 
> 标签：ssis

我有一个文件夹，其中`.PDF`保存了一些文件。如何设置 Foreach 循环容器以仅捕获这些文件的标题名称，然后将其作为参数传递？

### PDF 文件：

```
123.pdf
223.pdf
333.pdf 
```

Foreach 循环容器完成执行后，值应显示如下：

### 输出：

```
123
223
333 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T03:57:55.030

看看这篇文章，它使用的是2005，但它与2008的步骤和界面相同。[http://www.sqlis.com/sqlis/post/Looping-over-files-with-the-Foreach-Loop.aspx](http://www.sqlis.com/sqlis/post/Looping-over-files-with-the-Foreach-Loop.aspx)

在每个循环编辑器集合的页面中选择“仅名称”单选按钮。它只返回文件名而不是扩展名。这是您必须做出的唯一改变。

文件名存储到一个变量中。这是在变量映射页面中定义的。现在，如果要将这些值存储到表中，请添加执行 SQL 任务并编写插入语句。插入语句看起来像插入表 (col) 值 (@varname)。最后，参数化这个执行 SQL 任务。

# python - Python 函数通过引用调用

> ID：13299427
> 
> 赞同：99
> 
> 时间：2012-11-08T23:01:21.857
> 
> 标签：python

**在某些语言中，您可以使用特殊的保留字（如ref**或**val** ）通过引用或值传递参数。当您将参数传递给 Python 函数时，它永远不会在离开函数时改变参数的值。做到这一点的唯一方法是使用**全局**保留字（或者按照我目前的理解）。

*示例 1：*

```
k = 2

def foo (n):
     n = n * n     #clarity regarding comment below
     square = n
     return square

j = foo(k)
print j
print k 
```

会显示

```
>>4
>>2 
```

显示 k 不变。

在这个例子中，变量 n 永远不会改变

*示例 2：*

```
n = 0
def foo():
    global n
    n = n * n
    return n 
```

在此示例中，变量 n 已更改。

Python中有什么方法可以调用函数并告诉Python**该参数**是**值**参数还是**引用**参数而不是使用全局参数？

其次，在剑桥 A 级考试中，他们现在说函数返回**单个**值，而过程返回**多个**值。在 80 年代，我被教导一个函数有一个返回语句而过程没有。为什么现在不正确？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2015-10-11T15:15:25.417

基本上有三种“函数调用”：

*   按值传递
*   通过引用传递
*   通过对象引用传递

Python 是一种 PASS-BY-OBJECT-REFERENCE 编程语言。

首先，重要的是要了解变量和变量（对象）的值是两个独立的东西。变量“指向”对象。变量不是对象。再次：

**变量不是对象**

示例：在以下代码行中：

```
>>> x = [] 
```

`[]`是空列表，`x`是指向空列表的变量，但`x`本身不是空列表。

将变量 ( `x`，在上例中) 视为一个框，将变量 ( `[]`) 的“值”视为框内的对象。

**按对象引用传递（python 中的案例）：**

这里，“对象引用是按值传递的”。

```
def append_one(li):
    li.append(1)
x = [0]
append_one(x)
print x 
```

在这里，该语句创建了一个指向 object`x = [0]`的变量（框） 。`x``[0]`

在调用函数时，`li`会创建一个新框。的内容`li`与盒子的内容相同`x`。**两个盒子都包含相同的对象。**也就是说，两个变量都指向内存中的同一个对象。因此，对 所指向的对象的任何更改`li`也将由 所指向的对象反映出来`x`。

总之，上述程序的输出将是：

```
[0, 1] 
```

**笔记：**

如果变量`li`在函数中被重新赋值，那么`li`将指向内存中的一个单独的对象。`x`但是，它将继续指向它之前指向的内存中的同一个对象。

例子：

```
def append_one(li):
    li = [0, 1]
x = [0]
append_one(x)
print x 
```

该程序的输出将是：

```
[0] 
```

**通过参考：**

来自调用函数的盒子被传递给被调用函数。隐含地，盒子的内容（变量的值）被传递给被调用的函数。因此，被调用函数中对框内容的任何更改都将反映在调用函数中。

**按价值传递：**

在被调用函数中创建一个新盒子，并将*来自调用函数的盒子内容的副本*存储到新盒子中。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2012-11-08T23:13:03.187

您不能在 Python 中的函数内更改不可变对象，例如`str`or `tuple`，但您可以执行以下操作：

```
def foo(y):
  y[0] = y[0]**2

x = [5]
foo(x)
print x[0]  # prints 25 
```

然而，这是一种奇怪的方法，除非您总是需要对数组中的某些元素进行平方。

请注意，在 Python 中，您还可以返回多个值，从而使某些通过引用传递的用例变得不那么重要：

```
def foo(x, y):
   return x**2, y**2

a = 2
b = 3
a, b = foo(a, b)  # a == 4; b == 9 
```

当您返回这样的值时，它们将作为元组返回，而元组又被解包。

**编辑：** 另一种思考方式是，虽然您不能在 Python 中通过引用显式传递变量，但您可以修改传入的对象的属性。在我的示例（和其他示例）中，您可以修改列表的成员那是传入的。但是，您将无法完全重新分配传入的变量。例如，看下面的两段代码，它们看起来可能会做类似的事情，但最终会得到不同的结果：

```
def clear_a(x):
  x = []

def clear_b(x):
  while x: x.pop()

z = [1,2,3]
clear_a(z) # z will not be changed
clear_b(z) # z will be emptied 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-11-09T00:35:47.370

好的，我会尝试一下。Python 通过对象引用传递，这与您通常认为的“按引用”或“按值”不同。举个例子：

```
def foo(x):
    print x

bar = 'some value'
foo(bar) 
```

因此，您正在创建一个值为 'some value' 的字符串对象，并将其“绑定”到一个名为`bar`. 在 C 中，这类似于`bar`指向“某个值”的指针。

当你打电话时`foo(bar)`，你并没有通过`bar`自己。您正在传递`bar`' 值：指向“某个值”的指针。此时，有两个“指针”指向同一个字符串对象。

现在将其与：

```
def foo(x):
    x = 'another value'
    print x

bar = 'some value'
foo(bar) 
```

这就是区别所在。在行中：

```
x = 'another value' 
```

你实际上并没有改变`x`. 事实上，这甚至是不可能的。相反，您正在创建一个新的字符串对象，其值为“另一个值”。那个赋值运算符？这并不是说“`x`用新值覆盖指向的东西”。它的意思是“更新`x`以指向新对象”。在该行之后，有两个字符串对象：“某个值”（`bar`指向它）和“另一个值”（`x`指向它）。

这并不笨拙。当您了解它的工作原理时，它就是一个精美优雅、高效的系统。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-06-03T09:15:36.703

希望下面的描述能很好地总结它：

这里有两件事要考虑 - 变量和对象。

1.  如果您正在传递一个变量，那么它是按值传递的，这意味着对函数内变量所做的更改对该函数是本地的，因此不会在全局范围内反映出来。这更像是一种类似“C”的行为。

例子：

```
def changeval( myvar ):
   myvar = 20; 
   print "values inside the function: ", myvar
   return

myvar = 10;
changeval( myvar );
print "values outside the function: ", myvar 
```

输出/输出：

```
values inside the function:  20 
values outside the function:  10 
```

2.  如果您传递封装在可变对象（如列表）中的变量，那么只要不重新分配对象，对对象所做的更改就会全局反映。

例子：

```
def changelist( mylist ):
   mylist2=['a'];
   mylist.append(mylist2);
   print "values inside the function: ", mylist
   return

mylist = [1,2,3];
changelist( mylist );
print "values outside the function: ", mylist 
```

输出/输出：

```
values inside the function:  [1, 2, 3, ['a']]
values outside the function:  [1, 2, 3, ['a']] 
```

3.  现在考虑重新分配对象的情况。在这种情况下，对象指的是发生这种情况的函数的本地新内存位置，因此不会全局反映。

例子：

```
def changelist( mylist ):
   mylist=['a'];
   print "values inside the function: ", mylist
   return

mylist = [1,2,3];
changelist( mylist );
print "values outside the function: ", mylist 
```

输出/输出：

```
values inside the function:  ['a']
values outside the function:  [1, 2, 3] 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-07-22T18:21:59.890

Python 既不是按值传递也不是按引用传递。它更多的是**“对象引用按值传递”** [，](http://robertheaton.com/2014/02/09/pythons-pass-by-object-reference-as-explained-by-philip-k-dick/)如下所述：

1.  **这就是为什么它不是按值传递的原因。** 因为

    ```
    def append(list):
        list.append(1)

    list = [0]
    reassign(list)
    append(list) 
    ```

返回 [0,1] 表明某种引用被清楚地传递为**按值传递不允许函数根本改变父范围**。

看起来像通过引用传递，嗯？没有。

2.  **这就是为什么它不是按引用传递的原因。**因为

    ```
    def reassign(list):
      list = [0, 1]

    list = [0]
    reassign(list)
    print list 
    ```

返回 [0] 表明在重新分配列表时原始引用已被破坏。 **引用传递将返回 [0,1]**。

更多信息请看[这里](http://effbot.org/zone/call-by-object.htm)：

如果您希望您的函数不在作用域之外进行操作，您需要制作一个用于创建新对象的输入参数的副本。

```
from copy import copy

def append(list):
  list2 = copy(list)
  list2.append(1)
  print list2

list = [0]
append(list)
print list 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2020-04-01T20:16:37.243

从技术上讲，python 不按值传递参数：全部通过引用。但是......由于python有两种类型的对象：不可变和可变，这就是发生的事情：

*   **不可变参数通过值有效传递**：字符串、整数、元组都是不可变对象类型。虽然它们在技术上是“通过引用传递”（就像所有参数一样），但由于您无法在函数内部就地更改它们，因此它看起来/表现得好像它是按值传递的。

*   **可变参数通过引用有效地传递**：列表或字典通过其指针传递。函数内部的任何就地更改（如（追加或删除））都会影响原始对象。

这就是 Python 的设计方式：没有副本，全部通过引用传递。您可以显式传递副本。

```
def sort(array):
    # do sort
    return array

data = [1, 2, 3]
sort(data[:]) # here you passed a copy 
```

最后一点我想提一下哪个函数有它自己的作用域。

```
def do_any_stuff_to_these_objects(a, b): 
    a = a * 2 
    del b['last_name']

number = 1 # immutable
hashmap = {'first_name' : 'john', 'last_name': 'legend'} # mutable
do_any_stuff_to_these_objects(number, hashmap) 
print(number) # 1 , oh  it should be 2 ! no a is changed inisde the function scope
print(hashmap) # {'first_name': 'john'} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-08T23:13:49.020

所以这有点微妙，因为虽然 Python 只按值传递变量，但 Python 中的每个变量都是一个引用。如果您希望能够通过函数调用来更改您的值，那么您需要一个可变对象。例如：

```
l = [0]

def set_3(x):
    x[0] = 3

set_3(l)
print(l[0]) 
```

在上面的代码中，函数修改了一个 List 对象（它是可变的）的内容，所以输出是 3 而不是 0。

我写这个答案只是为了说明 Python 中“按值”的含义。上面的代码风格不好，如果你真的想改变你的值，你应该编写一个类并在该类中调用方法，正如 MPX 建议的那样。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-20T05:16:46.330

**考虑变量是一个盒子，它指向的值是盒子里面的“东西”：**

**1.通过引用传递：**函数共享同一个盒子，因此里面的东西也一样。

**2.按值传递：**函数创建一个新盒子，一个旧盒子的复制品，包括里面任何东西的副本。例如。**Java** - 函数创建盒子的副本和里面的东西，可以是：原始/对对象的引用。*（请注意，新框中复制的引用和原始引用仍然指向同一个对象，这里的引用是框内的东西，而不是它指向的对象）*

**3\. 通过对象引用传递**：该函数创建一个盒子，但它包含与初始盒子所包含的相同的东西。所以在**Python**中：

a）如果所述框内的东西是**可变**的，所做的更改将反映在原始框（例如列表）中

b) 如果事物是**​​不可变**的（如 python 字符串和数字类型），那么函数内的框将包含相同的事物，直到您尝试更改其值。一旦改变，函数框中的东西与原来的相比是一个全新的东西。**因此，该盒子的 id() 现在将给出它所包含的新事物的身份**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-08T23:53:37.747

给出的答案是

```
def set_4(x):
   y = []
   for i in x:
       y.append(i)
   y[0] = 4
   return y 
```

和

```
l = [0]

def set_3(x):
     x[0] = 3

set_3(l)
print(l[0]) 
```

就它在问题中所说的而言，这是最好的答案。但是，与 VB 或 Pascal 相比，这似乎是一种非常笨拙的方法。这是我们拥有的最好的方法吗？

它不仅笨拙，还涉及以某种方式**手动**改变原始参数，例如通过将原始参数更改为列表：或将其复制到另一个列表，而不仅仅是说：“将此参数用作值”或“使用此参数”作为参考”。简单的答案可能是**没有保留字**，但这些都是很好的解决方法吗？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-24T19:59:43.163

```
class demoClass:
    x = 4
    y = 3
foo1 = demoClass()
foo1.x = 2
foo2 = demoClass()
foo2.y = 5
def mySquare(myObj):
    myObj.x = myObj.x**2
    myObj.y = myObj.y**2
print('foo1.x =', foo1.x)
print('foo1.y =', foo1.y)
print('foo2.x =', foo2.x)
print('foo2.y =', foo2.y)
mySquare(foo1)
mySquare(foo2)
print('After square:')
print('foo1.x =', foo1.x)
print('foo1.y =', foo1.y)
print('foo2.x =', foo2.x)
print('foo2.y =', foo2.y) 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-11-08T23:12:48.743

在 Python 中，按引用或按值传递与您传递的实际对象有关。因此，例如，如果您传递一个列表，那么您实际上是按引用传递，因为列表是一个可变对象。因此，您正在传递一个指向函数的指针，并且您可以修改函数体中的对象（列表）。

当您传递一个字符串时，此传递是按值完成的，因此正在创建一个新的字符串对象，并且当函数终止时它被销毁。所以这一切都与可变和不可变对象有关。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-06-06T22:12:29.220

Python 已经被 ref 调用了。

让我们举个例子：

```
 def foo(var):
      print(hex(id(var)))

  x = 1 # any value
  print(hex(id(x))) # I think the id() give the ref... 
  foo(x) 
```

输出

```
 0x50d43700 #with you might give another hex number deppend on your memory 
  0x50d43700 
```

# c# - 循环中的计算时间差

> ID：13299428
> 
> 赞同：1
> 
> 时间：2012-11-08T23:01:27.137
> 
> 标签：c#, wpf, loops, time, sum

在编写我目前正在处理的程序时，我注意到性能发生了一些变化，并想检查我用来解释这一点的某些循环中的计算时间。

我写了一个非常简单的程序，它在一个循环中进行简单的加法计算并输出它所花费的时间，我注意到目前有两个对我来说无法解释的效果。

首先是代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        int a = 1, b = 2, c = 0;

        Stopwatch sw = new Stopwatch();

        sw.Start();
        for (int i = 0; i < 100; i++)
        {
            c += (a + b);
        }
        sw.Stop();
        c = 0;
        textBlock1.Text = 100 + ": " + sw.ElapsedTicks;

        sw.Restart();
        for (int i = 0; i < 1000; i++)
        {
            c += (a + b);
        }
        sw.Stop();
        c = 0;
        textBlock2.Text = 1000 + ": " + sw.ElapsedTicks;

        sw.Restart();
        for (int i = 0; i < 10000; i++)
        {
            c += (a + b);
        }
        sw.Stop();
        c = 0;
        textBlock3.Text = 10000 + ": " + sw.ElapsedTicks;

        sw.Restart();
        for (int i = 0; i < 1000000; i++)
        {
            c += (a + b);
        }
        sw.Stop();
        c = 0;
        textBlock4.Text = 1000000 + ": " + sw.ElapsedTicks;

        sw.Restart();
        for (int i = 0; i < 100000000; i++)
        {
            c += (a + b);
        }
        sw.Stop();

        textBlock5.Text = 100000000 + ": " + sw.ElapsedTicks;
    }
} 
```

现在我可以观察到以下内容：

1.  第一次启动程序单击按钮并计算后，100 的短循环大约需要两倍/三倍（6-9 滴答声），只要我第二次运行它（2-4）。之后，它将保持大约相同的长度（2-4 个刻度）。

2.  循环时间之间存在奇怪的比例，当我继续单击按钮时，这些比例保持不变，如下所示：

    *   100：3
    *   1000：15
    *   10000：150
    *   1000000：17000
    *   100000000: 840000

有没有解释为什么 100 循环需要大约 1000 循环时间的 1/5，即使它是计算量的 1/10 倍，以及为什么 100 Mio. 循环只需要大约 1 Mio 的 50 倍。循环，即使它是计算量的 100 倍？有没有人知道为什么我在启动程序后运行一次计算后时间（尤其是 100 循环）会发生变化，然后保持不变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:07:18.493

> 有没有解释为什么 100 循环需要大约 1000 循环时间的 1/5，即使它是计算量的 1/10 倍

您正在测量*三个滴答声*，这是非常非常短的时间。如果您碰巧遇到了上下文切换，您可能会损失更多的时间，即使您的线程被立即再次安排。即使使用`Stopwatch`.

> 有没有人知道为什么我在启动程序后运行一次计算后时间（尤其是 100 循环）会发生变化，然后保持不变？

我的猜测是它与 JIT 编译和/或垃圾收集有关。

这就是为什么通常基准测试首先运行“热身”轮，*并且*他们测试合理的工作量，以便测试将花费合理的时间，平滑时间上的小颠簸。

# c# - 自定义 ViewEngine，但仍然可以使用 HtmlHelper 可编辑项？

> ID：13299431
> 
> 赞同：1
> 
> 时间：2012-11-08T23:01:34.950
> 
> 标签：c#, asp.net-mvc, razor, viewengine

如果我理解了这一点.. 剃刀视图引擎被指定为仅允许默认路径的 HtmlHelper 可编辑项.. 但是如果我更改或扩展引擎应该查找我的部分视图的路径然后希望能够在其中一个部分中使用 Html.EditorFor() ......无论如何，有没有让 Html.EditorFor 也可以使用这个自定义路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T14:16:52.980

是的，您仍然可以使用**Html.EditorFor**，因为它们只会使用您**所有**的视图引擎来解析您正在寻找的视图。如果您想查看如何使用新路径创建自己的视图引擎的示例，请查看我的一个项目中的这个视图引擎。

[https://github.com/stevehodgkiss/restful-routing/blob/master/src/RestfulRouting/ViewEngines/RestfulRoutingRazorViewEngine.cs](https://github.com/stevehodgkiss/restful-routing/blob/master/src/RestfulRouting/ViewEngines/RestfulRoutingRazorViewEngine.cs)

```
public class RestfulRoutingRazorViewEngine : RazorViewEngine
{
    public RestfulRoutingRazorViewEngine()
    {
        AreaMasterLocationFormats = new[] {
                                              "~/Views/{2}/{1}/{0}.cshtml",
                                              "~/Views/{2}/{1}/{0}.vbhtml",
                                              "~/Views/{2}/Shared/{0}.vbhtml",
                                              "~/Views/{2}/Shared/{0}.cshtml",
                                          };

        AreaViewLocationFormats = new[] {
                                            "~/Views/{2}/{1}/{0}.cshtml",
                                            "~/Views/{2}/{1}/{0}.vbhtml",
                                            "~/Views/{2}/Shared/{0}.cshtml",
                                            "~/Views/{2}/Shared/{0}.vbhtml",
                                        };

        AreaPartialViewLocationFormats = AreaViewLocationFormats;
    }
} 
```

我仍然使用 EditorFor 来确定编辑器和显示模板的视图。

# javascript - 类切换主干，javascript

> ID：13299435
> 
> 赞同：0
> 
> 时间：2012-11-08T23:02:04.250
> 
> 标签：javascript, jquery, backbone.js

我在它上面有一个按钮和图标。当我单击按钮时，类成功切换，但是，当我单击按钮内的图标时，类不会切换。这是我的html：

```
<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne-{{id}}">
    <button id="btnCollapse" class="btn" style="width: 25px;" type="button">
        <i id="accordionIcon-{{id}}" class="right"></i>
    </button>
</a> 
```

和javascript：

```
events: {
  'click #btnCollapse': 'handleClass',
  'click .right': 'handleClass'
},

handleClass: function(event) {
  $(event.target).find('i').toggleClass('right down');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:11:45.233

像这样使用处理程序：

```
handleClass: function(event) {
  var $target;
  if (event.target.tagName.toUpperCase() == 'I') {
    $target = $(event.target);
  } else {
    $target = $(event.target).find('i');
  }

  $target.toggleClass('right down');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T00:25:47.667

您可能想尝试`event.currentTarget`而不是`event.target`.

“此属性通常等于函数的 this。”
[http://api.jquery.com/event.currentTarget/](http://api.jquery.com/event.currentTarget/)

# python - 让 setuptools 忽略 PyPI 存储库

> ID：13299439
> 
> 赞同：2
> 
> 时间：2012-11-08T23:02:40.163
> 
> 标签：python, setuptools, pypi

我的包裹里有`setup.py`：

```
from setuptools import setup

setup(
    dependency_links=['http://local.mirror'],
    install_requires=[
        'many',
        'different',
        'packages',
    ],
    ...
 ) 
```

似乎发生的事情是 setuptools 将以相反的顺序从 install_requires 加载条目，并且它只会尊重`dependency_links`最后一个条目的条目`install_requires`（它以相反的顺序安装东西）。

有很多关于如何添加不在 PyPI 中的包的讨论，但我似乎无法找到确保我的本地条目被首先使用或独占使用的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T21:17:04.663

将以下文件放置在解决此问题`setup.cfg`的相同位置：`setup.py`

```
[easy_install]
allow_hosts = local.mirror 
```

# vim - 匹配模式，然后使用模式替换

> ID：13299444
> 
> 赞同：0
> 
> 时间：2012-11-08T23:03:14.277
> 
> 标签：vim

我想在 Vim 中找到一种好方法来进行此搜索并替换以下内容 -

```
name_1
end
name_2
end

name_3
end 
```

我在哪里取 name_"x" 并将其附加到它后面的“end”语句中。所以它看起来像这样 -

```
name_1
end_name_1
name_2
end_name_2
name_3

end_name_3 
```

注意 - name_3 之前的空行破坏了“name_x”和“end”之间的恒定行距。所以我在想类似的东西

```
:g/\(name_x\)/,/end/ s/end/end_\1/ 
```

现在尝试像那样存储第一个模式是行不通的，但希望你明白这一点。这里有什么技巧吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T00:32:19.923

您遇到的问题是`\1`指当前替换的匹配组而不是`:g`命令的模式。遗憾的是，您无法从以前的搜索中访问以前的匹配组。但是，有一些方法可以实现您的目标。我建议的第一个是宏。

首先从不匹配的行开始。这可以通过在需要时在文件顶部插入一个空行来完成（之后只需将其删除）。

1.  开始宏搜索您的模式：`/name_\d\+`
2.  猛拉直到你的模式结束：`y//e`
3.  找到结束模式：`/end/e`
4.  插入下划线`a_`
5.  粘贴`p`
6.  结束你的宏`q`
7.  执行大量的宏。例如`999@q`

这是我使用的宏：

```
:let @q = "/name_\\d\\+\<cr>y//e\<cr>/end/e\<cr>a_\<esc>p" 
```

另一种方法是以`:global`与您的尝试类似的方式使用该命令。

```
:g/name_\d\+/let @@=matchstr(getline('.'),'name_\d\+')|/end/s//\=submatch(0).'_'.@@/ 
```

我个人这太复杂了，但是有选择是很好的。该命令可以分解为以下部分：

*   `:g/name_\d\+`在匹配 name_ 和某个数字的每一行上执行一个命令
*   `getline('.')`将返回当前行的字符串
*   `matchstr(getline('.'), 'name_\d\+')`将只返回当前行的匹配部分
*   `let @@ = matchstr(...)`将匹配部分设置为默认寄存器
*   `/end/s/``:s`将在匹配的以下行上执行 a`end`
*   `s//\=.../`匹配最后使用的模式并用 express 替换它。
*   `submatch(0).'_'.@@`创建一个包含整个匹配模式的字符串，后跟一个下划线和未命名寄存器的内容。

有关以下主题的更多信息，请参阅：

```
:h q
:h search-offset
:h :g
:h :let-@
:h registers
:h matchstr(
:h getline(
:h range
:h submatch( 
```

# css - 溢出在表格行的顶部而不是下面

> ID：13299450
> 
> 赞同：0
> 
> 时间：2012-11-08T23:04:16.780
> 
> 标签：css, overflow, cell, z-index, css-tables

我遇到了一种情况，其中 a`div`溢出了 a `td`。问题是它以某种方式在其*下方*的内容下方流动，这使得所有内容都难以辨认。我尝试使用`z-index`无济于事。在这里查看我的**[jsFiddle 演示](http://jsfiddle.net/htn2x/)**。

```
td.big { 
    overflow-y:visible;
}
div.clipper { 
    max-height: 5em; 
    overflow-y: hidden;
}
div.clipper:hover {
    overflow-y: visible;
}
tr:hover,
div.clipper:hover .backing {
    background: lightblue;
    z-index: 1;
}

table, tr, td { 
    z-index: 0;
} 
```

我知道从技术上讲`td`根本不应该`overflow`。我的真正目标是防止某些单元格的内容大于某个高度，然后在悬停时显示该内容。是否有唯一的 CSS 解决方案，或者我将不得不做整个`$.clone()`事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:10:30.803

添加`max-height: inherit;`到 .clipper:hover。

```
div.clipper:hover {
    overflow-y: visible;
    max-height: inherit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:14:57.977

z-index 默认情况下不起作用。它仅适用于相对、绝对或固定定位的元素。当您添加`position: relative`到指定 z-index 的 css 部分时，它可以工作。

# url - 如何在相对 URL 中上升一个子域？

> ID：13299452
> 
> 赞同：1
> 
> 时间：2012-11-08T23:04:28.847
> 
> 标签：url, uri

从 的页面`cupcakes.dessert.mysite.com/`，我如何使用相对 URL 来访问图像或样式表`dessert.mysite.com/`？有没有办法在 URI 中指定“返回一个子域”？

我不想使用绝对 URL，`src="http://dessert.mysite.com/images/bg.gif"`因为这种方法需要不同的绝对 URL `salad.mysite.com`，并且可能会覆盖 HTTPS 连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:06:33.367

这是不可能的。

要解决您的第二个问题，请使用协议相对 URL：

```
src="//dessert.mysite.com/images/bg.gif" 
```

# hadoop - Hadoop分布式缓存对象在作业期间更改

> ID：13299453
> 
> 赞同：0
> 
> 时间：2012-11-08T23:04:34.933
> 
> 标签：hadoop, distributed-caching

我有许多有序的 Hadoop 作业，其中我需要一个 DistributedCache 文件。

驱动程序类（控制器）接收来自前一个作业的输入，修改一个文件，将其放置在 DistributedCache 中并开始一个新作业。

在第一份工作（即第二份工作）之后，我收到此错误：

```
java.io.IOException: 
The distributed cache object hdfs://xxxx/xx/x/modelfile2#modelfile2 
changed during the job from 11/8/12 11:55 PM to 11/8/12 11:55 PM 
```

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T07:05:11.910

根据 TrackerDistributedCacheManager.java 方法 downloadCacheObject 中的来源，当此异常发生时，它不会被忽略，并且不会发生从 HDFS 到本地文件系统的实际文件下载。所以任务不会在分布式缓存中找到它的文件。我怀疑您可能两次注册同一个对象，或者，当多个作业将具有相同邮件的文件从同一个控制器的分布式缓存中放入时，hadoop 中可能存在一些错误。

# objective-c - 为类属性赋值的objective c快捷方式

> ID：13299461
> 
> 赞同：0
> 
> 时间：2012-11-08T23:05:06.693
> 
> 标签：objective-c, xcode, cocoa

我不确定我是否使用了正确的术语，请理解我昨天才开始尝试客观，我来自 ac# 背景，所以我可能会使用一些 c# 术语。

照这样说。我有两节课。1个使用另一个类作为属性的主类：

```
@class Fighter;
@interface Match : NSObject{
    int Id;
    Fighter *Fighter;
    int FScore;
}
@property int Id, FScore;
@property Fighter *Fighter;

@end 
```

*执行：

```
@implementation Match
@synthesize Id, FScore, Fighter;    
@end 
```

这是引用的类：

```
@interface Fighter : NSObject{
    int Id;
    NSString *Name;
}
@property int Id;
@property NSString *Name;
@end

@implementation Fighter
@synthesize Id, Name;
@end 
```

现在这就是我创建对象实例的方式

```
@autoreleasepool {

        // insert code here...
        NSLog(@"Hello, World!");

        Match *match = [[Match alloc]init];
        match.Id = 1;
        match.Fighter = [[Fighter alloc]init];
        match.Fighter.Id = 9;
        match.Fighter.Name = @"womp";
    } 
```

现在，我想知道在为 Fighter 实例分配值时是否有捷径。在 c# 中，您可以执行以下操作：

```
match.Fighter = new Fighter{ Id = 9, Name = "womp" }; 
```

想知道以防万一我可以向该类或任何其他类添加更多属性。

PS。

使用 [[Class alloc] init] 是否比 [Class new] 更好？

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:11:23.363

在 Objective-C 中执行此操作的典型方法是创建一个自定义`-init`方法，其中包含要初始化的属性的参数。所以你可能有一个`-[Fighter initWithID:name:]`方法：

```
- (id)initWithID:(NSInteger)id name:(NSString *)name
{
    self = [self init];
    if (self) {
        self.ID = id;
        self.name = name;
    }
    return self;
} 
```

然后你创建你的战斗机对象：

```
match.fighter = [[Fighter alloc] initWithID:9 name:@"womp"]; 
```

对您的代码的一些评论。在 Objective-C 中，属性名称以小写字母开头是惯例。例外情况是，如果属性名称是诸如“ID”或“URL”之类的首字母缩写词，在这种情况下，您将其全部设为大写。方法名和变量名也是如此。大写的名称保留给包括类名在内的类型（例如“Fighter”）。

关于你的 PS 问题，`+new`只需调用 alloc 然后 init 并返回结果，所以它们是完全等价的。也就是说，+new 在 Objective-C 程序员中并不常用，你会看到 alloc/init 的使用频率*更高*。

最后，假设您使用现代 Objective-C 运行时（10.6+ 和 64 位）部署到目标，您不需要显式声明实例变量来支持您的 @properties，因为编译器将合成（创建）它们为你。对于最新版本的 Xcode（4.4 和更高版本），您甚至不需要 @synthesize 语句，因为编译器也会为您插入这些语句。@property 语句就是您所需要的。

# knockout.js - jquery datepicker的敲除绑定，alternate字段应该是天名

> ID：13299462
> 
> 赞同：3
> 
> 时间：2012-11-08T23:05:08.347
> 
> 标签：knockout.js, date-format, jquery-ui-datepicker

我找到了如何使用敲除自定义绑定将 jquery datepicker 附加到输入元素（如[这里](https://stackoverflow.com/questions/6612705/knockout-with-jquery-ui-datepicker)），但我想要一个带有选定日期名称的标签。

就像在 jquery datepicker 中一样，我们得到了 altField 和 altFormat，我们可以设置为 'dddd' 并获取日期名称，这是任何带有 jquery 和淘汰赛的优雅解决方案，因为 jquery 只能填充 altField，而不是 .

还有一个选项可以以这种格式“dd/mm/yy”最初将输入字段与今天的日期绑定吗？

我还在[这里](http://jsfiddle.net/juvastyle/aa4BE/1/)设置了测试示例。

```
var ViewModel = function(){
    var self = this;
    self.date= ko.observable(new Date());
};

ko.applyBindings(new ViewModel());

$(function(){
    $('#dp').datepicker({minDate:0, dateFormat: 'dd/mm/yy'});
});

<div>
    <input id="dp" data-bind="value: date, valueUpdate: 'keyup'" />
    <p>Day in week: <strong data-bind="text: date"></strong></p>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T12:22:14.400

您正在混合原生 jquery 和淘汰赛。切勿直接从您的视图模型中使用 jQUery，这是不好的做法。看看我的装订here

[https://github.com/AndersMalmgren/Knockout.Bindings](https://github.com/AndersMalmgren/Knockout.Bindings)

示例[http://jsfiddle.net/H8xWY/7/](http://jsfiddle.net/H8xWY/7/)

将日期格式添加到选项：

```
<input data-bind="datepicker: date, datepickerOptions: { minDate: new Date(), dateFormat: 'dd/mm/yy' }" /> 
```

# c# - Microsoft.Office.Interop.Outlook 错误 - 文件 filename.ics 不是有效的 Internet 日历文件

> ID：13299464
> 
> 赞同：3
> 
> 时间：2012-11-08T23:05:16.440
> 
> 标签：c#, outlook, interop, visual-studio-2012

我正在尝试在 Web 应用程序上使用 Outlook 2010 日历的内容。为此，我在 IIS 7.5/Windows 2008 R2 机器上设置了启用 WebDAV 的网站。从 Outlook 2010 开始，我将日历发布到我设置的网站，这导致网站文件夹中出现了一个新的 .ics 文件。

现在，为了读取/解析文件的内容，我将该文件复制到我的 VS 2012 机器上，该机器与安装 Outlook 的机器相同。我用这个例子来解析文件：http: [//msdn.microsoft.com/en-us/library/office/bb644609%28v=office.12%29.aspx](http://msdn.microsoft.com/en-us/library/office/bb644609%28v=office.12%29.aspx)

当我在示例中使用此代码（稍作修改）时，我得到 2 个异常，一个在 OpenSharedItem 上表示操作失败，另一个在 OpenSharedFolder 上表示该文件不是有效的 Internet 日历文件。

```
string fileName = "filename.ics";

if (!File.Exists(fileName))
    Console.WriteLine("File Does NOT Exist");
else
    Console.WriteLine("File Exists");

// First try to open the icalendar file as an appointment 
// (not a calendar folder).
object item = null;
try
{
    Application a = new Application();

    item = a.Session.OpenSharedItem(fileName);
    Console.WriteLine("open shared item");
}
catch(System.Exception e)//gets thrown
{
    Console.WriteLine("Open shared item failed");
    Console.WriteLine(e.Message + e.StackTrace);
}

if (item != null)
{
    Console.WriteLine("item not null");

    // Display the item
    OutlookItem olItem = new OutlookItem(item);
    olItem.Display();
    return;
}

// If unsucessful in opening it as an item, 
// try opening it as a folder
Outlook.Folder importedFolder = null;
try
{
    Application a = new Application();              
    importedFolder = a.Session.OpenSharedFolder(fileName, Type.Missing, Type.Missing, Type.Missing) as Outlook.Folder;
    Console.WriteLine("open shared folder");
}
catch (System.Exception e)//gets thrown
{
    Console.WriteLine("Open shared folder failed");
    Console.WriteLine(e.Message + e.StackTrace);
}

// If sucessful, open the folder in a new explorer window
if (importedFolder != null)
{
    //never reached
} 
```

文件名.ics

```
BEGIN:VCALENDAR
PRODID:-//Microsoft Corporation//Outlook 14.0 MIMEDIR//EN
VERSION:2.0
METHOD:PUBLISH
X-CALSTART:20121009T150000Z
X-CALEND:20130102T213000Z
X-CLIPSTART:20121006T050000Z
X-CLIPEND:20130105T060000Z
X-WR-RELCALID:{0000002E-01FB-5DE5-BFA0-7A2B5F98AC2C}
X-WR-CALNAME:Doe\, John
X-WR-CALDESC:
X-PRIMARY-CALENDAR:TRUE
X-PUBLISHED-TTL:PT60M
X-OWNER;CN="Doe, John":mailto:jdoe@mycompany.com
X-MS-OLK-WKHRSTART;TZID="Central Standard Time":080000
X-MS-OLK-WKHREND;TZID="Central Standard Time":170000
X-MS-OLK-WKHRDAYS:MO,TU,WE,TH,FR
BEGIN:VTIMEZONE
TZID:Central Standard Time
BEGIN:STANDARD
DTSTART:16011104T020000
RRULE:FREQ=YEARLY;BYDAY=1SU;BYMONTH=11
TZOFFSETFROM:-0500
TZOFFSETTO:-0600
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:16010311T020000
RRULE:FREQ=YEARLY;BYDAY=2SU;BYMONTH=3
TZOFFSETFROM:-0600
TZOFFSETTO:-0500
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VEVENT
DTEND:20121009T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121009T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:FVI3qgvnnECOutT6Cpus2A==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121009T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121009T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:1pvycFq1HUqwrcPUvvSd9Q==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121010T203000Z
DTSTAMP:20121105T230030Z
DTSTART:20121010T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:GtLjxE2g1EqBQdtFDOUe7w==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121011T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121011T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:W4b2WmjZ6Uu9SEKaObx6dw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121011T210000Z
DTSTAMP:20121105T230030Z
DTSTART:20121011T193000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:nU45vLjlkU23vbmmS5ANPw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121015T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121015T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:qbw5o6Y1HUugYh2RWxeDHw==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121016T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121016T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:V10iWliy10yKQMl/UaLQlQ==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121017T203000Z
DTSTAMP:20121105T230030Z
DTSTART:20121017T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:U3ycfGWWwkOt12msYYEHLw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121018T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121018T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:U8psiL5Roke/iwHrSSbr8g==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121018T210000Z
DTSTAMP:20121105T230030Z
DTSTART:20121018T193000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:mjasBcST7k+jDlXJw/1MQA==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121022T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121022T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:vsYg7aai30GmYQZciLrkuA==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121023T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121023T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:y+3dporUvkq8uqjnnBGm3Q==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121023T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121023T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:gjP1oxozi06EFNPsIvcb7A==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121024T203000Z
DTSTAMP:20121105T230030Z
DTSTART:20121024T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:OD5UhYsBB0+e/lFxl5ubzg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121025T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121025T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:iuN26STSskaIFUQeSPjfBw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121025T210000Z
DTSTAMP:20121105T230030Z
DTSTART:20121025T193000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:jnNtwU6AWkGGBpG6wOZMmA==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121026T150000Z
DTSTAMP:20121105T230030Z
DTSTART:20121026T140000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:SVZHk/EV0Eev8zr1p3bVrg==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121029T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121029T180000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:4+5yxy98ak+fgwy6zrbNRg==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121030T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121030T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:jub5aDFivEGbqhBJwc3Vpg==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121030T200000Z
DTSTAMP:20121105T230030Z
DTSTART:20121030T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:9il1KMwbekKQA4kfjhvljg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121031T210000Z
DTSTAMP:20121105T230030Z
DTSTART:20121031T190000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:PAmC9pXGFEeP8uEVZ2e8GQ==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121101T160000Z
DTSTAMP:20121105T230030Z
DTSTART:20121101T150000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:mzHkS2g/4kiLE9EF1qHP3Q==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121101T210000Z
DTSTAMP:20121105T230030Z
DTSTART:20121101T193000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:UGc1w8m2iEW+BHUxCyd9xg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121106T170000Z
DTSTAMP:20121105T230030Z
DTSTART:20121106T160000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:wi/8np16uESdCzI471NFZA==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121107T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121107T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:Mnf3wC1+CE6qW98clLFycQ==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121108T170000Z
DTSTAMP:20121105T230030Z
DTSTART:20121108T160000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:1fEZ3YnxEk2P4BTzw8dcNw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121108T220000Z
DTSTAMP:20121105T230030Z
DTSTART:20121108T203000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:9KlqqMOAPEi4qFSOhTxImQ==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121113T170000Z
DTSTAMP:20121105T230030Z
DTSTART:20121113T160000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Tentative
TRANSP:OPAQUE
UID:VB9LJPflDkm24bxG0TBX/Q==
X-MICROSOFT-CDO-BUSYSTATUS:TENTATIVE
END:VEVENT
BEGIN:VEVENT
DTEND:20121114T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121114T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:3bIwxwBzEEiNFhFpaQ72tA==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121115T170000Z
DTSTAMP:20121105T230030Z
DTSTART:20121115T160000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:Zm2nzgnCE0yio988QdmWOg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121121T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121121T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:kX2JXLt0YkW/9jEvIM/uGw==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121128T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121128T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:8Z2xP1+j2UyvsXtqk9/x3w==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121129T220000Z
DTSTAMP:20121105T230030Z
DTSTART:20121129T203000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:VaD+s7gJC0qi/m/ZaglYVA==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121205T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121205T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:bq09F62hpkGFaaJnci9rwQ==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121206T220000Z
DTSTAMP:20121105T230030Z
DTSTART:20121206T203000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:gdb/P27fOkOgdnPlsdgQ6g==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121212T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121212T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:zcV/ETzsK0CJ3Luyc/1pZQ==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121213T220000Z
DTSTAMP:20121105T230030Z
DTSTART:20121213T203000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:bSdV5Ln7Ok+GHu1bIrm9yg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121219T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121219T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:7rNe2ZxZp0WvkPf5C0IsNA==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20121226T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20121226T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:2sgn16IkbUycYLaDZFD4Ug==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
BEGIN:VEVENT
DTEND:20130102T213000Z
DTSTAMP:20121105T230030Z
DTSTART:20130102T200000Z
SEQUENCE:0
SUMMARY;LANGUAGE=en-us:Busy
TRANSP:OPAQUE
UID:91urQDvoIkqcLS8xpDscXg==
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
END:VEVENT
END:VCALENDAR 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T15:33:22.233

Can you try full path for file?

example:

```
string fileName = "c:\temp\filename.ics"; 
```

## EDIT:

Reading [OpenSharedItem](http://msdn.microsoft.com/it-it/library/microsoft.office.interop.outlook._namespace.openshareditem.aspx) i find that:

> This method does not support **iCalendar calendar** (.ics) files. To open iCalendar calendar files, you can use the OpenSharedFolder method of the NameSpace object.

but in [opensharedfolder](http://msdn.microsoft.com/it-it/library/microsoft.office.interop.outlook._namespace.opensharedfolder.aspx) i find that:

> This method does not support **iCalendar appointment** (.ics) files. To open iCalendar appointment files, you can use the OpenSharedItem method of the NameSpace object.

**So, our first question is: is this an iCalendar calendar or an iCalendar appointment?** Answering to this we know if we need to use OpenSharedItem or OpenSharedFolder.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T13:16:21.493

OpenSharedItem 仅适用于具有一个 VEVENT 的 ICS 文件。如果 ICS 文件包含一个 VEVENT 并且其他 VEVENTS 是第一个 VEVENT 的例外，则将标题 X-MS-OLK-FORCEINSPECTOROPEN:TRUE 添加到 ICS 文件，例如：

```
BEGIN:VCALENDAR
VERSION:2.0
X-MS-OLK-FORCEINSPECTOROPEN:TRUE 
```

现在 OpenSharedItem 将毫无问题地加载 ics 文件。

# objective-c - 使用 ios sdk 3.0 回复事件

> ID：13299465
> 
> 赞同：1
> 
> 时间：2012-11-08T23:05:17.083
> 
> 标签：objective-c, ios, facebook, facebook-ios-sdk

我无法回复使用新 sdk 和 fql 检索到的 facebook 事件。文档表明我可以向我/事件发送一些 http-post，但它没有说比这更具体的东西，而且这似乎不在新的 sdk 范围内。

那么，有没有办法使用新的 facebook sdk 3.0 for ios 为事件设置 RSVP 状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T01:09:11.257

我找到了答案，以防其他人偶然发现这个问题。

您所要做的就是使用以下方法创建一个 FBRequest 对象：

```
[FBRequest requestForPostWithGraphPath:@"<EVENT ID HERE>/attending" graphObject:nil]; 
```

并启动它。它将当前登录的用户设置为参加活动（只要您具有正确的权限）

# wpf - 自定义路由事件示例

> ID：13299466
> 
> 赞同：1
> 
> 时间：2012-11-08T23:05:23.613
> 
> 标签：wpf

我需要一个完整的示例如何声明..并在使用它之后自定义路由事件。实际上我知道语法，但我不知道如何使它工作以及以后如何使用它。你能给我简单的完整例子吗（vb代码对我来说更好）。例如，单击按钮以在标签上显示文本时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T14:02:37.967

这是我使用自定义的一种简单方法：每当属性更改`RoutedEvent`时触发动画（TextChanged 事件）：`Text``TextBlock`

在这种情况下，我创建了一个派生自`TextBlock`. 出于本演示的目的，我们将其命名为`MyCustomTextBlock`。

首先我们定义`RoutedEvent`：

```
Public Shared ReadOnly TextChangedEvent As RoutedEvent = EventManager.RegisterRoutedEvent("TextChanged", RoutingStrategy.Bubble, GetType(RoutedEventHandler), GetType(MyCustomTextBlock)) 
```

我们定义了RoutedEeventHandler：

```
Public Custom Event TextChanged As RoutedEventHandler

    AddHandler(ByVal value As RoutedEventHandler)
        Me.AddHandler(TextChangedEvent, value)
    End AddHandler

    RemoveHandler(ByVal value As RoutedEventHandler)
        Me.RemoveHandler(TextChangedEvent, value)
    End RemoveHandler

    RaiseEvent(ByVal sender As Object, ByVal e As RoutedEventArgs)
         Me.RaiseEvent(e)
    End RaiseEvent

End Event 
```

接下来，SHADOW`Text`属性声明，以便您可以指定回调方法：

```
Public Shared Shadows TextProperty As DependencyProperty = DependencyProperty.Register("Text", GetType(String), MethodBase.GetCurrentMethod().DeclaringType, New FrameworkPropertyMetadata(String.Empty, New PropertyChangedCallback(AddressOf TextPropertyChanged))) 
```

编辑：在上面的`DependencyProperty`注册中，我`Reflection`用来获取调用类型，因为我使用代码片段来注入`DependencyProperty`注册调用，它使我的片段更加动态。如果您不想导入以下内容，可以将上述调用替换为`Reflection Namespace`：

```
Public Shared Shadows TextProperty As DependencyProperty = DependencyProperty.Register("Text", GetType(String), GetType(MyCustomTextBlock), New FrameworkPropertyMetadata(String.Empty, New PropertyChangedCallback(AddressOf TextPropertyChanged))) 
```

定义将在`Text`值更改时执行的回调方法，提高`RoutedEvent`：

```
Private Shared Sub TextPropertyChanged(ByVal Sender As Object, ByVal e As DependencyPropertyChangedEventArgs)
    DirectCast(Sender, MyCustomTextBlock).RaiseEvent(New RoutedEventArgs(MyCustomTextBlock.TextChangedEvent))
End Sub 
```

这就是代码的全部内容，现在让我们在 XAML 中使用它：

```
<local:MyCustomTextBlock>
    <local:MyCustomTextBlock.Style>
        <Style TargetType="local:MyCustomTextBlock">
            <Style.Triggers>
                <EventTrigger RoutedEvent="local:MyCustomTextBlock.TextChanged">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation To="1.5" Duration="0:0:0.1" Storyboard.TargetProperty="(FrameworkElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleX)" AutoReverse="True"/>
                            <DoubleAnimation To="1.5" Duration="0:0:0.1" Storyboard.TargetProperty="(FrameworkElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleY)" AutoReverse="True"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>
    </local:MyCustomTextBlock.Style>
</local:MyCustomTextBlock> 
```

在上面的触发器中，我只是`TextBlock`在 200 毫秒内放大然后缩小的大小，这给用户一个微妙的手势，即文本已经改变，将他们的注意力带到新的值上。

此外，如果您还没有，请在您的 xaml 页面顶部引用您的程序集：

```
<Window x:Class="MyWindow"
    xmlns:local="clr-namespace:MyRoutedEventProject"/> 
```

为简单起见，让 VisualStudio 为您连接起来。如果您键入`xmlns:local=`，则 Intellisense 应该会弹出一个名称空间列表以供选择。找到项目的基本命名空间并将其插入：

![在此处输入图像描述](../Images/dbb28c0de334a1f079c4a30518300548.png)

这是一个简单的使用`RoutedEvent`，但我经常使用的现实生活用例。我希望它有所帮助。

# python - 我如何读取 n 行，其中 n 是使用 Python 的文件中的第一行？

> ID：13299467
> 
> 赞同：1
> 
> 时间：2012-11-08T23:05:28.057
> 
> 标签：python, io

我需要使用 Python 读取一组坐标文件。第一行将有一个数字*n*，它是需要读取的坐标集的数量。第一行之后将是*n*行，其中每行包含一个坐标对。

示例（在这种情况下，n = 4）：

```
n
(x,y)
(x,y)
(x,y)
(x,y) 
```

**问题是文件中会有多个部分。**所以第一个 n 可能是 10，有 10 组坐标，下一个 n 可能是 20，后面有 20 组坐标。

截至目前，我只是单独读取坐标部分，但如果我可以在我正在读取的文件中包含任意数量的坐标部分，我希望它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:11:54.017

您可以使用[`open()`](http://docs.python.org/3/library/functions.html#open)打开文件进行读取，[`readline()`](http://docs.python.org/3/library/io.html#io.IOBase.readline)逐行读取文件内容，以及[`int()`](http://docs.python.org/3/library/functions.html#int)将字符串转换为整数。

这是使用这些部分的示例实现：

```
def read_coords(file_handle):
    try:
        nrecords = int(file_handle.readline())
    except ValueError:
        return False
    return [file_handle.readline() for i in range(nrecords)]

coord_sets = []
with open("some.txt") as f:
   coords = read_coords(f)
   while coords != False:
       coord_sets.append(coords)
       coords = read_coords(f)

print "coord_sets =",coord_sets 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:31:59.867

研究使用生成器。您可以通过生成器读取第一行，然后它将告诉产生多少行，直到下一次读取：

```
def gen_coord(a_file):
    num = 0
    for line in a_file:
        if num == 0:
            num = int(line)
        else:
            num -= 1
            yield line

source = open("somefile")
coords = gen_coord(source)
for coord in coords:
    print (coord) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:32:56.517

如果我理解正确，您当前正在读取不同的文件，其中前导 n 值后跟 n 个坐标。但是，您想使用单个文件来执行此操作。

您可以做的是创建一个嵌套列表，并根据您的格式将坐标列表附加到主列表中。

```
coord_list = []
myfile = open('coords.txt','r')
while 1:
    coord_count = myfile.readline().replace('\n','')
    if not coord_count:
        break
    coord_list.append([myfile.readline().replace('\n','') for i in range(int(coord_count))])

print coord_list 
```

*   注意：您可能仍然需要转换这些 '(x,y)'s

# jdk1.6 - Netbeans 6.8、JDK 1.6 和简单验证 API

> ID：13299470
> 
> 赞同：2
> 
> 时间：2012-11-08T23:05:33.553
> 
> 标签：jdk1.6, netbeans6.8

我正在使用 Netbeans 6.8 、 JDK 1.6 并下载了 Simple Validation API。当我尝试代码时，它给了我引用“org/openide”类的错误。

这可能是兼容性问题吗？我该如何解决这个问题？

```
Exception in thread "AWT-EventQueue-0" java.lang.NoClassDefFoundError: org/openide/util/Lookup
        at org.netbeans.validation.api.ui.swing.SwingComponentDecorationFactory.getDefault(SwingComponentDecorationFactory.java:154)
        at org.netbeans.validation.api.ui.swing.SwingValidationGroup.<init>(SwingValidationGroup.java:82)
        at org.netbeans.validation.api.ui.swing.SwingValidationGroup.create(SwingValidationGroup.java:87) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-23T23:54:08.347

将“nbstubs.jar”添加到您的类路径中。[从https://kenai.com/projects/simplevalidation/downloads](https://kenai.com/projects/simplevalidation/downloads)下载“所有来源”并在 validation-src.zip\nbstubs\dist 中找到它。

# php - 正则表达式匹配方括号后跟括号，其中方括号还可以包含其他方括号

> ID：13299471
> 
> 赞同：1
> 
> 时间：2012-11-08T23:05:36.200
> 
> 标签：php, regex, preg-replace, preg-match-all

我有一些这样的文本，它是用自定义的 Markdown 样式格式编写的。例如：

```
[Lorem ipsum] 
Dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. 

[Ut wisi] 
[Enim ad minim veniam](a), quis nostrud exerci tation ullamcorper. 
suscipit lobortis nisl ut aliquip ex ea commodo consequat. Duis autem vel eum iriure dolor in hendrerit in vulputate velit esse molestie consequat. 
Vel illum dolore eu feugiat nulla facilisis at vero.
[Ros et accumsan et iusto odio dignissim](b) qui blandit praesent luptatum zzril delenit augue duis dolore te feugait nulla facilisi. 

[[Nam liber]](c)
Tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. 
```

正如您所看到的，标题周围有方括号，并且有方括号后跟包含一个字母的括号，这是我试图与正则表达式匹配的内容。我正在尝试使用的正则表达式是这样的：

```
preg_match_all("#\[(.*?)\]\(([a-z]+)\)#is",$html,$matches) 
```

这个 ^ one 的问题是它从 [Lorem ipsum] 匹配到 (a) 的末尾。

我也可以使用以下内容，但是我需要能够包含带有方括号的标题，因此这不能正常工作：

```
preg_match_all("#\[([^]]+)\]\(([a-z]+)\)#is",$html,$matches) 
```

经过一番阅读，我怀疑我需要的是前瞻，但是我无法理解它们。非常感谢任何帮助。

* * *

**澄清**

我基本上希望能够用方括号/括号组合包装一些文本的任何部分，然后能够将它们与正则表达式匹配，而不会在任何地方导致冲突的现有方括号。示例文本：

```
[[Lorem ipsum]](a)
Dolor sit amet, [consectetuer adipiscing elit](b), sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. 
```

期望的匹配：

```
[[Lorem ipsum]](a)
[consectetuer adipiscing elit](b) 
```

或者……更复杂

```
[[Lorem ipsum]
Dolor sit amet, sed diam nonummy nibh euismod](a) tincidunt ut laoreet dolore magna aliquam erat volutpat. 
```

期望匹配：

```
[[Lorem ipsum]
Dolor sit amet, sed diam nonummy nibh euismod](a) 
```

可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:55:41.803

干得好。

```
preg_match_all("~
    \[(              # open outer square brackets and capturing group
    (?:              # open subpattern for optional inner square brackets
        [^[\]]*      # non-square-bracket characters
        \[           # open inner square bracket
        [^[\]]*      # non-square-bracket characters
        ]            # close inner square bracket
    )*               # end subpattern and repeat it 0 or more times
    [^[\]]*          # non-square-bracket characters
    )]               # end capturing group and outer square brackets
    (?:              # open subpattern for optional parentheses
        \((          # open parentheses and capturing group
        [a-z]+       # letters
        )\)          # close capturing group and parentheses
    )?               # end subpattern and make it optional
    ~isx",
    $input,
    $matches); 
```

一行中的正则表达式：

```
"~\[((?:[^[\]]*\[[^[\]]*])*[^[\]]*)](?:\(([a-z]+)\))?~isx" 
```

[工作演示](http://ideone.com/tkzTcU)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T04:30:18.763

m.buettner 的回答非常好。它既准确又有据可查（它得到了我的支持，值得保留选择的答案）。我真的很喜欢正则表达式以自由间距模式自我记录的事实。但是，为了完整起见（并作为另一种评论风格的演示），这里是一个等效的（但效率更高）的正则表达式解决方案：

```
preg_match_all('/
    # Match a "[...[...]...[...]...](...)" structure.
    \[               # Literal open square bracket.
    (                # $1: Square bracket contents.
      [^[\]]*        # {normal*} Zero or more non-[].
      (?:            # Begin {(special normal*)*}.
        \[[^[\]]*\]  # {special} Nested matching [] pair.
        [^[\]]*      # More {normal*} Zero or more non-[].
      )*             # End {(special normal*)*}.
    )                # $1: Square bracket contents.
    \]               # Literal close square bracket.
    (?:              # Optional matching parentheses.
      \(             # Literal open parentheses.
      ([A-Za-z]+)    # $2: Parentheses contents.
      \)             # Literal close parentheses.
    )?               # Optional matching parentheses.
    /x',
    $input,
    $matches); 
```

改进（主要是外观/风格）：

*   正则表达式包含在`'single quotes'`而不是`"double quotes"`. 使用 PHP，对双引号字符串进行了额外的解释，并且有更多的字符转义序列需要处理（`"$"`特别是字符可能会导致恶作剧）。底线：使用 PHP，最好将正则表达式模式包含在单引号字符串中（即少*反斜杠汤*）。
*   匹配的表达式逻辑`[nested [square bracket] structure]`被重新安排以实现弗里德尔[的](https://rads.stackoverflow.com/amzn/click/com/0596528124 "掌握正则表达式（第 3 版）")“展开循环”效率技术。对于外部方括号没有嵌套方括号的情况，这会导致更少的回溯。
*   捕获组的左括号和右括号（跨越多行）缩进到同一级别（即垂直对齐）以简化视觉匹配。
*   捕获组编号包含在带有左括号和右括号的行的注释中。
*   `s` *单行*修饰符被删除（不需要 - 没有点！）。
*   `i` *忽略大小写*修饰符被删除，受影响的字符类被`[a-z]`更改`[A-Za-z]`为补偿。（在区分大小写的模式下，一些正则表达式引擎运行得更快一些。）
*   文字`"]"`右方括号元字符被显式转义，即 to: `"\]"`。（尽管这不是必需的，但恕我直言，这是一种很好的做法）。
*   捕获组合`$2`并到一行。
*   在正则表达式的顶部添加了一个完整宽度的标题注释，描述了整个正则表达式的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:18:31.020

我认为你只需要稍微调整你的第一个正则表达式：

```
preg_match_all("#\[(.*?)\](?:\(([a-z]+)\))?#is",$html,$matches)
                          ^^^            ^^ 
```

这样，带括号的字母是可选的。

**编辑：**

鉴于澄清，这是一个新的正则表达式：

```
\[((?:[^][]|\[[^][]*?\])*?\](?:\(([a-z]+)\))? 
```

这是[一个 Rubular 演示](http://rubular.com/r/9NvO8SJqUG)。

# ios - 如何在我们支持 iOS 4.3+ 的应用程序中集成 Facebook 的移动广告功能？

> ID：13299474
> 
> 赞同：0
> 
> 时间：2012-11-08T23:05:54.643
> 
> 标签：ios, facebook-ios-sdk

我正在尝试为我的公司进行此设置： [https ://developers.facebook.com/docs/tutorials/mobile-app-ads/](https://developers.facebook.com/docs/tutorials/mobile-app-ads/)

我使用此处的说明将其放入我们的应用程序： [https ://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/3.1/)

从我最初尝试集成和获取数据来看，这似乎只适用于 iOS 6。当我为 iOS 6 模拟器运行应用程序时，它运行良好，但对于运行 iOS 5 的实际设备，它在链接期间失败：
**ld：未找到框架 社交**

这个 FB SDK 功能真的只能在 iOS 6+ 应用程序中工作吗？如果是这样，有谁知道如何与支持 iOS 4.3 到 iOS 6+ 的应用程序集成 FB 移动广告报告。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T19:26:57.387

澄清一下，Facebook iOS SDK 支持操作系统版本 4.3 及更高版本。但是，如果您想使用 iOS6，则需要链接 3 个框架：“Accounts”、“AdSupport”和“Social”。非常重要的是要注意，当您链接这些框架时，您可以将它们设为可选，以避免在 iOS6 之前的设备上运行时出现编译错误。

由于 Facebook SDK 支持 4.3+，因此移动广告安装应与 4.3+ 版本一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T02:38:17.437

新的 SDK 实际上需要 6 个。

不知道是什么导致了错误，但为了消除构建问题，我只是清理了构建文件夹，从项目中删除了派生数据，并删除并重新添加了 facebook 库。

然后为了防止这种情况在 iOS 6 之前的情况下爆炸，我将它添加到我的应用程序中：

```
 + (BOOL)isSocialFrameworkAvailable
{
    static BOOL available = NO;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        available = NSClassFromString(@"SLComposeViewController") != nil;        
    });
    return available;
}

- (BOOL)application: (UIApplication *) application didFinishLaunchingWithOptions: (NSDictionary *) launchOptions
{
    // [...]    

    if ([[self class] isSocialFrameworkAvailable]) {        
        [FBSettings setLoggingBehavior:[NSSet setWithObjects:
                                        FBLoggingBehaviorFBRequests,
                                        FBLoggingBehaviorFBURLConnections,
                                        FBLoggingBehaviorAccessTokens,
                                        FBLoggingBehaviorPerformanceCharacteristics,
                                        FBLoggingBehaviorSessionStateTransitions, 
                                        nil]];
        NSDate *facebookIdPublishedDate = [[NSUserDefaults standardUserDefaults] objectForKey:@"facebookIdPublishedDate"];
        if (!facebookIdPublishedDate) {
            [[NSUserDefaults standardUserDefaults] setObject:[NSDate date] forKey:@"facebookIdPublishedDate"];        
            [FBSettings publishInstall:@"XXXXXXXXXXXXXXXX"];
        }
    }    

    // [...]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:28:36.653

我认为新的 SDK 需要 iOS 5 或 6 - 我认为没有办法在 5 之前的 iOS 版本中使用 3.1 SDK - 有关支持 5 和 6 的详细信息，请参阅[带有 iOS5 和 iOS6](http://facebook.stackoverflow.com/questions/13066619/facebook-with-ios5-and-ios6)的 Facebook，但我不认为这适用于 4

# magento - 在结帐/购物车内插入新块

> ID：13299477
> 
> 赞同：0
> 
> 时间：2012-11-08T23:06:14.913
> 
> 标签：magento

我的插件项目的最终目标是让图像上传到数据库（完成）让它执行一些功能（完成），然后让它由管理员放置在结帐/购物车的某个任意位置（哦，恐怖）。

我首先只是尝试将 .phtml 硬编码到此页面上的任何块中（为了讨论，我们使用“checkout.cart.coupon”）。我的 xml 看起来像这样：

```
<checkout_cart_index>
    <reference name="content">
        <block type="embeds/projecttemplates" name="project.offers.embed" template="project/button.phtml" after="checkout.cart.coupon">
        </block>
    </reference>
</checkout_cart_index> 
```

有了这个，我的块就出现在页面的末尾。将之后更改为之前只是将其一直转移到顶部。使用 before 和 after 的组合仍将其保留在页面顶部。有没有办法让它留在我告诉它的地方而不必求助于原型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T03:06:37.340

如果您想要一个名为“new”的块在优惠券块内呈现，您必须做两件事，因为优惠券块使用模板。

第 1 步：通过使“新”块成为父块的子块

```
<reference name="checkout.cart.coupon" /> 
```

或通过使用

```
parent="checkout.cart.coupon" 
```

块声明中的属性。

第 2 步：自定义优惠券模板，使其呈现您的块：

```
<?php echo $this->getChildHtml('project.offers.embed') ?> 
```

如果您想获得所有形而上学的深度**而不**使用模板，您*可以*执行以下操作，这将是甜蜜的：

```
<checkout_cart_index>
    <reference name="content">
        <block type="core/text_list" name="coupon.and.offers" as="coupon">
            <!--
                This block will displace the existing coupon block by alias,
                but sill leave the coupon block instance in layout so it
                can be added as a child.
            -->
            <action method="insert">
                <block>checkout.cart.coupon</block>
            </action>
            <block type="embeds/projecttemplates" name="project.offers.embed" template="project/button.phtml" after="checkout.cart.coupon" />
        </block>
    </reference>
</checkout_cart_index> 
```

# c# - SSL 证书。HTTPS。自签名。导入到 Visual Studio 以保护数据传输

> ID：13299481
> 
> 赞同：0
> 
> 时间：2012-11-08T23:06:34.897
> 
> 标签：c#, silverlight, ssl, https, certificate

我一直在 Windows 7 IIS（最新版本）中使用自签名证书进行测试。

我已将其配置为与我已发布的 silverlite 项目一起使用。

问题是，在我的登录屏幕上，我查询服务以查看我的网关服务是否在线。

然后我收到一大堆错误消息，说明“混合内容”，这些导致网络浏览器冻结！

我认为这是来自 silerlight 应用程序中传输的数据。

如何在 Visual Studio 中使用我的自签名证书将 HTTPS 放在后端查询中，以便 Web 浏览器可以正常处理应用程序和服务器之间的数据传输？

请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:20:55.870

来自浏览器的混合内容警告通常意味着主页正在使用 HTTPS，但该页面上子元素的 URL 引用（例如图像或脚本的 URL）是 HTTP。

将页面从运行 HTTP 切换到 HTTPS 时，在页面上下文中加载的*所有*URI（图像、脚本、AJAX 内容）必须使用相同的 URI 方案 (HTTPS)，否则该页面不被认为是真正安全的。

# google-bigquery - 在 bq 命令行工具中一次查询大量表

> ID：13299483
> 
> 赞同：1
> 
> 时间：2012-11-08T23:07:05.737
> 
> 标签：google-bigquery

使用 bq 命令行工具时可以查询的表数有上限吗？

我有按日期“分片”（使用表）的时间序列数据。我在 152 天内运行以下查询：

```
SELECT LEFT(FORMAT_UTC_USEC(UTC_USEC_TO_DAY(timestamp*1000000)),10) as day, loc, count(*) FROM 
[mydata.20120601],
[mydata.20120602],
[usage_production.20120603],
[mydatan.20120604],
[mydata.20120605],
[mydata.20120606],
:
:
[mydata.20121031]
WHERE REGEXP_MATCH(actiondata, "up=[0-9]")
GROUP by day,loc
ORDER by day; 
```

此查询返回从 BigQuery Web 界面执行时我期望的数据，但是当我从 bq 命令工具运行时，我只得到前 22 天的数据。

我正在使用以下命令行：

```
bq query --format=csv 'query' 
```

在 Ubuntu 上使用 bq

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T02:52:03.473

您可以在 BigQuery 查询中引用的表数量没有硬性限制，但查询必须[在 10kb 范围内](https://developers.google.com/bigquery/docs/quota-policy#queries)。

bq 客户端当前有一个[默认限制，即显示](http://code.google.com/p/google-bigquery-tools/source/browse/bq/bq.py#868)来自查询的 100 条结果记录。但是，您可以使用该`--max_rows`标志来更改此值：

```
bq query --format=csv --max_rows 5000 'SELECT title FROM publicdata:samples.wikipedia LIMIT 5000' 
```

# java - 从网站复制到 JTextPane 给了我不需要的格式和 html 标签

> ID：13299485
> 
> 赞同：2
> 
> 时间：2012-11-08T23:07:15.917
> 
> 标签：java, html, swing, paste, jtextpane

以下是一些背景信息：

我有一个扩展 JTextPane 的类，当您将文本从网站复制到其中时，它会给我不需要的格式元素和标签。iframe、字体等。 JTextPane 的类型是 html/text 并且需要保持这种方式，因为我在代码的另一部分中将链接更改为可点击链接。

据我所知，当我从网络复制并粘贴到 JTextPane 时，它​​会自动尝试保持格式化，我不希望这种情况发生。

有些事情要记住，我正在使用 HTMLEditorKit，我不想在我的存储库中添加另一个大型工具。有没有一种简单的方法可以让我只获取文本而不是所有元素和格式来粘贴它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T15:11:39.410

我建议你开始：

```
 editorKit = new HTMLEditorKit();
    setEditorKit(editorKit);

    htmlDoc = (HTMLDocument) editorKit.createDefaultDocument();
    htmlDoc.setPreservesUnknownTags(false); 
```

然后你可以使用：

```
 DataFlavor htmlFlavor = new DataFlavor("text/html;class=java.lang.String");

    String html = (String) clipboard.getData(htmlFlavor);
    editorKit.read(new StringReader(html), htmlDoc, 0); 
```

我把剩下的交给你自己。但如果您使用 HTML，我真的建议您使用 JSoup。它非常轻巧，功能强大且非常有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T22:59:32.703

如果您不想使用 DefaultEditorKit，而只想将文本复制粘贴到 HtmlEditorKit，您可以尝试编写自己的粘贴代码，

```
textPane.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_V, ActionEvent.CTRL_MASK), "paste");

textPane.getActionMap().put("paste", pasteAction);

class PasteAction extends AbstractAction {

        @Override
        public void actionPerformed(ActionEvent e) {
            try {
                int offset = textPane.getSelectionStart();
                Document sd=textPane.getDocument();
                String value = getClipboard();
                sd.remove(textPane.getSelectionStart(), textPane.getSelectionEnd()-textPane.getSelectionStart());
                textPane.getDocument().insertString(offset, value , null);
                if (value != null) {
                    textPane.setCaretPosition(offset + value.length());
                }
            } catch (Exception exc) {
                exc.printStackTrace();
            }
        }

} 
```

并使用此代码从剪贴板中获取纯文本，

```
public String getClipboard() throws ClassNotFoundException, UnsupportedFlavorException {
    Transferable t = Toolkit.getDefaultToolkit().getSystemClipboard().getContents(null);
    DataFlavor htmlStringFlavor = new DataFlavor("text/plain; class=java.lang.String");
    try {
        if (t != null && t.isDataFlavorSupported(htmlStringFlavor)) {
            String text = (String) t.getTransferData(htmlStringFlavor);
            return text;
        }
    } catch (UnsupportedFlavorException e) {
    } catch (IOException e) {
    }
    return null;
} 
```

如果您有菜单项、工具栏或其他触发器，请不要忘记将“粘贴”操作绑定到它们。

# java - 修剪空白

> ID：13299488
> 
> 赞同：-3
> 
> 时间：2012-11-08T23:07:29.463
> 
> 标签：java

是否有任何内置方法可以仅从字符串中修剪尾随空格？类似于其他语言的 rtrim

示例：字符串 str1 = "stackoverflow"; 字符串 str2 = "堆栈溢出";

应该变成，

str1 = "堆栈溢出"; str2 = "堆栈溢出";

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:13:36.027

检查[源代码](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/java/lang/String.java.html)并`String.trim()`修改它怎么样？

在开头或结尾禁用空格删除是注释掉一行的问题......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:07:59.417

String 有一个叫做[trim() 的方法；](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#trim%28%29)

`str1.trim();`将为您完成工作。

更新：

如果您不想 trim() 前导空格，您可能需要按照 DNA 的建议编写自己的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:16:32.183

您可以使用正则表达式或迭代字符串以删除空白字符。

无论哪种方式，您都应该在此处阅读文档： [Java String](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T23:12:32.657

有很多方法可以做到这一点，正则表达式就是其中之一：

要删除尾随空格：

```
s/\s+$// 
```

删除前导空格有点相关，但可能不是您要查找的内容：

```
s/^\s+// 
```

PS：我相信你的意思是说尾随空格，因为前导空格意味着空格先出现。

# php - laravel 原始查询 last_insert_id

> ID：13299493
> 
> 赞同：5
> 
> 时间：2012-11-08T23:07:40.370
> 
> 标签：php, laravel, last-insert-id

有没有办法`last_insert_id`在使用 laravel 的原始查询时获得？

`DB::query('INSERT into table VALUES ('stuff') ')`

这将返回 true 或 false。有没有办法在 Laravel 中使用原始查询获取 last_insert_id ？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-05-06T00:29:03.343

只是那些可能对 laravel 4 有同样问题的人的好处，@haso-keric 的回复有轻微的语法变化。

这是：

```
$id = DB::table('users')-> insertGetId (array('email' => 'example@gmail.com')
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-08T23:10:24.393

试试`DB::Query('SELECT LAST_INSERT_ID()')`？

（这是特定于数据库产品的，我给出的示例是针对 MySQL/MariaDB 的。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-04T15:39:28.993

对于 Laravel 4：

`$id = DB::select('SELECT LAST_INSERT_ID()');`

解释：

`when using the lovely Laravel 4 PHP framework for websites etc, you should refer to the "DB::Select" function instead of "DB::Query" for raw queries. As "DB::Query" throws an error. I believe this is because its deprecated from v3, or plain doesn't exist. Yours, Smith.`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T01:14:42.317

插入具有自动递增 ID 的记录？您可以使用 insert_get_id 方法插入记录并检索 ID：

$id = DB::table('users')->insert_get_id(array('email' => 'example@gmail.com')); 注意： insert_get_id 方法要求自动递增列的名称为“id”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-03T17:09:38.237

只需使用底层 PDO 实例：

```
DB::connection()->getPdo()->lastInsertId(); 
```

# r - 减少 grid.arrange 图之间的空间

> ID：13299496
> 
> 赞同：11
> 
> 时间：2012-11-08T23:07:55.093
> 
> 标签：r, ggplot2, gridextra

[我在这里](https://stackoverflow.com/questions/13294952/left-align-two-graph-edges-ggplot)问了一个关于网格排列的问题，得到了很好的回应。我现在想减少地块之间的空间，但出现错误。首先我介绍有效的代码，然后介绍错误代码（我尝试过的）。我实际上找不到`grid.arrange`并且一直认为它来自，`gridExtra`但我可能不正确。

所以2部分：

1.  如何使用网格排列减少绘图之间的空间
2.  我在哪里可以找到关于`grid.arrange`（Baptiste 我知道你维护 gridExtra 的文档，所以如果我没有按照预期的方式使用它，请更正我的想法或对包的使用。）

**好代码坏空间**

```
require(ggplot2);require(gridExtra)
A <- ggplot(CO2, aes(x=Plant)) + geom_bar() +
    coord_flip() + ylab("")
B <- ggplot(CO2, aes(x=Type)) + geom_bar() +coord_flip() 

 gA <- ggplot_gtable(ggplot_build(A))
 gB <- ggplot_gtable(ggplot_build(B))
 maxWidth = grid::unit.pmax(gA$widths[2:3], gB$widths[2:3])
 gA$widths[2:3] <- as.list(maxWidth)
 gB$widths[2:3] <- as.list(maxWidth)
 grid.arrange(gA, gB, ncol=1) 
```

**错误的代码（我的尝试）**

```
require(ggplot2);require(gridExtra)
A <- ggplot(CO2, aes(x=Plant)) + geom_bar() +
    coord_flip() + ylab("") + theme(plot.margin= unit(1, "cm"))
B <- ggplot(CO2, aes(x=Type)) + geom_bar() +coord_flip() 

 gA <- ggplot_gtable(ggplot_build(A))
 gB <- ggplot_gtable(ggplot_build(B))
 maxWidth = grid::unit.pmax(gA$widths[2:3], gB$widths[2:3])
 gA$widths[2:3] <- as.list(maxWidth)
 gB$widths[2:3] <- as.list(maxWidth)
 grid.arrange(gA, gB, ncol=1) 
```

**错误：**

```
Error in `[.unit`(theme$plot.margin, 2) : 
  Index out of bounds (unit subsetting) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T23:20:52.710

我误解了ggplot：

```
require(ggplot2);require(gridExtra)
A <- ggplot(CO2, aes(x=Plant)) + geom_bar() +
    coord_flip() + ylab("") + theme(plot.margin= unit(c(1, 1, -1, 1), "lines"))
B <- ggplot(CO2, aes(x=Type)) + geom_bar() +coord_flip() + 
    theme(plot.margin= unit(rep(.5, 4), "lines"))

 gA <- ggplot_gtable(ggplot_build(A))
 gB <- ggplot_gtable(ggplot_build(B))
 maxWidth = grid::unit.pmax(gA$widths[2:3], gB$widths[2:3])
 gA$widths[2:3] <- as.list(maxWidth)
 gB$widths[2:3] <- as.list(maxWidth)
 grid.arrange(gA, gB, ncol=1) 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-05-05T09:02:14.270

Yes, The [doc](http://docs.ggplot2.org/current/theme.html) says: plot.margin | margin around entire plot (unit with the sizes of the top, right, bottom, and left margins)

# sharpsvn - SharpSVN 工作副本锁定（清理不清理）

> ID：13299499
> 
> 赞同：6
> 
> 时间：2012-11-08T23:08:05.330
> 
> 标签：sharpsvn

我正在使用 SharpSVN 作为服务器拉取解决方案的一部分。程序从配置文件中读取一个修订，如果不匹配，它会更新到指定的修订。

这似乎在我的开发人员机器上正常工作，但是当我将它推送到我的服务器时，我收到“工作副本 XXXXXXX'锁定”错误。“TortoiseSVN 可以正确更新 wc。用于清理的 TortoiseSVN 也可以正常工作。

我试图捕捉“锁定”错误并调用“解锁”，但该函数表明 wc 未锁定。我还尝试捕获错误并从 SharpSVN 调用“清理”，但这会导致错误指示“尝试写入只读数据库”。

我已经删除了 SVN 工作副本并重新签出。我已将其移至新位置。我已经更改了权限。我已经更改了只读标志。没有任何效果。

这似乎与其他一些错误相似，但其中大部分是通过“清理”或删除来解决的。

有什么建议、想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T15:32:45.553

This may have been an issue with TortoiseSVN, or a combination between TortoiseSVN and SharpSVN. After coding a checkout into my program, which would first checkout the code before any subsequent updates, it seems be be working properly.

Thanks.

# javascript - 如何使用 javascript 将两个文本字段相乘并将结果输出到另一个文本字段

> ID：13299500
> 
> 赞同：0
> 
> 时间：2012-11-08T23:08:07.263
> 
> 标签：javascript, jquery, ajax

我正在使用此代码

```
 <script type="text/javascript">
    $(function() {
        $("#addAll2").click(function() {
            var add = 0;
            $("#discount") = $dis
            $(".amt2").each(function() {
                add += document.getElementById('subtotal').value * document.getElementById('discount').value / 100;
            });
            $("#discountamt").val(add.toFixed(2));
        });
    });
</script>
<script type="text/javascript">
    $(function() {
        $("#addAll").click(function() {
            var add = 0;
            $(".amt").each(function() {
                add += Number($(this).val());
            });
            $("#subtotal").val(add.toFixed(2));
        });
    });
</script>
<script type="text/javascript">
    $(function() {
        $("#addAll3").click(function() {
            var add = 0;
            $(".amt3").each(function() {
                add += Number($(this).val());
            });
            $("#sum").val(add.toFixed(2));
        });
    });
</script> 
```

除了这些字段：

```
 <fieldset>
  <legend>Items</legend>
  <table>
    <thead>
      <tr>
        <th scope="col" width="100px">ALU</th>
        <th scope="col" width="400px">Item Name</th>
        <th scope="col" width="100px">Item Price</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input name="alu1" id="alu1" type="text" size="15" /></td>
        <td><input name="itemname1" id="itemname1" type="text" size="75" /></td>
        <td>$
          <input name="price1" id="price1" class="currency amt amt1" type="text" size="14" value="0.00" /></td>
      </tr>
    </tbody>
  </table>
  <button>Add Row</button>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> 
  <script>
    $(document).ready(function($)
    {
        // trigger event when button is clicked
        $("button").click(function()
        {
            // add new row to table using addTableRow function
            addTableRow($("table"));
            // prevent button redirecting to new page
            return false;
        });

        // function to add a new row to a table by cloning the last row and 
        // incrementing the name and id values by 1 to make them unique
        function addTableRow(table)
        {
            // clone the last row in the table
            var $tr = $(table).find("tbody tr:last").clone();
            // get the name attribute for the input and select fields
            $tr.find("input,select").attr("name", function()
            {
                // break the field name and it's number into two parts
                var parts = this.id.match(/(\D+)(\d+)$/);
                // create a unique name for the new field by incrementing
                // the number for the previous field by 1
                return parts[1] + ++parts[2];
            // repeat for id attributes
            }).attr("id", function(){
                var parts = this.id.match(/(\D+)(\d+)$/);
                return parts[1] + ++parts[2];
            });
            // append the new row to the table
            $(table).find("tbody tr:last").after($tr);
        };
    });
    </script>
 <div class="fieldline" style="text-align:right;">
   <input id="addAll" type="button" value="Calculate Subtotal" />
    <label>Subtotal: $
    <input size="18" name="subtotal" id="subtotal" class="amt2 amt3" type="text" value="0.00" />
    </label>
    </div>
    <div class="fieldline" style="text-align:right;">
    <label>Discount:
    <input size="18" name="discount" id="discount" type="text" value="00" />%
    </label>
    </div>
    <div class="fieldline" style="text-align:right;">
    <input id="addAll2" type="button" value="Calculate Discount" />
    <label>Discount Amount: $
    <input size="18" name="discountamt" id="discountamt" class="amt3" type="text" value="0.00" />
    </label>
    </div>
  <div class="fieldline" style="text-align:right;">
    <label>Shipping Method:
      <select name="shipmeth" id="shipmeth" onchange="MM_jumpMenu('parent',this,0)">
        <option></option>
        <option value="freeups">FREE UPS Ground</option>
        <option value="upsground">UPS Ground</option>
        <option value="ups2">UPS 2nd Day</option>
        <option value="ups3">UPS 3rd Day</option>
        <option value="ups1">UPS Next Day Air</option>
        <option value="upscanada">UPS Canada</option>
        <option value="uspsint">USPS International</option>
        <option value="dhlint">DHL International</option>
        <option value="freeship">Free Shipping Override</option>
      </select>
    </label>
  </div>
  <div class="fieldline" style="text-align:right;">
    <label>Shipping Cost: $
      <input size="18" name="shipcost" id="shipcost" class="amt3" type="text" value="0.00" />
    </label>
  </div>
  <div class="fieldline" style="text-align:right;">
    <input id="addAll1" type="button" value="Calculate CA TAX" />
    <label>Sales Tax: $
      <input name="salestax" type="text" id="salestax" class="amt3" size="18" value="0.00" />
    </label>
  </div>
  <div class="fieldline" style="text-align:right;">
    <input id="addAll" type="button" value="Calculate Total" />
    <label>Total:
      <input size="18" required="required" name="sum" id="sum" type="text" value="0.00" />
    </label>
  </div>
</fieldset> 
```

我有它，所以它计算小计并将其放入。但是当我尝试允许它获取折扣字段并乘以它然后除以 100 时，输出折扣金额字段中的结果。它似乎不起作用。我也尝试过不同的变化。

如果我能获得折扣，我应该能够让它计算剩余部分到 Total 字段中。

谢谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:20:16.783

线

```
$("#discount") = $dis 
```

在我看来不正确 - 尝试删除它。我在这个[JSFiddle](http://jsfiddle.net/r9snx/)中对其进行了评论，它似乎可以满足您的要求。

# haskell - 来自 GHCi 提示的加载警告

> ID：13299501
> 
> 赞同：19
> 
> 时间：2012-11-08T23:08:09.370
> 
> 标签：haskell, warnings, ghci

`-Wall`使用 GHCi 时，我想知道从提示符（重新）加载时如何使用该选项。

例如在[Haskell Programming Tips](http://www.haskell.org/haskellwiki/Haskell_programming_tips)的第 3.3 节 中，带守卫的例子如下：

```
-- Bad implementation:
fac :: Integer -> Integer
fac n | n == 0 = 1
      | n /= 0 = n * fac (n-1)

-- Slightly improved implementation:
fac :: Integer -> Integer
fac n | n == 0    = 1
      | otherwise = n * fac (n-1) 
```

它说“第一个问题是编译器几乎不可能检查这样的保护是否详尽无遗，因为保护条件可能非常复杂（如果你使用 -Wall 选项，GHC 会警告你）。”

我知道我可以`ghci -Wall some_file.hs`从命令行输入，但是一旦在提示符中，我不确定如果我想重新加载如何检查警告。

尝试谷歌后我似乎无法找到答案！

提前致谢！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-08T23:38:47.930

在 ghci 中，输入

```
:set -Wall 
```

如果你想关闭所有警告，你可以这样做

```
:set -w 
```

（注意小写`w`。大写将打开正常警告。）

在[用户指南](http://www.haskell.org/ghc/docs/latest/html/users_guide/ghci-set.html#ghci-cmd-line-options)中，它说我们可以在命令提示符下使用任何 ghc 命令行选项，只要它们被列为动态，我们可以从[标志参考](http://www.haskell.org/ghc/docs/latest/html/users_guide/flag-reference.html)中看到所有警告设置都是动态的。

这是一个示例会话，使用上面的“错误实现”：

```
Prelude> :l temp.hs
[1 of 1] Compiling Main             ( temp.hs, interpreted )
Ok, modules loaded: Main.
(0.11 secs, 6443184 bytes)

*Main> :set -Wall

*Main> :l temp.hs
[1 of 1] Compiling Main             ( temp.hs, interpreted )

temp.hs:3:1:
    Warning: Pattern match(es) are non-exhaustive
             In an equation for `fac': Patterns not matched: _

Ok, modules loaded: Main.
(0.14 secs, 6442800 bytes) 
```

# c# - 将 INT 传递给存储过程失败

> ID：13299502
> 
> 赞同：5
> 
> 时间：2012-11-08T23:08:16.040
> 
> 标签：c#, sql-server, stored-procedures, int

我正在尝试将`CommandArgument`as传递`int`给我的存储过程，但我得到：

> *无法将参数值从 String 转换为 Int32*

即使它在我通过它之前被转换......

C#代码：

```
cmd.CommandText = "deleteProd";
int delprodID = Convert.ToInt32(e.CommandArgument.ToString());

Response.Write(delprodID);

cmd.Parameters.Add(new SqlParameter("@prodID", SqlDbType.Int)).Value = delprodID;
cmd.CommandType = CommandType.StoredProcedure;

sqlTools.cmdToNonQuery(cmd) 
```

我的`Response.Write`显示我在 中获得了正确的 ID `delprodID`。

存储过程：

```
ALTER PROCEDURE dbo.deleteProd @prodID int
AS
IF @prodID > 0
BEGIN
    DELETE FROM products WHERE prodID = @prodID
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:39:30.503

3个月前我遇到了同样的问题，无法解释发生了什么。不知何故，您必须显式声明参数，设置它，然后将其添加到 Parameters 属性。它只发生在 SQL Server 上，而不是在 Access 上。我知道这基本上是相同的代码，但这对我有用，不要问我为什么：

```
SqlParameter param = new SqlParameter("@prodID", SqlDbType.Int);
param.Value = delprodID;
cmd.Parameters.Add(param); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:18:19.507

尝试使用[SqlParameterCollection.AddWithValue 方法](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.addwithvalue.aspx) 它将大大简化事情。

```
cmd.CommandText = "deleteProd";
int delprodID = Convert.ToInt32(e.CommandArgument.ToString());
Response.Write(delprodID);
cmd.Parameters.AddWithValue("@prodID", delprodID);
cmd.CommandType = CommandType.StoredProcedure;
sqlTools.cmdToNonQuery(cmd) 
```

# oracle - PLSQL 包变量参考

> ID：13299503
> 
> 赞同：0
> 
> 时间：2012-11-08T23:08:26.483
> 
> 标签：oracle, plsql

我有一个调用包 Call_Package 的函数。在这个包中我有一个过程Validate_Procedure，在这个过程中我有一个变量Entity_Flag。

该函数这样调用我的包：

```
BEGIN
Call_Package(<params>);
END 
```

'Call_Package' 包含我的过程 Validate_Procedure 如下：

```
Validate_Procedure(<paramA>, <paramB>) 
```

在这个过程中，我做一些事情，就像平常一样：

```
Validate_Procedure(<params>) IS
BEGIN
 IF <paramA> THEN
  Entity_Flag = 1
 Else <paramB> THEN
  Entity_Flag = 2
 END IF
END 
```

我的问题是，我可以在原始函数中引用过程变量，如下所示：

```
BEGIN
Call_Package(<params>);
IF Call_Package.Validate_Procedure.Entity_Flag = 2 THEN
   {do stuff}
END IF
END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:15:14.370

首先，您不能调用包。包不是可执行实体。它只是过程、函数、包变量等的集合。

如果`Entity_Flag`是`Validate_Procedure`过程中的局部变量，则不能从外部引用它`Validate_Procedure`。但是，在您发布的显示`Validate_Procedure`过程如何定义的代码中，您没有声明`Entity_Flag`. 这可能是疏忽，也可能表明这`Entity_Flag`根本不是局部变量。也许它是一个包全局变量。如果变量在包规范中定义，您可以在包外引用它，如`Call_Package.Entity_Flag`. 但是，如果变量是在包主体中定义的，则只能从包主体中定义的另一个 PL/SQL 块内部引用它。

# java - ChatClient 出现奇怪的线程

> ID：13299504
> 
> 赞同：3
> 
> 时间：2012-11-08T23:08:30.943
> 
> 标签：java, multithreading, sockets, client

我试图让两个人连接到服务器，并且服务器在他们之间建立连接。然后他们可以互相交谈。如果你看到说“HEREEEEEEEEEEEEEEEEEE”的评论，我有一个thread.sleep，出于某种奇怪的原因，它与thread.sleep()一起工作，但是如果我把它拿出来，如果有的话，只有一个人可以发送给他们的伙伴没有thread.sleep();

PS它也可以使用`System.out.println`，而不仅仅是thread.sleep

我还有更多文件要处理，但是加载它们很痛苦，并且希望这是人们知道的常见问题。

任何帮助表示赞赏。

```
import java.io.PrintWriter;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.Socket;

public class ConnectedClient extends Thread
{

  private Socket cSocket;       //Client's Socket
  private PrintWriter cout;     //write to Client
  private BufferedReader cin;   //Read from Client
  private String cip;           //Clients IP

  private Socket pSocket;       //Partner's Socket
  private PrintWriter pout;     //Write to partner
  private String pip;           //Partner's ip

  private Server srvr;          //Current server

  public ConnectedClient(Socket skt, Server s)
  {
    try
    {
      //Client information
      cSocket = skt;
      cout = new PrintWriter(cSocket.getOutputStream(), true);
      cin = new BufferedReader(new InputStreamReader(cSocket.getInputStream()));
      //Partner's information
      pSocket = null;
      pip = null;
      pout = null;

      //Server and thread
      srvr = s;
      start();
    }
    catch(Exception E)
    {
      System.out.println(E);
    }
  }

  public void run()
  {
    String data;
    System.out.println("Connected to client");
    try
    {
      //Get the ip address and add it to server's table
      while(!cin.ready()){}
      cip = cin.readLine();
      srvr.addToIpTable(cip, cSocket);

      ////Waiting for another client//
      while(pSocket == null) {Thread.sleep(10);} // HEREEEEEEEEEEEEEEEEEEEEE
      System.out.println("Found a partner");
      pout = new PrintWriter(pSocket.getOutputStream(), true);
      System.out.println("I am here");
      cout.println("Done");

      while(true)
      {
        //Waits for a message
        while(!cin.ready()){}
        data = cin.readLine();

        //Outputs message to partner
        pout.println(data);
        pout.flush();
        //End when exit is typed
        if(data.equals("exit"))
          break;
      }

      //Cleanup
      cSocket.close();
      pSocket.close();
      cout.close();
      cin.close();
    }
    catch(Exception E)
    {
      System.out.println(E);
    }
  }

  public String getCip()
  {
    return cip;
  }

  public Socket getCSocket()
  {
    return cSocket;
  }

  public void setPartner(String partnerIp, Socket socket)
  {
    pip = partnerIp;
    pSocket = socket;
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:10:00.117

尝试使 pSocket 易失 - 在繁忙的等待期间，它将在缓存中，并且当其他线程更改它时永远不会更新。

您可能仍然想要一个小睡眠，以避免在等待时 100% 使用核心。

# java - 具有不同上下文根的单耳中的多个战争文件

> ID：13299506
> 
> 赞同：3
> 
> 时间：2012-11-08T23:09:00.157
> 
> 标签：java, jakarta-ee, web-applications, servlets, weblogic

我有一个 ear 文件和两个 war 文件 application.xml 文件的配置如下

```
<module id="myeclipse.1312xxxxxxx">
    <web>
      <web-uri>first.war</web-uri>
      <context-root>/first</context-root>
    </web>
  </module>
  <module id="myeclipse.134xxxxxxxxx">
    <web>
      <web-uri>second.war</web-uri>
      <context-root>/second</context-root>
    </web>
  </module> 
```

当我在本地 weblogic 服务器中部署它时，它工作正常，但是当我将它部署在服务器中时，first.war 工作正常，但 second.war 不是。当我尝试从 second.war 文件中访问某些页面时，例如

> “http://host:port/second/somepage.html”

，我收到错误 404-找不到对象异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T01:02:06.350

听起来像是您要部署到的非本地 WebLogic 服务器实例的类加载器问题，因为它适用于本地部署。尝试使用类加载器分析工具 (CAT) 进行故障排除 - [http://docs.oracle.com/cd/E23943_01/web.1111/e13706/classloading.htm#WLPRG495](http://docs.oracle.com/cd/E23943_01/web.1111/e13706/classloading.htm#WLPRG495)

# c# - 我可以在 VS2010 Express 中实现 SQL Server 2012 LocalDB

> ID：13299509
> 
> 赞同：1
> 
> 时间：2012-11-08T23:09:29.680
> 
> 标签：c#, sql-server, database, localdb

我在网上查了一下，找不到这个问题的直接答案。

SQL Server 2012 Express 有一个新特性`[LocalDB]`。安装后，我在 C# Express 2010 中看不到任何新项目（添加新项目对话框）。

我想在我的应用程序中实现这一点。有人可以告诉我如何`LocalDB`在我的 C# 2010 Express 中创建一个实例还是不能完成？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:41:46.943

安装 SQL Server 2012 Express 的 LocalDB 版本不会启用 Visual C# 2010 Express 中的任何新功能。但是，您可以在使用 C# 2010 开发的应用程序中使用 LocalDB。请参阅此博客文章开始：[在 Visual Studio 2010 中使用 LocalDB](http://blogs.msdn.com/b/sqlexpress/archive/2011/11/28/using-localdb-in-visual-studio-2010.aspx)。

# mysql - MySQL查询的连接结果，使用组和多个表

> ID：13299511
> 
> 赞同：0
> 
> 时间：2012-11-08T23:09:35.923
> 
> 标签：mysql, group-by, distinct, concat, group-concat

我对 MySQL 查询有一些问题。

我有 5 个表（括号中的键）：

```
trips (tripId)
trips_moments (tripId, momentId)
moments (momentId)
moments_images (momentIs, imageId)
images (imageId) 
```

在我的情况下，我有 1 次旅行，其中包含 2 个时刻，每个时刻包含 5 个图像。

我希望结果能进入“时刻”：

```
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;6;F50MTTZK;jpg;6R2XJB9X|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;19;66B7VQ84;jpg;ILQYDQUC 
```

代替：

```
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;6;F50MTTZK;jpg;6R2XJB9X|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;7;9PY1BZD1;jpg;TP7U07ST|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;8;VPGPFMMS;jpg;VF95BNNQ|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;9;EC7NL3HC;jpg;PD1CEQE6|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;10;8J1OT7IT;jpg;ZL8WAWCJ|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;19;66B7VQ84;jpg;ILQYDQUC|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;20;HZIPGJY7;jpg;FOOWJ8BV|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;21;9JOXXPJQ;jpg;ZIVJ5V7K|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;22;IS1JPW1N;jpg;31M4XVBM|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;23;OTOWNDZA;jpg;C03UFMBK 
```

您可以在我的结果中看到 166 和 167 的记录被重复的次数与图像时刻包含的次数一样多。

我目前的查询：

```
 SELECT 
`t`.`tripId`, 
`t`.`title`, 
`t`.`when`, 
GROUP_CONCAT(
  DISTINCT(
    CONCAT(
       m.momentId, ';', m.title, ';', m.created, ';', i.imageId, ';', i.fileNameBase, ';', i.fileNameExtension, ';', i.directory)
    ) 
  SEPARATOR '|'
) AS `moments` 
FROM `trips` AS `t` 
LEFT JOIN `trips_moments` AS `tm` ON t.tripId = tm.tripId 
LEFT JOIN `moments` AS `m` ON tm.momentId = m.momentId 
LEFT JOIN `moments_images` AS `mi` ON m.momentId = mi.momentId 
LEFT JOIN `images` AS `i` ON mi.imageId = i.imageId 
WHERE (t.userId = '1') 
GROUP BY `t`.`tripId` 
ORDER BY `t`.`tripId` ASC 
```

当前表结构：

```
CREATE TABLE IF NOT EXISTS `images` (
  `imageId` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `title` varchar(128) NOT NULL,
  `description` text NOT NULL,
  `fileNameBase` varchar(64) NOT NULL,
  `fileNameExtension` varchar(4) NOT NULL,
  `directory` varchar(64) NOT NULL,
  `source` varchar(32) NOT NULL,
  `created` datetime NOT NULL,
  PRIMARY KEY (`imageId`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `moments` (
  `momentId` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(128) NOT NULL,
  `userId` int(11) NOT NULL,
  `created` datetime NOT NULL,
  PRIMARY KEY (`momentId`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `moments_images` (
  `momentId` int(11) NOT NULL,
  `imageId` int(11) NOT NULL,
  PRIMARY KEY (`momentId`,`imageId`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

CREATE TABLE IF NOT EXISTS `trips` (
  `tripId` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `title` varchar(128) NOT NULL,
  `when` date NOT NULL,
  `created` datetime NOT NULL,
  PRIMARY KEY (`tripId`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

CREATE TABLE IF NOT EXISTS `trips_moments` (
  `tripId` int(11) NOT NULL,
  `momentId` int(11) NOT NULL,
  PRIMARY KEY (`tripId`,`momentId`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:29:41.910

我现在无法测试，但这可以给你一个想法，我改变 moemnt_images join 像这样：

```
LEFT JOIN `moments_images` AS `mi` ON m.momentId = mi.momentId  
AND imageId = (select min(imageId) from moments_images where momentId=m.momentId) 
```

**完整查询：**

```
SELECT 
`t`.`tripId`, 
`t`.`title`, 
`t`.`when`, 
GROUP_CONCAT(
  DISTINCT(
    CONCAT(
       m.momentId, ';', m.title, ';', m.created, ';', i.imageId, ';', i.fileNameBase, ';', i.fileNameExtension, ';', i.directory)
    ) 
  SEPARATOR '|'
) AS `moments` 
FROM `trips` AS `t` 
LEFT JOIN `trips_moments` AS `tm` ON t.tripId = tm.tripId 
LEFT JOIN `moments` AS `m` ON tm.momentId = m.momentId 
LEFT JOIN `moments_images` AS `mi` ON m.momentId = mi.momentId  and imageId = (select min(imageId) from moments_images where momentId=m.momentId)
LEFT JOIN `images` AS `i` ON mi.imageId = i.imageId 
WHERE (t.userId = '1') 
GROUP BY `t`.`tripId` 
ORDER BY `t`.`tripId` ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:34:03.827

@凯伊

我按两列使用此分组，但结果不如预期：

结果，我在“时刻”字段中获得了两条具有这些值的记录：

第一个记录）

```
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;9;EC7NL3HC;jpg;PD1CEQE6|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;6;F50MTTZK;jpg;6R2XJB9X|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;8;VPGPFMMS;jpg;VF95BNNQ|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;10;8J1OT7IT;jpg;ZL8WAWCJ|
166;Kościuszko mound in Cracow;2012-11-08 15:38:14;7;9PY1BZD1;jpg;TP7U07ST 
```

第二条记录）

```
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;20;HZIPGJY7;jpg;FOOWJ8BV|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;22;IS1JPW1N;jpg;31M4XVBM|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;19;66B7VQ84;jpg;ILQYDQUC|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;21;9JOXXPJQ;jpg;ZIVJ5V7K|
167;Pope John Paul II (Jan Paweł 2) home town - Wadowice;2012-11-08 15:57:15;23;OTOWNDZA;jpg;C03UFMBK 
```

当然，如果可能的话，我想得到一个结果，就像我的问题一样。

# sas - SAS 使用 proc ttest 或 proc glm 将人口统计变量因素纳入两组结果测量的比较中

> ID：13299520
> 
> 赞同：1
> 
> 时间：2012-11-08T23:10:24.767
> 
> 标签：sas, glm

我已经编写了 SAS 代码来比较两组的结果测量（即反应时间 - rt）。但是，我们想考虑人口统计指标（即智商）来测试 rt 中的组差异是否实际上是由组间的智商差异驱动的。我想帮助我修改我的代码。我现有的用于计算 rt 中基本组差异的代码如下。我已经包含了使用 t-test sas 函数和 glm sas 函数的代码，它们得到了相似的结果。

```
data sepdata  ;
infile "input.txt"  ;
     input subjid group IQ rt;
run;

title 'T-test group differences;
proc ttest;
        class group;
        var  rt;
run;

title 'Parallel glm code for group differences ';
proc glm;
 class group ;
 model  rt  = group ;
run; 
```

我需要修改 t-test 函数或 glm 函数以在模型中包含“IQ”的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T18:30:43.497

To account for the effect of IQ on the response, include it as a predictor in your MODEL statement behind GROUP. The results associated with GROUP that come out of this updated model are then adjusted for IQ.

```
proc glm data = sepdata;
    class group;
    model rt = group iq;
run;
quit; 
```

I think it would be reasonable in this case to consider IQ as continuous. I hope that helps!

# c++ - 具有花哨交换功能的通用缓冲区？如何？

> ID：13299524
> 
> 赞同：0
> 
> 时间：2012-11-08T23:11:03.083
> 
> 标签：c++, templates, template-specialization, traits

今天早上我遇到了这个问题：

我想构建一个通用类**FrontBackBuffer**，我可以将其用作以下（一些示例）。

**编辑**删除了一些令人困惑的部分！

```
int bb=10;
int fb=3;
FrontBackBuffer< const int*, int & > buf(&fb, &bb);
buf.getBack() = 4; // change from 10 to 4
// buf.getFront() = 5; NO! is const!

buf.swap();
//NOW getFront() and getBack() should return  4 and 3!

FrontBackBuffer< int, const & int > buf(14, bb);
buf.getBack() = 5; // change from 4 to 5
// buf.getFront() = 5; NO! is const!

buf.swap();   
//NOW getFront() and getBack() should return  5 and 14! 
```

它存储**两个缓冲区**，应该是**相同的底层类型**（参见 static_assert）。这些缓冲区可以是指针类型或引用类型，也可以是 const 或非 const。它有两个功能`getFront()`和`getBack()`。这些函数总是返回对底层缓冲区的引用，无论是常量还是非常量。这就是为什么会有各种`MyRefTypes`特征的特殊化。

到目前为止工作的课程如下：

```
template< typename TBufferTypeFront, typename TBufferTypeBack = TBufferTypeFront>
class FrontBackBuffer {

// If <const * int , int&> --> this result in is_same< int , int > 
// STATIC_ASSERT( std::is_same< RemoveModifiers<TBufferTypeFront>::type, typename RemoveModifiers<TBufferTypeFront>::type>::result )

public:

    template <typename T>
    struct MyRefTypes {
        typedef const T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static Ref getRef(T& v) {
            return v;
        }
    };

//Specialization for Reference
    template <typename T>
    struct MyRefTypes<T&> {
        typedef T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(T& v) {
            return v;
        }
    };

//Specialization for const Reference
    template <typename T>
    struct MyRefTypes<const T&> {
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(const T& v) {
            return v;
        }
    };

//Specialization for const
    template <typename T>
    struct MyRefTypes<const T> {
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ref getRef(const T& v) {
            return v;
        }
    };

//Specialization for pointers
    template <typename T>
    struct MyRefTypes<T*> {
        typedef T* Con;
        typedef T& Ref;
        typedef T* const CRef;  //! note this is a pointer....
        static inline Ref getRef(T* v) {
            return *v;
        }
    };

//Specialization for const pointers
    template <typename T>
    struct MyRefTypes<const T*> {
        typedef const T* Con;
        typedef const T& Ref;
        typedef const T* const CRef; //! note this is a pointer....
        static inline Ref getRef(const T* v) {
            return *v;
        }
    };

    typedef typename MyRefTypes<TBufferTypeFront>::Ref TBufferTypeFrontRef;
    typedef typename MyRefTypes<TBufferTypeFront>::CRef TBufferTypeFrontCRef;
    typedef typename MyRefTypes<TBufferTypeFront>::Con TBufferTypeFrontCon;

    typedef typename MyRefTypes<TBufferTypeBack >::Ref TBufferTypeBackRef;
    typedef typename MyRefTypes<TBufferTypeBack >::CRef TBufferTypeBackCRef;
    typedef typename MyRefTypes<TBufferTypeBack >::Con TBufferTypeBackCon;

    explicit FrontBackBuffer(
        TBufferTypeFrontCon  front,
        TBufferTypeBackCon   back):
        m_Front(front),
        m_Back(back)
    {
             m_pBack = (void*)&m_Back;
             m_pFront = (void*)&m_Front;

    };

    ~FrontBackBuffer()
    {};

    TBufferTypeFrontRef getFront() {
        return MyRefTypes<TBufferTypeFront>::getRef(m_Front);
    }
    TBufferTypeBackRef getBack() {
        return MyRefTypes<TBufferTypeBack>::getRef(m_Back);
    }
    private:

    void swap(){
         void * temp = m_pFront;
         m_pFront = m_pBack;
         m_pBack = temp;
    }

    TBufferTypeFront * m_pFront;       ///< The pointer to front buffer
    TBufferTypeBack * m_pBack;         ///< The pointer to back buffer

    TBufferTypeFront m_Front;       ///< The front buffer
    TBufferTypeBack m_Back;         ///< The back buffer

}; 
```

现在的问题是（我不能完全正确地解决）：如何添加一个通用函数`swap()`来交换缓冲区，但不应该复制。我考虑了两个指针`void * m_pFront`，`void *m_pBack`我应该用它们来完成这项工作，并正确分配（参见构造函数）。

但是我现在如何编写这些 getter 函数对我来说是个谜：

```
 TBufferTypeFrontRef getFront() {
        return MyRefTypes<TBufferTypeFront>::getRef(m_Front);
    }
    TBufferTypeBackRef getBack() {
        return MyRefTypes<TBufferTypeBack>::getRef(m_Back);
    } 
```

归根结底，它应该可以正常工作:-)感谢您的帮助并尝试解决这个难题:-)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T10:39:11.590

这是完整的答案！

代码有效，缓冲区是通用的 :-) --> [http://ideone.com/m3kFmo](http://ideone.com/m3kFmo)

并且交换功能也很有效并且可以按需要工作！

**当然这个类只有在底层类型相同时才有用**： `FrontBackBuffer< int *, int &>`--> OK

`FrontBackBuffer< int *, const double &>`--> 没问题，但是交换功能没有意义！

**代码在这里！:-)**

```
template< typename TBufferTypeFront, typename TBufferTypeBack = TBufferTypeFront>
class FrontBackBuffer {

    // If <const * int , int&> --> this result in is_same< int , int > 
    // STATIC_ASSERT( std::is_same< RemoveModifiers<TBufferTypeFront>::type, typename RemoveModifiers<TBufferTypeFront>::type>::result )

public:

    template <typename T>
    struct MyRefTypes {
        typedef T Org;
        typedef T* Ptr;
        typedef const T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static inline Ptr getUnderlyingPtr(T& v) {
            return &v;
        }
        static Ref getRef(T& v) {
            return v;
        }
    };

    //Specialization for Reference
    template <typename T>
    struct MyRefTypes<T&> {
        typedef T Org;
        typedef T* Ptr;
        typedef T & Con;
        typedef T& Ref;
        typedef const T& CRef;
        static inline Ptr getUnderlyingPtr(T& v) {
            return &v;
        }
        static inline Ref getRef(T& v) {
            return v;
        }
    };

    //Specialization for const Reference
    template <typename T>
    struct MyRefTypes<const T&> {
        typedef T Org;
        typedef T* Ptr;
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ptr getUnderlyingPtr(const T& v) {
            return &const_cast<T&>(v);
        }
        static inline Ref getRef(const T& v) {
            return v;
        }
    };

    //Specialization for const
    template <typename T>
    struct MyRefTypes<const T> {
        typedef T Org;
        typedef T* Ptr;
        typedef const T & Con;
        typedef const T& Ref;
        typedef const T& CRef;
        static inline Ptr getUnderlyingPtr(const T& v) {
            return &const_cast<T&>(v);
        }
        static inline Ref getRef(const T& v) {
            return v;
        }
    };

    //Specialization for pointers
    template <typename T>
    struct MyRefTypes<T*> {
        typedef T* Ptr;
        typedef T Org;
        typedef T* Con;
        typedef T& Ref;
        typedef T* const CRef;  //! note this is a pointer....
        static inline Ptr getUnderlyingPtr(T* v) {
            return v;
        }
        static inline Ref getRef(T* v) {
            return *v;
        }
    };

    //Specialization for const pointers
    template <typename T>
    struct MyRefTypes<const T*> {
        typedef T Org;
        typedef T* Ptr;
        typedef const T* Con;
        typedef const T& Ref;
        typedef const T* const CRef; //! note this is a pointer....
        static inline Ptr getUnderlyingPtr(const T* v) {
            return const_cast<T*>(v);
        }
        static inline Ref getRef(const T* v) {
            return *v;
        }
    };

    typedef typename MyRefTypes<TBufferTypeFront>::Ref TBufferTypeFrontRef;
    typedef typename MyRefTypes<TBufferTypeFront>::CRef TBufferTypeFrontCRef;
    typedef typename MyRefTypes<TBufferTypeFront>::Con TBufferTypeFrontCon;
    typedef typename MyRefTypes<TBufferTypeFront>::Org TBufferTypeFrontOrg;
    typedef typename MyRefTypes<TBufferTypeFront>::Ptr TBufferTypeFrontPtr;

    typedef typename MyRefTypes<TBufferTypeBack >::Ref TBufferTypeBackRef;
    typedef typename MyRefTypes<TBufferTypeBack >::CRef TBufferTypeBackCRef;
    typedef typename MyRefTypes<TBufferTypeBack >::Con TBufferTypeBackCon;
    typedef typename MyRefTypes<TBufferTypeBack >::Org TBufferTypeBackOrg;
    typedef typename MyRefTypes<TBufferTypeBack >::Ptr TBufferTypeBackPtr;

    explicit FrontBackBuffer(
                             TBufferTypeFrontCon  front,
                             TBufferTypeBackCon   back):
    m_Front(front),
    m_Back(back)
    {
        m_pBack = MyRefTypes<TBufferTypeBack>::getUnderlyingPtr(m_Back);
        m_pFront = MyRefTypes<TBufferTypeFront>::getUnderlyingPtr(m_Front);

    };

    ~FrontBackBuffer()
    {};

    TBufferTypeFrontRef getFront() {
        return *m_pFront;
    }
    TBufferTypeBackRef getBack() {
        return *m_pBack;
    }

    void swap(){
        TBufferTypeFrontPtr temp = m_pFront;
        m_pFront = m_pBack;
        m_pBack = temp;
    }

private:

    TBufferTypeFrontPtr m_pFront;       ///< The pointer to front buffer
    TBufferTypeBackPtr  m_pBack;         ///< The pointer to back buffer

    TBufferTypeFront m_Front;       ///< The front buffer
    TBufferTypeBack m_Back;         ///< The back buffer

}; 
```

我们现在可以这样使用它：

```
int main() {
        int front=10;
    int back=3;
    FrontBackBuffer< const int*, int & > buf1(&front, back);
    buf1.getBack() = 4; // change from 3 to 4
    // buf.getFront() = 5; NO! is const!
    buf1.swap();
        std::cout << buf1.getFront() << buf1.getBack() << std::endl;
    //NOW getBack() and getFront() should return  4 and 10!

        front = 1;
        back= -1;
    FrontBackBuffer<int &, int > buf2(front, back);
    buf2.getBack() = 2; 
    buf2.getFront() = 3; 

    buf2.swap();   
    //NOW getBack() and getFront() should return  2 and 3!
    std::cout << buf2.getFront() << buf2.getBack() << std::endl;

        front = 1;
        back= -1;
    FrontBackBuffer<int, const int &> buf3(front, back);
    //buf3.getBack() = 2; // IS CONST!!
    buf3.getFront() = 3; 

    buf3.swap();   
    //NOW getBack() and getFront() should return  -1 and 3!
    std::cout << buf3.getFront() << buf3.getBack() << std::endl;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T17:32:56.217

我必须承认我真的不明白为什么您需要发布的所有代码才能完成您描述的任务，但我可能遗漏了一些东西。但是考虑到您只想以通用但有效的方式交换两个相同类型的缓冲区，我建议如下：

```
template<typename BufferType>
class FrontBackBuffer
{
private:
    BufferType buffers[2];
    int _back,_front;
public:
/*
omitting copy constructors, operators etc for brevity
*/
    FrontBackBuffer()
        : _front(0), _back(1)
    {
         /*
           You can also start with front and back pointing to the same memory it is of no  importance if you remember to swap them once or if you just set the back buffer and never the front
         */
    }
    BufferType & getFront()
    {
        return buffers[_front];
    }
    BufferType & getBack()
    {
        return buffers[_back];
    }
    void swap()
    {
        _front = _back;
        _back = (_front + 1) % 2;
    }
}; 
```

你可以像这样使用它：

```
int intArray[] = {1,2,3,4};

FrontBackBuffer<int*> intPtrBuffers;
intPtrBuffers.getBack() = new int[4];
intPtrBuffers.getFront() = new int[4];

memcpy(intPtrBuffers.getBack(), intArray, sizeof(intArray));
intPtrBuffer.swap(); 
```

# javascript - 将参数对象访问到每个接受参数的函数是一种不好的做法吗？

> ID：13299529
> 
> 赞同：5
> 
> 时间：2012-11-08T23:11:35.467
> 
> 标签：javascript

假设我在一个脚本中有 300 个函数。访问每个函数中的参数对象而不是传入命名参数是不是很糟糕？

编辑：好的，你们很多人都在问我为什么要这样做，这确实是一个理论上的问题，但是既然你问我除了可变参数之外还有什么理由要这样做吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-08T23:16:31.577

编写难以阅读且他人难以理解、维护或使用的代码是**不好的做法。**

指定命名参数并尽可能为它们提供有意义、有用、描述性的名称是一种**很好的做法。**

此外，您应该记住，即使所有参数都不是必需的，您也可以声明命名参数。然后，您可以测试`arguments.length`以查看传递了多少参数，或者测试特定命名参数的值以查看它们是否传递`undefined`。

在参数变化很大的情况下，您还可以传递一个对象并让对象自行描述传递了哪些参数。

在某些特定情况下，参数对象很有用，并且使用它是编写清晰、简洁和安全代码的最佳方式，但我从未见过所有函数都声明没有命名参数而只使用参数对象的情况。除非您有一些非常不寻常的项目，否则这通常不是为这么多功能编写代码的最佳方式。

就性能而言，访问命名参数似乎**也**比访问所有主要浏览器中的参数对象更快。在这个仅将传递给测试函数的前三个参数相加的[jsperf 性能测试中，使用](http://jsperf.com/arguments-object-test)**命名参数**比使用`arguments`对象快 2-8 倍。确切的性能差异可能取决于函数试图做什么，但`arguments`对象肯定看起来更慢。

如果您提供更多信息，说明为什么要使用 arguments 对象而不是命名参数，或者为什么您认为使用 arguments 对象会有益，那么我们可能会提供更具体的建议。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:38:23.363

除了jfriend00的出色回答...

一些现代 Javascript 引擎 [1] 不会创建`arguments`变量，除非它是

*   在函数中使用
*   函数使用`eval`或类似构造

因此， using`arguments`可以简单地通过使用它来减慢功能。

[1] 特别是 Chrome 中的 V8。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T02:02:39.827

值得注意的是，严格模式会影响 arguments 对象。

在非严格模式下，参数成员被绑定到它们对应的形式参数（如果已经传递了一个值），所以改变一个的值会改变另一个的值。

在严格模式下并非如此。

例如

```
foo('a');

function foo(arg) {

  // Change the value of arg
  arg = 'b';           

  arg == arguments[0];  // false in strict mode, 
                        // true otherwise
} 
```

此外，`arguments.callee` 并且`arguments.caller`在严格模式下不可用。尝试访问它们将引发错误。

# variables - 对 tumblr 变量的操作

> ID：13299536
> 
> 赞同：0
> 
> 时间：2012-11-08T23:12:00.863
> 
> 标签：variables, tumblr

我找到了一些关于一些基本操作的文档。

例如`{PlaintextCaption}`呈现`{Caption}`为纯文本。

是否有任何其他未记录的操作可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-11T23:08:02.173

此操作已记录在案。这是文档：
[创建自定义 HTML 主题：变量转换](http://www.tumblr.com/docs/en/custom_themes#variable-transformations)

![Tumblr 文档的屏幕截图](../Images/359c800c14df1e8fb6bf0e3de8e799a1.png)

前缀是：Plaintext、JS、JSPlaintext、URLEncoded、RGB

# jquery - 我的日期选择器 Jquery 超出了 CSS 范围

> ID：13299539
> 
> 赞同：0
> 
> 时间：2012-11-08T23:12:12.080
> 
> 标签：jquery, html, css, datepicker

我曾尝试单独使用压光机，并且效果很好。[在此处输入链接描述，](http://jsfiddle.net/p7rtu/1/)但我不明白为什么当我将日历放入我的代码时单击日历时，框会出现故障。我不知道哪一行导致盒子变得一团糟。我正在使用 UI.all.css 和引导程序。它们都在我提供的链接中，日期选择器的代码是

```
<div class="well form-inline"> Original Image Date
    <form>
        <input id="date" class="span2" size="16" type="text"  readonly=""/>
    </form>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script> 
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.5.3/jquery-ui.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $("#date").datepicker({ showOn: 'button', buttonImageOnly: true, buttonImage: 'http://beta.orbitelcom.com/wp-content/uploads/2011/03/icon_cal.jpg' });
        });
    </script>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:27:00.980

添加这个CSS

```
.ui-datepicker-header select.ui-datepicker-new-month {
    height: auto;
}
.ui-datepicker-header select.ui-datepicker-new-year {
    height: auto;
} 
```

[http://jsfiddle.net/p7rtu/2/](http://jsfiddle.net/p7rtu/2/)

# debugging - 如何在 OllyDbg 中搜索特定的 CPU 指令？

> ID：13299541
> 
> 赞同：2
> 
> 时间：2012-11-08T23:12:15.277
> 
> 标签：debugging, x86

如何在 OllyDbg 中搜索特定的 CPU 指令？例如，我尝试 Ctrl+F，输入“MUL”并得到错误“操作数错误”。我想在反汇编中搜索“MUL”或“CWD”或“NEG”等特定指令。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T17:46:57.157

您需要在搜索中包含所有指令操作数。用作`any`通配符。

例子：

```
mul r32
cwd
neg [const]
add any,any 
```

来自[OllyDbg 2.0 简要帮助](http://repo.zenk-security.com/Reversing%20.%20cracking/OllyDbg%202.0%20Brief%20Help.pdf)：

```
R8 Any 8-bit register (AL,BL, CL, DL, AH, BH, CH, DH)
R16 Any 16-bit register (AX, BX, CX, DX, SP, BP, SI, DI)
R32 Any 32-bit register (EAX, EBX, ECX, EDX, ESP, EBP, ESI, EDI)
SEG Any segment register (ES, CS, SS, DS, FS, GS)
FPUREG Any FPU register (ST0..ST7)
MMXREG Any MMX register (MM0..MM7)
SSEREG Any SSE register (XMM0..XMM7)
CRREG Any control register (CR0..CR7)
DRREG Any debug register (DR0..DR7)
CONST Any constant
ANY Any register, constant or memory operand 
```

# ruby-on-rails - 设置产品选项以生成零件编号？

> ID：13299544
> 
> 赞同：0
> 
> 时间：2012-11-08T23:12:22.267
> 
> 标签：ruby-on-rails, database-design

我正在尝试在 Rails 中构建一个很好的健壮系统来创建产品。在顶层，我有非常通用的产品（例如 T 恤）。每个产品都可以有无限的期权类型（大小、颜色），而期权类型又可以有无限的期权值（小、中、大；红、蓝、绿）。

我设置了我的模型，以便产品有很多选项类型，而选项类型有很多选项值。

我被困的地方是如何构建零件编号。零件编号是根据给定产品的选定选项类型/值创建的单个值。例如，TSHIRT-LG 可能是选择了“尺寸：大”和“颜色：绿色”的 T 恤的部件号。

我想到目前为止我的策略是将零件编号与产品和选项值相关联。在后端，管理员应该通过选择属于某个产品的选项类型的选项值组合来创建零件编号。在前端，用户应该能够选择他们喜欢的选项，然后根据他们的选择看到正确的零件编号。我基于[http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)使用嵌套模型创建了一个产品表单。创建选项不是问题，但我一直坚持如何构建表单以根据选项值创建零件编号。我想做下拉菜单来选择现有的选项值，但我就是想不通让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T15:32:21.467

首先，您需要确定您希望如何准确地对零件编号进行编码，以及您想要采用哪些属性来创建零件编号以及您希望它们看起来像什么。

例如 TSHIRT-XLG-MP-001

有一个名为 part_no 的字段，并且作为管理员创建项目

```
before_save: create_part_no
validates_uniqueness_of :part_no

def create_part_no
  name + '-' + size + '-' + gender+ '-' + id
end 
```

如果您希望管理员可以更改它，请删除 before_save 和

```
<%= f.text_field :part_no, default => :create_part_no %> 
```

可能需要一些 ajax

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:39:23.217

Ryan 在动态选择菜单上也有一个较旧但很棒的屏幕投射：[http ://railscasts.com/episodes/88-dynamic-select-menus](http://railscasts.com/episodes/88-dynamic-select-menus)

也许它有帮助！

# python - 保留 python os.popen() 的彩色输出

> ID：13299550
> 
> 赞同：4
> 
> 时间：2012-11-08T23:12:39.600
> 
> 标签：python, colors, stdout, popen

我正在使用 Python 使用 msbuild.exe 从给定目录构建多个 VS 解决方案。我只想要特定的输出，但为了节省工作，解释结果的最佳方法是使用原始 ANSI 编码。

例子：

```
import os
output = os.popen("MSBuild VSTests.sln").read()
print output 
```

这将打印输出，但没有颜色。有什么办法可以保存这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:17:38.027

你不能，据我所知。颜色是控制台的属性，而不是输出文本本身的属性。这不像在 Linux 中，您在设置颜色的文本中获取转义字符并将其读回控制台保留颜色。

这样做的另一个副作用是你不能有一个单独的颜色，`STDOUT`如`STDERR`这个 SO 问题所示：

[在 Windows 中设置 stdout/stderr 文本颜色](https://stackoverflow.com/questions/4920661/set-stdout-err-text-color-windows-c)

# performance - AS3 直接渲染模式——它加速了什么？

> ID：13299555
> 
> 赞同：2
> 
> 时间：2012-11-08T23:12:58.883
> 
> 标签：performance, actionscript-3, rendering, gpu, mode

直接渲染模式。这究竟是做什么用的？“将整个框架视为 Stage3D 表面”对我没有任何作用。我听说它是​​“最快”的渲染模式，但是以什么方式？它会加速矢量处理、位图处理，还是两者都没有？

在这种模式下，旧的“GPU”调整（缓存为位图）会提高性能吗？

另外，项目应该在哪里设置为使用直接渲染？有两个地方提供了该选项——第一个在 AS3 语言配置中，第二个在发布菜单中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T02:50:51.627

直接渲染模式与[Stage3D](http://www.adobe.com/devnet/flashplayer/stage3d.html)一起使用。这是 Adob​​e 的硬件加速 API 集，通过 flash 播放器在浏览器中运行，通过 AIR 在桌面、iOS 和 Android 上运行。

使用 Stage3D 时，您实际上获得了一个硬件加速的舞台，它位于传统的显示列表舞台之后。

![舞台列表](../Images/dc8335c295d5372f6ba5644dd5069c0c.png)

您不能使用传统的 Flash API 并让您的内容在 GPU 上运行，直接在 Stage3D 上编程更类似于 OpenGL 编程。它需要使用[AGAL](http://www.adobe.com/devnet/flashplayer/articles/what-is-agal.html)着色器和一组特定的 API。

[http://www.adobe.com/devnet/flashplayer/articles/how-stage3d-works.html](http://www.adobe.com/devnet/flashplayer/articles/how-stage3d-works.html)

然而，有相当多的库被设计为直接与 Stage3D 一起工作。使用这些库编程的内容将被硬件加速并利用巨大的性能提升。

[Starling](http://gamua.com/starling/)模仿了 DisplayList API，如果您进行过传统的 Flash 编程，应该会非常熟悉。还有一个建立在 Starling 之上的 UI 框架，称为[Feathers](http://feathersui.com/)。出于性能原因，我目前在移动应用程序中使用它作为 Flex Mobile 的替代品。

还有几个 3D 库专为创建/处理 3D 内容而设计。查看[Away3D](http://away3d.com/)或进行快速谷歌搜索。该站点还列出了很多 Stage3D 框架：

[http://www.adobe.com/devnet/flashplayer/stage3d.html](http://www.adobe.com/devnet/flashplayer/stage3d.html)

以下是更多链接以获取更多信息：

[http://gaming.adobe.com/](http://gaming.adobe.com/) - Stage3D sdk 的信息。还包括最新 Flash SDK 的下载链接

[http://www.bytearray.org/?p=2555](http://www.bytearray.org/?p=2555) -Stage3D 在测试阶段被称为 Molehill

[Flash CS5 中的 stage3d 入门，选择哪个框架？](https://stackoverflow.com/questions/8249203/getting-started-with-stage3d-in-flash-cs5-and-which-framework-to-choose)-关于该主题的另一个stackoverflow问题

希望这可以帮助

# compiler-construction - 用于优化的 LLVM 静态值分析

> ID：13299559
> 
> 赞同：3
> 
> 时间：2012-11-08T23:13:10.393
> 
> 标签：compiler-construction, compilation, llvm, formal-methods, formal-verification

假设我有这样的功能：

```
int foo(int a, int b, int d, int x){
  if (c) {a = 1; b = 1; d = a;}
  else {a = 2; b = 2; d = 1;}
  if (a == b) {x = d;} else {x = 0;}
  return x;
} 
```

这个微不足道的函数总是返回 1。使用带有 -O2 选项的 clang 编译并查看反汇编代码 LLVM 正确将此函数编译为`return 1;`.

我的问题是：llvm如何做静态值分析？最弱的前置条件技术？价值传播？霍尔的技术？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T01:45:08.317

LLVM 做了各种各样的事情：见[这里](http://llvm.org/docs/Passes.html)。

您可以在每次优化通过后获得中间表示的转储，如下所示：

```
clang -c -mllvm -print-after-all -O2 foo.c 
```

确定哪个阶段正在做什么。

* * *

事实上，这个特殊的例子并不是很神奇！

如果将其转换为[SSA 形式](http://en.wikipedia.org/wiki/Static_single_assignment_form)，它看起来像这样：

```
 // block 1
  if (c == 0) goto L1;
  // block 2
  a_0 = 1;
  b_0 = 1;
  d_0 = a_0;
  goto L2;
L1:
  // block 3
  a_1 = 2;
  b_1 = 2;
  d_1 = 1;
  goto L2;

L2:
  // block 4 (has two possible predecessors: block 2 or block 3)
  a_2 = PHI(a_0, a_1); // i.e. a_0 if we came from block 2, a_1 if we came from block 3
  b_2 = PHI(b_0, b_1); // i.e. b_0 if we came from block 2, b_1 if we came from block 3
  d_2 = PHI(d_0, d_1); // i.e. d_0 if we came from block 2, d_1 if we came from block 3
  if (a_2 != b_2) goto L3;
  // block 5
  x_0 = d_2;
  goto L4:
L3:
  // block 6
  x_1 = 0;
  goto L4;

L4:
  // block 7 (has two possible predecessors: block 5 or block 6)
  return PHI(x_0, x_1); // i.e. x_0 if we came from block 5, x_1 if we came from block 6 
```

简单地传播常数值会导致：

```
 // block 1
  if (c == 0) goto L1;
  // block 2
  a_0 = 1;
  b_0 = 1;
  d_0 = 1;
  goto L2;
L1:
  // block 3
  a_1 = 2;
  b_1 = 2;
  d_1 = 1;
  goto L2;

L2:
  // block 4
  a_2 = PHI(1, 2); // i.e. 1 if we came from block 2, 2 if we came from block 3
  b_2 = PHI(1, 2); // i.e. 1 if we came from block 2, 2 if we came from block 3
  d_2 = 1;         // PHI(d_0, d_1) == PHI(1, 1) i.e. 1 regardless of where we came from
  if (a_2 != b_2) goto L3;
  // block 5
  x_0 = 1;  // (we've deduced that d_2 == 1 regardless of control flow)
  goto L4:
L3:
  // block 6
  x_1 = 0;
  goto L4;

L4:
  // block 7
  return PHI(1, 0); // i.e. 1 if we came from block 5, 0 if we came from block 6 
```

简化以删除不再用于其他任何事情的分配给出了这个：

```
 // block 1
  if (c == 0) goto L1;
  // block 2
  goto L2;
L1:
  // block 3
  goto L2;

L2:
  // block 4
  a_2 = PHI(1, 2); // i.e. 1 if we came from block 2, 2 if we came from block 3
  b_2 = PHI(1, 2); // i.e. 1 if we came from block 2, 2 if we came from block 3
  if (a_2 != b_2) goto L3;
  // block 5
  goto L4:
L3:
  // block 6
  goto L4;

L4:
  // block 7
  return PHI(1, 0); // i.e. 1 if we came from block 5, 0 if we came from block 6 
```

...现在第一个条件显然是空操作；并且第二个必须始终为真（第 5 块路径），因为`a_2`和`b_2`是相同的表达式。所以结果是

```
 return 1; 
```

# objective-c - 如何将 UIScrollView 连接到 IBOutlet

> ID：13299560
> 
> 赞同：-1
> 
> 时间：2012-11-08T23:13:12.800
> 
> 标签：objective-c, xcode, uiscrollview

我有一个使用 Storyboards 的 iPad 应用程序。我有一个 UIView，分为 2 个区域；我们称它们为“顶部”（包含 UIView）和“底部”（包含 UIScrollVIew，带有 UIView 子视图）。在这两种情况下，我都使用 UIViews；不同之处在于 UIView 是一个必须滚动的子视图。

我的问题是如何将 UIScrollView 连接到 IBOutlet 以便设置 ContentSize？在 AppDelegate 中，我应该在哪里放置 IBOutlet 定义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:00:36.080

打开故事板，打开助理编辑器。从 IB 中的滚动视图拖动（右键单击拖动）到标题，并在询问时建立连接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:00:58.307

您不应该将插座放在应用程序委托中。您的应用程序应该包含一个根视图控制器（如果您使用的是单视图应用程序模板，则会自动创建），它应该处理与应用程序的初始视图相关的任何内容。一旦你有了一个，在编辑器中打开故事板。使用顶部的按钮打开助手编辑器，然后使用助手编辑器顶部的下拉菜单打开控制器的头文件。选择滚动视图，并从它控制拖动到控制器的界面。Xcode 会提示你创建一个 outlet，允许你更改名称。让我们使用`scrollView`名称。选择`weak`对于内存管理，因为它已经被它的超级视图保留了。Xcode 应该会自动合成访问器，现在您可以`self.scrollView`从控制器的实例方法中访问属性。或者，您可以选择滚动视图并将其在属性检查器中的标签设置为任何唯一数字，例如 4。然后，您可以使用`[self.view viewWithTag:4]`它来获取对它的引用。

# asp-classic - IsObject 测试不避免需要的对象

> ID：13299561
> 
> 赞同：0
> 
> 时间：2012-11-08T23:13:18.660
> 
> 标签：asp-classic, vbscript

Object_required:_'state.Item(...).Item(...)'

我在这行代码上发生了这个错误；

```
If state.Item(level).Item(conflictItem).Item("menu_state") = "CHECKED" Then
 ... do some stuff
End If 
```

我知道有时可能没有定义，所以我这样做了；

```
If IsObject(state.Item(level).Item(childRequires).Item("menu_state")) And state.Item(level).Item(childRequires).Item("menu_state")state.Item(level).Item(childRequires).Item("menu_state") = "CHECKED" Then
   ... do some stuff                        
End If 
```

但我仍然得到同样的错误。代码适用于所有内容，直到它查找不应该存在的一项。我也尝试过 Not IsNothing，Not IsNull，没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T11:15:30.930

除了 Cheran 的正确答案（并显示 Flakes 中的缺陷）：

[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)（手头问题的更好链接）

**实际短路评估：**

VBScript 是急切的（不必要地计算表达式）：

选项显式

```
Function F()
  WScript.StdOut.Write "F() called ==> "
  F = True
End Function

Dim A, R
For Each A In Array(False, True)
    WScript.StdOut.Write CStr(A) & " and F() ==> "
    If A And F() Then R = "YES" Else R = "NO"
    WScript.StdOut.WriteLine R

    WScript.StdOut.Write CStr(A) & " or F() ==> "
    If A Or  F() Then R = "YES" Else R = "NO"
    WScript.StdOut.WriteLine R
Next 
```

输出：

```
False and F() ==> F() called ==> NO
False or F() ==> F() called ==> YES
True and F() ==> F() called ==> YES
True or F() ==> F() called ==> YES 
```

JScript 是惰性的（跳过不必要的检查）：

```
function F() {
  WScript.StdOut.Write("F() called ==> ");
  return true;
}

var B = [false, true];
var R;
for (var I in B) {
  var A = B[I];
  WScript.StdOut.Write(A + " and F() ==> ");
  if (A && F()) {R = "YES";} else {R = "NO";}
  WScript.StdOut.WriteLine(R);

  WScript.StdOut.Write(A + " or F() ==> ");
  if (A || F()) {R = "YES";} else {R = "NO";}
  WScript.StdOut.WriteLine(R);
} 
```

输出：

```
false and F() ==> NO
false or F() ==> F() called ==> YES
true and F() ==> F() called ==> YES
true or F() ==> YES 
```

**Select Case False/True 可以避免嵌套 If：**

```
Option Explicit

Class C
  Function F()
    WScript.StdOut.Write "C.F() called ==> "
    F = True
  End Function
End Class

Class D
  Public m_C
  Private Sub Class_Initialize()
    Set m_C = Nothing
  End Sub
  Function init()
    Set init = Me
    Set m_C = New C
  End Function
End Class

Class I
  Private m_I
  Private Sub Class_Initialize()
    m_I = 0
  End Sub
  Public Default Function Inc()
    m_I = m_I + 1
    Inc = Right("   " & m_I, 3) & " "
  End Function
End Class

Dim N : Set N = New I
Dim O, R
For Each O In Array(Empty, "Nix", Nothing, New D, (New D).init())
    WScript.StdOut.Write N() & TypeName(O) & " via nested Ifs ==> "
    If IsObject(O) Then
       If O Is Nothing Then
          R = "O Is Nothing"
       Else
          If IsObject(O.m_C) Then
             If O.m_C Is Nothing Then
                R = "O.m_C Is Nothing"
             Else
                If O.m_C.F() Then
                   R = "YES"
                Else
                   R = "NO"
                End If
             End If
          Else
             R = "O.m_C is not an object"
          End If
       End If
    Else
       R = "O is not an object"
    End If
    WScript.StdOut.WriteLine R

    WScript.StdOut.Write N() & TypeName(O) & " via Select Case False ==> "
    Select Case False
      Case IsObject(O)
        R = "O is not an object"
      Case Not O Is Nothing
        R = "O Is Nothing"
      Case IsObject(O.m_C)
        R = "O.m_C is not an object"
      Case Not O.m_C Is Nothing
        R = "O.m_C Is Nothing"
      Case Else
        If O.m_C.F() Then
           R = "YES"
        Else
           R = "SURPRISE"
        End If
    End Select
    WScript.StdOut.WriteLine R

    WScript.StdOut.Write N() & TypeName(O) & " via SHORT Select Case False ==> "
    Select Case True
      Case Not IsObject(O), O Is Nothing, Not IsObject(O.m_C), O.m_C Is Nothing
        R = "Something rotten"
      Case Else
        If O.m_C.F() Then
           R = "YES"
        Else
           R = "SURPRISE"
        End If
    End Select
    WScript.StdOut.WriteLine R

   On Error Resume Next
    If O Is Nothing Then R = "Surprise"
    If Err.Number Then WScript.Echo N(), Err.Number, Err.Description
   On Error GoTo 0

Next 
```

输出：

```
 1 Empty via nested Ifs ==> O is not an object
  2 Empty via Select Case False ==> O is not an object
  3 Empty via SHORT Select Case False ==> Something rotten
  4  424 Object required
  5 String via nested Ifs ==> O is not an object
  6 String via Select Case False ==> O is not an object
  7 String via SHORT Select Case False ==> Something rotten
  8  424 Object required
  9 Nothing via nested Ifs ==> O Is Nothing
 10 Nothing via Select Case False ==> O Is Nothing
 11 Nothing via SHORT Select Case False ==> Something rotten
 12 D via nested Ifs ==> O.m_C Is Nothing
 13 D via Select Case False ==> O.m_C Is Nothing
 14 D via SHORT Select Case False ==> Something rotten
 15 D via nested Ifs ==> C.F() called ==> YES
 16 D via Select Case False ==> C.F() called ==> YES
 17 D via SHORT Select Case False ==> C.F() called ==> YES 
```

如果您忽略输出 4 和 8 并仅比较三元组 1-3，... 15-17 并查看对应的代码行，您会看到

1.  嵌套的 Ifs 和 Select Case 在结果上是等价的
2.  如果您对细节不感兴趣，SHORT Select Case 可以在一行中过滤**所有**“坏情况”（尽管顺序很重要！），因为逗号分隔的表达式列表是短路的
3.  如果您需要详细信息，选择案例更易于阅读/编辑/扩充

**Flakes 回答中的缺陷：**

输出第 4 行和第 8 行显示，如果应用于非对象，Is Nothing 测试将失败。所以必须用 IsObject() 检查来保护它。然后会出现组合检查的问题（在该贡献中完全忽略了该问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T08:13:16.380

VBScript 逻辑运算符[没有短路](http://msdn.microsoft.com/en-us/library/e8zy95hw%28VS.84%29.aspx)。这意味着无论如何都会评估这两个条件（我想除非出现运行时错误）。相反，您应该将条件构造为：

```
If IsObject(state.Item(level).Item(childRequires).Item("menu_state")) Then
    If state.Item(level).Item(childRequires).Item("menu_state") = "CHECKED" Then
        ... do some stuff
    End If
End If 
```

但是请注意，根据您的错误，`'state.Item(...).Item(...)'`它不是对象。这意味着您需要将测试提升一级：

```
If IsObject(state.Item(level).Item(childRequires)) Then
    If state.Item(level).Item(childRequires).Item("menu_state") = "CHECKED" Then
        ... do some stuff
    End If
End If 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-09T07:02:52.193

```
If (NOT (state.Item(level).Item(childRequires).Item("menu_state") is NOTHING) ) 
```

# mysql - 多个mysql查询按频率排序

> ID：13299563
> 
> 赞同：0
> 
> 时间：2012-11-08T23:13:35.370
> 
> 标签：mysql

*   姓名 年龄 工作眼睛

*   约翰·杨家黑

*   迈克年轻工厂蓝

*   欧文老家黑

*   玛丽年轻的家蓝

*   泰迪老工厂绿色

在 html 多个复选框表单中搜索 term1=young, term2=home, term3=blue

```
//display all combination order from first in table<br>
$sql = mysql_query("select(Name) from Table where Age = '$term1' or Work = '$term2' or Eyes = '$term3'"); 
```

我需要按频率顺序显示。在我的情况下，首先（在结果之上）必须是玛丽

哪些功能以及如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:19:01.093

```
SELECT   *
FROM     my_table
WHERE    (Age = 'young')
      OR (Work = 'home')
      OR (Eyes = 'blue')
ORDER BY (Age = 'young')
       + (Work = 'home')
       + (Eyes = 'blue') DESC 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/5e9fa/1/0)上查看。

# android - 单击 ListAdapter 中的项目不会执行任何操作

> ID：13299568
> 
> 赞同：1
> 
> 时间：2012-11-08T23:14:13.327
> 
> 标签：android, eclipse, listadapter

我正在尝试使用 android 制作我的第一个列表适配器，它提供了列表，但是当我单击这些项目时，没有任何反应。我唯一的猜测是我在定义 Class cvar 的那一行之后的注释。

```
package scouting.form;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class Menu extends ListActivity{

    String classes[] = {"SCOUTING","LOGIN","MAIN"};

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setListAdapter(new ArrayAdapter<String>(Menu.this,android.R.layout.simple_list_item_1,classes));
    }

    @Override
    protected void onListItemClick(ListView l, View v, int position,long id)
    {
        super.onListItemClick(l, v, position, id);
        String cheese= "com.cody.graham."+classes[position];
        try{
            Class cvar=Class.forName(cheese);     //Eclipse has a warning on this line "Class is a raw type. References to generic type Class<T> should be parameterized". I don't really know what that means.
            Intent intention=new Intent(Menu.this,cvar);
            startActivity(intention);
        }catch(ClassNotFoundException e){
            e.printStackTrace();
        }
    }
} 
```

编辑：

AndroidManifest 的一部分：

```
<activity android:name=".splash_screen" android:label="@string/title_activity_splash" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity>

<activity android:name=".Login" android:label="@string/title_activity_login" android:exported="false">
    <intent-filter>
        <action android:name="com.cody.graham.LOGIN" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity>

<activity android:name=".Scouting" android:label="@string/title_activity_scouting" android:exported="false">
    <intent-filter>
        <action android:name="com.cody.graham.SCOUTING" />
        <category android:name="android.intent.category.DEFAULT" />
    </intent-filter>
</activity> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:20:50.560

```
 String classes[] = {"SCOUTING","LOGIN","MAIN"}; 
```

尝试命名类的显示方式。像`Scouting`

还尝试更改您的清单：

`<activity android:name=".Scouting" />`
这是你在这种情况下只需要的。

> Eclipse 在这一行有一个警告“类是原始类型。对泛型类的引用应该被参数化”。这是一个警告，在这种情况下它不会给你一个错误。意思是 Class ， T 是你得到的类类型。前任：

```
Class<? extends Activity> cvar=Class.forName(cheese); 
```

欲了解更多信息：[链接](https://stackoverflow.com/questions/462297/how-to-use-classt-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:27:17.117

首先，`<intent-filter>`从清单中删除两个`.Scouting`和`.Login`( 保留一个的部分`.splash_screen)`。除非您需要`Activity`从第 3 方（外部）应用程序启动任何类，否则没有必要声明基于操作的`<intent-filter>`部分 - 它也不是好的做法。

其次，按照 wtsang02 的建议进行操作，并将 classes 字符串数组更改为...

```
String classes[] = {"Scouting","Login","splash_screen"}; 
```

此外，假设其他`Activity`类（如 Scouting 等）与 相同的包中`Menu`，更改此行...

```
String cheese= "com.cody.graham."+classes[position]; 
```

成为...

```
String cheese= "scouting.form." +classes[position]; 
```

...并摆脱日食警告，这条线...

```
Class cvar=Class.forName(cheese); 
```

...到...

```
Class<?> cvar=Class.forName(cheese); 
```

# sql - MSSQL 性能 - JOIN 上的大 n

> ID：13299569
> 
> 赞同：0
> 
> 时间：2012-11-08T23:14:19.610
> 
> 标签：sql, sql-server, performance

```
SELECT  A.Id, AMerge.FeildA, AMerge.FeildB, AMerge.FeildC, BMerge.FeildD, BMerge.FeildE, BMerge.FeildF, 
FROM 

    (SELECT Id, FieldA, FieldB, FieldC from A1
    UNION ALL 
    SELECT Id, FieldA, FieldB, FieldC from A2
    ) AS A
    INNER JOIN 
    (
    SELECT Id, FieldD, FieldE, FieldF FROM B1
    UNION ALL 
    SELECT Id, FieldD, FieldE, FieldF FROM B2
    )  AS B

ON A.Id = B.Id 
```

其中 A 的 n = 8102869，B 的 n = 17935860，导致表大小 n=17935860。

如何重构此查询以提高效率，或者我可以对表或数据库执行哪些流程以提高上述查询的性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:24:21.330

你能发布查询计划吗？

确保所有表上的 id 上都有一个聚集索引并重构为以下内容可能会加快速度。查询中有很多合并连接并且没有排序可能是您可以摆脱这种情况的最佳计划。

```
Select
  a1.Id, a1.FieldA, a1.FieldB, a1.FieldC, b1.FieldD, b1.FieldE, b1.FieldF
From 
  A1 Inner Join B1 On A1.ID = B1.ID
Union All
Select
  ...
From
  A2 Inner Join B1 On A2.Id = B1.ID 
Union All 
Select
  ...
From
  A1 Inner Join B2 On A1.Id = B2.ID
Union All
Select
  ...
From
  A2 Inner Join B2 On A2.ID = B2.ID 
```

此外，您已经标记了这个 mysql 和 sql-server。我这里说的是Sql Server，对mysql的来龙去脉还不够了解

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T16:09:41.343

首先，您需要在所有表上都有一个聚集索引。如果没有聚集索引，您的表就是一个堆，任何查询都会进行表扫描——这是它检查所有行的唯一方法。

其次，您应该有一个（复杂/多列）索引，至少涵盖您在任何连接中使用的任何列：理想情况下，首先是最细粒度的列，等等。

因此，如果您没有此 SQL，则会将每个表中的列数相乘并尝试创建结果的临时表。

因此，如果您在 1 个表中有 100000 行，而在另一个表中有 10000 行，则计算出的没有索引的行大小将是 1000000000 行。天知道会创建多大的临时表！

使用索引（和最新的统计数据），如果一个表中有 100 行，另一个可能匹配的 10 行，SQL 将估计 1000 行。它可以将其存储在您的临时数据库中，更不用说运行速度更快！

# php - 具有两个数组的多个 foreach

> ID：13299570
> 
> 赞同：2
> 
> 时间：2012-11-08T23:14:23.967
> 
> 标签：php, arrays, foreach

我整天都在试图解决这个问题......但似乎无法让它发挥作用。

我有这个有效的代码：

```
<?php foreach ($value['options'] as $option) { ?>
<option><?php echo $option; ?></option>
<?php } ?> 
```

并且它正确显示了作为我的选项列出的数组。但是我希望通过将另一个数组拆分为一个选项来为每个数组创建一个值：

```
<?php foreach ($value['options'] as $option) {
      foreach ($value['cids'] as $cid) { ?>
<option value="<?php echo $cid; ?>"><?php echo $option; ?></option>
<?php } } ?> 
```

每当我这样做时，我的选择都会以各种可能的方式成倍增加，这是我不想要的。我将如何去做这样的事情

```
<?php foreach ($value['options'] as $option AND $value['cids'] as $cid) { 
    echo $option;
    echo $cid;
 } ?> 
```

我知道那行不通……只是想要类似的东西。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:27:39.000

使用[`MultipleIterator`](http://php.net/manual/en/class.multipleiterator.php)：

```
<?php
$array1 = range(1,5);
$array2 = range(6,10);

$iterator = new MultipleIterator();
$iterator->attachIterator(new ArrayIterator($array1));
$iterator->attachIterator(new ArrayIterator($array2));
foreach($iterator as $items){
        echo $items[0].' - '.$items[1];
}

?> 
```

当然，真正的老派（你们年轻人不知道你`foreach`被宠坏了多少）：

```
<?php
$array1 = range(1,5);
$array2 = range(6,10);

//reset array pointers to be sure
reset($array1);
reset($array2);
while((list(,$a) = each($array1)) && (list(,$b) = each($array2))){
   echo $a .':'.$b.PHP_EOL;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:19:35.897

我们假设两者`$value['options']`和`$value['cids']`具有相同的长度`$length`：

```
<?php  for($i=0 ; $i < $length; $i++) { ?>
    <option value="<?php echo $value['options'][$i]; ?>"><?php echo $value['cids'][$i]; ?></option>
    $arr[$i];
<?php } ?> 
```

但是，如果您的数组是关联的，则可以使用以下内容：

```
function getArrayFromIndex($arr, $ind)
{
    $i==0;
    foreach ($arr as $key => $value) {
        if ($i==$ind)
             return $key;
    }
} 
```

通过调用获取您的第 N 个元素

`getArrayFromIndex($value['options'],$i)`

代替

`$value['options'][$i]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T16:31:01.447

首先感谢大家的解答。它引导我走向正确的方向。这是我为使其正常工作所做的工作。

```
<?php 

$myoptions = array_combine($value['options'], $value['cid']);
foreach ($myoptions as $option => $cid) { ?>

<option value="<?php echo $cid; ?>"><?php echo $option; ?></option>

<?php }  ?> 
```

我做了一个`array_combine`回应我的价值观。

# django - Django Tastypie PATCH 抛出“'Bundle' object is not iterable”错误

> ID：13299575
> 
> 赞同：4
> 
> 时间：2012-11-08T23:14:44.320
> 
> 标签：django, api, rest, patch, tastypie

我正在开发一个 API，对于我的一个端点，我希望能够进行部分更新。

这里是美味的资源

```
class StoryResource(ModelResource):
    authors = fields.ToManyField(SimpleAuthorResource, 'authors', full=True)
    posts = fields.ToManyField(SimplePostResource, 'posts', full=True, blank=True)
    cover_photo = fields.ForeignKey(PhotoResource, 'cover_photo', full=True)
    class Meta:
        queryset = Story.objects.all()
        resource_name = 'story'
        validation = ModelFormValidation(form_class=StoryForm)
        authorization = Authorization()
        allowed_methods = ['get', 'post', 'patch', 'put']
        ordering = ['-created_ts']
    def determine_format(self, request):
        return "application/json" 
```

我正在使用 POSTMAN 发出 PATCH 请求以更新 Story 模型中的字段。

它返回此错误：

> {"error_message": "'Bundle' 对象不可迭代", "traceback": "Traceback (最近一次调用最后一次):\n\n 文件\"/usr/local/lib/python2.7/dist-packages/ sweetpie/resources.py\"，第 192 行，在包装器中\n response = callback(request, *args, **kwargs)\n\n File \"/usr/local/lib/python2.7/dist-packages/ sweetpie/resources.py\"，第 406 行，在 dispatch_detail\n return self.dispatch('detail', request, **kwargs)\n\n File \"/usr/local/lib/python2.7/dist- packages/tastypie/resources.py\"，第 427 行，在 dispatch\n response = method(request, **kwargs)\n\n File \"/usr/local/lib/python2.7/dist-packages/tastypie /resources.py\"，第 1332 行，在 patch_detail\n self.update_in_place(request, bundle, deserialized)\n\n File \"/usr/local/lib/python2.7/dist-packages/tastypie/resources.py\"，第 1345 行，在 update_in_place\n self.is_valid(original_bundle, request)\n\n 文件 \"/usr/local/lib/python2.7/dist-packages /tastypie/resources.py\"，第 991 行，在 is_valid\n 中错误 = self._meta.validation.is_valid(bundle, request)\n\n 文件 \"/var/www/novella-django/novella/novella/ api/validation.py\"，第 55 行，在 is_valid\n data[field] = self.uri_to_pk(data[field])\n\n File \"/var/www/novella-django/novella/novella/api /validation.py\"，第 29 行，在 uri_to_pk\n for one_uri in uris:\n\nTypeError: 'Bundle' object is not iterable\n"}在 is_valid\n 错误 = self._meta.validation.is_valid(bundle, request)\n\n 文件 \"/var/www/novella-django/novella/novella/api/validation.py\"，第 55 行，在is_valid\n data[field] = self.uri_to_pk(data[field])\n\n 文件 \"/var/www/novella-django/novella/novella/api/validation.py\"，第 29 行，在 uri_to_pk \n for one_uri in uris:\n\nTypeError: 'Bundle' object is not iterable\n"}在 is_valid\n 错误 = self._meta.validation.is_valid(bundle, request)\n\n 文件 \"/var/www/novella-django/novella/novella/api/validation.py\"，第 55 行，在is_valid\n data[field] = self.uri_to_pk(data[field])\n\n 文件 \"/var/www/novella-django/novella/novella/api/validation.py\"，第 29 行，在 uri_to_pk \n for one_uri in uris:\n\nTypeError: 'Bundle' object is not iterable\n"}

我不太确定出了什么问题，而且我似乎在其他任何地方都找不到这个错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T16:03:08.970

听起来您的验证正在尝试使用以下行遍历您的外键包：

```
for one_uri in uris: 
```

这就是它的`"Bundle" object is not iterable`来源。如果您想将这些字段作为 resource_uris 进行迭代，请`full=True`从这些 FK 字段中删除。

* * *

如果要将它们保留为`full=True`，则需要更新验证以处理这些字段的捆绑包或通过`exclude`在表单元类中使用将它们从验证中排除：

```
class ModelFormValidation:
    ...

    class Meta:
        exclude = (
            authors,
            posts,
            cover_photo            
        ) 
```

# winapi - CreateProcess 不会启动

> ID：13299588
> 
> 赞同：1
> 
> 时间：2012-11-08T23:15:49.623
> 
> 标签：winapi

我收到错误代码 2，找不到文件。但是我已经尝试过完整的路径并且没有。我没有运气开始这个过程，我不知道我的错误是什么，有人可以指出吗？

这是完整的代码：

```
#include "stdafx.h"
#include <map>
#include <psapi.h>
#include "shlwapi.h"

#define ERROR_FILE_NOT_FOUND = 2;

void Debug(char* path[])
{
    STARTUPINFO si;
    PROCESS_INFORMATION pi;

    ZeroMemory( &si, sizeof(si) );
    si.cb = sizeof(si);
    ZeroMemory( &pi, sizeof(pi) );

    char* p = path[0];
    char* args = path[1];

    int dwProcess = CreateProcess((LPCWSTR)p, (LPWSTR)args, NULL, NULL, false, DEBUG_ONLY_THIS_PROCESS, NULL, NULL, &si, &pi);

    if (!dwProcess)
    {
        DWORD dwLastErrorCode = GetLastError();
        printf("Error: %d", dwLastErrorCode);
    }

    DEBUG_EVENT debug_event = {0};
    DWORD dwContinueStatus  = DBG_CONTINUE;
    DWORD dwResume          = DBG_EXCEPTION_HANDLED;

    while (!WaitForDebugEvent(&debug_event, INFINITE))
    {
        switch(debug_event.dwDebugEventCode)
        {
            case EXCEPTION_DEBUG_EVENT:
            {
                EXCEPTION_DEBUG_INFO& exception = debug_event.u.Exception;

                if (exception.ExceptionRecord.ExceptionCode == 0x0EEDFADE && exception.dwFirstChance)
                    dwContinueStatus = dwResume;
            }
        }
        ContinueDebugEvent(debug_event.dwProcessId, debug_event.dwThreadId, dwContinueStatus);
    }
}

int main(char* argv[])
{
    char* p[2] = { "Notepad.exe", "args" };
    Debug(p);

    return 0;
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:35:40.390

```
int dwProcess = CreateProcess((LPCWSTR)p, (LPWSTR)args, 
```

↑ 不要投射`char*`到`wchar_t*`.

删除所有 C 演员并更快乐。:-)

实际上，使用宽字符串（`wchar_t`基于 -）来处理 Windows API。

使用 Visual C++（尽管它特定于该编译器）获取宽字符程序参数的一种简单方法是使用`wmain`而不是标准的`main`.

* * *

**修改**我忘了这是SO。那么当你投射到时实际*发生*了什么？`char*``wchar_t*`

在 Windows 中，每个`wchar_t`都是 2 个字节。这意味着*如果*事物没有崩溃，则`char`字符串中的每一对连续值都将被视为一个`wchar_t`值。它可能会崩溃，因为宽字符串的空终止是 2 个零字节，而您的字符串只保证一个零字节，所以从代码的角度来看，您的字符串可能会无限期地继续......*`char``CreateProcess`*

 *简而言之，不要施放。

每个演员都对编译器说：“闭嘴，编译器，因为我真的明白我在做什么，我没有做错！”

如果一个人实际上不知道自己在做什么，那么效果就是让不断试图帮助你避免灾难的工具保持沉默。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:32:53.883

您必须使用完整路径，而不仅仅是`notepad.exe`. 取自[CreateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx)文档：

> 该字符串可以指定要执行的模块的完整路径和文件名，也可以指定部分名称。在部分名称的情况下，该函数使用当前驱动器和当前目录来完成规范。**该函数不会使用搜索路径**。该参数必须包含文件扩展名；假定没有默认扩展名。

如果您还想打开该文件，`notepad.exe`则需要重复`notepad`. `lpCommandLine`从同一页面：

> 如果 lpApplicationName 和 lpCommandLine 都非 NULL，则 lpApplicationName 指向的空终止字符串指定要执行的模块，而 lpCommandLine 指向的空终止字符串指定命令行。新进程可以使用 GetCommandLine 来检索整个命令行。**用 C 编写的控制台进程可以使用 argc 和 argv 参数来解析命令行。因为 argv[0] 是模块名，所以 C 程序员一般会重复模块名作为命令行中的第一个标记。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T00:32:02.673

You are using Ansi buffers for your parameter data, but you are calling the Unicode version of `CreateProcess()` instead of the Ansi version. Get rid of your type casts (the compiler would have warned you of your mistake had you nt used them) and then call `CreateProcessA()` directly:

```
//CreateProcess((LPCWSTR)p, (LPWSTR)args, ...);
CreateProcessA(p, args, ...); 
```*

# excel - 如何在 if 语句中使用多个 isblank 语句

> ID：13299589
> 
> 赞同：6
> 
> 时间：2012-11-08T23:15:50.217
> 
> 标签：excel, if-statement

是否可以在 if 语句中使用多个 isblank 语句。我想使用像这样的东西 sudocode

```
=if(isblank(g8)&isblank(h8), "both blank", "not both blank")
=if(isblank(g8&h8), "both blank", "not both blank") 
```

这些函数返回 $VALUE 错误或在 if 语句中返回错误的文本。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T23:19:08.260

```
=if(AND(isblank(g8),isblank(h8)), "both blank", "not both blank") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T00:58:46.183

如果您的范围是连续的，则使用以下公式将采用您想要的任意数量的参数，并且在您扩展范围时使用更容易键入的语法：

`=if(counta(g8:h8)=0, "both blank", "not both blank")`

# php - 在 PHP 中实例化一个类时如何抑制错误输出？

> ID：13299590
> 
> 赞同：1
> 
> 时间：2012-11-08T23:15:55.307
> 
> 标签：php, class, instantiation, imagick

**警告 - 我不是在寻找关于抑制错误的讲座:)**

我在 PHP 脚本中实例化 Imagick() 类。当请求的页面在 PDF 中不存在时，它会输出错误。我知道这个错误。我知道它为什么会发生，而且我不相信有办法在我的代码中避免它发生，因为它是为大型 PDF 加载完整文件的处理器密集型，我只处理 PDF 的前几页（[请参阅这个问题，如果你认为你有我的 Imagick 问题的解决方案](https://stackoverflow.com/questions/13261189/how-can-i-create-a-specific-number-of-thumbnails-from-a-pdf-using-imagick-image)）。

我想像使用 PHP 函数 ( `@php_function()`) 一样抑制错误输出。也许这是不可能的。

这是输出的错误：

```
Requested FirstPage is greater than the number of pages in the file: 2
No pages will be processed (FirstPage > LastPage). 
```

如果可能的话，我将如何去做？

我已经尝试了这两件事，但意识到 Imagick 类在这里没有输出标准的 PHP 错误：

```
$Image = @new Imagick( $this->file_path_pdf . '[5]' );
$Image = new @Imagick( $this->file_path_pdf . '[5]' ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:23:09.217

在表达式周围加上括号应该可以：

```
$Image = @(new Imagick( $this-file_path_pdf . '[5]' )); 
```

`try`/`catch`仅适用于例外情况。

# jquery - JQPlot 饼图二维能力

> ID：13299591
> 
> 赞同：0
> 
> 时间：2012-11-08T23:15:58.843
> 
> 标签：jquery, jqplot

我正在使用 JQPlot 从 MySQL 表中通过 JSON 提供一个饼图，并试图查看是否有任何大师可以为我回答问题。我的饼图按预期工作，因为它需要一个数组，将其除以总量的百分比，然后显示图表。从这里，是否可以输入另一个值成为饼图的总值，从中减去数组的总值，并显示数组项相对于整个饼图的百分比？

例如，如果我给 JQPlot 这个数组 [[a,2],[b,4],[c,2]]，它将输出一个显示 a=25%, b=50%, c=25 的图表占总馅饼的百分比。我想给它另一个值 10 来表示整个饼图，从而强制该数组输出 a=20%、b=40%、c=20% 并剩余 20%。

我开始使用的代码是来自 JQPlot 站点的基本饼图示例，我希望的总饼图值设置为从 getGrossTotal.php 输入。如果做不到，那就做不到。我只是想看看如何处理它的想法。

```
$(document).ready(function(){
$.getJSON('getGrossTop.php', function(grossTop){

var plot1 = jQuery.jqplot ('pieChart', [grossTop],{ 
    seriesDefaults: {
        renderer: jQuery.jqplot.PieRenderer, 
        rendererOptions: {
            showDataLabels: true
        }
    }, 
    legend: {
        show:true,
        location: 'e'
    },
});

});
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:42:24.583

Nevermind. Instead of trying to handle the extra number in javascript, I went back to the PHP side, totaled the values of each minor array, subtracted that result from the sum of everything in the database, and pushed that result into the major array to encode. It basically made an additional minor array item with a label of nothing and value of the number I wanted. When I passed all that into JQPlot, it gave me what I was looking for. Thanks for all who took a look.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-27T10:49:13.670

If you want to set in at jqPlot level (but i think that this work is cleaner if you work with PHP) I think that it is better to work at the PHP level, however if you need to work on the input data array, you can do it in two ways;

1) Before the $.jqplot() call

you want to add a further element to the array containing the 10% of the sum of all values. So

```
$.getJSON('getGrossTop.php', function(grossTop){

grossTop.push(['d',8.8]); //here you can insert what and many elements you want

var plot1 = jQuery.jqplot ('pieChart', [grossTop],{ 
```

2) After the $.jqplot() call

You need to add the fourth element directly in the jqPlot object

```
plot1.data[0].push(['d',8.8]); 
```

but remember that you need to replot again the chart!

# ios - iOS：为什么我不能以编程方式为按钮设置框架？

> ID：13299594
> 
> 赞同：10
> 
> 时间：2012-11-08T23:16:14.567
> 
> 标签：ios, button, frame

这是一件奇怪的事情，但我无法弄清楚。我无法以编程方式为按钮设置框架。

我有一个带有 IBOutlet 的按钮作为 BeyondViewButton，我将它从视图控制拖到 ViewController.m 文件的@interface 和@end 部分，然后@synthesized 它。

在 viewDidLoad 方法中，我添加了这个：

```
 //x = x + widthToUse * 0.25;
   //y += h + 50;
   x = 50; //either hard code x value or set it mathematically, not working
   y = 300;
   w = 200;
   h = 60;
   //[beyondViewButton setFrame:CGRectMake(x, y, w, h)]; //not working 
   beyondViewButton.frame = CGRectMake(x, y, w, h); //not working
   //[beyondViewButton setBackgroundImage:[UIImage imageNamed:@"bgImage.png"] forState:UIControlStateNormal]; //this line actually works
   //[beyondViewButton setTitle:@"iCool!" forState:UIControlStateNormal];
   [beyondViewButton setTitle:@"iShit!" forState:UIControlStateNormal]; //change from iCool to iShit, I can see change
   //[self.view addSubview:beyondViewButton]; //either adding this line or not, both work 
```

为什么我不能设置框架？

我不知道是否相关的一件事是，这个按钮是在来自导航控制器的“选择视图”中设置的，并转到下一个视图/场景。单击此按钮时，应用程序从“选择视图”移动到下一个视图 --- 这是通过情节提要实现的。我还没有很好地掌握故事板，并且对此有很多不确定性。

任何人都可以对此有所了解吗？谢谢！！

更多诊断信息：我在设置框架代码之前和之后检查了 button.description：

```
 2012[25830:12503] beyond button <UIRoundedRectButton: 0x8821cd0; frame = (0 0; 0 0); opaque = NO; autoresize = TM+BM; layer = <CALayer: 0x8821da0>> 
```

那是之前，之后是之后。有趣的是，帧值不是我设置的，如这里显示的代码，我有 x=50, y=300, w=200, h=60，而 NSLog 描述给出 x=190, y=345, w= 110，h=94，也就是我在运行时看到的位置。这是我在故事板中设置的值。

```
 2012[25830:12503] beyond button <UIRoundedRectButton: 0x8821cd0; frame = (190 345; 110 94); opaque = NO; autoresize = TM+BM; layer = <CALayer: 0x8821da0>> 
```

如果我注释掉代码的设置框架行，当我检查按钮描述时，在按钮设置之前和之后，我得到 0,0,0,0 作为按钮框架 --- 尽管我在视图的下半部分看到按钮. 换句话说，设置框架的行确实以某种方式起作用，但不是我想要的方式。它只需要故事板值，而不是我通过 x,y,w,h 设置的值。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-03-06T17:24:04.433

如果您在界面生成器上启用了自动布局，您还可以从视图中删除按钮，调整大小，然后重新添加。有点像贫民窟，但它有效。

类似的东西...

```
[self.myButton removeFromSuperview];
[self.myButton setTranslatesAutoresizingMaskIntoConstraints:YES];
[self.myButton sizeToFit];
[self.myView addSubview:self.myButton]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-09T01:58:18.863

您的情节提要是否使用了新的自动布局功能？如果是 - 尝试为按钮关闭它。我不熟悉该功能，所以这是盲目的，但我不知道还有什么值得怀疑的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-05T06:59:02.970

使用使用**Autolayout**添加的按钮时，我遇到了大小问题。

添加以下行对我来说效果很好，

```
self.button.sizeToFit()
self.button.transform = CGAffineTransform(scaleX: 1, y: 1) 
```

注意：我也在做按钮的旋转变换动画。

# jquery - 停止脉动 jQuery 效果

> ID：13299595
> 
> 赞同：8
> 
> 时间：2012-11-08T23:16:27.827
> 
> 标签：jquery, jquery-effects

我目前正在使用 kilianvalkhof jQUERY pulsate effet。 [http://kilianvalkhof.com/jquerypulsate/](http://kilianvalkhof.com/jquerypulsate/)

我的目标是在用户单击菜单项时开始对 div 产生影响。

当用户单击不同的菜单项时，我希望黑醋栗主动脉动效果停止，并在不同的 DIV 上启动新的。

我似乎找不到阻止这种影响的方法。

```
 <!-- Menu -->

<div id="user_menu">
       <ui>
        <li id="item1"><a  href="#">Name 1</a></li>
        <li id="item2"><a  href="#">Name 2</a></li>
      </ui>
</div>

<!-- Map -- >

<div id="desk1">

<img src="images/image1.jpg" />

</div>

<div id="desk2">

<img src="images/image1.jpg" />

</div>

//jQuery
$(function() {
    $("#item1")

   .click(function() {
            //$("#desk1").pulsate({color:"#09f"});              

       });

    }); 
```

问题是无法关闭 .pulsate。所以如果你点击 item1 然后点击 item2 两者都会继续跳动直到页面刷新。

有一个选项可以将脉动设置为给定的数字，但理想情况下，我希望它在给定的 div 上保持脉动，直到单击另一个菜单项。

多谢你们。

塞缪尔

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T23:22:04.770

调用destroy来阻止它。

```
$("#YourItemsId").pulsate("destroy"); 
```

# asp.net - 为什么在尝试保存更改时 GridView 行的 DataItem 为空？

> ID：13299596
> 
> 赞同：10
> 
> 时间：2012-11-08T23:16:27.053
> 
> 标签：asp.net, gridview

所以我的网页上有这个 GridView。它是数据绑定的，因此在 RowDataBound 事件期间，此代码运行良好：

```
 protected void myGridView_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.DataRow)
        {
            TimecardApproval shift = (TimecardApproval)e.Row.DataItem;
        }
    } 
```

“shift”变量包含我需要的所有数据，效果很好。但是还有这段代码用于保存数据：

```
 protected void btnSubmitApprovals_Click(object sender, ImageClickEventArgs e)
    {
        foreach (GridViewRow item in gvTimeCards.Rows)
        {
            TimecardApproval shift = (TimecardApproval)item.DataItem;
            // code to update the row
        }
    } 
```

数据项为空！为什么？由于该字段在那里，它为空似乎很奇怪。我应该循环其他东西吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-08T23:35:48.433

我了解您可能希望通过将 DataItem 转换为 TimeCardApproval 来获得智能感知。您可以改为这样做。使用 DataKeyNames 存储应该是的每一行的主键，`TimecardApprovalID`并在您的代码中访问主键并使用它来获取原始项目

```
foreach (GridViewRow item in gvTimeCards.Rows)
{
   //get the ID of the TimeApproval for each row
   string id = gvDocs.DataKeys[item.RowIndex].Value.ToString();
   //string id = ((HiddenField) item.FindControl("IDHiddenField")).Value;
   //string id = item.Cells[0].Text;

   //use the ID or get TimeCardApproval object from DB    
   TimecardApproval shift = MyDB.GetTimeCardApproval(id);

} 
```

设置键

```
<asp:GridView ID="gvTimeCards" DataKeyNames="TimecardApprovalID">
</asp:GridView> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-30T10:59:34.187

也许，这可以帮助您
Grid 列：

```
<asp:TemplateField HeaderText="Item ID">
<ItemTemplate>
    <asp:Label runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "Id") %>'/>
    <asp:HiddenField runat="server" ID="hfDataItem" Value='<%# JsonConvert.SerializeObject(Container.DataItem) %>'/>
</ItemTemplate></asp:TemplateField> 
```

后面的代码：

```
 protected void btApply_OnClick(object sender, EventArgs e)
    {
        var rows = (from GridViewRow row in gvResult.Rows
            where row.RowType == DataControlRowType.DataRow
            let dataItem = (HiddenField) row.FindControl("hfDataItem")
            select JsonConvert.DeserializeObject<ResultGridRowItem>(dataItem.Value));

    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-09T03:45:48.783

在单击按钮之前触发 gridview 数据绑定事件。听起来很奇怪，但那是[asp.net 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472%28v=vs.100%29.aspx)的疯狂。尝试在 gridview`RowUpdating`或`RowUpdated`事件中使用您的代码。

# asp.net-mvc - 具有软删除功能的通用存储库

> ID：13299597
> 
> 赞同：5
> 
> 时间：2012-11-08T23:16:29.970
> 
> 标签：asp.net-mvc, ef-code-first, repository-pattern

我有一个通用的存储库实现。我正在使用 asp.net mvc c#，代码优先实体框架。

我创建了一个名为 ISoftDelete 的接口：

```
public interface ISoftDelete
{
    bool IsDeleted { get; set; }
} 
```

我在我的基础存储库中实现了 Delete 和 GetById，如下所示：

```
 public virtual void Delete(T entity)
    {
        if (entity is ISoftDelete)
        {
            ((ISoftDelete)entity).IsDeleted = true;
        }
        else
        {
            dbset.Remove(entity);
        }
    }

    public virtual T GetById(long id)
    {
        T obj = dbset.Find(id);
        if (obj is ISoftDelete)
        {
            if (((ISoftDelete)obj).IsDeleted)
                return null;
            else
                return obj;
        }
        else
        {
            return obj;
        }
    } 
```

现在，我有 2 个问题。

1）这种方法是一种好方法吗？任何与性能相关的问题？

2）我在基础存储库中的原始 GetAll 函数是这样的：

```
 public virtual IEnumerable<T> GetAll()
    {
            return dbset.ToList();
    } 
```

当 T 从 ISoftDelete 派生时，我应该如何修改它以列出 IsDeleted == false 的记录？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T07:53:57.460

`if (entity is ISoftDelete)`1）每次你需要知道它时检查似乎并不好。如果您确定不会在其他任何地方检查它，那可能没问题。`IsDeleted == true`就性能而言，如果您消除具有但从未从 db 获取它们的记录会更好。您可能需要派生一个新的基础存储库，它会覆盖这些方法并为 ISoftDelete 对象实现新逻辑。

```
public abstract class BaseRepository<T>
{
    // protected dbset;

    public virtual void Delete(T entity)
    {
        dbset.Remove(entity);
    }

    public virtual T GetById(long id)
    {
        return dbset.Find(id);
    }

    public virtual IEnumerable<T> GetAll()
    {
        return dbset.ToList();
    }
}

public abstract class SoftDeleteRepository<T> : BaseRepository<T> where T : ISoftDelete
{
    public override void Delete(T entity)
    {
         entity.IsDeleted = true;
    }

    public override T GetById(long id)
    {
        return (from t in dbSet
                where !t.IsDeleted && t.Id == id select t)
                .FirstOrDefault();
    }

    public override IEnumerable<T> GetAll()
    {
        return (from t in dbset where !t.IsDeleted select t).ToList();
    }
}

public static class RepositoryFactory
{
     public static BaseRepository<T> GetInstance<T>()
     {
          // pseudo code
          if (typeof(T) implements ISoftDelete)
               return repository of T which extends SoftDeleteRepository
          return repository of T which extends BaseRepository
     }
} 
```

2) 可能类似于

```
 return (from t in dbset  where 
       (t is ISoftDelete && !(t as ISoftDelete).IsDeleted) || 
       !(t is ISoftDelete))
 .ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:43:04.667

你的方法对我来说似乎很好。我认为除了在 isDeleted 条件下的测试之外，几乎没有性能损失，这没关系。对于 getAll 你可以试试这个代码：

```
 public virtual IEnumerable<T> GetAll()
    {
        var queryable = dbset;
        if (typeof(ISoftDelete).IsAssignableFrom(typeof(T)))
        {
            queryable = queryable.Where(q => q.IsDeleted == false);
        }

        return queryable.ToList();
    } 
```

# mysql - 导入大型 SQL 文件

> ID：13299612
> 
> 赞同：3
> 
> 时间：2012-11-08T23:17:42.113
> 
> 标签：mysql, sql

我是一名学生，正在进行一些涉及数据挖掘的研究。我有几个志愿者“节点”服务器，它们收集并生成 SQL 文件，供我导入到我的服务器上并进行分析。

问题是，这些文件非常大，我需要一种快速导入它们的方法。网络最近扩展了，现在硬盘驱动器上没有足够的吞吐量让 MySQL 控制台在它们进入时导入它们。时间很重要——研究有一个截止日期，我想事先尽可能多地积极收集，并且没有等待插入的队列。

我想知道是否有更好的方法来导入非常大的文件 - 每个文件的重量约为 100 MB。我试过 "\.myfile.sql"" 但这太慢了。PHPMyAdmin 不会占用那么大的文件。

任何的想法？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:28:38.290

你试过`mysql -uYOU -p < myfile.sql`吗？

升级版：

即使`mysql -uYOU -p < myfile.sql &`您有短暂的远程控制台会话

UPD2：

`mysqlimport`但正如**PinnyM**建议的那样，它使用的最有效方式。假设`name_same_as_table.txt`是带有 DOS 样式 EOL 和制表符分隔字段的文本文件。字段的计数和类型必须与目标表中的相同。

```
mysqlimport -uYOU -p --lock-tables --lines-terminated-by="\r\n" --fields-terminated-by="\t" YOUR_DB name_same_as_table.txt 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-20T07:56:32.143

XAMPP Windows 配置

1.  mysql.ini - 8m 更改为 200m（根据我们的需要）
2.  在 cmd 提示符下导航到 mysql/bin
3.  将你的 sql 文件放在 mysql/bin 文件夹中

cmd: mysql -u 用户名 -p 数据库名 < sqlFile.sql

4.  它询问密码：本地主机中的默认空密码
5.  wait several min(based up on sql file size)_ .. thats all :)

# javascript - optionsValue 和 observable 数组的淘汰赛问题

> ID：13299613
> 
> 赞同：3
> 
> 时间：2012-11-08T23:17:53.197
> 
> 标签：javascript, knockout.js, observable

对于这段代码

```
function Order(name, initialMeal) {
    var self = this;
    self.name = name;
    self.meal = ko.observable(initialMeal);
}

function OrdersViewModel() {
    var self = this;
    self.availableMeals = [
        { menuItem:"Chicken", calories:1000, price:12 },
        { menuItem:"Eggs", calories:900, price:10 },
        { menuItem:"Fries",calories:700, price:15 }
    ];

    self.orders = ko.observableArray([
        new Order("Mike", self.availableMeals[0]),
        new Order("John", self.availableMeals[0]),
        new Order("Larry", self.availableMeals[0])
    ]);
    self.addOrder = function(){
        self.orders.push(new Order("", self.availableMeals[0]));
    }
}
ko.applyBindings(new OrdersViewModel()); 
```

我有以下观点

```
 <tbody data-bind="foreach: orders">
        <tr>
            <td><input data-bind="value: name" /></td>
            <td><select data-bind="options: $root.availableMeals, value: meal, optionsValue: 'price', optionsText: 'menuItem'"></select></td>
            <td data-bind="text: meal().price"></td>
        </tr>
    </tbody> 
```

您可能可以在淘汰赛示例中找到它。问题是最后一个绑定餐（）。当 optionsValue 存在于它之上时，价格似乎不起作用。如果我删除 optionsValue 它工作得很好。我错过了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:43:59.397

是的，你错过了一些东西。

如果不指定，则将一个对象（来自数组）`optionsValue`绑定到订单的属性。绑定查找您绑定的属性，并找到它，因为它找到了这个对象：`meal``availableMeals``meal``price``price``meal`

```
{ menuItem:"Eggs", calories:900, price:10 } 
```

这行得通。

当您指定`optionsValue`as`price`时，您将一个数字绑定到`meal`订单的属性。`price`绑定会查找该号码上不存在的属性`price`。

这都是正确的行为。你应该只`optionsValue`在你真正需要你指定的属性时使用。这通常只有在您想要绑定到`ID`已绑定到下拉列表的某个列表时才需要，例如您可能从数据库中获取的列表。由于您在绑定到的对象上使用其他属性（价格），因此最好让它绑定整个对象，以便以后可以使用整个对象。

# browser - 一个无 GUI 的浏览器

> ID：13299615
> 
> 赞同：2
> 
> 时间：2012-11-08T23:18:03.040
> 
> 标签：browser, web-scraping, twebbrowser

我正在编写一个从多个网站获取信息的工具，都需要我登录。我的正常方法是遵循 Fiddler 或类似的请求和响应，并遵循该直接路径。

不过，这感觉有点严格。网站中的最小更改可能会破坏我的代码。因此，我正在寻找可以使用以下方式的无 UI 浏览器之类的东西：

```
Browser.Load("https://sourceforge.net/account/login.php");
Browser.Document.ElementById("form_loginname").Value = "login";
Browser.Document.ElementById("form_pw").Value = "password";
(Browser.Document.ElementById("login") As WebButton).Click(); // the login button is named "login". 
```

这段代码完成后，我想在普通浏览器中看到我会得到的页面。

像我描述的那样存在吗？

编辑 - C# 支持是首选

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:38:53.653

这很像 Web 应用程序的自动化用户测试，主要区别在于您不拥有经过测试的应用程序。

[Selenium](http://seleniumhq.org/)是一个流行的自动驱动浏览器的库。如果您想以无头方式使用 Selenium 运行程序，您可以使用无头 X 服务器，例如 Xvfb。关于不使用 Xvfb，关于替代品有一个[较老的问题。](https://stackoverflow.com/questions/1966371/running-selenium-headless-without-using-xvfb)

由于 Selenium 可以通过各种编程语言驱动许多浏览器，因此我鼓励您探索 StackOverflow 上的 Selenium 标签。

您特别感兴趣的是[SimpleBrowser.WebDriver](https://github.com/Teun/SimpleBrowser.WebDriver)：用于 .Net 的内存中轻量级浏览器的 Selenium 绑定。实际上，[SimpleBrowser](https://github.com/axefrog/SimpleBrowser)可以直接满足您的需求，而不会增加 Selenium 的复杂性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:39:40.300

我的[Xidel](http://videlibri.sourceforge.net/xidel.html)可以做这样的事情：

例如：

```
 xidel https://sourceforge.net/account/login.php -f 'form((//form)[2], "form_loginname=login&form_pw=password&login=Log in")' --download site.html 
```

（'login=Log in' 是提交按钮的值）

它不支持 JavaScript 通过。我听说有一种叫做 Selenium 的东西...

# java - 如何使用 XML 作为 Java 的模板来读取 HTML？

> ID：13299616
> 
> 赞同：1
> 
> 时间：2012-11-08T23:18:02.363
> 
> 标签：java, html, xml, templates

我有一个 Java 应用程序，它将解析 html 页面并从中提取数据。目前，我有一个类作为模板或说明如何阅读特定网页。该应用程序将需要从几个不同的站点读取，这些站点的格式将不同。我不想为每种格式创建一个新的模板类，而是希望能够读取随附的 XML 文件（或其他文档），该文件将提供有关哪些数据和提取位置的说明。

我试图在互联网上搜索如何做到这一点，但我猜我没有问正确的问题或使用正确的关键字。

该解决方案不必使用 XML 作为模板，但这是我的第一个想法。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:28:06.887

[您可以保留xpath](http://www.w3schools.com/xpath/default.asp)表达式，而不是在 xml 中使用模板，这些表达式映射到您正在阅读的每个站点的所需数据。然后，随着您正在抓取的页面发生变化，您只需更新该站点的 xpath 表达式即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:37:55.893

`Extractor`用于`ExtractionInstructions`从单一来源提取感兴趣的数据。您可以稍后从提取器中检索提取的数据。

在这个高级设计中

*   来源：您要从中提取相同数据的每个页面
*   提取器：每个提取在单个源上运行 1 个实例
*   ExtractionInstructions：一组指令，明确描述从单一来源提取数据的方法。
    *   您可以通过以下方式明确指定说明
        *   标签 ID 和/或
        *   使用 CSS 3 选择器和/或
        *   xpath 等
    *   您可以通过将它们链接在一起（责任链模式）来使用上述所有方法的组合，以获得更多的成功百分比。想法是，如果使用 1 种提取类型找不到数据，那么您可以尝试使用其他选项，直到找到数据或用完说明为止）。

我建议使用[JSoup](http://jsoup.org/)作为基础库来构建这些抽象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:39:21.503

实际上我以前做过类似的事情，但它相当复杂。基本上我做了一个插件系统（像 Maven 一样恶心），你可以参数化提取插件。

您可以使用 Spring Bean XML 作为您的 DSL 来做到这一点。

```
<bean id="strategy1"  class="absolute.class.name">
</bean>

<bean id="extractorExecutor" class="class.to.extractorExecutor">
   <property name="strategies">
    <list>
        <item ref="strategy1" />
        <item ref="strategy2" />
     </list>
    </property> 
</bean> 
```

您的提取器基本上循环通过实现如下接口的 bean：

```
public interface ExtractStrategy {
    /**
     * null means skip this extractor and go to the next one.
     */
    public Extracted extract(String data);
} 
```

在您的提取器中，您可以：

```
for (ExtractorStrategy e : strategies) {
    Extracted ex = e.extract(data);
    if (ex != null) break;
} 
```

Spring 将此称为解析器链模式，也有人将其称为策略模式。

然后，您可以制作像@digitaljoel 所说的 XPath 提取器和/或 Regex Extractor... 等。您将策略按照您希望它们运行的​​顺序排列。

在需要启发式的[数据挖掘](/questions/tagged/data-mining "显示标记为“数据挖掘”的问题")时，我一直使用这种模式。对于提取讨厌的 HTML（在您的评论中提到的其他人），我推荐[**Jericho**](http://jericho.htmlparser.net/docs/index.html)或[JSoup](http://jsoup.org/)（在这种情况下，您可以制定 Jericho 策略并添加到链中）。

# java - 使用 eclipse 部署和测试 rest-webservice

> ID：13299617
> 
> 赞同：1
> 
> 时间：2012-11-08T23:18:10.350
> 
> 标签：java, eclipse, web-services, glassfish, jax-rs

我使用 eclipse + glassfish 从 eclipse 部署了我的第一个 Web 服务。我有以下课程：

```
package com.restfully.shop.services;

import javax.ws.rs.core.*;
import java.util.*;

public class ShoppingApplication extends Application {

    private Set<Object> singletons = new HashSet<Object>();
    private Set<Class<?>> empty = new HashSet<Class<?>>();

    public ShoppingApplication() {
        singletons.add(new CustomerResource());
    }

    @Override
    public Set<Class<?>> getClasses() {
        return empty;
    }

    @Override
    public Set<Object> getSingletons() {
        return singletons;
    }

} 
```

和以下 web.xml：

```
<?xml version="1.0" ?>
<web-app>
 <servlet>
        <servlet-name>Rest</servlet-name>
        <servlet-class>com.restfully.shop.services.ShoppingApplication</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>Rest</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>
</web-app> 
```

只要我读到 glassfish 已经包含球衣 - id 没有将任何内容放入 web 项目的 lib 文件夹中。

但是当我在浏览器中启动应用程序时：

```
Exception

javax.servlet.ServletException: PWC1403: Class com.restfully.shop.services.ShoppingApplication is not a Servlet
root cause

java.lang.ClassCastException: com.restfully.shop.services.ShoppingApplication cannot be cast to javax.servlet.Servlet 
```

glassfish 版本是 3.1.1

我还编写了一个简单的客户端，它通过 java.io.URL 连接到服务，但是那个客户端返回：

```
404
Location:null 
```

服务有什么问题，我该如何解决？+ 将不胜感激 - 服务如何测试？？？是否总是这样 - 编写一个使用这些 URL 连接的测试类，或者是否有任何标准方法来测试 Web 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T07:38:16.033

我猜你的课扩展了[`javax.ws.rs.core.Application`](http://jsr311.java.net/nonav/releases/1.1/javax/ws/rs/core/Application.html)。此外，它应该用 注释[`@javax.ws.rs.ApplicationPath("your_rest_path")`](http://jsr311.java.net/nonav/releases/1.1/javax/ws/rs/ApplicationPath.html)。

使用此注释，您不需要`servlet`. `web.xml`GlassFish 将能够自动拾取它。

您还必须将所有 JAX-RS 资源类添加到`Set`返回的`getClasses()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T07:53:16.193

我没有使用 Glassfish 的经验，但 v3 似乎支持 JAX-RS。

这意味着不需要 javax.ws.rs.core.Application 的子类。

只需使用 web.xml 部署您的 JAX-RS 注释类，如下所示

```
<servlet>  
    <servlet-name>ServletAdaptor</servlet-name>  
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>  
    <load-on-startup>1</load-on-startup>  
</servlet>  

<servlet-mapping>  
    <servlet-name>ServletAdaptor</servlet-name>  
    <url-pattern>/resources/*</url-pattern>  
</servlet-mapping> 
```

随后可以通过将 /resources/ 添加到上下文根来访问您的 REST 应用程序。

# ruby-on-rails - 在 ruby on rails 中，如何验证一系列值的多个属性？

> ID：13299618
> 
> 赞同：5
> 
> 时间：2012-11-08T23:18:13.290
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在一个表中有大约 10 个属性，它们以数字为值，对于每个属性，我想验证是否将 1 - 100 之间的数字传递到输入中。有什么想法可以将下面的代码简化为一种方法验证吗？

目前，对于每个属性，我都在这样做；

`validates_numericality_of :valueone, :less_than_or_equal_to => 100` `validates_numericality_of :valuetwo, :less_than_or_equal_to => 100` `validates_numericality_of :valuethree, :less_than_or_equal_to => 100`

等等

任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T23:26:20.470

我认为你应该使用常量。它将产生更优雅的代码，如下所示：

```
class Whatever
  MIN = 1
  MAX = 100

  validates :valueone, :valuetwo, :valuethree, :length => { :within => MIN..MAX }
end 
```

您可以列出具有与上述相同验证的所有属性。

这应该这样做。=)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T23:20:55.767

`.each`会很好地工作：

```
[:valueone, :valuetwo, :valuethree, ...].each do |n|
  validates n, :numericality => { :greater_than => 0, :less_than_or_equal_to => 100 }
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-02T12:07:07.403

通过添加以下代码进行验证：

```
validates_numericality_of(
  :valueone,
  :valuetwo,
  :valuethree,
  less_than_or_equal_to: 100
) 
```

# c# - 使用 AT 命令将 3g 调制解调器连接到互联网

> ID：13299620
> 
> 赞同：2
> 
> 时间：2012-11-08T23:18:22.633
> 
> 标签：c#, 3g, at-command

家庭项目，并陷入手头的话题。

项目在 c# 中，连接到串行端口，一切都很好，花花公子，然后我在试图让调制解调器上网时卡住了。

读了一下，我得到的第一个信息是：

1.  使用 AT+CGDCONT 设置 apn
2.  使用 ATD“号码”拨号

我有正确的设置，这或多或少什么也没做。调制解调器的响应正常且已连接。

经过更多的挖掘之后，我在拨号前做了一些事情（但仍然没用）：

1.  AT+CGACT=1 PDP上下文激活
2.  AT+CGDATA="PPP",1 进入数据模式

然后我拨入，调制解调器上的 LED 停止闪烁（表示连接处于活动状态），但我仍然无法在线访问任何内容。

显然我错过了一些东西，所以我转向你。

如果可能的话，我想用 AT 命令来做这件事，我以后总是可以转向 RAS :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T03:20:28.707

在意识到根本不实用之后放弃了 AT 命令。通过使用dotRas进行互联网连接完成项目，并使用调制解调器辅助端口通过AT命令发送/接收SMS消息并获取杂项数据（网络模式，信号强度......）

# magento - 目录/product_view 中的自定义块不显示

> ID：13299632
> 
> 赞同：1
> 
> 时间：2012-11-08T23:19:21.573
> 
> 标签：magento

我想修改显示在我的 Magento 网站的产品视图页面上的内容，并且我想创建自己的自定义块以在页面上使用。

# 我做了什么

## 为产品视图句柄创建布局更新

为了更新产品视图页面上显示的内容，我将以下布局更新放入我的`local.xml`文件中：

```
<catalog_product_view>
    <reference name="root">
        <action method="setTemplate"><template>page/1column.phtml</template></action>
    </reference>
    <reference name="content">
        <remove name="product.tierprices" />
        <remove name="product.info.upsell" />
        <remove name="product.clone_prices" />
        <remove name="product.description" />
        <remove name="product.tag.list" />
        <remove name="product.info.addto" />
        <remove name="product.info.addtocart" />
        <remove name="product.info.downloadcontent" />
        <remove name="product.info.extrahint" />
        <remove name="product.info.options.wrapper.bottom" />
        <remove name="product.info.container1" />
        <remove name="product.info.container2" />
        <remove name="alert.urls" />
        <remove name="catalog.compare.sidebar" />
        <remove name="cart_sidebar" />
        <remove name="right.permanent.callout" />
        <remove name="paypal.partner.right.logo" />
        <remove name="right.poll" />
        <remove name="bundle.tierprices" />
        <remove name="product.attributes" />

        <!-- This should override the original product.info block -->
        <block type="catalog/product_view" name="product.info" template="catalog/product/view.phtml">
            <!-- Custom MyNamespace_Videos_Block_Player block -->
            <block type="videos/player" name="videoPlayer" as="videoPlayer" template="video/player.phtml"/>
        </block>

    </reference>
</catalog_product_view> 
```

此时，我确认删除节点有效。显然，因为此时我还没有创建`videos/player`块类，所以什么都没有出现。

## 自定义模块

我通过在下面创建以下文件夹结构创建了一个自定义模块`app/code/local`：

*   我的名字空间
*   我的名字空间/视频
*   MyNameSpace/视频/块
*   我的名字空间/视频/等

我为模块创建了配置文件，并在`MyNameSpace/Videos/etc/config.xml`其中放置了以下 xml 节点：

```
<?xml version="1.0"?>
<config>
    <modules>
        <mynamespace_videos>
            <version>0.0.1</version>
        </mynamespace_videos>
    </modules>
    <global>
        <blocks>
            <videos>
                <class>MyNamespace_Videos_Block</class>
            </videos>
        </blocks>
    </global>
</config> 
```

然后我启用了该模块并验证它是否有效。

## 自定义块类

我在其中创建了一个自定义块，`MyNameSpace/Videos/Block/Player.phtml`其中包含以下内容：

```
class MyNamespace_Videos_Block_Player extends Mage_Core_Block_Template {
    public function _toHtml() {
        echo "Block's _toHtml() method called!";
        parent::_toHtml();
    }
} 
```

## 自定义模板文件

然后我创建了自定义模板文件，`design/frontend/mythemepackage/default/template/video/player.phtml`其中包含以下内容：

```
<!--Check to see if Magento sees this!-->
<?php Mage::log(get_class($this)); ?> 
```

## 修改目录/product/view.phtml

为了让我的`videos/player`块显示在 中`catalog/product/view.phtml`，我将其复制`app/design/frontend/base/default/template/catalog/product/view.phtml`到我的设计包中 `app/design/frontend/mythemepackage/default/template/catalog/product/view.phtml`。

然后我将以下行添加到新复制的视图模板中：

```
<b>This text will show up!</b>
<i>The following wont: </i>
<?php echo $this->getChildHtml('videoPlayer'); ?> 
```

# 结果

使用上述配置，我无法获得`videoPlayer`要渲染的块。

这是我所知道的：

*   我*可以*`catalog/product/view.phtml`在我的文件中看到正常的 html 文本。我看不到回响的内容`$this->getChildHtml('videoPlayer');`
*   *没有*调用类的`_toHtml()`方法， 我看不到模板的任何输出。`MyNamespace_Videos_Block_Player`*`video/player.phtml`*
**   `catalog.xml`如果我从 `app/design/frontend/base/default/layout/catalog.xml`to 复制`app/design/frontend/mythemepackage/default/layout/catalog.xml`然后将我的`videos/player`块添加到其中，我*可以*看到“调用了 Block 的 _toHtml() 方法！” 这已得到`videos/player`区块的回应。以下是添加的内容`catalog.xml`：*

 *```
 <block type="catalog/product_view" name="product.info" template="catalog/product/view.phtml">
        <block type="videos/player" name="videoPlayer" as="videoPlayer" template="video/player.phtml"/>
    </block> 
```

*   即使使用本地版本的`catalog.xml`调用我的块的`_toHtml()`方法，我的模板也没有输出任何内容。

# 问题

我花了很长时间对此进行故障排除。我已经完全删除了缓存`var/cache`并验证了该模块是否处于活动状态并且正在工作。

*   我错过了什么？需要做什么才能让块渲染？
*   为什么在那里复制`catalog.xml`和添加我的块有效，但通过更新`local.xml`无效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T05:58:58.937

你好我想你可以 `<catalog_product_view>`在你的模块中添加标签`layout xml`

```
<catalog_product_view>
     <reference name="content">
         <reference name="product.info">
             <block type="catalog/product_view" name="product.info" template="catalog/product/view.phtml">
                 <block type="videos/player" name="videoPlayer" as="videoPlayer" template="video/player.phtml"/>
             </block> 
         </reference>
    </reference>
</catalog_product_view> 
```

这将帮助你*

# iphone - MKCircleView 和 lineDashPattern

> ID：13299639
> 
> 赞同：1
> 
> 时间：2012-11-08T23:20:01.787
> 
> 标签：iphone, ios

我想为 MKCircleView 创建一个 lineDashPattern，它显示四个大小相等的段，中间有间隙。我认为我遇到的问题是对于 MKCircleView，lineDashPattern 没有使用地图点；它也不是使用像素。或者我的数学错了。我从这个开始为我的叠加层：

```
double radius = 100.0;
double mradius = radius * MKMapPointsPerMeterAtLatitude(coordinate.latitude);
double circumference = mradius * M_PI * 2.0;
double segment = circumference / 4.0;
double line = segment * 0.85;
double gap = segment - line;
MKCircle *circle = [MKCircle circleWithMapRect:[self boundingMapRect]];
self.overlayView = [[MKCircleView alloc] initWithCircle:circle];
overlayView.strokeColor = [UIColor blueColor];
overlayView.lineWidth = 5;
overlayView.lineDashPattern = @[[NSNumber numberWithDouble:line], [NSNumber numberWithDouble:gap]]; 
```

这会产生大量不会给我留下任何差距的数字，但是基于此周长也无济于事，尽管它会产生更小、更可信的数字：

```
CGPoint point = [overlayView convertPoint:[mapView convertCoordinate:coordinate toPointToView:mapView] fromView:mapView];
double circumference = point.x * M_PI * 2.0; 
```

有任何想法吗？

# java - android字节码中单个活动的多个活动文件

> ID：13299641
> 
> 赞同：1
> 
> 时间：2012-11-08T23:20:16.890
> 
> 标签：java, android, testing, android-activity, apk

在我的 android 项目中，我有一个名为 NewsViewActivity.java 的活动。但是当我对apk文件本身进行一些静态分析时，它会显示多个具有相同名称的文件只是$（附加了一些数字）。NewsViewActivity$1.java NewsViewActivity$2.java。

如果我使用方法分析，我也会看到相同的结果。这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:22:39.797

您可能在活动中创建了匿名内部类。由于您没有给匿名内部类命名，因此编译器必须想出某种方式来表示它，这就是它所选择的。看看[为什么带有内部类的 Java 代码会生成第三个 SomeClass$1.class 文件？](https://stackoverflow.com/questions/380406/java-inner-class-class-file-names)了解更多信息。

# matlab - 如何计算多元正态概率密度函数的导数

> ID：13299642
> 
> 赞同：6
> 
> 时间：2012-11-08T23:20:24.030
> 
> 标签：matlab, probability, gaussian

是否有任何内置函数计算给定点的多元正态概率密度函数的梯度值？

编辑：发现这个[如何在matlab中评估函数的导数？](https://stackoverflow.com/questions/4658656/how-to-evaluate-derivative-of-function-in-matlab)但这不是我要找的

Edit2: 好的，这就是我正在使用的[http://www.mathworks.co.uk/help/stats/mvnpdf.html](http://www.mathworks.co.uk/help/stats/mvnpdf.html)案例 3，寻找关于 X 的导数值

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T01:32:23.013

我可以建议您查看 Peterson 和 Pedersen 的 The Matrix Cookbook（可在线免费获得 - 只需 google 即可）。您的问题的解析解在 p39，方程 325（2008 年版）。

我们甚至不需要 Matlab 来做这个！

**编辑：**正如 YBE 所暗示的，也许我应该在我的答案中包含解决方案。因此，设 p(x) 表示多元高斯 pdf，以均值向量 m 和协方差矩阵 S 为特征。然后：

dp(x) / dx = -p(x) * S^(-1) * (x - m)

和

d^2p / dx dx' = p(x) * (S^(-1) (x - m)(x - m)' S^(-1) - S^(-1))

如果你想要一个 Matlab 函数，那么：

```
function Gradient = MultNormD1(x, Mu, Sigma)
Gradient = -1 * mvnpdf(x, Mu, Sigma) * (Sigma \ (x - Mu)); 
```

# grails - 在 Grails 2 Web 应用程序过滤器中定义多个不同的 URI

> ID：13299644
> 
> 赞同：6
> 
> 时间：2012-11-08T23:20:33.730
> 
> 标签：grails, filter

是否可以使用 Grails 2 Web 应用程序过滤器定义多个不同的 URI？

例如，类似：

```
def filters = {
    someFilterMethod(uri: '/auth/**|/*/user/modify') {
        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T10:02:27.620

[这是一个未解决的问题](http://jira.grails.org/browse/GRAILS-3137)，计划在 Grails 2.3 中修复（根据 JIRA 条目）。

作为一种解决方法，您可以提取公共代码块以供多种过滤方法使用。

# javascript - 如何在 HTML 文件中删除图像周围的边框

> ID：13299655
> 
> 赞同：-5
> 
> 时间：2012-11-08T23:21:41.307
> 
> 标签：javascript, html, css

有人可以帮我删除这个“加号”图像的边框吗？

```
<div id="Drop Image and Advance Search" style="margin-left: 0px">
    <img id='downarrow' style='float: left;'
        border=none src=".\images\button_plus.gif"
        width="20" height="20"
        onclick="javascript:toggle();"> 
    <img id='uparrow'
        style='display: none; float: left;'
        border=none src=".\images\button_minus.gif"
        width="20" height="20"
        onclick="javascript:toggle();"> 
    <a href="javascript:toggle();"> <u><h4>Advance Search</h4></u></a>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:23:57.240

你应该使用`border="0"`而不是`border=none`

或者更好的是，因为从 HTML 4.01（源[MDN](https://developer.mozilla.org/en-US/docs/HTML/Element/Img)）开始不推荐使用border 属性，所以添加一个样式

```
<img style="border:0" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:24:18.313

尝试：

```
<img border="0" src=".\images\button_minus.gif" width="20" height="20"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T12:41:05.827

像使用 css

```
img {
    border: 0 none;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-08T23:34:09.963

需要使用`style="border:0"`

```
 <div id="Drop Image and Advance Search" style="margin-left: 0px">

        <img id='downarrow' style='float: left; border:0px;'
            src=".\images\button_plus.gif"
            width="20" height="20"
            onclick="javascript:toggle();"> 
        <img id='uparrow'
            style='display: none; float: left; border:0px;'
             src=".\images\button_minus.gif"
            width="20" height="20"
            onclick="javascript:toggle();"> 
            <a href="javascript:toggle();"> <u><h4>Advance Search</h4></u></a>
    </div> 
```

# jquery - history.js 状态在 IE9 中不起作用

> ID：13299658
> 
> 赞同：0
> 
> 时间：2012-11-08T23:21:51.140
> 
> 标签：jquery, html, internet-explorer-9, history.js

我正在使用[history.js](https://github.com/devote/HTML5-History-API/)脚本来管理 HTML5 历史状态更改。我的代码在最新版本的 Chrome 和 Firefox 中运行良好，但无法在 IE9 中运行。我已经尝试了 github 站点上提供的 history.js 和 history.iegte8.min.js 脚本。

我选择这个脚本的原因是因为它遵循与正确的 HTML5 API 相同的语法，这意味着当用户最终进入 IE10 时所做的更改最少。

这是代码。

```
 <!-- Placed at the end of the document so the pages load faster -->
<script src="js/jquery-1.8.2.min.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script src="js/history.iegte8.min.js"></script>

<script type="text/javascript">

    $(function() {

        $(window).bind('popstate', function( e ) {

            var historyState = history.state;
            if ( historyState ) {
                loadContent(historyState.link)
            } else {
                // Open Business Unit Reporting folder
                $('#item-2').prop('checked',true);
            }
        });         

        $('li a').click(function(e) {
            var latestLink = '<li>' + getLabelHierarchy(this) + '<a href="'+$(this).attr('href')+'">'+$(this).html()+'</a></li>';
            var historyList = latestLink + $('#historyList').html();
            history.replaceState({link: historyList}, null, null);              
        });

        $(window).trigger( "popstate" );

    });

    function getLabelHierarchy(node) {
                << code omitted >>
    }

    function loadContent(links) {
        $('#historyList').append(links);
    }

</script> 
```

有人在 IE9 中使用过这个脚本吗？
非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:57:49.397

当您使用 History js 时，它是大写 H，而不是小写 h 在处理历史时，您使用的是 window.history，而不是 history.js History 对象。

你需要使用[`getState()`](https://github.com/balupton/history.js/blob/master/README.md)

```
var historyState = History.getState(); 
```

您还需要在引用它的其他任何地方使用历史记录。阅读 History.js 的自述文件。

# c - 递归二叉树

> ID：13299659
> 
> 赞同：0
> 
> 时间：2012-11-08T23:21:54.203
> 
> 标签：c, recursion, binary-tree

关键是打印一个二叉树，例如：

```
-------x--------
---x-------x----
-x---x---x---x--
x-x-x-x-x-x-x-x-
xxxxxxxxxxxxxxxx 
```

我的代码是：

```
#include <stdio.h>
#include <math.h>

#define LENGTH 16

void makeBranches(int left, int right, char a[][LENGTH], int);
void display(char a[][LENGTH], int);

void main(){
  int i, lines;
  double a;

  a = log10(LENGTH*2)/log10(2);
  lines = (int)a; 
  char array[lines][LENGTH];

  makeBranches(0, LENGTH-1, array, 0);
  display(array, lines);
}

void makeBranches(int left, int right, char a[][LENGTH], int line){

  if(left >= right){
    a[line][left] = 'X';
    return;
  } else{
    a[line][(right+left)/2] = 'X';
    makeBranches(left, (right+left)/2, a, line+1);
    makeBranches((right+left)/2+1, right, a, line+1); 
  }
}

void display(char a[][LENGTH], int lines){
  int i, j;

  for(i = 0; i < lines; i++){
    for(j = 0; j < LENGTH; j++){
      if(a[i][j] == 'X')
    printf("%c", a[i][j]);
      else
    printf("-");      
    }
    printf("\n");
  }
} 
```

这适用于 4、8、16 的 LENGTH 值，但是当您尝试 32、64 等时，它有一些杂散的 X。例如：

长度 32

```
---------------X----X-------X---
-------X---------------X--------
---X-------X-------X-------X----
-X---X---X---X---X---X---X---X--
X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
```

长度 64

```
-------------------------------X--------------------------------
---------------X-------------------------------X----------------
-------X---------------X---------------X---------------X--------
---X-------X-------X-------X-------X-------X-------X-------X----
-X---X---X---X---X--XX---X--XX---X---X---X---X---X---X---X---X--
X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX 
```

这必须是某个地方的简单修复，但我只是看不到它。希望有人可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:39:25.203

```
char array[lines][LENGTH]; 
```

这将创建一个空数组，其中每个值都是当前内存中的任何值（有时为 0，但不保证为 0）。这意味着有时，内存会随机包含一个“X”字节。您可以通过将数组初始化为全 0（即空字符，而不是 '0'）来解决此问题：

```
memset(array, 0, LENGTH * lines); 
```

或者：

```
for(size_t i = 0; i < lines; i++){
    for(size_t j = 0; j < LENGTH; j++){
        a[i][j] = 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:40:24.603

您`array`是 中的局部变量`main`，并且您从不初始化它的大部分值。未显式初始化的局部变量一开始就包含“随机垃圾”——这并不是真正的“随机”，但足够“垃圾”，您无法确定某些位置不会意外包含值“X”最初。

首先循环整个数组并将所有位置初始化为已知的值。

（吹毛求疵的语言律师会知道，“随机垃圾”在技术上并不是针对单元化本地人所发生的事情的正确术语，但它足以在实际编程中用作心理模型）。

# opengl - 使用 VBO 渲染正方形

> ID：13299662
> 
> 赞同：1
> 
> 时间：2012-11-08T23:22:27.420
> 
> 标签：opengl, vbo, opengl-3

我在理解如何使用 VBO 时遇到了一些麻烦。我一直在尝试获得相当于以下内容的图像：

```
glMatrixMode (GL_PROJECTION);
glLoadIdentity ();
gluPerspective (70, 4.0f / 3, 1, 1000);

glMatrixMode (GL_MODELVIEW);
glLoadIdentity ();

gluLookAt (0, 0, -5,
           0, 0,  0,
           0, 1,  0);

glBegin (GL_TRIANGLES);
glVertex3f (-1, -1, -1);
glVertex3f (1, -1, -1);
glVertex3f (1, 1, -1);
glVertex3f (-1, -1, -1);
glVertex3f (1, 1, -1);
glVertex3f (-1, 1, -1);
glEnd (); 
```

这导致一个白色的正方形。根据我从各种教程中收集到的信息，使用 VBO 应该将代码更改为：

```
float vertexes[][3] = {
    { 1,  1, -1},
    { 1, -1, -1},
    {-1,  1, -1},
    {-1, -1, -1},
};

unsigned int indexes[] = {
    3, 1, 0,
    3, 0, 2,
};

GLuint vbo, ibo;

glGenBuffers (1, &vbo);
glBindBuffer (GL_ARRAY_BUFFER, vbo);
glEnableClientState (GL_VERTEX_ARRAY);
glVertexPointer (3, GL_FLOAT, 0, 0);

glGenBuffers (1, &ibo);
glBindBuffer (GL_ELEMENT_ARRAY_BUFFER, ibo);

glMatrixMode (GL_PROJECTION);
glLoadIdentity ();
gluPerspective (70, 4.0f / 3, 1, 1000);

glMatrixMode (GL_MODELVIEW);
glLoadIdentity ();

gluLookAt (0, 0, -5,
       0, 0,  0,
       0, 1,  0);

glBufferData (GL_ARRAY_BUFFER, sizeof vertexes, vertexes, GL_STATIC_DRAW);
glBufferData (GL_ELEMENT_ARRAY_BUFFER, sizeof indexes, indexes, GL_STATIC_DRAW);

glDrawElements (GL_TRIANGLES, 2, GL_UNSIGNED_INT, 0); 
```

但是，这不会渲染任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:49:38.350

VBO 用于向 OpenGL 渲染系统提供数据，但您需要握住他的手并引导他通过它......

1.  告诉他他需要绘制哪些顶点以及相同的笛卡尔坐标。你做得对。

2.  接下来你需要告诉他如何做到这一点。这是由数组索引数组完成的。这也是您正确完成的。

但我有一种感觉，这是因为在连续调用 glBindBuffer() 之间你没有清除缓冲区，所以它很难将它放入哪个缓冲区。

请看这个样本（我写的）

```
void InitVBO() 
{
    glGenBuffers(noOfVBO, vboHandle);   // create an interleaved VBO object
    for(int i =0;i<noOfVBO;i++)
    {
        glBindBuffer(GL_ARRAY_BUFFER, vboHandle[i]);   // bind the first handle 
        glBufferData(GL_ARRAY_BUFFER, sizeof(Vertex)*masterNumberVertices[i], masterSolidVertex[i], GL_STATIC_DRAW); // allocate space and copy the position data over
        glBindBuffer(GL_ARRAY_BUFFER, 0);   // clean up 
        glGenBuffers(1, &indexVBO[i]); 
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexVBO[i]); 
        glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(GLuint)*masterNumberIndices[i], masterSolidIndices[i], GL_STATIC_DRAW);  // load the index data 
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER,0);  // clean up
    } 
  // by now, we moved the position and color data over to the graphics card. There will be no redundant data copy at drawing time 
} 
```

这就是方形绘图程序。

```
//Draw Cube 
  glBindBuffer(GL_ARRAY_BUFFER, vboHandle[3]); 
  glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexVBO[3]); 
  glVertexPointer(4,GL_FLOAT, sizeof(Vertex),(char*) NULL+0); 
  glNormalPointer(GL_FLOAT, sizeof(Vertex),(char*) NULL+16); 
  glColorPointer(4,GL_FLOAT,  sizeof(Vertex),(char*) NULL+32);
  glMatrixMode(GL_PROJECTION); 
  glLoadIdentity(); 
  gluPerspective(60, 1, .1, 100); 
  glMatrixMode(GL_MODELVIEW); 
  glLoadIdentity(); 
  gluLookAt(5,0,0,0,0,0,0,0,1); 
  glRotatef(x_angle, 0, 0,1); 
  glRotatef(y_angle, 0,1,0); 
  glScalef(scale_size, scale_size, scale_size); 
  glTranslatef(0,-1.5,-1.5);
  //glScalef(1,5,5); 
  glDrawElements(GL_QUADS, masterNumberIndices[3], GL_UNSIGNED_INT, (char*) NULL+0); 
```

希望这可以帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T11:15:49.517

找出我的错误是什么。这个电话：

```
glDrawElements (GL_TRIANGLES, 2, GL_UNSIGNED_INT, 0); 
```

要求 OpenGL 绘制一个带有两个顶点的三角形，而不是像我想的那样绘制两个带有三个顶点的三角形。正确的调用是：

```
glDrawElements (GL_TRIANGLES, 6, GL_UNSIGNED_INT, 0); 
```

# php - 如何将 unicode 转换为 MySQL PHP

> ID：13299666
> 
> 赞同：1
> 
> 时间：2012-11-08T23:22:49.243
> 
> 标签：php, unicode, utf-8

我的网站获取输入并将其转换为 Unicode，如下所示：

```
6;&#172;&#216;&#167;&#216;&#175; &#216;&#168;&#216;&#167;&#216;&#178;&#219;&#140; 
```

并将其放入数据库中。

PHP 代码可以得到这个并将其翻译成 UTF-8 文本吗？并在数据库中再次导入？

我知道如何获取数据以及如何将其放入数据库，但我只是不知道如何使用 PHP 将这种类型的 Unicode 转换为普通文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:25:30.960

我认为您正在寻找[`htmlentities_decode`](http://php.net/html-entity-decode)实际角色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T08:13:01.357

您可以尝试在文件顶部显式添加内容类型，如下所示

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

进而

```
$string = '6;&#172;&#216;&#167;&#216;&#175; &#216;&#168;&#216;&#167;&#216;&#178;&#219;&#140;';
echo html_entity_decode($string); 
```

在保存到数据库之前，您需要

```
htmlentities($string, ENT_QUOTES, "UTF-8"); 
```

# mysql - Mysql查询以查找一列满足多个条件的ID

> ID：13299670
> 
> 赞同：2
> 
> 时间：2012-11-08T23:23:31.097
> 
> 标签：mysql, sql, select

我将不胜感激创建此查询的任何帮助。我尝试了几种方法都没有运气。由于我的问题对我来说有些难以表达，我将举一个简单的例子来说明我想做的事情。我的数据在结构上类似于以下内容：

```
ID  TYPE  COLOR
1   A     Blue
1   B     Red
1   C     Green
2   C     Blue 
2   B     Green 
```

如果我有一个具有两种特定颜色的 ID，我想创建一个查询以返回类型。例如，我想查找所有同时具有蓝色和红色的 ID。然后查询将返回：

```
1, A , B 
```

返回 A 和 B 的顺序并不重要。数据集很大，我希望很多 ID 都符合这两个条件（可能是 50,000 左右）。我应该注意，类型与颜色无关，因此使问题与[其他 stackoverflow 问题](https://stackoverflow.com/questions/11419145/select-distinct-values-for-multiple-rows-of-same-id)以及[这个](https://stackoverflow.com/questions/4559398/mysql-select-one-field-from-table-where-condition-is-in-multiple-rows)问题不同。

我想我需要做一个子查询。但是真的不知道如何进行，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:26:14.740

```
SELECT ID, TYPE FROM types NATURAL JOIN (
  SELECT ID FROM types GROUP BY ID HAVING SUM(COLOR='Red') AND SUM(COLOR='Blue')
) t WHERE COLOR IN ('Red', 'Blue') 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/345c7/1/0)上查看。

或者，如果您乐于将类型连接到分隔字符串中，则可以一次提取所需的数据：

```
SELECT   ID, GROUP_CONCAT(TYPE)
FROM     types
WHERE    COLOR IN ('Red', 'Blue')
GROUP BY ID
HAVING   COUNT(*) = 2 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/345c7/3/0)上查看。

请注意，如果您的表可能包含具有相同`(ID, COLOR)`对的多条记录，则应替换`COUNT(*)`为更昂贵的`COUNT(DISTINCT COLOR)`.

# java - IE 和 FF 中未出现打印窗口 - net.sf.jasperreports.engine.export.JRPdfExporter

> ID：13299676
> 
> 赞同：1
> 
> 时间：2012-11-08T23:24:04.210
> 
> 标签：java, pdf, printing, jasper-reports

> **可能重复：**
> [生成pdf后如何打开打印对话框](https://stackoverflow.com/questions/8733276/how-to-open-print-dialog-after-pdf-generated)

```
ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();

JRPdfExporter pdfExporter = new JRPdfExporter();
pdfExporter.setParameter(JRExporterParameter.JASPER_PRINT, jp);
pdfExporter.setParameter(JRExporterParameter.OUTPUT_STREAM, byteArrayOutputStream);

if (isPrint) {
    pdfExporter.setParameter(JRPdfExporterParameter.PDF_JAVASCRIPT, "this.print();");
}

try {
    pdfExporter.exportReport();
} catch (JRException e) {
    log.error("Exception exporting pdf report");
    throw new PrintExportException(e);
}

return byteArrayOutputStream; 
```

这是一个*Java*方法的片段，它使用***JRPdfExporter***返回一个 pdf 文档——它在所有浏览器中都可以正常工作，除了*IE*和*FF*的问题。如果文档要直接发送到打印机，则该`if (isPrint)`语句设置一个*JavaScript*来打印文档，而不是呈现文档以供下载。

在*IE*和*FF*中 - 可能 20 次中的一次这不起作用。打印预览对话框只是没有出现。之后，我可以尝试再次生成文档并且它可以工作，所以这似乎是一个间歇性问题。没有控制台错误。

这段代码有什么问题吗？我一直无法确定它。

# linux - copy_from_user 无法将数据从用户空间复制到内核缓冲区

> ID：13299681
> 
> 赞同：0
> 
> 时间：2012-11-08T23:24:24.227
> 
> 标签：linux, copy, kernel, arm, buffer

我正在尝试将缓冲区从用户空间复制到内核空间。这

在用户空间（代码简化）：

```
int user_write (){
int64_t *decoded_buffer = (int64_t *)malloc(decoded_buffer_size_bytes) ;

<fill the buffer>

write(file_description, (void *)decoded_buffer, decoded_buffer_size_bytes);
free(decoded_buffer);
return 0;
} 
```

在内核空间中（代码简化）：

```
static ssize_t gpio_write(struct file *file, 
                          const char *buffer, 
                          size_t size, 
                          loff_t *offset)
{
    ssize_t result;
    //int counter;  
    int *kernelspace_buffer = (int *)kmalloc(size, GFP_KERNEL);

    result = copy_from_user(kernelspace_buffer, buffer, size);  
    if (result) {
        printk(KERN_INFO "copy_from_user failed, returned: %d\n.", result);
        return -EINVAL; 
    }

    result = driver_write(kernelspace_buffer, size);
    kfree((void *)kernelspace_buffer);        
    return result;
} 
```

我一直在用 65536 字节的数据填充 decoded_buffer 并尝试写入。每次我写，copy_from_user 失败并返回 63648（意味着只复制了 1888 个字节）。我尝试过使用不同大小的缓冲区，但 copy_from_user 总是失败（为不同大小的缓冲区返回不同的值）。我对 copy_from_user 做错了什么？

我在 linux 2.6.39.4 一个 ARM9 处理器上运行。

# ios - UIView inputView 滑动动画

> ID：13299682
> 
> 赞同：0
> 
> 时间：2012-11-08T23:24:26.080
> 
> 标签：ios, cocoa-touch, uiview, uikeyboard, inputview

1.  我有带有自定义 inputView 的 UIView（实现 UIKeyInput）。我想在整个视图可见时立即显示这个 inputView，但是在它成为第一响应者之后会有幻灯片动画。我可以禁用此动画并立即显示 inputView 吗？

2.  当我长按它时，我可以上下移动这个 inputView。我怎样才能禁用它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-23T07:39:33.800

实际上，您可以`[UIView setAnimationsEnabled:NO]`在调用之前使用禁用默认动画`becomeFirstResponder`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T21:56:25.893

我没有找到任何方法来实现这一点。然而，将 inputView 转换为 childViewController 很简单，并且没有任何限制。

# javascript - IE10 发送带小数（浮点值）的图像按钮单击坐标导致 ParseInt32 FormatException

> ID：13299685
> 
> 赞同：26
> 
> 时间：2012-11-08T23:24:48.807
> 
> 标签：javascript, asp.net, internet-explorer-10

似乎 ASP.NET 4.0 不准备处理由 Internet Explorer 10 触发的 ImageButton 事件。问题是 IE10 将图像点击坐标作为双精度值（带小数）发送，而 ASP.NET 尝试将它们解析为整数，呈现以下类型的错误：

```
System.Web.HttpUnhandledException (0x80004005): 
   Exception of type 'System.Web.HttpUnhandledException' was thrown. 
   ---> System.FormatException: Input string was not in a correct format.

   at System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal)
   at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info)
   at System.Web.UI.WebControls.ImageButton.LoadPostData(String postDataKey, NameValueCollection postCollection)
   at System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.members_addtocartlogin_twostep_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework64\v4.0.30319\Temporary ASP.NET Files\root\932deaba\63ff7eeb\App_Web_MyPage.aspx.28424a96.oraym_un.0.cs:line 0
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

谷歌搜索，有人建议强制 IE10 在兼容性视图中运行。但是，添加元标记`<meta http-equiv="X-UA-Compatible" content="IE=10" />`并不能解决任何问题；并且`<?xml version="1.0" encoding="UTF-8">`之前添加`<!DOCTYPE>`也不起作用。

有什么解决办法吗？我可以使用 Javascript 捕获点击事件并以某种方式删除小数吗？

**注意：**升级到 Framework 4.5 并重新编译修复了该错误。无需更改运行时版本，因为它仍然是 4.0。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-31T13:28:52.037

.NET CLR 2.0 和 4.0 有修补程序，如[Scott Hanselmann 的这篇博文](http://www.hanselman.com/blog/BugAndFixASPNETFailsToDetectIE10CausingDoPostBackIsUndefinedJavaScriptErrorOrMaintainFF5ScrollbarPosition.aspx)所述：

> `\Windows\Microsoft.NET\Framework\<version>\Config\Browsers`修复程序所做的是使用这些浏览器定义的新版本和面向未来的版本更新 ie.browser 和 firefox.browser 文件。没有其他任何影响。

.NET 4

*   [http://support.microsoft.com/kb/2600088](http://support.microsoft.com/kb/2600088)

.NET 2.0

*   [http://support.microsoft.com/kb/2600100](http://support.microsoft.com/kb/2600100)适用于 Win7 SP1/Windows Server 2008 R2 SP1、Windows Vista/Server 2008、Windows XP/Server 2003

*   [http://support.microsoft.com/kb/2608565](http://support.microsoft.com/kb/2608565)适用于 Win7/Windows Server 2008 R2 RTM

或者，有一个基于客户端的 javascript 补丁（最初作为解决方法发布在[Connect 项目上，错误 ID:755419](https://connect.microsoft.com/VisualStudio/feedback/details/755419/asp-net-4-0-and-ie10-click-on-imagebutton-in-updatepanel-produces-error-click-on-normal-button-does-not)）：

```
$(function () {
    // Patch fractional .x, .y form parameters for IE10.
    if (typeof (Sys) !== 'undefined' && Sys.Browser.agent === Sys.Browser.InternetExplorer && Sys.Browser.version === 10) {
        Sys.WebForms.PageRequestManager.getInstance()._onFormElementActive = function Sys$WebForms$PageRequestManager$_onFormElementActive(element, offsetX, offsetY) {
            if (element.disabled) {
                return;
            }
            this._activeElement = element;
            this._postBackSettings = this._getPostBackSettings(element, element.name);
            if (element.name) {
                var tagName = element.tagName.toUpperCase();
                if (tagName === 'INPUT') {
                    var type = element.type;
                    if (type === 'submit') {
                        this._additionalInput = encodeURIComponent(element.name) + '=' + encodeURIComponent(element.value);
                    }
                    else if (type === 'image') {
                        this._additionalInput = encodeURIComponent(element.name) + '.x=' + Math.floor(offsetX) + '&' + encodeURIComponent(element.name) + '.y=' + Math.floor(offsetY);
                    }
                }
                else if ((tagName === 'BUTTON') && (element.name.length !== 0) && (element.type === 'submit')) {
                    this._additionalInput = encodeURIComponent(element.name) + '=' + encodeURIComponent(element.value);
                }
            }
        };
    }
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-28T06:57:48.407

**只需安装 .NET Framework 4.5 即可解决此问题。**

即使您不将应用程序池切换到 .NET Framework 4.5，这也可以解决问题。

就我而言，我将应用程序池保留在 .NET Framework 3.5 中。显然安装 .NET Framework 4.5 会覆盖其他框架版本的一些文件。

由于安装新的 .NET Framework 版本非常容易，因此在使用修补程序（对我不起作用）或其他解决方案之前可能值得一试。

[请参阅此处](https://connect.microsoft.com/VisualStudio/feedback/details/755419/asp-net-4-0-and-ie10-click-on-imagebutton-in-updatepanel-produces-error-click-on-normal-button-does-not)的解决方法部分

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-05-24T14:53:29.403

这是一个 JavaScript 解决方法。它覆盖现有方法，设置 x 和 y 坐标，然后使用这些新坐标调用现有方法。

```
Sys.WebForms.PageRequestManager.getInstance()._origOnFormActiveElement = Sys.WebForms.PageRequestManager.getInstance()._onFormElementActive;
Sys.WebForms.PageRequestManager.getInstance()._onFormElementActive = function(element, offsetX, offsetY){
    if (element.tagName.toUpperCase() === 'INPUT' && element.type === 'image'){
        offsetX = Math.floor(offsetX);
        offsetY = Math.floor(offsetY);
    }
    this._origOnFormActiveElement(element, offsetX, offsetY);
}; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-06-14T15:08:20.807

如[另一个答案](https://stackoverflow.com/a/15129393/1127114)所述，此问题已在 .NET 4.5 中修复。

对于无法升级到 .NET 4.5 的用户，Microsoft 已发布更新以解决 .NET 4.0 ( [KB2836939](http://support.microsoft.com/kb/2836939) ) 和 .NET 3.5 ( [KB2836942](http://support.microsoft.com/kb/2836942)和[KB2836943](http://support.microsoft.com/kb/2836943) ) 的此问题。

以下是这些知识库文章描述该问题的方式：

> 当您使用 Internet Explorer 10 及更高版本单击基于 ASP.NET 的网页上更新面板内的 ImageButton 控件时，部分回发操作将失败。此外，不会触发服务器端单击事件。

作为参考，这`ImageButton.LoadPostData`是抛出的原始代码`FormatException`：

```
protected virtual bool LoadPostData(string postDataKey, NameValueCollection postCollection) {
    string name = UniqueID;
    string postX = postCollection[name + ".x"];
    string postY = postCollection[name + ".y"];
    if (postX != null && postY != null && postX.Length > 0 && postY.Length > 0) {
        x = Int32.Parse(postX, CultureInfo.InvariantCulture);
        y = Int32.Parse(postY, CultureInfo.InvariantCulture);
        if (Page != null) {
            Page.RegisterRequiresRaiseEvent(this);
        }
    }
    return false;
} 
```

这是固定代码：

```
protected virtual bool LoadPostData(string postDataKey, NameValueCollection postCollection) { 
    string name = UniqueID;
    string postX = postCollection[name + ".x"];
    string postY = postCollection[name + ".y"];
    if (postX != null && postY != null && postX.Length > 0 && postY.Length > 0) {
        x = (int)ReadPositionFromPost(postX);
        y = (int)ReadPositionFromPost(postY);
        if (Page != null) {
            Page.RegisterRequiresRaiseEvent(this);
        }
    }
    return false;
}

internal static double ReadPositionFromPost(string requestValue) {
    NumberStyles style = NumberStyles.AllowDecimalPoint | NumberStyles.Integer;
    return double.Parse(requestValue, style, CultureInfo.InvariantCulture);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-06T02:48:56.963

只需将其放在每个页面或母版页的标题中：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

这将强制 IE10 进入 IE9 标准文档模式，并且它可以很好地处理图像回发。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-23T09:43:37.500

如果你按 F12 并手动切换到 IE9，它就像一个魅力。所以我们的方法是使用 content="IE=9" 但这只是在 IE10 中切换文档模式而不是浏览器模式，这似乎还不够。

也许有人对如何切换文档模式也有想法？

另一种越来越流行的解决方法是覆盖 LoadPostData，请参阅

[http://www.codeproject.com/Tips/496162/IE10-and-ImageButtons?display=Mobile](http://www.codeproject.com/Tips/496162/IE10-and-ImageButtons?display=Mobile) [http://forums.asp.net/t/1823287.aspx/2/10](http://forums.asp.net/t/1823287.aspx/2/10)

就我个人而言，我会发现 content="IE=9" 是最好的解决方案，因为它几乎没有额外的工作和影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T01:21:42.407

我最终对 ImageButton 进行了子类化，并在数据被传入进行处理之前对其进行了更正。

```
using System;
using System.Collections.Specialized;
using System.ComponentModel;
using System.Security.Permissions;
using System.Web;
using System.Web.UI;

namespace Xception.WebControls
{
    [AspNetHostingPermission(SecurityAction.Demand, Level = AspNetHostingPermissionLevel.Minimal),
    AspNetHostingPermission(SecurityAction.InheritanceDemand, Level = AspNetHostingPermissionLevel.Minimal),
    DefaultEvent("Click"),
    ToolboxData("<{0}:ImageButton runat=\"server\"> </{0}:ImageButton>")]
    public class ImageButton : System.Web.UI.WebControls.ImageButton
    {
        protected override bool LoadPostData(string postDataKey, NameValueCollection postCollection)
        {
            NameValueCollection newCollection = new NameValueCollection();

            foreach (string key in postCollection.AllKeys)
            {
                if (key.Equals(this.UniqueID + ".x", StringComparison.InvariantCultureIgnoreCase))
                    newCollection[this.UniqueID + ".x"] = Convert.ToInt32(Convert.ToSingle(postCollection[this.UniqueID + ".x"])).ToString();
                else if (key.Equals(this.UniqueID + ".y", StringComparison.InvariantCultureIgnoreCase))
                    newCollection[this.UniqueID + ".y"] = Convert.ToInt32(Convert.ToSingle(postCollection[this.UniqueID + ".y"])).ToString();
                else
                    newCollection[key] = postCollection[key];
            }

            return base.LoadPostData(postDataKey, newCollection);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-04T20:10:09.917

实际上与 tkrause 列出的问题不同。有一个可用的修补程序，虽然我不知道如何应用它。以下是那些知道如何应用这些的信息：

[http://support.microsoft.com/kb/2784147](http://support.microsoft.com/kb/2784147)

如果您检查 ASP.NET 部分是否有此问题中所述的确切错误。这也是我遇到的确切错误和问题。

我想我无法获得更新，因为我使用的是 Server 2003。我使用的是 ASP.NET 3.5 和 VS 2008，所以升级到 4.x 对我来说不是一个简单的选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-29T06:59:46.053

就我而言，我目前无法将 .Net 升级到 4.5，并且我不想使用 JavaScript 来修补错误。

我采用的解决方案是将 ImageButton 转换为 LinkBut​​ton：

这是我的 ImageButton：

```
<asp:ImageButton ID="MyButton" runat="server" CausesValidation="false" ToolTip="my tooltip" ImageUrl="../Images/button.gif" OnClick="MyButton_Click" ></asp:ImageButton> 
```

这是我将其替换为的 LinkBut​​ton：

```
<asp:LinkButton ID="MyButton" runat="server" CausesValidation="false" OnClick="MyButton_Click">
    <asp:Image runat="server" ImageUrl="~/Images/button.gif" alt="my tooltip"/>
</asp:LinkButton> 
```

从用户的角度来看，这一切都和以前一样工作......但没有在 IE 中崩溃。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-06-24T23:27:20.897

在我们的例子中，在母版页上，我们在以下`<head>`部分添加了以下代码行：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9"> 
```

这对我们有用，因为它允许在指定的 IE 版本中呈现页面。

# asp.net - 将描述和图片与 rss 项目分开

> ID：13299687
> 
> 赞同：0
> 
> 时间：2012-11-08T23:25:16.277
> 
> 标签：asp.net, regex, rss

我有一个格式为 rss 的提要

```
<item>
<title>11/09/2012 - Coffee Roasting 101</title>
<link><![CDATA[http://test.com/helios/index.php?com=detail&eID=277478]]></link>
<description>&#60;p&#62;&#60;img style=&#34;float: right; margin: 5px;&#34; src=&#34;http://test.com/helios/img/hand.jpg&#34; alt=&#34;five finger of coffee please&#34; width=&#34;127&#34; height=&#34;132&#34; /&#62;Learn the basics of roasting coffee. What...</description>
<guid>http://test.com/helios/index.php&#63;com=detail&amp;eID=277478</guid>
<pubDate>Fri, 09 Nov 2012 08:00:00 -0800</pubDate>
</item> 
```

描述节点中有一些文本以及 img 标签。现在在我的功能中，我正在做类似的事情：

```
foreach (ArrayList item in rssItems)
 {
string desc = (string)item[1];
-------------------           
     Response.Write("<li><a href=\"" + link + "\">" + title + "</a>");
     Response.Write("<p>" + desc+ "</p></li>");
-------------------
------------------- 

  } 
```

我得到带有文本的 ap 标签以及带有高度和宽度的图像。我正在尝试将图像作为单独的 img 标签获取，而标签中没有属性和描述`<p>`。解决此问题的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:38:56.503

拥有标签的 HTML 代码`<description>`，使用正则表达式模式`<img.*?src="(.*?)".*?>`来查找`<img>`标签。

# jquery - 用第一句话分割段落

> ID：13299689
> 
> 赞同：1
> 
> 时间：2012-11-08T23:25:22.823
> 
> 标签：jquery, regex, text-segmentation

我有这个 div，我想在第一句话中添加一些样式。

```
<div class="text">dfgdfg.asdhasd</div> 
```

我正在尝试这段代码，但没有按预期工作。

```
var text = $('.text').html().split(".")[0]+".";

$(".text:contains("+text+")").css("color", "red"); 
```

[演示](http://jsfiddle.net/kuLNP/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:28:37.650

See [http://jsfiddle.net/wp5kw/](http://jsfiddle.net/wp5kw/)

Assuming a paragraph of:

```
<p id="para"> This is a test. Is it? Yes, it is indeed! 
You might ask, is this a sentence? To which I would reply 
with a resounding "YES"!!!</p> 
```

To grab all the sentences, use:

```
var sentences=$('#para').text() // get example text
        .match(/[^\.\!\?]+[\.\!\?]+/g) // extract all sentences
        .map(function(s){ // (optional) remove leading and trailing whitespace
            return s.replace(/^\s+|\s+$/g,'');
        }); 
```

To highlight the first sentence, use:

```
var count=0;
$('#para2').html(
    $('#para')
        .text()
        .match(/[^\.\!\?]+[\.\!\?]+/g)
        .map(function(s){
            s=s.replace(/^\s+|\s+$/g,'');
            return count++
                ? s
                : '<span style="color:red">'+s+'</span>'
        }).join(' ')
); 
```

The regular expression assumes that periods, exclamation and question marks are used to terminate a sentence, and is:

```
[^\.\!\?]+         -- one or more non-sentence terminals
[\.\!\?]+          -- followed by one or more sentence terminals 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:32:59.490

这只有在页面上只有一个 .text 元素时才会起作用。

```
var elem = $('.text');
var textParts = elem.html().split(".");
var first = "<span class='red'>" + textParts.shift() + ".</span>";
elem.html(first + textParts.join(".")); 
```

如果有多个，则需要一个 each 循环。

```
var elems = $('.text');
elems.each( function(){
    var elem = $(this);
    var textParts = elem.html().split(".");
    var first = "<span class='red'>" + textParts.shift() + ".</span>";
    elem.html(first + textParts.join("."));
}); 
```

当然这使用一个类来设置颜色，基本类是

```
.text .red{
    color: #FF0000;
} 
```

运行示例：http: [//jsfiddle.net/a68dS/1/](http://jsfiddle.net/a68dS/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:35:44.580

您需要将其包装在一个元素中，您不能将 css 应用于文本节点：

```
var $div = $('.text');
var text = $div.text();

$div.html( text.replace(/.+?\./, '<span>$&</span>') ); 
```

**演示：http:** [//jsbin.com/ezojic/1/edit](http://jsbin.com/ezojic/1/edit)

# grails - 将 Grails 域对象映射到 JDBC 表/序列

> ID：13299691
> 
> 赞同：3
> 
> 时间：2012-11-08T23:25:28.187
> 
> 标签：grails, grails-orm, grails-domain-class

我正在尝试将现有的 oracle 表映射到新的 Grails 域对象。我也有一个现有的序列。调用“run-app”时，出现错误：

```
Unsuccessful: create sequence hibernate_sequence
ORA-01031: insufficient privileges 
```

我的目标是使用现有序列，而不是创建新序列。郑重声明，这是我第一次尝试 Grails/Groovy。

我的域对象如下所示。表名是`Uicc_Inv_Detail`。PK是`UICC_INV_DETAIL_ID`。其他列与 Uicc 类中的名称相同。序列名称是`Uicc_Inv_Detail_Seq`。
我认为我的整个“id 生成器”部分是错误的。

```
class Uicc {
  String id
  String iccid
  String imsi

  static mapping = {
    version false
    table 'Uicc_Inv_Detail'
    id generator: 'sequence',column:'UICC_INV_DETAIL_ID',
            params:  [table: 'Uicc_Inv_Detail_Seq', column: 'nextval']

  }

    static constraints = {
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T01:34:27.320

利用：

```
id generator:'native', params:[sequence:'Uicc_Inv_Detail_Seq'] 
```

这是文档： http: [//grails.org/doc/2.0.x/ref/Database%20Mapping/id.html](http://grails.org/doc/2.0.x/ref/Database%20Mapping/id.html) [http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html /mapping.html#mapping-declaration-id-generator](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/mapping.html#mapping-declaration-id-generator)

# python-2.7 - Python、类和继承测试

> ID：13299693
> 
> 赞同：0
> 
> 时间：2012-11-08T23:25:29.763
> 
> 标签：python-2.7

我创建了两个类，我正在尝试测试它们，但是我收到了以下错误，并且我一生都看不到有什么问题。

这个想法是将这些类用作一个模块，然后从用户那里获取输入以填充参数，但现在我只是在测试这些类。

**错误**

```
File "./Employees.py", line 38, in <module>
emp1Atr.displayAttributes()
AttributeError: Attribute instance has no attribute 'displayAttributes' 
```

**下面的代码**

```
#!/usr/bin/python

class Employee:
    'Practice class'
    empCount = 0

    def __init__(self, salary):
            self.salary = salary
            Employee.empCount += 1
    def displayCount(self):
            print "Total Employees %d" % Employee.empCount

    def displayEmployee(self):
            print "Salary: ", self.salary

class Attribute(Employee):
    'Defines attributes for Employees'
    def __init__(self, Age, Name, Sex):

            def Age(self):
                    self.Age = Age

            def Name(self):
                    self.Name = Name

            def Sex(self):
                    self.Sex = Sex

            def displayAttributes(self):
                    print "Name: ", self.Name + "\nAge: ", self.Age + "\nSex: ", self.Sex

emp1Sal = Employee(2000)
emp1Atr = Attribute(12, "John", "man")

emp1Sal.displayEmployee()
emp1Atr.displayAttributes() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:32:35.140

如果那是正确的复制粘贴，那么您在 Attribute 类中的缩进太深了。之后的所有方法`__init__(self)`都缩进，就好像它们在内部的本地方法`__init__(self)`而不是对象中一样。因此，如果您正确地对它们进行缩进并正确设置属性`age, name and sex`，`__init__()`它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:05:48.617

好的，我只是在不打电话给父母的情况下重试了它，它可以工作。你能解释一下你为什么添加那条线吗？

**新代码**

```
#!/usr/bin/python

class Employee:
    'Practice class'
    empCount = 0

    def __init__(self, salary):
            self.salary = salary
            Employee.empCount += 1
    def displayCount(self):
            print "Total Employees %d" % Employee.empCount

    def displayEmployee(self):
            print "Salary: ", self.salary

class Att(Employee):
    'Defines attributes for Employees'
    def __init__(self, Age, Name, Sex):
            self.Age = Age
            self.Name = Name
            self.Sex = Sex

    def display(self):
            print "Name: ", self.Name + "\nAge: ", self.Age,  "\nSex: ", self.Sex

emp1Atr = Att(12, "Da", "man")

emp1Atr.display() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:38:07.887

```
#!/usr/bin/python
class Employee:

'Practice class'
empCount = 0

def __init__(self, salary = None): #made salary as an optional argument
        self.salary = salary
        Employee.empCount += 1
def displayCount(self):
        print "Total Employees %d" % Employee.empCount

def displayEmployee(self):
        print "Salary: ", self.salary

class Attribute(Employee):
    'Defines attributes for Employees'
    def __init__(self, Age, Name, Sex):
        Employee.__init__(self) #Calling the parent class init method
        #Assigning Attribute the values passed in the __init__ method

        self.Age = Age
        self.Name = Name
        self.Sex = Sex  
#Making a class method which is why it is intended out of the init method
#This was the reason you got the first error of display attributes
def displayAttributes(self):
print "Name: ", self.Name + "\nAge: ", self.Age , "\nSex: ", self.Sex #Changed the + to ',' between self.Age and "\nSex"

emp1Sal = Employee(2000)
emp1Atr = Attribute(12, "John", "man")

emp1Sal.displayEmployee()
emp1Atr.displayAttributes() 
```

# javascript - 如何仅在 jquery 中按类将一个 js 链接的事件侦听器和其他属性传递给另一个？

> ID：13299697
> 
> 赞同：0
> 
> 时间：2012-11-08T23:26:07.617
> 
> 标签：javascript, jquery, addthis

我正在使用 addthis.com 社交媒体小部件，并且我想自定义打开每个服务的气泡链接。我尝试使用 css 和 jquery 来自定义背景图像，但这不起作用，因为小部件会覆盖它。甚至不适用于 !IMPORTANT 内联覆盖。

有没有一种简单的方法可以使用 jquery 将所有事件侦听器和非样式属性传输到另一个链接？喜欢 onclick="" 功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:10:44.233

您可以在有人单击以获取完整的服务列表时注册一个事件。一个简单的例子是：

```
function shareEventHandler(evt) { 
    console.log("Menu is now open");
}

addthis.addEventListener('addthis.menu.open', shareEventHandler); 
```

然后，您可以添加自己的自定义逻辑/代码。完整的文档在这里：

[http://support.addthis.com/customer/portal/articles/381263-addthis-client-api#events](http://support.addthis.com/customer/portal/articles/381263-addthis-client-api#events)

# c# - FileOptions.Asynchronous 导致 FileStream.BeginRead 阻塞

> ID：13299705
> 
> 赞同：4
> 
> 时间：2012-11-08T23:27:14.203
> 
> 标签：c#, .net, asynchronous, filestream, beginread

为什么使用 FileOptions.Asynchronous 创建 FileStream 会导致 FileStream.BeginRead 阻塞调用线程？

这是代码片段：

```
private static Task<int> ReadFileAsync(string filePath)
  {
     var file = new FileStream(filePath, FileMode.Open, FileAccess.ReadWrite, FileShare.ReadWrite, 64 * 1024, FileOptions.Asynchronous);
     FileInfo fi = new FileInfo(filePath);
     byte[] buffer = new byte[fi.Length];
     Task<int> task = Task<int>.Factory.FromAsync(file.BeginRead, file.EndRead, buffer, 0, buffer.Length, null);         
     return task.ContinueWith(t =>
     {
        file.Close();
        Console.WriteLine("Done ReadFileAsync, read " + t.Result + " bytes.");
        return t.Result;
     });
  } 
```

当使用 JetBrains dotPeek 挖掘 MSFT FileStream 代码时，他们的代码中似乎存在错误：

```
 if (!this._isAsync)
    return base.BeginRead(array, offset, numBytes, userCallback, stateObject);
  else
    return (IAsyncResult) this.BeginReadAsync(array, offset, numBytes, userCallback, stateObject); 
```

BeginRead 方法实际上似乎是通过调度任务来进行异步读取，但 BeginReadAsync 方法实际上最终会执行同步读取。所以他们的方法命名是倒退的，调用哪个方法的逻辑是错误的。如果 this._isAsync == true，则应该调用 BeginRead。

因此，似乎要让 FileStream.BeginRead 立即返回（异步安排读取），您实际上必须将 cosntructor 中的 useAsync 参数设置为 false。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-11T19:34:42.817

这是一篇知识库文章，其中列出了所有可能导致您希望异步执行的代码实际同步运行的方式。

[异步磁盘 I/O 在 Windows NT、Windows 2000 和 Windows XP 上显示为同步](http://support.microsoft.com/kb/156932)

清单上的内容是否适用于您的情况？

您是否尝试过使用 .NET 4.5 的[ReadAsync 方法](http://msdn.microsoft.com/en-us/library/system.io.stream.beginread.aspx)实现相同的行为？

我从 MSDN 引用：

> 在 .NET Framework 4 及更早的版本中，您必须使用 BeginRead 和 EndRead 等方法来实现异步 I/O 操作。这些方法在 .NET Framework 4.5 中仍然可用以支持旧代码；但是，ReadAsync、WriteAsync、CopyToAsync 和 FlushAsync 等新的异步方法可以帮助您更轻松地实现异步 I/O 操作。

*编辑* 我正在使用 ICH10 和 Windows 7 在 OCZ Vertex 2 上使用 256MB 文件重现您的问题。我必须生成文件，重新启动 PC 以清除文件缓存，然后尝试读取相同的文件。

```
using System;
using System.Threading.Tasks;
using System.IO;
using System.Diagnostics;
using System.Threading;

namespace ConsoleApplication4
{
   class Program
   {
      static void Main(string[] args)
      {
         string fileName = @"C:\Temp\a1.txt";
         int arraySize = 512 * 1024 * 1024;
         var bytes = new byte[arraySize];
         new Random().NextBytes(bytes);

          // This prints false, as expected for async call
         var callback = new AsyncCallback(result =>
                             Console.WriteLine("Completed Synchronously: " + result.CompletedSynchronously));

         try
         {
            // Use this method to generate file...
            //WriteFileWithRandomBytes(fileName, arraySize, bytes, callback);

            Console.WriteLine("ReadFileAsync invoked at " + DateTimeOffset.Now);
            var task = ReadFileAsync(fileName);
            Console.WriteLine("ReadFileAsync completed at " + DateTimeOffset.Now);

            Task.WaitAll(task);
            Console.WriteLine("Wait on a read task completed at " + DateTimeOffset.Now);
         }
         finally
         {
            if (File.Exists(fileName))
               File.Delete(fileName);
         }
      }

      private static void WriteFileWithRandomBytes(string fileName, int arraySize, byte[] bytes, AsyncCallback callback)
      {
         using (var fileStream = new FileStream(fileName,
            FileMode.OpenOrCreate, FileAccess.Write, FileShare.None, 128 * 1024, FileOptions.Asynchronous))
         {
            Console.WriteLine("BeginWrite invoked at " + DateTimeOffset.Now);
            var asyncResult = fileStream.BeginWrite(bytes, 0, arraySize, callback, null);

            Console.WriteLine("BeginWrite completed at " + DateTimeOffset.Now);
            // completes in 6 seconds or so...  Expecting instantaneous return instead of blocking

            // I expect runtime to block here...
            Task.WaitAll(Task.Factory.FromAsync(asyncResult, fileStream.EndWrite));

            // or at least when flushing the stream on the following end-curly
         }
      }

      private static Task<int> ReadFileAsync(string filePath)
      {
         FileInfo fi = new FileInfo(filePath);
         byte[] buffer = new byte[fi.Length];

         var file = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.None, 64 * 1024, FileOptions.Asynchronous);
         Task<int> task = Task<int>.Factory.FromAsync(file.BeginRead, file.EndRead, buffer, 0, buffer.Length, null);
         return task.ContinueWith(t =>
         {
            file.Close();
            Console.WriteLine("Done ReadFileAsync, read " + t.Result + " bytes.");
            return t.Result;
         });
      }
   }
} 
```

当所有其他方法都失败时，[这里是对非托管 API 文档的参考](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365683%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T15:30:14.310

您是否尝试传入有效的 stateObject，而不是 null？[与http://msdn.microsoft.com/en-us/library/kztecsys(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/kztecsys(v=vs.100).aspx)上的代码进行比较

# php - 聊天室在线用户列表实施

> ID：13299706
> 
> 赞同：1
> 
> 时间：2012-11-08T23:27:28.467
> 
> 标签：php, mysql, memcached

我必须实现一个包含该房间用户列表的聊天室。我将使用 mysql+memcache 来执行此操作。当用户进入或离开房间时，房间中的用户数组将被更新。但是，我们在站点上有自动注销功能，因此非活动用户在 30 分钟不活动时会被注销，现在这是一个问题：

我无法刷新房间中的用户列表，因为我不知道自动注销何时发生。我们没有用于注销非活动用户的脚本。在主在线列表中，它们是这样列出的： SELECT * FROM users WHERE last_fresh > 1352415100 我们的在线列表不显示用户处于非活动状态超过 30 分钟，但我无法存储和更新数组中的 last_fresh 时间每次房间里的用户，当房间里的每个用户刷新页面时。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:33:04.940

取决于您是要推送还是拉取更改。推送总是首选，但会采用 nginx-push-module 或其他一些服务器端技术。拉动肯定更容易，但会产生更多开销。

如果是拉，可以轮询登录用户列表，根据数据刷新房间列表。更新视图的 ajax 调用将完成此操作。看看 jQuery 或原型。

# iphone - 将指针从单例设置到 viewController 并更新 GUI 违反 MVC

> ID：13299710
> 
> 赞同：1
> 
> 时间：2012-11-08T23:28:08.417
> 
> 标签：iphone, objective-c, ios, design-patterns, singleton

我想问一个关于良好代码实践和 MVC 模型的理论问题，情况如下：

该设计包含一个 RootViewController 和一个单例类。单例作为一个控制器，带有一个应该在整个应用程序中可用的计时器对象。计时器对象由 UISwitch 和 NSTimer 组成，它们都归单例控制器所有，因此可以根据需要将 UISwitch 添加到新的 viewController 中，并且可以在整个应用程序中访问计时器对象。

为了使用当前计时器的计数更新 RootViewController 的屏幕，我在单例中创建了一个指向 RootViewController 的指针，并将 RootViewController 设置为该指针，类似于 [singeltonOBject setDelegate:self]。使用这种设计，可以在计时器滴答时从单例访问和更新 RootViewController 的 UILabel。我选择这样做是因为我没有时间实施常规委托。

请注意，RootViewController 归 AppDelegate 所有，而单例类显然不归 RootViewController 所有。因此没有保留周期。

问题：设置从单例到 RootViewController 的指针并从单例控制器更新 UILable 是否违反了良好的编码习惯，是否有任何基本原则未实现？

感谢您的回答！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:46:33.320

## 问题

**通常，当某些事情感觉不太对时，那是因为它不是。**

虽然您的代码可以工作，但将来维护起来并不容易，而且很容易出错。即使您从不打算再次查看此代码，练习良好的编码约定总是好的。

我建议阅读[The Pragmatic Programmer](http://pragprog.com/the-pragmatic-programmer/extracts/tips)，其中包含许多关于如何编写更好代码的提示。其中一个技巧是**最小化模块之间的耦合**。现在你的 RootViewController 知道你的 Singleton 并且你的 Singleton 知道你的 RootViewController 所以它们都相互耦合。将来，当您更改一个时，您可能也必须更改另一个。

***如果要添加另一个标签怎么办？*** 您必须在 RootViewController 中添加标签，然后更改您的单例以更新该标签。

***如果您完全删除标签怎么办？***假设你在几年后回到这个并删除标签，突然有另一个类没有编译，你可能不记得为什么。您在应用程序的一个完全独立的部分中破坏了代码。

至于遵循MVC，这违反了这一点。您的视图正在被单独的东西修改。如果 MVC 设置正确，您应该能够放置任意数量的视图，而无需更改任何控制数据的代码，在这种情况下是您的计时器。

现在至于内存管理，你的 RootViewController 现在被这个 Singleton 保留了。单例在应用程序的整个生命周期中都存在。您是对的，您在技术上没有保留周期，但是您的 RootViewController 现在永远不会被释放。在大多数应用程序中，这无关紧要，因为 RootViewController 始终保留在堆栈的底部，但这是巧合，因此无法可靠地对其进行编程。这实际上是 The Pragmatic Programmer 的另一个技巧，**不要巧合**编程。

## 解决方案

如果您确实需要像您说的那样的全局计时器，更好的解决方案是使用通知（另一个故事是您的全局计时器单例听起来不是一个好主意）。每当您从单例中更新标签时，您都可以触发通知。您的 RootViewController 将收到此通知并可以更新其标签。如果需要，您可以在通知中传递数据。现在，如果您对视图进行更改并想要更新其他内容，您只需在一个位置（RootViewController）更改代码。

# symfony - 从 EntityRepository 访问会话

> ID：13299711
> 
> 赞同：1
> 
> 时间：2012-11-08T23:28:35.437
> 
> 标签：symfony, dependency-injection, doctrine

我将 Symfony2 与 Doctrine2 一起使用。我想实现以下目标：

```
 $place = $this->getDoctrine()->getRepository('TETestBundle:Place')->find($id); 
```

在那个地方将是用户语言（会话中）的地方信息（公共数据+文本）。因为我要这样做数百次，所以我想在幕后传递它，而不是作为第二个参数。因此，英语用户将以英语查看地点信息，而西班牙用户则以西班牙语查看。

一种可能性是从 EntityRepository 访问应用程序的语言环境。我知道它是通过服务和 DI 完成的，但我想不通！

```
// PlaceRepository
class PlaceRepository extends EntityRepository
{
    public function find($id)
    {
        // get locale somehow
        $locale = $this->get('session')->getLocale();

        // do a query with the locale in session
        return $this->_em->createQuery(...);
    }
} 
```

你会怎么做？您能否详细解释一下我必须创建和扩展的步骤和新类？我计划在准备好后发布这个翻译包:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T07:02:04.563

我不相信 Doctrine 是访问会话数据的好方法。ORM 中的开销太大，无法仅提取会话数据。

查看[Symfony 2 Cookbook](http://symfony.com/doc/current/cookbook/configuration/pdo_session_storage.html)以了解 PDO 支持的会话的配置。

我不会设置服务，而是考虑使用[Doctrine 事件侦听](http://symfony.com/doc/current/cookbook/doctrine/event_listeners_subscribers.html)器的方法。就在每次查找之前，侦听器会从某个地方（会话、配置或您将来喜欢的任何其他地方）挑选出正确的语言环境，将其注入查询中，就像魔术一样，您的模型不必知道这些细节。保持模型的范围干净。

您不希望您的模型或存储库直接进入会话。如果您将来决定想要一个带有该存储库的命令行工具怎么办？那里有所有的会话杂乱无章，你会一团糟。

教义事件监听器神奇地美味。他们进行了一些实验，但最终成为这种查询操作的一种非常可配置的、偏僻的解决方案。

**更新：**看起来您最受益的是[Doctrine Translatable Extension](http://gediminasm.org/article/translatable-behavior-extension-for-doctrine-2)。它已经为您完成了所有工作，包括注册侦听器、提供挂钩以了解如何传入适当的语言环境（从您保存它的任何地方）等等。我自己使用了 Gedmo 扩展（虽然不是这个特定的），并且发现它们都是高质量的。

# jquery - jQuery 选择器：排除类名的组合

> ID：13299714
> 
> 赞同：0
> 
> 时间：2012-11-08T23:28:44.263
> 
> 标签：jquery, css, jquery-selectors

我有一个包含这些信息的列表：

```
<li class="me">my name goes here</li>
<li class="settings">some info here</li>
<li class="me settings">some other here</li>
<li class="me">my address goes here</li> 
```

当用户打开页面时，必须突出显示具有 .me 类名（仅 .me 类名）的项目**：**

```
$(document).ready(function(){
    $('li.me').effect('highlight',{color:'#FFFFFF'},3000);
}); 
```

问题是第三个列表项（“我的设置”）也被突出显示。如何排除以下项目：

*   没有 .me 类名
*   确实有 .me 类名与**任何**其他类名结合

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:31:17.100

使用否定选择器 .not()

```
$(document).ready(function(){
    $('li.me').not('[class*=" "]').effect('highlight',{color:'#FFFFFF'},3000);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:55:15.330

采用：

```
$(document).ready(function () {
    $('li[class="me"]').effect('highlight', {color:'#FFFFFF'}, 3000);
}); 
```

我们选择`li`哪个属性`class`恰好是`me`.

# jquery - jquery位置与碰撞。检测到碰撞时添加类

> ID：13299718
> 
> 赞同：7
> 
> 时间：2012-11-08T23:29:05.170
> 
> 标签：jquery, jquery-ui, position, collision

我正在使用带有碰撞的 jquery-ui 的自动完成框来显示输入上方或下方的自动完成。我想要的是在检测到碰撞时向自动完成元素添加一个类，这样我就可以稍微自定义css，如果它高于或低于。这似乎应该很简单，但我似乎无法找到任何方法来实现它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-03-06T02:36:31.123

更好的解决方案是在回调中使用第二个参数。来自 jQueryUi 文档：

> 第二个提供关于两个元素的位置和尺寸的反馈，以及对它们的相对位置的计算。target 和 element 都具有以下属性：element、left、top、width、height。此外，还有水平、垂直和重要，给你十二个潜在的方向，如{水平：“中心”，垂直：“左”，重要：“水平”}。

正如它所说，第二个参数中有一个*水平*属性和一个*垂直*属性，您可以使用它来确定元素是否被翻转。所以你可以这样写：

```
$("#someId").dialog({
      position: {
      my: 'left top',
      at: 'right top',
      collision: 'flip flip',
      of: $('#' + someElementID),
      using: function (obj,info) {
          if (info.vertical != "top") {
              $(this).addClass("flipped");
          } else {
              $(this).removeClass("flipped");
          }
          if (info.horizontal != "left") {
              $(this).addClass("flipped");
          } else {
              $(this).removeClass("flipped");
          }
          $(this).css({
            left: obj.left + 'px',
            top: obj.top + 'px'
          });
      }
}, 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-27T16:05:19.183

与其使用此处提到的两种解决方案，我更喜欢创建一个自定义翻转处理程序，该处理程序使用默认处理程序并检测是否有更改。

这是我的做法：

```
$.ui.position.custom = {
    left: function(position, data) {
        var initPos = position.left;
        $.ui.position.flip.left(position, data);
        if (initPos != position.left) {
            data.elem.addClass('tooltipFlipLeft');
        } else {
            data.elem.removeClass('tooltipFlipLeft');
        }
    },
    top: function(position, data) {
        var initPos = position.top;
        $.ui.position.flip.top(position, data);
        if (initPos != position.top) {
            data.elem.addClass('tooltipFlipTop');
        } else {
            data.elem.removeClass('tooltipFlipTop');
        }
    }
}; 
```

然后我在使用位置函数时使用它：

```
me.position({
    of: opener,
    my: 'right bottom',
    at: 'center top',
    collision: 'custom'
}); 
```

这里唯一相关的线是有碰撞的线。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-17T10:01:16.767

你应该使用的`using`回调`position`

这是一个可能的解决方案，假设您打开一个对话框......

```
$("#someId").dialog({
position: {
    my: 'left top',
    at: 'right top',
    collision: 'flip flip',
    of: $('#' + someElementID),
    using: function (obj) {
        if (obj.left < $('#' + someElementID).offset().left) {
            $(this).addClass("flipped");
        } else {
            $(this).removeClass("flipped");
        }
        //decide if dialog is being opened flipped from buttom to top
        if ((obj.top + 50) < $('#' + someElementID).offset().top) {
            $(this).addClass("flipped_top");
        } else {
            $(this).removeClass("flipped_top");
        }
        $(this).css({
            left: obj.left + 'px',
            top: obj.top + 'px'
        });
    }
},
    ... 
```

`$(this)`您可以将类添加/删除到其他元素，而不是添加/删除对话框本身的类...

# css - 向所有 div 添加 clearfix 有什么缺点吗？

> ID：13299721
> 
> 赞同：2
> 
> 时间：2012-11-08T23:29:13.697
> 
> 标签：css, layout, clearfix

在我正在处理的布局上（在大多数情况下不是这样），我想不出任何我不希望 div 不包含其浮动子级的实例。所以我在想，而不是为每个需要它的元素（主要是容器 div）添加一个 clearfix 类，为什么不让所有的 div 都像这样被 clearfixed：

```
div:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
} 
```

这有什么缺点吗？在测试我当前的布局时，我真的看不到任何东西，但也许有一些知识渊博的人比我更了解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:31:47.193

如果你这样做，那么你将永远无法让多个浮动`div`的 s 彼此水平堆叠，因为你的 clearfixes 会妨碍你。

所以在某种程度上，对每个`div`元素都有一个 clearfix 会使浮动它们以及相关元素的效果无效。

这就是为什么文章经常建议将 clearfix 应用于某个类，然后将所需的元素改为该类：

```
.cf:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:50:51.750

在我看来，对于大多数使用它的情况来说，明确的修复是多余的，仅使用`overflow: hidden`.

显然，如果元素的尺寸设置小于其内容，或者您​​实际上希望子元素能够位于其父元素之外，那么这将不起作用。但是十有八九我发现溢出隐藏不会导致任何问题，而且实施起来更干净。

关于在每个 div 上设置明确的修复，*我会远离这个*。

1.  它会为您的页面渲染添加相当多的额外处理。
2.  对于使用您的代码的其他人来说，它几乎是不可见的。
3.  更不用说 BoltClock 的浮动问题了。

然而，我已经构建了大量使用溢出隐藏而没有不良影响的布局。

1.  这不是 hack，它利用了内置的元素渲染选项。
2.  如果应用于每个需要它的类，这对其他开发人员来说是非常明显的。
3.  它不会遭受浮动问题。

# java - DiagonalLayout 中的拉伸按钮

> ID：13299729
> 
> 赞同：3
> 
> 时间：2012-11-08T23:29:58.100
> 
> 标签：java, swing, layout, graphics, awt

我对 oracle 网站上提出的布局对角布局有一个小问题......事实上，我只会在保持布局的同时拉伸屏幕宽度上的最后一个按钮，但我不能，但我已经尝试过这段代码：

```
 public void stretchLastComponent(Container container){
            int nComps = container.getComponentCount();
            Component c = container.getComponent(nComps-1);

            c.setSize(container.getWidth(), c.getHeight()); 
```

我也使用了repaint()和revalidate()，但是没有结果。这是使用的类（这是一项强制工作，我无法更改布局）：

[对角线布局.java](http://docs.oracle.com/javase/tutorial/displayCode.html?code=http://docs.oracle.com/javase/tutorial/uiswing/examples/layout/CustomLayoutDemoProject/src/layout/DiagonalLayout.java)

为了简单起见，我还在论坛中提供了代码：

```
 package layout;

/*
 * 1.2+ version.  Used by CustomLayoutDemo.java.
 */

import java.awt.*;

public class DiagonalLayout implements LayoutManager {
    private int vgap;
    private int minWidth = 0, minHeight = 0;
    private int preferredWidth = 0, preferredHeight = 0;
    private boolean sizeUnknown = true;

    public DiagonalLayout() {
        this(5);
    }

    public DiagonalLayout(int v) {
        vgap = v;
    }

    /* Required by LayoutManager. */
    public void addLayoutComponent(String name, Component comp) {
    }

    /* Required by LayoutManager. */
    public void removeLayoutComponent(Component comp) {
    }

private void setSizes(Container parent) {
    int nComps = parent.getComponentCount();
    Dimension d = null;

    //Reset preferred/minimum width and height.
    preferredWidth = 0;
    preferredHeight = 0;
    minWidth = 0;
    minHeight = 0;

    for (int i = 0; i < nComps; i++) {
        Component c = parent.getComponent(i);
        if (c.isVisible()) {
            d = c.getPreferredSize();

            if (i > 0) {
                preferredWidth += d.width/2;
                preferredHeight += vgap;
            } else {
                preferredWidth = d.width;
            }
            preferredHeight += d.height;

            minWidth = Math.max(c.getMinimumSize().width,
                                minWidth);
            minHeight = preferredHeight;
        }
    }
}

/* Required by LayoutManager. */
public Dimension preferredLayoutSize(Container parent) {
    Dimension dim = new Dimension(0, 0);
    int nComps = parent.getComponentCount();

    setSizes(parent);

    //Always add the container's insets!
    Insets insets = parent.getInsets();
    dim.width = preferredWidth
                + insets.left + insets.right;
    dim.height = preferredHeight
                 + insets.top + insets.bottom;

    sizeUnknown = false;

    return dim;
}

/* Required by LayoutManager. */
public Dimension minimumLayoutSize(Container parent) {
    Dimension dim = new Dimension(0, 0);
    int nComps = parent.getComponentCount();

    //Always add the container's insets!
    Insets insets = parent.getInsets();
    dim.width = minWidth
                + insets.left + insets.right;
    dim.height = minHeight
                 + insets.top + insets.bottom;

    sizeUnknown = false;

    return dim;
}

/* Required by LayoutManager. */
/*
 * This is called when the panel is first displayed,
 * and every time its size changes.
 * Note: You CAN'T assume preferredLayoutSize or
 * minimumLayoutSize will be called -- in the case
 * of applets, at least, they probably won't be.
 */
public void layoutContainer(Container parent) {
    Insets insets = parent.getInsets();
    int maxWidth = parent.getWidth()
                   - (insets.left + insets.right);
    int maxHeight = parent.getHeight()
                    - (insets.top + insets.bottom);
    int nComps = parent.getComponentCount();
    int previousWidth = 0, previousHeight = 0;
    int x = 0, y = insets.top;
    int rowh = 0, start = 0;
    int xFudge = 0, yFudge = 0;
    boolean oneColumn = false;

    // Go through the components' sizes, if neither
    // preferredLayoutSize nor minimumLayoutSize has
    // been called.
    if (sizeUnknown) {
        setSizes(parent);
    }

    if (maxWidth <= minWidth) {
        oneColumn = true;
    }

    if (maxWidth != preferredWidth) {
        xFudge = (maxWidth - preferredWidth)/(nComps - 1);
    }

    if (maxHeight > preferredHeight) {
        yFudge = (maxHeight - preferredHeight)/(nComps - 1);
    }

    for (int i = 0 ; i < nComps ; i++) {
        Component c = parent.getComponent(i);
        if (c.isVisible()) {
            Dimension d = c.getPreferredSize();

             // increase x and y, if appropriate
            if (i > 0) {
                if (!oneColumn) {
                    x += previousWidth/2 + xFudge;
                }
                y += previousHeight + vgap + yFudge;
            }

            // If x is too large,
            if ((!oneColumn) &&
                (x + d.width) >
                (parent.getWidth() - insets.right)) {
                // reduce x to a reasonable number.
                x = parent.getWidth()
                    - insets.bottom - d.width;
            }

            // If y is too large,
            if ((y + d.height)
                > (parent.getHeight() - insets.bottom)) {
                // do nothing.
                // Another choice would be to do what we do to x.
            }

            // Set the component's size and position.
            c.setBounds(x, y, d.width, d.height);

            previousWidth = d.width;
            previousHeight = d.height;
        }
    }
}

public String toString() {
    String str = "";
    return getClass().getName() + "[vgap=" + vgap + str + "]";
}
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:56:45.397

您不能/不应该更改在布局管理器控制下的任何组件的大小/位置，下次验证（布局）容器时，这些值将由布局管理器保留......

话虽如此，由于您可以访问布局管理器的源代码，因此您有能力影响它如何做出决策......

只需将其添加到`layoutContainer`方法中，就在之前`c.setBounds(x, y, d.width, d.height);`

```
if (i == nComps - 1) {
    d.width = parent.getWidth();
    x = 0;
} 
```

我能够做到这一点......

![在此处输入图像描述](../Images/1a12faeddc3cdde2584d97b814dcbe15.png)

**反馈后更新**

我稍微捏造了布局代码，以允许布局按照您的图像建议的方式执行......

![在此处输入图像描述](../Images/7273bc4feeb1b75d8a5b6b07217159bf.png)

```
public class TestLayout14 {

    public static void main(String[] args) {
        new TestLayout14();
    }

    public TestLayout14() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JPanel content = new JPanel(new BorderLayout());
                LayoutPane layoutPane = new LayoutPane();
                content.add(layoutPane);
                content.add(new ControlPane(layoutPane), BorderLayout.SOUTH);

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(content);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class LayoutPane extends JPanel {

        public LayoutPane() {
            setLayout(new DiagonalLayout());
            add(new JLabel("Test 01"));
            add(new JLabel("Test 02"));
            add(new JLabel("Test 03"));
            add(new JButton("Test 04"));
        }
    }

    public class ControlPane extends JPanel {

        private JTextField fieldGap;
        private JCheckBox majorDiag;
        private JCheckBox streatchLast;
        private LayoutPane layoutPane;

        public ControlPane(LayoutPane pane) {

            layoutPane = pane;

            setBorder(new CompoundBorder(new EmptyBorder(4, 0, 0, 0), new MatteBorder(1, 0, 0, 0, Color.GRAY)));

            fieldGap = new JTextField(Integer.toString(((DiagonalLayout)layoutPane.getLayout()).getVgap()), 4);
            majorDiag = new JCheckBox("Major Diagnal");
            streatchLast = new JCheckBox("Last Component Stretched");

            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.insets = new Insets(4, 4, 4, 4);
            gbc.anchor = GridBagConstraints.WEST;
            gbc.gridx = 0;
            gbc.gridy = 0;

            add(new JLabel("Diagnal Gap: "), gbc);
            gbc.gridx++;
            add(fieldGap, gbc);
            gbc.gridx = 0;
            gbc.gridy++;
            gbc.gridwidth = GridBagConstraints.REMAINDER;
            add(majorDiag, gbc);
            gbc.gridy++;
            add(streatchLast, gbc);

            fieldGap.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    try {
                        ((DiagonalLayout) layoutPane.getLayout()).setVgap(Integer.parseInt(fieldGap.getText()));
                        layoutPane.invalidate();
                        layoutPane.revalidate();
                    } catch (Exception exp) {
                        exp.printStackTrace();
                    }
                }
            });

            streatchLast.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    ((DiagonalLayout) layoutPane.getLayout()).setStreatchLast(streatchLast.isSelected());
                    layoutPane.invalidate();
                    layoutPane.revalidate();
                }
            });

        }
    }

    public class DiagonalLayout implements LayoutManager {

        private int vgap;
        private int minWidth = 0, minHeight = 0;
        private int preferredWidth = 0, preferredHeight = 0;
        private boolean sizeUnknown = true;
        private boolean streatchLast = false;

        public DiagonalLayout() {
            this(5);
        }

        public DiagonalLayout(int v) {
            vgap = v;
        }

        public void setVgap(int vgap) {
            this.vgap = vgap;
        }

        public int getVgap() {
            return vgap;
        }

        public void setStreatchLast(boolean streatchLast) {
            this.streatchLast = streatchLast;
        }

        public boolean isStreatchLast() {
            return streatchLast;
        }

        /* Required by LayoutManager. */
        public void addLayoutComponent(String name, Component comp) {
        }

        /* Required by LayoutManager. */
        public void removeLayoutComponent(Component comp) {
        }

        private void setSizes(Container parent) {
            int nComps = parent.getComponentCount();
            Dimension d = null;

            //Reset preferred/minimum width and height.
            preferredWidth = 0;
            preferredHeight = 0;
            minWidth = 0;
            minHeight = 0;

            for (int i = 0; i < nComps; i++) {
                Component c = parent.getComponent(i);
                if (c.isVisible()) {
                    d = c.getPreferredSize();

                    if (i > 0) {
                        preferredWidth += d.width / 2;
                        preferredHeight += vgap;
                    } else {
                        preferredWidth = d.width;
                    }
                    preferredHeight += d.height;

                    minWidth = Math.max(c.getMinimumSize().width,
                            minWidth);
                    minHeight = preferredHeight;
                }
            }
        }

        /* Required by LayoutManager. */
        public Dimension preferredLayoutSize(Container parent) {
            Dimension dim = new Dimension(0, 0);
            int nComps = parent.getComponentCount();

            setSizes(parent);

            //Always add the container's insets!
            Insets insets = parent.getInsets();
            dim.width = preferredWidth
                    + insets.left + insets.right;
            dim.height = preferredHeight
                    + insets.top + insets.bottom;

            sizeUnknown = false;

            return dim;
        }

        /* Required by LayoutManager. */
        public Dimension minimumLayoutSize(Container parent) {
            Dimension dim = new Dimension(0, 0);
            int nComps = parent.getComponentCount();

            //Always add the container's insets!
            Insets insets = parent.getInsets();
            dim.width = minWidth
                    + insets.left + insets.right;
            dim.height = minHeight
                    + insets.top + insets.bottom;

            sizeUnknown = false;

            return dim;
        }

        /* Required by LayoutManager. */
        /*
         * This is called when the panel is first displayed,
         * and every time its size changes.
         * Note: You CAN'T assume preferredLayoutSize or
         * minimumLayoutSize will be called -- in the case
         * of applets, at least, they probably won't be.
         */
        public void layoutContainer(Container parent) {
            Insets insets = parent.getInsets();
            int maxWidth = parent.getWidth()
                    - (insets.left + insets.right);
            int maxHeight = parent.getHeight()
                    - (insets.top + insets.bottom);
            int nComps = parent.getComponentCount();
            int previousWidth = 0, previousHeight = 0;
            int x = 0, y = insets.top;
            int rowh = 0, start = 0;
            int xFudge = 0, yFudge = 0;
            boolean oneColumn = false;

            // Go through the components' sizes, if neither
            // preferredLayoutSize nor minimumLayoutSize has
            // been called.
            if (sizeUnknown) {
                setSizes(parent);
            }

            if (maxWidth <= minWidth) {
                oneColumn = true;
            }

//            if (maxWidth != preferredWidth) {
//                xFudge = (maxWidth - preferredWidth) / (nComps - 1);
//            }
//
//            if (maxHeight > preferredHeight) {
//                yFudge = (maxHeight - preferredHeight) / (nComps - 1);
//            }

            for (int i = 0; i < nComps; i++) {
                Component c = parent.getComponent(i);
                if (c.isVisible()) {
                    Dimension d = c.getPreferredSize();

                    // increase x and y, if appropriate
                    if (i > 0) {
                        if (!oneColumn) {
                            x += previousWidth / 2 + xFudge;
                        }
                        y += previousHeight + vgap + yFudge;
                    }

                    // If x is too large,
                    if ((!oneColumn)
                            && (x + d.width)
                            > (parent.getWidth() - insets.right)) {
                        // reduce x to a reasonable number.
                        x = parent.getWidth()
                                - insets.bottom - d.width;
                    }

                    // If y is too large,
                    if ((y + d.height)
                            > (parent.getHeight() - insets.bottom)) {
                        // do nothing.
                        // Another choice would be to do what we do to x.
                    }

                    if (isStreatchLast() && i == nComps - 1) {
                        d.width = parent.getWidth() - x;
                    }

                    // Set the component's size and position.
                    c.setBounds(x, y, d.width, d.height);

                    previousWidth = d.width;
                    previousHeight = d.height;
                }
            }
        }

        public String toString() {
            String str = "";
            return getClass().getName() + "[vgap=" + vgap + str + "]";
        }
    }
} 
```

# python - Python - 需要遍历目录以查找 TXT 文件

> ID：13299731
> 
> 赞同：2
> 
> 时间：2012-11-08T23:30:25.143
> 
> 标签：python

我是个 Python 新手

我需要遍历一个目录来查找 .txt 文件，然后单独读取和处理它们。我想设置它，以便脚本所在的任何目录都被视为此操作的根目录。例如，如果脚本位于 /bsepath/workDir 中，那么它将遍历 workDir 及其子项中的所有文件。

到目前为止，我所拥有的是：

```
#!/usr/bin/env python

import os

scrptPth = os.path.realpath(__file__)

for file in os.listdir(scrptPth)
    with open(file) as f:
        head,sub,auth = [f.readline().strip() for i in range(3)]
        data=f.read()
        #data.encode('utf-8')

pth = os.getcwd()

print head,sub,auth,data,pth 
```

这段代码给了我一个无效的语法错误，我怀疑这是因为`os.listdir`不喜欢标准字符串格式的文件路径。另外我不认为我正在做正确的循环动作。如何在循环操作中引用特定文件？是否打包为变量？

任何帮助都会得到帮助

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T23:40:30.750

```
import os, fnmatch

def findFiles (path, filter):
    for root, dirs, files in os.walk(path):
        for file in fnmatch.filter(files, filter):
            yield os.path.join(root, file) 
```

像这样使用它，它会在给定路径中的某处找到所有文本文件（递归）：

```
for textFile in findFiles(r'C:\Users\poke\Documents', '*.txt'):
    print(textFile) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T23:32:20.373

`os.listdir`需要一个目录作为输入。因此，要获取脚本所在的目录，请使用：

```
scrptPth = os.path.dirname(os.path.realpath(__file__)) 
```

* * *

此外，`os.listdir`仅返回文件名，而不是完整路径。`open(file)`除非当前工作目录恰好是脚本所在的目录，否则将无法正常工作。要解决此问题，请使用`os.path.join`：

```
import os

scrptPth = os.path.dirname(os.path.realpath(__file__))

for file in os.listdir(scrptPth):
    with open(os.path.join(scrptPth, file)) as f: 
```

* * *

最后，如果您想通过子目录进行递归，请使用`os.walk`：

```
import os

scrptPth = os.path.dirname(os.path.realpath(__file__))

for root, dirs, files in os.walk(scrptPth):
    for filename in files:
        filename = os.path.join(root, filename)
        with open(filename, 'r') as f:
            head,sub,auth = [f.readline().strip() for i in range(3)]
            data=f.read()
            #data.encode('utf-8') 
```

# javascript - 使用一个按钮从两个选择框之一选择下载文件 - JavaScript

> ID：13299732
> 
> 赞同：0
> 
> 时间：2012-11-08T23:30:24.857
> 
> 标签：javascript, button, html-select

我有两个`select`这样的盒子：

```
<select id="one">
    <option value="default">Select File</option>
    <option value="path/to/file1">File One</option>
    <option value="path/to/file2">File Two</option>
    <option value="path/to/file3">File Three</option>
</select>

<select id="two">
    <option value="default">Select File</option>
    <option value="path/to/file4">File Four</option>
    <option value="path/to/file5">File Five</option>
    <option value="path/to/file6">File Six</option>
</select>

<p class="button_image">
    <a onclick="download(document.getElementById("one").value)"></a>
</p> 
```

这是我的`download`功能：

```
function download(file) {
    if (file == 'default') return;
    window.location = 'http://www.mysite.com/download/' + file;
} 
```

这适用于一个`select`盒子，但我似乎无法弄清楚如何使用相同的按钮图像。哦，是的，`p.class=button_image`有背景图像，它是一个带有悬停效果的按钮。

我希望这些`select`框分开的原因是因为它们每个都代表一组文件，例如，32 位与 64 位。所以它们不能结合起来，因为它不会随着页面设计而流动。

我已经使用 PHP 在 PHP 中尝试了一些 if/else 块，`getElementById`但我遇到了困难。这是我尝试过的，它似乎只能部分工作：

```
<?php

if ('document.getElementById(\"one\")' == 'one') {
    echo "<a onclick='download(document.getElementById(\"one\").value)'></a>";
}

else if ('document.getElementById(\"two\")' == 'two') {
    echo "<a onclick='download(document.getElementById(\"one\").value)'></a>";
}

?> 
```

我应该注意，在这种情况下我不一定需要使用 PHP 来解决这个问题。这只是我尝试的一个选项，因为我使用 PHP 进行服务器端编程。我可以对任意数量的选项感到满意，只要它们有效。

谢谢。

** 编辑 **

这种设计可能有缺陷。但目的是要么下载框一中的文件，要么下载框二中的文件。如果选择了一个，那么另一个应该休息，`default`反之亦然。这就是我现在正在做的事情。

** 编辑 **

我最终得到了 Dawson Loudon 的部分答案，并根据 Barmar 的评论创建了另一个函数，如下所示：

```
// resets other select box when selected
function reset_index(id) {
    document.getElementById(id).selectedIndex = 'default';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:48:41.637

A 元素作为按钮似乎不合适，只需使用 img。

无论如何，将第一个选择与第一个以外的选定选项一起使用的函数可以是：

```
function getPath() {
  var select;
  var args = arguments;

  for (var i=0, iLen=args.length; i<iLen; i++) {
    select = document.getElementById(arg[i]);

    if (select && select.selectedIndex > 0) {
      window.location = 'http://www.mysite.com/download/' + select.value;
    } 
  } 
} 
```

上面期望第一个选项是默认选择的，所以如果它被选中，或者根本没有选择任何选项，则选择的 selectedIndex 将分别为 0 或 -1。我会通过将 selected 属性添加到第一个选项来确保选择一个选项：

```
 <option value="default" selected>Select File</option> 
```

电话是：

```
<img src="buttonImage.jpg" onclick="download('one', 'two');"> 
```

尽管您可能希望向选择元素添加一个类并使用 getElementsByClassName 或类似方法获取它们并遍历该集合，而不是对 id 进行硬编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:44:49.323

尝试替换这个：

```
<p class="button_image">
    <a onclick="download(document.getElementById('one').value)"></a>
</p> 
```

和：

```
<p class="button_image">
    <a onclick="download(document.getElementById('one').value, document.getElementById('two').value)"></a>
</p> 
```

然后用这个替换你的下载功能：

```
function download(file1,file2) {
    if (file1 == 'default' && file2 == 'default'){
      return;
    }
    else if(file1 != 'default'){
      window.location = 'http://www.mysite.com/download/' + file1;
    }
    else{
      window.location = 'http://www.mysite.com/download/' + file2;
    }
} 
```

# xml - 发生 JAXBException ：此上下文已知类 javax.jdo.identity.LongIdentity 或其任何超类

> ID：13299734
> 
> 赞同：2
> 
> 时间：2012-11-08T23:30:25.510
> 
> 标签：xml, rest, jaxb, annotations, bind

客户端代码如下所示：

```
String urlGetRequestsByCustomer = baseUrl + "getRequestsByCustomer?customerID=";

byte[] getRequestsByCustomerResponse = customerAgent
.sendGetMethod(urlGetRequestsByCustomer + custNo);
Unmarshaller unmarshaller = customerAgent
.getUnmarshaller(ServiceRequests.class);
 StringReader reader = new StringReader(new String(
getRequestsByCustomerResponse)); 
```

服务请求.java

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement
public class ServiceRequests {

@XmlElement(name = "serviceRequest", type = ServiceRequest.class)
private List<ServiceRequest> requests = new ArrayList<ServiceRequest>();

/**
 * 
 */
public ServiceRequests() {
}

public ServiceRequests(List<ServiceRequest> requests) {
    this.requests = requests;
}

/**
 * @return the requests
 */
public List<ServiceRequest> getRequests() {
    return requests;
}

/**
 * @param requests
 *            the requests to set
 */
public void setRequests(List<ServiceRequest> requests) {
    this.requests = requests;
} 
```

}

服务请求.java

```
@Entity
@Table(name="SERVICE_REQUEST", uniqueConstraints = {@UniqueConstraint(columnNames=
{"SRNO"})})
@SequenceGenerator(name="SERVICE_REQUEST_SEQUENCE",     
sequenceName="SERVICE_REQUEST_SEQUENCE", initialValue=1, allocationSize=100)
@NamedQueries({
@NamedQuery(name="serviceRequest.getBySrNo",query="SELECT request from ServiceRequest 
request WHERE request.srNo = :srNo")
})

@XmlAccessorType(XmlAccessType.FIELD)
@XmlRootElement
public class ServiceRequest implements Serializable {

private static final long serialVersionUID = 5047875961706019225L;

@Id @GeneratedValue(strategy=GenerationType.SEQUENCE, 
generator="SERVICE_REQUEST_SEQUENCE")
@Column(name="SRNO",  nullable=false)
private Long srNo;

@Column(name="DESCRIPTION")
private String description;

@Column(name="STATUS") 
private int status;

@ManyToOne(fetch=FetchType.EAGER , cascade=CascadeType.DETACH)
@JoinColumn(name="CUSTNO", referencedColumnName="CustNO")
private Customer customer;

@Column(name="DATECREATED")
private Date dateCreated;

@Column(name="DATEUPDATED")
private Date dateUpdated;

@Column(name="UPDATEDBY")
@ManyToOne(fetch=FetchType.LAZY, cascade=CascadeType.DETACH)
@JoinColumn(name="updatedBy")
private Employee updatedBy;

public Employee getUpdatedBy() {
    return updatedBy;
}

public void setUpdatedBy(Employee updatedBy) {
    this.updatedBy = updatedBy;
}

@OneToOne(fetch=FetchType.LAZY, mappedBy="serviceRequest", 
cascade=CascadeType.DETACH)
private CustomerSurvey survey;

/**
 * @return the dateUpdated
 */
public Date getDateUpdated() {
    return dateUpdated;
}

/**
 * @param dateUpdated the dateUpdated to set
 */
public void setDateUpdated(Date dateUpdated) {
    this.dateUpdated = dateUpdated;
}

/**
 * @return the survey
 */
public CustomerSurvey getSurvey() {
    return survey;
}

/**
 * @param survey the survey to set
 */
public void setSurvey(CustomerSurvey survey) {
    this.survey = survey;
}

public ServiceRequest() {
}

/**
 * @return the srNo
 */
public Long getSrNo() {
    return srNo;
}

/**
 * @param srNo the srNo to set
 */
public void setSrNo(Long srNo) {
    this.srNo = srNo;
}

/**
 * @return the description
 */
public String getDescription() {
    return description;
}

/**
 * @param description the description to set
 */
public void setDescription(String description) {
    this.description = description;
}

/**
 * @return the status
 */
public int getStatus() {
    return status;
}

/**
 * @param status the status to set
 */
public void setStatus(int status) {
    this.status = status;
}

/**
 * @return the customer
 */
public Customer getCustomer() {
    return customer;
}

/**
 * @param customer the customer to set
 */
public void setCustomer(Customer customer) {
    this.customer = customer;
}

/**
 * @return the dateCreated
 */
public Date getDateCreated() {
    return dateCreated;
}

/**
 * @param dateCreated the dateCreated to set
 */
public void setDateCreated(Date dateCreated) {
    this.dateCreated = dateCreated;
}

/* (non-Javadoc)
 * @see java.lang.Object#hashCode()
 */
@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result
            + ((dateCreated == null) ? 0 : dateCreated.hashCode());
    result = prime * result
            + ((dateUpdated == null) ? 0 : dateUpdated.hashCode());
    result = prime * result
            + ((description == null) ? 0 : description.hashCode());
    result = prime * result + (int) (srNo ^ (srNo >>> 32));
    result = prime * result + status;
    return result;
}

/* (non-Javadoc)
 * @see java.lang.Object#equals(java.lang.Object)
 */
@Override
public boolean equals(Object obj) {
    if (this == obj) {
        return true;
    }
    if (obj == null) {
        return false;
    }
    if (!(obj instanceof ServiceRequest)) {
        return false;
    }
    ServiceRequest other = (ServiceRequest) obj;
    if (dateCreated == null) {
        if (other.dateCreated != null) {
            return false;
        }
    } else if (!dateCreated.equals(other.dateCreated)) {
        return false;
    }
    if (dateUpdated == null) {
        if (other.dateUpdated != null) {
            return false;
        }
    } else if (!dateUpdated.equals(other.dateUpdated)) {
        return false;
    }
    if (description == null) {
        if (other.description != null) {
            return false;
        }
    } else if (!description.equals(other.description)) {
        return false;
    }
    if (srNo != other.srNo) {
        return false;
    }
    if (status != other.status) {
        return false;
    }
    return true;
}

/* (non-Javadoc)
 * @see java.lang.Object#toString()
 */
@Override
public String toString() {
    return "ServiceRequest [srNo=" + srNo + ", description=" + description
            + ", status=" + status + ", dateCreated=" + dateCreated
            + ", dateUpdated=" + dateUpdated + "]";
}
} 
```

我收到以下消息：方法失败：发生 HTTP/1.1 400 错误请求 JAXBException：类
javax.jdo.identity.LongIdentity 或其任何超类在此上下文中是已知的.. 类 javax.jdo.identity.LongIdentity 或任何它的超类在这种情况下是已知的..

我是 xml 注释的新手。请指教 .....

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:55:14.657

一些 JPA 实现操作实体类的字节码。这可能涉及添加字段。由于您在 JAXB 映射中使用字段访问，因此您可能已受此影响。我建议改用`PROPERTY`access 并将您的注释移动到`get`方法中。

**了解更多信息**

*   [http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html](http://blog.bdoughan.com/2011/06/using-jaxbs-xmlaccessortype-to.html)

# java - 如何交换2个对象的颜色

> ID：13299735
> 
> 赞同：0
> 
> 时间：2012-11-08T23:30:38.300
> 
> 标签：java, colors

这是我有问题的代码：

```
import java.awt.Color;
import java.awt.Graphics;
import javax.swing.JPanel;

import sun.java2d.loops.DrawRect;

import java.awt.event.MouseListener;
import java.awt.event.MouseEvent;

public class Board extends JPanel implements MouseListener
{
//instance variables
private int width;
private int height;
private Block topLeft;
private Block topRight;
private Block botLeft;
private Block botRight;

public Board()  //constructor
{
    width = 200;
    height = 200;
    topLeft=new Block(0,0,width/2-10,height/2-10,Color.RED);
    topRight=new Block(width/2,0,width/2-10,height/2-10,Color.GREEN);
    botLeft=new Block(0,height/2,width/2-10,height/2-10,Color.BLUE);
    botRight=new Block(width/2,height/2,width/2-10,height/2-10,Color.YELLOW);
    setBackground(Color.WHITE);
    setVisible(true);
    //start trapping for mouse clicks
    addMouseListener(this);
}

//initialization constructor
public Board(int w, int h)  //constructor
{
    width = w;
    height = h;
    topLeft=new Block(0,0,width/2-10,height/2-10,Color.RED);
    topRight=new Block(width/2,0,width/2-10,height/2-10,Color.GREEN);
    botLeft=new Block(0,height/2,width/2-10,height/2-10,Color.BLUE);
    botRight=new Block(width/2,height/2,width/2-10,height/2-10,Color.YELLOW);
    setBackground(Color.WHITE);
    setVisible(true);
    //start trapping for mouse clicks
    addMouseListener(this);
}

public void update(Graphics window)
{
    paint(window);
}

public void paintComponent(Graphics window)
{
super.paintComponent(window);
topRight.draw(window);
topLeft.draw(window);
botRight.draw(window);
botLeft.draw(window);

}

public void swapTopRowColors()
{
Color temp = topLeft.getColor(topRight);
topRight.setColor(temp);
repaint();
 }

public void swapBottomRowColors()
{

}

public void swapLeftColumnColors()
{

}

public void swapRightColumnColors()
{

} 
```

我将如何使用该方法交换其中 2 个“正方形”的颜色`.getColor()`？我在想我在实现它的正确轨道上，但以前不必用颜色做这样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:31:59.517

您将需要使用`setColor()`，但在此之前您需要创建其中一种颜色的温度。

```
public void swapColors(Block g1, Block g2) {
    Color c = g1.getColor();
    g1.setColor(g2.getColor());
    g2.setColor(c);
    repaint();
} 
```

同样使用此方法标头，您可以从对象中交换两种颜色，`Block`而无需为每种组合使用不同的方法，只需将要交换的两种颜色作为参数传递即可。

编辑：

看来您需要为您的 Block 类添加一个 getter 和 setter `color`，所以只需添加：

```
public Color getColor() {
    return this.color; 
}

public void setColor(Color c) {
    this.color = c;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:33:42.547

```
public void swapTopRowColors()
{
    Color temp = topLeft.getColor(topRight);
    topLeft.setColor(topRight.getColor()); //<-- line you're missing
    topRight.setColor(temp);
    repaint();
} 
```

===以下评论===

你需要在你的`Block`类中添加getter和setter：

```
public Color getColor() {
    return color;
}

public void setColor(Color color) {
    this.color = color;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:43:27.990

在默认构造函数调用中有 2 个几乎相同的构造函数 Board() 和 Board(h,w), su：

```
public Board()  //constructor
{
    Board(200,200);
} 
```

如果您使用此方法，将来您将只需要编辑一个构造函数，而不是两个。

# css - FF 偶尔无法加载托管在 s3 上的 Web 字体

> ID：13299737
> 
> 赞同：0
> 
> 时间：2012-11-08T23:30:43.210
> 
> 标签：css, firefox, fonts, amazon-s3, webfonts

我们在 S3 上托管了一个字体作为 woff 并通过 CSS 引用。S3 存储桶配置了 CORS，以允许从任何地方进行跨站点访问。通常，字体显示没有问题。但是，有时 Firefox 无法呈现字体并且错误控制台报告“不允许的错误 URI 或跨站点访问”。我正在尝试弄清楚 FF 用于从 S3 获取字体资源的 HTTP 调用序列，但没有取得多大成功，因此我可以使用 curl 调试情况。到目前为止，调试与

`curl -s -I -X OPTIONS --header "Origin: http://www.foo.com" --header "Access-Control-Request-Method: GET" s3.amazonaws.com/font.woff`

只产生了 HTTP 200 响应，即没有提供有关可能失败的信息。我不知道如何弄清楚发生了什么。我不知道 S3 是否偶尔返回对 OPTIONS 请求的虚假 403 响应、对资源本身请求的 403 响应，或者我们的 HTML/CSS 以某种方式被巧妙地破坏和/或暴露了 FF 中的错误。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T21:32:36.463

这看起来是针对 firefox 实施的 xss（跨站点脚本）攻击的有意预防措施。

在此处阅读一种可能的解决方案：[Firefox 上的可下载字体：不允许使用错误的 URI 或跨站点访问](https://stackoverflow.com/questions/15024333/downloadable-font-on-firefox-bad-uri-or-cross-site-access-not-allowed)

# c# - LINQ to Entites 在 ID 或 null 上加入

> ID：13299738
> 
> 赞同：0
> 
> 时间：2012-11-08T23:30:46.913
> 
> 标签：c#, .net, asp.net-mvc-3, linq, linq-to-entities

我有一个 LINQ to Entities 语句，它在 AlphaGroupID 上连接两个模型，如下所示：

```
IEnumerable<ICD.ViewModels.HomeSearchViewModel> ICDList = (from a in ICDUnitOfWork.AlphaGroups.Find()
                                                                       join e in ICDUnitOfWork.Alphas.Find()
                                                                       on a.AlphaGroupID equals e.AlphaGroupID) 
```

我需要加入 AlphaGroupID 上的两个表，但我还需要所有 ICDUnitOfWork.AlphaGroups，无论它们在 ICDList 中是否有相应的 AlphaGroupID。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:36:41.233

使用`join into`（与GroupJoin相同）：

```
var query = from a in ICDUnitOfWork.AlphaGroups.Find()
            join e in ICDUnitOfWork.Alphas.Find()
                   on a.AlphaGroupID equals e.AlphaGroupID into g
            select new { AlphaGroup = a, Alphas = g }; 
```

GroupJoin 产生分层结果 - 对于外部序列中的每个项目，将生成内部序列中相应项目的序列（序列可以为空）。

# javascript - 听触发器

> ID：13299739
> 
> 赞同：0
> 
> 时间：2012-11-08T23:30:49.783
> 
> 标签：javascript, jquery

我正在使用一个库，完成后将通过`$(document).trigger('playlistDone');`. 我正在听这个触发器，但我没有得到`alert()`我所期望的。

```
$(document).bind('playlistDone', function() {
   alert('done');
}); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:34:57.410

首先，从 jQuery 1.7 开始，附加事件的首选方法是`on`，而不是`bind`（参见[http://api.jquery.com/on/](http://api.jquery.com/on/)）。

其次，您的基本语法看起来不错，但重要的是要了解您处理的是*自定义*事件，而不是*浏览器*事件。这意味着你的库必须使用 jQuery 来触发它的事件，否则 jQuery 不会在它发生时检测到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:36:20.267

使用[.on()](http://api.jquery.com/on/)。来自 jQuery 文档：

> .on() 方法将事件处理程序附加到 jQuery 对象中当前选定的元素集。从 jQuery 1.7 开始，.on() 方法提供了附加事件处理程序所需的所有功能。

尝试这样的事情：

```
$(document).on('playlistDone', function( a ) {
   alert( a );
}); 
```

和

```
var data = 'Done';
$(document).trigger('playlistDone', data ); 
```

# c++ - 内联函数静态常量是唯一的吗？

> ID：13299742
> 
> 赞同：10
> 
> 时间：2012-11-08T23:31:10.920
> 
> 标签：c++

这是一个示例代码：

```
enum Foo // or enum class whatever
{   BAR
,   STUFF
};

inline const char* to_string( const Foo& foo )
{
    static const char* const NAMES[] = 
    {    "BAR"
    ,    "STUFF"
    };
    // let's assume I have some boundary checks here, it's not the point
    return NAMES[foo];
}; 
```

这个函数是内联的，在几个编译单元中使用的一个头文件中。这里的目标是如果不使用这个函数，编译器什么也不做。

问题：

1.  C++ 标准是否保证 NAMES 只存在于一个目标文件中，还是由编译器决定，还是保证每个目标文件都有它的副本？
2.  如果会有多个副本，是否会出现链接问题（我假设我无法测试足够的编译器来检查）。
3.  gcc、msvc 和 clang 是否都会通过使最终的二进制文件只有一个 NAMES 实例来优化这种情况？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T23:46:41.363

是的，标准保证只有一个对象。从 C++03 §7.1.2/4 开始：

> [...]函数`static` 中的局部变量`extern inline`总是引用同一个对象。外部内联函数中的字符串文字是不同翻译单元中的相同对象。

（请注意，`extern inline`函数是`inline`具有外部链接的`inline`函数，即未标记为的函数`static`。）

它出现在哪个目标文件中将取决于编译器，但我怀疑发生的是每个使用它的目标文件都会得到一个副本，链接器将任意选择一个符号并丢弃其余的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:41:12.827

该标准保证只*使用*一份副本。它不能保证不会有未使用的副本占用代码空间。

链接器通常负责合并所有引用以使用相同的实例。

# ruby-on-rails - 从运行空迁移中恢复的最佳方法？

> ID：13299744
> 
> 赞同：1
> 
> 时间：2012-11-08T23:31:25.773
> 
> 标签：ruby-on-rails, migration, rake

我前段时间创建了一个迁移，我一定忘记了填充什么的。我只是去重新创建它并得到以下信息：

```
Another migration is already named add_user_id_to_comments:
foo/db/migrate/20121103004535_add_user_id_to_comments.rb 
```

从那以后，我已经运行了很多次“rake db:migrate”，并且进行了一些新的迁移......

摆脱这种混乱的最好方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:26:00.320

If the old one is completely blank, just delete it. Its absence will not adversely affect anything. If you want to remove all traces, you'll also want to remove 20121103004535 from your `schema_migrations` table, but it is not required....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:39:20.853

只是重命名您当前的迁移呢？

```
add_user_id_to_comments_1.rb 
```

# javascript - 为什么我不能在 Backbone 中触发成功回调？

> ID：13299764
> 
> 赞同：1
> 
> 时间：2012-11-08T23:33:12.233
> 
> 标签：javascript, backbone.js, backbone-views

我有以下代码：

```
App.Views.UseCategory = Backbone.View.extend({
  template: HandlebarsTemplates['uses/useCategory'],

  initialize: function() {
    _.bindAll(this, 'render', 'addCategory');
    this.render();
  },

  events: {
    'submit #addCategoryForm': 'addCategory'
  },

  render: function() {
    $(this.el).append(this.template(this.options));
    return this;
  },

  addCategory: function(event) {
    event.preventDefault();
    var self = this;
    var useCategoryId = $('select[id=use_category_id]').val();

    this.model.set('category_id', parseInt(useCategoryId,10));
    this.model.save({ success: console.log('success') });
  }
}); 
```

上面的代码有效并触发成功回调，所以我在控制台中收到“成功”。

但是为什么当我将该 addCategory 函数更改为：

```
 addCategory: function(event) {
    event.preventDefault();
    var self = this;
    var useCategoryId = $('select[id=use_category_id]').val();

    this.model.set('category_id', parseInt(useCategoryId,10));
    console.log('save?');
    this.model.save({ success: this.addedCategory, error: function() { console.error(arguments) } });
  },

  addedCategory: function() {
    console.log('success');
  } 
```

成功回调不再触发，为什么？

编辑：

![在此处输入图像描述](../Images/091fc0d28610635bc5f80c4d2702d700.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:49:02.907

当你这样做时：

```
this.model.save({ success: console.log('success') }); 
```

您已经调用了控制台日志。你应该做的是（不一样）：

```
this.model.save({ success: function() {
    console.log('success')
} }); 
```

您了解区别还是需要澄清？

事实上，我怀疑你的`success`回调永远不会被调用。

**编辑：**

`model.save(data, opts)`有两个参数。你应该做：

```
this.model.save({}, { success: function() {
    console.log('success')
} }); 
```

# xml - Starling，Atlas 纹理“纹理不能为空”

> ID：13299766
> 
> 赞同：2
> 
> 时间：2012-11-08T23:33:16.140
> 
> 标签：xml, actionscript-3, textures, starling-framework

我开发了一个 Flex/Starling 游戏，我想使用 Atlas Texture 来优化所有精灵调用。我的问题是我使用了一个清晰简单的代码，具有基本的资源并且我无法运行，我得到一个参数错误，纹理不能为空。我知道 .getTexture 方法什么也没找到，但我看不出如何解决这个问题，我的代码：

```
[Embed(source = "Atlas_bg/AtlasBackground.xml")]
public var AtlasXml:Class

[Embed(source = "Atlas_bg/AtlasBackground.png")]
public var AtlasPng:Class

// create atlas
var texture:Texture = Texture.fromBitmap(new AtlasPng());
var xml:XML = XML(new AtlasXml());
var atlas:TextureAtlas = new TextureAtlas(texture, xml);
// display a sub-texture
var objsTexture:Texture = atlas.getTexture("star_0");// ne trouve rien
var objsImage:Image = new Image(objsTexture);
addChildAt(objsImage, 0.6);
objsImage.x = 200;
objsImage.y = 200; 
```

XML 内容：

```
<TextureAtlas imagePath="AtlasBackground.png">
    <SubTexture name="star_0" x="2" y="2" width="20" height="20"/>
    <SubTexture name="star_1" x="2" y="24" width="20" height="20"/>
</TextureAtlas> 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T14:58:43.363

我认为您没有正确嵌入**Atlas XML 文件**，因此无法正确读取**TextureAtlas的信息。**

尝试以下两个添加：

1.  在您的元标记中添加**mimeType**属性`Embed`：

    [嵌入(source = "Atlas_bg/AtlasBackground.xml", mimeType="application/octet-stream")] public var AtlasXml:Class;

2.  在 XML 文件的开头添加以下行：

    <?xml 版本="1.0" 编码="UTF-8"?>

在此之后，**清理您的项目**几次以摆脱先前使用不正确的嵌入文件的构建并再次构建您的项目。现在一切都应该正常了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T02:00:48.067

你确定那是指的地方`ArgumentError`吗？我注意到您在第二个参数中使用a`Number`而不是a 函数。`int``addChildAt()`

试着把它换成这个，看看是否能解决问题：

```
addChild(objsImage); 
```

# python - 更改熊猫时间戳的开始和结束时间

> ID：13299769
> 
> 赞同：2
> 
> 时间：2012-11-08T23:33:25.763
> 
> 标签：python, pandas

我正在处理一个数据集，其中观察发生在开放时间和关闭时间之间——但服务在它打开后的第二天关闭。例如，早上 7 点开门，第二天凌晨 1 点关门。

这感觉像是一个非常普遍的问题——我已经四处寻找它并且对我可能只是不知道要搜索的正确术语的事实持开放态度。

对于我的大多数用途来说，执行以下操作就足够了：

```
 open_close = pd.DatetimeIndex(start='2012-01-01 05:00:00', periods = 15, offset='D') 
```

然后我可以在 df 上做一些有趣的小团体：
`df.groupby(open_close.asof).agg(func).`

但是我遇到了一个实例，我需要抓住多个这样的开闭期。我真正想做的只是有一个 DatetimeIndex ，我可以在其中选择一天的开始时间。所以我可以将“一天”重新定义为从早上 5 点到早上 5 点。这样做的好处是我可以使用类似的东西`df[df.index.dayofweek == 6]`并取回从周日早上 5 点到 Monda 早上 5 点的所有内容。

感觉就像 Periods ......或者 pandas 内部的东西预料到了这个请求。很想帮忙弄清楚。

编辑：

我还通过在正确的日子创建另一个专栏来解决这个问题
`df['shift_day'] = df['datetime'].apply(magicFunctionToFigureOutOpenClose)`
——所以这不会阻碍我的进步。感觉就像可以很好地集成到包中的东西（或日期时间......或某处......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T23:27:20.853

也许`base`df.resample() 的参数会有所帮助：

```
base : int, default 0
    For frequencies that evenly subdivide 1 day, the "origin" of the
    aggregated intervals. For example, for '5min' frequency, base could
    range from 0 through 4\. Defaults to 0 
```

这是一个例子：

```
In [44]: df = pd.DataFrame(np.random.rand(28),
....:           index=pd.DatetimeIndex(start='2012/9/1', periods=28, freq='H'))

In [45]: df
Out[45]: 
                            0
2012-09-01 00:00:00  0.970273
2012-09-01 01:00:00  0.730171
2012-09-01 02:00:00  0.508588
2012-09-01 03:00:00  0.535351
2012-09-01 04:00:00  0.940255
2012-09-01 05:00:00  0.143483
2012-09-01 06:00:00  0.792659
2012-09-01 07:00:00  0.231413
2012-09-01 08:00:00  0.071676
2012-09-01 09:00:00  0.995202
2012-09-01 10:00:00  0.236551
2012-09-01 11:00:00  0.904853
2012-09-01 12:00:00  0.652873
2012-09-01 13:00:00  0.488400
2012-09-01 14:00:00  0.396647
2012-09-01 15:00:00  0.967261
2012-09-01 16:00:00  0.554188
2012-09-01 17:00:00  0.884086
2012-09-01 18:00:00  0.418577
2012-09-01 19:00:00  0.189584
2012-09-01 20:00:00  0.577041
2012-09-01 21:00:00  0.100332
2012-09-01 22:00:00  0.294672
2012-09-01 23:00:00  0.925425
2012-09-02 00:00:00  0.630807
2012-09-02 01:00:00  0.400261
2012-09-02 02:00:00  0.156469
2012-09-02 03:00:00  0.658608 
```

```
In [46]: df.resample("24H", how=sum, label='left', closed='left', base=5)
Out[46]: 
                             0
2012-08-31 05:00:00   3.684638
2012-09-01 05:00:00  11.671068

In [47]: df.ix[:5].sum()
Out[47]: 0    3.684638

In [48]: df.ix[5:].sum()
Out[48]: 0    11.671068 
```

# actionscript-3 - AS3/AIR 中许多相同矢量形状的动画优化

> ID：13299773
> 
> 赞同：0
> 
> 时间：2012-11-08T23:33:56.463
> 
> 标签：actionscript-3, events, optimization, bitmap, rendering

我有许多相同的小矢量圆圈在屏幕上移动，但仅在定义的区域中出现定义的时间段。目前，这些圆圈是任何父对象生成它们的子对象，并且每个圆圈都有自己的动画帧间处理程序（移动几个像素，可能更改 alpha）。屏幕上有数百个，这有点慢。

将圆圈缓存为位图是否可取？将它们全部添加到一个数组中并让一个帧间事件处理程序在整个 shebang 中运行会更好吗，即使高达 90% 没有在特定帧中进行动画处理？

将一个圆缓存为位图并将所有其他圆设置为使用第一个形状的位图数据会更快吗？使用“CopyPixel”方法在每一帧的新位置擦除和重绘（“blit”）每个圆圈会更好吗？我听到关于 CopyPixel 在大型移动设备画布上有用性的相互矛盾的报告......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:49:54.637

如果动画可以循环播放，请从电影中制作电影，否则请尽你所能。通常 CopyPixel 方法更快，但我不会期望太多。我认为它也不会支付账单，因此减少了圈子的数量。

# backbone.js - 主干.js 事件监听器只能附加到“el”属性的子元素

> ID：13299778
> 
> 赞同：1
> 
> 时间：2012-11-08T23:34:11.663
> 
> 标签：backbone.js

我正在关注主干教程[http://backbonetutorials.com/what-is-a-view/](http://backbonetutorials.com/what-is-a-view/)并且在**监听事件**段落中有以下短语：

> 请记住，事件侦听器只能附加到“el”属性的子元素。

然后他们正在执行以下代码：

```
<script type="text/template" id="search_template">
  <label>Search</label>
  <input type="text" id="search_input" />
  <input type="button" id="search_button" value="Search" />
</script>

<div id="search_container"></div>

<script type="text/javascript">
    SearchView = Backbone.View.extend({
        initialize: function(){
            this.render();
        },
        render: function(){
            var template = _.template( $("#search_template").html(), {} );
            this.$el.html( template );
        },
        events: {
            "click input[type=button]": "doSearch"
        },
        doSearch: function( event ){
            // Button clicked, you can access the element that was clicked with event.currentTarget
            alert( "Search for " + $("#search_input").val() );
        }
    });

    var search_view = new SearchView({ el: $("#search_container") });
</script> 
```

但是 el 属性`#search _container`根本没有孩子。他们正在将侦听器应用于`input`哪个是`search_template`

我想我误解了一些东西，因为它对我没有任何意义。谁能纠正我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:42:24.023

当 SearchView.render 被调用`#search _container`时会有 children ，模板的内容定义在`#search_template`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:45:39.233

在backbone.js 中，事件是委托的，实际上我们并不关心HTML 尚未呈现，因为在呈现视图时会自动附加事件。

# c# - 这个 C# 编码代码的 PHP 等价物是什么？

> ID：13299779
> 
> 赞同：6
> 
> 时间：2012-11-08T23:34:27.527
> 
> 标签：c#, php

我想将以下 C# 代码转换为 PHP。

C# 是：

```
byte[] operation = UTF8Encoding.UTF8.GetBytes("getfaqs");
byte[] secret = UTF8Encoding.UTF8.GetBytes("Password");

var hmac = newHMACSHA256(secret);
byte[] hash = hmac.ComputeHash(operation); 
```

我变成了这个：

```
$hash = hash_hmac( "sha256", utf8_encode("getfaqs"), utf8_encode("Password")); 
```

然后我有：

```
var apiKey = "ABC-DEF1234";
var authInfo = apiKey + ":" + hash

//base64 encode the authorisation info
var authorisationHeader = Convert.ToBase64String(Encoding.UTF8.GetBytes(authInfo)); 
```

我认为应该是：

```
$authInfo = base64_encode($apiKey . ":" . $hash); 
```

或者

```
$authInfo = base64_encode(utf8_encode($apiKey . ":" . $hash)); 
```

但不确定，请注意第二个编码使用 Encoding.UTF8，而不是 UTF8Encoding.UTF8。

PHP 代码应该是什么样的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T23:42:12.200

PHP 字符串已经是（某种）`byte[]`，php 没有任何编码意识。`utf8_encode`实际上将 ISO-8859-1 转换为 UTF-8，所以这里不需要。

如果这些字符串是您文件中的文字，则该文件只需要以 UTF-8 编码保存。

作为第 4 个参数传递`true`并`hash_hmac`删除这些`utf8_encode`调用：

```
$hash = hash_hmac( "sha256", "getfaqs", "Password", true ); 
```

此外，字符串连接运算符是`.`, 所以 :

```
$authInfo = base64_encode($apiKey . ":" . $hash); 
```

# php - 在php中确定某个工作日的年月日

> ID：13299781
> 
> 赞同：0
> 
> 时间：2012-11-08T23:34:42.763
> 
> 标签：php, date

假设我想要一个包含星期几的数据库。例如，数据库中的一条记录可以包含“星期四”。我希望能够随时运行我的脚本，并在每次运行我的脚本时确定下一个星期四的年月日。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:40:08.897

您可以[`strtotime()`](http://php.net/manual/en/function.strtotime.php)为此使用：

```
$time = strtotime("next Thursday");
echo date("M d, Y", $time); // Echos "Nov 15, 2012" 
```

示例：http: [//codepad.org/NRm3xoJB](http://codepad.org/NRm3xoJB)

# ios - didFailLoadWithError 中的 webVIew.request.URL: 是前一个 URL 不是失败的 URL

> ID：13299782
> 
> 赞同：2
> 
> 时间：2012-11-08T23:34:47.647
> 
> 标签：ios, uiwebview

假设有一个网页 A.html 包含指向 B.html 的链接。

如果单击 B.html，则 shouldStartLoadWithRequest: 中的 request.URL 将是 B.html。但是，如果加载该页面时出现问题（例如假设它不存在），那么在 didFailLoadWithError 中：webView.request.URL 的值不是 B.html 而是 A.html。

因此，除非我缓存最后一个页面加载，否则似乎不可能知道哪个页面加载失败，但我希望 webView.request.URL 是 B.html，因此这是一个缺陷吗？我没有看到关于它应该是什么的文档。

[iOS 6]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-22T19:37:42.820

我有同样的问题。如果其他人也这样做，则 error.userInfo 字典可以代替。

```
-(void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error

{

    if (error.domain == NSURLErrorDomain) {
        if (error.code == NSURLErrorCancelled) { //ignore this one, interrupted load
            return;
        }
}
}
//NSString *theURLString = [webView.request.URL absoluteString]; this won't work - it just returns the last successful url
NSString *theURLString = [error.userInfo objectForKey:@"NSErrorFailingURLStringKey"]; //this works 
```

该文档说 NSErrorFailingURLStringKey 在 iOS4 中已弃用（仅提供向后兼容性），您应该改用 NSURLErrorFailingURLStringErrorKey 。

但是 NSURLErrorFailingURLStringErrorKey 没有返回（反正不是我的 UIWebView 版本）。相反， NSErrorFailingURLKey 是另一个返回 URL 的键，但我在任何地方的文档中都找不到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-18T05:13:43.643

我在 Swift 3.1 中遇到了同样的问题。要获取失败的 url，请使用此委托方法：

```
func webView(_ webView: UIWebView, shouldStartLoadWith request: URLRequest, navigationType: UIWebViewNavigationType) -> Bool{

    let failedUrl = (request.url?.absoluteString)! as String
    return true
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T00:20:14.517

没错，您需要缓存发送的最后一个请求（`shouldStartLoadWithRequest:`委托方法将是这样做的好地方），因为`request`a 的属性`UIWebView`似乎总是​​返回最后一个*成功*的请求（尽管[文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instp/UIWebView/request)没有具体说明这个，所以我不会称之为缺陷）。

# iphone - 如何将子类 UIView 中的数字或数据传递给 UIViewController？

> ID：13299787
> 
> 赞同：-1
> 
> 时间：2012-11-08T23:35:12.340
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我有子类 UITableViewController 和内部表我有自定义单元格。这个自定义单元格在里面有 UIView 的子类。所以这个 UIView 是写在它自己的类里的。在我的代码中，UITableViewController 类被命名为 MainViewController.h/.m，而 UIView 的类被命名为 ContentView.h/.m 所以在 ContentView 中我添加了一个图像和 tapGestureRecognizer。当点击图像时，某个日期（在本例中为数字）被发送到 MainViewController。第一个问题是委托方法没有被调用。如果我用 notificationCenter 调用它，它会将其记录为 0.00000 有人可以帮我将数据从单元格内的视图传递到 ViewController。

这是我的代码：

内容视图.h：

```
@class ContentView;
@protocol ContentViewDelegate
- (void)passDigit:(float)someDigit;
@end

#import <UIKit/UIKit.h>
#import "MainViewController.h"

@interface ContentView : UIView
{
    id <ContentViewDelegate> delegate;
    float someDigit;
}

@property float someDigit;
@property (assign) id <ContentViewDelegate> delegate;

@end 
```

内容视图.m

```
#import "ContentView.h"

@implementation ContentView
@synthesize someDigit;
@synthesize delegate;

- (void)handleContentTouch:(UIGestureRecognizer *)gesture
{
    someDigit  = 134;
    [self.delegate passDigit:someDigit];
}

- (void)setupView
{
    CGRect frame = self.frame;

    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(handleContentTouch:)];
    UIImageView *fifthBackground = [[UIImageView alloc] initWithFrame:CGRectMake(0,0,100,100)];
    [self addSubview:fifthBackground];
    [fifthBackground setUserInteractionEnabled:YES];
    [fifthBackground addGestureRecognizer:tap];
} 
```

主视图控制器.h

```
#import <UIKit/UIKit.h>
#import "ContentView.h"

@interface MainViewController : UITableViewController <UITableViewDelegate, UITableViewDataSource, UIScrollViewDelegate, ContentViewDelegate>
@end 
```

主视图控制器.m

```
#import "MainViewController.h"

@implementation MainViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    ContentView *contentView = [[ContentView alloc]initWithFrame:CGRectMake(0, 0, 320, 480)];
    contentView.delegate = self;
}

- (void) passDigit:(float)someDigit
{
    NSLog(@"%f",someDigit);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T03:17:32.460

不确定您要做什么，可能是您是新手并且正在学习一些东西。尝试执行以下操作：

在 mainViewController 中更改您的方法

```
- (void) showDetailViewControllerWithDigit:(float)someDigit
{
  NSLog(@"%f",someDigit);
} 
```

至

```
- (void)passDigit:(float)someDigit
{
  NSLog(@"%f",someDigit);
} 
```

它应该可以工作。在这里也不是很相关，但是您在两个不同的地方拼写了委托和委托。请注意，它们都将被视为两个不同的变量。虽然没有必要有一个同名的实例变量，但我绝对不会有一个轻微的错字，因为它会在以后引起很多问题。

当您为委托定义协议时，您在那里定义的方法应该在委托类中实现。

同样在您的代码中，显然您错过了一些部分，这些部分显示了您在主视图控制器中添加 contentView 的位置。我假设你有一些地方

```
[self.view addSubview:contentView]; 
```

在 viewDidLoad 或某些地方，没有它你甚至看不到 contentView，因此无法点击它。

快乐编码。

# vim - :buffers 遇到的模式名称是什么？

> ID：13299788
> 
> 赞同：2
> 
> 时间：2012-11-08T23:35:18.923
> 
> 标签：vim

在 vim 中，输入 :buffers 和其他一些命令会显示结果页面。这个页面感觉像是一个残缺的正常模式，因为 h、j、k 和 l 可以导航，但其他命令（如 ctrl-u 和 ctrl-d）不能。视觉模式也不能用于在此模式下选择文本。

这种模式的名称是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:55:37.537

对此的常用术语是“hit-enter prompt”。然而，重新阅读文档中的相关部分，我们了解到实际上有*两种*非常相似的提示模式。您正在处理的是**“更迅速”**。

您可以在 找到有关它的所有信息[`:h more-prompt`](http://vimdoc.sourceforge.net/htmldoc/message.html#more-prompt)。

# binary-tree - 在 SML 中查找二叉树的最深元素

> ID：13299796
> 
> 赞同：1
> 
> 时间：2012-11-08T23:36:07.677
> 
> 标签：binary-tree, sml, smlnj

这是一个家庭作业问题。

我的问题很简单：编写一个类型为'a btree ->'的函数btree_deepest，它返回树中最深元素的列表。如果树是空的，那么 deepest 应该返回 []。如果输入树的多个元素处于相同的最大深度，则 deepest 应返回包含这些最深元素的列表，并根据前序遍历进行排序。您的函数必须使用提供的 btree_reduce 函数，并且不能是递归的。

这是我的代码：

```
(* Binary tree datatype. *)
datatype 'a btree = Leaf | Node of 'a btree * 'a * 'a btree

(* A reduction function. *)
(* btree_reduce : ('b * 'a * 'b -> 'b) -> 'b -> 'a tree -> 'b) *)
fun btree_reduce f b bt =
   case bt of
   Leaf => b
   | Node (l, x, r) => f (btree_reduce f b l, x, btree_reduce f b r)

(* btree_size : 'a btree -> int *)
fun btree_size bt =
    btree_reduce (fn(x,a,y) => x+a+y) 1 bt

(* btree_height : 'a btree -> int *)
fun btree_height bt =
    btree_reduce (fn(l,n,r) => Int.max(l, r)+1) 0 bt 
```

我知道我必须创建一个函数来传递给 btree_reduce 以构建最深元素的列表，这就是我步履蹒跚的地方。

如果允许我使用递归，那么我将只比较左右节点的高度，然后在更高的分支上递归（或者如果它们的高度相同，则在两者上递归），然后在高度为零时返回当前元素和将这些元素放入列表中。

我想我只需要朝着正确的方向努力就可以开始了……

谢谢！

更新：

这是一个无法编译的解决方案的尝试：

```
fun btree_deepest bt =
let
val (returnMe, height) = btree_reduce (fn((left_ele, left_dep),n,(right_ele, right_dep)) => 
    if left_dep = right_dep 
        then 
            if left_dep = 0 
                then ([n], 1) 
                else ([left_ele::right_ele], left_dep + 1)
        else 
            if left_dep > right_dep
                then (left_ele, left_dep+1) 
                else (right_ele, right_dep+1)
    ) 
    ([], 0) bt
in  
    returnMe
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T08:42:52.380

为了获得最大深度的元素，您需要同时跟踪访问的每个子树的两件事`btree_reduce`：该子树的最大深度，以及在该深度找到的元素。将这些信息包装在一些数据结构中，你就有了你的类型`'b`（根据`btree_reduce`的签名）。

现在，当您需要在提供给 的函数中组合两个子树结果时`btree_reduce`，您有三种可能的情况：“左”子结果是“更深”、“更浅”或“等深”到“右”子结果。请记住，子结果表示每个子树中最深节点的深度和节点值，并考虑如何将它们组合以获得当前树的深度和最深节点的值。

如果您需要更多指针，我有一个`btree_deepest`ready 的实现，我很想分享；我还没有发布它，因为你特别（并且光荣地）要求提示，而不是解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T22:37:47.140

看看你的代码；看起来 X_ele 是单个元素还是列表存在一些混淆，这会导致类型错误。尝试在上面的第一个“else”分支中使用“@”运算符：

```
 if left_dep = 0 
            then ([n], 1) 
            else (left_ele @ right_ele, left_dep + 1) 
```

# php - Wordpress curl 保存图片

> ID：13299798
> 
> 赞同：0
> 
> 时间：2012-11-08T23:36:15.243
> 
> 标签：php, wordpress, curl, preg-match

我正在将来自外部站点的图像保存到我的 wordpress 主题中的文件夹中。而且我想知道是否可以两次调用 curl 或者一次就可以完成。

例子：

```
$data = get_url('http://www.veoh.com/watch/v19935546Y8hZPgbZ'); // getting the url first curl instance
preg_match('/fullHighResImagePath="(.*?)"/', $data, $thumbnail); // find the image from content
savePhoto($thumbnail, $post->ID); //2nd instance of curl to save the image

function get_url($url) {
$user_agent = "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2)";
    $ytc = curl_init(); // initialize curl handle 
    curl_setopt($ytc, CURLOPT_URL, $url); // set url to post to 
    curl_setopt($ytc, CURLOPT_FAILONERROR, 1);  // Fail on errors 
    curl_setopt($ytc, CURLOPT_FOLLOWLOCATION, 1); // allow redirects 
    curl_setopt($ytc, CURLOPT_RETURNTRANSFER, 1); // return into a variable 
    curl_setopt($ytc, CURLOPT_PORT, 80); //Set the port number 
    curl_setopt($ytc, CURLOPT_TIMEOUT, 15); // times out after 15s 
    curl_setopt($ytc, CURLOPT_HEADER, 1); // include HTTP headers
    curl_setopt($ytc, CURLOPT_USERAGENT, $user_agent);
    $source = curl_exec($ytc);
    curl_close($ytc);

     $data = trim( $source );
    return $data;
}

function savePhoto($remoteImage, $isbn) {
    $ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $remoteImage);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 0);
    $fileContents = curl_exec($ch);
    curl_close($ch);
    if (DIRECTORY_SEPARATOR=='/'){
        $absolute_path = dirname(__FILE__).'/'; 
    } else { 
        $absolute_path = str_replace('\\', '/', dirname(__FILE__)).'/'; 
    }
    $newImg = imagecreatefromstring($fileContents);
    return imagejpeg($newImg, $absolute_path ."video_images/{$isbn}.jpg",100);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T04:58:58.440

使用 Worpress 函数[`wp_remote_get`](http://codex.wordpress.org/Function_API/wp_remote_get)并让 Wordpress 使用 curl 处理调用。

所以你可以做类似的事情

```
$data = my_get_remote_content('http://www.veoh.com/watch/v19935546Y8hZPgbZ');
// find the image from content
preg_match('/fullHighResImagePath="(.*?)"/', $data, $thumbnail); 
//2nd instance of curl to save the image
savePhoto(my_get_remote_content($thumbnail), $post->ID); 

function my_get_remote_content($url) {
  $response = wp_remote_get($url, 
    array(
      'headers' => array(
        'user-agent' => 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2)'
      )
    )
  );
  if( is_wp_error( $response ) ) {
    throw new Exception('Error fetching remote content');
  } else {
    $data = wp_remote_retrieve_body($response);
    return $data;
  }  
}

function savePhoto($fileContents, $isbn) {
  if (DIRECTORY_SEPARATOR=='/'){
    $absolute_path = dirname(__FILE__).'/'; 
  } else { 
    $absolute_path = str_replace('\\', '/', dirname(__FILE__)).'/'; 
  }
  $newImg = imagecreatefromstring($fileContents);
  return imagejpeg($newImg, $absolute_path ."video_images/{$isbn}.jpg",100);
} 
```

# java - 日志信息显示在嵌入式码头中，但当应用程序部署到 tomcat 时不显示

> ID：13299801
> 
> 赞同：0
> 
> 时间：2012-11-08T23:36:23.993
> 
> 标签：java, spring, tomcat, spring-mvc, log4j

我的 log4j 属性文件如下所示：

```
log4j.rootCategory=INFO, stdout

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d %p [%c] - <%m>%n

log4j.category.org.springframework.web=INFO
log4j.category.org.springframework.samples.mvc31=INFO 
```

当我在嵌入式码头中运行我的应用程序时，`mvn jetty:run`我会从我的代码中看到记录器信息，例如：`logger.info(myobj)`

但是，当我使用打包应用程序`mvn package`并将其部署到 tomcat 时，我看不到日志。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:19:49.400

Tomcat 中没有控制台，因此默认情况下您的控制台输出被转储到名为 catalina.out 的文件中。你没有那个文件吗？

# ruby-on-rails - “未初始化的常量”错误与类的加载顺序有关吗？

> ID：13299804
> 
> 赞同：1
> 
> 时间：2012-11-08T23:36:41.107
> 
> 标签：ruby-on-rails, ruby-on-rails-3, constants

我正在使用 Ruby v1.9.2 和 Ruby on Rails v3.2.2。我有*许多*具有常量语句的模型类。例如：

```
# app/models/class_one.rb
class ClassOne < ActiveRecord::Base
  CONSTANT_ONE = ClassTwo::CONSTANT_TWO
end

# app/models/class_two.rb
class ClassTwo < ActiveRecord::Base
  CONSTANT_TWO = 1
end 
```

当我重新启动服务器时，我收到以下错误：

```
Routing Error
uninitialized constant ClassTwo::CONSTANT_TWO
Try running rake routes for more information on available routes. 
```

错误是否与文件（以及类）的加载顺序有关？我应该如何解决问题？

*注意*：自从 Ruby on Rails 以来，我听说一个“有效”的解决方案可能是在初始化文件（在`config/initializers/`目录中）中声明常量。如果是这样，应该如何以正确的方式进行？你有什么想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:46:07.200

这两个类是在同一个文件中定义的？哇。重新排序类：

```
class ClassTwo < ActiveRecord::Base
  CONSTANT_TWO = 1
end

class ClassOne < ActiveRecord::Base
  CONSTANT_ONE = ClassTwo::CONSTANT_TWO
end 
```

应该修复它。CONSTANT_ONE = ClassTwo::CONSTANT_TWO 在解析后立即进行评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:36:58.837

正如您开始发现的那样，Rails 中的常量有点痛苦。当您真正深入研究时，痛苦只会增加。在类上使用实际方法比使用常量更容易且更易于维护。例如，在测试中，当涵盖各种用例时，修改方法比修改常量要容易得多。此外，在进行更复杂的编程时，您可能会开始遇到方法不会发生的加载问题（例如多次加载错误或不可用）。我已经完全停止在我的 Rails 应用程序中使用常量，并且一点也没有错过它们。您可能对Advi Grimm 写的具有相同效果[的文章感兴趣。](http://devblog.avdi.org/2011/08/18/do-we-need-constants/)

**编辑：**

如果您真的希望按照您描述的方式使用常量，请查看[在 Ruby on Rails 应用程序中定义常量的最佳位置在哪里？](https://stackoverflow.com/questions/1107782/wheres-the-best-place-to-define-a-constant-in-a-ruby-on-rails-application)了解更多信息。

# ruby-on-rails - 使用 Rails 设置 Capistrano 时遇到问题

> ID：13299807
> 
> 赞同：1
> 
> 时间：2012-11-08T23:37:01.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3, deployment, capistrano

我正在尝试使用 Capistrano 部署我的 Rails 应用程序。

我的 deploy.rb 文件如下所示：

```
require "bundler/capistrano"

server "xx.xx.xxx.xxx", :web, :db, :primary => true

set :application,       "myApp"
set :user,              "ubuntu"
set :deploy_to,         "/home/#{user}/apps/#{application}"
#set :deploy_via,       :remote_cache
set :migrate_target,    :current
set :keep_releases,     3

set :scm,               "git"
set :repository,        "git@github.com:name/#{application}.git"
set :branch,            "master"
set :use_sudo,          false

default_run_options[:pty] = true

# default_run_options[:shell] = '/bin/bash'

ssh_options[:forward_agent] = true
ssh_options[:keys] = ["#{ENV['HOME']}/.ec2/keypair.pem"] 
```

现在每当我尝试做

```
cap deploy:cold 
```

我收到如下错误：

[https://gist.github.com/c54933142b900f9f93b9](https://gist.github.com/c54933142b900f9f93b9)

任何帮助，将不胜感激 。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:55:10.557

我看到的唯一我不认识的是`set :migrate_target :current`——这可能是默认的或暗示的，所以也许没什么好担心的，但你的要点的根本错误是

```
 ** [out :: xx.xx.xxx.xxx] rm:
 ** [out :: xx.xx.xxx.xxx] cannot remove `/home/ubuntu/apps/myApp/current'
 ** [out :: xx.xx.xxx.xxx] : Is a directory 
```

`current`应该是符号链接，而不是目录，所以很难知道它是如何成为目录的。

我将登录到服务器，更改为`/home/ubuntu/apps/myApp/`then `rm -rf current`。从那里您可以手动创建预期的符号链接（当前将链接到名称为日期/时间的目录），或者从本地计算机运行返回`cap deploy:create_symlink`然后尝试常规部署。

我认为可以公平地说，capistrano 初始化并不是它的强项——一旦你把事情搞定，它往往会变得非常可笑，在那之前，更多的是令人发指的迟钝。

# html - Sublime Text 2 - HTML CSS 建议

> ID：13299808
> 
> 赞同：5
> 
> 时间：2012-11-08T23:37:17.020
> 
> 标签：html, css, sublimetext2, autosuggest

我开始使用这个很棒的编辑器。不幸的是，我在这里错过了一项改进（来自 NuSphere PhpED - 我使用过的过去的编辑器，这种理解）

例子：

我有一个项目打开，我打开HTML文件，例如，我想知道一些ID然后在CSS文件中，很容易通过暗示找到。当然，它可以反过来工作（在 CSS 和 HTML 中创建一些东西，然后通过耳语找到它很容易）。

在这种崇高的情况下是行不通的。有插件吗？谢谢（截图[http://i.stack.imgur.com/v39O8.jpg](http://i.stack.imgur.com/v39O8.jpg)）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T00:27:00.157

From what I understand, you want to be able to link autocompletes from one file to another? I'm actually pretty interested in this too, just scanned through the [package-control listings](http://wbond.net/sublime_packages/community) and found:

[***All Autocomplete***](https://github.com/alienhard/SublimeAllAutocomplete) <------

So **yes** you can do it! Go install the package :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-30T22:17:39.903

试试这个[CSS Sublime 包](https://github.com/subhaze/CSS-sublime-package)

听说效果很好……准备试一试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T11:54:44.130

您可以安装 sublime codeintel 包....它可能会有所帮助。这是链接：[https ://github.com/Kronuz/SublimeCodeIntel](https://github.com/Kronuz/SublimeCodeIntel)

# xsl-fo - 如何检测文档的最后一页？

> ID：13299809
> 
> 赞同：2
> 
> 时间：2012-11-08T23:37:18.773
> 
> 标签：xsl-fo, apache-fop

我使用 FOP 从 xml 文件创建 pdf 文件。我想在 pdf 的最后一页显示一些内容。问题是我不知道显示内容需要多少页，所以我怎么知道我在实际的最后一页上？（每个page-sequence可以根据内容的大小生成1+个文档页面）

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T15:17:30.820

您可以为一般页面布局和页眉和页脚指定条件页面母版（fo:static-content）： [http ://www.w3.org/TR/xsl/#page-position](http://www.w3.org/TR/xsl/#page-position)

用法：

1.) 在您的 fo:layout-master-set 中，定义您想要拥有的不同页面母版。例如，一个普通的页面母版和一个用于应该不同的最后一页。

普通页面母版的示例：

```
<fo:simple-page-master master-name="page-master-161302528-normal"
    margin-left="2cm" margin-right="2cm" page-height="297mm"
    page-width="210mm">
    <fo:region-body margin-top="3.5cm" margin-bottom="41mm"
        column-count="1" column-gap="0.50in" />
    <fo:region-before region-name="normal-header"
                    overflow="visible" extent="2cm" />
    <fo:region-after region-name="normal-footer"
                    overflow="visible" extent="40mm" precedence="true" />
</fo:simple-page-master> 
```

2.) 在 fo:layout-master-set 中定义一个 fo:page-sequence-master - 在此处添加条件：

```
<fo:page-sequence-master master-name="page-master-161302528">
    <fo:repeatable-page-master-alternatives>
        <fo:conditional-page-master-reference master-reference="page-master-161302528-last" page-position="last"/>
            <fo:conditional-page-master-reference master-reference="page-master-161302528-normal" />
    </fo:repeatable-page-master-alternatives>
</fo:page-sequence-master> 
```

3.) 在您的文档中，为您定义的 fo 元素（fo:static-content 和 fo:page-sequence）提供主参考 - 如果相应的主元素处于活动状态，则应呈现相应的元素。根据上面的 fo:simple-page-master，fo:static-content 元素必须将 region-name 命名为 flow-name 属性。

例子：

```
<fo:page-sequence force-page-count="no-force"
                    master-reference="page-master-161302528" initial-page-number="auto"
                    format="1">
    <fo:static-content flow-name="normal-header">...</fo:static-content>
</fo:page-sequence> 
```

在这个整体示例中，特定页面页眉和页脚的选择是通过对于正常页眉/页脚（例如“normal-header”）和最后一页页眉/页脚（例如“last -页头”）。

# jquery - jquery/jqueryui/jquerymobile 在backbone.js 应用程序中加载速度不够快

> ID：13299816
> 
> 赞同：1
> 
> 时间：2012-11-08T23:38:02.113
> 
> 标签：jquery, jquery-ui, jquery-mobile, backbone.js, requirejs

在本地，应用程序运行良好，一旦它在服务器上大约 50% 的时间 jquery 库加载速度不够快，并且应用程序会为任何与 jquery 相关的内容抛出一堆未定义的 js 错误。我正在使用带有 jquery、jquery mobile、jquery ui 和 required.js 的主干.js。require js 文件看起来是否正确，或者有没有办法在启动应用程序之前判断脚本是否已加载？

```
require.config({

paths: {
    jquery: 'libs/jquery/jquery-1.7.2',
'jquery.ui':'libs/jquery-ui/jquery-ui-1.8.14.custom',
    'jquery.mobile-config': 'libs/jqm/jquery.mobile-config',
    'jquery.mobile': 'libs/jqm/jquery.mobile-1.1.1',
    underscore: 'libs/underscore/underscore-1.3.3',
    backbone: 'libs/backbone/backbone-amd-0.9.2',
text: 'libs/require/text',
    templates: '../templates'
},

shim: {
    'underscore': {
        exports: "_"
    },
    'backbone': {
        deps: ['jquery','underscore'],
        exports: 'Backbone'
    },
    'jquery.ui': {
        deps:['jquery']
    },
    'jquery.mobile-config': {
        deps: ['jquery']
    },
    'jquery.mobile': {
        deps:['jquery','jquery.mobile-config']
    },
    'bundles': {
        deps:['jquery','jquery.mobile','validate','jquery.ui']
    },
},

waitSeconds: 5

});

require([
    'app'
], function(App) {
    $(function() {
        clearInitialLoader();
        App.initialize();
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T15:01:54.603

虽然我没有使用，但我还需要在特定页面上需要时`underscore`获取大量插件。`requireJS`花了一段时间让它与 Jquery Mobile 一起工作，但这就是我的应用程序的运行方式（而且我不再收到任何错误，所以请随意复制）

1）添加`requirejs`到页眉

```
<script type="text/javascript" data-main="../js/main" src="../js/libs/require/require.js"></script> 
```

2）我正在使用`overrides.js`具有以下功能的：

```
// pre-sets
$(document).bind("mobileinit", function(){
$.mobile.autoInitializePage = false;
}); 
```

你需要这个，因为`jquery mobile`会在之前触发`require.js`（mobileinit vs. docready），这可能是你所有问题的原因= JQM在其他所有东西加载和渲染之前开始运行，所以你必须从你的应用程序控制器手动触发JQM（我的`app.js`）

3）我的`main.js`配置

```
var IS_LOCAL  = /(:\/\/localhost|file:\/\/)/.test(document.location.href);     

requirejs.config({  
         waitSeconds :  (IS_LOCAL? 2 : 45)
      ,  baseUrl:       "../js"
    //,  enforceDefine: true    
      , paths: { 
              app:          'app'
            , overrides:    'overrides'
            , jquery:       'libs/jquery/jquery.min'
            , jqm:          'libs/jquery-mobile/jquery-mobile.min'
            , multiview:    'services/multiview/multiview.min'
            , respond:      'services/respond/respond.min'
            , klass:        'services/klass/klass.min'
            }
      , shim: {
              'overrides':        { deps: ['jquery'] }
            , 'klass':            { deps: ['jquery'] }
            , 'jqm':              { deps: ['jquery'], exports: 'mobile' }
            ,  'services/multiview/multiview.min' :           { deps: ['jquery', 'jqm'] }
            ,  'services/add2home/add2home.min' :             { deps: ['jquery'] }
            ,  'services/datatables/datatables.min' :         { deps: ['jquery'] }
            ... more ... 
            ,  'services/respond/respond.min' :               { deps: ['jquery'] }
                }
        });

    requirejs([ 'overrides', 'jquery', 'jqm', 'multiview', 'respond', 'app'], 
        function( $, overrides, mobile, multiview, respond, App){ 
            App.start();                
            }); 
```

4）然后我有一个`app.js`我运行应用程序并要求`app.js (config files`每个插件的）。这样我可以按需加载。看起来像这样：

```
define([], function(){
    var start = function() {
        require([ 'overrides', 'jquery', 'jqm','multiview', 'respond' ],function() {

        // your magic goes here...

        // request a plugin:
        $(document).on('pagebeforeshow.add2home', '#login', function() {
            // add2Home - trigger once and lock
            var dom = $('html');
            if ( dom.jqmData('bound') != true ) {
                dom.jqmData('bound', true);
                require(['services/addtohome/app'], function (App) {
                    App.render();
                    });
            };
         });

        // don't forget to trigger JQM manually
        if ( $.mobile.autoInitializePage == false){
            $.mobile.initializePage();
        }
        }); // end require
    } // end start
    return {"start":start};
}); 
```

5）这会调用插件`app.js`配置文件，其中包含所有插件配置。看起来像这样：

```
define(['services/addtohome/app', 'services/addtohome/addtohome.min'], function( app, addtohome ) {
function render() {

    if ('standalone' in navigator && !navigator.standalone && (/iphone|ipod|ipad/gi).test(navigator.platform) && (/Safari/i).test(navigator.appVersion)) { 
        var addToHomeConfig = { 
            touchIcon:true,
            animationIn: 'bubble',
            animationOut: 'drop',
            returningVisitor: 'true',
            expire: '10',       
            }; 
        };
    };
return {
    render:render
    };          
}); 
```

当然，您需要的脚本越多，花费的时间就越长，但是这个设置在压缩 + gzipped 的 132k Javascript 中运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T03:27:41.230

因此，在一个实时站点中，您应该缝合和缩小您的资源。AMD 设置中有太多资源，无法实际尝试在实时站点中按需下载所有资源。AMD 模块是开发时的便利，而不是部署解决方案。

就模块顺序而言，我从来没有使用导出的任何运气。我们发现，最好的方法是将外部依赖项包装在 AMD 包装器中。是的，这意味着如果您更新外部库，则需要重新执行此操作，但这实际上并没有您想象的那么重要。

首先你包装图书馆

```
//underscore.js file
define(function(){
  //underscore code
  return underscore
}) 
```

然后您可以将它包含在任何地方，并获得订单保证 AMD 加载的所有好处：

```
//backbone.js (or any other file that wants underscore)
define([underscore],function(_){
  //backbone code
  return Backbone
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:40:06.417

您应该查看允许您按顺序加载模块的[shim 选项。](http://requirejs.org/docs/api.html#config-shim)

您也可以使用[require.js 优化器](http://requirejs.org/docs/optimization.html)将所有文件合并为一个。

# java - Java：从超类型加载动态类注释

> ID：13299817
> 
> 赞同：0
> 
> 时间：2012-11-08T23:38:02.493
> 
> 标签：java, annotations, classloader, superclass

伙计们；这是我的问题：我目前有一个类扩展另一个类，每个类上都有一个 gameinfo.class 注释（有没有办法用编译器强制执行这个？）

理想情况下，我想在它扩展的类型中调用以下内容：

```
 @GameInfo(name = "Default Minigame", aliases = {"DM"}, pvp = false, authors = {"Tom"},
gameTime = 65, description = "desc")
public class DefaultMinigame extends Minigame {

    public DefaultMinigame(Plugin p) {
        super(p, DefaultMinigame.class.getAnnotation(GameInfo.class));
    } 
```

我宁愿不必在每个类中调用上述内容，而是在 Minigame.class 中调用它我将如何在不调用“this”的情况下执行此操作（由于未初始化超类型）

谢谢你的时间！（对不起，如果我说的不是最容易理解的问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:47:44.817

您不能强制子类具有注释。如果这对您很重要，您可以改用模板方法模式。

但是如果你需要使用注解，你可以阅读子类注解

```
class Minigame {
    protected Minigame() {
        GameInfo info = getClass().getAnnotation(GameInfo.class);
    }
} 
```

# c# - 如何根据列中的文本将 Gridview 列中的超链接替换为图像？

> ID：13299820
> 
> 赞同：0
> 
> 时间：2012-11-08T23:38:07.867
> 
> 标签：c#, asp.net, image, gridview, hyperlink

问题几乎说明了一切。在我的 aspx 页面上，我有一个 GridView，在 Columns 下，我有一堆 BoundField，其中一个是 TemplateField

```
 <asp:TemplateField HeaderText = "Status">
            <ItemTemplate>
                <asp:HyperLink ID = "HyperLink1" runat = "server" Target = "_blank"
                    NavigateUrl = '<%# Eval("URL") %>'
                    Text = '<%#Eval("Status") %>'>
                </asp:HyperLink>
            </ItemTemplate>
        </asp:TemplateField> 
```

现在，我希望此超链接映射到不同的图像，具体取决于文本的评估内容。例如，“成功”显示的是一个大大的笑脸，“失败”显示的是皱眉脸，等等。我怎样才能做到这一点？

感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:57:00.577

您可以将图像放在超链接中，例如

```
<img src='/images/status/<%#Eval("Status") %>.jpg' /> 
```

只需按名称为每个状态制作不同的图像。否则，您可能必须对 DataBind 事件执行一些操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:57:12.657

尝试这个

```
protected void myGridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        HyperLink HyperLink1 = e.Row.FindControl("HyperLink1");
        if(SomeText == "Success")
          HyperLink1.NavigateUrl = "Url to Smiley";
        else
          HyperLink1.NavigateUrl = "Url to Frowney";
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T02:10:22.513

如果您尝试设置 ImageUrl 属性，我建议使用该`RowDataBound`事件。处理程序方法可能类似于：

```
protected void questionsGridView_RowDataBound(object sender, System.Web.UI.WebControls.GridViewRowEventArgs e)
{
    DataSourceDataType row;
    HyperLink hyperLink1;

    if (e.Row.RowType == DataControlRowType.DataRow & e.Row.DataItem is DataSourceDataType)
    {
        row = (DataSourceDataType)e.Row.DataItem;
        hyperLink1 = (HyperLink)e.Row.FindControl("HyperLink1");

        hyperLink1.ImageUrl = (row.IsSuccess) ? "~/images/success.png" : "~/images/failure.png";
    }
} 
```

我使用的另一个技巧是将要绑定的数据对象更改为具有指示要使用的 URL 的属性：

```
partial class DataSourceDataType
{
    public string SuccessImgURL
    {
        get
        {
            return (IsSuccess) ? "~/images/success.png" : "~/images/failure.png";
        }
    }
} 
```

然后你绑定到那个属性。

注意：`IsSuccess`需要用您自己的字段名称或布尔条件替换。
我经常将它与 LINQ to SQL 对象一起使用，因此可以使用部分类在单独的文件中添加属性。这样您就不必担心 LINQ to SQL 工具会删除您添加的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T01:36:05.143

```
HyperLink HyperLink1 = (HyperLink)e.Row.FindControl("HyperLink1");

    switch (HyperLink1.Text)
        {
             case "Completed":
                  HyperLink1.ImageUrl = "Images\\Success.png";
                  HyperLink1.ToolTip = "Completed"; 
```

ETC

ToolTip 属性映射到图像的替代文本。

感谢codingbiz让我开始。

# ruby-on-rails - 将 Rails Gem / Engine 转换为应用程序

> ID：13299824
> 
> 赞同：2
> 
> 时间：2012-11-08T23:38:30.160
> 
> 标签：ruby-on-rails, gem

rails 引擎功能非常好，我看过 Railcasts 并阅读了 Rails 文档。我可以看到您如何访问或覆盖引擎中的所有相关组件。

但是，假设我想彻底修改引擎的代码，是否可以将引擎转换回普通的 Rails 应用程序，然后从那里获取它。除了将 gem 中的目录复制到一个空的应用程序目录上之外，还有什么其他的吗？

我在看这个引擎：

[https://github.com/ging/social_stream](https://github.com/ging/social_stream)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:55:36.500

是的，您可以，只需访问[https://github.com/rails/rails](https://github.com/rails/rails)并点击 fork 按钮将存储库 fork 到您的 github 帐户（假设您已经有一个设置）。然后，使用以下命令将分叉的项目克隆到本地计算机：

```
git clone your_forked_repository_url.git 
```

如果您觉得不需要 fork 自己的版本，请运行：

```
git clone git://github.com/rails/rails.git 
```

在这一点上，你可以对你的内心内容进行修改。要在 rails 应用程序中使用 gem 的本地副本，请将以下内容添加到您的 Gemfile（替换旧的 rails gem）：

```
gem "rails", :path => "/somewhere/your_rails_project" 
```

所有这些以及更多内容都在[http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html中突出显示](http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html)

# c# - 如何从 C# MySQL 查询中提取单个列数据？

> ID：13299825
> 
> 赞同：1
> 
> 时间：2012-11-08T23:38:34.920
> 
> 标签：c#, mysql

如何从我的用户行中提取列数据？EX：当客户端登录时，这会在我的 WCF 服务器上调用。它的工作原理是 var xx = ds.Tables[0].Rows[1]; 它在客户端引发错误。基本上我试图在数据库中验证用户/通行证。然后将订阅到期的日期时间返回给客户。

```
public bool Authenticate(string userId, string password, out string token)
    {
        token = "";

        string MyConnectionString = "Server=localhost;Database=testdb;Uid=root;Pwd=admin;";
        MySqlConnection sqlCon = new MySqlConnection(MyConnectionString);
        sqlCon.Open();

        MySqlCommand cmd = sqlCon.CreateCommand();
        cmd.CommandText = "SELECT * FROM table1 WHERE username = '"+userId+"' AND password = '"+password+"'";
        MySqlDataAdapter adap = new MySqlDataAdapter(cmd);
        DataSet ds = new DataSet();
        adap.Fill(ds);

        if (ds.Tables[0].Rows.Count > 0)
        {
            token = Guid.NewGuid().ToString();
            var xx = ds.Tables[0].Rows[0];

            CustomDataSource.AddUserData(token, userId);

            return true;
        }

        return false;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:46:40.700

好吧，我想您的查询仅返回一行（如果找到具有正确密码的用户）

在这种情况下，您从返回的第一行（索引零）中获取日期。
另外我假设您的日期存储在第五列（索引四）中，如果不是，您应该调整第二个索引以指向正确的列。（基本数组索引始终为零）

```
if (ds.Tables[0].Rows.Count > 0)
{
    token = Guid.NewGuid().ToString();
    var xx = ds.Tables[0].Rows[0][4];
    CustomDataSource.AddUserData(token, userId);
    return true;
} 
```

说了这么多，让我指出这段代码的一个大问题。
这段代码可以很容易地用于[Sql 注入攻击](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)，因为它连接了可能由您的用户键入的字符串，以形成传递给数据库引擎的 Sql 文本。相反，您应该使用参数来避免 Sql 注入问题和引用用户文本（带撇号的密码？）

```
 using(MySqlConnection sqlCon = new MySqlConnection(MyConnectionString))
    {
        sqlCon.Open();
        MySqlCommand cmd = sqlCon.CreateCommand();
        cmd.CommandText = "SELECT * FROM table1 WHERE username = ?user AND password = ?pwd";
        cmd.Parameters.AddWithValue("?user", userId);
        cmd.Parameters.AddWithValue("?pwd", password);
        using(MySqlDataAdapter adap = new MySqlDataAdapter(cmd))
        {
            DataSet ds = new DataSet();
            adap.Fill(ds);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:46:29.073

var xx = ds.Tables[0].Rows[0].ItemArray[5];

是如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:51:14.137

尝试使用`foreach`循环

```
foreach (DataRow row in ds.Tables[0].Rows) 
{
    var xx = row[1];
    var x = row[5];

    // other codes

    return true;
} 
```

另一件事，参数化您的查询以避免`SQL injection`

```
using(MySqlConnection sqlCon = new MySqlConnection(MyConnectionString))
{
    using (MySqlCommand cmd = new MySqlCommand())
    {
        cmd.Connection = sqlCon;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = "SELECT * FROM table1 WHERE username = @user AND password = @pass";
        cmd.Parameters.AddWithValue("@user", userId);
        cmd.Parameters.AddWithValue("@pass", password);
        using (MySqlDataAdapter adap = new MySqlDataAdapter(cmd))
        {
            try
            {
                DataSet ds = new DataSet();
                adap.Fill(ds);
            }
            catch (MySqlException e)
            {
                // do something with the exception
                // don't hide it!
            }
        }
    }
} 
```

# apache - 子域和 URI 的通配符重定向

> ID：13299832
> 
> 赞同：3
> 
> 时间：2012-11-08T23:39:11.613
> 
> 标签：apache, mod-rewrite, apache2, apache2.2

我在 apache 中创建 pernament (301) 重定向时遇到问题：

我有 2 个域：
`olddomain.com`有许多子域
`newdomain.com`

我想做重定向，如：

如果用户输入`http://anysubdomain.olddomain.com`应该被重定向到`http://anysubdomain.newdomain.com`

如果用户输入`http://olddomain.com/something`应该被重定向到`http://newdomain.com/something`

如果用户输入`http://olddomain.com/different/index.html`应该被重定向到`http://newdomain.com/different/index.html`

如果用户输入`http://example.olddomain.com/ex/index.html`应该被重定向到`http://example.newdomain.com/ex/index.html`

我不知道我应该如何设置：

```
<VirtualHost *:80>
  ServerName olddomain.com
</VirtualHost> 
```

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T04:57:35.283

要将您的所有请求从旧域重定向到新域，我将使用以下内容。

```
RewriteCond %{HTTP_HOST} ^(.*\.)?olddomain\.com [NC]
RewriteRule ^(.*)$ http://%1newdomain.com/$1 [R=301,L] 
```

它匹配子域和请求 URI，并将它们与新域合并。如果没有子域，它将继续匹配请求并在没有子域的情况下重定向。

# c++ - 根据 boost::function 定义升压信号？

> ID：13299833
> 
> 赞同：2
> 
> 时间：2012-11-08T23:39:12.190
> 
> 标签：c++, boost

通常，您定义`boost::signals2::signal`如下：

```
typedef boost::signals2::signal<void (int)> MySignalType;
MySignalType mySignal; 
```

然后您可以使用`MySignalType::slot_function_type`来获取与该信号兼容的函数签名。

然而，我正试图做相反的事情。

我有不使用 Boost 信号的现有代码。取而代之的是，代码绕过 a`boost::function`并将其调用回“信号”某个事件。我想`boost::signals2::signal` **根据**现有的`boost::function`. 我尝试了最直观的组合：

```
typedef boost::function<void (int)> MyFunctionType;
typedef boost::signals2::signal<MyFunctionType> MySignalType; 
```

但这被编译器拒绝了。如果这不可能，我会感到惊讶，因为两者都是 Boost 包。我最好的猜测是一个`boost::function`对象（或 typedef）有自己的内部 typedef，其目的类似于在需要纯函数签名的情况下可用，但我在[boost::function 文档](http://www.boost.org/doc/libs/1_52_0/doc/html/function.html)`slot_function_type`中没有找到类似的东西。

我尝试搜索类似的问答，以及浏览 Boost 文档，但没有发现有人在做同样的事情。

有没有办法根据现有的 Boost 函数来定义 Boost 信号？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T23:57:26.403

如果你想从 boost::function 中提取签名，那么你可以尝试这样的事情：

```
#include <boost/signals2.hpp>
#include <boost/function.hpp>
#include <iostream>
#include <ostream>

using namespace boost;
using namespace std;

template<typename T>
struct get_arg;

template<template<typename> class Func,typename Sig>
struct get_arg< Func<Sig> >
{
    typedef Sig type;
};

int main()
{
    typedef boost::function<void()> F;
    signals2::signal< get_arg<F>::type > signal;
} 
```

* * *

编辑：

> 很有意思。你能指点我一个地方来解释你的代码是做什么的以及你是如何想出它的吗？

get_arg 是类模板，它从其参数中提取模板参数（来自 get_arg 的模板参数）。

换句话说，它是[元函数](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Metafunction)——它实际上是对类型进行操作的函数（而普通函数对值进行操作）。

```
template<template<typename> class Func,typename Sig>
struct get_arg< Func<Sig> > 
```

此语法是get_arg 类模板的[部分特化](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Fpartial_specialization.htm)

```
template<typename> class Func 
```

此语法是[模板模板参数](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8l.doc%2Flanguage%2Fref%2Ftemplate_template_arguments.htm)。

```
typedef Sig type; 
```

按照惯例，元函数的结果是嵌套的“类型”成员。

用法是：

```
get_arg< SomeClassTemplate<SomeType> >::type 
```

导致**SomeType**

有关更多信息，请查看以下书籍：

1.  现代 C++ 设计：应用通用编程和设计模式。安德烈亚历山德雷斯库
2.  C++ 模板元编程：Boost 及其他领域的概念、工具和技术。大卫·亚伯拉罕斯和阿列克谢·古尔托沃伊

# c# - Windows Store Apps / Windows Phone 8，MonoGame 替代品？

> ID：13299840
> 
> 赞同：-1
> 
> 时间：2012-11-08T23:39:44.347
> 
> 标签：c#, windows-8, game-engine, windows-store-apps, windows-phone-8

我目前正在分析不同的游戏引擎以在 Windows Store Apps 和 Windows Phone 上与 C# 一起使用。

并不是说我反对 MonoGame（过去我曾与 XNA 合作过很多次），但我总是喜欢有多个选择。

什么是 MonoGame/SharpDX 开发游戏的最佳免费/付费替代品，使用 C#，针对 Windows 应用商店应用程序和 Windows Phone 8？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:24:03.807

不要害怕重新考虑 Monogame。它是开源的，所以你可以用它做任何你想做的事情。我能够移植我的两款游戏，Cloud Blaster 和 Cyber​​ Attack，只需要极少的代码更改。其中大部分只是菜单界面和键盘控制。使用 Monogame 就像使用 XNA 一样。

除了已经提到的那些，虚幻引擎 3 要么将支持商店，要么已经支持。NVidia 几个月前对其进行了演示，因此它可能值得研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:47:02.003

适用于 Windows 8 的 Unity 3D 即将推出，因此您可能需要等待。

[Cocos2D](http://cocos2d-x.org/news/54)、[Scirra 的 Construct2](http://www.scirra.com/tutorials/272/how-to-make-a-windows-8-metro-app/page-1)、[Havok](http://havok.com/news-and-press/releases/havok-showcase-full-technology-suite-windows-8-windows-rt-and-windows-phone)、[Marmalade](http://www.madewithmarmalade.com/windows8/)和 Ogre 也将进入 Windows 8/Windows Phone 8。

# oracle - 带有 RTRIM 问题的 XMLAGG

> ID：13299843
> 
> 赞同：8
> 
> 时间：2012-11-08T23:39:54.500
> 
> 标签：oracle, xquery, xmltable

目前我有以下查询：

```
SELECT 
    CASE 
       WHEN ('[Param.3]' = 'SELECTED')
          THEN (SELECT RTRIM(XMLELEMENT("Rowset", XMLAGG(RW.R ORDER BY RW."ID")), ' ' ) AS Orders
                FROM TMTABLE UL, XMLTABLE('Rowsets/Rowset/Row' PASSING UL.TEXT COLUMNS "ID" NUMBER(19) PATH 'ID', R xmltype path '.') AS RW
                WHERE ID BETWEEN '[Param.1]' and '[Param.2]')
       WHEN ('[Param.3]' = 'ALL' )
          THEN (SELECT RTRIM(XMLELEMENT("Rowset", XMLAGG(RW.R ORDER BY RW."ID")) , ' ' ) AS Orders
                FROM TMTABLE UL, XMLTABLE('Rowsets/Rowset/Row' PASSING UL.TEXT COLUMNS "ID" NUMBER(19) PATH 'ID', R xmltype path '.') AS RW)
    END AS Orders
FROM 
    dual 
```

如果使用 XML AGG 将少量 XML 行合并为单行，则此查询工作正常。但如果要合并的 XML 行数较高，则此查询将引发以下错误：

> ORA-19011: 字符串缓冲区太小

我需要进行哪些更改才能完成这项工作？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-09T05:34:17.100

您需要`.getClobVal()`在 RTRIM 之前添加到您的 XMLType 结果。

XMLAGG 可以很好地处理大量数据。并且 TRIM 可以很好地与 CLOB 配合使用。但是当您将它们放在一起时，Oracle 会尝试将 XMLType 转换为 VARCHAR2 而不是 CLOB。

例子：

```
create or replace function test_function return clob is
    v_clob clob;
begin
    v_clob := v_clob || lpad('a', 4000, 'a');
    v_clob := v_clob || lpad('b', 4000, 'b');
    return v_clob;
end;
/

--Works fine, returns an XMLType
select xmlagg(xmlelement("asdf", test_function)) from dual;

--Works fine, returns a CLOB
select trim(test_function) from dual;

--ORA-19011: Character string buffer too small
select trim(xmlagg(xmlelement("asdf", test_function))) from dual;

--Works
select trim(xmlagg(xmlelement("asdf", test_function)).getClobVal()) from dual; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-13T10:01:23.893

您需要添加`getClobVal()`并且还需要添加，`rtrim()`因为它将在结果末尾返回分隔符。

```
SELECT RTRIM(XMLAGG(XMLELEMENT(E,colname,',').EXTRACT('//text()') ORDER BY colname).GetClobVal(),',')
  FROM tablename; 
```

# php - PHP：根据unixtime的匹配子字符串对数组进行重复数据删除

> ID：13299848
> 
> 赞同：-2
> 
> 时间：2012-11-08T23:40:08.773
> 
> 标签：php, arrays, file-io

我有一个包含 IP 地址和 unix TS 的文件列表。我需要获得一个去重的文件列表，但只有该主机的最新文件（这需要基于文件名中的 unix ts，而不是文件的实际 ts）。

样本数据：

```
192.168.1.6_1352405854.xml  192.168.1.6_1352408700.xml  192.168.1.6_1352409088.xml   192.168.189.14_1352409088.xml
192.168.1.6_1352407188.xml  192.168.1.6_1352408715.xml  192.168.1.6_1352409520.xml   192.168.189.14_1352409520.xml
192.168.1.6_1352407248.xml  192.168.1.6_1352408796.xml  192.168.1.6_1352409601.xml   192.168.189.14_1352409601.xml
192.168.1.6_1352407311.xml  192.168.1.6_1352408830.xml  192.168.1.6_1352412001.xml   192.168.189.14_1352412001.xml
192.168.1.6_1352407329.xml  192.168.1.6_1352408907.xml  192.168.1.6_1352415602.xml   192.168.189.14_1352415602.xml
192.168.1.6_1352408608.xml  192.168.1.6_1352409018.xml  192.168.189.14_1352409018.xml 
```

所以预期的结果将是一个文件名数组，仅列出来自每个 IP 的最新文件。

就像是：

192.168.1.6_1352415602.xml

192.168.1.14_1352415602.xml

在我的代码中，我必须遍历目录结构并提取文件名和目录。

目录将是构成左侧菜单的站点名称。

这些文件将作为超链接主机名位于这些菜单项下（但我只需要来自每个主机的最新文件信息）

```
// Get directory list and (natural) sort it alphabetically (ignoring case)
        $glob = "xml/vpnm/*";
        $dirs = glob($glob,GLOB_ONLYDIR);
        foreach ($dirs as $d){
            $tmp[basename($d)] = basename($d);
        }
        natcasesort($tmp);
        $dirs = array_keys($tmp);
        foreach($dirs as $dir){
            $dir = basename($dir);
            $sitename = preg_replace('/_/', ' ', $dir);
            echo "<h3><a href='#'>$sitename</a></h3>";
            echo '<div>';
                // Get list of hosts in the xml/ directory based on the file name
                $year = date("Y");
                $month = date("m");
                $basepath = "xml/vpnm/$dir/$year/$month";
// note - preg_find is an include file, not a php function
 $files = preg_find('/\.xml$/D', "xml/vpnm/$dir", PREG_FIND_RECURSIVE);
                foreach ($files as $f){
                    // echo " F= $f \n";
                    $tmp[basename($f)] = basename($f);
                }
                natcasesort($tmp);
                $files = array_keys($tmp);
                natsort($files);
// do something here to deduplicate and only include the latest files.
foreach($files as $file) {
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:19:41.303

```
$dirlist = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir));
$results = array();
foreach($dirlist as $file){
    if($file->getExtension() !='xml') continue;
    $parts = explode('_',$file->getBasename());
    if(isset($results[$parts[0]])){
        if($file->getBasename() > $results[$parts[0]]->getBasename()){
            $results[$parts[0]] = $file;
        }
    } else {
        $results[$parts[0]] = $file;
    }
} 
```

# java - 杀死除家之外的所有活动

> ID：13299855
> 
> 赞同：0
> 
> 时间：2012-11-08T23:40:45.323
> 
> 标签：java, android, android-activity

我在 Android 应用程序上有以下一系列活动：

```
A -> B -> C 
```

`Intent.FLAG_ACTIVITY_CLEAR_TOP`在 C 上，我可以使用带有和`Intent.FLAG_ACTIVITY_SINGLE_TOP`意图标志的 startActivity 回家（“A”） 。这清除了活动 B 和 C 的堆栈，所以它只是 A。到目前为止还不错；这相当于我的“家”。

*但是，我还有另一个部分 - “E” - 我希望它清除除*home（“A”）之外的整个堆栈。如：

```
Activity stack: A -> B -> C
(User clicks on "E" button)
Activity stack result: A -> E 
```

我`Intent.FLAG_ACTIVITY_NEW_TASK`在打开小节（“B”、“E”等）时尝试过使用，但似乎无法清除之前的任务。我也试过`Intent.FLAG_ACTIVITY_TASK_ON_HOME`，但它似乎没有做任何事情（你怎么设置什么是“家”呢？）。

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T02:09:53.637

一个不太复杂的解决方案是在`Intent`您传递给`Activity`A 的“透明顶部”中添加一个额外的内容。根据该信息，您可以在`Activity`A 收到新的`Intent`.

例如。您可以设置一系列“命令”，您在收到 A 时识别这些“命令”，`Intent`然后`Activity`根据这些“命令”做某事；即开始`Activity`E。

或者，由于 and`Intent`是可打包的，您可以将以E`Intent`开头`Activity`的作为额外内容附加到`Intent`您发送给`Activity`A 的“透明顶部”。您可以简单地检查是否存在“转发意图”并调用，而不是识别命令`startActivity(forwardedIntent)`。

在所有这些情况下，清除顶部标志将导致 B 和 C 被弹出，留下 A。`Activity`然后 A 将负责启动 E。流程应该足够快，不会导致任何视觉闪烁，例如从A 在E`Activity`之前短暂显示`Activity`接手。

我不确定你所追求的行为是否对用户有意义，但我会留给你。

# objective-c - 数组通过自己的方法后丢失所有值-Objective C

> ID：13299857
> 
> 赞同：0
> 
> 时间：2012-11-08T23:41:02.763
> 
> 标签：objective-c, ios, arrays, cocoa-touch, nsmutablearray

我在下面有这段代码，我正在尝试将对象（字符串元素）添加到数组中，问题是每次我使用它的添加方法时，它都会变为 nil，它不会保留对象。

我知道我做错了，即使我已经尝试了很多组合和变化，即使使用我自己的构造函数 _MyArray 等，同样的结果......它有效，但没有进一步......

请问你能帮帮我吗？

```
@interface ArraysModel()
@property (nonatomic, retain) NSMutableArray *MyArray;
@end

@implementation ArraysModel
@synthesize MyArray;

-(void)AddObjectToTheList:(NSString *)object {

    if(!MyArray) MyArray = [[NSMutableArray alloc] init];
    [MyArray addObject:object];
    NSLog(@"%@",self.MyArray);
    NSLog(@"Object added %u",[self.MyArray count]);
}
-(NSMutableArray *)ObjectList {

    return self.MyArray;
    NSLog(@"%@",self.MyArray);
    NSLog(@"Object added %u",[self.MyArray count]);
}

@end 
```

标题是这样的：

```
@interface ArraysModel : NSObject

-(void)AddObjectToTheList:(NSString *)object; 
```

这是我从 ViewController 打来的电话：

```
- (IBAction)AddToTheList {

    ArraysModel *MyObjectToAdd = [[ArraysModel alloc] init];
    [MyObjectToAdd AddObjectToTheList:TextArea.text];
    [self.view endEditing:YES]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T02:27:01.710

好吧，这就是你的问题——你正在分配一个新的 ArraysModel 实例，因此每次调用都会创建一个新数组。您需要为您的实例创建一个强引用，并检查它是否存在，如果不存在则仅初始化。

在.h中：

```
@property (strong, nonatomic) ArraysModel *myObjectToAdd; 
```

在他们中：

```
-(IBAction)AddToTheList {
    if (! self.myObjectToAdd) { 
        self.myObjectToAdd = [[ArraysModel alloc] init];
    } 
   [self.myObjectToAdd AddObjectToTheList:TextArea.text]; 
   [self.view endEditing:YES]
} 
```

# python - 在 Gtk ScrolledWindow 中滚动时我应该捕捉哪些信号？

> ID：13299858
> 
> 赞同：4
> 
> 时间：2012-11-08T23:41:07.163
> 
> 标签：python, gtk, pygobject, gio

我正在为 Rhythmbox 开发一个 python 插件——它包含一个 GtkScrolledWindow 和一个子 GtkIconView。IconView 由 Gtk.TreeModel 提供。

它看起来像这样：

![在此处输入图像描述](../Images/6e224f0a465f14e14efcf12de20f39b8.png)

目前 - 并且有点低效，为树模型中的每一行绘制每个图标 - 每个图标都是来自文件的 GdkPixbuf。如果您有数千行，则整个图标视图可能需要很长时间才能完全更新每个图片图标。

我想要实现的是只更新当前绘图区域中的图标 - 当用户滚动并释放滚动条（或通过键盘导航）时，新绘图区域中的图标应该使用相关图片进行更新。

注意——此时树模型将被完全填充——只有图标不会被加载。

这不是我真正的专业领域 - 我正在寻找我应该用来实现上述目标的最佳方法的指针。

具体来说 - 可以公开哪个 Gtk+3 绘图区域信号（或多个信号）（Gtk.ScrolledWindow / Gtk.IconView ？）编写 python 代码来计算应该更新哪些图标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T10:24:37.677

您应该分析您的应用程序以查看需要时间的内容。

那是加载图像吗？如果是这样，那么加载默认图像并将其添加到视图中的任何位置都足够快，因为您只会加载一个图像。然后，您将根据应出现在视口中的图像，使用[idle_add](http://developer.gnome.org/pygobject/stable/glib-functions.html#function-glib--idle-add)按需加载和更新图像。

如果需要时间将图像添加到模型中，那么您需要通过在 idle_add 回调中检查视口上可见的内容来按需添加。

如果两者都很慢，您需要混合使用两种解决方案：按需加载和添加。

还要考虑一下代理设计模式，它可以用于创建将在后台加载的假封面对象，并包含加载策略。

对于信号，您的 GtkIconView 小部件实现[了 GtkScrollable](http://developer.gnome.org/gtk3/stable/GtkScrollable.html)，它解释了如何[实现滚动](http://developer.gnome.org/gtk3/stable/GtkScrollable.html#GtkScrollable.description)。您可以设置[垂直调整并通过连接到其](http://developer.gnome.org/gtk3/stable/GtkScrollable.html#GtkScrollable--vadjustment)[值更改](http://developer.gnome.org/gtk3/stable/GtkAdjustment.html#GtkAdjustment-value-changed)信号来检查它何时发生变化。这意味着用户向上或向下滚动，您需要使用[timeout_add](http://developer.gnome.org/pygobject/stable/glib-functions.html#function-glib--timeout-add)启动计时器。如果在短暂的超时（我认为在 0.5 到 1 秒之间，但需要测试）之后，调整没有改变，这意味着用户停止滚动，您可以更新显示的内容。否则，它将在滚动*期间*更新，从而减慢一切。然后你只需要弄清楚如何找到哪些项目出现在视口中，以更新它们的封面。

虽然我以前从未这样做过，但我对 GTK 有点了解，只是想弄清楚它是如何完成的，所以请谨慎阅读。无论如何，反应性的答案是“按需”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:02:41.020

但另一方面，如果您必须完全向下滚动，则必须等待构建每个页面。所以我想你应该更好地考虑[`idle_add`](http://developer.gnome.org/pygobject/stable/glib-functions.html#function-glib--idle-add)事件循环的功能。

这样您的屏幕就不会锁定，您的电脑也不必等待用户加载页面的视图页面。为您和您的应用程序双赢。;-)

# xml - 使用 xslt 向使用 xml 创建的 excel 文件添加样式

> ID：13299862
> 
> 赞同：3
> 
> 时间：2012-11-08T23:41:41.920
> 
> 标签：xml, xslt, spreadsheet, xslt-1.0

我需要缩进特定单元格中的文本。特定单元格是具有子元素的 xml 元素。

我的 XML 是：

```
<rows>

<row id="FOLDER1">
    <cell image="blank.gif">Folder 1</cell>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell sum="1">$23</cell>
    <row id="FOLDER2">
        <cell image="blank.gif">Folder 2</cell>
        <cell/>
        <cell/>
        <cell/>
        <cell/>
        <cell/>
        <cell/>
        <cell sum="2">$11</cell>
        <row id="FOLDER3">
            <cell image="blank.gif">Folder 3</cell>
            <cell/>
            <cell/>
            <cell/>
            <cell/>
            <cell/>
            <cell/>
            <cell sum="3">$44</cell>
            <row id="pro1">
                <cell image="blank.gif">Product 1</cell>
                <cell>324234</cell>
                <cell>3.00</cell>
                <cell>Kilo</cell>
                <cell>1.00</cell>
                <cell>No</cell>
                <cell>euro 33.33</cell>
                <cell>euro 33.33</cell>
            </row>
            <row id="pro2">
                <cell image="blank.gif">Product 2</cell>
                <cell>4354354</cell>
                <cell>1.00</cell>
                <cell>Kilo</cell>
                <cell >0.50</cell>
                <cell>No</cell>
                <cell>euro 2.53</cell>
                <cell>euro 1.26</cell>
            </row>

        </row>
        <row id="pro3">
            <cell image="blank.gif">Product 3</cell>
            <cell>435436</cell>
            <cell>10.00</cell>
            <cell>Kilo</cell>
            <cell>Yes</cell>
            <cell>euro 0.36</cell>
            <cell>euro 3.60</cell>
        </row>

        <row id="pro4">
            <cell image="blank.gif">Product 4</cell>
            <cell>435435</cell>
            <cell>3.28</cell>
            <cell>Kilo</cell>
            <cell>1.00</cell>
            <cell>No</cell>
            <cell>euro 17.38</cell>
            <cell>euro 17.38</cell>
        </row>
    </row>
</row>
<row id="FOLDER1">
    <cell image="blank.gif">Folder 4</cell>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell/>
    <cell sum="1">$23</cell>
</row> 
```

我的 XSLT 是：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<?mso-application progid="Excel.Sheet"?>
<xsl:stylesheet version="1.0"
    xmlns:html="http://www.w3.org/TR/REC-html40"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">

  <xsl:param name="header1">Header1</xsl:param>
  <xsl:param name="header2">Header2</xsl:param>
  <xsl:param name="header3">Header3</xsl:param>
  <xsl:param name="header4">Header4</xsl:param>
  <xsl:param name="header5">Header5</xsl:param>
  <xsl:param name="header6">Header6</xsl:param>
  <xsl:param name="header7">Header7</xsl:param>
  <xsl:param name="header8">Header8</xsl:param>

  <xsl:template match="rows">

    <Workbook>
      <Styles>
        <Style ss:ID="Default" ss:Name="Normal">
          <Alignment ss:Vertical="Bottom" />
          <Borders />
          <Font />
          <Interior />
          <NumberFormat />
          <Protection />
        </Style>
        <Style ss:ID="s21">
          <Font ss:Size="22" ss:Bold="1" />
        </Style>
        <Style ss:ID="columnheaders">
          <Font ss:Size="12" ss:Bold="1" />
        </Style>
        <Style ss:ID="s22">
          <Font ss:Size="14" ss:Bold="1" />
        </Style>
        <Style ss:ID="s23">
          <Font ss:Size="10"  />
        </Style>
        <Style ss:ID="s24">
          <Font ss:Size="10" ss:Bold="1" />
        </Style>
      </Styles>

      <Worksheet ss:Name="data">
        <Table>
          <Column ss:AutoFitWidth="0" ss:Width="300" />
          <Column ss:AutoFitWidth="0" ss:Width="95" />
          <Column ss:AutoFitWidth="0" ss:Width="95" />
          <Column ss:AutoFitWidth="0" ss:Width="175" />
          <Column ss:AutoFitWidth="0" ss:Width="186" />
          <Column ss:AutoFitWidth="0" ss:Width="185" />
          <Column ss:AutoFitWidth="0" ss:Width="113" />
          <Column ss:AutoFitWidth="0" ss:Width="133" />

          <Row ss:AutoFitHeight="0" ss:Height="18">
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header1"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header2"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header3"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header4"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header5"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header6"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header7"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header8"/>
              </Data>
            </Cell>
          </Row>

          <xsl:apply-templates select="row"/>

        </Table>
      </Worksheet>

    </Workbook>

  </xsl:template>

  <xsl:template match="row">
    <xsl:variable name="rowID">
      <xsl:number level="any" format="1"/>
    </xsl:variable>
    <Row ss:AutoFitHeight="0" ss:Height="18">
      <xsl:for-each select="cell">
        <xsl:variable name="colID">
          <xsl:number value="position()" format="A"/>
        </xsl:variable>
        <Cell ss:StyleID="s23">
          <Data ss:Type="String">
            <xsl:value-of select="translate(.,'?','&#8364;')"/>
          </Data>
        </Cell>
      </xsl:for-each>
    </Row>

    <xsl:apply-templates select="row"/>
  </xsl:template>

</xsl:stylesheet> 
```

我从转换中生成的输出：

```
 <?xml version="1.0" encoding="UTF-8"?>
<Workbook xmlns:o="urn:schemas-microsoft-com:office:office" xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:html="http://www.w3.org/TR/REC-html40" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
    <Styles>
        <Style ss:ID="Default" ss:Name="Normal">
            <Alignment ss:Vertical="Bottom"/>
            <Borders/>
            <Font/>
            <Interior/>
            <NumberFormat/>
            <Protection/>
        </Style>
        <Style ss:ID="s21">
            <Font ss:Size="22" ss:Bold="1"/>
        </Style>
        <Style ss:ID="columnheaders">
            <Font ss:Size="12" ss:Bold="1"/>
        </Style>
        <Style ss:ID="s22">
            <Font ss:Size="14" ss:Bold="1"/>
        </Style>
        <Style ss:ID="s23">
            <Font ss:Size="10"/>
        </Style>
        <Style ss:ID="s24">
            <Font ss:Size="10" ss:Bold="1"/>
        </Style>
    </Styles>
    <Worksheet ss:Name="data">
        <Table>
            <Column ss:AutoFitWidth="0" ss:Width="300"/>
            <Column ss:AutoFitWidth="0" ss:Width="95"/>
            <Column ss:AutoFitWidth="0" ss:Width="95"/>
            <Column ss:AutoFitWidth="0" ss:Width="175"/>
            <Column ss:AutoFitWidth="0" ss:Width="186"/>
            <Column ss:AutoFitWidth="0" ss:Width="185"/>
            <Column ss:AutoFitWidth="0" ss:Width="113"/>
            <Column ss:AutoFitWidth="0" ss:Width="133"/>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header1</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header2</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header3</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header4</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header5</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header6</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header7</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header8</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Folder 1</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$23</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Folder 2</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$11</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Folder 3</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$44</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Product 1</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">324234</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">3.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 33.33</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 33.33</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Product 2</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">4354354</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">0.50</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 2.53</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 1.26</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Product 3</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">435436</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">10.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Yes</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 0.36</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 3.60</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Product 4</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">435435</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">3.28</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 17.38</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 17.38</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Folder 4</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$23</Data>
                </Cell>
            </Row>
        </Table>
    </Worksheet>
</Workbook> 
```

在 excel 中打开时的外观如下： ![截屏](../Images/0960fe09a939f1e5a57d75ecc4a5caa0.png)

我需要递归地缩进单元格，并检查行是否有孩子，如果他们有的话，我需要将它们设为斜体，如果不只是让它们不被编辑。它的外观示例：

```
*Folder1*
   *Folder2*
       *Folder3*
          Product1
          Product2
   Product3
   Product4
 Folder4 
```

这是我应该得到的xml：

```
 <?xml version="1.0" encoding="UTF-8"?>
<Workbook xmlns:o="urn:schemas-microsoft-com:office:office" xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:html="http://www.w3.org/TR/REC-html40" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
    <Styles>
        <Style ss:ID="Default" ss:Name="Normal">
            <Alignment ss:Vertical="Bottom"/>
            <Borders/>
            <Font/>
            <Interior/>
            <NumberFormat/>
            <Protection/>
        </Style>
        <Style ss:ID="s21">
            <Font ss:Size="22" ss:Bold="1"/>
        </Style>
        <Style ss:ID="columnheaders">
            <Font ss:Size="12" ss:Bold="1"/>
        </Style>
        <Style ss:ID="s22">
            <Font ss:Size="14" ss:Bold="1"/>
        </Style>
        <Style ss:ID="s23">
            <Font ss:Size="10"/>
        </Style>
        <Style ss:ID="s24">
            <Font ss:Size="10" ss:Bold="1"/>
        </Style>
        <Style ss:ID="parent1">
            <Font ss:Size="10" ss:Italic="1"/>
        </Style>
        <Style ss:ID="parent2">
            <Alignment ss:Indent="1"/>
            <Font ss:Size="10" ss:Italic="1"/>
        </Style>
        <Style ss:ID="parent3">
            <Alignment ss:Indent="2"/>
            <Font ss:Size="10" ss:Italic="1"/>
        </Style>
        <Style ss:ID="children3">
            <Alignment ss:Indent="3"/>
            <Font ss:Size="10"/>
        </Style>
        <Style ss:ID="children2">
            <Alignment ss:Indent="2"/>
            <Font ss:Size="10"/>
        </Style>
    </Styles>
    <Worksheet ss:Name="data">
        <Table>
            <Column ss:AutoFitWidth="0" ss:Width="300"/>
            <Column ss:AutoFitWidth="0" ss:Width="95"/>
            <Column ss:AutoFitWidth="0" ss:Width="95"/>
            <Column ss:AutoFitWidth="0" ss:Width="175"/>
            <Column ss:AutoFitWidth="0" ss:Width="186"/>
            <Column ss:AutoFitWidth="0" ss:Width="185"/>
            <Column ss:AutoFitWidth="0" ss:Width="113"/>
            <Column ss:AutoFitWidth="0" ss:Width="133"/>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header1</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header2</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header3</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header4</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header5</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header6</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header7</Data>
                </Cell>
                <Cell ss:StyleID="columnheaders">
                    <Data ss:Type="String">Header8</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="parent1">
                    <Data ss:Type="String">Folder 1</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$23</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="parent2">
                    <Data ss:Type="String">Folder 2</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$11</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="parent3">
                    <Data ss:Type="String">Folder 3</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$44</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="children3">
                    <Data ss:Type="String">Product 1</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">324234</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">3.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 33.33</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 33.33</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="children3">
                    <Data ss:Type="String">Product 2</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">4354354</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">0.50</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 2.53</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 1.26</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="children2">
                    <Data ss:Type="String">Product 3</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">435436</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">10.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Yes</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 0.36</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 3.60</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="children2">
                    <Data ss:Type="String">Product 4</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">435435</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">3.28</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Kilo</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">1.00</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">No</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 17.38</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">euro 17.38</Data>
                </Cell>
            </Row>
            <Row ss:AutoFitHeight="0" ss:Height="18">
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">Folder 4</Data>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String"/>
                </Cell>
                <Cell ss:StyleID="s23">
                    <Data ss:Type="String">$23</Data>
                </Cell>
            </Row>
        </Table>
    </Worksheet>
</Workbook> 
```

使用 xml 的屏幕截图我应该得到： ![在此处输入图像描述](../Images/0c088dccc154650ccb67b25e480daec3.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T10:23:45.303

对于缩进，我将首先添加一个新参数来保存每个级别所需的缩进大小。在这种情况下，我使用了四个空格。

```
<xsl:param name="indentAmount" select="'    '" /> 
```

**然后，在与行**元素匹配的模板中，您可以有一个参数来存储要使用的当前标识的大小，该参数最初默认为空字符串（即没有缩进）。

```
<xsl:template match="row">
   <xsl:param name="indentation" select="''" /> 
```

当您递归调用您的行模板时，您只需将参数化缩进量添加到当前缩进中，以增加它

```
<xsl:apply-templates select="row">
  <xsl:with-param name="indentation" select="concat($indentAmount, $indentation)" />
</xsl:apply-templates> 
```

然后，它只是输出第一个单元格的缩进参数的情况

```
<Data ss:Type="String">
   <xsl:if test="$colID = 'A'">
      <xsl:value-of select="$indentation" />
   </xsl:if>
  <xsl:value-of select="translate(.,'?','&#8364;')"/>
</Data> 
```

对于斜体，您可以简单地定义一个新样式

```
 <Style ss:ID="s23i">
   <Font ss:Size="10" ss:Italic="1" />
 </Style> 
```

然后，您可以根据它是否有一个**行**元素作为子元素来设置单元格的样式属性

```
<Cell>
   <xsl:attribute name="ss:StyleID">
      <xsl:choose>
         <xsl:when test="$colID = 'A' and ../row">s23i</xsl:when>
         <xsl:otherwise>s23</xsl:otherwise>
      </xsl:choose>
   </xsl:attribute> 
```

作为一个附带问题，您`<?mso-application progid="Excel.Sheet"?>`的 XSLT 中有处理指令。这不是它的正确位置，因为它需要出现在您的输出 XML 中，而且目前不会发生。要输出此流程指令，您需要执行此操作

```
 <xsl:processing-instruction name="mso-application">
     <xsl:text>progid="Excel.Sheet"</xsl:text>
  </xsl:processing-instruction> 
```

那么这里就是完整的 XSLT 了。

```
<xsl:stylesheet version="1.0"
    xmlns:html="http://www.w3.org/TR/REC-html40"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">

   <xsl:output method="xml" indent="yes" />
  <xsl:param name="header1">Header1</xsl:param>
  <xsl:param name="header2">Header2</xsl:param>
  <xsl:param name="header3">Header3</xsl:param>
  <xsl:param name="header4">Header4</xsl:param>
  <xsl:param name="header5">Header5</xsl:param>
  <xsl:param name="header6">Header6</xsl:param>
  <xsl:param name="header7">Header7</xsl:param>
  <xsl:param name="header8">Header8</xsl:param>
  <xsl:param name="indentAmount" select="'    '" />

  <xsl:template match="rows">
      <xsl:processing-instruction name="mso-application">
         <xsl:text>progid="Excel.Sheet"</xsl:text>
      </xsl:processing-instruction>
    <Workbook>
      <Styles>
        <Style ss:ID="Default" ss:Name="Normal">
          <Alignment ss:Vertical="Bottom" />
          <Borders />
          <Font />
          <Interior />
          <NumberFormat />
          <Protection />
        </Style>
        <Style ss:ID="s21">
          <Font ss:Size="22" ss:Bold="1" />
        </Style>
        <Style ss:ID="columnheaders">
          <Font ss:Size="12" ss:Bold="1" />
        </Style>
        <Style ss:ID="s22">
          <Font ss:Size="14" ss:Bold="1" />
        </Style>
        <Style ss:ID="s23">
          <Font ss:Size="10"  />
        </Style>
        <Style ss:ID="s23i">
          <Font ss:Size="10" ss:Italic="1" />
        </Style>
        <Style ss:ID="s24">
          <Font ss:Size="10" ss:Bold="1" />
        </Style>
      </Styles>

      <Worksheet ss:Name="data">
        <Table>
          <Column ss:AutoFitWidth="0" ss:Width="300" />
          <Column ss:AutoFitWidth="0" ss:Width="95" />
          <Column ss:AutoFitWidth="0" ss:Width="95" />
          <Column ss:AutoFitWidth="0" ss:Width="175" />
          <Column ss:AutoFitWidth="0" ss:Width="186" />
          <Column ss:AutoFitWidth="0" ss:Width="185" />
          <Column ss:AutoFitWidth="0" ss:Width="113" />
          <Column ss:AutoFitWidth="0" ss:Width="133" />
          <Row ss:AutoFitHeight="0" ss:Height="18">
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header1"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header2"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header3"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header4"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header5"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header6"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header7"/>
              </Data>
            </Cell>
            <Cell ss:StyleID="columnheaders">
              <Data ss:Type="String">
                <xsl:value-of select="$header8"/>
              </Data>
            </Cell>
          </Row>
          <xsl:apply-templates select="row"/>
        </Table>
      </Worksheet>
    </Workbook>
  </xsl:template>

  <xsl:template match="row">
    <xsl:param name="indentation" select="''" />
    <xsl:variable name="rowID">
      <xsl:number level="any" format="1"/>
    </xsl:variable>
    <Row ss:AutoFitHeight="0" ss:Height="18">
      <xsl:for-each select="cell">
        <xsl:variable name="colID">
          <xsl:number value="position()" format="A"/>
        </xsl:variable>
        <Cell>
           <xsl:attribute name="ss:StyleID">
              <xsl:choose>
                 <xsl:when test="$colID = 'A' and ../row">s23i</xsl:when>
                 <xsl:otherwise>s23</xsl:otherwise>
              </xsl:choose>
           </xsl:attribute>
          <Data ss:Type="String">
             <xsl:if test="$colID = 'A'">
                <xsl:value-of select="$indentation" />
             </xsl:if>
            <xsl:value-of select="translate(.,'?','&#8364;')"/>
          </Data>
        </Cell>
      </xsl:for-each>
    </Row>

    <xsl:apply-templates select="row">
       <xsl:with-param name="indentation" select="concat($indentAmount, $indentation)" />
    </xsl:apply-templates>
  </xsl:template>
</xsl:stylesheet> 
```

# java - CSS3 来设置 Java 样式？

> ID：13299864
> 
> 赞同：2
> 
> 时间：2012-11-08T23:42:03.543
> 
> 标签：java, html, swing, css, javafx-2

我即将开始一个 Java 项目，我实际上是在制作一个简单的 iTunes 克隆。我将使用 Swing 来制作 GUI，但我想知道以类似于 iTunes 的方式对其进行样式设置的最佳方式，而不仅仅是更改颜色/字体/边框。我已经研究过将 CSS 与 Java Swing 一起使用，但我发现的任何资源都已过时。有什么新方法可以解决这个问题吗？还是我应该研究 CSS 以外的东西？

这是我希望通过 Swing 实现的设计（至少是基础）： ![在此处输入图像描述](../Images/00988a80953a221e6cafc05f585734d4.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T00:02:50.570

Swing 没有 CSS 样式。但是，如果您使用 JavaFx2，它是 Swing 的继承者，您确实可以使用 CSS 样式。

如果您对 Swing 还不是很熟悉，我建议您考虑 JavaFX。最新的 1.7 版本的 Java 内置了 JavaFX 2.2。它支持 CSS 和[媒体播放器](http://docs.oracle.com/javafx/2/api/javafx/scene/media/MediaPlayer.html)

当然也可以在 Swing 中进行。您可以使用许多不同的方法，但为了给您一个起点，这里是我将如何创建按钮。这种方法需要 Java 7，但如果您改用 JXLayer，您也可以在以前的 Java 版本中运行它。这些按钮是 2D 绘画和​​我可以访问的一些图标的组合。只需使用您拥有的图标进行更改即可。圆圈的大小会自行调整大小，具体取决于您使用的图像。

当您单击按钮时，您将在此处发出哔声，并将相应的文本打印到控制台。一般来说，JLayer 对 Swing 应用程序的样式非常有用。

![媒体播放器示例](../Images/33a9a05b119212b86234f309c9848487.png)

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.geom.Ellipse2D;
import java.awt.geom.Rectangle2D;
import java.net.URL;
import java.util.logging.Logger;

import javax.swing.*;
import javax.swing.plaf.LayerUI;

/**
 */
public class MediaPlayer {

    public static void main(String[] args) {

        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame frame = new JFrame("Media Clone");
                MediaController mediaController = new MediaController();
                frame.getContentPane().add(new MediaView(mediaController));
                frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
                frame.setMinimumSize(new Dimension(800, 450));
                frame.setLocationRelativeTo(null); // Center
                frame.pack();
                frame.setVisible(true);
            }
        });
    }

    static class MediaView extends JPanel {

        private MediaList mediaList;
        private ButtonView buttonView;
        private MediaController controller;

        MediaView(MediaController controller) {
            this.controller = controller;
            createComponents();
            makeLayout();
        }

        public void createComponents() {
            mediaList = new MediaList();
            buttonView = new ButtonView(controller);
        }

        public void makeLayout() {
            setLayout(new BorderLayout());
            add(mediaList);
            add(new JLayer<>(buttonView, new GradientUI()), BorderLayout.NORTH);
        }
    }

    static class MediaList extends JPanel {

        private JTable mediaTable;

        MediaList() {
            createComponents();
            makeLayout();
        }

        public void createComponents() {
            String[] header = new String[]{"Song", "Artist"};
            String[][] model = new String[2][2];
            model[0][0] = "Hello";
            model[0][1] = "World";
            model[1][0] = "Goodbye";
            model[1][1] = "Sunshine";
            mediaTable = new JTable(model, header);
        }

        public void makeLayout() {
            setLayout(new BorderLayout());
            add(new JScrollPane(mediaTable));
        }
    }

    static class GradientUI extends LayerUI<JComponent> {

        @Override
        public void paint(Graphics g, JComponent c) {
            Graphics2D g2 = (Graphics2D) g.create();
            g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
            int height = c.getHeight();
            int width = c.getWidth();
            g2.setPaint(new GradientPaint(0, 0, new Color(136, 146, 155), 0, height, new Color(101, 108, 116)));
            Rectangle2D area = new Rectangle(0, 0, width, height);
            g2.fill(area);
            super.paint(g2, c);
        }
    }

    enum MediaAction {
        PLAY, NEXT, PREVIOUS
    }

    static class MediaController {

        private Toolkit toolkit = Toolkit.getDefaultToolkit();

        public void execute(MediaAction mediaAction) {
            toolkit.beep();
            System.out.println(mediaAction.name());
        }
    }

    static class ButtonView extends JPanel {

        private static Logger log = Logger.getLogger(ButtonView.class.getName());

        private JButton play;
        private JButton next;
        private JButton previous;
        private RoundButtonUI playUI;
        private ActionListener playActionListener;
        private ActionListener nextActionListener;
        private ActionListener previousActionListener;
        private MediaController controller;

        ButtonView(MediaController controller) {
            this.controller = controller;
            createComponents();
            makeLayout();
            createHandlers();
            registerHandlers();
            initComponent();
        }

        public void createComponents() {
            play = new JButton();
            next = new JButton();
            previous = new JButton();
            playUI = new RoundButtonUI();
        }

        public void createHandlers() {
            playActionListener = createMediaAction(MediaAction.PLAY);
            nextActionListener = createMediaAction(MediaAction.NEXT);
            previousActionListener = createMediaAction(MediaAction.PREVIOUS);
        }

        private ActionListener createMediaAction(final MediaAction mediaAction) {
            return new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    SwingUtilities.invokeLater(new Runnable() {
                        @Override
                        public void run() {
                            controller.execute(mediaAction);
                        }
                    });
                }
            };
        }

        public void registerHandlers() {
            play.addActionListener(playActionListener);
            next.addActionListener(nextActionListener);
            previous.addActionListener(previousActionListener);
        }

        public void makeLayout() {
            setLayout(new FlowLayout(FlowLayout.LEADING));
            makeButtonRound(previous, "<<", "bullet_triangle_grey_shadow.png", "bullet_triangle_grey.png");
            makeButtonRound(play, ">", "bullet_triangle_glass_grey128x128.png", "bullet_triangle_glass_grey128x128.png");
            makeButtonRound(next, ">>", "bullet_triangle_grey_shadow.png", "bullet_triangle_grey.png");
            add(new JLayer<>(previous, playUI));
            add(new JLayer<>(play, playUI));
            add(new JLayer<>(next, playUI));
        }

        public void initComponent() {
            setOpaque(false);
        }

        private void makeButtonRound(final JButton toBeRounded, String fallback, String imageNormal, String imagePressed) {
            toBeRounded.setOpaque(false);
            toBeRounded.setFocusPainted(false);
            toBeRounded.setBorderPainted(false);
            toBeRounded.setContentAreaFilled(false);
            toBeRounded.setBorder(BorderFactory.createEmptyBorder(5, 10, 5, 5));
            URL normalURL = getClass().getClassLoader().getResource(imageNormal);
            URL pressedURL = getClass().getClassLoader().getResource(imagePressed);
            if (normalURL != null || pressedURL != null) {
                final ImageIcon released = new ImageIcon(normalURL);
                final ImageIcon pressed = new ImageIcon(pressedURL);
                toBeRounded.setIcon(released);
                toBeRounded.addMouseListener(new MouseAdapter() {
                    @Override
                    public void mousePressed(MouseEvent e) {
                        toBeRounded.setIcon(pressed);
                    }

                    @Override
                    public void mouseReleased(MouseEvent e) {
                        toBeRounded.setIcon(released);
                    }
                });
            } else {
                toBeRounded.setText(fallback);
                log.severe("Missing resources: " + imageNormal + " and " + imagePressed);
            }
        }
    }

    /**
     * Shifts the image so it looks pressed down.
     * Creates a circle around the icon, that varies in size depending on the supplied icon.
     */
    static class RoundButtonUI extends LayerUI<JComponent> {

        private static final int STROKE_WIDTH = 5;

        @Override
        public void paint(Graphics g, JComponent c) {
            Graphics2D g2 = (Graphics2D) g.create();
            g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);

            ButtonModel buttonModel;
            JButton b;

            if (((JLayer) c).getView() instanceof JButton) {
                b = (JButton) ((JLayer) c).getView();
                buttonModel = b.getModel();
            } else {
                super.paint(g, c);
                return;
            }

            int iconHeight = b.getIcon() != null ? b.getIcon().getIconHeight() : 60;
            int iconWidth = b.getIcon() != null ? b.getIcon().getIconWidth() : 60;

            Shape circle = new Ellipse2D.Double(STROKE_WIDTH, STROKE_WIDTH, iconHeight, iconWidth);

            g2.setPaint(new GradientPaint(5, 5, new Color(222, 224, 230), 30, 55, new Color(187, 189, 199)));
            g2.fill(circle);

            g2.setPaint(new GradientPaint(15, 0, new Color(90, 97, 105), 15, 30, new Color(132, 142, 152)));
            g2.setStroke(new BasicStroke(5));
            g2.draw(circle);

            if (buttonModel.isPressed()) {
                g2.translate(1, 1);
            }

            super.paint(g2, c);
            g2.dispose();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T00:48:44.713

用挥杆打造你想要的外观将是一个真正的挑战。可以做到，但不能使用 CSS，也不能不做大量工作。由于 JavaFX 支持 CSS 并具有媒体播放器，因此我将研究这个新框架。你可以[从这里开始。](http://docs.oracle.com/javafx/)

我最近构建了一个小型 JavaFX 应用程序，并且有机会使用场景构建器，该图形工具现在与 Netbeans 集成以帮助开发人员创建 UI。当您修改 CSS 文件时，UI 会在场景构建器中更新。我们设计的实际元素与我们在 HTML 中使用的元素不同。下面是我用于我的应用程序的 CSS 文件；[您可以在mathteamhosting.com](http://mathteamhosting.com/teachers/javaFX/ProbabilityGame.html)查看和运行我的应用程序

请记住，如果您使用的是 32 位浏览器，则需要 32 位版本的 Java 才能将其作为小程序运行。

```
.root { 
    display: block;
}

.text-input {
    -fx-font-size: 18px;
    -fx-font-weight: bold;
}

.text-field {
    -fx-font-size: 18px;
    -fx-font-weight: bold;
}

.label {
    -fx-font-size: 18px;   
}

.button {
    -fx-font-size: 15px;   
    -fx-font-weight: bold;
    -fx-text-fill: black;
    -fx-background-color: linear-gradient(#0000ff, #ffeeff);
}
#note {
    -fx-font-size: 15px;  
}

#heading {
    -fx-text-fill: #000099;
    -fx-font-size: 18px;
    -fx-font-weight: bold;
} 
```

# ios - iPad在睡觉时会获取位置数据吗？

> ID：13299873
> 
> 赞同：1
> 
> 时间：2012-11-08T23:42:32.353
> 
> 标签：ios, ipad, gps, location

我们正在制作一个允许用户跟踪他们的运动的应用程序，虽然它在 iPhone 上运行良好，但似乎每当 iPad 进入睡眠状态时，它就会停止接收位置更新。位置管理器链接到作为后台任务工作的计时器，并在 4 分钟标记处持续触发（这是它的设计工作方式），但在 iPad（第一代，3G 连接）上，即使位置管理器据说正在寻找数据，设备从不接收任何位置数据。与 iPhone 一起测试时，iPhone 的追踪性能良好，而 iPad 则不然。

**这是 iPad（或第一代 iPad）的限制吗？**

我可以确认后台方法正在通过日志被调用，并且在获取位置数据时，问题不在于计时器不工作或后台任务没有被执行。在系统终止任务之前后台任务没有足够的时间来获取位置可能是一个问题，但我认为也不是这种情况（即使那样，它至少应该接收位置数据几次一天内）。是的，当然 info plist 有一个标签，用于在后台使用位置数据。

# php - 使用 PHP 进行 CMAC-AES 散列

> ID：13299876
> 
> 赞同：4
> 
> 时间：2012-11-08T23:42:52.480
> 
> 标签：php, encryption, cryptography, aes, cmac

我们的 API 平台使用 CMAC-AES 哈希作为请求的签名。我们有可用于在 Java 和 .NET 中创建此哈希的库，但也需要为 PHP 找到解决方案。问题是我找不到任何似乎可靠地生成与在我们的服务器上或通过 Java/.NET 库生成的 CMAC 匹配的哈希的东西。

我发现的唯一库是 CryptLib，一个 alpha 库。

[https://github.com/ircmaxell/PHP-CryptLib](https://github.com/ircmaxell/PHP-CryptLib)

但它没有生成相同的哈希，而且我对加密的理解还不够好（它强制 AES 的块大小为 16，当我在网上找到的说 AES 块大小为 128 时）。

我还有其他途径可以走吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T19:34:24.390

最终，上面的 PHP-CryptLib 库可以正常工作。我的问题只是我自己与二进制与十六进制数据有关的错误。

使用库一提供的测试数据

```
require_once 'lib/CryptLib/bootstrap.php'; 

$hasher = new CryptLib\MAC\Implementation\CMAC;

$key = '2b7e151628aed2a6abf7158809cf4f3c'; // from test/Data/Vectors/cmac-aes ...
$msg = '6bc1bee22e409f96e93d7e117393172a'; // from test/Data/Vectors/cmac-aes ...

$cmac = $hasher->generate($msg,$key); 

echo $cmac; 

// $cmac should be 070a16b46b4d4144f79bdd9dd04a287c
// actually getting ¢ nd{þ¯\ ¥á¼ÙWß­ 
```

除了 CMAC 散列器使用二进制数据而不是 ascii 字符，因此需要使用 pack() 对其进行打包：

```
$key = pack("H*", '2b7e151628aed2a6abf7158809cf4f3c');
$msg = pack("H*", '6bc1bee22e409f96e93d7e117393172a'); 
```

我具体的真实案例是尝试散列任意字符串，例如：

```
$msg = 'Client|Guid-023-23023-23|Guid-0230-2402-252|string|123456|2012-11-08T20:55:34Z'; 
```

为此，我需要一个这样的函数：

```
function pack_str($str) {        
    $out_str = ""; 
    $len = strlen($str); 
    for($i=0; $i<$len; $i++) { 
        $out_str .= pack("c", ord(substr($str, $i, 1))); 
    } 
    return $out_str; 
} 
```

一旦数据被该函数打包并通过散列器运行，我得到了我期望的 CMAC 散列。

# bash - 当它运行时，它会跳过 if 并忽略我的 if 条件。为什么和修复？

> ID：13299877
> 
> 赞同：3
> 
> 时间：2012-11-08T23:42:53.763
> 
> 标签：bash, shell

我的代码在这里。不过，您不必担心第二次。它与玩家 2 完全相同。

```
#!/bin/bash
#this is a game that is two player and it is a race to get to 
#100 before the other player

echo "Player 1 name?"
read p1
echo "Player 2 name?"
read p2
echo "Okay $p1 and $p2\. $p1 will go first"
p1s=0
p2s=0
pt=1

while [ $pt == 1 ]; do
echo "roll or stay"
read choice

if [ $choice == r ]; then

die=$(($RANDOM%6+1))

elif [ $die -eq 1 ]; then
p1s=$(echo "$p1s-$count" |bc)
echo "You rolled a 1\. Your score is $p1s"
echo "$p2 turn now."
sleep 1
count=0
pt=2

elif [ $die > 1 ]; then
p1s=$(echo "$p1s+$die" |bc)
count=$(echo "$count+$die" |bc)
echo "You rolled a $die. Your score is $p1s"
pt=1

else

if [ $choice == s ]; then
echo "Okay $p1 your score is $p1s"
echo "$p2 turn now"
sleep 1
count=0
pt=2

else

pt=1

fi
fi

if [ $p1s > 99 ]; then
echo "$p1 won. $p2 lost"
echo "would you like to play again?"
read again
elif [ $again == yes ]; then
echo "Okay one second."
sleep 1
clear
bash num.sh
elif [ $again == no ]; then
echo "ok going back to the games directory then"
sleep 1
bash games.sh

fi

done

while [ $pt == 2 ]; do
echo "roll or stay"
read choice
if [ $choice == r ]; then

die=$(($RANDOM%6+1))

elif [ $die -eq 1 ]; then
p1s=$(echo "$p2s-$count" |bc)
echo "You rolled a 1\. Your score is $p2s"
echo "$p1 turn now."
sleep 1
count=0
pt=2

elif [ $die > 1 ]; then
p1s=$(echo "$p2s+$die" |bc)
count=$(echo "$count+$die" |bc)
echo "You rolled a $die. Your score is $p2s"
pt=1

else

if [ $choice == s ]; then
echo "Okay $p1 your score is $p2s"
echo "$p1 turn now"
sleep 1
count=0
pt=2

else

pt=2

fi
fi

if [ $p2s > 99 ]; then
echo "$p2 won. $p1 lost"
echo "would you like to play again?"
read again
elif [ $again == yes ]; then
echo "Okay one second."
sleep 1
clear
bash num.sh
elif [ $again == no ]; then
echo "ok going back to the games directory then"
sleep 1
bash games.sh

fi

done 
```

我运行后会发生什么

```
Player 1 name?
name1
Player 2 name?
name2
Okay name1 and name2\. name1 will go first
roll or stay
r
name1 won. name2 lost
would you like to play again? 
```

它应该滚动并且你得到一个随机数，如果一个然后该轮的分数被删除并转到下一个玩家。如果您掷出 2-6，它会增加该轮的分数。如果你留下那么你保存你的分数，每轮分数加起来，直到一个玩家得到 100 分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:55:11.740

您用于测试数值关系的测试比较运算符是错误的。例如：

`elif [ $die > 1 ]; then`应该是---->`elif [ $die -gt 1 ]; then`

`if [ $p2s > 99 ]; then`应该是---->`if [ $p2s -gt 99 ]; then`

等等。

以下是数值的测试比较运算符列表：

*   `==`---> `-eq`（等于）
*   `!=`---> `-ne`（不等于）
*   `>`---> `-gt`（大于）
*   `<`---> `-lt`（小于）
*   `>=`---> `-ge`（大于或等于）
*   `<=`---> `-le`（小于或等于）

# php - preg_replace 不匹配

> ID：13299883
> 
> 赞同：0
> 
> 时间：2012-11-08T23:43:29.967
> 
> 标签：php, regex

我遇到了 preg_replace 的问题，因为我不精通正则表达式。

我正在使用[此工具](http://www.pagecolumn.com/tool/pregtest.htm)进行测试，但替换未按预期工作。

我有这个输入：`http://example.com/test-menu/d/C101`。我期待这个输出：`http://example.com/test-menu/d/101`。我只是想删除这封信`C`。

（`d`可以是任何字母数字字符）

我正在尝试使用这个正则表达式。

这是该站点正在生成的 php：

```
<?php 
    $ptn = "/\/test-menu\/(.)\/C/";
    $str = "http://example.com/test-menu/d/C101";
    $rpltxt = "/test-menu/$1";
    echo preg_replace($ptn, $rpltxt, $str);
?> 
```

我没有与我的正则表达式匹配。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:50:00.327

您的主要问题是在`$rpltxt`调用`preg_replace()`.

我还在末尾添加了数字捕获，并针对字母字符进行了第一次捕获。在你的模式中尽可能具体总是好的。

```
<?php 
$ptn = "#/test-menu/([a-zA-Z])/C(\d+)#";
$str = "http://example.com/test-menu/d/C101";
$rpltxt = '/test-menu/$1/$2';
echo preg_replace($ptn, $rpltxt, $str); 
```

**更新：根据****cbuckley**的*更漂亮*的评论更改了正则表达式分隔符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:50:10.993

任何一个：

```
$ptn = '/(?<=\/test-menu\/.\/)C/';
$rpltext = ''; 
```

（它使用积极的向后看`(?<= ... )`）

或者：

```
$ptn = '/(\/test-menu\/.\/)C/';
$rpltext = '$1'; 
```

（捕获第一个子匹配中的整个前面的字符串，除了 C 之外的所有字符串）

# .net - 理解普通位图结构 BITMAPINFOHEADER

> ID：13299885
> 
> 赞同：1
> 
> 时间：2012-11-08T23:43:52.097
> 
> 标签：.net, winapi, bitmap, scanning, twain

我正在扫描应用程序的低级别，我已经不是很舒服了:)

无论如何，我试图从我得到的数字中弄清楚。

开始了：

1.  以 200 DPI、黑白扫描 Letter 尺寸的文档
2.  分辨率高达 1700x2200
3.  我计算 1700x2200 = 3740000 位或 467500 字节
4.  当我得到 BITMAPINFOHEADER 时，它显示 biSizeImage = 475200。为什么？
5.  我使用 BITMAP 返回字节数组的代码片段返回 475248 字节，多出 48 个字节。但是 biSize 说的是 40，所以如果 header 是 40，那么为什么图像数据前面有 48 个字节呢？

基本上，我不明白为什么在 BITMAPHEADER 中计算的 467500 和 475200 之间存在差异？

我也不明白为什么标题说它是 40 字节，但实际上它是 48？我只是猜测颜色信息是 8 个字节？因为图像是 2 色 (B/W) - 每种颜色使用 4 个字节？

**编辑**

这是信息：

![在此处输入图像描述](../Images/ba1dbb2fde6c0fb6c68eb977c91eaeaf.png)

我*想*我明白了。当扫描线保存在内存中时，它必须是 4 个字节的包。所以，根据我的计算，1700 位是 212.5 字节，根据我所看到的 - 它使用 216 字节。所以，有点道理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:06:26.957

`BITMAPINFOHEADER`真的是 40 字节大小。请记住，位图由[`BITMAPINFO`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183375.aspx)结构表示，而不是`BITMAPINFOHEADER`结构本身。 在结构之后立即`BITMAPINFO`包含一个可选的`RGBQUAD`调色板。`BITMAPINFOHEADER`

1700x2200 将是 3740000 像素，这将占用 467500 字节，因为位图使用 1 位像素，即它是单色位图。您的位图在标题和像素数据之间有额外的 8 个字节，与单色位图一致，因为调色板将包含 2 个`RGBQUAD`值。您必须考虑该`BITMAPINFOHEADER::biBitCount`字段，因为它告诉您每个像素实际使用了多少位以及如何使用调色板。

额外的字节由在末尾填充以对齐`DWORD`边界的每条扫描线计算。`biSizeImage`在这种情况下计算为：

```
biWidth = 1700
biCount = 1
biHeight = 2200
biSizeImage = ((((((biWidth * biCount) + 31) / 32) * 32) / 8) * biHeight) = 475200 
```

# jquery - jQuery Mobile 数字格式？

> ID：13299890
> 
> 赞同：0
> 
> 时间：2012-11-08T23:44:35.667
> 
> 标签：jquery, formatting, numbers

我从一个 JSON 文件中提取了一堆手机号码，这些手机号码是在其他地方提取的，所以不幸的是我无法确定文档格式，所以我必须找到一个完整的工作！

它看起来像：0404013278

我需要格式化：0404-013-278

作为 HTML，它看起来像这样：

```
<p class="mobile-number">0404013278</p> 
```

是否有某种我可以使用的插件或者有人知道一小段脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:49:39.197

[jsfiddle](http://jsfiddle.net/Uh6rN/4/)。您可以编写自己的简单 jQuery 插件，如下所示。

```
 $.fn.formatMobileNumber = function () { 
      var s =  $(this).text();
      var s2 = (""+s).replace(/\D/g, '');
      var m = s2.match(/^(\d{4})(\d{3})(\d{3})$/);
      $(this).text((!m) ? null : ""  + m[1] + "-" + m[2] + "-" + m[3] );
  }

 $(".mobile-number").formatMobileNumber(); ​
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:51:47.470

将您的手机放入输入并使用[此](http://digitalbush.com/projects/masked-input-plugin/)插件中的 .mask() 函数

```
 $('selector').mask("999-999-9999"); 
```

# mysql - 在 SQL 中向任一方向计算“朋友”

> ID：13299893
> 
> 赞同：2
> 
> 时间：2012-11-08T23:44:43.083
> 
> 标签：mysql, sql

我有一个模型，人们可以互相“交友”（友谊）。我如何查询一个人既是朋友又是朋友的人的数量，而不计算两次双向友谊？

这是一个例子：

```
1 -> 2
2 -> 1
1 -> 3
4 -> 1 
```

我希望将其注册为拥有 3 个朋友的 #1

友谊（id、person_id、friend_id）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:50:43.643

```
Select
  count(distinct(f.user_id + f.friend_id))
From
  Friends f
Where
  f.user_id = 1 or f.friend_id = 1 
```

不过，这样做可能会更有效：

```
Select
  Count(*)
From (
  Select friend_id From Friends f Where f.user_id = 1
  Union
  Select user_id From Friends f where f.friend_id = 1
) as a 
```

为了让每个人的朋友数，假设还有一个 users 表：

```
Select
  u.user_id,
  count(distinct f.user_id + f.friend_id)
From
  Users u
    Left Outer Join
  Friends f
    On u.user_id = f.user_id Or u.user_id = f.friend_id 
```

尽管使用 or 加入通常意味着查询速度较慢。另一种方法是：

```
Select
  u.user_id,
  count(distinct f.friend_id)
From
  Users u
    Left Outer Join (
      Select user_id, friend_id from Friends
      Union All
      Select friend_id, user_id from Friends
  ) f
    On u.user_id = f.user_id 
```

您可以将 Union All 更改为 Union 并摆脱独特的，不确定哪个会更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:36:54.533

```
select person_id, sum(ct) friend_count
from (select person_id, count(*) ct from friends
      group by person_id
      UNION ALL
      select f1.friend_id, count(*) ct
      from friends f1
      left join friends f2 on f1.person_id = f2.friend_id
      where f2.person_id is null
      group by f1.friend_id) u
group by person_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T23:52:09.013

```
Select distinct f1.id,count(f1.id) 
from friendships f1 
join friendships f2 on f1.person_id = f2.friend_id
Group by f1.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T23:55:29.570

```
select id, count(*)
from
  (select id, person_id as p1, friend_id as p2 from friendships
   union select id, person_id as p2, friend_id as p1 from friendships) fs
group by id 
```

# actionscript - 移动友好的方式来制作“蜡烛火焰”动画

> ID：13299895
> 
> 赞同：1
> 
> 时间：2012-11-08T23:44:56.237
> 
> 标签：actionscript, mobile-website, css-animations

我以前没有尝试过在这里发帖，所以我希望我做得对。

几年前我买了这个基于蜡烛火焰 Flash 的动画： [http ://activeden.net/item/candle-flame-animation-v3/discussion/42205](http://activeden.net/item/candle-flame-animation-v3/discussion/42205)

无论如何，这是使用动作脚本在 Flash 中完成的，因此我正在寻找一种看起来同样出色但适用于移动设备的替代方案。

我尝试使用精灵创建动画、gif 和一系列 jpg 的小循环电影片段。但以上都没有真正有效，所以我正在寻找替代方案。

可以在 html、css3、javascript 中完成这样的事情吗？是否有可以帮助我构建它的库/框架？

我曾尝试通过 Google Swiffy 转换文件，最终结果实际上看起来非常接近原始文件，但在性能方面，我每次尝试查看动画时都能让手机上的浏览器崩溃。

Google Swiffy 的代码可以轻松优化吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-10T11:39:30.123

您是否尝试过使用粒子系统？有一些 javascript 库，例如：

[https://github.com/gamealchemist/JSparkle](https://github.com/gamealchemist/JSparkle)

演示不包含“蜡烛”效果，但实现起来应该不难。

# perl - gethost() 失败（使用 Net::hostent）

> ID：13299896
> 
> 赞同：1
> 
> 时间：2012-11-08T23:44:56.923
> 
> 标签：perl, hostent

我在这里做错了什么，我不知道是什么。这个小程序应该使用列出的 4 个 IPv4 地址并使用 hostent 的 gethost() 来解析域。如果失败，它将保持 IPv4 格式。

输出：

```
180.76.5.59 has a hostname of 180.76.5.59
199.200.9.44 has a hostname of 199.200.9.44 
```

然后，我收到的错误：

```
 Can't locate object method "137.48.78.181" via package "Net::hostent" at
     ./rev.pl line 19 (#1)
 (F) You called a method correctly, and it correctly indicated a package
 functioning as a class, but that package doesn't define that particular
 method, nor does any of its base classes.  See perlobj.

Uncaught exception from user code:
Can't locate object method "137.48.78.181" via package "Net::hostent" at ./rev.pl line 19.
 at ./rev.pl line 17 
```

17: 如果 (我的 $h = gethost($host)) 19: $name = ($h->$name());

代码：

```
#!/usr/bin/perl

use Modern::Perl;

use Net::hostent;
use diagnostics;

my @ipaddresses = qw/ 180.76.5.59 199.200.9.44 137.48.78.181 137.48.185.207 /;
#host 137.48.78.181
foreach my $host ( @ipaddresses )
{
  my $name = $host;

  # my @sysArg = ("host", $host);
  # system(@sysArg);

 if ( my $h = gethost($host) )
 {
  $name = ($h->$name());
 }
  print "$host has a hostname of $name\n";
} 
```

您会注意到我已经注释掉了系统主机命令，当我使用它时它工作正常，但我还没有想到捕获域的方法（并使输出静音）。非常感谢任何帮助。

使用系统时（@sysArg）；我明白了：

```
Host 59.5.76.180.in-addr.arpa not found: 2(SERVFAIL)
Host 44.9.200.199.in-addr.arpa. not found: 3(NXDOMAIN)
181.78.48.137.in-addr.arpa domain name pointer pc-78-181.hpr.unomaha.edu.
207.185.48.137.in-addr.arpa domain name pointer pki174b-01.ist.unomaha.edu. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T23:59:18.657

反向查找使用`gethostbyaddr`.

```
use Net::hostnet qw( gethostbyaddr );
use Socket       qw( inet_aton );

my $h = gethostbyaddr(inet_aton($ip)));
say $h->name;   # Not $h->$name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:00:59.840

你有一个错误的 $ 印记。

这段代码：

```
$name = ($h->$name());  # WRONG 
```

... 应该：

```
$name = ($h->name()); 
```

`Can't locate object method "137.48.78.181"`提示：字符串值`$name`被用作方法名称。

# ruby - 当前对象/类实例的名称

> ID：13299897
> 
> 赞同：1
> 
> 时间：2012-11-08T23:45:03.197
> 
> 标签：ruby, instance

我需要加载一个 YAML 文件（我正在尝试使用 SettingsLogic），并且我希望实例加载与其同名的*YAML*。简要地：

```
class MySettings < SettingsLogic
  source "whatever_the_instance_is_called.yml"

# Do some other stuff here
end

basic_config = MySettings.new    # loads & parses basic_config.yml
advanced_cfg = MySettings.new    # loads & parses advanced_cfg.yml
...and so on... 
```

原因是我还不知道我必须加载哪些配置文件，然后输入：

```
my_config = MySettings.new("my_config.yml") 
```

或者

```
my_config = MySettings.new(:MyConfig) 
```

只是似乎在重复自己。

我浏览了 Google 和 Stackoverflow，最接近答案的是“[获取实例名称](https://stackoverflow.com/questions/8574060/get-instance-name)”或关于实例名称无意义的讨论！（但是，我可能弄错了查询。）

我试过了`instance#class`，而且`instance#name`；我也试过了 `instance#_id2ref(self)`。

我错过了什么？！

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:48:20.477

好的，所以对于局部变量赋值，存在一些障碍，例如该赋值可能比局部变量符号添加到局部变量列表稍晚一些。但这是我`ConstMagicErsatz`用来实现类似于开箱即用的 Ruby 常量魔法的模块：

```
a = Class.new
a.name #=> nil - anonymous
ABC = a # constant magic at work
a.name #=> "ABC" 
```

这里的优点是您不必编写 ABC = Class.new( name: "ABC" )，name 被“神奇地”分配。这也适用于 Struct 类：

```
Koko = Struct.new
Koko.name #=> "Koko" 
```

但没有其他课程。所以这里是我的`ConstMagicErsatz`，允许你做

```
class MySettings < SettingsLogic
  include ConstMagicErsatz
end

ABC = MySettings.new
ABC.name #=> "ABC" 
```

也

```
a = MySettings.new name: "ABC"
a.name #=> "ABC" 
```

它是这样的：

```
module ConstMagicErsatz
  def self.included receiver
    receiver.class_variable_set :@@instances, Hash.new
    receiver.class_variable_set :@@nameless_instances, Array.new
    receiver.extend ConstMagicClassMethods
  end

  # The receiver class will obtain #name pseudo getter method.
  def name
    self.class.const_magic
    name_string = self.class.instances[ self ].to_s
    name_string.nil? ? nil : name_string.demodulize
  end

  # The receiver class will obtain #name setter method
  def name= ɴ
    self.class.const_magic
    self.class.instances[ self ] = ɴ.to_s
  end

  module ConstMagicClassMethods
    # #new method will consume either:
    # 1\. any parameter named :name or :ɴ from among the named parameters,
    # or,
    # 2\. the first parameter from among the ordered parameters,
    # and invoke #new of the receiver class with the remaining arguments.
    def new( *args, &block )
      oo = args.extract_options!
      # consume :name named argument if it was supplied
      ɴς = if oo[:name] then oo.delete( :name ).to_s
           elsif oo[:ɴ] then oo.delete( :ɴ ).to_s
           else nil end
      # but do not consume the first ordered argument
      # and call #new method of the receiver class with the remaining args:
      instance = super *args, oo, &block
      # having obtained the instance, attach the name to it
      instances.merge!( instance => ɴς )
      return instance
    end

    # The method will search the namespace for constants to which the objects
    # of the receiver class, that are so far nameless, are assigned, and name
    # them by the first such constant found. The method returns the number of
    # remaining nameless instances.
    def const_magic
      self.nameless_instances = 
        class_variable_get( :@@instances ).select{ |key, val| val.null? }.keys
      return 0 if nameless_instances.size == 0
      catch :no_nameless_instances do search_namespace_and_subspaces Object end
      return nameless_instances.size
    end # def const_magic

    # @@instances getter and setter for the target class
    def instances; const_magic; class_variable_get :@@instances end
    def instances= val; class_variable_set :@@instances, val end

    # @@nameless_instances getter for the target class
    def nameless_instances; class_variable_get :@@nameless_instances end
    def nameless_instances= val; class_variable_set :@@nameless_instances, val end

    private

    # Checks all the constants in some module's namespace, recursivy
    def search_namespace_and_subspaces( ɱodule, occupied = [] )
      occupied << ɱodule.object_id           # mark the module "occupied"

      # Get all the constants of ɱodule namespace (in reverse - more effic.)
      const_symbols = ɱodule.constants( false ).reverse

      # check contents of these constant for wanted objects
      const_symbols.each do |sym|
        # puts "#{ɱodule}::#{sym}" # DEBUG
        # get the constant contents
        obj = ɱodule.const_get( sym ) rescue nil
        # is it a wanted object?
        if nameless_instances.map( &:object_id ).include? obj.object_id then
          class_variable_get( :@@instances )[ obj ] = ɱodule.name + "::#{sym}"
          nameless_instances.delete obj
          # and stop working in case there are no more unnamed instances
          throw :no_nameless_instances if nameless_instances.empty?
        end
      end

      # and recursively descend into the subspaces
      const_symbols.each do |sym|
        obj = ɱodule.const_get sym rescue nil # get the const value
        search_namespace_and_subspaces( obj, occupied ) unless
          occupied.include? obj.object_id if obj.kind_of? Module
      end
    end
  end # module ConstMagicClassMethods
end # module ConstMagicErsatz 
```

上面的代码实现了对整个 Ruby 命名空间的自动搜索，目的是在调用 #name 方法时找出哪个常量引用给定的实例。

使用常量的唯一限制是你必须将它大写。当然，您想要的是在对象已经生成并分配给常量之后修改它的元类。再一次，因为没有钩子，你必须找到这样做的机会，比如当新对象第一次被用于它的目的时。所以，有

```
ABC = MySettings.new 
```

然后，当第一次使用 MySettings 实例时，在做任何其他事情之前，修补它的元类：

```
class MySettings
  def do_something_useful
    # before doing it
    instance_name = self.name
    singleton_class.class_exec { source "#{instance_name}.yml" }
  end

  # do other useful things
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:57:07.823

好吧，如果你有大量的变量要实例化，我个人只是创建一个`Hash`来保存它们，这样更干净。现在要实例化所有这些，您可以对所有 yaml 文件进行循环：

```
my_settings = {}
[:basic_config, :advanced_cfg, :some_yaml, :some_yaml2].each do |yaml_to_parse|
  my_settings[yaml_to_parse] = MySettings.new(yaml_to_parse)
end 
```

确保你的`initialize`方法`MySettings`处理你给它的符号！

然后像这样得到你的变量：

```
my_settings[:advanced_cfg] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T00:12:48.983

不幸的是，Ruby 没有用于变量赋值的钩子，但这可以解决。策略大纲如下：首先，您需要让您的`MySettings.new`方法来[评估调用者绑定中的代码](https://stackoverflow.com/questions/1356749/can-you-eval-code-in-the-context-of-a-caller-in-ruby/6109886#6109886)。`local_variables`然后，您将通过调用那里的方法找到调用者绑定中的局部变量符号列表。之后，您将遍历它们以查找哪个引用了您的自定义方法`super`中调用返回的实例。`MySettings.new`你会将它的符号传递给`source`方法调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T23:51:41.390

你不应该也可以吗

```
File.open(File.join(File.expand_path(File.dir_name(__FILE__)), foo.class), "r") 
```

或者

```
require foo.class 
```

第一个不一定要那么复杂。但是，如果我对您的理解正确，您可以直接在 require 或 file load 语句中使用 foo.class 。

根据需要调整 YAML 加载，但 #class 返回一个普通的旧字符串。

# sql - 这个 Oracle SELECT 命令有什么问题？

> ID：13299904
> 
> 赞同：0
> 
> 时间：2012-11-08T23:45:48.603
> 
> 标签：sql, oracle11g

当我运行此查询时：

```
(SELECT MAX(
  SELECT 
    COUNT(e4.employee_id) 
  FROM 
    employees e4, 
    departments d2 
  WHERE 
    d2.manager_id = e3.employee_id AND
    e4.department_id = d2.department_id
  ) 
FROM 
  employees e3
) 
```

我得到一个 ORA-00936：缺少表达式。不知道哪里错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T03:20:34.190

一个更简单的解决方案：

```
SELECT
    MAX(COUNT(*))
FROM
    employees
GROUP BY
    manager_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:55:10.517

我的朋友告诉我如何更改此查询。我的查询试图返回一位经理拥有的最大员工数。

我是 SQL 新手，我正在编写长查询:) 正确的是：

```
SELECT
    MAX(counter)
FROM
(SELECT
    COUNT(*) AS counter
FROM
    employees e
    GROUP BY
    e.manager_id) 
```

# oauth - 通过 OAuth 对 Bitbucket API 进行经过身份验证的调用时遇到问题

> ID：13299907
> 
> 赞同：3
> 
> 时间：2012-11-08T23:46:18.977
> 
> 标签：oauth, bitbucket-api

我正在尝试使用 Oauth 身份验证对 Bitbucket REST API 进行经过身份验证的调用。我已成功检索到一个 oauth_token 和一个 oauth_token_secret（尽管它们与 request_token 和 request_token_secret 相同，这看起来很奇怪但不超出规范）。当我对另一个端点进行 API 调用时，我得到一个 401（未经过身份验证）。我尝试过使用标头身份验证和/或将 oauth_token 和 oauth_token_secret 作为 HTTP 参数传递，结果正常。

这是代码：

```
account_name_url = 'https://api.bitbucket.org/1.0/user'

feedback_oauth_hook = OAuthHook(
    access_token='REDACTED',
    access_token_secret='ALSO_REDACTED',
    consumer_key=CLIENT_ID,
    consumer_secret=CLIENT_SECRET,
    header_auth=True
    )

params = {
    'access_token': auth_tokens['access_token'],
    'access_token_secret': auth_tokens['access_secret']
    }

response = requests.get(account_name_url, data=params, hooks={'pre_request': feedback_oauth_hook}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T11:02:54.427

```
import oauth2  #pip install oauth2
accessToken = oauth2.Token(OAUTH_TOKEN, OAUTH_TOKEN_SECRET)
consumer_key = YOUR_COMSUMER_KEY
consumer_secret = YOUR_CONSUMER_SECRET
consumer = oauth2.Consumer(consumer_key, consumer_secret)
client = oauth2.Client(consumer, accessToken)
api_url = "https://api.bitbucket.org/1.0/user"
resp, content = client.request(api_url, "GET")
print resp, content 
```

上面的 python 代码对我有用。

我打印请求信息，注意它包含`oauth_version=1.0`哪些是必需的。我尝试删除它，然后返回 401。我认为 BitBucket 应该记录这一点。

# python - for/if 循环和 python 中的变量范围

> ID：13299908
> 
> 赞同：2
> 
> 时间：2012-11-08T23:46:25.637
> 
> 标签：python, scope

我对python中变量的范围感到困惑。这是我正在尝试做的一个玩具示例：

```
a = True
enumerated_set = enumerate(['tic','tac','toe'])
for i,j in enumerated_set:
    if a == True:
        print j 
```

我得到的结果是：

```
tic
tac
toe 
```

现在，

`print a`

返回

```
`True` 
```

如果我再跑

```
for i,j in enumerated_set:
    if a == True:
        print j 
```

我没有输出。

我很困惑......因为 global `a = True`，为什么在第二个循环期间没有执行打印。

我感谢您的帮助。

编辑：另一个我很困惑的例子

```
y = 'I like this weather'.split()
for item in y:
    for i,j in enumerated_set:
         if a == True: 
             print j 
```

也没有输出....

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T23:49:41.027

你的布尔值实际上不是问题。那总是`True`。

`enumerated_set`是一个发电机。一旦你循环通过它，它就会筋疲力尽。您需要创建一个新的。

```
In [9]: enumerated_set = enumerate(['tic','tac','toe'])

In [10]: enumerated_set.next()
Out[10]: (0, 'tic')

In [11]: enumerated_set.next()
Out[11]: (1, 'tac')

In [12]: enumerated_set.next()
Out[12]: (2, 'toe')

In [13]: enumerated_set.next()
---------------------------------------------------------------------------
StopIteration                             Traceback (most recent call last)
/usr/local/<ipython-input-13-7b0a413e4250> in <module>()
----> 1 enumerated_set.next()

StopIteration: 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:51:59.490

This is not due to scope, it is due to the nature of `enumerate`, which creates a *generator*, not a list. Generators are single-use: they pop off elements in sequence, they don't create a list which can be evaluated again. This saves memory.

If you wanted to iterate over enumerated_set twice, you might do this:

`enumerated_set = list(enumerate(['tic','tac','toe']))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T23:52:47.577

It is nothing to do with the a variable. You are using an enumerator object,and in the first loop it is gone to its end. You have to recreate it for the second loop.

# asp.net-mvc-3 - sitecore 6.6 MVC 和 MVCsitemap

> ID：13299910
> 
> 赞同：1
> 
> 时间：2012-11-08T23:46:30.970
> 
> 标签：asp.net-mvc-3, model-view-controller, sitecore, sitecore6, mvcsitemapprovider

我刚刚设置了一个新的 Sitecore 6.6 MVC 应用程序，一切顺利。

**我需要一个面包屑路径并找到了这个： http:** [//nuget.org/packages/MvcSiteMapProvider](http://nuget.org/packages/MvcSiteMapProvider)

我已经设置它并正确呈现@Html.MvcSiteMap().SiteMap() 但它没有为面包屑呈现任何东西：@Html.MvcSiteMap().SiteMapPath()

如果我调试到 SiteMapPathHelperModel.cshtml，我可以看到我的模型中没有节点。

**第一个问题是，我可以而且应该使用： http:** [//nuget.org/packages/MvcSiteMapProvider](http://nuget.org/packages/MvcSiteMapProvider) in MVC with Sitecore。

**第二个问题是：** 如果您认为可以使用它，您知道为什么它不会呈现我的面包屑而是呈现菜单吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T22:52:01.967

我从未使用过 SiteCore，所以我不知道它是如何设置的。但是，MvcSiteMapProvider 很灵活，可以适应很多场景。

如果您导航到在 Mvc.sitemap XML 文件中注册的 URL 之一，SiteMapPath() 将呈现。请注意，在大多数情况下，您需要使用控制器和操作属性集来注册它们。整个原理是基于将站点地图中的唯一节点与路由匹配，因此您需要确保请求的节点和路由都具有匹配的 RouteValues 字典。

如果您需要查看有效的实现以开始使用，请参阅[源代码下载](https://github.com/maartenba/MvcSiteMapProvider/archive/master.zip)中的 MvcMusicStore 演示，或者查看本教程：

[http://www.shiningtreasures.com/post/2013/08/07/MvcSiteMapProvider-40-a-test-drive](http://www.shiningtreasures.com/post/2013/08/07/MvcSiteMapProvider-40-a-test-drive)

# uitableview - uisearchbar 不起作用

> ID：13299920
> 
> 赞同：1
> 
> 时间：2012-11-08T23:47:10.707
> 
> 标签：uitableview, uiviewcontroller, uisearchbar, uisearchdisplaycontroller

我创建了一个带有 searchBar 的 UITextView 的子类，代码如下：

```
#import "SezioniTableController.h"

@interface SezioniTableController ()

@end

@implementation SezioniTableController

@synthesize searchBar,searchDisplayController;
@synthesize arraySezioni,arrayFiltrato;
@synthesize objTesto;

- (id)initWithStyle:(UITableViewStyle)style andArray:(NSMutableArray *)array{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization

        self.searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, 44)];
        self.searchBar.delegate = self;

        self.searchDisplayController = [[UISearchDisplayController alloc] initWithSearchBar:searchBar contentsController:self];
        self.searchDisplayController.delegate = self;
        self.searchDisplayController.searchResultsDataSource = self;

        self.arraySezioni = array;
        self.arrayFiltrato = array;

    }
    return self;
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void) loadView {}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.

    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.

    return self.arrayFiltrato.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyIdentifier"];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewStylePlain reuseIdentifier:@"MyIdentifier"];
    }

    self.objTesto = [arrayFiltrato objectAtIndex:indexPath.row];

    cell.textLabel.text = self.objTesto.titoloTesto;

    return cell;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */

    NSDictionary *dict = [NSDictionary dictionaryWithObject:[self.arrayFiltrato objectAtIndex:indexPath.row] forKey:@"Testo"];

    [[NSNotificationCenter defaultCenter] postNotificationName:@"PassaggioTesto" object:self userInfo:dict];
        NSLog(@"Click");
    [tableView deselectRowAtIndexPath:indexPath animated:YES];
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section{

    return self.searchBar; //in .h, IBOutlet UISearchBar* search;
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {

    return 44;
}

- (BOOL) searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString{

    [self filterContentForSearchText:searchString scope: [[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:[self.searchDisplayController.searchBar selectedScopeButtonIndex]]];

    NSLog(@"aa");

    //[[NSNotificationCenter defaultCenter] postNotificationName:@"ReloadTable" object:self];
    // Return YES to cause the search result table view to be reloaded.
    return YES;
}

- (BOOL) searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchScope:(NSInteger)searchOption{

    [self filterContentForSearchText:[self.searchDisplayController.searchBar text] scope:[[self.searchDisplayController.searchBar scopeButtonTitles] objectAtIndex:searchOption]];

    NSLog(@"ab");

    //[[NSNotificationCenter defaultCenter] postNotificationName:@"ReloadTable" object:self];
    // Return YES to cause the search result table view to be reloaded.
    return YES;
}

- (void) filterContentForSearchText:(NSString*)searchText scope:(NSString*)scope{

    NSLog(@"a count:%d",self.arraySezioni.count);

    [self.arrayFiltrato removeAllObjects]; // First clear the filtered array.

    for (objTesto in self.arraySezioni){
        NSComparisonResult result = [objTesto.titoloTesto compare:searchText options:NSCaseInsensitiveSearch range:NSMakeRange(0, [searchText length])];
        if (result == NSOrderedSame){
            NSLog(@"Titolo: %@",objTesto.titoloTesto);
            [self.arrayFiltrato addObject:self.objTesto];
        }else{
            NSLog(@"Non trovato");
        }
    }
}

- (void)searchBarCancelButtonClicked:(UISearchBar *)saearchBar {
    [self.arrayFiltrato removeAllObjects];
    [self.arrayFiltrato addObjectsFromArray: self.arraySezioni];
}

@end 
```

在我的 uiviewcontroller 上，我使用以下代码创建的 uitableview 创建了一个表：

```
self.arrayTesti = [self.dataLoad leggiArgomentiDellaSezione:tag];

self.table = [[SezioniTableController alloc] initWithStyle:UITableViewStylePlain andArray:self.arrayTesti];

self.tableArgumentView.delegate = self.table;
self.tableArgumentView.dataSource = self.table;

[self.tableArgumentView reloadData]; 
```

视图控制器适用于 iPad 应用程序，该表可以完美运行，但如果我尝试搜索某些内容，它就无法正常工作！
你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T10:49:50.283

如果你分配

```
self.arraySezioni = array;
self.arrayFiltrato = array; 
```

那么两者`self.arraySezioni`和`self.arrayFiltrato`都是指向*同一个数组*的指针。这意味着如果你清空一个数组

```
[self.arrayFiltrato removeAllObjects]; 
```

那么另一个数组`self.arraySezioni`（和原来的`array`）也是空的。

所以至少`self.arrayFiltrato`应该是原始数组的*副本：*

```
 self.arrayFiltrato = [array copy]; 
```

# php - 更新语句不更新表，而是将新条目插入表中

> ID：13299921
> 
> 赞同：2
> 
> 时间：2012-11-08T23:47:17.953
> 
> 标签：php, html, mysql

对于我的生活，我无法弄清楚为什么我的更新语句不会更新表行，而是创建一个新行。我有一个 ID 列，它是唯一标识符并且是 auto_increment，我只是不确定您是否可以按照我尝试的方式更新 auto_incremented 数据集。

我有一个表单，它将数据库中的数据回显到字段中，然后使用它来编辑字段并更新它们。

编码：

```
<?php
$EntryID = $_GET['Eid'];
$IDlist = mysql_query("SELECT * FROM BD WHERE Id='$EntryID'");
$IDresults = mysql_fetch_array($IDlist);

$update_query = "UPDATE `BD` SET `Id` ='$IDresults['Id']',`EntryTitle` = '$MyTitle',`EntryDescription` = '$MyDescription',`Category` = '$MyCategory' WHERE `Id` ='$EntryID'";
mysql_query($update_query);

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
else{
header('location: /admin/bd-edit-entry.php?sub=1');
exit();
  }
mysql_close($con);
?> 
```

任何帮助或建议都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:14:03.107

```
SET `Id` ='$IDresults['Id']' 
```

应该是：

```
SET `Id` ='$IDresults[Id]' 
```

或者

```
SET `Id` ='{$IDresults['Id']}' 
```

如果您打开错误报告，您应该会收到有关错误索引的错误。

或者您可以完全不更新此列，因为此列不会更改。

# string - 我正在尝试在 matlab 中显示变量名称和它们的值的 num2str 表示

> ID：13299923
> 
> 赞同：4
> 
> 时间：2012-11-08T23:47:28.267
> 
> 标签：string, matlab, disp

我正在尝试生成以下内容：使用 disp 和 num2str 命令，x 和 y 的新值分别为 -4 和 7。我试图这样做 disp('x 和 y 的新值分别是 num2str(x) 和 num2str(y)')，但它给出了 num2str 而不是适当的值。我应该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-09T00:44:21.637

就像 Colin 提到的那样，一种选择是使用 将数字转换为字符串[`num2str`](http://www.mathworks.com/help/matlab/ref/disp.html)，手动连接所有字符串并将最终结果输入[`disp`](http://www.mathworks.com/help/matlab/ref/sprintf.html). 不幸的是，它会变得*非常*尴尬和乏味，尤其是当您要打印大量数字时。

相反，您可以利用[`sprintf`](http://www.mathworks.com/help/matlab/ref/sprintf.html)MATLAB 中与 C 编程语言对应物非常相似的强大功能。这会产生更短、更优雅的语句，例如：

```
disp(sprintf('The new values of x and y are %d and %d respectively', x, y)) 
```

您可以使用格式说明符控制变量的显示方式。例如，如果`x`不一定是整数，您可以使用`%.4f`，例如，而不是`%d`。

编辑：就像乔纳斯指出的那样，您也可以使用[`fprintf(...)`](http://www.mathworks.com/help/matlab/ref/fprintf.html)代替`disp(sprintf(...))`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T23:50:48.363

尝试：

```
disp(['The new values of x and y are ', num2str(x), ' and ', num2str(y), ', respectively']); 
```

您实际上也可以省略逗号，但恕我直言，它们使代码更具可读性。

顺便说一句，我在这里所做的是将 5 个字符串连接在一起形成一个字符串，然后将该单个字符串输入到`disp`函数中。请注意，我基本上使用与数字矩阵相同的语法连接字符串，即`[x, y, z]`. 我可以这样做的原因是 matlab 在内部将字符串存储为数字行向量，每个字符表示一个元素。因此，上述操作本质上是水平连接 5 个数字行向量！

还有一点：您的代码失败了，因为 matlab 将您的 num2str(x) 视为字符串而不是函数。毕竟，您可能想要打印“num2str(x)”，而不是使用函数调用来评估它。在我的代码中，第一个、第三个和第五个字符串被定义为字符串，而第二个和第四个是计算为字符串的函数。

# ember.js - EmberData：与hasMany关系相关的两个模型

> ID：13299924
> 
> 赞同：4
> 
> 时间：2012-11-08T23:47:29.370
> 
> 标签：ember.js, ember-data

我有一个应用程序逻辑，需要两个模型具有互惠的 hasMany 关系。例如，想象一组可以用多个标签标记的 GitHub 问题。

我正在尝试使用扩展默认 RESTAdapter 的适配器。所有应用程序都可以正常工作，但双重 hasMany 关系会引发异常。深入研究代码，inverseBelongsToForHasMany 方法会引发异常。

所以，我猜 Ember.Data 不支持两个模型与双方的 hasMany 关系的关联，并且每个 hasMany 都需要关联的 belongsTo。我的问题是：

1.  这是否受支持，问题只是我做错了什么？
2.  如果不支持，是否计划出现的功能？
3.  这是在此类应用程序中要避免的关联类型吗？如果是这样，哪个是最好的方法或解决方法？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-09T08:16:37.107

ember-data 中尚不支持多对多关系。目前，一种可能的解决方法是手动管理连接表。

```
A = DS.Model.extend({
  abs: DS.hasMany('Ab'),

  bs: function () {
    return this.get('abs').getEach('b'); 
  }
});

Ab = DS.Model.extend({
  a: DS.belongsTo('A'),
  b: DS.belongsTo('b')
});

B = DS.Model.extend({
  abs: DS.hasMany('Ab'),

  bs: function () {
    return this.get('abs').getEach('a'); 
  }
}); 
```

**这只是起点。然后，您需要自定义模型和适配器，以便以工作方式发送/接收/保留记录**

例如，在我们的应用程序中，我们`{ includedJoin: true }`在 hasMany 关系中引入了一个选项，并将连接表声明为 JoinModel

```
A = DS.Model.extend({
  abs: DS.hasMany('Ab', {includeJoin: true}),
  ...
});

DS.JoinModel = DS.Model.extend();

Ab = DS.JoinModel.extend({
  ... belongsTo relationships ...
}); 
```

然后在 Adapter 中，我们重写 create/update/delete 方法以忽略存储中的连接表生命周期

```
createRecords: function (store, type, records) {
  if (!DS.JoinModel.detect(type)) {
    this._super(store, type, records);
  }
} 
```

最后，在序列化程序中，我们重写该`addHasMany`函数，以便将连接数据作为父模型中的嵌入 id 发送到服务器。

```
addHasMany: function (hash, record, key, relationship) {
  var 
    options = relationship.options,
    children = [];

  //we only add join models, use of `includeJoin`
  if (options.includedJoin) {
    record.get(relationship.key).forEach(function (child) {
      children.pushObject(child.toJSON({
        includeId: true
      }));
    });
    hash[key] = children;
  }
} 
```

在服务器端，我们使用带有 ActiveModelSerializer 的 Rails，所以唯一的小技巧定制是当我们更新父模型时，我们手动管理连接关系，并在连接表中创建/删除条目。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-09T20:58:57.963

我们使用类似的方法来创建关联对象。但是，我们没有覆盖 store 中的方法，而是将连接对象添加到 api。

所以在我们创建的模型中：

```
App.Hashtag = DS.Model.extend({
  hashtagUsers: DS.hasMany('App.HashtagUser', {key: 'hashtag_user_ids'})   
});

App.User = DS.Model.extend({
  hashtagUsers: DS.hasMany('App.HashtagUser', {key: 'hashtag_user_ids'})
});

App.HashtagUser = DS.Model.extend({
  user: DS.belongsTo('App.User'),
  hashtag: DS.belongsTo('App.Hashtag')
}); 
```

然后对于事务，我们只需更改并提交连接对象。

```
App.UserController = Ember.ObjectController.extend({
  followHashtag: function(tag) {
    var hashtagUser;
    hashtagUser = this.get('hashtagUsers').createRecord({
      hashtag: tag
    });
    tag.get('hashtagUsers').pushObject(hashtagUser);
    App.store.commit();
  }
  unfollowHashtag: function(tag) {
    var itemToRemove;
    itemToRemove = this.get('hashtagUsers').find(function(hashtagUser) {
      if (hashtagUser.get('hashtag') === this) {
        return true;
      }
    }, tag);
    this.get('hashtagUser').removeObject(itemToRemove);
    tag.get('hashtagUser').removeObject(itemToRemove);
    itemToRemove.deleteRecord();
    App.store.commit(); 
```

});

API 创建一个 HashtagUser 对象，follow 方法只是将该用户添加到两个关联的部分。

对于删除，它会弹出关联对象并销毁关联对象。

虽然它没有想象中的那么优雅，但我们最大的动机是当 Ember Data 更新时，我们应该能够更容易地将其转换为简单的 Ember Data 支持版本，而不是我们弄乱了 Store 本身。

# java - 使用 scala 和 android-plugin 的 Proguard：java.lang.StringIndexOutOfBoundsException：字符串索引超出范围：160

> ID：13299927
> 
> 赞同：1
> 
> 时间：2012-11-08T23:47:45.227
> 
> 标签：java, android, scala, proguard, sbt-android-plugin

这是我的完整日志：[log](http://paste.awesom.eu/bPl)

我使用 scala、sbt 和 android-plugin。我有很多进口产品，所以这可能是我得到它的原因。有人似乎有同样的问题，并通过“与proguard战斗”解决了它。 [github问题](https://github.com/jberkel/android-plugin/issues/121)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T08:55:02.057

如果我没记错的话，这个问题已经在 ProGuard 的更新版本中得到了修复。您可以简单地替换`tools/proguard`Android SDK 中的目录（甚至只是`tools/proguard/lib/proguard.jar`）。如果这没有帮助，请在[ProGuard](http://proguard.sourceforge.net/)网站上提交错误报告。

# css - 保持右浮动元素与块在同一行

> ID：13299928
> 
> 赞同：2
> 
> 时间：2012-11-08T23:47:47.823
> 
> 标签：css, css-float

我有两个宽度未知的元素，一个向左浮动，一个向右浮动。在它们之间，我有一个扩展块以适应容器宽度。

我想要实现的布局是这样的：

```
+---------------------------------------------+
| [Left] [Expanded                  ] [Right] |
+---------------------------------------------+ 
```

但是右浮动元素被清除到下一行：

```
+---------------------------------------------+
| [Left] [Expanded                          ] |
|                                     [Right] |
+---------------------------------------------+ 
```

如果元素在 HTML 中按以下顺序排列，则可以正常工作：*Left, Right, Expanded*。但为了更具语义，我需要这个顺序：*左、扩展、右*。

看到这个[jsFiddle](http://jsfiddle.net/GpL5A "jsFiddle")。

可能吗？即使需要包装器...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:13:16.650

您可以使用`display: table`：http: [//jsfiddle.net/thirtydot/GpL5A/3/](http://jsfiddle.net/thirtydot/GpL5A/3/)

**HTML：**

```
<div class="expandoooo">
    <span class="left">Left</span>
    <span class="expanded">Expanded</span>
    <span class="right">Right</span>
</div>​ 
```

**CSS：**

```
.expandoooo {
    background-color: lightgray;
    display: table;
}
.expandoooo > span {
    display: table-cell;
}

.left {
    color: red;
}
.expanded {
    background-color: black;
    color: white;
    width: 100%;
}
.right {
    color: blue;
} 
```

这种技术的一个小缺点是即将死去的浏览器 IE7[不支持`display: table`](http://caniuse.com/css-table)，尽管有一个[JavaScript 修复程序](http://tanalin.com/en/projects/display-table-htc/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:43:31.233

如果您仅限于使用浮点数，则需要确保 .left 和 .expanded 都向左浮动。您可能还想使用 max-width 来防止向下推 .right 。

```
.left, .expanded {
   float: left;
} 
```

# php - 正则表达式从字符串中删除所有单个字符

> ID：13299934
> 
> 赞同：7
> 
> 时间：2012-11-08T23:48:09.770
> 
> 标签：php, regex

我需要一个正则表达式来从字符串中删除所有单个字符，而不仅仅是单个字母或数字

字符串是：

> “未来英尺赌场空手道印章（地铁产品）”

它应该是：

> “未来的 Ft 赌场空手道印章由 Metro”

我目前使用的表达式（在 PHP 中）正确地删除了单个 'A' 但留下了单个 '(' 和 ')'

这是我正在使用的代码：

```
$string = preg_replace('/\b\w\b\s?/', '', $string); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T23:59:39.703

尝试这个：

```
(^| ).( |$) 
```

分解：

```
 1\.  (^| )  ->  Beginning of line or space  
   2\.  .      ->  Any character  
   3\.  ( |$)  ->  Space or End of line 
```

实际代码：

```
$string = preg_replace('/(^| ).( |$)/', '$1', $string); 
```

注意：我不熟悉 PHP 正则表达式的工作原理，因此代码可能需要稍作调整，具体取决于实际正则表达式的声明方式。

正如 m.buettner 指出的那样，此代码将有一个尾随空格。需要修剪才能清除它。

编辑：Arnis Juraga 指出这不会清除多个单个字符`a b c`会过滤到`b`. 如果这是一个问题，请使用此正则表达式：

```
(^| ).(( ).)*( |$) 
```

添加到中间的`(( ).)*`将查找任何字符 0 次或更多次后跟的任何空格。不利的一面是，这将在一系列单个字符所在的位置出现双空格。

这意味着：

```
The a b c dog 
```

会变成这样：

```
The  dog 
```

执行替换以获取单个字符后，您需要使用以下正则表达式来定位双空格，然后替换为单个空格

```
( ){2} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-09T00:11:57.000

不需要捕获的稍微更有效的版本将使用环视。由于多重否定逻辑，它不太直观：

```
$string = preg_replace('/(?<!\S).(?!\S)\s*/', '', $input); 
```

这将删除任何前面**或**后面都没有非空白字符的**字符****（**因此只有那些在空白之间或字符串边界处的字符）。它还将包括匹配中的所有尾随空格，以便只留下前面的空格（如果有的话）。需要注意的是，就像尼克的回答一样，在字符串的末尾会留下一个尾随空格（因为它在字符前面）。这可以通过ming 字符串轻松解决。****`)``trim`****

# python - django 使用教程应用程序中断系统调用

> ID：13299936
> 
> 赞同：0
> 
> 时间：2012-11-08T23:48:20.403
> 
> 标签：python, django, system, call

即使仅使用民意调查应用程序，我也会不断收到此间歇性错误。我的应用程序相当简单，至少目前，它只是通过 JSON 向 jquery 表提供一个小的 csv 文件。下面列出了回溯和我的系统配置。提前致谢！

# 代码

> Traceback（最近一次调用最后）：文件“manage.py”，第 14 行，在 execute_manager(settings) 文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site- packages/django/core/management/ **init** .py”，第 459 行，在 execute_manager utility.execute() 文件中“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site- packages/django/core/management/ **init** .py”，第 382 行，在执行 self.fetch_command(subcommand).run_from_argv(self.argv) 文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/ lib/python2.6/site-packages/django/core/management/base.py"，第 196 行，在 run_from_argv self.execute(*args, ** **options.dict**) 文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site-packages/django/core/management/base.py”，第 232 行，执行输出 = self。句柄（*args，**options）文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site-packages/django/core/management/commands/runserver.py” ，第 69 行，在句柄 self.run(*args, **options) 文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site-packages/django/core/ management/commands/runserver.py”，第 80 行，在运行 self.inner_run(*args, **options) 文件“/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/ site-packages/django/core/management/commands/runserver.py"，第 111 行，inner_run ipv6=self.use_ipv6，threading=threading) 文件"/home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/site-packages/django/core/servers/basehttp.py”，第 253 行，在运行 httpd.serve_forever() 文件” /home/baldig/shared_libraries/centos64/pkgs/python/2.6.5/lib/python2.6/SocketServer.py”，第 224 行，在 serve_forever r, w, e = select.select([self], [], [], poll_interval) select.error: (4, 'Interrupted system call')

# 配置#

Django 版本 1.4.1 Python 2.6.5 CentOS 6 Intel Xeon E5630 64GB RAM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:51:25.190

请检查[此线程](https://stackoverflow.com/questions/5633067/signal-handling-in-pylons)，对于 SocketServer.py, 有相同的错误`'Interrupted system call'`。

# c++ - 不能在 C++ 中减去 long double 形式的 long double

> ID：13299937
> 
> 赞同：-1
> 
> 时间：2012-11-08T23:48:21.743
> 
> 标签：c++, double, long-integer, subtraction

每当我从 long double 中做减法时，我都会得到不正确的答案

```
long double Runge(long double a, long double b, int m)
{
long double R;
R=(b-a)/((2^m)-1);
cout<<setprecision(16)<<R<<endl;
return(R);
} 
```

例如，当 a=0.53733 b=0.53736 m=2 我得到 R 等于 -2.805572983821669e-006

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T06:29:42.923

如评论中所述，`^`运营商没有按照您的预期行事。它实际上是按位 XOR 运算符，您正在寻找它的[`pow`](http://en.cppreference.com/w/cpp/numeric/math/pow)功能。

# audio - 使用 ffmpeg 直播包含两种语言的视频

> ID：13299940
> 
> 赞同：1
> 
> 时间：2012-11-08T23:48:51.667
> 
> 标签：audio, stream, ffmpeg, live-streaming

我有一个项目，我需要重新流式传输在音频上设置了两种语言的实时流。左边是西班牙语，右边是英语

流映射为：

```
Stream #0:0: Video: h264 ([7][0][0][0] / 0x0007), yuv420p, 512x288 [SAR 1:1 DAR 16:9], q=2-31, 1k tbn, 1k tbc
Stream #0:1: Audio: mp3 ([2][0][0][0] / 0x0002), 44100 Hz, stereo, s16, 18 kb/s 
```

我需要用右侧的英语或左侧的西班牙语重新直播，我试着到处寻找，但没有找到任何类型的解决方案。

由于这需要现场完成，我不能使用其他程序来分离视频和音频来完成它。

这需要通过 ffmpeg 来完成，我想知道它是否甚至能够使用原始构建来做到这一点，或者它需要一些自定义修改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T01:12:29.957

您可以使用`-map_channel`选项或`pan`过滤器。不幸的是，您没有指定是否需要立体声或单声道输出。如果是立体声，您可以简单地将一个通道静音或将一个通道复制到输出的左右通道中。以下是一些假设您想要保持立体声输出的示例。

要将输入的右声道复制到输出的左右声道：

```
ffmpeg -i input -map_channel 0.1.1 -map_channel 0.1.1 output 
```

使左声道静音：

```
ffmpeg -i input -map_channel -1 -map_channel 0.1.1 output 
```

使用以下命令使左声道静音`pan`：

```
ffmpeg -i input -filter:a pan="stereo:c1=c1" output 
```

FFmpeg 使用问题更适合 superuser.com，因为 stackoverflow 是特定于编程的。

# objective-c - Reddit API ios modhash/cookie 问题

> ID：13299945
> 
> 赞同：1
> 
> 时间：2012-11-08T23:49:08.540
> 
> 标签：objective-c, ios, xcode, api, reddit

我试图通过我的 iOS 应用程序提交给 Reddit。我可以很好地登录并被发回我保存的 modhash 和 cookie `NSUserDefaults`。

问题是当我发布数据时，我不断收到“USER_REQUIRED”作为响应，即使我在帖子中包含了 modhash 并设置了我的会话 cookie。我什至在我的应用程序委托中包含以下内容：

```
[[NSHTTPCookieStorage sharedHTTPCookieStorage]
    setCookieAcceptPolicy:NSHTTPCookieAcceptPolicyAlways]; 
```

但它仍然不起作用。这是我的代码：

```
-(void) post {

    NSString *modhash2 = [[NSUserDefaults standardUserDefaults]  
        objectForKey:@"modhash"];

    NSString *urlString = [NSString 
        stringWithFormat:@"https://ssl.reddit.com/api/submit"];
    NSURL *url = [NSURL URLWithString:urlString];
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url];

    NSString *contentType = [NSString stringWithFormat:@"application/x-www-form-urlencoded;"];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];
    [request addValue:redditCookie forHTTPHeaderField:@"Cookie"];

    [request setHTTPMethod:@"POST"];
    NSString *httpBody = [NSString stringWithFormat
        :@" ?uh=%@&kind=link&url=%@&sr=%@&title=%@&r=%@&api_type=json",
        modhash2,
        @"www.google.com",
        @"test",
        @"Google.com",
        @"test"];

    [request setHTTPBody:[httpBody dataUsingEncoding:NSASCIIStringEncoding]];

    NSURLResponse* response;
    NSError* error = nil;
    NSData* result = [NSURLConnection
        sendSynchronousRequest:request
        returningResponse:&response
        error:&error];

    NSDictionary *json = [NSJSONSerialization
        JSONObjectWithData:result
        options:NSJSONReadingMutableContainers
        error:nil];

    NSDictionary *responseJSON = [json valueForKey:@"json"];
    NSLog(@"RETURN: %@",responseJSON);
} 
```

有任何想法吗？

# analytics - 我怎样才能制作 2 个不重叠的 Apsalar 段？

> ID：13299952
> 
> 赞同：0
> 
> 时间：2012-11-08T23:49:57.067
> 
> 标签：analytics

所以我遇到了一个问题，我需要在 Apsalar 中将我的用户划分为多个部分，但它基于一个事件

该事件仅在调试（所以测试人员）中运行时发生，虽然我仍然可以在 Apsalar 中为他们制作一个片段，但我会遇到测试人员将他们的事件与玩家混合的问题

这样做的最终结果是测试人员数据和玩家数据是分开的，我会跟踪两者。

我可以用 Flurry 做到这一点，因为它们允许我根据没有事件进行分段，但我想知道是否有一种方法可以与 Apsalar 做类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T19:04:08.423

为了实现您的目标 - 将测试人员数据与玩家数据分开 - 我建议从 Apsalar 仪表板中创建一个独特的应用程序。

这样做可以让您在 Apsalar 的平台上将您的事件、细分、群组和其他应用程序数据划分为两个明确的存储桶。我相信确保您不会复制您在 Apsalar 中报告和分析的数据，而不是基于没有事件创建事件更好。如果您基于没有事件创建多个细分，我保证很难解析哪些细分属于您的测试和生产目的。

让我知道这是否有帮助。

图片网址： http: [//ge.tt/4tJJSJR/v/0](http://ge.tt/4tJJSJR/v/0)

# python - Python：smtplib 向消息添加换行符

> ID：13299954
> 
> 赞同：1
> 
> 时间：2012-11-08T23:50:07.977
> 
> 标签：python, sms, gmail, smtplib

`smtplib`我正在尝试使用 Gmail 和Python 中的模块发送短信。

基本功能已实现，使用以下代码，我完全可以在手机上接收这些短信：

```
server = smtplib.SMTP('smtp.gmail.com', 587)
server.ehlo()
server.starttls()
server.login('email', 'password')
server.sendmail('email', 'recipient', '\nhttp://apple.com') 
```

现在，提及我正在发送一个链接可能会有所帮助。有人可能想知道为什么我`\n`在示例链接前面插入了 ；显然，没有它，`smtplib`会将链接作为标头处理，因此会发送一条空消息。

但是，我的消息中添加了一个换行符，如下所示：

```
http://apple.com
newline here 
```

**我无法理解为什么会这样：**

*   smtplib 添加换行符是因为消息是链接吗？
*   是因为我以 SMS 形式接收消息吗？
*   Gmail 是否添加了换行符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:07:32.237

to的`msg`参数`sendmail`不是消息体，而是整个消息。因此，它必须是有效的 RFC(2)822 消息。

[正如文档](http://docs.python.org/2/library/smtplib.html#smtp-example)末尾的注释所说：

> 通常，您会希望使用电子邮件包的功能来构造电子邮件，然后您可以将其转换为字符串并通过 sendmail() 发送；请参阅电子邮件：示例。

但是，上面的示例显示了如何自己生成简单的消息：

```
# Add the From: and To: headers at the start!
msg = ("From: %s\r\nTo: %s\r\n\r\n"
       % (fromaddr, ", ".join(toaddrs))) 
```

如果您想知道什么构成有效的电子邮件，请参阅[RFC 2822](https://www.rfc-editor.org/rfc/rfc2822)（可能还有[RFC 822](https://www.rfc-editor.org/rfc/rfc822)，它被 2822 取代，但有一些有用的不同解释和示例）。但简短的版本是这样的：它是一系列标题行，每行都以 结尾`\r\n`，然后是一个空行（意思是`\r\n\r\n`），然后是消息正文。

所以，从技术上讲，你的代码甚至不应该工作，因为它只是有一个`\n`而不是`\r\n`前缀。

更重要的是，您发送的消息根本没有标题。甚至你可能认为你包括的`From:`and也不包括在内。`To:`正如[文档](http://docs.python.org/2/library/smtplib.html#smtplib.SMTP.sendmail)`sendmail`所说：

> from_addr 和 to_addrs 参数用于构造传输代理使用的消息信封。SMTP 不会以任何方式修改邮件标头。

这可能会或可能不会被各种服务器视为无效（或垃圾邮件）。

同时，末尾额外的换行符是因为所有行都必须以a结尾`\r\n`，而SMTP是面向行的协议。如果消息不以换行符结尾，则根本没有办法表明消息已完成。

如果您想了解详细信息，请参阅[RFC2821](https://www.rfc-editor.org/rfc/rfc2821)，其中解释了 SMTP 协议。具体来说，请看 2.3.1 邮件对象、2.3.7 行和 4.1.1.4 数据（DATA）。但简短的版本是发送消息需要一个 DATA 命令，该命令必须以 结尾`\r\n.\r\n`，并且“这个终止序列的第一个也是结束数据（消息文本）最后一行的那个”。这意味着无法发送不以换行符结尾的消息。

如果你真的想要，可以通过将你的正文封装在 MIME 消息中来解决这个问题；MIME 消息本身当然会以换行符结尾，但这不会影响您封装的正文。有几种方法可以做到这一点 - 但您需要收件人能够处理您发送的任何内容，我猜这些方法都不适用于电子邮件-SMS 网关（更不用说 SMS 接收端点了） ）。

# php - 从多维数组中获取特定值

> ID：13299960
> 
> 赞同：-3
> 
> 时间：2012-11-08T23:50:30.783
> 
> 标签：php, multidimensional-array

> **可能重复：**
> [能够在 print_r() 的输出中看到一个变量，但不确定如何在代码中访问它](https://stackoverflow.com/questions/6322084/able-to-see-a-variable-in-print-rs-output-but-not-sure-how-to-access-it-in-c)

```
stdClass Object ( [geonames] => Array ( [0] => stdClass Object ( [countryName] => United States [adminCode1] => TX [fclName] => city, village,... [countryCode] => US [lng] => -97.3455673 [fcodeName] => populated place [distance] => 1.83381 [toponymName] => Greenock [fcl] => P [name] => Greenock [fcode] => PPL [geonameId] => 4695037 [lat] => 31.7662717 [adminName1] => Texas [population] => 0 ) ) ) 
```

这是我从 print_r($results) 得到的结果。我需要获取 [name] 和 [adminname1] 值。我已经尝试了几种方法，结果我只是不断得到数组{或数组..任何帮助请

编辑：这是一个 var_dump：

```
object(stdClass)#1 (1) { ["geonames"]=> array(1) { [0]=> object(stdClass)#2 (15) { ["countryName"]=> string(13) "United States" ["adminCode1"]=> string(2) "TX" ["fclName"]=> string(17) "city, village,..." ["countryCode"]=> string(2) "US" ["lng"]=> float(-97.3455673) ["fcodeName"]=> string(15) "populated place" ["distance"]=> string(7) "1.83381" ["toponymName"]=> string(8) "Greenock" ["fcl"]=> string(1) "P" ["name"]=> string(8) "Greenock" ["fcode"]=> string(3) "PPL" ["geonameId"]=> int(4695037) ["lat"]=> float(31.7662717) ["adminName1"]=> string(5) "Texas" ["population"]=> int(0) } } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:00:15.583

我认为这会做到：

```
$name = $object->geonames[0]->name;
$adminname1 = $object->geonames[0]->adminName1; 
```

如果这不起作用，请将其分解为多个作业以查看哪里出错了：

```
$thing1 = $object->geonames;
$thing2 = $thing1[0];
$name = $thing2->name; 
```

这在哪一步会出错？

# django - 如何使用 Django 的 ORM 按可能找不到某些 ID 的 ID 列表进行过滤？

> ID：13299961
> 
> 赞同：0
> 
> 时间：2012-11-08T23:50:32.017
> 
> 标签：django, orm, django-orm

我有以下型号：

```
class MyModel(models.Model):
    first_name = models.CharField(max_length=255)

class MyOtherModel(models.Model):
    model = models.ForeignKey(MyModel) 
```

我有一个`MyModel`id 列表：`[1, 2, 3, 5, 7, 11]`. 仅`[1, 2, 3]`在`MyOtherModel`.

`MyOtherModel`根据该 ID 列表进行过滤的最佳方法是什么？我尝试执行以下操作：`MyOtherModel.objects.filter(model__id__in=ids)`但它没有返回任何内容，因为`5, 7, 11`找不到。

编辑：错字。

# css - 调试 PhantomJS @font-face 问题

> ID：13299963
> 
> 赞同：5
> 
> 时间：2012-11-08T23:50:47.337
> 
> 标签：css, node.js, amazon-ec2, font-face, phantomjs

当我在 EC2 服务器上使用 Node.js 使用 PhantomJS 渲染网页时，我无法加载字体。我在 Google 上查找了这个问题，虽然人们对此有疑问，但没有一个解决方案真正帮助了我。我正在寻找的是一种调试 PhantomJS 和@font-face 的方法。我想看看它试图加载哪些字体文件以及问题可能出现在哪里，以便我**自己修复它**。显然这是非常模糊的，所以这里有一些详细说明我的问题的图像：

在 localhost 上渲染（字体安装在机器上）：http: [//imgur.com/o305T](http://imgur.com/o305T)
在 EC2 上渲染（字体应该从外部 css 文件加载）：http: [//imgur.com/6CQW7](http://imgur.com/6CQW7)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:32:58.617

我认为答案很简单：您在解决 FOUT 之前渲染图像。

检查这个：[如何知道何时应用了字体](https://stackoverflow.com/questions/6677181/how-to-know-when-font-face-has-been-applied)

# gcc - 如何强制 CPU 在没有任何循环或分支的情况下按顺序执行程序？

> ID：13299969
> 
> 赞同：2
> 
> 时间：2012-11-08T23:51:13.910
> 
> 标签：gcc, compiler-construction, cpu, cpu-architecture

是否可以？对于没有任何分支/循环的小代码。是否有任何`gcc`标志或内在指令，如 SSE`x86`和其他处理器系列？我只是好奇，因为这些天所有可用的处理器都遵循乱序执行模型。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T17:17:33.867

大多数现代无序 CPU 本质上都是无序的，无法在有序和无序模式之间切换。

你可以试着找一些有序的CPU，有一些：

*   x86：Intel Atom（仅 45 nm 和更早的版本；它们有两条并行管道，但按顺序执行所有指令）
*   arm：Cortex-A8 和许多较旧的内核；

虽然不可能在典型的乱序 CPU 中直接关闭指令重新排序，但您可以在每条指令之间注入一些*序列化*（如`cpuid`在 x86 世界中）以模拟按顺序执行。

有一部分关于序列化指令的英特尔手册（[第 3a 卷）（从](http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.html)[http://objectmix.com/asm-x86-asm-370/69413-serializing-instructions.html](http://objectmix.com/asm-x86-asm-370/69413-serializing-instructions.html)复制）：

> 第 3A 卷：系统编程指南状态
> 
> 7.4 序列化指令
> 
> Intel 64 和 IA-32 架构定义了几个序列化指令。这些指令强制处理器完成先前指令对标志、寄存器和内存的所有修改，并在获取和执行下一条指令之前清空所有缓冲的内存写入。例如，当使用 MOV 控制寄存器指令将新值加载到控制寄存器 CR0 以启用保护模式时，处理器必须在进入保护模式之前执行序列化操作。这种串行化操作确保在处理器处于实地址模式时启动的所有操作在切换到保护模式之前完成。
> 
> 序列化指令的概念被引入到带有 Pentium 处理器的 IA-32 架构中，以支持并行指令执行。序列化指令对 Intel486 及更早版本的处理器没有意义，这些处理器不实现并行指令执行。
> 
> 需要注意的是，在 P6 和更新的处理器系列上执行序列化指令会限制推测执行，因为推测执行指令的结果会被丢弃。以下指令是序列化指令：
> 
> o 特权序列化指令 - MOV（到控制寄存器，除了 MOV CR8）、MOV（到调试寄存器）、WRMSR、INVD、INVLPG、WBINVD、LGDT、LLDT、LIDT 和 LTR。
> 
> o 非特权序列化指令 - CPUID、IRET 和 RSM。
> 
> 当处理器串行化指令执行时，它会确保在执行下一条指令之前完成所有待处理的内存事务（包括存储在其存储缓冲区中的写入）。没有任何东西可以传递序列化指令，序列化指令也不能传递任何其他指令（读、写、取指或 I/O）。例如，CPUID 可以在任何特权级别执行，以序列化指令执行，而不影响程序流，除了修改 EAX、EBX、ECX 和 EDX 寄存器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T09:14:43.440

这是可能的，但这取决于CPU。再说一次，指令本身并不重要，内存访问很重要。

AFAIK 所有 CPU 保证寄存器（以及内部状态）按顺序更新，无论执行如何发生。在某些 CPU 中，临时寄存器被分配了一个值，结果在适当的时候被“写回”（寄存器重命名，因此本身没有副本）。

对于内存访问，大多数 CPU 都有某种内存屏障，这限制了内存访问的重新排序。有几种不同类型的内存屏障，它们因 CPU 而异。可以想象，您可以在每条指令之间放置一个完整的内存屏障，并且您将到达一半。如果你有一台多处理器机器，你可能需要做一些额外的工作来确保缓存也被刷新。如果没有明确的指示，其他核心可能无法按顺序看到结果。

这在很大程度上取决于您要实现的目标以及特定的 CPU。那里的每个 CPU 在某种程度上都是不同的。并且不会有任何神奇的 gcc 标志。在 gcc 中，您将拥有的最好的是内置原子类型（下面的链接）。话题很大。没有简单的答案。

**推荐阅读清单：**

*   [http://lxr.free-electrons.com/source/Documentation/memory-barriers.txt](http://lxr.free-electrons.com/source/Documentation/memory-barriers.txt)
*   [https://en.wikipedia.org/wiki/Memory_ordering](https://en.wikipedia.org/wiki/Memory_ordering)
*   [http://gcc.gnu.org/onlinedocs/gcc-4.4.5/gcc/Atomic-Builtins.html](http://gcc.gnu.org/onlinedocs/gcc-4.4.5/gcc/Atomic-Builtins.html)
*   [http://www.akkadia.org/drepper/cpumemory.pdf](http://www.akkadia.org/drepper/cpumemory.pdf)

# eclipse - EGit不添加文件

> ID：13299974
> 
> 赞同：2
> 
> 时间：2012-11-08T23:51:38.650
> 
> 标签：eclipse, github, egit

我在 Mac OS X 10.8 上使用 EGit 2.1.0 和 Eclipse Juno。（几个小时前我从未使用过 EGit。）

我有一个私人 GitHub 存储库（它用于学校团队项目——不希望我的同学作弊：P）并且我的文件并未全部添加。

我在 Eclipse 中选择了我的所有 12 个项目并尝试提交它们。我浏览了向导，由于某种原因，其中只有 5 个收到了黄色圆柱图标（并且 5 个中的一个没有选择任何文件）。其余的都有问号，谷歌告诉我这意味着它们“未被跟踪”。我已经尝试在项目中的这些项目/文件上推送、提交和添加索引，但无济于事。我如何在 github 上获取它们？

顺便说一句，完全工作的 4 个是按字母顺序排列的前 4 个，而收到图标但没有提交任何文件的那个是第 5 个。这让我觉得它正在按顺序通过它们，并且遇到了某种（未报告的）错误。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T18:52:08.617

结果`.gitignore`是忽略了其中的文件`Sql`。如果您的文件没有被跟踪，一个调查点是查看`.gitignore`您的根目录中的文件。

# php - 将 DATETIME 插入 MySQL

> ID：13299980
> 
> 赞同：0
> 
> 时间：2012-11-08T23:52:01.283
> 
> 标签：php, mysql, datetime

我在使用 PHP 将 DATETIME 插入 MySQL 时遇到问题。

首先，我从新闻表中获取日期：

```
$statement = $db->query("SELECT utcPublishedDate FROM News WHERE idNews = $newsID");
$row = $statement->fetch(PDO::FETCH_ASSOC);
$utcPublishedDate = $row["utcPublishedDate"]; 
```

然后，由于某些代码要求，我对该日期进行了一些日期操作，最终该日期将更改为其他日期。

现在，我必须更新表格，所以：

```
$statement = $db->query("UPDATE News SET utcPublishedDate = $utcPublishedDate WHERE idNews = $newsID"); 
```

这会导致错误。如果我这样做：

```
$statement = $db->query("UPDATE News SET utcPublishedDate = NOW() WHERE idNews = $newsID"); 
```

该语句将毫无问题地执行。

现在，我该如何解决我遇到的错误？显然，这与我的 DATETIME 字段中有空格有关。请问有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:57:26.807

尝试改变：

```
$statement = $db->query("UPDATE News SET utcPublishedDate = $utcPublishedDate WHERE idNews = $newsID"); 
```

到：

```
$statement = $db->query("UPDATE News SET utcPublishedDate = '$utcPublishedDate' WHERE idNews = $newsID"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T00:00:37.527

首先通过 php 转换 DATETIME，使其成为 Mysql 有效的日期时间。用这个：

```
$utcPublishedDate = date('Y-m-d H:i:s', strtotime($utcPublishedDate));   $statement = $db->query("UPDATE News SET utcPublishedDate = '$utcPublishedDate' WHERE idNews = $newsID"); 
```

干杯

# javascript - 第一次显示，通过 jQuery 隐藏后

> ID：13299993
> 
> 赞同：1
> 
> 时间：2012-11-08T23:54:01.787
> 
> 标签：javascript, jquery, jquery-animate

我有这个 HTML 结构：

```
 <div id="side-menu">
            <ul>
            <li><img src="img/once_sonra.png"></img></li>
            <li><img src="img/online_destek.png"></img></li>
            <li><img src="img/sizi_arayalim.png"></img></li>
            </ul>

  </div> 
```

CSS：

```
#side-menu {
    display:block;
    z-index:20;
    position:fixed;
    right:0;
    top:76px;
} 
```

我想要，当单击我的页面时显示此项目并在隐藏动画效果后，但我不知道我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:02:20.507

像这样的东西：

```
$(document).ready(function() {
    // hide the menu initially
    $("#side-menu").hide();
    $(document).click(function() {
        // on click show and then hide menu with animation
        $("#side-menu").slideDown().delay(500).slideUp();
    });
}); 
```

演示：http: [//jsfiddle.net/dhVzq/](http://jsfiddle.net/dhVzq/)

如果您不喜欢幻灯片效果，jQuery 为您提供[了其他几个选项](http://api.jquery.com/category/effects/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:57:50.277

您需要绑定到`click`页面的事件：

```
jQuery(function($) {
    var $sideMenu = $('#side-menu'),
        itemClicked = false; // Use to determine whether an item was clicked

    $sideMenu.hide();

    // Catch clicks on the document
    $(document.body).click(function(e) {

        // Check if the menu is visible
        if (!$sideMenu.is(':visible')) {
            $sideMenu
                .stop(true) // Cancel any animation from a previous click
                .show(); // Show the menu

            // Set a timer to hide the menu after 5 seconds if nothing was clicked
            setTimeout(function() {
                if (!itemClicked) {
                    $sideMenu.slideUp(); // Hide the menu with the slideUp effect
                }
                itemClicked = false; // Reset the flag for next time round
            }, 5000); 
        }
    });

    // Catch clicks on menu items
    $sideMenu.click(function(e) {
        itemClicked = true;
    });
});​ 
```

# c# - WCF 请求因有效请求而失败

> ID：13299999
> 
> 赞同：0
> 
> 时间：2012-11-08T23:54:37.407
> 
> 标签：c#, .net, wcf

我有一个本地托管的 WCF 服务，它与 Paypal 的 API 进行通信以进行付款。

这是我的服务合同；

```
 [DataContract]
    public class ProcessPaymentRequest
    {
        [DataMember]
        public string CreditCardNumber { get; set; }

        [DataMember]
        public string Ccv2Number { get; set; }

        [DataMember]
        public string Email { get; set; }

        [DataMember]
        public decimal Amount { get; set; }

        [DataMember]
        public int ExpiryMonth { get; set; }

        [DataMember]
        public int ExpiryYear { get; set; }
    } 
```

我正在使用以下代码调用服务；

```
var request = new ProcessPaymentRequest
                        {
                            Amount = proforma.Total,
                            CreditCardNumber = billingDetails.Number,
                            Ccv2Number = billingDetails.Code,
                            ExpiryMonth = 3,
                            ExpiryYear = 2014
                        };

                        var response = ServiceInvoker.Invoke<IPayments, ProcessPaymentRequest, ProcessPaymentResponse>(
                              "Payments",
                              request,
                              (proxy, req) => proxy.ProcessPayment(req));

                        if (response == null)
                        {

                        } 
```

proforma.Total 是十进制的（值为 12）；

```
 public class Proforma
    {
         public decimal Total { get; set; }
    } 
```

在这种情况下，我的**响应是 null**，这意味着支付失败。Paypal 的潜在错误是 OrderTotal 无效。

这是在 WCF 中设置 OrderTotal 的代码（注意转换）；

```
return new PaymentDetailsType
                       {
                           OrderTotal =
                               new BasicAmountType
                                   {
                                       currencyID = CurrencyCodeType.GBP,
                                       Value = payment.Amount.ToString()
                                   }
                       }; 
```

现在这是奇怪的事情。如果我将请求更改为；

```
 var request = new ProcessPaymentRequest
                        {
                            Amount = 12,
                            CreditCardNumber = billingDetails.Number,
                            Ccv2Number = billingDetails.Code,
                            ExpiryMonth = 3,
                            ExpiryYear = 2014
                        }; 
```

**有用！**

如果我尝试设置 request.Amount 使用；

```
decimal totalAmount = proforma.Total; 
```

**它失败。**

那么为什么`request.Amount = 12`在值（十进制）相同时调用使用工作而其他调用不工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T00:33:41.807

该值被传递给服务：

```
<a:Amount>12.0000</a:Amount> 
```

对 Paypal 代码的简单更改修复了该问题；

```
 Value = payment.Amount.ToString("n2") 
```

感谢 Mike Parkhill 提出的 Fiddler 的建议，它让我找到了问题所在。