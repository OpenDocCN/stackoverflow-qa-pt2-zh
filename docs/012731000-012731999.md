# StackOverflow 问答 12731000-12731999

# ios - Facebook SDK 结合 JSON 帮助请

> ID：12731007
> 
> 赞同：0
> 
> 时间：2012-10-04T15:48:54.177
> 
> 标签：ios, facebook, json, facebook-graph-api, sbjson

我已经阅读了很多关于这个问题的主题。但他们都没有真正描述我的问题。

因此，如果将 facebookSDK 与 JSON 结合使用，解决发生错误的一种解决方案是重命名导致冲突的 JSON 类。

所以这正是我所做的。我已经重命名了所有导致错误的类（不仅是文件名；）。

所以现在当我运行我的应用程序 Xcode sais：没有并发症，但我得到线程 1 sigabrt。

**整个 Xcode 消息：**

> 无法向引导服务器注册*blabla.blabla*。错误：未知错误代码。这通常意味着该进程的另一个实例已经在运行或挂在调试器中。当前语言：自动；目前是objective-c (gdb)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T15:54:43.287

此 xCode 消息与您的 json 或 facebook 内容无关。删除您的应用程序，重新启动手机，它将摆脱它

# javascript - 数组中的 Javascript setAttribute

> ID：12731013
> 
> 赞同：1
> 
> 时间：2012-10-04T15:49:15.017
> 
> 标签：javascript, css, arrays, class, setattribute

我有一个包含类的 css 文件和一个存储这些类的数组：

```
myArray[0] = myClass1
myArray[1] = myClass2
// etc... 
```

我现在尝试了几种方法，并搜索了如何对`setAttribute()`存储在我的数组中的类进行分类的答案。基本上我需要做的是：

```
myElement.setAttribute("class",myClass1); 
```

但我无法弄清楚如何。

**编辑：**

也许我应该更清楚一点，但是除了在 "" 中输入类名之外的任何东西都不起作用。基本上我所拥有的是一个数组和一个具有来自数组的随机类名的变量。我想使用 setAttribute() 将类名设置为该变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:00:03.640

从评论中，您说您想从数组中分配一个值。它很简单：

```
var myClasses = [];
myClasses[0] = "myClass1";
myClasses[1] = "myClass2";

myElement.className = myClasses[1]; 
```

使用`setAttribute`with 设置 CSS 类并不简单，因为存在浏览器怪癖。使用`.className`适用于所有浏览器。如果不是，你必须做一些美妙的嗅探来确定是否`setAttribute`可以使用`class`or`className`或者你可以像下面这样加倍。

```
var myClasses = [];
myClasses[0] = "myClass1";
myClasses[1] = "myClass2";

myElement.setAttribute("class", myClasses[1]);
myElement.setAttribute("className", myClasses[1]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:52:19.667

您可以通过将字符串设置或附加到元素的`className`属性来添加类：

```
if(myElement.className){
    myElement.className += " "+myClass1;
}else{
    myElement.className = myClass1;
} 
```

空间是存在的，以防之前定义了一个类，因为我们不希望意外地得到类似的东西`oldClassnewClass`而不是正确的`oldClass newClass`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-03T18:10:25.137

好的。这个问题已经很老了，但只是为了练习在 stackoverflow 上回答答案并帮助可能在此页面上绊倒的任何其他人。这里有一些你可以（和一些你应该）用来改变**HTMLElement**（你选择的元素）的类属性的方法。

考虑 Alex 交付的代码。

```
var myArray = [];   // A new array.
myArray[0] = 'foo'; // With 'foo' on 0
myArray[1] = 'bar'; // and 'bar' on 1. 
```

这将创建一个很酷的数组，其中键为 0，值为“foo”，键为 1，值为“bar”。这些是我们想要作为单个字符串放入类中的值。就像我们在编写 HTML 时应该输入类属性一样。

您可以通过将数组连接到单个字符串并将其分配给元素的 className 属性来做到这一点。像这样：

```
// Becomes something like
// myElement.className = "foo bar";
myElement.className = myArray.join(' '); 
```

an的[join](https://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Global_Objects/Array/join)方法`array`返回`string`从数组的值创建的 a。在这种情况下，我们的返回`string`是用空格分隔的。然后使用该字符串来更改`className`元素的完整值。

您还可以遍历数组并将数组中每个键的值分配给元素的类。您可以通过使用`for`循环并使用`classList`element 的属性来完成此操作。该`classList`属性访问对元素类的控制。他们有方法来操作类，比如`add`.

```
for(var i = 0; i < myArray.length; i++) {
    myElement.classList.add(myArray[i]); // i representing each key in array
} 
```

一个接一个，您现在已将所有类添加到 element 。另一种方法是使用数组的[forEach方法。](https://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)该`forEach`方法循环遍历 中的每个键`array`并使其值可用。现代浏览器支持此功能。[犬用参考](https://caniuse.com/#search=forEach)

```
myArray.forEach(function(cls) { // cls representing each value of myArray.
    myElement.classList.add(cls);
}); 
```

或者使用**ES6**和[箭头函数语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)来做几乎相同的事情，但用另一种写下函数的方式。

```
myArray.forEach(cls => { // cls representing each value of myArray.
    myElement.classList.add(cls);
}); 
```

关于相同的过程，但具有不同的风格，称为函数式编程。激动人心的东西！

你想做更多的**ES6**吗？尝试[扩展运算符语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)。简而言之，扩展运算符可以将数组的每个键单独布置到方法中。并且对象的`add`方法`classList`支持多个参数。像这样。

```
// Becomes something like 
// myElement.classList.add("foo", "bar");
myElement.classList.add(...myArray); 
```

选择一个选项。确定其中哪些适合您的项目。您需要古老的浏览器支持吗？使用第一个示例。下一个例子更现代，依此类推。不明白它的作用或含义？尝试阅读可以找到的文档和示例，直到点击为止。我试图用我认为有意义的尽可能多的文档来支持我的示例。

阅读 Mozilla Developer Network 的这些文档，其中解释了元素的[classList](https://developer.mozilla.org/en-US/docs/Web/API/Element/classList)和[className](https://developer.mozilla.org/en-US/docs/Web/API/Element/className)属性提供了什么以及您可以使用它们做什么。

它们是学习如何使用 JavaScript 进行 DOM 操作的基础部分。[Sitepoint 文章解释了 DOM 操作的基础知识](https://www.sitepoint.com/dom-manipulation-vanilla-javascript-no-jquery/#modifyingclassesandattributes)。

# sql - SQL Server 2012 地理 - 找到最少的多行

> ID：12731017
> 
> 赞同：2
> 
> 时间：2012-10-04T15:49:43.063
> 
> 标签：sql, sql-server, geography

我正在尝试找出距犯罪地点最近的自行车架的距离。我有一个包含 500 万起犯罪和 5,000 个自行车架的数据库表。我现在需要做的是找到离这 500 万起犯罪事件最近的自行车架。我尝试使用 geopy 创建一个 python 脚本，但处理起来太耗时了（至少需要几周时间）。我一直在网上广泛搜索，我发现 SQL Server 2012 有一个地理数据类型，所以我创建了一个列，其中包含来自犯罪和自行车架的纬度和经度点的地理数据类型。

现在我正在尝试做这样的事情：

```
update Crimes set distanceToNearestBikeRack = crimeGeo.STDistance((select geo from bike_racks)) 
```

不幸的是，这会导致子查询返回许多行并抛出：

> 消息 512，级别 16，状态 1，第 1 行子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。该语句已终止。

如何从众多点中找到最近的点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:23:06.550

通常你会用它`MIN`来找到一组值的最小值，但它似乎不能很好地与空间方法一起使用。但是，这有效：

```
UPDATE
   Crimes
SET
    distanceToNearestBikeRack = 
        (SELECT TOP 1 crimeGeo.STDistance(BR.geo)
        FROM bike_racks BR
        ORDER BY crimeGeo.STDistance(BR.geo) ASC) 
```

当然，有 500 万起犯罪和 5000 辆自行车架，这可能需要……一段时间。因此，您可能需要考虑批量更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:57:24.833

您显然需要为每个犯罪地点执行一次此计算，并且子查询将需要有关犯罪地点的信息才能找到最近的自行车架。

我没有研究过 SQL 2012，但在过去，人们会使用 Haversine 公式，它实际上非常快。请参阅 [Geolocation and Haversine formula](https://stackoverflow.com/questions/3902450/geolocation-and-haversine-formula)的答案，或我对[如何计算与 GPX 文件的距离的答案？](https://stackoverflow.com/questions/569980/how-to-calculate-distance-from-a-gpx-file/570048#570048)从几年前开始用于 UDF 实现。

# html - 如何正确拥有子排序列表

> ID：12731020
> 
> 赞同：5
> 
> 时间：2012-10-04T15:49:53.610
> 
> 标签：html

我不确定我是否了解其中的逻辑。基本上我想在一个网络博客上做一个简单的列表，如下所示：

```
1\.  item1
    a.  item2
2\.  item3
    a.  item4
    b.  item5
3\.  item6 
```

依此类推，基本上是一个按数字排序的主列表，在每个排序的主项目下都有子列表`lower-alpha`。

我通过使用这个 HTML 标记实现了这个效果：

```
<ol>
    <li>item1</li>
    <ol>
        <li>item2</li>
    </ol>   
    <li>item3</li>
    <ol>
        <li>item4</li>
        <li>item5</li>
    </ol>
    <li>item6</li>
</ol> 
```

使用这个小的 CSS 规则：

```
ol ol { list-style-type: lower-alpha; } /* sub ordered lists */ 
```

根据 w3c 验证器，我遇到的这个问题是：

> 在这种情况下，不允许元素 ol 作为元素 ol 的子元素。

我认为这个问题应该有一个非常简单的解决方案，我找不到一个，而且我不确定我是否遵循为什么`ol`不能成为`ol`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T15:51:58.277

你这样做：

```
<ol>
    <li>item1
        <ol>
            <li>item2</li>
        </ol>
    </li> 
</ol> 
```

您需要将子列表*放在*顶级列表项中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T16:12:01.337

有几种方法可以使用 CSS 或 HTML 来控制您的子排序列表。你几乎达到了你想要的效果，得到这样的东西：

```
1\.  item1
    a.  item2
2\.  item3
    a.  item4
    b.  item5
3\.  item6 
```

您的 HTML 应如下所示：

```
<ol>
    <li>item1
        <ol>
            <li>item2</li>
        </ol>
    </li>
    <li>item3
        <ol>
            <li>item4</li>
            <li>item5</li>
        </ol>
    </li>
    <li>item6</li>
</ol> 
```

你的 CSS 应该是这样的：

```
ol li{ list-style-type:decimal; } /* sub ordered lists level 1 */
ol li ol li { list-style-type: lower-alpha; } /* sub ordered lists level 2 */ 
```

您还可以[在此处阅读有关类似问题的更多信息](https://webmasters.stackexchange.com/questions/14238/numbered-list-with-subclauses)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T15:52:12.053

我认为你的 ol 需要在一个 li 中：

```
<ol>
    <li>item1</li>
    <li>
        <ol>
            <li>item2</li>
        </ol> 
    </li>
</ol> 
```

# ruby - 在 rails_admin 中，如何关闭关系子窗体中的“添加新”和“编辑”按钮？

> ID：12731021
> 
> 赞同：14
> 
> 时间：2012-10-04T15:49:56.300
> 
> 标签：ruby, ruby-on-rails-3, rails-admin

我想阻止人们从子表单中添加或编辑页面布局。基本上我想关闭下面屏幕截图中的按钮：

![在此处输入图像描述](../Images/11ea33902645f1d7e1394a0be3091ac0.png)

我能做到这一点，还是必须在全局范围内关闭整个页面布局模型的添加和编辑？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-10-02T21:20:51.263

可能有点晚了，但你可以使用`inline_add`and `inline_edit`。

例子：

```
 field :profile do
    inline_add false
    inline_edit false
  end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:54:14.120

`button_to`与`:disabled => true`选项一起使用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:02:47.743

也许不是最干净的解决方案......无论如何这就是我所做的。创建了一个替代的部分复制原始版本并剥离与“添加新”和“编辑”相关的链接。然后我像这样配置了该字段。

```
 field :operator_user do
    partial "form_filtering_select_no-relations"
    def selected_id
      @bindings[:object]['operator_user_id']
    end
  end 
```

部分期望存在一个名为“selected_id”的方法并返回用于构建关系的 id。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-04T16:09:32.627

假设您正在谈论授权特定类型的用户“查看”您可以使用[cancan](http://railscasts.com/episodes/192-authorization-with-cancan) gem 的按钮。

# apache-flex - 如何在 Flex mobile 中启动 2 个应用程序？

> ID：12731025
> 
> 赞同：-1
> 
> 时间：2012-10-04T15:50:10.133
> 
> 标签：apache-flex, flex4, flex4.5, flex4.6

我正在 flex mobile 中构建 2 个应用程序。这些应用程序应该一起通信（一种聊天系统）。

我的问题是我不能同时在 Flex Builder 中运行 2 个应用程序：每当我启动一个实例时，另一个实例就会被终止。

有没有办法启动 2 个应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T15:54:30.877

您不能在调试模式下同时启动它们；但是您应该能够在调试模式下启动一个，在“正常”模式下启动一个。

如果为每个项目创建单独的工作区；您应该能够为每个工作区启动一个应用程序。

# sql - 从 SQL Query 中的字符串中间提取数据

> ID：12731026
> 
> 赞同：0
> 
> 时间：2012-10-04T15:50:13.200
> 
> 标签：sql, sql-server-2008

我目前有一个显示多列数据的 SQL 查询。在其中一列中，我想减少数据以仅显示真正需要的数据。问题是我想要的数据在字符串中间。我知道我需要的值之前是什么，之后是一个固定常数。字符串的其余部分可能会改变。SQL 查询中有没有办法只显示该数据？

下面是字符串中的数据示例。我只想查看 LR 和 SCCM 之间的数据。

```
A   %VR1  P  P%V 104.922043 %      Pt 4.902552 psig       PLR2  P  LR **0.350922** sccm      PL 0.001313 dpsig   

R   %VR1  P  P%V 105.017807 %      Pt 4.934245 psig       PLR2  F  LR **5.366095** sccm      PL 0.014557 dpsig     

A   %VR1  P  P%V 100.644852 %      Pt 5.112900 psig       PLR2  P  LR **-0.029057** sccm     PL 0.000377 dpsig     

A   %VR1  P  P%V 101.631256 %      Pt 5.107606 psig       PLR2  P  LR **2.515130** sccm      PL 0.006896 dpsig 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:52:52.503

SQL 引擎具有 SUBSTR() 或 SUBSTRING() 函数，如果您总是需要跳过前 2 个字符和最后 4 个字符，它们将满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T15:58:52.447

如果您使用的是 SQL Server

```
declare @String varchar(500)

set @String = 'A %VR1 P P%V 101.631256 % Pt 5.107606 psig PLR2 P LR 2.515130 sccm PL 0.006896 dpsig '

select SUBSTRING(@String, charindex('PLR2 P LR ', @String) + 10, charindex(' sccm PL', @String) - charindex('PLR2 P LR ', @String) - 10) 
```

如果您确定 LR 和 sccm 是唯一的，您可以使用：

```
declare @String varchar(500)

set @String = 'A %VR1 P P%V 101.631256 % Pt 5.107606 psig PLR2 P LR 2.515130 sccm PL 0.006896 dpsig '

select SUBSTRING(@String, charindex('LR ', @String) + 3, charindex(' sccm', @String) - charindex('LR ', @String) - 3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T15:59:03.883

MySQL版本：

```
SET @var = 'A %VR1 P P%V 104.922043 % Pt 4.902552 psig PLR2 P LR 0.350922 sccm PL 0.001313 dpsig';

SELECT SUBSTRING(@var, LOCATE('LR ', @var) + 3, LOCATE('sccm', @var) - LOCATE('LR ', @var) - 3) 
```

**结果**

```
0.350922
```

SQL 服务器版本：

```
DECLARE @var varchar(200)
SET @var = 'A %VR1 P P%V 104.922043 % Pt 4.902552 psig PLR2 P LR 0.350922 sccm PL 0.001313 dpsig'

SELECT SUBSTRING(@var, CHARINDEX('LR ', @var) + 3, CHARINDEX('sccm', @var) - CHARINDEX('LR ', @var) - 3) 
```

**结果**

```
0.350922
```

使用列名：

```
SELECT SUBSTRING(col1, CHARINDEX('LR ', col1) + 3, CHARINDEX('sccm', col1) - CHARINDEX('LR ', col1) - 3) 
```

# android - Android 活动类的 Eclipse 模板保存在哪里？

> ID：12731032
> 
> 赞同：0
> 
> 时间：2012-10-04T15:50:32.013
> 
> 标签：android, eclipse, mobile

当您从 Eclipse 创建一个新的 Android Activity 时，它会附带一些默认代码，包括 onCreate 和 onStart 方法。创建新的 Android 活动时，我可以在哪里编辑此模板以添加我希望默认创建的新方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T20:06:56.980

查看位于 android_home/tools/templates/activities/BlankActivity 中的模板文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:59:41.397

如果您右键单击扩展类中的任意位置，请转到 Sources-->Override/Implement Methods，您可以找到所有可以 Override/Implement 的方法。选择所有你需要的，然后点击确定

# c# - C# 的声纳新线路覆盖率指标

> ID：12731033
> 
> 赞同：2
> 
> 时间：2012-10-04T15:50:32.320
> 
> 标签：c#, sonarqube, metrics

我们在声纳的历史表中没有以下指标：

1.  新覆盖
2.  新线路覆盖
3.  要覆盖的新行

收集其他指标，如代码覆盖率、新代码覆盖率等。

您能否建议：

应该在配置中添加什么以启用指标？如果可能的话，它是否在任何地方描述了如何准确收集和计算指标（新覆盖率、新线路覆盖率、要覆盖的新线路）？

谢谢你，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:03:26.290

您必须激活[Sonar C# Gallio 插件](http://docs.codehaus.org/display/SONAR/sonar-csharp-gallio-plugin)才能获得这些指标。该插件将启动包含单元测试的项目，并将在 Sonar 中报告指标。您可以查看此示例应用程序以了解其工作原理：[https ://github.com/SonarCommunity/sonar-dotnet/tree/master/tools/dotnet-tools-commons/src/test/resources/solution/Example](https://github.com/SonarCommunity/sonar-dotnet/tree/master/tools/dotnet-tools-commons/src/test/resources/solution/Example)

至于度量的含义，您可以查看以下页面以了解更多信息： http: [//docs.codehaus.org/display/SONAR/Java+Metric+Definitions#JavaMetricDefinitions-Tests](http://docs.codehaus.org/display/SONAR/Java+Metric+Definitions#JavaMetricDefinitions-Tests)

# sql - 在 SQL Server 中将 ntext 列类型更改为 varchar(n)

> ID：12731046
> 
> 赞同：3
> 
> 时间：2012-10-04T15:51:01.220
> 
> 标签：sql, sql-server-2008

`ntext`在我的数据库中使用类型转换所有表列时遇到问题。我写了这个查询来改变我的列，但是有一个语法错误：

```
ALTER TABLE mytable ALTER COLUMN mycolumn 
VARCHAR(SELECT MAX(DATALENGTH(mycolumn)) FROM  mytable); 
```

即使`SELECT MAX(DATALENGTH(mycolumn)) FROM mytable`返回正确的数字，也无法执行查询。

语法错误是：

> *关键字“select”附近的语法不正确。（位于 内 `varchar`）*

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T15:59:54.833

您需要将其作为动态 sql 执行，因为列的大小不能是变量。

```
DECLARE @Length int = SELECT MAX(DATALENGTH(mycolumn)) FROM mytable
DECLARE @MyTable varchar(100) = 'mytable'
DECLARE @MyColumn varchar(100) = 'mycolumn'
DECLARE @SQL varchar(8000) = 'ALTER TABLE ' + @MyTable +' ALTER COLUMN '+ @MyColumn +' VARCHAR(' + CONVERT(varchar, @Length) + ')'
EXEC(@SQL) 
```

这样做的好处是您可以循环查找所有 ntext 列并将它们转换为 varchar `sys.objects`。`sys.columns`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:57:06.480

我担心你不能在`ALTER COLUMN`声明中这样做。至少我从来没有见过这个。

你应该这样做：

计算该列中的最大数据长度（您已经这样做了）：

```
SELECT MAX(DATALENGTH(mycolumn)) FROM mytable 
```

现在只需替换​​您在上一个查询中获得的值：

```
ALTER TABLE mytable ALTER COLUMN mycolumn VARCHAR(MAXVALUEFROMPREVIOUSQUERY); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T15:59:29.847

试：

```
SET @maxLength = SELECT MAX(DATALENGTH(mycolumn)) FROM mytable;

ALTER TABLE mytable ALTER COLUMN mycolumn VARCHAR(@maxLength); 
```

# powerpivot - Microsoft Excel：PowerPivot 2010：链接 Access 数据库

> ID：12731051
> 
> 赞同：5
> 
> 时间：2012-10-04T15:51:25.363
> 
> 标签：powerpivot

我已阅读 PowerPivot 帮助并在线研究了该视频。据我所知，您似乎只能通过 PowerPivot 导入 Microsoft Access 数据库表。这似乎不是访问访问表的逻辑方法。我有一个大型 Access 数据库，我想通过 PowerPivot 访问它来创建数据透视表，从而以不同的方式汇总我的数据。有什么方法可以链接到 Microsoft Access 数据库而不是实际导入表。我目前正在以 Access mdb 格式存储我的数据，因为我也在存储来自 ArcGIS 的空间数据。

问候

彼得W

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T17:26:00.210

无论来源如何，PowerPivot 将始终“物理地”导入数据。这对于利用[xVelocity 引擎](http://msdn.microsoft.com/en-us/library/hh922900.aspx)是必要的，它允许 PowerPivot 发挥其魔力（阅读：在几秒钟内对数百万行执行复杂的分析）。

但即使数据是物理导入的，PowerPivot 通过连接定义保留与源的连接：

![在此处输入图像描述](../Images/fe46531dac42ef0f136ce9de69ba5d90.png)

...所以从这个意义上说，它仍然与源“逻辑上”相关联。需要注意的是，对源的更改不会立即反映在 PowerPivot 中。您必须刷新 PowerPivot 源：

![在此处输入图像描述](../Images/b34416a6c503abf7994ce305d6541ee3.png)

# jquery - 从匿名函数结果中分配函数选项

> ID：12731055
> 
> 赞同：0
> 
> 时间：2012-10-04T15:51:31.197
> 
> 标签：jquery, jquery-ui-accordion

我试图通过确定手风琴容器是否分配了特定的类来为 JQuery 手风琴分配“可折叠”选项。

所以`<div class="accordion">....</div>`应该使用默认值，但`<div class="accordion collapsible">....</div>`应该是可折叠的。我想我可以为该选项使用函数结果，但我不确定我需要调用哪个对象来获取 div 的“hasClass()”函数。

```
$(document).ready(function () {
$("div.accordion").accordion(
{
    active: 0, autoHeight: false, header: "table.xxx",
    collapsible : function() { return myDivsObject.hasClass("collapsible") }()
 }
 ); 
```

如果您能帮助我了解如何传递或访问正确的对象（即`myDivsObject`上面的替换），那就太好了 - 我已经尝试过但无济于事，还尝试了大约 500 种其他变体`this`。`$(this)`任何提示将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:56:17.653

做：

```
$("div.accordion").each(function() {

var curAccordian = this;
$(curAccordian).accordion(
{
    active: 0, autoHeight: false, header: "table.xxx",
    collapsible : $(curAccordian).hasClass("collapsible")
 });
}); 
```

# php - 如何从 $cat_fields 中排除 $row['weight']

> ID：12731062
> 
> 赞同：1
> 
> 时间：2012-10-04T15:51:54.157
> 
> 标签：php

嗨，你能帮我从这个和平的脚本中排除一行吗：

```
<?php 
    if($ad_fields!="")  { 
     foreach ($ad_fields as $key => $value)
        {
          echo " <nobr><strong>&nbsp;&nbsp; ".$cat_fields[$key][0].": </strong>". 
      " ".$ad_fields[$key].$fld_dim[$key].$fld_dimd[$key].";<br /> </nobr> "; }} 
?> 
```

该脚本回显所有行，我怎样才能实现该脚本不调用例如 $row['weight'] 或 $row['weight'] & $row['height']

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:00:47.777

您的代码示例没有名为 的变量`$row`，因此我假设您指的是`$cat_fields`, `$ad_fields`, `$fld_dim`, or `$fld_dimd`（它们似乎都具有相同的键）。

您可以检查-loop`$key`中的值。`foreach`如果它与您不想显示的值匹配，请使用`continue;`跳过：

```
foreach ($ad_fields as $key => $value) {
    if (($key == 'weight') || ($key == 'height')) continue; 
```

或者，您可以定义要跳过并检查的键数组`in_array()`：

```
$skipKeys = array('weight', 'height');
foreach ($ad_fields as $key => $value) {
    if (in_array($key, $skipKeys)) continue; 
```

如果您的要跳过的键列表变得相当长，则第二个选项可能会更好。

# asp.net-mvc-3 - 如何从 MVC 中的视图返回 FileStreamResult

> ID：12731064
> 
> 赞同：0
> 
> 时间：2012-10-04T15:52:00.070
> 
> 标签：asp.net-mvc-3

在我的控制器中，我有一个返回 FileStreamResult 的 GenerateDocument 方法。

在我看来，我的 javascript 只是像这样打开一个新的；window.open('/controller/GenerateDocument/?id=blah');

我需要我的 GenerateDocument 方法：1\. 当文档可以创建/获取而没有错误时返回一个 pdf，2\. 当有错误时返回一个新页面/视图。

这是控制器代码：

```
 public FileStreamResult GenerateDocument(int id)
    {
        string errorResult = string.Empty;

        try
        {
            DocumentDetail documentDetail =
                 DocumentGenerator.GenerateAgreements(id, DcmDocumentEntityType.Sponsor, GetAuthUser());

            if (documentDetail == null) return null;

            Stream stream = DocumentGenerator.RetrieveFile(documentDetail);

            return new FileStreamResult(stream, "application/pdf");
        }
        catch (Exception ex)
        {
            errorResult = FormatException(ex);
            Trace.TraceError(errorResult);
        }

        //ViewBag.Error = HttpUtility.HtmlEncode(errorResult).Replace("\n", "<br />");

        //return View("DocGenerationError");
        return null;
    } 
```

我尝试使用 ActionResult 并在出现错误时返回视图，但正如我在此线程的评论中指出的那样，在页面 javascript 中，window.open(url) 无法正常工作。

这是视图代码：

```
 $('#ActionMenu').change(function() {
      var action = $(this).val();

      switch (action) {            
      case 'Generate Sponsor Agreement':
          window.open('/Sponsor/GenerateDocument/?id=@(Model.SponsorID)');
          break;

      other cases

      default:
      }
  }); 
```

注意：上面的控制器代码可以工作。当我切换到返回 ActionResult 并取消注释它停止工作的异常处理内容时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T15:56:51.740

我不确定我是否理解你的问题。这样做有什么问题？

```
public ActionResult GenerateDocument() {
     ..... // Do code
     if (errors)
         return View(errorModel);
     return new FileStreamResult(...); // your pdf file
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T15:57:42.090

您可以简单地使用返回 FilePathResult 的 Controller.File 方法来执行此操作。有许多重载，但这里是一个示例：

```
return File(streamreader.ReadToEnd(), "text/plain", "Result.PDF"); 
```

您不需要更改操作的返回类型，因为 FilePathResult 继承自 ActionResult，因此在出现错误的情况下您可以返回视图来处理。

# c# - 未处理的异常下一行或退出

> ID：12731065
> 
> 赞同：1
> 
> 时间：2012-10-04T15:52:05.113
> 
> 标签：c#, visual-studio-2012, unhandled-exception

[更新 2：问题已解决，请参阅下面的评论和我的其他帖子。希望这对某人有帮助。]

[更新：对我的另一个问题[Detecting Exceptions during Beta Testing](https://stackoverflow.com/questions/12378869/detecting-exceptions-during-beta-testing)的回答，作为这个问题的基础是有缺陷的。在 Visual Studio 中，2010 和现在的 2012 都运行良好。异常处理程序被调用，好吧，在 VS 换行后我说继续。我决定在 VS2012 IDE 之外进行测试，这是一件好事。操作系统捕获错误，显示标准的“发生未处理的异常”对话框，提供详细信息以及继续和退出按钮。选择继续，只是继续应用程序而不陷入我的超级异常处理程序。选择相当，白化应用程序并显示标准关闭窗口对话框。退出按钮也不会调用我的超级处理程序。

目的是让我的异常处理程序被调用。如果我在 VS2012 IDE 中工作，我不需要超级异常处理程序。处理程序的目的是为最终用户和 beta 测试人员服务，即除我自己以外的任何人，他们不会拥有我的开发站。

下面的代码在 IDE 之外不起作用。因此，关闭应用程序和继续这两个按钮毫无意义，因为异常处理程序永远不会被调用。在 IDE 下运行并使用代码时（为什么这不是浪费我的时间？）， continue 不会继续，exit 不会退出。我只是一遍又一遍地看到同样的异常。是的，我正在尝试发布的可能答案。

我真的认为这个话题会很好地用 .Net 4.5 解决。]

我添加了一个未处理的异常处理程序，它独立于我的主表单，我在 Application.Run(new frmMain()) 调用之前添加了它。处理程序按预期工作，没有问题。

问题： 1\. 是否可以强制关闭/结束违规表单（基本上是关闭应用程序），如果可以，如何强制关闭？

我在主窗体上添加了一个按钮，在 OnClick 事件中，我只是简单地除以零，以便有针对性地模拟一些不好的东西。我正在使用 VS2012 调试环境运行。自然，我首先点击了 VS 提醒我的违规行，但是在继续执行时，我点击了未处理的异常处理程序。在该处理程序中，一种选择是结束执行。我执行了“Application.Exit()”，但没有效果。我一直回到那条令人讨厌的路线。

2.  是否可以从异常处理程序以编程方式从下一行继续执行？

简单地返回只会让我回到那个点。

我已经知道 try/catch 块，但这里的目的是捕获我不期望的未处理异常，并且在最坏的情况下，我可以从该处理程序生成一个有意义的崩溃报告。

JMK 要求提供一些示例代码，但并不确定这会带来什么。

我抛出一个对话框以响应未处理的异常。有 4 个按钮，其中两个用于此贴。第一个按钮允许用户继续，而第二个按钮终止应用程序。至少，是这样的想法。

```
 private void cmdContinue_Click(object sender, EventArgs e)
    {
        // Close this dialog and attempt to resume.
        this.DialogResult = DialogResult.OK;
        this.Close();
    }

    private void cmdExitApp_Click(object sender, EventArgs e)
    {
        // Close this dialog and attempt to resume.
        this.DialogResult = DialogResult.OK;
        this.Close();

        // Exit the application.
        Application.Exit();
    } 
```

continue 块，至少在 VS2012 IDE 中，只是保持在有问题的行。出口块同上。

就我的例外而言，例外可以是任何东西。这就是我写它的原因。我的专用例外只是为了测试代码，然后按钮就消失了。我正在努力努力并创建一个完美的非破坏性应用程序，但是这个目标是虚幻的，直到那个时候这个块。这种机制的另一个目的是让 beta 测试人员向我报告错误。

这是我的超快速和肮脏的未处理异常的代码。我必须很棘手，因为简单地除以零会被编译器捕获。顺便说一句，未处理的异常通常不会发生在我编写的特定行上，而是发生在方法内部对他人代码的调用中。

```
 private void button1_Click(object sender, EventArgs e)
    {
        // Attempt to throw and unhandled exception to test out the unhandled exception handler.
        int iDivider = 0;
        int iResult = 5 / iDivider;
    } 
```

这是另一个代码块，即测试应用程序的启动。

```
 public static frmMain FormMain = null;

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        // 
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        // Turn on global unhandled exception handling.
        cExceptions.Initialize();

        // Run the application load tasks manually, as Windows will not call this event until the show.
        Program.FormMain = new frmMain();

        Application.Run(Program.FormMain);
    } 
```

有人要我的异常处理程序，所以就在这里。基本上，微软提供了样本。

```
 /// <summary>
/// Based on example at http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx
/// </summary>
internal static class cExceptions
{
    [SecurityPermission(SecurityAction.Demand, Flags = SecurityPermissionFlag.ControlAppDomain)]
    public static void Initialize()
    {
        AppDomain currentDomain = AppDomain.CurrentDomain;
        currentDomain.UnhandledException += new UnhandledExceptionEventHandler(MyHandler);
    }

    static void MyHandler(object sender, UnhandledExceptionEventArgs args)
    {
        Exception ex = (Exception)args.ExceptionObject;

        // Log the exception to disk.

        // Show the exception information to the user.
        using (frmExceptions oException = new frmExceptions())
        {
            // Set the exeption information.
            oException.oEx = ex;

            // Show the dialog.
            oException.ShowDialog();
        }

        Console.WriteLine("MyHandler caught : " + ex.Message);
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:06:37.720

在 Application.Run 之前保留`new frmMain())`类范围内的引用（即字段）。在异常处理程序中使用它来调用 frm.Close();

编辑：在第二次阅读时，您似乎不想关闭应用程序；而是引发异常的形式。

在您的处理程序中，将“ `object sender`”转换为表格，然后您应该可以关闭它。如下所示：

```
private void Exception_hander(object sender, EventArgs e) 
{ 
    if (sender is Form) 
    {
      ((Form)sender).Close();
    }
    else 
     { 
       ((Control)sender).Parent.Close();
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T21:57:08.200

好的，Google Uberlord 对我很失望，我发现这篇精彩的文章解决了这个问题。赞美全能的谷歌。

这是链接： [http ://www.switchonthecode.com/tutorials/csharp-tutorial-dealing-with-unhandled-exceptions](http://www.switchonthecode.com/tutorials/csharp-tutorial-dealing-with-unhandled-exceptions)

基本上，JRadness 的想法是正确的，只是略有错误。他应该使用

```
Application.ThreadException += 
    new System.Threading.ThreadExceptionEventHandler(Application_ThreadException); 
```

而不是

```
AppDomain.CurrentDomain.UnhandledException += 
    new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException); 
```

Switch on Code 上的作者谈到了三种方法，第一种是 JRadness 提出的，不适用于 Windows 窗体。

作者甚至解决了我的另一个问题 Continue and Abort。操作系统被绕过了。这是他的事件处理程序。

```
public static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
{
    DialogResult result = DialogResult.Abort;
    try
    {
        Exception ex = (Exception)e.Exception;
        MessageBox.Show("Whoops! Please contact the developers with the"
             + " following information:\n\n" + e.Exception.Message + e.Exception.StackTrace,
             "Application Error", MessageBoxButtons.AbortRetryIgnore, MessageBoxIcon.Stop);
    }
    finally
    {
        if (result == DialogResult.Abort)
        {
            Application.Exit();
        }
    }
} 
```

是的！！

# jquery - 根据原始大小更改字体大小

> ID：12731066
> 
> 赞同：1
> 
> 时间：2012-10-04T15:52:05.993
> 
> 标签：jquery, html, css

如何执行功能，例如我输入的值从 1 到 10，如果值设置为 1，则所有字体大小都是原始的，如果 10，则每个元素的字体大小更改为 10 * 原始大小?

请注意，网站上有成千上万的元素（单词）。

性能至关重要

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:54:10.633

```
document.body.style.fontSize = document.getElementById('myInput').value + 'em'; 
```

您需要在整个页面中使用相对字体大小才能使其正常工作。

您还应该在 CSS 中使用该值之前添加一些错误检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:59:07.107

我为您构建了一个小脚本，应该按照您的要求进行操作。除非您有数百个不同的元素需要更改其字体大小，否则性能应该不是问题。不过，这些元素中有多少单词并不重要。

这是脚本：

```
// Store elements that should change font size
var $changeElements = $(".change-font-size");
// Hook into the keyup event of your input
$("input").keyup(function(){
    // Let's get the multiplier
    var multiplier = parseFloat($(this).val(), 10);
    // Loop through elements
    $changeElements.each(function(){
        var $this = $(this);
        // Get saved font size from dataset
        var fontSize = $this.data("font-size");
        if (!fontSize) {
            // Get original font size from css and save it to dataset
            // parseInt automagically removes "px"
            fontSize = parseInt($this.css("fontSize"), 10);
            $this.data("font-size", fontSize);
        }
        // Calculate and set the new font size
        $this.css("fontSize", fontSize * multiplier);
    });
});​ 
```

请参阅[jsFiddle 上的测试用例](http://jsfiddle.net/mekwall/Sa5cn/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T15:59:10.227

您必须创建一个根据输入值重新定义大小的规则，它应该是这样的：

```
$(document).ready(function(){
  // Increase Font Size
  $("#increaseFont").change(function(){
    var currentFontSize = $('html').css('font-size');
    var currentFontSizeNum = parseFloat(currentFontSize, 10);
    var newFontSize = currentFontSizeNum*$("#increaseFont").val();
    $('html').css('font-size', newFontSize);
    return false;
  });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:22:47.220

这是我的小提琴：http: [//jsfiddle.net/digitalpunch/A6V6e/4/](http://jsfiddle.net/digitalpunch/A6V6e/4/)

基本上，首先选择所有需要的元素，这样你就只遍历 DOM 一次，然后在你的输入文本框上有一个 keyup 事件。在 Chrome 中测试。工作得很快——我在小提琴中使用了很多文本。

祝你好运，达摩

[编辑：]由于公众需求，这里是小提琴的代码：

```
Size: <input type="text" id="size_var"></input>
<p>Lorem ipsum dolor sit amet, consectetur adipi</p>

$(function() {
    var $p = $('p');
    var origSize = $p.css('font-size');
    origSize = origSize.substr(0, origSize.length - 2);                  
    $('#size_var').keyup(function() {
        var multiplier = $(this).val();
        var size = origSize;
        size *= multiplier;
        $p.css({
            'font-size': size + 'px'
        });
    });
});​ 
```

[编辑2：]

除了选择 p，您还可以选择 body 甚至 html 标签并在其上更改字体大小。这将级联（继承）到所有孩子。只要确保没有其他子元素覆盖字体大小。这样您就不必遍历许多元素。

# c++ - 使用 stime() 和 clock_settime() 设置了什么？

> ID：12731067
> 
> 赞同：5
> 
> 时间：2012-10-04T15:52:09.527
> 
> 标签：c++, c, clock

使用 stime() 和 clock_settime() 设置哪个时钟？正如我在 man 中看到的那样，两者都可以设置 Linux 时间。函数 stime() 设置“时间概念”，而带有参数 CLOCK_REALTIME 的 clock_settime() 可以设置“系统范围的 RTC”。

1）这些时钟是什么？
2）有什么不同吗？
3）他们是否也设置了硬件时钟？
4) 如果没有：有人知道在 C/C++ 中设置 hwclock 而不使用 ioctl() 的聪明方法吗？

[更新 1]
更具体的第 4 点：C 的等价物是`std::system("/sbin/hwclock -w")`什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-21T16:05:44.790

抱歉这个简短的回答我实际上只是想发表评论，但它不允许我这样做。

很好，可以帮助您解决您的问题 4。对 Google 的一些快速研究将我发送到 [https://github.com/karelzak/util-linux/blob/master/sys-utils/hwclock.c](https://github.com/karelzak/util-linux/blob/master/sys-utils/hwclock.c) 我没有超过 2 次研究此代码分钟，但快速搜索显示第 468 行：

`static void set_hardware_clock(const time_t newtime, const bool universal, const bool testing)`

编辑：

顺便说一句，请查看维基百科[http://en.wikipedia.org/wiki/Util-linux](http://en.wikipedia.org/wiki/Util-linux) 和 man rtc

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-24T12:37:57.107

我在 MrSykkox 提供的帮助下回答了我的问题。

我阅读了[http://linux.die.net/man/4/rtc](http://linux.die.net/man/4/rtc)并查看了 sys-utils 的给定来源。两者都向我展示了有很多不同的硬件时钟类型，如 CMOS、RTC、KD 等。在 sys-utils 代码的一部分中，我发现一些描述符是通过打开一些特定设备来设置的，例如 /dev/rtc、/dev/rtc0、/dev/misc/rtc、/dev/port 专用于读取。当然，我找到了用于设置 RTC 的 ioctl() 东西。

**结论**

1.  这些时钟是什么？
    *   Linux 不仅知道 2 个时钟。有两类：软件时钟和硬件时钟。
2.  有什么不同吗？
    *   系统时钟是内核维护的软件时钟
    *   即使系统处于低功耗状态（包括“关闭”），RTC 也可以运行，而系统时钟则不能。
3.  他们还设置硬件时钟吗？
    *   系统时钟仅设置内核维护的时钟
4.  有人知道不使用 ioctl() 在 C/C++ 中设置 hwclock 的聪明方法吗？std::system("/sbin/hwclock -w") 的 C 等效项是什么？
    *   RTC 只能由大多数不兼容的 ioctl() 命令设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-08T11:49:51.260

`clock_settime()`并且`stime()`是用于设置系统时间的设置器函数，而不是独立于机器的硬件时钟。

系统启动时，系统时间由硬件时钟设置。Linux 有一个用于处理硬件时钟的命令，即`hwclock`. 有关更多信息，请查看此链接： http: [//linux.die.net/man/8/hwclock](http://linux.die.net/man/8/hwclock)

# internet-explorer-8 - easyXDM 与 IE8 和 IE9 的兼容性

> ID：12731072
> 
> 赞同：2
> 
> 时间：2012-10-04T15:52:39.743
> 
> 标签：internet-explorer-8, internet-explorer-9, cross-domain, messaging

我在项目中使用 easyXDM 进行套接字消息传递。我有一个页面，可以使用 easyXDM 套接字消息在此页面中打开两个不同的 iframe。此 iframe 中只有一个具有与主页的双向通信。

* * *

```
var remoteProvider1 = "https://localhost/provider/first";
var remoteProvider2 = "https://localhost/provider/second";
...
var socket1 = function() {
    ...
    socketA = new easyXDM.Socket({
remote : remoteProvider1 ,
container : container,
    props : {
        },
        onMessage : function(message, origin) {
            onMessageEvent(message, origin);
        },
        onReady : function() {
            socketBar.postMessage("hi");
        }
    });
};

var socket2 = function() {
    ...
    socketB = new easyXDM.Socket({
    remote : remoteProvider2 ,
        container : container,
        props : {
        }
    });
}; 
```

* * *

正如您在代码中看到的，socket1 通过发送接收消息与远程提供者 1 进行通信，并且在远程提供者端也配置了 easyxdm。socket2 只打开一个 iframe。它不需要与远程提供者2 通信。所以远程提供商端没有配置easyXDM。

它在 IE9 中运行良好。在 IE8 中，第一个 iframe 打开并且工作正常。但第二个打开一个没有无意义的 iframe ......只有一个白页。

只是想知道是否有人经历过同样的事情或对原因有任何想法。

提前致谢

# ruby-on-rails - 尊重应用程序子 uri 的资产中的 url 助手

> ID：12731073
> 
> 赞同：1
> 
> 时间：2012-10-04T15:52:50.743
> 
> 标签：ruby-on-rails

我在 rails 3.2 应用程序中有一个 js.erb 文件，该文件使用 url 帮助程序填写 jquery $.ajax 调用的 url 字段。当我在本地机器上使用正确指向 localhost:3000/path_to_method 的 path_to_method_url/path 时，它工作正常。当我将它放在具有子 uri 的暂存环境中时，它指向 example-staging.com/path_to_method 而不是 example-staging.com/sub-uri/path_to_method。任何人都知道如何让资产中的 url 助手尊重 sub-uri 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:48:42.873

尝试覆盖`default_url_options`您的 application_controller.rb

```
def default_url_options(options = {})
  {:suburi => get_sub_uri}
end 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-url_options](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-url_options)

[http://rails.rubyonrails.org/classes/ActionController/Base.html#M000467](http://rails.rubyonrails.org/classes/ActionController/Base.html#M000467)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T03:20:02.900

我遇到了同样的问题，并通过将文件中的 url 帮助`js.erb`程序从`<action>_path`更改为 `<action>_url`然后将默认主机（包括子 uri）添加到每个环境配置来解决它，如下所示：

### 配置/环境/development.rb

```
Rails.application.routes.default_url_options[:host] = 'localhost:3000' 
```

### 配置/环境/staging.rb

```
Rails.application.routes.default_url_options[:host] = 'example-staging.com/sub-uri' 
```

# javascript - 选择选项的布局

> ID：12731074
> 
> 赞同：2
> 
> 时间：2012-10-04T15:52:51.770
> 
> 标签：javascript, html, options

是否可以更改选项的布局？我有 6 个选项（语言），我想这样布局，这样一行中只有三个项目。如果我将“选项显示：内联；那么所有选项都在一行中。我需要使用 javasccrtipt 来更改它吗？不知道如何更改它。我对 javascript 不是很有经验。

我试着让它看起来像这样：

![在此处输入图像描述](../Images/f098e10876ff96c743435a101d16c2d3.png)

我正在使用 Joomla 2.5 和语言选择器模块。

```
<ul class="lang-inline">
<li class="" dir="ltr">
<a href="#"> ENG </a>
</li>
<li class="" dir="ltr">
<a href="#"> FIN </a>
</li>
<li class="" dir="ltr">
<a href="#"> RUS </a>
</li>
</ul> 
```

这是图片上“默认”的视图。也可以选择使其下拉，但是一行中只有一个语言或所有语言。所以也许我需要添加自定义链接而不是使用这个模块？也许那时我不能像我想要的那样布局这些链接并像你展示的那样使用 javascsript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:27:01.267

我相信这就像你想要的：

这是我用来模拟您的图片之类的 HTML。我在按钮中使用了“V”以避免从某个地方加载图形，但你明白了。

```
<div>
    <div class="langs"><span>ENG</span><span>FIN</span><span>RUS</span></div><div class="sbtn">V</div>
</div>
<div id="morelangs" class="hidelangs">
    <div class="langs">
        <div><span>ENG</span><span>FIN</span><span>RUS</span></div>
        <div><span>ENG</span><span>FIN</span><span>RUS</span></div>
    </div>
</div> 
```

请注意“morelangs”下额外的两行语言。

这是我使用的 CSS。主要技巧是 hidelangs 类，它使用“display: none;” 隐藏其他 2 行语言。另外，我使用“显示：内联块；” 允许水平堆叠一些 div 元素。

```
.hidelangs {
    display: none;
}
.langs {
    display: inline-block;
}
.langs span {
    background-color: #555555;
    color: white;
    padding: 4px;
    font-size: 80%;
    margin: 0;
}
.sbtn {
    background-color: #999999;
    width: 30px;
    text-align: center;
    color: white;
    padding: 4px;
    font-size: 80%;
    margin: 0;
    display: inline-block;
} 
```

JavaScript/jQuery 仅用于处理类似按钮的 div 上的点击，它在点击时所做的一切就是删除 CSS 类 hidelangs（如果存在），或者添加它（如果不存在）（jQuery 中的 toggleClass）：

```
$(document).ready(function(e) {
    $(".sbtn").on("click", function(e) {
        $("#morelangs").toggleClass("hidelangs");
    });
}); 
```

[在这里](http://jsfiddle.net/5MAwS/)工作 jsFiddle ，这样你就可以看到它是如何工作的。单击“V”浅色按钮状 div 以打开和关闭额外的行。

您还可以在单​​击处理程序中将按钮内容切换到不同的图像，因为在您的图片中，单击后箭头是倒置的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:14:13.807

不，仅使用带有 css 的 options 元素是不可能做到这一点的。我建议使用 html、css 和 javascript。在您的 html 中使用 UL 元素，使用一些 css 对其进行样式设置，并使用 javascript 来处理点击事件和可见性。

# matlab - Matlab 的 std 在 REPL 中有效，但在程序中无效

> ID：12731077
> 
> 赞同：7
> 
> 时间：2012-10-04T15:53:03.537
> 
> 标签：matlab

我想计算矩阵元素的标准推导。所以我首先用命令`reshape`将矩阵转换为向量，然后使用`std`.

但是，我收到一条错误消息：

```
Error using var (line 59)
First argument must be single or double.

Error in std (line 32)
y = sqrt(var(varargin{:}));

Error in reducenoise2>standabw (line 112)
            s = std(B);

Error in reducenoise2 (line 36)
 D = standabw(n,m,r,fu,D); 
```

所以我打印了我的矢量`B`，就在将它传递给`std`. `x`我将它分配给REPL中的一个变量尝试`std(x)`手动调用。

有趣的是，这工作得很好。

那么这个函数`std`——使用相同的参数调用——在我的代码中使用时如何导致错误，但在 REPL 中工作正常？

这是 Matlab 函数：

```
function [D] = standabw(n,m,r,fu,D)
    for i = 1+r:n-r
        for j = 1+r:m-r
            C = D(i-r:i+r,j-r:j+r);
            B = reshape(C,(2*r+1)^2,1)
            s = std(B);
            if s > fu
                D(i,j) = 255;
            end
        end
    end
end 
```

这是向量`B`，就在错误消息之前：

```
B =

    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    0
    1
    0
    0
    0
    0
    0
    0
    0 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:26:41.363

很可能您的 B 向量是某种 int 类型。尝试这样调用

```
std(double(B)) 
```

上面的语句首先转换`B`为double类型，然后调用std。

`whos`要检查，命令提示符下的变量类型是什么类型。

# asp.net - 使用 SSRS ASP.NET ReportViewer 和 Web 服务进行 Windows 身份验证

> ID：12731078
> 
> 赞同：5
> 
> 时间：2012-10-04T15:53:03.803
> 
> 标签：asp.net, ssrs-2008, reporting-services

我目前在使用 SSRS 时遇到了一些问题。我有一个使用 Windows 身份验证的 ASP.NET 网站。这很好，我知道网站当前用户是当前登录的用户。

在这个站点上有一个 webforms ReportViewer。当我不设置凭据时，这可以正常工作。但是查看 SQL Server 中报告的执行日志，用户名被列为 DOMAIN\MACHINE。

我尝试将 ReportServerCredentials 属性设置为如下所示的类：

```
[Serializable]
public class ReportCredentials : IReportServerCredentials   
{

    public bool GetFormsCredentials(out Cookie authCookie, out string userName, out string password, out string authority)
{
    authCookie = null;
    userName = null;
    password = null;
    authority = null;

    return false;
}

public WindowsIdentity ImpersonationUser
{
    get {
        return (WindowsIdentity)HttpContext.Current.User.Identity;
    }
}

public ICredentials NetworkCredentials
{
    get {
        return null;
    }
} 
```

}

但是，当执行此代码时，我现在从 Web 服务和报告服务返回 401。

这是怎么回事？他们都在同一个域上。我想使用当前用户而不是当前机器。如果我在报告服务器上运行报告，它会在正确的用户名下列出，而不是来自我的网站。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T22:25:24.127

我在这里遇到了自己的麻烦，但最终成功了。

机器1：客户端浏览器

机器 2：网络服务器

机器 3：SSRS + SQL Server

为了解决双跳，我让 IT 部门为 Machine2 启用 Active Directory 委派，设置为“信任此计算机以委派给任何服务（仅限 Kerberos）”。

在我的网络服务器上，我将 Web.config 文件修改为：

```
 <authentication mode="Windows"/>
 <identity impersonate="true"/> 
```

在 SSRS 服务器上，我修改了 rsreportserver.config 文件，添加`<RSWindowsNegotiate/>`到该`<AuthenticationTypes>`部分。我相信默认是`<RSWindowsNTLM/>`. 我只是把两个都留在那里，给了我：

我重新启动了 SSRS 服务器并开始工作。

希望这对某人有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:01:38.623

代替

```
return (WindowsIdentity)HttpContext.Current.User.Identity; 
```

你可以试试

```
return WindowsIdentity.GetCurrent(); 
```

# c++ - 如何编写脚本以使用 boost::unit_test 执行自动测试？

> ID：12731079
> 
> 赞同：1
> 
> 时间：2012-10-04T15:53:06.463
> 
> 标签：c++, python, unit-testing, boost, boost-test

我是 C++ 中自动单元测试的新手。我按照 boost::unit_test 的指令，通过调用`unit_test_main`boost::unit_test 中的函数完成了一个测试方案。运行测试程序对我来说没有问题。但是，我在将参数传递给测试函数时遇到了问题。也许，以下代码可以更好地说明我的问题：

```
#ifndef MAIN_CPP_
#define MAIN_CPP_

#include <string>
#include <vector>
#include <iostream>
#include <assert.h>

#include <boost/program_options.hpp>
#include <boost/test/test_tools.hpp>
#include <boost/test/execution_monitor.hpp>
#include <boost/test/unit_test.hpp>

using namespace boost::program_options;
using namespace std;
using namespace boost;
using namespace boost::unit_test;

/**
* the global test suite
*/

boost::unit_test::test_suite* get_feelfree_test_suite();
boost::unit_test::test_suite* main_global_test_suite;

/**
* name of the test suite
*/
std::string current_global_test_suite_name;

#ifdef BOOST_TEST_ALTERNATIVE_INIT_API

bool  run_global_test_suite () {
    boost::unit_test::test_suite& masterTestSuite = framework::master_test_suite();

    if(masterTestSuite.size() != 0) {
        test_unit_id formerTestSuite = masterTestSuite.get(current_global_test_suite_name);
        masterTestSuite.remove(formerTestSuite);

    }
    masterTestSuite.add(main_global_test_suite);
    current_global_test_suite_name = main_global_test_suite->p_name.get();

    return true;
}
#else
    test_suite* run_global_test_suite(int, char* []) {
    return main_global_test_suite;
}
#endif

/**
* Obtain test program options
*/
int obtain_options(char **optionLine, int argc, char** argv); 

/**
* This function is used to run the test program, and the procedure is really standard.
*/
int main( int argc, char* argv[] )
{
    try 
    {
        /**
        * Step 1\. obtain options
        */
        char* optionLine[1024];
        int len ;
        len = obtain_options(optionLine, argc, argv);
        /**
        * Step 2\. perform unit test based on user's options
        */
        int test_status=0; 
        main_global_test_suite =   get_feelfree_test_suite();
        test_status = unit_test_main(run_global_test_suite, len, optionLine);
        return test_status;
    } 
    catch(std::exception& e)
    {
        std::cout << e.what() << std::endl;
        return 1;
    }   
    catch (const std::string& s) 
    {
        std::cout << s << std::endl;
        return 1;
    }
    catch (...)
    {
        return 1;
    }

}
/** @} */ 

int obtain_options(char **optionLine, int argc,  char* argv[])
{
    // 1\. All the options for testing the program
        options_description desc("Allowed options");
        desc.add_options()("help", "produce help message")
        ("detect_memory_leaks", value<bool>()->default_value(false), "test configuration option (option of boost framework)");
        // 2\. Perform parsing 
        variables_map vm;
        store(parse_command_line(argc, argv, desc), vm);
        notify(vm);
        // 3\. Illustrate the input 
        std::vector<const char*> options;
        std::string testSuiteToRun;
        if(vm.count("test_suite")){  
            testSuiteToRun = vm["test_suite"].as<string>(); 
        }
        else {
            testSuiteToRun = "main";
        }   

        options.push_back(argv[0]);
        if(vm.count("detect_memory_leaks")) {  
            bool detect = vm["detect_memory_leaks"].as<bool>();
            if(detect) {
                options.push_back("--detect_memory_leaks=1");
            }
            else {
            options.push_back("--detect_memory_leaks=0");
            }
        }
        else {
            options.push_back("--detect_memory_leaks=0");
        }

        // 4\. Obtain all the parameters in the format of char** 

        assert(options.size() < 1024);
        std::copy(options.begin(), options.end(), const_cast<const char**>(optionLine));

        return options.size();

}

void Testsub(const std::string &name)
{
    cout<<"File_name: "<<name<<endl;
}
void Testabc( )
{
    std::vector<std::string > name_array;
    name_array.push_back("name 1");
    name_array.push_back("name 2");
    for(int i=0; i<name_array.size(); i++)
        Testsub(name_array[i]);
}

boost::unit_test::test_suite* get_feelfree_test_suite()
{
    test_suite* ts = BOOST_TEST_SUITE( "unit_geometric" );
    ts->add( BOOST_TEST_CASE(&Testabc) ); 
    return ts;
}

#endif 
```

如您所见，在这个测试框架中，我要测试的主要函数是**Testsub**，它依赖于输入参数**const std::string &name**。但是，我不能通过测试套件函数**get_feelfree_test_suite**传递任何参数。因此，在这个测试程序中，我编写了另一个测试函数**Testabc**，其中给出了所有可能的文件测试列表并传递给**Testsub**。这绝对不是最好的解决方案。我想知道是否还有其他解决方案。我想到了几个解决方案，但我不知道它们是否是好的解决方案：

*   解决方案 1：尝试找出一种方法将参数 从主函数 ( )传递给**get_feelfree_test_suite 。**`int main( int argc, char* argv[]`之后，编写一个脚本来多次运行该程序。在 Windows 中，一种可能的脚本是 .bat 脚本。对于这个解决方案，我不知道如何实现它。
*   解决方案2：编写一个列表文件，其中给出所有可能的输入文件测试名称，然后在程序中读取该列表文件。这更容易实现。

我还听说 Python 可以很容易地集成到测试框架中，但我对此一无所知。无论如何，我对所有可能的解决方案持开放态度，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T00:30:28.393

您真的需要在单独的文件中包含不同的“名称”吗？将它们放入您的测试套件可能会更简单。每个名称一个 BOOST_AUTO_TEST_CASE。或者一个名称数组，您可以在测试用例中对其进行迭代。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T12:42:24.460

Since I do not really understand the purpose of all the code, I post a minimal sample that does the work (calling `Testsub` several times) by parsing elements like `-F file1 -F file2` from the command line. It does use the `BOOST_PARAM_TEST_CASE` macro of `boost::unittest`:

```
#include <boost/test/parameterized_test.hpp>
//...
void Testsub(const std::string &name)
{
    cout<<"File_name: "<<name<<endl;
}
test_suite* init_unit_test_suite( int argc, char* argv[] ) 
{
  std::vector<std::string> files_to_run_local;

  for(int i = 0; i < framework::master_test_suite().argc; i++)
  {
    if(std::string(framework::master_test_suite().argv[i]) == "-F")
    {
      if(i == framework::master_test_suite().argc - 1)
      {
        std::cerr << "Error in the command line" << std::endl;
        throw boost::unit_test::framework::setup_error("Error in the command line");
      }
      files_to_run_local.push_back(framework::master_test_suite().argv[++i]);
    }
  }

  test_suite* ts = BOOST_TEST_SUITE( "unit_geometric" );
  ts->add( BOOST_PARAM_TEST_CASE( &Testsub, 
                                  files_to_run_local.begin(), 
                                  files_to_run_local.end() ) ); 

  framework::master_test_suite().add(ts);

  return 0;
} 
```

Now, I think you are the only one to decide over the method used to pass the list of files to the unit test framework. A file containing all files would be also a good solution, and might be appropriate if the list to pass is big, but has the disadvantage of using an intermediate file to do that.

But answering that question really depends on what framework is driving your tests (cmake, shell, etc.) Python/cmake can generate either the command line or the intermediate file very easily for you.

In all case, the clean method is to call the `BOOST_PARAM_TEST_CASE` macro.

# maven - 查找 jasper server-ireport plugin.jar 对 maven 的依赖

> ID：12731080
> 
> 赞同：1
> 
> 时间：2012-10-04T15:53:15.157
> 
> 标签：maven, jasper-reports, ireport

我正在尝试从我的 Java 项目连接到*JasperReports 服务器*以获取所有报告的列表。

在浏览了用户指南之后，我发现有一个***jasperserver-ireport-plugin.jar***有很多有用的帮助类。我需要为此获得 Maven 依赖项。

有什么想法可以在 Maven 上找到***com-jaspersoft-ireport-jasperserver.jar***，因为我无法找到依赖项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T08:18:57.547

这是*Maven*工件的依赖项：

```
<groupId>com.jaspersoft.jasperserver</groupId>
<artifactId>jasperserver-ireport-plugin</artifactId>
<packaging>jar</packaging>
<name>iReport Plugin</name>
<parent>
    <groupId>com.jaspersoft.jasperserver</groupId>
    <artifactId>server</artifactId>
    <version>4.7.0</version>
</parent>
.
.
.
<dependencies>
    <dependency>
        <groupId>iReport</groupId>
        <artifactId>iReport</artifactId>
        <version>1.3.3</version>
    </dependency>
    <dependency>
        <groupId>flexdock</groupId>
        <artifactId>flexdock</artifactId>
        <version>0.4.1</version>
    </dependency>
    <dependency>
        <groupId>javax.activation</groupId>
        <artifactId>activation</artifactId>
        <version>1.1</version>
    </dependency>
    <dependency>
        <groupId>javax.mail</groupId>
        <artifactId>mail</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.12</version>
    </dependency>
    <dependency>
        <groupId>commons-codec</groupId>
        <artifactId>commons-codec</artifactId>
        <version>1.3</version>
    </dependency>
    <dependency>
        <groupId>commons-httpclient</groupId>
        <artifactId>commons-httpclient</artifactId>
        <version>3.1</version>
    </dependency>
    <dependency>
        <groupId>com.jaspersoft.jasperserver</groupId>
        <artifactId>jasperserver-common-ws</artifactId>
    </dependency>
    <dependency>
        <groupId>net.sf.jasperreports</groupId>
        <artifactId>jasperreports</artifactId>
        <version>4.6.0-SNAPSHOT</version>
    </dependency>
</dependencies> 
```

* * *

此工件的[来源](http://code.jaspersoft.com/svn/repos/maven2/com/jaspersoft/jasperserver/jasperserver-ireport-plugin/4.7.0/jasperserver-ireport-plugin-4.7.0.pom)。

您还可以查看[JasperServer SVN 源可用](http://community.jaspersoft.com/questions/523938/jasperserver-svn-source-available)帖子。

# html - html表格单元格间距在div中不起作用

> ID：12731085
> 
> 赞同：0
> 
> 时间：2012-10-04T15:53:28.293
> 
> 标签：html, css

我有一个非常简单的表格的代码：

```
 <table cellspacing="10" cellpadding="10">
            <tr>
                <td><div id="mini_window"></div></td>
                <td><div id="mini_window"></div></td>
                <td><div id="mini_window"></div></td>
            </tr>
        </table> 
```

此表代码在此 div 中：

```
#body_content {
    top: 30%;
    left: 36%;
    width:70%;
    height:18em;
    margin-top: -9em; /*set to a negative number 1/2 of your height*/
    margin-left: -15em; /*set to a negative number 1/2 of your width*/
    border-bottom: 1px solid #ccc;
    border-top: 1px solid #ccc;
    /*background-color: #f3f3f3;*/
    position:fixed;
    direction: rtl;
} 
```

在表格单元格中，有 mini_window div，即：

```
#mini_window {
    top: 50%;
    width:150px;
    height:150px;
    margin-top: 20px; /*set to a negative number 1/2 of your height*/
    /*border-bottom: 1px solid #ccc;*/
    /*border-top: 1px solid #ccc;*/
    border: 1px solid black;
    background-color: #f3f3f3;
    /*direction: rtl;*/
} 
```

它看起来像所附的图片，这不是我想要的。我需要在每个 div 之间或多或少地说 20px。出了什么问题？

![在此处输入图像描述](../Images/4d34da2609d93075b8f265f57e450f82.png)

更新：包括该页面的整个来源：

```
<html>
<head>
<?php   include_once('required_css.php'); ?>
<?php   include_once('required_js.php'); ?>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

</head>
<body>
    <?php include_once('header.php'); ?>

    <div id="body_content">
        <h1>ما الجديد؟</h1>
        <table cellspacing="10" cellpadding="10">
            <tr>
                <td><div id="mini_window"></div></td>
                <td></td>
                <td><div id="mini_window"></div></td>
                <td></td>
                <td><div id="mini_window"></div></td>
            </tr>
        </table>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:07:33.280

您应该添加边距：10px；

```
#mini_window {
    top: 50%;
    width:150px;
    height:150px;
    margin: 10px;
    margin-top: 20px; /*set to a negative number 1/2 of your height*/
    /*border-bottom: 1px solid #ccc;*/
    /*border-top: 1px solid #ccc;*/
    border: 1px solid black;
    background-color: #f3f3f3;
    /*direction: rtl;*/
} 
```

# ios - onBlur 和 onFocus 在 iOS 设备中不起作用

> ID：12731088
> 
> 赞同：1
> 
> 时间：2012-10-04T15:53:54.530
> 
> 标签：ios, onblur, onfocus

> **可能重复：**
> [从后台切换回 Safari 时如何在 iOS webapp 中检测？](https://stackoverflow.com/questions/4656387/how-to-detect-in-ios-webapp-when-switching-back-to-safari-from-background)

在我的一个网页中，我编写了一个 javascript，如下所示：

```
function onBlur() {
            window_focus = false;
        };
        function onFocus() {
            window_focus = true;
        };

        if (/*@cc_on!@*/false) { // for Internet Explorer
            document.onfocusin = onFocus;
            document.onfocusout = onBlur;
        } else {
            window.onfocus = onFocus;
            window.onblur = onBlur;
        }

          setInterval(function () { $('body').append('Your window has focus? ' + window_focus + '<br>'); }, 1000); 
```

当我检查所有浏览器时，这工作正常，但是当我检查 iOS 设备（iPhone/iPad）时。它给了我“window_focus”==未定义。

哪里出错了？

在另一个页面中，我在下面做：

`function CheckIOS(){ document.location = 'custom URL'; setTimeout(function(){document.location='http://www.test.com'},1000);}`

在这种情况下，如果应用程序安装在 ios 设备中，它将打开该应用程序并且不应该重定向到“www.test.com”，否则它应该重定向到“www.test.com”。

有没有办法做到这一点？

提前致谢，

萨加尔乔希

# android - 如何确定 PDF 是否被标记？

> ID：12731090
> 
> 赞同：2
> 
> 时间：2012-10-04T15:53:59.590
> 
> 标签：android, pdf

我如何知道 PDF 是否被标记？我正在开发一个程序，该程序将复制 PDF 文件中的文本并将其显示在我的应用程序中，因此我尝试测试 PDF 文件，我从 PDF 文件中复制了一个表格（普通复制+粘贴）并将其粘贴到 MS单词。结果是没有表格的普通文本。有一些问题是，当您从 pdf 文件复制表格并将其粘贴到 Word 时，它会变成**图像**。真的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:59:00.753

> 如何确定 PDF 是否被标记？

根据您用于处理文件的库，您可以尝试`MarkInfo`从`Catalog`字典中检索条目。

来自 PDF 规范：

> **表 3.25 目录字典中的条目**
> **KEY：** MarkInfo
> **TYPE：**字典
> **VALUE：（**可选；PDF 1.4）包含有关文档使用 Tagged PDF 约定的信息的标记信息字典（参见第 10.6 节，“逻辑结构”）。

但是，即使此属性的值设置为 TRUE，也并不意味着标签实际上会存在，如果存在，它们对于提取表格可能根本没有用处。您仍然可以找到带有仅用于标记段落和图片的标签的表格的 PDF 文件。

长话短说，除非*您*正在生成应用程序将要使用的文件，以便您知道要查找哪些标签，否则依赖这些标签来“从 PDF 中提取表格”**并不是一个好主意。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:34:34.103

我找到了对另一个问题的评论，似乎已经回答了这个问题。

[如何使用 iText java 读取 PDF 中的表格？](https://stackoverflow.com/questions/10878695/how-to-read-a-table-in-a-pdf-using-itext-java#comment14421183_10878783)

> 您可以从内容流中提取文本，但对于普通 PDF，结果将是纯文本（没有任何结构）。如果页面上有表格，则该表格将不会被识别。您将获得内容和一些空白，但这不是表格结构！只有当您有一个带标签的 PDF 时，您才能获得一个 XML 文件。如果 PDF 包含被识别为表格标签的标签，这将反映在 PDF 中。

这是来自[http://support.itextpdf.com/node/27](http://support.itextpdf.com/node/27)

# sql - 在sql中连接数据

> ID：12731093
> 
> 赞同：1
> 
> 时间：2012-10-04T15:54:16.170
> 
> 标签：sql, concatenation, for-xml

给定以下 SQL 表（带数据）

```
create table a (key1 INT, value1 NVARCHAR(MAX))
create table b (fk INT, value2 NVARCHAR(MAX))

INSERT INTO a(key1, value1) values (1, 'test1')
INSERT INTO a(key1, value1) values (2, 'test2')

INSERT INTO b(fk, value2) values (1, 'b1.1')
INSERT INTO b(fk, value2) values (1, 'b1.2')
INSERT INTO b(fk, value2) values (1, 'b1.3') 
```

我想返回 b 中连接在一起的外键值，如下所示：

```
key1    value1  col
1       test1   b1.1, b1.2, b1.3
2       test2   NULL 
```

我知道 FOR XML PATH 有可能（理论上），我只是想不通

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T15:59:37.073

这应该会给你你想要的结果：

```
select a.key1,
  a.value1,
  stuff((select distinct ', ' + value2
         from b
         where a.key1 = b.fk 
         for XML path('')),1,1,'') 
from a 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/58efd/7)

# php - 保存表单元素服务器端

> ID：12731096
> 
> 赞同：0
> 
> 时间：2012-10-04T15:54:29.800
> 
> 标签：php, javascript

如何在这些表单元素上检查并保存服务器端检查元素的值（以便在用户单击返回时保存输入）而不是这样做？当我单击“返回”按钮时，这不起作用。检查项目显示为已检查，但实际上该操作为空白。

```
<label>
    <input type="radio" name="proptype" id="RESI" value="RESI" checked="checked" onClick="this.form.action='?frame=TEST&base=fc';" />
                Residential</label>
<label>
    <input type="radio" name="proptype" id="LOTL" value="LOTL" onClick="this.form.action='?frame=TEST1&base=fc';" />
                Land and Lots</label> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T15:58:30.023

您好，您可以使用会话存储在服务器端。它非常易于使用： [http ://www.w3schools.com/php/php_sessions.asp](http://www.w3schools.com/php/php_sessions.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:58:38.743

对于浏览器来说，点击返回意味着只呈现前一页 - 即使用缓存等。如果您没有说缓存立即过期，则可能不会联系服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:00:44.063

你可以使用[$_SESSION](http://php.net/manual/en/reserved.variables.session.php)或[$_COOKIE](http://php.net/manual/en/reserved.variables.cookies.php)

# php - gettext 是在 php 中本地化网站的最佳方式吗？（只需要轻微的本地化）

> ID：12731105
> 
> 赞同：8
> 
> 时间：2012-10-04T15:55:01.957
> 
> 标签：php, localization, gettext

gettext 是在 php 中本地化网站的最佳方式吗？我没有使用任何框架，也没有太多要翻译的单词，只有两个略有不同的英文版本。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-04T16:01:48.900

您可以只使用 a`lang_XX.php`并将其包含在您的应用程序中。

```
$lang = array(
    "welcome" => "Welcome",
    "bye" => "Bye"
); 
```

对于其他语言，比如说`lang_fr.php`，只有这样的东西：

```
$lang = array(
    "welcome" => "Accueil",
    "bye" => "Au revoir"
); 
```

对于一个小的用例，这应该没问题，不需要处理`.po`文件。此外，您可以这样定义它：

```
function _($l)
{
    return $lang[$l];
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-04T22:48:22.217

gettext 是最好的方法。对于一个字符串很少、预计不会增长太多的小型站点，实现类似于已经发布的解决方案实际上可能比学习如何使用 gettext 和配置它更快。

tl;博士：

多年来，人们一直在努力思考创建一个有效的翻译系统，你可以花很长时间重新发明那个轮子，或者你可以花一点时间学习如何使用 gettext。

在开源世界中，gettext 实际上是一个事实上的标准。

以下是为什么 gettext 比维护大翻译数组列表的通常替代方法更好的一些原因

1.  它更快
2.  它不需要每个线程一次将每个字符串加载到内存中
3.  它为翻译人员提供了很多工具支持，例如 poedit，因此您不必依赖翻译人员了解如何编辑 PHP 代码。
4.  它为您提供工具支持、msgmerge 等，这意味着您可以发送文件进行翻译，同时仍在工作并添加新的可翻译文本并轻松将它们合并在一起
5.  需要就字符串的上下文向翻译人员提供评论？gettext 将从使用它的代码中获取注释并将其复制到翻译文件中
6.  翻译键是英文文本，如果尚未翻译，则文本仍以纯英文显示，迄今为止，在此答案中给出的解决方案都没有得到正确的解决方案。
7.  它支持复数，如果一个字符串取决于一个整数，在英语中只有两种形式`if n != 1 "There was a person" else "There were n people"`。对于其他语言，规则不像 (n!=1) 那样简单，俄语有 3 个不同的变体，规则是`n%100/10==1 ? 2 : n%10==1 ? 0 : (n+9)%10>3 ? 2 : 1;`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T16:00:17.237

在性能方面，`gettext` [Extension](http://www.php.net/gettext)比使用将字符串 id 映射到本地化文本的 String-Array 更快（例如`"WelcomeText" => "Welcome to our homepage."`，将使用 something 包含在内 `<?= $strings["WelcomeText"] >`。gettext 的纯 PHP 实现较慢，如果您可以使用 PHP Extension，则不推荐使用。更多此处详细信息[使用 gettext 本地化 PHP 网站](http://web.archive.org/web/20180105124135/http://mel.melaxis.com/devblog/2005/08/06/localizing-php-web-sites-using-gettext/)和[基准测试 PHP 本地化 – gettext 是否足够快？](http://web.archive.org/web/20080810182039/http://mel.melaxis.com/devblog/2006/04/10/benchmarking-php-localization-is-gettext-fast-enough/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T15:58:13.273

对于永远不会/极少改变的静态内容，当然。

对于动态内容，一点也不。编译 .po 文件等是最重要的，我建议使用某种 JSON 或 XML 解决方案，并使用缓存的编译模板代替模板。

# mysql - “截断不正确的 INTEGER 值”错误

> ID：12731110
> 
> 赞同：0
> 
> 时间：2012-10-04T15:55:27.500
> 
> 标签：mysql, sql

我在`Truncated incorrect INTEGER value: 'D'`尝试运行以下查询时收到警告：

```
UPDATE MESSAGES
SET status = CASE
    WHEN 
    (from_id='111111111' AND status='A') THEN 'S'
    WHEN 
    (to_id  ='111111111' AND status='A') THEN 'R'
    WHEN 
    ((from_id  ='111111111' AND status='R') OR
    (to_id  ='111111111' AND status='S')) THEN 'D'
    END
WHERE primary_key = '236499681204'
AND
    (CASE
    WHEN 
    (from_id='111111111' AND status='A') THEN 'S'
    WHEN 
    (to_id  ='111111111' AND status='A') THEN 'R'
    WHEN 
    ((from_id  ='111111111' AND status='R') OR
    (to_id  ='111111111' AND status='S')) THEN 'D'
    END) is not null 
```

我已经阅读了[MySQL 'Truncated wrong INTEGER value'](https://stackoverflow.com/questions/4946899/mysql-truncated-incorrect-integer-value)和[MYSQL Truncated wrong INTEGER value error](https://stackoverflow.com/questions/7195235/mysql-truncated-incorrect-integer-value-error)的帖子。但它们不适用于我的情况。在这里，`status`是类型`VARCHAR(1)`。

有什么我想念的吗？

**编辑**

这是创建表的查询：

```
CREATE TABLE  `MESSAGES` (
  `primary_key` bigint(12) unsigned NOT NULL AUTO_INCREMENT,
  `from_id` varchar(9) NOT NULL,
  `to_id` varchar(9) NOT NULL,
  `status` varchar(1) NOT NULL,
  PRIMARY KEY (`primary_key`)
) ENGINE=MyISAM AUTO_INCREMENT=123456789876 DEFAULT CHARSET=latin1 
```

请帮忙 ：（

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T07:04:49.057

不是因为比较，`status`而是因为比较

```
(CASE
    WHEN 
    (from_id='111111111' AND status='A') THEN 'S'
    WHEN 
    (to_id  ='111111111' AND status='A') THEN 'R'
    WHEN 
    ((from_id  ='111111111' AND status='R') OR
    (to_id  ='111111111' AND status='S')) THEN 'D'
END) is not null 
```

为了避免错误，将结果`CASE`转换为`CHAR`这样的：

```
CAST( (CASE
    WHEN 
    (from_id='111111111' AND status='A') THEN 'S'
    WHEN 
    (to_id  ='111111111' AND status='A') THEN 'R'
    WHEN 
    ((from_id  ='111111111' AND status='R') OR
    (to_id  ='111111111' AND status='S')) THEN 'D'
END) AS CHAR) is not null 
```

现在它应该可以正常工作了:)

# apache - Apache mod_rewrite：对已经经历过 URL 重写的 URL 执行 http 到 https 重定向

> ID：12731119
> 
> 赞同：0
> 
> 时间：2012-10-04T15:55:54.090
> 
> 标签：apache, mod-rewrite, http-status-code-301

问题如下：

我正在执行 URL 重写以从带有参数的 URL 创建规范的 URL。例如：

```
RewriteRule ^somename/(.*)/(.*.html)$ index.php?pram1=someparam&param2=$1&param3=$2 [QSA,L] 
```

现在，我还要检查页面是否使用 https 协议，如果没有，则进行 301 重定向。

问题：Apache 在使用 REQUEST_URI 时似乎无法识别新的（规范 URL）。相反，REQUEST_URI 返回 index.php?... URL。

这使得无法获取当前（规范 URL）、检查 HTTPS 并在必要时重定向到它。

例如，

```
RewriteCond %{HTTPS} off
RewriteCond %{REQUEST_URI} (somename)
RewriteRule ^(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [R=301] 
```

根本不起作用，因为 (somename) 不在 URI 中（请记住，{REQUEST_URI} 包含原始 URL）。

我可以匹配 QUERY_STRING，但重定向会将我带到原始 URL

```
RewriteCond %{HTTPS} off
RewriteCond %{QUERY_STRING} (param1)
RewriteRule ^(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [R=301] 
```

在过去的一个小时里，我一直在互联网上寻找解决方案，但我想不出什么办法。我想也许有一种方法可以创建一个环境变量来保存新的（规范）URL，但是也没有找到一种方法来做到这一点。

任何可能有帮助的建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:55:13.670

> 根本不起作用，因为 (somename) 不在 URI 中（请记住，{REQUEST_URI} 包含原始 URL）。

不正确，`%{REQUEST_URI}`实际上是当前的 URI，在 URL 文件映射处理管道期间通过 mod_rewite 或其他模块对其进行了任何修改之后。你想要的可能是`%{THE_REQUEST}`：

```
RewriteCond %{HTTPS} off
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /(somename/[^\ ]*)
RewriteRule ^ https://%{SERVER_NAME}/%1 [R=301,L] 
```

但是，我怀疑这不是真正的问题。问题是您放置规则的顺序并且重定向没有`L`标志。这应该做你想要的：

```
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{SERVER_NAME}%{REQUEST_URI} [R=301,L]

RewriteRule ^somename/(.*)/(.*.html)$ index.php?pram1=someparam&param2=$1&param3=$2 [QSA,L] 
```

# database - 数据库 - 候选键和 FD

> ID：12731128
> 
> 赞同：0
> 
> 时间：2012-10-04T15:56:19.563
> 
> 标签：database, functional-dependencies

现在问题要求我找出功能依赖关系和候选键。

当我弄清楚 FD 和候选键时，我有点困惑。根据我的理解，如果“给定 X 的一个值我知道 Y 的一个值”，您可以找到 FD？例如，如果给我一个学生ID，我会知道学生姓名吗？是的。这很简单。

现在对于候选键，我认为它们是可能是主键但必须用作主键的键。

现在我有一个场景：

> 一家职业介绍所正在创建一个数据库来记录面试预约的详细信息。该机构聘用“安置经理”（PLM）协助“候选人”（CND）找工作。每个安置经理都会面试许多候选人。但是，候选人被分配给一位安置经理。这意味着对于候选人的每次任命，它总是与同一个安置经理。任何给定的任命都是在一名候选人和他们指定的安置经理之间进行的。
> 
> 该机构的初始模式是：Appointment(Appt, PLM#, PLMname, CND#, CNDname, CNDaddress, Job)
> 
> Appt 是预约日期和时间。PLM# & PLMname 是安置经理的 ID 和姓名，CND# 是候选人的 ID。CNDname 是候选人的姓名。CNDaddress 是候选人的联系地址。工作是面试中讨论的工作。

因此，对于上述情况，候选键可能是：

```
{PLM# Appt} and {CND#, Appt} 
```

我的问题是我不确定是像上面那样写出来还是只有 1 个候选键

`{PLM#, CND#, Appt}`

FD：

```
PLM# -> PLMName
CND# -> CNDName
CND# -> CNDAddress
CND#, PLM# -> Appt
CND#, Appt -> Job
CND# -> Appt
CND# -> Job
CND# -> PLM# 
```

假设 1 个职位在任命期间讨论 候选人每天只能有 1 个预约

只是想在我正常化之前检查我的 FD。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T06:01:57.997

FD`CND ⟶ Job`是可疑的，尤其是考虑到`CND, Appt ⟶ Job`; 这意味着 CND 永远只能申请或讨论一项工作。

FD`CND ⟶ Appt`是可疑的；这意味着即使有 50 个 PLM，也没有两个可以同时预约。

关于key的问题：两列key中的每一个都是候选key，是不可约的。建议的三列键不是不可约的（因为它可以简化为两个两列候选键中的任何一个）。因此，三列键是（严格）超级键而不是候选键。

# c# - 如果发生异常，如何关闭 WPF 应用程序？

> ID：12731130
> 
> 赞同：0
> 
> 时间：2012-10-04T15:56:28.277
> 
> 标签：c#, wpf, .net-4.0

> **可能重复：**
> [打开消息框时关闭 wpf](https://stackoverflow.com/questions/11828826/shutdown-wpf-while-messagebox-open)

我目前有这样的代码，但问题是即使我在`MessageBox`提供的错误中显示错误后`NLog`，我也想关闭应用程序，以便用户可以解决问题，但应用程序在他们单击消息中的确定后继续盒子。

```
private void Load(string fileName)
    {
        try
        {
            var environments = GetEnvironments(fileName); 
        }
        catch (FileNotFoundException ex)
        {
            logger.Error(ex.StackTrace);
        }
        catch (Exception ex)
        {
            logger.Error(ex.StackTrace);
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T15:58:11.723

异常已处理，因此不会冒泡。

你有几个选择：

*   记录后重新抛出异常，导致异常继续冒泡（并假设没有其他异常处理程序）并导致进程中止并出现未处理的异常：

    ```
    throw; 
    ```

*   显式关闭使用[`Environment.Exit`](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)

    ```
    Environment.Exit(-1); 
    ```

*   另一种选择是[Application.Shutdown](http://msdn.microsoft.com/en-us/library/ms597013.aspx)：

    ```
    Application.Current.Shutdown(); 
    ```

重新抛出将向用户显示错误。其他两个选项不会。

# node.js - Node.js - 是否可以使用两种模板语言？

> ID：12731131
> 
> 赞同：0
> 
> 时间：2012-10-04T15:56:33.510
> 
> 标签：node.js

我已经使用 ejs 视图引擎构建了我的节点项目。我想将博客模块添加到我的网站。我选择使用玉模板语言的[诗人。](http://jsantell.github.com/poet/)

是否可以直接将这些玉文件与我的 ejs 文件一起使用，或者我是否需要手动将玉文件转换为 ejs。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:22:01.330

你当然可以。只需使用适当的模板引擎来处理相关文件（可能由文件扩展名或基于位置的规则确定，例如“/blog 中的所有条目都是 Jade”）。

# jquery - 搜索工具栏文本框未出现在 jqGrid 中

> ID：12731133
> 
> 赞同：0
> 
> 时间：2012-10-04T15:56:44.113
> 
> 标签：jquery, jquery-plugins

第一次尝试jqGrid。我需要显示工具栏搜索过滤器。但它永远不会在工具栏中显示搜索文本框。

下面是我的代码，

```
 <link rel="stylesheet" type="text/css" media="screen" href="css/ui.jqgrid.css" />

<link rel="stylesheet" type="text/css" media="screen" href="css/smoothness/jquery-ui-1.8.24.custom.css" />

<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>

<script src="js/jquery.jqGrid.min.js" type="text/javascript"> </script>

<script src="js/grid.locale-en.js" type="text/javascript"></script>

<script type="text/javascript">

    jQuery().ready(function(){
    jQuery("#list2")
            .jqGrid({
                url: 'server.php',
                datatype: "json",
     colNames: ['Product Id', 'Product Name', 'Supplier Id', 'Unit Price'],
                colModel: [{
                    name: 'productid',
                    index: 'productid',
                    search: true,
                    width: 55
                }, {
                    name: 'productname',
                    index: 'productname',
                    width: 90
                }, {
                    name: 'supplierid',
                    index: 'supplierid',
                    width: 100
                }, {
                    name: 'unitprice',
                    index: 'unitprice',
                    width: 80,
                    align: "right"
                }
                ],
                rowNum: 10,
                rowList: [10, 20, 30],
                pager: '#pager2',
                sortname: 'productid',
                viewrecords: true,
                sortorder: "desc",
                caption: "JSON Example"
            })
    });

    jQuery("#list2")
            .jqGrid('navGrid', '#pager2', {
                edit: false,
                add: false,
                del: false
            });

jQuery("#list2").jqGrid
  ('filterToolbar',{stringResult: true,searchOnEnter : false});

</script> 
```

我使用的是 4.4.1 版本。我在下载时检查了自定义附加方法复选框。

我是否缺少任何 js 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T13:31:27.267

非常愚蠢的错误。我将对 filterToolbar 的调用置于就绪函数之外。它应该在 ready 函数中。

固定的

很抱歉这个问题，但我仍然不会删除它，因为我猜这种错误很常见......所以它对那些有帮助...... ;-)

# c++ - 两个相同的（网络）调用。如何等待最快，并丢弃最慢？

> ID：12731134
> 
> 赞同：0
> 
> 时间：2012-10-04T15:56:46.703
> 
> 标签：c++, c++11, stdthread

在 c++11 中，如何实现一个程序，该程序执行两个相同类型的昂贵（网络）调用，然后只等待较快的结果，而不是等待和丢弃较慢的结果。std::thread 不能被中断并且不返回方便的 std::future。并且返回未来的 std::async 既不能中断也不能分离。

两个主要问题是： - 更快结果到达时的通知。- 终止（和清理）较慢的线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:35:10.703

NoSenseEtAl 提供了以下链接：

[http://fpcomplete.com/functional-patterns-in-c/](http://fpcomplete.com/functional-patterns-in-c/)

Bartosz 提供了一些非常通用的可组合异步 API 的示例代码。我无耻地将其剥离为仅我需要（并且可以理解）的内容。只是“异步或组合器”：

```
#include <functional>
#include <iostream>
#include <string>

#include <memory>
#include <algorithm>
#include <ctype.h>

#include <thread>
#include <mutex>
#include <chrono>

#include <random>

using namespace std;

//--------
// Helpers
//--------

void tick(int n)
{
    for(int i = 0; i < n; ++i)
    {
        cout << i << endl;
        this_thread::sleep_for(chrono::seconds(1));
    }
}

//-------
// Async
//-------

template<class A>
struct Async {
    virtual ~Async() {}
    virtual void andThen(function<void(A)>) = 0;
};

//-------
// Monoid
//-------

template<class A>
struct Mplus : Async<A>
{
    Mplus(unique_ptr<Async<A>> asnc1, unique_ptr<Async<A>> asnc2) 
    : _asnc1(move(asnc1)), _asnc2(move(asnc2)), _done(false)
    {}
    ~Mplus() {}
    void andThen(function<void(A)> k)
    {
        _asnc1->andThen([this, k](A a)
        {
            lock_guard<mutex> l(_mtx);
            if (!_done)
            {
                _done = true;
                k(a);
            }
        });
        _asnc2->andThen([this, k](A a)
        {
            lock_guard<mutex> l(_mtx);
            if (!_done)
            {
                _done = true;
                k(a);
            }
        });
    }
    unique_ptr<Async<A>> _asnc1;
    unique_ptr<Async<A>> _asnc2;
    bool _done;
    mutex _mtx;
};

template<class A>
unique_ptr<Async<A>> mplus(unique_ptr<Async<A>> asnc1, unique_ptr<Async<A>> asnc2)
{
    return unique_ptr<Async<A>>(new Mplus<A>(move(asnc1), move(asnc2)));
}

//----------------
// Fake async APIs
//----------------

void getStringAsync(string s, function<void(string)> handler)
{
    thread th([s, handler]()
    {
        cout << "Started async\n";

        size_t sleep = rand () % 10;
        this_thread::sleep_for(chrono::seconds(sleep));

        handler("Done async: " + s);
    });
    th.detach();
}

struct AsyncString : Async<string>
{
    AsyncString(string s) : _s(s) {}
    void andThen(function<void(string)> k)
    {
        getStringAsync(_s, k);
    }
    string _s;
};

unique_ptr<Async<string>> asyncString(string s)
{
    return unique_ptr<Async<string>>(new AsyncString(s));
}

void testOr()
{
    // Test or combinator / mplus
    auto or = mplus<string>(asyncString(" Result One "), asyncString(" Result Two "));
    or->andThen([](string s)
    {
        cout << "Or returned : " << s << endl;
    });

    tick(10);
}

void main()
{
    srand ( time(NULL) );

    testOr();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:38:25.593

您必须使用操作系统提供的工具来发出“真正的”异步操作，这些操作在完成时会发送某种形式的通知。通常此类操作可以在完成之前终止；如果他们不能，您将不得不找到另一种机制，或者只是让他们完成并忽略结果。

# ios - xcode xib 检查网点是否仍然有效

> ID：12731136
> 
> 赞同：3
> 
> 时间：2012-10-04T15:56:55.540
> 
> 标签：ios, xcode, xib

在 iOS 开发期间，我每隔一段时间就必须从一个班级中删除一个以前的 IBOutlet。但它们不会在 XIB 文件中被删除。检查文件会显示感叹号，告诉您连接不再有效。

由于我的项目很大，我并不总是记得从所有 XIB 文件中删除引用。有没有办法让编译器检查所​​有出口是否仍然有效？

编辑：“Interface Builder XIB 编译器”下“显示错误”、“显示通知”和“显示警告”的构建设置标志设置为“是”。

# android - 导致 ANR 的 android 服务

> ID：12731139
> 
> 赞同：2
> 
> 时间：2012-10-04T15:57:05.447
> 
> 标签：android, service, broadcastreceiver

我有一个应用程序，它从启动接收器启动一项服务，该服务会定期从手机的 Sqlite DB 上的表中删除行。BootReceiver 工作正常。它实例化的服务有一个无限循环，该循环由 Thread.sleep 暂停 30 秒（用于测试），最终它将设置为每隔几个小时左右。它确实删除了行，但我不相信它是每 30 秒一次，并且最终它会导致 ANR。这一切的实现方式似乎有点粗糙。有没有更好的方法来实现我正在做的事情？如果不是，我怎么能停止 ANR，因为我认为服务不必是异步的，只需网络调用等。

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class MyBootReceiver extends BroadcastReceiver {   

    @Override
    public void onReceive(Context context, Intent intent) {

     Intent myIntent = new Intent(context, SendOutstandingTransactions.class);
     myIntent.setAction("com.carefreegroup.startatboot.MyService");
     context.startService(myIntent);

    }

}

import org.joda.time.DateTime;

import android.app.Service;
import android.content.Intent;
import android.database.Cursor;
import android.os.IBinder;
import android.util.Log;

public class SendOutstandingTransactions extends Service {

    private static final String TAG = SendOutstandingTransactions.class.getSimpleName();
    NfcScannerApplication nfcscannerapplication;
    Cursor c;

    @Override
    public void onCreate() {
        Log.e(TAG, "inside onCreate of SendOutstandingTransactions");
        nfcscannerapplication = (NfcScannerApplication)getApplication();
        super.onCreate();
    }

    @Override
    public void onDestroy() {
        Log.e(TAG, "inside onDestroy of SendOutstandingTransactions");

        super.onDestroy();
    }

    @Override
    public void onStart(Intent intent, int startId) {
        super.onStart(intent, startId);
        Log.e(TAG, "inside onStart of SendOutstandingTransactions");

        do{
        DateTime now = new DateTime();
        //nfcscannerapplication.loginValidate.deleteTransactionsOlderThanThreeDays(now);
        nfcscannerapplication.loginValidate.deleteTableTransactions();
        Log.e(TAG, "just called housekeeping method in service");
        try {
            Thread.sleep(30000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        }while(true); 

    }// end of onStart

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }

} 
```

## **AndroidManifest 文件：**

```
<service android:name=".SendOutstandingTransactions" >
            <intent-filter>
                <action android:name="com.carefreegroup.startatboot.MyService" />
            </intent-filter>
        </service>

        <receiver
            android:name=".MyBootReceiver"
            android:enabled="true"
            android:exported="false" >
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED" />
            </intent-filter>
        </receiver> 
```

## 我如何启动服务

```
// get a Calendar object with current time
             Calendar cal = Calendar.getInstance();
             // add 5 minutes to the calendar object
             cal.add(Calendar.MINUTE, 1);
             Intent intent = new Intent(getApplicationContext(), AlarmReceiver.class);
             intent.putExtra("alarm_message", "sending outstanding transactions");
             // In reality, you would want to have a static variable for the request code instead of 192837
             PendingIntent sender = PendingIntent.getBroadcast(getApplicationContext(), 192837, intent, PendingIntent.FLAG_UPDATE_CURRENT);

             // Get the AlarmManager service
             AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
             //am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), sender);
             //86400000 = 24 hours
             //43200000 = 12 hours
             //3600000 = 1hr
             //1800000 = 30 mins
            // 600000 = 10 mins
             //300000 = 5 mins

             am.setRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), 300000 , sender); 
```

## 警报接收器：

```
public class AlarmReceiver extends BroadcastReceiver {

 @Override
 public void onReceive(Context context, Intent intent) {

   try {

     Bundle bundle = intent.getExtras();
     String message = bundle.getString("alarm_message");
    // Toast.makeText(context, message, Toast.LENGTH_SHORT).show();
     Intent myIntent = new Intent(context, SendOutstandingTransactions.class);
     myIntent.setAction("com.carefreegroup.rr3.startatboot.MyService");
     context.startService(myIntent);

    } catch (Exception e) {
     Toast.makeText(context, "There was an error somewhere, but we still received an alarm", Toast.LENGTH_SHORT).show();
     e.printStackTrace();

    }
 }

} 
```

## 服务：

```
 public class SendOutstandingTransactions extends IntentService {

        private static final String TAG = SendOutstandingTransactions.class.getSimpleName();

instance variables

        @Override
        public void onCreate() {
            super.onCreate();

        }

        @Override
        protected void onHandleIntent(Intent intent) {

    //do something

        }//end of onHandleIntent

        public SendOutstandingTransactions() {
            super("SendOutstandingTransactions");

        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:26:44.520

> 请注意，服务与其他应用程序对象一样，在其托管进程的主线程中运行。这意味着，如果您的服务要执行任何 CPU 密集型（例如 MP3 播放）或阻塞（例如网络）操作，它应该生成自己的线程来完成这项工作。更多信息可以在进程和线程中找到。IntentService 类可作为 Service 的标准实现使用，它有自己的线程来安排要完成的工作。

来源：http: [//developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)

**解决方案：**

将您的代码移动到专用线程。这可以通过使用例如`AsyncTask`类来完成。

# authentication - Spring Security 认证异常处理

> ID：12731144
> 
> 赞同：13
> 
> 时间：2012-10-04T15:57:21.803
> 
> 标签：authentication, exception-handling, spring-security

我有一个使用 Spring Security 3.0.x 的应用程序。我有一个习惯`AuthenticationProvider`：

```
public class AppAuthenticationProvider implements AuthenticationProvider {
    @Override
    public Authentication authenticate(Authentication authentication) throws AuthenticationException {
        ...
        if (!check1()) throw new UsernameNotFoundException();
        if (!check2()) throw new DisabledException();
        ...
    } 
```

我想针对每个异常发送自定义响应代码，例如 UsernameNotFoundException 的 404、DisabledException 的 403 等。现在我的 spring 安全配置中只有 authentication-failure-url ，所以我在身份验证中的每个异常上都重定向到它()。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-05T14:59:35.987

身份验证失败处理程序：

```
public class CustomAuthenticationFailureHandler extends SimpleUrlAuthenticationFailureHandler {

@Override
public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException, ServletException {
  super.onAuthenticationFailure(request, response, exception);
  if(exception.getClass().isAssignableFrom(UsernameNotFoundException.class)) {
    showMessage("BAD_CREDENTIAL");
  } else if (exception.getClass().isAssignableFrom(DisabledException.class)) {
    showMessage("USER_DISABLED");
  }
} 
```

配置 ：

```
<bean id="customAuthenticationFailureHandler"
      class="com.apackage.CustomAuthenticationFailureHandler">
    <property name="defaultFailureUrl" value="/index.jsp"/>
</bean>
<security:http auto-config="true">
  <security:form-login default-target-url="/welcome.jsp" authentication-failure-handler-ref="customAuthenticationFailureHandler" />
</security:http> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-04T19:31:52.367

提供有关身份验证失败原因的详细信息通常是一个坏主意，因为它可以为攻击者提供有用的信息。例如，它可以允许他们探测有效的帐户名称。

如果您需要自定义事物，那么`authentication-failure-url`您可以使用`authentication-failure-handler-ref`注入自定义[`AuthenticationFailureHandler`](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/core-web-filters.html#form-login-flow-handling)bean 而不是使用 bean，您可以在其中根据异常实现不同的行为。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-17T14:53:13.940

在 jsp 页面中使用以下标签进行自定义身份验证。

```
<c:if test="${sessionScope[\"SPRING_SECURITY_LAST_EXCEPTION\"].message eq 'Bad credentials'}">
Username/Password entered is incorrect.
</c:if>
<c:if test="${sessionScope[\"SPRING_SECURITY_LAST_EXCEPTION\"].message eq 'User is disabled'}">
Your account is disabled, please contact administrator.
</c:if>
<c:if test="${fn:containsIgnoreCase(sessionScope[\"SPRING_SECURITY_LAST_EXCEPTION\"].message,'A communications error has been detected')}">
Database connection is down, try after sometime.
</c:if> 
```

还包括以下标签库以正常工作

```
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="sec"%> 
```

...

# django-forms - 在 Django 表单中验证表单后更改字段的值

> ID：12731147
> 
> 赞同：0
> 
> 时间：2012-10-04T15:57:24.360
> 
> 标签：django-forms

在 Django Form POST 方法中，我想根据`is_valid()`结果更改字段值。因此，我无法更改无法计算（也无法访问）的`clean_*`方法中的值。`is_valid()`

基本上我需要根据结果更改 HTML 的显示方式（`is_cool`在下面的示例中）`is_valid()`。如果需要，此值需要由 UI 更改。在模板中，我有类似的内容：

```
{% if record.is_cool %} something {% endif %} 
```

这是可能的还是我应该改变模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:10:26.257

UI 必须正确更新字段值，就像现在所做的那样。

Django中的View可以在不影响表单的情况下传递条件，通过传递给函数`is_cool`的dict传递给模板。`render`

查看代码片段：

```
return render(request, self.template_name, {
    'record': form,
    'is_cool': True,
}) 
```

然后模板代码将更改为：

```
{% if is_cool %} something {% endif %} 
```

注意模板中的变量`is_cool`和`record.is_cool`是不同的。

# java - Struts2 i18n - 是否可以轻松查看丢失的翻译？

> ID：12731157
> 
> 赞同：0
> 
> 时间：2012-10-04T15:57:45.617
> 
> 标签：java, internationalization, struts2

我使用 struts2 属性文件来提供对多种语言的支持，并且效果很好。

总是很容易忘记某些 JSP 中硬编码的文本或未正确翻译的错误。

有没有一种简单的方法来可视化这一点，例如用“ZZZ”替换所有翻译的项目，因此我们只会看到没有提供翻译的地方？

一个想法是以某种方式动态地（在运行时）用“ZZZ”替换属性文件中的所有文本项 - 有没有一种简单的方法可以做到这一点？我的意思是覆盖所有翻译的项目（不触及文件本身，只是在内存中）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:06:16.683

我们只需创建一个属性文件，其值设置为类似 ?es_firstNameLabel 等，并设置语言环境以使用该属性文件。然后你在你的应用程序中查看英语（或任何你的母语）。它很丑，但这很好——它应该很丑，这样你的东西就更容易展示出来。

不幸的是，没有真正简单的方法来自动化检查部分，您只需要一个一个地回归您的页面。

当一切都说完了，你可以回去开始用适当的值替换 ?es_propertyLabel 东西，所以当你开始创建新的语言条目时它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:20:28.387

您指的是一个称为伪构建的概念。通常不替换，而是将前缀和后缀添加到资源字符串（属性文件中的值）并测试应用程序是否存在错误。

不幸的是，这只会给你硬编码字符串缺陷的子集，因为几乎没有办法测试所有可能的执行路径。当然，在测试过程中很容易忽略 alt 和 title 属性的内容——你可能很难注意到这个问题。

老实说，没有简单的方法可以发现代码中的 i18n 错误。为此，您可能需要运行一些商业工具，例如 Globylizer，或者开发自己的工具。如果您只关注硬编码字符串（坦率地说，这只是问题的一部分），您可能会破解一些正则表达式来查找开始和结束标记之间的文本，如果它不是类似的东西`<s:text>`或您用于翻译的任何东西，则提交缺陷。

# c# - 如何在多层应用程序中向用户显示异常详细信息以便解决

> ID：12731158
> 
> 赞同：2
> 
> 时间：2012-10-04T15:57:47.553
> 
> 标签：c#, entity-framework, error-handling, service-layer, data-layer

我们的服务层中有以下代码，我们使用 EF 将新用户添加到数据库中。

```
 public User AddUser(User user)
    {
        using (var context = DataObjectFactory.CreateContext())
        {
            var userEntity = Mapper.Map(user);

            context.AddObject("UserEntities", userEntity);

            context.SaveChanges();

            return Mapper.Map(userEntity);
        }         
    } 
```

这由服务层通过以下方法调用：

```
 public UserResponse GetSubmitUser(UserRequest request)
    {
        var response = new UserResponse(request.RequestId);

        var user = Mapper.FromDataTransferObject(request.User);

        response.User = Mapper.ToDataTransferObject(UserDao.AddUser(user));

        return response;
    } 
```

在到达 AddUser 之前，我们会进行某些客户端和服务器验证，但是我不确定如何处理未处理的异常。

例如，如果 context.SaveChanges() 以某种方式抛出错误，我们如何将错误详细信息返回到表示层？

我正在考虑将 try / catch 放在 AddUser 中，如下所示：

```
 public User AddUser(User user)
    {
        try
        {
            using (var context = DataObjectFactory.CreateContext())
            {
                var userEntity = Mapper.Map(user);

                context.AddObject("UserEntities", userEntity);

                context.SaveChanges();

                return Mapper.Map(userEntity);
            }  
        }
        catch (Exception)
        {
            return ??
        }      
    } 
```

但是 AddUser 的返回类型是 User 并且我不确定发生异常时应该返回什么。如果我可以将异常详细信息返回给 UserResponse 方法，我可以在我们的响应对象中填充一些字段，这些字段用于保存错误详细信息，但现在确定从 catch 部分中返回什么。

我试图了解如何识别应该在多层应用程序中捕获和处理的异常，一个具有数据访问层、服务层、表示层等的异常。主要是想弄清楚如何向用户展示异常详细信息解析度。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:20:30.823

我认为“BusinessExceptions”是您正在寻找的东西。

在 n 层应用程序中，从服务层获取或创建业务规则异常是很常见的。我猜您正在尝试使用您的示例验证一些业务规则，也许用户名是有效的，或者它在数据库中尚不存在。

对于这类问题，我总是使用 FaultExceptions 和自定义对象向客户端发送“可理解”的消息。这样我就可以区分系统异常、错误异常和业务规则异常（用户想知道的那些）。

这就是我通常的做法。我有一个 BusinessFault 对象，其中包含将由客户端处理并在必要时向用户显示的业务规则被破坏的数据：

```
[DataContract]
public class BusinessFault
{
    [DataMember]
    public BusinessFaultType Type { get; set; }

    [DataMember]
    public string Details { get; set; }

    [DataMember]
    public ErrorCode ErrorCode { get; set; }

    public BusinessFault(BusinessFaultType type, ErrorCode errorCode)
    {
        Type = type;
        ErrorCode = errorCode;
    }

    public BusinessFault(BusinessFaultType type, string details, ErrorCode errorCode)
        : this(type, errorCode)
    {
        Details = details;
    }

} 
```

因此，每当我需要检查规则时，我都会像这样使用它（使用您的示例）：

```
public void AddUser(User user)
{
if(!IsValidUser(user))
 throw new FaultException<BusinessFault>(new BusinessFault(BusinessFaultType.Validation, "Username",ErrorCode.AlreadyExists); 

using (var context = DataObjectFactory.CreateContext())
    {
        var userEntity = Mapper.Map(user);

        context.AddObject("UserEntities", userEntity);

        context.SaveChanges();

        return Mapper.Map(userEntity);
    } 
} 
```

在我的服务合同中，我应该将我的 BusinessFault 指定为 knowntype。这样，这些故障将到达客户端：

```
 [OperationContract]
    [FaultContract(typeof(BusinessFault))]
    void AddUser(User user); 
```

所以在客户端，我只需要一个针对 BusinessFault 的 try-catch：

```
try
{
    //WebService call
}
catch (FaultException<BusinessFault> ex)
{
var exception = ex.ToBusinessExeption();  //I use extensions Methods to convert it in a custom Exception with the parameters I sent. 
            throw exception;
} 
```

有一篇非常好的文章：[http ://www.c-sharpcorner.com/UploadFile/afenster/wcf-error-handling-and-faultexceptions/](http://www.c-sharpcorner.com/UploadFile/afenster/wcf-error-handling-and-faultexceptions/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:02:54.547

如果你打算对它做点什么，你只需要在你的低层捕获异常。例如，您可能会捕获它，写入异常日志，然后重新抛出它。

至于返回值，在我看来，你不应该从多个地方返回。

相反，我认为这更好：

```
User user = null;

try
{
   //Try to set up user
}
catch(Exception ex)
{
   //Log exception
   throw;
}

return user; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:03:38.197

> 但是 AddUser 的返回类型是 User 并且我不确定发生异常时应该返回什么

这取决于 - 通常，您**不想返回值**，但您将记录异常然后调用`throw;`（或者您将抛出您自己的异常，该异常是包装原始异常，您的选择）并将异常冒泡，直到你会在某个地方捕捉到它，向用户显示好消息，然后记录它。

如果您想向用户显示好消息（和/或在上层某处进行日志记录），使用`throw new ApplicationException("Failed to create user", ex);`这种方式您可以获得好消息，并使用堆栈跟踪冒泡异常，以便您稍后理解并修复问题.

在某些情况下，您可以返回 null 并只记录异常。通常，当你不想冒泡异常时，如果它不是关键的，你不想因为它退出当前代码路径，你就会这样做。

祝你好运！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T16:06:02.150

您不需要在数据访问层捕获异常，让它们自然抛出。规则是，如果您需要对其进行业务处理，您只需捕获异常。如果没有，那就顺其自然吧。

因此，所有异常都将捕获到应用程序的顶层，以便记录故障排除。

如果您的应用程序是 Web，您可以使用一些支持日志处理程序（如[Elmah](http://code.google.com/p/elmah/) ）的日志库来拦截请求级别。

# c# - 无法将自定义值插入标识列 - 实体框架

> ID：12731163
> 
> 赞同：5
> 
> 时间：2012-10-04T15:58:05.543
> 
> 标签：c#, entity-framework, entity-framework-4, entity-framework-4.1, identity

我正在尝试关闭身份以插入我自己的值，我遵循的步骤

1.  将标识列 的属性`StoredGeneratedPattern`值更改为`None`
2.  通过以 xml 格式打开将属性`StoredGeneratedPattern`值更改为 EDMX 文件`None`

尝试使用以下代码

```
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.RequiresNew))
{
   int k = Context.ExecuteStoreCommand("SET IDENTITY_INSERT dbo.client ON");
   Context.ClientInfoes.Add(testclient);
   result = Context.SaveChanges();
   int j = Context.ExecuteStoreCommand("SET IDENTITY_INSERT dbo.client OFF");
   scope.Complete();
} 
```

但我仍然收到错误

> 当 IDENTITY_INSERT 设置为 OFF 时，无法在表中插入标识列的显式值

我错过了什么吗？还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-19T20:33:10.290

[请参阅此处](https://stackoverflow.com/questions/7714812/why-doesnt-set-identity-insert-off-work-for-me-in-ef-4-1)的类似问题。

埃兰加解释说：

> `ExecuteSqlCommand`将打开连接，执行 sql 然后关闭它。因此，您的下一个命令将使用不同的连接执行。

ExecuteSqlCommand 方法类似于 ExecuteStoreCommand。

Daniel Liuzzi 解释说：

> ...诀窍是将所有内容打包到一个命令中...

例如，

```
string sqlStatement = "SET IDENTITY_INSERT clientInfo ON;" +
string.Format("INSERT clientInfo (ClientInfoId, Column1, Column2) VALUES ({0}, {1}, {2}, '{3}');", testClient.ClientInfoId, testClient.Column1, testclient.Column2) +
"SET IDENTITY_INSERT clientInfo OFF";
context.ExecuteStoreCommand(sqlStatement); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T11:12:14.220

当您调用 TransactionScope.Complete 时，数据存储在数据库中，而不是在您调用 ClientInfoes.Add 或 Context.SaveChanges 时。所以你可以看到，当调用插入语句时，你已经关闭了 IDENTITY INSERT。

简单地重新排列东西...

```
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.RequiresNew))
{
   int k = Context.ExecuteStoreCommand("SET IDENTITY_INSERT dbo.client ON");
   Context.ClientInfoes.Add(testclient);
   result = Context.SaveChanges();
   scope.Complete();
   int j = Context.ExecuteStoreCommand("SET IDENTITY_INSERT dbo.client OFF");
} 
```

更好的是，在事务之外对 IDENTITY_INSERT 进行所有更改，因为它的值是特定于会话的（每个会话只能为一个表打开它）。

# haskell - 使用 Parsec 将文本拖放到特殊字符

> ID：12731168
> 
> 赞同：2
> 
> 时间：2012-10-04T15:58:26.397
> 
> 标签：haskell, parsec

我是 Haskell 和 Parsec 的新手——如果这个问题微不足道，我深表歉意。

我想解析结构如下的文本行：

```
<Text to be dropped> <special character (say "#")> <field 1> <comma> <field 2>
<comma> <field 3> <special character 2 (say "%")> <Text to be dropped> 
```

我希望我的解析器在开头和结尾丢弃“要删除的文本”，并保留字段的内容。我的主要问题是理解如何编写一个解析器，将所有内容都删除到某个特殊字符。

似乎有用的库中的解析器是 anyChar、manyTill 和 oneOf，但我不明白如何组合它们。我将不胜感激任何简单的例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:31:21.613

在编写 Parsec 代码时，首先写出要以[BNF](http://en.wikipedia.org/wiki/Ebnf)形式解析的语法很有用，因为用 Parsec 编写的解析器最终看起来非常像语法。

让我们试试：

```
line ::= garbage '#' field ',' field ',' field '%' garbage 
```

在上面的产生式中，我们假设一个产生式名为`garbage`，其实际定义将取决于您实际想要删除的文本。同样，我们假设一个名为`field`. 现在让我们把这个产生式写成解析码：

```
line = do
  garbage
  char '#'
  field1 <- field
  char ','
  field2 <- field
  char ','
  field3 <- field
  char '%'
  garbage
  return (field1, field2, field3) 
```

这段代码读起来和 BNF 完全一样。本质的区别是一些子生成的结果是命名的，这样我们就可以返回一个从这些结果构建的值（在这种情况下是一个元组）。

现在我不知道你对垃圾的概念是什么，但为了举例，让我们假设你的意思是任何空格。然后你可以定义`garbage`如下：

```
garbage = many space 
```

（或者，或者，碰巧 parsec 已经有一个用于解析零个或多个空格的组合器，称为`spaces`）。如果垃圾可以是`#`分隔符以外的任何内容，那么您可以说

```
garbage = many (noneOf "#") 
```

这条线将咀嚼所有输入，直到第一个'#'除外。无论哪种方式，`garbage`结果都会产生任何值，因为您没有将名称绑定到将被丢弃的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:49:21.010

或者，您可以使用应用解析器：

```
import Control.Applicative
import Text.Parsec
import Text.Parsec.String

type Field = ()                 --your type here

field = string "()" *> pure ()  --your parser here

parser :: Parser (Field, Field, Field)
parser = manyTill anyChar (char '#') *>
         ((,,) <$> (field <* char ',')
               <*> (field <* char ',')
               <*> (field <* char '%')) 
```

# java - 如何设置 CLASSPATH 以加载相对于 jar 文件的资源？

> ID：12731169
> 
> 赞同：0
> 
> 时间：2012-10-04T15:58:26.737
> 
> 标签：java, classpath

我有一些 jar 文件需要在启动时读取文件。这些文件位于 jar 文件旁边的目录中。这是我的目录列表的样子：

```
code.jar
config/
       confifile.cfg 
```

然后，在命令行提示符中，我将类路径设置为：

```
set CLASSPATH=./ext/*;./* 
```

然后我运行程序，但它一直抱怨找不到“configfile.cfg”。

> /config/configfile.cfg 文件未找到！

此错误来自此代码：

```
try {
    r = new BufferedReader(new FileReader((String)botinfilename));
    fileName=(String)botinfilename;
}
catch (FileNotFoundException e) {
    System.err.println(botinfilename + " is not found");
} 
```

我注意到如果我将 /config 目录放在 jar 文件中，它会起作用。但是，如果我将其删除并将其放在 jar 旁边，则找不到配置文件。

是否有一些java设置技巧可以使这项工作？

## 编辑1：

我像这样启动我的程序：

> java启动程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T18:18:51.993

为了简短起见，我刚刚添加了“-cp”JVM 选项。我的问题是我需要将根目录（我的 jar 和资源所在的位置）添加到我的类路径中。以前我刚刚添加了带有 * 通配符的罐子。

```
java -cp PATH_ROOT_DIR/;PATH_TO_ROOT_DIR/*;PATH_TO_ROOT_DIR/ext/* StartProgram 
```

或者你可以设置类路径

```
set CLASSPATH=./;./ext/*;./* 
```

# php - PHP 调用变量

> ID：12731171
> 
> 赞同：-1
> 
> 时间：2012-10-04T15:58:30.873
> 
> 标签：php, arrays, call

我想从另一个 PHP 页面调用变量。例子：

我有一个名为**index.php**的 PHP 页面，并且有一个类似的数组：

```
<$php

$arr = array("banana","apple","orange");

$> 
```

我已经创建了另一个 PHP 页面： home.php 并且我想将数组 ($arr) 从 **index.php**调用 到 **home.php**。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:00:58.337

如果这是 index.php 的全部内容，那么您需要将第一页包含到第二页中，因此在 home.php 中您将拥有

```
 <?php
      require_once('index.php');
      print_r($arr);
 ?> 
```

请记住，如果您这样做，如果您需要 index.php，它将包含并尝试从那里运行所有代码。这意味着如果 index.php 引用 home.php，并且您使用上面的示例，您将发现自己处于一个无休止的循环中。但是，如果 index.php 仅包含您在上面放置的代码，则应该可以正常工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:01:55.810

我想假设`index.php`和`home.php`是不同的页面，您`can not`在另一个页面中包含一个

然后你可以使用会话：

`index.php`

```
session_start();
$_SESSION['array'] = array("banana","apple","orange"); 
```

`home.php`

```
session_start();
print_r($_SESSION['array']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:03:13.277

你要么使用`$_SESSION` `require`要么`include`

**主页.php**

```
<?php

include 'index.php';

print_r($array);

?> 
```

或者

```
<?php

require('index.php');
// you can also use require_once to prevent looping

print_r($array);

?> 
```

# cuda - Cuda 流数据独立性

> ID：12731172
> 
> 赞同：2
> 
> 时间：2012-10-04T15:58:31.410
> 
> 标签：cuda, cuda-streams

有人可以解释并发 Cuda 流中的数据独立性要求吗？假设我想在 8 个并发流中运行以下内核

```
Kernel<<<blocks, threads>>>(float *readOnlyInput, float *output); 
```

所有流都可以读取相同的 *readOnlyInput 并写入不同的 *output 数组吗？

或者为了实现并发，他们还需要从不同的内存位置读取数据？

上面的伪代码片段会并发执行，还是需要 *readOnlyInput+i*size 来保证并发？

```
cudaStream_t stream[8];

int size = 1000;//some array size

int blocks =2, threads=256;//some grid dims

for (int i = 0; i < 8; ++i){

    cudaStreamCreate(&stream[i]);

}
for (int i = 0; i < 8; ++i){

    Kernel<<<blocks, threads, stream[i]>>>(float *readOnlyInput, float *output + i*size);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:53:35.367

您可以安全地从不同流中的多个独立内核读取相同的数据，只要有足够的同步以确保在任何内核启动之前完全写入数据，并且在所有内核启动之前不会再次覆盖数据内核已经完成。

# c++ - 如何在 Blackberry Cascades qml 和 qt 中点击列表项组件

> ID：12731175
> 
> 赞同：0
> 
> 时间：2012-10-04T15:58:38.227
> 
> 标签：c++, qt, listview, qml, blackberry-10

我之前用其他措辞问过这个问题，但也许这个问题措辞不好，似乎没有人回答。我一直在寻找一个工作示例来显示我的问题的答案，但我找不到任何答案。我真的需要知道这个问题的答案。

在 Blackberry Cascades、QML、QT 和 C++ 中，我如何回应有人点击列表中的项目？

答案是否与 TapHandler 和 ListView 相关？如果是这样，有人可以告诉我如何连接这两者，因为我在互联网上找不到任何例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:45:30.247

这是一个样板示例，类似于我在 Cascades 应用程序中使用的代码：

```
ListView { 

dataModel: XmlDataModel { 
    source: "data/items.xml"
          function doResponse(){} 
} 

listItemComponents: [ 
    ListItemComponent { 
        type: "item" 
            StandardListItem {
            id: listItem
            title: ListItemData.title 

            onTouch: { 
                if (event.isUp()){               
                    listItem.ListItem.view.dataModel.doResponse();                
                } 
            } 
        } 
    }     
]   
} 
```

# oop - 设计模式帮助 - 组合和代码重用

> ID：12731179
> 
> 赞同：0
> 
> 时间：2012-10-04T15:59:00.040
> 
> 标签：oop, design-patterns, composition

我似乎总是依赖工厂模式/继承来进行代码重用，并且一直在阅读关于组合而不是继承的内容，并且确实看到了松散耦合的好处。您肯定会通过继承获得依赖关系。所以我试图围绕“处理”对象的模式来思考。

他们基本上都是，

*   从数据库中获取他们的“环境变量”，
*   获取文件列表，
*   处理/转换每个文件（想想将 XML 转换为 CSV），这需要
    *   逐行读取文件
    *   将文件逐行写入另一种格式
    *   更新状态（将状态写入数据库）

获取文件列表可能意味着从本地目录获取文件列表，或者从远程 FTP 站点获取文件列表。

我正在努力使用 compositoin 的是代码重用。使用继承，如果我有一个基抽象类，我可以将我的 GetEnvironment、UpdateStatus、方法放在基类中，子类将免费获得它们。我如何能够使用组合获得这样的代码重用？我可以有辅助类，但我基本上会在每个“流程”类中重复这些辅助类的样板使用。如有必要，我可以编写一些伪代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:05:59.140

鉴于问题中的详细信息，我的解决方案如下：

*   环境
    *   包含环境详细信息的域对象。
*   EnvironmentDAO 和 DBEnvironmentDAO
    *   用于构建 Environment 域对象的接口和 DB 支持的实现。
*   AToB转换器
    *   获取文件并引用环境对象
    *   执行转换，写入另一个文件并更新数据库中的状态
*   启动器
    *   获取文件列表。
    *   使用 DAO 从数据库中检索环境。
    *   采用可扩展机制（如 ExecutorService）并行运行 AToBConverters。

# php - PHP Forms：使用验证码发布到绝对路径

> ID：12731185
> 
> 赞同：0
> 
> 时间：2012-10-04T15:59:19.787
> 
> 标签：php, forms, email, captcha

我使用电子邮件营销公司发送 HTML 电子邮件，我在帖子中使用绝对路径，并包含他们用来处理表单的隐藏变量。我想添加一个验证码，但不知道怎么做。所有 php 验证码选项都使用 post 发布到 process.php 页面。我如何做到这一点并且仍然绝对发布到电子邮件营销公司，包括隐藏变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:24:15.733

如果我对您的理解正确，您目前只需将表单的`action`属性设置为营销公司的网址：

```
<form action="http://marketingsite.com/form.php" method="post"> 
```

...但是现在，您想在发送数据之前对其进行验证。

一种选择是在您自己的网站中验证您的数据`process.php`，然后用于`cURL`将数据发布到营销网站。

[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

`cURL`通常在安装 PHP 时包含。它用于读取数据并将数据发送到其他人的网页。您可以选择要发布的数据，然后用于`cURL`发布。

```
<?php
//  validate the CAPTCHA code first

//  This array will hold the data that you are POSTing to the marketing site
$post = array();

//  validate the other fields here, and add the relevant ones to an array. e.g.:
if(strlen($_POST['name']) > 4 && strlen($_POST['name'] < 20)) {
    $post['name'] = $_POST['name'];
}
if(strlen($_POST['hiddenfield'] != 0)) {
    $post['hiddenfield'] = $_POST['hiddenfield'];
}
//  ...

$curl = curl_init(); 

//  post the data to this url:
curl_setopt($curl,CURLOPT_URL,'http://marketingsite.com/form.php'); 

//  This indicates that we are going to post some data:
curl_setopt($curl,CURLOPT_POST,true); 

//  Post this data:
curl_setopt($curl,CURLOPT_POSTFIELDS,$post); 

//  If your script successfully sent the data, && if http://marketingsite.com/form.php returned a 200 code 
//      (i.e.: not a 404 error or something)
if(curl_exec($curl) && curl_getinfo($curl,CURLINFO_HTTP_CODE) == 200) {
    echo 'Thank you for submitting your data';
} else {
    echo 'Your data was not submitted :( ';
}
curl_close($curl); 
?> 
```

这将发布您选择的所有内容，包括隐藏字段或您要添加的其他字段。

您还可以设置其他选项。您可以尝试阅读接收网页并将该内容回显到您的网站。`cURL`您可以在此处了解更多信息`PHP`：

[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

# c++ - 运行时错误：`szDeviceType` 周围的堆栈已损坏

> ID：12731187
> 
> 赞同：0
> 
> 时间：2012-10-04T15:59:21.117
> 
> 标签：c++

嗨，我收到一个运行时错误，说周围的堆栈`szDeviceType`已损坏，但我不知道，我对 c++ 很陌生，所以我不会有最多的知识。任何帮助将不胜感激。

```
HRESULT hr = S_OK;
UINT er = ERROR_SUCCESS;
int szDeviceType = 0;
char lpszString[MAX_PATH];
LPWSTR szComport = NULL;
LPWSTR szNumChannels = NULL;
char szChannels[MAX_PATH];
char szPort[MAX_PATH];

hr = WcaInitialize(hInstall, "GetDatascanInfo");
ExitOnFailure(hr, "Failed to initialize");

WcaLog(LOGMSG_STANDARD, "Initialized.");

hr = WcaGetIntProperty(L"DEVICETYPE",&szDeviceType);
ExitOnFailure(hr, "failed to get Device Type");

hr = WcaGetFormattedProperty(L"COMPORT",&szComport);
ExitOnFailure(hr, "failed to get Com Port");

wcstombs(szPort, szComport, 500);

hr = WcaGetProperty(L"NUMCHANNELS",&szNumChannels);
ExitOnFailure(hr, "failed to get Com Port");

wcstombs(szChannels, szNumChannels, 500);

    if(szDeviceType == 2)
    {
        strcat(lpszString, "datascan");
        strcat(lpszString, szPort);
        strcat(lpszString, "DATASCAN 7000,DS:");
        strcat(lpszString, szChannels);

    }
    if (szDeviceType == 3)
    {
        strcat(lpszString, "solo");
        strcat(lpszString, szPort);
        strcat(lpszString, "DATASCAN SOLO,SA:");
        strcat(lpszString, szChannels);

    }
    if (szDeviceType == 4)
    {
        strcat(lpszString, "dataweb");
        strcat(lpszString, szPort);
        strcat(lpszString, "DATAWEB,DW:");
        strcat(lpszString, szChannels);
    }

    hr = MsiSetProperty(hInstall, "DATASCANINFO",  lpszString);
    ExitOnFailure(hr, "failed to set DATASCANINFO");

LExit:
er = SUCCEEDED(hr) ? ERROR_SUCCESS : ERROR_INSTALL_FAILURE;
return WcaFinalize(er);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:04:20.077

这看起来很可疑：

```
wcstombs(szPort, szComport, 500); 
```

最后一个参数是要写入的最大字符数，但您的数组大小仅为`MAX_PATH`260。

您还使用`strcat`附加到`lpszString`而不检查是否溢出。您可能应该切换到使用`strcat_s`具有边界检查的功能。

# java - Java：读取串口（波特率 921600）

> ID：12731199
> 
> 赞同：0
> 
> 时间：2012-10-04T15:59:50.903
> 
> 标签：java, io, serial-port

我正在开发一个 Java 软件，它必须能够读取设备通过串行 COM 端口发送的一些数据，通信速度对我来说非常重要，因此波特率设置为 921600。一开始一切正常很好（因此它读取了设备通过串行端口发送的正确数据），但过了一会儿，软件开始读取错误数据。看起来软件太慢了，当它们进入输入缓冲区时它实际上丢失了一些数据（可能是当输入缓冲区第一次完全填满时）。为了加快读取操作，我目前正在使用一种读取方法，在该方法中，软件每次读取时处理尽可能多的字节。我还尝试使输入缓冲区大小更大（通过使用 serialPort. setInputBufferSize(byte) 方法，但它没有解决我的问题）那么有没有人用 java 进行过快速串行通信？我错过了什么吗？为什么一段时间一切正常，然后停止正常工作？

这是我的读取部分（甚至驱动）的代码，请跳过数据转换部分，那只是因为每个数据实际上是由2个字节组成的，所以我也必须在将它们写入txt文件之前将它们组合起来。

```
/**
 *
 * @param evt
 */
@Override
public void serialEvent(SerialPortEvent evt) {

     switch(evt.getEventType()) {

        case SerialPortEvent.OUTPUT_BUFFER_EMPTY:
            System.out.println("THE OUTPUT BUFFER IS EMPTY");
            break;

        case SerialPortEvent.DATA_AVAILABLE:
            try {     

                while(SerialPortEvent.DATA_AVAILABLE == 1) {

                   num_bytes = input.available();
                   array = new byte[num_bytes];

                   bytes_read = input.read(array, 0, num_bytes);

                   dato = new short[bytes_read];
                   datoc = new int[bytes_read/2];
                   datos = new String[bytes_read/2];

                   for(j=0;j<bytes_read;j++){                           
                       dato[j] = (short) (((byte) array[j]) & 0xff);
                   }

                   k = 0;
                   for(j=0;j<(bytes_read/2);j++){

                       datoc[j] = dato[k];
                       datoc[j] = (datoc[j]<<8) + dato[k+1];
                       datoc[j] = datoc[j] & 0xffffffff;  
                       k = k + 2;
                   }

                   for(j=0;j<(bytes_read/2);j++){

                       System.out.println(datoc[j]);
                       datos[j] = Integer.toString(datoc[j]);
                       output1.write(datos[j] + " ");
                   }

               }
            } catch(IOException ex) {
              logText = "Failed to read data. (" + ex.toString() + ")";
              System.out.println(logText);
            }
            break;

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:39:19.117

听起来您的程序未能足够快地为传入的数据提供服务；它会工作一段时间，因为输入进入缓冲区，并且当您清空缓冲区时，会有更多空间用于更多输入。但是如果数据进来的速度比你处理它的速度要快，那么最终你的缓冲区就会满了，数据仍然进来，无处可去。在串行通信中，此类数据被丢弃在（虚拟）地板上是/是典型的。

设置指示“缓冲区溢出”的状态也是典型的。我要检查的第一件事是在您用来读取串行数据的任何库中是否可以使用此状态，并查看它是否/何时设置。这将验证上述情况是否正在发生。

如果在您的环境中合理，要检查的另一件事是 XON/XOFF 功能。这是/是某些串行通信的一个特性，它允许接收器向发送器指示其缓冲区几乎已满并停止发送 (XOFF)，直到被告知可以重新开始 (XON)。并非所有硬件和软件都支持此功能。

如果无论出于何种原因这都不起作用并且这确实是问题所在，那么您将不得不更好地处理数据或进一步缓冲数据。一个简单的蛮力方法是在字节进入时将它们写入存储，并在单独的线程中读取它们。例如，如果这是一个传统的计算机系统，您可以将它们写入磁盘，然后处理磁盘文件，在一个线程中打开它进行读取并在另一个线程中写入（多么有趣！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T18:55:52.997

降低串行通信速度的原因是使用`System.out.println()`. 没有它，数据接收最终会很好

# xcode - TouchUpInside 在 iOS5 上没有响应

> ID：12731201
> 
> 赞同：3
> 
> 时间：2012-10-04T15:59:59.030
> 
> 标签：xcode, ios5, uibutton, touch-up-inside

我`touchUpInside`像往常一样在 IB 中连接，使用新的 Xcode，构建设置为 iOS 5.0，但我的 iPhone 4（iOS6 发布之前的最新 iOS5）似乎对此没有响应。有人有同样的问题吗？

**编辑：**

适用于iOS6模拟器，而不是真实设备...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T07:12:58.497

检查代码中的手势识别器 - Apple 更改了`IBAction`和的评估顺序`Gesture Recognizer`。在 iOS6 中，`IBAction`总是先执行。

# iphone - iOS - UIViews 不响应触摸事件

> ID：12731202
> 
> 赞同：0
> 
> 时间：2012-10-04T16:00:00.547
> 
> 标签：iphone, ios, uiview, uiscrollview, event-handling

我正在尝试响应某些 UIView 上的触摸事件。这是视图控制器在 IB 中的外观：

![在此处输入图像描述](../Images/9ab6459b8fbd702b4414015d2bda9481.png)

这是视图层次结构：

![在此处输入图像描述](../Images/a07ff85c946b472d74ba679a51a98f05.png)

我已经实现了所有四种“触摸”方法，如下所示：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    if(touch.view==locPhoneView){
        locPhoneView.backgroundColor=[ColorUtility colorWithHexString:@"83d3f0"];
    }
    if(touch.view==locAddressView){
        locAddressView.backgroundColor=[ColorUtility colorWithHexString:@"83d3f0"];
    }
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [touches anyObject];
    if(touch.view==locPhoneView){
        locPhoneView.backgroundColor=[UIColor whiteColor];
    }
    if(touch.view==locAddressView){
        locAddressView.backgroundColor=[UIColor whiteColor];
    }

}
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event{

}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{

} 
```

无论我触摸屏幕的哪个位置，都不会发送事件。我在“touchesBegan”的开头有一个断点，这个代码永远不会到达。

所有视图都选中了“启用用户交互”，并适当地连接到它们的插座。

我错过了什么？在我的项目的其他地方，我也在做同样的事情，而且效果很好。

这可能与我的根视图是 UIScrollView 的事实有关吗？

谢谢！

**编辑：**我遵循了以下建议，并将 UIScrollView 子类化，以便将触摸发送到 NextResponder。看来我现在正在接触，但是，视图的背景颜色是否实际发生变化并没有正确运行。

例如，如果我快速点击视图，“触摸”方法会触发，但背景颜色不会改变。但是，如果我点击并按住大约一秒钟，背景颜色会按照我的预期发生变化。知道是什么导致了这种奇怪的行为吗？

**编辑：**添加行：

```
[scrollView setDelaysContentTouches:NO]; 
```

我的 viewDidLoad 方法为我解决了这个问题。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:23:48.820

你是对的，你的问题是你的视图被放置在 UIScrollView 中。滚动视图正在获取所有触摸事件并且不会将它们传递给它的子视图。

您可以获得此问题的解决方案：

*   从这个问题（或类似问题）的答案：[允许 UIScrollView 及其子视图都响应触摸](https://stackoverflow.com/questions/11485100/allow-uiscrollview-and-its-subviews-to-both-respond-to-a-touch)

*   从这篇博文：[http ://www.herbert-siojo.com/2011/04/01/forwarding-touches-to-subviews-of-uiscrollview/](http://www.herbert-siojo.com/2011/04/01/forwarding-touches-to-subviews-of-uiscrollview/)

*   或者通过谷歌搜索类似[“UIScrollview pass touches to subview”](http://www.google.com/search?q=UIScrollview%20pass%20touches%20to%20subview)

# javascript - 结构化 JavaScript：编写一个基本的验证器

> ID：12731203
> 
> 赞同：1
> 
> 时间：2012-10-04T16:00:02.207
> 
> 标签：javascript, oop, prototype, encapsulation

我正在尝试清理我的 JavaScript 代码，这样我就可以停止编写意大利面条代码并拥有更多的整体结构。我想通过编写一个简单的表单验证器来测试我的技能。但是，我已经卡住了。

这是我目前的代码：

```
(function($, window, undefined) {
    var Form = function($el) {
        this.$el = $el;
        this.fields = {};

        this.prototype.validate = function() {
            this.getFields();    
        }

        this.prototype.getFields = function() {
            console.log("getting fields");
        }

        return {
            validate: this.validate
        }
    };

    window.Form = Form;
})(jQuery, window);

$(function() {

    var form = new Form('#form-newsletter');
    form.validate();

}); 
```

关于这个的几个问题。

我将 Form 变量包装在一个自执行函数中，并传入三个参数。jQuery、window 和 undefined 以确保它始终未定义。我不会撒谎，这就是我学会这样做的方式，我不是 100% 确定我为什么要这样做。这是不好的做法还是我可以以某种方式改进？然后我通过将 Form 变量附加到窗口来公开它。

在`Form`var 中，我设置了一些属性（我们是这样称呼它们的吗？），我有几个方法。我只在 return 语句中公开了 validate 方法。这个可以吗？

然后是我卡住的部分。我想`validate()`成为一个初始化函数，它的任务是验证表单。Validate 应该调用 getFields 函数来解析表单字段并将它们放入 fields 对象中。但是，我似乎无法让它发挥作用。我打电话时它不起作用`this.getFields()`，`this.prototype.getFields()`或者`Form.getFields`。这是因为`this`this 函数内部的 this 与 Form 对象不同（这里的措辞正确吗？）？我应该`this.self = this`在 Form 函数的开头放置类似的东西吗？

我也想知道是否可以将这些方法附加到原型上。有理由不这样做吗？

我正在尝试学习; 我读过的大多数关于 JavaScript 的书都关注基础知识：`Dog`从类继承的`Mammal`类。但是，据我所知，他们并没有真正帮助我解决此类问题。是否有任何书籍、教程、截屏视频可以帮助我更好地理解这些概念？

编辑：

假设我想将我的脚本分组在一个公共命名空间下：我可以这样做

```
var MyStuff = {};

MyStuff.Utilities = { // stuff };
MyStuff.Form = function() { // stuff }; 
```

但是，如果我想将它们放入单独的文件中，例如`mystuff-form.js`, `mystuff-utilities.js`，我该怎么做呢？我在哪里声明命名空间 var `var MyStuff = {}`？在我这样做之后，我可以将我的表单和实用程序附加到上面，对吗？我几乎不能`MyStuff.js`用它来制作文件`var MyStuff = {}; window.MyStuff = MyStuff`，可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:17:51.403

您混淆了构造函数和可以从中创建的对象。原型的想法是您在构造函数的`.prototype`属性上设置函数，然后您通过构造函数创建的每个对象都可以访问这些函数。

在构造函数内部，`this`指的是正在创建的对象。在您的情况下，您正在对此类对象的原型进行设置 - 但该属性不存在。要在构造函数上设置属性`.prototype`，jQuery 允许使用简洁的语法`$.extend`：

```
// extend constructor's prototype with functions

$.extend(Form.prototype, {
    validate: function() {
        this.getFields();    
    },

    getFields: function() {
        console.log("getting fields");
    }
}); 
```

现在，任何对象都有`.validate()`可用的功能。

此外，您正在从构造函数返回一个新对象。你不需要；它甚至会破坏继承/原型的想法。

另外 - 你编码`this.$el = $el`，但在你的情况下，你传递了一个选择器字符串，所以我想你想`$($el)`将它转换为一个 jQuery 集（也许还重命名参数）。

最后，匿名函数不需要传递所有这些参数：

*   `jQuery -> $`- 如果页面处于模式，这很有用- 您可以在函数内部`jQuery.noConflict()`访问 jQuery 。`$`
*   `window -> window`- 没有真正的目的。`window`甚至是只读的，所以它不会改变。
*   `undefined`- 在现代浏览器中，这是只读的，所以不需要传递它。在较旧的浏览器中，如果您 a) 不通过它，并且 b) 您页面上的某些脚本发生更改，它只会导致冲突`undefined`。这不是很重要，但当然，像你一样通过它并没有什么坏处。

请参阅[http://jsfiddle.net/4UNAp/](http://jsfiddle.net/4UNAp/)。

# python - 如何使用 python 的 BaseHTTPServer / SimpleHTTPServer 调试 POST 请求？

> ID：12731207
> 
> 赞同：14
> 
> 时间：2012-10-03T20:10:09.423
> 
> 标签：python, http, command-line

[我在这个站点](http://wiki.python.org/moin/BaseHttpServer)上找到了一个脚本，用于通过 python 的命令行运行一个简单的服务器。

我添加了一些`print`行，因为我想通过命令行打印出请求的 GET 和 POST 参数，但我似乎无法让它们出现在任何地方。

如果我只是打印我们的`s`变量（`pprint (vars(s))`），我最终会看到：

```
{'client_address': ('127.0.0.1', 53373),
 'close_connection': 1,
 'command': 'GET',
 'connection': <socket._socketobject object at 0x10b6560c0>,
 'headers': <mimetools.Message instance at 0x10b689ab8>,
 'path': '/favicon.ico',
 'raw_requestline': 'GET /favicon.ico HTTP/1.1\r\n',
 'request': <socket._socketobject object at 0x10b6560c0>,
 'request_version': 'HTTP/1.1',
 'requestline': 'GET /favicon.ico HTTP/1.1',
 'rfile': <socket._fileobject object at 0x10b6538d0>,
 'server': <BaseHTTPServer.HTTPServer instance at 0x10b6893f8>,
 'wfile': <socket._fileobject object at 0x10b6536d0>} 
```

然后我尝试将`print`命令与每个索引 ( `pprint (vars(s.connection))`) 一起使用，但这不起作用。

这是修改后的脚本：

```
#!/usr/bin/python
import time
import BaseHTTPServer
from pprint import pprint

HOST_NAME = 'localhost' # !!!REMEMBER TO CHANGE THIS!!!
PORT_NUMBER = 9000 # Maybe set this to 9000.

class MyHandler(BaseHTTPServer.BaseHTTPRequestHandler):
        def do_HEAD(s):
                s.send_response(200)
                s.send_header("Content-type", "text/html")
                s.end_headers()
        def do_GET(s):
                """Respond to a GET request."""
                s.send_response(200)
                s.send_header("Content-type", "text/html")
                s.end_headers()
                s.wfile.write("<html><head><title>Title goes here.</title></head>")
                s.wfile.write("<body><form action='.' method='POST'><input name='x' value='1' /><input type='submit' /></form><p>This is a test.</p>")
                # If someone went to "http://something.somewhere.net/foo/bar/",
                # then s.path equals "/foo/bar/".
                s.wfile.write("<p>GET: You accessed path: %s</p>" % s.path)
                s.wfile.write("</body></html>")
                pprint (vars(s))
        def do_POST(s):
                """Respond to a POST request."""
                s.send_response(200)
                s.send_header("Content-type", "text/html")
                s.end_headers()
                s.wfile.write("<html><head><title>Title goes here.</title></head>")
                s.wfile.write("<body><p>This is a test.</p>")
                s.wfile.write("<body><form action='.' method='POST'><input type='text' name='xxxxxxxxxxxx' value='0000000000000000000000' /><input type='submit' /></form><p>This is a test.</p>")
                # If someone went to "http://something.somewhere.net/foo/bar/",
                # then s.path equals "/foo/bar/".
                s.wfile.write("<p>POST: You accessed path: %s</p>" % s.path)
                s.wfile.write("</body></html>")
                pprint (vars(s))
                pprint (vars(s.connection))
                pprint (vars(s.headers))
                pprint (vars(s.request))
                pprint (vars(s.rfile))
                pprint (vars(s.server))
                pprint (vars(s.wfile))
                pprint (vars(s.fp))
                """pprint (vars(s.request))"""

if __name__ == '__main__':
        server_class = BaseHTTPServer.HTTPServer
        httpd = server_class((HOST_NAME, PORT_NUMBER), MyHandler)
        print time.asctime(), "Server Starts - %s:%s" % (HOST_NAME, PORT_NUMBER)
        try:
                httpd.serve_forever()
        except KeyboardInterrupt:
                pass
        httpd.server_close()
        print time.asctime(), "Server Stops - %s:%s" % (HOST_NAME, PORT_NUMBER) 
```

如何使用简单的脚本打印出 POST 和 GET 参数？

通过命令行所需的输出将类似于：

```
1.0.0.127\. - - [03/Oct/2012 16:02:05] "POST / HTTP/1.1" 200 -
foo=1
bar=2
bis=3 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-04T04:42:37.337

这不是很明显，但处理程序在幕后使用套接字。因此，您需要从套接字读取原始数据，然后对其进行解释。

使用[`urlparse`](http://docs.python.org/library/urlparse.html)模块。

*   在 Python 2 中，您需要`urlparse.parse_qs`.
*   在 Python 3 中，该库被重命名：你想要`urllib.parse.parse_qs`.

Import `urlparse`，然后`do_POST`像这样修改您的方法：

```
def do_POST(s):
        """Respond to a POST request."""

        # Extract and print the contents of the POST
        length = int(s.headers['Content-Length'])
        post_data = urlparse.parse_qs(s.rfile.read(length).decode('utf-8'))
        for key, value in post_data.iteritems():
            print "%s=%s" % (key, value)

        s.send_response(200)
        s.send_header("Content-type", "text/html")
        s.end_headers()
        ... 
```

设置一个简单的测试客户端：

```
#!/usr/bin/env python

import urllib
import urllib2

url = 'http://localhost:9000'
post_dict = {'foo' : 1,
             'bar' : 2,
             'bis' : 3}

params = urllib.urlencode(post_dict)
post_req = urllib2.Request(url)
post_req.add_data(params)

response = urllib2.urlopen(post_req)
response_data = response.read()
response.close()
print response_data 
```

启动服务器，然后运行客户端：

```
ire@localhost$ python http_server.py 
Wed Oct  3 21:38:51 2012 Server Starts - localhost:9000
foo=[u'1']
bar=[u'2']
bis=[u'3'] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-03T16:08:22.160

您可以使用`cgi`模块代替`urlparse`. `cgi`实现开箱即用的 POST 参数解析。使用经过良好测试的库似乎更好。

`import cgi`

```
def do_POST(self):
    form = cgi.FieldStorage(
        fp=self.rfile,
        headers=self.headers,
        environ={"REQUEST_METHOD": "POST"}
    )

    for item in form.list:
        print "%s=%s" % (item.name, item.value) 
```

# xcode - 我使用我的个人 Apple Dev id 从 MAC AppStore 下载了 XCode 4.5.1，但需要使用我的公司 Apple id 安装它

> ID：12731210
> 
> 赞同：0
> 
> 时间：2012-10-04T16:00:22.503
> 
> 标签：xcode, installation, xcode4.5, mac-app-store, iphone-developer-program

我在 Mac Pro (OSX 10.7.5) 上开发，我当前的 XCode 版本是 4.3，几个月前我使用我的企业苹果开发 ID 安装了它。

我刚刚从 Mac AppStore 下载了 XCode 4.5.1，现在意识到我是使用我的个人 Apple Developer id 下载的。我现在需要在以前的 XCode 版本 4.3 上安装这个下载的 XCode 4.5.1。

我尝试使用我的 Corp Dev id 开始安装，安装程序抱怨该软件包与我的另一个 id（即我的个人应用程序开发 id）相关联，我应该重新尝试使用该（个人）id 进行安装。我找不到清除下载的方法，所以我终于在我的个人 ID 下启动了安装程序。

我现在有 2.5 小时的漫长等待，直到安装完成。我不想在等待结束时感到惊讶，所以如果有人能告诉我在我的个人 ID 下安装它是否有任何影响或警告，我将不胜感激？

（我在 XCode 中的所有应用程序和设备等都安装在我的 corp apple id 下的设备上。）我只是不希望这使我的工作流程复杂化，或者，如果会的话，我想了解如何以及如何解决潜在的问题问题和注意事项！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T07:16:19.217

没关系...当它询问您时，只需使用您的 Cor ID 登录即可。我从开发者网站下载了它。.dmg 文件，它工作正常。

# android - 将 Cookie 从 HttpURLConnection (java.net.CookieManager) 传递到 WebView (android.webkit.CookieManager)

> ID：12731211
> 
> 赞同：33
> 
> 时间：2012-10-04T16:00:24.413
> 
> 标签：android, cookies, android-webview, single-sign-on, httpurlconnection

> *我已经看到了关于这应该如何与旧版本一起使用的答案，`DefaultHttpClient` 但没有一个很好的例子[`HttpURLConnection`](http://developer.android.com/reference/java/net/HttpURLConnection.html)*

我`HttpURLConnection`用来向 Web 应用程序发出请求。在我的 Android 应用程序启动时，我使用`CookieHandler.setDefault(new CookieManager())`自动处理会话 cookie，这工作正常。

在登录后的某个时间点，我想向用户显示来自 Web 应用程序的实时页面，`WebView`而不是使用`HttpURLConnection`. 但是，我想使用我之前建立的同一个会话来防止用户再次登录。

如何将 cookie 从`java.net.CookieManager`used by复制`HttpURLConnection`到`android.webkit.CookieManager`used by`WebView`以便共享会话？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-08-06T02:02:22.773

我想建议一种完全不同的方法来解决您的问题。与其将 cookie 从一个地方复制到另一个地方（手动同步），不如让 HttpURLConnection 和 WebView 使用**相同**的cookie 存储。

这完全消除了同步的需要。在其中任何一个中更新的任何 cookie 将立即自动反映在另一个中。

为此，请创建您自己的 java.net.CookieManager 实现，它将所有请求转发到 WebViews 的 webkit android.webkit.CookieManager。

执行：

```
import java.io.IOException;
import java.net.CookieManager;
import java.net.CookiePolicy;
import java.net.CookieStore;
import java.net.URI;
import java.util.Arrays;
import java.util.List;
import java.util.Map;

public class WebkitCookieManagerProxy extends CookieManager 
{
    private android.webkit.CookieManager webkitCookieManager;

    public WebkitCookieManagerProxy()
    {
        this(null, null);
    }

    WebkitCookieManagerProxy(CookieStore store, CookiePolicy cookiePolicy)
    {
        super(null, cookiePolicy);

        this.webkitCookieManager = android.webkit.CookieManager.getInstance();
    }

    @Override
    public void put(URI uri, Map<String, List<String>> responseHeaders) throws IOException 
    {
        // make sure our args are valid
        if ((uri == null) || (responseHeaders == null)) return;

        // save our url once
        String url = uri.toString();

        // go over the headers
        for (String headerKey : responseHeaders.keySet()) 
        {
            // ignore headers which aren't cookie related
            if ((headerKey == null) || !(headerKey.equalsIgnoreCase("Set-Cookie2") || headerKey.equalsIgnoreCase("Set-Cookie"))) continue;

            // process each of the headers
            for (String headerValue : responseHeaders.get(headerKey))
            {
                this.webkitCookieManager.setCookie(url, headerValue);
            }
        }
    }

    @Override
    public Map<String, List<String>> get(URI uri, Map<String, List<String>> requestHeaders) throws IOException 
    {
        // make sure our args are valid
        if ((uri == null) || (requestHeaders == null)) throw new IllegalArgumentException("Argument is null");

        // save our url once
        String url = uri.toString();

        // prepare our response
        Map<String, List<String>> res = new java.util.HashMap<String, List<String>>();

        // get the cookie
        String cookie = this.webkitCookieManager.getCookie(url);

        // return it
        if (cookie != null) res.put("Cookie", Arrays.asList(cookie));
        return res;
    }

    @Override
    public CookieStore getCookieStore() 
    {
        // we don't want anyone to work with this cookie store directly
        throw new UnsupportedOperationException();
    }
} 
```

最后通过在应用程序初始化中执行此操作来使用它：

```
android.webkit.CookieSyncManager.createInstance(appContext);
// unrelated, just make sure cookies are generally allowed
android.webkit.CookieManager.getInstance().setAcceptCookie(true);

// magic starts here
WebkitCookieManagerProxy coreCookieManager = new WebkitCookieManagerProxy(null, java.net.CookiePolicy.ACCEPT_ALL);
java.net.CookieHandler.setDefault(coreCookieManager); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-10-04T16:00:24.413

与 相比`DefaultHttpClient`，有一些额外的步骤。关键区别在于如何访问现有的 cookie `HTTPURLConnection`：

1.  调用`CookieHandler.getDefault()`并将结果转换为`java.net.CookieManager`.
2.  使用 cookie 管理器，调用`getCookieStore()`以访问 cookie 存储。
3.  使用 cookie 存储，调用`get()`以访问给定的 cookie 列表`URI`。

这是一个完整的例子：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    // Get cookie manager for WebView
    // This must occur before setContentView() instantiates your WebView
    android.webkit.CookieSyncManager webCookieSync =
        CookieSyncManager.createInstance(this);
    android.webkit.CookieManager webCookieManager =
        CookieManager.getInstance();
    webCookieManager.setAcceptCookie(true);

    // Get cookie manager for HttpURLConnection
    java.net.CookieStore rawCookieStore = ((java.net.CookieManager)
        CookieHandler.getDefault()).getCookieStore();

    // Construct URI
    java.net.URI baseUri = null;
    try {
        baseUri = new URI("http://www.example.com");
    } catch (URISyntaxException e) {
        // Handle invalid URI
        ...
    }

    // Copy cookies from HttpURLConnection to WebView
    List<HttpCookie> cookies = rawCookieStore.get(baseUri);
    String url = baseUri.toString();
    for (HttpCookie cookie : cookies) {
        String setCookie = new StringBuilder(cookie.toString())
            .append("; domain=").append(cookie.getDomain())
            .append("; path=").append(cookie.getPath())
            .toString();
        webCookieManager.setCookie(url, setCookie);
    }

    // Continue with onCreate
    ...
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-18T00:15:09.637

我用 onCreate 中的这一行神奇地解决了我所有的 cookie 问题：

`CookieHandler.setDefault(new CookieManager());`

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-11-28T09:14:24.123

我有同样的问题，这是我的解决方案：

就在登录之后（这很重要，因为之前，您可能还没有 cookie）使用 httpurlconnection POST（在 getResponseCode 之后），我这样做：

```
 responseCode = connexion.getResponseCode();
 if (responseCode == HttpURLConnection.HTTP_OK) {
     final String COOKIES_HEADER = "Set-Cookie";
     cookie = connexion.getHeaderField(COOKIES_HEADER);
     ...
 } 
```

（其中 cookie 是我班上的公共字符串）

在 webview 活动中，我想使用 WebView 从服务器显示网页，我这样做：

```
 String url = "http://toto.com/titi.html";        // the url of the page you want to display
    CookieSyncManager.createInstance(getActivity());
    CookieSyncManager.getInstance().startSync();
    android.webkit.CookieManager cookieManager = android.webkit.CookieManager.getInstance();
    cookieManager.setAcceptCookie(true);
    cookieManager.removeSessionCookie();
    cookieManager.setCookie(url, cookie);
    CookieSyncManager.getInstance().sync(); 
```

由于我的 webview 在一个片段中，我必须使用 getActivity() 作为上下文，我还必须指定 android.webkit。在 CookieManager 之前，否则无法解析（导入 java.net 而不是 android.webkit cookie 管理器）。

cookie 与上面的字符串相同（在我的片段中，我必须使用以下方法恢复它：

```
 cookie = getArguments().getString(COOKIE); 
```

在我的 MainActivity 中，我通过以下方式发送它：

```
 Bundle arg = new Bundle();
    arg.putString(Fragment_Cameras.COOKIE, cookie);
    fragment.setArguments(arg); 
```

我希望这可以帮助！

# javascript - 我应该如何处理 JavaScript 中对象构造函数的无效输入

> ID：12731213
> 
> 赞同：5
> 
> 时间：2012-10-04T16:00:29.877
> 
> 标签：javascript, oop, class, exception, throw

我正在尝试用 Javascript 了解 OOP（我也从未真正在任何其他语言中使用过 OOP，所以这是我的第一次体验）。我编写了一个需要为构造函数输入的类，但构造函数仅适用于特定格式的字符串。

我有一个正则表达式，我可以用它来检查输入，但我不知道如果它不匹配（或者根本没有输入）我应该做什么。我应该抛出某种异常吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:19:04.120

在 JavaScript 中，抛出异常并不是你想要做的。一个异常只能在异常情况下发生（duh ...）。这与 Java 形成鲜明对比，Java 中到处都使用异常来进行通信。造成这种差异的原因是 JS 中的异常处理非常慢。

因此，您可以很好地为您的构造函数配备`throw`，但这不应该在生产中被捕获。您宁愿先在构造函数之外检查有效性。

做：

```
if (validRE.test(input)) {
    foo = new MyObject(input);
} else {
    // show message to the user
} 
```

不：

```
try {
    foo = new MyObject(input);
} catch (ex) {
    // show message to the user
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T16:13:27.380

JavaScript 构造函数（使用[`new`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/new)调用的函数）总是需要返回一个对象，你不能 return `false`，`null`或者类似正常调用时。所以，你有两个选择：

*   从中抛出异常。您可以对[`throw`语句](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/throw)中的每个 javascript 值执行此操作。然后，用[`try`语句将它们捕获到构造之外](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/try...catch)
*   返回一个普通对象，但内部值设置为一个`invalid`指针。例如，`Date`构造函数执行此操作，获取属性然后生成`NaN`s。

此外（特别是在使用异常时），您可能会提供额外的验证函数（返回布尔值）作为构造函数的静态属性，因此您甚至可以在构造对象之前使用它。例子：

```
function Decryption(str) {
    if (! Decryption.test(str))
        throw new SyntaxError("invalid encryption");
    this.result = decrypt(str);
}
Decryption.test = function(str) {
    return /MyCoolRegExp/.test(str);
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:06:03.320

如果你想抛出一个异常，你可以这样做：

```
throw new Error("Illegal construction string."); 
```

（该对象不是强制性的，即您可以抛出一个纯字符串，但如果您处理该事件`Error`，它将使错误消息很好地显示出来。）`onerror`

当您将使用用户输入时，您可能会在调用构造函数之前验证字符串，并为用户提供比异常结果更友好的消息。当然，您仍然可以在构造函数中进行验证，以确保没有任何东西偷偷溜走。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:11:38.997

通常有两种方法可以解决这个问题：要么抛出异常，要么返回一些指示失败的值（如`undefined`）。在 JavaScript 中，我倾向于更倾向于后者，更宽容的方法。

我还发现第二种方法更接近地模仿了很多 JavaScript 本身。例如，在 Python 中，如果您尝试访问对象上不存在的属性，则会引发异常。

```
>>> foo = 0
>>> foo.idontexist
AttributeError: 'int' object has no attribute 'idontexist' 
```

而在 JavaScript 中，它只返回`undefined`.

```
> var foo = 0;
> foo.idontexist
undefined 
```

许多函数和对象也以这种方式工作。例如，在传递不正确的日期字符串时`Date`返回一个`Invalid Date`对象，而不是引发异常。

```
> var foo = new Date('thisisnotadate');
> foo
Invalid Date 
```

# servicestack - 使用 JsonSerializer 删除 JSON 响应中的具体 __type 信息

> ID：12731214
> 
> 赞同：13
> 
> 时间：2012-10-04T16:00:33.590
> 
> 标签：servicestack, jsonserializer

如何强制 __type 信息在反序列化的 JSON 响应中呈现？我不需要重新序列化这些数据，所以我宁愿删除它。ServiceStack 似乎将此添加到我模型的字典属性中。

这是使用 ServiceStack 和 ServiceStack.Text.JsonSerializer

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-04T16:09:40.990

默认情况下，**__type**仅在反序列化需要时才发出，例如，您的 DTO 包含接口、抽象类或后期绑定对象类型等。

您可以通过以下方式阻止它发出：

```
JsConfig.ExcludeTypeInfo = true; 
```

否则，您始终可以使用以下命令发出它：

```
JsConfig.IncludeTypeInfo = true; 
```

# c++ - 捕获此的 lambda 的访问权限

> ID：12731215
> 
> 赞同：23
> 
> 时间：2012-10-04T16:00:40.740
> 
> 标签：c++, lambda, c++11

考虑以下代码：

```
#include <iostream>

struct test
{
    void public_test()
    {
        [this]() { private_test(); }();
    }

private:
    void private_test()
    {
        std::cout << "test\n";
    }
};

int main()
{
    test().public_test();
} 
```

lambda 捕获它，然后调用捕获对象的私有方法。现在这段代码使用 VC++ 2012 编译和工作（打印`test`）。虽然这是非常直观和有用的行为，但我想知道这是否可以保证按标准工作。因此，lambda 是否可以私有访问通过 捕获的任何对象`this`？

*我试图通过5.1.2 [expr.prim.lambda]*在标准阅读中查找这一点，但无法真正找到明确的答案（对标准的深入了解并不那么精通）。唯一对我有用的段落是

> lambda 表达式的类型（也是闭包对象的类型）是唯一的、未命名的非联合类类型——称为闭包类型——其属性如下所述。此类类型不是聚合 (8.5.1)。闭包类型在包含相应 lambda 表达式的最小块作用域、类作用域或命名空间作用域中声明。[注意：这决定了与闭包类型（3.4.2）关联的命名空间和类的集合。lambda-declarator 的参数类型不会影响这些关联的命名空间和类。——尾注]

但另一方面，在成员函数中定义的普通本地类类型没有对周围类的私有访问权限。因此，具有私有访问权限的 lambda 会以某种方式将 lambdas 提升到本地函数对象的语法糖之上，以涉及更多的事情，因为它需要额外的“编译器魔法”才能以某种方式使其成为周围类的朋友。

那么 lambda 是否可以私有访问通过捕获的任何对象`this`，如果是，标准的哪些部分允许这种情况发生？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-04T16:04:35.373

我不认为它是一个 lambda 的事实是相关的。lambda 所做的只是定义一个本地类。并且根据§11/2：“成员函数的本地类可以访问成员函数本身可以访问的相同名称。”

# php - 如何对这行简单的 PHP 代码进行分页？

> ID：12731219
> 
> 赞同：-3
> 
> 时间：2012-10-04T16:00:49.217
> 
> 标签：php, jquery

我想知道如何对这行非常简单的代码进行分页：

```
 <?php

for($i=1;$i<=40;$i++){
    echo '<a href="#">'.$i.'</a> | ';
}

?> 
```

它的输出：

![在此处输入图像描述](../Images/2c22100ec992666abab67461658d3ffd.png)

我想让它像这样：

![在此处输入图像描述](../Images/a3202ab1d859205d46fe9af7bcc8f727.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:18:10.467

我假设您希望页面链接“包围”当前页面。我没有包含上一个和下一个链接，这些链接添加起来很简单，并且会混淆这个示例。

```
<?php

$current_page = 10;
$total_pages = 40;
$links = 11;

$start = $current_page - floor($links / 2);
if ($start < 1) {
    $start = 1;
}

$end = $start + $links;
if ($end > $total_pages) {
    $end = $total_pages;
}

for($i = $start; $i <= $end; ++$i) {
    echo '<a href="#">' . $i . '</a> | ';
}

?> 
```

对于第 20 页，它将为您提供当前页面和两侧的 5 页：

```
15 | 16 | 17 | 18 | 19 | 20 | 21 | 22 | 23 | 24 | 25 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:18:55.117

这样的事情将解决您的问题：

```
if($_GET['page']!=''){
    $page=$_GET['page'];
} else {
    $page=1;
}

print "<a href=\"?page=".($page==1 ? '1' : $page-1)."\">Prev</a> |\n";

for($i=$page;$i<=($page+10);$i++){
    print "<a href=\"?page={$i}\">{$i}</a> |\n";
}

print "<a href=\"?page=".($page+1)."\">Next</a>\n"; 
```

无论您的目的是什么，您显然都需要进行调整。

# pdf - 是否可以从可搜索的 PDF 访问文本覆盖？

> ID：12731222
> 
> 赞同：8
> 
> 时间：2012-10-04T16:00:56.573
> 
> 标签：pdf, ocr

我了解 PDF 和可文本搜索的 PDF 之间存在差异。可文本搜索的 PDF 具有用于搜索的文本覆盖。是否可以将此文本叠加层提取到 txt 文件中？也许使用 Adob​​e API？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-04T23:43:51.557

“可搜索的 PDF”不是官方定义，但它是一种常用的表达方式。

如果标准 PDF 嵌入了它使用的所有字体，并且如果这些字体不使用自定义编码，那么它很可能是“可搜索的”：这意味着您可以从中复制“n”粘贴文本，并且您可以提取来自它的文本（以及`pdftotext`或多或少完美无瑕的工具）。这与“文本覆盖”无关，它是 PDF 的标准架构。

您所描述的“文本覆盖”是可以添加到*扫描*的PDF 中的内容。通过扫描创建的 PDF 是整页图像，通常是 TIFF，嵌入在（否则为空）PDF 页面中。然后，在另一个步骤中，通过对其运行 OCR（光学字符识别）来添加“文本覆盖”。这为原本愚蠢的“仅像素”PDF 提供了“可搜索性”。

如果这种带有“文本覆盖”的 PDF 没有在其字体周围使用奇怪的结构，那么应该很容易将此文本提取到 *.txt 文件中。毕竟，在仅包含图像的 PDF 上运行 OCR 旨在添加“可搜索”文本：

*   安装`pdftotext`（适用于 Linux、Unix、Windows、Mac OS X）然后尝试运行：

    ```
    pdftotext -layout some-input.pdf  some-input.txt 
    ```

**警告**，大多数 OCR 远非完美。如果您对所有*字符*的识别率达到 99% ，那么您将很幸运。（但这意味着：大约 10% 的*单词*和大约 100% 的*句子*都包含错误——这会让你在高中时肯定会失败......）

还应该注意的是，这些“文本覆盖”在技术上与 PDF 中的任何其他文本部分相同（除了它们包含更多的拼写和语法错误:-)——但它们使用特殊的文本呈现模式（模式`3`），描述为*“既不填充也不描边文本（不可见）。”* 尽管它是“不可见的”，但您仍然可以突出显示、复制和粘贴或提取这些文本部分。

# java - 使用 joda 库汇总日期时间

> ID：12731228
> 
> 赞同：2
> 
> 时间：2012-10-04T16:01:08.670
> 
> 标签：java, jodatime

我正在寻找一种使用 Joda 时间库来四舍五入日期时间值的方法。仅当间隔在 60 秒到下一个整数小时内时，我才需要这样做。

例如四舍五入：

```
10/1/2012 10:59:00 => 10/1/2012 11:00:00
10/1/2012 10:59:01 => 10/1/2012 11:00:00
10/1/2012 10:59:59 => 10/1/2012 11:00:00
10/1/2012 10:49:59 => 10/1/2012 10:49:59 (no rounding needed) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:12:57.240

您的`base`日期时间必须缩短为小时。让我们将此操作的结果称为`product`。然后加入产品一小时。之后，您需要用`base`(product-base) 减去产品，这将给出`difference`.

如果差异小于 61 秒，则您设置产品，否则您离开基地。

编辑：

或者您可以检查您的日期是否有 59 分钟，然后添加一分钟并设置

```
if(dateTime.getMinuteOfHour() == 59) {
  dateTime.addMinutes(1);
  dateTime.setSecondOfMinute(0);
  dateTime.setMillisOfSecond(0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:13:23.747

您可以在以下代码段的行中执行某些操作：

```
DateTime input = new DateTime(2012, 10, 04, 21, 39, 0, 0);
DateTime dateTime = new DateTime();
long diffInSeconds =
    dateTime.minus(input.getMillis()).getMillis() / 1000;
if (diffInSeconds <= 60)
{
    input = input.plus(diffInSeconds * 1000);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:20:19.547

这应该这样做：

```
DateTime round = new DateTime().withTime(23, 59, 0, 0)

DateTime temp = round.plusMinutes(1);
if(temp.getHourOfDay()!=round.getHourOfDay())
    round = new DateTime(temp.withTime(temp.getHourOfDay(),0,0,0)); 
```

# opencv - Cmake 为 CodeBlock 项目生成“绝对文件路径”

> ID：12731233
> 
> 赞同：2
> 
> 时间：2012-10-04T16:01:35.543
> 
> 标签：opencv, cmake, codeblocks, filepath

我使用 Cmake 来构建我的 cpp + OpenCV 项目，因为我的教授想要一个多平台构建器并且他使用 microsoft visual studio。一切正常，直到我将我的 Cmake 从版本“2.6”更新到“2.8.*”，它现在是 Ubuntu 12.04 上的默认版本。当我使用 Cmake 生成“.cdp”时，在 CodeBlocks 的“Workspace”列中，它显示：

```
Sources
    /home/{My workspace}/epi.cpp` 
```

代替

```
Sources
    epi.cpp 
```

Cmake版本“2.6”从未发生过。而且它不是用户友好的

这是我的 CmakeLists.txt：

```
CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

SET(CMAKE_MODULE_PATH $ENV{OPENCV_DIR})

FIND_PACKAGE(OpenCV REQUIRED)

PROJECT(TP2)

ADD_EXECUTABLE(epipolaires epi.cpp image.cpp image.h)
TARGET_LINK_LIBRARIES(epipolaires ${OpenCV_LIBS}) 
```

我试图回到 Cmake 2.6，它运行良好。所以我认为这是一个 Cmake 问题，而不是 CodeBlocks 问题。你能告诉我如何在 Cmake 2.8.7 上修复它吗？

我在 Ubuntu 12.04 上。我使用 OpenCV 2.4.2 和 Cmake 2.8.7。OpenCV .cmake 文件位于`/usr/local/share/OpenCV`

# macos - OSX：从 Posix/shell 程序中隐藏 Cocoa 应用程序的临时文件：“反向”沙盒？

> ID：12731235
> 
> 赞同：1
> 
> 时间：2012-10-04T16:01:38.857
> 
> 标签：macos, permissions, filesystems, acl, sandbox

所以这就是问题所在：我的应用程序（是否沙盒，似乎并不重要）在 NSTemporaryDirectory() 中创建了一些临时文件。然后将这些文件传递给一些 Cocoa/Quartz API 以进行渲染和做其他事情（通过 NSUrl） 我的另一个限制是我不能运行 setuid root 并且不能模拟给任何人。

如何确保**来自同一用户**（或任何其他用户）的其他进程无法访问这些文件（最好甚至不知道它们存在）？

如果我能以某种方式创建一个“每进程文件系统”，它只为我的进程所知，而不是同一用户的任何其他进程，它会完成我想要的。此外，我尝试使用 FIFO，但似乎请求 NSUrls 的 Foundation 和 Quartz 类会测试文件的规律性并拒绝让我以这种方式使用 FIFO。

我需要确保这些文件中的数据对系统上的所有其他进程（root 除外）和运行此应用程序的用户的其他（POSIX 或 Cocoa）进程保密。

我尝试使用 ACL，但看不到如何指定每个进程而不是每个用户的权限...

（我已经接近求助于编写驱动程序来做到这一点了）。

谢谢！米莎。

# java - 来自不同持久单元的 JPA 实体映射

> ID：12731236
> 
> 赞同：4
> 
> 时间：2012-10-04T16:01:42.257
> 
> 标签：java, spring, jpa, ejb

是否有任何特定配置可以将来自不同持久性单元的实体放入当前映射？

例如：

```
@RooJpaActiveRecord(persistenceUnit = "persistenceUnit_central")
public class UserGroups{

    //users come from `persistenceUnit_client`
    //how to work this out?
    //can mappedBy and targetEntity works the same way
    //as they are in the same persistence unit?
    @OneToMany
    private List<User> users;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:31:06.753

我不认为你不能直接做到这一点。持久性单元意味着明显分开；他们有不同的实体管理器，所以他们很可能（这通常是原因）来自不同的数据库或模式。

您仍然可以在 persistence.xml 中定义相同的实体类以存在于多个持久性单元中*，*但是，正如我所说，它将由每个管理器单独处理。这意味着你不能这样做：

```
UserGroups ug = em1.find(UserGroups.class, ...); // entity manager 1
User u = em2.find(User.class, ...); // entity manager 2

// exception will be thrown on commit 
// - from the point of view of em1, "u" is detached
ug.getUsers().add(u); 
```

我不确定打电话`em1.merge(u)`是否能解决问题——我还没有遇到过这种情况。但是您肯定可以创建一个副本`User`并将其合并到所需的持久性上下文中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:53:49.617

玛达是对的。我对这个问题的回答只是为了突出这个问题的解决方案。

首先，到目前为止，我们无法在实体 B 中持久化实体 A 的实例，而 A 和 B 来自不同的持久化单元。使其正常工作的一种安全方法是使实体 A 的实例变为 @Transient，然后永远不会更改以使该实例与数据库相关联。但是，手动设置实体（setter 和 getter）之间的关系会有点痛苦，这成为一个悬而未决的问题。

再次感谢马达。

# c# - 将方法参数作为列表发送而不实例化新列表

> ID：12731242
> 
> 赞同：1
> 
> 时间：2012-10-04T16:02:05.907
> 
> 标签：c#, methods, parameters, parameter-passing, overloading

可以说我有一个方法：

```
 UpdateObject(IList<MyObject> objs) 
```

我想用那个方法只发送一个对象？（我不喜欢使用方法重载，因为我不想在我的界面中处理很多方法）

有没有一种方法可以在不执行以下操作的情况下使用相同的方法：

```
UpdateObject(new List<MyObject>(){singleObj}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:08:52.750

也许您可以将一个传递`IEnumerable<MyObject>`给该方法。

将单个元素附加到 an 的最简单方法可能`IEnumerable<T>`是使用此`AsIEnumerable`扩展名（尽管[Eric Lippert 建议不要](https://stackoverflow.com/a/7652359/284240)为对象创建扩展名）：

```
public static IEnumerable<T> AsIEnumerable<T>(this T obj)
{
    yield return obj;
} 
```

现在您可以将所有内容用作`IEnumerable`.

```
UpdateObject(singleObj.AsIEnumerable()) 
```

# asp.net - ASP.NET Visual Studio 不捕获更改 - 从临时文件编译

> ID：12731244
> 
> 赞同：1
> 
> 时间：2012-10-04T16:02:08.890
> 
> 标签：asp.net, css, visual-studio-2010, temporary-files

我正在使用 Visual Studio 2010 在 ASP.NET 中设计网页。编译器使用以前编译的临时文件工作。这意味着每次我更改我的 Css 文件或更改我正在使用的资源文件时 - VS 都会使用以前的数据编译我的网页。

我对 ASP.NET 还比较陌生，我敢肯定这里有一些我遗漏或不熟悉的东西，因为像这样流利地工作是不可能的。

只有当我找到临时文件、删除它们并重新编译项目时——只有这样它才能工作。但我必须非常小心我要删除哪些文件。

有没有办法克服这个问题？或在单个命令中删除正确的文件？

帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T05:39:25.920

我很少做一些事情来反映变化而不是看到这个问题。

1.  每当你开始新的时候就关闭卡西尼。以前运行的 cassini 实例通常会导致错误。
2.  第一个应该可以工作，无论如何它不会清除浏览器缓存。样式表和脚本通常由浏览器缓存。

建议：- 尝试在隐私浏览中运行您的应用程序的新实例。您不会看到在隐私浏览中通常会出现的问题。

# jquery - 如何在单击它并覆盖其他 div 时填充 div 以适应屏幕

> ID：12731247
> 
> 赞同：1
> 
> 时间：2012-10-04T16:02:18.393
> 
> 标签：jquery

我有一组`<div>`具有相同类名的标签。我的目标是当我点击一个特定的`<div>`我需要最大化它的高度和宽度以填充屏幕并覆盖其余的`<div>`s 。我正在使用下面的代码来实现这一点

```
$('div').click(function(){
    var isFullscreen = false;
    var d = {};
    var speed = 900; 
    if(!isFullscreen){ // MAXIMIZATION
        d.width = $(window).width();;
        d.height = $(window).height();; 
        isFullscreen = true;
    }
    else{ // MINIMIZATION            
        d.width = "300px";
        d.height = "100px";            
        isFullscreen = false;
    }
    i = 0 
    id = $(this).attr("id");
    while(i<=12){
        if(i != id){
            $("i").hide();
        }
        i++;
    }
    $(this).animate(d,speed)
    }) 
```

所以我所做的是我按照从**1 到 12的顺序给每个人一个****id** ，并试图隐藏它们，除了点击的那个。这是正确的方法吗？为我糟糕的英语道歉。额外信息：我正在使用具有流体布局的 Jquery Masonry。

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:19:53.937

您是否正在寻找这样的东西：

[http://jsfiddle.net/Ns5hD/](http://jsfiddle.net/Ns5hD/)**

# java - 从 url 保存图像或文件

> ID：12731248
> 
> 赞同：0
> 
> 时间：2012-10-04T16:02:19.687
> 
> 标签：java, url, save

我正在寻找将图像从给定的 url 保存到磁盘上的指定位置，并使用 java 指定的文件名。有人告诉我转换为字节数组然后保存。作为Java新手，我现在对此感到完全迷失。

我想我将首先打开与 url 的连接：

```
`String img_url = "some img url";
URL url = new URL(img_url);
URLConnection url_c = url.openConnection();` 
```

我从这里去哪里？

编辑：我发现无论类型如何，这个实现都应该保存内容。因此，如果 url 指向图像，则应该保存，或者如果 url 指向 .doc 或 .pdf，则应该保存它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:12:36.353

```
File direct = new File(Environment.getExternalStorageDirectory() + "/urfoldername/");
if(!direct.exists())
               {
                   direct.mkdir(); //directory is created;

               }
 file = new File("/sdcard/urfoldername/"+fileName);
 InputStream input = new BufferedInputStream(url.openStream());
 OutputStream output = new FileOutputStream(file);
 byte data[] = new byte[1024];
         while ((count = input.read(data)) != -1) 
                       {
               total += count;
               output.write(data, 0, count); 
               }
                 output.flush();
                 output.close();
                 input.close(); 
```

# java - 拆分数组列表并再次合并它们

> ID：12731251
> 
> 赞同：2
> 
> 时间：2012-10-04T16:02:28.040
> 
> 标签：java, oop, arraylist, user-defined-types

我创建了一个名为 OutlierInfo 的类，如下所示

```
public class OutlierInfo 
{
    public String month;
    public int year;
    public String id;
    public int serialId;

    public void setSerialId(int serialid)
    {   
        serialId=serialid;   
    }

    public void setMonth(String monthh)
    {   
        month=monthh; 
    }

    public void setYear(int yearr)
    {    
        year=yearr;  
    }

    public void setId(String idd)
    {        
        id=idd;   
    }   
} 
```

我有一个 Outlierinfo 类型的数组列表。我已将 OutlierInfo 的一些对象添加到数组列表中。现在我要做的是根据对象的 SerialId 对对象进行分组，为每个组创建数组列表，然后合并组的所有数组列表 这是我编写的代码，但它只是抛出错误，我不知道为什么。我需要一些帮助来找出为什么以下代码会出错？</p>

```
public class ArraylistSort 
{
    ArrayList<OutlierInfo> result = new ArrayList();
    static ArrayList<ArrayList<OutlierInfo>> groupResult = new ArrayList<ArrayList<OutlierInfo>>();
    String[] months = { "JAN", "FEB", "MAR", "APR"  ,
                        "MAY", "JUN", "JUL", "AUG"  ,
                        "SEP", "OCT", "NOV", "DECM"
                      };
    int counter=0;
    int count=0;   

    public ArraylistSort(){

        for(int i=0;i<2;i++)   
        {
            for(int j=0;j<4;j++)
            {     
                int year=2000+j;
                OutlierInfo o=setValues(i,months[j],year);
                result.add(o);
                System.out.println("result size"+result.size());
            }
        }

        while(result.size()!=0)
        {      
            OutlierInfo info1=new OutlierInfo();
            info1=result.get(counter);
            ArrayList<OutlierInfo> partialInfo=new ArrayList();

            for(int j=1;j<count;j++)
            {      
                OutlierInfo info2=new OutlierInfo();
                info2=result.get(j);
                if(info1.serialId==info2.serialId)
                {   
                    partialInfo.add(info2);
                    result.remove(info2);
                }                                                  
            }

            partialInfo.add(info1);
            System.out.println("partiainfosize"+partialInfo.size());
            groupResult.add(partialInfo);
            result.remove(info1);
            System.out.println("r size "+result.size());
        }

        count=result.size();
    }

    private OutlierInfo setValues(int id,String month,int year)
    {
        OutlierInfo a = new OutlierInfo(); 
        a.setSerialId(id);
        a.setMonth(month);
        a.setYear(year);

        return a;
    }

    public static void main(String[] args)
    {
        ArraylistSort as=new ArraylistSort();
    }
} 
```

我收到以下错误：有人可以帮我理解错误吗？我有任何逻辑错误吗？

```
initial size 0
result size1
result size2
result size3
result size4
result size5
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 6, Size: 6
result size6
result size7
result size8
    at java.util.ArrayList.RangeCheck(ArrayList.java:547)
    at java.util.ArrayList.get(ArrayList.java:322)
    at STAnalysis.ArraylistSort.<init>(ArraylistSort.java:56)
    at STAnalysis.ArraylistSort.main(ArraylistSort.java:98)
Java Result: 1 
```

# 更新

当前面临的最大困惑是，当我实际将对象添加到数组列表时，会引发错误“索引超出范围”！

# 更新

我修好了。原来我把花括号弄乱了。我的最终代码

```
public class StAnamoliesSequencer 
{
    ArrayList<OutlierInfo> stAnomalies =new ArrayList();//arraylist of spatio-temporal outliers
    ArrayList<ArrayList<OutlierInfo>> sequencedStAnomalies=new ArrayList<ArrayList<OutlierInfo>>();
    int firstElement;

    public StAnamoliesSequencer()
    {
         firstElement=0;      
    }

    public ArrayList<ArrayList<OutlierInfo>> sequenceStAnomalies(ArrayList<OutlierInfo> sTanomalies)
    {      

         int loopSizeDeterminer;//determines teh size of the inner loop and is dynamic.

        for(int index=0;index<sTanomalies.size();index++)
        {  
            OutlierInfo stOutlier=new OutlierInfo();
            stOutlier=sTanomalies.get(index);
            stAnomalies.add(index, stOutlier);
        }

           loopSizeDeterminer=stAnomalies.size();

           while(stAnomalies.size()!=0)
             {      
                   OutlierInfo stOutlier1=new OutlierInfo();
                   ArrayList<OutlierInfo> tracker=new ArrayList();//arraylist that stores the grouped Outliers to be deleted later
                   stOutlier1=stAnomalies.get(firstElement);
                   ArrayList<OutlierInfo> similarOutlier=new ArrayList();//similaroutliers are kept in an arraylist
                   similarOutlier.add(stOutlier1);
                   tracker.add(stOutlier1);

                for(int index=1;index<loopSizeDeterminer;index++)
                {    
                     OutlierInfo stOutlier2=new OutlierInfo();
                     stOutlier2=stAnomalies.get(index);

                               if(stOutlier1.serialId==stOutlier2.serialId)
                               {  
                                   similarOutlier.add(stOutlier2);
                                   tracker.add(stOutlier2);
                               }

                }

                System.out.println("partiainfosize \t"+similarOutlier.size());

                sequencedStAnomalies.add(similarOutlier);//adding arraylist of similar outliers to the arraylist of arraylist

                for(int index=0;index<tracker.size();index++)
                {
                     OutlierInfo groupedOutlier=new OutlierInfo();
                     groupedOutlier=tracker.get(index);
                     stAnomalies.remove(groupedOutlier);//grouped outliers are removed from original arraylist containing spatio-temporal outliers to reduce redundancy
                }

                System.out.println(" size "+stAnomalies.size());
                loopSizeDeterminer=stAnomalies.size();

    }
        return sequencedStAnomalies;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T18:24:47.757

嘿，我运行了你的代码并检查了它。这是输出

```
结果大小1
结果大小2
结果大小3
结果大小4
结果大小5
结果大小6
结果大小7
结果大小8
部分信息大小1
尺码 7
部分信息大小1
尺码 6
部分信息大小1
尺码 5
部分信息大小1
尺码 4
部分信息大小1
r 尺寸 3
部分信息大小1
尺码 2
部分信息大小1
尺码 1
部分信息大小1
r 大小 0
```

检查其他 IDE，如果您使用 eclipse（尝试在 Netbeans 中）并检查是否仍有错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:05:55.777

请仔细阅读：

`Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 6, Size: 6`

自 1970 年以来，java 和大多数现代编程语言中的数组索引 :) 从 0 开始。如果您的数组长度为 6 个元素，则其索引必须在 0 ... 5 的范围内。

我希望现在您有足够的信息来调试代码并找到错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:09:10.637

```
Exception in thread "main" java.lang.IndexOutOfBoundsException: Index: 6, Size: 6 
```

表示您有一个大小为 6 的数组列表，并且您正在尝试访问第 6 个索引处的元素。**这是错误的**

请记住，arraylist 索引是零索引的。因此，如果您的数组列表大小为 6，则要访问第 6 个元素，您应该这样做

```
al.get(5). 
```

我的猜测是，您的计数是 6，因此您的循环应该是

```
 for(int j=0;j<count-1;j++)
                {      
                     OutlierInfo info2=new OutlierInfo();
                     info2=result.get(j);

         /// continue your code 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:16:28.880

你得到一个索引越界异常，这几乎总是程序员的错误。但是，我采用了您发布的确切代码，它运行良好，没有例外。我意识到您的错误在 ArrayListSort.java:98 中显示错误，因此第 98 行您发布的类只有 59 行！因此，您正在运行自己课程的错误版本，请确保您正在运行您发布的课程。这就是问题所在。

我未修改运行您发布的代码的结果

结果大小1 结果大小2 结果大小3 结果大小4 结果大小5 结果大小6 结果大小7 结果大小8 partiainfosize1 r 大小7 partiainfosize1 r 大小6 partiainfosize1 r 大小5 partiainfosize1 r 大小4 partiainfosize1 r 大小3 partiainfosize1 r 大小2 partiainfosize1 r 大小1 partiainfosize1 r 大小0

# html - 页面无故换行

> ID：12731253
> 
> 赞同：2
> 
> 时间：2012-10-04T16:02:29.277
> 
> 标签：html, css

我已经更新了我[网站上](http://www.s-maof.com/Forum/forum.php)的横幅。有无法解释的超出边距（从左边第一个到左边第二个之间）。边距是 HTML 中的新行，但没有任何推子元素来容纳它。有点奇怪。

我试图设置一个[jsfiddle](http://jsfiddle.net/opmaster/L3j98/4/)，但那里不存在错误。

这是代码：

```
<br>
<div class="invisible_box">
    <a class="overlay" onclick="window.open('http://www.s-maof.com/LandingPages/PRO/','PRO','scrollbars=yes, toolbar=no,status=no, width=570,height=650')"></a>
    <object type="application/x-shockwave-flash" data="http://s-maof.com/stuff/bannerPro150x75.swf" width="150" height="75">
        <param name="movie" value="http://s-maof.com/stuff/bannerPro150x75.swf" />
        <param name="quality" value="high" />
        <param name="wmode" value="transparent" />
        <param name="loop" value="false" />
    </object>
</div>

<div class="invisible_box" style="z-index: 7000">
    <a class="overlay" style="cursor:auto;"></a>
    <object type="application/x-shockwave-flash" data="http://s-maof.com/stuff/tachlit-150x150.swf" width="150" height="150">
        <param name="movie" value="http://s-maof.com/stuff/tachlit-150x150.swf" />
        <param name="quality" value="high" />
        <param name="wmode" value="transparent" />
        <param name="loop" value="false" />
   </object>               
</div> 
```

和CSS：

```
.invisible_box {
    height: 75px;
    margin-bottom: 5px;
    position: relative;
    width: 150px;
}
.overlay {
    background: none repeat scroll 0 0 white;
    display: block;
    height: 75px;
    left: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    width: 150px;
    z-index: 10000;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:14:11.903

div 后面有三个不可见[`U+200B`](http://www.fileformat.info/info/unicode/char/200b/index.htm)的字符，它们可能是原因。源代码显示了这一点（在允许您查看的文本编辑器中查看）：

```
<div class="invisible_box">
    <a class="overlay" onclick="window.open('http://www.s-maof.com/LandingPages/PRO/','PRO','scrollbars=yes, toolbar=no,status=no, width=570,height=650')"></a>
    <object type="application/x-shockwave-flash" data="http://s-maof.com/stuff/bannerPro150x75.swf" width="150" height="75">
        <param name="movie" value="http://s-maof.com/stuff/bannerPro150x75.swf" />
        <param name="quality" value="high" />
        <param name="wmode" value="transparent" />
        <param name="loop" value="false" />
    </object>
</div>​​​&lt;U+200B><U+200B><U+200B> 
```

正如 Tiby 所指出的，它们可能会导致您在 Chrome 控制台上看到的流氓元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T16:09:31.203

在 Google Chrome 控制台中，如果您查看该区域，则在第一个横幅和第二个横幅之间有一个大的空白文本块（它出现在引号之间）。我刚刚删除了它，两个横幅之间的空白就消失了。试试看。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T16:16:19.677

尝试在其中插入 html 注释`<!-- -->`

```
<div class="invisible_box">
            <a class="overlay" onclick="window.open('http://www.s-maof.com/LandingPages/PRO/','PRO','scrollbars=yes, toolbar=no,status=no, width=570,height=650')"></a>
            <object type="application/x-shockwave-flash" data="http://s-maof.com/stuff/bannerPro150x75.swf" width="150" height="75">
                <param name="movie" value="http://s-maof.com/stuff/bannerPro150x75.swf" />
                <param name="quality" value="high" />
                <param name="wmode" value="transparent" />
                <param name="loop" value="false" />
            </object>
        </div><!--

                --><div class="invisible_box" style="z-index: 7000">
<a class="overlay" style="cursor:auto;"></a>
    <object type="application/x-shockwave-flash" data="http://s-maof.com/stuff/tachlit-150x150.swf" width="150" height="150">
        <param name="movie" value="http://s-maof.com/stuff/tachlit-150x150.swf" />
        <param name="quality" value="high" />
        <param name="wmode" value="transparent" />
        <param name="loop" value="false" />
   </object>      

</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:35:24.353

谢谢大家和@Mr_Green，

隐藏了三个字符，是我复制代码到记事本才发现的！！vbulletin 编辑器（我的网站框架）中没有显示。

很有意思..

# php - 使用 JQuery/javascript 下载由 POST 请求生成的文件

> ID：12731254
> 
> 赞同：1
> 
> 时间：2012-10-04T16:02:34.180
> 
> 标签：php, javascript, jquery, html

将 POST 数据发送到服务器后是否可以显示下载对话框？

因为我需要许多复杂的值，“只是”使用带有方法 post 的 HTML 表单是行不通的。

到目前为止，我使用 GET 方法的方式如下：

```
$("form").submit(function() {
    window.location.href = 'upload.php?url='+$(".url").val()+'&host='+$(".host.clicked").attr("host");      
    return false;
} 
```

其中，location.href 将提示我一个不错的下载对话框，因为 upload.php 返回文件的标题。

现在的问题是我想让用户选择将文件上传到表单，这不适用于我正在使用的 GET url 方法。

那么如何在使用 AJAX 和 POST 将数据发送到服务器后显示下载对话框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:03:46.800

您不能使用 AJAX 下载文件。

相反，您应该让表单正常提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:26:22.393

upload.php 可以是 POST 表单的操作。

1.  用户从他的计算机中选择一个文件
2.  用户提交 POST 表单到 upload.php
3.  upload.php 做任何需要做的事情
4.  upload.php 返回文件的标头
5.  用户获取下载对话框

# magento - addCategoryFilter 的多个类别

> ID：12731255
> 
> 赞同：0
> 
> 时间：2012-10-04T16:02:39.703
> 
> 标签：magento

是否有解决方法来操作 addCategoryFilter 方法，以便它可以过滤多个类别？我已经尝试过使用下面的代码，但它没有用。

```
class ModuleName_Catalog_Model_Resource_Eav_Mysql4_Product_Collection
extends Mage_Catalog_Model_Resource_Eav_Mysql4_Product_Collection{

public function addCategoriesFilter($categories){

$alias = 'cat_index';
$categoryCondition = $this->getConnection()->quoteInto(
$alias.'.product_id=e.entity_id AND '.$alias.'.store_id=? AND ',
$this->getStoreId()
);

$categoryCondition.= $alias.'.category_id IN ('.$categories.')';

$this->getSelect()->joinInner(
array($alias => $this->getTable('catalog/category_product_index')),
$categoryCondition,
array('position'=>'position')
);

$this->_categoryIndexJoined = true;
$this->_joinFields['position'] = array('table'=>$alias, 'field'=>'position' );

return $this;

}
} 
```

我也在下面尝试过这段代码，它也没有工作。

```
->addAttributeToFilter('category_ids',array('finset'=>'3','finset'=>'4')) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:35:10.117

您可以将下一个代码插入到您的扩展集合方法中（where `$collection`will be ） - 或者在之前定义为产品集合的`$this`其他地方使用它：`$collection`

```
$catIds = array('3', '4');
$tableAlias = 'cat_prod_idx';
$connection = $collection->getResource()->getReadConnection();
$conditions = array(
    "{$tableAlias}.product_id = e.entity_id",
    $connection->quoteInto("{$tableAlias}.store_id = ?", $collection->getStoreId()),
    $connection->quoteInto("{$tableAlias}.category_id in (?)", $filters)
);
$collection->getSelect()
    ->group('e.entity_id')
    ->join(
        array($tableAlias => $collection->getTable('catalog/category_product_index')),
        join(' AND ', $conditions),
        array()
    ); 
```

# ios - 在模拟器中运行时出现“线程 1：信号 SIGARBT”错误

> ID：12731256
> 
> 赞同：0
> 
> 时间：2012-10-04T16:02:45.393
> 
> 标签：ios, uitableview, nsthread

我对此很陌生，但是当我尝试在 iOS 模拟器上进行模拟时，它会停止，然后弹出此错误……我在情节提要中为我的表格视图添加了一个视图控制器。我将包含该文件，以便你们有足够的信息来帮助我。

我只是想让我的表格视图显示数组的一些元素。导航控制器是根视图控制器，它直接进入我要显示数组课程的表视图控制器。

这是我的应用程序

```
//AppDeligate.m

#import "AppDelegate.h"
#import "CoursesViewController.h"
#import "Courses.h"

@implementation AppDelegate{
    NSMutableArray *courses;}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions 
(NSDictionary *)launchOptions
{
    courses = [NSMutableArray arrayWithCapacity:20];
    Courses *course = [[Courses alloc] init];
    course.code = @"SFWR 3X03";
    course.units = 3;
    [courses addObject:course];
    UINavigationController *navigationController =
    (UINavigationController *)self.window.rootViewController;
    CoursesViewController *CoursesViewController =
    [[navigationController viewControllers] objectAtIndex:1];
    CoursesViewController.courses = courses;
    return YES;
} 
```

这是我的 CoursesViewController.m

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
#warning Potentially incomplete method implementation.
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
#warning Incomplete method implementation.
    // Return the number of rows in the section.
    return [self.courses count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath     
*)indexPath
{
    UITableViewCell *cell = [tableView
                             dequeueReusableCellWithIdentifier:@"PlayerCell"];
    Courses *course = [self.courses objectAtIndex:indexPath.row];
    cell.textLabel.text = course.code;
    return cell;
} 
```

这是我的课程viewcontroller.h

```
#import <UIKit/UIKit.h>

@interface CoursesViewController : UITableViewController
@property (nonatomic, strong) NSMutableArray *courses;

@end 
```

这是我的课程.m 和课程.h

```
#import "Courses.h"

@implementation Courses

@synthesize code;
@synthesize units; 
```

.

```
#import <Foundation/Foundation.h>

@interface Courses : NSObject

@property (nonatomic, copy) NSString *code;
@property (nonatomic, assign) int units;
@end

@end 
```

当我尝试在模拟器中运行时，它会翻转到 main.m 文件并在线程 1 上显示 SIGARBT 错误。

如果我没有包含足够的信息，请告诉我并发布更多信息。

控制台输出：

```
2012-10-04 14:44:14.726 MacMarks[475:c07] *** Terminating app due to uncaught exception     
'NSInternalInconsistencyException', reason: '-[UITableViewController loadView] loaded the     
"fBI-R0-7j9-view-iYf-OA-4cJ" nib but didn't get a UITableView.'
*** First throw call stack:
(0x1c8e012 0x10cbe7e 0x1c8ddeb 0x242417 0xf4648 0xf4882 0xf4b2a 0x10bef5 0x10bfdb 0x10c286    
0x10c381 0x10ceab 0x10cfc9 0x10d055 0x2123ab 0x6392d 0x10df6b0 0x228afc0 0x227f33c   
0x228aeaf 0x1028cd 0x4b1a6 0x49cbf 0x49bd9 0x48e34 0x48c6e 0x49a29 0x4c922 0xf6fec 0x43bc4 
0x43dbf 0x43f55 0x4cf67 0x10fcc 0x11fab 0x23315 0x2424b 0x15cf8 0x1be9df9 0x1be9ad0   
0x1c03bf5 0x1c03962 0x1c34bb6 0x1c33f44 0x1c33e1b 0x117da 0x1365c 0x22fd 0x2225)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:14:26.917

由于您使用的是故事板，因此您无需在代码中执行任何操作来实例化导航控制器或 CoursesViewController（您发布的所有内容都应删除，而不是“返回是”）。要将数组放入 CoursesViewController，请将以下代码添加到其 viewDidLoad 方法中：

```
 self.courses = [NSMutableArray arrayWithCapacity:20];
    Courses *course = [[Courses alloc] init];
    course.code = @"SFWR 3X03";
    course.units = 3;
    [courses addObject:course];
    [super viewDidLoad];
    [self.tableView reloadData]; 
```

我假设您的 .h 文件中有一个名为 courses 的属性（类型为强）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T22:45:28.973

阅读评论，很难说出您要解决的问题，但是这个错误......

```
'-[UITableViewController loadView] loaded the     
"fBI-R0-7j9-view-iYf-OA-4cJ" nib but didn't get a UITableView.' 
```

...是说连接到表格视图控制器中插座的对象`view`不是. 查看情节提要中的该控制器并检查链接的内容。`UITableView``UITableView``view`

# php - 如何将数组元素传递给ajax？

> ID：12731258
> 
> 赞同：1
> 
> 时间：2012-10-04T16:02:48.650
> 
> 标签：php, jquery

我在将元素数组传递给 Ajax 请求时遇到问题。应该怎么做？

```
var category = $('select[name="category[]"]').serialize();
$.post(host + '/form/ajax.php', {
    category:category
},
function(data) {
    console.log(data);
}); 
```

在 PHP 中，我需要知道有多少类别元素，例如：

```
 <?php echo count($_POST['category']) ?>
  // should return 3 
```

HTML

```
<select name="category[]">
   <option value="1">CPU</option>
   <option selected value="2">Hard Drive</option>
</select>

<select name="category[]">
   <option value="1">CPU</option>
   <option selected  value="2">Hard Drive</option>
</select>

<select name="category[]">
   <option selected value="1">CPU</option>
   <option value="2">Hard Drive</option>
</select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:05:03.130

请改用[serializeArray](http://api.jquery.com/serializeArray/)。

```
var category = $('select[name="category[]"]').serializeArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:58:00.297

您在第一次 serialize() 数据时进行双重序列化，然后通过执行 {category: category} 将序列化数据分配给 POST 参数。相反，您应该只发送“类别”。

```
var category = $('select[name="category[]"]').serialize();
$.post(host + '/form/ajax.php',
    category,
    function(data) {
        console.log(data);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:04:02.693

尝试这个

```
$.post(host + '/form/ajax.php', {
    'category[]':category
} 
```

# windows-phone-7 - 透视项目数据模板

> ID：12731262
> 
> 赞同：1
> 
> 时间：2012-10-04T16:03:14.457
> 
> 标签：windows-phone-7, xaml, datatemplate

我想按照[本教程](http://babaandthepigman.wordpress.com/2010/09/20/data-binding-pivot-control-wp7-mvvm/)使用绑定来填充我的数据透视页。它工作得很好，除了 1 个事实。我的内容没有发挥最大潜力。

**普通的：**

![正常按钮填充](../Images/c0632d6bf61cdefc63999573150b5e47.png)

**XAML：**

```
<controls:Pivot Title="MY APPLICATION">
    <!--Pivot item one-->
    <controls:PivotItem Header="item1">
        <Button Content="test" />
    </controls:PivotItem>

    <!--Pivot item two-->
    <controls:PivotItem Header="item2">
        <Grid/>
    </controls:PivotItem>
</controls:Pivot> 
```

**带绑定：**

![装订按钮填充](../Images/5b4688b5b9f344d7ca1e7fd1fece6d78.png)

**XAML：**

```
<phone:PhoneApplicationPage.Resources>
    <DataTemplate x:Key="TheShopApp.UI.ViewModels.TestPivotItemViewModel">
        <Button Content="Test" />
    </DataTemplate>
</phone:PhoneApplicationPage.Resources> 
```

* * *

```
<controls:Pivot Title="{Binding Path=ApplicationName}" ItemsSource="{Binding Path=PivotItems}">
    <controls:Pivot.HeaderTemplate>
        <DataTemplate>
            <Grid x:Name="grid">
                <TextBlock TextWrapping="Wrap"
                    Text="{Binding PivotTitle}"
                    d:LayoutOverrides="Width, Height" />
            </Grid>
        </DataTemplate>
    </controls:Pivot.HeaderTemplate>
    <controls:Pivot.ItemTemplate>
        <DataTemplate>
            <helpers:DataTemplateSelector Content="{Binding}" />
        </DataTemplate>
    </controls:Pivot.ItemTemplate>
</controls:Pivot> 
```

所以现在我的问题是：我怎样才能让我的绑定内容看起来像正常内容？我发现[这个问题](https://stackoverflow.com/questions/135375/how-do-i-make-a-wpf-data-template-fill-the-entire-width-of-the-listbox)有点相同，但我不知道如何实现它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T09:00:18.047

我需要将以下 XAML 添加到模板选择器：`HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"`

**XAML：**

```
<phone:PhoneApplicationPage.Resources>
    <DataTemplate x:Key="TheShopApp.UI.ViewModels.TestPivotItemViewModel">
        <Button Content="Test" />
    </DataTemplate>
</phone:PhoneApplicationPage.Resources> 
```

* * *

```
<controls:Pivot Title="{Binding Path=ApplicationName}" ItemsSource="{Binding Path=PivotItems}">
    <controls:Pivot.HeaderTemplate>
        <DataTemplate>
            <Grid x:Name="grid">
                <TextBlock TextWrapping="Wrap"
                    Text="{Binding PivotTitle}"
                    d:LayoutOverrides="Width, Height" />
            </Grid>
        </DataTemplate>
    </controls:Pivot.HeaderTemplate>
    <controls:Pivot.ItemTemplate>
        <DataTemplate>
            <helpers:DataTemplateSelector HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Content="{Binding}" />
        </DataTemplate>
    </controls:Pivot.ItemTemplate>
</controls:Pivot> 
```

# c# - 避免破坏生成的代码

> ID：12731263
> 
> 赞同：3
> 
> 时间：2012-10-04T16:03:20.490
> 
> 标签：c#, .net, attributes, visual-studio-debugging

我正在使用一些外部代码，当使用某些参数调用它们时会引发可以忽略的异常。不幸的是，由于各种原因，我无法更改此外部代码。

我创建了一个看起来像这样的包装方法：

```
 [DebuggerStepThrough]
    public static bool TryGetXXX(string input, out string output)
    {
        try
        {
            output = MethodThatSometimesFails(input);
            return true;
        }
        catch
        {
            output = null;
            return false;
        }
    }

    private static string MethodThatSometimesFails(string input)
    {
        // Don't want this to cause a break
        // but can not put the attribute on this method
        throw new Exception("couldnt deal with your request");
    } 
```

不幸的是，外部代码仍然会在内部的异常处中断`MethodThatSometimesFails`。`[DebuggerStepThrough]`只会避免调试上面的代码，但被调用的代码仍然会抛出。

我想要的是，即使选中了“异常...”窗口上的所有复选框，代码也会运行。有没有可以做到这一点的属性？

如果没有属性，我可以创建一个包含这些类/方法的项目并排除整个项目。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:24:36.033

尝试使用[DebuggerNonUserCodeAttribute标记方法或类](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggernonusercodeattribute.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T20:02:31.770

如果您知道有效参数是什么，请在调用函数之前检查它们。如果它们无效，请不要调用该函数。

尽量保持乐观并消除对异常的依赖，这可能代价高昂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T15:23:06.050

找不到解决方案。最后唯一的选择是将 TryGet 放入另一个 DLL 中！

# json - 如何从 ASP 中的请求表单中读取 json

> ID：12731267
> 
> 赞同：0
> 
> 时间：2012-10-04T16:03:29.570
> 
> 标签：json, asp-classic

我想知道当 JSON 直接来自另一台服务器时，我如何读取它，比如表单。我必须请求和处理 JSON。

```
dim datos: set datos = json.parse(BodyJson)
    dim key : for each key in datos.keys() 
        Status = datos.get(key).category 
        FechaHoraEnvio = datos.get(key).date 
        DireccionEmail =  datos.get(key).recipient
        InfoExtra = datos.get(key).tags
        ID= 123
        sSQL = "INSERT INTO EmailsStatus (Id, Status, FechaHoraEnvio, DireccionEmail, InfoExtra) VALUES ('"& ID &"', '"& Status &"', '"& FechaHoraEnvio &"', '"& DireccionEmail &"', '"& InfoExtra &"')"
        Response.write sSql
        objAccessDB.excecuteQuery(sSQL)
    next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T09:56:37.220

尝试使用

```
dim datos: set datos = json.parse(BodyJson)
dim key : for each key in datos.keys()
    if (key = "category") then Status = datos.get(key)
    if (key="date") then FechaHoraEnvio = datos.get(key)
    if (key = "recipient") then DireccionEmail =  datos.get(key)
    if (key = "tags") then InfoExtra = datos.get(key)
    ID= 123
    sSQL = "INSERT INTO EmailsStatus (Id, Status, FechaHoraEnvio, DireccionEmail, InfoExtra) VALUES ('"& ID &"', '"& Status &"', '"& FechaHoraEnvio &"', '"& DireccionEmail &"', '"& InfoExtra &"')"
    Response.write sSql
    objAccessDB.excecuteQuery(sSQL)
next 
```

# git - EGit 显示目录总是脏的

> ID：12731270
> 
> 赞同：13
> 
> 时间：2012-10-04T16:03:39.620
> 
> 标签：git, eclipse-plugin, egit

我开始在 Eclipse 中使用 EGit，我的一个目录（包含许多子模块和常规目录）总是显示为脏。我试图`git reset --hard`从头开始重新创建项目。如果我选择目录并与 git index 或 HEAD 比较，它不会显示任何更改。

如果我在文件夹的命令行上使用 git，`git status`则不会显示任何待处理的更改并`git submodule`正确列出所有子模块。使用 EGit，我尝试设置`Assume Unhanged`选项。但这也会传播到子目录（这是不可取的）。

我正在使用 Eclipse 4.2.1、EGit 2.1.0 和 Geppetto 3.0.0。还有什么可能导致该目录始终显示为脏？有什么方法可以忽略对此目录的更改（但仍会更改兄弟姐妹）？

更新 - 2013 年 10 月 2 日：

*   在[https://bugs.eclipse.org/bugs/show_bug.cgi?id=391280](https://bugs.eclipse.org/bugs/show_bug.cgi?id=391280)有一个开放的功能请求来支持这个。
*   从评论看来，一个子模块可能被认为是一个符号链接，并且为实现此支持所做的工作位于[https://bugs.eclipse.org/bugs/show_bug.cgi?id=354367](https://bugs.eclipse.org/bugs/show_bug.cgi?id=354367)。
*   正在完成的工作的 Gerrit 分支信息位于[https://git.eclipse.org/r/#/q/status:open+project:jgit/jgit+branch:master+topic:symlinks,n,z](https://git.eclipse.org/r/#/q/status:open+project:jgit/jgit+branch:master+topic:symlinks,n,z)。

更新 - 2014 年 9 月 24 日：

*   [https://bugs.eclipse.org/bugs/show_bug.cgi?id=429304](https://bugs.eclipse.org/bugs/show_bug.cgi?id=429304)上还有一个额外的伞形错误，可以针对特定于 EGit 的问题进行跟踪。
*   我不再使用 Eclipse 或 EGit，而是使用 Git Plus 插件迁移到 Atom。问题解决后，我将尝试继续更新。但是 Atom 和 Git Plus 现在让我更满意了，这个问题目前与我无关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:07:40.680

这也可能是由于推送到远程仓库的多个人之间的行尾差异、远程仓库（通常是裸露的，但特定于操作系统的行尾）以及您的 git 设置。这是您可以验证的吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-14T16:09:52.677

这个解决方法为我修复了它。用“Assume Unchanged”标记父文件夹，但用“No Assumed Unchanged”标记所有子文件夹。

例如，我在项目根目录下的 modules/Services 中添加了一个子模块。我用“Assume Unchanged”标记了模块，它删除了脏标志。然后我用“No Assume Unchanged”标记了所有子文件夹（模块/实体，模块/服务，...）。

团队 -> 高级 -> “假定未更改”/“没有假定未更改”

我不认为这是完美的，如果我在模块下有单独的文件，如果修改它们可能不会显示为脏。

# protocol-buffers - 如何判断序列化协议缓冲区中的消息类型？

> ID：12731271
> 
> 赞同：1
> 
> 时间：2012-10-04T16:03:39.610
> 
> 标签：protocol-buffers

我以为每次我不使用预期的消息类`InvalidProtocolBufferException`时都会得到一个尝试。`parseFrom(bytes)`

我的代码如下所示：

```
try {

    LoginMessage msg = LoginMessage.parseFrom(bytes);
    // ... use msg ...

} catch(InvalidProtocolBufferException exception) {

    ErrorMessage error = ErrorMessage.parseFrom(bytes);
    // ... do something ...
} 
```

我的信息是：

```
message LoginMessage
{
required Status status = 1;
optional UserMessage user= 2;
}     

message ErrorMessage
{
required Error error = 1;
} 
```

哪里`TeamStatus`和`Error`是*Enums*。

当我执行应该导致 a 的代码时`ErrorMessage`，它会解析为 a`LoginMessage`并混淆两个枚举：`error`字段与`status`字段。

那么我怎么能区分这两种类型的消息呢？

似乎它使用结构类型进行优化，因此它不传输字段名称或消息类型，但是解决这个问题的实际方法是什么？我不想在中插入`ErrorMessage`并`LoginMessage`总是返回 a `LoginMessage`。

我考虑将`error`字段索引设置为其他消息不会使用的数字，例如`ErrorMessage error = 15000;`，但我不知道这是否正确，也不知道它是否总是有效（想象一下，如果所有字段`LoginMessage`都是可选的，它会起作用吗？） .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:30:37.680

No, that won't error. Enums are just integers when serialized, and unexpected values are stored in the extension data - so field 1 is entirely interchangeable between the messages. Since "user" is optional, it won't matter if it isn't there - and if it *is* there but isn't expected, it will be stored in the extension data.

> It seems that it uses structural typing for optimization, so it doesn't transmit field names or message types

That is correct; **only** field numbers and data are transferred. No names.

The best way to tell messages apart is via some kind of prefix. The easiest way t do this is with a wrapper message:

```
 message SomeWrapper {
     optional LoginMessage login = 1;
     optional ErrorMessage error = 2;
 } 
```

Then when deserializing, just check which field has a value. Obviously when serialising you'll need to wrap the value in a SomeWrapper, too. Note that optional values that aren't included incur zero cost.

# java - 在 Windows XP SP2 中使用 java (ver-7) 设置文件的所有者

> ID：12731277
> 
> 赞同：2
> 
> 时间：2012-10-04T16:03:47.270
> 
> 标签：java

这是代码：

```
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.Files;
import java.nio.file.attribute.UserPrincipalLookupService;
import java.nio.file.attribute.UserPrincipal;
import java.nio.file.FileSystems;
import java.lang.UnsupportedOperationException;
import java.io.IOException;

public class SetOwnerOfFile{
    public static void main(String args[]){
        Path path=Paths.get("c:\\demotext.txt");
        try{
            UserPrincipal owner=Files.getOwner(path);
            System.out.format("The owner of file is: %s%n",owner.getName());

            UserPrincipalLookupService lookupservice=FileSystems.getDefault().getUserPrincipalLookupService();
            Files.setOwner(path,lookupservice.lookupPrincipalByName("joe"));

            UserPrincipal newowner=Files.getOwner(path);
            System.out.format("Now the owner of file is: %s%n",newowner.getName());
        }
        catch(UnsupportedOperationException x){
            System.err.println(x);
        }
        catch(IOException x){
            System.err.println(x);
        }
    }
} 
```

**输出：**
文件的所有者是：\Everyone
java.nio.file.attribute.UserPrincipalNotFoundException

程序抛出 IOException。这是否意味着我的操作系统限制了对文件所有者的修改？如果没有，请建议我一些解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:26:22.733

我验证你的代码。**问题不在于更新，`owner`而是找到`UserPrincinpal`.** 如果您分解以下陈述：

```
 UserPrincipalLookupService lookupservice=FileSystems.getDefault().getUserPrincipalLookupService();
        Files.setOwner(path,lookupservice.lookupPrincipalByName("joe")); 
```

像这样：

```
 UserPrincipalLookupService lookupservice=FileSystems.getDefault().getUserPrincipalLookupService();
        UserPrincipal userPrincipal = lookupservice.lookupPrincipalByName("joe");
        Files.setOwner(path,userPrincipal); 
```

您将在第二行遇到问题。可能**无法找到名称为 "joe" 的现有 "Windows 用户"**。

我用我的 Windows 用户尝试了这个，并且成功地更改了所有者。

# .net - GC.WaitForPendingFinalizers() 在什么情况下会阻塞在 .NET 中？

> ID：12731280
> 
> 赞同：2
> 
> 时间：2012-10-04T16:03:55.133
> 
> 标签：.net, multithreading, garbage-collection, finalizer

[引用GC.WaitForPendingFinalizers()](http://msdn.microsoft.com/library/system.gc.waitforpendingfinalizers.aspx)的 MSDN 文档：

> 运行终结器的线程未指定，因此无法保证此方法会终止。

我真的不明白这句话。这个方法在什么情况下不会终止？这与终结器运行的线程有什么关系？为什么他们说线程是“未指定的”？

关于终结器线程，我假设以下是正确的（？）：

*   只有*一个*终结器线程。
*   终结器总是在单独的线程上运行（即从不在主线程或任何其他用户创建的线程上）。

*注意：*我可以想象这个方法会在终结器之一阻塞时阻塞，但是无论终结器使用什么线程，这个问题都存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:13:19.980

来自[MSDN 上的另一篇文章](http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx)：

> 在以下异常情况下，Finalize 方法可能不会运行完成或根本不会运行：
> 
> *   另一个终结器无限期地阻塞（进入一个无限循环，试图获得一个它永远无法获得的锁，等等）。因为运行时会尝试运行终结器以完成，所以如果终结器无限期地阻塞，则可能不会调用其他终结器。
>     
>     
> *   该进程在没有给运行时清理机会的情况下终止。在这种情况下，运行时的第一个进程终止通知是 DLL_PROCESS_DETACH 通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:10:21.767

首先，你通常不需要在 GC 类中使用方法，可能除了 SuppressFinalize。大多数其他方法通常会使您的应用程序性能最差，而不是更好。

但是，为了回答你的问题，据我所知，当收集执行时，终结器的垃圾收集器持有一个内部列表来运行，**它们都在同一个线程上按顺序运行**。这意味着，如果一个终结器阻塞，那么我猜这个方法也会阻塞。

当应用程序域关闭时，所有终结器都有时间限制，在这种情况下，我想这并不重要。

# java - 将 SecureRandom 与 SHA-256 一起使用

> ID：12731283
> 
> 赞同：9
> 
> 时间：2012-10-04T16:04:08.637
> 
> 标签：java, cryptography, sha, prng

我一直在使用带有种子 SHA1PRNG 算法的 SecureRandom 在两个进程之间创建共享随机性。我最近了解到，根据 NIST 的标准，SHA1 已被弃用，因此我们正在努力切换到 SHA256。我发现的问题是 SecureRandom 仅支持 SHA1PRNG，至少根据[Oracle 的文档](http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#SecureRandom)。我想知道是否有办法将 SecureRandom 与 SHA256 一起使用，或者可能更好，什么是使用 SecureRandom 的合适替代方案？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-05T18:55:31.907

大卫，据我了解，您指的是这份文件： [http ://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf](http://csrc.nist.gov/publications/nistpubs/800-131A/sp800-131A.pdf)

可能是，我错过了一些东西。但是，它说的是：

```
From January 1, 2011 through December 31, 2013, the use of SHA-1 is deprecated 
for digital signature generation. The user must accept risk when SHA-1 is used, 
particularly when approaching the December 31, 2013 upper limit. 
```

但是，下面说

```
For all other hash function applications, the use of SHA-1 is acceptable. The 
other applications include HMAC, Key Derivation Functions (KDFs), Random Number 
Generation (RNGs and RBGs), and hash-only applications (e.g., hashing passwords 
and using SHA-1 to compute a checksum, such as the approved integrity technique 
specified in Section 4.6.1 of [FIPS 140-2]). 
```

所以，据我所知，SHA1 可以用于随机数生成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T21:15:47.820

我总体上同意维克多的说法。但作为进一步说明，NIST SP800-131a 的第 4 节有一个表格，用于分隔不使用 RBG 的 RNG，如 NIST SP800-90 或 ANSI X9.62-2005 中所述，将在 2015 年超时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-29T10:28:52.530

对 Android (Java) 使用以下代码：

```
SecureRandom random = null;
if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.O) {
   random = SecureRandom.getInstanceStrong();
} else {
   random = SecureRandom.getInstance("NativePRNG");
} 
```

# java - 如何从带有嵌入标签的子文件夹中加载 Java 小程序类？

> ID：12731291
> 
> 赞同：1
> 
> 时间：2012-10-04T16:04:39.063
> 
> 标签：java, html, applet, embed

我在某个子目录中有一个 Java Applet 作为单个类文件（无 JAR 文件），我想将它嵌入到不同目录中的 HTML 页面上。我想`embed`为它使用标签。但我无法让它工作。到目前为止，这是我的代码：

```
<embed type="application/x-java-applet;version=1.6"
       width="512" height="512"
       code="subfolder/MyApplet.class" /> 
```

根据 Apache 日志文件，Class 文件已加载但无法启动。Java 说没有带有 name 的类`subfolder.MyApplet`。因此它将子目录视为包名。`codebase`参数（不知道这是否对 有效）`embed`没有任何区别。也许还有其他一些记录不充分的参数来指定从中加载类的代码库目录？

请注意，我的问题不是关于如何嵌入 Java 小程序。我知道如何使用已弃用`applet`的标签或`object`标签运行它，并将类打包到 JAR 文件中。我的问题是如何让它在这种特定情况下工作：

*   没有 JAR 文件，只有单个类文件。
*   类文件与 HTML 页面不在同一目录中。
*   使用`embed`标签。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:25:28.367

使用“嵌入”标签时，请考虑使用“代码库”标签。例如，

```
 <embed type="application/x-java-applet;version=1.6"
       width="512" height="512"
       code="MyApplet.class" 
       codebase="subfolder/"/> 
```

您应该能够在“代码库”标签中使用相对路径和绝对路径。

希望有帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:31:58.723

Try following:

```
<embed type="application/x-java-applet;version=1.6"
       width="512" height="512"
       codebase="subfolder/"
       code="MyApplet.class" /> 
```

Refer to [this documentation](http://docs.oracle.com/javase/1.4.2/docs/guide/plugin/developer_guide/using_tags.html).

# python - 在 DJANGO 项目中不读取 js 和 css 文件

> ID：12731293
> 
> 赞同：0
> 
> 时间：2012-10-04T16:04:43.267
> 
> 标签：python, django, media

我正在重新制定一个先前的问题，因为我认为它被表述为一个 Python 问题，但它是一个问题`Django`。

我正在从 github 安装一个名为[publicmarkup](https://github.com/sunlightlabs/publicmarkup)的项目：

主页显示在浏览器上，但没有读取加载任何媒体（js 文件和 css 文件）。有一个名为 mediasync 的模块似乎是正确显示模板的 css 和 js 文件所必需的。

我认为这是一个配置问题。这是链接[settings.py](https://github.com/sunlightlabs/publicmarkup/blob/master/settings.py)文件，在这里可以找到媒体文件夹的根路径。

这是[mediasync](https://github.com/sunlightlabs/django-mediasync#an-important-note-about-django-13)模块的文档，解释了如何配置 static_url

但是我什么都不懂，因为我是 djnago 的新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T18:24:44.877

*在 Django 中，您必须在开发*和*实时*模式下设置自己的工作站服务静态文件。

你可以在[这里](https://docs.djangoproject.com/en/dev/howto/static-files/)阅读。

[这](https://docs.djangoproject.com/en/dev/howto/static-files/#serving-static-files-in-development)解释了如何在您的*开发*环境中提供静态文件。

在实时模式下，您可以直接通过终端 Web 服务器（通常是 Apache 或 Nginx）提供静态文件。

# opengl-es - OpenGL ES：避免纹理之间的白线

> ID：12731294
> 
> 赞同：0
> 
> 时间：2012-10-04T16:04:52.283
> 
> 标签：opengl-es

我正在制作一个天空盒，每个纹理之间有一条非常小的白线，顶点和纹理的坐标似乎没问题（它只有 1 和 -1，所以我看不出有任何可能失败的方法）。

有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:41:32.400

TL;DR：简单的解决方案：改用立方体贴图纹理。

解释：

> （它只有 1 和 -1，所以我看不出有什么方法可以在那里失败）

好吧，纹理坐标 -1 和 1 不会落在像素中心。这基本上是一个栅栏问题，我在这里解释过

[https://stackoverflow.com/a/5879551/524368](https://stackoverflow.com/a/5879551/524368)

请注意，在天空盒的情况下，通过不在六个单独绘制的四边形上使用 6 个不同的纹理，*而是*使用立方体贴图纹理（其中六个边包含在类似球体的拓扑中的一个连续图像中），可以轻松避免该问题。

# wpf - 带有形状的渐变

> ID：12731295
> 
> 赞同：1
> 
> 时间：2012-10-04T16:04:54.980
> 
> 标签：wpf, xaml, styles, gradient

我需要为如下所示的元素创建背景

![在此处输入图像描述](../Images/8d2ff3e362239c8e095777fd16b7bf0e.png)

是否可以使用渐变或其他技术来实现这一点，还是我必须使用图像文件？

这只是我遇到问题的背景，而不是投影效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:23:27.113

如果你只想用一个元素来做，那么像;

```
<Border Width="300" Height="75"
                BorderThickness="3"
                CornerRadius="5">
            <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                    <GradientStop Color="#FFC4C3C3" Offset="0.429"/>
                    <GradientStop Color="#FFE9E9E9" Offset="0.652"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.BorderBrush>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFE9E9E9" Offset="0"/>
                    <GradientStop Color="#FFB9B6B6" Offset="1"/>
                </LinearGradientBrush>
            </Border.BorderBrush>
            <Border.Effect>
                <DropShadowEffect Direction="280" Color="#FF515050" BlurRadius="2"/>
            </Border.Effect>
        </Border> 
```

如果你想让你的曲线在渐变中，那么就像;

```
<Grid Width="300" Height="75">
        <Border 
                BorderThickness="3"
                CornerRadius="5">
            <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1" MappingMode="RelativeToBoundingBox" StartPoint="0.5,0">
                    <GradientStop Color="#FFC4C3C3" Offset="0.429"/>
                    <GradientStop Color="#FFE9E9E9" Offset="0.652"/>
                </LinearGradientBrush>
            </Border.Background>
            <Border.BorderBrush>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#FFE9E9E9" Offset="0"/>
                    <GradientStop Color="#FFB9B6B6" Offset="1"/>
                </LinearGradientBrush>
            </Border.BorderBrush>
            <Border.Effect>
                <DropShadowEffect Direction="280" Color="#FF515050" BlurRadius="2"/>
            </Border.Effect>
        </Border>
        <Path Data="M0,0 L300,0 L300,40.768158 L296.83832,41.189522 C253.5976,46.794456 203.45944,50.000004 150,50.000004 C96.540565,50.000004 46.402409,46.794456 3.1617098,41.189522 L0,40.768158 z" Fill="#FFDADADA" Margin="3" Height="50" VerticalAlignment="Top" Stretch="Fill" UseLayoutRounding="False"/>
        </Grid> 
```

您当然需要使用您的颜色和尺寸来获得您想要的东西，但这应该是您开始的好地方。干杯

# solr - 如何配置 solr 的 data-config.xml 来查询外键？

> ID：12731299
> 
> 赞同：0
> 
> 时间：2012-10-04T16:05:04.343
> 
> 标签：solr

我正在关注有关从[solr](http://wiki.apache.org/solr/DataImportHandler)导入数据的文档。我可以连接到本地数据库，但配置文件无法读取外键。我的桌子是：

```
product
------------
id
name
continent_id

continent
------------
id
name 
```

我`data-config.xml`的是：

```
<dataConfig>
  <dataSource type="JdbcDataSource" driver="org.postgresql.Driver" url="jdbc:postgresql://localhost/my_db" user="postgres" password="postgres" readOnly="true" />
  <document name="products">
    <entity name="product" query="select * from product">
      <field column="ID" name="id" />
      <field column="NAME" name="name" />

      <entity name="continent" query="select NAME from continent where id='${product.CONTINENT_ID}'">
        <field column="name" name="continent" />
      </entity>            
    </entity>
  </document>
</dataConfig> 
```

我看到的错误是：

```
SEVERE: Exception while processing: product document : SolrInputDocument[{id=id(1.0)={1}, name=name(1.0)={Fancy Pants}}]:org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: select NAME from continent where id='' Processing Document # 1 
```

它连接到数据库很好，但无法读取外键`product.CONTINENT_ID`。我是否需要以不同的方式配置上面的 xml 来读取和索引`continent`外键？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T07:28:21.353

确保 ${product.CONTINENT_ID} 用continent_id 写入，与表名的大小写完全相同。Solr 并不总是忽略这种情况（有时会，有时不会），因此请使用确切的情况以防万一。

# java - 从十进制值到字节数组的转换公式不起作用

> ID：12731301
> 
> 赞同：0
> 
> 时间：2012-10-04T16:05:27.993
> 
> 标签：java, byte, bytebuffer, short

我在二进制文件的规范中有一个公式。该规范详细说明了标题中各个字节的含义。
特别是，一个公式说明了大约 2 个字节：

```
Byte 1  -->  7  6  5  4  3  2  1  0  
Byte 2  -->  7  6  5  4  3  2  1  0 

R  Roll 
 If 'R' = 0, Roll Angle not available 
 If 'R' = 1, Roll Angle = [((Byte 84 & 0x7F)<<8) | (Byte 85) – 900] / 10 
```

我需要取一个值，例如 4.3 并将其转换为两个字节，以便能够使用上述公式将其转换回 4.3。最让我困惑的部分是减去 900。

这是我到目前为止所拥有的：

```
private byte[] getRollBytes(BigDecimal[] positionData) {

    BigDecimal roll = positionData[4];
    roll = roll.multiply(BigDecimal.TEN);
    roll = roll.add(new BigDecimal(900));
    short shortval = roll.shortValue();

    byte[] rollBytes = new byte[2];

    ByteBuffer headingbuf = ByteBuffer.wrap(rollBytes);
    headingbuf.order(ByteOrder.BIG_ENDIAN);
    headingbuf.putShort(shortval);

    //set the leftmost bit of the two bytes to 'on', meaning data is available
    rollBytes[0] = (byte) (rollBytes[0] | (0x80));

    //testing the result with my formula doesn't give me the right answer:
    float testFloat = (float) (((((rollBytes[0] & 0x7F) <<8) | rollBytes[1]) - 900) /10);           

    return rollBytes;
} 
```

我认为在短字节和字节之间的转换中丢失了一些东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:16:30.317

一个问题是您正在转换为`short`. 这不可能是正确的，因为像 4.3 这样的值不是整数。您可能想要转换回 BigDecimal：

```
BigDecimal testVal = ((rollBytes[0] & 0x7F) <<8) | rollBytes[1]) - 900;
testVal = val.divide(BigDecimal.valueOf(10)); 
```

另一个问题是您似乎将 900 添加了两次——一次是在计算时，另`shortVal`一次是`rollBytes[1] = (byte) (rollBytes[1] + 900);`

# email - 将 Get-WMI 数据添加到电子邮件正文

> ID：12731302
> 
> 赞同：1
> 
> 时间：2012-10-04T16:05:38.273
> 
> 标签：email, powershell-2.0

我有这个脚本，我发现它只是将脚本运行的时间通过电子邮件发送给收件人。

```
function send-email
{

$time = get-date 

$EmailFrom = “from”
$EmailTo = “To”
$Subject = “ADX Has Been Deployed”
$Body = “Script has been used on: ” + $time
$SMTPServer = “smtp.gmail.com”
$SMTPClient = New-Object Net.Mail.SmtpClient($SmtpServer, 587)
$SMTPClient.EnableSsl = $true
$SMTPClient.Credentials = New-Object System.Net.NetworkCredential(“e-mail address”, “password”);
$SMTPClient.Send($EmailFrom, $EmailTo, $Subject, $Body)
}

send-email 
```

这是一种享受，但是当我尝试使用以下代码（主机名、IP 地址等）将一些数据添加到电子邮件正文中时，数据将作为完整的字符串返回。

```
$a = @()
$systeminfo = get-wmiobject win32_computersystem | select *
foreach ($item in $systeminfo)
{
$a = $item
} 
```

基本上，我所追求的是将数据一次一行地显示在电子邮件中。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:52:00.373

```
$a = @()
$systeminfo = get-wmiobject win32_computersystem | select *
foreach ($item in $systeminfo)
{
   $a += $item
}
$body = [string]::Join("`n", $a) 
```

# jquery - 使用 jQuery Mobile 幻灯片转换保持滚动位置

> ID：12731303
> 
> 赞同：5
> 
> 时间：2012-10-04T16:05:44.657
> 
> 标签：jquery, css, jquery-mobile

我目前正在开发一个使用 jQuery Mobile 的移动网站。切换页面时，我使用幻灯片过渡。因为这些页面相当长，所以需要滚动。

当向下滚动并单击链接时，当页面滚动到顶部然后滑入新页面时，会出现可见的跳转。由于在某些时候需要滚动到顶部时，两个页面并排放置。

我尝试过的一件事是：我可以从顶部偏移新页面，以便它从页面滚动到的级别开始，并在动画完成时将偏移重置回 0，但是页面将​​保持滚动状态下。如果我使用 window.scrollTo 或 jQuery 的 scrollTop() 会出现明显的闪烁，其中固定的标题最为明显。

我还能做些什么来保持旧页面滚动但新页面不滚动？

我已经在第三代 iPod touch、iPhone 4 和 iPhone 4s 上对此进行了测试，令人惊讶的是，迄今为止给我带来最少闪烁的设备是 iPod touch。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-28T06:52:21.890

只需添加此 CSS

```
div[data-role='page'] { bottom: 0; -webkit-overflow-scrolling: touch; } 
```

（从[这里](https://stackoverflow.com/questions/15255719/jquery-mobile-prevent-scroll-to-top-before-page-transition)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-09T15:25:48.357

我正在回答这个问题，因为它是关于这个主题的原始帖子，并且清楚地指出这里的问题是使用 明显闪烁`window.scrollTo()`，或者来自 JQM 库`jQuery's scrollTop()`的有争议的问题（超时 + 滚动）。`$.mobile.silentScroll()`

我最近不得不解决完全相同的问题，这就是我想出的：伟大的 JQM 团队过去在优化和加速低端移动设备的转换方面做得很好。

简而言之，JQM 通过尝试将与函数`pages`内部的某个值配对，以某种方式解决了这个临界点`§.mobile.silentScroll()`。我不得不删除这个函数来构建我自己的：

```
$(document).on("mobileinit", function () {
  // other settings...
  $.mobile.SerialTransition.prototype.scrollPage = $.noop;
  $.mobile.ConcurrentTransition.prototype.scrollPage = $.noop;
}); 
```

因为我有两种页面，第一种需要记住滚动位置（列表页面），第二种（卡片页面）需要始终从顶部开始，我会将这些信息存储在自定义`data-attribute`.

例如，在下面的示例中，这三个页面的设置如下：

```
<div id="page-one" data-role="page" data-transition-scroll="keep-position">
<div id="page-two" data-role="page" data-transition-scroll="top-position">
<div id="page-three" data-role="page" data-transition-scroll="keep-position"> 
```

正如问题中所指出的，我还必须`page`从顶部偏移，这是整个代码：

```
var scrollHandler = {
  setScrollData: function (prevPage, toPage) { 
    if(typeof toPage == "object" && typeof prevPage == "object") {
      $(prevPage).data("scroll-top", $(window).scrollTop());
    }
  },
  resetContent: function (toPage) {
    var scrollMode = $(toPage).data("transition-scroll");
    if(scrollMode === "top-position") {
      var content = $(toPage).find(".ui-content")[0];
      var contentStyle = $(content).attr("style"); /* Force reflow */
        $(content).css({"top": "0px"});
    }
  },
  freezeContent: function (prevPage) {
    var scrollTop = $(prevPage).data("scroll-top"),
        content = $(prevPage).find(".ui-content")[0],
        fixedHeader = $(prevPage).find(".ui-header-fixed")[0],
        headerBottom = $(fixedHeader).outerHeight() - fixedHeader.offsetTop;
    $(content).css({"top": -scrollTop + "px"});
    window.scrollTo(0,0);
  },
  unFreezeContent: function (toPage) {
    var scrollTop = $(toPage).data("scroll-top"),
        scrollMode = $(toPage).data("transition-scroll"),
        content = $(toPage).find(".ui-content")[0],
        contentStyle = $(content).attr("style"); /* Force reflow */
    $(content).removeAttr("style");
    window.scrollTo(0, scrollMode ==="top-position" ? 0 : scrollTop);
  }
}; 
```

这里使用的 JQM`pageevents`如下：

```
$(document).on("pagecontainerbeforehide", function(e, ui) { 
  scrollHandler.freezeContent(ui.prevPage);
});

$(document).on("pagecontainerbeforechange", function(e, ui) { 
  scrollHandler.setScrollData(ui.prevPage, ui.toPage);
});

$(document).on("pagecontainerbeforeshow", function(e, ui) { 
  scrollHandler.resetContent(ui.toPage);
});

$(document).on("pagecontainershow", function(e, ui) { 
  scrollHandler.unFreezeContent(ui.toPage);
}); 
```

最后，还有一点 CSS：

```
/* large desktop screen */
.ui-header,
.ui-content,
.ui-footer {
  max-width: 870px;
  margin: auto;
}
/* needed for the scrollhandler */
.ui-content {
  position: relative; 
  width: 100%;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
} 
```

**附加说明**

对于*外部页面*和非*dom-cached*的页面，将需要自定义页面历史记录，因为：

1.  在我的示例中，滚动值存储在页面本身内，并且
2.  当前标准的 JQM 页面历史实现对于这个目的是不够的

* * *

**这是一个例子：**

`slide`过渡被故意放慢以检查结果：

[![过渡动画](../Images/8e8051a8f927b3494a434e12801db385.png)](https://i.stack.imgur.com/de14T.gif)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-04T21:08:54.927

只是把 return false; 在被调用的 javascript 函数的末尾。

```
 function yourFunctionBeingCalled(){
       /*your code*/
       return false;
     } 
```

你也可以使用 preventDefault(); 或 event.stopPropagation(); 功能

参考： [event.preventDefault() 与 return false](https://stackoverflow.com/questions/1357118/event-preventdefault-vs-return-false)

希望它有所帮助。

# python - Django --CSRF 令牌丢失或不正确

> ID：12731305
> 
> 赞同：9
> 
> 时间：2012-10-04T16:05:55.903
> 
> 标签：python, django

所以我得到了 Forbidden (403) CSRF 验证失败。请求中止。失败原因：CSRF 令牌丢失或不正确。
我的中间件类中有“django.middleware.csrf.CsrfViewMiddleware”。这是我的模板

```
<form name="input" action="/login/" method="Post"> {% csrf_token %}
<input type="submit" value="Submit"></form> 
```

这是我的看法

```
from django.shortcuts import render_to_response
from django.core.context_processors import csrf
from django.template import RequestContext
def login(request):
     csrfContext = RequestContext(request)
     return render_to_response('foo.html', csrfContext) 
```

好吧，我是 Django 和大多数 Web 开发的新手，但我似乎无法在这里找到问题。任何帮助将非常感激！

我也尝试过 django 文档中的方法

```
c = {}
c.update(csrf(request))
# ... view code here
return render_to_response("a_template.html", c) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-26T14:25:58.933

我和你有同样的问题，我发现这段代码可以解决我的问题。

```
from django.views.decorators.csrf import csrf_exempt
from django.shortcuts import render
from django.contrib import auth

#in accounts.forms i've placed my login form with two fields, username and password
from accounts.forms import LoginForm

@csrf_exempt
def login(request):
   if request.method == "POST":
      form = LoginForm(request.POST)
      if form.is_valid():
         user = auth.authenticate(
                username=form.cleaned_data["username"],
                password=form.cleaned_data["password"])
                auth.login(request, user)
                return HttpResponseRedirect("/")
      else:
         form = LoginForm()

return render(request, 'accounts/login.html', {'form':form}) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-04T16:12:54.573

尝试在登录功能之前添加 @csrf_protect 装饰器。

```
from django.views.decorators.csrf import csrf_protect

@csrf_protect
def login(request):
     csrfContext = RequestContext(request)
     return render_to_response('foo.html', csrfContext) 
```

如果表单不在 foo.html 中，那么您需要将 @csrf_protect 方法添加到生成它的视图函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:08:25.613

您应该执行以下操作：

```
def login(request):
     context = {}
     request_context = RequestContext(request)
     return render_to_response('foo.html', context,
                               request_context=request_context) 
```

这是. [_](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#django.shortcuts.render_to_response)`render_to_response`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-27T10:56:50.487

虽然禁用`CSRF`令牌并手动获取`CSRF`令牌值仍然有效。但是，在我的例子中，语法没有像 html 那样正确结构化，我们不担心我们的脚本设计，但我认为使用`jinja`ie 我们的模板语言很重要，是的，这就是我解决问题的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-21T07:37:05.510

转到 urls 并在视图方法/类 ex 旁边添加 .as_view()。

获取AuthTokenView.as_view()

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-12-09T20:47:55.960

只需将其添加到您的 HTML 中：

```
{% csrf_token %} 
```

# c# - IEnumerable 类型的视图模型的 Razor 语法 用于显示器

> ID：12731315
> 
> 赞同：2
> 
> 时间：2012-10-04T16:06:32.893
> 
> 标签：c#, asp.net-mvc, razor

我从 SQL db 中提取日期时间，格式为`hh:mm dd/mm/yyyy`

使用 Razor 语法，我可以显示存储在数据库中的日期

```
@Html.DisplayFor(modelItem => item.Updated) 
```

我希望 Razor 以以下格式显示`dd MMM yyyy`所以我按照另一个 StackOverflow 答案尝试了以下操作：

```
@Html.DisplayFor(modelItem => item.Updated.ToString("dd MMM yyyy")) 
```

[使用剃刀转换日期时间格式](https://stackoverflow.com/questions/4679352/converting-datetime-format-using-razor)

但是，这会产生以下错误：

> “/”应用程序中的服务器错误。
> 
> 模板只能与字段访问、属性访问、一维数组索引或单参数自定义索引器表达式一起使用。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.InvalidOperationException：模板只能用于字段访问、属性访问、单维数组索引或单参数自定义索引器表达式。
> 
> 源错误：
> 
> 第 36 行： 第 37 行： 第 38 行：
> @Html.DisplayFor(modelItem => item.Updated.ToString("dd MMM yyyy")) 第 39 行： 第 40 行：

我刚刚开始掌握 ASP.NET 等...我不确定如何创建视图模型来尝试这个示例，因为我首先使用自动生成的 edmx 文件构建 DB：

```
[DisplayFormat(DataFormatString = "{0:dd MMM yyyy}")] 
pubilc DateTime Updated { get; set } 
```

有什么建议么？

目前这些工作。我要做的就是更改“更新”属性的显示格式。我的视图文件： http: [//pastebin.com/Ywn8Z0TV](http://pastebin.com/Ywn8Z0TV)

我的控制器： http: [//pastebin.com/1jAih6AE](http://pastebin.com/1jAih6AE)

我的模型： http: [//pastebin.com/UC61QjFZ](http://pastebin.com/UC61QjFZ)

更新：对于那些说应该是 item => item.Updated 的人...

```
Error   1   A local variable named 'item' cannot be declared in this scope because it would give a different meaning to 'item', which is already used in a 'parent or current' scope to denote something else 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:14:45.740

试试这个：

```
[DisplayFormat(DataFormatString = "{0:dd MM yyyy}", ApplyFormatInEditMode = true)]
[DataType(DataType.Date)]
public DateTime Updated { get; set; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:16:02.460

具体为什么您的解决方案不起作用与错误状态完全相同。

> 模板只能与字段访问、属性访问、一维数组索引或单参数自定义索引器表达式一起使用。

一种方法也是如此`ToString()`，不适用于模板。

其他人已经给出了另一种解决方案，我想解释一下为什么你的不起作用。

> 我刚刚开始掌握 ASP.NET 等...我不确定如何创建视图模型来尝试这个示例，因为我首先使用自动生成的 edmx 文件构建 DB

您的 edmx 文件应该创建一个看起来也相似的类：

```
public partial class SomeTable
{
  public DateTime Updated { get; set } 
} 
```

在同一个项目中，在同一个 NameSpace（不一定是目录）中创建一个`SomeTable.Partial.cs`看起来也相似的文件：

```
public partial class SomeTable
{
  [DisplayFormat(DataFormatString = "{0:dd MMM yyyy}")] 
  pubilc DateTime Updated { get; set } 
} 
```

默认情况下，实体框架会创建代表您选择的表的[部分类。](http://msdn.microsoft.com/en-us/library/wa80x488%28v=vs.100%29.aspx)这意味着您可以在另一个文件中定义另一个部分类，并且.Net 将在编译时将每个属性的所有属性组合成一个属性。

**更新**

这段代码对我来说看起来很奇怪，我看不出它是如何工作的：

```
@foreach (var item in Model) {
<tr>
    <td>
        @Html.DisplayFor(modelItem => item.Metal.Name)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Currency.Code) 
```

**更新 2**

`DisplayFor`用于显示模型上的属性（并且仅直接显示模型上的属性）。当您枚举一个模型类型`IEnumerable<>`（或模型上的一个属性）时，您不能再使用`DisplayFor`这些值来显示这些值。你应该[`Display`](http://msdn.microsoft.com/en-us/library/ee292038%28v=vs.108%29.aspx)改用。例如，`Metal.Name`不存在于 上`IEnumerable`，它存在于 中的一个元素内`IEnumerable`。

```
@foreach (var item in Model) {
<tr>
    <td>
        @Html.Display(item.Metal.Name)
    </td>
    <td>
        @Html.Display(item.Currency.Code) 
```

**错误更新**

> 错误 1 ​​无法在此范围内声明名为“item”的局部变量，因为它会给“item”赋予不同的含义，后者已在“父级或当前”范围内用于表示其他内容

当存在如下代码时：

```
@foreach (var item in Model) // or Model.Items
{
  <div>
  @Html.DisplayFor(item => item.Updated)
  </div>
} 
```

所有 MVC`EditFor`和`DisplayFor`方法都使用一个`Expression<TDelegate>`所以当代码声明`DisplayFor(item => item.Updated)`第一个`item`基本上是定义一个变量`T item`但是你不能再次定义相同的变量名。为了说明这不是 MVC 特定的，这也不会编译并给出相同的错误（并且对于相同变量名的声明更明显）：

```
var item = 1;
var items = new List<int>() { 1, 2, 3, 4};
var sameItem = items.Select(item => item == item); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:14:08.420

试试下面的。似乎您正在`DisplayFor`使用不正确的语法调用该方法。

```
@Html.DisplayFor(x => x.Updated) 
```

使用 lambda 时，需要匹配符号前后的符号名称`=>`。

您当前使用的`modelItem`和`item`哪些不一样。

# linq - LINQ 查询的差异

> ID：12731317
> 
> 赞同：2
> 
> 时间：2012-10-04T16:06:35.943
> 
> 标签：linq, entity-framework

有人可以解释为什么，当查询应该只返回一个字符串项时，如下例所示；

```
From c in context.Products Where c.Id=prodId Select c.Name 
```

为什么不能这样做呢？

```
Dim prodDeleted as String = (From c in context.Products Where c.Id=prodId Select c.Name).ToString() 
```

因为它返回 this (System.Data.Objects.ObjectQuery`1[System.String]) ，而不是产品名称

而不是必须这样做；

```
 Dim prodDeleted = (From c In ctx.products
                               Where c.Id = prodId
                               Select c).FirstOrDefault()

 Dim deletedprodname As String = prodDeleted.Name.ToString() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:08:46.013

因为对 Select 的所有调用都返回一个 IEnumerable 而不是单个元素。

要验证您的查询是否确实返回单个元素，您需要添加对 Single 的调用。或者，如果您不关心返回的是单个元素还是多个元素，您可以使用 First 获取第一个元素。

如果您不反对使用 VB.NET 等效的 lambda 语法，则可以简化所有内容：

```
Dim deletedProdName As String = 
    ctx.products.SingleOrDefault(Function(c) c.Id = prodId).Name 
```

# asp.net - Web.Config - 由于权限不足，无法读取配置文件

> ID：12731320
> 
> 赞同：11
> 
> 时间：2012-10-04T16:06:45.397
> 
> 标签：asp.net, windows, iis, acl

我收到错误消息：

```
Module  IIS Web Core
Notification    Unknown
Handler Not yet determined
Error Code  0x80070005
Config Error    Cannot read configuration file due to insufficient permissions
Config File \\?\C:\inetpub\wwwroot\web.config 
```

该文件本身对 IUSR 具有完全权限。IIS 在 ApplicationPoolIdentity 下运行其应用程序池。我对文件做了一个文件监视器，我看到了这个：

```
9:04:43.8035456 AM  w3wp.exe    8104    CreateFile  C:\inetpub\wwwroot\Web.config   ACCESS DENIED   Desired Access: Generic Read, Disposition: Open, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: N, ShareMode: Read, AllocationSize: n/a 
```

不知道为什么我会收到这个错误......有什么想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-05T01:14:45.187

尝试将这些帐户的读/写访问权限授予您的 Web 应用程序的根文件夹以及其中的所有文件/子目录：

NETWORK、NETWORK SERVICE，当然还有 IIS_IUSRS

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-13T10:41:42.790

我发现将具有完全权限的 mymachine/USERS 添加到 C:\inetpub\wwwroot 解决了这个问题。

问题是因为我与其他开发人员共享了 C:\inetpub\wwwroot 中的一些站点内容。这一定是更改了权限并完全破坏了我的 IIS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:12:59.817

首先，确保 IUSR 对配置文件具有读取权限（我相信您已经这样做了）

然后，将 IIS 身份验证方法更改为 BasicAuthentication

如果仍然无法正常工作，则可能是 .config 扩展名未正确安装在 IIS 中。

尝试所有 3！祝你好运！

编辑：忘了问你，它是什么样的应用程序？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-29T02:14:50.163

我刚刚遇到这个问题，无法找到 applicationpoolidentity 作为帐户，以便将其添加到文件夹安全性中。我将应用程序池标识从 applicationpoolidentity 更改为 Local Service，站点运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-12T23:40:32.020

发生此 IIS 错误时，我正在将实时 WordPress 站点复制到本地计算机以进行编辑/更新。更改权限没有任何作用。

就我而言，只需删除 web.config 就可以了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-02T01:39:13.473

我今天又遇到了这个问题。这一次，任何授予权限都不起作用（尝试了所有常用帐户，每个人，只读，修改，完全控制）。

关闭进程，重新启动 IIS，完全重新启动。没结果。

最终将所有者从“管理员”更改为我自己，事情就到位了。

我通常在管理员级别（使用我自己的帐户）运行 Visual Studio，因为我喜欢使用本地 IIS 来托管/调试 ASP.NET 站点。也许这会导致新文件归 \Administrators 所有，而后者又可能限制 IIS 或应用程序池进程对这些文件的访问。

My DefaultAppPool identity *is* set to load the user profile. I don't know at what point the session manager applies UAC / permissions drops and whether user profile loading has any influence on this. Food for thought...

# javascript - 在 Ember.js 中，如何将对象挂钩到通用应用程序命名空间

> ID：12731321
> 
> 赞同：2
> 
> 时间：2012-10-04T16:06:51.237
> 
> 标签：javascript, web-applications, ember.js

假设我声明了一个应用程序命名空间：

```
App = Ember.Application.create(); 
```

后来我编写了一个 arrayController 实例，它创建对象并将其挂钩到用户事件的应用程序命名空间：

```
App.objController = Ember.ArrayController.create({
    content: [],

    createObj: function(){
        // instantiate new object
        var newObj = Ember.Object.create({ ... })
        //give obj a name
        var newObjName = this._getObjName( someParam );
        // hook object to an app namespace -> this is where I have an issue
        App[newObjName] = newObj
   },

   ...

}); 
```

请参阅我明确使用 App[newObjName] = newObj 将对象挂钩到命名空间，理想情况下，我希望以某种通用方式命名应用程序命名空间，以防我稍后将 objController 用于不同的应用程序。

必须有某种方法可以做到这一点，尽管我对 Ember 还不够熟悉，无法遇到它。

注意：从 1 到 JFGI，这个问题绝对不是 1。另一方面，对于任何有时间的人来说，它都是一个免费的已解决复选标记。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:44:44.963

考虑使用`injections`，这是添加依赖项的首选方式。

```
Ember.Application.registerInjection({
  name: 'fooObject',
  before: 'controllers',

  injection: function(app, router, property) {
    if (property === 'FooObject') {
      app.set('fooObject', app[property].create());
    }
  }
}); 
```

所以如果你定义一个类如下：

```
App.FooObject = Ember.Object.extend({ 
  // ...
}); 
```

注入将创建一个实例到`App.fooObject`. 虽然我们仍然使用命名空间`App`，但是只有一次。你可以进一步做：

```
Ember.FooObject = Ember.Object.extend({ 
  // ...
}); 
```

然后在你的应用程序中，`App.FooObject = Ember.FooObject`但我不确定它是否有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T08:27:34.123

在初始化阶段，Ember 将实例化所有的控制器，并为每个控制器注入三个属性——“target”、“controllers”、“namespace”。“命名空间”属性是您的应用程序。

也就是说，而不是硬编码顶级对象：

```
App[newObjName] = newObj 
```

您可以执行以下操作：

```
this.get("namespace").set(newObjName, newObj); 
```

注意 - 为了使其工作，您的应用程序需要一个[router](http://emberjs.com/api/classes/Ember.Router.html)。此外，您应该定义控制器类，而不是实例。Ember 将为您实例化所有控制器。所以这

```
App.objController = Ember.ArrayController.create({/* code here */}); 
```

应该写成

```
App.ObjController = Ember.ArrayController.extend({/* code here */}); 
```

Note the capital "O" in "ObjController".

# security - 通过 WS-Trust 场景自定义 STS 和过期密码

> ID：12731328
> 
> 赞同：0
> 
> 时间：2012-10-04T16:07:28.707
> 
> 标签：security, wcf-security, wcf-client, wif

对于通过 WS-Trust 处理具有活动客户端的场景的过期密码，是否有任何指南或最佳实践？

目前我有几个想法，但找不到任何相关信息：
1\. 发出特殊令牌，以便客​​户端可以确定，即应该显示更改密码通知。
2\. 抛出特定异常。

也许我在 WS-Trust 标准中遗漏了一些东西？

我使用的是 WIF 内置实现，所以它是标准的 1.3 版本，部分是 1.4。提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T11:17:44.970

WS-Trust 1.3 和 1.4 使用[SOAP Fault 机制](http://www.tutorialspoint.com/soap/soap_fault.htm)。标准中指定了一些故障代码。

[WS-Trust 错误处理](http://docs.oasis-open.org/ws-sx/ws-trust/v1.4/errata01/os/ws-trust-1.4-errata01-os-complete.html#_Toc325658986)

您可以使用 wst:FailedAuthentication SOAP 错误代码并提供二级详细信息字段来解释密码过期的情况，但您应该注意不要在这样做时引入安全漏洞（例如，通过提供过于详细的信息）。

# ios - 撤销 iOS 分发证书

> ID：12731331
> 
> 赞同：2
> 
> 时间：2012-10-04T16:07:32.620
> 
> 标签：ios, xcode, certificate, distribution

[我检查了类似的帖子，我的问题与其他问题略有不同，因为我们有多个应用程序在一个证书下签名]

我们受委托为客户开发现有的 iOS 应用程序，现在需要使用他们的证书将其分发到应用程序商店。问题是证书不是我们生成的，所以我们没有私钥（.p12 文件）。假设我们不能得到这个，我相信唯一的选择是撤销现有的分发证书并创建一个新的......所以我的问题是：

Q1) 客户在应用商店中有 3 个现有的应用程序都在这个现有的分发证书下签名。如果我们撤销现有证书并创建一个新证书，会破坏现有应用程序吗？

Q2）大概你的应用在应用商店中的“公司”名称取自分发证书？即如果我使用我们的证书签署应用程序，我们的公司名称会出现在应用程序上方而不是客户上方吗？

谢谢！！

尼尔

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:39:55.173

我也有同样的困境。

Q1）这样做是可以的，它不会破坏现有的应用程序。只需在您完成后立即创建一个新的。

Q2) 名称不受影响，您在提交应用程序时在iTunes Connect中自行设置。

# c# - 与整个对象本身相比，通过对象的场是否更“昂贵”？

> ID：12731334
> 
> 赞同：1
> 
> 时间：2012-10-04T16:07:40.217
> 
> 标签：c#, methods, parameter-passing, pass-by-reference

考虑以下类：

```
public class Person
{
    public String FirstName;
    public String LastName;
    public DateTime DateOfBirth;
    public StaffType PersonType;
} 
```

以及以下2个方法和方法调用：

```
public void DoSomethingWithPersonType(Person person)
{
    TestMethod(person.PersonType);
} 
```

（由 调用`DoSomethingWithPersonType(person);`）

```
public void DoSomethingWithPersonType(StaffType personType)
{
    TestMethod(personType)
} 
```

（由 调用`DoSomethingPersonType(person.PersonType);`）。

哪种方法更有效？他们都像彼此一样“高效”吗？它没有什么区别，因为它只是传递了一个引用吗？或者传递的参考是否在某些方面有所不同？

我问的原因是因为我在当前项目中选择了第一个方法签名 - 我已经这样做了，因为以后我们可能需要使用我们的“人”的其他字段 - 所以更容易扩展/适应性强的方法是我所拥有的——但它是一种更昂贵的方法吗？

编辑：注意 - 不用说，这些差异将是微不足道的，否则我已经遇到了性能影响明显足以让我采取行动的情况。这只是一个好奇的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-04T16:10:58.390

在性能方面，它们将是相同的。在这两种情况下，您都传递了一个引用（具有相同的性能成本），并且在这两种情况下，您都将`PersonType`对象从其中一个字段中取出。

这里唯一的区别在于代码的可读性/可维护性等方面。一般来说，方法最好只接受它们需要的信息。如果你只需要 a`PersonType`那么只接受 a `PersonType`。它允许更灵活地使用该方法。（如果 a 以外的东西`Person`有 a`PersonType`怎么办？）如果您认为您实际上需要的不仅仅是 person 类型，而不是接受 a`Person`可能是合适的。

另请注意，即使此处存在差异，也肯定会很小。您不应该从运行成本的角度考虑每一个小想法。这些天计算机速度很快。即使是糟糕的算法也往往需要很少的时间在实践中运行（从一个人的角度来看）。如果你的程序运行时间超过了它需要的时间，那么是时候开始寻找改进的地方了。您应该关注那些占处理器时间很大比例的代码区域（使用分析器识别）。网络通信（包括数据库调用）和其他 IO 往往是优化的好目标。

另请注意，拥有公共字段通常被认为是不好的做法。至少，您可能应该拥有公共属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:12:00.297

无论您决定传递给方法的性能影响如何，都取决于上下文。如果您在同一类中的方法之间传递参数，性能影响将非常小，如果您通过 RMI 调用方法，则另当别论

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T16:20:35.467

这在一定程度上取决于 的类型`StaffType`，但通常性能差异可以忽略不计。

如果`StaffType`是一个类，那么没有任何区别，因为两者都是引用。如果是，`enum`那么传递一个`StaffType`值比传递一个引用要快一些。

（如果`StaffType`是一个大的`struct`，那么它会更慢通过，但实际的问题是一个糟糕的设计`struct`，而不是你如何使用它。）

所以，你应该使用最有意义的那个。通常您应该发送尽可能少的信息，以便更容易看到该方法实际使用的内容。是否应该发送`StaffType`值或整个`Person`对象以供将来可能的扩展很难说，但请考虑[YAGNI](http://en.wikipedia.org/wiki/You_ain%27t_gonna_need_it)原则 - 你不需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T16:14:28.107

据推测，StaffType 是一个枚举。在这种情况下，它应该比传递对象引用更有效，枚举将为垃圾收集创建更少的工作。

但是任何差异都可以忽略不计，在这种情况下，我认为可扩展性更为重要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T16:20:50.617

说到效率，它们是相等的，因为在这两种情况下你都会传递一个引用（说到两个类，否则如果`StaffType`是一个结构，那么第二个会更慢）。但就*最佳编码实践*而言，这取决于你想做什么。如果您不需要`Person`该类中的任何其他属性，则应使用第二个，因为您应该传递尽可能少的信息，但是如果您必须在 person 对象上做更多工作，则应该使用第一个解决方案。

但是您必须考虑方法和框架的可*重用性*，假设您不仅需要将此方法用于*Person 类型*，而且还需要将其用于另一种“类型”，您必须重写另一种方法它和*面向对象编程*的目标，即代码更少，将消失。

# javascript - 内存中的 Javascript 压缩。Post 后用 Python 解压。还必须处理非ascii

> ID：12731336
> 
> 赞同：1
> 
> 时间：2012-10-04T16:07:48.860
> 
> 标签：javascript, python, compression

我需要能够在 Javascript 中压缩字符串，但不保存临时文件。然后我将通过 POST 发送这些压缩数据。我将在 Python 中收到它，所以我需要能够在那里解压缩它。我实现了以下[http://rosettacode.org/wiki/LZW_compression](http://rosettacode.org/wiki/LZW_compression)，却发现它只适用于 ascii 字符。我要阅读网页，但永远不知道我会得到什么字符。

（我需要这样做的原因是因为字符串可能会变得很长，因此慢速网络需要很长时间才能发布。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:21:28.647

您可以事先尝试对字符串进行 base64 编码（这将产生一个从 1.5 到两倍大小的压缩流，如果可以直接压缩它的话）。

[这里](https://github.com/dankogai/js-deflate)还有另一个实现（gzip Deflate 算法的这个）。

或者您可以尝试通过将非 ASCII 字符替换为 \xNN（NN = 十六进制字符代码）来转义它们。当然，您还必须避开斜线。

无论如何，您不太可能将速度提高 10 倍以上，而且我担心这会被编码开销所平衡。在不了解用例的情况下，我建议使用 Deflate。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:20:59.733

在 javascript中使用[deflate，](https://stackoverflow.com/questions/2233062/javascript-deflate-implementation)[在 python 中使用 zlib](http://docs.python.org/library/zlib.html)。（LZW 是古老而过时的——现代方法要好得多。）在使用 base 85 编码之间，选择 85 个 ASCII 字符而不是实验或标准文档表明可以使其通过 POST 毫发无损。Base 85 就是每个字符都是 base 85 数字中的一个数字，其中五个这样的数字编码 32 位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:21:57.673

来自 OP 评论。

> javascript 读取 DOM 元素并发送它。由于各种原因，无法指向源代码，其中一个主要原因是我需要页面上由 javascript 创建的元素。我还需要浏览器为我计算的计算样式。

一种解决方案是使用[Selenium](http://seleniumhq.org/)和 Python 自动化浏览器，然后从中检索 DOM。

# jquery - Select2 jQuery 动画调整大小（使用 jsFiddle！）；我们可以以某种方式延迟默认事件或使其正确调整大小吗？

> ID：12731338
> 
> 赞同：0
> 
> 时间：2012-10-04T16:07:57.440
> 
> 标签：jquery, jquery-animate, jquery-select2

我正在尝试更改 select2 元素的大小，但它似乎无法正常工作（下拉菜单的大小未正确调整）。我考虑并尝试过的一种方法是在 .open 上使用 preventDefault() ，但是如何在动画完成后甚至触发默认值？我还尝试隐藏然后显示 select2 下拉菜单，但似乎也无法使其正常工作。我有一个 jsFiddle，以及这里的代码，请帮助:)

jsFiddle： http: [//jsfiddle.net/acpFh/2/](http://jsfiddle.net/acpFh/2/) （如您所见，单击 select2 字段会调整顶部的大小，但不会调整下拉菜单）

代码：

```
$(function(){
    var $searchBox = $('#search_box');

    $searchBox.select2({
            width: '168px',
            minimumInputLength: 2,
            openOnEnter: false,
            closeOnSelect: true,
            placeHolder: 'Search',
            query: function (query) {
                var data = {results: []}, i, j, s;
                for (i = 1; i < 5; i++) {
                    s = "";
                    for (j = 0; j < i; j++) {s = s + query.term;}
                    data.results.push({id: query.term + i, text: s});
                }
                query.callback(data);
            }
    }).on('open',function(){ // <---- this stuff!!! ########################
        var $s2SearchBox = $('#s2id_search_box');
        $s2SearchBox.animate({
                left: -133,
                width: 300
            },
            function(){ // complete
                $s2SearchBox.width(300);

            });

    });

});​ 
```

干杯，并提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:42:35.580

解决了！（感谢开发者“ivaynberg”本人）。

[https://github.com/ivaynberg/select2/issues/469](https://github.com/ivaynberg/select2/issues/469)

[http://jsfiddle.net/acpFh/6/](http://jsfiddle.net/acpFh/6/)

```
$(function(){
    var $searchBox = $('#search_box');

    $searchBox.select2({
            width: '168px',
            minimumInputLength: 2,
            openOnEnter: false,
            closeOnSelect: true,
            placeHolder: 'Search',
            query: function (query) {
                var data = {results: []}, i, j, s;
                for (i = 1; i < 5; i++) {
                    s = "";
                    for (j = 0; j < i; j++) {s = s + query.term;}
                    data.results.push({id: query.term + i, text: s});
                }
                query.callback(data);
            }
    }).on('open',function(){ // <---- this stuff!!! ########################
        var $s2SearchBox = $('#s2id_search_box');
        $s2SearchBox.animate({
                left: -133,
                width: 300
            },
            {step: function() {
                $searchBox.select2("positionDropdown");
              },
            complete: function() {
                $searchBox.select2("positionDropdown");
            }
             });

    });

});​ 
```

# css - 我的下拉菜单在 jsFiddle 中运行良好，但在 Firefox 和 Safari 中测试时却不行

> ID：12731341
> 
> 赞同：3
> 
> 时间：2012-10-04T16:08:21.123
> 
> 标签：css, drop-down-menu

我已经浏览了以前的堆栈帖子，并尝试了我能找到的所有方法，但唉，没有任何效果。

我的下拉菜单在 jsfiddle 中运行良好：http:
[//jsfiddle.net/4JFQ8/5/](http://jsfiddle.net/4JFQ8/5/)

但是，当我使用 firefox 或 safari 预览代码时，“服务”链接下的下拉菜单不会直接在“服务”链接按钮下方对齐，并且当我尝试向下移动鼠标时，下拉菜单会消失。

顺便说一句，感谢所有回答这些问题的人。这个网站过去帮助了我很多，但不幸的是这是我第一次发帖。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:31:08.973

Please try this:

```
ul.dropdown ul {
left: 0;
list-style: none outside none;
padding: 0;
position: absolute;
top: 100%;
visibility: hidden;
width: 200px;
} 
```

Include `padding:0 & list-style:none`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:57:47.910

消除

```
position:absolute; 
```

像这样的导航风格可能会有所帮助

```
nav{
  margin-top:10px;
  top:0;
  right:0;
  clear:both;
  font-family:"Copperplate Gothic Light";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:07:57.007

在@Shivaji 的帮助下，
这适用于 Firefox 和 Safari。
我变了：

> > ul.dropdown ul {
> > 宽度：200px; 可见性：隐藏；位置：绝对；最高：100%；左：0；}

至：

> ul.dropdown ul { 左：0；列表样式：无外无；填充：0；位置：绝对；顶部：5px；可见性：隐藏；宽度：200px；}

“top:5px”使得点击下拉菜单成为可能。
“list-style: none outside none; padding: 0;”修复了对齐问题。
请注意，这尚未在 Chrome 或 IE 中进行测试！多谢你们！

# javascript - Stellar JS / 在特定高度触发功能

> ID：12731345
> 
> 赞同：1
> 
> 时间：2012-10-04T16:08:37.507
> 
> 标签：javascript, jquery

我正在使用 stellar JS (http://markdalgleish.com/projects/stellar.js/) 为 Ipad 组合一个视差滚动站点，我想在某个高度触发一个函数（从屏幕右侧） - 有没有人有过监控屏幕高度位置和触发功能的经验 - 无论是使用 stellar.js 还是一般情况下。

干杯保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T19:37:22.250

滚动到某个高度后触发一个函数是非常可行的——这里有一些简单的代码来做到这一点：

```
function scrollHeightTrigger (height, fn) {
  var old_height = $(document).scrollTop();
  $(document).scroll(function () {
    var new_height = $(document).scrollTop();
    if (((height < new_height) && (height >= old_height)) ||
        ((height < old_height) && (height >= new_height))) {
      fn();
    }
    old_height = new_height;
  });
} 
```

scrollHeightTrigger 接受一个高度和一个函数 - 高度指定应该在距顶部的滚动距离处触发该函数。这是通过记住文档顶部之前的高度来完成的，然后在用户每次滚动时检查他们是否已经通过了目标。如果有，则触发该函数。

照原样，这将在每次传递滚动位置时重复该功能 - 如果您想要一次执行，那么修改它应该不会太难。

# scala - Scala多个隐式转换？

> ID：12731352
> 
> 赞同：8
> 
> 时间：2012-10-04T16:08:58.470
> 
> 标签：scala, implicit-conversion

我不明白我在以下代码（Scala 2.9）中看到的明显矛盾的行为：

```
class Pimp1(val x : Double) {
  def pluss(that : Pimp1) = x + that.x
  def <(that : Pimp1) = x < that.x
}

object Pimp1 {
implicit def d2pimp(d : Double) = new Pimp1(d)
implicit def d2pimp(od : Option[Double]) = new Pimp1(od.get)
} 

object Scratch2 extends App {
    import Pimp1._

    5.0.pluss(Some(5.0))
    5.0 < Some(5.0)
} 
```

'5.0.pluss(Some(5.0))' 行编译，但它后面的行没有编译并出现以下错误消息：

> 重载方法值 < 有替代方案： (x: Double)Boolean (x: Float)Boolean (x: Long)Boolean (x: Int)Boolean (x: Char)Boolean (x: Short)Boolean (x: Byte)Boolean 不能应用于 (Some[Double])

如果我将显式 < 运算符添加到采用 Option[Double] 的 Pimp 类中：

```
def <(that : Option[Double]) = x < that.get 
```

一切都编译得很好。

现在，按照我理解 Scala 隐式转换规则的方式，这很有意义：

1.  编译器知道 Double 上没有接受 Option[Double] 的 '<' 运算符
2.  它考虑到 Pimp1 的隐式转换。
3.  如果 Pimp1 有合适的运算符，它就会工作，否则会产生错误。
4.  重要的是，这表明编译器**不**考虑应用第二个（可用的）隐式转换，从 Option[Double] 到 Pimp。

这就是我期望的工作方式。

但是，这似乎与第一个示例相矛盾，其中：

1.  编译器发现 Double 上没有 pluss 方法。
2.  编译器尝试隐式转换为 Pimp，它确实有这样的方法。
3.  但是，为了使运算符工作，编译器必须对参数应用第二次隐式转换，以将其转换为 Pimp。

根据上面的逻辑，这不应该编译，但确实可以。隐式转换规则是否对不存在的方法和不匹配的方法有不同的处理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:27:58.523

这对我来说很有意义。第一个，它的工作原理是这样的：

Double 有加号方法吗？不，我们可以将其隐式转换为可以执行的操作吗？是的。好的，现在我想应用 pluss 方法。它需要一个选项吗？不可以。我可以隐含地将 Option 转换为它确实需要的东西吗？是的。

第二个是这样的：

Double 有 < 方法吗？是的。它需要一个选项吗？不，我可以将 Option 隐式转换为 < 确实需要的东西吗？不。

# ruby-on-rails - ROR 代码没有部署在 linode 上，出现奇怪的错误

> ID：12731357
> 
> 赞同：0
> 
> 时间：2012-10-04T16:09:20.787
> 
> 标签：ruby-on-rails, apache, linode

我已经成功安装并配置了带有乘客的 apache，以部署 Rails 应用程序。我成功安装了“mysql”和“rails”gem，但是当我运行任何 rake 命令时

```
rake db:create 
```

创建数据库，我得到这个错误

```
Illegal instruction 
```

知道为什么吗？

# asp.net-mvc - MVC 3 anNynmous 和 Windows 身份验证相结合

> ID：12731359
> 
> 赞同：1
> 
> 时间：2012-10-04T16:09:25.487
> 
> 标签：asp.net-mvc, windows-authentication, anonymous, integrated

我有一个通过 Windows 身份验证保护的 Web 应用程序。但是，我有一个控制器需要在全球范围内可供任何人使用，因此他们不需要服务器上的 Windows 帐户来获得访问权限。

我通过在 IIS 中启用 Windows 身份验证和匿名身份验证来实现这一点。我的控制器现在看起来像这样：

```
[Authorize]
public class MyController : Controller
{
    public Index()
    {
    }

    public DoStuff()
    {
    }

    etc...
} 
```

我的匿名控制器是相同的，只是我从一开始就删除了 [Authorise] 属性。

我是否正确地说这指示 Web 应用程序只允许那些拥有 Windows 帐户的用户使用大多数控制器，但我想允许匿名访问的控制器除外？

它似乎工作得很好，但我想确保这样做不会留下一个巨大的安全漏洞？

启用这两种身份验证方法并以这种方式设置应用程序是否有任何问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:09:05.803

首先，按照您的操作方式，您的应用程序的安全性没有漏洞，它将按照您预期的方式运行。但是有更好的方法...

Authorize 属性的问题是很容易忘记您添加到应用程序的新控制器，如果您不添加它，您的控制器对公众开放。

如果您使用的是 MVC 4，则可以将 Authorize 属性添加为全局过滤器，然后在匿名控制器上使用 AllowAnonymous 属性，因为 Authorize 属性默认尊重 AllowAnonymous 属性。另一方面，MVC 3 不附带 AllowAnonymous 属性。吨

解决方法是在您的项目中自己创建 AllowAnonymous 属性，如下所示：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
public sealed class AllowAnonymousAttribute : Attribute { } 
```

现在，您可以从内置的 Authorize 属性进行子类化以自定义该属性并查找应用于您的控制器的 Anonymous 属性。如果找到该属性，则可以跳过授权。这是一个示例实现：

```
public sealed class AuthorizeWithAnonymousSupportAttribute : AuthorizeAttribute
    {
        public override void OnAuthorization(AuthorizationContext filterContext)
        {
            bool skipAuthorization = filterContext.ActionDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true)
            || filterContext.ActionDescriptor.ControllerDescriptor.IsDefined(typeof(AllowAnonymousAttribute), true);
            if (!skipAuthorization)
            {
                base.OnAuthorization(filterContext);
            }
        }
    } 
```

您必须将此属性添加到站点的全局过滤器中。在您的 Global.asax 中：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters) {
    filters.Add(new AuthorizeWithAnonymousSupportAttribute ());
    filters.Add(new HandleErrorAttribute());
} 
```

现在，最后一步。您可以简单地将 AllowAnonymous 属性添加到您想要匿名的任何控制器：

```
[AllowAnonymous]
public class MyController : Controller
{
    public Index()
    {
    }

    public DoStuff()
    {
    }

    etc...
} 
```

执行上述所有操作的好处是您不必担心将 Authorize 属性添加到您添加到应用程序的控制器中。相反，您必须明确告诉应用程序哪些控制器对公众开放。

谢谢，希望这会有所帮助。

# iphone - Objective-C 中的图像/颜色比较

> ID：12731362
> 
> 赞同：0
> 
> 时间：2012-10-04T16:09:38.447
> 
> 标签：iphone, objective-c, image, colors, comparison

我试图找到一种方法来比较两个图像。让我给你一个例子，这样你就可以更好地理解：我的应用程序会随机化一种颜色（她会随机化一个从 0 到 255 的 R 值，然后是 G 和 B，结果是完全随机的 RGB 颜色）。现在用户将从 iPhone 的相机中拍照，应用程序将颜色与图像进行比较。示例：应用程序选择 RGB = 205,133,63，它是棕色的：用户将拍摄一张桌子棕色细节的照片。现在我需要比较 iPhone 选择的棕色和图片的棕色并显示一个结果（例如：“图片与给定颜色相比忠实于 88%”）。我在互联网上找到了这个例子，但我可以弄清楚如何在我的应用程序中实现它：[http ://www.youtube.com/watch?v=hWRPn7IsChI](http://www.youtube.com/watch?v=hWRPn7IsChI)

谢谢！！

马可

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:36:58.257

有很多方法可以做到这一点。如果您想保持简单，您可以平均整个图像的颜色。为简单起见，假设您的图像只有两个像素： RGB0 = 255, 0, 0（红色） RGB1 = 0, 0, 0（黑色）

两者之间的平均值将为 RGB_AVG = 128, 0, 0（深红色）

现在您可以计算此平均值与所选颜色 205、133、63 之间的差异。您也可以通过多种不同的方式进行计算。这是一个：

```
R = 205 - 128 = 80 
G = 133 - 0 = 133
B = 63 - 0 = 63
Total = 80 + 133 + 63 = 276

Total score = (756 - 276) / 756 = 63.5% 
```

这只是一种方法，您可以在字典中收集所有颜色并在需要时对其进行计数以使其超级准确。这完全取决于您想要达到的目标。

顺便说一句：如果您的数字高于您的样本颜色，请确保您的数字最终不会更高。使用 ABS 或任何你想要的方法。以上只是一个例子。

# pug - 使用 JadeJS 将 HTML 保留为文本

> ID：12731365
> 
> 赞同：0
> 
> 时间：2012-10-04T16:09:51.390
> 
> 标签：pug

我在`jade`文件 中有这个

```
h2 HTML Before:
code#before <div id="message"><p>New content will go here</p></div> 
```

我想将`<div>`标签呈现为文本以显示在这样的网页上：

```
HTML Before:
<div id="message"><p>New content will go here</p></div>  //as text! 
```

关于如何防止文本变成 HTML 的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:03:33.810

```
code#before #{'<div id="message"><p>New content will go here</p></div>'} 
```

来自[https://github.com/visionmedia/jade#tag-text](https://github.com/visionmedia/jade#tag-text)

# javascript - 从 JSON 属性加载 HTML img 元素的图像，而 URL 不能直接访问

> ID：12731372
> 
> 赞同：1
> 
> 时间：2012-10-04T16:10:18.873
> 
> 标签：javascript, html, objective-c, json, wikitude

好的，这个解释起来相当复杂，它解释了详细的标题：在我的 Objective C 应用程序中，我生成一个 JSON 字符串来保存我需要在 wikitude SDK 的 ARchitect 浏览器中绘制的对象的所有属性（到目前为止据我所知，Wikitude SDK 仅通过以下方式处理 JSON）：

```
NSString *javaScript = [self convertPoiModelToJson:self.poiData.pois];
NSString *javaScriptToCall = [NSString stringWithFormat:@"newData('%@')", javaScript]; 
```

我感兴趣的一个特定对象作为字符串存储在该 JSON 字符串中，它是图像的 URL。但是，此图像位于我们的网络服务器上的密码保护区域后面，应用程序会处理身份验证。

当我在 ARchitect 浏览器中时，问题就开始了，它基本上是一个 .html 文件，其中调用了特定的 wikitude javascript 函数来构建增强现实世界并将其显示在应用程序的 UIWebView 中。我想在作为基本 html div 容器的页脚弹出窗口中单击增强视图中的 POI 时显示该图像。所以现在我有一个指向网络服务器上图像资源的 URL，我无法直接访问它

```
document.getElementById("thumb").src = jsonObject.thumbUrl; 
```

由于需要身份验证，并且我成功加载该图像的唯一方法是通过该`var poiImage = new AR.ImageResource(jsonObject[i].iconURL, {onError: errorLoadingImage});`方法，但随后我只能在增强视图中显示它，而不能在页脚中显示它。

我尝试从网络中的其他图像或本地资源向视图的页脚部分中的 img 元素提供静态字符串，没有出现类似问题：`document.getElementById("thumb").src="marker.png";`它工作正常，图像也正确加载到增强视图中.

我已经阅读了关于在 base64 中编码图像（我可以在应用程序的目标 c 部分中访问和下载）并将该字符串存储在一个额外的 JSON 属性中以将其加载到 html img 元素的 src 属性中，`<img src="data:image/png;base64,BASE&$_ENCODED_DATA"></img>`但是这个对于我试图完成的工作来说，这似乎是一个非常肮脏且过于不切实际的解决方法/hack。另外，我不知道开始阅读有关如何实现身份验证以访问网络服务器受保护区域中的图像的更好主意，或者开始实现丑陋的 base64 编码或继续搜索替代方案是否是一个更好的主意。

我不是要寻求解决方案，而是要建议我还剩下哪些可能性来访问该图像。由于我没有想法，因此感谢您提供任何帮助。

谢谢！

简短的摘要：

*   在目标 c 部分可访问和下载的图像
*   可以使用 wikiitude SDK 的 AR.ImageResource 方法访问图像（但不需要）
*   无法通过 javascript 的 url 直接访问图像，因为需要身份验证

（我希望我的问题是可以理解的，如果有什么不清楚的地方，请随时提问，特别是因为英语不是我的第一语言，用德语解释会更复杂..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:23:12.317

好的，让我们考虑一下，因为它看起来很混乱。

如果我很好地理解了您的问题，那么一切都是关于您的 javascript 代码需要到达图像所在的 url，而无法这样做，因为该位置需要某种验证才能访问。

在这种情况下，我会寻找将图像移动到受限站点之外的地方。也许试图将它们从 Objective-C 部分保存到一个可以通过 javascript 访问的*公共*场所。这可能会很棘手，因为 I/O 操作可能会减慢您的代码执行速度......当然，您总是可以选择将这些图像移动到*限制*区域之外，但我认为这是不可行的，因为您可以通过你自己。

其他方式...如果您的环境配置允许（我担心问题上没有足够的信息）是尝试执行您的javascript部分（我想知道它是否包含在从网络服务器执行的网页中）有权进入*限制*区域的用户。当然，这可能完全是一个禁忌，具体取决于您的 javascript 部分的功能以及您的*受限*区域为何受到验证的保护。

如果您不想移出文件，暂时复制它们会导致性能问题和错误，并且通过 javascript 执行用户模拟用户不是一种选择我担心您的独特选择是有效地尝试传递二进制数据流图像通过 JSON 字符串...脏...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:35:35.650

看起来 wikiitude 维护 2 个浏览器上下文：加载 HTML 的主机浏览器和由 UIWebView 实例表示的嵌入式浏览器类对象（或 iframe 或代理服务器）。

只有其中一个（从您的讨论中不清楚）具有访问您的图像的用户/通行证。您将需要调用某些东西来重复身份验证步骤或将凭据传输到其他上下文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-08T07:40:39.737

您是否尝试过在 Objective-C / Cocoa 中下载图像，将其本地存储在您的 iOS 设备上，并通过 JSON 将图像的本地路径传递到您的 Architect World 中？

`AR.ImageResouce`然后，您可以使用您和您的 div 容器加载本地图像。

# tcp - 通过路由器的 TCP 握手

> ID：12731376
> 
> 赞同：1
> 
> 时间：2012-10-04T16:10:42.013
> 
> 标签：tcp, block, router, handshaking

我正在使用 HTTP 通过 TCP/IP 将嵌入式设备连接到远程服务器。我有两层路由器，如果两层都到位，则连接到远程服务器时遇到问题。我最上面的路由器是 10.0.0.X，我的下面（本地）路由器是 192.168.1.X。

如果我绕过 192.168.1.X 路由器，并将我的设备和笔记本电脑放在连接到 10.0.0.X 路由器的集线器上，我的设备将正确完成与服务器的握手序列。我看到我的 SYN 出去了，服务器用 SYN/ACK 响应，我用 ACK 响应。HTTP 从那里接管。

如果我将我的设备和笔记本电脑插入 192.168.1.X 路由器，并将此路由器插入 10.0.0.X 路由器，那么我仍然看到我的 SYN 请求发出，但我没有收到服务器的响应。

在我看来，我的 192.168.1.X 路由器阻止了我的离开请求或返回的响应。我检查了 (192) 路由器设置，并且防火墙已关闭（完全打开）。

我的笔记本电脑上有 Wireshark，并考虑过嗅探 192 路由器的另一端，但我不知道我是否能处理流量，因为我希望 10.0.0.X 路由器不会将它们传回去到其他港口，即使他们在那里。

我的问题：

*   有什么想法可以调试它以查看故障发生在哪里？如果笔记本电脑连接到路由器上的另一个端口，Wireshark 会接收这些数据包吗？

*   为什么一台路由器会双向传递数据包，而另一台则以一种或另一种方式阻止它们？看来如果我能回答这个哲学问题，我也许就能推断出真正的问题。

谢谢，

克里斯

# php - 在 url (htaccess) 中隐藏参数（查询字符串），但将此参数发送到页面 (php)

> ID：12731378
> 
> 赞同：3
> 
> 时间：2012-10-04T16:10:52.247
> 
> 标签：php, .htaccess, mod-rewrite, redirect, hide

如何在 url 中隐藏参数（query_string），但将它们发送到隐藏的页面，在地址栏中不可见
示例：
我有这个：

```
http://localhost/index.php?sent=true 
```

我想要：

```
http://localhost/index.php 
```

但我想在 PHP $_GET['sent'] 中获取发送参数

我试图重定向到没有参数的页面（没有 query_string）[R]，然后在没有 [R] 重定向的情况下（无声地）给页面一些参数（不改变地址本身）

我尝试在 htaccess 中使用不同标志和不同方式的 RewriteRule，但没有任何效果

我了解到，如果我想在浏览器中更改地址，我必须在一个 RewriteRule 行中使用 R 标志和 L 标志 - 其他方式不起作用 - 地址不会改变

但是当我使用 [L] 标志时，我无法转到下一行（下一个 RewriteRule）并在没有 [R] 重定向的情况下将任何 query_string 附加到地址

如果我没有在第一行放置 [L] 标志（带有 [R]），我没有新地址，但如果我这样做 - 我不能使用 [C] 标志甚至 [N] 标志

* * *

原因如下：

在我的页面上，我在从表单成功发送数据后使用 header('Location: ...?sent=true') 函数我重定向到 ?sent=true 因为我不想用户刷新页面并再次发送相同的数据

但是在重定向到 ?sent=true 之后，我不想在地址栏中使用该 query_string，该页面上还有更多表单将发送其他 POST 数据并用这个丑陋的 query_string 刷新页面

怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:12:06.017

你可以设置它，这样如果你访问一个脚本，`?sent=true`一旦它完成，它会重定向用户

例如

```
if(!empty($_GET['sent'])&&$_GET['sent']) {
    //do stuff
    header("Location: http://localhost/index.php");
} 
```

您不能使用 htaccess 执行此操作，因为您需要传递给 PHP，它会在重定向后传递给 PHP，因此如果您使用 htaccess 重定向，则该值将永远不会到达 PHP。

* * *

进一步的问题，这样做的唯一方法是使用 javascript 表单重定向用户

```
<?php if(!empty($_GET['sent'])&&$_GET['sent']) { ?>
<form action='http://localhost/index.php' method='post' name='frm'>
    <?php
    foreach ($_GET as $a => $b) {
        echo "<input type='hidden' name='".$a."' value='".$b."'>";
    }
    ?>
    </form>
    <script language="JavaScript">
        document.frm.submit();
    </script>
<?php } ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:29:25.840

您可以在 apache 中分配变量：

```
SetEnvIf Request_URI "\sent=true$" SENT=1 
```

然后在 PHP 中检索它，如：

```
if (isset($_SERVER['SENT'])) {
   echo "Received sent variable from apache, value is " . $_SERVER['SENT'];
} else {
   echo "not received sent variable from apache";
} 
```

**更新**：
您需要在您的**httpd.conf**文件或**.htaccess**`AllowOverride FileInfo`文件中设置或设置，如下例所示：`AllowOverride ALL`

 ****```
<Directory /home>
 AllowOverride FileInfo
</Directory> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:19:11.500

Cookie 可能是一个解决方案，因为您可以使用它们将数据从页面传递到页面并且不可见，至少对于普通用户来说不容易。

或者，如果可能的话，$_SESSION 也是将数据从一页发送到另一页的好解决方案。****

# sql-server-2005 - 以编程方式在数据流任务中编辑 SQL (SSIS 2005)

> ID：12731380
> 
> 赞同：1
> 
> 时间：2012-10-04T16:10:53.657
> 
> 标签：sql-server-2005, ssis

我需要使用来自 AS/400 源的一个变量（在 WHERE 子句中）执行 SELECT 查询。我有一个 OLE DB 驱动程序，但它似乎不支持使用 ? [错误是来自 HRESULT 的异常：0x80040E10 (Microsoft.SqlServer.SQLTaskConnectionsWrap)]

显然，这应该可以通过以编程方式编辑我的 SQL（我从脚本任务中猜测）来实现，但我不确定在对象模型中的哪个位置可以找到与我的数据流任务相关的 SQL。

如果人们完全有其他建议，我也对此持开放态度，我只需要执行一个参数化查询，其中值替换客户端上的参数，然后再发送查询。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:57:16.947

您最好的选择是创建一个变量来保存您的 sql 语句。

然后将变量设置为表达式，以便从您第一次尝试使用的变量中插入 where 子句。

您的表达将类似于：

```
="select col1, col2 from table_name where col3 = " + @[User::WhereClause] 
```

然后，您可以将数据访问模式设置为来自 OLEDB 源中的变量的 SQL 命令，并将 OLEDB 源中的变量名称设置为您创建的变量。

这样，您为设置 where 子句变量而设置的所有逻辑仍将按您的预期工作。

# trigger.io - 启动图像不起作用

> ID：12731382
> 
> 赞同：0
> 
> 时间：2012-10-04T16:10:58.423
> 
> 标签：trigger.io

我刚刚订阅了 Go 迭代计划以在我的应用程序中使用 Launch 图像，并且在我的应用程序加载时我仍然看到 Trigger.io 徽标图像。这是怎么回事？哦，是的，我确实更改了我的应用程序配置并指定了启动图像

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:29:27.003

我可以从您的构建中看到，您的 App Config 在您的启动图像文件的路径中有反斜杠 - 我想您会发现，如果您用正斜杠替换那些反斜杠，您应该没问题。

我将调查我们的工具包是否未能在此处提供正确的行为 - 感谢您的提醒！

# android - 自定义 Facebook 登录并将令牌保存到 Android 上的共享首选项

> ID：12731383
> 
> 赞同：0
> 
> 时间：2012-10-04T16:10:59.973
> 
> 标签：android, facebook

我正在尝试开发可以发布到 Facebook 的应用程序。

所以 SDK 设置好了，我可以像 hackbook 示例一样使用 FB 按钮登录。我真的不喜欢它的样子。我正在开发一个应用程序，然后在它上面浮动 webview 弹出窗口？

也许我弄错了，但我很想在我的设置活动中以某种方式获取 Facebook 登录名/密码，然后将令牌保存到共享首选项。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:26:27.560

Saving the access tokens in SharedPrefs can be done by using the following code when you are setting up a valid session.

```
Utility.fb.authorize(MainActivity.this,Utility.fbPermissions , new DialogListener() {

                @Override
                public void onFacebookError(FacebookError e) {
                    // TODO Auto-generated method stub
                    Toast.makeText(context, "Facebook Error", Toast.LENGTH_LONG).show();

                }

                @Override
                public void onError(DialogError e) {
                    // TODO Auto-generated method stub
                    Toast.makeText(context, "Dialog Error", Toast.LENGTH_LONG).show();

                }

                @Override
                public void onComplete(Bundle values) {
                    // TODO Auto-generated method stub
                    Toast.makeText(context, "User Logged In", Toast.LENGTH_LONG).show();
                    Utility.editor = Utility.prefs.edit();
                    Utility.editor.putString("access_token", Utility.fb.getAccessToken());
                    Utility.editor.putLong("access_expires", Utility.fb.getAccessExpires());
                    Utility.editor.commit();
                    Intent intent = new Intent(context, UpdateStatus.class);
                    startActivity(intent);

                }

                @Override
                public void onCancel() {
                    // TODO Auto-generated method stub
                    Toast.makeText(context, "Cancelled by user", Toast.LENGTH_LONG).show();

                }
            }); 
```

And later you can just check for the validity of the access token and log in the user directly, without asking for his username or password.

```
Utility.prefs = getSharedPreferences(Utility.PREF_UTILITY_FILE_NAME, MODE_PRIVATE);
        Utility.access_token = Utility.prefs.getString("access_token", null);
        Utility.expires = Utility.prefs.getLong("access_expires", 0);

        if(Utility.access_token != null)
        {
            Utility.fb.setAccessToken(Utility.access_token);
        }

        if(Utility.expires !=0)
        {
            Utility.fb.setAccessExpires(Utility.expires);
        }

        if(Utility.fb.isSessionValid())
        {
            //user is already logged in

            } 
```

**EDIT :** Ever since Facebook API removed the offline access permission, you can increase the validity of the access tokens by putting the following code in the activity where you are doing the authentication to authorize the user login.

```
public void onResume() {    
        super.onResume();
        Utility.fb.extendAccessTokenIfNeeded(this, null);
    } 
```

# javascript - Javascripts 不再在本地主机上工作，生产服务器是的

> ID：12731385
> 
> 赞同：0
> 
> 时间：2012-10-04T16:11:17.770
> 
> 标签：javascript, popup, localhost

我有 2 个不同的 javascript 事件，它们不再适用于 windows7/iis7 localhost，但适用于生产服务器。

一个是显示/隐藏 div 标签，另一个是弹出窗口。

我查看了最近的 Windows 更新，并没有看到任何影响 javascript 的内容......但也许这个问题也发生在其他人身上？！？

再次 - 显示和隐藏 div 事件以及弹出窗口脚本都在生产服务器上工作。所有浏览器的 javascript 都无法在 Localhost 上运行。

```
<html>
<head>

<script type="text/javascript" src="/shells/javascript/allscripts.cfm"></script>

<!-- The allscripts.cfm file has the following copy....
function showhide(divid, state)
{
document.getElementById(divid).style.display=state
}
-->
</head>

<div id="MarketingDescription-AAA" style="display:block">
    Copy 1<a style="cursor: pointer;" onClick="showhide('MarketingDescription-AAA', 'none'); showhide('MarketingDescription-BBB', 'block'); return true;"><u>[+Expand]</u></a>
</div>

<div id="MarketingDescription-BBB" style="display:none">
    Copy 2<a href="#MarketingDescriptionAnchor" style="cursor: pointer;" onClick="showhide('MarketingDescription-BBB', 'none'); showhide('MarketingDescription-AAA', 'block'); return true;"><u>[--Collapse]</u></a>
</div> 
```

# c# - 如何对此进行单元测试？有很多数据库调用的大 foreach

> ID：12731386
> 
> 赞同：2
> 
> 时间：2012-10-04T16:11:23.583
> 
> 标签：c#, .net, unit-testing, nunit, moq

我必须制作一个程序，该程序基本上从文件中读取 x 行，然后尝试在数据库中找到它，然后获取文件中的一些信息并更新数据库中行的信息。

如果所有其他方法都失败，则将其作为新行插入 db。

所以基本上很多插入和更新。

我尝试进行单元测试，因为我正在更新很多我想确保每条信息都正确的字段（即不是用名字或类似名称设置的电子邮件地址）。

但是我不知道该怎么做，因为我认为这是程序方法

```
// get records from file

foreach record in file
{
   db record = find if it is in db

   if(record != null)
   {
        if(do another logic check)
         {
             // update record
         }
         else if(do another logic check)
         { 
            // update record
         }
        else
        {
           // do some more logic 

            if(do another check)
             {
               // update record
             }
        }
   }
   else
   {
      // do some more logic checks and do inserts.
   }
} 
```

我在 void 方法中看到了这一点，可能带有一些私有方法（例如更新记录部分）。现在我应该如何对此进行单元测试？我想对第一个 if（做另一个逻辑检查）进行单元测试，如果说我发送的某些记录满足这些条件。

但是，由于这些是私有方法，我无法对它们进行单元测试，所以现在我看不到该方法返回任何内容，因为它将经过数百条记录，并且我可能会将大部分内容打印到错误日志文件中或者其他的东西。

我向您展示的代码位于服务层中。我会用 moq 模拟 db 方法调用。

该应用程序是一个控制台应用程序。

有什么建议可以让我更好地分解它，以便我可以检查逻辑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:23:12.287

您可以模拟数据库调用，也可以模拟记录类型并通过模拟内部方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:19:38.083

> 我向您展示的代码位于服务层中。我会用 moq 模拟 db 方法调用。

那是关键。您应该在可以在单元测试中模拟的接口后面抽象所有数据库依赖项。您将定义对方法的期望。就读取文件而言，您应该抽象该方法，以便它不采用文件名而是采用 `Stream`or`StreamReader`代替，这将允许您在单元测试中提供示例文件数据，而不是依赖于实际的存在文件。

所以你的班级现在可以变成：

```
public class SomeClass
{
    private readonly IRepository _repo;
    public SomeClass(IRepository repo)
    {
        _repo = repo;
    }

    public void SomeMethod(StreamReader reader)
    {
        string line;
        while ((line = reader.ReadLine()) != null)
        {
            // put your logic and use the _repo to update your database.
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:07:32.630

从高层次来看，您的课程可能最终看起来像这样：

```
// get records from file

foreach record in file
{
   dbRecord = _db.Find(record)

   if(dbRecord != null)
   {
        if(logicCheck(dbRecord))
        {
            _db.Update(dbRecord)
        }
        else if(logicCheck2(dbRecord))
        { 
            _db.Update3(dbRecord)
        }
        else
        {
            // do some more logic 
        }
        if(otherCheck(dbRecord))
        {
            _db.Update2(dbRecord)
        }
   }
   else
   {
      // do some more logic checks
      _db.Insert(record)
   }
} 
```

测试看起来像这样：

```
public void TestInsert()
{
    _mock.Setup(r => r.Find(record).Returns(null))

    class = new class(_mock.Object);
    class.methodToTest(fileRecord);

    _mock.Verify( r => r.Insert(record));
}

public void TestUpdate()
{
    var dbRecordThatPassesLogicCheck = new dbRecord(// initialize for test)
    _mock.Setup(db => db.Find(record).Returns(dbRecordThatPassesLogicCheck))

    class = new class(_mock.Object);
    class.methodToTest(fileRecord);

    _mock.Verify( r => r.Update(dbRecordThatPassesLogicCheck));
}

public void TestUpdate3()
{
    var dbRecordThatPassesLogicCheck2 = new dbRecord(// initialize for test)
    _mock.Setup(db => db.Find(record).Returns(dbRecordThatPassesLogicCheck2))

    class = new class(_mock.Object);
    class.methodToTest(fileRecord);

    _mock.Verify( db => db.Update3(dbRecordThatPassesLogicCheck2));
} 
```

Moq（或任何其他模拟框架）在这里为您购买的是模拟类在 logicCheck 为真时调用 Update 或在 logicCheck2 通过但 logicCheck1 未通过时调用 Update3 的能力。您不会模拟您的私有方法，而是使用来自 find 方法（您正在模拟的存储库）的预设输入来练习它们。

您的类可能应该对初始记录获取的检索采用第二个接口依赖项，这将使代码更加解耦（现在，如果文件系统读取更改为 Web 服务读取，则该类不会直接受到影响）并允许您获得更多的可测试性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T18:46:26.660

我们倾向于使用大量注入依赖的小类。这提供了可用性和可测试性接缝。我们还倾向于将 if .. else if .. else 块提取到可注入的 Strategy 对象中——这使得它们的逻辑可以在使用它们的进程之外进行测试。

这将读取文件的关注点分开

```
class RecordFileReader
{
    void UpdateAll(file)
    {
        foreach (var record in file)
        {
            _fileRecordImporter.Import(record)
        }
    }
} 
```

从处理单个文件记录

```
class FileRecordImporter
{   
    void Import(record)
    {
        db_record = find if it is in db
        if (db_record != null)
        {
            _dbRecordUpdater.Update(db_record, record)
            return;
        }
        _dbRecordCreator.CreateFrom(record);
    }
} 
```

并确定如何将信息从记录传输到数据库以进行更新

```
class DbRecordUpdater
{
    void Update(db_record, record)
    {
        var recordUpdater = _recordUpdaters.FirstOrDefault(x=>x.IsMatch(db_record, record));
        if (recordUpdater != null)
        {
            recordUpdater.Update(db_record, record)
        }
    }
} 
```

并插入

```
class DbRecordCreator
{
    void CreateFrom(record)
    {
        var recordCreator = _recordCreators.FirstOrDefault(x=>x.IsMatch(record));
        if (recordCreator != null)
        {
            var db_record = recordCreator.Create(record)
            ...
        }
    }
} 
```

# c - C中的动态字符串连接

> ID：12731389
> 
> 赞同：1
> 
> 时间：2012-10-04T16:11:40.233
> 
> 标签：c, concatenation

我知道这是一个非常常见的问题，但我想知道您对以下功能的看法。这个想法是这个函数可以连接字符串而不用担心结果大小：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define TAM 15 

char* concat(char* answer, char* src, unsigned int* limit, unsigned int* total)
{
 unsigned int length = strlen(src);

 if((*limit - *total) > length)
  strcat(answer, src); 
 else
 {
  *limit *= 2;
  answer = realloc(answer, sizeof(char)*(*limit));
  printf("RESIZING...\n");
  if(answer == NULL)
  {  
   printf("RESIZING ERROR...\n"); 
   return NULL;
  }

  strcat(answer, src); 
 }

 *total += length;

 return answer;
}

int main(void)
{
 char* strings[] = { "ONE", "TWO", "THREE", "FOUR", "FIVE" };

 unsigned int LIMIT = TAM;   //<------
 unsigned int total = 0;     //<------

 char* mem_block = calloc(LIMIT, sizeof(char));

 unsigned int i;
 for(i = 0; i<5; ++i)
  mem_block = concat(mem_block, strings[i], &LIMIT, &total);  //<------

 printf("RES : %s -- %d\n", mem_block, strlen(mem_block));

 free(mem_block);

 return 0;  
} 
```

这个例子运行良好，valgrind 报告一切正常：

```
elias@elias-VirtualBox ~/Desktop $ valgrind ./reSize2
==2939== Memcheck, a memory error detector
==2939== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==2939== Using Valgrind-3.6.1-Debian and LibVEX; rerun with -h for copyright info
==2939== Command: ./reSize2
==2939== 
RESIZING...
RES : ONETWOTHREEFOURFIVE -- 19
==2939== 
==2939== HEAP SUMMARY:
==2939==     in use at exit: 0 bytes in 0 blocks
==2939==   total heap usage: 2 allocs, 2 frees, 45 bytes allocated
==2939== 
==2939== All heap blocks were freed -- no leaks are possible
==2939== 
==2939== For counts of detected and suppressed errors, rerun with: -v
==2939== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 11 from 6) 
```

但有几件事我不喜欢。我不喜欢将这个变量 //<---- 传递给函数。有更好的方法吗？而且，如果我没有收到返回指针“mem_block”，valgrind 会输出以下内容：

```
==2923== Memcheck, a memory error detector
==2923== Copyright (C) 2002-2010, and GNU GPL'd, by Julian Seward et al.
==2923== Using Valgrind-3.6.1-Debian and LibVEX; rerun with -h for copyright info
==2923== Command: ./reSize2
==2923== 
RESIZING...
==2923== Invalid read of size 1
==2923==    at 0x4028D51: strcat (mc_replace_strmem.c:176)
==2923==    by 0x8048523: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca028 is 0 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x4028D59: strcat (mc_replace_strmem.c:176)
==2923==    by 0x8048523: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca029 is 1 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid write of size 1
==2923==    at 0x4028D6F: strcat (mc_replace_strmem.c:176)
==2923==    by 0x8048523: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca033 is 11 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid write of size 1
==2923==    at 0x4028D7C: strcat (mc_replace_strmem.c:176)
==2923==    by 0x8048523: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca035 is 13 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid write of size 1
==2923==    at 0x4028D81: strcat (mc_replace_strmem.c:176)
==2923==    by 0x8048523: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca037 is 0 bytes after a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x804864A: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca028 is 0 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x408A75C: vfprintf (vfprintf.c:1629)
==2923==    by 0x4092C9E: printf (printf.c:35)
==2923==    by 0x405F112: (below main) (libc-start.c:226)
==2923==  Address 0x41ca028 is 0 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x40B374B: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1317)
==2923==    by 0x4092C9E: printf (printf.c:35)
==2923==    by 0x405F112: (below main) (libc-start.c:226)
==2923==  Address 0x41ca036 is 14 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x40B375F: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1317)
==2923==    by 0x408A734: vfprintf (vfprintf.c:1629)
==2923==    by 0x4092C9E: printf (printf.c:35)
==2923==    by 0x405F112: (below main) (libc-start.c:226)
==2923==  Address 0x41ca035 is 13 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x40B36E8: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1349)
==2923==    by 0x408A734: vfprintf (vfprintf.c:1629)
==2923==    by 0x4092C9E: printf (printf.c:35)
==2923==    by 0x405F112: (below main) (libc-start.c:226)
==2923==  Address 0x41ca028 is 0 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== Invalid read of size 1
==2923==    at 0x40B36F4: _IO_file_xsputn@@GLIBC_2.1 (fileops.c:1348)
==2923==    by 0x408A734: vfprintf (vfprintf.c:1629)
==2923==    by 0x4092C9E: printf (printf.c:35)
==2923==    by 0x405F112: (below main) (libc-start.c:226)
==2923==  Address 0x41ca02a is 2 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
RES : ONETWOTHREEFIVE -- 15
==2923== Invalid free() / delete / delete[]
==2923==    at 0x4027C02: free (vg_replace_malloc.c:366)
==2923==    by 0x8048677: main (in /home/elias/Desktop/reSize2)
==2923==  Address 0x41ca028 is 0 bytes inside a block of size 15 free'd
==2923==    at 0x402896C: realloc (vg_replace_malloc.c:525)
==2923==    by 0x8048546: concat (in /home/elias/Desktop/reSize2)
==2923==    by 0x8048624: main (in /home/elias/Desktop/reSize2)
==2923== 
==2923== 
==2923== HEAP SUMMARY:
==2923==     in use at exit: 30 bytes in 1 blocks
==2923==   total heap usage: 2 allocs, 2 frees, 45 bytes allocated
==2923== 
==2923== LEAK SUMMARY:
==2923==    definitely lost: 30 bytes in 1 blocks
==2923==    indirectly lost: 0 bytes in 0 blocks
==2923==      possibly lost: 0 bytes in 0 blocks
==2923==    still reachable: 0 bytes in 0 blocks
==2923==         suppressed: 0 bytes in 0 blocks
==2923== Rerun with --leak-check=full to see details of leaked memory
==2923== 
==2923== For counts of detected and suppressed errors, rerun with: -v
==2923== ERROR SUMMARY: 80 errors from 12 contexts (suppressed: 11 from 6) 
```

我对此有点困惑，因为我认为这没有必要，因为该函数直接修改了指针。

欢迎对如何改进此功能提出任何意见。

非常感谢，很抱歉这么长的帖子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:28:23.233

当您在函数中修改答案时，您*仅*在函数范围内修改它，调用函数仍将看到旧值（由于您调用了 realloc，因此该值无效）。

当您返回新指针并开始在调用函数中使用它时，一切正常，应该如此。

解决这个问题的最简单方法是让你的 concat 函数看起来像：

```
void concat(char** answer, char* src, unsigned int* limit, unsigned int* total) {
if((*limit - *total) > length)
  strcat(*answer, src); 
 else
 {
  *limit *= 2;
  *answer = realloc(*answer, sizeof(char)*(*limit));
  printf("RESIZING...\n");
  if(*answer == NULL)
  {  
   printf("RESIZING ERROR...\n"); 
   return NULL;
  }

  strcat(*answer, src); 
 }

 *total += length;
} 
```

并称之为：

```
concat(&mem_block, strings[i], &LIMIT, &total); 
```

但是，您应该将字符串抽象为它们自己的类型，而不是手动将它们的长度一起传递。就像是：

```
typedef struct _dynamic_string {
    char *s;
    unsigned int capacity;
    unsigned int length;
} dynamic_string; 
```

应该是一个很好的起点，然后你可以开始使用这个结构来实现动态函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:23:14.803

您不应该检查`limit * 2`表达式是否低于当前限制 +`length`吗？如果是这样，您将需要增加限制。否则我认为你可以强制缓冲区溢出。

我认为您必须将您提到的变量作为指针传递，因为在某些情况下它们会被编辑。在语义上相同但在语法上“更容易”的一种可能替代方法可能是定义 a `struct string`：

```
struct string {
    char* buffer;
    int limit;
    int total;
}; 
```

这可以用来抽象出代表字符串的所有信息。

至于`mem_block`问题，您必须收到它，因为根据[realloc 文档](http://www.cplusplus.com/reference/clibrary/cstdlib/realloc/)：

```
The function may move the memory block to a new location, in which case the new location is returned. 
```

因此，作为参数传递的字符串地址实际上可能与返回的地址不同。您可以通过将指向指针的指针作为参数传递来修复它，因此当它更改时，您可以就地更新它：

```
void concat(char** answer, char* src, unsigned int* limit, unsigned int* total) {
    /* When using strcat: */
    strcat(*answer, src);

    /* When reallocating */
    *answer = realloc(*answer, *limit);
            /* Also, sizeof(char) is always 1, by definition */

    /* ... */
} 
```

希望这会有所帮助=)

# bash - 在 UNIX 中打印/获取文本文件中一行的第一个字符

> ID：12731391
> 
> 赞同：1
> 
> 时间：2012-10-04T16:11:54.093
> 
> 标签：bash, unix

想知道如何在 unix 中打印/获取文本文件中的第一个字符。

即说“9 textfile.txt”将返回 9

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-04T16:13:53.760

您可以使用`head`获取文件的第一个字符：

```
head -c 1 file.txt 
```

* * *

如果你想要每行的第一个字符：

```
grep -o ^. file.txt 
```

或者

```
cut -c 1 file.txt 
```

# find - 使焦点集中到范围下拉列表的键盘快捷键

> ID：12731394
> 
> 赞同：2
> 
> 时间：2012-10-04T16:11:57.680
> 
> 标签：find, keyboard-shortcuts, visual-studio-2012

在 Visual Studio 2012 中，查找对话框已更改。当新的“快速查找”对话框出现时，焦点在文本框上以输入要查找的文本。在大多数情况下，在输入要查找的文本后我想要更改的是范围。在 Visual Studio 2010 中，范围下拉列表在按下 Tab 后立即成为焦点。现在，我必须按 tab 多次或 shift-tab 3 次才能将焦点设置在 scop 下拉列表上，因为搜索文本框和范围之间的选项是“匹配整个单词”、“匹配大小写”和“常规”表达'。

是否有任何键盘快捷键可以加快此过程？我看到“匹配整个单词”、“匹配大小写”和“正则表达式”的快捷方式，但范围内没有。

另外，您知道为什么在 Visual Studio 2012 中，当我们按下回车键时，我们必须将注意力集中在搜索文本框上才能执行搜索？Visual Studio 2010 中的查找按钮被定义为“接受按钮”，但现在，我们必须按 F3 或在查找按钮上单击鼠标才能执行搜索。

拥有它可能被认为不太好，但考虑到我每天在我的解决方案中搜索数十次，这些缺失的功能对我来说是一个非常大的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:55:36.747

我终于找到了解决方案。

在文本编辑器中按“F3”以显示“快速查找”对话框后，焦点在文本框上以输入要查找的字符串。按一次 Tab 键将焦点设置在“查找下一个”按钮上。之后，按向下箭头，焦点将立即位于下拉列表上以更改范围。之后，如果您按向上箭头或向下箭头，您将在下拉列表中更改范围。

# forms - 在 node 和 express 中处理表单的好方法

> ID：12731399
> 
> 赞同：0
> 
> 时间：2012-10-04T16:12:00.937
> 
> 标签：forms, node.js, express

作为 node js 和 express 的新手，我想知道完成工作的最佳方法。使用表单时是否有任何特定的约定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:57:25.423

我使用 express-validator 来验证输入字段。

这是一个例子：

```
app.post('/login', routes.login.post);

//routes/login.js

exports.login.post = function(req, res){
  req.assert('username', 'Enter username').notEmpty();
  req.assert('password', 'Enter password').notEmpty();
  res.locals.err = req.validationErrors(true);

  if ( res.locals.err ) {
    if ( req.xhr ) {
      res.send(401, { err: res.locals.err });
    } else {
      res.render('login');
    }

    return;
  }

  //authenticate and set user in session here
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T19:22:18.263

我强烈建议您通过任何类型的 XSS 攻击或其他注入过滤器传递您的所有表单数据。例如，您可以使用[节点验证器](https://github.com/chriso/node-validator)

使用起来相当简单。要过滤 XSS 注入，只需编写：

```
req.sanitize('textarea').xss(); 
```

等等。更多文档可以在这里找到：[node-validator](https://github.com/chriso/node-validator)

# c# - 如何在不写入磁盘的情况下将 XML 从 Delphi 传递到 C#？

> ID：12731405
> 
> 赞同：1
> 
> 时间：2012-10-04T16:12:13.733
> 
> 标签：c#, delphi, ipc

我有一个 Delphi 应用程序，它产生一个数据块，我目前正在将其作为 xml 写入文件系统。然后，此数据由 C# .Net 应用程序读入以进行进一步处理。

问题是对象图很大，生成的 xml 文件大小为 2 GB+。xml文件的写入和读取都需要较长的时间。

除了写入文件系统，我怎样才能将数据传输到 RAM 中更快的地方？

我有两个应用程序的源代码和编译器。我正在为一个应用程序使用 .Net 4.0 版和 VS2010。另一个我正在使用 Delphi 5（我可以访问更高版本，但我不确定迁移是否会有所帮助）。

更新：感谢所有建议，需要处理很多。我会在进一步审查后回复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T21:07:46.330

还有一些建议：

[内存映射文件](http://msdn.microsoft.com/en-us/library/dd997372.aspx)

[命名管道](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365590%28v=vs.85%29.aspx)

[插座](http://en.wikipedia.org/wiki/Network_socket)

[RPC](http://en.wikipedia.org/wiki/Remote_procedure_call)

[活动X](http://en.wikipedia.org/wiki/ActiveX)

我个人的建议是套接字，在 Delphi 端使用[Indy ，在 .NET 端使用](http://www.indyproject.org/sockets/index.en.aspx)[System.Net.Sockets](http://msdn.microsoft.com/en-us/library/system.net.sockets.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T17:05:12.717

您可以将两者集成到一个进程中。这将为您带来速度优势，因为您不需要任何进程间通信。

三种方法可以做到这一点：

*   在 C# 进程中将 Delphi 代码加载为 DLL（使用 PInvoke）
*   [使用反向 PInvoke](http://www.blong.com/Conferences/BorConUK2002/Interop1/Win32AndDotNetInterop.htm)将 C# 代码作为托管程序集加载到 Delphi 进程中
*   使用RemObjects 的[Hydra执行上述操作之一，并为您处理细节](http://www.remobjects.com/hydra/)

如果您使用 Delphi XE2 或更高版本执行此操作，您可以将所有内容都放在一个 64 位进程中，并且更容易分配 2GB 以上的内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T21:36:48.203

您可以通过在将 XML 流写入磁盘时对其进行压缩（gzip 等）然后在另一端解压缩来显着加快这一速度。如果您的尺寸减少了 10 倍，因此 I/O 减少了 10 倍，请不要感到惊讶。当然，您正在用 I/O 来换取 CPU 工作，但对于 CPU 来说这相对容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T21:32:24.893

您可以将其作为 SOAP 消息发送。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-21T17:47:29.180

最好的方法，我现在使用它以 30fps 将图像从 c# 传输到 delphi 是：

1- 在创建 ac# COM LIBRARY（暴露 GUI 元素）中
2- 使用 regasm -register -tlb dllname.dll 注册 ac# COM LIBRARY
3- 加载在 delphi 中创建的类型库并使用 c# 函数发送您检索任何数据

# jquery - Internet Explorer 上的 jquery 和 fancybox 问题

> ID：12731411
> 
> 赞同：1
> 
> 时间：2012-10-04T16:12:42.540
> 
> 标签：jquery, html, internet-explorer, browser, fancybox

我正在使用 jquery 在我的投资组合页面上使用 fancybox。在 Internet Explorer 中，fancybox 在页面下方打开，没有覆盖效果或导航控件。在其他浏览器中似乎没有问题。请帮忙！

[http://www.iandale.net/clients/private/brydesign/index2.html](http://www.iandale.net/clients/private/brydesign/index2.html)

点击投资组合查看问题。

这些示例可以正常工作：http: [//fancyapps.com/fancybox/#examples](http://fancyapps.com/fancybox/#examples)

谢谢，布莱恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:22:33.247

您的 IE 问题是因为 fancybox 需要在*标准*模式下运行，并且当前您的站点处于*[怪癖](https://developer.mozilla.org/en-US/docs/Quirks_Mode_and_Standards_Mode)*模式。

尝试使用不同的`DOCTYPE`......阅读[这篇文章](http://www.alistapart.com/articles/doctype/)了解更多信息或简单地设置这个

```
<!DOCTYPE html> 
```

# jquery - 更改日期框日期并在包含数据角色日期框的表单中显示新的日期框日期

> ID：12731418
> 
> 赞同：0
> 
> 时间：2012-10-04T16:13:06.430
> 
> 标签：jquery, html, jquery-mobile, datebox

我正在尝试让一个按钮更改我的日期框表单的文本或值。如果我调用 $("element").val("value-date") 值将会改变，但包含日期框的表单不会将其文本更改为值日期。我已经刷新了日期框，但没有奏效。这是我的代码

HTML：

```
<div class='container center' style='margin-top:15%; margin-bottom:15%; width:90%; margin-right:auto; margin-left:auto;'>
        <input placeholder="Enter Date" id='comp_date' type='date' data-role='datebox' name='date' data-options='{"mode": "callbox","useTodayButton":true}'/>
        <a data-role="button" id='pick_today' href="#"  data-theme='e' class="reg_button" style="padding:15px; color:black; margin-bottom:50px;">Now</a>
</div> 
```

Javascript：

```
 $("#pick_today").live("vclick",function()
     {
          var today = new Date();
          var month = today.getMonth();
          var day = today.getDate();
          var year = today.getFullYear();
          var todayText = year + "-" + month + "-" day;
          $("#comp_date").val(todayText);
          $("#comp_date").datebox("refresh");
     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:41:17.770

在这个问题上花了很长时间，终于解决了你的问题。

# 您的代码问题是：

1.  `"+"`此行缺少符号

    `var todayText = year + "-" + month + "-" + day;`

2.  在输入标签上，模式`calbox`不是`callbox`

    `data-options='{"mode": "calbox"`

3.  月份计算应该是`+1`。自一月开始`Zero (0)`

    `var month = today.getMonth()+1;`

## 查询：

```
$("#pick_today").live("click", function() {
    var today = new Date();
    var month = today.getMonth()+1;
    var day = today.getDate();
    var year = today.getFullYear();
    var todayText = year + "-" + month + "-" + day;
    $("#comp_date").val(todayText);
}); 
```

## HTML：

```
<div class='container center' style='margin-top:15%; margin-bottom:15%; width:90%; margin-right:auto; margin-left:auto;'>
    <input placeholder="Enter Date" id='comp_date' type='date' data-role='datebox' name='date' data-options='{"mode": "calbox","useTodayButton":true}'/>
    <a data-role="button" id='pick_today' href="#"  data-theme='e' class="reg_button" style="padding:15px; color:black; margin-bottom:50px;">Now</a>
</div>​ 
```

## 使用的 CSS 和 JS：

```
http://jquerymobile.com/demos/1.0rc3/jquery.mobile-1.0rc3.min.css
http://jquerymobile.com/demos/1.0rc3/jquery.mobile-1.0rc3.min.js
http://dev.jtsage.com/cdn/datebox/latest/jquery.mobile.datebox.min.css
http://dev.jtsage.com/cdn/datebox/latest/jquery.mobile.datebox.min.js 
```

参考我的**[LIVE DEMO](http://jsfiddle.net/SivaCharan/3x5PZ/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:27:58.383

您缺少 id 选择器和绑定 'click' 函数的 'vclick' inseatd 并且该函数未正确关闭

**演示：http:** [//jsfiddle.net/Simplybj/n9HLU/4/](http://jsfiddle.net/Simplybj/n9HLU/4/)

正确的代码在这里：

```
$("#pick_today").live("click", function() {
    var today = new Date();
    var month = today.getMonth();
    var day = today.getDate();
    var year = today.getFullYear();
    var todayText = year + "-" + month + "-" + day;
    $("#comp_date").val(todayText);
}); 
```

# java - 'blanc' 是否有特殊含义，或者 org.apache.commons.configuration.PropertiesConfigurationLayout 的作者是否有打字障碍？

> ID：12731422
> 
> 赞同：0
> 
> 时间：2012-10-04T16:13:23.547
> 
> 标签：java, apache-commons, properties-file

Apache commons 配置有一个名为的类，该类`PropertiesConfigurationLayout`具有类似`getBlancLinesBefore()`. 我认为这是故意的，因为它非常一致。注释说“返回此属性键之前的空白行数。”

据我所知，“blanc”不是英文单词（在法语中仅表示“white”）。是否有一些我不知道的“blanc”的专业技术含义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:15:13.807

我强烈怀疑这只是“空白”的拼写错误。没什么特别的，只是拼写错误。原作者很可能不是以英语为母语的人。

我希望“空白”行被定义为*空*行，或者仅由空格组成的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:28:39.157

可能作者说法语，所以 blanc 表示白色？

# operators - 我可以在 Tcl 中创建运算符吗？

> ID：12731424
> 
> 赞同：3
> 
> 时间：2012-10-04T16:13:32.310
> 
> 标签：operators, tcl

我想在 Tcl 中创建一个新的操作符，操作符是指可以按以下方式使用的 proc：

`$a**2`代替`pow($a,2)`

或者在我的情况下，我想要一个与浮点数相同的运算符，`<=`但`>=`对于浮点数，意味着：

```
proc <f= {a b {epsilon 1e-15} {
  if {$a < $b} {return 1}
  return [expr abs($a - $b) < $epsilon]
} 
```

但我想将其用作：

```
if {$a <f= $b} {... 
```

代替”

```
if {[<f= $a $b]} {... 
```

和同样的`>f=`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T17:26:15.303

您无法完全实现这一点，但有一个选项可能会有所帮助。

从 Tcl 8.5 开始，可以通过在[命名空间中创建](http://wiki.tcl.tk/tcl::mathfunc)*命令*来为迷你语言定义任意*函数*，请注意：`expr`*[`tcl::mathfunc`](http://wiki.tcl.tk/tcl::mathfunc)*

 *```
% set tcl::mathfunc::epsilon 1e-15
1e-15
% proc tcl::mathfunc::feq {a b} {
   variable epsilon
   expr {abs($a - $b) < $epsilon}
}
% expr { feq(1, 2) }
0
% expr { feq(1, 1) }
1
% expr { feq(1, 1 + 1e-16) }
1
% if {feq(1, 1 + 1e-16)} { puts OK } else { puts FAIL }
OK 
```

并且通过一些[导入/导出](http://www.tcl.tk/man/tcl8.5/TclCmd/namespace.htm)mumbo-jumbo，您可以愉快地使这个函数在您的根命名空间中作为命令可用：

```
% namespace eval tcl::mathfunc { namespace export feq }
% namespace import tcl::mathfunc::feq
% feq 1 1
1
% feq 1 [expr {1 + 1e-10}]
0
% feq 1 [expr {1 + 1e-16}]
1 
```

（或者，您可以在任何方便的命名空间中创建命令，然后将其导入`tcl::mathfunc`命名空间。）

不完全是你想要的，但在我看来已经足够接近了。

另请注意，由于 8.5 Tcl 有一个特殊的命名空间，它将所有*运算符*[`tcl::mathop`](http://wiki.tcl.tk/tcl::mathop)公开为命令，但您不能以任何方式真正修改此命名空间（但可以使用其中的命令）。`expr`

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T16:21:09.817

TCL 本身是严格的前缀表示法，所以肤浅的答案是不，你不能......

但是，您也可以[用 unknown 做一些激进的事情，](http://wiki.tcl.tk/495)或者您可以实现自己的[expr](http://wiki.tcl.tk/583)版本，它可以解析它的参数，无论它喜欢什么**

# silverlight - 将 RIA 服务放在单独的解决方案上

> ID：12731425
> 
> 赞同：1
> 
> 时间：2012-10-04T16:13:37.017
> 
> 标签：silverlight, wcf-ria-services

我有一个针对我的客户端（Silverlight 应用程序）的解决方案和一个针对我的服务器的解决方案。

当找到许多关于如何在同一解决方案上创建 RIA 服务的教程时。

但我想将 RIA 服务放在服务器端，但我没有找到说明如何做的教程。

有人可以为此目的给我一个教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:00:37.413

如果您创建 WCF Ria 服务类库类型的项目，您可以将其编译为 dll 并在您的其他解决方案中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T11:54:21.023

没问题，你可以。
打开.csproj项目“silverlight side”，一定要插入这样的标签

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
...
    <LinkedServerProject>..\MyFolder\MyDomainServerProject.csproj</LinkedServerProject>
... 
```

# objective-c - NSUndoManager 反复调用我的“恢复”方法

> ID：12731426
> 
> 赞同：0
> 
> 时间：2012-10-04T16:13:40.110
> 
> 标签：objective-c, ios, uitextview, ios6, nsundomanager

我有一个`UITextView`带有格式的工具栏。在我按下“粗体”按钮后，它会更改文本/选择并将操作注册到文本视图的`NSUndoManager`.

当您尝试撤消时，`restoreText:`会一遍又一遍地调用，直到您杀死应用程序

一些示例代码：

```
- (void)bold {
    NSRange range = self.textView.selectedRange;
    NSRange oldRange = range;
    NSString *oldText = self.textView.text;
    NSString *selection = [self.textView.text substringWithRange:range];
    self.textView.scrollEnabled = NO;
    self.textView.text = [self.textView.text stringByReplacingCharactersInRange:range
                                                           withString:[NSString stringWithFormat:@"<b>%@</b>", selection]];
    self.textView.scrollEnabled = YES;
    if (range.length == 0) {                // If nothing was selected
        range.location += 3; // Place selection between tags
    } else {
        range.location += range.length + 7; // Place selection after tag
        range.length = 0;
    }
    self.textView.selectedRange = range;
    [[self.textView.undoManager prepareWithInvocationTarget:self] restoreText:oldText withRange:oldRange];
    [self.textView.undoManager setActionName:@"bold"];
}

- (void)restoreText:(NSString *)text withRange:(NSRange)range {
    NSLog(@"restoreText:%@ %@",text, [NSNumber numberWithBool:[self.textView.undoManager isUndoing]]);
    NSString *oldText = self.textView.text;
    NSRange oldRange = self.textView.selectedRange;
    self.textView.scrollEnabled = NO;
    self.textView.text = text;
    self.textView.scrollEnabled = YES;
    self.textView.selectedRange = range;
    [[self.textView.undoManager prepareWithInvocationTarget:self] restoreText:oldText withRange:oldRange];
} 
```

和控制台：

```
2012-10-04 18:10:14.207 undotest[8861:c07] restoreText: 1
2012-10-04 18:10:14.633 undotest[8861:c07] restoreText:<b></b> 0
2012-10-04 18:10:15.117 undotest[8861:c07] restoreText: 0
2012-10-04 18:10:15.589 undotest[8861:c07] restoreText:<b></b> 0
2012-10-04 18:10:16.017 undotest[8861:c07] restoreText: 0
2012-10-04 18:10:16.557 undotest[8861:c07] restoreText:<b></b> 0 
```

我`[self.textView.undoManager isUndoing]`在注册调用之前尝试过检查`restoreText:withRange:`，但是崩溃了：

```
2012-10-04 18:10:49.297 undotest[8904:c07] restoreText: 1
2012-10-04 18:10:53.412 undotest[8904:c07] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '_endUndoGroupRemovingIfEmpty:: WebThreadSafeUndoManager 0x76551e0 is in invalid state, endUndoGrouping called with no matching begin
' 
```

此代码在 iOS5 上运行，但在 iOS6 上停止运行。我已经向 Apple 提交了一个错误，但我不确定我是否做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T15:58:33.833

Same thing happens to my UITextView instance even for simple-undoing. This must be a bug, and it means that no undo feature can be implemented by yourself to your UITextView anymore. I wonder if anyone have successfully implemented undo features on iOS6 UITextView...

Alternatively, I desided to use replaceRange:withText: (TextInput Protocol) instead to implement my undo feature on UITextView. At least you can Undo replacing text with that method. You don't need to register undo action for that by yourself. That method does it automatically.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T19:47:14.247

我遇到了同样的问题，发现访问 textView 的文本会导致奇怪的行为，例如重复调用方法并崩溃。

```
textView.text=@"" //this crashes 
```

这可以[`replaceRange:withText:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextInput_Protocol/Reference/Reference.html)通过user1263865的建议使用来解决，如果您想自定义要处理的操作以撤消/重做，您可以注册该操作，但跳过修改文本的部分，因为[`replaceRange:withText:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextInput_Protocol/Reference/Reference.html)已经处理它。

例如，如果我想创建一个明文函数，在 textView 以及自定义消息对象中明文，然后在用户撤消操作时恢复它：

```
-(void) clearEditText {
    //Register undo
    [[textView.undoManager prepareWithInvocationTarget:self] undoClearEditTextWithMessage:[self.message retain]];
    //message is retained because undo manager will not retain, it will be released when user undo.

    // Clear text field
    UITextPosition *beginning = textView.beginningOfDocument;
    UITextPosition *end= textView.endOfDocument;
    UITextRange *textRange = [textView textRangeFromPosition:beginning toPosition:end];
    [textView replaceRange:textRange withText:@""];

    self.message = /*new message*/;
}
-(void) undoClearEditTextWithMessage:(Message*)restoreMessage {
    //Register redo
    [[textView.undoManager prepareWithInvocationTarget:self] undoClearEditTextWithMessage:[self.message retain]];

    self.message = restoreMessage;

    [restoreMessage release];
    //message is released because it is retained when it is added to undo manager.
} 
```

# javascript - jQuery“没有属性”选择器？

> ID：12731428
> 
> 赞同：155
> 
> 时间：2012-10-04T16:13:47.490
> 
> 标签：javascript, jquery

我可以找到一个具有如下属性的 div：

```
$('.funding-plan-container[data-timestamp]') 
```

但是，如果我试图找到一个没有该属性的 div，我会得到一个错误 - 我的代码是：

```
$('.funding-plan-container[!data-timestamp]') 
```

jQuery 中是否有“没有属性”选择器？

作为参考，这里的用例是任何没有时间戳属性的 div 都不是动态添加的，因此很有用。

谢谢！

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2012-10-04T16:14:35.423

使用[`:not()`](http://api.jquery.com/not-selector/)选择器。

```
$('.funding-plan-container:not([data-timestamp])') 
```

* * *

顺便说一下，这是一个有效的[*Selectors API*](http://www.w3.org/TR/selectors-api/)选择器，所以它不是特定于 jQuery 的。它可以`querySelectorAll()`在你的 CSS 中使用*（给定[浏览器支持](https://caniuse.com/#feat=css-sel3)）*。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-10-04T16:15:38.267

您可以使用**[.not()](http://api.jquery.com/not/)**或**[:not()](https://api.jquery.com/not-selector/)**选择器过滤选择器。

```
$('.funding-plan-container:not([data-timestamp])'). 
```

或者

```
$('.funding-plan-container').not('[data-timestamp]') 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-04T16:15:21.693

尝试使用`:not()`伪类选择器：[http ://api.jquery.com/not-selector/](http://api.jquery.com/not-selector/)

```
$('.funding-plan-container:not([data-timestamp])') 
```

# ruby-on-rails-3 - Heroku 个人主机

> ID：12731431
> 
> 赞同：1
> 
> 时间：2012-10-04T16:13:59.777
> 
> 标签：ruby-on-rails-3, heroku

我试图了解 heroku 的工作原理。好的，我免费获得 1 个 dyno，如果我注册了一个域，我可以拥有自己的网站，例如 heroku 上的“www.mysite.com”。我更喜欢 heroku，因为上传 rails 应用程序非常简单。但是 1 dyno 有多快？为什么 1 dyno 是免费的，2 是 35 美元？因此，当我可以获得像[http://www.site5.com](http://www.site5.com)这样每月 5 美元的托管服务时，我必须每月支付至少 35 美元？有人可以为我澄清一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:41:48.813

它们在文档中并没有明确说明，但是在 30 分钟不活动后，单个测功机将进入暂停状态。这为他们节省了一点钱，但随之而来的是它收到的第一个请求将有更高的延迟，因为测功机必须唤醒。

根据我的经验，单个 Heroku dyno 的性能优于 Amazon EC2 微型实例，后者具有约 600MB 的 RAM。

升级到两个测功机后，它们将不再进入此暂停状态。

# ruby-on-rails - 如何增加一个简单的计数器并执行和更新全部？

> ID：12731437
> 
> 赞同：0
> 
> 时间：2012-10-04T16:14:15.010
> 
> 标签：ruby-on-rails, ruby

我正在尝试根据用户登录来获取当前的 ActiveRecord，并将计数器增加 1，然后使用新的增量值更新数据库，其中电子邮件地址等于登录用户。

除了设置新的增量值外，一切都在代码中工作。我尝试先将它设置为另一个变量 ( `my_counter`) 然后更新，但分配是失败的地方。

```
if User.find_by_email(@email)
      User.increment_counter(:redirect_count, 1)
      @my_counter.to_int = :redirect_count
      User.update_all({:redirect_count => @my_counter}, :email => @email) 
```

如果我设置`my_counter`为 9，那么`Updateall()`它会正确更新数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:21:13.717

怎么用[`increment!`](http://apidock.com/rails/v3.2.8/ActiveRecord/Persistence/increment!)

```
user = User.find_by_email(@email)
user.increment!(:redirect_count) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:18:43.950

怎么样

```
user = User.find_by_email(@email)
user.redirect_count += 1
user.save 
```

# php - Lithium Auth::check 用户与关系，关系数据库

> ID：12731442
> 
> 赞同：1
> 
> 时间：2012-10-04T16:14:47.177
> 
> 标签：php, lithium

我正在使用 Auth::check('user', $this->request)，其中 'user' 是我的 Auth::config 配置的名称，以针对用户表成功验证和登录用户。用户登录成功后，用户信息存储在会话中，可以通过 Auth::check('user') 访问。

我有一个关系设计，其中 Users 表与名为 Sites 的表具有多对一的关系。当 Auth::check 查询用户表以验证登录用户时，它只返回用户表中的信息。我需要 Auth:check 从 Sites 表返回用户及其相关数据。User 和 Site 模型都定义了适当的 hasOne 和 hasMany 关系。如何确保通过 Auth::check() 查询并返回用户对应的相关数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T12:53:02.830

虽然通常不建议存储比绝对必要更多的会话信息，但可以通过auth 适配器的`'query'`配置键来做到这一点。`Form`只需在您的模型中创建一个包装器方法，该方法`Users`可以接受一个查询配置数组，并返回一个具有关联关系的用户对象。大概是这样的：

```
public static function authenticate (array $query) {
    return static::all($query + array('with' => 'Sites'));
} 
```

然后，添加`'query' => 'authenticate'`到您的`'user'`身份验证配置。

# spring - grails中spring bean属性的过度自动装配

> ID：12731445
> 
> 赞同：1
> 
> 时间：2012-10-04T16:15:10.313
> 
> 标签：spring, grails

我有一个域类：

```
class Searcher  {
    String names
    List<String> getExperiments() {
        return names.split(',');
    }

    void setExperiments(List<String> list) {
         names = list.join(',');
    }
} 
```

和资源文件中定义的 bean

```
experiments(com.fxpal.querium.experiment.ExperimentHolder) {
    otherProp = 'foo'
} 
```

`experiments`bean 在语义上与类的属性`experiments`不同`Searcher`。如何防止 Spring 自动装配特定 bean 的特定属性？既然bean的`experiments`属性`Searcher`是派生的，我根本不想让Spring去碰它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-06T01:31:31.323

为什么不直接命名你的 bean ExperimentHolder？默认情况下，它会按名称自动连接。

# android - 如何获取站点“developer.android.com”的源代码？

> ID：12731447
> 
> 赞同：3
> 
> 时间：2012-10-04T16:15:19.767
> 
> 标签：android, documentation-generation

其实我在[https://android.googlesource.com/platform/docs/source.android.com](https://android.googlesource.com/platform/docs/source.android.com)找到了站点“source.android.com”的源文件， 它使用markdown格式写文章，使用相关的python生成网站的工具。

开发者站点的静态html文件虽然可以通过sdk工具下载，但是我想获取的源代码类似于我从站点source.android.com获取的，而不仅仅是静态的html内容。在我看来，站点必须由一些有用的工具生成，例如 javadoc。真的吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T20:17:33.447

您的意思是构建位于 [Android SDK]/docs 上的开发人员文档吗？
您需要做的就是“制作 sdk”。这将使 android sdk 具有完整的源代码，包括开发人员文档。

制作开发者文档的步骤：

1.  [从source.android.com](http://source.android.com)下载 android 源代码
2.  使用以下命令设置构建环境：

    $ repo init -u [https://android.googlesource.com/platform/manifest](https://android.googlesource.com/platform/manifest) -b master -g all,-notdefault,tools

    如果您已经下载了源代码，只需键入

    $ repo init -g 全部；回购同步

3.  调用以下命令来构建 Android SDK

    $ cd [ANDROID_FULL_SOURCE_DIR]
    $ 。build/envsetup.sh (或源代码 build/envsetup.sh on mac) $ lunch sdk-eng $ make sdk

4.  文档将在 out/host/[HOST_OS]-[HOST_ARCH]/sdk/ 文件夹中生成。

# java - Java 同步计数器 - get() 呢？

> ID：12731450
> 
> 赞同：3
> 
> 时间：2012-10-04T16:15:26.083
> 
> 标签：java, multithreading, synchronization, counter

众所周知，simple`x++`不是原子操作，实际上是读-增量-写操作。这就是为什么它应该同步。但是呢`get()`？我读过它也应该同步，但有人能解释一下为什么吗？通过引入`happens-before`关系来避免内存一致性错误？如果`get()`经常被多个线程调用并且值很少更改的情况呢？不是`synchronized get()`让他们慢下来吗？在这种情况下是否有其他方法可以实现同步（不使用 AtomicInteger）？`volatile`关键字在这里有用吗？

```
public class Counter {
    private int value;

    public synchronized int get() { return value; }
    public synchronized int increment() { return ++value; }
    public synchronized int decrement() { return --value; }
} 
```

谢谢！

编辑：

我想澄清一下。使用`volatile`我的意思是引入该关键字并`synchronized`在`get()`方法中删除。我想知道它是否会使其成为线程安全的，但如果许多线程正在读取该值并且一个很少更改它，它是否也会更有效。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T16:16:24.750

> 在这种情况下是否有其他方法可以实现同步（不使用 AtomicInteger）？

首先，如果可以的话，你应该使用[`AtomicInteger`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicInteger.html)。我不确定你为什么不使用它。

> volatile 关键字在这里有用吗？

是的，除了`++`. `AtomicInteger`提供无锁定的安全增量。如果您想自己滚动（出于某种疯狂的原因），那么您将需要阻塞，或者您需要复制`AtomicInteger`内部自旋机制。

> 但是 get() 呢？我读过它也应该同步，但有人能解释一下为什么吗？

`AtomicInteger`包装 a`volatile int`以提供其功能。当您访问该`volatile`字段时，您也会跨越内存障碍`get()`。您*需要*跨越该内存屏障以确保如果另一个线程已更新该值，则调用该值的线程会`get()`看到更新。否则，线程可能正在使用过时的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:19:19.587

如果您反复读取一个非易失性值，JVM 可以将该值缓存在一个寄存器中，您可能看不到任何更改。

避免这种情况的方法是使值不稳定。

但是，如果性能是一个问题，请使用无锁的 AtomicInteger。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:21:20.043

> 但是 get() 呢？我读过它也应该同步，但有人能解释一下为什么吗？

假设如果`get()`没有同步，那么任何线程都可以在线程执行`set()`操作时调用它。

现在，如果假设，线程 B 正在执行 set() 操作以将字段的值设置`a`为 5。现在，假设两个线程正在读取值 a.. 一个线程在 set 操作完成之前读取，另一个线程在 set 操作完成之后读取设置操作..

因此，两个线程都有不同的值。因此它们的 field 状态不一致`a`。

现在假设该`get()`方法是同步的..那么如果一个线程正在设置一个值..那么`get()`除非`set()`操作完成，否则没有线程可以调用操作..所以每个线程都会得到相同的值..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:21:44.783

> 但是 get() 呢？我读过它也应该同步，但有人能解释一下为什么吗？通过引入happens-before关系来避免内存一致性错误？

是的，它应该是同步的。如果不是，它可能使用了一个陈旧的值，就像增量/减量一样。

> 当 get() 经常被多个线程调用并且值很少更改时，情况会怎样。同步的 get() 不会减慢它们的速度吗？

无争议的锁非常便宜。即使对于并发获取，成本也可能不会对整体性能产生太大影响。`volatile`在这里工作，但`AtomicInteger`出于性能原因不使用可能没有必要。

> 在这种情况下是否有其他方法可以实现同步（不使用 AtomicInteger）？volatile 关键字在这里有用吗？

是的，我相信会的。

# java - 如何按 OK 按钮将数据存储在 TitleAreaDialog 中？

> ID：12731454
> 
> 赞同：3
> 
> 时间：2012-10-04T16:15:36.897
> 
> 标签：java, eclipse, swt, eclipse-rcp, jface

为什么在以下代码中（类的一部分`extends TitleAreaDialog`）：

```
@Override  
protected void createButtonsForButtonBar(Composite parent) {          
    super.createButtonsForButtonBar(parent);  
    this.getButton(IDialogConstants.OK_ID).addSelectionListener(new SelectionAdapter() {  
        @Override  
        public void widgetSelected(SelectionEvent e) {  
            okPressed();  
        }  
    });  
}  

@Override  
protected void okPressed() {  
    saveInput();  
    super.okPressed();  
}

private void saveInput(){  
    firstNameSelected = firstNameCombo.getText();  
    lastNameSelected = lastNameCombo.getText();      
} 
```

按下按钮时出现以下异常`OK`：

> org.eclipse.swt.SWTException: Widget 被配置在 org.eclipse.swt.SWT.error(SWT.java:4276) 的 org.eclipse.swt.SWT.error(SWT.java:4361) 在 org.eclipse。 swt.SWT.error(SWT.java:4247) 在 org.eclipse.swt.widgets.Widget.error(Widget.java:468) 在 org.eclipse.swt.widgets.Widget.checkWidget(Widget.java:340)在 org.eclipse.swt.widgets.Combo.getText(Combo.java:1006)

在行：`firstNameSelected = firstNameCombo.getText();`的`saveInput`？
为什么小部件被放置在选择上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:23:30.883

尝试`createButtonsForButtonBar(Composite parent)`完全删除该方法。该对话框应`okPressed`自行调用。

此外，我认为`super.okPressed()`没有必要打电话。至少我从不使用它。只是打电话`this.close()`。

这是我使用的简单模板：

```
public class OptionsDialog extends Dialog {

    public OptionsDialog(Shell parentShell)
    {
        super(parentShell);
        setShellStyle(SWT.CLOSE | SWT.TITLE | SWT.BORDER | SWT.APPLICATION_MODAL);
        setBlockOnOpen(true);
    }

    protected Control createDialogArea(Composite parent) {
        Composite composite = (Composite) super.createDialogArea(parent);

        GridLayout layout = new GridLayout(1, false);
        layout.marginHeight = 5;
        layout.marginWidth = 10;

        composite.setLayout(layout);

        GridData gridData = new GridData();
        gridData.widthHint = 500;

        composite.setLayoutData(gridData);

        createContent();

        return composite;
    }

    private void createContent()
    {
        /* ADD WIDGETS */
    }

    protected void configureShell(Shell newShell)
    {
        super.configureShell(newShell);
        newShell.setText("Options");
    }

    public void okPressed()
    {
        /* SAVE VALUES */
        this.close();
    }

    /* GETTERS AND SETTERS/ */

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T06:16:17.970

你不需要`okPressed()`在里面调用方法`widgetSelected()`。我认为根本没有必要调用`widgetSelected()`方法。由`okPressed()`对话框本身调用。

您可能想尝试以下代码。

```
public ClassNameWhichExtendsTitleAreDialog(Shell parentShell) {
    super(parentShell);
}

@Override
protected void createButtonsForButtonBar(Composite parent) {
    createButton(parent, IDialogConstants.OK_ID, IDialogConstants.OK_LABEL, true);
    createButton(parent, IDialogConstants.CANCEL_ID, IDialogConstants.CANCEL_LABEL, false);
}

@Override
protected void okPressed() {
    firstNameSelected = firstNameCombo.getText();
    lastNameSelected = lastNameCombo.getText();
    super.okPressed();
}

// A function to return the name values obtained 
```

# javascript - 尽管尚未加载dom，如何在主干中声明jquery元素

> ID：12731457
> 
> 赞同：1
> 
> 时间：2012-10-04T16:15:42.303
> 
> 标签：javascript, jquery, backbone.js

我将 dom 元素列表定义为 Backbone 视图对象的属性，如下所示：

```
el : $("body"),
elTicket : $('#ticket'),
... 
```

但是，这些 jquery 对象指向的 dom 尚未生成。

当这个问题出现时，我曾经做的是将 jquery 对象包装在一个函数中并像这样返回它：

```
el : function(){
    return $('body');
},
... 
```

然后导致这样一条丑陋的线：

```
this.el().append('dasd'); 
```

有没有更好的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:20:23.137

如[文档](http://backbonejs.org/#View-el)示例中所示，您应该使用选择器（而不是 jQuery 对象）作为`Backbone.View`属性值：

```
App.MyView = Backbone.View.extend({
    el: 'body',
    elTicket: '#ticket',
    ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:42:57.293

在不了解上下文的情况下很难给出全面的答案，但我鼓励您从另一个角度看待这个问题。

对于 body 标签，在 body 被加载到 DOM 之后运行你的代码。您可以通过将脚本标记放在 HTML 文件的末尾来执行此操作，或者使用其中一个 ifDocumentLoaded 函数并在其中调用您的主干代码。

如果主文档已经加载，并且您刚刚选择 body 作为您的问题的示例 - 假设标签是 div。您可以在尚未加载到 DOM 的元素上调用 JQuery。发生的情况是 JQuery 创建了这个元素，但它没有附加到 DOM。您可以稍后在机会合适时附加它 - 可能使用 $(body).append(this.el) 之类的查询方法。

请注意，默认情况下，el 属性是一个普通的旧 DOM 元素，预计将对应于特定视图。所以你可以拥有：

```
App.MyView = Backbone.View.extend({
    tagName: 'table', 
    ...   
}); 
```

您可以自动访问 App.MyView.el。它将是一个未附加的 DOM 元素，其标签名称为 table。现在，如果你想对这个 DOM 元素应用一些 Jquery 魔法，你可以通过 App.MyView.$el 访问它

# objective-c - 同一个视图中的多个 UIAlertViews

> ID：12731460
> 
> 赞同：5
> 
> 时间：2012-10-04T16:15:57.973
> 
> 标签：objective-c, ios, uialertview

我有两个带有确定/取消按钮的 UIAlertView。
我通过以下方式捕获用户响应：

```
- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex 
```

我遇到的问题是，**当前打开了哪个 alertView？**
在每一个上单击确定/取消时，我有不同的操作要做......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-04T16:20:19.237

你有几个选择：

*   使用 ivars。创建警报视图时：

    ```
    myFirstAlertView = [[UIAlertView alloc] initWith...];
    [myFirstAlertView show];
    // similarly for the other alert view(s). 
    ```

    在委托方法中：

    ```
    - (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex {
        if (alertView == myFirstAlertView) {
            // do something.
        } else if (alertView == mySecondAlertView) {
            // do something else.
        }
    } 
    ```

*   使用 的`tag`属性`UIView`：

    ```
    #define kFirstAlertViewTag 1
    #define kSecondAlertViewTag 2 
    ```

    ```
    UIAlertView *firstAlertView = [[UIAlertView alloc] initWith...];
    firstAlertView.tag = kFirstAlertViewTag;
    [firstAlertView show];
    // similarly for the other alert view(s). 
    ```

    ```
    - (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex {
        switch (alertView.tag) {
            case kFirstAlertViewTag:
                // do something;
                break;
            case kSecondAlertViewTag:
                // do something else
                break;
        }
    } 
    ```

*   子类化`UIAlertView`并添加一个`userInfo`属性。通过这种方式，您可以向警报视图添加标识符。

    ```
    @interface MyAlertView : UIAlertView
    @property (nonatomic) id userInfo;
    @end 
    ```

    ```
    myFirstAlertView = [[MyAlertView alloc] initWith...];
    myFirstAlertView.userInfo = firstUserInfo;
    [myFirstAlertView show];
    // similarly for the other alert view(s). 
    ```

    ```
    - (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex {
        if (alertView.userInfo == firstUserInfo) {
            // do something.
        } else if (alertView.userInfo == secondUserInfo) {
            // do something else.
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:19:21.363

`UIAlertView`是一个`UIView`子类，因此您可以使用它的`tag`属性进行标识。因此，当您创建警报视图时，设置其标记值，然后您将能够执行以下操作：

```
- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex{
   if (alertView.tag == kFirstAlertTag){
      // First alert
   }
   if (alertView.tag == kSecondAlertTag){
      // First alert
   }
} 
```

# objective-c - 为什么 WriteToFile 方法在 (IBAction)btnClicked:(id)sender 中不起作用？

> ID：12731462
> 
> 赞同：0
> 
> 时间：2012-10-04T16:16:02.983
> 
> 标签：objective-c, ios, writetofile

以下是我的源代码：

/ *--'fileName' 是一个可用的文件路径。--* /

```
NSLog(@"%@", @"v-log start");
NSMutableArray *txtArray = [[NSMutableArray alloc] init];
[txtArray addObject:@"test"];
[txtArray writeToFile:fileName atomically:YES];
NSLog(@"%@", @"v-log end"); 
```

如果我将它们放在 (void)viewDidLoad 中，这些代码可以完美运行

但是当我将它们放入 (IBAction)btnClicked:(id)sender 时，我得到 'FilesHandling[3294:c07] ** -[NSPathStore2 getFileSystemRepresentation:maxLength:]: message sent to deallocated instance 0x7146ad0' 异常。*

你能告诉我为什么吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T14:15:52.177

可能是因为 fileName 字符串已被释放。你留住了吗？

# android - Android 和 Gradle：无法在类路径或引导类路径中找到 java.lang

> ID：12731470
> 
> 赞同：-2
> 
> 时间：2012-10-04T16:16:35.070
> 
> 标签：android, gradle

我想尝试新的 android 构建系统 gradle，所以我安装了 gradle 1.2 并下载了 android 的示例。

当我尝试使用命令 gradle build 构建基本示例时，我得到以下输出/错误：

```
Download http://repo1.maven.org/maven2/com/android/tools/build/gradle/0.1/gradle
-0.1.pom
Download http://repo1.maven.org/maven2/com/android/tools/build/builder/0.1/build
er-0.1.pom
Download http://repo1.maven.org/maven2/com/android/tools/build/gradle/0.1/gradle
-0.1.jar
Download http://repo1.maven.org/maven2/com/android/tools/build/builder/0.1/build
er-0.1.jar
:prepareDebugDependencies
:compileDebugAidl
:generateDebugBuildConfig
:crunchDebugRes
:processDebugManifest
:processDebugRes
:compileDebug
Fatal Error: Unable to find package java.lang in classpath or bootclasspath
:compileDebug FAILED

FAILURE: Build failed with an exception.

* What went wrong:
Execution failed for task ':compileDebug'.
> Compilation failed; see the compiler error output for details.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug
option to get more log output.

BUILD FAILED

Total time: 18.926 secs 
```

任何想法如何解决这一问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:50:49.590

这在 0.2 中已修复，现在可在 Maven 中使用。

# ios - CFNetDiagnosticCopyNetworkStatusPassively 中可能存在的错误？仅通过 3G/4G 返回 kCFNetDiagnosticConnectionDown。

> ID：12731471
> 
> 赞同：3
> 
> 时间：2012-10-04T16:16:35.297
> 
> 标签：ios, 3g, internet-connection, cfnetworking

这里有一个奇怪的错误。这仅在 iOS 设备专门用于 3G/4G 网络时才会出现。即如果通过WiFi - 没有错误，一切正常。

```
- ( BOOL ) isInternetAccessAvailable
{
    CFNetDiagnosticRef diag;

    diag = CFNetDiagnosticCreateWithURL ( NULL, ( __bridge  CFURLRef )[NSURL URLWithString:@"www.apple.com"] );

    CFNetDiagnosticStatus status;

    status = CFNetDiagnosticCopyNetworkStatusPassively ( diag, NULL );

    CFRelease ( diag );

    if ( status == kCFNetDiagnosticConnectionUp )
    {
        return YES;
    }
    else
    {
        NSString * title   = @"No Internet Connection";
        NSString * message = @"Please ensure you have an Internet Connection.";

        [self showAlertWithTitle:title andMessage:message];

        return NO;
    }
} 
```

好的，所以我在尝试将数据加载到 UIWebView 之前调用了上述方法。

正如我所说 - 通过 WiFi 网络，这非常有效。

如果 WiFi 已关闭（或不可用/未连接）并且设备正在使用 SIM 卡进行 3G/4G 网络。

调用的行：

```
status = CFNetDiagnosticCopyNetworkStatusPassively ( diag, NULL ); 
```

返回一个 long 等价于：

```
kCFNetDiagnosticConnectionDown 
```

因此，我的测试失败了，我向用户显示警告 UIAlertView。

但是网络是有的！如果我将测试行更改为：

```
if ( ( status == kCFNetDiagnosticConnectionUp ) || ( status == kCFNetDiagnosticConnectionDown ) ) 
```

它在 3G/4G 上运行并下载网页 - 因此设备或网络没有故障。

但呼叫`CFNetDiagnosticCopyNetworkStatusPassively`仅在 3G/4G 上失败。

有任何想法吗？

这刚刚在我最近加急进入 App Store 的应用程序中发现，以满足广告和商品销售的最后期限，如果我的代码有错误 - 我需要尽快修复并重新提交。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T18:49:50.977

Apple确认的错误。

如果你愿意，可以复制：错误 ID# 12443370

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T10:06:55.687

您可以使用它来检查连接

[如何在 iOS 或 OSX 上检查活动的 Internet 连接？](https://stackoverflow.com/questions/1083701/how-to-check-for-an-active-internet-connection-on-iphone-sdk).

同步版本的 cannyboyn 答案：以[https://github.com/tonymillion/Reachability中的 Reachability.h 和 Reachability.m](https://github.com/tonymillion/Reachability)

```
#import "Reachability.h"

- (BOOL)connected 
{
    Reachability *reachability = [Reachability reachabilityForInternetConnection];  
    NetworkStatus networkStatus = [reachability currentReachabilityStatus]; 
    return !(networkStatus == NotReachable);
} 
```

# objective-c - 无法加载 localizable.strings

> ID：12731472
> 
> 赞同：1
> 
> 时间：2012-10-04T16:16:40.013
> 
> 标签：objective-c, ios, nslocalizedstring

删除项目的一种语言后，项目中其他现有的可本地化文件无法正确加载。文件包含在捆绑资源中，但它们没有正确加载，加载方法不会返回任何值，因为 localizable.strings 文件中包含的字符串键。

![在此处输入图像描述](../Images/30c733632b0084c4495d2a00f9108869.png)

这是加载方法：

```
-(NSString*) languageSelectedStringForKey:(NSString*) key
{

    NSString *path;

    NSUserDefaults *currentDefaults = [NSUserDefaults standardUserDefaults];
    NSArray *languages = [currentDefaults objectForKey:@"AppleLanguages"];
    NSString *selectedLanguage = [languages objectAtIndex:0];

    if([selectedLanguage isEqualToString:@"es"])
        path = [[NSBundle mainBundle] pathForResource:@"es" ofType:@"lproj"];
    else if([selectedLanguage isEqualToString:@"en"])
        path = [[NSBundle mainBundle] pathForResource:@"en" ofType:@"lproj"];

    NSBundle* languageBundle = [NSBundle bundleWithPath:path];
    NSString* str=[languageBundle localizedStringForKey:key value:@"" table:nil];

    path=nil;

    languages=nil;

    selectedLanguage=nil;

    languages=nil;

    languageBundle=nil;

    return str;

} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:57:57.060

在大多数情况下，您可以只使用[`NSLocalizedString`](https://developer.apple.com/library/ios/#documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html)来查找字符串的翻译。例如：

```
myLabel.text = NSLocalizedString(@"The String Key", @"Comment for translators"); 
```

为了探索查找这些字符串的问题，我有两个建议：

*   仔细检查 iPhone / 模拟器是否设置为您要显示的语言。是的，这应该很明显，但让我们保持安全。
*   在模拟器中运行您的应用程序，并记录以下路径：

    `NSLog(@"Bundle path is: %@", [[NSBundle mainBundle] bundlePath]);`

从那里您可以探索您的应用程序用于执行特定语言查找的文件树（使用 Finder 或终端检查该目录中的文件）。您应该会看到直接在上面记录的路径中的目录，看起来像 {ios-language-code}.lproj 并且每个目录中都应该有一个名为 Localizable.strings 的文件（假设您使用的是默认翻译设置）。例如，`en.lproj`对于英语和`fr.lproj`法语。

从那里，我建议验证这些文件的格式是否正确，[此处](https://developer.apple.com/library/ios/#documentation/MacOSX/Conceptual/BPInternational/Articles/StringsFiles.html)描述。了解使用这些文件的工具也很好，这些文件[在此处](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/LoadingResources/Strings/Strings.html#//apple_ref/doc/uid/10000051i-CH6)进行了描述。

如果文件结构不是您所期望的，一种可能性是在 Xcode 中检查您的目标的构建阶段，并验证它`Localization.strings`是否列在“复制捆绑资源”部分下。

我很确定，如果您的捆绑包中有正确的 .lproj 目录，并且`.strings`这些目录中有正确的文件，那么`NSLocalizedString`应该可以按预期工作 - 所以即使上述建议不能完全解决您的问题，您可以减少修复主捆绑文件结构的问题。

# ruby-on-rails - 访问rails中lib文件夹中的实例变量

> ID：12731474
> 
> 赞同：0
> 
> 时间：2012-10-04T16:16:45.483
> 
> 标签：ruby-on-rails, ruby

是否可以通过我的文件夹中的方法访问`instance variable`在 a 中定义的访问？考虑我的 lib 文件夹中的类`controller``lib``DoSomething`

```
# inside /lib folder
class DoSomething

    def fun
        puts @some_text
    end

end

class SampleController < ApplicationController

  def index
    @some_text = "ha ha ha"
    DoSomething.new().fun
  end

end 
```

这不会打印任何东西。我可以将值传递给方法，但我想知道没有它是否可以做到？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:31:20.117

您不能直接访问它，但可以将它传递给 DoSomething 的初始化程序：

```
# inside /lib folder
class DoSomething

  def initialize(some_text)
    @some_text = some_text
  end

  def fun
    puts @some_text
  end
end

class SampleController < ApplicationController

  def index
    @some_text = "ha ha ha"
    DoSomething.new(@some_text).fun
  end
end 
```

# android - 从 BroadcastReceiver 发起新的电话呼叫

> ID：12731475
> 
> 赞同：0
> 
> 时间：2012-10-04T16:16:46.950
> 
> 标签：android

我正在用我的`BroadcastReceiver`.

当发出某些呼叫时，满足特定号码和/或条件 - 没关系，我拦截呼叫。

之后，我想拨打一个新电话到另一个号码。在这里我遇到了麻烦。未发出呼叫 - 没有任何反应 - 新活动已启动，但未启动呼叫。空视图，仅此而已。

顺便说一下，BroadcastReceiver 接收到意图，然后`CallInitiatingActivity.onCreate()`被调用并执行。

广播监听器

```
public class OutgoingCallListener extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        if (conditionsAreMet()) {
            setResultData(null); //terminate current call
            Inetent intent = new Intent(context, CallInitiatingActivity.class)
            intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET);
            startActivity(intent);
        }
    }
} 
```

呼叫发起活动

```
public class CallInitiatingActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Intent intent = new Intent(Intent.ACTION_CALL, Uri.parse("tel:" + number));
        startActivity(intent);
    }
} 
```

使用的权限：

```
<uses-permission android:name="android.permission.CALL_PHONE"/> 
```

可疑登录调试级别：

```
checkAndCopyPhoneProviderExtras: some or all extras are missing. 
```

我在第 2074 行将其追溯到[此类中的方法。](https://android.googlesource.com/platform/packages/apps/Phone/+/1e8a3579f8e49fd1f1a078d6be6864a6a8bac306/src/com/android/phone/PhoneUtils.java)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:19:18.283

您可能需要确保您拥有正确的权限：

```
<uses-permission android:name="android.permission.CALL_PHONE"></uses-permission> 
```

它可能有助于添加

```
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
```

到意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:05:29.147

您像这样在 Manifest.xml 中为 BroadcastReceiver 类定义操作

```
 <receiver android:name="yourBroadcastReceiverpackagename.BroadcastReceiverclassname" 
       android:exported="false">
 <intent-filter>
 <action 
       android:name="Declare your Action name here"/>
 </intent-filter> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-09T11:08:46.030

问题中的代码正常启动新呼叫。但我看不到这一点，因为 BroadcastReceiver 接收到带有`NEW_OUTGOING_CALL`动作的意图。

那是当我创建`ACTION_CALL`并添加附加内容以识别我手动创建了一个调用，该调用将意图“转换”为具有`NEW_OUTGOING_CALL`操作的另一个意图。这种方式有效地失去了所有额外的东西。

# batch-processing - 如何在批处理（.bat）脚本中检查字符串是否超过 5 个字符

> ID：12731477
> 
> 赞同：0
> 
> 时间：2012-10-04T16:17:00.347
> 
> 标签：batch-processing, batch-file

我想编写一个简单的批处理脚本来检查输入字符串是否超过 5 个字符。

就像是：

```
SET /P INPUT=Enter your string:
IF %INPUT% > 5 (
          ECHO %INPUT% has more than 5 chars
) ELSE (
          ECHO %INPUT% has less than 5 chars
) 
```

如何在 .bat 中执行此类检查？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:36:44.913

您可以通过简单的子字符串操作查看第五个字符之后是否有字符：

```
if defined INPUT if "%INPUT:~5,1%"=="" (
    echo five or less characters
) else (
    echo more than five characters
) 
```

如果您在某处不需要实际数字，则无需计算字符串的长度。尽管 jeb 获取长度的方法相当聪明（与此处使用的想法完全相同）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:42:20.400

我确定您已经在批处理文件脚本中从输入中获取字符串长度并不是很直接。一个简单的方法是测试输入字符串的前 5 个字符（或任意 x 个字符）是否与输入字符串相同。例如：

```
SET /P INPUT=Enter your string:
IF [%INPUT%]==[%INPUT:~0,5%] (
      ECHO %INPUT% has more than 5 chars
) ELSE (
      ECHO %INPUT% has less than 5 chars
) 
```

诚然，这不适用于您可能需要的每个逻辑场景，但对于许多场景来说它相当简单。仅供参考，我添加了`[]`字符以防止空字符串比较。

希望有帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:35:19.860

[这与这个问题](https://stackoverflow.com/questions/5837418/how-do-you-get-the-string-length-in-a-batch-file)非常相似。听起来您必须为此编写自己的函数，然后将结果与 5 进行比较。幸运的是，该问题的回答者为您提供了一个函数。

此外，谷歌是你的朋友。

# objective-c - 苹果生成代码中的数组快捷方式

> ID：12731479
> 
> 赞同：3
> 
> 时间：2012-10-04T16:17:04.780
> 
> 标签：objective-c, xcode, syntax

我刚刚在 xCode 中启动了一个新项目，并在应用程序委托中看到了这一行：

```
self.tabBarController.viewControllers = @[viewController1, viewController2]; 
```

我知道这是一个数组，但它在 Obj-C 中对我来说是新的。

任何人都可以解释这种语法的来源吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:18:59.340

这是最近添加到 Objective C 中的一种新语法。还有一种用于[s](http://clang.llvm.org/docs/ObjectiveCLiterals.html)`NSNumber`、`NSDictionary`s 和使用方括号访问数组的新语法：

```
NSNumber *fortyTwo = @42;

NSDictionary *dict = @{ @"key1" : @1.23,  @"key2" : @4.56};

NSMutableArray *array = ...;
id newObject = ...;
array[123] = newObject; 
```

# android - 如何为原生移动应用程序进行部分产品发布？

> ID：12731483
> 
> 赞同：0
> 
> 时间：2012-10-04T16:17:25.333
> 
> 标签：android, ios, windows-phone-7, blackberry, release-management

对于 Web 应用程序，我喜欢*部分*生产版本的想法，例如，负载均衡器后面有 5 个服务器节点，而新的代码更改只会发布到其中的 1 或 2 个。如果存在错误，它有助于最大限度地减少对客户的影响，并且可以更快地退出（恕我直言）。

但是，如果我们谈论的是移动应用程序（实际的原生二进制文件，而不是移动 Web 应用程序）呢？Android、iOS、黑莓、Windows Phone……这些市场是否支持部分发布的概念，即只有一小部分客户可以下载发布？

如果没有，任何人都可以想出一种骇人听闻的方式来完成同样的事情吗？我什至愿意做一些事情，如果我们有 1,000 名客户，我们允许最多 50 名客户注册新应用程序版本的“抢先发布”。然后我们只需要弄清楚如何让前 50 名注册者独占访问新版本。

我愿意做任何事情，只要有办法只将新的本地二进制文件发布到总客户群的一小部分，然后在未来某个时候发布到整个池。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-07T15:53:08.390

Facebook 有一个称为 Gatekeeper 的系统，它在内部用于他们的移动应用程序。它允许公司通过逐步为其用户启用 UI 元素来发布新功能，如果您知道功能切换它非常相似。

Google Play 有一个分阶段推出的解决方案，用于逐步发布新版本（完整版本），您可以控制将收到应用新版本的用户百分比。（[阅读更多](https://support.google.com/googleplay/android-developer/answer/3131213?hl=en)）

关于 Rollout.io：（免责声明，我是联合创始人）

Rollout.io 的构建允许您从云端控制您的生产环境，它目前专注于解决生产中的错误。我们有一些客户使用它进行功能切换、远程配置和 A/B 测试。查看我们的[视频](https://www.youtube.com/watch?v=4nT-1Nw0ihw)和[网站](https://www.rollout.io)了解更多详情。

我们目前处于测试阶段，正在逐步添加新用户（如果您需要排队等候，请告诉我）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:21:48.773

苹果应用商店不允许这样做。我建议每次收到错误报告或功能请求时，都请他们成为 beta 测试人员。尽可能收集接近 100 个允许的数量，并使用新功能进行大型 beta 推送，您至少知道他们是足够关心为您提供报告的用户。这将是更多的工作，但它会给你一个安全的方式来进行真正的测试，然后再推送给每个人。

在 Android 上，您可以通过在多个应用商店发布您的应用并一次只更新其中一个商店来伪造这一点。如果您只打算支持 Google Play，这将是很多工作。

# c++ - 具有两种不同数据类型的二维数组？

> ID：12731493
> 
> 赞同：2
> 
> 时间：2012-10-04T16:17:57.743
> 
> 标签：c++, arrays

在 C++ 中，我试图创建一个数组来存储两种不同的数据类型。本质上，我想要一个 ID 和实际的数据类型。

伪代码：

```
array[int][myObj]

0, myObj1
1, myObj2
2, myObj3 
```

我明白这不是如何声明一个数组。这个功能可以吗？我是否必须使用结构创建自定义类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:41:44.187

这取决于你想如何使用它。有许多选项都有有效的用例：

1.  一个简单的 myObj: 数组`myObj array[]`。这与您给出的示例相匹配，因为对象的关联 ID 只是该对象在数组中的索引。第一个元素的 ID 为 0，第二个元素的 ID 为 1，依此类推。但是，为了灵活性和良好的 C++ 风格，您应该使用`std::vector`or `std::array`。

2.  如果您想将每个对象与固定 ID 相关联，无论其在数组中的位置如何（也可能在其他位置）。您可以使用 a`std::pair<int, myObj>`将整数与对象的实例配对。你会像这样使用它：

    ```
    std::vector<std::pair<int, myObj>> v;
    v.push_back(std::make_pair(0, myObj1)); 
    ```

    对此类似的替代方法是将 ID 封装在 myObj 类中。但是，这在某些情况下可能不合适（ID 实际上不是 myObj 的一部分，不同的 ID 可以随时用于同一对象）。

3.  如果您需要能够通过其 ID 访问数组中的元素，您需要一个`std::map<int, myObj>`. 这会将整数 ID 映射到 myObj 的实例。像这样使用它：

    ```
    std::map<int, myObj> m;
    m.insert(std::make_pair(0, myObj1)); 
    ```

    现在您可以使用例如`m[0]`. 如果您想加快访问时间并且不关心被订购的元素，您可以使用 a`std::unordered_map`代替

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:27:06.667

在 C++ 中，数组的所有成员都属于同一类型，多维数组实际上是作为一维数组实现的。

如果您只想要一个包含具有两种不同类型的行的数组，我建议：

```
std::vector<std::pair<int, MyObj> > vec; 
```

或者：

```
std::pair<int, MyObj> arr[200]; // generally always prefer std::vector over array, but this is possible 
```

如果您想基于 int 查找 MyObj 对象，则可以使用 std::map 或 std::multimap 。

# java - 使用 JSONObject 类或其他方式获取 json 对象并将其解析为 java 内部的字符串？

> ID：12731496
> 
> 赞同：0
> 
> 时间：2012-10-04T16:18:07.690
> 
> 标签：java, android, json

我看到了这个链接：[How to parse a JSON and turn its values into an Array?](https://stackoverflow.com/questions/2255220/how-to-parse-a-json-and-turn-its-values-into-an-array) 并认为它很有用。这对我有用，除了一件事。我没有参考资料。我有：

```
 ["some_long_string"] 
```

这就是数据。我不知道为什么会这样，但是当我检查日志时，这就是我的 Java 中的数据吐出的内容。

通过上面链接中的示例，我正在查看带有 Java 的 JSONObject，也由他们的站点表示：http: [//www.json.org/java/](http://www.json.org/java/)

我看到了解决此问题的选项，但对语法不太确定。如果您能提供帮助，那就太好了。我的尝试是这样的：

```
 JSONObject myjson = new JSONObject(data);
 //String item = myjson.getStrings()[0]; //or something like this. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:21:26.237

用这个：

```
JSONArray arr = (JSONArray)new JSONTokener(sourceString).nextValue(); 
```

请参阅[JSONTokener](http://www.json.org/javadoc/org/json/JSONTokener.html)的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:38:11.773

获取一个 ArrayList 并将整个字符串解析为 Arraylist，如下所示：

```
ArratList<string> list = new ArrayList<string>();

list.add(yourJSONObject.getString(index));
list.add(yourJSONObject.getString(index)); 
```

您可以将所有值一一添加到ArrayList并将字符串解析为ArrayList。您也可以将其用作多个值，如下所示，如果要解析多个数据类型JSON，则可以使用以下步骤。首先创建一个包含所有数据类型的类。

```
class multipledatatypes{
    int id;
    String a,b,c;
    Double d;
} 
```

现在将此类解析为 Arralist 并插入如下值

```
ArrayList<multipledatatypes> list = new ArrayList<multipledatatypes>();
 for (int i = 0; i < JArray_cat.length(); i++) {
         multipledatatypes mdto = new multipledatatypes();
         mdto.id = yourJSONObject.getInt(index);
         mdto.a = yourJSONObject.getString(index);
         mdto.b = yourJSONObject.getString(index);
         mdto.c = yourJSONObject.getString(index);
         mdto.d = yourJSONObject.getDouble(index);
         list.add(mdto);
    } 
```

这是如何将数据解析到 Arraylist 并在代码中使用它。

希望对你有帮助....

# javascript - Javascript Intellisense 消息：JS Intellisense:Internal/(1:0) : Function expected

> ID：12731498
> 
> 赞同：0
> 
> 时间：2012-10-04T16:18:09.343
> 
> 标签：javascript, visual-studio-2010, intellisense, javascript-intellisense

我正在使用 Visual Studio 2010。我已经使用了很长时间没有问题。今天，每当我尝试声明一个变量并在我的 javascript 文件中使用它时，我都会收到此消息。

```
Javascript Intellisense Message: JS Intellisense:Internal/(1:0) : Function expected 
```

这个问题的原因是什么？我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:14:36.150

确保您的 HTML 中没有任何未定义的事件激活函数，例如：

```
<select id="selection" onclick="myfunction()"></select> 
```

其中 myfunction() 没有在任何地方定义。

# c# - 托管在 IIS 7.5 上的 ASP.Net MVC 3 Razor 视图（cshtml 文件）似乎以某种方式被缓存（没有客户端或输出缓存）

> ID：12731503
> 
> 赞同：1
> 
> 时间：2012-10-04T16:18:49.763
> 
> 标签：c#, asp.net-mvc-3, caching, razor, iis-7.5

我们在编辑 cshtml 文件时遇到了缓存问题。我们的 ASP.net MVC 3 应用程序在 Windows Server 2008 上使用 IIS 7.5 托管。现在，当我们编辑一个 cshtml 文件时，在我们重置 iis 之前更改不会显示 - 这是我们不想在生产中过于频繁地做的事情系统。

根据 fiddler、STRG-F5 和 Firebug 的说法，这不是客户端缓存问题（无论如何这都会很奇怪）。因此，不会向客户端发送与缓存相关的 HTTP 标头。我们确实在 web.config 中配置了 staticContent。

无论如何，也没有为相应的控制器操作配置 OutputCaching。实际上，我们在这个项目中根本没有使用 OutputCaching。我们在互联网上找不到太多信息，并且对这里实际发生的事情感到有点困惑。

知道为什么 IIS、ASP.Net MVC 或客户端和 Web 服务器之间的东西似乎在缓存 cshtml 文件的内容吗？

相关视图不是子视图。

注意：这不是卡西尼的问题。此外，更新后的视图中具有动态内容的部分视图行为正确。这也导致了（对我而言）它与 OutputCaching 无关的结论。

提前致谢。

# c# - 为什么我的数据类型在分配时从大端转换回小端？

> ID：12731511
> 
> 赞同：2
> 
> 时间：2012-10-04T16:19:19.897
> 
> 标签：c#, endianness

考虑到我的数据类型的字节顺序，我遇到了问题。我必须使用 TCP / IP 通过以太网发送数据。然而，字节顺序在发送时需要为大端，在接收时为大端。因此，我尝试在使用此类发送之前反转我的所有日​​期：

```
class ReverseBinaryReader : BinaryReader
{
    private byte[] a16 = new byte[2];
    private byte[] ua16 = new byte[2];
    private byte[] a32 = new byte[4];
    private byte[] a64 = new byte[8];
    private byte[] reverse8 = new byte[8];
    public ReverseBinaryReader(System.IO.Stream stream) : base(stream) { }

    public override int ReadInt32()
    {
        a32 = base.ReadBytes(4);
        Array.Reverse(a32);
        return BitConverter.ToInt32(a32, 0);
    }

    public override Int16 ReadInt16()
    {
        a16 = base.ReadBytes(2);
        Array.Reverse(a16);
        return BitConverter.ToInt16(a16, 0);
    }

    [ . . . ] // All other types are converted accordingly.

} 
```

这工作正常，直到我像这样分配转换后的值：

```
ReverseBinaryReader binReader = new ReverseBinaryReader(new MemoryStream(content));

this.Size = binReader.ReadInt16();  // public short Size 
```

例如，如果我想将字节：0x00、0x02 保存为大端，我希望在内存中：0x0200 但是大小的短值将变为 0x0002。这是为什么？

有任何想法吗？谢谢，同行

// 编辑 2：

为了澄清这个问题，我将尝试展示一个示例：

```
public class Message {
    public short Size;
    public byte[] Content;

    public Message(byte[] rawData)
    {
        ReverseBinaryReader binReader = new ReverseBinaryReader(new MemoryStream(rawData));

        this.Size = binReader.ReadInt16();  // public short Size
        this.Content = binReader.ReadBytes(2); // These are not converted an work just fine.
    }
}

public class prog {
     public static int main()
     {
          TCPClient aClient = new TCPClient("127.0.0.1",999); // Async socket
          aClient.Send(new Message(new byte[] { 0x00, 0x02 } );
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:15:23.160

**编辑：**

将其移至顶部，因为它是实际答案。

我不得不盯着它看很久，但这是你错误的根源。

*   您的初始数组是 { 0x00, 0x02 } 在 LE 中是 0x0200，BE 是 0x0002
*   您通过网络发送它，并读取前两个字节仍然 { 0x00, 0x02 }
*   你把它反转给你 {0x02, 0x00} LE 是 0x0002，BE 是 0x0200
*   您的架构是 Little Endian，因此您会得到 0x0002 的“正确”结果。

因此错误在您的测试数组中。您可以通过检查 BitConverter 上的 IsLittleEndian 属性来验证您的架构是否为小端。

```
===================================================== 
```

以下代码旨在帮助澄清，而不是回答您的直接问题。并表明 BitConverter 在所有架构上都是可预测的。

```
using System;

namespace BitConverterTest
{
    class Program
    {
        static void Main(string[] args)
        {
            UInt32 u32 = 0x01020304;

            byte[] u32ArrayLittle = {0x04, 0x03, 0x02, 0x01};
            byte[] u32ArrayBig = {0x01, 0x02, 0x03, 0x04};

            if (BitConverter.IsLittleEndian)
            {
                if (BitConverter.ToUInt32(u32ArrayLittle, 0) != u32)
                {
                    throw new Exception("Failed to convert the Little endian bytes");
                }
                Array.Reverse(u32ArrayBig); // convert the bytes to LittleEndian since that is our architecture.
                if (BitConverter.ToUInt32(u32ArrayBig, 0) != u32)
                {
                    throw new Exception("Failed to convert the Big endian bytes");
                }
            } else
            {
                Array.Reverse(u32ArrayLittle); // we are on a big endian platform
                if (BitConverter.ToUInt32(u32ArrayLittle, 0) != u32)
                {
                    throw new Exception("Failed to convert the Little endian bytes");
                }
                if (BitConverter.ToUInt32(u32ArrayBig, 0) != u32)
                {
                    throw new Exception("Failed to convert the Big endian bytes");
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:51:47.863

请尝试以下方法：

```
public override Int16 ReadInt16()
{
    a16 = base.ReadBytes(2);
    return ((Int16)a16[1] * 0x00FF) + (Int16)a16[0];
}

public override int ReadInt32()
{
    a32 = base.ReadBytes(4);
    return ((int)a32[3] * 0x00FFFFFF) + (int)a32[2] * 0x0000FFFF) + (int)a32[1] * 0x000000FF) + (int)a32[0];
} 
```

至于为什么会这样，如果您期望 0x00, 0x02 是 0x0200 那么您使用的是 little-endian （因为最低有效字节在前）。

由于 BitConverter 是系统依赖的，而您的实现不是，我建议在合理的情况下尽量远离它。

# yii - 为什么 yiic 消息忽略 yii::t() 新字符串？

> ID：12731512
> 
> 赞同：0
> 
> 时间：2012-10-04T16:19:21.007
> 
> 标签：yii

在我的索引控制器上，我有以下新翻译：

```
$this->pageTitle = yii::t('sitename','what we do');
Yii::app()->clientScript->registerMetaTag(yii::t('sitename','foo bar foo foo bar'), 'description');
Yii::app()->clientScript->registerMetaTag(yii::t('sitename','foo, bar, foo, bar'), 'keywords'); 
```

然后我转到我的命令行，我运行：

```
./yiic message ../app/messages/config.php 
```

我得到：

> 将消息保存到 /Users/user/Sites/sitename.dev/app/messages/en/sitename.php...没有新内容...跳过。

这是我的应用程序消息/`config.php`文件：

```
/**
 * This is the configuration for generating message translations
 * for the Yii framework. It is used by the 'yiic message' command.
 */
return array(
    'language'=>'pt',
    'sourcePath'=>dirname(__FILE__).DIRECTORY_SEPARATOR.'../..',
    'messagePath'=>dirname(__FILE__),
    'languages'=>array('en'),
    'fileTypes'=>array('php'),
    'overwrite'=>true,
    'exclude'=>array(
        '.svn',
        '/app/data/i18n',
        '/htdocs',
        '/app/tests',
        '/app/messages',
        '/app/config',
    ),
); 
```

谁能帮我弄清楚为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:28:37.833

找到了。

信箱**非常**重要。我错误地使用`yii::t();`而不是`Yii::t();`

# javascript - 如何以正确的方式编写此 javascript 代码？

> ID：12731513
> 
> 赞同：0
> 
> 时间：2012-10-04T16:19:20.747
> 
> 标签：javascript

```
var dril1 = (count1[0]*m[1])+(count1[1]*m[2])+(count1[2]*m[3])+(count1[3]*m[4])+(count1[4]*m[5])+(count1[5]*m[6]);
var dril2 = (count2[0]*m[1])+(count2[1]*m[2])+(count2[2]*m[3])+(count2[3]*m[4])+(count2[4]*m[5])+(count2[5]*m[6]);
var dril3 = (count3[0]*m[1])+(count3[1]*m[2])+(count3[2]*m[3])+(count3[3]*m[4])+(count3[4]*m[5])+(count3[5]*m[6]);
var dril4 = (count4[0]*m[1])+(count4[1]*m[2])+(count4[2]*m[3])+(count4[3]*m[4])+(count4[4]*m[5])+(count4[5]*m[6]);
var dril5 = (count5[0]*m[1])+(count5[1]*m[2])+(count5[2]*m[3])+(count5[3]*m[4])+(count5[4]*m[5])+(count5[5]*m[6]);
var dril6 = (count6[0]*m[1])+(count6[1]*m[2])+(count6[2]*m[3])+(count6[3]*m[4])+(count6[4]*m[5])+(count6[5]*m[6]); 
```

还有其他可能的方法来编写这段代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:27:15.980

这个：

```
var counts = [ count1, count2, count3, count4, count5, count6 ]; 
```

接着：

```
var drils = counts.map(function ( count ) {
    return count.reduce(function ( prev, curr, i ) {
        return prev + curr * m[ i + 1 ];
    }, 0 );
}); 
```

`.map()`Array 方法将根据数组返回一个新的结果数组`counts`。`.reduce()`Array 方法会将每个元素缩减`count`为单个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:24:56.183

对于每个练习，您可以执行以下操作：

var dril1 = (count1[0]*m[1])+(count1[1]*m[2])+(count1[2]*m[3])+(count1[3]*m[4]) +(count1[4]*m[5])+(count1[5]*m[6]);

```
var dril1 = 0;
var dril2 = 0;
for (var i=0, len=count1.length; i<len; i++) {
  dril1 += (count1[i]*m[i+1]);
  dril2 += (count2[i]*m[i+1]);
} 
```

但是，如果您将每个计数都视为数组的成员：

```
var dril = [];
for (var i=0, lenI=count.length; i<lenI; i++) {
  dril[i] = 0;
  for (var j=0, lenJ=count[i].length; j<lenJ; j++) {
    dril[i] += (count[i][j]*m[j+1]);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:21:40.947

`count[1...6]`并且`drill[1...6]`实际上应该是它自己的数组。然后，您可以遍历元素并以这种方式进行调用。

```
var drill = []
for(var i = 0; i < count.length; i++){
    drill.push((count[i][0]*m[1]/* rest of the statement */)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:22:28.320

看起来您可以使用二维数组，然后使用双循环？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T16:23:51.143

至少，您可以循环求和：

```
var dril1 = 0, dril2 = 2, ...;
for (i = 0; i < 5; ++i) {
    dril1 += count1[i] * m[i + 1];
    dril2 += count2[i] * m[i + 1];
    . . .
} 
```

`dril1`如果, ...,`dril6`和`count1`, ...`count6`是两个数组，它可以被进一步压缩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T16:24:14.577

您可以重构计算：

```
function calc(count) {
  return count[0] * m[1] + count[1] * m[2] + count[2] * m[3] + count[3] * m[4] + count[4] * m[5] + count[5] * m[6];
}

var dril1 = calc(count1);
var dril2 = calc(count2);
var dril3 = calc(count3);
var dril4 = calc(count4);
var dril5 = calc(count5);
var dril6 = calc(count6); 
```

# c# - 无法访问 asp：代码中的标签 - 需要对象引用

> ID：12731517
> 
> 赞同：-3
> 
> 时间：2012-10-04T16:19:36.930
> 
> 标签：c#, asp.net, label

我不明白。我在我的 aspx 中添加了一个 asp:Label。页：

```
<asp:Label runat="server" Text="" ID="lblStatus"></asp:Label> 
```

然后当我尝试在后面的代码中设置文本时：

```
lblStatus.Text = " test"; 
```

，它给了我这个错误：

```
An object reference is required for the non-static field, method, or property 'Utilities_MoveFileTemplate.lblStatus' 
```

我试图在存储过程运行后在代码隐藏中设置标签的文本：

```
 try
                {
                    conn.Open();
                    cmd.ExecuteNonQuery();

                    lblStatus.Text = "success";
                } 
```

删除了“静态”关键字并且它起作用了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:25:35.953

看起来您正在从静态方法或静态类中调用非静态属性。您将需要创建一个 Form 实例。

# python - 基于名称的字符串分组

> ID：12731526
> 
> 赞同：1
> 
> 时间：2012-10-04T16:20:27.167
> 
> 标签：python, string, string-parsing

我正在尝试自己学习一些python编码，但我遇到了这个问题::

输入文本文件内容::

```
10280341|2012-10-03 19:11:06.390|Sami|abc|Crossword|70
10280343|2012-10-03 19:15:32.173|Sami|aaa|Sudoku|30
10280355|2012-10-04 19:18:32.173|miami|bbb|Chaircar|15
10280366|2012-10-04 19:19:32.173|miami|bob|Avista|35 
```

预期输出::

```
2012-10-03 Sami|2|100
2012-10-04 miami|2|50 
```

我知道这可以通过字符串解析和匹配来完成，但我不知道从哪里开始。任何链接或指针对任何类似问题都非常有帮助。TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:22:22.063

用于[`csv`](http://docs.python.org/library/csv.html)读取文件。用于[`itertools.groupby()`](http://docs.python.org/library/itertools.html#itertools.groupby)在排序后对行进行分组。用于[`sum()`](http://docs.python.org/library/functions.html#sum)通过[生成器表达式](http://www.python.org/dev/peps/pep-0289/)对分组行中的每个值求和。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:44:41.547

您可以`itertools.groupby`按照已经建议的方式使用，或者使用`csv.reader`已经是生成器的对象和 a`collections.defaultdict`来聚合值列...

```
import csv
from collections import defaultdict

summary = defaultdict(list)
csvin = csv.reader(open('testdata.txt'), delimiter='|')
for row in csvin:
    summary[(row[1].split(' ')[0], row[2])].append(int(row[5]))

csvout = csv.writer(open('testdata.out','wb'), delimiter='|')
for who, what in summary.iteritems():
    csvout.writerow( [' '.join(who), len(what), sum(what)] ) 
```

如果您正在查看更复杂的交叉制表/透视等...，那么可能值得一看[pandas](http://pandas.pydata.org/)，这是一个非常有用的库，基于`numpy`

# javascript - 在构造函数中添加事件监听器

> ID：12731528
> 
> 赞同：10
> 
> 时间：2012-10-04T16:20:33.290
> 
> 标签：javascript, events, object, constructor

```
function Foo(elementId, buttonId) {
this.element = document.getElementById(elementId);
this.button = document.getElementById(buttonId);
this.bar = function() {dosomething};
this.button.addEventListener('click', function(e) {this.bar();}, false);
}

var myFoo = new Foo('someElement', 'someButton'); 
```

我想在我的构造函数中添加事件侦听器，但它似乎不起作用。使用正确的语法可以做到这一点吗？我总是挂断电话：

```
this.button.addEventListener('click', function(e) {this.bar();}, false); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T16:23:37.633

您的`this`值在构造函数中发生变化。您可以在选择器中保留引用，并使用该引用。

```
function Foo(elementId, buttonId) {

    /*...*/

    var self = this;
    this.button.addEventListener('click', function(e) {self.bar();}, false);
} 
```

* * *

或者一个不需要变量的更现代的解决方案是使用`Function.prototype.bind`.

```
function Foo(elementId, buttonId) {

    /*...*/

    this.button.addEventListener('click', this.bar.bind(this), false);
} 
```

该`.bind`方法返回一个新`bar`函数，其`this`值绑定到您传递给它的任何值。在这种情况下，它`this`从构造函数绑定到原始数​​据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:23:08.770

`this`在事件处理程序中是事件被添加到的元素。

要访问外部`this`，您需要将其存储在单独的变量中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:23:29.583

`this`在点击处理程序中是按钮元素而不是对象，使用变量来引用对象，比如`var self = this;`

```
function Foo(elementId, buttonId) {
    var self = this;
    this.element = document.getElementById(elementId);
    this.button = document.getElementById(buttonId);
    this.bar = function() {dosomething};
    this.button.addEventListener('click', function(e) {self.bar();}, false);
} 
```

# python - 将 ForeignKey 添加到模型时的迁移问题

> ID：12731534
> 
> 赞同：1
> 
> 时间：2012-10-04T16:20:56.840
> 
> 标签：python, django, foreign-keys, django-south

我目前有一个托管应用程序并拥有用户数据库的网站。现在我想将两者连接起来，这样应用程序就可以拥有作者（即用户）

**更新**：下面添加了更多相关细节，我正在使用 django-registration。

[在此](https://stackoverflow.com/questions/11641052/adding-foreign-key-to-django-model)以及 Django 文档之后，我首先将这`author`一行添加到我的应用程序模型中：

```
from django.contrib.auth.models import User

class App(models.Model):
    name = models.CharField(max_length=200)
    ...
    author = models.ForeignKey(User) 
```

但是，当我从 django admin 访问我的应用程序时，我**在 /admin/apps/app/ 处收到错误 DatabaseError ...没有这样的列：apps_app.author_id**

显然，我需要为这个功能做更多的步骤，但我很好奇为什么这个简单的添加会引发错误。

我正在使用 South 进行迁移并运行

```
./manage.py schemamigration apps --auto 
```

对于一次性值，我将其设置为“零”，因为它期望`int()`

```
./manage.py migrate apps 
```

这没有用，所以我做了

```
./manage.py migrate apps --fake 
```

然后再上一个命令，没有--fake。

另外，根据链接的 SO 问题，我是否也应该`class User(User)`在 apps/models.py 中创建？

**更新 2**我刚刚创建了一个新的 django 应用程序（`.manage.py startapp...`不要与我的“应用程序”对象混淆）。我完成了创建添加此外键的步骤，并且效果很好。我唯一的结论是，这一定是南迁移问题，实际上我的代码没有任何问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:53:40.560

我在本地和舞台上都尝试过，这是我能想到的最佳解决方案。

因为，由于某种原因，South 没有“看到”需要将作者列添加到应用程序表中，所以有一个带有`--add-field`标志的手动模式迁移选项。

我做了：

```
/manage.py schemamigration apps --add-field app.author 
```

然后

```
./manage.py migrate apps 
```

如果最后一个不起作用，请尝试

```
./manage.py migrate apps --fake 000x 
```

`000x`迁移号在哪里。你可以从第一步的输出中得到这个。

然后重新启动，它应该是固定的。我一遍又一遍地这样做，并发现当我最具体地使用 South 时，我获得了最大的成功。我建议每次都指定迁移编号。迁移编号带有特定更改的指示，应直接应用数据库转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:35:06.730

> ./manage.py 迁移应用
> 
> 这没有用，所以我做了

你的意思是它没有工作？你收到什么错误？

对于类似的情况，我通常使用 创建 FK `null=True`，运行此迁移，然后创建数据迁移，这将填充 FK。

> 另外，根据链接的 SO 问题，我是否还应该在 apps/models.py 中创建类用户（用户）？

如果你想将作者链接到 django auth 用户，那么只需从 django.contrib.auth.models 导入它。否则，是的，您需要一个`User`（或更好的`Author`）模型来继承`django.db.models.Model`而不是`User`

# php - PHP SQL``标签神秘出现在数据库中

> ID：12731535
> 
> 赞同：0
> 
> 时间：2012-10-04T16:20:58.383
> 
> 标签：php, sql

我遇到了一个`<br>`在文本区域的文本末尾插入 a 的表单，它会在每次提交时插入一个新的中断。当我再次进入编辑器时，这些中断将是可见的。我插入了以下代码，它似乎可以工作，`<br>`s 不再相乘或出现在编辑器中。

```
 $x = preg_replace("/^<br(\/|)>/i","\n",$x);
 $x = preg_replace("/(^)?(<br\s*\/?>\s*)+$/","\n", $x); 
```

但是，现在它`<br>`在将文本放入 SQL 时会在文本末尾输入两个标签。

我之前关于这个的帖子是[这里](https://stackoverflow.com/questions/12677688/php-form-inserting-br-at-the-end-of-the-text-on-each-submission-to-mssql)。

**编辑以包含表单信息的代码**

```
<?php

include ("main_fns.php"); // This file would include your database access and login     functions, include this at the top of EVERY page, in order to carry the session     between pages and access the database.
open_db(); // Open a database connection

$page_file = "sample.php"; // the file name of this page
$page_title = "Course Admin Area"; // can be fed into the header

include ("header.php");

// Check for logged in session variable, else prompt for login.
if (!@$_SESSION["email"]) {
loginPrompt(@$_POST["email"],$_SESSION["error"]);
} else {

// PAGE CONTENT GOES HERE

function fromhtml ($x) {
$x = preg_replace("/<p>/i","\n\n",$x);
$x = preg_replace("/^<br(\/|)>/i","\n",$x);
$x = preg_replace("/<li>/i","\n<li>",$x);
$x= preg_replace("/(^)?(<br\s*\/?>\s*)+$/","\n", $x); 
return $x;
}

$DBhost = "localhost";
$DBuser = "daccweb";
$DBpass = "go";
$DBName = "DACC";
mssql_connect($DBhost,$DBuser,$DBpass) or die("Unable to connect to database");
@mssql_select_db("$DBName") or die("Unable to select database $DBName");

$PHP_SELF = $_SERVER['PHP_SELF'];

$course_id = @$_GET["course"];

if ($course_id == "") {
//$sqlquery = "SELECT id,title,goals,outline,reference,DATE_FORMAT(updated, '%Y/%m/%d %H:%i:%S') as         updated2 FROM courses WHERE division_id = '$division_id' ORDER BY id";
$sqlquery = "SELECT id, title, goals, outline, reference, deliverymode, updated2 = CONVERT(VARCHAR(19),     updated, 120)
FROM courses WHERE division_id = '$division_id' ORDER by id";

$result = mssql_query($sqlquery);
$number = mssql_num_rows($result);

if ($number == 0) {
        print "<html><body>";
        print "No courses exist for division $division_id.";
        print "</body></html>";
    exit;
}

print "<b>Course list - division $division_id</b><p>\n";
print "Select a course ID to edit course information.<p>\n";
print "<table border=1 id=\"content_table\"><tr><th>ID</th><th>Title</th><th>Status</th><th>Last modified</th></tr>\n";

$i = 0;
while ($number > $i) {

        $course_id =  mssql_result($result,$i,"id");
    $reference = mssql_result($result,$i,"reference");
    $updated = mssql_result($result,$i,"updated2");

    print "<tr><td>";
    if ($reference == "") {
            print "<a href=$PHP_SELF?division=$division_id&course=$course_id>$course_id</a>";
    } else {
            print "$course_id";
    }
    print "</td><td>";
        print mssql_result($result,$i,"title");
    print "</td><td>";
    if ($reference == "") {
        if ( (mssql_result($result,$i,"goals")=="") and (mssql_result($result,$i,"outline")=="")     ) {
            print "<b>No syllabus, or incomplete</b></td>";
        }
    } else {
        print "Based on $reference";
    }
    print "</td><td>$updated</td>\n";
        print "</tr>\n";  
        $i++;
}

print "</table>";

    exit;
}

$sqlquery = "SELECT * FROM courses WHERE id = '$course_id'";

$result = mssql_query($sqlquery);
$number = mssql_num_rows($result);

if ($number == 0) {
print "<html><body>";
print "No course with the ID \"$course_id\" exists in the course database.";
print "</body></html>";
exit;
}

$i = 0;
$title = fromhtml(mssql_result($result,$i,"title"));
$iai = fromhtml(mssql_result($result,$i,"iai"));
$deliverymode = fromhtml(mssql_result($result,$i,"deliverymode"));
$hours = fromhtml(mssql_result($result,$i,"hours"));
$type = fromhtml(mssql_result($result,$i,"type"));
$description = fromhtml(mssql_result($result,$i,"description"));
$semester = fromhtml(mssql_result($result,$i,"semester"));
$prerequisites =fromhtml(mssql_result($result,$i,"prerequisites"));
$notes = fromhtml(mssql_result($result,$i,"notes"));
$goals = fromhtml(mssql_result($result,$i,"goals"));
$outline = fromhtml(mssql_result($result,$i,"outline"));
$materials = fromhtml(mssql_result($result,$i,"materials"));
$evaluation = fromhtml(mssql_result($result,$i,"evaluation"));
$bibliography = fromhtml(mssql_result($result,$i,"bibliography"));
$revised = mssql_result($result,$i,"revised");

print "<html><head><title>DACC Course Syllabus - $course_id</title>";

print "<script language=\"JavaScript\" type=\"text/javascript\" src=\"/rte/richtext2.js\"></script>";
?>

<script language="JavaScript" type="text/javascript">
<!--    
initRTE("/rte/images/", "/rte/", "");
//-->   

function submitForm() {
   updateRTEs();
   document.edit-course.submit();
   return false;
}

</script>

<?php   

print "</head><body>\n";

print "<a href=/courses/$division_id>Back to the $division_id course list</a>"; 
```

# gcc - 为什么malloc时gcc中的分段错误？

> ID：12731537
> 
> 赞同：1
> 
> 时间：2012-10-04T16:21:05.773
> 
> 标签：gcc, gdb, segmentation-fault, malloc

我写了一段代码来实现哈希函数。将第 9 个元素“a12a”添加到列表时出现问题，gdb 报告如下，似乎问题是在 malloc 应用内存期间发生的。但是在添加第9个元素之前，我曾经在添加第6个元素“ad”时通过malloc成功申请了一次内存，为什么第二次申请内存失败？

```
Breakpoint 1, insert (p=0x3d2d10, value=0x4030e8 "a12a") at hashop.c:39
39              id = hash(value);
(gdb) n
40              *current = p + id;
(gdb)
41              if((*current)->value == NULL) {
(gdb)
44                      if((lookup(p+id, value)) == NULL) {
(gdb)
45                              new = (nList *)malloc(sizeof(nList));
(gdb)

Program received signal SIGSEGV, Segmentation fault.
0x7c938996 in ntdll!RtlDuplicateUnicodeString ()
   from C:\WINDOWS\system32\ntdll.dll
(gdb) 
```

我的代码是：

```
void insert(nList *p, char *value)
{
    nList *new, **current;
    int id;

    id = hash(value);
    *current = p + id;
    if((*current)->value == NULL) {
        (*current)->value = value;
    } else {
        if((lookup(p+id, value)) == NULL) {
            new = (nList *)malloc(sizeof(nList));
            new->value = value;
            new->next = NULL;       
            while((*current)->next != NULL) {
                (*current) =(*current)->next;
            }
            (*current)->next = new;
        }
    }
}   

static char *str2[] = {"ac", "ba", "abv", "bc", "bx", "ad", "xx", "aaa", "a12a", "b123"}; 
```

每个元素的hash id如下：

```
ac, HashId=6
ba, HashId=5
abv, HashId=3
bc, HashId=7
bx, HashId=8
ad, HashId=7
xx, HashId=0
aaa, HashId=1
a12a, HashId=3
b123, HashId=8 
```

从上面的列表中，可以确定“bc”和“ad”具有相同的哈希 id，所以在我的 insert() 函数中，我将应用一块内存来存储“ad”。“abv”和“a12a”也是一样，我也申请了一块内存，但这次失败了。为什么？任何人都可以弄清楚吗？赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T18:25:48.597

您正在使用此行破坏内存：

```
*current = p + id; 
```

传递`-Wall`给 gcc 以打开所有警告，您将看到：

```
buggy-hash.c: In function ‘insert’:
buggy-hash.c:19:14: warning: ‘current’ is used uninitialized in this function [-Wuninitialized] 
```

提示：在 Linux 下的[Valgrind 之](http://valgrind.org/)`gcc -Wall`类的内存调试器下使用和运行您的程序会*更*容易发现这些内存问题。

 *我猜你是通过在 Windows 下使用 CodeBlocks 或其他 IDE 来学习 C 编程的？在 Visual Studio 中以调试模式构建程序也会发现这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T01:18:18.763

The problem is I have used p+id as the input of lookup function but forgot the p is already changed by *current. so the correct code is:

```
void insert(nList *p, char *value)
{
    nList *new, **current = &p;
    int id;
    id = hash(value);
    *current += id;

    if((*current)->value == NULL) {
        (*current)->value = value;
    } else {
        if((lookup(*current, value)) == NULL) {
            new = (nList *)malloc(sizeof(nList));

            if(new == NULL)
                printf("\nCannot get memory");
            else {
                new->value = value;
                new->next = NULL;       

                while((*current)->next != NULL) {
                    (*current) =(*current)->next;
                }

                (*current)->next = new;
            }
        }
    }
} 
```*

# testng - testNG：如何在@AfterMethod 或侦听器中捕获测试用例的返回值？

> ID：12731541
> 
> 赞同：1
> 
> 时间：2012-10-04T16:21:17.040
> 
> 标签：testng

只是为了设置上下文，我的测试用例创建了一些数据，我想在拆解时删除这些数据。我想以检查返回值（及其类型，主要是域对象）并清理数据（如下所示）的方式实现通用拆卸过程（通过 AfterMethod/AfterClass/Listener）。

```
public class SampleTest {

@AfterMethod
public void teardown(Object returnValueFromTest){
    //inspect returnValueFromTest and perform necessary clean up.
}

@Test
public String testEventGeneration(){
    //generate event

    //returning generated event id.
    return "E1234";
}

@Test
public Market testMarketGeneration(){
    //generate market

    //returning generated market.
    return someMarket;
}} 
```

关于如何在 testNG 中实现这一点的任何想法/想法？我也考虑过实现像 IHookable 这样的监听器，但找不到可以帮助我获取返回值的监听器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:16:18.570

你可以简单地处理这个，如果你想在所有测试执行后结束所有事情，你必须使用@AfterClass注解而不是@AfterMethod注解。@AfterMethod 注解在测试类中的每个测试方法之后触发。

流动的代码将简单地完成您的任务。如果您想在侦听器级别实现这一点，您可以实现**ITestListener**和 onFinish 方法，您可以实现您的逻辑。

公共类 SampleTest { 私有字符串 event_id = null;

```
@AfterClass(alwaysRun = true)
public void teardown(){
    //delete event from the db(event_id) 

}

@Test
public void testEventGeneration(){
    //generate event

    //returning generated event id.
    event_Id= "E1234";
}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T19:25:44.460

你考虑过使用 InvokedMethodListener2 吗？

```
public Class BaseTestNg {

    ITestContext ctx;

    public ITestContext getContext(){
        return this.ctx;
    }

    @BeforeClass
    public void setContext( final ITestContext ctx ) {
        this.ctx = ctx;
    }
}

public Class SampleTest extends BaseTestNg {

    @Test
    public Market testMarketGeneration(){
        //generate market
        this.getContext().setAttribute("market", someMarket);
        //returning generated market.
        return someMarket;
    }
}

import org.testng.IInvokedMethod;
import org.testng.IInvokedMethodListener2;
import org.testng.ITestContext;
import org.testng.ITestResult;

public class InvokedMethodListener2Impl implements IInvokedMethodListener2 {

    @Override
    public void afterInvocation( final IInvokedMethod method, final ITestResult testResult ) {
        // TODO Auto-generated method stub

    }

    @Override
    public void afterInvocation( final IInvokedMethod method, final ITestResult testResult, final ITestContext context ) {

        //read object from context
        //Market = (Market) context.getAttribute("market");

        // testResult.setStatus( ITestResult.FAILURE );

    }

    @Override
    public void beforeInvocation( final IInvokedMethod method, final ITestResult testResult ) {
        // TODO Auto-generated method stub

    }

    @Override
    public void beforeInvocation( final IInvokedMethod method, final ITestResult testResult, final ITestContext context ) {
        // TODO Auto-generated method stub

    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-05T12:32:33.647

如果有与它们关联的返回值，AFAIK Testng 甚至不会执行注释为 Test 的方法。

因此，如果您想根据设置的值进行拆解，那么您需要在全局上下文或外部设置这些值，而不是作为返回值。您可以根据您想要拆卸的时间将拆卸逻辑编写为侦听器或任何 After 方法。

# sql - SQL Server 批量插入的优点/缺点是什么？

> ID：12731545
> 
> 赞同：2
> 
> 时间：2012-10-04T16:21:26.053
> 
> 标签：sql, sql-server-2008

SQL Server 批量插入的优点/缺点是什么？

应用程序处理数据时与常规单行插入相比的优点/缺点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:23:55.677

我认为批量插入的基本目的是允许在导入大量数据时暂停键/约束，这比传统的逐记录/编程插入要快得多。不确定是否存在“缺点”，除非您尝试在并非真正设计/意图的情况下使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-27T05:42:23.133

BCP 用于 sql server 中的 BULK 数据加载。下面列出了几个优点。

1.  BCP交易比其他方式快得多
2.  我们可以使用 BCP 命令迁移固定长度的文件，逗号分隔的文件。
3.  BCP 可以从 .Net 代码中用于数据迁移。

# php - 可以绕过 file_get_contents 参数的附加文件后缀吗？

> ID：12731547
> 
> 赞同：2
> 
> 时间：2012-10-04T16:21:33.433
> 
> 标签：php, security, code-injection

考虑以下代码

```
<?php
// warning: this code is unsafe and for demonstrational purposes only,
// do not use in a production environment
$filename = $_GET['filename']; 
$extension = 'txt';
$path = '/absolute/path';
$fullFilename = sprintf('%s/%s.%s', $path, $filename, $extension);
echo file_get_contents($fullFilename); 
```

我们都知道（至少我希望如此）预先设置绝对路径绝不是防止离开给定路径的充分方法——人们可以简单地`../`在查询字符串中插入一个或多个 " " 以到达文件上的任何路径系统。

**我的问题是：与给定的示例类似，`$_GET['filename']`也可以通过绕过给定扩展后缀的方式进行操作**，即回显 .txt 以外的文件？我特别想到了某些控制字符，它们`../`以与前缀相同的方式绕过附加的文件扩展名。

我尝试在查询字符串中添加一些控制字符（例如用于删除的 ASCII 代码 127）或使用`&&`,`|`或连接两个文件名`>`，但都无济于事，我想知道是否存在这种可能性。

（顺便说一句，我想补充一点，这个问题并不是为了利用系统而提出的。这纯粹是我最近想到的一个假设性问题。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:26:01.533

当然，`nullbyte`, `\0`（或者`%00`如果您想在查询字符串中进行测试）将`file_get_contents()`在遇到该字符串时停止处理该字符串。

因此，如果`$_GET['filename']`是`../../../../../etc/passwd%00`（例如`your_page.php?filename=../../../../etc/passwd%00`），`file_get_contents()`将永远不会看到结尾`.txt`（它会看到它，但不会处理它）。

可悲的是，`sprintf`在构建字符串时不会剥离 nullbyte。我不确定其他控制字符，但如果有的话 - 我总是建议剥离空字节。但是，更直观的方法是建立允许字符的白名单`preg_match()`并对输入执行 a。

在那个上一个，您可以[`realpath()`](http://php.net/realpath)在构建的字符串上使用 PHP，它将确定真正被访问的完整路径。所以，`/absolute/path/../../../../etc/passwd\0.txt`传递给`realpath()`将返回`/etc/passwd`。然后，您可以对返回的值进行进一步验证（例如，扩展是否仍然存在`.txt`或是否在指定/必需的目录中）。

# c# - 解析看似正确的时间跨度时抛出异常

> ID：12731559
> 
> 赞同：0
> 
> 时间：2012-10-04T16:22:24.170
> 
> 标签：c#, parsing, timespan

我正在使用该`TimeSpan.ParseExact`方法来解析时间跨度。但是，为什么以下失败并抛出异常？

```
string time = "23:10:00";
string format = "HH:mm:ss";
TimeSpan timeSpan = TimeSpan.ParseExact(time, format, CultureInfo.InvariantCulture); 
```

从 MSDN 上的[Custom Date and Time Format Strings](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)文章来看，这个输入字符串的格式是正确的。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:24:54.097

您链接到自定义`DateTime`格式说明符 - 但您不是解析为`DateTime`，而是解析为`TimeSpan`，因此您需要[自定义`TimeSpan`格式说明符](http://msdn.microsoft.com/en-us/library/ee372287.aspx)- 这意味着使用“hh”而不是“HH”。此外，根据文档，您需要转义冒号 - 所以您真的想要：

```
string format = @"hh\:mm\:ss"; 
```

我已经验证这适用于您的样本值。

# php - 唯一的 MySQL 错误消息

> ID：12731564
> 
> 赞同：0
> 
> 时间：2012-10-04T16:22:35.610
> 
> 标签：php, mysql

我从我的脚本中收到一条非常明显的错误消息，但我知道我的详细信息是正确的，并且我有来自此 Web 服务 (000webhost.net) 的授权请求。显然，网络上的其他人没有收到此错误，并且在收到此消息 3 天后，我感到非常沮丧！有谁知道如何通过我的提供商解决它：

> 用户“a3040562_kputts”@“10.1.1.18”拒绝访问数据库“ireport”

此外，这是一段示例代码，以防其他人认为我输入了错误的信息：

```
// Make a MySQL Connection
mysql_connect("mysql4.000webhost.com", "a3040562_kputts", "(censored)") or     die(mysql_error());
mysql_select_db("ireport") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:24:54.590

您已成功连接到数据库服务器，但您的用户没有使用该特定数据库所需的 MySQL 权限。`GRANT`您将需要以特权用户（或`GRANT OPTION`对该数据库具有权限的用户）执行查询。

要允许该用户使用数据库（但不一定是任何表）：

```
GRANT USAGE ON ireport.* TO 'a3040562_kputts'@'10.1.1.18'; 
```

要允许此用户对该数据库中的所有对象具有完全权限：

```
GRANT ALL ON ireport.* TO 'a3040562_kputts'@'10.1.1.18'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:26:22.907

a3040562_kputts 是您的帐户吗（如，没有人分享）？如果其他人也使用它，他们是否从不同的位置访问数据库？当用户帐户没有访问数据库的正确权限时，通常会出现此错误。

您将需要具有更高访问权限的人来检查权限表，以确保该帐户可以访问该表。如果帐户可以但您仍然被拒绝，请让他们再次检查“主机”字段（该字段控制请求可能来自哪里，有时它默认为“本地主机”，因此只有服务器可以访问自己，我相信如果您对主机“*”有权限，您可以在任何地方使用它）。

# javascript - 我用来重定向主页的脚本没有按我需要的方式工作

> ID：12731576
> 
> 赞同：1
> 
> 时间：2012-10-04T16:23:18.053
> 
> 标签：javascript, jquery, redirect, tumblr

我正在使用下面的代码将我的 Tumblr 主页重定向到我的最新帖子。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>
$(document).ready(function() {
   $.getJSON('http://mydomain.tumblr.com/api/read/json?callback=?', function(result) {
      window.location.href = result.posts[0].url;
   });
});
</script> 
```

我有两个问题。首先，它不会立即重定向，它会加载我的主页，然后更改 URL，即使我已将其放在我的`<head>`标签上方。然后，当它确实重定向时，它每隔几秒钟就会开始刷新一次。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:27:54.777

它等待的原因是因为您放置的任何代码都会`$(document).ready`等待文档在执行之前先加载。

对于令人耳目一新的部分，我猜您的页面中包含最新帖子的相同代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:40:01.773

它在您加载页面后重定向，因为代码在`$(document).ready(function(){ ...});` 页面加载后执行。为避免重定向后刷新，请尝试以下操作：

```
if(window.location.href !== result.posts[0].url) {
   window.location.href = result.posts[0].url;
} 
```

# java - 如何绘制扩展 MouseInputAdapter 的侦听器？

> ID：12731584
> 
> 赞同：1
> 
> 时间：2012-10-04T16:24:02.897
> 
> 标签：java, swing, animation, jpanel, paintcomponent

我正在尝试使用一个扩展`MouseInputAdapter`来绘制自由形状的类，稍后我可能会制作一个动画对象。

我已经看到了一些答案，但他们正在使用`addMouseMotionListener(this)`，据我所知，你不能用一个对象来做。我的主要问题实际上是画一些东西。我可能缺少一些基本的东西，比如在哪里初始化我的`JPanel`或在动画方法中添加我的监听器。`nullPointerException`每次我假设它重新粉刷时，我都会得到 s。无论是那个还是每次 mouseDragged 激活。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.MouseInputAdapter;
import java.util.*;

public class test {

    JFrame frame = new JFrame("Bouncing Vertices");
    MyDrawPanel drawPanel = new MyDrawPanel();
    private int delay = 5;
    public int z = 0;
    public int a = 0;
    public static int counter = 0;
    public static int[] xs;
    public static int[] ys;
    public static boolean isDone = false;

    public void animate() {
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().add(drawPanel);
        frame.setSize(800, 600);
        frame.setVisible(true);
        MyListener alpha = new MyListener();
        drawPanel.addMouseMotionListener(alpha);
        drawPanel.addMouseListener(alpha);
        while (true) {
            drawPanel.repaint();
            try {
                Thread.sleep(delay);
            } catch (Exception ex) {
            }
        }
    }

    private class MyListener extends MouseInputAdapter {

        public void mouseDragged(MouseEvent arg0) {
            int x = arg0.getX();
            int y = arg0.getY();

            if (x != z || y != a) {
                xs[counter] = x;
                ys[counter] = y;
                z = x;
                a = y;
                counter++;
            }

        }

        public void mouseReleased(MouseEvent arg0) {
            isDone = true;
        }
    }

    public static int[] getXs() {
        return xs;
    }

    public static int[] getYs() {
        return ys;
    }

    public static boolean getBoolean() {
        return isDone;
    }

    public static void setBoolean() {
        isDone = false;
    }

    public static void setArrays() {
        for (int i = 0; i < ys.length; i++) {

            xs[counter] = 0;
            ys[counter] = 0;
        }
    }

    public static void main(String[] args) {
        test qwerty = new test();
        qwerty.animate();
    }
}

class MyDrawPanel extends JPanel {

    public void paintComponent(Graphics g) {
        g.setColor(Color.GRAY);
        g.fillRect(0, 0, this.getWidth(), this.getHeight());
        if (test.getBoolean() && test.getXs().length > 0) {
            g.setColor(Color.BLACK);
            g.drawPolyline(test.getXs(), test.getYs(), test.getYs().length);
            test.setBoolean();
            test.setArrays();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T16:46:16.143

我添加了对 Swing 实用程序的调用，以确保 Swing 组件位于事件分派线程上。

我重新排列了您的代码，以便您可以使您的侦听器和绘图面板分开类。为此，我将主类的一个实例传递给侦听器和绘图类。

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Point;
import java.awt.event.MouseEvent;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import javax.swing.event.MouseInputAdapter;

public class DrawingTest implements Runnable {

    private JFrame frame;

    private MyDrawPanel drawPanel;

    private List<Point> points;

    public DrawingTest() {
        points = new ArrayList<Point>();
    }

    @Override
    public void run() {
        frame = new JFrame("Bouncing Vertices");

        drawPanel = new MyDrawPanel(this);
        MyListener alpha = new MyListener(this);
        drawPanel.addMouseMotionListener(alpha);
        drawPanel.addMouseListener(alpha);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().add(drawPanel);
        frame.setSize(800, 600);
        frame.setVisible(true);
    }

    public JPanel getDrawingPanel() {
        return drawPanel;
    }

    public List<Point> getPoints() {
        return points;
    }

    public void setPoint(int x, int y) {
        points.add(new Point(x, y));
    }

    public void resetPoints() {
        points.clear();
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new DrawingTest());
    }

    private class MyListener extends MouseInputAdapter {

        private DrawingTest drawingTest;

        public MyListener(DrawingTest drawingTest) {
            this.drawingTest = drawingTest;
        }

        @Override
        public void mouseDragged(MouseEvent event) {
           drawingTest.setPoint(event.getX(), event.getY());
           drawingTest.getDrawingPanel().repaint();
        }

        @Override
        public void mouseReleased(MouseEvent event) {
            drawingTest.resetPoints();
        }

    }

}

class MyDrawPanel extends JPanel {

    private DrawingTest drawingTest;

    public MyDrawPanel(DrawingTest drawingTest) {
        this.drawingTest = drawingTest;
    }

    @Override
    public void paintComponent(Graphics g) {
        g.setColor(Color.WHITE);
        g.fillRect(0, 0, this.getWidth(), this.getHeight());
        g.setColor(Color.BLUE);
        for (int i = 1; i < drawingTest.getPoints().size(); i++) {
            Point p1 = drawingTest.getPoints().get(i - 1);
            Point p2 = drawingTest.getPoints().get(i);
            g.drawLine(p1.x, p1.y, p2.x, p2.y);
        }
    }
} 
```

# asp.net-mvc - 通过 HttpClient 将文件发送到 ASP.NET MVC 控制器获取奇怪的名称 (=?utf-8?B?U...)

> ID：12731585
> 
> 赞同：2
> 
> 时间：2012-10-04T16:24:04.087
> 
> 标签：asp.net-mvc, file-upload, httpclient

当文件名有特殊字符时，我会在 Request.Files[0].FileName 上收到一个奇怪的文件名。像“=？utf-8？B？U ...”之类的东西

要发送我正在做的文件：

```
ProgressMessageHandler progress = new ProgressMessageHandler();
progress.HttpSendProgress += OnHttpSendProgress;

HttpClient client = HttpClientFactory.Create(progress);
client.DefaultRequestHeaders.TransferEncodingChunked = true;

MultipartFormDataContent content = new MultipartFormDataContent();
var fileContent = new StreamContent(new FileStream(fileInfo.FullName, FileMode.Open));
content.Add(fileContent, "file", fileInfo.Name);

HttpRequestMessage message = new HttpRequestMessage();
message.Method = HttpMethod.Post;
message.Content = content;
message.RequestUri = uri;

var resultado = await client.SendAsync(message, CancellationToken); 
```

我究竟做错了什么？

我正在使用 WebClient 一段时间：

```
WebClient client = new WebClient();
client.UploadProgressChanged += OnHttpSendProgress;
await client.UploadFileTaskAsync(uriBuilder.Uri, "POST", fileInfo.FullName); 
```

# android - 使用 DoubleTwist 和 VideoView 进行视频流式传输

> ID：12731586
> 
> 赞同：0
> 
> 时间：2012-10-04T16:24:12.487
> 
> 标签：android

我尝试使用失败的视频视图流式传输 mp4 视频。但是，使用 DoubleTwist 它可以工作。我想在我的应用程序中嵌入我的自定义播放器，而使用外部播放器并不是一个真正的选择。我怎样才能做到这一点 ？你认为可能是什么问题？

亲切的问候，

# paypal - Magento 1.7.2 订单处理问题

> ID：12731590
> 
> 赞同：2
> 
> 时间：2012-10-04T16:24:16.047
> 
> 标签：paypal, magento-1.7, magento

我希望大家能提供帮助，我在 Magento 论坛上运气不佳。我的问题与我最近在 Magento 商店进行的移动/升级有关。

我的旧服务器上运行 1.7.0 的站点运行时没有任何订单和 Paypal 问题。不过最近，我搬到了一个新服务器，所以当我搬家的时候，我想我会升级网站。现在无论出于何种原因（在与 Paypal 高级设置搏斗之后），我可以为客户的订单付款，但我无法为订单开具发票并从系统中运出。出于显而易见的原因，这是一个大问题。我在搬家中错过了什么吗？它只是给了我“无法保存发票”。错误。看起来这不是一个不寻常的问题，但我发现的所有问题都处理的是旧版本，最重要的是，引用了一个我似乎没有的日志文件（var/log 下的 execptions.log）。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-05T02:17:27.880

对于将来遇到类似问题的人：

带有 Paypal Advanced 的 Magento 1.7.2 当我从 1.7.0 升级到 1.7.2 并移动服务器时，我必须执行以下操作。

1.  Paypal：在付款选项下禁用 SSL 验证（这会破坏与 PayPal 的通信。
2.  重复发票问题：（也可能适用于销售订单和运输）--> 在数据库中查找表 eav_entity_type 和 eav_entity_store --> 使用 eav_entity_type，确定您需要的 entity_model 的 entity_type_store（sales/order、sales/order_invoice、sales/ order_creditmemo, sales/order_shipment) 然后你可以进入 entity_type_store 并将 entity_type_id 与最后一个 increment_last_id 交叉。如果您在管理部分的最后一张发票是 100000070，则设置相应的 entity_type_id col，increment_last_id = 100000070。

这对我来说很完美，但我不知道在哪里启用日志记录，感谢 Cags 的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T17:10:57.017

这是Magento CE 1.6 和 1.7 中引入的一个已知[错误。](http://www.magentocommerce.com/bug-tracking/issue/?issue=13071)如需解决方案，请转到 app/code/core/Mage/Sales/Model/Resource/Quote.php 并更改：

```
$bind      = array(':increment_id' => (int)$orderIncrementId); 
```

至：

```
$bind      = array(':increment_id' => $orderIncrementId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-01T11:45:22.187

我发现 M2e 与操纵发票号码的 Fooman:SameOrderInvoiceNumber 扩展发生冲突

需要禁用 Fooman 扩展，或者修改它的代码 [http://www.masterdef.net/blog/magento-m2e-error-invoice-was-not-created-reason-sqlstate23000-integrity-constraint-violation-1062-重复条目 2300011342-for-key-unq_sales_flat_invoice_increment_id/#more-65](http://www.masterdef.net/blog/magento-m2e-error-invoice-was-not-created-reason-sqlstate23000-integrity-constraint-violation-1062-duplicate-entry-2300011342-for-key-unq_sales_flat_invoice_increment_id/#more-65)

# linux - bash 中的文件解析。分隔不同的子部分

> ID：12731592
> 
> 赞同：1
> 
> 时间：2012-10-04T16:24:19.957
> 
> 标签：linux, bash

> **可能重复：**
> [bash，解析文件的一部分](https://stackoverflow.com/questions/12723575/bash-parsing-part-of-a-file)

```
Case 4
case 4.1
a 3
a 5
a 7
a 1
a 9
a 4
endcase 4.1
//
.
.
. Do things that don't get parsed
.
.
//
case 4.2 
a 1
b 3
a 6
b7 
endcase 4.2
endcase 4 
//
.
.
.
. More things
.
.
// 
case 5
.
.
.
.
endcase 5 
```

考虑上面的示例文件。命令 awk '/^case 4.2/,/^endcase 4.2/' ./my_file.txt

将从文件中仅提取所需部分中包含的信息。那么，我将如何从这个较小的部分中仅提取以“a”开头的行？我的文件比示例复杂一些，但我认为逻辑仍然适用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:27:01.740

你可以用 sed 做到这一点：

```
sed -n -e '/^case 4[.]2/,/^endcase 4[.]2/ { /^a/p }' my_file.txt 
```

`-n`告诉 sed 只打印我们告诉它的行。花括号是一组命令，通过使用的地址前缀（与您在 awk 中使用的相同），我们保证它们仅在 case 块中执行。该组仅包含一个命令，即“p”打印命令。但是，我们在这个命令前加上另一个地址前缀。这个告诉它只有在行以“a”开头时才执行。

通过嵌套地址，我们可以执行“case 4.2”和“endcase 4.2”行之间的命令，**并且**以“a”文本开头。

希望这会有所帮助=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:33:34.167

使用 awk，我认为这可能有效，但它没有

```
awk '/^case 4.2/,/^endcase 4.2/ && /^a/' filename 
```

相反，这有效：

```
awk '/^case 4.2/,/^endcase 4.2/ {if (/^a/) print}' filename 
```

# objective-c - 在 UIScrollview 中放置视图

> ID：12731593
> 
> 赞同：0
> 
> 时间：2012-10-04T16:24:25.453
> 
> 标签：objective-c, ios, gridview, uiview

这就是我想要实现的。

```
|------------------------------------------------------|
|                     view 1 here                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                       view 2 here                    |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                    view 3 here                       |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
|                                                      |
| -----------------------------------------------------| 
```

我想要一个包含 3 个视图的滚动视图。我正在做以下事情。

```
-(void)viewDidLoad
{
    keeperView = [[UIView alloc] init];
    aanvallerView = [[UIView alloc] init];
    middenvelderView = [[UIView alloc] init];
    listView.contentSize=CGSizeMake(1280,2360);
    [listView addSubview:keeperView];
    [listView addSubview:aanvallerView];
    [listView addSubview:middenvelderView];
} 
```

但它只显示一种观点。有谁知道问题是什么？

提前致以亲切的问候和感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:28:25.963

可能是他们没有框架。致电`initWithFrame`：在`UIViews`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T17:18:59.863

在你看来DidLoadMethod：

```
UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, self.view.frame.size.height)];
[scrollView setContentSize:CGSizeMake(320, 1100)];
[scrollView setScrollEnabled:YES];
[self.view addSubview:scrollView];

UIView *view1 = [[UIView alloc] initWithFrame:CGRectMake(0, 50, 320, 300)];
[view1 setBackgroundColor:[UIColor redColor]];
[scrollView addSubview:view1];

UIView *view2 = [[UIView alloc] initWithFrame:CGRectMake(0, 400, 320, 300)];
[view2 setBackgroundColor:[UIColor blueColor]];
[scrollView addSubview:view2];

UIView *view3 = [[UIView alloc] initWithFrame:CGRectMake(0, 750, 320, 300)];
[view3 setBackgroundColor:[UIColor yellowColor]];
[scrollView addSubview:view3]; 
```

结果：

![不同的观点](../Images/1b71991bad978dec9de06a7402248643.png)

![不同的观点 2](../Images/cb70b1b6cbd7aa47748b067a8b861c3a.png)

![不同的观点 3](../Images/45cb1e0641465b9f0c7408c2834a3a2c.png)

所有 3 个视图都在 Scrollview 上！:)

通过使用 addSubview，您现在可以将所有您想要的东西放在视图上；）您甚至可以使用滚动视图制作另一个滚动视图 ^^

# java - 有没有更有效的多项式相乘方法？

> ID：12731595
> 
> 赞同：2
> 
> 时间：2012-10-04T16:24:37.227
> 
> 标签：java, polynomial-math

这是我将形式的两个多项式相乘的方法`an*x^n + an-1*x^n-1 + ... + a1*x + a0`。每个`Term`对象都有两个字段：`double coefficient`和`int power`。`Polynomial`通过将项存储在 中来表示多项式`ArrayList<Term>`。乘法的当前实现是 O(n^2)。关于如何使其更快的任何想法或提示？

```
public Polynomial multiply(Polynomial P2) {
    PolynomialImp result = new PolynomialImp();
    for (Term currentThisTerm : this.terms)
    {
        for (Term currentP2Term : ((PolynomialImp) P2).terms)
        {
            result.addTerm(new TermImp(currentThisTerm.getCoefficient()*currentP2Term.getCoefficient(), currentThisTerm.getExponent() + currentP2Term.getExponent()));
        }
    }
    //Sort polynomial in decreasing exponent order
    return result.sort();
} 
```

如果需要，下面是 addTerm 方法：

```
private void addTerm(Term nextTerm)
{
    for (int i = 0; i < this.terms.size(); i++)
    {
        if (this.terms.get(i).getExponent() == nextTerm.getExponent())
        {
            //Add the coefficients if the current term has the same exponent as a term that is already in the polynomial.
            //This preserves the sorting of the polynomial except during multiply.
            this.terms.set(i, new TermImp(this.terms.get(i).getCoefficient() + nextTerm.getCoefficient(), this.terms.get(i).getExponent()));
            return;
        }
    }
    //Avoid adding zeros to the polynomial.
    if (nextTerm.getCoefficient() != 0)
        this.terms.add(nextTerm);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:39:16.817

这就是我可能实现此功能的方式

```
public class Polynomial {
    private final double[] coeff;

    public Polynomial(double... coeff) {
        this.coeff = coeff;
    }

    @Override
    public String toString() {
        return Arrays.toString(coeff);
    }

    public Polynomial multiply(Polynomial polynomial) {
        int totalLength = coeff.length + polynomial.coeff.length - 1;
        double[] result = new double[totalLength];
        for (int i = 0; i < coeff.length; i++)
            for (int j = 0; j < polynomial.coeff.length; j++) {
                result[i + j] += coeff[i] * polynomial.coeff[j];
            }
        return new Polynomial(result);
    }

    public static void main(String... args) {
        Polynomial p1 = new Polynomial(1, 2, 3);
        System.out.println(p1 + "^2 =" + p1.multiply(p1));
        Polynomial p2 = new Polynomial(3, -1, -1);
        System.out.println(p1 + "*" + p2 + "=" + p1.multiply(p2));
    }
} 
```

印刷

```
[1.0, 2.0, 3.0]^2 =[1.0, 4.0, 10.0, 12.0, 9.0]
[1.0, 2.0, 3.0]*[3.0, -1.0, -1.0]=[3.0, 5.0, 6.0, -5.0, -3.0] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:48:29.447

可能使该算法变慢的原因是创建了 n^2 个 TermImp 对象。在 C++ 中，这应该不是问题，因为您将在堆栈上创建对象并按值传递。我的理解是，在 Java 中你没有这个选项：你必须接受创建对象的开销，然后通过引用传递。

每次乘以一个术语时都创建一个新对象似乎效率低下。不能直接消除吗？

您可以考虑更改 addTerm 方法以接受系数和指数作为双精度/整数参数。

对于大的 n，该算法仍然是 O(n^2)，但它仍然应该加快很多。

您可以考虑的另一件事是使用 for 循环而不是迭代器，因为迭代器还涉及创建新对象……尽管 O(n) 不是那么重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:33:49.953

您有一个主要的低效率：您将术语存储在看似无序列的列表中。您应该修改您的代码，以便 terms.get(n) 返回带有 x^n 的术语。然后，您无需在 addTerm 方法中搜索 terms 变量。

为此，您必须更新所有修改术语的代码以保持术语有序。

乘法方法本身看起来很高效，我认为它不能再优化了。

# java - 连接生产者和两个消费者的最小方式都指向和在 HornetQ 上广播

> ID：12731597
> 
> 赞同：2
> 
> 时间：2012-10-04T16:24:45.500
> 
> 标签：java, hornetq

也许标题不是很具有描述性。

案例如下，有一个系统有一个服务器，一个生产者和 1..n 个消费者。

消息将直接发送给一个消费者或广播，以便每个消费者都收到消息。

我实际上正在考虑为每个消费者创建一个队列以进行直接通信，然后为广播消息创建另一个队列。这样，消费者应该轮询两个队列以获取消息：它自己的队列和广播队列。

实际的问题是：**有没有办法在没有广播队列的情况下做到这一点（所以消费者只会轮询一个队列）？**

* * *

我实际上在运行时使用转移解决了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:56:52.670

我不确定你在问什么。但是您不发送到队列，而是发送到地址：

在 hornetq-core 术语中：

生产者将发送到一个地址，您可以在该地址上创建一个或多个队列

在 JMS 术语中，您可以创建 JMS 队列或 JMS 主题，并且可以创建消息订阅。

还有... hornetq 上有一个关于[主题层次结构](http://docs.jboss.org/hornetq/2.3.0.Alpha/docs/user-manual/html/examples.html#topic-hierarchy-example)的功能，您可以在其中使用通配符创建队列。也许这会帮助你实现你所需要的。

如果您为我提供更多背景信息，我可以改进这个答案。

你也可以看看Diverts。查看 HornetQ 文档了解更多详细信息。

# java - 为 java 原型的子语言创建上下文无关文法

> ID：12731606
> 
> 赞同：1
> 
> 时间：2012-10-04T16:24:59.007
> 
> 标签：java, context-free-grammar

我是上下文无关语法的新手，到目前为止我只学过左/右推导和 G=(V, E, R,S) 之类的东西。但我试图解决的问题涉及 java 原型，我不太擅长 java。所以我真的不知道从哪里开始。

给出Java原型子语言的上下文无关文法。

```
int myMethod();
double myMethod(int x, double y);
static double f(int x, double y, int z);
public static double g(); 
```

这些是方法和变量，我怎么能与 S => Sa | 之类的东西联系起来？e ? 什么是开始符号？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:35:53.420

准备好 java 语法解析器（例如来自[http://www.antlr.org/grammar/list](http://www.antlr.org/grammar/list)）并扔掉所有不必要的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T08:49:18.540

这就是我想出的。你能花点时间看看这是否有意义吗？

```
S -> AB 
A -> PCT | CT | T 
B -> M(V);
V -> TX | TX,V | e

T -> int | double
C -> static | e
P -> public | e
M -> myMethod | f | g
X -> x | y | z 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:44:46.050

您需要了解的有关方法签名的所有 java 都位于单个[文档页面上](http://docs.oracle.com/javase/tutorial/java/javaOO/methods.html)。您通过识别语法变量开始编写语法。最明显的开始是

```
- type
- argument_name
- method_name
- parenthesis (2 terminal symbols)
- comma (terminal)
- semicolon (terminal) 
```

您在编写语法规则时引入更多变量，例如

```
argument_list : argument
              | argument, comma, argument_list 
```

一旦你完成你的语法，你就会有“最重要的规则”：

```
method_signature : ... 
```

是`method_signature`开始符号。

# ruby-on-rails - ActiveModel::MassAssignmentSecurity::PhonesController#create 中的错误

> ID：12731607
> 
> 赞同：0
> 
> 时间：2012-10-04T16:25:11.877
> 
> 标签：ruby-on-rails, ruby

现在我正在尝试构建一个能够搜索电话号码、购买电话号码并将交易记录到数据库的应用程序。

我想这样做的方法是有两个控制器——（1） find_numbers 控制器接受参数并搜索数字。(2) 手机控制器购买选择的号码并将参数保存到数据库中。

这是我正在尝试做的图表。

[http://www.stepanp.com/search-and-buy.jpg](http://www.stepanp.com/search-and-buy.jpg)

在 stackoverflower 的帮助下，我能够修复一堆错误，但由于某种原因，当我从 find_numbers/show POST 到 PhonesController#create 时，我得到了错误

```
ActiveModel::MassAssignmentSecurity::Error in PhonesController#create 
```

无法批量分配受保护的属性：:original_number、:name、:twilio_number

我认为这可能与我的表单布局方式有关，因为电话模型确实具有这些值的 attr_accessible。

这是 find_numbers/show 表格

```
<%= @numbers.each do |number| %>

    <%= form_tag(:controller => "phones", :action => "create" ) do %>
        <%= hidden_field "phone[:original_number]", params[:original_number] %>

    <%= hidden_field "phone[:name]", params[:name] %>
        <%= hidden_field "phone[:twilio_number]",  number.phone_number %>

        <div class="found_list">
            <div class="found_phone_number">
                <%= label_tag("phone[:number]", number.friendly_name) %>
            </div>
            <div class="choose_found_number">
             <%= submit_tag("Choose This Number", :class => "btn btn-large btn-success") %>
            </div>
        </div>
            <hr>
    <% end %>
<% end % 
```

它可能与在值周围添加 phone[] 有关

这是PhoneController#Create Action

```
def create
    @user = current_user
    @phone = @user.phones.new(params[:phone])
    client = Twilio::REST::Client.new(@user.twilio_account_sid, @user.twilio_auth_token)
    number = client.account.incoming_phone_numbers.create(
                   :phone_number => params[:twilio_number])
    if @phone.save && number.present?
      flash[:success] = "Phone Number Created!"
      redirect_to user_path
    else
      render new_find_number_path
      flash[:error] = "It looks like there were errors with the submission"
    end
end 
```

这是电话型号

```
# == Schema Information
#
# Table name: phones
#
#  id              :integer          not null, primary key
#  name            :string(255)
#  twilio_number   :string(255)
#  original_number :string(255)
#  user_id         :integer
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#

class Phone < ActiveRecord::Base

  attr_accessible :original_number, :user_id, :name, :twilio_number
  belongs_to :user

  validates :name, presence: true
  validates :twilio_number, presence: true
  validates :original_number, presence: true
  validates :user_id, presence: true

  default_scope order: 'phones.created_at DESC'

end 
```

我认为表单中的“phone[:attribute]”与此有关——尽管如果我们不这样说，由于某种原因，创建操作不会理解 POSTED 的 :name 属性是对于手机型号。

对此的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:06:37.520

我不知道为什么会发生这种情况，但我通过渲染电话/新而不是使用 form_for(@phone) 而不是 form_tag 来避免这一切

# vim - 如何在我的 vimrc 中停止重绘

> ID：12731609
> 
> 赞同：1
> 
> 时间：2012-10-04T16:25:14.777
> 
> 标签：vim, redraw

我想映射`F12`以获取标签`ctags`，所以我这样写`vimrc`：

```
map <F12> :call Do_CsTag()<CR>
function Do_CsTag()
  if(executable('ctags'))
    silent! execute "!ctags -R --c-types=+p --fields=+S *"
  endif
endf 
```

当我按下`F12`我的`C`源文件时，屏幕变成白色，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T19:45:57.693

在这种情况下尝试使用`system()`：替换

```
silent! execute "!ctags -R --c-types=+p --fields=+S *" 
```

和

```
call system('ctags -R --c-types=+p --fields=+S *') 
```

.

# vb.net - UpdatePanel initializeRequest Control Values Too Late To Change?

> ID：12731629
> 
> 赞同：0
> 
> 时间：2012-10-04T16:26:25.643
> 
> 标签：vb.net, ckeditor, pagerequestmanager

Here is my code:

```
<asp:UpdatePanel ID="up1" runat="server">
    <ContentTemplate>
        <script type="text/javascript">
            var app = Sys.WebForms.PageRequestManager.getInstance();
            app.add_pageLoaded(createEditor)
            app.add_initializeRequest(removeEditor)

            function createEditor() {
                if (editor) return;
                var config = { toolbar: 'Description', width: 540 };
                editor = CKEDITOR.replace("editor", config);
            }

            function removeEditor() {
                if (!editor) return;
                editor.destroy();
                editor = null;
            }
        </script>

        <textarea id="editor" cols="1" rows="1" runat="server">
        </textarea>

        <asp:Button ID="btnsubmit" Text="Get 'er Done" runat="server" />
        <div>
            <%=strmessage%>
        </div> 
    </ContentTemplate>
</asp:UpdatePanel> 
```

When the panel loads, the CKEditor is applied to the textarea. When the panel posts back, the editor must be destroyed to put the data back into the textarea. In this code, the Editor is not destroyed in time to update the postback data. It works if I do this:

```
<asp:Button ID="btnsubmit" onClientClick="removeEditor()" Text="Get 'er Done"
   runat="server" /> 
```

The problem is the UpdatePanel is not always triggered with that button, sometimes it's triggered remotely. It seems that by the time initializeRequest is called, the value for the textarea is already set. Is there a way to update that value at this point?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T18:46:51.043

答案是：如果您使用的是 .NET，请忘记 CKEditor、tinyMCE 和所有其他富文本编辑器。我不敢相信我花了这么长时间才发现[AJAX Control Toolkit](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/Default.aspx)。

# php - PHP Imagick- 500 internal server error

> ID：12731631
> 
> 赞同：1
> 
> 时间：2012-10-04T16:26:28.770
> 
> 标签：php, imagemagick, imagick

I am trying to get Imagick working; My development environment is:

*   Windows 2008 Server
*   II7
*   PHP 5.3.10
*   Imagick is installed (I hope properly)

I:

*   Checked if the class exists, and it does. (`if (class_exists('Imagick')) {}`)
*   Checked if I can create an Imagick obj, creates object (`new Imagick();`)
*   Applied the method and that worked too! (`$image ->setResolution(72, 72);`)

But, whenever I try to work with any image I have in the folder, I get a `500 - Internal server error`.

Any one of these scripts will generate a 500 error:

```
$image = new Imagick('images/logo.jpg'); 
```

or

```
$image ->readImage("images/logo.jpg"); 
```

or anything that involves accessing an image from a folder.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:35:09.040

在创建新的 Imagick 对象时尝试添加图像的完整路径

```
$image = new Imagick('/full/path/to/images/logo.jpg'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-06T05:10:32.740

我在共享托管服务上也遇到了类似的问题。

我需要从包含的库列表中取消选中 GD 图形库，因为 GD 和 Imagick 之间存在内部冲突。

# sql-server - 找不到 umbraco 数据存储

> ID：12731637
> 
> 赞同：1
> 
> 时间：2012-10-04T16:26:44.607
> 
> 标签：sql-server, database, umbraco, localdb

我已经通过 WebMatrix 安装了 Umbraco，并`"server=(localdb)\v11.0;integrated security=true"`作为连接字符串输入。该站点运行良好，但我找不到 Umbraco 创建的数据库。当我打开它时`(localdb)\v11.0`，它不存在。

我试过用`*.mdf`. 但没有运气。数据可以在哪里？

我正在使用 umbraco 4.8.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:49:14.067

该数据库很可能位于运行 Umbraco 的帐户的用户配置文件文件夹中。有关更完整的说明，请参阅[此帖子](http://blogs.msdn.com/b/sqlexpress/archive/2011/12/09/using-localdb-with-full-iis-part-2-instance-ownership.aspx)。您可能还想查看[其他帖子](http://blogs.msdn.com/b/sqlexpress/archive/2011/10/28/localdb-where-is-my-database.aspx)，了解为什么 LocalDB 默认情况下将数据库文件放在运行它的帐户的用户配置文件的根目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T18:22:00.307

我找到了。在没有定义数据库的情况下，SQL Server 使用列表中的第一个或默认数据库，它出现在`master`数据库中。SSMS之类的，不显示系统对象的表，所以我通过查询数据库找到了表。

# javascript - 在 UTF-8 文档中解码 WINDOWS-1255

> ID：12731644
> 
> 赞同：1
> 
> 时间：2012-10-04T16:27:23.593
> 
> 标签：javascript, encoding, decodeuricomponent

我有一个通过 javascript 生成并部署在 iframe 中的内容。我将此代码提供给客户以在其站点中生成内容（如小部件）

我遇到的问题是我的所有文档都使用 UTF-8 编码，而我的一些客户使用的是 Windows-1255 编码（希伯来语）

这当然不适用于我的脚本并导致各种问题。

问题分为2个：1.从父级传输到服务器（通过iframe）的数据没有被很好地识别

1.  从 iframe 发送的消息和数据也不会被解码（例如警报和确认消息）

我尝试使用解码字符串 `decodeURI`，`decodeURIComponent`但它不起作用。

我能做些什么来解决这个问题？

# java - 如何在java中拆分字符串？

> ID：12731645
> 
> 赞同：-1
> 
> 时间：2012-10-04T16:27:30.440
> 
> 标签：java

```
String str = "AlwinX-road-9:00pm-kanchana travels-25365445421";
String[] names = str.split("-"); 
```

我想要如下输出：

> AlwinX-road
> 9:00 PM
> kanchana 旅行
> 25365445421

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:18:56.083

```
 Use pattern matching to match your requirement
    String str = "AlwinX-road-9:00pm-kanchana travels-25365445421"; 
    String regex = "(^[A-Z-a-z ]+)[-]+(\\d+:\\d+pm)[-]([a-z]+\\s+[a-z]+)[-](\\d+)";
    Matcher matcher = Pattern.compile( regex ).matcher( str);
    while (matcher.find( ))
    {
    String roadname = matcher.group(1);
    String time = matcher.group(2);
    String travels = matcher.group(3);
    String digits= matcher.group(4);
    System.out.println("time="+time);
    System.out.println("travels="+travels);
    System.out.println("digits="+digits);                           
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:30:01.333

Since you want to include the delimiter in your first output line, you can do the split, and merge the first two element with a `-`: -

```
String[] names = str.split("-");

System.out.println(names[0] + "-" + names[1])
for (int i = 2;i < names.length; i++) {
    System.out.println(names[i])
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:31:59.940

The `split()` method can't distinguish the dash in `AlwinX-road` and the other dashes in the string, it treats all the dashes the same. You will need to do some sort of post processing on the resulting array. If you will always need the first two strings in the array joined you can just do that. If your strings are more complex you will need to add additional logic to join the strings in the array.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:44:13.327

One way you could do it, assuming the first '-' is always part of a two part identifier.

```
String str = "AlwinX-road-9:00pm-kanchana travels-25365445421";
String[] tokens = str.split("-");
String[] output = new String[tokens.length - 1];
output[0] = tokens[0] + '-' + tokens[1];
System.out.println(output[0]);
for(int i = 1; i < output.length; i++){ 
  output[i] = tokens[i+1];
  System.out.println(output[i]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T16:44:17.873

Looks like you want to split (with removal of all dashes but the first one).

```
String str = "AlwinX-road-9:00pm-kanchana travels-25365445421";
String[] names = str.split("-");

for (String value : names)
{
    System.out.println(value);
} 
```

So its produces:

```
AlwinX
road
9:00pm
kanchana travels
25365445421 
```

Notice that "AlwinX" and "road" we split as well since they had a dash in between. So you will need custom logic to handle this case. here is an example how to do it (I used [StringTokenizer](http://docs.oracle.com/javase/6/docs/api/java/util/StringTokenizer.html)):

```
StringTokenizer tk = new StringTokenizer(str, "-", true);
String firstString = null;
String secondString = null;
while (tk.hasMoreTokens())
{
    final String token = tk.nextToken();
    if (firstString == null)
    {
        firstString = token;
        continue;
    }
    if (secondString == null && firstString != null && !token.equals("-"))
    {
        secondString = token;
        System.out.println(firstString + "-" + secondString);
        continue;
    }
    if (!token.equals("-"))
    {
        System.out.println(token);
    }
} 
```

This will produce:

```
AlwinX-road
9:00pm
kanchana travels
25365445421 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-04T16:44:43.193

from your format, I think you want to split the first one just before the time part. You can do it this way:

```
String str =yourString;
String beforetime=str.split("-\\d+:\\d+[ap]m")[0]; //this is your first token, 
                                                    //AlwinX-road in your example
String rest=str.substring(beforetime.length()+1);
String[] restNames=rest.split("-"); 
```

If you really need it all together in one array then see the code below:

```
String[] allTogether=new String[restNames.length+1];//the string with all your tokens
allTogether[0]=beforetime;
System.arraycopy(restNames, 0, allTogether, 1, restNames.length); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-04T16:49:27.533

如果您使用“_”作为分隔符而不是“-”：AlwinX-road_9:00pm_kanchana travels_25365445421

新代码：

```
String str = new String("AlwinX-road_9:00pm_kanchana travels_25365445421");
String separator = new String("_");
String[] names = str.split(separator);
for(int i=0; i<names.length; i++){
    System.out.println(names[i]);
} 
```

# jquery - 如何检测隐藏输入字段的值变化

> ID：12731647
> 
> 赞同：8
> 
> 时间：2012-10-04T16:27:36.937
> 
> 标签：jquery, asp.net-mvc

我`textarea`在我的 MVC 应用程序中有一个我正在实现`AspNetSpellCheck`的地方，调试器告诉我对和 a的`textarea`更改是用and生成的。`display: none; visibility: hidden;``div``id="abc"``class"="pqr"`

```
<input type="hidden" value="" name="userid" id="useid" /> 
```

此外，我正在为所有文本区域/其他控件实现更改检测....

```
var somethingChanged = false;
$(document).ready(function() { 
    $('input').change(function() { 
       somethingChanged = true; 
    }); 
}); 
```

因为文本区域变得隐藏，我想它不会自动触发`change()`事件。在上述情况下触发事件的解决方案是什么？谢谢！

**编辑**

使用 AspNetSpellCheck，下面是我的代码，

```
 @{  

  ASPNetSpell.Razor.SpellAsYouType mySpell = new ASPNetSpell.Razor.SpellAsYouType();
   mySpell.InstallationPath = ("/Content/ASPNetSpellInclude");
   mySpell.FieldsToSpellCheck = "TextArea1";
}

<textarea id="TextArea1" cols="20" rows="2">bedddly</textarea>
@Html.Raw(mySpell.getHtml())

<script type="text/javascript" language="javascript">

$(document).ready(function () {
    $('input[type="hidden"]').change(function () {
        debugger;
        alert('hi');
        // somethingChanged = true; 
    });
});

 </script> 
```

调试器生成以下代码，隐藏文本区域和新的 DIV 构造，

```
 <div tabIndex="null" class="livespell_textarea" id="TextArea1___livespell_proxy">

 <textarea id="TextArea1" style="display: none; visibility: hidden;" rows="2" cols="20"> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-04T16:30:47.773

使用隐藏值，您需要自己触发更改事件：

```
$('#hiddenInput').val('newval').trigger('change'); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T16:37:01.703

if you dont know when the value is being changed in the textarea you can use `setInterval` to moniter the change

**Eg**

```
 var objTextBox = document.getElementById("your_id");
  oldValue = objTextBox.value;

  function track_change() {
    if (objTextBox.value != oldValue) {
      oldValue = objTextBox.value;
      alert('value of input has changed');
    }
  }

  setInterval(function () {
    track_change()
  }, 1000); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T16:32:08.597

试试这个.. 自己触发事件

```
$('input[type="hidden"]').change(function() { 
     alert('hi');
      // somethingChanged = true; 
});

$('#useid').val("20").change(); 
```

[小提琴](http://jsfiddle.net/sushanth009/f4ksF/2/)

​</p>

# perforce - Perforce 错误 - 无法从非流客户端提交

> ID：12731649
> 
> 赞同：31
> 
> 时间：2012-10-04T16:27:42.157
> 
> 标签：perforce

来自 GIT 和 SVN 背景，我在 Windows 中设置了我的 P4V，设法将我的存储库的内容放入我的本地文件夹（不知何故），但是一旦我在本地文件夹中进行了修改并创建了新文件，我就无法提交它回到 Perforce。它给出了错误：

//depot/main/p4config.txt - 警告：无法从非流客户端提交 没有要提交的文件。提交失败——修复上述问题，然后使用“p4 submit -c 6”。

我的仓库层次结构：

```
C:\Perforce\kernelpanic\main>p4 client -S //depot/main -o
# A Perforce Client Specification.
#
#  Client:      The client name.
#  Update:      The date this specification was last modified.
#  Access:      The date this client was last used in any way.
#  Owner:       The user who created this client.
#  Host:        If set, restricts access to the named host.
#  Description: A short description of the client (optional).
#  Root:        The base directory of the client workspace.
#  AltRoots:    Up to two alternate client workspace roots.
#  Options:     Client options:
#                      [no]allwrite [no]clobber [no]compress
#                      [un]locked [no]modtime [no]rmdir
#  SubmitOptions:
#                      submitunchanged/submitunchanged+reopen
#                      revertunchanged/revertunchanged+reopen
#                      leaveunchanged/leaveunchanged+reopen
#  LineEnd:     Text file line endings on client: local/unix/mac/win/share.
#  ServerID:    If set, restricts access to the named server.
#  View:        Lines to map depot files into the client workspace.
#  Stream:      The stream to which this client's view will be dedicated.
#               (Files in stream paths can be submitted only by dedicated
#               stream clients.) When this optional field is set, the
#               View field will be automatically replaced by a stream
#               view as the client spec is saved.
#
# Use 'p4 help client' to see more about client views and options.

Client: kernelpanic

Update: 2012/10/04 15:35:16

Access: 2012/10/04 15:59:39

Owner:  me.kernelpanic

Host:   kernelpanic

Description:
        Created by me.kernelpanic.

Root:   C:/Perforce/kernelpanic

Options:        noallwrite noclobber nocompress unlocked nomodtime normdir

SubmitOptions:  submitunchanged

LineEnd:        local

View:
        //depot/... //kernelpanic/...
        //depot/main/doc/... //kernelpanic/main/doc/...
        //depot/* //kernelpanic/*
        //depot/main/* //kernelpanic/main/* 
```

如果可能的话，我想在 C:\Perforce\kernelpanic\main\src 中添加文件......请帮助，我无法理解 Perforce。我尝试在进行修改之前或之后进行检查，但两种方式都未能将更改提交到服务器。我很想坚持使用 GIT，但我们的客户正在使用 Perforce，所以我们必须与他们相处融洽。非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-10-04T17:04:59.550

P4V 可能已指导您创建流库和主线，但以某种方式为您创建了非流工作区。据我所知，由于设置中的某些原因，初次使用 P4V 的用户很可能会发生这种情况。

要查看是否是问题所在，请转到连接/编辑工作区并查看“流”字段。是空的吗？如果是这样，请使用浏览来选择流。这会将您当前的工作空间变成流工作空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-21T11:30:20.467

如果您更喜欢使用命令行，可以向客户端添加流，如下所示：

显示可用的流：

```
$ p4 streams
Stream //stream/...1
Stream //stream/...2
Stream //stream/...3
… 
```

检查您当前的客户端配置：

```
$ p4 client -o
... 
```

就我而言，那里没有提到流。然后编辑客户端配置：

```
$ p4 client 
```

并添加：

```
Stream: //stream/...1 
```

通过重新运行检查它是否有效`p4 client -o`。

现在重试`p4 submit`。

# visual-studio-2010 - 如何使用 AnkhSVN 在 VS 中添加文件夹并将文件移动到其中？

> ID：12731654
> 
> 赞同：2
> 
> 时间：2012-10-04T16:27:54.997
> 
> 标签：visual-studio-2010, svn, tortoisesvn, explorer, ankhsvn

我尝试使用乌龟完成此任务，但失败并恢复到我之前的提交（[如何取消重新安排的项目？](https://stackoverflow.com/questions/12699828/how-can-i-un-quagmirize-my-rearranged-project)）

如何将子文件夹添加到我的项目并让它们被 Visual Studio 和 Subversion 识别？

简单地在解决方案资源管理器中添加文件夹并在 Windows 资源管理器中拖放文件是行不通的。

看来我可以将文件添加到 Windows 资源管理器中的子文件夹，但不能在 Visual Studio 的解决方案资源管理器中识别文件位置的重新排列，或者我可以将 Visual Studio 的解决方案资源管理器中的文件拖放到新的子文件夹中，但在 Windows 资源管理器中无法识别该重定位。

我已经在 Visual Studio 中重新添加了子文件夹（我认为这不会破坏任何东西，尽管它们是空的）。将右键单击文件并选择 Refactor | Move 是一种可以接受的方式来让它工作（我认为 Refactor 上下文菜单项来自 Resharper，但可能它是一个 VS“东西”）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:47:55.840

如果一个目录中至少有一个文件并且该文件是通过 AnkhSVN (Subversion > Add) 添加的，该目录也将被自动添加。

如果目录为空，即使该目录包含在解决方案中，通过 AnkhSVN 的添加命令也将不起作用。这是一种奇怪的行为，您可以使用另一个 SVN 客户端（例如[TortoiseSVN](http://tortoisesvn.net) ）来解决。

# visual-studio - 我正在寻找视觉工作室中字体样式的建议

> ID：12731657
> 
> 赞同：2
> 
> 时间：2012-10-04T16:28:04.003
> 
> 标签：visual-studio

我在vs2008中尝试了几种不同的字体样式设置，以便我可以轻松区分括号和括号。{ ( ) } 。

我还没有找到一种擅长括号和括号但又舒服的字体。

Lucida Console 是我目前所选择的，但是任何人都可以推荐一个他们认为更容易看到的东西吗？

（要更改设置，请转到工具-> 选项-> 环境-> 字体和颜色。请参阅 stackoverflow： [在 Visual Studio 2008 中更改字体大小和样式](https://stackoverflow.com/questions/836310/change-font-size-and-style-in-visual-studio-2008)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:31:41.250

如果您想要一种易于阅读的字体，则不应将自己限制为等宽字体。

我个人目前使用 Verdana。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:35:22.110

如果您使用的是 VS 2012，则可以使用开放式字体（更多字体）：

试试 Inconsolata：[http](http://levien.com/type/myfonts/inconsolata.html)
://levien.com/type/myfonts/inconsolata.html 下载：[http ://www.google.com/webfonts/download?kit=CNj0Ze1H6w4FVgc32wmZS4fD-WQWLbF4rYwcBGowFYY](http://www.google.com/webfonts/download?kit=CNj0Ze1H6w4FVgc32wmZS4fD-WQWLbF4rYwcBGowFYY)

另一种尝试是 Droid Sans Mono [http://www.fontsquirrel.com/fonts/Droid-Sans-Mono](http://www.fontsquirrel.com/fonts/Droid-Sans-Mono)
另见[http://damieng.com/blog/2007/11/14/droid-sans-mono-great -编码字体](http://damieng.com/blog/2007/11/14/droid-sans-mono-great-coding-font)

**更新1：**

还可以尝试[http://damieng.com/blog/tag/coding-fonts](http://damieng.com/blog/tag/coding-fonts)
中的那些， 尤其是 Envy Code R [http://damieng.com/blog/2008/05/26/envy-code-r-preview-7-编码字体发布](http://damieng.com/blog/2008/05/26/envy-code-r-preview-7-coding-font-released)

# c# - Linq2Xml - 如何获取相关的节点和子节点

> ID：12731658
> 
> 赞同：0
> 
> 时间：2012-10-04T16:28:04.013
> 
> 标签：c#, xml, linq-to-xml

我有这样的xml：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Body>
  <supplyCrew xmlns="http://site.ddf.com">
     <login>
        <login>XXXX</login>
        <password>XXXX</password>
     </login>
     <flightInformation>
        <flights>
           <item>
              <arrivalDateTime>2010-11-08T22:48:00.000Z</arrivalDateTime>
              <arrivingCity>ORD</arrivingCity>
              <crewMembers>
                 <item>
                    <employeeId>020040</employeeId>
                    <isDepositor>Y</isDepositor>
                    <isTransmitter>N</isTransmitter>
                 </item>
                 <item>
                    <employeeId>09000</employeeId>
                    <isDepositor>N</isDepositor>
                    <isTransmitter>Y</isTransmitter>
                 </item>
              </crewMembers>
           </item>
           <item>
              <arrivalDateTime>2010-11-08T20:29:00.000Z</arrivalDateTime>
              <arrivingCity>JFK</arrivingCity>
              <crewMembers>
                 <item>
                    <employeeId>0538</employeeId>
                    <isDepositor>Y</isDepositor>
                    <isTransmitter>N</isTransmitter>
                 </item>
                 <item>
                    <employeeId>097790</employeeId>
                    <isDepositor>N</isDepositor>
                    <isTransmitter>Y</isTransmitter>
                 </item>
              </crewMembers>
           </item>
        </flights>
     </flightInformation>
  </supplyCrew> 
```

此代码仅获取第一项“和”，然后生成异常“System.NullReferenceException”。

```
using System;
using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Linq;
using System.Xml.Linq;
using System.Text;
using System.Xml;
using System.Data.SqlClient;
using System.Data;
using System.IO;

namespace ConsoleApplication1
{

class Program
{ 

  static void Main(string[] args)
    {

        XElement doc = XElement.Load("U:/Crew.xml");
        XNamespace e = "http://schemas.xmlsoap.org/soap/envelope/";
        XNamespace s = "http://site.ddf.com";

                   var flights = doc.Elements(e + "Body")
        .Elements(s + "supplyCrew")
        .Elements(s + "flightInformation")
        .Elements(s + "flights")
        .Elements(s + "item")
        .Select(
        flight_item => new
        {
            //Anonymous Type
            arrivalDateTime = flight_item.Element(s + "arrivalDateTime").Value,
            arrivingCity = flight_item.Element(s + "arrivingCity").Value,
            crewmember = flight_item.Elements(s + "crewMembers").Elements(s + "item"),

        }
        );

        int index = 1;
        foreach (var flight_item in flights)
        {

            Console.Write('\n'+"New flight item:"+'\n');
            Console.Write('\t'+flight_item.arrivalDateTime + '\n');
            Console.Write('\t'+flight_item.arrivingCity + '\n');

            foreach (var item in flight_item.crewmember)
            {
                var employeeId = item;//crewmember.Elements(s + "item").Elements("employeeId");
                Console.Write("\t  "+employeeId);
                Console.Write('\n');
                //index++;
            }

        } 
```

这个想法是获取所有行的 item.arrivalDateTime 和 item.arrivingCity 及其 crampMembers.item.employeeId。但是我不知道如何使用 linq 获取子节点...如果尝试 employeeId = x.Element(s + "employeeId").Value....

结果应该是这样的：

> 2010-11-08T22:48:00.000Z; 订单；020040
> 
> 2010-11-08T22:48:00.000Z; 订单；09000
> 
> 2010-11-08T20:29:00.000Z; 肯尼迪；0538
> 
> 2010-11-08T20:29:00.000Z; 肯尼迪；097790

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:25:34.040

问题在于您使用`Descendants`. 您要求元素的所有`item`后代`flights`- 这意味着它将包括以下内容：

```
<item>
   <employeeId>020040</employeeId>
   <isDepositor>Y</isDepositor>
   <isTransmitter>N</isTransmitter>
</item> 
```

那显然没有`arrivalDateTime`元素，因此存在问题。

替换示例代码中对`Descendants`to`Elements`的每个调用可以解决问题……尽管如果实际文档没有所有预期的数据，您仍然会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T10:20:35.873

**解决了**

我们只需要将 foreach 替换为：

```
 foreach (var flight_item in l_flights)
        {

            Console.Write('\n'+"New flight item:"+'\n');
            Console.Write('\t'+flight_item.arrivalDateTime + '\n');
            Console.Write('\t'+flight_item.arrivingCity + '\n');

            foreach (var item in flight_item.crewmember)
            {
                var employeeId = item.Element(s + "employeeId").Value;
                var isDepositor = item.Element(s + "isDepositor").Value;
                var isTransmitter = item.Element(s + "isTransmitter").Value;

                Console.Write("\t  " + employeeId + "\n");
                Console.Write("\t  " + isDepositor + "\n");
                Console.Write("\t  " + isTransmitter + "\n");

            }

        } 
```

谢谢你们....

# javascript - 如何使用 RequireJS 只加载和运行一次模块

> ID：12731660
> 
> 赞同：6
> 
> 时间：2012-10-04T16:28:05.670
> 
> 标签：javascript, knockout.js, requirejs

我的应用程序上有一个通用模块，可以从远程服务器检索数据，并有`get`方法将检索到的数据导出到其他模块。

让我们假设这个模块的名称是`MyData`：

```
define([], function(){

    return function(opts) {
        var data = null;

        // go get data with ajax
        var getData = function(){
            $.ajax("getData").done(function(response){
                data = response;
            });
        };

        getData();

        // return public api
        if (arguments.length !== 0) {
            var method = arguments[0];
            switch (method) {
                case "get": return data;
            }
        };

    };

}); 
```

问题是当我定义其他使用的模块时`MyData`，每次它都会创建一个新的实例`MyData`，导致它每次都从服务器检索数据。

我可以使用网络存储（或其他全局变量）来存储返回的数据，但这似乎是一个糟糕的解决方案。

有没有办法强制 RequireJS 只创建一次实例？

**PS：** 在我的项目中，我使用了 KnockoutJS，并且`data`变量是 ko.observable，所以也许 Knockout 对我的情况有解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:39:30.383

RequireJS 已经加载了每个模块一次。你只需要稍微重构你的代码：

```
// myModule.js
define(function() {
    // The dataFetch Promise will be initialized when this module
    // is loaded for the first time.
    var dataFetch = $.ajax("getData");

    return {
        getData: function () {
            // Return the Promise interface and let callers use the
            // .done, .fail etc. methods on it
            return dataFetch;
        }
    };
}); 
```

用法：

```
define([ "myModule" ], function (myModule) {
    myModule.getData().done(function (data) {
        // use the data
    });
}); 
```

通过使用返回的 Promise 接口`$.ajax`，您可以确保对仅获取一次的数据进行异步访问。

顺便说一句，您尝试实现的模式可能是模型。

# c++ - 循环检查文件的存在并处理它

> ID：12731661
> 
> 赞同：0
> 
> 时间：2012-10-04T16:28:09.927
> 
> 标签：c++, while-loop, fstream, ifstream, file-processing

我开始了学校作业的第一部分，我必须提示用户输入文件名，检查文件是否存在，如果存在，打开它进行处理；否则我要让用户输入另一个文件名。

当我在下面编译并运行我的程序时，我收到错误消息“不存在文件。请输入另一个文件名。” 当我输入不存在的文件名时，它只会再次运行我的 do while 循环的第一部分。我是 C++ 的初学者，但我以前做过，我觉得它应该可以正常运行。任何帮助，将不胜感激。

```
#include <iostream>
#include <string>
#include <fstream>
using namespace std;

struct customerData
{ 
  int _customerID;
  string _firstName, _lastName;
  double _payment1, _payment2, _payment3;
};

void processFile();

int main()
{
  processFile();

  system ("pause");
  return 0;
}

void processFile()
{
  string filename;
  ifstream recordFile;

 do
 {
    cout << "Please enter a filename\n";
    cin >> filename;
    recordFile.open(filename);
    if (recordFile.good())
    // {
    //  enter code for if file exists here
    // }
    ;
 }
 while(recordFile.fail());
 {
        cout << "No file by that name. Please enter another filename\n";
        cin >> filename;
        recordFile.open(filename);
 }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:34:04.953

要检查文件是否成功打开，您必须使用 std::fstream::is_open() 函数，如下所示：

```
void processfile ()
{
  string filename;

  cout << "Please enter filename: ";
  if (! (cin >> filename))
    return;

  ifstream file(filename.c_str());
  if (!file.is_open())
  {
    cerr << "Cannot open file: " << filename << endl;
    return;
  }

  // do something with open file
} 
```

成员函数 .good() 和 .fail() 检查其他内容，而不是文件是否成功打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:35:18.193

我不能 100% 确定你的意图是什么，但你知道你这里只有一个循环吗？在你的 do/while 循环之后，你有一些大括号中的代码，但它没有连接到任何循环结构......它只是一个新的范围（在这里没有任何用途）。

所以，你的程序这样做：

1) 询问文件名。尝试打开它。如果可以读取文件流，请执行“在此处输入代码”部分。

2）检查文件流是否“坏”。如果是，则返回步骤 1。否则，继续。

3) 打印出“no file by that name”，提示输入新文件，尝试打开

这几乎肯定不是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:35:45.617

你可以使用c代码。

```
FILE *fp = fopen("file" "r");
if(fp){
//do stuff
}
else{
//it doesnt exist
} 
```

附带说明一下，当使用命名空间 std 时，请尝试使其不是全局的

您可以在必要时将其放在您的函数中

```
int main(){
using namespace std;
//other std stuff
} 
```

# c# - 在 word 互操作中使用选择和范围

> ID：12731665
> 
> 赞同：2
> 
> 时间：2012-10-04T16:28:36.247
> 
> 标签：c#, .net, interop, ms-word, office-interop

范围和选择如何工作？

如果您通过范围在页面顶部插入某些内容，是否会通过插入带有选择的内容来覆盖？选择会影响范围吗？

我在按此顺序插入时遇到问题，但 InlineShapes 显示在 Range.Inserts 上方的文档顶部。此外，Selection.InsertBefore 被 InlineShapes 取代。

我希望我的范围插入出现在每张图片上方，就像一个标题。如何才能做到这一点？

```
Selection.InsertBefore
**Loop**
     Range.InsertParagraphAfter
     Selection.InlineShapes.AddPicture
**End Loop** 
```

**像这样的问题我已经问了三遍了，都没有回应。任何事情都会有帮助！**

编辑：

我又近了一步。现在，当我添加我的 InlineShapes 时，我使用 Content.InlineShapes.AddPicture(FileName: x, range: y)。现在图片显示在段落之间，但它们位于我在添加图片之前添加到文档中的表格的第一个单元格中。我添加了带有折叠范围的表格。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-05T18:44:53.850

你写：

```
I've asked a question like this three times now with no responses. Anything would help! 
```

作为参考，提到的问题（我猜）是：

*   [如何使用 word interop 一次将一个项目添加到 word 文档的新行](https://stackoverflow.com/questions/12718044/how-to-add-items-one-at-a-time-to-to-a-new-line-a-word-document-using-word-inter)
*   [使用 interop.word 范围](https://stackoverflow.com/questions/12715858/using-interop-word-ranges/12751897#12751897)

...现在都已经回答了:)

但是，您在这篇文章中提出了多个问题 - 首先：

> 范围和选择如何工作？

实际上，文档很好地涵盖了这一点：

一个范围：

> "代表文档中的一个连续区域。
> 
> 每个 Range 对象由开始和结束字符位置定义。类似于在文档中使用书签的方式，Range 对象用于识别文档的特定部分......”

参考： http: [//msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range(v=office.14).aspx) (v=office.14).aspx 。

> 如果您通过范围在页面顶部插入某些内容，是否会通过插入带有选择的内容来覆盖？

有可能。这取决于选择了什么。如果您选择了与您刚刚插入的内容范围相交的内容并更改了内容，那么您将对范围的内容进行更改。

要完全理解这一点，我建议您阅读以下内容：

*   [`Selection`界面_](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.selection.aspx)
*   [`Range`界面_](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range%28v=office.14%29.aspx)

> 选择会影响范围吗？

这取决于。该文档指出：

> Range 对象与选择无关。

参考： http: [//msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range (v=office.14).aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.range(v=office.14).aspx)

...因此，如果您只是进行简单的选择以例如读取内容或将内容复制到剪贴板，则不会发生任何变化。但是，如果您使用选择来更改内容，这当然会影响范围所指向的内容。接下来，您应该注意 MS 建议使用`Range`对象进行文档操作：

> 因为 Range 对象与 Selection 对象共享许多相同的方法和属性，所以当没有理由物理更改当前选择时，最好使用 Range 对象来操作文档。

参考：http: [//msdn.microsoft.com/en-us/library/microsoft.office.interop.word.selection.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.selection.aspx)

最后，你问：

> 我在按此顺序插入时遇到问题，但 InlineShapes 显示在 Range.Inserts 上方的文档顶部。此外，Selection.InsertBefore 被 InlineShapes 取代。
> 
> 我希望我的范围插入出现在每张图片上方，就像一个标题。如何才能做到这一点？

请参阅我之前对您的问题的回答：“[如何使用 word interop 一次将一个项目添加到一个 word 文档的新行](https://stackoverflow.com/questions/12718044/how-to-add-items-one-at-a-time-to-to-a-new-line-a-word-document-using-word-inter)”：[https](https://stackoverflow.com/a/12751805/700926) ://stackoverflow.com/a/12751805/700926 - 这为您提供了完整的回答。

# asp.net-mvc - 如何创建基于 Azure 的 WCF RESTful API

> ID：12731666
> 
> 赞同：0
> 
> 时间：2012-10-04T16:28:35.937
> 
> 标签：asp.net-mvc, wcf, azure, restful-authentication

有什么教程吗？

理想情况下，它将具有基本的 http 身份验证

我可以创建一个安静的 WCF Web 服务并部署到 Azure 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:34:48.517

真的需要 WCF 吗？现在有 Asp.Net WebApi。它是 WCF WebApi 的继承者。这是教程链接：
[ASP.NET Web API 入门](http://www.asp.net/web-api)

通常，Azure 或 OnPremise 的实际代码没有区别。

# c++ - FLTK 1.3 链接错误

> ID：12731679
> 
> 赞同：4
> 
> 时间：2012-10-04T16:29:17.480
> 
> 标签：c++, cmake, fltk

我将我的 FLTK 从 1.1 更新到 1.3，然后我无法编译在更新之前运行良好的代码。

```
...
    [100%] Building CXX object CMakeFiles/PROSTVIEW.dir/include/nifti/vtkznzlib.cxx.o
    Linking CXX executable PROSTVIEW
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `fontopen(char const*, int, bool, int)':
    fl_font.cxx:(.text+0x298): undefined reference to `FcPatternCreate'
    fl_font.cxx:(.text+0x362): undefined reference to `FcPatternAddString'
    fl_font.cxx:(.text+0x3e3): undefined reference to `FcPatternAddString'
    fl_font.cxx:(.text+0x3f7): undefined reference to `FcPatternAddInteger'
    fl_font.cxx:(.text+0x40b): undefined reference to `FcPatternAddInteger'
    fl_font.cxx:(.text+0x424): undefined reference to `FcPatternAddDouble'
    fl_font.cxx:(.text+0x43c): undefined reference to `FcPatternAddString'
    fl_font.cxx:(.text+0x4df): undefined reference to `FcMatrixRotate'
    fl_font.cxx:(.text+0x4f7): undefined reference to `FcPatternAddMatrix'
    fl_font.cxx:(.text+0x516): undefined reference to `FcPatternAddBool'
    fl_font.cxx:(.text+0x52c): undefined reference to `FcPatternAddBool'
    fl_font.cxx:(.text+0x549): undefined reference to `XftFontMatch'
    fl_font.cxx:(.text+0x5a0): undefined reference to `XftFontOpen'
    fl_font.cxx:(.text+0x5b0): undefined reference to `FcPatternDestroy'
    fl_font.cxx:(.text+0x5f3): undefined reference to `XftFontOpenPattern'
    fl_font.cxx:(.text+0x603): undefined reference to `FcPatternDestroy'
    fl_font.cxx:(.text+0x659): undefined reference to `XftFontOpenXlfd'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `utf8extents(Fl_Font_Descriptor*, char const*, int, _XGlyphInfo*)':
    fl_font.cxx:(.text+0x84b): undefined reference to `XftTextExtents32'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `fl_xft_width(Fl_Font_Descriptor*, unsigned int*, int)':
    fl_font.cxx:(.text+0x98a): undefined reference to `XftTextExtents32'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `fl_destroy_xft_draw(unsigned long)':
    fl_font.cxx:(.text+0x102e): undefined reference to `XftDrawChange'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `Fl_Xlib_Graphics_Driver::draw(char const*, int, int, int)':
    fl_font.cxx:(.text+0x10c6): undefined reference to `XftDrawCreate'
    fl_font.cxx:(.text+0x10f6): undefined reference to `XftDrawChange'
    fl_font.cxx:(.text+0x1140): undefined reference to `XftDrawSetClip'
    fl_font.cxx:(.text+0x1202): undefined reference to `XftDrawString32'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `fl_drawUCS4(Fl_Graphics_Driver*, unsigned int const*, int, int, int)':
    fl_font.cxx:(.text+0x1313): undefined reference to `XftDrawCreate'
    fl_font.cxx:(.text+0x1343): undefined reference to `XftDrawChange'
    fl_font.cxx:(.text+0x138d): undefined reference to `XftDrawSetClip'
    fl_font.cxx:(.text+0x1433): undefined reference to `XftDrawString32'
    /usr/local/lib/libfltk.a(fl_font.cxx.o): In function `Fl_Xlib_Graphics_Driver::rtl_draw(char const*, int, int, int)':
    fl_font.cxx:(.text+0x1480): undefined reference to `FcUtf8Len'
    fl_font.cxx:(.text+0x14ff): undefined reference to `FcUtf8ToUcs4'
    collect2: ld returned 1 exit status
    make[2]: *** [PROSTVIEW] Error 1
    make[1]: *** [CMakeFiles/PROSTVIEW.dir/all] Error 2
    make: *** [all] Error 2 
```

这是我的 CMakeLists.txt

```
cmake_minimum_required(VERSION 2.6)

PROJECT(PROSTVIEW)

SET(CMAKE_BUILD_TYPE DEBUG)
SET(CMAKE_CXX__FLAGS -O3 -pipe -ffast-math -Wno-deprecated)

# Chargement Package
# FLTK
 FIND_PACKAGE ( FLTK )
 IF ( FLTK_FOUND )
    INCLUDE_DIRECTORIES( ${FLTK_INCLUDE_DIR} )
 ENDIF ( FLTK_FOUND )

# ITK
FIND_PACKAGE ( ITK )
IF ( ITK_FOUND )
    INCLUDE( ${USE_ITK_FILE} )
ENDIF( ITK_FOUND ) 

# VTK
FIND_PACKAGE ( VTK )
IF ( VTK_FOUND )
    INCLUDE( ${USE_VTK_FILE} )
ENDIF( VTK_FOUND )
SET(VTK_LIBRARIES vtkCommon vtkRendering vtkWidgets vtkGraphics vtkGenericFiltering vtkzlib)

# vtkFlRenderWindowInteractor
SET(VTKFL_INCLUDE_DIR "include/vtkfl")
SET(VTKFL_CPP 
${VTKFL_INCLUDE_DIR}/vtkFlRenderWindowInteractor.cxx)

# Auxiliary_Tools
SET(AT_DIR "include/Auxiliary_Tools")
SET(AT_INCLUDE_DIR ${AT_DIR}/include)
SET(AT_LIBRARY_DIR ${AT_DIR}/lib)

#Nifty
SET(NII_DIR "include/nifti")
SET(NII_SRC 
${NII_DIR}/vtkNIfTIReader.cxx
${NII_DIR}/vtkNIfTIWriter.cxx
${NII_DIR}/vtkAnalyzeReader.cxx
${NII_DIR}/vtkAnalyzeWriter.cxx
${NII_DIR}/vtknifti1_io.cxx
${NII_DIR}/vtkznzlib.cxx)

#Other include
SET(PROSTVIEW_INCLUDE_DIR "include")
SET(PROSTVIEW_SRC
${PROSTVIEW_INCLUDE_DIR}/ContourTmt.cpp
${PROSTVIEW_INCLUDE_DIR}/conversion.cpp 
${PROSTVIEW_INCLUDE_DIR}/TmtMatrix.cpp) 

# VOLUME Widget
SET(VOLUME_WIDGET_DIR "include/GUI")
SET(VOLUME_WIDGET 
${VOLUME_WIDGET_DIR}/VOLUME_Loader.cpp 
${VOLUME_WIDGET_DIR}/VOLUME_Widget.cpp 
${VOLUME_WIDGET_DIR}/VOLUME_Mouse_Widget.cpp 
${VOLUME_WIDGET_DIR}/VOLUME_3DView.cpp 
${VOLUME_WIDGET_DIR}/CONTOUR_Loader.cpp 
${VOLUME_WIDGET_DIR}/ProstView.cpp)

# MODULES
SET(MODULE_DIR "Module")

# SEGMENTATION
SET(SEGMENTATION_DIR "Module/Segmentation")
SET(SEGMENTATION 
${SEGMENTATION_DIR}/DDC2D.cpp 
${SEGMENTATION_DIR}/DDC3D.cpp 
${SEGMENTATION_DIR}/DDC3DHu.cpp 
${SEGMENTATION_DIR}/DDC3DPlus.cpp 
${SEGMENTATION_DIR}/DDC3DBal.cpp 
${SEGMENTATION_DIR}/IMAGE_ENERGY.cpp 
${SEGMENTATION_DIR}/REGULARIZATION.cpp 
${SEGMENTATION_DIR}/OPTIMAL_SURFACE_DETECTION.cpp 
${SEGMENTATION_DIR}/OPTIMAL_MULTIPLE_SURFACES_DETECTION.cpp 
${SEGMENTATION_DIR}/RESAMPLE_From_Prostate.cpp
${SEGMENTATION_DIR}/RECTAL_WALL_US.cpp 
${SEGMENTATION_DIR}/BLADDER_MRI.cpp 
${SEGMENTATION_DIR}/RECTUM_MRI.cpp 
${SEGMENTATION_DIR}/REGION_GROWING.tpp )

#MESH
SET(MESH_DIR "Module/Mesh")
SET(MESH
${MESH_DIR}/GENERIC_MESH.cpp
${MESH_DIR}/ELLIPSOID_MESH.cpp
${MESH_DIR}/PROSTATE_MESH.cpp
${MESH_DIR}/TUBULAR_MESH.cpp
${MESH_DIR}/OPEN_MESH.cpp
${MESH_DIR}/QUADRIC_MESH.cpp
${MESH_DIR}/ELLIPTICAL_CYLINDER_MESH.cpp 
${MESH_DIR}/CONTOURS_MAN_MESH.cpp)

#STUDY
SET(STUDY_DIR "Module/Statistics")
SET(STUDY
${STUDY_DIR}/PROFILE.cpp
${STUDY_DIR}/Histogram.cpp
${STUDY_DIR}/HISTOGRAM_FROM_MESH.cpp
${STUDY_DIR}/TRAINING_SET_ALIGNMENT.cpp
${STUDY_DIR}/APPEARANCE_MODEL.cpp)

# MOMENTS
SET(MOMENTS_DIR "Module/Moments")
SET(MOMENTS 
${MOMENTS_DIR}/KRAWTCHOUK_Moments.tpp 
${MOMENTS_DIR}/TCHEBICHEF_Moments.tpp 
${MOMENTS_DIR}/GEOMETRIC_Moments.tpp)

#VALIDATION
SET(VALIDATION_DIR "Module/Evaluation")
SET(VALIDATION 
${VALIDATION_DIR}/Metrics.cpp)

# Include et Link Directories
INCLUDE_DIRECTORIES(${FLTK_INCLUDE_DIR} ${VTK_INCLUDE_DIRS} ${VTKFL_INCLUDE_DIR} ${AT_INCLUDE_DIR} ${NII_DIR} ${PROSTVIEW_INCLUDE_DIR} ${VOLUME_WIDGET_DIR} ${MODULE_DIR})
LINK_DIRECTORIES(${FLTK_LIBRARY_DIR} ${VTK_LIBRARY_DIRS} ${AT_LIBRARY_DIR} ${PROSTVIEW_INCLUDE_DIR} ${VOLUME_WIDGET_DIR} ${MODULE_DIR})

# Sources
SET(SRC main.cpp) 

# Executables and "stand-alone " librairies
ADD_EXECUTABLE(PROSTVIEW ${SRC} ${PROSTVIEW_SRC} ${VTKFL_CPP} ${VOLUME_WIDGET} ${SEGMENTATION} ${MESH} ${STUDY} ${MOMENTS} ${VALIDATION} ${NII_SRC})

# Linkage
TARGET_LINK_LIBRARIES(PROSTVIEW  ${FLTK_LIBRARIES} ${VTK_LIBRARIES} ${ITK_LIBRARIES}) 
```

我试图在我的 CMakeLists.txt 中添加一些库，但它不起作用。谁能告诉我是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T14:56:11.493

来自 FLTK 1.3 的 README.CMake.txt：

> # 将 CMAKE 与 FLTK 一起使用
> 
> 本指南假定您已安装使用 CMake 构建的 FLTK 库。使用 CMake 构建它们会生成一些安装在标准位置的 CMake 帮助文件，使 FLTK 易于查找和使用。
> 
> 这是一个使用 FLTK 的基本 CMakeLists.txt 文件。
> 
> * * *
> 
> cmake_minimum_required（版本 2.6）
> 
> 项目（你好）
> 
> find_package(FLTK REQUIRED NO_MODULE) 包括(${FLTK_USE_FILE})
> 
> add_executable(hello WIN32 hello.cxx)
> 
> target_link_libraries（你好 fltk）
> 
> * * *
> 
> find_package 命令告诉 CMake 查找包 FLTK，REQUIRED 表示如果没有找到就是错误。NO_MODULE 告诉它只搜索 FLTKConfig 文件，而不是使用 CMake 提供的 FindFLTK.cmake，它不适用于这个版本的 FLTK。
> 
> 找到包后，我们包含 ${FLTK_USE_FILE}，它将 FLTK 包含目录和库链接信息添加到其知识库中。之后，您的程序将能够找到 FLTK 标头，并且当您链接 fltk 库时，它会自动链接 fltk 所依赖的库。

似乎从 FLTK 1.1 到 1.3，他们更改了查找库所需的方法，也许是出于可比性/测试的原因？

我挂断了同样的问题，希望有人觉得这很有用。:)

# json - 为什么我无法访问 POST 到我的 codeigniter 应用程序的 json 数据？

> ID：12731681
> 
> 赞同：3
> 
> 时间：2012-10-04T16:29:28.527
> 
> 标签：json, codeigniter, rest, post, curl

我正在使用 CodeIgniter 开发一个 RESTful 应用程序，但我无法在我的控制器中访问我的 POST'd json 数据。

我正在本地机器上通过 cURL 发布 json，而该应用程序正在远程服务器上开发。

这是有问题的控制器代码：

```
class Products extends CI_Controller
{
  public function __construct()
  {
    $this->load->model(products_model);
  }
  public function index($id = FALSE)
  {
    if($_SERVER['REQUEST_METHOD'] == 'GET')
    {
      // fetch product data
      $product_data = $this->products_model->get_products($id)

      // set appropriate header, output json
      $this->output
        ->set_content_type(application/json)
        ->set_output(json_encode($product_data));
    }
    elseif($_SERVER['REQUEST_METHOD'] == 'POST')
    {
      // debugging for now, just dump the post data
      var_dump($this->input->post());
    }

  }
} 
```

GET 操作运行良好，并在从浏览器请求或通过 cURL 请求时返回适当的数据。但是，当尝试通过 cURL POST json 数据时，我始终会`bool(FALSE)`从 index 函数的 POST 部分返回。这是我正在发出的 cURL 请求：

```
curl -X POST -d @product.json mydomain.com/restfulservice/products 
```

此外，这是 product.json 文件的内容：

```
{"id":"240",
"name":"4 x 6 Print",
"cost":"1.5900",
"minResolution":401,
"unitOfMeasure":"in",
"dimX":0,
"dimY":0,
"height":4,
"width":6} 
```

我通过 cURL 进行了另一个 POST，不包括 json 数据并传递了如下内容：

```
curl -X POST -d '&this=that' mydomain.com/restfulservice/products 
```

哪个返回

```
array(1) {
  ["this"]=>
  string(4) "that"
} 
```

是什么赋予了？json的东西？这是有效的。我已经在 application/config/config.php 中关闭了全局 CSRF 和 XSS，因为我知道它们需要使用 CI `form_open()`，没有它就无法正常工作。据我了解，排除参数 from`$this->input->post()`将返回所有帖子项目，但我仍然没有得到任何内容。我也试过绕过 CI 的输入库并通过 PHP 的`$_POST`变量访问数据，它没有任何区别。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:17:55.503

您的帖子数据不是查询字符串格式，因此您应该跳过处理 $_POST 并直接转到原始帖子数据。

尝试

```
var_dump($HTTP_RAW_POST_DATA); 
```

甚至更好

```
var_dump(file_get_contents("php://input")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-01T12:09:18.460

在 codeigniter 2.X 中，您可以覆盖 Input 类并添加必要的功能。 [https://ellislab.com/codeigniter/user-guide/general/core_classes.html](https://ellislab.com/codeigniter/user-guide/general/core_classes.html)

1.  将文件 MY_Input.php 添加到 application/core
2.  在此文件中添加代码：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class MY_Input extends CI_Input {

    public function raw_post() {
        return file_get_contents('php://input');
    }

    public function post($index = NULL, $xss_clean = FALSE) {
        $content_type = $this->get_request_header('Content-type');

        if (stripos($content_type, 'application/json') !== FALSE
            && ($postdata = $this->raw_post())
            && in_array($postdata[0], array('{', '['))) {

            $decoded_postdata = json_decode($postdata, true);
            if ((json_last_error() == JSON_ERROR_NONE))
                $_POST = $decoded_postdata;
        }

        return parent::post($index, $xss_clean);
    }
}
```

就是这样..

像普通帖子一样使用它..

# c# - 如何从 WinForms 中的 app.config 读取 AppSettings

> ID：12731683
> 
> 赞同：9
> 
> 时间：2012-10-04T16:29:36.977
> 
> 标签：c#, app-config

我通常使用文本文件作为配置。但这次我想利用 app.config 将文件名（键）与名称（值）相关联，并使名称在组合框中可用

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <appSettings>
   <add key="Scenario1.doc" value="Hybrid1"/>
   <add key="Scenario2.doc" value="Hybrid2"/>
   <add key="Scenario3.doc" value="Hybrid3"/>
</appSettings>
</configuration> 
```

这行得通吗？如何检索数据？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-04T16:32:49.703

直接来自[文档](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings%28v=vs.100%29.aspx)：

```
using System.Configuration;

// Get the AppSettings section.        
// This function uses the AppSettings property
// to read the appSettings configuration 
// section.
public static void ReadAppSettings()
{
  try
  {
    // Get the AppSettings section.
    NameValueCollection appSettings = ConfigurationManager.AppSettings;

    // Get the AppSettings section elements.
    Console.WriteLine();
    Console.WriteLine("Using AppSettings property.");
    Console.WriteLine("Application settings:");

    if (appSettings.Count == 0)
    {
      Console.WriteLine("[ReadAppSettings: {0}]",
      "AppSettings is empty Use GetSection command first.");
    }
    for (int i = 0; i < appSettings.Count; i++)
    {
      Console.WriteLine("#{0} Key: {1} Value: {2}",i, appSettings.GetKey(i), appSettings[i]);
    }
  }
  catch (ConfigurationErrorsException e)
  {
    Console.WriteLine("[ReadAppSettings: {0}]", e.ToString());
  }
} 
```

所以，如果你想访问设置`Scenario1.doc`，你可以这样做：

`var value = ConfigurationManager.AppSettings["Scenario1.doc"];`

编辑：

正如 Gabriel GM 在评论中所说，您必须添加对`System.Configuration`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T22:58:41.070

app.config 中的应用程序设置用于存储应用程序/环境特定设置，而不是存储绑定到 UI 的数据。

如果您因为奇怪的业务请求而无法避免存储在配置中，我宁愿坚持一个单一的设置

```
<add key="FileDropDown" value="File1-Value|File2-Value" /> 
```

并编写 C# 代码来获取此设置`ConfigurationManager.AppSettings["FileDropDown"]`并执行一些字符串拆分 ('|') 和 ('-') 以创建 kvp 集合并将其绑定到 UI。

# c# - 如何在安装时访问主目录和自动创建目录

> ID：12731684
> 
> 赞同：-2
> 
> 时间：2012-10-04T16:29:46.977
> 
> 标签：c#, windows-8, microsoft-metro, windows-runtime

我想在安装过程和用户​​主目录中创建一个包含一些配置文件的目录。我的问题是：

-> 安装时如何创建这个目录

-> 如何从 C# 代码访问主目录

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:38:46.013

您可以访问您的应用程序的一些特殊文件夹。您可以像这样将文件保存到 LocalFolder：

```
var file = await ApplicationData.Current.LocalFolder.CreateFileAsync("config.txt", CreationCollisionOption.ReplaceExisting);
await FileIO.WriteTextAsync(file, "Text to write to file"); 
```

然后检索它：

```
file = await ApplicationData.Current.LocalFolder.GetFileAsync("config.txt"); 
```

如果用户在另一台设备上使用您的应用程序，还有一个 RemoteFolder 用于存放您希望用户可用的文件。

可以通过转到“C:\Users\USERNAME\AppData\Local\Packages”之类的内容找到此文件夹，然后找到您的应用程序的文件夹。

# macos - App config for Cocoa applications?

> ID：12731695
> 
> 赞同：3
> 
> 时间：2012-10-04T16:30:37.370
> 
> 标签：macos, cocoa, config

Does anyone know if Cocoa has anything similar to .NET app.config file? I was looking at nib files, but I think it's a bit different?! Thank you!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:35:12.463

是的，由 xcode 为任何新应用程序创建的 Appname-Info.plist。请参阅[https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/PropertyLists/index.html](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/PropertyLists/index.html)

然后，您可以使用...访问属性

```
NSBundle* bundle = [NSBundle mainBundle];
NSString* property = [bundle objectForInfoDictionaryKey:@"keyname"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T18:22:36.627

考虑使用也可以通过“defaults”命令从命令行读取/写入的 NSUserDefaults。

# facebook - Can we track an image uploaded in Facebook?

> ID：12731696
> 
> 赞同：2
> 
> 时间：2012-09-19T01:17:55.330
> 
> 标签：facebook, image, tracking

This is the case, if we can track the images that we upload to the facebook page in order to known who download the images and located maybe the IP or the user profile.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T09:10:13.540

You'd need to create a custom Facebook application that grabs user information based on the Facebook open graph for this. Users will have to allow your application to access their data first though. there is no way to track user information simply by uploading a photo on your wall/photo albums

# c++ - Vector3 Matrix Multiplication

> ID：12731704
> 
> 赞同：1
> 
> 时间：2012-10-04T16:31:15.353
> 
> 标签：c++, vector, matrix-multiplication

Lets say we have:

```
Vector3 vec;//has some random values
Matrix4x4 mat;//has some random values as well 
```

Now I want to multiply them to get a Vector3 out of it.

```
Vector3 mult = vec * mat; 
```

Would this function fulfill that:

```
void Matrix4x4::Transform( Vector3 &oPoint )
{
    float fX = oPoint.GetX();
    float fY = oPoint.GetY();
    float fZ = oPoint.GetZ();

    oPoint.SetX( fX * this->matrix[0][0] + fY * this->matrix[0][1] + fZ * this->matrix[0][2] + this->matrix[0][3]);
    oPoint.SetY( fX * this->matrix[1][0] + fY * this->matrix[1][1] + fZ * this->matrix[1][2] + this->matrix[1][3]);
    oPoint.SetZ( fX * this->matrix[2][0] + fY * this->matrix[2][1] + fZ * this->matrix[2][2] + this->matrix[2][3]);
} 
```

If not, can you lead me in the right direction.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:38:27.440

你的代码似乎没问题。我假设，当您使用 OpenGL 时，您的矩阵按列优先顺序排列，并且当您想在 4x4 矩阵上乘以大小为 3 的向量时，您的第四个向量坐标为`1`.

但是，由于您显然是在做计算机图形学，由于同质坐标，您应该使用大小为 4 的向量。我也不太明白，为什么要在矩阵上乘向量，反之亦然。

# .net - In .NET remoting, are both clientProvider and serverProvider required on the server side

> ID：12731705
> 
> 赞同：1
> 
> 时间：2012-10-04T16:31:17.603
> 
> 标签：.net, app-config, remoting

In many, many articles and samples online you see config files for the server side of a .NET remoting application like this:

```
<configuration>
  <system.runtime.remoting>
   <application>
     <channels>
      <channel ref="http" port="9999">
        <serverProviders>
          <provider ref="wsdl" />
          <formatter ref="soap" typeFilterLevel="Full" />
          <formatter ref="binary" typeFilterLevel="Full" />
        </serverProviders>
        <clientProviders>
         <formatter ref="binary" />
        </clientProviders>
      </channel>
     </channels>
     <service>
      <wellknown
        type="General.Shared, General"
        objectUri="Shared.soap"
        mode="Singleton"
        />
     </service>
   </application>
  </system.runtime.remoting>
</configuration> 
```

Note that the client provider configuration info. (Just one of the many samples found online).

**What purpose does any client-related remoting configuration serve on the server/service side? Assuming the service uses no callbacks, is the client configuration needed at all?**

(Please note, this is in regards to debugging a legacy .NET 2.0 app that cannot be converted at this time to WCF. For now I'm trying understand this aspect of the remoting setup).

# asp.net - How to make return the result of (need to bind image to view) webapi to getjson?

> ID：12731708
> 
> 赞同：0
> 
> 时间：2012-10-04T16:31:22.673
> 
> 标签：asp.net, image-processing, asp.net-web-api, asyncfileupload

I am working on webapi. I had optimized the images and saving in folder here. I had uploaded images into one folder before uploading in to the destination folder.

I am optimizing a single image in to 3 different sizes (large, thumbnail, medium) but image sizes are saved in one folder, now I need to make return those images to view page and bind to view page. How can I do that? I am new to webapi.

Here my controllers

```
 public Task<HttpResponseMessage> Post()
        {
            if (!Request.Content.IsMimeMultipartContent("form-data"))
            {
                throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
            }

            var uploadFolder = HostingEnvironment.MapPath("~/App_Sprites/UploadFolder");
            uploadFolder = Path.Combine(uploadFolder, DateTime.Now.ToString("yyyyMMddhhmmssfff"));
            Directory.CreateDirectory(uploadFolder);
            var streamProvider = new PreserveFilenameMultipartFileStreamProvider(uploadFolder);

            return Request.Content.ReadAsMultipartAsync(streamProvider).ContinueWith(t =>
            {
                foreach (var uploadedFile in Directory.GetFiles(uploadFolder))
                {
                    var thumbnail = Path.Combine(uploadFolder, "thumb-" + Path.GetFileName(uploadedFile));
                    var medium = Path.Combine(uploadFolder, "medium-" + Path.GetFileName(uploadedFile));
                    var large = Path.Combine(uploadFolder, "large-" + Path.GetFileName(uploadedFile));
                    ImageTools.Resize(uploadedFile, thumbnail, 80, 80);
                    ImageTools.Resize(uploadedFile, medium, 48, 48);
                    ImageTools.Resize(uploadedFile, large, 128, 128);
                }
                return Request.CreateResponse(HttpStatusCode.Accepted);
            });
        }
    } 
```

and my class file

```
public class ImageTools
    {
        public static void Resize(string original, string output, int width, int height)
        {
            using (var image = Image.FromFile(original))
            using (var thumbnail = new Bitmap(width, height))
            using (var graphics = Graphics.FromImage(thumbnail))
            {
                graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
                graphics.SmoothingMode = SmoothingMode.HighQuality;
                graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;
                graphics.CompositingQuality = CompositingQuality.HighQuality;

                graphics.DrawImage(image, 0, 0, width, height);

                ImageCodecInfo[] info = ImageCodecInfo.GetImageEncoders();
                EncoderParameters encoderParameters;
                encoderParameters = new EncoderParameters(1);
                encoderParameters.Param[0] = new EncoderParameter(Encoder.Quality, 100L);
                thumbnail.Save(output, info[1], encoderParameters);
            }
        }
    } 
```

and class file for save

```
public class PreserveFilenameMultipartFileStreamProvider : MultipartFileStreamProvider
        {
            public PreserveFilenameMultipartFileStreamProvider(string rootPath)
                : base(rootPath)
            {
            }

            public override string GetLocalFileName(HttpContentHeaders headers)
            {
                return headers.ContentDisposition.FileName.Replace("\"", "");
            }
        } 
```

finally my layout page

```
@using (Html.BeginRouteForm("DefaultApi", new { httproute = "", controller = "Upload" }, FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    <input type="file" name="image" multiple="multiple" accept="image/*" />
    <button type="submit">Upload</button>
} 
```

Here I had the images in folder now I need to save those images as well. I need bind those in my layout page how could I do that?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T15:43:47.043

就上述问题而言，我有一个示例视图，可以帮助更多人关注并寻找上述问题来实现您的工具的编码

[http://www.codeproject.com/Articles/379980/Fancy-ASP-NET-MVC-Image-Uploader?msg=4389108#xx4389108xx](http://www.codeproject.com/Articles/379980/Fancy-ASP-NET-MVC-Image-Uploader?msg=4389108#xx4389108xx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T06:17:27.703

就上述问题而言，没问题，我认为它会随着质量选项的增加而增加，您只需要做简单的事情，只需降低质量即可上传图片并检查一次

```
 public static void Resize(string original, string output, int width, int height)
        {
            using (var image = Image.FromFile(original))
            using (var thumbnail = new Bitmap(width, height))
            using (var graphics = Graphics.FromImage(thumbnail))
            {
                graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
                graphics.SmoothingMode = SmoothingMode.HighQuality;
                graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;
                graphics.CompositingQuality = CompositingQuality.HighQuality;

                graphics.DrawImage(image, 0, 0, width, height);

                ImageCodecInfo[] info = ImageCodecInfo.GetImageEncoders();
                EncoderParameters encoderParameters;
                encoderParameters = new EncoderParameters(1);
                encoderParameters.Param[0] = new EncoderParameter(Encoder.Quality, 80L);
                thumbnail.Save(output, info[1], encoderParameters);
            }
        } 
```

# php - How do I create a simple vote up / down php script in php?

> ID：12731711
> 
> 赞同：0
> 
> 时间：2012-10-04T16:31:39.413
> 
> 标签：php, mysql, voting, voting-system

I want a simple non-MySQL PHP script that allows viewers to vote up or vote down a page. If it has to be MySQL database driven, then that's just how it has to be. Ideally, not though.

So basically if you were to view source of this page in a web browser it would look something like this:

```
<h2>Stack Overflow Is Cool</h2>
<span id="author-info-etc">Written by Ben Dover on 01-01-2012 (+12) | (-3) Total Rank: +9</span>
<p>Once upon a time there was this really cool website called Stack Overflow where amazing people would help answer questions asked by people who destroyed their keyboards by throwing them against their computer screen in an act of utter frustration and despair.</p> 
```

And the source file would look like this:

```
<span id="author-info-etc">Written by <?php echo $authorname; ?> on <?php echo $pubDate; ?> <?php include ('pagevotescript.php'); ?></span> 
```

Could someone help me to create this PHP script?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:39:00.070

如果你想要一个可靠的投票系统，你需要使用 MySQL 等数据库来存储投票。否则，你的 web 应用程序如何知道一个页面收到了多少票？

您的数据库结构可能如下所示：

**页面**

```
page_id | page_name
-------------------
1       | My Page
2       | Test 
```

**用户**

```
user_id | user_name
-------------------
1       | John     
2       | Sara
3       | Tom 
```

**投票**

```
vote_id | user_id | page_id | vote_weight
-----------------------------------------
1       | 1       | 1       |  1
2       | 1       | 2       | -1
3       | 2       | 2       |  1
4       | 3       | 1       |  1 
```

当用户投票时：

1.  检查他们是否已经在页面上投票。
2.  如果是这样，要么拒绝他们再次投票，要么更新他们现有的投票。
3.  如果他们没有在相关页面上投票，请插入新的投票。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:39:33.367

将页面数据存储在 MySQL 中是最简单的，并且只有一个名为 votes 的列。这样，您可以同时显示页面并拉取投票，并且可以在用户交互时轻松地提高/降低投票。

如果没有 MySQL，您需要将值存储在某个文件中。你可以有 about-us.php，然后是 about-us.php.txt，其中 txt 文件将是一个简单的 # 可以检索，然后更改和重置。像这样的东西：

```
// Open file for reading and writing
$fp = fopen('about-us.php.txt', 'w+');

//Retrieve contents of file as integar
$count = (int) fread($fp, filesize('about-us.php.txt'));

// Take the count and up it by 1
$count++;

// Write the changes
fwrite($fp, $count);

// Close the file
fclose($fp); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:39:46.557

您希望拥有一个包含用户和帖子的数据库。用户应该能够对帖子进行投票，增加或减少用户的“声誉”计数。要存储所有这些信息，您已经需要一个数据库。

如果您仍然想将“投票”信息存储在 mysql 数据库之外的其他东西中，那么有很多选择。[text file](http://php.net/manual/de/ref.filesystem.php)、[NoSQL](http://en.wikipedia.org/wiki/NoSQL)、[Couchdb](http://en.wikipedia.org/wiki/Couchdb)和许多其他选项。

您将更容易学习如何与数据库进行通信，然后执行诸如将信息存储在文件中之类的事情。而且由于 mysql 是最常用的数据库，这将是一个相当明智的选择。

***PS：***如果你开始学习 mysql，你绝对不应该开始使用 PHP`mysql_`函数，而[应该使用PDO](http://www.php.net/manual/en/book.pdo.php)之类的东西来规避[SQL 注入。](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:38:57.997

您需要一种在会话之间**持久**保存数据的方法，因此您需要一个数据库，如果您不想安装 mysql，我认为 PHP 的最新版本内置了[**sqlite支持。**](http://www.php.net/manual/en/intro.sqlite.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T17:49:51.197

技术含量低的方法是使用带有 PHP 的键值存储来存储您的值。一个例子是`dba_*`PHP 中的函数，如[dba_open](http://php.net/manual/en/function.dba-open.php)，它创建一个行为类似于任何常规文件的单文件数据库，不需要服务器。

例子：

```
$db = dba_open("stats", "r", "gdbm");
$count = dba_fetch("/page/path", $db);
dba_insert("/page/path", $count + 1, $db); 
```

请注意，这将受到微妙的竞争条件的影响，其中两个或多个同时请求将获取并保存相同的增量值。使用适当的数据库，甚至[是嵌入式 SQLite](http://ca3.php.net/manual/en/book.sqlite.php)，将是一个更好的主意。

# crystal-reports - Crystal Reports：将不同的部分放在一起

> ID：12731714
> 
> 赞同：5
> 
> 时间：2012-10-04T16:31:41.797
> 
> 标签：crystal-reports

是否可以将不同的 Crystal Reports 部分放在一起？我有以下设置：

```
Group
Details 
```

我想要的是组始终与其详细信息显示在同一页面上。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-04T17:54:23.817

请执行下列操作：

*   右键单击组标题部分，然后选择“更改组”
*   在底部，选择“保持组在一起”和“在每页上重复组标题”

您的组标题现在应该在每一页上重复，并且它们都应该在同一页面上组合在一起（因此您不应该在页面底部有组标题，然后详细信息从下一页开始）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-01T06:41:34.933

感谢您的回答@LittleBobbyTables

但是对于 Crystal Reports 10 及更高版本，我发现了一些不同的选项

*   右键单击组标题部分，然后选择**“组专家”**
*   单击**选项..**
*   选择**选项选项**卡
*   选中**“保持组在一起”**复选框
*   选中**“在每一页上重复组页眉”**复选框（*如果你想在每一页上重复组页眉*）

# c# - 如何访问 DataGridTemplateColumn 中的 Combobox.ItemSource 属性

> ID：12731719
> 
> 赞同：0
> 
> 时间：2012-10-04T16:32:01.783
> 
> 标签：c#, wpf, xaml

如果我在 XAML 中有 DataGridComboBoxColumn

```
<DataGridComboBoxColumn Header="Department Id" x:Name="comboboxColumn1" 
```

我可以使用在代码中引用 comboboxColumn1.Itemsource

```
comboboxColumn1.ItemsSource = comboboxSource; 
```

如果我现在改用 DataGridTemplateColumn ......

```
<DataGridTemplateColumn x:Name="Col2" Header="name">
    <DataGridTemplateColumn.CellTemplate>
        <DataTemplate>
            <ComboBox x:Name="Combobox2" />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
    </DataGridTemplateColumn>
</DataGrid.Columns> 
```

然后如何在代码中设置 Combobox2.ItemSource ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:05:54.887

它*必须*在代码后面吗？

您正在构建一个`DataTemplate`，它是每当 WPF 需要呈现该特定 DataGridCell 时使用的模板。因此，您的 ComboBox 永远不会有一个实例，而是与您显示的 DataGridCells 一样多的实例（这就是您实际上不能按名称引用该项目的原因）。

如果我*必须*在代码隐藏中设置`ItemsSource`，我只需`Loaded`在 ComboBox 上放置一个事件并将其设置在那里。

或者，如果`ItemsSource`不是静态的，那么您可以使用[ItemContainerGenerator](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.aspx)来获取特定 DataGrid 项的模板，并通过它找到它。

但实际上，您应该`ItemsSource`使用a或绑定`StaticResource`在 XAML 中设置如果绝对必须使用代码隐藏。`RelativeSource``ElementName``ItemsSource`

此外，工作的原因`comboboxColumn1.ItemsSource = comboboxSource;`是因为您正在设置`DataGridComboBoxColumn.ItemsSource`，而不是`ComboBox.ItemsSource`，并且只有一个名为`comboboxColumn1`

# merge - php中的合并时间

> ID：12731721
> 
> 赞同：1
> 
> 时间：2012-10-04T16:32:07.787
> 
> 标签：merge, mergesort, php

我正在尝试找到合并时间的最佳方式......按照用户有两件事的时间表工作：

X 天的可用性和分配的时间。

两者的结构相同，看起来像这样：

对于特定日期，让我们说（2012-10-07）可用性：

```
[2012-10-07]
             [0][start_time] => 08:30
                [end_time]   => 13:30

             [1][start_time] => 16:30
                [end_time]   => 23:30 
```

现在对于那个特定的日子，他可能会被分配，我的查询结果如下：

```
 [2012-10-07][0][start_time] => 08:30
                [end_time]   => 09:30

             [1][start_time] => 10:30
                [end_time]   => 11:30

             [2][start_time] => 17:00
                [end_time]   => 18:30 
```

合并的结果应如下所示：

```
 [2012-10-07] [0][start_time]=> 08:30
                 [start_time]=> 09:30
                 [assigned]=> true

              [1][start_time]=> 09:30
                 [start_time]=> 10:30
                 [assigned]=> false

              [2][start_time]=> 10:30
                 [start_time]=> 11:30
                 [assigned]=> true

              [3][start_time]=> 11:30
                 [start_time]=> 13:30
                 [assigned]=> false

              [4][start_time]=> 16:30
                 [start_time]=> 17:00
                 [assigned]=> false

              [5][start_time]=> 16:30
                 [start_time]=> 17:00
                 [assigned]=> false

              [6][start_time]=> 17:00
                 [start_time]=> 18:30
                 [assigned]=> true

              [7][start_time]=> 18:30
                 [start_time]=> 23:30
                 [assigned]=> false 
```

现在，当在日历上加入两者时，可用性为绿色（假）并分配为红色（分配=真）。

我所做的是循环可用性，将开始/结束时间转换为 UNIX 时间戳，然后循环每个分配的时间并转换为 UNIX 时间戳。

然后测试所有情况，如果时间在可用性范围内或在其外部，添加一个临时数组和循环，同时不对最终数组进行任何更改。

（因为每次我生成一个新时间，我都必须在指定的时间再次循环）

它有效，但我不喜欢我这样做的方式......有更好的方法吗？

**更新 ：**

对于那些想在这里查看完整工作代码的人来说，它是：

```
function removeSessionsFromSchedule($schedule,$remove){

    $modified = false;

    if(is_array($schedule) && count($schedule) > 0 && is_array($remove)  && count($remove) > 1) {

       if($modified) {
                break;
            }

       $pos = 0;
            $countdispo = count($dispo); 

        foreach($schedule as $s => $dispo) {
            $pos = 0;
            $countdispo = count($dispo);
            foreach($dispo as  $d) {
                $abs = $remove[$s];
                $counter = 0;
                // dispo debut/end
                $dis_s = strtotime($d['heure_debut']);
                $dis_e = strtotime($d['heure_fin']);
                if(is_array($abs) && count($abs) > 0) {
                    foreach($abs as $a) {
                        // absence start/end
                        $abs_s = strtotime($a['heure_debut']);
                        $abs_e = strtotime($a['heure_fin']);
                        // (2) [a_s]---[ds - de]---[a_e]
                        if($abs_s <= $dis_s && $abs_e >= $dis_e) {
                            // delete availabilities
                            unset($schedule[$s][$pos]); 
                            $modified = false;
                        }
                        // (7)[as == ds] && [ae < de]
                        else if($abs_s == $dis_s && $abs_e < $dis_e) {
                                unset($schedule[$s][$pos]);
                                $schedule[$s][$pos] = $d;
                                $schedule[$s][$pos]['heure_debut'] = date("H:i",$abs_e);
                                $schedule[$s][$pos]['heure_fin']   = date("H:i",$dis_e);
                                $modified = true;
                                break;
                            }
                            // (6) [ds -de] --- [as  ae] return dispo as is
                            else if($abs_s >= $dis_e){
                                    unset($schedule[$s][$pos]);
                                    $schedule[$s][$pos] =$d;
                                    $modified = false;
                                }
                                // (5)[as  ae] [ds -de] ---  return dispo as is
                                else if($abs_e <= $dis_s){
                                        unset($schedule[$s][$pos]);
                                        $schedule[$s][$pos]= $d;
                                        $modified = false;
                                    }
                                    // (1)[ds] --- [as] --- [ae] --- [de] (duplicate dis with new times)
                                    else if($abs_s > $dis_s && $abs_e <= $dis_e) {
                                            // new times as : // s1 = ds-as &&  s2 = ae-de
                                            unset($schedule[$s][$pos]);
                                            $schedule[$s][$pos]   =$d;
                                            $schedule[$s][$pos+1] =$d;

                                            $schedule[$s][$pos]['heure_debut'] = date("H:i",$dis_s);
                                            $schedule[$s][$pos]['heure_fin']   = date("H:i",$abs_s);
                                            $schedule[$s][$pos + 1]['heure_debut'] = date("H:i",$abs_e);
                                            $schedule[$s][$pos + 1]['heure_fin']   = date("H:i",$dis_e); 
                                            //$pos++;
                                            $modified = true;
                                            break;
                                        }
                                        // (3)[as] -- [ds] --- [ae] -- [de]
                                        else if($abs_s < $dis_s && $abs_e < $dis_e) {
                                                unset($schedule[$s][$pos]);
                                                $schedule[$s][$pos] =$d;
                                                $schedule[$s][$pos]['heure_debut'] = date("H:i",$abs_e);  
                                                $schedule[$s][$pos]['heure_fin']   = date("H:i",$dis_e);
                                                $modified = true;
                                                break;  
                                            }
                                            // (4) [ds]---[as]--- [de]--- [ae]
                                            else if($abs_s > $dis_s && $abs_s < $dis_e && $abs_e > $dis_e) {
                                                    unset($schedule[$s][$pos]);
                                                    $schedule[$s][$pos] =$d;
                                                    $schedule[$s][$pos]['heure_debut'] = date("H:i",$dis_s);  
                                                    $schedule[$s][$pos]['heure_fin']   = date("H:i",$abs_s);
                                                    $modified = true;
                                                    break;
                                                }
                                                else {$modified = false ;}
                    }
                } else {$modified =false;} 
                $pos++; 
            } 
        }
    }
    else {$modified = false;}

    if($modified) {
        $schedule = removeSessionsFromSchedule($schedule,$remove);  
    }

    return $schedule;  
} 
```

**将合并时代的功能：**

```
 function mergeSessionFromSchedule($schedule ,$seances) {

    $sessions = removeSessionsFromSchedule($schedule,$seances);

    $mergedSessions = array_merge_recursive($sessions , $seances);

    foreach($mergedSessions as $s => $val) {
        $sortedSessions[$s] = subval_sort_by_time($val,'heure_debut'); 
    }

    return $sortedSessions ;
   } 
```

**帮手：**

```
 function subval_sort_by_time($a,$subkey) {
        foreach($a as $k=>$v) {
        $b[$k] = strtotime($v[$subkey]);
        }
    asort($b);
    foreach($b as $key=>$val) {
        $c[] = $a[$key];
    }
    return $c; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T21:06:21.710

这是我的解决方案：

```
<?php

class SessionHandler {
    private $keys   = array();
    private $times  = array();
    private $slots  = array();
    private $merged = array();

    function __construct($available, $assigned) {
        $this->times = array(
            'available' => $available,
            'assigned'  => $assigned
        );
        $this->slots = array(
            'available' => array(),
            'assigned'  => array(),
            'excluded'  => array()
        );
        $this->getKeys($this->times['available']);
        $this->loadSessions($this->keys[0], $this->keys[1]);
    }

    private function getKeys($arr) {
        if (count($arr)) {
            $this->keys = array_keys($arr[0]);
        } else {
            throw new Exception('Invalid array format');
        }
    }

    private function loadSessions($start, $end) {
        foreach ($this->times as $type => $periods) {
            foreach ($periods as $hours) {
                $this->slots[$type][] = $hours[$start].'-'.$hours[$end];
                $this->merged[] = strtotime($hours[$start]);
                $this->merged[] = strtotime($hours[$end]);
            }
        }
        $this->merged = array_unique($this->merged);
        sort($this->merged);

        $hours = $this->times['available'];
        for ($i = 0; $i < count($hours) - 1; $i++) {
            $this->slots['excluded'][] = $hours[$i][$end].'-'.$hours[$i + 1][$start];
        }
    }

    public function mergeSessions() {
        $result = array();
        for ($i = 0; $i < count($this->merged) - 1; $i++) {
            $start_hour = date('H:i', $this->merged[$i]);
            $end_hour   = date('H:i', $this->merged[$i + 1]);
            $slot = $start_hour . '-' . $end_hour;
            if (!in_array($slot, $this->slots['excluded'])) {
                $assigned = in_array($slot, $this->slots['assigned']);
                $result[] = array(
                    $this->keys[0] => $start_hour,
                    $this->keys[1] => $end_hour,
                    'assigned' => $assigned ? "true" : "false"
                );
            }
        }
        return($result);
    }
}

$availability = array(
    '2012-10-07' => array(
        array('start_time' => '08:30', 'end_time' => '13:30'),
        array('start_time' => '16:30', 'end_time' => '23:30')
    )
);

$assignments = array(
    '2012-10-07' => array(
       array('start_time' => '08:30', 'end_time' => '09:30'),
       array('start_time' => '10:30', 'end_time' => '11:30'),
       array('start_time' => '17:00', 'end_time' => '18:30')
    )
);

$sessions = array();

foreach ($availability as $day => $available) {
    $assigned = isset($assignments[$day]) ? $assignments[$day] : array();
    $SH = new SessionHandler($available, $assigned);
    $sessions[$day] = $SH->mergeSessions();
}

?>
<!DOCTYPE html>
<html>
    <body>
        <pre><?php print_r($sessions) ?></pre>
    </body>
</html> 
```

# wpf - 如何获取边框边距的值？

> ID：12731722
> 
> 赞同：0
> 
> 时间：2012-10-04T16:32:08.910
> 
> 标签：wpf, wpf-controls, wpfdatagrid

我是 WPF 的初学者，必须向某人的用户界面添加功能。这是代码的一部分。

```
<Border BorderBrush="Black" BorderThickness="1" Grid.Row="1" >
        <Grid Grid.Row="0">
            <Grid.RowDefinitions>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition></ColumnDefinition>
                <ColumnDefinition Width="{Binding ElementName=passFailIndicator, Path=Width}"></ColumnDefinition>
            </Grid.ColumnDefinitions>
            <Border Background="Black" local:StretchPanel.Proportion="1" Name="imageBorder" Grid.Column="0">
                <Border BorderThickness="1" Margin="2" BorderBrush="Green" HorizontalAlignment="Left" VerticalAlignment="Top" Width="{Binding ElementName=imageBorder, Path=Width}">
                    <Grid Width="{Binding ElementName=imageBorder, Path=Width}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition Width="{Binding ElementName=imageSelectExpander, Path=Width}"/>
                        </Grid.ColumnDefinitions>
                        <Image Grid.Column="0" x:Name="image" Source="{Binding DisplayImage, Mode=OneWay}" VerticalAlignment="Top" Stretch="Uniform" HorizontalAlignment="Left" StretchDirection="Both" MouseMove="image_MouseMove" />
                        <TextBlock Name="pxPos" Text="mouse position" HorizontalAlignment="Right" VerticalAlignment="Bottom" MaxHeight="20" Foreground="Aqua"></TextBlock>
                        <Expander Grid.Column="1" VerticalAlignment="Top" Name="imageSelectExpander">
                            <ComboBox x:Name="imageSelect" ItemsSource="{Binding AvailableImages, Mode=OneWay}" SelectedIndex="{Binding ImageSelect, Mode=TwoWay}" HorizontalContentAlignment="Center" VerticalContentAlignment="Center" Margin="4" Padding="4" MaxHeight="40"></ComboBox>
                        </Expander>
                    </Grid>
                </Border>
            </Border>
            <Border x:Name="passFailIndicator" Grid.Column="1" HorizontalAlignment="Left" VerticalAlignment="Center" Width="100" Height="100">
                <Viewbox Stretch="Uniform" >
                    <Path Style="{Binding TestResult, Mode=OneWay, Converter={StaticResource testResultToPathStyle}}" Margin="2" />
                </Viewbox>
            </Border>
        </Grid>
    </Border> 
```

我正在尝试访问第 10 行的 Margin="2"。当我使用 this.imageBorder.Margin 时，我得到 {0,0,0,0}。我将如何获得 2（当然，这个值可能会改变）？

谢谢

编辑：

```
FrameworkElement fe = (FrameworkElement)this.imageBorder.Child;
            pxPos.Text = (string.Format("x:{0} y:{1}", (int)((double)(pt.X - fe.Margin.Left) * (double)this.image.Source.Width / this.image.ActualWidth), (int)((double)(pt.Y - fe.Margin.Top)*(double)this.image.Source.Height / this.image.ActualHeight))); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:50:41.327

标记的 Border`imageBorder`没有将其`Margin`属性设置为任何值，因此您将获得默认值`Margin`，即 0。

要在命名边框内获取 Border 的 Margin 属性，请给它一个`x:Name`以便您可以在后面的代码中访问它，或者查看`imageBorder.Child`属性以找到子 Border 对象，然后将其强制转换为 a`FrameworkElement`以获取其 Margin 属性。

至于你为什么得到`{0,0,0,0}`，[Margin](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.margin.aspx)属性的类型是[Thickness](http://msdn.microsoft.com/en-us/library/system.windows.thickness.aspx)，它由 Left、Top、Right 和 Bottom 的属性组成。如果您将边距设置为单个值，例如 2，它会自动将其转换为`Thickness`所有 4 个属性都设置为 2 的对象。

# amazon-s3 - Can you tag individual S3 objects in AWS?

> ID：12731728
> 
> 赞同：14
> 
> 时间：2012-10-04T16:32:35.560
> 
> 标签：amazon-s3, amazon-web-services, tagging, billing

It appears as though I can only use tags at the bucket level in S3\. That seems to make sense in a way, because you would likely only do billing at that kind of macro level. However, I can see a few use cases for tagging so that different folks get billed for different objects in the same bucket.

Can you tag individual S3 objects?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-12-01T05:24:24.977

对象标记是一项新功能，于 2016 年 12 月宣布。来自[公告](https://aws.amazon.com/about-aws/whats-new/2016/11/revolutionizing-s3-storage-management-with-4-new-features/)：

> 借助 S3 对象标记，您可以管理和控制对 Amazon S3 对象的访问。S3 对象标签是应用于 S3 对象的键值对，可以在对象的生命周期内随时创建、更新或删除。有了这些，您将能够创建身份和访问管理 (IAM) 策略、设置 S3 生命周期策略和自定义存储指标。然后，这些对象级标签可以在后台管理存储类和过期对象之间的转换。

另请参阅：[S3 » 对象 » 对象标记](http://docs.aws.amazon.com/AmazonS3/latest/dev/object-tagging.html)

目前，您似乎无法[按标签搜索](http://docs.aws.amazon.com/AmazonS3/latest/API/v2-RESTBucketGET.html)，或者对象标签会影响计费。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-05T05:23:44.830

出于 AWS 端计费的目的，它不是“标记”，但您可以使用对象元数据来存储您想要的对象数据。

[http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingMetadata.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingMetadata.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T20:45:32.573

根据[文档](http://docs.amazonwebservices.com/AmazonS3/latest/dev/BucketBilling.html)，您只能标记存储桶：

> 成本分配标记允许您标记 S3 存储桶，以便您可以更轻松地根据项目或其他标准跟踪其成本。

它与您在管理控制台和 SDK 文档中看到的一致。

当然，您可以使用文件夹/对象元数据自己进行更精细的“标记”，但我认为您会找到更好的解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-05-05T12:40:32.193

现在，我们可以为每个对象添加标签。使用 AWS S3API，

```
aws s3api put-object-tagging --bucket bucket_name --key key_name --tagging 'TagSet=[{Key=type,Value=text1}]' 
```

我们还可以使用 python API 为对象添加标签。以下代码段将标签添加到存储桶中的所有对象。如果您只想将标签添加到一个对象，则可以传递对象名称。

```
session = aws_session.set_aws_session()

s3 = boto3.Session(aws_access_key_id, aws_secret_access_key)

bucketName = 'bucketName'
bucket = s3.Bucket(bucketName)

object_list = bucket.objects.all()

s3 = session.client('s3')

tagging = {'TagSet' : [{'Key': 'CONF', 'Value':'No'}]}

for obj in object_list:
    s3.put_object_tagging(
        Bucket = bucketName,
        Key = obj.key,
        Tagging = tagging
        ) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-12-26T11:07:35.423

S3 标签是 2016 年 11 月 29 日发布的新功能。标签可以添加到存储桶和单个对象上。S3 标签是令人兴奋的功能，因为您可以保留业务分类数据，甚至控制访问。[s3 标签功能的发布](https://aws.amazon.com/about-aws/whats-new/2016/11/revolutionizing-s3-storage-management-with-4-new-features/) s3 标签可以使用浏览器中的新 s3 控制台添加。要从浏览器添加标签，假设您在新的 s3 控制台上。选择项目 --> 更多 --> 添加标签。

[![使用新控制台添加标签。](../Images/96acd18c4530ad1bc7d54235729191c6.png)](https://i.stack.imgur.com/nXJJK.png)

要查看标签，请使用新控制台单击对象并查看属性。 [![使用新控制台查看标签。](../Images/a2c6ef5ad19d443165931afa8bee6990.png)](https://i.stack.imgur.com/BLUxm.png)

Aws S3 cli 当前不支持标签功能。Aws s3 api 提供了在对象上添加和读取标签的方法。[使用 s3 api 添加标签](http://put%20object%20tag)，使用 s3 api[获取标签](http://docs.aws.amazon.com/cli/latest/reference/s3api/get-object-tagging.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-20T04:28:19.807

# 是的，您可以标记对象...但不能用于成本分配：

也许区分成本分配标签和用标签标记对象很重要。引用[亚马逊文档](https://docs.aws.amazon.com/AmazonS3/latest/dev/CostAllocTagging.html)：“成本分配标签只能用于标记存储桶。有关用于标记对象的标签的信息，请参阅[对象标记](https://docs.aws.amazon.com/AmazonS3/latest/dev/object-tagging.html)”

## 标签：标记存储桶中的对象：

这些很像用户自己定义的元数据键值对：

[![标记对象](../Images/4d3cf5c54c7bac6ba36136497cd89acd.png)](https://i.stack.imgur.com/DjNI2.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-11T09:54:40.850

我认为您不能像通常标记资源一样标记 S3 中的单个项目。

但是，您可以将元数据添加到 S3 中的项目以识别它们。然后，您可以通过以下任一方式报告具有不同类型的项目： - 对存储桶中的项目进行分页（显然相当慢）并整理您想要的有关它们的任何信息 - 在您选择的数据库中存储一个外部元数据，然后您可以使用它运行报告。例如有多少不同类型的项目，总大小等。​​当然，您要报告的任何内容都必须首先添加到数据库中

不过，我肯定会对任何更好的解决方案感兴趣！

# wordpress - Wordpress：将页面内容加载到自定义模板/主题中

> ID：12731729
> 
> 赞同：1
> 
> 时间：2012-10-04T16:32:40.407
> 
> 标签：wordpress, themes, loaded

我使用 Starkster 从头开始​​创建了一个自定义主题，以获取**没有帖子/评论**的静态 wordpress 版本。此外，我在 Wordpress 中添加了六页内容，其中包含一些单词。

因此，设计工作到现在为止，但我无法将这些页面的内容加载到网站/浏览器中。一个 DIV 在 header.php 中打开并在 footer.php 中关闭，我想，内容会在两者之间加载。

这就是现在使用的：

索引.php：

```
<?php get_header(); ?>
<?php get_footer(); ?> 
```

页面.php：

```
<?php get_header(); ?>
<?php the_content(); ?>
<?php get_footer(); ?> 
```

header.php：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title><?php bloginfo( 'name' ); ?><?php wp_title( '|' ); ?></title>
<meta charset="<?php bloginfo( 'charset' ); ?>" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- REmove if you're not building a responsive site. (But then why would you do such a thing?) -->
<link rel="pingback" href="<?php bloginfo( 'pingback_url' ); ?>" />
<link rel="shortcut icon" href="<?php echo get_stylesheet_directory_uri(); ?>/img/favicon.ico"/>
<?php wp_head(); ?>
</head>
<body <?php body_class(); ?>>
<div id="oben"></div>
<div id="naviwrap">
<div id="titel"><h1 class="titelbutton"><a href="http://www.studio-scs.de">Coach</a></h1></div>
<div id="navigation">
<a class="navibutton" href="/" title="START">START</a>
<a class="navibutton" href="/coaching/" title="COACHING">COACHING</a>
<a class="navibutton" href="/termine/" title="TERMINE">TERMINE</a>
<a class="navibutton" href="/person/" title="PERSON">PERSON</a>
<a class="navibutton" href="/kontakt/" title="KONTAKT">KONTAKT</a> 
<a class="navibutton" href="/impressum/" title="IMPRESSUM">IMPRESSUM</a>
</div>
</div>
<div class="clearer"></div>
<div id="wrap" class="inhaltverlauf">
<div id="blocker"></div>
<div id="inhalt"> 
```

页脚.php：

```
</div>
<div class="clearer"></div>
</div>
<div id="farbhintergrund" class="farbverlauf"></div>
<?php wp_footer(); ?>
</body>
</html> 
```

您可以在这里查看：studio-scs.de

* * *

Elias 帮了我很大的忙，但还有另一个问题。和

页面.php

```
<?php get_header(); ?>

<?php if (have_posts()) : while (have_posts()) : the_post();?> 
<?php the_content(); ?> 
<?php endwhile; endif; ?> 

<?php get_footer(); ?> 
```

我已经删除了所有我想要的帖子，但是如果我现在想在其中一个页面（例如 Termine）上恢复发布功能，以便有可能添加新日期等等，我该怎么做?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:45:28.117

`the_content`没有查询就不能使用。

将您的行替换`the_content()`为以下内容：

```
<div id="content" class="widecolumn">
 <?php if (have_posts()) : while (have_posts()) : the_post();?>

 <h2 id="post-<?php the_ID(); ?>"><?php the_title();?></h2>

  <?php the_content(); ?>

 <?php endwhile; endif; ?>
 <?php edit_post_link('Edit this entry.', '<p>', '</p>'); ?>
</div> 
```

# wpf - 新手学习如何正确使用带有 wpf、mvvm 的 IoC，以及跟踪用于 DataTemplates 的 CurrentView 属性

> ID：12731731
> 
> 赞同：1
> 
> 时间：2012-10-04T16:32:41.750
> 
> 标签：wpf, mvvm, views, autofac

我正在尝试学习如何正确使用 Autofac 与 wpf 接口和 mvvm 场景，并将我的 mainWindow 上的内容控件绑定到 mainViewModel 的“CurrentView”属性，但我不知道我是否应该这样做具体的 BaseViewModel 类，或者我是否应该将 CurrentView 属性作为接口？我想在我的 MainWindowViewModel 构造函数中设置 CurrentView 属性。

简单定位器：

```
public class ViewModelLocator
{
    public IContainer Container { get; set; }

    public IMainWindowViewModel MainWindowViewModel
    {
        get
        {
            return Container.Resolve<IMainWindowViewModel>(); 
        }
    }

    public IOtherPageViewModel OtherPageViewModel
    {
        get
        {
            return Container.Resolve<IOtherPageViewModel >();
        }
    }
} 
```

坐在我的 MainWindow.xaml

```
 <ContentControl 
    Content="{Binding Path=CurrentView}"
    Grid.Row="0"  
    VerticalContentAlignment="Stretch"
    VerticalAlignment="Stretch"
    HorizontalAlignment="Stretch"
    HorizontalContentAlignment="Stretch" >
</ContentControl> 
```

MainWindowViewModel ***这是我关心的问题，baseViewModel 不应该是一个具体的，我应该在这里实现一个接口，或者当你需要为多个 viewModels 显示不同的视图时，设置 currentView 的正确方法是什么？我问是因为我想让 Autofac 在 MainWindowViewModel 构造函数中注入我的当前视图。这可能吗？

```
 private baseViewModel currentView;
    public baseViewModel CurrentView
    {
        get
        {
            return currentView;
        }
        set
        {
            currentView = value;
            NotifyPropertyChanged(m => m.CurrentView);
        }
    } 
```

过去我在视图上使用了 baseViewModels 和 datatemplates，但我不知道这是否是一个合理的实现

# javascript - jQuery用 $(selector).prop 改变 src 需要很长时间

> ID：12731732
> 
> 赞同：6
> 
> 时间：2012-10-04T16:32:43.557
> 
> 标签：javascript, jquery, html, selector, image

所以这个代码功能本身没有问题。我有这样的事情：

```
<div>
    <div><img id="imageToChange" src="/path/image.png" /></div>
    <div id="textToChange">Text</div>
</div> 
```

我有另一部分代码，它用 jQuery 更改图像 src/text。

```
function changeImage() {
    $('#imageToChange').prop('src', '/path/image2.png');
    $('#textToChange').html('New Text');
} 
```

正如您所料，这完全符合我的预期。但有1个怪癖。

在所有主要浏览器 (chrome/FF/IE) 中。图像需要很长时间才能改变。

因此，例如，当我调用 changeImage() 时，文本会立即更改，但图像可能要到*1-2 秒后*才会更改。（无论如何都不是大图像，大约 6KB 和本地）

我还没有发现其他人真的在抱怨它，但我想知道是否有任何方法可以加快图像 src 的更改？也许有更好的方法来做到这一点？

这也是 jquery 1.8.0。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:43:50.050

You may want to try altering the attribute using the jquery `.attr` function. If I recall correctly the `src` tag of an image is an attribute not a property. Although both `.prop` and `.attr` do relatively the same function, to ensure consistent behavior between browsers you may want to use the `.attr` tag instead.

```
$('#imageToChange').attr('src', '/path/image2.png'); 
```

As far as the delay goes, this could be due to the size of the image. The browser has to make a GET request to the server for the image and then paint the DOM with it. If the image is large, it could cause a time lapse between when the code changes the source and when the new image is properly written to the DOM. If the image is large, you may want to consider scaling it down or optimizing it for web use.

Hope this helps.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T16:39:28.357

我以前见过这种行为。延迟是由于图像没有被缓存以及随后的加载时间造成的。我知道的唯一解决方案：

1.  使用 JavaScript Image 对象预加载您的图像。
2.  处理图像上的[加载事件](http://api.jquery.com/load-event/)并在图像加载后更新文本。注意 jQuery 列出了一些需要注意的问题：

> 与图像一起使用时加载事件的注意事项
> 
> 开发人员尝试使用 .load() 快捷方式解决的一个常见挑战是在图像（或图像集合）完全加载时执行一个函数。应该注意几个已知的警告。这些是：
> 
> *   它不能始终如一地工作，也不能可靠地跨浏览器
> *   如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
> *   它没有正确地冒泡 DOM 树
> *   可以停止对已经存在于浏览器缓存中的图像进行触发

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T16:41:10.773

您可以使用 Javascript Image 对象预加载图像。

在文件的开头放

```
<script type="text/javascript">
   img2 = new Image();
   img2.src = "/path/image2.png";
</script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-04T16:40:39.263

就是网络延迟。尝试这个：

```
<div>
    <div><img id="imageToChange" src="/path/image.png" /></div>
    <div id="textToChange">Text</div>
</div>
<img src='/path/image2.png' style='display:none'> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-04T16:37:30.570

这可能是您的图像的加载时间。如果是这种情况，第一次加载图像应该是唯一慢的。将图像更改为其他内容后，后续加载会很快。

```
 $('#imageToChange').prop('src', '/path/image1.png');
 //slow, need to fetch image
 $('#imageToChange').prop('src', '/path/image2.png');
 //slow, need to fetch image
 $('#imageToChange').prop('src', '/path/image1.png');
 //fast, it already has this image 
```

作为解决方案，您可以尝试预加载图像。或者，更好的是，使用[css sprites](http://css-tricks.com/css-sprites/)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-04T16:39:18.777

当您更改图像的 src 时，您会获取另一个图像文件。它对新图像发出 HTTP 请求，因此需要在显示之前加载。会是这样吗？

顺便说一句，出于这个原因，您可以使用 js 预加载图像。要么添加

```
<img src="path/to/image.jpg" style="display: none" /> 
```

到您的 html 或使用 JS

```
var im = new Image(1,1);
im.src = "path/to/image.jpg"; 
```

这样图像将被缓存

# upload - csv 文件编码会影响 salesforce 的 Dataloader 25.0.2 行为吗？

> ID：12731737
> 
> 赞同：1
> 
> 时间：2012-10-04T16:33:08.737
> 
> 标签：upload, salesforce

我一直在尝试使用 Data Loader 25.0.2 在 Salesforce 云中的对象上插入和删除一些数据。Data Loader 执行没有问题，但插入/删除没有完成。日志文件返回一些带有此错误的行：

> 2012-10-03 17:13:16,958 错误 [deleteAccount] client.PartnerClient processResult (PartnerClient.java:432) - 在 item0 上发现错误 2012-10-03 17:13:16,958 错误 [deleteAccount] client.PartnerClient processResult ( PartnerClient.java:434) - 错误代码是：INVALID_ID_FIELD 2012-10-03
> 
> 17:13:16,958 错误 [deleteAccount] client.PartnerClient processResult (PartnerClient.java:435) - 错误消息：无效的记录 ID

我检查了对象 id 是否匹配，因此云中的数据与用于删除命令的 csv 之间没有明显差异。

会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:33:08.737

我终于发现，我上传的 .csv 文件的编码不同于 Salesforce 中用于该对象数据的内部表示的编码。例如：我的 .csv 文件是在 ANSI 而不是 UTF-8 上编码的。这个细节让销售人员感到困惑。所以我只需将文件的编码更改为 UTF-8，一切都得到了解决。

# scala - 如何通过 Int 和 Double 的“超类”定义直方图特征？

> ID：12731740
> 
> 赞同：1
> 
> 时间：2012-10-04T16:33:14.980
> 
> 标签：scala, generics, numeric, boilerplate

IntHistogram 对单词进行计数并按计数降序显示：

```
object IntHistogram {

  def main(args: Array[String]) {
    val wordsToCount = "foo foo bar foo bar wtf foo bar".split(" ")
    val histogram = new IntHistogram
    for (word <- wordsToCount) histogram(word) += 1
    println(histogram)
    /* 
       (foo,4)
       (bar,3)
       (wtf,1)
    */
  }

}

class IntHistogram extends collection.mutable.HashMap[String,Int] {
  override def default(key:String) = 0
  def descendingPairs = toList.sortBy(_._2).reverse
  override def toString() = descendingPairs.mkString("\n")
} 
```

我需要一个 DoubleHistogram，我使用了复制粘贴，因为我不知道如何定义一个通用的“Histogram[NumberSuperClassOfIntAndDouble]”特征：

```
class DoubleHistogram extends collection.mutable.HashMap[String,Double] {
  override def default(key:String) = 0
  def descendingPairs = toList.sortBy(_._2).reverse
  override def toString() = descendingPairs.mkString("\n")
} 
```

一个聪明/知识渊博的人可以告诉我如何定义这样的超级特征，这样我就可以避免丑陋的复制粘贴样板吗？

提前致谢，

PT

PS我真的希望直方图成为一个特征，所以我可以将直方图行为混合到任何数值地图中。实际上，除了降序 toString 方法之外，我还需要很多行为；我为这个问题简化了它。这里 Num 是 Int 和 Double 的虚构数字超类：

```
trait Histogram[Num] extends collection.Map[String,Num] {
  override def default(key:String) = 0
  def descendingPairs = toList.sortBy(_._2).reverse
  override def toString() = descendingPairs.mkString("\n")
} 
```

我尝试使用 Numeric、Number、import Ordering.Implicits._、各种东西......无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:16:22.163

这似乎与`Numeric`. `Histogram`并不是因为上下文绑定在 上，你不能做出特征`N`，而是`IntHistogram`and`DoubleHistogram`可以是特征。

```
object IntHistogram {

  def main(args: Array[String]) {
    val wordsToCount = "foo foo bar foo bar wtf foo bar".split(" ")
    val histogram = new IntHistogram {}
    for (word <- wordsToCount) histogram(word) += 1
    println(histogram)
    /* 
       (foo,4)
       (bar,3)
       (wtf,1)
    */
  }

}

abstract class Histogram[N:Numeric] extends collection.mutable.HashMap[String,N] {
  override def default(key:String) = implicitly[Numeric[N]].zero
  def descendingPairs = toList.sortBy(_._2).reverse
  override def toString = descendingPairs.mkString("\n")
}

trait IntHistogram extends Histogram[Int]
trait DoubleHistogram extends Histogram[Double] 
```

如果你真的，真的需要直方图成为一个特征，你可以这样做：

```
trait Histogram[N] extends collection.mutable.HashMap[String,N] {
  implicit val n:Numeric[N]
  override def default(key:String) = n.zero
  def descendingPairs = toList.sortBy(_._2).reverse
  override def toString = descendingPairs.mkString("\n")
} 
```

但是你必须在 main 中像这样实例化它：

```
val histogram = new Histogram[Int] { val n = implicitly[Numeric[Int]] } 
```

# sql-server - Azure SQL 数据库是否支持两阶段提交 (2PC)？

> ID：12731741
> 
> 赞同：5
> 
> 时间：2012-10-04T16:33:18.240
> 
> 标签：sql-server, jdbc, azure, azure-sql-database, distributed-transactions

因为在提交期间我有几个不相关的资源要协调，所以我想在 Azure SQL 数据库上使用 Java 代码 (JDBC) 的两阶段提交 (2PC)。

在标准 SQL Server 上，您可以执行一些 DLL 和一些脚本的[复杂安装](http://msdn.microsoft.com/en-us/library/aa342335.aspx)`xp_sqljdbc_xa_init`，以提供一些扩展存储过程，其名称类似于or `xp_sqljdbc_xa_prepare`，而 Microsoft JDBC 驱动程序使用这些扩展存储过程来提供 start/end/prepare/ 的 XA 语义犯罪。但据我所知，这些扩展存储过程在 Azure 上不可用。

此外，SQL Server 本身似乎没有任何`PREPARE TRANSACTION`原语，我在 Azure 中也找不到。

那么如何在 Azure 上进行 2PC 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T18:26:35.957

它不受支持，并且在许多方面与云计算的优势和用例不兼容。我推荐阅读 Clemens Vasters的一篇[出色的博客文章](http://vasters.com/clemensv/2012/07/30/Transactions+In+Windows+Azure+With+Service+Bus+Ndash+An+Email+Discussion.aspx)，其中介绍了服务总线功能，以作为适应您可能正在寻找的行为的关键方面的一种方式。

# jdbc - 如何从 Java 调用 Oracle 中具有关联数组的过程

> ID：12731742
> 
> 赞同：1
> 
> 时间：2012-10-04T16:33:19.867
> 
> 标签：jdbc, oracle10g

我有一个如下所示的存储过程：

```
TYPE ref_cursor IS REF CURSOR;    
TYPE parametro IS RECORD (
    nombre      VARCHAR2(50), -- I want to remove this value and make it the key of the table instead.
    valor       VARCHAR2(32000),
    tipo        VARCHAR2(1),
    sentencia   VARCHAR2(32000)
);
TYPE parametros IS TABLE OF parametro INDEX BY VARCHAR2(50);

PROCEDURE build_cursor (
    params IN parametros
    results OUT ref_cursor
); 
```

从 build_cursor 过程中，我希望能够通过它的键访问表的内容。

```
parametros('key'); 
```

但是，我不知道如何从 Java 构建关联数组，我只看到了简单数组的示例，即：`TYPE parametros IS TABLE OF parametro;`

如何`build_cursor`从 java 调用该过程？

我读到这个：[如何在java中调用包含用户定义类型的oracle存储过程？](https://stackoverflow.com/questions/3626061/how-to-call-oracle-stored-procedure-which-include-user-defined-type-in-java)但我不知道我必须对他的 java 示例进行哪些更改才能创建关联数组；*我将当前元素的 Key 放在哪里？*

这是来自 Oracle 的工作测试。

```
params('key').nombre        := 'key'; -- I want this to be removed because it's the key.
params('key').valor         := 'Roger';
params('key').tipo          := 'V';
params('key').sentencia     := 'Something';
-- Call the procedure
pk_sql_utils.build_cursor(
    params => params,
    results => :results
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T08:12:58.990

[只能引用 SQL 对象`jdbc`，不能引用 PL/SQL 对象](https://stackoverflow.com/a/1399898/119634)。关联数组是 PL/SQL 对象，因此您无法从`jdbc`.

您可以将包装 PL/SQL 函数与 SQL 对象一起使用（关联数组类似于一个嵌套的索引表和一个嵌套的值表）。

您还可以使用临时表：`jdbc`批量插入临时表，包装过程（或 PL/SQL 块）读取临时表并调用您的过程。

# c - rnddata摘要问题

> ID：12731747
> 
> 赞同：0
> 
> 时间：2012-10-04T16:33:41.270
> 
> 标签：c, random, openssl, digest

我试图为摘要生成一个大文件。当我在下面使用 openssl rand 8096 | head -c 8096 > rnddata，没关系。

./hash_test sha1
摘要为：a0a4dab4a16d247fb625ca2abf07373d2123e4a5
openssl dgst -sha1 rnddata
SHA1(rnddata)= a0a4dab4a16d247fb625ca2abf07373d2123e4a5

但是当 rnddata 的大小等于或大于 9000 时，摘要结果会有所不同。

openssl 兰特 9000 | head -c 9000 > rnddata
openssl dgst -sha1 rnddata
SHA1(rnddata)= 4ef5b73ee39f0f2ac6d341c55467c182786cab65
./hash_test sha1
摘要是：691747a97aee32ddf04b3bf5644b5d74c4b69657

下面是我用于测试的 c 代码

```
#include <stdio.h>
#include <openssl/evp.h>

main(int argc, char *argv[])
{
    EVP_MD_CTX mdctx;
    const EVP_MD *md;
    FILE *fr;
    size_t bytes;
    char mystring[32];

    fr = fopen("/home/root/rnddata", "r");
    if(fr == NULL) 
        printf("Error opening file\n");

    unsigned char md_value[EVP_MAX_MD_SIZE];
    int md_len, i; 

    OpenSSL_add_all_digests();
    //OpenSSL_add_all_algorithms();
    if(!argv[1]) {
        printf("Usage: mdtest digestname\n");
        exit(1);
    }

    //md = EVP_get_digestbyname(argv[1]);
    md = EVP_sha1();
    if(!md) {
        printf("Unknown message digest %s\n", argv[1]);
        exit(1);
    }

    EVP_MD_CTX_init(&mdctx);
    EVP_DigestInit_ex(&mdctx, md, NULL);
    while ((bytes = fread (mystring, 1, 32, fr)) != 0)
        EVP_DigestUpdate(&mdctx, mystring, bytes);
    EVP_DigestFinal_ex(&mdctx, md_value, &md_len);
    EVP_MD_CTX_cleanup(&mdctx);

    printf("Digest is: ");
    for(i = 0; i < md_len; i++)
        printf("%02x", md_value[i]);
    printf("\n");
    fclose(fr);
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T15:39:57.597

我已经在 Ubuntu 10.04 上测试了我的代码。结果在命令行和 C 代码之间是相同的。

```
gary@ubuntu:~/crypto$ gcc -v
Using built-in specs.
Target: i486-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.4.3-4ubuntu5' --with-bugurl=file:///usr/share/doc/gcc-4.4/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --enable-shared --enable-multiarch --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.4 --program-suffix=-4.4 --enable-nls --enable-clocale=gnu --enable-libstdcxx-debug --enable-plugin --enable-objc-gc --enable-targets=all --disable-werror --with-arch-32=i486 --with-tune=generic --enable-checking=release --build=i486-linux-gnu --host=i486-linux-gnu --target=i486-linux-gnu
Thread model: posix
gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) 

gary@ubuntu:/usr/local/ssl/bin$ ./openssl 
OpenSSL> version
OpenSSL 1.0.0a 1 Jun 2010
OpenSSL> ^C
gary@ubuntu:/usr/local/ssl/bin$ ./openssl 
OpenSSL> dgst -sha1 /home/gary/crypto/rnddata
SHA1(/home/gary/crypto/rnddata)= 34c7dd77ce6fbc56875bca2bd916f42464b9bab0

gcc sha1_test.c -o h1 -I/usr/local/ssl/include -L/usr/local/ssl/lib -l

gary@ubuntu:~/crypto$ ./h1 rnddata 
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 808 bytes
34c7dd77ce6fbc56875bca2bd916f42464b9bab0 rnddata 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T20:03:06.803

我已经测试了这两个代码以及命令行。下面是我的测试结果。

```
root@am335x-evm:~# openssl rand 9000 | head -c 9000 > rnddata
root@am335x-evm:~# ./hash_test sha1
Digest is: 691747a97aee32ddf04b3bf5644b5d74c4b69657
root@am335x-evm:~# ./sha1_test 
691747a97aee32ddf04b3bf5644b5d74c4b69657 rnddata
root@am335x-evm:~# openssl dgst -sha1 rnddata
SHA1(rnddata)= 4ef5b73ee39f0f2ac6d341c55467c182786cab65 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:54:38.703

I have tested your code, and it works as it should:

```
for i in $( seq 1 100 ); do
    openssl rand 9000 | head -c 9000 > test
    YOUR=$( ./sha1 test | cut -b 12- )
    SHA1=$( openssl dgst -sha1 test | cut -b 13- )
    if [ "$YOUR" == "$SHA1" ]; then
         echo $YOUR OK
    else
         echo $YOUR $SHA1 FAIL
    fi
done 
```

Also works with lengths 8000, 9100, 10000.

Tested your second code, this too appears to work correctly. This is the modified version I wrote to test on different files by supplying the name on command line:

```
#include <stdio.h>
#include <openssl/sha.h>

int main(int argc, char **argv)
{
    unsigned char c[SHA_DIGEST_LENGTH];
    int i;

    FILE *inFile = fopen (argv[1], "rb");
    SHA_CTX shaContext;
    int bytes;
    unsigned char data[1024];

    if (inFile == NULL) {
            printf ("%s can't be opened.\n", argv[1]);
            return 0;
    }

    SHA1_Init (&shaContext);

    while ((bytes = fread (data, 1, 1024, inFile)) != 0)
    {
            printf("Read %d bytes\n", bytes);
            SHA1_Update (&shaContext, data, bytes);
    }
    SHA1_Final (c,&shaContext);

    for(i = 0; i < SHA_DIGEST_LENGTH; i++)
            printf("%02x", c[i]);

    printf (" %s\n", argv[1]);
    fclose (inFile);

    return 0;
} 
```

There must be something in *how* the code is compiled that yields the wrong results.

I checked with `gcc version 4.7.1 20120723 [gcc-4_7-branch revision 189773] (SUSE Linux)` on kernel 3.4.6 x86_64.

I have modified the code above to print some information about its operation. I tested it with a file made up of 9000 zeroes (`dd if=/dev/zero of=/tmp/zeroes bs=1 count=9000`) and got:

```
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 1024 bytes
Read 808 bytes
980eb7886d6d6ce206b9ce5371042d32c96d2714 /tmp/zeroes 
```

If block sizes do match, then we'll try printing the sum of all bytes (which ought to be always zero), or check the buffer one byte at a time.

If you have the same SHA1 as me, we'll try with a sequence of 9000 0x80's.

# java - wsimport 使用额外的下划线错误地生成枚举类型

> ID：12731751
> 
> 赞同：1
> 
> 时间：2012-10-04T16:33:59.237
> 
> 标签：java, jax-ws, wsimport

我正在使用 wsimport 从 WSDL 文件（也已生成）生成我的 JAX-WS 客户端，并且在客户端生成与服务器端不匹配的枚举时遇到问题。

我的 WSDL 文件中的适用片段显示了正确的条目：

```
<xs:simpleType name="type">
  <xs:restriction base="xs:string">
    <xs:enumeration value="BLAH_99X"/>
    <xs:enumeration value="BLAH_123"/>
    <xs:enumeration value="BLAH_ABC"/>
  </xs:restriction>
</xs:simpleType> 
```

为客户端生成的枚举的适用部分是：

```
@XmlType(name = "type")
@XmlEnum
public enum Type {
    @XmlEnumValue("BLAH_99X")
    BLAH_99_X("BLAH_99X"),
    BLAH_123("BLAH_123"),
    BLAH_ABC("BLAH_ABC");
} 
```

我本来希望为客户端生成的枚举项将与来自服务器端（以及在 WSDL 中）的枚举项匹配。但是，当您查看时，它会正确生成它们，而不是第一个生成为`BLAH_99_X`然后映射到正确值的项目。

是否有任何真正的理由必须以它的方式生成该项目？有没有其他人遇到过这个以及如何使它正确生成？

**更新**

我只是凭直觉在我的枚举中添加了一个疯狂的值 ( `T1A32BCS12`)，它`T_1_A_32_BCS_12("T1A32BCS12")`在客户端代码中作为我的枚举项生成。因此，似乎只要您有一个字母和一个数字并排，wsimport 就会在它们之间插入一个下划线。这是 wsimport 中的错误吗？这似乎没有合乎逻辑的理由。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T14:47:14.167

为了使事情保持清洁并且没有毫无意义的开放性问题......这显然实际上是 JAX-WS RI 2.2.7 中的一个错误。据我发现没有解决方法。

# php - 在 PHP 中处理临时文件情况的好方法

> ID：12731760
> 
> 赞同：1
> 
> 时间：2012-10-04T16:34:25.150
> 
> 标签：php, image, upload, temporary-files

我有一个 PHP 脚本，用户可以在其中上传图像。该图像存储在临时目录中并返回给用户。然后，用户可以使用 javascript 界面来裁剪图像。(x1,y2)(x2,y2) 被发送到用于裁剪图像的脚本。然后将其返回给用户进行另一次预览和/或裁剪。一旦用户足够满意，他将单击“保存”。临时文件被复制到原始文件并删除临时文件。这些不是每个用户的图像，而是设备的图像。组织中的任何用户都可以替换任何设备图像。这种方法很好，但有几个问题：

1) 假设用户上传了一张图片进行预览，但随后关闭了浏览器窗口。我将留下一个临时文件。这可能会成为一个问题。当然我可以让 CRON 清理它们，但理论上我可以拥有大量临时文件（这很难看）。cron 还可以在编辑期间删除用户的临时文件。

2）为了处理数字1，我​​总是可以为每件设备创建一个临时文件，例如equip1.temp 和equip1.jpg。所有上传都存储在equip1.temp 中，所有提交都转移到equip1.jpg。如果两个用户试图同时上传同一设备的图片，这可能会搞砸他们（极不可能 + 不是问题，但仍然很难看）

3）我总是可以来回传递图像（用户“上传”图像，它被回显为`<img src="base64....." />`. 生成的编辑 + 原始 base64 字符串被发送回 PHP 进行处理）。此解决方案缓解了临时文件问题，但我注意到来回发送高分辨率图像需要几秒钟。

你会如何处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:51:56.210

我有一个类似的问题。如果我没记错的话（已经有一段时间了），我最终在数据库中创建了一个表来存储文件名和会话密钥/时间。每次加载脚本时，如果数据库中存在死会话，则删除相应的会话和图像/文件。

我不知道这是否是一个好的解决方案，但它为我解决了多用户访问问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:52:03.883

由于您提到的原因，我不推荐＃3。

我建议你这样做：

1.  用户将文件上传到一个随机的临时名称。`equip1.jpg`存储为`equip1_fc8293ae82f72cf7.jpg`. 确保您的脚本将同时处理两个文件名。它将允许两个用户上传相同的设备，最后一个上传的为获胜者，但在此过程中不会发生冲突。
2.  每次您的裁剪器使用临时图像时，您应该“触摸”它以更新修改时间。
3.  让用户完成他们的编辑，移动临时文件代替最终图像名称。
4.  有一个 cron 或上传脚本的一部分，用于删除 mtime 超过一小时左右的废弃临时文件。您认为这很混乱，因为可能存在大量临时文件，但是您是否希望放弃很多图像？垃圾收集是解决这个问题的一种非常标准的方法。

# java - 正则表达式否定后视正在执行正常的后视或给出错误

> ID：12731762
> 
> 赞同：6
> 
> 时间：2012-10-04T16:34:32.800
> 
> 标签：java, regex

我试图让正则表达式以负面的后视方式捕获一些数据，因此如果某个字符串在它之前，它将不匹配。我知道有两种基本格式，但都不起作用。**我在搜索应用程序中执行此操作，并且不能使用 java 来扩充，因此解决方案必须纯粹使用 regex**。

这种格式给我一个错误，说“正则表达式语法错误：无效量词”

`(?<!Product) Type : (.*?)<`

这种格式是一种正常的后视，仅当 Type 前面是 Product 时才捕获：

`(?!=Product) Type : (.*?)<`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:41:10.337

```
(?<!Product)[ ]Type[ ]:[ ](.*?)< 
```

这应该做你想要的。您必须将空格括在括号中`[]`

它不会匹配：

`Product Type : xyz<`

但它会匹配并捕获`xyz`：

`Other Type : xyz<`

# c# - DataGridViewComboBoxColumn.DataSource 更改问题1

> ID：12731764
> 
> 赞同：1
> 
> 时间：2012-10-04T16:34:37.353
> 
> 标签：c#, winforms

我在第一列中有 a`DataGridView`与a和 a绑定（我没有设置 valeumember，因为我想在访问值时获取 myclass ）。第二列也是。它将基于第一个selectedValue 绑定到一些。`DataGridViewComboBoxColumn``List<MyClass>``DisplayMember="name"``DataGridViewComboBoxColumn``List<String>``DataGridViewComboBoxColumn`

所有这些工作都很好，当我更改第一个`DataGridViewComboBoxColumn.DataSource`. 当我向数据源添加一个新的 Myclass 时，它可以工作，但是如果我选择该类，我会收到一个错误：

> System.ArgumentException：DataGridViewComboBoxCell 值无效

代码：

```
//Set columns to Datagridview  
DataGridViewImageColumn btnEdit = new DataGridViewImageColumn();  
Image gear = (System.Drawing.Image)Properties.Resources.gear;  
btnEdit.Image = gear;  
datagridview.Columns.Add(btnEdit);  

//Table  
DataGridViewComboBoxColumn cbTable = new DataGridViewComboBoxColumn();  
cbTable.HeaderText = "Table";  
cbTable.Name = "Table";  
cbTable.DisplayMember = "NameToShow";  
//tableDataSource = cbTable.DataSource;  
//cbTable.DataSource = moduleClone.SqlQuery.Tables;  
datagridview.Columns.Add(cbTable);  

//...  
//...  
//...  

//Load data  
((DataGridViewComboBoxColumn)datagridview.Columns[1]).DataSource = (List<Table>)moduleClone.SqlQuery.Tables;  
//Work just fine  

//...  
//...  
//...  

//Now if i reload de data  
datagridview.Rows.Clear();  
((DataGridViewComboBoxColumn)datagridview.Columns[1]).DataSource = (List<Table>)moduleClone.SqlQuery.Tables;  
//This give me one message box with the exception several times when drawing the gridview. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T09:21:29.510

好的，我找到了适合我的解决方案。而是用`DataGridViewComboBoxColumn.DataSource`，我直接改`DataGridViewComboBoxColumn.Items`。有问题，因为`DataGridViewComboBoxColumn.Items`如果`DataGridViewComboBoxColumn.DataSource`已设置，您无法更改。所以我`DataGridViewComboBoxColumn.DataSource = null`在编辑之前定义`DataGridViewComboBoxColumn.Itens`。

代码：

```
//Set columns to Datagridview  
DataGridViewImageColumn btnEdit = new DataGridViewImageColumn();  
Image gear = (System.Drawing.Image)Properties.Resources.gear;  
btnEdit.Image = gear;  
datagridview.Columns.Add(btnEdit);  

//Table  
DataGridViewComboBoxColumn cbTable = new DataGridViewComboBoxColumn();  
cbTable.HeaderText = "Table";  
cbTable.Name = "Table";  
cbTable.DisplayMember = "NameToShow";  
datagridview.Columns.Add(cbTable);  

//...  
//...  
//...  

//Load data  
((DataGridViewComboBoxColumn)datagridview.Columns[1]).Itens = (List<Table>)moduleClone.SqlQuery.Tables;  
//Work just fine  

//...  
//...  
//...  

//Now I reload de data  
datagridview.Rows.Clear();
((DataGridViewComboBoxColumn)datagridview.Columns[1]).DataSource = null; 
((DataGridViewComboBoxColumn)datagridview.Columns[1]).Items.clear();
((DataGridViewComboBoxColumn)datagridview.Columns[1]).Items= (List<Table>)moduleClone.SqlQuery.Tables; 
```

# c# - 为什么 c:\windows\microsoft.net\framework*** 目录中有共享程序集（GAC）的副本

> ID：12731768
> 
> 赞同：0
> 
> 时间：2012-10-04T16:34:50.420
> 
> 标签：c#, .net, vb.net

这可能不是建设性的，我只是出于好奇而问这个......

作为问题：我在两个目录（c:\windows\assembly\GAC_MSIL* *** * 和 c:\windows\microsoft.net\framework\v2.0.50727）中都找到了相同程序集（System.dll）的两个副本

它们都是相同的版本（我什至将它们与 FC.exe 进行了比较，它们是相同的）。

为什么不能使用 \microsoft.net\framework\2.0.50727 中的“任何程序集”只使用 GAC 中的那个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:44:33.030

Files are copied to the GAC, not the other way around. The files are installed to the .net folder, and that's their official location. The GAC is more like a "cache" of commonly used files, and not it's official location. In fact, that's it's name. Global Assembly **Cache**.

A Cache, by definition, is a copy of something. It can't be the source of it.

# c# - 一台服务器而不是其他服务器上的 LINQ to SQL 超时

> ID：12731769
> 
> 赞同：0
> 
> 时间：2012-10-04T16:35:02.480
> 
> 标签：c#, .net, sql-server, linq, linq-to-sql

我正在使用 LINQ to SQL 来访问存储过程。这在我的本地 sql 服务器上运行良好。但是一旦我指向内部网络中的另一台服务器，我就会超时。在 SQL Profiler 中，我可以看到发送到问题服务器的查询。这应该意味着查询正在访问服务器并执行正确吗？

我可以直接在问题服务器上运行 LINQ 输出而不会出现问题。这可能不是代码问题，而是 sql server 服务器配置有问题吗？我应该检查什么来解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:18:40.110

连接超时不同于命令超时。

请参阅：[SqlCommand.CommandTimeout 和 SqlConnection.ConnectionTimeout 有什么区别？](https://stackoverflow.com/questions/847264/what-is-the-difference-between-sqlcommand-commandtimeout-and-sqlconnection-conne)

总结是连接超时是建立连接的时间量。

命令超时是让命令运行的时间量。不仅仅是获取第一条记录需要多长时间，还有获取整个数据集需要多长时间。

如果您看到查询出现在 SQL Profiler 中，那么是的，它正在被发送。所以你基本上达到了 30 秒的命令超时默认限制。

我建议从将命令超时更改为 500 开始，然后看看它会把你带到哪里。然后我会开始做一些性能分析来确定为什么需要这么长时间。也许您可以删除一些请求的数据，甚至添加额外的索引以更好地支持查询。

# c# - 回发时 IE 中的 ViewState 错误

> ID：12731770
> 
> 赞同：2
> 
> 时间：2012-10-04T16:35:03.837
> 
> 标签：c#, asp.net, sharepoint, user-controls, viewstate

我目前正在开发一个在 Sharepoint 中运行的 ASP.Net 网站。在我解决这个问题之前，让我给你一些背景信息。

我开发了 UserControls，然后将其作为 webparts 添加到共享点页面上。其中一些 Web 部件是在共享点页面加载时动态加载的。

这就是我们这样做的方式：

*   创建将实际用户控件加载到应用程序页面中的应用程序页面 (InfoPage)

> <form id="frmInfoPage" runat="server"> <div id="infopage" runat="server"></div> </form>

*   创建一个用户控件（InfoContainer），它会抓取“InfoPage”并将其添加到“InfoContainer”中的 div 中，使用以下代码：

```
        <div id="InfoContainerDiv"/>    

        <script language="javascript" type="text/javascript">
            var numRando = Math.floor(Math.random() * 101);
            $("#InfoContainerDiv").load("应用页面的url"<%=Query%>&rndNum=" + numRando);
        </脚本>

```

*   那么这个容器被放入 SharePoint 页面......

所以问题是，当sharepoint页面渲染时，会有3个__VIEWSTATE隐藏字段（2个用于动态加载的控件和SP页面），IE7-9会用逗号连接起来。即 /WSteyxeetYRduiylgkdxr,TUIFbiygutifTUfuvFufVvIUCF,ITcvuVuyfIYRCTECOBPOUIBHv

当服务器尝试解码 ViewState 时，这会导致回发错误：

```
<pre lang="HTML">
The state information is invalid for this page and might be corrupted. 
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.Web.HttpException: The state information is invalid for this page and might be corrupted.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.  

Stack Trace: 

[FormatException: Invalid character in a Base-64 string.]
   System.Convert.FromBase64String(String s) +0
   System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) +98
   System.Web.UI.ClientScriptManager.EnsureEventValidationFieldLoaded() +205

[ViewStateException: Invalid viewstate. 
    Client IP: 10.0.0.2
    Port: 52270
    User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
    ViewState: /wEWOAKyz/ClDQKu1K/fBQLCl57WAQL2s5oZArGPqIAOAp20leQEArOq47oIAuqkk+UGArr75pUEAo3A5PMBAq/69ZkHAqTPzZIBArKB/tECAund0sECAoOVssUPAsbZv7cGAtKIwsUDAqzJytwCAvLwypMPApedlMsPAsb2uIYDAqq989YCAoyOwIYBAurogPQDAqb55aEOApWatccBArCN1+wLAvqjl7IPAsbemgcCq+T48Q0CnKjesQwCt4PAxgYCgumAmA4CgumEmA4CvcCmLQL6o5uyDwK9wKItAqvk/PENAsbengcC4bGArAoC4bG8rAoCnKiisQwCmZKdzAIC2tuR7gICk7OHrQYCvZqnwAEChe3tiAECq5rv3AIC69aW+gkCsaHYzAgC2/SjjgwCoprfugkC98TR6AwCho29jgcC3LrdswwChpymvwM=,/wEWAwLv25y/BQLPi+juDQK8wrfPAQ==,/wEWEQLv25y/BQKV1/6iBwL5ivP7BgKF5rW2DgLkv7KzBQKt56yyBwL0x6mvBgK35/ixAQL23cvUDgLk5ryLCgKfw/3jDAL7wZyxBgKosZu6CAK66OGUCQKHyrWLCQLUyPmPCQKBpr2SCQ==
    Referer: blablabla

[HttpException (0x80004005): The state information is invalid for this page and might be corrupted.]
   System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMessage, Boolean macValidationError) +148
   System.Web.UI.ClientScriptManager.EnsureEventValidationFieldLoaded() +10946558
   System.Web.UI.ClientScriptManager.ValidateEvent(String uniqueId, String argument) +64
   System.Web.UI.WebControls.HiddenField.LoadPostData(String postDataKey, NameValueCollection postCollection) +62
   System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +507
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +11042743
   System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +11042282
   System.Web.UI.Page.ProcessRequest() +91
   System.Web.UI.Page.ProcessRequest(HttpContext context) +240
   Microsoft.SharePoint.Publishing.TemplateRedirectionPage.ProcessRequest(HttpContext context) +175
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +599
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +171</pre> 
```

我试过的：

*   在所有控件上禁用 EnableViewstate（__VIEWSTATE 隐藏字段仍然存在）
*   删除 Page_Init 上的 __VIEWSTATE 字段（这会导致 ViewStateMac 错误）
*   将视图状态加密模式设置为“从不”（没有区别）
*   在配置中禁用和加密以及 viewstateMac。（获取 SessionState 错误）

有人可以给我一些建议/建议我希望我提供了足够的信息，而且，请我想了解这个问题，而不仅仅是以另一种方式去做......由于以前的共享点问题，设计是这样的。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:06:52.547

`LoadPageStateFromPersistenceMedium()`您可以使用 as 的函数对视图状态进行自定义反序列化，其中包含打破其“，”的逗号`System.Web.UI.Page`：

```
private ObjectStateFormatter _formatter = new ObjectStateFormatter();

protected override object LoadPageStateFromPersistenceMedium()
{
    // fix here and load your ViewState on correct way
    string vsString = Request.Form["__VIEWSTATE"];

    return _formatter.Deserialize(vsString);
} 
```

这只是一个您需要调试的想法，并使用它来解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T08:37:08.467

添加回调以删除额外的 ViewState 隐藏字段： $("#InfoContainerDiv").load("应用程序页面的 url"<%=Query%>&rndNum=" + numRando, function() {**删除动态加载的 VIEWSTATE 隐藏字段。** }) ;

# eclipse - 加快 Eclipse 中的类型层次结构弹出窗口

> ID：12731776
> 
> 赞同：2
> 
> 时间：2012-10-04T16:35:17.907
> 
> 标签：eclipse, types, hierarchy

类型层次弹出窗口 (Ctrl-T) 现在有时需要五 (5!) 秒才能“弹出”。需要我多说...

是否可以将其设置为仅显示最大数量的项目或其他内容。广度优先。或者其他解决问题的方法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:28:38.300

这是一种解决方案：使用“查找参考”（Ctrl-G）。快得多，至少对我现在来说。

缺点1：不太方便，您需要展开包条目才能找到类和事物。所以你不会直接看到类名。

缺点2：它只显示一个“跳跃”。（这可能是提高速度的一个因素。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:40:31.267

为您的机器添加更多内存或在 eclipse.ini 设置中配置更多内存。Eclipse 构建了一个所谓的 Java 模型来回答您的搜索请求，这通常非常快，即使对于非常大的项目也是如此。因此，在您的情况下，这很可能受到运行 Eclipse 的 JVM 可用内存的限制。

# java - 如何使枚举子类从它继承其他类，其中将包含枚举值？

> ID：12731780
> 
> 赞同：0
> 
> 时间：2012-10-04T16:35:18.550
> 
> 标签：java, enums

> **可能重复：**
> [Java 扩展枚举](https://stackoverflow.com/questions/1414755/java-extend-enum)

我想做的是一些类，它具有枚举中的所有方法以及我自己的方法，例如

```
public class enum_with_shift extends enum{
    public enum_with_shift next(){
        ...
    };
} 
```

但你不能扩展枚举我想用它来创建类似的东西：

```
public class Days_of_week extends enum_with_shift{
    MONDAY, TUESDAY, ...
}

public class Months extends enum_with_shift{
    JANUARY, ...
} 
```

我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:46:31.627

每个枚举都有一个`ordinal`，因此获取所有枚举的“下一个”值是有效的 - 而不仅仅是那些您尝试使用基类的枚举。这意味着您可以编写以下辅助方法：

```
public static <T extends Enum<T>> T getNext(T current) {
    Class<T> enumType = current.getDeclaringClass();
    T[] enumConstants = enumType.getEnumConstants(); // Similar to e.g. Day.values()

    int currentOrdinal = current.ordinal();
    int nextOrdinal = currentOrdinal + 1;
    if (nextOrdinal == enumConstants.length) { // Handle wrapping around to the beginning of the enum values
        nextOrdinal = 0;
    }

    return enumConstants[nextOrdinal];
}

public enum Day {
    MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY
}

public enum Month  {
    JANUARY, FEBRUARY, MARCH, APRIL, MAY, JUNE, JULY, AUGUST, SEPTEMBER, OCTOBER, NOVEMBER, DECEMBER
}

public static void main(String... args) {
    System.out.println(getNext(Day.MONDAY)); // TUESDAY
    System.out.println(getNext(Day.SUNDAY)); // MONDAY

    System.out.println(getNext(Month.JANUARY)); // FEBRUARY
    System.out.println(getNext(Month.DECEMBER)); // JANUARY
} 
```

如果您真的不想对所有枚举执行此操作（也许对于未严格排序的枚举没有意义），那么您可以应用标记接口，如下所示：

```
public interface Ordered {}

public enum Day implements Ordered {
    MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY
}

public static <T extends Enum<T> & Ordered> T getNext(T current) {
    ...
} 
```

[您可以在此处](http://docs.oracle.com/javase/tutorial/reflect/special/enum.html)找到有关反思性使用枚举的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:43:09.940

由于我不知道是什么`enum_with_shift`，我无法直接回答您的问题。

但你是对的。您不能扩展枚举。原因是 enum 只是一个扩展的常规类`java.lang.Enum`。由于 java 中没有多重继承，因此您不能扩展任何其他类。

我可以建议您使用常规类或`java.lang.Enum`直接扩展。看看我的文章： http: [//java.dzone.com/articles/enum-tricks-dynamic-enums](http://java.dzone.com/articles/enum-tricks-dynamic-enums) 我举了一个例子如何做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:01:35.413

上面的答案是正确的转到上面帖子中的链接，它将向您展示如何操作。

当一个类具有 is-a 关系时使用 extends 它只能是一件事 使用 implements 来确保 ab is-like-a 关系来断言类似的行为被实现“方法”

只需单独使用它们，您就不需要扩展您可以想象的所有内容，它们都定义了一个类型，一个定义了一天，另一个定义了月份的状态。您现在可以在名为 Date 的第三个类中使用这两个枚举。

```
public enum Day {
MONDAY,TUESDAY,WEDNESDAY,THURSDAY,FRIDAY,SATURDAY,SUNDAY
}

public enum Month {     
JANUARY,FEBRUARY,MARCH,APRIL,MAY,JUNE,JULY,AUGUST,SEPTEMBER,OCTOBER,NOVEMBER,DECEMBER
} 
```

# javascript - 如何在 Javascript 中循环和设置第二个 Span 的值？

> ID：12731781
> 
> 赞同：0
> 
> 时间：2012-10-04T16:35:19.320
> 
> 标签：javascript, jquery

我有一个查询，我想在其中设置 div 中第二个跨度的值。

```
<div id="content">
    <h1>Welcome</h1>
    <span>This is the first span</span>
    <span>This is the second span</span>
    <span>This is the 3rd span</span>
    </div> 
```

我正在使用以下 javascript。

```
function SetValue(myValue) {

            var mainDiv = document.getElementById("content");
            for(var i=0;i<mainDiv.childNodes.length;i++) {
               if(mainDiv.childNodes[i] == 2) {
                   mainDiv.childNodes[i].innerText = myValue;
               }

            }
        } 
```

我想在主 div 的第二个跨度中设置参数值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:37:53.947

在里面`SetValue`，使用这一行：

`$("#content span:eq(1)").html(myValue);`

不需要循环或任何其他东西。

文档[`:eq`](http://api.jquery.com/eq-selector/)

这个工作的小提琴：http: [//jsfiddle.net/gromer/dB5vS/3/](http://jsfiddle.net/gromer/dB5vS/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:37:50.740

只需使用 .eq() 函数

```
$('#content').find('span').eq(1).text("Your Value"); 
```

.eq 函数从索引 0 开始；

这是**演示** [http://jsfiddle.net/Simplybj/n9HLU/2/](http://jsfiddle.net/Simplybj/n9HLU/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T16:38:22.197

这个纯 JS 实现怎么样，因为除了标签之外，没有任何迹象表明 JQuery 是一个选项，并且对于这样的事情完全不需要它：

```
function SetValue(myValue){
    document.getElementById("content").getElementsByTagName("span")[1].innerText = myValue;
} 
```

[http://jsfiddle.net/MTSAN/1/](http://jsfiddle.net/MTSAN/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:40:05.017

您的 if 语句将必须检查`mainDiv.childNodes[i].tagName == "span"`并增加一个计数器，一旦找到第二个，就设置 innerText。或者（我认为更好）一些使用 nth-child css 选择器的 jQuery 建议已经发布。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-04T16:38:25.207

这可能会有所帮助：

```
$(function() {
  $('#content span:nth-child(2)').text('your text');
});​ 
```

# asp.net - ASP.NET C# - 使用用户控件的下拉列表

> ID：12731786
> 
> 赞同：2
> 
> 时间：2012-10-04T16:35:30.507
> 
> 标签：asp.net, webforms

我是 ASP.NET 的新手

该论坛中的某人帮助我如何使下拉列表与用户控制一起工作并且它正在工作。

在我的用户控制文件 VendorListControl.ascx 中，我有以下代码。请假设 VendorListControl.ascx.cs 工作正常，即当我选择 VendorName 时，它​​会触发“ddlVendor_SelectedIndexChanged”以刷新“ddlVendorBUList”下拉列表。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="VendorListControl.ascx.cs" Inherits="MyNamespace.VendorListControl" %>
<asp:DropDownList runat="server" ID="ddlVendorList" onselectedindexchanged="ddlVendor_SelectedIndexChanged" AutoPostBack="True" /> 
<asp:DropDownList runat="server" ID="ddlVendorBUList" AutoPostBack="True" /> 
<asp:Label runat="server" ID="lblMessage" /> 
```

我的 VendorListControl.ascx.cs 代码：

```
using System;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;

namespace MyNamespace
{
    public partial class VendorListControl : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                FillVendors();
            }
        }

        protected void ddlVendor_SelectedIndexChanged(object sender, EventArgs e)
        {
            int VendorID = Convert.ToInt32(ddlVendorList.SelectedValue.ToString());
            FillVendorBU(VendorID);
        }

        private void FillVendors()
        {
            string strConn = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
            System.Data.SqlClient.SqlConnection conn = new System.Data.SqlClient.SqlConnection(strConn);

            SqlCommand cmd = new SqlCommand();
            cmd.Connection = conn;
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "SELECT VendorID, VendorName FROM MDF_Vendor";

            DataSet objDs = new DataSet();
            SqlDataAdapter dAdapter = new SqlDataAdapter();
            dAdapter.SelectCommand = cmd; ;
            conn.Open();
            dAdapter.Fill(objDs);
            conn.Close();

            if (objDs.Tables[0].Rows.Count > 0)
            {
                this.ddlVendorList.DataSource = objDs.Tables[0];
                this.ddlVendorList.DataTextField = "VendorName";
                this.ddlVendorList.DataValueField = "VendorID";
                this.ddlVendorList.DataBind();
                this.ddlVendorList.Items.Insert(0, "-- Select --");
            }
            else
            {
                this.lblMessage.Text = "No Vendor Found";
            }
        }

        private void FillVendorBU(int VendorID)
        {
            string strConn = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString;
            SqlConnection con = new SqlConnection(strConn);
            SqlCommand cmd = new SqlCommand();
            cmd.Connection = con;
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "SELECT VendorBUID, VendorBUName FROM dbo.MDF_VendorBU WHERE VendorID = @VendorID";
            cmd.Parameters.AddWithValue("@VendorID", VendorID);
            DataSet objDs = new DataSet();
            SqlDataAdapter dAdapter = new SqlDataAdapter();
            dAdapter.SelectCommand = cmd;
            con.Open();
            dAdapter.Fill(objDs);
            con.Close();
            if (objDs.Tables[0].Rows.Count > 0)
            {
                ddlVendorBUList.DataSource = objDs.Tables[0];
                ddlVendorBUList.DataTextField = "VendorBUName";
                ddlVendorBUList.DataValueField = "VendorBUID";
                ddlVendorBUList.DataBind();
                ddlVendorBUList.Items.Insert(0, "--Select--");
            }
            else
            {
                lblMessage.Text = "No states found";
            }
        }

    }
} 
```

接下来，在我的 CreateNewRecord.aspx 页面中，我有这段代码来包含来自用户控件的两个下拉列表。我可以看到下拉列表正常工作。

```
<%@ Register TagPrefix="uc" TagName="VendorListControl" Src="Controls/VendorListControl.ascx" %>
// Some where in the form
<tr>
    <td class="right" width="20%">Vendor Name:</td>
       <td>
          <uc:VendorListControl runat="server" />
       </td>
</tr> 
```

问题与这两个下拉列表的 ID 有关。当我尝试插入记录时，似乎没有检测到“ddlVendorList”和“ddlVendorBUList”的 ID 来自用户控件 ascx 页面。错误“当前上下文中不存在名称 'ddlVendorList'”

```
ExecuteInsert(ddlVendorList.SelectedItem.Text,
  ddlVendorBUList.SelectedItem.Text, 
  MDFAmount.Text, 
  StartDate.Text,
  EndDate.Text,
  VendorQuarter.Text,
  MDFName.Text,
  MDFSummary.Text,
  Status.SelectedItem.Text,
  CreatedBy.Value
  );
Response.Write("<b>Record was successfully added!</b>"); 
```

我知道我是 ASP.NET 的新手，所以请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:40:24.970

您可以在其中放置两个属性`VendorListControl`来获取 ddlVendorList selectedItem 文本和 ddlVendorBUList selectedItem 文本。

在 VendorListControl.ascx.cs 中：

```
public string GetDdlVendorListSelectedItemText
{
   get { return this.ddlVendorList.text; }
}

public string GetDdlVendorBUListSelectedItemText
{
   get { return this.ddlVendorBUList.text; }
} 
```

然后从您的页面`CreateNewRecord`，您可以访问这些属性。您只需要在控件中添加一个 id ：

```
<%@ Register TagPrefix="uc" TagName="VendorListControl" Src="Controls/VendorListControl.ascx" %>
// Some where in the form
<tr>
    <td class="right" width="20%">Vendor Name:</td>
       <td>
          <uc:VendorListControl id="vendorListControl" runat="server" />
       </td>
</tr> 
```

您可以在 CreateNewRecord.aspx.cs 中像这样访问您的属性：

```
ExecuteInsert(this.vendorListControl.GetDdlVendorListSelectedItemText,
  this.vendorListControl.GetDdlVendorBUListSelectedItemText, 
  MDFAmount.Text, 
  StartDate.Text,
  EndDate.Text,
  VendorQuarter.Text,
  MDFName.Text,
  MDFSummary.Text,
  Status.SelectedItem.Text,
  CreatedBy.Value
  ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:41:56.727

您可以在 UserControl 中定义`public property`谁返回`SelectedItem.Text`。

用户控制 (Ascx)

```
public string YourValue
{
  get
  {
    return ddlVendorList.SelectedItem.Text;
  }

} 
```

页面 (aspx)

您可以使用您的公共财产：YourValue。

```
ExecuteInsert(YourValue,
.......  ); 
```

注意：如果您希望设置值，请在您的属性上定义 setter

更新后添加这些属性

```
public string YourDdlVendorListSelectedItemText
{
   get 
   { 
      return this.ddlVendorList.text; 
   }
}

public string YourDdlVendorBUListSelectedItemText
{
   get 
   { 
     return this.ddlVendorBUList.text; 
   }
} 
```

# html - 如果为空则隐藏表格行

> ID：12731789
> 
> 赞同：2
> 
> 时间：2012-10-04T16:35:37.580
> 
> 标签：html, css, jsp

我的 JSP 中有一个表格，当页面生成时有空，我想知道是否有一种方法可以让我仅在它们没有实际文本的情况下隐藏它们，这就是它们的样子。

```
<TABLE border="1" style="empty-cells:hide;padding-left:4px">
<TR>
    <TD><s:property value="barfoo"/></TD>
    <TD align="center"><s:property value="foo"/></TD>
    <TD align="center"><s:property value="bar"/></TD>
    <TD align="center"><s:property value="foobar"/></TD>
</TR>
<TR>
    <TD><s:property value="barfoo"/></TD>
    <TD align="center"><s:property value="foo"/></TD>
    <TD align="center"><s:property value="bar"/></TD>
    <TD align="center"><s:property value="foobar"/></TD>
</TR>
<TR>
    <TD><s:property value="barfoo"/></TD>
    <TD align="center"><s:property value="foo"/></TD>
    <TD align="center"><s:property value="bar"/></TD>
    <TD align="center"><s:property value="foobar"/></TD>
</TR>
<TR>
    <TD><s:property value="barfoo"/></TD>
    <TD align="center"><s:property value="foo"/></TD>
    <TD align="center"><s:property value="bar"/></TD>
    <TD align="center"><s:property value="foobar"/></TD>
</TR>
</TABLE> 
```

但问题并不是所有这些都会一直被填写，有时它们基本上会返回空值，只是留下一个空白空间，我只想隐藏它们，只有当他们要以任何方式离开那个空白空间时使用适用于大多数浏览器的简单解决方案来隐藏该空白区域？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T16:43:21.497

你可以使用 css`:empty pseudo-class`

```
tagname:empty {
 display: none;
} 
```

这样`pseudo-class`式空元素...

在你使用它之前确保它还没有得到广泛的支持，很可能 IE 会导致问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:42:38.400

我认为您可以使用 CSS 属性 empty-cells 执行此操作，如下所示：

```
table {
  empty-cells:hide;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:51:04.253

的使用`s:property`表明您正在使用 Struts。在这种情况下，您可以用标签包围您的表格，[`s:if`](http://struts.apache.org/2.0.12/docs/if.html)以检查是否有数据可以用来呈现表格。

# cuda - CUDA 中纹理缓存中数据的生命周期

> ID：12731792
> 
> 赞同：-2
> 
> 时间：2012-10-04T16:35:53.360
> 
> 标签：cuda

缓存中的数据是否会在内核启动时持续存在？我有大约 5 个内核一次又一次地引用相同的数据，所以我将它们绑定到纹理，但谁能告诉我纹理缓存中的数据是否在内核启动时仍然存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:50:30.873

CUDA C Programming Guide 的第 3.2.10.4 节对此进行了说明：

> 仅当该内存位置已由先前的内核调用或内存副本更新时，线程才能安全地读取某些纹理或表面内存位置

即纹理缓存在内核之间无效（顺便说一句。查阅文档可能比等待stackoverflow上的答案更快）。

然而，纹理缓存中数据的生命周期可能比这短得多，因为每个线程只有少量字节可用。

# javascript - html如何在jquery中编写和创建函数

> ID：12731794
> 
> 赞同：-1
> 
> 时间：2012-10-04T16:36:21.870
> 
> 标签：javascript, jquery, html

```
if (temp == 'Gps') {
    $('#tabs-1').html('<fieldset class="fieldstyle"><legend>Label</legend><input type="text" id="titlebox-' + id + '" value="' + temp + '"/></fieldset><br><p><label>Add to PunchList</label><input type="checkbox" id="punchlist" class="require"/></p><p><label>Mandatory Field</label><input type="checkbox" id="mfield" class="require"/></p><p><label>Include in PDF Export?</label><input type="checkbox" id="pdf" class="require"/></p><br> <fieldset class="fieldstyle"><legend>Field Description</legend><textarea id="instructmsg" value="' + inst + '"></textarea></fieldset> ');
}

else if (temp == 'Photo') {
    $('#tabs-1').html('<fieldset class="fieldstyle"><legend>Label</legend><input type="text" id="titlebox-' + id + '" value="' + temp + '"/></fieldset><br><p><label>Add to PunchList</label><input type="checkbox" id="punchlist" class="require"/></p><p><label>Mandatory Field</label><input type="checkbox" id="mfield" class="require"/></p><p><label>Include in PDF Export?</label><input type="checkbox" id="pdf" class="require"/></p><br> <fieldset class="fieldstyle"><legend>Field Description</legend><textarea id="instructmsg" value="' + inst + '"></textarea></fieldset> ');
} 
```

重复上面的html代码。如何使用 jquery 为此编写函数以及如何调用该函数？如何加载？如何将所有这些写入单个 js 页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:42:08.577

您可以使用`||`（*逻辑或*）运算符：

> 如果可以转换为 true，则返回 expr1；否则，返回 expr2。因此，当与布尔值一起使用时，`||`如果任一操作数为真，则返回真；如果两者都为假，则返回假。

```
function simple() { // define a function
   // ...
   if (temp == 'Gps' || temp == 'Photo') {
      $('#tabs-1').html('...')
   }
}

simple() // call the function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:42:13.910

如果您真的想要一个 jQuery 函数来执行此操作，假设您调用它`myFunction`，您可以这样做：

```
$.fn.myFunction(id, temp, inst) {
    return this.html('<fieldset class="fieldstyle"><legend>Label</legend><input type="text" id="titlebox-'+id+'" value="'+temp+'"/></fieldset><br><p><label>Add to PunchList</label><input type="checkbox" id="punchlist" class="require"/></p><p><label>Mandatory Field</label><input type="checkbox" id="mfield" class="require"/></p><p><label>Include in PDF Export?</label><input type="checkbox" id="pdf" class="require"/></p><br> <fieldset class="fieldstyle"><legend>Field Description</legend><textarea id="instructmsg" value="'+inst+'"></textarea></fieldset> ');
} 
```

但是你的条件不好。你不应该使用多个分支来做同样的事情。使用上面创建的函数，

```
if (temp === 'Gps' || temp === 'Photo') {
    $('#tabs-1').myFunction(id, temp, inst);
} 
```

# jquery - JQuery Scroll检测触发一次

> ID：12731795
> 
> 赞同：5
> 
> 时间：2012-10-04T16:36:27.067
> 
> 标签：jquery, jquery-animate

我有一小块 JQuery 旨在折叠我的标题，更改其尺寸，然后将其粘贴到屏幕的一侧。除了一部分之外，这一切都有效，每次用户滚动时都会触发高度“切换”功能，这真的很烦人。

有没有一种方法可以只检测一次滚动或只切换一次？

```
$(window).scroll(function () {
var width = $(document).width() - 205;
var height = $(document).height();
  $('#me').animate({
    marginLeft: width,
    width: '22px',
    height: 'toggle',
    borderLeftWidth: "10px",
    borderRightWidth: "10px"    
  }, 1000, function() {
    $("#me:first").css("margin-top","-90px");
    var div = $('#me');
    $('#me h1').css("font-size","30px");
    var start = $(div).offset().top;
    $(div).css("height", height);
    $.event.add(window, "scroll", function() {
        var p = $(window).scrollTop();
        $(div).css('position',((p)>start) ? 'fixed' : 'static');
        $(div).css('top',((p)>start) ? '0px' : '');
    });
  });
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-04T16:48:00.137

查看 jquery 的 one() 功能[http://api.jquery.com/one/](http://api.jquery.com/one/)

它只会触发一次，然后立即自行移除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T16:40:55.963

使用标志来检查它是否是第一次

```
var doHeightToggle=true;

$.event.add(window, "scroll", function() {
   if(doHeightToggle)
   {
        var p = $(window).scrollTop();
        $(div).css('position',((p)>start) ? 'fixed' : 'static');
        $(div).css('top',((p)>start) ? '0px' : '');
        doHeightToggle = false;
   } 
}); 
```

# python - Python函数定义全局参数

> ID：12731796
> 
> 赞同：0
> 
> 时间：2012-10-04T16:36:27.330
> 
> 标签：python

有人可以解释为什么在 printfunc 中无法识别 gloabl 变量 x & y，

代码.py

```
global x
global y

def test(val_x=None,val_y=None)
    x = val_x
    y = val_y
    printfunc()

def printfunc():
   print('x',x)
   print('y',y)

if __name__ = '__main__':
   test(val_x=1,val_y=2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:38:20.657

放置在`global`里面`test()`。

`global`在函数内部使用，以便我们可以更改全局变量或创建添加到全局命名空间的变量。：

```
 def test(val_x=None,val_y=None):
        global x
        global y
        x = val_x
        y = val_y
        printfunc() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:43:47.860

The `global` keyword is used inside code block to specify, that declared variables are global, not local. So move `global` inside your functions

```
def test(val_x=None,val_y=None): #you also forgot ':' here
  global x, y
  x = val_x
  y = val_y
  printfunc()

def printfunc():
  global x, y
  print('x',x)
  print('y',y) 
```

# bash - 将文本文件中的行数输出到 Unix 中的屏幕

> ID：12731797
> 
> 赞同：9
> 
> 时间：2012-10-04T16:36:43.637
> 
> 标签：bash, unix

> **可能重复：**
> [bash echo bash 变量中给出的文件行数](https://stackoverflow.com/questions/12022319/bash-echo-number-of-lines-of-file-given-in-a-bash-variable)

想知道如何将文本文件中的行数输出到屏幕，然后将其存储在变量中。我有一个名为 stats.txt 的文件，当我运行`wc -l stats.txt`它时输出`8 stats.txt`

我试着做`x = wc -l stats.txt`认为它只会存储数字，其余的只是为了视觉，但它不起作用:(

谢谢您的帮助

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-04T16:46:24.807

执行此操作有两种 POSIX 标准语法：

```
x=`cat stats.txt | wc -l` 
```

或者

```
x=$(cat stats.txt | wc -l) 
```

他们都运行程序并将脚本中的调用替换为命令的标准输出，在这种情况下将其分配给`$x`变量。但是，请注意，两个都修剪结束换行符（这实际上是您想要的，但有时可能很危险，当您期望换行时）。

此外，第二种情况可以很容易地嵌套（例如：）`$(cat $(ls | head -n 1) | wc -l)`。你也可以用第一种情况来做，但它更复杂：

```
`cat \`ls | head -n 1\` | wc -l` 
```

还有报价问题。您可以将这些表达式包含在双引号内，但使用反引号，您必须在命令内继续引用，而使用括号允许您“开始一个新的引用”组：

```
"`echo \"My string\"`"
"$(echo "My string")" 
```

希望这会有所帮助=)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T16:39:22.713

你可以试试：

```
x=`cat stats.txt | wc -l` 
```

或（来自另一个.anon.coward 的评论）：

```
x=`wc -l < stats.txt` 
```

# javascript - 如何使用 JavaScript 或 jQuery 和正则表达式重写链接？

> ID：12731801
> 
> 赞同：1
> 
> 时间：2012-10-04T16:36:53.133
> 
> 标签：javascript, regex, greasemonkey

希望修改 Yahoo Answers 链接以删除某些部分，仅保存`qid`并替换`index`为`answer`.

所以这：

```
http://answers.yahoo.com/question/index;_ylt=AhT5ZZwbMiGWdQZDSxD1ML305nNG;_ylv=3?qid=20121004094847AAjekoj 
```

变成这样：

```
http://answers.yahoo.com/question/answer?qid=20121004094847AAjekoj 
```

我知道有一些方法可以重写链接，`.htaccess`但在这种情况下，它需要是一个 Greasemonkey 脚本，因为该任务将在我访问的网站上完成，而不是在我的网站上完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:02:05.243

您在这里需要的模式是这样的：

```
/(http:\/\/answers.yahoo.com\/questions\/)index.*(?qid=.*)$/i 
```

你会用这个替换它：

```
/$1answer$2/ 
```

不过，我对 Greasemonkey 的了解并不多，所以我不能给你更多的信息。希望对 Greasemonkey 有更多了解的人出现并提供更好的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:04:27.867

一般来说，应该这样做（**完整的 GM 脚本**）：

```
// ==UserScript==
// @name     _Replace yahoo-answers links
// @include  http://answers.yahoo.com/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @grant    GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change introduced
    in GM 1.0\.   It restores the sandbox.
*/
var targLinks   = $("a[href*='question/index']");
targLinks.each ( function () {
    if (/\bqid=\w+/i.test (this.href) ) {
        var newHref = this.href

        var newPath = this.pathname.replace (/\/question\/index.+$/, "/question/answer");
        var newURL  = this.protocol + "//"
                    + this.host
                    + newPath
                    + this.search
                    + this.hash
                    ;
        this.href   = newURL;
    }
} ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:07:03.900

代替

```
/(http:\/\/answers\.yahoo\.com\/question)\/index.+[?&]qid=([^&#]+)/g 
```

和

```
"$1/answer?quid=$2" 
```

# python - 没有这样的表：pages_page

> ID：12731805
> 
> 赞同：-1
> 
> 时间：2012-10-04T16:37:07.580
> 
> 标签：python, django, sqlite, mod-wsgi

使用 apache &mod_wsgi 设置我的网站时出现上述错误。

我已经浏览了所有管理它一半工作的文档。这是完整的错误：

```
Exception Type:     DatabaseError
Exception Value: no such table: pages_page 
```

我知道数据库没有任何问题，因为在我使用 mod_wsgi 设置站点之前，我可以使用 ./manage.py runserver 运行该站点，并且一切正常。

我必须小心我发布的安全代码。

如果您告诉我您需要，非常乐意发布更多信息，但我真的不知道该发布什么，因为该网站本身运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T16:37:21.827

得到它的工作。我错过了 settings.py 文件中的 DJANGO_SETTINGS_MODULE 变量，因此 apache 文件正在寻找它，但它不存在。

感谢您的回复

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:10:50.673

数据库有*问题*。

当给定一个不存在的文件名时，SQLite 将创建一个新的空数据库；当给定一个空文件名时，SQLite 将创建一个临时数据库。

检查数据库文件名是否配置正确，并且它可以被 Web 服务器访问。

# java - 如何使用 xuggler 写入 outputStream？

> ID：12731806
> 
> 赞同：4
> 
> 时间：2012-10-04T16:37:07.237
> 
> 标签：java, outputstream, xuggle, xuggler

所以我正在尝试将我的编码缓冲图像写入输出流，但我无法在流中获取任何数据......谁能告诉我我做错了什么以及为什么我看不到任何输出？

我希望当我调用 write.encodeVideo 方法时，它将视频编码到我的 ByteArrayOutputStream 中......这个假设是错误的吗？

```
ByteArrayOutputStream outputStream = new ByteArrayOutputStream();

// video parameters
final int videoStreamIndex = 0;
final int videoStreamId = 0;
final long frameRate = DEFAULT_TIME_UNIT.convert(15, MILLISECONDS);
final int width = 512;
final int height = 254;
long nextFrameTime = 0;

// create a media writer and specify the output file
final IMediaWriter writer = ToolFactory.makeWriter("aaa.ogg");

IContainer ic = writer.getContainer();
ic.open(outputStream, writer.getContainer().getContainerFormat(), true, false);

ICodec codec = ICodec.guessEncodingCodec(null, null,"aaa.ogg", null, ICodec.Type.CODEC_TYPE_VIDEO);

// add the video stream
writer.addVideoStream(videoStreamIndex, videoStreamId, codec, width, height);

BufferedImage img = null;
try
{
  img = ImageIO.read(new File("/home/jbkreme/aaa.png"));
}
catch (final IOException e)
{
  e.printStackTrace();
}

for(int yy =0; yy < 2048-height; yy=yy+8)
{
  nextFrameTime++;
  BufferedImage frame = new BufferedImage(width, height, BufferedImage.TYPE_3BYTE_BGR);
  frame = img.getSubimage(0, yy, width, height);
  BufferedImage frame2 = convertToType(frame, BufferedImage.TYPE_3BYTE_BGR);

  //encode the video
  writer.encodeVideo(videoStreamIndex, frame2, nextFrameTime, DEFAULT_TIME_UNIT);

  nextFrameTime += frameRate;
}

writer.close();
outputStream.flush();
outputStream.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-29T19:05:16.567

我相信您创建的`IMediaWriter`方式不正确。您也不想自己打开作家的容器。当您使用 an`OutputStream`而不是文件时，您可以使用如下`com.xuggle.xuggler.io.XugglerIO`映射器来执行此操作：

```
// create a media writer and specify the output stream
final IMediaWriter writer = ToolFactory.makeWriter(XugglerIO.map(outputStream));

// manually set the container format (because it can't detect it by filename anymore)
IContainerFormat containerFormat = IContainerFormat.make();
containerFormat.setOutputFormat("ogg", null, "application/ogg");
mWriter.getContainer().setFormat(containerFormat);

// add the video stream
writer.addVideoStream(videoStreamIndex, videoStreamId, ICodec.ID.CODEC_ID_THEORA, width, height); 
```

请记住，如果您尝试创建一种格式，该格式必须能够在输出字节中“寻找”作为其创建过程的一部分（例如 .mov），那么它不会`OutputStream`像我展示的那样简单. 您必须写入文件而不是`OutputStream`.

# facebook-graph-api - 使用图形 API 删除我的页面选项卡

> ID：12731809
> 
> 赞同：0
> 
> 时间：2012-10-04T16:37:26.790
> 
> 标签：facebook-graph-api, facebook-php-sdk

我正在尝试使用 graphAPI 删除已安装在页面上的页面选项卡应用程序。

我想我很接近。这是我所在的地方（将尝试去除绒毛）

我有我的 pageID $pageID

```
$page_info = $facebook->api("/".$pageID."?fields=access_token");
if( !empty($page_info['access_token']) ) {
            $args = array(
                'access_token'  => $page_info['access_token']
            );
            $pageAccessToken = $page_info['access_token'];
}
$result = $facebook->api('/'.$pageID.'/tabs/'.FB_APP_ID,
                         'delete', 
                          array('access_token' => $pageAccessToken)); 
```

但我收到错误“选项卡未安装或不可移动：异常--> [（＃100）选项卡未安装或不可移动：

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:55:42.713

found my problem

```
'/'.$pageID.'/tabs/'.FB_APP_ID 
```

should have been

```
'/'.$pageID.'/tabs/app_'.FB_APP_ID 
```

I was mising the app_ after /tabs/

# facebook - 应用出现在搜索中，但未出现在共享帖子中

> ID：12731811
> 
> 赞同：0
> 
> 时间：2012-10-04T16:37:32.407
> 
> 标签：facebook, search, permissions

我的应用程序现在终于出现在 Facebook 的搜索中了，万岁。

但是，与我的应用程序相关的活动（例如人们从我的应用程序共享内容、喜欢某些内容并将其发布到他们的墙上等）都没有出现在搜索中。

当有人登录我的应用程序时，我在权限中请求 publish_actions、电子邮件和 user_likes，所以我认为这将使我能够在有人从我的应用程序发布或共享某些内容时查看或搜索。

有人可以就此提供任何建议吗？我真的很感激。

谢谢

# java - 如何在 ZK 中记录 UI 事件？

> ID：12731813
> 
> 赞同：2
> 
> 时间：2012-10-04T16:37:43.193
> 
> 标签：java, spring, logging, zk

我正在使用一个大型 ZK / Spring 应用程序，并且想知道我是否可以以某种方式将跟踪样式日志记录添加到所有 UI 元素，但不向每个单独的元素添加日志语句。（我希望能够跟踪从 UI 启动的事件。）

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T02:54:54.893

假设您要在服务器端记录所有 UI 事件，请像这样实现[EventInterceptor](http://www.zkoss.org/javadoc/latest/zk/org/zkoss/zk/ui/util/EventInterceptor.html)

```
import org.zkoss.zk.ui.event.Event;
import org.zkoss.zk.ui.util.EventInterceptor;

public class LogEventInterceptor implements EventInterceptor {

public Event beforeProcessEvent(Event event) {
    System.out.println(event.getName() + " event received for + "
            + event.getTarget().getId() + "!!!");
    return event;
}
// rest of the impl 
```

然后在您的 zk.xml 中配置它，如下所示（有关详细信息，请参阅[此处）](http://books.zkoss.org/wiki/ZK_Configuration_Reference/zk.xml/The_listener_Element/The_org.zkoss.zk.ui.util.EventInterceptor_interface)

```
<listener>
    <listener-class>foo.LogEventInterceptor</listener-class>
</listener> 
```

对于像这样的简单 zul 文件

```
<window border="normal" title="Intercepting UI Events demo">
    <button id="helloBtn" label="Click me to Say hello"
        onClick='alert("Hello !!!")'>
    </button>
</window> 
```

然后单击 helloBtn 将在服务器控制台上生成以下日志

```
onClick event received for + helloBtn !!! 
```

# java - 是否有任何 Java OCR 工具将文本图像转换为可编辑的文本文件？

> ID：12731817
> 
> 赞同：3
> 
> 时间：2012-10-04T16:38:10.200
> 
> 标签：java, text, ocr, edit

我正在开展一个项目，该项目需要拍摄文本（来自任何文本的硬拷贝）并将该文本转换为文本文件。然后我想使用该文本文件来做一些不同的事情，例如提供新闻文章的超链接或允许用户编辑文档。

到目前为止，我尝试过的工具是 sourceforge.net 的 Java OCR，它在包中提供的图像上运行良好。但是当我拍摄自己的文字时，它根本不起作用。我应该实施一些培训过程吗？如果是这样，有人知道如何实施吗？任何帮助都会大有帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:31:50.543

我有一个 java 应用程序，我最终决定使用[Tesseract OCR](http://code.google.com/p/tesseract-ocr/)，然后使用`Runtime.exec()`. 也许不是您需要的答案，但以防万一您没有考虑过。

* * *

### 编辑 + 添加代码以响应评论回复

*   在 Windows 安装中，我想我可以使用安装程序，或者解压缩现成的二进制文件。
*   在Linux服务器上，我需要自己编译Tesseract，但如果你习惯了那种东西（gcc），这并不难；唯一的问题是对[Leptonica](http://www.leptonica.com/)的依赖也需要编译。

    ```
    // Tesseract can only handle .tif format, so we have to convert it
    ImageIO.write( ImageIO.read( new java.io.File(file.getPath())), "tif", tmpFile[0]);

    String[] tesseractCmd = new String[]{"tesseract", tmpFile[0].getAbsolutePath(), StringUtils.removeEnd(tmpFile[1].getAbsolutePath(), ".txt")};
    final Process process = Runtime.getRuntime().exec(tesseractCmd);
    try {
        int exitValue = process.waitFor();
        if(exitValue == 0) {
            final String extractedText = SearchableTextExtractionUtils.extractPlainText(new FileReader(tmpFile[1]));
            return extractedText;
        }
        throw new SearchableTextExtractionException(exitValue, Arrays.toString(tesseractCmd));
    } catch (InterruptedException e) {
        throw new SearchableTextExtractionException(e);
    } finally {
        process.destroy();
    } 
    ```

# .net - 端点上具有自定义地址的 WCF Web 服务上的空响应

> ID：12731820
> 
> 赞同：2
> 
> 时间：2012-10-04T16:38:18.717
> 
> 标签：.net, wcf, web-services, iis

我创建了一个 WCF Web 服务并将其托管在 IIS 上。web.config 看起来像这样：

```
[...]
<system.serviceModel>
    <behaviors>
        <serviceBehaviors>
            <behavior name="[Namespace].[ServiceNameBehavior]">
                <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
                <serviceDebug includeExceptionDetailInFaults="true"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>

    <services>
        <service name="[Namespace].[ServiceName]" behaviorConfiguration="[NameSpace].[ServiceNameBehavior]" >
            <endpoint address="basic" binding="basicHttpBinding" contract="[Namespace].[IService]" />
            <endpoint address="secure" binding="basicHttpsBinding" contract="[Namespace].[IService]" />
        </service>
    </services>
</system.serviceModel>
[...] 
```

当我访问时，`http://localhost/[Namespace]/[ServiceName].svc`我会看到通常的 Web 服务网页，表明您已经创建了一个服务，并且要测试它，您应该使用 svcutil.exe 等调用该服务......

现在..问题是，正如在 web.config 中定义的那样，我想为此 Web 服务使用两种类型的连接（实际上只是限制对这两种连接的访问​​，因此禁用默认`.svc`调用）但是当我去 `http://localhost/[Namespace]/[ServiceName].svc/basic`或者`https://localhost/[Namespace]/[ServiceName].svc/secure`我得到一个空白页面，也无法从本地托管的 PHP 页面访问服务。

这些绑定的行为这样正常吗？如果没有，我该如何解决？

## 更新 1

* * *

我还注意到，尝试从 Visual Studio 创建对这些端点中的任何一个的引用会导致以下错误：

> 下载“https://localhost/[Namespace]/[ServiceName].svc/secure”时出错。请求失败，HTTP 状态为 400：错误请求。元数据包含无法解析的引用：“https://localhost/[Namespace]/[ServiceName].svc/secure”。内容类型应用程序/soap+xml；服务 https://localhost/[Namespace]/[ServiceName].svc/secure 不支持 charset=utf-8。客户端和服务绑定可能不匹配。远程服务器返回错误：（415）无法处理消息，因为内容类型'application/soap+xml; charset=utf-8' 不是预期的类型 'text/xml; charset=utf-8'.. 如果在当前解决方案中定义了服务，请尝试构建解决方案并再次添加服务引用。

添加对 http://localhost/[Namespace]/[ServiceName].svc 的引用效果很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T18:00:40.037

这一切看起来对我有用，你似乎混淆了服务 URL 和端点 URL 的概念：

*   `<service>`每个协议的每个元素只有一个服务 URL 。这用于获取测试页面、添加服务引用以及获取 WSDL 文档（通过`?wsdl`查询参数）。
*   `<endpoint>`每个元素还有一个端点 URL 。这些是以`/basic`or结尾的`/secure`。这些URL*唯一*能做的就是接受 SOAP 请求。您无法从它们那里获取元数据或浏览它们。对此有一个例外，您可以`/mex`使用`mexHttpBinding`或`mexHttpsBinding`通过 SOAP 请求返回元数据来公开端点。这完全是可选的，在您的情况下是不必要的，因为您改为通过 HTTP(S) GET 公开 WSDL。

在客户端，在 Visual Studio 中，您使用`http://localhost/[Namespace]/[Service].svc`. 如果手动定义客户端端点，则将它们的地址分别设置为`http://localhost/[Namespace]/[Service].svc/basic`和`http://localhost/[Namespace]/[Service].svc/secure`。

**更新：**

要防止`http://localhost/[Namespace]/[Service].svc`URL 响应请求，请在服务配置中禁用元数据发布：

```
<behaviors>
    <serviceBehaviors>
        <behavior name="[Namespace].[ServiceNameBehavior]">
            <serviceMetadata httpGetEnabled="false" httpsGetEnabled="false"/>
            <serviceDebug includeExceptionDetailInFaults="true"/>
        </behavior>
    </serviceBehaviors>
</behaviors> 
```

显然，如果您这样做，那么您将无法再在任何客户端代码中添加新的服务引用，但这在您同时控制客户端和服务器代码的生产环境中是完全可以接受的。

# perl - 如何将第一列数据填零

> ID：12731834
> 
> 赞同：0
> 
> 时间：2012-10-04T16:38:59.747
> 
> 标签：perl, unix, multiple-columns

我在制表符分隔的列中有这样的数据：

```
1   name1   attribute1
1   name1   attribute2
1   name1   attribute3
31  name2   attribute1
31  name2   attribute2
31  name2   attribute3
444 name3   attribute1
444 name3   attribute2
444 name3   attribute3 
```

我想要这样：

```
001 name1   attribute1
001 name1   attribute2
001 name1   attribute3
031 name2   attribute1
031 name2   attribute2
031 name2   attribute3
444 name3   attribute1
444 name3   attribute2
444 name3   attribute3 
```

例如，我可以在 unix 或 perl 中执行此操作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T16:44:21.853

```
perl -i~ -pe's/^(\d+)/sprintf "%03d", $1/e' file 
```

实际上，上述检查超出了它的需要。这是一个更通用的解决方案：

```
perl -i~ -pe's/^([^\t]*)/sprintf "%03s", $1/e' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T02:07:27.177

awk 和 Perl 的答案都很棒。我还要补充一点，在 Perl 中，如果您不提前知道第一列中有多少位数，您可以将“%03d”部分中的“3”替换为包含第一列中最长数字的长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T23:08:15.257

这是一种使用方法`GNU awk`：

```
awk -v OFS="\t" '{ $1 = sprintf ("%03d", $1) }1' file.txt 
```

# r - 使用 ggplot 在构面上创建部分固定、无部分的轴限制？

> ID：12731835
> 
> 赞同：7
> 
> 时间：2012-10-04T16:39:02.113
> 
> 标签：r, ggplot2

我想使用 ggplot2 创建一个分面图，其中 y 轴的最小限制将被固定（比如 0），最大限制将由分面中的数据确定（就像当`scales="free_y"`. 我希望像下面这样的东西会起作用，但没有这样的运气：

```
library(plyr)
library(ggplot2)

#Create the underlying data
l <- gl(2, 10, 20, labels=letters[1:2])
x <- rep(1:10, 2)
y <- c(runif(10), runif(10)*100)
df <- data.frame(l=l, x=x, y=y)

#Create a separate data frame to define axis limits
dfLim <- ddply(df, .(l), function(y) max(y$y))
names(dfLim)[2] <- "yMax"
dfLim$yMin <- 0

#Create a plot that works, but has totally free scales
p <- ggplot(df, aes(x=x, y=y)) + geom_point() + facet_wrap(~l, scales="free_y") 
#Add y limits defined by the limits dataframe
p + ylim(dfLim$yMin, dfLim$yMax) 
```

这会引发错误 ( `length(lims) == 2 is not TRUE`) 对我来说并不奇怪，但我想不出一种策略来解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-04T16:46:50.103

在您的情况下，以下任一方法都可以：

```
p + expand_limits(y=0)

p + aes(ymin=0) 
```

# javascript - Google 自定义搜索 - 搜索查询字符串

> ID：12731836
> 
> 赞同：2
> 
> 时间：2012-10-04T16:39:10.763
> 
> 标签：javascript, google-custom-search

上次我查看时，Google 更新了他们的自定义搜索代码。这是我们的工作代码：

```
<script>
    (function () {
        var cx = '011561302208175438083:iegdgk3oox8';
        var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
        gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
    })();
</script>

...

<gcse:search></gcse:search> 
```

我们想知道的是，如何让这个搜索框在页面加载时自动搜索一个值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T09:09:07.077

```
 <gcse:search queryParameterName='q' autoSearchOnLoad='true' noResultsString='no results'></gcse:search> 
```

这将自动在 URL 中搜索 q=MySearchString

# magento - Magento ：1.7 - 相同的产品根据 magento 有不同的价格

> ID：12731842
> 
> 赞同：1
> 
> 时间：2012-10-04T16:39:21.813
> 
> 标签：magento, magento-1.7

设想 -

我有一个域和四个子域。我想在所有子域上销售相同的产品，但相同产品的价格不同。在 magento 中可以吗？

如果是，请提供解决方案。

谢谢， 阿布舍克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:49:10.043

是的，这是可能的。**Price**属性是网站范围的属性。因此，您应该创建 4 个网站（为每个子域），并且每个网站都有一组产品，并且可以为每个网站分配不同的价格。

要打开此功能，请打开您的管理面板，转到*System/Configuration/Catalog*，打开*Price*选项卡并将**Catalog Price Scope**设置为 Website。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T08:31:24.837

是的，这是可能的。为每个网站设置相同产品的价格属性。因此，您应该创建 4 个网站（为每个子域），并且每个网站都有一组产品，并且可以为每个网站分配不同的价格。

步骤 1\. 在管理面板中，转到系统、配置、目录，然后价格。

第 2 步。将价格从全球更改为网站。

第 3 步。您现在应该在产品的价格页面上看到“网站”，而不是“全球”。

第 4 步。对于您要设置不同价格的每种产品 - 选择产品，然后在左上角您将看到选择商店视图的选项。选择第一家店

Step 5\. 设置第一家店铺的价格，点击“保存并继续编辑”</p>

步骤 6\. 为您的第二家商店选择商店视图并为该商店设置价格

第 7 步。重复第 6 步，直到您的所有商店都有您想要的价格。

# php - 当类在 php 代码中时没有任何显示

> ID：12731847
> 
> 赞同：0
> 
> 时间：2012-10-04T16:39:35.290
> 
> 标签：php

我有一个像这样的简单 php 页面：

```
<?php
include 'config.php';
include 'lib.php';
header("Content-type: text/html; charset=UTF-8");

?>

<html>
    <head>
        <title>view states</title>
        <link rel="stylesheet" type="text/css" href="css/style.css"/>
        <script type="text/javascript" src="jquery-1.8.2.min.js"></script>
    </head>

    <body>

    <div id="container">
        WTF?
    </div>

    </body>

</html> 
```

当我的 lib.php 中有下面的代码时，我的 dom 只包含一个头部和身体。标题不见了，div 容器不见了，文本 'wtf?' 还。

怎么了？

```
class State {
  $id;
  $ip;
  $state;
  $date;
  $played;

  function __construct($id, $ip, $state, $date, $played) {
     $this->$id = $id;
     $this->$ip = $ip;
     $this->$state = $$state;
     $this->$date = $date;
     $this->$played = $played;
  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:43:25.393

打开错误报告，问题变得非常明显。您未能正确声明您的类变量

```
<?php
class State {
  protected $id;
  protected $ip;
  protected $state;
  protected $date;
  protected $played;

  function __construct($id, $ip, $state, $date, $played) {
     $this->id = $id;
     $this->ip = $ip;
     $this->state = $state;
     $this->date = $date;
     $this->played = $played;
  }

} 
```

# silverlight - 让 RavenDB 客户端 API 在 Silverlight 中工作

> ID：12731848
> 
> 赞同：2
> 
> 时间：2012-10-04T16:39:42.147
> 
> 标签：silverlight, ravendb

我刚刚了解到 RavenHQ 是一个易于使用的 .NET 数据库，尤其是 Silverlight。我正在尝试插入一些测试数据（请参阅代码），但它不起作用。我想我错过了一些重要的东西，因为我是 RavenDB 的新手。

我添加了对项目的引用并创建了 clientaccesspolicy.xml 和 crossdomain.xml。我从 1.ravenhq.com 收到（Firebug）对“GET clientaccesspolicy.xml”的 HTTP 200 响应，但没有其他任何反应，也没有插入数据。任何想法将不胜感激。

```
Private Sub TestRavenDB()
    Try
        Dim ds = New DocumentStore()
        ds.Url = "https://1.ravenhq.com/databases/AppHarbor_60e82bd1-234f-4178-a59a-b527a1d391bb"
        ds.ApiKey = "1f827c44-3e38-4e66-8801-83ba03b01f67"
        ds.Initialize()

        Dim p As New Person("Donald")
        Dim session As IAsyncDocumentSession = ds.OpenAsyncSession()
        session.Store(p)

        session.SaveChangesAsync()
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:16:58.147

请注意，您`SaveChangesAsync`有。在您的测试返回之前，您需要等待它完成。

# php - 在没有完全安装 zend 的情况下使用 Zend 2 类

> ID：12731849
> 
> 赞同：0
> 
> 时间：2012-10-04T16:39:45.117
> 
> 标签：php, zend-framework2

我想使用 Zend_Dom_Query 类，但我不需要 Zend 框架中的任何其他内容

我在 library/Zend 的文件夹中有 Zend

然后我执行以下操作：

```
require_once 'library/Zend/Dom/Query.php';
$dom = new Zend_Dom_Query($html); 
```

这会导致错误：

> 致命错误：在第 9 行的 /Users/jimmytidey/projects/think_tank_bank/html/people/demos.php 中找不到类“Zend_Dom_Query”

据我所知，这与自动加载有关，以便为 zend 提供一个可以在其中运行的命名空间。无论我如何尝试，我都无法配置自动加载工作。我不熟悉 PHP 中的命名空间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:23:35.507

我已经解决了这个问题，虽然我不完全明白如何。

Zend Autoloading 旨在解决在您的代码中包含大量包含的问题，优化文件包含以尽可能快地运行，并解决您拥有的第三方依赖项的包含问题。

我发现的所有示例都演示了所有这些复杂的功能，这是缺少的最简单的示例（所有 zend 代码现在都从库文件夹中移出，如原始问题中一样，并重新定位到根目录）。

```
require_once 'Zend/Loader/StandardAutoloader.php';
$loader = new Zend_Loader_StandardAutoloader();
$loader->register(); 
```

就是这样 - 你需要的一切。

# eclipse - 在 Virgo 3.5 上使用 OBR

> ID：12731852
> 
> 赞同：6
> 
> 时间：2012-10-04T16:39:50.430
> 
> 标签：eclipse, maven, osgi, obr

我正在寻找一种巧妙的方式来部署和管理我们的 Virgo 容器上的包，但也想确保如果我们想在几年后从 Virgo 迁移，我们不会与它紧密相连。我们使用的是 Maven，所以免费获得 OBR，这可以为我们节省一些维护依赖链列表的工作。

考虑到这一点，阅读本文后；-[如何部署 OSGi 应用程序和依赖项？](https://stackoverflow.com/questions/3926863/how-to-deploy-osgi-apps-and-dependencies)和一些 Virgo 3.5 文档，我对最佳方法略有不同。

Virgo 文档建议使用计划机制，但这会将我们的部署描述符与 Virgo 联系起来（不是我所追求的）。文章建议我可以通过 GoGo 控制台使用 OBR，该控制台现在作为 Virgo 的标准配置。但是，当尝试使用此控制台管理 OBR 时，我得到的只是

```
osgi> repos add /home/fuzzy/.m2/repository/repository.xml
No repository admin service available 
```

我已经通过 Virgo 文档进行了更多搜索，但找不到任何有关 OBR 的内容 - 只有错误报告表明某些 OBR 命令已不恰当地留在 GoGo shell 中。

我也写信给处女座论坛，但似乎没有人真的想在那里提供帮助。在我沿着将我们与处女座计划联系在一起的路线之前，我想我应该快速去这里。

任何帮助，非常感谢！提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T07:29:18.670

正如建议的那样，下载并安装了 org.apache.felix.bundlerepository-1.6.6.jar - 但是，得到完全相同的错误。问了处女座用户群同样的问题，回来的回答是不支持OBR。也许我在这里遗漏了一些东西，但是关于这个主题的信息很少。如果您知道得更好 - 请为他人着想更新此线程！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T14:24:53.857

消息很清楚 - 您需要一个存储库管理服务。[Felix 提供了一个实现](http://felix.apache.org/site/downloads.cgi)（下载*Bundle Repository*）。

# scala - 如何将模式匹配与参数化特征一起使用？

> ID：12731854
> 
> 赞同：2
> 
> 时间：2012-10-04T16:39:54.107
> 
> 标签：scala, traits, type-erasure

我在 Scala 特征和类型擦除方面遇到了麻烦。我有这个特点：

```
trait Meta[T] {
  def ~=(e: T): Boolean
} 
```

现在我想使用模式匹配来检查这种情况：

```
(m,i) match {
case (x:Meta[T], y: T) if x ~= y => println ("right")
case _ => println ("wrong")} 
```

`T`from`x: Meta[T]`应该是 的类型或者`y`应该`y`是 的子类型`T`。如果类型不匹配，我会得到一个`ClassCastException`. 但`x ~= y`如果类型不正确，则不应执行。有没有解决这个问题，还是我必须捕获异常并以这种方式处理它？

我做了一个尽可能短的运行示例：

```
trait Meta[T] {
  type t = T
  def ~=(e: T): Boolean
}

sealed abstract class A 
case class Ide(s: String) extends A
case class MIde(s: String) extends A with Meta[A] {
  def ~=(e: A) = e match {
    case e: Ide => true
    case e: MIde => false
  }
}
sealed abstract class B 
case class Foo(s: String) extends B

object Test {

  def m = MIde("x")
  def i = Ide("i")
  def f = Foo("f")

  def main[T](args: Array[String]) {
    (m, i) match {
      case (x: Meta[T], y: T) if x ~= y => println("right")
      case _ => println("wrong")
    }
    // -> right
    (m, f) match {
      case (x: Meta[T], y: T) if x ~= y => println("right")
      case _ => println("wrong")
    }
    // -> Exception in thread "main" java.lang.ClassCastException: 
    // Examples.Foo cannot be cast to Examples.A

  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T22:49:17.133

更新：最后添加了替代方案。

由于类型擦除，您在泛型类型方面遇到了模式匹配的限制。

然而，一切都没有丢失。我们可以依靠 ClassManifests 实现一个通用方法来将你的类转换为目标类型 T（以及另一个类似的转换为 Meta[T]）：

```
trait Meta[T] { this: T =>
  type t = T
  def metaManifest: ClassManifest[T]
  def ~=(e: T): Boolean
}

abstract sealed class Base {
  def as[T:ClassManifest]: Option[T] = {
    if ( classManifest[T].erasure.isAssignableFrom( this.getClass ) ) Some( this.asInstanceOf[T] )
    else None
  }
  def asMeta[T:ClassManifest]: Option[T with Meta[T]] = {
    this match {
      case meta: Meta[_] if classManifest[T] <:< meta.metaManifest => as[T].asInstanceOf[Option[T with Meta[T]]]
      case _ => None
    }
  }
}
abstract sealed class A extends Base
case class Ide(s: String) extends A
case class MIde(s: String) extends A with Meta[A] {
  val metaManifest = classManifest[A]
  def ~=(e: A) = e match {
    case e: Ide => true
    case e: MIde => false
  }
}
sealed abstract class B extends Base
case class Foo(s: String) extends B 
```

让我们在 REPL 中测试一下：

```
scala> m.as[A]
res17: Option[A] = Some(MIde(x))
scala> m.asMeta[A]
res18: Option[A with Meta[A]] = Some(MIde(x))
scala> i.as[A]
res19: Option[A] = Some(Ide(i))
scala> i.asMeta[A]
res20: Option[A with Meta[A]] = None
scala> f.as[A]
res21: Option[A] = None
scala> f.asMeta[A]
res22: Option[A with Meta[A]] = None 
```

听起来不错。现在我们可以重写我们的模式匹配：

```
(m, i) match {
  case (x: Meta[T], y: T) if x ~= y => println("right")
  case _ => println("wrong")
} 
```

对此：

```
(m.asMeta[T], i.as[T]) match {
  case (Some(x), Some(y)) if x ~= y => println("right")
  case _ => println("wrong")
} 
```

所以你的例子现在看起来像这样：

```
object Test {

  val m = MIde("x")
  val i = Ide("i")
  val f = Foo("f")

  def test[T:ClassManifest]() {
    (m.asMeta[T], i.as[T]) match {
      case (Some(x), Some(y)) if x ~= y => println("right")
      case _ => println("wrong")
    }
    // -> right
    (m.asMeta[T], f.as[T]) match {
      case (Some(x), Some(y)) if x ~= y => println("right")
      case _ => println("wrong")
    }
  }
} 
```

更新：如果`metaManifest`每次混合时都显式设置`Meta`不是一个选项，您可以让 scala 通过在`Meta`构造函数中隐式传递它来自动推断它。这意味着`Meta`现在必须是一个类，因此`A`and `B`（以及必须作为 的类型参数出现的所有类似类型`Meta`）现在必须是特征，因为您不能混合 2 个类。因此，您基本上是在将一个限制换成另一个限制。选择你最喜欢的。开始了：

```
abstract sealed class Meta[T]( implicit val metaManifest: ClassManifest[T] ) { this: T =>
  type t = T
  def ~=(e: T): Boolean
}

trait Base {
  def as[T:ClassManifest]: Option[T] = {
    if ( classManifest[T].erasure.isAssignableFrom( this.getClass ) ) Some( this.asInstanceOf[T] )
    else None
  }
  def asMeta[T:ClassManifest]: Option[T with Meta[T]] = {
    this match {
      case meta: Meta[_] if classManifest[T] != ClassManifest.Nothing && classManifest[T] <:< meta.metaManifest => as[T].asInstanceOf[Option[T with Meta[T]]]
      case _ => None
    }
  }
}

trait A extends Base
case class Ide(s: String) extends A
case class MIde(s: String) extends Meta[A] with A {
  def ~=(e: A) = e match {
    case e: Ide => true
    case e: MIde => false
  }
}
trait B extends Base
case class Foo(s: String) extends B

object Test {
  val m = MIde("x")
  val i = Ide("i")
  val f = Foo("f")

  def test[T:ClassManifest]() {
    (m.asMeta[T], i.as[T]) match {
      case (Some(x), Some(y)) if x ~= y => println("right")
      case _ => println("wrong")
    }
    (m.asMeta[T], f.as[T]) match {
      case (Some(x), Some(y)) if x ~= y => println("right")
      case _ => println("wrong")
    }
  }
} 
```

最后，如果两种解决方案都不适合您，您可以尝试另一种解决方案：不要与 混合`Meta[T]`，`T`只需将其包装即可。`Meta[T]`然后将只是包装到`T`，您甚至可以添加一个隐式转换 from`Meta[T]`到它的包装值，以便可以像几乎透明`Meta[T]`的实例一样有效地使用 的实例。`T`

# jakarta-ee - 如何正确使用@Alternative 进行客户端实现

> ID：12731855
> 
> 赞同：3
> 
> 时间：2012-10-04T16:39:55.187
> 
> 标签：jakarta-ee, ejb, cdi, ejb-3.1, qualifiers

编辑：我将 CDI 注入点从使用 @EJB 更改为使用 @Inject，如下面的评论所示。仅供参考。

* * *

我有两个EAR项目，基本一样。他们唯一的区别是一些客户特定的实现，如果需要的话。但是，我遇到了问题。

这就是我所拥有的：

EAR #1 包含以下模块：

```
web.war 
ejb-default.jar
ejb-client-1.jar 
```

EAR #2 包含以下模块：

```
web.war
ejb-default.jar
ejb-client-2.jar 
```

在 ejb-default 中包含以下内容：

```
@Singleton
@Startup
public class ApplicationSettingsBean implements ApplicationSettingsBeanLocal 
```

现在，对于 EAR #1，ejb-client-1.jar 可能是空的，因此任何 EJB 注入都应该使用 ejb-default 中的任何内容。

然而，对于 EAR #2，我想用特定于客户端的实现来覆盖默认实现。例如：

```
@Singleton
@Startup    
@Alternative
public class ApplicationSettingsBean implements ApplicationSettingsBeanLocal { 
```

我还在 ejb-client-2 中创建了以下 beans.xml 条目：

```
<beans xmlns="http://java.sun.com/xml/ns/javaee"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/beans_1_0.xsd">
    <alternatives>
        <class>com.client2.ejb.ApplicationSettingsBean</class>
    </alternatives>
</beans> 
```

我希望@Alternative 实现会在这样的实现存在时被注入。如果在注入点指定了@Default，则应该注入默认实现（ejb-default）。虽然，这不会发生：

```
 // Inject the alternative implementation
    @Inject
    private ApplicationSettingsBeanLocal appSettingsBean; 
```

使用此 CDI，将注入默认值，而不是替代方案。这不是预期的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-12T09:47:42.350

您必须指定替代项的**beans.xml**必须在*ejb-default.jar*中，而不是在*ejb-client-2.jar*中。

CDI 规范（1.1，但也适用于以前的实现）在第 5.1 章中指出：

> 替代方案不可用于注入、查找或 EL 解析到模块中的类或 JSP/JSF 页面，除非该模块是 bean 存档并且在该 bean 存档中明确选择了替代方案。

换句话说，您必须在使用该 bean 的类的同一模块中选择替代方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T22:54:56.917

对于那些想知道发生了什么的人，这混合了 CDI 和 EJB (EE5) 注入。这就是发生第一个错误的原因。替代方案是 CDI 想法，@EJB 无法识别它们。

使用默认而不是替代的原因是因为这是在注入中使用的限定符（替代没有隐含@Default）。这实际上告诉 CDI 我确切地知道我想要哪个实例，它是我在注入时使用的具有相同限定符的实例。处理此类事情的最佳方法是简单地使用 @Inject 而不使用任何限定符，除非您确切知道您想要哪个实例并将这些限定符添加到注入中（实现类上的相同）。

# .net - 将 Datatable 的日期类型列转换为输出的短日期 - VB.Net

> ID：12731857
> 
> 赞同：2
> 
> 时间：2012-10-04T16:40:03.240
> 
> 标签：.net, vb.net, datatable

请高手帮忙...

我有一个数据表，我从具有数万条记录的 SQL Server 数据库中加载数据，并且我有一个将整个数据表输出到分隔文本文件的过程。

我这样做的过程具有以下几行代码：

```
For Each dtRow As DataRow In dtToWrite.Rows
     File.WriteLine(String.Join(strDelimitter, dtRow.ItemArray.Select(Function(Field) Field.ToString)))
Next 
```

基本上使用 string.join 函数从我的数据表中的每个数据行创建一个分隔字符串。

现在，我的问题是我从 SQL Server 中提取日期值，因此对于日期列，最终输出的值如下所示：

**“2012 年 9 月 30 日上午 12:00:00”**

而我只希望它显示：

**“2012 年 9 月 30 日”**

让我的数据仅输出数据表中的日期部分的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:46:39.363

您不能像`tgolisch`状态一样在查询中返回日期的时间部分，或者只`.Split()`在字符串上使用。

```
Dim dateOnly As String = yourString.Split(" ")(0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T16:50:58.743

在您的 SQL 查询中，您可以将 DateTime 转换为预先格式化的字符串。像这样：

```
SELECT convert(varchar, getdate(), 101) 
```

有关更多日期格式，请查看[MSDN 格式列表](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T17:02:15.497

```
File.WriteLine(String.Join(strDelimitter, dtRow.ItemArray.Select(Function(Field) DateTime.Parse(Field.ToString).ToShortDateString()))) 
```

将该值转换为 DateTime，然后调用其 .ToShortDateString() 方法。这将取决于文化。

# javascript - 防止 onbeforeunload 函数暂停 Javascript 计时器

> ID：12731865
> 
> 赞同：4
> 
> 时间：2012-10-04T16:40:48.420
> 
> 标签：javascript, settimeout, dom-events, onbeforeunload

在我的网页中，我有一个使用 Javascript 的倒数计时器`setTimeout()`。

```
 function Tick() {
        if (RemainingSeconds <= 0) {
            alert("Time is up.");
            return;
        }
        RemainingSeconds -= 1;
        ElapsedSeconds += 1;
        UpdateTimerDisplay();
        window.setTimeout("Tick()", 1000);
    } 
```

我还触发了一个功能`onbeforeunload`来“防止”用户离开页面。

```
 window.onbeforeunload = function () {
        if (!isIEAjaxRequest) {
            return "You should use the logout button to leave this page!";
        }
        else {
            isIEAjaxRequest = false;
        }
    }; 
```

问题是当“你确定要离开这个页面吗？” 窗口提示，它会暂停该`setTimeout()`功能。关于如何防止这种情况的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:44:18.903

你不能。Javascript 是严格的单线程，因此任何模式弹出窗口都会暂停其他所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:50:06.940

A possible workaround would maybe be to use `var before = new Date()` to store the time before your dialog appears and then use that one to calculate the passed time after your dialog disappears to make up for the missed seconds.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:44:15.203

不，当 UI 线程被另一个任务消耗时，您不能在后台继续更新 UI（在这种情况下，呈现本机模式对话框提示）。

请参阅[Javascript 超时 - 规范](https://stackoverflow.com/questions/12723057/javascript-timeout-specification/12723687)

# objective-c - .mov 格式的视频不能在 ios 5 的 MPMovieplayer 中播放？

> ID：12731868
> 
> 赞同：0
> 
> 时间：2012-10-04T16:40:53.373
> 
> 标签：objective-c, ios, mpmovieplayer

我正在从库中选择一个视频。视频不在 iphone 4s(ios5) 中播放，它在 iphone 4(ios4) 中播放。视频为 .mov 格式。我正在静态拍摄 mp4 视频，它正在播放。有没有原因？请给任何建议。提前致谢

movieplayer=[[MPMoviePlayerController alloc] initWithContentURL:videourl];

```
 NSLog(@"url--%@",videourl);
if([movieplayer respondsToSelector:@selector(view)])
 {
    movieplayer.controlStyle = MPMovieControlStyleFullscreen;
    [movieplayer.view setFrame:self.view.bounds];
    [self.view addSubview:movieplayer.view];
     movieplayer.shouldAutoplay=true;
    [movieplayer play];
 } 
```

它显示黑屏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:54:57.713

Can you check your video codec.

according to Apple web site only these codecs are supported.

> **H.264 video**: up to 1.5 Mbps, 640 by 480 pixels, 30 frames per second, Low-Complexity version of the H.264 Baseline Profile with AAC-LC audio up to 160 Kbps, 48kHz, stereo audio in .m4v, .mp4, and .mov file formats **MPEG-4 video**: up to 2.5 Mbps, 640 by 480 pixels, 30 frames per second, Simple Profile with AAC-LC audio up to 160 Kbps, 48kHz, stereo audio in .m4v, .mp4, and .mov file formats

# wix - 如何创建和编辑 WiX 文件？

> ID：12731871
> 
> 赞同：6
> 
> 时间：2012-10-04T16:41:08.887
> 
> 标签：wix, votive

Microsoft 正在远离 Visual Studio 内置的 MSI 设置项目。WiX 似乎是一种选择。但是我为 WiX 找到的教程都是大约五年前的。例如，*[WiX：新用户提示（第 1 部分，共 3 部分）](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/10/18/wix-hints-for-new-users-part-1-of-3.aspx)*是 2007 年的一个。

1.  WiX 有更新/更好的教程吗？

    那篇文章和其他人提到[Votive](http://wix.sourceforge.net/votive.html)是一种创建和编辑 WiX 文件的方法。

2.  Votive 仍然是一个活跃的项目吗？

    [WixEdit](http://wixedit.sourceforge.net/)声称是 WiX 编辑器的唯一活动项目，但它并未集成到 Visual Studio 中。

3.  我应该使用 WixEdit 还是还愿？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-05T05:26:16.467

这是我之前在[这里](https://stackoverflow.com/questions/923384/is-there-any-definitive-documentation-on-writing-software-installers/923780#923780)发布的答案。[除了添加Joy of Setup](http://www.joyofsetup.com/)（来自[bob-arnson](https://stackoverflow.com/users/104149/bob-arnson) ）之外，我不会更新它，他博客侧边栏中的所有链接也将很有用，从头开始学习时不太有用，但在你起床后了解更多信息非常有用加速。

大约 4 到 5 年前，我投入到 WiX 中，我花了 6 个多月的时间才觉得自己知道自己在做什么，并且花了 12 个多月的时间才感到自信。可以做很多事情来让从头开始变得更容易 - 但大多数人没有意识到的问题是，如果您首先学习 Windows Installer/MSI，那么 WiX 非常简单。

* * *

去拿一份[Windows Installer 权威指南](https://rads.stackoverflow.com/amzn/click/com/1590592972)。我已经数不清有多少次我把它推荐给那些陷入概念并且正在努力理解 Windows Installer 如何工作的人。确保您也获取了[Windows Installer SDK](http://www.microsoft.com/downloadS/details.aspx?familyid=6A35AC14-2626-4846-BB51-DDCE49D6FFB6&displaylang=en)。

掌握 Windows Installer 是您学习的第一阶段，一旦深入了解，您将了解[InstallShield](http://www.installshield.com/)的工作原理（或视情况而定。）。Wise、InstallShield 等试图保护您免受底层概念的影响，并有自己的诡计/黑客来绕过 Windows Installer 的限制。

第二阶段（如果您认真了解 Windows Installer）正在学习[WiX](http://wix.sf.net/)（[WiX 教程](http://www.tramontana.co.hu/wix/)还不错，虽然它有点过时并且针对的是 WiX 2.0 而不是 3.0）并加入[wix-users 邮件列表](http://n2.nabble.com/wix-users-f687560.html). 在你读完上面提到的书之前不要加入用户列表，你会在你的头脑中得到很好的。那些不了解 Windows Installer 概念的人提出的问题在很大程度上会被忽略，但是那些做过功课的人会发现它是一个很好的资源。

本书未涵盖的内容是 Vista，Robert Flamings 关于[了解 UAC 和 Vista](http://blogs.msdn.com/rflaming/archive/tags/UAC+in+MSI/default.aspx)的博客文章（在 Vista 处于 beta 阶段时编写）是您可以找到的关于该主题的最佳信息。

Windows Installer 和 WiX 团队真正擅长的一件事是使文档（帮助文件）保持最新。每当我进行设置时，我通常会在一台显示器上打开**Wix.chm**和**Msi45.chm ;)**

除了文档，来自 WiX 和 Windows Installer 团队的人们的博客非常适合学习新技巧等。这里列出的太多了，但是一旦你知道了术语，你会发现它们中的大多数都会出现在谷歌搜索结果中。

如果这一切看起来太多了，请查看[NSIS](http://nsis.sf.net)。非常适合简单的“我只需要复制文件”类型的安装，而不适合企业部署。[如果您在两者之间纠结，那么当 setup 不只是 xcopy 时](http://blogs.msdn.com/robmen/)，不妨看看 Rob Mensching 的旧博客。那里的文章可能让我相信，从长远来看，深入学习底层的 Windows Installer 概念会有所收获。它有:)

**更新**- 自从我的原始帖子[WiX：Windows Installer XML 开发人员指南](https://rads.stackoverflow.com/amzn/click/com/1849513724)已经发布，对于初学者来说也是一个很好的资源。（不过我自己并不觉得它那么好。）我仍然建议您阅读[Windows Installer 权威指南](https://rads.stackoverflow.com/amzn/click/com/1590592972)作为起点。Windows Installer 和 WiX 不是你几天就能学会的东西，它需要几个月的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T17:36:59.727

我使用《*[WiX：Windows Installer XML 开发人员指南》](http://my.safaribooksonline.com/9781849513722)*一书来熟悉 WiX。

[您可以从CodePlex 的 WiX 主页](http://wix.codeplex.com)获得 Visual Studio 集成。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-04T18:58:50.663

[下载 WiX](http://wixtoolset.org/)并查看[手册](http://wix.sourceforge.net/manual-wix3/main.htm)中的教程（也安装为 .chm）。安装 WiX 时，它将安装必要的文件和模板，以便与 Visual Studio 很好地集成。

注意：WiX 中的每个工具都以有助于表示其用途的字母开头。Votive 只是与 Visual Studio 集成的部分。

例子：

*   还愿 = Visual Studio
*   刻录=引导程序/捆绑
*   蜡烛 = 编译器
*   光 = 链接器

# c# - 使用 C# 客户端使用 JMS 队列

> ID：12731873
> 
> 赞同：0
> 
> 时间：2012-10-04T16:41:13.693
> 
> 标签：c#, jms

我有一个 JMS 队列的详细信息，即主机、端口、topicName。有没有一种简单的方法可以让我使用这个队列中的消息而无需使用 Java .jars 等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:23:44.453

您没有提到托管 JMS 队列的 JMS 提供者的名称。大多数 JMS 提供程序都提供了一个 C# API，用于向 JMS 队列发送/接收消息。例如，如果您的 JMS 提供者是 IBM WebSphere MQ，那么您有 XMS .NET（它是 C# 中的 JMS 规范实现）和本机 C# API。

底线：查看 C# API 的 JMS 提供程序的文档。

# php - 带关闭的 php FILTER_CALLBACK

> ID：12731874
> 
> 赞同：6
> 
> 时间：2012-10-04T16:41:17.660
> 
> 标签：php, filter

试图将闭包传递给 filter_var_array()，但似乎无法使其工作。

```
$clean = function( $html ) {
    return HTML::sanitize( $html, array('p','ul','ol','li'), array('class','style') );
};
$args = array( 'filter' => FILTER_CALLBACK, 'options' => $clean );

$fields = filter_var_array(
    array( $_POST['field1'], $_POST['field2'], $_POST['field3'] ),
    array( 'field1' => $args, 'field2' => $args, 'field3' => $args )
); 
```

上面运行后，$fields 是一个空数组。

请注意，单个过滤工作正常：

```
$field1= filter_var( $_POST['field1'], FILTER_CALLBACK, array( 'options' => $clean ) ); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:51:29.073

您在`$_POST`没有键的情况下传入 的值，因此不会触发回调。只需传入整个`$_POST`数组即可，例如

```
$fields = filter_var_array(
    $_POST,
    array(
        'field1' => $args, 
        'field2' => $args, 
        'field3' => $args 
    )
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:52:58.087

`filter_var_array`需要一个带有字符串键的数组，其中包含要过滤的数据和一个定义参数的数组。有效键是包含变量名称的字符串，有效值可以是过滤器类型，也可以是可选地指定过滤器、标志和选项的数组。

你的实现应该是这样的：

```
$clean = function ($html) {
    return HTML::sanitize($html, array('p','ul','ol','li'), array('class','style'));
};

$filter = array('filter' => FILTER_CALLBACK,'options' => $clean);
$args = array("field1" => $filter,"field2" => $filter,"field3" => $filter);
$fields = filter_var_array($_POST, $args); 
```

# java - exe从jar中提取后出错

> ID：12731875
> 
> 赞同：0
> 
> 时间：2012-10-04T16:41:23.123
> 
> 标签：java, jar, exe

我正在用我的 jar 中的其他资源打包一个 .exe，然后使用以下代码提取它：

```
InputStream program=getClass().getResourceAsStream("/program.exe");
try {
    FileOutputStream output=new FileOutputStream("C:\\Users\\Aitor\\Desktop\\program.exe");
    int b;
    while ((b=program.read())!=1)
    {
        output.write(b);
    }
    output.close();
} catch (IOException e) {
    e.printStackTrace();
} 
```

但是我尝试执行生成的 exe，我收到一条错误消息，指出该存档的版本与我正在使用的 Windows 版本不兼容。如何从 jar 中提取 exe 而不会损坏它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T16:45:41.837

I'd use a faster way of reading and writing the file:

```
FileOutputStream output=new FileOutputStream("C:\\Users\\Aitor\\Desktop\\program.exe");
int b = 0;
byte[] buff = new byte[1024];
while ((b=program.read(buff))>=0)
{
    output.write(buff, 0, b);
}
output.close(); 
```

# java - Mac 与 Windows 上的 Eclipse？

> ID：12731880
> 
> 赞同：1
> 
> 时间：2012-10-04T16:41:35.050
> 
> 标签：java

基本上，在我的大学里，我们得到了一个 Finch 机器人来帮助我们开发 Java 编程技能。但是，我有一个小问题。Uni 使用 Windows 机器，我使用 Mac，基本上我们已经获得了预先编写的代码来测试我们的 Finch 机器人。当我在 WIndows 机器上复制并粘贴代码时，Eclipse 没有给我任何错误，我可以继续测试机器人，但是当我在 Mac 上尝试同样的事情时，我得到 30 个错误！我不知道我做错了什么。

这是代码（我已将错误粘贴在代码下方）：

```
import java.util.Random;
import javax.swing.JOptionPane;
import edu.cmu.ri.createlab.terk.robot.finch.Finch;

public class DoesMyFinchWork 
   {
//This value is the time for most of the tests in milliseconds, 1000 = 1 second
//Change this value if the tests are too long or short
final private static int testtime = 5000;
//This is the Finch object
private static Finch myf = null;
//This is the starting point of the testing program
public static void main(String args[]) 
{
    String s = "";
    //'myf' is the name of our Finch object
    //This will used throughout the program to control your Finch and report it's status  
    myf = new Finch();
    do
    {
        //Run the menu until quit or cancel is selected
        s = FinchMenu();
        if (s == "Light Test") RunLightTest(s);
        if (s == "Tilt Test") RunTiltTest(s);
        if (s == "Tap Test") RunTapTest(s);
        if (s == "Temperature Test") RunTemperatureTest(s);
        if (s == "Obstacle Test") RunObstacleTest(s);
        if (s == "Acceleration Test") RunAccelerationTest(s);
        if (s == "Left Wheel Test") RunLeftWheelTest(s);
        if (s == "Right Wheel Test") RunRightWheelTest(s);
        if (s == "Buzzer Test") RunBuzzerTest(s);
        if (s == "Nose Test") RunNoseTest(s);
    } while (s != "Quit"); 
    System.out.println("Exiting DoesMyFinchWork...");
    myf.quit();
}
//This creates the Finch menu
private static String FinchMenu()
{
    Object[] possibilities = {"Light Test", "Tilt Test","Tap Test","Temperature Test", "Obstacle Test","Acceleration Test","Left Wheel Test","Right Wheel Test","Buzzer Test","Nose Test","Quit"};
    String s = (String)JOptionPane.showInputDialog(null,"Dr Swift's Splendid Finch Test\n++++++++++++++++++++++++\nChoose a test from:\n\n","Week Zero Laboratory",JOptionPane.PLAIN_MESSAGE, null,possibilities,"Light Test");
    if (s == null || s.length() == 0) s = "Quit";
    return(s);
}
//Run the light sensor test
//Displays the left and then the right sensor output
private static void RunLightTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.getLeftLightSensor() + " " + myf.getRightLightSensor());
    }
}
//Run the Tilt Test
//Displays:
//1) Is the beak down?
//2) Is the beak up?
//3) Is the Finch level?
//4) Is the Finch upside down?
//5) Is the Finch's left wing down?
//6) Is the Finch's right wing down?
private static void RunTiltTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.isBeakDown() + " " + myf.isBeakUp() + " " + myf.isFinchLevel() + " " + myf.isFinchUpsideDown() + " " + myf.isLeftWingDown() + " " + myf.isRightWingDown());
    }
}
//Run the tap test
//Displays if the Finch has been tapped
private static void RunTapTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.isTapped());
    }
}
//Run the temperature test
//Displays the current temperature in degrees Celsius
private static void RunTemperatureTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.getTemperature());
    }
}
//Run the obstacle sensor test
//Displays if there is an obstacle left and right of the Finch
private static void RunObstacleTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.isObstacleLeftSide() + " " + myf.isObstacleRightSide());
    }
}
//Run the acceleration sensor test
//Displays is the Finch is being shaken, and then the acceleration in the X, Y and Z planes
private static void RunAccelerationTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    long before = System.currentTimeMillis();
    while(System.currentTimeMillis() - before < testtime)
    {
        System.out.println(myf.isShaken()+ " " + myf.getXAcceleration() + " " + myf.getYAcceleration()+ " " + myf.getZAcceleration());
    }
}
//Run the left wheel test
//Move the left wheel forward and backwards
private static void RunLeftWheelTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    myf.setWheelVelocities(255,0,testtime/2);
    myf.setWheelVelocities(-255,0,testtime/2);
}
//Run the right wheel test
//Move the right wheel forward and backwards
private static void RunRightWheelTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    myf.setWheelVelocities(0,255,testtime/2);
    myf.setWheelVelocities(0,-255,testtime/2);
}
//Sound the buzzer for a number of different frequencies
private static void RunBuzzerTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    for(int i=0;i<=5000;i+=10)
    {
        myf.buzz(i,10);
        long before = System.currentTimeMillis();
        while(System.currentTimeMillis() - before < 10)
        {
            //Do nothing...
        }
    }
}
//Flash the Finch's nose red, green and blue
//Then flash it randomly
private static void RunNoseTest(String s)
{
    System.out.println("\n"+"Running: "+s+"\n");
    for(int r=0;r<=255;r+=5)
    {
        myf.setLED(r,0,0,10);
    }
    for(int g=0;g<=255;g+=5)
    {
        myf.setLED(0,g,0,10);
    }
    for(int b=0;b<=255;b+=5)
    {
        myf.setLED(0,0,b,10);
    }
    Random rand = new Random();
    rand.setSeed(System.currentTimeMillis());
    for(int i=0;i<50;++i)
    {
        int r = Math.abs(rand.nextInt() % 255);
        int g = Math.abs(rand.nextInt() % 255);
        int b = Math.abs(rand.nextInt() % 255);
        myf.setLED(r,g,b,5);
    }
} 
```

}

以下是一些错误（所有 30 个错误都说“Finch 无法解析为一种类型”）：

```
Description Resource    Path    Location    Type
Finch cannot be resolved to a type  DoesMyFinchWork.java    /DoesMyFinchWork/src    line 169    Java
Problem          
Finch cannot be resolved to a type  DoesMyFinchWork.java    /DoesMyFinchWork/src    line 165    Java   
Problem
Finch cannot be resolved to a type  DoesMyFinchWork.java    /DoesMyFinchWork/src    line 161    Java  
Problem
Finch cannot be resolved to a type  DoesMyFinchWork.java    /DoesMyFinchWork/src    line 146    Java 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:44:53.137

看起来 Windows 机器已经完成了一些配置，因此它知道在哪里可以找到这个`Finch`类，而你的 Mac 不知道。相当肯定 Windows 与 Mac 的事情在这里是一个红鲱鱼：如果你去发现另一台（未配置的）Windows 机器，它就不会工作。

您可能需要下载一个包含`Finch`该类的库，然后在 Eclipse 中配置找到它的位置。获取这些信息的最佳位置可能是课堂笔记/网站。如果这些都没有，那就问教授。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:47:25.073

（编辑：哦，该死。没有阅读确切的问题......但如果你以后有问题......）

尝试更换

> (s == "光照测试")

和

> (s.equals("光照测试"))

等等。

'JOptionPane.showInputDialog' 可能在不同平台上以不同的代码实现。要使“==”正常工作，对话框必须返回与发送的可能性参数中*相同*的字符串对象（也需要“实习”，但我认为它确实是实习字面量）。HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T17:36:10.027

在eclipse中只需找到Finch的jar，将其复制粘贴到您项目的文件夹中（希望您有一个lib文件夹），右键单击该文件构建路径>添加到构建路径

那应该可以解决问题。

# vb.net - 为什么此代码不会创建有关未在所有代码路径上返回值的 Visual Studio 警告？

> ID：12731884
> 
> 赞同：2
> 
> 时间：2012-10-04T16:41:50.100
> 
> 标签：vb.net, visual-studio-2008

> **可能重复：** [当函数没有返回时，VB.NET 中没有警告](https://stackoverflow.com/questions/2337835/no-warning-in-vb-net-when-function-has-no-return)

在编写以下函数时，我注意到我没有收到关于不在所有代码路径上返回值的警告。该`CASE ELSE`子句没有返回值，所以它应该给我一个警告。我尝试将通知级别从警告更改为错误，但它仍然没有抱怨它。

```
Public Function LookupOccasionGroup(ByVal occasion As GCOccasionType) As GCOccasionGroups

    Dim occasionInfo = _occasionTypes.FindByOccasionTypeID(occasion)
    If occasionInfo Is Nothing Then
        Throw New InvalidOperationException("blah blah")
    End If

    Select Case occasionInfo.OccasionGroupID

        Case GCOccasionGroups.DineIn, GCOccasionGroups.Delivery, GCOccasionGroups.CarryOut
            Return CType(occasionInfo.OccasionGroupID, GCOccasionGroups)

        Case Else
            Log.Warn("Blah Blah.")
    End Select

End Function 
```

![在此处输入图像描述](../Images/4ac05fe216f37f512d7da3cc6034bd39.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T18:16:50.420

您将 VB.NET 与另一种语言混淆了；在 VB.NET 中允许不分配返回值。返回值为 Nothing，与 C# 中的 default(T) 相同。这在 Visual Basic 中一直是允许的。

屏幕截图显示了另一种诊断，当您忘记声明函数返回值类型时得到的诊断。编译器现在不能再可靠地确定在没有进行赋值时要返回什么。当没有赋值时，它为 Object 下注并返回 Nothing。这*很*可能会引发一个难以理解的 NRE 异常，抛出一个几乎没有提示真正问题所在的位置：

```
Function Foo()
End Function 
```

您现在将获得：

```
error BC42021: Function without an 'As' clause; return type of Object assumed.
error BC31072: Warning treated as error : Function without an 'As' clause; return type of Object assumed.
error BC42105: Function 'foo' doesn't return a value on all code paths. A null reference exception could occur at run time when the result is used. 
```

前两个错误是由同一列表中的“隐式类型；假定对象”条件生成的。第三个错误是您要查找的错误，并且警告通过更改变成了错误。当然，您实际上并不想使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T16:55:19.153

Are all the possible values of the enum contained within the first case? If so, then it is conceivable that there's enough intelligence there to believe the else will never be hit.

To test this, either add a new value to the enum, or remove one of the possible values from the first case.

# python - Python：3d矩阵元素类型的转换速度

> ID：12731891
> 
> 赞同：1
> 
> 时间：2012-10-04T16:42:15.187
> 
> 标签：python, performance, matrix, type-conversion

我相信这是一个简单的问题，但我是 Python 新手，所以任何建议都会受到赞赏。我有字符串矩阵，我需要将每个元素转换为浮点类型，然后将其增加一些数字。我是这样做的：

```
for i in range(0,len(matrix)):
    for j in range(0,len(matrix[i])):
        for k in range(0,len(matrix[j])):
            matrix[i][j][k] = float(matrix[i][j][k]) + 5.555 
```

有没有其他方法可以提高速度？当我有 matrix[50][50][50] 或更大时，性能真的很低。有没有一种方法可以一次增加所有元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T16:47:57.737

您可以对代码进行低级别优化，例如将调用 range() 移到循环之外，这样您就不会在每次循环时都创建一个新列表（或者如果您使用 3.x，则创建一个生成器） .

然而，最大的优化是切换到使用[numpy](http://numpy.scipy.org/)，它将在高性能 C 代码中跨整个数组执行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-04T16:51:22.617

每当您在 Python 中进行数组工作时，如果可能，最好使用 numpy 库。

```
import numpy

matrix = numpy.asarray(matrix,dtype=numpy.float64) + 5.555 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T16:57:00.940

如果`matrix`兼容，那么您可以（并且可能应该）将其放入`numpy`数组中。它是一个非常方便的数值计算库，并带有许多功能：根据您想要做什么，您可能还想查看`scipy`.

```
import numpy as np

a = np.array(matrix)
a += 5.5555 
```

以一些随机数据为例：

```
from numpy.random import random_sample

>>> a = random_sample( (3, 3, 3) )
>>> a
array([[[ 0.98899266,  0.10761687,  0.7784259 ],
        [ 0.79253918,  0.450742  ,  0.46417501],
        [ 0.71733034,  0.26575819,  0.19360072]],

       [[ 0.41609296,  0.96195897,  0.32777537],
        [ 0.59527144,  0.96655918,  0.50073892],
        [ 0.70797323,  0.406036  ,  0.47092251]],

       [[ 0.8572665 ,  0.00076713,  0.25379833],
        [ 0.03426925,  0.59837259,  0.85390736],
        [ 0.78306972,  0.00238982,  0.28702393]]])
>>> a += 5.55555
>>> a
array([[[ 6.54454266,  5.66316687,  6.3339759 ],
        [ 6.34808918,  6.006292  ,  6.01972501],
        [ 6.27288034,  5.82130819,  5.74915072]],

       [[ 5.97164296,  6.51750897,  5.88332537],
        [ 6.15082144,  6.52210918,  6.05628892],
        [ 6.26352323,  5.961586  ,  6.02647251]],

       [[ 6.4128165 ,  5.55631713,  5.80934833],
        [ 5.58981925,  6.15392259,  6.40945736],
        [ 6.33861972,  5.55793982,  5.84257393]]]) 
```

# python - 按外键分组并显示相关项目 - Django

> ID：12731897
> 
> 赞同：17
> 
> 时间：2012-10-04T16:42:35.310
> 
> 标签：python, django, django-queryset

我有以下型号：

```
class Company(CachedModel):
    name = models.CharField(max_length=255)

class UserExtendedProfile(CachedModel):

    company = models.ForeignKey(Company)
    user = models.ForeignKey(User) 
```

我基本上需要得到这样的公司订购的用户列表：

```
Company A
    User 1
    User 2

Company B
    User 3 
    user 4 
```

我尝试了一些事情，最接近的是：

```
users = UserExtendedProfile.objects.values('company', 'user').order_by('company') 
```

然而，这只会给我这样的结果：

```
[{'company': 1L, 'user': 17L}, {'company': 1L, 'user': 6L}, {'company': 2L, 'user': 15L}] 
```

有什么输入吗？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-04T17:15:15.100

您可以在`order_by()`方法上添加多个参数。因此，您可以在订单中进行订购。

```
users = UserExtendedProfile.objects.values('company', 'user').order_by('company', 'user') 
```

对于像这样的结构：

```
[{ company: [user1, user2, ] }, ] 
```

尝试使用**默认字典**

```
from collections import defaultdict 
users = defaultdict(list)
for result in UserExtendedProfile.objects.values('company', 'user').order_by('company', 'user'):
    users[result['company']].append(result['user']) 
```

有了这个，你应该让**用户**得到你想要的结构。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-06T17:59:05.127

如果您只是为了显示目的而尝试完成此操作，请查看： [https ://docs.djangoproject.com/en/1.8/ref/templates/builtins/#regroup](https://docs.djangoproject.com/en/1.8/ref/templates/builtins/#regroup)

它使您可以在模板中执行此操作。

# keyboard-shortcuts - Sublime text 2：如何为 java .properties 文件绑定“注释一行”命令

> ID：12731901
> 
> 赞同：3
> 
> 时间：2012-10-04T16:42:49.760
> 
> 标签：keyboard-shortcuts, sublimetext2, properties-file

也许标题有点复杂，但情况更简单：

在“Java 属性”范围的 Sublime 文本 2 中（对于具有“*.properties”扩展名的文件），快捷方式“注释一行”（ Win 中的`Ctrl`+ ）不起作用。`/`

所以也许有人知道如何实现这个功能？我试过了，但是“Java Properties”没有单独的包，这让我很困惑。

用例：

->`label.quantity = Quantity`

-> ( `Ctrl`+ `/`)

->`#label.quantity = Quantity`

就是这样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-22T21:36:54.683

我试图找到解决同一问题的方法，并想出了一个适合我的解决方案。`Comments-properties.tmPreferences`同一个包中可能有多个指定注释的文件，因此我在 Java 包中添加了另一个名为 的文件，其中包含以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>name</key>
    <string>Comments</string>
    <key>scope</key>
    <string>source.java-props</string>
    <key>settings</key>
    <dict>
        <key>shellVariables</key>
        <array>
            <dict>
                <key>name</key>
                <string>TM_COMMENT_START</string>
                <key>value</key>
                <string># </string>
            </dict>
        </array>
    </dict>
    <key>uuid</key>
    <string>B25BCBF0-6483-11E2-BCFD-0800200C9A66</string>
</dict>
</plist> 
```

# ruby-on-rails - 在 Ubuntu 上安装 Rails 失败，“无法加载此类文件 -- mkmf”

> ID：12731904
> 
> 赞同：49
> 
> 时间：2012-10-04T16:43:03.770
> 
> 标签：ruby-on-rails, ruby

我在 Ubuntu 11 上安装 Rails 时遇到了这个问题：

```
root@salah:/home/salah/rubygems-1.8.15# sudo gem install mysql

Fetching: mysql-2.8.1.gem (100%)
Building native extensions.  This could take a while...
ERROR:  Error installing mysql:
    ERROR: Failed to build gem native extension.

        /usr/bin/ruby1.9.1 extconf.rb
/usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- mkmf (LoadError)
    from /usr/local/lib/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from extconf.rb:10:in `<main>'

Gem files will remain installed in /usr/lib/ruby/gems/1.9.1/gems/mysql-2.8.1 for inspection.
Results logged to /usr/lib/ruby/gems/1.9.1/gems/mysql-2.8.1/ext/mysql_api/gem_make.out 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-10-04T17:18:31.070

如果我没记错的话，mkmf 是 ruby​​-dev 包的一部分。尝试：

```
sudo aptitude install ruby1.9.1-dev 
```

当然，您最好通过 RVM 安装 ruby​​ :)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2013-08-13T14:51:49.783

对于 ubuntu 13.04，这对我有用：

```
sudo apt-get install ruby-dev 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-08T21:26:51.153

尝试 `rvm all do gem install nokogiri`

# android - 在 Activity Service 通信中使用 Result Receiver 处理未决通知

> ID：12731910
> 
> 赞同：1
> 
> 时间：2012-10-04T16:43:24.297
> 
> 标签：android, callback, android-activity, android-service

嗨 stackoverflow 社区。这是我第一次问问题，如果我在这篇文章中有错误，请原谅我

我正在尝试使用本文中解释的结果接收器模式与意图服务通信活动，[并](http://itekblog.com/background-processing-with-intentservice-class/)[在](https://stackoverflow.com/questions/4510974/using-resultreceiver-in-android)stackoverflow 中讨论。Eveything 在示例应用程序中运行良好，但我不确定当 Activity 进入后台或被 Android OS 杀死时这种模式是否有效。

基本上，我想要实现的是以下应用程序行为：

1.  **Activity**：启动 IntentService 做一些工作。传递 ResultReceiver 以接收进度更新
2.  **IntentService**：开始工作，获取Activity的ResultReceiver。
3.  **IntentService** : 工作完成10%，通过向Result Receiver发送消息通知Activity
4.  **活动**：在 onReceiveResult 中接收消息
5.  **IntentService** : 工作完成40%，通过向Result Receiver发送消息通知Activity
6.  **活动**：在 onReceiveResult 中接收消息
7.  *此时，用户转到另一个应用程序。活动首先进入后台分离结果接收器。Android 操作系统也可能因为来电而破坏了这个 Activity*
8.  **意向服务**：工作完成。尝试通知 Activity 但没有可用的 Result Receiver。保存消息以供以后重新传递到活动。
9.  *此时，用户返回应用程序。Activity 进入前台，附加 Result Receiver 并从 Intent Service 获取待处理消息，通知工作已完成。*

所以，我的问题是如何使用 Result Receiver 模式处理 IntentService 到 Activity 的待处理通知？

非常感谢。

# android - Android - 使用不同的数据加载相同的意图

> ID：12731912
> 
> 赞同：0
> 
> 时间：2012-10-04T16:43:25.593
> 
> 标签：android, sqlite, listview

我正在使用不同的数据加载同一页面。我有它，所以它列出了我的项目，当我单击一个时，它会发送正确的下一页类型和 ID。但它仍在加载我的第一页 SQLStatement。正确的事情正在被注销。

我需要先清除它还是什么？

这是我的代码：

```
public class LocationListView extends Activity {

String SQLStatement;
String itemID = "1001-0001021";
String Type;
;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_location_list_view);

        Bundle extras = getIntent().getExtras(); 
        String dataType;
        String dataID;

        if (extras != null) {
            dataType = extras.getString("Type");
            dataID = extras.getString("ID");

        } else {
            dataType = "notset";
            dataID = "notset";
        }

        File dbfile = new File(Global.currentDBfull); 
        SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase(dbfile, null);

        if(dataType == "notset") {

            SQLStatement = "select * from stationobjects where stationid= " + Global.StationID + " and objectid=0";
            Type = "Room";

        } else if(dataType == "Room") {

            SQLStatement = "select * from stationobjects where stationid= " + Global.StationID + "  and objectid=1001 and diagramid like '"+ itemID +"%'";
            Type = "Area";

            Context context = getApplicationContext();
            CharSequence text = "Hello toast!";
            int duration = Toast.LENGTH_SHORT;

            Toast toast = Toast.makeText(context, text, duration);
            toast.show();

        } else if(dataType == "Area") {

            Type = "Zone";
        } else if(dataType == "Zone") {

        } else {

            SQLStatement = "select * from stationobjects where stationid= " + Global.StationID + " and objectid=0";
            Type = "Room";
        }

        Cursor c = db.rawQuery(SQLStatement, null);  
        if(c.getCount() != 0) {

        Log.e("LocationListView", "Found Items");   

        c.moveToFirst();

      ArrayList<String> mItemName = new ArrayList<String>();
      final ArrayList<String> mItemID = new ArrayList<String>();

        c.moveToFirst();
        while(!c.isAfterLast()) {
             mItemName.add(c.getString(c.getColumnIndex("Name")));
             mItemID.add(c.getString(c.getColumnIndex("StationObjectID")));
             c.moveToNext();
        }

        final ListView listView = (ListView) findViewById(R.id.lvLocation);
        final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
              android.R.layout.simple_list_item_1, android.R.id.text1, mItemName);

        int[] colors = {0, 0xFFFF0000, 0}; 
        listView.setDivider(new GradientDrawable(Orientation.RIGHT_LEFT, colors));
        listView.setDividerHeight(1);
        listView.setAdapter(adapter); 

        listView.setClickable(true);
        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {

          @Override
          public void onItemClick(AdapterView<?> arg0, View arg1, int position, long arg3) {

            Object o = listView.getItemAtPosition(position);
            String StationObjectID = mItemID.get(position);
            Log.e("LocationListView", "" + o);
            Log.e("LocationListView", "" + StationObjectID);

            startActivityForResult(SwapPage, 0);

          }
        });

        } else {

            Log.e("LocationListView", "Not Found Items");   
            Context context = getApplicationContext();
            CharSequence text = "Sorry No data returned";
            int duration = Toast.LENGTH_LONG;

            Toast toast = Toast.makeText(context, text, duration);
            toast.show();
        }

        db.close();

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:52:42.213

您的 Intent 中的数据看起来是正确的，问题是在 Java 中您**必须像这样** [比较字符串](http://docs.oracle.com/javase/tutorial/java/data/comparestrings.html)：

```
if(dataType.equals("notset")) 
```

不是：

```
if(dataType == "notset") 
```

* * *

详解：[Java中如何比较字符串？](https://stackoverflow.com/q/513832/1267661)

# html - Auto-space within input field

> ID：12731914
> 
> 赞同：1
> 
> 时间：2012-10-04T16:43:34.673
> 
> 标签：html, forms, input, spacing, restrict

I'm currently working on a project in which I need to fetch street/city details from a DB using a zipcode. Dutch zipcodes use a "1111 AA" format, I would like to have this entered in a single input field while automatically adding the space in between the numbers and letters if the user doesn't enter the space himself.

I've been googling this quite a bit and all I have been able to find so far were ways of restricting the user input to numeric characters.

Thank you.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:48:10.300

你需要 JavaScript 来做到这一点。在这种情况下，jQuery 实际上可以帮到你很多。这是一个**[简洁的插件](http://digitalbush.com/projects/masked-input-plugin/)**来处理你想要的：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:11:53.213

HTML 中没有用于此类操作的工具。您可以在 JavaScript 中编写功能，使用处理的按键事件来检查是否输入了四个连续数字并在肯定的情况下附加一个空格。如果您考虑如果用户按下删除键删除字符会发生什么，这将变得更加困难。您还会遇到用户可能会按空格键键入“1111 AA”的问题，然后会发生什么？

所以它的用处值得怀疑。最好只接受带空格和不带空格的邮政编码。

# mysql - Dynamic Multi Insert with DBI placeholders for many sets of VALUES

> ID：12731915
> 
> 赞同：2
> 
> 时间：2012-10-04T16:43:34.753
> 
> 标签：mysql, sql, perl, dbi

I'm building a dynamic SQL statement, that will insert one or more sets of `VALUES` via a prepared DBI statement, my question is this:

Since I have a dynamic number of `VALUES` sets, and I will need to add as many `( ?, ?, ?),( ?, ?, ?)` etc as necessary to extend the statement `INSERT INTO `tblname` ( $columnsString ) VALUES` in order to submit only one query using placeholders and bind values- is this the preferred method(most efficient, etc., - reasoning behind efficiency would be helpful in your answer if possible) or should I just be building this as a query string with `sprintf` and `dbh->quote()`?

(As a little extra information: I'm actually using AnyEvent::DBI right now, which only exposes placeholders & bind values and not the `quote()` method so this wouldn't be easy for me to accomplish without creating another straight DBI `$dbh` and using another db server connection just to use the `quote()` method, or without altering the AnyEvent::DBI module myself.)

Normally I would just execute the statements as necessary but in this heavy workload case I'm trying to batch inserts together for some DB efficiency.

Also, if anyone could answer if it is possible( and then how to ) insert an sql `DEFAULT` value using placeholders and bind values that'd be awesome. Typically if I ever needed to do that I'd append the `DEFAULT`s to the string directly and use sprintf and `$dbh->quote()` only for the non `DEFAULT` values.

# UPDATE:

Worked out the misunderstanding in a quick chat. User [ikegami](https://stackoverflow.com/users/589924/ikegami) suggested that instead of building the query string myself without placeholders, that I just intermingle VALUES and placeholders such as:

`$queryString .= '(DEFAULT,?,?),(DEFAULT,DEFAULT,DEFAULT)';`

Some of the reasoning behind my first asking of this question on SO was because I was somewhat against this intermingling due to my thought that it made the code less readable, though after being assured that sql 'DEFAULT' couldn't be in a placeholder bind value, this was the method I had begun implementing.

Using placeholders where possible does seem to be the more accepted method of building queries, and if you want an SQL `DEFAULT` you just need to include it in the same query building as the placeholders. This does not apply to `NULL` values, as those CAN be inserted with placeholders and a bind value of `undef`.

### Update 2:

The reasoning I asked about performance, the 'acceptance' of building your own query with quote() vs building with placeholders, and why I've gone with a solution that involves using all columns for the SQL `INSERT INTO tblname (cols)` is because I have roughly 2-4 million rows a day going into a terrible db server, and my code is running on an equally terrible server. With my requirements of needing `DEFAULT` sql values, and these terrible performance constraints, I've chosen a solution for now.

For future devs who stumble upon this - take a look at @emazep's solution of using SQL::Abstract, or if for some reason you need to build your own, you might consider either using @Schwern's subroutine solution or possibly incorporating some of @ikegami's answer into it as these are all great answers as to the 'Current state of affairs' regarding the usage of DBI and building dynamic queries.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-05T00:39:29.450

除非有特定的理由重新发明轮子（可能有一些），`SQL::Abstract`（其中）已经为我们所有人解决了动态 SQL 生成的问题：

```
my %data = (
    name    => 'Jimbo Bobson',
    phone   => '123-456-7890',
    address => '42 Sister Lane',
    city    => 'St. Louis',
    state   => 'Louisiana'
);

use SQL::Abstract;
my ($stmt, @bind)
    = SQL::Abstract->new->insert('people', \%data);

print $stmt, "\n";
print join ', ', @bind; 
```

打印：

```
INSERT INTO people ( address, city, name, phone, state)
VALUES ( ?, ?, ?, ?, ? )
42 Sister Lane, St. Louis, Jimbo Bobson, 123-456-7890, Louisiana 
```

`SQL::Abstract`然后提供[了一个很好的技巧](http://search.cpan.org/~frew/SQL-Abstract-1.73/lib/SQL/Abstract.pm#PERFORMANCE)来迭代许多行以插入，而无需每次都重新生成 SQL，但是对于批量插入，还有`SQL::Abstract::Plugin::InsertMulti`

```
use SQL::Abstract;    
use SQL::Abstract::Plugin::InsertMulti;

my ($stmt, @bind)
    = SQL::Abstract->new->insert_multi( 'people', [
        { name => 'foo', age => 23 },
        { name => 'bar', age => 40 },
    ]);

# INSERT INTO people ( age, name ) VALUES ( ?, ? ), ( ?, ? )
# 23, foo, 40, bar 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:57:36.067

我有时会使用如下构造：

```
#!/usr/bin/env perl

use strict; use warnings;

# ...

my @columns = ('a' .. 'z');

my $sql = sprintf(q{INSERT INTO sometable (%s) VALUES (%s)},
    join(',', map $dbh->quote($_), @columns),
    join(',', ('?') x @columns),
); 
```

至于处理`DEFAULT`，是否会保留该列以确保数据库将其设置为默认值？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:51:42.603

如果您将占位符用于“静态”查询，那么您也应该将它们用于“动态”查询。查询就是查询。

```
my $stmt = 'UPDATE Widget SET foo=?'
my @params = $foo;

if ($set_far) {
   $stmt .= ', far=?';
   push @params, $far;
}

{
   my @where;

   if ($check_boo) {
      push @where, 'boo=?';
      push @params, $boo;
   }

   if ($check_bar) {
      push @where, 'bar=?';
      push @params, $bar;
   }

   $stmt .= ' WHERE ' . join ' AND ', map "($_)", @where
      if @where;
}

$dbh->do($stmt, undef, @params); 
```

我使用了 UPDATE，因为它允许我展示更多内容，但所有内容也适用于 INSERT。

```
my @fields = ('foo');
my @params = ($foo);

if ($set_far) {
   push @fields, 'bar';
   push @params, $far;
}

$stmt = 'INSERT INTO Widget ('
      . join(',', @fields)
      . ') VALUES ('
      . join(',', ('?')x@fields)
      . ')';

$dbh->do($stmt, undef, @params); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T20:28:37.923

您已经表达了对代码可读性以及能够传入 DEFAULT 的担忧。我会把@ikegami 的回答更进一步......

```
sub insert {
    my($dbh, $table, $fields, $values) = @_;

    my $q_table      = $dbh->quote($table);
    my @q_fields     = map { $dbh->quote($_) } @$fields;
    my @placeholders = map { "?" } @q_fields;

    my $sql = qq{
        INSERT INTO $q_table
               ( @{[ join(', ', @q_fields)    ]} )
        VALUES ( @{[ join(', ', @placeholders ]} )
    };

    return $dbh->do($sql, undef, @$values);
} 
```

现在您有了一个通用的多值插入例程。

```
# INSERT INTO foo ('bar', 'baz') VALUES ( 23, 42 )
insert( $dbh, "foo", ['bar', 'baz'], [23, 43] ); 
```

要指示默认值，请不要传入该列。

```
# INSERT INTO foo ('bar') VALUES ( 23 )
# 'baz' will use its default
insert( $dbh, "foo", ['bar'], [23] ); 
```

您可以对此进行优化，以使您的子例程通过一个子例程调用和一个准备好的语句执行多次插入，从而在客户端节省 CPU（如果它支持准备好的句柄，则可能在数据库端进行一些操作）。

```
sub insert {
    my($dbh, $table, $fields, @rows) = @_;

    my $q_table      = $dbh->quote($table);
    my @q_fields     = map { $dbh->quote($_) } @$fields;
    my @placeholders = map { "?" } @q_fields;

    my $sql = qq{
        INSERT INTO $q_table
               ( @{[ join(', ', @q_fields)    ]} )
        VALUES ( @{[ join(', ', @placeholders ]} )
    };

    my $sth = $dbh->prepare_cached($sql);
    for my $values (@rows) {
        $sth->execute(@$values);
    }
}

# INSERT INTO foo ('bar', 'baz') VALUES ( 23, 42 )
# INSERT INTO foo ('bar', 'baz') VALUES ( 99, 12 )
insert( $dbh, "foo", ['bar', 'baz'], [23, 43], [99, 12] ); 
```

最后，您可以编写一个批量插入，在单个语句中传递多个值。这可能是进行大量插入的最有效方法。这就是拥有一组固定列并传入`DEFAULT`标记的地方。我使用了作为标量引用传递的值被视为原始 SQL 值的习语。现在你可以灵活地传递你喜欢的任何东西。

```
sub insert {
    my($dbh, $table, $fields, @rows) = @_;

    my $q_table      = $dbh->quote($table);
    my @q_fields     = map { $dbh->quote($_) } @$fields;

    my $sql = qq{
        INSERT INTO $q_table
               ( @{[ join(', ', @q_fields)    ]} )
        VALUES
    };

    # This would be more elegant building an array and then joining it together
    # on ",\n", but that would double the memory usage and there might be
    # a lot of values.
    for my $values (@rows) {
        $sql .= "( ";
        # Scalar refs are treated as bare SQL.
        $sql .= join ", ", map { ref $value ? $$_ : $dbh->quote($_) } @$values;
        $sql .= "),\n";
    }
    $sql =~ s{,\n$}{};

    return $dbh->do($sql);
}

# INSERT INTO foo ('bar', 'baz') VALUES ( 23, NOW ), ( DEFAULT, 12 )
insert( $dbh, "foo", ['bar', 'baz'], [23, \"NOW"], [\"DEFAULT", 12] ); 
```

不利的一面是这会在内存中构建一个字符串，可能非常大。要解决这个问题，您必须[从文件语法中涉及特定于数据库的批量插入](http://www.postgresql.org/docs/9.2/static/sql-copy.html)。

与其自己编写所有这些 SQL 生成内容，不如使用@emazep 的答案并使用 SQL::Abstract 和[SQL::Abstract::Plugin::InsertMulti](https://metacpan.org/module/SQL%3a%3aAbstract%3a%3aPlugin%3a%3aInsertMulti)。

只要确保你[的个人资料](https://metacpan.org/module/DBI%3a%3aProfile)。

# facebook - Facebook Like button error in Rails app

> ID：12731916
> 
> 赞同：1
> 
> 时间：2012-10-04T16:43:36.837
> 
> 标签：facebook, facebook-like

I have seen many questions on here that are relatively similar, but most recommend a solution involving an APPID. However, I simply want to solve the error being outputted from the like button, no APPID necessary, the like button *is* working but producing irritating output in the console.

I am getting the following error in my Guard output: `http://connect.facebook.net/en_US/all.js|54|FB.getLoginStatus() called before calling FB.init()`.

With a similar error in my web console: FB.getLoginStatus() called before calling FB.init().

I have this block in my app.js file:

```
(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk')); 
```

And the following in my markup right inside the `<body>`:

```
.facebook-like#fb-root
.fb-like(data-href="https://www.facebook.com/MYAPP" data-send="false" data-layout="button_count" data-width="90" data-show-faces="true") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:34:20.120

我认为您的问题是 facebook.net 目前已关闭。

# bison - Reforming the grammar to remove shift reduce conflict in if-then-else

> ID：12731922
> 
> 赞同：22
> 
> 时间：2012-10-04T16:44:12.907
> 
> 标签：bison, shift-reduce-conflict

How do I remove shift-reduce conflict for bison for the given grammar?

```
 selection-stmt -> if ( expression ) statement |
                      if ( expression ) statement else statement 
```

A solution giving the modified grammar would be highly appreciated.

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-04T19:29:58.210

有一个更简单的解决方案。如果你知道 LR 解析器是如何工作的，那么你就会知道冲突发生在这里：

```
if ( expression ) statement * else statement 
```

其中星号标记光标的当前位置。解析器必须回答的问题是“我应该转移，还是应该减少”。通常，您希望将 绑定`else`到最近的`if`，这意味着您现在要移动`else`令牌。现在减少意味着您希望`else`等待绑定到“旧” `if`。

现在您想“告诉”您的解析器生成器“当令牌`"else"`与规则“stm -> if (exp) stm”之间存在移位/减少冲突时，那么令牌必须获胜”。为此，请为您的规则的优先级“命名”（例如`"then"`），并指定其`"then"`优先级低于`"else"`. 就像是：

```
// Precedences go increasing, so "then" < "else".
%nonassoc "then"
%nonassoc "else"
%%
stm: "if" "(" exp ")" stm            %prec "then"
   | "if" "(" exp ")" stm "else" stm 
```

使用 Bison 语法。

我对`%nonassoc`这里感到不安，因为它确实这么说`"then"`并且`"else"`是非关联的，这在大多数语法中都是如此，但我只是想给它们优先级，而不是关联性。野牛`%precedence`为此提供：

```
// Precedences go increasing, so "then" < "else".
%precedence "then"
%precedence "else"
%%
stm: "if" "(" exp ")" stm            %prec "then"
   | "if" "(" exp ")" stm "else" stm 
```

实际上，我最喜欢的答案是甚至给予`"then"`和`"else"`相同的优先级。当优先级相等时，为了打破想要移动的令牌和想要减少的规则之间的联系，Bison/Yacc 将查看关联性。在这里，可以说是要促进右结合性（更准确地说，是要促进“转变”），所以：

```
%right "then" "else" // Same precedence, but "shift" wins. 
```

就足够了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-04T17:17:57.903

您需要认识到`statement`if-else 案例中的中间不能是（或以）悬空 if（没有 else 的 if）。最简单的方法是将`stmt`规则一分为二：

```
stmt -> stmt-ending-with-dangling-if | stmt-not-ending-with-dangling-if
stmt-not-ending-with-dangling-if ->
    if ( expression ) stmt-not-ending-with-dangling-if else stmt-not-ending-with-dangling-if |
    ...other statements not ending with dangling if...
stmt-ending-with-dangling-if ->
    if ( expression ) stmt |
    if ( expression ) stmt-not-ending-with-dangling-if else stmt-ending-with-dangling-if |
    ...other statements ending with dangling if... 
```

任何其他不以 a 结尾的`stmt -> whatever`规则都在规则中，而任何以结尾的规则都分为两个版本；规则中的版本和规则中的版本。`whatever``stmt``stmt-not-ending-with-if``stmt``stmt``not-ending-with-if``not-ending-with-if``dangling-if``dangling-if`

**编辑**

其他产生式的更完整语法：

```
stmt : stmt-ending-with-dangling-if | stmt-not-ending-with-dangling-if
stmt-not-ending-with-dangling-if :
    IF '(' expr ')' stmt-not-ending-with-dangling-if ELSE stmt-not-ending-with-dangling-if |
    WHILE '(' expr ')' stmt-not-ending-with-dangling-if |
    DO stmt WHILE '(' expr ')' ';' |
    expr ';' |
    '{' stmt-list '}'
stmt-ending-with-dangling-if:
    IF '(' expr ')' stmt |
    IF '(' expr ')' stmt-not-ending-with-dangling-if ELSE stmt-ending-with-dangling-if |
    WHILE '(' expr ')' stmt-ending-with-dangling-if 
```

像这样的规则`WHILE (expr) stmt`一分为二（因为它们以 结尾`stmt`），而像`expr;`这样的规则则不会。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-03-25T09:19:44.543

使 if else 比普通语句更高级别，例如：

```
statements:
  statements lineEnd statement
| statements lineEnd IfStat
| statements lineEnd IfElseStat
| IfStat
| IfElseStat
;
IfStat:
  if ( statement )
;
IfElse:
  IfStat else statement
; 
```

# php - Pass WP post content to a JQuery plugin (Fancybox) - now with link

> ID：12731931
> 
> 赞同：0
> 
> 时间：2012-10-04T16:44:35.897
> 
> 标签：php, jquery, wordpress, jquery-plugins, fancybox

I've been struggling with this for days... hopefully this will bring some light into it.

I'm building a portfolio WP. It only displays image thumbnails, with a.video elements that call the fancybox. In the tags, the attributes have the information for the fancybox to load the content. The "href=" is the url of the video to show, the "title=" is the title of the post, etc.

I want to somehow bring the content of the post to the fancybox window and display it as the title (caption under the video).

My approach so far has been to bring the content of the post into the `<a>` tags and then passing that content into the FBox .js file.

I've brought the post content (the_content) to a custom attribute for `<a>`, eventid= and also have brought it to INSIDE the tags.

I've got that working: the post content are loaded in the index page both as the "eventid=" attribute and as the text inside the `<a>` tags.

This is how the Fbox calling element is loaded inside the WP loop in the index.

```
<a class="thumbnail-frame excerpt-text <?php if($video_url !='' || $embeded_code != '')         : ?>video<?php else: ?>shots<?php endif; ?>"
<?php if($video_url !='' || $embeded_code != '') : ?><?php else: ?>rel="set-<?php    the_ID(); ?>"<?php endif; ?> 
href="<?php if($video_url !='' || $embeded_code != '') : ?>#embed-<?php the_ID(); ?><?php else: ?><?php echo $upload_image_1; ?><?php endif; ?>" 
title="<?php the_title(); ?>" eventid="<?php the_content(); ?>"><span class="post"><?php the_content(); ?></span></a> 
```

However, I'm still having trouble in sending that text into the FBox javascript plugin so that the content is grabbed from the index and loaded in the Fbox.

The most I've done is

```
 'titleFormat' : function(title, currentArray, currentIndex, currentOpts) {
 return '<span id="fancybox-title-over">' + jQuery("a.video").html() + '</span>'; 
```

That posts the content of the FIRST post only inside the Fbox (it gets the content of the first a.video element it finds).

I've tried with

```
 'titleFormat' : function(title, currentArray, currentIndex, currentOpts) {
 return '<span id="fancybox-title-over">' + jQuery(this).html() + '</span>'; 
```

But it returns a null or undefined value and it prints it in the Fbox.

I'm stuck, I don't know how to grab the specific text content for each post and bring it into the FBox. I was thinking maybe using a global variable?

I'm a student so I'm clearly super novice, I just really want to surpass this obstacle.

Here's the link to the blog so you understand what I'm talking about.

[http://realitynext.heliohost.org/wordpress/](http://realitynext.heliohost.org/wordpress/)

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T20:24:15.373

如果要获取所有 a.video 元素，则需要`.each()`迭代器：

```
'titleFormat' : function(title, currentArray, currentIndex, currentOpts) {
  var string =  '<span id="fancybox-title-over">';
  jQuery("a.video").each(function() { string = string + $(this).html(); });
return string + '</span>';
} 
```

如果你只想要被点击的元素的内容，你需要这个：

```
'titleFormat' : function(title, currentArray, currentIndex, currentOpts) {
  return '<span id="fancybox-title-over">' + jQuery(currentArray[currentIndex]).html() + '</span>';
} 
```

# sql - 如何在sqlite中计算平方根

> ID：12731941
> 
> 赞同：20
> 
> 时间：2012-10-04T16:45:07.373
> 
> 标签：sql, sqlite, math

我需要在 sqlite 数据库中计算欧几里德距离。

除了为数学函数编写和加载动态库之外，有谁知道如何在 sqlite 中计算平方根？

[我即将在http://en.wikipedia.org/wiki/Fast_inverse_square_root](http://en.wikipedia.org/wiki/Fast_inverse_square_root)中使用快速逆平方根算法，尽管它可能会变得比我现在需要的更有趣。

作为旁注，弄清楚如何做功率会很棒（这是一个普遍的问题，并且比将一个数字本身相乘更简洁）。

谢谢，

西蒙妮

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-04T16:48:08.147

好吧，我有一个半答案。

是的，它涉及第 3 方，但您不必自己编写：您是否检查了[此页面](http://www.sqlite.org/contrib)上的最后一个扩展名？

它包括几个数学函数，其中包括 sqrt()。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-28T10:22:17.290

**警告：**此答案取决于编码语言。在我的情况下**C#**。

用户定义的 SQLite 函数对我来说实现起来很痛苦。最后，经过长时间的搜索，我能够在我的 C# 代码中实现它。主函数如下所示：

```
[SQLiteFunction(Arguments = 1, FuncType = FunctionType.Scalar, Name = "Sqrt")]
class Sqrt : SQLiteFunction
{
    public override object Invoke(object[] args)
    {
        return Math.Sqrt(Double.Parse(args[0].ToString()));
    }
} 
```

自定义函数的注册：

```
SQLiteFunction.RegisterFunction(typeof(Sqrt)); 
```

并在选择中使用：

```
SQLiteCommand com = new SQLiteCommand("select sqrt(10.42)", connection); 
```

你可以在这里下载完整的例子：http: [//db.tt/qzeNXwso](http://db.tt/qzeNXwso)

或者，如果您只想查看代码（或浏览我的代码的所有部分），我将在 SQLite 数据库中计算平方根的完整工作示例代码粘贴在下面，因为很难找到任何工作代码。要创建和运行此示例，请执行以下 6 个步骤：

1.  创建新项目（我的名字是 Sqrt）
2.  包括对您的项目的 SQLite 引用：
    *解决方案资源管理器 -> 引用（右键单击：添加引用）-> 程序集 - 扩展 - System.Data.SQLite（检查）-> 确定*
3.  打开*App.config*并替换为这个（没有这一步你可能会得到*混合模式组装*错误）：

    `<?xml version="1.0" encoding="utf-8" ?>`
    `<configuration>`
    `<startup useLegacyV2RuntimeActivationPolicy="true">`
    `<supportedRuntime version="v4.0"/>`
    `</startup>`
    `</configuration>`

4.  用以下代码替换您的*Form1.Designer.cs*：

    ```
    namespace Sqrt
    {
     partial class Form1
     {
     /// <summary>
     /// Required designer variable.
     /// </summary>
     private System.ComponentModel.IContainer components = null;

     /// <summary>
     /// Clean up any resources being used.
     /// </summary>
     /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
     protected override void Dispose(bool disposing)
     {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
     }

     #region Windows Form Designer generated code

     /// <summary>
     /// Required method for Designer support - do not modify
     /// the contents of this method with the code editor.
     /// </summary>
     private void InitializeComponent()
     {
        this.txb_Input = new System.Windows.Forms.TextBox();
        this.txb_Output = new System.Windows.Forms.TextBox();
        this.label1 = new System.Windows.Forms.Label();
        this.label2 = new System.Windows.Forms.Label();
        this.btn_Calcualte = new System.Windows.Forms.Button();
        this.SuspendLayout();
        // 
        // txb_Input
        // 
        this.txb_Input.Location = new System.Drawing.Point(131, 12);
        this.txb_Input.Name = "txb_Input";
        this.txb_Input.Size = new System.Drawing.Size(201, 20);
        this.txb_Input.TabIndex = 0;
        // 
        // txb_Output
        // 
        this.txb_Output.BackColor = System.Drawing.Color.WhiteSmoke;
        this.txb_Output.Location = new System.Drawing.Point(131, 38);
        this.txb_Output.Name = "txb_Output";
        this.txb_Output.ReadOnly = true;
        this.txb_Output.Size = new System.Drawing.Size(201, 20);
        this.txb_Output.TabIndex = 0;
        // 
        // label1
        // 
        this.label1.AutoSize = true;
        this.label1.Location = new System.Drawing.Point(12, 15);
        this.label1.Name = "label1";
        this.label1.Size = new System.Drawing.Size(31, 13);
        this.label1.TabIndex = 1;
        this.label1.Text = "Input";
        // 
        // label2
        // 
        this.label2.AutoSize = true;
        this.label2.Location = new System.Drawing.Point(12, 41);
        this.label2.Name = "label2";
        this.label2.Size = new System.Drawing.Size(39, 13);
        this.label2.TabIndex = 1;
        this.label2.Text = "Output";
        // 
        // btn_Calcualte
        // 
        this.btn_Calcualte.Location = new System.Drawing.Point(257, 64);
        this.btn_Calcualte.Name = "btn_Calcualte";
        this.btn_Calcualte.Size = new System.Drawing.Size(75, 23);
        this.btn_Calcualte.TabIndex = 2;
        this.btn_Calcualte.Text = "Calculate";
        this.btn_Calcualte.UseVisualStyleBackColor = true;
        // 
        // Form1
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(344, 98);
        this.Controls.Add(this.btn_Calcualte);
        this.Controls.Add(this.label2);
        this.Controls.Add(this.label1);
        this.Controls.Add(this.txb_Output);
        this.Controls.Add(this.txb_Input);
        this.Name = "Form1";
        this.Text = "Root square example";
        this.ResumeLayout(false);
        this.PerformLayout();
     }
     #endregion

     private System.Windows.Forms.TextBox txb_Input;
     private System.Windows.Forms.TextBox txb_Output;
     private System.Windows.Forms.Label label1;
     private System.Windows.Forms.Label label2;
     private System.Windows.Forms.Button btn_Calcualte;
     }
    } 
    ```

5.  打开 Form1.cs（代码）并将代码替换为： using System; 使用 System.Data.SQLite；使用 System.Windows.Forms；

    ```
    namespace Sqrt
    {
        // definition of custom sqlite function
        [SQLiteFunction(Arguments = 1, FuncType = FunctionType.Scalar, Name = "Sqrt")]
        class Sqrt : SQLiteFunction
        {
            public override object Invoke(object[] args)
            {
                return Math.Sqrt(Double.Parse(args[0].ToString())); // return result of math sqrt function
            }
        }

        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
                this.btn_Calcualte.Click += new System.EventHandler(this.btn_Calcualte_Click);
            }

            private void btn_Calcualte_Click(object sender, EventArgs e)
            {
                if (txb_Input.Text.Length == 0)
                    return;
                try { SQLiteConnection.CreateFile(AppDomain.CurrentDomain.BaseDirectory + "test.s3db"); }
                catch { }
                SQLiteConnection con = new SQLiteConnection("Data Source=test.s3db");
                SQLiteFunction.RegisterFunction(typeof(Sqrt)); // register custom function
                con.Open();
                SQLiteCommand com = new SQLiteCommand("select sqrt(" + txb_Input.Text.Replace(',', '.') + ")", con); // select result
                string res = com.ExecuteScalar().ToString();
                txb_Output.Text = res;
            }
        }
    } 
    ```

6.  奔跑，尝试和享受。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-19T21:24:44.457

这是 10000 以下数字的 sqrt 近似值。它可以扩展到任意数字，并且可以根据需要扩展到任意精度。无论如何，这种表格插值在大多数快速实现中都会发生：

```
case when weight >= 1 and weight<=10 then 1+0.240253073*(weight-1) 
     when weight>=10 and weight<=100 then 3.16227766+0.075974693*(weight-10) 
     when weight>=100 and weight<=1000 then 10+0.024025307*(weight-100)      
     else 31.6227766+0.007597469 *(weight-1000) end 
```

有一个奇怪的事实是，您在这样的 10 次方根插值表中使用的每个因子都是前一个因子的 0.316227766 倍——因此您可以使这个数字适用于任意大的数字，甚至可以将这些值填满一个表使其适用于任何数字。（这会导致这里的一些压缩吗？）

或者这个可爱的 log10 整数，使用 length 函数（插值表在这里可能工作得更好，但我喜欢 log10 和 length() 是相似的，这适用于任何整数 - 不需要插值。

```
 ((length(x)+length(x*2)+length(x*3)
  +length(x*4)+length(x*5))/5.0)-1.0 
```

一个比我更好的数学头脑可能会想出更好和更密集的近似值。考虑到 c 中的大多数 sqrt 函数无论如何都使用近似值 - 这是一个非常好的解决方案。

*这是唯一的本地方式。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-04T16:53:19.400

据我所知 - 你不能只使用核心功能来做到这一点。

这里是原生函数列表[核心函数](http://www.sqlite.org/lang_corefunc.html)和聚合函数列表[聚合函数](http://www.sqlite.org/lang_aggfunc.html)。

为了解决您的问题，您可以编写自己的 UDF（用户定义函数），如图所示[HERE](http://www.devart.com/dotconnect/sqlite/docs/Devart.Data.SQLite~Devart.Data.SQLite.SQLiteScalarFunction.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-12T20:54:07.960

> [2021-03-12 (3.35.0)](https://sqlite.org/changes.html#version_3_35_0)
> 
> **添加了内置的 SQL 数学函数（）**。（需要 -DSQLITE_ENABLE_MATH_FUNCTIONS 编译时选项。）

**[内置数学 SQL 函数](https://sqlite.org/lang_mathfunc.html)**

> **sqrt(X)** 返回 X 的平方根。如果 X 为负数，则返回 NULL。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-04-07T22:44:53.153

只有当数学函数不可用时......真的只是在绝望中，因为这不会很快......

```
-- bisect to find the square root to any tolerance desired
with 
 input(n) as (select 500), --input
 sqrt(lo, hi, guess, n, i) as (
  select 1, n, n/2, n, 0 from input
  union all
  select case when guess*guess < n then guess else lo end,
         case when guess*guess < n then hi else guess end,
         case when guess*guess < n then (hi+guess)/2.0 else (lo+guess)/2.0 end,
         n ,
         i +1 from sqrt
         where abs(guess*guess - n) > 0.0001), -- tolerance
 sqrt_out(x, n) as (select guess, n from sqrt order by sqrt.i desc limit 1)
 select * from sqrt_out 
```

# jquery - prevent jQuery validation messages until submit

> ID：12731944
> 
> 赞同：2
> 
> 时间：2012-10-04T16:45:36.980
> 
> 标签：jquery, jquery-validate

I just want to hide all the error message during and after typing the field (wrong input or empty field). And once the submit/button pressed then the message will all appear/visible.

The problem is... every time I typed wrong or I leave the text field empty it always shows the error message such "this fields is required", etc.

```
rules : {

    "user.firstname" : {
    required : true,
    maxlength: 50,

},
messsages : {
required : "required",
maxlength: "the max-length is 50"
"
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:51:13.583

根据[在线文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)，您需要使用`onfocusout:`和`onkeyup:`选项。

* * *

> 在模糊时验证元素（复选框/单选按钮除外）。如果未输入任何内容，则跳过所有规则，除非该字段已被标记为无效。

这*将禁用*onblur 验证：

```
onfocusout: false 
```

* * *

> 验证 keyup 上的元素。只要该字段未被标记为无效，就不会发生任何事情。否则，将检查每个按键事件的所有规则。

这*将禁用*onkeyup 验证：

```
onkeyup: false 
```

* * *

根据您是否有复选框和单选按钮，您可能还希望禁用该`onclick:`选项。

> 单击时验证复选框和单选按钮。

这*将禁用*onclick 验证：

```
onclick: false 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-04T17:02:01.593

而不是 $(document).ready(function(){} 您可以尝试使用

```
$('input[type=submit]').click(function(event) {
 // Do your validation, if it fails use event.preventDefault();  
}); 
```

试试看，让我知道会发生什么...

# lucene - lucene index query without key

> ID：12731945
> 
> 赞同：0
> 
> 时间：2012-10-04T16:45:40.893
> 
> 标签：lucene

Can we do a lucene query without the key and just providing the value? For ex: Lets have index is on created on following two properties, city and country Now, can i search, "*:query" , without specifying any of the properties name.

Thanks, Abdul

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T20:44:41.363

您可以配置一个默认字段，但如果您想使用单个查询词搜索两个（或全部）数据，您可以创建一个新字段进行搜索，并将所有用于搜索的数据添加到该字段。所以现在你要添加：

```
city: mycity
country: mycountry 
```

您可以添加另一个字段，将其称为地址或文本，这对您的使用有意义，因此我们有：

```
city: mycity
country: mycountry
address: mycity mycountry  maybe even some other things too 
```

我现在可以搜索城市或国家或两者的“地址”，并按相关性进行良好排序。

您需要确保 'city' 和 'country' 并已存储 (Field.Store.YES)，以便稍后获取它们。“地址”仅用于搜索，因此请确保已对其进行索引（Field.Index.ANALYZED），并且很可能未存储（Field.Store.NO）。是否要索引城市和国家取决于您，但如果您只想搜索一个词作为国家，这可能不是一个坏主意。

# javascript - 如何以 Metro 风格进行简单的 html 5 验证？

> ID：12731947
> 
> 赞同：0
> 
> 时间：2012-10-04T16:45:45.737
> 
> 标签：javascript, html, windows-8, microsoft-metro

我正在使用 Html 5 和 Javascript 开发 Windows 8 Metro 风格应用程序

我的问题很简单，如何编写带有验证的简单表单？

```
<form id="loginForm">
        E-Mail:
        <input id="login-email" type="email" name="Username" oninvalid="this.setCustomValidity('Enter email pls')" 
    maxlength="40" required pattern="^.{2,}@.{2,}$"/>

        Password:
        <input id="login-password" type="password" name="Password" maxlength="25" required pattern=".{6,10}"/>

    <button name="login" type="submit" class="go-login" id="btnlogin" value="LOGIN">LOGIN</button></form> 
```

这是我的 html 5 表单。但问题是地铁风格的事件监听器......

```
document.getElementById("btnlogin").addEventListener('click', loginClick); 
```

当我单击提交按钮时，EventListener 的“loginClick”函数会启动而不检查 html 5 表单输入元素是否有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:11:26.757

根据 w3schools，您必须在表单标签中调用 onsubmit="return function()" 。这样，它不应该在没有经过验证的情况下继续提交。

从 W3schools 获取：

```
<form name="myForm" action="demo_form.asp" onsubmit="return validateForm();" method="post">
Email: <input type="text" name="email">
<input type="submit" value="Submit">
</form> 
```

和所属的javascript：

```
function validateForm()
{
var x=document.forms["myForm"]["email"].value;
var atpos=x.indexOf("@");
var dotpos=x.lastIndexOf(".");
    if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x.length)
    {
        alert("Not a valid e-mail address");
    return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T13:49:53.853

在使用 HTML5/JS Windows Store Application (WSA) 时遇到了同样的问题。期望是在客户端上通知用户并且“提交”中的代码不会运行。这是我们在浏览器中运行的基于 Web 的 HTML5 应用程序所看到的。但是，无论验证状态如何，当单击按钮时 WSA 应用程序都会运行提交代码。在我的应用程序中，我检查了 loginForm.checkValidity() 属性。当所有验证都正确时，这是正确的。

```
if (loginForm.checkValidity())
{
  //...submit logic...
} 
```

我同意，鉴于我们对网络世界的期望，这项检查是一个额外的步骤。这仍然是 WSA 平台的第 1 版，我预计此功能将在未来的更新/发布中演变成产品。

# python - python crawler stalled with no warning or error

> ID：12731948
> 
> 赞同：0
> 
> 时间：2012-10-04T16:45:47.507
> 
> 标签：python

my code are here: [https://gist.github.com/3834860](https://gist.github.com/3834860)

it will stall after run for a while,the output like following:

```
2012-10-05 00:42:31,932 - DEBUG - next_url ishttp://m.tianya.cn/bbs/list.jsp?item=free&p=4&n=2012-10-05 00:41:23.213&idwriter=0&key=0&chk=&vu=49368951554
2012-10-05 00:42:33,914 - DEBUG - ['2366245', '2800363', '2698574', '2797207', '2801356', '2212342', '2216658', '2799029', '2747949', '2801410', '2562954', '2800201', '2188615', '2801369', '2800497', '2800402', '2731162', '2801265', '2800437', '2799819']
2012-10-05 00:42:34,462 - DEBUG - next_url ishttp://m.tianya.cn/bbs/list.jsp?item=free&p=5&n=2012-10-05 00:41:23.213&idwriter=0&key=0&chk=&vu=49368954180 
```

and it just stall there,no warning or error,i can't debug it,because it will stall after 1 hour later.

I don't know how to debug it,anyone can tell me?

# google-apps-script - Google Apps Script in Spreadsheet storing decimal values instead of Integer in Project Properties

> ID：12731949
> 
> 赞同：4
> 
> 时间：2012-10-04T16:45:47.853
> 
> 标签：google-apps-script

This is my first post. I tried searching via Google and this site but really couldn't find any info about typecasting or converting numerical values within GAS specifically in this scenario. So here the problem:

I have a very basic script attached to a Google Spreadsheet. The script simply keeps track of the last row that was populated, increments the value by one, so that the next row can be populated. I'm storing the "last row used" as a Project Property. For some reason, the script keeps writing the value back into Project Properties as a decimal value, which throws off the whole script since it seems I can't use a decimal value to reference a cell location.

Here is the code snippet:

```
function onEdit(e) {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var value = ss.getSheetByName("Sheet1").getRange("D13").getValue().toString();
  var last = ScriptProperties.getProperty("last");

  var therowx = parseInt(ScriptProperties.getProperty("therow"));
  Browser.msgBox("The last row is: " + therowx);

  if( value != last ) {
    ScriptProperties.setProperty("last", value);
    ScriptProperties.setProperty("therow", therowx + 1);
  }
} 
```

Assuming that I've pre-set the Property to 1 before running the script, once this method fires, it sets it to 2.0 instead of just 2\. I've tried wrapping the method call with the Number() and parseInt() functions but they don't seem to make a difference.

I'm open to suggestions, as I'm sure I'm doing something wrong but just not quite sure what.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T02:25:48.413

您似乎正在使用电子表格中的值 var value = ss.getSheetByName("Sheet1").getRange("D13").getValue().toString();
这是您获得小数点的情况，因为 Google 电子表格将默认为小数点后一位。您需要突出显示列或单元格并将格式更改为 Number>Rounded 以摆脱它。
我确定我在这里遗漏了您完整脚本的一些组件，但是您是否尝试过“getLastRow”功能？教程中有一些使用它的脚本，它是一种经过验证的真实方法，可以找到工作表的最后一行。

# asp.net-mvc-3 - 如何在 asp.net mvc 中使用 3 个参数登录

> ID：12731953
> 
> 赞同：0
> 
> 时间：2012-10-04T16:46:13.560
> 
> 标签：asp.net-mvc-3

我有一个应用程序，其中一个用户名可以属于许多公司。因此，为了区分它们，我需要使用用户名和密码作为唯一对登录。

我正在使用 ASP.NET MVC，但我很难理解登录发生的位置。实际上我可以看到它在哪里验证用户，但我没有找到它在哪里检索用户。

那么在哪里

> 选择出现 username=xx 和 password=xx 的用户？

不同地问：我没有找到用户设置在哪里？我在代码中看到了 User.Identity.Name 它，但我没有看到：User=Select....

谢谢约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T17:32:55.223

约翰，因为您正在使用 MVC。除了 LINQ 语法之外，您不会在代码中看到任何查询。我猜你想要做的是用户表和公司表之间的多对多关系。（一个用户有多个公司，1 个公司有多个用户）在数据库方面，这意味着您需要一个额外的表，其中包含 Company 和 Users 的主键。

回到你的问题。ASP.net MVC 有自己的成员资格提供程序。您可以选择使用带有自己的表的默认表或覆盖它并创建您自己的**自定义成员资格提供程序**（能够使用您自己的用户表）

默认值几乎应该包含大部分基本属性。（密码重置，密码盐，电子邮件，..） [http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs](http://www.asp.net/web-forms/tutorials/security/membership/creating-the-membership-schema-in-sql-server-cs) 跳到步骤：**安装应用程序服务**以生成表

但是，猜测您已经拥有一个带有您自己的用户表的数据库。您应该覆盖自定义成员资格类。

简单地说，这意味着您创建了一个继承自抽象类“MembershipProvider”的新类

```
public class MyMembershipProvider : MembershipProvider
{ 

} 
```

之后，您必须让 asp 知道您将在**web.config**中用您的默认成员资格提供程序覆盖：

```
<membership defaultProvider="MyMembershipProvider">
      <providers>
        <clear />
        <add name="MyMembershipProvider"
             applicationName="MyApp"
             Description="My Membership Provider"
             passwordFormat="Clear"
             connectionStringName="MyMembershipConnection"
             type="MyApp.MyMembershipProvider" />
      </providers>
    </membership> 
```

成员资格提供程序中的某些方法要求您返回或使用**MembershipUser**的对象。如何实现这一点的一切都在这里：http: [//msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx) 这不是必要的步骤，但它是推荐的。

祝你好运约翰 :) 如果解释中有任何混淆，请不要犹豫，问

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:31:59.537

简短的回答：

您描述的代码发生在帐户控制器的 LogOn 操作的幕后：

```
MembershipService.ValidateUser(model.UserName, model.Password) 
```

对于有效用户返回 true。然后用户使用代码中的下一行“登录”：

```
FormsService.SignIn(model.UserName, model.RememberMe) 
```

（您可以在 Models 文件夹下的 AccountModels 文件中看到这两个函数的定义）

如果您还想在验证用户身份时检查公司 ID，那么您需要编写自己的身份验证方法来替换 ValidateUser。这将取决于您用于商店的内容（SQL？）

但是，作为更广泛的观点，最佳实践不应允许不同用户使用相同的用户名。这只是一个坏主意，会导致麻烦。

更新：

如果我建议如何执行此操作，我建议您使用 ASP.NET Membership 的 UserProfile 方面。它旨在捕获和存储其他用户变量（例如公司），同时仍使用他们为您编写的精心构建且安全的会员资格。阅读它，但下面是我当前正在开发的应用程序中的 CreateUser 函数。请注意我如何使用配置文件来存储名字和姓氏以及用户需要重置密码的标志。

同样，这会抢占多个用户使用相同用户名的能力，但我真的认为你应该避免这种情况。

```
[HttpPost]
public ActionResult CreateUser(string username, string email, string first, string last, string role)
{            
    string password;
    MembershipUser user;

    //Generate a random password
    password = Auth.CreateRandomPassword(6);

    try
    {
        //Create the user
        user = Membership.CreateUser(username, password, email);

        //Add the user to the chosen role
        Roles.AddUserToRole(username, role);

        //Create the user profile
        UserProfile profile = UserProfile.GetUserProfile(username);

        profile.FirstName = first;
        profile.LastName = last;
        profile.ForcePasswordReset = true;

        profile.Save();

        EmailNewUser(username, email, password);

    }
    catch (Exception ex)
    {                
        HttpContext.Response.StatusCode = 500;
        HttpContext.Response.StatusDescription = ex.Message;
        HttpContext.Response.Clear();
    }

    return PartialView("UserTable", Auth.Users());

} 
```

# c++ - 如何在 C/C++ 上创建和保存 .docx 文档？

> ID：12731958
> 
> 赞同：2
> 
> 时间：2012-10-04T16:46:25.703
> 
> 标签：c++, c, ms-word, ms-office

我需要使用 C/Visual C++ 操作 .docx 文档。我找到的任何示例都是 c# 示例。怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T16:58:34.463

我发现微软希望您使用 .NET 或使用他们的 Office 自动化 API 来调用 Word 为您执行操作。根据您希望使用这些操作的程度，您可能能够使用 Office 自动化 API。如果没有，您可能不得不使用 .docx 文件格式背后的 Open Office XML 格式。

[这是微软关于办公自动化的简短文档](http://support.microsoft.com/kb/196776)

[这是一篇更深入的文章，尽管它可能已经过时了。](http://www.codeguru.com/cpp/com-tech/atl/tutorials/article.php/c14519/Microsoft-Word-Automation-Class.htm)

我只是认为 Office 自动化的一个大问题是你需要 Word 来处理它。当然，这一切都取决于您到底需要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-06T05:01:13.307

试试[http://libopc.codeplex.com/](http://libopc.codeplex.com/)

# c++ - 计算定向运动的算法

> ID：12731959
> 
> 赞同：2
> 
> 时间：2012-10-04T16:46:29.767
> 
> 标签：c++, rotation, trigonometry, sfml

我正在尝试使用 SFML 用 C++ 编写一个基本的小行星游戏。虽然我能够相当轻松地移动我的三角形（玩家），但它的移动方式我并不十分满意。

目前，运动与它所面对的方向*无关。*例如，如果我按“w”向前移动，三角形将简单地向上移动屏幕而不管它的方向。

我想让三角形做的是在按下“w”键时向前移动，但使其实际移动方向（相对于屏幕尺寸）相对于它所面对的实际方向。

所以，如果三角形的前端朝右，当按下“W”时，它会向右移动。如果在这种情况下按下“S”，它将向左移动。“A”会使其向上移动，当然“D”会使其向下移动。

我当前的代码没有完成这一点 - 我认为对此有一个*非常*hacky的解决方案，但如果可能的话，我宁愿从更数学和更优雅的角度来解决这个问题。

**那么，实现这一目标的最佳方法是什么？**

我有三种相关方法：一种用于处理键盘输入，另一种用于处理鼠标移动，以及一种更新方法。

* * *

**代码**

```
void Game::OnKeyPress( void )
{
    int count = 0;

    const float playerCenterMag = Magnitude( mPlayer.GetShape().GetCenter() );
    //Shoddy attempt resulting in absolutely nothing of note
    const float moveRateX = ( cosf( mMouseAoR ) * playerCenterMag ) + mPlayer.MoveSpeed;
    const float moveRateY = ( sinf( mMouseAoR ) * playerCenterMag ) + mPlayer.MoveSpeed;

    if ( mInput.IsKeyDown( sf::Key::W ) ) // Up
    {
        mPlayer.Position.y -= moveRateY;
        ++count;
    }

    if ( mInput.IsKeyDown( sf::Key::S ) ) // Down
    {
        mPlayer.Position.y += moveRateY;
        ++count;
    }

    if ( mInput.IsKeyDown( sf::Key::A ) ) // Left
    {
        mPlayer.Position.x -= moveRateX;
        ++count;
    }

    if ( mInput.IsKeyDown( sf::Key::D ) ) // Right
    {
        mPlayer.Position.x += moveRateX;
        ++count;
    }

    std::cout << "Key Press Rate => " << count << " seconds" << std::endl;
}

void Game::OnMouseEvent( void )
{
    mPlayer.GetShape().Rotate( mMouseAoR + 5 );
}

void Game::Update( void )
{
    const int x = mInput.GetMouseX();
    const int y = mInput.GetMouseY();

    mMouseAoR = ( y == 0 ) ? 0
                           : tanf( x / y );

    PrintInfo();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:01:17.097

这个游戏有两个版本。如果你想，比如说，“W”向前“推进”，那么你需要在每个周期添加 moveRate 并使用 W 来改变速率。

显然，只有在按下按钮时您才会移动，因此您需要始终更新 X 和 Y：

```
if ( mInput.IsKeyDown( sf::Key::W ) ) // Up
{
    mPlayer.Position.x += moveRateX;
    mPlayer.Position.y += moveRateY;
    ++count;
} 
```

moveRate 根据方向变化。横向移动时，你会做

```
 mPlayer.Position.x += moveRateY;
    mPlayer.Position.y += moveRateX; 
```

向左（或向右）移动时，`-=`向另一个方向移动。

# php - 整数或非整数。如何修复代码？

> ID：12731960
> 
> 赞同：1
> 
> 时间：2012-10-04T16:46:29.317
> 
> 标签：php, string, int

我希望下面的代码第一次返回“Int”，第二次返回“Not int”。不幸的是，它两次返回“Not int”。

我怎样才能解决这个问题？

```
<?php
$test1='1';
if(is_int($test1)){
        echo "Int";
}else{
        echo "Not int";
}

echo "\n";

$test2='1a';
if(is_int($test2)){
        echo "Int";
}else{
        echo "Not int";
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T16:48:15.570

通过将数字括在引号中`'1'`，您声明了一个字符串。相反，您必须使用`$test1 = 1;`.

通过使用 PHP[`ctype_digit()`](http://php.net/manual/en/function.ctype-digit.php)函数，您可以检查字符串是否仅包含数字。
您还可以使用该[`is_numeric()`](http://www.php.net/manual/en/function.is-numeric.php)函数，如果字符串包含指数部分`+0123.45e6`或十六进制值，该函数也会返回 true `0xFF`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T16:49:48.637

is_int - 查找变量的类型是否为整数 因为您将数字放在引号中，所以它是一个字符串。因此 is_int = false

is_numeric — 查找变量是数字还是数字字符串 因为字符串实际上是数字，所以 is_numeric 将返回 true

因此，将 is_int 更改为 is_numeric 即可：

```
<?php
$test1 = '1';
if (is_numeric($test1))
{
    echo 'Int';
}
else
{
    echo 'Not int';
}

echo "\n";

$test2 = '1a';
if (is_numeric($test2))
{
    echo 'Int';
}
else
{
    echo 'Not int';
}
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T16:48:26.097

改为使用[`ctype_digit()`](http://php.net/manual/en/function.ctype-digit.php)。

```
ctype_digit('1'); // True
ctype_digit('1a'); // False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-04T16:49:43.653

改变

```
 $test1='1'; 
```

至

```
 $test1=1; 
```

# selenium - 从 CloudBees 将 Firefox 配置文件发送到 Sauce Labs

> ID：12731962
> 
> 赞同：2
> 
> 时间：2012-10-04T16:46:46.700
> 
> 标签：selenium, selenium-webdriver, cloudbees, saucelabs

我有一个 Selenium 测试，需要将自定义的 firefox 配置文件上传到 Sauce Labs。我已将文件上传到 cloudbees 站点上引用的文件共享存储库：

[https://cloudbees.zendesk.com/entries/438491-sharing-files-with-build-executors-such-as-maven-settings-xml](https://cloudbees.zendesk.com/entries/438491-sharing-files-with-build-executors-such-as-maven-settings-xml)

我在我的 Jenkins 工作中启用了 Sauce Connect，并且还配置了用户和 api 密钥。我还为酱实验室上的自定义 Firefox 配置文件使用添加了配置

[http://saucelabs.com/docs/additional-config](http://saucelabs.com/docs/additional-config)

像这样使用 setCapability 方法：

```
capabilities.setCapability("firefox-profile-url","https://repository-myProfile.forge.cloudbees.com/private/ffprofile/sauce.zip"); 
```

但是，文件似乎没有像我想象的那样传输。Sauce Connect 是否以某种方式无法与 CloudBees 通信并通过 URL 访问文件？有没有其他方法可以让 Sauce Labs 的 firefox 配置文件在我的测试中使用？

# javascript - 如何使绝对定位的元素不相互重叠？

> ID：12731964
> 
> 赞同：1
> 
> 时间：2012-10-04T16:46:50.620
> 
> 标签：javascript, jquery, positioning, css-position

这是我想做的事情：我正在使用[gridster](http://gridster.net/)来创建表单创建 IDE。用户拖动网格中的元素，并可以移动它们。

在编辑器中一切正常，但是当我尝试使用这些表单时，当网格位置内的元素变得大于包含它们的网格块时，我遇到了问题，从而使一个元素与另一个元素重叠。

我正在寻找的是一个自动化的解决方案，当给定一堆绝对定位的元素时，它会向上或向下移动它们，这样它们就不会重叠。这样的事情存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:49:59.177

绝对定位的全部意义在于它覆盖了客户端重排布局的能力。您所要求的与绝对定位的目的直接冲突。

从理论上讲，您可以在每次发生变化时运行一些 javascript 并重新计算所有布局并四处移动，但要做到这一点需要做很多工作。

您可能还会与 Gridster 的代码发生冲突。所以你需要考虑到这一点，甚至可能需要重写 Gridster 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T11:37:59.073

我自己做了一个解决方法

我写了这段代码，并将它放在一个一直循环的区间内，使属于同一列的元素不重叠。

请注意，这`.gs_w`是 gridster 网格单元的类，其中包含`.form_row`又包含输入元素本身并缩小以适应它。

最后，如果启用了拖动，这将不起作用，在我的情况下这是可以的，因为只有我构建的表单编辑器使用拖动。不是表格本身。

```
setInterval(collision_checks);

/**
 * Handles vertical collisions of gridster elements
 */
function collision_checks()
{
    var elements = $('.gs_w');
    if(!$(elements).length)
    {
        return;
    }

    var columns = {};
    // Group the elements in columns
    $(elements).each(function(){
        //If an element takes more than one columns, add it in all of them
        //so collision gets handled properly
        for(var i = 0; i < $(this).data('sizex'); i++)
        {
            columns[parseInt($(this).data('col'), 10) + i] = columns[parseInt($(this).data('col'), 10) + i] || [];
            columns[parseInt($(this).data('col'), 10) + i].push(this);
        }

    });

    // For each column, handle if it's elements collides with the element below it
    for(var i in columns)
    {
        if(!columns.hasOwnProperty(i)){continue;}
        var column = columns[i];
        for(var j in column)
        {
            if(!column.hasOwnProperty(j)){continue;}
            var element = column[j];
            var element_below = column[parseInt(j,10) + 1];

            if(!$(element).is(':visible'))
            {
                continue;
            }

            if(element == element_below)
            {
                continue;
            }

            var depth = penetration_depth(element, element_below);
            if(depth)
            {
                var offset = $(element_below).position();
                $(element_below).css('top', offset.top + depth);
            }
        }
    }
}

/**
 * if the top element overlaps the bottom one, this function returns their penetration depth
 */
function penetration_depth(el_top, el_bottom)
{
    if(!el_bottom){return 0;}
    if($(el_top).find('.form_row').offset().top + $(el_top).find('.form_row').outerHeight(true) > $(el_bottom).find('.form_row').offset().top)
    {
        return $(el_top).find('.form_row').offset().top + $(el_top).find('.form_row').outerHeight(true) - $(el_bottom).find('.form_row').offset().top;
    }
    else
    {
        return 0;
    }
} 
```

欢迎任何建议或改进！

# zend-framework - Zend_Form : 使用图像而不是文本标签？

> ID：12731968
> 
> 赞同：0
> 
> 时间：2012-10-04T16:47:11.493
> 
> 标签：zend-framework, zend-form, zend-decorators

我想用一些图像替换公共输入的标签。我有一个带有国家列表的多复选框，我想为每个复选框显示国家标志而不是它的名称。

我试图将`<img/>`标签作为标签值，但是这个 html 被转义并显示为文本而不是显示图像......

有本地解决方案吗？我应该创建一个自定义装饰器吗？

我目前正在尝试创建一个自定义装饰器，但我是菜鸟，我很确定还有其他更清洁的方法！感谢帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:20:25.810

好吧，我终于自己找到了……太简单了，我什至没有考虑。

创建表单元素时，可以将选项设置`escape`为`false`：

```
$this->addElement('multiCheckbox', 'countries', array(
    'filters'    => array(/* some filters */),
    'validators' => array(/* some validators */),
    'label'      => 'Countries :',
    'decorators'  => array( /* some decorators */ ),
    'escape'     => false, /* will prevent the checkboxes' labels to be escaped */
)); 
```

由于我的复选框标签不再被转义，我可以在里面设置一些 html :)

# android - Android HttpPost 正在下载错误的 SSL 证书

> ID：12731970
> 
> 赞同：1
> 
> 时间：2012-10-04T16:47:13.217
> 
> 标签：android, ssl

所以，在我的网站上，我使用了几个不同的 SSL 证书。一个用于根域“illution.dk”，一个用于我的子域“ci.illution.dk”。麻烦的是，当我使用 HttpPost 发起一个发布请求时，我请求一个像“https://ci.illution.dk/login/device”这样的 URL，它只是抛出一条错误消息说：

```
10-04 18:35:13.100: W/System.err(1680): javax.net.ssl.SSLException: hostname in certificate didn't match: <ci.illution.dk> != <www.illution.dk> OR <www.illution.dk> OR <illution.dk> 
```

我认为这意味着它正在下载 illution.dk 的证书，然后看到它不支持 ci.illution.dk。但是，当我加载浏览器并浏览到“https://ci.illution.dk”时，一切都很好。我的安卓代码如下：

```
HttpClient httpclient = new DefaultHttpClient();
        //appContext.getString(R.string.base_url)
        HttpPost httppost = new HttpPost("https://ci.illution.dk/login/device");

        try {
            // Add your data
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("username", params[0]));
            nameValuePairs.add(new BasicNameValuePair("password", params[1]));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            httppost.addHeader("Content-Type", "application/x-www-form-urlencoded");

            // Execute HTTP Post Request
            HttpResponse response = httpclient.execute(httppost);
            return response;
        } catch (ClientProtocolException e) {
            Log.d("ComputerInfo", "Error while loggin in: ClientProtocolException");
            return null;
        } catch (IOException e) {
            Log.d("ComputerInfo", "Error while loggin in: IOException");
            e.printStackTrace();
            return null;
        } catch (Exception e) {
            Log.d("ComputerInfo", "Error while loggin in");
            e.printStackTrace();
            return null;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T17:00:57.457

只要看看下面的代码你就会得到答案。我在我的代码中使用了它。你必须在你的代码中使用。

BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);

StringBuilder sb = new StringBuilder();

字符串线=空；

while ((line = reader.readLine()) != null) {

sb.append(line + "\n");}

is.close();

看看我在其中使用的以下示例

```
 ArrayList<DailyExpDto> list = new ArrayList<DailyExpDto>();
    List<NameValuePair> qparams = new ArrayList<NameValuePair>();
    qparams.add(new BasicNameValuePair("date", "" + date));
    qparams.add(new BasicNameValuePair("uid", ""
            + Myapplication.getuserID()));

    try {
        HttpClient httpclient = new DefaultHttpClient();
                    httpclient.getCredentialsProvider().setCredentials(
                new AuthScope(null, -1),
                new UsernamePasswordCredentials("YOURUSRNAME", "YOURPASSWORD"));
        HttpPost httppost = new HttpPost(url + "daily_expenditure.php?");
        httppost.setEntity(new UrlEncodedFormEntity(qparams));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        is = entity.getContent();
    } catch (Exception e) {
        Log.e("log_tag", "Error in http connection " + e.toString());
    }
    // convert response to string
    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();

        result = sb.toString();
    } catch (Exception e) {
        Log.e("log_tag", "Error converting result " + e.toString());
    }

    Log.v("log", result);
    JSONObject jobj = null;
    try {
        jobj = new JSONObject(result);

    } catch (JSONException e) {
        Log.e("log_tag", "Error parsing data " + e.toString());
    }
    try {

        JSONArray JArray_cat = jobj.getJSONArray("category");
        JSONArray JArray_desc = jobj.getJSONArray("description");
        JSONArray JArray_exp = jobj.getJSONArray("expenditure");
        for (int i = 0; i < JArray_cat.length(); i++) {
            DailyExpDto dto = new DailyExpDto();
            dto.category = JArray_cat.getString(i);
            dto.desc = JArray_desc.getString(i);
            dto.exp = JArray_exp.getInt(i);
            list.add(dto);
        }

    } catch (Exception e) {
        // TODO: handle exception
    }
    return list;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T18:09:16.563

好的，这似乎是 HttpPost 的错误，因为如果我使用[此处](http://digitallibraryworld.com/?p=189)链接的代码，它就可以工作。我已经修改了代码以满足我的特定需求，但这是我的代码：（以防万一链接断开）

```
 StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();

    StrictMode.setThreadPolicy(policy);

//do this wherever you are wanting to POST
    URL url;
    HttpURLConnection conn;

    try{
    //if you are using https, make sure to import java.net.HttpsURLConnection
    url=new URL("https://ci.illution.dk/login/device");

    //you need to encode ONLY the values of the parameters
    String param="username=" + URLEncoder.encode("usernametest","UTF-8")+
    "&password="+URLEncoder.encode("passwordtest","UTF-8");

    conn=(HttpURLConnection)url.openConnection();
    //set the output to true, indicating you are outputting(uploading) POST data
    conn.setDoOutput(true);
    //once you set the output to true, you don't really need to set the request method to post, but I'm doing it anyway
    conn.setRequestMethod("POST");

    //Android documentation suggested that you set the length of the data you are sending to the server, BUT
    // do NOT specify this length in the header by using conn.setRequestProperty("Content-Length", length);
    //use this instead.
    conn.setFixedLengthStreamingMode(param.getBytes().length);
    conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
    //send the POST out
    PrintWriter out = new PrintWriter(conn.getOutputStream());
    out.print(param);
    out.close();

    //build the string to store the response text from the server
    String response= "";

    //start listening to the stream
    Scanner inStream = new Scanner(conn.getInputStream());

    //process the stream and store it in StringBuilder
    while(inStream.hasNextLine())
        response+=(inStream.nextLine());

        Log.d("Test", response);
    }

    //catch some error
    catch(MalformedURLException ex){
    Toast.makeText(MainActivity.this, ex.toString(), 1 ).show();

    }
    // and some more
    catch(IOException ex){

    Toast.makeText(MainActivity.this, ex.toString(), 1 ).show();
    } 
```

# objective-c - 如何将单词分配给特定的字母？

> ID：12731971
> 
> 赞同：0
> 
> 时间：2012-10-04T16:47:17.367
> 
> 标签：objective-c, nsstring, character, nsdictionary, morse-code

我目前正在制作一个类似于摩尔斯电码的应用程序，通过使用`isEqualToString`方法来编码，比如 A = hello, B = good。

```
-(NSString*)checkWords :(NSString*)words{
NSString * letter;

if (([words isEqualToString:@"a"]) || ([words isEqualToString:@"A"])){
    letter = @"hello";        }
if (([words isEqualToString:@"b"]) || ([words isEqualToString:@"B"])){
    letter = @"good";        }
return letter;

} 
```

通过单击下面的按钮将生成代码：

```
- (IBAction)decodeBtn:(id)sender {

outputTextField.text = @"";
NSString * inputString = outputView.text;
int wordLength = [inputString length]; //gets a count of length

int i = 0;
while (i < wordLength) {

    unichar charToCheck = [inputString characterAtIndex:i];
    if (charToCheck != 32){ // checks to make sure its not a space

        NSString* words = [NSString stringWithCharacters:&charToCheck length:1];

        NSString * letter = [self checkWords:words];

        NSString * stringToAppend = outputTextField.text;
        if (letter != @""){
            outputTextField.text = [stringToAppend stringByAppendingString:letter];
        } else {
            // new line?
        }
        letter = nil;
    }
    i++;
  }
} 
```

我可以得到我需要的那些单词的字母表。我想知道我应该使用哪种方法将单词解码回字母表？也就是说，当用户输入“hello good”时，输出会是“A B”？

非常感谢。

如果我这样写，应用程序会崩溃：

[EncodeViewController copyWithZone:]：无法识别的选择器发送到实例

```
-(NSString*)checkWords :(NSString*)words{
NSString * letter;

if ([words isEqualToString:@"hello"]) letter = @"A";
if ([words isEqualToString:@"good"]) letter = @"B";

return letter;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T17:31:47.540

```
NSArray* words = [sentence componentsSeparatedByString:@" '];
NSMutableString* output = [NSMutableString string];
for (NSString* word in words) {
   word = [word lowercaseString];
   NSString* letter = [translationDict objectForKey:word];
   [output appendFormat:@"%@ ", letter];
} 
```

要创建您的 translationDict，请使用：

```
NSDictionary* translationDict = [NSDictionary dictionaryWithObjectsAndKeys:@"apple", @"A", @"banana", @"B", @"chocho", @"C", @"dingodog", @"D", .... @"Z", nil]; 
```

然后，您可以在任一方向使用翻译循环（如果您的各个字母由空格分隔），键和值的顺序在`translationDict`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T17:05:49.867

制作你自己的方法并从某个地方调用它，内容有点像：

```
if ([userInput isEqualToString:@"apple banana"]) {
    NSMutableString * firstCharacters = [NSMutableString string];
    NSArray * words = [userInput componentsSeparatedByCharactersInSet:[NSCharacterSet whitespaceCharacterSet]];
    for (NSString * word in words) {
      if ([word length] > 0) {
        NSString * firstLetter = [word substringToIndex:1];
        [firstCharacters appendString:[firstLetter uppercaseString]];
//NSLog firstLetter and you get the result :)
      }
    }
} 
```

试试看 ：）

# c# - WinRT中如何实现无缝页面导航？

> ID：12731972
> 
> 赞同：3
> 
> 时间：2012-10-04T16:47:21.430
> 
> 标签：c#, xaml, microsoft-metro, windows-runtime

每当我似乎在我的 Metro 应用程序中从一个页面导航到另一个页面时，都会出现一个“闪光”，其中什么都没有显示——只有默认的背景颜色。如何使 Frame.Navigate 方法正确转换？我的应用程序的图像很重，所以我想部分原因是图像加载。不过我尝试过其他应用程序，似乎也有类似的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-08T19:43:17.037

我找到的解决方案是使用 WinRT XAML Toolkit，它具有 AlternativePage 和 AlternativeFrame 的控件。我使用扩展的初始屏幕来预加载 MainPage 和用户可能需要快速访问的任何页面 - 然后我在可能需要时预加载其他页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T17:30:11.987

在使用图像密集型 Metro 应用程序时，我遇到了同样的问题。简而言之，我从来没有找到一种无缝、不冲突的过渡方式，即使是在对加载的项目进行排序并通过异步调用填充适当的元素时也是如此。

我最终做的是对第一页的父元素应用淡出效果，并在第二页上应用淡入效果。它使负载更令人赏心悦目。不是带有图像的弹出效果，而是平滑过渡。它确实比非褪色版本增加了一个非常短的延迟，但它看起来更加有机和吸引人。

# xcode - 在 ipad 上访问 plist 时应用程序崩溃，但在模拟器中没有

> ID：12731974
> 
> 赞同：0
> 
> 时间：2012-10-04T16:47:24.590
> 
> 标签：xcode, plist

在我的应用程序中，我使用 3 个不同的 plist。其中两个工作正常，但是当我尝试访问第三个时，它在 ipad 上崩溃。在模拟器中工作正常。

这是我用来访问我的 plist 的代码

```
NSError *error;
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSString *documentsDirectory = [paths objectAtIndex:0];
self.path = [documentsDirectory stringByAppendingPathComponent:@"profiles.plist"];
self.path2 = [documentsDirectory stringByAppendingPathComponent:@"services.plist"];

NSFileManager *fileManager = [NSFileManager defaultManager];

if (![fileManager fileExistsAtPath:path])
{
    NSString *bundle = [[NSBundle mainBundle] pathForResource:@"profiles" ofType:@"plist"];
    [fileManager copyItemAtPath:bundle toPath:path error:&error];
}

if (![fileManager fileExistsAtPath:path2])
{
    NSString *bundle = [[NSBundle mainBundle] pathForResource:@"services" ofType:@"plist"];
    [fileManager copyItemAtPath:bundle toPath:path2 error:&error];
} 
```

当我去给它写信时

```
NSString *pName = profileName;
[self dismissModalViewControllerAnimated:YES];

NSMutableArray *profilesArr = [[[NSMutableArray alloc] initWithContentsOfFile:path]autorelease];
NSMutableDictionary *tempDict = [[[NSMutableDictionary alloc] init ]autorelease] ;

NSMutableArray *tempArr = [[[NSMutableArray alloc] init]autorelease];

for (int i = 0; i < [self.visibleLegend count]; i++)
{
    NSMutableDictionary *legendDict = [[[NSMutableDictionary alloc] init]autorelease];
    AGSLayerDefinition *layer = [self.visibleLegend objectAtIndex:i];
    NSString *layerDef = layer.definition;
    NSString *layerId = [NSString stringWithFormat:@"%d", layer.layerId];
    NSLog(@"save ID %@, save DEF %@", layerId, layerDef);

    [legendDict setObject:layerId forKey:@"layerID"];
    [legendDict setObject:layerDef forKey:@"layerDEF"];

    [tempArr addObject:legendDict];
}

NSString *dynamicURL = [self findServiceName:[self.dynamicLayer.URL absoluteString]];
NSString *tiledURL = [self findServiceName:[self.tiledLayer.URL absoluteString]];

[tempDict setObject:pName forKey:@"profileName"];
[tempDict setObject:dynamicURL forKey:@"dynamicLayer"];
[tempDict setObject:tiledURL forKey:@"backgroundLayer"];
[tempDict setObject:tempArr forKey:@"visibleLegend"];

[profilesArr addObject:tempDict];
if ([profilesArr containsObject:tempDict])
    NSLog(@"added");
if ([profilesArr writeToFile:path atomically:NO])
    NSLog(@"new saved"); 
```

存储在 path 中的 plist 是唯一一个似乎在 iPad 上崩溃的 plist。我不知道出了什么问题。调试只是显示对汇编语言代码行的错误访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T19:35:27.427

通过打开弧模式并删除我的对象上的所有自动释放命令来修复它。似乎我的 plist 数组正在自行释放并导致 ipad 出现问题。

# google-chrome - Chrome位置：修复和transformZ错误

> ID：12731975
> 
> 赞同：8
> 
> 时间：2012-10-04T16:47:39.917
> 
> 标签：google-chrome, css, css-transforms, browser-bugs

在**FF**和**Chrome**中查看**[这个演示](http://jsfiddle.net/CP56H/)**，然后删除：

 ****`-webkit-transform:translateZ(0px);`

形成 css，然后在**Chrome**中再次查看。

它还使**Chrome**正文容器带有`min-width:100%`、剪切内容（并非总是如此）。

我需要`-webkit-transform:translateZ(0px);`防止 Chrome 中出现奇怪的奇怪黑框，因为一次使用 transformX + Y 处理太多元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T20:35:01.057

我在固定父容器内的谷歌地图有同样的问题。谷歌地图使用 translateZ 属性。

我相信这可能与此错误有关，该错误似乎已在 beta 版本中修复：[http ://code.google.com/p/chromium/issues/detail?id=146894](http://code.google.com/p/chromium/issues/detail?id=146894)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T22:09:58.813

我也遇到了这个问题。问题是谷歌地图强制GPU在所有它映射的DOM元素上通过`-webkit-transform: translateZ(0);`

要解决此问题，您可以通过添加 到每个固定元素来强制对所有*固定定位元素进行 GPU 合成*`-webkit-transform: translateZ(0);`

jsfiddle 演示：http: [//jsfiddle.net/plapier/QA7tK/](http://jsfiddle.net/plapier/QA7tK/)****

# asp.net - 在asp.net中没有列名的xslt到excel转换

> ID：12731977
> 
> 赞同：1
> 
> 时间：2012-10-04T16:47:44.113
> 
> 标签：asp.net, xlsx

这是我用来在 asp.net 中将 xml 转换为 excel 的 Excel.xsl 文件。它工作正常，但我不想显示列名。我应该在这个文件中进行什么更改，以便列名不应该显示在我的 excel 输出中？

```
<xsl:stylesheet version="1.0" 
  xmlns="urn:schemas-microsoft-com:office:spreadsheet"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
     xmlns:msxsl="urn:schemas-microsoft-com:xslt"
    xmlns:user="urn:my-scripts"
     xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" > 

  <xsl:template match="/">
   <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:html="http://www.w3.org/TR/REC-html40">
    <xsl:apply-templates/>
   </Workbook>
   </xsl:template>

  <xsl:template match="/*">
    <Worksheet>
    <xsl:attribute name="ss:Name">
    <xsl:value-of select="local-name(/*/*)"/>
    </xsl:attribute>
    <Table x:FullColumns="1" x:FullRows="1">
      <Row>
       <xsl:for-each select="*[position() = 1]/*">
       <Cell><Data ss:Type="String">
       <xsl:value-of select="local-name()"/>
       </Data></Cell>
     </xsl:for-each>
    </Row>
    <xsl:apply-templates/>
     </Table>
     </Worksheet>
    </xsl:template>

   <xsl:template match="/*/*">
     <Row>
      <xsl:apply-templates/>
    </Row>
    </xsl:template>

     <xsl:template match="/*/*/*">
     <Cell><Data ss:Type="String">
     <xsl:value-of select="."/>
     </Data></Cell>
     </xsl:template>

    </xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T11:13:52.960

我找到解决方案只是注释掉这段代码以从 excel 文件中删除标题

```
 <!--<Row>
      This code is to print the header.
       <xsl:for-each select="*[position() = 1]/*">
      <Cell><Data ss:Type="String">
      <xsl:value-of select="local-name()"/>
      </Data></Cell>
    </xsl:for-each>
  </Row>--> 
```

# c - 通过 gtk_menu_popup 显示的 gtk 菜单可以释放焦点吗？

> ID：12731981
> 
> 赞同：2
> 
> 时间：2012-10-04T16:48:01.343
> 
> 标签：c, linux, button, gtk, focus

我正在重构一些通常需要用户单击按钮才能出现弹出菜单的代码（它出现在按钮旁边），如果用户将鼠标悬停在按钮上，我想要做的是显示弹出菜单图标保持预设的持续时间，如果用户移动到另一个按钮图标，则再次隐藏它。

但是，通过窃取鼠标和键盘焦点来激活菜单`gtk_menu_popup`，我在尝试为按钮小部件获取焦点方面进展甚微。

是否可以将焦点返回到按钮图标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T15:08:52.007

调试这个结果非常麻烦，因为`gtk_menu_popup`抓住了 gdk 键盘和指针焦点，这阻止了使用 gdb 单步执行代码，我最终通过在 VM 中运行代码并通过 SSH 使用 gdb 的远程调试会话来管理它.

弹出窗口可以通过几种不同的机制从原始小部件中窃取焦点

1.  通过瞬态窗口关系（仅当您通过时`parent_menu_shell`）
2.  通过`gdk_pointer_grab`
3.  通过`gtk_grab_add`

当我将`parent_menu_shell`shell 参数设置为 NULL 时，这意味着我必须撤消最后两个“抓取”，如下所示：

```
gdk_pointer_ungrab(GDK_CURRENT_TIME);
gdk_keyboard_ungrab(GDK_CURRENT_TIME);
gtk_grab_remove(menu); 
```

这起到了作用，但焦点暂时被弹出窗口窃取，这也会导致问题

# drupal-7 - Drupal 7 CMIS 视图错误

> ID：12731988
> 
> 赞同：0
> 
> 时间：2012-10-04T16:48:26.967
> 
> 标签：drupal-7, alfresco

我使用 cmis api 模块成功连接了我的 alfresco 和 drupal。问题是当我尝试使用 cmis 视图模块，创建一个 cmis 视图并将其显示到一个块中时，出现错误。

有人理解这个错误吗？

```
HTTP call to [http://127.0.0.1:8080/alfresco/s/cmis/queries] returned [500]. Response: Web Script Status 500 - Internal Error Web Script Status 500 - Internal Error The Web Script /alfresco/s/cmis/queries has responded with a status of 500 - Internal Error. 500 Description: An error inside the HTTP server which prevented it from fulfilling the request 
Message:09040351 Wrapped Exception (with status template): 090414624 Failed to execute script 'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js': 090414623 Request failed 500 /solr/alfresco/cmis?q=select+d.cmis%3Aname%2C+t.cm%3Adescription%2C+t.cm%3Atitle%2C+d.cmis%3AlastModificationDate%2C+d.cmis%3AcontentStreamMimeType%2C+d.cmis%3AobjectId%2C+d.cmis%3AcontentStreamLength+from+cmis%3Adocument+as+d+join+cm%3Atitled+as+t+on+d.cmis%3Aobjectid+%3D+t.cmis%3Aobjectid+where+in_folder%28d%2C+%27workspace%3A%2F%2FSpacesStore%2Fee463364-0808-4277-8881-d5bfb169bddc%27%29+ORDER+BY+d.cmis%3Aname+ASC&amp;wt=json&amp;fl=*%2Cscore&amp;rows=2147483647&amp;df=TEXT&amp;start=0&amp;locale=en_US&amp;fq=%7B%21afts%7DAUTHORITY_FILTER_FROM_JSON&amp;fq=%7B%21afts%7DTENANT_FILTER_FROM_JSON &nbsp; Exception:org.alfresco.repo.search.impl.lucene.LuceneQueryParserException - 090414623 Request failed 500 /solr/alfresco/cmis?q=select+d.cmis%3Aname%2C+t.cm%3Adescription%2C+t.cm%3Atitle%2C+d.cmis%3AlastModificationDate%2C+d.cmis%3AcontentStreamMimeType%2C+d.cmis%3AobjectId%2C+d.cmis%3AcontentStreamLength+from+cmis%3Adocument+as+d+join+cm%3Atitled+as+t+on+d.cmis%3Aobjectid+%3D+t.cmis%3Aobjectid+where+in_folder%28d%2C+%27workspace%3A%2F%2FSpacesStore%2Fee463364-0808-4277-8881-d5bfb169bddc%27%29+ORDER+BY+d.cmis%3Aname+ASC&amp;wt=json&amp;fl=*%2Cscore&amp;rows=2147483647&amp;df=TEXT&amp;start=0&amp;locale=en_US&amp;fq=%7B%21afts%7DAUTHORITY_FILTER_FROM_JSON&amp;fq=%7B%21afts%7DTENANT_FILTER_FROM_JSON
  org.alfresco.repo.search.impl.solr.SolrQueryHTTPClient.executeQuery(SolrQueryHTTPClient.java:333)
  org.alfresco.repo.search.impl.solr.SolrQueryLanguage.executeQuery(SolrQueryLanguage.java:49)
  org.alfresco.repo.search.impl.solr.SolrCMISQueryServiceImpl.query(SolrCMISQueryServiceImpl.java:93)
  sun.reflect.GeneratedMethodAccessor1898.invoke(Unknown Source)
  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
  java.lang.reflect.Method.invoke(Method.java:597) 
  org.alfresco.repo.management.subsystems.SubsystemProxyFactory$1.invoke(SubsystemProxyFactory.java:65) 
  org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172) 
  org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) 
  $Proxy140.query(Unknown Source) 
  org.alfresco.repo.cmis.rest.CMISScript.query(CMISScript.java:683) 
  sun.reflect.GeneratedMethodAccessor1897.invoke(Unknown Source) 
  sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 
  java.lang.reflect.Method.invoke(Method.java:597) 
  org.mozilla.javascript.MemberBox.invoke(MemberBox.java:155) 
  org.mozilla.javascript.NativeJavaMethod.call(NativeJavaMethod.java:243)  
  org.mozilla.javascript.optimizer.OptRuntime.call2(OptRuntime.java:76)  
  org.mozilla.javascript.gen.c4._c0(file:/C:/Alfresco/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js:67)  
  org.mozilla.javascript.gen.c4.call(file:/C:/Alfresco/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js)  
  org.mozilla.javascript.ContextFactory.doTopCall(ContextFactory.java:393)  
  org.mozilla.javascript.ScriptRuntime.doTopCall(ScriptRuntime.java:2834)  
  org.mozilla.javascript.gen.c4.call(file:/C:/Alfresco/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js)  
  org.mozilla.javascript.gen.c4.exec(file:/C:/Alfresco/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js)  
  org.alfresco.repo.jscript.RhinoScriptProcessor.executeScriptImpl(RhinoScriptProcessor.java:483) 
  org.alfresco.repo.jscript.RhinoScriptProcessor.execute(RhinoScriptProcessor.java:191)  
  org.alfresco.repo.processor.ScriptServiceImpl.execute(ScriptServiceImpl.java:212)  
  org.alfresco.repo.processor.ScriptServiceImpl.executeScript(ScriptServiceImpl.java:174)  
  org.alfresco.repo.web.scripts.RepositoryScriptProcessor.executeScript(RepositoryScriptProcessor.java:102)  
  org.springframework.extensions.webscripts.AbstractWebScript.executeScript(AbstractWebScript.java:1193)  
  org.alfresco.repo.cmis.rest.CMISWebScript.executeScript(CMISWebScript.java:46)  
  org.springframework.extensions.webscripts.DeclarativeWebScript.execute(DeclarativeWebScript.java:86)  
  org.alfresco.repo.web.scripts.RepositoryContainer$2.execute(RepositoryContainer.java:393)  
  org.alfresco.repo.transaction.RetryingTransactionHelper.doInTransaction(RetryingTransactionHelper.java:388)  
  org.alfresco.repo.web.scripts.RepositoryContainer.transactionedExecute(RepositoryContainer.java:462)  
  org.alfresco.repo.web.scripts.RepositoryContainer.transactionedExecuteAs(RepositoryContainer.java:500)  
  org.alfresco.repo.web.scripts.RepositoryContainer.executeScript(RepositoryContainer.java:316)  
  org.springframework.extensions.webscripts.AbstractRuntime.executeScript(AbstractRuntime.java:372)  
  org.springframework.extensions.webscripts.AbstractRuntime.executeScript(AbstractRuntime.java:209)  
  org.springframework.extensions.webscripts.servlet.WebScriptServlet.service(WebScriptServlet.java:118) javax.servlet.http.HttpServlet.service(HttpServlet.java:717)  
  org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)  
  org.alfresco.web.app.servlet.GlobalLocalizationFilter.doFilter(GlobalLocalizationFilter.java:58)  
  org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)  
  org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)  
  org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)  
  org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)  
  org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:470)  
  org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)  
  org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)  
  org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)  
  org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)  
  org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:861)  
  org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:579)  
  org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1584)  
  java.lang.Thread.run(Thread.java:662) 
Exception:org.alfresco.scripts.ScriptException - 090414624 Failed to execute script 'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js': 090414623 Request failed 500 /solr/alfresco/cmis?q=select+d.cmis%3Aname%2C+t.cm%3Adescription%2C+t.cm%3Atitle%2C+d.cmis%3AlastModificationDate%2C+d.cmis%3AcontentStreamMimeType%2C+d.cmis%3AobjectId%2C+d.cmis%3AcontentStreamLength+from+cmis%3Adocument+as+d+join+cm%3Atitled+as+t+on+d.cmis%3Aobjectid+%3D+t.cmis%3Aobjectid+where+in_folder%28d%2C+%27workspace%3A%2F%2FSpacesStore%2Fee463364-0808-4277-8881-d5bfb169bddc%27%29+ORDER+BY+d.cmis%3Aname+ASC&amp;wt=json&amp;fl=*%2Cscore&amp;rows=2147483647&amp;df=TEXT&amp;start=0&amp;locale=en_US&amp;fq=%7B%21afts%7DAUTHORITY_FILTER_FROM_JSON&amp;fq=%7B%21afts%7DTENANT_FILTER_FROM_JSON
  org.alfresco.repo.jscript.RhinoScriptProcessor.execute(RhinoScriptProcessor.java:195) Exception:org.springframework.extensions.webscripts.WebScriptException - 09040351 Wrapped Exception (with status template): 090414624 Failed to execute script 'classpath*:alfresco/templates/webscripts/org/alfresco/cmis/queries.post.cmisquery.js': 090414623 Request failed 500 /solr/alfresco/cmis?q=select+d.cmis%3Aname%2C+t.cm%3Adescription%2C+t.cm%3Atitle%2C+d.cmis%3AlastModificationDate%2C+d.cmis%3AcontentStreamMimeType%2C+d.cmis%3AobjectId%2C+d.cmis%3AcontentStreamLength+from+cmis%3Adocument+as+d+join+cm%3Atitled+as+t+on+d.cmis%3Aobjectid+%3D+t.cmis%3Aobjectid+where+in_folder%28d%2C+%27workspace%3A%2F%2FSpacesStore%2Fee463364-0808-4277-8881-d5bfb169bddc%27%29+ORDER+BY+d.cmis%3Aname+ASC&amp;wt=json&amp;fl=*%2Cscore&amp;rows=2147483647&amp;df=TEXT&amp;start=0&amp;locale=en_US&amp;fq=%7B%21afts%7DAUTHORITY_FILTER_FROM_JSON&amp;fq=%7B%21afts%7DTENANT_FILTER_FROM_JSON
  org.springframework.extensions.webscripts.AbstractWebScript.createStatusException(AbstractWebScript.java:970)
Server:Community v4.0.0 (7) schema 5,025 Time:Oct 4, 2012 12:45:56 PM
Diagnostics:Inspect Web Script (org/alfresco/cmis/queries.post) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:14:43.307

直到上周我更新时，CMIS Views 一直存在 SOLR 问题 - 请检查[最新版本](http://drupal.org/project/cmis_views/)

# c# - FileSystemWatcher 引发多个事件

> ID：12731991
> 
> 赞同：2
> 
> 时间：2012-10-04T16:48:37.663
> 
> 标签：c#, logging, filesystemwatcher

如果这是一个重复的问题，我将首先道歉。有很多 FileSystemWatcher 问题，但我没有看到任何解决我的问题的问题。

好的，所以我在 C# 中有一个控制台应用程序，它正在监视一个目录，我们将其称为`Root`. `Root`有很多子文件夹。`Root`此应用程序的目的是在其子文件夹或其任何子文件夹中创建、修改或删除任何 .csv 文件时写入日志文件。我目前有这个工作正常，有点。唯一的问题是，当创建、修改或删除 .csv 文件时，它实际上会引发所有 3 个事件。

例如，如果我在`Root`called中创建一个文件`test.csv`，日志文件将如下所示：

```
 10/04/2012: File F:/Root/test.csv Created
 10/04/2012: File F:/Root/test.csv Changed
 10/04/2012: File F:/Root/test.csv Created
 10/04/2012: File F:/Root/test.csv Deleted 
```

我不确定发生了什么，所以这是设置`FileSystemWatcher`

```
 _watchFolder.Path = ConfigurationManager.AppSettings["RootToWatch"];
 _watchFolder.Filter = ConfigurationManager.AppSettings["FileNameToWatch"];
 _watchFolder.NotifyFilter = NotifyFilters.FileName 
                             | NotifyFilters.LastWrite;
 _watchFolder.IncludeSubdirectories = true;
 _watchFolder.Changed += new FileSystemEventHandler(OnChanged);
 _watchFolder.Created += new FileSystemEventHandler(OnChanged);
 _watchFolder.Deleted += new FileSystemEventHandler(OnChanged);
 _watchFolder.Renamed += new RenamedEventHandler(OnRenamed);

 try
 {
     _watchFolder.EnableRaisingEvents = true; 
 }
 catch (ArgumentException ex)
 {
     AbortMonitoring(ex.Message);
 } 
```

这是我的 OnChanged 事件（重命名相同但参数不同）

```
 protected static void OnChanged(object sender, FileSystemEventArgs e)
    {
        //compile message to insert into log file.
        string message = "File: " + e.FullPath + " " + e.ChangeType;
        UpdateLogFile(message);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T16:54:59.550

Just add a handler only for the `changed` event. It should gather all change types. The other types of events like `created` are there if you want the event to be raised only on a particular change type.

```
watchFolder.IncludeSubdirectories = true;
_watchFolder.Changed += new FileSystemEventHandler(OnChanged); 
```

# c# - 如何在 Windows 8 中设置警报或提醒事件？

> ID：12731994
> 
> 赞同：1
> 
> 时间：2012-10-04T16:49:07.433
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

我们在 Windows 8 中是否有一个功能，我可以在其中设置警报或提醒（重复出现！！）并忘记它（其余的由操作系统完成）？还是我需要创建一个后台任务来完成这项工作？

安排一个事件并不难，但我不想安排一整套重复事件。

日历已经在做，我可以绑定这个机制吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T17:56:16.747

您可以使用[计划通知](http://blogs.msdn.com/b/jimoneil/archive/2012/08/08/windows-8-notifications-scheduled-notifications.aspx)，但其中有 4096 个限制，因此建议重复任务是使用[MaintenanceTrigger](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.background.maintenancetrigger.maintenancetrigger.aspx)。有几点需要注意：

*   如果使用电池供电，维护触发器将不会触发，但通知会被缓冲，因此当您再次插入电源时，您会收到它们。

*   [就触发的实际通知而言，从freshnessTime](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.background.maintenancetrigger.freshnesstime.aspx#Y0)开始最多有15 分钟的窗口，因此在安排时请记住这一点。例如，如果您将通知设置为在中午发生，它可能要到 12:14:59 才会触发。

# stored-procedures - BIDS SSRS 报告查询超时问题，同时使用具有适当设置超时设置的存储过程

> ID：12731997
> 
> 赞同：4
> 
> 时间：2012-10-04T16:49:18.987
> 
> 标签：stored-procedures, timeout, reporting-services, bids

我在执行我在商业智能开发工作室 (BIDS) 中创建的 SSRS 报告的存储过程时遇到了超时问题。我的存储过程非常大，在 SQL Server Management Studio 中执行平均需要将近 4 分钟。因此，我通过将“超时（以秒为单位）”增加到 600 秒（10 分钟）来解决这个问题。我还将工具->选项->商业智能设计器->查询超时和连接超时中的查询超时增加到 600 秒。

最后，我已经创建了另外两个使用存储过程没有问题的报表。（它们要小得多，执行大约需要 30 秒）。对于我的数据集属性，我总是使用查询类型：“文本”，并使用 EXEC 命令调用存储过程。

*关于为什么我感兴趣的存储过程仍然超时的任何想法？*

**以下是单击“刷新字段”后收到的错误消息：**

“无法为查询创建字段列表。请确认您可以连接到数据源并且您的查询语法正确。”

**细节**

“超时时间已过。在操作完成之前超时时间已过或服务器没有响应。语句已终止。”

*感谢您的时间。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T12:25:07.560

检查 rsreportserver.config 文件中的 Add Key="DatabaseQueryTimeout" Value="120" 值。您可能还需要在那里增加它。

有关该文件的更多信息：

[http://msdn.microsoft.com/en-us/library/ms157273.aspx](http://msdn.microsoft.com/en-us/library/ms157273.aspx)

此外，除了您帖子中的第一个评论者所说的之外，根据我的经验，如果您正在渲染为 PDF，这些也可能会超时。您的大型数据集会在合理的时间内返回，但 PDF 的呈现可能需要很长时间。尝试渲染到 Excel。BID 结果将很快呈现，但导出结果可能会导致问题。

# asp.net-mvc - .net Razor 替代 PHP 回显

> ID：12731999
> 
> 赞同：5
> 
> 时间：2012-10-04T16:49:23.793
> 
> 标签：asp.net-mvc, razor

我是 .net MVC 和 Razor 引擎的新手，但我已经使用 PHP 很长时间了。我正在尝试在 Razor 中执行此 PHP 代码：

```
var data = [
<?php for ($i = 0; $i < 50; ++$i) { 
  echo '[' . $i . ',' . sin($i) . ']';
  if ($i != 49)
    echo ',';
?>
], 
```

我设法使用它来做到这一点，但对于如此简单的事情来说，它看起来既糟糕又复杂

```
var data = [
  @for(int i = 0; i < 50; ++i) {  
<text>[</text>@i<text>,</text>@Math.Sin(i)<text>]</text>if (i != 49) {<text>,</text>}
  } 
]; 
```

问题是`[`，`]`和`,`与 Razor 语法混淆并给出语法错误，所以我不得不将它们包装在`<text>`标签上。

有没有更简单/更好的方法来做到这一点？也许类似于 PHP 回声。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-10T00:30:34.600

MVC cshtml中的 echo 的**一般**等价物可能是： `@Html.Raw("SomeStringDirectlyInsideTheBrowserPageHTMLCode")`

这会将（动态）字符串呈现在其不需要 HTML 编码的 '<' 和 '>' 的位置。例如`@Html.Raw(String.Format("<div class=\"{0}\" style=\"{1}\">", myclass, mystyle))`工作正常。

请注意，`@Html.Raw(MyString)`编译器无法检查由 渲染的 HTML 标记。我的意思是：@Html.Raw("<div ....>") 不能仅仅被 </div> 关闭，因为你会得到一个错误（<div ....> 没有被编译器检测到）所以你必须用 @Html.Raw("</div>") 关闭标签

PS
在某些情况下这不起作用（例如它在 DevExpress 中失败） - 使用`ViewContext.Writer.Write()`or`ViewContext.Writer.WriteLine()`代替。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-04T17:02:47.700

用这个：

```
@String.Format("[{0},{1}]", i, Math.Sin(i)) 
```

`String.Join()`如果您创建数组（[String.Join 方法](http://msdn.microsoft.com/en-us/library/0h8wc12c.aspx)） ，则可以使用逗号

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-15T15:36:22.040

我知道的老问题，但另一种方法是使用纯文本语法`@:`

```
var data = [
@for (int i = 0; i < 50; ++i)
{
    @:[@i,@Math.Sin(i)]
    @(i != 49 ? "," : "")
}
]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-04T17:09:38.487

使用视图构造 JSON 对象并不是最好的方法。您可以使用原生 JSON 支持直接从控制器执行此操作，例如：

```
 public JsonResult SinArray()
    {
        return new JsonResult() { 
            Data = Enumerable.Range(0, 50).Select(i => new[] { i, Math.Sin(i) }), 
            JsonRequestBehavior = JsonRequestBehavior.AllowGet 
        };
    } 
```

这返回

```
[[0,0],[1,0.8414709848078965],[2,0.90929742682568171],.....,[49,-0.95375265275947185]] 
```

作为奖励，您可以获得正确的内容类型。