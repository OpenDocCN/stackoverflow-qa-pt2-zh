# StackOverflow 问答 14407000-14407999

# c# - NLog 性能计数器可以配置为监控 AsyncWrapper 队列大小吗？

> ID：14407003
> 
> 赞同：2
> 
> 时间：2013-01-18T20:20:29.787
> 
> 标签：c#, nlog

我正在使用带有 AsyncWrapper 和自定义目标的 NLog v2.0。我想监控 AsyncWrapper 目标 queueSize 的大小。我已经按如下方式配置了 AsyncWrapper。

```
<target xsi:type="AsyncWrapper"
        name="CustomTargetWrapper"
        queueLimit="100000"
        overflowAction="Discard">
      <target xsi:type="CustomTarget" name="MyTarget" ... />
    </target> 
```

我看到 NLog 支持性能计数器。我相信添加性能计数器来查看写入次数、平均写入次数等很容易，但看起来我无法监控 AsyncWrapper 队列大小。NLog 性能计数器的注释中有一些 TODO 注释，所以它可能还没有完全准备好生产 - [http://nlog-project.org/wiki/PerfCounter_target](http://nlog-project.org/wiki/PerfCounter_target)

NLog 性能计数器可以配置为监控 AsyncWrapper 队列大小吗？

# node.js - 检查猫鼬验证错误的最佳方法

> ID：14407007
> 
> 赞同：34
> 
> 时间：2013-01-18T20:20:43.487
> 
> 标签：node.js, mongoose

我的用户模型有两个[验证](http://mongoosejs.com/docs/validation.html)功能

```
User.schema.path('email').validate(function(value, respond) {
  User.findOne({email: value}, function(err, user) {
    if(err) throw err;
    if(user) return respond(false);
    respond(true);
  });
}, 'EMAIL_EXISTS'); 
```

和同样的`username`

```
User.schema.path('username').validate(function(value, respond) {
  User.findOne({username: value}, function(err, user) {
    if(err) throw err;
    if(user) return respond(false);
    respond(true);
  });
}, 'USERNAME_TAKEN'); 
```

它们以以下格式返回错误

```
{ message: 'Validation failed',
  name: 'ValidationError',
  errors: 
    { username: 
      { message: 'Validator "USERNAME_TAKEN" failed for path username',
        name: 'ValidatorError',
        path: 'username',
        type: 'USERNAME_TAKEN' } } } 
```

`email`路径的错误类似。有没有比以下更聪明的方法来检查这些错误？

```
if (err && err.errors && err.errors.username) { ... } 
```

这有点丑。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-01T08:23:30.760

从技术上讲，您必须首先检查错误名称，因为并非所有错误都以相同的方式处理。然后，您必须根据错误名称检查特定属性，如 ValidationError 附带的错误属性。

此外，您将字段名称放在错误类型中，这是多余的，最好使用相同的错误类型，因为在错误检查过程中您还将获得字段名称。

所以你的代码可以是这样的：

```
User.schema.path('email').validate(function(value, respond) {
  User.findOne({email: value}, function(err, user) {
    if(err) throw err;
    if(user) return respond(false);
    respond(true);
  });
}, 'exists');

User.schema.path('username').validate(function(value, respond) {
  User.findOne({username: value}, function(err, user) {
    if(err) throw err;
    if(user) return respond(false);
    respond(true);
  });
}, 'exists'); 
```

然后，错误检查过程：

```
if (err) {
  switch (err) {
    case err instanceof mongoose.Error.ValidationError:
      for (field in err.errors) {
        switch (err.errors[field].type) {
          case 'exists':
            ...
            break;
          case 'invalid':
            ...
            break;
          ...
        }
      }
      break;
    default:
      ...
  }
} 
```

如果你想缩短它，你有多种选择。如果您只有一种类型的验证，您可以这样做：

```
if (err) {
  if (err instanceof mongoose.Error.ValidationError) {
    for (field in err.errors) {
      ...
    }
  } else {
    // A general error (db, crypto, etc…)
    ...
  }
} 
```

错误检查过程的最小表达方式与您在帖子中所写的类似：

```
if (err) {
  for (field in err.errors) {
    ...
  }
} 
```

这将起作用，因为如果未定义错误，它将忽略 for。但是您在这里忽略了所有其他错误类型。

我也认为这些错误布局有点混乱，但不要指望在不久的将来会改变。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-06-29T14:18:11.417

只需编写以下代码并享受。

```
if (err) {
    console.log('Error Inserting New Data');
    if (err.name == 'ValidationError') {
        for (field in err.errors) {
            console.log(err.errors[field].message); 
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-14T14:36:14.717

我使用 AngularJS，所以`ngRepeat`在 Web 表单上显示我的验证错误。我需要做的就是返回一组错误消息。

有时 Mongoose 会抛出一个不是验证错误的错误，在这种情况下 err.errors 对象将不存在。我记录执行错误。我仍然使用 Web 表单上的相同位置向用户显示执行错误。

```
var makeMongooseErrorMsgArray = function(err){
    var msgArray = [];
    if (err.errors) { // validation errors
        $.each(err.errors, function (key, val) {
            msgArray.push(val.message);
        });
    } else if (err.message){ // should be execution error without err.errors
        errLogr.log(err); // log execution errors
        msgArray.push(err.message);
    } else {
        msgArray.push('Unknown error');
    }
    return msgArray;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-15T01:58:01.847

我发现这很有帮助，它显示了数组中的所有错误。

例如，我提交了一个包含短密码和无效电子邮件的表单。

```
if (err && err.name === 'ValidationError') {
   err.toString().replace('ValidationError: ', '').split(',')
} 
```

这导致了这个

```
[ 'Please provide a valid email address',
'The password should be at least 6 characters long' ] 
```

如果您`,`的错误消息中有逗号，请尝试不使用`.split(',')`

不需要`for`循环。确保您的架构中有验证错误消息。对于上面的例子，我有

```
const validateEmail = email => {
  const re = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
  return re.test(email);
};

const Schema = mongoose.Schema;
const userSchema = new Schema({
   ...
   email: {
      type: String,
      trim: true,
      required: 'Email address is required',
      validate: [validateEmail, 'Please provide a valid email address'],
   },
   password: { type: String, set: encryptPassword, maxlength: [6, 'The password should be at least {MAXLENGTH} characters long'] },
   ...
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-12-26T03:12:12.013

通过阅读所有这些答案，我认为最好创建实用函数并重用它：

`ValidationError`这是通过向客户端发送带有验证消息的所需响应来处理的函数，并且可以选择用于`console.log`在控制台中显示消息。

```
function handleValidationError(err, res, consoleLog = false){
  const messages = []
  for (let field in err.errors) {
    messages.push(err.errors[field].message)
    consoleLog && console.log(err.errors[field].message)
  }
  res.status(422).json({ messages })
} 
```

然后在我们要处理错误的控制器中，我们检查是否`err.name`是`ValidationError`，如果是，我们使用上面的效用函数。

```
user.save((err) => {
  if (err) {
    if (err.name === 'ValidationError') return handleValidationError(err, res) // here
    return res.status(500).json({ message: 'Error while creating new user' })
  }
  return res.status(201).json({ message: 'User created' })
}) 
```

然后客户端将得到验证错误作为响应：

```
curl\
-H 'Content-Type: application/json'\
-d '{"email": "foo", "password": "barbaz"}'\
http://localhost:3000/user/new 
```

输出：

```
{"messages":["Email validation failure"]} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-31T00:56:06.953

为什么不使用[API 中描述](http://mongoosejs.com/docs/api.html#document_Document-validate)`validation`的方法？

```
objectToSave.validate(function(err) {          
  if (err) {
    // handle error
  }     
  else {
    // validation passed
  }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-30T13:09:30.447

这是我处理猫鼬验证错误的独特方法

代码准备就绪后仍在进行中，我将对其进行更新，或者您可以为扩展我的代码做出贡献。

```
let message = "";
let title = "Validation Error";
let code = 400;
let requiredFields = [];
for (let field in err.errors) {
    let subMsg = ""
    if (err.errors[field].kind === "required") {
        requiredFields.push(field)
    }
}
if (requiredFields.length > 0) {
    message = "Following fields are required: " + requiredFields.join(", ");
} else {
    message = "Unknown";
}
res.status(code).json({
    status: code,
    message: message,
    title: title
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-29T19:39:38.093

**方法#1**

我对这种方法的最佳猜测是使用具有基于承诺的回报的广义验证器，希望它可以在未来有所帮助

```
function validateDoc(model,fieldName) {
  return new Promise((resolve, reject) => {
    model.validate(err => {
      if (err) {
        return reject(err.errors[fieldName]);
      } else {
        return resolve(model);
      }
    });
  })
}

// Access error message in catch() or get the validated doc in then()

validateDoc(model,fieldName)
           .then((model) => console.log(model))
           .catch((message) => console.warn(message)) 
```

**方法#2**

```
const userSchema = new Schema({
  name: {
    type:String,
    required:[true,'Name is required.'],
    validate:{
      validator:(name) => { name.length <= 2 }
      message:'Name must be longer than two characters'
    }
  }
})
const User = mongoose.model('user',userSchema) 
```

将**validate:Object**与**validator:function**和**message:String结合使用**

稍后当您尝试保存记录时，它将在 catch 函数中显示验证错误对象

例如

```
const newUser = new User({ name: undefined });

newUser.save().catch( ( { errors } ) => { 

let errorBag = [];

Object.keys(errors).forEach((fieldName) => {

errorBag.push({ [fieldName]:errors[fieldName].message })

});

 // All the errors with the **fieldName** and  **errorMessages** 

console.log(errorBag);  

   }) 
```

# ios - 目标 C：为什么我不能从另一个类（AppDelegate > MainViewController）更新标签？

> ID：14407009
> 
> 赞同：1
> 
> 时间：2013-01-18T20:21:16.440
> 
> 标签：ios, objective-c, class, uilabel

一段时间以来，我一直在尝试通过从**AppDelegate.m**到**MainViewController.m的方法调用来****更新 UILabel**。我真的不明白为什么这不起作用。该**方法被调用**，*一切正常，***除了****更改/更新标签文本**的最后一点。

 *******## 工作流程

在**AppDelegate**`applicationDidBecomeActive`中调用**MainViewController**中处理数据和更新标签的方法。**`updateLabelMethod`**

 ****## 代码

**主视图控制器.h**

```
UILabel *daysResultOutlet;
@interface MainViewController : UIViewController <FlipsideViewControllerDelegate>
     @property (strong, nonatomic) IBOutlet UILabel *daysResultOutlet;
@end

@interface MainViewController ()
    - (void) updateLabelMethod;
@end 
```

**主视图控制器.m**

```
@synthesize daysResultOutlet;
- (void) updateLabelMethod {
    NSString *value = @"test";
    NSLog(@"Testing to print value: %@",value);
    [daysResultOutlet setText:value]; //insert in label
} 
```

**AppDelegate.m**

```
#import "AppDelegate.h"
#import "MainViewController.h"

@interface MainViewController ()
@end

- (void)applicationDidBecomeActive:(UIApplication *)application
{
    MainViewController *mvsAsObj = [[MainViewController alloc] init];
    [mvsAsObj updateLabelMethod]; //running function, value correctly logged but lbl not updated
    mvsAsObj.daysResultOutlet.text = @"update!!"; // not working!

} 
```

## 结果与尝试

**标签不会通过跨类方法调用或通过更新**，但是`updateLabelMethod`，`mvsAsObj.daysResultOutlet.text = @"update!!";`该方法被调用并它的值：`LOG: Testing to print value: test`。此外，如果我从 MainViewController 中调用此方法：`[self updateLabelMethod]`一切正常。

我已经尝试了基本上所有的解决方案，但问题是，我在这里做的是直接解决几个 Stackoverflow 问题，所以我不知道如何继续。我正在使用故事板。

**任何进一步的想法**？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T00:42:35.337

感谢**Ryan Poolos**指出让我的控制器监听`UIApplicationDidBecomeActiveNotification`而不是从 AppDelegate 调用方法的可能性。这就是我最终这样做的方式：

在 MainViewControll 中，**ViewDidLoad**

```
[[NSNotificationCenter defaultCenter] addObserver:self 
    selector:@selector(becomeActive:)
    name:UIApplicationDidBecomeActiveNotification
    object:nil];

- (void)becomeActive:(NSNotification *)notification {
    NSLog(@"active");
} 
```

**清理**通知

```
- (void)dealloc {
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T20:24:03.160

你为什么期待

```
MainViewController *mvsAsObj = [[MainViewController alloc] init]; 
```

返回已经存在的视图控制器的相同实例？`alloc`创建一个新实例。修改它**显然**不会对另一个实例产生任何影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T20:27:07.120

您是否将代码中的 UILabel 连接到 Storyboard/Nib 文件中的实际标签？

只是问，因为我有时也会忘记这一点......***********

# html - 为什么文本没有完全填满它的行？

> ID：14407010
> 
> 赞同：1
> 
> 时间：2013-01-18T20:21:30.857
> 
> 标签：html, css

我需要确保文本的高度与其行完全相同。但是当 font-size 和 line-height 相同时，文本仍然比它的行略小。[见小提琴](http://jsfiddle.net/UwLm7/1/)。我在这里使用 text-transform: 大写，所以没有额外的部分突出，比如'y'。任何想法如何解决它？

```
<div> Some Text</div>

div {
    display:inline-block;
    font-family: Lucida Sans Unicode,Verdana,Arial,Helvetica,sans-serif;
    font-size: 20px;
    line-height: 20px;
    text-transform: uppercase;
    background-color: lightgreen;
    padding: 0;
    margin: 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:28:51.293

那是因为`font-size`是字体的最大尺寸。在您的示例中，`È`将填充整个高度。所以如果你不打算使用重音字母，你应该从`line-height`.

这似乎给出了一个很好的结果：

```
div {
  display:inline-block;
  font-family: Lucida Sans Unicode,Verdana,Arial,Helvetica,sans-serif;
  font-size: 20px;
  line-height:15px;
  text-transform: uppercase;
  background-color: red;
  padding: 0;
  margin: 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:31:47.690

您可以尝试减少行高。当 line-height 与 font-size 相同时，无论您是否将文本转换为大写，它都会为升序和降序留出空间——就像你建议的字母“y”一样。

[http://jsfiddle.net/tracyfu/UwLm7/15/](http://jsfiddle.net/tracyfu/UwLm7/15/)

```
div {
  display:inline-block;
  font-family: Lucida Sans Unicode,Verdana,Arial,Helvetica,sans-serif;
  font-size: 20px;
  line-height: 15px;
  text-transform: uppercase;
  background-color: red;
  padding: 0;
  margin: 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T20:32:23.477

@mathieu 是正确的。您可以使用以下方法作弊：

```
line-height: 16px;
vertical-align: text-top; 
```

# string - 如何在 Visual C++ 中将字符串拆分为字符？

> ID：14407011
> 
> 赞同：0
> 
> 时间：2013-01-18T20:21:30.160
> 
> 标签：string, visual-c++

我一直在尝试创建一个 Visual C++ 程序，它从文本框中获取一个字符串，然后计算其中的字符数并将每个字符放在不同的标签中。我可以使用哪些函数从文本框中获取字符串，将字符串拆分为字符并将每个字符放在不同的标签中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T04:47:44.117

*   用于`GetDlgItemText`将文本复制到字符数组或`CString`对象中。如果 text-control 映射到`CEdit`变量，则用于`GetWindowText`将文本复制到缓冲区。
*   使用`strlen`或`CString::GetLength`查找字符串的长度。如果要修剪空格，请使用`CString::Trim`
*   然后从第 0 个索引开始运行一个循环，直到长度为 1。找到这些字符是什么，并将它们放入目标控件中。

# iphone - 使用 NSUserDefaults 和 AVAudioPlayer 制作静音切换按钮

> ID：14407018
> 
> 赞同：0
> 
> 时间：2013-01-18T20:21:56.397
> 
> 标签：iphone, objective-c, xcode, nsuserdefaults, avaudioplayer

我已经在这个项目上工作了一段时间，但是我遇到了一个我无法弄清楚的问题。

首先，我有一个复选框按钮，可以将 NSDefaultUser 作为 BOOL 值保存。它只是在按下一次时保存值 YES 并在再次按下时保存 NO 等等......这个复选框按钮像普通的自定义复选框按钮一样工作正常。

我想通过使用此复选框按钮来选择静音我的应用程序中的所有声音。

我通过调用以下方法来播放我的声音：

```
- (void)startMusic1
{
    NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/music1.mp3", [[NSBundle mainBundle] resourcePath]]];

    NSError *error;
        AVAudioPlayer *audioPlayer;
    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    audioPlayer.numberOfLoops = -1;

    if (audioPlayer == nil)
            NSLog(@"Error: %@", [error description]);
    else
    [audioPlayer play];
} 
```

因此，对于我想在我的应用程序中播放的每个声音，我可以重复以下内容：

```
- (IBAction)playButton:(id)sender
{
    NSUserDefaults *default = [NSUserDefaults standardUserDefaults];
    if(![default boolForKey:@"isMuted"])
    {
        [self startMusic1];
    }
} 
```

但是，这会变得重复，尤其是因为我必须为我的项目管理许多不同的声音（以及播放声音的不同按钮），重复这些步骤似乎无关紧要。

我尝试用 AVAudioPlayer 的子类创建一个新类，并用 -(BOOL)play 方法搞砸了几天，但我无法获得我想要的结果。[我研究并发现了在应用程序声音中禁用](https://stackoverflow.com/questions/3441504/disable-in-app-sounds)之类的帖子，但这仍然不会这样做。

我对整体编程很陌生，所以如果有人能启发我一点，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T13:07:56.920

我通过使用全局模型单例来解决这个问题（正确或错误，但它对我有用）。这是一个有效维护整个应用程序状态的类。

做到这一点的方法是使用具有如下共享静态属性的类：

//// 界面

```
#import <Foundation/Foundation.h>

@interface AudioModel
@property (nonatomic) BOOL playAudio;
+(id)sharedInstance;

@end 
```

//// 执行

```
#import "AudioModel.h"

@implementation AudioModel

// property for toggling audio on or off
@synthesize playAudio = _playAudio;

// singleton model variable
static AudioModel* audio = nil;

-(BOOL)playAudio {
    return _playAudio;
}

-(void)setPlayAudio:(BOOL)playAudio {
    _playAudio = playAudio;
}

// static 
+(AudioModel*)sharedInstance {
    if(audio == nil)
    {
        audio = [[AudioModel alloc]init];
    }

    return audio;
}

-(AudioModel*)init {

    self = [super init];

    if(self){
        // set up default sounds on
        // this may read from your stored value  
        _playAudio = YES;
    }
}

@end 
```

然后，当您想要读取或写入这个全局可用的单例模型时，您可以在控制器中设置一个变量，如下所示：

```
AudioModel *volumeControl = [AudioModel sharedInstance];

if(volumeControl.playAudio){
   // method to play audio passing audio file name... 
} 
```

您还可以在此类中引用您的 AVAudioPlayer 实例，在创建共享实例时对其进行初始化，并在需要时将文件传递给它以进行播放。

# javascript - 使用 javascript/jQuery 进行图像模糊和焦点 ROI

> ID：14407019
> 
> 赞同：3
> 
> 时间：2013-01-18T20:21:58.633
> 
> 标签：javascript, jquery, html, image, effects

我想在其中集中用户注意力的 jpeg 图像中有一些 ROI（感兴趣区域）。我想出了一个解决方案，在该解决方案中，我的网站显示图像的模糊版本，然后动态地（在某些事件下）消除特定 ROI 上的模糊。

我怎样才能使用 HTML/Javascript/JQuery 做到这一点？不幸的是，HTML5 不是一个选项！

# html - 锚定单页网站

> ID：14407021
> 
> 赞同：0
> 
> 时间：2013-01-18T20:22:02.113
> 
> 标签：html

这是一个关于[http://www.mccaffreyhautecouture.com/](http://www.mccaffreyhautecouture.com/)的问题 我无法创建一个外部链接，将观众带到网站内的特定页面。登陆时，观众必须始终通过登陆/主幻灯片页面进入。

这是一个购买的模板，整个网站都编码在一个 index.html 文件中。

我的客户希望他们的 Pinterest 图片直接链接到源或图库。这是可能吗？

我非常感谢任何帮助。谢谢你，斯坦利·欧纳罗姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:34:05.563

看起来这是使用 AJAX 编写的以提取内容。单击导航时 URL 不会更改，这使得无法链接到站点中的特定页面。该站点需要进一步开发以支持此功能。

这可能会有所帮助： [jquery ajax 历史和书签插件](https://stackoverflow.com/questions/1605561/jquery-ajax-history-and-bookmarking-plugin)

# sql-server-2008 - 列出表，特定数据库用户的访问类型

> ID：14407025
> 
> 赞同：2
> 
> 时间：2013-01-18T20:22:22.183
> 
> 标签：sql-server-2008

我正在尝试获取数据库级别的特定用户的所有表及其权限的列表，例如：

```
User Name    DBName    TableName    Type of Access
=========    ======    =========    ==============
...          ...       ...          ... 
```

我试过用...

```
EXEC sp_helprolemember
EXEC sp_helprotect 
```

...和其他人，但他们并没有真正帮助我。

我也尝试过使用`sp_msloginmappings`，但这失败了，因为我在服务器上没有管理员权限。

请给我一些建议或例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:23:40.620

我不是 T-SQL 方面的专家，但是，这可能会满足您的期望。

```
declare @Proc nvarchar(50)
declare @RowCnt int
declare @MaxRows int
declare @ExecSql nvarchar(255)

select @RowCnt = 1
select @Proc = 'SELECT * from fn_my_permissions'

declare @Import table (rownum int IDENTITY (1, 1) Primary key NOT NULL , TableName varchar(50))
insert into @Import (TableName) select name from sys.Tables

declare @Output table (entity_name varchar(50), subentity_name varchar(50), permission_name varchar(50))

select @MaxRows=count(*) from @Import

while @RowCnt <= @MaxRows
begin
    select @ExecSql = @Proc + '(N''' + TableName + ''', N''OBJECT'') where subentity_name = ''''' from @Import where rownum = @RowCnt 
    insert into @Output exec sp_executesql @ExecSql
    Select @RowCnt = @RowCnt + 1
end

select * from @Output 
```

这将为当前用户提供权限。如果您想查找给定用户的权限，请尝试以下操作；

```
EXECUTE AS LOGIN = N'username'
GO

declare @Proc nvarchar(50)
declare @RowCnt int
declare @MaxRows int
declare @ExecSql nvarchar(255)

select @RowCnt = 1

select @Proc = 'SELECT * from fn_my_permissions'

declare @Import table (rownum int IDENTITY (1, 1) Primary key NOT NULL , TableName varchar(50))
insert into @Import (TableName) select name from sys.Tables

declare @Output table (entity_name varchar(50), subentity_name varchar(50), permission_name varchar(50))

select @MaxRows=count(*) from @Import

while @RowCnt <= @MaxRows
begin

    select @ExecSql = @Proc + '(N''' + TableName + ''', N''OBJECT'') where subentity_name = ''''' from @Import where rownum = @RowCnt 
    insert into @Output exec sp_executesql @ExecSql

    Select @RowCnt = @RowCnt + 1
end

select * from @Output

GO

REVERT
GO 
```

当然，只需将用户名替换为您需要获取权限的用户的登录名即可。

您还必须指定要为哪个数据库执行此操作。

我已将结果限制在表格本身。但是，如果您删除；

```
where subentity_name = ''''' 
```

您还可以找到每个列的权限。

我确信必须有更好的方法来做到这一点......但是，这似乎无论如何都有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T23:44:59.230

这在过去对我有用，告诉我他们可以访问什么以及什么样的访问权限

```
select princ.name
, princ.type_desc
, perm.permission_name
, perm.state_desc
, perm.class_desc
, object_name(perm.major_id)
from sys.database_principals princ
left join
sys.database_permissions perm
on perm.grantee_principal_id = princ.principal_id
WHERE princ.name = 'USERNAME' 
```

# javascript - 用于“浏览”超大文件的 jQuery + Ajax 解决方案

> ID：14407032
> 
> 赞同：1
> 
> 时间：2013-01-18T20:22:43.300
> 
> 标签：javascript, html, ajax, large-files

我有一些可能非常大（多 GB）的文本文件，我希望能够在 div 中查看这些文件。

从概念上讲，这并不难......为更合理大小的文件块发出 AJAX 请求，AJAX 脚本（PHP 会很好）寻找文件中的智能位置，并将我需要的内容发送给我，然后呈现将 JS 放入元素中。

这不可能是一个新问题，我希望其他人已经解决了它。

是否有一些 Javascript（最好是 jQuery）和相关的服务器脚本已经在某个地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:14:39.547

我不知道有任何图书馆这样做。但是做自己应该不会太难。服务器端几乎是微不足道的：

```
<?php
$chunkSize = $_GET['chunksize'];
$offset = $_GET['offset'];

$handle = fopen("text_file.txt", "r");
fseek($handle, $offset);
$chunk = fread($handle, $chunkSize);
fclose($handle);
header('Content-Type: text/plain');
echo $chunk;
?> 
```

这没有任何错误处理，但这也不应该太麻烦。

现在，对于客户端，当然有一些微妙之处，因为您需要同时在文本字段中有两个块才能提供“流畅”的体验，但这应该是可行的。

# android - Google Android Analytics 未在门户网站中显示数据

> ID：14407033
> 
> 赞同：0
> 
> 时间：2013-01-18T20:22:43.567
> 
> 标签：android, google-analytics, analytics

我已经设置了 72 小时的谷歌分析，但谷歌分析门户网站中仍然没有数据。也没有实时数据。

我正在成功发送跟踪器（注意：我删除了我的分析 ID 并替换为 UA-xxxxxxx-xx）。

```
01-18 11:03:38.031: V/GoogleAnalyticsTracker(615): Called dispatch
01-18 11:03:38.052: I/GoogleAnalyticsTracker(615): Host: www.google-analytics.com
01-18 11:03:38.052: I/GoogleAnalyticsTracker(615): User-Agent: GoogleAnalytics/1.4.2 (Linux; U; Android 4.0.4; en-us; sdk Build/MR1)
01-18 11:03:38.052: I/GoogleAnalyticsTracker(615): GET /__utm.gif?utmwv=4.8.1ma&utmn=153554207&utmt=event&utme=5(Exposure%20Fragment*Toggle%20Click*Printed%20Photo)(0)&utmcs=UTF-8&utmsr=1238x752&utmul=en-US&utmac=UA-xxxxxxx-xx&utmcc=__utma%3D1.545766597.1358368304.1358377186.1358533440.6%3B&utmht=1358535803519&utmqt=14534 HTTP/1.1
01-18 11:03:38.061: V/GoogleAnalyticsTracker(615): Scheduled next dispatch
01-18 11:03:38.061: V/GoogleAnalyticsTracker(615): Sending 1 hits to dispatcher
01-18 11:03:38.211: V/GoogleAnalyticsTracker(615): HTTP Response Code: 200 
```

目前对可能出现的问题感到迷茫。有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:27:53.920

好的，我终于在一周后解决了这个问题。

对于那些有类似问题的人来说，这是我修复它的方法。

我使用的是 Google Analytics v1.4.2（仍然可以正常工作），但是在 Google Analytics 门户网站中，我创建了一个新属性作为应用程序。我发现谷歌分析中的应用程序属性需要谷歌分析 V2（测试版）以及 EasyTracker 方法的使用。因此，尽管 v1.4.2 分析正确地联系了谷歌并且我得到了 HTTP 200 响应代码，但我最好的猜测是谷歌方面他们没有处理从 v1.4.2 为新的 Property App 输入的数据。

总而言之，使用 google analytics v2 并使用 EasyTracker 方法创建一个新的 Property App（不是 WEB PROPERTY）。或者，您可以使用谷歌分析 v1.4.2 和“旧式”创建“假”网络资产并使用该唯一 ID 进行跟踪。

Google 推荐使用 Analytics v2。

希望这对一些人有所帮助，并且您不要像我试图弄清楚这一点那样把头发拉出来。

# java - 在 Java 中生成随机数学运算符

> ID：14407034
> 
> 赞同：2
> 
> 时间：2013-01-18T20:22:45.053
> 
> 标签：java

我想知道如何从 switch 语句初始化 int c 。我不知道如何将随机开关参数“提取”到最终答案中。我是初学者，所以也许我在这里遗漏了一些明显的东西。这是我到目前为止的代码：

```
import java.util.*;
public class whileTest{
public static void main (String args[]){
    Scanner sc = new Scanner(System.in);

    String a;

        do{

        String operatorSwitch;
        int b;
        int c;

        Random number = new Random();
        int d = number.nextInt(100) +1;
        int e = number.nextInt(100) +1;

        Random operatorChoice = new Random();
        int operator = operatorChoice.nextInt(4);

        switch (operator){

            case 0: operatorSwitch= "+";
                c = d+e;
                break;
            case 1: operatorSwitch= "-";
                c = d-e;
                break;
            case 2: operatorSwitch= "*";
                c = d*e;
                break;
            case 3: operatorSwitch= "/";
                c = d/e;
                break;
            default: operatorSwitch= "";
        }
        System.out.println("What is: "+d+operatorSwitch+e+"?");
        b = sc.nextInt();

        if(b!=c)
            System.out.println("Wrong answer! Right answer is: "+c);
        else{if(b==c)
            System.out.println("Right answer!"+c);
        }
            System.out.println("Continue? y/n");
            a = sc.next();

        }while(a.equals("y"));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:32:54.177

作为一种实践，除非您有充分的理由，否则您应该始终显式地初始化变量。在这种情况下，您要更改：

```
String operatorSwitch;
int b;
int c; 
```

对此：

```
String operatorSwitch = null;
int b = 0;
int c = 0; 
```

您当前代码的问题是编译问题，因为变量“c”***可能***未初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:41:10.457

不确定你想让它有多漂亮，但你可以编写一个带有匿名子类的 Operator 接口，并从中选择一个随机索引。

```
interface Operator{
    public int operateOn( int a, int b );
    public char getDisplayChar();
}

Operator[] operators = {new Operator(){
        public int operateOn(int a, int b){
            return a + b;
        }

        public char getDisplayChar(){
            return '+';
        }
    }, new Operator(){
        public int operateOn(int a, int b){
            return a - b;
        }

        public char getDisplayChar(){
            return '-';
        }
    } // etc.
    }; 
```

# ruby-on-rails - 在初始化程序中设置 Rails 路由

> ID：14407038
> 
> 赞同：0
> 
> 时间：2013-01-18T20:23:13.650
> 
> 标签：ruby-on-rails, ruby, routing, initialization

我正在使用 Ruby on Rails 构建一个 Web 应用程序，并且我想要一条用户可编辑的路线。所以我想添加一个简单的初始化程序来添加用户指定的路由，但我真的不知道我该怎么做。有什么简单的方法吗？我试过这个`application.rb`：

```
config.after_initialize do
    Rails.application.reload_routes!
    Rails.logger.info "#{Rails.application.routes.routes.map(&:path)}"
    MyApp::Application.routes.draw do
        get '/droplet' => 'admin#index'
    end
end 
```

但这似乎不起作用。这就是我的`routes.rb`：

```
MyApp::Application.routes.draw do
    devise_for :users 

    root :to => 'target_finder#show_page'
    match '*path' => 'target_finder#show_page'

end 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:39:56.320

我建议看一下[friendly_id](https://github.com/norman/friendly_id) gem，它可以根据用户的任何属性定义自定义路由，因此您可以拥有一个`:url`用户属性，然后通过添加`slug`索引然后将`extend FriendlyId`和`friendly_id :url, use: :slugged`放入用户模型中将其用于路由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:40:30.443

如何制作一个接收参数的控制器操作，测试它们是否与配置的路由匹配，然后从那里采取行动。

```
MyApp::Application.routes.draw do
    devise_for :users 

    root :to => 'target_finder#show_page'
    match '*path' => 'test_if_custom#CustomController'

end

class CustomController < ActionController::Base

  def test_if_custom
    if url_for(params) == Rails.application.routes.routes.map(&:path)
      take_custom_action
    else
      take_default_action # Redirects or errors, maybe.
    end
  end

end 
```

# java - 遍历java中的目录

> ID：14407040
> 
> 赞同：1
> 
> 时间：2013-01-18T20:23:20.133
> 
> 标签：java, file, directory, loops

嗨，现在我有以下方法，我正在使用以下方法一次读取一个文件，该文件与具有此方法的类位于同一目录中：

```
private byte[][] getDoubleByteArrayOfFile(String fileName, Region region)
    throws IOException
{
    BufferedImage image = ImageIO.read(getClass().getResource(fileName));
    byte[][] alphaInputData =
        new byte[region.getInputXAxisLength()][region.getInputYAxisLength()];
    for (int x = 0; x < alphaInputData.length; x++)
    {
        for (int y = 0; y < alphaInputData[x].length; y++)
        {
            int color = image.getRGB(x, y);
            alphaInputData[x][y] = (byte)(color >> 23);
        }
    }
    return alphaInputData;
} 
```

我想知道如何才能做到这一点，而不是将“fileName”作为参数，而是将目录名作为参数，然后遍历该目录中的所有文件并对其执行相同的操作。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:34:37.070

如果您使用的是 Java 7，那么您需要查看[NIO.2](http://docs.oracle.com/javase/tutorial/essential/io/fileio.html)。

具体来说，请查看[列出目录的内容](http://docs.oracle.com/javase/tutorial/essential/io/dirs.html#listdir)部分。

```
Path dir = Paths.get("/directory/path");
try (DirectoryStream<Path> stream = Files.newDirectoryStream(dir)) {
    for (Path file: stream) {
        getDoubleByteArrayOfFile(file.getFileName(), someRegion);
    }
} catch (IOException | DirectoryIteratorException x) {
    // IOException can never be thrown by the iteration.
    // In this snippet, it can only be thrown by newDirectoryStream.
    System.err.println(x);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:43:16.240

比较简单，使用[`File#listFiles()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#listFiles%28%29)which 返回指定 File 中的文件列表，该文件必须是目录。要确保 File 是一个目录，只需使用[`File#isDirectory()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#isDirectory%28%29). 问题出现在您决定如何返回字节缓冲区的地方。由于该方法返回 2d 缓冲区，因此有必要使用 3d 字节缓冲区数组，或者在这种情况下，我认为 List 是最佳选择，因为相关目录中将存在未知数量的文件。

```
 private List getDoubleByteArrayOfDirectory(String directory, Region region) throws IOException {
      File directoryFile = new File(directory);

      if(!directoryFile.isDirectory()) {
        throw new IllegalArgumentException("path must be a directory");
      }

      List results = new ArrayList();

      for(File temp : directoryFile.listFiles()) {
        if(temp.isDirectory()) {
          results.addAll(getDoubleByteArrayOfDirectory(temp.getPath(), region));
        }else {
          results.add(getDoubleByteArrayOfFile(temp.getPath(), region));
        }
      }
      return results;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T20:35:49.773

这是一个可能有帮助的简单示例：

```
private ArrayList<byte[][]> getDoubleByteArrayOfDirectory(String dirName,
    Region region) throws IOException {
       ArrayList<byte[][]> results = new ArrayList<byte[][]>();
       File directory = new File(dirName);
       if (!directory.isDirectory()) return null //or handle however you wish
       for (File file : directory.listFiles()) {
           results.add(getDoubleByteArrayOfFile(file.getName()), region);
       }  
       return results;
} 
```

不完全符合您的要求，因为它包装了您的旧方法而不是重写它，但我发现这种方式更简洁，并且让您可以选择仍然处理单个文件。请务必根据您的实际要求调整返回类型以及如何处理`region`（很难从问题中分辨出来）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T20:38:24.963

我们也可以使用递归来处理带有子目录的目录。这里我一个一个地删除文件，你可以调用任何其他函数来处理它。

```
public static void recursiveProcess(File file) {
    //to end the recursive loop
    if (!file.exists())
        return;

    //if directory, go inside and call recursively
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            //call recursively
            recursiveProcess(f);
        }
    }
    //call processing function, for example here I am deleting
    file.delete();
    System.out.println("Deleted (Processed) file/folder: "+file.getAbsolutePath());
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T20:28:07.490

您可以查看[list 和 listFiles](http://java.sun.com/javase/6/docs/api/java/io/File.html)文档以了解如何执行此操作。

# sql - 如何计算表连接中的行数？

> ID：14407042
> 
> 赞同：0
> 
> 时间：2013-01-18T20:23:46.157
> 
> 标签：sql, sql-server

我正在开发一个 SQL 存储过程，我想返回每个表的行数。我怎样才能重写这个语句，以便它列出下面每个表的行数？

```
SELECT COUNT(*)
FROM [test_setup_details_form_view] [tsdf]
JOIN [test_setup_header_form_view] 
    ON [test_setup_header_form_view].[test_setup_header_id] 
        = [tsdf].[test_setup_header_id]
JOIN [test_header_rv] [th] with(nolock) 
    ON [th].[test_setup_header_id] 
        = [test_setup_header_form_view].[test_setup_header_id]
JOIN [test_details_answers_expanded_view] [tdae] 
    ON [tdae].[test_setup_details_id] = [tsdf].[test_setup_details_id] 
        AND [th].[test_header_id] = [tdae].[test_header_id]
JOIN [event_log_rv] [e] 
    ON [e].[event_log_id] = [tdae].[event_log_id] 
```

当我执行这个语句时，它只是给了我所有连接之后的总行数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:55:22.547

如果您试图获取这些表中的每一个的计数而不考虑连接：

```
SELECT
  OBJECT_SCHEMA_NAME([object_id]),
  OBJECT_NAME([object_id]),
  c
FROM
( 
  SELECT [object_id],
    c = SUM(row_count)
  FROM
    sys.dm_db_partition_stats -- no NOLOCK necessary
  WHERE
    index_id IN (0,1)
    AND OBJECT_NAME([object_id]) IN
    ( 
      N'test_setup_details_from_view',
      N'test_setup_header_from_view',
      ... etc etc. ...
    )
  GROUP BY [object_id]
) AS x; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:31:10.420

`count (distinct <columnname>)`在您需要计算的每个表的唯一列上使用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-18T20:31:55.127

从每张桌子？那么为什么不使用元数据表呢？

您正在尝试在元数据表中已经存在的代码中执行某些操作：

```
Select 
    schema_name(schema_id) + '.' + t.name as TableName
,   i.rows
from sys.tables t (nolock) 
    join sys.sysindexes i (nolock) on t.object_id = i.id 
        and i.indid < 2 
```

# c++ - 用于初始化全局变量的函数究竟何时执行？

> ID：14407044
> 
> 赞同：2
> 
> 时间：2013-01-18T20:23:57.107
> 
> 标签：c++

在我的程序中某个文件的顶部，在所有函数之外，我有这些变量：

```
namespace {
  int foo = foo_func();
}

int bar = bar_func(); 
```

如您所知，`foo`它是仅对该文件本地的变量，但`bar`每个文件都可以访问。

...但是问题：函数什么时候`foo_func()`真正`bar_func()`运行？这会在`main()`运行之前发生，还是可能在稍后的某个时间发生（比如在实际需要这些值之前）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:27:31.143

语言规范声明初始化函数将在调用该翻译单元的*任何*函数或访问该翻译单元中定义的任何对象之前执行。因此，在一般情况下，这实际上取决于您的定义如何在翻译单元中传播。

初始化是按从上到下的顺序进行的，因此，根据您的定义顺序，`bar_func`应该看到已经初始化`foo`，但`foo_func`应该看到“未初始化”（即零初始化）`bar`。

请注意，如果您`main`驻留在另一个翻译单元中，则意味着初始化不必在`main()`. 但是，如果您尝试访问`foo`或`bar`从`main`（或从其他任何地方）访问，则应保证为定义这些变量的整个翻译单元触发初始化过程。

此外，如果您的初始化程序是常量表达式（`constexpr`函数），则可以静态执行整个初始化，这通常意味着变量将以已初始化（编译时初始化）状态开始其生命周期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T20:32:06.517

使用非`constexpr`函数的返回值进行初始化是动态初始化。动态初始化的顺序定义如下（省略一些我认为与您的问题无关的细节）：

§3.6.2/2：

> 具有静态存储持续时间 (3.7.1) 或线程存储持续时间 (3.7.2) 的变量应在任何其他初始化发生之前进行零初始化 (8.5)。

[...]

> 在单个翻译单元中定义的具有有序初始化的变量应按照它们在翻译单元中的定义顺序进行初始化。如果程序启动线程（30.3），则变量的后续初始化相对于在不同翻译单元中定义的变量的初始化是无序的。否则，变量的初始化相对于在不同翻译单元中定义的变量的初始化是不确定的。

§3.6.2/3：

> 允许实现将具有静态存储持续时间的非局部变量的初始化作为静态初始化，即使这种初始化不需要静态完成，只要 [Jerry 的总结：它产生的结果与动态完成。]

§3.6.2/4：

> 具有静态存储持续时间的非局部变量的动态初始化是否在 main 的第一条语句之前完成是实现定义的。如果初始化延迟到 main 的第一个语句之后的某个时间点，它应该发生在与要初始化的变量在同一翻译单元中定义的任何函数或变量的第一次 odr-use (3.2) 之前

# node.js - Mongodb插入对象值

> ID：14407046
> 
> 赞同：1
> 
> 时间：2013-01-18T20:23:59.040
> 
> 标签：node.js, mongodb, mongodb-query, mongoskin

我想将用户事件记录到我的 mongodb 集合中。是否可以设置一个简单的查询来仅存储任意、动态变化的事件集的事件的最后记录时间戳（因此，当接收到新事件时，它会被插入）？

我知道以下不起作用，但我想说明我在想什么：

```
uievents.update({_id:id},{
    $set: {userName:user,
                   ("events."+eventName): {
                eventName: eventName,
                serverTime: curTime,
                browserTime: btime,
                value: value
            }},{$upsert:true}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:08:52.810

最简单的方法很简单：

```
query = {$set: {}}
query["$set"]["event."+eventName] = {
                eventName: eventName,
                serverTime: curTime,
                browserTime: btime,
                value: value
            }

uievents.update({_id:id},query,{$upsert:true}); 
```

# android - Android 手机无法识别 Arduino 板

> ID：14407048
> 
> 赞同：1
> 
> 时间：2013-01-18T20:24:06.037
> 
> 标签：android, bluetooth, arduino, galaxy

我有一个[Samsung Galaxy Gio](http://en.wikipedia.org/wiki/Samsung_Galaxy_Gio)并想将它连接到一个[Arduino Leonardo](http://arduino.cc/en/Main/ArduinoBoardLeonardo)。我使用 ITead Studio 的[Stackable Bluetooth Shield 2.1](http://store.iteadstudio.com/index.php?main_page=product_info&products_id=307)。

[它适用于 Windows PC（我可以使用PuTTY](http://en.wikipedia.org/wiki/PuTTY)发送和接收字符串），但我的手机甚至无法识别它 -[蓝牙](http://en.wikipedia.org/wiki/Bluetooth)设备列表为空。

奇怪的是[Galaxy S](http://en.wikipedia.org/wiki/Samsung_Galaxy_S)会立即识别出 Arduino。我的手机可以看到所有其他蓝牙设备——除了 Arduino。

当所有其他设备都工作时，为什么我的 Gio 无法识别电路板？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T17:08:44.117

好吧，我终于找到了问题所在！

显然，带有 Android v2.3.6 的 Galaxy Gio 在“特殊”蓝牙设备（如 Arduino 板）方面存在一些问题。我在手机上安装了[CyanogenMod](http://www.cyanogenmod.org/)（我认为是 7.1 或 7.2 版），之后识别板就没有问题了。这是因为 CyanogenMod 包含许多针对蓝牙和其他问题的修复程序。

现在我正在使用[ITEAD BT 调试助手](http://blog.iteadstudio.com/make-arduino-talk-with-android-by-bluetooth/)从/向我的电路板发送和接收字符串。

# cakephp - 使用 CakePHP 在登录时检查用户角色？

> ID：14407049
> 
> 赞同：2
> 
> 时间：2013-01-18T20:24:06.087
> 
> 标签：cakephp, cakephp-2.2

我想为我的网站创建一个管理面板，为此我创建了`admin.ctp`. 在数据库表名用户中包含列`role`，其中角色=管理员/常规（用户）。

只有一个登录表单，问题是，是否可以“检查” if `user.role=admin`then 重定向到`admin/user/dashboard`and if `user.role=regular`then `layout=default`？我的 AppController.php 包含：

```
function beforeFilter(){
    $this->Auth->allow('index','view','login','home');
    $this->set('admin',$this->_isAdmin());

    $this->set('logged_in',$this->Auth->loggedIn());
    $this->set('current_user',$this->Auth->User());
    if ((isset($this->params['prefix']) && ($this->params['prefix'] == 'admin'))) {
        $this->layout = 'admin';
    } 
```

和 usersController.php

```
function beforeFilter(){
    parent::beforeFilter();
    $this->Auth->allow('*');
    if($this->action=='add' || $this->action=='edit'){
        $this->Auth->authenticate=$this->User;
    }
}

function login(){
    if(!($this->Auth->loggedIn())){
        if ($this->request->is('post')) {
            if ($this->Auth->login()) {
                if($user['role'] === 'admin'){
                    $this->redirect($this->Auth->redirect('admin',array('controller' => 'user','action' => 'admin_dashboard')));
                }
                $this->redirect($this->Auth->redirect(array('controller' => 'posts','action' => 'index')));
            } else {
                $this->Session->setFlash('Your username/password combination was incorrect.',
                    'alert',array(
                        'plugin' => 'TwitterBootstrap',
                        'class' => 'alert-error'
                    ));
                $this->set('forget', 'Forgot Your Password');

            }
        }
    }else
    {
        $this->redirect($this->Auth->redirect(array('controller' => 'posts','action' => 'index')));
    }
} 
```

使用 cakephp 2.2.3。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:58:22.630

这就是我的做法（请记住`field('name')`根据您的组模型进行相应更改）。

```
if ($this->Auth->login())
{
    this->User->Group->id = $this->Auth->user('group_id');
    switch ($this->User->Group->field('name'))
    {
        case 'admin':
            $this->redirect($this->Auth->redirect('admin',array('controller' => 'user','action' => 'admin_dashboard')));
            break;
        case 'regular':
            $this->redirect($this->Auth->redirect(array('controller' => 'posts','action' => 'index')));
            break;
        default:
            //...
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T21:37:45.123

我实际上想发布一些代码来为自己阐明这个主题。我已经为每个用户实现了一个简单的仪表板，扩展了 /Users/view - 我的下一步是尝试让用户访问每组数据

应用控制器

```
class AppController extends Controller {
    public $components = array(
        'Acl',
        'Auth' => array(
            'authorize' => array(
                'Actions' => array('actionPath' => 'controllers')
            )
        ),
        'Session'
    );
    public $helpers = array('Html', 'Form', 'Session');

    public function beforeFilter() {
        //Configure AuthComponent

        $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');
        $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login');
        $this->Auth->loginRedirect = array('controller' => 'users', 'action' => 'dashboard');
        $this->Auth->allow('display');
    }
} 
```

用户控制器

```
public function dashboard() {
    $id = $this->Auth->user('id');
    $this->set('user', $this->User->read(null, $id));

    $group_name = $this->User->Group->field('name', array('id' => $this->Auth->User('group_id')));
    $this->redirect = array('controller' => 'users', 'action' => 'dashboard');
} 
```

仪表板.ctp

```
$this->extend('/Users/view'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:10:46.923

在 AppController 集中：

```
$this->Auth->authorize = array('Controller'); 
```

然后执行以下操作

```
public function isAuthorized($user = null)
{
    if (isset($this->request->params['admin']))
    {
        if(!isAdmin)
        {
            return false;
        }
    }

    return true;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T23:19:24.827

CakePHP 实际上已经提供了一个有用的身份验证和授权框架，启用起来很简单。

下面是如何根据存储在数据库中的角色进行授权，来自[CakePHP 手册](http://book.cakephp.org/2.0/en/tutorials-and-examples/blog-auth-example/auth.html#authorization-who-s-allowed-to-access-what)。`beforeFilter()`如果用户是管理员，我还包括一个更改登录重定向操作的示例：

## 应用控制器.php：

```
public $components = array(
  'Auth' => array(
    'authorize' => array('Controller'),
    'loginRedirect' => array('/'),
));

public function beforeFilter() {
  // This allows us to use $user in all controllers.
  $this->set('user', $this->Auth->user());

  // If the user is an admin, override the loginRedirect
  if ('admin' === $this->Auth->user('role')) {
    $this->Auth->loginRedirect = array(
      'controller' => 'users',
      'action' => 'admin_dashboard',
    ));
  }
} 
```

## 用户控制器.php：

```
public function isAuthorized($user) {
  // Ensure the user has a valid role. If not, deny access to all actions:
  if ((!isset($user['role'])) || ('' === $user['role'])) return false;

  // If we're trying to access the admin view, verify permission:
  if ('admin_dashboard' === $this->action)
  {
    if ('admin' === $user['role']) return true;  // User is admin, allow
    return false;                                // User isn't admin, deny
  }

  return true;
} 
```

您可以通过多种方式安排授权，因此请调整`if/else`语句以最适合您的需要。方法比较简单，允许访问或者不允许访问`isAuthorized()`只需要返回即可。`true``false`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-01-07T09:46:55.580

```
<?php public function dashboard() {
    $id = $this->Auth->user('id');
    $this->set('user', $this->User->read(null, $id));

    $group_name = $this->User->Group->field(
        'name', array('id' => $this->Auth->User('group_id'))
    );
    $this->redirect = array('controller' => 'users', 'action' => 'dashboard');
}   
?> 
```

# jquery - jQuery验证器计算文本区域中的最小长度加一不起作用

> ID：14407050
> 
> 赞同：0
> 
> 时间：2013-01-18T20:24:18.230
> 
> 标签：jquery, jquery-validate

我有一个文本区域，需要一个最小长度的字符串来启用按钮。我正在使用 jQuery 验证器插件，一切正常，直到我到达 char 10。此时，最少字符数的消息消失了，但按钮仍然被禁用。我必须输入另一个字符（现在是 11）才能启用按钮。删除字符时的功能也不正确。该按钮保持启用状态，直到只剩下 8 个字符。此时按钮被禁用。我不确定它发生了什么。任何帮助，将不胜感激。

这是html：

```
<textarea id="otherBox" cols="50" class="required" minlength="10"></textarea>
<input type="button" id="sButton" value="Cancel e-Bill" disabled="true" > 
```

javascript:

```
var goodLenth = false; 
$(document).ready(function(){
    var validator = $("#my_form").validate();

    $("#otherBox").keypress(function(){
        goodLength = validator.element("#otherBox");
        if(goodLenth){
            $("#sButton").removeAttr("disabled");
        }
        else{
            $("#sButton").attr("disabled","true");
        }
   });
}); 
```

这是它的实际操作[http://jsfiddle.net/mg2Bv/](http://jsfiddle.net/mg2Bv/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:24:51.293

只需使用插件的内置回调事件函数...然后您不必尝试在外部匹配事件。它更简洁、更高效且更易于维护。

`success:`- 成功验证元素时的回调函数。

`highlight:`- 元素验证失败时的回调函数。

```
$(document).ready(function () {
    $("#my_form").validate({
        success: function(label) {
            $("#sButton").prop("disabled", false);
        },
        highlight: function(element, errorClass) {
            $("#sButton").prop("disabled", true);
        }
    });
}); 
```

**工作演示：**

**[http://jsfiddle.net/Ufx9G/](http://jsfiddle.net/Ufx9G/)**

**文档：**

[http://docs.jquery.com/Plugins/Validation/validate#toptions](http://docs.jquery.com/Plugins/Validation/validate#toptions)

**笔记：**

1) 不应使用`removeAttr()`，因为它会*永久*删除`attribute`.

2）此外，应该使用`prop()`而不是`attr()`技术上`disabled`的 a`property`而不是 a `attribute`。

见： [http ://api.jquery.com/prop/](http://api.jquery.com/prop/)

> `.prop()`应该使用方法来设置和`disabled`而`checked`不是`.attr()`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:30:20.867

尝试这个....

不要使用keyPress，这不会抓住擦除键......

使用 keyUp...

```
$(document).ready(function(){
    var validator = $("#my_form").validate();

    $("#otherBox").keyup(function(){
        goodLength = validator.element("#otherBox");
        if(goodLenth){
            $("#sButton").removeAttr("disabled");
        }
        else{
            $("#sButton").attr("disabled","true");
        }
   });
}); 
```

看这个[演示](http://jsfiddle.net/mg2Bv/1/)

问候。

# excel - Excel VBA错误中的调试按钮在哪里

> ID：14407061
> 
> 赞同：2
> 
> 时间：2013-01-18T20:25:44.473
> 
> 标签：excel, vba

我无法通过 Google 找到答案的简单问题：

当 Excel 2010 VBA 中出现运行时错误时，如何让“调试”按钮出现在弹出窗口中？我以前见过它，但现在它不见了。

这是配置问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:52:43.297

如果您`On Error Goto xxx`在 VBA 中使用错误处理，那么您将看不到 Debug/Halt 对话框 - 这是设计使然，因为您需要提供自己的处理例程。

如果您使用`On Error Resume Next`，这也适用，只是错误被完全忽略。

如果使用设置`On Error Goto 0`, （默认设置，相当于不指定上述任何一个设置），那么出现错误时会看到对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-12T14:30:55.107

在 VB 编辑器中，转到工具\选项。General 选项卡，Error Trapping 部分，然后切换到 Break on all Errors。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:32:26.933

If you are looking to debug your code, you can do that from "Microsoft Visual Basic for Applications", you can use Alt + F11 shortcut to open it from Excel.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-15T02:20:09.100

如果您直接从*即时*窗口运行您的方法，有时会发生这种情况。

VBA 编辑器，为了显示 Debug 选项需要在某行中断代码，并且在*立即*窗口中的行发生错误时是不可能的。

* * *

例子：

*如果您直接在即时*窗口中运行以下代码：

```
MsgBox 1 / 0 
```

编辑器将显示以下窗口：

[![直接在立即窗口中出错](../Images/fbb32277166256ba673e00ef41ffe0e4.png)](https://i.stack.imgur.com/2Fupc.png)

但是，如果您将这行代码包装到方法中：

```
Sub test
    MsgBox 1 / 0
End Sub 
```

*并像这样从立即*窗口调用它：

```
Call test 
```

由于相同的操作，编辑器会引发错误，但运行时错误窗口将如下所示：

[![用包装方法](../Images/0b81914d41e087994173a55878bb7c92.png)](https://i.stack.imgur.com/E05PI.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-13T16:38:04.810

您可以尝试在设置中更改调试模式，这通常会有所帮助。此外，我读过报告说，如果 VBA 代码位于托管对象中，调试按钮可能会消失，因此将其移至标准模块可能会有所帮助。

# d3.js - 如何确定强制布局是否完成放置节点？

> ID：14407069
> 
> 赞同：10
> 
> 时间：2013-01-18T20:26:49.230
> 
> 标签：d3.js, force-layout

我有基于力布局的图表。我想放置一个“加载”覆盖，直到图表完成放置节点。我可以使用什么事件/属性来确定该图表已完成？

我检查了API，找不到任何东西..

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-04-25T09:27:47.170

从[文档](https://github.com/mbostock/d3/wiki/Force-Layout#on)中，`end`事件在布局完成时调度，即 when `force.alpha === 0`。

因此，您可以了解何时完成：

```
force
  .nodes(yourNodes)
  .links(yourLinks)
  .on('tick', function() {
    // layout is in progress
  })
  .on('end', function() {
    // layout is done
    callback();
  }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-07T00:58:36.407

当布局收敛时，`force.alpha()`将设置为 0。设置一个计时器来轮询（不要太频繁！），你会知道什么时候完成。

此示例应每`interval`毫秒重试一次，直到布局停止。该变量`timer`保留当前计时器，如果您不想再等待布局完成，可以将其重置。

```
var timer = null;
function onCompletion(force, callback, interval) {
    interval = interval || 300;

    function retryIfRunning() {
        if (force.alpha() != 0)
            timer = setTimeout(checkAndRetry, interval);
        else {
            timer = null;
            callback();
        }
    }

    retryIfRunning();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T15:23:44.120

它不可能作为内置功能，因为它取决于您认为放置节点时所做的工作。它的完成方式是调用`tick`函数`n`时间，`n`具体取决于您拥有的图形的大小和您想要的精度。

> #force.tick()：运行力布局模拟一步。

`force.tick()`如果您想了解更多信息，我鼓励您阅读文档： [https ://github.com/mbostock/d3/wiki/Force-Layout#wiki-tick](https://github.com/mbostock/d3/wiki/Force-Layout#wiki-tick)

# c++ - std::vector 在返回之前被自动清除

> ID：14407075
> 
> 赞同：0
> 
> 时间：2013-01-18T20:27:11.520
> 
> 标签：c++, visual-studio-2010, stl, vector, return-value

我有这个功能，

```
vector<QDC::AdapterUserInfo> QDC::QueryInterface::RetrieveAdapterList()
{
    vector<QDC::AdapterUserInfo> retVal;
    InnerQueryInterface::IISTATE::Transition trans = _IQI->AdapterList(retVal);
    if (trans._OldState == trans._NewState)
    {
        if ( trans._NewState != InnerQueryInterface::IISTATE(trans._OldState).SuccessfulTransition(trans._Transition) )
        {
            throw Exceptions::FunctionFailed();
        }
    }
    return retVal;
} 
```

`QDC`是一个命名空间。`QueryInterface`是一个使用 . 导出的类`__declspec(dllexport)`。（生成带有lib的DLL）在其他一些项目中我使用这个函数如下，

```
vector<QDC::AdapterUserInfo> aui = Qui.RetrieveAdapterList(); 
```

但是向量在发布版本中总是返回大小为 0。但返回大小为 1（这是元素的实际数量）。我在release模式下调试了一下，发现函数`retVal`里面`RetrieveAdapterList`填的是实际的数据，然后在函数的最后一行，也就是`return retVal;`line，显示`retVal`vector`cleared`要变空了。所以最后返回的值是一个空向量。

为什么会这样？怎么了？为什么它在调试模式下工作？

- 编辑 -

`aui`在继续执行到其范围结束后，向量的析构函数似乎失败了。

-- 来自调用者的代码 --

```
void DXE::Screen::Initialize( const HWND in_Window, const bool in_Windowed )
{
    QDC::UsableParameters UP;
    QDC::QueryInterface Qui;
    vector<QDC::AdapterUserInfo> aui = Qui.RetrieveAdapterList();
    if( aui.size() <= 0 )
    {
        throw Exceptions::UnknownException();
    }
    Qui.SelectAdapter(0);
    Qui.SelectDisplayMode(in_Windowed);
    UP = Qui.RetrieveParameters();

    _AdapterOrdinal = UP._AdapterOrdinal;

    _D3DPresentParams.BackBufferWidth = UP._Width;
_D3DPresentParams.BackBufferHeight = UP._Height;
_D3DPresentParams.BackBufferFormat = UP._BackBufferFormat;
    //..... fills the _D3DPresentParams..
} 
```

-- 编辑：结论 --

经过多次尝试后，出现一条错误消息，指出可能发生了堆崩溃，这就是 Peter Ruderman 提出的原因。所以然后我从使用动态库更改为静态库，这样在那种情况下就不会发生这种堆的事情（至少我是这么想的）。然后程序似乎运行良好，没有任何问题。所以结论应该是彼得的理论是正确的。谢谢大家帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:41:59.147

这不是您的错误的来源。在 VS2010 使用的 C++11 的早期版本中，向量是可移动构造的。在您的 return 语句中，局部变量 retval 成为一个右值，因此编译器将其内容移动到调用站点的“aui”变量中。（实际上，它只是交换了 aui 和 retval 的内容。）如果您也跟踪调试版本，您应该会看到这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:22:19.610

另一种理论：

“QDC 是一个命名空间。QueryInterface 是一个使用 __declspec(dllexport) 导出的类。（生成带有 lib 的 DLL）”

如果我理解正确，您是说函数 Screen::Initialize 驻留在可执行模块中，但函数 QueryInterface::RetrieveAdapters 列表驻留在 DLL 中。在这种情况下，您的 DLL 正在分配内存，然后将其*移动*到调用站点。当 aui 超出范围时，您的 exe 会删除内存。如果 DLL 和 exe 使用不同的堆，这可能会导致严重错误（堆损坏）。

# javascript - 什么是构造接口`google.maps.Icon`

> ID：14407079
> 
> 赞同：17
> 
> 时间：2013-01-18T20:27:32.897
> 
> 标签：javascript, google-maps

[Google Maps V3 JS API](https://developers.google.com/maps/documentation/javascript/reference#Icon)的文档似乎没有给出`google.maps.Icon`. 我找到了一个示例`MarkerImage`，现在似乎已弃用。

那么，可能的`google.maps.Icon`构造参数是什么，它们的顺序是什么？如何定义图标大小、精灵中的图标偏移、图标锚点等？

**编辑：**

我将如何创建一个图标并将其分配给一个标记？例如（未测试/不起作用）：

```
var icon = new google.maps.Icon(path, 
    new google.maps.Size(32, 32), // size
    new google.maps.Point(0, 32), // offset in sprite
    null, // anchor
); 
```

我确实看到了文档，但我没有看到该类的示例用法！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-18T20:41:18.317

google.maps.Icon 没有构造函数，它是一个匿名的 javascript 对象，例如[MapOptions](https://developers.google.com/maps/documentation/javascript/reference#MapOptions)、[MarkerOptions](https://developers.google.com/maps/documentation/javascript/reference#MarkerOptions)、[PolygonOptions](https://developers.google.com/maps/documentation/javascript/reference#PolygonOptions)等。

你像这样使用它：

```
var icon = {
    anchor: new Point(...),
    url: "myurl"
    // etc..
    }; 
```

来自[Oliver](https://stackoverflow.com/users/177710/oliver)的评论：关键是：没有像 google.maps.Icon 这样的类（或函数）。API 文档将其称为**google.maps.Icon 对象规范**（[此处](https://developers.google.com/maps/documentation/javascript/reference#Icon)），而不是[InfoWindow 类](https://developers.google.com/maps/documentation/javascript/reference#InfoWindow)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T16:02:49.843

嗯......现在，这个答案是错误的。

你不能

```
var icon = new google.maps.Icon({
    anchor: new Point(...),
    url: "myurl"
    // etc..
}); 
```

它是一个对象字面量，这意味着您可以像这样使用它：

```
var icon = {
    anchor: new Point(...),
    url: "myurl"
    // etc..
}; 
```

# jquery - 在 IE 的 jQuery Ajax 成功函数中无法识别选择器

> ID：14407082
> 
> 赞同：0
> 
> 时间：2013-01-18T20:27:55.117
> 
> 标签：jquery, ajax, internet-explorer, jquery-selectors

我必须修复一个非常严重的模板问题：boosterius for Worpress。我需要对其进行优化并使其与 IE 一起工作......所以，我决定用 ajax 加载页面，因为有很多图片（首先，所有页面都加载在同一个页面中：/）。一切都在 Firefox 中完美运行，但在 IE 中它就是地狱。

我此时的问题是 IE 不想识别一些 ajax 加载的元素。

```
var container = _.curr.find('.the-content');
var page = container.parents('li');
$.post(
url, {
    ajaxloaded: '1',
    pageloaded: _.curr.attr('id')
},

function (data) {
    var newcurr = $(data).find('#' + _.curr.attr('id'));
    var newcontainer = $(newcurr).find('.the-content');
    container.html(newcontainer.html());
    var scrollbar_new = container.find('.scrollbar1')[0];
    console.log('nScroll:' + $(container).find('.scrollbar1').length);
    if ($(data).find('.scrollbar1').length > 0) {
        $(data).find('.scrollbar1').each(function (i) {
            console.log('scrollid:' + $(this).attr('id'));
            $(this).tinyscrollbar({
                sizethumb: 134
            });
        });
    }
}); 
```

IE 在无法接受 tinyscrollbar 函数时返回错误：/（但它适用于在第一次页面加载时加载的元素`$(this).tinyscrollbar({ sizethumb: 134 });`）。`$(this)`我尝试使用确切的 id`($('#exactID'))`来获得相同的结果……</p>

谢谢你的帮助 ！:)

**编辑：所以看来问题是由于功能中的插件丢失引起的`$(window).load()`，但它们仍然存在`$(document).ready();`**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:54:03.157

好的，谢谢你的帮助，我学会了一些技巧。所以，我找到了解决方案：停用模块。导致故障的模块：

名称： **smartdownloader 类**

编辑 : Terra Firma Internet Consulting LTD

类型：Objet Application d'assistance du navigateur

版本：1.0.0.1

日期：

Date du dernier accès : ‎Aujourd'hui ‎19 ‎janvier ‎2013, ‏‎il ya 6 分钟

等级 ID：{F1AF26F8-1828-4279-ABCE-074EF3235BD7}

用途 : 23

名称：9

文件： smarterdownloader.dll

档案：C:\Program Files (x86)\ **SockshareDownloader**

# algorithm - 找到大于给定最小值的第一个素数斐波那契数

> ID：14407087
> 
> 赞同：0
> 
> 时间：2013-01-18T20:28:29.863
> 
> 标签：algorithm, data-structures, coding-style, segmentation-fault

我正在尝试解决一个问题，但遇到分段错误，无法找到
问题所在，问题是您必须找到大于 227000 的第一个斐波那契数，这也是一个素数，称之为 X 并返回所有素数除数之和X+1

```
#include<iostream>
    int main(){
        int n = 227000;
        int prime[1000000];
        std::cout<<"lll";
        int i;
        for(i = 2; i<1000;i++){
            if(!prime[i]) continue;
            int j;
            for(j=i*i;j<1000000;j+=i){
                prime[j] = 0;
            }
        }
        int num = 1;
        int nextnum = 1;
        int newnum;
        while(1){
            newnum = num+nextnum;
            if(newnum>n && prime[newnum]) break;
            num = nextnum;
            nextnum = newnum;
        }
        int sum = 1;
        for(int i=2;i<1000000;i++){
            if(prime[i] && newnum%i==0){
                sum+=i;
            }
        }
        std::cout<<sum;
        return 0;

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:39:46.690

您可能会遇到分段错误的一个原因是由于在堆栈上放置了 100 万个整数而导致堆栈溢出。

另一个原因是素数未初始化，因此 while 循环可能会走得太远，访问超出数组限制的素数。

要解决此问题，您需要：

1.  在堆上分配数组（或简单地将其更改为全局）
2.  初始化您的素数数组以包含 1

如果 while 循环也保证终止，或者您可以超出边界访问素数数组，那就更好了。

```
#include<iostream>
int prime[1000000];
int main(){
    int n = 227000;
    std::cout<<"lll";
    int i;
    for(i = 2; i<1000000;i++)
      prime[i]=1;
    for(i = 2; i<1000;i++){
        if(!prime[i]) continue;
        int j;
        for(j=i*i;j<1000000;j+=i){
            prime[j] = 0;
        }
    }

    int num = 1;
    int nextnum = 1;
    int newnum;
    while(1){
        newnum = num+nextnum;
        if(newnum>n && prime[newnum]) break;
        num = nextnum;
        nextnum = newnum;
    }
    int sum = 1;
    for(int i=2;i<1000000;i++){
        if(prime[i] && newnum%i==0){
            sum+=i;
        }
    }
    std::cout<<sum;
    return 0;

} 
```

更新

顺便说一句，第二个循环毫无意义地试图找到素数 newnum 的因子。

我怀疑问题实际上是要找到代码将更改为的数字（newnum + 1）的主要因素

```
 int sum = 0;
    for(int i=2;i<1000000;i++){
        if(prime[i] && (newnum+1)%i==0){
            sum+=i;
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:59:13.883

我会创建一个循环来生成斐波那契数，直到我发现比输入大一个。然后我会检查每个，看看它是否是素数。它比生成素数列表要快得多。

```
#include<iostream>
#include<math.h>

bool isPrime(int number)
{
    for (int i=2;i<=sqrt(number);i++)
        if ((number%i)==0) return false;

    return true;
}

int main(){

    int n = 227000;

    int index=1;
    int nums[2];
    nums[0]=0;
    nums[1]=1;
    int currentFib = 0;

    while (currentFib <=n || !isPrime(currentFib))
    {
        //Calculate the next fib
        index = (index+1)%2;
        nums[index] = nums[0]+nums[1];
        currentFib = nums[index];
        cout<<"Fibb "<<currentFib<<endl;
    }

    return currentFib;
} 
```

代码返回 514229，它既是质数又是斐波那契数，并且大于 227000。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:54:23.517

素数斐波那契数列在[A005478 处](http://oeis.org/A005478)。大于 227000 的最小素数斐波那契数是 514229。您可能会在我的博客上喜欢[这篇文章。](http://programmingpraxis.com/2010/10/29/fibonacci-primes/)

# c++ - C++ 中的指针函数参数复制和性能

> ID：14407089
> 
> 赞同：1
> 
> 时间：2013-01-18T20:28:32.523
> 
> 标签：c++, pointers

**第一个问题：**

很多时候，我们使用指针通过函数调用将一个对象的引用传递给另一个对象。例如：

```
int num =25;
int *num1Ptr=&num;
int *num2Ptr=NULL;

void assinNum (int *numPtr){

    num2Ptr = numPtr; ////we copy the value (address) of the num1Ptr pointer to num2Ptr
} 
```

我的问题是：如果这样的方法被非常频繁地调用，我们可以预期指针复制的显着开销吗？

**第二个问题：**

在下面的场景中，是否意味着我们将传递的 numPtr 指向的内存地址中的值复制到 num2Ptr 指向的内存地址？如果是，那么它是否与按值传递相同？

```
int num =25;
int *num1Ptr=&num;
int *num2Ptr=NULL;

void assinNum (int *numPtr){

    *num2Ptr = *numPtr; ////num2Ptr points to the same value in the memory pointed by numPtr argument. 
} 
```

**第一个问题的更新：**

指向大对象（不是原语）的指针有什么后果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:30:38.437

> 如果这样的方法被非常频繁地调用，我们可以预期指针复制的显着开销吗？

指针通常只是一个 32 位或 64 位的数量。所以复制指针只涉及复制一个 32 位或 64 位的数量，这在大多数平台上都非常便宜。但是，直接复制一个`int`也很便宜，所以在这种情况下，使用指针可能不会给您带来太多好处。

还值得指出的是，在很多情况下，编译器会通过内联来优化这个函数。

> 这是否意味着我们将传递的 numPtr 指向的内存地址中的值复制到 num2Ptr 指向的内存地址？

理论上，是的。但是，，`num2Ptr = NULL`所以你的代码很可能会导致分段错误。

> 那么它与按值传递相同吗？

我不确定你指的是什么，所以很难知道如何回答这个问题！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:38:03.703

> 如果这样的方法被非常频繁地调用，我们可以预期指针复制的显着开销吗？

“开销”意味着您正在将一些可选的或虚假的工作量与实际需要完成的工作量进行比较，以实现特定的预期效果。总工作量与最低所需工作量之间的差异是开销。在这种情况下，不清楚您的基线是什么。您认为开销是多少？将一个指针复制到另一个指针的操作非常小——它只是一个 32 位或 64 位分配，具体取决于您的目标平台。这样的操作不是免费的，但速度非常快。

> 传递的 numPtr 指向的内存地址到 num2Ptr 指向的内存地址？

是的，您显示的代码将引用的内存中的值复制到引用`numPtr`的内存中`numPtr2`。当然，在您的示例中，指针分别引用地址 0x00000019 和 0x00000000，因此除非您知道那里有可读内存，否则在读取源值时会崩溃；除非您知道那里也有可写的内存（而且您可能没有），否则在写入时会崩溃。请注意，您的评论 ( `////num2Ptr points to the same value in the memory pointed by numPtr argument.`) 不正确。

> 如果是，那么它是否与按值传递相同？

传递指针不像按值传递。指针是对数据的引用，而不是数据的值。（当然，指针本身是按值传递的，但您应该取消引用它。）由于指针是可写的，您可以对其进行写入，调用者将在其返回时看到这种写入的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T20:33:04.457

> 我的问题是：如果这样的方法被非常频繁地调用，我们可以预期指针复制的显着开销吗？

用于复制`sizeof(int*)`？不可以。但是，对于函数调用，可能会有很大的开销，尤其是如果调用是通过 PLT 执行的。在多线程环境中，这会间接引入其他开销。

> 在下面的场景中，是否意味着我们将传递的 numPtr 指向的内存地址中的值复制到 num2Ptr 指向的内存地址中？

是的。

> 如果是，那么和传值一样吗？

不。按值传递整数更快，主要是因为按值传递不涉及读取内存，而是通过寄存器完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T20:33:18.030

指针复制成本非常低，但对于指针大小与存储数据一样大或更大的原始数据类型几乎没有意义。

对于您的第二个问题，您正在应对价值，并且与按价值应对相同。

# url - EmberJS：更改加载模型的 url (ember-data)

> ID：14407092
> 
> 赞同：10
> 
> 时间：2013-01-18T20:28:49.567
> 
> 标签：url, ember.js, http-status-code-404, ember-data

我遇到了 ember-data 的问题。例如，我在**http://localhost/~me/test创建了一个项目**

在我的项目中，我创建了一个商店和一个模型，如下所示：

```
... init stuff here ...

var attr = DS.attr;
App.Person = DS.Model.extend({
    firstName: attr('string'),
    lastName: attr('string'),
});

App.Store = DS.Store.extend({
    revision: 11,
    adapter: DS.RESTAdapter,
}); 
```

现在，当我（在我的路线的某个地方）搜索这样的人时

```
var person = App.Person.find(params); 
```

http : **//localhost/persons?post_id=10**被调用。这个当然不存在。我本来期望像**http://localhost/~me/test/persons?post_id=10**这样的东西。更好的是 **http://localhost/~me/test/persons.php?post_id=10**我怎样才能改变这个网址？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-29T21:07:00.130

# 这是 Ember Data Beta 3 的版本

要处理前缀，您可以使用`namespace`. `DS.RESTAdapter`要处理后缀，您需要自定义 的`buildURL`方法`DS.RESTAdapter`，`_super()`用于获取原始功能并对其进行修改。它应该看起来像这样：

```
App.ApplicationAdapter = DS.RESTAdapter.extend({
    namespace: '~me/test',
    buildURL: function() {
        var normalURL = this._super.apply(this, arguments);
        return normalURL + '.php';
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-18T22:31:12.127

MilkyWayJoe 是对的，在您的适配器中您可以定义命名空间。

```
App.Adapter = DS.RESTAdapter.extend({
  namespace: '~/me/test'
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-22T09:06:32.020

这也可以：

```
App.Person = DS.Model.extend({
    url: '~me/test/persons',
    firstName: attr('string'),
    lastName: attr('string'),
}); 
```

或者，如果您想使用命名空间和 .php 路径：

```
App.Adapter = DS.RESTAdapter.extend({
  namespace: '~/me/test',
    plurals: {
        "persons.php": "persons.php",
    }
});

App.Person = DS.Model.extend({
    url: 'persons.php',
    firstName: attr('string'),
    lastName: attr('string'),
}); 
```

复数位是为了确保 Ember Data 不添加“s”，例如 person.phps

# game-center - Apple Game Center 排行榜数据不匹配

> ID：14407093
> 
> 赞同：3
> 
> 时间：2013-01-18T20:28:50.230
> 
> 标签：game-center

我成功地向苹果游戏中心发布了高分，但是当我查看游戏中心排行榜 UI 时，数据很奇怪并且不匹配。我正在 5 个不同的设备上使用 5 个不同的游戏中心帐户进行测试，但排行榜的“所有 xxx 玩家”部分仅显示每个设备的两个或三个玩家，而不是预期的 5 个。其他奇怪的行为：

1.  我在“朋友”区域看到我自己和一位朋友的分数，但在“所有 2 名玩家”区域中只有我自己和另一个人（不是我的朋友）。为什么我看不到我的朋友？

2.  在另一台设备上，我在“朋友”区域中正确地看到了自己和一个（不同的）朋友，但是当我的朋友在下面的“所有 3 名玩家”区域中列出时，我的朋友的分数不同（较小的）。

我在沙盒环境中，如果这很重要，但我不想等到 prod 发现有问题。如果它只是陈旧的数据，我应该做任何 API 调用来刷新这些数据吗？

编辑：以上是使用 Apple 的**reportScoreWithCompletionHandler** () api 看到的行为。

# jquery - jQuery，滚动文本或图像链接，暗淡的文本和链接的图像

> ID：14407097
> 
> 赞同：0
> 
> 时间：2013-01-18T20:29:03.937
> 
> 标签：jquery, jquery-ui

我有带有相应图像的菜单链接。我正在尝试将文本链接连接到图像，因此当文本链接或图像翻转时，其他文本和图像变暗但不是主要的。谢谢您的帮助。

我有一个部分演示代码： http: [//jsfiddle.net/philoman/d23UE/](http://jsfiddle.net/philoman/d23UE/) 当我翻转文本或 img 时，一切似乎都变暗了。

```
$(document).ready(function () {
    $(".together li a").hover(function () {
        $(".together li a").stop().animate({
            opacity: 0.4
        }, 400);
        $(this).stop().animate({
            opacity: 1
        }, 1);
    },

    function () {
        $(".together li a").stop().animate({
            opacity: 1
        }, 400);
    });

}); 
```

HTML：

```
<ul id="buttons" class="together">
    <li>
        <a href="#">Button 1</a>
    </li>
    <li>
        <a href="#">Button 2</a>
    </li>
    <li>
        <a href="#">Button 3</a>
    </li>
</ul>
<ul id="images" class="together">
    <li>
        <a href="#">
            <img src="Button-1-image.jpg" />
        </a>
    </li>
    <li>
        <a href="#">
            <img src="Button-2-image.jpg" />
        </a>
    </li>
    <li>
        <a href="#">
            <img src="Button-3-image.jpg" />
        </a>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:04:10.387

我通过抓取悬停元素的索引解决了这个问题，然后只淡出*没有*相同索引的列表元素：

```
$(document).ready(function () {
  $(".together li a").hover(function () {
    var idx = $(this).closest('li').index();
    $('.together').each(function (i, el) { //restart index counting for each list
      $('li:not(:eq(' + idx + '))', el).stop().animate({opacity: 0.4}, 400);
    });
  },

  function () {
    var idx = $(this).closest('li').index();
    $('.together').each(function (i, el) {
      $('li:not(:eq(' + idx + '))', el).stop().animate({opacity: 1}, 400);
    });
  });
}); 
```

[http://jsfiddle.net/mblase75/d23UE/2/](http://jsfiddle.net/mblase75/d23UE/2/)

# javascript - 为什么这些 Javascript 代码段执行相同？

> ID：14407099
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:29:13.463
> 
> 标签：javascript, performance, benchmarking

```
obj = [1,2,3,4,5];
function iter(){
    for (var key in obj){
        key=key+key;
    };
};
function test1() { 
    iter(obj); 
};
function test2(){
    (function iter(obj){
        for (var key in obj){
            key=key+key;
        };
    })(obj);    
}; 
```

在这里，test1 和 test2 执行相同的操作，即使 test2 应该在每次调用它时创建一个新函数。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T20:36:42.597

~~我的猜测是性能没有差异，因为代码没有（有意义的）差异。解析器在解析代码时会在内部创建一次本地`iter`函数`test2`，而不是每次`test2`都调用它。（这不像使用`eval`.）如果有的话，第二个会快一点，因为`obj`它是函数的本地`iter`。~~嗯，那是错误的。

正如[这个 jsperf 测试](http://jsperf.com/explicit-vs-nested-function)所示，第二个确实更慢。你必须小心测量。您编写函数的方式，函数体中完成的工作量很容易掩盖两种情况下函数调用开销的差异。此外，第一种情况是访问全局`obj`，而第二种情况是访问参数。应消除这些差异，以尽可能仅测量您要测量的内容。我编写的 jsperf 测试试图做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:41:01.707

[你是对的，他们或多或少的表现相同](http://jsperf.com/directagainstclosure)

您的第二个函数中包含一个闭包，每次调用它时都会产生创建匿名函数的开销。

在第一个中，js可以调用它已经存储的函数。

这导致第二个函数有点慢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T20:37:14.183

我几乎可以保证您不会在 5 个周期内看到性能差异。在现代 JS 引擎中，您将需要通过数千甚至数万范围内的迭代来测试这一点，才能真正看到差异。然而，这种差异最终肯定会显现出来。

# matlab - MATLAB：循环绘图

> ID：14407101
> 
> 赞同：1
> 
> 时间：2013-01-18T20:29:22.407
> 
> 标签：matlab

我试图在循环内进行绘图，它只打印最后一个绘图。

我该如何解决？

我尝试在情节定义之后使用`hold on`and `drawnow`，但它没有用。

这是我的代码：

```
for t=1:5
  alive = Game(World , Generations, speed);
  plot(hplot2,1:Generations,alive);
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T02:01:16.280

坚持“形象”一直对我有用。

```
for t=1:5
    alive = Game(World , Generations, speed);
    figure;
    plot(hplot2,1:Generations,alive);
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:45:33.377

`hold on`应该管用。尝试这个：

```
figure
hplot2=gca;
hold on
for t=1:5
    alive = rand(1,Generations);
    plot(hplot2,1:Generations,alive);
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T03:48:10.640

由于您已经将轴句柄传递给`plot`，因此您只需要`pause(0.1)`在循环中放置类似的内容，您的原始来源就可以使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T14:48:19.177

您还可以使用`figure(t)`5 个不同的数字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T15:53:09.583

如果函数`Game(World , Generations, speed)`是确定性函数 - 它为每个`t`. 因此，每个`plot`命令都具有**完全相同**的输出，您无法区分第一个和最后一个图。

在每次迭代时尝试`plot`一个随机序列（如 shoelzer 的回答），看看你是否看到所有 5 个图。

此外，您可能希望使用`hold all`而不是`hold on`: 这样每个图都会从颜色图中获得不同的颜色。

# visual-studio-2012 - 渲染错误

> ID：14407102
> 
> 赞同：1
> 
> 时间：2013-01-18T20:29:25.973
> 
> 标签：visual-studio-2012

为通用标题道歉，但我不确定如何最好地解释这个标题。

Visual Studio 在多个位置的渲染效果很差，特别是 Quick Watch 窗口、Unit Test Sessions 窗口和 Unit Test 上下文菜单，请参见以下 url 中的屏幕截图。自从我安装 Visual Studio 2012 以来一直是这样，当时的操作系统是 Windows 7，我最近升级到了 Windows 8，所以这不是 Windows 8 特有的问题。

![在此处输入图像描述](../Images/b8cc00befcd439a2ef451ba96b429b7d.png)

这是 Windows 8 Pro 上的 Visual Studio 2012。这台机器是 Core i5，有 12GB 的 Ram，以 1% 的 CPU 运行，使用了 3Gb 的 Ram，所以它绝对不是电力不足的问题，这是我唯一一次看到这样的渲染错误。

我尝试了修复安装以及卸载并重新安装 Visual Studio，但没有任何区别。

此问题仅发生在 Visual Studio 2012 中，不会出现在计算机上的任何其他应用程序中，也不会出现在我安装的 VS2010 上。

一些疯狂的谷歌搜索没有透露任何信息，我没有想法。

**解决方案**

[从这里](http://www.techpowerup.com/downloads/2007/ATI_Catalyst_11.6_Software_Suite_Vista7_64-bit.html)下载了一些旧的 Vista/Windows 7 驱动程序，这解决了我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:23:58.673

最可能的罪魁祸首是视频驱动程序。我会通过切换到*基本 VGA 显示*驱动程序来排除视频驱动程序问题来确认。

如果这能解决问题，我会寻找不同的视频驱动程序或将问题报告给显卡制造商。

# javascript - 从 php 获取 xml 时未定义的索引

> ID：14407105
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:29:37.920
> 
> 标签：javascript, html, xml, php

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:32:03.773

您需要检查是否`$_GET['products']`甚至`$_GET['category']`存在。尝试：

```
if(isset($_GET['products'])){
    $products = $_GET['products'];
}
if(isset($_GET['category'])){
    $category = $_GET['category'];
} 
```

它是说`$products`或者`$category`是未定义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:33:49.790

您需要监控发送到服务器的具体 HTTP 请求。如果：

*   查询部分包含变量，错误是错误的，您必须在 PHP 或网络服务器配置中出错。
*   查询部分不包含这些变量，错误消息是正确的。然后，您可能想要检查为什么这些变量不是请求的一部分。

# entity-framework - 传递密钥时 ASP.NET MVC 4 ModelState 无效

> ID：14407106
> 
> 赞同：2
> 
> 时间：2013-01-18T20:29:39.967
> 
> 标签：entity-framework, asp.net-mvc-4, auto-increment, put, modelstate

我有一个 ASP.NET MVC 4 WebApi。我使用实体框架作为我的 ORM（首先是数据库）。数据库只有一个测试表，其中包含几个字段，其中 int "id" 设置为标识（自动增量）。

我只是尝试使用 javascript 客户端实现基本的 CRUD，但是`ModelState.IsValid = false`当我使用 POST 方法时，我总是会得到。我解析了错误，发现它来自值为 0 的“id”字段。api如何管理这种自动增量键？它期望在“id”字段中收到什么？

一切都基于模板。我没有将任何代码更改为 WebApi 生成的控制器。所有其他操作（读取、更新、删除）工作正常。

编辑：请注意，如果我绕过 ModelState.IsValid() 测试，数据将保存在数据库中，一切正常......但显然，这不是我想要做的。

编辑 2：我发现数据库中的身份属性由 EDMX 中 id 字段上的 StoreGeneratedPattern 属性处理。可能的值为：“Computed”、“Identity”和“None”。就我而言，它设置为“身份”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-28T10:10:48.867

检查验证未放在模型中的 ID 上。将 ID 设置为自动生成的。

# python - 如何使用这种结构在 Python 中进行相对导入？

> ID：14407107
> 
> 赞同：2
> 
> 时间：2013-01-18T20:29:51.017
> 
> 标签：python, python-import, relative-path

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:45:56.673

在`y.py`，添加这段导入代码

```
import sys
sys.path.insert(0, '..') 
```

然后做

```
from dir1.x import * 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:32:12.977

直接调用文件时，相对导入将不起作用：

```
python y.py 
```

因为他们有`__name__ == '__main__'`而不是完整的包名。

要使相对导入起作用，您必须将`y`其用作包：

```
python -m dir.dir2.y 
```

# c++ - casted integers to chars are not sequential

> ID：14407110
> 
> 赞同：-3
> 
> 时间：2013-01-18T20:30:10.740
> 
> 标签：c++, casting, char, sequential

```
cout << key;    
cout << " " << temp_char << " - " << key_char << " " << (temp_char-key_char) << endl; 
```

![enter image description here](../Images/8329a20da77453f6cdcdef29595cecd7.png)

```
 /*
 * Function: StringToInteger
 * Usage: n = StringToInteger(s);
 */

int StringToInteger(string str)
{
    int returnVal;
    istringstream result(str);
    string rest;

    if ((result >> returnVal).fail()) {
    Error("Not a valid number!");
    }
    result >> rest;
    if (rest != "") {
    Error("Extra characters not allowed");
    }
    return returnVal;
}

void Lexicon::buildMapFromFile(string filename )  //map
{
    ifstream file;
    file.open(filename.c_str(), ifstream::binary);
    string mem, key;
    string wow;
    unsigned int x = 0;

    cout << endl;
    string temp;

    while(true) {
        getline(file, wow);
        if (file.fail()) break; //boilerplate check for error
        while (x < wow.length() ) {
            if (wow[x] == ',') { //look for csv deliniator
                key = mem;
                mem.clear();
                x++; //step over ','
            } else 
                mem += wow[x++];
        }

        char key_char = (char)StringToInteger(key); //cast integer into a char
        key = key_char; //change from char to string for the map

        cout << key_char << " is " << (temp[0]-key[0]) << " " << mem << " " << endl;

        tokenToChar_map[key] = mem; //char to string
        charToToken_map[mem] = key; //string to char
        mem.clear(); //reset memory
        x = 0;//reset index
        temp = key;
    }
    //printf("%d\n", tokenToChar_map.size());
    file.close();
} 
```

A section of the input file:

```
103,089
104,090
105,091
106,092
107,093
108,094
109,095
110,096
111,097
112,098
113,099
114,100
115,101
116,102
117,103
118,104
119,105
120,106
121,107
122,108
123,109
124,110
125,111
126,112
127,113
128,114
129,115
130,116
131,117
132,118
133,119
134,120
135,121
136,122
137,123
138,124
139,125
140,126
141,127
142,128
143,129
144,130
145,131
146,132
147,133
148,134
149,135
150,136
151,137
152,138
180,RW4
181,R1
182,RW1
183,NBE
184,RW3
185,NB0
186,D1
187,EPS
188,C0
189,0M0
190,C1
191,RWY
192,D2
193,SB0
194,SBE
195,R2
196,RW2
197,RW5
210,0A1
211,0B2
212,0B3
213,0B4
214,0A5
250,*
251,?
252,z
253,test
254,test
255,test 
```

Integers 7,8,9,10,11,12, and 13 do not have an associated char

Integers 114 <-255>, 180 <28>, 210 <13>, and 250 <36> are more than 1 away from their predecessor integer

what is going on, why are these not sequential?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:37:09.620

Look at your input data:

```
[...]
152,138
180,RW4
[...]
197,RW5
210,0A1
[...]
214,0A5
250,*
[...] 
```

What is wrong with `(char)StringToInteger("152") - (char)StringToInteger("180")` producing `-28`?

If you can't tell us what you *specifically* what you expect your program to output, we can't help you with this question.

# ruby - 这个方法（读取）来自什么类（open-uri ruby ）

> ID：14407112
> 
> 赞同：1
> 
> 时间：2013-01-18T20:30:30.490
> 
> 标签：ruby

我读了一些代码，例如：

```
source = URI.join(uri).read 
```

这基本上是转到 URI，并将网页的源存储在变量中。

我在 IRB 中试过这个：

```
URI.join(uri).class 
```

它返回了`URI::HTTP`，但是，当我尝试时`URI.join(uri).read.class => String`。

我检查了`String`课程，但那里没有`read`方法。

我想存根这个方法，但不能，因为我不知道它来自哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:42:54.643

[`read`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/stringio/rdoc/StringIO.html#method-i-read)来自 Ruby 的[StringIO](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/stringio/rdoc/StringIO.html)模块，它的作用类似于普通的[IO](http://www.ruby-doc.org/core-1.9.3/IO.html)类。

[OpenURI](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/open-uri/rdoc/OpenURI.html)[`read`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/stringio/rdoc/StringIO.html#method-i-read)通过[StringIO](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/stringio/rdoc/StringIO.html)类提供，这就是它欺骗我们和我们的代码的方式，让我们认为 URL 是我们可以读取的设备。

`URI.join(uri).read.class`返回`String`是因为该页面是从 URL 指向的站点读取的，并且内容是一个字符串。OpenURI 覆盖 URI 类并添加`read`到它。如果你试试：

```
require 'uri'
URI.join('http://example.com').read 
```

如果没有必需的 OpenURI，您将收到一个错误，因为 URI 本身不知道如何`read`.

```
URI.join('http://example.com')
=> #<URI::HTTP:0x0000010292de68 URL:http://example.com>

URI.join('http://example.com').read
NoMethodError: undefined method `read' for #<URI::HTTP:0x0000010218b3b8 URL:http://example.com> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-13T22:42:42.703

而不是存根`URI.read()`（由 OpenURI 提供，如[Tin Man's answer 中所述](https://stackoverflow.com/a/14407293/27358)），考虑使用像[WebMock](https://github.com/bblimke/webmock)这样的库，它可以拦截 HTTP 请求，而不管用于制作它们的确切机制。

# emacs - 从 .emacs 加载和评估文件

> ID：14407117
> 
> 赞同：1
> 
> 时间：2013-01-18T20:30:48.840
> 
> 标签：emacs, repository

我在许多不同的机器和 VM 上工作，每个机器和 VM 都可能对`.emacs`. 我有一个 Git 存储库/子目录`.common-system`，其中包含第二个 Emacs Lisp 文件`.common-system/emacs`，其中包含用于我所有系统的通用定义。

我可以对`.emacs`哪些将自动加载和`eval`我的辅助定义文件进行哪些更改？启动后将辅助文件保留在我的缓冲区列表之外的奖励积分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:36:52.997

你有没有尝试过：

```
(load-file ".common-system/emacs") 
```

如果您指定文件的完整路径，它会更好（如[Stefan建议的那样），例如](https://stackoverflow.com/users/1283394/stefan)

```
(load-file "~/.common-system/emacs") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:57:20.297

如果您坚持使用当前的存储库布局，则使用`load-file`（如其他人所建议的那样）是要走的路。

但是，如果您命名您的顶级目录`.emacs.d`并将文件`init.el`放入其中，Emacs 将找到它并自动运行它。这样，您不必`.emacs`在使用的每个系统上手动编辑文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T20:43:41.963

您使用 (cond)，调度变量，例如用户登录名、系统类型和系统名称

```
(cond
  ((equal user-login-name 
          "myname")
   ;; Stuff
   )
  ((equal system-type 'gnu/linux)
   (require 'some-file)
   ;; some-file, could be any file in load-path, named some-file.el, and ending
   ;; with (provide 'some-file)
   )) 
```

# c++ - DirectX 应用程序每 3 秒“打嗝”一次

> ID：14407120
> 
> 赞同：9
> 
> 时间：2013-01-18T20:31:01.380
> 
> 标签：c++, directx, lag, directx-11, frame-rate

一个多星期以来，我一直在调查我的 DirectX 11 C++ 应用程序中的一个问题，因此我正在向 StackOverflow 上的好人寻求任何可以帮助我找到这个问题的见解。

我的应用程序将主要以每秒 60-90 帧的速度运行，但每隔几秒钟我就会得到一个大约需要 1/3 秒才能完成的帧。经过大量调查、调试和使用各种代码分析器，我将范围缩小到对 DirectX API 的调用。但是，从一个缓慢的帧到下一帧，并不总是同一个 API 调用导致速度下降。在我最近的一次运行中，停止的呼叫（总是大约五分之一秒）是

*   ID3D11DeviceContext:UpdateSubresource
*   ID3D11DeviceContext:DrawIndexed
*   IDXGISwapChain：现在

不仅停止的函数不是同一个函数，而且这些函数中的每一个（主要是前两个）慢速调用可能来自我代码中的不同位置，从一个到另一个。

根据我放置在代码中以帮助测量事物的多个分析工具和我自己的高分辨率计时器，我发现这种“打嗝”会以不到 3 秒（~2.95）的一致间隔发生。

此应用程序从外部硬件收集数据并使用 DirectX 实时可视化该数据。在应用程序运行时，硬件可能处于空闲状态或以各种速度运行。硬件运行得越快，收集的数据就越多，并且必须进行可视化。我指出这一点是因为在考虑此错误的某些特征时它可能很有用：

*   硬件空闲时不会出现长帧。这对我来说很有意义，因为软件只需要重绘它已经拥有的数据，而不必将新数据传输到 GPU。
*   但是，无论硬件运行速度如何，长帧都会以这些一致的 3 秒间隔出现。因此，即使我的应用程序每秒收集两倍的数据量，长帧的频率也不会改变。
*   这些长帧的持续时间非常一致。始终在 0.25 到 0.3 秒之间（我相信是对 DirectX API 的缓慢调用是一致的，因此整体帧持续时间的任何变化都在该调用之外）。
*   上周进行现场测试时（当我第一次发现这个问题时），我注意到在应用程序的几次运行中，经过很长时间（可能 20 分钟或更长时间）的连续测试，除了观看之外没有与程序进行太多交互，打嗝就会消失。如果我们与应用程序的某些功能交互或重新启动程序，打嗝会再次出现。对我来说没有意义，但几乎就像 GPU “想通”并解决了问题，但当我们改变它之前所做的工作模式时又恢复了原状。不幸的是，我们硬件的性质使我很难在实验室环境中复制它。

此错误在具有非常相似硬件（双 GTX580 卡）的两台不同机器上始终出现。但是，在该应用程序的最新版本中，并未出现此问题。不幸的是，代码从那时起经历了许多变化，因此很难确定是什么具体变化导致了问题。

我考虑了图形驱动程序，因此更新到最新版本，但这并没有什么不同。我还考虑了对两台计算机进行了其他更改的可能性，或者可能对运行在两台计算机上的软件进行了更新，这可能会导致 GPU 出现问题。但是我想不出除了在应用程序运行时在两台机器上运行的 Microsoft Security Essentials 之外的任何东西，而且我已经尝试禁用它的实时保护功能，但无济于事。

虽然我希望原因是我可以关闭的外部程序，但最终我担心我必须使用 DirectX API 做一些不正确/不正确的事情，导致 GPU 必须每隔几秒钟进行一次调整。也许我在更新 GPU 上的数据的方式上做错了（因为延迟只发生在我收集要显示的数据时）。然后 GPU 每隔几秒钟就会停顿一次，并且在停顿期间碰巧调用的任何 API 函数都不能像往常一样快地返回？

任何建议将不胜感激！

谢谢，蒂姆

**更新（2013.01.21）：**

我终于屈服了，并重新搜索了我的应用程序的先前版本，直到我发现没有发生此错误的地方。然后我一个接一个地进行修订，直到我准确地找到错误开始发生的时间并设法查明问题的根源。在我将“无符号整数”字段添加到顶点类型后，问题开始出现，我为其分配了一个大的顶点缓冲区。由于顶点缓冲区的大小，此更改将大小增加了 184.65 MB（从 1107.87 MB 增加到 1292.52）。因为我确实在我的顶点结构中需要这个额外的字段，所以我找到了其他方法来减少整体顶点缓冲区大小，并将其降低到 704.26 MB。

我最好的猜测是，添加该字段及其所需的额外内存导致我超出了 GPU 的某个阈值/限制。我不确定这是超出了总内存分配，还是超出了单个顶点缓冲区的某些限制。无论哪种方式，似乎这种过度都会导致 GPU 每隔几秒就必须做一些额外的工作（也许与 CPU 通信）每隔几秒，所以我对 API 的调用不得不等待这个。如果有人有任何信息可以阐明大型顶点缓冲区的含义，我很想听听！

感谢所有给我时间和建议的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:38:31.260

1）尝试打开VSYNC

2）您是否正在分配/释放大块内存？尝试在程序开始时分配内存并且不要释放它，只需覆盖它（这可能是您使用 updatesubresource 所做的）

3) 将与硬件设备的交互放在单独的线程上。在设备完全完成向应用程序传递数据后，将其加载到 GPU 中。不要让设备控制主线程。我怀疑设备经常阻塞主线程，*我完全在推测*，但如果你是直接将数据从设备复制到 GPU，设备偶尔会阻塞，这会导致速度变慢。

# jquery - 每个循环的变量：未定义

> ID：14407123
> 
> 赞同：0
> 
> 时间：2013-01-18T20:31:21.130
> 
> 标签：jquery, json, undefined

我通过 JSON 获取数据

```
$.getJSON('http://api.flickr.com/services/rest/'
            + '?format=json&method=flickr.photosets.getPhotos'
            + '&photoset_id=' + photoset_id + '&per_page=1000' 
            + '&page=1' + '&api_key=' + apiKey 
            + '&user_id=' + userId + '&jsoncallback=?', 
    function (data) {
        var fullPhotoURL, flickrLink;
        var images = [];
        var basePhotoURL;
        var fullPhotoURL;

        $.each(data.photoset.photo, function (i, flickrPhoto) {
            var basePhotoURL = 'http://farm' + flickrPhoto.farm 
                 + '.static.flickr.com/' + flickrPhoto.server + '/' 
                 + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";

            var fullPhotoURL = 'http://farm' + flickrPhoto.farm 
                + '.static.flickr.com/' + flickrPhoto.server + '/' 
                + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";

            images.push($("<img/>").attr("src", basePhotoURL));
        });

        $.each(images, function (index, img) {
            img.appendTo("#photographs").wrap(("<div class='item'></div>"));

        });

    }); 
```

我想在每个 .item div 中附加两个 a（带有 href basePhotoURL 和 fullPhotoURL）。

```
$(".item")
    .append("<a href='" + basePhotoURL + "'.jpg' class='zoom' />");
$(".item")
    .append("<a href='" + fullPhotoURL + "' class='flickr' target='_blank' />"); 
```

问题是，当我将它们放在每个函数的第二个中时，这两个 a 被附加到 #photographs (divception :-)) 中存在的每个 .item （因此，300 个项目 x 2 a 的 PER .item）。当我将这两个 a 放在每个函数的最后一个之外时，我得到一个未定义的错误。顺便说一句，不要介意 fullPhotoURL 和 basePhotoURL 变量的值；他们是不正确的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:48:58.377

为什么不直接将它们附加到 div 标签？

```
 var div = $("<div class='item'></div>");
    div.append(....);
    div.append(....); 
```

此外，您无法从第二个循环中的第一个循环访问变量。如果由于某种原因你真的需要 2 个循环，你可以在数组中传递它们。

```
 images.push({base: basePhotoURL, full: fullPhotoURL}); 
```

并在第二个循环中创建 img（或将其与其余部分一起传递）。

如果您担心性能，请执行以下操作：

```
 var plist = $("<div></div>");
    $.each(data.photoset.photo, function (i, flickrPhoto) {
        var row = $("<div class='item'></div>");

         //add stuff

        plist.append(row);
    });
    plist.appendTo("#photographs"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:00:28.523

Eli的答案和[这篇](https://stackoverflow.com/a/2544891/1355555)文章的结合。在这里，您只需将数据附加到 DOM 一次。

```
.getJSON('http://api.flickr.com/services/rest/?format=json&method=flickr.photosets.getPhotos&photoset_id=' + photoset_id + '&per_page=1000' + '&page=1' + '&api_key=' + apiKey + '&user_id=' + userId + '&jsoncallback=?', function(data) {

    var dataToAppend = ''
    $.each(data.photoset.photo, function(i, flickrPhoto){
        var basePhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/'
        + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";  

        var fullPhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/'
        + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";          

        var $img = $("<img/>").attr("src", basePhotoURL);
        var $wrap = $("<div class='item'></div>");
        $wrap.append($img);
        $wrap.append("<a href='" + basePhotoURL + "'.jpg' class='zoom' />");
        $wrap.append("<a href='" + fullPhotoURL + "' class='flickr' target='_blank' />");
        dataToAppend += $wrap;
    });
    $'#photographs').append(dataToAppend);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:05:29.200

我也可以使用它来获得您想要的格式，基本上是一样的。

```
$.getJSON('http://api.flickr.com/services/rest/?format=json&method=flickr.photosets.getPhotos&photoset_id=' + photoset_id + '&per_page=1000' + '&page=1' + '&api_key=' + apiKey + '&user_id=' + userId + '&jsoncallback=?', function (data) {
    var fullPhotoURL, flickrLink;
    var images = [];
    var basePhotoURL;
    var fullPhotoURL;

    $.each(data.photoset.photo, function (i, flickrPhoto) {
        var basePhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/' + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";
        var fullPhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/' + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";

        $('<img/>', { 'src': basePhotoURL }).appendTo("#photographs").wrap('<div/>', { 'class': 'item' }).append('<a href="' + basePhotoURL + '.jpg" class="zoom" /> <a href="' + fullPhotoURL + '" class="flickr" target="_blank" />');
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T20:48:11.550

我认为你让事情变得比他们必须的更难。这是我提出的更改。

```
.getJSON('http://api.flickr.com/services/rest/?format=json&method=flickr.photosets.getPhotos&photoset_id=' + photoset_id + '&per_page=1000' + '&page=1' + '&api_key=' + apiKey + '&user_id=' + userId + '&jsoncallback=?', function(data) {

    $.each(data.photoset.photo, function(i, flickrPhoto){
        var basePhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/'
        + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";  

        var fullPhotoURL = 'http://farm' + flickrPhoto.farm + '.static.flickr.com/'
        + flickrPhoto.server + '/' + flickrPhoto.id + '_' + flickrPhoto.secret + "_b.jpg";          

        var $img = $("<img/>").attr("src", basePhotoURL);
        var $wrap = $("<div class='item'></div>");
        $wrap.append($img);
        $wrap.append("<a href='" + basePhotoURL + "'.jpg' class='zoom' />");
        $wrap.append("<a href='" + fullPhotoURL + "' class='flickr' target='_blank' />");

        $wrap.appendTo('#photographs')

    });

}); 
```

所以现在我们生成 img，然后是它的包装器，然后将 img 附加到包装器，然后将锚附加到包装器，然后将包装器附加到照片 div。我们在一个循环中一次性完成所有工作。不需要第二个循环，因此不需要图像阵列。

# arrays - 如何制作getArray方法

> ID：14407141
> 
> 赞同：0
> 
> 时间：2013-01-18T20:32:10.410
> 
> 标签：arrays

当我运行代码的特定部分时，我有：

```
 public String getWords (){
    randomWord = words[randy.nextInt(words.length)];
    return randomWord;
}

private String[] words = {"apple", "beret", "arose", "along", "beamy", "becks", "decks", "barks",
                              "stark", "start", "stabs", "baggy", "asked", "asset", "asses", "audit",
                              "bowls", "boxes", "seats", "balls", "boats", "boxer", "brick", "bound",
                              "brass", "caked", "braid", "caged", "essay", "fault", "dents", "dutch",
                              "ethos", "dunks", "pains", "faxes", "mummy", "mixer", "mills", "might",
                              "moral", "teeth", "wings", "works", "walls", "tolls", "crawl", "toxin",
                              "bangs", "tough"};

Hangman man = new Hangman();
      man.mainScreen();

public void mainScreen (){
        start();
        while (guesses != maxGuesses){
            continueGame();
            checkBodyParts();
        }
        gameOver();
    } 
```

错误：

```
java.lang.NullPointerException
at Hangman.getWords(Hangman.java:43)
at Hangman.<init>(Hangman.java:28)
at GameApp.main(GameApp.java:9) 
```

我收到 NullPointerException 的运行时错误。我四处询问，他们说我应该制定一种方法来获取数组单词，因为我目前无法获得它。这个方法应该有什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T01:29:06.913

我相信你的问题在这里：

```
private String myGeneratedRandomWord = getWords(); 
```

此方法试图在创建数组“words”之前使用它。在创建数组“words”后移动这一行。

这应该可以解决您的 NullPointerError。

# mysql - MySQL 将排序规则与所有 utf8 db/tables/columns 非法混合

> ID：14407145
> 
> 赞同：2
> 
> 时间：2013-01-18T20:32:31.963
> 
> 标签：mysql, utf-8, character-encoding, latin1

我不明白。我从来没有真正得到它，但现在我真的迷路了。我的数据库是 utf8，我的表是 utf8，我的列是 utf8。有些数据是 latin1/iso-8859-1，所以它只是显示错误。（我现在不在乎。）以前都是 latin1，现在是 50/50，更糟。

当我没有特别告诉连接使用所有 utf8 时，所有查询都有效并且所有数据都正确显示（即使存储错误）。那是因为存储错误（utf8 中的 latin1）并且连接“错误”（我猜默认为 latin1），因此相互抵消。字符正常，没有错误。但显然这是不可接受的，因为数据库包含废话。

所以我想要所有的utf8，所以我专门告诉MySQL（每次第一次查询）：

```
SET NAMES 'utf8' COLLATE 'utf8_general_ci' 
```

然后不知何故以下查询失败：

```
SELECT
  r.id,
  r.slots,
  r.start_time AS StartA,
  ADDTIME(r.start_time, SEC_TO_TIME(60*r.slots*s.slotsize)) AS EindA,
  '14:30:00' AS StartB,
  '15:30:00' AS EindB
FROM
  club_sports s, resources c, reservations r
WHERE
  r.resource_id = c.id AND
  c.club_sport_id = s.id AND
  r.not_cancelled = '1' AND
  r.resource_id = 25 AND
  r.date = '2013-01-18'
HAVING
  (
    (StartA >= StartB AND StartA < EindB) OR
    (EindA >= StartB AND EindA < StartB) OR
    (StartB >= StartA AND StartB < EindA) OR
    (EindB >= StartA AND EindB < StartA)
  )
LIMIT 1 
```

出现以下错误：

> 非法混合排序规则 (utf8_general_ci,COERCIBLE) 和 (latin1_swedish_ci,NUMERIC) 用于操作 '<'

我不明白！哪里来的`latin1_swedish_ci,NUMERIC`？？HAVING 中的所有部分都不是数字，它们都是相同的 utf8，对吗？源表和列是utf8！

我知道这个查询并不完美，但现在这无关紧要。我应该能够创建假/tmp 列`''`并在 HAVING 中比较它们，对吗？

我真的需要我的db是utf8，因为我真的需要我的数据是utf8，因为json_encode真的需要utf8，所以我真的需要连接是utf8。帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:54:50.937

HAVING 子句用于聚合值（想想 GROUP BY 项的 WHERE 子句）。

您需要在 WHERE 子句中重做计算（如 ADDTIME 函数），因为您不能使用别名。

# javascript - Jquery之间的冲突

> ID：14407146
> 
> 赞同：-5
> 
> 时间：2013-01-18T20:32:43.203
> 
> 标签：javascript, html

当我在同一个文件上创建很多 jquery 函数时，我遇到了一个问题，但它不起作用。我尝试使用 de jQuery.noConflict() 函数，但它不起作用（也许我没有以好的方式使用它，或者我在错误的地方使用它）如何在我的示例代码中使用 noconflict 函数？

```
<script type="text/javascript" src="jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="jquery.ui.core.min.js"></script>
<script type="text/javascript" src="jquery.ui.widget.min.js"></script>
<script type="text/javascript" src="jquery.ui.mouse.min.js"></script>
<script type="text/javascript" src="jquery.ui.tabs.min.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="jquery.dataTables.js"></script>
<script type="text/javascript">
        $(document).ready(function()
        {
           var jQueryTabs1Opts =
           {
              event: 'click',
              collapsible: false
           };
           $("#jQueryTabs1").tabs(jQueryTabs1Opts);
        });

</script>

<script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
            $('#example').dataTable( {
                "aaSorting": [[ 4, "desc" ]]
            } );
        } );
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:37:11.100

如果您删除重复导入，您的代码应该可以工作。

删除此行：

```
<script type="text/javascript" src="jquery.js"></script> 
```

注意你导入的 UI 库需要的 jQuery 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:00:52.773

我找到了解决方案。解决方案是使用这样的 noConflict 函数：

```
<script>
var jq172 = jQuery.noConflict();
jq172(document).ready(function()
{
   var jQueryTabs1Opts =
   {
      event: 'click',
      collapsible: false
   };
   jq172("#jQueryTabs1").tabs(jQueryTabs1Opts);
}); 
</script> 
```

# c++ - 如何在类中创建不可变的静态公共对象？

> ID：14407147
> 
> 赞同：2
> 
> 时间：2013-01-18T20:32:45.620
> 
> 标签：c++

我有一个 Color 类，它保存颜色的红色、绿色、蓝色和 alpha 通道的值。类构造函数允许您通过指定四个通道的值来创建新颜色。但是，为方便起见，我还想为程序员提供一些“预制”颜色。例如，而不是像

`DrawBox(new Color(255, 0, 0));`

你可以说

`DrawRectangle(Color::Red);`

其中 Color.Red 是位于 Color 类中的 Color 的一个实例。如何在 Color 类中声明这些 Color 实例？我确信这种技术有一个名称，但是当我在网上寻求帮助时，我不知道要使用什么搜索词。

我没有使用任何内置或公开可用的类或库，因为这是创建基本图形堆栈的个人练习的一部分。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T20:35:04.730

首先，避免使用`new`. 您可以使用`Color`简单的值类型。

现在作为您问题的答案，是的，您可以这样做：

```
//color.h

typedef unsigned char byte;

class Color
{
    public:
        //declaration
        const static Color Red;
        const static Color Green;
        const static Color Blue;
    public:

       Color(byte red, byte green, byte blue);
};

//define the static members in color.cpp file
#include "color.h"

const Color Color::Red(255,0,0);
const Color Color::Green(0,255,0);
const Color Color::Blue(0,0,255); 
```

然后`Color::Red`随心所欲地使用。

# javascript - codemirror - ondblclick 只影响类的最后一个元素

> ID：14407149
> 
> 赞同：0
> 
> 时间：2013-01-18T20:33:03.257
> 
> 标签：javascript, javascript-events

## [http://jsfiddle.net/tZVsS/72/](http://jsfiddle.net/tZVsS/72/)

如果你双击类的前两个元素中的任何一个，`.code`你会注意到 setOptions 只会应用于类的最后一个元素`.code`。我需要发生的是，当您双击每个单独的元素时，setoption 将应用于该元素，为什么这不起作用以及可以做些什么来修复它

```
(function () {
    var codes = document.getElementsByClassName("code");
    for (i = 0; i < codes.length; i++) {

        var $this = codes[i];
        var $unescaped = $this.innerHTML.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");

        var isspan = $this.nodeName.toLowerCase() == "span";

        $this.innerHTML = "";

        if (isspan) {
            $this.style.display = "inline-block"
        } else {
            $this.style.display = "inline"
        }

        var editor = new CodeMirror($this, {
            value: $unescaped,
            mode: 'javascript',
            lineNumbers: false,
            readOnly: true
        });
        $this.ondblclick = function () {
            editor.setOption("readOnly", false);
            editor.setOption("lineNumbers", true);
        }
    }
})(); 
```

HTML 在下面，注意：它没有多大用处，而是追溯我在小提琴上所做的事情，以便更好地理解

```
Some code <span class="code inline">function inline() { alert('inline code') }</span> inside
a sentence.
<div class="code">function test() { return false; }</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:05:05.657

只是范围问题

更新小提琴：http: [//jsfiddle.net/tZVsS/73/](http://jsfiddle.net/tZVsS/73/)

```
(function () {
    var codes = document.getElementsByClassName("code");
    for (i = 0; i < codes.length; i++) {
        (function ($this) { 
            var $unescaped = $this.innerHTML.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");

            var isspan = $this.nodeName.toLowerCase() == "span";

            $this.innerHTML = "";

            if (isspan) {
                $this.style.display = "inline-block"
            } else {
                $this.style.display = "inline"
            }

            var editor = new CodeMirror($this, {
                value: $unescaped,
                mode: 'javascript',
                lineNumbers: false,
                readOnly: true
            });
            $this.ondblclick = function () {
                console.log($this);
                editor.setOption("readOnly", false);
                editor.setOption("lineNumbers", true);
            }
        })(codes[i]);
    }
})(); 
```

# objective-c - Class 类型的属性

> ID：14407152
> 
> 赞同：0
> 
> 时间：2013-01-18T20:33:07.967
> 
> 标签：objective-c

我有一个类类型的属性。IE：

```
 @property (nonatomic, Strong or Weak?) Class myClass; 
```

它应该是强引用还是弱引用？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:36:54.200

这是安全的，`unsafe_unretained`因为类永远不会被释放。

# java - Java：超类的接口泛型

> ID：14407155
> 
> 赞同：5
> 
> 时间：2013-01-18T20:33:30.663
> 
> 标签：java, generics, interface

想象一下下面的代码：

```
class A {}
class B extends A {}

interface IA extends Iterable<A> {}
interface IB extends Iterable<B> {} 
```

理想情况下，我希望接口`IB`也能够扩展`IA`，因为它实际上允许您检索`A`s。

```
interface IB extends Iterable<B>, IA {} 
```

甚至

```
interface IB extends Iterable<B> implements IA {} 
```

但是，编译器真的不喜欢这两个，如果允许这样做，它将使我的代码更好，因为从概念上讲 B 可以用作 A 而无需到处向上转换

我有哪些解决方案可以解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T20:41:50.763

泛型的[非协变](http://www.ibm.com/developerworks/java/library/j-jtp01255/index.html)意味着你想要的东西是不可行的（至少在一般情况下不可行）。

但是，也许[通配符](http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html)可以解决您的特定问题？例如

```
void methodThatOperatesOnA(Iterable<? extends A> it) {
    ...
} 
```

`it`这将允许您从 s中提取元素`A`，但编译器会阻止您插入对象，^*因为它不能保证保持不变量。

* * *

[* 除了`null` ~~和其他一些古怪的情况~~]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:16:04.443

一个类型不能有两个超类型`G<X> and G<Y> where X!=Y`- 可能是由于擦除。

解决问题的一种方法是对要迭代的类型使用类型参数

```
interface IA<X extends A> extends Iterable<X>
{
    @Override Iterator<X> iterator();
}
interface IB extends IA<B>
{
    @Override Iterator<B> iterator();
} 
```

我通常会避免这种情况，它只是更复杂。

* * *

在您的示例中，首先扩展`Iterable<A>`可能不是一个好主意。例如

```
class Team implements Iterable<Member>
{
    public Iterator<Member> iterator() { ... }
}

for(Member member : team) ... 
```

但团队概念可能不仅仅是成员的集合。可能更清楚

```
class Team
{
    Iterable<Member> members() { ... }
}
for(Member member : team.members()) ... 
```

在这种情况下，您的类型可以设计为

```
interface IA
{
    Iterable<? extends A> members();
}

interface IB extends IA
{
    @Override
    Iterable<? extends B> members();
} 
```

* * *

人们也可以质疑是否`Iterable`应该更放松，而不是

```
public interface Iterable<T> 

    Iterator<T> iterator(); 
```

会不会更好

```
public interface Iterable<T> 

    Iterator<? extends T> iterator(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T20:36:36.040

Java 中的泛型不是协变的——也就是说，`List<String> instanceof List<Object>`是假的。因此，我相信，**这**`IB`不是编译器问题的一个实例，因此也是导致编译器问题的原因。**`IA`**

 **想象一个新的类，`class C extends A {}`. C IS-A A，因此 C 将是 IA 包含的合法值——但不是 IB。因此，如果您尝试将 IB 用作 IA 的实例，则可以插入 C 并破坏类型安全保证。**

# ruby-on-rails - Ruby/Rails 安全警报

> ID：14407156
> 
> 赞同：10
> 
> 时间：2013-01-18T20:33:32.707
> 
> 标签：ruby-on-rails, ruby, security, rubygems

Ruby 开发人员如何不断更新 ruby​​ 和 ruby​​gem 安全警报和更新？我今天发现了这个：

[https://support.cloud.engineyard.com/entries/22915701-january-14-2013-security-vulnerabilities-httparty-extlib-crack-nori-update-these-gems-immediately](https://support.cloud.engineyard.com/entries/22915701-january-14-2013-security-vulnerabilities-httparty-extlib-crack-nori-update-these-gems-immediately)

并想知道开发人员通常如何跟上这些类型的警报。提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-18T20:39:54.750

对于 Rails，只需在 Rails 安全 google 组中注册电子邮件更新：

[https://groups.google.com/forum/?fromgroups#!forum/rubyonrails-security](https://groups.google.com/forum/?fromgroups#!forum/rubyonrails-security)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-23T16:31:25.143

[Ruby 安全公告](https://groups.google.com/forum/#!forum/ruby-security-ann)列表专门针对 Ruby 和 Rubygems 中的安全问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-07T16:02:13.960

还可以查看[bundler-audit gem](https://github.com/rubysec/bundler-audit)来自动化这个过程。它将检查您的 gem 是否存在已知漏洞，并建议对一般更新过程进行一些改进。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-01T14:41:55.203

实际上，我[几周前就写过这个](http://gavinmiller.io/2015/staying-up-to-date-with-security-alerts/)。这些是我推荐的东西：

1.  关注[Ruby](https://groups.google.com/forum/#!forum/ruby-security-ann)和[Rails](https://groups.google.com/forum/?fromgroups#!forum/rubyonrails-security)安全邮件列表。
2.  使用[CVE 报告](https://www.cvedetails.com/)尽快获取安全警报的详细信息。CVE 代表“Common Vulnerabilities and Exposures”，它是一种行业标准的报告机制。
3.  尽可能使您的依赖项保持最新。运行`bundle outdated`以获取此信息。将您的测试套件保持在 > 85% 将使依赖项升级变得更加容易。
4.  为您的团队创建一个流程，以便您可以及时了解最新的安全问题。我在博客文章中详细说明了如何做到这一点。
5.  使用 、 、 或 之类的工具`bundle-audit`来`AppCanary`自动`Hakiri`检测`Gemnasium`gem 安全问题。这些是插入 CI 环境的简单工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T20:38:56.380

我认为这两个来源应该会尽快为您提供该信息。您还可以在 ruby​​gems.org 上注册一个帐户并将 Rails 添加到您的 RSS 提要中。

*   [Twitter 上的 Ruby on Rails](https://twitter.com/rails)
*   [Rails 核心邮件列表](http://groups.google.com/forum/?fromgroups#!forum/rubyonrails-core)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T22:43:33.853

此外，[Ruby 5 Podcast](http://ruby5.envylabs.com/)是每周两次的资源，每周只占用您 10 分钟的时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-14T14:08:36.687

此外，如果您发现很难抽出时间查找更新或执行实际更新：使用微习惯，例如每周一更新软件，正如我在[本周使用 Rails 安全策略所描述的那样](http://bauland42.com/articles/a-week-with-a-rails-security-strategy/)

# winapi - 删除 CreateFont 创建的字体

> ID：14407158
> 
> 赞同：1
> 
> 时间：2013-01-18T20:33:33.390
> 
> 标签：winapi, fonts, bitmap, gdi+, gdi

如果我使用 CreateFont() 创建字体（作为非静态变量）并使用 SelectObject 在函数中使用它，那么在退出该函数之前，我必须选择前一个对象并使用 DeleteObject 删除字体。

但是如果我声明一个全局变量`HFONT gFont = CreateFont(...)`，那么在`WM_DESTROY`消息中，我应该调用`DeleteObject`删除字体吗？

同样在这种情况下，如果我`hOldFont = SelectObject(memDC, gFont);`在函数中使用，我应该`SelectObject(memDC, hOldFont);`在退出该函数之前调用吗？在我看来，对于 Bitmap，我们应该进行清理，但我不知道这是否适用于其他 GDI 对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:46:10.753

将每个`DeviceContext`(DC) 视为画布。这些画布中的每一个一次只能为每种**类型拥有一个活动***GDI 对象*。因此，您可以为该画布选择一个、、等作为*活动*画布。**`Brush``Pen``Font`**

 ***当您调用时，`SelectObject()`您正在设置该类型的活动对象。把它想象成“拿起红笔画画，然后拿起蓝笔画画”。如果 GDI 函数采用`Pen`（例如`Rectangle`），它将使用最后选择的笔通过`SelectObject`。这就是为什么`SelectObject`返回之前的值，以便您可以存储它以在完成后恢复状态。

您应该始终`DestroyObject`在您不再需要的任何已创建 GDI 对象上使用。此外，您应该始终`DeleteDC`为每次`CreateDC`通话和`ReleaseDC`每次`GetDC`通话使用（当您不再需要 DC 时）。

最佳做法是将`DeviceContext`(DC) 恢复为您找到它的方式。因此，如果您设置`Font`or `Brush`，您应该在返回之前将其恢复为原始值。唯一不重要的恢复是当您无论如何都要处理 DC 时，也许是临时的`Bitmap`.

如果你使用`GetStockObject`，你不需要调用`DeleteObject`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-29T16:45:02.640

德尔福（帕斯卡）示例：

```
Procedure AngleTextOut(hDC: THandle; const sTxt: string; iX, iY, iH, iAngle: integer);
var
    aryC: array[0..255] of Char;
    hFont, hFontOld: THandle;
begin
    StrPCopy(aryC, sTxt);
    hFont:= CreateFont(-iH, 0, iAngle *10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'arial');
    hFontOld:= SelectObject(hDC, hFont);
    TextOut(hDC, iX, iY, aryC, StrLen(aryC));
    SelectObject(hDC, hFontOld);
    DeleteObject(hFont);
end;//  AngleTextOut 
```***

# ios - iOS：处理数据和大量视图

> ID：14407160
> 
> 赞同：0
> 
> 时间：2013-01-18T20:33:40.587
> 
> 标签：ios, objective-c

我有一个处理数据的一般设计问题。我目前正在开发一个应用程序，该应用程序存储大约 100 多个不同的唯一属性（主要是整数、一些字符串），并且目前正在使用自定义类的单个对象来管理所有这些属性。

我需要数据在整个应用程序中“持久”，所以我目前通过 segues 传递对象。我已经设法构建了 20 多个视图，其中大多数都有自己的视图控制器。我对 Objective-C 和 iOS 开发非常陌生，感觉这是一种不好的做法。

我对核心数据不太了解，并且不确定它是否对我来说是一个更好的解决方案。我也读过关于单例的文章，并且听说过将它们用于这种解决方案的各种说法。

将来，我需要将临时保存在我编写的自定义类中的数据永久存储。

处理这种情况的最佳方法是什么？在许多不同的视图中传递对象是标准做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:49:01.070

如果数据需要渗透到整个应用程序中，那么单例可能是一个不错的选择。

在游戏开发中有一种称为黑板模式的模式，它允许游戏的任何部分对黑板进行读写。这可以用于健康点，分数等......

这也很适合你。而不是一直推送您的数据模型，只需使用单例访问每个位/如果需要更新数据，则将更新存储到单例。

要避免的事情是使用单例只是因为它在那里。如果需要将一些数据从一个地方传递到另一个地方，那么如果没有必要，不要只使用单例。

# opengl-es - 将深度缓冲区引入使用多个顶点数组对象的渲染器

> ID：14407163
> 
> 赞同：0
> 
> 时间：2013-01-18T20:33:44.637
> 
> 标签：opengl-es, opengl-es-2.0, depth-buffer, vertex-array

我有一个渲染基础设施，它使用多个顶点数组对象来渲染一个复杂的场景。每个顶点数组对象负责维护自己的一组绑定缓冲区、指针和属性（正如它们的设计目的）。

给定多个负责渲染的数组对象，如何引入深度缓冲，使每个单独的数组对象在渲染期间使用相同的深度缓冲区？换句话说，我如何统一 Vertex Array Objects（及其良好的封装属性）和深度缓冲的概念，这似乎是一个更全局的概念。

我发现的所有示例都描述了在帧缓冲区的上下文中使用深度缓冲区。苹果[在这里](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/WorkingwithEAGLContexts/WorkingwithEAGLContexts.html)描述了这种技术。那么在帧缓冲区级别实现深度缓冲然后让顶点数组对象写入该帧缓冲区的技术是什么？有没有我可以遵循的使用 VAO 和深度缓冲的示例？

我有一个封装顶点数组对象的类，这是它的绑定方法（负责设置各种缓冲区、指针和属性）。

```
void scene_GLBuffer::BindTriangles()
{
    glBindVertexArrayOES(_mVertexArrayObject);
    glGenVertexArraysOES(1, &_mVertexArrayObject);

    // generate the buffer and configure the gl pointers for position and normal data
    glGenBuffers(1, &_mVertexPositionNormalTriangles);
    /* Bind and set up vertex position and normal data */
    glBindBuffer(GL_ARRAY_BUFFER, _mVertexPositionNormalTriangles);
    glBufferData(GL_ARRAY_BUFFER,
                 sizeof(crVertexPN)*_mPositionNormalTriangleData->size(),
                 _mPositionNormalTriangleData->data(),
                 GL_STATIC_DRAW);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE,
                          sizeof(crVertexPN), (void*)offsetof(crVertexPN,Position));
    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE,
                          sizeof(crVertexPN), (void*)offsetof(crVertexPN,Normal));
    glEnableVertexAttribArray(GLKVertexAttribNormal);

    // generate the buffer and configure the gl pointers for color and alpha data
    glGenBuffers(1, &_mVertexColorTriangles);
    glBindBuffer(GL_ARRAY_BUFFER, _mVertexColorTriangles);
    glBufferData(GL_ARRAY_BUFFER,
                 sizeof(crVertexC)*_mColorTriangleData->size(),
                 _mColorTriangleData->data(),
                 GL_DYNAMIC_DRAW);
    glVertexAttribPointer(GLKVertexAttribColor, 4, GL_FLOAT, GL_TRUE,
                          sizeof(crVertexC), (void*)offsetof(crVertexC,Color));
    glEnableVertexAttribArray(GLKVertexAttribColor);
    glBindBuffer(GL_ARRAY_BUFFER,0);

    // generate the buffer and configure the gl pointers for triangle index data
    glGenBuffers(1, &_mVertexIndexTriangles);
    /* Bind and set up triangle index data */
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, _mVertexIndexTriangles);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(bits32)*_mIndexTriangleData->size(),_mIndexTriangleData->data(), GL_STATIC_DRAW);
    //        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER,0);

    glBindVertexArrayOES(0);
} 
```

绑定后，draw方法实现如下（这个draw方法在每个单独的顶点缓冲区对象上调用）：

```
void scene_GLBuffer::Draw()
{
    glBindVertexArrayOES(_mVertexArrayObject);

    glBindBuffer(GL_ARRAY_BUFFER, _mVertexPositionNormalTriangles);
    glDrawElements(GL_TRIANGLES, _mIndexTriangleData->size(), GL_UNSIGNED_INT, 0);
    glBindBuffer(GL_ARRAY_BUFFER, 0);

    glBindVertexArrayOES(0);
} 
```

所有这一切都很顺利，但我无法看到深度缓冲适合于此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:47:14.183

> 我无法看到深度缓冲适合于此的位置。

那是因为它*不*适合其中任何一个。

顶点数组对象是封装*顶点数组*状态的方式。此状态与当前程序对象、当前绑定的纹理或帧缓冲区等其他状态无关。最后一个是深度缓冲区的来源。

如果您想将带有 VAO 的多个对象渲染到同一个帧缓冲区，那么只需*不要更改帧缓冲区*。这就是您将它们全部渲染到同一图像的方式（为简单起见，我们将其称为屏幕）。深度缓冲区是帧缓冲区的一部分，因此如果要渲染到相同的深度缓冲区，只需不要更改不同对象之间的帧缓冲区。

简而言之，您的对象`Draw`函数不应该知道也不关心当前正在使用什么深度缓冲区。就像`Draw`函数不知道也不关心正在使用什么程序、绑定什么纹理以及当前视口是什么一样。

# php - 我已经移动了一个 WP 网站，现在我的主页是空白的

> ID：14407171
> 
> 赞同：0
> 
> 时间：2013-01-18T20:34:08.590
> 
> 标签：php, wordpress

我将我的 WordPress 网站移动到另一个服务器和 URL，现在我的主页是空白的，即使我在仪表板中预览它也是如此。

编辑：我尝试对其进行 jerryrig 操作，以便 index.html 文件将重定向到虚假主页（start.php），然后我会更改我的菜单。但是当我使用我的主页模板时，我得到了一个空白的结果，即使该页面没有设置为我的主页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:44:48.870

您的问题是插件联系表 7（我只是停用了此插件）。

Pdt：更改管理员密码。

![在此处输入图像描述](../Images/1b66dbfa8a1735ad207d80fdf254c517.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:45:22.393

这些错误日志错误可能已经存在于您的其他站点上——它们看起来不像是破坏交易的。

以下是我在移动站点遇到问题时经常尝试解决的一些问题：

*   刷新固定链接（设置->固定链接并点击保存）
*   确保您更改了 wp_options 中的 url（home 和 siteurl）
*   如果您的仪表板即将出现，这是一个好兆头。确保您的数据库已导入，并且激活了正确的主题
*   要解决问题，请开始停用插件（尝试先停用所有插件，然后逐个添加）
*   检查新服务器的 PHP（和 MySQL）版本是否与旧服务器匹配（[http://php.net/manual/en/function.phpinfo.php](http://php.net/manual/en/function.phpinfo.php)）
*   检查两台服务器上的 PHP 速记设置是否相同（曾经为我打破过一个：[http](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag) ://www.php.net/manual/en/ini.core.php#ini.short-open-tag ）
*   检查您的新服务器的 php.ini 文件是否在某种程度上与旧服务器匹配 - 可能由于不同的设置而出现问题（此选项类似于之前的建议）

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T20:43:04.680

在发送标头之前有一些东西会输出....如果您看到消息，则无法修改标头....单击浏览器的显示源并查看在第一个之前直接调用输出的内容`<br />`

```
<br /> 
<b>Warning</b>:  Cannot modify header information … in <b>…&lt;/b> on line <b>…&lt;/b><br /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T20:38:56.613

移动 wordpress 服务器的最佳方法是使用导入器。为此目的有许多导入器插件。我建议您进行全新安装，然后导入可以解决您在此过程中问题的帖子

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T20:36:25.180

您之前可能遇到过这个问题，但错误报告设置为不显示 E_NOTICE。这是默认设置，显示除 E_NOTICE 之外的所有错误

```
error_reporting(E_ALL ^ E_NOTICE); 
```

# windows - MSYS/Cygwin 中的“清理”问题

> ID：14407172
> 
> 赞同：3
> 
> 时间：2013-01-18T20:34:14.923
> 
> 标签：windows, makefile, recipe

我终于设法在 Windows 中编译了一个程序，这需要一段时间，如果没有这里的帮助，这将是不可能的。现在一切正常，除了：“make clean”产量

```
/bin/sh: del: command not found
Makefile:44: recipe for target `clean' failed
make: *** [clean] Error 127 
```

在 makefile 中，clean 命令看起来像

```
clean:
del /S *.o *~ *.out [...], eliminating all resulting .o and executables resulting from make. 
```

mingw64 在路径中，我尝试`cygwin/bin`在路径中使用和不使用，结果相同。“制作”是用`mingw32-make`in完成的`msys`。我也试过“mingw-32-make clean” `msys`，还是没有运气；我也不确定 Cygwin 是否支持“make clean”。我在 Windows 7 64 位上运行整个程序。

我该如何解决这个问题？

![错误 rm 而不是 del](../Images/243ecdee899d3dc8fb3007e4415fc6ff.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:22:51.253

看起来你正在混合你的平台。[`del`](http://ss64.com/nt/del.html)是`cmd.exe`内置的，这就是为什么 Bash 找不到它的原因。的类比`del`是[`rm`](http://ss64.com/bash/rm.html)。

尝试`make`下运行`cmd.exe`

或者

编辑 Makefile，替换`del /S`为`rm -f`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T15:42:35.893

也可以在您的项目文件夹中创建一个名为 makefile.defs 的文件，并覆盖由 eclipse 自动设置为“del”的 makefile 变量 RM。该文件包含在 [Name of Config] 文件夹中的“makefile”中

我的文件只包含：

```
RM := rm -rf 
```

这对我来说很好。

# mysql - 查找列名 SQL

> ID：14407174
> 
> 赞同：0
> 
> 时间：2013-01-18T20:34:27.730
> 
> 标签：mysql, sql, plsql, identity-column

如果可能，我想返回另一列，其中包含找到变量的列的名称`(CH1, CH2 or CH3)`。

就像是：

```
v1 => ch3

v2 => ch1 
```

这是我的查询：

```
SELECT variable
FROM Variables , Names
WHERE (Variables.ID = Names.Ch1 or  Variables.ID = Names.Ch2 or Variables.ID = Names.Ch3 ) 
```

我的表格格式：

```
Names(#ID,Ch2,Ch2,Ch3)
Variables(#ID, variable,...) 
```

我试过了，`%columName%`但我得到了一个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:41:24.793

正确的语法更像是：

```
select v.*,
       (case when v.id = n.ch1 then 'CH1'
             when v.id = n.ch2 then 'CH2'
             when v.id = n.ch3 then 'CH3'
        end) as WhichColumn
from variables v join
     names n
     on v.ID  in (n.Ch1, n.ch2, n.ch3) 
```

换句话说，您必须明确地输入列名的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:41:14.497

如果变量 ID 不仅是 INT 数字，请尝试**使用**LIKE

```
SELECT variable
FROM Variables , Names
WHERE 
(Variables.ID like '%Names.Ch1%' 
or  Variables.ID  like '%Names.Ch2%' 
or Variables.ID like '%Names.Ch3%' ) 
```

# php - 我可以使用没有 include 或 require 语句的类吗？

> ID：14407180
> 
> 赞同：2
> 
> 时间：2013-01-18T20:35:24.860
> 
> 标签：php, namespaces

我有一个 index.php：

```
<?php

include_once('X\X.php');

$y= new X\X();
$y->HelloWorld();

?> 
```

并说 index.php 在文件夹 ROOT 中，然后在 ROOT\XI 中有一个名为：X.php 的文件：

```
<?php 
namespace X;
     class X{
        public function HelloWorld(){
            echo 'Hello!';
        }
    }
?> 
```

我的问题是，这只有在我的 index.php 中有 include_('X\X.php') 时才有效。反正有没有打个招呼！不包括文件？

我正在尝试学习名称空间以及它们的实际使用方式。如果我已经包含了该文件，那么为什么还要使用命名空间呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:40:16.927

您可以使用没有包含的命名空间。这不是真的推荐，但可以做到。

给定的 PHP 文件必须是完全命名空间或根本没有命名空间。因此，如果您要在文件中包含名称空间，它必须以名称空间声明开始（即第一行代码）。

一旦你有了它，在同一个文件中进一步更改命名空间是合法的（尽管我会再说一遍，不推荐）（当然，显然在任何类或函数之外）。

我真的建议花时间学习 PHP 的 Autoload 机制，作为同一学习练习的一部分。它与命名空间很好地结合在一起，并允许您将代码拆分为每个类的单独文件（根据最佳实践建议），但无需手动包含您需要的每个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:45:52.593

了解[spl_autoload_register](http://php.net/manual/en/function.spl-autoload-register.php) () 和朋友，或者更确切地说，将 Spl 自动加载机制与`include_path`ini 指令一起学习。那是很酷的东西，会为您省去很多麻烦！:)

然而，自动加载并不神奇。它只是 Zend 引擎在访问以前未包含的用户定义类时调用的“挂钩”机制。自动加载方法的参数是类名。该方法必须将类名解析为文件名**并**使用 include 或 require (*_once) 将其包含在内。

假设在您的情况下，文件 X.php 将位于类路径中某处的文件夹 X 中，您可以像这样解析名称：

```
// define your autoloader
function the_autoloader($classname) {
    // $classname  will 'X\X' in the example
    $filename = str_replace('\\', '/', $classname) . '.php';
    require $filename;
}

// register the autoloader
spl_autoload_register('the_autoloader');

// from this point you are free to instantiate every class
// that can be resolved by the_autoloader() without writing 
// an explicit include statement

$y= new X\X();
$y->HelloWorld(); 
```

如您所见，尽管自动加载简化了类的使用并“在后台”包含文件，但仍然需要包含它们。所以问题的答案是：**您必须在使用类文件之前包含它们**

# python - 替换python中的函数指针

> ID：14407181
> 
> 赞同：9
> 
> 时间：2013-01-18T20:35:31.123
> 
> 标签：python

我从事低级 C 编程多年，但我对面向对象的方法没有足够的了解。在 C 语言中，如果我正在开发一些分层架构，那么每一层都有由函数指针定义的接口。整个层的优点可以通过在初始化时将那些函数指针设置到另一层来替换。

我想要同样的东西，但这次是在 Python 中。实现这一目标的最酷方法是什么。为了给我的问题一些背景知识，我有一个数据生成器，可以将记录输出到不同的媒体。介质是在配置时指定的。我不想在这里使用 if 或 switch 语句。最好的方法是在 C 中使用函数指针，但在 Python 中可用的选项是什么。任何面向对象的方法也值得赞赏。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-18T20:37:46.150

Python 支持函数作为一等数据类型。因此，您可以执行以下操作：

```
def foo(x):
    print("foo: " + x)

def bar(x):
    print("bar: " + x)

f = foo
f("one")
f = bar
f("ten") 
```

印刷

```
foo: one
bar: ten 
```

这与您在 C 中使用函数指针的经验非常相似。尽管 Python 确实支持更复杂的面向对象编程风格，但您没有义务使用它们。

使用类的示例，您可以将相关功能组合在一起：

```
class Dog:
    def noise(self, x):
        print("bark! " + x)
    def sleep(self):
        print("sleeping on floor")

class Cat:
    def noise(self, x):
        print("meow! " + x)
    def sleep(self):
        print("sleeping on keyboard")

a = Dog()
a.noise("hungry")
a.sleep()

a = Cat()
a.noise("hungry")
a.sleep() 
```

此版本打印：

```
bark! hungry
sleeping on floor
meow! hungry
sleeping on keyboard 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-18T20:48:25.840

您可以简单地将函数放在字典中

```
{"type1": function1,
 "type2": function2,
 "type3": function3,
}.get(config_option, defaultfunction)(parameters, go, here) 
```

`default_function`如果没有任何键匹配，则调用

如果您愿意，可以将选择和调用分开

```
selected_function = {"type1": function1,
                     "type2": function2,
                     "type3": function3,
                     }.get(config_option, defaultfunction)

some_instance = SomeClass(selected_function) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-18T20:39:36.717

在 python 中，函数是一流的数据类型。

```
def z(a):
    print(a)
def x(a):
    print "hi"

functions = [z,x]
y = functions[0]
y("ok") # prints "ok"
y = functions[1]
y("ok") # prints "hi" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-18T20:46:00.847

也许一些类似的东西：

```
class MediumA:
    def one_method(self):
        return

    def another_method(self):
        return

class MediumB:
    def one_method(self):
        return

    def another_method(self):
        return

class DataGenerator:
    # here you can read this from some configuration
    medium = MediumA()  # this will be shared between all instances of DataGenerator

    def generate(self):
        # all mediums responds to this methods
        medium.one_method()
        medium.another_method()

generator = DataGenerator()
# you can even change the medium here
generator.medium = MediumB() 
```

希望能帮助到你

# java - 最佳二维平铺方法

> ID：14407183
> 
> 赞同：0
> 
> 时间：2013-01-18T20:35:36.000
> 
> 标签：java, android, opengl-es

我对 OpenGL ES 2.0 有点困惑，我找不到有关处理 2D 平铺的正确过程的任何权威信息（或者我有但我不明白）。

言简意赅，我目前有一些基于 Canvas 的游戏（它真的没有人们说的那么糟糕，我在 1GHz CPU 上获得 30-40 之间的 FPS）并且性能很棒，但我有一些新的想法和我认为 OpenGL 是获得展示我令人眼花缭乱的特效所需的性能的唯一方法。

我有一个包含数千小时的游戏引擎，所以如果我可以避免它，我有点抗拒为了“测试”事情而进行巨大的架构更改（特别是因为我是 OpenGL 的新手并且买不起花一个月的时间获得最佳性能（时间=金钱）。

我知道纹理切换非常昂贵。并且已经有一个系统可以将纹理区域保持在单个纹理上。我还跟踪屏幕上的对象，因此只有显示场景所需的绘制调用才会发送到 GPU。

所以我在屏幕上有大量的瓷砖/瓷砖层，每帧都必须重新绘制。是否会更好：

1.  解析我的关卡文件并将每个图块转换为与其兄弟姐妹等链接的多边形（四边形），并在加载时为其创建 UV 贴图？（这将需要从将每个图块存储为矩形到跟踪相邻图块的点以便可以链接它们的架构更改）。
2.  创建一个 QUAD 并将其在屏幕周围移动到所有位置，注意渲染可以使用相同纹理在同一通道上渲染的图块。
3.  为每个图块创建一个 QUAD，然后在每个图块上调用 draw() 方法（仍然确保将纹理交换保持在最低限度或完全消失）。

要在屏幕上重新定位对象，我应该 glTranslate（我知道这会对 GPU 施加压力）还是更新保存 QUAD 坐标的 FloatBuffer 会更好？

万分感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:53:27.953

首先，如果您使用的是 OpenGL ES 2.0，则 glTranslate() 不可用；它仅在 OpenGL ES 1.X 中受支持。

性能最佳的解决方案将取决于您使用的平台。特别是，GPU 的底层图形架构（无论是即时渲染系统还是平铺渲染系统）将决定您可以在场景中避免多少次绘制调用。因为 OpenGL ES 没有四边形图元（例如，GL_QUADS，您可以在桌面 OpenGL 的兼容性配置文件中使用），您要么需要绘制一系列三角形对（每个三角形条带，每个都需要自己绘制调用），或者作为独立三角形的集合，每对三角形组成一个四边形（这种模式转换更多位置，但减少了绘制调用的数量），或者如果你可以在你的 1\. 建议中做，并跟踪所有将使用相同纹理的四边形，您可以绘制一个带有退化三角形的长三角形条（面积为零的三角形，不会被光栅化到屏幕上）。这将需要更多的几何工作，但可以减少您需要进行的纹理交换量。

最后，对于更新顶点位置缓冲区的问题，这也是一个依赖于平台的解决方案，但是，不管使用*顶点缓冲区对象*（VBO）。几乎所有移动 GPU 都将从以这种方式存储您的顶点数据中受益。

# ruby-on-rails - ruby on rails 中的协作编辑 - 架构方法？

> ID：14407189
> 
> 赞同：1
> 
> 时间：2013-01-18T20:36:02.313
> 
> 标签：ruby-on-rails, websocket, eventmachine, collaborative

在我们的应用程序中，我们正在考虑启用协作在线编辑。它是一个图形应用程序，严重依赖 JavaScript 来创建类似思维导图的结构。

第一个明显的候选者是使用 websockets。

用户来到该站点创建这些地图。我看过[em-websocket](https://github.com/igrigorik/em-websocket)似乎启动了一个自己的进程，但是

```
 EventMachine.run {

         EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 9876) do |ws| 
```

那里似乎没有太多上下文信息；人们可能同时在编辑不同的地图！所以我目前的猜测是

*   对于正在编辑的每个地图，都会在不同的端口上启动一个新的 WebSocket 服务器
*   因为这需要控制 WebSocket 生命周期，所以我想`Thread`为每个这样的`WebSocket`服务器生成一个：

    #on map create/edit: Thread.new do EventMachine.run {

    ```
     EventMachine::WebSocket.start(:host => "0.0.0.0", :port => 9876) do |ws|
           ....
       end 
    ```

人们对这种方法有何看法？这合理吗？还有其他建议吗？谢谢！

# database - Entity Framework + System.Data.SQLite 是否提供从外部侦听器/事件更改的数据库？

> ID：14407195
> 
> 赞同：0
> 
> 时间：2013-01-18T20:36:43.373
> 
> 标签：database, entity-framework, sqlite, ado.net, system.data.sqlite

当数据库比 EF 的 DbContext 更新时，有没有办法获得通知？

就我而言，我开发了一个可以安装在多台计算机上的应用程序。他们使用相同的数据库。由于这些应用程序应该运行一整天，因此一个正在更新数据而另一个应用程序实例仍在其 DbContext 中保存旧数据的可能性很高。

现在我可以每分钟左右对新数据进行一些检查。或者每次用户输入或返回应用程序时检查新数据。但是没有可用的基于事件的解决方案吗？

如果这很重要：我的数据库是 SQLite，ADO.NET 提供程序是 System.Data.SQLite（来自 SQLite 开发人员）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:41:24.853

AFAIK SQLite 没有“推送通知”机制，所以这个问题真的与 EF 无关。但是要直接回答您的问题：不。如果您使用的是 SQLServer，则可以使用与`SqlCacheDependency`您所要求的类似的东西来做一些事情，但即使是实体框架也不支持。

您有责任根据需要管理并发和更新数据。

# sql - 建立会计跟踪余额报告绩效问题

> ID：14407196
> 
> 赞同：1
> 
> 时间：2013-01-18T20:36:46.477
> 
> 标签：sql, database, oracle, date-arithmetic, accounting

假设我们有如下日记帐分录表

```
create table jour_entries 
 (jseq number, 
  j_date date, 
  Eseq number, 
  account_no varchar2(32), 
  debit number, 
  credit number,
  note varchar2(256) ); 
```

如何在 SQL 中为试算平衡构建最佳性能报告？报告栏是

*   account_number：是帐号。

*   debit_within_month：是与 account_number 相关的所有借方的总和，从给定月份的 1 日到该月月底（如果给定日期在当前月份，则到当前日期）

*   credit_within_month：是与 account_number 相关的所有信用的总和，从给定月份的 1 日到该月月底（如果给定日期是当前月份，则到当前日期）

*   debit_till_this_day：是给定日期一年内与 account_number 相关的所有借方的累计总和（从给定日期的 1 月 1 日开始到当天）。

*   credit_till_this_day：是给定日期一年内与 account_number 相关的所有信用的累计总和（从给定日期的 1 月 1 日开始到当天）。

* * *

我试过这个选择：

```
select account_number
      , debit_within_month
      , credit_within_month
      , debit_till_this_day
      , credit_till_this_day
from jour_entries j, 
    (select account_number, sum(debit) debit_within_month, 
                         sum(credit) credit_within_month
              from jour_entries 
              where j_date between trunc(given_date, 'month') and given_date
              group by account_number
    ) j1,
    (select account_number, sum(debit) debit_till_this_day,
                         sum(credit) credit_till_this_day  
              from jour_entries 
              where j_date between trunc(given_date, 'year') and given_date
              group by account_number
    ) j2
wherer j.account_number = j1.account_number
and j.account_number = j2.account_number 
```

但我正在寻找其他解决方案（也许通过使用分析函数）以获得最佳性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:24:31.297

我将使用 SQL*Plus 替换变量语法来表示 given_month。您需要为您实际使用的任何客户端更改此设置。

```
select account_number
       , sum ( case when J_date between trunc(&given_date, 'mm') 
                                    and least(sysdate, last_day(&given_date)) 
          then debit else 0 end ) as debit_within_month
       , sum ( case when J_date between trunc(&given_date, 'mm')
                                   and least(sysdate, last_day(&given_date)) 
            then credit else 0 end ) as credit_within_month
       , sum ( case when J_date between trunc(&given_date, 'yyyy') and sysdate)  
               then debit else 0 end ) as debit_til_this_day
      , sum ( case when J_date between trunc(&given_date, 'yyyy') and sysdate)  
              then credit else 0 end ) as credit_til_this_day
from jour_entries
group by account_number 
```

**解释**

*   `trunc()`应用于日期会将其截断为给定的格式掩码。所以`trunc(sysdate, 'mm')`给出了一个月的第一天，'yyyy' 掩码给出了一年的第一天。
*   `last_day()`给出，呃，给定月份的最后一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:09:50.740

如果我理解你的问题，听起来像这样的东西应该适合你：

```
SELECT JE.Account_no as Account__Number,
    SUM(JE2.debit) as Debit_Within_Month,
    SUM(JE2.credit) as Credit_Within_Month,
    SUM(JE.debit) as Debit_Till_This_Day,
    SUM(JE.credit) as Credit_Till_This_Day
FROM Jour_Entries JE
    LEFT JOIN (
        SELECT jseq, Account_No, Debit, Credit
        FROM Jour_Entries
        WHERE to_char(j_date, 'YYYY') = 2013 AND to_char(j_date, 'mm') = 2
    ) JE2 ON JE.jseq  = JE2.jseq 
WHERE to_char(j_date, 'YYYY') = 2013 
GROUP BY JE.Account_no 
```

这是[sql fiddle](http://sqlfiddle.com/#!4/f3c1c/5)。

祝你好运。

# sml - 标准 ML 中的结构比较

> ID：14407209
> 
> 赞同：2
> 
> 时间：2013-01-18T20:37:29.557
> 
> 标签：sml, ml, comparison-operators

我似乎找不到关于为什么这不起作用的参考：

```
- (2000,1)<(2000,1);    
stdIn:18.1-18.18 Error: operator and operand don't agree [overload]
  operator domain: 'Z * 'Z
  operand:         (int * int) * (int * int)
  in expression:
    (2000,1) < (2000,1) 
```

标准 ML 是否支持结构比较？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:31:56.910

简短的回答：只为了平等。

顶级环境中的严格小于运算符 (<) 与其他比较运算符一样有点“特殊”。它们是“特殊的”，因为它们（作为唯一的）重载以同时处理整数、实数等。此外，这种重载有点特别的是，如果无法推断类型，则使用整数（例如，推断出多态类型`'a`）。

对于整数的情况，`Int.<`使用该函数，它只接受两个整数作为参数

```
- Int.<;
val it = fn : int * int -> bool 
```

但是对于相等，情况有点不同，从相等运算符的类型可以看出

```
- op=;
val it = fn : ''a * ''a -> bool 
```

这里的多态类型被视为 bee `''a`，请注意双 plings。这是因为它只能实例化为相等类型（例如，int、string、int'string 等）。请注意，real 不是相等类型！

**更新**

我通常做的事情是为我创建的每个（数据）类型创建一个比较函数。这样我就可以完全控制发生的事情。比较函数的思想是返回一个[订单](http://www.standardml.org/Basis/general.html#SIG%3aGENERAL.order%3aTY)

```
datatype order = LESS | EQUAL | GREATER 
```

有了这个，您可以轻松地制作一个案例表达式并做适当的事情，而不是`if .. < .. then .. else ..`

**更新1**

下面的代码来自 Andreas Rossberg 的评论。为了便于阅读，我已将其包含在此处

```
fun comparePair compareA compareB ((a1, b1), (a2, b2)) =
    case compareA (a1, a2) of
      EQUAL => compareB (b1, b2)
    | other => other 
```

以及一些使用示例

```
- comparePair Int.compare String.compare ((2, "foo"), (3, "bar"));
val it = LESS : order
- comparePair Int.compare String.compare ((3, "bar"), (3, "bar"));
val it = EQUAL : order 
```

# checkbox - HTML 标签不显示 (Dojo 1.8)

> ID：14407210
> 
> 赞同：3
> 
> 时间：2013-01-18T20:37:39.657
> 
> 标签：checkbox, dojo, label

我正在使用 Dojo 1.8 动态创建一组复选框。创建复选框后，我还设置了复选框的标签，但该标签在网站上不可见，尽管我在 Firebug 中查看 HTML 时可以看到它。任何想法我做错了什么？在这一点上，我已经查看了太多代码，无法弄清楚它是什么。谢谢！

```
var checkboxContainer = dom.byId('divLayers');
var chkboxId = 'chk' + layer.id;
var chkbox = new dijit.form.CheckBox({
    id: chkboxId,
    checked: layer.visible,
    onClick: lang.hitch(this, this.toggleLayerVisibility)
});
chkbox.placeAt(checkboxContainer);
chkbox.domNode.appendChild(domConstruct.create('label', { 'for': chkboxId, innerHTML: layer.name })); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:46:11.050

我发誓，我可以花几个小时试图弄清楚一些事情，然后在我把它发布到网上让所有人看到的那一刻，我就解决了我自己的问题。*摇头*

解决方案如下。

```
var chkboxId = 'chk' + layer.id;
var chkbox = new dijit.form.CheckBox({
    id: chkboxId,
    checked: layer.visible,
    onClick: lang.hitch(this, this.toggleLayerVisibility)
});
chkbox.placeAt(checkboxContainer);
var lbl = domConstruct.create('label', {
    'for': chkboxId,
    'innerHTML': layer.name
});
checkboxContainer.appendChild(lbl); 
```

# excel - 年初至今累计 Excel 2010

> ID：14407212
> 
> 赞同：0
> 
> 时间：2013-01-18T20:37:43.413
> 
> 标签：excel, excel-formula, excel-2010, excel-template, vba

好的，我有一个情况我们有帐户的月度数据

```
                5 月 6 月 7 月 8 月 10 月 11 月 12 月 1 月 2 月 3 月 4 月
杰克逊厅 2 5 8
Goolrick 健身房 2 4 10 15 17
布伦特大厅 1 6

```

每个月都有自己的列。然后每个帐户都有一个年初至今的总数。

我想做的是制作一个名为 Total 的标题。在此列中，我希望它提取最新的数据条目。

我需要 Total 列来为 Jackson 提取 7 月的 8 个，Goolrick 的 10 月的 17 和 Brent Hall 的 6 月的 6。

```
全部的
8
17
6
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T23:06:26.080

假设每一列是累计总数（根据 YTD 的定义），因此从左到右严格递增，您可以使用该`Max`函数获取最右侧的列条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T23:00:41.560

根据电子表格的大小，最简单的方法之一是在最后一个条目的月份之后使用 * 之类的东西。

Jackson Hall 2 5 8 * 然后使用以下公式

=OFFSET(A2,0,MATCH("*",A2:C2,0)-1) 在你的决赛桌。

还有其他方法可以做到这一点，但会涉及反转您的表格，以便每月插入月份。Excel 从左到右工作，而不是从右到左。

同样，还有其他更复杂的方法，但这对您来说可能是最简单的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T01:55:49.433

仅使用公式选择一行中的最后一个（无论是否为升序系列，无论该系列是否包含空格）：

![SO14407212 示例](../Images/8c2a013527e023c1b813f4b1efb925a3.png)

# java - 在 Java 中使用线程

> ID：14407216
> 
> 赞同：1
> 
> 时间：2013-01-18T20:37:57.043
> 
> 标签：java, multithreading, concurrency

我有一部分代码处理线程，我想详细了解它的功能。在我的示例中，该`run`方法为空，但假设它对全局变量有一些操作：

```
import java.io.File;

public class DigestThread extends Thread {
   private File input;

   public DigestThread(File input) {
      this.input = input;
   }

   public void run() {
   }

   public static void main(String[] args) {
      for (int i = 0; i < args.length; i++) {
         File f = new File(args[i]);
         Thread t = new DigestThread(f);
         t.start();
      }
   }
} 
```

创建线程并启动它后，它会等待完成 run 方法中的任务，然后再创建/运行另一个线程吗？

第二个问题

如果变量已在`run`方法中声明，这意味着它将被声明多次，因为创建的每个线程都会在`run`方法中执行任务，是否每个线程都处理自己的变量，尽管每个线程中的变量是相同的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T20:42:37.110

> 它会等待完成 run 方法中的任务来创建另一个方法吗？

不，这就是`Multithreading`. 每个线程都有自己的执行堆栈。因此，当您启动一个线程时，它会进入`run()`方法，并在不同的堆栈中执行它，同时`main`线程继续执行，在它自己的堆栈中。

之后，`main`线程可以产生另一个线程。因此，所有线程同时运行，但当然，一次一个，根据所使用的特定 CPU 分配算法在它们之间共享 CPU。

多线程的执行过程，这里不可能一一写下。我宁愿建议阅读一些教程或搜索一些在线资源，关于`Multithreading`. 一旦概念清晰，继续实施`Java`。

以下是您可以开始使用的一些教程链接：-

*   [线程维基页面](http://en.wikipedia.org/wiki/Thread_%28computing%29)
*   [SO 多线程 Wiki 页面](https://stackoverflow.com/tags/multithreading/info)
*   [并发 - Oracle 教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/)
*   [http://www.vogella.com/articles/JavaConcurrency/article.html](http://www.vogella.com/articles/JavaConcurrency/article.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:42:26.670

一旦你启动了一个线程，它将在一个单独的线程中运行并且 main() 线程将继续（它可能在子线程结束之前结束）。

如果您希望线程在 main 之前完成，那么您可以使用线程上的[Thread.join](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#join%28%29)方法来等待它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-09T13:19:16.463

首先，线程是程序中的单一顺序控制流。我们可以在一个程序中执行多个线程，但是有一个生命周期，您可以在其中了解线程是如何工作的......![在此处输入图像描述](../Images/321eec63fca812d3b9aae718be8f9605.png)

每当我们调用`start()`Thread 的方法时，它会自动调用被覆盖的方法`public void run()`并执行该`run()`方法的代码......

这是一个简单的 Java 线程示例，带有 ABC 和 XYZ 线程类

```
/* Write a program to print having two Thread Class 1) ABC with 1 second  2) XYZ 2 second. 10 times with Extend Constructor */
class ABCThreadConstructor extends Thread {
    ABCThreadConstructor(String name) {
        super(name);
    }
    public void run() {
        try {
            for(int i = 0; i < 10; i++) {
                System.out.println("ABC");
                Thread.sleep(1000);
            }
        } catch(InterruptedException ie) {
            System.out.println("Interrupted Exception : "+ie);
        }
    }
}

class XYZThreadConstructor extends Thread {
    XYZThreadConstructor(String name) {
        super(name);
    }
    public void run() {
        try{
            for(int i = 0; i < 10; i++) {
                System.out.println("XYZ");
                Thread.sleep(2000);
            }
        } catch(InterruptedException ie) {
            System.out.println("Interrupted Exception : "+ie);
        }
    }
}

class AbcXyzThreadConstructorDemo {
    public static void main(String args[]) {
        ABCThreadConstructor atc = new ABCThreadConstructor("ABCThreadConstructor");
        System.out.println("Thread Name : " + atc.getName());
        atc.start();
        XYZThreadConstructor xtc = new XYZThreadConstructor("XYZThreadConstructor");
        System.out.println("Thread Name : " + xtc.getName());
        xtc.start();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T20:43:22.257

假设您的问题是“在创建线程并启动它之后，程序会在创建另一个线程之前等待线程完成其运行方法吗？”

如果是这种情况，*否*程序将不会等待。`t.start()`启动线程并获得自己的内存块和线程优先级来运行。它将执行其操作，然后相应地存在。您的主线程将`args`在终止之前启动指定的线程数。

如果您需要应用程序在线程上等待，请使用`t.join()`. 这样，父线程（运行的线程`main`）将加入子线程并阻塞，直到其操作完成。在这种情况下，它有点违背了线程的目的，但是您可以将线程 ID 存储为您需要的任何逻辑，然后再加入（）。

# clojure - 在 Clojure 中使用 WSDL

> ID：14407218
> 
> 赞同：7
> 
> 时间：2013-01-18T20:38:08.057
> 
> 标签：clojure, wsdl

我需要使用 WSDL Web 服务，而到目前为止我看到的 Java 客户端代码看起来臃肿而复杂。我想知道 Clojure 中是否存在更简洁的解决方案，以便我可以在 Clojure 中实现该部分并向 Java 代码公开一个更简单的 API。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T01:23:27.680

```
cd your_project_dir/src
wsimport -p some.import.ns http://.../service?wsdl 
```

它会创建`./some.import.ns/*.class`. 所以你可以`use`在你的clojure项目中只使用它们

```
(ns your.ns ...
  (:import [some.import.ns some_WS_Service ...]))

(let [port (-> (some_WS_Service.) 
               .getSome_WS_ServicePort]
  (... (.someMethod port) ...)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-07T10:29:34.947

查看 paos：[https ://github.com/xapix-io/paos](https://github.com/xapix-io/paos)

> 轻量级且易于使用的库，用于从 WSDL 文件构建 SOAP 客户端。

```
(require '[clj-http.client :as client])
(require '[paos.service :as service])
(require '[paos.wsdl :as wsdl])

(defn parse-response [{:keys [status body] :as response} body-parser fail-parser]
  (assoc response
         :body
         (case status
           200 (body-parser body)
           500 (fail-parser body))))

(let [soap-service   (wsdl/parse "http://www.thomas-bayer.com/axis2/services/BLZService?wsdl")
      srv            (get-in soap-service ["BLZServiceSOAP11Binding" :operations "getBank"])
      soap-url       (get-in soap-service ["BLZServiceSOAP11Binding" :url])
      soap-headers   (service/soap-headers srv)
      content-type   (service/content-type srv)
      mapping        (service/request-mapping srv)
      context        (assoc-in mapping ["Envelope" "Body" "getBank" "blz" :__value] "28350000")
      body           (service/wrap-body srv context)
      resp-parser    (partial service/parse-response srv)
      fault-parser   (partial service/parse-fault srv)]
  (-> soap-url
      (client/post {:content-type content-type
                    :body         body
                    :headers      (merge {} soap-headers)
                    :do-not-throw true})
      (parse-response resp-parser fault-parser))) 
```

# c++ - Boost ASIO TCP 消息分离

> ID：14407223
> 
> 赞同：3
> 
> 时间：2013-01-18T20:38:16.007
> 
> 标签：c++, tcp, boost-asio

我刚开始使用 Boost ASIO 库，版本 1.52.0。我正在使用带有异步套接字的 TCP/SSL 加密。从这里提出的关于 ASIO 的其他问题来看，似乎 ASIO 不支持接收可变长度消息，然后将该消息的数据传递给处理程序。

我猜 ASIO 将数据放入一个循环缓冲区并丢失了每条单独消息的所有跟踪。如果我遗漏了什么并且 ASIO 确实提供了一种传递个人消息的方法，那么请告知如何传递。

我的问题是，假设我无法以某种方式仅获取与单个消息关联的字节，我是否可以在 async_read 中使用 transfer_exactly 来仅获取前 4 个字节，我们的协议总是放置消息的长度。然后调用 read 或 async_read （如果 read 不适用于异步套接字）来读取消息的其余部分？这行得通吗？有什么更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:16:19.120

通常，我喜欢将我在 async_read 中收到的数据放入 boost::circular_buffer 中，然后让我的消息解析器层决定消息何时完成并将数据拉出。 [http://www.boost.org/doc/libs/1_52_0/libs/circular_buffer/doc/circular_buffer.html](http://www.boost.org/doc/libs/1_52_0/libs/circular_buffer/doc/circular_buffer.html)

下面的部分代码片段

```
boost::circular_buffer TCPSessionThread::m_CircularBuffer(BUFFSIZE);

void TCPSessionThread::handle_read(const boost::system::error_code& e, std::size_t bytes_transferred)
{
    // ignore aborts - they are a result of our actions like stopping
    if (e == boost::asio::error::operation_aborted)
        return;
    if (e == boost::asio::error::eof)
    {
        m_SerialPort.close();
        m_IoService.stop();
        return;
    }
    // if there is not room in the circular buffer to hold the new data then warn of overflow error
    if (m_CircularBuffer.reserve() < bytes)
    {
        ERROR_OCCURRED("Buffer Overflow");
        m_CircularBuffer.clear();
    }
    // now place the new data in the circular buffer (overwrite old data if needed)
    // note: that if data copying is too expensive you could read directly into
    // the circular buffer with a little extra effor
    m_CircularBuffer.insert(m_CircularBuffer.end(), pData, pData + bytes);
    boost::shared_ptr<MessageParser> pParser = m_pParser.lock(); // lock the weak pointer
    if ((pParser) && (bytes_transferred)) 
        pParser->HandleInboundPacket(m_CircularBuffer); // takes a reference so that the parser can consume data from the circ buf
    // start the next read
    m_Socket.async_read_some(boost::asio::buffer(*m_pBuffer), boost::bind(&TCPSessionThread::handle_read, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred));
} 
```

# twitter-bootstrap - 如何打破引导网格

> ID：14407225
> 
> 赞同：1
> 
> 时间：2013-01-18T20:38:16.423
> 
> 标签：twitter-bootstrap, break

像所有其他关于此的问题一样，bootstrap 将我的广告按钮放在另一个广告按钮和排行榜下方的第二行。它只发生在桌面视图的某些宽度之间。所以我想做的是让左右两边的广告按钮从引导网格中伸出，这样它们就不会与侧边栏或网站的其余部分内联。这是它的[链接](http://tsn.thesn.net:8080/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T00:33:32.470

如果我正确理解您的问题，您希望绿色导航栏下方的行比引导网格宽。

这很容易做到。您需要在将更宽​​的行之前关闭引导容器，为此扩展行创建并关闭一个新的 div，然后为页面的其余部分打开一个新的引导容器。所以基本结构是这样的：

```
<div class="container>
   <header> .... </header>
   <div class="navbar"> .... </div> <!-- close navbar -->
</div><!-- close container -->

<div class="wideRow"> .... </div> <!-- close wideRow -->

<div class="container>
<!-- remainder of page -->
</div> <!-- close container --> 
```

在此处查看[实时示例](http://jsfiddle.net/panchroma/E5zny/)

仅供参考，您的某些 div 也可能存在问题，要么没有关闭，要么没有正确嵌套。如果您[验证页面](http://bit.ly/Xlm7wn)，它会显示一些 div 问题，并且如果我查看您页面的源代码，您正在打开容器 div @ line 90 和 217，但它们似乎没有正确关闭。

无论如何，希望这能为您指明正确的方向:)

# c# - 如何从左下角到右上角将字符串绘制到图像

> ID：14407226
> 
> 赞同：1
> 
> 时间：2013-01-18T20:38:19.523
> 
> 标签：c#, asp.net, graphics, system.drawing

这是我的代码：

```
 Graphics g = Graphics.FromImage(newImage);

  var myBrush = new SolidBrush(Color.FromArgb(32, 205, 205, 205));
   g.DrawString(label, new Font("verdana", 10, GraphicsUnit.Pixel), myBrush, 10,10); 
```

将字符串放在图像上效果不佳。这段代码可以写得很好，但我不能把字符串从左下角放到右上角。你有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:57:51.417

```
g.RotateTransform(45f); 
```

只有在那之后

```
g.DrawString(label, new Font("verdana", 10, GraphicsUnit.Pixel), myBrush, 10,10); 
```

但这只会旋转 45 度。根据可以使用`MeasureString`方法计算的按钮大小和文本长度，您需要调整文本的角度和位置。我希望你喜欢几何。

[http://msdn.microsoft.com/en-us/library/system.drawing.graphics.rotatetransform(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.rotatetransform(v=vs.100).aspx)

为了移动绘制字符串的位置，您需要使用图形对象的 TranslateTransform(dx,dy) 方法。

[http://msdn.microsoft.com/en-us/library/6a1d65f4(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/6a1d65f4(v=vs.100).aspx)

因此，要在中心绘制字符串，您可以调用 translate 然后旋转然后绘制。如果这不起作用，请尝试更改旋转和平移的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:54:44.827

如果您找到对角线的图像（应该不难），只需将 Button 的背景图像属性设置为图像。它的代码类似于：

`button1.BackgroundImage = ((System.Drawing.Image)(Properties.Resources.img2));`

我相信可以设置一些属性来拉伸图像和东西，以防它没有正确排列。

# bash - bash：在 if 语句中使用 grep，防止回显

> ID：14407229
> 
> 赞同：1
> 
> 时间：2013-01-18T20:38:33.527
> 
> 标签：bash, if-statement, grep

我有这个 bash 脚本：

```
#!/bin/bash

external_output="Oliver's AirPort Express"

if ~/.bin/audiodevice | grep "$external_output"
then
  ~/.bin/audiodevice output "Internal Speakers"
  echo "Internal Speakers"
else
  ~/.bin/audiodevice output "$external_output"
  echo "Oliver's AirPort Express"
fi 
```

如果`grep`匹配，那么它当然会回显匹配。当我在 if 语句中使用它时，我不希望它回显。

我如何`grep`在我的`if`语句中使用它而不在我运行脚本时向我宣布结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T20:41:40.910

你想`grep -q "$external_output"`抑制输出。来自`man grep`：

> -q，--安静，--静音
> 
> 安静的; 不要向标准输出写入任何内容。如果找到任何匹配项，则立即以零状态退出，即使检测到错误（-q 由 POSIX 指定）。

# java - 使用 PDFBox 复制 pdf 可以像使用 iText 一样小吗？

> ID：14407231
> 
> 赞同：1
> 
> 时间：2013-01-18T20:38:43.073
> 
> 标签：java, itext, pdfbox

我正在阅读 PDF 并输出包含多个原始 PDF 副本的 PDF。[我通过对PDFBox](http://pdfbox.apache.org/index.html)和[iText](http://itextpdf.com/)做同样的事情来进行测试。如果我单独复制每个页面，iText 创建的输出要小得多。

**问题：**在 PDFBox 中是否有另一种方法可以产生更小的输出 PDF。

对于一个示例输入文件，使用两种工具生成输出的两个副本：

*   原始 PDF 大小：30K
*   PDFBox (v 1.7.1) 生成的 PDF：84K
*   iText (v 5.3.4) 生成的 PDF：35K

PDFBox 的 Java 代码（抱歉给您造成错误处理）。请注意它如何一遍又一遍地读取输入并将其作为一个整体进行复制：

```
PDFMergerUtility merger = new PDFMergerUtility();
PDDocument workplace = null;
try {
    for (int cnt = 0; cnt < COPIES; ++cnt) {
        PDDocument document = null;
        InputStream stream = null;
        try {
            stream = new FileInputStream(new File(sourceFileName));
            document = PDDocument.load(stream);
            if (workplace == null) {
                workplace = document;
            } else {
                merger.appendDocument(workplace, document);
            }
        } finally {
            if (document != null && document != workplace) {
                document.close();
            }
            if (stream != null) {
                stream.close();
            }
        }
    }

    OutputStream out = null;
    try {
        out = new FileOutputStream(new File(destinationFileName));
        workplace.save(out);
    } finally {
        if (out != null) {
            out.close();
        }
    }
} catch (COSVisitorException e1) {
    e1.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} finally {
    if (workplace != null) {
        try {
            workplace.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

使用 iText 执行此操作的代码。注意它是如何逐页加载输入文件并将每一页传输到输出的：

```
Document document = null;
PdfReader reader = null;
InputStream inputStream = null;
FileOutputStream outputStream = null;
try {
    inputStream = new FileInputStream(new File(sourceFileName));
    outputStream = new FileOutputStream(new File(destinationFileName));
    document = new Document();
    PdfCopy copy = new PdfSmartCopy(document, outputStream);
    document.open();
    reader = new PdfReader(inputStream);
    // loop over the pages in that document
    int pdfPageNo = reader.getNumberOfPages();
    for (int page = 0; page < pdfPageNo;) {
        PdfImportedPage onePage = copy.getImportedPage(reader, ++page);
        // duplicate each page N times
        for (int i = 0; i < COPIES; ++i) {
            copy.addPage(onePage);
        }
    }
    copy.freeReader(reader);
} catch (DocumentException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} finally {
    if (reader != null) {
        reader.close();
    }
    if (document != null) {
        document.close();
    }
    try {
        if (inputStream != null) {
            inputStream.close();
        }
        if (outputStream != null) {
            outputStream.close();
        }
    } catch (IOException e) {
        // do nothing
    }
} 
```

两者都被这个包围：

```
public class Duplicate {

    /** The original PDF file */
    private static final String sourceFileName = "PDF_CI_US2CA.pdf";

    /** The resulting PDF file. */
    private static final String destinationFileName = "itext_output.pdf";
    private static final int COPIES = 2;

    public static void main(String[] args) {
            ...
        }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-27T20:48:00.537

使用以下解决方案，我能够创建包含许多重复页面的 PDF 文件，并且对存储的影响最小。

```
PDDocument samplePdf = null;
try {
    samplePdf = PDDocument.load(PDF_PATH);
    PDPage page = (PDPage) samplePdf.getDocumentCatalog().getAllPages().get(0); 

    for(int i = 0; i < COPIES; i++) {
        samplePdf.importPage(page);
    }

    samplePdf.save(SAVE_PATH); //$NON-NLS-1$

} catch (IOException e) {
    e.printStackTrace();
} catch (COSVisitorException e) {
    e.printStackTrace();
} 
```

在我的第一次尝试中，我使用了，`samplePdf.addPage(page)`但它没有按预期工作。`add`所以很明显和`import`函数是有区别的。我将不得不检查源代码或文档以了解原因。无论如何，这应该可以帮助您使用 PDFBox 为您的需求设计解决方案。

# html - 如何改变 td 宽度？

> ID：14407234
> 
> 赞同：0
> 
> 时间：2013-01-18T20:38:47.837
> 
> 标签：html, css, html-table

[http://serafimtsotsonis.com/dates.html](http://serafimtsotsonis.com/dates.html)

在此页面链接中，我想更改第一行，以便将整个句子拉长，并且“Serafim bla bla bla”不占用 3 行。这是因为我有 33% 的宽度限制。

我能做些什么，只在那一行改变那句话，只占一行，像其他人一样下来？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:43:36.457

使用 nowrap 属性

```
<td nowrap="nowrap"> 
```

或使用 css（更好，因为 nowrap 属性在 html 4.01 中已弃用并且在 html5 中不存在）

```
<td style="white-space: nowrap"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:46:25.620

您可以删除第一行中的空 middel td，并将​​该行中的最后一个 td 设置为 colspan 2。像这样：

```
<table cellspacing="0">
  <tbody>
    <tr class="line">
      <td>20_January 2013 </td>
      <td colspan="2" style="padding-left: 10px; ">
                    Serafim Tsotsonis mixtape 24 :00 - 01 :00 @ <a href="http://www.dinamo.fm/" target="_blank">dinamo.fm</a></td>
    </tr>

    <tr class="line">
      <td>11_January 2013 </td>
      <td></td>
      <td style="padding-left: 10px;"><a href="https://www.facebook.com/events/565108543517894/567425516619530/" target="_blank">Sporos Bar, Athens</a></td>
   </tr>
   ... 
```

或者这不是你想要达到的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T08:35:55.993

```
I think you can use the <colgroup>tag
<colgroup>
<col width="total width of the first column" />
<col width="*" />
</colgroup> 
```

注意：如果列的宽度很宽，请使用此选项

# javascript - Jquery/JS 引用单个单元格内容

> ID：14407237
> 
> 赞同：0
> 
> 时间：2013-01-18T20:39:01.560
> 
> 标签：javascript, jquery

我认为我的脚本非常接近，但我似乎无法返回任何东西。

我在一个表中有两列，我想在其中找到一个字符串，然后向下阅读该行以查找另一列的内容。

我已经给了两列单独的类名，这是我的脚本：

```
if ($("td.cellONE:contains('STRING')")) {
        var OutputCell = $(this).parents("tr").find(".cellONEa");
       console.log($(this).text());
       console.log(OutputCell.text());
      }
else {console.log("no");}
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:42:03.680

`this`在您的代码中引用`window`对象，您可以使用`each`方法。

```
$(function(){
    $("td.cellONE:contains('STRING')").each(function(){
        var OutputCell = $(this).closest("tr").find(".cellONEa");        
        console.log($(this).text());
        console.log(OutputCell.text());
    });
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:40:10.193

`$("td.cellONE:contains('STRING')")`即使 jQuery 集为空，在测试中也不会评估为假。

你可能想要

```
if ($("td.cellONE:contains('STRING')").length) { 
```

`this`在这种情况下没有用处。

编辑：事实上，您可能只需要 undefined 的建议。

# vb.net - 使用适用于 Windows 的 VB .NET 应用程序打包 gnuplot

> ID：14407239
> 
> 赞同：0
> 
> 时间：2013-01-18T20:39:17.837
> 
> 标签：vb.net, visual-studio, powerpoint, gnuplot

我正在尝试对涉及基于 Microsoft Access 数据库创建自动 PowerPoint 报告的项目进行估算。这是我已经为客户完成的项目的扩展，主要区别在于他希望在新报告中包含两个图表（基于数据库中的数据）。

如果我在 *nix 上执行此操作，我只需将数据通过管道传输到 gnuplot，保存图像，然后以编程方式将图像放入 PowerPoint。**有什么方法可以轻松地将 gnuplot 打包到 Visual Studio 项目中，这样客户端就不必进行任何其他类型的安装？**

如果没有，或者这将比它的价值更麻烦，我会很感激其他方法的任何想法。使用原生 PowerPoint 图表是否合理——即它们所基于的数据是否可以通过编程方式轻松访问？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:13:46.290

有几种方法可以使用通常作为 MS Office 的一部分安装的内容。您选择哪个在某种程度上取决于您正在编写的 Office 版本。

鉴于大多数客户对与 Excel/PPT 等提供的默认图表不匹配的图表有非常具体的要求，您要么需要插入一个图表，然后在程序控制下进行所有格式化，要么我的偏好是存储 pre - 单独的 PPT/PPTX 文件或文件中的格式化样本图表。您可以不可见地打开它，根据需要将图表复制/粘贴到当前幻灯片中，然后以编程方式修改数据。

这样做的一大优势是您（或客户，如果您选择让他们参与其中）可以快速轻松地更改格式，而无需更改一行代码。

回到你最初的问题，原生 PPT 图表中的数据很容易访问。一个快速的 VBA 示例：

```
Sub FiddleTheChartData()

Dim oSh As Shape
Dim oCht As Chart
Dim oChtData As ChartData
Dim x As Long

' For purposes of example, assume that we've got a chart in PPT
' and that it's selected:
Set oSh = ActiveWindow.Selection.ShapeRange(1)
' We could as easily pass a reference to the shape to this routine as a param

' Sanity test; if it's not a chart, bug out
If Not oSh.HasChart Then
    Exit Sub
Else
    Set oCht = oSh.Chart
    Set oChtData = oCht.ChartData
End If

With oChtData
    .Activate
    .Workbook.Worksheets("Sheet1").Cells(3, 3) = 42
End With

' This leaves the workbook open in Excel, so:
oChtData.Workbook.Close

' Might want to iterate through the Workbook.Parent's worksheets and
' if there are more than one, decide whether or not to close them and dismiss
' Excel or not

End Sub 
```

# javascript - 如何使 SVG 图像图案填充随对象移动？

> ID：14407240
> 
> 赞同：7
> 
> 时间：2013-01-18T20:39:20.220
> 
> 标签：javascript, svg

我有一些使用 平铺图像背景的 SVG 对象`fill="url(#background)`，我将其定义`#background`为`pattern`仅包含`image`.

但是，当对象通过设置其`x`/`y`属性（或`cx`/`cy`或任何其他定义偏移量）重新定位时，背景不会随之移动。

如何使背景也移动？从我将如何使用我尝试设置的[元素移动 SVG 模式，](https://stackoverflow.com/questions/10359659/how-would-i-move-an-svg-pattern-with-an-element)`patternContentUnits='objectBoundingBox'`但这只是将图像变成纯色斑点（奇怪的是，根据图像着色，就好像它只是第一个像素或类似的东西） .

这是一个说明所有这些的 jsfiddle - 顶部`rect`已变成纯色，然后底部`rect`有背景图像，但它不会随`rect`:

[http://jsfiddle.net/x8nkz/17/](http://jsfiddle.net/x8nkz/17/)

我知道，如果您使用而*不是*`transform="translate(...)"`设置`x`/`y`属性，背景也会被翻译，但我正在使用的现有代码库不使用 translate 进行定位（并且它会对其余部分产生其他意想不到的后果应用程序）。

 *提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-30T06:11:38.973

我实际上遇到了同样的问题并找到了解决方案。我已经分叉了你的小提琴来展示这些变化。基本上，您删除了 patternContentUnits 属性，因为它在这里没有帮助，并在每次更新后更新图像的 x 属性以匹配 rect 对象的属性。

[http://jsfiddle.net/RteBM/2/](http://jsfiddle.net/RteBM/2/)

更新的 HTML：

```
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="100%" height="100%">
<title>basic pattern</title>
<defs>
    <pattern id="pat1" width="179" height="132" patternUnits="userSpaceOnUse">
         <image x="0" y="0" width="179" height="132" xlink:href="http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/honey_im_subtle.png"></image>
    </pattern>
    <pattern id="pat2" width="179" height="132" patternUnits="userSpaceOnUse">
        <image x="0" y="0" width="179" height="132" xlink:href="http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/honey_im_subtle.png"></image>
    </pattern>
</defs>
<rect id="rect1" x="0" y="0" width="179" height="132" fill="url(#pat1)"/>
<rect id="rect2" x="0" y="150" width="179" height="132" fill="url(#pat2)"/>
</svg> 
```

更新的 JS：

```
var i = 0;
var newX;
setInterval(
    function(){
        $('rect').attr('x', Math.sin(i+=.01)*100+100);      
        $('#pat1').attr('x', $("#rect1").attr('x'));
    }, 100); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:03:24.063

如果您使用 objectBoundingBox 单位，则宽度为 1（或 100%）是对象的宽度，因此 178 将是该宽度的 178 倍。你可能想要

```
<pattern id="pat1" width="179" height="132" patternUnits="userSpaceOnUse" patternContentUnits="objectBoundingBox">
    <image width="1" height="1" xlink:href="http://subtlepatterns.subtlepatterns.netdna-cdn.com/patterns/honey_im_subtle.png"></image>
</pattern> 
```

但这不会使模式移动。你将需要某种转换来做到这一点。如果你不能把它放在上面，`<rect>`也许你可以让 rect 成为一个元素的子`<g>`元素并转换`<g>`元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T08:03:17.280

尝试将 patternUnits 的值设置为“objectBoundingBox”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-28T15:47:25.147

使用“嵌套 SVG 文档”对可拖动元素进行分组

模式位置相对于第一个父 SVG 文档

[在这里摆弄](http://jsfiddle.net/59qtm1cn/4/)

```
<html>

<!-- svg.js + svg.draggable.js -->
<script type="text/javascript"
src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@latest/dist/svg.min.js"></script>
<script type="text/javascript"
src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.draggable.js@latest/dist/svg.draggable.min.js"></script>

<div id="canvas"></div>

<script type="text/javascript">

// create canvas
var draw = SVG().size(200, 200).addTo('#canvas')

// pattern of checkerboard
var patt = draw.pattern(20, 20)
patt.rect(20, 20).fill({color: '#fff'})
patt.rect(10, 10)
patt.rect(10, 10).move(10, 10)

// nested svg document
var nested = draw.nested()

// rect + pattern
nested.rect(80, 80).attr({
    fill: patt
})

// drag on
nested.draggable()

/*
// this works too, but its slow:

// group + draggable
var group = draw.group().draggable()

// move handler
group.on('dragmove', (e) => {
  const {x, y} = e.detail.box
  patt.move(x, y)
})

// rect with pattern
var r = group.rect(80, 80).attr({
    fill: patt
})
*/

</script>
</html> 
```*

# asp.net - HttpHandler 生成的内容（axd 文件 - 捆绑 css/js）给出 404 错误。使用梳子

> ID：14407242
> 
> 赞同：5
> 
> 时间：2013-01-18T20:39:34.890
> 
> 标签：asp.net, iis, web-config, httphandler, combres

我想捆绑和缩小我的 JS/CSS 文件。为此，我正在[使用 Combres](https://github.com/buunguyen/combres)。

我已经在我的本地环境中设置了 Combres 解决方案，它在那里工作。但是，当我将应用程序部署到 IIS 时，它不起作用。嗯。我尝试访问的网址是[http://www.mysite.com/combres.axd/siteJs/-1639413070/](http://www.mysite.com/combres.axd/siteJs/-1639413070/)。

我收到 IIS 404 错误：*404 - File or directory not found*。

**这是我的设置。**

网络配置：

```
<?xml version="1.0"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
  <section name="dotless" type="dotless.Core.configuration.DotlessConfigurationSectionHandler, dotless.Core" />
    <section name="combres" type="Combres.ConfigSectionSetting, Combres, Version=2.2, Culture=neutral, PublicKeyToken=1ca6b37997dd7536" />
  </configSections>
  <appSettings>
    <add key="ChartImageHandler" value="storage=session;timeout=20;"/>
        <add key="CombresSectionName" value="combres" />
  </appSettings>

  <system.web>
    <httpModules>
      <add name="MinifyHtml" type="GKBusiness.HtmlMinifier.MinifyHtmlClass,GKBusiness"/>
    </httpModules>
    <globalization culture="da-DK" uiCulture="da-DK"/>
    <httpHandlers>
        <add path="ChartImg.axd" verb="GET,HEAD,POST" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" validate="false"/>
        <add path="*.less" verb="GET" type="dotless.Core.LessCssHttpHandler, dotless.Core" />

    </httpHandlers>
    <pages controlRenderingCompatibilityVersion="4.0" enableViewState="true">
      <controls>
        <add tagPrefix="asp" namespace="System.Web.UI.DataVisualization.Charting" assembly="System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
      </controls>
      <namespaces>
        <add namespace="Combres"/>
      </namespaces>
    </pages>
    <compilation debug="false" targetFramework="4.5">
      <assemblies>
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Web.Extensions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="Microsoft.Web.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      </assemblies>
    </compilation>

    <httpRuntime requestValidationMode="2.0"/>

  </system.web>
  <system.webServer>
    <httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
      <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll"/>
      <dynamicTypes>
        <add mimeType="text/*" enabled="true"/>
        <add mimeType="message/*" enabled="true"/>
        <add mimeType="application/javascript" enabled="true"/>
        <add mimeType="*/*" enabled="false"/>
      </dynamicTypes>
      <staticTypes>
        <add mimeType="text/*" enabled="true"/>
        <add mimeType="message/*" enabled="true"/>
        <add mimeType="application/javascript" enabled="true"/>
        <add mimeType="*/*" enabled="false"/>
      </staticTypes>
    </httpCompression>
    <urlCompression doStaticCompression="true" doDynamicCompression="true"/>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="MinifyHtml" type="GKBusiness.HtmlMinifier.MinifyHtmlClass,GKBusiness"/>
    </modules>
    <validation validateIntegratedModeConfiguration="false"/>
    <handlers>
      <remove name="ChartImageHandler"/>
      <add name="AjaxToolkit" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
      <add name="ChartImageHandler" preCondition="integratedMode" verb="GET,HEAD,POST" path="ChartImg.axd" type="System.Web.UI.DataVisualization.Charting.ChartHttpHandler, System.Web.DataVisualization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
    <add name="dotless" path="*.less" verb="GET" type="dotless.Core.LessCssHttpHandler,dotless.Core" resourceType="File" preCondition="" />
    </handlers>

  <log4net>
    <appender name="File" type="log4net.Appender.RollingFileAppender">
      <file type="log4net.Util.PatternString" value="Logs\\log_%date{yyyyMMdd}.txt"/>
      <appendToFile value="true"/>
      <rollingStyle value="Date"/>
      <datePattern value="yyyyMMdd"/>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline"/>
      </layout>
      <filter type="log4net.Filter.LevelRangeFilter">
        <param name="LevelMin" value="INFO"/>
        <param name="LevelMax" value="OFF"/>
      </filter>
    </appender>
    <logger name="File">
      <level value="All"/>
      <appender-ref ref="File"/>
    </logger>
    <root>
      <level value="ALL"/>
      <appender-ref ref="File"/>
    </root>
  </log4net>

    <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Fasterflect" publicKeyToken="38d18473284c1ca7" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-2.1.2.0" newVersion="2.1.2.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="AjaxMin" publicKeyToken="21ef50ce11b5d80f" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-4.48.4489.28432" newVersion="4.48.4489.28432" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <dotless minifyCss="false" cache="true" web="false" />
  <combres definitionUrl="~/App_Data/combres.xml" />
</configuration> 
```

Combres.xml：

```
<combres xmlns='urn:combres'>
  <filters>
    <filter type="Combres.Filters.FixUrlsInCssFilter, Combres" />
  </filters>
  <resourceSets url="~/combres.axd"
                defaultDuration="30"
                defaultVersion="auto"
                defaultDebugEnabled="auto"
                defaultIgnorePipelineWhenDebug="true"
                localChangeMonitorInterval="30"
                remoteChangeMonitorInterval="60"
                >
    <resourceSet name="siteCss" type="css">
      <resource path="~/Resources/Plugins/bootstrap.min.css" />
      <resource path="~/Resources/Plugins/bootstrap-responsive.min.css" />
      <resource path="~/Resources/Styles/jquery-ui.css" />
      <resource path="~/Resources/Styles/screen.css" />

    </resourceSet>
    <resourceSet name="siteJs" type="js">
      <resource path="~/Resources/Plugins/bootstrap.min.js" />
      <resource path="~/Resources/Plugins/TagIt/js/tag-it.js" />
    </resourceSet>
  </resourceSets>
</combres> 
```

呈现的 HTML：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/combres.axd/siteCss/-489484553/"/><script type="text/javascript" src="/combres.axd/siteJs/-1639413070/"></script> 
```

当我输入一个链接时，比如[http://www.mysite.com/combres.axd/siteJs/-1639413070/](http://www.mysite.com/combres.axd/siteJs/-1639413070/)，它会给出 IIS 404 错误。

我可以通过将“defaultDebugEnabled”设置为 false 来运行它，但是当然，它不起作用。

我已确保 NetworkService / IISuser 对我的文件夹具有完全访问权限。

任何想法为什么我的处理程序会摔倒？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T10:51:06.940

我有同样的问题。但我通过添加来修复它

```
<add name="RoutingModule" type="System.Web.Routing.UrlRoutingModule, System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/> 
```

到 system.webserver\modules ，和

```
<add name="UrlRoutingHandler" path="UrlRouting.axd"  type="System.Web.HttpForbiddenHandler, System.Web, Version=2.0.0.0, Culture=neutral,  PublicKeyToken=b03f5f7f11d50a3a" verb="*"/> 
```

到我的 web.config 中的 System.webserver\handlers

这为我完成了工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T14:29:45.030

我想我想通了。当我从开发到生产时遇到了同样的问题。

我将路由模块添加到 system.web\httpModules 列表中。这使我的解决方案起作用。

# ruby-on-rails-3 - 正则表达式匹配 mongoid 条件

> ID：14407244
> 
> 赞同：1
> 
> 时间：2013-01-18T20:39:40.057
> 
> 标签：ruby-on-rails-3, mongoid

我有 item[:name] 并且我希望能够使用

```
(item[:name].scan(/[a-z0-9\s]/i).join rescue "") =~ Regexp.new(business.scan(/[a-z0-9\s]/i).join, true) 
```

作为 mongoid 中的一个条件。有没有办法做到这一点？我想出的唯一解决方案是获取所有项目，然后迭代该数组，在那个时间点执行正则表达式。

这样做的目的是在网站搜索“Johns”时找到“John's”，反之亦然。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T16:37:28.737

这是我最终使用的。

```
def self.find_by_name_or_organization(business = nil)
  businesses = self.all(:order => "name ASC")
  businesses.delete(nil)

  if business && !(business.nil? || business.to_s == '')
    final_business_array = Array.new

    businesses.each do |item|
      if (item[:organization].scan(/[a-z0-9\s]/i).join rescue "") =~ Regexp.new(business.scan(/[a-z0-9\s]/i).join, true) ||
        (item[:name].scan(/[a-z0-9\s]/i).join rescue "") =~ Regexp.new(business.scan(/[a-z0-9\s]/i).join, true)
          final_business_array.push(item)
      end
    end

    final_business_array
  else
    businesses
  end
end 
```

# javascript - 测试一个对象是否是一个 DOM 事件

> ID：14407245
> 
> 赞同：6
> 
> 时间：2013-01-18T20:39:42.517
> 
> 标签：javascript, javascript-events

从像这样的函数中

```
function eventHandler(e) {
  // ...
} 
```

是否有可靠有效的方法来确定是否`e`是 DOM 事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:13:33.897

我不相信有一种可靠的方法可以确定给定对象是否**不是**DOM 事件。

1.  `typeof e`将始终返回`'object'`真正的 Event 对象，这没有帮助。
2.  您可能在对象上检查的任何属性都可以存在于真正的 Event 对象或任何非 Event 对象中。
3.  您可能认为原型链可以用于确定这一点，但它与＃2 有相同的问题（可以很容易地复制）。
4.  该`contructor`属性可能看起来很有希望，但可以这样做：

```
function DummyEvent(){
    this.constructor.toString = function(){
        return "function MouseEvent() { [native code] }";
    }
} 
```

这最终会`console.log(e.constructor)`打印`"function MouseEvent() { [native code] }"`

那么，是否有一种“可靠”的方式来判断一个对象是否是一个事件？**没有**。

**编辑**- 请注意，如果您想防止事件欺骗，所有这些都无关紧要，因为您可以轻松创建真实事件。

```
var evt = new Event('click');
var evt2 = document.createEvent('MouseEvents');
evt2.initMouseEvent('click', ...);
//etc 
```

**Edit2** — 我创建了一个测试[jsFiddle](http://jsfiddle.net/u5nvP/5/)，试图找到一些区分对象的方法，但我还没有找到任何确定的东西。请注意，我没有费心在 上指定属性，`DummyEvent`因为这些显然很容易被欺骗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:55:00.403

也许如果事件`event.bubbles`通过 DOM 冒泡，它就是 DOM 事件。但即使该陈述是正确的，它的传播也可能会停止。

**更新**：

好的，您正在寻找的属性是`e.target`IE `e.srcElement`。这两个属性都返回发生事件的 HTML 元素，该元素将其定义为 DOM 事件。

但是，也许您应该指定您解释为 DOM 事件的内容。你的意思是浏览器的原生事件，因为这也是 DOM 事件：

```
var zoo = jQuery('#zoo');
zoo.bind('moo');
zoo.trigger('moo'); 
```

它绑定到一个 DOM 节点

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-18T21:12:25.433

在 jquery 中，我创建了一个测试函数，如下所示：

```
function isEvent(e) {
    try { 
        e.PreventDefault();
        return true;
    }
    catch (err) {
        return false;
    } 
```

}

和测试代码：

```
var o = new Object();
var e = $.Event('click');
alert(isEvent(o));
alert(isEvent(e)); 
```

前一个警报显示为假，而后者显示为真。见[小提琴](http://jsfiddle.net/eh6W7/2)。

更新：调用诸如 preventDefault 之类的东西而不是触发器更安全。

# sas - 当数据集中的变量与变量列表匹配时，对数据集进行子集化

> ID：14407249
> 
> 赞同：1
> 
> 时间：2013-01-18T20:39:52.930
> 
> 标签：sas, subset

我正在处理 sas 中的一个数据问题。我有一个数据集，包括 1000 个变量和每个变量的 1000 条记录。我还有另一个变量列表，其中包括 100 个变量名称。当该数据集中的变量名称与变量列表匹配时，我想对第一个数据集进行子集化。

我试过`proc merge`and `proc sql`，但无法解决。任何人都可以帮助我吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:47:41.090

SAS 使用方便命名的关键字“keep”和“drop”来保留或删除变量。如果您还没有文本格式的列表，PROC SQL 可以帮助您生成列表。

```
data want;
set have;
keep var1 var2 var3 var4;
run; 
```

如果数据集“vnames”中的变量列表带有变量“tokeep”，则可以执行以下操作：

```
proc sql;
select tokeep into :keeplist separated by ' ' from vnames;
quit;

data want;
set have;
keep &keeplist.;
run; 
```

PROC SQL 正在获取 'tokeep' 的内容，而不是将它们选择到表或屏幕上，而是将它们放在宏变量 'keeplist' 内的空格分隔列表中，然后将其用作 'keep' 的参数陈述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T07:54:30.940

[Here](https://stackoverflow.com/questions/5375139/how-to-read-variable-names-in-a-sas-data-set) you can find how to output a list of all the variable names of a dataset as another dataset. This will make it way easier to decide which of the big datasets you will use and which you will not (e.g. a left (or right) join of variable names, then look at the number of rows is at least the count of variables which you want to have).

# android - 在睡眠模式下检测相机按钮

> ID：14407252
> 
> 赞同：0
> 
> 时间：2013-01-18T20:40:00.570
> 
> 标签：android

无论如何在睡眠模式下检测相机按钮？我尝试了这个论坛中解释的示例，但在睡眠模式下没有任何作用..我正在寻找这个很长时间，但没有正确的答案..

[如何在睡眠模式下接收硬件按键事件？](https://stackoverflow.com/questions/7924241/how-i-can-receive-hardware-key-events-in-sleep-mode)

请帮我...

```
public class YourBoardcastReceiver extends BroadcastReceiver {
        @Override
        public void onReceive(Context context, Intent intent) {
                if (Intent.ACTION_CAMERA_BUTTON.equals(intent.getAction())) {
                        Intent main = new Intent();// 
                }
        }
}
And in your Manifest :

<receiver android:name="YourBoardcastReceiver">
                <intent-filter>
                        <action android:name="android.intent.action.SCREEN_ON" />
                </intent-filter>
</receiver> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:42:26.353

这是不可能的。当设备进入睡眠模式时，几乎所有的应用程序都会暂停或停止。只有足够的处理器保持能够接听电话和 SMS 文本，并管理警报和通知。除此之外，几乎所有东西都停产了。

如果您想在屏幕关闭时继续检测它，则需要获取唤醒锁以防止设备进入睡眠状态。但是，如果您一直这样做，则会影响用户的电池寿命。

# asp.net-mvc - 没有任何 ORM 的 ASP.NET MVC 4 项目

> ID：14407256
> 
> 赞同：2
> 
> 时间：2013-01-18T20:40:18.173
> 
> 标签：asp.net-mvc, ado.net, asp.net-mvc-4

我正在尝试使用没有 EF 并且可能没有 LINQ 的 ASP.NET MVC。首先，我在 VS2010 中的基本 ASP.net mvc 模板上只创建了一个表/模型/控制器/视图（仅实现了索引页面和索引方法）。我目前正在尝试/错误，因为网络上的所有教程都基于 EF，并且我有嵌入式 c 背景。

我的问题是：

*   架构是否正确？

*   我看到存储库模式用于一些开源项目，例如 nearforums。它的优势是什么，它如何适应这一点，它会取代 DAL 吗？

*   我应该将数据表传递给视图还是表示数据表的对象？

*   我可以将多个模型传递到剃须刀页面吗？例如，我如何列出 2 个不同的表？

*   将所有 DAL 代码放在一个文件中更好吗？

**达尔：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data;
using System.Configuration;
using MySql.Data.MySqlClient;

namespace MvcApplication1.Models
{
  public class DAL
  {
    public DAL()
    { }
    public DataTable getDataTable(string tableName)
    {
      using (MySqlConnection conn = new MySqlConnection(ConfigurationManager.ConnectionStrings["MySQLConn"].ConnectionString))
      {
        using (MySqlCommand command = conn.CreateCommand())
        {
          command.CommandText = "select * from " + tableName;
          command.CommandType = CommandType.Text;

          conn.Open();

          var table = new DataTable();
          table.Load(command.ExecuteReader());

          return table;
        }
      }
    }
  }
} 
```

**Product.cs 类表示代码中的 Product 表：**

```
namespace MvcApplication1.Models
{
  public class Product
  {
      public int ProductId { get; set; }
      public string Name { get; set; }
      public string Producer { get; set; }
      public int UnitPrice { get; set; }
  }
} 
```

**产品控制器.cs**

```
namespace MvcApplication1.Controllers
{
    public class ProductController : Controller
    {
        //
        // GET: /Product/
      DAL dal = new DAL();
        public ActionResult Index()
        {
          DataTable dt = dal.getDataTable("Product");
          Product[] products = new Product[dt.Rows.Count];
          for (int i = 0; i < dt.Rows.Count; i++)
          {
            products[i] = new Product();
            products[i].ProductId = (int)dt.Rows[i]["ProductId"];
            products[i].Name = (string)dt.Rows[i]["Name"];
            products[i].Producer = (string)dt.Rows[i]["Producer"];
            products[i].UnitPrice = Decimal.ToInt32((decimal)dt.Rows[i]["UnitPrice"]);
          }

          return View(products);
        }
........
........
} 
```

**索引.cshtml：**

```
@model IEnumerable<MvcApplication1.Models.Product>
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>
@foreach (var item in Model)
{
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.ProductId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Producer)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UnitPrice)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.ProductId }) |
            @Html.ActionLink("Details", "Details", new { id=item.ProductId }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.ProductId })
        </td>
        <br>
    </tr>
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:14:07.880

**我看到存储库模式用于一些开源项目，例如 nearforums。它的优势是什么，它如何适应这一点，它会取代 DAL 吗？**

存储库模式的好处是它允许您切换数据访问逻辑/ORM。例如，如果您想从 Entity Framework 切换到 NHibernate，您只需在 IoC 容器中更新您的注册，就像魔术一样，您的代码正在使用 NHibernate，而您不知道是否进行过切换。它允许您的代码与底层持久性框架无关。据它所知，结果代码来自文件、Web 服务调用或内存列表。如果您必须从另一个组件进行相同的查询，您还将获得重用。另一个好处是单元测试。使用您当前的实现，您无法对控制器进行单元测试，因为它每次都将直接连接到您的数据库，因此根据定义使其成为集成测试。你肯定会想要利用 ORM，或者你会一遍又一遍地编写相同的代码，直到它让你哭泣。设置/拆除连接，将所有原语类型转换为原生 .NET 类型等。如今，处理原生 ADO.NET 已成为过去。使用 ORM 让您的生活更轻松。同时，权力越大，责任越大。如果您不验证针对数据库生成和执行的查询，ORM 可能是一场噩梦。如果使用不当，它们会产生性能问题。您将能够利用 LINQ 来处理大多数查询，但有时您必须使用肮脏的时髦本机并使用原始 SQL。您的 ORM 仍然能够处理这两种情况。设置/拆除连接，将所有原语类型转换为原生 .NET 类型等。如今，处理原生 ADO.NET 已成为过去。使用 ORM 让您的生活更轻松。同时，权力越大，责任越大。如果您不验证针对数据库生成和执行的查询，ORM 可能是一场噩梦。如果使用不当，它们会产生性能问题。您将能够利用 LINQ 来处理大多数查询，但有时您必须使用肮脏的时髦本机并使用原始 SQL。您的 ORM 仍然能够处理这两种情况。设置/拆除连接，将所有原语类型转换为原生 .NET 类型等。如今，处理原生 ADO.NET 已成为过去。使用 ORM 让您的生活更轻松。同时，权力越大，责任越大。如果您不验证针对数据库生成和执行的查询，ORM 可能是一场噩梦。如果使用不当，它们会产生性能问题。您将能够利用 LINQ 来处理大多数查询，但有时您必须使用肮脏的时髦本机并使用原始 SQL。您的 ORM 仍然能够处理这两种情况。拥有权利的同时也被赋予了重大的责任。如果您不验证针对数据库生成和执行的查询，ORM 可能是一场噩梦。如果使用不当，它们会产生性能问题。您将能够利用 LINQ 来处理大多数查询，但有时您必须使用肮脏的时髦本机并使用原始 SQL。您的 ORM 仍然能够处理这两种情况。拥有权利的同时也被赋予了重大的责任。如果您不验证针对数据库生成和执行的查询，ORM 可能是一场噩梦。如果使用不当，它们会产生性能问题。您将能够利用 LINQ 来处理大多数查询，但有时您必须使用肮脏的时髦本机并使用原始 SQL。您的 ORM 仍然能够处理这两种情况。

**我应该将数据表传递给视图还是表示数据表的对象？**

您当然不想传递数据表。您想将视图模型或实体传递给您的视图。视图应该对数据库一无所知。你所做的就是给它数据，它会显示在屏幕上，但并不知道数据的来源。如果您使用 NHibernate 之类的东西，您需要小心将实体直接传递到您的视图，因为您会遇到与延迟加载和 N + 1 查询相关的问题。视图模型通常是实体的精简版本。例如，如果您有一个具有 4 个属性的实体，但视图只需要消耗这些属性的 2/4，您将创建一个具有 2 个属性的单独视图模型，并使用像 Automapper 这样的映射库从您的实体映射到视图模型。

**我可以将多个模型传递到剃须刀页面吗？例如，我如何列出 2 个不同的表？**

这很简单。您创建一个顶级对象并为其提供 2 个属性来表示您要访问的实体。

```
public class MyViewModel
{
  public Entity1 FirstObject { get; set; }

  public Entity2 SecondObject { get; set; }
} 
```

然后，您将创建一个强类型视图，并使用您在问题中发布的剃刀视图中使用的强类型视图助手渲染 FirstObject 和 SecondObject。@Html.TextBoxFor() 等

最后，您的控制器将接受 MyViewModel 作为参数，并根据您的视图中呈现的表单输入填充 FirstObject 和 SecondObject。

**将所有 DAL 代码放在一个文件中更好吗？**

您想将相关的 DAL 代码放在同一个文件中。事物通常由表格映射出来，但这一切都取决于您的对象之间的关系（例如，您的聚合根是什么）。您不想做的是盲目地为每个表实现一个存储库。您最终会得到一个真正程序化且贫乏的数据模型，该模型会通过对数据库的多次调用将对象图和关系拼接在一起。我建议研究领域驱动设计，以了解如何解决这个问题。

我只是在这里触及了表面。如果你想正确地做这些事情，你基本上需要学习最新的模式和实践。这是一个不同的运动。不像过去的文件、视图状态和 DataGrid 控件背后的单一代码的美好时光。那里有一些非常好的书，例如：

Brownfield 应用程序开发领域驱动设计 (Eric Evans) Clean Coder (Robert C Martin) 重构：改进现有代码的设计 (Martin Fowler) 企业应用程序架构模式 (Martin Fowler)

我并不是说要逐字阅读所有这些书籍，但我强烈推荐前 2 本书。我相信社区会对这些开发实践有更多的看法，但这是我对这一切的看法。谢谢，祝你好运。

# jquery - 需要使用 jQuery 帮助的动画菜单

> ID：14407257
> 
> 赞同：0
> 
> 时间：2013-01-18T20:40:21.200
> 
> 标签：jquery, html, css, navigation

我正在设计一个用于学习目的的网站，出于某种原因，我的导航栏对于所有选项卡都处于“悬停”状态。我正在关注的教程非常深入，但我已经研究了代码几个小时，我想我只是没有足够的知识来找出问题所在。在排除故障时，我查看了源代码并复制了它（来自他们的示例），但仍然遇到同样的问题。按钮都“总是”处于悬停状态，因此 Java Script 似乎没有做任何事情。

教程：[http ://www.shopdev.co.uk/blog/animated-menus-using-jquery/](http://www.shopdev.co.uk/blog/animated-menus-using-jquery/)

我为此创建了 3 张图片（与教程略有不同）

**bkrd.png** = 400 像素高的窄图像，重复背景工具栏（无菜单选项卡） **spritedown.png** = 显示正常按钮状态（主页和投资组合）的精灵 81 像素高
**spriteover.png** = 显示按钮悬停状态的精灵。81 像素高

我的代码：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>jQuery Animated Menu Demo</title>

<style>
body {
    background-color:#333333;
    margin:0;
}

/* Menu Body */
ul#menu {
    width:80%;
    height:400px;
    background:url(bkrd.png) repeat-x;
    list-style:none;
    margin:0;
    padding:0;
    padding-top:109px; /* distance from top where i need the sprite to start*/
    padding-left:20%;
}

/* Float LI Elements - horizontal display */
ul#menu li {
    float:left;
}

/* Link - common attributes */
ul#menu li a {
    background:url(spritedown.png) no-repeat scroll top left;
    display:block;
    height:81px;
    position:relative;
}

/* Specify width and background position attributes specifically for the class: "home" */
ul#menu li a.home {
    width:159px;
    background-position:0px 0px;
}

/* Specify width and background position attributes specifically for the class: "portfolio" */
ul#menu li a.portfolio {
    width:157px;
    background-position:-159px 0px;
}

/* Span (on hover) - common attributes */
ul#menu li a span {
    background:url(spriteover.png) no-repeat scroll bottom left;
    display:block;
    position:absolute;
    top:0;
    left:0;
    height:81px;
    width:100%;
    z-index:100;
}

/* Span (on hover) - display pointer */
ul#menu li a span:hover {
    cursor:pointer;
}

/* Shift background position on hover for the class: "home" */
ul#menu li a.home span {
width:159px;
    background-position:0px 0px;
}

/* Shift background position on hover for the class: "portfolio" */
ul#menu li a.portfolio span {
    background-position:-159px 0px;
}
</style> 
```

剧本：

```
<!-- Include jQuery Library -->
<script src="jquery-1.2.2.pack.js" type="text/javascript"></script>

<!-- Let's do the animation -->
<script type="text/javascript">
$(function() {
    // set opacity to nill on page load
    $("ul#menu span").css("opacity","0");
    // on mouse over
    $("ul#menu span").hover(function () {
        // animate opacity to full
        $(this).stop().animate({
            opacity: 1
        }, 'slow');
    },
    // on mouse out
    function () {
        // animate opacity to nill
        $(this).stop().animate({
            opacity: 0
        }, 'slow');
    });
});
</script>
</head> 
```

身体：

```
<body>
<ul id="menu">
    <li><a href="#" class="home"><span></span></a></li>
    <li><a href="#" class="portfolio"><span></span></a></li>
</ul>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:42:54.837

你还没有打开你的 jquery 脚本 jsfiddle ......你甚至已经将你的 jquery.js 包含在你的 jsfiddle 中了`head`吗？[您在http://jsfiddle.net/7JxMF/1/](http://jsfiddle.net/7JxMF/1/)上使用 jquery 的 jsfiddle

# php - mySqli ....内连接？

> ID：14407266
> 
> 赞同：1
> 
> 时间：2013-01-18T20:41:07.667
> 
> 标签：php, mysqli

我有两张桌子..照片和画廊具有以下结构：
------------------------------------ ------------
表：照片
------------------------------------ ------------
--照片 ----- 所有者 - 图库 - 订购
123.jpg --------23--------28 ----- - 1
234.jpg --------23--------28 ------ 2
345.jpg --------23-------- 29 ------ 1
456.jpg --------23--------29 ------ 2
567.jpg --------23-- ------30 ------ 1

------------------------------------------------
表：画廊
--------------------------------------------------------
id - -画廊名称 ---- 所有者 ---- 访问 -
28 -- 图库 1 ---------- 23 ------- 私人 -
29 -- 图库 2 -------- --- 23 ------- 公共 -
30 -- 画廊 3 ---------- 23 ------- 公共 -

两张表的关系是photos.gallery = gallery.id

我想获取具有特定访问类型（私有）的每个画廊的列表（使用 while 循环），并从照片表中为 order = 1 的每个画廊获取 photos.photo。

我应该使用内连接、左连接还是什么？我尝试了以下方法，但没有成功。有人可以帮我理解我做错了什么吗？

```
if ($stmt = $mysqli->prepare("SELECT galleries.id, galleries.galleryname, photos.photo FROM galleries INNER JOIN photos ON galleries.id=photos.gallery WHERE galleries.access = 'private' AND galleries.owner = '23' AND photos.count = '1'")) 
{     
  $stmt->execute();     
  $stmt->bind_result($private_gal_id,$private_gal_name,$private_gal_photo);
  while ($stmt->fetch()) 
    {      
      echo "The results: $private_gal_id - $private_gal_name - $private_gal_photo";
    }
  $stmt->close();;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:44:57.617

代替：

`AND photos.count = '1'"))`

在查询结束时，它应该是：

`AND photos.order = '1'"))`

# scala - squeryl 日期到长转换

> ID：14407269
> 
> 赞同：0
> 
> 时间：2013-01-18T20:41:15.653
> 
> 标签：scala, date, utc, gmt, squeryl

我想使用 Squeryl 将 java.util.Date（或 Timestamp）作为 int（或 Long）存储在我的数据库中。

我想控制日期如何转换为数字，反之亦然。

我怎样才能做到这一点？

我对 scala/squeryl 很陌生，来自 java/hibernate。回到 java/hibernate，我可以创建用户类型并全局注册它们或在带有注释的字段上本地使用它们。此用户类型定义了如何将对象类型持久保存到 db 以及如何从 db 加载它的方法。

我阅读了一些 squeryl 和 scala 文档，注意到两件事：

1.  有自定义类型

2.  有一个隐式函数机制被调用来进行转换

我知道其中之一可以帮助我，但我没有找到任何好的完整示例来理解如何。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T17:32:41.930

请看这个例子：

[https://github.com/max-l/squeryl-extended-field-types-example/blob/master/src/main/scala/example/MyCustomTypes.scala](https://github.com/max-l/squeryl-extended-field-types-example/blob/master/src/main/scala/example/MyCustomTypes.scala)

在您的情况下，您将 TTimestamp 替换为 TLong （支持 JDBC 类型），将 DateTime 替换为 Date （尽管您可能需要考虑使用 joda 日期）。

```
implicit val dateAsLongTEF = new NonPrimitiveJdbcMapper[Long, Date, TLong](longTEF, this) {
  def convertFromJdbc(v: Long) = new Date(v)
  def convertToJdbc(v: Date) = v.getTime
}

implicit val optionDateAsLongTEF = 
new TypedExpressionFactory[Option[Date], TOptionLong] 
  with DeOptionizer[Long, Date, TLong, Option[Date], TOptionLong]  {

    val deOptionizer = dateAsLongTEF
} 
```

注意：您使用 TLong 和 TOptionLong 的事实意味着您将能够将数字列与 DSL 中的长支持列进行比较。

更新：有一个限制阻止重新注册原始类型，所以你需要一个包装器类型，我更新了 github 项目中的示例......

# database - 数据库表设计：在保持向后兼容性的同时扩展数据表

> ID：14407270
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:41:17.197
> 
> 标签：database, oracle, jsp, database-design, relational-database

我正在从事的项目逐年跟踪数据。用户将登录系统并指定要访问数据的年份。例如，用户可以指定 2004 年，.jsp 页面将显示 2004 年的数据。

我的问题是，从 2013 年开始，一个 .jsp 页面的数据会有所不同，需要修改当前的数据库表架构，但需要保持 2012 年及之前的向后兼容性。

目前（2012 年及之前），相关数据库表显示两列，“继续学生”和“新开始”，由单个 .jsp 显示。对于 2013 年及以后的版本，需要显示 4 列。原来的两列被分成两个子类别，本科生和研究生。所以我不能简单地将这些新列添加到现有表中，因为这会违反第三范式。

您认为处理这种情况的最佳方法是什么？如何在显示旧数据的同时保持向后兼容性以显示新数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:02:29.250

一些选项：

1.  引入字段并允许旧数据为空。我想你拒绝了这个想法。
2.  创建新的表结构来存储新的数据。如果您不想要（1），这至少是一个选择。您可以轻松地创建一个从两个表中查询并呈现一组统一数据的视图。您还可以在 UI 中处理此问题，并根据查询的年份调用两个单独的存储过程。
3.  使用新属性创建一个新表，然后选择性地加入原始表。这使旧表保持不变，新表只是旧数据的扩展。您可能会编写一个存储过程以获取该年，然后返回适当的数据。

真正要考虑的一件事是旧数据现在处于非活动状态。如果您不再写信给它，那么它只是可以在心理上“存档”的历史数据。在那种情况下，我认为冻结模式和数据并让它自己存在是可以的。

还要考虑您的客户是否可能再次更改架构。如果是这样，那么也许（1）是最好的。

# c++ - Xcode 与 Visual Studio - SDL C++

> ID：14407282
> 
> 赞同：1
> 
> 时间：2013-01-18T20:42:02.003
> 
> 标签：c++, xcode, visual-studio-2010, sdl

我正在使用各种在线教程和几本书自学编程。目前它是C++。在过去的几天里，我做了一些[OpenGL和 SDL。](http://en.wikipedia.org/wiki/OpenGL)

我有一个小程序可以创建一堵墙来阻止一个小方块穿过它。

这是我的代码：

```
 //
    //  main.cpp
    //  SDL_Template
    //

    // The headers
    #include <stdlib.h>
    #include <string>

    // SDL headers
    #include <SDL/SDL.h>
    #include "SDL_image/SDL_image.h"
    //#include "SDL/SDL_ttf.h"
    //#include "SDL/SDL_mixer.h"

    // Other headers
    #include <OpenGL/gl3.h>

    // Screen attributes
    const int SCREEN_WIDTH = 640;
    const int SCREEN_HEIGHT = 480;
    const int SCREEN_BPP = 32;

    // The frame rate
    const int FRAMES_PER_SECOND = 20;

    // The attributes of the square
    const int SQUARE_WIDTH = 20;
    const int SQUARE_HEIGHT = 20;

    // The surfaces
    SDL_Surface *square = NULL;
    SDL_Surface *screen = NULL;

    // The event structure
    SDL_Event event;

    // The wall
    SDL_Rect wall;

    // The square
    class Square
    {
        private:
            // The collision box of the square
            SDL_Rect box;

            // The velocity of the square
            int xVel, yVel;

        public:
            // Initializes the variables
            Square();

            // Takes key presses and adjusts the square's velocity
            void handle_input();

            // Moves the square
            void move();

            // Shows the square on the screen
            void show();
    };

    //The timer
    class Timer
    {
        private:
            // The clock time when the timer started
            int startTicks;

            // The ticks stored when the timer was paused
            int pausedTicks;

            // The timer status
            bool paused;
            bool started;

        public:
            // Initializes variables
            Timer();

            // The various clock actions
            void start();
            void stop();
            void pause();
            void unpause();

            // Gets the timer's time
            int get_ticks();

            // Checks the status of the timer
            bool is_started();
            bool is_paused();
    };

    SDL_Surface *load_image(std::string filename)
    {
        // The image that's loaded
        SDL_Surface* loadedImage = NULL;

        // The optimized surface that will be used
        SDL_Surface* optimizedImage = NULL;

        // Load the image
        loadedImage = IMG_Load(filename.c_str());

        // If the image loaded
        if (loadedImage != NULL)
        {
            // Create an optimized surface
            optimizedImage = SDL_DisplayFormat(loadedImage);

            // Free the old surface
            SDL_FreeSurface(loadedImage);

            // If the surface was optimized
            if (optimizedImage != NULL)
            {
                //  Color key surface
                SDL_SetColorKey(optimizedImage, SDL_SRCCOLORKEY, SDL_MapRGB(optimizedImage->format, 0, 0xFF, 0xFF));
            }
        }

        // Return the optimized surface
        return optimizedImage;
    }

    void apply_surface(int x, int y, SDL_Surface* source, SDL_Surface* destination, SDL_Rect* clip = NULL)
    {
        // Holds offsets
        SDL_Rect offset;

        // Get offsets
        offset.x = x;
        offset.y = y;

        // Blit
        SDL_BlitSurface(source, clip, destination, &offset);
    }

    bool check_collision(SDL_Rect A, SDL_Rect B)
    {
        // The sides of the rectangles
        int leftA, leftB;
        int rightA, rightB;
        int topA, topB;
        int bottomA, bottomB;

        // Calculate the sides of rect A
        leftA = A.x;
        rightA = A.x + A.w;
        topA = A.y;
        bottomA = A.y + A.h;

        // Calculate the sides of rect B
        leftB = B.x;
        rightB = B.x + B.w;
        topB = B.y;
        bottomB = B.y + B.h;

        // If any of the sides from A are outside of B
        if( bottomA <= topB )
        {
            return false;
        }

        if( topA >= bottomB )
        {
            return false;
        }

        if( rightA <= leftB )
        {
            return false;
        }

        if( leftA >= rightB )
        {
            return false;
        }

        // If none of the sides from A are outside B
        return true;
    }

    bool init()
    {
        // Initialize all SDL subsystems
        if (SDL_Init( SDL_INIT_EVERYTHING ) == -1)
        {
            return false;
        }

        // Set up the screen
        screen = SDL_SetVideoMode(SCREEN_WIDTH, SCREEN_HEIGHT, SCREEN_BPP, SDL_SWSURFACE);

        // If there was an error in setting up the screen
        if (screen == NULL)
        {
            return false;
        }

        // Set the window caption
        SDL_WM_SetCaption("Move the Square", NULL);

        // If everything initialized fine
        return true;
    }

    bool load_files()
    {
        // Load the square image
        square = load_image("square.bmp");

        // If there was a problem in loading the square
        if (square == NULL)
        {
            return false;
        }

        // If everything loaded fine
        return true;
    }

    void clean_up()
    {
        // Free the surface
        SDL_FreeSurface(square);

        // Quit SDL
        SDL_Quit();
    }

    Square::Square()
    {
        // Initialize the offsets
        box.x = 0;
        box.y = 0;

        // Set the square's dimentions
        box.w = SQUARE_WIDTH;
        box.h = SQUARE_HEIGHT;

        // Initialize the velocity
        xVel = 0;
        yVel = 0;
    }

    void Square::handle_input()
    {
        // If a key was pressed
        if (event.type == SDL_KEYDOWN)
        {
            //Adjust the velocity
            switch (event.key.keysym.sym)
            {
                case SDLK_UP: yVel -= SQUARE_HEIGHT / 2; break;
                case SDLK_DOWN: yVel += SQUARE_HEIGHT / 2; break;
                case SDLK_LEFT: xVel -= SQUARE_WIDTH / 2; break;
                case SDLK_RIGHT: xVel += SQUARE_WIDTH / 2; break;
            }
        }
        // If a key was released
        else if (event.type == SDL_KEYUP)
        {
            //Adjust the velocity
            switch (event.key.keysym.sym)
            {
                case SDLK_UP: yVel += SQUARE_HEIGHT / 2; break;
                case SDLK_DOWN: yVel -= SQUARE_HEIGHT / 2; break;
                case SDLK_LEFT: xVel += SQUARE_WIDTH / 2; break;
                case SDLK_RIGHT: xVel -= SQUARE_WIDTH / 2; break;
            }
        }
    }

    void Square::move()
    {
        // Move the square left or right
        box.x += xVel;

        // If the square went too far to the left or right or has collided with the wall
        if (( box.x < 0 ) || ( box.x + SQUARE_WIDTH > SCREEN_WIDTH ) || ( check_collision(box, wall)))
        {
            // Move back
            box.x -= xVel;
        }

        // Move the square up or down
        box.y += yVel;

        // If the square went too far up or down or has collided with the wall
        if (( box.y < 0 ) || ( box.y + SQUARE_HEIGHT > SCREEN_HEIGHT) || (check_collision(box, wall)))
        {
            // Move back
            box.y -= yVel;
        }
    }

    void Square::show()
    {
        // Show the square
        apply_surface(box.x, box.y, square, screen);
    }

    Timer::Timer()
    {
        // Initialize the variables
        startTicks = 0;
        pausedTicks = 0;
        paused = false;
        started = false;
    }

    void Timer::start()
    {
        // Start the timer
        started = true;

        // Unpause the timer
        paused = false;

        // Get the current clock time
        startTicks = SDL_GetTicks();
    }

    void Timer::stop()
    {
        // Stop the timer
        started = false;

        // Unpause the timer
        paused = false;
    }

    void Timer::pause()
    {
        // If the timer is running and isn't already paused
        if ((started == true) && (paused == false))
        {
            // Pause the timer
            paused = true;

            // Calculate the paused ticks
            pausedTicks = SDL_GetTicks() - startTicks;
        }
    }

    void Timer::unpause()
    {
        // If the timer is paused
        if (paused == true)
        {
            // Unpause the timer
            paused = false;

            // Reset the starting ticks
            startTicks = SDL_GetTicks() - pausedTicks;

            // Reset the paused ticks
            pausedTicks = 0;
        }
    }

    int Timer::get_ticks()
    {
        // If the timer is running
        if (started == true)
        {
            // If the timer is paused
            if (paused == true)
            {
                // Return the number of ticks when the timer was paused
                return pausedTicks;
            }
            else
            {
                // Return the current time minus the start time
                return SDL_GetTicks() - startTicks;
            }
        }

        // If the timer isn't running
        return 0;
    }

    bool Timer::is_started()
    {
        return started;
    }

    bool Timer::is_paused()
    {
        return paused;
    }

    int main(int argc, char* args[])
    {
        // Quit flag
        bool quit = false;

        // The square
        Square mySquare;

        // The frame rate regulator
        Timer fps;

        // Initialize
        if( init() == false )
        {
            return 1;
        }

        // Load the files
        if (load_files() == false)
        {
            return 1;
        }

        // Set the wall
        wall.x = 300;
        wall.y = 40;
        wall.w = 40;
        wall.h = 400;

        // While the user hasn't quit
        while (quit == false)
        {
            // Start the frame timer
            fps.start();

            // While there are events to handle
            while (SDL_PollEvent(&event))
            {
                // Handle events for the square
                mySquare.handle_input();

                // If the user has Xed out the window
                if (event.type == SDL_QUIT)
                {
                    // Quit the program
                    quit = true;
                }
            }

            // Move the square
            mySquare.move();

            // Fill the screen white
            SDL_FillRect(screen, &screen->clip_rect, SDL_MapRGB(screen->format, 0xFF, 0xFF, 0xFF));

            // Show the wall
            SDL_FillRect (screen, &wall, SDL_MapRGB(screen->format, 0x77, 0x77, 0x77));

            // Show the square on the screen
            mySquare.show();

            // Update the screen
            if (SDL_Flip(screen) == -1)
            {
                return 1;
            }

            // Cap the frame rate
            if (fps.get_ticks() < 1000 / FRAMES_PER_SECOND)
            {
                SDL_Delay((1000 / FRAMES_PER_SECOND) - fps.get_ticks());
            }
        }

        // Clean up
        clean_up();

        return 0;
    } 
```

我完全理解这个网站的工作原理，所以我不要求你检查我的代码。我的代码在 Xcode 4.5 和 Visual Studio 2010 中都可以编译。在 Xcode 中它可以编译，但会引发一些警告（尽管它仍然会构建），但在运行时没有任何反应。但是在 Visual Studio 2012 中，它可以编译，没有警告并且成功运行。

我已经搜索过这里和 C++/SDL 论坛/帮助页面，但我没有找到任何类似的案例。

为什么会这样？似乎它在 Visual Studio 2010 中运行，我相信它不是代码......

如果您想知道 Xcode 中标记的警告是：

> 229 枚举值未在开关中处理：'SDLK_UNKNOWN'、'SDLK_BACKSPACE'、'SDLK_TAB'...

这在`switch (event.key.keysym.sym)`代码行上突出显示。

所以我的问题是：

*   什么样的问题可能会导致此警告错误？

*   在 Visual Studio 而不是 Xcode 中运行的程序是否存在任何众所周知的问题？

我猜（似乎我找不到任何关于它的东西）这是一个我没有发现的地方......

我为这篇文章的长度道歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:07:07.047

您没有在 switch 语句中处理所有可能的选择。如果这是您想要的，那么您可以使用默认情况删除警告，如下所示：

```
switch (event.key.keysym.sym)
{
     case SDLK_UP:    yVel -= SQUARE_HEIGHT / 2; break;
     case SDLK_DOWN:  yVel += SQUARE_HEIGHT / 2; break;
     case SDLK_LEFT:  xVel -= SQUARE_WIDTH  / 2; break;
     case SDLK_RIGHT: xVel += SQUARE_WIDTH  / 2; break;
     default: break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:45:54.870

Xcode 只是警告您没有处理`event.key.keysym.sym`枚举的所有可能值。由于我怀疑您是否想要处理单个不同类型的按键，所以这不是问题，因为我可能会看看是否可以降低警告级别以抑制这些警告。

至于Xcode构建时程序运行不成功，我不知道。也许 SDL 的设置方式不同？

# django - 是否可以将 Django F() 表达式与 full_clean() 一起使用进行原子更新？

> ID：14407291
> 
> 赞同：2
> 
> 时间：2013-01-18T20:42:52.097
> 
> 标签：django, django-models, django-validation

我刚刚发现分配有 Django`F()`表达式的字段无法验证。我修改[了 Django 文档中的](https://docs.djangoproject.com/en/dev/ref/models/instances#updating-attributes-based-on-existing-fields)示例：

```
>>> product = Product.objects.get(name='Venezuelan Beaver Cheese')
>>> product.number_sold = F('number_sold') + 1
>>> product.full_clean() # My addition.
>>> product.save() 
```

我得到：`ValidationError: {'number_sold': [u"'(+: (DEFAULT: ), 0)' value must be an integer."]}`。实际上， number sold 不是整数，而是 的一个实例`django.db.models.expressions.ExpressionNode`。

有没有解决的办法？我所有的模型都扩展了一个在每次保存时自动调用的基类，`full_clean()`我真的很喜欢保留这个基类，但能够使用原子更新。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-18T21:39:21.167

你的问题是你试图在一个整数字段中保存一个非整数值。

在您的情况下，该字段`number_sold`应为整数。

我会假设`F('number_sold')`引用一个空字段。

尝试`F('number_sold') + 1`用硬编码的东西替换，例如 1。

如果可行，请告诉我，我可以提供逻辑以避免您的错误。

# backbone.js - jQuery Promise 和 Backbone

> ID：14407294
> 
> 赞同：18
> 
> 时间：2013-01-18T20:42:59.033
> 
> 标签：backbone.js, promise

我发现这段代码可以满足我的要求：

```
var promise = this.model.save();
$.when(promise).then(function() {
     console.log(promise.responseText);
}); 
```

`responseText`我想从我的 Backbone 调用中取回`this.model.save()`. [此处](https://stackoverflow.com/questions/12795489/backbone-getting-raw-response-from-server)记录了此代码。但它没有记录任何东西，即使我在`console.log()`调用中提取了一个原始文本字符串。

有人可以用外行的术语解释什么是 jQuery 承诺吗？我读过它们，但我不认为我完全明白它们是什么。这可能有助于我理解为什么这段代码对我不起作用。如果我`console.log(promise)`在第一行和第二行代码之间，那么我会得到`responseText`. 因此，要么发生了一些事情，要么`$.when`导致了`then`这个问题。

编辑：

阅读文章后，我发现我可以这样做：

```
var promise = this.model.save(); 
$.when(promise).then(null, function(obj) {
    console.log(obj.responseText);
}); 
```

但我不明白`null`代表什么。 `then`似乎需要两个参数，一个成功函数和一个失败函数。但是成功功能不就是第一吗？我从服务器收到 200 响应。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-18T23:39:14.527

所以首先，我很确定你不需要这个`when`部分；来自 jQuery 文档：

> 从 jQuery 1.5 开始，由 $.ajax() 返回的 jqXHR 对象实现了 Promise 接口，为它们提供了 Promise 的所有属性、方法和行为（有关更多信息，请参阅延迟对象）。

由于 Promise 已经有一个`then`方法，你可以这样做：

```
this.model.save().then(null, function(obj) {
    console.log(obj.responseText);
}); 
```

（至少对我来说，上面的代码几乎读起来像一个英文句子，这是使用 Deferreds 的一个主要优势。）

至于您的`null`论点，文档再次非常清楚。有三个签名`then`（这只是为了涵盖不同的 jQuery 版本；任何给定的版本都更少）：

> deferred.then( doneFilter [, failFilter ] [, progressFilter ])
> 
> deferred.then( doneCallbacks, failCallbacks )
> 
> deferred.then( doneCallbacks, failCallbacks [, progressCallbacks ] )

如您所见，所有三个都首先采用“完成”功能，其次是失败功能。这似乎确实意味着您遇到了失败，这令人困惑。避免该问题的一种方法是根本不使用`then`。相反，请尝试以下操作：

```
this.model.save().always(function(obj) {
    console.log(obj.responseText);
}); 
```

无论发生什么，这都会使您的函数被调用。但是，您可能应该弄清楚发生了什么，因此您可能希望添加一个成功和失败回调来进行一些调试：

```
this.model.save().done(function() {
    // Success case
}).fail(function() {
    // Failure case
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-18T23:38:24.407

因为`this.model.save`返回一个 Promise，所以您可以改为执行以下操作：

```
this.model.save()
    .done(function(response) {
        console.log("Success!");
    })
    .fail(function(response) {
        console.log("Error!");
    }); 
```

（这比整体更容易`$.when`。）

我的猜测是，尽管您的响应返回了 200 代码，但它仍然“失败”，因为响应数据类型与您期望的不匹配（调用中`dataType`属性中设置的内容`$.ajax`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-01T19:14:06.153

我是使用 Promise 的忠实拥护者，我认为 Promise 在不同的包中意味着非常相似的东西。

要回答您的问题，以前的答案没有，“then”函数是一个promise的函数，“when”函数是一个失败保存，以防对象不是promise，一个“when（obj）”将确保它是一个承诺，以便您可以使用优雅的 xxx.then(success(){},error(){})。

顺便说一句，machineghost 所说的“延迟”是让你使用 promise 的包。开始了解 promise 以及如何使用它。看看这个教程。它非常清楚地解释了每一件事，正是这篇文章让我如此承诺。 [http://strongloop.com/strongblog/promises-in-node-js-with-q-an-alternative-to-callbacks/](http://strongloop.com/strongblog/promises-in-node-js-with-q-an-alternative-to-callbacks/)

现在，正如 machineghost 所说，根据 REST API 文档[https://parse.com/docs/rest#](https://parse.com/docs/rest#)（不知道它是否与主干相同），您的同步调用似乎出错了，服务器将以这种格式响应“创建”请求的 JSON 对象：

```
{"createdAt": "2011-08-20T02:06:57.931Z","objectId": "Ed1nuqPvcm"} 
```

我的猜测是，也许您的服务器没有使用正确的 JSON 响应请求，因此 save() 认为操作失败是因为没有“createAt”字段，事件认为您的服务器确实创建了该项目。

# android - 如何强制我的应用程序到前面

> ID：14407295
> 
> 赞同：0
> 
> 时间：2013-01-18T20:43:01.923
> 
> 标签：android

我开发了一个使用带有回调的计时器的 android 应用程序。当满足特定条件时，应用程序会根据用户设置振铃或振动手机。它将继续响铃，直到用户确认警报框。这一切都很好。但是，如果用户将另一个应用程序放在前面，那么他可能没有意识到是我的应用程序导致手机响铃并重新打开它。有没有办法可以将我的应用程序强制放在前面，或者至少将警报消息放在其他任何东西之上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:46:57.727

通知是你的朋友。它们不会中断用户的工作流程，并且使用新的 JellyBean api，您可以将操作和其他动态组件放入其中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:47:25.657

除了这样做之外，您可以在发送后使用带有特定铃声的通知，而不是这样惹恼用户。

# php - 从 REGEXP 和 UPDATE 返回结果

> ID：14407304
> 
> 赞同：0
> 
> 时间：2013-01-18T20:43:36.863
> 
> 标签：php, mysql, regex

我有 2 张桌子，一张名为`pictures`，另一张名为`media`.

在表中`pictures`，我有`description`包含一些文本的字段。在 table 中`media`，有`url`我想更新的行。

我需要编写一个 SQL 查询来更新表中的行`url`，该查询`media`将正则表达式用于表中的特定`description`字符串`pictures`。

我被推荐了 mysql 函数`REGEXP`，但被告知它不能返回结果。问题是在该字段`description`中有一个我需要`UPDATE` `url`使用的字符串。

我应该执行 SQL 查询还是使用 PHP 脚本来更新表？

# java - 在同一个类中调用其他方法的方法：糟糕的设计？

> ID：14407306
> 
> 赞同：0
> 
> 时间：2013-01-18T20:43:43.667
> 
> 标签：java, oop, easymock

EasyMock 3.0 文档（http://www.easymock.org/EasyMock3_0_Documentation.html）声称它是，但没有解释原因（强调我的）：

> 有时您可能只需要模拟类的某些方法并保持其他方法的正常行为。**这通常发生在您想要** **测试调用同一类中其他一些方法的方法时。**因此，您希望保持被测试方法的正常行为并模拟其他方法。
> 
> **在这种情况下，首先要做的是考虑重构，因为** **大多数时候这个问题是由糟糕的设计引起的。**

那么，这是正确的吗？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:48:09.500

问题不在于调用自己的方法，而是模拟这些调用的必要性表明了另一个问题。否则，您可以只测试公共方法并验证它们的行为。您不需要关心调用的其他方法，而只需关心可观察的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T20:47:04.763

一如既往，这取决于。

方法一直在调用其他方法；这是（IMO 适当的）重构的自然结果，将其他方法切成小块。对我来说，问题在于你*必须*模拟那些微小的正确方法并且不这样做就无法测试。

如果有很多小方法，它们可能更合适地包装在某种协作者类中，此时您将模拟协作者，而不是内部方法。

此外，那些小的内部方法可能是私有方法，其测试是一个争论的主题。

# axapta - 在 Dynamics AX X++ 中解压缩 GZip 流

> ID：14407308
> 
> 赞同：2
> 
> 时间：2013-01-18T20:43:50.927
> 
> 标签：axapta, x++, ax

我正在尝试在 X++ 中对 .NET GZIPStream 进行放气，但遇到了一个错误。创建字符串的 .NET 代码非常简单：

```
 private string CompressString()
    {
        string stringToCompress = "Some data here";
        string result = string.Empty;

        using (MemoryStream output = new MemoryStream())
        using (GZipStream gzip = new GZipStream(output, CompressionMode.Compress, true))
        using (StreamWriter writer = new StreamWriter(gzip))
        {
            writer.Write(stringToCompress);
            writer.Close();
            result = Convert.ToBase64String(output.ToArray());
        }

        return result;
    } 
```

AX 端将通过一些 Web 服务调用获取压缩字符串。我目前拥有的 X++ 代码如下，但在创建 StreamWriter 时出现错误“无法创建对象 'CLRObject'”。

```
static void Job2(Args _args)
{
   System.String decodedString;
   System.Byte[] buffer;
   System.IO.Compression.GZipStream gzip;
   System.IO.StreamWriter writer;
   System.IO.MemoryStream output;
   InteropPermission permission;
   CLRObject ex;

   str compressedString ="Compressed data here";
   ;

   ttsBegin;
   permission = new InteropPermission(InteropKind::ClrInterop);
   permission.assert();

   buffer = System.Convert::FromBase64String(compressedString);
   output = new System.IO.MemoryStream(buffer);
   gzip = new System.IO.Compression.GZipStream(output, System.IO.Compression.CompressionMode::Decompress);

   try {
       //Error here: "Object 'CLRObject' could not be created"
       writer = new System.IO.StreamWriter(gzip);
       writer.Write(decodedString);
       writer.Close();

       CodeAccessPermission::revertAssert();
   } 
   catch (Exception::CLRError) {
       //Code never executes past this point 
       ex = CLRInterop::getLastException();

       while(ex != null) {
           error(ex.ToString());
           ex = ex.get_InnerException();
       }
   }

   ttsCommit;
   info(decodedString);
} 
```

**编辑**：基于@robert-allen 下面的答案，在 AX 中完成此操作的正确代码是：

```
static void Job2(Args _args)
{
   System.String decodedString;
   System.Byte[] buffer;
   System.IO.Compression.GZipStream gzip;
   System.IO.StreamReader reader; //<-- Reader instead of writer
   System.IO.MemoryStream output;
   InteropPermission permission;
   CLRObject ex;

   str compressedString ="Compressed data here";
   ;

   ttsBegin;
   permission = new InteropPermission(InteropKind::ClrInterop);
   permission.assert();

   buffer = System.Convert::FromBase64String(compressedString);
   output = new System.IO.MemoryStream(buffer);
   gzip = new System.IO.Compression.GZipStream(output, System.IO.Compression.CompressionMode::Decompress);

   try {
       //Reader code changes
       reader = new System.IO.StreamReader(gzip);
       decodedString = reader.ReadToEnd();
       reader.Close();
       //End reader code changes

       CodeAccessPermission::revertAssert();
   } 
   catch (Exception::CLRError) {
       //Code never executes past this point 
       ex = CLRInterop::getLastException();

       while(ex != null) {
           error(ex.ToString());
           ex = ex.get_InnerException();
       }
   }

   ttsCommit;
   info(decodedString);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:10:41.753

您能否在代码周围添加一个 try catch 以查看您得到的确切消息，因为 Ax 中有 2 个错误并不能真正告诉您发生了什么：

*   调用的目标已引发异常
*   无法创建 CLRObject

第一个是 .net 在 .NET 类型的构造函数中遇到问题，并且可能有多种原因，因此异常详细信息应该能够帮助您。

第二个可能更困难，因为它可能是无法找到的程序集。但在这种情况下，您可能会获得有关正在查找的文件的信息，并且应该将您带到 Ax 期望它们所在的位置。（出于这个原因，首先将您的程序集放在 Global Assembly 案例中当然是一个好主意。

要从异常中获取更多信息，您可以执行以下操作：

```
catch (Exception::CLRError)
{
     ex = ClrInterop::getLastException();
     if (ex != null)
     {
        ex = ex.get_InnerException();
        while (ex != null)
        {
            error(ex.ToString());
            ex = ex.get_InnerException();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T20:33:10.573

Kenny Saelen 的方法的问题在于，许多 CLRInterop 错误的级别如此之高，以至于它们会突破 Dynamics AX X++ catch 子句，而不管它是否被指定为捕获 Exception::CLRError。我以前在使用文件移动/删除等 System.IO 方法时遇到过这种情况。

更好地查看错误的一种方法（因为您无法在 X++ 中正确捕获它）是在 .NET 代码中重写您的工作并使用完全能够捕获该错误的 .NET catch 块。在 C# 控制台应用程序中构建对象并重新创建封装在 .NET try/catch 中的相同行为。

像这样的东西：

```
static void Main(string[] args)
{
    System.String decodedString;
    System.Byte[] buffer;
    System.IO.Compression.GZipStream gzip;
    System.IO.StreamWriter writer;
    System.IO.MemoryStream output;

    string compressedString = "sample";

    buffer = System.Convert.FromBase64String(compressedString);
    output = new System.IO.MemoryStream(buffer);
    gzip = new System.IO.Compression.GZipStream(output, System.IO.Compression.CompressionMode.Decompress);

    try
    {
        writer = new System.IO.StreamWriter(gzip);
        writer.Write(decodedString);
        writer.Close();

        Console.Write(decodedString);
        Console.ReadKey();
    }
    catch (Exception ex)
    {
        Console.Write(ex.Message);
        Console.ReadKey();
    }
} 
```

让我知道这是否适合你 Spankachu。

干杯

# c++ - C++ 整数模板参数评估

> ID：14407309
> 
> 赞同：3
> 
> 时间：2013-01-18T20:43:56.817
> 
> 标签：c++, templates, string-comparison, case-insensitive

这个问题可能非常简单，但我对 c++ 相当缺乏经验，并且在编写一个简单的解析器时被卡住了。由于某种原因，其中一个字符串比较函数在调用时不会返回预期值。该函数如下所示：

```
template<int length>
bool Parser::compare(const char *begin, const char *str){
   int i = 0;
   while(i != length && compareCaseInsensitive(*begin, *str)){
      i++;
      begin++;
      str++;
   }
   return i == length;
 }; 
```

此函数的目的是将运行时字符缓冲区与编译时常量字符串 vb 进行比较

```
compare<4>(currentByte, "<!--"); 
```

我知道有更有效的方法来比较固定长度的字符缓冲区（稍后使用），但是当我运行这个函数时我很困惑，它总是返回 false，即使有两个相同的字符串。

我检查了调试器并在循环结束时检查了 i 的值，它等于模板参数的值，但返回表达式仍为 false。关于使用 int 模板参数有什么特殊规则吗？我假设模板参数的行为类似于编译时间常数。

我不知道这是否相关，但我正在运行 gcc 的 g++ 编译器并使用 gdb 进行调试。

如果有人能告诉我可能导致此问题的原因，将不胜感激。

这段代码中用到的函数：

```
template<typename Character>
Character toLowerCase(Character c){
    return c > 64 && c < 91 ? c | 0x10 : c;
};

template<typename Character>
bool equalsCaseInsensitive(Character a, Character b){
    return toLowerCase(a) == toLowerCase(b);
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T09:47:11.067

为了进行不区分大小写的字符串比较，我会尝试使用具有签名的标头中的 STL 函数[std::strcoll](http://en.cppreference.com/w/cpp/string/byte/strcoll)`<cstring>`

```
int strcoll( const char* lhs, const char* rhs ); 
```

并根据当前语言环境比较两个以 null 结尾的字节字符串。或者，如果您想自己滚动，您仍然可以使用带有签名的标头中的[std::tolower](http://en.cppreference.com/w/cpp/string/byte/tolower)`<cctype>`

```
int tolower( int ch ); 
```

并根据当前安装的 C 语言环境定义的字符转换规则将给定字符转换为小写。

# javascript - 基元和对象

> ID：14407311
> 
> 赞同：3
> 
> 时间：2013-01-18T20:44:11.293
> 
> 标签：javascript

David Flanagan 的 Definitive JavaScript 对对象和基元进行了区分。

他将原语定义为 Number、String、Boolean、Null 和 Undefined，标准也是如此。

但是，将原始对象定义为对象的子集（即称它们为原始对象）会更准确吗？

因为它们有自己的方法并且是复杂的实体。

**实际问题**

在定义 String、Boolean 和 Number 时，Primitive Object 会比 Object 更准确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:56:20.727

对象和原语是不同的：

```
typeof 42 === "number"             
typeof new Number(42) === "object"
new Number(42) !== 42 
```

但是，在必要时，原语会自动被临时对象包装，这些临时对象可以[自动转换回原语](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/valueOf)：

```
(42).toString() === "42"
new Number(42) == 42
new Number(42) + 1 === 43 
```

尤其是在 Java 和 C# 编程语言的上下文中，这种行为称为[自动装箱](//en.wikipedia.org/wiki/Autoboxing)。由于包装对象具有一些令人困惑的特征，例如：

```
Boolean(new Boolean(false)) === true 
```

最好[避免有意将它们存储](https://stackoverflow.com/questions/369220/why-should-you-not-use-number-as-a-constructor)在变量中，而是尽可能使用原语。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:58:08.017

这与语义无关，请看：

```
var threePrimitive = 3;
var threeObject = new Number(3);

threePrimitive.toFixed(2); // 3.00
threeObject.toFixed(2); // 3.00

threePrimitive.foo = true
threeObject.foo = true;
threePrimitive.foo; // undefined
threeObject.foo; // true 
```

当您尝试对其调用方法时，基元被包装在对象中，但在初次使用后，该对象被丢弃。

* * *

至于规范中如何说明这一点，我不是 100% 确定，但这是我的想法（基于[Bergi 在他的答案之一中留下的提示](https://stackoverflow.com/a/13036273/825789)。第[11.2.1 节](http://es5.github.com/#x11.2.1)指出应该评估访问器属性如下：

> 1.  让 baseReference 成为评估 MemberExpression 的结果。
> 2.  设 baseValue 为`GetValue`( *baseReference* )。
> 
> (...)

然后在[8.7.1](http://es5.github.com/#x8.7.1)中我们看到以下内容：

> 当*V*是具有原始*基*值的属性引用时，GetValue 使用以下 [[Get]] 内部方法。使用 base 作为其`this`值并以属性*P*作为其参数来调用它。采取以下步骤：
> 
> 1.  令 O 为 ToObject(base)。
> 2.  令 desc 为使用属性名称 P 调用 O 的 [[GetProperty]] 内部方法的结果。
> 3.  如果 desc 未定义，则返回未定义。
> 4.  如果 IsDataDescriptor(desc) 为真，则返回 desc.[[Value]]。
> 5.  否则， IsAccessorDescriptor(desc) 必须为真，所以，
> 6.  让 getter 为 desc.[[Get]]。如果 getter 未定义，则返回未定义。
> 7.  返回调用 getter 的 [[Call]] 内部方法的结果，提供 base 作为 this 值并且不提供任何参数。
> 
> 注意 可能在步骤 1 中创建的对象在上述方法之外是不可访问的。实现可能会选择避免实际创建对象。使用此内部方法的这种实际属性访问可以产生可见效果的唯一情况是它调用访问器函数时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T20:56:31.060

> 在定义 String、Boolean 和 Number 时，Primitive Object 会比 Object 更准确吗？

*请注意，我并不是说数字不是这里的对象，而是指出它**看起来**模棱两可。这是让 JavaScript 新手感到困惑的事情。*

这种区别主要是学术上的，但有一种情况似乎模棱两可：文字表示原始对象，除非文字似乎表示数字。您不能将方法直接应用于文字 integer* 符号：

```
1.toString();
SyntaxError: identifier starts immediately after numeric literal 
```

…但你可以应用 Numbers 的方法：

```
Number(1).toString();
'1' 
```

…并且包含数字的名称是数字：

```
x = 4;
x.toString();
'4' 
```

我认为这实际上是一个解析问题，但我真的不知道为什么解析器不能`1`像判断“abc”是一个字符串那样容易地判断这是一个数字。我想这与`.`符号的语义歧义有关。（是小数点还是方法运算符？）

*JavaScript 实际上没有整数。我只是指一个完全由 组成的符号`[0-9]+`。

# php - 到达 javascript 中的 php 标记时，我的网页停止加载

> ID：14407314
> 
> 赞同：1
> 
> 时间：2013-01-18T20:44:26.147
> 
> 标签：php, javascript

我有一个以前在其他网站上从未有过的网站的问题，这可能很简单，但似乎无法理解。请查看并提出建议。

```
<!--All Header Elements-->
<?php 
$pageName = "Easy-Quote";
$siteName = "Bloemendal";
include("../Includes/header_non_index.inc"); 
include("../Includes/function12.inc"); 
?> <?php error_reporting (E_ALL ^ E_NOTICE); ?>
<!--All Header Elements-->
<body>
<script type="text/javascript">

var total = 0;

var allVenues = "";
var allVenuePricing = "";
var allTents = "";
var allTentPricing = "";
var allDFPricing = "";
var allMenus = "";
var allMenuPricing = "";
var allSF = "";

var venueName = "";
var venuePrice = 0;
var tentName = "";
var tentPrice = 0;
var DF = "";
var DFPrice = 0;
var menuName = "";
var menuPrice = 0;
var serviceFee = 0;

var getGuests = null;
var totalField = null;
var venueField = null;
var tentField = null;
var DFField = null;
var menuField = null;

//Get Fields
function getFields()
{
     getGuests = document.getElementById('Guests');
     totalField = document.getElementById('TotalField');
     depositField = document.getElementById('DepositField');
     venueField = document.getElementById('getValue');
     tentField = document.getElementById('getTent');
     DFField = document.getElementById('getDF');
     menuField = document.getElementById('getMenu');
     serviceField = document.getElementById('getServiceCharge');
}

function convertAllArrays()
{
    <?php
    $allVenues=getVenues(); 
    $allVenuePricing=getVenuePricing();
    $allTents=getTents(); 
    $allTentPricing=getTentPricing();
    $allDFPricing=getDFPricing();
    $allMenus=getMenus(); 
    $allMenuPricing=getMenuPricing();
    $allSF=getServiceFee(); 

    //##################Declaring All Arrays###########################\\
        echo "allVenues = ". json_encode($allVenues) . ";\n"; //All the Venue Names
        echo "allVenuePricing = ". json_encode($allVenuePricing) . ";\n"; //All the Venue Pricing
        echo "allTents = ". json_encode($allTents) . ";\n"; //All the Tent Names
        echo "allTentPricing = ". json_encode($allTentPricing) . ";\n"; //All the Tent Pricing 
        echo "allDFPricing = ". json_encode($allDFPricing) . ";\n"; //All the Dance Floors
        echo "allMenus = ". json_encode($allMenus) . ";\n"; //All the Menu Names
        echo "allMenuPricing = ". json_encode($allMenuPricing) . ";\n"; //All the Menu Pricing
        echo "allSF = ". json_encode($allSF) . ";\n"; //All the Service Fees
    ?>
}

function activeControl()
{

    //Check Venue Field
    if(getGuests.value > 0)
    {
        venueField.disabled = false;
    }else{
        venueField.options[0].selected = true;
        venuePrice = 0;
        venueName = "";
        venueField.disabled = true; 
    }

    //Check Tent Field
    if(venueField.selectedIndex == 1)
    {
        tentField.disabled = false;
    }else{  
        tentPrice = 0;
        tentName = "";
        tentField.options[1].selected = true;
        tentField.disabled = true;
    }

    //Check Menu Field
    if(venueField.selectedIndex > 0)
    {
        menuField.disabled = false;
    }else{
        menuPrice = 0;
        menuName = "";
        menuField.options[0].selected = true;
        menuField.disabled = true;  
    }

    //Check Dance Floor Field
    if(venueField.selectedIndex == 1)
    {
        DFField.disabled = false;
    }else{
        DFField.checked = false;
        DF = "No";
        DFPrice = 0;
        DFField.disabled = true;    

    }

    updateTotal();
}

function updateTotal()
{   

    //Get Venue Details 
    var getSelectedVenue = venueField.selectedIndex;
    if(getSelectedVenue > 0)
    {
        venueName = allVenues[getSelectedVenue];
        venuePrice = allVenuePricing[getSelectedVenue]
    }

    //Get Tent Details  
    var getSelectedTent = tentField.selectedIndex;
    if(getSelectedTent > 1)
    {
        tentName = allTents[getSelectedTent-1];
        tentPrice = allTentPricing[getSelectedTent-1]
    }else if(getSelectedTent == 1)
    {
        tentName = "";
        tentPrice = 0;
    }

    //Get DF Details    
    if(DFField.checked)
    {
        DF = "Yes";
        DFPrice = allDFPricing[1];
    }else
    {
        DF = "No";
        DFPrice = 0;
    }

    //Get Menu Details  
    var getSelectedMenu = menuField.selectedIndex;
    if(getSelectedMenu > 0)
    {
        menuName = allMenus[getSelectedMenu];
        menuPrice = allMenuPricing[getSelectedMenu]
    }

    //Get Service Fee Details   
    var getSelectedSF =serviceField.selectedIndex;
    if(getSelectedSF > 0)
    {
        serviceFee = allSF[getSelectedSF];
    }

    venuePrice = parseFloat(venuePrice,10);
    tentPrice = parseFloat(tentPrice,10);
    DFPrice = parseFloat(DFPrice,10);
    menuPrice = parseFloat(menuPrice,10);
    serviceFee = parseFloat(serviceFee,10);

    //Update Total Field
    total = venuePrice + tentPrice +DFPrice + (menuPrice*getGuests.value);
    total = total + (total*serviceFee);
    totalField.value = "R"+total;

    //Update Deposit Fee
    depositField.value = "R"+(total*0.3);
}

</script>
<!--Global Elements--> 
```

这是该站点的前 196 行。离线加载，但是当上传到网络服务器时，它最多只能上传：

```
function convertAllArrays()
{ 
```

PS：我知道在 javascript 中调用 php 变量并不理想，但它应该足以满足我的目的。

！！编辑！！
网站链接：[http ://bloemendal.co.za/Easy-Quote/](http://bloemendal.co.za/Easy-Quote/)

！！编辑！！
function12.inc 中的前几行代码包括。getVenues() 等函数在此声明，包括：

```
<?php
//############################Venues###############################\\
function getVenues()
{
    include("../Includes/db_bloem_01_logon.inc");             
                $cxn = mysqli_connect($host,$user,$passwd,$dbname);
                $query = "SELECT VenueName FROM venues WHERE ID < 5";
                $results = mysqli_query($cxn, $query) or die ("Could't execute query");

      $allVenues= array();

        $counter = 1;
        while($row = mysqli_fetch_assoc($results))
        {
              extract ($row);
              $allVenues[$counter] = "$VenueName";
              $counter++;
        }     
    return $allVenues;
}

function getVenuePricing()
{
    include("../Includes/db_bloem_01_logon.inc");             
                $cxn = mysqli_connect($host,$user,$passwd,$dbname);
                $query = "SELECT Price FROM venues WHERE ID < 5";
                $results = mysqli_query($cxn, $query) or die ("Could't execute query");

      $allVenuePricing= array();

        $counter = 1;
        while($row = mysqli_fetch_assoc($results))
        {
              extract ($row);
              $allVenuePricing[$counter] = "$Price";
              $counter++;
        }     
    return $allVenuePricing;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:02:51.507

当您在脚本中有 php 并且 php 抛出错误时，错误会打印在脚本标记中，因此它不会显示在您的浏览器上。您的 javascript 中的 php 可能存在问题。将 php 移到脚本标记之外，以确保它运行时没有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:00:51.403

你的代码

```
$allVenues=getVenues(); 
```

您不能将值分配给 php 变量作为 JavaScript 函数的返回

当 PHP 解释器读取您的代码并构建要提供的网页时，获取**$allVenues**的值并将其放入页面中。假设该变量为**null**：提供给浏览器的代码行将是

```
null=getVenues(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:17:31.087

功能

```
mysqli_fetch_assoc 
```

不存在（据我所知）

有一个

```
mysql_fetch_assoc 
```

没有改进的mysql

（但已弃用）

# vb.net - 将混合字典键传递到 Excel 范围

> ID：14407317
> 
> 赞同：2
> 
> 时间：2013-01-18T20:44:42.417
> 
> 标签：vb.net, excel-interop

我正在尝试将混合字典键转储到 excel 工作表范围，但它没有按预期执行。这是我的代码。

```
 Dim ExcelApplication As Excel.Application = New Excel.Application
    Dim ExcelWorkbook As Excel.Workbook = ExcelApplication.Workbooks.Add
    Dim SheetName As String = "Area Information"
    Dim ExcelAreaBalanceWorksheet As Excel.Worksheet = CType(ExcelWorkbook.Sheets(1), Excel.Worksheet)
    Dim BAGenByKVDictionary As New HybridDictionary

   'code to populate hybriddictionary

    Dim Rng As Excel.Range = ExcelAreaBalanceWorksheet.Range("a1", _
                ExcelAreaBalanceWorksheet.Cells(BAGenByKVDictionary.Count, 1))
    Rng.Value = ExcelApplication.WorksheetFunction.Transpose(BAGenByKVDictionary.Keys.ToString) 
```

当我尝试将密钥传递给 Excel 时，它会传递`System.Collections.Hashtable+ValueCollection`所有单元格而不是传递密钥。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T01:15:02.997

这是因为[HybridDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.hybriddictionary_methods.aspx)上的 ToString()不会覆盖定义的基本`Object`实现，部分[定义](http://msdn.microsoft.com/en-us/library/system.object.tostring.aspx)为：

> ToString 方法的默认实现返回 Object 类型的完全限定名...

为了将键作为字符串数组检索，有很多方法，但我总是更喜欢最直接的方法，即循环：

```
 Dim sbKeys As New System.Text.StringBuilder(1000)

    For Each oKey As Object In BAGenByKVDictionary.Keys
        ' Produce a comma=separated list
        If sbKeys.Length <> 0 Then
            sbKeys.Append(",")
        End If
        sbKeys.Append(oKey.ToString())
    Next

    Rng.Value = ExcelApplication.WorksheetFunction.Transpose(sbKeys.ToString()) 
```

# asp.net-mvc - 可用于 MVC 的支付系统/sdk？答案基于 1\. 无错误，2\. 性能高效，3\. 最常用的技术

> ID：14407318
> 
> 赞同：0
> 
> 时间：2013-01-18T20:44:46.103
> 
> 标签：asp.net-mvc, asp.net-mvc-4, payment, payment-processing

就像在标题中一样，我想知道您推荐使用哪种支付系统？也许某些现有系统比其他系统更好（例如更容易实施）？

到目前为止，我只尝试了用于 c# 的 paypal sdk。但您对此有何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:35:26.460

这只是个人喜好，所以要物有所值。我对[Chargify](http://chargify.com/)很幸运。[C# 库](http://www.nuget.org/packages/chargify)运行良好，它支持订阅和重复计费、优惠券代码、折扣和计量计费。

[Cheddergetter](https://cheddargetter.com/)是 Chargify 的替代品，它也有 .NET 库。

我发现这比尝试让[Authorize.net](http://developer.authorize.net/integration/fifteenminutes/csharp/)正常工作要容易得多，而且我更喜欢它而不是只接受 PayPal。

# php - 如何更改 curl 内容刮板的标题位置

> ID：14407322
> 
> 赞同：0
> 
> 时间：2013-01-18T20:45:06.200
> 
> 标签：php, curl, http-headers, screen-scraping, http-head

我正在使用 curl 从英国托管的 url 中抓取内容。当我在美国的浏览器中查看该网站时，它以美元显示产品定价，但当我使用 curl 检索内容时，它以欧元返回。我需要它以美元返回，就好像您在美国的浏览器中查看它一样。下面是我正在使用的代码

```
 function LoadCURLPage($url, $agent = "Mozilla/5.0 (Windows; U; Windows NT 5.0; en-us; rv:1.4)
 Gecko/20030624 Netscape/7.1 (ax)", 
$cookie = '', $referer = '', $post_fields = '', $return_transfer = 1, 
$follow_location = 1, $ssl = '', $curlopt_header = 1)
{

$ch = curl_init(); 

curl_setopt($ch, CURLOPT_URL, $url);

if($ssl)
{
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,  2);
}

curl_setopt ($ch, CURLOPT_HEADER, $curlopt_header);
curl_setopt ($ch, CURLOPT_HTTPHEADER,array('User-agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.16) Gecko/20080702 Firefox/2.0.0.16', 'Accept-language: en-us,en;q=0.7,bn;q=0.3', 'Accept-charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7'));

if($agent)
{
curl_setopt($ch, CURLOPT_USERAGENT, $agent);
}

if($post_fields)
{
curl_setopt($ch, CURLOPT_POST, 1); 
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields); 
}

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);

if($referer)
{
curl_setopt($ch, CURLOPT_REFERER, $referer);
}

if($cookie)
{
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie);
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie);
}

$result = curl_exec ($ch);

curl_close ($ch);

return $result;
}

 // the url
 $url = "http://us.asos.com/Adidas-Honey-Silver-Mid-Sneakers/ysrqb/?iid=2212284";

//the function 
echo LoadCURLPage($url); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:09:49.280

它在一个饼干里。因此，要么访问设置该 cookie 的页面，要么编辑您的 cookiejar 文件。

# string - 从变量中选择

> ID：14407328
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:45:45.667
> 
> 标签：string, variables, select, plsql

这可能是一个简单的。基本上在 Oracle 的 PL/SQL 中，我从另一个数据库中进行选择：

```
select * From Store@dbstore.p009061; 
```

我想要的是值 061 将来自变量名（myStore）。

所以它会是这样的：

```
select * from STORE@DBSTORE.P||myStore||'081'; 
```

请记住上面的 myStore 将保存值 061。

但是上面的不行吗？有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:52:48.223

嗯，你不能直接在查询中这样做，你必须使用动态 sql。

就像是

```
declare
myStore varchar2(10):='061';
begin
EXECUTE IMMEDIATE 'SELECT * FROM STORE@DBSTORE.P'||myStore||'081';
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:20:09.947

或者它应该是这样的？

```
declare
    myStore varchar2(10):='061';
    sStoreCode varchar2(10):='061';
begin
    EXECUTE IMMEDIATE 'SELECT * FROM STORE@BNSTORE.P'||myStore
                                            ||'081 where storecode='||sStoreCode;

end; 
```

# c# - 处理后的复选框

> ID：14407332
> 
> 赞同：2
> 
> 时间：2013-01-18T20:45:56.377
> 
> 标签：c#, winforms

在处理每个已检查的项目后，我正在尝试取消选中一个`checkboxlist`项目，但我不知道该怎么做。

代码的基本概要

```
string selectedNote="";
foreach (object itemChecked in chkbxSnVisits.CheckedItems)
{
DataRowView drView = itemChecked as DataRowView;
selectedNote = drView["id"].ToString() + " -- " + drView["visit"].ToString();

//do a bunch of stuff
//uncheck itemChecked
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:50:50.137

它有点像，

```
 foreach (int i in chkbxSnVisits.CheckedIndices)
        {
            chkbxSnVisits.SetItemCheckState(i, CheckState.Unchecked);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:46:52.380

我是怎么做的

```
ChechkBoxList chklist;
var chkListCheck = from ListItem item from chklist.Items where item.selected select item;

foreach(ListItem item in chkListCheck ){
item.selected = false;
} 
```

我不知道 CheckBoxList 对象的 CheckedItem 属性，但是，为了保持这一点，你可以这样做

```
foreach(ListItem item in chkListCheck.CheckedItems){
item.selected = false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:07:00.837

You should use `async/await` to make your program easier to write and allows easy updating of the UI without all those pesky `Invoke` calls:

Check out this example:

```
async void runCheckedTasks_Click(object sender, EventArgs e)
{
  var button = sender as Button;
  if (button == null) return;

  checkListBox.Enabled = false;
  button.Enabled = false;
  button.Text = "Running...";

  var items = checkListBox.CheckedIndices;
  await DoCheckedTasks(items);

  checkListBox.Enabled = true;
  button.Enabled = true;
  button.Text = "Go!";
}

async Task DoCheckedTasks(CheckedListBox.CheckedIndexCollection indicies)
{
  foreach (int i in indicies)
  {
    // Here you cast to whatever type you are storing in the CheckListBox.
    // I am only using strings like 'First Task', 'Second Task', ...
    var item = checkListBox.Items[i] as string;

    checkListBox.Items[i] = string.Format("Processing {0}...", item);
    checkListBox.SetItemCheckState(i, CheckState.Indeterminate);

    var result = await DoTask(i);

    if(!result)
      checkListBox.Items[i] = string.Format("{0} Failed!", item);
    else
      checkListBox.Items[i] = string.Format("{0} Successful!", item);

    checkListBox.SetItemCheckState(i, CheckState.Unchecked);
  }
}

async Task<bool> DoTask(int index)
{
  var rand = new Random();

  await Task.Delay(3000); // Fake Delay to simulate processing

  var d20 = rand.Next(0, 20) + 1; // Roll a d20, >=10 to pass
  return d20 >= 10;
} 
```

# css - 如何阻止外部访问css

> ID：14407338
> 
> 赞同：1
> 
> 时间：2013-01-18T20:46:18.257
> 
> 标签：css, .htaccess, block

有人试图窃取我的 css 文件以在他的网站上使用。我可以以某种方式阻止外部访问 CSS 文件，但不会损坏我的网站吗？不知何故通过htaccess之类的。感谢您的建议，任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T20:52:56.130

使用 PHP 生成 CSS，`style.css.php`并在代码中接受每秒刷新的令牌。您的主页将使用当前令牌包含它`src="style.css.php?token=abc123"`。如果令牌是有效的，它会提供它。如果令牌已过期，则不会。

有史以来最愚蠢的解决方案。无尽的变通方法，但可能有助于对付想要窃取您的 CSS 的人。值得一试并开怀大笑。

**第 1 步**：在数据库中创建一个`css_security_force`包含一列的表`token`

**第 2 步**：创建一个**每秒**运行的 cron来更新令牌（现在这是安全的）：

```
UPDATE css_security_force SET token = md5( NOW() ); 
```

**第 3 步**：在您的 PHP 头中，从`css_security_force`表中获取标记并将其设置为变量`$token`，然后在 CSS 链接中引用该标记：

```
<link rel="stylesheet" href="style.css.php?token=<?=$token?>" /> 
```

**第 4 步**：在您的`style.css.php`文件中，从数据库中获取令牌并对照查询参数进行检查。

```
if ($_GET['token'] == $token) {
    echo <<<CSS
        body {
            background-color : yellow;
            color : pink;
        }
CSS;
} else {
    echo 'Stop stealing my CSS!!!!!!';
} 
```

坐下来，看着你的敌人的计划在他面前崩溃。

**编辑** 我很好奇并做了一个~~[工作演示](http://www.aliencreations.com/stackoverflow/css-security-force/)~~（*出于理智目的，经过几天的 1 秒数据库更新后将其删除，但您可以使用下面发布的源轻松重新创建*）。

这是[Github上的源代码](https://github.com/SeanCannon/cssSecurityForce)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T20:48:29.940

不，这没有任何意义。如果您希望页面样式化，任何可以查看您网站的人都必须可以使用您的 CSS 文件。

谁在乎是否有人使用你的风格？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T20:53:15.153

简单地说，您不能阻止它，因为浏览器必须有权访问它们。这只是您不应该担心的事情之一。如果可能的话，Facebook 和 Twitter 等许多网站都会屏蔽它。

# php - 在单个 WordPress 帖子页面上基于自定义元字段显示相关帖子？

> ID：14407348
> 
> 赞同：1
> 
> 时间：2013-01-18T20:47:17.977
> 
> 标签：php, wordpress

我目前正在为我的一个 DJ 朋友创建一个网站，他将他的混音上传到 Soundcloud 进行分享，他还将使用他的网站发布他的混音（通过 Soundcloud）并发布活动。

为了处理事件方面的事情，而不是使用自定义帖子类型，我只是将自己的元字段添加到标准帖子屏幕，并设置帖子以显示事件信息（如果已设置），并正常显示帖子如果不。[完整代码](http://pastebin.com/2UDjBjCU)，相关部分：

```
global $wp_query;
$postid = $wp_query->post->ID;
$event_venue = get_post_meta($postid, 'event_venue', true); 
```

除此之外，为了处理他的混音，我设置了一个自定义帖子类型（通常是为了让他更容易区分，因为他在混音器和转盘之外并不是非常精通技术）和自定义元字段以允许他添加录制混音的位置（场地方面）和他的混音的 soundcloud URL（用于在帖子中自动嵌入混音，而不是使用插件）。我创建了一个自定义循环和`single-mixes.php`页面来处理数据的显示，它本质上是原始循环（重命名为`loop-mixes.php`所以我知道是什么），但包含一个文件`mix_data.php`. [完整代码](http://pastebin.com/JgPrrBP2)，相关部分：

```
global $wp_query;
$postid = $wp_query->post->ID;
$mix_venue = get_post_meta($postid, 'mix_venue', true); 
```

现在，我的问题。我想在单个帖子页面中将保存的数据`$mix_venue`与已`$event_venue`设置的所有其他帖子进行比较，并显示那些匹配的帖子（即，如果用户正在查看混合，他们可以看到任何即将发布的在记录它的场地举行的活动（实际上是任何过去的活动）。

**但是**，我正在自学 WordPress，我真的不完全确定从哪里开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:13:04.757

我看到你解决了它，但我会建议一种可重复使用的方法。

在你的主题中`functions.php`放置这个函数（完整的[参数列表](http://codex.wordpress.org/Class_Reference/WP_Query)`get_posts()`）：

```
function print_event_venues( $mix_venue )
{   
    $args = array(
        'numberposts' => -1,
        'post_type'   => 'post',
        'post_status' => 'publish',
        'meta_key' => 'event_venue', 
        'meta_value' => $mix_venue
        );
    $posts = get_posts( $args );

    // DO NOTHING
    if( !$posts )
        return;

    foreach( $posts as $post )
    {
        // DO YOUR HTML
        echo $post->post_title;
    }
} 
```

然后，在任何模板中，只需调用它：`print_event_venues( $the_mix_venue );`.

有用信息：[什么时候应该使用 WP_Query、query_posts() 和 get_posts()？](https://wordpress.stackexchange.com/q/1753/12615).

# hadoop - 作业完成后如何更改distributedCache的内容？

> ID：14407349
> 
> 赞同：0
> 
> 时间：2013-01-18T20:47:20.300
> 
> 标签：hadoop, mapreduce

有没有办法在作业完成后更改与distributedCache 关联的文件的内容，并在之后的另一个map/reduce 作业中用作新的distributedCache？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T12:02:59.820

检查[TrackerDistributedCacheManager.java](http://svn.apache.org/repos/asf/hadoop/common/tags/release-1.1.1/src/mapred/org/apache/hadoop/filecache/TrackerDistributedCacheManager.java)代码以获取更多详细信息。Hadoop 会记录有多少任务正在使用 DistributedCache 中的文件。如果计数降至 0，则文件标记为删除。因此，在作业结束时，将清理 DistributedCache 中的文件，否则它们将继续跨作业堆积在节点上。

因此，您无法更改分布式缓存中的文件并在连续作业中使用它。

# c++ - 在 Visual C++ 2010 中安装 Magick++

> ID：14407353
> 
> 赞同：0
> 
> 时间：2013-01-17T10:25:29.103
> 
> 标签：c++, windows, magick++

我最近为 C++ 安装了 ImageMagick 库。我之前没有使用 C++ GUI 的经验，但我非常擅长 C++ 命令行编程。

我已经通过 .exe 文件在 Windows 中安装了 ImageMagick，并将库和头文件复制到 C++，但是每当我尝试运行任何演示程序时，我总是会收到此错误：

```
1>------ Build started: Project: Sufiyan, Configuration: Debug Win32 ------
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: virtual __thiscall Magick::Image::~Image(void)" (__imp_??1Image@Magick@@UAE@XZ) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall Magick::Image::write(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > const &)" (__imp_?write@Image@Magick@@QAEXABV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: void __thiscall Magick::Image::pixelColor(long,long,class Magick::Color const &)" (__imp_?pixelColor@Image@Magick@@QAEXJJABVColor@2@@Z) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: virtual __thiscall Magick::Color::~Color(void)" (__imp_??1Color@Magick@@UAE@XZ) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Magick::Geometry::~Geometry(void)" (__imp_??1Geometry@Magick@@QAE@XZ) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Magick::Image::Image(class Magick::Geometry const &,class Magick::Color const &)" (__imp_??0Image@Magick@@QAE@ABVGeometry@1@ABVColor@1@@Z) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Magick::Geometry::Geometry(char const *)" (__imp_??0Geometry@Magick@@QAE@PBD@Z) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) public: __thiscall Magick::Color::Color(char const *)" (__imp_??0Color@Magick@@QAE@PBD@Z) referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol "__declspec(dllimport) void __cdecl Magick::InitializeMagick(char const *)" (__imp_?InitializeMagick@Magick@@YAXPBD@Z) referenced in function _main
1>MSVCRTD.lib(crtexew.obj) : error LNK2019: unresolved external symbol _WinMain@16 referenced in function ___tmainCRTStartup
1>C:\Users\Z-Axis\documents\visual studio 2010\Projects\Sufiyan\Debug\Sufiyan.exe : fatal error LNK1120: 10 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

这些是我的笔记本电脑规格：

*   视窗 7 64 位。
*   Visual C++ 2010 速成版 x86
*   ImageMagick x86

这就是我尝试安装它的方式：

1.  安装 Visual C++ 2010 Express
2.  安装 ImageMagick
3.  复制 ImageMagick Lib 并包含在 Visual C++ 2010 中
4.  选择 Win32 -> Windows -> 空项目（无效）
5.  选定的 Win32 -> DLL（不起作用）
6.  选定的 Win32 -> 静态（不起作用）

但是当我运行任何代码时，它会给出上面提到的错误。

有人提出了这个解决方案：

> 你需要一个起点，去
> c:\Program Files\ImageMagick-6.8.1-Q16\Magick++_demos。
> 单击按钮工作区、构建和运行。
> 假设这是成功的，请将按钮工作区用作您自己的自定义代码的模板。

我也尝试了几十次，并且不断收到此错误：

> 项目必须转换为当前的 Visual C++ 项目格式。
> 转换后，您将无法在以前版本的 Visual Studio 中编辑此项目。转换并打开这个项目？

当我单击`Yes`没有任何反应时，屏幕上什么也没有显示 - 没有打开项目的空白 Visual C++ 屏幕。

我非常想知道：是什么导致了这个错误，为什么演示程序也不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T17:58:53.650

尝试自己构建 ImageMagick，问题可能来自不同版本的编译器。

按照[ImageMagick 的高级 Windows 安装中的说明进行操作](http://www.imagemagick.org/script/advanced-windows-installation.php)。在上一页的最后，有链接错误的解决方法，确保你已经设置了预处理器。我只是按照它成功构建了一个项目。

# java - Java Bloomberg API - 如何在没有服务的情况下生成请求

> ID：14407360
> 
> 赞同：3
> 
> 时间：2013-01-18T20:47:49.783
> 
> 标签：java, bloomberg

我正在使用 Bloomberg API 来获取数据。目前，根据开发人员指南，我有 3 个进程以典型方式获取数据。就像是：

```
Service refDataService = session.getService("//blp/refdata");
Request request = refDataService.createRequest("ReferenceDataRequest");
request.append("securities", "IBM US Equity");
request.append("fields", "PX_LAST");
cid = session.sendRequest(request, null); 
```

这样可行。现在我想将逻辑扩展为更像一个更新队列。我希望每个进程都将他们的请求发送到更新队列进程，该进程又负责创建会话和服务，然后发送请求。但是，我没有看到没有服务创建请求的任何方法。此外，由于请求类型（参考数据、历史数据、日内报价）如此多样并且具有如此不同的属性，因此创建一个我的更新队列可以读取的容器对象并非易事。

关于如何做到这一点的任何想法？我的最终目标是拥有一个进程（我正在调用更新队列），它接收请求列表，删除所有重复项，并以 30 秒的间隔向彭博社发送数据。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:13:02.530

我更新了[jBloomberg](https://github.com/assylias/jBloomberg)库以包含刻度数据。您可以向充当队列的[BloombergSession](http://assylias.github.com/jBloomberg/apidocs/assylias/jbloomberg/BloombergSession.html)提交不同类型的查询。因此，如果您想提交不同类型的请求，您可以编写如下内容：

```
RequestBuilder<IntradayTickData> tickRequest =
    new IntradayTickRequestBuilder("SPX Index",
        DateTime.now().minusHours(2),
        DateTime.now());

RequestBuilder<IntradayBarData> barRequest =
    new IntradayBarRequestBuilder("SPX Index",
        DateTime.now().minusHours(2),
        DateTime.now())
        .period(5, TimeUnit.MINUTES);

RequestBuilder<ReferenceData> refRequest =
    new ReferenceRequestBuilder("SPX Index", "NAME");

Future<IntradayTickData> ticks = session.submit(tickRequest);
Future<IntradayBarData> bars = session.submit(barRequest);
Future<ReferenceData> name = session.submit(refRequest); 
```

[javadoc](http://assylias.github.io/jBloomberg/apidocs/index.html)中提供了更多示例。

如果您需要定期获取相同的信息，您可以重用构建器并将其与[ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html)结合使用。

注意：该库仍处于测试状态，所以不要在自动交易的黑匣子中盲目使用它！

# jquery - jQuery UI 多选在作为母版页内容的 .aspx 页面中不起作用

> ID：14407362
> 
> 赞同：1
> 
> 时间：2013-01-18T20:47:58.397
> 
> 标签：jquery, asp.net, jquery-ui, gridview, master-pages

我正在尝试在具有许多不同网格视图的 aspx 页面上使用此 jquery 插件（ [http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/ ）。](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/)页面代码位于 asp:content 标记内。我将我的选择选项放在 asp:gridview 之外的 asp:view 中。该页面使用母版页。我的多选小部件在空白页面中工作，但我无法让它与我的母版页一起工作。我已经尝试在我正在使用的 gridview 中添加我的 css/script links/document.ready() 。我尝试使用母版上的 asp:contentplaceholder 和我的 aspx 页面中的单独 asp:content 标记将其添加到母版页的 head 标记。我一生都无法获得多选来处理小部件的 UI。

我注意到在带有工作小部件的空白页面上，jquery 添加了一个按钮和几个跨度，其中包含设置多选样式所需的类。在我的 aspx 页面中，没有添加这些项目。

```
<button type="button" class="ui-multiselect ui-widget ui-state-default ui-corner-all" 
aria-haspopup="true" style="width: 240.60000002384186px;">
<span class="ui-icon ui-icon-triangle-2-n-s"></span><span>5 selected</span></button>

//My Code
<link rel="Stylesheet" type="text/css" href="../Styles/jquery-ui-1.9.1.custom.min.css" />
<link rel="stylesheet" href="../Styles/jquery.multiselect.css" type="text/css" />
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js" type="text/javascript"></script>
<script src="../Scripts/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>
<script src="../Scripts/jquery.multiselect.min.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#example").multiselect({
            minWidth: 235
        });
        $("#example").multiselect("checkAll");
    });
</script>

<select id="example" name="example" multiple="multiple">
            <option value="1">Option 1</option>
            <option value="2">Option 2</option>
            <option value="3">Option 3</option>
            <option value="4">Option 4</option>
            <option value="5">Option 5</option>
</select> 
```

我尝试删除母版页中的所有其他 css/脚本引用，但没有奏效。是否还有其他可能相互冲突的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:33:34.853

您正在成为 的受害者[`Control.ClientIDMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)，即`inherit`：

**选项1：**

更改您的脚本以使用动态创建的 ClientID：

```
<script type="text/javascript">
    $(document).ready(function () {
        var sel = #<%= example.ClientID %>";
        $(sel).multiselect({
            minWidth: 235
        });
        $(sel).multiselect("checkAll");
    });
</script> 
```

**选项 2：**

让您的脚本保持原样并将 ClientIDMode 更改为静态：

```
<select id="example" name="example" multiple="multiple" ClientIDMode="Static">
            <option value="1">Option 1</option>
            <option value="2">Option 2</option>
            <option value="3">Option 3</option>
            <option value="4">Option 4</option>
            <option value="5">Option 5</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T17:01:23.577

我以错误的顺序加载脚本。

# haskell - yesodweb -example 和输出中的额外标签

> ID：14407372
> 
> 赞同：1
> 
> 时间：2013-01-18T20:48:12.107
> 
> 标签：haskell, yesod

请考虑以下三个非常相似的页面。

```
{-# LANGUAGE OverloadedStrings, TypeFamilies, QuasiQuotes,
         TemplateHaskell, MultiParamTypeClasses #-}
import Yesod
import Control.Applicative
import Data.Text (Text)
import Text.Hamlet

data Example = Example

mkYesod "Example" [parseRoutes|
/ RootR GET
/page PageR GET
/page2 Page2R GET
|]

instance Yesod Example

getRootR :: GHandler sub Example RepHtml
getRootR = do
    defaultLayout [whamlet|
$doctype 5
<html>
   <head>
     <title>Tutorial, hello root
   <body>
     <h1 id="greeting">Hello root
|]

getPageR :: GHandler sub Example RepHtml
getPageR = defaultLayout $ do
    toWidgetHead [hamlet| <meta charset="utf-8"> |]
    setTitle "hello page"
    toWidget [hamlet|
<h1 id="greetings2">Hello page
|]

getPage2R :: GHandler sub Example RepHtml
getPage2R = defaultLayout $ do
    toWidget [hamlet|
$doctype 5
<html>
   <head>
     <title>Tutorial, hello page2
   <body>
     <h1 id="greeting">Hello page2
|]

main :: IO ()
main = warpDebug 3000 Example 
```

RootR 和 page2 提供相同的输出（我的意思是标签和结构），而“页面”与两者略有不同。输出首先是“root”和“page2”：

```
<!DOCTYPE html>
<html><head><title></title></head><body><!DOCTYPE html>
<html><head><title>Tutorial, hello page2</title>
</head>
<body><h1 id="greeting">Hello page2</h1>
</body>
</html>
</body></html> 
```

而“page”的输出是

```
<!DOCTYPE html>
<html><head><title>hello page</title><meta charset="utf-8"> </meta>
</head><body><h1 id="greetings2">Hello page</h1>
</body></html> 
```

为什么“root”和“page2”中有额外的& -标签？我应该在代码中添加一些东西还是拿走一些东西？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:58:39.247

该`default-layout`函数已经包含`doctype`etc...，并且您将在 root 和 page2 中再次添加它。

# php - MySQL/PHP 存储多个数据点

> ID：14407373
> 
> 赞同：0
> 
> 时间：2013-01-18T20:48:20.130
> 
> 标签：php, mysql

我对编程和数据库比较陌生。

我有一个带有“销售”表的 MySQL 数据库。该表列出了一个州的所有销售（即每条记录都是一个特定的销售），其中包含卖家名称和买家压缩字段。我想有另一个表“卖家”，其中包括卖家名称，还包括通过邮政编码定义卖家市场区域的字段——比如 50 多个邮政编码定义一个市场，卖家可以定义多个市场。

这些市场区域将用于未来的查询：显示特定市场区域的所有销售。

我从哪里开始考虑如何存储“市场区域”数据，然后将其用于将来的查询？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:39:23.437

# 表结构：

*   销售表：ID、sellerID、buyerZipcode、amount
*   卖家表：ID、卖家姓名
*   市场表：ID、市场名称
*   SellerMarketLink 表：ID、sellerID、marketID
*   MarketZipCode 表：ID、marketID、邮政编码

# 示例数据

对问题的第一条评论中的信息进行编码

## 市场表

1、“A店第一市场”
2、“A店第二市场”
3、“B店市场”

## 市场邮编表

1, 1, 1
2, 1, 2
...
7, 1, 7
8, 1, 8
9, 2, 4
10, 2, 5
...
14, 2, 9
15, 2, 10
16, 3, 1
17, 3, 2
18, 3, 3
19, 3, 8
20, 3, 9
21, 3, 10
22, 3, 11
23, 3, 12

# 询问

每个卖家在市场上的总销售额。请注意，由于一个邮政编码可以是多个市场的一部分，因此“总销售额”中所有值的总和可能大于“销售额”表中所有“金额”值的总和。

```
select Market.marketName, Seller.sellerName, sum(Sales.amount) as "Total Sales"
from Sales join Seller join SellerMarketLink join Market join MarketZipCode
on (Sales.sellerID = Seller.ID AND Seller.ID = SellerMarketLink.sellerID 
  AND SellerMarketLink.marketID = Market.ID 
  AND Market.ID = MarketZipCode.marketID 
  AND MarketZipCode.zipCode = Sales.buyerZipCode)
group by Market.ID, Market.marketName, Seller.ID, Seller.sellerName
order by Market.marketName, Seller.sellerName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T20:54:10.097

我将在这里做以下假设：

1.  卖家有很多市场
2.  一个市场可以跨越许多邮政编码
3.  只有一个卖家负责一个市场
4.  市场不能重叠

导致以下结构...

销售表卖家| 买家zip

市场表市场| market_zipcodes_id

邮政编码表market_id | 邮政编码

希望有帮助...

# ruby-on-rails - 我应该迁移到 MongoDB 以避免 Rails 中的 SQL 注入漏洞吗？

> ID：14407375
> 
> 赞同：2
> 
> 时间：2013-01-18T20:48:28.467
> 
> 标签：ruby-on-rails, mongodb, database-design, security, sql-injection

最近披露的 Rails SQL 注入漏洞引起了人们的极大关注。我不擅长处理安全问题，所以我很紧张。我听说 MongoDB 不容易受到这种攻击。

这是永久迁移到 MongoDB 的好理由吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:52:42.080

不，仅仅因为 SQL 数据库容易受到 SQL 注入攻击，并不是迁移到 MongoDB 的好理由。

MongoDB 在某些用例中非常有用，特别是在您需要无模式集合的情况下。

如果您需要存储关系数据，关系数据库将为您提供更好的服务。

简而言之，如果您害怕 SQL 注入，请学习如何清理您的输入。不要迁移到 MongoDB。

新发现的漏洞不会影响所有人。[阅读此处](http://blog.phusion.nl/2013/01/03/rails-sql-injection-vulnerability-hold-your-horses-here-are-the-facts/)了解更多详情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:10:28.463

SQL 注入是一个已知数十年且广为人知的问题。当您遵守它们时，有一些编码实践使 SQL 注入完全不可能：

*   在将所有变量放入查询之前，通过转义函数运行所有变量
*   使用准备好的语句
*   使用存储过程

始终至少使用其中一种做法，您不必害怕 SQL 注入。

另一方面，MongoDB 是一项相当新的技术。目前尚不清楚哪种新手错误将是最典型的导致易受攻击的应用程序。也许有些事情就像 SQL 注入一样糟糕，每个人现在都在做却没有意识到。也许这个漏洞已经在黑帽黑客之间流传了。谁知道？

此外，正如 CodeGnome 所指出的，MongoDB 并不是 SQL 数据库的直接替代品。它有一个完全不同的哲学。这里 83% 的 MongoDB 问题是由尝试将 MongoDB 当作关系数据库来使用的人提出的，他们想知道为什么它不起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T20:59:37.187

### SQL != NoSQL

使用 SQL 的关系数据库不是 NoSQL 的逐个功能替代品。根据您的问题领域，您有时可以做出不同的体系结构或设计决策，偏向于另一个，但您不能像备件一样简单地将它们换掉，因为它们具有非常不同的设计目标和性能特征。

### 所有软件都有风险

软件安全是一个很大的话题，并且远远超出了 SO 问题的范围。但是，从广泛使用并快速修补的产品切换到*您不了解*的产品本质上并不是一个良好的风险管理权衡。

事实上，您所指的漏洞是一个*Rails*漏洞，该漏洞已被修补；你有零保证将来不会有其他 Ruby 或 Rails 漏洞——或者，事实上，网络或操作系统漏洞——针对 MVC 或操作系统堆栈的不同部分。因此，我不确定你认为从风险管理的角度来看，将 SQL 描绘成这个故事中固有的恶棍会得到什么。

# symfony - 如何在 Silex 中获取当前页面名称

> ID：14407377
> 
> 赞同：5
> 
> 时间：2013-01-18T20:48:36.663
> 
> 标签：symfony, twig, silex

我想知道如何获取当前页面名称，基本上“只是”路由中的最后一个参数（即/news 或/about）。我这样做是因为我希望能够突出显示导航中的当前页面。

理想情况下，我想将当前页面名称存储在一个全局变量中，以便在 Twig 中我可以将当​​前页面名称与链接进行比较并相应地添加一个类。

我不知道如何将当前页面名称添加到全局变量中。我试过使用这样的东西：

```
$app['twig']->addGlobal('current_page_name', $app['request']->getRequestUri()); 
```

在我的 app.php 文件的顶部，但出现“超出请求范围”错误。但我不想在每条路线中都包含这个。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-18T20:57:54.370

如果你把它放在像这样的中间件之前的应用程序级别，那将起作用：

```
$app->before(function (Request $request) use ($app) {
    $app['twig']->addGlobal('current_page_name', $request->getRequestUri());
}); 
```

您问题的“页面名称”部分不清楚，您是在寻找当前路线的名称吗？您`$request->get("_route")`甚至可以在之前的中间件中访问它，因为它在路由已经完成时被调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-03T03:53:39.030

您也可以直接在独立的导航树枝模板中生成导航列表。然后将其导入主模板。然后，您只需让 silex 将当前页面标识符传递给视图。最简单的方法...例如，从 Silex 您必须将“路径”变量传递给您的视图。从数据库中获取 nav_list 并将其作为全局数组变量传递给 twig 模板可能会更方便。然而，这个例子是你可以做的最简单的事情。

导航.twig

```
{% set nav_list = [
  ["./",        "home"],
  ["./contact", "contact"],
  ["./about",   "about us"]
  {# ... #}
] %}

{% set link_active = path|default("") %}

{% for link in nav_list %}
  <li><a href="{{ link[0] }}" class="{% if link[0] == link_active %} activeClass {% endif %}" >{{ link[1] }}</a></li>
{% endfor %} 
```

应用程序.php

```
//...
    $app->match('/about', function (Request $request) use ($app) {
        return $app['twig']->render('about.twig', array(
            'path' => './'.end(explode('/', $request->getRequestUri()))
        ));
    });
//... 
```

# php - 依赖注入混淆

> ID：14407378
> 
> 赞同：3
> 
> 时间：2013-01-18T20:48:46.147
> 
> 标签：php, oop

我一直在阅读有关依赖注入的内容，但我发现的示例对我来说看起来像是糟糕的代码，所以我的主要问题是我认为它是糟糕的代码是正确的，还是我误解了它的目的，并且是我的例子更好吗？

```
class Photo {
   protected $db;
   public function __construct()
   {
      $this->db = DB::getInstance();
   }
} 
```

所以这是一个糟糕的代码，依赖注入的建议是：

```
class Container {
   protected $db;
   public static newPhoto()
   {
      $photo = new Photo;
      $photo->setDB(static::$db);
      $photo->setConfig();
      $photo->setResponse();
      return $photo;
   }
}
$photo = Container::newPhoto(); 
```

但是，如果我错了，请纠正我，我们刚刚构建了一个类，其唯一职责是构建另一个类，这似乎毫无意义，而且我们正在使用静态方法，这显然是一个非常糟糕的主意。

我确实看到的一个好处是，令我惊讶的是没有提到我们现在可以使用设置器独立测试 Photo 类，而在第一个示例中我们不能。

这样的事情对我来说更有意义：

```
class Photo {
   protected $db;
   protected $config;
   protected $response;
   public function __construct($dbConn=null,$config='123',$response=true)
   {
      if(is_null($dbConn))
          $this->db = DB::getInstance();
      else
          $this->db = $dbConn;
      ...etc
   }
}
$photo = new Photo($dbConn); 
```

该类自行构建，不需要实际调用静态方法，如果使用值，则可以使用虚拟数据测试该类，否则它会退回到默认值（这似乎是 Container 类的唯一点），与容器相比，依赖关系仍然有些明显。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:27:47.567

依赖注入模式的目标是解耦如何构造一起工作的对象。在您的示例中，知道如何构建数据库实例不是 Photo 类的关注点，而只是使用数据库实例来实现其目标。

您已经注意到的明显优势是在测试中，如果您只想测试照片功能，您可以轻松地传递模拟数据库实例。但是您也可以考虑连接池，例如容器有一个数据库实例池并将其中一个传递给您的 Photo 对象以完成其工作。当照片生命周期结束时，数据库实例将返回到池中并在其他地方使用。

这种模式的实现可以使用带有参数、设置器、注释（至少在 Java 中）甚至 XML 配置文件的构造函数来实现。在注释或 XML 配置文件的情况下，容器将解析该信息，创建适当的所需对象并将它们注入客户端类。

您在 C1 和 C2 中描述的是一个工厂类，它公开了用于获取 Photo 实例的静态方法。这是 Java 中许多地方使用的非常常见的模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:51:13.470

> [我不知道你对 DI 的看法，但资源似乎很可疑。相反，您应该从观看[本讲座](http://www.youtube.com/watch?v=RlfLCWKxHJ0)开始，然后是Martin *Fowler的*[文章](http://martinfowler.com/articles/injection.html)。[也许通过这个](http://blog.ircmaxell.com/2013/01/dependency-injection-programming-with.html)短片补充。]

 *```
class Container {
   protected $db;
   public static newPhoto()
   {
      $photo = new Photo;
      $photo->setDB(static::$db);
      $photo->setConfig();
      $photo->setResponse();
      return $photo;
   }
}
$photo = Container::newPhoto(); 
```

这没有实现依赖注入。它实际上只是一个实施不佳的静态工厂方法（反）模式的例子。尤其是神奇的方法`$photo->setConfig()`，`$photo->setResponse()`它们显然做了一些工作，但没有接收参数。

然后是这段代码：

```
class Photo {
   protected $db;
   protected $config;
   protected $response;
   public function __construct($dbConn=null,$config='123',$response=true)
   {
      if(is_null($dbConn))
          $this->db = DB::getInstance();
      else
          $this->db = $dbConn;
      ...etc
   }
}
$photo = new Photo($dbConn); 
```

您决定隐藏它的依赖关系，而不是仅仅分配值，如果没有提供它们，则将它们从全局范围中取出。当然，您的构造函数最终会包含相当多的计算日志。从而使其无法测试。

哦..然后是神奇的布尔值。每当在构造函数中将这样的参数分配给类时，这清楚地表明您实际上需要两个不同的类，它们实现相同的接口。

所以..回答你的问题：

> 我一直在阅读有关依赖注入的内容，但我发现的示例对我来说看起来像是糟糕的代码，所以我的主要问题是我认为它是糟糕的代码是正确的，还是我误解了它的目的，并且是我的例子更好吗？

不，你的例子并不好。您刚刚将两个早期代码示例中最糟糕的部分组合到单个类定义中。*

# entity-framework - One-2-One 关联和继承

> ID：14407384
> 
> 赞同：2
> 
> 时间：2013-01-18T20:49:15.607
> 
> 标签：entity-framework, ef-code-first

我有一个以 A 为根的继承链，其子类型为 B 和 C。接下来，我有一个像这样的实体 E：

```
public class E 
{
    public Guid Id {get; set;}
    public B B {get; set;}
    public C C {get; set;}
} 
```

导航属性应映射到两个一对一关联，其中 E 是主体，B、C 是从属。这将不起作用，因为 EF 将使用 E.Id 的值作为 B 和 C 的外键，这将导致表 A 中的重复键。我使用 TPT、TPC 或 TPH 都没有关系。

如果我将它映射为两个两个一对二多关联并在 E 中使用不同的外键，即使用映射：

```
Entity<E>().HasRequired(x=>x.B).WithMany().HasForeignKey(x=>x.BId);
Entity<E>().HasRequired(x=>x.C).WithMany().HasForeignKey(x=>x.CId); 
```

比级联删除不会朝着正确的方向工作。即删除e时应删除EB和EC。

任何建议如何处理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T16:30:28.970

EF 需要每个关系（继承或关联）一个映射列。您使用一列进行继承，因此该列在关联关系的子类中不可用（因为您必须从子类中删除它）。

您有 2 个选择：

1.  您可以通过将 E 链接到 A（超类）来映射 E 与 B 和 C 的 1-1 关系。但这不是您模型的准确表示，因为 {B,C} 关系与 E 而不是 A。

2.  将另一列添加到 B 和 C，将用于与 E 的关联。这个新列应该是唯一的并且不为空 - 因为实际上您正在创建另一个主键。现有主键和新列都唯一标识记录（对于 B 或 C）。在数据库中，使用这个新列在 {B,C} 和 E 之间创建约束。现在 EF 将能够同时表示继承 {A<-B, A<-C} 和关联 {E--B, E--C}

# sql - 除非我传递一个键，否则显示一个表的所有记录

> ID：14407386
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:49:30.137
> 
> 标签：sql, sql-server

除非我向该过​​程传递一个键，否则是否有其他方法可以使用存储过程获取表的所有行？

如果是这样，我如何在 SQL Server 中编写代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:58:28.347

试试这个

```
CREATE PROCEDURE GetData(@key int = null)
BEGIN
  SELECT * FROM Table WHERE (@Key Is NULL or id = @Key)
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:03:35.583

您还可以使用 COALESCE 运算符：

```
CREATE PROCEDURE dbo.uspMySprocName(@Key INT = NULL)
AS
BEGIN
    SELECT * FROM MyTable WHERE ID = COALESCE(@Key, ID);
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:22:49.780

您可以使用 if 条件并进行 2 个查询

```
**syntax:**  
    if (@key is null ) then  
        begin  
            select * from table1 ;  
        end  
    else  
        being  
            select * from tabel1 where field1 = @key ;  
        end  
    endif 
```

以下链接应该有所帮助

[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=146620](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=146620)

# php - 图像不会改变

> ID：14407387
> 
> 赞同：1
> 
> 时间：2013-01-18T20:49:30.487
> 
> 标签：php, html

我正在尝试从 9gag 获取图像链接（也可以使用），当我单击一个按钮时，图像会变为下一个。基本问题是它只工作一次。不过，我可以在第一张和第二张图像之间切换。这应该很简单，但我不知道错误在哪里，所以在此先感谢任何愿意看这个的人。

```
<?php 
    $index = 0
    $html = file_get_contents("http://www.9gag.com");
    preg_match_all( '|http://d24w6bsrhbeh9d\.cloudfront\.net/photo/.+?\.jpg|', $html, $gags);
?>

<script>
    function nextImg(){
        <?php $index++;?>
        pic.src='<?php echo $gags[0][$index];?>'; 
    }
    function prevImg(){
        <?php $index--;?>
        pic.src='<?php echo $gags[0][$index];?>';
    }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:52:37.427

页面加载后，您不能增加 PHP 变量。您正在尝试使用 JavaScript 在客户端增加它们。如果您想在不刷新页面的情况下执行此操作，您将需要使用 AJAX 调用该 PHP，即使这样您也需要增加一个 javascript 变量来跟踪您所在的位置。

编辑：我有点疯狂地使用 PHP 和 JavaScript 创建一个 ajax 例程，特别是 jQuery 库，你需要链接到它才能工作。您可能还需要修改脚本的某些部分以处理您要完成的工作，但这肯定是您希望运行 ajax 应用程序的指南。

首先用这个脚本创建一个 PHP 文件：

```
<?php
    // Set content header to json
    header('Content-Type: application/json');

    // Get the index from the AJAX
    $index = $_GET['index'];

    // Grab file contents & parse
    $html = file_get_contents("http://www.9gag.com");
    preg_match_all( '|http://d24w6bsrhbeh9d\.cloudfront\.net/photo/.+?\.jpg|', $html, $gags);

    // Send filename back to AJAX script as JSON
    echo json_encode(array($gags[0][$index]));
?> 
```

然后，在您的 HTML 中，包含此 jQuery 以完成对 PHP 脚本的 AJAX 调用，并使用来自 PHP 脚本的数据更新 DOM。

```
<script>
            $(function() {
                'use strict';

                // Initiate index variable
                var index = 0;

                // Load initial image
                loadImage(index);

                // Add click event to a button with class of next-btn
                $('.next-btn').click(function(e) {
                    e.preventDefault();

                    // Increment index to get next image
                    index++;

                    // Run AJAX function to retrieve image
                    loadImage(index);
                });

                // Add click event to a button with class prev-btn
                $('.prev-btn').click(function(e) {
                    e.preventDefault();

                    // Decrement the index if it isn't 0
                    if (index > 0) {
                        index--;
                    }

                    // Run AJAX function to retrieve image
                    loadImage(index);
                });
            });

            function loadImage(index) {
                'use strict';
                $.ajax({
                    type: 'GET',
                    url: 'your-php-script.php', // Filepath to your PHP script
                    data: 'index='+index, // Index is passed through GET request
                    dataType: 'json', // Return JSON
                    success: function (data) { // If the php script succeeds
                        // Change img with class of pic's src 
                        // to the filename retrieved from php
                        $('.pic').attr('src', data[0]);
                    }
                });
            }
        </script> 
```

根据您的需要进行配置将需要一些重要的 PHP 和 jQuery/JavaScript 知识，因为可能需要进行一些调试。祝你好运！

编辑 2：如果您想下载，我将工作（经过测试，可以工作）源文件上传到我的网站。请接受答案，让我知道你抓住了文件......

[http://www.wedgewebdesign.com/files/ajax-image-loader.zip](http://www.wedgewebdesign.com/files/ajax-image-loader.zip)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T20:59:52.643

@Eric 基本上是正确的，但如果您不熟悉该模型，则不会真正详细说明...

PHP 是一种服务器端语言，因为它在 Web 主机服务器上进行所有处理，一旦完成，就会将静态结果发送回用户。这意味着，您在 PHP 中加载页面后看到的任何内容都将保留，除非您执行以下两项操作之一：

1）发送一个新的请求——你提供不同的参数，页面重新执行它的逻辑并返回一个新的结果给用户

2）执行某种形式的客户端Javascript。Javascript 与 PHP 的不同之处在于它在客户端（而不是服务器）上执行，因此您不必将响应发送回服务器，除非您需要更多信息。Javascript 和 PHP 可以结合起来创建 AJAX 调用，允许客户端异步调用 Web 服务器以获取更多数据，而无需重新加载整个页面。Javascript 处理重新绘制新信息或更新对用户来说可以无缝显示的页面。

因此，您需要的是这两个选项之一。您可以向用户提供“下一个”/“上一个”链接，并且每次加载页面的方式都不同，或者您创建一个 AJAX 调用来获取下一个图像的 url，然后加载它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-18T20:52:36.367

尝试将变量分配给`$gags[0][$index]`. 就像是

```
$imgsrc = $gags[0][$index]; 
```

进而

```
pic.src='<?php echo $imgsrc; ?>'; 
```

# django - 如何在heroku上为django应用程序安装ffmpeg？

> ID：14407388
> 
> 赞同：1
> 
> 时间：2013-01-18T20:49:38.580
> 
> 标签：django, heroku, ffmpeg

我想使用 ffmpeg 从视频中提取一帧以将其用作海报。这是我第一次部署应用程序，更不用说在heroku上，所以我不确定如何在服务器上安装ffmpeg。

我发现[这个 ffmpeg 版本](https://github.com/dzello/ffmpeg-heroku)带有将其“供应商”到我的应用程序中的说明，然后调整我的应用程序的配置设置/路径。供应商意味着什么？我有一种感觉，这是一个轨道问题，因为我似乎无法通过谷歌搜索找到解释。

此外，django 相当于运行指令 `heroku config:set PATH=bin:vendor/ffmpeg/bin:<...> -a yourapp`和`heroku config:set LD_LIBRARY_PATH=vendor/ffmpeg/lib:/usr/local/lib -a yourapp`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:56:09.587

您可能希望将构建包换成[这个](https://github.com/integricho/heroku-buildpack-python-ffmpeg)：

```
heroku config:add BUILDPACK_URL=https://github.com/integricho/heroku-buildpack-python-ffmpeg.git 
```

构建包是获取您的源代码并构建部署到 Heroku dynos 的内容。此构建包在构建时明确包含您的应用程序中的 ffmpeg。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-10T18:45:26.117

我已经搜索了 2 天，尝试了其他用户所说的所有内容。然后我找到了简单的方法。只需去 heroku 应用程序设置。然后单击添加构建包。之后弹出小工具栏。添加此网址：

```
https://github.com/kontentcore/heroku-buildpack-ffmpeg 
```

按保存更改。然后再次部署您的应用程序。你已经做到了:)

[![ffmpeg buildpack 安装](../Images/f1360f227f04dc8ede26cb224e85e8fb.png)](https://i.stack.imgur.com/0CMQ2.png)

# php - 如何将 db 中的值作为值显示到文本输入中？

> ID：14407392
> 
> 赞同：0
> 
> 时间：2013-01-18T20:49:56.727
> 
> 标签：php, jquery, iframe, mysqli

下面我有一个处理文件输入的 iframe：

```
var $fileVideo = $("<form action='videoupload.php' method='post' enctype='multipart/form-data' target='upload_target_video' onsubmit='return videoClickHandler(this);' class='videouploadform' >" + 
"Video File: <input name='fileVideo' type='file' class='fileVideo' /></label>" +  
"<input type='submit' name='submitVideoBtn' class='sbtnvideo' value='Upload' /></label>" + 
 "<p class='listVideo' align='left'></p>" +
"<iframe class='upload_target_video' name='upload_target_video' src='/' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>"); 
```

现在我在下面有一个函数，当文件停止上传并成功上传到服务器时，它将显示上传文件的名称：

```
 function stopVideoUpload(success, videofilename){

      var result = '';
      videocounter++;

      if (success == 1){
         result = '<span class="videomsg'+videocounter+'">The file was uploaded successfully</span>';
          $('.listVideo').eq(window.lastUploadVideoIndex).append('<div>' + htmlEncode(videofilename) + 
          '<input type="text" name="videoidhide" value=""/><br/><hr/></div>');
      }

      return true;   
} 
```

您还将看到文件名旁边有一个文本输入。这与我的问题有关。

下面是框架链接到的 php 脚本`videoupload.php`，该脚本将上传文件并将数据插入数据库：

```
 move_uploaded_file($_FILES["fileVideo"]["tmp_name"],
      "VideoFiles/" . $_FILES["fileVideo"]["name"]);
      $result = 1;

    $videosql = "INSERT INTO Video (VideoFile) 
    VALUES (?)";

        if (!$insert = $mysqli->prepare($videosql)) {
      // Handle errors with prepare operation here
    }

            //Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s",$vid);

//Assign the variable
$vid = 'VideoFiles/'.$_FILES['fileVideo']['name'];

 $insert->execute();

        if ($insert->errno) {
          // Handle query error here
        }

        $insert->close();     

?>

 <script language="javascript" type="text/javascript">
 window.top.stopVideoUpload(<?php echo $result; ?>, '<?php echo $_FILES['fileVideo']['name'] ?>');
 </script> 
```

下面是显示文件插入的示例数据库：

Video_Question 表：

```
 VideoId (PK auto)  VideoFile
 1                  VideoFiles/carrace.mp4
 2                  VideoFiles/cricket.mov 
```

现在我的问题是，您在 mysqli 代码中看到它将上传的视频文件插入`VideoFile`数据库中的字段的位置，我如何从`VideoId`字段中检索值并将其显示在每个相关上传文件的文本输入中？

例如，如果 carrace.mp4 已上传，`VideoId`则从数据库中检索 1 并将其显示在已上传文件名称旁边的文本输入中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:09:33.970

只需在调用`$mysqli->insert_id`之前调用并将其附加到文件名`function stopVideoUpload`

还`$vid`需要在绑定之前分配，而不是之后

```
 $insert->execute();
     $id = $mysqli->insert_id;
        if ($insert->errno) {
          // Handle query error here
        }

        $insert->close();     

?>

 <script language="javascript" type="text/javascript">
 window.top.stopVideoUpload(<?php echo $result; ?>, '<?php echo $id. $_FILES['fileVideo']['name'] ?>');
 </script> 
```

# sql-server - .net MVC4 与 SQL Server 2005/2008 的接口

> ID：14407395
> 
> 赞同：2
> 
> 时间：2013-01-18T20:50:02.203
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, asp.net-mvc-4

我的组织使用 IMIS，这是一个成员/事件数据库，将其数据存储在我们的 sql server 2005 db 中。我一直在开发类和服务层以使用-等待它-asp.net 1.1 与该数据进行交互，我的主，我已准备好切换到更现代的东西。

因此，在尝试了 CakePHP 之后，作为一家微软商店，我想使用 MVC4 来处理我未来的所有应用程序，但似乎我找到的关于该主题的每个教程都使用了一个 SQL Server Express 实例——那里似乎没有太多提及连接到远程 2005 或远程 2008 服务器。

完全公开，我在这里和那里看到一些评论提到类的名称和连接字符串和数据库都必须相关，但我没有找到任何明确的经验法则是什么。

如果有人能给我一些关于如何设置它的基本步骤，我将永远感激不尽。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T20:54:26.853

如果您有想要连接的现有数据库，我建议您使用实体框架和数据库优先方法。

您可能会找到很多教程，这里是专门针对 Entity Framework + Database First + MVC 的教程：

[http://www.c-sharpcorner.com/UploadFile/abhikumarvatsa/database-first-approach-in-entity-framework/](http://www.c-sharpcorner.com/UploadFile/abhikumarvatsa/database-first-approach-in-entity-framework/)

# ms-access - MS Access 2010 VBA 多个 Else If 问题

> ID：14407396
> 
> 赞同：2
> 
> 时间：2013-01-18T20:50:05.747
> 
> 标签：ms-access, vba, if-statement

我有一个 MS Access 表单，用户可以在其中选择最多四个条件来过滤报告返回的记录。在 VBA 中，我试图根据用户选择过滤的字段（如果有）动态构建过滤器字符串。下面的代码给了我一个“Block If without End If”错误。我在这里做错了什么？

```
If (IsNull(frm!employee) = False) Then
    strFilter = "Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
    If IsNull(frm!sop) = False Then
        strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
    End If
    If IsNull(frm!revision) = False Then
        strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
    End If
    If IsNull(frm!dept) = False Then
        strFilter = strFilter + " AND department = '" & frm!dept & "'"
    End If
Else
If (IsNull(frm!sop) = False) Then
    strFilter = "sop_number = '" & frm!sop & "'"
    If (IsNull(frm!employee) = False) Then
        strFilter = "Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
    End If
    If IsNull(frm!revision) = False Then
        strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
    End If
    If IsNull(frm!dept) = False Then
        strFilter = strFilter + " AND department = '" & frm!dept & "'"
    End If
Else
If (IsNull(frm!revision) = False) Then
    strFilter = "revision_number = '" & frm!revision & "'"
    If (IsNull(frm!employee) = False) Then
        strFilter = " AND Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
    End If
    If IsNull(frm!sop) = False Then
        strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
    End If
    If IsNull(frm!dept) = False Then
        strFilter = strFilter + " AND department = '" & frm!dept & "'"
    End If
Else
If IsNull(frm!dept) = False Then
    strFilter = "department = '" & frm!dept & "'"
    If (IsNull(frm!employee) = False) Then
        strFilter = " AND Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
    End If
    If IsNull(frm!sop) = False Then
        strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
    End If
    If IsNull(frm!revision) = False Then
        strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
    End If
End If 
```

您可以给我任何改进此代码的建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:38:23.353

该代码避免在`strFilter`. 然而，逻辑很难遵循，它在相同的基本主题上使用了多种变体。

使用更简单的方法。您对 4 个表单控件中包含的值感兴趣：

*   `frm!employee`
*   `frm!sop`
*   `frm!Revision`
*   `frm!dept`

依次检查它们中的每一个，对于任何包含值的，添加一个以“AND”开头的段`strFilter`。之后，如果`strFilter`包含*任何*文本，您知道它以“AND”开头，因此您可以简单地丢弃前 5 个字符。

```
strFilter = vbNullString ' <- make it explicit
If Len(Trim(frm!employee) & vbNullString) > 0 Then
    strFilter = strFilter & _
        " AND Trainee_First_Name & ' ' &  Trainee_Last_Name = '" & _
        frm!employee & "'"
End If
If Len(Trim(frm!sop) & vbNullString) > 0 Then
    strFilter = strFilter & " AND sop_number = '" & frm!sop & "'"
End If
If Len(Trim(frm!Revision) & vbNullString) > 0 Then
    strFilter = strFilter & " AND revision_number = '" & _
        frm!Revision & "'"
End If
If Len(Trim(frm!dept) & vbNullString) > 0 Then
    strFilter = strFilter & " AND department = '" & frm!dept & "'"
End If
If Len(strFilter) > 0 Then
    ' discard " AND " from beginning of string
    strFilter = Mid(strFilter, 6)
End If
MsgBox "strFilter ->" & strFilter & "<-" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:19:11.553

问题是您的`else... if`子句没有以`end if`. 您需要使用`ElseIf`或

```
Else
  If ...
  End If
Else... 
```

我在下面修改了您的代码以使用后一种语法。注意下面的**End If**行。

**注意：您不需要**，这只是在您的代码块中引起注意！**

```
If (IsNull(frm!employee) = False) Then
        strFilter = "Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
        If IsNull(frm!sop) = False Then
            strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
        End If
        If IsNull(frm!revision) = False Then
            strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
        End If
        If IsNull(frm!dept) = False Then
            strFilter = strFilter + " AND department = '" & frm!dept & "'"
        End If
    Else
    If (IsNull(frm!sop) = False) Then
        strFilter = "sop_number = '" & frm!sop & "'"
        If (IsNull(frm!employee) = False) Then
            strFilter = "Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
        End If
        If IsNull(frm!revision) = False Then
            strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
        End If
        If IsNull(frm!dept) = False Then
            strFilter = strFilter + " AND department = '" & frm!dept & "'"
        End If

**End If**
    Else
    If (IsNull(frm!revision) = False) Then
        strFilter = "revision_number = '" & frm!revision & "'"
        If (IsNull(frm!employee) = False) Then
            strFilter = " AND Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
        End If
        If IsNull(frm!sop) = False Then
            strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
        End If
        If IsNull(frm!dept) = False Then
            strFilter = strFilter + " AND department = '" & frm!dept & "'"
        End If
    **End If**
    Else
    If IsNull(frm!dept) = False Then
        strFilter = "department = '" & frm!dept & "'"
        If (IsNull(frm!employee) = False) Then
            strFilter = " AND Trainee_First_Name + ' ' +  Trainee_Last_Name = '" & frm!employee & "'"
        End If
        If IsNull(frm!sop) = False Then
            strFilter = strFilter + " AND sop_number = '" & frm!sop & "'"""
        End If
        If IsNull(frm!revision) = False Then
            strFilter = strFilter + " AND revision_number = '" & frm!revision & "'"
        End If
    **End If**
    End If 
```

# php - iOS 不接受来自 php Web 服务的 json 响应

> ID：14407397
> 
> 赞同：0
> 
> 时间：2013-01-18T20:50:11.883
> 
> 标签：php, objective-c, web-services, afnetworking

我是iOS的初学者。我有一个简单的 Web 服务，它从表中检索数据并以 JSON 格式发送结果。我正在尝试从 iOS 与该 Web 服务通信以接收 JSON 响应，但面临问题。这是我收到的错误：

```
Request Failed with Error: Error Domain=AFNetworkingErrorDomain Code=-1016 "Expected     content type {(
"text/json",
"application/json",
"text/javascript"
)}, got text/html" UserInfo=0x7598e70 
```

这是我的代码片段：

PHP 网络服务：

```
$stmt = "SELECT STORE_TYPE, STORE_NAME FROM STORE WHERE STORE_ZIP = $zip";
$result = mysqli_query($this->databaseconnection, $stmt);  
$storelist = array();
$store = array();
$jsondata;
while ($row = mysqli_fetch_assoc($result)) {
  $store['STORE_TYPE'] = $row['STORE_TYPE'];
  $store['STORE_NAME'] = $row['STORE_NAME'];
  array_push($storelist,$store);
}
$jsondata = json_encode($storelist);
echo $jsondata; 
```

当我从浏览器执行我的 php 时，我得到以下结果：

```
[{"STORE_TYPE":"GROCERY","STORE_NAME":"Walmart"},{"STORE_TYPE":"BAKERY","STORE_NAME":"Lanes Bakery"},{"STORE_TYPE":"GROCERY","STORE_NAME":"Copps"}] 
```

用于与 Web 服务通信的 iOS 代码片段：

```
NSURL *url = [NSURL URLWithString:@"http://localhost/~Sandeep/store/store.php?rquest=getstores&zip=53715"];

NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];
AFJSONRequestOperation *operation = [AFJSONRequestOperation  JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSLog(@"%@", JSON);
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    NSLog(@"Request Failed with Error: %@, %@", error, error.userInfo);
}];
[operation start]; 
```

我看了很多教程，他们都说在 php 中对数组执行“json_encode”会以 JSON 格式对数据进行编码，而“echo”是将编码的 JSON 作为响应发送的方式。出于某种原因，我的 iOS 没有将其视为 JSON。我不确定我在这里错过了什么/做错了什么。

我非常感谢您对此的投入。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T20:56:19.787

您需要设置正确的内容类型（使用[`header`](http://php.net/manual/en/function.header.php)），错误列出了可接受的类型，但您应该使用`application/json`

```
$stmt = "SELECT STORE_TYPE, STORE_NAME FROM STORE WHERE STORE_ZIP = $zip";
$result = mysqli_query($this->databaseconnection, $stmt);  
$storelist = array();
$store = array();
$jsondata;
while ($row = mysqli_fetch_assoc($result)) {
  $store['STORE_TYPE'] = $row['STORE_TYPE'];
  $store['STORE_NAME'] = $row['STORE_NAME'];
  array_push($storelist,$store);
}
$jsondata = json_encode($storelist);
header('Content-Type: application/json');
echo $jsondata; 
```

# asp.net-mvc-3 - Kendo dataviz 饼图 - 显示远程数据

> ID：14407398
> 
> 赞同：0
> 
> 时间：2013-01-18T20:50:14.757
> 
> 标签：asp.net-mvc-3, kendo-ui, kendo-dataviz

我正在尝试使用以下信息显示 Kendo dataviz 饼图。

我正在将“结果”从我的控制器传回我的视图。

![结果就是我要传递回我的观点。](../Images/0ee6fe43f0faefc645c266b467619a4f.png)

我的视图包含饼图：

```
@(Html.Kendo().Chart<PropertyViewModel>()
        .Name("chart")
        .Title("Properties")
        .Legend(legend => legend
            .Position(ChartLegendPosition.Top)
        )
        .DataSource(ds => ds.Read(read => read.Action("GetPropertiesChart", "Home")))
        .Series(series => {
            series.Pie(model => model.Address.State, model => model.Address.State.Count().ToString());
        })
        .Tooltip(tooltip => tooltip
            .Visible(true)
            .Format("{0:N0}")
        )
    ) 
```

除了饼图应该在的页面上的空白区域外，我什么也没有。

控制器代码：

```
public ActionResult GetPropChart()
    {
        var allProps = PService.GetAll();

        var props = allProps.Cast<PropViewModel>().ToList();

        var results = props
                .GroupBy(item => item.Address.State)
                .Select(g => new
                {
                    State = g.Key,
                    Count = g.Select(l => l.Address.State).Count()
                });

        return Json(results);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T16:58:07.090

您返回的模型如下：

```
.Select(g => new
      {
          State = g.Key,
          Count = g.Select(l => l.Address.State).Count()
      } 
```

但是您的系列定义不同（没有 Adress 属性）

```
series.Pie(model => model.Address.State) 
```

也不支持绑定到方法（例如 model.Address.State.Count().ToString()） - 创建的常规属性改为保存该值。

# php - 使用 jQuery 检查一个字段与另一个字段

> ID：14407399
> 
> 赞同：0
> 
> 时间：2013-01-18T20:50:19.543
> 
> 标签：php, html, sql

我在编写订单提交页面时遇到了一个相当大的问题，该页面的目的是为订单提交争议 - 提供两个字段，但前提是一个字段小于另一个字段。

基本上，一个是下拉框，另一个是争议框，查询如下：

如果 DisputesTextBox = "" 并且下拉框 = "请选择..."

一切都很好 - 启用提交按钮

如果 DisputesTextBox != "" 并且下拉框 = "请选择..."

错误（反之亦然，因此如果填写了争议但 dropwn = 请选择...） - 提交按钮已禁用

如果 DisputesTextox != "" 并且下拉框 = "Other"

一切都很好 - 启用提交按钮

如果 DisputesTextBox > 装运箱

错误 - 提交按钮被禁用

```
<table>
                <thead>
                    <tr><th>Item ID</th><th>Description</th><th>Dispute Quantity</th><th>Shipped Quantity</th><th>Ordered Quantity</th><th>Reason</th></tr>
                </thead>
                <tbody>
                    <?php
                        $data = mysql_query("SELECT * FROM `artran09` WHERE `invno` = '$invoiceno'") or die(mysql_error());
                        echo "<center>";
                        $i = -1;        
                        echo "<form action=\"submitdispute.php?invno=".$invoiceno."&ordate=".$placed."\" method=\"POST\" onsubmit=\"return confirm('Are you sure you are ready to dispute your order?');\">";

                            while ($info = mysql_fetch_array($data)) {              
                                $i += 1;                                    
                                echo "<tr>"; 
                                echo "<td>".$info['item']."</td>"; 
                                echo "<td>".$info['descrip']."</td>";       

                                echo "<td><input type=\"text\" input name=".$i." onKeyPress=\"return numbersonly(this, event)\"  maxLength=\"3\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyshp']." onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><input type=\"text\" value=".$info['qtyord']." onKeyPress=\"return numbersonly(this, event)\" maxLength=\"3\" disabled=\"disabled\"></td>"; 

                                echo "<td><select name = \"reason$i\">";
                                echo "<option>Please Select...</option>";
                                echo "<option>Short/Not received</option>";
                                echo "<option>Damaged Goods</option>";
                                echo "<option>Product Not Ordered</option>";                    
                                echo "</select></td>";

                                echo "</tr>"; 
                            }

                    ?>
                </tbody>
            </table>
        </div>
    </div>
    <p><input type = "submit" value = "Dispute" name ="Submit">
    </form> 
```

谢谢，希望有人能帮忙！

为 Wolf/任何可以提供帮助的人编辑 - 这里的代码是怎么回事：

-- 我编辑的代码 --

```
function validateSubmit(){

   // this will loop through each row in table
   // Make sure to include jquery.js
   $('tr').each( function() {
      // Find first input
      var input1 = $(this).find('input').eq(0);
      var qty1 = input1.val();
      // Find Second input
      var input2 = $(this).find('input').eq(1);
      var qty2 = input2.val();
      // Find third input
      var input3 = $(this).find('input').eq(2);
      var qty3 = input3.val();
      // Find select box
      var selectBx = $(this).find('select');
      var selectVal = selectBx.val();
      // Add your validation code here for the inputs and select
      // Return true if all validations are correct
      // Else return false
        if(qty1 = "" && selectVal = "Please Select...") {
            return true;
            alert("You have an error somewhere, please check over your quantites.");
            break;
        }
        if (qty1 > qty2) {
            return false;
            alert("You have an error somewhere, please check over your quantites.");
            break;
        }
   });

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T20:56:59.317

更改以下行

```
onsubmit=\"return confirm('Are you sure you are ready to dispute your order?');\" 
```

至

```
onsubmit=\"return validateSubmit();\" 
```

然后写函数

```
function validateSubmit(){

   // this will loop through each row in table
   // Make sure to include jquery.js
   $('tr').each( function() {
      // Find first input
      var input1 = $(this).find('input').eq(0);

      // Find Second input
      var input2 = $(this).find('input').eq(1);

      // Find third input
      var input3 = $(this).find('input').eq(2);

      // Find select box
      var selectBx = $(this).find('select');

      // Add your validation code here for the inputs and select
      // Return true if all validations are correct
      // Else return false

   });
} 
```

请注意，您的提交按钮将始终处于启用状态。但是仅当您的验证成功时提交才会起作用。

# linux - 如何将原始 L2 数据包作为传入数据包注入 Linux 上的接口？

> ID：14407400
> 
> 赞同：4
> 
> 时间：2013-01-18T20:50:32.383
> 
> 标签：linux, network-programming, packets

我需要将一些 L2 数据包（自定义）作为 Linux 中的传入数据包注入特定接口，以测试在其上运行的一些应用程序。

是否有任何库（首选python）/示例可以提供帮助？我正在浏览 Scrapy 库，但看起来它只能将数据包作为传出数据包注入网络？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T04:47:45.723

如果您有`bridge`可用的本机 linux 模块，那么您可以通过这种方式使用它。创建桥梁

```
brctl addbr <brname> 
```

现在创建一个虚拟`eth`对（默认名称`veth0`, `veth1`）。veth 是连接的 L2 设备

```
ip link add type veth
ifconfig veth0 up
ifconfig veth1 <some_ip> up 
```

现在将您的特定接口（比如说`eth0`）和一对的一侧添加`veth`到这个桥接器中。

```
brctl addif <brname> eth0
brctl addif <brname> veth0 
```

这会将这两个接口都添加到网桥中。现在，当您在 上发送流量时`veth0`，您应该也可以打开它`eth0`（基于正常的 L2 交换机功能）。要发送流量，`veth0`您只需将流量注入`veth1`其中，因为它们都是内部连接的。所以假设你想使用`tcpreplay`，就做

```
tcpreply -i veth1 yourpcap.pcap 
```

让我们知道怎么回事

# salesforce - 需要一个将 0.01 美元变为 0.00 美元的公式

> ID：14407402
> 
> 赞同：0
> 
> 时间：2013-01-18T20:50:39.527
> 
> 标签：salesforce

我有一个问题，价格显示为 0.01 美元，而它应该显示为 0.00 美元。

我找到了有问题的自定义字段，并想创建一个执行以下操作的公式。

```
If(value = $0.01, $0.00, value) 
```

但我收到以下错误。

```
Error: Field $0.01 does not exist. Check spelling. 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:25:57.007

*正如迈克尔评论你的那样，salesforce.se 可能是这个问题的更快站点。*

无论如何，我认为你需要用户`ROUND(number, num_digits)`

更多信息在[官方文档](http://www.salesforce.com/us/developer/docs/pages/Content/pages_variables_functions.htm#ROUND)中。

# sql - 选择 con WHERE IN（用户定义的表类型）

> ID：14407406
> 
> 赞同：0
> 
> 时间：2013-01-18T20:51:14.570
> 
> 标签：sql, sql-server

我正在尝试使用不是用户输入数组的字符串数组进行查询，我定义了以下类型：

```
CREATE TYPE [dbo].[searchData] AS TABLE([searchInput] [nvarchar](max) NOT NULL 
```

在存储过程中，我用 WHILE填充`@tempTable`表类型的变量，但是当`[searchData]`

```
SELECT DISTINCT Column1, Column2, Column3, Column1Tabla2 
FROM Tabla1 INNER JOIN Tabla2 ON DT_Tabla1.Column2 = Tabla2.Column1Tabla2 
WHERE Column1 IN (select * from @tempTable)

select * from @tempTable --Devuelve todos los valores que hay en la tabla 
```

只返回 [searchData] 的最后一个值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:09:59.323

这真的没有意义，我不相信它会编译：

```
WHERE Column1 IN (select * from @tempTable) 
```

也许你的意思是：

```
WHERE Column1 IN (select SearchInput from @tempTable) 
```

# objective-c - 表达式不是不赋值，mapkit

> ID：14407410
> 
> 赞同：0
> 
> 时间：2013-01-18T20:51:27.580
> 
> 标签：objective-c, ios6, mapkit, mkcoordinateregion

我正在尝试显示地图工具包，并且正在执行以下操作： MapViewController.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>
#import <QuartzCore/QuartzCore.h>
@interface SiteViewController : UIViewController <MKMapViewDelegate>

@property (assign, nonatomic)       MKCoordinateRegion  region;
@property (strong, nonatomic)       IBOutlet MKMapView  *googleMap;

@end 
```

MapViewController.m

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    // Set propertiesfor the mapView
    self.region.center.latitude         =   43.62862 ; // expression is not assigned
    self.region.center.longitude        =   -79.331245;// expression is not assigned
    self.region.span.longitudeDelta     =   0.01f;     // expression is not assigned
    self.region.span.longitudeDelta     =   0.01f;     // expression is not assigned
    [self.googleMap setMapType:MKMapTypeStandard];
    [self.googleMap setZoomEnabled:YES];
    [self.googleMap setScrollEnabled:YES];
    [self.googleMap setRegion:self.region animated:YES];

    MKPointAnnotation *pin = [[MKPointAnnotation alloc] init];
    pin.coordinate  = region.center;
    [self.googleMap addAnnotation:pin];
} 
```

我正进入（状态

> 表达式未赋值

我不明白。有人可以解释一下，让我摆脱这个麻烦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:03:22.383

您需要通过 region 属性或方法设置地图视图区域`- (void)setRegion:(MKCoordinateRegion)region animated:(BOOL)animated;`。

尝试这个：

```
CLLocationCoordinate2D coordinate = CLLocationCoordinate2DMake(43.62862, -79.331245);

[self.mapView setRegion:MKCoordinateRegionMake(coordinate, MKCoordinateSpanMake(0.01f, 0.01f))]; 
```

# c# - 数据绑定无法正常工作

> ID：14407411
> 
> 赞同：0
> 
> 时间：2013-01-18T20:51:34.713
> 
> 标签：c#, wpf, data-binding

在这个程序中，我可以通过单击“添加课程”按钮一次添加一个选项卡。理想情况下，选项卡的标题应该是我输入的课程名称，并且选项卡上的 textbox 中的文本应该显示课程名称。

但是，它无法正常运行。当我尝试添加超过 1 个选项卡时，每次它都会给我这个错误消息：

```
System.Windows.Data Error: 40 : BindingExpression path error: 'Text' property not found on 'object' ''MyHomeworkViewModel' (HashCode=33010577)'. BindingExpression:Path=Text; DataItem='MyHomeworkViewModel' (HashCode=33010577); target element is 'TextBox' (Name=''); target property is 'Text' (type 'String') 
```

此外，它似乎“覆盖”了其他选项卡的文本（只是文本，而不是标题）。例如，如果我添加一个带有标题“a”的选项卡，其文本也是“a”。然后，如果我添加“B”，两个选项卡上的两个文本框都变为“B”。但是，如果我打印出每个选项卡的 Text 属性（在本例中为 MyHomeworkModel），它们分别是“a”和“B”。

我一整天都在调试，但没有运气。任何帮助，将不胜感激！

我的视图（DataContext 设置为 MyHomeworkViewModel）：

```
<Window x:Class="MyHomework__MVVM_.MyHomeworkView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="My Homework" Height="450" Width="800" ResizeMode="CanMinimize">
    <Grid Margin="0,0,10,10">
        <TabControl HorizontalAlignment="Left" Height="330" VerticalAlignment="Top" Width="764" Margin="10,10,0,0" ItemsSource="{Binding AllTabs}" SelectedItem="{Binding SelectedTab}">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem">
                    <Setter Property="Header" Value="{Binding Header}"/>
                    <Setter Property="Content">
                        <Setter.Value>
                            <Grid>
                                <TextBox Text="{Binding Text}" FontSize="16" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                </TextBox>
                            </Grid>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="FontSize" Value="20"/>
                </Style>
            </TabControl.ItemContainerStyle>
        </TabControl>
        <Button Content="Add Course" HorizontalAlignment="Left" VerticalAlignment="Top" Width="105" Margin="10,351,0,0" Height="50" Command="{Binding AddCourseCommand}"/>
        <Button Content="Drop Course" HorizontalAlignment="Left" VerticalAlignment="Top" Width="76" Margin="138,379,0,0" Height="22" Command="{Binding DropCourseCommand, UpdateSourceTrigger=PropertyChanged}"/>
        <Button Content="Save HW" HorizontalAlignment="Left" VerticalAlignment="Top" Width="105" Margin="669,351,0,0" Height="50"/>
    </Grid>
</Window> 
```

我的模型：

```
using System.ComponentModel;

namespace MyHomework__MVVM_
{
    class MyHomeworkModel : INotifyPropertyChanged
    {
        private string header, text;
        public event PropertyChangedEventHandler PropertyChanged;

        public string Header
        {
            get
            {
                return header;
            }
            set
            {
                header = value;
                OnPropertyChanged("Header");
            }
        }

        public string Text
        {
            get
            {
                return text;
            }
            set
            {
                text = value;
                OnPropertyChanged("Text");
            }
        }

        private void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
} 
```

我的视图模型：

```
using MyHomework;
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows.Input;

namespace MyHomework__MVVM_
{
    class MyHomeworkViewModel : INotifyPropertyChanged
    {
        private ObservableCollection<MyHomeworkModel> allTabs;
        private MyHomeworkModel selectedTab;
        private MyHomeworkView mainWindow;
        public event PropertyChangedEventHandler PropertyChanged;

        public MyHomeworkViewModel(MyHomeworkView mainWindow)
        {
            allTabs = new ObservableCollection<MyHomeworkModel>();
            this.mainWindow = mainWindow;
            AddCourseCommand = new AddCourseCommand(this);
            DropCourseCommand = new DropCourseCommand(this);
        }

        public ObservableCollection<MyHomeworkModel> AllTabs
        {
            get
            {
                return allTabs;
            }
            set
            {
                allTabs = value;
                OnPropertyChanged("AllTabs");
            }
        }

        public MyHomeworkModel SelectedTab
        {
            get
            {
                return selectedTab;
            }
            set
            {
                selectedTab = value;
                OnPropertyChanged("SelectedTab");
            }
        }

        public ICommand AddCourseCommand
        {
            get;
            private set;
        }

        public ICommand DropCourseCommand
        {
            get;
            private set;
        }

        public void AddNewTab()
        {
            NewCourseName ncn = new NewCourseName();
            ncn.Owner = mainWindow;
            ncn.ShowDialog();
            if (ncn.courseName != null)
            {
                MyHomeworkModel newTab = new MyHomeworkModel();
                newTab.Header = ncn.courseName;
                newTab.Text = ncn.courseName;
                AllTabs.Add(newTab);
                SelectedTab = newTab;
            }

            foreach (MyHomeworkModel item in AllTabs)
            {
                Console.WriteLine(item.Text);
            }
        }

        public bool CanDrop()
        {
            return SelectedTab != null;
        }

        public void RemoveTab()
        {
            DropCourseConfirmation dcc = new DropCourseConfirmation();
            dcc.Owner = mainWindow;
            dcc.ShowDialog();
            if (dcc.drop == true)
            {
                int index = AllTabs.IndexOf(SelectedTab);
                AllTabs.Remove(SelectedTab);

                if (AllTabs.Count > 0)
                {
                    if (index == 0)
                    {
                        SelectedTab = AllTabs[0];
                    }
                    else
                    {
                        SelectedTab = AllTabs[--index];
                    }
                }
                else
                {
                    SelectedTab = null;
                }
            }
        }

        private void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }
    }
} 
```

如果您需要更多代码来帮助我，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:04:40.057

你`DataContext`的不是你想的那样。阅读那里的错误。它指出“文本”不是一个有效的属性，`MyHomeworkViewModel`它是真的（与你的相反`MyHomeworkModel`）。

您需要修改而不是 ItemContainerStyle 而是`ItemTemplate`使用`ContentTemplate`ItemsSource 中的适当对象作为其`DataContext`.

此外，您的 TextBox 中的绑定必须是`Text="{Binding Text, Mode=TwoWay}"`，否则它不会修改模型中的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:08:39.557

改变你的

```
<Setter Property="Content">
                        <Setter.Value>
                            <Grid>
                                <TextBox Text="{Binding Text}" FontSize="16" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                </TextBox>
                            </Grid>
                        </Setter.Value>
                    </Setter> 
```

为了这：

```
<Setter Property="ContentTemplate">
                    <Setter.Value>
                        <DataTemplate>
                        <Grid>
                            <TextBox Text="{Binding Text}" FontSize="16" AcceptsReturn="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            </TextBox>
                        </Grid>
                        </DataTemplate>
                    </Setter.Value>
                </Setter> 
```

# google-api - 通过 OAuth 2.0 和私钥（即服务帐户）访问 Google Contacts Api

> ID：14407415
> 
> 赞同：5
> 
> 时间：2013-01-18T20:51:41.537
> 
> 标签：google-api, oauth-2.0, gdata-api, google-contacts-api, service-accounts

我目前正在通过 OAuth 2.0 和所谓的服务帐户实现对 Google 通讯录的访问。服务帐户是为像“My.Name@gmail.com”这样的普通用户生成的。

生成 OAuth 2.0 凭据的代码是：

```
public static GoogleCredential getCredentials() throws GeneralSecurityException, IOException {
    GoogleCredential credential = new GoogleCredential.Builder().setTransport(HTTP_TRANSPORT)
            .setJsonFactory(JSON_FACTORY)
            .setServiceAccountId(SingleUserCredentials.SERVICE_ACCOUNT_EMAIL)
            .setServiceAccountScopes("https://www.google.com/m8/feeds")
            .setServiceAccountPrivateKeyFromP12File(new File(SingleUserCredentials.SERVICE_ACCOUNT_PKCS12_FILE_PATH))
            .build();
    credential.refreshToken();
    return credential;
} 
```

然后我试图通过以下方式检索联系人：

```
 ContactsService myService = new ContactsService(
            "myApp");

    myService.setOAuth2Credentials(getCredentials());

    URL feedUrl = new URL("https://www.google.com/m8/feeds/contacts/default/full");
    Query myQuery = new Query(feedUrl);
    ContactFeed resultFeed = myService.query(myQuery, ContactFeed.class);
    // Print the results

    for (ContactEntry entry : resultFeed.getEntries()) {
        System.out.println(entry.getName().getFullName().getValue());
        System.out.println("Updated on: " + entry.getUpdated().toStringRfc822());
    } 
```

问题是我没有从我的帐户中获得任何联系人。提要始终为空。没有错误。没有什么。

当通过相同的方法访问 Google Apps 托管域时，它运行良好。

我想知道在使用 p12 密钥文件和服务帐户时，Contacts Api 是否支持普通（又名@gmail.com）帐户的 OAuth 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:59:54.683

我自己也遇到了同样的问题。

我尝试了设置密钥时收到的电子邮件地址和域管理员的电子邮件地址。

当我使用密钥设置中的电子邮件时，我什么都没有收到——没有警告、没有异常，也没有数据。

当我使用域管理员的电子邮件地址时，我收到异常：

```
com.google.api.client.auth.oauth2.TokenResponseException: 400 OK
     [java] {
     [java]   "error" : "invalid_grant"
     [java] }
     [java] Feb 5, 2013 5:16:48 PM com.google.appengine.repackaged.org.apache.http.impl.client.DefaultRequestDirector handleResponse
     [java] WARNING: Authentication error: Unable to respond to any of these challenges: {}
     [java] Feb 5, 2013 5:16:48 PM com.google.apphosting.utils.jetty.JettyLogger warn
     [java] WARNING: /
     [java] java.lang.NullPointerException: No authentication header information 
```

...

所以，我认为域管理员的电子邮件地址不是我需要的。

接下来，在找到此页面之前，我搜索了一段时间：

[http://javadoc.google-api-java-client.googlecode.com/hg/1.13.2-beta/com/google/api/client/googleapis/auth/oauth2/GoogleCredential.html](http://javadoc.google-api-java-client.googlecode.com/hg/1.13.2-beta/com/google/api/client/googleapis/auth/oauth2/GoogleCredential.html)

我在那里看到了getServiceAccountUser()。该字段的描述是：

返回应用程序尝试在服务帐户流中模拟的用户的电子邮件地址，或者返回 null 表示无或不使用服务帐户流。

果然，有一个相应的 setServiceAccountUser (String) 接受您使用服务帐户模拟的用户的用户名（电子邮件地址）。

我将该字段设置为适当的值，并且能够继续。

回想起来，这一切都是有道理的——如果我不提供我正在尝试使用的帐户，我就无法删除该帐户的联系人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T14:08:12.773

目前无法使用服务帐户访问联系人，因为 Google APIs Console 的[Google APIs Console](http://developers.google.com/console "Google API 控制台")不支持它。

另请参阅：[服务帐户](https://developers.google.com/accounts/docs/OAuth2#serviceaccount "服务帐号")

其次，它仅适用于 Google 托管域，因为域的管理员必须通过以下过程授予对服务帐户的访问权限：

**将域范围的权限委派给您的服务帐户**

您现在创建的服务帐户需要被授予访问您要访问的 Google Apps 域的用户数据的权限。以下任务必须由 Google Apps 域的管理员执行：

1.  转到您的 Google Apps 域的控制面板。该 URL 应类似于：“www.google.com/a/cpanel/mydomain.com”

2.  转到高级工具... > 管理第三方 OAuth 客户端访问。

3.  在客户端名称字段中输入服务帐户的客户端 ID。

4.  在一个或多个 API 范围字段中，输入应授予您的应用程序访问权限的范围列表。

5.  单击授权按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T01:39:25.673

我今天遇到了同样的错误，但现在已经放弃使用服务帐户，我认为联系人 API 目前不支持。因此，我将 Contacts API v3 与 OAuth 1.0 一起使用，并获得了预期的结果。

```
 ContactsService contactsService = new ContactsService(APPLICATION_NAME);
 contactsService.setUserCredentials(CLIENT_USERNAME, CLIENT_SECRET);

 URL contactFeedURL = new URL("https://www.google.com/m8/feeds/contacts/default/full");
 Query contactFeedQuery = new Query(contactFeedURL);

 ContactFeed contactFeed = contactsService.getFeed(contactFeedQuery, ContactFeed.class); 
```

# r - 从数据框中选择具有相同列的行

> ID：14407418
> 
> 赞同：3
> 
> 时间：2013-01-18T20:51:55.857
> 
> 标签：r, dataframe

我有一个包含几列的数据框。我想选择没有`NA`s 的行（与 s 一样`complete.cases`）并且所有列都相同。例如，对于

```
> f <- data.frame(a=c(1,NA,NA,4),b=c(1,NA,3,40),c=c(1,NA,5,40))
> f
   a  b  c
1  1  1  1
2 NA NA NA
3 NA  3  5
4  4 40 40 
```

我希望向量`TRUE,FALSE,FALSE,FALSE`只选择第一行，因为所有 3 列都是相同的，没有一个是`NA`.

我可以

```
Reduce("==",f[complete.cases(f),]) 
```

但这会创建一个我希望避免的中间数据帧（以节省内存）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T20:57:35.767

尝试这个：

```
R > index <- apply(f, 1, function(x) all(x==x[1]))
R > index
[1]  TRUE    NA NA FALSE
R > index[is.na(index)] <- FALSE
R > index
[1]  TRUE FALSE FALSE FALSE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T16:23:16.440

最好的（IMO）解决方案来自[David Winsemius](https://stat.ethz.ch/pipermail/r-help/2013-January/345586.html)：

```
which( rowSums(f==f[[1]]) == length(f) ) 
```

# c++ - 如何有效地找到最接近两个整数平均值的最大整数，增量为 100,000？

> ID：14407419
> 
> 赞同：0
> 
> 时间：2013-01-18T20:52:07.010
> 
> 标签：c++, algorithm, math

假设我得到整数`x`和`y`（满足`x <= y`一个数字，`0`因此它们尤其可以被二整除）。然后我知道他们的平均值`avg = ((x+y) / 2)`也是一个整数。我想找到这个中点四舍五入的分辨率`100`。换句话说，如果我的两个输入是 75200 和 75300，那么平均值是 75250 并四舍五入到最接近的值`100`（但不超过或等于更大的数字）强制答案为 75200。

如何在不首先将所有内容除以 100 并使用以下浮点运算的情况下实现此逻辑：

`x + std::floor((y - x) * .5 * 100 + .5)*0.01`

换句话说，我怎样才能在没有浮点值的情况下执行上述操作，但在分辨率下获得相同的行为`100`而不是`0.01`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:03:26.803

要计算你可以做的平均值

```
avg = (x + y) / 2 
```

（顺便说一句，即使在小型微控制器上，整数加法和除以 2 也是非常便宜的操作。）

要将其四舍五入到最接近的 100 倍数（对应于您的浮点示例），您可以这样做

```
result = ((avg + 50) / 100) * 100 
```

整数除法向下舍入到最接近的整数。通过将其更改`50`为`0`您可以始终向下舍入，而将其更改为`99`始终向上舍入。

**编辑：**请注意，这种舍入方法不适用于负数。由于整数除法向零舍入，因此在这种情况下，您需要减去`50`，减去`99`始终向下舍入并减去`0`以始终向上舍入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:23:21.100

您有问题的示例需要强条件：

*   x 和 y 之间的差值需要不大于 100
*   y % 100 必须为 0

因此，在大多数情况下，简单的四舍五入非常适合您：

```
avg100 = avg - (avg % 100) + 100 
```

棘手的部分是在没有条件的情况下修复剩余的错误 - 如果您想避免条件或操作缓慢。

为此，最好的方法是使用乘法，并将表达式分成两部分：

```
avg100 = avg - (avg % 100)
avg100 += 100 * !!(y - avg100) 
```

大多数情况下，y 大于 avg100。在这种情况下，`!!`运算符将返回 1。在极少数情况下，当它们相等时，它将返回 0，并且不会更改值。

（不知道编译器是否真的会为'!!'运算符生成无条件的代码，但我没有一个连击的想法，如果可能的话，我认为它会。如果没有，这段代码仍然简短易懂。）

此外，您可以使用以下表达式计算平均值：

```
avg = y - (y-x)/2 
```

甚至将除法改为位移位进行优化。

这不需要两个数字都是偶数，只要是相同的奇偶校验。

# tabs - 从 grep 输出中删除选项卡

> ID：14407421
> 
> 赞同：1
> 
> 时间：2013-01-18T20:52:12.637
> 
> 标签：tabs

我有一个命令可以查找特定日期的 IP 地址所在的位置。它看起来像这样：

zcat /nsm/bro/logs/[日期]/http_eth1.* | bro-cut -D "%G-%m-%d %R:%S" ts id.orig_h 主机uri | grep [IP_地址]

它工作得很好，除了一件事。输出如下所示：

2013-01-16 23:38:26 [IP_Address] safebrowsing-cache.google.com /safebrowsing/rd/ChFnb29nLXBoaXNoLXNoYXZhchAAGIX_DyCY_w8yB4X_AwD__w8

“safebrowsing-cache.google.com”和“/safebrowsing/rd/ChFnb29nLXBoaXNoLXNoYXZhchAAGIX_DyCY_w8yB4X_AwD__w8”之间有一个标签。我只想删除该特定选项卡。有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:11:57.557

利用`awk`

示例：`echo -n 'first\tsecond\tthird\tfourth\n' | awk '{ print $1"\t"$2"\t"$3$4 }'` 输出`first\tsecond\tthirdfourth`——“第三”和“第四”之间的选项卡已被删除。

# node.js - 从 C++ 在 v8 ObjectWrap 上调用为 JS 包装的方法

> ID：14407430
> 
> 赞同：0
> 
> 时间：2013-01-18T20:52:53.940
> 
> 标签：node.js, v8

我正在使用一个节点模块，并希望在 C++ 的 ObjectWrap 的子类上调用它的一些方法。我并不完全清楚如何在函数定义中正确构造 Arguments 对象。

例如，我想调用以下方法（Context2d extends ObjectWrap）：

```
Handle<Value>
Context2d::LineTo(const Arguments &args) {
    HandleScope scope;

    if (!args[0]->IsNumber()) 
        return ThrowException(Exception::TypeError(String::New("lineTo() x must be a number")));
    if (!args[1]->IsNumber()) 
        return ThrowException(Exception::TypeError(String::New("lineTo() y must be a number")));

    Context2d *context = ObjectWrap::Unwrap<Context2d>(args.This());
    cairo_line_to(context->context(), args[0]->NumberValue(), args[1]->NumberValue()); 

    return Undefined();
} 
```

所以，简而言之：有一个展开的 Context2D，我如何调用静态 LineTo 以便从 args.This 调用返回相同的实例？我当然意识到我可以通过深入研究 v8 来解决这个问题，但我希望了解该主题的人可以为我指明正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T05:16:34.660

你应该可以用这样的东西来调用它。我假设函数`toLine`在对象上。你还没有展示你的对象原型构造，所以你必须调整它以匹配。

```
int x = 10;
int y = 20;
Context2D *context = ...;

// Get a reference to the function from the object.
Local<Value> toLineVal = context->handle_->Get(String::NewSymbol("toLine"));
if (!toLineVal->IsFunction()) return; // Error, toLine was replaced somehow.

// Cast the generic reference to a function.
Local<Function> toLine = Local<Function>::Cast(toLineVal);

// Call the function with two integer arguments.
Local<Value> args[2] = {
  Integer::New(x),
  Integer::New(y)
};
toLine->Call(context->handle_, 2, args); 
```

这应该等同于这个 JS：

```
var toLineVal = context.toLine;
if (typeof toLineVal !== 'function') return; // Error

toLineVal(10, 20); 
```

# ckeditor - 如何判断是否在 CKEditor 中选择了任何内容

> ID：14407433
> 
> 赞同：0
> 
> 时间：2013-01-18T20:53:14.197
> 
> 标签：ckeditor, selection

我正在尝试使用 Javascript 确定是否在 CKEditor 中选择了任何内容。我希望有一个像`editor.hasSelection()`. 我开始使用`editor.getSelection().getSelectedText() === ""`，但如果选择了一个没有“文本”的元素（如 img），那么它将是一个空白字符串，给我一个假阴性。我也研究了`editor.getSelection().getSelectedElement()`，但如果选择了多个元素，则会给出 null 。

有什么我在 API 中看不到的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:54:31.737

在我看来，CKEditor 选择 API 中没有任何内容可以直接执行此操作。但是，我认为以下内容会做到这一点，尽管我同意这是一种耻辱（并且令人惊讶），没有等效于[`isCollapsed`](https://developer.mozilla.org/en-US/docs/DOM/Selection/isCollapsed)本机浏览器`Selection`对象的属性。

这是未经测试的，但看起来好像可以工作：

```
function hasSelection(editor) {
    var sel = editor.getSelection();
    var ranges = sel.getRanges();
    for (var i = 0, len = ranges.length; i < len; ++i) {
        if (!ranges[i].collapsed) {
            return true;
        }
    }
    return false;
}

// Example:
alert( hasSelection(editor) ); 
```

# windows - 从本地源安装 Windows 8 应用程序？

> ID：14407437
> 
> 赞同：1
> 
> 时间：2013-01-18T20:53:41.327
> 
> 标签：windows, windows-8, microsoft-metro

> **可能重复：**
> [从本地源安装 Windows 8 应用程序？](https://stackoverflow.com/questions/14407334/install-windows-8-application-from-a-local-source)

如何安装从本地源创建的 Windows 8 应用程序？那可能吗？如果可能的话，你怎么会遇到这样的事情？

还是您必须将其提交到 Microsoft Store？

我问是因为我需要为公司创建一个私有的应用程序，但没有遇到任何文档或任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:24:03.267

侧载有几个选项，但在您的特定情况下“*公司私有的应用程序*”，最好的参考是[如何添加和删除应用程序](http://msdn.microsoft.com/en-us/library/hh852635.aspx)。

简而言之，对于 Windows 8 Enterprise 设备，如果它们加入域，您可以旁加载应用程序（从 .appx 文件）。对于其他版本的 Windows 8（或未加入域），您需要购买[旁加载产品激活密钥](http://www.microsoft.com/licensing/existing-customers/product-activation.aspx)。

# .htaccess - htaccess - rewritecond 检查斜线

> ID：14407446
> 
> 赞同：2
> 
> 时间：2013-01-18T20:54:16.903
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我的网站上有这样的重写：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ open.php?url=$1 [L] 
```

（上面有很多，但这是最后一条规则）

它工作得很好。

但是，我想要实现的是，如果 url 如下所示：

```
http://site.com/first/second 
```

然后我想重定向到

```
open.php?url=$1&open=$2 
```

问题是我想同时拥有它们，以便 site.com/foo 和 site.com/foo/bar 一样好用。我还想避免一直有一个斜线，因此同时遵守两条规则。

如果有办法用某种 rewritecond 检查尾部斜杠

任何帮助表示赞赏:)

## 解决了

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/(.*)/(.*)$
RewriteRule ^(.*)$ open.php?url=$1 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} /(.*)/(.*)
RewriteRule ^(.*)/(.*)$ open.php?url=$1&open=$2 [L] 
```

我必须添加的只是`RewriteCond %{REQUEST_URI} !^/(.*)/(.*)$`第一条规则！

# wordpress - 有没有办法检查帖子是否附加到特定分类？

> ID：14407447
> 
> 赞同：0
> 
> 时间：2013-01-18T20:54:21.330
> 
> 标签：wordpress, post, conditional, taxonomy

我想创建一个条件，如果帖子附加到特定分类，则在修改后的 single.php 上执行一些额外的代码，但我找不到直接检查分类的方法。我认为“is_tax”可能会完成这项工作，但似乎这个标签只对存档页面有效，我认为这意味着一个使用分类名称从模板生成的页面。

有没有一种直接的方法可以从单个帖子中读取分类法，以便我可以做类似的事情： `if (is_tax('chapter')) {additional code}`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T07:27:53.657

我为此制定了一种解决方案，如下所示：

```
$terms = get_the_terms( $post->ID , 'chapter');
 if($terms) { *additional code to be added to the template* } 
```

如果返回分类“章节”中的任何术语，则将附加代码添加到模板中，否则将省略附加代码。

我不知道这是否需要任何额外的错误检查，但显示的代码通过在适当的帖子中包含代码并在不需要的地方省略它来工作。

欢迎任何关于改进的建议。

# css - 我使用的 div 越多，我得到的差距就越大

> ID：14407450
> 
> 赞同：0
> 
> 时间：2013-01-18T20:54:31.693
> 
> 标签：css, html

我最近开始使用 div 将我的页面上的艺术安排在一个非常特定的位置。在我得到我认为正确的东西之后，我在所有 div 下得到了这个巨大的差距。似乎我使用的 div 越多，差距就越大。我只是想让那个差距消失。有高手解答一下吗？

这是我的代码：

```
<div>
    <div style="position: relative; left: 12px; top: -20px; width: 970px; height: 0px;">
        <img class="alignnone size-full wp-image-1285 devanco_ep_curimg" alt="dsm-napkin-top-TEMP" src="http://thedsmgroup.com/jason/wp-content/uploads/2013/01/dsm-napkin-full.png" width="1001" height="131" />
    </div>
    <div style="position: relative; left: 65px; top: -20px; width: 450px; height: 100px; padding: 20px;">
        <div>
            <h5>We’re a creative full service marketing firm in Northern New Jersey.</h5>
            <h6>Creative Branding | Advertising | PR | Website Design | SEO | World Class Client Support</h6>
        </div>
    </div>
</div>
&nbsp;
<div style="position: relative; left: 548px; top: -180px; width: 193px; height: 72px;">
    <a title="The DSM Group Is A Full Service Agency" href="http://thedsmgroup.com/jason/agency-2/">
        <img class="alignnone size-full wp-image-1412" alt="dsm-who-we-are-btn" src="http://thedsmgroup.com/jason/wp-content/uploads/2013/01/dsm-who-we-are-btn.png" width="251" height="66" />
    </a>
</div>
&nbsp;
&nbsp;
<div style="position: relative; left: 750px; top: -339px; width: 193px; height: 72px;">
    <a title="The Most Complete Marketing Agency In NJ" href="http://thedsmgroup.com/jason/services/">
        <img class="alignnone size-full wp-image-1411" alt="dsm-what-we-do-btn" src="http://thedsmgroup.com/jason/wp-content/uploads/2013/01/dsm-what-we-do-btn.png" width="251" height="66" />
    </a>
</div>
&nbsp; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:01:25.670

这是因为所有的顶级调整，如`top:-339px`.

相对定位一个元素并没有真正将它从文档流中取出，它只是使用它的静态空间并从那里移动它。这意味着如果你有这样的元素......

```
.rel {
position:relative;
top:-100px;
} 
```

...从技术上讲，它仍在填充其他空间，因此其他元素不会向上移动以填补空白。

[这是一个 jsFiddle 来说明它。](http://jsfiddle.net/TZ8UA/)

请注意下图中的间隙是如何创建的。

![在此处输入图像描述](../Images/3f69753651f903796d33de3b9b04ac04.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T08:28:31.287

发生这种情况是因为您使用了 nbsp; 或空间所以更多的空间将被 div 标签覆盖..你也使用了 position:relative 和 top:-100px 这也是导致 div 上有巨大差距的原因

# google-maps - 如何获取修改后的drawingManager形状的点坐标？谷歌地图 API v3

> ID：14407451
> 
> 赞同：5
> 
> 时间：2013-01-18T20:54:33.077
> 
> 标签：google-maps, google-maps-api-3

我有这个 DrawingManager 对象：

```
 drawingManager = new google.maps.drawing.DrawingManager({
      drawingMode: google.maps.drawing.OverlayType.POLYGON,
      markerOptions: {
        draggable: true
      },
      polylineOptions: {
        editable: true
      },
      polygonOptions: polyOptions,
      map: map
    }); 
```

当多边形完成时，我得到他们的坐标：

```
 google.maps.event.addListener(drawingManager, 'polygoncomplete', function (polygon) {
        var coordinates = (polygon.getPath().getArray());
        console.log(coordinates);
      }); 
```

但是，如果我使用 DrawingManager 更改多边形，显然形状会改变，可能会添加更多点。
那么在修改后如何获取所有点及其坐标，例如单击按钮完成编辑？提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T23:19:42.460

好的，我的第二个代码有答案：

```
var coordinates = (polygon.getPath().getArray()); 
```

最后，我通过添加一个侦听器来调用获取数组的函数，从而获得了最后一个带有坐标的数组来调用此代码：

JS

```
function getCoordinates() {
    console.log(polygon.getPath().getArray());
}

google.maps.event.addDomListener(document.getElementById('CoordsButton'), 'click', getCoordinates); 
```

HTML

```
<button id="CoordsButton">Coordinates</button> 
```

然后，当现在单击按钮时，我得到了坐标...

不管怎么说，还是要谢谢你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-20T02:24:08.890

这是我们使用事件侦听器使用 for 循环传递多边形坐标的解决方案

```
google.maps.event.addListener(testMap, 'polygoncomplete', function (polygon) {
    var coordinates = (polygon.getPath());
    console.log(coordinates);

for (let i = 0; i < coordinates.getLength(); i++) 
 {
   const xy = coordinates.getAt(i);
   var contentString = console.log(JSON.stringify({point: xy +[i+1]}))
 } 
```

# networking - linux内核中UDP数据包的路径

> ID：14407452
> 
> 赞同：5
> 
> 时间：2013-01-18T20:54:38.913
> 
> 标签：networking, linux-kernel, udp

我想在 Linux 内核中找到一个 UDP 数据包的路径。为此，我想阅读一些文档（到目前为止我有[这个，它是针对 TCP 的），然后在相关的内核函数中有一些 printk 语句来确认这一点。](http://hsnlab.tmit.bme.hu/twiki/pub/Targyak/Mar11Cikkek/Network_stack.pdf)我将通过重新编译内核代码来做到这一点。

这是解决问题的方法吗？你有什么建议/参考吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T05:56:03.257

具体回答您的问题，要了解 IPv4 的 UDP 处理，您可以使用 ftrace，如下所示：

在入口（接收方）：

```
 96882  2)               |                                ip_local_deliver_finish() {
 96883  2)   0.069 us    |                                  raw_local_deliver();
 96884  2)               |                                  udp_rcv() {
 96885  2)               |                                    __udp4_lib_rcv() {
 96886  2)   0.087 us    |                                      __udp4_lib_lookup();
 96887  2)               |                                      __skb_checksum_complete_head() {
 96888  2)               |                                        skb_checksum() {
 96889  2)               |                                          __skb_checksum() {
 96890  2)               |                                            csum_partial() {
 96891  2)   0.161 us    |                                              do_csum();
 96892  2)   0.536 us    |                                            }
 96893  2)               |                                            csum_partial() {
 96894  2)   0.167 us    |                                              do_csum();
 96895  2)   0.523 us    |                                            }
 96896  2)               |                                            csum_partial() {
 96897  2)   0.158 us    |                                              do_csum();
 96898  2)   0.513 us    |                                            }
 96899  2)               |                                            csum_partial() {
 96900  2)   0.154 us    |                                              do_csum();
 96901  2)   0.502 us    |                                            }
 96902  2)               |                                            csum_partial() {
 96903  2)   0.165 us    |                                              do_csum();
 96904  2)   0.516 us    |                                            }
 96905  2)               |                                            csum_partial() {
 96906  2)   0.138 us    |                                              do_csum();
 96907  2)   0.506 us    |                                            }
 96908  2)   5.462 us    |                                          }
 96909  2)   5.840 us    |                                        }
 96910  2)   6.204 us    |                                      } 
```

跟踪的另一部分显示如下：

```
 98212  2)               |                              ip_rcv() {
 98213  2)               |                                ip_rcv_finish() {
 98214  2)   0.109 us    |                                  udp_v4_early_demux();
 98215  2)               |                                  ip_route_input_noref() {
 98216  2)               |                                    fib_table_lookup() {
 98217  2)   0.079 us    |                                      check_leaf.isra.8();
 98218  2)   0.492 us    |                                    } 
```

对于网络代码的出口，下面提取了一些片段：

```
 4)   0.547 us    |  udp_poll();
 4)               |  udp_sendmsg() {
 4)               |    udp_send_skb() {
 4)   0.387 us    |      udp_error [nf_conntrack]();
 4)   0.185 us    |      udp_pkt_to_tuple [nf_conntrack]();
 4)   0.160 us    |      udp_invert_tuple [nf_conntrack]();
 4)   0.151 us    |      udp_get_timeouts [nf_conntrack]();
 4)   0.145 us    |      udp_new [nf_conntrack]();
 4)   0.160 us    |      udp_get_timeouts [nf_conntrack]();
 4)   0.261 us    |      udp_packet [nf_conntrack]();
 4)   0.181 us    |      udp_invert_tuple [nf_conntrack]();
 4)   0.195 us    |      udp_invert_tuple [nf_conntrack]();
 4)   0.170 us    |      udp_invert_tuple [nf_conntrack]();
 4)   0.175 us    |      udp_invert_tuple [nf_conntrack]();
 4)               |      udp_rcv() {
 4) + 15.021 us   |        udp_queue_rcv_skb();
 4) + 18.829 us   |      }
 4) + 82.100 us   |    }
 4) + 92.415 us   |  }
 4)               |  udp_sendmsg() {
 4)               |    udp_send_skb() {
 4)   0.226 us    |      udp_error [nf_conntrack]();
 4)   0.150 us    |      udp_pkt_to_tuple [nf_conntrack]();
 4)   0.146 us    |      udp_get_timeouts [nf_conntrack]();
 4)   1.098 us    |      udp_packet [nf_conntrack]();
 4)               |      udp_rcv() {
 4)   1.314 us    |        udp_queue_rcv_skb();
 4)   3.282 us    |      }
 4) + 20.646 us   |    } 
```

上面在 ftrace 中称为函数图：

[如何使 ftrace function_graph 跟踪器可以使用 linux 内核函数？](https://stackoverflow.com/questions/15271551/how-to-make-a-linux-kernel-function-available-to-ftrace-function-graph-tracer)

我用于跟踪 udp 的 bashscript 如下（以 root 身份运行）：

```
#!/bin/bash

mkdir /debug
mount -t debugfs nodev /debug
mount -t debugfs nodev /sys/kernel/debug
echo udp_* >/debug/tracing/set_ftrace_filter
echo function_graph >/debug/tracing/current_tracer
echo 1 >/debug/tracing/tracing_on
sleep 20
echo 0 >/debug/tracing/tracing_on
cat /debug/tracing/trace > /tmp/tracing.out$$ 
```

现在输出文件位于 /tmp/tracing.out 内，其中是 shell 脚本进程。20 秒的目的是允许用户空间活动发生——此时只是开始大量的 UDP 活动。您还可以从上面的脚本中删除“ *echo udp_* >/debug/tracing/set_ftrace_filter* ”，因为默认是跟踪所有内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T02:53:14.020

linux 网络堆栈是内核的一大块，你需要花一些时间研究它。我认为这本书可能会有所帮助（专注于旧内核 2.4 和 2.6，但最新内核 3.x 的逻辑保持不变）：

[了解 Linux 网络内部结构](http://shop.oreilly.com/product/9780596002558.do)

[Linux 网络架构——Linux 内核中网络协议的设计与实现](https://rads.stackoverflow.com/amzn/click/com/0131777203)

您还可以查看以下链接：

[http://e-university.wisdomjobs.com/linux/chapter-189-277/sending-the-data-from-the-socket-through-udp-and-tcp.html](http://e-university.wisdomjobs.com/linux/chapter-189-277/sending-the-data-from-the-socket-through-udp-and-tcp.html)

[http://www.linuxfoundation.org/collaborate/workgroups/networking/kernel_flow](http://www.linuxfoundation.org/collaborate/workgroups/networking/kernel_flow)

[http://wiki.openwrt.org/doc/networking/praxis](http://wiki.openwrt.org/doc/networking/praxis)

[http://www.ibm.com/developerworks/linux/library/l-linux-networking-stack/?ca=dgr-lnxw01lnxNetStack](http://www.ibm.com/developerworks/linux/library/l-linux-networking-stack/?ca=dgr-lnxw01lnxNetStack)

[http://gicl.cs.drexel.edu/people/sevy/network/Linux_network_stack_walkthrough.html](http://gicl.cs.drexel.edu/people/sevy/network/Linux_network_stack_walkthrough.html)

您还需要浏览内核源代码：

[http://lxr.linux.no/#linux+v3.7.3/](http://lxr.linux.no/#linux+v3.7.3/)

使用这个函数开始你的网络子系统之路： [ip_rcv](http://lxr.linux.no/#linux+v3.7.3/net/ipv4/ip_input.c#L383)，它在收到数据包时调用。然后调用其他函数 ( `ip_rcv_finish`,`ip_local_deliver`和 `ip_local_deliver_finish`=> 这个函数负责选择好的传输层)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-25T11:55:24.170

如果您喜欢更直观的方式，请尝试[flame-grahps](http://www.brendangregg.com/flamegraphs.html)。下面是一个 UDP 传输流示例（使用 netperf 传输 UDP 数据包）： [![在此处输入图像描述](../Images/c10ab87e8c30a3df554f38944273e4e1.png)](https://i.stack.imgur.com/zAcZw.png)

这是在 udp_send_skb 上放大的同一张图： [![在此处输入图像描述](../Images/6a0c8df3414d27ac73900fe0149742dd.png)](https://i.stack.imgur.com/1vzmU.png)

您可以对内核中的任何相关流程执行相同的操作。您还可以搜索特定功能或关键字并放大/缩小。这也让您了解流程中较重的功能。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-22T23:07:41.233

这个链接也不错。它讨论了 udp 和底层 IP、NIC 等：

[https://blog.packagecloud.io/eng/2017/02/06/monitoring-tuning-linux-networking-stack-sending-data/](https://blog.packagecloud.io/eng/2017/02/06/monitoring-tuning-linux-networking-stack-sending-data/)

# vba - 如何在 Visio 中使用 VBA 设置自定义单元格属性值？

> ID：14407453
> 
> 赞同：0
> 
> 时间：2013-01-18T20:54:38.853
> 
> 标签：vba, visio

我有一张包含数百种形状的绘图，它们都应用了相同的数据集。在这种情况下，假设我想将每个形状的“Prop.Row_5”行中的值更改为 0001。

目前我有：

```
Sub Macro1()
    Dim vsoPage As Visio.Page, vsoShape As Visio.Shape
    Dim vsoStrng As String

    For Each vsoPage In ThisDocument.Pages
        For Each vsoShape In vsoPage.Shapes
            vsoShape.CellsSRC(visSectionProp, 4, visCustPropsValue).FormulaU = "0001"

        Next
    Next

End Sub 
```

这是我尝试过的几种不同方法之一，似乎没有任何效果。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-04T10:19:16.430

如果属性是数字，您的代码应该可以工作，或者您可以不加逗号，

```
Dim vsoPage As Page
Dim vsoShape As Shape

For Each vsoPage In ThisDocument.Pages
    For Each vsoShape In vsoPage.Shapes
        vsoShape.CellsSRC(visSectionProp, intRowNum, _
            visCustPropsValue).FormulaU = 1
    Next
Next 
```

但是，如果属性是字符串，则必须使用三个逗号，例如

```
 vsoShape.CellsSRC(visSectionProp, intRowNum, _ 
            visCustPropsValue).FormulaU = """0001""" 
```

这是因为公式本身是一个字符串，只有在其中包含“”字符时才会计算为字符串。否则，if 会查找以您输入的字符串命名的变量、函数或单元格。

希望这对您有所帮助。

问候，

# arrays - 为什么 Array.delete 里面 Array.each 不删除所有项目？

> ID：14407455
> 
> 赞同：2
> 
> 时间：2013-01-18T20:54:44.220
> 
> 标签：arrays, ruby

我是 Ruby 新手，我编写了一个非常简单的应用程序来打印星期几，然后循环删除一天：

```
def print_days(days)
    days.each do |day|
        print "The day of the week is: #{day}\n"
        days.delete(day)
        print "\n*****************************************************\n"
        print days
        print "\n*****************************************************\n"
    end
end

wd = %w[Monday Tuesday Wednesday Thursday Friday Saturday Sunday]

print print_days(wd 
```

这在运行时会给出以下输出。谁能解释为什么当我按顺序删除每个元素并且数组显示它们在那里时，为什么会跳过周二、周四和周六？你可以在你的设置中运行这个简单的代码：

```
The day of the week is: Monday

*****************************************************
["Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"]
*****************************************************
The day of the week is: Wednesday

*****************************************************
["Tuesday", "Thursday", "Friday", "Saturday", "Sunday"]
*****************************************************
The day of the week is: Friday

*****************************************************
["Tuesday", "Thursday", "Saturday", "Sunday"]
*****************************************************
The day of the week is: Sunday

*****************************************************
["Tuesday", "Thursday", "Saturday"]
*****************************************************
["Tuesday", "Thursday", "Saturday"] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T20:58:45.550

您在遍历数组时从数组中删除元素，从而使迭代器无效。

你可以试试

```
 until (days.empty?) 
       day = days.shift
       print "The day of the week is: #{day}\n"
   end 
```

或者

```
 days.each{|day| print "The day of the week is: #{day}\n"}
   days.clear 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:00:15.723

您在所有元素的迭代期间修改数组。在内部，每个方法都保留它产生的最后一个项目的索引到您的块。这基本上使迭代器无效。其他语言会为您抛出异常。

红宝石没有。

所以第一次通过它产生索引为0的元素

然后删除索引 0 处的元素

然后下一次通过它产生索引 1 处的元素，这基本上跳过了星期二，因为它现在位于索引 0 处。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T21:02:25.767

你打破了基本规则，*不要在你迭代的时候改变你正在迭代的对象！*

这里发生了什么：

1.  遍历数组
2.  从第一项开始
3.  删除第一项
4.  数组中的第二项现在是第一项。
5.  抓住第二个项目，因为之前的第二个项目现在是第一个，所以它抓住了以前的*第三个*项目。
6.  删除变异数组中的第二项（以前是第三项）

所以它有点跳过删除所有其他项目。这些类型的奇怪错误是为什么在迭代时更改正在迭代的对象非常不受欢迎的原因。不要那样做。

但是考虑到您的示例是多么人为，很难提出更好的方法。根据您的实际目标，有更好的方法来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:53:27.037

鉴于上述大多数答案都解释了为什么您正在做的事情失败了，您可以使用

```
Array#drop_while
Array#delete_if
Array#select! 
```

或者

```
Array#keep_if 
```

例如

```
a=[1,2,3,4]
a.drop_while{|e| puts e; true} 
```

给

```
1
2
3
4
 => [] 
```

# php - 为什么 site_url 隐藏我的 html 文件

> ID：14407456
> 
> 赞同：1
> 
> 时间：2013-01-18T20:54:44.670
> 
> 标签：php, html, codeigniter, twitter-bootstrap

我试图隐藏我的css url，只显示相对路径。这是我的html

```
<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <!-- Bootstrap -->
    <link href="<?php echo site_url('css/bootstrap.min.css'); ?>" rel="stylesheet" media="screen">
  </head>
  <body>
    <h1>Hello, world!</h1>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html> 
```

然后当我在浏览器中查看时，我的源代码显示了这一点。

```
<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <!-- Bootstrap -->
    <link href=" 
```

我该如何解决。我使用的文件是一个php文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:34:26.717

您是否加载了 url 帮助程序？

```
$this->load->helper('url'); 
```

如果您只想加载一次，您也可以自动加载帮助程序

> 要自动加载资源，请打开 application/config/autoload.php 文件并将要加载的项目添加到 autoload 数组中。您会在该文件中找到与每种类型的项目相对应的说明。

[CodeIgniter 自动加载](http://ellislab.com/codeigniter/user-guide/general/autoloader.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:08:34.610

我在默认的 php 库中找不到函数 site_url，您的服务器上是否启用了 PEAR？

如果你想要你可以使用的相对路径：

```
<?php echo  $SERVER['HTTP_HOST'].'css/bootstrap.min.css'; ?> 
```

要不就

```
../css/bootstrap.min.css 
```

或直接从根

```
/css/bootstrap.min.css 
```

# .net - WebAPI 多个 Put/Post 参数

> ID：14407458
> 
> 赞同：176
> 
> 时间：2013-01-18T20:54:49.880
> 
> 标签：.net, asp.net-web-api

我正在尝试在 WebAPI 控制器上发布多个参数。一个参数来自 URL，另一个来自正文。这是网址： `/offers/40D5E19D-0CD5-4FBD-92F8-43FDBB475333/prices/`

这是我的控制器代码：

```
public HttpResponseMessage Put(Guid offerId, OfferPriceParameters offerPriceParameters)
{
    //What!?
    var ser = new DataContractJsonSerializer(typeof(OfferPriceParameters));
    HttpContext.Current.Request.InputStream.Position = 0;
    var what = ser.ReadObject(HttpContext.Current.Request.InputStream);

    return new HttpResponseMessage(HttpStatusCode.Created);
} 
```

正文的内容是 JSON：

```
{
    "Associations":
    {
        "list": [
        {
            "FromEntityId":"276774bb-9bd9-4bbd-a7e7-6ed3d69f196f",
            "ToEntityId":"ed0d2616-f707-446b-9e40-b77b94fb7d2b",
            "Types":
            {
                "list":[
                {
                    "BillingCommitment":5,
                    "BillingCycle":5,
                    "Prices":
                    {
                        "list":[
                        {
                            "CurrencyId":"274d24c9-7d0b-40ea-a936-e800d74ead53",
                            "RecurringFee":4,
                            "SetupFee":5
                        }]
                    }
                }]
            }
        }]
    }
} 
```

知道为什么默认绑定无法绑定到`offerPriceParameters`我的控制器的参数吗？它始终设置为空。但我可以使用`DataContractJsonSerializer`.

我也尝试使用`FromBody`参数的属性，但它也不起作用。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2016-05-18T11:20:35.417

```
[HttpPost]
public string MyMethod([FromBody]JObject data)
{
    Customer customer = data["customerData"].ToObject<Customer>();
    Product product = data["productData"].ToObject<Product>();
    Employee employee = data["employeeData"].ToObject<Employee>();
    //... other class....
} 
```

使用参考

```
using Newtonsoft.Json.Linq; 
```

使用 JQuery Ajax 请求

```
var customer = {
    "Name": "jhon",
    "Id": 1,
};
var product = {
    "Name": "table",
    "CategoryId": 5,
    "Count": 100
};
var employee = {
    "Name": "Fatih",
    "Id": 4,
};

var myData = {};
myData.customerData = customer;
myData.productData = product;
myData.employeeData = employee;

$.ajax({
    type: 'POST',
    async: true,
    dataType: "json",
    url: "Your Url",
    data: myData,
    success: function (data) {
        console.log("Response Data ↓");
        console.log(data);
    },
    error: function (err) {
        console.log(err);
    }
}); 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2013-01-19T10:35:14.760

原生 WebAPI 不支持绑定多个 POST 参数。正如 Colin 指出的那样，他引用的我的[博客文章中概述了许多限制。](http://www.west-wind.com/weblog/posts/2012/May/08/Passing-multiple-POST-parameters-to-Web-API-Controller-Methods)

通过创建自定义参数绑定器可以解决此问题。执行此操作的代码丑陋且令人费解，但我已经在我的博客上发布了代码以及详细说明，准备在这里插入项目：

[将多个简单的 POST 值传递给 ASP.NET Web API](http://www.west-wind.com/weblog/posts/2012/Sep/11/Passing-multiple-simple-POST-Values-to-ASPNET-Web-API)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2015-07-10T15:22:01.940

如果正在使用属性路由，您可以使用 [FromUri] 和 [FromBody] 属性。

例子：

```
[HttpPost()]
[Route("api/products/{id:int}")]
public HttpResponseMessage AddProduct([FromUri()] int id,  [FromBody()] Product product)
{
  // Add product
} 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-01-24T02:35:07.093

我们通过 HttpPost 方法传递 Json 对象，并将其解析为动态对象。它工作正常。这是示例代码：

网络API：

```
[HttpPost]
public string DoJson2(dynamic data)
{
   //whole:
   var c = JsonConvert.DeserializeObject<YourObjectTypeHere>(data.ToString()); 

   //or 
   var c1 = JsonConvert.DeserializeObject< ComplexObject1 >(data.c1.ToString());

   var c2 = JsonConvert.DeserializeObject< ComplexObject2 >(data.c2.ToString());

   string appName = data.AppName;
   int appInstanceID = data.AppInstanceID;
   string processGUID = data.ProcessGUID;
   int userID = data.UserID;
   string userName = data.UserName;
   var performer = JsonConvert.DeserializeObject< NextActivityPerformers >(data.NextActivityPerformers.ToString());

   ...
} 
```

复杂对象类型可以是对象、数组和字典。

```
ajaxPost:
...
Content-Type: application/json,
data: {"AppName":"SamplePrice",
       "AppInstanceID":"100",
       "ProcessGUID":"072af8c3-482a-4b1c‌​-890b-685ce2fcc75d",
       "UserID":"20",
       "UserName":"Jack",
       "NextActivityPerformers":{
           "39‌​c71004-d822-4c15-9ff2-94ca1068d745":[{
                 "UserID":10,
                 "UserName":"Smith"
           }]
       }}
... 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-02-06T03:49:01.973

一个简单的参数类可用于在帖子中传递多个参数：

```
public class AddCustomerArgs
{
    public string First { get; set; }
    public string Last { get; set; }
}

[HttpPost]
public IHttpActionResult AddCustomer(AddCustomerArgs args)
{
    //use args...
    return Ok();
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-08-24T16:39:40.810

很好的问题和评论 - 从这里的回复中学到了很多:)

作为另一个示例，请注意，您还可以混合使用 body 和 routes，例如

```
[RoutePrefix("api/test")]
public class MyProtectedController 
{
    [Authorize]
    [Route("id/{id}")]
    public IEnumerable<object> Post(String id, [FromBody] JObject data)
    {
        /*
          id                                      = "123"
          data.GetValue("username").ToString()    = "user1"
          data.GetValue("password").ToString()    = "pass1"
         */
    }
} 
```

像这样调用：

```
POST /api/test/id/123 HTTP/1.1
Host: localhost
Accept: application/json
Content-Type: application/x-www-form-urlencoded
Authorization: Bearer x.y.z
Cache-Control: no-cache

username=user1&password=pass1

enter code here 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-10-26T12:32:25.603

[您可以使用https://github.com/keith5000/MultiPostParameterBinding](https://github.com/keith5000/MultiPostParameterBinding)中的 MultiPostParameterBinding 类来允许多个 POST 参数

要使用它：

1) 下载**[Source](https://github.com/keith5000/MultiPostParameterBinding/tree/master/Source)**文件夹中的代码并将其添加到您的 Web API 项目或解决方案中的任何其他项目中。

2）在需要支持多个POST参数的动作方法上使用属性**[MultiPostParameters] 。**

```
[MultiPostParameters]
public string DoSomething(CustomType param1, CustomType param2, string param3) { ... } 
```

3)在调用**GlobalConfiguration.Configure(WebApiConfig.Register)***之前*，将Global.asax.cs 中的这一行添加到 Application_Start 方法中：

 **```
GlobalConfiguration.Configuration.ParameterBindingRules.Insert(0, MultiPostParameterBinding.CreateBindingForMarkedParameters); 
```

4）让您的客户将参数作为对象的属性传递。该方法的示例 JSON 对象`DoSomething(param1, param2, param3)`是：

```
{ param1:{ Text:"" }, param2:{ Text:"" }, param3:"" } 
```

示例 JQuery：

```
$.ajax({
    data: JSON.stringify({ param1:{ Text:"" }, param2:{ Text:"" }, param3:"" }),
    url: '/MyService/DoSomething',
    contentType: "application/json", method: "POST", processData: false
})
.success(function (result) { ... }); 
```

访问[链接](https://github.com/keith5000/MultiPostParameterBinding)了解更多详情。

免责声明：我与链接资源直接相关。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-04-19T21:18:18.553

2021年，有新的解决方案。Pradip Rupareliya 提出了一个很好的建议，我将仅使用 Dict 进行补充，而不是像他那样使用辅助数据结构：

```
[HttpPost]
public ActionResult MakePurchase([FromBody] Dictionary<string, string> data)
{
    try
    {
        int userId = int.Parse(data["userId"]);
        float boughtAmountInARS = float.Parse(data["boughtAmountInARS"]);
        string currencyName = data["currencyName"];
    }
    catch (KeyNotFoundException)
    {
        return BadRequest();
    }
    catch (FormatException)
    {
        return BadRequest();
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-01-19T14:48:51.697

在这种情况下，您的 routeTemplate 是什么样的？

你发布了这个网址：

```
/offers/40D5E19D-0CD5-4FBD-92F8-43FDBB475333/prices/ 
```

为了使它起作用，我希望您的路由中像这样`WebApiConfig`：

```
routeTemplate: {controller}/{offerId}/prices/ 
```

其他假设是： - 你的控制器被称为`OffersController`。- 您在请求正文中传递的 JSON 对象是类型`OfferPriceParameters`（不是任何派生类型） - 您在控制器上没有任何其他可能干扰此方法的方法（如果有，请尝试将它们注释掉并查看发生）

正如菲利普所说，如果您开始接受一些答案，这将对您的问题有所帮助，因为“接受率为 0%”可能会让人们认为他们在浪费时间

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-03-20T05:04:51.553

如果您不想采用 ModelBinding 方式，可以使用 DTO 为您执行此操作。例如，在 DataLayer 中创建一个接受复杂类型并从 BusinessLayer 发送数据的 POST 操作。您可以在 UI->API 调用的情况下执行此操作。

这是示例 DTO。将教师分配给学生并将多篇论文/主题分配给学生。

```
public class StudentCurriculumDTO
 {
     public StudentTeacherMapping StudentTeacherMapping { get; set; }
     public List<Paper> Paper { get; set; }
 }    
public class StudentTeacherMapping
 {
     public Guid StudentID { get; set; }
     public Guid TeacherId { get; set; }
 }

public class Paper
 {
     public Guid PaperID { get; set; }
     public string Status { get; set; }
 } 
```

然后可以将 DataLayer 中的操作创建为：

```
[HttpPost]
[ActionName("MyActionName")]
public async Task<IHttpActionResult> InternalName(StudentCurriculumDTO studentData)
  {
     //Do whatever.... insert the data if nothing else!
  } 
```

从 BusinessLayer 调用它：

```
using (HttpResponseMessage response = await client.PostAsJsonAsync("myendpoint_MyActionName", dataof_StudentCurriculumDTO)
  {
     //Do whatever.... get response if nothing else!
  } 
```

现在，如果我想一次发送多个学生的数据，这仍然有效。修改`MyAction`如下。[FromBody] 不用写，WebAPI2 默认采用复杂类型[FromBody]。

```
public async Task<IHttpActionResult> InternalName(List<StudentCurriculumDTO> studentData) 
```

然后在调用它时，传递一个`List<StudentCurriculumDTO>`数据。

```
using (HttpResponseMessage response = await client.PostAsJsonAsync("myendpoint_MyActionName", List<dataof_StudentCurriculumDTO>) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-03-31T10:44:50.327

**请求参数如**

[![在此处输入图像描述](../Images/ff1b4924fc380a24e1487c2e7f703574.png)](https://i.stack.imgur.com/bSerq.png)

**Web api 代码就像**

```
public class OrderItemDetailsViewModel
{
    public Order order { get; set; }
    public ItemDetails[] itemDetails { get; set; }
}

public IHttpActionResult Post(OrderItemDetailsViewModel orderInfo)
{
    Order ord = orderInfo.order;
    var ordDetails = orderInfo.itemDetails;
    return Ok();
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-08-18T13:24:24.727

您可以将表单数据作为字符串获取：

```
 protected NameValueCollection GetFormData()
    {
        string root = HttpContext.Current.Server.MapPath("~/App_Data");
        var provider = new MultipartFormDataStreamProvider(root);

        Request.Content.ReadAsMultipartAsync(provider);

        return provider.FormData;
    }

    [HttpPost]
    public void test() 
    {
        var formData = GetFormData();
        var userId = formData["userId"];

        // todo json stuff
    } 
```

[https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/sending-html-form-data-part-2](https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/sending-html-form-data-part-2)**

# java - 如何在 JGit 中实现稀疏结帐？

> ID：14407461
> 
> 赞同：0
> 
> 时间：2013-01-18T20:54:53.430
> 
> 标签：java, git, github, jgit, sparse-checkout

我需要在 Github 存储库中提取特定子目录的内容并将其放在我自己的目录下。经过大量研究，似乎稀疏的结帐是要走的路。但是，我有点不确定，如何使用 JGit 来实现它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:13:45.240

1) 你不能只克隆一个 repo 的一部分——例如，一个 repo，`lib`但`Tests`你只想克隆`lib`一部分。

2）您可以使用“git clone --depth DEPTH ...”仅克隆 DEPTH 修订版，但您仍然可以获得整个 repo，而不是所有修订版。（还有其他限制，所以请先`man git-clone`。）

3）您可以执行`git clone --bare ...`，然后只签出您需要的文件（您所说的“稀疏签出”）。（唉，该方法的步骤比这两个要多……）

请注意，在 (3) 中，除非您添加`--depth DEPTH`参数，否则您仍然会得到来自原始仓库的所有历史记录。

# php - 如何将空命名空间添加到 simpleXML 元素

> ID：14407462
> 
> 赞同：0
> 
> 时间：2013-01-18T20:54:56.690
> 
> 标签：php, simplexml, xml-namespaces

为了在 Web 服务的本地 php 测试环境版本中模拟从 SOAP Web 服务检索的 XML，我希望向元素添加一个空名称空间，就像实际 Web 服务本身提供的一样。

但是当我向 addChild 方法添加一个空字符串命名空间参数时，它并没有被添加。任何其他值都会给我一个命名空间，但正如我所说，我希望有一个空的。

所以

```
$xml = new SimpleXMLElement('<cdhead/>');
$nako = $xml -> addChild ('nako', '000', ''); 
```

给我

```
<cdhead>
    <nako>000</nako>
</cdhead> 
```

但我希望拥有

```
<cdhead>
    <nako xmlns="">000</nako>
</cdhead> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:16:12.750

这个问题是因为您使用的是 php 5.2。它是一个错误，已在 PHP 5.2 系列中修复。在这里您可以查看[错误报告](https://bugs.php.net/bug.php?id=41947)。我已经使用 PHP 5.3 进行了测试，您的示例开箱即用。这在任何情况下都应该有效：

```
<?php

$xml = new SimpleXMLElement('<cdhead/>');
$nako = $xml -> addChild ('nako', '000');
$nako->addAttribute('xmlns', '');

echo $nako->saveXml(); 
```

如果 PHP 版本低于 5.3，它会手动添加属性

**更新**我也用 PHP 5.2.17-dotdeb 试过这个，它开箱即用，两者

*   添加属性
*   以空字符串作为命名空间的 addChild

# c++ - C++ 多图操作

> ID：14407463
> 
> 赞同：0
> 
> 时间：2013-01-18T20:55:00.273
> 
> 标签：c++, multimap

我创建了一个多图，因为我有重复键。但我想做一个有效的操作，这样我就可以生成一个新的多图，随后对齐更高的键。这就是我的意思：

这就是我所拥有的：

```
key        values
11          qwer
11          mfiri
21          iernr
21          ghfnfjf
43          dnvfrf 
```

这就是我想要达到的

```
key        values
11          qwer,iernr
11          mfiri,iernr
21         iernr,dnvfrf
21          ghfnfjf,dnvfrf
43          dnvfrf 
```

我有大约 1000 万个条目，所以我正在寻找一些有效的东西。

在上述值中，“qwer,iernr”是一个字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:55:24.267

这是一个简单的方法：

```
auto cur = map.begin();
auto next = map.upper_bound(cur->first);

for(; next != map.end(); next = map.upper_bound(cur->first))
{
    for(; cur != next; ++cur)
    {
        cur->second += ", ";
        cur->second += next->second;
    }
} 
```

...给定一个`std::multimap<int, std::string> map;`

但是，任何转换 10m+ 元素的操作都不会非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:48:02.800

看起来直接的方式可以正常工作。地图元素将按升序排列（假设比较运算符适合您）。因此，只需通过相等的范围并在范围之后使用元素的值修改它们就可以满足您的需求。

克隆地图（如果您需要原始地图），获取第一个元素，获取`equal_range()`其键，使用范围内第二个迭代器的值修改值（除非它是最后一个）。获取`equal_range()`第二个迭代器的键。重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:56:19.740

同意尤金！另请参阅有关 equal_range() [stl::multimap 的以下参考 - 我如何获取数据组？](https://stackoverflow.com/questions/247818/stlmultimap-how-do-i-get-groups-of-data)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T22:16:18.583

为此，您需要简单地遍历地图，同时按顺序构建新地图。

您可以在两个级别上执行此操作：

```
for (auto it=map.cbegin(); it != map.cend(); ) 
{ 
    // The inner loop is over all entries having the same key
    auto next_key_it=find_next_key_after(it);
    for (; it != next_key_it; ++it) {
         new_map.emplace_hint(new_map.end(), it->first, new_value(it->second, next_key_it));
    }
} 
```

new_value 函数（或 lambda）执行值转换（如果第二个参数是 map.end()，则不执行）。

find_next_key_after(it) 函数返回与 map.upper_bound(it->first) 相同的结果，但也可以实现为线性搜索具有不同键的第一个条目。

这取决于您的（预期的）密钥分布，使用哪个 - 如果密钥重复的次数很少，线性搜索更好；如果不同键的数量有限，并且键范围相等，那么upper_bound 可能会更好。

为了保证复杂度，线性搜索更好：整个算法具有 O(n) 复杂度。这是尽可能高效的。

# nosql - Cassandra CQL时间范围查询

> ID：14407468
> 
> 赞同：4
> 
> 时间：2013-01-18T20:55:11.573
> 
> 标签：nosql, cassandra, bigdata, cql

我有一个 Cassandra 列族，我每月存储大量（数十万）事件，时间戳（“Ymdhisu”）作为行键。它有多个列，为每个事件捕获一些数据。我尝试检索特定时间范围的事件数据。例如对于一月份，我使用了以下 CQL 查询：

a) 2013 年 1 月 1 日-1 月 15 日之间的查询

> 从测试中选择计数（*），其中 Key > 20130101070100000000 和 Key < 20130115070100000000 限制 100000；错误请求：开始键的 md5 排序在结束键的 md5 之后。这是不允许的；您可能根本不应该在 RandomPartitioner 下指定结束键

b) 2013 年 1 月 1 日-1 月 10 日范围内的查询

> 从测试中选择计数（*），其中 Key > 20130101070100000000 和 Key < 20130110070100000000 限制 100000；计数 - 73264

c) 2013 年 1 月 1 日至 2 月 2 日之间的查询

> 从测试中选择计数（*），其中 Key > 20130101070100000000 和 Key < 20130102070100000000 限制 100000；计数 - 78328

似乎范围搜索根本不起作用！我的 Columnfamily 的架构是：

```
Create column family Test with comparator=UTF8Type and default_validation_class=UTF8Type and key_validation_class=UTF8Type AND compression_options={sstable_compression:SnappyCompressor, chunk_length_kb:64}; 
```

要提取数据，有什么建议？我是否需要将密钥验证类重新定义为 TimeUUID 类型的架构？有没有其他方法可以在不更改架构的情况下有效地查询？我在这个列族中每月至少处理 100-200K 行数据。如果此模式不适用于此目的，那么存储和检索此处描述的数据类型的合适 Cassandra 模式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:41:16.323

您可以创建二级索引，例如“日期”和“月份”，并将每个事件的日期和月份与其他数据一起存储在这些列中。查询数据时，您可以获取指定月份或日期的所有行。

我不认为 Keys 上的范围查询会起作用。也许如果您将分区器从 RandomPartitioner 更改为 ByteOrderedPartitioner？

# android - Android 应用程序：将 PreferenceFragment 显示为对话框？

> ID：14407469
> 
> 赞同：4
> 
> 时间：2013-01-18T20:55:13.150
> 
> 标签：android, fragment, android-preferences, android-dialogfragment

我是 Android 新手（具有 iOS 背景），我想做以下事情：我制作了一个 PreferenceFragment，我在其中询问用户他的凭据以连接到我的 WebServices。当我检测到这些凭据被我的服务器拒绝时，我想向我的用户显示一个对话框（模式），他可以在其中编辑他的首选项（凭据）。

我已经设法使用 PreferenceActivity 做到了。因此，当我单击一个按钮时，我执行以下代码：

```
Intent settingsActivity = new Intent(getActivity().getBaseContext(), PreferencesConnection.class);
startActivity(settingsActivity); 
```

它将 PreferenceActivity 作为带有 XML 资源的 Dialog 加载：

```
addPreferencesFromResource(R.xml.preferences_connection); 
```

但这是贬值的。我也可以这样做，但是使用 Fragment？我应该使用 DialogFragment 来显示我的 PreferenceFragment，还是不使用？在 DialogFragment 中重建我的凭据会更容易吗？我应该使用 Activity 而不是 Fragment 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T04:30:44.657

要制作一个没有 PreferenceHeaders 的老式单页设置屏幕，请执行以下操作：

在调用设置屏幕的活动中（示例在 onMenuItemSelected 中）：

```
case R.id.menuSettings:
        Intent settingsIntent = new Intent(this, SettingsActivity.class);
        startActivityForResult(settingsIntent, GC.SETTINGS_ACTIVITY_ID);
        break; 
```

在您的 XML 文件夹中，创建一个老式的 PreferenceScreen。PreferenceCategory、ListPreference、CheckBoxPreference 等。不要使用 PreferenceHeaders

创建一个设置活动：

```
package com.mycompany.project1;

import android.os.Bundle;
import android.preference.PreferenceActivity;
import android.preference.PreferenceFragment;

public class SettingsActivity extends PreferenceActivity {

    private final static String TAG = "SettingsAcitivity";

    public SettingsActivity() {}

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        MyLog.d(TAG, "onCreate");
        getFragmentManager().beginTransaction()
                .replace(android.R.id.content, new LocationFragment()).commit();
    }

    public static class LocationFragment extends PreferenceFragment {

        private String TAG = "LocationFragment";

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            MyLog.d(TAG, "onCreate");
            addPreferencesFromResource(R.xml.settings);
        }
    }
} 
```

不要将对话框主题与设置活动相关联。对于某些偏好类型，例如单选按钮，您会得到奇怪的结果。（我尝试了对话框，但找不到编码错误。当我使用标准活动主题而不是对话框主题时，一切正常。显然，全息对话框主题与设置定义冲突。

注意：我使用了 startActivityforResult，因此我可以重新初始化已更改的特定设置值。

# ssas - 排除维度属性中的成员

> ID：14407473
> 
> 赞同：1
> 
> 时间：2013-01-18T20:55:45.513
> 
> 标签：ssas, mdx, olap

SSAS 多维数据集中有没有办法通过更改维度结构来排除维度属性中的成员？我想要一个不使用透视图的解决方案。

例子：

```
California
    - Los Angeles
    - Sacremento
    - San Francisco 
```

假设在上面的层次结构中，我想排除萨克雷门托。有没有办法通过改变维度结构来排除这个成员和其他成员，或者是使用透视图的唯一可能性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:42:27.880

有3种可能：

1.  对 UDM 的数据源视图的查询放置一个过滤器，并删除您不想在多维数据集中看到的任何数据。
2.  为您的多维数据集设置安全性，并拒绝某个角色访问该维度的 sacremento 成员。
3.  编写排除维度成员的特定 MDX 查询，例如

    除外（[州].成员，[州].[萨克拉门托]）

# haskell - getZipList 是如何定义的？

> ID：14407475
> 
> 赞同：8
> 
> 时间：2013-01-18T20:55:57.523
> 
> 标签：haskell, applicative

我很好奇 getZipList 在 ghc 中的定义位置。Control.Applicative 对 ZipList 有这个定义。

```
newtype ZipList a = ZipList { getZipList :: [a] } 
```

使用 ZipLists 的一种方法是（来自 LYAH）：

```
ghci> getZipList $ (+) <$> ZipList [1,2,3] <*> ZipList [100,100,100]

[101,102,103] 
```

我很好奇 getZipList 如何知道要返回什么。也许我错过了关于 newtype 关键字的一些东西。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-18T20:59:19.183

不只是`newtype`，它与`data`. 您似乎不知道的是命名字段语法，

```
newtype ZipList a = ZipList { getZipList :: [a] } 
```

几乎一样

```
newtype ZipList a = ZipList [a]

getZipList :: ZipList a -> [a]
getZipList (ZipList xs) = xs 
```

`data`但是命名字段语法允许更方便的更新和模式匹配 - 特别是对于具有多个字段的类型中的命名字段更加方便。

命名字段（隐式）定义了从包装值中提取包含数据的访问器函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:02:32.977

秘密不在新类型定义中，而是在 <*> 的应用实例中

```
instance Applicative ZipList where  
pure x = ZipList (repeat x)  
ZipList fs <*> ZipList xs = ZipList [f x | (f,x) <- zip fs xs] 
```

默认列表是这样的，这就是差异的来源

```
instance Applicative [] where  
pure x = [x]  
fs <*> xs = [f x | f <- fs, x <- xs] 
```

# java - 单击 JTabbedPane 选项卡时捕获事件（在实际状态更改之前）

> ID：14407479
> 
> 赞同：1
> 
> 时间：2013-01-18T20:56:13.767
> 
> 标签：java, swing, jtabbedpane

我知道我可以添加一个`ChangeListener`来检测选项卡何时更改，但我想在它更改之前执行它。这是我的情况：

当我的用户尝试切换选项卡时，我会对当前选项卡上的一些内容进行验证，并且只有在验证通过时选项卡才应该切换。如果我`addChangeListener`在验证失败时使用并切换回它（希望它发生得足够快以至于我不会看到它）我会看到选项卡切换然后立即切换回来，这看起来很愚蠢。

内部的某些内容`JTabbedPane`正在响应选项卡单击以确保触发状态更改，我只是想知道此功能是否在类之外公开。无论哪种方式，有没有一个好的解决方案？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:18:33.207

这是一个在切换选项卡之前通过创建自定义 VetoableSingleSelectionModel 进行验证的好方法：

[禁止在 JTabbedPane 中更改选项卡](https://stackoverflow.com/questions/12389801/forbid-tab-change-in-a-jtabbedpane)

# xcode - 我在 Xcode 中按下按钮时的加速度计界面和 GPS

> ID：14407481
> 
> 赞同：-1
> 
> 时间：2013-01-18T20:56:23.370
> 
> 标签：xcode, button, gps, accelerometer

当我在 Xcode 中按下按钮时，我希望同时获得加速度计界面和 GPS 的值。

我现在知道单例概念，但我不知道如何通过按一个按钮来启动加速度计和 GPS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T14:51:29.240

答案是添加所需的接口，如下所示：

```
@interface OverlayViewController : UIViewController <UINavigationControllerDelegate, UIImagePickerControllerDelegate, CLLocationManagerDelegate> 
```

# node.js - 快递中的 req.cookies 没有被填充

> ID：14407492
> 
> 赞同：4
> 
> 时间：2013-01-18T20:57:18.017
> 
> 标签：node.js, cookies, express, passport.js

我正在将会话 cookie 设置为 PassportJS 的一部分。我可以看到 connect.sid cookie 被传递给浏览器，并在随后的 HTTP 请求中返回给应用程序。

但是，当我在其中一条路线中读取 req.cookies 时，它是空的。我在配置设置中设置了 express.cookieParser()、express.session() 和 passport.session()。为了在 Express / Node 中使用 cookie，还有什么需要做的吗？

这是我的应用程序配置设置：

```
app.configure(function () {
  app.set("db_url", config.db[app.settings.env]);
  app.set('port', process.env.PORT || 3000);
  app.use(express.logger('dev'));  /* 'default', 'short', 'tiny', 'dev' */
  app.use(express.static(path.join(__dirname, 'public')));
  app.use(express.cookieParser());
  app.use(express.bodyParser());
  app.use(express.session({secret: "keyboard cat"}));
  app.use(passport.initialize());
  app.use(passport.session());
  app.use(users);
  app.use(orgs);
  app.use(errorHandler);
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-19T12:16:24.937

试试`req.session`吧`req.cookies`。如果您想在 cookie 中存储信息，您需要将它们设置为

```
res.cookie('remember', 1, { maxAge: 60 * 1000 }); 
```

那么`req.cookies`应该包含

```
{ remember: '1' } 
```

`req.session`的默认值为

```
{ cookie: 
  { path: '/',
    _expires: null,
    originalMaxAge: null,
    httpOnly: true
  }
} 
```

# android - 在 Eclipse 中引用 Android 库项目的推荐方法是什么

> ID：14407496
> 
> 赞同：0
> 
> 时间：2013-01-18T20:57:48.210
> 
> 标签：android, eclipse

当我学习 Android 开发（通过 Eclipse）时，让我继续感到沮丧的一件事是让引用 Android 库项目的 Android 应用程序项目可靠地工作。有时，应用程序项目由于缺少库中定义的类引用而无法构建，有时它会构建但随后在运行时崩溃，并且引用了库中定义的类，并带有错误链接

```
java.lang.NoClassDefFoundError: com.dave.customviewtestlib.LibTestClass 
```

由 logcat 显示。

我正在使用 Android 开发者工具构建：v21.0.1-543035

我创建了一个工作区，其中包含最简单的 Android 应用程序项目，并引用了最简单的 Android 库项目。我应该如何在 Eclipse 中将它们绑定在一起？他们都自己建造得很好。然后我编辑 Android 应用程序项目的“Java 构建路径”。令人困惑的是，似乎有很多方法可以引用库项目。有时一种方法有效，然后它停止工作，另一种方法在开始工作之前不起作用。我应该

1.  在 app 项目的 Java Build Path | 项目，“添加”库项目，或
2.  在 app 项目的 Java Build Path | 库，“添加 Jar”并指向包含库的类和其他资源的 .jar，或
3.  在 app 项目的 Java Build Path | 库，“添加类文件夹”并指向包含类的库项目的“bin”文件夹，或
4.  在 app 项目的 Java Build Path | 源，“添加文件夹”并指向库项目的源文件夹，或
5.  还有什么？

此外，还有神秘的 Java Build Path | 订单和导出选项卡。这意味着什么？

我还有一个相关的问题：这些所谓的 Android 库是像静态库（您在构建时引用它们并且代码被吸入，而在运行时它只是应用程序二进制文件的一部分），还是像动态库（它们可以单独安装在设备上）？我知道这都是Java，所有类都是由类加载器在运行时加载的，但我认为仍然有一个重要的区别。大多数教程和参考资料都如此愚蠢，获得答案是无望的。

任何帮助都将真正有助于减少我的烦恼:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:01:42.503

在包资源管理器视图中：

右键单击库项目 -> 项目属性 -> android 选项卡

检查：是图书馆。

右键单击 Android 项目 -> 项目属性 -> android 选项卡

单击“添加”按钮，然后从列表中选择您的库项目。

为了回答您的“静态问题”，Android 库项目和 jar'd 库之间的区别在于，android 工具会自动修复您的项目（生成的 R 文件等）的资源 (xml) 引用，然后将类打包到.jar 文件并将其添加到项目的 apk 中。所以它是静态包含的。

至于您的构建路径以及顺序和导出选项卡。构建路径是您可以添加的位置：.jar 文件、工作空间中的其他项目以及项目的其他源文件。您可以在此处的 order/export 选项卡中选择哪些库/类文件将静态包含在项目的 jar 文件中（或 Android 项目中的 apk）。

# xml - 在转换后的 XML 上使用 exslt:node-set()

> ID：14407511
> 
> 赞同：1
> 
> 时间：2013-01-18T20:58:37.577
> 
> 标签：xml, xslt, exslt

使用类似于[在这个问题中找到](https://stackoverflow.com/questions/5372154/how-to-unescape-escaped-xml-content-with-the-help-of-xslt)的答案，我将一个基于 off 的函数组合在一起，以创建一个 XML 结果树片段，并将其加载到一个变量中。

我能够转换这个 XML

```
 <Summary> &lt;Summary&gt;&#xD;
        &lt;Category&gt;&#xD;
            &lt;Category&gt;Tuition and Fees&lt;/Category&gt;&#xD;
            &lt;TotalDebits&gt;0.00&lt;/TotalDebits&gt;&#xD;
            &lt;TotalCredits&gt;-3509.45&lt;/TotalCredits&gt;&#xD;
        &lt;/Category&gt;&#xD;
        &lt;Category&gt;&#xD;
            &lt;Category&gt;Miscellaneous&lt;/Category&gt;&#xD;
            &lt;TotalDebits&gt;60.62&lt;/TotalDebits&gt;&#xD;
            &lt;TotalCredits&gt;-234.36&lt;/TotalCredits&gt;&#xD;
        &lt;/Category&gt;&#xD;
    &lt;/Summary&gt;&#xD;
  </Summary> 
```

对此

```
<Summary>
    <Category>
        <Category>Tuition and Fees</Category>
        <TotalDebits>0.00</TotalDebits>
        <TotalCredits>-3509.45</TotalCredits>
    </Category>
    <Category>
        <Category>Miscellaneous</Category>
        <TotalDebits>60.62</TotalDebits>
        <TotalCredits>-234.36</TotalCredits>
    </Category>
</Summary> 
```

包含在此变量中

```
 <xsl:variable name="SummaryItems">
    <xsl:call-template name="TheGreatUnescape">
      <xsl:with-param name="escaped" select="string(//Summary)" />
    </xsl:call-template>
  </xsl:variable> 
```

现在我的问题是我试图用来`exslt:node-set()`访问这个变量中的节点，但我没有得到任何信息。

使用类似的功能时

```
<xsl:for-each select="exslt:node-set($SummaryItems)/Summary/Category"> 
```

它不会产生任何结果。

我确实在 中包含了`xmlns:exslt="http://exslt.org/common"`声明，`xsl:stylesheet`并且我已经测试了该`node-set`函数，所以我知道它不能与变量中的转换后的 XML 一起工作。

我是否使用可以访问的代码创建了一个真实的结果树片段`exslt:node-set`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:17:33.670

不匹配的最常见原因是它们不在您期望的命名空间中，很难说因为您没有显示完整的代码而是分阶段工作

你说

```
<xsl:copy-of select="exslt:node-set($SummaryItems)"/> 
```

有效，所以试试

```
<xsl:copy-of select="exslt:node-set($SummaryItems)/*"/> 
```

如果可行，请尝试

```
<xsl:copy-of select="exslt:node-set($SummaryItems)/Summary"/> 
```

如果这不起作用，那么在 100 次中有 99 次中`Summary`没有选择哪个是命名空间问题。`<Summary>`

* * *

原始答案（已修复）

```
<xsl:for-each select="exslt:node-set($SummaryItems)\Summary\Category"> 
```

应该给出 XPath 语法错误错误的路径分隔符

```
<xsl:for-each select="exslt:node-set($SummaryItems)/Summary/Category"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T02:59:16.530

David Carlisle 是对的，命名空间问题可能是导致事情不符合预期的最常见原因。

节点集问题的第二个常见来源（至少，它经常发生在我身上）是关于哪些节点由绑定到节点集的变量名称表示的暂时混淆。详细信息将根据绑定的完成方式而有所不同，但从您所说的看来，它似乎很可能`$SummaryItems`绑定到`Summary`包含两个`Category`元素（等）的元素 - 如果是这样，那么表达式`exslt:node-set($SummaryItems)/Summary/Category`将不会产生任何结果，因为`$SummaryItems`不包含`Summary`元素. 你想要的`Summary`元素不是节点的子节点——`$SummaryItems`它们*是*`$SummaryItems`.

在这种情况下，我会尝试`exslt:node-set($SummaryItems)/Category`.

在更一般的情况下，当我遇到这样的麻烦时，我会运行测试代码来找出我在哪里：`name(exslt:node-set($SummaryItems)[1])`例如，返回了什么？

# python - 基于某些字符在python中分割行

> ID：14407513
> 
> 赞同：1
> 
> 时间：2013-01-18T20:58:57.647
> 
> 标签：python

输入：

```
!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/1
2/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:14,000.
0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W
55.576,+0013!,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013!,A,56
281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34
:18,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:19,000.0,0,37N22. 
```

输出：

```
!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:14,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:18,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:19,000.0,0,37N22. 
```

'！' 是起始字符，+0013 应该是每一行的结尾（如果存在）。

我遇到的问题：输出如下：

```
!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/1
2/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:14,000.
0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W 
```

任何帮助将不胜感激......!!!

我的代码：

```
file_open= open('sample.txt','r') 
file_read= file_open.read() 
file_open2= open('output.txt','w+') 
counter =0 
for i in file_read: 
    if '!' in i: 
        if counter == 1: 
            file_open2.write('\n') 
            counter= counter -1 
        counter= counter +1 
    file_open2.write(i) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:05:33.990

You can try something like this:

```
with open("abc.txt") as f:
    data=f.read().replace("\r\n","")  #replace the newlines with ""

    #the newline can be "\n" in your system instead of "\r\n"

    ans=filter(None,data.split("!"))  #split the data at '!', then filter out empty lines
    for x in ans:
        print "!"+x    #or write to some other file
   .....:         
!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:14,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:18,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:19,000.0,0,37N22. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:05:23.490

Could you just use `str.split`?

```
lines = file_read.split('!') 
```

Now lines is a list which holds the split data. This is almost the lines you want to write -- The only difference is that they don't have trailing newlines and they don't have `'!'` at the start. We can put those in easily with string formatting -- e.g. `'!{0}\n'.format(line)`. Then we can put that whole thing in a generator expression which we'll pass to `file.writelines` to put the data in a new file:

```
file_open2.writelines('!{0}\n'.format(line) for line in lines) 
```

You might need:

```
file_open2.writelines('!{0}\n'.format(line.replace('\n','')) for line in lines) 
```

if you find that you're getting more newlines than you wanted in the output.

A few other points, when opening files, it's nice to use a context manager -- This makes sure that the file is closed properly:

```
with open('inputfile') as fin:
    lines = fin.read()
with open('outputfile','w') as fout:
    fout.writelines('!{0}\n'.format(line.replace('\n','')) for line in lines) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:39:04.940

只是为了一些差异，这里是一个正则表达式的答案：

```
import re

outputFile = open('output.txt', 'w+') 
with open('sample.txt', 'r') as f: 
    for line in re.findall("!.+?(?=!|$)", f.read(), re.DOTALL): 
        outputFile.write(line.replace("\n", "") + '\n') 

outputFile.close() 
```

它将打开输出文件，获取输入文件的内容，并使用`!.+?(?=!|$)`带有[re.DOTALL](http://docs.python.org/2/library/re.html#re.DOTALL)标志的正则表达式遍历所有匹配项。正则表达式解释及其匹配的内容可以在这里找到：[http ://regex101.com/r/aK6aV4](http://regex101.com/r/aK6aV4)

找到匹配后，我们从匹配中删除新行，并将其写入文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-18T21:10:39.900

另一个选项，使用`replace`而不是 split，因为您知道每行的开始和结束字符：

```
In [14]: data = """!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/1
2/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:14,000.
0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W
55.576,+0013!,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013!,A,56
281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34
:18,000.0,0,37N22.714,121W55.576,+0013!,A,56281,12/12/19,19:34:19,000.0,0,37N22.""".replace('\n', '')

In [15]: print data.replace('+0013!', "+0013\n!")
!,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:14,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:18,000.0,0,37N22.714,121W55.576,+0013
!,A,56281,12/12/19,19:34:19,000.0,0,37N22. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T08:39:52.420

I will actually implement as a generator so that you can work on the data stream rather than the entire content of the file. This will be quite memory friendly if working with huge files

```
>>> def split_on_stream(it,sep="!"):
    prev = ""
    for line in it:
        line = (prev + line.strip()).split(sep)
        for parts in line[:-1]:
            yield parts
        prev = line[-1]
    yield prev

>>> with open("test.txt") as fin:
    for parts in split_on_stream(fin):
        print parts

,A,56281,12/12/19,19:34:12,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:13,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:14,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:15,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:16,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:17,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:18,000.0,0,37N22.714,121W55.576,+0013
,A,56281,12/12/19,19:34:19,000.0,0,37N22. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T21:09:42.037

让我们尝试`\n`在每个“！”之前添加一个；然后让python[分割线](http://docs.python.org/2/library/stdtypes.html#str.splitlines):-)：

```
file_read.replace("!", "!\n").splitlines() 
```

# android - 切换首选项 - 处理 onPreferenceChange 和 onPreferenceClick

> ID：14407514
> 
> 赞同：8
> 
> 时间：2013-01-18T20:58:59.263
> 
> 标签：android, preferences, listeners

我一直在尝试让一个开关首选项在 Android 中工作，从而我可以在某些情况下以不同的方式拦截和处理，当他们打开/关闭它时，或者当他们点击整个首选项时。

这就是我想要完成的事情：用户进入首选项标签已关闭并且没有存储标签（即：标签首选项为空）用户打开标签的首选项，并且由于当前没有存储标签，因此它启动了标签搜索活动供用户查找标签。- 工作正常。

如果标签已经存在，并且它们仅更改状态，则正常更新值。- 工作正常

这是我的问题：如果他们点击了首选项并且他们已经保存了标签，请不要更改状态（无论它是启用还是禁用），启动标签搜索活动。- 这不起作用。

到目前为止，我发现在上面的最后一个场景中，我收到了对 onPreferenceChanged 的​​调用，然后是对 onPreferenceClicked 的调用，然后是对 onPreferenceChanged 的​​后续调用。这似乎是我的问题。第一次调用 onPreferenceChanged 导致我的 SharedPreferences 上的侦听器被调用，告诉它它现在已启用。

如果我没有收到对 onPreferenceChanged 的​​第一次调用，那么我不会有问题。

这是我设置监听器的相关部分

```
SwitchPreference tagPref = (SwitchPreference) findPreference(PreferencesConstants.PREFERENCE_TAG_ENABLED);
    tagPref.setOnPreferenceChangeListener(new OnPreferenceChangeListener() {

        @Override
        public boolean onPreferenceChange(Preference preference, Object newValue) {
            Log.e("BLAH", "onPrefChanged....is it handled by OnClick?" + Boolean.toString(handledByClick));

            SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(getActivity().getApplicationContext());

            boolean enabled = prefs.getBoolean(PreferencesConstants.PREFERENCE_TAG_ENABLED, false);
            Log.e("BLAH", "value stored in prefs? " + Boolean.toString(enabled));
            if (newValue instanceof Boolean) {
                enabled = (Boolean) newValue;
            }

            Log.e("BLAH", "New value? " + Boolean.toString(enabled));

            if (!handledByClick) {
                if (enabled && (currentTag == null || currentTag.isEmpty())) {
                    Log.e("BLAH", "Enabled and CurrentTag empty!");
                    Intent intent = new Intent(getActivity(), TagSearchActivity.class);
                    startActivityForResult(intent, 0);

                    return false; // always return false, we'll handle
                                    // updating
                                    // this value manually.
                } else {
                    return true;
                }
            }
            Log.e("BLAH", "returning false (AS IN WE HANDLED IT).");
            return false;
        }
    });

    tagPref.setOnPreferenceClickListener(new OnPreferenceClickListener() {

        @Override
        public boolean onPreferenceClick(Preference preference) {

            handledByClick = true;
            Log.e("BLAH", "onprefClick");

            Intent intent = new Intent(getActivity(), TagSearchActivity.class);
            startActivityForResult(intent, 0);

            return true;
        }
    }); 
```

以下是使用保存的标签运行它并单击首选项后的相关日志行。

```
01-18 15:55:05.593: E/BLAH(13261): onPrefChanged....is it handled by OnClick?false
01-18 15:55:05.593: E/BLAH(13261): value stored in prefs? true
01-18 15:55:05.593: E/BLAH(13261): New value? false
01-18 15:55:05.613: E/DifferentClass(13261): On Shared Preferences Changed - tagEnabled
01-18 15:55:05.652: E/DifferentClass(13261): disabled TAG in cancelAlarmService
01-18 15:55:05.662: E/AnotherClass(13261): Updating Feed List.  Old Size: 33, New Size: 14
01-18 15:55:05.682: E/BLAH(13261): onprefClick
01-18 15:55:05.812: E/BLAH(13261): onPrefChanged....is it handled by OnClick?true
01-18 15:55:05.812: E/BLAH(13261): value stored in prefs? false
01-18 15:55:05.822: E/BLAH(13261): New value? false
01-18 15:55:05.822: E/BLAH(13261): returning false (AS IN WE HANDLED IT). 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-11T08:25:29.337

我多年来一直在处理同一个问题，你可以通过两种方式解决这个问题。

**为每个事件实现带有自定义操作的 switchpreference：**

*   [forevercrashed](https://stackoverflow.com/users/1991661/forevercrashed)提出了一些好的观点。我试着跟随他们，但对我来说他们没有这样做。我敢打赌它们会起作用，但我需要以更简单的方式提供更多功能。Xgouchet（第二个链接）使用标题和自定义 xml 布局，这些布局使用自定义放置和测量（高度、宽度、填充等）。我需要一个解决方案，而无需更改 Google 内置的自动生成布局。

*   超级简单而强大的方法：实现你自己的`SwitchPreference`！只需扩展一个类`SwitchPreference`，然后像这样实现/覆盖：

    ```
    public class AutoUploadSwitchPreference extends SwitchPreference {
    public AutoUploadSwitchPreference(Context context) {
        super(context);
    }
    public AutoUploadSwitchPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }
    public AutoUploadSwitchPreference(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    @Override
    protected void onClick() {
        //super.onClick(); THIS IS THE IMPORTANT PART!
    } 
    ```

通过覆盖`onClick()`和注释掉/删除`super.onClick()`使 SwitchPreference **NOT**调用`callChangeListener(Object newValue)`。现在您可以单击首选项并且什么都不会发生，直到您想要它。（否则会发生的一个错误是`onPreferenceChange`在片段中多次调用）

* * *

现在！使事情发生：这是我使用的结构。

*   创建一个`SettingsActivity`
    *   在其中确保您获取偏好、资源等。
*   在`onCreate()`你的活动中 - 启动一个`PreferenceFragment`
    *   这需要是一个自定义类扩展`PreferenceFragment`，请参阅此处：[PreferenceFragment](http://developer.android.com/reference/android/preference/PreferenceFragment.html)
*   在您的自定义片段中，获取您的自定义首选项。您可以使用`findPreference("custom_switch_key")`.

    *   `OnPreferenceChangeListener`在首选项上添加
    *   我个人让我的片段实现监听器并`this`作为参数传递。
    *   return 语句很重要。这就是使交换机发生实际变化的原因。如果您返回 true，则开关将更改为 newValue。如果您返回 false，则不会。如果您使用`return false;`，您可以在 switchpreference 上使用 setChecked(true|false) 更改该值。
*   当您实现时，`onPreferenceChange(Preference preference, Object newValue)`您可以添加任何您想要的功能，只需按下开关滑块

*   单击首选项的功能可以通过三种方式完成：
    *   在自定义类中实现`onClick()`进一步`SwitchPreference`
    *   实现`onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference)`片段中的方法
    *   `onPreferenceClickListener`像您为 ChangeListener 所做的那样实现。

对不起，如果这是一个很长的帖子。这是我的第一个，我已经浏览了很多关于这个的 stackoverflow 页面，没有人是准确的，只是想把它做对；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T21:26:31.247

在搜索了几个小时后，我发现了一些在这种情况下对其他人有帮助的帖子。

鉴于我的问题，这是我选择的解决方案：[如何使用 EditTextPreference 和 Togglebutton 创建一个首选项？](https://stackoverflow.com/questions/9738658/how-do-i-create-one-preference-with-an-edittextpreference-and-a-togglebutton)

这是一个非常详细的答案，对理解偏好非常有帮助。

我遇到的另一篇文章是：http: [//xgouchet.fr/android/index.php ?article4/master-on-off-preferences-with-ice-cream-sandwich](http://xgouchet.fr/android/index.php?article4/master-on-off-preferences-with-ice-cream-sandwich)

它将为您提供与上述几乎相同的外观和感觉，但需要更多的工作，并且由于我的要求对我不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T22:06:38.977

我想你在问一个不存在的功能。

但是，由于首选项活动使用 listView，您可以使用一些技巧来自定义它并按照您的意愿处理它。

[这是](https://stackoverflow.com/questions/10616317/android-showing-listview-in-preferenceactivity)我基于[此网站](http://kmansoft.com/2011/08/29/implementing-long-clickable-preferences/)发布的关于自定义它的帖子。我问的是如何添加 listView ，但我不知道偏好活动实际上使用 listview 。

# image - 如何在 QGLWidget 窗口中平滑移动图像？

> ID：14407519
> 
> 赞同：1
> 
> 时间：2013-01-18T20:59:28.643
> 
> 标签：image, qt, opengl, smooth

我正在编写一个小程序来模拟动画。我使用 QGLWidget 来显示动态图像以模仿图片动画。基本思想是使用纹理并通过QGLFamebufferOject::blitFramebuffer对其进行更新。每次，图像数组都会改变，然后帧缓冲区也会改变。

代码可以运行，图像可以向前移动，但是图像有斩波问题，或者闪烁，不流畅。

下面是一个类的代码：

```
GLWidget::GLWidget(QWidget *parent) : QGLWidget(QGLFormat(), parent)
{
    makeCurrent();

    if (QGLFramebufferObject::hasOpenGLFramebufferBlit()) {

        QGLFramebufferObjectFormat format;
        render_fbo = new QGLFramebufferObject(640, 480, format);
        texture_fbo = new QGLFramebufferObject(640, 480);

    } else {
        render_fbo = new QGLFramebufferObject(640, 480);
        texture_fbo = render_fbo;
    }

    tile_list = glGenLists(1);
    glNewList(tile_list, GL_COMPILE);
    glBegin(GL_QUADS);
    {
        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);
    }
    glEnd();
    glEndList();

    backbufferImg = new unsigned char[640 * 480 * sizeof(unsigned char) * 3];

}

GLWidget::~GLWidget()
{
}

void GLWidget::initializeGL()
{

}

void GLWidget::resizeGL(int width, int height)
{

}

void GLWidget::paintGL()
{

}

void GLWidget::saveGLState()
{
    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glMatrixMode(GL_PROJECTION);
    glPushMatrix();
    glMatrixMode(GL_MODELVIEW);
    glPushMatrix();
}

void GLWidget::restoreGLState()
{
    glMatrixMode(GL_PROJECTION);
    glPopMatrix();
    glMatrixMode(GL_MODELVIEW);
    glPopMatrix();
    glPopAttrib();
}

void GLWidget::changeTextureImage(int nextColumn, int direction)
{
    // code about chaning backbufferImg
    // ...

    // call draw
    draw();
}

void GLWidget::draw()
{
    makeCurrent();

    QPainter p(this);  // used for text overlay

    // save the GL state set for QPainter
    saveGLState();

    QPainter fbo_painter(render_fbo);
    QImage renderImg(backbufferImg, 640, 480, QImage::Format_RGB888);

    fbo_painter.begin(render_fbo);
    QRect rect(640, 480);
    fbo_painter.drawImage(rect, renderImg, rect);
    fbo_painter.end();

    if (render_fbo != texture_fbo) {
        QGLFramebufferObject::blitFramebuffer(texture_fbo, rect, render_fbo, rect);
    } else {
      //  qDebug() << "render_fbo == texture_fbo";
    }

    // draw into the GL widget
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glViewport(0, 0, width(), height());
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    glBindTexture(GL_TEXTURE_2D, texture_fbo->texture());

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glEnable(GL_TEXTURE_2D);

    glPushMatrix();
    glScalef(1.0f, 1.0f, 1.0f);
    glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
    glCallList(tile_list);
    glPopMatrix();

    // restore the GL state that QPainter expects
    restoreGLState();

    glFinish();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:25:44.383

Qt 的 QGLWidget 期望您从其重载执行所有绘图操作`paintGL`函数执行所有绘图操作，以便它与 Qt 的双缓冲区管理很好地迭代。

另外，您为什么要绕过 FBO 来更新纹理？这是非常低效的并且引入了很多同步点。使用*像素*缓冲区对象并使用 glTexSubImage2D 更新纹理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:30:23.247

非常感谢！我改了代码，把绘图代码放在了paintGL里面，没有使用FBO的blit方法。好多了，但仍然需要改进代码。以下是代码：

```
GLWidget::GLWidget(QWidget *parent) :
    QGLWidget(QGLFormat(), parent)
{
    makeCurrent();

    fbo = new QGLFramebufferObject(WIDTH, HEIGHT);

    tile_list = glGenLists(1);
    glNewList(tile_list, GL_COMPILE);
    glBegin(GL_QUADS);
    {
        glTexCoord2f(0.0f, 0.0f); glVertex3f(-1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 0.0f); glVertex3f( 1.0f, -1.0f,  1.0f);
        glTexCoord2f(1.0f, 1.0f); glVertex3f( 1.0f,  1.0f,  1.0f);
        glTexCoord2f(0.0f, 1.0f); glVertex3f(-1.0f,  1.0f,  1.0f);
    }
    glEnd();
    glEndList();

    backbufferImg = new unsigned char[WIDTH * HEIGHT * sizeof(unsigned char) * 3];
}

GLWidget::~GLWidget()
{
    glDeleteLists(tile_list, 1);
    delete fbo;
    delete backbufferImg;
}

void GLWidget::initializeGL()
{

}

void GLWidget::resizeGL(int width, int height)
{

}

void GLWidget::paintGL()
{
    glViewport(0, 0, fbo->size().width(), fbo->size().height());

    glMatrixMode(GL_MODELVIEW);

    // render to the framebuffer object

    fbo->bind();
    glBindTexture(GL_TEXTURE_2D, refreshTexture);
    glCallList(tile_list);
    fbo->release();

 //////////////////////////////////////////////////////////////////////

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glViewport(0, 0, width(), height());
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    glBindTexture(GL_TEXTURE_2D, fbo->texture());

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glEnable(GL_TEXTURE_2D);

    glPushMatrix();
    glScalef(1.0f, 1.0f, 1.0f);
    glColor4f(1.0f, 1.0f, 1.0f, 1.0f);
    glCallList(tile_list);
    glPopMatrix();

    // restore the GL state that QPainter expects
    restoreGLState();

    glFinish();
}

void GLWidget::saveGLState()
{
    glPushAttrib(GL_ALL_ATTRIB_BITS);
    glMatrixMode(GL_PROJECTION);
    glPushMatrix();
    glMatrixMode(GL_MODELVIEW);
    glPushMatrix();
}

void GLWidget::restoreGLState()
{
    glMatrixMode(GL_PROJECTION);
    glPopMatrix();
    glMatrixMode(GL_MODELVIEW);
    glPopMatrix();
    glPopAttrib();
}

void GLWidget::refreshTextureImage(int nextColumn, int direction)
{
    // upadte backbufferImg 
    // add code...

    QImage renderImg(backbufferImg, WIDTH, HEIGHT, QImage::Format_RGB888);

    refreshTexture = bindTexture(renderImg);
    updateGL();
} 
```

我会尝试你建议的方法。但我认为帧缓冲区和像素缓冲区在同一级别。这意味着没有太大的性能差异。对于 glTexSubImage2D，我不太确定，我需要检查一下。

太感谢了。

# performance - 2D FFT 中的 3D FFT 分解

> ID：14407522
> 
> 赞同：3
> 
> 时间：2013-01-18T20:59:31.150
> 
> 标签：performance, parallel-processing, fft

基本上我正在使用 FFT 求解 3D 中的扩散方程，并行化的方法之一是将 3D FFT 分解为 2D FFT。

如本文所述：[https ://cmb.ornl.gov/members/z8g/csproject-report.pdf](https://cmb.ornl.gov/members/z8g/csproject-report.pdf)

分解 3d fft 的方法是：

xy 方向的 2d fft 全局转置 z 方向的 1d fft

基本上，我的问题是我不确定如何进行此全局转置（因为我假设它正在转置我想的 3d 数组）。有人遇到过这个吗？非常感谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T21:09:25.847

想象一个带有`nx*ny*nz`元素的 3d 立方体。这些元素的 3d FFT 在数学上是 3 个阶段的 1-d FFT，沿每个轴一个：

1.  沿 X 轴做 ny*nz 变换，每个变换处理 nx 个元素
2.  nx*nz 沿 Y 轴变换
3.  nx*ny 沿 Z 轴变换

更一般地说，N 维 FFT (N>1) 由沿该轴的许多 (N-1) 维 FFT 组成。

如果信号是真实的，并且您有一个可以返回半频谱的 FFT，那么第 1 阶段的成本大约是前者的一半（真正的 FFT 更便宜），其余的阶段需要很复杂，但它们只需要大约一半许多变换。所以成本大约是一半。

如果您的一维 FFT 可以读取跨步的输入元素并将输出打包到一个连续的缓冲区中，那么您最终会在每个阶段进行转置。

这就是[Kissfft](https://github.com/mborgerding/kissfft/)执行多维 FFT 的方式。

PS当我需要获得更高维度的心理图片时，我会想到：带有数字矩阵的纸张（2d），编号文件的文件夹（3d），编号的文件柜（4d），编号的房间（5d） ），编号建筑物（6d），等等......所以我可以想象“文件柜”尺寸

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T22:28:56.403

论文中提到的“全局转置”不是数学运算，而是[分布式内存机器](http://en.wikipedia.org/wiki/Distributed_memory)之间的数据重排。

在步骤 1 中在一台机器上计算的数据必须传输到所有其他机器，反之亦然，以进行 step to。它与矩阵转置无关。

# android - android：通过下载和解析 layout.xml 在运行时创建 gui

> ID：14407525
> 
> 赞同：0
> 
> 时间：2013-01-18T20:59:56.053
> 
> 标签：android, user-interface

我想在运行时在 android 应用程序中创建 GUI。
例如，我有两个 xmls
1\. layout1.xml 可在 url (http://localhost/layout1.xml)
2\. layout2.xml 可在 url (http://localhost/layout2.xml)

启动 android 应用程序时，用户输入上述网址之一，然后说单击“确定”。
该应用程序将下载相应的 xml。（让我们跳过它是如何下载的，我有这个的代码），然后出现的下一个屏幕应该有从它下载的 xml 生成的 GUI。
如果我在开发 apk 期间创建了这些 xml 并将它们放在“res/layout”下，则 xml 符合相同的准则。

这有可能实现吗？

# ssrs-2008 - RS2008（不是 R2）- 新窗口中的超链接

> ID：14407526
> 
> 赞同：0
> 
> 时间：2013-01-18T21:00:04.047
> 
> 标签：ssrs-2008, reporting, reporting-services

我在 RS2008（不是 R2）中有一份报告，我需要其中一列链接到不同的站点。我可以通过转到文本框属性 -> 操作 -> 超链接 -> 转到 URL -> 插入 URL 公式来完成此操作。

但是，默认情况下，此 URL 使用父窗口。有一个解决方案，您可以在 URL 公式中插入一些 JavaScript（例如 JavaScript:void(window.open('[URL]','_blank')），这也很有效。

问题在于，如果用户随后订阅了该报告，他们会通过电子邮件获得它。由于我们使用桌面邮件客户端（Outlook），JavaScript 不起作用！！！

所以，如果有一种方法可以在单元格中注入 HTML 以便链接在浏览器和桌面邮件客户端中工作，那就太好了。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:00:04.047

在输入我的问题时，我找到了答案，万岁问鸭子！

[http://dinesql.blogspot.com/2010/05/reporting-services-2008-showing-html.html](http://dinesql.blogspot.com/2010/05/reporting-services-2008-showing-html.html)

希望这对使用 RS2008 的下一个可怜的 sap 有所帮助......

# java - 为什么我们不能在生产中使用 RequestParameterRuleFilter？

> ID：14407528
> 
> 赞同：0
> 
> 时间：2013-01-18T21:00:12.870
> 
> 标签：java, oracle, atg

我们在一个尝试实现多站点功能的项目中遇到了一个有趣的情况。

在某些情况下，我们尝试使用一个名为 RequestParameterRuleFilter 的组件来覆盖“siteid”。

Oracle 的 ATG 文档说这个组件需要在生产中关闭，我们正试图找出原因。使用这个组件为我们节省了大量时间，但我们不想因此而冒任何安全漏洞或性能问题的风险。

这里有没有人对这个组件有任何经验，或者知道为什么我们不应该使用它？或者，是否有其他内置于 ATG 的替代组件可以轻松利用来提供多站点功能？

这是文档的链接：http: [//docs.oracle.com/cd/E35318_02/Platform.10-1-1/ATGPlatformProgGuide/html/s0902installedrulefilters01.html](http://docs.oracle.com/cd/E35318_02/Platform.10-1-1/ATGPlatformProgGuide/html/s0902installedrulefilters01.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T10:00:20.137

我认为网站在域名上运行，而不是在可以轻松操作的某些参数基础上运行，可能是您不推荐这样做。我们正在使用 URLPatternMatchingRuleFilter，它基于域名解析站点......并且它工作正常......

# php - 如何更换所有线路和更多？

> ID：14407530
> 
> 赞同：0
> 
> 时间：2013-01-18T21:00:15.223
> 
> 标签：php, replace

现在我的问题是替换从 # 和 /* 到 */ 的所有行（用于注释）。我有代码：

```
<span>#include <a_samp><br />#define NUMBER 5<br />/* Long Comment */ new var[128]; format(var, sizeof(var), "kažkas %s %f", "Stuneris", 1589.0587); SendClientMessage(playerid, 0xFFFFFFFF, var);</span> 
```

我想从`#`所有**行**替换到`<h1>#...(line)</h1>`和从`/*`到`*/`到`<h3>/* Long Comment */</h3>`

我累了`preg_replace('/(/*(?!,)[^"]+*/)/i', '<h3>$1</h3>', $text);`，但它显示警告`Warning: preg_replace(): Unknown modifier '*' in C:\xampp\htdocs\pawn.php on line 18`

我知道，我需要preg_replace，但是怎么组合搜索呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:05:19.177

您需要转义正则表达式中的特殊字符

```
preg_replace('/(\/\*(?!,)[^"]+\*\/)/i', '<h3>$1</h3>', $text); 
```

[**演示**](http://codepad.org/CbSoMUpY)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:07:17.860

您需要尝试以下操作：

```
preg_replace('/(\/\*(?!,)[^"]+\*\/)/i', '<h3>$1</h3>', $text); 
```

*   在所有情况下都是特殊字符 ( [http://www.regular-expressions.info/](http://www.regular-expressions.info/) )。/ 在这里也是“特殊的”，因为您还使用它作为分隔符。

# c# - 使用 Windows 身份验证创建 PrincipalContext

> ID：14407534
> 
> 赞同：3
> 
> 时间：2013-01-18T21:00:21.060
> 
> 标签：c#, asp.net, active-directory, windows-authentication, directoryservices

我正在创建一个 PrincipalContext 对象，用于从我们的 AD 数据库中检索用户组（然后我们使用这些对象对站点的各个部分进行身份验证）。

这曾经是使用表单身份验证完成的，所以代码看起来像这样

```
PrincipalContext pc =
    new PrincipalContext(ContextType.Domain, "domain.com", username, password);

UserPrincipal usp =
    UserPrincipal.FindByIdentity(pc, IdentityType.Guid, user.Guid.ToString());

foreach (var group in usp.GetGroups())
{
    // Add group to collection
} 
```

但是，我们最近切换到 windows 身份验证，我不再可以访问用户的密码。

如何使用当前用户的凭据搜索 AD 数据库？我尝试过使用模拟，但它会引发`An operations error occurred`错误`FindByIdentity`。如果我完全忘记了身份验证，我会限制返回的组数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:15:07.077

这是我使用的一种方法，您可以将其更改为返回一个集合：

```
public static List<string> getGrps(string userName)          
{          
    List<string> grps = new List<string>();          

    try          
    {
        var currentUser = UserPrincipal.Current;
        RevertToSelf();             
        PrincipalSearchResult<Principal> groups = currentUser.GetGroups();          
        IEnumerable<string> groupNames = groups.Select(x => x.SamAccountName);          
        foreach (var name in groupNames)          
        {          
            grps.Add(name.ToString());          
        }          
        return grps;          
    }          
    catch (Exception ex)          
    {          
        // Logging         
    }          
} 
```

我假设您想要结果 IEnumerable，这就是我在这里所做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:11:48.393

Anon 的回答适用于我的要求，但我也希望能够搜索其他用户组。我发现最好的方法是在服务帐户下运行 asp.net 程序的应用程序池，然后使用我的原始代码。

要在 IIS 管理器 7.5 中执行此操作，请转到应用程序池，右键单击您的应用程序正在运行的那个 -> 高级设置，然后将身份从“ApplicationPoolIdentity”更改为自定义域帐户。

# r - 将每日行矩阵组合成每周行

> ID：14407535
> 
> 赞同：1
> 
> 时间：2013-01-18T21:00:26.933
> 
> 标签：r

我有一个矩阵，其中日期作为行名，标签#作为列名。矩阵填充有 0 和 1 表示存在/不存在。例如

```
 29735 29736 29737 29738 29739 29740
2010-07-15     1     0     0     0     0     0
2010-07-16     1     1     0     0     0     0
2010-07-17     1     1     0     0     0     0
2010-07-18     1     1     0     0     0     0
2010-07-19     1     1     0     0     0     0
2010-07-20     1     1     0     0     0     0 
```

我有以下用于计算站点保真度的脚本（存在天数）：

```
##Presence/absence data setup
##import file
read.csv('pn.csv')->'pn'
##strip out desired columns
pn[,c(5,7:9)]->pn
##create table of dates and tags
table(pn$Date,pn$Tag)->T
##convert to a matrix
as.matrix(T)->U
##convert to binary for presence/absence
1*(U>2)->U

##insert missing rows
library(micEcon)
insertRow(U,395,0)->U
rownames(U)[395]<-'2011-08-16'
insertRow(U,253,0)->U
rownames(U)[253]<-'2011-03-26'
insertRow(U,250,0)->U
rownames(U)[250]<-'2011-03-22'
insertRow(U,250,0)->U
rownames(U)[250]<-'2011-03-21'

##for presence/absence
##define i(tag or column)
1->i
##define place to store results
cbind(colnames(U),rep(NA,length(colnames(U))))->sfresult
##loop instructions
for(i in 1:ncol(U)){
##identify first detection day
grep(1,U[,i])[1]->tagrow
##count total days since first detection
nrow(U)-tagrow+1->days
##count days present
length(grep(1,U[,i]))->present
##calculate site fidelity
present/days->sfresult[i,2]
}
##change class of results column
as.numeric(sfresult[,2])->sfresult[,2]
##histogram
bins<-c(0,.3,.6,1)
xlab<-c('Low','Med','High')
hist(as.numeric(sfresult[,2]), breaks=bins,xaxt='n', col=heat.colors(3), xlab='Percent      Days Present',ylab='Frequency (# of individuals)',main='Site Fidelity',freq=TRUE,labels=xlab)
axis(1,at=bins) 
```

我想每周计算一次网站保真度。我相信通过将每七行组合成一个每周矩阵来简单地折叠矩阵是最简单的，该矩阵只是简单地将每日矩阵中的 0 和 1 相加。然后，用于站点保真度的相同脚本将每周计算一次。问题是我是一个新手，我很难找到关于如何将每日矩阵折叠为每周矩阵的答案。感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:56:21.097

像这样的东西应该工作：

```
x <- matrix(rbinom(1000,1,.2), nrow=50, ncol=20)
rownames(x) <- 1:50
colnames(x) <- paste0("id", 1:20)

require(data.table)
xdt <- as.data.table(x)

    ##assuming rows are sorted by date, that there are no missing days, and that the first row is the start of the week
    ###xdt[, week:=sort(rep(1:7, length.out=nrow(xdt)))] ##wrong

   xdt[, week:=rep(1:ceiling(nrow(xdt)/7), each=7)] ##fixed

xdt[, lapply(.SD,sum), by="week",.SDcols=setdiff(names(xdt),"week")] 
```

如果您提供可重现的示例，我可以帮助您更好地保留行名[如何制作出色的 R 可重现示例？](https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)

编辑：另外，像上面那样使用正确的分配`->`是非常不典型的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T05:50:34.550

R 的`cut`函数会将 s 修剪`Date`到他们的星期（`?cut.Date`更多详细信息请参阅）。之后，只需简单调用即可`aggregate`获得所需的结果。请注意，`cut.Date`需要一个`start.on.monday`选项。

### 数据

```
sites <- read.table(text="29735 29736 29737 29738 29739 29740
  2010-07-15     1     0     0     0     0     0
  2010-07-16     1     1     0     0     0     0
  2010-07-17     1     1     0     0     0     0
  2010-07-18     1     1     0     0     0     0
  2010-07-19     1     1     0     0     0     0
  2010-07-20     1     1     0     0     0     0", 
  header=TRUE, check.names=FALSE, row.names=1) 
```

### 回答

```
weeks.factor <- cut(as.Date(row.names(sites)), 
                    breaks='weeks', start.on.monday=FALSE)
aggregate(sites, by=list(weeks.factor), FUN=function(col) sum(col)/length(col))

#      Group.1 29735     29736 29737 29738 29739 29740
# 1 2010-07-11     1 0.6666667     0     0     0     0
# 2 2010-07-18     1 1.0000000     0     0     0     0 
```

# python - SQLAlchemy 过滤器总是返回 false

> ID：14407541
> 
> 赞同：4
> 
> 时间：2013-01-18T21:00:44.767
> 
> 标签：python, orm, sqlalchemy

我有一个简单的玩家实体：

```
__tablename__ = 'player'

_id = Column('id', SmallInteger, primary_key=True)
_nickName = Column('nick_name', String)

def __init__(self, nickName):
    self._nickName = nickName

@property
def id(self):
    return self._id

@property
def nickName(self):
    return self._nickName.decode(encoding='UTF-8')

@nickName.setter
def nickName(self, nickName):
    self._nickName = nickName 
```

当我做：

```
players = session.query(Player).filter(Player.nickName=='foo') 
```

我打印了`players`我得到的var：

```
SELECT player.id AS player_id, player.nick_name AS player_nick_name
FROM player
WHERE false 
```

显然，当我`.first()`在会话查询末尾添加时，结果是`None`. 我已经尝试过`filter_by()`并得到相同的结果。

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:46:54.903

您不能使用正则`@property`s 作为查询参数。使用 a[`@hybrid_property`](http://docs.sqlalchemy.org/en/rel_0_8/orm/mapper_config.html#using-descriptors-and-hybrids)代替：

```
from sqlalchemy.ext.hybrid import hybrid_property

@hybrid_property
def nickName(self):
    return self._nickName.decode(encoding='UTF-8')

@nickName.setter
def nickName(self, nickName):
    self._nickName = nickName 
```

这使得`Player.nickName`（类上的属性）在 SQL 表达式中很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:54:03.270

虽然 using`@hybrid_property` *将*在一般情况下解决此问题，但您根本不需要手动解码。只需将列类型设置为`Unicode`，`String`并且假设您的服务器运行良好，您应该正确地返回一个`unicode`.

您也根本不需要该`id`属性。

所以这门课你只需要：

```
class Player(Base):
    __tablename__ = 'player'

    id = Column(SmallInteger, primary_key=True)
    nickName = Column(Unicode) 
```

（列名和`__init__`参数都可以自动生成。）

如果由于某种原因您的数据库无法正确处理 Unicode，那么这是一个不同的问题，我们很乐意帮助您解决。:)

# multithreading - 混合线程、fork 和互斥体，我应该注意什么？

> ID：14407544
> 
> 赞同：7
> 
> 时间：2013-01-18T21:01:02.777
> 
> 标签：multithreading, fork, mutex

如果我`fork`是一个线程持有互斥锁的进程，如果我立即`exec`在子进程中，我是否相对安全？在孩子面前做什么事情是安全的`exec`？

如果执行的线程`fork`然后子进程在调用之前继续释放互斥锁，`exec`这会导致问题吗？如果我尝试在子进程中获取父进程之前拥有`fork`（并且可能拥有也可能不拥有）的子进程会发生什么？

不同平台的答案是否不同？我主要关注 Unix 变体，尤其是 Linux。但我对NT很好奇。虽然，当然，NT（据我所知）没有`fork`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T21:34:51.627

参见[pthread_atfork](http://pubs.opengroup.org/onlinepubs/009695399/functions/pthread_atfork.html)，尤其是 RATIONALE 部分，讨论与`fork`多线程环境相关的问题。`fork`它还暗示了在孩子和父母之前和之后应该有效的内容。

*更新：RATIONALE 部分是非规范性的，结果与标准的其他部分相冲突。有关更多详细信息，请参阅Dave Butenhof 的[此缺陷报告](https://collaboration.opengroup.org/external/pasc.org/interpretations/unofficial/db/p1003.1c/pasc-1003.1c-37.html)。*

对于多线程程序的任何状态（即，任何持有任何互斥锁的线程），紧随`exec`其后应该是安全的。`fork`至于 和 之间的可能`fork`情况`exec`，情况很复杂：

最重要的是`fork`子进程中只有一个线程（称为 的线程）被复制。*因此，此时另一个*线程持有的任何互斥锁`fork`将永远锁定。也就是说（假设非进程共享互斥锁）它在子进程中的*副本*被永远锁定，因为没有线程可以解锁它。

在可能的情况下释放互斥锁`fork`是安全的，也就是说，如果`fork`ing 线程首先*拥有*互斥锁。这就是`pthread_atfork`处理程序通常的工作方式：在之前锁定互斥锁`fork`，在子级中解锁*和*在父级中解锁。

至于获得进程在 fork 之前拥有的互斥锁（请记住，我们讨论了子地址空间中的*副本*）：如果它由ing 线程*拥有*`fork`，则它是递归锁定（适用于`PTHREAD_MUTEX_RECURSIVE`）；如果它被另一个线程拥有，它将永远保持锁定状态并且无法重新获取。

通过注册适当`pthread_atfork`的处理程序，第三方库可以保证在`fork`和之间安全使用`exec`。（我希望它主要来自编程语言运行时，而不是通用库）。

* * *

经过更多研究后，我建议避免*以任何方式*依赖，并且只在and`pthread_atfork`之间进行异步信号安全调用（放弃/ for会更好）。`fork``exec``fork``exec``posix_spawn`

问题是，`fork`它本身可以在信号处理程序中调用。它排除了对 的任何重要使用`pthread_atfork`，即使它的 RATIONALE 明确提到在子进程中解锁互斥锁和重新创建线程 (!)。

我认为仍然存在不同可能解释的“灰色地带”：

1.  对于*已知*从不调用信号处理程序的程序中的处理程序`pthread_atfork`。*`fork`*
**   *对于不在*信号处理程序中的`fork`调用周围发生的非 pthread-atfork 操作。*

 **但是对于便携式应用程序使用哪种读数非常清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:37:59.887

在 fork() 之后执行 exec() 是安全的，前提是互斥锁由将被 exec() 替换的程序拥有。如果互斥锁是库的一部分并且正在保护必须串行访问的资源，那么它应该调用 pthread_atfork() 来注册回调：

1.  在 fork 本身之前以及在进行 fork() 系统调用的线程的上下文中调用的函数。通常，此函数将获取保护临界区的互斥锁，从而保证在分叉期间没有线程位于临界区内
2.  在子进程创建之后但在 fork() 系统调用返回之前，在调用 fork() 的线程的上下文中调用的函数。然后，此函数可以解锁父进程中的互斥锁。
3.  如果/当进程分叉时在子进程的线程上下文中调用的函数 - 它在子进程创建之后但在 fork() 系统调用返回之前被调用。然后子进程可以解锁它的互斥体副本。

POSIX 标准将允许在 fork() 之后和 exec() 之前的系统调用类型限制为所谓的异步信号安全系统调用。创建线程未明确列为异步信号安全系统调用，因此 POSIX 不允许子进程在 fork() 和 exec() 之前创建线程。具有讽刺意味的是，解锁互斥锁也没有明确列为异步信号安全系统调用，如果 fork() 的意图是然后 exec( ) - 可能是标准的疏忽。**

# angularjs - 如何禁用角度类型=电子邮件验证？

> ID：14407546
> 
> 赞同：16
> 
> 时间：2013-01-18T21:01:03.477
> 
> 标签：angularjs

您将如何禁用或至少更改 Angular 验证 type=email 输入的方式？

目前，如果您使用 type=email，Angular 本质上会双重验证......因为浏览器（在本例中为 Chrome）验证电子邮件，然后 Angular 也会这样做。不仅如此，在 Chrome`foo@bar`中*有效*的在 Angularjs 中无效。

我能找到的最好的是`ng-pattern`，但只是为输入类型`ng-pattern`添加了*第三种模式验证..而不是替换 Angular 的电子邮件验证。*呵呵

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-22T19:57:47.873

*注意：此示例适用于 angular 1.2.0-rc.3。在其他版本上可能会有不同的表现*

就像其他人所说的那样，关闭 angulars 默认输入验证有点复杂。您需要将自己的指令添加到输入元素并处理其中的内容。[Sergey 的回答](https://stackoverflow.com/a/18781558/1598630)是正确的，但是如果您需要元素上的多个验证器并且不希望触发内置验证器，则会出现一些问题。

这是一个验证电子邮件字段的示例，其中添加了必需的验证器。我在代码中添加了注释来解释发生了什么。

### 输入元素

```
<input type="email" required> 
```

### 指示

```
angular.module('myValidations', [])

.directive('input', function () {
  var self = {
      // we use ?ngModel since not all input elements 
      // specify a model, e.g. type="submit" 
      require: '?ngModel'
      // we need to set the priority higher than the base 0, otherwise the
      // built in directive will still be applied
    , priority: 1
      // restrict this directive to elements
    , restrict: 'E'
    , link: function (scope, element, attrs, controller) {
        // as stated above, a controller may not be present
        if (controller) {

          // in this case we only want to override the email validation
          if (attrs.type === 'email') {
            // clear this elements $parsers and $formatters
            // NOTE: this will disable *ALL* previously set parsers
            //       and validators for this element. Beware!
            controller.$parsers = [];
            controller.$formatters = [];

            // this function handles the actual validation
            // see angular docs on how to write custom validators
            // http://docs.angularjs.org/guide/forms
            //
            // in this example we are not going to actually validate an email
            // properly since the regex can be damn long, so apply your own rules
            var validateEmail = function (value) {
              console.log("Validating as email", value);
              if (controller.$isEmpty(value) || /@/.test(value)) {
                controller.$setValidity('email', true);
                return value;
              } else {
                controller.$setValidity('email', false);
                return undefined;
              }
            };

            // add the validator to the $parsers and $formatters
            controller.$parsers.push(validateEmail);
            controller.$formatters.push(validateEmail);
          }
        }
      }
  };
  return self;
})

// define our required directive. It is a pretty standard
// validation directive with the exception of it's priority.
// a similar approach must be take with all validation directives
// you would want to use alongside our `input` directive
.directive('required', function () {
  var self = {
      // required should always be applied to a model element
      require: 'ngModel'
    , restrict: 'A'
      // The priority needs to be higher than the `input` directive
      // above, or it will be removed when that directive is run
    , priority: 2
    , link: function (scope, element, attrs, controller) {
        var validateRequired = function (value) {
          if (value) {
            // it is valid
            controller.$setValidity('required', true);
            return value;
          } else {
            // it is invalid, return undefined (no model update)
            controller.$setValidity('required', false);
            return undefined;
          }

        };
        controller.$parsers.push(validateRequired);
      }
  };
  return self;
})
; 
```

你有它。您现在可以控制`type="email"`输入验证。请使用适当的正则表达式来测试电子邮件。

需要注意的一点是，在此示例`validateEmail`中运行之前`validateRequired`。如果您需要`validateRequired`在任何其他验证之前运行，则只需将其添加到`$parsers`数组中（使用`unshift`而不是`push`）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-09-11T02:43:52.007

很简单。我必须更改电子邮件正则表达式以匹配业务需求，所以我制定了这个指令，使电子邮件正则表达式可定制。它基本上用我的自定义验证器覆盖了原始验证器。你不必弄乱所有的 $parsers 和 $formatters（除非我遗漏了一些东西）。所以我的指令是这样的......

```
module.directive('emailPattern', function(){
    return {
        require : 'ngModel',
        link : function(scope, element, attrs, ngModel) {

            var EMAIL_REGEX = new RegExp(attrs.emailPattern, "i");

            ngModel.$validators["email"] = function (modelValue, viewValue) {
                var value = modelValue || viewValue;
                return ngModel.$isEmpty(value) || EMAIL_REGEX.test(value);
            };
        }
    }
}); 
```

然后像这样使用它，提供您个人想要的任何电子邮件模式：

```
<input type="email" email-pattern=".+@.+\..+"/> 
```

但是，如果您只想永久禁用它，那么您可以这样做。

```
module.directive('removeNgEmailValidation', function(){
    return {
        require : 'ngModel',
        link : function(scope, element, attrs, ngModel) {
            ngModel.$validators["email"] = function () {
                return true;
            };
        }
    }
}); 
```

然后像这样使用它...

```
<input type="email" remove-ng-email-validation> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-18T23:58:14.207

在 HTML5 上，您可以使用表单的属性`novalidate`来禁用浏览器的验证：

```
<form novalidate>
    <input type="email"/>
</form> 
```

如果您想在 angularjs 中创建自定义验证器，这里有一个很好的教程和示例：[http ://www.benlesh.com/2012/12/angular-js-custom-validation-via.html](http://www.benlesh.com/2012/12/angular-js-custom-validation-via.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-02-22T03:34:50.047

呼应[nfiniteloop](https://stackoverflow.com/a/25778244/3180252)，您无需弄乱`$parsers`或`$formatters`覆盖默认验证器。正如[Angular 1.3 文档](https://docs.angularjs.org/guide/forms/#custom-validation)中所引用的，$validators 对象可以在 ngModelController 上访问。使用自定义指令，您可以根据需要编写任意数量的不同电子邮件验证函数，并在任何地方调用它们。

这里有一个来自[tuts 的非常好的标准电子邮件格式正则表达式：你现在应该使用的 8 个正](http://code.tutsplus.com/tutorials/8-regular-expressions-you-should-know--net-6149)则表达式（可能与 Angular 的默认值 idk 相同）。

```
var app = angular.module('myApp', []);

app.directive('customEmailValidate', function() {
  return {
    require: 'ngModel',
    link: function(scope, elm, attrs, ctrl) {

      var EMAIL_REGEXP = /^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/;

      ctrl.$validators.email = function(modelValue, viewValue) {
        if (ctrl.$isEmpty(modelValue)) {
          // consider empty models to be valid
          return true;
        }

        if (EMAIL_REGEXP.test(viewValue)) {
          // it is valid
          return true;
        }

        // it is invalid
        return false;
      };
    } 
  };
}); 
```

这是一个完全删除验证的方法：

```
var app = angular.module('myApp', []);

app.directive('noValidation', function() {
  return {
    require: 'ngModel',
    link: function(scope, elm, attrs, ctrl) {
      ctrl.$validators.email = function(modelValue, viewValue) {
        // everything is valid
        return true;
      };
    } 
  };
}); 
```

要在您的标记中使用：

```
<!-- 'test@example.com' is valid, '@efe@eh.c' is invalid -->
<input type="email" custom-email-validate>

<!-- both 'test@example.com' and '@efe@eh.c' are valid -->
<input type="email" no-validation> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-13T08:20:47.947

在我的项目中，我做了这样的事情（自定义指令擦除所有其他验证，包括由 angularjs 安装的验证）：

```
angular.module('my-project').directive('validEmail', function() {
    return {
        require: 'ngModel',
        link: function(scope, elm, attrs, ctrl){
            var validator = function(value){
                if (value == '' || typeof value == 'undefined') {
                    ctrl.$setValidity('validEmail', true);
                } else {
                    ctrl.$setValidity('validEmail', /your-regexp-here/.test(value));
                }
                return value;
            };

            // replace all other validators!
            ctrl.$parsers = [validator];
            ctrl.$formatters = [validator];
        }
    }
}); 
```

使用方法（注意`novalidate`，需要关闭浏览器验证）：

```
<form novalidate>
    <input type="email" model="email" class="form-control" valid-email> 
```

# android - 使用 ClientID 获取访问令牌时出现 GoogleAuthException

> ID：14407548
> 
> 赞同：10
> 
> 时间：2013-01-18T21:01:20.950
> 
> 标签：android, authentication, google-api, single-sign-on, google-oauth

有关更多上下文，这篇文章在这篇文章[之后](https://stackoverflow.com/questions/14218694/sso-with-google-account-on-both-website-and-mobile-app)。

为了解决我以前的问题，我尝试按照 Tim Bray 在这里提出的解决方案：*[Verifying Back-End Calls from Android Apps](http://android-developers.blogspot.de/2013/01/verifying-back-end-calls-from-android.html)*

我在 Google API 控制台中声明了两个项目以获取两个客户端 ID

*   第一个作为“Web 应用程序”，以“localhost”作为主机名（有关系吗？）
    *   客户 ID：*XXXXXXXXXX.apps.googleusercontent.com*
*   第二个作为 Android 应用程序，具有在 AndroidManifest.xml 和 SHA1 指纹中指定的包名称（尝试使用 debug.keystore 和 [my].keystore）
    *   客户 ID：*YYYYYYYYYY.apps.googleusercontent.com*

不幸的是，我在 Android 方面遇到了一个例外：

```
com.google.android.gms.auth.GoogleAuthException: Unknown
at com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
at com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source)
at fr.barles.android.activity.LoginActivity$1.doInBackground(LoginActivity.java:66)
at fr.barles.android.activity.LoginActivity$1.doInBackground(LoginActivity.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
at java.util.concurrent.FutureTask.run(FutureTask.java:137)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
at java.lang.Thread.run(Thread.java:1102) 
```

在线上：

```
return GoogleAuthUtil.getToken(LoginActivity.this, account[0], "audience:server:client_id:XXXXXXXXXX.apps.googleusercontent.com"); 
```

我做错了什么？

提前致谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-02-28T19:14:18.523

几个小时后，我发现在您的范围字符串 ( `"audience:server:client_id:..."`) 中，您必须使用 Web 应用程序的客户端 ID，而不是 android 的。

安卓应用的客户端 ID 未使用。它在这里只是为了将您的 android 应用程序的包名称与您的 Web 应用程序链接起来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T23:30:03.330

这两个客户端 ID 应该属于同一个项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-10T06:04:58.010

没有必要做更多。请在 Google 控制台上重新创建您的客户端 ID，并在您的代码中将此行写为范围字符串。

```
String SCOPE = "oauth2:https://www.googleapis.com/auth/userinfo.profile"; 
```

[https://github.com/AshishPsaini/GoogleAuth](https://github.com/AshishPsaini/GoogleAuth)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-18T23:18:39.383

当我更改包名称并忘记在 Google API 控制台中使用调试 SHA1 生成新客户端 ID 时，我收到此错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-05T13:02:26.830

将 GoogleApiCliente 中添加的范围更改为 Plus.SCOPE_PLUS_LOGIN。这对我有用。

```
 googleApiClient = new GoogleApiClient.Builder(this)
            .addConnectionCallbacks(this)
            .addOnConnectionFailedListener(this)
            .addApi(Plus.API)
            .addScope(Plus.SCOPE_PLUS_LOGIN)
            .build(); 
```

# php - 带有锚标记的 WordPress URL 解析为 404

> ID：14407551
> 
> 赞同：1
> 
> 时间：2013-01-18T21:01:27.773
> 
> 标签：php, html, wordpress, anchor

我对 WordPress 有一个奇怪的问题，其中我的关于页面上有一个锚标签，如下所示：

`<h2><a id="comments">Why No Comments?</a></h2>`

当我像这样在页脚中链接到它时：

`<a href="<?php echo home_url()?>/about/#comments">Why no comments?</a>`

它莫名其妙地解决了`http://www.everydaytype.com/omments`。

这里会发生什么？

注意：当我手动导航到锚标记的 URL 时，也会发生同样的事情。

（参考：[everydaytype.com](http://everydaytype.com)）

**更新：**我已经禁用了我的所有插件（我有一个在我的标题中操作链接的插件），这种情况仍在发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:10:31.337

对于一个网站来说，这是一件非常奇怪的事情。

如果您将 url 加载`http://www.everydaytype.com/about/#comments`到浏览器中的查看源代码窗口中，您会发现它包含以下代码：

```
<script>if(window.location.hash) {
    var hash = window.location.hash;
    var hashtourl = hash.substring(2)
    window.location.href = "/"+hashtourl;
}</script> 
```

这段代码完全符合您的描述。

我不知道它为什么会这样做，但这就是它正在做的事情。

我的猜测是它期待 a`#!`而不仅仅是 a `#`，因此删除前两个字符而不仅仅是第一个，但这只是一个猜测。如果这是它所期望的，它真的应该检查它而不是做出假设。

我想它一定是您不知道或认为您没有完全禁用的某些插件的一部分，或者其他什么。无论哪种方式，手头都有上面的代码应该可以帮助您找到它。

这就是我能做的所有帮助，但我希望它能让你朝着正确的方向前进。

# jquery - 防止 onclick 稍微移动项目并将它们再次重置到原始位置

> ID：14407555
> 
> 赞同：2
> 
> 时间：2013-01-18T21:01:46.657
> 
> 标签：jquery

我需要一些关于我的垂直菜单问题的建议。

我现在的问题是，当我单击一个按钮时，我的其他按钮会向下移动一个像素，然后再次直接向上移动。只是看起来生根发芽。例如点击“迈克尔”、“琼斯”、“科威特”我们的“超人”。您会看到屏幕底部有一个小的移动，然后它会自行重置到原来的位置。

```
var accordion_head = $('.accordion > li > a'),  
accordion_body = $('.accordion li > .sub-menu');
accordion_head.on('click', function (event) {
    if ($(this).attr('class') != 'active') {
        accordion_body.slideUp('normal');
        $(this).next().stop(true, true).slideToggle('normal');
        accordion_head.removeClass('active');
        $(this).addClass('active');
    }
}); 
```

你可以在这里找到它：http: [//jsfiddle.net/RTcf3/](http://jsfiddle.net/RTcf3/)

如何解决这个问题？帮助表示赞赏。

非常感谢，周末愉快

道明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:10:19.477

编辑：我会稍微更改您的代码并使其检查当前菜单是否实际上有一个子菜单，这样它就不会尝试显示一个空的 ul （以防您有一些带有子菜单的菜单，而另一些没有子菜单）。如果您需要帮助，请告诉我。

这是我在这个[小提琴](http://jsfiddle.net/Seventh/RTcf3/7/)上的内容：

```
$('.accordion > li').on('click', function (evt) {
    var accordion_body = $('.sub-menu', this);
    if($(this).hasClass('active')) {

    } else {
        $('.active .sub-menu').slideUp();
        $('.active').removeClass('active');
        $(this).addClass('active');
        if(accordion_body.is(':empty')){

        } else {
            accordion_body.slideDown('normal');
        }
    }   
}); 
```

我还对你的 CSS 做了一些小改动。您有一个锚链接显示：相对。这根本没有意义，因为它永远不会有子标签。

# python - 带有 pyparsing 的 operatorPrecedence 的语法空格

> ID：14407563
> 
> 赞同：0
> 
> 时间：2013-01-18T21:02:35.040
> 
> 标签：python, parsing, operator-precedence

是否可以使用一些空格作为分隔符？我的意思是...

给定一些python运算符优先级解析器，我想将自然语言与运算符混合在一起，作为记笔记的简写，即`'caffeine : A1 antagonist -> caffeine : peripheral stimulant'`有解释`'caffeine is an A1 antagonist implies that it is a peripheral stimulant'`。

例如，我希望能够将其解析`parse('a:b -> c : d e')`为`[[['a', ':', 'b'], '->', ['c', ':', ['d', 'e']]]]`

像这样的东西

```
operands = delimitedList(Word(alphanums), delim=',') 
# delim=' ' obviously doesn't work

precedence = [
    (":", 2, opAssoc.LEFT),
    ("->", 2, opAssoc.LEFT),
    ]

parser = operatorPrecedence(operands, precedence)

def parse(s): return parser.parseString(s, parseAll=True)

print parse('a:b -> c : d e') 
```

可能的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:01:06.250

仔细考虑之后，我认为您尝试定义的语言是模棱两可的，但有多种方法可以解决这个问题。

你要这个：

```
parse('a:b -> c : d e') 
```

给你这个：

```
[[['a', ':', 'b'], '->', ['c', ':', ['d', 'e']]]] 
```

您已经暗示您希望空格充当运算符。但是为什么它不是上下文中的运算符`'c :'`呢？什么时候是，什么时候不是运营商的规则是什么？

要么，要么您希望每个操作数都是以空格分隔的单词列表。但在那种情况下，为什么那`'a'`不是`['a']`？每个操作数要么是一个列表，要么都不是，对吧？它显然不依赖于位置，并且您没有指定任何其他规则。

有（至少）一个合理的规则适合您的想法：将任何作为单元素列表的操作数折叠到该元素。但这是一个奇怪的规则——当你以后将这个解析树用于你使用它的任何目的时，你必须通过编写处理单个单词的代码来有效地反转相同的规则，就好像它是一个单词列表一样. 那么……为什么要那样做？

我能想到三个更好的选择：

1.  要求每个操作数都是以空格分隔的单词列表。
2.  在操作数中间允许空格。
3.  使用默认的空白处理，并允许在任何运算符的每一侧使用多个术语。

其中任何一个都非常容易解析，并为您提供了一个非常易于使用的解析树。我可能会选择#2，但由于我已经在上面的评论中解释了如何做到这一点，让我们在这里做#3：

```
>>> operands = OneOrMore(Word(alphanums))
>>> precedence = [
...     (":", 2, opAssoc.LEFT),
...     ("->", 2, opAssoc.LEFT),
...     ]
>>> parser = operatorPrecedence(operands, precedence)
>>> def parse(s): return parser.parseString(s, parseAll=True)
>>> print(parse('a:b -> c : d e'))
[[['a', ':', 'b'], '->', ['c', ':', 'd', 'e']]]
>>> print(parse('caffeine : A1 antagonist -> caffeine : peripheral stimulant'))
[[['caffeine', ':', 'A1', 'antagonist'], '->', ['caffeine', ':', 'peripheral', 'stimulant']]] 
```

# ruby-on-rails - Rails jQuery 适配器渲染三次

> ID：14407564
> 
> 赞同：0
> 
> 时间：2013-01-18T21:02:37.490
> 
> 标签：ruby-on-rails, ruby

我正在关注从 Apress 2010 开始的 Rails 3 更新书。我遇到的问题是使用 jQuery 适配器使用 Ajax 动态加载模板。一切正常，但它似乎在页面上呈现了三遍。

这是当用户单击“新评论”链接时我如何动态加载它的。

意见/文章/show.html.erb

```
<%= link_to "new comment",
            new_article_comment_path(@article, :format => :js),
            :remote => true,
            :id => 'new_comment_link' %> 
```

然后我把它渲染成这样。

意见/评论/new.js.erb

```
$("<%= escape_javascript render :file => 'comments/new'," +
  " :formats => [:html], :handlers => [:erb] %>")
  .insertAfter('#comments'); 
```

然后我在日志中看到了这一点。

```
Started GET "/articles/1/comments/new.js" for 127.0.0.1 at 2013-01-18 14:51:05 -0600
Processing by CommentsController#new as JS
  Parameters: {"article_id"=>"1"}
  Article Load (0.2ms)  SELECT "articles".* FROM "articles" WHERE "articles"."id" = ? LIMIT 1  [["id", "1"]]
  Rendered comments/new.html.erb (53.8ms)
  Rendered comments/new.js.erb (54.6ms)
Completed 200 OK in 57ms (Views: 55.9ms | ActiveRecord: 0.2ms) 
```

注意到它呈现了我的 erb 和 js 文件吗？不知何故，最终在我的页面上出现了 3 次。

关于如何解决这个问题的任何线索？我正在使用 Rails 3.2.9、rails.js（最新）和 jquery-1.9.0。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:43:27.920

解决了！

原来我添加了 rails.js 和 jquery.js TWICE！

简而言之：assets/javascripts/application.js 对于将 javascript 文件包含到您的应用程序中至关重要。基本上在那里定义的任何东西都会被推送到页面上。您只需要确保它在应用程序中至少被定义一次。

视图/布局/application.html.erb

```
<%= javascript_include_tag "application" %> 
```

就是这样！Ajax jQuery 适配器应该可以正常工作。注意不要将任何其他文件添加到 javascript 文件夹中，因为这些文件也会被推出，而这正是您不想要的。基本上，我通过 application.html.erb 和手动下载这两个文件来定义适配器。希望这会帮助一个迷失的可怜的灵魂。

快乐黑客。

# c# - 如何检测 HTML 网页中的所有相对 URL？

> ID：14407566
> 
> 赞同：1
> 
> 时间：2013-01-18T21:02:44.737
> 
> 标签：c#, .net, html-agility-pack

如问题所述；如果它们是相对的，是否有某种方法可以检测 PHP 页面中的所有 URL。当然，考虑到 PHP 页面中包含的 URL 可能会出现不同的行为：

```
<link rel="stylesheet" href="/lib/css/hanv2/ie.css" />
<img src="/image.jpg">
<div style="background-image: url(/lib/data/emotion-header-v2/int-algemeen08.jpg)"></div> 
```

所以我需要获取相对 URL ，不管它的 bihavior 是什么`css link`，，，，`js link``image link``swf link`

我为此使用[了 AgilityPack](http://htmlagilitypack.codeplex.com/)，这里有一些 C# 代码片段，我用来检测链接并检查它们是否是相对的：

```
 // to extract all a href tags
 private List<string> ExtractAllAHrefTags(HtmlAgilityPack.HtmlDocument htmlSnippet)
    {
        List<string> hrefTags = new List<string>();

        foreach (HtmlNode link in htmlSnippet.DocumentNode.SelectNodes("//link[@href]"))
        {
            HtmlAttribute att = link.Attributes["href"];
            hrefTags.Add(att.Value);
        }

        return hrefTags;
    }

    // to extract all img src tags
    private List<string> ExtractAllImgTags(HtmlAgilityPack.HtmlDocument htmlSnippet)
    {
        List<string> hrefTags = new List<string>();

        foreach (HtmlNode link in htmlSnippet.DocumentNode.SelectNodes("//img[@src]"))
        {
            HtmlAttribute att = link.Attributes["src"];
            hrefTags.Add(att.Value);
        }

        return hrefTags;
    }

       //to check whether path is relative       
            foreach (string s in AllHrefTags)
            {                  
                if (!s.StartsWith("http://") || !s.StartsWith("https://"))
                {
                    // path is not relative
                }
            } 
```

我想知道是否有一种更好或**更准确的方法可以使用**[AgilityPack](http://htmlagilitypack.codeplex.com/)或其他方式从给定 HTML 页面获取所有相对路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T15:01:05.763

您可以使用此 xpath 表达式从 html 页面中提取相对 url，它们是 href 或 src 值：

```
htmlSnippet.DocumentNode.SelectNodes("(//@src|//@href)[not(starts-with(.,'http://'))][not(starts-with(.,'https://'))]"); 
```

您可能想要过滤以 # 开头的链接，这些链接用于跳转到当前页面上的特定位置，（例如：<a href="#tips">）：

```
 htmlSnippet.DocumentNode.SelectNodes("(//@src|//@href)[not(starts-with(.,'http://'))][not(starts-with(.,'https://'))][not(starts-with(.,'#'))]"); 
```

# javascript - 在 tr > first td 中选中的 jQuery foreach 复选框

> ID：14407567
> 
> 赞同：0
> 
> 时间：2013-01-18T21:02:46.210
> 
> 标签：javascript, jquery

我想遍历表行并获取第一个 td 中每个 tr 中选中的每个复选框的 id 和名称，并将其保存在一个名为 values ex: values.id, values.name 的新 Object() 中

谢谢

```
<table>
    <tr>
        <td>
            <input id="1" type="checkbox" name="name1" checked="checked">
        </td>
        <td>
            Some input control 1
        </td>
    </tr>
    <tr>
        <td>
            <input id="2" type="checkbox" name="name2">
        </td>
        <td>
            Some input control 2
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:07:52.083

**[工作示例](http://jsfiddle.net/paxux/1/)**

`aRecord`是一个对象数组，每个对象都包含在表中找到的每个选中复选框的名称和 ID。

```
$(document).ready(function() {
   var aRecord = [];
    $('#your_table input:checkbox:checked').each(function() {
        var oChkBox = {};
        oChkBox.name = $(this).attr('name');
        oChkBox.id = $(this).attr('id');
        aRecord.push(oChkBox);
    });

    var i = aRecord.length;
    while (i--) {
        alert("Name: "+ aRecord[i].name   + " ID: "+ aRecord[i].id);
    }

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:11:27.743

[http://jsfiddle.net/tracyfu/r6RMV/](http://jsfiddle.net/tracyfu/r6RMV/)

```
var values = {};

$('tr input:checked').each(function(i) {
  values[i] = [];
  values[i].push($(this).attr('id'));
  values[i].push($(this).attr('name'));
}); 
```

将产生：

```
values = { [1, 'name1'] } 
```

我将按原样保留此解决方案，因为您明确表示要将值存储在`object`named`values`中，但不知道您将如何处理数据，我会将值存储在数组中...

# php - Dynamically generating PayPal buttons

> ID：14407568
> 
> 赞同：1
> 
> 时间：2013-01-18T21:02:46.950
> 
> 标签：php, html, paypal

What's the best way to dynamically generate an "Add to Cart" PayPal button in PHP? My idea is to take the basic HTML code and simply echo the required variable but I'm not sure if it's the most secure way...

```
<form name="_xclick" action="https://www.paypal.com/cgi-bin/webscr" method="post">
    <input type="hidden" name="cmd" value="_xclick">
    <input type="hidden" name="business" value="me@mybusiness.com">
    <input type="hidden" name="currency_code" value="NZD">
    <input type="hidden" name="item_name" value="<?=$name?>">
    <input type="hidden" name="amount" value="<?=$price?>">
    <input type="image" src="http://www.paypalobjects.com/en_US/i/btn/btn_buynow_LG.gif"
        border="0" name="submit" alt="Make payments with PayPal - it's fast, free and secure!">
</form> 
```

(Code above from PayPal's [Advanced Techniques page](https://www.paypal.com/cgi-bin/webscr?cmd=_pdn_xclick_techview_outside))

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:43:34.430

Doing it that way isn't very secure because people can still view source and see the end-result on your page. Then they could take that, make changes to it, load it in their own browser and pay you for an item at a much lower price.

You can utilize IPN to help flag orders that don't look accurate by cross-references your pricing, but this can be a hassle.

You could use the [Button Manager API](https://www.x.com/sites/default/files/pp_wpsbuttonmgrapinvp.pdf) to generate your buttons as hosted buttons on PayPal. This way people can't see the details in the source code and wouldn't be able to make changes.

Alternatively, you could use the [Express Checkout API](https://www.x.com/developers/paypal/development-and-integration-guides#ec) which is what I prefer and recommend if you know how to work with web service API's.

# angularjs - 如何使用指令从控制器切换元素上的幻灯片动画？

> ID：14407572
> 
> 赞同：5
> 
> 时间：2013-01-18T21:02:56.530
> 
> 标签：angularjs

我对以下情况感到困惑。假设我有一个带有行的表。当用户单击表中的按钮时，我希望用户表单使用 jQuery 向下滑动并显示带有所选行值的表单。这是我目前正在做的不太有意义的事情：

**看法**

```
<tr ng-click="setItemToEdit(item)" slide-down-form> 
```

...

```
<form>
   <input type="test" ng-model={{itemToEdit.Property1}} >
   <button ng-click=saveEditedItem(item)" slide-up-form>
<form> 
```

**控制**

```
$scope.itemToEdit = {};

$scope.setItemToEdit = function(item) {
    $scope.itemToEdit = item;
});

$scope.saveEditedItem = function(item) {
   myService.add(item);
   $scope.itemToEdit = {};
} 
```

**指令 - 上滑/下滑**

```
var linker = function(scope, element, attrs) {
    $(form).slideUp(); //or slide down           
} 
```

看来我的指令和我的控制逻辑太脱节了。例如，如果出现保存错误怎么办？由于 slideUp 事件已完成，该表单已被隐藏。在这种情况下，我很可能希望阻止 slideUp 操作。

我只使用了 AngularJS 大约一个星期，所以我确定我缺少一些东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:22:43.167

当然，这是一个常见的问题......这是解决这个问题的一种方法：基本上在指令中使用带有 $watch 的布尔值来触发表单的切换。除此之外，您只需将表单上的变量设置为要编辑的对象。

这是一些伪代码中的一般想法：

```
//create a directive to toggle an element with a slide effect.
app.directive('showSlide', function() {
   return {
     //restrict it's use to attribute only.
     restrict: 'A',

     //set up the directive.
     link: function(scope, elem, attr) {

        //get the field to watch from the directive attribute.
        var watchField = attr.showSlide;

        //set up the watch to toggle the element.
        scope.$watch(attr.showSlide, function(v) {
           if(v && !elem.is(':visible')) {
              elem.slideDown();
           }else {
              elem.slideUp();
           }
        });
     }
   }
});

app.controller('MainCtrl', function($scope) {
   $scope.showForm = false;
   $scope.itemToEdit = null;

   $scope.editItem = function(item) {
       $scope.itemToEdit = item;
       $scope.showForm = true;
   };
}); 
```

标记

```
<form show-slide="showForm" name="myForm" ng-submit="saveItem()">
    <input type="text" ng-model="itemToEdit.name" />
    <input type="submit"/>
</form>
<ul>
   <li ng-repeat="item in items">
         {{item.name}}
        <a ng-click="editItem(item)">edit</a>
   </li>
</ul> 
```

# r - 将 stargazer 或 xable 表插入 knitr 文档

> ID：14407576
> 
> 赞同：7
> 
> 时间：2013-01-18T21:03:28.470
> 
> 标签：r, knitr

```
> dput(head(t))
structure(list(Team = structure(c(1L, 1L, 1L, 1L, 1L, 1L), .Label = "Union", class = "factor"), 
    Date = structure(c(1L, 1L, 1L, 2L, 2L, 2L), .Label = c("2012-01-06", 
    "2012-02-06", "2012-03-06", "2012-04-06", "2012-05-06", "2012-07-06", 
    "2012-09-06", "2012-10-06", "2012-11-06", "2012-12-06"), class = "factor"), 
    STime = structure(c(1L, 1L, 1L, 1L, 1L, 1L), .Label = "07:03", class = "factor"), 
    ETime = structure(c(6L, 7L, 8L, 5L, 5L, 1L), .Label = c("01:13", 
    "03:13", "06:13", "09:13", "10:13", "11:13", "12:13", "13:13", 
    "15:13", "16:13", "18:13"), class = "factor")), .Names = c("Team", 
"Date", "STime", "ETime"), row.names = c(NA, 6L), class = "data.frame") 
```

我希望能够使用 stargazer 或 xtable 将此数据框`t`放入 knitr 中的表格格式中。我是 knitr 的新手，我可以创建图表等，但无法成功地将表格放入 knitr 文档。

到目前为止，我的 test.rnw 文件看起来像这样：

```
\documentclass[11pt]{article}
\begin{document}

<<setup, echo = FALSE, results= 'hide', message = FALSE>>=
data(mtcars)

library(ggplot2)
qplot(speed, dist, data = cars) + geom_smooth()
@

\end{document} 
```

如何将观星表插入此文档以显示`t`数据框的内容？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-18T21:16:42.743

你的意思是这样的（结果='asis'）吗？

```
\documentclass[11pt]{article}
\begin{document}

<<setup, echo = FALSE, results= 'hide', message = FALSE>>=
data(mtcars)

library(ggplot2)
qplot(speed, dist, data = cars) + geom_smooth()
@

<<results='asis'>>=
require(stargazer)
stargazer(mtcars, summary = FALSE)
@

\end{document} 
```

# python - 如何获得 Numpy 矩阵的整数特征向量？

> ID：14407579
> 
> 赞同：3
> 
> 时间：2013-01-18T21:03:59.217
> 
> 标签：python, numpy, integer, scipy, eigenvector

我有一个 Numpy 矩阵，例如`numpy.matrix([[-1, 2],[1, -2]], dtype='int')`. 我想得到它的**整数值**特征向量，如果有的话；例如，`numpy.array([[-1], [1]])`对于上述矩阵。Numpy 返回的是浮点数的特征向量，按比例缩放以具有单位长度。

可以在 Sage 中执行此操作，其中可以指定矩阵的字段（即数据类型），对矩阵执行的操作将尊重指定的字段。

知道如何在 Python 中很好地做到这一点吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T17:35:55.553

我个人对以下解决方案感到满意：我调用`sage`了 Python 并让`sage`计算我想要的。`sage`，是面向数学的，在涉及除实数以外的领域的计算中相当通用。

以下是我的脚本`compute_intarrs.py`，需要`sage`安装。请注意，它有点慢。

```
import subprocess
import re
import numpy as np

# construct a numpy matrix
mat = np.matrix([[1,-1],[-1,1]])
# convert the matrix into a string recognizable by sage
matstr = re.sub('\s|[a-z]|\(|\)', '', mat.__repr__())

# write a (sage) python script "mat.py";
# for more info of the sage commands: 
# www.sagemath.org/doc/faq/faq-usage.html#how-do-i-import-sage-into-a-python-script
# www.sagemath.org/doc/tutorial/tour_linalg.html
f = open('mat.py', 'w')
f.write('from sage.all import *\n\n')
f.write('A = matrix(ZZ, %s)\n\n' % matstr)
f.write('print A.kernel()')  # this returns the left nullspace vectors
f.close()

# call sage and run mat.py
p = subprocess.Popen(['sage', '-python', 'mat.py'], stdout=subprocess.PIPE)

# process the output from sage
arrstrs = p.communicate()[0].split('\n')[2:-1]
arrs = [np.array(eval(re.sub('(?<=\d)\s*(?=\d|-)', ',', arrstr))) 
        for arrstr in arrstrs]
print arrs 
```

结果：

`In [1]: %run compute_intarrs.py`

`[array([1, 1])]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T04:16:03.987

`dtype = object`你可以用和类做一些很酷的事情[`fractions.Fraction`](http://docs.python.org/2/library/fractions.html)，例如

```
>>> A = np.array([fractions.Fraction(1, j) for j in xrange(1, 13)]).reshape(3, 4)
>>> A
array([[1, 1/2, 1/3, 1/4],
       [1/5, 1/6, 1/7, 1/8],
       [1/9, 1/10, 1/11, 1/12]], dtype=object)
>>> B = np.array([fractions.Fraction(1, j) for j in xrange(1, 13)]).reshape(4, 3)
>>> B
array([[1, 1/2, 1/3],
       [1/4, 1/5, 1/6],
       [1/7, 1/8, 1/9],
       [1/10, 1/11, 1/12]], dtype=object)
>>> np.dot(A, B)
array([[503/420, 877/1320, 205/432],
       [3229/11760, 751/4620, 1217/10080],
       [1091/6930, 1871/19800, 1681/23760]], dtype=object) 
```

不幸的是，该`np.linalg`模块`float`在执行任何操作之前都会将所有内容转换为，因此您不能期望直接以整数或有理数形式获得解决方案。但您始终可以在计算后执行以下操作：

```
def scale_to_int(x) :
    fracs = [fractions.Fraction(j) for j in x.ravel()]
    denominators = [j.denominator for j in fracs]
    lcm = reduce(lambda a, b: max(a, b) / fractions.gcd(a, b) * min(a, b),
                 denominators)
    fracs = map(lambda x : lcm * x, fracs)
    gcd = reduce(lambda a, b: fractions.gcd(a, b), fracs)
    fracs = map(lambda x: x / gcd, fracs)
    return np.array(fracs).reshape(x.shape) 
```

它会很慢，并且对舍入错误非常敏感：

```
>>> scale_to_int(np.linspace(0, 1, 5)) # [0, 0.25, 0.5, 0.75, 1]
array([0, 1, 2, 3, 4], dtype=object)
>>> scale_to_int(np.linspace(0, 1, 4)) # [0, 0.33333333, 0.66666667, 1]
array([0, 6004799503160661, 12009599006321322, 18014398509481984], dtype=object) 
```

您可以使用 的`limit_denominator`方法来缓解其中的一些问题`Fraction`，但可能不会那么健壮。

# android - Android Loading Indicator for Downloading Images

> ID：14407582
> 
> 赞同：1
> 
> 时间：2013-01-18T21:04:18.647
> 
> 标签：android, android-progressbar

I am using an Image Loaded which loads images based on requirment and since the images are big. I want to display an intermediate Spinning Image showing which would convey that the image is loading to the User.

I am displaying these images in the Viewpager.

We can not use a Gif image to display the animation and i wonder how it can be done.

P.S i am not looking for a Progress Dialog.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:25:26.907

You could try doing a [View Animation](http://developer.android.com/guide/topics/graphics/view-animation.html) on the ImageView. Rotate is one of the included animations, and you can define it in XML.

Here's a [Youtube Video](https://www.youtube.com/watch?feature=player_embedded&v=_UWXqFBF86U) from Google explaining it a little more.

# php - 使用 fgets 读取 csv 文件的 PHP 字符编码地狱

> ID：14407584
> 
> 赞同：4
> 
> 时间：2013-01-18T21:04:34.483
> 
> 标签：php, encoding, fgets

我有一个每月通过 FTP 接收 CSV 文件的网站。多年来，它一直是一个 ASCII 文件。现在我一个月收到 UTF-8，然后是 UTF-16BE，下个月收到 UTF-16LE。也许下个月我会得到 UTF-32。Fgets 返回 UTF 文件开头的字节顺序标记。如何让 PHP 自动识别字符编码？我试过 mb_detect_encoding 并且无论文件类型如何，它都会返回 ASCII。我更改了代码以读取 BOM，并将字符编码显式放入 mb_convert_encoding。这一直有效，直到最新的文件是 UTF-16LE。在这个文件中，它正确读取了第一行，所有后续行都显示为问号（“？”）。我究竟做错了什么？

```
$fhandle = fopen( $file_in, "r" );
if ( fhandle === false )
    {
    echo "<p class=redbold>Error opening file $file_in.</p>";
    die();
    }

$i = 0;
while( ( $line = fgets( $fhandle ) ) !== false )
{
$i++;

// Detect encoding on first line. Actual text always begins with string "Document"
if ( $i == 1 )
    {
    $line_start = substr( $line, 0, 4 );
    $line_start_hex = bin2hex( $line_start );
    $utf16_start = 'fffe4400';
    $utf8_start = 'efbbbf44';
    if ( strcmp( $line_start, 'Docu' ) == 0 )
        { $char_encoding = 'ASCII'; }
    elseif ( strcmp( $line_start_hex, 'efbbbf44' ) == 0 )
        {
        $char_encoding = 'UTF-8';
        $line = substr( $line, 3 );
        }
    elseif ( strcmp( $line_start_hex, 'fffe4400' ) == 0 )
        {
        $char_encoding = 'UTF-16LE';
        $line = substr( $line, 2 );
        }
    elseif ( strcmp( $line_start_hex, 'feff4400' ) == 0 )
        {
        $char_encoding = 'UTF-16BE';
        $line = substr( $line, 2 );
        }
    else
        {
        echo "<p class=redbold>Error, unknown character encoding. Line =<br>", $line_start_hex, '</p>';
        require( '../footer.php' );
        die();
        }
    echo "<p>char_encoding = $char_encoding</p>";
    }

// Convert UTF
if ( $char_encoding != 'ASCII' )
    {
    $line = mb_convert_encoding( $line, 'ASCII', $char_encoding);
    }

echo '<p>'; var_dump( $line ); echo '</p>';
} 
```

输出：

```
 char_encoding = UTF-16LE

string(101) "DocumentNumber,RecordedTS,Title,PageCount,City,TransTaxAccountCode,TotalTransferTax,Description,Name
"

string(83) "???????????????????????????????????????????????????????????????????????????????????"

string(88) "????????????????????????????????????????????????????????????????????????????????????????"

string(84) "????????????????????????????????????????????????????????????????????????????????????"

string(80) "????????????????????????????????????????????????????????????????????????????????" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T10:09:23.907

显式传递顺序和可能的编码来检测，并使用严格的参数。也请使用`file_get_contents`，如果文件是 UTF-16LE，`fgets`会为你搞砸。

```
<?php
header( "Content-Type: text/html; charset=utf-8");
$input = file_get_contents( $file_in );

$encoding = mb_detect_encoding( $input, array(
    "UTF-8",
    "UTF-32",
    "UTF-32BE",
    "UTF-32LE",
    "UTF-16",
    "UTF-16BE",
    "UTF-16LE"
), TRUE );

if( $encoding !== "UTF-8" ) {
    $input = mb_convert_encoding( $input, "UTF-8", $encoding );
}
echo "<p>$encoding</p>";

foreach( explode( PHP_EOL, $input ) as $line ) {
    var_dump( $line );
} 
```

顺序很重要，因为 UTF-8 和 UTF-32 限制性更强，而 UTF-16 极其宽松；几乎任何随机偶数字节长度都是有效的 UTF-16。

保留所有信息的唯一方法是将其转换为 unicode 编码，而不是 ASCII。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:10:40.570

我的建议是将所有内容都转换为 UTF-8 或 ASCII（如果您尝试将所有内容都转换为 UTF-8 或 ASCII，则从您发布的代码中不太确定）

```
$utf8Line = iconv( mb_detect_encoding( $line ), 'UTF-8', $line ); 
```

或者...

```
$asciiLine = iconv( mb_detect_encoding( $line ), 'ASCII', $line ); 
```

您可以利用杠杆`mb_detect_encoding`为您完成繁重的工作

# c - 指针和二维数组

> ID：14407589
> 
> 赞同：0
> 
> 时间：2013-01-18T21:04:41.057
> 
> 标签：c, arrays, pointers, matrix, char

对于下一个代码片段：

```
char words[10][9] = {
"Hello",
"Good-bye"
}; 
```

该表达式`words[2][4]`会给我字符`'o'`，但我不明白为什么。

任何人都可以解释这种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:16:09.643

在*“部分”初始化*之后，所有*“未初始化”*的元素都被有效地初始化为`0`.

所以你的元素应该有一个`0`（或`'\0'`）的值。

如果没有，还有其他事情发生，您没有向我们展示。

**在 C 中没有部分初始化：要么所有元素都被初始化（可能为 0），要么没有元素被初始化。**

请参阅[http://ideone.com/JDv86w](http://ideone.com/JDv86w)或[http://ideone.com/j6BIRP](http://ideone.com/j6BIRP)

# javascript - 在 Raphael javascript 库中为带有文本的矩形设置动画

> ID：14407590
> 
> 赞同：0
> 
> 时间：2013-01-18T21:05:13.610
> 
> 标签：javascript, raphael

我对 javascript 和 Raphael 很陌生。我正在尝试移动一个内部带有文本的按钮状矩形。这是我的代码：

```
window.onload = function() {
  var paper = new Raphael(document.getElementById('canvas_container'), "100%", "100%");
  var box1 = paper.rect(100, 100, 120, 50, 10).attr({fill: 'darkorange', stroke: '#3b4449', 'stroke-width': 2, cursor: 'pointer'});

  var box2 = paper.rect(400,100,120,50,10).attr({fill: 'lightblue', stroke: '#3b4449', 'stroke-width': 2});
  var text2 = paper.text(box2.attrs.x + box2.attrs.width/2,box2.attrs.y + box2.attrs.height/2,"[x: " + box2.attrs.x + " y: " + box2.attrs.y + "]").attr({"font-family": "arial", "font-size": 16});
  var button2 = paper.set();
  button2.push(box2); 
  button2.push(text2);

  box1.click(function(){
    // this did not work
    // button2.animate({x: 100, y: 50 }, 1000, 'bounce', function() { // callback function
    //  text2.attr('text',"[x: " + box2.attrs.x + " y: " + box2.attrs.y + "]");
    // });
    button2.animate({transform: "t100,100"}, 1000, 'bounce', function() { // callback function
        text2.attr('text',"[x: " + box2.attrs.x + " y: " + box2.attrs.y + "]");
    });
  });
} 
```

该`button2.animate({x: 100, y: 50 }, 1000, 'bounce');`行无法正常工作，文本最后的位置不正确。通过使用`transform:`我不能使用坐标，我将不得不计算它们。`transform`另外，在使用该方法时，最后我无法获得蓝色框的正确坐标。

我还没有找到任何答案，希望有人可以帮助我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T05:57:35.743

由于您没有解释要如何移动按钮，我假设您要移动`box2`上面的`box1`.

您的代码中存在一些误解和错误，请允许我一一解释。

## 为什么第一种方式会导致文本最后移动到错误的位置？

因为集合不是一组元素，它知道它在组内的相对位置。集合只是元素的集合，旨在让我们以更方便的方式操作它们。

因此，下面的代码会将集合中的所有元素移动到 (100, 50)

```
set.animate({x: 100, y: 50 }, 1000); 
```

这就是文本存在的原因。

我找不到文档，但你可以[在这里](https://stackoverflow.com/a/14003371/554279)找到一些解释。

## 为什么使用 transform 时属性中的 x, y 似乎是错误的？

不，属性是正确的。

转换元素时，转换的结果不会反映回属性。您可以这样想，当 时`transform()`，您实际上是在将“转换”附加到元素上。所以 ：

```
paper.circle(100, 100, 5).transform("t100"); 
```

您可以将圆圈描述为：

*(100, 100) 处的一个圆圈，将水平移动 100px。*

但不是 - *(200, 100) 处的一个圆圈，它将水平移动 100 像素。*

* * *

所以，这里是你想要的代码，注意我`getBBox()`用来获取`button2`集合的坐标。

```
 box1.click(function(){
    var moveX = box1.attr("x") - button2.getBBox().x;
    var moveY = (box1.attr("y") - 50) - button2.getBBox().y;
    button2.animate({transform: "t" + moveX + "," + moveY}, 1000, 'ease-in-out', function () {
      text2.attr('text', "[x: " + button2.getBBox().x + "y: " + button2.getBBox().x + "]");
    });
  }); 
```

欢迎来到SO，建议你下次写一篇[SSCCE 。](http://sscce.org/)

* * *

## 更新

> 我不完全理解为什么转换不反映回属性。如果我将位置 (100,100) 处的圆圈水平移动 100px，它将在位置 (200,100) 处产生一个圆圈。这就是边界框给我的。那么为什么我无法在转换后从圆中获取坐标而必须使用边界框方法呢？

转换不要更改元素中的原始属性，因为它是您附加到元素的东西，而不是直接更改元素的函数。如果您想在应用转换后了解属性，则必须使用`getBBox()`，或查看[matrix](https://stackoverflow.com/questions/10939195/)。

这就是 Raphael.js 的工作原理。要么使用边界框功能，要么像[这样自己扩展 Raphael.js](https://stackoverflow.com/questions/13046811/)

我已经改变了我之前关于如何描述转换的答案，希望它可以帮助你这次更好地理解。

> 您的代码效果很好，但它有一个缺点，即您必须计算转换值而不是简单地设置位置。有没有其他方法可以将带有文本的矩形移动到您选择的位置？

无论如何，您总是可以编写辅助函数来为您完成这些丑陋的工作，我看不出有什么问题。

# php - Javascript document.body.style.backgroundImage 导致 php mysql 查询运行？

> ID：14407597
> 
> 赞同：0
> 
> 时间：2013-01-18T21:05:39.123
> 
> 标签：php, javascript, mysql, background-image

所以我花了很多时间来弄清楚发生了什么以及我的数据库是如何随机更新自己的，但我发现它与 using: `document.body.style.backgroundImage`in Javascript 直接相关。

有谁知道如何防止它再次运行我的查询或如何`document.body.style.backgroundImage`工作？备择方案？我无法承受不断运行 Javascript 来更改背景的查询。

**细节**

我正在运行的网站在页面加载开始时 PHP 获取并使用语句`time()`将其存储在数据库中。`mysql_query()`我最近在我的网站上实现了一个 Javascript 循环，它经常运行并在函数中使用此代码更改背景：`document.body.style.backgroundImage = "url('')";`

我注意到，当它运行并且背景发生变化时，查询会以某种方式在我的网站上再次运行，并且它会再次更新我的数据库以更改时间。我通过注释掉javascript背景更改语句来隔离原因，让循环的其余部分正常运行。之后，它不再更新。一旦我取消注释该行，问题就会再次出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:17:49.520

这是因为当您将背景图像设置为 时`url('')`，您实际上是在告诉浏览器为您当前所在的页面发出 HTTP 请求。空字符串 '' 被视为相对 URL。（这与省略表单的 或将其设置为 '' 时发生的情况相同`action`- 表单将提交到当前页面。）

要解决这个问题，请尝试`document.body.style.backgroundImage = "";`而不是`url('')`.

# objective-c - how to pass self to function in other class in objective c

> ID：14407598
> 
> 赞同：1
> 
> 时间：2013-01-18T21:05:41.223
> 
> 标签：objective-c, facebook, class, social-framework

Hi I am new in development of iOS. I make class named socialClass.h

```
#import <Social/Social.h>
#import <Accounts/Accounts.h>

- (void)facebookSharingStatusCheckCall:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(UIViewController *)uiVew;

- (void)facebookForIosSix:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(UIViewController *)uiVew; 
```

and in socialClass.m

```
 - (void)facebookSharingStatusCheckCall:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(UIViewController *)uiVew 
{
    if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
        NSLog(@"service available");

     [self facebookForIosSix:url image:img status:text viewCont:uiVew];

    } else {
        // facebook for iOS 5 function will be called here
    }
}

-(void)facebookForIosSix:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(UIViewController *)uiVew
{

if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {

        SLComposeViewController *fbcontroller = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

    SLComposeViewControllerCompletionHandler myBlock = ^(SLComposeViewControllerResult result){
        if (result == SLComposeViewControllerResultCancelled) {

                NSLog(@"Post Cancelled");

            } else

            {
                NSLog(@"Post Done");
            }

            [fbcontroller dismissViewControllerAnimated:YES completion:Nil];
        };
        fbcontroller.completionHandler =myBlock;

        //Adding the Text to the facebook post value from iOS
        [fbcontroller setInitialText:text];

        //Adding the URL to the facebook post value from iOS

        [fbcontroller addURL:[NSURL URLWithString:url]];

        //Adding the Image to the facebook post value from iOS

        [fbcontroller addImage:[UIImage imageNamed:img]];
        [uiVew presentViewController:fbcontroller animated:YES completion:nil];

    }
    else{
        UIAlertView *alertView = [[UIAlertView alloc]
                                  initWithTitle:@"Sorry"
                                  message:@"You can't Post a Status right now, make sure                                  your device has an internet connection and you have                                  at least one Twitter account setup"
                                  delegate:nil
                                  cancelButtonTitle:@"OK"
                                  otherButtonTitles:nil];
        [alertView show];

        NSLog(@"UnAvailable");
    }

} 
```

Now I call in mainViewController.h

```
#import "socialClass.h" 
```

and in mainViewController.m

```
- (IBAction)facebookShareBtn:(id)sender {

    [[socialClass facebookSharingStatusCheckCall:[[DataPassing sharedManager] pageURL ]
        image:[[DataPassing sharedManager]
        pageIMGurl]
        status:[[DataPassing sharedManager] pageTEXT]]
        viewCont:(UIViewController*)self];
} 
```

When I use this below code with self it gives error. Definitely because there is no self view

[self presentViewController:fbcontroller animated:YES completion:nil]; so i put uiView in function and try to pass self from mainViewController. again error in mainview

How can I use this facebook from other calls function in mainviewcontroller. thx

[EDIT]

i declare socialClass.h in mainViewController and call the function in button [socialClass facebookForIosSix:...]

![enter image description here](../Images/3a43738ed0ca903b4ecac3b5edc16e16.png)

This error is comming... after updating to (UIViewController*)self

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:22:10.787

好的，在你的函数定义中有几件事需要改变。

首先你需要一个 - 在前面而不是一个 +。加号表示类方法，而 - 表示实例方法。您正在像使用实例方法一样使用它。

其次，您需要在 SocialClass.h 文件中包含 MainViewController.h。然后将函数命名为...

```
- (void)facebookForIosSix:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(MainViewController *)mainViewController; 
```

然后在 mainViewController 你可以运行...

```
[socialViewController facebookSharingStatusCheckCall:@"url"  image:@"hello.png" status:@"Posting from App" viewCont:self]; 
```

这应该可以正常工作。

**编辑**

如果您想从多个地方运行该功能，则不要导入 MainViewController.h 并定义该功能，例如...

```
- (void)facebookForIosSix:(NSString *)url image:(NSString *)img status:(NSString *)text viewCont:(UIViewController *)viewController; 
```

然后像...一样运行它

```
[socialViewController facebookSharingStatusCheckCall:@"url"  image:@"hello.png" status:@"Posting from App" viewCont:(UIViewController*)self]; 
```

TBH，我认为你根本不需要施放它，但只是为了安全起见。

**编辑**

你还没有平衡你的括号...

```
- (IBAction)facebookShareBtn:(id)sender {

    [socialClass facebookSharingStatusCheckCall:[[DataPassing sharedManager] pageURL ]
        image:[[DataPassing sharedManager] pageIMGurl]
        status:[[DataPassing sharedManager] pageTEXT]
        viewCont:(UIViewController*)self];
} 
```

这将起作用。

# haskell - Haskell dollar operator application

> ID：14407599
> 
> 赞同：12
> 
> 时间：2013-01-18T21:05:41.410
> 
> 标签：haskell, operators, dollar-sign, partial-application, operator-sections

I'm having trouble with understanding how function application works with currying in haskell. If I have following function:

```
($) :: (a -> b) -> a -> b 
```

I understand that to partially apply this function I need to provide `(a -> b)` function (`$`'s first argument).

Why then is it possible to apply a value first (i.e. reverse arguments)?

```
($ 0) :: Num a => (a -> b) -> b 
```

What am I missing here?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-18T21:09:27.373

`($)`是一个运算符。在 Haskell 中，任何运算符都可以写在左侧（如`(x $)`）或右侧（如`($ x)`）中：

```
(x $) = (\y -> x $ y) = ($) x
($ x) = (\y -> y $ x) = flip ($) x 
```

* * *

请注意，此规则的唯一例外是`(-)`，为了方便地写负数：

```
\x -> (x-) :: Num a => a -> a -> a  -- equivalent to \x -> (-) x
\x -> (-x) :: Num a => a -> a       -- equivalent to \x -> negate x 
```

如果您想简洁地编写`(\y -> y - x)`，可以使用`subtract`：

```
\x -> subtract x :: Num a => a -> a -> a  -- equivalent to \x -> flip (-) x 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T21:08:07.900

`($ 0)`≡ `(\x -> x $ 0)`≡`(\x -> ($) x 0)`

如果我们像我们`($) :: (a -> b) -> a -> b)`一样应用了第二个参数`(\x -> ($) x 0)``:: Num a => (a -> b) -> b`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T21:11:49.507

您将运算符的中缀表示法与函数混淆了。

```
> :t (($) (+1))
(($) (+1)) :: Num b => b -> b 
```

`$`为了更好地理解，这里有一些表达形式：

> a $ b => ($) ab
> 
> ($ b) => 翻转 ($) b => (\ba -> ($) ab) b => \a -> ($) ab
> 
> (a $) => ($) a => \b -> ($) ab

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-28T01:09:57.107

另请注意，在 Haskell 语法中，字母数字名称与标点名称不同。

字母数字函数`foo1 a b`默认为前缀，如果添加反引号，则变为中缀：`a `foo` b`。

标点命名的函数默认为`$`or`<*>`中缀，如果添加括号`($)`or则成为前缀`(<*>)`。对于熟悉拉丁字母的程序员来说，这只是语法糖；这是字母数字名称和标点名称之间的任意但有用的区别。

这两种函数都只是函数，它们没有我们在 C++ 或 Java 中为“运算符”所拥有的特殊语义规则。只是围绕前缀/中缀和反引号/括号的语法规则在标点符号命名的函数和字母数字命名的函数之间有所不同。

# r - Read.csv makes everything negative

> ID：14407600
> 
> 赞同：2
> 
> 时间：2013-01-18T21:05:42.577
> 
> 标签：r, csv, read.table, read.csv

> **Possible Duplicate:**
> [R seems to multiply my data by -1](https://stackoverflow.com/questions/14182735/r-seems-to-multiply-my-data-by-1)

I have a simple csv file. Looks like this

x y 1 2 1 3 2 1 2 3

I created it in MS Excel, saved as csv etc.

I read it using this command

ttest<--read.csv("ttest.csv", header = TRUE)

The resulting data looks like this

x y -1 -2 -1 -3 -2 -1 -2 -3

I've opened the original csv file in a text editor and it looks like it should

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T05:07:21.837

原因是您的命令：

```
ttest<--read.csv("ttest.csv", header = TRUE) 
```

... 在 之后有一个额外的破折号`<-`，R 将其解释为负号，因此在将数据加载到`ttest`.

此外，`read.csv()`用于读取逗号分隔值文件的 和之间可能存在一些混淆`read.table()`，后者将读取如下文件：

```
x y 
1 2 
1 3 
2 1 
2 3 
```

...这更像是我认为您的文件最初的样子。

# javascript - Jade 'each' iterator is iterating extra object properties?

> ID：14407604
> 
> 赞同：0
> 
> 时间：2013-01-18T21:05:50.590
> 
> 标签：javascript, express, pug

I'm using node, express, and jade. I seem to be iterating over two extra object properties added by jade. I'm passing in rows which is an array of objects.

**app**

```
conn.query( 'SELECT * FROM invoice ORDER BY account ASC',
            function (err, rows, fields) {
              console.log(rows);
              res.render('index', { rows: rows, fields: fields  })
}); 
```

**index.jade:**

```
table(border=1)
  each row in rows
    tr
      each cell in row
        td= cell 
```

**console.log**

```
[ { id: 34,
    account: 'abcdefg' } ] 
```

**http://localhost/** this is one of the extra properties that i get when iterating through the objects.

```
<td>function (field, parser, timeZone) {
  switch (field.type) {
    case Types.TIMESTAMP:
    case Types.DATE:
    case Types.DATETIME:
    case Types.NEWDATE:
      var dateString = parser.parseLengthCodedString();
      if (dateString === null) {
        return null;
  }

  if (timeZone != 'local') {
    if (field.type === Types.DATE) {
      dateString += ' 00:00:00 ' + timeZone;
    } else {
      dateString += timeZone;
    }
  }

  return new Date(dateString);
case Types.TINY:
case Types.SHORT:
case Types.LONG:
case Types.INT24:
case Types.YEAR:
case Types.FLOAT:
case Types.DOUBLE:
case Types.LONGLONG:
case Types.NEWDECIMAL:
  var numberString = parser.parseLengthCodedString();
  return (numberString === null || (field.zeroFill &amp;&amp; numberString[0] == &quot;0&quot;))
    ? numberString
    : Number(numberString);
case Types.BIT:
  return parser.parseLengthCodedBuffer();
case Types.STRING:
case Types.VAR_STRING:
case Types.TINY_BLOB:
case Types.MEDIUM_BLOB:
case Types.LONG_BLOB:
case Types.BLOB:
  return (field.charsetNr === Charsets.BINARY)
    ? parser.parseLengthCodedBuffer()
    : parser.parseLengthCodedString();
case Types.GEOMETRY:
  return parser.parseGeometryValue();
default:
  return parser.parseLengthCodedString();
  }
}</td> 
```

# .htaccess - .htaccess rewriterule - check for referrer, if wrong referrer send to a specific URL, if right, allow directory to be read

> ID：14407606
> 
> 赞同：0
> 
> 时间：2013-01-18T21:06:09.050
> 
> 标签：.htaccess

I have a folder on my site (domain.com/protect) I want to limit to only one referrer (otherdomain.com/subfolder).

Deny for all others, allow only if coming from that URL.

If not coming from that URL, then redirect the visitor over to otherdomain.com/login instead.

How would I write that out in .htaccess rewrite rules?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:28:14.733

在您`/protect`目录中的 htaccess 文件中，添加以下规则：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !otherdomain\.com/subfolder
RewriteRule ^ - [L,F] 
```

该条件检查引用者不包含：`otherdomain.com/subfolder`，如果不包含，则无论请求是什么（在`/protect`目录内）都会导致 403 Forbidden。

或者，如果您希望将所有内容保存在一个位置，则可以将这些规则放在文档根目录的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !otherdomain\.com/subfolder
RewriteRule ^/?protect/? - [L,F] 
```

# jquery - JQuery 只影响一个fancybox 样式

> ID：14407607
> 
> 赞同：0
> 
> 时间：2013-01-18T21:06:14.893
> 
> 标签：jquery, fancybox

在用户执行特定操作后，我正在运行 jQuery 代码来更改 fancybox 的外观，但是当调用以下代码时

```
$('#boxbox').fadeOut(function(){
    $(".fancybox-inner").width('590px');
    $(".fancybox-inner").height('140px');
    $('#boxbox').html(data).fadeIn();
}); 
```

只有高度发生了变化。除了第二行之外，其他一切都按预期工作。如何将框调整为 590x140？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:15:51.313

通过修改#boxbox 的 HTML，您还修改或覆盖了 .fancybox-inner。尝试：

```
$('#boxbox').click(function () {
    $(".fancybox-inner").width('590px').height('140px');
    $('.fancybox-inner .text').html("I've been clicked!").fadeIn();
}); 
```

[http://jsfiddle.net/sRMbV/7](http://jsfiddle.net/sRMbV/7)

# mysql - MySQL 数据读取器未进入循环

> ID：14407609
> 
> 赞同：0
> 
> 时间：2013-01-18T21:06:18.230
> 
> 标签：mysql, vb.net

我尝试了很多不同的东西，但在这一点上我很难过。

```
Public Function GetCust(email As String) As Integer
    Dim cs As String = <connection string>
    Dim conn As New MySqlConnection(cs)
    Dim custId As Integer
    Dim cust_query As String = "SELECT entity_id FROM customer_entity WHERE email = '@email'"
    Dim com As New MySqlCommand(cust_query, conn)
    Dim reader As MySqlDataReader

    Try
        conn.Open()
        com.Parameters.Add("@email", MySqlDbType.String)
        com.Parameters("@email").Value = email
        reader = com.ExecuteReader
        While reader.Read()
            custId = reader.GetInt16(0)
        End While
        MsgBox(custId)
    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try

    Return custId
End Function 
```

它应该只从表中提取一列和一行，所以我应该只有一个值来自查询，但它没有进入循环。对我来说似乎是语法错误，但似乎找不到。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T00:56:12.707

您应该删除 SQL 字符串中电子邮件参数周围的引号：

```
Dim cust_query As String = "SELECT entity_id FROM customer_entity WHERE email = @email" 
```

这将生成看起来像的 SQL

```
WHERE email = ''myemail@mydomain.com'' 
```

什么时候应该

```
WHERE email = 'myemail@mydomain.com' 
```

# jquery - Jquery and PhoneGap - redirect before executing all sql transactions

> ID：14407611
> 
> 赞同：0
> 
> 时间：2013-01-18T21:06:30.757
> 
> 标签：jquery, sqlite, cordova, mobile

I am having problems with a piece of code that reads records from a table and inserts data in another table. It doesn't execute all the sql transactions.

Here is the code:

```
 $(".btnRepetePed").live("click",function(){
            var pedido = $(this).val();
            db.transaction(function(tx){
                console.log("Pedido:" + pedido);
                tx.executeSql("SELECT p.pedido,p.cliente,p.obs,p.talao,p.obs,p.prazo,p.polvenda,p.datafat, p.tipo,p.valortotal,p.situacao,p.datacri,p.icms,p.cod_bonif,p.desc_bonif,p.cod_troca, pp.produto, pp.valor, pp.qtd, prod.peso, prod.descricao ,pp.desconto, pp.uni_embut, pp.quantidade FROM pedidos p INNER JOIN pedidos_produtos pp ON p.pedido = pp.pedido INNER JOIN produtos prod ON pp.produto=prod.codigo WHERE p.pedido=? ", [pedido], function(tx, rs){
                        var sql = "INSERT INTO carrinho (produto,descricao, peso, qtd, valor, desconto) VALUES(?,?,?,?,?,?)";

                        var len = rs.rows.length;
                        console.log("size:"+len);
                        var i = 0;
                        for(i=0;i<len;i++){
                            dados = [rs.rows.item(i).produto, rs.rows.item(i).descricao, rs.rows.item(i).peso,rs.rows.item(i).qtd, rs.rows.item(i).valor, rs.rows.item(i).desconto];
                            console.log(i);
                            (function(dados, sql) {
                                db.transaction(function(tx){
                                    tx.executeSql(sql,dados,function(){
                                        console.log(JSON.stringify(dados));
                                    },function(e){
                                        console.log("Código erro "+e.code);
                                        console.log("Código erro "+e.message);    
                                    }); 
                                });
                            })(dados,sql);
                        }

                        alert("Finished");
                        goURL("pedidos.html#novoPedido");
                },fail);    
            }); 
```

And here is the output from the console:

*   D/CordovaLog(17822): size:4
*   D/CordovaLog(17822): 0
*   D/CordovaLog(17822): 1
*   D/CordovaLog(17822): 2
*   D/CordovaLog(17822): 3

Fine up to here. There are 4 records and "console.log(i);" is executed 4 times.

Only after I touch the OK button from the 'alert("Finished");' command the following logs from the transactions are displayed:

*   D/CordovaLog(17822): [1010012,"F.TRIGO T1 MARIA INES C/FERMENTO 1KG",1,1,1.76,null]
*   D/CordovaLog(17822): [1020011,"F.TRIGO T1 REDE MACRO 5kg",5,2,6.53,null]
*   D/CordovaLog(17822): [1020004,"F.TRIGO T1 FLOCOS DE NEVE 1kg",1,112,1.3,null]

Sometimes it displays 2, sometimes 3 transaction logs, but it never executes all 4 transactions

I'm lost. Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:24:10.047

当所有转换完成后，您需要提醒并调用 goURL。那么您需要在 console.log(JSON.stringify(dados)) 之前执行此操作，但是当 i == len-1 时：

```
tx.executeSql(sql,dados,function(){
    if(i == len-1)
    {
      alert("");
      goURL("...")
    }
    console.log(JSON.stringify(dados));
}, ... 
```

# c# - Random Orderby on subquery in LINQ

> ID：14407615
> 
> 赞同：3
> 
> 时间：2013-01-18T21:06:49.980
> 
> 标签：c#, linq

I have three entity framework objects, Quiz, Question, and Option. A Quiz has a collection of Question objects, and a Question has a collection of Option objects. I would like to return from the `DBContext` a randomized list of questions for a specified quiz and each question should include a randomly sorted collection of associated Options.

So far, I have been able to get the random list of questions out successfully, but I am having trouble randomizing the options for the question.

Note: I have a couple of different shuffling extension methods I have written, in this example I am using ordering by a Guid for sake of simplicity.

```
var questions = db.Questions.Where(q => q.QuizId == quizId).Include(q => q.Options).OrderBy(a => Guid.NewGuid()); 
```

How can I randomly shuffle the Options?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T10:30:07.063

我不确定 LINQ-to-SQL 是否支持转换这种特定功能。在您的引导中，如果我可以访问数据库，我将创建一个存储过程，如此[处所述，](http://www.petefreitag.com/item/466.cfm)以获取数据库级别的随机行。虽然，这也是一个非最佳解决方案（请参阅[此问题](https://stackoverflow.com/questions/19412/how-to-request-a-random-row-in-sql)的已接受答案）

您可以采用以下方法（假设您的问题少于 MAXINT）：

```
Random random;
var c = Questions.Count();

var randomNumbers = new List<int>();
var fetchedQuestions = new List<Question>();
var randomNumber = random.Next(1,c);

for (int i = 0; i < maxQuestions; i++) {
    while (randomNumbers.Contains(randomNumber))
        randomNumber = random.Next(1,c);
    randomNumbers.Add(randomNumber);
    fetchedQuestions.Add(Questions.ElementAt(randomNumber));
}
return fetchedQuestions; 
```

即只生成一些随机的唯一问题行号并获取相应的行。

**警告！**使用前需要优化 - 这是一个肮脏的代码原型。

# javascript - trouble with passing values between functions

> ID：14407616
> 
> 赞同：0
> 
> 时间：2013-01-18T21:06:52.730
> 
> 标签：javascript, events, properties, parameters

I'm having trouble figuring out how to pass values from one function to another. I've created a program where I create boxes using values from a form that show up in the webpage. The values I'm talking about are property values of the boxes themselves.

Here is the function where the values are assigned to the boxes:

```
function addBox(newbox) {  
       for (var i = 0; i < newbox.number; i++) { 
       counter++;
       var id = counter;                          
       var scene = document.getElementById("scene");              
       var div = document.createElement("div"); 
       div.value = id;
       console.log(div.value);                  
       div.className += " " + "box"; 
       div.innerHTML += newbox.name; 
       div.style.backgroundColor = newbox.color; 
       var x = Math.floor(Math.random() * (scene.offsetWidth-101));
       var y = Math.floor(Math.random() * (scene.offsetHeight-101));
       div.style.left = x + "px";
       div.style.top = y + "px"; 
       scene.appendChild(div); 
       div.onclick = display;              
        }                      
      } 
```

Here is the function that I'm having trouble passing the values to. I need to pass them so that I can display them in an alert box when I click on each box:

```
 function display(e) {
  alert(e.target.toSource());
  } 
```

So far when I click it, I just get an empty pair of brackets in the alert box.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:25:39.533

我在 JS Fiddle 中试过你的例子：http: [//jsfiddle.net/jCC6n/](http://jsfiddle.net/jCC6n/)

我看到至少两个问题。

1.  “counter”是未定义的，这会导致代码在第一次尝试递增它时失败。我在函数顶部添加了一个变量声明。
2.  toSource 未定义。我将其替换为“outerHTML”，它适用于 Chrome、IE 和可能的其他浏览器。

通过上述更改，这行得通。

```
function display(e) {
    alert(e.target.outerHTML);
}

function addBox(newbox) {  
    var counter = 0;
    for (var i = 0; i < newbox.number; i++) { 
        counter++;
        var id = counter;                          
        var scene = document.getElementById("scene");              
        var div = document.createElement("div"); 
        div.value = id;
        div.className += " " + "box"; 
        div.innerHTML += newbox.name; 
        div.style.backgroundColor = newbox.color; 
        var x = Math.floor(Math.random() * (scene.offsetWidth-101));
        var y = Math.floor(Math.random() * (scene.offsetHeight-101));
        //div.style.left = x + "px";
        //div.style.top = y + "px"; 
        scene.appendChild(div); 
        div.onclick = display;              
    }                      
}

addBox({ number: 3, name: "Hello", color: '#C00' }); 
```

请注意，使用 onclick 事件处理程序的事件处理因浏览器而异。最好使用了解所有差异并为您提供处理事件的统一方式的 JavaScript 框架。jQuery 可以说是最常用的此类框架。

# php - EasyPHP 12.1 Unable to load dynamic library

> ID：14407619
> 
> 赞同：0
> 
> 时间：2013-01-18T21:07:03.877
> 
> 标签：php, environment-variables

This is one of the errors that I get when I launch `php` command in my Windows prompt.![enter image description here](../Images/3a06fb37a43f81505ea682caef1522a9.png)

I've installed the environment through EasyPHP 12.1 installer. This is a minor problem, since i can use without any problem the full LAMP stack. I noticed the problem just because ApiGen needs `mbstring` to create documentation (picture above actually is related to bz2 library, but nothing changes for other missing library). Last path in the warning sounds strange since don't exist nothing PHP related in my LaTex distribution. Any suggest about the problem???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:17:19.060

前段时间我有同样的问题。这对我有用。

[http://czetsuya-tech.blogspot.cz/2011/02/solving-php-startup-unable-to-load.html](http://czetsuya-tech.blogspot.cz/2011/02/solving-php-startup-unable-to-load.html)

# c++ - Using const& type for relabeling variables

> ID：14407623
> 
> 赞同：1
> 
> 时间：2013-01-18T21:07:18.263
> 
> 标签：c++, variables, reference, names

I like to use `const& type T = LongVariableName` to relabel variables in a short segment of code, especially one that involves formulas.

For example:

```
const double& x = VectorNorm;
double y = a*x*x*x + b*x*x + c*x + d; 
```

I figure the compiler should be smart enough to optimize these reference variables away. Will that almost always happen? When won't it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:11:31.233

这取决于编译器和您设置的优化选项 - 不能保证它会或不会被优化掉。启用优化的现代编译器可能会将其优化掉，但更好的问题是：您应该关心吗？除非您处于每秒运行数千次的紧密循环中，否则不要担心。代码清晰通常比减少几个时钟周期更重要。

但无论如何，让我们来看看。我正在通过 MinGW 使用 gcc 4.7.2。我们将使用以下代码：

所以.cpp：

```
#include <cstdio>

int main()
{
    float aReallyLongNameForAVariable = 4.2;
#ifdef SHORT_REF
    const float& x = aReallyLongNameForAVariable;
    float bar = x * x * x;
#else
    float bar = aReallyLongNameForAVariable * aReallyLongNameForAVariable * aReallyLongNameForAVariable;
#endif
    printf("bar is %f\n", bar);
    return 0;
} 
```

没有“速记参考”，我们得到以下程序集：

```
g++ -S -masm=intel -o noref.S so.cpp

call    ___main
mov eax, DWORD PTR LC0
mov DWORD PTR [esp+28], eax
fld DWORD PTR [esp+28]
fmul    DWORD PTR [esp+28]
fmul    DWORD PTR [esp+28]
fstp    DWORD PTR [esp+24]
fld DWORD PTR [esp+24]
fstp    QWORD PTR [esp+4]
mov DWORD PTR [esp], OFFSET FLAT:LC1
call    _printf
mov eax, 0
leave 
```

现在让我们使用参考：

```
g++ -DSHORT_REF -S -masm=intel -o ref.S so.cpp

call    ___main
mov eax, DWORD PTR LC0
mov DWORD PTR [esp+20], eax
lea eax, [esp+20]
mov DWORD PTR [esp+28], eax
mov eax, DWORD PTR [esp+28]
fld DWORD PTR [eax]
mov eax, DWORD PTR [esp+28]
fld DWORD PTR [eax]
fmulp   st(1), st
mov eax, DWORD PTR [esp+28]
fld DWORD PTR [eax]
fmulp   st(1), st
fstp    DWORD PTR [esp+24]
fld DWORD PTR [esp+24]
fstp    QWORD PTR [esp+4]
mov DWORD PTR [esp], OFFSET FLAT:LC1
call    _printf
mov eax, 0
leave 
```

所以它是一个多一点的组装。但是当我们开启优化时会发生什么？

```
g++ -DSHORT_REF -O2 -S -masm=intel -o ref.S so.cpp
g++ -O2 -S -masm=intel -o noref.S so.cpp 
```

两者都生成相同的程序集：

```
call    ___main
fld DWORD PTR LC0
fstp    QWORD PTR [esp+4]
mov DWORD PTR [esp], OFFSET FLAT:LC1
call    _printf
xor eax, eax
leave 
```

所以你有它。现代编译器（至少 gcc）优化了引用。

# iphone - YouTube in UITableView

> ID：14407624
> 
> 赞同：1
> 
> 时间：2013-01-18T21:07:25.887
> 
> 标签：iphone, ios, uiwebview, youtube

Ok so I'm finding this insanely difficult to find for something that is done a lot. I'm struggling to find a way of putting the newest YouTube videos from a user into a UITableView.

I've tried this but it's out of date and I gets heaps of errors: [http://code.google.com/p/gdata-objectivec-client/downloads/detail?name=gdata-objectivec-client-1.11.0.zip](http://code.google.com/p/gdata-objectivec-client/downloads/detail?name=gdata-objectivec-client-1.11.0.zip)

Aside from using a UIWebView, are there any good tutorials, that work, on putting YouTube videos in a UITableView?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:34:39.457

让我们举个例子.. 对于[Netfel](http://www.youtube.com/user/Nethfel?feature=watch)用户；点击他的播放列表；在链接栏中，您将看到“http://www.youtube.com/watch?v=4nx7g60Ldig&list=UUANsW00CkQnNnnUyuC1cygw”

现在..我们获取播放列表“数字”`UUANsW00CkQnNnnUyuC1cygw` 并且..我们将发出一个 JSON 请求..最多 50 个结果

[http://gdata.youtube.com/feeds/api/playlists/UUANsW00CkQnNnnUyuC1cygw?v=2&alt=jsonc&max-results=50](http://gdata.youtube.com/feeds/api/playlists/UUANsW00CkQnNnnUyuC1cygw?v=2&alt=jsonc&max-results=50)

您可以将 JSON 替换为 JSONC - 您将在结果中看到细微的变化；这将是您在应用开始时的请求

现在我们必须“解释/翻译”下一个结果：

```
{
apiVersion: "2.1",
data: {
id: "UUANsW00CkQnNnnUyuC1cygw",
author: "Nethfel",
title: "Uploaded videos",
description: "",
thumbnail: {
sqDefault: "http://i.ytimg.com/vi/4nx7g60Ldig/default.jpg",
hqDefault: "http://i.ytimg.com/vi/4nx7g60Ldig/hqdefault.jpg"
},
content: {
5: "http://www.youtube.com/p/UUANsW00CkQnNnnUyuC1cygw"
},
totalItems: 17,
startIndex: 1,
itemsPerPage: 50,
items: [
{
id: "UUGCa8nZNU7uOfDF3zV9AxkJtJSuX5gHGI",
position: 1,
author: "Nethfel",
video: {
id: "4nx7g60Ldig",
uploaded: "2011-11-02T12:32:03.000Z",
updated: "2013-01-07T18:26:41.000Z",
uploader: "nethfel",
category: "Howto",
title: "iOS Passing Data Between View Controllers Technique 1",
description: "This video discusses one of the most basic techniques for passing data between view controllers in an iOS application. This technique uses storing a local iVar in one class and passing it to the second class about to be displayed on the screen. Although this is a very simple example using an NSString, it can be applied using any other type of data as well - whether it be a collection or a custom data model object.",
thumbnail: {
sqDefault: "http://i.ytimg.com/vi/4nx7g60Ldig/default.jpg",
...... 
```

你拥有所有元素：标题、缩略图、页面链接等......你需要解析（提取）这个 JSON 响应......把它放在 TableView 中......

在单击单元格时，打开一个新的“详细信息”页面.. 是否可以拥有[适用于 iOS 的 LBYouTubeView](http://www.cocoacontrols.com/platforms/ios/controls/lbyoutubeview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:14:04.387

如果您可以在 UIView 中播放 YouTube 视频，则可以将其嵌入 UITableView 控制器单元格中。

# javascript - 我将如何按数组值对 javascript 对象进行排序

> ID：14407625
> 
> 赞同：0
> 
> 时间：2013-01-18T21:07:27.343
> 
> 标签：javascript, arrays, object

我曾经有一个数组数组并使用排序函数来获得正确的顺序，例如：

```
var sampleArr = [
  [272, 'Some Title', 1, 1],
  [281, 'Some Other Title', 1, 2],
  [287, 'Another Title', 2, 1]
];

sampleArr.sort(sortCourses);

function sortCourses(a, b){
  if (a[3] == b[3]) {
    return (a[2] - b[2]);
  } else {
    return (a[3] - b[3]);
  }
} 
```

这是想要的结果，但是我们已经更改为将 id 作为属性，将属性的值作为数组，如下所示：

```
var sampleObj = {
  272: ['Some Title', 1, 1],
  281: ['Some Other Title', 1, 2],
  287: ['Some Other Title 2', 2, 1]
}; 
```

通过查找该 ID，这使我们的生活变得更加轻松，但是我不确定如何对其进行排序。

任何人都可以阐明实现这一目标的最佳方法吗？我是否需要将其转换回具有函数的数组，然后运行相同的排序函数？如果是这样，我将如何将 sampleObj 转换回原始格式？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:21:59.893

目前，对象属性的迭代留给浏览器。并非所有浏览器都会对其可迭代属性进行排序，因此将这种行为假定为默认行为是不安全的。

另一个问题可以解释它：[“for (... in ...)”循环中的元素顺序](https://stackoverflow.com/questions/280713/elements-order-in-a-for-in-loop/280861#280861)

如果您想获得类似的东西，您将不得不依赖非标准`Object.keys()`方法，对结果数组进行排序，然后使用它访问属性。

或者，以另一种更便携的方式，您必须创建一个函数来提取数组中所有对象的属性，对该数组进行排序并对其进行迭代以提取每个对象属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:24:12.680

我只是将其转换回原始格式。这很简单：

```
var array = Object.keys(sampleObj).map(function(key) {
  return [Number(key)].concat(sampleObj[key])
}) 
```

Object.keys() 是一个 ECMAScript 5 函数，所以这段代码在 IE6-8 中不起作用，但它基本上适用于所有其他浏览器。

# android - Android，操作栏/选项卡问题

> ID：14407629
> 
> 赞同：0
> 
> 时间：2013-01-18T21:07:49.137
> 
> 标签：android, android-actionbar, android-tabhost

好的，所以我在我的主项目之外构建了我的应用程序的一部分（以防万一出现问题），它工作正常，然后我将它添加到我的主项目中。这两个应用程序都是用 4.2 编译的（我相信），但是对于我的主项目，它似乎仍然是用 4.0 之前的版本编译的，我附上了几个屏幕截图，一个是我构建的应用程序，另一个是当我将它添加到我的主项目时，

两个应用程序都针对 4.2，都具有 8 的最小 SDK，![外建项目](../Images/4cadf0f656762eb8aa965af80a0ebf55.png)

![添加到主项目后](../Images/3a86d3549f6891aa3df225b8a4441410.png)

# java - Android App无法设置主题并强制关闭

> ID：14407633
> 
> 赞同：2
> 
> 时间：2013-01-18T21:07:55.950
> 
> 标签：java, android

我正在开发一个壁纸应用程序，它可以使用带有深色操作栏的 Holo Light、Holo Light 或 Holo Dark 主题。我有一个偏好活动，应该允许所述应用程序的用户根据他/她的喜好在 3 之间进行切换。

以下是偏好活动的片段：

```
@Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    //add the prefernces.xml layout
    addPreferencesFromResource(R.xml.prefs);

    ActionBar bar = getActionBar();
    bar.setTitle(R.string.settings);
    bar.setDisplayHomeAsUpEnabled(true);
} 
```

首选项.xml：

```
 <?xml version="1.0" encoding="utf-8"?>

<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

    <ListPreference android:entries="@array/theme" 
                    android:entryValues="@array/themeValues" 
                    android:title="Themes" 
                    android:enabled="true" 
                    android:key="theme" 
                    android:summary="Select which holo theme you prefer."
                    />

</PreferenceScreen> 
```

主题.xml：

```
 <?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="theme">
        <item>Holo Light with Dark Action Bar</item>
        <item>Holo Light</item>
        <item>Holo Dark</item>
    </string-array>

   <string-array name="themeValues">
        <item>@style/Theme_Light_DarkActionBar</item>
        <item>@style/Theme_Light</item>
        <item>@style/Theme_Dark</item>
    </string-array>
</resources> 
```

我在 WallpaperActivity.java 中使用的代码来设置主题：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
    String theme = prefs.getString("theme", "defaultTheme");

    setAppTheme(theme);

    setContentView(R.layout.activity_wallpaper);

 void setAppTheme(String s) {
    String[] theme = getResources().getStringArray(R.array.themeValues);
    if (s.matches("theme_light-dark")) {
        //Light-Dark
        setTheme(R.style.Theme_Light_DarkActionBar);

    }
    else if (s.matches("theme_light")) {
        //Light
        setTheme(R.style.Theme_Light);

    }
    else if (s.matches("theme_dark")) {
        //Dark
        setTheme(R.style.Theme_Dark);

    }
    else {
        //Oops
    }
    } 
```

最后是一个 logcat 片段：

```
 [ 01-10 05:36:17.947  2621:0xa3d E/AndroidRuntime ]

FATAL EXCEPTION: main

java.lang.NullPointerException

    at android.preference.ListPreference.onDialogClosed(ListPreference.java:264)

    at android.preference.DialogPreference.onDismiss(DialogPreference.java:381)

    at android.app.Dialog$ListenersHandler.handleMessage(Dialog.java:1228)

    at android.os.Handler.dispatchMessage(Handler.java:99)

    at android.os.Looper.loop(Looper.java:137)

    at android.app.ActivityThread.main(ActivityThread.java:4424)

    at java.lang.reflect.Method.invokeNative(Native Method)

    at java.lang.reflect.Method.invoke(Method.java:511)

    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)

    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)

    at dalvik.system.NativeStart.main(Native Method) 
```

如果您还需要什么，请告诉我。谢谢！

更新：

似乎我收到一条警告，内容如下：

```
The value of the local variable theme is not used 
```

对于线路：

```
String[] theme = getResources().getStringArray(R.array.themeValues); 
```

# jquery - 如何仅对单击的节点进行切换类

> ID：14407634
> 
> 赞同：1
> 
> 时间：2013-01-18T21:07:58.967
> 
> 标签：jquery, html-table

我有一个表在一段时间循环后切换了 .parent 的行。我的 JS 在下面，如您所见，我也想要`toggleClass`该`.parent`元素，因此当我单击它时可以突出显示标题行。但是使用当前代码，所有`.parent`节点都在单击一个时切换类。我怎样才能改变这个，所以只有`.parent`我点击切换？

```
<script type="text/javascript">  
$(document).ready(function () {

   $(".child").hide();

   function getChildren($row) {
      var children = [];
      while ($row.next().hasClass('child')) {
         children.push($row.next());
         $row = $row.next();
      }
      return children;
   }

   $('.parent').on('click', function () {

      $('.parent').toggleClass('td-active');

      var children = getChildren($(this));
      $.each(children, function () {
         $(this).toggle(1000);

      })
   });

})
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:13:08.470

```
$('.parent').toggleClass('td-active'); 
```

至：

```
$(this).toggleClass('td-active'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:11:52.480

```
$('.parent').on('click', function() {

    $(this).toggleClass('td-active');

    var children = getChildren($(this));
    $.each(children, function() {
        $(this).toggle(1000);

    })
}); 
```

# android - 在活动 VideoView 上时，透明 ImageButtons 会被着色

> ID：14407638
> 
> 赞同：1
> 
> 时间：2013-01-18T21:08:08.310
> 
> 标签：android, android-imageview, imagebutton, android-videoview

将半透明 .png 文件（例如，不透明度为 80% 的白色矩形）作为 ImageButtons 放置在 ImageView 上时，按钮完全按预期显示，但是如果这些按钮显示在正在播放视频的 VideoView 上，则按钮会显示比在 ImageView 上时的颜色要深得多。

有趣的是，当我尝试截屏时，按钮正常出现在截屏中！所以......我不能包括图片。并非所有手机都会出现这种情况。它确实发生在我目前正在测试的 Nexus 4 上。

# powershell - 更新 TFSWorkspace 不起作用

> ID：14407641
> 
> 赞同：0
> 
> 时间：2013-01-18T21:08:20.773
> 
> 标签：powershell, tfs

为什么

```
Update-TfsWorkspace [[-Item] <QualifiedItemSpec[]>] [-All] [-Force] [-Overwrite] [-Recurse] [-Version <String>] 
```

不行？等效的 tf.exe 在完全相同的文件夹中工作得很好：

```
tf get itemspec [/version:versionspec] [/all] [/overwrite] [/force] [/preview] [/recursive] [/remap] [/noprompt] 
```

使用 Win 8。

以下是我正在使用的确切命令：

```
Update-TfsWorkspace -Item "$/myfilepaht" this does NOT WORK

tf get itemspec "$/myfilepaht" #this WORKS 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T14:14:19.000

I had the same problem (probably because I have multiple workspaces) So I solved it with the following code:

```
$tfsCredential = Get-Credential;
$tfsServer = Get-TfsServer -Name "https://tfs.tools4ever.com:443/tfs/t4edevnet2010" -Credential $tfsCredential;;
$tfsws = Get-TfsWorkspace -Server $tfsServer -Computer $hostname -Owner $tfsCredential.UserName;
$tfsPath = $tfsws.GetServerItemForLocalItem($filename);
$prop = Get-TfsItemProperty -Item $tfsPath -Server $tfsServer -Workspace $script:tfsws;
$tfsws.Get(@($tfsPath), [Microsoft.TeamFoundation.VersionControl.Client.VersionSpec]::Parse($prop.VersionLatest,     $script:tfsws.OwnerName)[0], [Microsoft.TeamFoundation.VersionControl.Client.RecursionType]::Full, [Microsoft.TeamFoundation.VersionControl.Client.GetOptions]::None) 
```

# objective-c - 如何读写 NSTask

> ID：14407643
> 
> 赞同：1
> 
> 时间：2013-01-18T21:08:26.000
> 
> 标签：objective-c, pipe, nstask

我有它的工作。但是，最初它似乎正在等待输入。如何在输出停止并等待输入之前读取输出的内容？

```
task starts
stdout should post data for "sftp> " but nothing happens, its waiting for input
If I write "\n" to stdin
stdout notifies me of data available which ends up being "sftp> \n" 
```

以下是它的实现方式：

```
[self.task = [[NSTask alloc] init];
[self.task setLaunchPath:executablePath];
[self.task setArguments: args];

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(terminatedNotification:) name:NSTaskDidTerminateNotification object:self.task];

//reading
self.stdoutPipe = [NSPipe pipe];
self.task.standardOutput = self.stdoutPipe;
[self.stdoutPipe.fileHandleForReading waitForDataInBackgroundAndNotify];

//error
self.stderrorPipe = [NSPipe pipe];
self.task.standardError = self.stderrorPipe;
[self.stderrorPipe.fileHandleForReading waitForDataInBackgroundAndNotify];

/*
reading works perfect until I uncomment this section
//writing
self.stdinPipe = [NSPipe pipe];
self.task.standardInput = self.stdinPipe;
*/

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(dataAvailable:) name:NSFileHandleDataAvailableNotification object:self.stdoutPipe.fileHandleForReading];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(dataAvailable:) name:NSFileHandleDataAvailableNotification object:self.stderrorPipe.fileHandleForReading]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T01:19:15.843

写入 NSFileHandle 的数据被缓冲。只有在缓冲区被刷新后，它才能在管道的另一端读取。缓冲区被刷新，如果

1.  它已满，没有更多的数据可以放入其中。
2.  向其写入换行符（“\n”）（自动刷新）。
3.  你通过调用显式刷新它`- (void)synchronizeFile`

# android - 带有 LBP 级联的 javaCV detectMultiScale 在物理设备上不起作用

> ID：14407644
> 
> 赞同：1
> 
> 时间：2013-01-18T21:08:29.557
> 
> 标签：android, opencv, face-detection, javacv

我的 Android 应用程序使用 javaCV 并使用 LBP 级联调用 detectMultiScale() 函数来检测人脸。它在我的模拟器上运行良好。然而，当我尝试在我的 HTC Incredible S 上测试它时，它返回 0，无法检测到任何人脸！谁能告诉我一些提示为什么它不起作用？非常感谢您的帮助！！！

这是我的人脸检测代码：

```
 CASCADE_FILE = working_Dir.getAbsolutePath() + "/lbpcascade_frontalface.xml";

    public static CvRect getFaceWithLBP(IplImage grayFaceImg)
    {
         CascadeClassifier cascade = new CascadeClassifier(CASCADE_FILE);
         CvRect facesdetection = new CvRect(null);

         cascade.detectMultiScale(grayFaceImg, facesdetection, 1.1, 2, CV_HAAR_FIND_BIGGEST_OBJECT | CV_HAAR_DO_ROUGH_SEARCH, 
                             new CvSize(), new CvSize(grayFaceImg.width(), grayFaceImg.height()));  

         return facesdetection;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T03:10:02.663

请注意，根据[OpenCV 文档](http://docs.opencv.org/modules/objdetect/doc/cascade_classification.html?highlight=detectmultiscale#void%20CascadeClassifier%3a%3adetectMultiScale%28const%20Mat&%20image,%20vector%3CRect%3E&%20objects,%20double%20scaleFactor,%20int%20minNeighbors,%20int%20flags,%20Size%20minSize,%20Size%20maxSize%29)，标志（例如 CV_HAAR_FIND_BIGGEST_OBJECT | CV_HAAR_DO_ROUGH_SEARCH）不能与新的级联（如 LBP 级联）一起使用。

> void CascadeClassifier::detectMultiScale(const Mat& image, vector& objects, double scaleFactor=1.1, int minNeighbors=3, int flags=0, Size minSize=Size(), Size maxSize=Size()) 参数：
> 
> *   **cascade** – Haar 分类器级联（仅限 OpenCV 1.x API）。它可以使用 Load() 从 XML 或 YAML 文件中加载。当不再需要级联时，使用 cvReleaseHaarClassifierCascade(&cascade) 释放它。
> *   **image** – CV_8U 类型的矩阵，包含检测到对象的图像。
> *   **objects** - 矩形向量，其中每个矩形都包含检测到的对象。
> *   **scaleFactor** – 指定每个图像比例缩小图像大小的参数。
> *   **minNeighbors** – 指定每个候选矩形应该保留多少个邻居的参数。
> *   **flags** – 与函数 cvHaarDetectObjects 中的旧级联具有相同含义的参数。***它不用于新的级联。***
> *   **minSize** – 最小可能的对象大小。小于该值的对象将被忽略。
> *   **maxSize** – 最大可能的对象大小。大于该值的对象将被忽略。

# ios - 如何检测哪个 UITableViewCell 位于 UITableView 的顶部

> ID：14407649
> 
> 赞同：0
> 
> 时间：2013-01-18T21:08:47.063
> 
> 标签：ios

我有一个同时显示地图和列表的视图。我希望地图在用户滚动列表时移动。

我希望有类似的东西

```
(UITableView*)tableView didScrollTableViewCellToTop:(UITableViewCell *)cell 
```

我还没有找到支持这一点的东西。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:15:04.207

您可以通过运行来获取所有可见单元...

```
NSArray *cells = [self.tableView visibleCells]; 
```

这将返回一个 UITableViewCells 数组。

然后，您可以找到 indexPath.row 值最低的那个来找到最上面的那个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:13:28.210

请记住，UITableView 只是一个滚动视图。因此，您可以获得滚动视图的偏移量并使用位置来获取该位置的单元格：

```
NSIndexPath *indexPath = [self.tableView indexPathForRowAtPoint: point]; 
```

要持续监控和更改，请实现 scroll-view-delegate 并实现 scrollViewDidScroll 方法。

# android - TabHost 视觉风格（2.x 和 4.x）

> ID：14407651
> 
> 赞同：0
> 
> 时间：2013-01-18T21:08:47.717
> 
> 标签：android

我正在尝试模仿 TabHost 小部件的视觉风格。问题是 2.x 和 4.x 平台上的风格完全不同。在 2.x 上它是带有图标的灰色，而在 4.x 上它有漂亮的背景（蓝色条带）并且没有图标。

我发现样式 Widget.TabWidget 声明为：

```
<style name="Widget.TabWidget">
    <item name="android:textAppearance">@style/TextAppearance.Widget.TabWidget</item>
    <item name="ellipsize">marquee</item>
    <item name="singleLine">true</item>
    <item name="android:tabStripLeft">@android:drawable/tab_bottom_left</item>
    <item name="android:tabStripRight">@android:drawable/tab_bottom_right</item>
    <item name="android:tabStripEnabled">true</item>
    <item name="android:divider">@null</item>
    <item name="android:gravity">fill_horizontal|center_vertical</item>
    <item name="android:tabLayout">@android:layout/tab_indicator</item>
</style> 
```

所以样式的一些值是我正在寻找的，即 tabLayout、divider 等。是否可以引用该样式并获取 TabHost 背景/布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:45:35.820

查看[这个库](https://github.com/Prototik/HoloEverywhere)，它模仿了蜂窝（及以上）样式中使用的样式，称为“holo”样式。

我在那里没有看到 tabhost 示例，但它可能仍然存在，因为它具有各种视图。

# c# - String[0] vs ToCharArray 然后 Char[0]

> ID：14407652
> 
> 赞同：2
> 
> 时间：2013-01-18T21:08:56.017
> 
> 标签：c#, .net, char

假设我想获取字符串中的第三个字母。

```
string s = "cats"; 
```

正如我在网上看到的大多数示例一样，使用 s[2] 获取值有什么区别：

```
char[] c = s.ToCharArray();
char x = c[2]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T21:11:35.687

*   如果您需要特定索引处的字符，请使用`"cats"[2]`
*   如果您需要将整个字符串作为 char 数组，请使用`"cats".ToCharArray()`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T21:13:07.003

该`s[2]`方法只是在该位置查找字符并返回它。

该`s.ToCharArray();`方法分配一个新的`char[]`，然后`c[2]`在数组中查找它。

如果您只需要一个字符，请使用该`s[2]`方法，因为该`ToCharArray()`方法很浪费。如果您需要将字符串中的所有字符作为 a ，`char[]`那么该`ToCharArray()`方法更简洁，*可能*更快（我没有做过任何基准测试，所以不要让我这样做）。

**编辑**：

MS.NET 和 Mono 的实现都`string.ToCharArray()`使用不安全的代码来固定内部`char`和副本`char[]`并在指针上进行操作。这绝对比为每个字符调用索引器要快，并且可能比使用枚举器遍历所有字符要快。另外，我发现它更干净，尤其是在它用作参数的情况下：

```
DoSomethingWithCharArray(s.ToCharArray()); 
```

对比

```
int i = 0;
char[] arr = new char[s.Length];
foreach (char c in s)
{
    arr[i] = c;
    i++;
}

DoSomethingWithCharArray(arr); 
```

或者

```
char[] arr = new char[s.Length];
for (int i = 0; i < s.Length; i++)
{
    arr[i] = s[i];
}

DoSeomthingWithCharArray(arr); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-18T21:12:28.640

不同之处在于您不必要地创建了一个字符数组。使用 s[2]。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:16:17.417

如果您只是阅读字符，则差异只是内存占用稍大。但是，如果您还想更改某些字符并保留原始字符串，那么使用`ToCharArray`非常有用。

# asp.net-mvc - 测试控制器无参数构造函数

> ID：14407653
> 
> 赞同：1
> 
> 时间：2013-01-18T21:08:59.073
> 
> 标签：asp.net-mvc, unit-testing

我的应用程序中有一个相当基本的 HomeController，我为它编写了一个测试类。在我的测试类上运行代码覆盖率分析后，我意识到我没有对默认构造函数进行任何测试。

这是我的家庭控制器

```
public class HomeController : BaseController
{
    private INewsRepository _newsRepository;
    private INewsletterRepository _newsletterRepository;
    private string _currentLanguage;

    public HomeController()
    {
        _newsRepository = NewsRepository.Current;
        _newsletterRepository = NewsletterRepository.Current;
        _currentLanguage = ApplicationConfig.Current.CurrentLanguage;
    }

    public HomeController(INewsRepository newsRepository, INewsletterRepository newsletterRepository, string currentLanguage)
    {
        _newsRepository = newsRepository;
        _newsletterRepository = newsletterRepository;
        _currentLanguage = currentLanguage;
    }

    public ActionResult Index()
    {
        return View();
    }

    public ActionResult LatestNews()
    {
        return View(_newsRepository.ListAll().Where(n => n.LanguageKey.ToLower() == _currentLanguage.ToLower()).OrderByDescending(n => n.Date).Take(10));
    }

    public ActionResult LatestNewsletters()
    {
        return View(_newsletterRepository.ListAll().Where(n => n.LanguageKey.ToLower() == _currentLanguage.ToLower()).OrderByDescending(n => n.Date).Take(10));
    }
} 
```

这是我的测试课：

```
[TestClass]
public class HomeControllerTest
{
    private INewsletterRepository _mockNewsletterRepostiory = null;
    private INewsRepository _mockNewsRepostiory = null;
    private List<News> _fakeNewsList = new List<News> { 
            new News{Id = 0, Title = "some title", Date = new DateTime(1989, 2, 19), LanguageKey = "fa", Description = "some description"}, 
            new News{Id = 1, Title = "some title", Date = new DateTime(1989, 2, 20), LanguageKey = "fa", Description = "some description"}, 
            new News{Id = 2, Title = "some title", Date = new DateTime(1989, 2, 21), LanguageKey = "fa", Description = "some description"}, 
            new News{Id = 3, Title = "some title", Date = new DateTime(1989, 2, 22), LanguageKey = "fa", Description = "some description"}
        };
    private List<Newsletter> _fakeNewsletterList = new List<Newsletter>
        {
            new Newsletter{ Id = 0, Description = "some description", UrlKey = "first-newsletter", Title = "some title", SendDate = null, NewsletterContents = null, LanguageKey = "fa", Date = new DateTime(1989, 2, 19) },
            new Newsletter{ Id = 1, Description = "some description", UrlKey = "first-newsletter", Title = "some title", SendDate = null, NewsletterContents = null, LanguageKey = "fa", Date = new DateTime(1989, 2, 20) },
            new Newsletter{ Id = 2, Description = "some description", UrlKey = "first-newsletter", Title = "some title", SendDate = null, NewsletterContents = null, LanguageKey = "fa", Date = new DateTime(1989, 2, 21) },
            new Newsletter{ Id = 3, Description = "some description", UrlKey = "first-newsletter", Title = "some title", SendDate = null, NewsletterContents = null, LanguageKey = "fa", Date = new DateTime(1989, 2, 22) }
        };

    [TestInitialize]
    public void Setup()
    {
        // Mock News Repository            
        var mockNewsRepository = MockRepository.GenerateStub<INewsRepository>();
        mockNewsRepository.Stub(m => m.ListAll()).Return(_fakeNewsList.AsQueryable());

        // Mock Newsletter Repository
        var mockNewsletterRopository = MockRepository.GenerateStub<INewsletterRepository>();
        mockNewsletterRopository.Stub(m => m.ListAll()).Return(_fakeNewsletterList.AsQueryable());

        _mockNewsletterRepostiory = mockNewsletterRopository;
        _mockNewsRepostiory = mockNewsRepository;
    }

    [TestMethod]
    public void IndexReturnsView()
    {
        // Arrange
        HomeController homeController = new HomeController(_mockNewsRepostiory, _mockNewsletterRepostiory, "fa");
        // Act
        ViewResult result = homeController.Index() as ViewResult;
        // Assert
        Assert.AreEqual("", result.ViewName);
    }

    [TestMethod]
    public void LatestNewsReturnsCorrectObject()
    {
        // Arrange
        HomeController homeController = new HomeController(_mockNewsRepostiory, _mockNewsletterRepostiory, "fa");
        // Act
        ViewResult result = homeController.LatestNews() as ViewResult;
        // Assert            
        Assert.IsNotNull(result.ViewData.Model, "Result model is not null.");
        Assert.IsTrue(_fakeNewsList.OrderByDescending(n => n.Date).SequenceEqual(result.ViewData.Model as IQueryable<News>), "Model is correct");
    }

    [TestMethod]
    public void LatestNewslettersReturnsCorrectObject()
    {
        // Arrange
        HomeController homeController = new HomeController(_mockNewsRepostiory, _mockNewsletterRepostiory, "fa");
        // Act
        ViewResult result = homeController.LatestNewsletters() as ViewResult;
        // Assert            
        Assert.IsNotNull(result.ViewData.Model, "Result model is not null.");
        Assert.IsTrue(_fakeNewsletterList.OrderByDescending(n => n.Date).SequenceEqual(result.ViewData.Model as IQueryable<Newsletter>), "Model is correct");
    }
} 
```

首先，我真的需要测试这个构造函数吗？其次，将 _newsRepository 和其他人公开和只读然后在构造控制器后编写一个测试方法来检查他们的类型是一个好习惯吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:31:21.357

The only reason I'd recommend writing a test for the constructor is if you care a lot about getting as much code coverage as possible. Testing the fact that you can create an instance of the controller, and whether instances of each object created in the ctor are valid isn't a very valuable test. I'd say it's a waste of time.

So, for your first question I suggest you don't worry about unit testing the ctor. If there is a problem in the ctor then you will notice it very quickly via other unit tests, as explained in my next comment.

As for making the repository classes public and readonly, I don't recommend doing that. What you really need to focus on, regards unit tests, is functionality of the controller, especially methods that make use of the objects which are created in the ctor. That's where you need to concentrate on. Those tests will tell you whether or not these was an issue in the ctor for those objects.

# matlab - 有没有办法生成一个矩阵，其中每个元素都定义为 10+row_index + column_index 而没有 for 循环？

> ID：14407654
> 
> 赞同：3
> 
> 时间：2013-01-18T21:09:00.363
> 
> 标签：matlab, matrix

我正在尝试生成一个矩阵，其中每个元素都定义为 10 * row_index + column_index。行和列可以波动到一个 9x9 矩阵。例如：

```
11    12    13    14    15    16
21    22    23    24    25    26
31    32    33    34    35    36
41    42    43    44    45    46
51    52    53    54    55    56 
```

该算法使用循环非常简单`for`，但有人警告我，`for`除非绝对必要，否则在处理矩阵时应避免使用循环，因为它们比向量/矩阵运算慢。

在 Matlab 2012b 中还有哪些其他方法可以生成这样的矩阵？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:21:36.663

对于您的特定矩阵，它非常简单：

```
nRows = 4;
nCols = 5;

out = bsxfun(@plus,10*(1:nRows)',1:nCols)

out =

11    12    13    14    15
21    22    23    24    25
31    32    33    34    35
41    42    43    44    45 
```

# cordova - 将简化的 Web 内容加载到 PhoneGap 应用程序中

> ID：14407661
> 
> 赞同：2
> 
> 时间：2013-01-18T21:09:50.820
> 
> 标签：cordova, jquery-mobile, mobile

我是一个完整的新手，正在使用 PhoneGap 构建一个 HTML5 应用程序，它将以类似翻板的方式呈现通过自定义构建的 CMS 上传的文章。该应用程序将呈现一个漂亮的图像密集型界面。当用户点击图片时，文章内容被加载。

我可能会使用 Yii 框架构建 Web 后端，因为这是我的经验所在。许多可以上传文章的版主都可以访问 CMS。每篇文章都只有一个图像和文字。一般用户将无法通过网络访问文章，而只能通过应用程序访问。

我想我需要使用 HTTP 获取请求？假设在“www.mydomain.com/article?id=7”可以访问关于 cms 的文章。如果我点击了这个，我将取回网站使用的所有不必要的布局和额外的视图。

构建仅返回图像和内容的流线型视图的最佳方法是什么？所以 url: "www.mydomain.com/mobile/article?id=7&type=image" 将只返回第 7 条的图像和

"www.mydomain.com/mobile/article?id=7&type=text" 将返回文本。

然后，我使用 Jquery 创建漂亮的应用程序首页，例如抓取 3 张图像，然后点击“文本”链接以加载内容。

这是正确的过程吗？还是有更好的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:12:44.330

这是一个正确的过程。它可以通过其他几种方式完成，但你应该坚持你所知道的。

但是您还应该考虑其他一些事情。

首先，您选择了**Phonegap**标签，因此我假设您正在创建一个移动网络应用程序而不是移动网页。问题来了。**使用Phonegap**创建**jQuery Mobile**移动应用程序有两种方法，它可以完全在服务器端生成并仅显示，或者您可以仅发送基本内容并在客户端生成页面。

 **第一个选项总是更好，服务器端将处理内容生成，客户端只会显示它。但是这里我们遇到了第一个问题。如果您正在创建**iOS**应用程序（**Android**不会受到影响），该应用程序将被拒绝，因为您是在服务器端生成内容。在这种情况下，Apple 的政策是拒绝应用程序，因为这只是显示在混合应用程序中的移动网络。

现在我们有第二个问题。假设您的服务器端将仅充当 Web 服务，仅为您提供基本内容（通过**JSON**或**XML**）。您的客户端将需要生成页面内容。这不是桌面浏览器上的那个床，而是在手机浏览器上，它可能会导致性能问题。**jQuery Mobile**被称为资源匮乏的框架，现在将它与额外的内容生成结合起来，您就有了性能灾难的公式。

基本上，您应该构建您的 Web 应用程序，使其尽可能轻巧。例如，看看 Pulse 移动应用程序。它不是资源繁重，但仍然看起来不错且专业。所以关于 GUI 布局的第一件事以及你将如何生成内容。**

# javascript - 获得具有规定属性的最亲近的父母？

> ID：14407665
> 
> 赞同：0
> 
> 时间：2013-01-18T21:10:06.907
> 
> 标签：javascript, jquery, .net, asp.net-mvc

我有以下代码：

```
<input pid="hidVoteKey" type="hidden" value="0" />
    <ul id="mainPostList" class="verticalList">
        @foreach (var postViewModel in Model.Posts)
        {
            <li><div class="voteCon">...</div></li>
        }
    </ul> 
```

然后我有一个 jquery，它使用类 voteCon 循环所有元素，然后尝试像这样获取父输入：

```
$(".voteCon").each(function () {
     InitVoteControl($(this), $(this).parent("input[pid='hidVoteKey']").val());
 }); 
```

问题是它不会找到隐藏域？

在这种情况下，voteCon 包含向上/向下按钮，并且这里绑定了一些 JavaScript 函数来进行 ajax 调用。在同一页面上将有多个列表，如上面的列表，但它们都有不同的 hidVoteKey。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:13:34.153

它不会找到 ，因为`<input>`它**不是**`<div class="voteCon">`. 它与 （的兄弟）处于同一级别`<ul>`，后者是 的祖先`<div>`。你可以这样做：

```
$(this).closest('ul').prev('input[pid="hidVoteKey"]').val() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:13:59.063

只需使用 then 不要键入 hidden ，您可以使用 inline style="display:none;"

# wcf - 如何以正确的方式实施客户端证书身份验证？

> ID：14407666
> 
> 赞同：4
> 
> 时间：2013-01-18T21:10:07.283
> 
> 标签：wcf, authentication, iis, client-certificates

WCF 具有极强的可扩展性，并且具有许多现成的功能，但是我继续在一些主题上苦苦挣扎，并且阅读的文档越多，我就越感到困惑。

我希望从社区中得到一些答案。非常欢迎对任何假设或问题提供反馈。

为了记录：要真正接受一个答案，我应该将这篇文章分成多个问题，但这会导致更多的混乱。我很确定在线上有一些真正的 WCF 专家可以一次性回答本文档中的几个问题，因此我可以接受一个答案作为使用 IIS 正确设置客户端证书身份验证的真正交易。

让我概述一下情况和合作伙伴的要求：

1：合作伙伴要求和使用客户证书的问题。

合作伙伴 X 需要在我的后端调用 API，并且他们明确要求使用 Clientcertificate 身份验证。他们创建了 clientcertificate 并向我们提供了仅带有公钥的证书，因为他们将私钥实际上保持在他们自己的系统中似乎是唯一的逻辑。证书是在本地计算机帐户上导入的，并查看有效的证书路径。所有中间证书颁发机构和最终的根证书颁发机构都是受信任的。

2：我们的WCF**服务器端**配置

我有一个 serviceBehavior 配置如下：

```
<behavior name="ClientCertificateBehavior">
    <serviceMetadata httpsGetEnabled="true" />
        <serviceCredentials>
        <serviceCertificate findValue="<serialnumber here>" x509FindType="FindBySerialNumber" />
        <clientCertificate>
          <authentication certificateValidationMode="PeerTrust" />
        </clientCertificate>
    </serviceCredentials>
</behavior> 
```

*我想我在这里犯了第一个错误，应该使用 ChainTrust 使用其证书路径实际验证证书*。你怎么看？

服务配置如下：

```
<service behaviorConfiguration="ClientCertificateBehavior" name="<Full service namespace and servicename>">
    <endpoint binding="basicHttpBinding" bindingConfiguration="Soap11CertificateBasicHttpBinding"
        contract="<The interface>"></endpoint>
</service> 
```

绑定看起来像这样：

它是一个basicHttpBinding强制SOAP1.1（根据合作伙伴的规范）。

```
<binding name="Soap11CertificateBasicHttpBinding">
  <security mode="Transport">
    <transport clientCredentialType="Certificate" />
  </security>
</binding> 
```

3：在IIS中托管WCF服务和IIS配置

我们在 IIS7 中托管我们的 WCF 服务。我们将服务所在的文件夹配置为需要 SSL 并接受客户端证书。启用身份验证匿名身份验证。

* * *

问题是来自合作伙伴的通信有效，我们确信一切正常，但是将 IIS 设置切换为“需要”客户端证书向我们表明，突然之间不再可能成功调用我们的服务。

我是否正确假设以下事情没有正确完成：

*   serviceBehavior 中的 serviceCerticate 并不是必需的。这是客户端使用的设置。或者是否有必要为服务端点提供此证书信息以匹配客户端发送的证书？

*   要使 clientcertificate 身份验证在 IIS 中真正起作用，需要将证书映射到用户。应授予此用户对包含服务的文件夹的权限，并且应禁用所有身份验证机制（匿名、Windows 等）。这样 IIS 将处理实际的握手并验证服务通信。还是更多地将证书映射到用户的额外安全问题？

    *   通过在 IIS 上设置“接受”，我们绕过了客户端和服务器之间的实际证书验证。

    *   必须在 IIS 上为保存服务的文件夹禁用所有身份验证机制，如“匿名”和“窗口”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:33:06.930

在您的方案中，您不需要在 WCF 中配置证书，IIS 会为您处理这些。您可以清除整个`<serviceCredentials>`块，因为：

[`<serviceCertificate>`of`<serviceCredentials>`](http://msdn.microsoft.com/en-us/library/ms731340.aspx)指定一个 X.509 证书，该证书将用于使用您不使用的**Message security mode向客户端验证服务，并且**[`<clientCertificate>`of`<serviceCredentials>`](http://msdn.microsoft.com/en-us/library/ms731367.aspx)定义一个 X.509 证书，用于对来自服务的客户端的消息进行签名和加密在**双工通信**模式中。

请参阅[此处](http://www.iis.net/configreference/system.webserver/security/authentication/iisclientcertificatemappingauthentication)如何将客户端证书映射到用户帐户。

# android - Android：通过更改片段更改菜单项的可见性

> ID：14407667
> 
> 赞同：9
> 
> 时间：2013-01-18T21:10:15.390
> 
> 标签：android, menu, actionbarsherlock, fragment, menuitem

当我更改活动中的片段时，我想更改片段活动（abs）的菜单项的可见性。这些片段是 SherlockListFragments。

我要显示/隐藏的菜单项是我在创建菜单时创建的微调器：

```
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    MenuInflater inflater = getSupportMenuInflater();

    IcsSpinner herbSortSpinner = new IcsSpinner(this, null, R.attr.actionDropDownStyle);
    SpinnerAdapter herbSortSpinnerAdapter = ArrayAdapter.createFromResource(this, R.array.herb_sort_elements, android.R.layout.simple_spinner_dropdown_item);
    herbSortSpinner.setAdapter(herbSortSpinnerAdapter);
    herbSortSpinner.setOnItemSelectedListener(this);
    herbSortSpinner.setId(HERB_SPINNER_ID);
    menu.add(R.string.menu_sort).setActionView(herbSortSpinner).setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    IcsSpinner noteSortSpinner = new IcsSpinner(this,  null, R.attr.actionDropDownStyle);
    SpinnerAdapter noteSortSpinnerAdapter = ArrayAdapter.createFromResource(this, R.array.note_sort_elements, android.R.layout.simple_spinner_dropdown_item);
    noteSortSpinner.setAdapter(noteSortSpinnerAdapter);
    noteSortSpinner.setOnItemSelectedListener(this);
    noteSortSpinner.setId(NOTE_SPINNER_ID);
    menu.add(R.string.menu_sort).setActionView(noteSortSpinner).setVisible(false).setEnabled(false).setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    inflater.inflate(R.menu.activity_lexicon, menu);
    menuHolder.setMenu(menu);
    return true;
} 
```

我切换片段的逻辑是：

```
public boolean onNavigationItemSelected(int position, long itemId) {

    FragmentManager fragmentManager = getSupportFragmentManager();
    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
    switch(position) {
    case 0:
        List<Herb> herbList = findHerbsByIntent(getHerbLocale());
        HerbListFragment herbListFragment = new HerbListFragment();
        herbListFragment.setListAdapter(new HerbListAdapter(this, getHerbLocale(), herbList));
        fragmentTransaction.replace(R.id.fragment_container, herbListFragment, HERB_LIST_FRAGMENT_TAG);
        //menuHolder.showHerbsSpinner();
        break;
    case 1:
        SymptomListFragment symptomListFragment = new SymptomListFragment();
        symptomListFragment.setListAdapter(new SymptomListAdapter(this, getDefaultSymptomLocale()));
        fragmentTransaction.replace(R.id.fragment_container, symptomListFragment, SYMPTOM_LIST_FRAGMENT_TAG);
        //menuHolder.showHerbsSpinner();
        break;
    case 2:
        NoteRepository noteRepository = new NoteRepository(this);
        List<Note> notes = noteRepository.getNoticables(ReferedType.HERB);
        NoteListFragment noteListFragment = new NoteListFragment();
        noteListFragment.setListAdapter(new NoteListAdapter(this, getHerbLocale(), notes));
        fragmentTransaction.replace(R.id.fragment_container, noteListFragment, NOTE_LIST_FRAGMENT_TAG);
        //menuHolder.showNotesSpinner();
        break;
    case 3:
        FavoriteRepository favoriteRepository = new FavoriteRepository(this);
        Set<Integer> favoriteHerbs = favoriteRepository.getFavorables(ReferedType.HERB);
        List<Herb> favoriteHerbList = herbRepository.getHerbsByIds(favoriteHerbs, getHerbLocale());
        FavoriteHerbListFragment favoriteHerbListFragment = new FavoriteHerbListFragment();
        favoriteHerbListFragment.setListAdapter(new HerbListAdapter(this, getHerbLocale(), favoriteHerbList));
        fragmentTransaction.replace(R.id.fragment_container, favoriteHerbListFragment, HERB_LIST_FRAGMENT_TAG);
        //menuHolder.showHerbsSpinner();
        break;
    }
    fragmentTransaction.commit();

    return true;
} 
```

我的第一个想法是将菜单对象保存在一个持有者类中，并在我切换片段时在那里操作它（在上面的每个案例语句中）。

```
static class MenuHolder {

    private Menu mMenu;

    void setMenu(Menu menu) {
        mMenu = menu;
    }

    void showNotesSpinner() {
        if (mMenu != null) {
            mMenu.findItem(HERB_SPINNER_ID).setVisible(false).setEnabled(false);
            mMenu.findItem(NOTE_SPINNER_ID).setVisible(true).setEnabled(true);
        }
    }

    void showHerbsSpinner() {
        if (mMenu != null) {
            mMenu.findItem(NOTE_SPINNER_ID).setVisible(false).setEnabled(false);            
            mMenu.findItem(HERB_SPINNER_ID).setVisible(true).setEnabled(true);
        }
    }
} 
```

我的问题是没有给定 ID 的菜单项是活动本地常量。我在这里得到一个NPE。有人知道我该如何解决吗？有没有更好的方法来更改切换片段的菜单？

最好的问候卡斯滕

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-03-21T08:14:45.320

> Is there a better way to change the menu on switching fragments?

May be yes :).

*   In your fragment `onCreate`, add this :

    [setHasOptionsMenu (true);](http://developer.android.com/reference/android/app/Fragment.html#setHasOptionsMenu%28boolean%29)

The doc :

> Report that this fragment would like to participate in populating the options menu by receiving a call to onCreateOptionsMenu(Menu, MenuInflater) and related methods.

*   Override [onPrepareOptionMenu](http://developer.android.com/reference/android/app/Activity.html#onPrepareOptionsMenu%28android.view.Menu%29) method in your fragment class.

> Prepare the Screen's standard options menu to be displayed. This is called right before the menu is shown, every time it is shown. You can use this method to efficiently enable/disable items or otherwise dynamically modify the contents.

Then, in this method, try to find your menu items by ID, and make them visible/unvisible, enabled/disabled, like this :

```
@Override
public void onPrepareOptionsMenu(Menu menu) {    
    menu.findItem(HERB_SPINNER_ID).setVisible(false).setEnabled(false);
} 
```

[Read More](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-07T05:44:26.533

就我而言，我有 2 个片段具有不同的菜单项。

在我的 MainActivity 上：

```
FragmentA fragmentA = new FragmentA();
fragmentA.setTargetFragment(fragmentA, 0);
FragmentB fragmentB = new FragmentB();
fragmentB.setTargetFragment(fragmentB, 1); 
```

并且 FragmentA 和 FragmentB 具有：

```
@Override
public void onHiddenChanged(boolean hidden) {
    super.onHiddenChanged(hidden);
    if(hidden) {
        getTargetFragment().setMenuVisibility(false);
    }else{
        getTargetFragment().setMenuVisibility(true);
    }
} 
```

这将使片段 A 的菜单在 B 离开时可见。如果它从 B 回到 A，则可以看到 A 的旧菜单。

参考：[这里](https://techbandhu.wordpress.com/2013/12/04/android-fragments-and-menus-remove-when-not-needed/)

# c++ - 返回对临时 c++ 的引用

> ID：14407669
> 
> 赞同：0
> 
> 时间：2013-01-18T21:10:19.790
> 
> 标签：c++, reference

```
SongPart mtm::SongStructure::getPart(int index) const {
    assert(index >= 0 && index < num_of_parts);
    return song_parts[index];
}

const SongPart& mtm::Song::operator[](int index) const {
    assert(index >= 0 && index < song_length);
    return (song_format->getPart(index));
} 
```

我从第二个函数的返回值中得到这个警告：

> 返回对临时的引用 [默认启用]

如何解决这个问题？而且我不能改变每个函数的返回值！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:19:21.833

*您会收到*警告，因为`getPart`返回. 如果它返回对 的*引用*，那么您的代码将是正确的。*`song_parts[index]`*`song_parts[index]`**

 **因此，您需要将返回类型更改`getPart`为`SongPart const&`：

```
SongPart const & mtm::SongStructure::getPart(int index) const {
    assert(index >= 0 && index < num_of_parts);
    return song_parts[index];
} 
```

是必要的`const`，因为该函数是`const`成员函数。

当您将断言转接到哪个呼叫时，为什么还要使用`assert`in呢？写这个：`operator[]``getPart`

```
const SongPart& mtm::Song::operator[](int index) const {
    //assert(index >= 0 && index < song_length); not needed!
    return (song_format->getPart(index));
} 
```

在不需要时避免额外的边界检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:18:18.790

将第一个函数更改为：

```
const SongPart& mtm::SongStructure::getPart(int index) const {
    assert(index >= 0 && index < num_of_parts);
    return song_parts[index];
} 
```

原因是`song_format->getPart(index)`按值返回的调用，因此在第二个函数的堆栈上创建了一个本地。如果您返回对它的引用，则在第二个函数返回后，Boom....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:25:09.257

如果您无法更改 的返回类型`getPart()`，那么您将无法有效地调用它。让我们考虑如何在不调用`getPart()`.

解决方案1：调用*其他*函数：

```
const SongPart& mtm::SongStructure::getPartReference(int index) const {
    assert(index >= 0 && index < num_of_parts);
    return song_parts[index];
}

const SongPart& mtm::Song::operator[](int index) const {
    assert(index >= 0 && index < song_length);
    return (song_format->getPartReference(index));
} 
```

解决方案#2：`song_parts[index]`直接从`operator[]`：

```
const SongPart& mtm::Song::operator[](int index) const {
    assert(index >= 0 && index < song_length);
    return (song_format->song_parts[index]);
} 
```**

# html - last-child 无法正常使用文章

> ID：14407679
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:04.977
> 
> 标签：html, css

为什么文章的行为与涉及最后一个孩子的 div 不同

**HTML**

```
<div class="parent">
<div class="example">111</div>
<div class="example">111</div>
<div class="example">111</div>
<div class="example">111</div>
</div>

<br>

<div class="parent2">
<article class="example">111</div>
<article class="example">111</div>
<article class="example">111</div>
<article class="example">111</div>
</div> 
```

**CSS**

```
.parent .example{ background-color: red;}
.parent .example:last-child{background-color: yellow;}

.parent2 .example{ background-color: red;}
.parent2 .example:last-child{background-color: yellow;} 
```

**演示**：http: [//jsfiddle.net/chLLa/1/](http://jsfiddle.net/chLLa/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:14:43.053

您没有正确关闭标签

```
<div class="parent">
<div class="example">111</div>
<div class="example">111</div>
<div class="example">111</div>
<div class="example">111</div>
</div>

<br>

<div class="parent2">
<article class="example">111</article>
<article class="example">111</article>
<article class="example">111</article>
<article class="example">111</article>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:14:32.820

你正在关闭你的第二组`<article>`'s `<div>`。从本质上讲，您太早地关闭了 .parent2 div，以至于正确的最后一个孩子无法工作。

另请注意，JSFiddle.net 有一个很好的“整理”功能可以说明这一点。

# xcode - Xcode触发navigationBar-Back-Button-Action

> ID：14407680
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:09.943
> 
> 标签：xcode, uinavigationcontroller, uinavigationbar

我有一个带有一些视图控制器的导航控制器，我需要知道如何触发每个视图控制器的导航栏上的后退按钮操作。

我有一个警报视图，当用户在此警报视图上按下确定时，我希望导航控制器后退一步，因此我需要触发左侧每个导航栏上显示的后退按钮。

有人知道这是如何工作的:)

因为如果它不起作用，我必须在每个视图控制器下实现一个导航控制器来制作

```
[self dismissViewController animated:YES completion:nil] 
```

我不想那样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:13:40.813

您必须从堆栈中弹出最前面的视图控制器。

```
[self.navigationController popViewControllerAnimated:YES]; 
```

你也可以使用

```
[self.navigationController popToViewController:someViewController animated:YES]; 
```

如果你想直接回到 someViewController。

# mysql - mysql查询2个不同列的表？

> ID：14407681
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:14.610
> 
> 标签：mysql

我正在尝试在 1 中进行 2 个查询，基本上使用 2 个具有不同列的不同表。我试过这个：

```
SELECT * FROM $TIMES_TABLE WHERE uid='$contextUser' AND submitstatus=1 UNION SELECT first_name, last_name, employid, manager FROM $USER_TABLE WHERE username='$contextUser' 
```

但我收到此错误：

```
Can't perform query: The used SELECT statements have a different number of columns 
```

我不明白。有人可以帮忙吗

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:14:41.570

UNION（UNION 和 UNION ALL）要求所有被 UNION 的查询具有：

1.  SELECT 子句中的列数相同
2.  列数据类型必须在每个位置匹配

在询问之前在stackoverflow中搜索。

参考：[使用的 SELECT 语句具有不同的列数（REDUX ！！）](https://stackoverflow.com/questions/3655708/the-used-select-statements-have-a-different-number-of-columns-redux)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:13:24.820

查询结果中的所有行必须具有相同的列。由于这两个查询没有相同的列，因此它们不能`UNION`像这样组合使用。

您需要将其作为两个单独的查询来执行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:41:50.040

查询返回一个结果集，该结果集由结果集中的列数和每列的数据类型“定义”。

UNION 或 UNION ALL 操作旨在将两个结果集“附加”在一起；为了做到这一点，两个查询的结果集在返回的列数方面必须相同，并且每列的数据类型也必须相同。

有时，当结果集稍微偏离一点时，我们可以稍微捏造查询，以使结果集匹配（添加一些文字作为列占位符）

```
SELECT 'u'                 AS source
     , u.first_name        AS first_name
     , u.last_name         AS last_name 
     , u.employid          AS employid
     , u.manager           AS manager 
  FROM $USER_TABLE u
 WHERE u.username='$contextUser'
 UNION ALL
SELECT 't'                 AS source
     , t.some_string       AS first_name
     , t.some_otherstring  AS last_name 
     , 0                   AS employid
     , 0                   AS manager
  FROM $TIMES_TABLE t 
 WHERE t.uid='$contextUser'
   AND t.submitstatus=1 
```

请注意，列的名称（或分配给列或表达式的别名）并不重要；这里重要的是两个查询都返回五列，并且每列位置的数据类型匹配：VARCHAR、VARCHAR、VARCHAR、INT、INT

* * *

在开发 SQL 语句时，定义要返回的结果集很重要。有多少列，以及每列的数据类型。

在开发使用“UNION”或“UNION ALL”操作的查询时，每个查询的结果集必须匹配。

# android - 创建 16:9 视图

> ID：14407686
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:33.830
> 
> 标签：android, android-layout

我正在编写一个程序，我想一直拥有一个 16:9 的屏幕。我设置了一个基本的线性布局来托管我编写的 2 个对象。第一个对象覆盖了 onMeasure 方法，因此它会从屏幕上占据一个“正方形”空间，而第二个对象占据其余部分。这在我拥有的 16:9 设备上看起来不错。但是当我在其他设备上尝试时，它看起来很糟糕。我试图从承载我的对象的线性布局扩展，并覆盖布局的 onMeasure 方法。自定义 Linearlayout 似乎可以做到 16:9，但我的第一个对象（正方形）仍然是大正方形，而不是限制在 16:9 条带上的小正方形。这是相关代码

MainActivity: @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState);

```
 layout = new MyLinear(this);

    mField = new Field(this);
    mField.setId(1);

    control = new Controller(this);
    control.setId(2);

    layout.addView(mField);

    layout.addView(control);
    registerForContextMenu(control);

    setContentView(layout);
    mField.requestFocus();

} 
```

自定义线性布局的 onMeasure 代码如下所示

```
public class MyLinear extends LinearLayout{

private int height, width; // dimension of the screen
private Context m_context;

public MyLinear(Context context) {
    super(context);
    m_context=context;
}

@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    int height_temp = View.MeasureSpec.getSize(heightMeasureSpec);
    int width_temp = View.MeasureSpec.getSize(widthMeasureSpec);
    double ratio = width_temp/(double)height_temp;
    int final_height = (int) (width_temp/1.77);
    height=final_height;

    if (ratio<1.7) {
      setMeasuredDimension(width_temp, (int) (width_temp/1.77));

    } else {
      setMeasuredDimension(width_temp, height_temp);
    }

} 
```

有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T01:41:18.227

您编辑 view.xml 文件。添加 res/layout-xlarge/my_layout.xml 文件夹。添加 my_layout.xml 文件 res/layout-xlarge/ 文件夹后...对不起英语不好

# java - 布尔值不会在控制台中打印出来

> ID：14407688
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:34.657
> 
> 标签：java, string, printing, console, boolean

我对一个非常简单的字符串验证问题感兴趣，看看字符串中的起始字符是否以大写字母开头，然后让控制台显示真假。据我了解，您不必调用 System.console().printf("true", s) 之类的东西来实现这一点。我可以发誓我已经看到使用以下示例代码实现了类似的基本实现：

```
public class Verify {
    public static boolean checkStartChar(String s) {
        if (s.startsWith("[A-Z]")) {
            return true;
        } else {
            return false;
        }
    }

    public static void main(String[] args) {
        String str = "abCD";
        checkStartChar(str);
    }
} 
```

但是当我运行它时，什么都没有显示。如果我在返回 T/F 之前通过添加条件打印输出进行轻微修改，例如

```
public class Verify2 {
    public static boolean checkStartChar(String s) {
        if (s.startsWith("[A-Z]")) {
            System.out.println("yep");
            return true;
        }
        else {
            System.out.println("nope");
            return false;
        }
    }

    public static void main(String[] args) {
        String str = "abCD";
        checkStartChar(str);
    }
} 
```

问题在一定程度上得到了解决，因为控制台显示“是”或“否”，但尚未解决，因为我只想让控制台显示真或假。就是这样。建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:19:46.447

由于问题已经得到解答，我想指出 RegEx 没有必要解决这个问题（而且它们是昂贵的操作）。你可以像这样简单地做到这一点：

```
static boolean startsWithUpperCase(String toCheck)
{
    if(toCheck != null && !toCheck.isEmpty())
    {
        return Character.isUpperCase(toCheck.charAt(0));
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-18T21:13:29.163

> 尚未解决，因为我只想让控制台显示 true 或 false

调用`checkStartChar`方法将返回值，这并不意味着它将值打印到控制台。您需要编写您希望如何处理返回值的代码。如果你想打印返回值，那么你应该这样做：

```
System.out.println(checkStartChar(str)); 
```

将打印`checkStartChar`方法的返回值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:13:33.140

```
if(s.startsWith("[A-Z]")){ 
```

[String.startsWith(prefix)](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)不将正则表达式作为参数，您应该改用正则表达式 APi。

```
Pattern p = Pattern.compile("[A-Z]");
Matcher m = p.matcher(new Character(s.charAt(0)).toString());
if(m.find()){
            return true;
}else{
    return false;
}
String str = "AbCD";
System.out.println(checkStartChar(str)); 
```

输出：

```
 true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T17:04:07.197

In your code checkStartChar(str); is returning a boolean value which is not being used in your program.Then if you want to display true or false then you can use. System.out.println(checkStartChar(str));

# node.js - 如何管理 Node.js 中的 HTTP 错误

> ID：14407690
> 
> 赞同：0
> 
> 时间：2013-01-18T21:11:48.900
> 
> 标签：node.js, error-handling

嗨，我正在开发我的第一个 Node.js 应用程序，我发现我的第一个问题非常基本，我无法捕获 HTTP 错误（404、500、...）

我已经关注了文档（我认为是这样），但我想我错过了一些东西。

这是我的代码：

```
var express = require('express')
app = express()
app.use(express.logger('dev'));

app.get('/', function(req, res) {
    res.send('Hellow World!!!')
})
app.use(app.router);
app.use(function(err, req, res, next) {
    console.error('Oh!! ERROR');
    console.error('My ERROR: ' + JSON.stringify(err));
});

app.listen(3000);
console.log('Server running at http://127.0.0.1:3000/'); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:32:39.517

所以 express 的工作方式是，如果它到达整个中间件和路由处理程序堆栈的末尾并且还没有任何响应，它将自动发送回退 404 响应而不会引发错误。这就是为什么没有调用您的错误处理中间件的原因。默认情况下，express 不会将 404 视为错误，这可能是正确的思考方式。

如果你想自定义它，你可以在堆栈的末尾放置一个中间件，以直接提供自定义 404 页面，或者`next`如果你喜欢这种方式调用错误。

```
app.get('/'...
app.get('/two'...
app.get(/'three'...

app.use(middleware1...
app.use(middleware2...
app.use(app.router);
app.use(function (req, res, next) {
    //Option 1: respond here
    return res.status(404).render('my_404_view');
    //Option 2: trigger error handler
    return next(new Error('404ed!'));
} 
```

选项 2 将触发您的错误处理中间件。在那里，您必须从错误对象中获取信息，以确定要呈现的所需视图和要发送的状态代码。我个人定义了一个`errors.NotFound`具有 404 代码的类，并让我呈现友好的 404 页面视图。

# sql-server - 从表没有行 id 列的 SQL Server 2008 查询结果中选择每 n 行

> ID：14407693
> 
> 赞同：10
> 
> 时间：2013-01-18T21:11:53.120
> 
> 标签：sql-server

我感觉如此接近......我认为我的问题是我如何将MOD功能与功能结合使用`ROW_NUMBER()`，但我不明白我做错了什么。

我正在使用该`ROW_NUMBER()`功能，因为我需要一种方法来选择每个“第 n”行。我已经阅读了关于这个的其他页面（我用它们来创建我的 SQL）......但是我从 SQL Server 收到一个错误。我需要内部表连接（表的 2 个实例`Tick_OneMin`和`H1`）`H2`来同时获取不同证券的价格快照。

如果我用函数注释掉该行`MOD`...SQL 执行得很好...但是如果我将它放入......SQL Server 会抛出错误消息：

> *在预期条件的上下文中指定的非布尔类型的表达式，靠近“MOD”。*

这是我对 SQL 的尝试——

```
SELECT 
   ROW_NUMBER() OVER (ORDER BY H1.CombDateTime ASC) AS RowID,
   H1.CombDateTime, 
   H1.Close_PX as 'TYA_Close', 
   H2.Close_PX 'ESA_Close'
FROM 
   Tick_OneMin as H1, Tick_OneMin as H2
WHERE 
   H1.Ticker = 'TYA'
   AND H2.Ticker = 'ESA'
   AND H1.CombDateTime >= '12/28/2012 10:00 AM'
   AND H1.CombDateTime <= '12/28/2012 10:30 AM'
   AND H1.CombDateTime = H2.CombDateTime
   AND RowID MOD 4 = 0     
   -- this "RowID MOD 4 = 0" is throwing an error in SQL Server
ORDER BY 
   H1.CombDateTime ASC 
```

我的表如下所示（1 表 3 列）

桌子`Tick_OneMin`

```
Ticker - CombDateTime - Close_PX
------------------------------------
ES     - 1/3/2012 10:00 AM    - 1470
ZN     - 1/3/2012 10:00 AM   - 132.5
ES     - 1/3/2012 10:01 AM   - 1475
ZN     - 1/3/2012 10:01 AM   - 133 
```

我想创建以下输出

```
Date  -   ZN.Price -  ES.Price
====     ========   ========
1/3/2012 -  132.5  - 1470
1/3/2012 -  133    - 1475 
```

任何想法为什么 SQL SErver 会抛出错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-18T21:14:51.367

您不能在`SELECT`子句中引用子句中定义的别名`WHERE`，因为`WHERE`它首先被解析。一种解决方法是使用子查询或 CTE：

```
WITH x AS
(
 SELECT ROW_NUMBER() OVER (ORDER BY H1.CombDateTime ASC) AS RowID,
  ... rest of query
)
SELECT CombDateTime, TYA_Close, ESA_Close --, RowID
FROM x
WHERE RowID % 4 = 0
ORDER BY CombDateTime; 
```

还要注意 Martin 和 Marc 所指出的 - SQL Server`%`不使用`MOD`您从 VB 或其他地方引入的运算符。

# c# - MVC 3 逆向工程师数据库然后切换到代码优先

> ID：14407696
> 
> 赞同：3
> 
> 时间：2013-01-18T21:12:02.880
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework, code-first

我之前用过 EntitFramework 用 MVC 做 codefirst；但是，我从未对现有数据库进行逆向工程来获取我的模型。

所以我想做的是对现有数据库进行逆向工程，然后切换到代码优先，这样对模型所做的更改将由实体框架之神自动反映在数据库中。我将如何做到这一点，特别是逆向工程师然后切换到代码优先？如果这措辞不好，或者我对 MVC 还是很陌生，请宽恕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:37:42.420

它基本上归结为使用工具自动生成代表您的域的 POCO 类，然后使用这些类作为 EF Code First 和未来迁移的基础。

这是一篇 msdn 文章，概述了该过程

*   [代码优先到现有数据库](http://msdn.microsoft.com/en-us/data/jj200620.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:31:28.367

您可以通过创建实体数据模型来反转现有数据库。

检查以下链接。这里逐步描述了如何将数据库反转为具有所有导航属性和所需关系的 CodeFirst 方法。这种场景对于那些 CodeFirst 无法自行解析且配置不太直观的实体关系也非常有用。

[从 ModelFirst 反转到 CodeFirst](http://weblogs.asp.net/jgalloway/archive/2011/02/24/generating-ef-code-first-model-classes-from-an-existing-database.aspx)

# vb.net - 当一个表单被销毁时，所有的表单数据和数据集都被销毁了吗？

> ID：14407697
> 
> 赞同：0
> 
> 时间：2013-01-18T21:12:09.897
> 
> 标签：vb.net, dataset

如题，当一个表单被处理掉时，所有的`form`数据都`datasets`被处理掉了吗？

例子：

```
Dim C As New Commands
C.ShowDialog
C.Disopse() 
```

因此`C`form 包含`datasets`和`oledbconnections`更多未处理的对象。如果不是，那么释放内存和释放所有资源的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T02:52:48.870

与其他 .NET 对象一样，您不能保证在处置表单时会处置数据集。这是因为 .NET 不断监视内存中是否存在指向对象的活动指针。如果没有找到链接，它会释放分配给对象的内存。这样的过程称为[垃圾收集](http://msdn.microsoft.com/en-us/library/0xy59wtx.aspx)——CLR 的一个特性。

问题是您可以在另一个表单、类甚至另一个项目中拥有一个指向同一数据集的变量。您可以根据需要生成任意数量的这些变量。作为开发人员，您必须制定策略来控制谁以及如何使用您的对象。否则，您将永远不会知道在任何给定时刻是否实际处理了特定数据集。

[using 子句](http://msdn.microsoft.com/en-us/library/htd05whh%28v=vs.80%29.aspx)有助于控制对象的处置，但它不是最终的解决方案。如果您不知道自己在做什么，您仍然会遇到麻烦。有时您需要故意将未处理的连接对象传递给其他函数，以便对数据处理进行更精细的控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T03:02:20.710

表单的 .Dispose() 方法用于处理表单使用的其他非托管 GDI 资源。由于该方法对您可能添加的内容一无所知，因此您无法确定数据集等项目是否也已处理。

您可以期望的最好结果是，由于对表单进行 Dispose() 处理也高度表明该表单即将成为垃圾收集的条件，您的其他资源也可能即将成为垃圾收集的条件。*如果*这些类型的 Dispose() 和终结器模式正确实现，那么您的其他项目*很可能*很快就会被释放。多快是不可能的……这就是存在 dispose 模式的原因：当您需要确保立即清理非托管资源时。

我建议释放任何额外资源的方法是*覆盖*普通的 Windows 窗体 Dispose() 方法。Dispose() 方法的新实现将使用 MyBase 关键字调用基本实现，并为表单的任何 IDisposable 成员调用 Dispose()。这样，表单仍将作为 Using 块的一部分正常工作。

# css - 是否可以使用 CSS 将电子邮件作为一种媒体类型？

> ID：14407698
> 
> 赞同：0
> 
> 时间：2013-01-18T21:12:18.860
> 
> 标签：css

我有一个用 html 生成的报告，如果报告是从浏览器通过电子邮件发送的，我想防止某些列被包含在内。我想象一些类似于媒体类型屏幕的东西，打印。

有什么想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-18T21:34:27.100

因此，如果您有一个网页，如果通过电子邮件发送给某人（即，有人单击“通过电子邮件共享”的按钮），您想要更改的网页，那么您可以在 url 中添加一个变量`http://www.somedomain.com/page_to_be_emailed.html#email`，然后使用javascript/jQuery 来感知主题标签并删除必要的元素，如下所示：

```
if(window.location.hash) { 
    var thehash = window.location.hash;
    if (thehash == "#email"){
        //hide some stuff
        $('div.you_want_to_hide').css({'display':'none'});
    }
} 
```

# java - 如何将多个复选框传递给动作

> ID：14407699
> 
> 赞同：3
> 
> 时间：2013-01-18T21:12:25.247
> 
> 标签：java, jsp, struts2, freemarker

我正在使用 Struts 2 和 Freemarker。这是我的动作课：

```
package test;

import java.util.ArrayList;
import java.util.List;

public class WelcomeAction {

    private String userName;
    private String gender;
    private List<String> fruits;
    private String fruit;

    public String execute() {
//      if(!userName.equals("a"))
//      {
//          return "fail";
//      }
//      else {
//          return "SUCCESS";           
//      }
        return "SUCCESS";
    }   

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public String getGender() {
        return gender;
    }

    public void setGender(String gender) {
        this.gender = gender;
    }

    public String getFruitsPicked() {
        return fruit;
    }

    public void setFruitsPicked(String fruitsPicked) {
        this.fruit = fruitsPicked;
    }

    public List<String> getFruits() {
        return fruits;
    }

    public void setFruits(List<String> fruits) {
        this.fruits = fruits;
    }

    public WelcomeAction(){
        fruits = new ArrayList<String>();
        fruits.add("apples");
        fruits.add("oranges");
        fruits.add("pears");
        fruits.add("peaches");
    }
} 
```

这就是我的`.ftl`：

```
<input type="checkbox" list="fruits" name="friut[]" value="apples" /> Apples<br /> 
<input type="checkbox" list="fruits" name="friut[]" value="oranges" /> Oranges<br /> 
<input type="checkbox" list="fruits" name="friut[]" value="pears" /> Pears<br /> 
<input type="checkbox" list="fruits" name="friut[]" value="peaches" /> Peaches<br /> 
```

这就是我尝试打印的方式：

```
<#list fruits as item>${item}</#list> 
```

但是上面的命令会打印我在构造函数中添加的列表中的所有项目。当然，我只想要提交表单时检查的项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T22:43:05.853

`name="friut[]"`应该是`name="fruits"`。JavaBean 属性名称是`fruits`, not `fruit`（也不`friut`...注意错字）。我不知道这`[]`对 Struts 有意义，更好地说，对于使用的 OGNL `ValueStack.setValue`/ `ParametersIntercaptor`。（尽管它理解`fruits[0]`，这对于在现有列表中设置元素很有用。）。所以最后 Struts 忽略了参数，所以你最终得到了原始列表。从哪里来`list="fruits"`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:43:53.990

您可以使用

```
<s:checkboxlist name="fruit" list="fruits"/> 
```

您不需要在多个`<input>`字段中保留多个复选框的值，因此不需要很多`<input>`字段。Struts2 应该适当地渲染它。多个值将以*逗号分隔的值*出现。

在您的代码中，您必须以与包含选定值`list`相同的方式添加 getter 和 setter 。`fruit`提交表单时，[`params`拦截器](https://struts.apache.org/core-developers/parameters-interceptor.html)将完成其填充您使用 setter 调用的操作的工作。

# ruby-on-rails - Savon 没有将其输出记录到 production.log，即使启用了日志记录并设置为 :info

> ID：14407709
> 
> 赞同：2
> 
> 时间：2013-01-18T21:12:50.320
> 
> 标签：ruby-on-rails, ruby-on-rails-3, logging, savon

我有所有三个环境（测试、开发、生产）通过`config.log_level = :info`各自的 .rb 文件在 :info 级别显示日志输出。

当我使用 启动本地 Rails 服务器时`rails s`，当有我期望的请求时，Savon 输出会出现在控制台中。但是此输出不会记录到实际`development.log`文件中。同样的事情发生在生产环境中，我真的很想看到 Savon 的输出。

我的 application.rb 中有这个块：

```
Savon.configure do |config|
  config.env_namespace = :soapenv
  config.log = true
  config.logger = Rails.logger
  config.log_level = :info
  config.pretty_print_xml = true
end 
```

哪个确实配置了我是否可以在控制台中看到日志记录。但是我如何实际将其写入 *.log？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T00:11:31.563

对我来说这是顺序：/“日志”应该在“记录器”之前

*   config.log = 真
*   config.logger = Rails.logger

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T19:22:07.503

[我在GitHub](https://github.com/savonrb/savon/issues/370)上找到了这个问题的解决方案。诀窍是直接在 Savon::Model 客户端中配置变量。

# qt - 需要在我的 QListWidget 中显示带有偏移量的小部件，基本上向右移动了一点

> ID：14407710
> 
> 赞同：1
> 
> 时间：2013-01-18T21:12:50.403
> 
> 标签：qt, qlistwidget

我有一个使用 QTDesigner 完成的 panel.ui 文件。这是一个 QFrame 类，矩形形状，上面很少有标签。我有一个 QListWidget 类，我在其中插入了 panel.ui 的 3 个实例。我创建了一个`QListWidgetItem`然后使用`List->SetItemWidget(..)`来填充我的列表。
结果是一个包含三个面板的列表。我还能够使用 dragDropMode internalMove 在列表中移动面板。

我还测试了当我点击面板时将面板向右移动的能力，这很有效：

```
in procedure List::mousePressEvent(QMouseEvent *event)    
Panel *child = static_cast<Panel*>(childAt(event->pos()))  
...   
int y= child->pos().y();   
int x = child->pos().x();   
child->move (x +10, y);   ` 
```

问题：当我运行应用程序并显示列表时，我希望所有面板都显示为向右偏移 10 个。`this->setItemWidget(myPanelItem, myPanel);`因此，在我尝试使用上述方法后，在 List 构造函数和循环内部`myPanel->move()`，但它似乎不起作用。

我运行该应用程序，面板显示时没有我的偏移量（不知道为什么？）但是当我单击一个时，它会发生变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:34:22.153

`move()`由于小部件在布局中，因此无法可靠地工作。（嗯，不是 a 中的布局`QLayout`，但效果是可比较的：当应用程序中的任何指标发生变化时，例如您调整列表大小或滚动列表，小部件将由列表小部件重新定位。）

您可以做的是将您的实际小部件包装在具有布局边距的容器小部件中：

```
QWidget* wrapIntoContainerForOffset(QWidget* widget, int offset /*in pixels*/) {
    QWidget* container = new QWidget;
    QHBoxLayout* layout = new QLayout(container);
    layout->setContentsMargins(/*left=*/ offset, /*others=*/ 0, 0, 0);
    layout->addWidget(widget);
    return container;
} 
```

然后将这些容器添加到列表小部件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T00:39:54.630

你试过样式表吗？QListWidget 支持 Box 模型（[http://doc.qt.digia.com/qt/stylesheet-customizing.html#box-model](http://doc.qt.digia.com/qt/stylesheet-customizing.html#box-model)）。因此，您可能想尝试在样式表中使用边距。

样式表参考：[http ://doc.qt.digia.com/qt/stylesheet-reference.html](http://doc.qt.digia.com/qt/stylesheet-reference.html)

# jquery - JQuery Cycle 滑块中图像的标题

> ID：14407711
> 
> 赞同：0
> 
> 时间：2013-01-18T21:13:03.380
> 
> 标签：jquery, cycle, captions

我试图在这个 JQuery 滑块中获取图像的标题（像[这样](http://slidesjs.com/examples/images-with-captions/)，但没有动画），但到目前为止没有太大的成功。

这是滑块的 HTML...

```
<div class="container-slideshow"><div class="slideshow">
    <img src="img/pic2.jpg" width="300" height="200" />
    <img src="img/pic3.jpg" width="300" height="200" />
    <img src="img/pic4.jpg" width="300" height="200" />
    <img src="img/pic5.png" width="300" height="200" />
</div></div> 
```

...由以下方式激活：

```
<script type="text/javascript">
$('.slideshow').cycle({
    fx: 'scrollLeft',
    speed: 400,
    pause: 1
}); 
```

我尝试将每个图像与标题 div 一起包装在一个 div 中 - 比如

```
<div><img src="img/pic2.jpg" width="300" height="200" /><div class="caption">Caption</div></div> 
```

*   但图像会覆盖标题。Z-index 没有任何区别。这些图像也不允许 CSS 不透明度，这告诉我它们正在 JQuery 中处理？

我不知道。有人吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:00:07.943

```
.slide {
    width: 300px;
    height: 200px;
}
.s1 {
    background: url(http://www.hitarth.net/wp-content/uploads/2012/11/cute-puppy-300x200.jpg);
}
.s2 {
    background: url(http://www.cesarsway.com/sites/default/files/imagecache/feature_300x200/images/LabPup.jpg);
}
.s3 {
    background: url(http://cdn.cutestpaw.com/wp-content/uploads/2012/06/s-my-puppy-has-no-eyes.jpg);
}
.caption {
    height: 25px;
    position: absolute;
    width: 100%;
    bottom: 0;
    background-color: rgba(0, 0, 0, .3);
    text-align: center;
    color: #fff;
}

<div class="container-slideshow">
    <div class="slideshow">
        <div class="slide s1">
            <div class="caption">Caption One</div>
        </div>
        <div class="slide s2">
            <div class="caption">Caption Two</div>
        </div>
        <div class="slide s3">
            <div class="caption">Caption Three</div>
        </div>
    </div>
</div> 
```

[http://jsfiddle.net/XuwUX/](http://jsfiddle.net/XuwUX/)

# postgresql - PostgreSQL 索引不用于 IP 范围的查询

> ID：14407719
> 
> 赞同：9
> 
> 时间：2013-01-18T21:13:27.790
> 
> 标签：postgresql, indexing, database-design, range, gist-index

我正在使用 PostgreSQL 9.2 并且有一个 IP 范围表。这是SQL：

```
CREATE TABLE ips (
  id serial NOT NULL,
  begin_ip_num bigint,
  end_ip_num bigint,
  country_name character varying(255),
  CONSTRAINT ips_pkey PRIMARY KEY (id )
) 
```

我在 和 上添加了普通的 B-tree`begin_ip_num`索引`end_ip_num`：

```
CREATE INDEX index_ips_on_begin_ip_num ON ips (begin_ip_num);
CREATE INDEX index_ips_on_end_ip_num ON ips (end_ip_num ); 
```

正在使用的查询是：

```
SELECT ips.* FROM ips
WHERE 3065106743 BETWEEN begin_ip_num AND end_ip_num; 
```

问题是我的`BETWEEN`查询仅使用`begin_ip_num`. 使用索引后，它使用`end_ip_num`. 结果如下`EXPLAIN ANALYZE`：

```
Index Scan using index_ips_on_begin_ip_num on ips  (cost=0.00..2173.83 rows=27136 width=76) (actual time=16.349..16.350 rows=1 loops=1)
Index Cond: (3065106743::bigint >= begin_ip_num)
Filter: (3065106743::bigint <= end_ip_num)
Rows Removed by Filter: 47596
Total runtime: 16.425 ms 
```

我已经尝试过各种索引组合，包括在`begin_ip_num`和上添加复合索引`end_ip_num`。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-18T21:21:18.850

尝试[多列索引](https://www.postgresql.org/docs/current/indexes-multicolumn.html)，但第二列的顺序相反：

```
CREATE INDEX index_ips_begin_end_ip_num ON ips (begin_ip_num, end_ip_num DESC); 
```

排序对于单列索引几乎无关紧要，因为它几乎可以以同样快的速度向后扫描。但这对于多列索引很重要。

使用我建议的索引，Postgres 可以扫描第一列并找到地址，索引的其余部分满足第一个条件。然后，对于第一列的每个值，它可以返回满足第二个条件的所有行，直到第一个条件失败。然后跳转到第一列的下一个值，等等。
这***仍然不是很有效***，Postgres 可能会更快，只需扫描第一个索引列并过滤第二个。很大程度上取决于您的数据分布。

无论哪种方式，[`CLUSTER`](https://www.postgresql.org/docs/current/sql-cluster.html)使用上面的多列索引*都可以*提高性能：

```
CLUSTER ips USING index_ips_begin_end_ip_num 
```

这样，满足您的第一个条件的候选人将被打包到相同或相邻的数据页上。如果第一列的每个值有很多行，则可以大大提高性能。否则几乎没有效果。
（也有用于此目的的非阻塞外部工具：[pg_repack](https://github.com/reorg/pg_repack/)或[pg_squeeze](https://github.com/cybertec-postgresql/pg_squeeze)。）

此外，[autovacuum](https://www.postgresql.org/docs/current/routine-vacuuming.html)是否运行和配置正确，或者您是否`ANALYZE`在桌面上运行？您需要 Postgres 的当前统计信息来选择适当的查询计划。

真正有用的是[一个](https://www.postgresql.org/docs/current/rangetypes.html#RANGETYPES-GIST)[列的](https://www.postgresql.org/docs/current/rangetypes.html#RANGETYPES-GIST)[**GiST 索引**`int8range`](https://www.postgresql.org/docs/current/rangetypes.html#RANGETYPES-GIST)，从 PostgreSQL 9.2 开始可用。

进一步阅读：

*   [优化对一系列时间戳（两列）的查询](https://dba.stackexchange.com/a/39599/3684)

**如果**您的 IP 范围可以覆盖其中一种[内置网络类型`inet`或`cidr`](https://www.postgresql.org/docs/current/datatype-net-types.html)，请考虑替换您的两`bigint`列。或者，更好的是，看看 Andrew Gierth 的[附加模块**ip4r**](https://github.com/RhodiumToad/ip4r)（不在标准发行版中。索引策略会相应更改。

除此之外，您可以使用带有部分索引的复杂机制在 dba.SE 上查看此相关答案。先进的东西，但它提供了出色的性能：

*   [空间索引能否帮助“范围-按-限制”查询](https://dba.stackexchange.com/a/22500/3684)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-26T20:18:11.790

我在 maxmind.com 的免费 geiop 表中几乎相同的数据集上遇到了完全相同的问题。我使用 Erwin 关于范围类型和 GiST 索引的提示解决了这个问题。GiST 索引是关键。没有它，我最多每秒查询 3 行。有了它，我在 10 秒内查询了近 500000 行！由于 Erwin 没有发布有关如何执行此操作的详细说明，我想我会在此处添加它们...

首先，您必须添加一个具有范围类型的新列，注意 int8range 对于 bigint 类型是必需的。接下来适当地设置它的值，注意'[]'参数表示使范围*包含*在下限和上限（rtfm）。最后添加索引，注意 GiST 索引是所有性能优势的来源。

```
alter table ips add column iprange int8range;
update ips set iprange=int8range(begin_ip_num, end_ip_num, '[]');
create index index_ips_on_iprange on ips using gist (iprange); 
```

打好基础后，您现在可以使用 '<@' 包含的运算符来针对表搜索特定地址。见[http://www.postgresql.org/docs/9.2/static/functions-range.html](http://www.postgresql.org/docs/9.2/static/functions-range.html)

```
SELECT "ips".* FROM "ips" WHERE (3065106743::bigint <@ iprange); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-13T18:48:48.303

我参加这个聚会有点晚了，但这对我来说真的很有效。

考虑安装[ip4r 扩展](https://github.com/RhodiumToad/ip4r)。它基本上允许您定义一个可以保存 IP 范围的列。扩展名意味着它仅适用于 IPv4，但目前它也支持 IPv6。

在使用该列中的范围填充表后，您需要创建 GIST 索引：

```
CREATE INDEX ip_zip_ip4_range ON ip_zip USING gist (ip4_range); 
```

我的数据库中有近 1000 万个范围，但查询只需要几分之一毫秒：

```
region=> select count(*) from ip_zip ;

  count  
---------
 9566133

region=> explain analyze select * from ip_zip where '8.8.8.8'::ip4 <<= ip4_range;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on ip_zip  (cost=234.55..25681.29 rows=9566 width=22) (actual time=0.085..0.086 rows=1 loops=1)
   Recheck Cond: ('8.8.8.8'::ip4r <<= ip4_range)
   Heap Blocks: exact=1
   ->  Bitmap Index Scan on ip_zip_ip4_range  (cost=0.00..232.16 rows=9566 width=0) (actual time=0.055..0.055 rows=1 loops=1)
         Index Cond: ('8.8.8.8'::ip4r <<= ip4_range)
 Planning time: 0.106 ms
 Execution time: 0.118 ms
(7 rows)

region=> explain analyze select * from ip_zip where '254.50.22.54'::ip4 <<= ip4_range;
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on ip_zip  (cost=234.55..25681.29 rows=9566 width=22) (actual time=0.059..0.059 rows=1 loops=1)
   Recheck Cond: ('254.50.22.54'::ip4r <<= ip4_range)
   Heap Blocks: exact=1
   ->  Bitmap Index Scan on ip_zip_ip4_range  (cost=0.00..232.16 rows=9566 width=0) (actual time=0.048..0.048 rows=1 loops=1)
         Index Cond: ('254.50.22.54'::ip4r <<= ip4_range)
 Planning time: 0.102 ms
 Execution time: 0.145 ms
(7 rows) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:32:46.330

我相信您的查询看起来像`WHERE [constant] BETWEEN begin_ip_num AND end_ipnum`或

据我所知，Postgres 没有“AND-EQUAL”访问计划，因此您需要按照**Erwin Brandstetter**的建议在 2 列上添加复合索引。

# php - 在布局/加载等 pinterest 中处理可变图像大小

> ID：14407726
> 
> 赞同：0
> 
> 时间：2013-01-18T21:13:34.800
> 
> 标签：php, javascript, pinterest

我正在尝试为我的网站编译一个 pinterest 样式的布局。并且已经完成了，除了加载时间。我已经着手尽可能快地加载我的网站。

为此，我遇到了延迟加载脚本（可以在此处找到：http: [//www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)），它基本上首先加载站点，然后是图像，从而加快了可用性加载的网站，类似于 pinterest 所做的..

我遇到的问题是，虽然脚本可以工作，但因为我们在每个图像周围都有一个框来设置和呈现它，并且图像上未定义大小，所以每次布局都搞砸了。从本质上讲，一旦加载，图像大小总是会让布局感到惊讶。

解决此问题的最佳方法是什么？pinterest 是做什么的？与它们类似，我们有各种形状和大小的图像，用户将通过 php 和 javascript 将这些图像动态添加到我们的站点，因此我们无法自己简单地计算出每个图像的所有大小。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:46:47.990

Pinterest 很可能已经测量了图像并将图像尺寸存储在数据库中。然后简单地输出 img 标签内的高度，宽度不是动态的，因为它由 CSS 设置

首先在 css 中设置规则控制图像的宽度（这不会改变）：

```
.pin .ImgLink img
{
  max-width: 192px;
  opacity: 1;
}

.PinImageImg
{
  min-height:75px;
  background-color:#f2f0f0
} 
```

然后每个 img 标签的 HTML 标记控制高度（每个图像都会改变）：

```
<img src="http://media-cache-ec5.pinterest.com/upload/177118197817236677_8RujApQy_b.jpg" alt="Moon Goddess Gown by Halston Heritage" data-componentType="MODAL_PIN" class="PinImageImg" style="height: 288px;" /> 
```

这种方式不会弹出布局，因为每个图像都是由 javascript 加载的。

# rest - 是否应该使用自定义 http 标头或参数来识别 RESTful 服务的调用者的上下文？

> ID：14407729
> 
> 赞同：3
> 
> 时间：2013-01-18T21:13:40.737
> 
> 标签：rest, http-headers

我的团队继承了一个 WCF 服务，该服务用作多个后端系统的网关。每次调用此服务的第一步是基于标识调用者的上下文键的决策点。这个决策点本质上是一个工厂，它根据请求应该被定向到哪个后端系统来提供一个处理程序。

我们正在考虑将此服务简化为 RESTful 服务，并正在考虑将上下文密钥作为请求标头的一部分传递的好处和后果，而不是将上下文密钥作为参数添加到**每个**调用服务。一方面，在查看每个后端系统的服务的单独实现时，调用者的上下文似乎是一个正交的问题。但是，使用自定义标头让我感到有点不舒服，因为调用服务的基本细节从可见界面中被掩盖了。我应该注意到这是一个纯粹的内部解决方案，它减轻了我对界面可见性的一些担忧，但即使在内部，也无法确定下一个尝试连接或修改服务的工程师是否会意识到这一点隐藏的细节。

# gmail - 通过 OAuth 2.0 和私钥（即服务帐户）访问 GMail Imap Api

> ID：14407734
> 
> 赞同：2
> 
> 时间：2013-01-18T21:14:03.503
> 
> 标签：gmail, google-api, oauth-2.0, gdata-api, gmail-imap

我目前正在尝试使用服务帐户及其 P12 密钥连接到简单 Gmail 用户的 Imap 服务器。

如 [http://code.google.com/p/java-gmail-imap/wiki/GmailAndXOAUTH2](http://code.google.com/p/java-gmail-imap/wiki/GmailAndXOAUTH2)中所述，我成功地为域范围的委托服务帐户实现了它。

但是，我无法连接到普通的旧 gmail 帐户。

生成 OAuth 2.0 令牌的代码是：

```
public static String getAccessToken(String email) throws Exception {
       HttpTransport httpTransport = new NetHttpTransport();

JacksonFactory jsonFactory = new JacksonFactory();

GoogleCredential credential = new GoogleCredential.Builder()
    .setTransport(httpTransport)
    .setJsonFactory(jsonFactory)
    .setServiceAccountId(SingleUserCredentials.SERVICE_ACCOUNT_EMAIL)
    .setServiceAccountScopes("https://mail.google.com/")
    .setServiceAccountPrivateKeyFromP12File(
    new java.io.File(SingleUserCredentials.SERVICE_ACCOUNT_PKCS12_FILE_PATH))
            .setServiceAccountUser(SingleUserCredentials.EMAIL)
            .build();

    credential.refreshToken();
    return credential.getAccessToken();
} 
```

然后我连接到 ImapStore，如：

```
String authToken = getAccessToken(SingleUserCredentials.EMAIL);

OAuth2Authenticator.initialize();

IMAPStore imapSslStore = OAuth2Authenticator.connectToImap(
    "imap.gmail.com",
    993,
    SingleUserCredentials.EMAIL,
    authToken,
    true); 
```

我总是在线程“main”javax.mail.AuthenticationFailedException 中遇到异常：[ALERT] Invalid credentials (Failure)。

这里至少有两件事很奇怪：

1.  带有 OAuth 2.0 私钥的 Imap 适用于 Google Apps 域的域范围委派。
2.  我用于简单 gmail 帐户的证书非常适合该用户的 GDrive 和其他 Google 服务。

# android - android：扩展 ListActivity 时如何填充自定义布局

> ID：14407738
> 
> 赞同：1
> 
> 时间：2013-01-18T21:14:08.923
> 
> 标签：android, android-layout, android-listview

我需要扩展 ListActivity 并填充自定义布局，所以我执行以下操作

```
public class BizList extends ListActivity {

String bizNames[]={"one", "two","theree","four"};

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.bizlist);

    //ListView listviewMe = (ListView)findViewById(android.R.id.list);
    //ListView listview = this.getListView();

    setListAdapter(new ArrayAdapter<String>(this, android.R.id.list, bizNames));

/*  ListView list1 = (ListView) findViewById(R.id.listView1);
        list1.setAdapter(new ArrayAdapter<String>(getApplicationContext(),R.layout.list_item,startDates_str));;*/

} 
```

我的布局中的 ListView 是

```
 <ListView
        android:id="@id/android:list"//***have also tried*** android:id="@android:id/list"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/imageView2"
        android:layout_centerHorizontal="true" >

    </ListView> 
```

但我不断收到此错误

android.content.res.resources$notfoundexception: 文件表单xml类型布局资源ID

非常感谢任何和所有帮助。我希望这很简单。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:24:44.683

如果你想把它添加到你必须写的资源中
android:id="@+id/listView" 你忘记了“+”

```
 <ListView
                android:id="@+id/listView"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_below="@+id/imageView2"
                android:layout_centerHorizontal="true" >

   </ListView> 
```

在你的 onCreate 方法中

```
ListView lv = (ListView) findViewById(R.id.listView);

ArrayAdapter<String> myadpater = new ArrayAdapter<String>(
                        this, android.R.layout.simple_list_item_1, bizNames);
lv.setAdapter(myadpater); 
```

希望它现在有效。如果正确请投票

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:31:46.373

首先`ListActivity`要自动查找列表，资源 id 必须是...

```
android:id="@android:id/list" 
```

其次，当您创建 时`ArrayAdapter`，不要将`ListView`自身的 id 传递给构造函数。相反，您应该传递列表项布局的资源 ID。

试试这个...

```
setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, bizNames)); 
```

# ruby-on-rails - Redis：从 hget 键中增加一个值

> ID：14407741
> 
> 赞同：1
> 
> 时间：2013-01-18T21:14:16.053
> 
> 标签：ruby-on-rails, redis

首先，我是 Redis 的新手，所以请多多包涵，因为我确信这是一个简单的解决方案。

我试图从我的哈希中增加一个值**。**这就是我设置密钥`'hset user:likes 2 10'`的方式，所以第一部分是我的密钥，然后是另一个密钥，即用户 ID 号，然后是值 (10)。我需要做的是**增加**10 到 11 的值，但我不知道该怎么做。我知道我可以`'hget user:likes:total:count 2'`用来返回值，但是我如何同时使用**incr**命令和**hget**命令？

我正在使用 Ruby on Rails 通过使用 redis gem 来实现这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T00:59:14.447

你想要[HINCRBY](http://redis.io/commands/hincrby)：

```
$redis.hincrby("user:likes", 2, 1) 
```

如上所述，我对您的关键结构有点不清楚。但基本上，您传入散列的名称（“user:likes”）、散列键（在本例中，我假设用户 ID 为 2）以及您想要增加的值（在此情况1）。

# iphone - 如何使用 NSURLConnection 实例传递信息，以便我可以从 connectionDidFinishLoading 获取它

> ID：14407742
> 
> 赞同：1
> 
> 时间：2013-01-18T21:14:17.653
> 
> 标签：iphone, ios, nsurlconnection

我正在使用`NSURLConnection`从响应中加载数据。它可以正常工作，委托方法 connectionDidFinishLoading 具有我需要的数据的连接实例。问题是我想在请求中传递一些信息，以便在连接完成加载时可以获得它：

1.  用户希望通过（Facebook、Twitter、C、D）共享 URL 的内容。
2.  `NSURLConnection`用于获取URL的内容
3.  获得内容后，我使用 SL 框架 S`LComposeViewController:composeViewControllerForServiceType`并需要为其指定服务类型
4.  此时我不知道用户在步骤 1 中选择了什么服务。我想用`NSURLConnection`.

我可以`NSURLConnection`为此扩展一个属性吗？这似乎非常严厉。必须有一个“正确的方法”来做到这一点。

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:44:06.080

`NSURLConnection`假设您出于其他原因不需要流程的基于委托的版本，这是基于块的版本的一个很好的用例：

```
- (void)shareContentAtURL:(NSURL *)shareURL viaService:(NSString *)service
{
    NSURLRequest *urlRequest = [NSURLRequest requestWithURL:shareURL];
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];

    [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
    {
        if ([data length] == 0 && error == nil) {
            // handle empty response
        } else if (error != nil) {
            // handle error
        } else {
            // back to the main thread for UI stuff
            [[NSOperationQueue mainQueue] addOperationWithBlock:^{
                // do whatever you do to get something you want to post from the url content
                NSString *postText = [self postTextFromData:data]; 

                // present the compose view
                SLComposeViewController *vc = [SLComposeViewController composeViewControllerForServiceType:service];
                [vc setInitialText:postText];
                [self presentViewController:vc animated:YES]; 
            }];
        }   
    }];

} 
```

由于块可以从其周围范围捕获变量，因此您可以使用您已经拥有的任何上下文来供用户在`NSURLConnection`完成块内选择服务。

如果您`NSURLConnection`出于某种原因仍然使用基于委托的 API，您始终可以使用 ivar 或附加到处理此过程的任何对象的其他一些状态：`self.serviceType`当用户选择服务时设置或类似的，然后参考从`NSURLConnectionDelegate`方法中获取内容并准备好显示撰写视图后，请返回它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:22:42.703

您可以检查实例的`URL`属性`NSURLConnection`并通过解析`baseURL`or的`absoluteString`属性来确定服务，`URL`例如`- (ServiceType)serviceTypeForURL:(NSURL *)theURL;`

所有的`NSURLConnectionDelegate`方法都传递调用`NSURLConnection`对象——所以你可以从

`- (void)connectionDidFinishLoading:(NSURLConnection *)connection`

或者

`- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error`

# c++ - createprocess 默认挂起

> ID：14407743
> 
> 赞同：0
> 
> 时间：2013-01-18T21:14:18.640
> 
> 标签：c++, winapi, createprocess

我在 dll 中有这个函数：

```
int createChildProcess()
{
    STARTUPINFO si;
    PROCESS_INFORMATION pi;
    int res;

    si.cb=sizeof(STARTUPINFO);

    STARTUPINFO* ptr=&si;
    if(!CreateProcess(L"c:\\windows\\notepad.exe", NULL, 0, 0, false, CREATE_NEW_CONSOLE, 0, 0, &si, &pi))
    {
        mylog << "CreateProcess error: " << GetLastError() << std::endl;
        res = 0;
    }
    else
        res = pi.dwProcessId;

    CloseHandle( pi.hProcess );
    CloseHandle( pi.hThread );

    return res;
} 
```

我发现了2个问题：

1）函数第一次调用，总是返回错误码87（参数不正确）。

2）第二次，函数工作，但是创建了一个处于挂起状态的子进程，并且父进程的cpu使用率达到100%。

我用winXP sp3测试，我的dll是在vs 2010中编译的。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T21:29:12.513

您已初始化结构的`cbSize`字段`STARTUPINFO`，但未初始化其余部分。第一次调用`CreateProcess`时，未初始化的值显然*是错误*的，以至于函数认识到它们是错误的并放弃了。你很*幸运*。

您第二次调用它时，这些值显然是这样的，即`CreateProcess`您认为您已要求它做一些它知道该怎么做的事情，因此它会继续进行。这就是未定义行为的本质。

要解决此问题，请初始化*所有*结构：

```
STARTUPINFO si = {sizeof(STARTUPINFO)}; 
```

# javascript - 处理相互依赖和/或分层的异步调用

> ID：14407744
> 
> 赞同：11
> 
> 时间：2013-01-18T21:14:25.443
> 
> 标签：javascript, asynchronous, loose-coupling, waterfall

例如，假设我想从某个地方获取文件列表，然后加载这些文件的内容，最后将它们显示给用户。在同步模型中，它会是这样的（伪代码）：

```
var file_list = fetchFiles(source);

if (!file_list) {
    display('failed to fetch list');

} else {
        for (file in file_list) { // iteration, not enumeration
        var data = loadFile(file);

        if (!data) {
            display('failed to load: ' + file);
        } else {
            display(data);
        }
    }
} 
```

这为用户提供了不错的反馈，如果我认为有必要，我可以将代码片段移动到函数中。生活是简单的。

`fetchFiles()`现在，粉碎我的梦想：`loadFile()`实际上是异步的。简单的方法是将它们转换为同步函数。但是，如果浏览器锁定等待调用完成，这并不好。

如何处理多个相互依赖和/或分层的异步调用，而无需深入研究无尽的回调链，以经典的*缩减广告意大利面*方式？是否有经过验证的范例可以干净地处理这些问题，同时保持代码松散耦合？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T21:21:12.683

延迟确实是这里的方法。它们准确地捕获了您（以及大量异步代码）想要的东西：“走开，做这件可能很昂贵的事情，同时不要打扰我，然后等你回来再做。”

而且你不需要 jQuery 来使用它们。一个有进取心的人[将 Deferred 移植到 underscore](https://github.com/wookiehangover/underscore.deferred)，并声称您甚至不需要 underscore 来使用它。

所以你的代码看起来像这样：

```
function fetchFiles(source) {
    var dfd = _.Deferred();

    // do some kind of thing that takes a long time
    doExpensiveThingOne({
        source: source,
        complete: function(files) {
            // this informs the Deferred that it succeeded, and passes
            // `files` to all its success ("done") handlers
            dfd.resolve(files);

            // if you know how to capture an error condition, you can also
            // indicate that with dfd.reject(...)
        }
    });

    return dfd;
}

function loadFile(file) {
    // same thing!
    var dfd = _.Deferred();

    doExpensiveThingTwo({
        file: file,
        complete: function(data) {
            dfd.resolve(data);
        }
    });

    return dfd;
}

// and now glue it together
_.when(fetchFiles(source))
.done(function(files) {
    for (var file in files) {
        _.when(loadFile(file))
        .done(function(data) {
            display(data);
        })
        .fail(function() {
            display('failed to load: ' + file);
        });
    }
})
.fail(function() {
    display('failed to fetch list');
}); 
```

设置有点冗长，但是一旦您编写了处理延迟状态的代码并将其塞进某个函数中，您就不必再担心它了，您可以非常轻松地处理实际的事件流容易地。例如：

```
var file_dfds = [];
for (var file in files) {
    file_dfds.push(loadFile(file));
}

_.when(file_dfds)
.done(function(datas) {
    // this will only run if and when ALL the files have successfully
    // loaded!
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T19:04:04.807

**活动**

也许使用事件是个好主意。它使您无法创建代码树并解耦您的代码。

*我使用[bean](https://github.com/fat/bean)作为事件的框架。*

**示例伪代码**：

```
// async request for files
function fetchFiles(source) {

    IO.get(..., function (data, status) {
        if(data) {
            bean.fire(window, 'fetched_files', data);
        } else {
            bean.fire(window, 'fetched_files_fail', data, status);
        } 
    });

}

// handler for when we get data
function onFetchedFiles (event, files) {
    for (file in files) { 
        var data = loadFile(file);

        if (!data) {
            display('failed to load: ' + file);
        } else {
            display(data);
        }
    }
}

// handler for failures
function onFetchedFilesFail (event, status) {
    display('Failed to fetch list. Reason: ' + status);
}

// subscribe the window to these events
bean.on(window, 'fetched_files', onFetchedFiles);
bean.on(window, 'fetched_files_fail', onFetchedFilesFail);

fetchFiles(); 
```

几乎所有流行的 JS 框架都实现了自定义事件和这种事件处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-18T21:52:52.730

听起来你需要[jQuery Deferred](http://api.jquery.com/category/deferred-object/)。以下是一些未经测试的代码，可能有助于为您指明正确的方向：

```
$.when(fetchFiles(source)).then(function(file_list) { 
  if (!file_list) {
    display('failed to fetch list');
  } else {
    for (file in file_list) {
      $.when(loadFile(file)).then(function(data){
        if (!data) {
          display('failed to load: ' + file);
        } else {
          display(data);
        }
      });
    }
  }
}); 
```

我还找到了另一个[不错的帖子](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)，其中给出了 Deferred 对象的一些用例

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-23T17:27:36.943

如果您不想使用 jQuery，您可以使用结合同步请求的网络工作者。除了 10 之前的任何 Internet Explorer 版本外，所有主要浏览器都支持 Web Worker。

[Web Worker 浏览器兼容性](http://html5test.com/compare/feature/workers-worker.html)

基本上，如果你不完全确定 web worker 是什么，可以将其视为浏览器在不影响主线程的情况下在单独的线程上执行专门的 JavaScript 的一种方式（*警告：在单核 CPU 上，两个线程都将运行以交替的方式。幸运的是，现在大多数计算机都配备了双核 CPU*）。通常，Web Worker 被保留用于复杂的计算或一些密集的处理任务。请记住，Web Worker 中的任何代码都不能引用 DOM，也不能引用任何尚未传递给它的全局数据结构。本质上，网络工作者独立于主线程运行。Worker 执行的任何代码都应该与 JavaScript 代码库的其余部分分开，放在它自己的 JS 文件中。此外，如果网络工作者需要特定数据才能正常工作，您需要在启动时将这些数据传递给他们。

另一个值得注意的重要事情是，您需要用于加载文件的任何 JS 库都需要直接复制到 worker 将执行的 JavaScript 文件中。这意味着这些库应该首先被缩小（如果它们还没有被缩小），然后复制并粘贴到文件的顶部。

无论如何，我决定编写一个基本模板来向您展示如何处理这个问题。看看下面。随时提出问题/批评/等。

在您希望在主线程上继续执行的 JS 文件上，您需要类似于以下代码的内容来调用 worker。

```
function startWorker(dataObj)
{
    var message = {},
        worker;

      try
      {
        worker = new Worker('workers/getFileData.js');
      } 
      catch(error) 
      {
        // Throw error
      }

    message.data = dataObj;

    // all data is communicated to the worker in JSON format
    message = JSON.stringify(message);

    // This is the function that will handle all data returned by the worker
    worker.onMessage = function(e)
    {
        display(JSON.parse(e.data));
    }

    worker.postMessage(message);
} 
```

然后，在一个用于工作人员的单独文件中（如您在上面的代码中所见，我将文件命名为我的文件`getFileData.js`），编写如下内容...

```
function fetchFiles(source)
{
    // Put your code here
    // Keep in mind that any requests made should be synchronous as this should not
    // impact the main thread
}

function loadFile(file)
{
    // Put your code here
    // Keep in mind that any requests made should be synchronous as this should not
    // impact the main thread
}

onmessage = function(e)
{
    var response = [],
        data = JSON.parse(e.data),
        file_list = fetchFiles(data.source),
        file, fileData;

    if (!file_list) 
    {
        response.push('failed to fetch list');
    }
    else 
    {
        for (file in file_list) 
        { // iteration, not enumeration
            fileData = loadFile(file);

            if (!fileData) 
            {
                response.push('failed to load: ' + file);
            } 
            else 
            {
                response.push(fileData);
            }
        }
    }

    response = JSON.stringify(response);

    postMessage(response);

    close();
} 
```

**PS**：另外，我挖了另一个线程，它可以更好地帮助您了解将同步请求与 Web Worker 结合使用的优缺点。

[Stack Overflow - Web Worker 和同步请求](https://stackoverflow.com/questions/14068084/opinion-about-synchronous-requests-in-web-workers)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-23T18:08:57.890

[async](https://github.com/caolan/async)是一个流行的异步流控制库，经常与 node.js 一起使用。我从来没有亲自在浏览器中使用过它，但显然它也可以在那里工作。

此示例将（理论上）运行您的两个函数，返回所有文件名及其加载状态的对象。 `async.map`并行运行，while`waterfall`是一个系列，将每个步骤的结果传递到下一个步骤。

我在这里假设您的两个异步函数接受回调。如果他们不这样做，我需要更多关于他们打算如何使用的信息（他们是否会在完成时触发事件？等等）。

```
async.waterfall([
  function (done) {
    fetchFiles(source, function(list) {
      if (!list) done('failed to fetch file list');
      else done(null, list);
    });
    // alternatively you could simply fetchFiles(source, done) here, and handle
    // the null result in the next function.
  },

  function (file_list, done) {
    var loadHandler = function (memo, file, cb) {
      loadFile(file, function(data) {
        if (!data) {
          display('failed to load: ' + file);
        } else {
          display(data);
        }
        // if any of the callbacks to `map` returned an error, it would halt 
        // execution and pass that error to the final callback.  So we don't pass
        // an error here, but rather a tuple of the file and load result.
        cb(null, [file, !!data]);
      });
    };
    async.map(file_list, loadHandler, done);
  }
], function(err, result) {
  if (err) return display(err);
  // All files loaded! (or failed to load)
  // result would be an array of tuples like [[file, bool file loaded?], ...]
}); 
```

`waterfall`接受一个函数数组并按顺序执行它们，将每个函数的结果作为参数传递给下一个，以及作为最后一个参数的回调函数，您可以使用错误或函数的结果数据调用该函数。

您当然可以在这两者之间或周围添加任意数量的不同异步回调，而根本无需更改代码的结构。 `waterfall`实际上只是 10 种不同的流控制结构中的一种，因此您有很多选择（尽管我几乎总是最终使用`auto`，它允许您通过类似 Makefile 的需求语法在同一个函数中混合并行和串行执行）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-29T16:30:09.870

我正在使用的 webapp 遇到了这个问题，这就是我解决它的方法（没有库）。

**第 1 步**：编写了一个[非常轻量级的 pubsub 实现](https://github.com/Akamaozu/jsPubsub)。没有什么花哨。订阅、取消订阅、发布和记录。一切（带注释）加起来 93 行 Javascript。gzip 之前的 2.7kb。

**第 2 步**：通过让 pubsub 实现完成繁重的工作来解耦您尝试完成的过程。这是一个例子：

```
// listen for when files have been fetched and set up what to do when it comes in
pubsub.notification.subscribe(
    "processFetchedResults", // notification to subscribe to
    "fetchedFilesProcesser", // subscriber

    /* what to do when files have been fetched */ 
    function(params) {

        var file_list = params.notificationParams.file_list;

        for (file in file_list) { // iteration, not enumeration
        var data = loadFile(file);

        if (!data) {
            display('failed to load: ' + file);
        } else {
            display(data);
        }
    }
);    

// trigger fetch files 
function fetchFiles(source) {

   // ajax call to source
   // on response code 200 publish "processFetchedResults"
   // set publish parameters as ajax call response
   pubsub.notification.publish("processFetchedResults", ajaxResponse, "fetchFilesFunction");
} 
```

当然，这在设置中非常冗长，而幕后的魔力却很少。以下是一些技术细节：

1.  我`setTimeout`用来处理触发订阅。这样，它们以非阻塞方式运行。

2.  调用与处理有效地分离。您可以为通知编写不同的订阅，`"processFetchedResults"`并在响应通过后执行多项操作（例如记录和处理），同时将它们保存在非常独立、微小且易于管理的代码块中。

3.  上面的代码示例没有解决回退问题或运行适当的检查。我确信它需要一些工具才能达到生产标准。只是想向您展示它的可能性以及您的解决方案如何独立于库。

干杯!

# dart - Dart Web 组件何时调用已移除的生命周期方法？

> ID：14407745
> 
> 赞同：2
> 
> 时间：2013-01-18T21:14:27.873
> 
> 标签：dart, dart-webui

*最新编辑：*

这是 web-ui 中的一个未解决问题：[https ://github.com/dart-lang/web-ui/issues/245](https://github.com/dart-lang/web-ui/issues/245)

*之前：*

我试图弄清楚如何`removed()`从要调用的[Web 组件生命周期方法中获取。](http://www.dartlang.org/articles/dart-web-components/spec.html#lifecycle-methods)查看下面示例的生成代码，我看到有一个调用，`autogenerated.dispatch();`之后`replaceElement()`我希望是什么调用`removed()`，但我没有看到我的打印语句输出。

也许相关：我浏览了规范，试图了解`build.dart`生命周期方法的输出。也许规范已经过时了？我仍然没有看到规范的[实例化部分](http://www.dartlang.org/articles/dart-web-components/spec.html#instantiation)`composeChildren()`中列出（在[这个 web-ui 问题评论](https://github.com/dart-lang/web-ui/issues/93#issuecomment-10983760)中提到），即使在自动生成的代码中被调用。`composeChildren()``build.dart`

这个问题背后的原因是我对能够以编程方式（通过规范中的实例化指令）在单个父 html 文件中加载和卸载 web 组件的 Dart webapp 感兴趣，而不必在 html 中声明 web 组件。我正在使用 web_ui-0.2.11 运行。谢谢！

* * *

网络组件：

```
<!DOCTYPE html>
<html><body>
<element name="x-lifecycle-test" constructor="LifecycleTest" extends="div">
  <template> {{foo}} </template>
  <script type="application/dart">
    import 'dart:html';
    import 'package:web_ui/web_ui.dart';
    var foo = "testing lifecycle methods";
    class LifecycleTest extends WebComponent{
      inserted() => print("inserted");
      removed() => print("removed");
    } 
  </script>
</element>
</body></html> 
```

* * *

父 html 文件：

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"><title>Lifecycle</title>
    <link rel="components" href="lifecycle_test.html">
  </head>
  <body>
    <div>
      <button on-click="replaceElement()">replace element</button>
    </div>
    <div id='holder'>
        <x-lifecycle-test></x-lifecycle-test>
    </div>

    <script type="application/dart">  
      import 'dart:html';
      void replaceElement() {
        query('#holder').replaceWith(new DivElement()
                                        ..id = 'holder'
                                        ..text = 'replaced');
      }
      main() {} 
    </script>
    <script type='text/javascript' src="https://dart.googlecode.com/svn/branches/bleeding_edge/dart/client/dart.js"></script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-27T18:51:54.503

在此处添加一个完整的答案：Web 组件在 Dart 中使用 Polymer。当从 DOM 中删除自定义元素的实例时，将`leftView`触发生命周期方法。[您可以在https://www.dartlang.org/docs/tutorials/polymer-intro/#life-cycle-methods](https://www.dartlang.org/docs/tutorials/polymer-intro/#life-cycle-methods)阅读更多相关信息。

# c# - 动态文本框不改变值 ASP.Net 和 C#

> ID：14407752
> 
> 赞同：0
> 
> 时间：2013-01-18T21:14:41.553
> 
> 标签：c#, asp.net, dynamic, onclick

我目前正在页面加载时动态填充文本框。然后我使用 OnClick 命令从所述文本框中提取信息

我的 ASPX 表

```
<div class="mi_Container" id="Edit">
<div class="mi_Title">
    <asp:Label ID="App_Name_E" runat="server" />
</div>
<hr />
<table class="mi_Inner_Container">
    <tr>
        <td class="mi_Desc">
            Description: <br />
            <asp:TextBox ID="Description_E"  Rows="6" CssClass="mi_Textarea" TextMode="MultiLine" runat="server" />
        </td>
        <td class="mi_Center">
            Upload Test Script:<br />
        </td>
    </tr>
    <tr>
        <td class="mi_Rows">
            Application Owner: <br />
            <asp:TextBox ID="App_Owner_E" runat="server" />
        </td>
        <td class="mi_Center">
            <div class="mi_Img_Icons">
                Migration Status:<br />
                <asp:DropDownList ID="CS_E" runat="server" DataSourceID="Migration_Status_Source" DataTextField="Name" DataValueField="ID"></asp:DropDownList>
            </div>
            <div class="mi_Img_Icons">
                Migration Progress:<br />
                <asp:DropDownList ID="CP_E" runat="server" DataSourceID="Migration_Progress_Source" DataTextField="Name" DataValueField="ID"></asp:DropDownList>
            </div>
        </td>
    </tr>
    <tr>
        <td class="mi_Rows">
            Technical Service Owner: <br />
            <asp:TextBox ID="TSO_E" runat="server" />
        </td>
        <td class="mi_Center">   
            Migration Phase: <br />
            <asp:DropDownList ID="Migration_Phase_E" runat="server" DataSourceID="Migration_Phase_Source" DataTextField="Name" DataValueField="ID"></asp:DropDownList>
        </td>
    </tr>
            <tr class="mi_Rows">
        <td>
            Responsible Manager: <br />
            <asp:TextBox ID="Responsible_Manager_E" runat="server" />
        </td>
        <td class="mi_Center">
            Next Steps: <br />
            <asp:TextBox ID="Next_Steps_E" runat="server" />
        </td>
    </tr>
    <tr class="mi_Rows">
        <td>
            Signed Off by: <br />
            <asp:TextBox ID="Sign_Off_E" runat="server" />
        </td>
        <td class="mi_Center">
            <asp:Button ID="Update" runat="server" Text="Update Application" onclick="Update_Click" />
        </td>
    </tr>
</table> 
```

我的 C# 代码背后（相关）

```
 protected void Page_Load(object sender, EventArgs e)
    {
        ((Label)Master.FindControl("titleBar")).Text = "More Information";

        float ID = float.Parse(Request.QueryString["ID"]);
        DataTable tbl = appsql.appSpecific(ID);

        App_Name_E.Text = tbl.Rows[0]["App_Name"].ToString();
        Description_E.Text = tbl.Rows[0]["Description"].ToString();
        App_Owner_E.Text = tbl.Rows[0]["App_Owner"].ToString();
        CS_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Status"].ToString()));
        CP_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Progress"].ToString()));
        TSO_E.Text = tbl.Rows[0]["TSO"].ToString();
        Migration_Phase_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Migration_Phase"].ToString())) + 1;
        Responsible_Manager_E.Text = tbl.Rows[0]["Responsible_Manager"].ToString();
        Next_Steps_E.Text = tbl.Rows[0]["Next_steps"].ToString();
        Sign_Off_E.Text = tbl.Rows[0]["Sign_Off"].ToString();
    }

    protected void Update_Click(object sender, EventArgs e)
    {
        string DESC = Description_E.Text;
        string AO = App_Owner_E.Text;
        float CS = float.Parse(CS_E.SelectedValue);
        float CP = float.Parse(CP_E.SelectedValue);
        string TSO = TSO_E.Text;
        float MP = float.Parse(Migration_Phase_E.SelectedValue);
        string RM = Responsible_Manager_E.Text;
        string NS = Next_Steps_E.Text;
        string SO = Sign_Off_E.Text;

        using (SqlConnection connection = new SqlConnection(WebConfigurationManager.ConnectionStrings["app_migrationConnectionString"].ConnectionString))
        {

            SqlCommand cmd = new SqlCommand("UPDATE Apps SET Description = @DESC, App_Owner = @AO, Coexistence_Progress = @CP, Coexistence_Status = @CS, TSO = @TSO, Migration_Phase = @MP, Responsible_Manager = @RM, Next_Steps = @NS, Sign_Off = @SO, Last_Update = @LU Where ID = @ID", connection);

            cmd.Parameters.Add("@ID", SqlDbType.Float);
            cmd.Parameters["@ID"].Value = float.Parse(Request.QueryString["ID"]);

            cmd.Parameters.Add("@DESC", SqlDbType.VarChar, -1);
            cmd.Parameters["@DESC"].Value = DESC;

            cmd.Parameters.Add("@AO", SqlDbType.VarChar, -1);
            cmd.Parameters["@AO"].Value = AO;

            cmd.Parameters.Add("@CS", SqlDbType.Float);
            cmd.Parameters["@CS"].Value = CS;

            cmd.Parameters.Add("@CP", SqlDbType.Float);
            cmd.Parameters["@CP"].Value = CP;

            cmd.Parameters.Add("@TSO", SqlDbType.VarChar, -1);
            cmd.Parameters["TSO"].Value = TSO;

            cmd.Parameters.Add("@MP", SqlDbType.VarChar, -1);
            cmd.Parameters["@MP"].Value = MP;

            cmd.Parameters.Add("@RM", SqlDbType.VarChar, -1);
            cmd.Parameters["@RM"].Value = RM;

            cmd.Parameters.Add("@NS", SqlDbType.VarChar, -1);
            cmd.Parameters["@NS"].Value = NS;

            cmd.Parameters.Add("@SO", SqlDbType.VarChar, -1);
            cmd.Parameters["@SO"].Value = SO;

            cmd.Parameters.Add("@LU", SqlDbType.DateTime);
            cmd.Parameters["@LU"].Value = DateTime.Now;
            try
            {
                connection.Open();
                cmd.ExecuteNonQuery();
                connection.Close();
            }
            catch (Exception ex)
            {
                throw ex;
            }
        }
    } 
```

因此，当我运行 OnClick 时，它确实正确运行了 SQL 命令，因为最后一个更新字段正确复制并更新了 SQL 行。我的问题是所有其他变量都没有设置为新值。

我最近一直在为这个项目发布问题，这恰好是我第一次使用 ASP

我假设它与页面如何处理变量有关。我只是更改值并没有再次设置它们。

任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:19:24.500

> 我的问题是所有其他变量都没有设置为新值。

我假设数据库中的值不会更改，因为您总是`Page_Load`在事件处理程序中更新它们之前将它们加载。

您只需将其包装在`!PostBack`-check 中：

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
        ((Label)Master.FindControl("titleBar")).Text = "More Information";

        float ID = float.Parse(Request.QueryString["ID"]);
        DataTable tbl = appsql.appSpecific(ID);

        App_Name_E.Text = tbl.Rows[0]["App_Name"].ToString();
        Description_E.Text = tbl.Rows[0]["Description"].ToString();
        App_Owner_E.Text = tbl.Rows[0]["App_Owner"].ToString();
        CS_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Status"].ToString()));
        CP_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Progress"].ToString()));
        TSO_E.Text = tbl.Rows[0]["TSO"].ToString();
        Migration_Phase_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Migration_Phase"].ToString())) + 1;
        Responsible_Manager_E.Text = tbl.Rows[0]["Responsible_Manager"].ToString();
        Next_Steps_E.Text = tbl.Rows[0]["Next_steps"].ToString();
        Sign_Off_E.Text = tbl.Rows[0]["Sign_Off"].ToString();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:21:36.640

看起来您的控件可能正在重置为 Page_Load 事件中的旧值。通常，填充控件的块被包装，`if (!IsPostback) { ... }`以便仅在页面第一次加载时填充它们（即不是回发）。

因此，在您的情况下，您将拥有以下内容：

```
protected void Page_Load(object sender, EventArgs e)
{
    ((Label)Master.FindControl("titleBar")).Text = "More Information";

    if (!IsPostback)
    {
        float ID = float.Parse(Request.QueryString["ID"]);
        DataTable tbl = appsql.appSpecific(ID);
        App_Name_E.Text = tbl.Rows[0]["App_Name"].ToString();
        Description_E.Text = tbl.Rows[0]["Description"].ToString();
        App_Owner_E.Text = tbl.Rows[0]["App_Owner"].ToString();
        CS_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Status"].ToString()));
        CP_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Coexistence_Progress"].ToString()));
        TSO_E.Text = tbl.Rows[0]["TSO"].ToString();
        Migration_Phase_E.SelectedIndex = (Convert.ToInt16(tbl.Rows[0]["Migration_Phase"].ToString())) + 1;
        Responsible_Manager_E.Text = tbl.Rows[0]["Responsible_Manager"].ToString();
        Next_Steps_E.Text = tbl.Rows[0]["Next_steps"].ToString();
        Sign_Off_E.Text = tbl.Rows[0]["Sign_Off"].ToString();
    }
} 
```

这将阻止您的控件每次在 Page_Load 上重新初始化，这将允许您的`Update_Click`方法获取新值并正确更新数据库。

# forms - Delphi xe3 Mainform 隐藏

> ID：14407759
> 
> 赞同：4
> 
> 时间：2013-01-18T21:15:32.177
> 
> 标签：forms, delphi, hide, firemonkey, delphi-xe3

我一直在尝试使用隐藏的主窗体启动我的应用程序，但没有运气。它编译一切，但当我运行它时，我得到运行时错误。当我使用计时器并将其设置为 1 毫秒然后调用`Application.MainForm.Hide`它隐藏但它闪烁时我不希望这种情况发生

```
program Project1;
uses
  FMX.Forms,
  Unit1 in 'Unit1.pas' {Form1};

{$R *.res}

begin
  Application.Initialize;
  Application.CreateForm(TForm1, Form1);
  Application.MainForm.Visible := false;
  Form1.Visible:=false;
  Application.Run;
end. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:17:58.950

在 FireMonkey 应用程序中，自动创建的表单（被创建）并`MainForm`在方法中分配属性`Application.Run`。所以访问冲突是由于`MainForm`属性和`form1`变量为 nil 而引起的。

为了访问这些属性，您必须先执行该[`RealCreateForms`](http://docwiki.embarcadero.com/Libraries/XE2/en/FMX.Forms.TApplication.RealCreateForms)方法

```
begin
  Application.Initialize;
  Application.CreateForm(TForm2, Form1);
  Application.RealCreateForms;
  //Application.MainForm.Left:=-Application.MainForm.Width;
  Application.MainForm.Visible:=False;
  Application.Run;
end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-05T01:40:27.577

更简单的方法 - 覆盖 CanShow：

```
type
  TfrmMain = class(TForm)
  public
    function CanShow: Boolean; override;
  end;

...

function TfrmMain.CanShow: Boolean;
begin
  Result := False; // Or return True when it's OK to show
end; 
```

# c++ - 缺少 openGL 纹理标志 GL_TEXTURE_RECTANGLE

> ID：14407761
> 
> 赞同：2
> 
> 时间：2013-01-18T21:15:39.587
> 
> 标签：c++, visual-studio, opengl

我使用查询我的opengl版本`glGetString(GL_VERSION)`，它返回3.3.0。据我所知，3.3 确实有 GL_TEXTURE_RECTANGLE 标志。但是我无法在我的 gl.h 头文件中找到它，我的编译器（VC++）也无法识别该标志。我所有其他的 openGL 调用似乎都运行良好。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:38:58.993

不幸的是，Visual Studio 没有提供最新的 OpenGL 支持。查看[GLEW](http://glew.sourceforge.net/)以获得解决此问题的方法。

# c# - C# 将文本文件拆分为二维字符串数组

> ID：14407762
> 
> 赞同：3
> 
> 时间：2013-01-18T21:15:49.417
> 
> 标签：c#, arrays, string, parsing, split

我有一个看起来像这样的文本文件：

```
John,Gauthier,blue,May
Henry,Ford,Red,June
James,Bond,Orange,December 
```

我想将它拆分为一个二维字符串数组，这样我就可以将每行分开，然后将每个单词分开。前任：

```
mystring[0][0] = "John"
mystring[1][3] = "June"
mystring[2][2] = "Orange" 
```

这是我现在所做的：

```
string[] words = new string [100];
System.IO.StreamReader myfile = new System.IO.StreamReader("c:\\myfile.csv");

while (fichier.Peek() != -1)
{
  i++;
  words = myfile.ReadLine().Split(',');

} 
```

我被困住了。我可以将其拆分为一维字符串数组，但不能拆分为二维字符串数组。我想我需要拆分两次；第一次使用'\n'，第二次使用','，然后将两者放在一起。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T21:20:08.277

这实际上是一个单行：

```
File.ReadLines("myfilename.txt").Select(s=>s.Split(',')).ToArray() 
```

由于这是一个初学者问题，所以这是发生了什么：

File.ReadLines(filename) 返回文本文件中所有行的集合

.Select 是一个带有函数的扩展方法

s=>s.Split(',') 是函数，它将字符串 s 用所有逗号分割并返回一个字符串数组。

.ToArray() 获取由 .Select 创建的字符串数组的集合，并从中创建一个数组，因此您可以获得数组数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:22:39.440

试试这个

```
 var str = File.ReadAllText("myfile.csv");

 var arr = str.Split(new string[] {Environment.NewLine}, StringSplitOptions.RemoveEmptyEntries);

   var multi = arr.Select(x => x.Split(',')).ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:22:40.973

尝试：

```
var First = new string [100];
var Sec = new string [100];
System.IO.StreamReader myfile = new System.IO.StreamReader("c:\\myfile.csv");

while (fichier.Peek() != -1)
{
  i++;
  var buff = myfile.ReadLine().Split(',');
  First[i] = buff[0];
  Sec[i] = buff[1];
} 
```

其他想法，使用 XML 序列化器来序列化你的洞对象。对此的两个扩展：

```
 public static void SaveAsXML(this Object A, string FileName)
    {
        var serializer = new XmlSerializer(A.GetType());
        using (var textWriter = new StreamWriter(FileName))
        {
            serializer.Serialize(textWriter, A);
            textWriter.Close();
        }
    }

    public static void LoadFromXML(this Object A, string FileName)
    {
        if (File.Exists(FileName))
        {
            using (TextReader textReader = new StreamReader(FileName))
            {
                XmlSerializer deserializer = new XmlSerializer(A.GetType());
                A = (deserializer.Deserialize(textReader));
            }
        }
    } 
```

在任何静态类中添加比并调用：

```
YourSaveClassWhitchContainsYourArray.SaveAsXML("Datastore.xml"); 
```

或者

```
YourSaveClassWhitchContainsYourArray.LoadFromXML("Datastore.xml"); 
```

# python - 使用pypiserver安装Python egg文件

> ID：14407765
> 
> 赞同：1
> 
> 时间：2013-01-18T21:16:00.340
> 
> 标签：python, pip

我必须遗漏一些简单的东西，但我刚刚设置了一个 pypiserver (http://pypi.python.org/pypi/pypiserver) 并且无法使用它来安装 egg 文件。它将提供 tarball（tar.gz 文件），但似乎不是鸡蛋。当我通过“pip install”请求 egg 时，pypiserver 记录一个 HTTP 200（当我给它一个虚假的包名时它记录一个 303），但是 pip install 响应“No distributions at all found for”。

我错过了什么还是根本不支持？如果不是，对于快速简便的 pypi 服务器，推荐的替代方案是什么？似乎有几种选择。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:21:32.280

我认为 pip 总是下载源代码并编译它们。Easyinstall 也可以从鸡蛋安装。

参见[Pip 与 easyinstall 的比较](http://www.pip-installer.org/en/latest/other-tools.html#pip-compared-to-easy-install)：

> pip 并没有做 easy_install 所做的所有事情。具体来说：
> 
> 它不能从鸡蛋安装。它仅从源安装。（将来最好能从 Windows .exe 或 .msi 安装二进制文件——在其他平台上安装二进制文件不是优先事项。）

# c# - 流程管理库

> ID：14407766
> 
> 赞同：1
> 
> 时间：2013-01-18T21:16:03.040
> 
> 标签：c#, .net, web-services, process

我正在开发一个 OLAP 应用程序、WCF + Silverlight 客户端（最多 100 个并发用户）。不幸的是，一个特定的服务调用有时会发疯（尽管它完全有效，只是太复杂了）并且偶尔（每月一次）会导致整个服务器停机（通过消耗所有 CPU）。

解决方案将涉及杀死用户请求甚至整个用户会话，从业务角度来看，这对我们来说没什么大不了的 - 恢复/重新启动整个应用程序是。

将用户会话隔离到单独的进程中的想法非常诱人：CPU/内存节流和干净的资源处理（不像 Thread.Abort）——如果现代浏览器可以仅针对网页执行此操作，那么也许是时候在服务器上执行此操作了。我们只是想评估这个概念并在我们的特定场景中查看利弊。

因此，问题：

1.  是否已经有一个现有的库/框架可用于管理进程（如预生成/重用进程、限制、超时后终止）？
2.  是否有任何“最佳实践”或指南来创建这样的架构？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T05:41:31.723

我的 WCF 服务也有同样的问题，它们也为 100 多个客户端提供服务。我使用 IIS 日志（C:\Windows\System32\LogFiles\HTTPERR）发现的问题我在 IIS 设置的应用程序池回收超时中发现了我的问题. 应用程序池每 48 小时重新启动一次，这导致已订阅的客户端出现问题。所以我建议 1\. 分析 http 错误日志和 IIS 日志，如果有任何应用程序池被关闭或回收，它们将提供有关所有应用程序池状态的更多信息。2\. 如果应用程序池崩溃，则为 Windbg 设置并附加进程设置正确的源文件路径。如果发生任何异常，它将告诉您位置。

# python - Python .pyc 文件和 Windows UAC

> ID：14407779
> 
> 赞同：2
> 
> 时间：2013-01-18T21:16:51.240
> 
> 标签：python, installation, uac

我正在为 Windows 7 的 Python 应用程序开发 Inno Setup 安装程序，我有以下要求：

1.  该应用程序不应向安装目录写入任何内容
2.  它应该能够使用 .pyc 文件
3.  该应用程序不需要特定的 Python 版本，因此我不能只将一组 .pyc 文件添加到安装程序

有推荐的处理方法吗？就像给用户一种（重新）生成 .pyc 文件的方法？或者 .pyc 文件的启动时间较短通常不值得担心？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T01:52:45.627

重新阅读原始问题，有一个更简单的答案可能符合您的要求。

我对 Inno 了解不多，但大多数安装程序都为您提供了一种在复制后步骤中运行任意命令的方法。

因此，您可以在安装时使用它为您`python -m compileall`创建`.pyc`文件——同时您仍然拥有提升的权限，因此 UAC 没有问题。

实际上，如果您查看 .`pywin32`以及作为安装程序包提供的各种其他 Python 包，它们正是这样做的。这是将库安装到用户的 Python 安装中的惯用做法，所以我不明白为什么安装使用用户的 Python 安装的可执行文件被认为是不合理的。

当然，如果用户后来决定卸载 Python 2.6 并安装 2.7，您的`.pyc`文件将被冲洗掉……但从您的描述来看，听起来您的整个程序无论如何都会被冲洗掉，而为用户推荐的解决方案可能是卸载并无论如何都要重新安装，对吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T22:39:39.670

如果您还没有阅读[PEP 3147](http://www.python.org/dev/peps/pep-3147/)，那可能会回答您的问题。

我不是指该 PEP 中描述并从 Python 3.2 开始实施的解决方案。如果您的“多个 Python 版本”仅表示“3.2、3.3 和未来的 3.x”，那就太好了。或者即使它的意思是“2.6+ 和 3.1+，但我只关心 3.2 和 3.3，所以如果我没有得到其他的 pyc 加速也没关系”。

但是当我问你支持的版本时，你说“2.7”，这意味着你不能依靠 PEP 3147 来解决你的问题。

幸运的是，PEP 充满了对解决问题的早期尝试的讨论，以及每个问题的陷阱，并且应该有足够的内容来弄清楚选项是什么以及如何实施它们。

一个问题是 PEP 非常以 linux 为中心——主要是因为过去主要是 linux 发行版试图解决这个问题。（Apple 也这样做了，但他们的解决方案（a）几乎可以工作，并且（b）与整个 Mac 特定的“框架”紧密耦合，所以它们大多被忽略了......）

因此，它在很大程度上留下了“我应该将 .pyc 文件放在 Windows 的什么位置？”的问题。

最好的选择可能是用户本地应用程序数据目录下的特定于应用程序的目录。如果您需要 Vista 或更高版本，请参阅[已知文件夹，如果不能，请参阅](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776911%28v=vs.85%29.aspx)[CSIDL](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762494%28v=vs.85%29.aspx)。无论哪种方式，您都在寻找 FOLDERID_LocalAppData 或 CSIDL_LOCAL_APPDATA，即：

> 用作本地（非漫游）应用程序的数据存储库的文件系统目录。一个典型的路径是`C:\Documents and Settings\username\Local Settings\Application Data`。

关键是它是应用程序存储数据的地方，这些数据对于每个用户（以及在该用户的配置文件目录中）以及用户的漫游配置文件可能最终出现的每台机器都是分开的，这意味着您可以安全地把东西放在那里并知道用户有权在没有 UAC 参与的情况下在那里写入，并且（尽可能地）知道其他用户或机器不会干扰那里的内容。

在该目录中，您为您的程序创建一个目录，并在其中放置您想要的任何内容，只要您选择了一个唯一的名称（例如，`My Unique App Name`或`My Company Name\My App Name`或 UUID），您就不会与其他程序发生意外冲突。（以前在 MSDN 中对此有具体的指导，但我再也找不到了。）

那么，如何进入该目录？

最简单的方法是只使用 env 变量`%LOCALAPPDATA%`。如果您需要处理较旧的 Windows，您可以使用`%USERPROFILE%`并`\Local Settings\Application Data`粘贴到最后，这可以保证是相同的，或者通过连接在同一个地方结束。

您还可以使用[`pywin32`](http://sourceforge.net/projects/pywin32/)或`ctypes`访问本机 Windows API（因为至少有 3 种不同的 API 和至少两种访问这些 API 的方法，我不想给出所有可能的方法来编写这个……但是快速谷歌或搜索“pywin32 SHGetFolderPath”或“ctypes SHGetKnownFolderPath”或任何应该给你你需要的东西）。

或者，有多个第三方模块来处理这个问题。Google 和 PyPI 出现的第一个是[`winshell`](http://pypi.python.org/pypi/winshell/0.6).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:16:18.983

不保证 PYC 文件与不同的 python 版本兼容。如果您不知道所有客户都运行相同的 python 版本，那么您真的不想直接分发 pyc。因此，您必须在分发 PYC 和支持多个 python 版本之间做出选择。

您可以创建构建过程，使用[py_compile](http://docs.python.org/2/library/py_compile.html)编译所有文件并将它们压缩到特定于版本的包中。您可以使用[setuptools 执行此操作。](https://stackoverflow.com/questions/5730686/installing-only-pyc-python-compiled-with-setuptools); 但是这样做会很尴尬，因为您必须在需要支持的每个版本中运行 py_compile。

如果您基本上是在分发一个封闭的应用程序并且不希望人们对您的源代码进行微不足道的访问，那么[py2exe](http://www.py2exe.org/)可能是一个更简单的选择。如果您的 python 应该集成到用户的 python 安装中，那么只需创建一个 .py 文件的 zip 并添加一个使用[zipfile导入压缩包的单行 .py 存根可能会更简单](http://docs.python.org/2/library/zipfile)

如果它让你感觉更好，PYC 不会提供太多额外的安全性，也不会真正提高性能:)

# javascript - Jquery 仅在 ie8 中不工作，所有其他浏览器工作正常

> ID：14407780
> 
> 赞同：-2
> 
> 时间：2013-01-18T21:17:17.453
> 
> 标签：javascript, jquery, ajax

在这里，我尝试使用 Ajax 加载一些数据。在 IE 9 和所有其他浏览器中工作正常。但在 IE8 中它总是会被捕获。我不明白为什么它总是引发异常。

这是我的代码。

```
var SyncResponseText = "";

var WrapedRequestObject = JSON.stringify(RstClientServerDTO);

try {
    SyncResponseText = eval($.ajax({
        type: "POST",
        contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
        url: "../../ApplicationServiceHandler/ClientRequestHandler.ashx",
        data: WrapedRequestObject,
        timeout: 240000,
        dataType: "json",
        async: IsAssync,
        success: function (msg) {

//                if (msg == false) {
//                    window.location.href = window.location.href;
//                }
//                else {
                SuccessCallBack(msg);
//                }

        }, // function (data) { alert('success') },
        error: function (xhr, textstatus, error) { ErrorCallBack(xhr, textstatus,         error) } // { alert('error') }
    }).responseText);
}
catch (Exception) {
    SyncResponseText = Exception.get_Message();
}

return SyncResponseText; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:21:03.270

不要使用`eval`. 你的那部分代码没有意义。

# angularjs - 如何使用位于不同模块中的指令

> ID：14407782
> 
> 赞同：10
> 
> 时间：2013-01-18T21:17:19.243
> 
> 标签：angularjs, angular-directive, angular-module

```
angular.module('mod1', [])
  .directive('myDir', ($timeout) => {
    return {
      ///....
    }
  });

angular.module('myApp', ['mod1']) 
```

```
<html ng-app="myApp">

<body>
  <my-dir valu='blablabla' />
</body>

</html> 
```

那么为什么这行不通呢？并说 Unknown provider: `$compileProvider`,

但是如果我将指令移到`myApp`模块中它可以工作

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-27T18:26:57.443

我认为只要正确提供了模块依赖项，它就应该可以正常工作！

看看这个：[http ://plnkr.co/edit/Wvb7melvMOgXh3FyoVnx?p=preview](http://plnkr.co/edit/Wvb7melvMOgXh3FyoVnx?p=preview)

# spring - 未收到 Spring Framework 3.0 JMX 通知

> ID：14407788
> 
> 赞同：0
> 
> 时间：2013-01-18T21:17:26.227
> 
> 标签：spring, spring-jmx

我的配置 XML：appconfig.xml

```
<beans xmlns="...">

   <context:mbean-server/>
   <bean id="exporter" class="org.springframework.jmx.export.MBeanExporter" lazy-init="false">
        <property name="beans">
            <map>
                <entry key="bean:name=notificationSender" value-ref="notificationSenderImpl"></entry>
                <entry key="bean:name=notificationListener" value-ref="notificationListenerImpl"></entry>
            </map>
        </property>
    <property name="notificationListenerMappings">
                    <map>
                <entry key="notificationListenerImpl" value-ref="notificationListenerImpl"></entry>
            </map>              
        </property>

        <property name="server" ref="mbeanServer"/>    
    </bean>
    <bean id="notificationSender" class="com....NotificationSenderImpl"/>
    <bean id="notificationListener" class="com....NotificationListenerImpl"/> 
```

我的代码：Test.java

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration("classpath:appconfig.xml")
public class Test {
    @Autowired
    private ConfigurableApplicationContext context;

    @Test
    public void testFlow() {
        NotificationSender sender = (NotificationSender) context.getBean("notificationSender");     
                sender.send();
    }

    @After
    public void tearDown(){
        context.close();
    }

} 
```

类 NotificationSenderImpl.java

```
public class NotificationSenderImpl implements NotificationPublisherAware{

       private NotificationPublisher notificationPublisher; 

    public void setNotificationPublisher(NotificationPublisher notificationPublisher) {
        // TODO Auto-generated method stub
        this.notificationPublisher = notificationPublisher;     
    }

    public void send(){
        notificationPublisher.sendNotification(new Notification("simple", this, 0L));
    }
} 
```

和监听器...类 NotificationListenerImpl

```
public class NotificationListenerImpl implements NotificationListener{

    public void handleNotification(Notification notification, Object handback) {

        // TODO Auto-generated method stub
        System.out.println("Notification received");
    }

} 
```

正在发送通知但未收到通知。任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T15:13:57.720

不确定您是否已解决此问题，但我会看看是否可以提供帮助。我最近一直在玩 spring/JMX 并且还是新手，但希望我能分享一些见解。

我认为您不需要将侦听器声明为要导出的 MBean，只需将要发布通知的 bean 声明。其次，我认为 notificationListenerMappings 中的键是 MBean 的 ObjectName，而不是对侦听器 bean 本身的引用。换句话说..

```
<bean id="exporter" class="org.springframework.jmx.export.MBeanExporter" lazy-init="false">
    <property name="beans">
        <map>
            <entry key="bean:name=notificationSender" value-ref="notificationSenderImpl"></entry>
        </map>
    </property>
    <property name="notificationListenerMappings">
        <map>
            <entry key="bean:name=notificationSender" value-ref="notificationListenerImpl"></entry>
        </map>              
    </property>
    <property name="server" ref="mbeanServer"/>    
</bean> 
```

您还可以使用通配符作为侦听器映射键。这是我自己的 MBeanExporter 的一个示例，它从我的所有注释声明的 MBean 中获取通知：

```
<bean id="exporter" class="org.springframework.jmx.export.MBeanExporter">
    .
    .
    .
    <property name="notificationListenerMappings">
        <map>
            <entry key="*">
                <bean class="com.poc.jmx.domain.NotificationBroadcastListener" />
            </entry>
        </map>
    </property>
</bean> 
```

希望有帮助。

# file - 在vb6中写入文件的最简单方法？

> ID：14407793
> 
> 赞同：-4
> 
> 时间：2013-01-18T21:17:34.653
> 
> 标签：file, file-io, vb6

我知道如何在 vb6 中写入文件，但问题是在我的文件中有很多 (") 和很多行。我不想使用 vbcrlf 输入或 """ 给出 " 结果。有没有简单的方法来制作文件在 vb6 中不使用复杂的东西，如 vbcrlf 或 _ 等。

我想要准确输入数据的方式，而不需要对倒逗号或结束线有任何困难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T01:59:27.847

如果您需要处理大量文字文本，则将它们创建为与程序一起分发的单独文本文件可能会更容易。在运行时根据需要阅读和使用它们。

如果您需要将这些嵌入程序中，您可以将它们存储为自定义资源，以 Unicode 或 ANSI 格式，并在使用`LoadResData()`调用检索数据后适当转换为 Unicode。

避免`LoadResString()`使用它来本地化应用程序文本，这完全是另一个主题。

不过，大多数程序不需要这么多样板文本。它对于长 SQL 语句或 XML 数据文件的模板很有用。可以通过`Replace$()`在其中插入目标（“变量”）来处理简单的模板，例如`$PATH$`or`$V1$`等​​，然后在运行时插入您的唯一信息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-18T21:57:39.833

此页面上不存在任何问题。你的标题，`The easiest way to write files in vb6?`不是一个完整的句子。如果我尝试解析我会考虑文件 I/O，但在您的消息正文中没有任何内容。

在您的消息中，您提到了 vbcrlf、“和 _。我假设您遇到了一些问题，因为编辑器将其中一些字符识别为 VB 语法的一部分。”和 _ 可能（可能？）很难放入在代码中。

这是一个解决方案（再次，如果我理解正确的话）。您可以使用函数从 ascii 字符代码中检索字符。例如， " 是 ascii 代码 34。函数 Chr() 采用 ascii 字符代码并返回一个字符。如果你这样写：

```
Dim name As String
name = Chr(34) & "Sam" & Chr(34) 
```

名称看起来像带有引号的“Sam”。这克服了 VB 将双引号识别为语法的问题。

vbcr 通常是 Chr(13)，即回车，后跟 Chr(10)，换行

_ 是 Chr(95)

您可以在此处查看完整列表： [asciitable.com](http://www.asciitable.com/)

# javascript - 价值观正在结合

> ID：14407795
> 
> 赞同：0
> 
> 时间：2013-01-18T21:17:38.147
> 
> 标签：javascript, ajax

`我有一个脚本返回正确的值，除了一个小问题。Lid 返回 892，这是正确的，但是；Cid 应该返回 16 它返回 89216 两者的组合。我怎样才能让 Cid 返回 16？

```
 $(document).ready(function()
{

$(".Doggie").change(function()
{
    var LocationString ='Lid='+ $(this).val();
    $.ajax({
        type: "POST",
        url: "ajax_city.php",
        data: LocationString,
        cache: false,
        success: function (html) {
            $(".Kitty").html(html);
        }
    });
});

$('.Kitty').live("change",function(){
    var Lid = $('#Doggie').val(),  // This is the value of the id="Doggie" selected option
    Cid = $(this).val(); // This is the value of the id="Kitty" selected option
$.ajax({
        type: "POST",
        url: "ajax_area.php",
        data: {"Lid":Lid,"Cid":Cid}, 
        cache: false,
        success: function (html) {                         
$(".Pig").html(html);
} 
});

});

});
 </script>
</head>
<body>

<div id="frame1">
  <label>Place :</label>
    <select name="Doggie" class="Doggie" id="Doggie">
    <option selected="selected">--Select Place--</option>
        <?php
                $sql = mysql_query("SELECT tblLocations.RestID as Lid, tblRestaurants.RestName as name
            FROM tblRestaurants INNER JOIN tblLocations ON tblRestaurants.RestID = tblLocations.RestID
            GROUP BY tblLocations.RestID, tblRestaurants.RestName
            ORDER BY tblRestaurants.RestName ASC");
        while($row=mysql_fetch_array($sql))
        {
        echo '<option value="'.$row['Lid'].'">'.$row['name'].'</option>';
            } ?>
         </select>
        <label>City :</label>
        <select name="Kitty" class="Kitty" id="Kitty">
        <option selected="selected">--Select City--</option>
        </select>
        <label>Area: :</label>
        <select name="Pig" class="Pig" id="Pig">
        <option selected="selected">--Select Area--</option>
        </select>
        </div>

</body>
</html> 
```

ajax_city.php

```
 <?php
require('config.php');

if($_POST['Lid'])
{
$Lid=$_POST['Lid'];
//$Cid=$_POST['Cid'];

$sql=mysql_query("SELECT tblLocations.RestId as Lid, tblLocations.CityID as Cid, tblCities.CityName as name
            FROM tblLocations INNER JOIN tblCities ON tblLocations.CityID = tblCities.CityID
            WHERE tblLocations.RestID = $Lid
            GROUP BY tblLocations.RestID, tblCities.CityName
            ORDER BY tblCities.CityName ASC");

echo '<option selected="selected">--Select City--</option>';
while($row=mysql_fetch_array($sql))
{
echo '<option value="'.$row['Lid'].''.$row['Cid'].'">'.$row['name'].'</option>';
}
}

?> 
```

ajax_area.php

```
 <?php
require('config.php');

if($_POST['Lid'])
{
//$Lid=$_POST['Lid'];
 $Cid=$_POST['Cid'];

$sql=mysql_query("SELECT tblLocations.RestId as Lid, tblLocations.CityID as Cid, tblAreas.AreaName as name
            FROM tblLocations INNER JOIN tblAreas ON tblLocations.AreaID = tblAreas.AreaID
            WHERE tblLocations.RestID = $Lid AND tblLocations.CityID = $Cid
            GROUP BY tblLocations.RestID, tblAreas.AreaName
            ORDER BY tblAreas.AreaName ASC");

echo '<option selected="selected">--Select Area--</option>';
while($row=mysql_fetch_array($sql))
{
echo '<option value="'.$row['Lid'].''.$row['Cid'].'">'.$row['name'].'</option>';
}
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:56:56.310

正是 ajax-city.php 文件中的这两行。

```
"SELECT tblLocations.CityId as Cid, tblCities.CityName as name 
```

和

```
echo '<option value="'.$row['Cid'].'">'.$row['name'].'</option>'; 
```

# java - 如何更改 JOptionPane.showInputDialog 中按钮的默认文本

> ID：14407804
> 
> 赞同：14
> 
> 时间：2013-01-18T21:18:38.120
> 
> 标签：java, swing, joptionpane

我想将 OK 和 CANCEL 按钮的文本设置`JOptionPane.showInputDialog` 为我自己的字符串。

有一种方法可以在 中更改按钮的文本`JOptionPane.showOptionDialog`，但我找不到在 中更改它的方法`showInputDialog`。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-19T01:18:23.487

如果您不希望它仅用于单个 inputDialog，请在创建对话框之前添加这些行

```
UIManager.put("OptionPane.cancelButtonText", "nope");
UIManager.put("OptionPane.okButtonText", "yup"); 
```

其中 'yup' 和 'nope' 是您要显示的文本

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-18T21:54:30.260

下面的代码应该会出现一个对话框，您可以在`Object[]`.

```
Object[] choices = {"One", "Two"};
Object defaultChoice = choices[0];
JOptionPane.showOptionDialog(this,
             "Select one of the values",
             "Title message",
             JOptionPane.YES_NO_OPTION,
             JOptionPane.QUESTION_MESSAGE,
             null,
             choices,
             defaultChoice); 
```

此外，请务必查看 Oracle 站点上的 Java 教程。我在教程[http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#create的这个链接上找到了解决方案](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#create)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-18T21:55:46.423

如果您想要带有自定义按钮文本的 JOptionPane.showInputDialog，您可以扩展 JOptionPane：

```
public class JEnhancedOptionPane extends JOptionPane {
    public static String showInputDialog(final Object message, final Object[] options)
            throws HeadlessException {
        final JOptionPane pane = new JOptionPane(message, QUESTION_MESSAGE,
                                                 OK_CANCEL_OPTION, null,
                                                 options, null);
        pane.setWantsInput(true);
        pane.setComponentOrientation((getRootFrame()).getComponentOrientation());
        pane.setMessageType(QUESTION_MESSAGE);
        pane.selectInitialValue();
        final String title = UIManager.getString("OptionPane.inputDialogTitle", null);
        final JDialog dialog = pane.createDialog(null, title);
        dialog.setVisible(true);
        dialog.dispose();
        final Object value = pane.getInputValue();
        return (value == UNINITIALIZED_VALUE) ? null : (String) value;
    }
} 
```

你可以这样称呼它：

```
JEnhancedOptionPane.showInputDialog("Number:", new Object[]{"Yes", "No"}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-18T21:22:04.373

请参阅[如何制作对话框：自定义按钮文本](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html#button)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-18T21:22:03.217

在谷歌中搜索“自定义文本 JOptionPane”揭示了这个答案 [https://stackoverflow.com/a/8763349/975959](https://stackoverflow.com/a/8763349/975959)

# asp.net-mvc - 回发不包含模型数据

> ID：14407807
> 
> 赞同：0
> 
> 时间：2013-01-18T21:18:51.397
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我的表单在回发时没有收到我的任何模型信息。我试图越来越多地注释掉它以使其变得简单，以便我可以看到它何时起作用，但到目前为止我没有运气。我已经注释掉了表单和模型的大部分复杂部分，所以我不知道我为什么会遇到问题。

下面是显示表单和发布表单的控制器功能

```
public ActionResult MassEmail()
    {
        IEmailTemplateRepository templates = new EmailTemplateRepository();
        IEmailFromAddressRepository froms = new EmailFromAddressRepository();
        IEmployeeRepository emps = new EmployeeRepository();
        List<ProductVersion> vers = new List<ProductVersion>();
        MassEmailViewModel vm = new MassEmailViewModel();

        vers = productVersionRepository.All.OrderBy(o => o.Description).ToList();

        foreach (Employee e in emps.Employees.Where(o => o.Department == "Support" || o.Department == "Professional Services").OrderBy(o => o.Name))
        {
            if (e.Email != null && e.Email.Trim() != "")
            {
                vm.BCCAddresses = vm.BCCAddresses + e.Email + ","; 
            }
        }
        if (vm.BCCAddresses != "")
        {
            vm.BCCAddresses = vm.BCCAddresses.Substring(0, vm.BCCAddresses.Length - 1);
        }

        ViewBag.PossibleCustomers = customerRepository.All.OrderBy(o => o.CustomerName);
        ViewBag.PossibleTemplates = templates.All.OrderBy(o => o.Description);
        ViewBag.PossibleFromAddresses = froms.All.OrderBy(o => o.Description);
        ViewBag.PossibleClasses = scheduledClassRepository.All.OrderByDescending(o => o.ClassDate).ThenBy(o => o.ClassTopic.Description);

        vm.CCAddresses = "bclairmont@harrisworld.com";
        //vm.Attachments = "";
        vm.Body = "";
        vm.Subject = "";
        vm.ToAddresses = "";
        vm.EmailFromAddressID = 1;

        return View(vm);
    }

    [HttpPost]
    public ActionResult MassEmail(MassEmailViewModel vm)
    {
        IEmailFromAddressRepository froms = new EmailFromAddressRepository();

        System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage();

        message.From = new System.Net.Mail.MailAddress(froms.Find(vm.EmailFromAddressID).Email);

        string[] toAddresses = vm.ToAddresses.Split(',');
        for (int i = 0; i < toAddresses.GetUpperBound(0); i++)
        {
            message.To.Add(new System.Net.Mail.MailAddress(toAddresses[i]));
        }

        string[] CCAddresses = vm.CCAddresses.Split(',');
        for (int i = 0; i < CCAddresses.GetUpperBound(0); i++)
        {
            message.To.Add(new System.Net.Mail.MailAddress(CCAddresses[i]));
        }

        string[] BCCAddresses = vm.BCCAddresses.Split(',');
        for (int i = 0; i < BCCAddresses.GetUpperBound(0); i++)
        {
            message.To.Add(new System.Net.Mail.MailAddress(BCCAddresses[i]));
        }
        message.IsBodyHtml = true;
        message.BodyEncoding = Encoding.UTF8;
        message.Subject = vm.Subject; 
        message.Body = vm.Body;

        for (int i = 0; i < Request.Files.Count; i++)
        {
            HttpPostedFileBase file = Request.Files[i];
            message.Attachments.Add(new Attachment(file.InputStream, file.FileName));
        }

        System.Net.Mail.SmtpClient client = new System.Net.Mail.SmtpClient();
        client.Send(message);

        return RedirectToAction("MassEmail");
    } 
```

接下来是我的视图的代码

```
@model TRIOSoftware.WebUI.Models.MassEmailViewModel

@{
    ViewBag.Title = "MassEmail";
}

@using (Html.BeginForm())
{
    <h1 class="align-right">Mass E-Mail</h1>

    <br />
    <br />

 <div>
<div class="editor-label" style="float:left; width:90px">
    From
</div>
<div class="editor-field" style="float:left">
    @Html.DropDownListFor(model => model.EmailFromAddressID,   
((IEnumerable<TRIOSoftware.Domain.Entities.EmailFromAddress>)
ViewBag.PossibleFromAddresses).OrderBy(m => m.Description).Select(option => new 
SelectListItem
{
   Text = option.Description.ToString(),
   Value = option.ID.ToString(),
   Selected = (Model != null) && (option.ID == Model.EmailFromAddressID)
}), "Choose...")  
</div>
</div>

<div class= "TagitEmailAddress" style="width:100%">
<div class="editor-label" style="float:left; clear:left;  width:90px">
    To
</div>
<div class="editor-field" style="float:left; width:88%">
    @Html.TextBoxFor(model => model.ToAddresses, new { @class = "TagTextBox" })
</div>
</div>

<div class= "TagitEmailAddress" style="width:100%">
<div class="editor-label" style="float:left; clear:left; width:90px">
    CC
</div>
<div class="editor-field" style="float:left; width:88%">
    @Html.TextBoxFor(model => model.CCAddresses, new { @class = "TagTextBox" })
</div>
</div>

<div class= "TagitEmailAddress" style="width:100%">
<div class="editor-label" style="float:left; clear:left; width:90px">
    <input type="button" id="BCC" value="BCC" class="btn"/>
</div>
<div class="editor-field" style="float:left; width:88%">
    @Html.TextBoxFor(model => model.BCCAddresses, new { @class = "TagTextBox" })
</div>
</div>

<div style="width:100%">
<div style="float:left; clear:left; width:90px">
    <input type="button" id="Subject" value="Subject" class="btn"/>
</div>
<div style="float:left; width:88%">
    @Html.TextBoxFor(model => model.Subject, new { id = "SubjectText", style =  
    "width:100%" })
</div>
</div>

<div style="width:100%">
<div style="clear:left; float:left; width:100%;">
    <div class="editor-field" style="float:left; width:100%;">
        @Html.TextAreaFor(model => model.Body, new { id = "BodyText" })
    </div>
</div>
</div>

<br />
<br />
<br />

<p style="clear:both">
    <input type="submit" value="Send E-Mail" class="btn btn-primary"/>
</p>

<div id="DefaultEmailText">
<div class="editor-label" style="float:left; width:150px">
    E-Mail Template
</div>
<div class="editor-field" style="float:left; padding-left:10px">
    @Html.DropDownList("EmailTemplate",  
   ((IEnumerable<TRIOSoftware.Domain.Entities.EmailTemplate>)
   ViewBag.PossibleTemplates).Select(option => new SelectListItem
   {
       Text = option.Description,
       Value = option.ID.ToString(),
       Selected = false
   }), "Choose...", new { ID = "Template", style = "width:200px" })    
</div>
</div>
}

@section sidemenu {
    @Html.Action("EmailsSideMenu", "Admin")
}

<script type="text/javascript">
var TemplateSubject = "";
var TemplateBody = "";

$(document).ready(function () {

    $('#attach').MultiFile({
        STRING: {
            remove: '<i style="color:Red" class="icon-remove-sign"></i>'
        }
    }); 

    $(".TagTextBox").tagit();

    $("#BodyText").cleditor({
        width: 800,
        height: 400
    });

    $("#DefaultEmailText").dialog({
        autoOpen: false,
        height: 150,
        width: 250,
        title: "Default Subject / Body",
        modal: true,
        buttons: {
            OK: function () {
                var selectedTemplate = $("#DefaultEmailText #Template").val();
                if (selectedTemplate != null && selectedTemplate != '') {
                    $.getJSON('@Url.Action("GetTemplate", "EmailTemplates")', { id: 
                      selectedTemplate }, function (template) {
                        $("#SubjectText").val(template[0].Subject);
                        $("#BodyText").val(template[0].Body).blur(); 
                    });
                }
                $(this).dialog("close");
            },
            Cancel: function () {
                $(this).dialog("close");
            }
        }
    });

    $('#Subject').click(function () {
        $("#DefaultEmailText").dialog("open");
    });

});

</script> 
```

当我提交时，我得到所有空值，除了 EmailFromAddressID 为 0，即使 ti 在视图加载时默认为 1。

有任何想法吗？

EDIT_ ***_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* __ *_* _** 我查看了 Chrome 的 DevConsole，在网络下我可以看到我的帖子请求。以下是它包含的详细信息。在我看来，数据确实已发送到服务器，所以我不知道为什么服务器无法填写我的模型类

```
Request URL:http://localhost:53730/Customers/MassEmail
Request Headersview source
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Content-Type:application/x-www-form-urlencoded
Origin:http://localhost:53730
Referer:http://localhost:53730/Customers/MassEmail
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.17 (KHTML, like Gecko) 
Chrome/24.0.1312.52 Safari/537.17

Form Dataview sourceview URL encoded
EmailFromAddressID:1
ToAddresses:
CCAddresses:bclairmont@harrisworld.com
BCCAddresses:adunn@harrisworld.com,bclairmont@harrisworld.com,
bkelly@harrisworld.com,bhackett@harrisworld.com,jwade@harrisworld.com,
krichter@harrisworld.com,mroy-waters@harrisworld.com,
nburckhard@harrisworld.com,rlibby@harrisworld.com
Subject:Testing
Body: 
```

这是从客户端到服务器来回传递的类，以防万一

```
public class MassEmailViewModel
{
    //public MassEmailViewModel()
    //{
    //    ComplexQuery = new CustomerQueryViewModel(); 
    //}

    public int EmailFromAddressID;

   // public CustomerQueryViewModel ComplexQuery;

    public string ToAddresses;
    public string CCAddresses;
    public string BCCAddresses;
    public string Subject;
    public string Body;
    //public string Attachments;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:14:16.280

1）您是否尝试过指定模型将提交到的控制器的路由？我的意思是，像这样声明表格：

```
@using (Html.BeginForm("YourAction","YourController", FormMethod.Post)) 
```

2) 为什么不创建一个简单的“获取”操作来返回强类型视图和一个“发布”操作，该操作接收与您在视图中添加的信息相同的模型。一旦你完成了这项工作，你就可以开始添加额外的代码，这样就很容易解决问题。

3) 确保所有助手都在表格内。

4) 您是否配置了可以使您的帖子被重定向到另一个区域、控制器或操作的路由规则？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T06:30:50.337

`DefaultModelBinder`需要**公共属性**而不是公共字段。

将您的字段更改为属性，它应该可以工作：

```
public class MassEmailViewModel
{
    public int EmailFromAddressID { get; set; }

    public string ToAddresses { get; set; }
    public string CCAddresses { get; set; }
    public string BCCAddresses { get; set; }
    public string Subject { get; set; }
    public string Body { get; set; }
} 
```

# list - Common Lisp 从 alist 返回关联作为新列表

> ID：14407812
> 
> 赞同：1
> 
> 时间：2013-01-18T21:19:10.520
> 
> 标签：list, lisp, common-lisp, key-value-store

我有一个关联列表如下：

```
(defparameter *experts2*
  `(
    ;; direction
    (:direction . ( (nn-direction-expert (process-signal) :number-of-neighbors 10)
                    (fn-direction-expert (process-signal) :number-of-neighbors 10) ))

    ;; evaluation
    (:evaluation . ( 

                    ;(avoid-line-crossing-evaluation-expert (process-signal))
                    (nn-single-evaluation-expert (candidate-point))
                    (fn-single-evaluation-expert (candidate-point))
                    ;(nn-all-evaluation-expert (ranking))
                    ))

    ;; coordination
    (:coordination . (
                      ;(ranking-process (candidate-point))
                      (action-process (candidate-point ranking)))))) 
```

我正在寻找一种方法，从 key=>value 列表中提取值并将它们放入一个新列表中，例如

```
(defparameter *experts*
  `(
    ;; direction
    (nn-direction-expert (process-signal) :number-of-neighbors 10)
    (fn-direction-expert (process-signal) :number-of-neighbors 10)

    ;eher als evaluationsexperte
    ;(avoid-line-crossing-evaluation-expert (process-signal) )

    ;; evaluation
    (nn-single-evaluation-expert (candidate-point))
    (fn-single-evaluation-expert (candidate-point))
    ;(nn-all-evaluation-expert (ranking))

    ;; coordination
    ;(ranking-process (candidate-point))
    (action-process (candidate-point ranking))
    )) 
```

有什么建议么？谢谢你的帮助。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:55:05.770

这似乎产生了你想要的答案，但它似乎不是很漂亮：

```
(mapcan #'copy-list (mapcar #'cdr *experts2*)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T05:42:47.220

塞缪尔·埃德温·沃德（Samuel Edwin Ward）的答案有效，但这是另一个（现在已编辑以实际执行您需要的操作）。因此，您希望，对于 的每个元素`*experts2*`，获取其`cdr`，然后从返回的列表中获取值并将它们组合成一个列表：

```
(apply #'append (mapcan #'cdr *experts2*)) 
```

# javascript - DOM 元素的 JavaScript 相等运算符是否跨浏览器？

> ID：14407814
> 
> 赞同：6
> 
> 时间：2013-01-18T21:19:13.870
> 
> 标签：javascript, cross-browser, equality, dom

是否会在所有浏览器中正确运行 DOM 元素`==`？`===`如果代码以两种不同的方式获取对原始 DOM 元素的引用，它们在所有浏览器中是否都`==`相同`===`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:42:22.847

> == 和 === 在所有 DOM 元素的浏览器中都能正常工作吗？

是的，这些相等运算符将按照 ECMAScript 标准的定义工作。

需要注意的是，`==`通常会做一些开发人员没有预料到的事情，例如与字符串值相比时转换为字符串。这将使以下陈述成立，尽管它可能不是预期的结果：

```
document.createElement('div') == '[object HTMLDivElement]' 
```

在大多数情况下，您需要使用`===`运算符。

# css - Apache Batik 中的 querySelector

> ID：14407817
> 
> 赞同：2
> 
> 时间：2013-01-18T21:19:22.937
> 
> 标签：css, dom, batik

我想在 Apache Batik DOM 中查询与 CSS 选择器匹配的元素。

Batik 是否提供以下任何浏览器 DOM 方法的替代方法？

*   [Document.querySelector](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelector)
*   [Document.querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)
*   [Element.querySelector](https://developer.mozilla.org/en-US/docs/DOM/Element.querySelector)
*   [Element.querySelectorAll](https://developer.mozilla.org/en-US/docs/DOM/Element.querySelectorAll)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T23:23:48.187

好的，这是我设法放在一起的解决方案。它是用 Clojure 而不是 Java 编写的，但重要的部分是：

1.  实例化 org.apache.batik.css.engine.sac.CSSConditionFactory
2.  实例化 org.apache.batik.css.parser.Parser
3.  调用 Parser.parseSelectors
4.  调用 org.apache.batik.dom.traversal.TraversalSupport.createNodeIterator
5.  在您的 NodeFilter 中，遍历已解析的 SelectorList，调用 ExtendedSelector.match
6.  有条件地跳过从迭代器返回的第一个节点（它总是遍历根）

```
(def ^:private condition-factory
  (CSSConditionFactory. nil "class" nil "id"))

(defn- parse-selector [selector]
  (let [parser (Parser.)]
    (doto parser
      (.setSelectorFactory CSSSelectorFactory/INSTANCE)
      (.setConditionFactory condition-factory))
    (.parseSelectors parser selector)))

(defn- matches?
  ([selector element] (matches? selector element ""))
  ([selector element pseudo]
   (let [length (.getLength selector)]
     (loop [i 0]
       (if (< i length)
         (if (.. selector (item i) (match element pseudo))
           true
           (recur (inc i)))
         false)))))

(defn selection-seq [root selector]
  (let [selector (parse-selector selector)
        iterator (.createNodeIterator (TraversalSupport.)
                   (.getOwnerDocument root)
                   root
                   NodeFilter/SHOW_ELEMENT
                   (reify NodeFilter
                     (acceptNode [_ element]
                       (if (matches? selector element)
                         NodeFilter/FILTER_ACCEPT
                         NodeFilter/FILTER_REJECT)))
                   false)
        node-seq ((fn step []
                    (lazy-seq
                      (when-let [node (.nextNode iterator)]
                        (cons node (step))))))]
    ;; Iterator always returns the reference node, so match it.
    (when-let [node (first node-seq)]
      (if (matches? selector (first node-seq))
        node-seq
        (next node-seq))))) 
```

# c# - C# Regex - 如何从字符串中删除多个成对的括号

> ID：14407821
> 
> 赞同：12
> 
> 时间：2013-01-18T21:19:38.480
> 
> 标签：c#, regex, parentheses

我试图弄清楚如何使用 C# 正则表达式从字符串中删除所有实例配对括号。括号和它们之间的所有文本都应该被删除。括号并不总是在同一行。此外，它们可能是嵌套括号。字符串的一个例子是

```
This is a (string). I would like all of the (parentheses
to be removed). This (is) a string. Nested ((parentheses) should) also
be removed. (Thanks) for your help. 
```

所需的输出应如下所示：

```
This is a . I would like all of the . This  a string. Nested  also
be removed.  for your help. 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-18T21:26:31.923

幸运的是，.NET 允许在正则表达式中递归（请参阅[平衡组定义](http://msdn.microsoft.com/en-us/library/bs2twtah.aspx#balancing_group_definition)）：

```
Regex regexObj = new Regex(
    @"\(              # Match an opening parenthesis.
      (?>             # Then either match (possessively):
       [^()]+         #  any characters except parentheses
      |               # or
       \( (?<Depth>)  #  an opening paren (and increase the parens counter)
      |               # or
       \) (?<-Depth>) #  a closing paren (and decrease the parens counter).
      )*              # Repeat as needed.
     (?(Depth)(?!))   # Assert that the parens counter is at zero.
     \)               # Then match a closing parenthesis.",
    RegexOptions.IgnorePatternWhitespace); 
```

如果有人想知道：“parens counter”可能永远不会低于零（`<?-Depth>`否则会失败），所以即使括号是“平衡的”但没有正确匹配（如`()))((()`），这个正则表达式也不会被愚弄。

有关更多信息，请阅读 Jeffrey Friedl 的优秀著作[“掌握正则表达式”](http://shop.oreilly.com/product/9780596002893.do)（第 436 页）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:26:38.963

不过，您可以反复替换`/\([^\)\(]*\)/g`为空字符串，直到找不到更多匹配项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:30:38.410

通常，这不是一种选择。但是，Microsoft 确实对标准正则表达式进行了一些扩展。即使将算法编码为算法比阅读和理解 Microsoft 对其扩展的解释更快，您也可以使用[Grouping Constructs来实现这一点。](http://msdn.microsoft.com/en-us/library/bs2twtah.aspx#balancing_group_definition)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:28:29.643

这个怎么样：Regex Replace 似乎可以解决问题。

```
string Remove(string s, char begin, char end)
{
    Regex regex = new Regex(string.Format("\\{0}.*?\\{1}", begin, end));
    return regex.Replace(s, string.Empty);
}

string s = "Hello (my name) is (brian)"
s = Remove(s, '(', ')'); 
```

输出将是：

```
"Hello is" 
```

# ruby-on-rails - Rails 3 接受_nested_attributes_for 和 has_many ：通过关系

> ID：14407822
> 
> 赞同：0
> 
> 时间：2013-01-18T21:19:39.743
> 
> 标签：ruby-on-rails, nested-attributes, has-many, rails-activerecord

我正在构建一个用户管理系统，并且从一个用于身份验证的设备开始。

该系统将允许用户拥有自己的个人资料，以及家属（子女）的个人资料。我的设想是，当用户创建他们的帐户时，他们会被添加到用户表中（由设备），其中包含基本的电子邮件/密码字段。我还希望用户在单独的个人资料模型中拥有个人资料。我的方法与我在 StackOverflow 上看到的其他问题的不同之处在于，我希望通过关系表建立一个 has_many 关系。这就是为什么。

每个用户都有自己的个人资料。每个用户都应该能够为他们的孩子创建配置文件，并将这些配置文件与他们的用户帐户相关联。儿童不会有自己的用户模型。因此，每个用户可以有多个配置文件。我也想通过关系表来做到这一点。以后，如果用户的配偶加入系统，我希望能够将孩子与父母双方联系起来。

**用户.rb**

```
class User < ActiveRecord::Base
  devise :database_authenticatable, :registerable, :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :id, :email, :password, :password_confirmation, :remember_me

  has_many :relationships

  has_many :profiles, :through => :relationships
  accepts_nested_attributes_for :profiles

  attr_accessible :profiles, :profiles_attributes
end 
```

**配置文件.rb**

```
class Profile < ActiveRecord::Base
  attr_accessible :first_name, :last_name

  has_many :relationships
  has_many :users, :through => :relationships
end 
```

**关系.rb**

```
# Had to enter at least 6 characters to improve post (formatting was flawed)
class Relationship < ActiveRecord::Base
  attr_accessible :first_name, :last_name

  has_one :relationship_type

  belongs_to :user
  belongs_to :profile
end 
```

**新的.html.erb**

```
<h2>Sign Up for your account</h2>

<%= form_for(resource,  :as => resource_name, 
                        :url => registration_path(resource_name)) do |f| %>

  <%= devise_error_messages! %>

  <div>
    <%= f.label :email %><br />
    <%= f.email_field :email, :autofocus => true %>
  </div>

  <div>
    <%= f.label :password %><br />
    <%= f.password_field :password %>
  </div>

  <div>
    <%= f.label :password_confirmation %><br />
    <%= f.password_field :password_confirmation %>
  </div>

  <%= f.fields_for :profile do |builder| %>
    <div>
      <%= builder.label :first_name %><br />
      <%= builder.text_field :first_name %>
    </div>

    <div>
      <%= builder.label :last_name %><br />
      <%= builder.text_field :last_name %>
    </div>
  <% end %>

  <div><%= f.submit "Sign up" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

浏览到 sign_up 页面时，表单会正确加载。但是，在尝试保存新用户时..我收到以下错误。

> 无法批量分配受保护的属性：配置文件

在 new.html.erb 中，我尝试将嵌套表单的行更改为

```
<%= f.fields_for :profiles do |builder| %> 
```

但这只是导致嵌套表单无法呈现。

我将不胜感激任何帮助！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:23:18.657

`:profiles`， 不是`:profile`

```
<%= f.fields_for :profiles do |builder| %>
<div>
  <%= builder.label :first_name %><br />
  <%= builder.text_field :first_name %>
</div>

<div>
  <%= builder.label :last_name %><br />
  <%= builder.text_field :last_name %>
</div> 
```

您将需要在控制器中构建一个配置文件：

```
resource.profiles.build 
```

# xslt-2.0 - 具有多个用户输入控件的 Saxon-ce

> ID：14407825
> 
> 赞同：1
> 
> 时间：2013-01-18T21:19:46.817
> 
> 标签：xslt-2.0, saxon

我正在使用 Saxon-CE 和 Xslt 2.0 在网页（组合框）上进行控件。我在将多个控件的值传递给使用该控件中的值来处理文档的模板时遇到了麻烦。这是我所拥有的：

```
<xsl:stylesheet version="2.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:ixsl="http://saxonica.com/ns/interactiveXSLT"
extension-element-prefixes="ixsl">

<xsl:template match="/">

<xsl:result-document href="#comboBox1">
  <select id="myBox1">
    <option value="1">One</option>
    <option value="2">two</option>
  </select>
</xsl:result-document>

<xsl:result-document href="#comboBox2">
  <select id="myBox2">
    <option value="A">Letter-A</option>
    <option value="B">Letter-B</option>
  </select>
</xsl:result-document>

</xsl:template>

<xsl:template match="select[@id='myBox1'] mode=ixsl:onchange">
 <xsl:variable name="control1" select="."/>
 <xsl:variable name="numVal" select="ixsl:get($control1,'value')"/>

 <xsl:call-template name="displayStuff">
   <xsl:with-param name="field1" select="$numVal"/>
 </xsl:call-template>
</xsl:template>

<xsl:template match="select[@id='myBox2'] mode=ixsl:onchange">
 <xsl:variable name="control2" select="."/>
 <xsl:variable name="letVal" select="ixsl:get($control2,'value')"/>

 <xsl:call-template name="displayStuff">
   <xsl:with-param name="field2" select="$letVal"/>
 </xsl:call-template>

</xsl:template>

<xsl:template name="displayStuff">
 <xsl:param name="field1" select="0"/>
 <xsl:param name="field2" select="Z">
  <xsl:result-document href="#display" method="ixsl:replace-content">
    <xsl:text>Number: </xsl:text> <xsl:value-of select="$field1"/><br/>
    <xsl:text>Letter: </xsl:text> <xsl:value-of select="$field2"/><br/>        
  </xsl:result-document>
</xsl:template>

</xsl:stylesheet> 
```

问题是每个控件都将正确的值返回给刚刚更改的 then 项的显示模板，而不是其他项。

例如，如果我在第一个 Dropbox 中选择 1，我会得到 Number: 1 Letter: Z

但是现在如果我更改第二个保管箱的值（例如对 A 说），我会得到 Number: 0 Letter:A。

如何确保传递给显示模板的是所有 Dropbox 的当前选定值，而不是刚刚更改的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T12:20:30.233

与其将控件的当前值作为参数传递给 displayStuff 模板，为什么不让该模板通过 XPath 表达式直接从 HTML 页面访问它们呢？

我怀疑您可以将所有这些组合到一个模板中：

```
<xsl:template match="select[@id=('myBox1', 'myBox2')] mode=ixsl:onchange">
 <xsl:variable name="control1" select="."/>
 <xsl:variable name="numVal" select="ixsl:get(id('myBox1'),'value')"/>
 <xsl:variable name="letVal" select="ixsl:get(id('myBox2'),'value')"/>
  <xsl:result-document href="#display" method="ixsl:replace-content">
    <xsl:text>Number: </xsl:text> <xsl:value-of select="$numVal"/><br/>
    <xsl:text>Letter: </xsl:text> <xsl:value-of select="$letVal"/><br/>        
  </xsl:result-document>
</xsl:template> 
```

# linux - 使用 Linux 头文件中的 unistd.h 构建没有 libc 的静态 ELF

> ID：14407832
> 
> 赞同：12
> 
> 时间：2013-01-18T21:20:12.740
> 
> 标签：linux, gcc, posix, elf, libc

我有兴趣使用 Linux 头文件提供的 unistd.h 构建一个没有 (g)libc 的静态 ELF 程序。

我已经阅读了这些文章/问题，这些文章/问题大致了解了我正在尝试做的事情，但并不完全是：http: [//www.muppetlabs.com/~breadbox/software/tiny/teensy.html](http://www.muppetlabs.com/~breadbox/software/tiny/teensy.html)

[不使用 libc 编译](https://stackoverflow.com/questions/2548486/compiling-without-libc)

[https://blogs.oracle.com/ksplice/entry/hello_from_a_libc_free](https://blogs.oracle.com/ksplice/entry/hello_from_a_libc_free)

我有仅依赖于 unistd.h 的基本代码，其中，我的理解是这些函数中的每一个都是由内核提供的，并且不需要 libc。这是我采取的似乎最有希望的道路：

```
 $ gcc -I /usr/include/asm/ -nostdlib grabbytes.c -o grabbytesstatic
    /usr/bin/ld: warning: cannot find entry symbol _start; defaulting to 0000000000400144
    /tmp/ccn1mSkn.o: In function `main':
    grabbytes.c:(.text+0x38): undefined reference to `open'
    grabbytes.c:(.text+0x64): undefined reference to `lseek'
    grabbytes.c:(.text+0x8f): undefined reference to `lseek'
    grabbytes.c:(.text+0xaa): undefined reference to `read'
    grabbytes.c:(.text+0xc5): undefined reference to `write'
    grabbytes.c:(.text+0xe0): undefined reference to `read'
    collect2: error: ld returned 1 exit status 
```

在此之前，我必须根据内核头文件中的值手动定义 SEEK_END 和 SEEK_SET。否则它会错误地说那些没有定义，这是有道理的。

我想我需要链接到一个未剥离的 vmlinux 以提供要使用的符号。但是，我通读了这些符号，虽然有很多 llseek，但它们并不是 llseek 逐字记录的。

所以我的问题可以有几个方向：

如何指定一个 ELF 文件来使用其中的符号？而且我猜测是否/如何可能，符号将不匹配。如果这是正确的，是否有一个现有的头文件将重新定义 llseek 和 default_llseek 或内核中的任何内容？

有没有更好的方法在没有 libc 的情况下用 C 编写 Posix 代码？

我的目标是使用（可能仅）unistd.h 编写或移植相当标准的 C 代码，并在没有 libc 的情况下调用它。如果没有一些 unistd 函数，我可能没问题，并且不确定哪些函数“纯粹”作为内核调用存在。我喜欢组装，但这不是我的目标。希望尽可能严格地保持 C（如果必须的话，我可以使用一些外部程序集文件），以便在某些时候允许使用 libc-less 静态系统。

感谢您的阅读！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-29T17:16:52.597

如果您想用 C 编写 POSIX 代码，那么放弃 libc 不会有帮助。尽管您可以`syscall`在汇编程序中实现一个函数，并从内核头文件中复制结构和定义，但您实际上是在编写自己的 libc，这几乎肯定不符合 POSIX。有了所有伟大的 libc 实现，几乎没有理由开始实现自己的。

[Dietlibc](http://www.fefe.de/dietlibc/)和[musl libc](http://www.musl-libc.org/)都是节俭的 libc 实现，它们产生了令人印象深刻的小二进制文件。链接器通常很聪明；只要编写了一个库以避免意外引入大量依赖项，那么只有您使用的函数实际上会链接到您的程序中。

这是一个简单的 hello world 程序：

```
#include<unistd.h>

int main(){
    char str[] = "Hello, World!\n";
    write(1, str, sizeof str - 1);
    return 0;
} 
```

用下面的 musl 编译它会产生一个小于 3K 的二进制文件

```
$ musl-gcc -Os -static hello.c
$ strip a.out 
$ wc -c a.out
2800 a.out 
```

Dietlibc 生成一个更小的二进制文件，小于 1.5K：

```
$ diet -Os gcc hello.c
$ strip a.out 
$ wc -c a.out
1360 a.out 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T00:01:35.817

这远非理想，但一点点 (x86_64) 汇编程序让我降至 5KB 以下（但其中大部分是“代码以外的东西” - 实际代码低于 1KB [准确地说是 771 字节]，但是文件大小要大得多，我认为是因为代码大小四舍五入到 4KB，然后添加了一些页眉/页脚/额外的东西]

这是我所做的： gcc -g -static -nostdlib -o glibc start.s glibc.c -Os -lc

glibc.c 包含：

```
#include <unistd.h>

int main()
{
    const char str[] = "Hello, World!\n";
    write(1, str, sizeof(str));

    _exit(0);
} 
```

start.s 包含：

```
 .globl _start
_start: 
    xor %ebp, %ebp
    mov %rdx, %r9
    mov %rsp, %rdx
    and $~16, %rsp
    push    $0
    push    %rsp

    call    main

    hlt

    .globl _exit
_exit:
    //  We known %RDI already has the exit code... 
    mov $0x3c, %eax
    syscall
    hlt 
```

这样做的重点并不是要表明占用大量空间的不是 glibc 的系统调用部分，而是“准备工作” - 并且要注意，如果您要调用例如 printf，甚至可能是 (v) sprintf 或 exit() 或任何其他“标准库”函数，您处于“没人知道会发生什么”的领域。

编辑：更新“start.s”以将 argc/argv 放在正确的位置：

```
_start: 
    xor %ebp, %ebp
    mov %rdx, %r9
    pop     %rdi
    mov %rsp, %rsi
    and $~16, %rsp
    push    %rax
    push    %rsp

    // %rdi = argc, %rsi=argv
    call    main 
```

请注意，我已经更改了哪个寄存器包含什么东西，以便它与 main 匹配——我在前面的代码中让它们的顺序略有错误。

# javascript - 通过 Node.js 将文档插入 MongoDB 时出错

> ID：14407834
> 
> 赞同：15
> 
> 时间：2013-01-18T21:20:47.883
> 
> 标签：javascript, node.js, mongodb

我正在尝试在 Node.js 中将文档插入 MongoDB。我已成功读取数据库，并通过命令行界面添加了文档。但是，我无法从 JavaScript 插入文档。如果我这样做，我会收到一个错误：

> 错误：如果没有提供回调，就无法使用 writeConcern

这是我的代码：

```
var mongodb = require("mongodb");
var MongoClient = mongodb.MongoClient;

MongoClient.connect("mongodb://localhost:27017/test", function(err, db) {
        if (!err) {
            db.collection("test").insert({ str: "foobar" });
        }
    }); 
```

我一生都无法弄清楚为什么会出现此错误。

我做错了什么，我应该怎么做？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-19T01:05:55.227

您需要为您的`insert`调用提供回调函数，以便该方法可以将插入期间发生的任何错误传达给您。

```
db.collection("test").insert({ str: "foobar" }, function (err, inserted) {
    // check err...
}); 
```

或者，如果您真的不在乎插入是否成功，请在 options 参数中传递写入关注值 0：

```
db.collection("test").insert({ str: "foobar" }, { w: 0 }); 
```

# google-apps-script - 应用程序脚本：如何读回文本小部件的内容？

> ID：14407835
> 
> 赞同：0
> 
> 时间：2013-01-18T21:20:55.700
> 
> 标签：google-apps-script

我敢肯定这是一个非常愚蠢的问题，但我花了一个小时谷歌搜索，没有运气。

我将电子表格数据（一些文本，一些日期）存储在各种小部件中。在某些时候，单击处理程序必须从小部件中读回文本或日期，并将其写出到另一个电子表格中。目前，我在 FlexTable（或 FlexTable 的 Label 小部件）中获取了数据。我现在发现（我认为）没有办法读回这些数据。

任何想法我打算如何处理这个？我只需要一个小部件，它可以让我存储数据、显示它，然后再读回它。

谢谢。

编辑

我认为这些答案实际上并没有让我更进一步。我很感激如果某些小部件作为回调传递给处理程序，我可以读取它们的值。但是，这似乎仅限于有`setName`方法的人——这只是`TextBox`和`ListBox`？如果是这样，那是没有用的，因为`TextBox`是供用户输入的。

那么，是否有一个小部件可以让*我*（脚本，而不是用户）存储数据，然后再读回来？还是我只是厚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:59:08.623

你搜索得不是很好，这里有很多例子......今天只发布了一个：[日期和时间选择器谷歌应用脚​​本](https://stackoverflow.com/questions/14391642/date-and-time-picker-google-app-script)

和[文档](https://developers.google.com/apps-script/uiapp?hl=fr-FR)，请查看页面的（近）结尾...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T21:33:37.630

如果您在标签中设置文本，您实际上可以从标签小部件中读取文本......

```
// Get Label text and set it to another label
function doGet() {
  var app = UiApp.createApplication();
  var panel = app.createVerticalPanel();
  var label1 = app.createLabel('hello').setTag('hello').setId('label1');
  Logger.log(label1.getTag()); // works
  var label2 = app.createLabel('').setId('label2');
  var handler = app.createServerHandler('myFunction').addCallbackElement(panel);
  var btn = app.createButton('Get tag', handler);
  panel.add(label1).add(label2).add(btn);
  app.add(panel);
  return app;
}

function myFunction(e) {
  var app = UiApp.getActiveApplication();
  Logger.log(app.getElementById('label1').getTag()) // doesn't work
  var tag = e.parameter.label1_tag; // works
  Logger.log(tag); 
  app.getElementById('label2').setText(tag); // Sets label2 text as label1 tag
  return app;
} 
```

您没有`.setName()`使用标签指定，但它看起来像是自动创建的。

在您的情况下，将文本存储在与标签一致的**不可见**文本框中将是另一种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T22:12:38.733

看看[https://developers.google.com/apps-script/uiapp#ServerHandlers](https://developers.google.com/apps-script/uiapp#ServerHandlers) 小部件的值在 e.parameter 中传递给服务器处理程序。不要忘记提供小部件名称和 ID。如果您想获取不是触发事件处理的小部件的值，那么您需要使用小部件标签值传递数据

# objective-c - 使用 CommandLineTool 的 Objective-c 计算器程序

> ID：14407837
> 
> 赞同：0
> 
> 时间：2013-01-18T21:21:10.303
> 
> 标签：objective-c

大家好，我创建了 main.m 文件、calculator.h 和calculator.m 文件

在写下我的代码之前，我的问题是程序不要求操作员它只要求第一个和第二个数字。

这是我的 main.m 代码

```
int num1,num2;
    char op;

    Calculator *myCalculator=[[Calculator alloc]init];

    NSLog(@"Please Enter The First Number");
    scanf("%i",&num1);

    NSLog(@"Please Choose a mathematical operation '+', '-', '*', '/' :");
    scanf("%c",&op);

    NSLog(@"Please Enter The Second Number");
    scanf("%i",&num2);

    switch (op) {
        case '+':

            NSLog(@"The Result is : %i",[myCalculator Add:num1 :num2]);
            break;

        case '-':

            NSLog(@"The Result is : %i",[myCalculator Sub:num1 :num2]);
            break;

        case '*':
            NSLog(@"The Result is : %i",[myCalculator Mul:num1 :num2]);
            break;

        case '/':
            NSLog(@"The Result is : %i",[myCalculator Div:num1 :num2]);
            break;

        default:
            NSLog(@"Unknown Operator");
            break;
    } 
```

我的实现代码如下：

```
-(int) Add:(int)num1 :(int)num2
{
    return num1+num2;
}

-(int) Sub:(int)num1 :(int)num2
{
    return num1-num2;
}

-(int) Mul:(int)num1 :(int)num2
{
    return num1*num2;
}

-(int) Div:(int)num1 :(int)num2
{
    return num1/num2;
} 
```

任何帮助将不胜感激提前感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T23:56:21.890

有一段时间没有做过这样的事情了，但是当我制作一个基于文本的小型 RPG 战斗系统时，我遇到了类似的问题。用户输入数字后按回车，对吗？该数字将被扫描到`num1`，换行符将被扫描到`op`. 记录`op`切换前的值。

# javascript - Highcharts，仅在选定点上显示标记

> ID：14407838
> 
> 赞同：3
> 
> 时间：2013-01-18T21:21:16.483
> 
> 标签：javascript, charts, highcharts

我想在线上显示没有标记的样条图。这个完成了。But now, When a point is selected, the marker doesn't appear.

我发现了一个小技巧来做我想做的事。在 plotOptions 中，radius 设置为 0.1 以被线宽隐藏。

```
plotOptions: {
    series: {
        allowPointSelect: true,
            marker: {
                radius: 0.1, // hack to show selected point
                states: {
                    hover: {
                        radius: 5
                    },
                    select: {
                        radius: 5
                    }
                }
            }
        }
    }
} 
```

完整代码在这里：http:  [//jsfiddle.net/ManUtopiaK/7GXeT/](http://jsfiddle.net/ManUtopiK/7GXeT/)

**这是一个 HighCharts 错误还是我在图形选项中犯了一个错误？**

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-18T21:37:49.543

如果您将标记设置为已启用：false，如果您将鼠标悬停在该点上（当出现工具提示弹出窗口时），您仍会显示标记点。[在此处](http://jsfiddle.net/wergeld/7GXeT/2/)查看更新的小提琴：

```
plotOptions: {
    series: {
        allowPointSelect: true,
        marker: {
            enabled: false,
            //radius: 0.1, // hack to show selected point
            states: {
                hover: {
                    radius: 5
                },
                select: {
                    radius: 5
                }
            }
        }
    }
} 
```

# css - 具有悬停效果的 div 浮动在 div 上

> ID：14407841
> 
> 赞同：1
> 
> 时间：2013-01-18T21:21:29.287
> 
> 标签：css, html, hover

我正在尝试获得一个固定的 100% div（以便滚动时它保持在页面顶部）以滚动多个具有悬停效果的小 div。我似乎无法弄清楚如何让导航悬停在小 div 上，它总是在它后面。我相信问题是css位置标签，但我不知所措......请帮忙！

这是具有悬停效果的小 div 的代码。我取出了顶部导航 div，因为它不适合我...

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    <link rel="stylesheet" href="styles.css"  />
</head>
<body>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>        
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>        
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>        
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
   </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>        
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>        
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="view view-fifth">
            <img src="1.png" />
            <div class="mask">
                <h2>Android 4.0</h2>
                <a href="#" class="info">$9.99</a>
                <p>
                    Dual Core! 4GB Memory, 1024x768 Best Tablet of 2013! You Buy Now! You Buy Now! You     Buy Now! You Buy Now! You Buy Now! You Buy Now!
                </p>
            </div>
        </div>
    </div>
</body>
</html> 
```

**和 CSS**

```
.view {
    width: 180px;
    height: 160px;
    margin: 5px;
    float: left;
    overflow: hidden;
    position: relative;
    text-align: center;
    /*
    -webkit-box-shadow: 1px 1px 2px #e6e6e6;
    -moz-box-shadow: 1px 1px 2px #e6e6e6;
    box-shadow: 1px 1px 2px #e6e6e6;
    */
    cursor: default;
    background: #fff url() no-repeat center center;
    /*
    border-top: 2px solid #2e84c0;
    border-left: 2px solid #2e84c0;
    border-right: 2px solid #efefef;
    border-bottom: 4px solid #2e84c0;
    */
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}
body {
    background-image:url    (../img/blue_line_background.jpg);
    min-width:1080px;
}
.view .mask,.view .content {
    width: 180px;
    height: 160px;
    position: absolute;
    overflow: hidden;
    top: 0;
    left: 0;
}
.view img {
    display: block;
    position: relative;
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}
.view h2 {
    text-transform: uppercase;
    color: #fff;
    text-align: center;
    position: relative;
    font-size: 15px;
    padding: 2px;
    background: rgba(0, 0, 0, 0.8);
    margin: 0 0 0 0;
}
.view p {
    font-family: Georgia, serif;
    font-style: italic;
    font-size: 12px;
    position: relative;
    color: #fff;
    /*padding: 10px 20px 20px;*/
    text-align: center;
}
.view a.info {
    display: inline-block;
    text-decoration:none;
    font-weight:bold;
    padding: 5px;
    background:;
    color: #359ce1;
    text-transform: uppercase;
    /* 
    -webkit-box-shadow: 0 0 1px #000;
    -moz-box-shadow: 0 0 1px #000;
    box-shadow: 0 0 1px #000;
    */
}
.view a.info: hover {
    -webkit-box-shadow: 0 0 5px #000;
    -moz-box-shadow: 0 0 5px #000;
    box-shadow: 0 0 5px #000;
}
.view-fifth img {
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
} 
.view-fifth .mask {
    background-color: #c3c3c3;
    -webkit-transform: translateX(-300px);
    -moz-transform: translateX(-300px);
    -o-transform: translateX(-300px);
    -ms-transform: translateX(-300px);
    transform: translateX(-300px);
    -ms-filter: "progid:     DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter: alpha(opacity=100);
    opacity: 1;
    -webkit-transition: all 0.3s ease-in-out;
    -moz-transition: all 0.3s ease-in-out;
    -o-transition: all 0.3s ease-in-out;
    -ms-transition: all 0.3s ease-in-out;
    transition: all 0.3s ease-in-out;
    border-bottom-left-radius: 5px;
    border-top-left-radius: 5px;
} 
.view-fifth h2 {
    background: rgba(255, 255, 255, 0.5);
    color: #000;
    -webkit-box-shadow: 0px 1px 3px rgba(159, 141,     140, 0.5);
    -moz-box-shadow: 0px 1px 3px rgba(159, 141, 140,     0.5);
    box-shadow: 0px 1px 3px rgba(159, 141, 140,     0.5);   
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}
.view-fifth p {
    -ms-filter: "progid:     DXImageTransform.Microsoft.Alpha(Opacity=0)";
    filter: alpha(opacity=0);
    opacity: 0;
    color: #000;
    -webkit-transition: all 0.2s linear;
    -moz-transition: all 0.2s linear;
    -o-transition: all 0.2s linear;
    -ms-transition: all 0.2s linear;
    transition: all 0.2s linear;
    border-bottom-left-radius: 5px;
    border-top-left-radius: 5px;
}
.view-fifth:hover .mask {
    -webkit-transform: translateX(0px);
    -moz-transform: translateX(0px);
    -o-transform: translateX(0px);
    -ms-transform: translateX(0px);
    transform: translateX(0px);
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}
.view-fifth:hover img {
    -webkit-transform: translateX(300px);
    -moz-transform: translateX(300px);
    -o-transform: translateX(300px);
    -ms-transform: translateX(300px);
    transform: translateX(300px);
    border-bottom-left-radius: 5px;
    border-bottom-right-radius: 5px;
    border-top-left-radius: 5px;
    border-top-right-radius: 5px;
}
.view-fifth:hover p {
    -ms-filter: "progid:         DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter: alpha(opacity=100);
    opacity: 1;
} 
```

并且由于某种原因.. 代码输入按钮对我不起作用.. 我必须每行手动输入 4 个空格才能发布代码..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:43:42.063

我过去做过类似的事情。我想在页面的一侧有一个导航选项卡，并让它在扩展时始终显示在页面上其他任何内容的顶部。这很容易通过使用**position: fixed**和**z-index: 1000**的混合来完成，同时还将这个 div 锚定到 body 本身。

W3C 有一篇关于位置和 z-index 主题的好文章：

[http://www.w3schools.com/cssref/pr_class_position.asp](http://www.w3schools.com/cssref/pr_class_position.asp) http://www.w3schools.com/cssref/pr_pos_z-index.asp

我希望这有帮助。

# android - 彩色水平指示器示例

> ID：14407845
> 
> 赞同：0
> 
> 时间：2013-01-18T21:21:47.197
> 
> 标签：android

任何人都可以分享类似可可的 nslevelindicator 的代码片段：

![在此处输入图像描述](../Images/84c8c4c1da99b3afebd649c30c054082.png)

我正在寻找 LevelListDrawable 和 StateListDrawable 但它看起来不像我需要的。

# kendo-ui - 是否可以在 kendo-ui 中调整网格及其内容的大小？

> ID：14407847
> 
> 赞同：2
> 
> 时间：2013-01-18T21:21:52.400
> 
> 标签：kendo-ui, kendo-grid

是否可以在 kendo-ui 中调整网格及其内容的大小？我想将它用于响应式 Web 应用程序。我的意思是可调整大小的列、行和里面的内容（文本、图像、..）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:25:30.113

只要您在最初制作网格时将 resizable 设置为 true，就可以调整剑道网格列的大小。

```
$("#grid").kendoGrid({
                    dataSource: {
                       //datasource stuff
                    },
                    height: 350,
                    sortable: true,
                    resizable: true, <--this is the one to be set to make resizing possible
                    pageable: true, 
```

# javascript - Div 内容跨越到页面页脚的问题

> ID：14407856
> 
> 赞同：1
> 
> 时间：2013-01-18T21:22:38.963
> 
> 标签：javascript, jquery, cordova, jquery-mobile, html

在这里快速提问。我一直试图让我的代码的内容部分将页面填充到页脚。我尝试将以下 hack 添加到内容类型 padding-bottom: 5000px margin-bottom: -5000px; 的 css 中。我也遵循了本指南，但没有得到我想要的结果。这是正在发生的事情的屏幕截图：http: [//img.photobucket.com/albums/v189/shadowtyper/screenshotIssue_zpse858c39a.gif](http://img.photobucket.com/albums/v189/shadowtyper/screenshotIssue_zpse858c39a.gif)

```
<div data-role="page" id="Ids" data-theme="a">
<div data-role="header" data-theme="b">
    <h1>Accepted Orders
    </h1>
    <a href="#page" data-icon="home" data-iconpos="notext" id="intro" class="ui-btn-right"></a>
</div>

<div data-role="content">
        <ul data-role="listview" data-inset="true" id="idsContent" data-theme="a">
            <li><a href="#somediv"> ID #12345678</a></li>
            <li><a href="#somediv"> ID #12345678</a></li>
        </ul>
</div>
   <div data-role="footer" data-position="fixed" class="footer-docs" data-theme="b">
    <p>footer</p>    
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:44:57.757

这是一个可行的解决方案，我在我的

```
$("div[data-role='page']").live('pageshow',function(e,data){    
    var header = $("div[data-role='header']:visible");
    var footer = $("div[data-role='footer']:visible");
    var content = $("div[data-role='content']:visible:visible");
    var viewport_height = $(window).height();

    var content_height = viewport_height - header.outerHeight() - footer.outerHeight();
    if((content.outerHeight() - header.outerHeight() - footer.outerHeight()) <= viewport_height) {
        content_height -= (content.outerHeight() - content.height());
        content.height(content_height);
    } 
}); 
```

这是一个工作示例：http: [//jsfiddle.net/Gajotres/BYufW/](http://jsfiddle.net/Gajotres/BYufW/)

我希望这是你想要的。

# opencv - 在opencv中标记图像中的连接组件

> ID：14407863
> 
> 赞同：0
> 
> 时间：2013-01-18T21:22:54.077
> 
> 标签：opencv

我编写了一段代码，用于查找连接的组件并使用 cvPutText 用字母“R”标记连接的组件。现在我需要根据连接组件的数量打印 1,2,3,....等数字，而不是 Letter'R'。之后我需要找到区域并将连接组件的区域打印为文本。谁能帮我这个？

这是我的代码：

```
imagelab=cvCreateImage(cvGetSize(mor),IPL_DEPTH_8U,3);
CvMemStorage* contour_storage = cvCreateMemStorage(0);
CvSeq* contours;
CvFont font;
cvInitFont(&font, CV_FONT_HERSHEY_SIMPLEX, 0.6f, 0.6f, 0, 2);
cvFindContours(mor, contour_storage, &contours, sizeof (CvContour), CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE,cvPoint(0,0));
cvZero(imagelab);

for( ; contours != NULL; contours = contours->h_next )
 {
    CvScalar color =  CV_RGB( rand()&255, rand()&255, rand()&255 );
    cvDrawContours( imagelab, contours, color, CV_RGB(255,255,255), -1, CV_FILLED, 8 ,cvPoint(0,0));
    CvRect iconBox = cvBoundingRect(contours, 0);
    CvPoint center = cvPoint(iconBox.x + (iconBox.width / 2), iconBox.y + (iconBox.height / 2));
    int area = abs(cvContourArea(contours, CV_WHOLE_SEQ));
    cvPutText(imagelab,"R", center, &font, CV_RGB(255, 255, 255));
  } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T00:13:32.613

有很多方法可以做到这一点，您需要将整数转换为字符串。只需使用计数器。我最喜欢的是使用字符串流

```
for(int ncount = 0 ; contours != NULL; contours = contours->h_next, ncount++ )
...
std::stringstream str;
str << ncount;
cvPutText(imagelab,str.str(), center, &font, CV_RGB(255, 255, 255)); 
```

# php - 从原始表示创建整数

> ID：14407864
> 
> 赞同：0
> 
> 时间：2013-01-18T21:23:05.880
> 
> 标签：php

我尝试从从“/dev/urandom”读取的原始数据创建整数。但我不知道如何转换为整数。

```
<?php

//////////////////////////////////////////////////////////////////////////////

function base62_encode($val, $base=62, $chars='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ') {
   if(!isset($base))
        $base = strlen($chars);
    $str = '';
    do {
        $m = bcmod($val, $base);
        $str = $chars[$m] . $str;
        $val = bcdiv(bcsub($val, $m), $base);
    } while(bccomp($val,0)>0);
    return $str;
}

//////////////////////////////////////////////////////////////////////////////

$file = fopen('/dev/urandom', 'rb');
if ( !$file ) {
   throw new Exception('Error!');
} else {
    $binary = fread($file, 4); // 4 bytes == 32 bits
   fclose($file);
   $dec = (int)$binary;
    $base62 = base62_encode($dec);

   fprintf(STDOUT, "dec:%d, %s\n", $dec, $base62);
}

//////////////////////////////////////////////////////////////////////////////

?> 
```

作为输出，我得到：“dec:0, 0”

[你可以在这里](http://liveworkspace.org/code/14DJhT%242)测试代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:59:58.380

```
$dec = unpack('L', $binary)[1]; 
```

# facebook - 我可以在照片表上对 Facebook FQL 查询进行分页吗？

> ID：14407866
> 
> 赞同：2
> 
> 时间：2013-01-18T21:23:10.740
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我有以下 FQL：

```
SELECT id, created, like_info, comment_info FROM photo WHERE owner = me() 
```

它在一个 HTML 请求中返回我想要的所有信息，并且效果很好。

除了它只返回前 100 张照片。当我通过 OpenGraph API 使用`/self/photos/uploaded`这些结果进行查询并对其进行分页时，我正确地得到了我期望的数百张照片。

问题是，为了获得点赞和评论信息，我必须（可能）再发出几个查询，以便对每张照片的评论和点赞部分进行分页。由于其中几张照片有超过 25 条评论和超过 25 条赞，这很容易加起来多达数百个 HTTP 请求。

我已经尝试了 FQL 中的各种 WHERE 子句以超出返回的第 100 个结果，但 FQL 根本不会返回第 101 张照片。而且，像往常一样，Facebook 的文档非常缺乏。

有人有想法么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:35:16.667

FQL 有`LIMIT`和`OFFSET`关键字，因此您可以获得 100 张照片，从第 101 张开始添加`LIMIT 100 OFFSET 101`. 我相信您最多可以请求 5000 个 FQL 项目。

您应该查看[FQL](https://developers.facebook.com/docs/technical-guides/fql/#multi)多查询以减少调用次数。

# javascript - 在浏览器/窗口之外捕获 mouseup 事件

> ID：14407869
> 
> 赞同：9
> 
> 时间：2013-01-18T21:23:13.683
> 
> 标签：javascript, dom-events

现在我正在停止鼠标上的拖动事件，如下所示：

```
$(document).mouseup(_onMouseUp); 
```

但是我需要在鼠标离开浏览器窗口时捕获鼠标向上事件，类似于`releaseOutside`在 Flash 中。

这在JS中可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-18T21:46:15.837

您无法在浏览器窗口之外检测到 mouseup 或 mousedown 事件，但我认为您要做的是在用户单击浏览器窗口时取消拖放。您*可以*通过对失去焦点的浏览器窗口做出反应来实现这一点，例如：

```
$(window).on("blur", function(e) {
    // Cancel my drag and drop here
}); 
```

或者

```
$(document).on("blur", function(e) {
    // Cancel my drag and drop here
}); 
```

这涵盖了浏览器窗口外的鼠标点击，以及 Windows Alt+Tab 任务切换等内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-02-06T03:12:15.183

是的，可以在浏览器窗口外捕获 mouseup 事件。只需在 mousedown 回调中调用[Element.setCapture()即可。](https://developer.mozilla.org/pl/docs/Web/API/Element/setCapture)

记得在 mouseup 上调用[document.releaseCapture() 。](https://developer.mozilla.org/en-US/docs/Web/API/Document/releaseCapture)

```
elem.addEventListener('mousedown', function() {
    ...
    elem.setCapture();
});
elem.addEventListener('mouseup', function() {
    ...
    document.releaseCapture();
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-03-08T06:48:16.613

您可以在每个主要浏览器的浏览器窗口外捕获 mouseup 事件：Chrome、Edge 和 Firefox。

您只需要将**侦听器附加到“窗口”对象**，如下所示：

```
window.addEventListener('mouseup', 
                         () => console.log('mouse up captured outside the window')); 
```

[https://codepen.io/fredrikborgstrom/pen/vRBaZw](https://codepen.io/fredrikborgstrom/pen/vRBaZw)

或者在您的情况下，使用 jQuery，它将是：

```
$(window).mouseup(_onMouseUp); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-29T14:37:15.357

可以在浏览器窗口之外捕获鼠标向上事件，如下所示：

```
elem.addEventListener('mousedown', function(e) {
    ...
    elem.setPointerCapture(e.pointerId);
});
elem.addEventListener('mouseup', function(e) {
    ...
    elem.releasePointerCapture(e.pointerId);
}); 
```

参考： [setPointerCapture](https://developer.mozilla.org/en-US/docs/Web/API/Element/setPointerCapture) [releasePointerCapture](https://developer.mozilla.org/en-US/docs/Web/API/Element/releasePointerCapture)

# vb.net - SQLite，是否打开一个永久连接？

> ID：14407872
> 
> 赞同：5
> 
> 时间：2013-01-18T21:23:25.997
> 
> 标签：vb.net, sqlite

我一直认为最好使用和关闭数据库连接。但是对于 SQLite，我不确定这是否适用。我使用 Using Connection 语句进行所有查询。所以我的理解是我打开一个连接然后关闭它这样做。当谈到 SQLite 和最佳使用时，是在程序使用期间打开一个永久连接更好，还是继续使用我当前使用的方法。

我正在将数据库用于 VB.net windows 程序，其数据库相当大，约为 2gig。

我当前的连接方法示例

```
 Using oMainQueryR As New SQLite.SQLiteCommand
            oMainQueryR.CommandText = ("SELECT * FROM CRD")
            Using connection As New SQLite.SQLiteConnection(conectionString)
                Using oDataSQL As New SQLite.SQLiteDataAdapter
                    oMainQueryR.Connection = connection
                    oDataSQL.SelectCommand = oMainQueryR
                    connection.Open()
                    oDataSQL.FillSchema(crd, SchemaType.Source)
                    oDataSQL.Fill(crd)
                    connection.Close()
                End Using
            End Using
    End Using 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:27:49.367

如果它是仅由一个用户使用的本地应用程序，我认为在应用程序的生命周期内保持一个连接打开是可以的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T21:28:18.227

我认为对于大多数数据库，“最佳使用和关闭”的想法来自通过确保您只需要打开最少数量的连接来节省内存的角度。

实际上，打开连接可能会产生大量开销，应在需要时进行。这就是托管服务器基础架构（weblogic 等）促进使用连接池的原因。通过这种方式，您`N`可以获得在任何给定时间都可以使用的连接。您永远不会“浪费”资源，但您也没有责任在全球范围内管理它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:29:48.960

与所有事物数据库一样，这取决于。在 sqlite 的这种特定情况下，您需要查看两个“依赖项”：

1.  你是数据库的唯一用户吗？
2.  何时提交隐式事务？

对于第一项，如果有其他数据库用户，或者如果有多个进程同时访问您的 sqlite 数据库文件，您可能希望频繁地打开/关闭不同的连接。

对于第二项，我不确定 sqlite 的具体表现如何。一些数据库引擎在连接关闭之前不会提交隐式事务。如果 sqlite 是这种情况，您可能希望更频繁地关闭连接。

.Net 中的连接应该是短暂的这一想法主要适用于 Microsoft Sql Server，因为 Sql Server 的 .Net 提供程序也能够利用称为连接池的功能。在 Sql Server 之外，这个建议并非完全没有价值，但也不是那么理所当然。

# linux - 使用别名执行脚本

> ID：14407873
> 
> 赞同：3
> 
> 时间：2013-01-18T21:23:53.267
> 
> 标签：linux, bash, shell, alias

我正在尝试创建一个将执行脚本的别名。当我 cd 进入脚本所在的目录时...假设 /usr/local/bin/startscript 然后脚本按预期运行并启动我想要的应用程序。

所以。我进入了我的 bashrc 文件并添加了一个别名 alias startscript='/usr/local/bin/startscript'

目标是能够通过简单地从任何目录键入“startscript”来运行脚本。

但是，当我尝试使用别名来运行脚本时，它不能正常工作，因为应该启动的应用程序不能。

我的脚本以

```
#!/bin/sh 
```

然后从那里去

有任何想法吗？谢谢

脚本：

```
#!/bin/sh

#- Check for user 'user'
if [[ "`whoami`" != "user" ]]; then
  echo "This script can only be executed by user 'user'."; exit
fi

. /usr/local/bin/etctrx/startscriptdirectory/startscriptsetup

#- Kill manager to avoid multiple processes
pkill -f 'JavaApp.jar'

#- Start
nohup java -classpath /usr/local/bin/etctrx/startscriptdirectory/RequiredJars/ojdbc5.jar:/usr/local/bin/etctrx/startscriptdirectory/RequiredJars/activation.jar:/usr/local/bin/etctrx/startscriptdirectory/RequiredJars/mail.jar -jar /usr/local/bin/etctrx/startscriptdirectory/JavaApp.jar > ${JAVAAPPLOGS}/startscript.log 2>&1 & 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:39:10.983

如果脚本在 /usr/local/bin 中通过简单地键入按预期运行`startscript`，但从另一个目录运行脚本（不返回错误），但没有产生所需的结果，那么问题在于您如何引用脚本中的应用程序。

正如其他人所指出的那样，您不需要为其中的某些内容设置别名，`/usr/local/bin`如果它从该目录运行，显然您的可执行权限也是正确的。如果您尝试运行的应用程序也在其中，`/usr/local/bin`那么您的脚本可能会假定它在同一个目录中，而在其他地方不会出现这种情况，因此您需要在脚本中添加 a`cd`或`/usr/local/bin`指定完整的应用程序路径.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:28:16.493

> 如果我这样做，我可以调用脚本，但它仍然不会给我想要的结果，（应用程序正在启动）就像我从它所在的目录运行脚本时所做的那样

看起来有问题的“应用程序”与脚本位于同一目录中`/usr/local/bin`，我们已经建立的脚本已经在您的`PATH`. 让脚本正确运行而不是应用程序运行意味着您可能错误地调用了应用程序，例如

```
./application 
```

除非您从`/usr/local/bin`. 修复会是这样的

```
application 
```

# c# - BindingExpression 路径错误：在“对象”上找不到“数据”属性

> ID：14407875
> 
> 赞同：0
> 
> 时间：2013-01-18T21:23:59.710
> 
> 标签：c#, wpf, wpftoolkit

我在 WPFToolkit:DataGrid 中使用数据绑定制作了一些应用程序。当我运行应用程序时，我发现了这个错误，例如：

> System.Windows.Data 错误：40：BindingExpression 路径错误：在“对象”“ProcInfo”（HashCode=61374531）上找不到“ProcHandle”属性。绑定表达式：路径=ProcHandle；DataItem='ProcInfo' (HashCode=61374531); 目标元素是'TextBlock'（名称=''）；目标属性是“文本”（类型“字符串”）

在 MainWindow.xaml 中：

```
<toolkit:DataGrid x:Name="DG1" ItemsSource="{Binding}" AutoGenerateColumns="False" Margin="0,47,0,0">
            <toolkit:DataGrid.Columns>
                <toolkit:DataGridTextColumn Header="Time/sec" Binding="{Binding KillTime}"/>
                <toolkit:DataGridTextColumn Header="Handle" Binding="{Binding ProcHandle}"/>
                <toolkit:DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}"/>
                <toolkit:DataGridTextColumn Header="Status" Binding="{Binding ProcStatus}"/>
                <toolkit:DataGridTextColumn Header="Priority" Binding="{Binding ProcPriority}"/>
                <toolkit:DataGridTextColumn Header="End Time" Binding="{Binding EndTime}"/>
            </toolkit:DataGrid.Columns>
        </toolkit:DataGrid> 
```

在 MainWindow.xaml.cs

```
public partial class MainWindow : Window
    {
        private Process _firstProc;

        private DispatcherTimer _timerFirstProc;

        ProcessCollectionClass _procCollection = new ProcessCollectionClass();

        private int _firstProcTime;

public MainWindow()
        {
            InitializeComponent();
            DG1.DataContext = _procCollection.ProcCollection;
        }

        internal class ProcessCollectionClass : INotifyPropertyChanged
        {
            private ObservableCollection<ProcInfo> _procCollection = new ObservableCollection<ProcInfo>();

            public event PropertyChangedEventHandler PropertyChanged;

            public ObservableCollection<ProcInfo> ProcCollection
            {
                get { return _procCollection; }
                set
                {
                    _procCollection = value;
                    if (PropertyChanged != null)
                    {
                        PropertyChanged(this, new PropertyChangedEventArgs("ProcCollection"));
                    }
                }
            }
        }

        public class ProcInfo
        {
            public ProcInfo(string killTime, string procHandle, string startTime,
                            string procStatus, string procPriority)
            {
                KillTime = killTime;
                ProcHandle = procHandle;
                StartTime = startTime;
                ProcStatus = procStatus;
                ProcPriority = procPriority;
            }

            private string KillTime { get; set; }
            private string ProcHandle { get; set; }
            private string StartTime { get; set; }
            private string ProcStatus { get; set; }
            private string ProcPriority { get; set; }
        }

private void FirstProc_ButClick(object sender, RoutedEventArgs e)
        {

            _firstProcTime = Int32.Parse(FirstProcTime.Text);
            _firstProc = new Process();
            _firstProc.StartInfo.FileName = @"C:\Windows\System32\cmd.exe";
            _firstProc.StartInfo.UseShellExecute = true;
            _firstProc.Start();
            _firstProc.PriorityClass = ProcessPriorityClass.High;

            _timerFirstProc = new DispatcherTimer() { Interval = TimeSpan.FromSeconds(1) };
            _timerFirstProc.Start();
            _timerFirstProc.Tick += _timerFirstProc_Tick;
}
 void _timerFirstProc_Tick(object sender, EventArgs e)
        {
            --_firstProcTime;

            _firstProc.Refresh();
            _procCollection.ProcCollection.Add(new ProcInfo(
                                                   _firstProcTime.ToString(),
                                                   _firstProc.Handle.ToString(),
                                                   _firstProc.StartTime.ToString(),
                                                   _firstProc.Responding ? "Running" : "Not Responding",
                                                   _firstProc.PriorityClass.ToString()));

            if (_firstProcTime == 0)
            {
                _firstProc.Kill();
                _timerFirstProc.Stop();
            }
} 
```

最后，我在 DataGrid 中只看到空行。我究竟做错了什么！？对不起我的英语不好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T21:26:26.707

您在`ProcInfo`课堂上的所有属性都是私有的。他们应该是`public`。或者至少有一个公共吸气剂。

# java - 如何在 APK 文件中保护此 API

> ID：14407884
> 
> 赞同：3
> 
> 时间：2013-01-18T21:25:00.650
> 
> 标签：java, php, android, security, api

我目前正在为我运行的网站开发一个 api。该 api 将在许多地方使用，其中一个地方是 Android 应用程序。

它的目的是允许用户登录和下载文件。我有 api 版本，它将使用 HTTPS，因此所有数据在传输时都很好。

我遇到的问题是 API 调用需要 API 密钥。使用此密钥，您将能够访问可能导致问题的 API 的某些功能。

我想知道，有没有办法保护这个 API 密钥？我根本不是 Android 开发人员，但人们会使用 Android 上的 API，所以我需要制定解决方案。

以下是 API 使用的流程示例：

```
// Log the user in with their username and password (HTTPS, so not really an issue)
romhut.request('/api/users/login?apikey=KEY', {username : 'scott', password : 'password'}, function(r) { 

    console.log(r);

    // Once you have the token, request the API key that allows actions such as downloading
    romhut.request('/api/files/download?apikey=KEY', {token : r.token, file : file}, function(d){

        console.log(d);
        // Download the file

    }, 'POST');

}, 'POST'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T00:26:44.770

不可以。一旦将 API 密钥嵌入 Android 应用程序，就无法保护它。该应用程序需要访问 API 密钥，因此有权访问该应用程序的人将能够从应用程序中恢复该密钥并将其用于自己的目的。您能做的最好的事情就是混淆您的应用程序，以便对其进行逆向工程更加困难（目标是使攻击者更难逆向您的应用程序，而不是花费他的时间）。您需要根据暴露 API 密钥的风险来决定在这方面需要付出多少努力，但您永远不能让它无法恢复，只会更加困难。实际上，您最好的选择是在构建过程中打开 Proguard（因此，在 APK 中，事情被混淆到了相当程度，而您最终没有工作）并希望获得最好的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:35:34.997

您应该为每个用户创建一个特定的 API 密钥。没有真正好的方法来保护实际在用户手中的数据（询问版权保护制造商）然后您可以使用 HMAC 将 API 密钥和请求的 API 散列在一起，并验证两端是否发生相同的事情. 请参阅：[http](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code) ://en.wikipedia.org/wiki/Hash-based_message_authentication_code （PHP 对此有一个功能。）

事实上，更准确地说，密钥和用户之间应该存在多对一的关系，因为您可能有不同的和/或已撤销的用户密钥。

有关出色的概述，请参阅：[https ://security.stackexchange.com/questions/18572/is-it-okay-for-api-secret-to-be-stored-in-plain-text-or-decrypt-able](https://security.stackexchange.com/questions/18572/is-it-okay-for-api-secret-to-be-stored-in-plain-text-or-decrypt-able)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-12T12:06:31.980

Android 密钥库是一个值得关注的方向吗？然后，可能会根据安装时应用程序存储在 android 密钥库中的密钥将加密字符串发布到 API。这样，如果解密成功，它就可以为请求提供服务。

# php - 使用 PHP 在 MySQL 中存储简单数据

> ID：14407887
> 
> 赞同：-1
> 
> 时间：2013-01-18T21:25:20.083
> 
> 标签：php, mysql

我已经设置了这个简单的表格，允许您输入您的个人详细信息并将它们存储在数据库中，但它不起作用。

表单 HTML：

```
<html>
<body>
<form name="test" action="store.php" method="post">
Voornaam: <input type="text" name="first_name"> <br>
Achternaam: <input type="text" name="last_name"> <br>
E-Mail: <input type="text" name="e-mail"> <br>
Telefoon: <input type="text" name="phone"> <br>
Adres: <input type="text" name="address"> <br>
Postcode: <input type="text" name="postal_code"> <br>
Stad: <input type="text" name="city"> <br>
Provincie: <input type="text" name="province"> <br>
Land: <input type="text" name="country"> <br>
<input type="submit" value="Verzenden">
</form>
<body>
</html> 
```

和 PHP：

```
<?php
/*Database test.
© 2013 Sydcul. All rights reserved.*/

//Please change the following settings:
/*Your database host*/ $host = "localhost";
/*Your database user*/ $user = "root";
/*Your database password*/ $password = "";

//Please don't change the following:
$connection = mysql_connect($host, $user, $password);

mysql_select_db("contact", $connection);

$debug = "INSERT INTO data (first_name, last_name, e-mail, phone, address, postal_code, city, province, country)
VALUES ('" . $_POST["first_name"] . "', '" . $_POST["last_name"] . "', '" . $_POST["e-mail"] . "', '" . $_POST["phone"] . "', '" . $_POST["address"] . "', '" . $_POST["postal_code"] . "', '" . $_POST["city"] . "', '" . $_POST["province"] . "', '" . $_POST["country"] . "')";

mysql_query("INSERT INTO data (first_name, last_name, e-mail, phone, address, postal_code, city, province, country)
VALUES ('" . $_POST["first_name"] . "', '" . $_POST["last_name"] . "', '" . $_POST["e-mail"] . "', '" . $_POST["phone"] . "', '" . $_POST["address"] . "', '" . $_POST["postal_code"] . "', '" . $_POST["city"] . "', '" . $_POST["province"] . "', '" . $_POST["country"] . "')");

echo $debug;

mysql_close($connection);
?> 
```

我相信我曾经让它工作过，但那只是名字。我认为这是我看不到的非常明显的东西，所以请花一些时间来看看它并帮助我。

我把调试的东西放进去调试，它告诉我这个：

```
INSERT INTO data (first_name, last_name, e-mail, phone, address, postal_code, city, province, country) VALUES ('John', 'Johnson', 'john@johnson.com', '1234567890', 'Street 1', '1234 AB', 'City', 'Province', 'Country') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:28:56.523

Your email field `e-mail` has to be surrounded by the backtick character (```) such that your final query should be

```
INSERT INTO data (first_name, last_name, `e-mail`, phone, address, postal_code, city, province, country) VALUES ('John', 'Johnson', 'john@johnson.com', '1234567890', 'Street 1', '1234 AB', 'City', 'Province', 'Country') 
```

# ios - 故事板创建视图的 addSubview

> ID：14407890
> 
> 赞同：0
> 
> 时间：2013-01-18T21:25:30.807
> 
> 标签：ios, xcode, uiview, addsubview

至少我认为这是一个基本问题。我刚开始以编程方式处理视图。

在 RouteCaptureViewController.h 中：

```
@property (strong, nonatomic) IBOutlet UIView *routeCaptureSuperView;

@property(nonatomic, weak) IBOutlet UIImageView *captureImageView;
@property(nonatomic, retain) IBOutlet UIImageView *previewImageView;
@property (weak, nonatomic) IBOutlet UIView *captureRouteButtonView; 
```

在我的故事板中：

![在此处输入图像描述](../Images/ffb7e27cd435027d1dda2b9f4efb85d6.png)

我检查了所有插座都正确连接。

我在这样的方法中实现 addSubview 并且没有任何反应：

```
 [self.routeCaptureSuperView addSubview:self.captureRouteButtonView];
  [self.routeCaptureSuperView addSubview:self.captureImageView]; 
```

以下行以前在代码中有效：

```
[self.captureImageView removeFromSuperview];
[self.captureRouteButtonView removeFromSuperview]; 
```

而且我知道`self.routeCaptureSuperView`不是`nil`来自 NSLog。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:45:59.470

如果我理解正确并且您删除了视图以稍后再次添加它们，我可以做出有根据的猜测：

在您发送`removeFromSuperview`到您的视图的那一刻，它们被释放，因为它们被声明为`weak`only。
弱意味着如果对象被释放，则该属性将为零，因为与该对象的最后一个强关系已被释放。

父视图是与这两个视图保持最后牢固关系的对象。

尝试在两个子视图的声明中更改`weak`为。`strong``@property`

# java - 从带有 Web 服务的基本 Java 项目到可部署的 Glassfish 工件？

> ID：14407893
> 
> 赞同：2
> 
> 时间：2013-01-18T21:25:51.827
> 
> 标签：java, eclipse, web-services, wsdl, glassfish

我正在尝试学习 Web 服务、Glassfish、Eclipse 等，我学习的方式是我喜欢*手动*做事，而不是像许多在线教程要求你做的那样玩弄*动态 Web 项目。*我从一个基本的 Java 项目开始，然后*手动*创建 WSDL、客户端存根等。

我已经（非常）走了很远。到目前为止，我所做的是创建一个 Web 服务类并使用*wsgen*创建 WSDL，然后使用*wsimport*创建客户端存根。

我坚持的部分是如何将我的服务部署到 Glassfish？我已经能够使用 Eclipse（右键单击，-> Web 服务-> 创建 Web 服务）来做到这一点，但正如我上面所说，我想了解事情是如何在幕后工作的。因此，假设我只使用记事本和 Java 命令行编译器，我将如何从当前的 Web 服务项目转到可在 Glassfish中*部署的项目？*

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T10:18:02.173

您可以在 Apache TomEE 网站上找到大量示例。这个可能适合您的需求。 [http://openejb.apache.org/examples-trunk/simple-webservice/](http://openejb.apache.org/examples-trunk/simple-webservice/)

您需要打包您的 Web 服务并将其部署到容器中。只是在“引擎盖下”发生了任何事情。它只是为您的 IDE 培育和黄油的东西。你也可以“手动”做所有事情（战争，[http://www.openscope.net/2010/01/25/war-deployment-file-structure/](http://www.openscope.net/2010/01/25/war-deployment-file-structure/)；asadmin deploy [http://docs.oracle.com/cd /E19798-01/821-1751/giobi/index.html](http://docs.oracle.com/cd/E19798-01/821-1751/giobi/index.html) )。

*   米

# android - Android PreferenceActivity 复选框

> ID：14407897
> 
> 赞同：0
> 
> 时间：2013-01-18T21:25:59.773
> 
> 标签：android, checkbox, preferenceactivity

当应用程序启动时，我试图让一个复选框默认为 True。我使用了这个答案[Android CheckBoxPreference Default Value](https://stackoverflow.com/questions/3907830/android-checkboxpreference-default-value)但它仍然默认为 false 并在 LogCat 中打印 False。

有什么想法我搞砸了吗？我已经看了好几个小时了......提前谢谢！

```
public class Preferences extends PreferenceActivity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.layout.preferences);

        PreferenceManager.setDefaultValues(this, R.layout.preferences, true);
        SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
        boolean autoStart = prefs.getBoolean("checkBox1", true);

        System.out.println(autoStart);

    }

} 
```

XML类：

```
 <?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android" >

 <PreferenceCategory
   android:summary="Username and password information"
   android:title="User request" >
  <CheckBoxPreference
     android:key="checkBox1"
     android:title="request details" 
     android:defaultValue="true"/>

 </PreferenceCategory>
</PreferenceScreen> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:10:29.780

在您的主要活动中，您可以执行以下操作：

```
 SharedPreferences prefs = getSharedPreferences("YOUR_PREFERENCES_KEY",false);
    boolean isSetToTrue = prefs.getBoolean("YOUR_BOOLEAN_KEY",false);

    if(isSetToTrue==false){

         //here set your checkBox to true
     } 
```

main Activity 表示首先启动应用程序的 Activity。

# php - 检索一个 id 数组？

> ID：14407898
> 
> 赞同：1
> 
> 时间：2013-01-18T21:26:05.703
> 
> 标签：php, mysql, database, pdo

我对当前代码有疑问，实际上我不确定我是否以正确的方式前进。

我当前的脚本（总数）上传一张照片并从 MySQL 数据库返回 id。当照片被选中时，它也被赋予了标签。为了关联这些标签，我选择了一个表“tagrefs”，它简单地将 tag_id 与 photo_id 结合起来以供以后查询。表 'tags' 由 tag_id 和 tag_name 组成。表“照片”有大量字段，唯一相关的是 photo_id。

目前，我通过 POST 传递标签。

```
 $tags = trim($_POST['tags']);
  $tags = preg_replace('/\s+/', '', $tags);
  $tags = htmlspecialchars($tags);
  $tags = mysql_real_escape_string($tags);
  $tags = strip_tags($tags);
  $tags = explode(",", $tags);

$insert = $dbh->prepare('INSERT INTO tags (tag_name) VALUES (:tag)');
$insert->bindParam(':tag', $tag, PDO::PARAM_STR);
foreach ($tags as $tag) $insert->execute();

$select = $dbh->prepare('SELECT tag_id FROM tags WHERE tag_name = (:tag)');
$select->execute();
$result = $select->fetch(PDO::FETCH_ASSOC);
print_r($result);
print("\n"); 
```

直到 $select 它工作得很好。插入标签，上传照片。桃色。现在我需要写一些东西来给我刚刚添加的 tag_name 的 tag_id，然后我需要将它与 photo_id 结合起来并将其插入到“tagrefs”中。底部的 $select 是我试图通过将它们与用户发布的字符串进行比较来检索我刚刚创建的所述 tag_id 的失败尝试。我正在考虑的方式是检索它们，然后使用 photo_id 和 tag_id 创建一个新数组，并将值插入“tagrefs”。

这一切听起来都过于复杂，可能有更好/更安全的方法来做到这一点，但一个小时的谷歌搜索并没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:44:54.270

```
foreach ($tags as $tag) $insert->execute(); 
```

是不正确的。没有`{}`，所以 foreach 所做的就是一遍又一遍地执行一次调用。之后的其余代码不会作为 foreach 的一部分执行。因此，您插入所有标签，然后当循环完成时，您尝试获取您插入的最后一个标签的 id。假设这个 tag_id 是一个 auto_increment 主键字段，你应该使用这样的东西：

```
foreach($tags as $tag) {
    $insert->execute();
    $tag_id = $insert->lastInsertId();
    ....
} 
```

并且无论如何都不做专门的选择。

# java - Java：测验 android 应用程序 - 添加更多问题

> ID：14407899
> 
> 赞同：0
> 
> 时间：2013-01-18T21:26:08.480
> 
> 标签：java, android

我正在 Eclipse 中制作一个*非常*基本的测验应用程序。现在，它只有一个问题。我想做的是在你回答第一个问题后显示一个新问题，并且能够添加任意数量的问题。最好，我希望在回答一个问题后 X 秒内出现下一个问题，但由于我不知道这有多么困难，我对任何事情都持开放态度。如果有人能指出我应该怎么做才能添加更多问题的正确方向，我将不胜感激。这是我到目前为止所拥有的：

```
package com.example.quizuke3;

import android.os.Bundle;
import android.os.Vibrator;
import android.app.Activity;
import android.content.Context;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity implements OnClickListener{

    Button button1;
    Button button2;
    Button button3;
    int score =0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        button1 = (Button) findViewById(R.id.option1);
        button2 = (Button) findViewById(R.id.option2);
        button3 = (Button) findViewById(R.id.option3);

        button1.setOnClickListener(this);
        button2.setOnClickListener(this);
        button3.setOnClickListener(this);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public void onClick(View v) {
        TextView result = (TextView) findViewById(R.id.result);

        if(button1.equals(v)){
            score ++;
            result.setText("Correct! Score: "+score);
        }

        else if(button2.equals(v)){
            result.setText("Wrong! Score: "+score);
        }

        else if(button3.equals(v)){
            result.setText("Wrong! Score: "+poeng);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:16:08.363

您想要解决的方法是更改​​按钮和文本视图的文本，使用`setText(String s)`. 如果你反复做你上面所做的事情，你会做一个有用的测验，但代码不会真正可维护或易于阅读。您要做的是将您的测验分成不同的方法，一种将文本设置为按钮，另一种处理用户点击。然后，您将在两者之间反复调用。如果您有任何问题，因为那不是很清楚，请问。

# excel-2003 - 在 excel 2003 中搜索所有匹配的模式并替换

> ID：14407900
> 
> 赞同：0
> 
> 时间：2013-01-18T21:26:10.347
> 
> 标签：excel-2003

我基本上是在寻找一个基于 excel 的公式，它可以查看单元格值并将 ;# 的所有实例替换为空格或“;”。首先，我知道搜索替换功能，我知道宏可以做到这一点，挑战是我不能使用这两种方法中的任何一种。

数据以下列格式显示：

```
;#Business Mix;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Risk Selection;#Business Mix;#Improve Productivity;#
;#Risk Selection;#Business Mix;#Improve Productivity;#
;#Risk Selection;#Business Mix;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;#
;#Distribution;#Improve Productivity;# 
```

我目前正在使用以下公式得出解决方案，但效果不佳：

```
=REPLACE(REPLACE(LEFT(REPLACE(VLOOKUP($D$2,all,3,FALSE),3,2,""),LEN(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""))-2),FIND(";#",LEFT(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""),LEN(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""))-2),1),2,"; "),FIND(";#",REPLACE(LEFT(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""),LEN(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""))-2),FIND(";#",LEFT(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""),LEN(REPLACE(VLOOKUP(D2,all,3,FALSE),3,2,""))-2),1),2,"; "),1),2,"; ") 
```

all = 命名范围

所以我们可以有一个项目

```
;#Business Mix;# 
```

或者

```
;#Business Mix;#Improve Productivity;# 
```

或超过两个或三个或四个。

最终结果应该只有由 ; 分隔的文本。如果只有一个选择，例如业务组合，如果应该没有；。

任何帮助都感激不尽。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T00:52:22.863

使用[Text to Columns](http://www.youtube.com/watch?v=sJmczgZ_Myo) with`#`作为分隔符。将列缝合在一起，比如在 D1 中，将 =CONCATENATE（比如 =E1&F1&G1...）复制下来以适应，复制结果并将特殊值粘贴到顶部，添加

> =IF(右(D1,1)=";",左(D1,LEN(D1)-1),D1)

在备用列的第 1 行并复制下来以适应。复制所有并再次将特殊值粘贴到顶部。删除多余的。

# javascript - 如何为多个 div 元素循环相同的 javascript 代码？

> ID：14407901
> 
> 赞同：1
> 
> 时间：2013-01-18T21:26:11.060
> 
> 标签：javascript

我做了三个“盒子”，每个盒子都包含一个按钮。当我单击按钮时，框隐藏，再次单击时，框出现。

这是我的html代码：

```
<div id="SC1_A_"> <!-- BOX -->
<div id="SC1_B_" onClick="SC1();" class="something">&nbsp;</div> <!-- BUTTON -->
</div>
<div id="SC2_A_">
<div id="SC2_B_" onClick="SC2();" class="something">&nbsp;</div>
</div>
<div id="SC3_A_">
<div id="SC3_B_" onClick="SC3();" class="something">&nbsp;</div>
</div> 
```

这是我的 JavaScript 代码：

```
<script type="text/javascript">    
function SC1(){

  var SC1_A = document.getElementById('SC1_A_);
  var SC1_B = document.getElementById('SC1_B_);

  if (SC1_A.style.display == 'block' || SC1_A.style.display == ''){
      SC1_A.className      = 'something';
      SC1_B.className      = 'something else';}   
else {SC1_A.className      = 'something else';
      SC1_B.className      = 'something';}
     }
     }
</script> 
```

上面的示例有效，但我必须为每个按钮制作三个类似的脚本。所以我想在下面使用 for 循环制作类似这个脚本的东西。你可以想象它没有用。知道我怎样才能让它工作吗？？？

```
<script type="text/javascript">

for (i=1; i<10; i++){

function SCi(){

  var SCi_A = document.getElementById('SC'+i+'_A_');
  var SCi_B = document.getElementById('SC'+i+'_B_');

  if (SCi_A.style.display == 'block' || SCi_A.style.display == ''){
      SCi_A.className      = 'something';
      SCi_B.className      = 'something else';}   
else {SCi_A.className      = 'something else';
      SCi_B.className      = 'something';}
     }
     }
</script> 
```

如果您认为问题太简单，请不要投反对票，但请在这里给我您的帮助！！！先感谢您！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:37:39.017

你走在正确的轨道上，你只需要学习正确的语法来表达你想要表达的东西：

```
var SC = []; 
```

首先，要拥有许多不同的函数，因此我们不会尝试以不同的方式命名它们（您正在尝试这样做），而是将每个函数存储在`SC`数组中的不同索引中。

```
for (var i = 1; i < 10; i++) {
    SC[i] = (function () {
        var SC_A = document.getElementById('SC' + i + '_A_');
        var SC_B = document.getElementById('SC' + i + '_B_');

        return function () {
            if (SC_A.style.display === 'block' || SC_A.style.display === '') {
                SC_A.className = 'something';
                SC_B.className = 'something else';
            } else {
                SC_A.className = 'something else';
                SC_B.className = 'something';
            }
        }
    })();
} 
```

现在，要调用这些函数，你会做`SC[1]()`, `SC[2]()`, ... 所以你可以把它放在`onclick`你的 HTML 中，或者你可以绑定来自 javascript 的事件。

* * *

编辑：我忘了提及这一点，因为它与代码的语法没有直接关系，但对 'document.getElementById `will not work until the document is fully loaded. So if you just put the script directly between to`` 标记的调用将不起作用。你有两个选择。您可以保留当前代码，但[在页面加载时运行它](https://stackoverflow.com/questions/4722687/running-javascript-code-on-page-load-without-using-the-onload-tag)。或者，您可以像这样重构代码：

```
var SC = [];
for (var i = 1; i < 10; i++) {
    SC[i] = (function (i) {
        return function () {
            var SC_A = document.getElementById('SC' + i + '_A_');
            var SC_B = document.getElementById('SC' + i + '_B_');

            if (SC_A.style.display === 'block' || SC_A.style.display === '') {
                SC_A.className = 'something';
                SC_B.className = 'something else';
            } else {
                SC_A.className = 'something else';
                SC_B.className = 'something';
            }
        }
    })(i);
} 
```

这里发生的是`document.getElementById`每次单击按钮时都会调用，而不是在创建函数时调用一次。效率稍低，但它有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:38:53.517

您将页面上的每个部分定义为调用一个函数并传入另一个函数的名称。

```
<div id="SC1_A_"> <!-- BOX -->
<div id="SC1_B_" onClick="SC('SC1_A_');" class="something">&nbsp;</div> <!-- BUTTON -->
</div>
<div id="SC2_A_">
<div id="SC2_B_" onClick="SC('SC2_A_');" class="something">&nbsp;</div>
</div>
<div id="SC3_A_">
<div id="SC3_B_" onClick="SC('SC3_A_');" class="something">&nbsp;</div>
</div> 
```

所有这些都只使用一个功能

```
function SC(nameOfA){

   var SCi_A = document.getElementById(nameOfA);
   var SCi_B = this;

   if (SCi_A.style.display == 'block' || SCi_A.style.display == ''){
       SCi_A.className      = 'something';
       SCi_B.className      = 'something else';
   } else {
       SCi_A.className      = 'something else';
       SCi_B.className      = 'something';}
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T21:51:32.297

在这里，您可以在每次点击时使用此功能：

```
 <div id="SC1_A_"> <!-- BOX -->
         <div id="SC1_B_" onClick="SC(event)" class="something">&nbsp;</div> <!-- BUTTON -->
    </div>
<script type="text/javascript">
    function SC(event){
        var SCA = event.currentTarget.parentNode;
        var SCB = event.currentTarget;

        ................
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-18T21:37:10.027

您重新定义了相同的函数 ( `function SCi`) 八次。唯一保留的函数版本是最后定义的版本。按照您的代码，您只是在创建一个可以与第 8 个框一起使用的函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T21:36:04.637

您的代码定义了一个名为 SCi 的函数 8 次。我认为如果你交换前两行，你会得到你想要的。

# vb.net - 如何使用 LINQ 获取具有特定 SubItem 的所有项目？

> ID：14407902
> 
> 赞同：2
> 
> 时间：2013-01-18T21:26:15.930
> 
> 标签：vb.net, linq, listviewitem

我的软件旨在加密和解密文件。用户将要处理的文件加载到 ListView 控件中。在控件中，每一项都是带有一个子项的文件路径，即进程的类型（ENCRYPT 或 DECRYPT）。

我需要获取具有“ENCRYPT”子项的所有项目（文件路径）的列表，最好使用 LINQ。目前，我的代码如下所示：

```
Dim enclist As New ArrayList()
For i As Int32 = 0 To (lvwLoad.Items.Count - 1)
    If lvwLoad.Items(i).SubItems(1).Text = "ENCRYPT" Then
        enclist.Add(lvwLoad.Items.Item(i).Text)
        count += 1
    End If
Next 
```

我试过这个：

```
Dim list As IEnumerable(Of String) = From item In lvwLoad.Items 
                                     Where item.SubItems(1).Text = "ENCRYPT" 
```

但是这个语句不能访问`SubItems()`数组。我知道我可能缺少一些简单的东西，但我无法弄清楚。

编辑：我知道我可以这样做：

```
Dim enclist As New List(Of String)
For Each item As ListViewItem In lvwLoad.Items
    If item.SubItems(1).Text = "ENCRYPT" Then
        enclist.Add(item.Text)
    End If
Next 
```

但我真的很想知道如何用 LINQ 做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T22:06:31.690

```
return lvwLoad.Items.Where(item => item.SubItems(1).Text = "ENCRYPT").Select(s => s.Text);

Dim list As IEnumerable(Of String) = From item In lvwLoad.Items 
                                 Where item.SubItems(1).Text = "ENCRYPT"
                                     Select item.Text 
```

我希望这将有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T22:13:21.473

尝试下面的代码，您需要将项目投射到`ListViewItem`以便您可以访问`SubItems`

```
Dim list  = From item In lvwLoad.Items.Cast(Of ListViewItem) () _ 
                                     Where item.SubItems(1).Text = "ENCRYPT" 
                                     Select item.Text 
```

# node.js - 循环中的节点 Grunt 异步任务，闭包不起作用

> ID：14407903
> 
> 赞同：9
> 
> 时间：2013-01-18T21:26:21.077
> 
> 标签：node.js, asynchronous, callback, closures, gruntjs

提前感谢您查看此内容。

我在一个不起作用的循环中有一个异步任务。我已确保：

1.  将我的循环变量“key”包装在一个闭包中以避免经典的“仅最后一个值”问题，其中循环在异步任务返回值之前很久就完成了，并且只显示最后一个值。
2.  调用 done(error) 来完成我的异步任务（根据 Gruntjs FAQ）
3.  使用 hasOwnProperty() 确保键是对象的实际属性，而不是来自原型。
4.  遵循 node.exec 示例的格式，除了将 exec 的值分配给一个变量——我试过了，但没有帮助。请参阅下面的第一个参考。

这个函数输出......什么都没有！？由于某种原因， grunt.log.writeln 语句甚至没有触发。任务完成没有错误。我还尝试添加 20 秒的延迟，以防脚本在异步任务返回之前完成。奇怪的是，如果我不调用“done(error)”，文件就会被写入文件（当我用 grunt.file.write 语句替换 writeln 时）。

```
var done = this.async(),
    exec = require('child_process').exec,
    myJSON = {
      "file1" : "C:/home/me/jquery.js",
      "file2 " : "C:/home/me/grunt.js",
      ...
      "fileN" : "C:/home/me/N.js"
    },
    count;

for (var key in myJSON) {
    if (myJSON.hasOwnProperty(key)) {
      (function (key) { 
        exec( 'type "' + myJSON[key] + '"', 
          function(error, stdout, stderr) {
            if (error) {
                grunt.log.writeln('!!! exec error: ' + error);
            }
            grunt.log.writeln('stdout: ' + stdout);
            grunt.log.writeln('stderr: ' + stderr);
            done(error);
          }
        );
      })(key);
    count++;
  }
} 
```

参考：

[http://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback](http://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback) [https://github.com/gruntjs/grunt/wiki/Frequently-Asked-Questions](https://github.com/gruntjs/grunt/wiki/Frequently-Asked-Questions)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-20T21:19:22.480

`done()`应该只在整个操作完成时调用，这意味着当所有`exec()`方法都运行了它们的回调时。目前，您正在`done`每次迭代中执行回调。您可以通过使用grunt ( ( 附带`forEach`的节点模块[async](https://github.com/caolan/async#forEach)`grunt.util.async`中的方法，或者`forEachSeries`如果您希望`exec()`方法按顺序执行。

像这样的东西（未经测试）：

```
var done = this.async();
var exec = require('child_process').exec;
var async = grunt.util.async; // updated
var myJSON = {
  "file1": "C:/home/me/jquery.js",
  "file2": "C:/home/me/grunt.js",
  ...
  "fileN": "C:/home/me/N.js"
};

async.forEach(Object.keys(myJSON), function(el, cb) {
  exec('type "' + myJSON[el] + '"', function(error, stdout, stderr) {
      if (error) {
          grunt.warn('!!! exec error: ' + error)
          return cb(error);
      }
      grunt.log.writeln('stdout: ' + stdout);
      grunt.log.writeln('stderr: ' + stderr);
      cb();
    }
  );
}, function(error) {
  done(!error);
}); 
```

# javascript - 等待响应时暂停 javascript 执行

> ID：14407904
> 
> 赞同：0
> 
> 时间：2013-01-18T21:26:22.687
> 
> 标签：javascript

我正在寻找一种在等待用户做出选择时暂停 javascript 函数的方法。我希望它像提示、警报或确认一样工作（他们暂停脚本），但我想在 html 中创建自己的查询框。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:29:07.803

Setup a callback that will be called when the user make the choice then let the javascript end after showing the choices to the user.

# django - Django syncdb 是否同步编辑的模型？

> ID：14407906
> 
> 赞同：0
> 
> 时间：2013-01-18T21:26:25.710
> 
> 标签：django, django-models

我遇到了一个有趣的问题。我首先创建了一个模型。并同步它。后来我通过添加一个models.DateField（）和一个models.DateTime（）来更改模型。比我重新同步它...但是，当我检查数据库时，没有添加行。这是正常行为还是我做错了什么？后来我删除了所有表并进行了同步数据库，并且所有行都没有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:27:53.030

不，文档非常明确，它[不会更改现有表](https://docs.djangoproject.com/en/1.4/ref/django-admin/#syncdb)。

使用类似[South](http://south.aeracode.org/)的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:27:57.710

Django 本身不支持数据库迁移。为此，您将需要查看[南方](http://south.aeracode.org/ "南")。

[这是一个很好的起点。](http://south.readthedocs.org/en/latest/tutorial/part1.html)

# xml - 如何将 Excel XML 文件读取/转换为 R/CSV？

> ID：14407911
> 
> 赞同：0
> 
> 时间：2013-01-18T21:26:42.360
> 
> 标签：xml, r, excel, csv

我有几百个 XML 文件。它们可能是从/向 Excel 生成的。我想把它读成 R 或转换成 CSV。所有文件的标题如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:html="http://www.w3.org/TR/REC-html40">
<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office"> 
```

我总是可以编写解析器，但想避免这样做。我没有 Excel

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T22:28:08.493

在“R Data Import/Export”手册（随 R 一起安装的免费手册之一）中有一章是关于从 Excel 电子表格中读取数据的。如果上述 XML 文件是从最新版本的 Excel 中保存的电子表格，那么其中一些工具应该很容易读取它们。我可能会从 RODBC 包或 XLConnect 包开始。

如果这些都不起作用，那么 XML 包至少应该使编写解析器更容易。

# php - 如何通过 putty 运行 Perl、PHP 或 Python 脚本文件

> ID：14407921
> 
> 赞同：-1
> 
> 时间：2013-01-18T21:27:48.363
> 
> 标签：php, python, perl, serial-port, putty

我需要通过 Putty 运行脚本文件。我使用的脚本语言可以是 Perl、PHP 或 Python。我将使用脚本文件打开一个包含一系列 AT 命令的文本文件（它们只是与调制解调器对话的命令），并通过“串行端口”将命令发送到调制解调器。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:30:59.120

一个可行的选择是在本地机器上创建脚本并从那里执行它。如果您使用的是 Linux 机器 - 很可能 perl 或 python 已经存在。我将假设你是一个初学者——所以如果这一切对你来说非常非常明显，请不要感到被侮辱。

跑：

```
perl -v 
```

或者

```
python -v 
```

如果有什么东西弹出......你可能很高兴：

```
vim myscript.pl 
```

或者

```
vim myscript.py 
```

并编写你的程序。如果没有 vim，则使用 vi 代替。

然后，最后：

```
./myscript.pl 
```

或者

```
./myscript.py 
```

在 vim 或 vi 上要小心——如果这是你第一次使用这些……可能会有点多。另外，请注意，您可以从剪贴板复制并粘贴到其中之一 - 在 PuttY 中，右键单击是粘贴，因此只需复制所有代码并将其粘贴进去 - 但始终...验证粘贴是否正确并得到所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:29:26.770

通过命令行运行 PHP 并使用此库编写代码。

[https://code.google.com/p/php-serial/](https://code.google.com/p/php-serial/)

# c++ - c/c++ size为0时strncmp的返回值是多少

> ID：14407924
> 
> 赞同：6
> 
> 时间：2013-01-18T21:27:54.467
> 
> 标签：c++, c, size, strncmp

c/c++ strncmp 签名如下：

```
int strncmp ( const char * str1, const char * str2, size_t num ); 
```

我的问题是如果 num 为 0，返回值是多少？标准怎么说？不要从一些在线文档中找到答案。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T21:29:26.677

Well, `strncmp` compares at most `num` characters from the two strings, so with `num == 0`, it compares none, hence finds no difference, thus it returns 0.

# uitableview - 滚动后按钮出现在 UITableView 单元格中

> ID：14407929
> 
> 赞同：0
> 
> 时间：2013-01-18T21:28:01.827
> 
> 标签：uitableview

我不确定这段代码有什么问题，但是在我没有添加按钮的单元格中（我有一个如果检查我是否需要添加它）按钮在向下滚动然后再次向上滚动后出现.

这是表格视图中单元格生成功能的代码。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CLASSshopCell *cell = [tableView dequeueReusableCellWithIdentifier:@"shopCell"];

    SKProduct * product = (SKProduct *) _products[indexPath.row];
    cell.titleCell.text = product.localizedTitle;
    cell.descCell.text  = product.localizedDescription;

    [_priceFormatter setLocale:product.priceLocale];
    cell.priceCell.text = [_priceFormatter stringFromNumber:product.price];

    // already yours, so no cart button
    if ([[CLASSIAPHelper sharedInstance] productPurchased:product.productIdentifier]) {
        cell.priceCell.text = @"Already yours";
    } else {
          UIButton *buyButton = [UIButton buttonWithType:UIButtonTypeCustom];
          UIImage *btn = [UIImage imageNamed:@"cart.png"];
          UIImage *btnh = [UIImage imageNamed:@"cartHover.png"];

          [buyButton setBackgroundImage:btn forState:UIControlStateNormal];
          [buyButton setBackgroundImage:btnh forState:UIControlStateHighlighted];
           buyButton.frame = CGRectMake(cell.bounds.size.width - 40,40, 24, 24);
           buyButton.tag = indexPath.row;

        [buyButton addTarget:self action:@selector(buyButtonTapped:) forControlEvents:UIControlEventTouchUpInside];
         [cell.contentView addSubview:buyButton];
    }

    return cell;
} 
```

记录一些我没有注意到什么特别的东西，条件总是得到验证。你有什么主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T15:17:54.730

您添加按钮的单元格最终将被重用。这就是为什么你会把按钮放在错误的单元格上；）

作为一种解决方案，您应该对带有和不带有按钮的单元格使用不同的重用标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:59:28.720

我自己使用另一个问题的部分代码解决了。基本上我现在正在循环进入单元格，在再次进行测试之前清除所有按钮。

```
for (UIView *subview in [self.contentView subviews]) 
{
    if ([subview isKindOfClass:[UIButton class]]) 
    {
        [subview removeFromSuperview];
    }
} 
```

# java - Ant：如何创建不可变的文件集？

> ID：14407938
> 
> 赞同：1
> 
> 时间：2013-01-18T21:28:33.500
> 
> 标签：java, ant

如何在 Ant 中创建文件的动态列表，然后保存此列表以供以后在构建过程中使用？我在想的是类似 immutable 的东西`Fileset`。 `Filelist`不起作用，因为它不接受通配符。

换句话说，我想创建一个基于包含/排除通配符的文件列表，这些通配符一旦创建就不会改变。也就是说，即使稍后添加了更多通过包含/排除规则的文件——我想保留初始文件集结果（特别是在构建过程中稍后删除）。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:03:44.877

好吧，这就是我想出的。使用 pathconvert 将文件集存储到属性。然后在构建的后期迭代文件，对它们做任何你需要做的事情。就我而言，删除它们。

```
<macrodef name="storeBuildState">
    <sequential>
        <fileset dir="${build.dir}" id="current.fileset">
            <include name="**/*.jar" />
        </fileset>

        <pathconvert pathsep="," property="current.fileset.prop" refid="current.fileset"/>
    </sequential>
</macrodef> 

<macrodef name="deleteStoredBuildState">
    <sequential>
        <for list="${current.fileset.prop}" param="file">
            <sequential>
                <delete file="@{file}" verbose="true" />
            </sequential>
        </for>
    </sequential>
</macrodef> 
```

# android - 水平导航并点击按钮以垂直进入另一个布局

> ID：14407940
> 
> 赞同：1
> 
> 时间：2013-01-18T21:28:43.980
> 
> 标签：android, android-layout, android-listview, android-viewpager, android-scrollview

我一直在试图弄清楚如何去做这个特定的任务，但我不太明白。

所以，我有一个 ViewPager 设置，它有 2 个完美运行的布局。在登陆寻呼机中，我有一个按钮。我想做的是，点击那个按钮，页面垂直（向上）动画到另一个布局。

我在开始一个新的活动时得到了类似的动作，但问题是标题栏也被动画化了。所以它不会为上面的布局提供这种流畅的运动。

我尝试了几件事，但遇到了很多崩溃。

然后我正在考虑让登陆 Pager 成为一个 ScrollView 并将两个布局堆叠在一起，并导航到特定的 id，但无济于事。

我说的有道理吗？我应该如何去创造这样的东西？

所以总结一下。

*   登陆一个页面，您可以在该页面上滑动到另一个页面（左）。
*   能够点击一个按钮（在登录页面上）并动画（垂直）到另一个布局。
*   所有这些都具有静态标题栏。

提前致谢。

# ruby - Getting Data from Public Google Calendars with Ruby

> ID：14407944
> 
> 赞同：2
> 
> 时间：2013-01-18T21:28:59.673
> 
> 标签：ruby, google-calendar-api

I want to download and parse all the event data from a website's public google calendar, what would be the best way to do so? I'm considering just downloading the ics file or getting xml data and parsing that myself. I've looked into google api but it looks unnecessarily complex if all I want to do is read the data. I'm a beginner to working with API's and programming in general so I'm having trouble navigating all that documentation. They don't provide very many helpful examples.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T22:03:19.980

像这样的东西怎么样：

```
require 'ri_cal'
require 'open-uri'

components = nil
open("https://www.google.com/calendar/ical/ocs.events%40gmail.com/public/basic.ics") do |cal|
  components = RiCal.parse(cal)
end

components.each do |calendar|

  calendar.events.each do |event|
    puts "#{event.summary} starts at: #{event.dtstart} and ends at #{event.dtend}"
  end

end 
```

您将需要安装 ri_gem。

更新：使用 iCalendar

```
require 'icalendar'
require 'open-uri'

calendars = nil
open("https://www.google.com/calendar/ical/ocs.events%40gmail.com/public/basic.ics") do |cal|
  #calendars = RiCal.parse(cal)
  calendars = Icalendar.parse(cal)
end

calendars.each do |calendar|

  calendar.events.each do |event|
    puts "#{event.summary} starts at: #{event.dtstart} and ends at #{event.dtend}"
  end

end 
```

# java - 使用Java从动态网站中提取链接

> ID：14407950
> 
> 赞同：1
> 
> 时间：2013-01-18T21:29:28.333
> 
> 标签：java, html-parsing, web-crawler, jsoup

我正在尝试从网站中提取所有链接。我在以前的程序中使用 Jsoup 来执行此操作，这里的问题是“更多内容”是通过按更多按钮生成的，它不会更改页面，它只是加载更多内容，所以我不确定如何查看所有使用 Java 和 Jsoup 的可用链接。

该网站是[http://seekingalpha.com/symbol/msft](http://seekingalpha.com/symbol/msft)，我只是试图提取指向特定公司（例如 Microsoft）的文章的所有链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:39:03.627

你需要给自己一些可以监视你通过网络发出的请求的东西。您可以使用 Chrome 中的“网络”选项卡查看 http 流量，但我个人喜欢 Charles。无论如何，如果您查看单击更多按钮时发生的情况，您会看到正在发出 POST 请求（当然使用 AJAX），看起来像这样：

[http://seekingalpha.com/account/ajax_headlines_content](http://seekingalpha.com/account/ajax_headlines_content) 200 POST seekalpha.com /account/ajax_headlines_content 432 毫秒 5.94 KB 完成

在标题中，参数是：

键入所有第 2 页 slugs msft is_symbol_page true

因此，如果我是您，我将通过使用页面参数计数的 POST 请求来模拟这一点，直到您获得所需的所有内容。顺便说一下，返回的内容是一个很容易解析的 html 片段，例如：

```
> <div class="symbol_articles_list mini_category">
>     <div>
>       <ul>
>           <li>
>               <div class="fl">
>                 <a class="small_picture" href="/author/the-part-time-investor">
>                   <img height="20" width="20" src="http://static1.cdn-seekingalpha.com/images/users_profile/000/541/113/small_pic.png?1352646193"/>
>                 </a>
>               </div>
>             <div class="content">
>               <div class="symbol_article">
>                 <a href="/article/1109901-microsoft-and-4-other-undervalued-stocks"
> sasource="portfolio_rel">Microsoft And 4 Other Undervalued Stocks</a>
>                 <div class="date_on_by">
>                     <a sasource="portfolio_rel" href="/author/the-part-time-investor">The Part-time Investor</a>
>                   <span class="bullet">&bull;</span>
>                   Mon, Jan 14<span class='bullet'>&bull;</span> <span class='comments'><a
> href='/article/1109901-microsoft-and-4-other-undervalued-stocks#comments_header'
> sasource='headlines_tabs'>44&nbsp;Comments</a></span>               
> </div>
>               </div>
>             </div>
>             <div class="cleaner"></div>
>           </li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:34:08.447

我会使用[HtmlUnit](http://htmlunit.sourceforge.net/)。提取显示的链接，然后单击“更多”（HtmlUnit 将执行加载更多链接的 javascript））并提取新显示的链接

# c# - Get file size without using System.IO.FileInfo?

> ID：14407954
> 
> 赞同：13
> 
> 时间：2013-01-18T21:29:44.097
> 
> 标签：c#, filepath, filesize, fileinfo

Is it possible to get the **size** of a file in C# without using `System.IO.FileInfo` at all?

I know that you can get other things like Name and Extension by using `Path.GetFileName(yourFilePath)` and `Path.GetExtension(yourFilePath)` respectively, but apparently not file size? Is there another way I can get **file size** without using `System.IO.FileInfo`?

The only reason for this is that, if I'm correct, FileInfo grabs more info than I really need, therefore it takes longer to gather all those FileInfo's if the only thing I need is the size of the file. Is there a faster way?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-18T22:41:47.597

我使用这两种方法进行了基准测试：

```
 public static uint GetFileSizeA(string filename)
    {
        WIN32_FIND_DATA findData;
        FindFirstFile(filename, out findData);
        return findData.nFileSizeLow;
    }

    public static uint GetFileSizeB(string filename)
    {
        IntPtr handle = CreateFile(
            filename,
            FileAccess.Read,
            FileShare.Read,
            IntPtr.Zero,
            FileMode.Open,
            FileAttributes.ReadOnly,
            IntPtr.Zero);
        long fileSize;
        GetFileSizeEx(handle, out fileSize);
        CloseHandle(handle);
        return (uint) fileSize;
    } 
```

运行超过 2300 个文件，GetFileSizeA 需要 62-63 毫秒才能运行。GetFileSizeB 花费了 18 秒。

除非有人看到我做错了什么，否则我认为答案很清楚，哪种方法更快。

有没有办法可以避免实际打开文件？

**更新**

将 FileAttributes.ReadOnly 更改为 FileAttributes.Normal 减少了时间，因此这两种方法的性能相同。

此外，如果您跳过 CloseHandle() 调用，GetFileSizeEx 方法的速度会提高大约 20-30%，尽管我不知道我是否会建议这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-19T09:19:48.340

从我做的一个简短测试中，我发现使用 FileStream 平均比使用 Pete 的 GetFileSizeB 慢 1 毫秒（通过网络共享花了我大约 21 毫秒......）。就我个人而言，我更喜欢尽可能保持在 BCL 范围内。

代码很简单：

```
using (var file = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
{
    return file.Length;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T20:21:45.327

不是直接的答案...因为我不确定使用 .NET 框架是否有更快的方法。

这是我正在使用的代码：

```
 List<long> list = new List<long>();
  DirectoryInfo di = new DirectoryInfo("C:\\Program Files");
  FileInfo[] fiArray = di.GetFiles("*", SearchOption.AllDirectories);
  foreach (FileInfo f in fiArray)
    list.Add(f.Length); 
```

运行它，在我的“程序文件”目录上运行了 2709 毫秒，大约有 22720 个文件。无论如何，这绝不是懈怠。此外，当我`*.txt`将该方法的第一个参数用作过滤器时`GetFiles`，它会将时间大幅缩短至 461 毫秒。

这在很大程度上取决于您的硬盘驱动器的速度，但我真的不认为 FileInfo 会影响性能。

注意：我认为这仅对 .NET 4+ 有效

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-18T22:16:04.213

根据[此评论](https://stackoverflow.com/questions/14407954/get-file-size-without-using-system-io-fileinfo/14408090#comment20049557_14407954)：

> 我有一个小型应用程序，它收集大小信息并将其保存到一个数组中......但我经常有半百万个文件，给予或接受，并且需要一段时间才能浏览所有这些文件（我正在使用 FileInfo） . 我只是想知道是否有更快的方法...

由于您发现了这么多文件的长度，因此您更有可能从并行化中受益，而不是尝试通过另一种方法获取文件大小。该类`FileInfo`应该*足够好*，并且任何改进都可能很小。

另一方面，并​​行化文件大小请求有可能*显着*提高速度。（请注意，改进程度很大程度上取决于您的磁盘驱动器，而不是您的处理器，因此结果可能会有很大差异。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-20T02:36:05.493

如果您想在非 Windows 主机上的 .NET Core 或 Mono 运行时上执行此操作，这是一个快速的解决方案：

包括[Mono.Posix.NETStandard](https://www.nuget.org/packages/Mono.Posix.NETStandard/) NuGet 包，然后是这样的......

```
using Mono.Unix.Native;

private long GetFileSize(string filePath)
{
    Stat stat;
    Syscall.stat(filePath, out stat);
    return stat.st_size;
} 
```

我已经在 Linux 和 macOS 上测试了这个正在运行的 .NET Core - 不确定它是否适用于 Windows - 考虑到这些是 POSIX 系统调用（并且包由 Microsoft 维护），它可能会。如果没有，请结合其他基于 P/Invoke 的答案以涵盖所有平台。

与 相比`FileInfo.Length`，当获取另一个进程/线程正在写入的文件的大小时，这给了我更可靠的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T21:33:55.610

你可以试试这个：

```
[DllImport("kernel32.dll")]
static extern bool GetFileSizeEx(IntPtr hFile, out long lpFileSize); 
```

但这并没有太大的改善...

以下是从 pinvoke.net 获取的示例代码：

```
IntPtr handle = CreateFile(
    PathString, 
    GENERIC_READ, 
    FILE_SHARE_READ, 
    0, 
    OPEN_EXISTING, 
    FILE_ATTRIBUTE_READONLY, 
    0); //PInvoked too

if (handle.ToInt32() == -1) 
{
    return; 
}

long fileSize;
bool result = GetFileSizeEx(handle, out fileSize);
if (!result) 
{
    return;
} 
```

# jquery - 设置 jquery datepicker (dd.mm.yyyy)

> ID：14407955
> 
> 赞同：1
> 
> 时间：2013-01-18T21:29:46.897
> 
> 标签：jquery, jquery-ui-datepicker

我有一个具有以下日期格式的字符串：23.01.2012

如何将mindate设置为指定日期？如果我直接使用该变量，并且我发现的其他帖子使用另一种日期格式，则不会发生任何事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T21:39:37.033

你可以尝试这样的事情：

```
var time_value = '23.01.2012';
var values = time_value.split(".");
var parsed_date = new Date(values[2], values[1], values[0]);

$('.datepicker').datepicker({
  minDate: parsed_date
}); 
```

警告：（未测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-19T17:57:11.137

那这个呢？

```
var parsed_date = new Date(values[2], **values[1]-1** , values[0]); 
```

# php - How 2 concatenate 2 array elements while used in HTML

> ID：14407960
> 
> 赞同：-1
> 
> 时间：2013-01-18T21:30:24.480
> 
> 标签：php, html, arrays, concatenation

I have a less advanced question for you programmers out there, that i need help with.

Simply i am trying to add 2 elements of my array into a echo display statement.

This is not so hard but what im having issues with is being able to concatenate the parenthesis with the array to show as : The Matrix (1999).

i don't want the the parenthesis to be included in the array just to add the elements within them.

any help would be greatly appreciated, thanks guys (MY GUESS IS THAT I'M NOT PROPERLY CONCATENATING THE ELEMENTS.)

CODE IM USING::

```
<?php $movie = array(
"title" => "The Matrix"
"year" => "1999"
 ); ?>

<h1><?php 
echo $movie["title"] ."(" . $movie["year"] .")"
;?></h1> 
```

OKAY SO I REALIZED I MISSED THE COMMA. BUT THAT WAS NOT MY PROBLEM. THAT WAS A TYPO ON MY PART ON HERE.

THIS WAS AN EXERCISE THAT I NEEDED TO PASS .

TASK : Right now, the element has the year of the first movie as a static piece of text . Replace that with a PHP command to display the year of the second movie from the array.(Be sure to leave the parentheses intact.)

what i have is i created the array $movie = array();

then i created the elements within the array

```
<?php $movie =array(
"title"=>"Empire Strikes Back", 
"year" => "1980"; )?> 
```

so what i need to do is echo out the elements which i pass the first stage which is just adding the title variable:

```
<?php echo $movie["title"];?> (1985) 
```

step two is adding the year element in the array, i have tried everything from concatenation of the parenthesis and adding the year to creating two separate php blocks . my problem is that i keep getting the error that my exercise 3 doesn't seem to pass.

```
<?php echo $movie["title"] . "(" .$movie["year"] . ")" ;?>
<?php echo $movie["title"];?> (<?php echo $movie["year"]; ?>) 
```

ANY SUGGESTIONS WOULD BE GREAT. I SEEM TO BE STUCK ON THIS FOR COUPLE DAYS NOW. I KNOW THIS HAS POTENTIAL TO BE CONFUSING IF YOU DONT SEE THE EXERCISE, BUT THIS WAS THE BEST I COULD DO FOR A 8 PART EXERCISE.

thanks

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T21:31:50.397

Your missing a comma after `Matrix",<<<`

```
<?php $movie = array(
"title" => "The Matrix",
"year" => "1999"
 ); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:38:15.913

你必须知道 [数组](http://php.net/manual/en/language.types.array.php)是语言结构。它接受任意数量的逗号分隔`key => value`对作为参数。所以，你错过了逗号。对于最后一个数组元素，逗号可以省略。

# javascript - 如何延迟加载任何东西

> ID：14407964
> 
> 赞同：8
> 
> 时间：2013-01-18T21:30:43.623
> 
> 标签：javascript, jquery, html

我知道能够使用一些第三方 jquery 库延迟加载“图像”。无论如何，当用户滚动到该容器时，是否可以延迟加载几乎任何`<div>`元素容器之类的东西`<div>`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T22:23:39.947

要扩展 kinsho 的（正确）答案：

出于安全性和可维护性的原因，您应该警惕将原始 HTML 直接注入到文档中。这样做可能会破坏事件侦听器、破坏 DOM 解析器，并可能引发安全漏洞。

通常，延迟加载内容的最佳方式是将编码数据（例如 JSON 或 XML）发送到客户端，并相应地处理结果。对于基本的 HTML，可以使用模板解决方案。甚至 an`iframe`也比将`<div><h1>Hello</h1><table><tbody><td><tr>1</td></tr><tr><td>2</td></tr></tbody></table></div>`* 粘贴到元素的`innerHTML`.

此外，在为您的网站实施延迟加载之前，请花一些时间考虑它是否真的值得。一个额外的 HTTP 请求比一次下载数据要昂贵得多，而且任何通过 Javascript 注入的 HTML 都不会被网络搜索爬虫看到。所以，如果你只是注入少量的静态信息，那真的不值得麻烦。

* * *

*你能找到解析错误吗？现在想象一下对标准大小的 HTML 文档执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-18T21:44:49.030

为什么要依赖一些第三方库来帮助你延迟加载？您可以使用本机 JavaScript 做得很好。

事实上，只要你接受所有延迟加载都是由某些用户操作触发的原则，就可以在特定对象（无论是滚动条、某些部分标题等）上设置一个侦听器。设置一个依赖 AJAX 的相应处理程序（您可以在此处使用 jQuery）来获取数据（最好是 HTML），您可以使用`innerHTML`容器元素的属性将其直接加载到您想要的任何容器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:18:33.220

这是您真正想要开始的。这是我自己制作的一个新的 jQuery 插件。您可以根据您想要的任何元素（jQuery 选择器）“延迟加载”任何您想要的东西。

[https://github.com/shrimpwagon/jquery-lazyloadanything](https://github.com/shrimpwagon/jquery-lazyloadanything)

# matlab - detect digits with hopfield Neural network in matlab

> ID：14407965
> 
> 赞同：0
> 
> 时间：2013-01-18T21:30:45.630
> 
> 标签：matlab, neural-network

I want to detect digist with hopfield.for any digit let 96 cell ( 8*12). my data are

```
zero=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
one=[0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 ];
two=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
three=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
four=[0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 0 0 0 0 1 0 1 0 0 0 0 1 0 0 1 0 0 0 1 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 ];
five=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
six=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
seven=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 ];
eight=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];
nine=[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 ];

target =[zero;one;two;three;four;five;six;seven;eight;nine]; 
```

and create a hopfield with newhop

```
 net = newhop(target);
 [Y,Pf,Af] = sim(net,10,[],target); 
```

I conclusion this from [matlab website](http://www.mathworks.com/help/nnet/examples/hopfield-unstable-equilibria.html) but really I don't know How I achive this **my project is detect digits by hopfield network** appreciate any orgency help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T21:33:51.613

尝试：

```
target =[zero;one;two;three;four;five;six;seven;eight;nine]'; 
```

然后，进行测试：

```
test={three'};
[Y,Pf,Af] = sim(net,{1 5},{},test);
Y{1} 
```

您会注意到 Y{1}-thr​​ee' 非常接近于零，这意味着您的网络可以正常工作。现在，为了识别您输入的数字，您需要从数字矩阵中减去 Y{1} 并检查其元素最接近零的行。这将指示您输入的数字。

# c - 两个相似的功能，不同的结果

> ID：14407967
> 
> 赞同：-1
> 
> 时间：2013-01-18T21:30:53.103
> 
> 标签：c

我的大脑很痛。我无法弄清楚这里发生了什么。如果允许给出最佳答案的人，我会付钱。

我有这个用于学校的体重程序，它允许用户输入起始体重，然后通过一个开关调用各种功能，这些功能可以让用户增加体重或减轻体重。有些函数返回我所期望的，有些则没有。这些函数返回我所期望的 cakeGain()、hardWorkout()、mediumWorkout()，但我无法弄清楚为什么我在 runLoss()、burgerGain()、pizzaGain() 和 easyWorkout() 上得到不正确的返回。我似乎无法弄清楚这些功能之间有什么大的区别，我尝试了各种选择。我最初是通过引用所有函数来传递我的权重变量并让它们更改值，但我的导师不想要所有的指针。

这不是漂亮的代码，我已经注释掉了一些我将在稍后修复的部分。我知道我的很多工作都是糟糕的形式（系统调用等），但我的导师没有教我们替代方法或不在乎。这仍然被认为是初学者课程。我很好奇的是为什么有些功能可以工作，而其他功能却不能。

再次感谢，

迈克（我真的很感谢他们从他们的日程安排中抽出时间来帮助像我这样的人。我等不及我有能力帮助别人的那一天了）。

```
#include <stdlib.h>
#include <stdio.h>
#include <ctype.h>
#define pause system ("pause")
#define cls system ("cls")
#define flush fflush(stdin)

//prototype functions here
void mainMenu(void);
char getUserChoice();
double enterWeight();
double runLoss(double usersWeight);
double burgerGain(double usersWeight);
double eatPizza(double usersWeight);
double eatCake(double usersWeight);
double hardWorkout(double usersWeight);
double mediumWorkout(double usersWeight);
double easyWorkout(double usersWeight);
//void weightChecker(double usersWeight);

int main() {
    //declare main variables here
    char userChoice = ' ';
    double usersWeight;

    do {
        userChoice = getUserChoice(); 

        switch (userChoice) {
                case'A': //get weight
                usersWeight = enterWeight();
                cls;
                printf("Your starting weight is: %dlbs.\n\n",usersWeight);
                break;
            case'B': //run
                usersWeight = runLoss(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'C': //eat burger
                usersWeight = burgerGain(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'D': //eat pizza
                usersWeight = eatPizza(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'E': //eat cake
                usersWeight = eatCake(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'F': //hard workout
                usersWeight = hardWorkout(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'G': //medium workout
                usersWeight = mediumWorkout(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'H': //easy workout
                usersWeight = easyWorkout(usersWeight);
                cls;
                printf("Your weight is now %d.\n", usersWeight);
                //weightChecker(usersWeight);
                break;
            case'I': //quit
                exit(0);

    }

    } while(userChoice != 'I');

    return 0;

} //end of main

char getUserChoice() {
    char result;
    do {
    mainMenu();
    scanf("%c", &result);
    flush;
    result = toupper (result);

    } while (result < 'A' || result > 'I');

    return result;

}

void mainMenu(void) {
    //cls;
    printf("A) \tEnter starting weight or change weight\n");
    printf("B) \tGo running\n");
    printf("C) \tEat Hamburgers\n");
    printf("D) \tEat pizza\n");
    printf("E) \tEat cake\n");
    printf("F) \tDo a hard workout\n");
    printf("G) \tDo a medium workout\n");
    printf("H) \tDo a easy workout\n");
    printf("I) \tQuit\n\n");
    printf("Enter your selection: ");

}

double enterWeight() {
    double startingWeight = 0.0;
    printf("Please enter your starting weight.\n");
    scanf("%i", &startingWeight);
    flush;

    return startingWeight;
}

double runLoss(double usersWeight) {
    double result;
    double milesRan = 0.0;
    double runMinus = 0.0;
    printf("How many miles did you run?\n");
    scanf("%i", &milesRan);
    flush;
    runMinus = milesRan * .005;
    result = usersWeight - runMinus;

    return result;
}

double burgerGain(double usersWeight) {
    double result;
    double hamburgersAte = 0.0;
    double hamburgerGain = 0.0;
    printf("How many hamburgers did you eat?\n");
    scanf("%i", &hamburgersAte);
    flush;
    hamburgerGain = hamburgersAte * .005;

    if (hamburgersAte > 2) {
        hamburgerGain = hamburgerGain + .5;
    }

    result = usersWeight + hamburgerGain;

    return result;
}

double eatPizza(double usersWeight) {
    double result;
    double pizzas = 0.0;
    double pizzaGain = 0.0;
    printf("How many pizza's did you eat?\n");
    scanf("%i", &pizzas);
    flush;
    pizzaGain = pizzas * .075;

    if (pizzas > 2) {
        pizzaGain = pizzaGain + 1;
    }

    result  = usersWeight + pizzaGain;

    return result;
}

double eatCake(double usersWeight) {
    double result;
    double cakesEaten = 0.0;
    double cakeGain = 0.0;
    printf("How many cakes did you eat?\n");
    scanf("%i", &cakesEaten);
    flush;
    cakeGain = cakesEaten * 2;
    result = usersWeight + cakeGain;

    return result;
}

double hardWorkout(double usersWeight) {
    double result;
    double hardWorkoutHours = 0.0;
    double hardWorkoutLoss = 0.0;
    printf("How many hours did you perform a hard workout?\n");
    scanf("%i", &hardWorkoutHours);
    flush;
    hardWorkoutLoss = hardWorkoutHours * 1;

    if (hardWorkoutHours > 2) {
        hardWorkoutLoss = hardWorkoutLoss + 1;
    }

    result = usersWeight - hardWorkoutLoss;

    return result;
}

double mediumWorkout(double usersWeight) {
    double result;
    double mediumWorkoutHours = 0.0;
    double mediumWorkoutLoss = 0.0;
    printf("How many hours did you perform a medium workout?\n");
    scanf("%i", &mediumWorkoutHours);
    flush;
    mediumWorkoutLoss = mediumWorkoutHours * .5;

    if (mediumWorkoutHours > 2) {
        mediumWorkoutLoss = mediumWorkoutLoss + .25;
    }

    result = usersWeight - mediumWorkoutLoss;

    return result;
    }

    double easyWorkout(double usersWeight) {
    double result;
    double easyWorkoutHours = 0.0;
    double easyWorkoutLoss = 0.0;
    printf("How many hours did you perform a easy workout?\n");
    scanf("%i", &easyWorkoutHours);
    flush;
    easyWorkoutLoss = easyWorkoutHours * .025;
    result = usersWeight - easyWorkoutLoss;

    return result;
    }

    /*void weightChecker(double usersWeight) {

    if (usersWeight >= 200 && usersWeight <= 400) 
    {
        printf("You are obese, time to start working out.\n");
    }
    else if (usersWeight >= 150 && usersWeight < 200)
    {
        printf("Your weight is considered heavy, time to cut down on junk food.\n");
    }
    else if (usersWeight >= 125 && usersWeight <150)
    {
        printf("You are fit, keep up the good work.\n");
    }
    else if (usersWeight >= 80 && usersWeight <125)
    {
        printf("You are thin, time to start considering eating more.\n");
    }
    else
    {
        printf("You are dead due to improper weight management. Game Over!\n");
        pause;
        exit(0);
    }

    pause;
} */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T21:40:24.747

当您打印双精度或浮点值时，您应该使用 %f

```
float x;
x = eatNutella();
printf("x is %f\n", x); 
```

%d 用于十进制值（如 int）

# jquery - jQuery - 访问数组中的元素

> ID：14407969
> 
> 赞同：7
> 
> 时间：2013-01-18T21:30:53.837
> 
> 标签：jquery, arrays

我需要能够从数组中获取元素的宽度

HTML

```
<div id="container">
  <ul>
     <li id="one">--------</li><br />
     <li id="two">----------------</li><br />
     <li id="three">-------</li><br />
  </ul>
</div> 
```

JS

我知道我可以像这样访问单个宽度

```
$('#one').width(); 
```

但是在一个数组中

```
var $array = $("#container li"); 
```

如何通过索引访问元素的特定宽度

例如

```
$array[2].width(); //which causes error 
```

示例[http://jsfiddle.net/8zvkn/](http://jsfiddle.net/8zvkn/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T21:32:11.167

使用[eq](http://api.jquery.com/eq/)：

```
$('#container li').eq(i) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-18T21:32:48.237

您可以使用`.eq`如下功能，

```
$array.eq(2).width() 
```

**演示：http:** [//jsfiddle.net/8zvkn/2/](http://jsfiddle.net/8zvkn/2/)

`$array[2]`- 返回 DOM 元素，但您需要的是具有该`.width`功能的 jQuery 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:45:25.837

您也可以使用 nth-child 执行以下操作：

```
$("#container li:nth-child(1)").width(); // first li 
```

# python - Python script to automate in linux based environment

> ID：14407973
> 
> 赞同：0
> 
> 时间：2013-01-18T21:31:06.827
> 
> 标签：python, scripting

I tried running the `myview` command and it ran successfully, but I am stuck after this step.

I have to choose from a list of views and have to pass in a number, for example say <1>,<2>..<10>. But when I execute the script it shows me option on the terminal window instead. Which command should I be using? Because after this I have to run a bunch of other commands as well and basically have to execute them in a particular order. So say cmd should wait for cmd to finish. Thanks in advance for the help.

This is what I have so far.

```
#! /usr/bin/python
import sys
from subprocess import call
for arg in sys.argv:
    print arg
call(["myview"]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T21:36:26.783

查看[subprocess 的文档](http://docs.python.org/2/library/subprocess.html)。我认为您需要的 API 调用是`check_call`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:37:58.980

来自[`pydoc subprocess`](http://docs.python.org/2/library/subprocess.html)：

```
try:
    retcode = call("mycmd" + " myarg", shell=True)
    if retcode < 0:
        print >>sys.stderr, "Child was terminated by signal", -retcode
    else:
        print >>sys.stderr, "Child returned", retcode
except OSError, e:
    print >>sys.stderr, "Execution failed:", e 
```

# c++ - 指向数组的指针获取大小 C++

> ID：14407975
> 
> 赞同：0
> 
> 时间：2013-01-18T21:31:29.220
> 
> 标签：c++, arrays, pointers, int

```
int * a;
a = new int[10];
cout << sizeof(a)/sizeof(int); 
```

如果我使用普通数组，答案将是**10**，唉，打印的幸运数字是**1**，因为 sizeof(int) 是 4 而 iszeof(*int) 也是 4 。我该如何克服？在我的情况下，将大小保存在内存中是一个复杂的选择。如何使用代码获取大小？

我最好的猜测是遍历一个数组并搜索它的结尾，结尾是 0，对吗？有什么建议么？

**- 编辑**

好吧，我对向量的担心是它会在推回时重新分配，你明白了，我可以分配内存。但是我不能改变结构，整个代码都是相关的。感谢您的回答，我看到没有办法，所以我只是寻找一种将大小存储在内存中的方法。

我问的不是使用什么样的结构。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-18T21:32:43.630

简单的。

使用`std::vector<int>`Or `std::array<int, N>`（其中`N`是编译时常量）。

如果您在编译时知道数组的大小，并且它不需要在运行时增长，那么使用`std::array`. 其他使用`std::vector`。

这些被称为*序列容器*类，它定义了一个称为`size()`返回容器中元素数量的成员函数。您可以在需要知道大小时使用它。:-)

阅读文档：

*   [std::array 示例](http://en.cppreference.com/w/cpp/container/array)
*   [std::](http://en.cppreference.com/w/cpp/container/vector) vector[示例](http://en.cppreference.com/w/cpp/container/vector/vector)

使用 时，如果您对容器将容纳的元素数量有一些模糊的概念，`std::vector`则应考虑使用。`reserve()`这将为您带来性能优势。

如果您担心`std::vector`vs *raw-arrays*的性能，请在此处阅读接受的答案：

*   [std::vector 比普通数组慢很多吗？](https://stackoverflow.com/questions/3664272/stdvector-is-so-much-slower-than-plain-arrays)

它解释了为什么问题中的代码很慢，这与它本身**无关**`std::vector`，而是它的错误使用。

* * *

如果您不能使用其中任何一个，并且被迫使用`int*`，那么我建议您使用这两种替代方案。选择适合您需要的任何东西。

```
struct array
{
      int *elements;  //elements
      size_t size;    //number of elements
}; 
```

这是不言自明的。

第二个是这样的：为**另一个**元素分配内存并将大小存储在第一个元素中：

```
int N = howManyElements();
int *array = int new[N+1];  //allocate memory for size storage also!
array[0] = N; //store N in the first element!

//your code : iterate i=1 to i<=N 

//must delete it once done
delete []array; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:32:33.160

`sizeof(a)`将是指针的大小，而不是分配数组的大小。

分配后无法获取数组的大小。`sizeof`运算符必须能够在编译时进行评估。

编译器如何知道这个函数中的数组有多大？

```
void foo(int size)
{
    int * a;
    a = new int[size];
    cout << sizeof(a)/sizeof(int);
    delete[] a;
} 
```

它不能。因此，运算符不可能`sizeof`返回已分配数组的大小。而且，事实上，没有可靠的方法来获取您分配的数组的大小`new`。让我重复一遍**，没有可靠的方法来获取您分配的数组的大小`new`**。您必须将大小存储在某个地方。

幸运的是，这个问题已经为您解决了，并且保证在任何 C++ 实现中都存在。如果您想要一个很好的数组来存储数组的大小，请使用`::std::vector`. 特别是如果您`new`用于分配数组。

```
#include <vector>

void foo(int size)
{
    ::std::vector<int> a(size);
    cout << a.size();
} 
```

你去吧。请注意您不再需要记住删除它。作为进一步说明，`::std::vector`以这种方式使用不会比以`new`您使用它的方式使用性能损失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T21:52:00.653

如果您无法使用您所说的 std::vector 和 std::array ，那么您唯一的选择就是自己跟踪数组的大小。

我仍然怀疑您避免使用 std::vector 的原因是错误的。即使对于性能监控软件，vector 的智能使用也是合理的。如果您担心调整大小，可以将向量预分配到相当大的大小。

# objective-c - 在外部单击时调用 NSTextField 的操作以发送

> ID：14407978
> 
> 赞同：0
> 
> 时间：2013-01-18T21:31:46.653
> 
> 标签：objective-c, xcode, cocoa

我有一个已编辑的 NSTextField。如果我按回车键，则按预期调用操作。

当我单击 NSTextField 之外的任何位置时，我希望获得相同的效果。辞职第一响应者可能是关键，但这仅在某些元素被单击/选择/聚焦时发生（例如另一个 NSTextField 或 NSTableView），而其他元素（例如 NSButton 或 NSSlider）不会发生。

可以使用 NSTextField 取消设置焦点，`[[self window] makeFirstResponder:nil]`但是在每个对象的操作中调用这条线太难看了。

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T09:38:21.467

您将需要深入研究 Cocoa 事件处理指南。好好看看 NSResponder。许多对象继承自 NSResponder，包括 NSWindow 和 NSApplication。猜测您要完成的工作，在视图未聚焦时提交编辑，您可能还希望包括观察应用程序终止时的通知，进入后台等...

# excel - 根据列值移动行

> ID：14407985
> 
> 赞同：0
> 
> 时间：2013-01-18T21:32:13.150
> 
> 标签：excel, vba, rows, paste

我需要扫描“主”工作表中的所有行，在“状态”列中找到任何值为“已发货”的单元格，然后将每一整行剪切并粘贴到另一张工作表中。粘贴的行也需要放在最后一行之后。

我发现[了这篇](https://stackoverflow.com/questions/7760439/delete-rows-in-excel-based-on-criteria)文章（粘贴在下面），我对其进行了一些修改以成功删除行。但我不知道如何移动行。我应该尝试一种全新的方法吗？

```
Sub DeleteRows()

    Dim rng As Range
    Dim counter As Long, numRows as long        

        With ActiveSheet
           Set rng = Application.Intersect(.UsedRange, .Range("C:C"))
        End With
        numRows = rng.Rows.Count

        For counter = numRows to 1 Step -1 
         If Not rng.Cells(counter) Like "AA*" Then
            rng.Cells(counter).EntireRow.Delete
         End If
       Next

End Sub 
```

我不知道VBA。由于我短暂的编程历史，我只是有点理解它。我希望没关系，感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:53:47.803

有几种方法可以做到这一点，您可以在顶部列中添加过滤器，按“已发货”的值过滤吗？是否需要复制并粘贴到新工作表中？

这不是最简洁的代码，但它可能有效

```
 sub Shipped_filter()
dim wsSheet as worksheet
dim wsOutputSheet as worksheet
dim BottomRow as integer

Set wsSheet = worksheets("Sheet1") 'change to the sheet name
set wsOutputSheet = worksheets("Sheet2") 'change to the sheet name

'*****************************
'* Delete old data on Sheet2 *
'*****************************
wsoutputsheet.activate
Activesheet.cells.clearall

wsSheet.range("A1").select
selection.autofilter

BottomRow = wsSheet.range("A90000").end(xlup).row ' or another column you guarantee will always have a value

activesheet.range("$A$1:$Z$"&BottomRow).AutoFilter field:=1, Criteria1:="Shipped" ' change field to whatever column number Status is in

'********************************
'* Error trap in case no update *
'********************************

if activesheet.range("A90000").end(xlup).row = 1 then
 msgbox("Nothing to ship")
exit sub
end if

wsSheet.range("A1:Z"&Bottomrow).select
selection.copy

wsOutputSheet.range("A1").select
selection.pastespecial Paste:=xlpastevalues
application.cutcopymode = false

msgbox('update complete')

end sub 
```

我没试过，所以可能需要更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T15:36:27.247

我最终将最初使用的代码（[在此处找到](https://stackoverflow.com/questions/7760439/delete-rows-in-excel-based-on-criteria)）与 AutoFilter 宏（[在此处](http://www.mrexcel.com/forum/excel-questions/612848-visual-basic-applications-copy-row-another-sheet-matching-criteria.html)找到）组合在一起。这可能不是最有效的方法，但它现在有效。如果有人知道我如何仅使用 For 循环或仅使用 AutoFilter 方法，那就太好了。这是我的代码。我应该进行任何编辑吗？

```
Sub DeleteShipped()

Dim lastrow As Long
Dim rng As Range
Dim counter As Long, numRows As Long

    With Sheets("Master")

        'Check for any rows with shipped
        If .Range("R:R").Find("Shipped", , xlValues, xlWhole, , , False) Is Nothing Then
            MsgBox "No shipped plates found. ", , "No Rows Moved": Exit Sub
        Else

            Application.ScreenUpdating = False

            'Copy and paste rows
            lastrow = .Range("A" & Rows.Count).End(xlUp).Row
            lastrow2 = Worksheets("ShippedBackup").Cells(Rows.Count, "A").End(xlUp).Row + 1
            .Range("A1:U" & lastrow).AutoFilter field:=18, Criteria1:="Shipped"
            .Range("A2:U" & lastrow).SpecialCells(xlCellTypeVisible).EntireRow.Copy
            Sheets("ShippedBackup").Range("A" & lastrow2).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, False, False
            .ShowAllData

            'Delete rows with shipped status
            Set rng = Application.Intersect(.UsedRange, .Range("R:R"))
            numRows = rng.Rows.Count

            For counter = numRows To 1 Step -1
             If rng.Cells(counter) Like "Shipped" Then
                rng.Cells(counter).EntireRow.Delete
             End If
            Next

            MsgBox "All shipped records have been moved to the ""ShippedBackup"" worksheet.", , "Backup Complete"

        End If
End With 
```

希望它可以帮助某人！

# css - 为什么 last-child 不针对这个小提琴中的最后一篇文章标签？

> ID：14407992
> 
> 赞同：7
> 
> 时间：2013-01-18T21:32:40.173
> 
> 标签：css, html, article

为什么 last-child 不针对这个小提琴中的最后一篇文章标签？

[http://jsfiddle.net/gunP9/](http://jsfiddle.net/gunP9/)

```
<div class="parent">
<article class="example">111</article>
<article class="example">111</article>
<article class="example">111</article>
<article class="example">111</article>
<section>content</section>
</div> 
```

**CSS**

```
.parent .example{ background-color: red;}
.parent .example:last-child{background-color: yellow;} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-18T21:33:45.257

`last-child`目标，嗯，父母的最后一个孩子。在这种情况下，最后一个孩子是 a `section`，它没有 class `example`，因此没有任何内容与选择器匹配。

您正在寻找的是`last-of-type`，它匹配*元素*而不是类。[看一看。](http://jsfiddle.net/y3kA8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T21:34:24.090

因为选择器说“每篇文章的最后一个孩子”

# string - 无法从 cmd.exe 运行 powershell 脚本？

> ID：14407998
> 
> 赞同：2
> 
> 时间：2013-01-18T21:33:00.213
> 
> 标签：string, powershell, powershell-2.0, cmd

我编写了一个可以从 powershell 运行的 powershell 脚本，如下所示：

```
PS C:> S:\MyScript.ps1 -a "select thing from table where name like 'name'" 
```

我已将其存储在共享驱动器 (S:) 上，我无法从 powershell 或 cmd.exe 以这种形式运行我的 powershell 脚本：

```
PS C:> powershell S:\MyScript.ps1 -a "select thing from table where name like 'name'"
C:\> powershell S:\MyScript.ps1 -a "select thing from table where name like 'name'" 
```

我还尝试绕过执行策略运行它：

```
C:\> powershell -executionpolicy bypass -command S:\MyScript.ps1 -a "select thing from table where name like 'name'" 
```

我还尝试使用完整的 UNC 路径（以上述所有形式）运行它：

```
C:\> powershell \\MyServer\path\to\MyScript.ps1 -a "select thing from table where name like 'name'" 
```

显示输出的唯一形式是如果我使用不需要传递字符串的参数：

```
C:\> powershell S:\MyScript.ps1 -z

thing
-----
thing1
thing2
thing3 
```

有人知道为什么是这样吗？有什么方法可以将字符串从 cmd.exe 传递给脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T22:09:02.420

另请注意，powershell.exe 有一个参数`-File`可能比`-command`. 我不确定脚本参数，因为它们应该像尼克所说的那样分组在一个字符串中。只需尝试 Nicks 解决方案，如果这不起作用，请尝试使用`-File`参数而不是`-command`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-18T21:39:41.230

尝试像这样运行它：

```
powershell -executionpolicy bypass -command {S:\MyScript.ps1 -a "select thing from table where name like 'name'"} 
```

cmd 所知道的是，您向它发送了`S:\MyScript.ps1`它不知道如何处理的命令，将其`-a "select thing from table where name like 'name'"` 包含在`{ }`其中应该将整个内容作为要运行的命令。如果仍然导致问题，请尝试以下操作：

```
powershell -executionpolicy bypass -command " &{S:\MyScript.ps1 -a "select thing from table where name like 'name'"}" 
```

# javascript - AngularJS 控制器和方法

> ID：14407999
> 
> 赞同：22
> 
> 时间：2013-01-18T21:33:11.347
> 
> 标签：javascript, angularjs

我是 angularjs 的初学者，有一些关于控制器的问题。
这是我的示例控制器：

```
function exampleController($scope)
{
   $scope.sampleArray = new Array();

   $scope.firstMethod = function()
   {
      //initialize the sampleArray
   };

   $scope.secondMethod = function()
   {
      this.firstMethod();
   };
}; 
```

以下是我的问题：

*   我怎么能`firstMethod`打电话`secondMethod`？我做的方式是正确的，还是更好的方式？
*   如何为控制器创建构造函数？我需要调用调用 firstMethod 初始化 sampleArray 的 secondMethod 吗？
*   如何从 html 代码中调用特定方法？我找到了 ng-initialize 但我不知道如何使用它。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-18T21:40:44.443

您调用方法的方式与声明它的方式相同：

```
$scope.secondMethod = function() {
  $scope.firstMethod();
}; 
```

您也可以像这样从 HTML 调用它：

```
<span>{{secondMethod()}}</span> 
```

但是控制器并没有真正的“构造函数”——它们通常像函数一样使用。但是你可以将初始化放在你的控制器函数中，它最初会被执行，就像一个构造函数：

```
function exampleController($scope) {
  $scope.firstMethod = function() {
    //initialize the sampleArray
  };

  $scope.secondMethod = function() {
    $scope.firstMethod();
  };

  $scope.firstMethod();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-18T21:41:21.443

您使用 $scope 调用第一个方法。

所以

```
 $scope.secondMethod = function()
   {
      $scope.firstMethod();
   }; 
```

不太确定您在第二个问题中的意思。

对于您的第三个问题，您可以让该方法在控制器上自动“加载”运行，或者通过前端角度绑定运行它。

例如 **自动运行**

```
function exampleController($scope)
{
   $scope.sampleArray = new Array();

   $scope.firstMethod = function()
   {
      //initialize the sampleArray
   };

   $scope.secondMethod = function()
   {
      $scope.firstMethod();
   };

   $scope.secondMethod(); // runs automatically.

}; 
```

**绑定运行**

```
<div ng-controller="ExampleController"> <!-- example controller set up in namespace -->

<button class="btn" ng-click="secondMethod()">Run Second Method</button>

</div> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-19T02:43:39.330

@Josh 和 @Christopher 已经回答了你的问题，所以我不会重复。

> 我找到了 ng-initialize 但我不知道如何使用它:-(

该指令实际上是[ng-init](http://docs.angularjs.org/api/ng.directive:ngInit)。有时（例如，如果您开始在应用程序的某些部分中使用 Angular，并且您仍然需要在服务器端动态生成视图/HTML 页面），ng-init 有时可能是初始化某些东西的有用方法。例如，

```
<div ng-controller="ExampleCtrl">
   <form name="myForm">
     <input type="text" ng-model="folder" ng-init="folder='Bob'"> 
```

这是一个需要使用 ng-init 的示例：[rails + angularjs 在编辑时将值加载到文本字段中](https://stackoverflow.com/questions/12703820/rails-angularjs-loading-values-into-textfields-on-edit)

我还想提一下，控制器不是单例。如果你使用 ng-view，每次你去不同的路线时，都会创建一个新的控制器。与您要离开的视图关联的控制器被销毁，与您将要进入的视图关联的控制器被执行。因此，控制器中的“初始化代码”可以在应用程序运行时多次执行。例如，如果你访问一个页面，去别处，然后回来，相同的控制器函数（及其“初始化代码”）将被执行两次。

如果您希望某些东西真正运行一次，请将其放入服务或[模块](http://docs.angularjs.org/api/angular.Module)的 config() 或 run() 方法中。（服务是[单例](http://docs.angularjs.org/guide/dev_guide.services.creating_services)的，因此每个服务只实例化一次，因此服务中的初始化代码只运行一次。）