# StackOverflow 问答 14882000-14882999

# java - 通用搞砸了不相关的集合

> ID：14882003
> 
> 赞同：7
> 
> 时间：2013-02-14T18:54:03.713
> 
> 标签：java, generics, types

为什么与模板类无关的集合会丢弃它们的类型？这是一个示例：（对不起，由于我感到困惑的错误，它不会编译。）

```
package test;

import java.util.ArrayList;
import java.util.List;

public class TemplateTest {

    public static class A { }

    public static class B<T extends Comparable> {
        List<A> aList = new ArrayList<A>();

        public List<A> getAList() {
            return aList;
        }

        public int compare(T t, T t1) {
            return t.compareTo(t1);
        }
    }

    public static void main(String[] args) {
        B b = new B();
        for (A a : b.getAList()) { //THIS DOES NOT WORK

        }
        List<A> aList = b.getAList(); //THIS WORKS
        for (A a : aList) {

        }
    }
} 
```

此代码在编译时引发错误：

```
test/TemplateTest.java:24: incompatible types
    found   : java.lang.Object
    required: test.TemplateTest.A
        for (A a : b.getAList()) { 
```

如果我指定`B`like的模板`B<String>`，或者如果我从 B 中完全删除模板，那么一切正常。

这是怎么回事？

**编辑：人们指出没有必要使 B 通用所以我添加到 B**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T19:31:06.357

是的，众所周知，如果您使用原始类型，则该类上的所有类型参数都会丢失，而不仅仅是您未能声明的类型级参数。

问题部分在这里：

> 如果我指定 B like 的模板`B<String>`，或者如果我从 B 中完全删除模板，那么一切正常。

这不是一个选项，您不能选择是否要指定类型参数。它在没有指定参数的情况下完全编译的唯一原因是为了向后兼容。编写缺少类型参数的新代码是一个编程错误。

`List<A> list = b.getList()`没有成功解释类型，它只是有效地坚持任意转换并相信你的分配是正确的。如果您查看编译器警告，它实际上是在为不安全的转换生成警告。

`for(A a : b.getList()) {}`将该警告升级为错误，因为插入的强制转换将在编译器生成的代码中，因此它根本拒绝自动生成不安全的代码，而不仅仅是发出警告。

从java语言规范：

> 仅允许使用原始类型作为对遗留代码兼容性的让步。强烈反对在将泛型引入 Java 编程语言之后编写的代码中使用原始类型。Java 编程语言的未来版本可能不允许使用原始类型。

最重要的是，Java 泛型与 C++ 模板共享的唯一重要的东西是 <> 语法:)

更多细节：[什么是原始类型，为什么我们不应该使用它？](https://stackoverflow.com/questions/2770321/what-is-a-raw-type-and-why-shouldnt-we-use-it?answertab=votes#tab-top)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T18:57:44.050

首先，在 Java 中，它是泛型，而不是像 C++ 中那样的模板。

`T`你在你的类中声明了一个泛型类型参数，`B`但你没有使用它。您应该在整个类定义中使用`T`而不是。`A``B`

```
public static class B<T> {
    List<T> aList = new ArrayList<T>();

    public List<T> getAList() {
        return aList;
    }
} 
```

然后，您应该在声明 class 实例时使用类型参数`B`。

```
B<A> b = new B<A>(); 
```

但是，如果您知道您的`aList`变量将始终`A`包含方法名称`getAList`所暗示的类型的对象，那么就没有理由将类设为`B`泛型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T19:06:47.227

这与此错误非常相似：

[6760983：无关方法中未使用的类型参数触发错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6760983)

这里报告：

[未使用的泛型导致问题](http://www.coderanch.com/t/385316/java/java/Unused-Generic-causing)

# php - 查询特定时间日期是否已预约班级

> ID：14882008
> 
> 赞同：0
> 
> 时间：2013-02-14T18:54:24.393
> 
> 标签：php, mysql, tsql

定义培训/课程表的过程：

当用户输入 ClassStartTime 和 ClassEndTime 时，例如 07:20 到 08:00（以相同格式存储在数据库中的时间）

如果请求的时间尚未保留/预订，它将如何检查数据库表。

在数据库中，特定日期的条目例如 02/14/2013 可能是

ClassStartTime 06:00 ClassEndTime 06:40

上课开始时间 07:00 上课结束时间 08:00

它会检查表格

```
1   ClassId int(11)         
2   ProviderId  int(11)         
3   ClassName   varchar(25)
4   ClassDayName    varchar(3)
5   ClassAppointmentDate    date
6   ClassStartTime  varchar(10)
7   ClassEndTime    varchar(10)
8   ClassOccurence  varchar(6)
9   ClassEndOccurence   varchar(10)
10  ClassAfterDaysOccurence int(4)
11  ClassAfterDateOccurence date
12  ClassRecurrenceSetting  varchar(7)
13  ClassFee    double
14  classcapacity   int(4)
15  ClassAllowWaiting   int(1)
16  ClassPaymentMode    varchar(6)
17  Location    varchar(100) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:08:55.667

对于 MySQL，这是可行的：

```
SELECT ...
...
WHERE '10:00' BETWEEN ClassStartTime AND ClassEndTime 
```

鉴于“上午 10 点编篮 101”。

当然，如果您在这些字段中存储时间，您最好将它们转换为 MySQL`time`字段。否则，您最终会进行字符串比较，这可能/将会失败。

# glassfish - 覆盖 persistence.xml 属性

> ID：14882011
> 
> 赞同：0
> 
> 时间：2013-02-14T18:54:36.673
> 
> 标签：glassfish, jpa-2.0, eclipselink

`persistence.xml`在 Glassfish 应用程序服务器上运行应用程序时，覆盖 EclipseLink 属性的正确方法是什么？

我们需要在一个单独的配置文件中配置一些属性，该文件可供客户端使用。

我没有找到任何接受某些用户属性的特定于 EclipseLink 的类。我只找到了 Glassfish PersistenceUnitLoader 类，可以对其进行调整以实现这一目标。但这将是一个丑陋的黑客:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T11:57:48.447

您可以在运行时创建自己的 EntityManager：

```
Map map = new HashMap();  

map.put("javax.persistence.jdbc.password", "password");  
map.put("javax.persistence.jdbc.user", "root");  

EntityManagerFactory emf = Persistence.createEntityManagerFactory("MyPU",map);  
EntityManager em = emf.createEntityManager(map); 
```

一些 eclipselink 属性名称：

```
 <property name="eclipselink.target-database" value="DERBY"/>
  <property name="eclipselink.ddl-generation" value="drop-and-create-tables"/>
  <property name="eclipselink.jdbc.driver" value="org.apache.derby.jdbc.ClientDriver"/>
  <property name="eclipselink.jdbc.url" value="jdbc:derby://localhost:1527/02DB;create=true"/>
  <property name="eclipselink.jdbc.user" value="user"/>
  <property name="eclipselink.jdbc.password" value="password"/> 
```

# node.js - 关于 express.cookieSession() 的几个问题

> ID：14882014
> 
> 赞同：4
> 
> 时间：2013-02-14T18:54:43.760
> 
> 标签：node.js, session, express, session-cookies, connect

在我的 node.js 服务器（运行`express`和`socket.io`）上，当一个人连接时，我将他们添加到一个数组中，并将他们在数组中的位置保存到他们的会话中，这样每个连接都可以访问他们自己的信息，如下所示：

```
session.person_id = people.length;
session.save();
people.push(new Person());
//people[session.person_id] => Person 
```

我在会话中保存的唯一内容是`person_id`. 我一直`express.session()`在处理这个问题，在我开始向所有连接的人发送信息之前，它一直运行良好。当我遍历他们的连接并获取他们的会话时，有时（我无法弄清楚如何欺骗错误）`session`存在但不存在`session.person_id`。

无论如何，我希望通过改变我存储会话的方式，它可以帮助我找出我的问题。所以我有几个问题我在任何地方都找不到答案。

1.  **express.cookieSession() 中的 cookie 存储在哪里？服务器端还是客户端？**
2.  **express.cookieSession() 是否允许在负载均衡器后面运行多个服务器？**
3.  **用户在使用 express.cookieSession() 时是否可以操作会话数据？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:00:29.130

1 - express.cookieSession() 中的 cookie 存储在哪里？服务器端还是客户端？

cookie 是根据服务器的回复发送的，浏览器会在每个请求中发送回该 cookie。

2 - express.cookieSession() 是否允许在负载均衡器后面运行多个服务器？

是的，如果您使用共享存储（如 RedisStore）

3 - 用户在使用 express.cookieSession() 时是否可以操作会话数据？

如果您使用签名的 cookie（当您在初始化会话时提供秘密时，默认的会话 cookie 的默认值）则不会。

```
var redis = require('redis').createClient();
app.use(express.session({
  secret: "some random string",
  store: new RedisStore({client: redis})
  })); 
```

# sql - 不同的表布局

> ID：14882015
> 
> 赞同：0
> 
> 时间：2013-02-14T18:54:44.850
> 
> 标签：sql, sql-server, unpivot

我有一个看起来像这样的表：

```
|| id  | year |  userCode  |  jan  |  feb  |  ... ... ... |  dec  || 
```

jan - dec 列在其中保存价值（金钱）数据。我希望它看起来像这样：

```
||id  |  year  |  month  |  userCode  |  value || 
```

事情是这样的：我可以在同一个月份为同一个 userCode 设置两个值（而且我都需要它们），所以我不能只使用 SUM。有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:19:39.623

[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)在 SQL Server 2005+ 中，您可以使用将数据从列转换为行的函数轻松完成此操作。

代码将与此类似：

```
select id, year, month, usercode, value
from yourtable
unpivot
(
  value
  for month in (Jan, Feb, Mar, Apr, May,
                Jun, Jul, Aug, Sep, Oct,
                Nov, Dec)
) unpiv 
```

一旦数据出现在行中，您就可以执行所需的任何类型的聚合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T18:57:53.857

你可以用两张桌子来做......

一张表，里面有年份和月份

## 年月

|| 身份证 | 年份 | 月 | 用户代码 ||

## 年月值

|| 身份证 | 年月号 | 价值 ||

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T18:58:14.370

你可以用 union all 做到这一点：

```
select year, month, userCode, jan, 'jan' as which as value from t union all
select year, month, userCode, feb, 'feb' as which as value from t union all
. . .
select year, month, userCode, dec, 'dec' as which as value from t 
```

我添加了一个额外的列`which`，以便您知道数据的来源。

# .net - 正则表达式 .Net 搜索字符串在字符串中的位置

> ID：14882017
> 
> 赞同：0
> 
> 时间：2013-02-14T18:54:51.640
> 
> 标签：.net, regex

如何在 c#.net 中的字符串中搜索字符串？例如，我需要在字符串“aa b bb aa bbb c”中找到所有出现（第一个和最后一个符号的位置）字符串“aa”（这是简化，即aa是真实的单词，例如“zebra”或“big” ）。我想使用类正则表达式的正确方法是什么，即

```
Regex regex = new Regex("\\baa\\b"); 
```

然后`regex.Matches(text)[0].Index`是第一个字符串的匹配。使用 Length 我将获得最后一个单词的索引，然后我将从整个文本中提取带有该单词的句子。或者我需要使用比尔史密斯在他的“字符串计算模式”一书中的方法？主要标准是性能和编写编程代码的难易程度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:57:42.260

查找第一次出现的索引的最简单方法是使用[String.IndexOf](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)方法和[String.LastIndexOf](http://msdn.microsoft.com/en-us/library/0w96zd3d.aspx)查找最后一次出现的索引

# java - 输出流缓冲输出流追加

> ID：14882024
> 
> 赞同：0
> 
> 时间：2013-02-14T18:55:08.887
> 
> 标签：java

我知道如何创建/写入/关闭缓冲输出流。如何重新打开流并将数据附加到文件末尾。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T18:56:33.260

您无法*重新打开*流...但您可以创建一个*新*流，该流将追加：

```
FileOutputStream output = new FileOutputStream(file, true); 
```

[`FileOutputStream`](http://docs.oracle.com/javase/7/docs/api/java/io/FileOutputStream.html)有关各种选项，请参阅构造函数列表。

（当然，你可以`FileOutputStream`用. 包裹它`BufferedOutputStream`。）

# visual-studio-2010 - 打开 Visual Studio 2010 解决方案文件时出错

> ID：14882027
> 
> 赞同：0
> 
> 时间：2013-02-14T18:55:28.963
> 
> 标签：visual-studio-2010, projects-and-solutions

我有一个仅包含一个 Web 应用程序项目的解决方案文件。每次我打开该文件时，总是会弹出此消息：

![错误信息](../Images/aa062962dd418dfb9a5b72dc6f263bbc.png)

然后在输出窗口中显示：

无法读取与解决方案关联的某些属性。

这是解决方案文件的文本：

```
Microsoft Visual Studio Solution File, Format Version 11.00
# Visual Studio 2010
Project("{E24C65DC-7377-472B-9ABA-BC803B73C61A}") = "Web Application", "..\Web    
Application", "{2D32A179-D771-4510-9C8B-D17D50BE3AAE}"
ProjectSection(WebsiteProperties) = preProject
    SccProjectName = "SAK"
    SccAuxPath = "SAK"
    SccLocalPath = "SAK"
    SccProvider = "SAK"
    TargetFrameworkMoniker = ".NETFramework,Version%3Dv3.5"
    Debug.AspNetCompiler.VirtualPath = "/Web Application"
    Debug.AspNetCompiler.PhysicalPath = "D:\Projects\Web Application\"
    Debug.AspNetCompiler.TargetPath = "PrecompiledWeb\Web Application\"
    Debug.AspNetCompiler.Updateable = "true"
    Debug.AspNetCompiler.ForceOverwrite = "true"
    Debug.AspNetCompiler.FixedNames = "false"
    Debug.AspNetCompiler.Debug = "True"
    Release.AspNetCompiler.VirtualPath = "/Web Application"
    Release.AspNetCompiler.PhysicalPath = "D:\Projects\Web Application\"
    Release.AspNetCompiler.TargetPath = "PrecompiledWeb\Web Application\"
    Release.AspNetCompiler.Updateable = "true"
    Release.AspNetCompiler.ForceOverwrite = "true"
    Release.AspNetCompiler.FixedNames = "false"
    Release.AspNetCompiler.Debug = "False"
    VWDPort = "51664"
EndProjectSection
 EndProject
 Global
GlobalSection(TeamFoundationVersionControl) = preSolution
    SccNumberOfProjects = 1
    SccEnterpriseProvider = {4CA58AB2-18FA-4F8D-95D4-32DDF27D184C}
    SccTeamFoundationServer = server_teamprojectcollection
    SccWebProject0 = true
    SccProjectUniqueName0 = .
    SccProjectName0 = .
    SccAuxPath0 = server_teamprojectcollection
    SccLocalPath0 = .
    SccProvider0 = {4CA58AB2-18FA-4F8D-95D4-32DDF27D184C}
    SccProjectEnlistmentChoice0 = 2
EndGlobalSection
GlobalSection(SolutionConfigurationPlatforms) = preSolution
    Debug|Any CPU = Debug|Any CPU
EndGlobalSection
GlobalSection(ProjectConfigurationPlatforms) = postSolution
    {2D32A179-D771-4510-9C8B-D17D50BE3AAE}.Debug|Any CPU.ActiveCfg = Debug|Any CPU
    {2D32A179-D771-4510-9C8B-D17D50BE3AAE}.Debug|Any CPU.Build.0 = Debug|Any CPU
EndGlobalSection
GlobalSection(SolutionProperties) = preSolution
    HideSolutionNode = FALSE
EndGlobalSection
 EndGlobal 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:59:43.563

以管理员身份运行 Visual Studio，然后尝试打开项目。发生这种情况有两个原因。

1.  您正在尝试打开从在线下载的项目，并且该项目文件被标记为该项目文件。
2.  您正在尝试打开一个作为 Web 应用程序项目的项目，并且该项目设置为使用本地 IIS。

很可能两者都适用于您。

如果您从 Interwebs 下载了一个 .zip 文件，那么在解压缩之前，进入文件的属性并解锁它，然后解压缩它。这样，Windows 就不会将其包含的所有文件都标记为不安全。

**更新：**

在更详细地阅读了您的问题后，我进行了一些研究，我认为问题在于您的解决方案文件中包含的 TFS 设置。他们不知何故出了差错或被破坏了。

尝试按照[此处](http://alausted.wordpress.com/2010/08/06/how-to-some-of-the-properties-associated-with-the-solution-could-not-be-read/)描述的过程来解决问题。如果这仍然不起作用，则创建一个空白解决方案文件并使用现有源将 Web 应用程序添加到解决方案中。您将在“新建”菜单项下的“文件”菜单下找到它。

# oracle - 无法加载 ROracle：无法加载共享对象 ROracle.so：libclntsh.so.11.1 没有这样的文件或目录

> ID：14882033
> 
> 赞同：5
> 
> 时间：2013-02-14T18:56:03.953
> 
> 标签：oracle, r, rstudio

所以我无法加载 ROracle。我确实对此很陌生，所以任何信息都值得赞赏，任何关于提供哪些进一步信息的信息也会有所帮助。

```
> library(ROracle)
Error in dyn.load(file, DLLpath = DLLpath, ...) : 
  unable to load shared object '~/R/x86_64-pc-linux-gnu-library/2.14/ROracle/libs/ROracle.so':
  libclntsh.so.11.1: cannot open shared object file: No such file or directory
Error: package/namespace load failed for ‘ROracle’ 
```

ROracle.so 正是它所说的位置。libclntsh.so.11.1 可以在`/usr/lib/oracle/11.2/client64/lib/libclntsh.so.11.1`. 这是结果`.libPaths`：

```
> .libPaths()
[1] "/home/nguiller/R/x86_64-pc-linux-gnu-library/2.14" "/usr/local/lib/R/site-library"                     "/usr/lib/R/site-library"                          
[4] "/usr/lib/R/library"                                "/usr/lib/rstudio/R/library" 
```

我的 .Renviron 文件

```
LD_LIBRARY_PATH="/usr/lib/oracle/11.2/client64/lib:/home/nguiller/Downloads/instantclient_11_2"
ORACLE_HOME="/usr/lib/oracle/11.2/client64/:/home/nguiller/Downloads/instantclient_11_2"
OCI_LIB="/usr/lib/oracle/11.2/client64/lib" 
```

由于 OCI 库，我在安装 ROracle 时遇到了很多麻烦，但它最终可以使用`R CMD INSTALL --configure-ags='--with-oci-lib=/usr/lib/oracle/11.2/client64/lib --with-oci-inc=/usr/include/oracle/11.2/client64' ROracle_1.1-8.tar.gz`

让我知道我能提供什么帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:14:52.430

ORACLE_HOME 应该只指向一个位置。你不应该设置 LD_LIBRARY_PATH_64 变量吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-03T01:28:14.777

如果你真的很想在 R 环境中执行此操作，可以按如下方式加载特定库：

```
dyn.load("/usr/lib/oracle/11.2/client64/lib/libclntsh.so.11.1")
library(ROracle) 
```

参考：

[从 R 内部设置 LD_LIBRARY_PATH](https://stackoverflow.com/questions/41494585/setting-ld-library-path-from-inside-r)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-03-12T13:55:20.560

加载“库（ORE）”时出现同样的错误

```
 Error in dyn.load(file, DLLpath = DLLpath, ...) :
      unable to load shared object '/usr/lib64/R/library/ROracle/libs/ROracle.so':
      libclntsh.so.11.1: cannot open shared object file: No such file or directory
    Error: package 'OREdm' could not be loaded 
```

看起来共享对象 ROracle.so 指的是 libclntsh.so.11.1 而不是 libclntsh.so.12.1

```
bash-4.1$ pwd
/usr/lib64/R/library
bash-4.1$ grep -irsh "libclntsh.so.11.1" *
Binary file ROracle/libs/ROracle.so matches 
```

作为一种解决方法，我创建了一个符号链接，以便 libclntsh.so.12.1 可以称为 libclntsh.so.11.1。

```
$ cd /scratch/softwares/R/db_instant_client/instantclient_12_1

 ln -s libclntsh.so.12.1 libclntsh.so.11.1 
```

在这一步之后，我能够成功加载库（ORE）。

请查看[我的网站](http://rajiv-kuriakose.blogspot.in/2016/03/how-to-install-oracle-r-enterprise-on.html)了解更多详情。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-06-28T07:35:45.193

设置 $LD_LIBARARY_PATH=$ORACLE_HOME/lib

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-08T14:16:39.327

将此设置在`/etc/rstudio/rserver.conf`

```
rsession-ld-library-
path=/usr/lib64/R/lib:/home/oracle/app/oracle/product/12.1.0/client_1/lib 
```

然后重启Rserver

```
sudo rstudio-server stop
sudo rstudio-server start 
```

这对我有帮助。

# jquery - jquery 在 jsfiddle 中工作，但不在实时网站上

> ID：14882037
> 
> 赞同：1
> 
> 时间：2013-02-14T18:56:18.627
> 
> 标签：jquery, html, toggle

我正在处理下面页面上的 jQuery 中的切换功能。当我在 jsfiddle 上试用它时效果很好，但是当我转移到我的网站时它不起作用。[网站在这里](http://goo.gl/xj4w3)

下面是我正在使用的 jQuery。

```
$('a').click(function() {
/*    $(this).parent().next('.bios').toggle();*/
$('.bios').slideUp().fadeOut();
$(this).parent().next('.bios').animate({
        height: "toggle",
        opacity: "toggle"
}, 300);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:59:10.293

您的页面上有语法错误...即 a`Function`而不是 a `function`。

# ruby-on-rails - 为 Ruby with Rails 项目实现与 Rspec/Capybara 的关联

> ID：14882040
> 
> 赞同：0
> 
> 时间：2013-02-14T18:56:27.123
> 
> 标签：ruby-on-rails, rspec, capybara, factory-bot

我有一个模型，其方法如下：

```
class Post < ActiveRecord::Base
    MAX_LINES = 100
    MAX_POSTS = 5

    def self.can_post?(user)
      user.posts.count( :conditions => ["lines >= ?", MAX_LINES] ) < MAX_POSTS
    end
end 
```

用户 has_many 帖子和帖子属于_to 用户。我想为posts_exceeding_max_lines 构建测试？我正在按照[FactoryGirl 自述文件](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md)创建用户并发布工厂：

```
FactoryGirl.define do

  # post factory with a `belongs_to` association for the user
  factory :post do
    title "Through the Looking Glass"
    user
  end

  # user factory without associated posts
  factory :user do
    name "John Doe"

    # user_with_posts will create post data after the user has been created
    factory :user_with_posts do
      # posts_count is declared as an ignored attribute and available in
      # attributes on the factory, as well as the callback via the evaluator
      ignore do
        posts_count 5
      end

      # the after(:create) yields two values; the user instance itself and the
      # evaluator, which stores all values from the factory, including ignored
      # attributes; `create_list`'s second argument is the number of records
      # to create and we make sure the user is associated properly to the post
      after(:create) do |user, evaluator|
        FactoryGirl.create_list(:post, evaluator.posts_count, user: user)
      end
    end
  end
end 
```

在我的测试中，我使用以下方法创建用户：

```
new_posts_count = 5
@user = FactoryGirl.create(:user_with_posts, posts_count: new_posts_count) 
```

但是，当我尝试打印出我有多少帖子时（使用 require 'pp'）：

```
pp @user.posts.count 
```

无论我的 new_posts_count 设置如何，我都得到 0。如何更改我的设置以便获得 5 个帖子的计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:09:09.497

*   不应该在用户上定义此方法吗？
*   这一切与工厂有什么关系？
*   使用可选参数而不是常量

用户

```
class User < ActiveRecord::Base
  def posts_exceeding_max_lines?(max_lines = 100, max_posts = 5)
    posts.count(:conditions => ["lines >= ?", max_lines] ) < max_posts
  end
end 
```

# javascript - 获取两个子字符串之间的字符串

> ID：14882041
> 
> 赞同：0
> 
> 时间：2013-02-14T18:56:29.807
> 
> 标签：javascript, regex, string

我想在两个子字符串之间得到一个字符串。

例如：

代码：

```
'{{something}} Space {}} Space2 {{}}'.match(/{(.*?)}/g) 
```

我希望它是：

```
['{something}','}','{}'] 
```

但它返回：

```
['{{something}','{}','{{}'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:02:12.377

在这种情况下，这看起来会得到您想要的答案，但一般情况对我来说不是很清楚：

```
'{{something}} Space {}}'.match(/{([^{]*?)}/g) 
```

# ruby - 我可以将两个大小相同的数组合并为一个包含合并值子数组的数组吗？

> ID：14882043
> 
> 赞同：0
> 
> 时间：2013-02-14T18:56:36.607
> 
> 标签：ruby, arrays

我有两个数组：

```
a = ["a1", "a2", "a3"]
b = ["b1", "b2", "b3"] 
```

我想得到一个看起来像这样的数组：

```
combined = [["a1", "b1"], ["a2", "b2"], ["a3", "b3"]] 
```

我在返回的哈希中找到了解决方案`Hash[a.zip b]`：

```
{"a1"=>"b1", "a2"=>"b2", "a3"=>"b3"} 
```

这可能必须用 lambda 函数来解决，但我想知道是否有一些快速的 Ruby 魔法使它成为一个更快的单线。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T18:59:04.440

我不确定你为什么`Hash`参与其中。`Array#zip`是您需要的方法。

```
a = ["a1", "a2", "a3"]
b = ["b1", "b2", "b3"]

a.zip(b) # => [["a1", "b1"], ["a2", "b2"], ["a3", "b3"]] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T19:02:31.537

或者，

```
combined = [a, b].transpose 
```

# json - 带有嵌套对象的Google Closure JSON数据提交？

> ID：14882044
> 
> 赞同：1
> 
> 时间：2013-02-14T18:56:37.447
> 
> 标签：json, serialization, google-closure, google-closure-library, form-submit

我使用 Google 工具（库、模板）已经快一年了……我到了必须将后端与我一直在处理的所有模板连接起来的地步。后端接收 JSON 格式的数据。

这是我的问题。我想在后端提交一个代表我的对象模型的 JSON，我知道闭包库提供了这个......

```
var json = goog.json.serialize(goog.dom.forms.getFormDataMap(form).toObject()); 
```

问题是**getFormDataMap**方法返回一个**goog.structs.Map**，它的工作方式类似于 hashMap ......这意味着提交的表单的所有值都嵌套在数组中。

我想知道是否有人找到了解决方案。我知道有一些库可以做到这一点（[https://github.com/maxatwork/form2js](https://github.com/maxatwork/form2js)），但我不敢相信闭包没有任何东西可以解决这个问题。

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T10:48:22.830

为什么不自己访问数据并构建所需的数据结构，这不会成为任何类型的瓶颈。

# android - 在屏幕上移动球。加速度计。也反弹

> ID：14882045
> 
> 赞同：2
> 
> 时间：2013-02-14T18:56:38.687
> 
> 标签：android, accelerometer, move

我必须在 Android 中做一个在屏幕上移动球的应用程序。我需要用加速度计移动球。我有这个代码，但球绕过边界并且不反弹。

```
 package com.example.test2;

import android.app.Activity;
import android.content.Context;
import android.content.pm.ActivityInfo;
import android.content.res.Configuration;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.drawable.ShapeDrawable;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;
import android.view.Display;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;

public class test2 extends Activity implements SensorEventListener {

    CustomDrawableView mCustomDrawableView = null;
    ShapeDrawable mDrawable = new ShapeDrawable();
    public float xPosition, xAcceleration, xVelocity = 0.0f;
    public float yPosition, yAcceleration, yVelocity = 0.0f;
    public float xmax, ymax;
    private Bitmap mBitmap;
    private Bitmap mWood;
    private SensorManager sensorManager = null;
    public float frameTime = 0.666f;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        // Set FullScreen & portrait
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);

        // Get a reference to a SensorManager
        sensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
        sensorManager.registerListener(this,
                sensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION),
                SensorManager.SENSOR_DELAY_GAME);

        mCustomDrawableView = new CustomDrawableView(this);
        setContentView(mCustomDrawableView);
        // setContentView(R.layout.main);

        // Calculate Boundry
        Display display = getWindowManager().getDefaultDisplay();
        xmax = (float) display.getWidth() - 50;
        ymax = (float) display.getHeight() - 50;
    }

    // This method will update the UI on new sensor events
    public void onSensorChanged(SensorEvent sensorEvent) {
        {
            if (sensorEvent.sensor.getType() == Sensor.TYPE_ORIENTATION) {
                // Set sensor values as acceleration
                yAcceleration = sensorEvent.values[1];
                xAcceleration = sensorEvent.values[2];
                updateBall();
            }
        }
    }

    private void updateBall() {

        // Calculate new speed
        xVelocity += (xAcceleration * frameTime);
        yVelocity += (yAcceleration * frameTime);

        // Calc distance travelled in that time
        float xS = (xVelocity / 2) * frameTime;
        float yS = (yVelocity / 2) * frameTime;

        // Add to position negative due to sensor
        // readings being opposite to what we want!
        xPosition -= xS;
        yPosition -= yS;

        if (xPosition > xmax) {
            xPosition = xmax;
        } else if (xPosition < 0) {
            xPosition = 0;
        }
        if (yPosition > ymax) {
            yPosition = ymax;
        } else if (yPosition < 0) {
            yPosition = 0;
        }
    }

    // I've chosen to not implement this method
    public void onAccuracyChanged(Sensor arg0, int arg1) {
        // TODO Auto-generated method stub
    }

    @Override
    protected void onResume() {
        super.onResume();
        sensorManager.registerListener(this,
                sensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION),
                SensorManager.SENSOR_DELAY_GAME);
    }

    @Override
    protected void onStop() {
        // Unregister the listener
        sensorManager.unregisterListener(this);
        super.onStop();
    }

    public class CustomDrawableView extends View {
        public CustomDrawableView(Context context) {
            super(context);
            Bitmap ball = BitmapFactory.decodeResource(getResources(),
                    R.drawable.ball);
            final int dstWidth = 50;
            final int dstHeight = 50;
            mBitmap = Bitmap
                    .createScaledBitmap(ball, dstWidth, dstHeight, true);
            mWood = BitmapFactory.decodeResource(getResources(),
                    R.drawable.wood);

        }

        protected void onDraw(Canvas canvas) {
            final Bitmap bitmap = mBitmap;
            canvas.drawBitmap(mWood, 0, 0, null);
            canvas.drawBitmap(bitmap, xPosition, yPosition, null);
            invalidate();
        }
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        // TODO Auto-generated method stub
        super.onConfigurationChanged(newConfig);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
    }
} 
```

我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T18:58:07.713

您想使用加速度计移动它，但您正在注册一个方向传感器侦听器。而是注册加速度计。

# java - java.util.Stack.peek（未知来源）错误

> ID：14882050
> 
> 赞同：1
> 
> 时间：2013-02-14T18:56:51.907
> 
> 标签：java, stack, peek

我正在使用Java Stack，如下所示：

```
Stack<Integer> stack_y = new Stack<Integer>(); 
```

后来在某个时候，我使用了 push、peek 和 pop：

```
stack_y.push(1);   
//some code
peek_value=stack_y.peek();
//some code   
pop=stack_y.pop(); 
```

虽然`push`工作正常，但我收到以下错误`pop`and `peek`：

```
Exception in thread "main" java.util.EmptyStackException
    at java.util.Stack.peek(Unknown Source)
    at java.util.Stack.pop(Unknown Source)
    at Hw1Node.DFS(Hw1Node.java:246) 
```

它还在我调用该函数的行的主函数中给出了一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:02:36.587

如果您检查[`EmptyStackException`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/EmptyStackException.html)信息，您会看到“由`Stack`类中的方法抛出以指示堆栈为空”。

因此，当堆栈为空时，您正在尝试制作 a`.pop()`或 a 。`peek()`请记住，您只能为之前完成`pop()`的每个制作一个`push()`。

# html - 如何在一页中获得两个模态对话？

> ID：14882051
> 
> 赞同：2
> 
> 时间：2013-02-14T18:56:59.130
> 
> 标签：html, twitter-bootstrap

我的网页中有两个模态对话，使用 Twitter-bootstrap，但只有一个有效。

这是代码：

```
<a href="#format" role="button" class="btn btn-info" data-toggle="format">Phone and Email</a>
<div id="format" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="format" aria-hidden="true">
    <div class="modal-header">
    <!--This needs a fancy phone icon and so does the button.-->
    <img src="img/numberheader.png" alt="">
    </div>
    <div class="modal-body">
    <p>
    <h4>Office:</h4>
    123 4567<br>
    <h4>Programme Manager:</h4>
    765 4321<br>
    <hr>
    <img src="img/emailheader.png" alt="">
    <h4>Email us</h4>Iremovedthemailaddresses<br>
    <a href="Iremovedthemailaddresses" class="btn-primary btn-small">Click Here To Email Us</a>
    <br>
    </p>
    </div>
    <div class="modal-footer">
    <button class="btn btn-info" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
    </div>
<a href="#myModal" role="button" class="btn btn-info" data-toggle="modal">Phone and Email</a>
<div id="myModal" class="modal hide fade" tabindex="-1"
role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-header">
<!--This needs a fancy phone icon and so does the button.-->
<img src="img/numberheader.png" alt="">
</div>
<div class="modal-body">
<p>
<h4>Office:</h4>
123 4567<br>
<h4>Programme Manager:</h4>
765 4321<br>
<hr>
<img src="img/emailheader.png" alt="">
<h4>Email us</h4>Iremovedthemailaddresses<br>
<a href="Iremovedthemailaddresses" class="btn-primary btn-small">Click Here To Email Us</a>
<br>
</p>
</div>
<div class="modal-footer">
<button class="btn btn-info" data-dismiss="modal" aria-hidden="true">Close</button>
</div>
</div> 
```

两个模态的内容还没有被分成它的意思，它只是在这一点上的概念证明（所以忽略内容）。

但是，它只适用于第二个，而不是第一个。我该怎么做才能使两种模式都起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:34:17.183

确保您的锚标记和模态 ID 是唯一的。

```
<a href="#myModal" role="button" class="btn" data-toggle="modal">Launch demo modal</a>
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> 
```

**演示：http: [//jsfiddle.net/uf2UR/](http://jsfiddle.net/uf2UR/)**

# sql - 左连接上的内连接使左连接表现为内连接

> ID：14882052
> 
> 赞同：0
> 
> 时间：2013-02-14T18:56:58.730
> 
> 标签：sql, sql-server-2005, join

我有两个查找表，我想内部连接，但是我只想在我的数据表上左连接。

```
select * from CLIENT
LEFT JOIN [ENTRY] 
    on [ENTRY].ENTRY_CODE = CLIENT.CLIENT_COUNTY
   and [ENTRY].ENTRY_RECD = 'A'
INNER JOIN [ENTRY_TYPES]
     on [ENTRY_TYPES].ENTRY_TYPES_FileRecordID = [ENTRY].ENTRY_TYPE
    and [ENTRY_TYPES].ENTRY_TYPES_CODE = 'COUNTY' 
    and [ENTRY_TYPES].ENTRY_TYPES_RECD = 'A'
  where CLIENT_RECD = 'A' 
```

因此，如果`ENTRY_TYPES_FileRecordID = ENTRY_TYPE`失败，我不希望该`ENTRY`记录可作为左连接项用于连接到`CLIENT`.

上面代码在左连接上的编写方式`ENTRY`就像一个内连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:56:58.730

在我输入问题时我自己想出来了，我需要将内部连接作为子查询分离出来

```
select * from CLIENT
left join 
(
    select ENTRY_CODE, ENTRY_NAME 
    from [ENTRY]
    inner join [ENTRY_TYPES] on ENTRY_TYPES_FileRecordID = ENTRY_TABLE
                            and ENTRY_TYPES_CODE = 'COUNTY' 
                            and ENTRY_TYPES_RECD = 'A'
    where ENTRY_RECD = 'A'
) as CountyLookup on CLIENT_COUNTY = ENTRY_CODE
where CLIENT_RECD = 'A' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:16:45.953

您自己已经找到了解决方案，但现在您将其设为子查询。您也可以通过在原始查询中移动一些部分并添加两个括号来执行此操作。

所以这只是为了展示一个替代方案：

```
SELECT * 
FROM [CLIENT]
LEFT JOIN ([ENTRY] --opening bracket
        INNER JOIN [ENTRY_TYPES]
            ON [ENTRY_TYPES].[ENTRY_TYPES_FileRecordID] = [ENTRY].[ENTRY_TYPE]
                AND [ENTRY_TYPES].[ENTRY_TYPES_CODE] = 'COUNTY' 
                AND [ENTRY_TYPES].[ENTRY_TYPES_RECD] = 'A') -- closing bracket
    ON [ENTRY].[ENTRY_CODE] = [CLIENT].[CLIENT_COUNTY]
        AND [ENTRY].[ENTRY_RECD] = 'A'
WHERE [CLIENT_RECD] = 'A' 
```

# ios - 将额外的 UIViewControllers 推送到 UINavigationController 的最佳方式

> ID：14882057
> 
> 赞同：1
> 
> 时间：2013-02-14T18:57:15.433
> 
> 标签：ios, objective-c, cocoa-touch, cocoa

我正在使用 Xcode 附带并在[http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/中引用的 Master-Detail 项目模板](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/)

**问题**：我试图弄清楚如何在这个模板附带`UIViewController`的默认值中添加额外的 s 。`UINavigationController`

具体来说，我想添加一个`DetailEditViewController`after `DetailViewController`。到目前为止，这是我为此所做的工作：

在`DetailViewController`我添加了一个编辑按钮到`navigationItem`：

```
- (void)viewDidLoad
{
    [super viewDidLoad];       
    self.navigationItem.rightBarButtonItem = 
        [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemEdit
                                                      target:self 
                                                      action:@selector(editDetailItem:)];
    [self configureView];
} 
```

您可以看到它指定了一个消息选择器`editDetailItem:`，我将其实现为：

```
- (void)editDetailItem:(id)sender
{
    [self.navigationController pushViewController:
        [[DetailEditViewController alloc] init] animated:YES];
} 
```

我在`DetailEditViewController`Storyboard 上创建了一个，代码运行时不会崩溃，生成一个带有导航项的黑色空白窗口，让我回到细节。从这里开始，我很困惑：

*   当我将一个新的 View Controller 拖到 Storyboard 时，没有创建相应的代码文件！我是否负责为这些控制器制作代码文件？我看到 Storyboard View Controllers 与 Identity Inspector 中的一个类相关联......但是`UIViewController`当我将一个新的模板拖到 Storyboard 上时，为什么它不会为新的模板创建模板呢？
*   我应该使用序列而不是从到`-pushViewController`获取吗？如果是这样，我不确定如何在情节提要上添加一个，因为s都是在代码中添加的。没有什么可以 Ctrl 拖动的。`DetailViewController``DetailEditViewController``navigationItem``UIBarButtonItem`
*   我如何将信息从 发送`DetailViewController`到`DetailEditViewController`？当`MasterViewController`segues to 时`DetailViewController`，它指定`sender`via`- prepareForSegue:sender:`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:16:37.753

你是对的，没有产生相应的文件。系统应该如何知道你想要什么类？您需要创建一个 UIViewController 子类，并将您拖入的控制器的类更改为该类。推送新控制器的最简单方法是使用推送转场——如果情节提要中没有 UI 元素来连接它，则直接从控制器连接它并给转场一个标识符（我称之为在我的示例中为“GoToEdit”）。在编辑按钮的操作方法中，然后执行 segue：

```
[self performSegueWithIdentifier:@"GoToEdit" sender:self]; 
```

如果你想传递信息，那么你实现 prepareForSegue:，如下所示：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"GoToEdit"]) {
        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        NSDate *object = _objects[indexPath.row];
        [[segue destinationViewController] setDetailItem:object];
    }
} 
```

首先检查 segue 标识符是一件好事。然后您可以访问您的destinationViewController（您可能必须将其强制转换为您的类，以便编译器识别您尝试设置的任何属性），并将您想要的内容传递给它。

# wpf - 使用 PopupRegion 的 WPF Prism 应用程序在关闭时抛出 Invalid Window Handle

> ID：14882058
> 
> 赞同：0
> 
> 时间：2013-02-14T18:57:16.230
> 
> 标签：wpf, prism

我正在使用 prism 框架 [.net 4.0] 开发一个 wpf 应用程序。我使用 StockTrader RI 中的 RegionPopupBehavior 实现了一个弹出窗口。现在，当我使用窗口标题栏 [主窗口] 右上角的关闭按钮或使用

```
Application.Current.Shutdown() 
```

在单击按钮时调用，我收到带有消息“无效窗口句柄”的 win32 异常，并且堆栈跟踪是所有互操作调用返回到应用程序 Run() 调用。

我已经搜索谷歌和 SO 来寻找答案，但无济于事。我在关闭期间设置了中断并检查了 Windows 集合，但它仅将主窗口显示为活动的[如果弹出窗口被隐藏]。请注意，当我点击关闭时，无论弹出窗口是否打开，我都会收到错误消息。

这是堆栈跟踪：

```
at MS.Win32.HwndWrapper.DestroyWindow(Object args)
   at MS.Win32.HwndWrapper.Dispose(Boolean disposing, Boolean isHwndBeingDestroyed)
   at MS.Win32.HwndWrapper.Dispose()
   at System.Windows.Interop.HwndSource.Dispose(Boolean disposing)
   at System.Windows.Interop.HwndSource.WeakEventDispatcherShutdown.OnShutdownFinished(Object sender, EventArgs e)
   at System.EventHandler.Invoke(Object sender, EventArgs e)
   at System.Windows.Threading.Dispatcher.ShutdownImplInSecurityContext(Object state)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Windows.Threading.Dispatcher.ShutdownImpl()
   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   at System.Windows.Threading.Dispatcher.Run()
   at System.Windows.Application.RunDispatcher(Object ignore)
   at System.Windows.Application.RunInternal(Window window)
   at System.Windows.Application.Run(Window window)
   at System.Windows.Application.Run()
   at RNDGroup.App.App.Main() in c:\Users\jgilliland\Projects\Common\Source\Prism GUI\RNDGroup.App\obj\x86\Release\App.g.cs:line 0
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

我的问题是，如果有人在类似情况下见过它，我该如何解决这个问题，或者我该如何进一步调试这个 win32 异常？谢谢，j

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T02:10:32.780

我团队的技术负责人发现了问题并删除了这个错误。弹出区域用于在其自己的窗口中显示/隐藏或激活/停用 VirtualKeyboardView。当我从在用户单击按钮时显示键盘切换到在文本框获得焦点时显示键盘时，“无效窗口句柄”win32 异常的发生开始了。

焦点事件有点有趣，我看到用户对同一单击/焦点的多个焦点事件。无论如何，故事的结局是我意识到问题是重复的焦点事件，但我找不到问题的根源。我的队友能够找到由这些看似重复的文本框焦点事件引起的递归问题。解决方案是跟踪导致键盘显示的最后一个文本框元素，并基本上忽略重复的焦点事件。这删除了无效窗口句柄的 win32 异常。

我知道这是一个奇怪的问题，也是一个更奇怪的答案，但这是我第一次在这样的论坛上发布问题，显然我首先需要学习如何更好地提出这个问题。但是，感谢我非常乐于助人的团队领导，我能够摆脱错误并继续在 wpf 中的辅助弹出区域中实现这个虚拟键盘。这一直是一次学习经历。

这是一些可能有助于澄清答案的代码。这来自管理显示和隐藏键盘视图的 VirtualKeyboardService。

```
/// <summary>
/// Opens the keyboard.
/// </summary>
public void OpenKeyboard()
{
    lock (_lock)
    {
        // allow for ignoring a refocus one time
        if (_ignoreOnce)
        {
            _ignoreOnce = false;
            return;
        }
        // open keyboard if not already open
        if (!_isKeyboardOpen)
        {
            var viewName = typeof(VirtualKeyboardView).FullName;
            _regionManager.RequestNavigate(RegionNames.PopupRegion, new Uri(viewName, UriKind.Relative));
            _isKeyboardOpen = true;
            _lastImpression = null;
        }
    }
} 
```

这是关闭虚拟键盘的方法，当用户单击关闭按钮或按下回车键、制表符或 esc 键时，从键盘的视图模型中调用此方法。它也从 MainWindow 的 Activated 事件的事件处理程序中调用。
/// /// 关闭键盘。/// /// 如果设置为 true [恢复文本]。public void CloseKeyboard(bool revertText = false) { lock (_lock) { // 关闭键盘视图 var view = _regionManager.Regions[RegionNames.PopupRegion].ActiveViews.FirstOrDefault();

```
 if (view != null)
        {
            _regionManager.Regions[RegionNames.PopupRegion].Deactivate(view);
            _isKeyboardOpen = false;
            _lastImpression = CurrentTarget;
        }

        // revert text if needed
        if (revertText && CurrentTarget != null)
        {
            CurrentTarget.Text = CurrentText;
        }
    }
} 
```

这也很棘手，这就是忽略曾经发挥作用的地方。当用户单击“离开”激活主窗口时，我必须能够关闭键盘视图，该主窗口可能集中在一个文本框上，这导致键盘视图重新出现。忽略一次选项允许打破该循环。自动显示虚拟键盘涉及许多不同的用例。我学到了很多关于在 wpf 中使用行为和复合命令的知识......

# javascript - 选项卡失去焦点时的用户脚本性能

> ID：14882060
> 
> 赞同：1
> 
> 时间：2013-02-14T18:57:19.720
> 
> 标签：javascript, performance, optimization, userscripts

我注意到，当窗口不在焦点上时，用户脚本会变慢很多（根据我所做的一些快速测试，大约是速度的一半）。我相信这是谷歌浏览器的错，而不是脚本，但有什么解决方案吗？有什么方法可以让标签保持全速运行而无需查看它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:02:13.067

对于不活动的选项卡，Chrome 将 setInterval 调用的间隔值增加到 1 秒。

[https://codereview.chromium.org/6577021](https://codereview.chromium.org/6577021)

如果您的代码使用 setIntervals，您可以使用以下修复在选项卡不活动时加快它们的速度：

[当 Chrome 中的选项卡处于非活动状态时，如何使 setInterval 也起作用？](https://stackoverflow.com/questions/5927284/how-can-i-make-setinterval-also-work-when-a-tab-is-inactive-in-chrome)

# twitter - Twitter 提要小部件不起作用

> ID：14882061
> 
> 赞同：0
> 
> 时间：2013-02-14T18:57:20.693
> 
> 标签：twitter, widget, feed, twitter-feed

您好，我在使用 Twitter Feed Widget 时遇到了一些问题。编辑后，我复制代码并将其放在我的页面上：

```
 <div>
      <a class="twitter-timeline" href="https://twitter.com/TimIDCA" data-widget-id="302125789070102528">Tweets by @TimIDCA</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div> 
```

但是这个错误在我的控制台中弹出：

> 加载资源失败[http://cdn.syndication.twimg.com/widgets/timelines/302125789070102528?domai](http://cdn.syndication.twimg.com/widgets/timelines/302125789070102528?domai) …ack=twttr.tfw.callbacks.tl_302125789070102528&suppress_response_codes=true

我该怎么办？

唯一出现的是链接：@TimIDCA 的推文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T19:12:37.667

返回到您配置小部件的 twitter 并设置您打算在其中使用小部件的域。您可以列出多个域。例如：

```
*.stewardxpress.com, *.ihnbc.com 
```

其中 * 是您可能拥有并希望将小部件应用到的任何子域的通配符。重新加载，它应该可以工作。至少，我已经通过这样做修复了两个非功能性小部件。

# android - Android MapView 显示黑屏

> ID：14882065
> 
> 赞同：3
> 
> 时间：2013-02-14T18:57:34.043
> 
> 标签：android

我在我的应用程序中使用谷歌地图。我无法获取地图图块。我只看到一个黑屏。我已经挣扎了3天了。我在我的计算机上生成地图 api 密钥，并在我的 menifest.xml 文件中添加了所有权限。但仍然无法获取地图图块。ActivityMap.java `

```
package com.example.locatometer;

import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.os.Handler;

import com.example.locatometer.utils.Tracker;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;

public class ActivityMap extends MapActivity{
    MapView mapView;
    MapController controller;
    Tracker tracker;
    Handler locationHandler = new Handler();
    GeoPoint mapPoint;

    @Override
    protected void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.activity_current_location_on_map);
        init();
    }
    private void init() {
        mapView = (MapView) findViewById(R.id.map);
        mapView.setBuiltInZoomControls(true);
        mapView.setSatellite(true);
        controller = mapView.getController();

    }
    @Override
    protected void onResume() {
        super.onResume();

    }
    @Override
    protected void onPause() {
        super.onPause();

    }
    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

}
` 
```

布局.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <com.google.android.maps.MapView
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/map"
        android:clickable="true"
        android:apiKey="******************************" />

</LinearLayout> 
```

清单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.locatometer"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="5"
        android:targetSdkVersion="10" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"/>
    <uses-permission android:name="android.permission.INTERNET"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/LocatometerTheme" android:debuggable="true">
        <uses-library android:name="com.google.android.maps"/>
        <activity
            android:name="com.example.locatometer.ActivitySplash"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name="com.example.locatometer.ActivityMenu"></activity>
        <activity android:name="com.example.locatometer.ActivityCurrentLocation"></activity>
        <activity android:name="com.example.locatometer.ActivityMap"></activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-26T11:05:30.760

它可能不相关，但是当我遇到类似问题时，我这样做过一次。在清单中的应用程序标签下

```
 android:hardwareAccelerated="false" 
```

可能行不通，但值得一试。

# java - 在java中，我将如何确定一个正方形是否是单个像素的大小？

> ID：14882067
> 
> 赞同：0
> 
> 时间：2013-02-14T18:57:35.590
> 
> 标签：java, recursion

我必须通过在彼此的顶部绘制三个单像素正方形来递归地绘制一个谢尔宾斯基三角形以形成一个三角形。他告诉我们，我假设这将是我的递归基本情况，“绘图算法将以屏幕正方形区域的坐标作为输入。如果该正方形是单个 pizel 的大小，它应该调用 drawRect( ) 在传递给 paintComponent 的对象上，在屏幕某处绘制一个 1 像素的正方形。”

如何确定屏幕的正方形区域是否为单个像素的大小？当我调用该方法并执行 width^2\. 如果面积为 1，这是否意味着它的 1 个像素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:41:39.667

如果出现以下情况，正方形（或者可能是`Rectangle`）的大小为 1 个像素：

```
java.awt.Rectangle rect;
// ....
boolean isOnePixel = (rect.width == 1 && rect.height == 1); 
```

为了简化事情，我们假设 witdh 和 height 不能为负数。
尽管 Java 矩形类允许这样做。

# asp.net-mvc - 如何更改服务器上 ASP.NET 项目中的项目设置？

> ID：14882068
> 
> 赞同：0
> 
> 时间：2013-02-14T18:57:37.900
> 
> 标签：asp.net-mvc, visual-studio-2012

我目前正在使用 C#/ASP.NET 开发一个 Web 应用程序。我决定通过设置一些设置`PROJECT > MyProject > Properties... > Settings`。

我设置了一些必须在每台新服务器上手动调整的路径，但您只需执行一次。**如何在服务器上调整这些设置？**（我可以通过 FTP 访问服务器）

我试图给出一个界面，但是当我尝试

```
MyProject.Properties.Settings.Default.DataStoragePath = "D:\inetpub\ftproot\"; 
```

它说`Property [...] cannot be assigned -- it is read only`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:39:57.100

设置存储在`Web.config`文件中。它是一个 xml 文件，因此很容易阅读和调整设置。

# javascript - 停止点击处理内部元素

> ID：14882075
> 
> 赞同：0
> 
> 时间：2013-02-14T18:58:33.940
> 
> 标签：javascript, jquery

我有一个覆盖屏幕的 div。在 div 中是另一个 div，在其中，图像被动态放置。当用户单击外部 div 时，它会关闭，这很好。当用户单击图像或内部 div 时，它也会关闭，我该如何阻止这种情况发生？如果他们单击外部 div，我只希望它关闭。

这就是我正在使用的；我需要做什么才能完成这项工作？

```
$("#black-out").click(function(){
    $(this).fadeOut("slow");
}); 
```

的HTML：

```
<div id="black-out"><div id="image-holder"></div></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T18:59:12.397

检查单击的元素是否与事件绑定到的元素相同：

```
$("#black-out").click(function(e){
    if (e.target == this) $(this).fadeOut("slow");
}); 
```

# c++ - C++ FAQ 中类层次结构的打印模式

> ID：14882078
> 
> 赞同：1
> 
> 时间：2013-02-14T18:58:38.177
> 
> 标签：c++, printing, iostream, hierarchy

我正在实现[C++ FAQ](http://www.parashift.com/c++-faq-lite/)中描述[的类层次结构的打印模式](http://www.parashift.com/c++-faq-lite/virtual-friend-fns.html)。在FAQ中，打印函数在基类中声明如下：

```
protected:
  virtual void printOn(std::ostream& o) const = 0;  // pure virtual
  // -- or --
  virtual void printOn(std::ostream& o) const;      // plain virtual 
```

我正在考虑实现该`printOn`方法的普通虚拟版本，但有一些变化。我想将返回类型从`void`更改`std::ostream&`为如下所示：

```
protected:
  virtual std::ostream& printOn(std::ostream& o) const; 
```

我认为这种方法的优点是允许使用**链接方法**更容易地将基类的输出合并到派生类的输出中。这是一个例子：

```
std::ostream& DerivedClass::printOn(std::ostream& stream) const
{
  return stream
      << "<DerivedClass>" << '\n'
      << BaseClass::printOn(stream)
      << "<member_one>" << member_one_ << "</member_one>" << '\n'
      << "<member_two>" << member_two_ << "</member_two>" << '\n'
      << "</DerivedClass>" << std::endl;
} 
```

相比之下，`DerivedClass::printOn`如果虚拟`BaseClass::printOn`方法`void`如常见问题解答中所示声明，则如下所示：

```
void DerivedClass::printOn(std::ostream& stream) const
{
    stream << "<DerivedClass>" << '\n';
    BaseClass::printOn(stream);

    stream
        << "<member_one>" << member_one_ << "</member_one>" << '\n'
        << "<member_two>" << member_two_ << "</member_two>" << '\n'
        << "</DerivedClass>" << std::endl;
} 
```

**问题：**有没有人看到我提议的对返回类型的修改有任何陷阱`printOn`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:45:12.393

如果`BaseClass::printOn(stream)`返回 a`std::ostream &`那么你不能写

```
stream << ... << BaseClass::printOn(stream) << ...; 
```

你必须写：

```
stream << ...;
BaseClass::printOn(stream) << ...; 
```

显然，这几乎没有比它返回的情况好多少`void`。您可以返回带有无操作流输出运算符的类型：

```
struct noop_manipulator {
  noop_manipulator(std::ostream &) {}
  friend inline std::ostream &operator<<(std::ostream &os, const noop_manipulator &) {
    return os;
  }
};

noop_manipulator DerivedClass::printOn(std::ostream& stream) const
{
    return stream << ...;
} 
```

或者，您可以只使用语法：

```
void DerivedClass::printOn(std::ostream& stream) const
{
    return stream << "<DerivedClass>" << '\n',
        BaseClass::printOn(stream), stream
        << "<member_one>" << member_one_ << "</member_one>" << '\n'
        << "<member_two>" << member_two_ << "</member_two>" << '\n'
        << "</DerivedClass>" << std::endl;
} 
```

所有这些方法的缺点是它们掩盖了您对超类虚拟调用的使用，这是非常不寻常的，因此应该尽可能清楚地说明。所描述的印刷图案本身就很不寻常；除非您已经拥有虚拟继承层次结构，否则派生类通常拥有自己的继承并通过基类引用`operator<<`调用基类。`operator<<``static_cast`

# java - 在sdcard android中创建一系列文件夹

> ID：14882079
> 
> 赞同：0
> 
> 时间：2013-02-14T18:58:44.043
> 
> 标签：java, android, eclipse

我在 sd 卡中的要求文件有路径

```
Android/data/mypakagename/android/myfile/abc/myfile.txt 
```

我有一个 url，我将从那里下载这个 myFile.txt 并将它放在这个位置。现在我`Android/data/mypakagename/`在 sdCard 中创建了目录。

现在我正在使用以下代码。

```
File file = new File("Android/data/mypakagename/android/myfile/abc/myfile.txt
");
file.mkdirs(); 
```

这会创建所有文件夹，但它也会将 myfile.txt 创建为文件夹。我想创建除最后一个以外的所有缺少的目录。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:00:25.590

```
 File file = new File("Android/data/mypakagename/android/myfile/abc/myfile.txt
");
    File parent = file.getParentFile();
    parent.mkdirs(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:03:17.497

```
String filename = "myfile.txt"
File dir = new File ("Android/data/mypakagename/android/myfile/abc");  
dir.mkdirs();
File file = new File(dir, filename); 
```

# mercurial - 413：当推送到 Nginx 后面的 Mercurial 存储库时，全头

> ID：14882080
> 
> 赞同：1
> 
> 时间：2013-02-14T18:58:51.073
> 
> 标签：mercurial, nginx

我有一个在 Nginx 后面代理的 Scm-manager 上运行的 Mercurial 存储库。各种较小的存储库运行良好，因此基本设置似乎还可以。

此外，同样的盒子运行 Owncloud。我已将服务器上的 client_max_body_size 调整为 1000M，以便可以传输大文件。这很有效，并且我在服务器和客户端之间同步了各种大文件。

但是，当我第一次尝试推送大型 Mercurial 存储库时（1007 次提交，而该系统上另一个最大的提交约为 80 次），我得到以下信息：

中止：HTTP 错误 413：全头

我读过的关于 413 错误的所有内容似乎都不适用。首先，它建议设置机身尺寸，我已经说过已经是1G了。接下来，这似乎适用于标头太大，这是有道理的，因为它可能正在尝试检查远程存储库中的 1000 多个修订。

我遇到的另一件事是 large_client_header_buffers。我已经在服务器和 http 级别上将它设置为非常大的值，例如“64 128k”（阅读一些关于它在服务器上不起作用的信息），但这并没有改变任何东西。

我还查看了 scm-manager 日志，但什么也没看到，所以这似乎停止了 Nginx。

想法？这是我的 Nginx 服务器配置的一部分：

```
server {
  server_name thewordnerd.info;
  listen 443 ssl;
  ssl_certificate /etc/ssl/certs/thewordnerd.info.crt;
  ssl_certificate_key /etc/ssl/private/thewordnerd.info.key;
  root /srv/www/thewordnerd.info/public;
  client_max_body_size 1000M;
  location /scm {
    proxy_pass      http://127.0.0.1:8080/scm;
    include         /etc/nginx/proxy_params;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-18T17:59:53.567

问题是应用服务器的头缓冲区，这是因为 mercurial 使用了非常大的头。您必须增加标头缓冲区的大小和此应用程序服务器特定的大小。如果您使用的是独立版本，则必须编辑 server-config.xml 并增加 requestHeaderSize 值。

代替：

```
<Set name="requestHeaderSize">16384</Set> 
```

和：

```
<Set name="requestHeaderSize">32768</Set> 
```

来源：[https ://groups.google.com/forum/#!topic/scmmanager/Afad4zXSx78](https://groups.google.com/forum/#!topic/scmmanager/Afad4zXSx78)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-14T18:37:35.927

我`HTTP Error: 413 (Request Entity Too Large)`试图推动。通过添加`client_max_body_size 2M;`解决`/etc/nginx/nginx.conf`。想知道是否可能`1000M`不超过`client_max_body_size`...

# mips - MIPS 程序 - 无法从控制台窗口输入负数？我的程序因负数而卡住，但对于正数运行良好

> ID：14882082
> 
> 赞同：1
> 
> 时间：2013-02-14T18:59:01.647
> 
> 标签：mips

我正在使用 MARS IDE 编写 mips 程序来进行两个数字的整数除法。我正在尝试从控制台提供用户输入。对于正数程序正在运行，但对于负数我相信程序没有编译。我的问题是，我们如何从控制台窗口输入负数？

# python - 减少（）hstack python

> ID：14882093
> 
> 赞同：1
> 
> 时间：2013-02-14T18:59:38.763
> 
> 标签：python, reduce, sparse-matrix

我正在尝试使用*reduce()*函数来创建一个水平堆叠多个数组的函数*hstack() 。*作为一个简单的例子，让我们说

```
>>>>M=eye((4))
>>>>M
    array([[ 1.,  0.,  0.,  0.],
    [ 0.,  1.,  0.,  0.],
    [ 0.,  0.,  1.,  0.],
    [ 0.,  0.,  0.,  1.]])

>>>>hstack([M,M])
array([[ 1.,  0.,  0.,  0.,  1.,  0.,  0.,  0.],
   [ 0.,  1.,  0.,  0.,  0.,  1.,  0.,  0.],
   [ 0.,  0.,  1.,  0.,  0.,  0.,  1.,  0.],
   [ 0.,  0.,  0.,  1.,  0.,  0.,  0.,  1.]]) 
```

这可以按我的意愿工作。现在我定义

```
>>>> hstackm = lambda *args: reduce(hstack, args) 
```

并尝试从上一个案例中执行*hstack()*

```
>>>>hstackm([M,M])  
[array([[ 1.,  0.,  0.,  0.],
   [ 0.,  1.,  0.,  0.],
   [ 0.,  0.,  1.,  0.],
   [ 0.,  0.,  0.,  1.]]),
 array([[ 1.,  0.,  0.,  0.],
   [ 0.,  1.,  0.,  0.],
   [ 0.,  0.,  1.,  0.],
   [ 0.,  0.,  0.,  1.]])] 
```

这是不正确的。如何定义*hstackm()*以获得正确的输出？

如果可能的话，我的最终目标是创建一个*hstackm()*函数来堆叠 SPARSE 矩阵。就像是，

```
hstackm = lambda *args: reduce(sparse.hstack, args). 
```

_*args_ 将是*csr*或 _lil_matrix_

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:02:19.583

您的函数`hstack`采用*一个*参数，即矩阵列表。*而是用两个参数*`reduce()`调用它，每个参数都是一个矩阵。

 *更改您的`hstack`方法以接受任意数量的参数：

```
def hstack(*matrices):
    .... 
```

而不是`hstack(matrices)`，然后将其称为`hstack(M, M)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:06:54.243

```
In [16]: hstackm = lambda args: reduce(lambda x,y:hstack((x,y)), args)

In [17]: hstackm([M,M])
Out[17]: 
array([[ 1.,  0.,  0.,  0.,  1.,  0.,  0.,  0.],
       [ 0.,  1.,  0.,  0.,  0.,  1.,  0.,  0.],
       [ 0.,  0.,  1.,  0.,  0.,  0.,  1.,  0.],
       [ 0.,  0.,  0.,  1.,  0.,  0.,  0.,  1.]]) 
```*

# css - 获取父 div 以匹配内容的高度和宽度

> ID：14882096
> 
> 赞同：-2
> 
> 时间：2013-02-14T18:59:54.963
> 
> 标签：css, grid

父#Connect 有两行#unit1 和#unit2。每行有两列 .col1 和 .col2。我有两个问题：

1.  #Connect 仅与 #unit1 一样下降 - 所以我看不到蓝色背景。我希望 #Connect 与浏览器一样宽，但与它的内容一样高。
2.  我希望#unit1 和#unit2 的背景与#Connect 一样宽，与.col2 一样高。目前，我看不到任何背景。

下面是代码：

```
<html>
    <head>
        <title></title>
        <link type="text/css" href="colReflow.css" rel="stylesheet">
        <style>
            #connect .col1{
                float: left; width: 240px; background-color: #ffc0cb;
            }
            #connect .col2{
                background-color: yellow; margin-left: 248px;
            }
            #connect .offCont{
                position: relative; top: 0; left: 0; float: left;
                width: 210px;height:256px;
                color: #000000;
                font-family: "TrumpGothicEastBold",Arial,helvetica,sans-serif;
                text-transform: uppercase;
                margin: 10px 10px 0 0;
                background: #9acd32;
            }
            #connect .section{
                /*I want the background to be as 100% width of Connect and the height of the contents of col2*/
                background: #ff69b4;clear: both; width: 100%;
            }
        </style>
    </head>
    <body>

        <div id="connect">

            <div id="unit1" class="section">
                <div class="col1">This column is used solely to hold this area.</div>

                <div class="col2">
                    <div class="offCont">drgdrg</div>
                    <div class="offCont">drgdrg</div>
                    <div class="offCont">drgdrg</div>
                    <div class="offCont">drgdrg</div>
                </div>
            </div>

            <div id="unit2" class="section">
                <div class="col1">This column is used solely to hold this area.</div>

                <div class="col2">
                    <div class="offCont">I want this section or unit 2 to be as tall as the contents of col2</div>
                    <div class="offCont">drgdrg</div>
                    <div class="offCont">drgdrg</div>
                    <div class="offCont">drgdrg</div>
                </div>
            </div>
        </div>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T19:10:39.180

放

```
overflow: hidden; 
```

在 #connect 和 .section

# android - android帮助调试Toast

> ID：14882099
> 
> 赞同：0
> 
> 时间：2013-02-14T19:00:12.820
> 
> 标签：android, debugging, toast

我正在尝试使用 eclipse 调试应用程序。我正在使用 USB 连接到附件，因此 USB 无法调试。我正在使用 ADB 连接进行无线调试，但是对于这个应用程序，我必须拔下并插入 USB 电缆才能运行应用程序，当我这样做时，我会失去与 Eclipse 的连接。

所以我唯一能想到的就是尝试使用 Toast 来弄清楚课堂上发生了什么。

也许有更好的方法？

但是当我尝试调用 toast 应用程序崩溃时.. 我希望能够以各种方法（如 BroadcastReceiver 和 ResumeAccessory

打电话给任何人告诉我如何在这个类中实现 toast？：

//

```
User must modify the below package with their package name
package com.UARTDemo; 
import java.io.FileDescriptor;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

import android.app.Activity;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.hardware.usb.UsbAccessory;
import android.hardware.usb.UsbManager;
import android.os.Handler;
import android.os.Message;
import android.os.ParcelFileDescriptor;
import android.util.Log;

/******************************FT311 GPIO interface class******************************************/
public class FT311UARTInterface extends Activity
{

    private static final String ACTION_USB_PERMISSION =    "com.UARTDemo.USB_PERMISSION";
    public UsbManager usbmanager;
    public UsbAccessory usbaccessory;
    public PendingIntent mPermissionIntent;
    public ParcelFileDescriptor filedescriptor;
    public FileInputStream inputstream;
    public FileOutputStream outputstream;
    public boolean mPermissionRequestPending = true;
    public handler_thread handlerThread;

    private byte [] usbdata; 
    private byte [] writeusbdata;
    private byte  [] readBuffer; /*circular buffer*/
    private int readcount;
    private int totalBytes;
    private int writeIndex;
    private int readIndex;
    private byte status;
    private byte  maxnumbytes = (byte)64;

    public boolean datareceived = false;

        /*constructor*/
     public FT311UARTInterface(Context context){
            super();
            /*shall we start a thread here or what*/
            usbdata = new byte[64]; 
            writeusbdata = new byte[64];
            /*128(make it 256, but looks like bytes should be enough)*/
            readBuffer = new byte [maxnumbytes];

            readIndex = 0;
            writeIndex = 0;
            /***********************USB handling******************************************/

            usbmanager = (UsbManager) context.getSystemService(Context.USB_SERVICE);
           // Log.d("LED", "usbmanager" +usbmanager);
            mPermissionIntent = PendingIntent.getBroadcast(context, 0, new Intent(ACTION_USB_PERMISSION), 0);
            IntentFilter filter = new IntentFilter(ACTION_USB_PERMISSION);
           filter.addAction(UsbManager.ACTION_USB_ACCESSORY_DETACHED);
           context.registerReceiver(mUsbReceiver, filter);

           inputstream = null;
           outputstream = null;
        }

        /*reset method*/
        public void Reset()
        {
            /*create the packet*/
            writeusbdata[0] = 0x49;
            writeusbdata[1] = 0x00;
            writeusbdata[2] = 0x00;
            writeusbdata[3] = 0x00;
            /*send the packet over the USB*/
            SendPacket(4);
        }

        public void SetConfig(int baud, byte dataBits, byte stopBits,
                             byte parity, byte flowControl)
        {

            /*prepare the baud rate buffer*/
            writeusbdata[0] = (byte)baud;
            writeusbdata[1] = (byte)(baud >> 8);
            writeusbdata[2] = (byte)(baud >> 16);
            writeusbdata[3] = (byte)(baud >> 24);

            /*data bits*/
            writeusbdata[4] = dataBits;
            /*stop bits*/
            writeusbdata[5] = stopBits;
            /*parity*/
            writeusbdata[6] = parity;
            /*flow control*/
            writeusbdata[7] = flowControl;

            /*send the UART configuration packet*/
            SendPacket((int)8);
        }

        /*write data*/
        public byte SendData(byte numBytes, char[] buffer) 

        {

            status = 0x00; /*success by default*/
            /*
             * if num bytes are more than maximum limit
             */
            if(numBytes < 1){
                /*return the status with the error in the command*/
                return status;
            }

            /*check for maximum limit*/
            if(numBytes > 64){
                numBytes = 64;

            }

            /*prepare the packet to be sent*/
            for(int count = 0;count<numBytes;count++)
            {

                writeusbdata[count] = (byte)buffer[count];

            }
            SendPacket((int)numBytes);
            return status;
        }

        /*read data*/
        public byte ReadData(byte numBytes,char[] buffer, byte [] actualNumBytes)
        {
                status = 0x00; /*success by default*/

                /*should be at least one byte to read*/
                if((numBytes < 1) || (totalBytes == 0)){
                    actualNumBytes[0] = 0x00;
                    return status;
                }

                /*check for max limit*/
                if(numBytes > 64){
                    numBytes = 64;
                }
                if(numBytes > 64){
                    numBytes = 64;
                }

                if(numBytes > totalBytes)
                    numBytes = (byte)totalBytes;

                /*update the number of bytes available*/
                totalBytes -= numBytes;

                actualNumBytes[0] = numBytes;   

                /*copy to the user buffer*/ 
                for(int count = 0; count<numBytes;count++)
                {
                    buffer[count] = (char)readBuffer[readIndex];
                    readIndex++;
                    /*shouldnt read more than what is there in the buffer,
                     *  so no need to check the overflow
                     */
                    readIndex %= maxnumbytes;
                }
                return status;
        }

        /*method to send on USB*/
        private void SendPacket(int numBytes)
        {

            try {
                if(outputstream != null){
                    outputstream.write(writeusbdata, 0,numBytes);
                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }

        /*resume accessory*/
        public void ResumeAccessory()
        {
            // Intent intent = getIntent();
            if (inputstream != null && outputstream != null) {
                return;
            }

            UsbAccessory[] accessories = usbmanager.getAccessoryList();
            UsbAccessory accessory = (accessories == null ? null : accessories[0]);
            if (accessory != null) {
                if (usbmanager.hasPermission(accessory)) {
                    OpenAccessory(accessory);
                } 
                else
                {
                    synchronized (mUsbReceiver) {
                        if (!mPermissionRequestPending) {
                            usbmanager.requestPermission(accessory,
                                    mPermissionIntent);
                            mPermissionRequestPending = true;
                        }
                }
            }
            } else {}

        }

        /*destroy accessory*/
        public void DestroyAccessory(){
            unregisterReceiver(mUsbReceiver);
            CloseAccessory();
        }

/*********************helper routines*************************************************/     

        public void OpenAccessory(UsbAccessory accessory)
        {
            filedescriptor = usbmanager.openAccessory(accessory);
            if(filedescriptor != null){
                usbaccessory = accessory;
                FileDescriptor fd = filedescriptor.getFileDescriptor();
                inputstream = new FileInputStream(fd);
                outputstream = new FileOutputStream(fd);
                /*check if any of them are null*/
                if(inputstream == null || outputstream==null){
                    return;
                }
            }

            handlerThread = new handler_thread(handler, inputstream);
            handlerThread.start();
        }

        private void CloseAccessory()
        {
            try{
                if(filedescriptor != null)
                    filedescriptor.close();

            }catch (IOException e){}

            try {
                if(inputstream != null)
                        inputstream.close();
            } catch(IOException e){}

            try {
                if(outputstream != null)
                        outputstream.close();

            }catch(IOException e){}
            /*FIXME, add the notfication also to close the application*/

            filedescriptor = null;
            inputstream = null;
            outputstream = null;

            System.exit(0);

        }

        /***********USB broadcast receiver*******************************************/
        private final BroadcastReceiver mUsbReceiver = new BroadcastReceiver() 
        {
            @Override
            public void onReceive(Context context, Intent intent) 
            {
                String action = intent.getAction();
                if (ACTION_USB_PERMISSION.equals(action)) 
                {
                    synchronized (this)
                    {
                        UsbAccessory accessory = (UsbAccessory) intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                        if (intent.getBooleanExtra(UsbManager.EXTRA_PERMISSION_GRANTED, false))
                        {
                            OpenAccessory(accessory);
                        } 
                        else 
                        {
                            Log.d("LED", "permission denied for accessory "+ accessory);

                        }
                        mPermissionRequestPending = false;
                    }
                } 
                else if (UsbManager.ACTION_USB_ACCESSORY_DETACHED.equals(action)) 
                {
                    UsbAccessory accessory = (UsbAccessory)intent.getParcelableExtra(UsbManager.EXTRA_ACCESSORY);
                    if (accessory != null )//&& accessory.equals(usbaccessory))
                    {
                        CloseAccessory();
                    }
                }else
                {
                    Log.d("LED", "....");
                }
            }   
        };

        final Handler handler =  new Handler()
        {
            @Override 
            public void handleMessage(Message msg)
            {
                for(int count = 0;count<readcount;count++){

                    readBuffer[writeIndex] = usbdata[count];
                    /*move to the next write location*/
                    writeIndex++;
                    writeIndex %= maxnumbytes;
                    /*FIXME,check for overflow*/
                    //if(writeIndex == readIndex){

                    //}

                }

                /*caluclate the available bytes to read*/
                if(writeIndex >= readIndex)
                    totalBytes = writeIndex-readIndex;
                else
                    totalBytes = (maxnumbytes-readIndex)+writeIndex;

            }

        };

        /*usb input data handler*/
        private class handler_thread  extends Thread {
            Handler mHandler;
            FileInputStream instream;

            handler_thread(Handler h,FileInputStream stream ){
                mHandler = h;
                instream = stream;
            }

            public void run()
            {

                while(true)
                {
                    Message msg = mHandler.obtainMessage();
                    try{
                        if(instream != null)
                        {   
                        readcount = instream.read(usbdata,0,64);
                        if(readcount > 0)
                        {
                            datareceived = true;
                            msg.arg1 = usbdata[0];
                            msg.arg2 = usbdata[1];
                        }
                        mHandler.sendMessage(msg);
                        }
                        }catch (IOException e){}
                }
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:45:46.317

它更好地使用`Log.d(TAG, text)`

或者

在任何活动子类中，您都可以：

Toast.makeText(getApplicationContext(), "text", Toast.LENGTH_LONG).show();

# javascript - jquery Easytabs后退按钮

> ID：14882100
> 
> 赞同：0
> 
> 时间：2013-02-14T19:00:14.473
> 
> 标签：javascript, jquery, tabs, jquery-ui-tabs, jquery-tabs

我正在使用 easytabs 引导选项卡，当您循环浏览选项卡时，然后尝试返回最后一页，它会将您带回到您所在的最后一个选项卡而不是最后一页。我不想要那个。

是否有任何 js 可以让我删除哈希并允许用户在单击后退按钮而不是上一个选项卡时转到上一页。

这是一个示例链接： http: [//www.whitewatermarine.ns.ca/new-boats/2013-princecraft-vantage-21-package](http://www.whitewatermarine.ns.ca/new-boats/2013-princecraft-vantage-21-package)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T12:45:19.720

使用 jquery.easytabs 的 api，这是我使用的；

```
$('#tab-container').easytabs({
    panelContext: $(document),    
    updateHash: false, 
}); 
```

# operating-system - 除雾固件

> ID：14882105
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:00:59.693
> 
> 标签：operating-system, firmware

[固件](http://en.wikipedia.org/wiki/Firmware)- 这到底是什么？我知道它不是一段仅有助于与硬件通信的代码，因为它是设备驱动程序的功能。

我想这是比这更复杂的事情。我总是看到我的 mp3 播放器和智能手机的固件更新。在智能手机中，我看到在固件更新后操作系统的版本被提高了，例如，从冰淇淋三明治到果冻豆（Android）。这是否意味着固件是操作系统的别名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:04:50.780

固件只是编程到设备中的软件。在您使用的示例中，操作系统将有资格被称为固件。在其他设备中，它可能不如 iOS 或 Android 复杂，例如，许多 DVD 播放器和蓝光播放器都有固件组件，例如支持互联网的智能电视和路由器也是如此。

# ios - 在垂直或水平布局视图中将宽度设置为百分比

> ID：14882108
> 
> 赞同：1
> 
> 时间：2013-02-14T19:01:24.153
> 
> 标签：ios, user-interface, titanium

我只是钛开发的新手，如果这是一个愚蠢的问题，我很抱歉......我一直在阅读文档，但我还没有找到我要找的东西，所以我走了，

我正在尝试将视图的宽度设置为百分比 -下面代码中的**labelDetails** - 。该视图嵌套在 tableViewRow 中，布局水平（或垂直，没关系）- 下面代码中的**行**- 。我使用类似的东西：

```
function randomInt(max){
    return Math.floor(Math.random() * max) + 1;
}

tableData = []; //Tabla de Rows
for (var i=1; i<=20; i++){
    var row = Ti.UI.createTableViewRow({
        className:'forumEvent', 
        backgroundColor:'green',
        rowIndex:i, 
        height:110,
        width:'100%',
        layout:'horizontal'
    });

    var labelUserName = Ti.UI.createLabel({
        color:'#576996',
        backgroundColor: 'red',
        font:{fontFamily:'Arial', fontWeight:'bold'},
        text:'Fred Smith ' + i,
        left:70, top: 6,
        width:200, height: 30
    });
    row.add(labelUserName);

    var labelDetails = Ti.UI.createLabel({
        color:'#222',
        font:{fontFamily:'Arial', fontWeight:'normal'},
        text:'Replied to post with id ' + randomInt(1000) + '.',
        left:70, top:44,
        width: '50%', //Here is the percentage
        backgroundColor: 'blue'
    });
    row.add(labelDetails);

  tableData.push(row);
}

var tableView = Ti.UI.createTableView({
    backgroundColor:'transparent',
    data:tableData
});

self.add(tableView); 
```

~~~

当我运行模拟器时，没有显示 labelDetails。如果我将 labelDetails 的宽度更改为 px 或只是默认单位，一切都会按预期工作。

我的系统：

*   应用类型：手机
*   钛 SDK：3.0。
*   平台和版本：iOS 6.0
*   设备：iOS模拟器
*   主机操作系统：OSX 10.8.2
*   钛工作室：3.0.1.201212181159

这是一个错误吗？正确的方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:16:40.463

看起来您从未设置过 tableView 的宽度。如果 tableView 的宽度为“0”，则其宽度为 100% 的单元格的宽度仍为 0。

尝试设置 tableView 的宽度。

# ruby-on-rails - Ruby RoR，Ransack，多选查询失败

> ID：14882112
> 
> 赞同：2
> 
> 时间：2013-02-14T19:01:38.093
> 
> 标签：ruby-on-rails, gem, ransack

使用 ransack gem 我已经看到应该可以使用具有多项选择的表单。

使用我使用的选择表单的基本 html，然后选择两个选项，我可以尝试搜索任一值

```
<select id="q_c_0_v_0_value" name="q[c][0][v][0][value][]" size="1" multiple="multiple">
<option value="SGD">SGD</option>
<option value="USD">USD</option>
</select> 
```

也试过

```
<select id="q_c_0_v_0_value" name="q[c][0][v][0][value]" size="1" multiple="multiple">
<option value="SGD">SGD</option>
<option value="USD">USD</option>
</select> 
```

与所有谓词“等于任何”、“包含任何”等的组合，

我得到结果

```
SELECT "auctions".* FROM "my_table" WHERE (("auctions"."currency" LIKE '%["SGD", "USD"]%')) 
```

和

```
 SELECT "auctions".* FROM "my_table" WHERE ("auctions"."currency" LIKE '%USD') 
```

任何想法，链接[https://github.com/ernie/ransack/issues/7](https://github.com/ernie/ransack/issues/7)说它可能，但我似乎没有得到正确的结果。

# jquery - 使用 jQuery 选择器查找以 class 开头的元素

> ID：14882115
> 
> 赞同：0
> 
> 时间：2013-02-14T19:01:43.617
> 
> 标签：jquery, jquery-selectors

我有以下元素列表。

```
 <tr id="level_0">
 <tr class="level_0_1">
 <tr class="level_0_2">
 <tr class="level_0_2_1">
 <tr class="level_0_2_2">
 <tr class="level_0_2_3">
 <tr class="level_0_2_3_1">
 <tr class="level_0_2_3_2"> 
```

我正在尝试选择所有有`class` `level_0_2_X`和没有的元素`level_0_2_X_X`

使用 jQuery“开始于”选择器，我可以选择所有具有`class` `level_0_2_X`和`level_0_2_X_X`

```
 $("tr[class^='level_0_2_']").show(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T19:04:24.493

您最好将选择器与过滤功能结合起来：

```
$('[id^=level_0_2_]').filter(function(){ return this.id.split('_').length<5 }) 
```

如果你想要的实际上是对类的过滤，你可以使用这个：

```
$('[class^=level_0_2_]').filter(function(){
    return this.className.split('_').length<5
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:05:23.760

尝试使用`match()`. 以下必须为您完成工作：

```
$('tr').each(function(){
     if( $(this).attr('id').match(/pattern/) ) {
          $(this).show();
     }
  } 
```

只需根据需要使用该模式。同样在上面我使用了'id'，如果需要，你会得到'class'属性并与之匹配。

# coffeescript - 在 CoffeeScript 中使用 Underscore.js

> ID：14882118
> 
> 赞同：3
> 
> 时间：2013-02-14T19:02:14.110
> 
> 标签：coffeescript, underscore.js

我正在使用 CoffeeScript 开发并想开始使用 Underscore.js。我知道任何 JS 库都可以在 CoffeeScript 中使用。

网上有常规的[UnderscoreJS](http://underscorejs.org/)和[CoffeScript](http://coffeescript.org/documentation/docs/underscore.html)版本。两者的含义有什么不同吗？使用下划线 JS 版本来满足我的 CoffeeScript 需求是否完全可以？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T21:53:01.883

您需要使用 JavaScript 版本。CoffeeScript 版本可能只是作者在玩 CoffeeScript，这是有道理的，因为他是 CoffeeScript 和 Underscore 的作者。此外，CoffeeScript 版本引入了一个编译步骤（假设您在浏览器中使用它，而不是在带有 node.js 的服务器上）。

作为另一种选择，请查看 Lodash。它是 Underscore 的直接替代品，出于多种原因，它是更好的选择。它在过去几天刚刚发布了 v1.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:15:54.877

通常当你在 Coffeescript 中开发时，你会需要一些东西来将你的各种 Coffeescript 文件一起编译成 Javascript，以便浏览器可以运行它。您希望如何使用该库决定了您将使用哪个版本。

*   选项 1：手动将 Underscore 库（以 JS 形式）作为`<script>`标签添加到您的页面中，并将您编译的咖啡脚本添加为`<script>`标签。快速简单地让事情正常工作，但是当您向页面添加更多库/样式和意大利面条代码时，会导致标签`<script>`的堆积。`<meta>`

*   选项 2：使用工具将所有 Coffeescript 和 CSS 编译成单个 JS/CSS 文件，然后在 HTML 中引用该文件。然后，您将使用下划线的 Coffeescript 形式并将其与其余代码一起编译。这是我使用的方法，其额外优势是能够使用[npm](https://npmjs.org/)之类的工具来管理依赖项。此外，它允许您拥有一个测试 Web 服务器，该服务器可以在您编辑 Coffeescript 时实时编译您的代码。查看[我关于使用 hem、npm 和 Spine 的帖子](https://stackoverflow.com/questions/9425368/spine-js-hem-server-hem-build-faq-for-windows/12595619#12595619)。

对于选项 2，您可以查看的其他内容是[requireJS](http://requirejs.org/)。

# c# - 取消任务并等待它完成

> ID：14882123
> 
> 赞同：14
> 
> 时间：2013-02-14T19:02:28.707
> 
> 标签：c#, task-parallel-library

我有一个耗时的任务，我需要在单独的线程中运行以避免锁定 GUI 线程。随着此任务的进行，它会更新特定的 GUI 控件。

问题是用户可能会在任务结束之前移动到 GUI 的另一部分，在这种情况下，我必须：

1.  取消正在进行的任务（如果它处于活动状态）
2.  等到它完成取消：这是至关重要的，因为耗时任务的目标是更新特定控件。如果多个线程同时尝试执行此操作，事情可能会变得一团糟。
3.  从头开始启动任务

举一个具体的例子，假设表单有两个部分：一个是导航目录树的地方，另一个是显示缩略图的地方。当用户导航到另一个目录时，缩略图需要刷新。

首先我想使用 a`BackgroundWorker`和 an`AutoResetEvent`来等待取消，但我一定搞砸了，因为取消时我陷入了僵局。然后我读到了 TPL，它应该取代 BGW 和更原始的机制。

这可以使用 TPL 轻松完成吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-14T21:37:13.163

需要注意的几点：

*   你可以`CancellationToken`从一个`CancellationTokenSource`

*   任务取消是一种**合作**行为：如果您的任务没有定期检查`CancellationToken.IsCancellationRequested`属性，那么无论您尝试取消任务多少次，它都会愉快地流失。

说了这么多，大致思路如下：

```
void Main()
{
    var tokenSource = new CancellationTokenSource();
    var myTask = Task.Factory
        .StartNew(() => DoWork(tokenSource.Token), tokenSource.Token);

    Thread.Sleep(1000);

    // ok, let's cancel it (well, let's "request it be cancelled")
    tokenSource.Cancel();

    // wait for the task to "finish"
    myTask.Wait();
}

public void DoWork(CancellationToken token)
{
    while(!token.IsCancellationRequested)
    {
        // Do useful stuff here
        Console.WriteLine("Working!");
        Thread.Sleep(100);
    }
} 
```

# express - 当有路由匹配但没有 HTTP 方法匹配时从 express.js 发送 405

> ID：14882124
> 
> 赞同：20
> 
> 时间：2013-02-14T19:02:29.837
> 
> 标签：express

如果客户端发送的请求与映射的 url 路由匹配但与映射的 HTTP 方法不匹配，我正在寻找一种干净的方法让我的快速应用程序返回 405 Method Not Allowed。

我当前的实现是有一个默认的“catch-all”处理程序，它尝试将 url 与注册路由匹配，忽略 HTTP 方法。如果匹配，那么我们知道返回 405，否则我们让 express 执行其默认的 404 行为。

我希望有一种更好的方法，它不涉及将所有路由匹配运行两次（一次通过快递，一次通过我的处理程序）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-02T00:54:13.487

这是我已成功用于多个 Django 应用程序的方法，现在用于 Node 和 Express。它还遵循[RFC 2616 (HTTP/1.1)](https://www.rfc-editor.org/rfc/rfc2616#page-66)，它对 HTTP 405 进行了以下说明：

> 响应必须包含一个 Allow 标头，其中包含所请求资源的有效方法列表。

因此，关键是**将请求路由到同一个处理程序**，而不考虑方法。

```
app.all('/page/:id', page.page);
app.all('/page/:id/comments', page.comments);
app.all('/page/:id/attachments', page.attachments);
... 
```

下一点是**验证处理**函数“comments”中的方法。请注意，处理程序负责处理所有方法。在 Django 的世界中，这是唯一可行的方法，因为框架会强制您将 URL 的路由与将对 URL 所代表的资源执行的实际操作分开。

在处理程序中，您**可以**检查这样的方法...

```
exports.comments = function (req, res) {
    if (req.route.method === 'get') {
        res.send(200, 'Hello universe.');
    } else {
        res.set('Allow', 'GET');
        res.send(405, 'Method Not Allowed');
    }
} 
```

...但是正如您所料，代码很快就会变得**重复且不易于阅读，**尤其是当您有许多处理函数和许多不同的允许方法集时。

因此，我为这项工作准备了一个名为*restful的***快捷功能**。随心所欲地定义函数。我个人会将它放在实现处理程序函数的同一目录下的 helpers.js 中。

 *```
var restful = function (req, res, handlers) {
    // 
    // This shortcut function responses with HTTP 405
    // to the requests having a method that does not
    // have corresponding request handler. For example
    // if a resource allows only GET and POST requests
    // then PUT, DELETE, etc requests will be responsed
    // with the 405\. HTTP 405 is required to have Allow
    // header set to a list of allowed methods so in
    // this case the response has "Allow: GET, POST" in
    // its headers [1].
    // 
    // Example usage
    //     
    //     A handler that allows only GET requests and returns
    //     
    //     exports.myrestfulhandler = function (req, res) {
    //         restful(req, res, {
    //             get: function (req, res) {
    //                 res.send(200, 'Hello restful world.');
    //             }
    //         });
    //     }
    // 
    // References
    //     
    //     [1] RFC-2616, 10.4.6 405 Method Not Allowed
    //     https://www.rfc-editor.org/rfc/rfc2616#page-66
    //     
    //     [2] Express.js request method
    //     http://expressjs.com/api.html#req.route
    //
    var method = req.route.method; // [2]
    if (!(method in handlers)) {
        res.set('Allow', Object.keys(handlers).join(', ').toUpperCase());
        res.send(405);
    } else {
        handlers[method](req, res);
    }
} 
```

有了*restful*，现在自动处理 405 响应并设置适当的 Allow 标头变得非常轻松。只需为您允许的每种方法提供一个功能，其余的由*restful完成。*

所以让我们修改前面的例子：

```
exports.comments = function (req, res) {
    restful(req, res, {
        get: function (req, res) {
            res.send(200, 'Hello restful universe.');
        }
    });
} 
```

为什么叫*宁静*？在[RESTful](https://en.wikipedia.org/wiki/Representational_state_transfer) Web 中，API 必须遵守约定，例如使用 HTTP 405 响应具有不受支持的方法的请求。其中许多约定可以在需要时集成到*restful*。因此这个名字是*宁静*的，而不是像*auto405*或*http405handler*这样的名字。

希望这可以帮助。有什么想法吗？

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-12-02T03:07:04.163

# 方法一：使用`.route()`和`.all()`

```
// Your route handlers
const handlers = require(`./handlers.js`);

// The 405 handler
const methodNotAllowed = (req, res, next) => res.status(405).send();

router
.route(`/products`)
.get(handlers.getProduct)
.put(handlers.addProduct)
.all(methodNotAllowed);
```

这是可行的，因为请求按照它们附加到路由的顺序传递给处理程序（请求“瀑布”）。`.get()`和处理程序将`.put()`捕获 GET 和 PUT 请求，其余的将落入`.all()`处理程序。

# 方法二：中间件

创建检查允许方法的中间件，如果方法未列入白名单，则返回 405 错误。这种方法很好，因为它允许您查看和设置每条路线的允许方法以及路线本身。

这是`methods.js`中间件：

```
const methods = (methods = ['GET']) => (req, res, next) => {
  if (methods.includes(req.method)) return next();
  res.error(405, `The ${req.method} method for the "${req.originalUrl}" route is not supported.`);
};

module.exports = methods;
```

然后，您将在您的路线中使用`methods`中间件，如下所示：

```
const handlers = require(`./handlers.js`); // route handlers
const methods = require(`./methods.js`);   // methods middleware

// allows only GET or PUT requests
router.all(`/products`, methods([`GET`, `PUT`]), handlers.products);

// defaults to allowing GET requests only
router.all(`/products`, methods(), handlers.products);
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T21:29:07.463

由于模棱两可，确实没有其他办法。就个人而言，我会做这样的事情：

```
var route = '/page/:id/comments'
app.get(route, getComments)
app.all(route, send405)

function send405(req, res, next) {
  var err = new Error()
  err.status = 405
  next(err)
} 
```

无论哪种方式，您都必须检查路线两次。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-06T20:41:00.453

有点老问题，但这是我所做的。我只是把它放在我所有的路线之后，但在我的 400 处理程序之前

```
// Handle 405 errors
app.use(function(req, res, next) {
  var flag = false;
  for (var i = 0; i < req.route.stack.length; i++) {
    if (req.method == req.route.stack[i].method) {
      flag = true;
    }
  }
  if (!flag) {
    err = new Error('Method Not Allowed')
    err.status = 405;
    return next(err)
  }

  next();
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-15T17:27:01.840

我一直这样做：

假设你有 GET 和 POST 方法处理程序`/`。`app.route`您可以使用or包装路径`router.route`并相应地分配处理程序。

```
 app.route("/").get((req, res) => {
            /* DO SOMETHING*/
    }).post((req, res) => {
            /* DO SOMETHING*/
    }).all((req, res) => {
            res.status(405).send();
    }); 
```

*   [http://expressjs.com/en/4x/api.html#app.route](http://expressjs.com/en/4x/api.html#app.route)
*   [http://expressjs.com/en/4x/api.html#router.route](http://expressjs.com/en/4x/api.html#router.route)

请求将与路由匹配并通过处理程序过滤。如果存在处理程序，它将照常处理。否则，它将到达`all`将状态代码设置为 405 并结束请求的处理程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-04T13:12:46.647

我这样修复它：

```
/*paths here*/

router.get('/blah/path1', blah.do_something );
router.post('/blah/path2', blah.do_something_else );

/* if we get here we haven't already gone off down another path */

router.all('/*', (req,res) => { res.status(405), 
   res.json({'status':405,
             'message':req.method + ' not allowed on this route'}) 
});

/* simples */ 
```*

# c++ - 将过剩与 Qt 联系起来

> ID：14882136
> 
> 赞同：2
> 
> 时间：2013-02-14T19:03:29.357
> 
> 标签：c++, qt, opengl, qt4, glut

我想将OpenGL与过剩结合到Qt。我正在使用 Windows。我的 Qt 版本是 4.7.4，32 位。

我按照教程：

[http://www.youtube.com/watch?v=1nzHSkY4K18](http://www.youtube.com/watch?v=1nzHSkY4K18)

我还检查了人们的其他一些问题，但他们没有给我答案。

包括过剩之前的部分工作正常。但是，当我尝试包含 glut 时，它不起作用。错误是：

> 未定义对 glutInit_ATEXIT_HACK 的引用

以及更多未定义的对 glutfunctions 的引用。

我将 glut-libraries 和 headers 复制到 MinGW 文件夹中的相应文件夹中。但我不确定这是否是正确的文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-18T06:18:43.013

**MinGW:**

Copy glut.h to **%dir%\MinGW\include\GL**

Copy glut32.lib to **%dir%\MinGW\lib**

Copy glut32.dll to **C:\windows\system32**

Add **%dir%\MinGW\bin** to the system's environmental variables.

**Visual Studio:**

Navigate to

**%dir% \Microsoft Visual Studio\2017\Community\VC\Tools\MSVC\14.12.25827\**

Place the **.h** files in ...\include\GL

Place the **.lib** files in ...\lib

Restart Visual Studio.

# python - 将 JSON 文件中的值替换为可以嵌套 n 级的键

> ID：14882138
> 
> 赞同：12
> 
> 时间：2013-02-14T19:03:37.463
> 
> 标签：python, json

我有如下所示的 JSON：

```
{
"ROLE_NAME": {
    "FOO": {
        "download_url": "http: //something.staging/12345/buzz.zip"
    },
    "BAR": {
        "download_url": "http: //something.staging/12345/fizz.zip"
    },
    "download_url": "http: //something.staging/12345/fizzbuzz.zip",
    "db_name": "somedb",
    "db_server": "dbserver.staging.dmz",
    "plugin": {
        "server_url": "http: //lab.staging.corp/server/"
    }
}
} 
```

我写了一点python，用一个新值（即新的download_url）替换了“download_url”k:v。不幸的是，它只替换了该 json 片段中的三个 download_url 之一。我明白为什么，但是在获得解决方案时遇到了一点困难，所以我在这里寻求帮助。

整个 json 对象是“数据”所以我做这样的事情：

```
data["ROLE_NAME"]["download_url"] = download_url 
```

其中 download_url 是我分配给该变量的新值 我需要做的是为任何名为 ["download_url"] 的键然后更新它，而不是我在我要去的层指定的那个。

我的一些代码可以提供帮助：

我在我的代码中获取了一些之前获得的值，并构建了一个返回响应的 url。我从响应中提取一个值，该值将用于构建 download_url 的值

```
buildinfo_url = "http://something.staging/guestAuth/app/rest/builds/?locator=buildType:%s,tags:%s,branch:branched:any" % (
    bt_number,
    list_json_load[role_name][0]['tag']
) 
```

发送 HTTP 请求

```
client = httplib2.Http()
response, xml = client.request(buildinfo_url) 
```

从响应 xml 中提取一些值并设置 download_url 变量

```
doc = ElementTree.fromstring(xml)
for id in doc.findall('build'):
    build_id = "%s" % (id.attrib['id'])
try:
    download_url = "http://something.staging/guestAuth/repository/download/%s/%s:id/%s" % (
        bt_number,
        build_id,
        build_artifact_zip
    )
    data[role_name]["download_url"] = download_url
except NameError:
    print "something" 
```

我想我应该递归搜索和更新

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-14T19:37:54.573

使用递归

```
import json   
json_txt = """
{
"ROLE_NAME": {
    "FOO": {
        "download_url": "http: //something.staging/12345/buzz.zip"
    },
    "BAR": {
        "download_url": "http: //something.staging/12345/fizz.zip"
    },
    "download_url": "http: //something.staging/12345/fizzbuzz.zip",
    "db_name": "somedb",
    "db_server": "dbserver.staging.dmz",
    "plugin": {
        "server_url": "http: //lab.staging.corp/server/"
    }
}
}
"""
data = json.loads(json_txt)

def fixup(adict, k, v):
    for key in adict.keys():
        if key == k:
            adict[key] = v
        elif type(adict[key]) is dict:
            fixup(adict[key], k, v)

import pprint
pprint.pprint( data )

fixup(data, 'download_url', 'XXX')

pprint.pprint( data ) 
```

输出：

```
{u'ROLE_NAME': {u'BAR': {u'download_url': u'http: //something.staging/12345/fizz.zip'},
                u'FOO': {u'download_url': u'http: //something.staging/12345/buzz.zip'},
                u'db_name': u'somedb',
                u'db_server': u'dbserver.staging.dmz',
                u'download_url': u'http: //something.staging/12345/fizzbuzz.zip',
                u'plugin': {u'server_url': u'http: //lab.staging.corp/server/'}}}
{u'ROLE_NAME': {u'BAR': {u'download_url': 'XXX'},
                u'FOO': {u'download_url': 'XXX'},
                u'db_name': u'somedb',
                u'db_server': u'dbserver.staging.dmz',
                u'download_url': 'XXX',
                u'plugin': {u'server_url': u'http: //lab.staging.corp/server/'}}} 
```

# c# - 如何在构造函数中设置属性值（显式接口实现）

> ID：14882141
> 
> 赞同：6
> 
> 时间：2013-02-14T19:03:48.007
> 
> 标签：c#, interface

```
[DataContract]
public class OrderSyncData : ISync
{

    public OrderSyncData(Order o)
    {
        this.CurrentOrderStatus = o.DriverStatus;
        this.StatusDescription = o.StatusDescription;
        SyncTimestamp = o.SyncTimestamp; ????
    }
    [DataMember]
    public string CurrentOrderStatus { get; set; }
    [DataMember]
    public string StatusDescription { get; set; }
    [DataMember]// I don't think I need these any more
    public bool IsCanceled { get; set; }
    [DataMember]
    public bool IsResolved { get; set; }
    [DataMember]
    public bool IsPendingResponse { get; set; }

    DateTime ISync.SyncTimestamp { get; set; }
} 
```

如何设置 ISync.SyncTimestamp 的值？我试着投射“这个”。但它不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:06:54.683

这应该有效：

```
((ISync)this).SyncTimestamp = o.SyncTimestamp; 
```

注意周围的额外大括号`(ISync)this`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T19:06:51.300

你只需要投射`this`：

```
((ISync) this).SyncTimestamp = o.SyncTimestamp; 
```

或者你可以在两个语句中做到这一点：

```
ISync sync = this;
sync.SyncTimestamp = o.SyncTimestamp; 
```

基本上，显式接口实现意味着该属性仅在您在 simple`this`的上下文中查看时才可用`ISync`，而不是在实现类中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T19:11:24.157

这是因为您已`SyncTimestamp`明确实施。不能从类实例访问显式实现。为什么？因为显式实现允许您实现具有相同成员名称的多个接口。

```
class Foo: IBar, IFoo
{
    bool IBar.FooBar {get;set;}
    bool IFoo.FooBar {get;set;}
} 
```

那么写`this.FooBar`是指哪个实现呢？因此，要么`this`像其他答案建议的那样显式转换为所需的接口，要么不`SyncTimestamp`显式实现，而是隐式执行`public DateTime SyncTimestamp { get; set; }`：然后`this.SyncTimestamp`会工作。

# python - 限制 re.findall() 记录某个数字之前的值。Python

> ID：14882142
> 
> 赞同：0
> 
> 时间：2013-02-14T19:03:47.723
> 
> 标签：python, function, search, bioinformatics, findall

```
sequence_list = ['atgttttgatggATGTTTGATTAG','atggggtagatggggATGGGGTGA','atgaaataatggggATGAAATAA'] 
```

我从 sequence_list 中取出每个元素 (fdna) 并搜索以 ATG 开头的序列，然后按 3 读取，直到它到达 TAA、TGA 或 TAG

sequence_list 中的每个元素都由两个序列组成。第一个序列是小写的，第二个是大写的。结果字符串由小写+大写组成

# 收集 CDS 开始 & Upper()

```
cds_start_positions = []
cds_start_positions.append(re.search("[A-Z]", fdna).start())
fdna = fdna.upper() 
```

所以在我找到大写序列的开始位置后，我将索引号记录在 cds_start_positions 中，然后将整个字符串（fdna）转换为大写

此语句收集所有 ATG-xxx-xxx- 后跟 TAA|TAG|TGA

# 收集 uORF

```
ORF_sequences = re.findall(r'ATG(?:...)*?(?:TAA|TAG|TGA)',fdna) 
```

所以我想要做的是收集所有出现 ATG-xxx-xxx 后跟 TAA、TGA 或 TAG 的情况。

我的输入数据由 2 个序列（小写大写）组成，我想在以下情况下找到这些序列：

1：ATG 后面是小写的 TAA|TGA|TAG（现在是大写，但它们变为大写的值存储在 cds_start_positions 中）

2：ATG 位于小写部分（小于 cds_start_position 值），而其后的下一个 TAA|TGA|TAG 为大写。

注意* 现在设置的方式是将原始大写部分（大于 cds_start_position 值）的 ATG 保存到列表

"Gathering CDS Starts & Upper()" 所做的是找到大写序列的开始位置。

有什么方法可以限制“收集 uORFs”部分，使其仅识别列表 cds_start_positions 中相应元素之前位置的 ATG？

我想在 ORF_sequences 行中添加一个语句，它只在列表“cds_start_positions”中的每个元素之前找到“ATG”

cds_start_positions 的外观示例

```
cds_start_positions = [12, 15, 14] #where each value indicates where the uppercase portion starts in the sequence_list elements (fdna) 
```

对于 sequence_list 中的第一个序列，我想要这个结果：

```
#input
fdna = 'atgttttgatggATGTTTGATTAG'
#what i want for the output
ORF_sequences = ['ATGTTTTGA','ATGGATGTTTGA']
#what i'm getting for the output
ORF_sequences = ['ATGTTTTGA','ATGGATGTTTGA','ATGTTTGATTAG'] 
```

第 3 个条目位于值 12（列表 cds_start_positions 中的相应值）之后，我不希望这样。但是，第二个条目的起始 ATG 在该值 12 之前，其 TAA|TGA|TAG 在值 12 之后，应该允许。

***注意我还有另一行代码，它只是占据这些 ATG-xxx-xxx-TAA|TGA|TAG 出现位置的起始位置，即：

```
start_positions = [i for i in start_positions if i < k-1] 
```

有没有办法在 re.findall 中使用这个原则？

让我知道是否需要澄清任何事情

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:50:52.853

**更新 2** - 完整代码

```
import re

def getSequences(fdna):
    start = re.search("[A-Z]", fdna).start()
    fdna = fdna.upper()

    ORF_sequences = re.finditer(r'(?<=ATG)(.*?)(?:TAA|TAG|TGA)',fdna)

    sequences = []

    for match in ORF_sequences:
        s = match.start()
        if s < start:
            sequences.append("ATG" + match.group(0))

    print sequences

    return sequences

sequence_list = ['atgttttgatggATGTTTGATTAG','atggggtagatggggATGGGGTGA','atgaaataatggggATGAAATAA']

for fdna in sequence_list:
    getSequences(fdna) 
```

**输出**

```
>>> 
['ATGTTTTGA', 'ATGGATGTTTGA']
['ATGGGGTAG', 'ATGGGGATGGGGTGA']
['ATGAAATAA', 'ATGGGGATGA'] 
```

* * *

**更新**

如果你需要`re`，那么试试这个：

```
ORF_sequences = re.finditer(r'(?<=ATG)(.*?)(?:TAA|TAG|TGA)',fdna)

for match in ORF_sequences:
    print match.span()
    print "ATG" + match.group(0) 
```

**输出**

```
>>> 
(3, 9)
ATGTTTTGA
(11, 20)
ATGGATGTTTGA 
```

**笔记**

这并不总是有效。`match.start()`但是您可以检查反对的 therr 值`cds_start_position`并删除不需要的序列。

* * *

试试这个，不是`re`，但有效......

```
def getSequences(fdna, start):
    """Find the sequence fully to left of start and
    laying over the start"""

    i = 0
    j = 0
    f = False
    while True:
        m = fdna[i:i+3]
        if f is False:
            if m == "ATG":
                f = True
                j = i
                i += 2
        else:
            if m in ["TAA", "TAG", "TGA"]:
                i += 2
                seq1 = fdna[j: i+1]
                break

        i += 1

    i = 1
    j = 0
    f = False
    while True:
        m = fdna[i:i+3]
        if f is False:
            if m == "ATG" and i < start:
                f = True
                j = i
                i += 2
        else:
            if m in ["TAA", "TAG", "TGA"] and i > start:
                i += 2
                seq2 = fdna[j: i+1]
                break

        i += 1

    print "Sequence 1 : " + seq1
    print "Sequence 2 : " + seq2 
```

**测试**

```
fdna = 'atgttttgatggATGTTTGATTAG'

cds_start_positions = []
cds_start_positions.append(re.search("[A-Z]", fdna).start())

fdna = fdna.upper()

getSequences(fdna, cds_start_positions[0]) 
```

**输出**

```
>>> 
Sequence 1 : ATGTTTTGA
Sequence 2 : ATGGATGTTTGA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:22:09.273

昨天，我写了第一个答案。

然后我阅读了 ATOzTOA 的答案，其中他有一个非常好的主意：使用积极的后视断言。
我认为我的答案完全出局了，他的想法是正确的做法。
但后来，我意识到 ATOzTOA 的代码存在缺陷。

假设检查字符串中有一部分`'ATGxzyxyzyyxyATGxzxzyxyzxxzzxzyzyxyzTGA'`：肯定匹配将发生在`'xzyxyzyyxyATGxzxzyxyzxxzzxzyzyxyzTGA'` 前面，断言匹配发生在前面`'ATG'`，因此该部分将构成匹配；没关系。
但这意味着在此匹配之后，正则表达式电机位于该部分的末尾 `'xzyxyzyyxyATGxzxzyxyzxxzzxzyzyxyzTGA'`。
因此，当正则表达式电机将搜索下一个匹配项时，它不会`'ATG'`在此部分的当前位置找到匹配项，因为它会从很久之后的位置再次运行。

.

因此，实现问题所需的唯一方法实际上是我编写的第一个算法，然后我重新发布它。

该工作由函数**find_ORF_seq()完成**

如果您将`True`作为第二个参数传递给`messages`函数的第二个参数`find_ORF_seq()`，它将打印有助于理解算法的消息。
如果不是，则参数`messages`采用默认值`None`

该模式是`'(atg).+?(?:TAA|TGA|TAG)'`用一些大写字母和其他小写字母书写的，但这并不是相对于大写字母和小写字母正确捕捉部分的原因。因为，正如您将看到的那样，`re.IGNORECASE`使用了标志：这个标志是必要的，因为匹配的部分`(?:TAA|TGA|TAG)`可以落在小写部分和大写部分。

该算法的本质在于while循环，这是必要的，因为正如我上面解释的那样，研究的部分可能会重叠（据我理解正确并且您给出的示例和解释是正确的）。
所以不可能使用`findall()`or`finditer()`并且我做了一个循环。

为了避免在**fdna**序列中逐个碱基地进行迭代，我使用了在字符串`ma.start()`中给出匹配开始位置的方法`ma`，并且我增加了`s`with `s = s + p + 1`( **+1**的值以不再开始搜索找到匹配的开始！）

我的算法不需要以下信息，`start_positions`因为我不使用后视断言，而是对前 3 个字母进行真正匹配：当匹配开始位于大写部分时，匹配被声明为不符合约束，即它说什么时候`ma.group(1)`捕获前三个碱基（可以是`'ATG'`或者`'atg'`因为正则表达式忽略大小写）等于`'ATG'`

我不得不`s = s + p + 1`代替，`s = s + p + 3`因为您搜索的部分似乎没有被三个碱基的倍数隔开。

```
import re

sequence_list = ['atgttttgatgATGTTTTGATTT',
                 'atggggtagatggggATGGGGTGA',
                 'atgaaataatggggATGAAATAA',
                 'aaggtacttctcggctaACTTTTTCCAAGT']

pat = '(atg).+?(?:TAA|TGA|TAG)'
reg = re.compile(pat,re.IGNORECASE)

def find_ORF_seq(fdna,messages=None,s=0,reg=reg):
    ORF_sequences = []
    if messages:
        print 's before == ',s
    while True:
        if messages:
            print ('---------------------------\n'
                   's == %d\n'
                   'fdna[%d:] == %r' % (s,s,fdna[s:]))
        ma = reg.search(fdna[s:])
        if messages:
            print 'reg.search(fdna[%d:]) == %r' % (s,ma)
        if ma:
            if messages:
                print ('ma.group() == %r\n'
                       'ma.group(1) == %r'
                       % (ma.group(),ma.group(1)))
            if ma.group(1)=='ATG':
                if messages:
                    print "ma.group(1) is uppercased 'ATG' then I break"
                break
            else:
                ORF_sequences.append(ma.group().upper())
                p = ma.start()
                if messages:
                    print (' The match is at position p == %d in fdna[%d:]\n'
                           ' and at position s + p == %d + %d == %d in fdna\n'
                           ' then I put s = s + p + 1 == %d'
                           % (p,s, s,p,s+p, s+p+1))
                s = s + p + 1
        else:
            break
    if messages:
        print '\n==== RESULT ======\n'
    return ORF_sequences

for fdna in sequence_list:
    print ('\n============================================')
    print ('fdna == %s\n'
           'ORF_sequences == %r'
           % (fdna, find_ORF_seq(fdna,True)))

###############################

print '\n\n\n######################\n\ninput sample'
fdna = 'atgttttgatggATGTTTGATTTATTTTAG'
print '  fdna == %s' % fdna
print '  **atgttttga**tggATGTTTGATTTATTTTAG'
print '  atgttttg**atggATGTTTGA**TTTATTTTAG'
print 'output sample'
print "  ORF_sequences = ['ATGTTTTGA','ATGGATGTTTGA']"

print '\nfind_ORF_seq(fdna) ==',find_ORF_seq(fdna) 
```

.

相同的功能不用`print`说明更好看算法。

```
import re

pat = '(atg).+?(?:TAA|TGA|TAG)'
reg = re.compile(pat,re.IGNORECASE)

def find_ORF_seq(fdna,messages=None,s =0,reg=reg):
    ORF_sequences = []
    while True:
        ma = reg.search(fdna[s:])
        if ma:
            if ma.group(1)=='ATG':
                break
            else:
                ORF_sequences.append(ma.group().upper())
                s = s + ma.start() + 1
        else:
            break
    return ORF_sequences 
```

.

我比较了 ATOzTOA 的和我的这两个函数，并用**fdna**序列揭示了这个缺陷。这使我所描述的合法化。

```
from find_ORF_sequences import find_ORF_seq
from ATOz_get_sequences import getSequences

fdna = 'atgggatggtagatggatgggATGGGGTGA'

print 'fdna == %s' % fdna
print 'find_ORF_seq(fdna)\n',find_ORF_seq(fdna)
print 'getSequences(fdna)\n',getSequences(fdna) 
```

结果

```
fdna == atgggatggtagatggatgggATGGGGTGA
find_ORF_seq(fdna)
['ATGGGATGGTAG', 'ATGGTAG', 'ATGGATGGGATGGGGTGA', 'ATGGGATGGGGTGA']
getSequences(fdna)
['ATGGGATGGTAG', 'ATGGATGGGATGGGGTGA'] 
```

.

但毕竟，也许，我想知道....：
你想要另一个匹配的内部部分的匹配，比如`'ATGGGATGGGGTGA'`在末尾`'ATGGATGGGATGGGGTGA'`吗？

如果不是，ATOzTOA 的答案也适合。

# asp.net - 如何在自己的代码后面引用用户控件？

> ID：14882143
> 
> 赞同：1
> 
> 时间：2013-02-14T19:03:48.627
> 
> 标签：asp.net, user-controls

假设我有一个带有几个按钮的用户控件。我想知道是哪一个导致了回发，使用这种方法：

```
public static Control GetPostBackControl(Page page)
    {
        Control control = null;

        string ctrlname = page.Request.Params.Get("__EVENTTARGET");
        if (ctrlname != null && ctrlname != string.Empty)
        {
            control = page.FindControl(ctrlname);
        }
        else
        {
            foreach (string ctl in page.Request.Form)
            {
                Control c = page.FindControl(ctl);
                if (c is System.Web.UI.WebControls.Button)
                {
                    control = c;
                    break;
                }
            }
        }
        return control;
    } 
```

这就是我所说的：

```
string btn = GetPostBackControl(this.Page).ID; 
```

我得到“**对象引用未设置为对象的实例。** ”我现在知道问题出在我使用**this.Page**的事实，它代表**父页面**。

如何引用我所在的用户控件？（不是父页面）以便它可以使用方法来查找导致回发的按钮？

感谢您的帮助。

# 编辑

这两个按钮都位于用户控件内。**GetPostBackControl()**也在用户控件的代码隐藏中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:30:59.610

我对你给定的代码做了一个简单的例子，**结果很好**。也许您确实**错过了检查** `Page.IsPostBack`？显然，只有在有 postBack 时才会有 postBackControl ......

*@Buttons* - 它们将被渲染，`<input type="submit">`因此它们不会出现在`___EVENTTARGET`. 这就是**Ryan Farlay在**[他的博客](http://ryanfarley.com/blog/archive/2005/03/11/1886.aspx)中写道的原因

> 然而，你仍然可以得到它，只是以不同的方式。由于按钮（或输入）是导致表单提交的原因，因此它与来自提交表单的所有其他值一起添加到 Form 集合中的项目中。[...] 如果您要在表单集合中查找任何按钮，那么这将是导致回发的原因（假设它是导致页面提交的按钮）。如果您**首先检查 __EVENTTARGET**，那么 如果那是空白的，请在 Form 集合中**查找一个按钮，然后您会****发现导致回发的原因**

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Page.IsPostBack)
    {
        Control postBackControl = GetPostBackControl(this.Page);
        Debug.WriteLine("PostBackControl is: " + postBackControl.ID);
    }
}
public static Control GetPostBackControl(Page page)
{
    Control control = null;

    string ctrlname = page.Request.Params.Get("__EVENTTARGET");
    if (ctrlname != null && ctrlname != string.Empty)
    {
        control = page.FindControl(ctrlname);
    }
    else
    {
        foreach (string ctl in page.Request.Form)
        {
            Control c = page.FindControl(ctl);
            if (c is System.Web.UI.WebControls.Button)
            {
                control = c;
                break;
            }
        }
    }
    return control;
} 
```

# sql - 在 JDBC 中检索一对多映射的信息

> ID：14882145
> 
> 赞同：0
> 
> 时间：2013-02-14T19:03:53.753
> 
> 标签：sql, jdbc

(** 忽略区分大小写**)

下面是我的父表

```
 Parent Table

    ID        name        name_id
   1001        A           1
   1002        B           2
   1003       AA           3

   Child Table

   Payment Table

   ID        PaymentName    name_id
   1         Credit           3
   2         Debit            3 
```

输出是

```
 paymentName          name          name_id
     Credit              AA              3
     Debit               AA              3 
```

在我的 Java 中

父 POJO 是

```
 int nameID;
   String name;

   List<Payment> paymentNames = new ArrayList<Payment>(); 
```

JDBC 调用后

```
while (resultSet.next()) {                     parent.setNameID(resultSet.getInt("name_ID"));
            parent.setName(resultSet.getString("name"));

  } 
```

我的问题是如何检索 paymentNames 列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:17:21.070

修好了

创建列表

```
 Payment payment;
   List<Payment> paymentList = new ArrayList<Payment>(); 
```

更新了while循环

```
 while(resultset.next())
   {
   payment = new Payment();
   parent.setNameID(resultSet.getInt("name_ID"));
   parent.setName(resultSet.getString("name"));
   payment.setPaymentName(resultSet.getString("paymentName");
   paymentList.add(payment);
   }
   parent.setPaymentNames (paymentList) 
```

# sql-server-2012 - sql2012可用性组只读副本和数据库证书使用问题

> ID：14882152
> 
> 赞同：1
> 
> 时间：2013-02-14T19:04:21.877
> 
> 标签：sql-server-2012

我试图研究我在我的 sql2012 可用性组中使用读取意图辅助副本遇到的问题，但似乎找不到任何东西，我确实看到了一些关于实例级 TDE 的事情，但没有看到数据库级证书。

概述，我有一个数据库，它有一个带有加密列的表，该列使用数据库证书进行加密/解密。可用性组的设置以及创建数据库和副本似乎都进展顺利（三个独立的节点）。但是，当我尝试通过具有读取意图连接的侦听器连接到第二个节点的只读辅助副本，并使用加密列查询此表时，返回的数据全部为 NULL。如果我首先使用密码打开主密钥，然后发出查询，我将返回的数据正常解密，但仅持续该会话连接。我应该提一下，除了主副本和辅助副本的加密问题之外，其他所有问题都可以正常工作。如果我使用 readWrite 查询主数据库，则数据检索得很好。

有谁知道这是否是现在将查询作为只读副本的读取意图，每个会话连接必须首先打开主密钥？还是我设置了一些不正确的东西，我能做些什么来解决这个问题？

打开主键命令：

```
OPEN MASTER KEY DECRYPTION BY PASSWORD = 'password'; 
```

用于查看加密列的查询：

```
SELECT CAST(DECRYPTBYCERT(CERT_ID('CertName'), ColName) AS VARCHAR(200)) aliasColName
  FROM [DBName].[dbo].[tableName] 
```

以下是用于在主节点上创建证书的 sql：

```
USE DBName
DROP CERTIFICATE CertName;
GO

USE DBName
IF NOT EXISTS (SELECT * FROM sys.symmetric_keys 
WHERE [name] LIKE '%DatabaseMasterKey%')
BEGIN
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'password'
END
GO 

USE DBName
OPEN MASTER KEY DECRYPTION BY PASSWORD = 'password'
ALTER MASTER KEY ADD ENCRYPTION BY SERVICE MASTER KEY
GO

USE DBName
CREATE CERTIFICATE CertName FROM FILE = 'C:\Cert.cer'
  WITH PRIVATE KEY ( FILE = 'C:\CertKey.pvk' , 
  DECRYPTION BY PASSWORD = 'password' );
GO

CLOSE MASTER KEY
GO 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T21:08:34.580

在完成该过程后，我找到了解决方案并将其发布在这里，以防其他人遇到同样的事情。

由于数据库主密钥是使用主数据库的服务主密钥加密的，因此我必须将主服务器的服务主密钥强制备份到所有辅助服务器，以便不必在每个会话中明确“打开”数据库主密钥。因此，不仅主密钥需要删除，服务主密钥也需要删除，以保持加密层次结构相同，以使只读路由正常工作。下面是代码。

首先从主服务器备份服务主密钥并将其复制到所有辅助服务器。

```
BACKUP SERVICE MASTER KEY TO FILE = 'C:\service_master_key' 
  ENCRYPTION BY PASSWORD = 'password'; 
```

然后使用 FORCE 选项将其还原到所有辅助服务器。

```
RESTORE SERVICE MASTER KEY FROM FILE = 'C:\service_master_key' 
  DECRYPTION BY PASSWORD = 'password' FORCE 
```

谢谢

# sql - DISTINCT 查询解决方案

> ID：14882156
> 
> 赞同：0
> 
> 时间：2013-02-14T19:04:37.417
> 
> 标签：sql, ms-access

我有以下查询

```
SELECT DISTINCT T_Med.Comp, T_Med.ItemID, T_Med.WP, T_Med.DocName, T_Med.TrfCode, 
       T_Med.CatDescr, T_Med.SubCatDescr, T_LKPWP.RuleCode, T_MedWP.RuleCode, 
       T_Med.Group
FROM (T_Med INNER JOIN T_LKPWP ON (T_Med.DocName=T_LKPWP.SDocName)
AND (T_Med.[WP]=T_LKPWP.WP)) 
LEFT JOIN T_MedWP ON T_LKPWP.RuleCode=T_MedWP.RuleCode
WHERE (((T_MedWP.RuleCode) Is Null)); 
```

由于 DISTINCT 需要很长时间来处理。正如我发现的那样，即使我为这些相关字段创建了索引，它也无助于 DISTINCT。没有 DISTINCT 相同的查询给出的结果不到一秒

这里T_Med有1070065条记录，T_MedWP有366315条记录，T_LKPWP有55条记录

反正有没有以不同的方式实现预期的结果。我试图创建一个没有 DISTINCT 的单独表，即使这需要很长时间。

感谢您的评论

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:19:47.293

```
 SELECT DISTINCT Comp, ItemID, WP, DocName, TrfCode, 
   CatDescr, SubCatDescr, RuleCode, .RuleCode, 
   Group FROM (

 maybe try this...

 SELECT T_Med.Comp, T_Med.ItemID, T_Med.WP, T_Med.DocName, T_Med.TrfCode, 
   T_Med.CatDescr, T_Med.SubCatDescr, T_LKPWP.RuleCode, T_MedWP.RuleCode, 
   T_Med.Group
  FROM (T_Med INNER JOIN T_LKPWP ON (T_Med.DocName=T_LKPWP.SDocName)
   AND (T_Med.[WP]=T_LKPWP.WP)) 
   LEFT JOIN T_MedWP ON T_LKPWP.RuleCode=T_MedWP.RuleCode
   WHERE (((T_MedWP.RuleCode) Is Null));

  ) 
```

还使用 DISTINCT 检查这个 [需要很长时间的查询](https://stackoverflow.com/questions/11859191/query-taking-long-time-with-distinct?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:26:59.120

这是一般的 Oracle 示例，但也许它会给您一些想法。我对Access不太了解，抱歉。无法确定在 Access 中是否存在可用的运算符。

```
-- Same as Distinct --
SELECT deptno, dname FROM scott.dept D WHERE EXISTS ( SELECT 'X' FROM scott.emp E WHERE E.deptno = D.deptno)
/ 
```

# ruby - 如何格式化用于价格的十进制数据类型？

> ID：14882157
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:04:45.700
> 
> 标签：ruby

如何格式化十进制数？

我有`amount = 55.6`。

是否有可以在一行中完成的快速格式，所以输出是`"55.60"`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:07:19.710

```
"%.2f" % amount #=> "55.60" 
```

希望这可以帮助。

# linq-to-entities - 需要解决不区分大小写的 Linq to Entity Framework 查询

> ID：14882163
> 
> 赞同：3
> 
> 时间：2013-02-14T19:05:11.333
> 
> 标签：linq-to-entities

我有三个表用户，用户角色，角色。

*   Usres 表的列是 UserId(Pk varchar(20)), CashCenterId(Int)
*   UserRoles 的列是 UserRoleID(pk Int)、UserId(Fk 到用户表)、RoleID(Fk 到角色表)
*   Roles 的列是 RoleId(Pk int)、RoleName(varchar(30))

我正在使用 LINQ to ENTITY Framework 来查询它们。

现在我想要一个函数来检查登录用户是否具有“FFFAdmin”角色，因此我将登录用户的 UserId 传递给该函数并在函数中执行以下操作。

```
 public bool isUserFFFAdmin(string UserId){

       return (from u in Db.Users
                    join ur in Db.UserRoles on u.UserID equals ur.UserID
                    join r in Db.Roles on ur.RoleID equals r.RoleID
                    where r.RoleName == "FFFAdmin" 
                    && u.UserID.Equals(UserId)
                    select '1').Any();
       } 
```

现在的问题是这个查询不区分大小写所以如果我有两个用户说

1.“Ram”角色为“siteUser” 2.“ram”角色为“FFFAdmin”

现在，当我通过“Ram”时，此函数应返回 false，但由于此查询的不区分大小写的行为，它返回 true。

注意* 我无法更改数据库的排序规则类型以使查询区分大小写。请帮助我是实体和 LInq 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:41:48.353

将任务分成两部分

```
var users = from u in Db.Users
            join ur in Db.UserRoles on u.UserID equals ur.UserID
            join r in Db.Roles on ur.RoleID equals r.RoleID
            where r.RoleName == "FFFAdmin" 
               && u.UserID == UserId
            select u.UserID;

return users.AsEnumerable().Any(s => s == UserId); 
```

第二部分是在`AsEnumerable()`区分大小写的 C# 环境中完成的，而主要的过滤任务仍然是数据库作业。

# php - 如何禁止访问 PHP 中的 URL？

> ID：14882164
> 
> 赞同：0
> 
> 时间：2013-02-14T19:05:16.467
> 
> 标签：php

如果我有一个名为: 的 URL `www.example.com`，并且我在下一个 URL: 中有一个应用程序，我该`www.example.com/app/`如何禁止访问`www.example.com`但不能禁止访问该应用程序？有什么简单的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:07:43.210

使用 .htaccess

```
Order Deny,Allow
Deny from all
Allow from 127.0.0.1

<Directory /app>
    Order Allow,Deny
    Allow from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:11:35.153

如果您需要在 PHP 中执行此操作，您可以简单地设置正确的 HTTP 状态并退出程序：

```
if ($_SERVER['PATH_INFO'] === '/') {
    header('', false, 403);
    die('Access forbidden.');
} 
```

请参阅[header()](http://php.net/header)文档和[HTTP 返回代码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)的描述。

但在一般情况下，@CooPer 和其他人是对的，服务器配置是全局处理该问题的更好位置。

# java - JSSE/JCA/JCE 包是线程安全的吗？

> ID：14882166
> 
> 赞同：2
> 
> 时间：2013-02-14T19:05:16.887
> 
> 标签：java, jsse

我想知道 JSSE/JCE/JCA 包中的类（如 KeyManager、TrustManager、KeyStore 等）在 Java 中是线程安全的，还是需要使其成为线程安全的。

# c# - 从 COM .dll 获取错误“80070002”

> ID：14882170
> 
> 赞同：1
> 
> 时间：2013-02-14T19:05:36.543
> 
> 标签：c#, javascript, .net, com

我正在将经典 ASP 站点从 Windows 2000 服务器移动到 Windows 2008（开发和产品）。我有一个在 .NET 1.1 中创建的 .dll。当在位于此 securityUtility.asp 中的 JScript 中创建的函数使用 dll 创建 ActiveXobject 时，会发生该错误。该行如下所示：

函数getProfileFromLdap（用户，密码）{

var aClass, aProfile

aClass = new ActiveXObject("com.co.comp.security.ldap.LDAPLogin"); ... }

发生的错误是：错误 '80070002' E:\SITES\WWW-COMPANYSITE-COM\SITE\BINS../../siteInc/securityUtility.asp，第 850 行

我已经运行以下命令在注册表中注册 dll：

"C:\Windows\Microsoft.NET\Framework\v1.1.4322\RegAsm" coSecurity.dll /tlb:coSecurity.tlb

我不知道这是否值得一提，但有一次，当我试图将网站移至生产环境时，该网站在开发中运行良好，但出错了。很久以前，我已将该站点移至新的开发服务器（Windows 2008）。我已经做了笔记，所以当我将它投入生产时，我知道我采取了哪些步骤。我想也许我忘了记录一个步骤，所以为了追溯我所做的，我卸载了 .dll 并完成了我记录的步骤。它现在在开发中被打破，但在某一时刻它正在工作。

我不确定值得一提的另一件事是该站点是新开发服务器上的第一个站点。.NET 1.1 在任何其他框架之前安装。4.0 和 2.0 是事后安装的。在 prod 服务器上，首先安装了 4.0，然后安装了 1.1。不确定这是否重要。

*   当开发站点工作时，我确认这些项目在注册表中，将它们与旧产品、新开发服务器和新产品进行比较

*   在旧的生产服务器上，GAC 中没有任何内容

*   coSecurity.dll 与securityUtility.asp （代码所属的页面）在同一个文件中。

*   两个新环境的应用程序池都具有“启用 32 位应用程序”

*   “每个人”都被授予对 .dll 的完全权限

我不确定我错过了什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T16:52:52.753

这就是我最终为那些像我一样用头撞墙的人所做的：

*   以管理员身份打开命令提示符
*   导航到 dll 的存储位置
*   使用 "C:\Windows\Microsoft.NET\Framework\v1.1.4322\RegAsm" /u coSecurity.dll 取消注册 dll
*   使用 "C:\Windows\Microsoft.NET\Framework\v1.1.4322\RegAsm" coSecurity.dll /codebase 重新注册 dll
*   你会得到一个 regasm 警告，但也应该得到消息“类型注册成功”

之后我不再收到错误！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:31:25.893

通常`HRESULT 80070002`意味着“未找到文件”。

我的猜测是您缺少依赖项。尝试使用[Dependency Walker](http://www.dependencywalker.com/)来查看是否应该包含任何依赖项。

另请参阅[此线程](http://social.msdn.microsoft.com/Forums/en/clr/thread/31256c30-68b1-4d60-aa89-a536eca1ebbd)以获取有关手动注册 COM 服务器的一些提示。

# c# - 排序数据问题

> ID：14882171
> 
> 赞同：0
> 
> 时间：2013-02-14T19:05:44.280
> 
> 标签：c#, linq, entity-framework

所以我在对我拥有的一些数据进行排序时遇到了一点问题。在 Telerik Grid 中，我有一个名为 Requestor 的列，它显示一个人或单位（一群人）的名称。问题是，Requestor 有两个可以从中获取数据的来源。这是两个来源。

1.) RequestorId：这是一个名为 Customer 的表的外键。在这里，我存储了用户的所有数据，包括他们的全名。顺便说一句，此字段可以为空。

2.) UnitId：这是一个名为 Units 的表的另一个外键。在这里，我存储了 Units 的所有数据，尤其是它们的名称。顺便说一句，此字段可以为空。

这是逻辑：

```
//Entity class that contains all the data for my grid
var purchaseOrders = _purchaseOrders.GetPurchaseOrders();

//Key is Id of PurchaseOrders, Value is name of requestor
var dictionary = new Dictionary<int, string>();

foreach (var purchaseOrder in purchaseOrders)
{
if (purchaseOrder.requestorId != null)
   dictionary.add(purchaseOrder.Requestor.Fullname);
else 
   dictionary.add(purchaseOrder.unit.Fullname);
}

dictionary.orderby(x => x.value).ToDictionary(x => x.Key, x.Value);
var tempPurchaseOrders = new List<PurchaseOrder>();

foreach (var item in dictionary)
{
   tempPurchaseOrders.Add(purchaseOrders.Where(x => x.Id == item.Key).FirstOrDefault());
}

purchaseOrders = tempPurchaseOrders.AsQueryable();
return purchaseOrders; 
```

这个逻辑根据我想要做的事情返回一个有序列表，但是，问题是处理所需的时间。处理需要 1 分钟。这显然很可怕。反正有没有优化这个？我在返回网格后切断了源，因为没有逻辑方法可以事先真正切断它。

任何帮助，将不胜感激。谢谢。

**编辑：我发现我不再需要使用 RequestName 字段。这将数据限制在两个领域。不过还有一分钟的时间来处理。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:44:03.807

所以我想出了自己的解决方案。我首先尝试了 Sławomir Rosiek 和 Gert Arnold 所做的事情。不幸的是，就像格特提到的那样，第一个答案不会通过。第二个也有类似的问题。

最后，我创建了一个类来存储来自请求者和单元的数据。它包括以下内容：

```
internal class RequestorData
{
   public int entityId { get; set; }
   public string Name { get; set; }
   public bool isRequestorId { get; set; }
} 
```

接下来，我做了以下事情。

```
//Entity class that contains all the data for my grid
var purchaseOrders = _purchaseOrders.GetPurchaseOrders();
var tempPurchaseOrders = new List<PurchaseOrder>();
var requestors = new List<RequestorData>();
var customers = purchaseOrders.Select(po => po.Requestor).Distinct().ToList();
var units = purchaseOrders.Select(po => po.Unit).Distinct().ToList();

foreach (var customer in customers)
{
   if (customer != null)
      requestors.Add(new RequestorData { entityId = customer.Id, Name = customer.FullName, isRequestorId = true });
}
foreach (var unit in units)
{
   if (unit != null)
     requestors.Add(new RequestorData { entityId = unit.Id, Name = unit.FullName, isRequestorId = false });
}

requestors = requestors.OrderBy(r => r.Name).ToList();

foreach (var requestor in requestors)
{
   var id = requestor.entityId;
   if (requestor.isRequestorId)
      tempPurchaseOrders.AddRange(purchaseOrders.Where(po => po.RequestorId == id).ToList());
   else
      tempPurchaseOrders.AddRange(purchaseOrders.Where(po => po.UnitId == id).ToList());
}

purchaseOrders = tempPurchaseOrders.AsQueryable();
return purchaseOrders; 
```

我运行了这个新版本，等待了 5-6 秒。这并不完美，但比以前好多了。感谢所有的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:56:57.633

你有没有尝试过这样的事情：

```
return _purchaseOrders.GetPurchaseOrders().Select(i => new 
{
     OrderColumn = i.requestorId != null ? purchaseOrder.Requestor.Fullname : purchaseOrder.unit.Fullname,
     // map other columns
})
.OrderBy(i => i.OrderColumn); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:26:20.017

有点像 Sławomir Rosiek 的解决方案（但实体框架不会接受该声明）：

```
return _purchaseOrders.GetPurchaseOrders()
                      .OrderBy(o => o.unit.Fullname).ToList(); 
```

（因为您不再使用 RequestName 了）。

尤其是当`GetPurchaseOrders()`来自`IQueryable`EF 时，您将排序委托给数据库引擎，因为排序表达式成为 SQL 语句的一部分。

# java - 编写一个使用 TTS（文本到语音）的程序我应该从哪里开始？

> ID：14882173
> 
> 赞同：-4
> 
> 时间：2013-02-14T19:05:46.387
> 
> 标签：java, c, text-to-speech

谁能告诉在哪里可以找到将 TTS 添加到 Java 编写程序的指令*（C 适合）*。我想编写没有任何插图的程序，并添加一些现有程序没有的功能。用户只需写下单词，然后计算机大声发音。如果声音输出不像大多数 TTS 那样好，那就太好了。**谁能帮我**。

****我是 Java 和 C 的新手，所以是否有任何说明如何将 tts 包含到我的程序中。****

 ****我知道 Java：FreeTTS，但我还没有找到任何好的教程如何将它包含到我的程序*中（在我的程序中使用它）*或如何编写使用 Java 的程序：FreeTTS** 

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:08:55.713

两种语言都有许多库，例如：

Java：[免费TTS](http://freetts.sourceforge.net/docs/index.php)

C++：[节日](http://www.cstr.ed.ac.uk/projects/festival/)**

# android - 类似于 Twitter 的可扩展 ListView

> ID：14882174
> 
> 赞同：0
> 
> 时间：2013-02-14T19:05:49.460
> 
> 标签：android, android-listview, expandablelistview

我正在寻找一种类似于 Twitter 应用程序中的自定义可扩展 ListView。

我查看了位于此处的 SlideExpandableListView：[https](https://github.com/tjerkw/Android-SlideExpandableListView) ://github.com/tjerkw/Android-SlideExpandableListView 但它必须有一个按钮显示菜单，而不是 onLongClick 并且它在列表中占用更多空间。我希望菜单显示在 ListView 项目上。

我在网上搜索过，但找不到任何类似于 Twitter 实现的东西。有人知道可以提供帮助的实现吗？

谢谢，贾斯汀

推特示例：

![在此处输入图像描述](../Images/d47265d5c26101d40005d679b79a228d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:09:55.657

您不能只向 SlideExpandableListView 添加一个侦听器吗？[https://github.com/tjerkw/Android-SlideExpandableListView/blob/master/library/src/com/tjerkw/slideexpandable/library/SlideExpandableListView.java](https://github.com/tjerkw/Android-SlideExpandableListView/blob/master/library/src/com/tjerkw/slideexpandable/library/SlideExpandableListView.java)

# linq - 如何以我自己的方式扩展 LINQ 选择方法

> ID：14882176
> 
> 赞同：2
> 
> 时间：2013-02-14T19:06:00.957
> 
> 标签：linq

如果源不为空，则以下语句可以正常工作：

```
Filters.Selection
            .Select(o => new GetInputItem() { ItemID = o.ItemId }) 
```

如果“Filters.Selection”为空（显然），它会爆炸。是否有任何可能的方法来编写我自己的扩展方法，如果源为 null，则返回 null，或者如果源不为 null，则执行“Select”函数。

说，类似于以下内容：

```
var s = Filters.Selection
                .MyOwnSelect(o => new GetInputItem() { ItemID = o.ItemId }) 
```

如果“Filters.Selection”为空，“s”将为空，否则，“s”将包含使用 LINQ Select 评估的“func”。

这只是为了了解有关 LINQ 扩展/自定义的更多信息。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:10:33.680

你可以这样做：

```
public static IEnumerable<U> SelectOrNull<T,U>(this IEnumerable<T> seq, Func<T,U> map)
{
    if (seq == null)
         return Enumerable.Empty<U>(); // Or return null, though this will play nicely with other operations
    return seq.Select(map);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:10:07.943

假设您正在谈论 LINQ to Objects，绝对：

```
public static class NullSafeLinq
{
    public static IEnumerable<TResult> NullSafeSelect<TSource, TResult>
        (this IEnumerable<TSource> source, Func<TSource, TResult> selector)
    {
        // We don't intend to be safe against null projections...
        if (selector == null)
        {
            throw new ArgumentNullException("selector");
        }
        return source == null ? null : source.Select(selector);
    }
} 
```

您可能还想阅读我的[Edulinq 博客文章系列](http://msmvps.com/blogs/jon_skeet/archive/tags/Edulinq/default.aspx)，以了解有关 LINQ to Objects 工作原理的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:10:08.400

是的，看看框架中的 Enumerable 和 Queryable 类，它们实现了标准的查询运算符。

您需要使用与相同签名匹配的相同 Select 扩展方法来实现类似的类，然后如果源为 null 提前退出，则应返回一个空序列。

# regex - 如何在 Solr 4 中使用正则表达式进行查询

> ID：14882188
> 
> 赞同：9
> 
> 时间：2013-02-14T19:07:08.060
> 
> 标签：regex, solr

我已经到了绝望的地步，所以我正在寻求帮助。我正在尝试使用正则表达式从 Solr 4 引擎查询结果。

假设我要查询的文档是：

```
<str name="text">description: best company; name: roca mola</str> 
```

我想使用这个正则表达式进行查询：

```
description:(.*)?company(.*)?; 
```

[我在一些论坛上](http://lucene.472066.n3.nabble.com/Solr-Use-Regex-in-the-Query-Phrase-td4015335.html)读到，在 Solr 4 中使用正则表达式就像添加斜杠一样简单，例如：

```
localhost:8080/solr/q=text:/description\:(.*)?company(.*)?;/ 
```

但它不起作用。而这个也不起作用：

```
localhost:8080/solr/q=text:/description(.*)?company(.*)?;/ 
```

我不想要一个简单的查询，例如：

```
localhost:8080/solr/q=text:*company* 
```

因为这会与以下文件不匹配：

```
<str name="text">description: my home; name: mother company"</str> 
```

如果我不清楚，请告诉我。

来自智利的欢呼：D

**注意**：我`text_general`在我的方案中使用了字段。正如@arun 指出的那样，`string`字段可以处理我正在使用的正则表达式的类型。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-16T02:17:25.647

不要在字段类型上尝试正则表达式搜索，而是在`text`字段类型上尝试它`string`，因为您的正则表达式跨越多个单词。（如果您的正则表达式需要匹配一个单词，那么您可以使用一个`text`字段。）

还要对特殊字符进行[百分比编码](https://en.wikipedia.org/wiki/Percent-encoding)，以确保它们不是不匹配的原因。

```
q=strfield:/description%3A(.*?)company(.*?)%3B.*/ 
```

**更新：** 刚刚在字符串字段上尝试过。上面的正则表达式有效。即使没有百分比编码，它也可以工作，即

```
q=strfield:/description:.*?company.*?;.*/ 
```

# domain-driven-design - 我仍然对领域事件感到困惑的事情

> ID：14882190
> 
> 赞同：0
> 
> 时间：2013-02-14T19:07:20.800
> 
> 标签：domain-driven-design

a) 假设我们不使用 IoC，应该在哪里注册*处理程序*？在*应用层*？

b）也许是一个无用的问题，但这是*处理程序的* `Handle`方法将*域事件*作为*参数*的设计的部分原因，因为这样我们明确说明正在处理哪个*域事件，并且如果**参数*被表达，它也使代码更容易理解就*领域模型*而言？

c)[从](http://www.udidahan.com/2009/06/14/domain-events-salvation/)

> 领域事件是一个角色，因此应该明确表示

作者所说的“*领域事件是一个角色*”是什么意思？

谢谢

更新：

一个）

> 在 IoC 术语中，with 将是您的应用程序的组合根。

我不太明白你在这里要传达什么？！

b)

> 是的，虽然我不完全理解你的问题。什么是替代方案？

我并不是暗示 Udi 提出的设计可以替代传递*事件*作为*参数*，我只是好奇这种设计是否也带来了我在**b)中提到的好处**

C）

> 角色的概念基于单个对象可以根据上下文扮演多个角色的想法。

我没有读过第 16 章和第 17 章（埃文斯的书），因为我怀疑我是否会很快参与大型项目，但据我所知，埃文斯的书并没有涵盖这个主题（我并不是暗示这是不是重要的话题，我只是好奇我是否设法忽略了这个话题）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:22:55.867

a) 处理程序应该在注册其他依赖项（例如存储库）的相同位置注册。在 IoC 术语中，with 将是您的应用程序的组合根。

b）是的，虽然我不完全理解你的问题。什么是替代方案？

c) 角色的概念基于单个对象可以根据上下文扮演多个角色的想法。看看作者的介绍：[使角色显式](http://www.infoq.com/presentations/Making-Roles-Explicit-Udi-Dahan)。

**更新**

a) 它基本上是指在您的应用程序中配置所有依赖项的位置。在一个简单的控制台应用程序中， with 将位于 Main 方法的开头附近。在 ASP.NET 应用程序中，它将在处理应用程序启动的方法中。看看[这个问题](https://stackoverflow.com/a/6277806/13855)。

b) 是的，IMO 它确实带来了这些好处，但再次注意处理程序类本身并不是有趣的部分，它也可以是一个 lambda。

c) 本书的这些部分涵盖了一些非常重要的 DDD 概念。事实上，Evans 本人对于没有将 DDD 的战略方面放在开头[也有些遗憾。](http://www.infoq.com/presentations/ddd-eric-evans)[查看实现领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321834577)系列中的新书。

然而，就角色而言，我认为 Evans 并没有在书中明确涵盖它。它与 DDD 的关系不如与 OOP 的关系那么大。

# objective-c - 在 Quartz 中移动矩形

> ID：14882191
> 
> 赞同：1
> 
> 时间：2013-02-14T19:07:22.400
> 
> 标签：objective-c, xcode4.5, quartz-2d

我正在尝试学习石英的基础知识，但不明白为什么这不起作用-当按下按钮时，这应该将红色矩形向右移动，在瞬间击球，它什么也没做-“NSLog（A "help"); 是试图弄清楚按钮是否正常工作 - 谢谢

```
@implementation QuartzView

-(IBAction)moveRight:(id)sender{

    NSLog(@"Help");

    lR += 50;

}

- (id)initWithFrame:(NSRect)frameRect
{
    self = [super initWithFrame:frameRect];
    if (self) {

    }

    return self;
}

- (void)drawRect:(NSRect)dirtyRect
{
    CGContextRef myContext = [[NSGraphicsContext // 1
                               currentContext] graphicsPort];

    // Drawing code here.
    CGContextSetRGBFillColor (myContext, 1, 0, 0, 1);// 3
    CGContextFillRect (myContext, CGRectMake (lR, 0, 200, 100 ));

    [self setNeedsDisplay:YES];
}

@end 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:57:43.123

您不想在 drawRect 中调用 setNeedsDisplay；这只是说，“既然我已经画好了视图，让我再做一次！”

您想在您的操作中调用 setNeedsDisplay，以便在移动矩形后更新屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:12:56.640

在增加 lR 后尝试`[self setNeedsDisplay]`在 moveRight 内。

# git - 了解合并摘要统计信息，需要澄清

> ID：14882193
> 
> 赞同：2
> 
> 时间：2013-02-14T19:07:25.153
> 
> 标签：git

一旦我在分支之间合并了我的代码，我得到了以下摘要统计行：

```
 97 files changed, 5053 insertions(+), 5814 deletions(-) 
```

理解这一点最准确的方法是什么？这包括空行吗？如果是这样，是否可以获得不包括它们的统计信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:21:30.680

是的，插入和删除确实包括空行。

您可以通过以下方式影响这些计数：

*   添加新行（这会增加插入次数）
*   删除一行（这会增加删除次数）
*   更改一行（这会增加删除和插入计数）

分解消息，内容如下：

`97 files changed`: 修改了97个文件。

`5053 insertions(+)`：添加（或修改）5053行。

`5814 deletions(-)`: 删除（或修改）了 5814 行。

# sql - 从 SQL 查询中排除结果

> ID：14882197
> 
> 赞同：0
> 
> 时间：2013-02-14T19:07:44.023
> 
> 标签：sql

是否有使用 SQL 的 BLOCK 或 PREVENT 命令？我想阻止或阻止特定产品类别出现在我网站上的搜索结果中，而不完全删除该类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:08:50.313

使用`WHERE`从句。

```
SELECT {Select_List}
FROM {Table}
WHERE Category <> {Your Category} 
```

# .net - 在 Web 服务中为 Exchange 运行 Powershell 脚本

> ID：14882198
> 
> 赞同：0
> 
> 时间：2013-02-14T19:07:59.797
> 
> 标签：.net, web-services, powershell, pssnapin

我正在尝试在 Web 服务中为 Microsoft Exchange 运行一些 Powershell 脚本。下面编写的代码在从控制台应用程序运行时可以正常工作，但是当我将其移动到 Web 服务项目并调用 Web 方法时，它会在调用 AddPSSnapIn 时出错。知道为什么吗？我在 Windows Server 2008 R2 64 位机器上运行它。目标平台已从任何 CPU 更改为 x64，但没有任何运气。

```
 Dim rsConfig As RunspaceConfiguration = RunspaceConfiguration.Create()
    Dim snapInException As PSSnapInException = Nothing
    Dim info As PSSnapInInfo = rsConfig.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.E2010", snapInException)  <-- throws an error

    ' create Powershell runspace and open
    Dim MyRunSpace As Runspace = RunspaceFactory.CreateRunspace(rsConfig)
    MyRunSpace.Open()

    ERROR- System.Web.Services.Protocols.SoapException: System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.Management.Automation.PSArgumentException: No snap-ins have been registered for Windows PowerShell version 2." 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:56:46.833

问题是我的 Web 服务是在 Visual Studio 开发服务器上创建的，而不是本地（或其他）服务器，并且安全/权限必须更严格。在为我的 Web 服务项目选择属性并转到 Web 选项卡后，我选择了“使用本地 IIS Web 服务器”并创建了一个虚拟目录。在 IIS 管理器中，我为我的 Web 服务启用了 Windows 身份验证，这解决了问题！

# c# - 如何创建与将 null 传递给 Microsoft.DirectX.Direct3D.Font.DrawText() 的行为相匹配的托管 DirectX Sprite

> ID：14882199
> 
> 赞同：0
> 
> 时间：2013-02-14T19:08:01.127
> 
> 标签：c#, directx-9

我正在尝试提高经过良好测试的工作应用程序的 Directx 性能。使用配置文件工具，我已经确定调用 Microsoft.DirectX.Direct3D.Font.DrawText(Sprite sprite, string text, int x, int y, int color) 并为 sprite 参数传递 null 约占 30%应用程序的 CPU 使用率。当我创建一个精灵并将其传递给 DrawText 的所有调用时，CPU 使用率几乎消除了。唯一的问题是字体变得非常小并且以不清晰的方式旋转。

任何人都可以创建一个以与将 null 传递给 Microsoft.DirectX.Direct3D.Font.DrawText(Sprite sprite, string text, int x, int y, int color) 相同的方式呈现文本的精灵吗？我知道有一些方法可以使用 2D 文本而不是我所拥有的，但我宁愿避免对这个工作应用程序进行重大更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:31:22.140

您应该将绘图调用放在`Sprite.Begin()`和之间`Sprite.End()`。该`Begin()`调用将应用适当的渲染状态（例如转换）并且该`End()`调用恢复先前的状态。当然，你不应该在这个块中绘制精灵以外的任何东西。

# c# - 设置复选框并将结果保存到 SQL 的数组

> ID：14882200
> 
> 赞同：0
> 
> 时间：2013-02-14T19:08:10.837
> 
> 标签：c#, sql, arrays, winforms, checkbox

我正在继续我之前的问题，因为我从未得到完整的答复。[引用循环中创建的上一个对象以更新 SQL](https://stackoverflow.com/questions/14760263/reference-previous-object-created-in-loop-to-update-sql)

基本上，我已将语法更改为以下内容，但是它有两个问题：

1.  复选框实际上并没有出现。
2.  在 saveOrderBtn_Click 循环中，我收到错误消息“当前上下文中不存在名称‘myBoxes’”。这是在“if”语句行上。

我不能使用 Controls.Add(myCheckBox); 当您进行更新时，这会根据循环中创建的最后一个复选框更新 SQL 中的所有内容 - 它不计算每个复选框。

我还在学习 C#。非常感谢您。

更新代码：

```
public partial class SelectUsers : Form { 

// DECLARE THE myCheckBox
private CheckBox myCheckBox;

public SelectUsers()
{
    InitializeComponent();
}

private void SelectUsers_Load(object sender, EventArgs e)
{
    DataSet ds = myconnection.runSelect(new DataSet(), "THE SELECT");

    int xAxisCheckbox = 40;
    int yAxisCheckbox = 50;

    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        // CHANGED List<CheckBox> myBoxes LINE
        List<CheckBox> myBoxes = new List<CheckBox>();

        myCheckBox = new CheckBox();
        myCheckBox.Location = new Point(xAxisCheckbox, yAxisCheckbox);
        myCheckBox.Size = new Size(120, 20);
        myCheckBox.Text = ds.Tables[0].Rows[i]["FullName"].ToString();
        myCheckBox.Checked = (bool)ds.Tables[0].Rows[i]["InOperation"];
        yAxisCheckbox = yAxisCheckbox + 80;

        // THIS SHOULD ADD/RENDER EACH CHECKBOX, BUT IT DOESN'T
        myBoxes.Add(myCheckBox);
    }
}

private void saveBtn_Click(object sender, EventArgs e)
{
    DataSet ds = myconnection.runSelect(new DataSet(), "THE SELECT");

    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        userID = (int)ds.Tables[0].Rows[i]["UserID"];
        if (myBoxes[i].Checked)
        {
            myconnection.runUpdate("UPDATE Users SET InOperation = 1, OperationOrder = CASE WHEN OperationOrder = 1 THEN 1 ELSE CASE WHEN InOperation=1 THEN OperationOrder ELSE (SELECT COUNT(*)+1 FROM Users WHERE InOperation=1 AND OperationOrder > 0) END END WHERE UserID=" + userID);
            myconnection.runUpdate("UPDATE Users SET OperationOrder = CASE WHEN OperationOrder = 0 THEN (SELECT COUNT(*) FROM Users WHERE InOperation=1) ELSE OperationOrder END WHERE InOperation=1");
        }
        else
        {
            myconnection.runUpdate("UPDATE Users SET InOperation = 0, OperationOrder = 0 WHERE UserID=" + userID);
            myconnection.runUpdate("UPDATE Users SET OperationOrder = CASE WHEN OperationOrder -1 = 0 THEN (SELECT COUNT(*) FROM Users WHERE InOperation=1) ELSE OperationOrder -1 END WHERE InOperation=1");
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T17:16:50.723

看了编程书，发现你不是这样创建数组的，它是通过以下方式完成的：

```
// Global
CheckBox[] myCheckBox;
DataSet ds;

private void SelectUsers_Load(object sender, EventArgs e) {

    ds = myconnection.runSelect(new DataSet(), "THE SELECT");

    int xAxisCheckbox = 40;
    int yAxisCheckbox = 50;

    // Create the CheckBox array (amount based on number of rows)
    myBoxes = new CheckBox[ds.Tables[0].Rows.Count];

    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        // Create a new Checkbox
        myCheckBox[i] = new CheckBox();

        myCheckBox.Location = new Point(xAxisCheckbox, yAxisCheckbox);
        myCheckBox.Size = new Size(120, 20);
        myCheckBox.Text = ds.Tables[0].Rows[i]["FullName"].ToString();
        myCheckBox.Checked = (bool)ds.Tables[0].Rows[i]["InOperation"];
        yAxisCheckbox = yAxisCheckbox + 80;

        // Add the Checkbox
        Controls.Add(myCheckBox[i]);
    }
}

private void saveBtn_Click(object sender, EventArgs e) {
    for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
    {
        userID = (int)ds.Tables[0].Rows[i]["UserID"];

        if (myBoxes[i].Checked)
        {
            myconnection.runUpdate("UPDATE Users SET InOperation = 1, OperationOrder = CASE WHEN OperationOrder = 1 THEN 1 ELSE CASE WHEN InOperation=1 THEN OperationOrder ELSE (SELECT COUNT(*)+1 FROM Users WHERE InOperation=1 AND OperationOrder > 0) END END WHERE UserID=" + userID);
            myconnection.runUpdate("UPDATE Users SET OperationOrder = CASE WHEN OperationOrder = 0 THEN (SELECT COUNT(*) FROM Users WHERE InOperation=1) ELSE OperationOrder END WHERE InOperation=1");
        }
        else
        {
            myconnection.runUpdate("UPDATE Users SET InOperation = 0, OperationOrder = 0 WHERE UserID=" + userID);
            myconnection.runUpdate("UPDATE Users SET OperationOrder = CASE WHEN OperationOrder -1 = 0 THEN (SELECT COUNT(*) FROM Users WHERE InOperation=1) ELSE OperationOrder -1 END WHERE InOperation=1");
        }
    }
} 
```

# sql-server - 使用forxml多次选择同一个元素？

> ID：14882202
> 
> 赞同：0
> 
> 时间：2013-02-14T19:08:13.570
> 
> 标签：sql-server, xml, sql-server-2008, for-xml

[我在这里](http://blog.sqlauthority.com/2009/02/12/sql-server-simple-example-of-creating-xml-file-using-t-sql/)找到了一个使用`for xml`创建 xml的示例。

但就我而言，我需要创建具有多个相似元素的 xml。就像是：

```
<params>
  <param>value1</param>
  <param>value2</param>
</param> 
```

但是，如果我尝试以下查询：

```
SELECT (
  SELECT
'value1' AS [param],
'value2' AS [param]
FOR XML PATH('params')) 
```

我最终得到了`<params><param>value1value2</param></params>`我的结果。不是我想要的输出。

关于如何获得所需输出的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:14:51.127

```
-- An extra empty column in between
select
  'value1' AS [param],
  '',
  'value2' AS [param]
for xml path('params')

-- A derived table by using union all
select 'value1' union all
select 'value2'
for xml path('param'), root('params')

-- Subqueries in the field list
select
  (select 'value1' for xml path('param'), type),
  (select 'value2' for xml path('param'), type)
for xml path('params') 
```

# java - java，mockito - 我如何找出调用了哪些模拟？

> ID：14882203
> 
> 赞同：1
> 
> 时间：2013-02-14T19:08:14.373
> 
> 标签：java, mockito

我真的不在乎*什么时候*调用模拟 - 几乎，我正在将一堆模拟迁移到现实世界的代码中，因为集成测试中的模拟有时非常愚蠢。

无论如何，我在这里有一个充满模拟设置的巨大类 - 但我真正想要的是每次测试都找出使用了哪些模拟。

使用mockito，我是否可以在实际执行特定“何时”时将其“记录”或打印或其他内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:35:42.260

从 Mockito 1.9.0 开始，您可以使用[verboseLogging](http://docs.mockito.googlecode.com/hg/latest/org/mockito/MockSettings.html#verboseLogging%28%29)设置。

例如，这个：

```
@Test
public void testLogging() {
  final List<?> mockList = mock(List.class, withSettings().verboseLogging());
  when(mockList.size()).thenReturn(6);

  mockList.size();
} 
```

产生：

> ###### 在模拟/间谍上记录方法调用 #1 ######## list.size(); 调用：-> 在
> 
> soanswers.mockito.LogCalls.testLogging(LogCalls.java:35) 已返回："0" (java.lang.Integer)
> 
> ###### 在模拟/间谍上记录方法调用 #2 ######## 存根：-> 在
> 
> soanswers.mockito.LogCalls.testLogging(LogCalls.java:35) list.size(); 调用：-> 在 soanswers.mockito.LogCalls.testLogging(LogCalls.java:37) 已返回："6" (java.lang.Integer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:32:58.467

我在 mockito 网页上发现了一个问题，表明这是可能的： [http ://code.google.com/p/mockito/issues/detail?id=148](http://code.google.com/p/mockito/issues/detail?id=148)

> 嗨，我已经在以下分支准备了一个补丁。对于任何需要更改的内容，我将不胜感激。
> 
> [http://code.google.com/r/muratknecht-mockito-issue148/](http://code.google.com/r/muratknecht-mockito-issue148/)
> 
> API 已达成一致：
> 
> Foo foo = mock(Foo.class, withSettings().verboseLogging());
> 
> 和
> 
> Foo foo = mock(Foo.class, withSettings().callback(new RememberingListener()));
> 
> 前者将调用信息打印到标准输出。这里举个例子。当然，这只是一个提议。但是，位置信息（-> at ...）只是侦听器获得的信息，因此如果不公开 Location 及其字段就无法更改。
> 
> ###### 在模拟/间谍上记录方法调用 #3 ######## foo.giveMeSomeString("another string value"); -> 在
> 
> org.mockitousage.debugging.VerboseLoggingOfInvocationsOnMockTest.usage(VerboseLoggingOfInvocationsOnMockTest.java:154) 将返回：>some return value< (java.lang.String) 方法已被存根。-> 在 org.mockitousage.debugging.VerboseLoggingOfInvocationsOnMockTest.usage（VerboseLoggingOfInvocationsOnMockTest.java:149）
> 
> #
> 
> 使用级别测试是 InvocationListenerCallbackTest 和 VerboseLoggingOfInvocationsOnMockTest。你可能想仔细看看后者（见课堂评论）。与对标准输出流的内容进行断言的使用级别测试一样，它变得有点混乱。

我在我的一项测试中进行了尝试，它似乎可以满足您的要求。您应该使用如下所示的第一个示例：

```
Foo foo = mock(Foo.class, withSettings().verboseLogging()); 
```

# php - 从表单插入数据

> ID：14882205
> 
> 赞同：1
> 
> 时间：2013-02-14T19:08:19.177
> 
> 标签：php, javascript

我对 PHP 相当陌生，我正在阅读 Robin Nixon 的 Learning PHP, MySQL, JavaScript & CSS 2nd edition。我正在通过脚本将用户名和密码插入数据库。这本书说输入代码以从表单字段中插入数据。我试图这样做（在 /* */ 之间），但查询给了我错误。此外，当我省略查询时，也没有错误。* 当我输入查询时，在 / */*中的注释之后的 javascript 中会显示一个错误。*

```
<?php // adduser.php
require_once 'login.php';

$forename = $surname = $username = $password = $age = $email = "";

if (isset($_POST['forename']))
$forename = fix_string($_POST['forename']);
if (isset($_POST['surname']))
$surname = fix_string($_POST['surname']);
if (isset($_POST['username']))
$username = fix_string($_POST['username']);
if (isset($_POST['password']))
$password = fix_string($_POST['password']);
if (isset($_POST['email']))
$email = fix_string($_POST['email']);

$fail  = validate_forename($forename);
$fail .= validate_surname($surname);
$fail .= validate_username($username);
$fail .= validate_password($password);
$fail .= validate_age($age);
$fail .= validate_email($email);

echo "<html><head><title>An Example Form</title>";

if ($fail == "") {
echo "</head><body>Form data successfully validated: $forename,
    $surname, $username, $password, $age, $email.</body></html>";

/*      require_once 'login.php';
$db_server = mysqli_connect($db_hostname, $db_username, $db_password, 
            $db_database) or die('Error connecting to MySQL server.');

$forename = mysqli_real_escape_string(db_server, trim($_POST['forename']));
$surname = mysqli_real_escape_string(db_server, trim($_POST['surname']));
$username = mysqli_real_escape_string(db_server, trim($_POST['username']));
$password = mysqli_real_escape_string(db_server, trim($_POST['password']));
$email = mysqli_real_escape_string(db_server, trim($_POST['email'])); 

$query = "INSERT INTO users VALUES" . "('$forename', '$surname', ". 
        "'$username', '$password', '$email');
$result = mysqli_query($db_server, $query); ". 
    "or die('Error querying database.');

mysqli_close($db_database);   */    

exit;

}

echo <<<_END

<style>.signup { border: 1px solid #999999;
font: normal 14px helvetica; color:#444444; }</style>
<script type="text/javascript">
function validate(form)
{
fail  = validateForename(form.forename.value)
fail += validateSurname(form.surname.value)
fail += validateUsername(form.username.value)
fail += validatePassword(form.password.value)
fail += validateEmail(form.email.value)
if (fail == "") return true
else { alert(fail); return false }
}
</script></head><body>
<table class="signup" border="0" cellpadding="2"
cellspacing="5" bgcolor="#eeeeee">
<th colspan="2" align="center">Signup Form</th>

<tr><td colspan="2">Sorry, the following errors were found<br />
in your form: <p><font color=red size=1><i>$fail</i></font></p>
</td></tr>

<form method="post" action="adduser.php"
onSubmit="return validate(this)">
 <tr><td>Forename</td><td><input type="text" maxlength="32"
name="forename" value="$forename" /></td>
</tr><tr><td>Surname</td><td><input type="text" maxlength="32"
name="surname" value="$surname" /></td>
</tr><tr><td>Username</td><td><input type="text" maxlength="16"
name="username" value="$username" /></td>
</tr><tr><td>Password</td><td><input type="text" maxlength="12"
name="password" value="$password" /></td>
</tr><tr><td>Age</td><td><input type="text" maxlength="3"
name="age" value="$age" /></td>
</tr><tr><td>Email</td><td><input type="text" maxlength="64"
name="email" value="$email" /></td>
</tr><tr><td colspan="2" align="center">
<input type="submit" value="Signup" /></td>
</tr></form></table>

<script type="text/javascript">
function validateForename(field) {
if (field == "") return "No Forename was entered.\\n"
return ""
}

function validateSurname(field) {
if (field == "") return "No Surname was entered.\\n"
return ""
}

function validateUsername(field) {
if (field == "") return "No Username was entered.\\n"
else if (field.length < 5)
    return "Usernames must be at least 5 characters.\\n"
else if (/[^a-zA-Z0-9_-]/.test(field))
    return "Only letters, numbers, - and _ in usernames.\\n"
return ""
}

function validatePassword(field) {
if (field == "") return "No Password was entered.\\n"
else if (field.length < 6)
    return "Passwords must be at least 6 characters.\\n"
else if (! /[a-z]/.test(field) ||
         ! /[A-Z]/.test(field) ||
         ! /[0-9]/.test(field))
    return "Passwords require one each of a-z, A-Z and 0-9.\\n"
return ""
}

function validateAge(field) {
if (isNaN(field)) return "No Age was entered.\\n"
else if (field < 18 || field > 110)
    return "Age must be between 18 and 110.\\n"
return ""
}

function validateEmail(field) {
if (field == "") return "No Email was entered.\\n"
    else if (!((field.indexOf(".") > 0) &&
               (field.indexOf("@") > 0)) ||
               /[^a-zA-Z0-9.@_-]/.test(field))
    return "The Email address is invalid.\\n"
return ""
}
</script></body></html>
_END;

function validate_forename($field) {
if ($field == "") return "No Forename was entered<br />";
return "";
}

function validate_surname($field) {
if ($field == "") return "No Surname was entered<br />";
return "";
}

function validate_username($field) {
if ($field == "") return "No Username was entered<br />";
else if (strlen($field) < 5)
    return "Usernames must be at least 5 characters<br />";
else if (preg_match("/[^a-zA-Z0-9_-]/", $field))
    return "Only letters, numbers, - and _ in usernames<br />";
return "";      
}

function validate_password($field) {
if ($field == "") return "No Password was entered<br />";
else if (strlen($field) < 6)
    return "Passwords must be at least 6 characters<br />";
else if (!preg_match("/[a-z]/", $field) ||
         !preg_match("/[A-Z]/", $field) ||
         !preg_match("/[0-9]/", $field))
    return "Passwords require 1 each of a-z, A-Z and 0-9<br />";
return "";
}

function validate_email($field) {
if ($field == "") return "No Email was entered<br />";
    else if (!((strpos($field, ".") > 0) &&
               (strpos($field, "@") > 0)) ||
                preg_match("/[^a-zA-Z0-9.@_-]/", $field))
    return "The Email address is invalid<br />";
return "";
}

function fix_string($string) {
if (get_magic_quotes_gpc()) $string = stripslashes($string);
return htmlentities ($string);
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:13:11.507

`/*`并且`*/`是插入块注释的运算符，请尝试删除它们并运行脚本

另外，错误说明了什么？

**编辑：**

您收到的错误是由于您没有使用标签关闭 PHP 代码`?>`，这意味着服务器正在尝试将前面的 JavaScript 代码读取为 PHP 代码。

你仍然应该省略注释操作符`/**/`，因为它们会导致里面的代码不能被服务器执行。

# powershell - Powershell脚本更改文件中的字符

> ID：14882210
> 
> 赞同：0
> 
> 时间：2013-02-14T19:08:51.980
> 
> 标签：powershell

**免责声明**：我是一个完整的 powershell 菜鸟。

我有一个 powershell 脚本，用于将大量 SQL 脚本编译成一个脚本，以交付给另一个团队进行迁移。它工作得很好，将所有内容包装在事务中，如果出现任何错误，则将整个内容回滚，但我今天遇到了一个问题。

其中一个存储过程有几个列，名为

```
[FirstPart-SecondPart] 
```

但是当我将它们复制到新文件时，它们会更改为

```
[FirstPart?SecondPart] 
```

这是执行 concat 的行：

```
Get-ChildItem -path $inpath -recurse |
    ?{ ! $_.PSIsContainer } |
    ?{($_.name).contains(".sql")} | 
    Sort fullname | 
    %{ Out-File -filepath $outpath -inputobject ($commentWrapper + $newLine + "--  SCRIPT: " + $_.fullname + $newLine + $commentWrapper + $newLine + $newLine + 
    "PRINT N'Executing script " + $_.BaseName + "'" + $newLine + $scriptHeaderPt1 + $_.BaseName + $scriptHeaderPt2 + [System.IO.File]::ReadAllText($_.fullname) + 
    $newLine + "GO" + $newLine + $scriptFooter + $newLine ) -Append} 
```

这是整个脚本：

```
##SQLConcat.ps1##
 function Insert-Content {
    param ( [String]$Path )
    process {
        $( ,$_; Get-Content $Path -ea SilentlyContinue) | Out-File $Path
    }
 }

 $newLine =  "`r`n" 

 $inpath = [Environment]::CurrentDirectory=(Get-Location -PSProvider FileSystem).ProviderPath

 $outpath = $inpath + "\SQL_PACKAGE.sql"

 $commentWrapper = "-- ==========================================================================================  "

 ###################################
 $logTable = "IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[log_ScriptExecution]') AND type in (N'U'))" + $newLine + 
 "BEGIN" + $newLine + 
 "     PRINT N'Creating log_ScriptExecution table.'" + $newLine +
 "     SET ANSI_NULLS ON" + $newLine + 
 "     SET QUOTED_IDENTIFIER ON" + $newLine + 
 "     SET ANSI_PADDING ON" + $newLine + 
 "     CREATE TABLE [dbo].[log_ScriptExecution] (" + $newLine + 
 "     [id] int IDENTITY(1, 1) NOT NULL," + $newLine + 
 "     [script] varchar(100) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL," + $newLine + 
 "     [messages] varchar(MAX) COLLATE SQL_Latin1_General_CP1_CI_AS NULL," + $newLine + 
 "     [executionDate] datetime NOT NULL," + $newLine + 
 "     [executedBy] varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL," + $newLine + 
 "     PRIMARY KEY CLUSTERED ([id] )" + $newLine + 
 "     WITH ( PAD_INDEX = OFF," + $newLine + 
 "     FILLFACTOR = 100," + $newLine + 
 "     IGNORE_DUP_KEY = OFF," + $newLine + 
 "     STATISTICS_NORECOMPUTE = OFF," + $newLine + 
 "     ALLOW_ROW_LOCKS = ON," + $newLine + 
 "     ALLOW_PAGE_LOCKS = ON," + $newLine + 
 "     DATA_COMPRESSION = NONE )" + $newLine + 
 "     ON [PRIMARY]" + $newLine + 
 "     )" + $newLine + 
 "     ON [PRIMARY];" + $newLine + 
 "END" + $newLine +
 "GO" + $newLine

 ###################################
 $tmpErrors = "IF EXISTS(SELECT * FROM tempdb..sysobjects WHERE ID=OBJECT_ID('tempdb..#tmpErrors'))" + $newLine + 
 "     DROP TABLE #tmpErrors" + $newLine + "GO" + $newLine + "CREATE TABLE #tmpErrors (Error int)" + $newLine + "GO" + $newLine +
 "SET XACT_ABORT ON" + $newLine +
 "GO" + $newLine +
 "SET TRANSACTION ISOLATION LEVEL SERIALIZABLE" + $newLine + 
 "GO" + $newLine +
 "BEGIN TRANSACTION" + $newLine +
 "GO" + $newLine

 ###################################
 $scriptHeaderPt1 = "INSERT INTO log_ScriptExecution( script ,messages , executionDate ,executedBy)" + $newLine +
 "VALUES ( '"
 $scriptHeaderPt2 = "' ,'Executing Script' , GETDATE() ,SYSTEM_USER)"+ $newLine +
 "GO" + $newLine

 ###################################
 $scriptFooter = "IF @@ERROR<>0 AND @@TRANCOUNT>0" + $newLine + 
 "BEGIN" + $newLine + 
 "     ROLLBACK TRANSACTION" + $newLine + 
 "END" + $newLine +
 "GO" + $newLine + 
 "IF @@TRANCOUNT= 0 BEGIN INSERT INTO #tmpErrors(Error) SELECT 1 BEGIN TRANSACTION END" + $newLine + 
 "GO" + $newLine

 ###################################
 $fileFooter = "IF EXISTS (SELECT * FROM #tmpErrors) ROLLBACK TRANSACTION" + $newLine +
 "GO" + $newLine +
 "IF @@TRANCOUNT>0 BEGIN" + $newLine + 
 "     PRINT 'The database update succeeded.'" + $newLine +
 "     COMMIT TRANSACTION" + $newLine +
 "END" + $newLine +
 "ELSE PRINT 'The database update failed'" + $newline +
 "GO" + $newLine +
 "DROP TABLE #tmpErrors" + $newLine +
 "GO" + $newLine

 ###################################
 #
 #      Delete existing SQL_PACKAGE.sql file
 #
 ###################################
 Write-Output "Deleting existing file..."
 If(Test-Path $outpath)
 {
    Remove-Item $outpath
 } 

 ###################################
 #
 #      Prompt the user for the target DB
 #
 ###################################

 $dbname = Read-Host 'What is the target DB name?'

 ###################################
 #
 #      Compile the script(s)
 #
 ###################################
 Write-Output "Compiling script..."
 Get-ChildItem -path $inpath -recurse |
    ?{ ! $_.PSIsContainer } |
    ?{($_.name).contains(".sql")} | 
    Sort fullname | 
    %{ Out-File -filepath $outpath -inputobject ($commentWrapper + $newLine + "--  SCRIPT: " + $_.fullname + $newLine + $commentWrapper + $newLine + $newLine + 
    "PRINT N'Executing script " + $_.BaseName + "'" + $newLine + $scriptHeaderPt1 + $_.BaseName + $scriptHeaderPt2 + [System.IO.File]::ReadAllText($_.fullname) + 
    $newLine + "GO" + $newLine + $scriptFooter + $newLine ) -Append}

 ###################################
 #
 #      Get rid of any USE [...] statements
 #
 ###################################
 Write-Output "Removing USE statements..."
 (Get-Content $outpath) | Foreach-Object { $_ -replace 'USE \[(\w+)\]', ''} | Set-Content $outpath

 ###################################
 #
 #      Add the proper USE statement and Error table check to the beginning of the file
 #      and the file footer to the end of it
 #
 ###################################
 Write-Output "Updating file..."
 $useStatement = $newLine + "USE [" + $dbname + "]" + $newLine
 $useStatement + $newLine + $logTable + $tmpErrors  | Insert-Content $outpath 
 $fileFooter | Out-File $outpath -append
 Write-Output "Finished."
 ##SQLConcat.ps1## 
```

# ruby - 总是大写属性？

> ID：14882222
> 
> 赞同：0
> 
> 时间：2013-02-14T19:09:13.963
> 
> 标签：ruby, activemodel

我有以下课程：

```
class Message
  extend ActiveModel::Naming
  include ActiveModel::Conversion

  attr_accessor :name, :emails, :custom_content

  def initialize(attrs = {})
    attrs.each do |k, v|
      self.send "#{k}=", v
    end
  end

  def persisted?
    false
  end

  def email_list
    self.emails.split(",").collect { |email| {:email => email.delete(" ")} }
  end 
end 
```

当我在代码中调用属性时，我总是想将 name 属性大写，而不是总是这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:17:36.070

弄清楚了：

```
class Message
  extend ActiveModel::Naming
  include ActiveModel::Conversion

  attr_accessor :name, :emails, :custom_content

  def initialize(attrs = {})
    attrs.each do |k, v|
      self.send "#{k}=", v
    end
  end

  def persisted?
    false
  end

  #Fix is here
  def name=(s)
    @name = s.titleize
  end

  def email_list
    self.emails.split(",").collect { |email| {:email => email.delete(" ")} }
  end 
end 
```

# sql-server - 触发器的奇怪行为

> ID：14882228
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:09:45.930
> 
> 标签：sql-server, triggers, ssis

我有一个触发器（SQL 2008 R2），它执行一个简单的操作，但结果不合逻辑。这是概述：

一个文本文件被馈送到一个带有一行（一条记录）的 SSIS 包，将其加载到“ORDERS_IN_PROCESS”表中。数据访问模式在“OLE DB 目标”中设置为“表或视图”以允许触发触发器。

这是我的 ORDERS 表：

```
OrderID        ItemNo
---------    ---------
9813           1
9813           2
9813           3
9817           1 
```

因此，SSIS 执行并且 ORDERS_IN_PROCESS 插入了一条记录，即 OrderID 9813

触发器被触发：

```
INSERT INTO ORDERS_ARCHIVE SELECT * FROM ORDERS WHERE OrderID=INSERTED.OrderID 
```

到目前为止很简单...

我在 ORDERS_ARCHIVE（与 ORDERS 的布局相同）表中得到的结果是

```
OrderId       ItemNo
---------   ----------
9813          3 
```

2 个订单项的其余部分在哪里？

注意，它只将从 ORDERS 表中读取的最后一行插入到 ORDERS_ARCHIVE 中。

我需要 ORDERS_ARCHIVE 中的所有 3 个。

为什么会这样？

我相信这与 SSIS 使用“OLE DB Destination”处理它的方式有关，因为如果我手动将一条记录插入到 RLFL 中，触发器会完全按照它应该做的事情并从 BACK 插入所有 3 条记录。

您可能会争辩说，触发器每批次触发一次，我同意，但在这种情况下，我有一批只有一条记录。

我正在考虑一个 sp，但我不想为如此微不足道的事情增加另一个级别的复杂性，据说。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:14:43.627

我认为这根本与 SSIS 无关，而是与您的触发器有关。而不是`IN`你在那里，尝试`JOIN`在你的查询中使用 a ：

```
INSERT INTO ORDERS_ARCHIVE 
SELECT O.* 
FROM ORDERS O
INNER JOIN INSERTED I
     ON O.ORderID = I.OrderID 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T04:11:28.373

我同意拉马克，故意拼写错误，对你的触发器的评估是不正确的。

您为触发器提供的逻辑无法编译。WHERE 子句无效。我假设，正如 Lamak 所做的那样，您的意图是基于 OrderID 加入。

```
create table dbo.ORDERS_ARCHIVE
(
    OrderID int
,   ItemNo int
)
GO
create table dbo.ORDERS
(
    OrderID int
,   ItemNo int
)
GO
create trigger 
    trUpdate
ON
    dbo.ORDERS
    AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;
    -- This doesn't work
    -- Msg 4104, Level 16, State 1, Procedure trUpdate, Line 12
    -- The multi-part identifier "INSERTED.OrderID" could not be bound.
    --INSERT INTO dbo.ORDERS_ARCHIVE 
    --SELECT * 
    --FROM ORDERS 
    --WHERE OrderID=INSERTED.OrderID;

    -- I think you meant
    INSERT INTO dbo.ORDERS_ARCHIVE 
    SELECT * 
    FROM ORDERS 
    WHERE OrderID=(SELECT INSERTED.OrderID FROM INSERTED);
 END
 GO 
```

然后我创建了一个简单的 SSIS 包，我有一个数据源，它提供您指定的 4 行并写入`dbo.ORDERS.`我运行该包 2 次，每个都在 ORDERS_ARCHIVE 表中获得 4 行。每批 3 行 9813，1 行 9817。

我在那里得到了正确的行数，所以我相信触发器正在正确触发。相反，发生的事情是逻辑不正确。由于 OrderID 在 ORDERS 表中不是唯一的，因此数据库引擎将选择恰好满足搜索条件的第一行。碰巧它每次都选择同一行（ItemNo = 1），但是由于没有`ORDER BY`子句就不能保证顺序，这只是随机的或引擎如何选择的人工制品，但我不会依赖于保持一致的行为.

## 你如何解决这个问题？

修复触发器。仅在 OrderID 上加入插入的虚拟表会导致多行满足条件。

```
create trigger 
    trUpdate
ON
    dbo.ORDERS
    AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;
    -- This trigger will add all the rows from the ORDERS table
    -- that match what was just inserted based on OrderID and ItemNo
    INSERT INTO dbo.ORDERS_ARCHIVE 
    SELECT O.* 
    FROM dbo.ORDERS O
    INNER JOIN INSERTED I
         ON O.OrderID = I.OrderID
         AND O.ItemNo = I.ItemNo;
END 
```

现在，当我运行 ETL 时，我看到 ORDERS_ARCHIVE 中有 4 行具有正确的`ItemNo`值。

# unity3d - 夜间着色器效果 Unity

> ID：14882229
> 
> 赞同：0
> 
> 时间：2013-02-14T19:09:50.860
> 
> 标签：unity3d, shader, vuforia

我想要做的是，使用 vuforia 和增强现实应用程序，我想模糊整个场景以提供“夜间效果”（真实的相机纹理也必须模糊）。我一直在为一对夫妇尝试这个现在几天。

我搜索了它，只找到了夜视效果的帮助，这给了我如何解决这个问题的想法。我一直在尝试使用连接到相机的着色器。

我怎样才能用着色器做一个夜间效果（只是模糊整个场景，如果我可以只模糊想要的对象会更好）？

关于如何做到这一点的任何其他想法也会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:47:53.033

一个明显的方法是使用深色和浓雾。当然，把灯关掉。除此之外，您的查询有点模糊。但是试试雾。

# java - 我可能对文件执行哪些操作会导致 file.lastModified() 调用更改其值？

> ID：14882233
> 
> 赞同：0
> 
> 时间：2013-02-14T19:10:01.407
> 
> 标签：java, file

我想知道哪些类型的编程行为算作“修改”java 中的文件。也就是说，我可能对文件执行的哪些操作会导致 file.lastModified() 调用更改它的值？

IE 开放？阅读？写作？抄袭？写作是一个明显的触发因素，但其他的并不那么明显。我在网上做了一些环顾四周，并没有立即看到任何东西。

澄清：我不想设置最后修改时间，我只是想确定java程序可能参与的哪些编程行为会导致这个值更新。显然写入文件会做到这一点。但是还有其他情况会导致这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:03:59.747

读靠开，抄靠读。写入是设置 Last Modified 标记的唯一触发器。打开文件后，在大多数操作系统中，您需要指定要使用哪些模式打开文件。例如`rw`or `r`or or `w`or `a`(append) 等（依赖于实现/操作系统）。由于`a`包括`w`,`w`是唯一设置 Last Modified 标记的操作。

Java 类（例如`FileInputStream`）将打开指定`r`或“读取”的文件 - 这样就不会触发 LastModified 标记。Java 有不同的 Readers 和 Writers 类 - Input 和 Output。输入/阅读器类 ( `Reader`, `InputStream`) 不会设置 LastModified 标记。然而，一个简单的 Open-For-Write（没有实际写入）很可能也会触发 LastModified 标记，即：

```
new FileOutputStream( new File( "path/to/file.extension" ) ); 
```

很可能会触发 LastModified 集。

问候。

# mysql - MYSQL- 控制流函数

> ID：14882238
> 
> 赞同：1
> 
> 时间：2013-02-14T19:10:15.417
> 
> 标签：mysql

现在已经为此工作了几个小时，我想知道在 SQL 中是否有推荐的解决方案，或者我是否最好将它放在我的应用程序逻辑而不是数据库中。我更喜欢前者。

```
CREATE TABLE `rate_info` (
`id` int(11) NOT NULL AUTO_INCREMENT,
`city` varchar(100) DEFAULT NULL,
`rate_type` varchar(45) DEFAULT NULL,
`rate` int(11) DEFAULT NULL,
`vendor` varchar(45) DEFAULT NULL,
`product` varchar(45) DEFAULT NULL,
`days_to_pickup` int(11) DEFAULT NULL,
`timestamp` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
`state` varchar(45) DEFAULT NULL,
`country` varchar(45) DEFAULT NULL,
 PRIMARY KEY (`id`)
 ) ENGINE=InnoDB AUTO_INCREMENT=787 DEFAULT CHARSET=latin1$$ 
```

在给定城市、州和国家/地区的情况下，我需要对每种产品和供应商组合的平均费率进行最佳估计。每个供应商可以有不同数量的产品。此外，每个城市的供应商数量可能不同。逻辑必须是

1.  如果找到匹配项，则返回匹配城市、州和国家/地区的记录数据。
2.  如果未找到匹配项，请尝试根据州和国家/地区查找结果。
3.  如果这也没有返回任何内容，请仅根据国家/地区查找结果
4.  不得已，使用所有记录得出每个产品、供应商组合的平均费率
5.  其他列还有其他逻辑，但它们都遵循与位置相同的模式。

第一个查询将类似于

```
select avg(rate) rate, vendor, product from rate_info
where city = 'Boston'
and state = 'MA'
and country = 'United States'
and rate_type = 'REGULAR'
and days_to_pickup >= 4
group by vendor, product 
```

我一直在玩 COALESCE、CASE、IFNULL，但无法让查询正常工作。我可以在应用程序层做到这一点，但我必须多次调用数据库，因为第一种情况很可能不会得到满足。

理想的解决方案是

```
COALESCE(select_city_state_cntr, select_state_cntry, select_cntry); 
```

让我知道是否缺少某些内容，我会根据需要添加更多详细信息。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:40:15.827

这是一个可能的解决方案。查询所有三种方式，并使用 LIMIT 取第一个匹配的方式。

```
SELECT * FROM (
 (SELECT SUM(population) AS population, city, state, country
  FROM POPULATION
  WHERE (city, state, country) = (?, ?, ?))
 UNION ALL
 (SELECT SUM(population), NULL, state, country
  FROM POPULATION
  WHERE (state, country) = (?, ?))
 UNION ALL
 (SELECT SUM(population), NULL, NULL, country
  FROM POPULATION
  WHERE (country) = (?))) AS t
WHERE t.population IS NOT NULL
LIMIT 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:44:21.287

一种方法是：

```
CREATE TABLE `population` (
  `city` varchar(64) NOT NULL,
  `state` varchar(64) NOT NULL,
  `country` varchar(64) NOT NULL,
  `population` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

和一个选择查询：

```
SELECT city, state, country, population
  FROM population
 WHERE country = '<country>' AND state = '<state>' AND city = '<city>'
UNION
SELECT null, state, country, sum(population)
  FROM population
 WHERE country = '<country>' AND state = '<state>'
 GROUP BY state
UNION
SELECT null, null, country, sum(population)
  FROM population
 WHERE country = '<country>'
 LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:38:40.897

这应该会给你正确的结果（如果我的要求正确的话），虽然它效率不高，因为即使找到了执行城市，它也会计算所有选项：

```
SELECT 
  (city = 'Boston') * rate AS exactCityData, 
  SUM((city != 'Boston' AND state = 'MA') * rate) AS wholeStateData, 
  SUM((city != 'Boston' AND state != 'MA' AND country = 'United States') * rate) AS wholeCountryData
WHERE country = 'United States'
GROUP BY vendor, product; 
```

对于州平均值，您不能使用 AVG，因为查询匹配所有行（在国家/地区），因此查询应该是这样的：

```
SELECT 
  (city = 'Boston') * rate AS exactCityData, 
  SUM((state = 'MA') * rate) / SUM(state = 'MA') AS wholeStateData, 
  AVG(rate) AS wholeCountryData
WHERE country = 'United States'
GROUP BY vendor, product; 
```

现在对于第一个“最后的手段”选项，放弃国家要求，并将`AVG(rate) AS wholeCountryData`部分替换为`SUM((country = 'United States') * rate) / SUM(country = 'United States') AS wholeCountryData`

# c++ - 如何将指针与结构成员一起使用

> ID：14882243
> 
> 赞同：0
> 
> 时间：2013-02-14T19:10:22.567
> 
> 标签：c++, pointers, struct

上周在我的计算机科学课上，我们编写了一个程序，其中包含一个从文件中导入“卡片”的函数，如下所示：

```
 struct card
  {
  char rank[10];
  char suit[10];
  char color;
  bool dealt;
  char location[12];
  }; 
```

.

```
 void importCard(card deck[])
  {
  ifstream fin;
  fin.open("deck.txt");
  int index;  

  for(index=0;index<52;index++)
  {

  fin >> deck[index].rank;
  fin >> deck[index].suit;

  if(deck[index].suit[0]==('d')||deck[index].suit[0]==('h'))
     {
     deck[index].color='r';
     }
  else
     {
     deck[index].color='b';
     }

  deck[index].dealt=false;
  }
  } 
```

基本上，我在这个函数中大量使用点运算符。

现在，我的任务是修改它以使用指针代替所有方括号。但是，如果我使用类似的东西，它就不起作用

```
fin >> *deckPointer.suit; 
```

因为指针不适用于点运算符。那么，我该如何写这个来循环所有的卡片呢？我知道如何编写它来循环遍历一张卡片，但我不知道如何让它循环遍历所有卡片。另外，我不能使用任何其他更高级的工具，比如向量，所以不要建议这样做。此外，我只能使用 ++ 和 -- 来增加我的指针，而不是任何其他数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:12:46.640

指针*与*点运算符一起使用，它们的优先级是错误的。您可以添加一些括号来修复它：

```
 fin >> (*deckPointer).suit; 
```

`c++`语法中有一个方便的简写：`->`运算符，结合了指针取消引用和字段访问：

```
find >> deckPointer->suit; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:15:48.453

这里给你一个提示：

```
card* temp = &deck[index]; 
```

是相同的

```
card *temp = deck;
temp += index; 
```

然后您可以使用`->`来获取指向的值。由于这是家庭作业，我不想走得太远。

# jquery - 在 jquery 中隐藏和显示 div

> ID：14882249
> 
> 赞同：0
> 
> 时间：2013-02-14T19:10:43.327
> 
> 标签：jquery, html

我有一个菜单，当我单击一个选项卡时，我想隐藏查看器中当前显示的任何内容，并显示与我单击的选项卡相对应的内容（对于所有选项卡）。

```
<div id="main_view">
    <ul>
        <li id="tab_1">tab 1 </li>
        <li id="tab_2">tab 2 </li>
        <li id="tab_3">tab 3 </li>
    </ul>
    <div id="tab_1_content"> </div>
    <div id="tab_2_content"> </div>
    <div id="tab_3_content"> </div>
</div> 
```

但我不想做类似的事情，

```
//tab, 2 and 3 content starts as hidden:
$('#tab_2_content').hide();
$('#tab_3_content').hide();

$('#tab_2').click(function, () {
    $('#tab_2_content').show();
    $('#tab_1_content').hide();
    $('#tab_3_content').hide();
}); 
```

实现这一目标的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:13:43.143

我建议：

```
$('li[id^="tab_"]').click(function(){
    $('div[id^="tab_"]').hide();
    $('#' + this.id + '_content').show();
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/N7whh/1/)。

或者：

```
$('li').click(function(){
    $(this).closest('ul').nextAll('div').hide().eq($(this).index()).show();
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/N7whh/2/)。

参考：

*   [`click()`](http://api.jquery.com/click/).
*   [`eq()`](http://api.jquery.com/eq/).
*   [`hide()`](http://api.jquery.com/hide/).
*   [`index()`](http://api.jquery.com/index/).
*   [`nextAll()`](http://api.jquery.com/nextAll/).
*   [`closest()`](http://api.jquery.com/closest/).
*   [`show()`](http://api.jquery.com/show/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:15:18.480

给你的标签一个类

```
<div id="tab_1 tab"> 
```

然后你可以做 $("li.tab").hide() ，它会隐藏标签类的所有标签。然后：

```
$($(this).attr("id") + "_content").show(); 
```

反正你懂这个意思。只需填写空白即可。

# facebook - Facebook 文字是颠倒的

> ID：14882250
> 
> 赞同：-4
> 
> 时间：2013-02-14T19:10:38.560
> 
> 标签：facebook

我的 facebook 文字是颠倒的。我如何解决它？

[![设置页面截图](../Images/abc25296daf25b6d5b109a367476c36e.png)](https://i.stack.imgur.com/RGAj6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:14:18.993

你有没有让你的电脑在某个时候解锁？听起来有人将您的语言偏好更改为英语（颠倒）。转到设置>语言并选择常规英语进行修复。

# php - php头状态描述

> ID：14882251
> 
> 赞同：0
> 
> 时间：2013-02-14T19:10:46.557
> 
> 标签：php, curl, http-headers

只是为某事设置了一个超级简单的 API，但我有一个问题。我正在调用 api，它运行良好，但我想知道正在返回的标头状态代码。

对于所有错误，我想将错误设置为 500：

```
header('HTTP 1.1 500 invalid signature'); 
```

这是我很好奇的描述。有没有办法使用 CurL 获取该文本？我可以得到代码没问题，而不是文本。

或者有人可以推荐更简单的方法来抛出 500 状态，并将字符串传递回可以显示发生了什么错误的 api 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:20:31.927

如果我是你，我会使用其他一些自定义标头作为状态消息：

```
header('HTTP/1.1 500 Internal Server Error');
header('My-Super-Custom-Error-Msg: invalid signature'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:51:33.920

`CURLOPT_HEADER`当您设置选项时，cURL 返回完整的响应，包括标题。header 和 content 用两个 CRLF 隔开；标头本身使用 CRLF 分隔。这些信息应该足以让您从响应中解析状态标头：

```
$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, "http://localhost/err-500.php");
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$data = curl_exec($ch);

list($header, $body) = explode("\r\n\r\n", $data, 2);
$header = explode("\r\n", $header);

echo $header[0]; 
```

输出：

```
HTTP/1.1 500 Internal Server Error 
```

如果您有兴趣引发错误，您的脚本可以发出`500`响应状态以及带有一行代码的自定义标头：

或者您可以使用该[`header()`](http://www.php.net/manual/en/function.header.php)函数来设置响应代码：

```
header("X-Error-Message: Invalid Signature", true, 500); 
```

PHP 填充状态行的`1.1`和`Internal Server Error`部分：

```
HTTP/1.1 500 Internal Server Error
Content-Type: text/html
Server: Microsoft-IIS/7.5
X-Powered-By: PHP/5.3.19
X-Powered-By: ASP.NET
X-Error-Message: Invalid Signature
Date: Thu, 14 Feb 2013 21:11:00 GMT
Content-Length: 100 
```

# ada - GNAT 编程套件 - 未找到源文件

> ID：14882256
> 
> 赞同：0
> 
> 时间：2013-02-14T19:11:03.527
> 
> 标签：ada, gnat

Ada 对我来说还是个新手，所以我试图在 GPS IDE 中找到自己的方法。我之前问了另一个问题，但我认为这个问题优先于那个问题，并且可能是我问题的根源。

当我编译时，我得到一长串 *warning: source file ... not found"

在我的 .gpr 文件中，我列出了所有规范和正文源文件，并使用以下命名方案：

```
package Naming is
   for Casing               use "mixedcase";
   for Dot_Replacement      use ".";
   for Spec_Suffix ("ada")  use "_s.ada";
   for Body_Suffix ("ada")  use "_b.ada";
end Naming; 
```

奇怪的是，错误消息看起来都像这样：

```
warning: source file "xxx_b.adb" not found 
```

或这个

```
warning: source file "xxx.adb" not found 
```

请注意，这些（xxxb.adb 或 xxx.adb）都不符合文件规范，文件规范应以 .ada 结尾。

有人可以解释这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:48:25.640

我 99% 确定问题是我在回答您的另一个问题时提到的问题之一：*GNAT 通常不支持文件中的多个编译单元*。我得到了你用 GPS 和这些文件描述的行为：

james_s.ada:

```
with Jane;
package James is
end James; 
```

jim_s.ada:

```
package Jim is
end Jim;
package Jane is
end Jane; 
```

编译时的错误消息`james_s.ada`说它找不到`Jane_s.ada`，但是当我要求 GPS 去声明时，`Jane`它会把我带到`jim_s.ada`.

您可以使用`gnatchop`to split `jim_s.ada`，但它不理解项目文件或命名约定；您可能希望保留有效代码的现有名称，因此您可以`gnatchop`根据需要重命名 的输出。

然而！令我惊讶的是，事实证明 GNAT*确实*支持在一个文件中包含多个编译单元，项目文件中提供`package Naming`的项目文件告诉它文件中的每个单元：

```
package Naming is
   for Casing use "mixedcase";
   for Dot_Replacement use ".";
   for Spec_Suffix ("ada") use "_s.ada";
   for Body_Suffix ("ada") use "_b.ada";
   for Spec ("Jim") use "jim_s.ada" at 1;
   for Spec ("Jane") use "jim_s.ada" at 2;
end Naming; 
```

`gnatchop`无论是在多单元文件还是在整个源代码树上执行此操作还是硬着头皮使用 ，都取决于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T19:21:09.663

首先，这不是 Ada 问题，而是**Gnat**问题。其他 Ada 编译器对您使用的文件名没有问题。

然而，Gnat 的独特之处在于它希望每个源文件只有一个程序单元（包体、包规范、独立例程等）。这是因为它也是相当独特的，因为它希望能够仅通过知道该单元的 Ada 意向符就能够找到任何程序单元的源代码。大多数其他 Ada 编译器维护某种将文件名映射到程序单元的库文件，您必须将所有文件注册到其中。（而您的典型 C 编译器只是将查找所有代码文件的问题完全留给了用户）。

一般来说，使用 Gnat 最简单的方法是使用它的默认文件命名约定（当然不要将多个程序单元放在一个文件中），这种方法会给您带来最少的麻烦。

如果您已经有一些现有的 Ada 代码（可能是为另一个编译器开发的），将其导入 Gnat 的最简单方法通常是在其上运行[gnatchop](http://www.delorie.com/gnu/docs/gcc/gnat_ug_85.html)工具。所以这就是我建议你尝试的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T09:53:22.083

来自[GPRbuild 用户指南](http://docs.adacore.com/gprbuild-docs/html/gprbuild_ug.html)：

> 字符串用于属性值或这些属性的索引。它们通常区分大小写，除非另有说明 [...]

基于此，我相信您必须使用`"Ada"`而不是`"ada"`作为索引`Spec_Suffix`和`Body_Suffix`。我目前无法使用测试工具，所以我建议尝试一下。

# c# - 没有令牌的 C# facebook 帖子

> ID：14882258
> 
> 赞同：0
> 
> 时间：2013-02-14T19:11:06.587
> 
> 标签：c#, facebook-graph-api, facebook-c#-sdk

我正在开发一个 C# 桌面应用程序，我想让它使用 Facebook C# SDK 在 facebook 墙上发布一些东西。可以在未经许可的情况下在用户的墙上或页面上发布，还是必须使用令牌访问？如果是的话，有人可以给我一个例子吗？先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:14:51.687

不（当然）未经用户许可，不得在用户的墙上发帖。您需要`publish_stream`许可：[https ://developers.facebook.com/docs/reference/login/extended-permissions/](https://developers.facebook.com/docs/reference/login/extended-permissions/)

# jquery - 为什么此表单未在目标 iframe 内提交？

> ID：14882259
> 
> 赞同：1
> 
> 时间：2013-02-14T19:11:10.817
> 
> 标签：jquery, forms, iframe, upload

我创建了一个以 iframe 为目标的表单以提交图像。我以前绝对有这个工作，但现在整个页面都提交了，而不仅仅是 iframe。我完全不知所措。

HTML：

```
<form id="upload-form" name="upload-form" class="" action="/handle/upload" method="post" enctype="multipart/form-data">
    <div class="fileinput-wrap">
        <label for="fileinput">Image input</label>
        <input type="file" name="file" id="fileinput" />
     </div>
    <input type="submit" id="submitter" name="submitter" />
</form> 
```

JS：

```
$("#fileinput").on('change', function () {
    var $iframe = $("<iframe />").attr({
        id: 'frame_uploader',
        name: 'frame_uploader'
    });
    var $img = $("<img />");
    var imageUrl = "";
    $("#upload-form").prepend($img).append($iframe)
        .attr('target', 'frame_uploader')
        .trigger('submit');
    $iframe.load(function () {
        var imageUrl = $iframe.contents().find("body").text();
        $img.attr('src', imageUrl);
    });
}); 
```

[http://jsfiddle.net/NVp9K/](http://jsfiddle.net/NVp9K/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:33:37.547

我在某处读到某些 iframe 名称是保留的。更改 iframe 的名称已解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-21T15:44:10.530

也许您应该在创建框架时添加框架 ID 和名称属性。像这样：

```
var $iframe = $("<iframe id=\"frame_uploader\" name=\"frame_uploader\" />"); 
```

# jquery - 如何在按钮单击时重置 RadioButtonList？

> ID：14882262
> 
> 赞同：2
> 
> 时间：2013-02-14T19:11:31.333
> 
> 标签：jquery, asp.net, radiobuttonlist

我有一个 RadioButtonList 有两个选项：完整和部分。默认选择是完整的。

```
<asp:RadioButtonList ID="RadioButtonList1" runat="server">
    <asp:ListItem Selected="True">Full </asp:ListItem>
    <asp:ListItem>Partial</asp:ListItem>
</asp:RadioButtonList> 
```

![在此处输入图像描述](../Images/a7556835a86120178636a8bea3289525.png)

我还有一个 jquery 函数，它会在选择部分时导致某些元素隐藏，并在选择完整时重新出现。

```
$(document).ready(function () {
    $('#<%=RadioButtonList1.ClientID %>').change(function() {
        if($('#<%=RadioButtonList1.ClientID %> input:checked').val() == 'Partial') {
            $("#ddlLabel1").hide();
            $("#DropDownList1").hide();
        } else {
            $("#ddlLabel1").show();
            $("#DropDownList1").show();
        }
    });
}); 
```

![在此处输入图像描述](../Images/eb2166a81e144c5fe0a2d2bb78a8cb8b.png)

单击比较按钮时，这会导致隐藏的元素重新出现，但部分元素将保持选中状态。这是一个问题，因为选择部分时绝对不应显示这些隐藏的元素。 ![在此处输入图像描述](../Images/d1d9fb2106dbf08e2a068651aac0a6bd.png)

我的问题是：单击比较按钮时，如何将单选按钮列表的值重置为完整？我知道有，`RadioButtonList1.ClearSelection();`但我不想清除它，我想重置它。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:19:01.033

您可以将以下代码放在比较按钮单击事件中

```
 RadioButtonList1.SelectedIndex = 0;
 RadioButtonList1.SelectedValue = "Full"; 
```

# c++ - 对 unsigned char C++ 的无效分配

> ID：14882267
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:03.907
> 
> 标签：c++, compiler-errors

我写了以下内容，但由于某种原因调用 InstructionVal(b) 无效。智能感知正在吐出：

初始化器成员 NPPInstructionDef::InstructionVal 只允许 ()

这是有问题的代码：

```
//Single Instruction Definition for Instruction Dictionary
typedef struct NPPInstructionDef
{
    const char* InstructionName;
    const unsigned char* InstructionVal[];

     NPPInstructionDef(const char* a, const unsigned char* b[]): InstructionName(a), InstructionVal()
    {
    }
}NPPInstruction; 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:24:11.440

首先，我假设您的初始化是`InstructionVal( b )`，而不是`InstructionVal()`您编写的。但即便如此，你所写的也不应该编译。

这是常见的问题，因为 C 样式数组已损坏，不应使用。你的定义：

```
unsigned char const* InstructionVal[]; 
```

定义了一个长度未知的数组（因此，在类定义中是非法的）`unsigned char*`。`()`除了通过（值初始化）之外，没有办法在初始化列表中对其进行初始化。

你想要的是：

```
std::vector <unsigned char*> InstructionVal; 
```

，并且构造函数应该是：

```
NPPInstructionDef( std::string const& a,
                   std::vector <unsigned char> const& b ); 
```

，或者更有可能：

```
template <typedef Iterator>
NPPInstructionDef( std::string const& a,
                   Iterator begin,
                   Iterator end )
    : InstructionName( a )
    , InstructionDef( begin, end )
{
} 
```

（当然，这假设`InstructionName`是 `std::string`，而不是`char const*`。这将避免字符串的任何生命周期问题，例如，并允许轻松比较等）

# c++ - 非模板结构/类的模板成员函数 - 默认类型是什么？

> ID：14882270
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:18.873
> 
> 标签：c++

我见过这样的代码：

```
#include <iostream>

// member_function_templates.cpp
struct X
{
   template <class T> void mf(T* t) {
     std::cout << "in mf t is: " << *t << std::endl;
   }
};

int main()
{
   int i = 5;
   X* x = new X();
   x->mf(&i); //why can this be called without specifying a type as in: x->mf<int>(&i) ??
} 
```

我的问题在主要的评论中。为什么可以调用：

```
x->mf(&i); 
```

...没有指定类型？直觉说它应该被称为：

```
x->mf<int>(&i); 
```

...但显然不必像这样调用（无论哪种方式，上面都使用 gcc 4.7 编译 - 没有明确指定模板。）

而且，如果您在没有指定模板类型的情况下调用它，那么 T 的类型将是什么（在模板函数定义中）？（我猜它默认为你传递给函数 mf 作为参数的任何类型，但进一步解释它是如何工作的会很好）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:16:50.217

那是模板类型推导，它适用于所有模板函数，而不仅仅是非模板类的成员。基本上，编译器能够推断（遵循标准中的一组规则）类型`T`从参数到函数的含义。当编译器看到对 的调用时`mf(&i);`，它知道那`i`是 an `int`，因此参数是 an `int*`，这意味着您想要具有`T==int` ^((*)的重载)

如果您想强制模板的特定特化，您仍然可以提供一组特定的模板参数。例如，如果您希望模板的参数不是推导出的参数，而是可以从中转换的参数：

```
template<typename T>
void foo(T arg) {...}

int i = 10;
foo(i);             // calls foo<int>(i)
foo<double>(i);     // calls foo<double>(static_cast<double>(i)) 
```

^((*))它比这稍微复杂一些，因为可能有多种`T`类型的参数是有效的，但是语言中的规则决定了将推导出什么`T`特定*的*。在这种情况下，它是`int`。

# iphone - 使用 UIAppearance 调整 UIBarButtonItem 的大小（UIEdgeInsets）

> ID：14882273
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:25.617
> 
> 标签：iphone, ios, uibarbuttonitem, uiappearance, uiedgeinsets

我正在使用`UIAppearance`iOS 5 中的介绍为我的应用程序中的所有 BarButtonItems 设置自定义背景图像。

以下代码是我用来设置后退按钮的代码，它在纵向模式下工作正常。但是，当手机旋转到横向并调整导航栏的大小时，按钮根本不会调整大小并且在底部被切断。

我认为它会自动执行此操作，因为我将边缘插图设置为不关心垂直调整大小。有任何想法吗？

```
UIImage *colorViewBBIImage = [[UIImage imageNamed:@"backButton"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 17, 0, 7)]; 

[[UIBarButtonItem appearance] setBackButtonBackgroundImage:colorViewBBIImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

我的非视网膜图像是 30px x 31px。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:18:26.757

对于横向模式，只需使用最后一个参数 UIBarMetricsLandscapePhone 调用代码的第二行

```
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:colorViewBBIImage forState:UIControlStateNormal barMetrics:UIBarMetricsLandscapePhone]; 
```

# sql - Rails - 如何从仅限于最近记录的模型中获取随机抽样？

> ID：14882276
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:41.577
> 
> 标签：sql, ruby-on-rails, ruby, arrays, sorting

我有一个带有提要的社交媒体应用程序。对于主站点提要和其他各个部分，我想获取一大块最近的提要作为样本，然后按日期（created_at）排序显示它们。

```
Feeditem.find(:all, order: "created_at DESC", limit: 30) 
```

给我最近的 30 个 Feeditem。

```
Feeditem.all.sample(30) 
```

给我一个 30 个 Feeditems 的随机样本，但在所有 Feeditems 中（不仅仅是最近的；可能是任何时间的）。

如何从过去 100 条记录或过去 3 天中获取 30 条记录的随机样本；沿着这条线的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:15:04.743

尝试这个： `Feeditem.last(100).sample(30)`

# php - 谷歌地图 api 突然停止工作

> ID：14882282
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:50.717
> 
> 标签：php, google-maps

情况很奇怪......一切正常，突然googlemaps api停止工作

```
$('input#find_location_button').on('click', function () {

.... some script to get value of input field and store it in data_to_send.... 
data_to_send['sensor'] = 'false';

   //   alert(JSON.stringify(data_to_send));  this alert shows everything is fine

        $.ajax({
            url: 'http://maps.googleapis.com/maps/api/geocode/json',
            dataType: 'json',
            data: data_to_send,
            type: 'GET',
            success: function (data)
            { alert(data); // nothing ... 
.... proper closing tags ... 
```

我不知道为什么这个 ajax 请求突然停止工作......在 firbug 控制台中它什么也没显示......没有发布请求......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:30:37.540

也许这个[缺少 CORS HTTP Header](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4921)的问题解释了它停止工作的原因。

谷歌地理编码网络服务在 HTTP 标头响应中不包括 Access-Control-Allow-Origin:*，因此无法从 javascript 跨域访问服务。直到上周五，该标题才包括在内。

如果这是问题，请启动该问题。

# c# - 在运行时生成控件

> ID：14882283
> 
> 赞同：-6
> 
> 时间：2013-02-14T19:12:55.787
> 
> 标签：c#

如何在运行时生成控件并在那里设置属性，如高度、宽度、内容..

还有他们的事件，比如 Clicked 事件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:26:14.867

如果要在运行时在 C# 中生成控件

```
// generate button at runtime
Button btn = new Button();

// setting properties
btn.Height = 40;
btn.Width = 100;

// applying events
btn.Clicked += btn_clicked: 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-14T20:08:40.757

在这里，我可以在运行时程序上添加一个 TextBox。当我们的表单将被加载而不是文本框以及添加时。这个文本框名称是“正常的”，当我们四次按下选项卡时，选项卡也在工作。一项更重要的工作是当我们输入仅显示星值的文本时。就像那个密码等等。

```
private void Form1_Load(object sender, EventArgs e)
    {
        TextBox tx = new TextBox();
        tx.Name = "normal";
        tx.Height = 300;
        tx.Width = 300;
        tx.TabIndex = 4;
        tx.PasswordChar = '*';

    } 
```

# python - 这些 Python 表达式是否彼此等价？

> ID：14882285
> 
> 赞同：0
> 
> 时间：2013-02-14T19:12:56.197
> 
> 标签：python, ternary-operator, equivalent

给定以下 Python 函数（忽略其缺点）：

```
def adjust_year(year):
  return year > 2000 and year - 2000 or year - 1900 
```

如果我将其更改为：

```
def adjust_year(year):
  return year - 2000 if year > 2000 else year - 1900 
```

行为是等效的还是我以某种微妙的方式改变了它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:15:39.400

它们确实是等价的，但首选条件表达式变化。

您的表达式勉强避免了`and ... or`中间表达式计算为假值（`year >= 2000 and year - 2000 or year - 1900`并将`year = 2000`导致`100`）的典型陷阱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:18:54.857

有几种方法可以解决这个问题。一是对两个版本进行逻辑分析；另一种是使用蛮力并比较每个有效输入的结果：

```
def adjust_year_1(year):
  return year > 2000 and year - 2000 or year - 1900

def adjust_year_2(year):
  return year - 2000 if year > 2000 else year - 1900

for y in range(-4000, 4000):
  if adjust_year_1(y) != adjust_year_2(y):
    print y, adjust_year_1(y), adjust_year_2(y) 
```

这不会打印任何内容，表明这些函数在 -4000 和 4000 之间的年份确实是等效的（很容易看出它们对于超出此范围的输入也是等效的）。

# python - python django-tastypie 对象创建未正确返回数据

> ID：14882286
> 
> 赞同：1
> 
> 时间：2013-02-14T19:13:06.880
> 
> 标签：python, django, tastypie

我配置了一个简单的 API 和资源，连接到现有数据库（这就是我需要在模型上指定表名和列的原因）。我可以正常创建和列出对象。但是当我创建一个时，我永远无法正确获取 Location 标头，也无法返回创建的数据。

创建对象：

```
curl --dump-header - -H "Content-Type: application/json" -X POST --data '{"system_key": "test","system_nam": "test","system_url": "https://test/test"}' http://127.0.0.1:7000/api/system/?ticket=TGT-585-d9f9effb36697401dce5efd7fc5b3de4 
```

回复：

```
HTTP/1.0 201 CREATED
Date: Thu, 14 Feb 2013 18:58:17 GMT
Server: WSGIServer/0.1 Python/2.7.3
Vary: Accept
Content-Type: text/html; charset=utf-8
Location: http://127.0.0.1:7000/api/system/None/ 
```

注意 Location 标头。似乎对象已成功创建，但信息并未从数据库返回到 API，因此可以在响应中使用它。为了清楚起见，该行在 DB 表上是完美的。

如果我添加`always_return_data = True`我得到这个：

```
HTTP/1.0 400 BAD REQUEST
Date: Thu, 14 Feb 2013 19:00:32 GMT
Server: WSGIServer/0.1 Python/2.7.3
Content-Type: application/json

{"error": "The object '<system: MRMteste>' has an empty attribute 'system' and doesn't allow a default or null value."} 
```

我的资源和模型非常简单：

资源：

```
class SystemResource(ModelResource):    
    class Meta:        
        list_allowed_methods = ['get', 'post']
        detail_allowed_methods = ['get', 'put','patch']

        queryset = system.objects.all()
        resource_name = 'system'
        authorization = Authorization()
        authentication = customAuth.CustomAuthentication()

    def hydrate_system_timestamp(self, bundle):        
        bundle.data['system_timestamp'] = get_now_time()
        return bundle 
```

模型：

```
class system(models.Model):
    list_display = ('system_nam')
    system = models.IntegerField(primary_key=True, db_column="system_id")
    system_nam = models.CharField(max_length=50)
    system_key = models.CharField(max_length=255)
    system_url = models.CharField(max_length=100)
    is_deleted_flg = models.BooleanField()
    system_timestamp = models.DateTimeField(default=datetime.now)

    def __unicode__(self):
        return self.system_nam

    class Meta:
        db_table = "system" 
```

文档中没有关于此的内容。有更多经验的人可以告诉我模型和资源是否正确？截至目前，我正在使用最新版本的 sweetpie 和 django。

谢谢一堆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:53:25.567

您必须在资源的元类中设置：

```
always_return_data = True 
```

并尝试将您的唯一 id 字段使用默认名称 id 而不是服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T13:02:50.407

其实我已经解决了这个问题。

在模型上，如果您需要像我一样定义列名，请不要在主键上使用 IntegerField。像这样做：

```
system = models.AutoField(primary_key=True, db_column="system_id") 
```

sweetpie 处理新创建的对象的方式，它需要在模型上定义的自动增量，因此它知道最后创建的 ID。很好的发现，希望有一天它对某人有所帮助。

# c# - 使用哈希集 创建一个整数集

> ID：14882287
> 
> 赞同：4
> 
> 时间：2013-02-14T19:13:08.373
> 
> 标签：c#, int, set

我想创建一个使用`HashSet<int>`. 我希望它使用该内部容器跟踪集合中包含哪些值。到目前为止，我已经这样做了：

```
class SetInteger
{
    HashSet<int> intTest= new HashSet<int>();
    intTest.Add(1);
    intTest.Add(2);
    intTest.Add(3);
    intTest.Add(4);
    intTest.Add(5);
    intTest.Add(6);
    intTest.Add(7);
    intTest.Add(8);
    intTest.Add(9);
    intTest.Add(10);
} 
```

所以，在这里我想我正在向 中添加一些值`HashSet`，但我看不出它如何跟踪集合中包含的值。有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-14T19:14:51.657

哈希集有一个[`Contains`](https://docs.microsoft.com/nl-nl/dotnet/api/system.collections.generic.hashset-1.contains)方法可以让你检查一个值是否在集合中。

此外，它`HashSet<T>`实现了[`ISet<T>`](https://docs.microsoft.com/nl-nl/dotnet/api/system.collections.generic.iset-1)接口，因此提供了许多处理集合的方法，例如并集、交集以及确定一组值是否是集合的（正确的）超或子集。

```
HashSet<int> intTest = new HashSet<int>()
{ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };

bool has4 = intTest.Contains(4);    // Returns true
bool has11 = intTest.Contains(11);  // Returns false
bool result = intTest.IsSupersetOf(new []{ 4, 6, 7 }); // Returns true 
```

[顺便说一句，你知道[*集合初始化*](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/object-and-collection-initializers)语法吗？]

* * *

您还可以`foreach`在集合上获取它包含的每个元素（以未指定的顺序）：

```
foreach(int value in intTest)
{
    // Do something with value.
} 
```

或者将其转换为数组或可变列表（也以未指定的顺序）：

```
int[] arr = intTest.ToArray();
List<int> lst = intTest.ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:17:04.853

您可以使用 HashSet[`Contains`](http://msdn.microsoft.com/en-us/library/bb356440.aspx)方法来判断该值是否已经存在！

例子 ：

```
if (intTest.Contains(5))
{
    // already has the value
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:20:40.193

嗯......嗯，一个`HashSet<T>`implements `IEnumerable<T>`，所以你总是可以这样做来弄清楚“那里已经有什么”：

```
HashSet<int> intTest= new HashSet<int>();
intTest.Add(1);
intTest.Add(2);
intTest.Add(3);
intTest.Add(4);
intTest.Add(5);
intTest.Add(6);
intTest.Add(7);
intTest.Add(8);
intTest.Add(9);
intTest.Add(10);
var inThereNow = intTest.ToArray();  // [1,2,3,4,5,6,7,8,9,10] 
```

还有`bool Contains(T value)`一个会告诉你集合中是否有一个特定的值，`IEnumerable<T> Union(IEnumerable<T> other)`它会告诉你两个集合的“或”，`IEnumerable<T> Intersect(IEnumerable<T> other)`它会告诉你两个集合的重叠......几乎任何一个`IEnumerable<T>`或`ISet<T>`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-14T19:16:33.187

我们包含方法：http: [//msdn.microsoft.com/en-us/library/bb356440.aspx](http://msdn.microsoft.com/en-us/library/bb356440.aspx)

希望这可以帮助。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-02-14T19:49:41.787

你可以试试这个。你只需要一个文本框和两个按钮。

```
HashSet<int> hs = new HashSet<int>();
    private void savedataonhashSet_Click(object sender, EventArgs e)
    {

        hs.Add(Convert.ToInt16(textBox1.Text));
   }

    private void checkduplicatevalue_Click(object sender, EventArgs e)
    {
        if (hs.Contains(00))          

        {
            MessageBox.Show("it is");
        }
        else
        {
            MessageBox.Show("not there");
        }
    } 
```

如果您再次遇到问题，只需删除您的代码.....

# c - 当我遇到套接字代码时，我正在仔细阅读 glibc，有人可以解释发生了什么吗？

> ID：14882289
> 
> 赞同：9
> 
> 时间：2013-02-14T19:13:11.537
> 
> 标签：c, glibc

这是我正在浏览的源代码：[glibc source](http://sourceware.org/git/?p=glibc.git;a=tree;f=socket;h=8217353b094378659dae035c0619f6495172523c;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f)。我的特殊问题来自这组特殊的函数：[socket library](http://sourceware.org/git/?p=glibc.git;a=tree;f=socket;h=8217353b094378659dae035c0619f6495172523c;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f)。

例如（大部分功能都是这样设置的）`socket/bind.c`的来源是：

```
 19 #include <errno.h>
  20 #include <sys/socket.h>
  21 
  22 /* Give the socket FD the local address ADDR (which is LEN bytes long).  */
  23 int
  24 __bind (fd, addr, len)
  25      int fd;
  26      __CONST_SOCKADDR_ARG addr;
  27      socklen_t len;
  28 {
  29   __set_errno (ENOSYS);
  30   return -1;
  31 }
  32 
  33 weak_alias (__bind, bind)
  34 
  35 stub_warning (bind)
  36 #include <stub-tag.h> 
```

我承认我没有花很多时间，但是实际功能的代码到底在哪里，发生了什么？这是一个很好用的范例吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T19:36:40.033

该`__bind`函数是一个[存根](http://en.wikipedia.org/wiki/Method_stub)：它是一个在外部看起来像真实事物（相同原型）但不执行必要功能的函数。

该[`weak_alias`](http://sourceware.org/git/?p=glibc.git;a=blob;f=include/libc-symbols.h;h=252141eb0111269d721c501b1bcac0cd94c3305a;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f#l110)宏告诉链接器`bind`将成为`__bind`. 也就是说，这个定义`bind`是一个[弱符号](http://en.wikipedia.org/wiki/Weak_symbol)。如果没有其他定义称为 的符号`bind`，则此定义成立；如果存在另一个（非弱）定义，`bind`则该非弱定义存在并且弱定义被忽略。弱别名是一个弱符号，它是另一个符号的别名（而不是拥有自己的定义）。如果使用该弱别名，该[`stub_warning`](http://sourceware.org/git/?p=glibc.git;a=blob;f=include/libc-symbols.h;h=252141eb0111269d721c501b1bcac0cd94c3305a;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f#l280)宏会导致链接器发出警告。

的真正实现`bind`取决于编译 Glibc 的操作系统。在[Hurd](http://en.wikipedia.org/wiki/GNU_Hurd)上，它被定义在[`sysdeps/mach/hurd/bind.c`](http://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/mach/hurd/bind.c;h=a42b78ac07c7a72041f07650860567b6e9547a30;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f). 在 Linux 上，`bind`是一个系统调用：在 Glibc 源代码中没有 C 代码，只有汇编代码。`bind`提供，其中重用了in或[`sysdeps/unix/sysv/linux/bind.S`](http://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/unix/sysv/linux/bind.S;h=7719ad0be8bb6c2ad6c2722393b44f148a19de1c;hb=2543fef229599e8a6e4feeea65ca2dd3f984154f)的体系结构相关定义。这些定义都是底层系统调用的薄包装，注意将参数和返回值复制到适当的寄存器中。`socket``sysdeps/unix/sysv/linux/**/socket.S``ports/sysdeps/unix/sysv/linux/*/socket.S`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-14T19:19:22.360

您正在查看一般的 bind() 实现，它...只是告诉您 bind() 没有实现（它只是返回一个错误并将 errno 设置为 ENOSYS - 未实现系统调用。）。

glibc 中的许多依赖于平台的系统调用都以这种方式工作 - 有一个默认实现只返回一个错误，并且每个平台/架构师都必须提供系统调用的实现（如果存在）。

查看例如 ./sysdeps/unix/sysv/linux/i386/socket.S 以获得 linux x86 实现。

当然，socket() 只是一个系统调用，所以实际的实现是在内核中。Glibc 只是提供了一个 C 包装器来调用它。

# sql - 相同项目的计数以计算计数

> ID：14882291
> 
> 赞同：0
> 
> 时间：2013-02-14T19:13:21.863
> 
> 标签：sql

我在 SQL 中有问题。

现在我有项目表并且不会计算我销售的项目的数量，如果我像这样一次销售一件项目，我可以这样做：

```
 SELECT count(Quantity) AS ItemQ from item group by item_name 
```

但如果我购买相同的商品，我们必须在此处将销售与购买和计数等于 0

所以我们必须结果显示我有 2 个项目，但我使用 group by，我无法计算同一项目的计数。

我的完整查询：

```
SELECT count(billsItems_Quantity) AS ItemQ , billsItems_ItemDiscount  , billsItems_ItemName , billsItems_Price , billsItems_SecondPrice  , billsItems_ItemTotal ,bills_StoreID , bills_UserID , bills_ID , billsItems_BillItemSerial, cashier_trans_DocId , billsitems_ItemID , billsItems_Barcode
FROM bills , billsitems , cashier_trans 
WHERE 
bills.bills_ID = billsitems.billsItems_BillItemSerial
and bills.bills_ID = cashier_trans.cashier_trans_DocId
and bills.bills_StoreID = '$ausers_StoreId'
and bills.bills_UserID = '$ausers_ID'
and bills.bills_Status = '1' 
```

项目表是

```
id      item_name   bill_type  count_item   price_item

1        apple      sale         1             20

2        apple      buy          1             15

3        tea        sale         1             10

4       apple       sale         1             20 
```

现在苹果的数量必须向我显示**1**没有**3**

我怎么能在 SQL 中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:04:11.777

首先`COUNT`给出结果集中的行数。因此，要计算总量，您需要使用`SUM`聚合来代替。

现在要查找您的项目总数，您可以执行以下操作：

```
SELECT MIN(id), n.item_name, SUM(qty) AS `qty` FROM
(
SELECT MIN(id) AS id, item_name, SUM(count_item) AS `qty`
  FROM item 
 WHERE bill_type = 'sale'
 GROUP BY item_name
 UNION ALL
SELECT MIN(id) AS id, item_name, -SUM(count_item) AS `qty`
  FROM item 
 WHERE bill_type = 'buy'
 GROUP BY item_name
) n
GROUP BY item_name 
```

产生以下输出：

```
| ID | ITEM_NAME | QTY |
------------------------
|  1 |     apple |   1 |
|  3 |       tea |   1 | 
```

这是[sqlfiddle](http://sqlfiddle.com/#!2/9ed33/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:49:07.360

Count() 是聚合函数，你的桌子上有 3 个苹果。要只获得一个，您需要按 id 对数据进行分区 - 唯一 id 中只有 1 个苹果。您可能应该使用分析函数来执行此操作，因为我不清楚您在问什么。如果您在第一个查询中按 id 分组，您还应该在输出中得到 1：

```
SELECT count(Quantity) AS ItemQ from item group by id; 
```

# linux - 如何自动化一些 linux 命令

> ID：14882292
> 
> 赞同：4
> 
> 时间：2013-02-14T19:13:26.167
> 
> 标签：linux, ksh

我已经完成了很多 Windows 命令 shell 脚本，但我是 linux 的新手。有什么方法可以编写/自动化以下命令，以便我所要做的就是（在 Windows 术语中）“运行批处理文件”来完成这一切？这是我的步骤，按顺序：

*   启动腻子，选择主机名和端口，单击打开（也希望脚本/自动化这第一部分）
*   linux shell/终端打开
*   我输入我的登录名和密码
*   我输入这个命令：sudo su - psoftXXX
*   我再次输入我的密码并按 Enter
*   我看到了一个小 cmd-shell 菜单和一个提示。我必须输入“1”并回车
*   光盘 /
*   光盘日志
*   光盘小时
*   光盘DV
*   光盘应用程序
*   rm 珍*
*   ls

有什么方法可以自动化全部或部分吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T19:28:43.787

是的。一旦您了解了这一点，您就会发现与 Windows 相比，在 Linux 中编写脚本是一种*乐趣。*想象一下（可怕的）命令提示符和（不那么可怕的）PowerShell 之间的差异，然后将该差异乘以 10，这就是在 Linux 中编写脚本要好得多。

该术语是“shell 脚本”，因为命令处理器（相当于 Windows 命令提示符）称为“shell”。只是为了让生活更充实一点，Linux 有各种可用的 shell。最常见的是`sh`诸如`bash`和的变体`ash`。但是，一些疯狂的人使用`csh`or `tcsh`or others，它们的语法令人讨厌。

## 创建脚本

要创建一个“shell 脚本”，即一个批处理文件，只需在顶部创建一个文本文件：

```
#!/bin/bash 
```

（或者无论你的 shell 的名称是什么）。通常，文件名可能以`.sh`或根本没有特殊文件结尾。

在文件的其余行中，只需列出您想要运行的命令，就好像您在普通的 Linux 终端上输入它们一样。

然后为该文件分配“执行”权限。从命令行，您将使用`chmod u+x filename.sh`. 这意味着为当前用户添加执行权限。

当你开始学习你可以在 shell 中做的所有不同的事情时，真正的乐趣就来了。例如，有这样的巧妙技巧：

```
my-first-command && my-second-command   # only runs my-second-command if my-first-command succeeded 
```

或这个：

```
my-background-command &   # runs my-background-command in the background, so that you can get on with other things 
```

还有很多很棒的 Linux/UNIX 小程序可以很容易地将其他程序连接在一起——例如`grep`，`uniq`.`xargs`

## 你的具体例子

不过，在解释了这一切有多棒之后，我认为这实际上并不是您需要做的。

您的示例的 shell 脚本部分归结为：

```
rm /logs/hr/DV/appserv/JEN*; ls /logs/hr/DV/appserv 
```

我得到的印象是您想从 Windows 自动登录以运行这些命令。

我相信在 PuTTY 中，如果它通过 SSH 连接，您可以给它一个运行命令。所以这就是我要做的。

1.  使用 PuTTY 在您的 Windows 机器上生成 ssh 密钥。（我不记得如何做到这一点 - 我认为有 PuTTYGen 或类似的）。
2.  将生成的*公钥*复制到用户目录中调用的文件`authorized_keys`中。您可以从字面上复制和粘贴它；这可能比做任何花哨的事情要容易。请注意，此目录和/或文件可能不存在，在这种情况下，您需要创建它们；如果文件*已经*存在，请确保将新密钥附加到文件末尾而不是覆盖它。`.ssh``psoftXXX`
**   现在尝试使用 PuTTY 和 ssh 再次连接。它应该自动以`psoftXXX`用户身份登录。*   最后，在 PuTTY 设置中，您可能可以指定上面给出的命令行。您可能需要像这样指定它：

    /bin/bash -c "rm /logs/hr/DV/appserv/JEN*; ls /logs/hr/DV/appserv"* 

 *请注意，有一个阶段我没有自动化，即在菜单上按 1。那是因为我怀疑这个菜单是通过给你一个特殊的默认登录 shell 来实现的，它不是`/bin/bash`，而是相反`/something/somewhere/which/shows/a/menu`。我希望如果您在 PuTTY 中指定替代命令，该设置将被完全忽略，而您将运行您的脚本。

你可能需要玩一会儿。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:25:52.360

是的，您可以在 linux 中编写 shell 脚本。每个 shell 脚本都以

```
#!/bin/bash
<commands>
. 
.
. 
```

如果你想运行上面的命令，它看起来像这样

```
#!/bin/bash
cd /logs/hr/DV/appserv
rm JEN*
ls 
```

至于自动化可能有点棘手的第一部分，我认为`sudo su psoftXXX`如果您首先以 psoftxxx 身份登录，您可以删除整个...

希望对您有所帮助，这是一个很好的资源，可以帮助您开始编写 shell 脚本 [http://linuxcommand.org/writing_shell_scripts.php](http://linuxcommand.org/writing_shell_scripts.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-26T10:44:44.990

有一次，我在工作中遇到了类似的问题。我厌倦了不得不登录到 shell。我们的主系统受到保护的方式意味着它处于离线状态。为了登录，我们必须首先 ssh 到网络中的在线系统，然后从该机器 ssh 到主系统。这是这个过程的样子。

`1.) Launch putty using the profile set up for the first machine. I had already made the effort to set the login command to ssh into the next server. 2.) Enter my user password 3.) use su to log into root 4.) enter the root password 5.) use gradm on my user 6.) source my .bashrc`

不用说，这一切对我来说似乎毫无意义。在 Windows 上，我发现自动化 putty 的选项不是很好。Cygwin 来救援。设置它需要一些工作，但是一旦设置好，您将节省时间是完全值得的。

以下是我建议的用于终端/ssh 的应用程序：

Cygwin - [https://www.cygwin.com/](https://www.cygwin.com/)或 MobaXterm - [http://mobaxterm.mobatek.net/](http://mobaxterm.mobatek.net/)

我已经将此方法与 vanilla Cygwin（如果您想要一个选项卡式终端界面，可以与 Console2 一起使用）和 MobaXterm 一起使用，这确实使 Putty 看起来完全过时了。如果您要使用 Cygwin，请使用 apt-cyg 或 Cygwin 安装程序安装 expect 包。如果您打算尝试使用 MobaXterm，那么您需要从 MobaXterm 插件页面下载 tcl/expect 插件。

您可以使用 expect 库来自动化任何事情。如果您对 TCL 语言不满意，还有一个基于 Python 的版本。

这是一个指南 - [http://www.cotse.com/dlf/man/expect/bulletproof1.htm](http://www.cotse.com/dlf/man/expect/bulletproof1.htm) - 它应该可以帮助您开始学习期望。使用 expect 我可以编写整个工作区的脚本。在我的 Cygwin .bashrc 文件中，连接到远程机器并登录已简化为一个别名。

这是期望的主页 - [http://expect.sourceforge.net/](http://expect.sourceforge.net/)

有关此主题的其他详细信息、说明和提示将在未来的编辑中提供。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T13:13:44.283

让我们把它分成几个任务：

通过 SSH 连接到 .

首先避免在脚本中使用密码。而是使用公钥/私钥。生成一对：

```
$ ssh-keygen 
```

按照步骤，应该会生成两个文件（id_rsa，id_rsa.pub），id_rsa.pub 是公钥。

转到您要连接的服务器，以 psoftXXX 身份登录并在 $HOME/.ssh/authorized_keys 添加存储在 id_rsa.pub 中的公钥

现在您应该能够以 psoftXXX 用户身份连接到服务器，而无需输入密码：

```
$ ssh psoftXXX@<server> 
```

现在是另一个任务。通过 SSH 删除这些文件。

```
$ ssh psoftXXX@<server> rm -f /logs/hr/DV/appserv/JEN* 
```

这将以 psoftXXX 身份连接到服务器（服务器不会询问密码）并将执行“rm -f”。

如果我必须定期运行它，我会使用 cron。你应该检查一下。

顺便说一句...试试这个命令：

```
$ man <command>
$ man -k <keyword>
$ man man 
```*

# qt - 与 Visual Studio 2008 中的 GStreamer 相关

> ID：14882293
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:13:26.750
> 
> 标签：qt, cmake, gstreamer

我已经在 64bit win 商业版中安装了 cmake 2.8.1、QT 4.8.4 和 Visual Studio 2008 c++。在 cmake 中配置和生成后，尝试在 Visual Studio 中运行程序时出现以下错误：

*   无法打开包含文件：gst.h
*   无法打开包含文件：gst/gst.h
*   没有这样的文件或目录

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:48:58.250

您需要将 GStreamer 的包含目录添加到您的项目中 - 使用`include_directories()` 相应 CMakeLists.txt 中的命令

# java - 在 Java 中更改图像分辨率而不调整大小

> ID：14882301
> 
> 赞同：4
> 
> 时间：2013-02-14T19:14:01.133
> 
> 标签：java, jpeg, image-compression

我想压缩`jpeg`图像，即降低其分辨率，而不以任何方式调整其大小。有没有什么好的 Java 库可以帮助我做到这一点？SO中有很多类似的帖子，但其中大多数最终也会调整图像大小。

如果没有，我该如何以编程方式进行？比如说，对于 0.9 的参数，图像的分辨率将降低 0.1 倍......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T19:32:52.167

通常，“分辨率”是指尺寸。你的意思是JPEG质量吗？这是我能想到的在不调整大小的情况下压缩它的唯一方法。

如果是这样，您可以使用 Java2D ImageIO API。类似以下的东西会起作用（改编自此[页面](http://www.universalwebservices.net/web-programming-resources/java/adjust-jpeg-image-compression-quality-when-saving-images-in-java)）：

```
BufferedImage bufferedImage = ImageIO.read(...);

ImageWriter writer = (ImageWriter)ImageIO.getImageWritersByFormatName("jpeg").next();
ImageWriteParam iwp = writer.getDefaultWriteParam();
iwp.setCompressionMode(ImageWriteParam.MODE_EXPLICIT);
iwp.setCompressionQuality(...);

File file = new File(...);
FileImageOutputStream output = new FileImageOutputStream(file);
writer.setOutput(output);
IIOImage image = new IIOImage(bufferedImage, null, null);
writer.write(null, image, iwp);
writer.dispose(); 
```

不幸的是，我认为没有办法获得图像的现有 JPEG 质量，因此您必须为压缩质量使用一些固定值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:26:58.490

您可以通过使用`Java2D`API 并设置输出图像的压缩质量来做到这一点，这将降低图像质量和文件大小，但会保持原始图像的相同宽度和高度

```
 File imageFile = new File("original.jpg");
    File compressedImageFile = new File("compressed.jpg");

    InputStream is = new FileInputStream(imageFile);
    OutputStream os = new FileOutputStream(compressedImageFile);

    float quality = 0.7f; // Change this as needed

    BufferedImage image = ImageIO.read(is);

    // get all image writers for JPG format
    Iterator<ImageWriter> writers = ImageIO
            .getImageWritersByFormatName("jpg");

    if (!writers.hasNext())
        throw new IllegalStateException("No writers found");

    ImageWriter writer = (ImageWriter) writers.next();
    ImageOutputStream ios = ImageIO.createImageOutputStream(os);
    writer.setOutput(ios);

    // set compression quality
    ImageWriteParam param = writer.getDefaultWriteParam();

    param.setCompressionMode(ImageWriteParam.MODE_EXPLICIT);
    param.setCompressionQuality(quality);

    writer.write(null, new IIOImage(image, null, null), param);

    // clean resources e.g. close streams 
```

如果您想要更高级的东西，请查看[`imageJ`](http://rsbweb.nih.gov/ij/)[`Fiji][2]`它们是非常强大的 Java 图像处理库，具有易于使用的 API。

# algorithm - 二叉树属性 - 平衡

> ID：14882306
> 
> 赞同：1
> 
> 时间：2013-02-14T19:14:18.400
> 
> 标签：algorithm, binary-tree

我试图了解二叉树的属性。但我不确定一件事：

定义。一棵二叉树指出：

1.  如果对于每个节点，二叉树的左子树中的内部节点数和右子树中的内部节点数最多相差 1，则二叉树是平衡的。

2.  如果任何两个离开差异，则二叉树是平衡的。深度的最大为 1。

我问我这两个是否定义。是等价的，我的意思是Def。1 统计 Def。2 反之亦然？...对我来说似乎是的...但是谁能用示例准确地解释我这个属性的（非）等价性？

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T19:19:46.843

不，两者不等价。

```
 3
   / \
  2   7
 /   / \
1   5   8
   / \   \
  4   6   9 
```

是一棵满足属性 2 但不满足属性 1 的树。

然而，属性 1 意味着属性 2。

**命题：**在根据性质 1 与内部节点平衡的二叉树中`n`，所有叶子的深度为

*   `k`如果`n = 2^k - 1`
*   `k`或者`k+1`如果`2^k <= n < 2^(k+1)-1`, 并且 深处 有 叶子`k+1`.

**证明：（**通过对内部节点数的归纳）

对于`n = 1 = 2^1-1`，在深度 1 处有一片或两片叶子（根在深度 0 处）。

对于`n = 2`，一个子树有一个内部节点，该子树中的所有叶子都在深度 2 处，另一棵子树是空的或叶子在深度 1 处。

让我们考虑一棵根据属性 1 与内部节点`n >= 2`平衡的二叉树。`n+1`

如果`n`是偶数，`n = 2*m`则两个子树都必须有`m`内部节点，并且深度属性由归纳假设成立。

如果`n = 2*m+1`是奇数，则一个子树具有`m`内部节点，另一个具有内部节点`m+1`。

1.  如果`2^k <= m < 2^(k+1)-1`，则具有`m`内部节点的子树在深度 处有叶子，并且根据归纳假设`k+1`可能在深度处有叶子。`k`具有`m+1`内部节点的树在 depth 也有叶子，`k+1`并且可能（如果`m+1 < 2^(k+1)-1`）在 depth `k`。

2.  如果`m = 2^k - 1`，具有`m`内部节点的子树仅在深度处具有叶子`k`，而具有内部节点的子树`m+1`在深度处具有叶子，`k+1`并且可能在深度处具有叶子`k`。

# javascript - jQuery切换按钮不起作用.on（'click'）

> ID：14882308
> 
> 赞同：0
> 
> 时间：2013-02-14T19:14:19.130
> 
> 标签：javascript, jquery, toggleclass, togglebutton

这是我在这里找到的一个脚本，我将它从 .live 更改为 .on

我有一个附加了类登录的锚，注销将使用 jquery 打开一个表单，并将当前锚的文本和类更改为注销。

```
<li><a href="javascript:void(0)" class="login">Login</a></li> 
```

单击它时一切正常，一切都改变了，但是当我再次单击该锚点时，它不会激活注销功能。我知道它与 jquery 或 dom 需要刷新自己有关，但我不知道如何使它工作？

```
function onSignOutClicked() {
    // Convert the clicked button into a sign-in button
    $(this)
        .attr('class', 'login')
        .attr('title', 'Login')
        .text('Sign in');
}

function onSignInClicked() {
    // Convert the clicked button into a sign-out button
    $(this)
        .attr('class', 'logout')
        .attr('title', 'Logout')
        .text('Sign out');
}

$('.logout').on("click", onSignOutClicked);
$('.login').on("click", onSignInClicked); 
```

我还在下面写了我自己的，这是一种替代方法，但这里的问题是旧类在更改后仍在工作。

```
$(".sendLoginForm").click(function(){
    $("#loginErr").html("");
    $(".sendLoginForm").css({"color":"#ff3019"});
    $(".sendLoginForm").spin("small", "#FFF");                          
    $.ajax({  
        type: "POST",  
        url: "../_/login.php",  
        data: $("#loginForm").serialize(),  
        dataType: "json",  
        success: function(data){
            if (data.err){
                $("#loginErr").html(data.err);
            }else{
                //$(".openLoginForm").closest('li').remove();
                //$(".ulNavigator").append('<li><a href="javascript:void(0)" class="logout">Logout</a></li>');
                //$('.openLoginForm').toggleClass('.logout')
                //$(".openLoginForm").removeClass('.openLoginForm').addClass('logout');
                $(".openLoginForm").toggleClass('openLoginForm logout');
                $('.login').fadeOut("fast");
                $(".success").html(data.success);
                $('.success').fadeIn("fast");
                $('#loginForm')[0].reset();
                setTimeout(function() {
                      $('.success').fadeOut("fast");
                }, 3000);
                }
            $(".sendLoginForm").spin(false);
            $(".sendLoginForm").css({"color":"#FFF"});
        }                       
    });
    return false;
});

$(document).on("click", ".logout", function(){
    $.ajax({  
        type: "POST",  
        url: "../_/logout.php",  
        data: {logout : "kick"},  
        dataType: "json",  
        success: function(data){
            if (data.success){
                $(".success").html(data.success);
                $(".success").fadeIn("fast");
                setTimeout(function() {
                      $('.success').fadeOut("fast");
                }, 3000);
            }
        }                   
    }); 

}); 
```

任何有关以太方法的帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:28:19.877

更改元素的类不会更改绑定到它的事件。事件委托将更接近您想要的：

```
$(document).on('click','.logout',onSignOutClicked);
$(document).on('click','.login',onSignInClicked); 
```

此外，不要使用 .attr 更改元素的类，而应使用 .addClass()、.removeClass 和/或 .toggleClass。

```
$(this).addClass("logout").removeClass("login") 
```

考虑到这一点，您可以通过以下方式简化整个过程：

```
$(".login,.logout").on("click",function(){
    var $this = $(this);
    $this.toggleClass("login logout");
    if ( $this.is(".login") ) {
        $this.attr("title","Login");
    }
    else {
        $this.attr("title","Logout");
    }    
}); 
```

您可以通过以下方式使其更小：

```
$(".login,.logout").on("click",function(){
    var $this = $(this);
    $this.toggleClass("login logout");
    $this.attr("title", $this.is(".login") ? "Login" : "Logout");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:48:56.390

对于所有想看到我的结果的人，这是我想在 Kevin B 的帮助下做的一个工作示例。

谢谢你们

```
$(".login,.logout").on("click",function(){
    var $this = $(this);
    if ( $this.is(".login") ) {
        $(".loginFormBox").fadeIn("fast");      
    }
    else {
        $this.text("Login");
        $this.toggleClass("login logout");
        $.ajax({  
        type: "POST",  
        url: "../_/logout.php",  
        data: {logout : "kick"},  
        dataType: "json",  
        success: function(data){
            if (data.success){
                $(".success").html(data.success);
                $(".success").fadeIn("fast");
                setTimeout(function() {
                      $('.success').fadeOut("fast");
                }, 3000);
            }
        }                   
        }); 
    }    
});

$(".sendLoginForm").click(function(){
    $("#loginErr").html("");
    $(".sendLoginForm").css({"color":"#ff3019"});
    $(".sendLoginForm").spin("small", "#FFF");                          
    $.ajax({  
        type: "POST",  
        url: "../_/login.php",  
        data: $("#loginForm").serialize(),  
        dataType: "json",  
        success: function(data){
            if (data.err){
                $("#loginErr").html(data.err);
            }else{
                $(".login").toggleClass("login logout");
                $(".logout").text("Logout");
                $('.loginFormBox').fadeOut("fast");
                $(".success").html(data.success);
                $('.success').fadeIn("fast");
                $('#loginForm')[0].reset();
                setTimeout(function() {
                      $('.success').fadeOut("fast");
                }, 3000);
                }
            $(".sendLoginForm").spin(false);
            $(".sendLoginForm").css({"color":"#FFF"});
        }                       
    });
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:20:27.823

你应该做：

```
 function onSignOutClicked() {
        // Convert the clicked button into a sign-in button
        $(this)
            .attr('class', 'login')
            .attr('title', 'Login')
            .text('Sign in');
    }

    function onSignInClicked() {
        // Convert the clicked button into a sign-out button
        $(this)
            .attr('class', 'logout')
            .attr('title', 'Logout')
            .text('Sign out');
    }

    $('.logout').on("click", function(){ 
    onSignOutClicked();
    });
    $('.login').on("click", function(){ 
    onSignInClicked();
    }); 
```

# node.js - 如何使用 Node.js 和 express 实现文件下载功能，以便提示用户保存文件？

> ID：14882310
> 
> 赞同：3
> 
> 时间：2013-02-14T19:14:28.923
> 
> 标签：node.js, express

基本上我想要一个按钮，人们可以点击它来导出一些数据。目前，我已将此连接到一个 ajax 调用，该调用会命中我在服务器上的一些代码以获取数据。不幸的是，从未提示用户保存文件或任何内容，只是成功进行了调用。

如果我查看对 ajax 调用的响应，它有我想要导出的 JSON。这是我到目前为止提出的代码：

```
#exportData is just a function that gets data based off of a surveyId
@exportData req.body.surveyId, (data) ->
    res.attachment('export.json')
    res.end(JSON.stringify(data),'UTF-8') 
```

有什么建议可以提示用户保存文件，而不仅仅是悄悄地返回数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:32:18.810

我写了一个演示应用程序来玩这个：

**应用程序.js**：

```
var express = require('express')
  , http = require('http')
  , path = require('path')
  , fs = require('fs')

var app = express();

var data = JSON.parse(fs.readFileSync('hello.json'), 'utf8')

app.get('/hello.json', function(req, res) {
  res.attachment('hello.json')
  //following line is not necessary, just experimenting
  res.setHeader('Content-Type', 'application/octet-stream')
  res.end(JSON.stringify(data, null, 2), 'utf8')
})

http.createServer(app).listen(3000, function(){
  console.log('Listening...')
}); 
```

**你好.json**：

```
{
  "food": "pizza",
  "cost": "$10"
} 
```

仅使用 HTTP 标头，我相信这只是特定于浏览器的。本质上，正在发生的事情`res.attachment`是将`Content-Disposition`HTTP 服务器标头设置为`attachment`. 某些浏览器（例如 Firefox）会提示您“另存为”。Chrome 和 Safari 默认不支持。但是，您可以在 Chrome 或 Safari 的选项中更改此默认行为。我没有在 Internet Explorer 中进行测试。

我尝试更改`Content-Type`以查看是否会覆盖任何行为，但事实并非如此。

简而言之，您将无法覆盖用户的设置。

您可以在此处查看更多信息：[流式传输 PDF 附件时如何强制使用另存为对话框](https://stackoverflow.com/questions/9474553/how-to-force-a-save-as-dialog-when-streaming-a-pdf-attachment)

# ruby-on-rails - 基于外键数量的 ActiveRecord 范围

> ID：14882314
> 
> 赞同：0
> 
> 时间：2013-02-14T19:14:41.827
> 
> 标签：ruby-on-rails, ruby, rails-activerecord, arel

给出典型的例子：

```
class Post < ActiveRecord::Base
  has_many :comments
end

class Comments < ActiveRecord::Base
  belongs_to :post
end 
```

我想返回`ActiveRecord::Relation`所有评论为 X 或更少的帖子的范围（即）；如果可以解决我的问题，请使用[Active Record Query Interface](http://guides.rubyonrails.org/active_record_querying.html)、[Arel或其他方法。](https://github.com/rails/arel)

**伪代码：**

```
scope :quiet, lambda { |n| where(comments: { maximum: n }) } 
```

我知道这可以在 Ruby 中使用简单的`Enumerable#select`. 最好在数据库上计算，因为实际上只能有一个模型满足谓词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:33:33.737

这个范围呢：

```
scope :quiet, ->(n) { where("(SELECT COUNT(*) FROM comments WHERE post_id = `posts`.id) < ?", n) } 
```

它将在所有数据库端完成。它没有使用连接，因此您可以根据需要实际更新这些帖子记录

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:03:04.283

你可以做这样的事情..

```
Post.joins(:comments).group("posts.id HAVING count(comments.id) > 0") 
```

它不完全是，但它肯定会工作

# joomla - 来自 URL LINK 的自动填充表单

> ID：14882327
> 
> 赞同：2
> 
> 时间：2013-02-14T19:15:12.153
> 
> 标签：joomla, webforms, autofill

我有一个网站，我喜欢在其中创建指向该网站的链接，并使用我自己网站上的唯一 ID 自动填写网络表单。 [http://www.landelijkregisterkinderopvang.nl/pp/zoeken/RegistratienummerZoekScherm.jsf](http://www.landelijkregisterkinderopvang.nl/pp/zoeken/RegistratienummerZoekScherm.jsf)

所以我试过 [http://www.landelijkregisterkinderopvang.nl/pp/zoeken/RegistratienummerZoekScherm.jsf/submit?id=xxxxx](http://www.landelijkregisterkinderopvang.nl/pp/zoeken/RegistratienummerZoekScherm.jsf/submit?id=xxxxx)

是否可以发送 url 信息并直接显示来自站点的信息，

我尝试了几种组合，但都不起作用.....谁能帮忙？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:19:18.610

在 Joomla 中，您只需在构建表单时添加一些 php 代码即可从 url 获取值并将其放入输入框中。整个输入框看起来像这样：

```
<input type="text" name="field_name" value="<?php echo JRequest::getVar('id'); ?>" /> 
```

就一般 php 而言，您会希望从 $_GET 变量中获取值：

```
<input type="text" name="field_name" value="<?php echo $_GET['id']; ?>" /> 
```

额外需要注意 JRequest 在 Joomla 3 中已被弃用，因此您将切换到使用 JIput：[http ://docs.joomla.org/Retrieving_request_data_using_JInput](http://docs.joomla.org/Retrieving_request_data_using_JInput)

# powershell - PowerShell 导入模块与点源

> ID：14882332
> 
> 赞同：42
> 
> 时间：2013-02-14T19:15:28.167
> 
> 标签：powershell, import-module

如果我想将我的一些功能从我的主 PowerShell 脚本中分离出来，我可以将它写为一个`.ps1`文件和相同的点源，或者我可以将它创建为 a`.psm1`并使用`Import-Module`.

哪个更好，为什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-14T20:01:30.190

模块最适合库。它们使您可以更好地控制从模块导出的内容。也就是说，默认情况下，PSM1 文件中的所有脚本变量都是私有的 - 导入时在模块外部不可见。同样，所有功能都是公共的。但是，您可以在 PSM1 文件中使用 Export-ModuleMember 来准确控制从模块导出的变量、函数、别名、cmdlet 等。模块也可以从您的会话中删除，这是与 .PS1 脚本进行点源化的主要区别。另一个区别是模块函数由它们所在的模块命名，因此您可以通过在模块名称和函数名称前加上“\”前缀来轻松访问同名的基于模块的函数，例如 PSCX\Get-Uptime。在 ISE 中，此前缀还调用智能感知支持。

我通常建议使用模块。:-)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-14T19:22:13.113

Dotsourcing + 脚本和模块是两个不同的东西。模块非常适合收集/分组您​​将在脚本中使用的函数和 cmdlet。如果您有想要以交互方式使用的函数（您在控制台中调用函数），那么模块可能非常适合。

如果您有一个要运行的大脚本......比如说“迁移文件共享”，或者您使用任务计划程序定期调用的单个脚本，那么点源更容易。

这取决于你需要什么。概括：

*   如果您只是在这种情况下使用函数/脚本（脚本/作业）= 使用点源。
*   如果您也使用其他脚本中使用的常用函数/脚本，或者您想以交互方式调用某些函数等 = 使用模块。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-14T23:58:20.237

除了其他答案之外，还有一些模块功能。

*   在 PowerShell V3 中，无需调用`Import-Module`即可使用模块的导出命令。这在交互式使用命令时特别有用。PowerShell 以某种方式缓存并知道所有可用的模块命令，甚至它们的帮助`Get-Help SomeCommand`（但是，这对于模块帮助不是真的`Get-Help about_SomeModule`）。

*   点源函数和脚本模块函数的行为存在一些细微差别。将它们全部列出并不容易，这只是一个示例： [Powershell scriptblock variable scope and modules 的奇怪行为，有什么建议吗？](https://stackoverflow.com/questions/2193410/strange-behavior-with-powershell-scriptblock-variable-scope-and-modules-any-sug) 有时使用脚本模块会很痛苦，尤其是当一个人发现不想要的差异和问题太晚时，即简单的事情在开发开始时可以正常工作，但复杂的事情后来开始出错。

总而言之，通常我使用模块，除非它们不能很好地工作。其中之一是调用脚本模块函数中传递的用户脚本块。

# javascript - 在javascript中发布一个包含html标签的字符串

> ID：14882333
> 
> 赞同：2
> 
> 时间：2013-02-14T19:15:28.393
> 
> 标签：javascript, jquery, html

我想使用 ajax 将字符串发布到 html 文件。

```
xmlhttp=GetXmlHttpObject();
  if (xmlhttp==null)
  {
   alert ("Your browser does not support Ajax HTTP");
   return;
  }
    xmlhttp.onreadystatechange=getOutput;
    xmlhttp.open("GET",url,true);
    xmlhttp.send();
} 
```

在 url 中，我在另一个文件中发送了我想要的参数。它还包含一个带有这样的html标签的字符串

```
<table id='detReportTable' style='color:#333333;font-family:sans-serif;width:97%;margin-left:10px;'><tbody><tr><td colspan='2' style='text-align:center;'><div style='font-size: 19px;font-weight: bold;' id='score_cont'></div></td></tr></tbody></table> 
```

我将此字符串作为参数发送，但它没有获取此参数，其他没有 html 标记的参数将发送例如：`foo=sample`。它向我显示了一个错误。我可以发送这个 html 字符串或者我的方式是错误的，请提出任何想法。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:40:52.247

为什么不正常传递所有这些信息？为什么需要包含 html 标签？

您的代码因等于（=）而中断。您可以用〜替换所有等号，然后将传递完整的参数，在另一页上您可以通过将〜替换为=来修复它

例子：

> var 参数 = "< 表 id='........ >";
> 
> 而（参数.indexOf（'='）>=0）{
> 
> 参数 = parameters.replace('=','~');
> 
> }

你还需要更换#

# authentication - kohana 3.3 模型用户

> ID：14882336
> 
> 赞同：1
> 
> 时间：2013-02-14T19:15:41.410
> 
> 标签：authentication, model, kohana

我开始在我的应用程序项目中使用 Kohana 3.3。我创建了一个基本的 Account 控制器，其操作（登录/注销）可以完美地使用 ORM Auth 方法，而无需使用任何自定义模型。

```
public function action_login()
{
    if (Auth::instance()->logged_in())
    {
        $this->redirect('profile');
    }

    $this->template->content = View::factory('account/login')
        ->bind('message', $message)
        ->bind('errors', $errors);

    if (HTTP_Request::POST == $this->request->method()) 
    {   
        $user = ORM::factory('User')->login(
            $this->request->post('username'), 
            $this->request->post('password')
        );

        if ($user) 
        {
            $this->redirect('profile');
        } 
        else 
        {
            $message = 'Login failed';
        }
    }
} 
```

但是当我尝试添加非常基本的 Model_User（扩展 Model_Auth_User）时：

```
class Model_User extends Model_Auth_User {} 
```

我收到以下错误：

```
Call to undefined method Model_User::login() 
```

由于模型扩展了模块的核心类，他不应该也包含 login() 方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:55:33.593

你应该像这样`ORM::factory('User')`替换`Auth::instance()`

`$user = Auth::instance()->login($this->request->post('username'),$this->request->post('password'));`

# ruby-on-rails - Rails 4 assets.precompile

> ID：14882337
> 
> 赞同：12
> 
> 时间：2013-02-14T19:15:41.873
> 
> 标签：ruby-on-rails, asset-pipeline

这是这里的一个常见问题，但没有一个解决方案可以解决我的问题，所以这里是：

我正在将 ace.js 添加到我的 rails4 应用程序中，所以我所做的是

```
- Added vendor/assets/ace/ace.js
- Created vendor/assets/ace/index.js , with content
  //= require ace  
- Added the following to my production.rb
  config.assets.precompile += %w( index.js )  
  config.assets.paths << Rails.root.join("vendor", "assets", "ace") 
```

所以在我的布局文件中我有：

```
<%= javascript_include_tag "ace" %> 
```

它在开发上运行得很好，但是当我运行时：

```
RAILS_ENV=production bundle exec rake assets:precompile 
```

它不会创建 ace 文件的摘要版本。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-01T00:02:48.387

它通过添加解决：

```
config.assets.precompile += %w( index.js ) 
```

到`config/application.rb`. （不是`config/environments/production.rb`）

在 Rails 4.0 beta1 中测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T19:40:57.730

如果您将`ace`目录添加为资产，您应该将`js`文件放在`vendor/assets/ace/javascripts`目录下（您应该创建）。

通常你不需要`config.assets.precompile += %w( index.js )`，Sprockets 会很好地管理它。如果只需要从`vendors/assets/ace`目录中添加一个 js 文件，则不需要 index.js 。如果`index.js`您在`vendor/assets/ace/javascripts/your_vendor_js_library`. 最后一点：你不需要`<%= javascript_include_tag "ace" %>`，它重复`<%= javascript_include_tag "application" %>`的内容。

# matlab - movie2avi 帧大小错误并保持帧大小不变

> ID：14882344
> 
> 赞同：1
> 
> 时间：2013-02-14T19:16:07.487
> 
> 标签：matlab

我在使用 Matlab 的 movie2avi 函数时遇到问题；它不断给出错误：

```
Error using avifile/addframe>ValidateFrame (line 288)
Frame must be 266 by 343.

Error in avifile/addframe (line 158)
ValidateFrame(aviobj,width, height,dims);

Error in movie2avi (line 64)
avimov = addframe(avimov,mov); 
```

现在，据我所知，这是由于框架大小不一致造成的，所以我想我的问题是我应该如何在保持轴相等的同时定义框架的大小？我的代码是：

```
for i = 1:days+1
    plot3(npath(i,1),npath(i,2),npath(i,3),'yellow') %sun
    hold on
    plot3(npath(i,4),npath(i,5),npath(i,6),'blue') %mercury
    plot3(npath(i,7),npath(i,8),npath(i,9),'red') %venus
    plot3(npath(i,10),npath(i,11),npath(i,12),'blue') %earth
    plot3(npath(i,13),npath(i,14),npath(i,15),'red') %mars
    plot3(npath(i,16),npath(i,17),npath(i,18),'blue') %jupiter
    plot3(npath(i,19),npath(i,20),npath(i,21),'red') %saturn
    plot3(npath(i,22),npath(i,23),npath(i,24),'blue') %uranus
    plot3(npath(i,25),npath(i,26),npath(i,27),'red') %neptune
    plot3(npath(i,28),npath(i,29),npath(i,30),'blue') %pluto
    set(gca,'color','black')
    axis('equal')
    view(2)
    mov(i) = getframe();
end
hold off
movie2avi(mov,'movie.avi') 
```

这是我绘制太阳、行星和冥王星在可变天数范围内的 (x,y,z) 位置 npath 的代码的结尾。

如果这是一个愚蠢的问题，我也很抱歉，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:21:58.887

您可以添加`xlim` `ylim` `zlim`线以使用每个轴的全局最小值到最大值来固定轴。例如，在你`getframe`写之前：

```
xlim([-10 10]);
ylim([-10 10]);
zlim([-10 10]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-28T15:00:41.100

问题可能是动画期间轴的大小发生变化。您使用的`getframe()`命令相当于`getframe(gca)`，因此您会得到不同大小的帧。应该通过使用`getframe(gcf)`来解决问题。有关类似问题的详细信息，请参阅[movie2avi - 如何修复帧大小？](https://stackoverflow.com/questions/18949050/movie2avi-how-to-fix-the-frame-size).

# c# - 使用正则表达式在数据表中搜索“精确单词匹配”

> ID：14882345
> 
> 赞同：2
> 
> 时间：2013-02-14T19:16:13.003
> 
> 标签：c#, .net, regex, datatable

根据此链接[使用 SQL Server LIKE 模式搜索“全词匹配”](https://stackoverflow.com/questions/5444300/search-for-whole-word-match-with-sql-server-like-pattern)

我想遵循相同的查询字符串，但在数据表中我编写了以下语句

假设数据表包含以下记录

```
datatable[0]["src"]="tst";
datatable[1]["src"]="tst,";
datatable[2]["src"]="tst:";
datatable[3]["src"]="disney";

int p=datatable.AsEnumerable().Select(a => Regex.IsMatch(a["src"].ToString(), "[^a-z]windows[^a-z]")).Count(); 
```

但结果是 p = 4 而这个词 'windows' 只存在 3 次

如果使用“where”而不是“select”，如下所示

```
int p=datatable.AsEnumerable().Where(a => Regex.IsMatch(a["src"].ToString(), "[^a-z]windows[^a-z]")).Count(); 
```

p 始终为 0

我的陈述有什么问题..有什么建议吗？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:39:35.973

您的第一个示例 ( `Select`) 对数据表中的所有行运行该操作。结果将是一个布尔值列表，指示行值是否与表达式匹配。

在这两种情况下，您的模式都*需要*在单词“windows”之前和之后使用非字母，这导致它不匹配。在第一种情况下，您将获得一个包含 4 个“假”值的列表，而在第二种情况下，您将一无所获。

我相信获得你想要的最简单的正则表达式可能是这样的：

```
"\bwindows\b" 
```

（使用 Robert Harvey 建议的正则表达式。这种模式断言在单词之前和之后有一个“单词中断” - 不包括任何内容。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:40:11.943

`Select`并且`Where`不可互换 - 您的选择将为每条记录返回一个`true`或`false`值，这就是您的计数为 4 的原因（因为您有 4 条记录，因此有 4 个返回值。

您返回 0 的 where 子句告诉我您的 RegEx 不匹配值 0-2。我将验证 RegEx 是否按预期工作。

# bash - packagemaker 运行 shell 脚本

> ID：14882352
> 
> 赞同：0
> 
> 时间：2013-02-14T19:16:34.687
> 
> 标签：bash, packagemaker

我正在使用 PackageMaker 安装应用程序更新，并希望添加一个预安装脚本来删除文件`/Applications/`夹中的一些文件。脚本很简单：

```
#!/bin/bash
rm /Applications/... 
```

等等

如果我使用终端运行此脚本

```
bash preinstall.sh 
```

它工作正常。

但是，当我将它添加到 PackageMaker 并运行 .mpkg 文件时，脚本会在文本编辑中打开，但不会运行。如何让它运行但不打开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T10:58:28.590

我认为您以错误的方式添加脚本。您可以浏览 [此](http://macinstallers.blogspot.in/2012/07/scripting-in-installer-packages.html) 链接，其中包含有关 Packagemaker 中的脚本的详细说明以及示例脚本。

# jquery - 使用 jQuery 将级联样式应用于元素

> ID：14882358
> 
> 赞同：0
> 
> 时间：2013-02-14T19:16:52.017
> 
> 标签：jquery, css, styles

我有一个看起来像这样的样式标签：

```
<style type="text/css">
#Ribbon\.ListItem\.New\.NewListItem-Larges
{
    display:none;
}
</style> 
```

我想知道如何使用 jQUery 应用这种风格。试过这个，但它不起作用

```
$('head').append('<style type="text/css">#Ribbon\.ListItem\.New\.NewListItem-Large{  display:none;}</style>'); 
```

也涂抹在身体上，无济于事。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:19:35.897

```
$("<style type='text/css'> #Ribbon.ListItem.New.NewListItem-Larges{ display: none;} </style>").appendTo("head"); 
```

它应该可以工作，但您需要删除那些斜线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:19:45.070

您`Larges`在第一段代码和`Large`jquery 中都有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:22:13.790

您可以使用`.hide()`而不是将 CSS 附加到头部。

```
$(function(){
  $("#Ribbon.ListItem.New.NewListItem-Larges").hide();
}); 
```

也就是说，如果您没有动态创建此元素。

# function - Prolog检查功能是否“返回”没有？

> ID：14882359
> 
> 赞同：1
> 
> 时间：2013-02-14T19:16:50.967
> 
> 标签：function, syntax, prolog

我是序言的新手。这是一个假设性问题 - 我意识到它没有实际用途。但是我试图弄清楚如果收到“否”返回，如何让 Prolog 以一种方式运行，如果收到“是”则另一种方式运行。

我正在尝试编写一个`gothrough`带有列表的函数，检查列表的头部是否等于'，'，如果是，则将其传递给另一个函数`checkit`。`checkit`检查传递的变量是否等于';'。如果是，则返回是。如果不是，则返回 no。我想`gothrough`了解这个返回值并采取相应的行动。我知道序言实际上并没有返回值，但我真的不知道如何描述我想要做的......所以到目前为止我有这个：

```
 checkit(H):- H==';'.
 gothrough([H|T]):- H==',', checkit(H), /*what do put here?  if/else statement depending on return value of checkit*/ 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:31:55.657

首先，请注意，你调用的方式`checkit/1`总是会失败，因为`H`它已经绑定了，`','`所以它显然不能同时统一`';'`。

现在，关于您的 if-then-else 问题，请使用[->/2](http://www.swi-prolog.org/pldoc/man?predicate=send_arrow/2)控制谓词：

```
gothrough([H|T]):- 
   H==',', 
   (checkit(H) -> 
         writeln(true_part) ; 
         writeln(false_part)
   ). 
```

# php - .htaccess mod_rewrite 在新服务器上不起作用

> ID：14882360
> 
> 赞同：1
> 
> 时间：2013-02-14T19:17:00.013
> 
> 标签：php, apache, .htaccess, mod-rewrite

我使用 Debian 部署在 Apache 服务器上，Debian 是一个使用 mod_rewrite 的 PHP 软件。

这是`http://domain/path/var1/var2/`被重定向到的基本内容`http://domain/path/index.php?par1=var1&par2=var2`

在我的开发环境中它工作正常，但在这台服务器上它不工作。如果我浏览`http://domain/path/home/`，apache 会为主文件夹返回 404。如果我创建一个主文件夹，它会返回 403，如果我在其中放入一个 index.html，则该文件将提供给浏览器。

phpinfo() 报告 mod_rewrite 已启用。我一直认为这只是取消注释它的 LoadModule for .htaccess 开始工作的问题。

还有什么我可以检查以使其工作的吗？

更新：这是文件夹的配置，这会阻止 htaccess 工作吗？

```
 <Directory /var/www>

            Options None
            AllowOverride None

            AuthType NTLM
            AuthName "Please provide Domain\login"
            require valid-user

            PythonAuthenHandler pyntlm
            PythonOption domain Domain
            PythonOption PDC ADhost
    </Directory> 
```

我明天去换，看看能不能用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:22:23.633

您是否将您的虚拟主机配置为允许以某种方式覆盖 FileInfo：

```
Options FollowSymLinks
AllowOverride FileInfo 
```

另外：您在激活模块后是否重新启动了服务器？

# javascript - 如何正确解析 WebGL 的 collada 文件？（包括示例）

> ID：14882366
> 
> 赞同：6
> 
> 时间：2013-02-14T19:17:14.277
> 
> 标签：javascript, xml, parsing, webgl, collada

这是我目前的结果：

![collada 模型解析不正确](../Images/86d1bf7114e85df41386d9251aa96be9.png)

如您所见，模型中有很多空白。我的猜测，为什么会发生这种情况，我需要`<vcount>`在元素中包含数据`<polylist>`，这应该确定每个平面的顶点数（？）。由于 WebGL 只能绘制 3 边多边形，这似乎行不通。如果到目前为止我的假设是正确的，我需要将所有四边形切成两个三角形。

我已经对使用 WebGL 进行 collada 解析进行了大量研究，但是几乎每个站点都将我重定向到几个已经实现了此类功能的 WebGL 库（所以请不要这样做）。我总是从自己编写所有核心功能开始，以更好地了解内部工作的方式。

这是我的解析函数：

```
function load_collada(gl, program, path) {
    var request = new XMLHttpRequest(),

        buffers = {
            vbo: gl.createBuffer(),
            nbo: gl.createBuffer(),
            ibo: gl.createBuffer(),

            aVertex: gl.getAttribLocation(program, "aVertex"),
            aNormal: gl.getAttribLocation(program, "aNormal")
        },

        mesh,
        vertices,
        indicesList,
        normals = [],
        indices = [];

    request.open("GET", path, false);
    request.overrideMimeType("text/xml");
    request.send();

    mesh = request.responseXML.querySelector("mesh");

    vertices = mesh.querySelectorAll("float_array")[0].textContent.split(" ");
    normals = mesh.querySelectorAll("float_array")[1].textContent.split(" ");
    indicesList = mesh.querySelectorAll("polylist p")[0].textContent.split(" ");

    for (i=0 ; i < indicesList.length; i+=2) { indices.push(indicesList[i]); }

    buffers.vbo.count = parseInt(mesh.querySelectorAll("float_array")[0].getAttribute("count"), 10); 
    buffers.nbo.count = normals.length;
    buffers.ibo.count = indices.length;

    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.vbo);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);
    gl.vertexAttribPointer(buffers.aVertex, 3, gl.FLOAT, true, 0, 0);
    gl.enableVertexAttribArray(buffers.aVertex);

    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.nbo);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(normals), gl.STATIC_DRAW);
    gl.vertexAttribPointer(buffers.aNormal, 3, gl.FLOAT, true, 0, 0);
    gl.enableVertexAttribArray(buffers.aNormal);

    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffers.ibo);
    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);

    return buffers;
} 
```

我也不太清楚为什么法线也有索引，但我忽略了它们，只添加`indicesList`.

我的抽奖程序很简单`gl.drawElements(gl.TRIANGLE_STRIP, program.models[i].ibo.count, gl.UNSIGNED_SHORT, 0);`。

我会非常感谢有关此问题的任何解决方案或建议。

* * *

**更新：**再次使用此解析器后，我注意到上面的解析函数（即使使用正确导出的模型）也不会正确显示法线。您必须更改数据，以便每个面而不是每个唯一位置定义顶点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:26:19.230

找到了一个潜在的解决方案。在将模型导出到搅拌机之前，您需要添加一个`decimate`修改器。检查`triangulate`并设置`ratio`为`0.9900`（单击左箭头）。

**编辑：**实际上有一个`triangulate`修饰符，所以改用这个。

所以最后你的球体网格看起来像这样：

![在此处输入图像描述](../Images/19ed4ef2ad721cd4d4b8960501e4b537.png)

# angularjs - 单击类别链接时过滤项目列表

> ID：14882370
> 
> 赞同：20
> 
> 时间：2013-02-14T19:17:26.747
> 
> 标签：angularjs

我有一个带有“ng-repeat”的项目列表。每个项目都包含一个带有链接标题和链接类别的 div。单击类别时，我想过滤项目列表，以便它只显示属于该类别的项目。我怎样才能做到这一点？

到目前为止，我有一个项目清单：

```
 <div class="link_line" ng-repeat="link in links | filter: ? ">
    <div class="title"><a href="{{link.url}}" target="_blank">{{link.title}}</a></div>
    <div class="category_label" ng-click="filterCategory(link)>{{ link.category }}</div>
  </div> 
```

在控制器中，我有一个函数“filterCategory”，它显示带有链接类别的警报。我有“过滤器：？” 我猜过滤器的值必须来。这是控制器功能：

```
 $scope.filterCategory = (link) ->
    alert(link.category) 
```

知道如何进行吗？谢谢！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-02-14T19:59:19.023

您可以在控制器的范围内创建一个用于过滤的对象，并将其传递给`filter`表达式`ng-repeat`

```
var app = angular.module('app', []);

app.controller('main', function($scope) {
    $scope.filters = { };

    $scope.links = [
        {name: 'Apple', category: 'Fruit'},
        {name: 'Pear', category: 'Fruit'},
        {name: 'Almond', category: 'Nut'},
        {name: 'Mango', category: 'Fruit'},
        {name: 'Cashew', category: 'Nut'}
    ];
}); 
```

所以现在我们有一个`filters`附加到范围的对象。如果它得到一个 key of `category`，`filter`表达式将根据对象是否有 key of`category`并且匹配来自动过滤对象。

[有关更多详细信息，请查看过滤器文档](http://docs.angularjs.org/api/ng.filter%3afilter)的“参数”部分。

因此，您的 HTML 可能如下所示：

```
<div class="link_line" ng-repeat="link in links | filter:filters">
    <div class="title"><a href="{{link.url}}" target="_blank">{{link.title}}</a></div>
    <div class="category_label" ng-click="filters.category = link.category">{{ link.category }}</div>
</div> 
```

[这是一个快速的操作](http://jsfiddle.net/cKa6K/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-17T09:12:41.507

```
angular.module('app',[])
  .controller('MainController', function($scope) { 
  $scope.team =[
    {cat_id:1,team: 'alpha'},
    {cat_id:2,team: 'beta'},
    {cat_id:3,team: 'gamma'}
               ];

    $scope.players = [
      {name: 'Gene',cat_id : 1},
      {name: 'George',cat_id : 2},
      {name: 'Steve',cat_id : 3},
      {name: 'Pzula',cat_id : 2},
      {name: 'shrikant',cat_id : 3}
    ];
 });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.8/angular.min.js"></script>
<div ng-app="app" ng-controller="MainController"> 

<ul ng-repeat="(key, value) in team ">
{{value.team}}

 <li ng-repeat="p in players " ng-if="p.cat_id==value.cat_id">
   {{ p.name }}
 </li>

</ul>
</div>
```

# python - 'sys.path' 报告的顺序是搜索包的顺序吗？

> ID：14882377
> 
> 赞同：3
> 
> 时间：2013-02-14T19:17:51.493
> 
> 标签：python, path, package

Python中条目出现的顺序是否与`sys.path`找到包的顺序相对应？例如我有

```
>>> from pprint import pprint     
>>> pprint(sys.path)
['',
 '/Library/Python/2.7/site-packages/ipython-0.14.dev-py2.7.egg',
 '/Library/Python/2.7/site-packages/matplotlib-1.3.x-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/numpy-1.8.0.dev_3abd869_20121222-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/pymc-2.2-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/scikit_learn-0.13_git-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/scipy-0.12.0.dev_d631749_20121222-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/statsmodels-0.5.0-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/readline-6.2.4.1-py2.7-macosx-10.7-intel.egg',
 '/Library/Python/2.7/site-packages/nose-1.2.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/six-1.2.0-py2.7.egg',
 '/Library/Python/2.7/site-packages/tornado-2.4.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/pyzmq-2.2.0.1-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/patsy-0.1.0-py2.7.egg',
 '/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg',
 '/Library/Python/2.7/site-packages/xattr-0.6.4-py2.7-macosx-10.8-intel.egg',
 '/Library/Python/2.7/site-packages/distribute-0.6.28-py2.7.egg',
 '/Library/Python/2.7/site-packages/astropy-0.3.dev2837-py2.7-macosx-10.8-intel.egg',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC',
 '/Library/Python/2.7/site-packages'] 
```

所以，总的来说，我有

```
['',
 '/Library/Python/2.7/site-packages/PKG_WITH_EGG.egg',
 ...
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 ...
 '/Library/Python/2.7/site-packages'] 
```

这是否意味着如果我安装的一个包（在“站点包”中）碰巧有`.egg`一个`.egg`'Extras' 中没有任何版本的遗嘱？

# ios - 在 tableviewsource 上选择的 Monodevelop 行导致空引用异常

> ID：14882380
> 
> 赞同：0
> 
> 时间：2013-02-14T19:18:02.090
> 
> 标签：ios, uitableview, drop-down-menu, xamarin.ios, uipopovercontroller

```
public delegate bool SelectedValueForDropDown (string name);
public partial class BasicTableViewSource : UITableViewSource
{
public override void RowSelected(UITableView tableView, MonoTouch.Foundation.NSIndexPath indexPath)
    {
        SelectedValueForDropDown selValue;
        // Do something for the selected row
        string itemSel = this._tableItems[indexPath.Section];
        Console.WriteLine("90 the item selected is :{0}",itemSel);

        DetailViewController dvc = new DetailViewController();
        selValue = dvc.SelectedValueForPosition;
        //bool val = dvc.SelectedValueForPosition(itemSel);
        ValueSelectedDD valDD = new ValueSelectedDD();

        bool success = valDD.HandleValueSelected(selValue);
        Console.WriteLine("100 the value is : {0}",success);
    }
.....
} //class closed

public class ValueSelectedDD
{
    public bool HandleValueSelected (SelectedValueForDropDown selValue)
    {
        bool success =false;
        success = selValue("CEO");

        return success;
    }
}
//This method is in DetailViewController.designer.cs class.
public bool SelectedValueForPosition (string name)
    {
        Console.WriteLine("the value selected is :{0}",name);
        btnPosition.SetTitle(name,UIControlState.Normal); //Exception occurs here
        return true;
    } 
```

我正在做简单的 MonoDevelop 项目。所以我有一个表格视图作为我的按钮弹出。我点击它，我有 3 个选项。我选择一个，按钮的标签应该被选择的选项替换。选定的行在 tableviewsource 类中。DetailViewController 是我可以点击实际按钮的类。我得到了一个例外

```
System.NullReferenceException: Object reference not set to an instance of an object

 at EmployeeWithDropDown.DetailViewController.SelectedValueForPosition (System.String name) [0x0000b] in /Users/.../EmployeeWithDropDown/EmployeeWithDropDown/DetailViewController.designer.cs:106

 at EmployeeWithDropDown.ValueSelectedDD.HandleValueSelected (EmployeeWithDropDown.SelectedValueForDropDown selValue) [0x00002] in /Users/.../EmployeeWithDropDown/EmployeeWithDropDown/BasicTableViewSource.cs:109
   at EmployeeWithDropDown.BasicTableViewSource.RowSelected (MonoTouch.UIKit.UITableView tableView, MonoTouch.Foundation.NSIndexPath indexPath) [0x00036] in /Users/.../EmployeeWithDropDown/EmployeeWithDropDown/BasicTableViewSource.cs:99

 at (wrapper managed-to-native) MonoTouch.UIKit.UIApplication:UIApplicationMain (int,string[],intptr,intptr)
  at MonoTouch.UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x0004c] in /Developer/MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:38
  at EmployeeWithDropDown.Application.Main (System.String[] args) [0x00000] in /Users/.../EmployeeWithDropDown/EmployeeWithDropDown/Main.cs:17

System.NullReferenceException has been thrown.
Object Reference not set to an instance of an object. 
```

如果您需要更多信息，请询问。谢谢。

编辑：

```
public partial class PopoverContentViewcontroller : UIViewController
{
    public override void ViewDidLoad ()
    {

        base.ViewDidLoad ();
        table = new UITableView(View.Bounds);
        table.AutoresizingMask = UIViewAutoresizing.All;
        string[] tableItems = new string[]{"CEO","Developer","IT"};
        //List<String> wordList = Arrays.asList(words); 
        List<string> lst = new List<string>(tableItems);

        table.Source = new BasicTableViewSource(lst);
        Add (table);
       }
 .....
} 
```

这是填充表格以进行下拉的弹出控制器。即这里的值被填充在下拉列表中..

编辑2：

```
 DetailViewController dvc;
                    .....
            table.Source = new BasicTableViewSource(lst,dvc);
        Add (table); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:38:40.243

您正在 RowSelected 方法中创建 DetailViewController 的新实例。您需要的是对已经存在的 DetailViewController 的引用。

创建 TableViewController 时，需要传入对“父级”DetailViewController 的引用。这样，您可以在 RowSelected 方法中调用现有 DVC 上的方法。

# parsing - 基于套接字的应用协议解析的常规方法

> ID：14882388
> 
> 赞同：4
> 
> 时间：2013-02-14T19:18:43.163
> 
> 标签：parsing, sockets, networking, network-protocols

解析应用程序协议的常规方法是什么？

给定来自已设计协议（例如 SMTP）的套接字的流，处理协议的常用方法是什么。它是基于 yacc 的解析器、基于正则表达式的方法还是其他方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T11:11:22.530

应用层协议有很多，但我认为主要区别在于它是基于**二进制**还是**基于文本的**。两者都被广泛使用。

对于基于**文本的协议**，通常对输入进行标记，然后使用`yacc`. 一些基于文本的协议甚至比这更容易解析，因此您可能只需拆分输入并检查它是否有意义。应该考虑编码，但它必须是您已经通过内置方法或库（例如`UTF-8`. 例如，HTTP 是一个文本协议，并且很容易解析（示例来自[这里](http://www.jmarshall.com/easy/http/#sample)）：

要求：

```
GET /path/file.html HTTP/1.0
From: someuser@jmarshall.com
User-Agent: HTTPTool/1.0
[blank line here] 
```

回复：

```
HTTP/1.0 200 OK
Date: Fri, 31 Dec 1999 23:59:59 GMT
Content-Type: text/html
Content-Length: 1354

<html>
<body>
<h1>Happy New Millennium!</h1>
(more file contents)
  .
  .
  .
</body>
</html> 
```

大多数程序员都可以为此编写解析器，即使您最好依赖经过良好测试和完整的库实现。

**二进制协议**虽然有些不同。第一件事是使用例如[ASN.1](http://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One)（在电信中经常使用）、[协议缓冲区](http://code.google.com/p/protobuf/)或类似的东西对消息进行编码/解码。如果可能的话，不要发明自己的二进制格式，依赖经过测试和尝试的库——这很难做到，难怪`ASN.1`大多数工具都很昂贵。

这是`ASN.1 UPER`，您定义了一个简单的元素，例如（[此处](http://en.wikipedia.org/wiki/Abstract_Syntax_Notation_One#Example)的示例）：

```
myQuestion FooQuestion ::= {
    trackingNumber     5,
    question           "Anybody there?"
} 
```

它被编码如下：

```
01 05 0e 83 bb ce 2d f9 3c a0 e9 a3 2f 2c af c0 
```

有了所有的位移和掩码，实现起来并不容易——这就是为什么支持的开源`ASN.1`库`PER`如此罕见的原因。

两种方法都有其优点/缺点。基于文本的协议更容易正确、调试和理解。不过，他们通常很健谈，在某些情况下，这很重要。这是选择 eg 的时候`ASN.1 PER`，这很难实现或调试，但非常紧凑。

# php - 根据 PHP 中另一列的顺序对 MySQL 数据库中的项目进行排序

> ID：14882393
> 
> 赞同：1
> 
> 时间：2013-02-14T19:19:01.783
> 
> 标签：php, mysql

我有一个看起来像这样的数据库

```
Title     |     ID
---------------------------------
Hello           45
Hi              23
Yo              52
Test            76 
```

然后我有另一个看起来像这样的表：

```
List                 |   Order
---------------------------------
Main List                76,23,45,52 
```

我要做的是查询数据库并根据第二个表的顺序输出第一个表的标题。

关于执行此类操作的最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:21:12.507

```
SELECT
   *
FROM
    menu m
    INNER JOIN links l ON (l.menu_id = m.menu_id)
WHERE
    m.menu_id = 123
ORDER BY
    FIND_IN_SET(l.link_id, m.menu_order) 
```

显然，您需要更改以反映您的实际表和列名称

Per Michael Berkowski 在下面的评论中，如果您没有两个表之间的链接（因此您无法加入），您可以通过以下方式完成相同的操作：

```
SELECT t1.*
FROM t1
ORDER BY FIND_IN_SET(ID, (SELECT `Order` FROM t2)) 
```

随意摆弄他的 SQLFiddle 示例：[http ://sqlfiddle.com/#!2/947e3/2](http://sqlfiddle.com/#!2/947e3/2)

谢谢，迈克尔

# c++ - 通过代理服务器提升 asio 套接字连接

> ID：14882395
> 
> 赞同：2
> 
> 时间：2013-02-14T19:19:09.077
> 
> 标签：c++, sockets, networking, proxy, boost-asio

我有一个客户端/服务器设置，可以使用 boost 的 asio 套接字相互通信。该协议很简单，它以一个 64 位值开始，告诉后面的数据有多长，其余的以 JSON 形式出现。

问题是，它不支持客户端和服务器之间的代理，现在我们需要支持它。

正如我在网上看到的，看起来代理一般都很简单。对于 HTTP 代理，您可以联系代理并向其发送 CONNECT 请求以获取您想要的实际 URL，然后它会继续传递信息。

但我还不明白如何将它与我的非 HTTP 数据相协调。

1.  我是否需要更改我的“协议”以使其与代理服务器一起使用？我看到这个建议：

    `CONNECT http://my.server.com:80 HTTP/1.0\r\n\r\n`

    但是我的非协议怎么办？

2.  我试过告诉它我正在使用 HTTP，然后接下来发送 JSON 数据，但遇到了一系列问题，以至于我不知道问题是我的实现还是我的问题我试图做的根本行不通。

3.  如果我在这里完全脱离基地，我很想被理顺。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T14:57:58.510

我不认为搭载 HTTP 代理是正确的解决方案。现在你有

```
Client <---------> Server 
```

但是你想要

```
Client <------> proxy <------> Server 
```

我建议自己编写代理。它将像您的服务器一样是一个守护进程，并且应该同时使用您的客户端和服务器协议。协议可能需要修改，以便代理知道服务器地址和服务。同样，客户端将需要其他信息来连接到代理而不是服务器。

# twitter-bootstrap - Twitter Bootstrap 手风琴图标没有改变

> ID：14882404
> 
> 赞同：16
> 
> 时间：2013-02-14T19:19:36.847
> 
> 标签：twitter-bootstrap, accordion

我从引导程序中得到了这个手风琴的东西。箭头图标指向**下方**。

![在此处输入图像描述](../Images/b9b6ed30d69c1fc908b0343a7366c73d.png)

然后我点击 Competency1，我得到（Competency1 icon **up** , Competency2 icon **down**）：

![在此处输入图像描述](../Images/65f24059f342c5741b727f867fb25f2c.png)

但是，如果我现在点击 Competency2，我会得到（Competency1 图标**仍然处于打开**状态，Competency2 图标处于**打开**状态）：

![在此处输入图像描述](../Images/d14b42b0331f594b6e1df62e9ee3f455.png)

这是引导程序中的错误，还是可以轻松修复？

谢谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-18T02:10:15.297

没有看到你的代码就很难提供建议。您可能仅在“显示”事件上触发图像交换（检查 js 中的拼写错误）。

这是我用来在我的网站上创建相同效果的方法：

**HTML：**

```
<div class="accordion">
    <div class="accordion-group">
        <div class="accordion-heading"> 
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                <i class="icon-chevron-down"></i>
                Collapsible Group Item #1
            </a>
        </div>
    </div>

    <div class="accordion-group">
        <div class="accordion-heading"> 
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                <i class="icon-chevron-down"></i>
                Collapsible Group Item #2
            </a>
        </div>
    </div>
</div> 
```

**JavaScript：**

```
$('.accordion').on('show hide', function (n) {
    $(n.target).siblings('.accordion-heading').find('.accordion-toggle i').toggleClass('icon-chevron-up icon-chevron-down');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:00:21.743

出现这种情况的原因是，当 Competency1 已经打开时，单击 Competency2 会折叠 Competency1。因为 Competency1 以这种方式折叠时没有发生单击事件，所以插入符号仍指向上方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-28T10:44:02.117

这是引导程序中的错误。如果您在切换具有 .accordion-toggle 类的标题之一时检查您的标记，它会切换它是否使该类折叠或不折叠。当您单击与打开的标题不同的标题时，尽管它不会将折叠的类添加到打开元素的标题上。这为我修复了它：

```
$('.accordion-toggle').click(function() {
    if($(this).hasClass('collapsed')) {
        $('.accordion-toggle').not(this).addClass('collapsed');
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T03:06:20.470

使用 jquery.js 1.10.2 和 bootstrap-collapse.js v2.3.0，这是对上述内容的重新哈希。加载文档后，它会折叠除第一个项目之外的所有项目，然后处理后续的显示/隐藏事件。

```
$(document).ready(function () {

    $(".accordion-body").on("shown", function (evt) {
        setIcon(evt.target, true);
    });

    $(".accordion-body").on("hidden", function (evt) {
        setIcon(evt.target, false);
    });

    $(".accordion-body").collapse("hide");
    $("#collapse-faq-1").collapse("show");
});

function setIcon(acdBody, isShown) {
    var indicator = "indicator" + acdBody.id.substr(acdBody.id.lastIndexOf("-"));

    if (!isShown) {
        $("#" + indicator).removeClass("icon-chevron-up").addClass("icon-chevron-down");
    } else {
        $("#" + indicator).removeClass("icon-chevron-down").addClass("icon-chevron-up");
    }
} 
```

HTML：

```
<div class="accordion" id="accordion">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse-faq-1">
                <i id="indicator-1" class="icon-chevron-down"></i>&nbsp;&nbsp;
                FAQ Item 1
            </a>
        </div>
        <div id="collapse-faq-1" class="accordion-body collapse in">
            <div class="accordion-inner">
                Answer 1 ...
            </div>
        </div>
    </div>
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapse-faq-2">
                <i id="indicator-2" class="icon-chevron-down"></i>&nbsp;&nbsp;
                FAQ Item 2
            </a>
        </div>
        <div id="collapse-faq-2" class="accordion-body collapse in">
            <div class="accordion-inner">
                Answer 2 ...
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-04T11:40:45.220

您可以使用此代码来更改图标。

**脚本部分：**

```
jQuery('document').ready(function() {

$('.accordion').on('show hide', function (n) {
    var targetEle = $(n.target).siblings('.accordion-heading').find('.accordion-toggle');
    if($(n.target).hasClass("in")){
        targetEle.children(".icon-chevron-down").show();
        targetEle.children(".icon-chevron-up").hide();
    }
    else{
        targetEle.children(".icon-chevron-down").hide();
        targetEle.children(".icon-chevron-up").show();
    }

});

}); 
```

注意：要使用此代码，在 html 部分中，您必须包含两个图像标签，即。雪佛龙向上和雪佛龙向下。

# postgresql - PostgreSQL UPSERT（可写 CTE）中的不明确列使用一个表来更新另一个

> ID：14882408
> 
> 赞同：2
> 
> 时间：2013-02-14T19:19:44.143
> 
> 标签：postgresql, recursive-query, upsert

我有一个表`users_import`，我正在解析和导入 CSV 文件。使用该表，如果用户已经存在，我想更新我的`users`表，或者如果它不存在，则插入。（这实际上是我正在尝试做的更复杂的事情的一个非常简化的例子。）

我正在尝试做与此非常相似的事情： [https ://stackoverflow.com/a/8702291/912717](https://stackoverflow.com/a/8702291/912717)

以下是表定义和查询：

```
CREATE TABLE users (
    id INTEGER NOT NULL UNIQUE PRIMARY KEY,
    name TEXT NOT NULL
);

CREATE TABLE users_import (
    id INTEGER NOT NULL UNIQUE PRIMARY KEY,
    name TEXT NOT NULL
);

WITH upsert AS (
    UPDATE users AS u
    SET
        name = i.name
    FROM users_import AS i
    WHERE u.id = i.id
    RETURNING *
)
INSERT INTO users (name)
    SELECT id, name 
    FROM users_import
    WHERE NOT EXISTS (SELECT 1 FROM upsert WHERE upsert.id = users_import.id); 
```

该查询给出了这个错误：

```
psql:test.sql:23: ERROR:  column reference "id" is ambiguous
LINE 11:  WHERE NOT EXISTS (SELECT 1 FROM upsert WHERE upsert.id = us...
                                                       ^ 
```

为什么`id`模棱两可，是什么原因造成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:13:31.220

`RETURNING *`in`WITH upsert...`子句包含连接表中的所有列和`users`所有列`users_import`。所以结果有两列命名`id`和两列命名`name`，因此在引用时会产生歧义`upsert.id`。

为避免这种情况，`RETURNING u.id`请在不需要其余列时使用。

# jquery-selectors - 需要帮助选择

> ID：14882413
> 
> 赞同：0
> 
> 时间：2013-02-14T19:19:48.500
> 
> 标签：jquery-selectors, show-hide

我有与此类似的 HTML：

```
<div class="MainForm">
    <form name="FromName">
     <button name="Button1"></button>
     ...
     ...
    </form>
   <Div class="blackBox" style="visibility:hidden;"></div>
   <Div class="SubFotm" style="visibility:hidden;"></div>
</div> 
```

现在我可以在脚本中正确找到按钮单击的触发器，但我无法仅针对壁橱黑盒使其可见。

目前我正在做：

```
if (PButtonName=="Fermer") {
$(this).closest("div .ProfileForm").remove(); // Closing Profile Form
}  else if (PButtonName=="plusAdresse") {
alert('In');
      $(this).closest("div .BlackBox").css("visibility","visible");  
} 
```

我可以`"In"`显示警报，但不能显示 BlackBox 如果我更改

```
$(this).closest("div .BlackBox").css("visibility","visible"); 
```

为了 ：

```
 $("div .FormBlackBox").css("visibility","visible"); 
```

它会显示，但也会显示文档中的所有黑框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:29:56.953

而不是你所做的只是`display:none;`向你的 div 添加样式，然后在你想要的时候显示它们。所以你可以这样做如下：

```
<div class="MainForm">
    <form name="FromName">
     <button name="Button1"></button>
     ...
     ...
    </form>

   <div class="blackBox" style="display:none;"></div>
   <div class="SubFotm" style="display:none;"></div>
</div> 
```

然后在你的脚本中

```
if (PButtonName=="Fermer") 
{
      $(".MainForm").closest("div .ProfileForm").remove(); // Closing Profile Form
}  
else if (PButtonName=="plusAdresse")
 {
     alert('In');
     $(".MainForm").closest("div .BlackBox").show();  
} 
```

我会推荐你`Switch case`​​在这个地方使用而不是循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:04:03.683

如果您使用的是上面的 HTML 或类似的东西，我会使用对父母的引用来做到这一点。

代替：

```
$(".MainForm").closest("div .BlackBox").css('visibility','visible'); 
```

采用

```
$(this).parents('.MainForm').children('.BlackBox').css('visibility','visible'); 
```

这是假设您有多个 MainForm div，并且它们都有一个带有 BlackBox 类的子级。

[这是一个例子。](http://jsfiddle.net/XbSfJ/)

# django - 在 listview 类方法中包含业务逻辑的位置

> ID：14882415
> 
> 赞同：1
> 
> 时间：2013-02-14T19:19:54.817
> 
> 标签：django, django-views, django-class-based-views

我正在尝试了解 Django 的基于类的视图（对它来说非常新），尤其是 ListView。我正在努力理解“业务逻辑应该去哪里”。例如，我有以下课程：

```
#views.py
class DisplayListView(ListView):
    model = Cars
    template_name = "searchres_list.html"
    paginate_by = '5'
    context_object_name = "titles"

def get_context_data(self, **kwargs):
    context = super(SearchDisplayListView, self).get_context_data(**kwargs)
            # custom logic whoch spits out "now". in this example [1 -->10]
    context['now'] = [1,2,3,4,5,6,7,8,9,10]
    return context 
```

它工作正常，我可以在我的模板上查看 [1 --> 10]。但是，当我查看[ListView](http://ccbv.co.uk/projects/Django/1.4/django.views.generic.list/ListView/)下可用的方法时，我发现我可能会将我的逻辑包含在 get_queryset 方法中。所以，像：

```
def get_queryset(self):
    # Fetch the queryset from the parent get_queryset
    queryset = super(SearchDisplayListView, self).get_queryset()
             # custom logic whoch spits out "now". in this example [1 -->10]
    queryset = [1,2,3,4,5,6,7,8,9,10]
            return queryset 
```

所以，我相当（愚蠢）的问题是（或者我完全错了！），理想情况下业务逻辑应该去哪里：

1.  def get_context_data
2.  def get_queryset

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:45:10.190

对于这样一个主观问题，最好的答案可能是：视情况而定。

我处理这种情况的个人算法如下：

*   如果您需要向将传递给模板的*上下文*添加一些内容，那么您实际上别无选择，因为在**get_queryset**方法中您只能修改 ListView 的查询集。所以我在这种情况下使用 get_context_data 。
*   但是如果您要执行一些*动态查询集修改*，假设您的视图可以在类似的模型类上运行，并且实际的类由传递给视图的参数确定，那么您可能需要覆盖**get_queryset**方法。

希望我能给你一些关于这个话题的见解:)

# php - 如何在 PHP 中使用 GD 将 GIF 转换为 PNG 并删除其透明度？

> ID：14882416
> 
> 赞同：0
> 
> 时间：2013-02-14T19:19:55.273
> 
> 标签：php, html, png, gd, gif

有没有办法将 GIF 转换为 PNG 并在 PHP 中使用 GD 删除其透明度？

# java - Java如何使JFrame最大化但不可调整大小

> ID：14882417
> 
> 赞同：5
> 
> 时间：2013-02-14T19:19:57.327
> 
> 标签：java, swing, jframe, screen, dimension

最初（请参阅我之前的问题“ [Java 如何使 JFrames 作为最大化窗口开始](https://stackoverflow.com/questions/14881117/java-how-to-make-jframes-start-off-as-a-maximised-window)”）我想制作一个开始最大化的窗口。这段代码完成了这个：

```
public static void main(String[] args)  {

JFrame frame = new JFrame();
frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
frame.setVisible(true);

} 
```

然而，如果这个窗口被恢复下来，它就变成了一个几乎不存在的栏。为了解决这个问题，我使用 setSize() 设置了窗口的大小。这可行，但存在另一个问题，窗口仍然可以调整大小。

为了解决这个问题，我设置了 setResizable(false); 这是我到目前为止的代码：

```
public static void main(String[] args) {

    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();

    JFrame frame = new JFrame("Jedia");
    frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
    frame.setSize(screenSize);
    frame.setResizable(false);
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

} 
```

但是，现在窗口以指定的大小（而不是最大化）开始，并且无法恢复。

所以，我的问题是，我怎样才能让窗口开始最大化，在它恢复时给它一个大小，并使调整大小变得不可能？或者制作一个开始最大化且无法恢复的窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:07:34.970

有一个几乎一直有效的简单修复方法：在设置为可见*后使您的框架不可调整大小。*所以只能这样修改你的代码：

```
public static void main(String[] args) {

    Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();

    JFrame frame = new JFrame("Jedia");
    frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
    frame.setSize(screenSize);
    frame.setVisible(true);    // FIRST visible = true
    frame.setResizable(false); // THEN  resizable = false
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

} 
```

这样，框架将开始最大化，最大化按钮将变灰，阻止用户使用它。（我真的不知道你为什么要这样做。我想最大化状态只有在窗口变得可见时才真正应用，如果你之前让它不可调整大小，它就不会应用。）

它*几乎*一直有效，因为至少在 Windows 7 上，您可以通过单击标题栏并拖动它来使窗口退出最大化状态。但它将是您之前设置的大小。问题是您的用户将无法再次最大化它，而且我还没有找到让侦听器使窗口回到最大化状态的方法。（**编辑**：@David Kroukamp 在他的回答的最后一部分显示，可以通过使用 ComponentListener 来强制最大化状态。因此您不必使用`setResizable(false)`这种方式，您仍然会遇到 Windows 7 的问题，因为拖动操作无论出于何种原因，都不会被此事件捕获，但用户将能够使用最大化按钮将其放回应有的位置。）

**现在**，几乎没有理由去做这种事情。用户不喜欢你阻止他们操作他们的窗口（例如，最大化的窗口不能移动，当你有多个屏幕时这可能会很烦人）。一个例外是，如果您正在制作游戏，通常是全屏的。但是你不会想要一个 JFrame，因为你不想要所有的装饰，而是一个窗口。

如果您的问题是默认窗口大小非常小，这是正常的。你必须先在你的框架中放一些东西（一些控件、按钮、你在应用程序中想要的东西），使用布局（这很重要），然后`pack()`在你的框架上调用方法。它将为您的窗口选择一个不错的默认大小。

**最后**，最后一句话。我已将示例代码`main`作为快捷方式放在方法中，但您应该始终在 Swing EDT 中使用`SwingUtils.invokeLater()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T19:52:28.700

有时，您必须注意设置 JFrame 参数的顺序。

此外，您应该在事件调度线程上使用 Swing 组件。

试试这个，看看它是否有帮助。

```
public static void main(String[] args) {        
    final Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();

    SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            JFrame frame = new JFrame("Jedia");
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setSize(screenSize);
            frame.setResizable(false);
            frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
            frame.setVisible(true);
        }   
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:39:22.917

你在什么环境下运行？我在 Win7 下使用 JDK1.6 / JDK1.7 进行了尝试，它按预期工作（窗口开始最大化，最小化到任务栏）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T21:37:31.087

我有一种可能有用的技巧。试试这个代码（它对我有用）：

```
public static void main(String[] args) {

    final JFrame frame = new JFrame("Jedia");
    frame.setMinimumSize(new Dimension(600, 400));
    frame.setExtendedState(JFrame.MAXIMIZED_BOTH);
    frame.setVisible(true);

    frame.addComponentListener(new ComponentListener(){

        @Override
        public void componentHidden(ComponentEvent e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void componentMoved(ComponentEvent e) {
            // TODO Auto-generated method stub

        }

        @Override
        public void componentResized(ComponentEvent e) {

            if (!e.paramString().startsWith("COMPONENT_RESIZED (-8,-8"))
            frame.setSize(new Dimension(600, 400));
        }

        @Override
        public void componentShown(ComponentEvent e) {
            // TODO Auto-generated method stub

        }
    }); 
} 
```

`e.paramString()`当恢复操作发生时，返回一个看起来像“COMPONENT_RESIZED (-8,-8, [screensize])”的字符串。

# aptana - Aptana 中的 Zen Coding 磨损缩写

> ID：14882420
> 
> 赞同：0
> 
> 时间：2013-02-14T19:20:06.063
> 
> 标签：aptana, emmet

您好，我在 Aptana 中使用 Zen Coding，但某些缩写无法正常工作。当我输入 w TAB 时，我得到 white-space: 而不是 width: 有人能告诉我如何设置正确的缩写吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T10:12:36.997

Aptanas 的 Tab 键处理程序优先于 Zen Codings 的处理程序（顺便说一句，Zen Coding 最近重命名为 Emmet：[https](https://github.com/emmetio/emmet-eclipse) ://github.com/emmetio/emmet-eclipse ）。

因此，在您的情况下，您实际上是在扩展 Aptana 片段，而不是 Emmet 片段。

您应该删除所有 Aptana 片段以允许 Emmet 处理它们或配置（通过 Preferences > Keys）并使用另一个快捷方式显式扩展 Emmet 缩写。

# javascript - 解析已知键的字符串正则表达式但保留分隔符

> ID：14882423
> 
> 赞同：2
> 
> 时间：2013-02-14T19:20:26.690
> 
> 标签：javascript, regex, key-value

好的，所以我在尝试制作正则表达式时遇到了一些障碍。

本质上，我想要一个像这样的字符串：

```
error=some=new item user=max dateFrom=2013-01-15T05:00:00.000Z dateTo=2013-01-16T05:00:00.000Z 
```

被解析为阅读

```
error=some=new item
user=max
dateFrom=2013-01-15T05:00:00.000Z
ateTo=2013-01-16T05:00:00.000Z 
```

所以我希望它提取已知的关键字，并忽略其他具有*=*的字符串。

我当前的正则表达式如下所示：

```
(error|user|dateFrom|dateTo|timeFrom|timeTo|hang)\=[\w\s\f\-\:]+(?![(error|user|dateFrom|dateTo|timeFrom|timeTo|hang)\=]) 
```

所以我使用已知的关键字来动态使用，所以我可以将它们列为已知的。

我怎么能写它来包括这个要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:50:05.860

您可以像这样使用替换：

```
var input = "error=some=new item user=max dateFrom=2013-01-15T05:00:00.000Z dateTo=2013-01-16T05:00:00.000Z";

var result = input.replace(/\s*\b((?:error|user|dateFrom|dateTo|timeFrom|timeTo|hang)=)/g, "\n$1");
result = result.replace(/^\r?\n/, ""); // remove the first line 
```

结果：

```
error=some=new item 
user=max 
dateFrom=2013-01-15T05:00:00.000Z 
dateTo=2013-01-16T05:00:00.000Z 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:03:31.023

另一种标记字符串的方法：

```
var tokens = inputString.split(/ (?=[^= ]+=)/); 
```

正则表达式查找后跟（以 a 结尾的非空格非等号序列`=`）的空格，并在这些空格处拆分。

结果：

```
["error=some=new item", "user=max", "dateFrom=2013-01-15T05:00:00.000Z", "dateTo=2013-01-16T05:00:00.000Z"] 
```

使用上述技术并根据您的问题调整您的正则表达式：

```
var tokens = inputString.split(/(?=\b(?:error|user|dateFrom|dateTo|timeFrom|timeTo|hang)=)/); 
```

这将正确拆分评论中提到的 Qtax 指出的输入：`"error=user=max foo=bar"`

```
["error=", "user=max foo=bar"] 
```

# node.js - 运行 node.js 代码只显示一个节点标识符

> ID：14882427
> 
> 赞同：13
> 
> 时间：2013-02-14T19:20:33.223
> 
> 标签：node.js

我在名为 server.js 的文件中有以下代码。

```
var http = require('http');

http.createServer(function (request, response) {
  response.writeHead(200, {'Content-Type': 'text/plain'});
  response.end('Hello World\n');
}).listen(8124);

console.log('Server running at http://127.0.0.1:8124/'); 
```

我使用命令提示符并导航到文件所在的文件夹，然后运行命令

```
node server.js 
```

但我没有得到预期的输出。相反，我得到

```
The node identifier for {My Machine Name} is v2hrfnqaj. 
```

注意：我已经在我的机器上安装了节点，它工作正常。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-09-19T01:35:57.677

当我尝试运行cordova命令时得到了这个。解决步骤：

视窗

1.  在 CMD 提示符下，键入“where node”。正如迈克尔所提到的，这向您展示了可能的罪魁祸首，即您的机器上安装了 2 个 nodejs EXE。
2.  导航到开始 > 计算机 > 右键单击​​属性 > 高级系统设置
3.  在高级选项卡下，选择环境变量
4.  在系统变量下，选择“路径”变量
5.  找到nodejs EXE，通常是“C:\Program Files (x86)\nodejs\”
6.  将其剪切并粘贴到“路径”变量的开头。确保路径用“;”分隔
7.  打开一个新的 CMD 提示并再次尝试 cordova

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-06-22T12:12:29.343

在您的系统上安装[Harvest SCM](https://www.ca.com/us/products/ca-harvest-software-change-manager.html)时会发生这种情况。它有一个名称`node.exe`为 at的可执行文件`<Program Files (x86)>\CA\SharedComponents\PEC\bin`（`<Program Files (x86)>`您的 x86 程序文件文件夹在哪里）。此路径存在于您的`PATH`变量中*，*位于 Node.js 的`node.exe`.

**更新**：您不需要旧答案中列出的详细方案。您只需打开命令提示符并运行：

```
C:\> nodevars 
```

`nodevars.bat`是一个小脚本，它与下面描述的基本相同（但以更安全的方式）。如果您安装了节点，则此脚本应位于路径中。（如果不确定添加`C:\Program Files\nodejs`到您的路径中。但请确保将其附加到最后，这样 Harvest SCM 就不会中断）。

* * *

以下所有内容都已过时，但我会将其留给好奇的读者。

您可以执行以下两项操作中的任何一项来克服此问题：

1.  `<Program Files (x86)>\CA\SharedComponents\PEC\bin`从`PATH`环境变量中删除。
2.  添加/移动`<Program Files (x86)>\nodejs`到`PATH`环境变量的开头（这是[当前接受](https://stackoverflow.com/a/25925019/1461424)的来自[djrpascu](https://stackoverflow.com/users/3622178/djrpascu)的答案）。

# 你可以做得更好！

上述方法存在两个问题：

1.  您破坏了 Harvest SCM 的功能。
2.  如果您没有提升的更改权限`PATH`，那么您将别无选择。（感谢[@Glats](https://stackoverflow.com/users/2291305/glats)）

所以我创建了这个小批处理文件，并将它放在我有几个其他个人脚本的目录中（这个目录在我的`PATH`. [这是脚本的要点](https://gist.github.com/sampathsris/719fc733d6d5e98b2b53/)。

**`nodecmd.bat`**

```
@echo off

set path=%path:C:\Program Files (x86)\CA\SharedComponents\PEC\bin;=%;C:\Program Files (x86)\nodejs;

start %ComSpec% 
```

然后下次你想运行 Node.js，而不是命令提示符，你用["Run..." 命令](https://en.wikipedia.org/wiki/Run_command)打开新脚本。

> `Windows`+`R`
> 
> `nodecmd`

将出现一个命令提示符。您可以使用此命令提示符轻松运行`node`。

# 解释

`PATH`此位从变量中删除 Harvest 的可执行文件路径：

```
%path:C:\Program Files (x86)\CA\SharedComponents\PEC\bin;=%; 
```

这添加了 Node.js 的路径：

```
set path=...;C:\Program Files (x86)\nodejs; 
```

结果是一个字符串，其中包含原始 PATH 变量*减去*Harvest 的路径，*再加上*Node 的路径。并且在当前批处理文件的范围内设置为PATH变量。

> ***注意：***您可能必须更改脚本中的路径以适应系统中的软件安装文件夹）。

下一行，`start %ComSpec%`启动命令提示符。此时，PATH 变量已被修改。使用修改后的环境变量，您可以在这个新的命令提示符中运行 node。**环境变量修改不影响系统其余部分**，保证Harvest SCM软件运行不中断。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-06-08T15:18:41.437

不要通过从路径中删除您的 Harvest SCM 来破坏它。试试这个，打开你的 windows 命令行 (cmd)，然后传递以下 nodejs 批处理文件，以便它将你的命令行设置为 nodejs 环境。享受那里的节点命令。

C:> "C:\Program Files\nodejs\nodevars.bat"

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-21T06:32:13.663

您还可以在环境中确定优先级。步骤：计算机 -> 右键单击​​ -> 属性 -> 高级系统设置 -> 环境变量 -> PATH（在系统变量列表中） -> 编辑 -> 上移优先级

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-06-27T16:19:17.387

这是旧的，但我遇到了同样的问题。完全相同的消息（当然是我的机器名称）。问题是路径上有另一个节点可执行文件，在`C:\Program Files (x86)\CA\SharedComponents\PEC\bin`. 我在 Windows 机器上，因此运行`where node`显示路径中存在两个冲突的“节点”可执行文件。

为了解决这个问题，我刚刚从`PATH`环境变量中删除了 CA 目录。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-10-05T16:29:26.657

`node.exe`我遇到了同样的问题，只是从 Harvest更改了文件名。这并没有破坏 Harvest 的任何东西，我可以继续使用它。

将 Harvest 的命令名称更改为`node_.exe`：

```
ren "C:\Program Files (x86)\CA\SharedComponents\PEC\bin\node.exe" "C:\Program Files (x86)\CA\SharedComponents\PEC\bin\node_.exe" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-14T19:34:25.983

我认为您正在运行错误的节点命令。尝试找到或重新下载您的 nodejs 安装并将其作为第一个目录添加到您的路径中。如果您正在运行 linux 或 unix，您可以尝试“哪个节点”来查看正在运行的内容。`nodejs server.js`请注意，在某些情况下，node.js 可执行文件称为 nodejs，因此您可能也想尝试一下

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-14T21:12:35.737

我使用了 node.js 命令提示符，而不是 Windows 默认命令提示符，它对我有用。不知道为什么它在 windows 默认命令提示符下不起作用。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-04-22T14:26:53.383

I was also running with same issue - while defining the path for windows use below parameter

Windows:

```
set NODE_PATH=C:\nodejs 
```

OR

Set the environment variable for nodejs

```
NODE_PATH=C:\nodejs
Path= C:\nodejs 
```

(append the path contain this string “c:\nodejs”)

# actionscript-3 - Object.defineProperty 在 AS3 中的表现如何？

> ID：14882430
> 
> 赞同：1
> 
> 时间：2013-02-14T19:20:45.750
> 
> 标签：actionscript-3, unit-testing, porting, assertions, should.js

我是一名拥有强大 JavaScript 背景的架构师，但我过去做过一些 .NET 和 Java。

但是，我想尝试一下 ActionScript3，我得到了承诺，它与 JavaScript 非常相关。

作为一个启动项目，我自己尝试移植到我最喜欢的断言实用程序之一的 ActionScript3 - [should.js](https://github.com/visionmedia/should.js) - 让您的测试代码非常易于阅读。

**更新时间：2013-02-19**

我看到我对我的抽象演讲感到困惑，所以我用脑海中的具体问题替换了一些帖子。这是完整的图片：

考虑以下 JavaScript 代码：

```
Object.defineProperty(Object.prototype, 'should'
, { set: function(){}
  , get: 
    function(){
       return new Assertion(Object(this).valueOf());
    }
  , configurable: true
  , enumerable  : false
  }
); 
```

这是 JavaScript 模块实现的一部分`Should`。另一部分是类的定义`Assertion`，它是用一个值构造的，并针对该值实现了一组广泛而漂亮的断言方法。类似的方法

```
var o = Assertion(actualValue)
o.equals(expectedValue1)
o.moreThan(expectedValue2)
o.contains(expectedValue3) 
```

和保持英语语法的别名

```
var o = Assertion(actualValue)
o.equal(expectedValue1)
o.contain(expectedValue3) 
```

和懒惰神枪手的别名，比如

```
o.eql(expectedValue)
o.gt(expectedValue) //greater then
o.gte(...) //greater then or equal
//and so on... 
```

和一些只返回的连接器，（这是用测试值构造`this`的实例），比如`Assertion`

```
o.be
o.and 
```

它给了你什么？

## 如下所示的测试代码：

```
var person = getPerson();
Should.exist(person); //that's a static call, and that's easy

//but these are a member calls:
person.should.have("name","age","address","friends");  
person.name.should.equal("John");
person.age
  .should
      .be.number()
  .and.be.between(20,30);

person.address
  .should
    .be.string().and
    .startWith("\d").and
    .endWith(" st.")
  //or even
    .and.match(/^[0-9]{1,9}\s+[A-Z][a-z0-9 ]* st\.$/);

person.friends
  .should
    .be.array().and
    .be.between(3,5).and
    .containOnlyType(String); 
```

那不是很棒吗？这是简单的英语！

你可以争论缩进的美学，在哪里放置`and`，以及它们是否有必要，但除此之外 - 任何人都可以阅读或编写它：一旦你采用了*每个*对象上都存在但不会破坏地图的“应该”属性迭代 - 您可以继续链接您必须声明的关于您开始的价值的任何内容。

它可以有更多漂亮的迭代工具、反射实用程序、增加与您的对象模型相关的测试功能等等，但让我们完成第一步:)

但是为此，您需要系统中的每个对象都具有一个**不可枚举的**智能属性，称为`should`该属性，在它的***getter***函数中返回一个使用`Assertion`构造的对象`this`作为测试值。

（你什么都没有看到——等着看它给出的漂亮的拒绝信息！Yummie！！所以是的——我很乐意牺牲将属性称为“应该”的选项......并且也会很乐意放弃智能感知——至少只要是简单的英语）

所以，在评论中，**bfavaretto**给了我们第一步——我们知道如何防止枚举属性——太好了，谢谢！！

现在，我们可以让它成为一个 getter 属性，它的函数可以访问`this`?

当我完成后，我将把它放在麻省理工学院许可的一些公共回购中，让我们所有人都能玩得开心:)

帮助任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:50:55.990

您的示例实际上 90% 正确 - 但将其定义为 actionscript，而不是 javascript！

您仍然可以在 AS3 中定义原型，并且它们仍然可以像 AS2 中的原型一样工作。AS3 的唯一区别是编译器。AVM2 出于某种原因不会将原型转换为本地类（尽管我没有测试自定义类）。

原型技巧：将类转换为对象。

例如：如果您创建：

> Array.prototype.random = function():void{}

然后创建对象：

> var myProtoArray:Array = 新数组；

会发生2件事：

> myProtoArray.random() //ERROR - 这将失败，AVM2 没有将原型映射到 Array

但

> Object(myProtoArray).random() //WORKS

random() 被强制转换为 Object 类，然后映射到 Array - 我不知道为什么！

希望这会有所帮助，干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T20:16:10.383

好的，伙计们，感谢所有帮助，22+ 我将为对原始问题感兴趣的人提供一个摘要，然后 - 我将向您展示我努力的结果。

挑战由两部分组成：

**1 - 防止枚举增强（=在运行时添加）属性**

对于第一部分 - 感谢@bfavaretto，对问题级别进行了评论 -`Object.setPropertyIsEnumerable`把戏做得很好。

**2 - 使扩充属性操作一个可以访问的 getter 函数，`this`以便它可以在返回值的构造函数上使用它。**

关于第二部分 - 基本上 - 我找不到一种方法来增加（=添加）一个属性获取器到原型，并让它通过继承树在使用它的 API 的实例上运行。

无论如何，在这些限制内 - 结果如下：

## [https://github.com/osher/should.as](https://github.com/osher/should.as)

由于平台差异，移植不准确，我仍然有一些方法可以赶上原始的 should.js（如 HTTP 测试方法）但足够接近。主要区别在于

```
var o:Object = 
    { name : "Radagast"
    , color: "Brown"
    }
o.should.have.properties("name","color")
    .and.have.property("name","Radagast");
o.name.should.not.equal("Palandoo");
o.color.should.equal("Brown"); 
```

你得走了

```
o.should().have.properties("name","color")
       and.have.property("name","Radagast");
o.name.should().not.equal("Palandoo");
o.color.should().equal("Brown"); 
```

（括号 - 不可能有 getter - 所以 should 属性是一个方法，你必须自己调用它）

现在，如果您遇到困难并需要智能感知的帮助，您必须这样做：

```
var should:tdd.Should = o.color.should();
should. <ctrl+space> 
```

哪种方式可以消除刺痛，但可以窥探一下智能感应-它会有所帮助

## 重要的

还有一件事 - 你必须尽快在执行中强制应该的静态构造函数，例如，我在这里做：

```
[Suite]
[RunWith("org.flexunit.runners.Suite")]
public class my_awsome_test_suite
{
            //forces the static constructor of tdd.Should
    import tdd.Should;
    private static var s:Should = new Should(); 

    public var c1:testCase1;
    public var c2:testCase2;
    public var c3:testCase3;
    public var c4:testCase4;
    } 
```

稍后我可能会添加一些propper README.md，以及更多令人敬畏的成员函数`tdd.Should`

玩得开心

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:54:19.867

我承认我对 Javascript 的工作原理并不十分熟悉，但如果我正确理解[了 defineProperties 的](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperties)目的，那么它不仅是属性应该是什么，而且是它所属的关联命名空间（或至少AS3 认为的命名空间）。

类属性要么是预定义的且只能通过自定义 get() set() 函数修改，要么是动态的。一旦编译，它们的命名空间就不能改变（据我所知），因此任何非私有属性都是隐式可枚举的，并且无论您是否编写了 getter/setter（即：）都是可修改的`foo.a = value`。 [根据 Adob​​e...](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Object.html#propertyIsEnumerable%28%29)

> 您创建的属性是可枚举的，但内置属性通常不可枚举。

也就是说，您可以使用[describeType](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#describeType%28%29)从类中获取完整的属性列表。通过这种方式可以收集到相当详尽的信息，如果您想移植[Mozilla 重新创建的 defineProperties](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperties#Polyfill)示例，我怀疑应该满足您的需求。下面是一个仅打印属性值的示例。

```
function showProps(obj:*):void {
    var desc:XML= describeType(obj);

    // public vars
    for each (var n:XML in desc.variable){
        trace(n.@name + ": " + obj[n.@name]);
    }
    // getters
    for each (n in desc.accessor){
        try {
            trace(n.@name + ": " + obj[n.@name]);
        } catch (error:Error) {
            trace("Unable to read write-only property.");
        }
    }
} 
```

我希望这会有所帮助，但我确定我并不完全理解您要完成的工作。如果您能详细说明，将不胜感激。

# centos - ALSA - 管理异步 IO

> ID：14882433
> 
> 赞同：1
> 
> 时间：2013-02-14T19:21:12.780
> 
> 标签：centos, alsa

我有一个不断输出 PCM 数据的设备。在某些情况下，我想记录此输出。为此，我有一个等待信号记录的进程，当它收到信号时，它启动一个线程（通过`pthread_create`）。此线程打开 PCM 设备并使用`snd_async_add_pcm_handler`. 此处理程序 fn 用于`pcm_readi`获取 PCM 流中的任何可用信息并将其写入磁盘。

一切都很好 - 除了

一旦它开始运行，我的调用进程就会停止任何循环。它应该继续监听下一个发出停止录制信号的事件。看着执行，我发现它很慢，然后在 PCM 录制开始后停止。如果我不开始录制，应用程序会正常运行并继续响应。

所以看起来我有两条途径：

> 1.  发现录制过程中的差距和`usleep`（或类似的）给调用应用程序时间响应
> 2.  尝试使用其他方式退出录制

我没有使用#1 取得任何进展，所以我正在研究#2。众所周知，音频样本将以低幅度开始，然后变高一两秒钟，然后再变低。我正在使用滚动平均值来捕获这个低-高-低，并试图关闭异步 IO。

它的位置：一旦 IO 应该停止，我尝试调用`snd_async_del_handler`，但这会使应用程序崩溃，并显示一个简单的“IO 可能”消息。我也尝试过调用`snd_pcm_drop`，但这不会关闭异步 io，因此它会在下次尝试读取时崩溃。以任一顺序组合两者都会给出相似的响应。

我错过了哪些步骤？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:12:25.540

* 函数被`snd_async_`强烈弃用，因为它们不适用于所有类型的设备，难以使用，并且在实践中没有任何优势。

请注意，ALSA API[不是线程安全](http://www.alsa-project.org/main/index.php/SMP_Design)的，即对一个 PCM 设备的调用必须全部来自一个线程，或者是同步的。

你应该做的是`poll`在你的线程中有一个事件循环（使用）来处理 PCM 设备和来自主线程的退出消息。为此，PCM 设备应该在非阻塞模式下运行（使用`snd_pcm_poll_descriptors`* 函数）。要向线程发送消息，请使用任何具有`poll`文件句柄的机制，例如管道或`eventfd`.

# php - 删除 htaccess 后，cpanel 重定向仍然有效

> ID：14882439
> 
> 赞同：0
> 
> 时间：2013-02-14T19:21:34.190
> 
> 标签：php, .htaccess

我在 cpanel 中设置了重定向。然后我从服务器上删除了 htaccess 文件，但重定向仍然发生。

这个怎么可能？如何编辑使重定向发生的 htaccess 文件？我自己对 htaccess 文件的更改（我已删除）也不起作用，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:09:36.153

在 cPanel 中，您应该能够使用创建它时使用的相同工具来删除重定向。cPanel 对其文件进行编辑很有趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T08:09:34.417

删除 cPanel 中的 Redirect 条目、删除 .htaccess 文件和 ipconfig/flushdns 命令对我自己不起作用。

除了遵循上述所有 3 个步骤之外，我们还必须清除浏览器缓存以使已删除的重定向不再起作用。

# c# - C# 私有函数，IncrementArray

> ID：14882441
> 
> 赞同：1
> 
> 时间：2013-02-14T19:21:48.677
> 
> 标签：c#

有人可以用外行的术语解释这个 C# 代码的工作原理吗？

```
for (int pos = 0; pos < EncryptedData.Length; pos += AesKey.Length);
{
    Array.Copy(incPKGFileKey, 0, PKGFileKeyConsec, pos, PKGFileKey.Length);

    IncrementArray(ref incPKGFileKey, PKGFileKey.Length - 1);
}

private Boolean IncrementArray(ref byte[] sourceArray, int position)
{
    if (sourceArray[position] == 0xFF)
    {
        if (position != 0)
        {
            if (IncrementArray(ref sourceArray, position - 1))
            {
                sourceArray[position] = 0x00;
                return true;
            }
            else return false;
        }
        else return false;
    }
    else
    {
        sourceArray[position] += 1;
        return true;
    }
} 
```

我正在尝试将应用程序移植到 Ruby，但我无法理解 IncrementArray 函数的工作原理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:25:48.593

`IncrementArray`递增字节数组的所有条目，并将任何溢出添加到前一个索引，除非它已经是索引 0。整个事情看起来像是某种加密或解密代码。您可能想寻找有关使用哪种算法的其他提示，因为这种代码通常无法自我解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:50:14.673

在我看来，它就像一个大端加法算法：

假设您有一个长（64 位，8 字节）数字：

```
var bigNumber = 0x123456FFFFFFFF; 
```

但由于某种原因，我们将它作为大端格式的字节数组提供给我们：

```
// Get the little endian byte array representation of the number: 
// [0xff 0xff 0xff 0xff 0xff 0x56 0x34 0x12]
byte[] source = BitConverter.GetBytes(bigNumber);

// BigEndian-ify it by reversing the byte array
source = source.Reverse().ToArray(); 
```

因此，现在您想以当前形式向该“数字”添加一个，同时保持任何进位/溢出，就像在正常算术中一样：

```
// increment the least significant byte by one, respecting carry
// (as it's bigendian, the least significant byte will be the last one)
IncrementArray(ref source, source.Length-1);

// we'll re-little-endian-ify it so we can convert it back
source = source.Reverse().ToArray();

// now we convert the array back into a long
var bigNumberIncremented = BitConverter.ToInt64(source, 0);

// Outputs: "Before +1:123456FFFFFFFF"
Console.WriteLine("Before +1:" + bigNumber);      

// Outputs: "After +1:12345700000000"
Console.WriteLine("After +1:" + bigNumberIncremented); 
```

# qt - qt vim 不在 kubuntu 上构建

> ID：14882443
> 
> 赞同：0
> 
> 时间：2013-02-14T19:21:50.773
> 
> 标签：qt, vim, configure, ncurses, kubuntu

一个星期以来，我一直在努力尝试在我的 Kubuntu 12-10 机器上从源代码构建[qt vim 。](https://bitbucket.org/equalsraf/vim-qt/overview)

我正在使用的构建命令是：

`./configure --prefix=/usr/ --with-features=huge --with-vim-name=qvim --enable-gui=qt`

这给了我这个错误：

`checking for tgetent in -ltinfo... no checking for tgetent in -lncurses... no checking for tgetent in -ltermlib... no checking for tgetent in -ltermcap... no checking for tgetent in -lcurses... no no terminal library found checking for tgetent()... configure: error: NOT FOUND! You need to install a terminal library; for example ncurses. Or specify the name of the library with --with-tlib.`

经过多次谷歌搜索，我发现的唯一解决方案是安装 libncurses5-dev 和 ncurses5-dev，我这样做了。我还在 apt repo 中安装了每个通用的 ncurses 开发库，只是为了确保。唉，它产生了同样的错误。

安装了上述所有库后，我尝试了带有 tlib 选项的命令：

`./configure --prefix=/usr/ --with-features=huge --with-vim-name=qvim --enable-gui=qt --with-tlib=ncurses`

这产生了这个错误：

`checking --with-tlib argument... ncurses checking for linking with ncurses library... configure: error: FAILED`

我不确定我做错了什么。任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T07:48:52.467

尝试`apt-get build-dep vim`安装所有构建依赖项

# vba - 莲花笔记到VBA

> ID：14882444
> 
> 赞同：0
> 
> 时间：2013-02-14T19:22:00.477
> 
> 标签：vba, lotus-notes

我被这个问题困扰了好几天

我必须阅读 Lotus Notes 中的特定邮箱并将所有内容放入 Excel 电子表格

但到目前为止，我只能阅读默认收件箱，无法切换到其他邮箱。我真的是 VBA 新手，谁能帮我解决这个问题

这是我正在使用的代码

```
Set NSession = CreateObject("Notes.NotesSession")
   'get the name of the mailfile of the current user
DbLocation = NSession.GETENVIRONMENTSTRING("mail/mailbox", True)

'Get the notesdatabase for the mail.
Set NMailDb = NSession.GETDATABASE("mailboxer", DbLocation)
MsgBox (DbLocation) 
```

我弹出一个空的 msgbox

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T02:48:04.413

GetEnvironmentString() 读取 notes.ini 文件。我不确定那是你真正想做的事情。仅从语法来看，我认为您使用“mail/mailbox”作为您要查找的邮箱的实际路径的占位符。例如，您实际上是在尝试从“mail/jsmith.nsf”之类的内容中读取邮件。（如果我错了，并且您确实想阅读 notes.ini 文件以获取邮件文件的位置，那么您的问题是“邮件/邮箱”不是 ini 文件条目的有效键。 )

我的下一个假设是邮箱所在的 Domino 服务器称为“mailboxer”，因为这是您在 GetDatabase() 的第一个参数中放入的内容。

如果我对这些事情是正确的，那么你需要的是

```
Set NMailDb = NSession.GETDATABASE("mailboxer", "mail/mailbox") 
```

*其中“邮件/邮箱”替换为您尝试打开的邮箱的实际路径。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T11:24:47.493

一些想法：

*   如果您不必与 Notes UI 交互，请使用 Lotus.NotesSession（Lotus.NotesSession 基于 COM，而 Notes.NotesSession 基于 OLE）
*   确保运行 VBA 应用程序的工作站上的 Notes 客户端用户具有打开和读取邮箱所需的权限

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T02:26:05.227

正如 D. Bugger 所说，您需要确保将 Notes 客户端安装在您的 VB 代码将运行的同一台客户端计算机上，并且您需要确保带有 nnotes.exe 文件的文件夹和带有 notes.ini 的文件夹文件在您的环境路径中。（如果没有，在实例化 Notes.NotesSession 对象时会出现 COM 错误。

如果这有帮助，这里有一些起始代码 - 未经测试，但只是一个粗略的指南......这将遍历 Notes 邮箱数据库中的所有文档，忽略除电子邮件文档（具有表单字段 =“备忘录”）之外的任何内容并抓取一些每封电子邮件的字段。

```
Public Sub exportNotesMail(MailServer$, MailDBPath$)
    Dim mailDb As Object, doc As Object, alldocs As Object, Session As Object
    Set Session = CreateObject("Notes.NotesSession")
    Set mailDb = Session.GETDATABASE(MailServer, MailDbPath$)
    If mailDb.IsOpen = False Then mailDb.OPENMAIL
    Set alldocs = mailDb.AllDocuments
    Set doc = alldocs.GetFirstDocument
    while not (doc is nothing)
        If doc.GetItemValue("Form")(0) = "Memo" Then
            thisSubject = doc.getItemValue("Subject")(0)
            thisFrom = doc.getItemValue("From")(0)
            ' get more field values
            ' Export to Excel or wherever
        End If
        Set doc = alldocs.GetNextDocument(doc)
    Next i

    ' done
End Sub

call exportNotesMail ("MyServer", "mail\myMailFile.nsf") 
```

# r - 使用 ggplot2 在 R 中绘制时间序列，

> ID：14882452
> 
> 赞同：0
> 
> 时间：2013-02-14T19:22:38.807
> 
> 标签：r, ggplot2, time-series

我正在尝试创建一个时间序列，其中 , `x = year`,`y = cpue_wt`按站分组。我有 7 个站点：这是 1986 年至 2011 年的数据快照。我想要一个情节，有 7 条不同的线，每条线代表一个时间点。

```
year  station     cpue_wt
1986    531 3.400346954
1986    537 1.292539282
1986    538 1.097930493
1986    541 1.220753481
1986    550 1.350880331
1986    552 1.168257879
1986    555 2.012733899
1987    531 1.817902609
1987    537 2.024999967
1987    538 1.563596954 
```

这是我尝试使用的代码：

```
SST <- ggplot(Yrsta, aes(group = factor(station), x = year, y = cpue_wt, colour = station)) + geom_line() + scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")) 
```

这是我的错误：

```
Continuous value supplied to discrete scale 
```

我假设我的数据没有正确组织。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:25:44.797

由于`station`值是数字，并且您想为每条线设置特定的颜色，您应该添加`as.factor(station)`to`colour=` 以将数值转换为因子。

```
ggplot(Yrsta, aes(group = factor(station), x = year, y = cpue_wt, colour = as.factor(station))) + 
  geom_line() + 
  scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00")) 
```

# python - Python 测试传感器，然后再次运行它们直到按键

> ID：14882454
> 
> 赞同：1
> 
> 时间：2013-02-14T19:22:52.100
> 
> 标签：python, loops, time, sensors

我正在为我的小温室制作一个 python 程序来测试不同的条件。我需要它做的是：程序结束时，等待 5 分钟，然后再次运行所有测试。这是我第一个完整的 python 程序，所以如果你能把答案保留在低学习曲线区域，那将是非常有用的。

例子：

```
temp=probe1  
humidity=probe2  
CO2=probe3  

if temp==25:  
      print ("25)"  
if humidity==90:  
      print ("90")  
if CO2==1000  
      print ("1000")  

import time  
time.sleep (300) 
start again from top until keypress 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:27:59.387

您可以将您现在拥有的内容放在一个`while True` [循环](http://wiki.python.org/moin/WhileLoop)中以实现所需的结果。这将永远运行，每 5 分钟进行一次测量，直到您按 Ctrl-C 中断程序。

```
import time
while True:
    temp=probe1  
    humidity=probe2  
    CO2=probe3  

    if temp==25:  
          print ("25") 
    if humidity==90:  
          print ("90")  
    if CO2==1000  
          print ("1000")    
    time.sleep (300) 
```

但是，我想知道您的传感器准确给出您检查的值的可能性有多大。根据传感器值的精度，您可能会在数小时甚至更长时间内没有任何输出。您可能想要检查四舍五入的传感器值，例如`if round(temp) == 25`。

或者，也许您想知道什么时候`temp`是 25 或更高，您可以使用`if temp >= 25`.

另一种可能性是始终打印传感器数据，并在值高于某个阈值的情况下打印额外警告，例如：

```
import time
while True:
    temp=probe1  
    humidity=probe2  
    CO2=probe3  

    print("Temp:", temp, "degrees")
    if temp>=25:  
          print ("  Too hot!")  

    print("Humidity:", humidity, "%")
    if humidity>=90:  
          print ("  Too humid!")  

    print("CO2:", CO2, "units")
    if CO2>=1000  
          print ("  Too much CO2!")    
    time.sleep (300) 
```

# python - 使用 BeautifulSoup 和 Python 解析许多 HTML 文档

> ID：14882459
> 
> 赞同：-3
> 
> 时间：2013-02-14T19:23:09.573
> 
> 标签：python, html, beautifulsoup

我的 HTML 文本看起来像以下结构的许多实例：

```
<DOC>
<DOCNO> XXX-2222 </DOCNO>
<FIRST>Reports Former Saigon Officials Released from Re-education Camp</FIRST>
<TEXT>
Lots of text here
</TEXT>
</DOC>
<DOC>
<DOCNO> YYYY-0001 </DOCNO>
<FIRST>AP-ONU-ISRAEL -URGENT-</FIRST>
<TEXT>
 Text
</TEXT>
</DOC>
etc, etc... 
```

我需要做的是使用 DocNo、First 和 Text 对每个结构进行索引，以便稍后进行分析（标记化等）。

我正在考虑使用 BeautifulSoup，但我需要将几个东西一起提取 - 我该如何做到这一点并将它们全部链接起来？

我想要一种格式，例如：

```
[(XXX-2222, "Reports Former Saigon Officials Released from Re-education Camp", "Lots of text here"), (YYYY-0001, "AP-ONU-ISRAEL -URGENT-", "Text"), etc...) 
```

谢谢！

S。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:17:24.557

据我所知，这不是 html，所以我不会使用 Beautifulsoup。这是一个 ElementTree 方法：

```
import xml.etree.cElementTree as ET
from collections import namedtuple

xml = """
<DOC>
<DOCNO> XXX-2222 </DOCNO>
<FIRST>Reports Former Saigon Officials Released from Re-education Camp</FIRST>
<TEXT>
Lots of text here
</TEXT>
</DOC>
<DOC>
<DOCNO> YYYY-0001 </DOCNO>
<FIRST>AP-ONU-ISRAEL -URGENT-</FIRST>
<TEXT>
 Text
</TEXT>
</DOC>
"""

Record = namedtuple('DOC', 'DOCNO FIRST TEXT')

def wrapxmlfragment(fragment):
    return '<root>{}</root>'.format(fragment)

def getrecords(xml):
    """Return list of records contained in an xml string"""
    docs = ET.fromstring(xml)
    return [recordfromDOC(doc) for doc in docs.findall('DOC')]

def recordfromDOC(DOC):
    return Record(
        DOC.find('DOCNO').text.strip(),
        DOC.find('FIRST').text.strip(),
        DOC.find('TEXT').text.strip()
    )

print records
firstrecord = records[0]
print firstrecord[0]
print firstrecord.DOCNO 
```

很容易将其扩展为从文件列表中工作：

```
def getrecordsfromfiles(filelist):
    records = []
    for filename in filelist:
        with open(filename, 'rb') as fp:
            records.extend(getrecords(wrapxmlfragment(fp.read())))
    return records

records = getrecords(wrapxmlfragment(xml)) 
```

然而，这是一个非常糟糕（且重复）的问题。

# javascript - 复选框 - 检查至少一个框已被选中

> ID：14882461
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:23:15.023
> 
> 标签：javascript, checkbox

为了验证声明，我已确保复选框和数量彼此一致，但我未确保至少选择了一种产品或提供的总数量大于零。我该怎么做？

```
if (((document.form1.summer.checked) && (summer2012 <= 0)) ||
    ((document.form1.autumn.checked) && (autumn2012 <= 0)) ||
    ((document.form1.winter.checked) && (winter2012 <= 0))) 
{
    alertmsg = alertmsg + "Please enter Quantity" + "\n";
}
else if (((!document.form1.summer.checked) && (summer2012 > 0)) ||
    ((!document.form1.autumn.checked) && (autumn2012 > 0)) ||
    ((!document.form1.winter.checked) && (winter2012 > 0))) 
{
    alertmsg = alertmsg + "Please choose Product" + "\n";

} 
```

HTML：

```
<tr>
    <td align="right">Summer 2012</td>
    <td>
        <input type="checkbox" name="summer" value="Summer 2012" />
    </td>
    <td align="center" width="69">
        <div align="right">20.00</div>
    </td>
    <td width="216">
        <input name="summer2012" type="text" size="5" value="0" />
    </td>
</tr>
<tr>
    <td align="right">Autumn 2012</td>
    <td>
        <input type="checkbox" name="autumn" value="Autumn 2012" />
    </td>
    <td align="center" width="69">
        <div align="right">20.00</div>
    </td>
    <td>
        <input name="autumn2012" type="text" size="5" value="0" />
    </td>
</tr>
<tr>
    <td align="right">Winter 2012</td>
    <td>
        <input type="checkbox" name="winter" value="Winter 2012" />
    </td>
    <td align="center" width="69">
        <div align="right">20.00</div>
    </td>
    <td>
        <input name="winter2012" type="text" size="5" value="0" />
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:33:16.013

您似乎已经有一个测试来确认任何复选框必须有一个相应的（正）金额，以及第二个测试来确认任何正金额也有一个针对它的检查。

因此，您需要做的就是检查是否选中了*某个*复选框。

```
var f = document.form1;
if (f.summer.checked || f.autumn.checked || f.winter.checked) {
    // we're OK!
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:35:52.773

这就是我检查是否已选中任何复选框的方式：

```
var checkboxElements = [
    document.form1.ch1,
    document.form1.autumn,
    document.form1.winter,
    document.form1.summer
];

function anyChecked(checkboxElements) {
    for(var i = 0; i < checkboxElements.length; i++)
        if(checkboxElements[i].checked)
            return true;
    return false;
} 
```

# ios - UIWebView 的 _UIWebViewScrollView

> ID：14882466
> 
> 赞同：0
> 
> 时间：2013-02-14T19:23:32.933
> 
> 标签：ios, uiwebview

我创建了一个`UIWebView`被调用的实例`myWebView`。我填充`myWebView`了来自 loadHTMLString 的内容，添加了几个 UIImageViews 和 UIViews。它按预期工作：UIImageViews 和 UIViews 都位于来自 html 字符串的 webview 内容之上。

`myWebView` 然后我使用`NSKeyedArchiver`and归档和取消归档`NSKeyedUnarchiver`。取消归档后，只有 html 字符串内容可见。所有其他 UIViews 和 UIImageViews 被移到后面。所以它们是不可见的。归档前和取消归档后的 NSLog`myWebView.subviews`显示，_UIWebViewScrollView 已从子视图中的第一个对象移动到最后一个对象。请注意，仅更改了 _UIWebViewScrollView 顺序。

不确定这是否是 SDK 设计的，但为了恢复视图顺序并使它们正常可见，我这样做了：

```
[myWebView sendSubviewToBack:[myWebView.subviews lastObject]]; 
```

问题：这样做是否会违反 Apple 的任何规则，因为我不确定 _UIWebViewScrollView 是否被视为 Apple 的私人物品。但是因为我没有碰那个_UIWebViewScrollView。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:28:44.160

好吧，就规则而言，你很好。

但是：由于`UIWebViewScrollView`是 的内部成员`UIWebView`，如果他们`UIWebView`在不同的 iOS 版本中更改工作方式，您的代码可能会搞砸。

为了更安全一点，您应该尝试在您添加的每个子视图上设置标签，然后执行以下操作：

```
[myWebView bringSubviewToFront:[myWebView viewWithTag:100]];
[myWebView bringSubviewToFront:[myWebView viewWithTag:101]];
[myWebView bringSubviewToFront:[myWebView viewWithTag:102]];
... etc (remember to use the tags that you used for your subviews) 
```

另一方面，弄乱`UIWebView`可能会导致以后出现麻烦，可能还有其他方法可以完成您想要做的事情，风险较小的方法

# zend-framework2 - Zend Framework 2 - 应用程序/模块/服务管理器 - Oh My

> ID：14882469
> 
> 赞同：6
> 
> 时间：2013-02-14T19:23:40.140
> 
> 标签：zend-framework2, zend-db, zend-log

作为一名长期的 Zend Framework 1 开发人员，我刚刚开始学习 Zend Framework 2。我在理解新术语时遇到了一些麻烦。

回到 ZF1，如果我想创建一个对应用程序来说是全局的记录器，我会将配置添加到 application.ini 文件中，并且引导程序会将其初始化为资源（我希望我说的是对的）。因此，我可以从我的任何模块控制器通过引导资源访问记录器。

进入 ZF2，模块有点不同，它们是独立的，但我对它们如何与应用程序交互有点困惑。在我看来，这就是 ServiceManager 发挥作用的地方。我的目标是让我的模块（不是控制器，而是模块本身）检查应用程序是否定义了一个记录器，如果有，则在整个模块中使用该记录器。如果应用程序没有定义记录器，我希望模块为模块范围的日志记录定义记录器。

这个问题也与数据库有关，假设我想让应用程序定义数据库连接的逻辑，而我希望模块定义它所需的表的逻辑。我该如何配置它，以及如何/在哪里判断应用程序中是否已经定义了数据库资源。

注意：我已经浏览了 Rob Allen 的快速入门（相当多的信息，也是迄今为止我发现的唯一一个不为人知的资源），以及 ZF2（阅读文档），并且已经用谷歌搜索了很多。我发现，当涉及到拼图的某些部分“去哪里”时，信息通常非常模糊。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T10:05:48.857

您从 Zend Framework 1.x 了解到的是“应用程序资源”。

“应用程序资源”的概念在 Zend Framework 2 中被所谓的[“服务”](http://en.wikipedia.org/wiki/Domain-driven_design#Building_blocks_of_DDD)取代（[此处](http://blog.evan.pro/introduction-to-the-zend-framework-2-servicemanager)为介绍）

另一个变化是模块本身。在 ZF1 中，模块主要是处理某些请求的应用程序的子部分。这在 ZF2 中不再适用：如果您的模块定义了一个服务或控制器，那么现在所有应用程序都可以访问该服务或控制器。Gary Hockin 对 ZF1 和 ZF2 之间的一些[区别进行](http://blog.hock.in/zf2-for-zf1-users-part-1)了很好的介绍。

但无论如何，模块*不是*独立的。它们应该在隔离的环境中开发，并且依赖尽可能少，但它们提供了影响所有应用程序的交叉关注功能。

对于您的记录器的具体情况，我建议您的模块始终定义一个记录器并使用它。有条件地定义记录器的方法如下：

```
class MyModule
{
    public function onBootstrap($e)
    {
        // $e->getTarget() is the \Zend\Mvc\Application
        $sm = $e->getTarget()->getServiceManager();

        if (!$sm->has('some-logger-name')) {
            $sm->setFactory('some-logger-name', function ($sl) {
                return new MyLogger($sl->get('some-db'));
            });
        }
    }
} 
```

然后，您就可以在所有应用程序中使用您的“一些记录器名称”。

另一种方法是只定义记录器服务并让其他模块或配置稍后覆盖它：

```
class MyModule
{
    public function getConfig()
    {
        return array(
            'service_manager' => array(
                'factories' => array(
                    'some-logger-name' => 'My\Logger\Factory\ClassName'
                ),
            ),
        );
    }
} 
```

使用 实现相同`getServiceConfig`，它不太灵活且无法缓存，但具有更高的优先级`getConfig`（允许覆盖），并且还允许您将服务工厂定义为闭包：

```
class MyModule
{
    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'some-logger-name' => function ($sl) {
                    return new MyLogger($sl->get('some-db'));
                },
            ),
        );
    }
} 
```

然后，您甚至可以定义一个必须用于决定使用哪个记录器（服务名称）的配置键。

模块和配置的概念是“最后一个模块获胜”，因此您可以`'some-logger-name'`在模块中或在它之前加载的任何模块中定义服务。

相同的概念也适用于您的数据库连接。

如您所见，转向服务已经为您提供了一定程度的自由。

请记住，并不是“应用程序”为您定义了一些东西：模块定义了您的服务/配置/事件等……正在运行的应用程序是所有这些东西的组合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-15T22:54:48.617

我认为，尤其是在日志记录的情况下，可能有一种比使用`ServiceManager`. ZF2 本质上是一个事件驱动框架，支持这种事件驱动架构的功能可以为我们所用。日志记录就是一个很好的例子。您只需附加一个可以从应用程序中的任何位置触发的记录器事件，而不是定义工厂。

在`log`您的`Module.php`：

```
public function onBootstrap(MvcEvent $e)
{
    //setup some $logger

    $sharedManager = $e->getApplication()->getEventManager()->getSharedManager();

    $sharedManager->attach('*', 'log', function($e) use ($logger) {
        /** @var $e MvcEvent */
        $target   = get_class($e->getTarget());
        $message  = $e->getParam('message', 'No message provided');
        $priority = $e->getParam('priority', Logger::INFO);
        $message  = sprintf('%s: %s', $target, $message);
        $logger->log($priority, $message);
    });
} 
```

然后从应用程序中的*任何位置触发它，例如控制器：*

```
$this->getEventManager()->trigger('log', $this, array(
    'priority' => \Zend\Log\Logger::INFO, 
    'message' => 'just some info to be logged'
)); 
```

# ruby-on-rails - Rails 单选按钮选项哈希

> ID：14882470
> 
> 赞同：0
> 
> 时间：2013-02-14T19:23:51.497
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的观点：

```
<%= radio_button_tag "recommendation_ratings[#{rec.recommendation.id}][rating]", '3'%> 
```

在我的控制器中，我解析出这些值：

```
 input = params[:recommendation_ratings].values
 input.each do |mini_params|
 rating = mini_params[:rating]
 recommendation_id = mini_params[:recommendation_id] 
```

使用 rating 变量，我在同一个控制器操作中创建了一个新记录：

```
rate = Rating.new(
    :rating => rating,
    :label => rating_label) 
```

创建新记录时，如何为 rating_label 分配评级。例子：

```
if rating == 1 rating_label = "Fair" 
```

我应该在我的控制器中执行此操作，还是可以将 rating_label 作为另一个属性添加到我的 radio_button_tag 中？

**更新：**

我在控制器中尝试了 case 语句，但得到了 NoMethodError "Undefined Method Rating"

```
 rating case
      when rating == 1
        rating_label = "Bad"
      when rating == 2
        rating_label = "Fair"
      when rating == 3
        rating_label = "Good"
      else rating == 0
        rating_label = "N/A"
      end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:47:53.277

将您的视图代码从 using 重构`radio_button_tag`为`fields_for`块：

```
<%= fields_for :recommendation_ratings do |f| %>
  <% f.hidden_field :id, rec.recommendation.id %>
  <% f.radio_button :rating, 3 %>
<% end %> 
```

将您的控制器代码更改为：

```
selected_rating = params[:recommendation_ratings]
rating = selected_rating[:rating]
recommendation_id = selected_rating[:id] 
```

并在某处添加一个辅助方法：

```
def rating_label(rating)
  %w{N/A Bad Fair Good}[rating.to_i]
end 
```

现在你可以`Rating`像这样创建一个新对象：

```
rate = Rating.new(
  :rating => rating,
  :label => rating_label(rating)) 
```

# css - CSS：“p div.myclass”是一个有效的选择器吗？

> ID：14882473
> 
> 赞同：0
> 
> 时间：2013-02-14T19:24:02.917
> 
> 标签：css, css-selectors

是`p div.myclass`有效的 CSS 选择器吗？我想选择 div.myclass 但只有当它是 p 的后代时。

```
<body>
 <div class="myclass">Do not select</div>
  <p>
    <any>...
      <div class="myclass">Select this element to set background & border
        <any>Other stuff may be here</any>
      </div>
    </any>
   </p>
  </div> <!-- added this after question was answered -->
</body> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:25:35.427

这是一个有效的选择器，是的；但 a`div`不是元素的有效子`p`元素。所以 CSS 是有效的，但是您应用该选择器的 HTML 是无效的。

顺便说一句，除了嵌套`div`在 中之外`p`，您还有一个未封闭`div`的包装`p`，其后是`</body>`标签。所以你的 HTML 是双重无效的，因为标签必须以打开它们的相反顺序关闭。

附录，正如评论中提出的（我本来不想费心添加这个，而是计划专注于 CSS 的语法），浏览器（当然是 Chromium 24/Ubuntu 12.10）在构建时“拯救”你的 HTML DOM，所以你从这里开始：

```
<p>
    <any>...
        <div class="myclass">Select this element to set background & border
            <any>Other stuff may be here</any>
        </div>
    </any>
</p> 
```

对于一个看起来像这样的 DOM（同样，在 Chromium 24/Ubuntu 12.10 中）：

```
<p>
    <any>...</any>
</p>
<div class="myclass">Select this element to set background &amp; border
    <any>Other stuff may be here</any>
</div>
<p></p> 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/dWz6M/)。

因此，如果您遇到的问题以及您提出问题的原因是[CSS 没有选择/设置元素样式](http://jsfiddle.net/davidThomas/dWz6M/1/)，原因仅仅是因为您使用了无效的 HTML，并且浏览器在构建时更改了您的 HTML （有效的）DOM，这意味着选择器不再匹配您最初的目标。

这就是为什么应该遵循 HTML 有效性规则的原因，它使它更易于使用（无论是今天，还是将来您或其他人必须重新访问时）。

哦，最后，`&`字符*也不*应该直接在 HTML 中使用，它应该以某种方式编码，例如`&amp;`，因为该`&`字符是 HTML 字符实体代码中的第一个字符。所以...您创建了*三重*无效的 HTML。

# vbscript - VBS 无法创建文件夹

> ID：14882476
> 
> 赞同：0
> 
> 时间：2013-02-14T19:24:13.733
> 
> 标签：vbscript

出于某种原因，以下代码对我不起作用...我正在尝试学习 VBS，并且我一直在拼凑一些来自 Google 资源的代码。我不知道为什么我不能让它工作。

```
Option Explicit
Dim objNetwork, objComputer
Dim objFSO, objFSOText, objFolder, objFile
Dim strDirectory, strFile, MakeObject

strDirectory = "C:\test"
Set objFSO = CreateObject("Scripting.FileSystemObject")

If objFSO.FolderExists(strDirectory) Then
Wscript.Echo strDirectory & " already exists"
Else
Wscript.Echo "The folder " & strDirectory & " does not exist"
Wscript.Echo "The folder " & strDirectory & " has just been created"
End if

Wscript.Quit 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:38:29.633

我认为 Ekkehard.Horner 想说的是：

如果将以下内容添加到脚本中，它将起作用。菜鸟的错误，但干得好，继续努力..它最终会有意义！

> 设置 objFolder = objFSO.CreateFolder(strDirectory)

这是您的脚本，其中包含添加的代码以及添加它的注释...

```
Option Explicit
Dim objNetwork, objComputer
Dim objFSO, objFSOText, objFolder, objFile
Dim strDirectory, strFile, MakeObject

strDirectory = "C:\test"
Set objFSO = CreateObject("Scripting.FileSystemObject")

If objFSO.FolderExists(strDirectory) Then
Wscript.Echo strDirectory & " already exists"
Else
Wscript.Echo "The folder " & strDirectory & " does not exist"
'Below is the added line
Set objFolder = objFSO.CreateFolder(strDirectory)
Wscript.Echo "The folder " & strDirectory & " has just been created"
End if

Wscript.Quit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:31:29.633

忽略您是否（或应该）允许在 C:\ 中创建文件夹的问题 - 没有类似的东西

```
objFSO.CreateFolder strDirectory 
```

（也许在您分支中的这两个`WScript.Echo`s之间）什么都不会发生。`Else`

# python - 在 Windows 7 上安装 rpy2

> ID：14882477
> 
> 赞同：28
> 
> 时间：2013-02-14T19:24:15.480
> 
> 标签：python, windows, r, installation, rpy2

我正在尝试在我的计算机上安装 rpy2，但我无法做到。

我下载了源包，并尝试使用命令安装 Rpy2 (rpy2-2.3.2) `python setup.py install`。这是结果：

```
running install
running build
running build_py
running build_ext
"C:\PROGRA~1\R\R-215~1.2\bin\R" CMD config --ldflags
"C:\PROGRA~1\R\R-215~1.2\bin\R" CMD config --cppflags
"C:\PROGRA~1\R\R-215~1.2\bin\R" CMD config LAPACK_LIBS

returned an empty string.

"C:\PROGRA~1\R\R-215~1.2\bin\R" CMD config BLAS_LIBS

returned an empty string.

Configuration for R as a library:
    include_dirs: ('C:/PROGRA~1/R/R-215~1.2/include/i386', 'C:/PROGRA~1/R/R-215~1.2/include')
    libraries: ('R',)
    library_dirs: ('C:/PROGRA~1/R/R-215~1.2/bin/i386',)
    extra_link_args: ()
   # OSX-specific (included in extra_link_args)
    framework_dirs: ()
    framework: ()
building 'rpy2.rinterface._rinterface' extension
creating build\temp.win32-2.7
creating build\temp.win32-2.7\Release
creating build\temp.win32-2.7\Release\rpy
creating build\temp.win32-2.7\Release\rpy\rinterface
C:\Rtools\gcc-4.6.3\bin\gcc.exe -mcygwin -mdll -O -Wall -DWin32=1 -I.\rpy\rinterface -IC:\Python27\include -IC:\Python27\PC -IC:/PROGRA~1/R/R-215~1.2/include/i386 -IC:/PROGRA~1/R/R-215~1.2/include -c .\rpy\rinterface\_interface.c -o build\temp.win32-2.7\Release\.\rpy\rinterface\_rinterface.o
cc1.exe: error: unrecognized command line option '-mcygwin'
error: command 'gcc' failed with exit status 1 
```

我也尝试过成功`build install`和`easy_install`失败。我有 R 2.15.2、Python 2.7.2 和 Windows 7（32 位）。

我究竟做错了什么？

PS.如果我粘贴该命令，结果是：

cygwin警告：

```
MS-DOS style path detected C:\PROGRA~1\R\R-215~1.2\bin\config.sh
Preferred POSIX equivalent is: /cygdrive/c/PROGRA~1/R/R-215~1.2/bin/config.sh
CYGWIN environment variable option "nodosfilewarning" turns off this warning.
Consult the user's guide for more details about POSIX paths:
    http://cygwin.com/cygwin-ug-net/using.html#using-pathnames 
```

-LC:/PROGRA~1/R/R-215~1.2/bin/i386 -lR

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-10-07T04:08:08.233

好的。根据以前的经验，我发现关于如何在 Windows 上安装 rpy2 的说明并不多。我知道它没有得到官方支持，但实际上并不难。在几个步骤中，我将展示我所做的事情，也许其他人可以效仿。

这些指令很可能仅适用于 Python 2.7+ 和 R 3.2+，但可能适用于 R 3.0+。我正在将我使用过的路径放在我的系统上。**确保相应地修改路径：**

首先，在尝试这些步骤之前，确保所有以前的 rpy2 安装都是 UNINSTALLED （并且在安装之前显然有 R 3.2+）。

1.  [从这里](http://www.lfd.uci.edu/~gohlke/pythonlibs/)下载 r2py 的 .whl 文件
2.  `pip install [put .whl filename here]`使用（在命令行中）从下载文件的目录安装 .whl 文件
3.  添加类似于`C:\Program Files\R\R-3.2.0\bin`PATH 环境变量的路径
4.  创建一个`R_HOME`系统变量，其值类似于：`C:\Program Files\R\R-3.2.0`
5.  使用您的用户名创建`R_USER`系统变量
6.  创建一个`R_LIBS_USER`系统变量，其中包含安装/将安装外部 R 包的文件夹的路径。

而已。打开命令提示符并输入命令`R`。这应该会启动一个 R 会话并显示版本信息。

现在打开 python 并运行这一行，看看事情是否成功：

```
import rpy2.robjects as robjects 
```

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-09-02T18:57:49.180

[我刚刚使用来自http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2](http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2)的二进制安装程序在 Windows 8.1 64bit 上成功安装了 rpy2 。通常只下载一个二进制文件而不是尝试在 Windows 中编译一个包要容易得多。

此外，您应该在安装 rpy2 二进制文件之前设置`R_HOME`环境变量（在我的情况下为 to ）。`C:\Program Files\R\R-3.1.1`否则，`RuntimeError: R_HOME not defined.`当您尝试导入 rpy2 时会出错。（感谢 rpy2 的[R_HOME 错误](https://stackoverflow.com/questions/17573988/r-home-error-with-rpy2)）

最后，如果你想在 IPython 中使用它，请确保使用`%load_ext rpy2.ipython`而不是。`%load_ext rmagic`它是rpy2 版本 2.4.0中的[新功能之一。](http://rpy.sourceforge.net/rpy2/doc-2.4/html/changes.html?highlight=ri2py#new-features)

（感谢[IPython notebook 和 rmagic/rpy2: cannot find module ri2py (OSX 10.8.5, python 2.7, R 3.1)](https://stackoverflow.com/questions/23912243/ipython-notebook-and-rmagic-rpy2-cannot-find-module-ri2py-osx-10-8-5-python-2)）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-18T13:35:57.433

我通常也没有成功让 Rpy2 在 Windows 上工作。经过几个小时从预编译的二进制文件[2.3.4.win-amd64-py2.7](http://www.lfd.uci.edu/~gohlke/pythonlibs/)中修改 R2.15 和 Rpy2 后，我遵循[了这个问题](https://stackoverflow.com/a/13200185/789215)，并安装了[pyper](https://pypi.python.org/pypi/PypeR/1.1.0)。在获得支持之前，这可能对您有用。我很想在 Windows 和 IPython notebook (%load_ext rmagic) 上看到 Rpy2，但我不能再花时间在它上面了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-22T07:52:21.573

按照上面的答案，这对我有用

系统：Win 7-64，Python 3.6，

# 1.安装你需要的R和包

# 2.设置`R_HOME`和`R_USER`,作为环境变量

```
R_HOME = D:\Program Files\R\R-3.4.1
R_USER = Administrator 
```

用户名可以`echo %username%`在cmd中获取

# 3.下载`rpy2`安装

[从http://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)下载 rpy2

检查它的路径，并将其安装在 cmd 中，如`pip install rpy2-2.8.6-cp36-cp36m-win_amd64.whl`

# 4.创建一个笔记本，看看它是否有效

```
import rpy2.robjects as robjects

# test : evaluating R code
robjects.r('''
        # create a function `f`
        f <- function(r, verbose=FALSE) {
            if (verbose) {
                cat("I am calling f().\n")
            }
            2 * pi * r
        }
        # call the function `f` with argument value 3
        f(3)
        ''') 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-02T23:50:20.020

*编辑*最后我设法让它工作！！！见下文：

我一直在努力让这个工作，但仍然没有完全弄清楚。我发现错误是

> 'sh' 不是内部或外部命令、可运行程序或批处理文件

是由于缺少 mingw 和 Rtools（以及其他类似 unix 的帮助程序）造成的。( [http://sourceforge.net/p/rpy/mailman/message/26549197/](http://sourceforge.net/p/rpy/mailman/message/26549197/) )

我通过安装 Rtools（[http://cran.r-project.org/bin/windows/Rtools/](http://cran.r-project.org/bin/windows/Rtools/)）和 mingw（[http://sourceforge.net/projects/mingw-w64/](http://sourceforge.net/projects/mingw-w64/)）通过了这个阶段（但是自从sourceforge.net 上的 mingw-w64 项目正在迁移到 mingw-w64.org，我建议使用[mingw-w64.org](http://mingw-w64.org)）

我通过了 R.exe CMD config --ldflags 错误但被卡住了

> TypeError：“NoneType”类型的对象没有 len()

错误。我还在寻找解决方案！！

希望这在某些时候对某人有所帮助。

**更新：**所以似乎有几个与安装相关的问题。setup.py 无法找到正确的 R 版本并且编译器有问题。

所以，进行的方式：

1.  [从https://pypi.python.org/pypi/rpy2](https://pypi.python.org/pypi/rpy2)下载源代码。
2.  更新您的环境变量 - 在用户变量中
    *   PATH ：将路径附加到您的 R 安装，例如 ;C:\Program Files\R\R-3.0.2\bin\x64
    *   R_HOME ：一个新变量，其路径为 R: C:\Program Files\R\R-3.0.2
    *   R_USER : 用户用户名，例如 john
3.  安装 Rtools ( [http://cran.r-project.org/bin/windows/Rtools/](http://cran.r-project.org/bin/windows/Rtools/) ) 和 mingw ( [http://mingw-w64.org](http://mingw-w64.org) )
4.  前123行左右

    > return self._version 我添加了 self._version = [3, 0] 以强制版本为 3.0（可能有人可以更好地解决这个问题）

5.  在 python27/lib/distutils 或在我的情况下 C:\Users(user_name)\AppData\Local\Continuum\Anaconda\Lib\distutils 注释行 227 中的文件 unixccompiler.py

> 编译器 = os.path.basename(sysconfig.get_config_var("CC")) 与 # (#compiler = os.path.basename(sysconfig.get_config_var("CC")))

并添加行

> 编译器 = 'gcc'

其他一些事情 - 使用命令提示符 cmd 进行安装。利用

> python setup.py 构建安装

安装 Rtools 和 mingw 接受所有默认值。在 Rtools 中选择

> 额外构建 64 位 R

和

> 编辑系统路径

而已！！让它工作..

希望这可以帮助！！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-25T09:19:01.007

在 Anaconda 上，您可以使用以下方式安装：

```
conda install --channel https://conda.anaconda.org/Richarizardd rpy2 
```

或者，可以尝试：

```
conda install -c r rpy2 
```

也可以参考：

```
https://github.com/conda-forge/rpy2-feedstock 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-15T06:23:33.300

安装脚本`setup.py`告诉运行时遇到问题

`"C:\PROGRA~1\R\R-215~1.2\bin\R" CMD config --ldflags`

打开终端，粘贴该命令，检查错误是什么。

当您使用输出编辑问题时，问题似乎是在从`python setup.py install`空字符串运行该命令作为子进程时返回，而从终端运行命令时有输出。我还从涉及 cygwin 的终端的输出中读取。可能这是问题吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-22T10:05:42.560

我不确定是否有人仍在关注讨论，但无论如何，我试图让 rpy2 工作的目的是为了能够让它在我的 Ipython 笔记本中工作。如果其他人也想这样做，我建议使用 IRkernel，它可以像蛋糕一样顺利安装（制作精良的蛋糕）。这是完成它的资源。我用过它，它就像一个魅力。

基本上你需要运行的是：

```
install.packages(c('rzmq','repr','IRkernel','IRdisplay'),repos = c('http://irkernel.github.io/', getOption('repos')))

IRkernel::installspec() 
```

如果您发现任何问题，这里是资源：

[https://github.com/IRkernel/IRkernel](https://github.com/IRkernel/IRkernel)

[http://blog.revolutionanalytics.com/2015/09/using-r-with-jupyter-notebooks.html](http://blog.revolutionanalytics.com/2015/09/using-r-with-jupyter-notebooks.html)

[http://www.michaelpacer.com/maths/r-kernel-for-ipython-notebook](http://www.michaelpacer.com/maths/r-kernel-for-ipython-notebook)

高温高压

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-04T01:57:55.600

查看我为这个问题制作的这个安装文档。[https://www.academia.edu/12178754/rpy2Install](https://www.academia.edu/12178754/rpy2Install)

它是特定于 ArcGIS 设置的目录，但可以快速移植

# jquery - 文本框首字母大写的问题

> ID：14882481
> 
> 赞同：0
> 
> 时间：2013-02-14T19:24:35.163
> 
> 标签：jquery, textbox, capitalize

我正在使用以下代码将输入到文本框中的第一个字母大写。问题是当您切换到另一个文本框，然后返回并输入一些内容时，它不会删除那里的内容.. 它会附加您输入的内容。

这可以解决吗？

```
$(function () {
    $('.userBox').on('DOMAttrModified textInput input keypress paste focus', 
      function (e) {
         $(this).val($(this).val().slice(0, 1).toUpperCase() + 
                $(this).val().slice(1));
      });
}); 
```

演示：http: [//jsfiddle.net/VBXbz/8/](http://jsfiddle.net/VBXbz/8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-25T06:07:56.903

```
<script type="text/javascript" language="javascript">
    function Capitalize(id) {
        var txt = document.getElementById(id);
        txt.value = txt.value.replace(/\w\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });
    }
</script> 
```

萨拉特@f1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:29:29.063

我只是将焦点绑定到另一个将清除输入字段内容的函数。像这样：

```
$('.userBox').on('focus', function (e) {
    $(this).val("");
}); 
```

然后你基本上有[http://jsfiddle.net/KWRef/](http://jsfiddle.net/KWRef/)。

除非我错过了你想提出的一些观点？

# forms - 为什么 CakePHP 2.3.0 会在我的表单发布值中添加“1”？

> ID：14882484
> 
> 赞同：0
> 
> 时间：2013-02-14T19:24:46.340
> 
> 标签：forms, cakephp, post

我正在使用 cakephp 2.3.0。我在手册中搜索了很长时间，但没有找到答案。另外，我已经搜索了互联网，但仍然没有找到我要找的东西。所以，我在这里发布我的问题。请注意，我对 cakephp 还很陌生。

设想：

*   我有一个包含两个字段的简单表单：活动和邮政编码。
*   我在表单上使用 POST。
*   当我在这些字段中输入一些值并提交时，我会回显那些“发布”值/参数并显示在浏览器屏幕中。我输入的内容可以在屏幕上看到，但数字“1”会添加到我在表格中输入的内容的末尾。
*   这是一个例子。我以“walk”和“44555”的形式输入这些值。然后我点击“提交”。该帖子转到我的控制器的操作，然后调用我的视图。我的视图显示在浏览器屏幕上，我回显了那些“发布”值。屏幕上的结果是“walk1”和“445551”。
*   示例 #2：如果我按照上述步骤操作并且不在表单中输入任何值（稍后我将添加错误检查），我在浏览器屏幕上看到的是“1”和“1”。

我无法弄清楚为什么将“1”的值添加到表单的 POST 值中？如果有人试图提供帮助，我很乐意在这篇文章中包含任何其他额外的 php 代码。

这是我的 FORM 代码（在我看来）......我知道有 DIV 助手，但我稍后会谈到：

```
echo $this->Form->create(null, array('url' => array('controller'=>'activities', 'action'=>'results'))); ?>
        <div class="box1" style="position:relative; top:10px; left:10px; float: left;"> 
            Search here.... <br>
            <hr>

                <?php echo $this->Form->input('activityName', array('size'=>'30', 
                                            'label'=>'Activity Name:', 'value'=>'i.e. walking, etc.'));?>
                <br>            
                <?php echo $this->Form->input('zip', array('size'=>'7', 'label'=>'Postal Code:')); ?>
            <br>
        </div>
    <div class="box1" align="right"> 
                <?php echo $this->Form->end('Go Search');?>
        </div> 
```

这是我的控制器代码：

```
<?php

    class ActivitiesController extends AppController {

        public $helpers = array('Html', 'Form');

        public function index() {
            //other code....            
        }

        public function results() {
            $this->layout = 'second';    
            $name = $this->request->data['Activity']['activityName'];
            $pCode = $this->request->data['Activity']['zip'];
            $this->set('theName', $name);
            $this->set('theZip', $pCode);
            $this->set('results', $this->Activity->
                    find('all', array('conditions' => array('name' => $name, 'postal_code' => $pCode)))); 

            $this->set('title_for_layout', 'Results');
            $this->render();
        }
    }       
?> 
```

我的最终视图代码。我省略了一些代码......只是显示了重要的部分：

```
<div style="position:relative; top:10px; left:5px; "> 
    <?php echo print_r($theName); ?>
        <br>
    <?php echo print_r($theZip); ?> 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T20:41:11.760

`1`来自打印其返回值为（`print_r()`即`true`）`1`。

换句话说：你不应该做`echo print_r()`，只是做`print_r()`。该功能自行处理打印，您不必手动打印结果。

（此外，`print_r()`几乎从来都不是打印值的最佳选择，除非在调试时，即使这样 CakePHP`debug()`更合适。）

# objective-c - UIViewController 在 segue 后不显示背景

> ID：14882485
> 
> 赞同：1
> 
> 时间：2013-02-14T19:24:47.590
> 
> 标签：objective-c, xcode, storyboard, segue, uivewcontroller

故事板：

![在此处输入图像描述](../Images/f003115858e8bb2eb79b29dec4a4a076.png)

使用视图（连接到标签栏控制器）之前的模拟器显示正确的背景：

![在此处输入图像描述](../Images/9c22e19be94082ad6b89376b92a3c3ef.png)

点击任何图标都会导致推送转场，但背景是白色的，而应该是蓝色的： ![在此处输入图像描述](../Images/ec308c691c8ee8a173137f5ed1571141.png)

我正在使用 AQGridview，segue 的代码是：

```
-(void)gridView:(AQGridView *)gridView didSelectItemAtIndex:(NSUInteger)index
{
    [self performSegueWithIdentifier:@"mySegue" sender:self];
} 
```

谁能告诉我我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:36:48.647

您是否设置了序列标识符？

![您是否设置了序列标识符？](../Images/683408d60fc65fb8d6d6a84c8945a8f6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:17:21.673

事实证明这是一件相当愚蠢的事情，但我会解释它，因为这是我可以想象的发生在任何像我一样愚蠢的人身上的事情。（一定*有人*像我一样愚蠢……）

我之前在目标 ViewController 的 viewDidLoad 方法中添加了一个 webView。webView 的默认颜色是白色，它覆盖在背景颜色之上，所以我看不到它。

删除了引用 webView 的代码，一切都好起来了。

是的，我现在感觉很愚蠢。

# r - 如何使用 knitr 将环境传递给 Rcpp 块？

> ID：14882486
> 
> 赞同：3
> 
> 时间：2013-02-14T19:24:49.710
> 
> 标签：r, knitr, rcpp

我正在尝试采用以下代码并将其转换为 knitr 块（从 Rcpp 示例中借用）：

```
library(Rcpp)
library(inline)

openMPCode <- '
   std::vector<double> x = Rcpp::as<std::vector< double > >(xs);
   size_t n = x.size();
   #pragma omp parallel for shared(x, n)
   for (size_t i=0; i<n; i++) {
     x[i] = ::log(x[i]);
   }
   return Rcpp::wrap(x);
'

## modify the plugin for Rcpp to support OpenMP
settings <- getPlugin("Rcpp")
settings$env$PKG_CXXFLAGS <- paste('-fopenmp', settings$env$PKG_CXXFLAGS)
settings$env$PKG_LIBS <- paste('-fopenmp -lgomp', settings$env$PKG_LIBS)
funOpenMP <- rcpp(signature(xs="numeric"), body=openMPCode, settings=settings) 
```

本质上，主要问题是确保将环境传递到 knitr 块中，以便在编译代码时正确设置`PKG_LIBS`and 。块的外观`PKG_CXXFLAGS`示例：`knitr`

```
```{r engine='Rcpp'}
#include <Rcpp.h>
using namespace Rcpp;

// [[Rcpp::export]]
NumericVector openmp_log( NumericVector x ) {
  size_t n = x.size();
  #pragma omp parallel for
  for( size_t i=0; i < n; i++ ) {
    x[i] = ::log10( x[i] );
  }
  return x;
}
``` 
```

如果我理解正确，knitr 使用`sourceCpp`块中的任何内容来编译它，并将指定的选项传递`engine.opts`给`sourceCpp`. 因此，我想有两种可能的途径：

1.  设置`engine.opts=list(env=...)`以便通过适当的环境；但是，尝试此操作时出现错误（形式参数“env”与多个实际参数匹配）。

2.  A hook / custom chunk option could be used to set the environment, but I'm not sure how this could be done exactly.

This is with knitr 1.0.11 and Rcpp 0.10.2.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T05:41:36.337

I did not realize users would pass a custom environment to the `Rcpp` engine, so I passed a default environment to the `env` argument in `sourceCpp()`. Now I [have removed](https://github.com/yihui/knitr/commit/b600f7fe8cfd265726f3d9e8ae0c2c1c361ce162) the restriction. You can install the [development version](https://github.com/yihui/knitr#readme) on Github.

`PKG_LIBS` mentioned by Dirk should be a different problem here.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:17:19.147

We happen to have realized today that the `PKG_LIBS` treatment is buggy: overwrites instead of attempts. So I fear this currently does not work with Rcpp Attributes.

You could switch to using a package, or setting your compile etc flags somewhere else.

*Edit Feb 16* This is now fixed in SVN.

# git - 推送到远程分支时出现奇怪的合并消息

> ID：14882487
> 
> 赞同：0
> 
> 时间：2013-02-14T19:24:51.160
> 
> 标签：git, github

我们正在与几个人一起开展一个项目，并且具有以下分支结构（在服务器上）：

```
master
staging
contributions 
```

我已经要求人们在贡献分支中工作，并要求他们像这样克隆他们的存储库：

```
git clone repository_address -b contributions 
```

我的印象是上述命令将克隆存储库并切换到贡献分支。我假设上面的命令也在创建一个指向远程分支的本地跟踪`contributions`分支。

这是奇怪的部分：当有人推送到存储库时，GitHub 上的历史记录与预期的一样（您只会看到提交列表）。但是，如果在一个人在另一个人推送之后推送之前，您会看到两条提交消息，用于稍后的推送，形式如下：

![在此处输入图像描述](../Images/a9362e1330cdf79dd98790356af929b9.png)

这对我来说似乎很反直觉，因为消息说“将分支贡献合并为贡献”。此外，此类提交的日志仅显示自该人上次拉取以来已添加到分支的所有文件。

上面发生的事情是 P 在推送之前做了一个拉动，然后我自己，因为他在推送之前的变化，我不得不做一个拉动，我们俩都得到了一个额外的提交，上面写着“合并”。

我们的设置有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:08:30.577

当您执行 a`git pull`时，您执行两个命令：`git fetch`和`git merge`. 由于`git merge`，这些合并提交将显示在您的日志中。为避免这种情况，您可以使用`git rebase`代替`git merge`. 为此，最简单的解决方案是使用`git pull --rebase`.

# zend-framework2 - Zend Framework 2 设置 Zend\InputFilter setRequired()

> ID：14882488
> 
> 赞同：1
> 
> 时间：2013-02-14T19:24:53.317
> 
> 标签：zend-framework2

我有一个带有 InputFilter 的 Form\Element，其“必需”值设置为“false”。在某些情况下，该元素需要在控制器内将“必需”值设置为“真”。

当我在控制器中设置 Zend\InputFilter setRequired(true) 时，调用 $form->isValid() 方法时似乎没有得到尊重。但是，如果在 Zend\InputFilter 中将过滤器设置为“必需”为“真”（而不是在控制器内部动态设置），那么它会按预期工作 - 但这不是我想要的解决方案，因为我使用此表单并过滤了几个位置，有时需要该字段，有时则不需要。

在我的控制器中，我有以下内容：

```
$form = new UserDataForm();
$request = $this->getRequest();

if ($request->isPost()) {
    $update = new UserFilter();
    // The following doesn't seem to be respected
    $update->getInputFilter()->get('userName')->setRequired(true);

    $form->setInputFilter($update->getInputFilter());
    $form->setData($request->getPost());

    if($form->isValid()) {
        //The result is true even when the 'userName' var is not set in the POST data.
        echo("Is Valid");
    } else {
        echo($form->getMessages());
    } 
```

我已经像这样设置了我的 UserDataForm() 类：

```
class UserDataForm extends Form
{
public function __construct($name = null, array $userTypes) {
    parent::__construct('user');
    $this->setAttribute('method','post');

    $this->add(array(
        'name' => 'userName',
        'attributes' => array(
            'type' => 'text',
            'class'=> 'small'
        ),
        'options' => array(
            'label' => 'Username:'
        )
    ));

    //... and so on... 
```

我已经像这样设置了我的 UserFilter 类：

```
public function getInputFilter() {
    if (!$this->inputFilter) {
        $inputFilter = new InputFilter();
        $factory     = new InputFactory();

        $inputFilter->add($factory->createInput(array(
            'name'      => 'userName',
            'required'  => false,
            'filters'   => array(
                array('name' => 'StripTags'),
                array('name' => 'StringTrim'),
            ),
            'validators' => array(
                array(
                    'name'  => 'StringLength',
                    'options'  => array(
                        'encoding'  => 'UTF-8',
                    )
                ),
            )
        )));

    // ... 
```

有人可以解释为什么在验证表单时似乎不尊重从我的控制器调用的 $update->getInputFilter()->get('userName')->setRequired(true) 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T23:37:37.237

我在上面休息了一段时间后发现了问题。显然， ->setRequired(true) 在动态分配时是互斥的。如果您正在寻找与从 \FilterInput 设置 'required' => true 相同的行为，那么您还需要另外添加 ->setAllowEmpty(false)。

所以我修改后的代码现在看起来像这样：

```
$update->getInputFilter()->get('userName')->setRequired(true);
$update->getInputFilter()->get('userName')->setAllowEmpty(false); 
```

井架

# django - Django 1.5 版：'url' 需要一个非空的第一个参数。Django 1.5 中的语法改变

> ID：14882491
> 
> 赞同：67
> 
> 时间：2013-02-14T19:25:01.783
> 
> 标签：django, url

我开始使用 Django 1.5 版，但我的旧代码出现了问题：

```
<a href="{% url auto.views.viewpost post.slug %}"><h3>{{post.title}}</h3></a> 
```

错误：“url”需要一个非空的第一个参数。Django 1.5 中的语法发生了变化，请参阅文档。文件：

> 一个值得注意的弃用功能是转向“新型” url 标签。在 Django 1.3 之前，像 {% url myview %} 这样的语法被错误地解释（Django 认为“myview”是视图的文字名称，而不是名为 myview 的模板变量）。Django 1.3 及更高版本引入了 {% load url from future %} 语法，以引入将 myview 视为变量的更正行为。
> 
> 这样做的结果是，如果您没有在模板中使用 {% load url from future %}，则需要将 {% url myview %} 等标签更改为 {% url "myview" %}。如果您使用 {% load url from future %} 您可以简单地在 Django 1.5 下删除该行

然后我尝试了： `<a href=“{% url ‘auto.views.view_post’ post.slug %}”&gt;<h3>{{post.title}}</h3></a>` 但是'auto.views.view_post'的错误Reverse带有参数'（''，）'和关键字参数'{}'未找到。:(我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-03-12T23:05:21.483

我真的很讨厌手工做这些垃圾，所以我写了一个 sed 脚本来帮我做。确保你有一个备份，然后在你的模板目录中运行它：

```
find . -type f -print0 | xargs -0 sed -i 's/{% url \([^" >][^ >]*\)/{% url "\1"/g' 
```

它将遍历您的所有模板文件并替换它：

```
{% url something.else foo bar %} 
```

有了这个

```
{% url "something.else" foo bar %} 
```

小心，我对此有点懒惰，它可能会破坏某些构造。不过，在 diff 中查找错误仍然比手动查找更容易。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-07T22:19:40.827

为了排除 .git 的文件夹并避免错误的 MacOS 在选项 -i '' 中添加了空引号。例子：

```
find . -path '*/.git*' -prune -o -type f -print0 | xargs -0 sed -i '' 's/ url \([^" >][^ >]*\)/ url "\1"/g' 
```

但我喜欢这种方法（MacOS）：

```
grep '{% url' -lrZ . | xargs -0 sed -i '' 's/ url \([^" >][^ >]*\)/ url "\1"/g' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T19:49:18.263

首先，您对视图名称使用单引号是正确的，即`'auto.views.view_post'`.

现在，暂时删除`url`标签，并检查它`{{ post }}`并`{{ post.slug }}`为您提供您期望的值。错误消息`arguments '('',)'`表明这`post.slug`是问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T10:27:32.317

如果您使用的是 Mac OS，则需要通过 -e

```
find . -type f -print0 | xargs -0 sed -i -e 's/ url \([^" >][^ >]*\)/ url "\1"/g' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-14T22:54:37.883

在大多数这些食谱中，我从 sed 收到“非法字节序列”错误，我可以通过首先执行以下操作来修复：

```
LANG=C 
```

然而，这些食谱在我的项目中产生了大量的误报，而且我们已经混合了单引号、双引号或未引用的 url 名称。这是一团糟。原来最干净的方法是使用我的编辑器（Sublime）在正则表达式模式下搜索模板目录：

```
\{\%\ url\ [^']
\{\%\ url\ [^"] 
```

（找到所有尚未引用的实例）并直观地浏览它们。事实证明，这比尝试将其自动化然后清理烂摊子更快、更干净。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-01T14:28:31.087

您可能还需要执行 regexp-replace `"\{% url "([\w:]+)"`for`"\{% url '$1'`以避免语法错误，例如`<a href="{% url "foo:bar" %}">baz</a>`

# sorting - 骨干.js sortBy cid

> ID：14882494
> 
> 赞同：1
> 
> 时间：2013-02-14T19:25:13.680
> 
> 标签：sorting, backbone.js, collections

我正在使用backbone.js 并尝试按cid 对集合进行排序。我如何按cid排序？

我可以按“名称”之类的属性对其进行排序：

> this.collection.sortBy("name")

这行得通。

但是当我尝试这样做时：

> this.collection.sortBy("cid")

它返回一个集合，但它没有排序，它和以前一样。

我试过这个：

> this.collection.sortBy(cid)

这显然会返回一个错误。

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:29:47.273

`sortBy`根据模型上的属性或迭代器进行排序。由于`cid`直接在模型上而不是属性上，因此您需要使用迭代器。

```
this.collection.sortBy(function(model){
  return model.cid;
}); 
```

# android - 设置 PathOverlay 线的宽度 (OSMDroid)

> ID：14882495
> 
> 赞同：3
> 
> 时间：2013-02-14T19:25:20.293
> 
> 标签：android, osmdroid

有谁知道如何在 OSMDroid 中设置 PathOverlay 元素的线宽？

PathOverlay 类本身在那个领域并没有什么用处。我正在尝试使用 PathOverlay 的绘制方法使用的 Paint 和 Canvas。android.graphics.Paint 类有一个 setStrokeWidth(float) 方法，但这对线宽没有影响。

纵观 Paint API，没有什么其他的帮助。同样适用于画布。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T20:26:11.967

尝试以下（您可以适应您的要求）；

```
 pathOverlay = new PathOverlay(Color.GREEN, context);
    ArrayList<GeoPoint> path = getTrackPoints();
    mMapView.getOverlays().add(pathOverlay);
    Paint pPaint = pathOverlay.getPaint();
    pPaint.setStrokeWidth(5);
    pathOverlay.setPaint(pPaint); 
```

如果您从叠加层中获取 Paint 设置，然后只需修改宽度即可解决不必担心其他 Paint 设置的问题

# sql - 如何为引用 SQL 中其他几个实体之一的实体建模？

> ID：14882502
> 
> 赞同：2
> 
> 时间：2013-02-14T19:25:45.317
> 
> 标签：sql, database-design, sql-server-2008-r2, entity-relationship

我正在研究制造数据库的一部分。该业务接受定制订单并根据规格构建项目。他们只构建了几种（比如说 3-10 种）类型的对象，但每种类型的对象在记录的规范中都是不同的。我想要一个主制造表 (mfgorders) 列出一些常见字段，然后让它引用特定于订购实体的规格表。我不完全相信这是正确的方法。事实上，我一点也不自信。我所有的其他建模都是直截了当的，但是这个让我很烦。

这是SQL：

```
CREATE TABLE dbo.mfgorders (MfgOrderId int NOT NULL
                                       IDENTITY (1, 1) ,
                        OrderId int NOT NULL,
                        LineNbr tinyint NOT NULL,
                        MfgTypeId tinyint NOT NULL,
                        ItemDescription varchar (999) ,
                        ManufacturingCost smallmoney,
                        CONSTRAINT PK_mfgorders PRIMARY KEY (MfgOrderId)) ;
--OrderId + LineNbr are a composite referencing a row on a lineitem table (not depicted here)

CREATE TABLE dbo.mfgorders_entity1 (MfgOrderId int NOT NULL,
                                EntitySize decimal (5, 3) ,
                                Width decimal (4, 2) ,
                                Thickness decimal (4, 2) ,
                                CONSTRAINT PK_mfgorders_entity1 PRIMARY KEY (MfgOrderId)) ;

CREATE TABLE dbo.mfgorders_entity2 (MfgOrderId int NOT NULL,
                                Height decimal (5, 2) ,
                                Width decimal (5, 2) ,
                                Thickness decimal (4, 2) ,
                                RotationSetting decimal (4, 1) ,
                                FinishedHeight decimal (5, 2) ,
                                FinishedWidth decimal (5, 2) ,
                                FinishedThickness decimal (4, 2) ,
                                CONSTRAINT PK_mfgorders_entity2 PRIMARY KEY (MfgOrderId)) ;

CREATE TABLE mfg_types (MfgTypeId tinyint NOT NULL,
                    ItemName varchar (32) NOT NULL,
                    ItemDescription nvarchar (64) NULL,
                    IsActive bit NOT NULL
                                 CONSTRAINT DF_mfg_types_IsActive DEFAULT 1,
                    SortOrder int NULL,
                    CONSTRAINT PK_mfg_types PRIMARY KEY (MfgTypeId)) ;

ALTER TABLE dbo.mfgorders_entity1 ADD CONSTRAINT FK_mfgorders_entity1_mfgorders FOREIGN KEY (MfgOrderId) REFERENCES dbo.mfgorders (MfgOrderId) ON UPDATE NO ACTION ON DELETE CASCADE;

ALTER TABLE dbo.mfgorders_entity2 ADD CONSTRAINT FK_mfgorders_entity2_mfgorders FOREIGN KEY (MfgOrderId) REFERENCES dbo.mfgorders (MfgOrderId) ON UPDATE NO ACTION ON DELETE CASCADE;

ALTER TABLE dbo.mfgorders ADD CONSTRAINT FK_mfgorders_mfg_types FOREIGN KEY (MfgTypeId) REFERENCES dbo.mfg_types (MfgTypeId) ON UPDATE NO ACTION ON DELETE CASCADE; 
```

这是上述代码的 ER 图：

![ER图](../Images/3e401706612ce0d0ec601eeb1c1b2436.png)

该模型意味着 entity1 和 entity2 可以具有相同的 MfgOrderId，我当然不希望这样。我希望 MfgOrderId 仅引用其中一个实体。我认为在我的脑海中我希望利用 mfg_types 指向正确的实体表，但我觉得模型已经关闭，我会通过询问 SO 社区来增加几年的生活。

问候，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:32:35.920

“……我当然不想这样。”

我不一定会跳到那个结论。您描述的模型是可接受的模型，Hibernate 称它为[`InheritanceType.JOINED`](http://docs.jboss.org/envers/api-new/org/hibernate/envers/configuration/metadata/InheritanceType.html#JOINED)。[您可以在他们的 docs](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/inheritance.html#inheritance-joined)中阅读有关它的信息，但您会使用共享相同 ID 的所有表来建模这种关系。

[JPA 文档](http://openjpa.apache.org/builds/1.0.0/apache-openjpa-1.0.0/docs/manual/jpa_overview_mapping_inher.html#jpa_overview_mapping_inher_tpc)也谈到了它。

使用它的关键部分，或者实际上是关于在数据库中表示类层次结构的关键部分，是您需要能够判断您是否拥有实体 1 或实体 2。最明确的方法是使用[Discriminator](http://openjpa.apache.org/builds/1.0.0/apache-openjpa-1.0.0/docs/manual/jpa_overview_mapping_discrim.html)，基本上是超类表中的一列，表示任何行代表实体 1 或实体 2。

我相信，如果您没有指定鉴别器，并且您使用的是 JOINED，那么 Hibernate（可能还有其他 JPA 实现）将通过检查所有子类表并查看哪个包含具有特定 ID 的行来自动为您完成. 假设每个 MfgOrderId 都在一个且只有一个子类表中，这将在不更改架构的情况下为您工作。

**编辑**

我错误地切换了 TABLE_PER_CLASS，我的意思是加入了！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:52:41.943

你的设计表达或试图表达的是超类型和子类型的关系。

表达这一点的一种方法是`MfgTypeId`在每个实体表中包含该字段：

```
CREATE TABLE dbo.mfgorders_entity2 (MfgOrderId int NOT NULL,
                 MfgTypeId tinyint NOT NULL,
                 Height decimal (5, 2) ,
                 Width decimal (5, 2) ,
                 Thickness decimal (4, 2) ,
                 RotationSetting decimal (4, 1) ,
                 FinishedHeight decimal (5, 2) ,
                 FinishedWidth decimal (5, 2) ,
                 FinishedThickness decimal (4, 2) ,
                 CONSTRAINT PK_mfgorders_entity2 PRIMARY KEY (MfgOrderId, MfgTypeId),
                 CONSTRAINT chkEntity2_MfgTypeID CHECK (MfgTypeId = 'Type Id for Entity 2')) ; 
```

我可能还会更改`MfgOrders`表以将 MfgTypeId 也包含在主键中。

```
CREATE TABLE dbo.mfgorders (MfgOrderId int NOT NULL IDENTITY (1, 1) ,
                 MfgTypeId tinyint NOT NULL,                 
                 OrderId int NOT NULL,
                 LineNbr tinyint NOT NULL,
                 ItemDescription varchar (999) ,
                 ManufacturingCost smallmoney,
                 CONSTRAINT PK_mfgorders PRIMARY KEY (MfgOrderId, MfgTypeId)) ; 
```

如果您搜索超类型和子类型数据库建模，您会发现许多资源，包括关于 SO 和 Stackexchange 网络的问题。我在下面提供了一些链接，这些链接可能会帮助您开始使用：

1.  [数据库管理员的超类型/子类型](https://dba.stackexchange.com/questions/16543/supertype-subtype-deciding-between-category-complete-disjoint-or-incomplete-ove)

2.  [超类型和子类型](http://technet.microsoft.com/en-us/library/cc505839.aspx)

3.  [如何在子类型中实现引用完整性](https://stackoverflow.com/questions/4896831/how-to-implement-referential-integrity-in-subtypes/4898314#4898314)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:40:14.437

我看不出你所拥有的任何重大问题。这是我可能会做的：

```
CREATE TABLE dbo.mfgorders (    MfgOrderId int NOT NULL IDENTITY (1, 1),
                            OrderId int NOT NULL,
                            LineNbr tinyint NOT NULL,
                            MfgTypeId tinyint NOT NULL,
                            ItemDescription varchar (999) ,
                            ManufacturingCost smallmoney,
                            CONSTRAINT PK_mfgorders PRIMARY KEY (MfgOrderId)) ;
--OrderId + LineNbr are a composite referencing a row on a lineitem table (not depicted here)

CREATE TABLE dbo.mfgorders_entity1( MfgOrderEntity1Id int NOT NULL IDENTITY (1, 1),
                                MfgOrderId int NOT NULL,
                                EntitySize decimal (5, 3) ,
                                Width decimal (4, 2) ,
                                Thickness decimal (4, 2) ,
                                CONSTRAINT PK_mfgorders_entity1 PRIMARY KEY (MfgOrderEntity1Id)) ;

CREATE TABLE dbo.mfgorders_entity2 (MfgOrderEntity2Id int NOT NULL IDENTITY (1, 1),
                                MfgOrderId int NOT NULL,
                                Height decimal (5, 2) ,
                                Width decimal (5, 2) ,
                                Thickness decimal (4, 2) ,
                                RotationSetting decimal (4, 1) ,
                                FinishedHeight decimal (5, 2) ,
                                FinishedWidth decimal (5, 2) ,
                                FinishedThickness decimal (4, 2) ,
                                CONSTRAINT PK_mfgorders_entity2 PRIMARY KEY (MfgOrderEntity2Id)) ;

CREATE TABLE mfg_types (            MfgTypeId tinyint NOT NULL,
                                ItemName varchar (32) NOT NULL,
                                ItemDescription nvarchar (64) NULL,
                                IsActive bit NOT NULL
                                CONSTRAINT DF_mfg_types_IsActive DEFAULT 1,
                                SortOrder int NULL,
                                CONSTRAINT PK_mfg_types PRIMARY KEY (MfgTypeId)) ;

ALTER TABLE dbo.mfgorders_entity1 ADD CONSTRAINT FK_mfgorders_entity1_mfgorders FOREIGN KEY (MfgOrderId) REFERENCES dbo.mfgorders (MfgOrderId) ON UPDATE NO ACTION ON DELETE CASCADE;

ALTER TABLE dbo.mfgorders_entity2 ADD CONSTRAINT FK_mfgorders_entity2_mfgorders FOREIGN KEY (MfgOrderId) REFERENCES dbo.mfgorders (MfgOrderId) ON UPDATE NO ACTION ON DELETE CASCADE;

ALTER TABLE dbo.mfgorders ADD CONSTRAINT FK_mfgorders_mfg_types FOREIGN KEY (MfgTypeId) REFERENCES dbo.mfg_types (MfgTypeId) ON UPDATE NO ACTION ON DELETE CASCADE; 
```

# macos - [IzPack][Mac]“这个目录不能写！”

> ID：14882509
> 
> 赞同：0
> 
> 时间：2013-02-14T19:26:17.307
> 
> 标签：macos, hidden, izpack

我正在尝试使用 IzPack 4.3.5 制作安装程序。不幸的是，安装程序抛出了这个消息：

> 这个目录不能写！请选择其他目录！

我正在尝试在“~/Library/Application Support/minecraft/bin”中安装一些东西。

这是我的 install.xml：

```
<info>
    <appname>WorldEdit - Client User Interface installer</appname>
    <appversion>1.0</appversion>
</info>

<guiprefs width="640" height="480" resizable="yes"/>

<locale>
    <langpack iso3="eng"/>
</locale>

<resources>
    <res id="InfoPanel.info" src="info.txt"/>
    <res id="TargetPanel.dir" src="path.txt"/>
</resources>

<panels>
    <panel classname="InfoPanel"/>
    <panel classname="DefaultTargetPanel"/>
    <panel classname="TargetPanel"/>
    <panel classname="InstallPanel"/>
    <panel classname="FinishPanel"/>
</panels>

<packs>
    <pack name="WorldEdit - Client User Interface" required="yes">
        <description>Minecraft 1.4.7 met Forge en WorldEdit - Client User Interface</description>
        <file src="../Inhoud/minecraft.jar" targetdir="$INSTALL_PATH"/>
    </pack>
</packs> 
```

还有我的 path.txt：

```
${ENV[USER_HOME]}/Library/Application Support/minecraft/bin 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T10:32:27.547

我认为以下是您正在寻找的内容：

```
${USER_HOME}/Library/Application Support/minecraft/bin 
```

或者

```
${ENV[HOME]}/Library/Application Support/minecraft/bin
${ENV[USERPROFILE]}/Library/Application Support/minecraft/bin 
```

分别用于 *ix 和 windows 系统。

我建议使用前一种解决方案。

# android - 调用 Cursor 方法后 Android 应用程序崩溃

> ID：14882510
> 
> 赞同：0
> 
> 时间：2013-02-14T19:26:25.677
> 
> 标签：android, cursor

我有两个按钮，一个用于插入，一个用于显示。插入工作正常，但单击显示按钮后，我的应用程序崩溃你得到以下错误

```
02-15 00:36:28.207: E/AndroidRuntime(25942): FATAL EXCEPTION: main
02-15 00:36:28.207: E/AndroidRuntime(25942): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.indianrailwaybooking/com.example.indianrailwaybooking.SQLView}: java.lang.NullPointerException
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.os.Looper.loop(Looper.java:123)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread.main(ActivityThread.java:3683)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at java.lang.reflect.Method.invokeNative(Native Method)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at java.lang.reflect.Method.invoke(Method.java:507)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at dalvik.system.NativeStart.main(Native Method)
02-15 00:36:28.207: E/AndroidRuntime(25942): Caused by: java.lang.NullPointerException
02-15 00:36:28.207: E/AndroidRuntime(25942):    at com.example.indianrailwaybooking.Reservation.getData(Reservation.java:96)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at com.example.indianrailwaybooking.SQLView.onCreate(SQLView.java:36)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-15 00:36:28.207: E/AndroidRuntime(25942):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
02-15 00:36:28.207: E/AndroidRuntime(25942):    ... 11 more 
```

这是我的光标方法

```
public String getData() {
    // TODO Auto-generated method stub
    ourDatabase = ourHelper.getWritableDatabase();
    String [] columns = new String[]{KEY_BOOKING, KEY_PERSON1, KEY_PERSON2, KEY_PERSON3, KEY_PERSON4};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null ,null);
    String result = "";
    ourDatabase.close();

    int iBooking = c.getColumnIndex("KEY_BOOKING");
    int iPerson1 = c.getColumnIndex("KEY_PERSON1");
    int iPerson2 = c.getColumnIndex("KEY_PERSON2");
    int iPerson3 = c.getColumnIndex("KEY_PERSON3");
    int iPerson4 = c.getColumnIndex("KEY_PERSON4");

    for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + c.getString(iBooking) + " " + " " + c.getString(iPerson1) + " " + c.getString(iPerson2) + " " + c.getString(iPerson3) + " " + c.getString(iPerson4) + "\n";
    }

    Toast.makeText(context, result, Toast.LENGTH_LONG ).show();

    return result;
} 
```

这是调用 getData 方法的类。

```
public class SQLView extends Activity {

    private DBHelper obj;
    AlertDialog alert;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.sqlview);
        Reservation resv = new Reservation(this);
        String result = resv.getData();
        EditText et = (EditText) findViewById(R.id.tvSQLinfo);
        et.setText(result);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.sqlview, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:51:40.717

很难说没有看到更多代码，我会尝试替换`ourHelper.getWritableDatabase();`并`ourHelper.getReadableDatabase();`删除`ourDatabase.close();`

尝试：

```
public String getData() {
    // TODO Auto-generated method stub
    ourDatabase = ourHelper.getReadableDatabase();
    String [] columns = new String[]{KEY_BOOKING, KEY_PERSON1, KEY_PERSON2, KEY_PERSON3, KEY_PERSON4};
    Cursor c = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null ,null);
    String result = "";

    int iBooking = c.getColumnIndex("KEY_BOOKING");
    int iPerson1 = c.getColumnIndex("KEY_PERSON1");
    int iPerson2 = c.getColumnIndex("KEY_PERSON2");
    int iPerson3 = c.getColumnIndex("KEY_PERSON3");
    int iPerson4 = c.getColumnIndex("KEY_PERSON4");

    for(c.moveToFirst(); !c.isAfterLast(); c.moveToNext()){
        result = result + c.getString(iBooking) + " " + " " + c.getString(iPerson1) + " " + c.getString(iPerson2) + " " + c.getString(iPerson3) + " " + c.getString(iPerson4) + "\n";
    }

    Toast.makeText(context, result, Toast.LENGTH_LONG ).show();

    return result;
} 
```

# html - CSS 子导航问题

> ID：14882515
> 
> 赞同：1
> 
> 时间：2013-02-14T19:26:46.587
> 
> 标签：html, css

我正在尝试在“珠宝”下实现子导航菜单。问题是我想要两个菜单打开时之间有一个空格。为了实现这一点，我添加了“margin-top:5px;” 到子导航。它确实创建了空间，但是正如您所看到的，只要我将鼠标放到子导航上，它就会被取消选择。

实现这一目标的正确方法是什么？

```
nav ul ul {
margin-top:5px;
background-color: #101010;
color: #FFF;

} 
```

链接到 jsfiddle

[http://jsfiddle.net/2mpcQ/4/](http://jsfiddle.net/2mpcQ/4/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:56:50.230

边框顶部：5px 实心#fff；

这将使菜单和子菜单之间出现空间。并且仍然会赋予它功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:02:19.007

您可以使用 div 标签子菜单来获得所需的垂直空间。我已经修改了您的 jsfiddle 以供参考。

```
.rowheight {background: #fff; font-size: 5px;}  

 <ul>
  <li>
    <div class="rowheight">&nbsp;</div>
    <ul><li>Item</li></ul>
  </li>
</ul> 
```

jsfiddle链接 -

[http://jsfiddle.net/2mpcQ/25/](http://jsfiddle.net/2mpcQ/25/)

或者可以`border-top: 5px solid #fff;`用于嵌套的 ul 但它是不可控的。它将影响所有嵌套的 UL 标签。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:05:42.787

如果您只想解决此问题，请尝试添加`border-top`到`.nav ul ul`( `border-top:5px solid #fff;`)。不过，您的问题是“实现这一目标的正确方法是什么？”。正如 Diodeus 所说，我认为正确的方法是设置“a”元素的样式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T19:31:59.677

您应该`padding-top:5px`在这个填充的 DOM 元素中使用和黑色子菜单

# php - PHP $_GET 变量在 URL 中重新排列，为什么？

> ID：14882516
> 
> 赞同：0
> 
> 时间：2013-02-14T19:26:42.350
> 
> 标签：php, .htaccess, mod-rewrite

当我去：

```
https://sitedomain/product-name-p-1106.html?ref=facebook&keyw=pagetype0:friends 
```

网址更改为：

```
https://sitedomain/product-name-p-1106.html?keyw=pagetype0friends&ref=facebook 
```

*基本上$ref*和*$keyw*变量是相反的。**为什么会发生这种情况，我该如何阻止它？**

注意：我正在尝试使用一个脚本，该脚本依赖于它们的顺序是 $ref 然后是其他人编写的 $keyw ，我想让它们保持这种顺序而不修改该脚本。

我认为它可能是 .htaccess 文件，但不确定，这是该文件：

```
RewriteBase / 
RewriteRule ^([a-z0-9/-]+)-p-([0-9]+).html$ product_info.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-c-([0-9_]+).html$ index.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-m-([0-9]+).html$ index.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-pi-([0-9]+).html$ popup_image.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-pr-([0-9]+).html$ product_reviews.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-pri-([0-9]+).html$ product_reviews_info.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-t-([0-9_]+).html$ articles.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-au-([0-9]+).html$ articles.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-a-([0-9]+).html$ article_info.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-i-([0-9]+).html$ information.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-links-([0-9_]+).html$ links.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-n-([0-9]+).html$ newsdesk_info.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-nc-([0-9]+).html$ newsdesk_index.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-nri-([0-9]+).html$ newsdesk_reviews_info.php [NC,L,QSA]
RewriteRule ^([a-z0-9/-]+)-nra-([0-9]+).html$ newsdesk_reviews_article.php [NC,L,QSA] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:30:22.460

它们只是命名参数，不需要任何特定的顺序。如果您依赖任何特定的顺序，那么您在代码中做的事情根本上是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:06:48.620

我在这里得到的信息是：

永远不要制作或使用依赖于 URL 参数顺序的代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:17:39.713

$_GET vars 不应该依赖于顺序，除非你在 foreaching $_GET 并且公然忽略索引。此外，MOD_REWRITE 不会在浏览器端对 URI 中的内容进行重新排序，而只会更改服务器端的订单/分配。

正如其他人所说，如果订单非常重要，那么我会将该值作为分隔字符串传递，而不是单独的 $_GET 值。

我知道你“不想”重写这个脚本，但正如其他人所说，想想它可能做错了什么？此外，您真的想要这样的故障点吗？

# android - 将加密密码从移动设备发送到服务器的流程

> ID：14882519
> 
> 赞同：1
> 
> 时间：2013-02-14T19:27:05.777
> 
> 标签：android, ios, api, encryption, aes

我想对我为需要发送用户和密码组合的任何移动应用程序构建的流程提出一些意见。我的想法是使用 AES-256 加密密码，生成随机密码和 IV 来生成密钥。这个想法是，当密码第一次生成时，它会将加密的密码和 IV 发送到服务器。IV 和加密密码将存储在服务器上，在 redis 数据库中，密钥和加密密码将仅在移动设备上（IV 不会存储在设备上）。因此，每次用户需要登录时，将加密密码和密钥发送到服务器，并存储 IV，服务器使用刚刚发送的密钥和 IV 解密发送的加密密码和保存在数据库中的密码已经在服务器上。

如果用户想要更改他们的密码，加密密码、密钥和 IV 会再次生成，如果它们匹配，也会发送旧密码（密钥和加密密码），值会在服务器中更新并向客户端发送通知也更新它们。

所有这些事务也将在 SSL 隧道内进行。

你认为这安全吗？如果不是为什么？以安全方式从移动设备到服务器加密/解密密码的任何其他选项？

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:39:22.497

最好的方法是在发送数据并发送哈希之前在客户端对密码进行哈希处理。然后让服务器对该散列进行自己的散列，以便密码永远不必离开客户端，并且不能通过暴力破解存储的散列来获得纯文本密码。

我之前列出的 KDF（pbkdf2、scrypt、bcrypt）非常耗时，因此您可能不想在客户端然后在服务器上执行此操作，除非安全性比正常情况更重要。KDF 用于防止有人从哈希中暴力破解密码。这意味着，如果存储用户哈希的表被泄露，用户密码的纯文本仍然是安全的。例如，如果您在客户端执行 KDF，并在服务器上说 KDF 生成的哈希的简单加盐 MD5，那么用户的纯文本密码将是安全的，但对于能够访问存储的哈希（意味着服务器已被入侵）以该用户身份登录。如果您的站点/应用程序是 stackoverflow，那么如果服务器本身已经受到威胁，那么用户帐户是否受到威胁可能并不重要。另一方面，如果您是贝宝，则可以访问帐户的人可以访问用户的银行帐户，而他们仅通过访问哈希表就无法做到这一点。在这种情况下，在客户端和服务器上都执行 KDF 将是最佳选择。

至于使用 SSL，如果您有一种方法可以验证服务器实际上是您的服务器并且没有 MITM 发生，那就太好了。如果其中任何一个被泄露，那么以纯文本形式发送密码将允许攻击者获得对纯文本密码的访问权限

# java - 与多个客户端通信 - Java Server

> ID：14882522
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:27:12.297
> 
> 标签：java, multithreading, sockets, objectoutputstream, objectinputstream

我已经实现了一个小型 Java 聊天室程序，客户端可以在其中与服务器通信。尽管多个客户端不起作用-我相信这是因为客户端在连接时保留了一个套接字？有没有一种简单的方法来添加多个客户端功能？谢谢你的帮助。

```
public void startRunning(){
      try{
         server = new ServerSocket(6789, 100); // port no, max users
         while(true){
            try{
               waitForConnection();
               setupStreams();
               connectionRecieving();
            }catch(EOFException eofException){
               showMessage("Server ended connection \n");
            }finally{
               closeConnection();
            }
         }
      }catch(IOException ioException){
         ioException.printStackTrace();
      }
   }

   // Wait for connection
   private void waitForConnection() throws IOException{
      showMessage("Attempting connection... \n");
      connection = server.accept();
      showMessage("Connected to: " + connection.getInetAddress().getHostName() + "\n");
   }

   // Get stream to send and receive data
   private void setupStreams() throws IOException{
      output = new ObjectOutputStream(connection.getOutputStream());
      output.flush();
      input = new ObjectInputStream(connection.getInputStream());
   }

   // Close streams and sockets 
   private void closeConnection(){
      showMessage("----- \nClosing connections... \n");
      try{
         output.close();
         input.close();
         connection.close();
      }catch(IOException ioException){
         ioException.printStackTrace();
      }
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:41:15.847

要同时读取和写入多个客户端，您需要单独的线程（阻塞 IO），或者如果您想使用单个线程，则需要 NIO（非阻塞 IO）。

你可以查看[这篇](http://tutorials.jenkov.com/java-nio/nio-vs-io.html)关于实现差异的帖子，但 NIO 通常是更有效的方法。

使用阻塞 I/O 通常遵循您上面使用的代码，除了您需要一个单独的线程来处理每个接受的套接字。使用 NIO，使用起来稍微复杂一些；看看[这个教程](http://rox-xmlrpc.sourceforge.net/niotut/)。

# oracle - Oracle PL SQL 过程将值从父级分解到子级

> ID：14882524
> 
> 赞同：1
> 
> 时间：2013-02-14T19:27:20.557
> 
> 标签：oracle, stored-procedures, plsql, cursor, dynamic-sql

我正在处理一个我有的案例

1.  产品的父子层次结构：[最高级别] 原材料*RM* > 在*制品 WIP* > 最终产品*EP* [最低级别]
2.  特定周的*最终产品*订单
3.  特定周内*原材料*或*在制品*的预测值

我的目标是根据这些孩子的订单数量，将特定周的特定 RM 或 WIP 的预测值分解为该周 RM 或 WIP 的部分或全部子 EP。

这只是意味着如果我有一个 RM，比如 RM1，它有 3 个子 EP，比如 EP1、EP2 和 EP3.. 我对第 2 周的 RM1 的预测值为 1000，那么我的目标是将这个预测拆分为EP 的 3 个部分基于每个 EP 的计算或指定百分比分布。

用户可以选择使用哪种方法来获取百分比分布：

1.  ***计算***：用户说，根据从第 10 到第 15 桶（从现在开始日期的第 10 周到从现在开始日期的第 16 周）对他们下达的订单，将 RM1 预测值分解为 EP1 和 EP2。因此，我们分别计算第 10 至第 15 周期间 EP1 和 EP2 的总订单，并计算百分比分布如下：EP1 订单 / (EP1 + EP2 订单) * 100 % 和 (EP2 订单) / (EP1 + EP2 订单) * 100 % ， 分别。

2.  ***指定***：用户说，20% 给 EP1，50% 给 EP2，10% 给 EP3

然后我们简单地将每个 EP 第 2 周的 RM1 预测值根据我们计算或得到的百分比除以 1000，并将其作为第 2 周的 EP 预测值存储在同一张表中。

选择用于分解的方法与 parent_id、child_id、子百分比、开始存储桶的开始日期、（结束存储桶+1）的开始日期一起存储在另一个表中

我有以下表格：

1.  **Products**，用于存储产品信息并维护父子层次结构（原材料 > 正在进行的工作 > 最终产品）
2.  **Orders**，用于存储最低层次结构（最终产品）的订单。
3.  **Forecast Value**，用于存储特定周的产品的预测值（数字）
4.  **分解方法**，预测表最初在层次结构的更高级别（原材料）存储特定周的产品的预测值。该值对其子级别（某些最终产品）进行分解并存储在预测表本身中。分解方法存储使用哪种*方法*分解预测值从哪个*父*级到哪*个子级以及该子级的**百分比分布*是多少。
5.  **日期信息**日期维度，包含有关开始日期（必须是星期六）和结束日期的信息，对应于特定日期所在的周

我在这里发布了我的数据模型：[https](https://stackoverflow.com/a/14881277/891424) ://stackoverflow.com/a/14881277/891424 ，这是我迄今为止编写的一个函数和几个程序：

*查找与给定存储桶对应的周开始日期的函数*

```
CREATE OR REPLACE FUNCTION get_week_start_date(v_bucket_num IN NUMBER)
  RETURN DATE
IS
  week_start_date DATE;
BEGIN
  SELECT (TRUNC(SYSDATE+2, 'IW')-2) + ((v_bucket_num-1) * 7)
  INTO week_start_date FROM dual;
  RETURN week_start_date;
END; 
```

*返回给定父级的所有子 EP 的过程*

```
CREATE OR REPLACE PROCEDURE get_eps(
  v_parent IN NUMBER,
  v_children_of_parent OUT SYS_REFCURSOR
)
AS
  v_children SYS_REFCURSOR;
BEGIN
  OPEN v_children_of_parent FOR
  SELECT id, name FROM (
    SELECT
      CONNECT_BY_ISLEAF isleaf, p.id, p.name
    FROM
      inf_product p
    WHERE p.level_code = 'EP'
      START WITH id = 1
      CONNECT BY PRIOR id = parent_id
    )
  WHERE isleaf = 1;
END; 
```

*分解预测值的程序（不完整）*

```
CREATE OR REPLACE PROCEDURE inf_disaggregate(v_parent_id IN NUMBER, v_bucket_start IN NUMBER, v_bucket_end IN NUMBER)
IS
  /* Parent Product ID from input */
  v_parent_prod_id NUMBER;

  /* All the children of parent specified in the input */
  child_cursor  SYS_REFCURSOR;
    child_id    NUMBER;
    child_name  VARCHAR2(40);

  /* Forecast Bucket Info */
  vbucket_start NUMBER;
  vbucket_end NUMBER;
  vbucket_diff NUMBER;    -- loop over vbucket_diff + 1

  /* Date corresponding to input buckets */
  vbucket_start_date DATE;
  vbucket_end_date DATE;

  /* Exceptions */
  invalid_bucket EXCEPTION;
  PRAGMA EXCEPTION_INIT( invalid_bucket, -20001 );
BEGIN
  v_parent_prod_id := v_parent_id;

  vbucket_start := v_bucket_start;
  vbucket_end := v_bucket_end;
  vbucket_diff := vbucket_end - vbucket_start;

  IF vbucket_diff < 0 THEN
    RAISE_APPLICATION_ERROR( -20001, 'Bucket numbers not in the correct order' );
  END IF;

  IF vbucket_start < 1 OR vbucket_start > 26 OR vbucket_end < 1 OR vbucket_end > 26 THEN
    RAISE_APPLICATION_ERROR( -20001, 'Bucket value must be within 1 to 26' );
  END IF;

  /* Get first day of the week corresponding to the buckets */
  vbucket_start_date := get_week_start_date(vbucket_start);
  vbucket_end_date   := get_week_start_date(vbucket_end);

  DBMS_OUTPUT.PUT_LINE(vbucket_start);
  DBMS_OUTPUT.PUT_LINE(vbucket_end);
  DBMS_OUTPUT.PUT_LINE(vbucket_diff);
  DBMS_OUTPUT.PUT_LINE(vbucket_start_date);
  DBMS_OUTPUT.PUT_LINE(vbucket_end_date);

  /* Get all child EPs for the specified parent */
  get_eps(v_parent => v_parent_prod_id, v_children_of_parent => child_cursor);

  LOOP 
    FETCH child_cursor
    INTO  child_id, child_name;
    EXIT WHEN child_cursor%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE(child_id || ' | ' || child_name);
  END LOOP;
  CLOSE child_cursor;
EXCEPTION
  WHEN invalid_bucket
  THEN
    DBMS_OUTPUT.PUT_LINE(SUBSTR(SQLERRM, 1 , 80));
END;
/ 
```

*运行程序*

```
SET SERVEROUTPUT ON;
CALL inf_disaggregate(5, 10, 12); 
```

**问题 1：**如何创建包或程序来完成此任务？

**问题 2：**如何摆脱 SYS_REFCURSOR 并改用动态 sql？（我可能也应该摆脱 child_name ，因为仅 ID 就可以很好地为我服务）

**问题 3**：如何获得分解方法以及在***指定***的情况下，百分比作为用户输入？

# python - 蟒蛇抛硬币

> ID：14882530
> 
> 赞同：13
> 
> 时间：2013-02-14T19:27:36.127
> 
> 标签：python

我对 Python 非常陌生，我必须创建一个模拟掷硬币的游戏，并要求用户输入应该掷硬币的次数。基于该响应，程序必须为指定的次数选择一个随机数，该数是 0 或 1（并决定哪个代表“正面”，哪个代表“反面”）。计算产生的“正面”数量和“反面”数量，并向用户呈现以下信息：由模拟抛硬币组成的列表，以及产生的正面数量和反面数量的摘要。例如，如果用户输入 5，则抛硬币模拟可能会导致 ['heads', 'tails', 'tails', 'heads', 'heads']。程序应打印如下内容：“ ['heads', 'tails', 'tails', 'heads', 'heads']

这是我到目前为止所拥有的，它根本不起作用......

```
import random

def coinToss():
    number = input("Number of times to flip coin: ")
    recordList = []
    heads = 0
    tails = 0
    flip = random.randint(0, 1)
    if (flip == 0):
        print("Heads")
        recordList.append("Heads")
    else:
        print("Tails")
        recordList.append("Tails")
    print(str(recordList))
    print(str(recordList.count("Heads")) + str(recordList.count("Tails"))) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-14T19:32:01.383

你需要一个`loop`来做到这一点。我建议一个`for`循环：

```
import random
def coinToss():
    number = input("Number of times to flip coin: ")
    recordList = []
    heads = 0
    tails = 0
    for amount in range(number):
         flip = random.randint(0, 1)
         if (flip == 0):
              print("Heads")
              recordList.append("Heads")
         else:
              print("Tails")
              recordList.append("Tails")
    print(str(recordList))
    print(str(recordList.count("Heads")) + str(recordList.count("Tails"))) 
```

我建议您在[循环中阅读](http://www.tutorialspoint.com/python/python_loops.htm)[此内容`for`](http://www.tutorialspoint.com/python/python_loops.htm)。

此外，您可以`number`作为[参数传递给函数](http://www.tutorialspoint.com/python/python_functions.htm)：

```
import random
def coinToss(number):
    recordList, heads, tails = [], 0, 0 # multiple assignment
    for i in range(number): # do this 'number' amount of times
         flip = random.randint(0, 1)
         if (flip == 0):
              print("Heads")
              recordList.append("Heads")
         else:
              print("Tails")
              recordList.append("Tails")
    print(str(recordList))
    print(str(recordList.count("Heads")) + str(recordList.count("Tails"))) 
```

然后，您需要在最后调用该函数：`coinToss()`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-14T19:30:30.557

你快到了：

1）您需要调用该函数：

```
coinToss() 
```

2）您需要设置一个循环来`random.randint()`重复调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T19:58:13.300

我会采取以下方式：

```
from random import randint
num = input('Number of times to flip coin: ')
flips = [randint(0,1) for r in range(num)]
results = []
for object in flips:
        if object == 0:
            results.append('Heads')
        elif object == 1:
            results.append('Tails')
print results 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-07T22:41:30.583

这可能更 Pythonic，虽然不是每个人都喜欢列表推导式。

```
import random

def tossCoin(numFlips):      
    flips= ['Heads' if x==1 else 'Tails' for x in [random.randint(0,1) for x in range(numflips)]]
    heads=sum([x=='Heads' for x in flips])
    tails=numFlips-heads 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-03T01:54:42.510

```
import random
import time

flips = 0
heads = "Heads"
tails = "Tails"

heads_and_tails = [(heads),
                   (tails)]
while input("Do you want to coin flip? [y|n]") == 'y':
    print(random.choice(heads_and_tails))
    time.sleep(.5)
    flips += 1

else:
    print("You flipped the coin",flips,"times")
    print("Good bye") 
```

你可以试试这个，我有它，所以它会问你是否要掷硬币，然后当你说不或 n 时，它会告诉你掷硬币的次数。（这是在 python 3.5 中）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-13T18:45:17.947

创建一个包含 head 和 tail 两个元素的列表，并从 random 中使用choice() 来获得掷硬币的结果。要获取 head 或 tail 出现的次数，请将计数附加到列表中，然后使用集合中的 Counter(list_name) 。使用 uin() 调用

```
##coin flip
import random
import collections
def tos():
    a=['head','tail']
    return(random.choice(a))
def uin():
    y=[]
    x=input("how many times you want to flip the coin: ")
    for i in range(int(x)):
        y.append(tos())
    print(collections.Counter(y)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-03T10:40:43.473

我是这样做的。可能不是最好和最有效的方法，但是现在您有不同的选择可供选择。我做了 10000 次循环，因为练习中已经说明了这一点。

```
#Coinflip program
import random

numberOfStreaks = 0
emptyArray = []
for experimentNumber in range(100):
#Code here that creates a list of 100 heads or tails values
headsCount = 0
tailsCount = 0
#print(experimentNumber)
for i in range(100):
    if random.randint(0, 1) == 0:
        emptyArray.append('H')
        headsCount +=1
    else:
        emptyArray.append('T')
        tailsCount += 1   

#Code here that checks if the list contains a streak of either heads or tails of 6 in a row
heads = 0
tails = 0
headsStreakOfSix = 0
tailsStreakofSix = 0

for i in emptyArray:
    if i == 'H':
        heads +=1
        tails = 0
        if heads == 6:
            headsStreakOfSix += 1
            numberOfStreaks +=1

    if i == 'T':
        tails +=1
        heads = 0
        if tails == 6:
            tailsStreakofSix += 1
            numberOfStreaks +=1

#print('\n' + str(headsStreakOfSix))
#print('\n' + str(tailsStreakofSix))
#print('\n' + str(numberOfStreaks))
print('\nChance of streak: %s%%' % (numberOfStreaks / 10000)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-18T08:55:38.227

而不是所有这些，你可以这样做：

```
import random
options = ['Heads' , 'Tails']
number = int(input('no.of times to flip a coin : ')
for amount in range(number):
   heads_or_tails = random.choice(options)
   print(f" it's {heads_or_tails}")
print()
print('end') 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-03-03T05:13:47.007

## 解决眼前的问题

最高投票的答案实际上并没有运行，因为它将一个字符串传递给`range()`（而不是一个 int）。

这是一个解决两个问题的解决方案：刚刚提到的问题，以及最后两行语句中的调用可以变得多余`range()`的事实。编写此代码段是为了尽可能少地修改原始代码。`str()``print()`

```
def coinToss():
    number = int(input("Number of times to flip coin: "))
    recordList = []
    heads = 0
    tails = 0
    for _ in range(number):
        flip = random.randint(0, 1)
        if (flip == 0):
            recordList.append("Heads")
        else:
            recordList.append("Tails")
    print(recordList)
    print(recordList.count("Tails"), recordList.count("Heads")) 
```

* * *

## 更简洁的方法

但是，如果您正在寻找更简洁的解决方案，则可以使用列表推导。只有一个其他答案具有列表推导，但您可以嵌入从`{0, 1}`到`{"Heads", "Tails"}`使用一个而不是两个列表推导的映射：

```
def coinToss():
    number = int(input("Number of times to flip coin: "))
    recordList = ["Heads" if random.randint(0, 1) else "Tails" for _ in range(number)]
    print(recordList)
    print(recordList.count("Tails"), recordList.count("Heads")) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-14T15:47:15.220

```
#program to toss the coin as per user wish and count number of heads and tails
import random
toss=int(input("Enter number of times you want to toss the coin"))
tail=0
head=0
for i in range(toss):
    val=random.randint(0,1)
    if(val==0):
        print("Tails")
        tail=tail+1
    else:
        print("Heads")
        head=head+1
print("The total number of tails is {} and head is {} while tossing the coin {} times".format(tail,head,toss)) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-12-16T15:06:19.633

```
import random

def coinToss(number):
    heads = 0
    tails = 0
    for flip in range(number):
        coinFlip = random.choice([1, 2])

        if coinFlip == 1:
            print("Heads")
            recordList.append("Heads")
        else:
            print("Tails")
            recordList.append("Tails")

number = input("Number of times to flip coin: ")
recordList = []
if type(number) == str and len(number)>0:
    coinToss(int(number))
    print("Heads:", str(recordList.count("Heads")) , "Tails:",str(recordList.count("Tails"))) 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-10-31T18:58:10.027

```
heads = 1
tails = 0 

input("choose 'heads' or 'tails'. ").upper()

random_side = random.randint(0, 1)

if random_side == 1:
    print("heads you win")
else:
    print("sorry you lose ") 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-09-20T13:32:41.017

抛 N 枚硬币的所有可能性

```
def Possible(n, a):
    if n >= 1:
        Possible(n // 2, a)
    z = n % 2
    z = "H" if z == 0 else "T"
    a.append(z)
    return a

def Comb(val):
    for b in range(2 ** N):
        A = Possible(b, [])
        R = N - len(A)
        c = []
        for x in range(R):
            c.append("H")
        Temp = (c + A)
        if len(Temp) > N:
            val.append(Temp[abs(R):])
        else:
            val.append(Temp)
    return val

N = int(input())
for c in Comb([]):
    print(c) 
```

# string - antlr 匹配任何字符，除了

> ID：14882531
> 
> 赞同：14
> 
> 时间：2013-02-14T19:27:42.147
> 
> 标签：string, char, antlr, match

我对片段有以下定义：

```
fragment CHAR   :'a'..'z'|'A'..'Z'|'\n'|'\t'|'\\'|EOF; 
```

现在我必须为字符串定义一个词法分析器规则。我做了以下事情：

```
STRING   : '"'(CHAR)*'"' 
```

但是在字符串中，我想匹配除新行'\n'之外的所有字符。有什么想法可以实现吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T19:55:34.853

`"`除了换行符之外，您还需要排除。试试这个：

```
STRING : '"' ~('\r' | '\n' | '"')* '"' ; 
```

`~`否定字符集。

> ut 我只想否定我的 CHAR 集中的新行

除了这个 AFAIK，别无他法：

```
STRING : '"' CHAR_NO_NL* '"' ;

fragment CHAR_NO_NL : 'a'..'z'|'A'..'Z'|'\t'|'\\'|EOF; 
```

# c# - 在c#中反序列化以下json响应

> ID：14882532
> 
> 赞同：-3
> 
> 时间：2013-02-14T19:27:46.190
> 
> 标签：c#, json, deserialization

有人可以帮我反序列化 C# 中的以下**JSON**字符串：

```
{"legend_size": 1, 
"data": {"series": ["2013-02-05", "2013-02-06", "2013-02-07", "2013-02-08", "2013-02-09", "2013-02-10", "2013-02-11", "2013-02-12", "2013-02-13", "2013-02-14"],  "values": 
  {"CampaignHit": {"2013-02-14": 0, "2013-02-13": 0, "2013-02-12": 0, "2013-02-11": 0, "2013-02-10": 0, "2013-02-08": 11, "2013-02-05": 0, "2013-02-07": 14, "2013-02-06": 0, "2013-02-09": 0}}}} 
```

我的`CampaignHit`零件有问题。我无法反序列化它。

这是我创建的类：

```
public class ExportedData
{
    public string legend_size { get; set; }
    public Data data { get; set; }

}

public class Data
{
    public string[] series { get; set; }
    public Values values { get; set; }
}

public class Values
{
    public CampaignHit CampaignHit { get; set; }
}

public class CampaignHit
{
    public CampaignData[] data { get; set; }

}

public class CampaignData
{
    public object first { get; set; }
    public object second { get; set; }
} 
```

下面是反序列化 json 的代码：

```
var result = JsonConvert.DeserializeObject<ExportedData>(jsonResponse); 
```

数据部分为空。如何更改`CampaignHit`类以使反序列化后数据不为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:59:58.757

使用 Newtonsoft.Json 的解决方案：

```
JObject jObject = JObject.Parse(@"{
'legend_size': 1,
'data': {
    'series': [
        '2013-02-05', '2013-02-06', '2013-02-07', '2013-02-08', '2013-02-09', '2013-02-10', '2013-02-11', '2013-02-12', '2013-02-13', '2013-02-14'
    ],
    'values': {
        'CampaignHit': {
            '2013-02-14': 0,
            '2013-02-13': 0,
            '2013-02-12': 0,
            '2013-02-11': 0,
            '2013-02-10': 0,
            '2013-02-08': 11,
            '2013-02-05': 0,
            '2013-02-07': 14,
            '2013-02-06': 0,
            '2013-02-09': 0
        }
    }
}
}");

var  campaignHit = jObject["data"]["values"]["CampaignHit"];

Dictionary<string,int> campaignHitDic = new Dictionary<string,int>();

foreach(JProperty c in campaignHit){
campaignHitDic.Add(c.Name,(int)c.Value);
} 
```

# java - 如果手机上未安装某些应用程序，请禁用菜单按钮？

> ID：14882544
> 
> 赞同：0
> 
> 时间：2013-02-14T19:28:36.937
> 
> 标签：java, android, button

如果之前有人问过这个问题，我很抱歉，我尝试搜索它并没有找到任何相关的答案。

我希望我的应用程序确定手机上是否安装了谷歌地图导航和街景。如果它们允许用户从我的应用程序中打开它们。（我已经这样做了，没有问题。）接下来我希望应用程序不允许用户在未安装这些应用程序时尝试打开它们，因为它会如果未安装并且用户尝试打开它们，则强制关闭。以前有没有人处理过这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:37:38.100

当然。首先你需要获取手机上的应用列表，像这样

```
final Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);
mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
final List pkgAppsList = context.getPackageManager().queryIntentActivities( mainIntent, 0); 
```

现在您有了一个列表，您可以找出这些应用程序的包名称，然后遍历列表。如果它们存在，请禁用按钮/菜单选项以启动它们（对于按钮，将其可见性设置为 INVISIBLE 或 GONE。对于菜单项，禁用它或在准备功能中将其删除）。

# spring-security - Spring Security CAS 导致重定向循环

> ID：14882545
> 
> 赞同：0
> 
> 时间：2013-02-14T19:28:37.693
> 
> 标签：spring-security

我正在为我的应用程序使用 CAS SSO 来对用户进行身份验证。但是刚在 CAS 登录页面上登录后，我的应用程序网页就会抛出重定向循环错误。

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

<security:http entry-point-ref="casEntryPoint"
    auto-config="true">
    <security:intercept-url pattern="/**" access="ROLE_USER" />     
    <security:custom-filter position="CAS_FILTER"
        ref="casFilter"></security:custom-filter>
</security:http>

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider
        ref="casAuthenticationProvider" />
</security:authentication-manager>

<bean id="serviceProperties" class="org.springframework.security.cas.ServiceProperties">
    <property name="service" value="http://127.0.0.1:8888/pp.html?gwt.codesvr=127.0.0.1:9997" />
    <property name="sendRenew" value="false" />
</bean>

<bean id="casFilter"
    class="org.springframework.security.cas.web.CasAuthenticationFilter">
    <property name="authenticationManager" ref="authenticationManager" />
</bean>

<bean id="casEntryPoint"
    class="org.springframework.security.cas.web.CasAuthenticationEntryPoint">
    <property name="loginUrl" value="https://seqdws1/cas/login" />
    <property name="serviceProperties" ref="serviceProperties" />
</bean>

<bean id="casAuthenticationProvider"
    class="org.springframework.security.cas.authentication.CasAuthenticationProvider">
    <property name="userDetailsService" ref="userService" />
    <property name="serviceProperties" ref="serviceProperties" />
    <property name="ticketValidator">
        <bean class="org.jasig.cas.client.validation.Cas20ServiceTicketValidator">
            <constructor-arg index="0" value="https://seqdws1/cas" />
        </bean>
    </property>
    <property name="key" value="cas" />
</bean>

<security:user-service id="userService">
    <security:user name="joe" password="joe" authorities="ROLE_USER" />
</security:user-service>

</beans> 
```

我是否必须实施预身份验证方案。我对这个春季安全非常陌生。有人可以解释我在这里缺少什么。

![登录后的错误页面](../Images/2614f5af8a659fa44e2e3a329356105e.png)

# java - 如何确定加载/需要哪些库？

> ID：14882548
> 
> 赞同：1
> 
> 时间：2013-02-14T19:28:44.190
> 
> 标签：java, jar, libraries, loaded

我使用 Apache CXF、Spring、Hibernate 等使用 IntelliJ IDEA 开发 Web 服务应用程序。所有这些框架都附带了很多库，但我没有使用所有这些库。

目前，我浪费了大量时间来确定必须将哪些 jar 文件部署到生产环境中以确保系统正常工作。

是否有一种简单快捷的方法来确定我的应用程序加载/需要哪些库，更精确地加载/需要哪些 jar 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T12:31:25.363

尝试 Loosejar：**[http ://code.google.com/p/loosejar/](http://code.google.com/p/loosejar/)**

对于演示，我在我的 Eclipse 工作室中针对一个小型应用程序运行了 Loosejar 代理。该应用程序使用 4 个 jar（jsoup-1.6.1.jar、httpclient-4.2.3.jar、httpcore-4.2.2.jar、commons-logging-1.1.1.jar）。我在构建路径中添加了一个未使用的 jar 文件——“soap-2.3.1.jar”并启动了应用程序。然后打开 jconsole 并查看 LooseJarMBean 的摘要（下面的屏幕截图）。结果显示了每个 jar 中使用的类的数量。未使用的 jar 将以 0% 的利用率显示

![在此处输入图像描述](../Images/377b684d86ed516b0cf4956c2b17df99.png)

另一种方法是手动完成。在我们的一个项目中，我们手动将 jars 添加到项目中，直到所有编译问题都得到解决。这种方法有一个限制，如果一个 jar 引用另一个 jar，那么我们只能在运行时了解它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:49:25.943

尝试[依赖查找器](http://depfind.sourceforge.net/)，它可能能够列出您所有的库依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T12:59:27.880

使用[Maven](http://maven.apache.org/guides/getting-started/maven-in-five-minutes.html)。它是 Java 世界中最流行的依赖管理工具。

# scrapy - 在 python 中解析 html5 data-* 属性？

> ID：14882552
> 
> 赞同：1
> 
> 时间：2013-02-14T19:28:53.743
> 
> 标签：scrapy, custom-data-attribute

是否可以从 python 访问 html 元素的 data-* 部分？我正在使用 scrapy 并且 data-* 在选择器对象中不可用，尽管原始数据在 Request 对象中可用。

如果我使用转储 html，`wget -O page http://page.com`那么我可以看到文件中的数据。有点像`<a href="blah" data-mine="a;slfkjasd;fklajsdfl;ahsdf">blahlink</a>`

我可以在编辑器中编辑该`data-mine`部分，所以我知道它就在那里……似乎表现良好的解析器正在删除它。

如您所见，我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T00:40:15.810

我没有使用第三方库就这样做了：

```
import re
data_email_pattern = re.compile(r'data-email="([^"]+)"')
match = data_email_pattern.search(response.body)
if match:
    print(match.group(1))
    ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T19:24:11.473

是的，lxml 出于某种原因没有公开属性名称，Talvalin 是对的，html5lib 可以：

```
stav@maia:~$ python
Python 2.7.3 (default, Aug  1 2012, 05:14:39) [GCC 4.6.3] on linux2
>>> import html5lib
>>> html = '''<a href="blah" target="_blank" data-mine="a;slfkjasd;fklajsdfl;ahsdf"
... data-yours="truly">blahlink</a>'''
>>> for x in html5lib.parse(html, treebuilder='lxml').xpath('descendant::*/@*'):
...     print '%s = "%s"' % (x.attrname, x)
...
href = "blah"
target = "_blank"
data-mine = "a;slfkjasd;fklajsdfl;ahsdf"
data-yours = "truly" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T07:24:13.480

我没有尝试过，但是有 html5lib ( [http://code.google.com/p/html5lib/](http://code.google.com/p/html5lib/) ) 可以与 Beautiful Soup 一起使用，而不是使用 scrapy 的内置选择器。

# c# - c#/WPF openFile对话框打开两次

> ID：14882553
> 
> 赞同：2
> 
> 时间：2013-02-14T19:28:55.707
> 
> 标签：c#, wpf

当我单击按钮打开文件时，该`OpenFileDialog`框会打开两次。第一个框只打开图像文件和第二个框文本文件。如果用户决定关闭第一个框而不选择文件，则第二个框也会弹出。我不确定我在看这个问题。任何帮助，将不胜感激。谢谢！

```
OpenFileDialog of = new OpenFileDialog();   
of.Filter = "All Image Formats|*.jpg;*.png;*.bmp;*.gif;*.ico;*.txt|JPG Image|*.jpg|BMP image|*.bmp|PNG image|*.png|GIF Image|*.gif|Icon|*.ico|Text File|*.txt";

if (of.ShowDialog() == System.Windows.Forms.DialogResult.OK)
{
try
{
   image1.Source = new BitmapImage(new Uri(of.FileName));

    // enable the buttons to function (previous page, next page, rotate left/right, zoom in/out)
    button1.IsEnabled = false;
    button2.IsEnabled = false;
    button3.IsEnabled = false;
    button4.IsEnabled = false;
    button5.IsEnabled = true;
    button6.IsEnabled = true;
    button7.IsEnabled = true;
    button8.IsEnabled = true;                          
}
catch (ArgumentException)
{
    // Show messagebox when argument exception arises, when user tries to open corrupted file
    System.Windows.Forms.MessageBox.Show("Invalid File");
}
 }
 else if(of.ShowDialog() == System.Windows.Forms.DialogResult.OK)
 {
try
{
    using (StreamReader sr = new StreamReader(of.FileName))
    {
        textBox2.Text = sr.ReadToEnd();
        button1.IsEnabled = true;
        button2.IsEnabled = true;
        button3.IsEnabled = true;
        button4.IsEnabled = true;
        button5.IsEnabled = true;
        button6.IsEnabled = true;
        button7.IsEnabled = true;
        button8.IsEnabled = true;

    }
}
catch (ArgumentException)
{
    System.Windows.Forms.MessageBox.Show("Invalid File");
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:33:50.007

你打`ShowDialog()`了两次电话：

```
if (of.ShowDialog() == System.Windows.Forms.DialogResult.OK)
    {
       //...
    }
    else if(of.ShowDialog() == System.Windows.Forms.DialogResult.OK) 
```

只需调用一次，然后保存结果：

```
var dialogResult = of.ShowDialog();
if (dialogResult == System.Windows.Forms.DialogResult.OK)
{
       //...
}
// Note that the condition was the same!
else if(dialogResult != System.Windows.Forms.DialogResult.OK) 
```

* * *

编辑：

如果您希望第二个对话框仅在处理第一个对话框时显示，您可以执行以下操作：

```
var dialogResult = of.ShowDialog();
if (dialogResult == System.Windows.Forms.DialogResult.OK)
{
       //...

    // Do second case here -  Setup new options
    dialogResult = of.ShowDialog(); //Handle text file here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:33:43.003

您在and条件下`ShowDialog`都在调用。该方法负责显示对话框，并且只有告诉您用户单击了什么的好副作用。`if``else if`

将方法的结果存储在一个变量中，然后在 if..elseif 条件中检查它。

# jsf - 将参数传递给 c:foreach 循环内的 f:ajax

> ID：14882554
> 
> 赞同：1
> 
> 时间：2013-02-14T19:29:00.967
> 
> 标签：jsf, primefaces

我正在尝试将参数传递给 ajax 事件，这是我的意思的一个示例：

```
<h:panelGrid id="pictures" columns="3">
    <c:forEach items="#{createProduct.pictures}" var="picture">
        <h:graphicImage value="#{picture.source}" />
        <h:inputText value="#{picture.alt}" />
        <p:commandButton value="Remove">
            <f:ajax execute="@form" 
                    listener="#{createProduct.removePicture(picture)}" 
                    render="@form" />
        </p:commandButton>
    </c:forEach>
</h:panelGrid> 
```

我知道这段代码不起作用，因为您无法通过 ajax 侦听器传递参数。虽然这只是我想要完成的一个例子。我已经尝试将`<f:param id="picture" value="#{picture}" />`allong 与 ajax 标记一起使用，但这会导致重复的组件 ID 表单：图片，因为它处于循环中。我需要在方法中使用此参数以确定要删除的图片。我怎样才能用ajax解决这个问题？

我正在使用@ViewScoped CDI-bean。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:54:47.197

首先，我建议用`c:forEach`标签`ui:repeat`替换。其次，当你使用 Primefaces 时，你应该使用它的全部力量。所以，`commandButton`可以更容易地写成：

```
<p:commandButton value="Remove" process="@form" update="@form" action="#{createProduct.removePicture(picture)}"/> 
```

就是这样。不要复杂化。

顺便说一句，primefaces`commandButton`默认发送 AJAX 请求，你不需要（而且你不能使用）`f:ajax`标签。

# php - PHP - dns_get_record - 为什么 DNS_PTR 总是返回一个空数组？

> ID：14882557
> 
> 赞同：1
> 
> 时间：2013-02-14T19:29:12.617
> 
> 标签：php

我正在尝试获取域的 ptr 记录。

出于某种原因，当我尝试使用 dns_get_record 执行此操作时，它会不断地返回为空。

我最初确实尝试过这个并得到了一系列结果，但现在它每次都返回一个空数组......有人可以提出这种行为背后的原因吗？

```
$result = dns_get_record("webstorm.co.za", DNS_PTR);
print_r($result); 
```

输出：

```
Array() 
```

什么时候会填充值？

任何建议、建议或反馈将不胜感激，因为我一生都无法弄清楚为什么现在会发生这种情况！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:32:37.360

**更新**

尝试

```
$result = dns_get_record("41.78.244.4.in-addr.arpa.", DNS_PTR);
print_r($result); 
```

输出：

```
Array
(
    [0] => Array
        (
            [host] => 41.78.244.4.in-addr.arpa
            [class] => IN
            [ttl] => 108002
            [type] => PTR
            [target] => dialup-4.244.78.41.Dial1.StLouis1.Level3.net
        )

) 
```

您不会从域名中获得 prt 。您需要以反向名称运行它。

你可以在这里获得更多信息： [http ://www.menandmice.com/knowledgehub/dnsqa/56/](http://www.menandmice.com/knowledgehub/dnsqa/56/)

# neo4j - Cypher 查询将相关节点作为子节点返回

> ID：14882562
> 
> 赞同：1
> 
> 时间：2013-02-14T19:29:31.323
> 
> 标签：neo4j, cypher

我正在使用 Neo4j .NET 客户端`ExecuteGetCypherResults`来运行密码。它希望所有内容都在一个列中返回。我有一个简单的类`JobType`，其中包含一个列表`JobSpecialties`。在数据库中，这被建模为与专业有关系的类型。

![在此处输入图像描述](../Images/10d5c622e3595c9c348b9a23c17dc314.png)

我需要一个密码查询，它在单个列中返回结果。相关的`Specialties`应该是`Type`节点的子属性，我希望查询看起来像这样：

```
start s=node:node_auto_index(StartType='JobTypes')
match s-[:starts]->t, t-[:SubTypes]->ts
return {Id: t.Id, Name: t.Name, JobSpecialties: ts} 
```

但这不起作用。我无法从文档中弄清楚这是否可能。如果有更好的方法将结果返回给 .Net 客户端，我愿意接受建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T09:10:15.423

```
start s=node:node_auto_index(StartType='JobTypes')
match s-[:SubTypes]->js
return s.Id, s.Name,  js; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T17:26:59.787

`ExecuteGetCypherResults`确实支持多列，您只需要将我们的反序列化器踢到不同的模式。这是一个通常隐藏在我们更高级别 API 后面的实现细节，这就是为什么这并不明显。

当你打电话时`new CypherQuery`，通过`CypherResultMode.Projection`而不是`CypherResultMode.Set`。

我真的不记得为什么我们有这个。有时，我需要挖掘较低的级别并尝试杀死它。欢迎拉取请求。:)

不过，作为一种偏好，我们总是更喜欢人们使用更高级别的 API（但我们认识到存在一些限制）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T17:39:49.543

听起来 .Net 客户端需要对密码进行一些更新。Cypher 还不支持即时构建地图，尽管它已经在功能请求列表中......

您可以使用您的结果创建一个数组（但从 1.9.M04 开始，它们需要是相同的类型才能合并到数组中）： [http ://console.neo4j.org/r/xo7voi](http://console.neo4j.org/r/xo7voi)

我实际上已经提交了一个拉取请求（通过反向渠道，因为它破坏了一些单元测试）来解决这个问题（所以你可以在动态构建的数组中有多种类型），但我认为是否合并不同的类型是个好主意。

[https://github.com/wfreeman/neo4j/commit/ca457ace0df4732376833b8694e4affac4143244](https://github.com/wfreeman/neo4j/commit/ca457ace0df4732376833b8694e4affac4143244)

*更新：*这将在 1.9.M05/1.9.GA 中修复。现在您可以构建一个混合任何类型的数组：http: [//console.neo4j.org/r/vm4f83](http://console.neo4j.org/r/vm4f83)

# c# - IIS 中的应用程序内部的应用程序

> ID：14882564
> 
> 赞同：0
> 
> 时间：2013-02-14T19:29:32.443
> 
> 标签：c#, entity-framework, iis, entity, entity-framework-5

我有 2 个项目，并且都使用实体框架。

我的项目

我的项目管理员

现在当我部署到文件系统中的 IIS 时

我有网址

localhost/MyProject -> 这个项目包含它的所有视图、bin 等

和

localhost/MyProject/Admin -> 这个项目包含它的所有视图、bin 等

我将它们都转换为 Web 应用程序。

现在，如果我运行 MyProject，网站可以正常工作。

但是如果我转到 MyProject/Admin 那么我会收到错误消息

“/MyProject/Admin”应用程序中的服务器错误。

找不到类型“System.Data.Entity.Infrastructure.SqlConnectionFactory”的构造函数。

但是让我们说如果我有单独的 MyProject

然后它工作得很好。

任何帮助，将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T14:50:31.213

我假设你现在已经成功了。

我认为它正在获取 localhost/MyProject 而不是 localhost/MyProject/Admin 的 web.config

# android - 原始文件“AndroidManifest.xml”已被删除或无法访问

> ID：14882568
> 
> 赞同：10
> 
> 时间：2013-02-14T19:29:46.003
> 
> 标签：android, android-manifest

出色地。我已经将一个项目导入到我的 Eclipse 中，现在每当我保存一个 xml 文件时，都会出现这个弹出窗口，例如“**原始文件 '*.xml' 已被删除或无法访问。** ”我已经清理并修复了我的项目几次但没有用。

有人解决了这个问题吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-07-27T14:54:56.417

尝试重新启动 Eclipse。我有同样的错误消息，但我没有做任何特别的事情，比如导入项目——我已经重新启动了 Eclipse，它现在正在工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:34:31.110

# 地方历史

右键单击您的项目并说从本地历史记录中替换。如果您删除了该文件，您会在历史记录中找到它。

**或者**

你可以去你的工作区->你的项目文件夹，看看那里是否有清单吗？

# wikipedia-api - 如何获取维基百科页面中的所有 URL

> ID：14882571
> 
> 赞同：9
> 
> 时间：2013-02-14T19:29:57.770
> 
> 标签：wikipedia-api

似乎 Wikipedia API 对链接的定义与 URL 不同？我正在尝试使用 API 返回特定 wiki 页面中的所有 url。

我一直在玩[这个查询](http://en.wikipedia.org/w/api.php?action=query&generator=links&titles=Title&prop=links&redirects)，我在[这个页面](http://www.mediawiki.org/wiki/API%3aQuery#Generators)的生成器和重定向下找到了这个查询。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T21:37:23.893

我不确定您到底为什么会感到困惑（如果您对此进行解释会有所帮助），但我很确定该查询不是您想要的。它列出了从页面“标题”( ) 链接 ( `prop=links`) 的页面上的链接 ( )。它还仅列出第一页链接上的第一页链接（页面大小为微小的默认值 10）。`generator=links``titles=Title`

如果要获取“标题”页面上的所有链接：

1.  使用 just `prop=links`，您不需要生成器。
2.  `pllimit=max`通过添加（`pl`是 的“前缀” `links`）将限制增加到可能的最大值
3.  使用`query-continue`元素中给定的值来访问结果的第二页（和后续页）。

因此，第一页的查询将是：

[http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links&pllimit=max](http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links&pllimit=max)

第二页（在本例中为最后一页）：

[http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links&pllimit=max&plcontinue=226160|0|Lieutenant_General](http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links&pllimit=max&plcontinue=226160|0|Lieutenant_General)

可能让您感到困惑的另一件事是`links`只返回内部链接（到其他维基百科页面）。要获取外部链接，请使用`prop=extlinks`. 您还可以将两者合并为一个查询：

[http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links|extlinks](http://en.wikipedia.org/w/api.php?action=query&titles=Title&prop=links|extlinks)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-09-18T00:03:22.050

这是一个 Python 解决方案，它获取（并打印）从特定页面链接到的所有页面。它获取第一个请求中的最大链接数，然后查看返回的 JSON 对象是否具有“继续”属性。如果是这样，它会将“plcontinue”值添加到 params 字典并发出另一个请求。（返回的最后一页结果不会有这个属性。）

```
import requests

session = requests.Session()

url = "https://en.wikipedia.org/w/api.php"
params = {
    "action": "query",
    "format": "json",
    "titles": "Albert Einstein",
    "prop": "links",
    "pllimit": "max"
}

response = session.get(url=url, params=params)
data = response.json()
pages = data["query"]["pages"]

pg_count = 1
page_titles = []

print("Page %d" % pg_count)
for key, val in pages.items():
    for link in val["links"]:
        print(link["title"])
        page_titles.append(link["title"])

while "continue" in data:
    plcontinue = data["continue"]["plcontinue"]
    params["plcontinue"] = plcontinue

    response = session.get(url=url, params=params)
    data = response.json()
    pages = data["query"]["pages"]

    pg_count += 1

    print("\nPage %d" % pg_count)
    for key, val in pages.items():
        for link in val["links"]:
            print(link["title"])
            page_titles.append(link["title"])

print("%d titles found." % len(page_titles)) 
```

此代码改编自[MediaWiki API:Links](https://www.mediawiki.org/wiki/API:Links)示例中的代码。

# arrays - ocaml lcs 没有像 Array 这样的对象

> ID：14882573
> 
> 赞同：2
> 
> 时间：2013-02-14T19:30:07.747
> 
> 标签：arrays, ocaml, fold, lcs

如何在不使用数组且仅列出 ocaml 中的折叠的情况下找到最长的公共子序列

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T09:23:25.707

这是[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)的一个经典例子：可以很容易地递归指定要实现的函数，但是与递归调用对应的子问题有很多重叠。一个简单的递归实现将通过重新计算这些子问题来做无用的工作，从而导致指数运行时间，而记忆化或不同的方法会导致多项式算法。

[维基百科](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)上给出的最长公共子序列（LCS）问题的公式 如下（伪代码）：

```
LCS(X,Y,0,0) = []
LCS(X,Y,i,j) =
  if X[i] = Y[j] then X[i]::LCS(X,Y,i-1,j-1)
  else longest(LCS(X,Y,i-1,j), LCS(X,Y,i,j-1)) 
```

当转换为将列表而不是数组和索引作为参数时，您有以下公式（仍然是伪代码）：

```
LCS([], []) = []
LCS([x],[]) = []
LCS([], [y]) = []
LCS(x::xs, y::ys) =
  if x = y then x::LCS(xs, ys)
  else longest(LCS(x::xs, ys), LCS(xs, y::ys)) 
```

从中得到一个 OCaml 实现应该很容易（我假设这是一个练习，会让你自己来解决），但这将是一个指数算法，`O(2^N)` 在输入的最坏情况下运行时间 length `N`。

要查看示例中效率低下的原因，假设输入是`[x;y;z]`并且`[x';y';z']`与`x`不同`x'`。`lcs [x;y;z] [x';y';z']`将进行两次递归调用，一次`lcs [y;z] [x';y';z']`和一次`lcs [x;y;z] [y';z']`。但随后这两个电话将分别拨打两个电话，`lcs [z] [x';y';z']`第`lcs [y;z] [y';z']` 一个电话`lcs [y;z] [y';z']`，`lcs [x;y;z] [z']`第二个电话。请注意，它们都进行了递归调用`lcs [y;z] [y';z']`，因此将计算两次。对于足够长的输入，其他子调用会被重新计算任意多的时间。

避免这种低效率的解决方案是构建一个只计算每个结果一次的数据结构。执行此操作的传统方法是使用可变的 2D 矩阵来存储结果，但不允许使用它。您可以使用函数式数据结构来存储结果，方法是计算对应于的列表列表

```
[
  [lcs [x;y;z] [x';y';z']; lcs [x;y;z] [y';z']; lcs [x;y;z] [z']; lcs [x;y;z] [];]; 
  [lcs [y;z] [x';y';z'];   lcs [y;z] [y';z'];   lcs [y;z] [z'];   lcs [y;z] [];];
  [lcs [z] [x';y';z'];     lcs [z] [y';z'];     lcs [z] [z'];     lcs [z] [];];
  [lcs [] [x';y';z'];      lcs [] [y';z'];      lcs [] [z'];      lcs [] [];];
] 
```

找到一种简单的递归方法来计算这个结果列表似乎是一个有趣的高级练习。例如，您可以递归地计算第 4 边的这个“正方形”，通过计算边 3 的右下角子正方形，然后将其折叠（作为列表列表）以计算结果正方形的左侧，然后折叠它的行（列表列表的头部）来计算结果正方形的顶部。更一般地说，您可以定义一个函数，该函数`lcs_results xs ys`采用两个长度序列`M`并`N`返回与`MxN`将由 计算的所有子结果相对应的列表列表`lcs xs ys`，以这种方式组织。

但是，我假设您只是在寻找简单的指数公式（再次，看起来像一个教学练习）。

# wordpress - 在具有自定义帖子类型的插件中使用 wp_delete_post 删除内容

> ID：14882577
> 
> 赞同：0
> 
> 时间：2013-02-14T19:30:31.343
> 
> 标签：wordpress, custom-post-type, dummy-data

我设置了一个插件，它添加了一个自定义帖子类型，然后在激活时引入了一堆带有 wp_insert_post 的虚拟内容，如下所示：

```
 register_activation_hook( __FILE__, array( $this, 'activate' ) );
public function activate( $network_wide ) {
        include 'dummycontent.php';
        foreach ($add_posts_array as $post){
        wp_insert_post( $post );
    };
} // end activate 
```

我想在插件停用时删除此内容，因此我设置了此功能：

```
 register_deactivation_hook( __FILE__, array( $this, 'deactivate' ) );
   public function deactivate( $network_wide ) {
        include 'dummycontent.php';
    foreach($remove_posts_array as $array){
        $page_name = $array["post_title"];
        global $wpdb;
        $page_name_id = $wpdb->get_results("SELECT ID FROM " . $wpdb->base_prefix . "posts WHERE post_title = '". $page_name ."'");
        foreach($page_name_id as $page_name_id){
            $page_name_id = $page_name_id->ID;
            wp_delete_post( $page_name_id, true );
        };
    };      
} // end deactivate 
```

它工作得很好。除了因为自定义帖子类型是使用运行这两个函数的相同插件创建的，帖子类型在帖子本身可以通过之前被删除`wp_delete_post`。当我在没有自定义帖子类型的情况下测试这些功能时，帖子会在激活时添加并在停用时删除。所以我知道问题出在帖子类型上。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T21:43:01.713

尝试这样的事情（YOUTPOSTTYPE 是您的帖子类型的名称）：

```
function deactivate () {
  $args = array (
    'post_type' => 'YOURPOSTTYPE',
    'nopaging' => true
  );
  $query = new WP_Query ($args);
  while ($query->have_posts ()) {
    $query->the_post ();
    $id = get_the_ID ();
    wp_delete_post ($id, true);
  }
  wp_reset_postdata ();
} 
```

它适用于我的插件，它应该适用于您的插件。（这已经用 WordPress 3.5.1 测试过）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-30T19:48:18.990

**`wp_delete_post($ID, false)`将其发送到垃圾箱。**只有当您从垃圾箱中删除时，帖子才会真正被删除。这就是为什么它与`$force = true`.

所以它按预期工作。第一个帖子进入垃圾箱，然后它们实际上被删除。比如回收站。`post_status`如果您想执行任何操作，请跟踪更改以查看它何时进入废纸篓。否则等待删除。

**[还要在卸载](http://codex.wordpress.org/Function_Reference/register_uninstall_hook)而不是停用时删除内容。**考虑停用插件作为暂停它并在您真正希望它消失时将其卸载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-04T09:58:18.147

试试这个功能

```
function deactivate () {             
        $args = array(
            'post_type'      => 'POST_TYPE', 
            'posts_per_page' => - 1
        );

        if ( $posts = get_posts( $args ) ) {
            foreach ( $posts as $post ) {
                wp_delete_post( $post->ID, true );
            }
        }
    } 
```

# asp.net - ASP.NET 多个联合身份提供程序

> ID：14882581
> 
> 赞同：2
> 
> 时间：2013-02-14T19:30:39.997
> 
> 标签：asp.net, wif, adfs

我正在开发一个 ASP.NET 应用程序。我已成功添加对独立 AD FS 2.0 服务器的 STS 引用，因此我可以针对第 3 方的活动目录进行身份验证。问题是我有不止一个客户希望能够针对他们自己的活动目录进行身份验证。看来我只能为一个项目添加一个 STS 引用。如何将多个身份提供程序添加到 ASP.NET 应用程序，然后以编程方式选择要将浏览器重定向到哪个提供程序以进行身份​​验证？谢谢！

拉尔菲

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:48:41.960

这不是正常的联邦模式。

您通常使用 FedUtil 将您的应用程序“绑定”到一个 STS（例如 STS1），然后在 STS 级别与其他 STS（例如 STS2 和 STS3）联合。然后，当用户访问应用程序时，WIF 重定向到 STS1，您会看到一个“Home Realm Discovery”屏幕，询问“您希望对谁进行身份验证（STS1 / STS2 / STS3）。

您的问题并未表明您是否已经知道这一点，或者您是否想知道如何针对多个 STS 进行身份验证。

**更新**：您可以使用 VS 创建自定义 STS - 不确定 HRD 是否开箱即用。您还需要满足哪些其他身份验证存储？为什么你认为你需要一个定制的 STS？您可以使用多个相互联合的 ADFS 实例，或者将 ADFS 与 PingIdentity 或 OpenAM 联合...看看[IdentityServer](http://thinktecture.github.com/)。这是一个定制的 STS，它是一个非常好的基础。

**更新 2**：是的 - 你是对的。

# android - 如何避免在 apk 中包含 jnic c 源代码文件

> ID：14882585
> 
> 赞同：0
> 
> 时间：2013-02-14T19:30:57.997
> 
> 标签：android, java-native-interface, apk

我不知道这是一个错误还是某处是否有选项，但我的 jni 文件夹中的所有 c 源代码文件都包含在我的 apk 文件中。不是一个好主意。更准确地说，似乎这些文件复制到 bin/classes 然后 apk 将它们全部压缩。如果我从 bin/classes 中删除文件，则不会在没有 jni 重建的情况下将它们复制回来。任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:18:19.180

您正在使用 Eclipse，不是吗？您可能已经在*J​​ava 路径*`jni`中列出了源文件夹。从那里删除它，您的 C 文件将不再复制到 bin/classes 中。

# c++ - 正确签名/检测 Container::reserve() 的存在

> ID：14882588
> 
> 赞同：11
> 
> 时间：2013-02-14T19:31:00.013
> 
> 标签：c++, c++11, std, enable-if

给定一个`C`符合 STL 的容器类型，我如何正确检测是否`C`包含成员函数`reserve`？我尝试了以下方法（使用 GCC 4.6.3）：

```
template< typename C, typename = void >
struct has_reserve
  : std::false_type
{};

template< typename C >
struct has_reserve< C, typename std::enable_if<
                         std::is_same<
                           decltype( &C::reserve ),
                           void (C::*)( typename C::size_type )
                         >::value
                       >::type >
  : std::true_type
{}; 
```

这适用于`C`being `std::vector`，但不适用于无序容器，例如`std::unordered_set`。原因是，那`reserve`是 的（直接）成员函数`std::vector`，但对于无序容器，它是从基类继承的，即它的签名不是`void (C::*)( typename C::size_type )`，而是`void (B::*)( typename C::size_type )`针对 的某些未指定的基`B`类`C`。

我知道如何解决它并检测`reserve`即使是继承的，但它看起来很笨拙，我想知道标准允许什么。所以...

我的问题是：标准是否允许`reserve`从未指定的基类继承，还是概要绑定并需要直接成员函数？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-14T21:11:33.533

所有关于从基类继承的标准都是允许的：

> ### 17.6.5.11 派生类[派生]
> 
> 1 - 实现可以从具有为实现保留名称的类派生 C++ 标准库中的任何类。

它并没有说明是否允许从基类继承方法（实际上还有其他成员，例如 typedefs）。显然，由于实现是这样做的，标准应该描述这种行为。

在任何情况下，`reserve`即使是最派生类型的成员，也不能保证通过强制转换为成员函数类型进行检测，因为：

> ### 17.6.5.5 成员函数[member.functions]
> 
> 2 - 一个实现可以在一个类中声明额外的非虚拟成员函数签名：
> 
> *   通过将具有默认值的参数添加到成员函数签名^(186)；[...]
> 
> 186) 因此，C++ 标准库中类的成员函数的地址具有未指定的类型。

检查是否`reserve`存在的正确方法是尝试调用它：

```
template< typename C, typename = void >
struct has_reserve
  : std::false_type
{};

template< typename C >
struct has_reserve< C, typename std::enable_if<
                         std::is_same<
                           decltype( std::declval<C>().reserve( std::declval<typename C::size_type>() ) ),
                           void
                         >::value
                       >::type >
  : std::true_type
{}; 
```

这具有并行容器*要求*（表 103 的`unordered_set`）的优点，这是规范的，其中提要更倾向于提供信息。

# python - Python 2.5 上的 Sqlite3 太慢了

> ID：14882597
> 
> 赞同：0
> 
> 时间：2013-02-14T19:31:31.097
> 
> 标签：python, sqlite

当我使用 Python 2.5 访问 Sqlite 数据库时，花费的时间太长，但如果我通过其他方式（包括 Python 3.2）访问同一个数据库，则花费的时间要短得多。这是怎么回事？（我需要 Python 2.5，无法切换到 Python 3.2）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:31:24.210

不用说，如果您使用旧版本的程序，您将无法获得后来添加的性能改进、错误修复和功能添加。Python 2.5 在很多方面都比 2.7（或 3.2）更慢、更容易出错且功能更弱，而且在大多数情况下，唯一的解决方案是“停止使用 2.5”，除非您想追踪更改日志和反向移植中的具体改进它到 2.5 代码库。

但是在这种情况下，它就容易多了，因为`sqlite3`它是独立于 Python 开发的（实际上，在 2.5 之前，它甚至都没有内置），如[`pysqlite`](http://code.google.com/p/pysqlite/). 这是一些版本历史记录（如[2.6](http://docs.python.org/2/whatsnew/2.6.html)和[2.7](http://docs.python.org/2/whatsnew/2.7.html)的新增功能文档中所示）：

*   Python 2.5：pysqlite 2.3.2
*   Python 2.6：pysqlite 2.4.1
*   Python 2.7：pysqlite 2.6.0

最新版本是 2.6.3。您可以使用任何常用方法安装它（`pip`、`easy_install`、从网站下载并按照说明进行操作、从网站下载 Windows 二进制安装程序并运行它们等）。

事实上，如果你正在使用`setuptools`/构建一个包`distribute`，你可能只需对 提出一个要求`>= 2.6.0`，`pip install mypackage`就会自动获得 2.5（和 2.6 用户）的新版本。

您的问题也可能出在底层 C`sqlite3`库上，而不是`pysqlite`包装器上。如果你安装`sqlite3`然后`pysqlite`从源代码构建，你也可以解决这个问题。

如果你不确定你有哪个版本，你可以在运行时检查，因为模块有一个人类可读的`version`属性（和一个`version_info`元组，就像 中的那个`sys`，所以你可以检查`version_info >= (2, 6)`），同样`sqlite_version`，`sqlite_version_info`对于底层 C 库.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:35:46.857

除了 abarnert 的出色回答外，看看你提交的频率。SQLite 中的提交速度很慢，如果推迟提交，通常会带来性能优势。我自己在[其他一些测试](http://www.sqlservercentral.com/articles/Performance/90243/)中遇到了这个问题，减少提交次数的性能差异是巨大的。

# algorithm - 什么是订单统计和最小的？

> ID：14882598
> 
> 赞同：3
> 
> 时间：2013-02-14T19:31:32.467
> 
> 标签：algorithm, statistics, divide-and-conquer

这个学期我有一个算法课程。一切都很好，直到我参加了关于订单统计的讲座。

这是该讲座的第一张幻灯片：

```
Order Statistics
Select the ith smallest of n elements (the
element with rank i).
• i = 1: minimum;
• i = n: maximum;
• i = ⎣(n+1)/2⎦ or ⎡(n+1)/2⎤: median.
Naive algorithm: Sort and index ith element.
Worst-case running time = Θ(n lg n) + Θ(1)
= Θ(n lg n) 
```

我无法理解以下内容：

什么是**订单统计**？

**在第 i 个最小的 n 元素**上是什么意思？请我需要一个例子来知道什么是“ith”！

关于这些有什么简单的解释吗？

我所知道的是这与分而治之有关，因为下一张幻灯片就是关于它的:)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:35:53.037

[*“顺序统计”*](http://en.wikipedia.org/wiki/Order_statistic)是“按升序排序的 N 元素序列的第 K 个元素”的花哨名称。幻灯片的其余部分简单地说明了这个想法，解释了 1 阶统计量是序列中的最小元素，n 阶统计量是最大元素，`n/2`阶数统计量是中*位数*，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-22T22:58:05.963

它的顺序统计与数组中的第 i 个最小元素相同。例如，假设我们有一个数组 A[Size] ={ 3,4,-3,-2,0, 1,10,2,14} 并且我们想要对应于第 4 个的元素。排序统计，然后我们的函数或程序将返回值 1。此算法利用随机分区和对随机选择函数的递归调用。

伪代码如下：

```
 RSelect( Array[], p,r, i)

 if p == r
      return A[p]
 q = RandomPartition(Array[],p,r)
 k = q - p + 1
 if i == k // case that the pivot is the answer 
 return Array[q]

 else if i<k
     return RSelect(Array,p, q-1,i)
 else
     return RSelect(Array, q+1, r, i-k) 
```

该算法是一种分治算法，它使用递归来分解问题，方法是选择在随机分区函数中完成的随机枢轴，以帮助对数组进行分区并抛出大于或小于枢轴的值，具体取决于关于第 i 个 Order 统计量是否大于或小于枢轴。例如，如果它的顺序统计量小于枢轴，它将丢弃大于枢轴的值。因为在 Partition 函数中返回的枢轴值在它的正确位置。

# rdlc - 如果所有带表达式的行中都没有数据，如何隐藏 RDLC 表列？

> ID：14882600
> 
> 赞同：0
> 
> 时间：2013-02-14T19:31:38.323
> 
> 标签：rdlc, rdl

如果在 RDLC 报告中的所有行都为空或没有带有表达式的值，我想隐藏包括标题在内的整个列。

我试过表达

```
"=IIF(IsNothing(Fields!de_projectactivityidname.Value), True, False)" 
```

在 Column 属性的“可见性”内。

我想在没有任何报告参数的情况下执行此操作。

任何帮助表示赞赏。

维努

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-14T06:24:03.033

我认为您走在正确的轨道上，但该字段可能永远不会为空/无。相反，它很可能是一个空字符串。

这应该有效：

```
=IIF((Fields!de_projectactivityidname.Value = ""), True, False) 
```

# openid - WSO2 身份服务器 - 使用 Gmail 等 OpenID 登录

> ID：14882601
> 
> 赞同：0
> 
> 时间：2013-02-14T19:31:35.070
> 
> 标签：openid, wso2

我通过 OpenID 演示登录。它要求我将 openid 传递给 WSO2 服务器，例如：

```
https://myservername:9443/openid/firstname.lastname 
```

我真正想要的是让登录工作流程看起来像 Gmail。即，如果会话未启动，用户将被重定向到登录页面，他们在其中输入用户/名称密码、提供 pki 证书等。有关如何设置的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T06:14:25.527

这个有可能。您需要创建 OpenID 身份验证请求`https://myservername:9443/openid/`（注意：在 url 中没有名称）作为 OpenID 标识符。

只需为上述标识符创建一个身份验证请求，将用户重定向到 IS，然后 IS 将提示输入用户名和密码。

# php - 返回、回显和使用 php 创建表单

> ID：14882617
> 
> 赞同：0
> 
> 时间：2013-02-14T19:32:53.877
> 
> 标签：php, html, forms, return, echo

这个问题建立在[我问过的上一个问题的基础上，这个问题本质上是相似的。](https://stackoverflow.com/questions/14862845/html-not-printing-out-the-way-i-expect-it-to-in-the-webpage-source/14862922#14862946)这个问题是一个两部分的问题，关于 html 显示在屏幕上的方式，基于下面的类。

根据对该问题的回答，我创建了以下内容：

```
class Form{

    protected $_html = '';

    public function __construct(){
        $this->init();
    }

    public function init(){

    }

    public function open_form(){
        $this->_html .= '<form>';
    }

    public function elements(){
        $this->_html .= 'element';
    }

    public function close_form(){
        $this->_html .= '</form>';
    }

    public function create_form(){
        $this->open_form();
        $this->elements();
        $this->close_form();
    }

    public function __toString(){
        return $this->_html;
    }
} 
```

这门课的问题是，如果我这样做：

```
$form = new Form
echo $form->create_form(); 
```

然后什么都没有打印出来。如果我更改 create_form 以执行以下操作：

```
 public function create_form(){
        $this->open_form();
        $this->elements();
        $this->close_form();

        echo $this->_html;    
    } 
```

然后它起作用了，我看到了：

```
<form>elements</form> 
```

**为什么是这样？我将如何解决它？**

这个问题的第二部分是我有一个函数，不，我**不能改变这个函数的输出**，它将隐藏字段回显到一个表单中**。**问题是如果我这样做：

```
 public function create_form(){
        $this->open_form();
        $this->elements();
        function_echoes_hidden_fields();
        $this->close_form();

        echo $this->_html;    
    }

    // Sample function to echo hidden fields.
    public function function_echoes_hidden_fields(){
        echo "hidden fields";
    } 
```

我现在看到：

```
"hidden fields"
<form>elements</form> 
```

**你会如何解决这个问题？**

我所知道的是，return 返回一个值以供进一步处理，这意味着如果要显示该值，则必须回显返回该值的函数，而 echo 将立即转义处理并回显该值。

我的问题是，我试图将它们一起使用，以创建一个表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:36:28.723

调用 create_form 然后回显该类。

```
$form = new Form
$form->create_form();
echo $form; 
```

或添加`return $this->_html;`到 create_form() 并且您现有的代码将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:38:15.633

更改`create_form`为

```
public function create_form(){
        $this->open_form();
        $this->elements();
        $this->close_form();
        return $this->_html;
    } 
```

将 function_echoes_hidden_​​fields 更改为

```
public function function_echoes_hidden_fields(){
        $this->_html .= 'hidden fields';
    } 
```

**更新：** 或创建一个新类

```
class newFrom extends Form{
public function get_form()
{
        return $this->_html;
}
public function create_form(){
    $this->open_form();
    $this->elements();
    $this->function_echoes_hidden_fields()
    $this->close_form();

    return $this->_html;
}
public function function_echoes_hidden_fields(){
    $this->_html .= 'hidden fields';
}
};
$form = new newFrom;
$form->create_form();
echo $form->get_form(); 
```

# sql-server-2008 - 将时间值格式化为 HH:MM:SS

> ID：14882619
> 
> 赞同：0
> 
> 时间：2013-02-14T19:32:58.297
> 
> 标签：sql-server-2008, time

从数据库中检索时，我如何能够修剪 Time DataType？

```
Value from the Database : 08:00:00.0000000
What I need : 08:00:00 only 
```

我是 SQL Server 2008，VB.Net 2010

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:36:29.097

您并没有真正修剪（即删除前导或尾随空格），但其中任何一个都应该在 SQL 中工作：

```
SELECT CAST(@YourValue as time(0)) 
```

或者

```
SELECT LEFT(@YourValue, 8) 
```

或者

```
SELECT CAST(@YourValue as char(8)) 
```

# .net - 在 32 位操作系统上编译的 .NET 程序可以在单声道下在 64 位 Linux 系统上运行而没有任何问题吗？

> ID：14882622
> 
> 赞同：0
> 
> 时间：2013-02-14T19:33:06.700
> 
> 标签：.net, linux, mono, crash, 64-bit

我在 Windows 7 32 位系统上编写了一个程序，并在另一台机器上测试在 64 位 linux 系统上运行它。它正在显示运行时问题，如下所示。然而，我们甚至将我们的 MONO 更新到了最新的稳定版本。

```
======= Backtrace: =========                                                                         
/lib64/libc.so.6(+0x73476)[0x7f40404ca476]                                                           
/usr/lib64/libgdiplus.so.0(+0x34352)[0x7f403d9d5352]                                                 
/usr/lib64/libgdiplus.so.0(GdipCombineRegionRect+0xc8)[0x7f403d9d6b08]                               
/usr/lib64/libgdiplus.so.0(GdipCombineRegionRectI+0x4f)[0x7f403d9d6c7f]                              
[0x41868dd7]                                                                                         
======= Memory map: ========                                                                         
00400000-006e0000 r-xp 00000000 08:05 524278                             /usr/bin/mono               
008e0000-008e1000 r--p 002e0000 08:05 524278                             /usr/bin/mono               
008e1000-008ea000 rw-p 002e1000 08:05 524278                             /usr/bin/mono               
008ea000-00924000 rw-p 00000000 00:00 0                                                              
00b9a000-04038000 rw-p 00000000 00:00 0                                  [heap]
40027000-40038000 rwxp 00000000 00:00 0 
400f2000-40103000 rwxp 00000000 00:00 0 
401b0000-401d2000 rwxp 00000000 00:00 0 
4023f000-40250000 rwxp 00000000 00:00 0 
402f1000-40313000 rwxp 00000000 00:00 0 
4039b000-403bd000 rwxp 00000000 00:00 0 
40495000-404a6000 rwxp 00000000 00:00 0 
405fb000-4060c000 rwxp 00000000 00:00 0 
40627000-40638000 rwxp 00000000 00:00 0 
4078e000-4079f000 rwxp 00000000 00:00 0 
407a4000-407b5000 rwxp 00000000 00:00 0 
40965000-40976000 rwxp 00000000 00:00 0 
40a6d000-40a7e000 rwxp 00000000 00:00 0 
40ad6000-40ae7000 rwxp 00000000 00:00 0 
40b52000-40b63000 rwxp 00000000 00:00 0 
40b7b000-40b8c000 rwxp 00000000 00:00 0 
40c35000-40c46000 rwxp 00000000 00:00 0 
40dda000-40deb000 rwxp 00000000 00:00 0 
40ebd000-40ece000 rwxp 00000000 00:00 0 
40ee1000-40ef2000 rwxp 00000000 00:00 0 
40f48000-40f49000 r--p 00000000 00:00 0 
40f49000-40f5a000 rwxp 00000000 00:00 0 
40fca000-40fdb000 rwxp 00000000 00:00 0 
410f2000-410f3000 ---p 00000000 00:00 0 
411fa000-4120b000 rwxp 00000000 00:00 0 
4122f000-41240000 rwxp 00000000 00:00 0 
412d3000-412e4000 rwxp 00000000 00:00 0 
413ab000-413bc000 rwxp 00000000 00:00 0 
413c4000-413d5000 rwxp 00000000 00:00 0 
41456000-41478000 rwxp 00000000 00:00 0 
414a0000-414b1000 rwxp 00000000 00:00 0 
41698000-416a9000 rwxp 00000000 00:00 0 
416d3000-416e4000 rwxp 00000000 00:00 0 
416f6000-41707000 rwxp 00000000 00:00 0 
41808000-41819000 rwxp 00000000 00:00 0 
41868000-4188a000 rwxp 00000000 00:00 0 
419b2000-419c3000 rwxp 00000000 00:00 0 
41ae8000-41af9000 rwxp 00000000 00:00 0 
41bc8000-41bd9000 rwxp 00000000 00:00 0 
41cc2000-41cd3000 rwxp 00000000 00:00 0 
41d75000-41d86000 rwxp 00000000 00:00 0 
41ddb000-41dec000 rwxp 00000000 00:00 0 
41e0c000-41e1d000 rwxp 00000000 00:00 0 
41e91000-41ea2000 rwxp 00000000 00:00 0 
41ecd000-41ede000 rwxp 00000000 00:00 0 
41f41000-41f52000 rwxp 00000000 00:00 0 
41fbf000-41fd0000 rwxp 00000000 00:00 0 
7f4028000000-7f402804b000 rw-p 00000000 00:00 0 
7f402804b000-7f402c000000 ---p 00000000 00:00 0 
7f402cf2e000-7f402cf32000 rw-p 00000000 00:00 0 
7f402cf32000-7f402cf3b000 ---p 00000000 00:00 0 
7f402cf3b000-7f402d653000 rw-p 00000000 00:00 0                          [stack:23710]
7f402d653000-7f402d6f9000 r-xp 00000000 08:05 396413                     /usr/lib64/libsqlite3.so.0.8.6
7f402d6f9000-7f402d8f9000 ---p 000a6000 08:05 396413                     /usr/lib64/libsqlite3.so.0.8.6
7f402d8f9000-7f402d8fb000 r--p 000a6000 08:05 396413                     /usr/lib64/libsqlite3.so.0.8.6
7f402d8fb000-7f402d8fe000 rw-p 000a8000 08:05 396413                     /usr/lib64/libsqlite3.so.0.8.6
7f402d900000-7f402d910000 rw-p 00000000 00:00 0 
7f402d910000-7f402d966000 r--p 00000000 08:05 397875                     /usr/lib/mono/gac/System.Web.Services/2.0.0.0__b03f5f7f11d50a3a/System.Web.Services.dll
7f402d966000-7f402d9ae000 r--p 00000000 08:05 397360                     /usr/lib/mono/gac/System.Core/3.5.0.0__b77a5c561934e089/System.Core.dll
7f402d9ae000-7f402dfc6000 r--p 00000000 08:05 139939                     /home/smathers/Millennia/Microsoft.ReportViewer.Common.dll
7f402dfc6000-7f402dfed000 r--p 00000000 08:05 139936                     /home/smathers/Millennia/System.Data.SQLite.dll
7f402dfed000-7f402e00f000 r--p 00000000 08:05 6198                       /usr/share/fonts/TTF/liberation/LiberationSans-BoldItalic.ttf
7f402e00f000-7f402e011000 r-xp 00000000 08:05 143210                     /lib64/libnss_mdns4_minimal.so.2
7f402e011000-7f402e210000 ---p 00002000 08:05 143210                     /lib64/libnss_mdns4_minimal.so.2
7f402e210000-7f402e211000 r--p 00001000 08:05 143210                     /lib64/libnss_mdns4_minimal.so.2
7f402e211000-7f402e212000 rw-p 00002000 08:05 143210                     /lib64/libnss_mdns4_minimal.so.2
7f402e214000-7f402eacd000 rw-p 00000000 00:00 0 
7f402eacd000-7f402eade000 r-xp 00000000 08:05 396211                     /usr/lib64/libp11-kit.so.0.0.0
7f402eade000-7f402ecdd000 ---p 00011000 08:05 396211                     /usr/lib64/libp11-kit.so.0.0.0
7f402ecdd000-7f402ecde000 r--p 00010000 08:05 396211                     /usr/lib64/libp11-kit.so.0.0.0
7f402ecde000-7f402ecdf000 rw-p 00011000 08:05 396211                     /usr/lib64/libp11-kit.so.0.0.0
7f402ecdf000-7f402ed44000 r-xp 00000000 08:05 395617                     /usr/lib64/libgmp.so.10.0.4
7f402ed44000-7f402ef43000 ---p 00065000 08:05 395617                     /usr/lib64/libgmp.so.10.0.4
7f402ef43000-7f402ef44000 r--p 00064000 08:05 395617                     /usr/lib64/libgmp.so.10.0.4
7f402ef44000-7f402ef4d000 rw-p 00065000 08:05 395617                     /usr/lib64/libgmp.so.10.0.4
7f402ef4d000-7f402ef5f000 r-xp 00000000 08:05 395791                     /usr/lib64/libhogweed.so.2.1
7f402ef5f000-7f402f15e000 ---p 00012000 08:05 395791                     /usr/lib64/libhogweed.so.2.1
7f402f15e000-7f402f15f000 r--p 00011000 08:05 395791                     /usr/lib64/libhogweed.so.2.1
7f402f15f000-7f402f160000 rw-p 00012000 08:05 395791                     /usr/lib64/libhogweed.so.2.1
7f402f160000-7f402f185000 r-xp 00000000 08:05 396140                     /usr/lib64/libnettle.so.4.3
7f402f185000-7f402f385000 ---p 00025000 08:05 396140                     /usr/lib64/libnettle.so.4.3
7f402f385000-7f402f386000 r--p 00025000 08:05 396140                     /usr/lib64/libnettle.so.4.3
7f402f386000-7f402f387000 rw-p 00026000 08:05 396140                     /usr/lib64/libnettle.so.4.3
7f402f387000-7f402f397000 r-xp 00000000 08:05 396445                     /usr/lib64/libtasn1.so.3.2.0
7f402f397000-7f402f596000 ---p 00010000 08:05 396445                     /usr/lib64/libtasn1.so.3.2.0
7f402f596000-7f402f597000 r--p 0000f000 08:05 396445                     /usr/lib64/libtasn1.so.3.2.0
7f402f597000-7f402f598000 rw-p 00010000 08:05 396445                     /usr/lib64/libtasn1.so.3.2.0
7f402f598000-7f402f5a0000 r-xp 00000000 08:05 395995                     /usr/lib64/libkrb5support.so.0.1
7f402f5a0000-7f402f79f000 ---p 00008000 08:05 395995                     /usr/lib64/libkrb5support.so.0.1Stacktrace:

  at (wrapper managed-to-native) System.Drawing.GDIPlus.GdipCombineRegionRectI (intptr,System.Drawing.Rectangle&,System.Drawing.Drawing2D.CombineMode) <0xffffffff>
  at System.Drawing.Region.Exclude (System.Drawing.Rectangle) <0x00027>
  at (wrapper remoting-invoke-with-check) System.Drawing.Region.Exclude (System.Drawing.Rectangle) <0xffffffff>
  at System.Windows.Forms.Control/DoubleBuffer.End (System.Windows.Forms.PaintEventArgs) <0x0016f>
  at System.Windows.Forms.Control.WmPaint (System.Windows.Forms.Message&) <0x0016f>
  at System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message&) <0x001e7>
  at System.Windows.Forms.DataGridView.WndProc (System.Windows.Forms.Message&) <0x00013>
  at System.Windows.Forms.Control/ControlWindowTarget.OnMessage (System.Windows.Forms.Message&) <0x00024>
  at System.Windows.Forms.Control/ControlNativeWindow.WndProc (System.Windows.Forms.Message&) <0x00036>
  at System.Windows.Forms.NativeWindow.WndProc (intptr,System.Windows.Forms.Msg,intptr,intptr) <0x002bc>
  at System.Windows.Forms.XplatUIX11.DispatchMessage (System.Windows.Forms.MSG&) <0x0001f>
  at System.Windows.Forms.XplatUI.DispatchMessage (System.Windows.Forms.MSG&) <0x00024>
  at System.Windows.Forms.Application.RunLoop (bool,System.Windows.Forms.ApplicationContext) <0x00c73>
  at System.Windows.Forms.Application.Run (System.Windows.Forms.ApplicationContext) <0x0005f>
  at System.Windows.Forms.Application.Run (System.Windows.Forms.Form) <0x00033>
  at Millennia.Program.Main (string[]) <0x001c7>
  at (wrapper runtime-invoke) <Module>.runtime_invoke_void_object (object,intptr,intptr,intptr) <0xffffffff>

Native stacktrace:

        mono() [0x491db2]
        /lib64/libpthread.so.0(+0xef70) [0x7f40407f1f70]
        /lib64/libc.so.6(gsignal+0x35) [0x7f404048b245]
        /lib64/libc.so.6(abort+0x17b) [0x7f404048c7cb]
        /lib64/libc.so.6(+0x6d5be) [0x7f40404c45be]
        /lib64/libc.so.6(+0x73476) [0x7f40404ca476]
        /usr/lib64/libgdiplus.so.0(+0x34352) [0x7f403d9d5352]
        /usr/lib64/libgdiplus.so.0(GdipCombineRegionRect+0xc8) [0x7f403d9d6b08]
        /usr/lib64/libgdiplus.so.0(GdipCombineRegionRectI+0x4f) [0x7f403d9d6c7f]
        [0x41868dd7]

Debug info from gdb:

=================================================================
Got a SIGABRT while executing native code. This usually indicates
a fatal error in the mono runtime or one of the native libraries 
used by your application.
================================================================= 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:42:03.787

这似乎是 Mono 中一个非常古老的错误，尚未关闭。它与双缓冲有关：

[https://bugzilla.novell.com/show_bug.cgi?id=446341](https://bugzilla.novell.com/show_bug.cgi?id=446341)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:10:19.007

要回答这个问题，有两个部分：

1.  在 32b 上编译，在 64b 上运行：这对于 .NET 或 mono 来说没有问题
2.  你可以在单声道上运行 .NET 编译的程序集而没有问题吗？：如果您的程序集没有 P/Invoke 并且如果它使用在单声道上实现的 API，是的，它应该可以毫无问题地运行。有一个工具[http://www.mono-project.com/MoMA](http://www.mono-project.com/MoMA)可以帮助您检查您的应用程序是否会在单声道上运行

现在，对于您的特定问题，请查看@Pete 所说的内容。

# javascript - prototype.js 库中的事件处理

> ID：14882629
> 
> 赞同：1
> 
> 时间：2013-02-14T19:33:36.717
> 
> 标签：javascript, prototypejs

我发现prototype.js库提供了事件处理机制，但我不知道下面的代码片段有什么问题：

```
 <div>
        <div id="foo">Bla-bla</div>
    </div>

    <script type="text/javascript">
        function onFooKeyup(e)
        {
            var element = e.element();
            if (e.keyCode == Event.KEY_ESC) 
                    element.innerHTML="TEST";
        }
        //document.observe('keydown', onFooKeyup);
        $('foo').observe('keydown', onFooKeyup);
    </script> 
```

基本上我想在用户按下退出按钮时更改某些 div 块的内容（或做样式等）。问题是观察`foo`id 不会导致任何操作，而观察文档（注释行）确实会触发更改。`foo`如果我用输入标签替换我的div 块，例如

```
 <div><input type="text" id="foo" /></div> 
```

那么事件将被正确触发。它是一个错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:45:23.050

这是因为事件并非起源于`<div>`元素内部，所以你不能`observe`在那里（听它）。在`<div>`带有`<input>`标签的块的情况下，事件实际上起源于该元素内部（如果输入具有用户焦点，我认为，但在这里不相关）。所以不，这不是一个错误。

**只需在文档级别**捕获键盘事件，因为键事件将源自不同的元素（不同的浏览器以不同的方式管理它）但它们都会冒泡到文档（除非您停止事件的传播）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T18:03:47.737

伙计，我认为唯一的错误是因为您对 jQuery 说要查找名为 'foo' 的标签，然后将 'keypress' 事件绑定到它。如果您希望它搜索您的 id 'foo'，您应该执行以下操作

```
$('#foo').observe .... 
```

# ios - ios静态库中的本地化资源

> ID：14882631
> 
> 赞同：0
> 
> 时间：2013-02-14T19:33:40.173
> 
> 标签：ios, xcode, localization, bundle, static-libraries

我按照本[教程](http://www.galloway.me.uk/tutorials/ios-library-with-resources/)使用我的 ios 静态库中的资源。现在，我可以在我的静态库中使用图像、xib 文件、plist 文件……但我不能使用本地化资源……

在我的捆绑资源中，我可以看到所有（例如）图像进入正确的文件夹（es：英文图像进入 en.lproj 文件夹）但是..当我加载图像时，当我的语言设备不同于英语。

我对本地化字符串有同样的问题：我总是只看到英文本地化字符串。

***** 编辑*** *****

 **我找不到更好的解决方案来解决这个问题。我急于解决这个问题，所以我使用这种方法来解决本地化图像的问题：

```
 + (NSString*) getLocalizedPathImageWithImageName:(NSString*) aImageName
    {
        NSString *currentDeviceLanguage = [[NSLocale preferredLanguages] objectAtIndex:0];
        NSString *resourceBundlePath = [[NSBundle mainBundle] pathForResource:BUNDLE_RESOURCESNAME ofType:@"bundle"];
        NSString *completeLocalizedImageName = [aImageName stringByAppendingFormat:@"_%@",currentDeviceLanguage];
        NSString *imagePath = [[NSBundle bundleWithPath:resourceBundlePath] pathForResource:completeLocalizedImageName ofType:USERBUTTON_PNG_FILEEXTENSION];
        if (imagePath == nil) {
            completeLocalizedImageName = [aImageName stringByAppendingFormat:@"_%@",DEFAULT_LANGUAGE];
            imagePath = [[NSBundle bundleWithPath:resourceBundlePath] pathForResource:completeLocalizedImageName ofType:USERBUTTON_PNG_FILEEXTENSION];
        }
        return imagePath;
    } 
```

欢迎提供更好的解决方案**

# javascript - 多个点击监听器被添加到同一个 html 元素

> ID：14882639
> 
> 赞同：0
> 
> 时间：2013-02-14T19:33:52.327
> 
> 标签：javascript, jquery, html

我的 html 看起来像这样：

```
<div id="container">
    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>
</div> 
```

然后在javascript中，我在文档就绪函数中设置了一个点击监听器：

```
$(document).ready(function(){
    $('.sub').click(function (event) {
        //do something
    });
}); 
```

后来我动态添加了更多的 .class 元素，所以我的 html 看起来像：

```
<div id="container">
    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>

    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>
    <div class="sub"></div>
</div> 
```

我再次添加点击监听器：

```
function addListeners(){
  $('.sub').click(function (event) {
        //do something
    });
} 
```

现在前四个 .sub 元素附加了两个单击处理程序，并且在单击时会触发两次。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T19:35:45.553

您可以委托事件：

```
$(document).ready(function(){
    $('#container').on('click', '.sub', function(event) {
        //do something
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:36:37.993

在这种情况下，您应该使用`On()`而不是`click()`此处。所以，您的代码得到

```
function addListeners(){
  $('#container').on('click','.sub',function (event) {
        //do something
    });
} 
```

**`.on()`和之间的区别在于`.click()`**，当与事件关联的 DOM 元素在以后动态添加时可能不起作用，而可以`.click()`在与调用关联的 DOM 元素可能在以后动态生成的情况下使用。`.click()``.on()``.on()`

# scala - Scala：为什么 mapValues 会生成一个视图并且有任何稳定的替代方案吗？

> ID：14882642
> 
> 赞同：61
> 
> 时间：2013-02-14T19:34:03.383
> 
> 标签：scala, map

刚才我很惊讶地得知这`mapValues`会产生一个视图。结果如下例所示：

```
case class thing(id: Int)
val rand = new java.util.Random
val distribution = Map(thing(0) -> 0.5, thing(1) -> 0.5)
val perturbed = distribution mapValues { _ + 0.1 * rand.nextGaussian }
val sumProbs = perturbed.map{_._2}.sum
val newDistribution = perturbed mapValues { _ / sumProbs } 
```

这个想法是我有一个分布，它受到一些随机性的干扰，然后我重新规范化它。代码实际上在其初衷中失败了：因为`mapValues`产生 a `view`，`_ + 0.1 * rand.nextGaussian`总是在使用时重新评估`perturbed`。

我现在正在做类似`distribution map { case (s, p) => (s, p + 0.1 * rand.nextGaussian) }`的事情，但这有点冗长。所以这个问题的目的是：

1.  提醒不知道这一事实的人。
2.  寻找他们制作`mapValues`output`view`的原因。
3.  是否有生产混凝土的替代方法`Map`。
4.  有没有其他常用的收集方法有这个陷阱。

谢谢。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-14T20:10:04.923

有一张关于此的票，[SI-4776](https://issues.scala-lang.org/browse/SI-4776)（由 YT 提供）。

介绍它的提交有这样的说法：

> 根据 jrudolph 的建议，制作`filterKeys`和`mapValues` 转换抽象地图，并为不可变地图复制功能。从不可变地图移动`transform`到`filterNot`通用地图。法勒审查。

我无法找到 jrudolph 的原始建议，但我认为这样做是为了`mapValues`提高效率。提出问题，这可能会让您感到惊讶，但如果您不太可能多次迭代这些值，`mapValues` *则效率会更高。*

作为一种变通方法，可以`mapValues(...).view.force`生成一个新的`Map`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-14T19:53:33.757

scala 文档说：

> `key`将每个地图映射到的地图视图`f(this(key))`。生成的地图包装原始地图而不复制任何元素。

所以这应该是意料之中的，但这让我很害怕，我明天必须审查一堆代码。我没想到会有这样的行为:-(

只是另一种解决方法：

您可以调用`toSeq`以获取副本，如果需要将其返回 map `toMap`，但这不必要的创建对象，并且对使用有性能影响`map`

可以相对容易地编写，`mapValues`不创建视图，我明天会做，如果没有人在我之前做，我会在这里发布代码;）

**编辑：**

我找到了一种“强制”视图的简单方法，在 mapValues 之后使用“.map(identity)”（因此无需实现特定功能）：

```
scala> val xs = Map("a" -> 1, "b" -> 2)
xs: scala.collection.immutable.Map[java.lang.String,Int] = Map(a -> 1, b -> 2)

scala> val ys = xs.mapValues(_ + Random.nextInt).map(identity)
ys: scala.collection.immutable.Map[java.lang.String,Int] = Map(a -> 1315230132, b -> 1614948101)

scala> ys
res7: scala.collection.immutable.Map[java.lang.String,Int] = Map(a -> 1315230132, b -> 1614948101) 
```

很遗憾，返回的类型实际上不是视图！否则一个人本来可以称之为“力量”......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-11T15:45:25.567

在 scala 2.13 中更好（并且已弃用），现在返回 MapView： [API Doc](https://www.scala-lang.org/api/current/scala/collection/Map.html#mapValues[W](f:V=%3EW):scala.collection.MapView[K,W])

# python - 允许在 django DateTimeField 中使用 HH:MM 类型的输入，而不是长格式

> ID：14882648
> 
> 赞同：1
> 
> 时间：2013-02-14T19:34:29.947
> 
> 标签：python, django, django-models, django-forms, django-views

我有一个这样的模型

```
class Timer(models.Model):
"""Represents a timing system"""

   start_time = models.DateTimeField(default=datetime.datetime.now())
   end_time = models.DateTimeField() 
```

以及以此为模型的形式

```
class JobForm(forms.ModelForm):

    class Meta:
        exclude = ['slug','author','duration',]
        model = Job 
```

当我想添加一些时间信息时出现问题，我的意思是我必须以长格式输入

```
DD-MM-YYYY HH:MM:SS 
```

时间将在它们发生的同一天实时添加，所以长格式看起来很浪费精力，我宁愿这样做

```
HH:MM 
```

我不能使用 model.TimeField 因为我将计算开始时间和结束时间之间的持续时间，并且有人可能会通过计时他们的睡眠或谁知道还有什么来跨越午夜。我将如何允许在 HH:MM 中输入并将其作为日期时间字段（最终经过一些努力）？我希望代码假设与当前日期相同的日期给出 HH:MM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T19:13:07.857

在查看了表单文档之后，这就是 iv 决定做的事情，因为我不明白 @cclerville 的建议（也许 django 很差？）这里是：在我的 forms.py

```
class MyDateTimeField(forms.Field):

    def to_python(self, value):
        # Return an empty list if no input was given.
        if not value:
            return []
        import datetime 
        today = datetime.date.today()
        hhmm = value.split(':')
        val= datetime.datetime.combine(datetime.date.today(), datetime.time(int(hhmm[0]),int(hhmm[1])))
        return val 
```

和表格本身：

```
class JobForm(forms.ModelForm):
    end_time = MyDateTimeField() 
```

# perl - Perl 返回 MSWin32 而我的笔记本电脑是 64 位

> ID：14882649
> 
> 赞同：2
> 
> 时间：2013-02-14T19:34:30.290
> 
> 标签：perl, windows-7, operating-system, windows-7-x64, system-calls

```
print "$^O\n"; 
```

返回

```
MSWin32 
```

但是，我的笔记本电脑是 64 位的。知道 Perl 系统调用是否检索到错误数据（通过其或 Windows 的错误）还是按设计进行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:48:22.293

Win32 只是标准的 Windows API。这与 32 位/64 位处理器或操作系统变体几乎没有联系。

来自`perldoc -v $^O`：

> 在 Windows 平台中，$^O 不是很有帮助：因为它总是“MSWin32”，所以它无法区分 95/98/ME/NT/2000/XP/CE/.NET。使用 Win32::GetOSName() 或 Win32::GetOSVersion()（参见 Win32 和 perlport）来区分变体。

在我的系统上，它也不是很有帮助。只返回一个普通的`linux`;-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:46:33.440

`$^O`始终`MSWin32`在 Windows 上。

如果您想了解更多关于`perl`运行的系统，您可以使用

```
use Win32;
print Win32::GetOSDisplayName(), "\n";
print Win32::GetOSName(), "\n";
print Win32::GetOSVersion(), "\n"; 
```

如果您想知道为其构建的架构`perl`，您可以使用

```
use Config qw( $Config );
print "$Config{archname}\n"; 
```

如果您想知道整数的大小，可以使用

```
use Config qw( $Config );
print $Config{ivsize}*8, " bits\n"; 
```

# ruby-on-rails - 当我使用 Bootstrap 时不使用表格

> ID：14882651
> 
> 赞同：0
> 
> 时间：2013-02-14T19:34:57.447
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在开发一个 Rails 应用程序，我需要在其中显示一个表单并处理提交的表单。此表单中有几个字段，根据字段的输入，它应该在提交时将用户重定向到现有视图之一。

让我们调用表单：select_area

我创建脚手架如下：

```
rails g login email_address:string password:string --skip-stylesheets 
```

当我尝试创建 Bootstrap 视图时：

```
rails g bootstrap:themed logins -f 
```

我收到以下错误：
`query': Mysql2::Error: Table 'x2live.logins' doesn't exist: SHOW FULL FIELDS FROM`logins` (ActiveRecord::StatementInvalid)

当我这样做时，我也会收到错误：

```
rails g boostrap:themed logins 
```

如何在登录模型中抑制 ActiveRecord？我也在使用 mysql2 gem

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:29:40.507

你运行迁移了吗？

`bundle exec rake db:migrate`

# python - 如何在cygwin上通过Python脚本调用文件

> ID：14882652
> 
> 赞同：3
> 
> 时间：2013-02-14T19:34:57.853
> 
> 标签：python, python-3.x, cygwin

我编写了一个 python 脚本，它调用一个 .exe 文件并运行它。

```
import subprocess
path = "C:\Tools\file.exe"
subprocess.Popen(path) 
```

当我在 Windows 上执行我的 Python 文件时，它运行成功，但是当我尝试在 Cygwin 上运行相同的脚本时，它没有执行。

有人可以帮我告诉 cygwin 上运行文件的命令是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:49:46.597

在 Cygwin 下，您可以在 /cygdrive/c 下找到 C:\ 驱动器。你应该尝试这样的事情：

```
import subprocess
path = "/cygdrive/c/Tools/file.exe"
subprocess.Popen(path) 
```

# ektron - 有 Ektron 调度程序吗？

> ID：14882653
> 
> 赞同：0
> 
> 时间：2013-02-14T19:34:53.347
> 
> 标签：ektron

我需要一个进程或小部件，每五分钟检查一次本地化文件夹中是否有任何 xlf 文件，如果存在，将它们导入 Ektron。Ektron 有没有办法安排一些事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T09:37:37.687

您可以尝试创建 Windows 服务来执行计划。

有关本地化 API 以及如何执行本地化的详细信息，请访问：

**Ektron 站点中的root\Workarea\controls\content\localization_uc.ascx.cs** 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T00:20:01.860

我认为 Ektron 内部没有任何调度程序。

要安排任务，您可以使用以下方法之一查看：

*   [石英网](http://quartznet.sourceforge.net/)
*   任务计划程序调用的命令行程序

或者，您可以考虑使用 Ektron 插件，当某些 Ektron 事件发生时（例如发布的内容），该插件将被触发。但是，根据我的经验，插件/扩展程序的支持和记录都很差。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T13:42:45.527

我建议尝试类似于 Ken McAndrew 为别名调度程序所做的事情。此处的详细信息：[手动别名调度程序](http://developer.ektron.com/Templates/CodeLibraryDetail.aspx?id=490&blogid=116)

# c# - 如何模拟基类的受保护成员

> ID：14882655
> 
> 赞同：1
> 
> 时间：2013-02-14T19:35:17.517
> 
> 标签：c#, unit-testing, moq

为什么这样的事情不起作用：

```
public class BaseFoo{
   protected int FooField;
}

public class FooChild:BaseFoo{

}

var m = new Mock<FooChild>();

m.Protected().Setup<int>("FooField").Returns(1); 
```

它说“成员 FooChild.FooProp 不存在”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:40:53.223

哦..我明白了..它必须是属性而不是字段，并且必须是`protected virtual`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:46:40.513

如果父类的任何变量受到保护，则可以在子类中访问它，但不能在将扩展或使用子类的类中访问。

# qt - QListView 和委托显示意外项

> ID：14882656
> 
> 赞同：1
> 
> 时间：2013-02-14T19:35:17.197
> 
> 标签：qt, listview

我的 QListView 有问题，它在 QListView 的左上角绘制了一个意外项目：

[http://s4.postimage.org/64orbk5kd/Screen_Shot_2013_02_14_at_20_23_14.png](http://s4.postimage.org/64orbk5kd/Screen_Shot_2013_02_14_at_20_23_14.png)

我在 QListView 中使用 QStyledItemDelegate ：

```
m_stringList.push_back("FIRST");
m_stringList.push_back("SECOND");
m_stringList.push_back("THIRD");
m_model.setStringList(m_stringList);

ui->processesListView->setFlow(QListView::LeftToRight);
ui->processesListView->setModel(&m_model);
ui->processesListView->setItemDelegate(new ProcessItemDelegate(this, ui->processesListView)); 
```

委托 (ProcessItemDelegate) 绘制方法使用自定义 QWidget 来显示信息：

```
void ProcessItemDelegate::paint ( QPainter * painter, const QStyleOptionViewItem & option, const QModelIndex &inIndex ) const
{
  _listItem->setContent(_listView->model()->data(inIndex).toString());
  painter->save();
  painter->translate(option.rect.center());
  _listItem->render(painter);
  painter->restore();
} 
```

QWidget 的 setContent 方法非常简单：

```
void ProcessItem::setContent(const QString &s)
{
  ui->processId->setText(s);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T08:21:47.567

我有另一种方法可以使用`QListWidget`.

例如知道这`ui->historyView`是一个`QListWidget`元素和`HistoryElementView`一个子类`QWidget`。

```
void View::onHistoryChanged(const QList<HistoryElement> &history)
{
    clearHistory();
    foreach(HistoryElement elt, history)
    {
        HistoryElementView *historyViewElement = new HistoryElementView(elt.getDateTime("dd/MM/yyyy - hh:mm"), elt.getFilename());
        QListWidgetItem *item = new QListWidgetItem();

        ui->historyView->addItem(item);
        ui->historyView->setItemWidget(item, historyViewElement);
    }
}

void View::clearHistory()
{
    QListWidgetItem *item;

    while (ui->historyView->count() != 0)
    {
         item = ui->historyView->takeItem(0);

        delete item;
    }
} 
```

你不需要删除你的小部件`QListWidgetItem`，它将由 Qt 处理。

一旦您的小部件在列表中，您可以使用以下方法检索它们：

```
// Using index
QListWidgetItem *item = ui->historyView->item(0);
HistoryElementView *elt = qobject_cast<HistoryElementView *>(ui->historyView->itemWidget(item));

// Using position
QListWidgetItem *item = ui->historyView->itemAt(pos);
HistoryElementView *historyElement = qobject_cast<HistoryElementView *>(ui->historyView->itemWidget(item)); 
```

希望能帮助到你。

# php - 将降价图像显示为链接

> ID：14882661
> 
> 赞同：0
> 
> 时间：2013-02-14T19:35:49.180
> 
> 标签：php, markdown

我正在使用 Michel Fortin 的[PHP Markdown](http://michelf.ca/projects/php-markdown/)进行 Markdown 转换，但我想将图像显示为链接而不是内联。因为任何人都可以从 Imgur 插入 5MB jpg 并减慢页面速度。

如何将图像更改为链接到图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:00:09.030

覆盖的示例如下所示：

```
class CustomMarkdown extends Markdown
{
    function _doImages_reference_callback($matches) {
        $whole_match = $matches[1];
        $alt_text    = $matches[2];
        $link_id     = strtolower($matches[3]);

        if ($link_id == "") {
            $link_id = strtolower($alt_text); # for shortcut links like ![this][].
        }

        $alt_text = $this->encodeAttribute($alt_text);
        if (isset($this->urls[$link_id])) {
            $url = $this->encodeAttribute($this->urls[$link_id]);
            $result = "<a href=\"$url\">$alt_text</a>";
        } else {
            # If there's no such link ID, leave intact:
            $result = $whole_match;
        }

        return $result;
    }

    function _doImages_inline_callback($matches) {
        $whole_match    = $matches[1];
        $alt_text       = $matches[2];
        $url            = $matches[3] == '' ? $matches[4] : $matches[3];
        $title          =& $matches[7];

        $alt_text = $this->encodeAttribute($alt_text);
        $url = $this->encodeAttribute($url);
        return "<a href=\"$url\">$alt_text</a>";
    }
} 
```

演示：[http ://codepad.viper-7.com/VVa2hP](http://codepad.viper-7.com/VVa2hP)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T10:09:00.407

你应该看看[Parsedown](http://parsedown.org/)。这是一个更新的，我相信，更容易扩展 Markdown 的实现。

# java - 如何从基于 WSDL 的 Web 服务中提取详细的模式信息？

> ID：14882665
> 
> 赞同：2
> 
> 时间：2013-02-14T19:36:07.780
> 
> 标签：java, xsd, wsdl

假设我正在为已知的、基于 WSDL 的 Web 服务（我无法获得其源代码）开发客户端：

**有没有一种方法可以在运行时**根据该 WSDL 中的**内联**模式验证各种字段（例如字符串长度不超过限制）？

 **如果是这样，我如何与该 Web 服务交互以获取其内联 XSD 信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:20:29.783

如果您想让它真正动态化，那么您必须假设您可以访问 WSDL 的 URI，以及 WSDL 可能使用的所有其他外部引用，以及其他 WSDL 文件和/或 XSD 文件。

第一步，您必须将文件下载到临时文件夹，或为这些 URI 创建 I/O 流以在内存中加载，以加载模式（javax.xml.validation.Schema）。我不知道有一个 Java API 可以使这项任务变得简单（从 WSDL 参考中获取一个模式，例如 .NET 平台上的开发人员可以使用的模式）——希望如果有的话，有人可能会加入。否则，它写一个应该不难。

我必须警告您，许多人可能会将此（加载外部 URI，尤其是指向 Internet 的 URI）视为生产环境中的安全问题，因此请注意您的设计。由于您说的是“已知的、基于 WSDL 的 Web 服务”，我可能会在设计时获取 XSD，并将它们作为资源捆绑在我的 Jar 文件中，这些文件将与客户端代码一起使用。

下一件事是如何创建 XML……假设您正在使用诸如 JAXB 之类的东西，那么像[这篇](http://blog.bdoughan.com/2010/12/jaxb-and-marshalunmarshal-schema.html)文章这样的文章将给出如何解决您的问题的想法，以及您需要验证什么。如果您不使用 JAXB，请探索您的 API 在做什么，以及它实际上如何允许您插入验证......

我希望这至少可以让您了解此类问题所需的详细信息，以获得更具体的答案。**

# ios - 来自 JSON 的地图注解——没有注解显示

> ID：14882669
> 
> 赞同：0
> 
> 时间：2013-02-14T19:36:29.863
> 
> 标签：ios, objective-c, cocoa-touch, mapkit

我需要从一个 JSON 文件 atURL 中读取并为每个“名称、纬度、经度”做一个注释。这是到目前为止我得到的代码，它可以编译但不显示任何内容。和想法？

IOS6，故事板

_ 添加代码 _

**视图控制器.h**

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface ViewController : UIViewController {}

@property (weak, nonatomic) IBOutlet MKMapView *mapView;

@property (nonatomic, strong) NSMutableData *downloadData;

@end 
```

**视图控制器.m**

```
#import "ViewController.h"
#import "MapViewAnnotation.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    _downloadData = [NSMutableData new];

    NSURL *requestURL = [NSURL URLWithString:@"OMITTED/apptest/locations.json"];
    NSURLRequest *request = [NSURLRequest requestWithURL:requestURL];
    NSURLConnection *connection = [NSURLConnection connectionWithRequest:request delegate:self];
    [connection start];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [_downloadData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    id parsed = [NSJSONSerialization JSONObjectWithData:_downloadData options:kNilOptions error:nil];
    for (NSDictionary *pointInfo in parsed)
    {
        NSLog([parsed objectForKey:@"name"]);
        double xCoord = [(NSNumber*)[parsed objectForKey:@"lat"] doubleValue];
        double yCoord = [(NSNumber*)[parsed objectForKey:@"lon"] doubleValue];
        CLLocationCoordinate2D coords = CLLocationCoordinate2DMake(xCoord, yCoord);

        MKPointAnnotation *point = [MKPointAnnotation new];
        point.coordinate = coords;
        point.title = [parsed objectForKey:@"name"];

        [self.mapView addAnnotation:point]; // or whatever your map view's variable name is
    }
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)viewDidUnload {
    [super viewDidUnload];
    // ARC Problem --- [_mapView release];
    self.mapView = nil;
}

@end 
```

**来自 NSLog 对 _downloadData 的响应

来自 _downloadData 的字符串 =

```
{
    "name": "Waipio"
    "address": "100 oak"
    "lat": "28.00"
    "lon": "-125.00"
    "phonenumber": "555"
}
{
    "name": "Murrietta"
    "address": "100 Elm"
    "lat": "83.560852"
    "lon": "-134.135674"
    "phonenumber": "555"
} 
```

# java - 使用 BouncyCastle 的 Ruby 到 Java 加密功能

> ID：14882674
> 
> 赞同：2
> 
> 时间：2013-02-14T19:36:47.483
> 
> 标签：java, ruby, cryptography, bouncycastle

我正在尝试将一些 ruby​​ openssl 调用转换为 java（使用 BouncyCastle）。但是这是我第一次使用 BouncyCastle，所以我在弄清楚我的案例的一些 API 使用时遇到了一些问题。

本质上，我正在尝试将 Apples MDM Enrollment 流程转换为 Java。Apple 的示例代码是用 Ruby 编写的，开头如下：

```
p7sign = OpenSSL::PKCS7.new(input)
store = OpenSSL::X509::Store.new
p7sign.verify(nil, store, nil, OpenSSL::PKCS7::NOVERIFY)
p7enc = OpenSSL::PKCS7::PKCS7.new(p7sign.data)
out = p7enc.decrypt(key, cert) 
```

不幸的是，我还没有真正发现 BouncyCastle 文档很有帮助，因此对于如何将其转换为 java 的任何帮助将不胜感激。

提前感谢您提供的任何帮助，

# ios - 在 Cocos2D 中缩小时重新采样精灵

> ID：14882679
> 
> 赞同：0
> 
> 时间：2013-02-14T19:37:02.627
> 
> 标签：ios, objective-c, cocos2d-iphone

我试图通过设置精灵的比例来缩小 Cocos2D 中的高分辨率 CCSprite：

```
mySprite.scale = 0.5f; 
```

问题是按比例缩小的图像没有重新采样，并且出现像素化。有没有办法在 Cocos2D 中获取精灵的重采样版本，或者在 Cocos2D 层次结构（CCLayer、CCScene、CCDirector 等）的某个级别启用重采样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:44:11.573

您可以尝试设置：

```
[texture setAliasTexParameters]; 
```

在精灵纹理上，看看是否可以改善事情。

否则，我看到的唯一方法是在 OpenGL 级别重新采样图像。这将涉及[`gluScaleImage`](http://www.opengl.org/sdk/docs/man2/xhtml/gluScaleImage.xml)在您的纹理上使用，并且实现起来会稍微复杂一些。

# android - 在没有选择的情况下滚动到 AlertDialog 中的列表项

> ID：14882681
> 
> 赞同：4
> 
> 时间：2013-02-14T19:37:18.380
> 
> 标签：android, scroll, android-alertdialog

我在 AlertDialog 中显示了大量的项目。我想向用户展示滚动到他们最有可能从中选择一项的区域的列表。我在用着

```
AlertDialog.Builder.setSingleChoiceItems(myAdapter, ...).  
ArrayAdapter<MyType> myAdapter; 
```

我遇到困难的问题是如何在将项目显示为选定项目在逻辑上不正确时滚动到项目。

我尝试`ListView`从结果中获取`AlertDialog`. 但它是空的（即使在`Builder`创建并显示它之后）。我尝试通过在 res/layout 中 充气飞机来
强制填充。似乎没有效果。 我尝试为 AlertDialog 设置。 () 永远不会被调用。 `ListView``ListView``listView.scrollTo(x, y)`
`OnShowListener``onShow`

有谁知道解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:15:47.063

# 您可以使用属于 ListView 类的函数：

```
smoothScrollByOffset(int offset); 
```

或者

```
smoothScrollToPosition(int position); 
```

* * *

**或者**

# 如果您想一一滚动，可以使用以下功能：

```
private void scrollToNext() {
int currentPosition = getListView().getFirstVisiblePosition();
if (currentPosition == getListView().getCount() - 1)
    return;
getListView().setSelection(currentPosition + 1);
getListView().clearFocus();
}

private void scrollToPrevious() {
int currentPosition = getListView().getFirstVisiblePosition();
if (currentPosition == 0)
    return;
getListView().setSelection(currentPosition - 1);
getListView().clearFocus();
} 
```

# mysql - 获取每个帖子的最后三个用户的所有操作

> ID：14882682
> 
> 赞同：0
> 
> 时间：2013-02-14T19:37:23.963
> 
> 标签：mysql, sql

在[最后一个问题](https://stackoverflow.com/questions/14879676/get-all-actions-of-the-last-three-users)中，我询问了如何从历史表中获取最后三个用户的所有操作，该表存储用户在延期帖子上所做的所有操作，现在我想要的是获得相同的东西，但**对于每个帖子**。

***每个帖子的最后三个用户的所有操作***

```
history table
     id     | post_id | action    |  user_id
     1      |  5      | 1         |  3
     1      |  23     | 2         |  1
     2      |  24     | 2         |  6
     3      |  34     | 1         |  7
     4      |  35     | 1         |  1
     5      |  36     | 1         |  1
     6      |  23     | 2         |  3
     7      |  24     | 2         |  1
     8      |  23     | 1         |  4
     9      |  24     | 1         |  5
     10     |  24     | 1         |  1
     11     |  23     | 1         |  2
     12     |  23     | 4         |  1 
```

谢谢，对不起，如果它似乎是重复的帖子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:16:18.660

这是一个需要大量自连接的查询：

```
select hl.post_id, h.*
from history h join
     (select h.*, count(*) as NumLater
      from history h join
           history h2
           on h.post_id = h2.post_id and
              h2.id >= h.id
      group by h.id
      having NumLater <= 3
     ) hl
     on h.user_id = hl.user_id
order by hl.post_id 
```

内部查询执行自连接来计算同一帖子中每条记录之后的历史条目数。然后，连接通过 user_id 将其连接到历史表。这个版本*没有*消除重复。因此，一个用户可能在两个不同帖子的最后三个集合中。

# php - PHPUnit 代码覆盖导致 zend_mm_heap 损坏或分段错误 11

> ID：14882685
> 
> 赞同：1
> 
> 时间：2013-02-14T19:37:46.990
> 
> 标签：php, symfony, phpunit, code-coverage

我正在处理 Symfony2 捆绑包并运行`phpunit --coverage-text`. 所有测试都顺利通过，我收到了代码覆盖率报告，但它不完整，底部有以下消息。

```
Classes: 4.08% (2/49)
Methods: 1.94% (12/619)
Lines:   1.60% (46/2867)
..
....  
zend_mm_heap corrupted 
```

我在 PHP 5.4.11 上运行最新版本的 PHPUnit 和 xdebug。PHPUnit 总是正常运行，除非我要求它进行代码覆盖。这是我的 PHPUnit 配置文件的相关部分。

```
 <testsuites>
        <testsuite name="My Suite">
            <directory>./src/Company/*Bundle/Tests</directory>
        </testsuite>
    </testsuites>

    <filter>
        <whitelist>
            <directory suffix=".php">./src/Company/*Bundle/</directory>
        </whitelist>
    </filter> 
```

我认为这是内存或输出缓冲问题，所以我尝试增加以下 ini 指令。

```
output_buffering = 8192
memory_limit = 1028M 
```

这消除了以前的错误，但我开始收到一个`segmentation fault 11`错误。

你如何摆脱这些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:37:46.990

问题似乎是包含**单元测试的文件夹是 bundle 的一部分**，因此包含在代码覆盖率报告中。我不知道 PHPUnit 出了什么问题的细节，但是如果你的单元测试位于你的包中，你需要确保它们是从代码覆盖率中专门过滤出来的。

这是我的新 phpunit.xml 配置文件（相关部分）。没有 zend_mm_heap 也没有分段错误。

```
 <testsuites>
        <testsuite name="My Suite">
            <directory>./src/Company/*Bundle/Tests</directory>
        </testsuite>
    </testsuites>

    <filter>
        <whitelist>
            <directory suffix=".php">./src/Company/*Bundle/</directory>
            <exclude>
                <directory>./src/*/*Bundle/Tests</directory>
            </exclude>
        </whitelist>
    </filter> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T02:55:13.660

你需要使用

```
<filter>
  <whitelist processUncoveredFilesFromWhitelist="true">
    <directory suffix=".php">/path/to/files</directory>
    <file>/path/to/file</file>
    <exclude>
      <directory suffix=".php">/path/to/files</directory>
      <file>/path/to/file</file>
    </exclude>
  </whitelist>
</filter> 
```

过滤覆盖率报告的源文件

# java - 正则表达式使用端口验证 url，需要澄清

> ID：14882686
> 
> 赞同：0
> 
> 时间：2013-02-14T19:37:49.990
> 
> 标签：java, regex

我正在尝试使用以下正则表达式匹配 URL，在`Java`

```
^http(s*):\\/\\/.+:[1-65535]/v2/.+/component/.+$ 
```

使用 URL 测试失败：`https://box:1234/v2/something/component/a/b`

我怀疑这是导致它的数字范围。请帮助我了解我在这里缺少什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:45:19.113

请参阅[http://www.regular-expressions.info/numericranges.html](http://www.regular-expressions.info/numericranges.html)。你不能只写`[1-65535]`匹配`1`或`65535`。这表示任何数字`1-6`，或`5`或`3`。

您需要的表达式非常冗长，在这种情况下：

```
([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5]) 
```

（归功于[http://utilitymill.com/utility/Regex_For_Range](http://utilitymill.com/utility/Regex_For_Range)）

另一个问题是您的`http(s*)`. 这必须是`https?`因为在其当前形式下它可能允许`httpsssssssss://`. 如果您的正则表达式接受公共输入，这是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T19:43:26.120

`^http(s*)`是错误的，它会允许`httpssssss://...`

你需要`^https?`

不过，这不会影响给定的测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T19:43:15.927

该组`[1-65535]`基本上意味着从 1 到 6 或 5 或 5 或 3 或 5 的数字。甚至可以评估，但您需要在组的末尾加上 +（或 *）。

要更精确地匹配端口，您可以使用`[1-6][0-9]{0,4}?`. 这会让你非常接近，但也允许 pe 69999 -`{m,n}?`用于指定一个组可以使用的频率（m 到 n 次）

还要照顾其他人指出的（s *）事情！

这将导致： `^https?:\\/\\/.+:[1-6][0-9]{0,4}?/v2/.+/component/.+$`

# php - PHP 中的分组查询结果

> ID：14882689
> 
> 赞同：2
> 
> 时间：2013-02-14T19:37:55.630
> 
> 标签：php, html-table

我正在使用以下查询来填充表：

```
$result = mysql_query("SELECT vendor, part_number, machine, Sum(q_received) AS received, Sum(q_rejected) AS rejected FROM qa_parts Group by vendor, part_number, machine Order by vendor ASC"); 
```

我想按供应商对结果进行分组，然后在供应商下显示来自他们的所有部件及其详细信息。

这就是我需要它做的事情：

[http://www.gen-techno.com/images/old.jpg](http://www.gen-techno.com/images/old.jpg)

它现在在做什么：

[http://www.gen-techno.com/images/new.jpg](http://www.gen-techno.com/images/new.jpg)

如您所见，供应商 OPS 产品的部件并未像上述 Allied Electronics 示例中的部件一样归入该供应商之下。

截至目前我的表格代码：

```
while($row = mysql_fetch_array($result))
  {
echo "<h4>" . $row['vendor'] . "</h4>[fancy_table]<table>
<tr>
<th>Part Number</th>
<th>Quantity Received</th>
<th>Quantity Rejected</th>
<th>Machine</th>
</tr>";

  echo "<tr>";
  echo "<td>" . $row['part_number'] . "</td>";
  echo "<td>" . $row['received'] . "</td>";
  echo "<td>" . $row['rejected'] . "</td>";
  echo "<td>" . $row['machine'] . "</td>";
  echo "</tr>";
  echo "</table>[/fancy_table]";} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:45:42.973

在每个循环中，您必须决定是否该绘制标题——您将列出一个新的供应商。如果它**不是**新供应商，您仍然会为您绘制最后一个标题的那个列出零件，因此您不需要标题或结束表格。

```
$current_vendor = false;
while($row = mysql_fetch_array($result)) {
    // listing a new vendor? Output the heading, start the table
    if ($row['vendor'] != $current_vendor) {
            if ($current_vendor !== false)
                echo '</table>[/fancy_table]'; // if we're changing vendors, close the table
        echo '
            <h4>'.$row['vendor'].'</h4>[fancy_table]
            <table>
                <tr>
                <th>Part Number</th>
                <th>Quantity Received</th>
                <th>Quantity Rejected</th>
                <th>Machine</th>
                </tr>
        ';
        $current_vendor = $row['vendor'];
    }
    // output the row of data
    echo '<tr>
        <td>'.$row['part_number'].'</td>
        <td>'.$row['received'].'</td>
        <td>'.$row['rejected'].'</td>
        <td>'.$row['machine'].'</td>
        </tr>
    ';
}
echo '</table>[/fancy_table]'; // close the final table 
```

另一方面，您应该开始更新此代码以使用 PDO。显然，您正在更新曾经存在的东西……让 PDO 成为此更新的一部分。这些`mysql_*`功能正在被弃用，很快它们就会消失。

过渡到 PDO 并不难，而且当你已经在处理事情时，现在比以后面临“它没有坏，不要修复它”的问题时要容易得多。

下面是使用高级 PDO DBA 方法快速查看您的代码：

```
 $pdo = new PDO("mysql:host=localhost;dbname=database", '-username-', '-password-');
   $sql = '
        SELECT
            vendor, 
            part_number, 
            machine, 
            SUM(q_received) AS "received",
            SUM(q_rejected) AS "rejected" 
        FROM 
            qa_parts 
        GROUP BY 
            vendor, 
            part_number, 
            machine 
        ORDER BY 
            vendor ASC
    ';
    $statement = $pdo->prepare($sql);
    $statement->execute();
    while ($order = $statement->fetch()) {
        /* Put your table code here! */
    } 
```

**文档**

*   `foreach`- [http://php.net/manual/en/control-structures.foreach.php](http://php.net/manual/en/control-structures.foreach.php)
*   `mysql_query`（**已弃用**）- [http://php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)
*   PDO - [http://www.php.net/manual/en/book.pdo.php](http://www.php.net/manual/en/book.pdo.php)
*   `PDO::prepare`- [http://www.php.net/manual/en/pdo.prepare.php](http://www.php.net/manual/en/pdo.prepare.php)
*   `PDOStatement::fetch`- [http://www.php.net/manual/en/pdostatement.fetch.php](http://www.php.net/manual/en/pdostatement.fetch.php)
*   `PDOStatement::execute`- [http://www.php.net/manual/en/pdostatement.execute.php](http://www.php.net/manual/en/pdostatement.execute.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:42:05.627

您需要将循环分成两部分。第一部分检查您是否有新的/不同的供应商，并设置“外部”设置。然后是转储该供应商零件的内部零件。

例如

```
$prev_vendor = null;
while($row = ...) {
    if ($row['vendor'] != $prev_vendor) {
       ... new vendor stuff ...
       $prev_vendor = $row['vendor']; // update vendor for next iteration
    }
    ... dump this row's machine data ...
} 
```

# ruby-on-rails - 在 Ruby on Rails 中处理无 ID 错误的最佳方法是什么？

> ID：14882690
> 
> 赞同：2
> 
> 时间：2013-02-14T19:37:57.263
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

在我的控制器中，我经常使用这样的东西来验证 a 是否`project`真的属于给定的`user`：

```
private

def authorized_user
  @project = Project.find(params[:id])
  redirect_to root_path unless current_user?(@project.user)
end 
```

这很好用，因为用户 A 看不到用户 B 的项目（他被转发到根页面）。

但是，这只有`project`在请求的 URL 确实存在时才有效。

例如，该 URL`http://localhost:3000/projects/1`将显示用户的项目或转发到根 URL（如果另一个用户尝试访问该项目）。

但是当我尝试访问数据库中根本不存在的项目**时**，例如：

`http://localhost:3000/projects/777`

...我收到一个丑陋的`ActiveRecord::RecordNotFound`错误：

`Couldn't find Person with id=777`

在这里改善用户体验的最佳方法是什么？

我还没有真正*部署*过 Rails 项目，所以我什至不知道这个错误在生产模式下会是什么样子。

有人可以帮忙吗？

谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:39:58.013

我个人喜欢用这个：

```
@project = Project.where(id: params[:id]).first 
```

如果项目不存在，`@project`则为零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T07:21:33.590

尝试：

```
class ApplicationController < ActionController::Base
  rescue_from ActiveRecord::RecordNotFound, :with => :render_404
  # Render 404 page when record not found
    def render_404      
       render :file => "#{RAILS_ROOT}/public/404.html", :status => 404
    end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T19:44:04.347

根据您想要的处理方式，您可以使用

```
@project = Project.find_by_id(params[:id]) 
```

如果没有找到任何记录，这将使 @project 为零，您将必须手动处理该案例。

另一种解决方案是抛出一个 404 ，这很有意义，因为资源不存在。您可以使用以下命令在任何控制器（或应用程序控制器）中轻松完成此操作：

```
rescue_from ActiveRecord::RecordNotFound, :with => :not_found

def not_found
  raise ActionController::RoutingError.new('Not Found')
end 
```

这将导致类似：

```
class ApplicationController < ..
  rescue_from ActiveRecord::RecordNotFound, :with => :not_found

  def not_found
    raise ActionController::RoutingError.new('Not Found')
  end
end 
```

后一种解决方案将向用户显示默认的 404（未找到）错误页面。在第一种情况下，您拥有更多控制权，但代价是到处都这样做

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T22:53:40.210

首先，为了避免未经授权的用户访问项目，你应该限定你的 find 方法：

```
current_user.projects.find(params[:id]) 
```

这样，您将在开发中收到“找不到带有 id 的项目”错误。为避免这种情况，您可以使用：

```
current_user.projects.find_by_id(params[:id]) 
```

它返回`nil`而不是异常，但是有充分的理由说明您通常不应该这样做。在编写良好的 Rails 应用程序中，任何用户唯一会访问他不应该访问的项目的时间是当他手动更改 url 中的 id 时。您希望在您的日志中报告这一点，而不是默默地跳过。

最后，要抛出 403 Forbidden 而不是 404 Not Found，您可以考虑使用许多授权 gem 之一（[`cancan`](https://github.com/ryanb/cancan)想到的是 Ryan Bates）。

编辑：哦，在生产中，ActiveRecord::RecordNotFound 将呈现 404.html 页面，也就是这些不是您正在寻找的项目。

# java - Eclipse 和类文件

> ID：14882691
> 
> 赞同：0
> 
> 时间：2013-02-14T19:38:00.673
> 
> 标签：java, eclipse

我有一些在 Netbeans 中打开的类文件（扩展名为 .java），但在 Eclipse 中我有以下经验： 起初我看不到带有 jadclipse 的类文件的内容，我只看到：/ *jadclipse* //错误！

几天后（没有对 eclipse 或 ... 进行任何更改）我可以看到它们，但出现如下错误：“无法完全反编译方法 ...检测到尝试语句。并非所有异常处理程序都将在方法中解决......“

但是前几天我遇到了第一个错误，我再也看不到任何东西了！！！操作系统：Win7 Java：7 Netbeans 7.1.2 Eclipse 版本 Juno Service Release 1

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T13:24:00.430

我没有得到关于 JAD 的 Eclipse 插件的任何帮助，因为我说它不适用于我的类文件。所以我尝试了 Java Decompiler GUI，它工作得非常好，因此我想分享这个很好的体验，以便它可能对某些人有用。

# jquery - 如何使用 jQuery 进行选择下拉菜单？

> ID：14882698
> 
> 赞同：1
> 
> 时间：2013-02-14T19:38:44.523
> 
> 标签：jquery, html, click, focus, html-select

所以，我有以下 HTML：

```
<div class="toolsIndexSelectContainer">
      <select id="Clients" class="toolsIndexSelect disableElement">
          <option>Item</option>         
          <option>Item 2</option> 
          <option>Item 3</option> 
      </select>
</div> 
```

当我使用类 toolsIndexSelectContainer 单击周围的 div 时，我希望选择下拉并显示里面的项目。我有这个 jQuery：

```
$("div[class~='toolsIndexSelectContainer']").click(function () {
    $(this).children("select").focus();
}); 
```

但是，focus() 不起作用。我尝试了 click() 并且 Chrome 对我大发雷霆。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:41:36.393

不，您不能在`select`元素上执行此操作。您不能触发以显示下拉选项。

`select`其他选择是下载一个基本上模拟功能的下拉插件。

这个[ddSlick](http://designwithpc.com/Plugins/ddSlick)插件似乎模拟了选择框属性，并且还具有打开下拉选项的方法。

> **选择**您可以使用插件的打开方法，例如`$('#demoSetSelected').ddslick('open');`打开下拉选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:45:40.783

你可以使用类似 jquery [Combobox](http://jqueryui.com/autocomplete/#combobox)的东西 。将选择转换为组合框。否则，这对于普通的选择元素是不可能的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:06:34.390

这有点像黑客，但似乎有效：

```
$(".toolsIndexSelectContainer").click(function () {
    $(this).find("#Clients").focus();
});
$("#Clients").focus(function(){
    this.size=$(this).find('option').length;
}).blur(function(){
    this.size=1;
}); 
```

小提琴练习：http: [//jsfiddle.net/As93t/](http://jsfiddle.net/As93t/)

# c++ - 未解决的包含错误日食

> ID：14882700
> 
> 赞同：1
> 
> 时间：2013-02-14T19:38:55.907
> 
> 标签：c++, eclipse, macos, inclusion

所以我去了这个叫做数字媒体学院的3D游戏编程。我们使用 eclipse 和 Panda3D 使用他们的 Macbook Pro 来创建 3D 游戏。我在那里创造了一个很棒的游戏，运行得很漂亮。但是，当我将所有内容都放在 USB 上并将所有内容重新安装到家里的个人 macbook pro 上时，我会在这些代码行旁边看到问号，上面写着未解决的包含：

// Panda3D 的东西。

```
#include "auto_bind.h"
#include "audioManager.h"
#include "executionEnvironment.h"
#include "filename.h" 
```

//C++的东西

```
#include <cmath>
#include <cstdlib>
#include <iostream> 
```

在eclipse的问题部分，我得到了这个：

```
make: *** No rule to make target `all'.  Stop. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T22:46:57.250

我认为，这里至少有两个问题：

1.  未解决的包含：这可能是索引器的故障，简单的索引重建或重新编译会有所帮助尝试右键单击项目>索引>“重建”或“重新解决未解决的包含”如果没有运气那么，这不仅仅是一个故障但一个真正的问题，所以检查：项目>属性> C/C++常规>路径和符号>包含在那里你应该有C++头文件所在的目录，并且“熊猫”头文件应该和你的源文件一起。

2.  缺少“all”目标：CDT 正在尝试使用 Makefile 中缺少的名为“all”的目标调用 make。要么为错误的目标配置了 CDT，而“全部”不是您需要的，要么是“全部”目标有问题。您应该向我们提供更多信息：正确的（原始）Makefile 此处的设置：Project > Properties > C/C++ Build > Behavior > Make build target

# java - 在 Android 中选择 SoundPool 或 MediaPlayer 更好吗？

> ID：14882701
> 
> 赞同：4
> 
> 时间：2013-02-14T19:39:04.180
> 
> 标签：java, android, file, audio, button

我目前正在尝试制作一个应用程序，其中有触发音频文件的按钮，但这些音频文件是由用户通过文件浏览器活动选择的。我听说 MediaPlayer 有延迟问题等，但 SoundPool 有内存限制？

另外，我可以让用户通过从文件浏览器（所选项目）返回一个字符串来设置音频文件，并将其用于音频 API 的路径，它是哪一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:47:35.003

`SoundPool`如果您尝试播放已加载的文件，则速度会更快。因为加载文件需要更多时间，并且文件应该更小以获得更好的性能。

但在您的情况下，似乎用户选择要播放的`FileBrowser`文件，文件大小会有所不同，因此加载时间。去吧`MediaPlayer`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-15T05:49:38.870

`SoundPool`比它更快，`MediaPlayer`但它有其自身的局限性。

`SoundPool`用于小声音，例如您可以在您的`onClick()`方法中使用的声音，以便每次用户单击任何位置时它都会发出咔哒声，因为这些文件已预先加载在内存中，不会让 CPU 因它的行为而受到影响，并且这就是为什么`SoundPool`比 快`MediaPlayer`。此外，它可以管理一次渲染的音频流的数量。

`MediaPlayer`用于用户可以访问播放、暂停、查找、开始等播放选项的情况。此外，通常对于长音频`MediaPlayer`来说是好的，因为您不能事先在内存中加载长音频。您还可以用于`MediaPlayer`通过 Internet 播放音频（如果您打算在将来的版本中使用它会很有用）。

在您的情况下，允许用户从文件浏览器活动中播放音频，我建议您选择`MediaPlayer`.

# java - 如何在单独的线程/类加载器中隔离 java 模块执行？

> ID：14882703
> 
> 赞同：2
> 
> 时间：2013-02-14T19:39:09.240
> 
> 标签：java, module, isolation

在我的 web 服务应用程序中，我必须集成一个第三方模块来验证业务规则，这些模块附带了相当旧的库。

旧图书馆与我的新图书馆发生冲突。

有没有办法将第三方模块隔离在正在运行的 web 服务中的单独线程/类加载器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:42:53.210

您正在寻找的是所谓的[OSGi](http://www.osgi.org/Technology/WhatIsOSGi)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:49:11.607

当然可以，但是您必须像这样通过反射来使用它：

```
ClassLoader classLoader = new URLClassLoader (
    new URL [] {/* Classpath or isolated module here */},
    ClassLoader.getSystemClassLoader ().getParent ());

Class <?> isolatedModuleClass = classLoader.loadClass (
    /* Full name of class from isolated module */);

Object isolatedObject = 
    isolatedModuleClass.
        getConstructor (/* Constructor argument types */).
            newInstance (/* Constructor arguments */);

Object result =
    isolatedModuleClass.
        getMethod (/* Method name */, /* Method parameter types */).
            invoke (isolatedObject, /* Method arguments */); 
```

# matlab - 如何访问嵌套在 MATLAB 中的元胞数组中的结构体数组的所有字段元素？

> ID：14882704
> 
> 赞同：10
> 
> 时间：2013-02-14T19:39:10.300
> 
> 标签：matlab, struct, cell-array

下面的代码为此问题创建了一个示例元胞数组：

```
mycell = cell([5,1]);
for i = 1 : size(mycell)
    mystruct = struct();
    mycell{i} = mystruct;
    mycell{i}.field1 = i;
end 
```

我希望`mycell{:}.field1`做我想做的事，但它给出了一个错误。我可以使用以下 for 循环：

```
for i = 1 : size(mycell)
    mycell{i}.field1
end 
```

但我更喜欢更简单或更优雅的解决方案，因为我想使用 mycell.field1 的所有元素作为绘图中的 y 变量。有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T19:52:50.497

## 两种可能的解决方案：

### 第一的：

如果单元格数组中的所有结构都具有相同的字段，则可以：

```
mycell = [ mycell{:} ]; % convert cell array to struct array
y = [ mycell(:).filed1 ]; % get the values 
```

### 第二：

另一种方法使用`cellfun`

```
y = cellfun( @(x) x.field1, mycell ); 
```

假设所有`mycell{ii}.filed1`都是标量，否则你需要添加`'UniformOutput', false`到`cellfun`.

**注意：**如果某些字段为空 ( `[]`)，这些方法可能无法按预期工作。

一个小评论：在 Matlab 中使用[和](https://stackoverflow.com/questions/14790740/using-i-and-j-as-variables-in-matlab)[作为变量](https://stackoverflow.com/questions/14790740/using-i-and-j-as-variables-in-matlab)
[不是一个好习惯`i``j`](https://stackoverflow.com/questions/14790740/using-i-and-j-as-variables-in-matlab)。

# asp.net - Asp.Net - Formview - 事件触发 - ItemInserted

> ID：14882707
> 
> 赞同：1
> 
> 时间：2013-02-14T19:39:23.183
> 
> 标签：asp.net, events, exception, insert, formview

我有一个带有**插入模式的****FormView**。我在**ItemInserting 事件**中抛出一个异常，我希望使用**FormViewInsertedEventArgs在****ItemInserted 事件**中捕获该异常，但是，该事件不是从**ItemInserting -> ItemInserted 流出**，而是在中间中断并引发系统异常（可怕的黄色屏幕)

 ******这是我的代码

```
<asp:FormView ID="FormView1" runat="server" OnDataBound="FormView1_DataBound"
    OnModeChanging="FormView1_ModeChanging" OnItemInserting="FormView1_ItemInserting"
    RenderOuterTable="false" OnItemInserted="FormView1_ItemInserted"
    DataKeyNames="RoleName"> 
```

其中是一个 InsertItemTemplate，最后带有以下 Insert LinkBut​​ton。

```
<asp:LinkButton ID="LinkButton2" runat="server" CommandName="Insert" Text="Insert"/> 
```

单击“插入”链接按钮，代码成功传递到以下方法

```
protected void FormView1_ItemInserting(object sender, FormViewInsertEventArgs e) 
```

但是进不去

```
protected void FormView1_ItemInserted(object sender, FormViewInsertedEventArgs e) 
```

无论有无例外。

我正在使用 List 在本地存储数据，我的静态方法从中更新 SQL 数据库。******

# php - iframe 传输不传输任何数据

> ID：14882713
> 
> 赞同：5
> 
> 时间：2013-02-14T19:40:01.623
> 
> 标签：php, jquery-file-upload, jquery-iframe-transport

我正在使用[jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload/)和[jQuery-Iframe-Transport](http://cmlenz.github.com/jquery-iframe-transport/)来尝试获得对旧版本 IE 的支持。

我已将[`forceIframeTransport`](https://github.com/blueimp/jQuery-File-Upload/wiki/Options)选项设置为`true`，使其在所有浏览器中的行为或多或少都相同，但无论浏览器在使用 iframe 传输时如何，我似乎都没有在服务器端获取任何数据。

我已经吐出了服务器端的请求标头，然后我回来了：

```
array(
    Host => "*******"
    Connection => "keep-alive"
    Content-Length => "0"
    Accept => "*/*"
    Origin => "**************"
    X-Requested-With => "XMLHttpRequest"
    User-Agent => "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17"
    DNT => "1"
    Referer => "***********"
    Accept-Encoding => "gzip,deflate,sdch"
    Accept-Language => "en-GB,en-US;q=0.8,en;q=0.6"
    Accept-Charset => "ISO-8859-1,utf-8;q=0.7,*;q=0.3"
    Cookie => "*********"
) 
```

[ `*****`s 表示漏掉了信息；你不需要那个;)]

看起来不错，但`$_REQUEST`它是空的（即`array()`），并且输入缓冲区也是空的：

```
$handle = fopen('php://input', 'r');

$file_data = '';

while(($buffer = fgets($handle, 4096)) !== false) {
    $file_data .= $buffer;
}

fclose($handle); // $file_data = ''; 
```

当我不使用 iframe-transport 但我需要 IE 支持时，这一切都运行良好...有没有人有使用 iframe 传输文件的经验并且可能知道为什么没有数据通过？

* * *

当我使用[jQuery-File-Upload / js / jquery.iframe-transport.js](https://github.com/blueimp/jQuery-File-Upload/blob/master/js/jquery.iframe-transport.js)并强制 iframe 传输时，它可以在 Chrome 中运行，但请求甚至无法到达 IE 中的服务器。

当我使用[jquery-iframe-transport / jquery.iframe-transport.js](https://github.com/cmlenz/jquery-iframe-transport/blob/master/jquery.iframe-transport.js)并强制 iframe 传输时，它会在 Chrome 中中断，但这很好，因为 Chrome 支持正确的 XHR 文件传输，*并且*请求至少在 IE 中到达服务器*但*没有数据来通过。

我已经更新了我的脚本以支持任一传输方法：

```
if(empty($_FILES)) {
    $handle = fopen('php://input', 'r');

    $file_data = '';

    while(($buffer = fgets($handle, 4096)) !== false) {
        $file_data .= $buffer;
    }

    fclose($handle);
} else {
    $file_data = file_get_contents($_FILES['files']['tmp_name'][0]);
} 
```

但同样，无论我做什么，我似乎仍然无法在 IE 中获取任何数据。

当我说“IE”时，我现在专门在 IE 8 中进行测试。我需要支持回到 7。[这家伙](http://cmlenz.github.com/jquery-iframe-transport/)声称一直支持到 IE 6。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T00:20:38.700

几个小时后，我终于找到了问题所在。

首先，您需要使用[与 jQuery-file-upload 捆绑在一起](https://github.com/blueimp/jQuery-File-Upload/blob/master/js/jquery.iframe-transport.js)的传输插件，因为它是为它制作的；）我不太确定为什么另一个更进一步，但我会在分钟。

我注意到在 IE 中，我在核心 jquery 库的某处收到了“拒绝访问”JavaScript 错误。根据我在网上阅读的内容，这通常发生在您尝试提交到不同域的 URL 时，我没有这样做，所以我将其驳回。

当我来到`form.submit()`一个版本和另一个版本中所说的一行时，我正在比较 2 个不同的传输脚本的不同之处`form[0].submit()`。所以我尝试添加`[0]`然后注意到“访问已被拒绝”错误更改为指向该行。很明显，它不喜欢我将文件提交到的位置。

我仔细检查了`form.action`URL 仍然看起来不错。通过一些[Google-fu](https://github.com/blueimp/jQuery-File-Upload/issues/999)，我发现如果事件不是源自原始/本机文件输入元素，您也会收到此错误。

我已经用一个花哨的输入替换了原生输入，然后在隐藏的原生输入上触发了一个“假”“点击”事件。这是它不喜欢的。

取出我的假上传按钮并`<input type="file"/>`放回本机按钮（仅供参考），现在所有浏览器中的一切都像魅力一样工作。嘘！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-23T02:04:29.940

物有所值 ...

我正在使用 jQuery v1.9.1 在文件上传到服务器之前同步对文件进行病毒扫描。如果文件有病毒，我们将返回 HTTP 400，如果不是病毒，则返回 HTTP 200。

HTTP 400 响应导致 IE8“拒绝访问”结果。

**当我将服务器响应从 400 更改为 401 时，UI 运行良好。**

再次，“为了它的价值”。

# c# - 如何将这两个非托管结构转换为托管类型？

> ID：14882718
> 
> 赞同：-1
> 
> 时间：2013-02-14T19:40:20.003
> 
> 标签：c#, c++-cli

我的 C++ 命名空间中的第一个是

```
 public struct channel_vars {
      int fetch_data;    /* Boolean flag */
      void * data;       /* (malloc'd) address of data */
      unsigned int lines;    /* Number of lines returned */
} 
```

我不知道 void* 在管理时应该变成什么

第二个是

```
public struct hdf_call_vars_t {
 struct channel_vars p_vars;
   struct channel_vars s_vars; 
  enum FILE_VERSION file_vers;   /* Set in top level sub. used in lower */
  int fetch_n;    /* Boolean flag */
  s_line_header_t * n_addr; /* malloc'd address of ndata */
  unsigned int n_lines;
  csdt_file_header_t hdr;   
}; 
```

在上面的一个中， s_line_header_t 本身就是一个结构，它由双精度和整数组成，另一个结构也由整数等基本类型组成。

由于托管代码不允许指针，我如何将这些结构转换为托管类型？所有这些代码都在我的 c++ -cli 项目中。谢谢，某人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T19:50:24.837

如果您要迁移到 c# 所有类在功能上都与指针相同。它们的操作方式几乎相同，既可以指向一个类，也可以是`null`。

`void*`有点棘手。这可以指向任何东西。在 c# 中，所有对象都继承自基`object`类。因此，将所有替换`void*`为`object`您应该没问题，因为您将需要强制转换才能从 void* 和对象中恢复。

```
public struct ChannelVars {
      public bool FetchData; 
      public object Data;   
      public uint Lines;    
}

public struct HDFCallVarsT {
      public ChannelVars PVars;
      public ChannelVars SVars; 
      //enum FILE_VERSION file_vers;  //you will need to get the enum set here correctly
      public bool FetchN;
      public SLineHeaderT NAddr; //SLineHeaderT must be a class somewhere
      public uint NLines;
      public CSDTFileHeaderT HDR; //CSDTFileHeaderT must be a class somewhere   
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:49:36.093

您可以在托管代码中使用 IntPtr 类来映射使用指针的字段

# java - jasperreports 如何将多个 jrmxl 文件导出到单个工作表

> ID：14882722
> 
> 赞同：0
> 
> 时间：2013-02-14T19:40:43.847
> 
> 标签：java, jasper-reports

我有一个 jrxml 文件，我想用 3 个不同的数据源填充它。然后我想导出到一个 XLS 或 XLXS 文件，其中 3 个报告在一张纸上连接在一起。

```
String input = "C:\\location\\report1.jrxml";
JasperReport jreport = JasperCompileManager.compileReport(input);         

JasperPrint jprint1 = JasperFillManager.fillReport(jreport, new HashMap<String, Object>(), new JRBeanCollectionDataSource(getReportData(1)));
JasperPrint jprint2 = JasperFillManager.fillReport(jreport, new HashMap<String, Object>(), new JRBeanCollectionDataSource(getReportData(2)));
JasperPrint jprint3 = JasperFillManager.fillReport(jreport, new HashMap<String, Object>(), new JRBeanCollectionDataSource(getReportData(3)));

List<JasperPrint> jprintlist = new ArrayList<JasperPrint>();

jprintlist.add(jprint1);
jprintlist.add(jprint2);
jprintlist.add(jprint3);

JRXlsxExporter exporter = new JRXlsxExporter();
exporter.setParameter(JRXlsExporterParameter.IS_ONE_PAGE_PER_SHEET, Boolean.FALSE);
exporter.setParameter(JRXlsExporterParameter.JASPER_PRINT_LIST, jprintlist);

String xlsFile = "C:\\location\\test.xlsx";

exporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME, xlsFile); 
exporter.exportReport(); 
```

这些报告都按照我的预期生成，但是在 excel 中它们是在 3 个不同的选项卡上生成的，我想要的是让它们建立在另一个之上。我怎样才能以这种方式合并它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T12:09:43.980

您可以将 3 个报告作为子报告包装在主报告中，然后运行该报告。为此，您需要将要访问的数据源的逻辑添加到子报表的数据源表达式中。

或者，您可以在 JasperReports 之外发布处理 excel 表。

# c++ - 编译器的不同行为 - 模板模板参数

> ID：14882730
> 
> 赞同：0
> 
> 时间：2013-02-14T19:41:09.817
> 
> 标签：c++

假设我有以下代码：

```
template <template <typename> class T>
class A {};

template <typename T>
class B
{
    A<B> instance;
};

int main()
{
   B<int> instance;
} 
```

gcc 4.7.2 和 gcc 4.8.0 编译这段代码没问题，而 icc 13.0.1 和 clang 3.2 给了我一个错误（clang 需要 ::B 而不是 B，而 icc 在模板实例化中也需要空格）。

谁是对的？

我找到了关于它的线程（[将自身称为模板模板参数的模板类？](https://stackoverflow.com/questions/3052415/template-class-that-refers-to-itself-as-a-template-template-parameter)），但我无法理解标准的 14.6.1/2 并且还看到了 LLVM 错误 14350（[http://www.mail- archive.com/llvmbugs@cs.uiuc.edu/msg21095.html](http://www.mail-archive.com/llvmbugs@cs.uiuc.edu/msg21095.html)）。那么，clang 和 intel 错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:54:34.237

14.6.1 说：

> 注入的类名可以用作*模板名*或*类型名*。当它与*template-argument-list*一起使用时，作为*模板模板参数*的模板*参数，或作为朋友类模板声明的**详细类型说明*符中的最终标识符，它指的是类模板本身.

“injected-class-name”是类模板的名称（`B`）“注入”到类的范围内。换句话说，它是指`B`在类的定义中使用非限定名称`B`。如果您在需要模板名称的上下文中使用该名称：即，使用显式模板参数 ( `B<int>`) 或作为带有模板模板参数 ( `A<B>`) 的模板的模板参数，它应该引用模板本身。

所以，gcc 是对的。

`<`此外，在 C++11 中， in之后不需要空格`<::B>`。根据第 2.5 节第 3 段，将输入流划分为令牌时：

> 如果接下来的三个字符是`<::`且后续字符既不是`:`也不是`>`，则`<`它本身被视为预处理器标记，而不是替代标记的第一个字符`<:`。（`<:`是另一种写作方式`[`。）

# .net - .NET 方法信息的一个好的唯一标识属性是什么

> ID：14882733
> 
> 赞同：6
> 
> 时间：2013-02-14T19:41:21.613
> 
> 标签：.net, reflection

在存储方法信息数据时，从一组 .NET 程序集的反射读取中，从方法信息实例中使用的最佳逻辑键是什么，以将其与不同类型中的类似名称方法或类似名称中的方法分开相同类型具有不同参数？

例如，类型具有 AssemblyQualifiedName 属性，可以很好地从相似类型中识别它。

更新：正如 Peter Ritchie 所建议的，有 .NET Reflection MetadataToken 属性，这正是我所希望的，但是，根据[这里](https://stackoverflow.com/questions/7834317/c-memberinfo-metadatatoken-stable-across-compiler-runs)，此令牌不会在后续编译中维护。

正如 Oded 建议的那样，答案似乎是一个连接键：“包含类型的完全限定名称 + 它的名称和参数”

我很高兴听到任何进一步的建议

# python - 我无法在 Windows XP 中编译 Pillow

> ID：14882735
> 
> 赞同：1
> 
> 时间：2013-02-14T19:41:28.927
> 
> 标签：python, mingw, pip

我安装了 MinGW GCC，将路径添加到 PATH 变量，在我的 Python 安装中的文件夹 distutils.cfg Lib / distutils 中创建文件。我尝试使用 Pip 安装或下载源代码并运行“python setup.py install”。我也尝试将它`virtualenv`直接安装到系统中。这是 Pip 的日志：

```
 ------------------------------------------------------------
C:\entorno\Scripts\pip-script.py run on 02/14/13 15:33:32
Downloading/unpacking pillow

  Running setup.py egg_info for package pillow

    running egg_info
    writing pip-egg-info\Pillow.egg-info\PKG-INFO
    writing top-level names to pip-egg-info\Pillow.egg-info\top_level.txt
    writing dependency_links to pip-egg-info\Pillow.egg-info\dependency_links.txt
    C:\Python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution option: 'use_2to3'

      warnings.warn(msg)

    warning: manifest_maker: standard file '-c' not found

    reading manifest file 'pip-egg-info\Pillow.egg-info\SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    warning: no previously-included files found matching '.hgignore'

    warning: no previously-included files found matching '.hgtags'

    warning: no previously-included files found matching 'BUILDME.bat'

    warning: no previously-included files found matching 'make-manifest.py'

    warning: no previously-included files found matching 'SHIP'

    warning: no previously-included files found matching 'SHIP.bat'

    warning: no previously-included files matching '*' found under directory 'Tests'

    writing manifest file 'pip-egg-info\Pillow.egg-info\SOURCES.txt'
  Source in c:\entorno\build\pillow has version 1.7.8, which satisfies requirement pillow
Installing collected packages: pillow

  Running setup.py install for pillow

    Running command C:\entorno\Scripts\python.exe -c "import setuptools;__file__='C:\\entorno\\build\\pillow\\setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record c:\docume~1\aaa\config~1\temp\pip-8kdxpq-record\install-record.txt --single-version-externally-managed --install-headers C:\entorno\include\site\python2.7
    running install
    running build
    running build_py
    running build_ext
    building '_imaging' extension

    creating build\temp.win32-2.7
    creating build\temp.win32-2.7\Release
    creating build\temp.win32-2.7\Release\libimaging
    c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c _imaging.c -o build\temp.win32-2.7\Release\_imaging.o

    c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c decode.c -o build\temp.win32-2.7\Release\decode.o

    c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c encode.c -o build\temp.win32-2.7\Release\encode.o

    c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c map.c -o build\temp.win32-2.7\Release\map.o

    c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c display.c -o build\temp.win32-2.7\Release\display.o

    In file included from display.c:40:

    libImaging/ImDib.h:38: error: expected specifier-qualifier-list before 'UINT8'

    display.c: In function '_fromstring':

    display.c:186: error: 'struct ImagingDIBInstance' has no member named 'ysize'

    display.c:186: error: 'struct ImagingDIBInstance' has no member named 'linesize'

    display.c:191: error: 'struct ImagingDIBInstance' has no member named 'bits'

    display.c: In function '_tostring':

    display.c:204: error: 'struct ImagingDIBInstance' has no member named 'bits'

    display.c:204: error: 'struct ImagingDIBInstance' has no member named 'ysize'

    display.c:204: error: 'struct ImagingDIBInstance' has no member named 'linesize'

    display.c: In function '_getattr':

    display.c:230: error: 'struct ImagingDIBInstance' has no member named 'mode'

    display.c:232: error: 'struct ImagingDIBInstance' has no member named 'xsize'

    display.c:232: error: 'struct ImagingDIBInstance' has no member named 'ysize'

    display.c: In function 'PyImaging_DrawWmf':

    display.c:761: warning: pointer targets in passing argument 2 of 'SetWinMetaFileBits' differ in signedness

    display.c:767: warning: pointer targets in passing argument 2 of 'SetEnhMetaFileBits' differ in signedness

    display.c:793: warning: passing argument 4 of 'CreateDIBSection' from incompatible pointer type

    C:\Python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution option: 'use_2to3'

      warnings.warn(msg)

    error: command 'gcc' failed with exit status 1

    Complete output from command C:\entorno\Scripts\python.exe -c "import setuptools;__file__='C:\\entorno\\build\\pillow\\setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record c:\docume~1\aaa\config~1\temp\pip-8kdxpq-record\install-record.txt --single-version-externally-managed --install-headers C:\entorno\include\site\python2.7:

    running install

running build

running build_py

running build_ext

building '_imaging' extension

creating build\temp.win32-2.7

creating build\temp.win32-2.7\Release

creating build\temp.win32-2.7\Release\libimaging

c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c _imaging.c -o build\temp.win32-2.7\Release\_imaging.o

c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c decode.c -o build\temp.win32-2.7\Release\decode.o

c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c encode.c -o build\temp.win32-2.7\Release\encode.o

c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c map.c -o build\temp.win32-2.7\Release\map.o

c:\mingw\bin\gcc.exe -mno-cygwin -mdll -O -Wall -IlibImaging -IC:\entorno\include -IC:\Python27\include -IC:\entorno\PC -c display.c -o build\temp.win32-2.7\Release\display.o

In file included from display.c:40:

libImaging/ImDib.h:38: error: expected specifier-qualifier-list before 'UINT8'

display.c: In function '_fromstring':

display.c:186: error: 'struct ImagingDIBInstance' has no member named 'ysize'

display.c:186: error: 'struct ImagingDIBInstance' has no member named 'linesize'

display.c:191: error: 'struct ImagingDIBInstance' has no member named 'bits'

display.c: In function '_tostring':

display.c:204: error: 'struct ImagingDIBInstance' has no member named 'bits'

display.c:204: error: 'struct ImagingDIBInstance' has no member named 'ysize'

display.c:204: error: 'struct ImagingDIBInstance' has no member named 'linesize'

display.c: In function '_getattr':

display.c:230: error: 'struct ImagingDIBInstance' has no member named 'mode'

display.c:232: error: 'struct ImagingDIBInstance' has no member named 'xsize'

display.c:232: error: 'struct ImagingDIBInstance' has no member named 'ysize'

display.c: In function 'PyImaging_DrawWmf':

display.c:761: warning: pointer targets in passing argument 2 of 'SetWinMetaFileBits' differ in signedness

display.c:767: warning: pointer targets in passing argument 2 of 'SetEnhMetaFileBits' differ in signedness

display.c:793: warning: passing argument 4 of 'CreateDIBSection' from incompatible pointer type

C:\Python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution option: 'use_2to3'

  warnings.warn(msg)

error: command 'gcc' failed with exit status 1

----------------------------------------

Command C:\entorno\Scripts\python.exe -c "import setuptools;__file__='C:\\entorno\\build\\pillow\\setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record c:\docume~1\aaa\config~1\temp\pip-8kdxpq-record\install-record.txt --single-version-externally-managed --install-headers C:\entorno\include\site\python2.7 failed with error code 1 in C:\entorno\build\pillow

Exception information:
Traceback (most recent call last):
  File "C:\entorno\lib\site-packages\pip-1.2.1-py2.7.egg\pip\basecommand.py", line 107, in main
    status = self.run(options, args)
  File "C:\entorno\lib\site-packages\pip-1.2.1-py2.7.egg\pip\commands\install.py", line 261, in run
    requirement_set.install(install_options, global_options)
  File "C:\entorno\lib\site-packages\pip-1.2.1-py2.7.egg\pip\req.py", line 1166, in install
    requirement.install(install_options, global_options)
  File "C:\entorno\lib\site-packages\pip-1.2.1-py2.7.egg\pip\req.py", line 589, in install
    cwd=self.source_dir, filter_stdout=self._filter_install, show_stdout=False)
  File "C:\entorno\lib\site-packages\pip-1.2.1-py2.7.egg\pip\util.py", line 612, in call_subprocess
    % (command_desc, proc.returncode, cwd))
InstallationError: Command C:\entorno\Scripts\python.exe -c "import setuptools;__file__='C:\\entorno\\build\\pillow\\setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record c:\docume~1\aaa\config~1\temp\pip-8kdxpq-record\install-record.txt --single-version-externally-managed --install-headers C:\entorno\include\site\python2.7 failed with error code 1 in C:\entorno\build\pillow 
```

它不是我唯一遇到问题的库，但我需要安装它。

谢谢！

PS：这是谷歌翻译，不好意思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-17T10:19:36.963

当我尝试在 Windows 下安装 Pillow 时，我遇到了类似的 gcc 失败，原因显然是 setuptools 版本过时。

[安装文档说](http://pillow.readthedocs.org/en/latest/installation.html#windows-installation)：

> **Python Wheel**
> *注意：*实验性的。需要 setuptools >=0.8 和 pip >=1.4.1
> `$ pip install --use-wheel Pillow`

因此，我[更新了 setuptools](https://pypi.python.org/pypi/setuptools#windows)（确保我删除了旧版本），并且 pip install 开始完美运行。

# c++ - boost::threads notify_one 与 notify_all 的性能

> ID：14882743
> 
> 赞同：2
> 
> 时间：2013-02-14T19:42:01.150
> 
> 标签：c++, multithreading, boost, semaphore, boost-thread

我有一个信号量的实现来使用 boost::threads 管理共享资源。我的信号量实现如下所示。

```
void releaseResource()
{
    boost::unique_lock<boost::mutex> lock(mutex_);
    boost::thread::id curr_thread =  boost::this_thread::get_id();
    // scan through to identify the current thread
    for (unsigned int i=0; i<org_count;++i)
    {
        if (res_data[i].thread_id == curr_thread)
        {
            res_data[i].thread_id = boost::thread::id();
            res_data[i].available = true;
            break;
        }
    }
    ++count_;
    condition_.notify_one();
}

unsigned int acquireResource()
{
    boost::unique_lock<boost::mutex> lock(mutex_);
    while(count_ == 0)  { // put thread to sleep until resource becomes available
        condition_.wait(lock);
    }
    --count_;
    // Scan through the resource list and hand a index for the resource
    unsigned int res_ctr;
    for (unsigned int i=0; i<org_count;++i)
    {
        if (res_data[i].available)
        {
            res_data[i].thread_id = boost::this_thread::get_id();
            res_data[i].available = false;
            res_ctr = i;    
            break;
        }
    }
    return res_ctr;
} 
```

我的问题是关于当线程数多于可用资源数时我注意到的性能下降。如果我使用`notify_all`唤醒线程而不是代码`notify_one`中所示的那样`releaseResource()`，我会看到性能有所提高。有没有其他人经历过类似的事情？

我正在使用**Windows 7**并**提升 1.52**。

# javascript - 单击使用 jquery/javascript 切换

> ID：14882751
> 
> 赞同：0
> 
> 时间：2013-02-14T19:42:31.397
> 
> 标签：javascript, jquery, html, web

我想单击一个表格元素并让它在第一次单击时执行 x，如果再次单击则执行 Y

```
<td class='p' id='e1' onclick="myFunction2()"><img src='person2.png'/></td> 
```

这就是我刚才单击的 HTML 的内容，但我希望更改它以便可以选择一个项目，然后如果再次单击以取消选择，它将触发不同的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:57:39.017

我将*假设*（您没有说）您希望每次单击时调用该*函数*：

```
$('#e1').on('click', function() {

    // retrieve current state, initially undefined
    var state = $(this).data('state');  

    // toggle the state - first click will make this "true"
    state = !state; 

    // do your stuff
    if (state) {
        // do this (1st click, 3rd click, etc)
    } else {
        // do that
    }

    // put the state back
    $(this).data('state', state);  
}); 
```

这使用 jQuery 的`.data`特性将按钮的单击状态存储在按钮元素本身中。

或者，您可以使用外部变量，但您应该将回调包含在闭包中（在这种情况下是*立即调用的函数表达式*）以防止变量成为全局变量：

```
(function() {
    var state;

    $('#e1').on('click', function() {
        state = !state; 
        if (state) {
            // do this (1st click, 3rd click, etc)
        } else {
            // do that
        }
    });
})(); 
```

如果`.on`调用和`state`变量声明在一个 jQuery`document.ready`处理程序中，就会产生相同的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:53:14.810

**演示：http: [//jsfiddle.net/HJwJf/](http://jsfiddle.net/HJwJf/)**

将切换方法与；

```
 $("button").toggle(function(){
    $("body").css("background-color","green");},
    function(){
    $("body").css("background-color","red");},
    function(){
    $("body").css("background-color","yellow");}
  ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:56:47.657

非常基本，让我知道这是否接近您想要的。

[http://jsfiddle.net/WNJ75/6/](http://jsfiddle.net/WNJ75/6/)

```
<div id="e1">Click Me</div> 
```

.

```
(function() {
    var click_track = 1;

        $("#e1").click(function() {
            if (click_track == 1)
              alert("do something");
            else if (click_track == 2) {
               alert("do something else and reset click");
               click_track = 0;
            }

            click_track++;
        });
})(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:07:32.543

您可以在名为“clickCount”的 HTML 元素上创建一个新属性，并在事件处理程序中将其用作计数器。

假设您有一个像这样的按钮：

```
<button data-click-count='0' onclick="myFunction(this)">My Button</button> 
```

你有这样的功能：

```
function myFunction(elt) {
   // Gets the clicks count
   var count = $(elt).data("click-count");

   // Adds one to the click counter
   $(elt).data("click-count", ++count);  

   if (count == 1)
      doSomething();
   else if (count == 2)
      doSomethingElse();
} 
```

每次单击该按钮时，您都会看到一条提示，其中包含您的点击次数。

您可以使用相同的方法并将其应用于您的案例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:18:27.563

使用`state`变量。`state`变量将在值之间和`0`每次`1`点击时交换。利用我们可以在数组`state`中执行相应的函数。`fn`

```
<td class='p' id='e1'><img src='person2.png'/></td> 
```

```
$("td#e1.p").each(function(){
  var state = 1, fn = [myFunction1, myFunction2];
  $(this).click(function(){
    return fn[state = 1 - state].apply(this, arguments);
  });
}); 
```

此外，最好使用正确的事件绑定而不是内联 JavaScript。

# r - 如何将 sqlSave 函数与 R 中的现有表一起使用

> ID：14882754
> 
> 赞同：2
> 
> 时间：2013-02-14T19:42:47.140
> 
> 标签：r, rodbc

我可以使用 sqlSave 创建一个新表并将数据附加到该表，但我希望平板电脑有一些额外的列（例如，一个“ID”自动增量列 - 我在创建表和测试后手动添加这些列我可以保存到它并附加到它）。一旦我在添加这些列后尝试使用 sqlSave，我在尝试使用 sqlSave 附加更多数据时会收到错误

```
Error in odbcUpdate... missing columns in 'data' 
```

所以我在我的数据框中添加了一个 ID 列（因此它的列将与我的数据库表匹配）并尝试将其设置为“NULL”、NULL 和“”。我不断收到同样的错误。

有任何想法吗？

谢谢， 艾瑞克

PS 我正在将 RODBC 与 MySQL OOBC 驱动程序版本 5.1 一起使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:55:04.520

啊，我明白了。sqlSave 函数似乎将所有内容都小写。我不确定它在幕后做了什么检查，但是如果我创建一个“id”列它可以工作，但一个“ID”列没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T17:46:15.483

尝试 odbcConnect 中的 case="nochange" 参数。我将 RODBC (1.3-10) 与 MySQL ODBC 驱动程序版本 5.2 一起使用，它适用于我。

# php - 程序生成纹理

> ID：14882756
> 
> 赞同：9
> 
> 时间：2013-02-14T19:42:48.700
> 
> 标签：php, image-manipulation

我正在尝试找出一个将生成纹理的脚本（然后可以将其乘以灰度图像以“应用”它）。到目前为止，我的方法包括播种 RNG，然后随机生成 [0,3] 范围内的整数的 8x8 矩阵，然后使用某种级别的插值将该矩阵放大到 256x256 图像。

这是一个示例输出（种子值 24）：

[![样本](../Images/c364807c951dd80ab23c2e85c83bc577.png)](https://i.stack.imgur.com/zwNku.png)
[（来源：[adamhaskell.net](http://adamhaskell.net/misc/texture/sample.png)）]

左侧是使用最近邻插值缩放的矩阵。右边是我对双线性插值的尝试。在大多数情况下，它看起来还不错，但是你会得到像左中附近这样的结构，其中有两个对角相邻的橙色正方形面对两个对角相邻的红色正方形，结果是该区域没有插值。此外，它被更多地视为热图（如左上角大量橙色所示），这会导致更多问题。

这是我的“双线性插值”代码：

```
<?php
$matrix = Array();
srand(24);
$dim = 256;
$scale = 32;
for($y=0;$y<=$dim/$scale;$y++) for($x=0;$x<=$dim/$scale;$x++) $matrix[$y][$x] = rand(0,3);
$img = imagecreate($dim,$dim);
imagecolorallocate($img,255,255,255);
$cols = Array(
    imagecolorallocate($img,128,0,0),
    imagecolorallocate($img,128,64,32),
    imagecolorallocate($img,128,128,0),
    imagecolorallocate($img,64,64,64)
);
for($y=0;$y<$dim;$y++) {
    for($x=0;$x<$dim;$x++) {
        $xx = floor($x/$scale); $yy = floor($y/$scale);
        $x2 = $x%$scale; $y2 = $y%$scale;
        $col = $cols[round((
            $matrix[$yy][$xx]*($scale-$x2)*($scale-$y2)
            + $matrix[$yy][$xx+1]*$x2*($scale-$y2)
            + $matrix[$yy+1][$xx]*($scale-$x2)*$y2
            + $matrix[$yy+1][$xx+1]*$x2*$y2
        )/($scale*$scale))];
        imagesetpixel($img,$x,$y,$col);
    }
}
header("Content-Type: image/png");
imagepng($img);
exit; 
```

实际上，这可能是一个 XY 问题。我特别想做的是为我正在计划的游戏中的生物生成“毛皮图案”。特别是我希望能够拥有它，以便繁殖混合来自两个父母的元素（无论是颜色还是图案元素），所以仅仅拥有一个随机种子并不会真正削减它。理想情况下，我需要某种基于矢量的方法，但我已经超出了我的深度，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T21:46:32.230

我想到了几件事：

1.  您没有插入颜色值。为了扩展 zakinster 的评论，您正在对颜色索引进行插值，然后四舍五入到最接近的值。这样做的一个效果是，您最终会在橙色（索引 1）和灰色（索引 3）区域之间出现一圈黄色（索引 2）。如果您改为插入颜色值，您可能会得到灰橙色？

2.  最终图像中的黄色和橙色较多，红色和灰色较少。这是因为使用 round() 捕捉到颜色索引。您的计算（在 round() 之前）可能会产生均匀分布在 0 到 3 之间的浮点数，但舍入不会保留它。

所以，这里有一些建议：

1.  如果您不限于 4 种颜色，请使用更多。插值颜色值（即 (128,0,0) 与 (64,64,64) 混合产生 (91,32,32)）而不是索引。

2.  如果您仅限于这 4 种颜色，请尝试某种抖动。一种简单的方法是对您的代码进行最少的更改，即为所选的颜色索引添加一些随机性。因此，不要使用 round(...)，而是执行以下操作：假设您的计算产生值 1.7。然后，以 70% 的概率四舍五入到 2，其余 30% 的概率向下舍入到 1。这将混合颜色，但可能会产生非常嘈杂的图像。如果您准备更大幅度地更改您的代码，请查看[Floyd-Steinberg dithering](http://en.wikipedia.org/wiki/Floyd%E2%80%93Steinberg_dithering "弗洛伊德-斯坦伯格抖动")。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T22:18:10.803

我知道这是老问题，@markku-k 的回答是正确的，无论如何我有类似的问题，这是我修改后的问题代码

几个注意事项：

1.  它合而为一地生成 2 个图像，以显示“原始矩阵”和结果
2.  它使用 8x8 矩阵来产生结果，但实际矩阵是 10x10 来覆盖边界
3.  它使用基于简单增量的颜色到颜色索引算法，它对我来说没问题

这是代码：

```
<?php
$matrix = array();
$dim = 256;
$scale = 32;

for($y=0; $y<=9; $y++)
{
    $matrix[$y] = array();
    for($x=0; $x<=9; $x++)
    {
        $same = false;
        do
        {
            $matrix[$y][$x] = mt_rand(0, 3); // do not use rand function, mt_rand provide better results
            if ( ($x>0) && ($y>0) ) // check for checkers siatuion, where no colors are preferable and produce 90 degree angles
            {
                $c1 = $matrix[$y-1][$x-1];
                $c2 = $matrix[$y][$x];
                $c3 = $matrix[$y-1][$x];
                $c4 = $matrix[$y][$x-1];
                $same = ( ($c1==$c2) && ($c3==$c4) );
            }
        } while ($same);
    }
}

$img = imagecreate($dim*2 + 32*4, $dim + 32*2);
$colorsRGB = array(0x800000, 0x804020, 0x808000, 0x404040);
$cols = Array(
        imagecolorallocate($img,128,0,0), // red
        imagecolorallocate($img,128,64,32), // orange
        imagecolorallocate($img,128,128,0), // yellow
        imagecolorallocate($img,64,64,64), // gray
        imagecolorallocate($img,0,0,0), // black, just to fill background
);

imagefilledrectangle($img, 0, 0, $dim*2 + 32*4 - 1, $dim + 32*2 - 1, $cols[4]);

function mulclr($color, $multiplicator)
{
    return array(($color>>16) * $multiplicator, (($color>>8)&0xff) * $multiplicator, ($color&0xff) * $multiplicator);
}

function addclr($colorArray1, $colorArray2)
{
    return array($colorArray1[0]+$colorArray2[0], $colorArray1[1]+$colorArray2[1], $colorArray1[2]+$colorArray2[2]);
}

function divclr($colorArray, $div)
{
    return array($colorArray[0] / $div, $colorArray[1] / $div, $colorArray[2] / $div);
}

function findclridx($colorArray, $usedColors)
{
    global $colorsRGB;

    $minidx = $usedColors[0];
    $mindelta = 255*3;
    foreach ($colorsRGB as $idx => $rgb)
    {
        if (in_array($idx, $usedColors))
        {
            $delta = abs($colorArray[0] - ($rgb>>16)) + abs($colorArray[1] - (($rgb>>8)&0xff)) + abs($colorArray[2] - ($rgb&0xff));
            if ($delta < $mindelta)
            {
                $minidx = $idx;
                $mindelta = $delta;
            }
        }
    }
    return $minidx;
}

for($y=0; $y<($dim+64); $y++)
{
    for($x=0; $x<($dim+64); $x++)
    {
        $xx = $x>>5;
        $yy = $y>>5;
        $x2 = ($x - ($xx<<5));
        $y2 = ($y - ($yy<<5));

        imagesetpixel($img, $x, $y, $cols[$matrix[$yy][$xx]]);

        if ( ($xx>0) && ($yy>0) && ($xx<=8) && ($yy<=8) )
        {
            $color1 = $colorsRGB[$matrix[$yy][$xx]];
            $color2 = $colorsRGB[$matrix[$yy][ ($xx+1) ]];
            $color3 = $colorsRGB[$matrix[ ($yy+1) ][$xx]];
            $color4 = $colorsRGB[$matrix[ ($yy+1) ][ ($xx+1) ]];

            $usedColors = array_unique(array($matrix[$yy][$xx], $matrix[$yy][ ($xx+1) ], $matrix[ ($yy+1) ][$xx], $matrix[ ($yy+1) ][ ($xx+1) ]));

            $a1 = mulclr($color1, ($scale-$x2)*($scale-$y2));
            $a1 = addclr($a1, mulclr($color2, $x2*($scale-$y2)));
            $a1 = addclr($a1, mulclr($color3, ($scale-$x2)*$y2));
            $a1 = addclr($a1, mulclr($color4, $x2*$y2));
            $a1 = divclr($a1, $scale*$scale);
            $clrIdx = findclridx($a1, $usedColors);

            $col = $cols[$clrIdx];
            imagesetpixel($img, $dim+$x+32*2, $y, $col);
        }
    }
}
header("Content-Type: image/png");
imagepng($img);
exit; 
```

这是示例结果：

![在此处输入图像描述](../Images/e5d17d97ebd0d759d02ad43ae8a0090b.png)

# math - Matlab：尝试引用非结构数组的字段

> ID：14882757
> 
> 赞同：1
> 
> 时间：2013-02-14T19:42:44.783
> 
> 标签：math, matlab

我正在使用内核密度估计器工具箱表单[http://www.ics.uci.edu/~ihler/code/kde.html](http://www.ics.uci.edu/~ihler/code/kde.html)。但是当我尝试执行演示文件时出现以下错误 -

```
>> demo_kde_3
KDE Example #3 : Product sampling methods (single, anecdotal run)
Attempt to reference field of non-structure array.

Error in double (line 10)
if (npd.N > 0) d = 1;            % return 1 if the density exists

Error in repmat (line 49)
nelems = prod(double(siz));

Error in kde (line 39)
if (size(ks,1) == 1) ks = repmat(ks,[size(points,1),1]); end;

Error in demo_kde_3 (line 8)
p = kde([.1,.45,.55,.8],.05);  % create a mixture of 4 gaussians for
testing 
```

谁能建议可能出了什么问题？我是 Matlab 的新手，很难找出问题所在。

谢谢你，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:36:50.597

尝试将当前目录从`@kde`文件夹中移开；执行此操作时，您可能必须将`@kde`文件夹添加到路径中。例如运行：

```
cd('c:\');
addpath('full\path\to\the\folder\@kde'); 
```

您可能还需要添加

```
addpath('full\path\to\the\folder\@kde\examples'); 
```

然后看看它是否有效。

看起来函数`repmat`（mathworks 函数）正在获取`@kde`类的`double`函数版本，从而导致错误。通常，只有类的对象`@kde`才能调用`@kde`文件夹中的函数。

我很少使用`@folder`类定义的形式，所以对语义不是很确定；我很好奇这是否对错误有任何影响。

* * *

一般来说，我不建议您将`@folder`类格式用于您所做的任何开发。mathworks 在几个版本之前将他们的 OO 范式大修为更熟悉（和有用）的格式。用于`help classdef`查看更多。此`@kde`代码似乎早于此升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:21:45.823

MATLAB 为您提供发生错误的代码行。由于属于 MATLAB，错误可能在`double`第39 行。在 MATLAB 调试器中打开该文件，在该行设置断点（因此在执行该特定行之前立即停止执行），然后当代码在那里停止时，检查情况。在控制台中尝试整个代码行（复制粘贴或键入它，不要单步执行，因为单步执行会导致调试器中的代码执行结束时导致未捕获的错误），它应该会给您一个错误（但不会停止执行）。然后尝试该代码行的代码片段，哪些可以正常工作，哪些不能，例如。的结果是否有意义。`repmat``kde.m``size(points, 1)`

但是，调试不熟悉的代码并不是一件容易的事，尤其是如果您是 MATLAB 的初学者。但是，如果您学习并理解了 MATLAB 的基本数据类型（数组、元胞数组和结构）以及处理它们的不同方式，并将这些知识应用到第 39 行的情况中`kde.m`，希望您可以修复错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T12:53:34.663

Repmat 调用`double`并期望调用内置的 double。

但是我猜这不是该代码的一部分：

```
if (npd.N > 0) d = 1;            % return 1 if the density exists 
```

因此，如果一切正确，则意味着内置函数`double`已重载，这就是代码崩溃的原因。

**编辑：** 我看到@Pursuit 已经解决了这个问题，但我会留下我的答案，因为它更多地描述了检测方法。

# shell - shell脚本ffmpeg在2个作业后停止

> ID：14882759
> 
> 赞同：0
> 
> 时间：2013-02-14T19:43:10.587
> 
> 标签：shell, ffmpeg

我有一个非常简单的 shell 脚本，在完成前两项工作后，它只是停下来坐在那里，什么都不做，第三项工作似乎无关紧要，如果我切换顺序等，它不会完成它。

任何想法都会很棒...

这是我的shell脚本

```
for f in "$@"
do
name=$(basename "$f")
dir=$(dirname "$f")
/opt/local/bin/ffmpeg -i "$f" -y -b 250k -deinterlace -vcodec vp8 -acodec libvorbis -nostdin "$dir/webm/${name%.*}.webm"
/opt/local/bin/ffmpeg -i "$f" -y -b 250k -strict experimental -deinterlace -vcodec h264 -acodec aac -nostdin "$dir/mp4/${name%.*}.mp4"
/opt/local/bin/ffmpeg -i "$f" -y -ss 00:00:15.000 -deinterlace -vcodec mjpeg -vframes 1 -an -f rawvideo -s 720x480 "$dir/img/${name%.*}.jpg"
done 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:30:15.463

你的最后`ffmpeg`一行需要`-nostdin`。

[从 Shell 脚本 /bin/sh 运行 FFMPEG](https://stackoverflow.com/q/14866436/#14866487)

# memory - 如何检索内存类型（rdimm 或 udimm）？

> ID：14882767
> 
> 赞同：3
> 
> 时间：2013-02-14T19:43:34.480
> 
> 标签：memory, powershell, wmi, powershell-2.0

有没有办法知道安装的内存是 Registered DIMM 还是 Unregistered DIMM？win32_physicalMemory[似乎](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394347%28v=vs.85%29.aspx)没有提供此信息？

[您可以在此处](http://www.servethehome.com/unbuffered-registered-ecc-memory-difference-ecc-udimms-rdimms/)找到有关 udimm rdimm 的更多信息

编辑：@CB 提供的解决方案也不起作用 ![在此处输入图像描述](../Images/8d20534d0a871a502f679b48518626e4.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:30:25.397

第一个想法是使用 WMI`Win32_PhysicalMemory`并测试 TotalWidth（包括校验位的位数）是否大于 DataWidth（不包括校验位的位数）。

```
 gwmi Win32_PhysicalMemory | select totalwidth, datawidth, banklabel | 
 % {
 if ( $_.totalwidth > $_.datawidth )
 {
    "$($_.banklabel) is ECC memory type"
 }
 else
 {
    "$($_.banklabel) is non-ECC Memory Type"
 }
 } 
```

我不知道是否存在最好的方法，这会检查内存是否为 ECC。

试试这个检查缓冲/注册或非内存类型：

```
$a = Get-WMIObject -Class "Win32_PhysicalMemoryArray"

 Switch ($a.MemoryErrorCorrection) {
                    0 {Write-Host "ECC Type....:  Reserved"}
                    1 {Write-Host "ECC Type....:  Other"}
                    2 {Write-Host "ECC Type....:  Unknown"}
                    3 {Write-Host "ECC Type....:  None"}
                    4 {Write-Host "ECC Type....:  Parity"}
                    5 {Write-Host "ECC Type....:  Single-bit ECC"} #unbuffered
                    6 {Write-Host "ECC Type....:  Multi-bit ECC"}  #registed
                    7 {Write-Host "ECC Type....:  CRC"}
                } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T08:27:14.040

由于我没有找到任何简单的解决方案，我想我会通过抓取戴尔支持站点（在此 url 上提供服务器 ServiceTag）来做到这一点：`http://support.euro.dell.com/support/DPP/Index.aspx?c=fr&cs=RC1077983&l=fr&s=pad&ServiceTag=XXXXXX` ![在此处输入图像描述](../Images/aa89c617f51514af40d6b972a0ff79cc.png)

# java - 单击按钮后显示 TextView

> ID：14882771
> 
> 赞同：0
> 
> 时间：2013-02-14T19:43:52.443
> 
> 标签：java, android, eclipse, eclipse-plugin

`TextView`单击按钮后，我想显示一个。

我的 Android 项目运行，但是当我单击按钮时，它会关闭我的应用程序。

显然我做错了什么。

这是我的代码：

```
public class AFragment extends Fragment {

Button button;
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
View mainView = (View) inflater.inflate(R.layout.afragment, container, false);
button = (Button) mainView.findViewById(R.id.button1);
addListenerOnButton();
return mainView;
}

public void addListenerOnButton() {
    button.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View mainView) {

            TextView view = (TextView) mainView.findViewById(R.id.textView1);
            view.setText("Do whatever");

        }

    });

}

} 
```

**日志猫**

```
02-14 21:51:35.896: E/AndroidRuntime(1536): FATAL EXCEPTION: main
02-14 21:51:35.896: E/AndroidRuntime(1536): java.lang.NullPointerException
02-14 21:51:35.896: E/AndroidRuntime(1536):     at    com.test.capitalpostouch.AFragment$1.onClick(AFragment.java:35)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.view.View.performClick(View.java:4084)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.view.View$PerformClick.run(View.java:16966)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.os.Handler.handleCallback(Handler.java:615)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.os.Looper.loop(Looper.java:137)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at android.app.ActivityThread.main(ActivityThread.java:4745)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at java.lang.reflect.Method.invokeNative(Native Method)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at java.lang.reflect.Method.invoke(Method.java:511)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-14 21:51:35.896: E/AndroidRuntime(1536):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:51:46.733

onClick() 不会给你 mainView 作为参数，而是给你点击的按钮。要么将你的 mainView 存储在类级别，要么使用 getActivity().findViewById()

是的，一些日志消息会很好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:52:03.587

在您的 onClick 方法中，`View`传入的不是您期望的“mainView”。传入的View就是被点击的视图；所以在这种情况下，您将获得 button 的视图`R.id.button`。

将线路从

`TextView view = (TextView) mainView.findViewById(R.id.textView1);`

到

`TextView view = (TextView) getView().findViewById(R.id.textView1);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:01:33.817

问题在于，在 中`setOnClickListener(View mainView)`，`View`作为参数传入的实际指的是侦听器所附加的按钮，而不是您试图用`LayoutInflater`. 请记住，包括`Button`s 在内的所有小部件也是`View`s。尝试这样的事情。

```
public class AFragment extends Fragment {
     View mainView;
     Button button;
     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
          mainView = (View) inflater.inflate(R.layout.afragment, container, false);
          button = (Button) mainView.findViewById(R.id.button1);
          button.setOnClickListener(buttonListener);
          return mainView;
     }

     private View.OnClickListener buttonListener = new View.OnClickListener() {
          @Override
          public void onClick(View button) {
               TextView textView = AFragment.this.mainView.findViewById(R.id.textView1);
               textView.setText("Do whatever");
          }
     }
} 
```

# iphone - Facebook Ios sdk 登录

> ID：14882773
> 
> 赞同：0
> 
> 时间：2013-02-14T19:43:54.507
> 
> 标签：iphone, ios, objective-c, facebook

我正在尝试使用 iOS facebook sdk 创建一个可以登录的功能，如果我登录了，我将能够看到 nslog 字符串“登录”。但是我根本没有看到它的字符串。此外，在按下按钮和查看我的 Facebook 应用程序并按确定继续时，登录似乎工作正常。有人可以告诉我我做错了什么吗？

```
 -(IBAction)popButton:(id)sender {

   TUAppDelegate *appDelegate = (TUAppDelegate *)[[UIApplication sharedApplication] delegate];

// this button's job is to flip-flop the session from open to closed
if (appDelegate.session.isOpen) {
    // if a user logs out explicitly, we delete any cached token information, and next
    // time they run the applicaiton they will be presented with log in UX again; most
    // users will simply close the app or switch away, without logging out; this will
    // cause the implicit cached-token login to occur on next launch of the application
    [appDelegate.session closeAndClearTokenInformation];

} else {
    if (appDelegate.session.state != FBSessionStateCreated) {
        // Create a new, logged out session.
        appDelegate.session = [[FBSession alloc] init];
    }

    // if the session isn't open, let's open it now and present the login UX to the user
    [appDelegate.session openWithCompletionHandler:^(FBSession *session,
                                                     FBSessionState status,
                                                     NSError *error) {
        // and here we make sure to update our UX according to the new session state
        [self updateView];
    }];
}
  }
- (void)updateView{
// get the app delegate, so that we can reference the session property
  TUAppDelegate *appDelegate = (TUAppDelegate *)[[UIApplication sharedApplication] delegate];
if (appDelegate.session.isOpen) {
    NSLog(@"Logged In");

} else {
    NSLog(@"Not Logged In");
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T21:27:19.273

我怀疑您至少错过了第 2d 步，将 openURL 连接回 Facebook SDK：

[https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/)

...也就是说，您很容易错过更多。如果您在登录后再次看到您的应用程序，那么我怀疑您已将 URL 方案添加到您的 Info.plist，否则也要检查。

# android - 位图阈值更快

> ID：14882774
> 
> 赞同：4
> 
> 时间：2013-02-14T19:44:02.977
> 
> 标签：android

我正在尝试编写一种方法，该方法将采用 a`Bitmap`并将其强制为严格的黑白图像（没有灰色阴影）。

我首先将位图传递给使用以下方法使其灰度化的方法`colormatrix`：

```
public Bitmap toGrayscale(Bitmap bmpOriginal)
{        
    int width, height;
    height = bmpOriginal.getHeight();
    width = bmpOriginal.getWidth();    

    Bitmap bmpGrayscale = Bitmap.createBitmap(width, height, Bitmap.Config.RGB_565);
    Canvas c = new Canvas(bmpGrayscale);
    Paint paint = new Paint();
    ColorMatrix cm = new ColorMatrix();
    cm.setSaturation(0);

    ColorMatrixColorFilter f = new ColorMatrixColorFilter(cm);
    paint.setColorFilter(f);

    c.drawBitmap(bmpOriginal, 0, 0, paint);
    return bmpGrayscale;
} 
```

效果很好，速度很快..

然后我将它传递给另一种方法以将灰度图像强制为 2 色图像（黑色和白色），这种方法有效，但显然它正在遍历每个像素，这需要很长时间：

```
public Bitmap toStrictBlackWhite(Bitmap bmp){
        Bitmap imageOut = bmp;
        int tempColorRed;
        for(int y=0; y<bmp.getHeight(); y++){
            for(int x=0; x<bmp.getWidth(); x++){
                tempColorRed = Color.red(imageOut.getPixel(x,y));
                Log.v(TAG, "COLOR: "+tempColorRed);

                if(imageOut.getPixel(x,y) < 127){
                    imageOut.setPixel(x, y, 0xffffff);
                }
                else{
                    imageOut.setPixel(x, y, 0x000000);
                }               
            }
        } 
        return imageOut;
    } 
```

有人知道更快更有效的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:08:25.500

不要使用`getPixel()`和`setPixel()`。

使用`getPixels()`它将返回所有像素的多维数组。在此数组上本地执行您的操作，然后用于`setPixels()`设置修改后的数组。这将明显更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:52:13.213

您是否尝试过将其转换为字节数组（请参阅[此处](https://stackoverflow.com/questions/4989182/converting-java-bitmap-to-byte-array)的答案）？

而且，当我对此进行研究时，[针对开发人员的关于位图处理的 Android 参考](http://developer.android.com/training/displaying-bitmaps/process-bitmap.html)也可能对您有所帮助。

# java - 简单的安卓程序上传到互联网

> ID：14882778
> 
> 赞同：0
> 
> 时间：2013-02-14T19:44:19.827
> 
> 标签：java, android

我的是一个简单的 Android 程序，将包含一些文本数据的文件上传到 Internet 上的某个服务器。我希望在应用程序上传时显示一个“圆形”忙碌图标。

我需要用 Java 或 XML 布局对动画进行硬编码吗？如何使我的服务组件（忙于上传）与显示“圆形”忙碌的组件进行通信，以使圆形环消失？谢谢。

--- 软件爱好者

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:46:58.660

有很多 AsynchTask 类的例子，它有一个 postExecute 方法来让你停止微调器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:00:39.010

您只需要编写一个 asynck 任务，如下所示

```
AsyncTask<Void,Vois,Void> myAsyncTask;

myAsyncTask=new AsyncTask<Void, Void, Void>(){

@Override
protected void onPreExecute() {
super.onPreExecute();
progrssDialog= new ProgressDialog(DeleteAppActivity.this);
progrssDialog.setCancelable(false);
progrssDialog.setMessage(getResources().getString(R.string.please_wait));
progrssDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
progrssDialog.show();

}

@Override
protected Void doInBackground(Void... params) {
response ="no response";
response=ServerUtilities.uploadFileOnserver();
return null;
}

@Override
protected void onPostExecute(Void result) {         
super.onPostExecute(result);
progrssDialog.dismiss();
    //perform action according to response

        if(respose.equals("success")){
          //show success message

        }else if(response.equals("failure"))

          //show error message
        }else {

         //show connectivity error message
        }
     }
   };

  myAsyncTask.execute(null,null,null); 
```

# java - 使用休息提出请求

> ID：14882781
> 
> 赞同：1
> 
> 时间：2013-02-14T19:44:33.583
> 
> 标签：java, rest, restlet

我最近开始研究restlet界面。我不知道如何翻译这个使用restlet接口的方法。

```
curl -X PUT  http://ip:port/testdb2 
```

我该如何翻译这个请求？到目前为止，我有这个代码：

```
 ClientResource resource = new ClientResource("http://"+this.ip+":5984/"); 

        // Send the HTTP GET request 
        Representation r=resource.get(); 

        if (resource.getStatus().isSuccess()) { 
           resource.getResponseEntity().write(System.out); 
        }   

        resource.put(null);

        if (resource.getStatus().isSuccess()){ 
             resource.getResponseEntity().write(System.out); 
        } else 
            System.out.println("Error put"); 
```

如何指定新网址？我需要这个请求来创建一个 couchDB 数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:45:22.927

改写您的问题，我将使用“如何向此 url 发出 PUT 请求......”

根据[http://www.restlet.org/documentation/2.0/firstResource#part07](http://www.restlet.org/documentation/2.0/firstResource#part07)

也许像

```
ClientResource dbResource = new ClientResource(  
            "http://"+this.ip+":5984/testdb2");

Representation r = dbResource.put(null); 
```

# c - C：为大型数据集生成哈希键？

> ID：14882784
> 
> 赞同：4
> 
> 时间：2013-02-14T19:44:44.290
> 
> 标签：c, hash, key

我目前正在玩散列和密钥生成，试图制作我自己的散列密钥生成器。

目前我有一个约 90000 个字符串的列表（每个 1 个单词和一个不同的单词）。我想知道生成键（数字键不是字符串键）的最佳方法是什么？

目前根据单词最后一个 ascii 字符，我根据字母的值进行计算。

结果是大约 50% 的单词生成了一个与另一个发生冲突的键。

我使用二次探测然后在表格中为其余的单词找到空间。

如上所述，我的问题通常是为 90000 个不同单词生成密钥的最佳方式是什么？我知道数据集越大，发生冲突的可能性就越大，但你会如何建议/或尽量减少冲突？

编辑：另外 - 我不关心密码学，它只需要快。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:50:24.587

您可以“借用” [Java 的`String`'s `hashCode`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/lang/String.java#String.hashCode%28%29)^*实现：

```
int hashCode(const char* s) {
    int h = 0;
    while (*s) {
        h = 31*h + (*s++);
    }
    return h;
} 
```

该函数实现了合理的分离，是目前使用最广泛的哈希函数之一。

^*[事实证明](https://stackoverflow.com/questions/14882784/c-generating-hash-keys-for-large-data-sets/14882862#comment20868704_14882862)，Java 又[“借用”了 Kernighan 和 Ritchie 的](http://www.strchr.com/hash_functions)C 编程书籍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:20:42.147

为了防止冲突，您需要一个好的散列密钥生成器。

有几种可用的算法。一种最近且非常快的称为[xxHash](http://code.google.com/p/xxhash/)。它是用 C 编写的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:53:59.373

选择 90,000 大小的哈希表不是一个好选择，完美哈希的概念要好得多，根据这个使用双重哈希，一个用于表查找，另一个用于维护列表，我认为你应该尝试两者的乘法方法那是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:15:29.520

我见过 Knuth 使用：

```
 register int h,k; register char *p;
  for (h=0,p=w;*p;p++) h=(*p+h+h)%hash_prime; 
```

其中 hash_prime 是大于哈希表中预期活动条目数 4 倍的素数。

请参阅：[Knuth 的 literateprogramming.com](http://www.literateprogramming.com/cweb_download.html)，Adventure 示例。

这是上下文中的哈希代码：

```
#define hash_prime 1009/* the size of the hash table */

typedef struct {
  char text[6]; /* string of length at most 5 */
  char word_type; /* a |wordtype| */
  char meaning;
} hash_entry;

hash_entry hash_table[hash_prime]; /* the table of words we know */

void new_word(w,m)
  char *w; /* a string of length 5 or less */
  int m; /* its meaning */
{
  register int h,k; register char *p;
  for (h=0,p=w;*p;p++) h=(*p+h+h)%hash_prime;
  while (hash_table[h].word_type) {
    h++;if (h==hash_prime) h=0;
}

int lookup(w)
  char *w; /* a string that you typed */
{
  register int h; register char *p; register char t;
  t=w[5]; w[5]='\0'; /* truncate the word */
  for (h=0,p=w;*p;p++) h=(*p+h+h)%hash_prime; /* compute starting address */
  w[5]=t; /* restore original word */
  if (h<0) return -1; /* a negative character might screw us up */
  while (hash_table[h].word_type) {
    if (streq(w,hash_table[h].text)) return h;
    h++;if (h==hash_prime) h=0;
  }
  return -1;
} 
```

注意，这段代码：

```
 register char t;
  // . . .
  t=w[5]; w[5]='\0'; /* truncate the word */
  // . . .
  w[5]=t; /* restore original word */ 
```

是针对仅查看前 5 个字符的特定要求，应将其删除，以便散列整个单词。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-15T22:16:43.223

您想要的术语是雪崩 - 一种提供最佳传播的哈希函数。

如果您希望保证您的键是唯一的，并且如果您的数据集有零个重复，那么您可以将您的单词作为 base36 数字转换为 base10 数字。如果你使用 sroull() 你可以返回非常大的整数

```
char *p=myword;
for(; *p; p++) 
  *p=toupper(*p);
unsigned long long key=strtoull(myword, NULL, 36); 
```

这可能会溢出并仍然返回一个正数。给定长字符串时，某些哈希可能会溢出 32 位整数。Kerneghan 的哈希和 Bernstein 的哈希就是这样做的。

实际上，正如其他几个人所指出的那样：

考虑到冲突是 hash_table 大小的函数和 hash_function 模 hash_table 大小的雪崩。您想要的可能不是真正唯一的键，而是更好的 hash_table 算法和大小。

# java - 如何在 Java 中编写一个 .replaceFirst 对不在评论中的组执行 .replaceFirst 的正则表达式？

> ID：14882787
> 
> 赞同：0
> 
> 时间：2013-02-14T19:44:59.443
> 
> 标签：java, regex, regex-lookarounds

所以我需要返回修改后的字符串，它在跳过注释时用另一个令牌替换令牌的第一个实例。这是我正在谈论的一个例子：

```
This whole quote is one big String
-- I don't want to replace this @@
But I want to replace this @@! 
```

作为一名前 .NET 开发人员，我认为这很容易。我会像这样做一个负面的回顾：

```
(?<!--.*)@@ 
```

但后来我了解到 Java 不能做到这一点。所以在得知花括号没问题后，我尝试了这个：

```
(?<!--.{0,9001})@@ 
```

这并没有引发异常，但它确实与评论中的 @@ 匹配。

当我使用 Java 正则表达式测试器测试这个正则表达式时，它按预期工作。我能想到的唯一一件事就是我使用的是 Java 1.5。Java 1.5 的正则表达式引擎中是否有可能存在错误？假设它确实如此，我如何让 Java 1.5 做我想要它做的事情而不分解我的字符串并重新组装它？

**编辑**我将 # 更改为 -- 运算符，因为看起来正则表达式会更复杂，有两个字符而不是一个字符。我最初并没有透露我正在修改查询，以避免关于“你不应该那样修改查询！”的题外话讨论。我这样做是有充分理由的。请不要讨论查询修改的良好做法。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T19:50:40.660

你真的不需要`negative look-behind`这里。没有它你也可以做到。

它会是这样的：

```
String str = "I don't want to replace this @@";     
str = str.replaceAll("^([^#].*?)@@", "$1"); 
```

`@@`因此，它将字符串中不以 开头的字符串的第一次出现替换`#`为 before `@@`。所以，`@@`被删除。这里`replaceAll`有效，因为它使用了*不情愿的量词*- `.*?`。所以，它会自动停止在第一个`@@`.

* * *

正如@nhahtdh 在评论中正确指出的那样，如果您的评论位于行尾，这可能会失败。所以，你可以使用这个：

```
String str = "I don't want to # replace this @@";
str = str.replaceAll("^([^#]*?)@@", "$1"); 
```

这个适用于任何情况。在给定的示例情况下，它不会替换`@@`，因为它是注释的一部分。

* * *

如果您的评论开头由两个字符表示，则否定字符类将不起作用。你需要`negative look-ahead`像这样使用：

```
String str = "This whole quote @@  is one big String -- asdf @@\n" +
             "-- I don't want to replace this @@\n" + 
             "But I want to replace this @@!";
str = str.replaceAll("(?m)^(((?!--).)*?)@@", "$1");

System.out.println(str); 
```

**输出：**

```
This whole quote   is one big String -- asdf @@
-- I don't want to replace this @@
But I want to replace this ! 
```

`(?m)`模式的开头用于启用`MULTILINE`匹配模式，因此`^`将匹配每一行的开头，而不是整个表达式的开头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:58:25.370

你可以使用这样的东西：

```
String string = "This whole quote is one big String\n" +
                "# I don't want to replace this @@\n" +
                "And I also # don't want to replace this @@\n" +
                "But I want to replace this @@!\n" +
                "But not this @@!";

Matcher m =
    Pattern.compile (
        "^((?:[^@#]|@[^@]|#[^\n]*)*)@@", Pattern.MULTILINE).
            matcher (string);

StringBuffer result = new StringBuffer ();
if (m.find ())
    m.appendReplacement (result, "$1FOO");
m.appendTail (result);

System.out.println (result.toString ()); 
```

# iis - 如何使用 IIS 7.5 更改可以在表单中发布的字段数量？

> ID：14882788
> 
> 赞同：5
> 
> 时间：2013-02-14T19:45:01.697
> 
> 标签：iis, iis-7, coldfusion, iis-7.5, http-post

我们在网络应用的管理部分遇到了一些表单问题。有一些表单包含大量字段（范围可以从一个输入字段到数百个）。

我们发现，随着这些表单的增长，在发布表单时服务器会抛出 500 个错误。

运行测试后，我发现服务器可以处理包含 100 个字段的表单；一旦使用了 101 个或更多字段，我们就会得到错误。

我们运行 Coldfusion，我们确定 Coldfusion 没有抛出此错误。我们从未在 Coldfusion 中看到此错误记录，因此我们假设 IIS 甚至在将请求发送到 Coldfusion 服务器之前就抛出了错误。

我假设在 IIS 7.5 中有一些设置可以提高这个限制。我在网上搜索过，但我能找到的只是如何提高此数据的字节大小限制，而不是对允许的多个字段的任何限制。

那么，我是否正确地假设这可以改变，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-14T19:55:05.020

这是修补程序 APSB12-06 引入的问题。虽然这是一个 ColdFusion 错误，但人们报告说[在 Tomcat 中收到了该错误，然后才据称它击中了 CF 服务器](http://forums.adobe.com/message/4540754)

有一个设置`neo-runtime.xml`定义了`postsizelimit`- 并且默认为 100。

完整的笔记在[这里](http://helpx.adobe.com/coldfusion/kb/coldfusion-security-hotfix-apsb12-15.html)，但这里是简短的版本。

*此热修复在 ColdFusion 中有一个新设置，即 Post Parameter Limit。此设置限制发布请求中的参数数量。默认值为 100。如果 post 请求包含更多指定的参数，则服务器不处理该请求并引发异常。此过程使用 Hash Collision 防止 DoS 攻击。此设置不同于帖子大小限制（ColdFusion 管理员 > 设置 > 帖子数据的最大大小）。此设置未在 ColdFusion 管理员控制台中公开。但是您可以在 neo-runtime.xml 文件中轻松更改此限制。见下文第 5 点。想要更改 postParameterLimit 的客户，请转到 {ColdFusion-Home}/lib 进行服务器安装或 {ColdFusion-Home}/WEB-INF/cfusion/lib 进行多服务器或 J2EE 安装。在行之后打开文件 neo-runtime.xml。*

```
<var name='postSizeLimit'><number>100.0</number></var> 
```

*添加下面的行，您可以将 100 更改为所需的数字。*

```
<var name='postParametersLimit'><number>100.0</number></var> 
```

CF10+ 具有可在 CF 管理员设置页面下编辑的`Maximum number of POST request parameters`设置`Server Settings -> Settings`。

在我们的 9.0.1 服务器上，我们只是将设置增加到 10000，并且没有看到任何不利影响。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T19:58:32.207

我相信您遇到了 ColdFusion 的安全功能。您正在运行什么 ColdFusion 版本？在[ColdFusion 安全修补程序 APSB12-06 中](http://helpx.adobe.com/coldfusion/kb/coldfusion-security-hotfix.html)，他们引入了一个修复程序来防止使用哈希冲突的 DoS 攻击。从该页面：

> 此修补程序在 ColdFusion 中实现了一个新设置，即后参数限制。这限制了发布请求中的参数数量。默认值为 100。如果一个 post 请求包含更多指定的参数，服务器将不会处理该请求并抛出异常。这样做是为了防止使用 Hash Collision 的 DoS 攻击。此设置不同于帖子大小限制（ColdFusion 管理员 > 设置 > 帖子数据的最大大小）。我们不会在 ColdFusion 管理员控制台中公开此设置，但可以在 neo-runtime.xml 文件中轻松更改此限制。见下文第 5 点。

该页面上还有关于如何增加该限制的说明。基本上，您必须对 neo-runtime.xml 文件进行更改。

> 想要更改 postParameterLimit 的客户，请转到 `{ColdFusion-Home}/lib`服务器安装或多服务器 `{ColdFusion-Home}/WEB-INF/cfusion/lib`或 J2EE 安装。打开文件 neo-runtime.xml，行后：
> 
> ```
> <var name='postSizeLimit'><number>100.0</number></var> 
> ```
> 
> 添加以下行，您可以将 100 更改为所需的数字。
> 
> ```
> <var name='postParametersLimit'><number>100.0</number></var> 
> ```

# iphone - 视图消失后如何在 UITableView 中保留复选标记

> ID：14882791
> 
> 赞同：1
> 
> 时间：2013-02-14T19:45:24.423
> 
> 标签：iphone, ios, objective-c, uitableview

我有一个 uitableview，它显示带有自定义复选标记的多个选择。选择后，行值将使用 NSUserDefaults 保存。问题是，尽管保存了值，但复选标记从表格单元格行中消失了。我不知道为什么。

感谢您的帮助，我真的坚持这一点。

这是.h代码：

```
 @interface CategoriesViewController : UITableViewController {

    NSString *selectedCategoryTableString;

    NSString *jsonStringCategory;

    int prev;

}

// arForTable array will hold the JSON results from the api

@property (nonatomic, retain) NSArray *arForTable;
@property (nonatomic, retain) NSMutableArray *arForIPs;

@property (nonatomic, retain) NSMutableArray *categorySelected;

@property (nonatomic, retain) NSString *jsonStringCategory;
@property(nonatomic, retain) UIView *accessoryView;

@end 
```

和 .m 代码：

```
@implementation CategoriesViewController
@synthesize jsonStringCategory;
@synthesize arForTable = _arForTable;
@synthesize arForIPs = _arForIPs;

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.arForIPs=[NSMutableArray array];

    self.categorySelected = [[NSMutableArray alloc] init];

    [self reloadMain];

    self.tableView.allowsMultipleSelection = YES;
}

-(void) reloadMain {

    jsonString = @"http:///******";

    // Download the JSON
    NSString *jsonString = [NSString
                            stringWithContentsOfURL:[NSURL URLWithString:jsonString]
                            encoding:NSStringEncodingConversionAllowLossy|NSUTF8StringEncoding
                            error:nil];

    NSMutableArray *itemsTMP = [[NSMutableArray alloc] init];

    // Create parser
    SBJSON *parser = [[SBJSON alloc] init];
    NSDictionary *results = [parser objectWithString:jsonString error:nil];

    itemsTMP = [results objectForKey:@"results"];

    self.arForTable = [itemsTMP copy];

    [self.tableView reloadData];

}

#pragma mark - Table view data source

- (int)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (int)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.arForTable count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        [cell.textLabel setFont:[UIFont fontWithName: @"Asap-Bold" size: 14.0f]];
        [cell.detailTextLabel setFont:[UIFont fontWithName: @"Asap-Bold" size: 14.0f]];
        cell.accessoryView.hidden = NO;

    }

    UIImageView *cellAccessoryImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"icon-tick.png"]] ;
    UIImageView *cellAccessoryNoneImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@""]] ;

    if([self.arForIPs containsObject:indexPath]){
        cell.accessoryView = cellAccessoryImageView;
    } else {
        cell.accessoryView = cellAccessoryNoneImageView;
    }

    // Get item from tableData
    NSDictionary *item = (NSDictionary *)[_arForTable objectAtIndex:indexPath.row];

    // encoding fix
    NSString *utf8StringTitle = [item objectForKey:@"name"];

    NSString *correctStringTitle = [NSString stringWithCString:[utf8StringTitle cStringUsingEncoding:NSISOLatin1StringEncoding] encoding:NSUTF8StringEncoding];

    cell.textLabel.text = [correctStringTitle capitalizedString];

    NSNumber *num = [item objectForKey:@"id"];

    cell.detailTextLabel.text = [num stringValue];

    cell.detailTextLabel.hidden = YES;

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    if([self.arForIPs containsObject:indexPath]){
        [self.arForIPs removeObject:indexPath];

        [self.categorySelected removeObject:[[self.arForTable objectAtIndex:indexPath.row] objectForKey:@"id"]];

    } else {
        [self.arForIPs addObject:indexPath];

        [self.categorySelected addObject:[[self.arForTable objectAtIndex:indexPath.row] objectForKey:@"id"]];

        NSLog(@"%@ categorySelected",self.categorySelected);

        NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

        NSLog(@"%@ defaults categorySelected",[defaults arrayForKey:@"selectedCategoryTableString"]);

        NSString *string = [self.categorySelected componentsJoinedByString:@","];

        [defaults setObject:string forKey:@"selectedCategoryTableString"];

        NSLog(@"%@ STRING",string);

    }

    [tableView reloadData];
}

-(void) viewWillAppear:(BOOL)animated {

    [super viewWillAppear:NO];

    [self.navigationController setNavigationBarHidden:YES animated:NO];

    self.navigationController.toolbarHidden = YES;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:24:15.393

因为在您的表格中只有一个部分。试试这种方法，这肯定会帮助你。

在 `- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath` 编写以下代码；

```
 if([self.arForIPs containsObject:[NSNumber numberWithInt:indexPath.row]]){
        cell.accessoryView = cellAccessoryImageView;
    } else {
        cell.accessoryView = cellAccessoryNoneImageView;
    } 
```

在`- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath` 编写如下代码时，

```
 if([self.arForIPs containsObject:[NSNumber numberWithInt:indexPath.row]]){
            [self.arForIPs removeObject:[NSNumber numberWithInt:indexPath.row]];
        } else {
            [self.arForIPs addObject:[NSNumber numberWithInt:indexPath.row]]
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:17:25.287

首先，您的代码有很多内存泄漏，请务必使用静态分析器和/或工具来修复它们，对于它们来说很少有像您初始化 SBJSON 解析器但没有释放它一样明显，itemsTMP 是另一个。

我已经重写了您的代码以提高效率和记忆友好：

```
@interface CategoriesViewController : UITableViewController
{
    NSArray *_items;
    NSMutableArray *_selectedItems;

    UIImageView *cellAccessoryImageView;
}

@end

@implementation CategoriesViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    _selectedItems = [NSMutableArray new];

    cellAccessoryImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"icon-tick.png"]] ;

    [self reloadMain];

    self.tableView.allowsMultipleSelection = YES;
}

- (void)reloadMain
{    
    NSString *jsonString = @"http:///******";

    // Download the JSON
    jsonString = [NSString
                        stringWithContentsOfURL:[NSURL URLWithString:jsonString]
                        encoding:NSStringEncodingConversionAllowLossy|NSUTF8StringEncoding
                        error:nil];

    // Create parser
    SBJSON *parser = [SBJSON new];
    NSDictionary *results = [parser objectWithString:jsonString error:nil];

    if (_items) [_items release];
    _items = [[results objectForKey:@"results"] copy];

    [parser release];

    [self.tableView reloadData];
}

#pragma mark - Table view data source

- (int)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (int)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [_items count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil)
    {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];

        [cell.textLabel setFont:[UIFont fontWithName: @"Asap-Bold" size: 14.0f]];
        [cell.detailTextLabel setFont:[UIFont fontWithName: @"Asap-Bold" size: 14.0f]];
        cell.accessoryView.hidden = NO;

    }

    NSDictionary *item = [_items objectAtIndex:indexPath.row];

    if ([_selectedItems containsObject:item])
    {
        // preloaded image will help you have smoother scrolling 
        cell.accessoryView = cellAccessoryImageView;
    }
    else
    {
        cell.accessoryView = nil;
        cell.accessoryType = UITableViewCellAccessoryNone;
    }

    // Get item from tableData
    cell.textLabel.text = [[NSString stringWithCString:[[item objectForKey:@"name"] cStringUsingEncoding:NSISOLatin1StringEncoding] encoding:NSUTF8StringEncoding] capitalizedString];
    cell.detailTextLabel.text = [[item objectForKey:@"id"] stringValue];
    cell.detailTextLabel.hidden = YES;

    item = nil;

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    NSDictionary *item = [_items objectAtIndex:indexPath.row];
    if ([_selectedItems containsObject:item])
    {
        [_selectedItems removeObject:item];
    }
    else
    {
        [_selectedItems addObject:item];
    }
    item = nil;

    [tableView reloadRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationAutomatic];
}

- (void)dealloc
{
    [_selectedItems release];
    [cellAccessoryImageView release];

    [super dealloc];
}

@end 
```

# python - 如何在 django 模板中输出表单字典

> ID：14882792
> 
> 赞同：0
> 
> 时间：2013-02-14T19:45:24.123
> 
> 标签：python, django, forms, list, dictionary

我正在将表单列表保存为要发送到模板的视图中的变量。

当我迭代模板中的表单列表时，它给了我错误

> AttributeError：“长”对象没有属性“获取”

我最初尝试将表格保存在字典中，但遇到了同样的错误。我可以遍历传递给模板的查询集，但表单的列表或字典似乎无法被迭代。

有什么解决办法吗？

这是我的相关代码：

表格.py

```
from django.contrib.auth.models import User
from django import forms
from apps.account.models import UserProfile

class StaffUserTypeForm(forms.Form):
    user_type = forms.ChoiceField(choices=UserProfile.STAFF_CHOICES) 
```

帐户/models.py

```
from django.db import models
from django.contrib.auth.models import User

class UserProfile(models.Model):
    DEFAULT = 0
    ADMIN = 1
    MANAGER = 2
    COORDINATOR = 3
    REALTOR = 4
    TEAM_CAPTAIN = 5
    PROPERTY_OWNER = 6
    PRELOAD = 7
    BILLING = 8
    COORDINATOR_PRELOAD = 9

    STAFF_CHOICES = (
        (ADMIN, 'Admin'),
        (MANAGER, 'Manager'),
        (COORDINATOR, 'Coordinator'),
        (COORDINATOR_PRELOAD, 'Coordinator +Preload'),
        (PRELOAD, 'Preloader'),
        (BILLING, 'Billing'),
    )
    ... 
```

视图.py

```
from forms import *
    ...
    staff = Staff.objects.all()
    roles = []
    for member in staff:
        form = StaffUserTypeForm(initial=member.user.userprofile.user_type)
        roles.append(form)
    context.update({'staff':staff,'roles':roles})
    ... 
```

模板（这是它打破的地方）

```
{% for role in roles %}
{{role}}
{% endfor %} 
```

但这很好用：

```
{% for member in staff %}
{{member.user.first_name}}
{% endfor %} 
```

## 更新

该特定错误是因为我没有`initial`在表单中指定 user_type。

应该：

```
form = StaffUserTypeForm(initial={'user_type':member.user.userprofile.user_type}) 
```

但是，我仍然有为每个员工吐出表格的问题，因为我无法在模板中将变量引用为字典键：

如果：

```
roles = {}
for member in staff:
  roles[member] = StaffUserTypeForm(initial={'user_type':member.user.userprofile.user_type}) 
```

我无法获得特定工作人员的表格：

```
{% for member in staff %}
{{roles.member}}
{% endfor %} 
```

不起作用，并且不会引发错误。我认为，它只是看起来不存在的角色['member']。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:02:16.867

既然`roles`字典既包含成员（作为键）又包含表单（作为值），为什么还需要遍历`staff`呢？只需遍历`roles`.

```
{% for member, form in roles.items %}
    {{ member }} : {{ form }}
{% endfor %} 
```

# java - tomcat 的 ThreadLocalLeakPreventionListener 究竟是做什么的？

> ID：14882794
> 
> 赞同：4
> 
> 时间：2013-02-14T19:45:38.053
> 
> 标签：java, thread-local, thread-local-storage

文档`org.apache.catalina.core.ThreadLocalLeakPreventionListener`说

> A在停止`LifecycleListener`时触发 Executor 池中的线程更新，`Context`以避免与线程本地相关的内存泄漏。

它如何准确地防止`ThreadLocal`内存泄漏？上下文停止时是否显式调用`ThreadLocal`'方法？`remove()`

据我所知，`ThreadLocal`是作为哈希映射实现的。映射键是对`ThreadLocal`实例本身的引用。映射值是线程本地值。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-14T19:58:02.627

首先澄清一下。`ThreadLocal`当您在`ThreadLocal`应用程序中放置一些自定义类并且您在未先清除的情况下取消部署/重新部署该应用程序时，就会发生泄漏`ThreadLocal`。发生这种情况时，线程仍然持有对您的类的引用，该类持有对 的引用`ClassLoader`，而后者又持有对您（已经未部署的）Web 应用程序加载的所有其他类的引用。

并且线程仍然持有对您的对象的引用，因为`ThreadLocal`值实际上存储*在*线程内部。未能清除`ThreadLocal`意味着该特定值将由`Thread`对象持有，只要它正在运行。

现在回到您的问题 - 如果您忘记删除一些`ThreadLocal`它将被池线程永远引用。这就是 Tomcat 试图阻止的——如果怀疑泄漏，则关闭并创建新线程。它对 Web 应用程序是不可见的，但是当您停止池线程并将其替换为新线程时，旧线程将成为引用您的类、类加载器和所有其他内容的最后一个对象。最后，您的`ThreadLocal`价值有资格获得 GC。

# .net - 数据表转 CSV

> ID：14882796
> 
> 赞同：4
> 
> 时间：2013-02-14T19:45:41.453
> 
> 标签：.net, csv, datatable

这个问题与解析 CSV 无关。

使用以下代码从 DataTable 创建 CSV
但是
100 行 x 14 列速度很慢 4 秒
有没有更快的方法？

```
StringBuilder sb = new StringBuilder();
bool first = true;
int colCount = 0;
foreach (DataColumn dc in DT.Columns)
{
    if (first) first = false; else sb.Append(",");
    sb.Append("\"" + dc.ColumnName +  "\"");
    colCount++;
}
sb.AppendLine();
foreach (DataRow dr in DT.Rows)
{  
    first = true;
    for (int i = 0; i < colCount; i++)
    {
        if (first) first = false; else sb.Append(",");
        sb.Append("\"" + dr[i].ToString().Trim() + "\"");
    }
    sb.AppendLine();
}
return sb.ToString(); 
```

StringBuilder 不是这里的问题。
在 300 毫秒内将 i 从 0 加载到 100 万次运行

```
StringBuilder sb = new StringBuilder();
Stopwatch sw = new Stopwatch();
sw.Start();
for (int i = 0; i < 1000000; i++)
{
    sb.Append(i.ToString());
}
sw.Stop();
Debug.Write(sw.ElapsedMilliseconds.ToString()); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-03-22T20:51:19.147

有更快的方法来进行字符串连接和其他一些逻辑。使用字符串生成器来构建整个事物也可能是减速的一部分。正如一些人所建议的那样，图书馆已经考虑了其中一些事情，并且可能会执行得更快。

这是一些使用[CsvHelper](https://github.com/JoshClose/CsvHelper)的代码（我写的）。

```
using( var dt = new DataTable() )
{
    dt.Load( dataReader );
    foreach( DataColumn column in dt.Columns )
    {
        csv.WriteField( column.ColumnName );
    }
    csv.NextRecord();

    foreach( DataRow row in dt.Rows )
    {
        for( var i = 0; i < dt.Columns.Count; i++ )
        {
            csv.WriteField( row[i] );
        }
        csv.NextRecord();
    }
} 
```

如果你有，`DataReader`你甚至不必使用`DataTable`then，这也应该加快速度。

```
var hasHeaderBeenWritten = false;
while( dataReader.Read() )
{
    if( !hasHeaderBeenWritten )
    {
        for( var i = 0; i < dataReader.FieldCount; i++ )
        {
            csv.WriteField( dataReader.GetName( i ) );
        }
        csv.NextRecord();
        hasHeaderBeenWritten = true;
    }

    for( var i = 0; i < dataReader.FieldCount; i++ )
    {
        csv.WriteField( dataReader[i] );
    }
    csv.NextRecord();
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-14T23:00:34.803

你所拥有的不是“伟大”的代码......我认为大多数人会建议使用类似 CSVHelper nuget 包的东西。但是，我还要说，该代码并不是只有 100 行需要 4 秒的代码。获取数据表中的数据需要多长时间？我猜这就是 4 秒的大部分时间。

# internet-explorer-7 - 为具有相同类名的不同父级中的元素寻找 IE/z-index 解决方法

> ID：14882799
> 
> 赞同：1
> 
> 时间：2013-02-14T19:45:41.563
> 
> 标签：internet-explorer-7, z-index

我知道 IE7 关于 z-index 的错误以及如何将更高的 z-index 添加到要显示在其父级兄弟姐妹之上的元素的父级。但是我有几个具有相同类名的列表项（每个列表项及其子项具有相同的 DOM 结构），并且每个 LI 都有一个子元素，该子元素必须出现在 DOM 中下一个列表项的上方。由于我不会深入讨论的原因，我不能在每个 LI 上放置一个唯一的类名或 ID。

在 IE7 中，弹出窗口位于下一个 LI 下方。鉴于我不能以更高的 z-index 定位父 LI，有什么想法吗？谢谢。

示例截图：http: [//tinypic.com/r/2m5ud/6](http://tinypic.com/r/2m5ud/6)

# ruby-on-rails - 更改更新对象的状态时如何不包含时间戳？

> ID：14882801
> 
> 赞同：0
> 
> 时间：2013-02-14T19:45:42.920
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, state-machine, state-machine-workflow

我使用工作流作为状态机。我想在每次更新后将状态移动到，`awaiting_review`但我也有`current_sign_in_at`属性在用户登录后他的状态更改为`awaiting_review`如何避免这种情况？

```
before_save :needs_review, on: :update

# before_save
def needs_review
  self.state = 'awaiting_review' unless state_changed?
end

workflow do
  state :awaiting_review do
    event :accept, :transitions_to => :accepted
    event :reject, :transitions_to => :rejected
  end
  state :accepted do
    event :reject, :transitions_to => :rejected
  end
  state :rejected
end
#  sign_in_count          :integer          default(0)
#  current_sign_in_at     :datetime
#  last_sign_in_at        :datetime
#  current_sign_in_ip     :string(255)
#  last_sign_in_ip        :string(255) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:03:14.097

```
def needs_review
  if (%w[sign_in_count current_sign_in_at last_sign_in_at ...] & changes).empty?
    self.state = 'awaiting_review' unless state_changed?
  end
end 
```

# html - 在响应式设计中使用带有显示属性的“表格”和“表格单元”？

> ID：14882803
> 
> 赞同：6
> 
> 时间：2013-02-14T19:46:09.463
> 
> 标签：html, css, responsive-design, adaptive-design

![使用表格和表格单元格](../Images/5bbb7debb4b54ad57df0ea3652f33c7e.png)

我`display: table;`在容器和`display: table-cell;`子元素上使用，以在页面上水平突出显示一些帖子。

问题是，我不知道如何让它们做出响应，即随着屏幕尺寸变小，每个孩子（即`table-cell`）应该按比例变小，同时继续保持水平对齐。

我该怎么做呢？

*   示例代码： http: [//www.codepen.io/anon/pen/dCLgq](http://www.codepen.io/anon/pen/dCLgq)
*   演示：[http ://codepen.io/anon/full/dCLgq](http://codepen.io/anon/full/dCLgq)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T19:55:33.803

要随页面缩小内部容器，可以将容器`div`的宽度设置为`100%`：

在你的例子中：

```
#the-big-stories {
    display: table;
    table-layout: fixed;

    /** add 100% width **/
    width:100%;
} 
```

此外，如果您想使用子容器缩放图像，只需将它们`width: 100%;`与`height:auto;`

请参阅下面分叉的代码笔：

[http://codepen.io/braican/pen/xCmsw](http://codepen.io/braican/pen/xCmsw)

您可能需要使用媒体查询来真正让里面的东西很好地一起播放，但是容器会随着浏览器缩放，内部`div`的 's.

# javascript - 制作“jsddm”菜单以列出子菜单

> ID：14882805
> 
> 赞同：0
> 
> 时间：2013-02-14T19:46:13.157
> 
> 标签：javascript, jquery, html, css, menu

你能帮我制作这个 jquery/css/menu 来显示第二个级别吗？

这是代码：

HTML

```
<ul id="jsddm">
    <li><a href="#">JavaScript</a>
        <ul>
            <li><a href="#">Drop Down Menu</a></li>
            <li><a href="#">jQuery Plugin</a></li>
            <li><a href="#">Ajax Navigation</a></li>
        </ul>
    </li>
    <li><a href="#">Effect</a>
        <ul>
            <li><a href="#">Slide Effect</a></li>
            <li><a href="#">Fade Effect</a></li>
            <li><a href="#">Opacity Mode</a></li>
            <li><a href="#">Drop Shadow</a></li>
            <li><a href="#">Semitransparent</a></li>
        </ul>
    </li>
    <li><a href="#">Navigation</a></li>
    <li><a href="#">HTML/CSS</a></li>
    <li><a href="#">Help</a></li>
</ul> 
```

CSS

```
#jsddm
{   margin: 0;
    padding: 0}

    #jsddm li
    {   float: left;
        list-style: none;
        font: 12px Tahoma, Arial}

    #jsddm li a
    {   display: block;
        background: #20548E;
        padding: 5px 12px;
        text-decoration: none;
        border-right: 1px solid white;
        width: 70px;
        color: #EAFFED;
        white-space: nowrap}

    #jsddm li a:hover
    {   background: #1A4473}

        #jsddm li ul
        {   margin: 0;
            padding: 0;
            position: absolute;
            visibility: hidden;
            border-top: 1px solid white}

        #jsddm li ul li
        {   float: none;
            display: inline}

        #jsddm li ul li a
        {   width: auto;
            background: #9F1B1B}

        #jsddm li ul li a:hover
        {   background: #7F1616} 
```

查询

```
 var timeout    = 500;
var closetimer = 0;
var ddmenuitem = 0;

function jsddm_open()
{  jsddm_canceltimer();
   jsddm_close();
   ddmenuitem = $(this).find('ul').css('visibility', 'visible');}

function jsddm_close()
{  if(ddmenuitem) ddmenuitem.css('visibility', 'hidden');}

function jsddm_timer()
{  closetimer = window.setTimeout(jsddm_close, timeout);}

function jsddm_canceltimer()
{  if(closetimer)
   {  window.clearTimeout(closetimer);
      closetimer = null;}}

$(document).ready(function()
{  $('#jsddm > li').bind('mouseover', jsddm_open)
   $('#jsddm > li').bind('mouseout',  jsddm_timer)});

document.onclick = jsddm_close; 
```

我怎样才能插入一个多级菜单并使其工作？，我已经在这里停留了几天。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:04:26.303

完全不使用 jQuery 而只在菜单中使用 CSS 怎么样？

[http://jsfiddle.net/Sjhab/](http://jsfiddle.net/Sjhab/)

```
<ul id="jsddm">
<li><a href="#">JavaScript</a>
<ul>
    <li><a href="#">Drop Down Menu</a></li>
    <li><a href="#">jQuery Plugin</a></li>
    <li class="b"><a href="#">Ajax Navigation</a>
        <ul>
            <li><a href="#">AJAXIFY</a></li>
        </ul>
    </li>
</ul>
</li>
<li><a href="#">Effect</a>
<ul>
    <li><a href="#">Slide Effect</a></li>
    <li><a href="#">Fade Effect</a></li>
    <li><a href="#">Opacity Mode</a></li>
    <li><a href="#">Drop Shadow</a></li>
    <li><a href="#">Semitransparent</a></li>
</ul>
</li>
<li><a href="#">Navigation</a></li>
<li><a href="#">HTML/CSS</a></li>
<li><a href="#">Help</a></li>
</ul>

#jsddm
{ margin: 0; padding: 0}

#jsddm li
{   float: left;
list-style: none;
font: 12px Tahoma, Arial}

#jsddm li a
{   display: block;
background: #20548E;
padding: 5px 12px;
text-decoration: none;
border-right: 1px solid white;
width: 70px;
color: #EAFFED;
white-space: nowrap}

#jsddm li a:hover
{   background: #1A4473}

#jsddm li ul
{   margin: 0;
    padding: 0;
    position: absolute;
    visibility: hidden;
    border-top: 1px solid white;
    opacity: 0;
}

#jsddm > li:hover ul,
#jsddm > li:hover ul li:hover ul
{
    visibility: visible;
    opacity: 1;
  -webkit-transition: all .2s ease-in-out;
  -moz-transition: all .2s ease-in-out;
  -ms-transition: all .2s ease-in-out;
  -o-transition: all .2s ease-in-out;
  transition: all .2s ease-in-out;    
}

#jsddm ul {

-webkit-transition: all .5s ease-out .5s;
-moz-transition: all .5s ease-out .5s;
-ms-transition: all .5s ease-out .5s;
-o-transition: all 5s ease-out.5s;
transition: all .5s ease-out.5s;
}

#jsddm > li:hover ul li ul {
    visibility: hidden;
}

#jsddm li ul li
{   float: none;
    display: inline;
    position: relative;
}

#jsddm li ul li a
{   width: auto;
    background: #9F1B1B}

#jsddm li ul li a:hover
{   background: #7F1616} 
```

# text - 在 Canvas 上居中文本？

> ID：14882806
> 
> 赞同：7
> 
> 时间：2013-02-14T19:46:14.103
> 
> 标签：text, canvas, javafx-2

有人可以给我一个关于如何在 JavaFX 2 [Canvas](http://docs.oracle.com/javafx/2/api/javafx/scene/canvas/Canvas.html)上居中文本的示例吗？

[GraphicsContext](http://docs.oracle.com/javafx/2/api/javafx/scene/canvas/GraphicsContext.html)有一些函数，如 setTextAlign，但我不确定如何使用所有这些方法以及我真正需要哪些方法。我想将文本垂直和水平居中。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-14T20:17:45.927

1.  设置文本居中对齐。
2.  将文本基线设置为居中。
3.  在画布的中心绘制文本（将其放置在画布宽度和高度的一半处）。

这是一个示例：

```
import javafx.application.Application;
import static javafx.application.Application.launch;
import javafx.geometry.VPos;
import javafx.scene.*;
import javafx.scene.canvas.*;
import javafx.scene.layout.StackPane;
import javafx.scene.text.TextAlignment;
import javafx.stage.Stage;

public class TextCanvas extends Application {
    @Override public void start(Stage primaryStage) {
        Canvas canvas = new Canvas(175, 40);
        GraphicsContext gc = canvas.getGraphicsContext2D();
        gc.setTextAlign(TextAlignment.CENTER);
        gc.setTextBaseline(VPos.CENTER);
        gc.fillText(
            "Text centered on your Canvas", 
            Math.round(canvas.getWidth()  / 2), 
            Math.round(canvas.getHeight() / 2)
        );

        StackPane layout = new StackPane();
        layout.getChildren().addAll(canvas);

        primaryStage.setScene(new Scene(layout));
        primaryStage.show();
    }
    public static void main(String[] args) { launch(args); }
} 
```

![画布上居中的文本](../Images/fd0a877286d614d4c9b0ae98f3fb0678.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T19:55:02.350

你想用

```
 control.setAlignment(Pos.CENTER); and

  control.setStyle("-fx-alignment: CENTER;"); 
```

有关此操作的一些可下载示例代码，请参见[此处](http://docs.oracle.com/javafx/2/layout/size_align.htm)。

# ios - MKMapView 在 LocationManager 获得用户位置之前加载 - 无法将区域设置为以用户位置为中心

> ID：14882814
> 
> 赞同：2
> 
> 时间：2013-02-14T19:47:05.197
> 
> 标签：ios, mkmapview, cllocationmanager, userlocation, mkcoordinateregion

我有一个 iOS 应用程序，我在应用程序启动时加载 MKMapView。我想将“MKCoordinateRegion”的中心设置为用户纬度/经度。但是，CLLocation Manager 实例在 MKMapView 加载之前不会更新用户位置。

现在我正在将地图中心坐标硬编码到应用程序中。但我想知道是否有人可以提出更好的方法来处理这种情况。

我可以想到两种方法，但我不喜欢其中任何一种：

1) 使用 activityindicator 停止启动 MKMapView 2) 使用硬编码位置启动 MKMapview，然后一旦用户位置可用，就将 mapview 区域设置为以该位置为中心

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:49:58.903

当您进入后台或关闭应用程序时，存储最后一个已知的纬度/经度。
在开始中心地图视图到最后一个已知位置。
一旦位置管理器发送更新的位置，更新地图中心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:08:46.760

将 的`userTrackingMode`属性设置`mapview`为`MKUserTrackingModeFollow`。您不需要位置管理器来`mapView`为您做这件事。当您以后想要重新定位地图时，请将属性设置为`MKUserTrackingModeNone`，然后重新定位您的地图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:02:24.663

做苹果做的事。开始真的很远缩小，可能会在屏幕上显示“正在扫描位置”的消息，然后当位置信息可用时放大。

# concatenation - 如果 StringBuilder 的构造函数是用字符串字面量传递的，那么会创建多少个对象

> ID：14882815
> 
> 赞同：0
> 
> 时间：2013-02-14T19:47:09.313
> 
> 标签：concatenation, stringbuilder

**问题一：**

在这段代码中，是只创建了一个字符串对象，还是创建了一个字符串对象和 5 个字符串文字（`"abc"`, `"xyz"`, `"abcxyz"`, `"123"`, `"abcxyz123"`）？

```
StringBuilder s1 = new StringBuilder("abc"+"xyz"+"123"); 
```

**问题2：**

在另一种情况下，是否只创建了一个字符串对象？

```
 StringBuilder s2 = new StringBuilder();  
       s2.append("abc");  
       s2.append("xyz");  
       s2.append("123"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:06:00.717

由于字符串是不可变的，因此当您将`+`运算符与两个字符串一起使用时，您将创建一个带有串联的新字符串对象。[字符串池](http://en.wikipedia.org/wiki/String_interning)用作优化，因此如果它包含字符串，则返回引用而不是创建新引用。

[`intern()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#intern%28%29)如果 String 对象尚未包含该对象，该方法会将其添加到池中。**字符串文字总是 interned**，因此在这两个问题中，您都创建了相同数量的引用并将它们添加到字符串池（在构造函数中使用或作为参数使用）。

请注意，创建字符串对象会有所不同：当我们使用`s = new String("foo");`时，我们正在创建一个新引用，因此在这种情况下，字符串对象不会在字符串池中，直到您调用`s.intent()`.

# java - Google Guava 从开始目录开始迭代所有文件

> ID：14882820
> 
> 赞同：6
> 
> 时间：2013-02-14T19:47:35.150
> 
> 标签：java, file, guava

我在我的代码中使用 Google Guava。从一个目录开始，我想逐个获取所有文件（如果当前文件是一些特殊文件，我将在其中执行一些处理），最后我会将它们复制到另一个目录（某些目录除外。）

我知道 Guava 有一种复制方法，但是如何获取目录下的所有文件（如果起始目录下有一些目录，我也应该在它下面获取文件，如果其中一些目录下有任何目录我应该也得到它们）

**PS 1：**如果对复制文件有任何建议，欢迎您。

**PS 2：**我认为这次对话与我的问题有关：[http ://code.google.com/p/guava-libraries/issues/detail?id=578](http://code.google.com/p/guava-libraries/issues/detail?id=578)

**PS 3：**我在我的项目中使用 Java 6。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-04-07T08:08:27.337

从 Guava 15 开始，您可以使用[`Files.fileTreeTraverser()`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html#fileTreeTraverser%28%29).

用法很简单：

```
File rootDir = ...; //this is your root directory
for (File f : Files.fileTreeTraverser().preOrderTraversal(rootDir)) {
    // do whatever you need with the file/directory

    // if you need the relative path, with respect to rootDir
    Path relativePath = rootDir.toPath().getParent().relativize(f.toPath());
} 
```

正如您从[`TreeTraverser`的 javadoc](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/TreeTraverser.html)中所读到的，您可以在三种不同的迭代顺序之间进行选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:16:53.827

如果您有权访问 Java 7，请使用`walkFileTree`.`Files`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:47:49.347

*   通过 Guava 复制文件

    在 Guava 14.0 中可以找到一些[Files.copy](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html#copy%28java.io.File,%20java.io.File%29)重载方法，用于单文件复制。

*   行走文件

    正如一些人建议的那样，您可以使用递归调用。（`DirectoryScanner`你说的很好）

# android - support-screens android 标签的用途

> ID：14882823
> 
> 赞同：2
> 
> 时间：2013-02-14T19:47:55.600
> 
> 标签：android, android-manifest, android-screen-support

`supports-screens`当我不打算省略任何屏幕尺寸时，我想知道清单文件中是否需要该标签。换句话说，我希望我的应用程序可以在尽可能多的屏幕上运行。当然，我可以这样做：

```
<supports-screens
    android:smallScreens="true"
    android:normalScreens="true"
    android:largeScreens="true"
    android:xlargeScreens="true" /> 
```

但是有必要吗？默认情况下Android不会为我做这件事吗？

谢谢，伊戈尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:50:41.180

如果您不想排除任何内容，则无需添加。

# asp.net-mvc-2 - 在 GC 端口上使用 ActiveDirectyoryMembershipProvider 的 ldap 身份验证在 MVC2 应用程序中失败

> ID：14882824
> 
> 赞同：0
> 
> 时间：2013-02-14T19:47:55.363
> 
> 标签：asp.net-mvc-2, active-directory, activedirectorymembership

我正在使用 C# ASP.NET 开发一个 MVC2 应用程序。

在我的应用程序中，我使用 ActiveDirectoryMembershipProvider 进行用户身份验证。下面是我的 web.config 文件的片段。

如果我在连接字符串中使用全局编录端口 3268，则会收到错误“GC 端口上的 LDAP 连接不支持 Active Directory”。我对此错误消息进行了谷歌搜索，但无法找到合适的解决方案。许多人建议使用端口 389，有些人建议更改代码。但我希望能够使用 GC 端口让用户连接到不同的森林，因为它更干净。

一些观察：

*   相同的连接字符串（使用端口 3268）在我公司 i 的其他应用程序中运行良好。
*   当我将连接字符串更改为指向端口 389 时，它可以完美运行，即属于本地域的人能够登录。但是来自另一个域的人不能。
*   我在我的 AcconuntModel 和 AccountController 中放置了断点。连接字符串指向端口 3268，Membership.Provider 抛出“ConfigurationErrorsException”。

如果有人可以帮助我解决此问题，那将非常有帮助。

网络配置：

```
 <add name="ADConnectionString" connectionString="LDAP://myADServer.abc.ad:389/DC=abc,DC=ad" /> 

<membership defaultProvider="MyADMembershipProvider">
      <providers>
        <clear />
        <add connectionStringName="ADConnectionString" maxInvalidPasswordAttempts="1000" connectionUsername="ldapuser@abc.ad" connectionPassword="password" connectionProtection="None" enableSearchMethods="True" name="MyADMembershipProvider" type="System.Web.Security.ActiveDirectoryMembershipProvider,System.Web, Version=2.0.0.0,Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <add name="MySqlMembershipProvider" type="MySql.Web.Security.MySQLMembershipProvider,MySql.Web,Version=6.5.4.0,Culture=neutral,PublicKeyToken=c5687fc88969c44d" connectionStringName="MySqlMembershipConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="true" passwordFormat="Hashed" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" autogenerateschema="true" />
      </providers>
    </membership>

    <!-- Added for custom provider -->
    <roleManager enabled="true" cacheRolesInCookie="true" defaultProvider="DDMS_Custom_RoleProvider">
      <providers>
        <clear />
        <add applicationName="/" connectionStringName="ddms_dataEntities2" name="DDMS_Custom_RoleProvider" type="DDMS_sourcecode.Utilities.DDMS_Custom_RoleProvider, DDMS_sourcecode" />
        <add connectionStringName="ApplicationServices" applicationName="/" autogenerateschema="true" name="MySqlRoleProvider" type="MySql.Web.Security.MySQLRoleProvider,MySql.Web,Version=6.5.4.0,Culture=neutral,PublicKeyToken=c5687fc88969c44d" />
      </providers>
    </roleManager> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:48:11.023

如果你需要搜索的是全局目录，你为什么不这样尝试呢？

```
using (DirectoryEntry searchRoot = new DirectoryEntry("GC://DC=yourdomain,DC=com"))
using (DirectorySearcher ds = new DirectorySearcher(searchRoot))
{
    ds.Filter = "(sAMAccountName=userID1)";
    ds.SearchScope = SearchScope.Subtree;
    using (SearchResultCollection src = ds.FindAll())
    {
        foreach (SearchResult sr in src)
        {
            uxFred.Content = sr.Path;
        }
    }
} 
```

# facebook - Facebook Graph / Fql：获取所有图片

> ID：14882826
> 
> 赞同：4
> 
> 时间：2013-02-14T19:48:07.373
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我遇到了图形 API 的返回问题，我想知道是否有人知道为什么或如何解决它。

我需要下载给定用户的所有照片数据（朋友数据，而不是活动用户）。这是我尝试过的两件事。

```
FQL: "select pid from photo where subject=friend_uid"
Graph: "friend_uid/photos?fields=picture,created_time,tags.fields(name,id)&limit=1000" 
```

我有 friends_photos 和 user_photos 权限。

任何具有 > 1000 个标签的用户都将大幅减少结果数。例如，它只会返回大约 200 张左右的照片，这是不可接受的，我需要所有这些

使用 since/until（或 created_time < 或 > __）以及限制子句进行分块只会提高 FQL 的结果计数，但分块的数量使其效率非常低。

有任何想法吗？标签数据对我的目的也很重要。

**因此，我需要正确的查询或查询序列来使用 FQL 或 graph-api 获取给定 user_id 的所有照片的所有标签数据。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T23:37:52.520

我最近在 PHP 中创建了一个类似的项目（按顺序从你所有的 facebook 朋友中提取所有照片）。Facebook 的限制记录不充分，但我发现使用 Graph API，朋友被标记的照片是 400 张，朋友每次请求上传的照片是 5000 张。请注意，从 {user}/photos 拉取仅拉取他们标记的照片，而 {user}/photos/uploaded 仅拉取 {user} 上传的照片。我认为 400 张标记和 5000 张上传的照片足以满足我的情况。

如果确实需要额外的照片，则必须检查 /photos 请求为用户返回的照片数量，并检查它是否等于 400。如果是，则必须递归地转到下一页。

对于 /photos/uploaded 请求，Facebook 使用基于光标的分页（参见[本页](http://developers.facebook.com/docs/reference/api/pagination/)底部），这意味着仅当有更多值要返回时才会发送 pagination->next 和 pagination->prev 数据。这使得获取下一页变得相当容易（再次，您将不得不递归地执行此操作）。

# ios - 分配的对象不能在单独线程的循环中释放

> ID：14882828
> 
> 赞同：0
> 
> 时间：2013-02-14T19:48:16.047
> 
> 标签：ios, objective-c, memory-management, memory-leaks, nsthread

我有一个`NSThread`运行以下代码：

```
for (Experiment *exp in experiments) {
    ExperimentBlock *block = [[ExperimentBlock alloc] initWithFrame:CGRectMake(0, maxHeight, 310, 50)
                                                         experiment:exp
                                                             target:self
                                                             action:@selector(onExperimentButtonClicked:)];
    [scrollView addSubview:block];
    // block cannot be released for some inadequately explained reason
    maxHeight += 60;
} 
```

良好的内存管理实践期望我们释放我们分配、复制或新的任何对象。但是，当我的线程完成时，如果我已释放（或自动释放）已添加到 my 的块`UIScrollView`，则对象会在 my 中显示`UIScrollView`一秒钟，然后消失。

我应该如何释放内存而不丢失这些对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:57:11.087

您绝不能`addSubview:`在后台线程上修改视图（调用）。这就是为什么你会出现奇怪的行为。您必须调用`addSubview:`主线程。

这种类型的工作通常使用 GCD 或`NSOperationQueue`. 在大多数情况下，手动`NSThread`效率较低，并且更难以正确编码。您可以`addSubview:`像这样将呼叫移动到主队列：

```
dispatch_async(dispatch_get_main_queue(), ^{
  [self.scrollView addSubview:block];
  [block release];
}); 
```

到这里的调用`self`是故意的。它创建了一个临时保留循环，以确保在此代码运行之前我们不会被释放。

将此项目切换到 ARC 将简化此处的内存管理，建议使用。

# python - 按 ListProperty (NDB) 对查询进行排序

> ID：14882833
> 
> 赞同：3
> 
> 时间：2013-02-14T19:48:29.440
> 
> 标签：python, google-app-engine, sorting

如何按 ListProperty* 对查询进行排序？

该模型：

```
class Chapter(ndb.Model):
    title = ndb.StringProperty(required=True)
    version = ndb.IntegerProperty(repeated=True) 
```

“版本”存储的值如下：

```
1.1 -> [1,1]
1 -> [1]
2.1.1.1.1 -> [2,1,1,1,1]
1.2 -> [1,2]
2.1.2 -> [2,1,2] 
```

我想像这样订购它：

```
1
1.1
1.2
2.1.1.1.1
2.1.2 
```

*我使用 NDB，所以 ListProperty = ndb.IntegerProperty(repeated=True)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:25:00.197

不幸的是，这不是 listproperties 的工作方式。对于升序查询，使用的值将是列表中的最小值。您必须以不同的方式存储值（例如，作为字符串）才能执行您的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-18T17:08:46.477

天哪，我终于做到了。

```
newChaps = sorted(chaps, key=lambda obj: obj.version) 
```

如此简单……但找到它的时间却如此之多……

# c# - Guid 和 DropDownList 错误？

> ID：14882834
> 
> 赞同：0
> 
> 时间：2013-02-14T19:48:39.297
> 
> 标签：c#, webforms

我正在尝试在我的 asp.net 应用程序上修复黄色死亡页面当我加载它给我的页面时，asp.net 绑定到这个 ddl_username “Guid 应该包含 32 位数字和 4 个破折号（xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx）。” 我知道这是因为 -1 值可以帮助解决这个问题

```
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
    <style type="text/css">
        .style1
        {
            height: 24px;
        }
    </style>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <table class="ui-accordion">
        <tr>
            <td>
                <label>Tech User name:</label></td>
            <td>
                <asp:DropDownList ID="ddl_userNames" runat="server" 
                    DataSourceID="SqlDS_techNames" DataTextField="UserName" 
                    DataValueField="UserId" AppendDataBoundItems="True" AutoPostBack="True">
                    <asp:ListItem Value="-1">Select one</asp:ListItem>
                </asp:DropDownList>
                <asp:SqlDataSource ID="SqlDS_techNames" runat="server" 
                    ConnectionString="<%$ ConnectionStrings:Compudata_ProjectManagerConnection %>" 
                    SelectCommand="SELECT [UserId], [UserName] FROM [vw_aspnet_Users]">
                </asp:SqlDataSource>
            </td>
        </tr>
        <tr>
            <td>
               <label>Sesrch terms:</label> </td>
            <td>
                               <asp:DropDownList ID="ddl_SesrchTerms" runat="server" 
                >
                                   <asp:ListItem Value="-1">Select One</asp:ListItem>
                                   <asp:ListItem Value="1">Daily</asp:ListItem>
                                   <asp:ListItem Value="2">Weekly</asp:ListItem>
                                   <asp:ListItem Value="3">Monthly</asp:ListItem>
                               </asp:DropDownList></td>
        </tr>
        <tr>
            <td>
                <label>Date:</label></td>
            <td>
                <asp:TextBox ID="txtb_date" runat="server"></asp:TextBox>
            </td>
        </tr>
        <tr>
            <td class="style1">
                <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Button" />
            </td>
            <td class="style1">
                <asp:Label ID="lbl_msg" runat="server"></asp:Label>
            </td>
        </tr>
    </table>
    <br />
    <br />
    <br />

    <asp:Chart ID="Chart1" runat="server" 
        DataSourceID="SqlDS_Get_Individual_Tech_Service_Chart">
        <Series>
            <asp:Series Name="Series1" ChartType="Pie" XValueMember="billableTypeName" 
                YValueMembers="TotalTime">
            </asp:Series>
        </Series>
        <ChartAreas>
            <asp:ChartArea Name="ChartArea1">
            </asp:ChartArea>
        </ChartAreas>
    </asp:Chart>
    <asp:SqlDataSource ID="SqlDS_Get_Individual_Tech_Service_Chart" runat="server" 
        ConnectionString="<%$ ConnectionStrings:Compudata_ProjectManagerConnection %>" 
        SelectCommand="Get_Individual_Tech_Service_Chart" 
        SelectCommandType="StoredProcedure">
        <SelectParameters>
            <asp:ControlParameter ControlID="ddl_SesrchTerms" DbType="Int32" 
                Name="SearchTerms" PropertyName="SelectedValue" />
            <asp:ControlParameter ControlID="ddl_techNames" DbType="Guid" Name="TechID" 
                PropertyName="SelectedValue" />
            <asp:ControlParameter ControlID="txtb_date" DbType="DateTime" Name="Date" 
                PropertyName="Text" />
        </SelectParameters>
    </asp:SqlDataSource>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:10:37.823

您始终可以在 page_load 中添加额外的行以插入带有空 guid 的“Select One”

```
ddl_userNames.Items.Insert(0, new ListItem("Select one", Guid.Empty.ToString())); 
```

# backbone.js - Backbone/Require Application 中共享对象的最佳实践

> ID：14882836
> 
> 赞同：17
> 
> 时间：2013-02-14T19:48:46.870
> 
> 标签：backbone.js, requirejs, amd

我已经开发 Backbone 应用程序有一段时间了，并且刚刚开始学习将 Backbone 与 Require.js 一起使用。

在我正在重构的主干应用程序中，我定义了一个这样的命名空间：`App.model.repo`. 该模型在不同的视图中反复使用。我对一些集合做同样的事情，例如，`App.collection.files`. 这些模型和集合与初始索引文件请求一起引导。

我确实找到[了这个示例](https://stackoverflow.com/a/10288587/158651)，这看起来是获取引导数据的好方法。但是，我正在努力寻找在视图之间重用/共享这些模型和集合的最佳方法。

我能想到三种可能的解决方案。哪个最好，为什么？还是我完全错过了另一种解决方案？

**解决方案 1**

在索引中定义这些公共模块和集合（当它们被引导时），然后将它们作为选项（的`initialize`）传递给每个 Backbone 视图。

```
define(['jquery', 'underscore', 'backbone', 'handlebars', 'text!templates/NavBar.html'], 
    function($, _, Backbone, Handlebars, template){     
        return Backbone.View.extend({
            template: Handlebars.compile(template),
            initialize: function(options){
                this.repoModel = options.repoModel; // common model passed in
            }
        });
    }
); 
```

就分离而言，这些看起来很干净，但很快就会变得时髦，到处都是大量的东西。

**解决方案 2**

定义一个`globals`模块，并为其添加常用的模型和集合。

```
// models/Repo.js
define(['backbone'],
    function(Backbone){
        return Backbone.Model.extend({
            idAttribute: 'repo_id'
        });
    }
);

// globals.js (within index.php, for bootstrapping data)
define(['underscore', 'models/Repo'], 
    function(_, RepoModel){     
        var globals = {};

        globals.repoModel = new Repo(<?php echo json_encode($repo); ?>);

        return globals
    }
);

define(['jquery', 'underscore', 'backbone', 'handlebars', 'text!templates/NavBar.html', 'globals'], 
    function($, _, Backbone, Handlebars, template, globals){
        var repoModel = globals.repoModel; // repoModel from globals

        return Backbone.View.extend({
            template: Handlebars.compile(template),
            initialize: function(options){

            }
        });
    }
); 
```

这个解决方案是否打败了 AMD 的全部观点？

**解决方案 3**

让一些模型和集合返回一个实例，而不是一个构造函数（有效地使它们成为单例）。

```
// models/repo.js
define(['backbone'],
    function(Backbone){
        // return instance
        return new Backbone.Model.extend({
            idAttribute: 'repo_id'
        });
    }
);

// Included in index.php for bootstrapping data
require(['jquery', 'backbone', 'models/repo', 'routers/Application'],
    function($, Backbone, repoModel, ApplicationRouter){
        repoModel.set(<?php echo json_encode($repo); ?>);

        new ApplicationRouter({el: $('.site-container')});
        Backbone.history.start();
    }
);

define(['jquery', 'underscore', 'backbone', 'handlebars', 'text!templates/NavBar.html', 'models/repo'], 
    function($, _, Backbone, Handlebars, template, repoModel){
        // repoModel has values set by index.php

        return Backbone.View.extend({
            template: Handlebars.compile(template),
            initialize: function(options){

            }
        });
    }
); 
```

我担心这会让人对什么是构造函数和什么是实例感到真正的困惑。

**结尾**

如果你读到这里，你太棒了！感谢您抽出宝贵的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:01:31.893

就我而言，我更喜欢**选项 3**。不过，为了防止混淆，我将每个单例实例都放在了它们自己的名为`instances`. 另外，我倾向于将 与`model/collection`模块`instance`分开。

然后，我只是打电话给他们：

```
define([
  "instance/photos"
], function( photos ) { /* do stuff */ }); 
```

我更喜欢这个选项，因为每个模块都被迫定义其依赖项（例如，通过命名空间不是这种情况）。解决方案 2 可以完成这项工作，但如果我使用的是 AMD，我希望我的模块尽可能小——再加上保持它们小，以便更容易进行单元测试。

最后，关于单元测试，我可以在单元测试中重新定义实例以使用模拟数据。所以，当然，选项3。

您可以在我正在开发 ATM 的开源应用程序上看到此模式的示例：[https ://github.com/iplanwebsites/newtab-bookmarks/tree/master/app](https://github.com/iplanwebsites/newtab-bookmarks/tree/master/app)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:02:16.507

我会看看这个示例回购[https://github.com/tbranyen/github-viewer](https://github.com/tbranyen/github-viewer)

它是主干样板的工作示例（[https://github.com/tbranyen/backbone-boilerplate](https://github.com/tbranyen/backbone-boilerplate)）

Backbone Boiler plate 做了很多不必要的麻烦，但它真正有用的是它为开发复杂的 javascript 应用程序的常见模式提供了一些明确的方向。

我会试着在今天晚些时候回来更具体地回答你的问题（如果有人没有打败我:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T21:19:33.020

我更喜欢解决方案 1。通常最好[避免](http://molecularmusings.wordpress.com/2011/11/11/singleton-is-an-anti-pattern/) [使用](http://tech.puredanger.com/2007/07/03/pattern-hate-singleton/) [singletons](http://blogs.msdn.com/b/scottdensmore/archive/2004/05/25/140827.aspx)，并且使用 globals 也是要避免的，特别是因为您使用的是 RequireJS。

以下是我能想到的解决方案 1 的一些优点：

它使视图代码更具可读性。第一次看这个模块的人可以通过查看`initialize`它使用的模型立即看出它的功能。如果您使用全局变量，则可能会在文件中的 500 行访问某些内容。

它使为视图代码编写单元测试变得更加容易。因为您可能会在测试中传递假模型。

# ios - UICollectionView 上的装饰视图在每次插入时都会重复

> ID：14882837
> 
> 赞同：2
> 
> 时间：2013-02-14T19:48:59.060
> 
> 标签：ios, uicollectionview

我正在尝试使用 UICollectionView 创建一个书架，这与 iBooks 应用程序不同。

它工作得很好，但是每当我*将*一个新项目插入视图（通过调用`insertItemsAtIndexPaths:`）时，该项目被正确插入，但是我的货架项目（它们是装饰视图，的子类`UICollectionReusableView`）越来越暗，显然被一遍又一遍地绘制. 但是，如果调用一切`reloadData`都`UICollectionView`正确。

这是我在派生`UICollectionViewFlowLayout`类中所做的：

*   `- (void)prepareLayout` 计算装饰视图的框架

*   `- (NSArray *)layoutAttributesForElementsInRect: Adding UICollectionViewLayoutAttributes`对于与矩形相交的所有货架

*   `- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)` 将我的项目属性调整`zIndex`为 1

*   `- (UICollectionViewLayoutAttributes *)layoutAttributesForDecorationViewOfKind:(NSString *) atIndexPath:(NSIndexPath *)` 将我的货架属性调整`zIndex`为 0

而已。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T01:40:48.670

听起来像（另一个）带有装饰视图的错误。我已经提交了一个[错误](http://openradar.appspot.com/radar?id=2662407)，即当设备旋转时它们会重复。

# c++ - 用于绑定的友元运算符重载的函数指针

> ID：14882845
> 
> 赞同：0
> 
> 时间：2013-02-14T19:49:30.947
> 
> 标签：c++, c++11, operator-overloading, bind, function-pointers

最终目标如下：我希望能够`for_each`与`operator<<`. 我意识到我可以使用`ostream_iterator`，但我想看看没有它是否可能。

一些示例代码，以便您了解我想要做什么：

```
#include <algorithm>
#include <iostream>
#include <functional>
#include <vector>

using std::bind;
using std::ref;
using std::placeholders::_1;
using std::for_each;
using std::ostream;
using std::cout;
using std::endl;
using std::vector;

class C {
    private:
        int x;
    public:
        C() : x(0) { }
        C(int x) : x(x) { }

    friend ostream& operator<<(ostream& out, const C& c);
};

ostream& operator<<(ostream& out, const C& c) {
    return out << c.x << endl;
}

int main() {
    vector<C> v;
    v.push_back(C(1));
    v.push_back(C());

    for_each(v.begin(), v.end(), bind(&ostream::operator<<, ref(cout), _1));

    return 0;
} 
```

我没有成功尝试的一件事（上图）：

`bind(static_cast<ostream& (ostream::*)(ostream&, const C&)>(&ostream::operator<<), ref(cout), _1)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:12:06.107

您可以只使用 lambda，如：

```
for_each(v.begin(), v.end(), [](C const& c){ cout << c; }); 
```

`for_each`就个人而言，当我的意图是访问序列中的每个元素时，我更喜欢使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:18:10.837

您指定错误`operator<<`；你已经指定`ostream::operator<<`了，但你`operator<<`是免费的，即`::operator<<`。

这适用于您当前的程序：

```
for_each(v.begin(), v.end(), bind(&::operator<<, ref(cout), _1)); 
```

但是，如果您添加更多 free `operator<<`s，那么它将再次失败，因为`bind`无法确定`operator<<`是什么意思。在这种情况下，您必须通过显式特化来指定：

```
for_each(v.begin(), v.end(), bind<ostream&(*)(ostream&, const C&)>(&::operator<<, ref(cout), _1)); 
```

等效地，您可以使用`static_cast<ostream&(*)(ostream&, const C&)>(&::operator<<)`.

问题是`<<`in`std::cout << c`既可以是自由运算符也可以是成员运算符，没有办法先验地知道哪个。 `ostream_iterator`通过生成允许编译器决定如何评估表达式的代码来工作；同样，如果您使用 lambda 或仅使用范围 for 循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T11:08:34.330

这里有什么问题吗？

```
for (auto c :v) cout<<c; 
```

或在这里：

```
for (const auto& c :v) cout<<c; 
```

或在这里：

```
for (C const& c :v) cout<<c; 
```

# mysql - 选择 max() 和其他字段

> ID：14882847
> 
> 赞同：1
> 
> 时间：2013-02-14T19:49:32.383
> 
> 标签：mysql

我们有一张桌子：

```
create table ducks (id int(8) primary key not null auto_increment,
                    name varchar(255),
                    car varchar(255), 
                    money int(8)
                   );
insert into ducks set name='donald', car='none', money=10;
insert into ducks set name='scrudge', car='bip', money=10000;
insert into ducks set name='mac', car='bip', money=1000;
insert into ducks set name='joe', car='boo', money=2000000; 
```

因此，对此进行分析后，我发现我们对以下请求的查询速度很慢：

```
select name,money from ducks where car='bip' order by money DESC LIMIT 1; 
```

因为表很大，排序只是为了得到一条记录很长

我发现以下工作更快：

```
select distinct name,money from ducks where money=(select max(money) from ducks where car='bip')  LIMIT 1; 
```

但仍然不确定，因为它是子选择。

解决这个问题的常用方法是什么？

[http://sqlfiddle.com/#!2/d2b7ed/6](http://sqlfiddle.com/#!2/d2b7ed/6)

**更新**它变成了实际上我们的任务不是搜索同一辆车，而是搜索最富有的鸭子，它的价格低于 100000 美元

[http://sqlfiddle.com/#!2/d2b7ed/21](http://sqlfiddle.com/#!2/d2b7ed/21)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:15:59.900

警惕子查询是明智的；特别是在 MySQL 中。

以下查询使用自排除连接，并且在基本测试中执行三者中最好的。您的第一个解决方案很好，但正如您所说的那样慢。它也不符合 ANSI，但这对您来说可能无关紧要。您的第二个解决方案也很好，但 MySQL 没有像希望的那样处理子查询；至少在传统上。

```
select 
  d.name, d.money
from 
  ducks d
  left join ducks d2 
  on d2.car = d.car 
  and d2.money > d.money
where 
  d.car = 'bip'
  and d2.id is null 
```

在这里实现：[http ://sqlfiddle.com/#!2/27711/20](http://sqlfiddle.com/#!2/27711/20)

* * *

编辑：球门柱以某种方式移动。该死的那些球门柱。这是新问题的自排除连接解决方​​案：[http ://sqlfiddle.com/#!2/7146d/13](http://sqlfiddle.com/#!2/7146d/13)

```
select 
  d.name, d.money 
from 
  ducks d
  left join ducks d2 
  on d2.money > d.money
  and d2.money < 100000
where 
  d.money < 100000 
  and d2.id is null; 
```

# c# - Mocking 的移动方法？

> ID：14882849
> 
> 赞同：2
> 
> 时间：2013-02-14T19:49:41.513
> 
> 标签：c#, unit-testing, mocking

我有单元测试调用`ApplicationShouldBeInstalled(app)`以确保它正常工作。下面的实际生产代码也调用了该方法，因此它不会意外安装应用程序。但是，没有什么能阻止开发人员删除完成检查的那行代码。而且我的单元测试不会捕捉到这一点，因为测试是在测试`ApplicationShouldBeInstalled(app)`方法，而不是`InstallApplications()`方法。

我无法`InstallApplications()`从我的测试代码中调用，因为它会尝试安装应用程序。`InstallApplication(app)`是同一个类中的一个方法，而不是另一个我可以用接口模拟它的类。有没有办法确保 InstallApplications() 始终执行该检查？我想我可以转移`ApplicationShouldBeInstalled(app)`到另一个班级并模拟它，但是我只是为了测试/模拟而移动代码。有没有更好的办法？

```
public void InstallApplications()
{
    foreach (App app in this._apps)
    {
        if (!ApplicationShouldBeInstalled(app)) { continue; }

        InstallApplication(app);
    }                       
} 
```

模拟选项看起来像这样。将`Container`在实时运行时返回真实的实现，并在运行测试时返回模拟。

```
public void InstallApplications()
{
    foreach (App app in this._apps)
    {
        if (!ApplicationShouldBeInstalled(app)) { continue; }

        Container.Resolve<IInstaller>().InstallApplication(app);
    }                       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T19:57:52.020

是的，从处理安装的代码中删除控制是否应安装应用程序的策略的代码。这将允许您单独测试两段代码，并确信每段代码都在执行您的要求。我什至会在这里有 3 个合作者。控制循环的代码，控制验证策略的代码，最后是执行安装的代码。三件套，可独立测试，更容易验证。

```
foreach (var app in this._apps)
{
     if (!applicationInstallationPolicyProvider.CanInstall(app)) // can be mocked away
     {
          continue;
     }

     applicationInstaller.Install(app); // can also be mocked away
} 
```

我认为你的关键是当你在问题中说“你不能在测试中运行安装代码”时。但对您来说，验证循环是否*会*在需要时调用安装代码应该很重要。无论您是否达到我可能喜欢的程度，这应该已经足以成为尝试隔离它的动力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T19:58:44.310

当您将其提取到接口时，您并没有真正删除属于该类的代码。您需要该类来实现成员。使用接口的一个主要好处是它允许您模拟它们，这样您就不会实际更改功能。你模拟接口然后你验证一个特定的方法实际上正在做你期望它做的事情。

On a side note it also allows you to use dependency injection so that your not creating instances of objects in memory constantly.

# php - PHP选择选项多重查询

> ID：14882851
> 
> 赞同：0
> 
> 时间：2013-02-14T19:49:41.540
> 
> 标签：php, select, option

我创建了一个包含多个复选框和一个包含所有 50 个状态的多个下拉列表的表单。我想从下拉表单中选择多个复选框和多个状态。我的问题当然是我......
所以当我查询我需要的信息时，它会出现空白。我可能会以错误的方式处理这一切。

```
<form name="search_form" method="post" action="event_list">
  <table>
    <tr>
      <td>Venue</td>
      <td><input type="checkbox" name="AAC" action="" value="AAC"/>
        <label >AAC</label>
        <br />
        <input type="checkbox" name="AKC" action="" value="AKC"/>
        <label >AKC</label>
        <br />
        <input type="checkbox" name="ASCA" action="" value="ASCA"/>
        <label >ASCA</label>
        <br />
        <input type="checkbox" name="CKE" action="" value="CKE"/>
        <label >CKE</label>
        <br />
        <input type="checkbox" name="CPE" action="" value="CPE"/>
        <label >CPE</label>
        <br />
        <input type="checkbox" name="DOCNA" action="" value="DOCNA"/>
        <label >DOCNA</label>
        <br />
        <input type="checkbox" name="NADAC" action="" value="NADAC"/>
        <label >NADAC</label>
        <br />
        <input type="checkbox" name="TDAA" action="" value="TDAA"/>
        <label >TDAA</label>
        <br />
        <input type="checkbox" name="UKC" action="" value="UKC"/>
        <label >UKC</label>
        <br />
        <input type="checkbox" name="UKI" action="" value="UKI"/>
        <label >UKI</label>
        <br />
        <input type="checkbox" name="USDAA" action="" value="USDAA"/>
        <label >USDAA</label>
        <br /></td>
    </tr>
    <tr>
      <td style="text-align: left;">State:</td>
      <td style="text-align: left;"><select name="state" id="state"  multiple="multiple" size="3" onchange="setCities();">
          <option value="Alabama">Alabama</option>
          <option value="Texas">Texas</option>
        </select></td>
    </tr>

      <td align="right"><input type="submit" name="search" value="Submit"></td>
    </tr>
  </table>
</form>

 <?php
  $sql=" SELECT * FROM venue_event ";

  if (isset($_POST['search']) && !empty($_POST['search'])){
 $search_term = mysql_real_escape_string($_POST['AAC']);
 $search_term2 = mysql_real_escape_string($_POST['state']);
 $search_term3 = mysql_real_escape_string($_POST['NADAC']);
 $search_term4 = mysql_real_escape_string($_POST['AKC']);
 $search_term5 = mysql_real_escape_string($_POST['ASCA']);
 $search_term6 = mysql_real_escape_string($_POST['CKE']);
 $search_term7 = mysql_real_escape_string($_POST['CPE']);
 $search_term8 = mysql_real_escape_string($_POST['TDAA']);
 $search_term9 = mysql_real_escape_string($_POST['UKC']);
 $search_term10 = mysql_real_escape_string($_POST['UKI']);
 $search_term11 = mysql_real_escape_string($_POST['USDAA']);

 $sql .= "WHERE venue = '{$search_term}' ";
 $sql .= "OR venue = '{$search_term3}' ";
 $sql .= "OR venue = '{$search_term4}' ";
 $sql .= "OR venue = '{$search_term5}' ";
 $sql .= "OR venue = '{$search_term6}' ";
 $sql .= "OR venue = '{$search_term7}' ";
 $sql .= "OR venue = '{$search_term8}' ";
 $sql .= "OR venue = '{$search_term9}' ";
 $sql .= "OR venue = '{$search_term10}' ";
 $sql .= "OR venue = '{$search_term11}' ";
 $sql .= "AND state = '{$search_term2}'"; //if I leave this out it 
     works with checkbox
 $sql .= "ORDER BY startdate ASC";

$result=mysql_query($sql) or die(mysql_error());
    }else{
    header('Location: /wordpress/venue_events'); exit();
    }
    ?>

    <?php

    echo "<table>
    <tr>
    <th>Club Host</th>
    <th>Venue</th>
    <th>Event Location</th>
    <th>Event Start date</th>
    <th>Event End Date</th>
    <th>Event Premium</th>
    </tr>";

    while($row = mysql_fetch_array($result))
    {
    echo "<tr>";
    echo '<td><a href="'.$row['user_url'].'" target="new" >'.$row['clubhost'].'
    </a> </td>';
    echo "<td>" . $row['venue'] . "</td>";
    echo "<td>" . $row['city'] ." ". $row['state'] ."</td>";
    echo "<td>" . $row['startdate'] . "</td>";
    echo "<td>" . $row['enddate'] . "</td>";
    echo  '<td><a href="../download.php?f='.$row['file_name'].'" >Download  Premium</a></td>';
    echo "</tr>";
    }
    echo "</table>";
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T19:59:34.763

您应该尝试用“info[]”替换每个名称，但保留您拥有的值。这是一个示例代码：

```
<form action="test.php" method="post">
<input type="checkbox" name="check_list[]" value="value 1">
<input type="submit" />
</form>
<?php
if(!empty($_POST['check_list'])) {
    foreach($_POST['check_list'] as $check) {
            echo $check; //echoes the value set in the HTML form for each checked checkbox.
                         //so, if I were to check 1, 3, and 5 it would echo value 1, value 3, value 5.
                         //in your case, it would echo whatever $row['Report ID'] is equivalent to.
    }
}
?> 
```

# ssis - 替换 SSIS 中的单引号

> ID：14882852
> 
> 赞同：0
> 
> 时间：2013-02-14T19:49:49.770
> 
> 标签：ssis

在 SSIS 中，我有一个电子邮件地址存储在一个变量中。电子邮件地址中的人名有一个单引号，这使 sql server 感到困惑。

诸如此类的东西

```
 Select field1, field2, from mytable where cust_emlad_tx = ? 
```

cust_emlad_tx 包含一个名称，例如 Jim.O'Dowell@something.com

我怎么能用两个单引号替换它，以便 sql server 处理它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:48:06.490

[可以帮助您使用单引号的东西](https://stackoverflow.com/questions/1440733/replace-single-quote-in-sql-server)。一般的做法是将单引号替换为 2 个单引号，这样在处理字符串时不会混淆 SQL Server。

# javascript - 模板指令调用另一个指令

> ID：14882853
> 
> 赞同：1
> 
> 时间：2013-02-14T19:49:51.280
> 
> 标签：javascript, angularjs, d3.js, angularjs-directive

我正在开发一个使用 angular.js 和 d3.js 的多数据应用程序。我很难将 <svg> 包含在我的范围内。

现在发生的是，在 ngRepeat 执行它的方法之前，正在加载指令 ngTests。

我把小提琴放在这里，所以你们可以有一个更好的主意。

[jsfiddle](http://jsfiddle.net/marceloduende/qrudH/)

```
<ng-chart></ng-chart> 
```

**PS**：我可以在我的 ngTests 指令中获取 td id，但它根本不会更新`<td ng-tests id="histogram{{$index}}"`。

如果我将此行更改为`<td ng-tests id="histogram">`，请在我的指令中使用 histogram 作为 ID 并将我的 ngTests 指令更改为只读“#histogram”，它会在我的 ngRepeat 的第一个表上创建我的 svg 6 次，这不是我期望的结果。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T09:29:22.040

做两件事。在您的 ngChart 指令中，您指定了 index 属性，`index="index"`但它必须是`index="{{$index}}"`. 然后，要从另一个指令中读取属性值，而不是像`attrs.index`您那样直接访问属性，应该使用`attrs.$observe`更多类似以下内容：

```
 attrs.$observe('index', function(observedIndex) {
        console.log('observedIndex:', observedIndex);
    }); 
```

这样，当索引更改时（例如，通过另一个指令），您会收到通知并可以更新元素的文本。我把小提琴分叉了，让它在[这里](http://jsfiddle.net/activescott/sZqhc/)工作。

# c# - 让 C# 将默认值插入 SQL Server

> ID：14882857
> 
> 赞同：4
> 
> 时间：2013-02-14T19:50:04.883
> 
> 标签：c#, sql-server, dbnull, executenonquery, default-constraint

如何将`INSERT`值放入存储在 SQL Server 中`string[]`的值，以便忽略某些值而将存储在 SQL Server 中的值作为表上的默认约束？我需要传递什么（例如 NULL 或其他）才能使用这些默认值？

目前，我在我的代码中添加了所有默认值，并且它变得越来越庞大。

下面是我的代码：

```
if (value == "") value = "0";

string insert = "INSERT INTO " + table + " (" + columns + ") VALUES (" + atColumns + ")";

using (SqlConnection connect = new SqlConnection(connection))
{                               
    using (SqlCommand command = new SqlCommand(insert, connect))
    {
        //adds values to corresponding parameters
        for (int i = 0; i < table_cols.Length; i++)
        {
            command.Parameters.AddWithValue("@" + table_cols[i], table_vals[i]);
        }

        foreach (SqlParameter Parameter in command.Parameters)
        {
            if (Convert.ToString(Parameter.Value) == "")
            {
                Parameter.Value = DBNull.Value;
            }
        }

        connect.Open();
        command.ExecuteNonQuery();
        response = "Success";
        return response; 
```

如果一个特定`Parameter.Value`的不是 null 并且 SQL Server 设置了默认值，则此代码不适用于 null。

在 SQL Server 中，这是通过省略插入语句中的值来处理的（这种省略会触发插入表的默认值，而提供 null 会产生错误）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:20:59.823

如果您希望 SQL Server 对列使用默认值约束，则不要将该列作为插入参数的一部分。

例子：

```
--From SQL Server
CREATE TABLE Orders
(
     Id INT IDENTITY PRIMARY KEY
    ,Amount INT NOT NULL
    ,Cost MONEY NOT NULL
    ,SaleDate DATE NOT NULL DEFAULT GETUTCDATE()
);

//From C#
public int Insert(decimal cost, int amount)
{
    using (var connection = new SqlConnection(connectionString))
    {
        var command = connection.CreateCommand();
        //Don't specify the SaleDate and it will insert the current time
        command.CommandText = "INSERT INTO Orders(Amount, Cost) VALUES(@Amount, @Cost); SELECT SCOPE_IDENTITY();";
        command.Parameters.AddWithValue("@Amount", amount);
        command.Parameters.AddWithValue("@Cost", cost);

        using(var reader = command.ExecuteReader())
        {
            if(reader.Read())
                return Convert.ToInt32(reader[0]);
        }
    }

    return 0;
} 
```

如果您想在 C# 代码中使用参数列表，则只需将参数名称与其值分组，如果值为 null 并且具有默认值，则跳过它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T19:57:52.287

传入 NULL 告诉 SQL 您希望该列中的 NULL 覆盖默认值。如果你想在关键字 DEFAULT 中传递一些东西。我写了一篇文章，[“keyword DEFAULT”](http://sqlstudies.com/2012/08/20/23/)，关于用法：

> DEFAULT 关键字导致将默认值（来自约束）插入到列中。

请记住，当您传入 DEFAULT 时，不要在其周围加上引号。这使它成为字符串 DEFAULT 而不是关键字 DEFAULT。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T19:55:17.650

我能想到的唯一其他方法是基于您的方法的触发器（并且您最好在那时对其进行编码）。

但是，如果您更改使用存储过程的方法，您可以在 SQL 中本地处理您的值，否则您将无法将其编码到您的应用程序中......我是否可以推荐三元语句作为您的示例：[http://msdn。 microsoft.com/en-us/library/ty67wk28%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.80%29.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T19:57:07.850

如果您在列列表中包含一列，它会尝试插入您给它的值。它不会假设这`NULL`意味着“只插入默认值”。

如果您不想在该列中插入值，请不要将其包含在列列表（或值列表，显然）中。

虽然循环遍历表列并且不知道列名、类型等似乎更有效。从长远来看，您最好明确处理每一列，以便您可以选择是否使用默认值，验证价值等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T18:18:40.933

我实际上使用该`INFORMATION_SCHEMA.COLUMNS`表从 SQL Server 中拉回所有列默认值。然后我只是将默认值组织成 a`string[]`并循环通过它来插入默认值而不是空值（一些默认值是空值）。

# windows-7 - C++ Builder 2009 - i18n - 快速报告异常 - 未找到类 TQRPDFFilter - 更改格式时

> ID：14882858
> 
> 赞同：0
> 
> 时间：2013-02-14T19:50:06.097
> 
> 标签：windows-7, internationalization, c++builder

使用 Win7、C++ Builder 2009 我有一个项目，当我的地区和语言格式设置为“英语（美国）”时，我可以毫无问题地编译和运行该项目。

当我将格式更改为“意大利语（意大利）”时，我的程序编译然后我得到一个异常“Project .exe 引发异常类 EClassNotFound 并带有消息'Class TQRPDFFilter not found'”。

程序或路径中没有其他任何变化，只是系统发生了变化，我得到了这个异常。我检查了包含路径和库路径，它们设置正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:28:21.460

我问这个问题已经有一段时间了。我正在跟进，仅供参考。我相信这个问题是基于我们项目使用的导入路径。我们有一组在某些项目之间共享的“通用”代码。公共源引用了特定项目没有的 TQRPDFFilter。通过更改路径顺序，将通用放在最低优先级，我解决了我的问题。这并不能回答为什么它用不同的语言爆炸的问题，但如果他们遇到类似的设置，可能会给其他人一些关于如何克服它的见解。

# mysql - MySQL 中其他等效项时的例外情况

> ID：14882859
> 
> 赞同：2
> 
> 时间：2013-02-14T19:50:13.680
> 
> 标签：mysql, oracle, triggers

我正在尝试将 Oracle 触发器移植到 MySQL。触发器中有一个`EXCEPTION WHEN OTHERS`语句，虽然我找到了其他所有内容的等效语句，但我找不到这个。触发器类似于：

```
IF (yada yada)
    THEN
        BEGIN
            SELECT a
            INTO generic_variable1
            FROM table
            WHERE condition;
            SET generic_variable2 = value1;
     EXCEPTION WHEN OTHERS --this part needs to be replaced by valid MySQL syntax
        SET generic_variable2 = value2;
  END;
END IF; 
```

如何将该部分转换为 MySQL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T19:58:32.160

您应该了解，与 Oracle 相比，MySQL 的存储过程/触发器语言非常有限。在移植到 MySQL 时，许多 Oracle 用户一遍又一遍地说，“我不敢相信 MySQL 不能做 X！！！！”

最接近 EXCEPTION WHEN OTHERS 可能是 DECLARE CONTINUE HANDLER。

示例（未测试）：

```
DECLARE CONTINUE HANDLER FOR SQLEXCEPTION SET @generic_variable2 = 1; 
```

但是你会在可能抛出异常的代码块*之前*声明，而不是之后。

有关完整文档，请参阅[http://dev.mysql.com/doc/refman/5.5/en/declare-handler.html](http://dev.mysql.com/doc/refman/5.5/en/declare-handler.html)。

# ruby-on-rails - 如何击中放置路线

> ID：14882861
> 
> 赞同：0
> 
> 时间：2013-02-14T19:50:23.643
> 
> 标签：ruby-on-rails, routes

我在一个名为“importdata”的其他restfull控制器中有一个额外的方法。因为我实际上是在更改数据（在数据库中导入 csv），所以我知道它应该是一个 put 路由而不是 get。

最初我有

```
resource data_set do
  put 'importdata', on: :method
end 
```

我也尝试过的是：

```
put 'data_sets/:id/importdata', "data_sets#importdata' 
```

rake routes 在这两种情况下都显示了我想要的路线。

当我在控制器中的（第一个示例）路由上使用该方法时，我所做的是

```
redirect_to import_data_sets_path id: dataset.id 
```

第二个例子：

```
redirect_to controller: "data_sets", action: "importdata", id: dataset.id 
```

我在这两种情况下得到的信息是：

```
No route matches [GET] "/data_sets/28/importdata" 
```

这是正确的，因为它是一个放置路线。我让它工作的唯一方法是改变 put 以获得：

```
get 'data_sets/:id/importdata', "data_sets#importdata' 
```

我怎样才能让它在 put 路线上工作？它应该首先是一条放置路线吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:08:48.483

简而言之，您不能“升级”用户发出的 HTTP 请求。重定向仅适用于 GET。如果用户正在更改某些内容，请通过表单执行此操作，并在您修改现有资源时确保它是 PUT 请求。

如果 PUT 是有条件的，则有几个选项，要么弄清楚如何在 UI 中解决这个问题，使用 HTTP 客户端发出 PUT（这对本地调用没有意义），要么在其他一些地方提取资源的编辑一种类并在控制器中使用它。

然而，即使编辑是可选的，让用户首先触发 PUT 更有意义。

希望有帮助。

# c++ - Boost::signals2 - 用槽解构对象

> ID：14882867
> 
> 赞同：3
> 
> 时间：2013-02-14T19:50:43.370
> 
> 标签：c++, boost, signals, boost-signals, boost-signals2

考虑一下：

```
#include <boost/signals2.hpp>
#include <iostream>

struct object_with_slot
{
void operator()()
{
   std::cout << "Slot called!" << std::endl;
   member = 50500;
}
int member;
};

int main()
{
boost::signals2::signal<void ()> sig;

object_with_slot * ptr = new object_with_slot;
sig.connect(*ptr);

delete ptr;

sig();
} 
```

输出是“插槽调用！” 并且没有崩溃或任何事情。这就是为什么我有几个问题：

1）为什么没有崩溃？

2）为什么即使槽函数将某些东西分配给不存在的对象，也没有崩溃？

3）如何使信号自动跟踪其插槽的生命周期？我的意思是当插槽被破坏时，它会断开连接。

第 3 个问题是最重要的，因为我需要实现观察者模式，并且观察者（插槽）的生命周期通常不会是静态的（在应用程序运行的整个时间内）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:20:19.410

1）你很幸运。如果没有，您将遇到分段错误。

2) 内存没有以任何方式被覆盖。

3）您可以使用 slot::track 在被跟踪对象被删除时自动断开连接。Boost.Signals2 可以跟踪由 boost::shared_ptr 管理的对象。

```
#include <boost/signals2.hpp>
#include <boost/shared_ptr.hpp>

struct object_with_slot
{
    void operator()()
    {
       std::cout << "Slot called!" << std::endl;
       member = 50500;
    }
    int member;
};

//
int main()
{
    typedef boost::signals2::signal<void ()> sig_type;
    sig_type sig;

    {
        boost::shared_ptr<object_with_slot> ptr(new object_with_slot);
        sig.connect(sig_type::slot_type(*ptr).track(ptr));

        // 'object_with_slot' managed by ptr is destroyed
    }

    sig(); // 'object_with_slot' not called here.

    return 0;
} 
```

**更新：**
添加了跟踪 std::shared_ptr 和 std::weak_ptr 对象的代码：

```
#include <memory>
#include <boost/signals2.hpp>

// added specializations for std::weak_ptr and std::shared_ptr
namespace boost
{
  namespace signals2
  {
    template<typename T> struct weak_ptr_traits<std::weak_ptr<T> >
    {
      typedef std::shared_ptr<T> shared_type;
    };

    template<typename T> struct shared_ptr_traits<std::shared_ptr<T> >
    {
      typedef std::weak_ptr<T> weak_type;
    };
  }
}

struct object_with_slot
{
    void operator()()
    {
       std::cout << "Slot called!" << std::endl;
       member = 50500;
    }
    int member;
};

//
int main()
{
    typedef boost::signals2::signal<void ()> sig_type;
    sig_type sig;

    std::shared_ptr<object_with_slot> ptr(new object_with_slot);
    sig.connect(sig_type::slot_type(*ptr).track_foreign(ptr)); // ptr is tracked

    sig();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:15:09.167

1 和 2) 实际上这是一种未定义的行为。您使用了取消引用运算符，现在 connect 具有 object_with_slot 的值，它的地址可以由内存管理器自由分配给任何其他进程。巧合的是，它仍然是一个“有效地址”。并且 ptr 可以自由地分配给任何其他值而不会导致内存泄漏。

尝试这样的事情，你会看到每次都会爆炸

```
#include <boost/signals2.hpp>
#include <iostream>

struct object_with_slot
{
    object_with_slot()
    {
        member = new int(10);
    }

    ~object_with_slot()
    {
        delete member; //comment this line and everything works again
    }
    void operator()()
    {
        std::cout << "Slot called!" << std::endl;
        *member = 50500; //it was destroyed above
    }
    int *member;
};

int main()
{
    boost::signals2::signal<void ()> sig;

    object_with_slot * ptr = new object_with_slot;
    sig.connect(*ptr);

    delete ptr;
    ptr = 0x0;

    sig();
} 
```

3）你可以在object_with_slot的析构函数上放另一个信号，然后它可以在调用时通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-03T10:23:37.757

给出了非常危险的例子。看一看：

```
#include <iostream>
#include <memory>
#include <boost/signals2.hpp>

struct object_with_slot
{
    object_with_slot() {
        std::cout << "ctor\n";
    }

    object_with_slot(const object_with_slot &) {
        std::cout << "cctor\n";
    }

    ~object_with_slot() {
        std::cout << "dtor\n";
    }

    void operator()()
    {
       std::cout << "Slot called!" << std::endl;
       member = 50500;
    }
    int member;
};

//
int main()
{
    typedef boost::signals2::signal<void ()> sig_type;
    sig_type sig;

    std::shared_ptr<object_with_slot> ptr(new object_with_slot);
    sig.connect(sig_type::slot_type(*ptr).track_foreign(ptr)); // ptr is tracked

    sig();

    return 0;
} 
```

你怎么看，这段代码输出了什么（g++ 4.8.1，libboost 1.54）？

```
ctor
cctor
cctor
cctor
cctor
cctor
cctor
cctor
cctor
dtor
dtor
dtor
dtor
dtor
cctor
dtor
cctor
dtor
dtor
dtor
cctor
dtor
Slot called!
dtor
dtor 
```

我不认为，这种行为是意料之中的。`*ptr`因为我们将（实例）的副本（按值）传递`object_with_slot`给`connect`方法。例如，它可以通过引用包装器来解决：

```
sig.connect(sig_type::slot_type(boost::ref(*ptr)).track_foreign(ptr)); // ptr is tracked 
```

小心使用模板和类型。

# javascript - 您如何跟踪有多少网站具有主动嵌入的 iframe 小部件？

> ID：14882868
> 
> 赞同：0
> 
> 时间：2013-02-14T19:50:41.053
> 
> 标签：javascript, iframe, google-analytics, analytics, http-referer

我有一个嵌入在 3000 多个第三方网站中的 iframe 小部件，但我想确切地知道它嵌入了多少个网站。

我们目前的方法是使用谷歌分析来生成引用列表，并让脚本手动卷曲列表中的每个 url 以查找我们的小部件。

我们正在考虑的另一种方法是使用 php 打印 $_SERVER['HTTP_REFERER']，如果确定页面在 iframe 中，则使用 javascript 触发分析事件，但由于可以操纵引用者，我不这样做'不知道效果如何。

谢谢！

# ruby-on-rails - 我需要简单但完整的说明来实施设计身份验证策略

> ID：14882871
> 
> 赞同：4
> 
> 时间：2013-02-14T19:51:05.903
> 
> 标签：ruby-on-rails, authentication, devise

我正在尝试编写一种设计身份验证策略来针对现有的旧 API 进行身份验证。我没有数据库，所以我无法从某些现有来源迁移用户。我想做类似的事情：

[http://4trabes.com/2012/10/31/remote-authentication-with-devise/](http://4trabes.com/2012/10/31/remote-authentication-with-devise/)

但是，按照这些说明操作后，Devise 拒绝调用我的身份验证策略。我已经通过尝试将 puts 调用插入到我的 RemoteAuthenticatable 模块中来对此进行测试...

彼得。

根据要求编辑添加代码。

应用程序/模型/User.rb：

```
class User
  attr_accessor :id

  include ActiveModel::Validations #required because some before_validations are defined in devise
  extend ActiveModel::Callbacks #required to define callbacks
  extend Devise::Models

  define_model_callbacks :validation #required by Devise

  devise :remote_authenticatable
end 
```

lib/remote_authenticatable.rb （注意我插入的puts以获得一些穷人的追踪）。

```
module Devise
  module Models
    module RemoteAuthenticatable
      extend ActiveSupport::Concern

      #
      # Here you do the request to the external webservice
      #
      # If the authentication is successful you should return
      # a resource instance
      #
      # If the authentication fails you should return false
      #
      def remote_authentication(authentication_hash)
        puts "In Devise::Models::RemoteAuthenticatable.remote_authentication()"
        # Your logic to authenticate with the external webservice
      end

      module ClassMethods
        ####################################
        # Overriden methods from Devise::Models::Authenticatable
        ####################################

        #
        # This method is called from:
        # Warden::SessionSerializer in devise
        #
        # It takes as many params as elements had the array
        # returned in serialize_into_session
        #
        # Recreates a resource from session data
        #
        def serialize_from_session(id)
          resource = self.new
          resource.id = id
          resource
        end

        #
        # Here you have to return and array with the data of your resource
        # that you want to serialize into the session
        #
        # You might want to include some authentication data
        #
        def serialize_into_session(record)
          [record.id]
        end

      end
    end
  end

  module Strategies
    class RemoteAuthenticatable < Authenticatable
      def valid?
        puts "In Devise::Strategies::RemoteAuthenticatable.valid?()"
        true
      end

      #
      # For an example check : https://github.com/plataformatec/devise/blob/master/lib/devise/strategies/database_authenticatable.rb
      #
      # Method called by warden to authenticate a resource.
      #
      def authenticate!
        puts "In Devise::Strategies::RemoteAuthenticatable.authenticate!()"
        #
        # authentication_hash doesn't include the password
        #
        auth_params = authentication_hash
        auth_params[:password] = password

        #
        # mapping.to is a wrapper over the resource model
        #
        resource = mapping.to.new

        return fail! unless resource

        # remote_authentication method is defined in Devise::Models::RemoteAuthenticatable
        #
        # validate is a method defined in Devise::Strategies::Authenticatable. It takes
        #a block which must return a boolean value.
        #
        # If the block returns true the resource will be loged in
        # If the block returns false the authentication will fail!
        #
        if validate(resource){ resource.remote_authentication(auth_params) }
          success!(resource)
        end
      end
    end
  end
end 
```

以及我添加到 config/initializers/devise.rb 的代码

```
 require 'remote_authenticatable'  

  config.warden do |manager|
     manager.strategies.add(:remote, Devise::Strategies::RemoteAuthenticatable)
     manager.default_strategies(:scope => :user).unshift :remote
  end

  Devise.add_module :remote_authenticatable, :controller => :sessions,  :route => { :session => :routes } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T21:20:47.193

您可以尝试删除对

```
manager.strategies.add 
```

而是在您的策略文件末尾添加此调用

```
Warden::Strategies.add(:rememberable, Devise::Strategies::RemoteAuthenticatable) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-20T17:11:42.267

我将 remote_authenticable.rb (model) 添加到 app > models >关注> devise > models，并插入了一个调试器语句来检查它是否被正确调用

```
def remote_authentication(authentication_hash)
  debugger
  false 
  # Your logic to authenticate with the external webservice
end 
```

将 remote_authenticable.rb (strategy) 放入 lib > devise > strategy

并将warden块添加到devise.rb（初始化程序）

```
require "devise/strategies/remote_authenticable.rb"

config.warden do |manager|
  manager.strategies.add(:remote, Devise::Strategies::RemoteAuthenticatable)
  manager.default_strategies(:scope => :user).unshift :remote
end 
```

它运行...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T07:42:25.737

在 config/initializers/devise.rb 你写了这个

```
config.warden do |manager|
  manager.strategies.add(:remote, Devise::Strategies::RemoteAuthenticatable)
  manager.default_strategies(:scope => :user).unshift :remote
end 
```

现在在同一目录中创建另一个文件，即“remote.rb”并添加类似这样的内容

```
Warden::Strategies.add(:remote) do 
 def valid? 
 true
end 

def authenticate! 

  if params[:user]
    user = User.find_by_login_name(params[:user][:login_name])

    if user && user.account_status != "active" # add your own checks here for authentication 
      fail
      halt! #after this succes no other authentication will process
    end
  else
    fail
  end 
 end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-24T15:14:46.750

按照相同的教程，这对我有用：

将 remote_authenticatable 代码分解为：/lib/devise/models/remote_authenticatable.rb 和 /lib/devise/strategies/remote_authenticatable.rb

在 config/initializers/devise.rb 我添加了

```
require 'devise/orm/active_record'
require "devise/strategies/remote_authenticatable"
require "devise/models/remote_authenticatable"

Devise.add_module :remote_authenticatable, :controller => :sessions, :route => { :session => :routes } 
```

在 Devise.setup 下：

```
config.warden do |manager|
 manager.strategies.add(:remote, Devise::Strategies::RemoteAuthenticatable)
 manager.default_strategies(:scope => :user).unshift :remote
end 
```

# android - 当问题使用户拔出电池时，如何从 Android 设备获取日志文件？

> ID：14882873
> 
> 赞同：0
> 
> 时间：2013-02-14T19:51:20.603
> 
> 标签：android, error-logging

我正在开发一个在大多数 Android 设备上运行良好的应用程序；但是，有时用户抱怨该应用程序反复导致他的设备死机，以至于他不得不拔出电池。我该怎么做才能从该用户那里获取日志文件，以便找出导致冻结的原因？通常我们要求用户重现崩溃并立即运行 CatLog 以获取日志；但是，在这种情况下，在电池拔出后运行 CatLog 似乎并没有在日志中为我们提供任何有用的信息。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T20:31:13.690

# 让他回家等一两分钟。

如果设备很慢，它可能看起来冻结但它会响应。Android 被设计成健壮的。

# iphone - iPhone 应用程序因 coreData 错误而崩溃

> ID：14882875
> 
> 赞同：0
> 
> 时间：2013-02-14T19:51:24.897
> 
> 标签：iphone, core-data, crash, migration

我们应用的第一个版本在应用商店。为了使应用程序国际化，对应用程序使用的核心数据模型进行了一个小的更改，更改是 - 添加到其中一个实体的新属性。

我通过向核心数据添加新的版本控制模型并将当前的核心数据模型设置为创建的新版本来进行更改。

为了进行轻量级迁移，我添加了所需的选项，如下所示：

```
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
    [NSNumber numberWithBool:YES],    NSMigratePersistentStoresAutomaticallyOption,
    [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil];
NSError *error = nil;
__persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc]  initWithManagedObjectModel:[self managedObjectModel]];
[__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:options error:&error]; 
```

在模拟器中进行测试并在设备上进行测试时（连接到 MAC 时），所有这些都可以正常工作。一旦我制作了一个 ipa 文件并将其安装在设备上，应用程序就会在我启动它时立即崩溃。default.png 文件显示，然后没有加载其他视图。

应用程序崩溃日志显示 CoreData 存在一些问题，但我无法说出这是导致问题的原因。崩溃日志如下所示：

```
Last Exception Backtrace:
0   CoreFoundation                  0x374f388f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x31568259 objc_exception_throw + 33
2   CoreData                        0x324ee491 -[NSManagedObjectModel(_NSInternalMethods) _setIsEditable:] + 1
3   Company                         0x000dfe7f 0xde000 + 7807
4   Company                         0x000dfc91 0xde000 + 7313
5   Company                         0x000ecb5b 0xde000 + 60251
6   Company                         0x000ec8a3 0xde000 + 59555
7   Company                         0x000ec82b 0xde000 + 59435
8   Company                         0x000eb61d 0xde000 + 54813
9   UIKit                           0x3080cd59 -[UIViewController awakeFromNib] + 113
10  UIKit                           0x3089f207 -[UINib instantiateWithOwner:options:] +     1243
11  UIKit                           0x308a0861 -[NSBundle(UINSBundleAdditions) loadNibNamed:owner:options:] + 137
12  UIKit                           0x307d6385 -[UIApplication _loadMainNibFileNamed:bundle:] + 37
13  UIKit                           0x3065f6eb -[UIApplication _loadMainInterfaceFile] + 223
14  UIKit                           0x3065972f -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 235
15  UIKit                           0x30627ac3 -[UIApplication handleEvent:withNewEvent:] + 1011
16  UIKit                           0x30627567 -[UIApplication sendEvent:] + 55
17  UIKit                           0x30626f3b _UIApplicationHandleEvent + 5827
18  GraphicsServices                0x3764322b PurpleEventCallback + 883
19  CoreFoundation                  0x374c7523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 39
20  CoreFoundation                  0x374c74c5 __CFRunLoopDoSource1 + 141
21  CoreFoundation                  0x374c6313 __CFRunLoopRun + 1371
22  CoreFoundation                  0x374494a5 CFRunLoopRunSpecific + 301
23  CoreFoundation                  0x3744936d CFRunLoopRunInMode + 105
24  UIKit                           0x3065886b -[UIApplication _run] + 551
25  UIKit                           0x30655cd5 UIApplicationMain + 1081
26  Company                         0x000df5df 0xde000 + 5599
27  Company                         0x000df598 0xde000 + 5528

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x3289832c __pthread_kill + 8
1   libsystem_c.dylib               0x34c0d208 pthread_kill + 48
2   libsystem_c.dylib               0x34c06298 abort + 88
3   libc++abi.dylib                 0x3221bf64 abort_message + 40
4   libc++abi.dylib                 0x32219346 _ZL17default_terminatev + 18
5   libobjc.A.dylib                 0x31568350 _objc_terminate + 140
6   libc++abi.dylib                 0x322193be _ZL19safe_handler_callerPFvvE + 70
7   libc++abi.dylib                 0x3221944a std::terminate() + 14
8   libc++abi.dylib                 0x3221a81e __cxa_rethrow + 82
9   libobjc.A.dylib                 0x315682a2 objc_exception_rethrow + 6
10  CoreFoundation                  0x37449506 CFRunLoopRunSpecific + 398
11  CoreFoundation                  0x37449366 CFRunLoopRunInMode + 98
12  UIKit                           0x30658864 -[UIApplication _run] + 544
13  UIKit                           0x30655cce UIApplicationMain + 1074
14  Company                         0x000df5d8 0xde000 + 5592
15  Company                         0x000df590 0xde000 + 5520

Thread 1 name:  Dispatch queue: com.apple.libdispatch-manager
Thread 1:
0   libsystem_kernel.dylib          0x328883a8 kevent + 24
1   libdispatch.dylib               0x346a5f04 _dispatch_mgr_invoke + 708
2   libdispatch.dylib               0x346a5c22 _dispatch_mgr_thread + 30

Thread 2:
0   libsystem_kernel.dylib          0x32898cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x34bc8f36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x34bc8cc8 start_wqthread + 0

Thread 3:
0   libsystem_kernel.dylib          0x32898cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x34bc8f36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x34bc8cc8 start_wqthread + 0

Thread 4 name:  WebThread
Thread 4:
0   libsystem_kernel.dylib          0x328980d8 __psynch_mutexwait + 24
1   libsystem_c.dylib               0x34bc2674 pthread_mutex_lock + 376
2   WebCore                         0x336994e8 _ZL17_WebTryThreadLockb + 208
3   WebCore                         0x336997ec _ZL14WebRunLoopLockP19__CFRunLoopObservermPv + 24
4   CoreFoundation                  0x374c7b14 __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__ + 12
5   CoreFoundation                  0x374c5d50 __CFRunLoopDoObservers + 252
6   CoreFoundation                  0x374c616a __CFRunLoopRun + 946
7   CoreFoundation                  0x3744949e CFRunLoopRunSpecific + 294
8   CoreFoundation                  0x37449366 CFRunLoopRunInMode + 98
9   WebCore                         0x3373cc9c _ZL12RunWebThreadPv + 396
10  libsystem_c.dylib               0x34bce72e _pthread_start + 314
11  libsystem_c.dylib               0x34bce5e8 thread_start + 0

Thread 5:
0   libsystem_kernel.dylib          0x32898cd4 __workq_kernreturn + 8
1   libsystem_c.dylib               0x34bc8f36 _pthread_wqthread + 610
2   libsystem_c.dylib               0x34bc8cc8 start_wqthread + 0

Thread 0 crashed with ARM Thread State:
r0: 0x00000000    r1: 0x00000000      r2: 0x00000001      r3: 0x00000000
r4: 0x00000006    r5: 0x3f18dd98      r6: 0x00000002      r7: 0x2fedca68
r8: 0x0c641d30    r9: 0x00000000     r10: 0x0c63fd00     r11: 0x3fae9728
ip: 0x00000148    sp: 0x2fedca5c      lr: 0x34c0d20f      pc: 0x3289832c 
```

cpsr: 0x000f0010

线

```
"2 CoreData   0x324ee491 -[NSManagedObjectModel(_NSInternalMethods) _setIsEditable:] + 1" 
```

表明核心数据存在一些问题，但我不知道我需要做什么或做什么来解决这个问题。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T19:21:30.403

我花了很多时间后发现了这个问题。

ipa 文件是使用构建脚本构建的，这是由构建错误引起的。

构建的 .ipa 文件不包含第二版核心数据。所以应用程序总是崩溃。

# javascript - extjs 4：一个有 2 列的表单面板，可以插入 2 个类型的字段

> ID：14882876
> 
> 赞同：1
> 
> 时间：2013-02-14T19:51:24.780
> 
> 标签：javascript, extjs, extjs4

```
var dr = Ext.create('Ext.FormPanel', {
    frame: true,
    //title: 'Date Range',
    bodyPadding: '5px 5px 0',
    width: 650,
    fieldDefaults: {
        labelWidth: 125,
        msgTarget: 'side',
        autoFitErrors: false
    },
    defaults: {
        width: 300
    },
    defaultType: 'datefield',
    items: [{
        fieldLabel: 'Start Date',
        name: 'startdt',
        id: 'startdt',
        vtype: 'daterange',
        endDateField: 'enddt' // id of the end date field
    }, {
        fieldLabel: 'End Date',
        name: 'enddt',
        id: 'enddt',
        vtype: 'daterange',
        startDateField: 'startdt' // id of the start date field
    }, {
        xtype: 'combobox',
        fieldLabel: 'Vehicle',
        name: 'state11212',
        store: cmbstore,
        valueField: 'DeviceID',
        displayField: 'VehicleNo',
        typeAhead: true,
        queryMode: 'local',
        emptyText: 'Select a Vehicle...'
    }]
}); 
```

此代码将有 3 行，
第一行是开始日期字段
第二行是结束日期字段
第三行是组合框。

## 问题

如何使第一行变成两列，第二列的结束日期字段，平均结束日期字段在开始日期字段的右侧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:10:07.470

您可以使用[hbox 布局](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.layout.container.HBox)( `layout: 'hbox'`)：

> 在 Container 中水平排列项目的布局。此布局可以选择在包含数字 flex 配置的子项之间划分可用的水平空间。

工作示例：http: [//jsfiddle.net/nue7j/](http://jsfiddle.net/nue7j/)

# sap-ase - Sybase ASE“日志空间不足”对事务的影响

> ID：14882885
> 
> 赞同：1
> 
> 时间：2013-02-14T19:52:08.843
> 
> 标签：sap-ase

我正在 SOURCE 数据库上的 SPROC 和 Sybase ASE 上的 DESTINATION 数据库上运行一系列归档查询。我分批或在一系列事务中运行这些查询，这意味着`n`每个事务中只会归档一些记录。

但是，有时 Sybase ASE 会用完日志空间并结束 SPROC。

我的问题是：当 Sybase ASE 用完日志空间并结束我的 SPROC 时，我的事务是否会回滚在“日志空间不足”错误结束我的 SPROC 时正在使用的数据？

我知道在“日志空间不足”错误永久存在之前提交的所有事务。但我不确定事务是否会在此错误上回滚，而且我也很难对此进行测试。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:42:14.477

这通常取决于各个数据库设置。

如果数据库设置为“Abort Tran on Log Full”，那么当事务日志填满时，事务将被中止/回滚。如果未设置该选项，则数据库将进入“LOG SUSPEND”模式，并将暂停数据库中的所有活动，直到空间被释放或添加到日志中。一旦日志空间可用，事务将被允许完成。

可以通过发出**sp_helpdb** *{DBNAME}*命令并查看*状态*列来找到当前在数据库中设置的标志。

# php - 如何让在“编辑”模式下选择的记录与 pod ui 中的视图一致？

> ID：14882887
> 
> 赞同：0
> 
> 时间：2013-02-14T19:52:20.757
> 
> 标签：php, podscms

如何让在“编辑”模式下选择的记录与 pod ui 中的视图一致？我正在运行 pod 2.2。如果我在“编辑”模式下连续选择“下一条记录”，则会出现不在视图中的记录。因此，用户可以编辑彼此的记录。请提供代码示例。

```
<?php
function pods_ui_employees()
{
  $icon = '';
  add_object_page('Employees', 'Employees', 'read', 'employees', '', $icon);
  add_submenu_page('employees', 'Employees', 'Employees', 'read', 'employees', 'employees_page');
}

function employees_page()
{
  global $current_user;
  get_currentuserinfo();
  $object = pods('employees');

  $edit_fields = array(
                    'emp_id',
                    'first_name',
                    'last_name',
                    'manager_id',
                    'approve'
                    );

  $object->ui = array(
                    'sort' => 'emp_id ASC',
                    'limit' => -1,
                    'where' => 'manager_id="'. $current_user->user_login. '"',
                    'edit_where' => array('manager_id' => $current_user->user_login),                   
                    'title'   => 'Employees',
                    'columns' => array(
                              'emp_id'          => 'Employee ID',                   
                              'first_name'      => 'First Name',
                              'last_name'       => 'Last Name',
                              'manager_id'      => 'Manager',                             
                              'approve'         => 'Approve'
                              ),
//                  'add_fields'  => $add_fields,
                    'edit_fields' => $edit_fields
                    );
  pods_ui_manage($object);
}

add_action('admin_menu','pods_ui_employees');

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:53:40.363

您可以将 'actions_disabled' 选项添加到 $ui 选项并将其设置为 array( 'navigate' ) 以禁用项目之间的导航。

在 Pods 2.3 中，我们在 edit_where （向后兼容）等中实现了高级限制功能。

**编辑（2013 年 4 月 17 日）**

Pods 中的许多操作是默认 Pods 屏幕不启用的，使用这个数组作为 'actions_disabled' 选项将得到你想要的：

```
'actions_disabled' => array( 'navigate', 'view', 'export', 'reorder' ) 
```

其他可禁用的操作包括：“添加”、“编辑”、“删除”、“复制”、“重新排序”。

# r - 删除列时保留列名

> ID：14882888
> 
> 赞同：1
> 
> 时间：2013-02-14T19:52:25.643
> 
> 标签：r

我创建了一个 R 脚本，它计算数据框每一列中缺失值的百分比，然后删除超过预设阈值的列。**需要**维护 列名。

当列删除后数据框中的列多于一列时，名称将保留，但只有一列时不保留。

列名保持不变时的代码

```
df <- data.frame(A=rnorm(10, 10, 1), B=rep(NA, 10), C=rnorm(10, 10, 1))
threshold <- 80
pmiss <- function(x) {
ifelse(sum(is.na(x))/length(x)*100 > threshold, TRUE, FALSE)
}

temp <- sapply(df, pmiss)
deletecols <- names(temp[temp==TRUE])
df <- as.data.frame(df[,!(names(df) %in% deletecols)])

names(df) #prints 
[1] "A" "C" 
```

但是，将 df 定义为

```
df <- data.frame(A=rnorm(10, 10, 1), B=rep(NA, 10)) 
```

和

```
names(df) #prints 
[1] "df[, !(names(df) %in% deletecols)]" 
```

有谁知道为什么只有一列时不保留列名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:00:18.990

你被[R FAQ](http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-my-matrices-lose-dimensions_003f)咬了。添加`,drop = FALSE`到您的数据框子集（并且您注意到您不再需要的副作用`as.data.frame`。）

# c++ - 从 stl_vector.h 创建结构向量时出错（可能微不足道）

> ID：14882891
> 
> 赞同：0
> 
> 时间：2013-02-14T19:52:33.543
> 
> 标签：c++, vector, struct

在我的代码中，我有：

```
struct datapoint
{
  double energy;
  double probability;
}; 
```

稍后将其放入向量中，如下所示：

```
std::vector<datapoint> spectrum(71,0);

spectrum[0].energy = 0.937729;
spectrum[0].probability = 0.0022582628449311468;
spectrum[1].energy = 1.875458;
spectrum[1].probability = 0.0033531784328108922;
... 
```

但是，在编译时，对于该行

```
std::vector<datapoint> spectrum(71,0); 
```

我收到错误

```
/usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_vector.h: In member function âvoid std::vector<_Tp, _Alloc>::_M_initialize_dispatch(_Integer, _Integer, std::__true_type) [with _Integer = int, _Tp = datapoint, _Alloc = std::allocator<datapoint>]â:
/usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_vector.h:303:   instantiated from âstd::vector<_Tp, _Alloc>::vector(_InputIterator, _InputIterator, const _Alloc&) [with _InputIterator = int, _Tp = datapoint, _Alloc = std::allocator<datapoint>]â
/src/PrimaryGeneratorAction.cc:74:   instantiated from here
/usr/lib/gcc/x86_64-redhat-linux/4.4.6/../../../../include/c++/4.4.6/bits/stl_vector.h:991: error: no matching function for call to âstd::vector<datapoint, std::allocator<datapoint> >::_M_fill_initialize(size_t, int&)â 
```

我有点困惑，因为我以前做过。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:55:31.673

您正在尝试调用以下的填充构造函数`vector`：

```
explicit vector (size_type n, const value_type& val = value_type(),
                 const allocator_type& alloc = allocator_type()); 
```

但`0`不是 type 的有效值`datapoint`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:13:36.333

```
struct datapoint
{
    double energy;
    double probability;
    datapoint():energy(0.0), probability (0.0)
    {}
}; 
```

然后 std::vector 谱（71）；

玩得开心，

# cordova - 移动网站和Phonegap

> ID：14882892
> 
> 赞同：0
> 
> 时间：2013-02-14T19:52:34.450
> 
> 标签：cordova, mobile, mobile-website

我正在开发一个带有 phonegap 的移动应用程序。我想知道我是否可以使用 phonegap 代码制作一个移动网站（具有相同的功能）或者我是否必须对其进行修改。

我可以通过手机浏览器访问 GPS 和相机吗？（主要是安卓和iOS）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T00:33:57.167

实际上，在一些浏览器中已经对 MediaCapture HTML 输入元素有一些早期支持，包括 Android 和 Android 上的 Chrome。请注意，这与不受支持的完整 MediaCapture API 不同。

HTML MediaCapture 元素允许您在表单中使用输入元素，该元素将生成设备的相机以进行静态图片、音频或视频捕获。

您可以在此处查看有关哪些移动浏览器支持 MediaCapture HTML API 的更多详细信息：http: [//mobilehtml5.org/](http://mobilehtml5.org/)

在那些不支持此功能的浏览器中，没有任何修改 PhoneGap 代码可以使其工作；只是不支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:10:13.883

您已经可以在移动 webkit 浏览器中访问 GPS，但不能在相机中访问。

PhoneGap API 尝试遵循 W3C 定义的 API，并且 API 文档提到何时使用本机实现（如地理定位 [1] 的情况）。您必须检查每个 API。

[1] [http://docs.phonegap.com/en/2.4.0/cordova_geolocation_geolocation.md.html#Geolocation](http://docs.phonegap.com/en/2.4.0/cordova_geolocation_geolocation.md.html#Geolocation)

# android - 地图组件在Android中初始化时的空指针

> ID：14882894
> 
> 赞同：0
> 
> 时间：2013-02-14T19:52:41.940
> 
> 标签：android, nullpointerexception, google-maps-android-api-2, forceclose

我有一个我一直在研究的应用程序。主要活动使用适用于 Android (v2) 的 GoogleMap 类显示地图。有时，并非总是如此，我在启动我的应用程序时会得到一个空指针。上次发生这种情况时，它在一天后停止发生，代码没有更改。在查看了 logcat（发布在下面）之后，我有一种预感，地图对象还不可用。

所以我查看了这个页面：[https](https://developers.google.com/maps/documentation/android/map) ://developers.google.com/maps/documentation/android/map （验证地图可用性部分），我已经确定地图对象在 onCreate 中不为空。

由于这个问题是间歇性的，我只能猜测它与谷歌服务有关。我最近强制停止并清除了 Google 服务框架应用程序的数据，以尝试更新到 4.2.2（起诉我）。任何想法 - 有没有人听说过这个，或者有没有人知道如何解决它？

**编辑：**此代码现在再次起作用，正如您在此处看到的那样。我没有改变任何东西。

**所以我的问题是：**什么可能导致这种行为？我正在使用直接来自 Google Maps for Android v2 文档的代码检查地图对象（下面第 142 行的 NPE）在 onCreate()、onStart() 和 onResume() 中是否为空。

**包含在不应允许的 onCreate()、onStart() 和 onResume() 中...：**

```
 // Do a null check to confirm that we have not already instantiated the map.
    if (mMap == null) {
    mMap = ((MapFragment) getFragmentManager().findFragmentById(R.id.mainMap))
                        .getMap();
    // Check if we were successful in obtaining the map.
    if (mMap != null) {
        // The Map is verified. It is now safe to manipulate the map. 
```

**日志猫：**

```
02-14 13:33:03.190: E/AndroidRuntime(5448): Caused by: java.lang.NullPointerException
02-14 13:33:03.190: E/AndroidRuntime(5448):     at maps.ar.b.a(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at maps.y.h.a(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at maps.y.au.a(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at maps.y.ae.moveCamera(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$Stub.onTransact(IGoogleMapDelegate.java:83)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at android.os.Binder.transact(Binder.java:310)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$a$a.moveCamera(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at com.google.android.gms.maps.GoogleMap.moveCamera(Unknown Source)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at com.tyler.ioio.MainActivity.onStart(MainActivity.java:142)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1164)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at android.app.Activity.performStart(Activity.java:5114)
02-14 13:33:03.190: E/AndroidRuntime(5448):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2153)
02-14 13:33:03.190: E/AndroidRuntime(5448):     ... 11 more 
```

**主要活动：**

```
protected void onStart() {
    super.onStart();

    // This verification should be done during onStart() because the system
    // calls this method when the user returns to the activity, which
    // ensures the desired location provider is enabled each time the
    // activity resumes from the stopped state.
    mLocMan = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    final boolean gpsEnabled = mLocMan.isProviderEnabled(LocationManager.GPS_PROVIDER);

    if (!gpsEnabled) {
        new EnableGpsDialogFragment().show(getFragmentManager(),
                "enableGpsDialog");
    }

    // Optimized code to go to location as fast as possible
    Location firstLoc = mLocMan.getLastKnownLocation(LocationManager.GPS_PROVIDER);
    updateNewFix(getBetterLocation(firstLoc, currentLoc));
    // THIS IS LINE 142 : FORCE CLOSES
    mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(currentLatLng, DEFAULT_ZOOM));
    mMap.setOnMapClickListener(this); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T15:28:48.200

我建议您修改您的代码，如下所示；

```
@Override
protected void onCreate(Bundle savedInstanceState) {

mMap.setOnMapClickListener(this);

}

protected void onStart() {
    super.onStart();

// This verification should be done during onStart() because the system
// calls this method when the user returns to the activity, which
// ensures the desired location provider is enabled each time the
// activity resumes from the stopped state.
    mLocMan = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    final boolean gpsEnabled = mLocMan.isProviderEnabled(LocationManager.GPS_PROVIDER);

    if (!gpsEnabled) {
       new EnableGpsDialogFragment().show(getFragmentManager(),
            "enableGpsDialog");
    }

@Override
protected void onResume() {
    super.onResume();
    setup();

private void setup() {

// Optimized code to go to location as fast as possible
Location firstLoc = mLocMan.getLastKnownLocation(LocationManager.GPS_PROVIDER);
updateNewFix(getBetterLocation(firstLoc, currentLoc));
// THIS IS LINE 142 : FORCE CLOSES

mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(currentLatLng, DEFAULT_ZOOM)); 
```

我认为在 onStart() 中添加太多方法是不合适的。

# wordpress - WP 自定义分类法未显示在 query_posts() 中；

> ID：14882895
> 
> 赞同：1
> 
> 时间：2013-02-14T19:52:45.137
> 
> 标签：wordpress, custom-taxonomy

我有 2 组分类法用于网站，默认 WP 类别，以及我通过 functions.php 为内容类型（'type'）创建的另一组

```
add_action( 'init', 'content_taxonomy', 0 );
function content_taxonomy() {

register_taxonomy(
'type',
'post',
array(
    'hierarchical' => true,
    'label' => 'Type of Content',
    'query_var' => true,
    'rewrite' => false
    )
  );
}; 
```

然后，在我的 category.php 文件中，我想在单个 WP 类别中显示所有帖子，然后能够按其下方的内容类型类别过滤它们（链接到视频、博客帖子、文章等的帖子） . 所以，我的循环如下：

```
$category = get_category( get_query_var( 'cat' ) );
$cat_id = $category->cat_ID;

query_posts('cat=".$cat_id.", 121') // 121 Being the Video Custom Taxonomy 
```

然后我跟进循环。但是，我似乎无法让它显示自定义分类类别，它只是抓取 WP 类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:49:54.417

您似乎将自定义分类法视为另一个类别。如果您的猫是 7 岁，您的代码将评估为：

```
query_posts('cat=7, 121'); 
```

您的 query_posts 行不应该是这样的：

```
query_posts( 'cat=' . $cat_id . '&type=video' ); 
```

# linux - 我可以使用哪些标准命令来有效地打印命令行上排序输出的前几行？

> ID：14882897
> 
> 赞同：6
> 
> 时间：2013-02-14T19:52:48.760
> 
> 标签：linux, bash, unix

我基本上想要相当于

```
... | sort -arg1 -arg2 -... | head -n $k 
```

但是，我的理解是排序将在整个输入上进行 O( *n* log *n )。*就我而言，我正在处理大量数据，因此运行时间对我来说很重要——而且我有一个习惯，就是用排序的临时文件来溢出我的 tmp/ 文件夹。

我宁愿让它使用例如堆来运行 O( *n* log *k* )，这可能会更快，并且也将工作集内存减少到*k*。

是否有一些标准命令行工具的组合可以有效地做到这一点，而无需我自己编写代码？理想情况下，它将支持 sort 命令的完整表达排序功能。排序（至少在 ubuntu 上）似乎没有手册页记录的开关来关闭它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T02:56:44.410

基于上述内容，以及更多的戳，我会说我的问题的官方答案是“没有解决方案”。您可以使用专门的工具，也可以使用现有的工具以它们当前的性能，或者您可以编写自己的工具。

我正在讨论跟踪排序源代码并提供补丁。同时，如果这个快速的 hack 代码可以帮助任何人做类似于我正在做的事情，这就是我为自己写的。不是最好的 python，而且是一个非常阴暗的基准：我将它提供给任何关心提供更严格的人：

*   256 个文件，总大小约为 1.6 Gig，全部位于 ssd 上，行由 \n 分隔，行格式为 [^\t]*\t[0-9]+
*   Ubuntu 10.4、6 核、8 gigs 内存、ssd 上的 /tmp。
*   `$ time sort -t^v<tab> -k2,2n foo* | tail -10000`
    *   真正的 7m26.444s
    *   用户 7m19.790s
    *   系统 0m17.530s
*   `$ time python test.py 10000 foo*`

    *   真正的 1m29.935s
    *   用户 1m28.640s
    *   系统 0m1.220s
*   使用diff分析，两种方法在平局上有所不同，但排序顺序相同。

测试.py：

```
#!/usr/bin/env python
# test.py

from sys import argv
import heapq
from itertools import chain

# parse N - the size of the heap, and confirm we can open all input files
N = int(argv[1])
streams = [open(f, "r") for f in argv[2:]]

def line_iterator_to_tuple_iterator(line_i):
    for line in line_i:
        s,c = line.split("\t")
        c = int(c)
        yield (c, s)

# use heap to process inputs
rez = heapq.nlargest(N,
               line_iterator_to_tuple_iterator(chain(*streams)),
               key=lambda x: x[0])

for r in rez:
    print "%s\t%s" % (r[1], r[0])

for s in streams:
    s.close() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:53:31.937

UNIX/Linux 提供通才工具集。对于大型数据集，它会加载大量 I/O。它会做你想做的一切，但速度很慢。如果我们对输入数据有所了解，那将有很大帮助。

IMO，你有一些选择，没有一个你会真正喜欢。

1.  进行多部分“基数”预排序 - 例如让 awk 将键以“A”开头的所有行写入一个文件“B”到另一个文件，等等。或者如果你只有“P”、“D”和“Q” '，让 awk 吸出你想要的东西。然后对一个小子集进行完整排序。这将创建 26 个名为 A、B ...Z 的文件

    awk '{打印 $0 > substr($0,1,1)} 大文件；排序 [此处的选项] PDQ > 结果

2.  花费 $$：（示例）从`iri.com` 任何其他排序软件购买 CoSort。这些类型使用各种优化，但它们不像 bash 那样免费。您还可以购买 SSD，它将磁盘上的排序速度提高几个数量级。`5000iops`现在到`75000iops`. 使用该`TMPDIR`变量将您的 tmp 文件放在 SSD 上，只对 SSD 进行读写。但是使用您现有的 UNIX 工具集。

3.  使用一些软件，如 R 或 strata，或者最好是数据库；所有这些都适用于大型数据集。

4.  做你现在正在做的事情，但是在 UNIX 排序运行时观看 youtube。

IMO，当您想要快速结果时，您对大型数据集使用了错误的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T01:30:55.863

这是一个粗略的部分解决方案：

```
#!/usr/bin/perl

use strict;
use warnings;

my @lines = ();

while (<>) {
    push @lines, $_;
    @lines = sort @lines;
    if (scalar @lines > 10) {
        pop @lines;
    }
}
print @lines; 
```

它只读取一次输入数据，持续维护前 10 行的排序数组。

当然，每次对整个数组进行排序是低效的，但我猜对于千兆字节的输入，它仍然会比`sort huge-file | head`.

添加一个选项来改变打印的行数会很容易。添加选项来控制如何完成排序会有点困难，但如果[CPAN](http://search.cpan.org/)中有一些东西可以帮助我，我不会感到惊讶。

更抽象地说，从大数组中仅获取前 N 个已排序元素的一种方法是使用部分快速排序，除非需要，否则您不必费心对正确的分区进行排序。这需要将整个数组保存在内存中，这在您的情况下可能是不切实际的。

您可以将输入分成中等大小的块，应用一些巧妙的算法来获取每个块的前 N ​​行，将这些块连接在一起，然后将相同的算法应用于结果。根据块的大小，`sort ... | head`可能足够聪明。`split -l ...`将用于执行此操作的 shell 脚本组合在一起应该不难。

（根据需要插入更多的挥手。）

免责声明：我只是在一个比你正在使用的文件（大约 170 万行）小得多的文件上尝试了这个，而且我的方法比`sort ... | head`.

# c# - Web API 托管

> ID：14882902
> 
> 赞同：7
> 
> 时间：2013-02-14T19:53:04.400
> 
> 标签：c#, asp.net, .net, asp.net-web-api

Windows Azure 是我们为 Web API 提供的唯一托管选项（“Selfhost”除外）吗？如果没有，支持 Web API 的主机在哪里？许多 Google 搜索仅返回自托管选项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T19:57:03.463

查看[http://www.asp.net/hosting](http://www.asp.net/hosting)获取合作伙伴的官方列表。WebAPI 可以作为 ASP.NET 的一部分托管，它只需要 .NET 4.0+。

另请参阅[http://www.asp.net/web-api/overview/hosting-aspnet-web-api](http://www.asp.net/web-api/overview/hosting-aspnet-web-api)了解如何将 WebAPI 部署到 IIS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-23T09:13:02.003

你可以检查这个：

[在 Somee.com 上免费托管](https://somee.com/freeaspnethosting.aspx)

优点：它支持 MVC、Ajax 和其他一些技术。

缺点：服务器有时会在短时间内停机，恕不另行通知。

希望这可以帮助。

# python - 如何使用 django-authopenid 设置默认组？

> ID：14882903
> 
> 赞同：1
> 
> 时间：2013-02-14T19:53:03.803
> 
> 标签：python, django, django-models, django-registration, django-authopenid

我有一个使用 django-authopenid 作为唯一注册方法的 django 应用程序。我`registration`在已安装的应用程序中有 django-authopenid 使用的应用程序。一个理想的解决方案是允许我在用户注册时在用户对象上运行任意代码。我不能直接修改`django-authopenis`or的代码`registration`。

让我知道是否需要添加更多详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:43:07.130

`models.py`你可以绑定post_save[信号](https://docs.djangoproject.com/en/dev/ref/signals/#post-save)：

```
from django.contrib.auth.models import User, Group
from django.db.models.signals import post_save

def default_group(sender, instance, created, **kwargs):
    if created:
        instance.groups.add(Group.objects.get(name='your default group name'))
post_save.connect(default_group, sender=User) 
```

如果有疑问，请阅读[信号](https://docs.djangoproject.com/en/dev/topics/signals/)文档。

# c# - 错误的应用程序配置文件？

> ID：14882906
> 
> 赞同：0
> 
> 时间：2013-02-14T19:53:15.203
> 
> 标签：c#, asp.net

我有一个类库，它具有以下代码的功能：

```
this.apikey = ConfigurationManager.AppSettings["ApiKey"]; 
```

当我在控制台应用程序中调用此函数时，它说 AppSettings 没有键。它还指出连接字符串是aspnet ...而我的是sqlserver。因此，即使我在库函数中调用它，它肯定不会读取我的库应用程序配置。

这是正常的还是我做错了什么？

我希望避免制作和解析 xml 并重新发明轮子。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T19:55:18.617

> 这是正常的还是我做错了什么？

这是正常的，你*做错*了什么。

库通常没有自己的配置 - 它受运行应用程序的配置的影响。

如果您将您的`appSettings`和添加`connectionStrings`到应用程序配置中，一切都将起作用。

* * *

换句话说，当加载应用程序并加载它使用的库时，会读取*应用程序*配置 - 不会读取其他配置文件。调用 的静态方法时`ConfigurationManager`，加载的配置是有效的。

有*一些*方法可以加载特定的配置文件，但这不是默认行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:02:50.887

你肯定在某些地方**错了。**可能是您将密钥写在与`appSettings`. 只需检查它，如果正确，则需要重新发明轮子，如下所示：

```
XDocument.Load(HttpContext.Current.Server.MapPath("~/web.config")); 
```

请务必在使用之前将`System.Web`命名空间添加到您的项目中`HttpContext`

# ruby-on-rails - 将 iso-8601 日期时间转换为 UTC 时间轨

> ID：14882908
> 
> 赞同：-2
> 
> 时间：2013-02-14T19:53:29.713
> 
> 标签：ruby-on-rails, ruby, datetime, time, iso8601

我有一个 ISO-8601 日期时间戳，需要将其转换为 GMT 的本地时间。在 Ruby on Rails 中执行此操作的方法是什么？我有`'1325233011'`，并且需要将其转换为 GMT 标准中的当地时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:48:49.867

我认为您要的是 GMT+5 的语言环境时间。

给定一个 ISO 时间戳，1325233011

当我将其转换为基于语言环境的日期/时间时

```
Time.at(1325233011) => '2011-12-30 03:16:51 -0500' 
```

查看 ruby​​-docs，[http:](http://www.ruby-doc.org/core-1.9.3/Time.html) //www.ruby-doc.org/core-1.9.3/Time.html了解更多信息。Ruby 具有强大的 Time 和 Date 类以及许多帮助实用程序。我的机器配置为 GMT-5，因此它返回本地时间。更改程序中解释时区设置的方式很容易，但那是另一天的事了。希望这可以帮助！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T20:51:29.503

在同事的帮助下得到了它

```
Time.at(1325233011).to_datetime 
```

**对于 ISO-8601：**

```
Time.at(1325233011).to_datetime.iso8601 
```

要验证时间正确转换和比较，请使用此链接 [http://coderstoolbox.net/unixtimestamp/](http://coderstoolbox.net/unixtimestamp/)

# ruby-on-rails-3 - 错误：将 SQLite 迁移到 Postgres

> ID：14882914
> 
> 赞同：1
> 
> 时间：2013-02-14T19:53:45.563
> 
> 标签：ruby-on-rails-3, postgresql, rake

我使用标准配置（SQLite 3）开发了我的应用程序。我想在heroku上部署并且必须更改为postgresql。

但是当我尝试迁移我的 db-schema 时出现此错误。

```
rake db:migrate
rake aborted!
/Users/adrianschnell/Sites/bills_cmd/config/initializers/session_store.rb:3: syntax error, unexpected ':', expecting $end
...sion_store :cookie_store, key: '_bills_cmd_session'
                              ^
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/engine.rb:588
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/engine.rb:587:in `each'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/engine.rb:587
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `run'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `each'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:54:in `run_initializers'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/application.rb:136:in `initialize!'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `send'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
/Users/adrianschnell/Sites/bills_cmd/config/environment.rb:8
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency'
/Library/Ruby/Gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/application.rb:103:in `require_environment!'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/application.rb:297:in `initialize_tasks'
Tasks: TOP => db:migrate => environment 
```

我不知道我现在要做什么。我的 Gem 文件包含 'pg' 并且我的 database.yml 看起来像：

```
# PostgreSQL v0.8.x
#   gem install pg
development:
  adapter: postgresql
  encoding: unicode
  database: bills_cmd_dev
  pool: 5
  username: adrianschnell
  password:
  # Warning: The database defined as "test" will be erased and
  # re-generated from your development database when you run "rake".
  # Do not set this db to the same as development or production.
test:
  adapter: postgresql
  encoding: unicode
  database: bills_cmd_test
  pool: 5
  username: adrianschnell
  password: 
```

PostgreSQL 正在运行 - 通过终端我可以访问它。

编辑：我注意到，在尝试创建 postgre 数据库时出现以下错误：

```
rake db:create:all
rake aborted!
syntax error on line 18, col 11: `'
/Library/Ruby/Gems/1.8/gems/railties-3.2.11/lib/rails/application/configuration.rb:115:in `database_configuration'
/Library/Ruby/Gems/1.8/gems/activerecord-3.2.11/lib/active_record/railties/databases.rake:25
Tasks: TOP => db:create:all => db:load_config
(See full trace by running task with --trace) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:15:21.317

经过数小时的搜索和测试不同的建议，我在这里尝试了这些建议：[stackoverflow](http://goo.gl/i2Jym)

尤其是[Darren](https://stackoverflow.com/a/8307078/1003583)的加入是我的解决方案。现在我的 RoR 应用程序正在运行 postgre。

# directx - 可以在没有 Shader Reflections 的情况下使用 DirectX11 Dynamic Shader Linkage 吗？

> ID：14882918
> 
> 赞同：0
> 
> 时间：2013-02-14T19:54:03.470
> 
> 标签：directx, shader, directx-11, linkage

我尝试从我在 DirectX11 SDK 中看到的内容中实现动态着色器链接，但它们使用的是 Effects11 框架和着色器反射。我正在尝试获得更清洁、更底层的实现。例如 - 用于常量缓冲区而不是使用反射，我只是设置了一个结构。我在任何地方都找不到关于如何在 DirectX 中实现动态着色器链接的干净教程，每个人都使用大量的 Effects11 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-19T13:24:38.887

我也一直在寻找这个问题。看看这个： [https ://msdn.microsoft.com/en-us/library/windows/desktop/ff471421(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ff471421(v=vs.85).aspx)

也许这会有所帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T09:04:18.947

可以在directx11 中使用动态着色器链接而不使用着色器反射，但这意味着您需要在编译时知道类和接口的名称。

我自己通过使用用于声明所有着色器类的着色器预处理器宏以及包含在着色器和 .cpp 文件中的通用头文件来实现这一点。

# c# - 多行文本框将多行字符串显示为单行

> ID：14882921
> 
> 赞同：1
> 
> 时间：2013-02-14T19:54:25.717
> 
> 标签：c#, string, textbox, multiline

我正在制作一个程序，您可以在其中输入项目的名称和描述。然后将其添加到列表框中，完成后您可以将所有项目保存到“txt”文件中。（使用 StreamWriter）。该程序还有一个编辑按钮，允许您编辑列表框中的描述，方法是先将其从列表框中删除，然后再将其显示在文本框中（因此您可以对其进行编辑）

如果描述是多行的，当我在列表框中选择它并单击将其显示回文本框中的编辑按钮时，它将成功显示多行。**但是，如果我先将列表框中的所有项目保存到文件中**。然后再次打开文件，以便将项目重新加载到列表框中。然后点击编辑按钮...

多行描述将在文本框中显示为单行描述。

我不知道为什么 - 但我还制作了一个标签，它将显示文本框应该显示的确切字符串，并且标签显示它是多行的，而文本框不是！

**该字符串肯定是多行的，但在使用 StreamReader 将项目加载回列表框后，多行文本框将其显示为一行。**

多行字符串示例：（名为“theString1”）

> 这是第 1 行
> 
> 这是第 2 行

使用以下代码：`TextBox1.Text = theString1;`这出现在文本框中：

> 这是第 1 行这是第 2 行

但是，如果我使用带有标签的相同代码。它会正确显示。

**如果有人可以向我解释为什么会发生这种情况，我会非常高兴。我只需要一个解释。** 提前致谢。

- -[更多信息] - -

**只是让你知道。我自己想出了这段代码，所以它可能设置错了。** 如果你告诉我一个更好的方法来做到这一点，我会很高兴。

我正在使用列表来存储描述文本+项目名称。我使用 '`' 分隔了这两个。并拆分了字符串（参见代码）。

这是单击编辑按钮时发生的代码。它从列表框中删除该项目并将其显示在文本框中，以便您可以对其进行编辑并再次添加到列表框中：

```
int index = listBox.SelectedIndex;

itemName.Text = listBox.SelectedItem.ToString();

var descVar = descList.ElementAt(index).Split('`');   
string theString1 = descVar[1];  

TextBox1.Text = theString1; 
```

这是将其保存到文件的方式：

```
FileDialog save = new SaveFileDialog();
save.Title = "Save information...";
save.DefaultExt = "Text File|*.txt";
save.Filter = "Text File|*.txt";

if (save.ShowDialog() == DialogResult.OK)
{

    StreamWriter sw = new StreamWriter(save.FileName);

    foreach (string s in listBox.Items)  //This writes the names of item names.
    {
        sw.WriteLine(s);
    }

    sw.WriteLine("`1`");  //I use this to seperate the item names from description.

    foreach (string s in descList)  //This writes the descriptions that are stored in a list named "descList".
    {
        sw.WriteLine(s);
        sw.WriteLine("``");     //I use this to seperate descriptions from each other because they are multi-line.
    }
    sw.WriteLine("`2`");   //Just something so I know where it ends. :D
    sw.Close();              
}
else
{
} 
```

这就是它的加载方式：（这肯定会更好！）

```
FileDialog load = new OpenFileDialog();
load.Title = "Load information...";
load.DefaultExt = "Text File|*.txt";
load.Filter = "Text File|*.txt";

if (load.ShowDialog() == DialogResult.OK)
{
    List<string> loadDesc = new List<string>();  //Don't ask you will see why
    descList.Clear();

    while (listBox.Items.Count > 0)  //This removes all items in the listbox to load new ones.
    {
        int index = 0;
        listBox.Items.RemoveAt(index);

        descList.Clear();

        itemName.Text = "";
    }  

    StreamReader rw = new StreamReader(load.FileName);
    for (; true; )  
    {
        string read = rw.ReadLine();

        if (read == "`1`")  //When it reaches the separator I made it stops reading.
        {
            break;
        }
        else
        {
            listBox.Items.Add(read);
        }
    }

    for (; true; )  
    {
        string read = rw.ReadLine();

        if (read == "`2`")
        {
            break;
        }
        else
        {
            loadDesc.Clear();
            loadDesc.Add(read);
            for (; true; )       //Please tell me if this can be done differently.
            {
                string read2 = rw.ReadLine();
                if (read2 != "``")           //This will keep reading the whole description until it reaches the separator.
                {
                    loadDesc.Add(read2);     //Adds each line into the list I created.
                }
                else
                {
                    break;
                }
            }
            string oneBigString = string.Join("\n", loadDesc);   //This basically converts all strings in a list into one string.
            descList.Add(oneBigString);                          //And this finally add the string to the main list from where it then loads.
        }
    }

}
else
{
} 
```

我相信就是这样。如果您还有其他需要 - 告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:05:24.187

`string oneBigString = string.Join("\n", loadDesc);`是问题所在。

使用`Environment.NewLine`代替`\n`

我还将介绍一些可以通过您的代码改进的事情（有很多，但我只想介绍一些）。

`while (listBox.Items.Count > 0) //This removes all items in the listbox to load new ones.`

您无需遍历列表框中的每个元素即可将其删除。你可以做 listBox.clear()

此外，使用 break 来跳出循环通常是不好的做法。这应该写成...

```
for (; true; )  
{
    string read = rw.ReadLine();

    if (read == "`1`")  //When it reaches the separator I made it stops reading.
    {
        break;
    }
    else
    {
        listBox.Items.Add(read);
    }
} 
```

这

```
string read = rw.ReadLine()
while(read != "`1`")  
{
   listBox.Items.Add(read);
   read = rw.ReadLine()
} 
```

但还有更多，如果`1`在文件中找不到怎么办？它会使您的程序崩溃，因此您还需要检查是否有更多数据要读取...

```
string read = rw.ReadLine()
while(read != "`1`" && !sw.EndOfStream)  // Make sure you're not at the end of the file
{
   listBox.Items.Add(read);
   read = rw.ReadLine()
} 
```

# mysql - 左连接多组表

> ID：14882922
> 
> 赞同：0
> 
> 时间：2013-02-14T19:54:26.287
> 
> 标签：mysql, left-join

我有一个答案表，列出了给定问题的可能答案。

```
possible_answer 
id question_id text
1  1           yes
2  1           no
3  2           red
4  2           blue
5  2           green 
```

然后我有一张用户给出的答案表

```
user_answer
id user_id answer_id 
1  10      1
2  10      3
3  11      1
4  11      4
5  12      2
6  12      5 
```

我正在尝试创建一个 MySQL 查询，它将显示用户名、用户对问题 1 的回答（可能为空）和用户对问题 2 的回答（可能为空）。我被卡住了，因为我觉得我需要将多个 LEFT JOINS 组合在一起，但是我得到的输出给了我一个答案，或者两列中的答案相同。

这是我目前所得到的：

```
SELECT u.name, pa1.text, pa2.text
FROM user u
LEFT JOIN user_answer ua1 ON u.id = ua1.user_id 
LEFT JOIN possible_answer pa1 ON ua1.answer_id = pa1.id AND pa1.question_id = 1
LEFT JOIN user_answer ua2 ON u.id = ua2.user_id 
LEFT JOIN possible_answer pa2 ON ua2.answer_id = pa2.id AND pa2.question_id = 2
GROUP BY u.id; 
```

我得到的结果如下：

```
username  pa1.text  pa2.text
user1     yes       NULL
user2     no        NULL
user3     NULL      blue 
```

当我知道给定用户的两个问题都有条目时。

我`group by`在那里有，因为当我没有时，我`group by`得到了这样的结果（这有点接近预期的结果），但它们似乎没有显示任何类型的模式：

```
username  pa1.text  pa2.text
    user1     yes       NULL
    user1     NULL      red
    user2     no        NULL
    user2     NULL      NULL
    user3     no        NULL
    user3     NULL      blue 
```

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:16:56.553

也许这更接近你的追求......

```
Select UA.User_ID, PA.Question_ID, UA.Answer_ID, PA.Text
FROM Possible_Answer PA
LEFT JOIN user_Answer UA on PA.ID = UA.Answer_ID
ORDER BY PA.Question_ID, UA.User_ID 
```

返回所有可能的答案、任何用户对问题提供的答案以及文本。但它会为每个用户重复问题/答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:24:02.733

如果只有两种可能，你可以使用这个技巧：

```
select ua.user_id,
       min(pa.text) as answer1,
       (case when min(pa.text) <> max(pa.text) then max(pa.text) end) as answer2
from possible_answer pa join
     user_answer ua
     on pa.id = ua.answer_id
group by ua.user_id 
```

这会丢失基于 id 的排序`user_answer`。如果排序很重要，则使用`min(id)`and`max(id)`并返回 to`possible_answer`以获得正确的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:52:24.463

我知道这更像是一种黑客攻击，但也许这可以在动态查询中使用：

```
select z.username, w.text as PA1, x.text as PA2
from user z 
join
    (select a.user_id, b.question_id, b.text, a.answer_id
    from
    user_answer a join possible_answer b on a.answer_id=b.id) as w
    on w.user_id=z.user_id 
    and w.question_id=1

join
    (select a.user_id, b.question_id, b.text, a.answer_id
    from
    user_answer a join possible_answer b on a.answer_id=b.id) as x
    on x.user_id=z.user_id 
    and x.question_id=2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:53:25.147

我正在使用 SQL Server，因此使用 SQL Server 的语法编写查询。但我确信同样的查询也可以在 MySQL 中使用（可能会有一些变化）。

为了获得所需的结果，您需要将行数据转换为列。在 SQL Server 中，您可以使用 CASE 语句（Oracle DECODE，MySQL 不确定，但也可以使用 CASE）

查询是

```
SELECT u.Name, 
MAX(CASE WHEN pa1.QuestionID=1 THEN pa1.Text ELSE NULL END) AS Question1_answer,
MAX(CASE WHEN pa1.QuestionID=2 THEN pa1.Text ELSE NULL END) AS Question2_answer
FROM Users u
LEFT JOIN UserAnswers ua1 ON ua1.UserID=u.ID
LEFT JOIN PossibleAnswers pa1 ON pa1.ID=ua1.AnswerID
GROUP BY u.Name 
```

按名称分组，因为我们希望问题排在一行，所以按名称分组并添加

```
MAX(...) 
```

对于答案列，我们将一个用户的答案分组在一行中

这里是 SqlFiddler 的链接，我尝试在其中创建相同的情况 [http://sqlfiddle.com/#!3/b2357/10](http://sqlfiddle.com/#!3/b2357/10)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-18T16:05:40.117

这就是最终的工作。

```
SELECT DISTINCT u.name,

(SELECT pa1.text FROM possible_answer pa1, user_answer ua WHERE ua1.user_id = u.id AND ua1.answer_id = pa1.id AND pa1.question_id = 1 ORDER BY ua1.id DESC LIMIT 1) as 'Question1',

(SELECT pa2.text FROM possible_answer aa2, user_answer ua2 WHERE ua2.user_id = u.id AND ua2.answer_id = pa2.id AND pa.question_id = 2 ORDER BY ua.id DESC LIMIT 1) as 'Question2'

FROM user u  
GROUP BY u.id; 
```

# vector - 操纵两个向量之间的距离

> ID：14882923
> 
> 赞同：3
> 
> 时间：2013-02-14T19:54:26.160
> 
> 标签：vector, distance

我很难操纵两点之间的距离。

给定 A 和 B 的 xyz 坐标，并知道它们的距离，我怎样才能增加或减少这个距离，保持两点之间的角度？

假设 A 点在 0、0、0 处，B 点在 3、3、0 处。

我能够计算出两点之间的距离为 4.242。

我需要能够在 X 的同一切线上进一步“推动”点 B。有什么想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T20:20:15.933

*   减去`A`from`B`得到表示从to`D`的距离和方向的向量`A``B`

    ```
    D = B - A 
    ```

*   将 D 乘以您的标量`x`，将其从 A 沿同一方向推得更远：（我将您更改`X`为`x`以强调它是一个标量）。

    ```
    D' = xD 
    ```

*   获取与`B'`A 方向相同但距离 B 更远的新点（假设`x > 1`）：

    ```
    B' = A + D' 
    ```

# apache-flex - FlexPrintJob 暂停 Flex 代码执行

> ID：14882927
> 
> 赞同：0
> 
> 时间：2013-02-14T19:54:44.083
> 
> 标签：apache-flex, printing

使用时`FlexPrintJob`，调用后`start()`会出现一个OS系统打印界面，同时Flex代码执行会暂停，一直暂停直到用户完成与OS打印对话框的交互。问题是我确实有来自服务器的数据，并且连接将在一定时间内超时，所以在弹出操作系统打印对话框时是否有任何走动不暂停 Flex 代码执行。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T14:54:04.693

来自文档`FlexPrintJob`：

> 您使用 FlexPrintJob 类打印您专门为打印设置格式的动态呈现文档。

这让我想知道您是否不能（基本上）从包含您的打印作业的浏览器中分出第二页并从那里进行打印。这将使您的原始页面仍在运行。在我的 flex 应用程序中，我通过 PHP 执行此操作（为打印等创建附加页面）。[这里](http://blog.flexexamples.com/2007/08/29/launching-new-browser-windows-from-flex/)的例子。

否则：您应该在开始打印作业之前完成所有服务器数据 d/l 以避免此问题。

Flex 只是最近才开始添加多线程。它正在添加某种工作线程，但这无助于您的要求。

# xml - XSL 从非规范化数据集创建父子层次结构

> ID：14882931
> 
> 赞同：0
> 
> 时间：2013-02-14T19:55:02.333
> 
> 标签：xml, xslt

在这方面需要你的指导。

我正在尝试从非规范化的 XML 创建父子 XML：

从：

```
<Parent>Parent1</Parent>
<Child>Child1</Child>
<Parent>Parent2</Parent>
<Child>Child1</Child>
<Child>Child2</Child>
<Parent>Parent3</Parent>
<Child>Child1</Child> 
```

到：

```
<Parent>
<ParentValue>Parent1</ParentValue>
<Child>
    <ChildValue>Child1</ChildValue>
</Child>
</Parent>
<Parent>
<ParentValue>Parent2</ParentValue>
<Child>
    <ChildValue>Child1</ChildValue>
</Child>
<Child>
    <ChildValue>Child2</ChildValue>
</Child>
</Parent>
<Parent>
<ParentValue>Parent3</ParentValue>
<Child>
    <ChildValue>Child1</ChildValue>
</Child>
</Parent> 
```

问题是我无法弄清楚要在每个父元素之间获取所有子元素的逻辑。

任何帮助表示赞赏。

非常感谢您对此进行调查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:16:38.733

在 XSLT1.0 中，您可以使用密钥来实现这一点。您通过**子**元素的第一个前面的**父**元素有效地对子元素进行分组，因此您可以定义以下键：

```
<xsl:key name="child" match="Child" use="generate-id(preceding-sibling::Parent[1])"/> 
```

然后，在匹配**父**元素的模板中，您可以获得所有关联的**子**元素，如下所示：

```
<xsl:apply-templates select="key('child', generate-id())"/> 
```

在这种情况下，这是完整的 XSLT。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:key name="child" match="Child" use="generate-id(preceding-sibling::Parent[1])"/>

   <xsl:template match="Family">
      <Family>
         <xsl:apply-templates select="Parent"/>
      </Family>
   </xsl:template>

   <xsl:template match="Parent">
      <Parent>
         <ParentValue>
            <xsl:value-of select="."/>
         </ParentValue>
         <xsl:apply-templates select="key('child', generate-id())"/>
      </Parent>
   </xsl:template>

   <xsl:template match="Child">
      <Child>
         <ChildValue>
            <xsl:value-of select="."/>
         </ChildValue>
      </Child>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的 XML 时，将输出以下内容：

```
<Family>
   <Parent>
      <ParentValue>Parent1</ParentValue>
      <Child>
         <ChildValue>Child1</ChildValue>
      </Child>
   </Parent>
   <Parent>
      <ParentValue>Parent2</ParentValue>
      <Child>
         <ChildValue>Child1</ChildValue>
      </Child>
      <Child>
         <ChildValue>Child2</ChildValue>
      </Child>
   </Parent>
   <Parent>
      <ParentValue>Parent3</ParentValue>
      <Child>
         <ChildValue>Child1</ChildValue>
      </Child>
   </Parent>
</Family> 
```

在 XSLT2.0 中，您可以使用**xsl:for-each-group**。在您的情况下，您希望从**Parent**元素开始对元素进行分组。

```
<xsl:for-each-group select="*" group-starting-with="Parent"> 
```

然后选择**子**元素，你可以使用**current-group**函数：

```
<xsl:apply-templates select="current-group()[position() &gt; 1]" /> 
```

这是 2.0 的完整 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="/Family">
     <Family>
      <xsl:for-each-group select="*" group-starting-with="Parent">
         <Parent>
            <ParentValue>
               <xsl:value-of select="."/>
            </ParentValue>
            <xsl:apply-templates select="current-group()[position() &gt; 1]" />
         </Parent>
      </xsl:for-each-group>
     </Family>
   </xsl:template>

   <xsl:template match="Child">
      <Child>
         <ChildValue>
            <xsl:value-of select="."/>
         </ChildValue>
      </Child>
   </xsl:template>
</xsl:stylesheet> 
```

这也应该输出相同的结果：

# javascript - 使用 node.js 服务器欺骗 IP？

> ID：14882936
> 
> 赞同：2
> 
> 时间：2013-02-14T19:55:11.643
> 
> 标签：javascript, node.js

我正在为 Minecraft 服务器编写代理，并希望能够转发原始用户的 IP 地址。问题是，通过“代理”，可以看到代理的 IP。我知道这是代理背后的想法，但我想保留原始发件人的 IP，并将它们转发到另一个 IP。

我当前的代码；

```
var net = require('net');

var sourceport = 25555;
var destport = 25565;

function bufferTrim(buf, trm){
    var len = buf.length;
    return buf.slice(0, len-trm);
}

net.createServer(function(s)
{
    var buff = "";
    var connected = false;
    var cli = net.createConnection(destport);

    s.on('data', function(d) {
        var hex = d.toString('hex').substr(0,2);
        if (connected)
        {
            if (hex == "fe")
            {
                var sName = "Faker";
                var sMaxSlots = "8";
                var sUsedSlots = "0";
                s.write(bufferTrim(new Buffer(String.fromCharCode(0xFF).concat(String.fromCharCode(sName.length + sMaxSlots.length + sUsedSlots.length + 2)).concat(sName).concat(String.fromCharCode(0xA7)).concat(sUsedSlots).concat(String.fromCharCode(0xA7)).concat(sMaxSlots), 'ucs2'), 1));
            } else {
                cli.write(d);
            }
        } else {
            buff += d.toString();
        }
    });

    cli.on('connect', function() {
        connected = true;
        cli.write(buff);
    });
    cli.pipe(s);
}).listen(sourceport); 
```

# eclipse - 如何从无头 RCP 中检索 IFile

> ID：14882939
> 
> 赞同：0
> 
> 时间：2013-02-14T19:55:13.853
> 
> 标签：eclipse, eclipse-plugin, rcp, headless

我有一个无头 RCP 项目。我将一个 xml 文件作为命令行参数传递给该项目。如何从 xml 文件中检索 IFile 信息？

# ruby-on-rails - 玩家中的 Rails NoMethodError#new

> ID：14882947
> 
> 赞同：0
> 
> 时间：2013-02-14T19:55:43.357
> 
> 标签：ruby-on-rails, ruby, forms, erb, nomethoderror

我刚刚使用生成脚手架进行此设置，我立即收到此错误。出于某种原因，它试图将“用户”评估为第 20 行中的一种方法，并且只有用户。它的名称很好，但尽管它们是完全相同的代码（具有不同的名称），但它试图以不同的方式评估第二个代码。

```
undefined method `user' for #<Player:0xb66e4798> 
```

提取的源代码（大约第 20 行）：

```
17:   </div>
18:   <div class="field">
19:     <%= f.label :user %><br />
20:     <%= f.text_field :user %>
21:   </div>
22:   <div class="field">
23:     <%= f.label :password %><br /> 
```

模板包含的痕迹：app/views/players/new.html.erb

由于这是生成的，我自己手动更改的唯一一件事就是路线。所以这是 routes.rb 中我更改了根目录的部分：

```
# root :to => 'welcome#index'
root :to => "players#index" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:03:56.123

你可能`f`这样声明你的表单：`<%= form_for @player do |f| %>`. 然后，当您使用 时`f.text_field`，rails 魔术会尝试将您的符号与`@player`属性之一匹配。

如果`:user`不是 的实例变量`Player`，那么，您需要`FormTagHelper#text_field_tag`：

```
17:   </div>
18:   <div class="field">
19:     <%= f.label :user %><br />
20:     <%= text_field_tag :user %>
21:   </div>
22:   <div class="field">
23:     <%= f.label :password %><br /> 
```

# objective-c - 翻转横向 UIViewController

> ID：14882949
> 
> 赞同：0
> 
> 时间：2013-02-14T19:56:00.157
> 
> 标签：objective-c, uiview, uiviewcontroller, uinavigationcontroller, pushviewcontroller

我的 UIViewController 中有一个按钮，我想在按下按钮时进行翻转交易，我有交易但它是翻转肖像，请你帮帮我！我想把它当作风景

这是我的代码：

```
TestViewController *ctrl = [[TestViewController alloc] init];
[UIView transitionFromView:self.view
                    toView:ctrl.view
                  duration:1
                   options:UIViewAnimationOptionTransitionFlipFromTop
                completion:nil];

[self.navigationController pushViewController:ctrl animated:NO]; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:05:03.943

在任何情况下，你所做的都是非法的。您不能将自己的视图 ( `self.view`) 转换出视图层次结构。要么将 的子视图转换`self.view`为 的不同子视图`self.view`，否则，如果您想使用属于视图控制器的视图，请设置父子系统并正确管理它们（并且通常调用`transitionFromViewController:toViewController:duration:options:animations:completion:`）。

如果您要尝试调用不同视图控制器的视图，请使用执行此操作的方法之一，例如`presentViewController:animated:completion:`.

# templates - EmberJs：将车把助手中的模板渲染到其父元素中

> ID：14882950
> 
> 赞同：1
> 
> 时间：2013-02-14T19:56:11.663
> 
> 标签：templates, ember.js, rendering, handlebars.js

因为我在变量中有视图的名称，所以我使用把手助手来渲染它。

所以，我有一个对象如下（当然都是简化的）

```
config = Ember.Object.create({ view: "MyTplView"}) ; 
```

接下来，我有以下模板

```
<script type="text/x-handlebars" data-template-name="index">
    <div id="container">
        {{helperViewRenderer config}}
    </div>
</script> 
```

和 Handlebars 助手

```
Ember.Handlebars.registerBoundHelper('helperViewRenderer', function(value, options) {
    var template = App[value.view].create() ;
    template.appendTo("#container") ;
}) ; 
```

问题是我尝试将模板插入到 id 为“container”的元素中，该元素当时不存在。解决此问题的可能性是什么。例如，是否可以从模板中获取 HTML 字符串并返回它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T03:48:19.813

我偶尔发现在父视图类中定义子视图类而不是全局视图类很有价值。您可以将任何路径（全局或本地）传递给`view`帮助程序，并且当前视图`view`在当前上下文中可用。因此，

```
App.ParentView = Ember.View.extend({
  template: Ember.Handlebars.compile("The parent's child: {{view view.ChildView}}."),

  ChildView: Ember.View.extend({
    template: Ember.Handlebars.compile("-- child view --")
  })
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:19:24.713

Ember 试图通过使用新路由器来创建“出口”。

如果您想使用该`appendTo`方法，那么显然您必须将您的模板附加到现有的 HTML 元素中。这样，您无法从模板中获取 HTML 字符串（除非您知道它是父模板的一部分）。但是，如果您不太在意插入模板的位置，则可以使用直线`append`将模板添加到正文的末尾。

我认为在您的情况下，最好熟悉路由器，因为您似乎希望在同一个主模板中呈现不同的模板。因此，您可以通过将 URL 用作变量并将相关视图注入到插座中来轻松地将它们分开。

```
App.Router.map(function () {
  this.route("index", { path: "/" });
  this.route("first", { path: "/view1" });
  this.route("another", { path: "/view2" });
});

App.FirstRoute = Em.Route.extend({
  renderTemplate: function () {
    this.render('view1', { outlet: 'main' });
  }
});

App.AnotherRoute = Em.Route.extend({
  renderTemplate: function () {
    this.render('view2', { outlet: 'main' });
  }
}); 
```

看法：

```
<script type="text/x-handlebars" data-template-name="index">
    <div id="container">
        {{outlet main}}
    </div>
</script> 
```

这样，您就不需要任何把手助手传递变量，并且所有这些都整齐地包含在 Ember 约定中。

# php - 功能没有反应

> ID：14882953
> 
> 赞同：0
> 
> 时间：2013-02-14T19:56:22.633
> 
> 标签：php, javascript, html, input

我需要帮助来编写接下来要做的代码。

我在一侧有数字，当我单击它们（它们充当链接）时，它们被添加到输入框中（在同一个文档中，每个数字都有特定的框）。然后我有一个函数可以读取该框中的内容，使用该值并进行一些计算，然后将其显示在同一页面上-无需刷新。当我手动写数字时一切顺利，但是当我使用函数时

```
function addTextTagF(text){
    document.getElementById('text_tag_inputF').value += text;
} 
```

什么都没发生！我需要让它以某种方式做出反应，请帮助我。

其他使用的功能：

```
function preview_kopins(currency)
{
    var rate = 0.0025;
    var food = window.document.frm.food.value;

    food = food * rate;

    total = food;

    if(isNaN(total))
        total = "0";

    document.getElementById("pkopins").innerHTML = total + " " + currency;
} 
```

另一个

```
<input type="text" id="text_tag_inputF" name="food" size="5" value="" 
    onchange="preview_kopins('<?php echo CURRENCY_NAME ?>');" 
    onkeypress="preview_kopins('<?php echo CURRENCY_NAME ?>');" 
    onpaste="preview_kopins('<?php echo CURRENCY_NAME ?>');" 
    oninput="preview_kopins('<?php echo CURRENCY_NAME ?>');" >

<a href="#" 
    onClick="addTextTagF('<?php echo floor($fcapacity); ?>'); return false">
      <?php echo floor($fcapacity); ?></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:07:37.400

根据我的理解，您想将数字添加到当前的`text_tag_inputF`?

尝试：

```
function addTextTagF(text){
    document.getElementById('text_tag_inputF').value = document.getElementById('text_tag_inputF').value + parseInt(text);
} 
```

# asp.net - 如何在 asp.net mvc 3 中通过 userId 获取个人资料信息？

> ID：14882955
> 
> 赞同：0
> 
> 时间：2013-02-14T19:56:23.590
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-membership

我想实现用户配置文件，以便其他用户能够看到它。

如何通过 asp.net mvc3 中的 id 获取特定用户的个人资料信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:23:53.183

这是（简而言之）实现默认配置文件提供程序的方式。

在您的 web.config 中，添加

```
<profile>
      <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider"
             type="System.Web.Profile.SqlProfileProvider"
             connectionStringName="ApplicationServices" 
             <!--same connection string as the membership provider-->
             applicationName="/"/>
      </providers>
      <properties>
        <add name="FirstName" type="string"/>
        <add name="LastName" type="string"/>
        <!--...or whatever profile properties you want/need-->
      </properties>
    </profile> 
```

然后您可以为配置文件属性分配值

```
ProfileBase profile = ProfileBase.Create(userName);
profile["FirstName"] = "John";
profile["LastName"] = "Smith"; 
```

并读取值

```
string firstName;
string lastName;
ProfileBase profile = ProfileBase.Create(userName);
firstName = profile["FirstName"] as string,
lastName = profile["LastName"] as string, 
```

# ruby-on-rails - 运行 remove_column 在 Rails 迁移中不起作用

> ID：14882958
> 
> 赞同：1
> 
> 时间：2013-02-14T19:56:43.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rake, migrate

我有一个非常简单的迁移：

```
class RemoveAuthorIdFromBooks < ActiveRecord::Migration
  def change
    remove_column :books, :author_id
  end

end 
```

但我收到以下错误：

```
Mysql2::Error: Error on rename of './mysite_staging/#sql-3b1_3c78' to './mysite_staging/books' (errno: 150): ALTER TABLE `books` DROP `author_id` 
```

这是表的描述：

```
+------------------+---------------+------+-----+---------+----------------+
| Field            | Type          | Null | Key | Default | Extra          |
+------------------+---------------+------+-----+---------+----------------+
| id               | int(11)       | NO   | PRI | NULL    | auto_increment |
| author_id        | int(11)       | NO   | MUL | NULL    |                |
| title            | varchar(255)  | NO   |     | NULL    |                |
| teaser           | varchar(500)  | NO   |     | NULL    |                |
| description      | varchar(2000) | YES  |     | NULL    |                |
| cover_image      | varchar(255)  | NO   |     | NULL    |                |
| publication_date | date          | NO   |     | NULL    |                |
| enabled          | tinyint(1)    | NO   |     | 1       |                |
| created_at       | datetime      | NO   |     | NULL    |                |
| updated_at       | datetime      | NO   |     | NULL    |                |
| excerpt          | text          | YES  |     | NULL    |                |
| featured         | tinyint(1)    | YES  |     | NULL    |                |
| site_id          | int(11)       | YES  |     | NULL    |                |
+------------------+---------------+------+-----+---------+----------------+ 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-02-19T07:12:32.607

如果有人仍然面临 Rails 4 及更高版本的问题，那么您可以执行以下操作

> remove_reference(:books, :author, index: true, foreign_key: true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:41:48.773

由于某种原因，外键约束破坏了 drop 语句。

我做了以下事情：

```
show create table books; 
```

查看了外键名称，然后：

```
alter table books drop foreign key books_ibfk_1; 
```

然后 rake db:migrate 工作。

# html - ie 7-8 不支持对象标签？

> ID：14882967
> 
> 赞同：0
> 
> 时间：2013-02-14T19:57:22.223
> 
> 标签：html, internet-explorer, internet-explorer-8, internet-explorer-7

我在单独的 html 文件中创建了网站的页眉和页脚，并将这些文件嵌入到我的网页中。

经过所有艰苦的工作并完成了网站，我在 IE8 中遇到了一个错误。我的页眉和页脚在 IE7 和 8 中到处都是对齐的。

```
<footer>
    <div id="divObjFooter">
        <object data="/footer.html" type="text/html">
            &nbsp;
        </object>
    </div>
</footer> 
```

**更新 - 为运行 html5 的任何版本修复** 终于找到了一种支持即任何版本的方法。

```
<!--[if IE]>
            <div id="footer">
                <div id="divObjFooter">
                    <iframe src="footer.html">&nbsp;</iframe>
                </div>
            </div>
        <![endif]-->

        <![if !IE]>     
            <footer>
                <div id="divObjFooter">
                    <object data="footer.html" type="text/html">&nbsp;</object>
                </div>
            </footer>
        <![endif]> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:43:38.637

ie8 和更早版本不支持 HTML5 标记（在您的情况下是`<footer>`标记），因此不要设置它们的样式。为了解决这个问题，您可以简单地使用`div`带有 id 的 's 并从那里设置样式，或者，如果您想使用最新最好的 HTML5 东西，您可以使用 html5 shiv。

我会推荐托管在 Google 代码上的脚本： [https ://code.google.com/p/html5shiv/](https://code.google.com/p/html5shiv/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:47:26.997

在针对目标受众使用新标签和选择器之前，请检查网站[Can I Use](http://caniuse.com/)是否支持浏览器。`HTML5``CSS3`

IE<10 支持很少（少于 40%）现代 html 和 css。您可能不得不使用modernizr 或类似的东西，或者根本不使用最新的“闪亮”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:03:11.003

首先回答标题中的问题：IE`object`从 IE 4 开始就支持该元素（尽管早期的实现很糟糕）。你的问题似乎不在于那个元素，而是你的`footer`元素样式——一个完全不同的问题。

IE 7 和 IE 8 不支持该`footer`元素。这无关紧要，因为默认效果只是使元素内容成为一个块，而您的内容已经是一个块（一个`div`元素）。`footer`导致问题的原因是您有一些在元素上设置属性的 CSS 规则。这在 IE 7-8 上不起作用，因为即使在让您设置样式的意义上，它们也无法识别元素。

有一个快速解决方法：将以下内容放在您的第一个样式表或对任何样式表的引用之前：

```
<script>document.createElement('footer')</script> 
```

这实际上是许多“shims”或“polyfills”或任何你称之为它们的东西正在做的事情，如果你只有一个问题`footer`，你可以只使用快速修复。

`div`或者，使用选择器在内部设置 CSS 规则`#divObjFooter`。

PS 使用`object`（或`iframe`）包含页脚是可能的，但很笨拙。它将在文档窗口的子窗口中包含一个 HTML 文件，并且链接将无法正常工作等。如果可能，最好使用服务器端工具，如服务器端包含 (SSI) 或更高级的对应工具，或页面管理软件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T00:02:14.370

```
<!--[if IE]>
        <div id="footer">
            <div id="divObjFooter">
                <iframe src="footer.html">&nbsp;</iframe>
            </div>
        </div>
    <![endif]-->

    <![if !IE]>     
        <footer>
            <div id="divObjFooter">
                <object data="footer.html" type="text/html">&nbsp;</object>
            </div>
        </footer>
    <![endif]> 
```

# ajax - 通用 jQuery AJAX 插件？

> ID：14882968
> 
> 赞同：-3
> 
> 时间：2013-02-14T19:57:28.000
> 
> 标签：ajax, jquery, post

我正在编写一个包含公共站点和管理站点的大型 Web 应用程序。我使用了很多 jQuery 和 ajax，我遇到了一些问题。

当涉及到 ajax 时，我发现自己重复了很多代码。例如，单击一个按钮可以导致 3-4 次单独的 ajax 调用。这些调用中的每一个都使用几乎相同的 jQuery 代码。

我正在寻找可以处理大多数（如果不是所有）ajax 调用的插件或 js/jQuery 函数。这里有人知道这样的插件/功能吗？如果是这样，请告诉。

提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:07:47.463

只需为常见操作创建一个全局点击处理程序，并将请求数据包含在标签本身上。例如，

```
<a class="loadcontent" href="/page1.html", data-target="#content">Page 1</a>
<a class="loadcontent" href="/page2.html", data-target="#content">Page 2</a>
<a class="loadcontent" href="/page3.html", data-target="#content">Page 3</a>

... somewhere else...
<a class="loadcontent" href="/foo/bar/somepage.html", data-target="#sub-content">Some other page</a> 
```

现在您可以使用一个事件来处理它们：

```
$(document).on("click","a.loadcontent",function(e){
    e.preventDefault();
    $( $(this).data("target") ).load(this.href + " " + $(this).data("target"));
}); 
```

您可以以相同的方式使用更高级的操作进行类似的整合，从而允许您为应用程序的不同区域重复使用相同的事件处理程序。

```
<a href="/delete.php" data-entity-type="Person" data-entity-id="7363" class="delete">Delete Person</a> 
```

和

```
$(document).on("click","a.delete",function(e){
    e.preventDefault();
    if (confirm("Are you sure you wish to delete this record?") == false) return;
    var $this = $(this), $data = $this.data();
    $.post(this.href,{entityType: $data.entityType, entityId: $data.entityId},"json")
        .done(function(data){
            if (data.result == "success") {
                $this.closest($data.parentSelector).remove();
            }
        });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:52:12.577

jquery Promise 对 ajax 回调链接和提高代码重用和可读性有很大帮助。查看 jquery 文档以获取更多信息（[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)和[http://api.jquery.com/promise/](http://api.jquery.com/promise/)）。

这是一个可能有助于解释的例子。

```
 //-----------functions for rendering ajax responses
        function onError(){
           $("#errorMessage").text("opps!");
        }

        function displayInfo(data){
           $("#infoMessage").text(data);
        }

        function displayOtherInfo(data){
           $("#otherInfoMessage").text(data);
        }
        // ---------- end rendering functions ---------------

        //-----------functions for building ajax promises
        function getInfo(){
           buildAjaxPromise("InfoUrl", "data") //returns a promise that gets an ajax response from InfoUrl
             .done(displayInfo) //when the ajax completes call displayInfo
             .fail(onError);    //if something goes wrong call onError
        }

        function getOtherInfo(){
           buildAjaxPromise("OtherInfoUrl", "otherData")  //returns a promise that gets an ajax response from InfoOtherUrl
             .done(displayOtherInfo)  //when the ajax completes call displayInfo
             .fail(onError);          //if something goes wrong call onError
        }
        //-------------- end ajax promises -----------------

        //builds a jquery ajax promise
        function buildAjaxPromise(_url, _data){
           return $.ajax({ url: _url, data: _data, type:"GET", dataType:"json", contentType:"application/json; charset=utf-8"});
        }

        //start ajax calls
        getInfo();
        getOtherInfo(); 
```

# javascript - 为什么我的功能适用于复选框而不是收音机？

> ID：14882971
> 
> 赞同：0
> 
> 时间：2013-02-14T19:57:44.403
> 
> 标签：javascript, checkbox, radio

我正在使用一个函数来显示多个选中的复选框和收音机 onClick 收音机。不幸的是，该功能仅在触发输入是复选框时才有效。我需要它是一台收音机。我怎样才能改变我的功能来为收音机工作？

这是我的脚本：

```
<script>
$(function() {
  enable_cb();
  $("#groupa").click(enable_cb);
});

function enable_cb() {
  if (this.checked) {
     $("input.groupa").prop("checked", this.checked);
  } else {
     $("input.groupa").removeAttr("checked");

  }
}
</script> 
```

这是我的html：

```
<input type="radio" id="groupa" checked="checked">Group A<br />
<input type="checkbox" class="groupa"> A<br />
<input type="radio" class="groupa"> B<br />
<input type="checkbox" class="groupa"> C<br />
<input type="radio" class="groupa"> D<br />
<input type="checkbox" class="groupa"> E<br /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:04:32.340

```
function enable_cb() {

    if( $(this).is(':checked') ) 
    {
         $("input.groupa").attr("checked",'checked');
    } 
    else {
        $("input.groupa").removeAttr("checked");

    }

} 
```

# html - div 触摸浏览器的左右端

> ID：14882977
> 
> 赞同：0
> 
> 时间：2013-02-14T19:58:01.713
> 
> 标签：html, css, css-float

如何将 defie div 向左移动，将销售订单 div 向右移动......我给了 float 属性但没有工作......我希望一个 div 触摸到极左，另一个 div 移动到右边...... .在下面提供我的代码.....

[http://jsfiddle.net/zbyLy/3/embedded/result/](http://jsfiddle.net/zbyLy/3/embedded/result/)

```
<div style="padding-left: 41px; padding-top: 10px; float:left;">
            <a class="" href="#">
              <img alt="change" class="defieLogo" src="http://www.defie.co/designerImages/defie_logo_only.png">
            </a>
            <p style="margin-top: 5px; margin-bottom: 0px;">47657 Lakeview Blvd, Fremont CA 94538</p>
            <p>Tel: 510-657-8981 <span style="padding-left: 18px;">wwww.abcdfg.com</span></p>
      </div>

      <div style="border: 1px solid red; width: 300px; float:left;">
        <p style="color: #14486b; font-size: 18px; font-family: arial; font-wieght: bold; ">Sales Order</p>
        <p style=>Customer No. ABC01</p>
        <p style=>sales Order No. 100001</p>
        <p style=>Est. Ship Date 2/24/2013</p>
      </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:00:12.047

```
<div style="border: 1px solid red; width: 300px; float:right;"> 
```

**演示：http: [//jsfiddle.net/zbyLy/](http://jsfiddle.net/zbyLy/)**

# php - 在 OS X PHP 5.3.19 上安装 ZendDebugger.so

> ID：14882981
> 
> 赞同：0
> 
> 时间：2013-02-14T19:58:22.827
> 
> 标签：php, macos, zend-studio

我正在尝试在 OS X Mountain Lion 上的自定义（自制）PHP 5.3.19 安装中加载 ZendDebugger.so 扩展，我得到的是：

```
Failed loading /path/to/php/extensions/ZendDebugger.so:  dlopen(/path/to/php/extensions/ZendDebugger.so, 9): Symbol not found: _executor_globals
  Referenced from: /path/to/php/extensions/ZendDebugger.so
  Expected in: flat namespace 
```

这就是我从 php -m、php -v 和 error_log 中得到的。

这不是架构错误，因为我使用的是 64 位（并在百灵鸟上尝试了 32 位），而且我在网上找不到有这个问题的人。它只是PHP版本吗？缺少一些编译标志？我想不通。

编辑：ZendDebugger.so 下载自：[http](http://www.zend.com/en/products/studio/downloads) : //www.zend.com/en/products/studio/downloads 并使用 5.3.x 版本。

# filter - Laravel，路由通配符过滤然后控制器

> ID：14882985
> 
> 赞同：5
> 
> 时间：2013-02-14T19:58:34.590
> 
> 标签：filter, controller, wildcard, laravel, routes

我正在尝试从 URL 捕获通配符，然后首先将其传递给过滤器，然后路由到控制器。我不确定如何准确地绘制问题，但这是我迄今为止尝试过的。

```
Route::get('test/(:any?)', array('as' => 'testroute', 'uses' => 'test@result', 'before' => "test_filter:$1"));

Route::filter('test_filter', function($id = NULL)
{
    if($id)
    echo "This id is " . $id;    // Prints "This id is $1"
}); 
```

和

```
Route::get('test/(:any?)', array('as' => 'testroute', function($id = NULL)
{
    if($id)
        echo "this id is " . $id;    // Does not do anything
}, 'uses' => 'test@result')); 
```

基本上，我想检查是否有一个 id 附加到 URL 并设置一个 cookie，如果有的话。但不管是哪种情况，无论是否附加了任何 id，我都希望该路由由控制器处理。

我必须对这么多路由做同样的事情，所以我更喜欢过滤器之类的东西，而不是修改控制器的代码。

我知道我可以直接将通配符元素传递给闭包，或者我可以将其作为参数提供给任何控制器，但在这种情况下，我将不得不修改控制器代码，目前我不能。

我可以通过过滤器做到这一点吗？或者我不必修改控制器代码的任何其他方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:19:34.457

尝试在之前传递匿名

```
Route::get('test/(:any?)',
    array(
       'as' => 'testroute',
       'uses' => 'test@result',
       'before' => "test_filter",
       function($my_cookie_value)
       {
          // Set cookie here
       }
    )
 ); 
```

取自[这里](http://laravel.com/docs/routing#filters)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T11:27:59.387

我会使用中间件[http://laravel.com/docs/5.1/middleware](http://laravel.com/docs/5.1/middleware)（或过滤旧 Laravel 版本）并将 route/s 添加到具有中间件的组中，如您在此处看到的[http:// laravel.com/docs/5.1/routing#route-group-middleware](http://laravel.com/docs/5.1/routing#route-group-middleware)。

中间件将在路由代码之前执行，您可以在其中添加逻辑来管理您的 cookie。

# java - 从具有相同值的数组中获取元素的子集

> ID：14882990
> 
> 赞同：1
> 
> 时间：2013-02-14T19:58:49.810
> 
> 标签：java

是否有任何集合 API 方法可以从数组或集合中提取相同的元素？

例如 SomeClass.getElements("Test") 应该返回包含值为“Test”的元素的数组的子集。

问这个问题的原因是因为我想避免自己的遍历和条件检查。

问候，
**苏达卡尔**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:17:09.190

正如评论中提到的，（目前）没有简单的方法可以做到这一点。您可以做的最好的事情是类似于[http://docs.oracle.com/javase/6/docs/api/java/io/FilenameFilter.html](http://docs.oracle.com/javase/6/docs/api/java/io/FilenameFilter.html)，您可以在其中创建一个在迭代时接受元素的接口。

或者，您可以执行以下操作：[过滤 Java 集合的最佳方法是什么？](https://stackoverflow.com/questions/122105/java-what-is-the-best-way-to-filter-a-collection)，它将您带入函数式编程的领域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:24:31.897

如果您使用[Apache 集合 api](http://commons.apache.org/collections/api/)，您可以执行以下操作：

```
Predicate predicate = PredicateUtils.equalPredicate("Test");
Collection result = CollectionUtils.find(someCollection, predicate); 
```

# arrays - 其中哪一个是正确的 JSON 键控数组？

> ID：14882991
> 
> 赞同：0
> 
> 时间：2013-02-14T19:58:52.177
> 
> 标签：arrays, json, syntax

我正在尝试编写代码以使用 RESTful 3rd 方 API，该 API 定义了一个以 JSON 形式侦听“键控小部件数组”的端点。如果单个“小部件”具有正确的 JSON 格式：

```
"widget": {
    "fizz": "true",
    "buzz": "45",
    "foo": "Always"
} 
```

然后我问：以下哪一项正确表示“小部件的键控数组”（术语*键控数组*来自 API 文档），**为什么？！？**或者，如果它们都不正确，那么正确的“键控小部件数组”是什么？请注意，所有示例都是每个仅包含 1 个小部件的数组；为了这个问题，这很好。

```
#1
"widgets": {
    widget_1: {
        "fizz": "true",
        "buzz": "45",
        "foo": "Always"
    }
}

#2
"widgets":[
    {
        "fizz": "true",
        "buzz": "45",
        "foo": "Always"
    }
]

#3
"widgets": [
    widget_1: {
        "fizz": "true",
        "buzz": "45",
        "foo": "Always"
    }
] 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:04:13.897

我会称#1 为小部件集合，#2 为匿名小部件数组，我猜#3 看起来确实像“键控小部件数组”。至于为什么，它是一个数组（方括号），每个小部件都用一个键存储。

# javascript - 如何在 AudioBufferSourceNode 中设置循环以精确匹配底层缓冲区中的特定偏移量？

> ID：14882994
> 
> 赞同：1
> 
> 时间：2013-02-14T19:59:01.127
> 
> 标签：javascript, html, html5-audio, web-audio-api

使用 AudioBufferSourceNode 创建声音时，我可以设置偏移量和持续时间（以秒为单位）。

我有样本位置的偏移量和持续时间，我想我必须将其转换为时间，但我不知道从哪里开始。是否有可能获得精确匹配？

在早期版本的 web-api 中似乎有样本偏移量和长度，但没有更多。

从文档中：（[w3c](https://dvcs.w3.org/hg/audio/raw-file/tip/webaudio/specification.html#AudioBuffer)）

> 请注意，作为低级实现细节，AudioBuffer 处于特定的采样率（通常与 AudioContext 采样率相同），并且循环时间（以秒为单位）必须转换为适当的采样帧根据此采样率在缓冲区中的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:16:31.873

匹配应该是精确的，只需将您的采样位置除以采样率，

`second_offset = sample_offset / sample_rate`

和

`second_duration = sample_duration / sample_rate`

# c++ - 声明一个引用并稍后初始化？

> ID：14882995
> 
> 赞同：85
> 
> 时间：2013-02-14T19:59:02.117
> 
> 标签：c++, reference

我有一些类的引用`MyObject`，但确切的对象取决于条件。我想做这样的事情：

```
MyObject& ref; 
if([condition]) 
  ref = MyObject([something]);
else 
  ref = MyObject([something else]); 
```

我现在不能这样做，因为编译器不允许我声明但不能初始化引用。我能做些什么来实现我的目标？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-02-14T20:03:05.497

你需要初始化它。但是如果你想有条件地初始化它，你可以这样做：

```
MyObject& ref = (condition) ? MyObject([something]) : MyObject([something else]); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-02-14T22:15:07.803

AFAIK 这不能通过参考来完成。您必须使用指针：

```
MyClass *ptr;

if (condition)
    ptr = &object;
else
    ptr = &other_object; 
```

指针的作用类似于引用。只是不要忘记`->`用于会员访问。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-02-14T20:30:24.267

你不能这样做。引用必须绑定到某个东西，你可能不喜欢它，但它可以防止一整类错误，因为如果你有一个引用，你总是可以假设它绑定到某个东西，不像指针可能为空。

您的示例代码无论如何都不起作用，因为您尝试将非常量引用绑定到无效的临时对象。

为什么你需要它作为参考呢？一种解决方案是确保您的类型具有廉价的默认构造函数并且可以有效地移动，然后只需执行以下操作：

```
MyObject obj; 
if([condition]) 
  obj = MyObject([something]) 
else 
  obj = MyObject([something else]); 
```

否则，您必须将条件代码放在一个或多个函数中，或者：

```
const MyObject& ref = createObject([condition]); 
```

或者

```
const MyObject& ref = [condition] ? doSomething() : doSomethingElse(); 
```

请注意，这两个版本都使用*const*引用，它可以绑定到临时对象，如果对象必须是非常量，则再次停止尝试使用引用：

```
MyObject obj = createObject([condition]); 
```

[由于返回值优化](http://en.wikipedia.org/wiki/Return_value_optimization)，这可能与您尝试做的一样有效

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2018-06-18T12:23:37.890

我喜欢做的是立即执行的 lambda。

假设我们想要一个**const std::string&**到映射下的变量 - 如果映射不包含给定的键 - 我们想要抛出。

```
int main()
{
  std::map<std::string, std::string> myMap = {{"key", "value"}};

  const std::string& strRef = [&]()->const std::string& {
    try {
      return myMap.at("key"); // map::at might throw out_of_range
    }
    catch (...) {
      // handle it somehow and/or rethrow.
    }
  }(); // <- here we immediately call just created lambda.
} 
```

* * *

您还可以使用**std::invoke()**使其更具可读性（C++17 起）

```
int main()
{
  std::map<std::string, std::string> myMap = {{"key", "value"}};

  const std::string& strRef = std::invoke([&]()->const std::string& {
    try {
      return myMap.at("key"); // map::at might throw out_of_range
    }
    catch (...) {
      // handle it somehow and/or rethrow.
    }
  });
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-02-14T20:00:00.940

在 C++ 中，您不能在没有初始化的情况下声明引用。您必须对其进行初始化。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-02-14T20:12:03.477

简短的回答：你没有。

稍微长一点的答案：做这样的事情：

```
MyObject& getObject()
{
    if([condition]) 
        return [something] 
    else 
        return [something else];
}

MyObject& ref = getObject(); 
```

当然，关于参考的通常免责声明也适用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-03-27T22:59:43.143

```
MyClass *ptr;

if (condition)
    ptr = &object;
else
    ptr = &other_object;

MyClass &ref = *ptr; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2022-02-24T03:01:35.837

使用静态假人作为占位符。或 std::optional 与 reference_wrapper。

```
static X placeHolder_;
std::reference_wrapper<X> ref = placeHolder_;

std::optional<std::reference_wrapper<X>> ref ; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-01T17:45:54.220

我通常这样做（C++ 11 或更高版本）：

```
std::shared_ptr<ObjType> pObj;
if(condition)
    pObj = std::make_shared<ObjType>(args_to_constructor_1);
else
    pObj = std::make_shared<ObjType>(args_to_constructor_2); 
```

这是干净的，并且允许使用具有（可能不同的）构造的对象定义，这是您不能直接使用指针做的事情，因为编译器会抱怨使用临时对象。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-05-13T22:49:07.977

if([条件]) MyObject& ref = MyObject([something]); else MyObject& ref= MyObject([something else]);

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2021-06-25T09:39:18.133

您可以使用在实际使用之前不需要初始化的模板。

```
 template <uint8_t c>
  uint8_t& ref; 
void setup()
{
  uint8_t a=1;
  uint8_t b=2;
if(true) 
  ref<1> = a;
else 
  ref<1> = b;
} 
```

一些旧的 IDE 可能会将其标记为错误，但它会很好地通过编译。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2017-04-21T14:37:48.483

您可以使用“extern”关键字：第一次（假设在头文件中）您可以使用“extern”关键字在声明之前声明变量。稍后（在源文件中）您重复声明而不使用“extern”并为其赋值。

# cross-compiling - 如何让 Qt5 ./configure 找到我交叉编译的 OpenSSL 库？

> ID：14882996
> 
> 赞同：1
> 
> 时间：2013-02-14T19:59:04.557
> 
> 标签：cross-compiling, qt5, pkg-config, mingw-w64

我正在尝试使用 Mingw-w64 的 32 位编译器交叉编译 Qt5。主机平台是 Ubuntu 12.10 64 位，目标平台是 32 位 Windows。我已经设法交叉编译 OpenSSL 库并将交叉编译的二进制文件/库/包含安装到`~/i686-w64-mingw32`.

当我尝试配置 Qt 时，问题浮出水面。我正在使用以下命令：

```
PKG_CONFIG_PATH=~/i686-w64-mingw32/lib/pkgconfig ./configure -prefix \
  ~/i686-w64-mingw32 -opensource -confirm-license -release -nomake 演示 \
  -nomake 示例 -xplatform win32-g++ -device-option \
  CROSS_COMPILE=i686-w64-mingw32-
```

二进制文件为主机平台成功编译，`qmake`并显示所有启用功能的列表：

```
...
ODBC 支持............插件
SQLite 支持 ......... 插件 (qt)
OpenSSL 支持........没有
```

这里发生了什么？似乎 Qt 无法找到 OpenSSL 包含的内容。在配置过程中打开`-v`标志可以确认这一点 - 我收到一些关于无法找到的错误`openssl/opensslv.h`。

所以我的下一步是确认这`pkg-config`确实有效：

```
PKG_CONFIG_PATH=~/i686-w64-mingw32/lib/pkgconfig pkg-config --libs openssl
```

它似乎是：

```
-L/home/nathan/i686-w64-mingw32/lib -lssl -lcrypto
```

那么如何让 Qt 相信我有可用的 OpenSSL 库呢？我已经尝试过`-force-pkg-config`国旗，但没有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-16T05:19:24.710

在 Freenode 的频道中询问后`#qt`，我终于想出了一个可行的解决方案。

我需要将编译器选项直接传递`./configure`给. 所以命令看起来像这样：`pkg-config``./configure`

```
./configure <...> -I~/i686-w64-mingw32/include
```

然后编译器能够找到标头并启用运行时 OpenSSL 支持。

# java - 在 Java 序列化中，为什么 J 表示 long 而 L 表示 Object？

> ID：14882998
> 
> 赞同：9
> 
> 时间：2013-02-14T19:59:07.407
> 
> 标签：java, oop, serialization

当你在 Java 中序列化一个对象时，字母 J 用于表示下一个字节代表 a `long`，字母 L 用于表示`Object`下一个，但为什么呢？为什么不使用 O for`Object`和 L for `long`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T20:38:31.493

这些字母肯定是因为冲突而被选中的。对这种冲突的猜测：

*   **C**被用于**char**。因此，他们将**L**用于**class**。

*   **L**被带去**上课**。因此，他们**长期**使用**J**。

***   **B**被当作**byte**。因此，他们使用**Z**表示**boolean**。** 

 **顺便说一句，' **L** ' 不是指' **Object** '，而是' **fully-qualified-class** '。**