# StackOverflow 问答 14083000-14083999

# jquery - jQuery点击添加类，点击其他地方删除

> ID：14083000
> 
> 赞同：1
> 
> 时间：2012-12-29T15:14:16.877
> 
> 标签：jquery, click, addclass

在任何地方都找不到答案，但基本上我想在单击时向锚点添加一个“活动”链接，然后在单击另一个锚点时将其删除。这些锚点是哈希href，而不是真正的链接，因为它们充当过滤器。

这是我到目前为止所拥有的：

```
$('.section-filters a').click(function () {
        $(this).addClass('active');
        var selector = $(this).attr('data-filter');
        $container.isotope({
            filter: selector
        });
        return false;
}); 
```

有什么帮助吗？

谢谢，R

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:15:32.347

你可以使用`removeClass`方法。

```
$('.section-filters a').click(function (event) {
    $('a.active').removeClass('active');
    var $this = $(this);
    $this.addClass('active');
    var selector = $this.attr('data-filter');

    $container.isotope({
         filter: selector
    });
    return false; // event.preventDefault()
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:25:29.333

记住变量中的最后一个活动并以这种方式执行例如：

```
$( '.section-filters' ).each( function() {
    var $active = $();

    $( 'a', $( this ) ).on( 'click', function() {
        $active.toggleClass( 'active' );

        $active = $( this );

        $active.toggleClass( 'active' );

        $container.isotope( {
            filter: $active.attr( 'data-filter' )
        } );
        return false;
    } );

} ); 
```

# c# - GridView 中的数据未正确显示

> ID：14083007
> 
> 赞同：2
> 
> 时间：2012-12-29T15:15:04.803
> 
> 标签：c#, datagridview

我正在使用显示 datagridview

```
dataGridView1.DataSource = dv; 
```

当显示 dgv 时，只有左上角的单元格具有可见值。但是，当我单击其他单元格时，该单元格中的数据变得可见。

任何想法为什么会发生这种情况。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:25:31.180

通常的绑定方式是

```
 SqlDataAdapter dataadapter = new SqlDataAdapter();
    DataSet ds = new DataSet();
    conn.Open();
    dataadapter.Fill(ds, "Your table name");
    conn.Close() ;
    DataGridView1.DataSource = ds;
    DataGridView1.DataMember = "Your table name"; 
```

如果这不起作用，请发布更多代码。

# css - CSS 中间图片

> ID：14083009
> 
> 赞同：0
> 
> 时间：2012-12-29T15:15:09.913
> 
> 标签：css, center, vertical-alignment

这是我的代码。请帮助使其居中居中，并且所有图像尺寸都不相同

***CSS：***

```
body {
   margin: 0px;
}

.wrapper {
   text-align:center;
   width: 100%;
   height: 100%;
   position: relative;
   z-index: 21
}

.wrapper img {
   display: table-cell;
   vertical-align: middle; 
} 
```

***HTML：***

```
<div class="wrapper">
  <img src="http://static.desktopnexus.com/thumbnails/196734-bigthumbnail.jpg" />
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:03:57.123

您只需要在图像上设置边距。

```
.wrapper img {
    margin: auto;
} 
```

此方法可用于任何对象，但请确保父对象设置了宽度或高度。

# python - python中的预期字符串或缓冲区

> ID：14083010
> 
> 赞同：0
> 
> 时间：2012-12-29T15:15:14.047
> 
> 标签：python

我有这个：

```
fin = open(blah)
fin_lower= fin.readlines()
lines = [fin_lower.lower() for line in fin]
lines = line.split() 
```

它给：

```
TypeError: expected string or buffer 
```

readlines 有错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:18:53.453

[readlines](http://docs.python.org/2/tutorial/inputoutput.html)返回一个包含所有数据行的列表，看起来你有一个错误，你可能想要这样做：

```
lines = [line.lower() for line in fin_lower] 
```

您的代码也在混合变量，通过它迈出良好的一步，您要完成什么？你似乎混和`line`一堆`lines`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:22:12.403

`re.sub`需要一个字符串作为第三个参数，你给它`lines`的是一个列表。此外，您在`fin`使用`readlines`. 您似乎正在尝试这样做：

```
with open(blah) as fin:
    lines = [line.lower().replace(',', '').split() for line in fin] 
```

另请注意，您不需要`re`进行文字替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:06:04.737

我同意巴泰克

我能够完成这项工作。

```
import os
import signal
import time
import sys
import re
import string

fin = open('blah','r')
fin_lower= fin.readlines()

lines=""

for line in fin_lower:
lines += line.lower()

line = re.sub(';',' ',lines)
lines = line.split()
print lines 
```

文件 blah 的初始内容

维沙尔；希亚拉尼；诺诺; 完成；

最终输出

['vishal', 'khialani', 'nonoe', 'cangetitdone']

# javascript - 使用 JS 保存 XML 文件或使用 JS 将 TXT 转换为 XML？

> ID：14083014
> 
> 赞同：1
> 
> 时间：2012-12-29T15:15:33.173
> 
> 标签：javascript, xml, file, text, converter

我一直在使用谷歌，并阅读了很多关于使用 json 和其他方法从 XML 解析的内容。我找不到问题的最新答案？如何使用 JS 或 JSON 编写 XML 文件？如果这是不可能的（我想），那么是否可以使用 js 或任何其他方式将 txt 转换为 xml？我想避免在这个实验中使用 PHP。

我想转换就像拥有一个包含所有 xml 文件内容并将其保存为文件的字符串变量一样简单。

谢谢！

# python - 比较 Python 中的舍入浮点数

> ID：14083015
> 
> 赞同：3
> 
> 时间：2012-12-29T15:15:33.297
> 
> 标签：python, floating-point, comparison

我知道通常必须像 abs(f1-f2) < 1e-6 那样比较两个浮点数，但是如果在比较之前对它们进行舍入，那么在 Python 中比较它们的舍入值是否相等是否安全？

```
if round(f1,5)==round(f2,5):
    print "equal"
else
    print "unequal" 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T18:35:40.010

首先，没有必要像您建议的那样比较两个具有容错性的浮点数。两个浮点数之间的关系取决于它们的派生方式，而这在应用程序之间差异很大。对此没有统一的答案。

其次，当且仅当值相等时，两个舍入值的相等比较才会返回 true。允许任何类型的公差获得“近似等于”函数将无效（如果公差小于舍入距离）。

但是，浮点数的舍入值是有问题的，因为小错误可能会将值从舍入点的一侧移动到另一侧。例如，考虑舍入`f1`到最接近的整数，其中`f1`是您使用包含舍入误差的浮点运算计算的某个值。（当运算的数学结果不能精确表示时，会出现舍入错误，因此计算机必须将其舍入到最接近的可表示结果。）如果`f1`非常接近，比如 2.5，它应该舍入到什么？显然，如果小于 2.5，则舍入为 2，如果大于，则舍入为 3。但假设 的理想值`f1`，用精确数学计算，略大于 2.5，但计算值为由于舍入误差，略小于 2.5。然后`f1`将四舍五入到 2，但我们更希望它四舍五入到 3。

同时，假设您有一个`f2`正确四舍五入为 3 的值。如果将 rounded`f1`与 rounded进行比较`f2`，它们将不相等。

因此，**在**对数字进行四舍五入之后，再考虑其中可能存在哪些错误已经太迟了；该信息消失了。在四舍五入后比较数字并不能告诉您精确的数学结果在四舍五入之前是否彼此接近。

解决方案取决于您的特定应用程序以及数字的计算方式。没有通用的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:24:33.850

不，如[文档](http://docs.python.org/2/library/functions.html#round)中所述，

> 浮点数的 round() 行为可能令人惊讶：例如，round(2.675, 2) 给出 2.67 而不是预期的 2.68。

所以答案仍然是浮点数，我们[不能保证它的确切值](http://docs.python.org/2/tutorial/floatingpoint.html)。

有些示例`round()`返回数字，不能完全表示为浮点数，结果仍然需要使用 epsilon 进行正确比较（例如[，Python 中的 round() 似乎没有正确舍入](https://stackoverflow.com/questions/56820/round-in-python-doesnt-seem-to-be-rounding-properly)）

# ruby - 将输出文件放在 ruby 的文件夹下

> ID：14083019
> 
> 赞同：0
> 
> 时间：2012-12-29T15:15:54.917
> 
> 标签：ruby, rake

在将脚本运行到输出文件时，我在 Ruby 中使用如下代码行来写入日志文件，例如：

```
system("ruby #{file} > #{file}.out") 
```

但是，现在我想创建一个新文件夹，然后期望将输出文件放在这个文件夹下，我尝试了以下方式：

```
Dir::mkdir(directory_name)
system("ruby #{file} > directory_name/#{file}.out") 
```

但是，我没有观察到文件夹“directory_name”下的输出文件，有人请指导我吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:07:37.233

是`directory_name`一个变量，在这种情况下你应该写`#{directory_name}`在第二行吗？或者它是目录的名称，在这种情况下你应该在第一行引用它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:20:32.763

您可能会遇到这样的问题，因为该`system`命令在其自己的 shell 中运行 - 因此工作目录可能不在您创建的目录的上下文中。

一般来说，如果可以的话，最好不要混合使用 unix 策略。

```
system("cd #{File.expand_path(directory_name)} && ruby #{file} > #{directory_name}/#{file}.out") 
```

# android - 访问网站的移动版本（通过 webview），有时工作

> ID：14083022
> 
> 赞同：0
> 
> 时间：2012-12-29T15:16:17.867
> 
> 标签：android, android-webview

我写了这个应用程序来访问一个网页。我已经实现了一个设置来选择是访问网站的移动版本还是桌面版本（我知道设置用户代理是一个肮脏的黑客）。

它在我的 Galaxy Tab 2 上运行良好，但在我的 Xperia S 上却不行。而且我不知道为什么..

```
link = getIntent().getExtras().getString("link");
    webView = (WebView) findViewById(R.id.webView1);

    webView.getSettings().setBuiltInZoomControls(true);
    webView.getSettings().setJavaScriptEnabled(true);

    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress) {
            activity.setProgress(progress * 100);
        }
    });

    webView.setWebViewClient(new Callback());

    SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(this);  
    if(settings.getString("user_agent", "Mobil").equals("Mobil")){
        link = link.substring(24);
        link = "http://mobilsiden.mobi"+link;
        webView.getSettings().setUserAgentString("Mozilla/5.0 (Linux; Android 4.1.1; Nexus 7 Build/JRO03D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Safari/535.19");
    }else{
        webView.getSettings().setUserAgentString("Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20120427 Firefox/15.0a1");
    }

    webView.loadUrl(link); 
```

有没有比更改用户代理更好的解决方案（我想不出任何）？谁能明白为什么它可以在一台设备上运行，而在另一台设备上却不行？

提前致谢！

# optimization - CUDA 编译器未针对 sm_20 优化乘以零

> ID：14083024
> 
> 赞同：0
> 
> 时间：2012-12-29T15:16:27.663
> 
> 标签：optimization, compilation, cuda

我有以下（减少的测试用例！）CUDA 内核

```
__global__
void test(int n, const double* __restrict__ in, double* __restrict__ out)
{
    int idx = blockIdx.x * blockDim.x * threadIdx.x;

    if (idx < n)
    {
        out[idx] = 0.0*in[idx] + 1.0;
    }
} 
```

我希望生成与`out[idx] = 1.0`. `0.0*in[idx]`（当使用模板引擎自动生成内核时出现无操作表达式，其中`0.0`开始的生命为`${template_parameter}`.）但是，`nvcc -arch sm_20 -ptx ...`生成：

```
//
// Generated by NVIDIA NVVM Compiler
// Compiler built on Sat Sep 22 01:35:14 2012 (1348274114)
// Cuda compilation tools, release 5.0, V0.2.1221
//

.version 3.1
.target sm_20
.address_size 64

[...]

    mul.wide.s32    %rd5, %r1, 8;
    add.s64     %rd6, %rd2, %rd5;
    ld.global.f64   %fd1, [%rd6];
    fma.rn.f64  %fd2, %fd1, 0d0000000000000000, 0d3FF0000000000000;
    add.s64     %rd7, %rd1, %rd5;
    st.global.f64   [%rd7], %fd2; 
```

有明确的全局负载和 FMA。然而，当`-arch sm_10`指定为 nvcc 时，它会生成`out[idx] = 1.0`. 是否有任何编译器选项/标志可以诱使它执行上述优化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T19:11:11.990

由于 CUDA 通常遵循 IEEE-754 语义，因此不会优化浮点乘以零。特别是，IEEE-754 指定 +-0 * +-infinity = NaN、+-0 * NaN = NaN 和 +0 * -0 = -0。请参阅 C99 标准的“F.8.2 表达式转换”部分，了解浮点表达式的这种转换和其他转换。

# android - 如何根据结果检查和加载活动

> ID：14083042
> 
> 赞同：1
> 
> 时间：2012-12-29T15:18:01.533
> 
> 标签：android, android-layout

如果数据库为空，我想在 onCreate 上创建一个检查我想加载 userdetails.java，如果数据库包含数据，那么 MainActivity.java。任何代码片段示例都会非常有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:49:18.160

您可以启动 MainActivity 并检查`onResume`是否没有数据。如果是，则启动 UserDetails。当用户完成输入数据时，只需调用`finish()`（来自 UserDetails）。当 MainActivity 恢复时，它将查找用户数据，找到它并正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:36:17.340

要实现这一权利，您需要考虑应用程序的整体流程。

根据您的描述，这是最有可能的一种。

*   像往常一样无条件地启动 Main
*   如果 Main 确定 UserDetails 已启动，则使用 startActivity 打开它并立即在 Main 上调用 finish()！这很重要：它可以防止“后退”按钮扰乱您的屏幕流程
*   完成 UserDetails 后，让它调用 startActivity 来调用 Main 然后完成（）本身

# magento - Magento 1.7 顶部菜单 - 子菜单链接生成器

> ID：14083044
> 
> 赞同：0
> 
> 时间：2012-12-29T15:18:19.953
> 
> 标签：magento, magento-1.7

有人能告诉我在哪里可以找到在 topmenu.phtml 中生成子菜单链接的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:55:10.883

[`Mage_Catalog_Block_Navigation::_renderCategoryMenuItemHtml()`[链接]](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Catalog/Block/Navigation.php#L218)。

# c++ - 类返回值错误

> ID：14083046
> 
> 赞同：1
> 
> 时间：2012-12-29T15:18:26.387
> 
> 标签：c++, class, object

大家好，我有一个逻辑问题......我不得不做一个迷宫，它可以工作，但我试图用类来做......所以就在这里。

我在 main 之外有一个名为 void playeraction() 的函数；

```
cout<<"\nAction : ";
cin>>action;

int prevX=posX;
int prevY=posY;
unsigned char space = {32};

switch (action)
{
    case 'a':
        if(grid[posX][posY-1]!='#')
        {
            posY--;
            grid[prevX][prevY]=space;
            system("cls");
            break;
        } 
```

当它像这样时，现在当我尝试实现类时，角色移动没有任何问题

```
 case 's':

        if(grid[posX+1][posY]!='#')
        {
            Dragon obj;
            obj.moveSouth(posX);
            grid[prevX][prevY]=space;
            system("cls");
            break;
        } 
```

在龙cpp

```
int Dragon::moveSouth(int posX)
{
    return posX++;
} 
```

任何想法为什么它不返回`posX++`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:23:22.297

在您的代码中，存在一些错误。

首先，对于 'posX++'，posX 在使用它的值后会增加。您应该使用 ++posX 使其在使用前增加。

其次，在函数中，其参数的内存在堆栈上。它们是临时的，而不是变量的原始内存。

您可以使用此代码的参考。

```
void Dragon::moveSouth(int & posX){

    posX++;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:21:12.027

因为您没有将返回值分配给任何变量。试试这个：

`int newSouth = obj.moveSouth(posX);`

这将分配给`newSouth`新`posX`值。

编辑：您还必须修改您的 moveSouth 函数，正如 Mats Petersson 在第一条评论中提到的那样。

```
int Dragon::moveSouth(int posX){

 int newX = posX++;
 return newX;

} 
```

但是，如果您不想返回一个新值，而是想增加 original `posX`，只需使用对 posX 的引用，正如 Yuan 在另一个答案中提到的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:27:50.933

您的函数不会修改任何类型的内部或外部变量，它只是返回一个从未被捕获的值。有很多解决方案，

*   创建内部类变量来跟踪位置，只调用一个函数来修改地图上的位置。

* * *

```
class dragon
{
    //...
    void moveDragon(int num, int num2);
    private:
        int posX;
        int posY;
}

void dragon::moveDragon(int num, int num2)
{
    posX -= num;
    posY -= num2;
} 
```

*   让函数返回为函数减去的相同值

* * *

```
posX = obj.MoveSouth(posX); //new posX now holds the value 
```

# popup - 如何处理 selenium RC 中的弹出/警报

> ID：14083053
> 
> 赞同：0
> 
> 时间：2012-12-29T15:19:19.070
> 
> 标签：popup, selenium-rc, alert, selenium-ide

我在尝试使用 Selenim RC 自动化 Web 应用程序时遇到了一个问题。

单击按钮时，我会弹出一个弹出窗口，其中包含要单击以继续的按钮。此外，在通过 IDE 录制时发现弹出按钮属性为 Xpath，还试图找到窗口 id 或窗口名称，警报但都返回为 false，因此无法获取弹出窗口的属性并且能够继续。

![在此处输入图像描述](../Images/37aefc6b98ae5b6a4967e96e6744e356.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:38:46.453

如果窗口没有 ID 或名称。尝试使用 Firebug 捕获嵌入在主窗口中的窗口的 xpath（如屏幕截图所示）并使用

```
 selenium.focus(embedded window xpath) 
```

之后在选定的窗口上执行剩余的操作。完成后，使用

```
 selenium.selectWindow(main window name/id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T09:39:13.223

从您的屏幕截图来看，这似乎不是一个弹出窗口。这只是另一个元素，除了背景是模态的。这些是模态弹出窗口。

就像屏幕上的普通按钮一样，您可以等待按钮出现，然后单击按钮。您可以使用 id、name、xpath 或 css 来定位按钮。

# java - JNA 相当于 HANDLE*

> ID：14083056
> 
> 赞同：3
> 
> 时间：2012-12-29T15:19:29.323
> 
> 标签：java, java-native-interface, jna

我必须使用第三方 dll 中定义的 ac 函数

```
__declspec(dllimport) Init(DWORD id,HANDLE* handle); 
```

JNAerate 很友好地生成了以下方法签名....

```
public static native int Init(int id,PointerByReference handle); 
```

并将其用作

```
public interface Dll extends Library
{
    public Dll _dll = (Dll)Native.LoadLibrary("dll_name");
    public int Init(int id,PointerByReference handle);
}

public void init()
{
     long hwnd = 0;
     LongByReference lbr = new LongByRefrence(hwnd);
     PointerByReference pbr = new PointerByReference();
     pbr.setPointer(lbr.getPointer());
     int ret = _dll.init(0x01,pbr);
} 
```

但这会使 JVM 崩溃..有人可以告诉我在 JNA 中映射 void** 的适当方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:40:48.380

`PointerByReference.getValue()`为您提供被调用者“返回”的值。这就是您可以用来初始化 HANDLE 值的值。无需“初始化” `PointerByReference`.

```
public void init()
{
     PointerByReference pbr = new PointerByReference();
     int ret = _dll.init(0x01,pbr);
     HANDLE handle = new HANDLE(pbr.getValue());
} 
```

# c++ - Windows SDK 8：关于安装位置、文件夹命名法和 WindowsSdkDir_old 环境变量的混淆

> ID：14083058
> 
> 赞同：7
> 
> 时间：2012-12-29T15:19:36.483
> 
> 标签：c++, windows, visual-studio, winapi

在使用 Visual Studio 2012 构建系统时，我意识到，与以前的 SDK 版本不同，Windows SDK 8 安装到两个不同的位置

```
C:\Program Files (x86)\Windows Kits\8.0\ - Everything sans .NET 4.5 
```

如中所述

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SDKs\Windows\v8.0\InstallationFolder 
```

和

```
C:\Program Files (x86)\Microsoft SDKs\Windows\v8.0A\ 
```

如中所述

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Microsoft SDKs\Windows\v8.0A\InstallationFolder 
```

微软似乎已将 Core SDK 与 .NET Framework 隔离开来

我也试图与如何关联

```
 *    %VS_HOME%\VC\bin\vcvars32.bat
 *    %VS_HOME%\VC\bin\x86_amd64\vcvarsx86_amd64.bat
 *    %VS_HOME%\VC\bin\amd64\vcvarsamd64.bat 
```

现在正在工作，它似乎是指带有 WindowsSdkDir_old 的 .NET 4.5 框架位置

我意识到的其他有趣的事情是

1.  %WindowsSdkDir%\Include 具有三个层次结构：Shared、um 和 WinRT
2.  Windows SDK 是随 VS 2010 单独安装的，但对于 VS 2012，我必须单独安装它。

所以我的问题是

1.  将 .NET 4.5 与核心 SDK 分开是否有任何具体原因？
2.  将 .NET 4.5 安装位置称为 WindowsSdkDir_old 的原因是什么
3.  为什么 Windows SDK 8.0A 不是 VS 2012 安装包的一部分？
4.  我可以继续在 VS 2012 中使用 Windows SDK 7.1A 吗？
5.  包含路径 %WindowsSdkDir%\Include[Shared| 的意义是什么？嗯| WINRT] ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-20T05:57:24.260

为了...

1.  .NET 由不同的内部组织（开发者部门）构建；SDK 由 Windows 构建。
2.  不知道
3.  Visual Studio*从未*安装任何 Windows SDK。SDK 中有数千兆字节的示例和工具不属于 Visual Studio。
4.  是的，以前版本的 Windows SDK 可以在 VS 2012 上正常工作。
5.  不确定`um`，但`WinRT`文件特定于 Windows 运行时，并且不能（轻松）被桌面应用程序使用。最好将它们分开。

# java - spring mvc匹配一个url并用作变量

> ID：14083061
> 
> 赞同：1
> 
> 时间：2012-12-29T15:19:54.437
> 
> 标签：java, spring, url, spring-mvc

```
@RequestMapping(value = "/Foo/{id}/{friendlyUrl:*}", method = RequestMethod.GET)
public ModelAndView getFoo(@PathVariable final Long id, @PathVariable final String friendlyUrl, final Principal principal) {
/* then match friendlyUrl, 
 * if it doesn't match use redirect 
 * view to send to correct place*/
} 
```

我在哪里使用 asterix 我的 ide 返回错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:59:01.783

如果您打算使用正则表达式进行匹配，那么我猜您想要的是

```
"/Foo/{id}/{friendlyUrl:.*}" 
```

根据[文档](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates-regex)，模式必须是`{varName:regex}`.

# scala - 当ScalaTest规范是“Suites”的一部分时，如何避免执行两次

> ID：14083062
> 
> 赞同：4
> 
> 时间：2012-12-29T15:19:59.983
> 
> 标签：scala, integration-testing, scalatest

我正在使用 ScalaTest 集成测试 Play Framework 应用程序。这：
`org.scalatest.Suites(list-of-specifications)`
执行*list-of-specifications*中的每个测试。但是我怎样才能避免每个规范也被独立执行呢？他们被处决了两次。

一个例子：

```
import org.scalatest.{Suites, FreeSpec}

class BrowserSuiteSpec extends Suites(new AnonLoginSpec)
class AnonLoginSpec extends FreeSpec { ... } 
```

现在 my`AnonLoginSpec`被执行了两次——首先是 BrowserSuiteSpec 的一部分，然后是独立的，因为它是一个 FreeSpec 类。（更改`AnonLoginSpec`为 trait 会导致编译错误。）

重命名`AnonLoginSpec`为`AnonLoginSpeX`没有任何效果——它仍然被执行了两次。 [（我想也许 ScalaTest 正在寻找“Spec”后缀，我认为 Specs2 确实如此。）]

[文档](http://doc.scalatest.org/1.8/org/scalatest/Suites.html)没有提到这个问题（据我所知）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T15:27:47.127

如果您使用的是 ScalaTest 2.0.M5 或更高版本，则可以使用[@DoNotDiscover](http://www.artima.com/docs-scalatest-2.0.M5/#org.scalatest.DoNotDiscover)注释每个套件。或者，您可以绕过发现并通过将 -s MainSuite 传递给 ScalaTest 运行器来指定主套件类名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:02:55.957

如果您使用的是 2.0-M5 之前的版本，那么您可以简单地声明规范`abstract`，然后 ScalaTest 会忽略它。所以我这样做了：（它有效；测试仅在`Suites`构造内部运行）

```
class BrowserSuiteSpec extends Suites(new AnonLoginSpec {})

abstract class AnonLoginSpec extends FreeSpec { ... } 
```

[（无论如何我都接受了*mpilquist*的回答（见上文），因为这就是 2.0 版中的工作方式。）]

# objective-c - 如何只添加一次 MKOverlay？

> ID：14083068
> 
> 赞同：1
> 
> 时间：2012-12-29T15:21:10.900
> 
> 标签：objective-c, ios, map, overlay, mapkit

我在 CALayer（在 MKOverlay 上）上有一个带有一系列动画图像的 MKOverlay。每当我在地图上移动或缩放时，都会再次添加 MKOverlay，这会导致同一叠加层的多个版本一次又一次地出现。有没有办法可以将叠加层设置为只显示一次？

这是我将叠加层添加到地图的代码：

```
 - (void)mapRadar {        
    [self.mapView removeOverlay:self.mapOverlay];

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    self.mapOverlay = [[MapOverlay alloc] initWithLowerLeftCoordinate:CLLocationCoordinate2DMake(appDelegate.south, appDelegate.west) withUpperRightCoordinate:CLLocationCoordinate2DMake(appDelegate.north, appDelegate.east)];

    self.mapView.showsUserLocation = YES;
    MKMapPoint lowerLeft2 = MKMapPointForCoordinate(CLLocationCoordinate2DMake(appDelegate.south2, appDelegate.west2) );
    MKMapPoint upperRight2 = MKMapPointForCoordinate(CLLocationCoordinate2DMake(appDelegate.north2, appDelegate.east2));

    MKMapRect localMapRect = MKMapRectMake(lowerLeft2.x, upperRight2.y, upperRight2.x - lowerLeft2.x, lowerLeft2.y - upperRight2.y);

      MKMapPoint lowerLeft = MKMapPointForCoordinate(CLLocationCoordinate2DMake(appDelegate.south, appDelegate.west) );
      MKMapPoint upperRight = MKMapPointForCoordinate(CLLocationCoordinate2DMake(appDelegate.north, appDelegate.east));
      MKMapRect nationalSectorMapRect = MKMapRectMake(lowerLeft.x, upperRight.y, upperRight.x - lowerLeft.x, lowerLeft.y - upperRight.y);

    [self.mapView addOverlay:[MKCircle circleWithMapRect:nationalSectorMapRect]];
    [self.mapView setNeedsDisplay];

    [self.mapView setVisibleMapRect:localMapRect animated:YES];
}

#pragma Mark - MKOverlayDelgateMethods

-(MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id)overlay{

    MapOverlayView* circleView = [[MapOverlayView alloc] initWithCircle:(MKCircle *)overlay];

    return circleView;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:47:32.803

您可以尝试像这样删除圆圈：

```
for (id<MKOverlay> overlayToRemove in _mapView.overlays)
{
    if ([overlayToRemove isKindOfClass:[MKCircle class]])
    {
        [_mapView removeOverlay:overlayToRemove];
    }
} 
```

# c# - WP 以编程方式移动 ScrollViewer

> ID：14083070
> 
> 赞同：2
> 
> 时间：2012-12-29T15:21:38.180
> 
> 标签：c#, silverlight, windows-phone

我有一个`ScrollViewer`，我正在用大约 2 个屏幕高度的控件填充它。在底部我有一个按钮，它清除`ScrollViewer`并用不同的控件重新填充它。问题是当我重新填充它时，滚动距离仍然在我的按钮所在的位置。我需要`ScrollViewer`滚动到顶部。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T15:24:33.270

您需要使用[ScrollToVerticalOffset](http://msdn.microsoft.com/en-us/library/system.windows.controls.scrollviewer.scrolltoverticaloffset%28v=vs.95%29.aspx)的方法`ScrollViewer`。

```
myScrollViewer.ScrollToVerticalOffset(0); 
```

# ruby - 无法捕捉红宝石异常

> ID：14083078
> 
> 赞同：0
> 
> 时间：2012-12-29T15:22:53.117
> 
> 标签：ruby, exception, exception-handling, mongoid3, moped

具有以下长期运行的 rake 批次：

```
class SyncStarredRepo
  include Mongoid::Document

  def self.update

    User.all.map do |user| 

      if user.email != "admin@gitwatcher.com"
        begin 
          conn = Faraday.new "https://api.github.com" 
          i = 1  
          begin   
            resp = conn.get "/users/#{user.nickname}/starred?page=#{i}"
            resp.body.each do |repo|
              attempts = 0
              begin 
                existing_repo = user.watchlists.where( html_url: "#{repo['html_url']}" ).batch_size(30)
                if existing_repo.exists?  
                  existing_repo.first.update_attributes!(
                      html_url: "#{repo['html_url']}",
                      description: "#{repo['description']}"
                  )
                else   
                  user.watchlists.create!(
                      html_url: "#{repo['html_url']}",
                      description: "#{repo['description']}"
                  )
                end

              rescue Moped::Errors::CursorNotFound => c
                attempts += 1
                puts "error message: #{c.message}"
                if attempts < 3
                  puts "Retrying... Attempt #: #{attempts.to_s}"
                  sleep(3)
                  retry 
                else 
                  puts "already retried 3 times, go to the next"
                  next
                end
              end

            end  
            i += 1 
          end until resp.body.empty? 

        rescue TypeError => e
          puts "message error (e.inspect): #{e.inspect}"
          puts "go to the next user"
          next    
        rescue  
          p $!, *$@
          next    
        end  
      end  

    end 
  end
end 
```

我想捕获 Moped::Errors::CursorNotFound 异常，但它不起作用。

在 crontab 日志中，我只收到以下消息：

```
rake aborted!
The operation: "GET MORE"
failed with error "cursor 2509315744412059250 not found" 
```

然后批处理停止并退出，而我正在查看救援消息和下一个循环操作。

**更新**

我正在尝试通过执行以下操作“扩展”设置为**StandardError**的可捕获异常：

```
 rescue
        p $!, *$@
        next
      end 
```

...以防万一，即使**CursorNotFound**继承自**MongoError**，后者继承自**StandardError**，如您[在此处](https://codeclimate.com/github/mongoid/moped/Moped%3a%3aErrors%3a%3aCursorNotFound)看到的。

**更新**

我刚刚更新了以前的简化代码，使用 rake 使用的完整**SyncStarredRepo**类，以防万一我在循环逻辑中遗漏了一些东西，开始/救援/结束等等......

**更新**

按照以下方式打印的堆栈跟踪`rake -t`：

```
rake aborted!
The operation: "GET MORE"
failed with error "cursor 5781947091640256877 not found"
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/gems/moped-1.3.2/lib/moped/node.rb:210:in `get_more'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/gems/moped-1.3.2/lib/moped/cursor.rb:44:in `get_more'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/gems/moped-1.3.2/lib/moped/cursor.rb:29:in `each'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/gems/moped-1.3.2/lib/moped/query.rb:77:in `each'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/gems/moped-1.3.2/lib/moped/query.rb:77:in `each'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/bundler/gems/mongoid-92cad16e9fbf/lib/mongoid/contextual/mongo.rb:133:in `block in each'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/bundler/gems/mongoid-92cad16e9fbf/lib/mongoid/contextual/mongo.rb:605:in `selecting'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/bundler/gems/mongoid-92cad16e9fbf/lib/mongoid/contextual/mongo.rb:132:in `each'
/var/www/gitwatcher/vendor/bundle/ruby/1.9.1/bundler/gems/mongoid-92cad16e9fbf/lib/mongoid/contextual.rb:18:in `each'
/var/www/gitwatcher/app/models/sync_starred_repo.rb:15:in `map'
/var/www/gitwatcher/app/models/sync_starred_repo.rb:15:in `update'
/var/www/gitwatcher/lib/tasks/scheduler.rake:9:in `block in <top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/bin/rake:23:in `load'
/usr/local/rvm/gems/ruby-1.9.3-p194@rails-3.2.8/bin/rake:23:in `<main>'
Tasks: TOP => update_starred_list_per_user 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:54:41.400

期间引发了错误，`User.all.map`因此您必须将`begin`..`rescue`块包裹在整个语句周围。

*基于初始信息的旧答案：*

~~您正在循环之外进行救援，因此`retry`不会完全按照您`next`的预期进行（另一方面会引发`SyntaxError`（1.9）或`LocalJumpError`（1.8））。实际上，`retry`在 a 中`rescue`只会导致`begin`..`rescue`块中的代码再次运行。~~

正确的代码应该是这样的：

```
attempts = 0
begin 
  i = 1 
  resp = conn.get "/users/#{user.nickname}/starred?page=#{i}"
  resp.body.each do |repo|
    begin
      existing_repo = user.watchlists.where( html_url: "#{repo['html_url']}" )
      if existing_repo.exists? 
        existing_repo.first.update_attributes!(
            html_url: "#{repo['html_url']}",
            description: "#{repo['description']}"
        )
      else 
        user.watchlists.create!(
            html_url: "#{repo['html_url']}",
            description: "#{repo['description']}"
        )
      end
    rescue Moped::Errors::CursorNotFound => c
      attempts += 1
      puts "error message: #{c.message}"
      if attempts < 3
        puts "Retrying... Attempt #: #{attempts.to_s}"
        sleep(3)
        retry 
      else 
        puts "already retried 3 times, go to the next"
        next
      end
    end
  end 
  i += 1
end until resp.body.empty? 
```

 ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T19:51:53.437

尽管我没有仔细查看您的代码，但请注意，bare*无法*`rescue`捕获所有异常。为此，您需要.*`rescue Exception`*~~

# c++ - 如何在 Visual Studio 中制作可分发的 C++ 程序

> ID：14083079
> 
> 赞同：1
> 
> 时间：2012-12-29T15:22:55.633
> 
> 标签：c++, visual-studio

在 Visual Studio 中制作的程序不能在没有 Visual Studio 的机器上运行 我已经在互联网上搜索过这个但没有发现任何帮助 我是编程新手，我不能制作纯 win32 应用程序，我只能制作控制台赢得 32 个应用程序

谁能告诉我如何使我的程序可分发？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:32:25.767

问题是程序无法运行的机器缺少适当的 C/C++ 运行时运行时。

您有两个主要选择。

1.  为你的 Visual Studio 版本部署适当的可再发行包。当您动态链接到运行时时需要这样做。
2.  静态链接到运行时。这样，运行时就内置到您的可执行文件中。

# php - 我的高度嵌套的 foreach 逻辑仅在第一次迭代时起作用

> ID：14083082
> 
> 赞同：0
> 
> 时间：2012-12-29T15:23:09.667
> 
> 标签：php

我有一些嵌套的 foreach 循环，我得到了有趣和意想不到的结果。

在下面示例代码中的第 9 行，我正在循环“$servers as $server”，在主循环的第一次迭代中，一切正常，我得到了预期的服务器列表，但对于后续迭代，我不。

然而，第 7 行的条件在“if ($synced['video_id'] == $v['id'])”时一直返回 true。

这让我问 - 我称之为 $servers 的数组 - 在第一次迭代后它是否以某种方式用完，或者我是否需要出于某种原因再次将其重置回位置 0？

```
 //create array of servers synced with this video, also count them for later percentage readout.
    foreach ($videos as &$v) {
        $syncArray = Array();
        $i = 0;
        foreach ($synced as $synced) {
            //find whether sync-entity pertains to this video
            if ($synced['video_id'] == $v['id']) {
                //now get name of synched server instead of id
                foreach($servers as $server) {
                    if ( $synced['server_id'] == $server['id'] ) {
                        $syncArray[$i] = $server['screenName'];
                        //if servers screen has a parent, put that in parenthesis for clarity
                        if ($server['screenParent']) {
                            $syncArray[$i] .= " (". $server['screenParent'] .")";
                        }                           
                    }
                }
                //increment for calculating percentage later
                $i++;
            }
        }
        //append the array of synced servers for this video to the videoarray
        $v['syncArray'] = $syncArray; 
```

$servers 的 var_dump：

```
array(3) {
[0]=> array(4) { ["id"]=> int(9) ["userName"]=> string(20) "företag1/testskärm" ["screenName"]=> string(9) "Gate C 22" ["screenParent"]=> string(10) "Terminal 5" }
[1]=> array(4) { ["id"]=> int(15) ["userName"]=> string(15) "företag1/entre" ["screenName"]=> string(6) "Entré" ["screenParent"]=> string(14) "Avgångshallen" }
[2]=> array(4) { ["id"]=> int(17) ["userName"]=> string(14) "företag1/test" ["screenName"]=> string(4) "test" ["screenParent"]=> string(0) "" } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:30:59.387

您的代码是为什么编程语言允许您编写函数和对象的一个​​很好的例子。

For example, how does this look like?

```
//create array of servers synced with this video, also count them for later percentage readout.
foreach ($videos as &$v) {
    $v['syncArray'] = get_synched_video_array_by_id($synched, $v['id']);
} 
```

That was the first level of your nested foreach operation. Now imagine the next levels. See [http://php.net/functions](http://php.net/functions)

The less nesting processings and conditions you have, the less complex is your code. Reducing the complexity reduces the amount of errors that can happen and how hard these errors are to track.

This should also easily solve your concrete problem of variable re-use (quoting *Asad*):

> `foreach ($synced as $synced)` use different variable names for the array you are iterating over and each member

# alfresco - 是否可以通过 CIFS/FTP 获得 Alfresco 存储库文档版本历史记录？

> ID：14083086
> 
> 赞同：1
> 
> 时间：2012-12-29T15:23:50.683
> 
> 标签：alfresco

我正在使用 Alfresco 4.0.e。我想知道是否可以通过 Alfresco 的 CIFS/FTP 接口查看文档版本历史记录（文档的旧版本）？

我真正要解决的问题是向没有特定属性的用户隐藏文档的版本历史记录。我想知道这个问题是否可以简化为在露天共享中应用我的更改？请注意，我假设用户无法使用 alfresco explorer（以前版本的 alfresco web 客户端）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:17:31.217

不，但是实现一些基本的东西应该不会太难。

CIFS 和 FTP 协议不知道版本历史是什么。如果您想通过它们查看它，您将必须实施一个自定义解决方案，以反映基于文件和/或文件夹的版本历史记录。一种简单的方法是为每个版本化文件提供一个随附文件，以显示您需要的信息。内容可以使用行为自动更新。

另一种选择是实现显示它的自定义桌面操作，但这很可能使用基于 http 的通信。

# websphere - 在通过 WebSphere 7 公开的 JConsole 中访问 Camel MBean

> ID：14083092
> 
> 赞同：1
> 
> 时间：2012-12-29T15:24:48.213
> 
> 标签：websphere, apache-camel, jmx, mbeans

我正在尝试通过 JMX 公开 Apache Camel MBean，以便我可以在 WebSphere Application Server (7.0) 中管理已部署的 Camel 实例。

实际上，我不知道这是否与 Camel 有关，但更多的是关于如何从 WebSphere 公开 MBean 的问题。

连接到 JConsole 以及列出 Camel MBean 都很好。但是，当尝试调用任何操作时，我会被拒绝访问。

`The user UNAUTHENTICATED (unique ID: unauthenticated) was not granted any of the following required roles: operator, administrator.`

似乎其中一些 MBean 可能不会被创建（来自 WAS 日志）。

```
[2012-12-29 16:17:15:328 CET] 00000010 PlatformMBean W   Failed to activate MBean org.yourname:cell=segotw10099999Node01Cell,name="marshal13",context=segotw10099999/camelContext,type=processors,node=segotw10099999,process=server1 
```

我正在连接这样的东西：

```
start %WAS_JDK_HOME%/bin/jconsole -J-Djava.class.path=%WAS_JDK_HOME%\lib\tools.jar;%WAS_JDK_HOME%\lib\jconsole.jar;%WAS_HOME%\runtimes\com.ibm.ws.admin.client_7.0.0.jar service:jmx:iiop://localhost:2809/jndi/JMXConnector 
```

我还尝试将 WAS 中具有管理权限的用户（以及“管理员”组中的用户）填写到 JConsole 中的用户/密码文件中。

这是 WebSphere 的默认配置的“RAD”设置，所以没有什么花哨的东西。但是，我希望稍后能够在具有多个应用程序和 LDAP 用户的生产服务器上使用它。

非常欢迎任何指针！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T09:16:30.290

你用什么骆驼版本？你是如何在 Camel 中配置 JMX 的？

当使用一些像 WebSphere 这样的服务器时，您很可能需要对其进行一些特殊的配置。我们在 Camel 文档中有一些详细信息：http: [//camel.apache.org/camel-jmx.html#CamelJMX-WebSphere](http://camel.apache.org/camel-jmx.html#CamelJMX-WebSphere)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T15:49:19.340

问题的原因可能是 JConsole 未正确配置为连接到受保护的 WebSphere 实例。虽然连接到禁用了安全性的 WebSphere 实例相对简单，但启用安全性后事情变得更加棘手。如果您想省去弄清楚如何做到这一点的麻烦，您可以按照此处给出的说明进行操作：

[http://code.google.com/p/xm4was/wiki/VisualVMHowTo](http://code.google.com/p/xm4was/wiki/VisualVMHowTo)

它们适用于 VisualVM，但我想这并不重要。

# windows - 如何访问 XAML 翻转视图中的命名项目

> ID：14083095
> 
> 赞同：1
> 
> 时间：2012-12-29T15:25:15.950
> 
> 标签：windows, xaml, microsoft-metro, winrt-xaml

我正在开发一个应用程序来在翻转视图中显示带有一些元数据的照片。这一切都很好，但现在我想将 Bing 地图添加到 RichTextBlocks 并根据属于照片的 GPS 信息显示位置。为此，我需要以编程方式从 c# 代码访问 bing Maps 控件，并为当前显示的照片将地图控件的中心设置为照片的位置。到目前为止，似乎不可能从代码隐藏中访问 Bing 地图控件（名为 myMap）来做到这一点。

我尝试使用 VisualTreeHelper 并为 treeView 获取子项，但这总是返回 null。其代码类似于： var x = VisualTreeHelper.GetChild(flipView, 0); （使用 VisualRTXamlToolkit 的 Nuget 包。

这是我的 XAML 的（部分）：

```
<Grid
        Style="{StaticResource LayoutRootStyle}"
        DataContext="{Binding Group}"      
        d:DataContext="{Binding AllGroups[0], Source={d:DesignInstance Type=data:SampleDataSource, IsDesignTimeCreatable=True}}" >

        <FlipView
            x:Name="flipView"
            AutomationProperties.AutomationId="ItemsFlipView"
            AutomationProperties.Name="Item Details"
            TabIndex="1"
            Padding="0,-3,0,-3"
            Margin="-3,0,3,0"
            ItemsSource="{Binding Source={StaticResource itemsViewSource}}">

            <FlipView.ItemTemplate>
                <DataTemplate>
                    <UserControl Loaded="StartLayoutUpdates" Unloaded="StopLayoutUpdates" x:Name="userControl">
                        <ScrollViewer x:Name="scrollViewer" Style="{StaticResource HorizontalScrollViewerStyle}" Grid.Row="1">

                            <!-- Three-column grid for item-detail layout -->
                            <Grid Margin="0,0,0,0" Height="Auto">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="40" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <ProgressRing x:Name="ProgressRing" Foreground="White" Margin="0" HorizontalAlignment="Center" IsActive="True" MaxHeight="50" MinHeight="50" MaxWidth="50" MinWidth="50"></ProgressRing>
                                    <TextBlock x:Uid="Loading" Text="Loading data" Style="{StaticResource BasicTextStyle}" TextWrapping="Wrap" TextAlignment="Center" Padding="5" HorizontalAlignment="Center" Foreground="White" />
                                </StackPanel>

                                <Image x:Name="image" Width="Auto" Height="Auto" Margin="0,0,0,0" Stretch="Uniform" HorizontalAlignment="Right"
                                       DataContext="{StaticResource itemsViewSource}"
                                       Source="{Binding LargeImage}" Grid.Column="0" />

                                <Grid Margin="0,0,0,20" Height="Auto" Grid.Column="2">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="400" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="140" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>

                                    <RichTextBlock Grid.Column="0" Grid.Row="1" Height="Auto" Padding="0,0,20,0" MaxWidth="400" OverflowContentTarget="{Binding ElementName=NextRTB1}" >
                                        <Paragraph>
                                            <Run x:Uid="AltTitle" FontSize="16" FontWeight="Bold" Text="Titel" />
                                        </Paragraph>
                                        <Paragraph Margin="0,0,0,16">
                                            <Run Text="{Binding AltTitle}" FontSize="16" FontWeight="SemiLight" />
                                        </Paragraph>
                                        <Paragraph>
                                            <Run x:Uid="Description" FontSize="16" FontWeight="Bold" Text="Omschrijving" />
                                        </Paragraph>
                                        <Paragraph>
                                            <Run x:Uid="Location" FontSize="16" FontWeight="Bold" Text="Lokatie" />
                                        </Paragraph>
                                        <Paragraph LineStackingStrategy="MaxHeight">
                                            <InlineUIContainer>
                                                <bm:Map Width="400" Height="400" ZoomLevel="6" Credentials="CREDENTIALS HERE" x:Name="myMap">
                                                    <bm:Map.Center>
                                                        <bm:Location Latitude="52" Longitude="5" />
                                                    </bm:Map.Center>
                                                </bm:Map>
                                            </InlineUIContainer>
                                        </Paragraph>
                                        <Paragraph>
                                            <Run x:Uid="CopyRight" FontSize="16" FontWeight="Bold" Text="Bronvermelding" />
                                        </Paragraph>
                                    </RichTextBlock>
                                    <RichTextBlockOverflow x:Name="NextRTB1" OverflowContentTarget="{Binding ElementName=NextRTB2}" Grid.Column="1" Grid.Row="1" Padding="20,0,20,0" MaxWidth="440" />
                                    <RichTextBlockOverflow x:Name="NextRTB2" Grid.Column="2" Grid.Row="1" Padding="20,0,20,0" MaxWidth="440" />
                                </Grid>
                            </Grid>

                            <VisualStateManager.VisualStateGroups>
                                <!-- Visual states reflect the application's view state inside the FlipView -->
                                <VisualStateGroup x:Name="ApplicationViewStates">
                                    <VisualState x:Name="FullScreenLandscape"/>
                                    <VisualState x:Name="Filled"/>

                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                        </ScrollViewer>
                    </UserControl>
                </DataTemplate>
            </FlipView.ItemTemplate>
        </FlipView>

        <!-- Back button -->
        <Button x:Name="backButton" Click="GoBack" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="36,56,0,0"
                    IsEnabled="{Binding Frame.CanGoBack, ElementName=pageRoot}" 
                    Style="{StaticResource BackButtonStyle}" />

    </Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T20:04:30.607

不能为 FlipView 绑定选中的项吗？这可能会更新另一个具有地理编码信息的属性，如下所示：

```
private PhotoDetail _selectedItem;
public PhotoDetail SelectedItem
{
    get{ return _selectedItem; }
    set
    {
        if (_selectedItem!= value)
        {
            _selectedItem= value;
            if(_selectedItem!=null)
                Center=new GeoCoordinate(_selectedItem.Latitude, _selectedItem.Longitude);

            NotifyPropertyChanged("SelectedItem");
        }
    }

}

private GeoCoordinate _center;
public GeoCoordinate Center
{
    get { return _center; }
    set
    {
        if (_center != value)
        {
            _center = value;
            NotifyPropertyChanged("Center");
        }
    }
} 
```

其中 PhotoDetail 是翻转视图中照片的类型。

在您的地图中，您只需添加绑定：

```
Center="{Binding Center, Mode=TwoWay}" 
```

在您的翻转视图中，您可以添加

```
SelectedItem="{Binding SelectedItem, Mode=TwoWay}" 
```

# javascript - Javascript，克隆页面元素

> ID：14083107
> 
> 赞同：0
> 
> 时间：2012-12-29T15:26:35.427
> 
> 标签：javascript, html

在我的网络应用程序中，我需要创建许多具有不同内容的相同块。我不想在服务器上完全形成元素，考虑到其中一些元素需要从用户的输入中创建。因此，我看到了两种在客户端创建此类块的方法：

1.  使用 jQuery（或只是 javascript）逐个元素创建块元素。缺点是创建这些块的那段代码不是可识别的 HTML，我认为这很糟糕，而且也很难修改。
2.  创建一个 HTML 元素（例如，一个 div），使其不可见，然后克隆它并使用它来创建必要的新元素。

不过，我不确定哪种方式更好，并且可能会有更好的变体。我试图用谷歌搜索这个问题，但找不到任何东西。

你会推荐什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:28:12.730

jQuery

```
var elementClone  = $(element).clone(); 
```

或（不是更好）：

```
var elementClone = $(element).html(); 
```

javascript

```
var elementClone = document.getElementById('elementID').cloneNode(true); 
```

希望这对你有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:28:00.937

你总是可以使用基本的 DOM

```
var clone = document.getElementById('elementID').cloneNode(true);
document.body.appendChild(clone); //wherever you want to place the cloned element 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:33:15.627

另一种方法是使用模板引擎，例如[mustache](https://github.com/janl/mustache.js)、[underscore](http://documentcloud.github.com/underscore/#template)或[Handlebars](http://handlebarsjs.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T15:34:42.423

*如果没有关于“相同块*”和“*不同内容*”结构的更多详细信息，很难对您的问题给出很好的答案。

前段时间我正在解决类似（或者说听起来很相似）的问题，而[纯模板引擎](http://beebole.com/pure/documentation/tutorials/)（[重复一个节点示例](http://beebole.com/pure_git/tutorial/tuto5.html)）非常好地解决了我的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T15:31:27.563

正如您所指出的，有几种方法可以做到这一点。最常见的是使用[模板引擎](http://en.wikipedia.org/wiki/Template_engine_%28web%29)。模板引擎允许您专注于标记内容（在块之间有所不同），并自动执行输出周围标记的任务。

这种方法的一个非常简单的示例（尽管可能是最不方便的方法之一）是将您的内容标记为精简的 XML，并使用 XSLT 将其转换为所需的 HTML。可以在此处找到有关此方法的教程：[https ://developer.mozilla.org/en-US/docs/Transforming_XML_with_XSLT](https://developer.mozilla.org/en-US/docs/Transforming_XML_with_XSLT)

在不推荐单个模板引擎的情况下，这里有一篇比较各种浏览器端替代方案的文章：[浏览器端模板引擎综述：Google Closure Templates、jTemplates 和 PURE](http://blog.pandaform.com/techie/browser-side-template-engines-roundup/)

# python - 我应该在 Python 3 中使用编码声明吗？

> ID：14083111
> 
> 赞同：133
> 
> 时间：2012-12-29T15:27:17.237
> 
> 标签：python, python-3.x, encoding, utf-8

默认情况下，Python 3 对源代码文件使用 UTF-8 编码。我还应该在每个源文件的开头使用编码声明吗？像`# -*- coding: utf-8 -*-`

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2012-12-29T15:28:41.447

因为默认值*是*UTF-8，所以您只需要在偏离默认值时使用该声明，或者如果您依赖其他工具（如 IDE 或文本编辑器）来使用该信息。

换句话说，*就 Python 而言*，只有当您想要使用不同的编码时，您才必须使用该声明。

其他工具，例如您的编辑器，可以支持类似的语法，这就是[PEP 263 规范](https://www.python.org/dev/peps/pep-0263/)允许语法相当灵活的原因（它必须是注释，文本`coding`必须存在，后跟一个`:`或`=`字符和可选的空格，后跟一个公认的编解码器）。

请注意，它仅适用于 Python*读取源代码的*方式。它不适用于执行该代码，因此不适用于打印、打开文件或任何其他 I/O 操作如何在字节和 Unicode 之间进行转换。有关 Python、Unicode 和编码的更多详细信息，我强烈建议您阅读[Python Unicode HOWTO](http://docs.python.org/3/howto/unicode.html)或 Ned Batchelder 的非常详尽的[*Pragmatic Unicode* talk](https://nedbatchelder.com/text/unipain.html)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2019-03-08T09:14:12.263

## 不，如果：

*   整个项目仅使用`UTF-8`，这是默认设置。
*   并且您确定您的 IDE 工具不需要每个文件中的编码声明。

## 是的，如果

*   您的项目依赖于不同的编码
*   或依赖于许多编码。

对于多编码项目：

> 如果某些文件在`non-utf-8`.`UTF-8``Explicit is better than implicit.`

## 参考：

*   PyCharm 不需要该声明：

[在pycharm中为特定文件配置编码](https://www.jetbrains.com/help/pycharm/configuring-individual-file-encoding.html)

*   vim 不需要那个声明，但是：

> ```
> # vim: set fileencoding=<encoding name> : 
> ```

# smarty - Fetch() 方法无法输出 - Smarty

> ID：14083112
> 
> 赞同：0
> 
> 时间：2012-12-29T15:27:21.613
> 
> 标签：smarty, fetch

我正在使用 fetch() 方法来存储模板并将其显示在另一个模板中，如下所示：

```
 $this->mySmarty->assign('template',$this->fetch('template.tpl'));
    $this->display('mypage.html'); 
```

其中 mySmarty 被实例化为 smarty 类。我在 mypage.html 中调用 {$template}。

页面“mypage.html”显示正确，但 {$template} 变量输出 0。怎么可能？（知道我正确设置了权限）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T11:55:24.677

神秘，我设法通过这个技巧解决了这个问题： $template = $this->fetch('template.tpl'); $this->mySmarty->assign('template',$template);

# android - ViewPager 中的光标驱动内容

> ID：14083116
> 
> 赞同：2
> 
> 时间：2012-12-29T15:27:56.043
> 
> 标签：android, android-viewpager, android-cursor

我想使用 ViewPager 从单个光标（最初来自 ContentProvider）中显示每页的多个项目。布局将显示为网格，并将包括每个项目的图像和文本。列表中会频繁添加和删除，需要在 UI 中反映出来，而不必重建数据结构（这可能会排除下面的一些选项）。

当前流程：

1.  在主要活动中实例化光标。
2.  创建我自己的从接受光标的 PagerAdapter 扩展的光标适配器类。光标用于通过 getCount() 确定 ViewPager 将拥有的页数（然后根据每页显示的项目数进行调整）。
3.  在 Cursor Adapter getItem 方法中，它创建最终将包含列表子集的片段。

在这个阶段，我不确定哪种方法最好。我是否：

A. 将光标和索引传递给 Fragment 以显示下一页结果（例如，具有 setCursorIndex(Cursor, int) 方法。*（即使在同一个 Activity 中，跨 Fragment 共享光标也会导致问题吗？）*

B. 传入将获得结果的 ContentUris 字符串列表。*（这是否会阻止更新列表而无需重建？）*

C. 构建一个包含项目的参数包（一个包含图像和文本的字节数组的列表）。*（由于使用图像，这似乎效率低下。）*

D. 在从适配器接收到起始索引的每个片段中重新创建一个新的光标。（效率低下？）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:40:06.800

恕我直言，答案是 B 和 C 的某种组合。

它是 C，只要您创建一个参数`Bundle`并将其提供给`Fragment`，可能使用工厂方法模式（例如，`newInstance()`）。这样，在配置更改期间，如果片段将被销毁并重新创建，您将拥有片段中的所有数据。

但是，“包含图像和文本的字节数组的列表”似乎不合适。如果您已经有图像的`Uri`值（或值`String`的表示`Uri`），请将*它们*放在 中`Bundle`，并使用集中式图像缓存解决方案（例如[this one](https://github.com/chrisbanes/Android-BitmapCache)或[this one](https://github.com/mitmel/Android-Image-Cache)）以确保仅在需要时加载这些图像。其他小东西（“和文本”）可以进入`Bundle`.

选项 A 可能可行，但您必须小心考虑：

*   配置更改（当用户旋转屏幕并且您的活动被销毁/重新创建时会发生什么？）
*   中的隐式当前行指针（每个片段在尝试读取任何数据之前`Cursor`都需要）`moveToPosition()`

# android - 通过我的应用程序连接时，Wifi被记住然后在android中被禁用

> ID：14083121
> 
> 赞同：1
> 
> 时间：2012-12-29T15:28:30.510
> 
> 标签：android, android-wifi

我是安卓新手。我想要做的是搜索可用的网络，然后单击特定的网络会出现一个自定义对话框，用于输入密码，因为它在任何 android 设备中都有。现在的问题是 Wifi 被记住，然后在执行以下代码时禁用它没有连接。下面是我的代码，它在单击所需的安全网络时执行。请帮我解决这个问题

```
 password = text.getText().toString().trim();
   if(!password.equals(""))
   {
      wc.SSID = "\""+signal+"\""; //IMP! This should be in Quotes!!
      wc.hiddenSSID = true;
      System.out
     .println("Oon click to action"+wc.SSID);
      wc.status = WifiConfiguration.Status.ENABLED;     
      wc.priority = 40;

      wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.NONE);
      wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN); 
      wc.allowedProtocols.set(WifiConfiguration.Protocol.WPA);
      wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN);
      wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.SHARED);
      wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP);
      wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP);
      wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP40);
      wc.allowedGroupCiphers.set(WifiConfiguration.GroupCipher.WEP104);

      wc.preSharedKey = "\"password\"";
     // wc.wepKeys[0] = "\"password\""; //This is the WEP Password
      wc.wepTxKeyIndex = 0;

    int res = wifi.addNetwork(wc);
       Log.d("WifiPreference", "add Network returned " + res );
       boolean es = wifi.saveConfiguration();
       Log.d("WifiPreference", "saveConfiguration returned " + es );
       wifi.disconnect();
       boolean b = wifi.enableNetwork(res, false);   
       wifi.reconnect(); 
```

# javascript - onMouseWheel 事件如何被捕获并停止在其他地方处理

> ID：14083126
> 
> 赞同：1
> 
> 时间：2012-12-29T15:28:58.993
> 
> 标签：javascript, html

我想捕捉`onMouseWheel`整个页面的事件（对于我正在进行自定义滚动的上下文），但也需要停止页面上处理它的所有其他内容。怎么可能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:31:31.233

你应该打电话

```
event.preventDefault(); 
```

处理完事件后。

像这样：

```
window.addEventListener("onMouseWheel", function(event) {
    // process the event for custom scrolling

    event.preventDefault();
    event.stopPropagation();
}, true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:35:41.900

您可以像这样在 jquery 中执行此操作：

```
$(function(){
    $('*:not(body)').on('mousewheel',function(e){
        e.preventDefault();
        e.stopPropagation();
    });
}); 
```

使用纯 javascript 的替代解决方案：

```
var ele = document.querySelectorAll('*:not(body)');
ele.forEach(function(i){
    ele[i].addEventListener('mousewheel',function(e){
        e.preventDefault();
        e.stopPropagation();
    },false);
}); 
```

# java - NoSuchPortException

> ID：14083128
> 
> 赞同：1
> 
> 时间：2012-12-29T15:29:17.433
> 
> 标签：java

我安装了`javax.comm`API。每当我尝试执行下面的代码时

```
CommPortIdentifier portId = CommPortIdentifier.getPortIdentifier("COM49"); 
```

我得到`NoSuchPortException`。

我尝试列出端口，但没有显示任何端口。

我也在网上搜索过这个问题，并尝试在我阅读时将 api 的文件放在所有文件夹中，但现在我仍然收到异常。帮我解决这个问题，如果你指定正确安装 api 会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:32:41.387

使用此代码列出端口

```
public static void main(String args[]) {
        Enumeration ports = CommPortIdentifier.getPortIdentifiers();
        while (ports.hasMoreElements()) {
            CommPortIdentifier port = (CommPortIdentifier) ports.nextElement();
            String type;
            switch (port.getPortType()) {
                case CommPortIdentifier.PORT_PARALLEL:
                    type = "Parallel";
                    break;
                case CommPortIdentifier.PORT_SERIAL:
                    type = "Serial";
                    break;
                default: /// Shouldn't happen
                    type = "Unknown";
                    break;
            }
            System.out.println(port.getName() + ": " + type);
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:31:38.780

您可以使用[CommPortIdentifier.getPortIdentifiers()](http://docs.oracle.com/cd/E17802_01/products/products/javacomm/reference/api/javax/comm/CommPortIdentifier.html#getPortIdentifiers%28%29)方法获取本地系统上可用的所有端口标识符的列表。

# python - Python 正则表达式，它将查找由特定字母组成的单词。字母只能使用一次

> ID：14083130
> 
> 赞同：1
> 
> 时间：2012-12-29T15:30:13.630
> 
> 标签：python, regex

如果我有一个可变单词中的单词列表和可变字母中的字母列表，我怎样才能找到可以由字母中的字母组成的所有单词。字母中的字母每个只能使用一次；但您可以多次列出同一个字母。必须使用字母中的所有字母。我想在 Python 或 Excel VBA 中执行此操作。

例如：

```
letters = ['a', 'a', 'a', 'i', 'l', 'r', 's', 't', 'u']
words = ['dummy', 'australia'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:33:38.203

我不会为此使用正则表达式，尤其是在 Python 中：

```
>>> [w for w in words if sorted(w) == letters]
['australia'] 
```

这假设`letters`已排序，如您的示例所示。

# regex - 删除单词之间的重复字符

> ID：14083133
> 
> 赞同：4
> 
> 时间：2012-12-29T15:30:34.633
> 
> 标签：regex

我正在尝试[Regex 101中的测验](http://www.regex101.com/quiz/)

在任务 6 中，问题是

> 不好了！昨晚我的朋友们似乎把啤酒洒在了我的键盘上，现在我的键非常粘。有时当我按下一个键时，我会得到两个重复项。你**能帮**我解决**这个****问题**吗？**_** 应删除粗体内容。

 ****我试过[这个正则表达式](http://www.regex101.com/r/lL7jV4)

```
([a-z])(\1{2}) 
```

但无法得到解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T15:33:16.947

该网站上的谜题的解决方案是：

```
/(.)\1{2}/g 
```

由于键盘上的任何一个键都会卡住，所以我们需要使用`.`.

`\1`正则表达式中的意思是匹配第**一个**捕获组`(.)`匹配的任何内容。

替换为`$1`或`\1`。

您的正则表达式的其余部分是正确的，只是存在不必要的捕获组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T15:38:39.690

如果您想精确匹配三个字符，则您的正则表达式是正确的。如果你想匹配至少三个，那就是

```
([a-z])(\1{2,}) 
```

或者

```
([a-z])(\1\1+) 
```

因为除了第一次出现你不需要捕捉任何东西，这些稍微好一点：

```
([a-z])\1{2}   # your original regex (exactly three occurences)
([a-z])\1{2,}
([a-z])\1\1+ 
```

现在，替换应该恰好是字符的一次出现，仅此而已：

```
\1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:41:24.230

代替：

```
(.)\1+ 
```

和：

```
\1 
```

这当然要求您的正则表达式引擎支持反向引用......此外，在替换部分中，根据正则表达式引擎，`\1`可能必须写为`$1`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T15:39:33.057

我会这样做，`(\w)(\1+)?`但无法找到如何在给定站点内“删除”...

最好的方法是用空字符串替换第二次匹配的结果****

# c++ - 搜索 QV ariantList？

> ID：14083134
> 
> 赞同：2
> 
> 时间：2012-12-29T15:30:42.510
> 
> 标签：c++, qt

我有一个 SKU（SKU - 库存单位）列表`QVariantList`。

有没有办法搜索列表并从列表中获取数据？

例如，我想在列表中搜索“sku 0001”并获取 SKU 的关联标题。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:31:20.050

使用 qFind 从`<QtAlgorithms>`

例如：

```
QVariantList vl;
vl << 42 <<"hello"<<3.1415;
QVariantList::const_iterator v = qFind(vl,42);
int iv = (*v).toInt();
++v;
QString sv = (*v).toString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:37:46.750

```
for(QVariantList::const_iterator it = list.begin();
    it!=list.end();
    ++it)
{ 
    if(it->toString()=="sku 0001") 
    { 
       your code...
    } 
}; 
```

# java - GridBagLayout 没有正确排列按钮

> ID：14083135
> 
> 赞同：1
> 
> 时间：2012-12-29T15:30:51.810
> 
> 标签：java, sql, swing, gridbaglayout

![在此处输入图像描述](../Images/91da9e786f026cb3f54da495e64daf83.png)

以下是我用于将 MS Access 数据库连接到 Java 程序的代码。该按钮与**ID**`Next`的开头不对齐： `JLabel`

 **```
public DisplayScreen(){

        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (ClassNotFoundException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } catch (InstantiationException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } catch (IllegalAccessException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } catch (UnsupportedLookAndFeelException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        this.setLayout(new GridBagLayout());
        this.setVisible(true);
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);
        GridBagConstraints gbc = new GridBagConstraints();
        Insets in = new Insets(2,2,2,2);
        gbc.insets = in;

        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(l1,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(f1,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(l2,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(f2,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(l3,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(f3,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(l4,gbc);

        gbc.gridx++;
        gbc.gridwidth = 1;
        gbc.gridheight = 1;
        this.add(f4,gbc);

        gbc.gridx = 1;
        gbc.gridy = 1;
        gbc.gridheight = 1;
        gbc.gridwidth = 1;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        this.add(next,gbc);

        gbc.gridx++;
        gbc.gridheight = 1;
        gbc.gridwidth = 2;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        this.add(last,gbc);

        gbc.gridx += 2;
        gbc.gridheight = 1;
        gbc.gridwidth = 2;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        this.add(first,gbc);

        gbc.gridx += 2;
        gbc.gridheight = 1;
        gbc.gridwidth = 2;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        this.add(prev,gbc);

        this.setResizable(false);
        this.pack();
        try{
            r = new Query().getResultSet();
            r.next();
            f1.setText(r.getString("studID"));
            f2.setText(r.getString("fName"));
            f3.setText(r.getString("lName"));
            f4.setText(r.getString("fee"));
        }catch(Exception e){
            e.printStackTrace();
        }

    } 
```

请告诉我出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:36:50.557

```
 gbc.gridx = 1;
    gbc.gridy = 1;
    gbc.gridheight = 1;
    gbc.gridwidth = 1;
    gbc.fill = GridBagConstraints.HORIZONTAL;
    this.add(next,gbc);

    gbc.gridx++; 
```

当然应该是

```
 gbc.gridx = 0;
    gbc.gridy = 1;
    gbc.gridheight = 1;
    gbc.gridwidth = 2;
    gbc.fill = GridBagConstraints.HORIZONTAL;
    this.add(next,gbc);

    gbc.gridx += 2; 
```

因为您希望它从行的开头开始，并填充两列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:36:01.210

您从 gridx = 1 开始第二行。位置从 0 开始编号！**

# asp.net-mvc-3 - 将选择列表中的第一个元素设置为 guid 为空

> ID：14083139
> 
> 赞同：1
> 
> 时间：2012-12-29T15:31:16.597
> 
> 标签：asp.net-mvc-3, guid

我有一个下拉列表如下： -

```
@Html.DropDownListFor(model => model.NewPipelineEaPersonId, new SelectList(Model.EaList, "PersonId", "FullName"), "Please select one", new { style = "width: 250px;" }) 
```

我的课程如下：-

```
public class LeadPipelineEntry
{
    [Required]
    public int PipelineTransactionId { get; set; }

    public Guid NewPipelineEaPersonId { get; set; }
} 
```

这部分不需要 Guid，但它仍然会引发必填字段错误。

我也不想将 guid 作为可空参数

我知道选择字段可以做到这些。

但是我可以将第一项“请选择一项”的值设为`Guid.Empty`吗？

我只想在视图中管理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:45:07.750

不，您不能将下拉列表的默认元素设置为空字符串以外的任何内容。DropDownListFor 助手根本不支持这一点。应该是这样的。如果您想在下拉菜单中允许空值，您应该在您的视图模型上使 Guid 可以为空。

如果您不能在视图模型上使 Guid 可以为空，那么`"Please select one"`为下拉列表提供默认选项 ( ) 绝对没有意义。

您可以编写一个自定义 DropDownList 帮助器，它将提供一些默认值而不是空字符串，或者手动生成选择 - 这两种方法都同样错误。

# qt - QGraphicsItem：缩放时禁用抗锯齿

> ID：14083144
> 
> 赞同：1
> 
> 时间：2012-12-29T15:31:37.973
> 
> 标签：qt, qgraphicsitem, qgraphicsscene

我有一个自定义 QGraphicsItem 来使用 QPainterPath 绘制一些图元。当我放大场景时，我希望看到该路径的像素没有抗锯齿。就像您在缩放时看到 QPixmap 像素一样。

我已经设置了渲染提示来禁用画家抗锯齿，但它似乎没有任何效果。至少它非常小。

有没有办法在高缩放级别上显示像素？或者看起来像像素的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:42:59.553

我能想到的唯一方法如下：

在您的 QGraphicsItem 中使用 QPixmapCache（或只是一个成员 QPixmap）。在缩放之前将 QGraphicsItem 渲染到 QPixmap。

现在在你的绘画中，你可以只绘制 QPixmap - 因此当它被放大时，你会“看到”像素。

如果您的对象具有复杂的paint()，这还具有加快绘画速度的优势。

# java - 如何在单个不可执行的 jar 中包含所有依赖的 jar？

> ID：14083151
> 
> 赞同：3
> 
> 时间：2012-12-29T15:32:14.067
> 
> 标签：java, jar, classpath, manifest, onejar

我陷入了一个非常普遍的问题。

我将我的 jar（对第三方供应商有很多依赖项）插入到应用程序服务器 lib 目录中。如果我只是将我的 jar 及其依赖项复制到服务器库中，那么服务器类路径会变得很长，因此服务器无法工作。因此，我想将这个 Jar 及其所有依赖项打包在一个 jar 中，这样服务器的类路径就不会变得太长。我在各种论坛上发现有一个实用程序可以做到这一点，即 OneJar。但是这个实用程序适用于可执行 jar。就我而言，我的最终 jar 将无法执行。

我还尝试了 ANT 提供的 ZIPFileSetGroup 实用程序，但这会导致清单文件出现安全问题。

你能帮我解决这个问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:11:37.333

如果使用maven构建，可以使用maven依赖插件，使用copy-dependency任务。它会在创建它时将所有依赖项复制到您的 jar 文件中。

如果手动将 jar 添加到 jar 文件中，则需要确保 jar 文件中包含 Manifest.mf 文件并在其中指定主类和类路径。

```
Manifest-Version: 1.0
Main-Class: com.mypackage.MainClass
Class-Path: my.jar log4j.jar 
```

另一种选择可能是构建一个 .ear 文件，这通常是您在将特定 jar 文件与它们打包时看到企业应用程序或 Web 应用程序的 .war 文件的方式。听起来您正在使用服务器，因此其中一种格式可能更适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:32:32.917

当你说

> 子进程从 server/lib 目录中获取类路径

这是一个在你控制之下的过程吗？如果父进程要指定类路径，就像

```
server/lib/* 
```

（即文字`*`）然后目标`java`进程将枚举`lib`目录本身中的 jar 文件——它们并不都需要在类路径中命名。

但是，如果父进程显式枚举`server/lib/*.jar`以构建`-cp`值，那么即使 JAR 不是“可执行”，您也可以利用`Class-Path`JAR 清单中的 in 生效这一事实。您可以使用这样的节来创建仅清单 JAR 文件

```
<!-- location of your 300 dependency JAR files, file1.jar ... file300.jar -->
<property name="lib.dir" location="lib" />
<fileset id="dependencies" dir="${lib.dir}" includes="*.jar" />

<pathconvert property="manifest.classpath" dirsep="/" pathsep=" "
             refid="dependencies">
  <map from="${lib.dir}" to="myapp" />
</pathconvert>

<jar destfile="myapp-manifest.jar">
  <manifest>
    <attribute name="Class-Path" value="${manifest.classpath}" />
  </manifest>
</jar> 
```

这将生成一个名为的 JAR 文件`myapp-manifest.jar`，其清单包含

```
Class-Path: myapp/file1.jar myapp/file2.jar ... myapp/file300.jar 
```

你把这个文件`server/lib`和 300 个依赖项放到一个新目录`server/lib/myapp`中。现在生成的`-cp`将只包含一个文件 ( `myapp-manifest.jar`)，但生成的 java 进程将拥有所有 300 个`myapp`JAR 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:44:37.087

`zipgroupfileset`在 ANT 中的 jar 任务中使用是最简单的方法。

```
<jar destfile="MyApplication.jar" filesetmanifest="mergewithoutmain">
  <zipgroupfileset dir="lib" includes="*.jar" /> 
  <!-- other options -->
  <manifest>
    <attribute name="Main-Class" value="Main.MainClass" />
  </manifest>
</jar> 
```

请注意，设置为 mergewithoutmain 的*filesetmanifest*标志会合并除清单的 Main 部分之外的所有内容。

签名的 jar 导致需要手动处理的*SecurityException 。*如果与签名 jar 相关的任何类作为一个整体验证 jar 上的签名，那么这些将在运行时失败。针对特定文件的摘要签名将毫无问题地添加到清单中。由于问题是您的类路径变得太大，您可能无法将所有 jar 包捆绑到一个 jar 中，而是将它们中的大部分合并，使 CLASSPATH 易于管理。

还有：[http ://code.google.com/p/jarjar/](http://code.google.com/p/jarjar/)

使用所有依赖的 jar 创建目标目录。接下来将 10 个 jar 移动到临时目录中，并继续以 10 个为一组移动 jar，每次尝试从该组创建单个 jar。当您收到安全异常时，您可以确定是哪一个导致了问题。尝试分而治之的方法。如果你有 300 个罐子，那么只需要这样做 30 次。

# android - 需要找到适用于移动设备的 Actionscript 3.0 lib/framework/engine

> ID：14083154
> 
> 赞同：0
> 
> 时间：2012-12-29T15:32:24.550
> 
> 标签：android, ios, actionscript-3, frameworks

我有 Java 和 Actionscript 3.0 的编程经验，但现在我正在寻找用于 ActionScript 3.0 的 lib/framework 或引擎，因为我想为 android 和 ios 制作游戏。这似乎并不那么容易。我尝试过闪光朋克、八哥、柑橘引擎。我喜欢flashpunk，但似乎它根本不适合手机。Starling 可能是因为我没有花足够的时间在上面，但在继续之前，我需要知道我应该做什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:59:26.860

我使用 Starling 和 Flash CS6 在 App Store、Google play 和 Amazon 商店发布游戏。如果您使用具有共享库和不同 fla 文件的项目来针对所有平台，则相对容易。

# c# - 如何使用 Git 在 Azure 上部署 C#、MVC4 应用程序

> ID：14083156
> 
> 赞同：4
> 
> 时间：2012-12-29T15:32:25.450
> 
> 标签：c#, git, azure, asp.net-mvc-4, visual-studio-2012

我正在 Visual Studio 2012 中的 .NET 上开发 C#、MVC4、EF5 Code First 应用程序，并使用 VS 发布机制将其部署到带有 Azure SQL 数据库的 Azure 网站。

我现在想使用 Git 和 GitHub 进行版本控制，并让其他人参与到项目中。

然而，虽然我熟悉在 LAMP 环境中使用 Git，但我没有在 Windows、Azure 网站和编译环境中使用 Git 的经验。

我想使用 Azure 网站作为生产服务器，另一个 Azure 网站作为暂存服务器，使用 Visual Studio 进行开发的开发人员 Windows 机器和 GitHub 作为中央存储库。

这里有一篇有用的文章：http: [//www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-git/](http://www.windowsazure.com/en-us/develop/net/common-tasks/publishing-with-git/)。我可以了解这里需要什么，例如 Azure 上的 PHP 应用程序。但我不确定使用已编译应用程序的最佳方法以及使用 Azure 网站和 Visual Studio 可以实现什么。

向正确方向轻推一两次将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T02:03:59.293

不要从 VS 发布到 azure，而是将您的 azure 网站设置为从 github 存储库中提取。部署过程编译您的解决方案。

观看[http://www.youtube.com/watch?v=5NGieL0tinw&feature=youtu.be&hd=1](http://www.youtube.com/watch?v=5NGieL0tinw&feature=youtu.be&hd=1) 或阅读[http://vishaljoshi.blogspot.com/2012/09/continuous-deployment-from-github-to.html](http://vishaljoshi.blogspot.com/2012/09/continuous-deployment-from-github-to.html)

SocttGu也在他的博客@http://weblogs.asp.net/scottgu/archive/2012/09/17/announcing-great-improvements-to-windows-azure-web-sites.aspx上宣布了这一点，[他](http://weblogs.asp.net/scottgu/archive/2012/09/17/announcing-great-improvements-to-windows-azure-web-sites.aspx) 还谈到了一个发布分支的酷炫功能，这将满足您对阶段服务器和生产服务器的要求。有一个阶段分支和一个生产分支，并根据需要合并到它们。请参阅“支持多个分支”部分

看起来他们终于增加了对私人回购的支持。

appharbor 是做类似事情的 azure 的竞争对手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:41:39.177

您基本上是在引入一个新步骤，要求必须先编译源代码，然后才能将其部署到服务器。在哪里实施此步骤取决于您。你可以：

1.  确保您的目标服务器具有编译源代码的能力（一些持续集成工具可以帮助解决这个问题，例如 CruiseControl.NET）。这有一个警告，即目标服务器能够编译源代码（甚至可能需要安装 Visual Studio），因此这可能不是一个选项。
2.  将编译后的二进制文件检查到源代码管理中。您可以将这些编译后的二进制文件与主源分支分开，以保持干净。将二进制文件部署到目标服务器。
3.  前两种选择的一些混合也是可能的；您可以使用 CruiseControl.NET 设置持续集成服务器，该服务器可以检查当前源，构建它，并将生成的二进制文件检查回一个特殊的分支，然后将该分支部署到您的目标服务器。

# vb.net - 在 vb.net 中创建一个 utc 日期以在 mongodb 中设置

> ID：14083157
> 
> 赞同：0
> 
> 时间：2012-12-29T15:32:32.297
> 
> 标签：vb.net, mongodb, mongodb-.net-driver

我在使用 mongodb c# 驱动程序时遇到了一些问题，因为它似乎将我所有的日期都转换为 UTC 格式。

我有

```
Dim cDate as Date
Dim year as integer = 2012
Dim month as integer = 12
Dim day as integer = 21
cDate = New Date(year, month, day) 
```

然而，通过 C# 驱动程序将其放入 mongodb 数据库似乎会将其转换为 UTC，所以突然之间它现在是不同的一天，因为它的 now `11:00 PM 20th December 2012`. 不完全是我想要的！

有没有一种方法可以创建`New Date(year, month, date`这样的 UTC 模式？因此，如果我这样做了，`cDate.utcNow`我会得到与 cDate 相同的东西，本质上是 cDate.utcNow = cDate？

我用驱动程序尝试了各种各样的东西，结果却撞到了砖墙，比如使用`DateTimeSerializationOptions.Defaults`无济于事，什么也没发生！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T19:25:04.303

要将日期创建为 UTC 日期，只需在构造函数中指定 Kind 参数以及小时、分钟和秒：

```
cDate = New Date(year, month, day, 0, 0, 0, DateTimeKind.Utc) 
```

# c# - 如何在 CheckedListBox 中显示一些记录

> ID：14083158
> 
> 赞同：2
> 
> 时间：2012-12-29T15:32:31.523
> 
> 标签：c#, .net, winforms

我是.net的初学者。

我需要在 CheckedListBox 中显示一些记录。

我在数据集中有表（猫）：

![在此处输入图像描述](../Images/a1844283bea30a822f86136402d58b5b.png)

我需要在 CheckedListBox 控件中显示数据表（颜色列）的内容。

如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:35:01.840

看来[CheckedListBox 不支持 binding](https://stackoverflow.com/a/8216010/897326)，因此这将无法按预期工作：

```
CheckedListBox1.DataSource = tempDataSet.Tables("Cat")
CheckedListBox1.DisplayMember = "Color"
CheckedListBox1.ValueMember = "ID" 
```

您可以改用[Bindable CheckedListBox](http://www.codeproject.com/Articles/14916/Bindable-CheckedListBox)。然后您可以在设计时使用“属性”窗口进行绑定：

![在此处输入图像描述](../Images/a5feb2ac622549f5aff8de40f9ed4606.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:40:54.957

你可以点击这个链接：

[如何在窗口应用程序的checkedlistbox中绑定数据](http://www.codeproject.com/Questions/307681/how-to-bind-data-in-checkedlistbox-in-window-appli)

或试试这个模板：

```
SqlDataAdapter da = new SqlDataAdapter("SELECT NAME AC_CODE FROM AccountM where compcode='" + Compcls.Gcomp_cd + "'", con);

DataSet ds = new DataSet();
da.Fill(ds, "AccountM ");
checkedListBox1.DataSource = ds;

checkedListBox1.SelectedValue = "AC_CODE";
checkedListBox1.SelectedItem = "NAME"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T10:13:43.943

假设您将`checkedListBox1.SelectedValu`e 保存在 db 中，您可以执行以下操作：

1.  将数据加载到数据表中，例如`myDt`
2.  循环数据表中的每个数据行并根据`dr`值 设置检查状态

    ```
    foreach (DataRow dr in myDt.Rows)
    {
         checkedListBox1.SelectedValue = dr[0].ToString();
         checkedListBox1.SetItemChecked(checkedListBox1.SelectedIndex, true);
    } 
    ```

希望这可以帮助...

# php - 使用 PHP 在两个不同的 mysql 表中查找未链接的列

> ID：14083161
> 
> 赞同：0
> 
> 时间：2012-12-29T15:32:44.550
> 
> 标签：php, mysql, database

所以我有两张桌子，一张叫做“问题”，一张叫做“测试”。“问题”中的每一行都有“id”、“test”列和与该问题无关的其他几列。'tests' 表有列 'id'、'name' 和其他几个不相关的列。

基本上，在我的网站上，每次有人创建测试时，都会在“测试”中创建一个新行，并给它一个“id”。从那里，用户提出的每个问题，都会在“问题”表中创建一个新行，每个问题都有一个“id”以及与“测试”表中的“id”具有相同编号的“测试”列它所属的。

昨天我们错误地从'tests'表中删除了几行，但是所有的问题仍然在'questions'表中，这意味着我们只需要找到'questions'表中的哪些行的'test'值不是链接到 'tests' 表中的任何 'id'，所以这是我们想出的 .php 脚本：

```
<?php
$conn = mysql_connect ('localhost', 'hidden',  'hidden') or die ('Error connecting');
if (!$conn) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('hidden', $conn);
$sql = "SELECT * FROM questions";
$result = mysql_query($sql,$conn);

while ($row = mysql_fetch_array($result)) {
    $test = $row['test'];
    $questionID = $row['id'];
    $sql2 = "SELECT * FROM tests where id = $test";
    $result2 = mysql_query($sql2, $conn);
    $row2 = mysql_fetch_array($result2);
    $num_rows = mysql_num_rows($result2);
    if ($num_rows == 0) {
        echo "Unlinked question: $questionID (test $test) <br/>";
    }
}
?> 
```

但是，它不会回显任何“未链接的问题..”，这将帮助我们确定哪些测试我们丢失并需要重新创建，为它们提供正确的“id”以链接到“问题”表的“测试”列。有没有其他方法可以解决这个问题？是的，我们确实备份了表格，但不幸的是我们每隔一周才做一次，而且大部分删除的测试都是最近的。

更新：

```
$sql = "
SELECT q.id AS QuestionID
FROM questions q
LEFT JOIN tests t
ON  (q.test = t.id)
WHERE q.test IS NOT NULL AND t.id IS NULL";

$result = mysql_query($sql,$conn) or die(mysql_error());
while ($row = mysql_fetch_array($result)) {
$questionID = $row['QuestionID'];
$testID = $row['test'];
echo $row;
echo "The question with the id: $questionID is not linked to the test: $testID";
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:37:33.400

为什么不在一条 SQL 语句中执行此操作？

```
SELECT
    q.id AS QuestionID,
    CASE WHEN q.test IS NOT NULL AND t.id IS NULL THEN 1 ELSE 0 END AS UnlinkedQuestion
FROM
    questions q
LEFT JOIN
    tests t
    ON  (q.test = t.id) 
```

或者，如果您只想返回未链接的问题 ID，只需将逻辑移动到 WHERE 子句中：

```
SELECT
    q.id AS QuestionID
FROM
    questions q
LEFT JOIN
    tests t
    ON  (q.test = t.id)
WHERE
    q.test IS NOT NULL AND
    t.id IS NULL 
```

**笔记：**

我强烈建议您在测试 id 上的*问题*表中添加外键约束，这样您就可以防止意外从*测试*表中删除记录时出现同样的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:40:49.953

请记住添加`or die(mysql_error())`到`mysql_*`函数的末尾，以便更容易识别任何问题。

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# android - 当偏好结构在新版本中发生变化时，Android 用户偏好的现有数据会发生什么变化？

> ID：14083165
> 
> 赞同：9
> 
> 时间：2012-12-29T15:33:27.033
> 
> 标签：android, preferences, updates

例如，如果添加或删除了一些首选项条目，当应用更新为新的首选项结构时，Android 如何处理现有的首选项数据？

我很抱歉这个基本问题，但我勤奋的搜索和阅读无法找到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T16:38:17.840

共享首选项存储在文件夹中的 xml 文件中`data/data/your.application.package/shared_prefs/`。该文件称为`your.application.package_preferences.xml`；

当您检索共享首选项时，您调用[Context.getSharedPreferences](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/ContextImpl.java#ContextImpl.getSharedPreferences%28java.lang.String,int%29)方法。它创建`SharedReferences`对象并调用[SharedReferences.startLoadFromDisk](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/SharedPreferencesImpl.java#SharedPreferencesImpl.startLoadFromDisk%28%29)方法。

如果打开此方法，您将看到带有首选项 ( `mFile`) 的 xml 文件已被解析，首选项已加载到内存存储 ( `map`) 中。

```
BufferedInputStream str = new BufferedInputStream(new FileInputStream(mFile), 16*1024);
map = XmlUtils.readMapXml(str); 
```

从那时起，您将始终从内存中读取您的偏好。更确切地说来自`private Map<String, Object> mMap`变量。此外，应用程序可以调用[startReloadIfChangedUnexpectedly](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/app/SharedPreferencesImpl.java#SharedPreferencesImpl.startReloadIfChangedUnexpectedly%28%29)方法，如果底层文件已更改，则会对其进行解析并创建一个新的 HashMap。

关于你的问题，有以下几种情况：

1.  您在新版本中添加了首选项。然后将返回指定为第二个参数的默认值。注意：属性 android:defaultValue 没有使用，所以要注意。

    `String v = (String)mMap.get(key); // not found => v = null`

    `return v != null ? v : defValue; // return defValue`

2.  您删除了新版本中的首选项。xml 文件和`map`对象会包含一些冗余数据，但会在用户下次保存首选项时修复。

3.  您将首选项的键更改为某个未使用的键。然后将返回默认值。结果与第 1 页相同。

4.  您删除了一个首选项（`pref1_key`例如，使用键 ）并更改了另一个项目的键，以便它引用第一个项目（从`pref2_key`到`pref1_key`）。然后第二个首选项将具有第一个项目的值。

5.  您更改了首选项的类型（例如，从 boolean 更改为 int）。然后它会因为这个和类似的代码抛出 CastException `(Integer)mMap.get(key);`：。但是您可以将例如 EditTextPreference 更改为 ListPreference，因为它们都具有 String 类型。

也许还有一些测试用例，但到目前为止我只做了 5 个。

这里也是带有 ListPreference、EditTextPreference 和 CheckBoxPreference 的首选项文件的示例：

```
<?xml version='1.0' encoding='utf-8' standalone='yes' ?>
<map>
    <string name="pref_theme_key">THEME_LIGHT</string>
    <string name="pref_homepage_key">test</string>
    <boolean name="pref_display_name_key" value="true" />
</map> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:49:06.733

> 当应用更新为新的偏好结构时，Android 如何处理现有的偏好数据？

目前尚不清楚“首选项结构”是什么意思。

您可以将 a`SharedPreferences`视为持久性`HashMap`。您将各种值存储在各种键下，以后可以取回它们。在您实际存储某些内容之前，Android 对键或将存储在这些键下的值的类型没有*先验知识。*

我的猜测是，通过“首选项结构”，您的意思是“XML 中的首选项屏幕定义”。在这种情况下：

*   如果您添加新的首选项，Android 将正常处理这些首选项，就像这些首选项一直存在但用户之前从未设置过这些首选项一样

*   如果您删除以前使用过的首选项，旧数据仍然存在，除非您选择删除它，因为 Android 无法知道您将永远不会再次使用该数据

*   如果您重新键入首选项（即，替换`keyA`为`key1`逻辑上相同的首选项），Android 将`key1`视为一个全新的首选项，因此您需要在代码中的某处放置智能以更新您的`SharedPreferences`数据以反映密钥改变，如果你愿意

管理首选项“模式版本”并帮助您迁移数据没有任何`SharedPreferencesOpenHelper`等价物。`SQLiteOpenHelper`欢迎您创建这样的系统，如果您愿意，如果您觉得它可以帮助您管理经常变化的“偏好结构”。

# php - 我可以将变量传递给函数吗？

> ID：14083170
> 
> 赞同：0
> 
> 时间：2012-12-29T15:33:57.313
> 
> 标签：php, mysql

我正在尝试重构一些代码，但我有点困惑。我像这样定义我的数据库连接：

```
try{
    global $conn;
    $conn = new PDO("mysql:host=$host",$root,$pw); [...] 
```

现在我想要一个用于检索表行的函数，但它需要`$conn`. 有什么方法可以传递`$conn`给这个函数吗？我试图将其设置为默认值，但这不起作用：

```
function get($table,$conn=$conn,$limit=10){ [...] 
```

然后我尝试了`use`关键字，但我认为它仅适用于匿名函数：

```
function get($table,$limit=10)use($conn){
    $query = $conn->query(" [...] 
```

其他人如何做到这一点？我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:42:10.053

```
function get($table, $limit=10) 
```

正如您在问题中已经写的那样，这个函数头是不完整的。没有`$conn`.

由于这是全局命名空间中的一个函数，最直接的方法可能是使用全局变量：

```
function conn_get($table, $limit=10) {

    global $conn; 
```

我还对函数进行了命名空间以使关系清晰。这个问题有两点：

1.  全局函数的维护成本很高
2.  全局变量的维护成本很高

因此，在这种情况下，您通常所做的是将其包装到一个类中：

```
class Conn
{
    private $conn;

    public function __construct(PDO $conn) {

        $this->conn = $conn;
    }

    public function get($table, $limit=10) {

       $query = $this->conn->query("[...]");
       ...
    }
} 
```

然后传递一个`Conn`可以使用的对象：

```
$pdo  = new PDO("mysql:host=$host", $root, $pw);
$conn = new Conn($pdo); 
```

接着：

```
$conn->get('ColorTable', 200); 
```

私有变量接管了全局变量的角色，其好处是同一对象内的每个方法都可以访问它。所以现在一切都在它自己的空间中，与全局空间相反，不会那么快地进入对方。随着时间的推移，这很容易（更容易）更改和维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:38:12.120

当您调用该函数时，即：

```
$table_rows = get($table, $conn); 
```

您正在函数范围内传递局部变量。

但是，您不能将非静态变量定义为默认值：`$conn=$conn`将引发致命错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:38:21.437

您可以做的最简单的事情是创建一个函数，该函数将返回`$conn`变量

```
function conn (){
   $conn = NULL;
   ...some database connection setup etc...
   return $conn;
} 
```

并将其调用到您需要使用它的其他功能

```
function getDb(){
 conn()->query(" [...]");
} 
```

该`conn()`函数将可用于您的 PHP 脚本中的所有函数。

但是，如果您打算制作更复杂的 Web 应用程序，我建议您使用 PHP 框架或制作 PHP 类并应用 OOP 原则来为您处理数据库连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T15:40:38.170

在 PHP 中，`use`是匿名 / lambda 函数的方式，而不是普通函数。

如果您的数据库连接在全局范围内飞来飞去，您可以将其作为普通变量传递给您的函数，如下所示：

```
function get(PDO $conn, $table,$limit=10) {
    $query = $conn->query(" [...]
} 
```

除此之外（不好的做法！）是将全局`$conn`变量放入函数中，如下所示：

```
function get($table,$limit=10) {
    $query = $GLOBALS['conn']->query(" [...]
} 
```

但是，推荐使用面向对象的方法！您可能希望[通过依赖注入将数据库类注入](http://en.wikipedia.org/wiki/Dependency_injection)到您需要的类中。

# c++ - 写入文件时将双精度点转换为逗号

> ID：14083177
> 
> 赞同：1
> 
> 时间：2012-12-29T15:34:43.243
> 
> 标签：c++

我正在开发一个小型导出功能，我需要编写由 6x 组成的 100 万行`doubles`。不幸的是，读取数据的工具需要用逗号替换点。我现在转换它们的方式是在编辑器中手动替换，这对于大约 20MB 的文件来说既麻烦又非常慢。

有没有办法在写作时进行这种转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:50:44.073

使用类似的工具`tr`比手动操作要好，应该是您的首选。否则，通过过滤 streambuf 输入相当简单，它将 all 转换`'.'` 为`','`，甚至仅在特定上下文中转换（例如，当前面或后面的字符是数字时）。没有上下文：

```
class DotsToCommaStreambuf : public std::streambuf
{
    std::streambuf* mySource;
    std::istream* myOwner;
    char myBuffer;
protected:
    int underflow()
    {
        int ch = mySource->sbumpc();
        if ( ch != traits_type::eof() ) {
            myBuffer = ch == '.' ? ',' : ch;
            setg( &myBuffer, &myBuffer, &myBuffer + 1 );
        }
    }
public:
    DotsToCommaStreambuf( std::streambuf* source )
        : mySource( source )
        , myOwner( NULL )
    {
    }
    DotsToCommaStreambuf( std::istream& stream )
        : mySource( stream.rdbuf() )
        , myOwner( &stream )
    {
        myOwner->rdbuf( this );
    }
    ~DotsToCommaStreambuf()
    {
        if ( myOwner != NULL ) {
            myOwner.rdbuf( mySource );
        }
    }
} 
```

只需使用此类包装您的输入源：

```
DotsToCommaStreambuf s( myInput ); 
```

只要`s`在范围内，`myInput`就会将`'.'` 它在输入中看到的所有内容转换为`','`.

## 编辑：

从那以后，我看到了您希望在生成文件时而不是在阅读文件时发生更改的评论。原理是一样的，只是过滤的streambuf有一个`ostream`所有者，并且覆盖了`overflow( int )`，而不是 `underflow`。在输出时，您不需要本地缓冲区，因此更简单：

```
int overflow( int ch )
{
    return myDest->sputc( ch == '.' ? ',' : ch );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:41:00.733

我会利用 c++ Algotithm 库`std::replace`来完成工作。将整个文件读入 a`string`并调用 replace：

```
std::string s = SOME_STR; //SOME_STR represents the set of data 
std::replace( s.begin(), s.end(), '.', ','); // replace all '.' to ',' 
```

# c++ - 为什么要麻烦使用 Apache 或 Nginx 等？

> ID：14083180
> 
> 赞同：6
> 
> 时间：2012-12-29T15:35:19.490
> 
> 标签：c++, c, webserver

我被分配了一个项目，该项目需要我添加一些 HTML 页面服务。这个嵌入式系统（运行 Linux CentOS 6.3）有一些额外的可用资源，但也已经承担了许多责任。

我考虑过 Apache，但由于臃肿而放弃了它，我研究了 Nginx，但现在也回避了。似乎我获得了更多的“功能”，因此 CPU 使用率超出了我的需要。

有人能告诉我为什么我不使用异步套接字自己实现 HTTP 协议吗？

我的具体需求是：

1.  接收和解码 GET 和 POST。

2.  按要求发送 CSS、JS 和 JPG 文件。

3.  根据 GET/POST 的解码输出 header、cookie、head 和 body 数据。

鉴于我不需要这些网络服务器提供的无数东西，我是否天真地假设自己做这件事？你会建议或警告什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T15:43:36.113

基本上，您使用 Web 服务器是因为您可以通过已经过测试的形式获得所需的功能，比您的第一个代码可能更可靠，并且得到大量其他人的支持。如果 Apache 和 nginx 对你来说太重了（尽管 nginx 的特点是它对于重负载的轻量级），特别是如果你期望的负载非常轻，那么请四处寻找其他选择。

Wiki 有一整页的[轻量级 Web 服务器比较。](http://en.wikipedia.org/wiki/Comparison_of_lightweight_web_servers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:50:47.197

一个容易掉入的陷阱：认为“我不需要产品 X 中的所有功能，我只需编写自己需要的功能”，结果最终完全重新实现了产品 X，这是一个新发现的需求一次。

我有点怀疑，一个可以正常运行 CentOS 的嵌入式系统资源匮乏，以至于它不能舒适地运行 Nginx（甚至是 Apache，人们在 Raspberry Pi 上运行它并通过适当的配置调整就可以了），给出合理的假设：您实际服务的页面数量。我在 Pentium 266 上运行它，它有 256MB 的 RAM，为一些简单的 PHP 应用程序提供服务，这些应用程序大约每两秒提供一个页面，没有任何问题。我记得，它是相当模块化的，所以你可以选择不加载你认为不需要的功能。而且，稍后，当您的需求发生变化并且您发现确实需要它时，您可以将其重新插入 :)

如果您真正关心资源消耗，请查看专为嵌入式应用程序设计的 Web 服务器。我听说[切诺基](http://www.cherokee-project.com/)很不错。[猫鼬](https://code.google.com/p/mongoose/)看起来也很有前途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:58:41.677

你可以走得更远，我从这个[http://www.w3.org/Protocols/HTTP/HTTP2.html开始](http://www.w3.org/Protocols/HTTP/HTTP2.html)

# php - 在 php - wordpress 中使用 foreach 循环

> ID：14083182
> 
> 赞同：-5
> 
> 时间：2012-12-29T15:35:29.057
> 
> 标签：php, wordpress

我正在尝试从 foreach 循环中排除电子邮件代码，目前电子邮件成功消息显示 3 次。我尝试了不同的组合，但不能让它只显示一次......？

有任何想法吗..？谢谢

```
if (isset($_POST['submit'])) {

    $posted = $_POST;
    $options = array('option-1' => __('Procedure: Suture Skin Wounds', 'appthemes'),
            'option-2' => __('Procedure: Cat castration', 'appthemes'),
            'option-3' => __('Procedure: Cat spay', 'appthemes')
    );

    foreach ($options as $option => $value) {

        if ($posted[$option] == "selected") {
            echo "<li class='error-list'>";
            echo "Please select an answer for:" . "  " . $value . " >  
     " . '<a  href="' . get_permalink(30) . '">Back to form</a>';
            echo "</li>";
        }// if == "selected"
        else/* if(isset($_POST['submit'])) */ {

            $adminemail = get_option('admin_email');

            $ToEmail = $adminemail;
            $EmailSubject = 'Skills Assessment Form';
            $mailheader = "From Leapfrog";
            $mailheader .= "Reply-To: " . $_POST["email"] . "\r\n";
            $mailheader .= "Content-type: text/html; charset=iso-8859-1\r\n";
            $MESSAGE_BODY = "Form:Small Animal\n";
            $MESSAGE_BODY = "Name: " . $_POST["canname"] . "\n\n";
            $MESSAGE_BODY .= "\n\n" . "Procedure: " . "Suture Skin Wounds: " . $_POST["option-1"];
            $MESSAGE_BODY .= "\n\n" . "Procedure: " . "Cat castration: " . $_POST["option-2"];
            $MESSAGE_BODY .= "\n\n" . "Procedure: " . "Cat spay: " . $_POST["option-3"];

            mail($ToEmail, $EmailSubject, $MESSAGE_BODY, $mailheader) or die("Failure");
            echo "Your skills assessment form has been Sent:" . "  " .
            '<a href="' . get_permalink(13) . '">Back to your Dashboard</a>';
            //echo '<a href="'.get_permalink(13).'">Dashboard</a>';
        }//else                                  
    }//foreach loop;      
}//if isset 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:34:19.943

`foreach`您正在循环内执行所有操作：显示错误、发送消息和显示成功消息。

您需要将所有内容移出`foreach`循环，例如通过`$errors`在循环之前设置一个空数组并将所有错误消息添加到该数组。

然后，在循环之后，您可以检查`$errors`数组是否仍然为空并发送邮件并显示您的成功消息。如果不是，则显示所有错误。

# c# - Direct3D 上传视频纹理

> ID：14083188
> 
> 赞同：0
> 
> 时间：2012-12-29T15:36:48.170
> 
> 标签：c#, slimdx, direct3d9

我正在尝试在 Direct3D 9 设备上播放视频，使用：

1.  nVLC - 用于从文件中获取 RGB32 帧
2.  SlimDX - 实际上使用纹理在视频设备上显示帧。

这是我接收 RGB32 帧的代码；

```
 _videoWrapper.SetCallback(delegate(Bitmap frame)
                            {
                                if (_mainContentSurface == null || _dead) 
                                    return;

                                var bmpData = frame.LockBits(new Rectangle(0, 0, frame.Width, frame.Height), ImageLockMode.ReadOnly, frame.PixelFormat);
                                var ptr = bmpData.Scan0;

                                var size = bmpData.Stride * frame.Height;
                                _mainContentSurface.Buffer = new byte[size];

                                System.Runtime.InteropServices.Marshal.Copy(ptr, _mainContentSurface.Buffer, 0, size);

                                _mainContentSurface.SetTexture(_mainContentSurface.Buffer, frame.Width, frame.Height);
                                _secondaryContentSurface.SetTexture(_mainContentSurface.Buffer, frame.Width, frame.Height); // same buffer to second WINDOW

                                _mainContentSurface.VideoFrameRate.Value =_videoWrapper.ActualFrameRate;

                                frame.UnlockBits(bmpData);
                            }); 
```

这是我对 SetTexture 和将纹理映射到正方形的实际用法：

```
public void SetTexture(byte[] image, int width, int height)
{
    if (Context9 != null && Context9.Device != null)
    {
        if (IsFormClosed)
            return;

        // rendering is seperate from the "FRAME FETCH" thread, if it makes sense.
        // also note that we recreate video texture if needed.
        _renderWindow.BeginInvoke(new Action(() =>
                                {
                                    if (_image == null || _currentVideoTextureWidth != width || _currentVideoTextureHeight != height)
                                    {
                                        if(_image != null)
                                            _image.Dispose();

                                        _image = new Texture(Context9.Device, width, height, 0, Usage.Dynamic, Format.A8R8G8B8,
                                                            Pool.Default);

                                        _currentVideoTextureWidth = width;
                                        _currentVideoTextureHeight = height;

                                        if(_image == null)
                                            throw new Exception("Video card does not support textures power of TWO or dynamic textures. Get a video card");
                                    }

                                    //upload data into texture.
                                    var data = _image.LockRectangle(0, LockFlags.None);
                                    data.Data.Write(image, 0, image.Length);
                                    _image.UnlockRectangle(0);
                                }));
    }
} 
```

最后是实际渲染：

```
 Context9.Device.SetStreamSource(0, _videoVertices, 0, Vertex.SizeBytes);
    Context9.Device.VertexFormat = Vertex.Format;

    // Setup our texture. Using Textures introduces the texture stage states,
    // which govern how Textures get blended together (in the case of multiple
    // Textures) and lighting information.
    Context9.Device.SetTexture(0, _image);

    // The sampler states govern how smooth the texture is displayed.
    Context9.Device.SetSamplerState(0, SamplerState.MinFilter, TextureFilter.Linear);
    Context9.Device.SetSamplerState(0, SamplerState.MagFilter, TextureFilter.Linear);
    Context9.Device.SetSamplerState(0, SamplerState.MipFilter, TextureFilter.Linear);

    // Now drawing 2 triangles, for a quad.
    Context9.Device.DrawPrimitives(PrimitiveType.TriangleList, 0, 2); 
```

现在，它可以在我的机器上运行。没有什么问题。每个视频文件和每个位置。但是当我检查WinXP时，画面完全坏了。这是非工作和工作的屏幕截图；

[http://www.upload.ee/image/2941734/untitled.PNG](http://www.upload.ee/image/2941734/untitled.PNG)

[http://www.upload.ee/image/2941762/Untitled2.png](http://www.upload.ee/image/2941762/Untitled2.png)

请注意，在第一张图片上，它们是 _maincontentSurface 和 _secondaryContentSurface。有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T18:49:05.867

您不需要每次都重新创建纹理，只需将其创建为动态的：

```
this.Texture = new Texture(device, w, h, 1, Usage.Dynamic, Format.X8R8G8B8, Pool.Default); 
```

关于复制问题可能来自步幅（行长可能因填充而不同）：

获得纹理的行间距：

```
 public int GetRowPitch()
    {
        if (rowpitch == -1)
        {
            DataRectangle dr = this.Texture.LockRectangle(0, LockFlags.Discard);
            this.rowpitch = dr.Pitch;
            this.Texture.UnlockRectangle(0);
        }
        return rowpitch;
    } 
```

如果你的纹理行间距等于你的帧间距，你可以复制你的方式，否则你可以这样做：

```
 public void WriteDataPitch(IntPtr ptr, int len)
    {
        DataRectangle dr = this.Texture.LockRectangle(0, LockFlags.Discard);

        int pos = 0;
        int stride = this.Width * 4;

        byte* data = (byte*)ptr.ToPointer();
        for (int i = 0; i < this.Height; i++)
        {
            dr.Data.WriteRange((IntPtr)data, this.Width * 4);

            pos += dr.Pitch;
            dr.Data.Position = pos;
            data += stride;
        }
        this.Texture.UnlockRectangle(0);
    } 
```

如果你想要一个完整的带有 slimdx 的 vlc 播放器的例子，请告诉我已经解决了（需要很好地包装它）

# javascript - node js创建服务器并连接

> ID：14083190
> 
> 赞同：0
> 
> 时间：2012-12-29T15:37:02.037
> 
> 标签：javascript, node.js

看下面的代码：

```
var server = net.createServer(function(socket) {
    //Code block A

    socket.on('connect', function() {
        //Code block B
    })

    socket.on('data' , function (data){
           //Code C     

    });

}); 
```

是否有机会执行代码块 A 而代码块 B 不会执行，反之亦然？如果是这样，在什么情况下？

反例：一旦代码 A 被执行，代码 C 可以多次运行，而代码 A 不会再次运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:08:37.680

好吧，如果你打电话`.listen()`，我想你会发现你得到了一个订单：

```
(Client connects) // "connect" event fires
   |
   v 
  [A]--*-----.  // This is the Socket's "connect" event firing.
       |     |  // B and C are bound to their respective events.
       |     |
       |     |
      [B] <--.  // Binds handler to "connection" event, but 
       |        // connection event fires instantly
       |
      [C] <--.  // "data" event is fired
             |
(Client sends data) 
```

此外，*A*永远不会在 B 之后开始执行，*因为**B*绑定到的套接字引用位于闭包*A*的范围内。

@Joe，我也认为这听起来像是采访，但嘿！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:44:22.423

这闻起来有点像面试类型的问题，但是...

1）A或B都不会运行，因为没有`server.listen`让它开始监听。

2）~~如果您调用`.listen`，则 A 将运行（如果 .listen 成功）但 B 在客户端连接到服务器之前不会运行。~~在连接上，A 将运行，然后是 B（假设连接成功）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T15:41:31.013

如果块 B 中的代码被执行，那么块 A 中的代码一定已经被执行。

# java - ASM - 拦截在方法之外进行的字段访问

> ID：14083191
> 
> 赞同：1
> 
> 时间：2012-12-29T15:37:10.823
> 
> 标签：java, instrumentation, java-bytecode-asm

我目前正在使用 ASM 拦截在目标应用程序中更改字段值的所有尝试，这按预期工作，因为 ASM 允许您在方法或构造函数代码段中添加或附加指令。

但是，在我看来，它是一种相当常见的开发人员范例，用于初始化方法或构造函数范围之外的字段，例如：

```
public class Example{

  //--VARIABLE INITIALIZATION OUTSIDE METHOD OR CONSTRUCTOR SCOPE ---
  private String aString = "A String Value";

  //zero argument constructor
  public Example(){

  }

  //all other methods.

} 
```

我的问题是：如何处理以这种方式进行的拦截字段访问的任务，即在方法或构造函数的上下文之外？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:41:43.530

这看起来像是在源代码中的构造函数之外，但实际上在字节码中，初始化程序都是构造函数的一部分——它们被编译器“移动”到构造函数中。初始化器放置*在*隐式或显式`super()`调用之后，但*在*构造函数的其余代码之前。这尤其意味着，如果您遇到这样的情况：

```
class Super {
  protected Super() {
    doSomeStuff();
  }

  protected abstract void doSomeStuff();
}

class Sub extends Super {
  private int number = 1;

  public Sub() {
    super();
    System.out.println("in Sub(): " + number);
  }

  protected doSomeStuff() {
    System.out.println("in doSomeStuff(): " + number);
  }
} 
```

然后`new Sub();`会打印

```
in doSomeStuff(): 0
in Sub(): 1 
```

因为`in doSomeStuff`打印发生在`Sub`字段初始化程序运行之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:40:48.687

所有代码都在方法内部（构造函数和静态初始化器也是方法）。

您可以在 Field 声明中看到字段的初始值，但编译器似乎并没有使用这些值。

```
private String aString = "A String Value";

//zero argument constructor
public Example(){

} 
```

是相同的

```
private String aString;

//zero argument constructor
public Example(){
    super();
    aString = "A String Value";
} 
```

# html - 绕过跨域限制 ajax - jquery and or iOS

> ID：14083200
> 
> 赞同：3
> 
> 时间：2012-12-29T15:38:30.307
> 
> 标签：html, ios, ajax, xcode, cross-domain

我有一个通过 UIWebView 加载本地 HTML 的 iOS 应用程序。HTML 通过 AJAX 连接到 jquery。对于 HTML，我有一个内容文件夹和一个容器文件夹。Content 文件夹有很多 html 文件，而 container 文件夹有一个 html 文件，它以特定顺序打开容器文件夹中较小的 html。问题是由于 AJAX 中的跨域限制，容器 HTML 不会从容器文件夹中加载任何内容。有什么我可以通过 Xcode 添加的可以让我绕过限制的东西，或者我可以添加任何可以让我绕过它的 HTML/Jquery 吗？提前致谢！

```
 //ReplaceDIV
   function loadInDiv(source)
{
//  alert('start');
    $.ajax({
        url: source,
        async: false,
        crossDomain: true,
        success: function(data) {$('#content').append(data);},
    });
//  $.get(source, function(data) {
   //   alert(data);
   //   $('#contents').append(data);
   //   });
    //      $(destination).load(source);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:04:18.850

消除：

`crossDomain: true,`

你应该准备好了。

编辑：

据我了解，手头的任务是使用 ajax 将一个 html 文件的内容加载到同一服务器上的另一个。当从本地资源的 UIWebView 中完成时，这将是 localhost 请求。来自 [JQuery 文档：

> 如果您希望在同一域上强制执行跨域请求（例如 JSONP），请将 crossDomain 的值设置为 true。例如，这允许服务器端重定向到另一个域。

在 localhost 请求上，强制跨域请求会破坏请求，导致它不加载任何内容。另外，作为旁注，跨域请求与您设置的同步请求不兼容：

`async: false,`

# c# - ApplicationPool 用户与 StartInfo.Username？

> ID：14083202
> 
> 赞同：4
> 
> 时间：2012-12-29T15:39:13.220
> 
> 标签：c#, iis, process, iis-7.5, w3wp

*我一直在测试（过去 4 天）在 iis7（asp.net）下启动进程的各种选项*

我*确实*找到了解决方案。

只要我们*不需要*与桌面交互，只需要运行`cmd`（*或类似的东西*），解决方案就很简单：

1.  `w3wp`用户`->`应该是*高*权限用户。

2.  进程启动信息 ( `StartInfo.Username`)*也*`->`应该是高权限用户。

 *但是，有一个问题（根据*我的*测试）：

> **两个**用户必须相同（如果我们要`cmd`执行）！这是唯一可行的方法。

所以这是我的两个问题：

*   为什么它们必须相同？*w3wp HighPrivileged*不能作为*HighPrivileged*`USerA`运行（通过 process.startInfo）吗？`cmd`*`USerB`*

**   两个用户都是域管理员。（他们也是我本地组中的管理员）。只有域管理员/本地管理员可以在本地机器上运行进程吗？* 

 **ps 所有文件夹权限都是`everyone : full controll`（包括`c:\windows\*.* /s`并包括 cmd.exe 权限），如上所述，两个用户都是本地计算机上的管理员，具有相同的克隆权限。IIS7 处理程序映射`*`[静态文件] 设置为读取+执行*

此外，完整的 cmd 命令是：

`cmd /c time /t >c:\1.txt`. 如果文件存在，则成功。（我成功，仅当两个帐户相同时）。

完整代码：

```
Process proc = new Process();
  proc.StartInfo.FileName = "cmd";
  proc.StartInfo.UserName = "Royin"; //<-- only if this user is the same as w3wp user , the operation succeed !
  proc.StartInfo.Domain = ...;
  proc.StartInfo.WorkingFolder = @"c:\windows\system32";
  proc.StartInfo.Password = ...
  proc.StartInfo.Arguments = @"/c time /t >c:\1.txt"
  proc.Start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T22:53:38.050

好的，首先，我强烈建议使用出色的 SysInternals ProcessMonitor 来帮助解决任何此类问题：[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)。

这个应用程序基本上会告诉你一个进程试图采取的每一个动作，所以在你的情况下，你会看到它尝试调用`QueryOpen`,`ProcessCreate`等。

您是否检查过失败场景下进程的 ExitCode 是什么？我愿意打赌它会以真钱的形式返回`0xC0000142 (-1073741502)`，这意味着“加载 DLL 失败”之类的东西。在 system32 路径下运行任何东西，即使使用特权用户凭据，也会遇到奇怪的权限问题，这也是由于创建进程的初始化过程。

基本上，`Process.Start`流程看起来像这样：

（假设：UserA == 运行 w3wp 的进程，UserB == 模拟 ctx，UserC == 进程启动信息中指定的凭据）

1.  首先，正如我们在其他对话中所讨论的，UserB 不会产生太大影响；任何流程创建内容都将基于“启动实体”的***流程令牌***，因此我们将查看 UserA 的凭据。

2.  运行时说“嘿，UserA 可以访问指定的文件名`StartInfo.FileName`吗？”

3.  Windows 响应是/否，但也“但是，要使用它，您还需要能够读取所有这些其他 DLL”

4.  运行时响应“好的，UserA 可以访问那些 DLL 吗？”

5.  如果以上所有的答案都是肯定的，那么运行时会说“好的，登录这个用户并尝试使用 cmd 行和参数创建一个新进程......”

您很可能会遇到 #2 或 #4 的问题，因为默认应用程序池标识对 System32 文件夹没有读取访问权限。这就是为什么当您将 w3wp 进程的身份切换到特权帐户时，它可以工作的原因。

您可以尝试几件事，但最简单的选择可能是切换回低权限帐户（如默认应用程序池标识），但授予该帐户对 system32 文件夹的只读访问权限。

不过，我**绝对**不会以特权用户身份运行 w3wp - 如果发生任何令人讨厌的事情，比如有人攻击你，那只会让人头疼。

哦，最后的想法：

*   **`UseShellExecute`如果你能帮助它，请**不要**设置为 true，它会做一些奇怪的事情。**

***   **`LoadUserProfile`如果你能帮上忙，**不要**设置为 true，它也会做一些奇怪的事情，而且速度也很慢。**

    ***   **如果可以，请**设置`CreateNoWindow`为 true，否则您会在服务器上看到很多窗口打开/关闭

    *   **请**使用`RedirectStandardOutput / RedirectStandardError`而不是管道输出，它更可控，并且在出现问题时提供更好的反馈。

    *   **如果它看起来不起作用，请务必检查进程的**ExitCode**********

# javascript - .replace() 在 jQuery 函数中不起作用

> ID：14083205
> 
> 赞同：2
> 
> 时间：2012-12-29T15:39:45.997
> 
> 标签：javascript, jquery

我不明白为什么 replace() 函数在我的 jQuery 函数中不起作用：

```
jQuery(document).ready(function($){
   var amount_min =  <?php if($_GET['amount_min']) echo $_GET['amount_min']; else echo '0'; ?>;
   var amount_min = amount_min.replace(/[^\d]/g, "");
   $('input[name=amount]').val(amount_min);
}); 
```

无论我给出什么输入（例如“100ab”或“10.000”），它都不会用“100”或“10000”替换它。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:40:55.850

你忘了放双引号。

```
var amount_min = "<?php if($_GET['amount_min']) echo $_GET['amount_min']; else echo 0; ?>"; 
```

因为，[`replace`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)在字符串中工作。

* * *

## 更新#1

如果出于任何宗教原因您不想将 PHP 用双引号括起来，则将它们与数字一起输出。

```
var amount_min = <?php echo '"' . ($_GET['amount_min'] ? $_GET['amount_min'] : 0) . '"'; ?>; 
```

## 更新#2

您可以使用的强制验证：

```
var amount_min = <?php echo '"' . (int)($_GET['amount_min']) . '"'; ?>; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:40:59.470

您的 PHP 代码正在输出一个数字：

```
var amount_min = 100; 
```

由于您需要一个字符串，因此请将其用引号括起来：

```
var amount_min =  "<?php if($_GET['amount_min']) echo $_GET['amount_min']; else echo '0'; ?>"; 
```

我已经很多年没有接触过 PHP，但我认为你可以稍微简化一下代码：

```
var amount_min =  "<?php echo($_GET['amount_min'] || '0'); ?>"; 
```

另外，你为什么不直接`GET`用 JavaScript 获取参数呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:41:02.293

你能试试这个：

```
$(document).ready(function(){

     var amount_min =  "<?php if($_GET['amount_min']){ echo $_GET['amount_min'];}else{ echo '0';} ?>";

      console.log("original-> "+amount_min);

      var amount_min = amount_min.replace(/\D/g,'');

      console.log("replaced-> "+amount_min); 
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T15:55:51.253

您不需要`.replace()`代码（它也只适用于字符串）；PHP 已经可以为您进行正确的转换：

```
$(function() {
   var amount_min = <?php echo isset($_GET['amount_min']) ? (int)$_GET['amount_min'] : 0; ?>;
   $('input[name=amount]').val(amount_min);
}); 
```

您也可以为此使用过滤：

```
<?php echo filter_input(INPUT_GET, 'amount_min', FILTER_VALIDATE_INT, array('options' => array('default' => 0))); ?> 
```

*请注意，它`filter_input`不会接受类似的值`100abc`，因此请明智地使用。*

如果你仍然想在 JavaScript 中安全地使用字符串，你应该使用 json_encode()。

顺便说一句，任何涉及`echo`在 JavaScript 代码中未修改来自 PHP 的请求变量的答案都是错误的，并且可能导致 XSS 攻击！你被警告了。

**更新**

基于正则表达式的替换也可以在 PHP 中完成：

```
var amount_min = <?php echo (int)preg_replace('/\D+/', '', isset($_GET['amount_min']) ? $_GET['amount_min'] : 0); ?>; 
```

由于所有非数字都被删除，您可以安全地应用`(int)`演员表。

# java - 将值从 jsp 传输到 servlet 时出现 Nullpointer 异常

> ID：14083213
> 
> 赞同：-1
> 
> 时间：2012-12-29T15:40:35.460
> 
> 标签：java, jsp, servlets

我的项目概念取决于下拉值，控件将转移到相关的 jsp 页面。

我创建了 4 个下拉值

1.安卓

2.struts

3.弹簧

4.休眠

和4个jsp页面

1.andriod.jsp

2.struts.jsp

3.spring.jsp

4.hibernate.jsp

如果我选择了 andriod 并单击提交按钮意味着控件将被转移到 andriod.jsp 页面，类似地其他值也被转移，

我的问题是

如果我选择 andriod 并单击提交按钮，它总是显示空指针异常...

请任何人解决我的问题。

我建立

1.jsp页面（文件名.jsp）

2.Servlet页面(CatServ.java)

**新文件.jsp**

```
<body>
<form action="test" method="post">
<table>
<tr>
<td>
Select the category</td>
<td>
<select>
  <option name="andriod"       value="lang">Andriod</option>
  <option name="java"           value="lang">Java</option>
  <option name="struts"         value="lang">Struts</option>
  <option name="spring"        value="lang">Spring</option>
  <option name="hybernate"   value="lang">Hybernate</option>
</select>
</td>
</tr>
<tr>
<td><center>
<input type="submit" value="Submit"></center>
</td>
</tr>
</table>
</form>
</body> 
```

**CatServ.java**

```
package container;
import java.io.IOException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class CatServ
 */
@WebServlet("/CatServ")
public class CatServ extends HttpServlet
 {
    private static final long serialVersionUID = 1L;

    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        // TODO Auto-generated method stub
        String s=request.getParameter("lang");
        System.out.println(s);

        if(s.equals("andriod"))
        {
            RequestDispatcher  rd=request.getRequestDispatcher("AndriodServ.jsp");
            rd.forward(request, response);
        }
        else if(s.equals("java"))
        {
            RequestDispatcher  rd=request.getRequestDispatcher("JavaServ.jsp");
            rd.forward(request, response);
        }
        else if(s.equals("struts"))
        {
            RequestDispatcher  rd=request.getRequestDispatcher("StrutsServ.jsp");
            rd.forward(request, response);
        }
        else if(s.equals("spring"))
        {
            RequestDispatcher  rd=request.getRequestDispatcher("SpringServ.jsp");
            rd.forward(request, response);
        }
        else if(s.equals("hibernate"))
        {
            RequestDispatcher  rd=request.getRequestDispatcher("Hybernate.jsp");
            rd.forward(request, response);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:44:49.390

您混淆了名称和价值。你需要`<select name="lang">`和你的选择应该像`<option value="spring">`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:52:22.410

要正确工作，您必须重新编写您的选择，如下所示

```
<select name="lang">
 <option  value="andriod">Andriod</option>
<option  value="java">Java</option>
<option  value="struts">Struts</option>
<option  value="spring">Spring</option>
<option  value="hybernate">Hybernate</option>
</select> 
```

您可以查看[此](http://www.w3schools.com/tags/att_select_name.asp)以获取更多信息

`s`另请注意，在调用之前检查 null是一种很好的做法`equals`

```
if(s !=null) {
// do my checks
} 
```

# c - 使用 printf 时的警告

> ID：14083231
> 
> 赞同：2
> 
> 时间：2012-12-29T15:42:06.823
> 
> 标签：c

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-30T06:47:51.603

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-29T15:43:09.967

您不包括该库，请在开始代码之前添加它

```
#include <stdio.h> 
```

因为您正在使用`printf()`它，它是一个输出函数，属于`stdio.h`库...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T15:43:46.527

您缺少声明库的#include。

添加 ：

```
#include <stdio.h>

main(){

  ...etc 
```

您需要先声明函数，然后才能使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T15:44:12.043

包括以下头文件以访问`printf`.

```
#include <stdio.h> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T17:51:20.200

不兼容的隐式声明......这句话告诉了一些东西是在printf之前存在的。那就是#include“C中的每个内置函数都应该引用lib中存在的预定义过程”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T16:27:49.617

在你的程序中包含头文件..

```
#include<stdio.h> 
```

当编译器期望一个`function declaration`or `function prototype` 并且 printf() 函数原型在`#include<stdio.h>`

# date - 后效果 将天数添加到当前日期 DD/MM

> ID：14083235
> 
> 赞同：1
> 
> 时间：2012-12-29T15:42:36.897
> 
> 标签：date, expression, add, days, after-effects

所以我在文本源表达式的后效中有一个文本层：

```
D = new Date(Date(0));
D.getDate() + "/" + (D.getMonth()+1) 
```

这给了我 29/12 这样的结果，我需要增加 3 天。我试过：

```
D = new Date(Date(0));
(D.getDate()+3) + "/" + (D.getMonth()+1) 
```

但这会导致 32/12 .. 我怎么做才能使结果（在这种特殊情况下）是 1/1？在 Java 中，人们建议使用日历类。但我不确定After Effects是否有这样的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T15:54:23.117

你可以使用这样的东西：

```
 DateTime.Now.AddDays(12);
       DateTime.Now.AddYears(2); 
```

在 javascript 中，您可以借助 setDate() 函数进行设置

```
 var d = new Date();
       d.setDate(35); // this will give you 4 jan 2013
       d.setDate(25); // this will give you 25 Dec 2012 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T15:54:51.350

试试这个：

```
D = new Date(Date(0));
D = new Date(D.getTime()+3*24*60*60*1000);
D.getDate() + "/" + (D.getMonth()+1) 
```

# php - 正则表达式查找一个词，然后从考虑中排除特定的词

> ID：14083237
> 
> 赞同：2
> 
> 时间：2012-12-29T15:43:01.740
> 
> 标签：php, regex

我有以下正则表达式，用于查找单词：

`(?<=\s)([\w\@\-]+)(?=\s)`

我想进一步修改此正则表达式以排除单词列表，例如，如果单词是“猫”或“狗”，则不匹配。

我如何适应正则表达式来实现这一目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T15:47:37.343

```
\b(?!(?:dog|cat)\b)([\w@-]+)\b 
```

在这里，如果你想匹配单词开始/结束`@`

```
(?<=\s)(?!(?:dog|cat)(?=\s))([\w\@\-]+)(?=\s) 
```

# templates - 使用 helper.options 设置选定的条目？

> ID：14083239
> 
> 赞同：3
> 
> 时间：2012-12-29T15:43:21.637
> 
> 标签：templates, scala, playframework

我正在使用 Play 2.0.4 和

```
helper.options(myitems) 
```

在我的模板中（在 helper.select 内）

在这种情况下，我如何定义默认选择的条目，它应该是其中的一个条目`myitems`？感谢您的任何提示！

**关于我的案例的更多信息：**

想象一个新闻档案，显示所有新闻标题。此新闻存档使用分页，分页使用 GET 传递下一个/上一个页码。

然而，播放框架只会在使用 POST 请求时正确选择当前选择的“选择”项目（这里：新闻类别） - 而分页使用 GET！

预期行为：在应用过滤器/选择特定新闻类别时，通过在“选择”表单中预选当前选择的新闻类别，用户始终可以看到此内容。

用于说明的“屏幕截图”：

![在此处输入图像描述](../Images/d927e7181b501793def2cb51f3234c68.png)

那么，任何人都知道如何应对这个问题？有什么方法可以手动告诉 Play 它应该从“选择”表单中选择哪个条目？'_default 总是添加一个新条目，而不是从给定的选项中选择一个）：如果不必手动构建完整的“选择”表单，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:07:03.840

尝试将`'_default`选项传递给`select`助手：

```
@import views.html.helper._

@select(form("email"), options(List("first", "third")), '_default -> "second") 
```

不幸的是，似乎唯一的办法就是查找[source](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/scala/views/helper/select.scala.html)。

**更新：**

指定`_default`属性不会在标签上设置`selected`属性。`option`看起来预选条目的唯一方法是将预填充的表单传递给模板。例如，假设您有以下表格：

```
case class RegInfo(email: String, color: String)

private val registrationForm = Form(
  mapping(
    "email"    → email,
    "color"    → nonEmptyText(minLength = 5, maxLength = 32)
  )(RegInfo.apply)(RegInfo.unapply)
) 
```

然后在传递给视图之前的动作预填充表单中：

```
def create = Action {
  Ok(html.create(registrationForm.fill(RegInfo("user@qwe.com", "blue"))))
} 
```

然后在模板中使用助手：

```
@select(form("color"), options(List("red", "green", "blue"))) 
```

并且值将被预先选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T00:39:05.697

实际上，有一个更好的解决方案。如果您调用具有部分绑定表单的模板，您将实现您的目标。这是您的控制器的代码：

```
Ok(views.html.myForm(myForm.bind(
             Map("fieldName1" -> "value1",
                 "fieldName2" -> "value2")))) 
```

确保将字段名映射到要预选的`value`s 中的s。`option`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T12:35:30.710

最后采用务实的方法：

```
<select id="myfield" name="myfield" >

    <option class="blank" value="">-- All items --</option>

    @for((key, value) <- MyModel.options) {

        @if(key == GETValuePassedToTemplate) {
            <option value="@key" selected>@value</option>   
        } else {
            <option value="@key">@value</option>                            
        }
    }

</select> 
```

仍然想知道是否有更好的选择/方法来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-10T08:56:59.487

> 仍然想知道是否有更好的选择/方法来做到这一点。

好吧，如果你不是很想用 play 来解决这个特定的问题，你总是可以使用 JavaScript 和 jQuery 来解决它：

```
$(function () {    
    $('#yourSelect_id').val(5);
} 
```

您选择的选项每个都有值，而您希望预先选择的一个选项的值是 5。

# opencv - 检索圆点

> ID：14083256
> 
> 赞同：0
> 
> 时间：2012-12-29T15:44:48.167
> 
> 标签：opencv, geometry, points

在 OpenCV 中，我知道如何画圆，但是有没有办法取回构成圆的所有点？我希望我不必通过计算轮廓。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:06:07.660

如果你知道如何画圆，

1.  创建与原始图像大小相同的黑色图像
2.  然后用白色在黑色图像上绘制圆圈
3.  现在在这个黑色图像中，检查白色的点

如果您使用的是 Python API，您可以执行以下操作：

```
import numpy as np
import cv2
img = np.zeros((500,500),np.uint8)
cv2.circle(img,(250,250),100,255)
points = np.transpose(np.where(img==255)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-05T14:02:54.830

你可以做与C/C++[中 python 实现的答案](https://stackoverflow.com/a/14083961/5472781)类似的事情

> 如果你知道如何画圆，
> 
> 1.  创建与原始图像大小相同的黑色图像
> 2.  然后用白色在黑色图像上绘制圆圈

现在，您可以找到圆边缘的轮廓（表示为点向量），而不是检查哪些像素具有特定值。

为此，您可以使用 OpenCV 的[findContours](https://docs.opencv.org/2.4/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours)函数，该函数将为您提供圆边缘上的点。

Actually the background doesn't have to be black and the circle white, but the background should be plain and the circle should have different color than background.

# macos - 支持层子类化 NSImageView setFrameRotation 不起作用

> ID：14083260
> 
> 赞同：1
> 
> 时间：2012-12-29T15:45:21.427
> 
> 标签：macos, cocoa, calayer, nsview

在支持层子类化 NSImageView 方法

```
- (void)setFrameRotation:(CGFloat)angle; 
```

不工作！所以如果它是一个支持层，我应该使用......

```
CATransform3DMakeRotation (CGFloat angle, CGFloat x, CGFloat y, CGFloat z) 
```

好的，它工作正常，但视图剪辑图层。因此，当我将其设为非支持层（意味着 setWantsLayer=NO）时，setFrameRotation 有效。但这一次我无法围绕锚点旋转图像。它围绕 (0,0) 旋转。那么我如何能够围绕锚点而不是图层旋转视图？

谢谢。

# php - 使用网页中的php在root下执行/运行可执行文件

> ID：14083263
> 
> 赞同：0
> 
> 时间：2012-12-29T15:46:01.287
> 
> 标签：php, exec

当用户单击网页上的按钮时，我想在我的服务器上运行一个可执行文件。我可以使用 exec 命令运行可执行文件，但即使我遵循帖子中的说明，程序也会在“nobody”下运行：[How to run from PHP a bash script under root user](https://stackoverflow.com/questions/10915241/how-to-run-from-php-a-bash-script-under-root-user) answer by：Riateche

但是可执行文件仍然在“nobody”下运行

我的可执行程序保存在目录中

```
/opt/lampp/htdocs/project 
```

我的php代码

```
<?
$variable = 10;
$site_dir = 'project';
echo "<img src ='".exec('/opt/lampp/htdocs/' . $site_dir .'/myProgram '.' '.$_GET['value1'] .' '. $variable )."'>";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T04:48:12.210

您没有`sudo`在命令之前使用关键字：

```
echo "<img src ='".exec('/opt/lampp/htdocs/' . $site_dir .'/myProgram '.' '.$_GET['value1'] .' '. $variable )."'>"; 
```

应该：

```
echo "<img src ='".exec('sudo /opt/lampp/htdocs/' . $site_dir .'/myProgram '.' '.$_GET['value1'] .' '. $variable )."'>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-22T02:01:15.257

我认为您需要在 sudo users/rules 文件中添加一条规则，以允许您的命令在不输入您或 root 密码的情况下运行。这个链接可能会告诉你如何做到这一点。这里[https://help.ubuntu.com/community/RootSudo](https://help.ubuntu.com/community/RootSudo)

# ruby - Toopher API：消息“No pending pairing requests with specified pairing_phrase”是什么意思？

> ID：14083267
> 
> 赞同：2
> 
> 时间：2012-12-29T15:46:09.587
> 
> 标签：ruby, api, toopher

错误信息`Not Found: No pending pairing requests with specified pairing_phrase`是什么意思？

我从这里关注了文档：[https ://dev.toopher.com/docs/](https://dev.toopher.com/docs/)

并从这里使用了 Ruby API：[https ://github.com/toopher/toopher-ruby](https://github.com/toopher/toopher-ruby)

当我运行演示时，我收到以下输出：

```
{
  "error_message" => 
      "Not Found: No pending pairing requests with specified pairing_phrase",
  "error_code" =>
      404
} 
```

我应该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T06:18:15.797

在以下三种情况之一收到此消息：

1.  输入的配对短语从未由 Toopher 移动应用程序的用户创建
2.  输入的配对短语太旧（配对短语寿命很短并且相对较快过期）。
3.  输入的配对短语已被使用（配对短语只能使用一次）。

鉴于这一系列原因，我建议您检查以确保您输入的配对短语没有任何拼写错误，不是在输入前超过 10 分钟生成的，并且尚未使用。

如果不是这些，请向[dev@toopher.com](http://mailto%3adev@toopher.com)报告错误。

希望这可以帮助。感谢您的提问！

# asp.net-mvc-3 - 如果没有返回结果，则设置 Null EntityFramework

> ID：14083268
> 
> 赞同：0
> 
> 时间：2012-12-29T15:46:13.347
> 
> 标签：asp.net-mvc-3, entity-framework

我从数据库中得到一个 Word 并在我的 ASP.NET MVC3 EntityFramework 项目中使用 ViewBag 打印出它的“文本”。

```
ViewBag.ManagementSystems = db.Words.Where(w => w.WordBaseID == 1 && w.LanguageID == lang).FirstOrDefault().Text; 
```

但是，如果没有返回任何结果，则会出现 null 异常并且程序崩溃。如果没有返回任何结果，那么什么都不打印的最简单和最好的方法是什么？

我知道的解决方案：

1- 用 if 或 try-catch 块包围

2-使用

```
var query = "SELECT Text FROM Words WHERE WordBaseID = {0} AND LanguageID = {1}";
ViewBag.ManagementSystems= db.Database.SqlQuery<string>(query, 1, lang).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:58:19.393

我提议：

```
ViewBag.ManagementSystems = db.Words.Where(w => w.WordBaseID == 1 && w.LanguageID == lang)
                                    .Select(x => x.Text).FirstOrDefault(); 
```

# jasper-reports - 如何在 iReport 的背景带中创建水印

> ID：14083270
> 
> 赞同：4
> 
> 时间：2012-12-29T15:46:33.743
> 
> 标签：jasper-reports, ireport

我正在尝试在报告中创建带有文本的水印。例如`this is a good report`，在报告的背景上重复水平打印文本。我知道这可以在背景乐队中完成，但不知道如何。

**更新** 您的解决方案有效。我想以另一种方式实现这一点。我想在后台重复打印相同的文本。假设我想打印文本`welcome to a new year`。我希望它以这种方式打印

```
welcome to a new year welcome to a new year welcome to a new year welcome to a new year
welcome to a new year welcome to a new year welcome to a new year welcome to a new year
welcome to a new year welcome to a new year welcome to a new year welcome to a new year
welcome to a new year welcome to a new year welcome to a new year welcome to a new year
welcome to a new year welcome to a new year welcome to a new year welcome to a new year
... 
```

所有这些都将在后台。我可以在不手动创建文本字段来填充页面的情况下实现这样的目标吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-30T14:25:15.837

是的你是对的。您可以使用*背景*带打印水印文本（或图片）。您应该设置此带的***高度***- 我认为最好将此带的高度设置为与报告的高度相同。

例如，对于*A4*格式，我为*Background's band height设置了***802**像素。*计算此数字的*公式是：***报告的****高度（****A4****格式为****842****像素）* ***-******左边距的****宽度**（在我的情况下为****20****）****-******右边距的*** *宽度**（在我的情况下为****20****）*。

 *******设置*背景*带的大小后，您可以将***图像***或***静态文本（textField）***元素放入此（*背景*）带。

您可以借助**旋转**属性旋转***staticText (textField)元素的文本。***此属性的可用值是：

 ***   *无*（无旋转 - 0 度），
*   *向左*（旋转 270 度），
*   *右*（旋转 90 度），
*   *颠倒*（旋转 180 度）。

在工作示例中，我使用*样式*设置***textField*****的旋转**属性，对于一个元素，我将此属性的值直接设置为***textField***元素：

 **```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="watermark_sample" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="bc290dd1-903c-4740-8484-16a2ebe872d2">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <style name="Rotated180" mode="Opaque" forecolor="#FF33CC" hAlign="Center" vAlign="Middle" rotation="UpsideDown" fontName="Curlz MT" fontSize="40"/>
    <style name="Rotated270" mode="Opaque" forecolor="#FF33CC" hAlign="Center" vAlign="Middle" rotation="Left" fontName="Curlz MT" fontSize="40"/>
    <style name="Rotated90" mode="Opaque" forecolor="#FF33CC" hAlign="Center" vAlign="Middle" rotation="Right" fontName="Curlz MT" fontSize="40"/>
    <style name="NotRotated" mode="Opaque" forecolor="#FF33CC" hAlign="Center" vAlign="Middle" rotation="None" fontName="Curlz MT" fontSize="40"/>
    <queryString>
        <![CDATA[SELECT ID, NAME, COST FROM PRODUCT ORDER BY NAME]]>
    </queryString>
    <field name="ID" class="java.lang.Integer"/>
    <field name="NAME" class="java.lang.String"/>
    <field name="COST" class="java.math.BigDecimal"/>
    <background>
        <band height="802" splitType="Stretch">
            <image hAlign="Center">
                <reportElement uuid="42c96db8-4afd-4834-ba69-6b211df0c42f" style="Rotated180" mode="Opaque" x="118" y="372" width="318" height="58"/>
                <imageExpression><![CDATA["D:\\java\\jasper_reports\\happy_new_year_h.png"]]></imageExpression>
            </image>
            <staticText>
                <reportElement uuid="d7401e33-f1b3-49ca-85d1-2923d82508f6" style="NotRotated" x="106" y="22" width="342" height="63"/>
                <textElement/>
                <text><![CDATA[Happy New Year!]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="d7401e33-f1b3-49ca-85d1-2923d82508f6" style="Rotated270" x="24" y="236" width="93" height="330"/>
                <textElement/>
                <text><![CDATA[Happy New Year!]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="d7401e33-f1b3-49ca-85d1-2923d82508f6" style="Rotated90" x="445" y="236" width="93" height="330"/>
                <textElement/>
                <text><![CDATA[Happy New Year!]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="d7401e33-f1b3-49ca-85d1-2923d82508f6" style="Rotated180" x="106" y="702" width="342" height="63"/>
                <textElement/>
                <text><![CDATA[Happy New Year!]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="3bdd5d67-94f0-457f-8477-b1d0438d7bc9" mode="Opaque" x="79" y="85" width="428" height="139" forecolor="#9999FF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="Right">
                    <font fontName="Edwardian Script ITC" size="40" isItalic="true"/>
                </textElement>
                <text><![CDATA[Happy New Year!]]></text>
            </staticText>
        </band>
    </background>
    <title>
        <band height="79" splitType="Stretch">
            <staticText>
                <reportElement uuid="6d708618-09e4-433d-ab48-bb9cbd0b832b" x="92" y="29" width="370" height="20"/>
                <textElement>
                    <font size="14" isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Sample of report with watermark]]></text>
            </staticText>
        </band>
    </title>
    <columnHeader>
        <band height="20" splitType="Stretch">
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="0" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Id]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="200" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Cost]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="100" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Name]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="0" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{ID}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="100" y="0" width="100" height="20"/>
                <box leftPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement/>
                <textFieldExpression><![CDATA[$F{NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="200" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{COST}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport> 
```

***图像***元素不支持**旋转**属性，但您可以手动创建任何您想要的图像。

***注意***：在这个示例中，我对***textField***和***图像***元素***使用了mode="Opaque" 。***

 **结果将是（通过*iReport*预览功能）： ![生成的报告](../Images/8dc291e319a134de91b65037fa25e2ef.png)

* * *

为了解决您的问题（***几个***文本作为水印），我将几个***textField***元素放到了*背景*带中。报告的模板是：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="watermark_sample" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="bc290dd1-903c-4740-8484-16a2ebe872d2">
    <property name="ireport.zoom" value="1.0"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="68"/>
    <queryString>
        <![CDATA[SELECT ID, NAME, COST FROM PRODUCT ORDER BY NAME]]>
    </queryString>
    <field name="ID" class="java.lang.Integer"/>
    <field name="NAME" class="java.lang.String"/>
    <field name="COST" class="java.math.BigDecimal"/>
    <background>
        <band height="802" splitType="Stretch">
            <staticText>
                <reportElement uuid="3bdd5d67-94f0-457f-8477-b1d0438d7bc9" mode="Transparent" x="63" y="112" width="428" height="56" forecolor="#808080"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
                    <font fontName="Serif" size="40" isItalic="true"/>
                </textElement>
                <text><![CDATA[this is a good report]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="3bdd5d67-94f0-457f-8477-b1d0438d7bc9" mode="Transparent" x="63" y="272" width="428" height="56" forecolor="#808080"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
                    <font fontName="Serif" size="40" isItalic="true"/>
                </textElement>
                <text><![CDATA[this is a good report]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="3bdd5d67-94f0-457f-8477-b1d0438d7bc9" mode="Transparent" x="63" y="432" width="428" height="56" forecolor="#808080"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
                    <font fontName="Serif" size="40" isItalic="true"/>
                </textElement>
                <text><![CDATA[this is a good report]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="3bdd5d67-94f0-457f-8477-b1d0438d7bc9" mode="Transparent" x="63" y="594" width="428" height="56" forecolor="#808080"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None">
                    <font fontName="Serif" size="40" isItalic="true"/>
                </textElement>
                <text><![CDATA[this is a good report]]></text>
            </staticText>
        </band>
    </background>
    <title>
        <band height="79" splitType="Stretch">
            <staticText>
                <reportElement uuid="6d708618-09e4-433d-ab48-bb9cbd0b832b" x="92" y="29" width="370" height="20"/>
                <textElement>
                    <font size="14" isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Sample of report with watermark]]></text>
            </staticText>
        </band>
    </title>
    <columnHeader>
        <band height="20" splitType="Stretch">
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="0" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Id]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="200" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Cost]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="100" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Name]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="0" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{ID}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="100" y="0" width="100" height="20"/>
                <box leftPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement/>
                <textFieldExpression><![CDATA[$F{NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="200" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{COST}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport> 
```

***注意***：在这个示例中，我对***textField***元素***使用了mode="Transparent" 。***

 *报告的设计（在*iReport*中）：

![在此处输入图像描述](../Images/31555accda1a5fac5e79515acd2885a2.png)

结果将是（通过*iReport*预览功能）： ![在 iReport 中生成的报告](../Images/35cdcda7b94813ba4eaf97be3915c720.png)

* * *

如果您想设置自定义旋转角度，您可以[在 JasperReports 帖子的页面上的 Watermark](https://stackoverflow.com/q/11665663/876298)中找到更多信息。

* * *

***更新***：您可以解决第二个问题，例如，借助[Commons Lang API的](http://commons.apache.org/lang/api/index.html)[StringUtils.repeat(java.lang.String, int)](http://commons.apache.org/lang/api-3.1/org/apache/commons/lang3/StringUtils.html#repeat%28java.lang.String,%20int%29)方法。

您可以将***导入***指令（`<import value="org.apache.commons.lang3.StringUtils"/>`在我的示例中）添加到报告的模板中，并使用如下表达式：

```
<textFieldExpression><![CDATA[StringUtils.repeat("Welcome to a New Year! ", $P{numberOfRepeats})]]></textFieldExpression> 
```

*jrxml*文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="watermark_sample" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="bc290dd1-903c-4740-8484-16a2ebe872d2">
    <import value="org.apache.commons.lang3.StringUtils"/>
    <parameter name="numberOfRepeats" class="java.lang.Integer" isForPrompting="false">
        <defaultValueExpression><![CDATA[10]]></defaultValueExpression>
    </parameter>
    <queryString>
        <![CDATA[SELECT ID, NAME, COST FROM PRODUCT ORDER BY NAME]]>
    </queryString>
    <field name="ID" class="java.lang.Integer"/>
    <field name="NAME" class="java.lang.String"/>
    <field name="COST" class="java.math.BigDecimal"/>
    <background>
        <band height="802" splitType="Stretch">
            <textField isStretchWithOverflow="true">
                <reportElement uuid="26290245-c5cf-4f28-b637-c5b0253910a5" mode="Transparent" x="21" y="112" width="470" height="56" forecolor="#808080"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
                    <font fontName="Serif" size="20" isItalic="true"/>
                </textElement>
                <textFieldExpression><![CDATA[StringUtils.repeat("Welcome to a New Year! ", $P{numberOfRepeats})]]></textFieldExpression>
            </textField>
        </band>
    </background>
    <title>
        <band height="79" splitType="Stretch">
            <staticText>
                <reportElement uuid="6d708618-09e4-433d-ab48-bb9cbd0b832b" x="92" y="29" width="370" height="20"/>
                <textElement>
                    <font size="14" isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Sample of report with watermark]]></text>
            </staticText>
        </band>
    </title>
    <columnHeader>
        <band height="20" splitType="Stretch">
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="0" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Id]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="200" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Cost]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="414160e2-41c4-4326-8ec8-ff7c230ac2c3" mode="Opaque" x="100" y="0" width="100" height="20" forecolor="#000000" backcolor="#3399FF"/>
                <box leftPadding="10" rightPadding="10">
                    <topPen lineWidth="1.0"/>
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font isBold="true" isItalic="true"/>
                </textElement>
                <text><![CDATA[Name]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="20" splitType="Stretch">
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="0" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{ID}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="100" y="0" width="100" height="20"/>
                <box leftPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement/>
                <textFieldExpression><![CDATA[$F{NAME}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement uuid="5715c691-0b39-4530-9009-3b7179bb06f5" x="200" y="0" width="100" height="20"/>
                <box leftPadding="10" rightPadding="10">
                    <leftPen lineWidth="1.0"/>
                    <bottomPen lineWidth="1.0"/>
                    <rightPen lineWidth="1.0"/>
                </box>
                <textElement textAlignment="Right"/>
                <textFieldExpression><![CDATA[$F{COST}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport> 
```

结果将是（通过*iReport*预览功能）：

![在 iReport 中生成的报告](../Images/558b9150ad5b25251080bfed209e8534.png)

***细节：***

*   在这个示例中，我使用了***Commons Lang library v. 3.1***。您应该将此库添加到应用程序的类路径中（在我的情况下，它是*iReport*的 cp）。

![iReport 类路径](../Images/e2ac46271f3155a32688cb8126e12d84.png)

*   我使用参数***numberOfRepeats*** ( *java.lang.Integer* ) 来设置要生成的短语数。**************

# ruby-on-rails - 将一个简单的变量从视图发送到控制器导轨

> ID：14083271
> 
> 赞同：1
> 
> 时间：2012-12-29T15:46:40.200
> 
> 标签：ruby-on-rails, ruby

我想从我的视图中发送一个简单的变量，例如：@data1 = "something" 到我的控制器，但没有表单或按钮，我想用另一个事件来做，比如“关闭任何对话框窗口”并自动发送到某个方法我的控制器。

谢谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T15:52:27.700

你不能这样做（也不想这样做）。模型-视图-控制器模式假设控制器向视图提供数据（模型）。一旦`render`方法被调用，视图就会被发送到客户端浏览器。如果您希望视图将数据发送回控制器，您将不得不依赖 HTTP 并使用链接、表单或 Javascript/Ajax。

# javascript - 以逗号分隔的标签的输入字段

> ID：14083272
> 
> 赞同：17
> 
> 时间：2012-12-29T15:46:51.697
> 
> 标签：javascript, jquery

我正在开发一个允许用户通过标签发布内容的 Web 应用程序，但问题是，如果标签用**逗号**分隔并且文本字段值仍然相同，我将如何在标签周围制作一个漂亮的块用户会有所不同。

一个例子是 YouTube 或 StackOverflow，现在我不需要它来检查数据库或任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-12-29T15:54:13.233

类似于 Stack Overflow 的东西：

![在此处输入图像描述](../Images/85f5f11ea72692c03210169c0dbe0b25.png)

*   允许字母数字和`+-.#` （并修剪空格！）
*   转换为小写
*   *在focusOut* 上自动创建标签框`Enter` `,` （添加更多`|`分隔键码）
*   点击时删除标签框（确认）

```
$(function(){ // DOM ready

  // ::: TAGS BOX

  $("#tags input").on({
    focusout : function() {
      var txt = this.value.replace(/[^a-z0-9\+\-\.\#]/ig,''); // allowed characters
      if(txt) $("<span/>", {text:txt.toLowerCase(), insertBefore:this});
      this.value = "";
    },
    keyup : function(ev) {
      // if: comma|enter (delimit more keyCodes with | pipe)
      if(/(188|13)/.test(ev.which)) $(this).focusout(); 
    }
  });
  $('#tags').on('click', 'span', function() {
    if(confirm("Remove "+ $(this).text() +"?")) $(this).remove(); 
  });

});
```

```
#tags{
  float:left;
  border:1px solid #ccc;
  padding:5px;
  font-family:Arial;
}
#tags > span{
  cursor:pointer;
  display:block;
  float:left;
  color:#fff;
  background:#789;
  padding:5px;
  padding-right:25px;
  margin:4px;
}
#tags > span:hover{
  opacity:0.7;
}
#tags > span:after{
 position:absolute;
 content:"×";
 border:1px solid;
 padding:2px 5px;
 margin-left:3px;
 font-size:11px;
}
#tags > input{
  background:#eee;
  border:0;
  margin:4px;
  padding:7px;
  width:auto;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div id="tags">
  <span>php</span>
  <span>c++</span>
  <span>jquery</span>
  <input type="text" value="" placeholder="Add a tag" />
</div>
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-29T15:58:36.617

您不一定需要在这里重新发明轮子。已经存在许多用于此目的的库/插件，其中之一是 Guillermo Rauch 的[TextboxList](http://www.devthought.com/projects/mootools/textboxlist/)。[您可以在此处](http://www.devthought.com/wp-content/projects/mootools/textboxlist/Demo/)找到演示。它已经具有自动完成支持和相当广泛的 API，这是任何实现的主要障碍。

[最初的实现使用了 MooTools，但你可以在这里](https://github.com/golive/TextboxList)找到 golive 的 jQuery 版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T15:50:33.980

将文本输入放在 div 中，然后检查按键（例如逗号或空格键），如果它与键匹配，则使用 jQuery 将带有标签详细信息的新跨度附加到 div。

如果需要，我可以提供更多细节或示例，但代码应该相当简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-26T19:36:17.650

在 select2 列表中使用“标记支持”： [https ://select2.github.io/examples.html](https://select2.github.io/examples.html)

```
 $(".js-example-tags").select2({
  tags: true
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-01T23:55:20.060

我想制作一个像 Facebook 一样用于标记人的标签框，并发现可用选项臃肿和/或不做我想要的关键事情：要求标签存在于预设列表中（可以从 AJAX 调用中检索.

我从[Roko C. Buljan 的回答](https://stackoverflow.com/a/14083331/3917091)开始，然后添加了一些重要的东西。

*   方向键导航
*   如上所述，需要预设答案
*   `data-`便于收集 ajax-post 的属性。

[Codepen 适合任何有兴趣的人](https://codepen.io/bracketsage/pen/XzOJKo)

# flash - 使用 ItemRenderer 从路径输出文件名

> ID：14083273
> 
> 赞同：0
> 
> 时间：2012-12-29T15:47:02.823
> 
> 标签：flash, apache-flex, actionscript

我对 actionscript 很陌生，我收到了一个 XML 文件路径列表。我需要从中提取文件名，所以我设置了一个 itemRenderer，但我没有得到任何名称。我添加了一个断点，我的文件名确实包含正确的文件名，但它从未显示在视图中。我究竟做错了什么？

查看代码：

```
<s:SkinnableContainer width="100%">
    <s:DataGroup itemRenderer="modules.custFiles.renderers.CustFileItemRenderer" dataProvider="{custFiles}" width="100%">
        <s:layout>
            <s:VerticalLayout gap="0"/>
        </s:layout>
    </s:DataGroup>
</s:SkinnableContainer> 
```

渲染器代码：

```
override public function set data(value:Object):void
{
    var node:XML = value as XML;
    _link = node.toString();
    var filename:RegExp = /[^\/\/]*$/ig;
    filename.text = _link.match(filename);

    super.data = value;
} 
```

XML:

```
<ArrayOfString xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://mysite.com/srv">
<string>
http://mysite.com/files/custFiles/custfile-1.pdf
</string>
<string>
http://mysite.com/files/custFiles/custfile-2.pdf
</string>
</ArrayOfString> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:42:47.240

在这种情况下，您不需要自定义渲染器。只需将数据转换为字符串的 IList：

```
function toListOfString(xml:XML):IList {
  if (!xml) return new ArrayCollection();

  const children:XMLList = xml.children(),
        source:Array = [];

  for each(var child:XML in children) source.push(child.text())

  return new ArrayCollection(source);
} 
```

获取结果并将方法的结果分配给列表。这将帮助您入门，并向您展示如何区分 Flex 开发带来的单个问题。

我为什么要这样提议？XML/XMLList 实例并不是在 Flex 中处理数据的最佳匹配。这些类不支持 DataBinding，因此您将继续使用应用程序变得更复杂的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:55:27.463

将“设置数据”函数中的行更改为：

> super.data = _link.match(文件名);

您没有在父类中设置正确的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:39:36.410

似乎您的渲染器中有一些文本组件`Label`，例如 name `filename`，但随后您声明了 name`filename`为 type 的局部变量`RegExp`。

而你现在并不幸运 -`RegExp`是`dynamic`阶级，这意味着你的

`filename.text = _link.match(filename);`

不会产生错误。但它应该。尝试将局部变量重命名为`fileNameRegExp`.

顺便说一句，@ethrbunny 已经提到了这个事实，所以我想你应该给@ethrbunny '接受'。

# mysql - Nodejs MySQL 查询块请求模块

> ID：14083276
> 
> 赞同：0
> 
> 时间：2012-12-29T15:47:19.763
> 
> 标签：mysql, node.js, httprequest

我是一个 nodejs 新手，已经习惯了所有异步的东西。

使用： - Node-MySQL (https://github.com/felixge/node-mysql) - 现在请求 (https://github.com/mikeal/request) 模块。

我正在查询一大串 URL（10,000 个 URL）并尝试向它们发送 HTTP GET 请求以获取它们的 HTTP 状态。

它可以工作，但问题是，当我运行代码时，返回 MySQL 查询的每一行时，都会调用 processURL 函数，它会在每个 URL 值之后记录“BEFORE”和“AFTER”，（就我可以理解）发送 HTTP 请求，但在返回 HTTP 状态之前等待 MySQL 查询完成。

简单地说，它无法在查询运行时检查这些 URL 并返回它们的结果。它等待查询完成以返回 HTTP 请求的结果。

这对我来说看起来毫无意义，因为它在流式传输每一行时运行 processURL 函数。这是完整的代码：

```
var mysql       = require('mysql');

var connection = mysql.createConnection({
  host     : 'localhost',
  user     : 'root',
  password : '',
  database : 'urlDB',
});

var query = connection.query('SELECT * FROM urls LIMIT 10000');
query.on('error', function(err) {
    console.log(err);
})
query.on('result', function(row) {
    processURL(row.urlValue, function() {

    });
    console.log(row.urlValue);
})

function processURL (url){
    var request     = require('request');
    var startTime = new Date();
    console.log('BEFORE');
    request({
        uri: url,
        method: 'GET',
    }, function(error, response, body) {
        console.log('INSIDE');
        var endTime = new Date();

        if (!error) {
            console.log(response.statusCode + '  Start: ' + startTime + '  End: ' + endTime);
        } else {
            console.log('timeout');
        }
    })
    console.log('AFTER');
} 
```

输出如下： www.google.com BEFORE AFTER www.yahoo.com BEFORE AFTER www.cnn.com BEFORE AFTER ...但在查询完成之前没有'INSIDE'。

任何帮助表示赞赏，非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:36:11.583

我修改了您的示例以更慢地获得结果，并且它按预期工作。你可以复制粘贴试试：

```
var request = require('request');

var urls = ['http://google.com', 'http://yahoo.com', 'http://ninjaturtles.com'];

getResultSlowly();

function getResultSlowly() {
  var result = urls.shift();
  if (!result) return;

  console.log(result);
  processUrl(result);
  setTimeout(getResultSlowly, 1000);
}

function processUrl(url) {
  var startTime = new Date();
  console.log('BEFORE');
  request({
    uri: url,
    method: 'GET',
  }, function(error, response, body) {
    console.log('INSIDE');
    var endTime = new Date();

    if (!error) {
      console.log(response.statusCode + '  Start: ' + startTime + '  End: ' + endTime);
    } else {
      console.log('timeout');
    }
  })
  console.log('AFTER');
} 
```

网络延迟很可能只是掩盖了异步行为。

您的查询结果将几乎立即返回，`result`并在您执行代码后立即触发几个事件。但是，您的`request`活动将花费相当长的时间（即使只是一两毫秒），因为它必须与 google 或 yahoo 或其他任何人建立联系。

输出：

```
$ node asynctest.js 
http://google.com
BEFORE
AFTER
INSIDE
200  Start: Sat Dec 29 2012 11:31:34 GMT-0500 (EST)  End: Sat Dec 29 2012 11:31:34 GMT-0500 (EST)
http://yahoo.com
BEFORE
AFTER
http://ninjaturtles.com
BEFORE
AFTER
INSIDE
200  Start: Sat Dec 29 2012 11:31:36 GMT-0500 (EST)  End: Sat Dec 29 2012 11:31:37 GMT-0500 (EST)
INSIDE
200  Start: Sat Dec 29 2012 11:31:35 GMT-0500 (EST)  End: Sat Dec 29 2012 11:31:38 GMT-0500 (EST) 
```

# html - IE 的背景大小后备

> ID：14083282
> 
> 赞同：1
> 
> 时间：2012-12-29T15:47:55.817
> 
> 标签：html, css, internet-explorer, drop-down-menu, menuitem

我[这里有这个菜单](http://luigisettembrini.gov.it/)。我为每个父 li 设置了一个背景图像（然后我为背景大小的高度设置了一个高值，因为子菜单在 2 行上有一些条目，并且高度的高值补偿了这一点）。问题是 IE 不支持背景大小，所以我明白了：

![IE问题](../Images/fa371c01e42517a26f8e3b7bf67a55a8.png)

我该如何解决这个问题？我试图创建一个高度更高的背景图像，但没有改变任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:01:36.350

IE`background-size`从 IE9 开始支持。对于 IE8 及更低版本，您可以尝试[background-size polyfill](https://github.com/louisremi/background-size-polyfill)。不过，您的情况似乎根本不需要`background-size`。只需`rgba()`用于 IE9+ 并为 IE8- 重复使用 PNG-24 背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:02:24.660

由于您的图像是纯色的，您可以删除`background-size`and `background-repeat: none`（即让它重复）。

或者，您可以取消`background-image`并使用具有透明度的背景颜色：

```
.test {
    background: rgb(255, 255, 255); // solid white fallback for old browsers
    background: rgba(255, 255, 255, 0.5); // 50% transparent white
} 
```

# c - Xcode C调试在步进时更改指针的值

> ID：14083284
> 
> 赞同：3
> 
> 时间：2012-12-29T15:48:10.467
> 
> 标签：c, llvm, xcode4.5, lldb

我正在调试一个 C 代码，其中我在一个指向名为`board`. 我正在打印电路板有一个功能：

```
static void board_print(board *b){
    int i,j;
    char data;
    for (i = 0; i < size; i++) {
        for (j = 0; j < size; j++) {
            data = b->data[i * size + j];
            if(data){
                printf("X ");
            }else{
                printf("O ");
            }
        }
        printf("\n");
    }
} 
```

这是奇怪的部分。当我最初在第一个 for 循环开始时命中断点时，一切正常，我的数据正确，所有指针都正常工作等，如下所示：

![第一的](../Images/98cb2e857e8ce955ddfd5bba313314e6.png)

然后，我第一次进入循环，i 和 j 等于 0，并且`b->data[0]`应该完全有效，就像两步前一样。突然，我一踩线`data = b->data[i * size + j];`，数据指针就变成了一个空指针。当我执行该行时，我（显然）得到一个错误的访问错误，如下所示：

![第二](../Images/7a33c899015ff7d39ad98ca66126596f.png)

可能是什么原因？我以前用过 C，而且我已经掌握了它，但是在单线程简单的 C 程序中，我从未见过指针值突然变为 null。我使用 Apple LLVM Compiler 4.1 进行编译和 lldb 进行调试，这是 XCode 4.5 的默认设置。

**更新**：使用 gcc 编译和使用 gdb 调试时观察到的行为相同。我身边几乎百分百的错误，但我不知道代码有什么问题..

**更新#2：**我现在在 gcc/gdb 上发现了一些更奇怪的东西。就在执行该行之前`data = b->data[i * size + j];`，我可以毫无问题地从调试器访问所有内容。在执行该行之后，我无法`b->data`完全访问，包括我在步进之前访问的值：

![第三](../Images/50ba09091b42e16e2aca6fabfa7c17c9.png)

在调试器中成功执行的`$4 = ...`行之后，我已经跨过了该行。然后我遇到了各种寻址错误，如上所示。我真的不知道发生了什么...

**更新#3：**我注意到一些非常奇怪的事情。在这里，首先看一下我已经实现的修复。当我完全摆脱了命名的变量时，这个开始工作没有问题`data`：

![第四](../Images/8c640b3d8c8ecd4038589f01e5e9bf77.png)

现在，仔细查看我与更新#2 一起上传的屏幕截图：在我为名为的*局部变量赋值*`data`后，`b->data`它的地址也发生了变化。它看起来像是作业的副作用。但我不知道背后的原因是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:09:16.763

显然某事/某人改变了董事会结构的属性“数据”。

为什么 ？我只能看到三个原因：

*   您的应用程序是多线程的，另一个线程将数据指针更新为 NULL（这不是您的情况，您只使用一个线程，抱歉没有注意到）。

*   板结构是从堆栈中分配的，但内容不再有效......例如：返回一个局部变量的指针，但返回时变量（结构）被破坏（因为这是一个局部变量）指针...

*   板结构是从堆中分配的，然后被释放，最后这个释放的指针仍然被使用：堆内存被其他东西破坏了......

我的猜测：第二点是一个常见的错误

所以一个简单的问题：board struct 存储在 HEAP 或 STACK 内存中？

# tomcat - 登录管理我的应用时出现 401 未授权

> ID：14083286
> 
> 赞同：1
> 
> 时间：2012-12-29T15:49:02.770
> 
> 标签：tomcat, authentication, user-roles

我已经下载了 tomcat7 ZIP 文件。解压文件夹后，进入**Tomcat7.0/conf/**目录，编辑**tomcat-users.xml**为：

```
<tomcat-users>  
  <role rolename="tomcat"/>  
  <role rolename="role1"/>  
  <role rolename="manager"/>  
  <user username="tomcat" password="tomcat" roles="tomcat"/>  
  <user username="both" password="tomcat" roles="tomcat,role1"/>  
  <user username="role1" password="tomcat" roles="role1"/>  

  <user username="admin" password="admin" roles="manager,tomcat,role1"/>  

</tomcat-users> 
```

然后，我启动了我的 tomcat，在 tomcat 网页上，我点击了“ **Manager App** ”按钮，它会弹出一个登录对话框。我输入用户名“ **admin** ”和密码“ **admin** ”，但出现**401 未经授权**的错误。为什么？我的*tomcat-users.xml*配置有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:55:01.347

`manager-gui`根据[http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Configuring_Manager_Application_Access](http://tomcat.apache.org/tomcat-7.0-doc/manager-howto.html#Configuring_Manager_Application_Access)调用所需的角色

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T09:42:43.260

引用自`http://localhost:8080/manager/html`

> ```
> <role rolename="manager-gui"/>
> <user username="tomcat" password="s3cret" roles="manager-gui"/> 
> ```
> 
> 请注意，对于 Tomcat 6.0.30 及更高版本，使用管理器应用程序所需的角色已从单个管理器角色更改为以下四个角色。
> 
> ```
> manager-gui - allows access to the HTML GUI and the status pages
> manager-script - allows access to the text interface and the status pages
> manager-jmx - allows access to the JMX proxy and the status pages
> manager-status - allows access to the status pages only 
> ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-01T12:16:52.513

这是因为从 Tomcat 7.0 开始，您需要将以下四个角色添加到您的 tomcat-users.xml

注意：我使用的是 Tomcat 8.5.9

\conf\tomcat-users.xml

```
<role rolename="admin-gui"/>
  <role rolename="manager-gui"/>
  <role rolename="manager-script"/>
  <role rolename="manager-jmx"/>
  <role rolename="manager-status"/>
  <user roles="admin-gui,manager-gui,manager-script,manager-jmx,manager-status" username="tomcat" password="******"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:00:51.980

您应该将角色名称指定为 manager-gui ...它将授予访问管理应用程序页面的权限...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T09:37:29.630

如果使用 Eclipse WTP 管理 Tomcat，请小心，因为 Eclipse 实际上会在 Workspace 的 Server 项目中复制配置文件。

# c# - DatetimePicker 自动转换 C#

> ID：14083290
> 
> 赞同：0
> 
> 时间：2012-12-29T15:49:14.130
> 
> 标签：c#

我正在使用 C# 并将日期时间选择器的值设置为我数据库中的日期。但是我在数据库中的格式与日期时间选择器的格式不同。有没有办法自动将我的数据库日期格式更改为日期时间选择器的格式。我已经搜索过了，但我没有找到它。

我会感谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:50:35.477

> 但是我在数据库中的格式与 Date Time Picke 的格式不同

您错误地认为数据库在存储时具有任何关联的显示格式`DATETIME`- 它没有 - 存在内部表示。您所看到的只是当您在某些工具中查看日期时如何表示日期。

如果您的数据库`DATETIME`按照应有的方式使用列，那么就没有问题。

# .net - .NET 绘制全屏游戏

> ID：14083291
> 
> 赞同：2
> 
> 时间：2012-12-29T15:49:17.607
> 
> 标签：.net, winapi, c++-cli

现在我可以绘制游戏，但前提是它们处于窗口模式，我只是在`TopMost`表单上绘制并将其设置为可点击：

```
//C++ .NET 4
private: System::Void Form1_Load(System::Object^  sender, System::EventArgs^  e) {
    int initialStyle = GetWindowLong(this->Handle, -20);
    SetWindowLong(this->Handle, -20, initialStyle | 0x80000 | 0x20);
} 
```

但如果游戏全屏运行，我将无法做到这一点:(

我可以用全屏游戏做点什么吗？（如果可能，使用 C++）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:44:53.863

你就是不能（至少那样）。当游戏进入全屏模式时，它们通常使用对 DirectX 或 OpenGL 的低级调用来执行此操作，这将禁用 Windows 桌面的所有窗口逻辑。然后游戏直接绘制到图形设备的帧缓冲区中，图形驱动程序将在屏幕上显示此内容 - 完全绕过窗口。

要真正“超越”它，您可以忘记所有类型的 WinForms/MFC 调用，但您必须查看允许您操作帧缓冲区的低级驱动程序调用（尽管我怀疑您是否可以从外部进程执行此操作） .

# ruby-on-rails - rails 3 settingslogic未初始化常量Settingslogic错误

> ID：14083292
> 
> 赞同：0
> 
> 时间：2012-12-29T15:49:21.170
> 
> 标签：ruby-on-rails, settingslogic

我正在尝试在我的应用程序中设置设置：

在 app/models/_settings.rb

```
class Settings < Settingslogic
    source "#{Rails.root}/config/app_config.yml"
    namespace Rails.env
end 
```

在 config/app_config 中：

```
# config/app_config.yml
defaults: &defaults
  global_param: "global"
  awesome_setting: 1 #<%= "Did you know 5 + 5 = #{5 + 5}?" %>

development:
  <<: *defaults
  mongo:
    ip: "localhost"

backoffice:
  <<: *defaults 
  mongo:
    ip: "10.111.144.139"

staging:
  <<: *defaults
  mongo:
    ip: "10.111.144.139"

production:
  <<: *defaults
  mongo:
    ip: "10.111.144.139" 
```

在我的 app/helpers/kanbanFacade.rb 第 98 行：

```
conn = Mongo::Connection.new(Settings.mongo.ip, 27017) 
```

我仍然收到此错误：（ `uninitialized constant KanbanFacade::Settings`在我的应用程序助手第 98 行）

为什么会这样？

# android - Android：有没有办法告诉你的应用程序在什么设备上运行

> ID：14083293
> 
> 赞同：0
> 
> 时间：2012-12-29T15:49:34.150
> 
> 标签：android

我的应用程序在新的三星 Galaxy 智能手机上崩溃。我想知道是否有办法检测它是否在这些手机上运行？（所以 Galaxy 手机不会运行导致它们崩溃的代码，但其余的智能手机会运行它）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T15:57:07.040

包中有许多常量[`android.os.Build`](https://developer.android.com/reference/android/os/Build.html)可以帮助您找到所需的内容。特别是有一个`MODEL`常数，它指的是产品的名称。

# java - 我的 java 程序正在运行编译但不显示任何内容

> ID：14083308
> 
> 赞同：-1
> 
> 时间：2012-12-29T15:51:19.923
> 
> 标签：java

```
package myproj;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Vector;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import myproj.util.DBUtil;

/**
 *
 * @author PEARL
 */
public class DATAENTRY extends javax.swing.JFrame {

    /**
     * Creates new form DATAENTRY
     */
    public DATAENTRY() {
        try {
            initComponents();
            DBUtil util = new DBUtil();
            Connection con = util.getConnection();
            Statement stmt = con.createStatement();
            ResultSet rs = stmt.executeQuery("select * from bk_det inner join bk_rep on bk_det.rm_id = bk_rep.rm_id inner join bk_sec on bk_rep.rm_id = bk_sec.rm_id inner join mut_det on bk_sec.rm_id = mut_det.rm_id inner join rm_det on mut_det.rm_id = rm_det.rm_id inner join soil_det on rm_det.rm_id = soil_det.rm_id");
            ResultSetMetaData rsmetadata = rs.getMetaData();
            int columns = rsmetadata.getColumnCount();
            DefaultTableModel dtm = new DefaultTableModel();
            Vector columns_name = new Vector();
            Vector data_rows = new Vector();
            for(int i=1; i< columns; i++){
            columns_name.addElement(rsmetadata.getColumnName(i));
            }
            dtm.setColumnIdentifiers(columns_name);

            while(rs.next()){
            data_rows = new Vector();
            for(int j=1; j< columns; j++){
            data_rows.addElement(rs.getString(j));
            }
            dtm.addRow(data_rows);
            }
            MyTable.setModel(dtm);
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(null, ex.getMessage());
            Logger.getLogger(Demo.class.getName()).log(Level.SEVERE, null, ex);
        }

    }
public static void main(String arg[]){

}

} 
```

我想在netbeans gui中将我的sql数据库中的记录显示到我的jtable，但能够成功显示编译和运行windows窗体，但它不显示受尊重的窗体请帮忙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T15:54:10.080

这是因为您需要`DATAENTRY()`在主类中调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T15:53:28.980

你的主要方法是空的，所以它不会做任何事情。

```
public static void main(String arg[]){

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T15:53:49.763

你知道你的`main`方法是完全空的吗？ *程序中的所有内容都*发生在`main`. 你会想`DATAENTRY`从那里实例化你的对象。

```
DATAENTRY da = new DATAENTRY(); 
```

也可能是其他东西也坏了；警惕并注意任何堆栈痕迹。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T15:54:17.263

您的主要方法中没有任何内容。Java 从 main 方法开始运行代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-29T15:55:52.340

添加这个

```
public static void main(String arg[]){
  DATAENTRY de = new DATAENTRY() ;
  de.pack();
  de.setVisible(true)
} 
```

此外，类名`DATAENTRY`和您在构造函数中所做的所有事情都不是适当的标准。您应该遵循 java 代码标准。去谷歌上查询。

1.  类名可以像`DataEntryFrame`
2.  在构造框架后调用初始化组件`deFrame.intilizeComponents()`
3.  将单独的方法用于更新表格内容，例如`fillupTable()`
4.  最后使用事件或在 main 方法中调用 fillupTable 方法。

# grails - 在 GORM 中按周/月/年分组

> ID：14083310
> 
> 赞同：1
> 
> 时间：2012-12-29T15:51:39.247
> 
> 标签：grails, grails-orm

我有一个域类（缩小）为： -

```
class Expense {
    Date dateOfExpense
    int amount
} 
```

我正在尝试获取按费用日期的周/月/年分组的金额总和。参考 grails doc [http://grails.org/doc/latest/guide/GORM.html](http://grails.org/doc/latest/guide/GORM.html)中的“sqlGroupProjection”方法，

我尝试使用以下代码：-

```
def results = c {
    between("dateOfExpense", fromDate, toDate)              
    projections {
         sqlGroupProjection 'dateOfExpense,sum(amount) as summed',       
        'MONTH(dateOfExpense)',['date','summed'],[DATE,NUMBER]                  
    }
} 
```

抛出异常：

```
 No such property: DATE for class: grails.orm.HibernateCriteriaBuilder. Stacktrace follows:
 Message: No such property: DATE for class: grails.orm.HibernateCriteriaBuilder 
```

请提出一种使用方法的`sqlGroupProjection`方法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-02T09:28:35.907

1.  在域类中分别为周、月和年创建三个新的数字字段。这些字段不会映射到表中的列。
2.  为三个字段提供静态映射。

    ```
    static mapping = {
         //provide the exact column name of the date field
         week formula('WEEK(DATE_OF_EXPENSE)')    
         month formula('MONTH(DATE_OF_EXPENSE)')
         year formula ('YEAR(DATE_OF_EXPENSE)')
    } 
    ```

现在我们可以使用所需的字段进行分组

```
def results = c.list {
  between("dateOfExpense", fromDate, toDate) 
  projections {
    switch(groupBy){
        case "week":
           groupProperty('year')
           groupProperty('month')
           groupProperty('week') 
        break;
        case "month"
           groupProperty('year')
           groupProperty('month')
        break;
        case "year":
           groupProperty('year')
        break;
    }        
    sum('amount')
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T14:00:10.640

而不是这个

```
static mapping = {

week formula('WEEK(DATE_OF_EXPENSE)')    //provide the exact column name of the date field
month formula('MONTH(DATE_OF_EXPENSE)')
year formula ('YEAR(DATE_OF_EXPENSE)')

} 
```

试试这个

```
static mapping = {

week formula: 'WEEK(DATE)'    
month formula: 'MONTH(DATE)'
year formula: 'YEAR(DATE)'

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:00:12.340

尝试类似的东西

```
sqlGroupProjection 'MONTH(dateOfExpense) as month, sum(amount) as summed',
    'month',['month','summed'],[NUMBER,NUMBER] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:45:03.950

这种`sqlGroupProjection`方法似乎没有得到很好的支持。采用

```
def results = c.list {
    between("dateOfExpense", fromDate, toDate) 
    projections {
        groupProperty('dateOfExpense')
        sum('amount')
    }
} 
```

会产生应有的结果。

如果您想按日期分组，请参阅[按日期分组的 Grails](https://stackoverflow.com/questions/10455409/grails-group-by-date)（实际上，它完全超过了我的答案。但是在尝试了您的代码很长时间后，我得到了相同的解决方案。）

# windows - 尝试从 PGAdmin 导入 CSV 文件时权限被拒绝

> ID：14083311
> 
> 赞同：38
> 
> 时间：2012-12-29T15:51:45.003
> 
> 标签：windows, postgresql, csv

我正在使用 PGAdmin 1.14.3。

当我尝试执行导入命令时：

```
COPY grad(country_code, postal_code, place_name, admin_name1, admin_code1, admin_name2, admin_code2, admin_name3, admin_code3, latitude, longitude, accuracy)
FROM 'C:\\Users\\denis\\Desktop\\BP2Project\\USA\\US.txt'; 
```

我得到一个

> 错误：无法打开文件“C:\Users\denis\Desktop\BP2Project\USA\US.txt”进行阅读：权限被拒绝 SQL 状态：42501

我确实查找了其他[类似](https://stackoverflow.com/questions/8867790/permission-denied-trying-to-read-a-csv-file-using-jdbc-for-postgres-database)的问题，但没有一个能解决我的问题。

我以超级用户“postgres”的身份登录。我不明白为什么我缺少权限。我在 Windows 7 上。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2014-03-18T17:13:57.053

[Houari](https://stackoverflow.com/users/1216680/houari)和[Flimzy的](https://stackoverflow.com/users/13860/flimzy)[答案](https://stackoverflow.com/a/14083542/3003133)中提到的[权限文章](http://support.microsoft.com/kb/308419) 是一个很好的参考资料，但直接的答案（我使用的快速修复）是：

*   右键单击包含权限被拒绝的数据文件的文件夹，然后单击**Properties**。
*   在文件夹的属性窗口中，选择**安全**选项卡。
*   单击**编辑**按钮。
*   在打开的“文件夹权限”窗口中，单击**添加...**按钮。
*   在“输入`Everyone`要选择的对象名称”文本区域框中键入。
*   单击**确定**，窗口将关闭。
*   通过上一个窗口中的复选框验证默认的**读取和执行**权限是否设置为**允许。**
*   单击**确定**，窗口将关闭。
*   单击文件夹属性窗口中的**应用**按钮。

现在您可以运行需要访问这些文件的 SQL COPY 语句。

*   完成后，返回文件夹的属性窗口。
*   单击**编辑**按钮。
*   在“组或用户名：”字段中选择`Everyone`条目。
*   单击**删除**按钮。
*   在其余打开的窗口上单击“**确定”。**

权限现在已经恢复到原来的样子。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-29T16:16:44.860

用户`Postgres`必须对您要从中复制的文件具有读取权限。

查看[这篇文章](http://support.microsoft.com/kb/308419)，了解如何在 Windows 上修改文件的安全访问权限。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-12-17T13:50:10.657

好的，这就是 COPY 命令的工作原理，逐步将表格导出为 CSV。请注意，我使用的是 pgAdmin 111。

1.  创建要将表导出到的目标文件夹。例如 C:\myExports
2.  按照以下步骤设置此文件夹的读/写权限：

> 右键单击包含权限被拒绝的数据文件的文件夹>，然后单击属性。
> 
> 在文件夹的属性窗口中，选择安全选项卡。单击编辑按钮。
> 
> 在打开的“文件夹权限”窗口中，单击添加...按钮。在“输入要选择的对象名称”文本区域框中键入所有人。
> 
> 单击确定，窗口将关闭。通过上一个窗口中的 >check 复选框验证默认的读取和执行权限是否设置为允许。单击确定，窗口将关闭。
> 
> 单击文件夹属性窗口中的应用按钮。

3.  这是棘手的部分，在 myExports 文件夹中创建一个具有所需名称的空白 CSV 文件。例如，employee.csv

4.  然后像这样运行复制命令：

    > 将员工复制到 'C:\myExports\employee.csv' 分隔符 ',' csv;

在本例中，employee 是表名。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-10T08:08:50.487

如果您不想向所有人授予权限，您可以为启动该服务的帐户添加权限。在控制面板 - 管理工具 - 服务中，复制“登录”选项卡中的帐户名称。（在我的系统上，该帐户称为“网络服务”。）然后与该用户共享包含 CSV 文件的文件夹，如上面的答案所示。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-06T17:17:29.030

要解决此问题，您必须授予 CSV 文件权限，因为 COPY 命令中存在的 CSV 文件由服务器直接读取，而不是客户端应用程序。因此，为了让服务器可以访问这个文件，我们必须提供完全的读写权限，以便 Postgresql 用户可以读取和写入该文件。

参考：[文章](https://ourtechroom.com/tech/importing-csv-file-in-postgresql-table/)显示分步过程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-01-05T20:12:14.980

我刚刚遇到了这个错误，即使在将 postgres 添加到文件夹和文件本身的权限之后，它仍然无法正常工作。因此，我将文件放在公共文件夹中。在 Windows 上，这是路径：“C:\Users\Public\Documents\census.csv”。有效！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-19T19:35:33.533

在不同线程上对这个问题的响应是这样的 1.“告诉我你使用了什么命令”2.“确保你有正确的权限”3.“只需使用 /copy”

我刚刚尝试在我试图从中复制的 cvs 文件上向所有人授予权限，但它仍然给我权限被拒绝错误。我认为此功能已损坏，并且已在多个连续版本的 Windows 上的多个连续版本中损坏。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-30T19:17:22.593

对我来说，我刚刚花了很长时间。我有一个中央数据库驻留在运行 14.04 postgresql-9.5 pgAdmin3 postgis-2.2 的 HP 机器上，共享是通过 tweeked Samba 共享进行的。我的客户混合使用 Windows 10.1、7、8.1，我有一个 ubuntu 14.04 桌面。

我正在处理更新记录和规范化数据的大型表，并围绕从核心 COPY public.table_1 TO（我在 Samba 中设置的共享文件夹[https:// www.youtube.com/watch?v=ndAYZ0DJ-U4](https://www.youtube.com/watch?v=ndAYZ0DJ-U4) ) '/srv/samba/share/[文件名].csv'

然后，一旦使用 COPY table_1 from '/srv/samba/share/test.csv' USING DELIMITERS ',' WITH NULL AS '' CSV HEADER; 修改了表，我就可以更新数据库；来自我的任何客户。

据我所知，关键是进行更新的客户端必须是超级用户，而且一切都必须与用户相关，因为这里有 4 台服务器一起工作 Postgresql、Samba、UNIX 和 WINS 我的所有用户在每台服务器上都注册了相同的用户名和密码，同质性是主要因素。

我已经尝试了很长时间的移动并尝试了各种命名约定，但最终是[http://www.postgresql.org/message-id/CFF47E56EA077241B1FFF390344B5FC10ACB1C0C@webmail.begavalley.nsw.gov.au](http://www.postgresql.org/message-id/CFF47E56EA077241B1FFF390344B5FC10ACB1C0C@webmail.begavalley.nsw.gov.au)让我明白了就像点击了一个大开关。chown 777 在您的共享和群组管理上是一个重要的学习曲线，但是，我在这方面花费的时间将获得回报......热爱 Ubuntu 热爱生活和热爱精神开源，但这可能是睡眠剥夺开始......它工作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-25T14:22:54.937

我试图从 psql 14 中的文件执行 SQL 命令。这就是我可以做到的。

由于“postgres”用户与您自己的用户不同，访问被拒绝。
访问它的最简单方法是，将您尝试访问的文件保留在 Windows 的 C:\Users\Public 或 Linux 发行版中的 \tmp 文件夹中。所有用户都可以访问这些文件夹。

从这个答案的[原始来源](https://www.neilwithdata.com/copy-permission-denied)阅读

# android - C++ 程序在 Eclipse 中不起作用？

> ID：14083312
> 
> 赞同：1
> 
> 时间：2012-12-29T15:52:08.463
> 
> 标签：android

我已经完成了在 Eclipse 中运行 c++ 程序的所有先决条件设置，我已经安装并配置了 CYGWIN 和其他要求，我的程序也没有给出任何错误，但是当我运行它时它不会显示 out 并且它显示一些错误
我的程序是

```
#include <stdio.h>
#include <stdlib.h>
#include<iostream.h>

int main(void)
{
    //puts("Hello World!!!");
    cout<<"Starting...";

    while(1)
    {
        cout<<"Please Help !";
    }
    return 0;//EXIT_SUCCESS;
} 
```

这是我运行程序时控制台中显示的内容：
[New Thread 6040.0x10e0] [New Thread 6040.0xed0]

# ruby-on-rails-3 - 使用 cron 作业的 Ruby 算法帮助

> ID：14083313
> 
> 赞同：0
> 
> 时间：2012-12-29T15:52:14.200
> 
> 标签：ruby-on-rails-3

我决心在周末弄清楚这个算法（如果你想这么称呼它），我想我需要 cron jobs 或者[clockwork](https://github.com/tomykaira/clockwork)的帮助。

**这是我的逻辑：**

添加书籍时，需要卡在“队列行”或“队列状态”中，并且只会在一周的顶部“发布”。在一周的顶部，如果没有书被“排队”，添加一本新的“已出版”书并再次使表格可用（一旦有一本书排队等待出版，该表格将被隐藏）。当我说一周的顶部时，我的意思是必须从用户帐户创建之日起每 7 天出版一本书。

为了提供一些背景知识，我正在创建一个应用程序，鼓励用户在 2013 年期间每周阅读一本书（是的，这个东西必须在星期一推出！）。他们可以添加他们将在下周阅读的书，并在阅读后将该书的状态更改为“已阅读”。如果他们在添加后 7 天内没有将状态更改为“已读”，它会自动下移并显示为“未读”，并添加新的空白书（就像我上面解释的那样）。

整个添加书籍并将状态更改为已读/未读已经完成。我只是在寻求帮助设置 7 天增量图书添加和“排队”。

**对我的代码的一些见解：**

我有一个用户的`books`控制器和模型`belongs_to`。我的用户模型`has_many`书籍。

我正在通过用户`show`视图添加和显示用户的书籍。

我确信有些东西我会遗漏，这将有助于更好地解释我的环境，所以问我吧:) 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:00:06.617

我认为你不需要为此做一个计时工作。

我要做的是为每本已读/未读的书添加一个状态。然后在模型中编写一个方法来检查页面加载并修改视图或控制器数据以进行显示。

Rails/Ruby 有一些不错的日期/时间助手，你可以说 date1 <= 7.days.ago。

这种方法行不通有什么原因吗？

# c# - Dispatcher.BeginInvoke(...) 不发送任何东西

> ID：14083317
> 
> 赞同：2
> 
> 时间：2012-12-29T15:52:56.190
> 
> 标签：c#, wpf, multithreading, dispatcher, begininvoke

我正在尝试从网络服务器获取大量图像，因此不要让服务器每秒有数百个请求超载，我只让一些在 WebService 中处理的请求通过。以下代码位于保存图像的对象上，以及所有绑定的位置。

```
ThreadStart thread = delegate()
{
    BitmapImage image = WebService.LoadImage(data);

    Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() =>
    {
        this.Image = image;
    }));
};

new Thread(thread).Start(); 
```

图像加载得很好，UI 在图像加载时流畅地工作，但从`this.Image = image`未被调用。如果我使用`Dispatcher.CurrentDispatcher.Invoke(..)`该行被调用，但不适用于设置图像。为什么调度程序不调用我的操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:47:10.457

由于您`BitmapImage`是在工作线程上创建的，因此它不属于 WPF 线程。也许这段代码可以帮助您解决问题：

**您发布的代码**

```
ThreadStart thread = delegate()
{
    BitmapImage image = WebService.LoadImage(data, Dispatcher.CurrentDispatcher);

    Dispatcher.CurrentDispatcher.BeginInvoke(new Action(() =>
    {
        this.Image = image;
    }));
};

new Thread(thread).Start(); 
```

**你如何改变你`WebService.LoadImage`的“让它工作”**

```
BitmapImage LoadImage(object data, Dispatcher dispatcher)
{
    // get the raw data from a webservice etc.
    byte[] imageData = GetFromWebserviceSomehow(data);

    BitmapImage image;

    // create the BitmapImage on the WPF thread (important!)
    dispatcher.Invoke(new Action(()=>
    {
        // this overload does not exist, I just want to show that
        // you have to create the BitmapImage on the corresponding thread
        image = new BitmapImage(imageData);
    }));

    return image;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:18:40.700

```
System.Object
    |-> System.Windows.Threading.DispatcherObject
        |-> System.Windows.DependencyObject
            |-> System.Windows.Freezable
                |-> ... 
                    |-> System.Windows.Media.Imaging.BitmapImage 
```

`BitmapImage`是线程关联的。所以`this`控件和`BitmapImage`对象应该在同一个线程中创建。您也可以尝试仅冻结图像，但似乎无济于事。

`BeginInvoke`不会显示错误，因为它是由 WPF 处理的。请参阅 MSDN 如何设置 WPF 跟踪。

WPF 是单线程的。阅读一些所有员工都描述过的关于 WPF 的书。

# ruby-on-rails - 寻找中高级 Rails 3 书籍推荐

> ID：14083319
> 
> 赞同：1
> 
> 时间：2012-12-29T15:53:06.137
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我是一位经验丰富的 Symfony 1.4 开发人员，对 Symfony 2.0 有很好的了解，所以我有点超出框架的基础。我最近使用 Rails 3 构建了一个解决方案，并想拿起一本书来了解我如何可以做得更好。

我主要使用 Rails 作为数据库层，ERb 的方式非常少。我希望在高级细节中看到的一些主题是：

*   JSON
*   关于如何服务富互联网应用的想法和意见
*   良好的 ActiveRecord 使用和规划
*   编写模型并将实现排除在控制器之外
*   一般来说，关于控制器和动作的约定

可能有很多我想听听的主题，但是我还没有兴趣过于专注于测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:38:14.873

没看过这本书，但是感觉真的不错[Ruby Science](https://learn.thoughtbot.com/products/13)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T13:54:14.880

在花了一些时间阅读上面评论中的一些书之后，看起来 Rails Antipatterns 仍然很值得。

# windows-phone-7 - 如何通过类型获取文件名（xaml）的相对Uri？

> ID：14083320
> 
> 赞同：0
> 
> 时间：2012-12-29T15:53:15.643
> 
> 标签：windows-phone-7, windows-8, windows-phone-8

我有 XAML 视图的类型。我想导航到它，传递一个 URI 作为它的位置，就像你在 Windows 8 应用商店应用程序中所做的那样。

基本上，将 Type 转换为应用程序根的相对 URI。

是否可以在 Windows Phone 7.5/8 中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:32:59.073

不支持 Windows Phone 8（或更早版本）中的类型导航。

对于 Windows 8 应用程序，构建过程会生成一个名为 XamlTypeInfoProvider 的映射类（您可以在`obj`构建后的文件夹中找到该文件），正是该文件允许在 Windows 8 中进行类型导航。

我建议您创建一个自定义属性并将其与类文件关联，指定关联的 Xaml 文件，或者只是从类型名称推断 Xaml 文件（就像 Caliburn.Micro 一样！）

# objective-c - 使用 AFNetworking 在缓存前编辑图像

> ID：14083321
> 
> 赞同：0
> 
> 时间：2012-12-29T15:53:21.140
> 
> 标签：objective-c, ios, afnetworking

[我正在使用AFNetworking](https://github.com/AFNetworking/AFNetworking)加载一堆图像，我想在 AFNetworking 缓存它们之前对这些图像进行缩放和应用圆角。

我开始在每次加载图像时对图像进行缩放并应用圆角，但是当从缓存加载图像时也会调用完成块，因此当用户滚动填充有图像的集合视图时，这会使用太多资源。

```
[self.imageView setImageWithURLRequest:[NSURLRequest requestWithURL:url
                                                        cachePolicy:NSURLRequestReturnCacheDataElseLoad
                                                    timeoutInterval:10.0f]
placeholderImage:kVideoCollectionViewCellVideoImagePlaceholder
success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
    /**
     * The image is edited here and this block is called
     * when the image is loaded from web and from the cache.
     */
    [self.imageView setImage:image];
}
failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
    DDLogError(@"%@", error);
}]; 
```

AFNetworking 似乎为我的使用提供了很好的缓存，特别是当我启用磁盘缓存时，因此我想使用它，但我不知道是否有办法在缓存之前编辑图像。

有谁知道这是否可行，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:06:21.420

在发布了这个问题后，它让我觉得我可能太看向另一个使用 UIImageView+AFNetworking 类别的方向了。使用 AFImageRequestOperation 直接解决了这个问题。

```
__weak NZVideoCollectionViewCell *weakSelf = self;
NSURLRequest *request = [NSURLRequest requestWithURL:url
                                         cachePolicy:NSURLRequestReturnCacheDataElseLoad
                                     timeoutInterval:10.0f];
AFImageRequestOperation *operation = [AFImageRequestOperation imageRequestOperationWithRequest:request imageProcessingBlock:^UIImage*(UIImage *image) {
    /**
     *  Edit image.
     */
    return editedImage;
}
success:^(NSURLRequest *request, NSHTTPURLResponse *response, UIImage *image) {
    [weakSelf.imageView setImage:image];
}
failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error) {
    DDLogError(@"%@", error);
}];
[operation start]; 
```

# javascript - Ajax 请求监控流程

> ID：14083322
> 
> 赞同：0
> 
> 时间：2012-12-29T15:53:23.303
> 
> 标签：javascript, ajax, jquery, javascript-events

我在一个 javascript 脚本中有一个 AJAX 请求，我在其中 GET 一个这样的文件：

```
 $.ajax({
      type: "GET",
      url: "./" + img_type + ".bmp",
      dataType: "html",
  timeout: test_timeout, 
      cache: false, 
      success: function(msg)
      {
      //some stuff
      }
  }); 
```

代码本身是正确的并且可以完美运行。有没有办法知道在请求仍在进行时我下载了多少文件？我的意思是，一旦请求给我成功消息，我就知道我已经下载了整个文件，但是如果我想在开始两秒钟后知道呢？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:21:03.020

在此处查看“监控进度”部分：

[https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Using_XMLHttpRequest)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:29:10.553

这是一个例子：

```
var xhr = new XMLHttpRequest;
xhr.onprogress = function(e){
    if(e.lengthComputable){
        var progress = e.position || e.loaded;
        var total = e.totalSize || e.total;
        var percent = progress/total*100;
        //do something with progress here
    }
};

xhr.onload = function(){
    var content = xhr.responseText;
    //do something with the result here
};
xhr.open('GET','./'+type+'.bmp',true);
xhr.send(); 
```

# ruby-on-rails - 将用户重定向到一个页面，将其他用户重定向到另一个页面

> ID：14083323
> 
> 赞同：1
> 
> 时间：2012-12-29T15:53:26.413
> 
> 标签：ruby-on-rails, redirect, before-filter

我有两种用户：工人和管理员。我有一张工人表和一张管理员表。我想强制用户登录，然后才能进入应用程序页面。所以我在下一行添加了我的 ApplicationController：

```
`before_filter :authenticate_user!` 
```

现在，我写了一个函数，叫做：`is_worker`检查是否在workers表中找到了用户。如果是这样，将他重定向到工人的页面。如果找不到用户，将他重定向到管理页面。

我希望工作人员无法进入管理页面，管理员也无法进入工作人员页面。

所以我想我应该添加: `before_filter :is_worker`to:`workerscontroller`和`adminscontroller`.

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :authenticate_user!

  def is_worker
     @email = current_user.email
     tag = Worker.where(:email => @email)
     if tag.nil?
        redirect_to '/admins'
     else
        redirect_to '/workers'
     end
  end
end 
```

如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:09:06.463

这不是很有效。假设您使用的是 STI，请创建如下`is_worker?`方法：

```
def is_worker?
  current_user.type == 'Worker'
end 
```

然后在您的控制器中，您可以添加如下方法：

```
def redirect_after_sign_in
  if current_user.is_worker?
    redirect_to '/admins'
  else
    redirect_to '/workers'
  end
end 
```

我会将其设为私有方法。然后在用户登录成功后调用该方法即可。

即使这样，您也希望在控制器级别保护您的应用程序，以便工作人员不能只访问`/admins`URL 并查看管理数据。

# sql-server - “ConnectionString”在 Visual Studio 2012 中不起作用（使用 SQL SERVER 2008 速成版）

> ID：14083325
> 
> 赞同：-1
> 
> 时间：2012-12-29T15:53:31.493
> 
> 标签：sql-server

我正在使用 Visual Studio 2012 和 SQL SERVER 2008 速成版。我用以下代码编写了一个 C# 程序。这里“SQLExpress”是我在安装过程中给出的实例名称......

```
private void btntest_Click(object sender, EventArgs e)
    {
        SqlConnection con = new SqlConnection();
        con.ConnectionString = "Data Source=SQLExpress;Database = Emp;Integrated Security=True";
        try
        {
            con.Open();
            MessageBox.Show("success");
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        finally
        {
            if (con.State == ConnectionState.Open)
                con.Close();
        }
    } 
```

当我构建它时，没有显示任何错误..当我运行它时，没有抛出异常..但我看不到任何“MessageBox”..

我在这里做错了什么..

编辑：添加了整个代码。

@Oded 感谢您的帮助。我的问题已经解决。这是连接字符串的代码。

```
con.ConnectionString = @"Server=localhost\SQLExpress;Database = Emp;Integrated Security=True"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:01:39.180

尝试这个

`con.ConnectionString = "Data Source=your server name;User ID = your sql server username;Password=Your Sql Server Password;Initial Catalog=Your database name;Integrated Security=True";`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T15:58:54.793

替换您的连接字符串

```
 con.ConnectionString = "Server=SQLExpress;Database = Emp;Integrated Security=True"; 
```

和

```
 connectionString="Data Source=SQLServerNameHere;Initial Catalog=DatabaseNameHere;Integrated Security=SSPI"; 
```

使用您的配置而不是*SQLServerNameHere*和*DatabaseNameHere。*

# php - facebook sdk 在 php 中获取电子邮件地址

> ID：14083328
> 
> 赞同：-2
> 
> 时间：2012-12-29T15:53:58.287
> 
> 标签：php, facebook, email, login, sdk

我刚刚使用 PHP Sdk 定制了一个 Facebook Connect。一切都在我的网页上运行，我可以接收信息，但我不知道如何回显用户的电子邮件地址。我在这里尝试遵循 facebook 的手册：[https](https://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/) ://developers.facebook.com/docs/reference/php/facebook-getLoginUrl/但无法正常工作。:(我忽略了什么吗？

问候，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:08:32.473

我想您已经请求了在您的应用程序中检索电子邮件地址的权限，否则它将无法正常工作：

```
$user = $facebook->getUser();
if ($user) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

echo $user_profile[email]; 
```

# cakephp - cakephp2：在模型中使用分页

> ID：14083336
> 
> 赞同：-1
> 
> 时间：2012-12-29T15:54:22.917
> 
> 标签：cakephp

我希望在模型中使用分页，但是当我插入分页函数时，我得到了这个错误：

> 错误：SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“分页”附近使用正确的语法

我的代码：

```
<?php
class Post extends AppModel
{
    public function get_posts()
    {
        $this->paginate = array(
            'fields' => array('Post.id', 'Post.title', 'Post.created'),
            'limit' => 3,
            'order' => array(
                'Post.created' => 'DESC'
            )           
        );

        $posts = $this->paginate('Post');

        return $posts;
    } 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T19:41:02.173

`paginate()`是控制器方法而不是模型方法。

# php - 如何在一次 ajax 调用中返回 html 代码和 php 值

> ID：14083337
> 
> 赞同：0
> 
> 时间：2012-12-29T15:54:21.947
> 
> 标签：php, html, mysql, ajax, return-value

我有一个简单的 ajax 调用，它返回 html 代码，

```
//=======-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-==-=-==-=-=-=-=
//SEARCH Submit ===============================================================================
$('.clicked_search').live("click",function() {
var from = $('#from').val();
var to = $('#to').val();
var sel = $('#sel').val();

var BegDT = new Date(from);
var EndDT = new Date(to);
var sum = BegDT - EndDT;
alert (BegDT +" b"+ EndDT +" e"+ sum);
if(sum > 0 | from == "" & to != "" | from != "" & to == ""){
$('.inv_date').show();
}
else{
    $("#app_panel").html('<div id="flash" align="left"  ><img src="img/clientimg/ajax.gif" align="absmiddle">&nbsp;<span class="loading">Loading Request...</span></div>');
    $("#clock").html('<div id="flash2" align="left"  ><img src="img/clientimg/ajax.gif" height="15px" align="absmiddle">&nbsp;<span class="loading"><font size="1">Loading Request...</font></span></div>');
    $.ajax({
        type: "POST",
        url: "database/clientpanel/logs/search_call_log.php",
        data: {
            from: from,
            to: to,
            sel: sel
            },
        cache: false,
        success: function(html){
            $("#flash").hide();
            $('.inv_date').hide();
            $("#app_panel").append(html);
        }
    });
    $.ajax({
        url: "database/clientpanel/logs/search_clock_log.php",
        cache: false,
        success: function(html){
            $("#flash2").hide();
            $('.inv_date').hide();
            $("#clock").append(html);
        }
    });
}   
return false;
}); 
```

但我也希望它返回由 ajax 调用的 php 生成的值，

```
session_start();
include("../../dbinfo.inc.php");

// connect to the database
  $client_id = $_SESSION['clientid'];
//===========THIS PHP VALUES RIGHT HERE===================================
      $out = 0;  
      $in = 0;
      $ext =0;
      $min = 0;
      $sec = 0;
//====================================================================
  $query=" select * from call where client='$client_id' ORDER BY date_time DESC";
  $result = $mysqli->query($query); 
```

如何使用一个 ajax 调用返回“html 代码”和“php 值”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:01:36.240

您可以以 JSON 格式传输数据。

在您的 PHP 中，您将构建一个数组，其中包含要为 AJAX 调用传回的所有数据。

```
$results = array(
  'html' => $html,
  'variable1'=>'value1',
  'variable2'=>'value2',
  ...
); 
```

现在，您使用 - 将此数组编码为 JSON 格式[`json_encode()`](http://il1.php.net/manual/en/function.json-encode.php)-

```
$jsonString = json_encode($results);
echo $jsonString; 
```

这是您从 PHP 中回显的值。

现在在您的 jQuery`$.ajax`请求中，您需要指定`dataType:json`，并且您将能够访问成功回调中的所有参数 -

```
$.ajax({
  type: "POST",
  dataType: "json",
  ...
  success: function(data){
    ...
    $("#app_panel").append(data.html);
    // also available :
    // data.variable1 and data.variable2
  }
}); 
```

# java - 如何获取 Eclipse 的源代码

> ID：14083348
> 
> 赞同：2
> 
> 时间：2012-12-29T15:55:38.120
> 
> 标签：java

> **可能重复：**
> [下载 Eclipse 的源代码](https://stackoverflow.com/questions/2890757/downloading-eclipses-source-code)

我知道我可以得到 eclipse SDK。但是我如何才能在 SDK 中观看真实的代码。有人可以告诉我观看它们的细节吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T15:58:13.233

你可以在这里找到你需要的所有源代码：

[http://git.eclipse.org/](http://git.eclipse.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:02:41.913

Eclipse 有很多子项目，您可能需要其中的几个才能构建自己的 ide。

我将从这个[github](http://github.com/)项目[https://github.com/eclipse/eclipse.platform](https://github.com/eclipse/eclipse.platform)开始，然后从那里开始工作。

# node.js - 如何将文件从 GridStore (GridFS) 移动到文件系统以供下载？

> ID：14083349
> 
> 赞同：0
> 
> 时间：2012-12-29T15:55:39.307
> 
> 标签：node.js, mongodb, gridfs

我在 GridFS 中有一些文件，我想将它们下载到浏览器。据我了解，我需要从 GridFS 获取文件并将其移动到服务器的文件系统，以便将其发送到浏览器。

有人可以指出我如何做到这一点的正确方向吗？具体如何将文件从 GridFS 移动到服务器的文件系统。我正在使用带有 Express.js 模块的 node.js 服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:01:02.887

不需要将文件提取到文件系统。看看这个（它适用于图像，但我认为你可以做数学）：[https ://stackoverflow.com/a/9848915/733749](https://stackoverflow.com/a/9848915/733749)

# c - printf("%c", **++argv); 的含义？

> ID：14083350
> 
> 赞同：1
> 
> 时间：2012-12-29T15:55:40.247
> 
> 标签：c

是什么意思：

```
printf("%c", **++argv); 
```

在 C 命令行程序中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T15:57:05.833

打印传递的第一个参数的第一个字符。IE`argv[1][0]`

`argv`是指向传递给的指针的指针`main()`。

`**++argv`：

首先它被递增（由于预递增）以指向下一个指针 is`argv[1]`然后取消引用该指针指向使用 which is 的指针`argv[1][0]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:00:28.267

你可以`argv`在 main() 中声明：like =`main(int argc, char** argv)`

`argv`是参数字符串。

```
++argv means (argv + 1) 
```

`*`是地址运算符的值：

所以

`*argv`=> `*(argv + 0)`=>指向**程序名称**`argv[0]`的第 0 个参数=>指向应该在命令中传递的参数。 **`*(argv +1)``argv[1]``1th argument`**

 **`*++argv => *(argv + 1)`=> `argv[1]` 这是第一个参数的地址，

**[回答]**

`**++argv => *(*(argv + 1) )` => `*(*(argv + 1) + 0)`=> `*((argr[1] + 0)`=>`argv[1][0]`那是第一个参数的第一个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:00:07.260

这将在执行程序时打印第一个命令行参数的第一个字符，如果程序在没有参数的情况下运行，则会崩溃（通过取消引用空指针）。

*(++argv) 返回 argv[1]

这是第一个参数字符串或 null（如果没有参数传递给程序）

*( *(++argv) ) 是 *argv[1] = argv[1][0]

这是第一个参数的第一个字符（如果有的话），否则 *(null) 会崩溃。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:07:35.610

在例程中，`main()`参数`argv`被用作字符串数组，即`argv`一个指向字符的指针。" `++argv`" 自动增量指向传递给的第二个命令行参数`main()`。`*++argv`是指向第二个参数中第一个字符的指针，最后`**++argv`是 cnicutar 发布的第二个参数本身的第一个字符。

在`printf`“ `%c`”中用作字符类型参数的占位符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T16:12:44.353

这是命令行参数的概念。

命令行参数是传递给主函数的参数。

```
printf("%c",**++argv); 
```

在可执行文件之后打印第一个参数的第一个字符..

上面的语句按优先级执行。首先参数递增，然后取消引用以获取值。**

# jquery - HTML / jQuery：HTML DIV 是否会根据 JSON 数据动态变化？

> ID：14083351
> 
> 赞同：0
> 
> 时间：2012-12-29T15:55:42.167
> 
> 标签：jquery, html, json

我有一个很大的 JSON 文件，它本质上是一个充满元素的巨大数组。使用 jQuery，我想将此 JSON 文件加载到 HTML 页面中，将其转换为可使用 HTML 访问的 HTML 对象或表。完成此操作后，我将在此 HTML 页面上创建几个带圆角的 DIV 以模拟条形图。这些 DIV 的高度是否会根据存储在服务器上的当前 JSON 数据而动态变化？我怎样才能做到这一切？我只需要知道如何加载 JSON 数据，转换 JSON 数据，以及如何根据这些数据更改 DIV。下面是 JSON 数据和示例 DIV 代码的示例。

换句话说，我希望 DIV 的高度类似于“height: data[1].key1;”

JSON 示例：

```
 data: 
   [ { name: 'average',
       key1: x,
       key2: y,
       key3: z }, 
```

HTML div 示例：

```
<div style="    margin: 0px auto 10px;
            padding: 4px;
            opacity: 1; border: 1px solid rgb(0, 0, 0);
            box-shadow: 0px 0px 1px rgb(0, 0, 0) inset;
            color: rgb(255, 235, 124);
            float: left;
            width: 0px;
            height: data[1].key1;
            background: #222222;
            left: 55px; 
            position: absolute; 
            top: 259px;
            border-radius: 0px 0px 0px 0px;" class="pane">
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:04:37.860

使用 jQuery，您可以执行以下操作：

`$('.divSelector').css({ 'height': data[1].key1 + 'px' });`

# linq - 如何让 EF 框架通过查询生成此组

> ID：14083352
> 
> 赞同：0
> 
> 时间：2012-12-29T15:55:43.390
> 
> 标签：linq, entity-framework, linq-to-entities

我尝试了几种不同的方法，但生成的输出查询并没有给我留下深刻的印象。看起来效率太低了。它需要高效并且不应该将所有行带回应用层

```
select year(datetaken) as yr,
       month(datetaken) as mth,
       day(datetaken) as dy,
       count(*) as totalpics
from photos
where photos.dateTaken <= @cutoffdate
group by year(datetaken), month(datetaken), day(datetaken)
order by yr asc, mth asc, dy asc 
```

LINQ 查询：

```
var query = ctx.Photos.Where(p => p.DateTaken <= maxCutOffDate)
    .GroupBy(p => new { p.DateTaken.Year, p.DateTaken.Month, p.DateTaken.Day })
    .Select(grp => grp);
var results = query.ToList(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:27:58.027

仅选择分组键 ( `grp.Key`)：

```
var query = ctx.Photos.Where(p => p.DateTaken <= maxCutOffDate)
    .GroupBy(p => new { p.DateTaken.Year, p.DateTaken.Month, p.DateTaken.Day })
    .Select(grp => grp.Key);
var results = query.ToList(); 
```

**编辑**

或者，包括`count`总数：

```
var query = ctx.Photos.Where(p => p.DateTaken <= maxCutOffDate)
    .GroupBy(p => new { p.DateTaken.Year, p.DateTaken.Month, p.DateTaken.Day })
    .Select(grp => new
    {
        Date = grp.Key,
        TotalPics = grp.Count()
    });
var results = query.ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T18:18:33.317

您可以通过 访问关键属性`grp.Key`并通过 计数`grp.Count()`。

```
var query = ctx.Photos.Where(p => p.DateTaken <= maxCutOffDate)
    .GroupBy(p => new { p.DateTaken.Year, p.DateTaken.Month, p.DateTaken.Day })
    .Select(grp => new 
                   { 
                       grp.Key.Year,
                       grp.Key.Month,
                       grp.Key.Day,
                       Count = grp.Count()
                   });
var results = query.ToList(); 
```

# tsql - 在 SQL Server 中存储 .fmt 文件

> ID：14083356
> 
> 赞同：3
> 
> 时间：2012-12-29T15:56:04.750
> 
> 标签：tsql, sql-server-2008-r2, bulkinsert

是否可以像存储过程一样将 .fmt 文件直接存储在数据库中，而不是单独的文件中？导入的文件不同，程序的格式文件是不变的。不使用 BLOB，不使用 FILESTREAM。

```
...    
FROM OPENROWSET (
            BULK 'd:\path\some_variable_file.txt',
            FIRSTROW = 2,
            FORMATFILE = 'd:\path\importformat.fmt'
        ) AS import 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:45:59.667

除了 FORMATFILEs 的文件系统之外，OPENROWSET 不支持任何源。您可以做的一种选择是将格式文件数据（以非 xml 或 xml 格式）存储在数据库中，并使用 powershell 脚本将其提取

# ruby-on-rails-3 - 从 after_create 回调中获取最后一个插入 id

> ID：14083357
> 
> 赞同：0
> 
> 时间：2012-12-29T15:56:12.157
> 
> 标签：ruby-on-rails-3, activerecord

我的控制器

```
new_task = {:user_id => params[:user_id],:task => params[:task] }
work = Work.new new_task
if work.valid?
    work.save!
    if !params[:sub].nil?
        new_sub = {:activity => self.activity.id,:sub_task => "something etc" }
        sub_task = SubTask.new new_sub
        sub_task.save!
    end

end 
```

我的模特

```
attr_accessible :user_id, :task, :created_at, :updated_at
after_create :add_activity

def add_activity
    new_activity = {:user_id => self.user_id,:text => "new task" }
    user_activity = Activity.new new_activity
    user_activity.save!
end 
```

我如何获得活动表单 after_create 回调的最后插入 ID。self.activity.id 不适合我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:52:37.547

```
def last_activity
  @last_activity || (Activity.where(:user_id => self.user_id).order("id").last if user_id)
end

def add_activity
  new_activity = {:user_id => self.user_id,:text => "new task" }
  user_activity = Activity.new new_activity
  user_activity.save!
  @last_activity = user_activity
end

self.last_activity.id 
```

# android - Jsoup 的 getelementbyid 在异步任务中不起作用

> ID：14083358
> 
> 赞同：0
> 
> 时间：2012-12-29T15:56:26.677
> 
> 标签：android, jsoup

我正在使用 jsoup 的 getElementById 方法来获取 id "content-main" 的内容。当我将它作为 java 应用程序运行时，一切正常，但作为 android 应用程序不是。我只是得到 null.I' m 在 AsyncTask 的 doInBackground 中使用以下代码。

```
Document doc=Jsoup.connect("http://www.blabla.com").get();
Element t=doc.body().getElementById("content-main");
System.out.println(t); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T12:08:10.073

是的，尽管我已经找到了问题所在。我正在加载我的网站的移动版本，但该 id 不存在。无论如何，谢谢

# javascript - 对 Instagram API 的 CURL 删除请求失败

> ID：14083361
> 
> 赞同：0
> 
> 时间：2012-12-29T15:57:04.447
> 
> 标签：javascript, php, curl, instagram, http-delete

我试图通过调用 API 来改变我在 Instagram 上喜欢的照片。我的网址与 instagrams API 工具中的网址完全相同。我使用卷曲。我得到一个空响应，没有错误或状态代码。

这是我用 javascript 编写的“喜欢/不喜欢”方法。

```
likeImage: function(type, id)
{
    var params = "url=https://api.instagram.com/v1/media/" + id + "/likes";
        if(type === 'DELETE')
        {
            params += "?access_token=" +  localStorage.getItem('id') + "." + localStorage.getItem('token');
        }
        else
        {
            params += "&access_token=" +  localStorage.getItem('id') + "." + localStorage.getItem('token');     
        }
    $.ajax({
        url: "crossDomain.php",
        contentType: "application/x-www-form-urlencoded; charset=UTF-8",
        type: type,
        data: params,
        beforeSend: function () 
        {
            console.log('Start' + type);
        },
        complete: function(data)
        {
            console.log('Finished ' + type);
        },
        success: function(data)
        {
            console.log('Success ' + type);
            console.log(data);
        },
        error: function(jqXHR, textStatus, errorThrown)
        {
            console.log('JQXHR:' + jqXHR);
            console.log('TEXTSTATUS: ' + textStatus);
            console.log('ERROR THROWN:' + errorThrown);
            console.log('error');
        }
    }); 
```

这是我用 PHP 编写的服务器代码

```
$method = $_SERVER['REQUEST_METHOD'];

if($method == "POST")
{
$url = $_POST['url'];
$token = $_POST['access_token'];

$fields = array(
    "access_token" => urlencode($token)
);

$fields_string = "";
foreach($fields as $key=>$value) 
{ 
    $fields_string .= $key.'='.$value.'&'; 
}

rtrim($fields_string, '&');

$ch = curl_init();
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch,CURLOPT_POST, count($fields));
curl_setopt($ch,CURLOPT_POSTFIELDS, $fields_string);

$result = curl_exec($ch);
curl_close($ch);

echo $result;
}

else if($method == 'DELETE')
{
$url = file_get_contents('php://input');
$ch = curl_init();
curl_setopt($ch,CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "DELETE");
$result = curl_exec($ch);
curl_close($ch);
echo $result;
} 
```

我的 Like 代码完美运行……有什么想法吗？根据文档，删除请求应如下所示：

```
curl -X DELETE https://api.instagram.com/v1/media/{media-id}/likes?access_token=MYACCESSTOKEN 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T05:39:28.390

问题解决了。在我的 PHP 删除方法中，$url 以`url=...`我只需要删除它开始。

# objective-c - 无法使用修改后的数据刷新 UITableView

> ID：14083363
> 
> 赞同：-1
> 
> 时间：2012-12-29T15:57:05.897
> 
> 标签：objective-c, cocoa-touch, uitableview

我有一个 iPad 应用程序，使用 XCode 4.5、Storyboards、Core Data 和 iOS 6。我选择一行，对记录的内容进行更改（成功），但该行没有改变。我试图刷新 UITableView，但从未调用**cellForRowAtIndexPath 。**我搜索了 SO 和 Google 无济于事；我看不出有什么问题。有人可以告诉我如何解决这个问题吗？（解释我下次做错了什么？）

以下是相关代码：

```
- (IBAction)btnModify:(UIButton *)sender {

    //NSLog(@"btnModify clicked");

    NSManagedObjectContext *localContext = [NSManagedObjectContext MR_contextForCurrentThread];

    //  find client by primary telephone number
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"aClientPrimaryPhone ==[c] %@", cvPrimaryPhone.text];
    ClientInfo *clientDataFound = [ClientInfo MR_findFirstWithPredicate:predicate inContext:localContext];

    if(clientDataFound)  {
        clientDataFound.aClientName = cvCustName.text;  //  now start moving the data
        clientDataFound.aClientAddr1 = cvAddress1.text;
        clientDataFound.aClientAddr2 = cvAddress2.text;
        clientDataFound.aClientCity = cvContactCity.text;
        clientDataFound.aClientPostalCode = cvPostalCode.text;
        clientDataFound.aClientCellPhone = cvCellPhone.text;
        clientDataFound.aClientPrimaryPhone = cvPrimaryPhone.text;
        clientDataFound.aClientEMail = cvPersonalEmail.text;
        clientDataFound.aClientNotes = cvNotes.text;

        [localContext MR_saveNestedContexts];

        [self reloadClientList];
    }
}
-(void) reloadClientList  {

    //Init Array to hold TableView Data
    tableDataArray = [NSMutableArray new];
    [tableDataArray addObjectsFromArray:[ClientInfo findAll]];  //  Load

    [self.clientList reloadData];

} 
```

这是 ClientInfo.m

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@interface ClientInfo : NSManagedObject

@property (nonatomic, retain) NSString * aClientAddr1;
@property (nonatomic, retain) NSString * aClientAddr2;
@property (nonatomic, retain) NSString * aClientCellPhone;
@property (nonatomic, retain) NSString * aClientCity;
@property (nonatomic, retain) NSString * aClientEMail;
@property (nonatomic, retain) NSData * aClientImage;
@property (nonatomic, retain) NSString * aClientName;
@property (nonatomic, retain) NSString * aClientNotes;
@property (nonatomic, retain) NSString * aClientPostalCode;
@property (nonatomic, retain) NSString * aClientPrimaryPhone; 
```

@结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:25:54.657

我找到了...我的“clientList”没有连接到对象...不知道我怎么错过了那个！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:40:48.870

我能想到的原因有几个：

1.  您的表视图引用 clientList 为零。（未连接）

2.  您的表视图的 DataSource & Delegate 未设置（实际上我不确定它是否在未设置 DataSource 时编译）

3.  您的表视图是一个子类，`UITableView`并且在该子类中`reloadData`方法被覆盖。

# java - 使用 Gson 的 JSON 数据中的冒号 (:)

> ID：14083365
> 
> 赞同：0
> 
> 时间：2012-12-29T15:57:18.533
> 
> 标签：java, android, json, gson

我正在调用返回 JSON 的 Web 服务。在该 JSON 中，我有一个包含 URL 的属性。但是该 URL 中的冒号 (:) 使 Gson 抛出`gson.stream.MalformedJsonException`错误。我知道这些键和值应该被包装

## Web 服务返回的 JSON：

```
{
   ID=15; 
   Code=ZPFgNr; 
   UserName=https://www.google.com/accounts/o8/id?id=xxxxxx; //<--problem
   FirstName=Joe
} 
```

我的爪哇：

```
resultData=((SoapObject) result).getProperty(0).toString();
User response = gson.fromJson(resultData, User.class); 
```

**我知道这些键和值应该用双引号括起来。**但他们不是，这似乎是问题所在。

# 所以我的问题是：

我应该在以某种方式反序列化它之前对这个 JSON 进行编码吗？如果是这样，怎么做？

**或者**

我应该`https:`在冒号上进行查找和替换并转义，如果是这样，我将如何转义冒号？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:01:16.963

JSON 使用逗号分隔属性，使用冒号分隔属性名称和属性值，并使用双引号将名称和值括起来。这不是有效的 JSON。

这是有效的 JSON：

```
{
   "ID" : "15", 
   "Code" : "ZPFgNr",
   "UserName" : "https://www.google.com/accounts/o8/id?id=xxxxxx",
   "FirstName" : "Joe"
} 
```

# erlang - mnesia 不会与主管一起重新启动

> ID：14083367
> 
> 赞同：0
> 
> 时间：2012-12-29T15:57:26.480
> 
> 标签：erlang, erlang-supervisor

我在使用 gen_server、supervisor 和 mnesia 时遇到问题。我有主管：[http](http://pastebin.com/8rkfrq7D) ://pastebin.com/8rkfrq7D ，它会触发正在启动 mnesia 的服务器模块。我的问题是当我写

```
erl
c(superv).
superv:start_link().
//it opens fine
C^
erl
c(superv).
superv:start_link().
    ** exception exit: shutdown
//if i try again start_link() it is working 
```

我懂了。我删除了负责启动 mnesia 的部分，它运行良好，所以我希望即时退出（通过 ctrl+c）不会正确关闭 mnesia。不幸的是，即使我调用 mnesia:stop()，在快速调用 start_link() 之前，它也会返回异常退出。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T22:28:31.197

The not entirely right way to start mnesia is as an application.

```
application:start(mnesia). 
```

before you start your application. It can be used when you are developing your system. For a real deployment, you want to generate a `release` with a *boot-script*. A release is a self-contained Erlang system you can start up on a foreign machine. You will write your own application, write a `my_application_name.app` file which contains a dependency on `mnesia`. Then you want to generate a release, typically with `reltool` and this release will then initialize by starting up mnesia before starting `my_application_name`. At least this is the *real* way to do it.

The tool like `rebar` can help you with maintaining your application and a `reltool.config` file for building your release.

Note that Mnesia needs a schema before it can start. A common trick is to have your release contain a default empty database which gets installed such that mnesias `dir` parameter points to it. Thus, if you start a newly generated system, it has a database to start from. And you can restart from scratch by re-installing the empty database. Check out `FALLBACK.BUP` in mnesia for hints on how to do this.

As for your errors, you can't start your server twice. The first time around, it registers itself under the atom `server` so a subsequent restart when it is already running will crash it. You can sometimes get a hint if you boot Erlang with the SASL application enabled. Either execute `application:start(sasl)` or run erlang like so:

```
erl -boot start_sasl 
```

which substitutes the normal boot script with a variant that also starts SASL.

# php - 页面重新加载后选择一行

> ID：14083372
> 
> 赞同：0
> 
> 时间：2012-12-29T15:58:32.497
> 
> 标签：php, jquery

页面重新加载后是否可以选择一行？

我尝试获得这种效果： http: [//jsfiddle.net/yg4n6/2/](http://jsfiddle.net/yg4n6/2/)我的意思是用户可以在点击时获得行突出显示。但是当我必须重新加载页面以使用 php 执行其他操作时，问题就来了。选择的行与id相同。

```
<tr>
    <td> <a href="?id=<?php echo $row['id'] ?>">
    <input type="text" name="num" value="<?php echo $row['id']?>"/>
    </a> </td>

    <td><input type="text" name="a" value="<?php echo $row['a']?>"/></td>
    <td><input type="text" name="b" value="<?php echo $row['b']?>"/></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:35:58.790

每个页面重新加载都是来自服务器的页面的一个新实例。因此，如果您想保存网页的状态，则必须以某种形式保存它，例如隐藏字段或查询字符串。你不能用 javascript 做到这一点。

您对 javascript 所做的事情是在客户端，而服务器无论如何都不知道这一点。

对于您的情况，您可以这样做。假设您的行由 php 回显，您可以使用此解决方案。`$row['id']`是结果集迭代中行的 id。

```
<?php
$row = $_GET["id"];
?>
<tr>
<td> <a href="?id=<?php echo $row['id'] ?>">
<input type="text" name="num" value="<?php echo $row['id']?>"/>
</a> </td>

<td><input <?php if($row['id'] == $row) echo 'class="highlight"'; ?> type="text" name="a" value="<?php echo $row['a']?>"/></td>
<td><input <?php if($row['id'] == $row) echo 'class="highlight"'; ?> type="text" name="b" value="<?php echo $row['b']?>"/></td> 
```

希望能帮助到你...

# jquery - 使用颜色选择器将可用颜色限制为灰度

> ID：14083373
> 
> 赞同：0
> 
> 时间：2012-12-29T15:58:34.840
> 
> 标签：jquery, colors

使用颜色选择器[http://labs.abeautifulsite.net/jquery-miniColors/](http://labs.abeautifulsite.net/jquery-miniColors/)，如何将颜色数量限制为仅使用灰度滑块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-21T02:01:34.307

为了限制**灰度**值，rgb 模型必须如下：

```
x = [0, 255]

rgb(x, x, x) 
```

例如：

```
.elem { background-color: rgb(122, 122, 122); } 
```

或以十六进制表示，如 css # 表示法，值必须遵循：

```
x = [0, 9][a, f]
y = [0, 9][a, f]

#xyxyxy 
```

例如：

```
.elem { background-color: #e1e1e1; } 
```

# c# - EntityFramework 中的 db.foo.Where 和 db.Database.SqlQuery 之间是否有真正的区别

> ID：14083378
> 
> 赞同：0
> 
> 时间：2012-12-29T15:58:53.687
> 
> 标签：c#, entity-framework

以下两种方法之间是否存在真正的性能、质量或安全差异？

方法一：

```
ViewBag.Foo= db.Words.Where(w => w.WordBaseID == 1 && w.LanguageID == lang).FirstOrDefault().Text; 
```

方法二：

```
var query = "SELECT Text FROM Words WHERE WordBaseID = {0} AND LanguageID = {1}";
ViewBag.Foo= db.Database.SqlQuery<string>(query, 1, lang).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:04:23.690

我认为性能或安全性不会有差异。不同之处在于您的应用程序的维护。使用第二种方法，您是在代码中编写 SQL 查询 -> 从而混合了 C# 和 SQL，完全违背了 ORM 的目的。我的意思是，如果您要编写纯 SQL，请考虑使用 ADO.NET -> 它会比 ORM 更快。

如果您的代码中有很多 SQL 查询，那么在您决定重命名表的那一天，您的代码中会有很多地方需要修改，而如果您坚持使用经典的 ORM 工具，您只需要更新您的映射并保留框架担心发出正确的 SQL 查询。编写本机 SQL 查询的另一个缺点是您现在被绑定到特定的数据提供者。请记住，并非所有数据库都支持所有 SQL 方法。ORM 框架将考虑方言之类的东西，...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:05:33.697

这将为您提供生成的 SQL。

```
var result = db.Words.Where(w => w.WordBaseID == 1 && w.LanguageID == lang).FirstOrDefault().Text;

var sql = ((System.Data.Objects.ObjectQuery)result).ToTraceString(); 
```

你可以比较差异。

# android - 点未在 opengles 2.0 中显示

> ID：14083384
> 
> 赞同：0
> 
> 时间：2012-12-29T15:59:51.673
> 
> 标签：android, opengl-es

我正在尝试深入学习android中的OpenGLES 2.0。我试图在屏幕中心绘制一个简单点，但不知何故，该点没有显示。

```
 public class MyRenderer implements GLSurfaceView.Renderer {
    Context context;

    private int mProgram;

    private final float[] mViewMatrix=new float[16];
    private float[] mProjectionMatrix=new float[16];
    private final float[] mPointModelMatrix=new float[16];

    private final float[] mMVPMatrix=new float[16];

    private final float[] mPointPosInModelSpace = new float[] {0.0f, 0.0f, 0.0f, 1.0f};
    private final float[] mPointPosInWorldSpace =   new float[4];
    private final float[] mPointPosInEyeSpace   =   new float[4];

    private int pointMVPMatrixHandle;
    private int pointPositionHandle;

public MyRenderer(Context context){
    this.context=context;
}

public void onDrawFrame(GL10 arg0) {
    // TODO Auto-generated method stub

    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);

    Matrix.setIdentityM(mPointModelMatrix, 0);

    Matrix.translateM(mPointModelMatrix, 0, 0.0f, 0.0f, -3.0f);

    Matrix.multiplyMV(mPointPosInWorldSpace, 0, mPointModelMatrix, 0, mPointPosInModelSpace, 0);
    Matrix.multiplyMV(mPointPosInEyeSpace, 0, mViewMatrix, 0, mPointPosInWorldSpace, 0);

    GLES20.glUseProgram(mProgram);

    drawPoint();        
}

private void drawPoint(){

    pointMVPMatrixHandle=GLES20.glGetUniformLocation(mProgram, "u_MVPMatrix");
    pointPositionHandle=GLES20.glGetAttribLocation(mProgram, "a_position");

    GLES20.glVertexAttrib3f(pointPositionHandle, mPointPosInEyeSpace[0], mPointPosInEyeSpace[1], mPointPosInEyeSpace[2]);
    GLES20.glDisableVertexAttribArray(pointPositionHandle);

    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mPointModelMatrix, 0);
    Matrix.multiplyMM(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);
    GLES20.glUniformMatrix4fv(pointMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Draw the point.
    GLES20.glDrawArrays(GLES20.GL_POINTS, 0, 1);

}

public void onSurfaceChanged(GL10 gl, int width, int height) {
    // TODO Auto-generated method stub
GLES20.glViewport(0, 0, width, height); 

final   float ratio=(float)width/height;
    Log.d("Ratio is", " "+ratio);
    Log.d("Width is"," "+width+"  and "+height);
final   float left  =   -ratio;
final   float right =   ratio;
final   float bottom=   -1.0f;
final   float top   =   1.0f;
final   float near  =   1.0f;
final   float far   =   10.0f;

Matrix.frustumM(mProjectionMatrix, 0, left, right, bottom, top, near, far);
}

public void onSurfaceCreated(GL10 gl, EGLConfig config) {
    // TODO Auto-generated method stub
    GLES20.glClearColor(0.0f, 0.0f, 0.0f, 0.0f);

    GLES20.glEnable(GLES20.GL_CULL_FACE);
    GLES20.glEnable(GLES20.GL_DEPTH_TEST);

    float eyeX=0.0f;
    float eyeY=0.0f;
    float eyeZ=-0.5f;

    float centerX=0.0f;
    float centerY=0.0f;
    float centerZ=-5.0f;

    float upX=0.0f;
    float upY=1.0f;
    float upZ=0.0f;

    Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, centerX, centerY, centerZ, upX, upY, upZ);

    final String vertexShader=this.getVertexShader();
    final String fragmentShader=this.getFragmentShader();

    final int vertexShaderHandle=ShaderHelper.compileShader(GLES20.GL_VERTEX_SHADER, vertexShader);
    final int fragmentShaderHandle=ShaderHelper.compileShader(GLES20.GL_FRAGMENT_SHADER, fragmentShader);

    mProgram=ShaderHelper.createAndLinkProgram(vertexShaderHandle, fragmentShaderHandle, new String[]{"a_position"});       
}

private String getVertexShader(){
    final String vertexShader="uniform mat4 u_MVPMatrix;      \n"       
              + "attribute vec4 a_Position;     \n"     
              + "void main()                    \n"
              + "{                              \n"
              + "   gl_Position = u_MVPMatrix   \n"
              + "               * a_Position;   \n"
              + "   gl_PointSize = 10.0;         \n"
              + "}                              \n";

    return vertexShader;

}

private String getFragmentShader(){
    final String fragmentShader="precision mediump float;       \n"                           
              + "void main()                    \n"
              + "{                              \n"
              + "   gl_FragColor = vec4(1.0,    \n" 
              + "   1.0, 1.0, 1.0);             \n"
              + "}                              \n";
    return fragmentShader;
} 
```

}

我非常确定我将两只眼睛都指向负 Z 方向（远离观察者）。该点应显示为顶点着色器，点大小为 10.0，但不知何故，没有运气。

注意：ShaderHelper 是一个具有静态方法 compileShader 和 createAndLinkProgram 的类，其中编写了用于编译着色器、检查错误的代码。（程序中没有错误）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:54:06.260

这是我根据您的代码构建的用于显示该点的类。由于您最终可能会使用多个点，因此最好将这些点推入顶点数组，如图所示。

```
 package point.example.point;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;
import android.opengl.GLES20;
import android.opengl.GLSurfaceView;
import android.opengl.Matrix;

public class PointRenderer implements GLSurfaceView.Renderer 
{
    private float[] mModelMatrix = new float[16];
    private float[] mViewMatrix = new float[16];
    private float[] mProjectionMatrix = new float[16];
    private float[] mMVPMatrix = new float[16];
    private int mMVPMatrixHandle;
    private int mPositionHandle;

    float[] vertices = {
              0.0f,0.0f,0.0f
            };
    FloatBuffer vertexBuf;  

    @Override
    public void onSurfaceCreated(GL10 glUnused, EGLConfig config) 
    {       
        vertexBuf = ByteBuffer.allocateDirect(vertices.length * 4).order(ByteOrder.nativeOrder()).asFloatBuffer();
        vertexBuf.put(vertices).position(0);        

        // Set the background clear color to gray.
        GLES20.glClearColor(0.5f, 0.5f, 0.5f, 0.5f);

        float eyeX=0.0f;
        float eyeY=0.0f;
        float eyeZ=0.0f;

        float centerX=0.0f;
        float centerY=0.0f;
        float centerZ=-5.0f;

        float upX=0.0f;
        float upY=1.0f;
        float upZ=0.0f;

        // Set the view matrix. This matrix can be said to represent the camera position.
        // NOTE: In OpenGL 1, a ModelView matrix is used, which is a combination of a model and
        // view matrix. In OpenGL 2, we can keep track of these matrices separately if we choose.
        Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, centerX, centerY, centerZ, upX, upY, upZ);

        final String vertexShader =
                            "uniform mat4 u_MVPMatrix;      \n"       
                          + "attribute vec4 a_Position;     \n"     
                          + "void main()                    \n"
                          + "{                              \n"
                          + "   gl_Position = u_MVPMatrix   \n"
                          + "               * a_Position;   \n"
                          + "   gl_PointSize = 10.0;       \n"
                          + "}                              \n";

        final String fragmentShader =
                            "precision mediump float;       \n"                           
                          + "void main()                    \n"
                          + "{                              \n"
                          + "   gl_FragColor = vec4(1.0,    \n" 
                          + "   1.0, 1.0, 1.0);             \n"
                          + "}                              \n";    

        // Load in the vertex shader.
        int vertexShaderHandle = GLES20.glCreateShader(GLES20.GL_VERTEX_SHADER);

        if (vertexShaderHandle != 0) 
        {
            // Pass in the shader source.
            GLES20.glShaderSource(vertexShaderHandle, vertexShader);

            // Compile the shader.
            GLES20.glCompileShader(vertexShaderHandle);

            // Get the compilation status.
            final int[] compileStatus = new int[1];
            GLES20.glGetShaderiv(vertexShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, 0);

            // If the compilation failed, delete the shader.
            if (compileStatus[0] == 0) 
            {               
                GLES20.glDeleteShader(vertexShaderHandle);
                vertexShaderHandle = 0;
            }
        }

        if (vertexShaderHandle == 0)
        {
            throw new RuntimeException("Error creating vertex shader.");
        }

        // Load in the fragment shader shader.
        int fragmentShaderHandle = GLES20.glCreateShader(GLES20.GL_FRAGMENT_SHADER);

        if (fragmentShaderHandle != 0) 
        {
            // Pass in the shader source.
            GLES20.glShaderSource(fragmentShaderHandle, fragmentShader);

            // Compile the shader.
            GLES20.glCompileShader(fragmentShaderHandle);

            // Get the compilation status.
            final int[] compileStatus = new int[1];
            GLES20.glGetShaderiv(fragmentShaderHandle, GLES20.GL_COMPILE_STATUS, compileStatus, 0);

            // If the compilation failed, delete the shader.
            if (compileStatus[0] == 0) 
            {               
                GLES20.glDeleteShader(fragmentShaderHandle);
                fragmentShaderHandle = 0;
            }
        }

        if (fragmentShaderHandle == 0)
        {
            throw new RuntimeException("Error creating fragment shader.");
        }

        // Create a program object and store the handle to it.
        int programHandle = GLES20.glCreateProgram();

        if (programHandle != 0) 
        {
            // Bind the vertex shader to the program.
            GLES20.glAttachShader(programHandle, vertexShaderHandle);           
            // Bind the fragment shader to the program.
            GLES20.glAttachShader(programHandle, fragmentShaderHandle);
            // Bind attributes
            GLES20.glBindAttribLocation(programHandle, 0, "a_Position");
            // Link the two shaders together into a program.
            GLES20.glLinkProgram(programHandle);
            // Get the link status.
            final int[] linkStatus = new int[1];
            GLES20.glGetProgramiv(programHandle, GLES20.GL_LINK_STATUS, linkStatus, 0);
            // If the link failed, delete the program.
            if (linkStatus[0] == 0) 
            {               
                GLES20.glDeleteProgram(programHandle);
                programHandle = 0;
            }
        }

        if (programHandle == 0)
        {
            throw new RuntimeException("Error creating program.");
        }

        // Set program handles. These will later be used to pass in values to the program.
        mMVPMatrixHandle = GLES20.glGetUniformLocation(programHandle, "u_MVPMatrix");        
        mPositionHandle = GLES20.glGetAttribLocation(programHandle, "a_Position");

        // Tell OpenGL to use this program when rendering.
        GLES20.glUseProgram(programHandle);        
    }   

    @Override
    public void onSurfaceChanged(GL10 glUnused, int width, int height) 
    {
        // Set the OpenGL viewport to the same size as the surface.
        GLES20.glViewport(0, 0, width, height);

        // Create a new perspective projection matrix. The height will stay the same
        // while the width will vary as per aspect ratio.
        final float ratio = (float) width / height;
        final float left = -ratio;
        final float right = ratio;
        final float bottom = -1.0f;
        final float top = 1.0f;
        final float near = 1.0f;
        final float far = 100.0f;

        Matrix.frustumM(mProjectionMatrix, 0, left, right, bottom, top, near, far);
    }   

    @Override
    public void onDrawFrame(GL10 glUnused) 
    {
        GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);                    

        Matrix.setIdentityM(mModelMatrix, 0);
        //Push to the distance - note this will have no effect on a point size
        Matrix.translateM(mModelMatrix, 0, 0.0f, 0.0f, -5.0f);
        Matrix.multiplyMV(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);
        Matrix.multiplyMV(mMVPMatrix, 0, mProjectionMatrix, 0, mMVPMatrix, 0);
        GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);

        //Send the vertex
        GLES20.glVertexAttribPointer(mPositionHandle, 3, GLES20.GL_FLOAT, false, 0, vertexBuf);
        GLES20.glEnableVertexAttribArray(mPositionHandle);

        //Draw the point
        GLES20.glDrawArrays(GLES20.GL_POINTS, 0, 1);        

    }   
} 
```

# ruby-on-rails-3 - Mountain Lion - Rails - 未找到符号：_rb_Digest_MD5_Finish (LoadError)

> ID：14083390
> 
> 赞同：2
> 
> 时间：2012-12-29T16:00:30.567
> 
> 标签：ruby-on-rails-3, osx-mountain-lion

我在跑山狮。使用 Macports（带有指向 /usr/bin/gcc-4.2 的符号链接）、rvm、ruby 1.9.3 和 gem install rails 安装 apple-gcc-4.2 后，我收到错误“找不到符号：_rb_Digest_MD5_Finish (LoadError) 引用自: /Users/userid/.rvm/rubies/ruby-1.9.3-p362/lib/ruby/1.9.1/x86_64-darwin12.2.0/digest/md5.bundle 运行'rails new testapp'时出错。我没有看到任何地方讨论过这个问题，并且完全不知道如何进行。

任何帮助将非常感激。

谢谢。

斯蒂芬

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T07:37:18.717

检查是否`C_INCLUDE_PATH`设置。`env | grep C_INCLUDE_PATH`. 如果是，请将其从您的环境中删除，然后重新构建 Ruby。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T23:03:40.273

安装[XQuartz](http://xquartz.macosforge.org/trac/wiki/X112.7.4)并尝试重新安装 Ruby 和 Rails

它将解决“达尔文”问题

# excel - 将内容从单元格移动到带有空格的 msgbox？

> ID：14083394
> 
> 赞同：1
> 
> 时间：2012-12-29T16:00:48.300
> 
> 标签：excel, vba, newline, msgbox

我有一个有趣的问题 - 我正在尝试编写 VBA 代码，它将获取单元格的内容并将其放入 msgbox。问题是我不知道如何将回车符放入这个字符串中。

我的代码看起来像这样。

```
Dim myMsg as string
myMsg = Worksheets("Data").cells(1,1)
msgBox myMsg 
```

所以，如果单元格`A1`包含...

```
THIS IS MY NEXT AND NOW THIS IS A NEW LINE 
```

...我怎样才能强制回车到该行的中间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:04:11.147

我从未使用过 VBA，但在线快速搜索给了我这个：

```
 "some string" & vbCrLf & "next line" 
```

和

```
 "some string " & chr(13) & "next line" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T20:41:12.130

要插入一个新行是一个消息框，请使用 vbCrLF。

所以，假设你想在每次有反斜杠时换行。你会使用：

```
Msgbox Replace(ActiveCell.Value, "\", vbCrLF) 
```

要适应示例代码的范围，请使用：

```
Dim myMsg as string
Dim newLineCharacter as string

newLineCharacter = "\"  ' Replace with your delimiter

myMsg = Replace(Worksheets("Data").cells(1,1), newLineCharacter, vbCrLf)
msgBox myMsg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T17:32:44.077

这取决于你的目标是什么。如果您想在显示在消息框之前在 Excel 中预先格式化文本，使用`<Alt+Enter>`Excel 换行，那么您的 VBA 将如下所示：

```
MsgBox Worksheets("Data").cells(1,1).value 
```

如果您打算自动换行，请编写一个函数来剪切字符串并提供长度。

```
MsgBox WrapText(Worksheets("Data").cells(1,1).value, 20) 
```

# git - svn to git - 仅导入具有完整历史记录的主干

> ID：14083395
> 
> 赞同：2
> 
> 时间：2012-12-29T16:00:49.820
> 
> 标签：git, svn, git-svn

我目前正在`git-svn`通过发出以下命令将我的 WordPress 插件从 SVN 迁移到 git

```
git svn clone -r12345 -A AUTHORS_FILE --no-minimize-url --username=SVN_USERNAME http://plugins.svn.wordpress.org/posts-by-tag
git svn fetch 
```

它正在工作，但问题是它非常慢，因为 repo 很大而且我有很多标签。`git-svn`尝试检索所有标签，这需要很长时间（15-20 个标签大约需要 3-4 小时）

我不需要标签，也不会使用`git-svn`. 所以我想看看是否可以只检索主干（留下标签和分支）但有完整的历史记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:16:47.623

只需指定`/trunk`为顶级目录：

```
git svn clone -r12345 -A AUTHORS_FILE --no-minimize-url --username=SVN_USERNAME \
  http://plugins.svn.wordpress.org/posts-by-tag/trunk 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:05:42.980

[尝试此处](http://www.kernel.org/pub/software/scm/git/docs/git-svn.html)记录的 --ignore-paths 参数

# objective-c - NSDateFormatter dateFromString 与日期

> ID：14083396
> 
> 赞同：2
> 
> 时间：2012-12-29T16:00:50.397
> 
> 标签：objective-c, ios, nsdate, nsdateformatter

我的方法 dateFromString 有问题，这是我的代码

```
NSString* res = [NSString stringWithFormat:@"%@/%@/%@",dateInput.text,monthInput.text,yearInput.text];
NSDateFormatter* formatter = [[NSDateFormatter alloc]init];
[formatter setTimeZone:[NSTimeZone localTimeZone]];
[formatter setDateFormat:@"dd/MM/yy"];
NSDate* inpTime = [formatter dateFromString:res];
[dateResult setText:[NSString stringWithFormat:@"%@",inpTime]]; 
```

当我运行时，“inpTime”中的日期始终为“dateInput” - 1。例如：如果“dateInput”为5，则“inpTime”中的日期将为4

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:05:36.613

您需要调整时区。

改变

```
[formatter setTimeZone:[NSTimeZone localTimeZone]]; 
```

到

```
[formatter setTimeZone:[NSTimeZone timeZoneWithName:@"UTC"]]; 
```

这是因为您没有设置时间，因此默认设置为午夜 UTC。但是，当您使用 UTC 以外的时区显示日期时，时间会相应移动。

例如，如果您住在纽约，那么**12/29/2012 00:00:00 UTC**实际上就是**12/28/2012 18:00:00**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:16:47.547

你的代码是完美的，从来没有错误。

尝试 nslogging dateInput.text、monthInput.text 和 yearInput.text...可能从这里你得到无效数据。

# scheme - 当 mit-scheme 用于运行脚本时，如何使输出不那么冗长

> ID：14083400
> 
> 赞同：3
> 
> 时间：2012-12-29T16:01:11.160
> 
> 标签：scheme, sicp, mit-scheme

我发现[了这个问题](https://stackoverflow.com/questions/260685/what-is-the-best-scheme-implementation-for-working-through-sicp)，人们建议使用 mit-scheme 来解决 SICP 中的练习。在做了一些 python 和 ruby​​ 之后，我想知道是否可以以相同的方式使用 mit-scheme 解释器/编译器，如何使用 ruby​​ 或 python？我的意思是简单地在 vim 中编写脚本并`mit-scheme my_script.scm`在终端中运行以查看输出。

*更新*

看起来像`mit-scheme < my_script.scm`我正在寻找的东西，但它的输出太冗长了。理想情况下，我只想在输出中看到我故意发送给`stdout`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:50:37.563

你正在寻找`--silent`国旗。

用法：`mit-scheme --silent < my-script.scm`

# php - Magento：问题类别名称在保存时自动重命名

> ID：14083410
> 
> 赞同：1
> 
> 时间：2012-12-29T16:01:54.463
> 
> 标签：php, zend-framework, magento, magento-1.6

我正在导入具有高级数据流配置文件的产品并在保存类别时面临奇怪的问题，因为我将类别名称传递给我的函数

父类/子类

类别之间的 / 符号会自动创建产品并将其分配给子类别，它按预期工作，但在我的情况下，父类别名称正在以某种方式重命名，我检查了我是否将正确的名称传递给函数......例如 Semiprecios 宝石珠子/石头类型保存为 Semiprecios 宝石珠子/石头类型

名称中缺少最后一个单词

```
protected function _addCategories($categories,$desc='',$discountable,$store) {
    $rootId = $store->getRootCategoryId ();
    if (! $rootId) {
        return array();
    }
    $rootPath = '1/' . $rootId;
    if (empty ( $this->_categoryCache [$store->getId ()] )) {
        $collection = Mage::getModel ( 'catalog/category' )->getCollection ()->setStore($store)->addAttributeToSelect ( 'name' );
        $collection->getSelect ()->where ( "path like '" . $rootPath . "/%'" );

        foreach ( $collection as $cat ) {
            $pathArr = explode ( '/', $cat->getPath () );
            $namePath = '';
            for($i = 2, $l = sizeof ( $pathArr ); $i < $l; $i ++) {
                $name = $collection->getItemById ( $pathArr [$i] )->getName ();
                $namePath .= (empty ( $namePath ) ? '' : '/') . trim ( $name );
            }
            $cat->setNamePath ( $namePath );
        }

        $cache = array();
        foreach ( $collection as $cat ) {
            $cache [strtolower ( $cat->getNamePath () )] = $cat;
            $cat->unsNamePath ();
        }
        $this->_categoryCache [$store->getId ()] = $cache;
    }
    $cache = & $this->_categoryCache [$store->getId ()];

    $catIds = array();
    foreach ( explode ( ',', $categories ) as $categoryPathStr ) {
        $categoryPathStr = preg_replace ( '#s*/s*#', '/', trim ( $categoryPathStr ) );
        if (! empty ( $cache [$categoryPathStr] )) {
            $catIds [] = $cache [$categoryPathStr]->getId ();
            continue;
        }
        $path = $rootPath;
        $namePath = '';
        foreach ( explode ( '/', $categoryPathStr ) as $catName ) {
            $namePath .= (empty ( $namePath ) ? '' : '/') . strtolower ( $catName );
            if (empty ( $cache [$namePath] )) {
                $cat = Mage::getModel('catalog/category')->setStoreId($store->getId())->setPath ( $path )->setName ( $catName )->// comment out the following line if new categories should stay inactive
                setIsActive(1)->setDescription($desc)->setData('discountable',$discountable)->save();
                $cache [$namePath] = $cat;
            }
            $catId = $cache [$namePath]->getId ();
            $path .= '/' . $catId;
        }

        ##Assigning product to child category
        /*$parentId = null;
        $currentcat = Mage::getModel("catalog/category")->load($catId);
        $parentId = $currentcat->getParentId();
        if($parentId){
            $catIds[] = $parentId;
        }
        */
        if ($catId) {
            $catIds [] = $catId;
        }
    }
    return join ( ',', $catIds );
} 
```

以上是我用于创建类别的类别功能......任何人都知道发生了什么......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:25:13.673

它与 Magento 无关，而是与 PHP 和正则表达式有关。

```
$categoryPathStr = preg_replace ( '#s*/s*#', '/', trim ( $categoryPathStr ) ); 
```

该行将“s*/s*”替换为“/”，这就是您删除最后一个 s 的原因。我看不出那个 preg_replace (?) 的真正原因，所以只需删除该行，或将其替换为

```
$categoryPathStr = trim ( $categoryPathStr ); 
```

以便删除前导/结束空格。

# c# - 使用 LINQ 将值一分为二

> ID：14083413
> 
> 赞同：1
> 
> 时间：2012-12-29T16:02:07.333
> 
> 标签：c#, linq

我有一个看起来像这样的文本文件，我在每个“|”处进行拆分。在第三个'|'之间 是我需要分成两个单独的列的两个词。拆分时遇到问题。

```
 Nbr| Address| Name   |Phone|City|State|Zip 
455 |gsgdgsg |fir last|434  |jk  |jh   |0393 
```

我有类似的东西正在做拆分并将输出写入列表。目前我可以进行拆分并很好地选择第一部分，但是当我进行拆分并选择第二部分时，我得到的索引超出了数组错误的范围。

```
var Names = File
            .ReadAllLines(path)
            .Select(a => a.Split(new[] { '|' }, StringSplitOptions.None))
            .Select(a => new {
                phoneNbr = a[0].Trim(),
                Name = a[2].Trim().Split(' ')[0],
                Name2 = a[2].Trim().Split(' ')[1], //gives me error I think becuase it already split it
                addr = a[1].Trim()
            })
              .ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:05:44.923

您可能在第三列中没有两个单词，索引为 2 和一些记录。在使用第二个元素之前，您需要确保在拆分后获得两个元素。

*改变*

```
Name2 = a[2].Trim().Split(' ')[1] 
```

*到*

```
Name2 = a[2].Trim().Split(' ').Length > 1 ? a[2].Trim().Split(' ')[1] : "" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:05:50.163

与其滚动您自己的结构化文本文件解析器，不如使用库。

`Microsoft.VisualBasic.FileIO`命名空间包含类，或者您可以使用流行的[FileHelpers](http://filehelpers.sourceforge.net/)[`TextFileParser`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx)等第三方库。

此类库负责处理解析此类文件时可能出现的许多微妙问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:12:38.590

您可以使用 Regex 拆分 a[2]。

```
Regex.Split(a[2].Trim(), @"\W+")[0];
Regex.Split(a[2].Trim(), @"\W+")[1]; 
```

正则表达式拆分示例 [http://www.dotnetperls.com/regex-split](http://www.dotnetperls.com/regex-split)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:20:24.597

尝试以下语法

```
var Names = (from s in File.ReadAllLines(path).Select(a => a.Split(new[] { '|' }, StringSplitOptions.None))
        let namestr=s[2].Trim().Split(' ')
        select new {
            phoneNbr = s[0].Trim(),
            Name = namestr.Length >=1 ? namestr[0] :"",
            Name2 = namestr.Length >=2 ? namestr[1] :"", 
            addr = s[1].Trim()
        }).ToList(); 
```

它只拆分 name 一次并检查空值。

# python - 在 Python 中创建唯一实体键的好方法

> ID：14083414
> 
> 赞同：0
> 
> 时间：2012-12-29T16:02:22.147
> 
> 标签：python, google-app-engine, key, md5

假设我的数据存储中有一个实体，我知道它可以具有`key_name` 从它的属性组合派生的唯一性：

例子：

```
class Render(db.Model):

    #Math props
    x_size = db.IntegerProperty()
    y_size = db.IntegerProperty()
    center_axis_x = db.FloatProperty()
    center_axis_y = db.FloatProperty()
    center_axis_z = db.FloatProperty()
    iterations = db.IntegerProperty() 
```

我确信没有其他实体具有完全相同的属性，因此到目前为止，为了创建我用户的唯一密钥：

```
render_key=hashlib.md5(str(properties.x_size) +
                                str(properties.y_size) +
                                str(properties.iterations) +
                                str(properties.center_axis_x) +
                                str(properties.center_axis_y) +
                                str(properties.center_axis_z)
                                ).hexdigest() 
```

hexdigest 让我让密钥 url 安全且用户友好，但我相信它也可能需要讨论。

那么问题来了。在上述情况或更改版本中，还有其他更好的方法可以达到相同的结果吗？它不需要向后兼容。因此，即使最终密钥与我的方法生成的密钥不同，这也不是问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:22:11.870

总体而言，您的计划是好的，除了 md5 不能保证您不会发生碰撞（尽管可能性很小）。您可以通过使用 SHA-256 来使冲突更不可能发生，或者只是不对其进行哈希处理，您就可以开始了。

取决于您是否可以接受发生碰撞并且覆盖错误实体的非常罕见的情况。

# javascript - 将鼠标悬停在菜单栏上时隐藏 div

> ID：14083418
> 
> 赞同：1
> 
> 时间：2012-12-29T16:02:39.800
> 
> 标签：javascript, jquery, css

每当我将鼠标悬停在菜单中的第二个按钮上时，就会出现一个“子菜单”。当它出现时，它部分覆盖了 div“容器”中的图像。

子菜单的样式是半透明的，因此 div“容器”内的图像也出现在菜单的背景中，看起来不太好。

我知道简单的解决方案是更改 div 的位置，但图像不会居中，所以这不是一个选项。我想知道是否有可能每当我将鼠标悬停在具有子菜单的按钮上时，当我将鼠标移离菜单时，div“容器”会隐藏并再次出现。将鼠标悬停在第一个主页按钮上时，div“容器”不应隐藏，因为它没有子菜单，并且只要菜单打开，图像就应该保持隐藏状态。是否可以在 javascript 或 jQuery 或 CSS3 中使用？

**HTML 代码：**

```
<div id="menu">
            <ul class="menu" id="tempMenu">
                <li class="Home"><a href="www.google.com">Home</a></li>
                <li class="HOme2"><a id="secondElement" href="www.google.com">Home2</a><div>
                        <ul class="submenu">
                            <li>
                                <a id="one" href="">One</a>
                            </li></br>
                            <li>
                                <a id="two" href="">two</a>
                            </li>
                            <li>
                                <a id="three" href="">three</a>
                            </li>
                            <li>
                                <a id="four" href="">four</a>
                            </li>
                            <li>
                                <a id="five" href="">five</a>
                            </li>
                            <li>
                                <a id="six" href="">six</a>
                            </li>
                            <li>
                                <a id="seven" href="">seven</a>
                            </li>
                            <li>
                                <a id="eight" href="">eight</a>
                            </li>
                        </ul>
                    </div>
                </li>
  </ul>
        </div>

<div id="container">

          <div id="box1" class="box">Image1<img src="images/image1.png"></div>
          <div id="box2" class="box">Image2<img src="images/image2.png"></div>
</div> 
```

**CSS 代码：**

```
ul.menu .submenu{
    display: none;
   position: absolute;
}

ul.menu li:hover .submenu{
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:12:12.513

```
$('.submenu').hover(function() {
    $('#container').hide()
}, function() {
    $('#container').show()
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:59:14.247

`.menu > a`基本上，只要当前菜单项（其中一个元素）包含子菜单 ( ) ，您就想检测悬停事件`.submenu`。

关于什么 ：

```
$('.menu > a').hover(function(){
    if ($(this).find('.submenu').length != 0) {
        $('#container').hide();
    }
}, function(){
    $('#container').show();
}); 
```

此外，您的一些 html 结束标记存在问题，您应该确保它们都以正确的顺序关闭，以防止出现意外故障。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T16:48:12.670

你忘了关闭这个

*   ```
    <li class="HOme2"><a id="secondElement" href="www.google.com">Home2</a><div> 
    ```

    至

    ```
    <li class="HOme2"><a id="secondElement" href="www.google.com">Home2</a></li><div> 
    ```

    对于 Jquery，我认为这会有所帮助

    ```
    $('.submenu').mouseenter(function() {
        $('#container').hide()
    }).mouseleave(function(){
        $('#container').show()
    }); 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T16:11:03.197

首先给那个 div 2 类名称，如-class1，class2

**在 CSS 中：**

```
 .class1{
            display: none;
            position: absolute;
               }
         .class2{
            display : block;
                } 
```

**在 jquery 中：**

```
 //this would track mouse pointer in/out events
         $("#menu").hover( function(event){ $("#div").attr("class","class1"); }, 
                           function(event){ $("#div").attr("class","class1"); } ); 
```

# javascript - 将 Nodejs 与 Typescript 一起使用

> ID：14083427
> 
> 赞同：12
> 
> 时间：2012-12-29T16:03:34.657
> 
> 标签：javascript, node.js, web, webserver, typescript

我想在我的打字稿项目中使用 Nodejs，并从[https://github.com/borisyankov/DefinitelyTyped/tree/master/node下载了 node.d.ts](https://github.com/borisyankov/DefinitelyTyped/tree/master/node)

但是 VisualStudio 在 .d.ts 文件中发现了很多错误。它们基本上都是一样的：

> 错误 2 导出的接口“服务器”从私有模块“事件”扩展接口 C:\Users\lhk\Desktop\typescript-game\strategy go\node\node-0.8.d.ts 236 37 node-0.8.d.ts

所有错误消息都抱怨扩展了私有接口。

我搜索了 SO 并发现了这个问题： [nodejs require inside TypeScript file](https://stackoverflow.com/questions/12742082/nodejs-require-inside-typescript-file)

其中一条评论给出了从 Microsoft 示例下载 node.d.ts 的建议。我浏览了互联网，找到了这篇文章[http://stackful.io/blog/typescript-nodejs-vim-and-linux-oh-my/](http://stackful.io/blog/typescript-nodejs-vim-and-linux-oh-my/)并下载了 node.d.ts 的第二个版本，结果完全相同。

我在哪里可以找到适合 nodejs 和 Typescript 的定义文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-30T02:39:19.843

对于 0.8.1-1 版本的 TypeScript，请使用`node.d.ts`此 github 项目中的最新文件： [https ://github.com/soywiz/typescript-node-definitions](https://github.com/soywiz/typescript-node-definitions)

`exported interface`在我从那里提取最新的定义文件之前，我遇到了同样的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T00:16:20.080

我不完全确定这里到底发生了什么。

我怀疑 Typescript 的 (0.8.1~1) node.js 包的当前版本破坏了一些东西。我也遇到过这个。我调整了 node.d.ts 文件并标记了几件事“导出”而不是“声明”，这让我解决了我的编译问题，但我发现这些函数没有出现在当前范围内。

FWIW，我一直在玩 typescript-require 和 typescript-wrapper 的个人分支（两者都需要一些调整才能与 0.8.1~1 一起工作），我不太确定一切正常应该是这样，所以我不确定问题是我的问题还是当前节点/打字稿特有的问题。

# sql - SQL Server 2012 仅按一列分组

> ID：14083430
> 
> 赞同：0
> 
> 时间：2012-12-29T16:03:50.660
> 
> 标签：sql, sql-server

我只需要按一列分组

SQL Server 2012 查询：

```
SELECT OrderID,Status,DateEdited 
FROM orders 
WHERE Status='Pending' 
GROUP BY OrderID,Status,DateEdited 
```

结果是：

![在此处输入图像描述](../Images/f4c3de12f293d0073e7ba5a58fe93634.png)

如您所见，存在重复的`OrderId`列值。

工作，但它分组，`OrderId,Status,DateEdit`但我需要的是`OrderId`结果将是独一无二的，我可以有类似的东西：

```
SELECT OrderID,Status,DateEdited 
FROM orders 
WHERE Status='Pending' 
GROUP BY OrderID 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:06:23.783

您必须对`status`and使用聚合函数`DateEdited`，以获得每个分组的不同值`ORDERID`。您还可以使用排名函数这样做：

```
WITH CTE
AS
(
   SELECT 
     OrderID,
     Status,
     DateEdited,
     ROW_NUMBER() OVER(PARTITION BY OrderID ORDER BY DateEdited DESC) rownum
   FROM orders 
   WHERE Status='Pending'
)
SELECT 
  OrderID,
  Status,
  DateEdited
FROM CTE
WHERE rownum = 1; 
```

这将为您提供不同`ORDERID`的 s。但是每个分组返回哪个状态和`DateEdited`返回`ORDERID`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:06:04.493

然后你可以这样做，

```
SELECT OrderID,'Pending' as Status,max(DateEdited) 
FROM orders 
WHERE Status='Pending' 
GROUP BY OrderID 
```

如果您不想丢失任何记录，那么您可以使用 GROUP_CONCAT()

```
SELECT OrderID,'Pending' as Status,GROUP_CONCAT(DateEdited) 
FROM orders 
WHERE Status='Pending' 
GROUP BY OrderID 
```

**注意：我不确定你是否在 sqlserver 中使用 GROUP_CONCAT**以防它不存在这样的功能。:)

# wordpress - 获取不在数组中的帖子或在 wordpress 中使用特定的 meta_key

> ID：14083432
> 
> 赞同：0
> 
> 时间：2012-12-29T16:03:59.107
> 
> 标签：wordpress

我有一个问题:) 我有一个 meta_key 'glowna'。这是复选框。如果我选中此项，则意味着该帖子应显示在类别的主页上。我还想显示所有投票数超过 i.ex 的帖子。10\. 我现在有这样的代码：

主页：//帖子等待

```
$array = $wpdb->get_results("select post_id from $table where (user_recc_plus + visitor_recc_plus < 10)"); 
```

在 $array 我只有 ID

然后我有：

```
 $args=array(
'post__not_in' => $array,
'cat'=>$catId,
'order'=>'desc'
); 
```

此外，当我想显示我使用的等待帖子时：

```
$args=array(
'post__in' => $array,
'cat'=>$catId,
'order'=>'desc'
); 
```

它工作得很好。我如何添加条件，如果 post 在 $array 但已检查 meta_key Glowna 它应该显示。对于我创建的等待帖子：

```
$args=array(
'post__in' => $array,
'cat'=>$catId,
'meta_key'=>'glowna',
'meta_value'=>'glowna',
'meta_compare'=>'NOT LIKE',
'order'=>'desc'
); 
```

它似乎正在工作

但是类别主页上的帖子呢？你能帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T17:59:48.180

我是这样设计的：

获取所有没有足够票数的帖子：

```
$posty_poczekalnia = $wpdb->get_results("select post_id from $tabela where (user_recc_plus + visitor_recc_plus < 1)"); 
```

获取所有被选中显示在主页面上的帖子

```
$args = array(
        'cat'=>$katId,
        'meta_key'=>'glowna',
        'meta_value'=>'glowna',
        'meta_compare'=>'LIKE'
    ); 
```

使用差异

```
$poczekalnia = array_diff($poczekalnia, $glowna); 
```

并得到这个帖子

```
$args=array(
'post__not_in' => $poczekalnia,
'cat'=>$katId,
'order'=>'desc',
'paged'=>$paged
); 
```

# iphone - 可执行文件已使用无效权利进行签名

> ID：14083435
> 
> 赞同：1
> 
> 时间：2012-12-29T16:04:10.180
> 
> 标签：iphone, xcode, code-signing, provisioning, provisioning-profile

这是第一次尝试在 iPad 上测试我使用 LiveCode 创建的应用程序。

我确保 IOS 配置门户具有以下临时设置：

```
certificates in Development and Distribution.
Ipad is registered
Apple ID is set up
provisioning in Development and Distribution. 
```

当我尝试将应用程序导入 Xcode 时，会显示以下错误：

```
The executable was signed with invalid entitlements. 
```

我如何将所有这些都放入 xCode 中，以便可以在 iPad 上测试我的 LiveCode 应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T21:59:49.643

您可能使用了分发配置文件而不是开发人员的配置文件。

Apple 网站上逐步描述了开发人员证书和配置文件的创建。我强烈建议您花时间阅读这些步骤，并确保正确执行每个步骤。

Apple 的配置门户还有一个助手，可以帮助您创建开发人员的配置文件。如果你想通过 XCode 在你自己的设备上安装你的应用程序，你需要使用这个开发者的配置文件而不是一个 ad-hoc prodile。

您可以在 LiveCode 的独立应用程序设置窗口中使用开发人员的配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-03T23:47:17.453

这是一个 ENTITLEMENTS 错误，而不是代码符号问题。权利与 iCloud 有关。在 Xcode 4 中，这是在底部的 Summary 页面上完成的。在 Xcode 5 中，它位于顶部称为功能的新页面上。它将被 FIX this Issue Flag 点亮。只需选择您的开发配置文件，您就可以开始了。它确实需要一个带有 iCloud Checked 的 AppID 设置。如果您不使用 iCloud，只需删除构建设置中“权利”字段中的任何内容。

虽然我经常看到“阅读文档”的答案。a.) 我们大多数人都会尝试阅读文档，并且 b.) 它很少包含编码或解决任何问题所需的有用的细粒度细节。干杯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-04T00:01:53.800

权利也可用于游戏中心、存折、应用内购买和地图。所有都设置在名为 Capabilities 的目标选项卡中。

# java - JXMapKit 使用 getGpxTrack() 绘制路线

> ID：14083437
> 
> 赞同：1
> 
> 时间：2012-12-29T16:04:21.307
> 
> 标签：java, map, routes

我正在尝试使用以下源代码在道路上绘制路线：

```
final List<GeoPosition> region = new ArrayList<GeoPosition>();

Painter<JXMapViewer> lineOverlay = new Painter<JXMapViewer>() {

public void paint(Graphics2D g, JXMapViewer map, int w, int h) {
  region.add(new GeoPosition(5.42031,100.34389));
  region.add(new GeoPosition(5.41984,100.33924));
  region.add(new GeoPosition(5.42300,100.33456));

  g = (Graphics2D) g.create();
  //convert from viewport to world bitmap
  Rectangle rect = jXMapKit1.getMainMap().getViewportBounds();
  g.translate(-rect.x, -rect.y);

  //do the drawing
  g.setColor(Color.RED);
  g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
  g.setStroke(new BasicStroke(2));

  int lastX = -1;
  int lastY = -1;
  for (GeoPosition gp : region.getGpxTrack()) 
  {
     //convert geo to world bitmap pixel
     Point2D pt = jXMapKit1.getMainMap().getTileFactory().geoToPixel(gp, jXMapKit1.getMainMap().getZoom());
     if (lastX != -1 && lastY != -1) {
        g.drawLine(lastX, lastY, (int) pt.getX(), (int) pt.getY());
     }
     lastX = (int) pt.getX();
     lastY = (int) pt.getY();
  }
  System.out.println("I am here");
  g.dispose();

   }

   }; 
```

但是，我在 region.getGpxTrack() 行收到错误。我尝试仅使用区域 GeoPosition gp : region，它只在两点之间画一条线。我想要的是一条公路路线。有谁知道我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T03:25:20.243

好的，我做了同样的事情，看看如果你`region.getGpxTrack()`用 `region`我在评论中假设的替换它是否有效。是的，它有效。这是您正在尝试做的完整的工作应用程序：

```
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import java.awt.RenderingHints;
import java.awt.geom.Point2D;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JFrame;

import org.jdesktop.swingx.JXMapKit;
import org.jdesktop.swingx.JXMapKit.DefaultProviders;
import org.jdesktop.swingx.JXMapViewer;
import org.jdesktop.swingx.mapviewer.GeoPosition;
import org.jdesktop.swingx.painter.Painter;

public class Starter {
    public static void main(final String[] args) {    
        final JFrame f = new JFrame();
        f.setSize(500, 300);
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final JXMapKit jXMapKit1 = new JXMapKit();
        jXMapKit1.setDefaultProvider(DefaultProviders.OpenStreetMaps);
        jXMapKit1.setCenterPosition(new GeoPosition(5.41984, 100.33924));
        jXMapKit1.setZoom(3);

        final List<GeoPosition> region = new ArrayList<GeoPosition>();
        region.add(new GeoPosition(5.42031, 100.34389));
        region.add(new GeoPosition(5.41984, 100.33924));
        region.add(new GeoPosition(5.42300, 100.33456));

        final Painter<JXMapViewer> lineOverlay = new Painter<JXMapViewer>() {

            @Override
            public void paint(Graphics2D g, final JXMapViewer map, final int w, final int h) {
                g = (Graphics2D) g.create();
                // convert from viewport to world bitmap
                final Rectangle rect = jXMapKit1.getMainMap().getViewportBounds();
                g.translate(-rect.x, -rect.y);

                // do the drawing
                g.setColor(Color.RED);
                g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g.setStroke(new BasicStroke(2));

                int lastX = -1;
                int lastY = -1;
                for (final GeoPosition gp : region) {
                    // convert geo to world bitmap pixel
                    final Point2D pt = jXMapKit1.getMainMap().getTileFactory().geoToPixel(gp, jXMapKit1.getMainMap().getZoom());
                    if (lastX != -1 && lastY != -1) {
                        g.drawLine(lastX, lastY, (int) pt.getX(), (int) pt.getY());
                    }
                    lastX = (int) pt.getX();
                    lastY = (int) pt.getY();
                }

                g.dispose();

            }

        };

        jXMapKit1.getMainMap().setOverlayPainter(lineOverlay);

        f.setContentPane(jXMapKit1);
        f.setVisible(true);

    }
} 
```

# ruby-on-rails - 如何对用户隐藏某些页面并仅向管理员显示？

> ID：14083442
> 
> 赞同：0
> 
> 时间：2012-12-29T16:04:44.740
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我已经安装了 Activ Admin gem，但不确定它是否有任何帮助。我有一些页面我想隐藏起来，不让匿名用户看到，还有一些页面让登录用户看到。我该怎么做 ？

我确信 RoR 中必须有 ACL gem，但我不确定哪种方法是标准和首选的方法？有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:54:08.930

我不熟悉 Active Admin，但是假设您已经有办法确定用户是否已登录（并且您有办法解决`current_user`），您可以简单地执行以下操作：

### 在您的控制器中（例如，在您的会话助手中）

```
def admin_users_only
  unless current_user.admin? redirect_to "wherever you want to redirect to"
end 
```

### 在同一个控制器中

```
before_filter :admin_users_only, only: [:index, :or, :any, :other] 
```

（当然你的用户模型需要一个管理员属性）

# mysql - 如何在同一个表中对选定查询进行 mysql 更新？

> ID：14083444
> 
> 赞同：-3
> 
> 时间：2012-12-29T16:05:09.840
> 
> 标签：mysql

```
UPDATE suggest 
SET 
`    post_id`="5286" 
where 
  `post_id`  IN 

( SELECT `post_id` FROM `suggest` WHERE `word` LIKE "%word%" ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:14:09.713

这里不需要使用子查询。

```
UPDATE suggest 
SET `post_id`="5286" 
WHERE `word` LIKE "%word%" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:18:50.540

[MySQL 错误 1093 - 无法在 FROM 子句中指定要更新的目标表](https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause)

这是一篇关于此的帖子。

您可以使用此查询来实现此目的。

```
update suggest as a inner join (select post_id from suggest where word like '%word%') as b on a.post_id = b.post_id set a.post_id="5286"; 
```

# android - sqlite（android）中的重音搜索

> ID：14083446
> 
> 赞同：4
> 
> 时间：2012-12-29T16:05:25.087
> 
> 标签：android, sqlite, android-sqlite

我有一列，其中一些元素包含重音字母。例如：格拉姆布

我的要求是，当我搜索“Grambu”时，我也应该在结果中得到“Grambu”。

对于这个要求，我尝试为该特定列使用“COLLATE NOCASE”参数。但这没有用。

当我在网上搜索解决方案时，我发现很多人建议标准化重音字符并基于它创建另一个列作为唯一选项。

这个问题还有其他更简单的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T16:42:18.643

`COLLATE NOCASE`仅适用[于 ASCII 的 26 个大写字符](http://www.sqlite.org/datatype3.html)。

将数据库的语言环境设置为具有重音字符支持 using[`setLocale()`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#setLocale%28java.util.Locale%29)和 use的语言环境`COLLATE LOCALIZED`。

您也可以尝试使用[`COLLATE UNICODE`](http://www.unicode.org/reports/tr10/). 但要注意这个错误：[ICS 中的 SQLite UNICODE 排序被破坏 - 不再区分大小写](http://code.google.com/p/android/issues/detail?id=27053)。

检查[文档](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html)以在 Android 中提及这两个整理器。

另请查看此[在线校对演示工具](http://demo.icu-project.org/icu-bin/locexp?_=en_US&x=col)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T07:03:15.403

[http://www.sqlite.org/lang_expr.html](http://www.sqlite.org/lang_expr.html)

> （一个错误：默认情况下，SQLite 只理解 ASCII 字符的大写/小写。默认情况下，LIKE 运算符对超出 ASCII 范围的 unicode 字符区分大小写。例如，表达式 'a' LIKE 'A' 为 TRUE 但'æ' LIKE 'Æ' 是 FALSE。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-17T09:58:55.777

在 Android sqlite 中`LIKE`，`GLOB`忽略`COLLATE LOCALIZED`和`COLLATE UNICODE`。但是，有一个解决方案，无需向表中添加额外的列。正如@asat 在[此答案](https://stackoverflow.com/a/53535409/6766261)中解释的那样，您可以使用`GLOB`一种模式，该模式将用该字母的所有可用替代品替换每个字母。在 Java 中：

```
public static String addTildeOptions(String searchText) {
    return searchText.toLowerCase()
                     .replaceAll("[aáàäâã]", "\\[aáàäâã\\]")
                     .replaceAll("[eéèëê]", "\\[eéèëê\\]")
                     .replaceAll("[iíìî]", "\\[iíìî\\]")
                     .replaceAll("[oóòöôõ]", "\\[oóòöôõ\\]")
                     .replaceAll("[uúùüû]", "\\[uúùüû\\]")
                     .replace("*", "[*]")
                     .replace("?", "[?]");
} 
```

然后（当然不是字面意义上的这样）：

```
SELECT * from table WHERE lower(column) GLOB "*addTildeOptions(searchText)*" 
```

这样，搜索*Grambu*或*Grambú*的用户将把搜索转换为*Gramb[uúùüû]*，返回两个结果。

重要的是要注意`GLOB`ignores `COLLATE NOCASE`，这就是为什么我在函数和查询中都将所有内容都转换为小写。另请注意`lower()`，sqlite 中的函数不适用于非 ASCII 字符 - 但这些可能是您已经替换的字符！

该函数还将`GLOB`通配符`*`和`?`, 替换为“转义”版本。

# django - Apache、mod_wsgi 和 Django 配置的问题

> ID：14083450
> 
> 赞同：0
> 
> 时间：2012-12-29T16:05:41.177
> 
> 标签：django, apache2, mod-wsgi, bitnami

只需使用 Bitnami DjangoStack 映像设置一个 64 位 ubuntu EC2 实例。

到目前为止，我已经安装了一些 python 依赖项并删除了默认创建的 Project django 应用程序。我用“django-admin.py startproject projectname”创建了一个新应用程序。然后我按照这里的说明进行操作：[http](http://wiki.bitnami.org/Components/Django) ://wiki.bitnami.org/Components/Django ，尝试设置 apache。

这是我的 projectname.conf 文件：

```
Alias /static "/opt/bitnami/apps/django/lib/python2.7/site-packages/django/contrib/admin/static"

<Directory '/opt/bitnami/apps/django/lib/python2.7/site-packages/django/contrib/'>
Order allow,deny
Allow from all
</Directory>

WSGIScriptAlias /URL_mount_point "/opt/bitnami/apps/django/scripts/projectname.wsgi"

<Directory '/opt/bitnami/apps/django/scripts'>
Order allow,deny
Allow from all
</Directory> 
```

这是我的项目名称.wsgi

```
import os, sys
sys.path.append('/opt/bitnami/apps/django/django_projects')
sys.path.append('/opt/bitnami/apps/django/django_projects/projectname')
os.environ['DJANGO_SETTINGS_MODULE'] = 'projectname.settings'

import django.core.handlers.wsgi

application = django.core.handlers.wsgi.WSGIHandler() 
```

这是我的 httpd.conf 的最后三行：

```
Include "/opt/bitnami/apache2/conf/ssi.conf"
Include "/opt/bitnami/apache2/conf/bitnami/httpd.conf"
Include "/opt/bitnami/apps/django/conf/projectname.conf" 
```

完成此操作并重新启动 apache 后，点击 mydomain.com/projectname 仍然会出现 404（Bitnami 登录页面在 mydomain.com 上显示得很好）。

我在这里错过了什么吗？我在 projectname.wsgi 中的路径是否不正确（我没有偏离默认的 Bitnami 目录结构）。还是我在这里缺少一些额外的步骤？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:45:21.197

我将此添加到我的 httpd.conf

```
 WSGIScriptAlias / /opt/bitnami/apps/django/scripts/projectname.wsgi
<Directory '/opt/bitnami/apps/django/django_projects/projectname'>
    Order allow,deny
    Allow from all
</Directory> 
```

这似乎解决了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T23:11:53.120

您应该访问：

```
http://mydomain.com/URL_mount_point 
```

由于您似乎没有显示您的原始配置，很难说这是否是问题或是否是某种错字。

# c# - 使用 HAP 添加样式表

> ID：14083457
> 
> 赞同：1
> 
> 时间：2012-12-29T16:06:21.310
> 
> 标签：c#, .net, html, css, html-agility-pack

我有一个存储为字符串的样式表，我正在尝试使用 Html Agility Pack 添加到已解析的 HtmlDocument 中。我无法设置`style`节点的 InnerText，因为它没有设置器。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:25:11.287

未经测试，但应该给你的想法：

```
// doc is the HtmlDocument
var style = doc.CreateElement("style");
var text = doc.CreateTextNode("some CSS here");
style.AppendChild(text);
doc.DocumentNode.AppendChild(style); // or, AppendChild to any node 
```

# javascript - 根据另一个列表更新选择列表

> ID：14083462
> 
> 赞同：0
> 
> 时间：2012-12-29T16:06:41.473
> 
> 标签：javascript, jquery

我已经在这里找了一段时间了，但我并没有真正找到我需要的东西。

我有一个下拉列表，里面有一些老师。第二个列表应包含他/她教授的课程。

所以，一个小例子：

X先生教数学和生物。Y老师教数学

如果在第一个列表中选择 X，则第二个列表应包含数学和生物学。如果选择 Y，则列表应仅包含数学。

PHP 部分、HTML、CSS 不是问题，它只是关于第二个列表的“刷新/更新”。

```
<select name="lecturer_id" id="lecturer_id">
    <option value="22">X</option>
    <option value="30">Y</option>
</select> 
```

我正在寻找一个非常简单的解决方案，因为我对 javascript 的了解很差。这就是为什么我更喜欢 jQuery 解决方案。

- 更新

数据来自数据库。我的应用程序当前生成以下 HTML： http: [//pastebin.com/9rEWKAkF](http://pastebin.com/9rEWKAkF)

两个列表，lecturer_id 和 coure_id 是根据我的数据库中的信息动态生成的。我要更新的列表是第二个，course_id。我希望这能让它更清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:24:13.477

很简单，附加到第一个选择器更改事件处理程序，它将更新其他选择器。

HTML：

```
<select name="lecturer_id" id="lecturer_id">
    <option value="22">X</option>
    <option value="30">Y</option>
</select>
<select name="discipline" id="discipline">
</select>​​​​​​​​​​​​​​​​​​​​ 
```

JS：

```
var teachers = {
    22: ['math', 'biology'],
    30: ['math']
}
var dis_update = function() {

    var lecturer_id = $('#lecturer_id option:selected').val();
    var dis = $('#discipline').empty();
    for (i in teachers[lecturer_id]) {
        var d_name = teachers[lecturer_id][i];
        dis.append($('<option>').val(d_name).text(d_name));
    }
}
$('#lecturer_id').change(dis_update);
dis_update();​ 
```

[演示](http://jsfiddle.net/oceog/2vgpj/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:25:11.443

好吧，我不知道您将如何获得选择框的数据，但我会给您一些启动代码。我把它编码得尽可能简单，这样你就可以理解了

```
//here is your sample data array
var data = {"X":['maths','bio'], 
        "Y":['maths']};

//the event listener for lecturer selectbox that will listen for selection changes
$('#lecturer_id').change(function(){ 

//gets the value of the lecturer select box
var selecti = $('#lecturer_id >option:selected').text();
      //ensure to empty the other select box for subjects
      $('#teaches').empty();
      var i = 0 ;
      //append the subjects of the lecturer on the other select box
      for(i = 0; i < data[selecti].length; i++){
             //add an option element for every item
         $("#teaches").append('<option>' + data[selecti][i]  +'</option>');
      } 
}); 
```

供您处置的演示 [http://jsfiddle.net/nCA9u/](http://jsfiddle.net/nCA9u/)

# c# - 以另一种形式使用方法中的值

> ID：14083465
> 
> 赞同：1
> 
> 时间：2012-12-29T16:07:02.770
> 
> 标签：c#, windows, desktop

我有以下场景：我制作的一个程序有三种类型的用户帐户：超级用户、管理员和顾问。

登录表单运行良好，通过一种方法，我可以获取用户的类型并打开所述用户的相应主表单。

问题是这样的：用户共享一些表单。但是，我不知道如何让应用程序知道它必须根据用户返回三种主要形式中的哪一种。

问题是：有一种方法可以保留登录表单中的值（用户类型）并在其他表单上使用它？

这是我在数据库中获取类型值的方法：

```
 public string sacartipo()
    {string tipo = "";
       username = usuario.Text;
        obj.Usuario = usuario.Text;
        password = contra.Text;
        obj.Contrasena = contra.Text;
         tipo = obj.Logeo(username, password);

        return tipo; //This is the variable that stores the type of user. 

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:09:25.513

让每个表单的构造函数都接受用户类型，这样每当您显示一个新表单时，您就可以告诉它哪个用户将使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:23:39.053

您可以将用户类型（在用户登录后）存储在会话变量中`Session["role"]=value`，并在您想要的任何地方使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T19:29:37.153

假设 sacartipo() 是 Form1 的一个方法，你想调用它来获取返回值，你在 Form2 中添加以下方法：

```
string GetTipo() {
    var currentContext=SynchronizationContext.Current;
    var tipoLocal=default(string);

    SendOrPostCallback d=
        dummy => {
            using(var x=new Form1())
                tipoLocal=x.sacartipo();
        };

    if(null!=currentContext)
        currentContext.Send(d, null);
    else
        d(null);

    return tipoLocal;
} 
```

在 Form2 的代码中，您调用 GetTipo() 并且您期望做的事情已经完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:24:09.937

您可以将用户存储在枚举中

```
public enum Users { Superuser, Administrator, Consultant } 
```

`Users`并在您的应用程序中拥有一个随处可见的静态类型对象（全局）

```
public Users User; 
```

为静态对象`Login`分配适当的值`User`，例如。

```
MyApplication.User = Users.Consultant; 
```

并在每种形式中检查用户对加载的权限，例如。

```
var adminPageAllowedUsers = new[] {Users.SuperUser, Users.Administrator};
if(admingPageAllowedUsers.Contains(MyApplication.User))
{
    //do the rest
}
else
{
    //redirect user to another form
} 
```

这是我想给你的逻辑，并且代码没有经过测试，所以请原谅可能的错误。

# excel - 使用可变计时器和可变文本在 Excel 中创建启动画面

> ID：14083466
> 
> 赞同：0
> 
> 时间：2012-12-29T16:07:15.500
> 
> 标签：excel, vba, ontime

我有一个用户表单。用户窗体上有一个标签。

在 Userform_Initialize() 事件中，我使用以下代码：

在 x 秒后关闭用户窗体。

在一个模块中，我有

```
sub KillForm()
Unload UserForm1
end sub 
```

现在我想通过单击工作表的按钮打开用户表单，并将标签的字符串 strMessage 和秒 x 传递给用户表单，所以我在模块中创建了一个子

```
Sub ShowMessage(strMessage As String, x As Integer)
UserForm1.Label1.Caption = strMessage
userform1.show
End Sub 
```

并在按钮的 On_Click 事件处调用例程

```
ShowMessage "Hello World.", 3 
```

唉，这行不通。x 在用户窗体上不是 3，始终为 0。

我在 Userform 模块和通用模块之上尝试了 Public x as Integer。没运气。当我在 OnTime 行中将 x 替换为诸如 3 之类的数字时，它会以 strMessage 作为标签标题出现，并在静态时间后消失。但我想用变量 x 使时间动态化。

所以：如何将 x 的值传递给 Userform 并进入例程

```
Application.OnTime Now + TimeSerial(0, 0, x), "KillForm" 
```

谢谢 AG

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:50:41.760

假设在闪屏显示过程中不需要后台运行其他操作，也可以修改`ShowMessage`如下方式：

```
子 ShowMessage（strMessage 作为字符串，intDisplayTime 作为整数）
    将 dblStartTime 调暗为 Double

    UserForm1.Label1.Caption = strMessage
    UserForm1.显示

    dblStartTime = 计时器
    如果 dblStartTime + intDisplayTime >= 86400 那么
        dblStartTime = dblStartTime - 86400
    万一

    而计时器 - dblStartTime < intDisplayTime
        做事件
    文德

    卸载 UserForm1    
结束子

```

# model-view-controller - MVC（在 Sitefinity 中）

> ID：14083467
> 
> 赞同：0
> 
> 时间：2012-12-29T16:07:30.850
> 
> 标签：model-view-controller, sitefinity

在我看来，我有类似的东西：

```
@model  CreatorModel

<form name="myForm" action="/Creator/CreateAction" enctype="multipart/form-data" id="myForm" method="post">           

           <div class="a">
               <h2 class="a">....</h2>
              <div class="b">
                 <br />
                   Select a file for a <input type="file" name="aFile" id="aFile" />
                 <br /><br />
                   Select a file for b<input type="file" name="bFile" id="bFile" />
                 <br /><br />
                 <input type="submit" id="CreateAction" name="CreateAction" value="CreateAction" />       
          </div>

</form> 
```

* * *

但我有一个错误：`File /Creator/CreateAction is not found (CreateAction is an action from CreatorController)`

`<form...>`为了从控制器中查找操作，我可以输入什么作为操作？

当我使用这种语法时：

```
@using (Html.BeginForm("FileUpload", "Board", FormMethod.Post, new { enctype = "multipart/form-data" })) { <input type="file" /> <input type="submit" /> } 
```

我也有一个错误：`A reference is not set to an instance of an object"`

也许有一个糟糕的路由？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T22:49:15.867

在混合模式下（在 webforms 模板上）使用 MVC 小部件时，您需要使用特殊版本的 BeginForm（因为 webforms 只允许页面上的一个表单）。

```
@Html.BeginSitefinityForm() 
```

应该是您用来在小部件中定义表单区域的表单。用它替换常规的，小部件应该按预期工作。

我希望这是有帮助的！

# c# - gridview 和 if 语句

> ID：14083469
> 
> 赞同：2
> 
> 时间：2012-12-29T16:07:45.843
> 
> 标签：c#, if-statement

我有一个gridview 控件，并且一个可见的按钮被设置为false。假设当我在 gridview 上选择特定行时，它会将按钮的可见性设置为 true。

然而现在的问题是，尽管在后面的代码中设置了 if 语句，但按钮仍然保持为 false 可见。

这是后面的代码：

```
protected void GridView1_SelectedIndexChanged(object sender, EventArgs e)
{
    Label certify = (Label)GridView1.SelectedRow.FindControl("certify");
    Label Status = (Label)GridView1.SelectedRow.FindControl("Status");

    if ((certify.ToString() == "True") & (Status.ToString() == "Not Paid"))
    {
        paymentbtn.Visible = true;
    }

} 
```

当我调试程序时，我管理了从 gridview 获取数据。certify 设置为 True，Status 设置为 Not Paid。但是，代码仍然跳过 if 语句..我不知道为什么会这样..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:09:44.550

您需要使用`Text`属性`label`而不是调用标签的 ToString() 来获取值。

*改变*

```
if ((certify.ToString() == "True") & (Status.ToString() == "Not Paid"))
{
    paymentbtn.Visible = true;
} 
```

*到*

```
if ((certify.Text == "True") & (Status.Text  == "Not Paid"))
{
    paymentbtn.Visible = true;
} 
```

# php - 内容未发布到数据库但获得成功消息

> ID：14083471
> 
> 赞同：0
> 
> 时间：2012-12-29T16:08:02.360
> 
> 标签：php, mysql, sql

我似乎在将记录插入数据库时​​遇到问题。我收到了成功消息，但是当我查看数据库中的信息时，所有字段都是木板。我的语法有错误吗？

```
if(isset($_POST['client'])) {
    $id = (int)$id;
    $client_to_insert = mysql_real_escape_string($_POST['client']);
    $contact_to_insert = mysql_real_escape_string($_POST['contact']);
    $title_to_insert =  mysql_real_escape_string($_POST['title']);
    $assigned_to_insert = mysql_real_escape_string($_POST['assigned']);
    $start_date_to_insert = stripslashes($_POST['start_date']);
    $end_date_to_insert = stripslashes($_POST['end_date']);
    $status_to_insert = mysql_real_escape_string($_POST['status']);
    $amount_to_insert = mysql_real_escape_string($_POST['amount']);
    $costs_to_insert = mysql_real_escape_string($_POST['costs']);
    $costs2_to_insert = mysql_real_escape_string($_POST['costs2']);
    $costs_item_to_insert = mysql_real_escape_string($_POST['costs_item']);
    $costs_item2_to_insert = mysql_real_escape_string($_POST['costs_item2']);
    $notes_to_insert = mysql_real_escape_string($_POST['area']);
    $feeA_to_insert = mysql_real_escape_string($_POST['feeA']);
    $feeB_to_insert = mysql_real_escape_string($_POST['feeB']);
    $feeC_to_insert = mysql_real_escape_string($_POST['feeC']);
    $feeD_to_insert = mysql_real_escape_string($_POST['feeD']);
    $feeE_to_insert = mysql_real_escape_string($_POST['feeE']);
    $feeF_to_insert = mysql_real_escape_string($_POST['feeF']);
    $feeG_to_insert = mysql_real_escape_string($_POST['feeG']);
    $feeH_to_insert = mysql_real_escape_string($_POST['feeH']);
    $feeI_to_insert = mysql_real_escape_string($_POST['feeI']);
    $feeK_to_insert = mysql_real_escape_string($_POST['feeK']);
    $feeL_to_insert = mysql_real_escape_string($_POST['feeL']);
    $feeM_to_insert = mysql_real_escape_string($_POST['feeM']);
    $feeN_to_insert = mysql_real_escape_string($_POST['feeN']);
    $contract_to_insert = mysql_real_escape_string($_POST['contract']);
    $outofhouse_to_insert = mysql_real_escape_string($_POST['outofhouse']);
    $vendor_to_insert = mysql_real_escape_string($_POST['vendor']);
    $vendor1_to_insert = mysql_real_escape_string($_POST['vendor1']);
    $billed_to_insert = mysql_real_escape_string($_POST['billed']);
    $billing_need_to_insert = mysql_real_escape_string($_POST['billing_need']);
    $extended_billing_to_insert = mysql_real_escape_string($_POST['extended_billing']);
    $contract_value_to_insert = mysql_real_escape_string($_POST['contract_value']);
    $retainer_value_to_insert = mysql_real_escape_string($_POST['retainer_value']);

    $query = mysql_query("INSERT INTO projects (
    id,
    client,
    contact,
    title,
    assigned,
    start_date,
    end_date,
    status,
    amount,
    costs,
    costs2,
    costs_item,
    costs_item2,
    notes,
    feeA, 
    feeB,
    feeC,
    feeD,
    feeE,
    feeF,
    feeG,
    feeH, 
    feeI, 
    feeK, 
    feeL, 
    feeM, 
    feeN, 
    contract, 
    billed, 
    billing_need, 
    extended_billing, 
    vendor, 
    vendor1, 
    outofhouse, 
    retainer_value, 
    contract_value
    )

    VALUES (
    '$id' ,
    '$client' ,
    '$contact' ,
    '$title' ,
    '$assigned' ,
    '$start_date' , 
    '$end_date' , 
    '$status' , 
    '$amount' , 
    '$costs' , 
    '$costs2' ,
    '$costs_item' ,
    '$costs_item2' , 
    '$notes' , 
    '$feeA' , 
    '$feeB' ,
    '$feeC' ,
    '$feeD' , 
    '$feeE' , 
    '$feeF' , 
    '$feeG' , 
    '$feeH' , 
    '$feeI' , 
    '$feeK' , 
    '$feeL' , 
    '$feeM' , 
    '$feeN' , 
    '$contract' , 
    '$billed' , 
    '$billing_need' , 
    '$extended_billing' , 
    '$vendor' ,
    '$vendor1' ,
    '$outofhouse' , 
    '$retainer_value' , 
    '$contract_value' );");

    if($query) {
        $message = "Success your Project has been added!";

    }else{
        $message = "An error occurred while adding this Project";
    }

}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:22:43.713

您的 SQL 看起来不错 [就上下文允许的情况而言]（这就是为什么每次运行时都会看到一个新行的原因）但是，我建议您在运行查询之前死掉并首先输出它。所以你可以看看你可能做错了什么。

```
$sql   = "INSERT INTO projects (...";
var_dump($sql);
die();

$query = mysql_query($sql); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:27:36.483

正如@hakre 提到的，sql 看起来不错，但你可以使用

```
mysql_query("INSERT...") or die(mysql_error()); 
```

检查数据库中是否存在任何问题，例如缺少或错误命名的字段

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:59:33.857

在类似情况下对我来说总是有效的是回显 sql 查询并将其直接复制并粘贴到数据库中，然后查看是否有任何问题。此外，可能值得检查`mysql_affected_rows($sql)`.

# php - 选择多个表 MySQL 并检索不同的数据

> ID：14083473
> 
> 赞同：2
> 
> 时间：2012-12-29T16:08:27.070
> 
> 标签：php, sql

我有 4 个表需要从中提取数据。我需要统计有多少人参加了单个活动，并查看是否有用户申请了活动。

这些是我的表设置：

```
TABLE: users
+----+----------+-------+--------+-------+
| id | username | level | class  | guild |
+----+----------+-------+--------+-------+
| 1  | example1 | 100   | Hunter | blah  |
| 2  | example2 | 105   | Mage   | blah2 |
| 3  | example3 | 102   | Healer | blah  |
+----+----------+-------+--------+-------+
ID is primary

TABLE: event_randoms
+----+----------+-------+--------+----------+----------+
| id | username | level | class  | apped_by | event_id |
+----+----------+-------+--------+----------+----------+
| 1  | random1  |  153  | Hunter |    3     |    3     |
| 2  | random2  |  158  | Healer |    3     |    1     |
| 3  | random3  |  167  | Warrior|    1     |    3     |
+----+----------+-------+--------+----------+----------+
ID is primary
apped_by should be foreign key to users.id
event_id should be foreign key to events.id

TABLE: events
+----+------------+------------+-----------+-----------+-----------+
| id | event_name | event_date | initiator | min_level | max_level |
+----+------------+------------+-----------+-----------+-----------+
| 1  |   event1   |    date1   |     1     |    100    |     120   |
| 2  |   event2   |    date2   |     1     |    121    |     135   |
| 3  |   event3   |    date3   |     1     |    100    |     120   |
| 4  |   event4   |    date4   |     1     |    150    |     200   |
+----+------------+------------+-----------+-----------+-----------+
ID is primary

TABLE: event_apps
+----+----------+--------------+
| id | event_id | applicant_id |
+----+----------+--------------+
| 1  |    3     |      2       |
| 2  |    4     |      2       |
| 3  |    3     |      1       |
| 4  |    1     |      3       |
+----+----------+--------------+
ID is primary
event_id should be foreign key to events.id
applicant_id should be foreign key to users.id 
```

我将是第一个承认我对此很陌生的人。几天前我刚刚学会了如何使用 MySQL。我可以从一张桌子上拿东西，但我不确定如何从多张桌子上拿东西。

这是我试过的 SQL 查询

```
SELECT DD_events.id, event_id, applicant_id, guild, level, class, DD_users.id
      FROM DD_events, DD_event_apps, DD_users
      WHERE DD_event_apps.event_id = DD_events.id
      AND DD_event_apps.applicant_id = DD_users.id 
```

并试图 print_r 一个数组，但该数组变为空。

所以有几个问题与此有关： 1：我如何计算并显示为一个数字有多少人（用户和随机数）注册了一个事件？例如：事件 3 应该总共有 4 个（2 个用户和 2 个随机数）

2：我如何查看某个特定的人是否已为某项活动签名并根据他们是否已签名显示文本？例如：用户 1 已为事件 3 注册，因此它是“已注册”，但未注册的用户 2 将显示“未注册”

3：我想在 2 个表格中显示谁为特定事件签名的信息，1 个用于用户，另一个用于随机数。例如：事件 3 将在 users 表下有 2 个用户信息（用户名、公会、类、级别），然后在随机表中有 2 个随机用户信息（名称、类、级别、应用此人的用户）。

即使您可以回答 1 部分，我们也感谢您提供任何和所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:19:38.983

我认为这将是您的基本查询：

```
SELECT
    event.id,
    app.applicant_id,
    usr.guild,
    usr.level,
    usr.class,
    usr.id AS Userid
FROM
    DD_events event
JOIN
    DD_event_apps app
    ON  (event.id = app.event_id)
LEFT JOIN
    DD_users usr
    ON  (app.user_id = usr.id) 
```

您可以对此进行修改以聚合它，如下所示：

```
SELECT
    event.id,
    COUNT(app.applicant_id) AS ApplicantCount,
    COUNT(DISTINCT usr.guild) AS UniqueGuilds,
    COUNT(DISTINCT usr.level) AS UniqueLevels,
    COUNT(DISTINCT usr.class) AS UniqueClasses,
    COUNT(DISTINCT usr.id) AS UniqueUsers
FROM
    DD_events event
JOIN
    DD_event_apps app
    ON  (event.id = app.event_id)
LEFT JOIN
    DD_users usr
    ON  (app.user_id = usr.id)
GROUP BY
    event.id 
```

我可以为您编写这些脚本，但我认为这为您继续提供了一个很好的起点。当您试图获得您正在寻找的结果时，您会发现 T-SQL 相当简单。希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T14:20:58.307

```
<?php $query = "SELECT count(*) AS numbuh FROM DD_event_apps WHERE event_id = {$row['id']}";
try
{
    // These two statements run the query against your database table.
    $stmt = $db->prepare($query);
    $stmt->execute();
}
catch(PDOException $ex)
{
    // Note: On a production website, you should not output $ex->getMessage().
    // It may provide an attacker with helpful information about your code. 
    die("Failed to run query: " . $ex->getMessage());
}
echo($query);
// Finally, we can retrieve all of the found rows into an array using fetchAll
$count = $stmt->fetchAll();
echo($count['numbuh']); ?> 
```

# hardware - 在verilog中增加一个计数器变量：组合或顺序

> ID：14083475
> 
> 赞同：4
> 
> 时间：2012-12-29T16:08:34.200
> 
> 标签：hardware, verilog, fpga, sequential

我正在为数据路径电路实现 FSM 控制器。控制器在内部增加一个计数器。当我模拟下面的程序时，计数器从未更新。

```
reg[3:0] counter;

//incrementing counter in combinational block
counter = counter + 4'b1; 
```

但是，在创建额外变量 counter_next 时，如[Verilog 最佳实践 - 增加变量](https://stackoverflow.com/questions/8015551/verilog-best-practice-incrementing-a-variable)并仅在顺序块中增加计数器中所述，计数器会增加。

```
reg[3:0] counter, counter_next;

//sequential block
always @(posedge clk) 
   counter <= counter_next;

//combinational block
counter_next = counter + 4'b1; 
```

为什么在前一种情况下计数器不增加？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T21:12:25.003

好的。我假设您在第一个示例中留下了一些代码，因为它甚至不应该编译。但是，我想无论如何我都可以为您阐明这个问题。

在一个看起来像这样的块中：

```
always @(*) begin // or always @(counter)
    counter = counter + 4'b1;
end 
```

有两个问题。

1) 计数器从未初始化。所有 'reg' 类型的变量在仿真开始时都是 X，所以在 X 上加 1 就是 X。

2）这被认为是组合循环。该块对“计数器”的变化很敏感，因此即使假设“计数器”被初始化为 0，模拟器也会永远循环更新“计数器”并且模拟时间永远不会提前。IE

```
always block executes -> counter = 1
counter has changed
always block executes -> counter = 2
counter has changed
and so on... 
```

如果你在其中放置一个 $display 语句，你会看到这个循环发生了。否则只会显示模拟器挂起并且不会写入任何波形。

第二个例子有效的原因是你有一个触发器打破了组合循环。在每个时钟边沿，“counter”都会更新为“counter_next”的当前值。然后组合块执行一次（并且仅执行一次）以计算新版本的“counter_next”。

为了完整性，您仍然缺少通过重置子句或初始语句对“计数器”进行初始化。

```
reg [3:0] counter;
reg [3:0] counter_next;

always @(*) begin
   counter_next = counter + 1;
end

always @(posedge clk or negedge rst_l) begin
   if (!rst_l)
      counter <= 4'b0;
   else
      counter <= counter_next;
end 
```

# java - 访问控制允许来源

> ID：14083481
> 
> 赞同：0
> 
> 时间：2012-12-29T16:09:28.857
> 
> 标签：java, jquery, cross-domain

您好我正在开发一个使用 REST Web 服务作为服务器端的 Web 应用程序。当我从客户端调用 rest web 服务时，它给了我以下错误。服务在 uder 下运行`http://localhost:8010/service`，客户端在`http://localhost:8020/client`. 我已经在码头部署了这个。

```
XMLHttpRequest cannot load http://localhost:8010/Service/rest/employee/basicupdate. Origin http://localhost:8020 is not allowed by Access-Control-Allow-Origin. 
```

下面我已经包括了我的休息方法

```
@POST
@Path("/basicupdate")
@Consumes(MediaType.APPLICATION_FORM_URLENCODED)
@Produces({MediaType.APPLICATION_XML, MediaType.APPLICATION_JSON})
@Context 
public String isValidLogin(@FormParam("employeeId") int employeeId, @FormParam("firstName") String firstName, @FormParam("lastName") String lastName, @FormParam("gender") String gender, @FormParam("dob") String dob ) throws JsonGenerationException, JsonMappingException, IOException{
    Response response = new Response();
    String responseString = "";
    try {

        //Application logic

        response.setCode(MessageCode.SUCCESS);
        response.setMessage("Successfully Updated");

    } catch (CustomException e) {
        response.setCode(MessageCode.ERROR);
        response.setMessage(e.getMessage());
        e.printStackTrace();
    } catch (Exception e) {
        response.setCode(MessageCode.ERROR);
        response.setMessage(e.getMessage());
        e.printStackTrace();
    }finally{
        responseString = mapper.writeValueAsString(response);
    }   
    return responseString;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:12:55.290

```
<web-app>
 <filter>
   <filter-name>cross-origin</filter-name>
   <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class>
   <init-param>
       <param-name>allowedOrigins</param-name>
       <param-value>*</param-value>
   </init-param>
   <init-param>
       <param-name>allowedMethods</param-name>
       <param-value>*</param-value>
   </init-param>
   <init-param>
       <param-name>allowedHeaders</param-name>
       <param-value>*</param-value>
   </init-param>
 </filter>
 <filter-mapping>
     <filter-name>cross-origin</filter-name>
     <url-pattern>/*</url-pattern>
 </filter-mapping>
</web-app> 
```

# android - android自定义适配器过滤器不适用于自定义列表项

> ID：14083492
> 
> 赞同：0
> 
> 时间：2012-12-29T16:10:42.073
> 
> 标签：android

我一直在尝试，但我无法找出问题所在。就我而言，我得到了几个充满数据的“模块”。可以使用 EditText 过滤列表，但它不会在我的自定义适配器中返回正确的行 ID，即使它是相同的（除了对象不同）。

这是我的 2 个文件，在 RecordsListAdapter.java 中过滤器正常工作，在 ContactsListAdapter.java 中它返回错误的 rowID。

希望你能帮帮我！

-- 编辑 -- 我认为问题在于返回的 rowID，它不返回“原始”rowID，它返回“过滤”的 rowID，因此在两种情况下点击第一行都会返回 1，但过滤时不应该.

```
package nl.cuse.crm.adapters;

import java.util.ArrayList;

import nl.cuse.crm.objects.lists.RecordsListItem;
import android.R;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Filter;
import android.widget.TextView;

public class RecordsListAdapter extends ArrayAdapter<RecordsListItem> {
    private ArrayList<RecordsListItem> original;
    private ArrayList<RecordsListItem> filtered;
    private ArrayList<RecordsListItem> fulllist;
    private Filter filter;
    int resource;

    public RecordsListAdapter(Context context, int textViewResourceId,
            ArrayList<RecordsListItem> items) {
        super(context, textViewResourceId, items);
        this.original = items;
        this.fulllist = new ArrayList<RecordsListItem>(items);
        this.filtered = new ArrayList<RecordsListItem>(items);
        resource = textViewResourceId;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        View v = convertView;

        if (v == null) {
            LayoutInflater inflater = (LayoutInflater) getContext()
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = inflater.inflate(R.layout.simple_list_item_1, null);
        }

        RecordsListItem m = original.get(position);

        if (m != null) {

            TextView tt = (TextView) v.findViewById(R.id.text1);

            tt.setText(m.get_name());
        } else {
            System.out.println("m is null");
        }

        return v;

    }

    @Override
    public Filter getFilter() {
        if (filter == null)
            filter = new CustomFilter();

        return filter;
    }

    private class CustomFilter extends Filter {
        @Override
        protected FilterResults performFiltering(CharSequence constraint) {
            System.out.println("Called it: " + constraint);
            FilterResults results = new FilterResults();
            String prefix = constraint.toString().toLowerCase();

            if ((prefix == null) || (prefix.length() == 0)) {
                ArrayList<RecordsListItem> list = new ArrayList<RecordsListItem>(
                        fulllist);
                results.values = list;
                results.count = list.size();
            } else {
                final ArrayList<RecordsListItem> list = new ArrayList<RecordsListItem>(
                        fulllist);
                final ArrayList<RecordsListItem> nlist = new ArrayList<RecordsListItem>();
                int count = list.size();

                for (int i = 0; i < count; i++) {
                    final RecordsListItem pkmn = list.get(i);
                    final String value = pkmn.get_name().toLowerCase();

                    if (value.contains(prefix)) {
                        nlist.add(pkmn);
                    }
                }
                results.values = nlist;
                results.count = nlist.size();
            }
            return results;
        }

        @SuppressWarnings("unchecked")
        @Override
        protected void publishResults(CharSequence constraint,
                FilterResults results) {
            filtered = (ArrayList<RecordsListItem>) results.values;

            clear();
            int count = filtered.size();
            for (int i = 0; i < count; i++) {
                RecordsListItem pkmn = filtered.get(i);
                add(pkmn);
            }
        }

    }

} 
```

* * *

```
package nl.cuse.crm.adapters;

import java.util.ArrayList;

import nl.cuse.crm.R;
import nl.cuse.crm.objects.lists.ContactListItem;
import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Filter;
import android.widget.TextView;

public class ContactListAdapter extends ArrayAdapter<ContactListItem> {
    private ArrayList<ContactListItem> original;
    private ArrayList<ContactListItem> filtered;
    private ArrayList<ContactListItem> fulllist;
    private Filter filter;
    int resource;

    public ContactListAdapter(Context context, int textViewResourceId,
            ArrayList<ContactListItem> items) {
        super(context, textViewResourceId, items);
        this.original = items;
        this.fulllist = new ArrayList<ContactListItem>(items);
        this.filtered = new ArrayList<ContactListItem>(items);
        resource = textViewResourceId;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        View v = convertView;

        if (v == null) {
            LayoutInflater inflater = (LayoutInflater) getContext()
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = inflater.inflate(R.layout.custom_list_item_contacts, null);
        }

        ContactListItem m = original.get(position);

        if (m != null) {

            TextView tt = (TextView) v.findViewById(R.id.rd_text1);
            TextView tt2 = (TextView) v.findViewById(R.id.rd_text2);

            if (tt != null) {
                tt.setText(m.get_firstname() + " " + m.get_lastname());
            }
            if (tt2 != null) {
                tt2.setText(m.get_title());
            }
        }

        return v;

    }

    @Override
    public Filter getFilter() {
        if (filter == null)
            filter = new CustomFilter();

        return filter;
    }

    private class CustomFilter extends Filter {
        @Override
        protected FilterResults performFiltering(CharSequence constraint) {
            System.out.println("Called it: " + constraint);
            FilterResults results = new FilterResults();
            String prefix = constraint.toString().toLowerCase();

            if ((prefix == null) || (prefix.length() == 0)) {
                ArrayList<ContactListItem> list = new ArrayList<ContactListItem>(
                        fulllist);
                results.values = list;
                results.count = list.size();
            } else {
                final ArrayList<ContactListItem> list = new ArrayList<ContactListItem>(
                        fulllist);
                final ArrayList<ContactListItem> nlist = new ArrayList<ContactListItem>();
                int count = list.size();

                for (int i = 0; i < count; i++) {
                    final ContactListItem pkmn = list.get(i);
                    final String value = pkmn.get_firstname().toLowerCase()
                            + "" + pkmn.get_lastname().toLowerCase();

                    if (value.contains(prefix)) {
                        nlist.add(pkmn);
                    }
                }
                results.values = nlist;
                results.count = nlist.size();
            }
            return results;
        }

        @SuppressWarnings("unchecked")
        @Override
        protected void publishResults(CharSequence constraint,
                FilterResults results) {
            filtered = (ArrayList<ContactListItem>) results.values;

            clear();
            int count = filtered.size();
            for (int i = 0; i < count; i++) {
                ContactListItem pkmn = filtered.get(i);
                add(pkmn);
            }
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T13:11:59.063

我刚刚发现我做错了什么，并修复了它。我会为其他有同样问题的人解释。过滤后，列表会获得新的索引，因此列表中的第一个始终是第 1 行。我的侦听器是用 ArrayList.get(rowID) 编写的，在过滤时它不起作用，因为 rowID 被更改。我为解决该问题所做的是制作 ArrayAdapter 的副本并过滤该副本，这显然用过滤器更改了列表索引

# php - Drupal 提要 Excel 错误

> ID：14083493
> 
> 赞同：1
> 
> 时间：2012-12-29T16:10:58.793
> 
> 标签：php, drupal, drupal-modules, drupal-feeds

使用 feed excel 模块时出现此错误：

致命错误：在第 56 行的 modules/feeds_excel/feeds_excel.module 中的非对象上调用成员函数 getConfig()

```
function feeds_excel_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'feeds_ui_mapping_form') {
    $config = $form['#importer']->getConfig(); //line 56
    if ($config['parser']['plugin_key'] == 'ExcelParser') { 
```

有什么建议么？

# c# - WP8 绑定不更新

> ID：14083497
> 
> 赞同：0
> 
> 时间：2012-12-29T16:11:34.650
> 
> 标签：c#, .net, windows-phone-8

我正在尝试创建一个从网站获取数据并显示它们的 WP8 应用程序。我选择了全景模板，Visual Studio 创建了一些默认代码。

我想要做的是，如果我更改文本绑定到的变量，文本块会自动更新。但是调用 changeDate() 不会改变 UI。文本框仍然显示“dd.mm.yyyy”。

```
MainPage.xaml:
<phone:LongListSelector.ListHeaderTemplate>
  <DataTemplate>
    <Grid Margin="12,0,0,38">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
      </Grid.RowDefinitions>
      <TextBlock
          Text="{Binding Date}"
          Style="{StaticResource PanoramaItemHeaderTextStyle}"
          Grid.Row="0">
        <TextBlock.DataContext>
          <ViewModels:MainViewModel/>
        </TextBlock.DataContext>
      </TextBlock>
    </Grid>
  </DataTemplate>
</phone:LongListSelector.ListHeaderTemplate> 
```

.

```
MainViewModel.cs:
public class MainViewModel : INotifyPropertyChanged
{
    [...]

    private string _date = "dd.mm.yyyy";
    public string Date
    {
        get
        {
            return _date;
        }
        set
        {
            if (value != _date)
            {
                _date = value;
                NotifyPropertyChanged("Date");
            }
        }
    }

    //public void changeDate()
    //{
    //    Date = "fu";
    //    App.ViewModel.Date = "bar";
    //}

**UPDATE 2**
    public bool IsDataLoaded
    {
        get;
        private set;
    }

    public void LoadData()
    {
        System.Net.WebClient wc = new System.Net.WebClient();
        wc.DownloadStringCompleted += wc_DownloadStringCompleted;
        wc.DownloadStringAsync(new Uri("somelink"));
    }

    private void wc_DownloadStringCompleted(object sender, System.Net.DownloadStringCompletedEventArgs e)
    {
        string s = FilterData(e.Result);
    }

    private string FilterData(string s)
    {
        string[] split = System.Text.RegularExpressions.Regex.Split(s, "<tbody>");
        s = split[1];
        split = System.Text.RegularExpressions.Regex.Split(s, "</tbody>");
        s = split[0];
        split = System.Text.RegularExpressions.Regex.Split(s, "\r\n");

        foreach(string str in split)
        {

            if (str.Contains("class=\"xl24\""))
            {
                App.ViewModel.Date = "somedate";
            }
        }

        return s;
    }
**END UPDATE 2**

[...]

    private void NotifyPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (null != handler)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

**更新 1**

```
MainPage.xaml.cs:
public MainPage()
{
    InitializeComponent();

    DataContext = App.ViewModel;
}

**UPDATE 2**
protected override void OnNavigatedTo(NavigationEventArgs e)
{
    if (!App.ViewModel.IsDataLoaded)
    {
        App.ViewModel.LoadData();
    }
}
**END UPDATE 2**

[...] 
```

.

```
App.xaml.cs:
private static MainViewModel viewModel = null;

public static MainViewModel ViewModel
{
    get
    {
        if (viewModel == null)
            viewModel = new MainViewModel();

        return viewModel;
    }
}
[...] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-24T14:41:40.907

我认为正在发生的是您的**NotifyPropertyChanged**是从某个工作线程调用的，这可能导致从同一个工作线程调用**Date getter。**如果 UI 元素从工作线程（而不是从主 UI 线程）调用数据获取器，则操作以“**无效的跨线程访问**”结束。如果是这样，您应该从主线程进行**处理程序调用。**例如：

```
private void NotifyPropertyChanged(String propertyName)
{
    PropertyChangedEventHandler handler = PropertyChanged;
    if (null != handler)
    {
        Dispatcher dsp = Deployment.Current.Dispatcher;
        dsp.BeginInvoke(() => { 
            handler(this, new PropertyChangedEventArgs(propertyName));
        });
    }
} 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:22:08.720

```
<TextBlock.DataContext>
    <ViewModels:MainViewModel/>
</TextBlock.DataContext> 
```

这将创建一个新的 MainViewModel 对象，您不会更新此对象，而是更新您存储在 App 对象中的对象。

解决方法：将View的数据上下文设置为App.ViewModel对象（无需设置TextBlock的数据上下文）

额外：请不要使用此代码：

```
public void changeDate()
{
    Date = "fu";
    App.ViewModel.Date = "bar";
} 
```

现在你的 ViewModel 知道了这个 App。只需使用：

```
public void changeDate()
{
    Date = "fu";
} 
```

# c - putchar() 和 printf() 函数的交错

> ID：14083502
> 
> 赞同：0
> 
> 时间：2012-12-29T16:12:01.897
> 
> 标签：c

这是 K&R 中给出的声明 printf() 和 putchar() 可以交错。如果它是真的那么为什么下面的代码没有给出所需的输出： -

```
#include"stdio.h"
void main()
{
    char c,d;
    printf("Enter the first character\n");
    scanf("%c",&c);
    printf("%c\n",c);
    printf("Enter the second character\n");
    d=getchar();
    putchar(d);
    printf("\n");
} 
```

每当我执行这个程序时，输出如下： -

```
输入第一个字符
一种
一种
输入第二个字符

```

这是输出。如果我将 printf() 替换为 putchar() 并将 scanf() 替换为 getchar()，也会发生这种情况。为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:16:37.810

第一个将按下的结果`scanf`留在输入缓冲区中，因此您的第二个将获取它而不是从用户那里获取另一个字符。`\n``Return``getchar()``\n`

如果你想跳过那个换行符，你可以指示`scanf`“吃”它：

```
scanf("%c\n",&c); 
```

或直接调用“吃掉它” `getchar()`：

```
scanf("%c",&c);
getchar(); 
```

（请注意，这些并不完全相同，因为第二个片段会吃掉缓冲区中碰巧出现的任何字符，而第一个片段只有在它是 a 时才会删除它`\n`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-24T09:27:51.320

您可以像这样更正您的代码：

```
#include <stdio.h>

int main() {
    char c, d;
    printf("Enter the first character\n");
    scanf("%c\n", &c);    // Ask scanf to read newline and skip
    printf("%c\n", c);

    printf("Enter the second character\n");
    d = getchar();
    putchar(d);
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:16:23.143

你得到了两个 a，因为你输入了一个回显到控制台的 a，然后你把它打印出来。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-29T16:16:17.857

使用前刷新标准输入`getchar(`）..

在涡轮增压中，使用`fflush()`..

在 gcc 中，使用`__fpurge(stdin)`..（这在`<stdio_ext.h>`标题中可用）..

在扫描任何内容之前刷新标准输入将解决您的问题..

# java - Java：zeromq，尝试在 MT 服务器中设置响应超时

> ID：14083506
> 
> 赞同：0
> 
> 时间：2012-12-29T16:12:21.850
> 
> 标签：java, timeout, zeromq

我使用 ZeroMQ 到客户端/服务器应用程序，现在在我的 MT 服务器中我尝试设置超时，我尝试在服务器上设置：

```
socket.setReceiveTimeOut(2000);
socket.setSendTimeOut(2000); 
```

没有运气，我如何设置响应超时。

这是我的多线程服务器代码，取自 mt 服务器的 zeromq 示例：

```
/*
 *  Multithreaded Hello World server in Java
 *
 *  @author Vadim Shalts
 *  @email vshalts@gmail.com
 *
 */

import org.zeromq.ZMQ;
import org.zeromq.ZMQQueue;

class mtserver {
   static void main(String[] args) {

      final ZMQ.Context context = ZMQ.context(1);

      ZMQ.Socket clients = context.socket(ZMQ.ROUTER);
      clients.bind ("tcp://*:5555");

      ZMQ.Socket workers = context.socket(ZMQ.DEALER);
      workers.bind ("inproc://workers");

      for(int thread_nbr = 0; thread_nbr < 5; thread_nbr++) {
         Thread worker_routine = new Thread() {

            @Override
            public void run() {
               ZMQ.Socket socket = context.socket(ZMQ.REP);
               socket.connect ("inproc://workers");

               while (true) {

                  //  Wait for next request from client (C string)
                  byte[] request = socket.recv (0);
                  System.out.println ("Received request: ["+new String(request,0,request.length-1)+"]");

                  //  Do some 'work'
                  try {
                     Thread.sleep (1000);
                  } catch(InterruptedException e) {
                     e.printStackTrace();
                  }

                  //  Send reply back to client (C string)
                  byte[] reply = "World ".getBytes();
                  reply[reply.length-1] = 0; //Sets the last byte of the reply to 0
                  socket.send(reply, 0);
               }
            }
         };
         worker_routine.start();
      }
      //  Connect work threads to client threads via a queue
      ZMQQueue zMQQueue = new ZMQQueue(context,clients, workers);
      zMQQueue.run();

      //  We never get here but clean up anyhow
      clients.close();
      workers.close();
      context.term();
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-28T08:56:51.607

为什么你需要在服务器上超时？

在客户端设置超时的自然位置。

*socket.setReceiveTimeOut(int 毫秒);* 在客户端工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T00:37:53.487

为什么需要超时？原始示例不使用它。

# vba - 对象不支持自定义类上的此属性或方法错误

> ID：14083510
> 
> 赞同：1
> 
> 时间：2012-12-29T16:12:43.363
> 
> 标签：vba, outlook

我仍然很难解决这个问题。我正在使用自定义类模块：TimeFrame 和 TimeSheet。以下是缩短版本：

```
_________________________
'TIMEFRAME CLASS MODULE
'This class records Military Time, but allows
'you to also display it in Civilian Time
Private pHours As Integer
Private pMinutes As Integer
Private pTotalMinutes As Integer

Public Property Get hours() As Integer
  hours = pHours
End Property
Public Property Let hours(Value As Integer)
  If Value >= 1 And Value <= 24 Then
     pHours = Value
  Else
     Err.Raise 9009, , "Hours Value [" & CStr(Value) & "] is not valid."
  End If
End Property
Public Property Get minutes() As Integer
  minutes = pMinutes
End Property
Public Property Let minutes(Value As Integer)
  If Value >= 0 And Value <= 59 Then
    pMinutes = Value
  Else
    Err.Raise 9010, , "Minutes Value [" & CStr(Value) & "] is not valid."
  End If
End Property

Public Property Let Initialize(str As String)
  'This property expects a string formatted like: 08:30
  Dim vhours As String
  Dim vminutes As String
  Dim arrTime() As String

  If InStr(str, Me.Delimiter) Then
    arrTime = Split(str, Me.Delimiter)
    vhours = Trim(arrTime(0))
    vminutes = Trim(arrTime(1))
    If IsNumeric(vhours) Then
       pHours = CInt(vhours)
    End If
    If IsNumeric(vminutes) Then
       pMinutes = CInt(vminutes)
    End If
  Else
    'Set to defaults
    pHours = 0
    pMinutes = 0
  End If
End Property
...

_____________________________
'TIMESHEET CLASS MODULE
Private pEmployeeID As Integer
Private pStartDate As Date
Private pEndDate As Date
Private pMonStart As TimeFrame
Private pMonEnd As TimeFrame
Private pMonBreak As Double
Private pTuesStart As TimeFrame
Private pTuesEnd As TimeFrame
Private pTuesBreak As Double
Private pWedStart As TimeFrame
Private pWedEnd As TimeFrame
Private pWedBreak As Double
Private pThursStart As TimeFrame
Private pThursEnd As TimeFrame
Private pThursBreak As Double
Private pFriStart As TimeFrame
Private pFriEnd As TimeFrame
Private pFriBreak As Double
Public Property Get EmployeeID() As Integer
    EmployeeID = pEmployeeID
End Property
Public Property Let EmployeeID(Value As Integer)
    If Value > 0 Then
           pEmployeeID = Value
    Else
         MsgBox "Employee ID " & Value & " is an incorrect value." & vbCrLf & "Employee ID must be a positive integer"
    End If

End Property
Public Property Get StartDate() As Date
  StartDate = pStartDate
End Property
Public Property Let StartDate(Value As Date)
  pStartDate = Value
End Property
Public Property Get EndDate() As Date
  EndDate = pEndDate
End Property
Public Property Let EndDate(Value As Date)
  pEndDate = Value
End Property
Public Property Get MondayStart() As TimeFrame
  Set MondayStart = pMonStart
End Property
Public Property Set MondayStart(ByRef Value As TimeFrame)
  Set pMonStart = Value
End Property
Public Property Get MondayEnd() As TimeFrame
  Set MondayEnd = pMonStart
End Property
Public Property Set MondayEnd(ByRef Value As TimeFrame)
  Set pMonEnd = Value
End Property
Public Property Get MondayBreak() As Double
  MondayBreak = pMonBreak
End Property
Public Property Let MondayBreak(Value As Double)
  pMonBreak = Value
End Property
Public Property Get TuesdayStart() As TimeFrame
  Set TuesdayStart = pTuesStart
End Property
Public Property Set TuesdayStart(ByRef Value As TimeFrame)
  Set pTuesStart = Value
End Property
Public Property Get TuesdayEnd() As TimeFrame
   Set TuesdayEnd = pTuesStart
End Property
Public Property Set TuesdayEnd(ByRef Value As TimeFrame)
   Set pTuesEnd = Value
End Property
Public Property Get TuesdayBreak() As Double
  TuesdayBreak = pTuesBreak
End Property
Public Property Let TuesdayBreak(Value As Double)
  pTuesBreak = Value
End Property
... 
```

在我的主模块中，我一个接一个地调用两个子例程。

1.  我有一个名为 TimeSheetCollection 的全局变量，它是一个包含 TimeSheet 类型实例的集合
2.  首先，我调用子例程 ReadWeeklyTimeSheets()，它设置 TimeSheetCollection 对象，读取今天的邮件项，并根据从邮件项正文中获得的值设置每个 TimeSheet 中的属性。这个子程序工作得很好。
3.  接下来，调用名为 ExportTimeSheetsToDatabase() 的子例程。我输入了几个 Debug.print 语句，在 Item.MondayStart 和 Item.MondayEnd 属性上收到错误消息：“对象不支持此属性或方法”

主要模块：

```
Sub ExportTimeSheetsToDatabase()
  Dim Item As TimeSheet
  For Each Item In TimeSheetCollection
   Debug.Print "TSCollection Count: " & TimeSheetCollection.count
   Debug.Print Item.EmployeeID & ", " & Item.StartDate & ", " & Item.EndDate
   Debug.Print Item.MondayStart  '<<< Error occurs here
   Debug.Print Item.MondayEnd
   Debug.Print "Toal Hours: " & Item.TotalWeeklyHours
  Next Item
End Sub 
```

由于 Item 是 TimeSheet 类型，您可以从上面的 Class Module 中看到它确实包含 Get 方法：

```
Public Property Get MondayStart() As TimeFrame
  Set MondayStart = pMonStart
End Property 
```

根据我的研究，语法似乎是正确的，当我键入点运算符“。”时 在 Item 我的列表出现后，显示所有属性。这不像我拼错了什么。请指教。

艾伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:26:49.043

`Debug.Print`不适用于对象。您需要在返回标准数据类型的属性或方法上使用它。否则，您将始终收到错误“对象不支持此属性或方法”。

例如，您需要类似`TimeFrame.Value`或`TimeFrame.MilitaryValue`

可能的实现：

```
Public Property Get Value() As String
    'Returns TimeFrame TimeStamp as standard time
     Value = CDate(pHours & ":" & pMinutes)
End Property

Public Property Get MilitaryValue() as String
     'Returns TimeFrame TimeStamp as Military Time
     MilitaryValue = Format(CDate(pHours & ":" & pMinutes),"hh:nn")
End Property 
```

根据您对 TimeFrame 的实现，它似乎是时间戳和持续时间。在这种情况下，使用标准数据类型可能更有意义`Date`。日期数据类型精确到秒，您可以使用 Hour 和 Minute 函数提取特定的小时和分钟信息。例如： `Hour(timeStamp)`或`Minute(timeStamp)`

然后，您可以使用默认为标准时间的简单时间显示`debug.print`时间，但可以使用`Format`如我的`MilitaryValue`示例中所示的军事时间。

# sql - 如何运行关于innerjoin的sql查询

> ID：14083511
> 
> 赞同：-1
> 
> 时间：2012-12-29T16:12:50.320
> 
> 标签：sql, inner-join

```
select rm_id as 'ID'
        bk_branch as 'BRANCH'
        br_name as 'BANK REP.'
        bs_name as 'ESCORT'
        dt_rep  as 'DATE'
        rep_time as 'TIME'
        amt
        inv_no
        total_box
        box_no
        note_state
        dm_state
        1
        2
        10
        20
        50
        100
        500
        1000
        tp
        tv
        tp_ex1
        tv_ex1
        tp_m
        tv_m         
from bk_det 
inner join bk_rep 
  on bk_det.rm_id =  bk_rep.rm_id
inner join bk_sec 
  on bk_rep.rm_id = bk_sec.rm_id
inner join mut_det 
  on bk_sec.rm_id =  mut_det.rm_id
inner join rm_det 
  on mut_det.rm_id = rm_det.rm_id
inner join soil_det 
    on rm_det.rm_id = soil_det.rm_id 
```

我已经从我的表中编写了上面的代码，但没有运行它的显示错误：

> *消息 102，级别 15，状态 1，第 2 行
> 'bk_branch' 附近的语法不正确。*

请帮忙..！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:14:38.917

您需要将 by 中的字段`SELECT`分开`,`。连接本身在语法上看起来不错。

```
select rm_id as 'ID'
        ,bk_branch as 'BRANCH'
        ,br_name as 'BANK REP.'
        ,bs_name as 'ESCORT'
        ,dt_rep  as 'DATE'
        ,rep_time as 'TIME'
        ,amt
        ,inv_no
        ,total_box
        ,box_no
        ,note_state
        ,dm_state
        ,1
        ,2
        ,10
        ,20
        ,50
        ,100
        ,500
        ,1000
        ,tp
        ,tv
        ,tp_ex1
        ,tv_ex1
        ,tp_m
        ,tv_m         
from bk_det 
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:32:36.903

只需将表别名赋予列，否则会产生歧义。

```
select a.rm_id as 'ID',
        bk_branch as 'BRANCH',
        br_name as 'BANK REP.', 
        bs_name as 'ESCORT',
        dt_rep  as 'DATE',
        rep_time as 'TIME',
        amt,
        inv_no,
        total_box,
        box_no,
        note_state,
        dm_state,
        1 ,
        2,
        10,
        20,
        50,
        100,
        500,
        1000,
        tp,
        tv,
        tp_ex1,
        tv_ex1,
        tp_m,
        tv_m,         
from bk_det a
inner join bk_rep b
  on a.rm_id =  b.rm_id
inner join bk_sec c 
  on b.rm_id = c.rm_id
inner join mut_det d
  on c.rm_id =  d.rm_id
inner join rm_det e
  on d.rm_id = e.rm_id
inner join soil_det f
    on e.rm_id = f.rm_id; 
```

# java - 从 Spring MVC Rest 服务抛出的 Jersey REST 客户端捕获异常

> ID：14083514
> 
> 赞同：3
> 
> 时间：2012-12-29T16:12:59.707
> 
> 标签：java, spring, jakarta-ee, exception, jersey

我使用 Spring MVC、Jersey 和 JAXB 实现了一个 REST 应用程序。

客户端发送一个`ServiceRequest`包含有关请求的信息的对象，并接收一个包含有关`ServiceResponse`响应的信息的对象。

服务请求

```
@XmlRootElement(name = "servicerequest")
public class ServiceRequest{

    String serviceName = "AddUser"

    public String getServiceName() {
        return serviceName;
    }

    @XmlElement
    public void setServiceName(String serviceName) {
        this.serviceName = name;
    }   
} 
```

服务响应

```
@XmlRootElement(name = "serviceresponse")
public class ServiceResponse {

    String responseCode; 

    public String getResponseCode() {
        return responseCode;
    }

    @XmlElement
    public void setResponseCode(String code) {
        this.responseCode = name;
    }   
} 
```

客户端使用 Jersey 调用服务

服务客户端

```
ClientConfig config = new DefaultClientConfig();
Client client = Client.create(config);
WebResource service = client.resource(RESOURCE_URL);

ServiceRequest request = new ServiceRequest();
ServiceResponse response = service.path("addUser").type(MediaType.APPLICATION_XML)
.accept(MediaType.APPLICATION_XML).entity(request).post(ServiceRequest.class); 
```

在服务器端，服务获取请求，处理它并返回一个`ServiceResponse`对象。

```
@RequestMapping(method = RequestMethod.POST, 
            value = "/addUser",headers="Accept=application/xml")
    @ResponseStatus(HttpStatus.OK)  
public @ResponseBody ServiceResponse addUser(@RequestBody ServiceRequest request) {

        ServiceResponse response = new ServiceResponse();

        //Handle request
        //service.addUser();

        response.setCode("200");
        return response; 
} 
```

上面显示的控制器类调用另一个服务类来处理请求 ( `service.addUser()`)。此服务类可以引发许多异常。

我不确定如何最好地处理它们。*谷歌搜索*后，我发现我可以使用 ExceptionHandler 如下所示：

```
@ExceptionHandler(NullPointerException.class)
@ResponseBody
public String handleException1(NullPointerException ex)
{
    return ex.getMessage();
} 
```

我可以让控制器扩展一个具有异常处理程序的基类。

关于上述方法的几个问题：

*   我必须为每种异常类型创建一个处理程序吗？我需要处理很多异常，所以不可能只为所有异常提供一个通用处理程序吗？
*   当我的控制器返回一个类型`ServiceResponse`的对象时，发生异常时返回的对象类型是什么？
*   客户期望得到一个`ServiceResponse`类型的对象。如果响应是异常类型，它是如何工作的？

最后，我注意到 ExceptionHanlder 只能具有以下类型之一的返回类型：

```
ModelAndView
Model
Map
View
String – interpreted as a view name
void, but only if the method writes directly to the response object 
```

我想我可以`ServiceResponse`在中创建对象`ExceptionHandler`并设置适当的代码并返回`ServiceResponse`对象。但是，如果我无法`ServiceResponse`在异常处理程序中返回类型，则这是不可能的。

## 编辑

我尝试使用 ExceptionHandler 使用通用异常类，如下所示

```
@ExceptionHandler(ServiceException.class)
@ResponseStatus(HttpStatus.BAD_REQUEST)
    public @ResponseBody resolveServiceValidationException(ServiceException ex) {       

        System.out.println("In resolveServiceError");

        ServiceResponse = new ServiceResponse();
        response.setResponseException(ex.getMessage());
        return response;        
    } 
```

正在捕获异常，但 ServiceResponse 对象始终为空。我得到的只是以下消息：

```
GET http://localhost:8080/myService/services/pingError returned a response status of 400 Bad Request 
```

返回异常时如何访问响应对象？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:40:19.403

1.  `@ExceptionHandler`annotation 可以将一组类作为参数，因此您只能为多个异常创建一个（或多个）处理程序。更改方法签名以将所有已处理异常类的共同祖先作为参数。类似的东西：

    ```
    @ExceptionHandler(value = {NullPointerException.class, AnotherException.class})
    @ResponseBody
    public String handleException1(Exception ex) {
        return ex.getMessage();
    } 
    ```

2.  在您的情况下，它将是`String`，因为您使用 注释它`@ResponseBody`，但您可能希望将返回的 http 代码更改为一些错误代码。您可以通过添加来做到这一点

    ```
    @ResponseStatus(value = HttpStatus.WHATEVER_CODE_YOU_WANT, reason = "Your message")` 
    ```

    注释到您的异常处理程序。

3.  如果调用返回的 http 代码大于或等于`300`，jersey 客户端会抛出`UniformInterfaceException`. 你可以抓住它并处理它。在这种情况下，响应类型无关紧要，因为在转换之前会引发异常。

**更新**

一旦您掌握`UniformInterfaceException`并更改了服务器上的异常处理程序，使其`ServiceResponse`作为响应正文返回，您就可以使用以下方法获取响应：

```
ServiceResponse response = uniformInterfaceException.getResponse().getEntity(ServiceResponse.class); 
```

# java - JPA：如何在事务中加载原始实体

> ID：14083515
> 
> 赞同：1
> 
> 时间：2012-12-29T16:13:11.333
> 
> 标签：java, hibernate, jpa

我试图在更新之前计算实体中的修改。

1.  显示 HTML 表单
2.  提交时：
    1.  开始交易
    2.  加载实体
    3.  将表单数据应用于实体
    4.  计算变化
    5.  持久化实体

步骤 2.1 到 2.3 是通过我的 MVC 框架 (Spring MVC) 管理的，所以我实际上从来没有在没有更改的情况下引用原始实体。

所以我目前正在尝试做的是以下内容：

```
// transaction is already started
public Modifications store(Entity updated) {
    Entity original = entityManager.find(Entity.class, updated.getId());
    Modifications mods = calculateModifications(original, updated);
    entityManager.merge(updated);
    return mods;
} 
```

但不幸的是，我从实体管理器收到的实体`==`与更新后的实体相同（读取）。

这是问题：如何强制实体管理器从数据库中再次加载实体而不分离我更新的实体？

我使用 Hibernate 作为我的持久性提供程序，但我想尽可能地保持这个提供程序不可知论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:30:58.303

这是一个类似于您的问题[Hibernate: comparison current & previous record的 SO 答案](https://stackoverflow.com/questions/183013/hibernate-comparing-current-previous-record)

使用方法`evict`从会话缓存中删除旧实例，然后`calculateModifications`使用从方法中获得的新实例检查更新`find`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-10T02:16:27.057

顺便说一句，`detach`如果您使用，您可以使用`EntityManager`。如下代码：

```
entityManager.detach(newOne);
Order oldOne = orderRepository.findById(orderId);
// compare newOne and oldOne
... 
```

# java - 使用内部对话框的 JOptionPane 问题

> ID：14083517
> 
> 赞同：2
> 
> 时间：2012-12-29T16:13:32.240
> 
> 标签：java, swing, joptionpane

```
String result = JOptionPane.showInputDialog(this, temp); 
```

`result`value 将是输入的值。

```
String result = JOptionPane.showInternalInputDialog(this, temp); 
```

`result`即使您输入了字符串，值也会为空。

`temp`是将包含在 JOptionPane 中的面板。此 JOptionPane 将显示在另一个自定义 JOptionPane 之上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T16:17:50.383

`JOptionPane.showInternalInputDialog`仅与`JDesktopPane`/ `JInternalFrame`s一起使用， / s 实例`this`在哪里。`JDesktopPane``JInternalFrame`

```
final JDesktopPane desk = new JDesktopPane();
...
String s=JOptionPane.showInternalInputDialog(desk, "Enter Name"); 
```

如果不与上述两个组件中的任何一个一起使用，它将不会产生正确的输出，实际上它会抛出运行时异常：

> java.lang.RuntimeException: JOptionPane: parentComponent 没有有效的父级

**更新**

根据您的评论，这里是您如何添加`JPanel`和`JDesktopPane`调用的示例`JOptionPane#showInternalInputDialog`。重要的部分是我们需要调用`setBounds`and `setVisible`on`JPanel`就像我们将它`JInternalFrame`添加到 中`JDesktopPane`一样，当然除了我们添加一个`JPanel`

```
JFrame frame = new JFrame("JInternalFrame Usage Demo");

frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

// A specialized layered pane to be used with JInternalFrames
jdpDesktop = new JDesktopPane() {
    @Override
    public Dimension getPreferredSize() {
        return new Dimension(600, 600);
    }
};

frame.setContentPane(jdpDesktop);

JPanel panel = new JPanel();
panel.setBounds(0, 0, 600, 600);

jdpDesktop.add(panel);

frame.pack();
frame.setVisible(true);

panel.setVisible(true);

String result = JOptionPane.showInternalInputDialog(jdpDesktop, "h");

System.out.println(result); 
```

# php - 在 MySQL 中保存配对值

> ID：14083519
> 
> 赞同：-5
> 
> 时间：2012-12-29T16:13:38.983
> 
> 标签：php, mysql, database

例如：

```
An item
{
size:23"
Resolution:1920*1080
Panel:IPS
}
(as in an usual table) 
```

mysql 中的一个存储通常的方式是创建一个列名“大小”等。但是，由于我关心的对中的第一项是不确定的（比如我希望用户能够输入像 producer:samsung 这样的数据；或者用户想要输入的任何数据对）

有没有办法在mysql中优雅地做到这一点？也许是一个常见的分隔字符串？在任何情况下，我都希望这些数据能够轻松地输出为表格，并可能进行搜索，例如获取 size=22" 的所有项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:30:29.397

MySQL 解决方案。

```
Entity    Key        Value
An item   size       23"
An item   Resolution 1920*1080
An item   Panel      IPS

SELECT * FROM table where Entity = 'An item'; //Selecting info on an item

SELECT * FROM table where Entity IN   //Selecting info on items with size = '22"'
   (SELECT Entity WHERE Key = 'size' AND Value = '22"'); 
```

注释：

*   所有数据都存储为字符串，数据库类型检查丢失且效率低下
*   大量的应用程序逻辑和子查询。
*   您可以将实体设为 ID，并为实体名称和任何必填字段设置另一个表。
*   这是一个多字段键表（Entity,Key）

为什么这是最好的方法：

*   单个字段中的逗号分隔值破坏了数据库的全部意义。

该属性是第一范式。如果您将多个值放在一个字段中，您将无法使用 SQL 对该字段进行排序（至少不能以相当快的方式）。

您还需要处理解析等问题 - 必须转义更多字符。

*   在运行时更改表模式和添加新字段也对性能不利。

你最终会得到非常稀疏的表，大量的 NULL 条目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:21:17.710

```
table_name( primary_key, pair_name, pair_value)

select *
from table_name
where (pair_name = 'size' and pair_value = '22')
and primary_key = ........ 
```

# c# - 制作简单的投票页面

> ID：14083520
> 
> 赞同：0
> 
> 时间：2012-12-29T16:13:41.647
> 
> 标签：c#, asp.net, html, gridview

我想做一个简单的投票页面，我有一个应该可以工作的代码，但似乎 .cs 文件不想识别 gridview

```
public partial class _Default : System.Web.UI.Page 
{
    int Count = 0;
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void btnVote_Click(object sender, EventArgs e)
    {
        if (radVote.SelectedItem != null)
        {
            InsertVotes(radVote.SelectedItem.ToString());
        }
        else
        {
            lblStatus.ForeColor = Color.Red;
            lblStatus.Text = "Please select at least one option to vote for poll";
        }
    }

    protected void InsertVotes(string theVote)
    {
        try
        {
            XmlDocument xmldoc = new XmlDocument();
            xmldoc.Load(Server.MapPath("Votes.xml"));
            XmlElement parentelement = xmldoc.CreateElement("Vote");
            XmlElement votechoice = xmldoc.CreateElement("Choice");
            votechoice.InnerText = theVote;
            parentelement.AppendChild(votechoice);
            xmldoc.DocumentElement.AppendChild(parentelement);
            xmldoc.Save(Server.MapPath("Votes.xml"));
            lblStatus.ForeColor = Color.Green;
            lblStatus.Text = "Thank you for your vote.";
        }
        catch
        {
            lblStatus.Text = "Sorry, unable to process request. Please try again.";
        }
    }

protected void readXML()
{
    int mCount = 0;
    int iCount = 0;
    int gCount = 0;
    XmlTextReader xmlreader = new XmlTextReader(Server.MapPath("Votes.xml"));
    DataSet ds = new DataSet();
    ds.ReadXml(xmlreader);
    xmlreader.Close();
    if (ds.Tables.Count > 0)
    {
        int dscount = ds.Tables[0].Rows.Count;
        for (int i = 0; i < dscount; i++)
        {
            if (ds.Tables[0].Rows[i][0].ToString() == "Mozilla")
                mCount++;
            else if (ds.Tables[0].Rows[i][0].ToString() == "Internet Explorer")
                iCount++;
            else if (ds.Tables[0].Rows[i][0].ToString() == "Google Chrome")
                gCount++;
        }

        double theTotal;
        theTotal = mCount + iCount + gCount;

        double mPercent;
        double oPercent;
        double gPercent;
        mPercent = (mCount / theTotal) * 100;
        oPercent = (iCount / theTotal) * 100;
        gPercent = (gCount / theTotal) * 100;

        double totalpercentage = mPercent + oPercent + gPercent;

        string[] votescount = { mCount.ToString(), iCount.ToString(), gCount.ToString() };
        string[] array = { mPercent.ToString(), oPercent.ToString(), gPercent.ToString() };
        DataTable dt = new DataTable();

        dt.Columns.Add("OPTION_NAME");
        dt.Columns.Add("VOTES");
        dt.Columns.Add("PERCENTAGE");

        int count = radVote.Items.Count;
        Count = count + 1;

        for (int i = 0; i < count; i++)
        {
            dt.Rows.Add();
            dt.Rows[i]["OPTION_NAME"] = radVote.Items[i].ToString();
            dt.Rows[i]["VOTES"] = votescount[i];
            dt.Rows[i]["PERCENTAGE"] = array[i];
        }
            dt.Rows.Add("Total", theTotal, totalpercentage);
            gvResult.DataSource = dt;
            gvResult.DataBind();
   }
   else
   {
        gvResult.DataSource = null;
        gvResult.DataBind();
   }
}

protected void butResults_Click(object sender, EventArgs e)
{
    readXML();
}

int cnt = 0;
protected void gvResult_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)

    cnt++;

    Label lblpercent = (Label)e.Row.FindControl("lblpercentage");
    HtmlTable tblpercent = (HtmlTable)e.Row.FindControl("tblBar");
    tblpercent.Width = lblpercent.Text+"%";

    if (lblpercent.Text == "0")
    {
        tblpercent.Visible = false;
    }

    if (cnt == Count)
    {
        e.Row.CssClass = "TablePollResultFoot";
    }

    foreach (TableCell tc in e.Row.Cells)
    {
        tc.Attributes["style"] = "border-color:#CCCCCC";
    }
}

protected void btnResult_Click(object sender, EventArgs e)
{
    readXML();
} 
```

}

gvResult、radVote、lblStatus 都有一个错误，指出当前上下文中不存在该名称。我检查了名称，一切似乎都很好，但我仍然收到此错误。

在 html 中，我有单选按钮列表、一个网格视图、一个用于投票的按钮和一个用于显示结果的按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:18:26.043

您的页面文件可能与设计器文件不同步。创建一个新页面，将您的网格移到那里，看看是否可以修复它？

您可以自己在设计器文件中手动添加控制声明，但不建议这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:26:47.180

或者，您可以删除设计器文件并让 ASP.Net 重新生成它。[这里](http://blog.lavablast.com/post/2010/02/08/ASPNET-Regenerate-designercs.aspx)有更长的解释，但基本上，您只需删除问题 .designer.cs 文件。要重新生成它，请单击解决方案资源管理器中的 .aspx 文件，然后单击“转换为 Web 应用程序”。

# android - arrayAdapter getView 方法中的侦听器

> ID：14083523
> 
> 赞同：3
> 
> 时间：2012-12-29T16:14:06.900
> 
> 标签：android, listview, listener

我有一个带有图像、一对 TextViews 和一个复选框的 ListViews 的自定义 row_item。据我了解，由于 checkBox 是一个可聚焦元素，它会从 listView 中窃取焦点，因此 OnListItemClicked 永远不会被触发，除非我将每个 row_item 设置为不可点击并且我阻止后代的可聚焦性。

然后，为了管理复选框更改，我在适配器 getView 方法中为我的复选框设置了“OnCheckedChangeListener”。

这是一种不好的做法吗？（因为每次调用 getView 时我都在创建新的侦听器）还有其他方法可以做到这一点吗？

我附上了一些代码，以便更容易理解我的意思。

getView 方法：（在 arrayAdapter 内）

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    /** recycling views */
    View row = convertView;
    PregoHolder holder = null;

    if(row == null)
    {
        LayoutInflater inflater = ((Activity)context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);

        holder = new PregoHolder();
        holder.imgIcon = (ImageView)row.findViewById(R.id.thumbnail);
        holder.txtTitle = (TextView)row.findViewById(R.id.txtTitle);
        holder.txtNews = (TextView)row.findViewById(R.id.txtNews);
        holder.chBox = (CheckBox) row.findViewById(R.id.checkBox);

        row.setTag(holder);
    }
    else
    {
        holder = (PregoHolder)row.getTag();
    }

    Prego Prego = data[position];
    holder.txtTitle.setText(Prego.title);
    holder.imgIcon.setImageResource(Prego.icon);
    holder.txtNews.setText(Prego.news);
    holder.chBox.setChecked(Prego.checked);

    /** wiring up Listeners... 
     * (works fine but we are creating new listener each time)
     * (Done like this because of the custom list view focusable issue)
     */

    holder.chBox.setOnCheckedChangeListener(new OnCheckedChangeListener(){

        @Override
        public void onCheckedChanged(CompoundButton arg0, boolean checked) {
            /** Getting the view position in the ListView */
            ListView parent = (ListView)(arg0.getParent()).getParent();
            int pos = parent.getPositionForView(arg0);

            if (checked){
                checkedPregons[pos] = true;
                pregonsChecked++;
            }
            else if (!checked){
                checkedPregons[pos] = false;
                pregonsChecked--;
            }

            Toast.makeText(context, pregonsChecked+" is/are checked", Toast.LENGTH_SHORT).show();
        }
    });

    row.setOnClickListener(new OnClickListener(){

        @Override
        public void onClick(View v) {
            //mMode = ((Activity)context).startActionMode(new PregonsActionModes());
            ListView parent = (ListView)v.getParent();
            int pos = parent.getPositionForView(v);
            Toast.makeText(context, "getView should show prego "+pos,Toast.LENGTH_SHORT).show();

        }
    });

    return row;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:32:44.790

我想可能有更好的方法来解决它，但这不是我会失眠的事情。您的方法已被许多新旧 Android 开发人员广泛实施，这只是一种简单自然的方式。此外，请记住，`ListView`只有一次在屏幕上可以看到尽可能多的行（并且`getView`在您滚动时不断调用），所以您在任何给定时间谈论 8 - 12 个制作对象（显然完全猜测），所以你的瓶颈不会在这里。事实上，根据我需要修改的对象在哪里，我什至没有考虑它。

**但是**`OnCheckedChangeListener`在 a中使用`ListView`是我强烈警告的事情。就像我说`getView`的那样，在滚动和制作每一行时都会调用它。这个经过检查的已更改侦听器正在被触发，尽管它绝对不能保证每行`getView`只调用*一次*，但实际上我保证不会。因此，这些代码块可能会被 wazoo 激发，即使您可能只打算`CheckBox`手动处理复选框。输入一个相对更密集的命令`notifyDataSetChanged()`，你会看到你`ListView`从这个现象中被锁定。

解决方案是简单地使用复选框`onClickListener`并检查`isChecked()`内部。

# javascript - 如何从Javascript中的数组数组中提取值？

> ID：14083524
> 
> 赞同：2
> 
> 时间：2012-12-29T16:14:07.940
> 
> 标签：javascript, json

我有一个变量如下：

```
var dataset = {
"towns": [
    ["Aladağ", "Adana", [35.4,37.5], [0]],
    ["Ceyhan", "Adana", [35.8,37], [0]],
    ["Feke", "Adana", [35.9,37.8], [0]]
    ]
}; 
```

该变量中有很多城镇数据。如何有效地从数据中提取第三个元素的第一个元素？我，e，`...`下面会是什么？

```
var myArray = ...
//myArray == [35.4,35.8,35.9] for the given data 
```

如果我想将两个值都存储在数组中该怎么办？那是

```
var myArray = ...
//myArray == [[35.4,37.5], [35.8,37], [35.9,37.8]] for the given data 
```

我对 Javascript 很陌生。我希望有一种不使用 for 循环的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T16:16:49.167

在较新的浏览器上，您可以使用`map`, 或者`forEach`避免使用`for`循环。

```
var myArray = dataset.towns.map(function(town){
  return town[2];
});
// myArray == [[35.4,37.5], [35.8,37], [35.9,37.8]] 
```

但是 for 循环更兼容。

```
var myArray = [];
for(var i = 0, len = dataset.towns.length; i < len; i++){
  myArray.push(dataset.towns[i][2];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:17:00.757

没有循环是不可能的：

```
var myArray = [];
for (var i = 0; i < dataset.towns.length; i++) {
    myArray.push(dataset.towns[i][2][0]);
}
// at this stage myArray = [35.4, 35.8, 35.9] 
```

> 如果我想将两个值都存储在数组中该怎么办？

类似地，您只需添加整个数组，而不仅仅是第一个元素：

```
var myArray = [];
for (var i = 0; i < dataset.towns.length; i++) {
    myArray.push(dataset.towns[i][2]);
}
// at this stage myArray = [[35.4,37.5], [35.8,37], [35.9,37.8]] 
```

# android-ndk - C++程序不显示任何输出？

> ID：14083528
> 
> 赞同：2
> 
> 时间：2012-12-29T16:15:08.523
> 
> 标签：android-ndk

我现在正在尝试在 Eclipse 中执行一个 C++ 程序，但它没有显示任何内容，我的代码是：

```
#include<iostream.h>
using namespace std;
int main()
 {
    cout<<"i have stucked here, plz do some thing for Me !";
    return 0;
 } 
```

我认为我不能设置变量路径。这是

```
%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\QuickTime\QTSystem\;c:\Program Files\Microsoft SQL Server\90\Tools\binn\;C:\Program Files\Samsung\Samsung PC Studio 3\;C:\soft\cygwin\bin 
```

而我的 bin 路径是

```
c:\cygwin\bin 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:18:21.397

试试这个：

```
#include<iostream>
using namespace std;
int main()
 {
    cout<<"I am stuck here, please do some thing for Me !";
    return 1;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:27:17.477

从头文件 iostream.h 中删除“.h”，因为现在 .h 表单已从 c++ 库中弃用。

这对我来说很好用..

```
 #include<iostream>
       using namespace std;
       int main()
        {
          cout<<"I am stuck here, please do some thing for Me !";
           return 0;
         } 
```

# javascript - 商店中未定义的变量：[] 和视图：[] - Ext-JS 4.1.1a

> ID：14083530
> 
> 赞同：1
> 
> 时间：2012-12-29T16:15:41.677
> 
> 标签：javascript, extjs

我正在创建自己的“库”，因为我想让我的代码保持干燥。这个想法只是扩展 SimpleController 并向它发送一个名称，以便它可以一般地加载已经创建的存储和视图，但在我的控制台中，我收到一条消息，即 nameOfController 未定义。

1.) 在这个例子中，为什么 nameOfController 未定义？

2.) 我知道如何扩展 SimpleController 但何时是初始化**nameOfController**的合适时间？在`init()`函数中？是否有一些功能甚至在加载商店：[] 和视图：[] 之前执行？

```
Ext.define('MyApp.controller.SimpleController', {
    extend: 'Ext.app.Controller',

    nameOfController: "",

    stores: ['MyApp.store.' + this.nameOfController],
    views: ['MyApp.view.' + this.nameOfController + '.Index'] 
```

编辑：（扩展示例）

```
Ext.define('MyApp.controller.Users', {
    extend: 'MyApp.controller.SimpleController',

    nameOfController: "Users"  //I want to this nameOfController
                               //changes the one in superclass
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:03:10.253

您可以为控制器定义构造函数。例子：

```
Ext.define('MyApp.controller.SimpleController', {
    extend: 'Ext.app.Controller',
    nameOfController: "",

    //stores: ['MyApp.store.' + this.nameOfController],
    //views: ['MyApp.view.' + this.nameOfController + '.Index']

    constructor: function(config) {
        var name = config.nameOfController;

        config.stores = config.stores || [];
        config.views = config.views || [];

        config.stores.push('MyApp.store.' + name);
        config.views.push('MyApp.view.' + name + '.Index');

        this.callParent(arguments);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:24:11.997

在定义对象时，对象不是`this`.

您可以使用匿名自调用函数：

```
Ext.define("MyApp.controller.SimpleController",(function(name) {
  return {
    extend: 'Exp.app.Controller',
    nameOfController: name,
    stores: ['MyApp.store.'+name],
    views: ['MyApp.view.'+name+'.Index']
  };
})("Users")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:24:33.820

这会起作用：

```
var name = "Users";

Ext.define('MyApp.controller.SimpleController', {
    extend: 'Ext.app.Controller',

    nameOfController: name,    

    stores: ['MyApp.store.' + name],
    views: ['MyApp.view.' + name + '.Index']
}); 
```

因此，字符串存储在外部变量中。

# bitmap - 位图（图像视图）无法正确缩放，以完全适合线性布局

> ID：14083548
> 
> 赞同：0
> 
> 时间：2012-12-29T16:17:14.923
> 
> 标签：bitmap, android-linearlayout

我想缩放位图，以完全适合线性布局

我有一个线性布局

```
 <LinearLayout
                        android:id="@+id/lin_layout1"
                        android:layout_width="wrap_content"
                        android:layout_height="fill_parent"
                        android:paddingLeft="10dip"
                        android:paddingRight="10dip"
                        android:paddingTop="20dip" >

                        <!-- <ImageView
                            android:id="@+id/image1"
                            android:layout_width="wrap_content"
                            android:layout_height="fill_parent"
                            android:layout_gravity="bottom"
                            android:layout_marginTop="10dip"
                            android:layout_weight="0.66" 
                            android:layout_marginBottom="10dip"
                            android:src="@drawable/abc"
                           /> -->                           
                    </LinearLayout> 
```

我已经动态定义了一个图像视图，如下所示，

```
Imageview img = new ImageView(myclass);

                    LinearLayout.LayoutParams vp = new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT,
                            LayoutParams.MATCH_PARENT, 1);
                    vp.setMargins(2, 20, 2, 20);
                    vp.gravity=Gravity.BOTTOM;          
                    img.setLayoutParams(vp);
                    img.setAdjustViewBounds(true); 
```

我已经从数据库生成了缩放位图

我已将其解码如下

```
public static Bitmap decodeSampledBitmapFromDatabase(byte[] bs,
            int length, Options options2,int reqwidth,int reqheight) 
    {

        // First decode with inJustDecodeBounds=true to check dimensions
        final BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;

        BitmapFactory.decodeByteArray(bs, 0, length, options2); 

        // Calculate inSampleSize
        options.inSampleSize = calculateInSampleSize(options2, reqwidth, reqheight);
        Log.d("In sample size", ""+options.inSampleSize);

        // Decode bitmap with inSampleSize set
        options.inJustDecodeBounds = false;
        Bitmap bmap= BitmapFactory.decodeByteArray(bs, 0, length, options);

        return Bitmap.createScaledBitmap(bmap, 130, reqheight, false);

    }

    public static int calculateInSampleSize(BitmapFactory.Options options, int reqWidth, int reqHeight) 
    {
        // Raw height and width of image
        final int height = options.outHeight;
        final int width = options.outWidth;
        int inSampleSize = 1;

        if (height > reqHeight || width > reqWidth) {
            if (width > height) {
                inSampleSize = Math.round((float)height / (float)reqHeight);
            } else {
                inSampleSize = Math.round((float)width / (float)reqWidth);
            }
        }
        return inSampleSize;
    } 
```

最后生成的位图设置为 imageview

```
img.setImageBitmap(bmnew);
img.setOnClickListener(smile_reader);
img.setOnLongClickListener(smile_reader);
l1.addView(img);//Added imageview to linearlayout 
```

但它不能正确缩放，

imageview 高度确实与线性布局高度匹配。

imageview 看起来比要求的要小，我不知道我错过了哪里，所以需要任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:45:56.683

您可以执行以下操作...

- 使用计算最大可能大小

```
options.inSampleSize = Math.max(inWidth/dstWidth, inHeight/dstHeight);  //still it will return image larger than your targeted size 
```

- 使用加载图像

```
Bitmap roughBitmap = BitmapFactory.decodeStream(in, null, options); 
```

- 最后使用调整到所需尺寸

```
Bitmap resizedBitmap = Bitmap.createScaledBitmap(roughBitmap, (int) (roughBitmap.getWidth() * values[0]), (int) (roughBitmap.getHeight() * values[4]), true); 
```

# java - 将 1 个字符串元素转换为整数

> ID：14083555
> 
> 赞同：0
> 
> 时间：2012-12-29T16:18:09.400
> 
> 标签：java

编写一个程序，检查字符串数组是否包含有效数字。如果字符串包含“.”，则将其转换为 Double，否则将其转换为 Integer。输入应为字符串数组 { "10.20", "123456", "12 。无效的”}。

我的问题是 123456 正在更改为 double。我必须将其更改为 int。请帮助 :(

```
public class Ch7LU3Ex1
{
    public static void main(String[] args)
    {
        String[] str = new String []{"10.20","123456","12.invalid"};
        int i,count=0;
        try
        {
            for(i=0;i<3;i++)
            {
                int l = str[i].length();
                for(int j=0;j<l;j++)
                {
                    if(str[i].charAt(j)=='.')
                    {
                        count++;
                    }
                    else
                    {
                        continue;
                    }
                }
                if(count!=0)
                {
                    double d = Double.parseDouble(str[i]);
                    System.out.println(d);
                }
                else
                {
                    int e = Integer.parseInt(str[i]);
                    System.out.println(e);
                }
            }
        }
        catch(NumberFormatException e)
        {
            System.out.println("Invalid number");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:21:06.593

```
if(str[i].indexOf('.') == -1) {
    int e = Integer.parseInt(str[i]);
}
else {
    double d = Double.parseDouble(str[i]);
} 
```

这比所有不需要的循环都要优雅得多。祝你好运！

要了解其工作原理，[请参阅 indexOf() 的字符串 API](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#indexOf(int))。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:21:42.643

至于您当前使用的方式，您需要在每次迭代中将其重置为`count`，`0`否则在找到第一个双精度值后的每个值都将转换为双精度值，因为您的`count`值`non-zero`在每种情况下都是如此。

因此，在您的第一个 for 循环中，您需要在开始时重置计数，如下所示：-

```
for(i=0;i<3;i++)
{
    count = 0; 
```

现在，你真的让你的任务变得复杂了。您根本不需要使用该`count`变量。另外，你不需要`nested loop`那里。你可以像这样简单地循环一次。只是不要自己处理单个角色。Java 库有已经为您完成的方法。改用它们：-

```
for (String str: arr) {
    if (str.contains(".")) {
        double d = Double.parseDouble(str);
    } else {
        int i = Integer.parseInt(str);
    }
} 
```

使用的循环称为[增强型 for-loop](https://stackoverflow.com/questions/3328672/what-are-the-advantages-of-enhanced-for-loop-and-iterator-in-java)。

[`String#contains()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#contains%28java.lang.CharSequence%29)方法检查字符串是否包含某个字符。或者，您可以使用方法来查找字符串中[`String#indexOf()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#indexOf%28int%29)的索引。`.`如果它返回一个正值，那么您的字符串包含该字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T16:24:50.720

我根本不会使用循环。我假设您没有随机数据，并且您知道每个“列”的类型应该是什么。

```
String[] str = {"10.20", "123456", "12.invalid"};

double d = Double.parseDouble(str[0]);
int i = Integer.parseInt(str[1]);
String s = str[2]; 
```

如果您不知道一个值应该是 a`double`还是 an `int`，您始终可以将其解析为 double 而不会损失精度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T16:21:28.170

看来您必须将每个字符串的 count 设置回零，而您没有这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T16:21:14.767

一次迭代后再次计数为零`count=0`，在第二次迭代中计数不为零，因此再次考虑为双精度值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T16:21:46.017

在每个检查元素之后，您必须将 count 变量重置为 0。这种方式计数会增加，因为“10.20”包括一个点并且不会为“123456”重置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-29T16:21:52.770

您的代码有点乱，但关键是您不会为`str`.

所以如果你在循环中添加一个`counter=0;`遍历一个字符串的所有字符的循环，你可能会得到你想要的？

一些额外的提示：

*   使用可读的变量名
*   缩进你的代码

# .net - https请求谷歌驱动器刷新令牌

> ID：14083558
> 
> 赞同：0
> 
> 时间：2012-12-29T16:18:22.150
> 
> 标签：.net, vb.net, httpwebrequest, google-drive-api

我正在尝试创建一个 http 请求以使用存储的刷新令牌获取新的访问令牌，以便我可以访问 Google 云端硬盘。

```
 Dim uri As String = "https://accounts.google.com/o/oauth2/token"

   Dim para As String = "code='" + cred.RefreshToken + "'&client_id='" + ClientCredentials.CLIENT_ID + "'&client_secret='" + ClientCredentials.CLIENT_SECRET + "'&grant_type='refresh_token'"

   Dim httpWebRequest As System.Net.HttpWebRequest = Net.WebRequest.Create(uri)
   httpWebRequest.Method = "POST"
   httpWebRequest.ContentType = "application/x-www-form-urlencoded"

   Dim requestStream As System.IO.Stream = httpWebRequest.GetRequestStream()
   Dim streamwriter As System.IO.StreamWriter = New System.IO.StreamWriter(requestStream)
   streamwriter.Write(para)
   streamwriter.Close()

   Dim httpWebResponse As System.Net.HttpWebResponse = httpWebRequest.GetResponse() 
```

但这会返回一个错误的请求。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:59:48.107

您没有将凭据写入 StreamWriter，它应该读取...

```
streamwriter.Write(para) 
```

当然，这是假设它们是正确的。

# ubuntu - avconv (ffmpeg)：正确的音频编解码器

> ID：14083564
> 
> 赞同：1
> 
> 时间：2012-12-29T16:18:58.587
> 
> 标签：ubuntu, ffmpeg

尝试将视频从闪存录像机转换为 mp4 时出现错误：

```
ubuntu@media:/data/media/failed$ avconv -i videoStream_1356794393712_805.flv -acodec aac  videoStream_1356794393712_805.mp4
avconv version 0.8.4-4:0.8.4-0ubuntu0.12.04.1, Copyright (c) 2000-2012 the Libav developers
  built on Nov  6 2012 16:51:33 with gcc 4.6.3
[libspeex @ 0x1091500] Missing Speex header, assuming defaults.
[flv @ 0x108d7a0] Estimating duration from bitrate, this may be inaccurate
Input #0, flv, from 'videoStream_1356794393712_805.flv':
  Metadata:
    creationdate    : Sat Dec 29 15:20:12
  Duration: 00:00:04.39, start: 0.000000, bitrate: N/A
    Stream #0.0: Video: h264 (Main), yuv420p, 640x480 [PAR 1:1 DAR 4:3], 30 tbr, 1k tbn, 60 tbc
    Stream #0.1: Audio: libspeex, 16000 Hz, 1 channels, s16
[buffer @ 0x1093a00] w:640 h:480 pixfmt:yuv420p
[mpeg4 @ 0x1094ce0] removing common factors from framerate
[aac @ 0x108d120] Too many bits per frame requested
Output #0, mp4, to 'videoStream_1356794393712_805.mp4':
  Metadata:
    creationdate    : Sat Dec 29 15:20:12
    Stream #0.0: Video: mpeg4, yuv420p, 640x480 [PAR 1:1 DAR 4:3], q=2-31, 200 kb/s, 90k tbn, 30 tbc
    Stream #0.1: Audio: aac, 16000 Hz, 1 channels, s16, 200 kb/s
Stream mapping:
  Stream #0:0 -> #0:0 (h264 -> mpeg4)
  Stream #0:1 -> #0:1 (libspeex -> aac)
Error while opening encoder for output stream #0:1 - maybe incorrect parameters such as bit_rate, rate, width or height
ubuntu@media:/data/media/failed$ 
```

Ubuntu 12.04 LTS，默认 ffmpeg/avconv。
我怎么解决这个问题？

ffprobe 日志：

```
ubuntu@media:/data/media/failed$ ffprobe videoStream_1356794393712_805.flv
avprobe version 0.8.4-4:0.8.4-0ubuntu0.12.04.1, Copyright (c) 2007-2012 the Libav developers
  built on Nov  6 2012 16:51:33 with gcc 4.6.3
[libspeex @ 0x1c27500] Missing Speex header, assuming defaults.
[flv @ 0x1c237a0] Estimating duration from bitrate, this may be inaccurate
Input #0, flv, from 'videoStream_1356794393712_805.flv':
  Metadata:
    creationdate    : Sat Dec 29 15:20:12
  Duration: 00:00:04.39, start: 0.000000, bitrate: N/A
    Stream #0.0: Video: h264 (Main), yuv420p, 640x480 [PAR 1:1 DAR 4:3], 30 tbr, 1k tbn, 60 tbc
    Stream #0.1: Audio: libspeex, 16000 Hz, 1 channels, s16
[libspeex @ 0x1c27500] Missing Speex header, assuming defaults.
ubuntu@media:/data/media/failed$ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:40:03.577

我找到了解决方案。需要安装这些软件包：`sudo apt-get install libavcodec-extra-53 libavdevice-extra-53 libavfilter-extra-2 libavformat-extra-53 libavutil-extra-51 libpostproc-extra-52 libswscale-extra-2`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T13:05:46.127

我找到了另一个解决方案。ffmpeg 应该从官方网站的链接下载二进制版本（linux x64）。

Ubuntu 版本的编解码器存在问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-01T09:06:23.247

我在 Ubuntu 14.04 中通过使用 libvo_aacenc 编解码器而不是 aac 编解码器解决了这个问题。您可以将命令更改为如下所示：

```
avconv -i videoStream_1356794393712_805.flv -c:v mpeg4 -c:a libvo_aacenc  videoStream_1356794393712_805.mp4 
```

# python - TypeError: argument 1 must be pygame.Surface, not str 我该如何解决？

> ID：14083566
> 
> 赞同：2
> 
> 时间：2012-12-29T16:19:00.193
> 
> 标签：python, linux, pygame, raspberry-pi

我从一个 youtbe 视频中对此进行了编码，他似乎做得很好，但是当我尝试时，我在底部收到错误消息，我很困惑，我需要帮助。

```
#!/usr/bin/env python

import pygame, sys

from pygame.locals import *

pygame.init()

screen = pygame.display.set_mode((370, 572), 0, 32)

backgroundfile = "back.png"
mousefile = "mouse.png"

back = pygame.image.load(backgroundfile).convert()
mouse = pygame.image.load(mousefile).convert_alpha()

while True:

    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()

    #Now we have initialized everything lets start with the main part

    screen.blit("back.png", (0,0))

    pygame.display.flip() 
```

当我运行程序时，我收到错误：

```
Traceback (most recent call last):
  File "Tutorial 5 First game.py", line 26, in <module>
  screen.blit("back.png", (0,0))
TypeError: argument 1 must be pygame.Surface, not str 
```

我不确定这意味着什么或如何解决

这是修复

> 你有两个问题。你的第一个是你把引号放在周围 `back.png`，使它变成一个字符串`(str)`而不是一个表面 `(pygame.Surface)`。您的第二个是您为第二个参数而不是 rect 放置一个元组`(pygame.Rect).`要修复第一个，只需放置 backgroundfile （您之前将表面保存为）而不是 `"background.png"`. 要修复第二个，请使用`backgroudfile.get_rect()`获取背景的矩形。你的行应该是：
> 
> `screen.blit(backgroundfile, backgroundfile.get_rect()`这本身不起作用，因为您之前没有将背景文件保存为表面对象。代替
> 
> `backgroundfile = "back.png"`放
> 
> `backgroundfile = pygame.image.load("back.png")``"back.png"`如果保存为同一文件夹中的文件，这将返回一个表面。对另一个加载的图像执行相同的操作。做所有这些事情，你的程序应该可以工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T23:30:05.140

你有两个问题。你的第一个是你把引号括起来`back.png`，使它成为一个字符串（str）而不是一个表面（pygame.Surface）。你的第二个是你为第二个参数放置一个元组而不是一个矩形（pygame.Rect）。要解决第一个问题，只需输入`backgroundfile`（您之前将表面保存为的内容）而不是`"background.png"`. 要修复第二个，请使用`backgroudfile.get_rect()`获取背景的矩形。你的行应该是：

```
screen.blit(backgroundfile, backgroundfile.get_rect() 
```

这本身不起作用，因为您之前没有将背景文件保存为表面对象。代替

```
backgroundfile = "back.png" 
```

放

```
backgroundfile = pygame.image.load("back.png") 
```

如果“back.png”作为文件保存在同一文件夹中，这将返回一个表面。对另一个加载的图像执行相同的操作。做所有这些事情，你的程序应该可以工作。

# codeigniter - 使用预定义变量加载 codeigniter 视图

> ID：14083567
> 
> 赞同：0
> 
> 时间：2012-12-29T16:19:29.293
> 
> 标签：codeigniter

我不知道以下是否可行。如果没有其他建议，我们将不胜感激。

在我几乎所有的控制器中，我都会加载一些默认视图。例如页眉、页脚和菜单。

我想为每个视图自动加载某些变量。

如果我以标题为例。在我的标题中，我总是会加载一组`$css`脚本和一组`$javascript`文件。

> $javascript[] = 'js/jquery.js'; $javascript[] = 'js/jqueryui.js';

但另外，根据当前页面逻辑，我可能想将另一个 javascript 文件添加到我的`$javascript`变量中。

> $javascript[] = 'js/custom.js';

然后理想情况下，我希望这些变量作为数据自动插入到视图的负载中。

换句话说，我只想打电话：

> $this->load->view('header');

这怎么可能实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:01:45.263

创建 MY_Controller 在那里添加一个公共数组，然后从 MY_Controller 扩展

```
class MY_Controller extends CI_Controller  {
     public $data;

     function __construct() {
         parent::__construct();
         $this->data['MYVAR'] = 'Something';
     }
} 
```

在您的其他控制器中，您只需这样做

```
class SomeClass extends MY_Controller {
    function __construct () {
        parent::__construct();
    }

     function index () {
         $this->data['SomeOtherVar'] = 'xxx';
         $this->load->view('viewname', $this->data);
     }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:23:33.023

您可以在控制器中使用 $this->load->vars。我在 my_controller 中使用它，所有控制器都是从 MY_Controller 扩展的，例如

```
<?php
    class MY_Controller extends Controller{
        public function __construct(){
            parent::__construct();
            $this->setGlobalViewVariables();
        }

        public function setGlobalViewVariables(){
            $result = array();
            $result['value1'] = 'value1';
            $result['value2'] = 'value1'; 
            $this->load->vars($result);
        }
    }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:30:07.057

你应该为此创建一个[钩子](http://ellislab.com/codeigniter/user-guide/general/hooks.html)，这很简单

# jsf - JSF - 将对象发送到 bean 参数

> ID：14083568
> 
> 赞同：1
> 
> 时间：2012-12-29T16:19:30.717
> 
> 标签：jsf, javabeans, parameter-passing, commandlink

我正在学习 JSF，当我将对象发送到 bean 参数时，对象的实例不正确。

我有一个列出很多电影的页面，如果我想查看有关电影的完整信息，我单击一个链接，将我发送到包含以下代码的页面：

```
<h:form>
<h:commandLink action="#{sharedMovie.share(movie)}" value="Share">
    <div class="movieDetail">
    <div class="movieDetailTitle">"#{movie.title}"</div>
    <div class="movieDetailYear">"#{movie.year}"</div>
    <div class="movieDetailSynopsis">"#{movie.synopsis}"</div>
    </div>
</h:form> 
```

电影 bean 有一个请求范围。

问题是，当我单击“共享”时，我的班级`sharedMovie`会收到一个新实例`Movie`，而不是页面中显示的电影。所有显示的数据都是正确的，只有当我调用其他页面时才会发生此问题。

`f:setPropertyActionListener`我已经尝试使用,仅发送电影 ID（但它始终为 0）`f:param`，但没有任何效果。如果我调试我的项目，当我单击共享链接时，它总是会在 Movie 类的构造函数中遇到断点。

我怎样才能正确传递这个实例？

# networking - 什么技术允许使用您客户的带宽来分发连续事件？

> ID：14083572
> 
> 赞同：1
> 
> 时间：2012-12-29T16:20:15.117
> 
> 标签：networking, network-programming, bandwidth

假设有一个服务器连续产生事件。该服务器的客户端通过浏览器访问它，浏览器必须接收产生的每个事件。如果服务器直接将事件发送给每个客户端，在经过多个客户端之后，它肯定会耗尽其带宽。是否有允许使用您自己的客户端作为对等点来分发这些事件的技术？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:47:04.480

尝试[http://socket.io/](http://socket.io/)。它允许您非常轻松地定位特定客户端（浏览器）、特定客户端组（房间）或连接的每个人，并将数据推送给他们，以便前端 JS 可以处理它。

不知道你的后端技术，但它与 node.js 结合得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:33:40.867

您说您的客户端是浏览器，因此服务器无法与客户端通信。但是如果有新事件，您可以使用 AJAX 询问服务器。这种技术被称为`long polling`，见[http://techoctave.com/c7/posts/60-simple-long-polling-example-with-javascript-and-jquery](http://techoctave.com/c7/posts/60-simple-long-polling-example-with-javascript-and-jquery)

# wpf - WPF Datagrid 单元格工具提示

> ID：14083583
> 
> 赞同：2
> 
> 时间：2012-12-29T16:21:33.393
> 
> 标签：wpf, datagrid, linq-to-entities, tooltip

我有一个 WPF 4.0`DataGrid`显示来自`LINQ to Entities`查询的数据。该查询返回一个匿名列表，因此`DataGrid`它的`AutoGenerateColumns`属性设置为 true。如何显示`ToolTips`列单元格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:27:08.823

您可能应该以列的样式执行此操作。如果你想在运行时选择样式，你可以订阅`AutoGeneratingColumn`事件，并根据需要自定义列...

这是 MSDN 上的链接，其中包含有关[自定义自动生成的列的非常好的教程](http://msdn.microsoft.com/en-us/library/cc903950%28v=vs.95%29.aspx)

# java - ActiveResource 的基本假定端点是什么？

> ID：14083591
> 
> 赞同：0
> 
> 时间：2012-12-29T16:22:26.393
> 
> 标签：java, ruby-on-rails, rest, jersey, activeresource

我有一个 java 支持的 web 服务，我想用 ActiveResource 进行测试。

假设的基本 url 端点是什么，比如说我有一个用户资源。

目前我的网址是：

```
localhost:8080/api/users 
```

我创建了一个测试类，但它失败了，因为它假设我有这个 url：

```
localhost:8080/api/users.json 
```

我打算这样做：

```
localhost:8080/api/users/   (GET - lists users)
localhost:8080/api/users/create (POST - create a user)
localhost:8080/api/users/10  (GET user with id 10)
localhost:8080/api/users/10/update (POST - update user with id 10) 
```

什么是 Rails 标准？这个标准是跨其他框架的“标准”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:18:01.953

Rails（因此也是 ActiveResource）假设对于每个资源（用户、帖子...），您都有以下可用端点（我排除了端点前缀）：

*   GET`/users.json`获取所有用户
*   GET`/users/2.json`以获取有关 ID = 2 的用户的详细信息
*   POST`/users.json`创建一个新用户
*   DELETE`/users/2.json`删除 ID = 2 的用户
*   PUT`/users/2.json`更新 ID = 2 的用户

您可以像这样选择数据格式：

```
User.format = :xml
User.find(2) # => GET /users/2.xml 
```

最好创建一个新的 Rails 应用程序，搭建用户资源并从控制台使用它。这样您还可以看到数据预期的数据结构。

# c++ - 信号和插槽 - 传递数据

> ID：14083599
> 
> 赞同：1
> 
> 时间：2012-12-29T16:23:36.363
> 
> 标签：c++, qt

我试图将信号连接到插槽并通过向量，但我运气不佳。

```
res = QObject::connect(storePayments, SIGNAL(existingPurchasesResponseSuccess(std::vector<QString>)), this, SLOT(RefreshPurchasesSuccess(std::vector<QString>))); 
```

投币口：

```
void RefreshPurchasesSuccess(std::vector<QString>);

void Store::RefreshPurchasesSuccess(std::vector<QString> previousPurchasesArray)
{
 //do something
} 
```

信号：

```
void existingPurchasesResponseSuccess(std::vector<QString>);

vector<QString> previousPurchasesArray;
emit existingPurchasesResponseSuccess(previousPurchasesArray); 
```

它说未定义信号/插槽，但是当我取出矢量时它起作用了，所以它一定有问题。我定义错了吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T19:31:28.693

如果您使用自定义结构`std::vector<QString>`，则必须声明和注册元类型

```
 Q_DECLARE_METATYPE(std::vector<QString>) 
```

“理想情况下，这个宏应该放在类或结构的声明之下。如果不可能，它可以放在一个私有头文件中，每次在 QVariant 中使用该类型时都必须包含该文件。” -- 关于 Q_DECLARE_METATYPE 的 Qt 文档

对于排队的连接，您可能需要 qRegisterMetatype

```
 qRegisterMetaType<std::vector<QString> >(); 
```

`main()`qRegisterMetaType甚至可以在之前调用`QApplication::exec()`。

还要记住，`Q_OBJECT`如果你的类声明了任何信号或槽，你必须使用宏。

“Q_OBJECT 宏必须出现在声明自己的信号和插槽或使用 Qt 元对象系统提供的其他服务的类定义的私有部分中。”

如果您没有理由使用`std::vector<QString>`，那么使用起来会简单得多`QStringList`，Qt 的元对象系统已经知道它提供了许多方便的方法来操作其内容，并且作为标准的 Qt 类型将适合非您的插槽定义。

# struct - 结构布局：无法创建构造函数来设置我需要的字段

> ID：14083618
> 
> 赞同：3
> 
> 时间：2012-12-29T16:26:25.277
> 
> 标签：struct, lisp, common-lisp

下面的代码“编译”，但不能正常运行：

```
(defstruct (image-info
             (:conc-name img-)
             (:constructor %make-img-info (&key file))
             (:print-function print-img-info))
  (file nil :type string)
  (gd-image nil :type (or cl-gd::image null))
  (size '(0 . 0) :type cons)
  (position '(0 . 0) :type cons))

(defun print-img-info (info stream level)
  (declare (ignore level))
  (let ((size (img-size info))
        (pos (img-position info)))
    (format stream "~s[width: ~d, height: ~d, x: ~d, y: ~d]"
            (img-file info)
            (car size) (cdr size) (car pos) (cdr pos))))

(defun make-img-info (path)
  (let ((image (cl-gd:create-image-from-file path))
        (info (%make-img-info :file path))) ; <--- problem here
    (setf (img-gd-image info) image
          (img-size info)
          (cons (cl-gd:image-width image)
                (cl-gd:image-height image))) info)) 
```

SBCL 正确推断 的参数类型`%make-img-info`，如下所示：

```
(describe '%make-img-info)
SPRITESHEET::%MAKE-IMG-INFO
  [symbol]

%MAKE-IMG-INFO names a compiled function:
  Lambda-list: (&KEY (FILE NIL))
  Declared type: (FUNCTION (&KEY (:FILE STRING))
                  (VALUES IMAGE-INFO &OPTIONAL)) 
```

但是当我尝试编译时`make-img-info`，我得到了这个：

```
 note: deleting unreachable code
  warning: 
    Derived type of PATH is
      (VALUES CL-GD::IMAGE &OPTIONAL),
    conflicting with its asserted type
      STRING. 
```

我将正确的参数（一个字符串）传递给这个函数，但它仍然无法调用它，因为它“相信”它必须是`cl-gd:image`. 我怀疑问题在于布局以某种方式按字母顺序排列，并且`gd-image`出现`file`在列表之前......但是我该如何解决这个问题？我真的不想重命名该字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T07:49:50.563

现在我相信这是与 SLIME 和 SBCL 在编译结构时不能很好地合作的某种故障。我无法始终如一地重现这种行为，但它有时也会发生在其他结构中，因此有时我需要杀死 SLIME 和 SWANK，重新启动 SBCL 并重新编译，因为仅重新编译结构的相关部分将不起作用。

我不会删除这个问题，因为如果有人会遇到类似的行为，也许这将有助于重新启动 Lisp，因此这种体验可能会很有用。

# jsp - servletConfig.getInitParameterNames() is not working

> ID：14083619
> 
> 赞同：0
> 
> 时间：2012-12-29T16:26:41.143
> 
> 标签：jsp, jakarta-ee, servlets, web.xml, servletconfig

I need to show two URLs into a JSP, but I want to pass some init parameters to the JSP page for doing this.

So, this is my web.xml :

```
<web-app ... >
<servlet>
    <servlet-name>index1</servlet-name>
    <jsp-file>/index.jsp</jsp-file>
    <init-param>
        <param-name>p1</param-name>
        <param-value>http://www.google.com</param-value>
    </init-param>
    <init-param>
        <param-name>p2</param-name>
        <param-value>/pagina2.jsp</param-value>
    </init-param>
</servlet>
<servlet-mapping>
    <servlet-name>index1</servlet-name>
    <url-pattern>/index.jsp</url-pattern>
</servlet-mapping> 
```

In the index.jsp, I wrote the following code:

```
<%
    // This is only a test code. Obviously, it doesn't show the URLs
      java.util.Enumeration e = getServletConfig().getInitParameterNames();
      while( e.hasMoreElements() ) {
          out.println( e.nextElement() + "<br>");
      }
    %> 
```

But when I run the jsp, this show some initParameters that I don't need. By example: `logVerbosityLevel
httpMethods
keepgenerated
p2 ----------- > This is the parameter that I need

xpoweredBy
p1 ----------- > This is other parameter that I need
system-jar-includes
com.sun.appserv.jsp.classpath` 

My questions is: Why the JSP file are using all this parameters?
Note: I'm using Glassfish.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:15:48.103

Those are the initialization parameters of the container-builtin `JspServlet` class who's responsible for serving JSP files. In case of Glassfish, you can find it in `config/default-web.xml` file of the domain. It's the servlet entry of `org.apache.jasper.servlet.JspServlet` (note, you should not modify it unless you really understand what you're doing).

# search - jEdit Hypersearch 类似于 VIM 中的结果？

> ID：14083622
> 
> 赞同：1
> 
> 时间：2012-12-29T16:26:52.623
> 
> 标签：search, vim, editor, jedit

在 jEdit 中，您可以执行所谓的超级搜索，它在一个窗格中列出所有搜索结果，并允许您单击它们以跳转到文本中的那个位置。

vim 是否具有类似的功能，使用插件或其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:15:42.517

那将是快速修复列表或位置列表。

要`foo`在当前缓冲区中搜索并显示所有出现的列表，请执行以下操作：

```
:vim foo % | copen  <-- use the quickfix list
:lvim foo % | lopen <-- use the location list 
```

要`foo`在当前缓冲区的目录中搜索并显示所有出现的列表，请执行以下操作：

```
:vim foo .* | copen 
```

见`:h quickfix`。

# java - 正则表达式捕获在 OR 运算符之后返回为 null 的组

> ID：14083628
> 
> 赞同：0
> 
> 时间：2012-12-29T16:27:46.337
> 
> 标签：java, regex, capture-group

```
Matcher matcher = Pattern.compile("\\bwidth\\s*:\\s*(\\d+)px|\\bbackground\\s*:\\s*#([0-9A-Fa-f]+)").matcher(myString);
if (matcher.find()) {
    System.out.println(matcher.group(2));
} 
```

示例数据： `myString = width:17px;background:#555;float:left;`将产生`null`. 我想要什么：

```
matcher.group(1) = 17
matcher.group(2) = 555 
```

我刚刚开始在 Java 上使用正则表达式，有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:45:33.623

我建议把事情分开一点。

而不是构建一个大的正则表达式（也许您想在字符串中添加更多规则？）您应该将字符串拆分为多个部分：

```
String myString = "width:17px;background:#555;float:left;";
String[] sections = myString.split(";"); // split string in multiple sections
for (String section : sections) {

  // check if this section contains a width definition
  if (section.matches("width\\s*:\\s*(\\d+)px.*")) {
    System.out.println("width: " + section.split(":")[1].trim());
  }

  // check if this section contains a background definition
  if (section.matches("background\\s*:\\s*#[0-9A-Fa-f]+.*")) {
    System.out.println("background: " + section.split(":")[1].trim());
  }

  ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:47:17.930

这是一个工作示例。有| （或）在正则表达式中通常令人困惑，所以我添加了两个匹配器来展示我将如何做到这一点。

```
public static void main(String[] args) {
    String myString = "width:17px;background:#555;float:left";

    int matcherOffset = 1;
    Matcher matcher = Pattern.compile("\\bwidth\\s*:\\s*(\\d+)px|\\bbackground\\s*:\\s*#([0-9A-Fa-f]+)").matcher(myString);
    while (matcher.find()) {
        System.out.println("found something: " + matcher.group(matcherOffset++));
    }

    matcher = Pattern.compile("width:(\\d+)px").matcher(myString);
    if (matcher.find()) {
        System.out.println("found width: " + matcher.group(1));
    }

    matcher = Pattern.compile("background:#(\\d+)").matcher(myString);
    if (matcher.find()) {
        System.out.println("found background: " + matcher.group(1));
    }
} 
```

# c++ - C++中根据特定类型执行代码

> ID：14083633
> 
> 赞同：3
> 
> 时间：2012-12-29T16:28:08.243
> 
> 标签：c++, templates, generics, boost

我正在尝试将我之前用函数式语言 (OCaml) 编写的一些代码重写为 C++。

我的问题可以简化为：

*   我有一堆价值观
*   值可以是变体类型（因此是一组不同类型的值，例如`int`, `float`, `std::string`,`std::list`等等）
*   我想定义对值起作用的运算符（例如，弹出两个值并推动它们之和的加法运算）
*   一些运算符的行为会根据堆栈上的类型而有所不同，理想情况下，一些运算符甚至会根据类型更改参数的数量（一个简单的例子：加法运算符可以弹出一个值，如果它是 a `std::list`then push 运算符应用于所有列表的值，否则弹出另一个值并在它们都是浮动的情况下进行加法）

到目前为止，我已经能够通过使用模板使其工作，例如。

```
class Value
{
  public:
    Value(Type type) : type(type) { }

    virtual string svalue() const = 0;
    virtual string lvalue();

    virtual bool equals(Value *value) const = 0;
    virtual Value* clone() const = 0;

    const Type type;

    virtual ~Value() { };
}

template <class T>
class TValue : public Value
{
  protected:
    T value;

  public:
    TValue(Type type, T value) : Value(type), value(value) {}

    void set(T value) { this->value = value; }
    T get() const { return this->value; }
};

class Int : public TValue<int>
{
  private:

  public:  
    Int(int value) : TValue<int>(TYPE_INT, value) { };

    virtual string svalue() const;

    virtual bool equals(Value *value) const { return this->value == ((TValue<int>*)value)->get(); }
    virtual Value *clone() const { return new Int(value); }
}; 
```

然后通过做来解释运算符

```
Value *v1, *v2,
case OP_PLUS:
{
  if (vm->popTwo(&v1, &v2))
  {  
    switch (v1->type << 4 | v2->type)
    {
      case TYPES(TYPE_INT, TYPE_INT): vm->push(new Int(((Int*)v1)->get() + ((Int*)v2)->get())); break;
      case TYPES(TYPE_FLOAT, TYPE_INT): vm->push(new Float(((Float*)v1)->get() + ((Int*)v2)->get())); break;
      case TYPES(TYPE_INT, TYPE_FLOAT): vm->push(new Float(((Int*)v1)->get() + ((Float*)v2)->get())); break;
      case TYPES(TYPE_FLOAT, TYPE_FLOAT): vm->push(new Float(((Float*)v1)->get() + ((Float*)v2)->get())); break;
    }
  }
  break;
} 
```

现在，这行得通，但我不喜欢这种方法，因为它听起来很笨拙，需要大量类型转换，而且一点也不优雅（与我的功能实现相比）。我开始研究*boost*库，看看我是否能找到一种更好的方法来管理一切，在开始之前我试图定义一种不同的方式来定义运算符，例如

```
template <Opcode T, class X, class A>
class Unary
{
public:
  static A* ptr(X* x)
  {
    cout << "Missing instruction!" << endl;
    return NULL;
  };
};

template <>
class Unary<OP_MINUS, Float, Float>
{
  public:
    static Float *ptr(Float *x) { return new Float(-x->get()); };
}; 
```

这样我就能做到

```
Float *a = new Float(10);
Float *r = Unary<OP_MINUS, Float, Float>::ptr(f); 
```

这可行，但我仍然无法看到我应该如何以通用方式管理它，以便我可以根据堆栈上找到的内容和使用的运算符调用正确的函数。

boost会以某种方式帮助我吗？我想要的是一个同时类型安全和优雅的解决方案，但是 boost 有这么多不同的库，我很难理解要寻找什么。如果我缺少一些更简单的东西，我不需要使用它，我没想到在为这种任务放弃功能语言时会发现这么多困难。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T17:35:49.633

你想要`boost::variant`, 和元素列表，`boost::make_recursive_variant`（所以你可以在类型中引用类型）。

虽然`apply_visitor`允许您将函数应用于多种类型，但我发现这样的事情更容易考虑（假设您的编译器支持 C++11）：

```
template<typename T, typename Func, typename Types...>
bool TryApplyFuncOn( boost::variant<Types...>& var, Func f ) {
  struct HelperVisitor {
    HelperVisitor( Func f_ ):func(f_) {}
    Func func;
    typedef bool return_type;
    template<typename U>
    return_type operator()( U& unused ) { return false; }
    return_type operator()( T& t ) { f(t); return true; }
  };
  return boost::apply_visitor( HelperVisitor(f), var );
} 
```

它采用您要应用函数的类型和变体，并在您要求应用的类型是变体中的类型时应用它。如果找到匹配项，则返回 true。

一般情况下，您可以“一次性”完成此操作。

因此，您可以执行以下操作：

```
// easy case:
typedef boost::variant<int,double> scalar;
scalar times_two(scalar const& left) {
  scalar retval = left;
  TryApplyFuncOn<int>( retval, []( int& value ){ value*=2; } );
  TryApplyFuncOn<double>( retval, []( double& value ){ value*=2.; } );
  return retval;
}
// tricky case:
scalar multiply(scalar const& left, scalar const& right) {
  scalar retval = left;
  TryApplyFuncOn<int>( retval, [&right]( int& left_value ){
    TryApplyFuncOn<int>( right, [&left_value]( int& right_value ){
      left_value *= right_value;
    });
    TryApplyFuncOn<double>( right, [&left_value]( double& right_value ){
      left_value *= right_value;
    });
  });
  TryApplyFuncOn<double>( retval, [&right]( double& left_value ){
    TryApplyFuncOn<int>( right, [&left_value]( int& right_value ){
      left_value *= right_value;
    });
    TryApplyFuncOn<double>( right, [&left_value]( double& right_value ){
      left_value *= right_value;
    });
  });
  return retval;
} 
```

它还没有进行类型提升（所以 int*double 不会变成双精度），但是没有任何根本性的阻止。

说得通？

# ruby - 安装便携式 ruby 和便携式 xampp 以便在我的 Windows 机器中使用 compass 和 sass：这可能吗？

> ID：14083634
> 
> 赞同：1
> 
> 时间：2012-12-29T16:28:21.490
> 
> 标签：ruby, windows, xampp, sass, compass-sass

我想尝试使用 SASS 和指南针。当我读到指南针在 ruby​​ 中运行时，我需要在本地 Windows 机器上安装 ruby​​ 才能使用它。

我想以便携式方式安装所有东西，我的意思是在我的随身碟中。我已经下载了一个[便携式 ruby](http://www.yellosoft.us/portable-ruby)​​ 版本和一个[便携式 xampp](http://www.apachefriends.org/en/xampp-windows.html#646)版本，并且我已经在我的 pendrive 中安装了这两个版本。

我的问题是：因为我从来没有使用过 ruby​​，我应该只运行 ruby​​ 应用程序和 xamp 应用程序，然后在其中安装 compass 吗？我已经阅读了指南针安装版本，但我不知道如何使用 pendrive 中的命令行安装它。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T04:40:46.290

我在其他地方找到了对此的回复，以防万一有人想知道同样的事情，这是使用 SASS 的最快方法，当你有 Windows 并且不知道关于 ruby​​ 的词，但你读到你需要为了使用指南针：

1.  [你可以使用这个](http://rubyinstaller.org/downloads/)在你的 Windows 电脑上安装 ruby ​​。我试过便携式的，但在我的情况下没有用。

2.  之后，您必须打开一个特殊的控制台窗口（激活 ruby​​ 的那个）。有一个名为“用 ruby​​ 开始推荐提示”的图标正是这样做的。它与您的 ruby​​ 安装在同一个文件夹中。

3.  您只需输入： gem install compass 不，您不必下载任何内容，它只是安装应用程序。

4.  你不再需要使用命令行，也不需要为 compass.app 付费：你有免费的[Scout](http://mhs.github.com/scout-app/)替代品。您安装它，从那一刻起您就可以使用它。

也许你也应该阅读这些：http: [//thesassway.com/beginner/getting-started-with-sass-and-compass](http://thesassway.com/beginner/getting-started-with-sass-and-compass) http://andrewpwatson.com/posts/how-set-compass-sass-windows-aptana-工作室 3

# css - 带有 JavaScript 事件的 HTML DIV 拆分器

> ID：14083641
> 
> 赞同：1
> 
> 时间：2012-12-29T16:29:30.317
> 
> 标签：css, html, javascript-events

我正在制作一个简单的 HTML DIV 拆分器，我将光标设置为 col-resize。我希望在拖动拆分器时光标是 col-resize，但是如果拖动鼠标不在拆分器上（例如超出调整大小边界），则光标将不再是 col-resize。的HTML：

```
<div id="container">
    <div id="left"></div>
    <div id="splitter"></div>
    <div id="right">
</div> 
```

CSS：

```
#container {
    position: relative;
}

#left {
    position: absolute;
    left: 2px;
    top: 2px;
    width: 200px;
    height: 200px;
    outline: 2px solid red;
}

#right {
    position: absolute;
    left: 202px;
    top: 2px;
    width: 300px;
    height: 200px;
    outline: 2px solid blue;
}

#splitter {
    position: absolute;
    left:202px;
    top: 2px;
    height: 200px;
    z-index: 2;
    cursor: col-resize;
    width: 8px;
}

#splitter.active {
    background-color: gray;
} 
```

我遇到的另一个问题是：我希望当鼠标按下并拖动时背景颜色为灰色，但鼠标向上或完成拖动时没有颜色，但是如果鼠标在拆分器之外，则 mouseup 事件将无法触发。

```
$("#splitter").on("mousedown mouseup", function() {
    $(this).toggleClass("active");});​ 
```

jsFiddle 链接在这里：http: [//jsfiddle.net/Shuping/MhYuK/](http://jsfiddle.net/Shuping/MhYuK/)有 什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:36:17.250

### 你没有给出 else 条件。

试试这个，可能吗？

```
$("#splitter").on("mousedown", function() {
    $(this).addClass("active");
});

$("#splitter").on("mouseup mouseleave", function() {
    $(this).removeClass("active");
});​ 
```

# javascript - 使用 websocket 激活 HTML5 模式属性

> ID：14083646
> 
> 赞同：1
> 
> 时间：2012-12-29T16:30:43.800
> 
> 标签：javascript, jquery, html, websocket

作为基于 Web 编程的新手，我无法理解为什么`pattern`下面的属性字段由于我的 javascript 而无法检查文本字段的有效性。

```
<form id="aForm">
    <input type="text" pattern="^[ a-zA-Z0-9,#.-]+$" id="address" title="Standard address"/>        
<input type="submit" id="open" value="Start"/>
</form> 
```

然后将表单内容发送到一个 javascript 文件，然后通过 a 将其发送到服务器，`websocket`如下面的代码片段所示。但是，它忽略了通过`pattern`属性验证表单。

```
 $(document).ready(function() {

    $("#open").click(function(evt) {          
          evt.preventDefault();
          var form = $('#aForm').serialize();
          webSocket = new WebSocket("ws://localhost:9999/mh");
          webSocket.onopen = function()
          {
             webSocket.send(form);
          };
          REST OF CODE.... 
```

似乎由于某种原因，这会阻止在发送文本之前对其进行检查。我想知道为什么以及如何确保表单被`pattern`属性验证。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:15:21.900

HTML5 表单验证仅在您尝试实际[提交表单](http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#form-submission-algorithm)时执行，或者当您明确使用 JavaScript 对其进行验证时¹。

由于您的 JavaScript 绑定到不同的事件（按钮单击），因此此时不会执行表单验证。您可以通过以下方式解决此问题：

1.  将您的提交绑定到表单的`submit`事件而不是按钮单击，或者
2.  在脚本的最开始使用[表单验证 API](http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#the-constraint-validation-api)。

我强烈推荐第一个选项。`$('#aForm').submit()`当通过其他方法提交表单时，它具有更多的语义意义并且可以正常工作（我不记得当有人在文本字段中按 Enter 时是否会模拟按钮单击，如果 JavaScript 以编程方式调用它肯定不会被触发...）。

* * *

¹至少，这些是我注意到的唯一地方 - 在完成验证时可能还有其他事件/情况。

# php - PHP - 根据会话变量创建目录

> ID：14083648
> 
> 赞同：0
> 
> 时间：2012-12-29T16:31:02.110
> 
> 标签：php, file, mkdir, directory

我想知道如何根据名为“UserID”的会话变量使用 PHP 创建一个目录（在 HTML 上传按钮上单击）。

这就是我试图做的：

```
 <?php
    include("login.php");

?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <title>FileStore - Upload Files</title>
    <link rel="stylesheet" href="./CSS/style.css" type="text/css" media="screen, projection" />
</head>

<body>

<div id="wrapper">

    <header id="header">

    <div id="header-content">
        <strong><h1>FileStore</h1></strong> Upload multiple files at once!
    </div>

    <div class="login-info" >

    <?php

    if ($isLoggedin === false) {
        echo '  <form action="" method="POST">
                    Username: <input name="username" > 
                    Password: <input type="password" name="password" size="8">
                              <input type="submit" name="submit" value="Login">
                </form>';
        echo "<p align='right'>You are not logged in.</p>";
        echo "<b><a href='registration.php'>Register</a></b>";

    }else{  
        echo $welcomeMsg;
    }   
?>

    </div>

    </header><!-- #header-->

    <section id="middle" align="center">

        <div id="container">

        <br><br>
            <div id="content">
                <strong><h1>Upload files</h1></strong><br><br>

                <div id="upload-file" >

                <?php 

                    include("dbConfig.php");

                    $Username = $_SESSION["username"];

                    //$Password = $_SESSION["password"];

                    $Password = md5($Password);

                    $sql = "SELECT UserID FROM users WHERE Username = '".$Username."' AND Password = '".$Password."'";

                    $result = mysql_query($sql) or die(mysql_error());

                    while($row = mysql_fetch_assoc($result)) {

                            $userid = $row['UserID'];

                    }

                    echo $userid;

                    $dirname = $userid;

                    $filename = ("/folder/" . "$dirname" . "/");

                    if (!file_exists($filename))

                    {

                                mkdir("files/'$userid'", 0777);

                    } else {

                    if (isset($_FILES['files'])) {

                        echo "<div id='files_table'><table class='center'.><tr><td>";

                                foreach($_FILES['files']['tmp_name'] as $key => $tmp_name){

                                move_uploaded_file($tmp_name, "files/'".$userid."'{$_FILES['files']['name'][$key]}");

                                echo $_FILES['files']['name'][$key], " uploaded.", "<br>";

                        }
                        echo "</td></tr></table></div><br><br>";
                        }

                    }

                        if (isset($_FILES['files'])) {

                        echo "<div id='files_table'><table class='center'.><tr><td>";

                                foreach($_FILES['files']['tmp_name'] as $key => $tmp_name){

                                move_uploaded_file($tmp_name, "files/'".$userid."'{$_FILES['files']['name'][$key]}");

                                echo $_FILES['files']['name'][$key], " uploaded.", "<br>";

                        }
                        echo "</td></tr></table></div><br><br>";
                        }

                ?>
                    <form action="" method="post" enctype="multipart/form-data">

                            <h1> Select files to upload:</h1>
                            <br>
                            <p>
                                <input type="file" name ="files[]" multiple min="1" /> 
                                <input type="submit" value="Upload" />
                            </p>
                            <br>
                            <h2> You can select multiple files for upload. </h2>

                    </form>

        </div>

            </div><!-- #content-->
        </div><!-- #container-->

        <aside id="sideLeft">

            <div id="menu-x" align="center"><br>
            <strong>Menu</strong><br><br>

                    <div class="menu">
                        <ul>
                        <li><a href="index.php">Home</a></li>
                        <li><a href="upload.php">Upload</a></li>
                        <li><a href="files.php">Files</a></li>
                        <li><a href="about.php">About</a></li>
                        <li><a href="help.php">Help</a></li>
                        <li><a href="#">Logout</a></li>
                        </ul>
                        <br style="clear:left"/>
                    </div>

            </div>

        </aside><!-- #sideLeft -->

    </section><!-- #middle-->

    <footer id="footer">
        <strong>FileStore:</strong> A CMT 3315 Project by Brian Livori
    </footer><!-- #footer -->

</div><!-- #wrapper -->

</body>
</html> 
```

这不起作用。我收到以下错误消息：

> 注意：未定义变量：第 70 行 C:\xampp\htdocs\Task2PHP\final\upload.php 中的密码
> 
> 注意：未定义变量：第 83 行 C:\xampp\htdocs\Task2PHP\final\upload.php 中的用户 ID
> 
> 注意：未定义变量：第 85 行 C:\xampp\htdocs\Task2PHP\final\upload.php 中的用户 ID
> 
> 注意：未定义变量：第 93 行 C:\xampp\htdocs\Task2PHP\final\upload.php 中的用户 ID
> 
> 警告：mkdir()：文件存在于第 93 行的 C:\xampp\htdocs\Task2PHP\final\upload.php

知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:47:15.590

除了您对安全性问题的评论之外：

1.  `$userid`未设置。这意味着您的查询没有返回任何行。您应该为所有数据库调用添加错误处理（您应该将其更改为 PDO / mysqli），包括没有找到用户的场景；
2.  您检查目录`/folder/" . "$dirname" . "/"`，然后尝试生成目录`"files/'$userid'"`。那应该`"/folder/$userid"`甚至更一致`"/folder/'$dirname'"`；
3.  我怀疑您是否要将文件存储在文件`/folder`系统根目录中称为的文件夹中，因此您应该检查一下。

# ruby-on-rails - 从任意深度的哈希中优雅地提取所有字符串

> ID：14083654
> 
> 赞同：0
> 
> 时间：2012-12-29T16:31:21.610
> 
> 标签：ruby-on-rails, ruby, hash

我的目标是确定哈希中是否有空格，如下所示：

```
{"departure_time_slots"=>{"date"=>[""], "time"=>{"start"=>[""], "end"=>[""]}}} 
```

字符串可以任意嵌套。我不想手动检查它们中的每一个。如果我可以提取所有字符串而不管它们的深度如何，那就太好了。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T17:13:31.023

这是一个如何提取值的示例。但是，您仍然会遇到将值与键匹配的问题。你不可能同时拥有两者。

```
# Extend the Hash class
class Hash
  def recursive_values
    self.values.collect { |v|
      v.is_a?(Hash) ? v.recursive_values : v
    }.flatten
  end
end 
```

用法：

```
h = {"departure_time_slots"=>{"date"=>[""], "time"=>{"start"=>[""], "end"=>[""]}}}
h.recursive_values
=> ["", "", ""] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:48:53.673

不不可能。因为它们彼此完全存在于不同的范围内。例如。键`start`并且`end`是完全未知的并且被`departure_time_slots`上面示例中的对象屏蔽。

一种方法可能是，再次获取哈希图类型的哈希图的所有值并递归地获取它们的键。

从该映射的值列表中获取键，`departure_time_slots`然后从每个值中找到所有键，如果那是一个哈希映射。除此之外，我认为没有其他方法。

PS附带说明，看看你是否可以将你的结构修改为一个数组，其中元素也可以是数组，并尝试使用数组的扁平化概念。:P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:09:01.290

如果你会这样使用会更好：

`departure_time_slots = {:date => Time.new, :time_start => nil, :time_end => nil}`

当您在 Hash 中使用键时，最好使用符号作为键。(http://www.ruby-doc.org/core-1.9.3/Symbol.html)

# java - 带有 Java 的系统托盘

> ID：14083660
> 
> 赞同：2
> 
> 时间：2012-12-29T16:32:00.313
> 
> 标签：java, layout, system-tray

[通过执行Oracle 指示的操作，](http://docs.oracle.com/javase/tutorial/uiswing/misc/systemtray.html)我已将我的程序设置为出现在系统托盘中。我的第一个问题是关于图标的。我的系统托盘中有很多程序，而我的程序是隐藏的。我可以让它显示在栏中而不需要单击托盘中的箭头吗？

我还发现我可以通过调用来显示一条消息`trayIcon.displayMessage(title, content, icon)`。我想知道我是否可以像 Skype 那样改变气球的外观。

![在此处输入图像描述](../Images/dcb0b0f2e6bdd6db48abd0a71b730faf.png)

还是我需要使用其他东西来显示消息？它应该始终出现在所有应用程序的前面，并且不应妨碍其他应用程序。例如，如果用户正在玩游戏，信息对话框不应该从鼠标和键盘上窃取焦点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:36:12.863

不，您不能使用 java 系统托盘机制更改气球的样式。Skype 不使用 java 机制来显示系统托盘。设计和显示气球是系统的任务。

要显示您的图标，它是一个 Windows 配置 - 当您单击箭头时，有一个“自定义”链接，您可以在其中配置显示哪些图标。

如果你想影响窗口的风格，你需要实现你的自定义框架，感觉和定位就像一个系统托盘信息窗口。而且你不会使用托盘类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:36:47.123

关于你关于剥皮的问题。SystemTray displayMessage 气球不能以任何方式自定义。

# jquery - Jquery.ui : 从当前元素获取 id

> ID：14083665
> 
> 赞同：0
> 
> 时间：2012-12-29T16:32:45.217
> 
> 标签：jquery, resize, resizable

调整大小时如何获取当前元素的 id？我做的以下不起作用，谢谢

```
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />
<script>
$(document).ready(
function(){
    $( ".resizable" ).resizable({
        resize: function( event, ui ) {alert(ui.element.id)}
    })
}
);
</script>

<img class="resizable" id="25" src="test1.jpg">
<img class="resizable" id="26" src="test2.jpg">
<img class="resizable" id="27" src="test3.jpg"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:34:03.207

试试这个

```
$( ".resizable" ).resizable({
    resize: function( event, ui ) {
            alert($(ui.element).children('img').attr('id'));
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-24T12:52:31.947

使用`$(this)`. 它对我有用。

# c++ - 需要加密一个 AES 块的示例

> ID：14083667
> 
> 赞同：0
> 
> 时间：2012-12-29T16:33:06.537
> 
> 标签：c++, aes, crypto++

> **可能重复：**
> [使用 AES 和 Crypto++ 加密-解密单个块](https://stackoverflow.com/questions/11082432/encrypt-decrypt-single-block-with-aes-and-crypto)

我有一个涉及实现 AES 的两种操作模式的作业，但问题是我不知道如何加密单个 AES 块。如，我不知道如何单独使用 Crypto++ 的 AES 实现。在我所见之处，我只能找到使用库操作模式的代码片段，即使我知道它应该如何使用，我还是想亲自为作业做这件事。任何人都可以帮助一些 C++ 代码示例吗？

# c++ - 读取PNG标头的宽度和高度

> ID：14083668
> 
> 赞同：5
> 
> 时间：2012-12-29T16:33:23.750
> 
> 标签：c++, image, file, file-io, png

我正在尝试读取 PNG 文件的宽度和高度。这是我的代码：

```
struct TImageSize {
    int width;
    int height;
};

bool getPngSize(const char *fileName, TImageSize &is) {
    std::ifstream file(fileName, std::ios_base::binary | std::ios_base::in);

    if (!file.is_open() || !file) {
        file.close();
        return false;
    }

    // Skip PNG file signature
    file.seekg(9, std::ios_base::cur);

    // First chunk: IHDR image header
    // Skip Chunk Length
    file.seekg(4, std::ios_base::cur);
    // Skip Chunk Type
    file.seekg(4, std::ios_base::cur);

    __int32 width, height;

    file.read((char*)&width, 4);
    file.read((char*)&height, 4);

    std::cout << file.tellg();

    is.width = width;
    is.height = height;

    file.close();

    return true;
} 
```

例如，如果我尝试[从 Wikipedia 的这张图片](http://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_demonstration_1.png)中阅读，我会得到这些错误的值：

> 252097920（应为800）
> 139985408（应为600）

请注意，该函数*不会*返回 false，因此宽度和高度变量的内容必须来自文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T16:51:13.360

看起来你偏离了一个字节：

```
// Skip PNG file signature
file.seekg(9, std::ios_base::cur); 
```

[PNG 规范](http://www.libpng.org/pub/png/spec/1.2/PNG-Structure.html)说标头长 8 个字节，因此您希望将“9”改为“8”。职位从 0 开始。

另请注意，规范说[整数是网络（大端）顺序](http://www.libpng.org/pub/png/spec/1.2/PNG-DataRep.html#DR.Integers-and-byte-order)，所以如果你在一个小端系统上，你可能想要或需要使用[ntohl()或以其他方式转换字节顺序。](http://linux.die.net/man/3/ntohl)

可能值得使用[libpng](http://www.libpng.org/pub/png/libpng.html)或[stb_image](http://nothings.org/stb_image.c)或类似的东西，而不是尝试自己解析 png——除非你这样做是为了学习。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:51:52.097

当您查看[Portable Network Graphics Technical details](http://en.wikipedia.org/wiki/Portable_Network_Graphics#Technical_details)时，它说签名是 8 个字节而不是 9 个。

另外，您确定您的系统具有与 PNG 标准相同的字节顺序吗？[ntohl(3)](http://linux.die.net/man/3/ntohl)将确保正确的字节顺序。[它](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740069%28v=vs.85%29.aspx)也可用于 Windows。

# javascript - 选择复选框、单选按钮和列表

> ID：14083672
> 
> 赞同：0
> 
> 时间：2012-12-29T16:33:44.913
> 
> 标签：javascript, jquery, html, jquery-mobile

我在使用 jQuery/jQuery Mobile 在运行时检查/选择单选按钮、复选框和列表样式时遇到问题。

基本上我有一个复选框、单选按钮和选择菜单列表，我想做的是从数据库中获取值并从复选框/单选按钮组或选择菜单中选择/勾选正确的项目。

这是我尝试过的简单设置，但它不起作用。

HTML：

```
<fieldset data-role="controlgroup">     
  <input type="radio" name="option_radio" id="option_radio_1" value="1" />
  <label for="option_radio_1">Option 1</label>  
  <input type="radio" name="option_radio" id="option_radio_2" value="2" />
  <label for="option_radio_2">Option 2</label>
</fieldset>

<fieldset data-role="controlgroup">     
  <input type="checkbox" name="option_checkbox" id="option_checkbox_1" value="1" />
  <label for="option_checkbox_1">Option 1</label>   
  <input type="checkbox" name="option_checkbox2" id="option_checkbox_2" value="2" />
  <label for="option_checkbox_2">Option 2</label>   
  <input type="checkbox" name="option_checkbox3" id="option_checkbox_3" value="3" />
  <label for="option_checkbox_3">Option 3</label>
</fieldset>

<select name="option_list" id="option_list">
  <option value="20">20</option>
  <option value="30">30</option>
  <option value="40">40</option>
  <option value="50">50</option>
  <option value="60">60</option>
  <option value="70">70</option>
</select> 
```

JS：

```
$("#option_checkbox_1").val(option_id); 
$("#option_list").val(optionlist_id);
$('input:radio[name=gender]:checked').val(gender_id); 
```

我尝试将数据库中的值（例如 1/2/3/4 等）从数据库直接传递给元素。

谁能告诉我这应该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:42:52.040

要检查它或给出一个值：

```
$('#option_checkbox_1').attr('checked', 'checked');
$('input:radio[id=option_radio_1]').attr('checked', 'checked');
$("#option_list").val(50); 
```

和取消检查（通过完全删除属性）做

```
$('#option_checkbox_1').removeAttr('checked');
$('input:radio[name=gender]:checked').removeAttr('checked'); 
```

我想这就是你想要的

```
$('#option_checkbox_'+option_id).attr('checked', 'checked');
$('input:radio[id='+gender_id+']').attr('checked', 'checked');
$("#option_list").val(optionlist_id); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:48:04.047

`$("#option_checkbox_1").val(option_id);`

这用于将值分配给元素。

你可以`Element with attribute value selector`找到元素。

```
var valueFromDB = "1";
$("input[type='radio']['"+valueFromDB+"']").attr("checked","true");
$("input[type="checkbox"]['"+valueFromDB+"']").attr("checked","true");
$("#option_list option[value="20"]").attr("selected","true"); 
```

另一点。

`id`是一个元素的唯一性。您不能`id`用于多个元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T16:51:54.500

要选择`input`具有特定值的元素：

```
$('input[value=' + valueFromDatabase + ']'); 
```

然后检查/选择该元素：

```
$('input[value=' + valueFromDatabase + ']').prop('checked', true); 
```

当然，这可以与其他选择器（例如`:radio`, 或`:checkbox`）结合使用：

```
$('input:radio[value=' + valueFromDatabase + ']').prop('checked', true); 
```

但是，如果数据库中的值包含*任何*空格，则*必须*在选择器中引用该值，给出：

```
$('input[value="' + valueFromDatabase + '"]'); 
```

（注意`"``valueFromDatabase 周围的字符。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:45:35.280

该 JS 将设置元素的值，它不会检查它们。您要做的是使用 if 语句来查看 radio/checkbox/select 的值是否与您从数据库中提取的字符串的值匹配。如果是这样，那么您想设置要检查/选择的属性，如下所示

```
// checkboxes/radios
$(this).attr('checked','checked')

// options
$(this).attr('selected','selected') 
```

其中 $(this) = 输入或选项

# c# - 如何在 Windows 8 应用程序中访问另一个程序的应用程序数据中的文件？

> ID：14083675
> 
> 赞同：2
> 
> 时间：2012-12-29T16:34:08.540
> 
> 标签：c#, visual-studio, windows-8, microsoft-metro, windows-store-apps

我正在编写一个 Windows 8 应用程序，它需要访问另一个程序的应用程序数据中的文件。我已经阅读了[Window 的文件权限指南](http://msdn.microsoft.com/en-us/library/windows/apps/hh967755.aspx)，但没有找到办法。这甚至可能吗？如果是这样，我将如何去做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:42:15.413

无法使用 winrt API。这就像每个进程的独立存储。

[Windows 应用商店应用程序中的文件访问和权限](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh967755.aspx)

但是使用 Hack 可以绕过沙盒环境。

[如何使用简单的技巧绕过 WinRT / Metro 沙箱。](http://forum.xda-developers.com/showthread.php?t=1541924)[样品+指南](http://suchan.cz/wp7/OutOfSandboxSample.7z)

但是这样的应用程序在提交到 App Store 时不会通过 windows 8 兼容性测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:38:59.617

这在 Windows 商店应用程序中是不可能的，它们是沙盒化的，需要声明访问互联网、相机等类似功能，并且您无法声明要读取其他应用程序数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T16:59:37.420

如果您不知道如何将 .net 用于 Windows 8 存储，这是不可能的。

有了这个，你得到保存位置：

```
using Windows.Storage;
StorageFolder localFolder = ApplicationData.Current.LocalFolder; 
```

有了这个，您可以通过应用 URI 检索数据：

```
using Windows.Storage;
StorageFile file = await StorageFile.GetFileFromApplicationUriAsync("ms-appdata:///local/file.txt"); 
```

来源： http: [//msdn.microsoft.com/en-us/library/windows/apps/xaml/hh967755.aspx ?cs-save-lang=1&cs-lang=csharp#locations_all_apps_can_access](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh967755.aspx?cs-save-lang=1&cs-lang=csharp#locations_all_apps_can_access)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-29T18:45:06.760

我找到了我的答案。我可以告诉用户在文件夹选择器中选择他们的用户文件夹。然后，一旦获得该权限，我就可以以编程方式导航到应用程序数据文件夹中的所需文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-29T17:54:01.763

这个答案取决于其他应用程序和您尝试访问的文件类型，但也许您可以实现对共享合同的支持并告诉 Windows 您愿意接受哪些类型的文件。然后，用户可以选择使用其他应用程序并与您的应用程序共享。我不确定这对您的需求有多可行，但是因为您没有提供有关您要获取哪些数据的详细信息。

# cassandra - Cassandra 多行选择

> ID：14083676
> 
> 赞同：1
> 
> 时间：2012-12-29T16:34:13.373
> 
> 标签：cassandra, phpcassa

我听说在 cassandra 中使用多行选择很糟糕，因为对于每个行选择，它都会运行新查询，所以例如，如果我想一次获取 1000 行，它与一次运行 1000 个单独的查询相同，是吗真的？

如果说我在一分钟内有 1000 次页面浏览量，那么每次加载页面时继续选择大约 50 行会有多糟糕，它会严重减慢 cassandra 的速度吗？

PS我`PHPCassa`用于我的项目

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T19:16:29.350

是的，运行 1000 行查询与运行 1000 行查询相同（如果您使用推荐的`RandomPartitioner`）。但是，我不会对此过分担心。在 Cassandra 中，通过键查询一行是一种非常常见、非常快速的操作。

至于你的第二个问题，很难提前说清楚。构建它并测试它。请注意，Cassandra 确实在内存缓存中使用，因此如果您查询相同的行，那么它们将缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T08:17:18.337

我们为 Cassandra 使用 Playorm，那里有一个“findAll”模式，它支持快速获取所有行。访问 [https://github.com/deanhiller/playorm/wiki/Support-for-retrieving-many-entities-in-parallel](https://github.com/deanhiller/playorm/wiki/Support-for-retrieving-many-entities-in-parallel)了解更多详情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T13:23:56.850

1）我稍微调试了 Cassandra 代码库，根据我的观察，同时查询多行，cassandra 提供了 multiget() 功能，该功能也在 phpcassa 中继承。

2) Multiget 被优化以处理批处理请求，它节省了你的网络跳数。（比如 1k 行会有 1k 往返，所以它肯定减少了 999 往返的时间）

3) 关于 phpcassa 中的 multiget() 的更多信息：[php cassa multiget()](http://thobbs.github.com/phpcassa/api/class-phpcassa.AbstractColumnFamily.html#_multiget)

# jquery - 使用 jQuery 解析 XML

> ID：14083677
> 
> 赞同：0
> 
> 时间：2012-12-29T16:34:14.077
> 
> 标签：jquery, xml, cdata

我有一个真正的大 XML，大小约为 10MB。那个 xml 包含很多 HTML 标签。所以当我想用 jquery 解析那个 xml 时，我想用正确的 HTML 格式得到输出。但我得到了纯文本作为输出..

这是我从 XML 获取数据的 jquery 代码

```
<script type="text/javascript">

$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "finaleve.xml",
        dataType: "xml",
        success: xmlParser
    });
});

function xmlParser(xml) {
    var markup = [];
    $(xml).find("event").each(function () {
        markup.push('<section><section><div class="mainevent" >' + $(this).find("name").text() +': '+$(this).find("tagline").text()+'</div><br><div class="description" >' + $(this).find("description").text() +'</div><br></section>');

        $(this).find("subevent").each(function () {
        markup.push('<section><div class="maineventse">' + $(this).find("namese").text() +': '+$(this).find("taglinese").text()+'</div><br><div class="description1"  >' + $(this).find("descse").text() +'</div><br></section>');

        });
        markup.push('</section>');
    });
        $(".slides").append(markup.join(""));

}

</script> 
```

我知道纯文本是因为 .text().. 但我不知道它的补救措施.. 任何人都可以建议如何使用他们的 HTML 标签获取内容..???

# git - 我可以在不连接远程服务器的情况下从 SVN 导入到 Git 吗？

> ID：14083679
> 
> 赞同：6
> 
> 时间：2012-12-29T16:34:26.810
> 
> 标签：git, svn, git-svn

> **可能重复：**
> [如何 git-svn 从 Subversion 存储库克隆最后 n 个修订？](https://stackoverflow.com/questions/747075/how-to-git-svn-clone-the-last-n-revisions-from-a-subversion-repository)

我正在尝试将托管在大型 WordPress 插件仓库中的 WordPress 插件移至 Git。

我厌倦了使用`git-svn`并且花费的时间太长（单个插件超过 4-5 小时）并且我有将近 20 个插件要迁移。

我的机器上有已签出的 SVN 存储库。`.svn`有什么方法可以让我们只使用存储在文件夹中的历史信息而不连接到 SVN 服务器将 SVN存储库导入 Git ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-29T16:43:04.017

您的机器上没有 SVN*存储库*。你有一个*工作副本*。

与 Git 不同的是，SVN 在检出工作副本时不会下载整个存储库以及整个历史记录。它只是下载文件的最新版本。

所以不，从工作副本中获取 SVN 项目的历史是不可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:55:21.293

### TL;博士

不，但是，您有一些选择。

### Git 和 SVN 历史

Git 和 SVN 处理历史的方式完全不同。当您签出 SVN 存储库时，.svn 目录仅保存最近的提交，以便可以将其与工作目录进行比较或还原。

另一方面，Git 克隆了整个历史。有某些例外，例如[浅克隆](http://www.kernel.org/pub/software/scm/git/docs/git-clone.html)，但对于大多数用途，Git 需要一个完整的存储库来执行诸如显示历史记录或计算差异之类的事情。

If you don't mind a truncated history, you can look at the `--depth` or `--revision` flags for `git-svn`. These flags will allow you to limit the number of revisions you retrieve from the SVN repository, trading history and functionality for speed.

However, while you could import your SVN working copy as a new Git repository, the .svn directories don't hold any actual history. You must connect to the SVN repository to access the history, so you can't import from a working copy.

### Mirror Subversion First

However, you might consider mirroring the Subversion repository and then running `git-svn` locally against your mirror. You will still need a complete copy of your SVN repository, but mirroring the repository takes less time than retrieving Subversion commits one at a time over a network connection with `git-svn`.

请注意，您仍然无法做您想做的事，但这是提高 SVN->Git 迁移速度的另一个可行替代方案。除了速度提升之外，这还将在 Git 方面产生更完整的历史记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:00:34.490

1.  `.svn`工作副本中的 dir 不包含 repo 的完整历史记录，仅包含 WC 中数据的“原始副本”（以及一些额外的元数据） - 如果不与 repo 交互，您将无法获得完整的历史记录
2.  如果你想更快地完成过程，你可以尝试这样做，以本地磁盘空间为代价

建议的工作流程可能是这样的：

*   获取本地（文件：/// 到达）SVN-repos，由插件分隔（一个插件 - 一个 repo）。这样，您将获得（在转换阶段）对源数据的最快访问，并且无需过滤来自存储库的不相关（对于已处理的插件）部分的提交。用于准备清洁`svnadmin dump| svndumpfilter`的垃圾场。`svnrdump | svndumpfilter`可能，一个完整的 svnrdump 并稍后过滤它`cat DUMP| svndumpfilter include`会更加省时；
*   导入上一步准备好的 Git 小仓库。

# java - 评估 Math.tan(Math.acos(0d))

> ID：14083681
> 
> 赞同：0
> 
> 时间：2012-12-29T16:34:43.623
> 
> 标签：java, math

以下陈述不应该成立吗？

```
assertTrue(Double.isNaN(Math.tan(Math.acos(0d)))); 
```

但不是`Double.NaN`Java 返回

```
6.123233995736766 * 10^-17 
```

在我的 64 位机器上。

**编辑：** 这是一个复制和粘贴错误。事实上Java返回`1.633123935319537E16`

我知道这是因为浮点表示，但我的印象是切线函数的那些未定义值会得到与 eg 相同的处理，`Math.sqrt(-1d)`但我猜在这种情况下 java.lang.Math 只是检查是否论据在评估之前是肯定的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:41:25.333

我得到不同的东西。

```
System.out.println(Math.tan(Math.acos(0d)));
// and the tan for the next representable value.
System.out.println(Math.tan(Math.acos(0d) + Math.ulp(Math.acos(0d)))); 
```

印刷

```
1.633123935319537E16
-6.218431163823738E15 
```

64 位浮点数不能准确表示 PI/2（它有无限位数），它表示接近该值的数字，并且该值的 tan() 是有限的。

# java - Intellij Idea 使用什么 JVM 启动？

> ID：14083682
> 
> 赞同：13
> 
> 时间：2012-12-29T16:34:55.817
> 
> 标签：java, intellij-idea, jvm

我是最近决定尝试 Intellij Idea 的 Eclipse 用户。我的操作系统是 Ubuntu 12。

使用 Eclipse 很容易通过在 eclipse.ini (http://wiki.eclipse.org/Eclipse.ini#Specifying_the_JVM) 中指定用于启动 Eclipse 的 JVM。但是我找不到 Intellij Idea 12 这样的东西。

因此，我有两个问题：

1.  Intellij Idea 如何确定使用哪个 JVM 来启动自身？
2.  有没有办法覆盖这个默认行为？

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T16:50:21.893

从你运行的idea.sh

```
# ---------------------------------------------------------------------
# Locate a JDK installation directory which will be used to run the IDE.
# Try (in order): IDEA_JDK, JDK_HOME, JAVA_HOME, "java" in PATH.
# ---------------------------------------------------------------------
if [ -n "$IDEA_JDK" -a -x "$IDEA_JDK/bin/java" ]; then
  JDK="$IDEA_JDK"
elif [ -n "$JDK_HOME" -a -x "$JDK_HOME/bin/java" ]; then
  JDK="$JDK_HOME"
elif [ -n "$JAVA_HOME" -a -x "$JAVA_HOME/bin/java" ]; then
  JDK="$JAVA_HOME"
else
  JAVA_BIN_PATH=`which java`
  if [ -n "$JAVA_BIN_PATH" ]; then
    if [ "$OS_TYPE" = "FreeBSD" ]; then
      JAVA_LOCATION=`JAVAVM_DRYRUN=yes java | "$GREP" '^JAVA_HOME' | "$CUT" -c11-`
      if [ -x "$JAVA_LOCATION/bin/java" ]; then
        JDK="$JAVA_LOCATION"
      fi
    elif [ "$OS_TYPE" = "SunOS" ]; then
      JAVA_LOCATION="/usr/jdk/latest"
      if [ -x "$JAVA_LOCATION/bin/java" ]; then
        JDK="$JAVA_LOCATION"
      fi
    elif [ "$OS_TYPE" = "Darwin" ]; then
      JAVA_LOCATION=`/usr/libexec/java_home`
      if [ -x "$JAVA_LOCATION/bin/java" ]; then
        JDK="$JAVA_LOCATION"
      fi
    fi

    if [ -z "$JDK" -a -x "$READLINK" ]; then
      JAVA_LOCATION=`"$READLINK" -f "$JAVA_BIN_PATH"`
      case "$JAVA_LOCATION" in
        */jre/bin/java)
          JAVA_LOCATION=`echo "$JAVA_LOCATION" | xargs dirname | xargs dirname | xargs dirname` ;;
        *)
          JAVA_LOCATION=`echo "$JAVA_LOCATION" | xargs dirname | xargs dirname` ;;
      esac
      if [ -x "$JAVA_LOCATION/bin/java" ]; then
        JDK="$JAVA_LOCATION"
      fi
    fi
  fi
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:48:47.700

简短的回答：这是由`IDEA_JDK`环境变量设置的。

# ios - UIViewController 子视图存在，但我看到黑屏

> ID：14083683
> 
> 赞同：0
> 
> 时间：2012-12-29T16:34:59.617
> 
> 标签：ios, uiviewcontroller

我有 2 个视图控制器，第一个是故事板（这是根），第二个是 nibles。当我按下根视图控制器中的按钮时，它应该调用第二个控制器。

这是我的第二个视图控制器的代码：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        UILabel *sampleLabel = [[UILabel alloc] initWithFrame: CGRectMake(0,0,100,100)];
        UIImageView * basketItem = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"B.jpg"]];
        [self.view addSubview:sampleLabel];
        [self.view addSubview:basketItem];
        NSLog(@"%@",self.view.subviews);
        sampleLabel.text = @"Main Menu";
    }
    return self;
} 
```

self.view.sebviews 查询显示存在 2 个对象标签和 imageView 对象，但实际上我只看到黑屏。

这是过渡方法

```
- (void)transitionToViewController:(UIViewController *)aViewController
  withOptions:(UIViewAnimationOptions)options
{
      aViewController.view.frame = self.containerView.bounds;
      [UIView transitionWithView:self.containerView
                  duration:0.65f
                   options:options
                animations:^{
                    [self.viewController.view removeFromSuperview];
                    [self.containerView addSubview:aViewController.view];
                }
                completion:^(BOOL finished){
                    self.viewController = aViewController;
                }];    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T16:42:22.470

将代码移入`viewDidLoad`. 在这里，您确定视图已加载到内存中，因此可以进一步自定义。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UILabel *sampleLabel = [[UILabel alloc] initWithFrame: CGRectMake(0,100,100,100)];
    UIImageView * basketItem = [[UIImageView alloc]initWithImage:[UIImage imageNamed:@"B.jpg"]];
    [self.view addSubview:sampleLabel];
    [self.view addSubview:basketItem];
    NSLog(@"%@",self.view.subviews);
    sampleLabel.text = @"Main Menu";    
} 
```

**如果您不使用 ARC，请注意内存泄漏。**

**笔记**

我真的建议为此阅读 Apple 文档。你应该了解事情是如何运作的。希望有帮助。

[http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html)

**编辑**

我不知道问题可能是什么。要使其工作，请尝试重写`loadView`(in `MenuViewController`) 方法，如下所示：

```
- (void)loadView
{
    CGRect applicationFrame = [[UIScreen mainScreen] applicationFrame];
    UIView *contentView = [[UIView alloc] initWithFrame:applicationFrame];
    contentView.backgroundColor = [UIColor redColor]; // red color only for debug purposes
    self.view = contentView;
} 
```

保留`viewDidLoad`我写的方法，看看会发生什么。

创建视图控制器时，仅使用`init`方法。

```
MenuViewController *vc = [[MenuViewController alloc] init]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:37:38.120

你`UILabel`的`frame`有`size.width=0`：

```
CGRectMake(0,100,0,100) 
```

如果`B.jpg`没有添加到项目中，您`UIImageView`也将是空的。

此外，如果 second`UIViewController`没有 XIB，请使用`- (id)init`方法而不是`- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil`.

# xml - xslt php从字符串创建xml

> ID：14083689
> 
> 赞同：1
> 
> 时间：2012-12-29T16:35:34.437
> 
> 标签：xml, string, xslt, php

我使用以下代码将 XML 转换为另一个 XML 文件。但我正在尝试使用 XSLT 从一组字符串创建一个新的 XML 文件。

```
$xsl  = simplexml_load_file('template.xsl');
$xslt = new XSLTProcessor;
$xslt->setParameter('', 'foo', $foo);
$xslt->setParameter('', 'bar', $bar);
$xslt->setParameter('', 'test', $test);

$xslt->importStyleSheet($xsl);

$data = $xslt->transformToXML($xml); 
```

所以我正在做的是将参数传递给`template.xsl`创建节点并将结果输出传递给`$data`PHP 然后将其写入文件。

但我所期望的示例代码首先读取 XML 文件并将其保存到变量`$xml`. 但我没有读取 XML 文件，因为我正在为数据生成字符串，这会产生警告：

> PHP 警告：XSLTProcessor::transformToXml() 期望参数 1 为对象，给定 null

我意识到我可以使用 PHP 来编写 XML - [http://www.developerfusion.com/code/3944/how-to-create-xml-files/](http://www.developerfusion.com/code/3944/how-to-create-xml-files/) - 但我想知道如何使用 XSLT 来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:45:31.073

> 但我没有读取 XML 文件，因为我正在为数据生成字符串，这会生成`'PHP Warning:` X `SLTProcessor::transformToXml() expects parameter 1 to be object, null` `given'`。我意识到我可以使用 PHP 来编写 XML - [http://www.developerfusion.com/code/3944/how-to-create-xml-files/](http://www.developerfusion.com/code/3944/how-to-create-xml-files/) - 但我想知道如何使用 xslt 来做到这一点。

**您可以使用任何 XML 文档作为第一个参数传递`XSLTProcessor::transformToXml()`**

它可以是一个人工文档，例如`<t/>`——从文件中加载。

为了*不加载*任何额外的 XML 文件，可以使用已经加载的 XSLT 文件：

```
 $data = $xslt->transformToXML($xsl); 
```

在转换中，您将有一个模板（匹配`/`），在此模板中，您将生成所需的 XML 文档 - 结果。

# c# - 如何在google drive api中进行一次身份验证

> ID：14083692
> 
> 赞同：3
> 
> 时间：2012-12-29T16:35:53.487
> 
> 标签：c#, c#-4.0, google-drive-api

我有这个关于谷歌驱动器的问题。这是我的申请 ![在此处输入图像描述](../Images/8b6f66bd857d3cb43ab6a943362f82a0.png)

正如你在这里看到的。我想浏览并将文件上传到谷歌驱动器。但是每次我上传文件时，我都需要允许并将身份验证复制到我的应用程序中......就像这里

![在此处输入图像描述](../Images/ece06f8186b3dadbc56fca641e0b3e5f.png)

是否可以允许访问一次？有没有其他方法可以解决这个问题？我可以自动允许访问我的应用程序中的身份验证代码，这样我就不能使用浏览器了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:24:24.700

如果您正在运行服务器应用程序，如何使用 OAuth2？您不需要使用用户控制台。

```
GoogleCredentials credentials = new GoogleCredential.Builder()
     .setTransport(HTTP_TRANSPORT)
     .setJsonFactory(JSON_FACTORY)
     .setServiceAccountId("[[SERVICE_ACCOUNT_EMAIL]]")
     .setServiceAccountScopes(DriveScopes.DRIVE, DriveScopes.DRIVE_FILE,
         "https://www.googleapis.com/auth/userinfo.email",
         "https://www.googleapis.com/auth/userinfo.profile")
     .setServiceAccountPrivateKeyFromP12File(Auth.keyFile)
     .setServiceAccountUser("[[impersonateduser@domain]]")
     .build();
credentials.refreshToken(); 
```

我发现了这个关于 OAuth2 的博客：

[http://blog.databigbang.com/automated-browserless-oauth-authentication-for-twitter/](http://blog.databigbang.com/automated-browserless-oauth-authentication-for-twitter/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-08T01:27:34.290

您需要请求的是“离线”访问。这将为您提供一个刷新令牌，您可以使用它来永久获取新的访问令牌，或者直到用户撤销它。

有关 .NET 示例，请参阅[https://developers.google.com/drive/credentials](https://developers.google.com/drive/credentials)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T08:37:37.923

请查看**Authorizing with stored credentials** in [Authorization for Google Drive](https://developers.google.com/drive/about-auth)。基本上，只要存储的 access_token 未过期，您就可以访问该帐户。

# asp.net-mvc-3 - 类库数据库连接字符串

> ID：14083694
> 
> 赞同：1
> 
> 时间：2012-12-29T16:36:01.443
> 
> 标签：asp.net-mvc-3, shared-libraries, connection-string

我有一个使用相同域模型的多个项目的解决方案。因此，我创建了一个包含我的领域模型的类库。这个类库还包含在我的项目中使用的其他参数。然后，我在每个项目中添加对类库的引用。我的类库也有一些从[这个示例](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)派生的存储库类。

但是，我在连接数据库时遇到问题。我希望我的类库能够连接到数据库，因为我在那里定义了我的数据库上下文类，在那里我设置了我的数据库集。对于单个项目，我通常在 web.config 文件中定义我的连接字符串。但是类库没有 web.config 文件。如何设置我的连接字符串？

编辑

假设我有我的数据库上下文的构造函数，mydbcontext，在类库中定义为

```
public mydbcontext() : base(ConfigurationManager.ConnectionStrings["DatabaseCon"].ConnectionString)
    {

    } 
```

如果我理解正确，将每个项目的连接字符串的名称设置为“DatabaseCon”是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:38:32.940

你没有。

将连接字符串作为依赖项传递给需要它的任何类。

你可以封装对它的访问——但你应该在任何使用这个库的程序中实例化它。该程序将在其配置中保存连接字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:38:13.500

您应该在使用类库的应用程序的 web.config 文件中定义连接字符串。作为替代方案，您可以将连接字符串硬编码到`DbConext`类库内部的构造函数中 - 非常糟糕的方法，因为您将无法从外部修改它 - 例如，您将很难为不同的连接字符串管理环境 - 登台，生产，...

# java - 如何正确关闭光标 Android Java

> ID：14083698
> 
> 赞同：-1
> 
> 时间：2012-12-29T16:36:15.263
> 
> 标签：java, android

如果我尝试使用`onSets.close();`in 方法关闭光标`getData()`，则数据不会出现在该位置。如果我不关闭游标方法，则 Eclipse 会抱怨并说基础或游标未关闭。但是如果我`c.moveToFirst();`在方法中添加一行`getSets(String toexes_ids, String toprog_dif)`，则不会出现错误。这是为什么？我有两种方法：

MyDatabase.java 中的一种方法

```
public Cursor getSets(String toexes_ids, String toprog_dif) {
  SQLiteDatabase db = getReadableDatabase();
  SQLiteQueryBuilder qb = new SQLiteQueryBuilder();     
  String [] sqlSelect = {"_id", "exes_ids", "sets_ids", "sets_weight", "sets_ones"}; 
  String sqlTables = "Sets";
  String selection = "exes_ids = " + toexes_ids + " AND " + "prog_dif = " + toprog_dif;
  qb.setTables(sqlTables);
  Cursor c = qb.query(db, sqlSelect, selection, null, null, null, null);
  c.moveToFirst();
  return c;
  } 
```

MainActivity.java 中的第二种方法

```
public void getData() {
  db = new MyDatabase(this);
  onSets = db.getSets(toexes_ids, toprog_dif);
  ListAdapter adapter = new SimpleCursorAdapter(this, 
    R.layout.itemsets, onSets, 
    new String[] {"sets_ids", "sets_weight", "sets_ones"},  
    new int[] {R.id.itemsets_ids, R.id.itemsets_weight, R.id.itemsets_ones});
  listSets.setAdapter(adapter);
  db.close();
    } 
```

错误：

```
12-29 16:17:09.335: D/dalvikvm(571): GC_CONCURRENT freed 393K, 53% free 2759K/5767K, external 1574K/1802K, paused 5ms+10ms
12-29 16:17:09.355: E/Database(571): close() was never explicitly called on database '/data/data/com.exp.exp_betta/databases/fitsdbsqlite3' 
12-29 16:17:09.355: E/Database(571): android.database.sqlite.DatabaseObjectNotClosedException: Application did not close the cursor or database object that was opened here
12-29 16:17:09.355: E/Database(571): at android.database.sqlite.SQLiteDatabase.<init>(SQLiteDatabase.java:1847) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:47:00.083

### 尝试从数据库连接中获取数据后立即关闭它。保持打开状态会导致数据库泄漏，这就是 Eclipse 抛出错误 For not closed DatabaseObjectNotClosedException 的原因

```
public Cursor getSets(String toexes_ids, String toprog_dif) {
  SQLiteDatabase db=getReadableDatabase();
  //Querying the database
   db.close(); //as you get the cursor you can now close the connection here.
  return cursor;
 }

public void getData()
 {
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:47:50.850

我认为您需要关闭在 getSets() 方法中创建的数据库实例

# python - 如何使用pygame在python中找到文件的确切位置？

> ID：14083701
> 
> 赞同：1
> 
> 时间：2012-12-29T16:36:53.520
> 
> 标签：python, file, directory, pygame

我需要为我在 python 中使用 pygame 制作的游戏的图像的确切目录。我知道文件夹和文件的名称，但不知道我的用户放在哪里。请帮忙，没有你们，我将无法继续我的项目:(我要查找的文件与 .py 位于同一文件夹中，并且是 .bmp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:20:10.883

如果您知道相对于 python 模块在文件系统中存储位置的路径（正如您似乎指出的那样），您可以使用以下方法计算 abs 路径，然后从那里建立适当的路径。

```
import os
print(os.path.abspath(__file__))
print(os.path.split(os.path.abspath(__file__))) 
```

注意：更改 python2.7 的打印

用于`os.path.join`构建新路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:13:10.617

也许看看[os.path](http://docs.python.org/2/library/os.path.html)文档页面，尤其是`os.path.abspath`.

# java - 在 1 台机器上运行 2 个 JBoss 实例。运行本机命令时出现“空间不足”错误

> ID：14083702
> 
> 赞同：0
> 
> 时间：2012-12-29T16:37:09.277
> 
> 标签：java, unix, memory, jboss, java-native-interface

我们有一个 64 位 JBoss 实例，它部署了一个轴 Web 服务，它只是运行本机可执行命令的前端。当调用 Web 服务时，它会执行这个本机可执行命令。64 位实例使用 3gb 内存运行。

我们最近介绍了在同一台物理机上运行的第二个 JBoss 实例。它以 32 位模式运行，因为它必须运行一些 JNI 32 位代码。JBoss 的第二个实例绑定到 ports-01，因此它在 8180 上运行（基本上是默认 JBoss 端口的 +100）。此实例使用 512MB 内存运行。

自从引入第二个 JBoss 实例后，当 64 位实例在调用时尝试执行本机可执行命令时，我们会收到“空间不足”错误消息。这是来自 java 的 IOException，来自 unix forkAndExec 命令。我读到的所有内容都说这与交换文件大小有关。使用 unix, top 命令，看起来交换文件的大小永远不会改变，它是 3gb。当我们首先运行 64 位实例时，这似乎没有问题，但如果先启动 32 位实例，则会出现此错误。我想知道这两个实例是否在争夺资源，或者我们是否真的用完了来自 unix 的交换空间。我不确定 JBoss 是否使用交换空间以及它使用了多少，或者 Java 是否处理它？

我想我正在寻找有关此问题的解决方案的任何想法或建议。我似乎看到的主要模式是，如果 64 位实例首先启动，则本机可执行文件可以正常工作，但如果 32 位实例首先启动，则会出现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T18:26:21.833

毕竟这是一个交换空间问题。我们有 8GB 的​​内存和 4GB 的交换空间。一台服务器使用 800MB 的交换空间，另一台使用 3.8GB 的​​交换空间，这几乎没有超过我们的限制。

我们不得不使用 swap -s 来查看可用的交换空间大小，而不是在 unix 中使用“top”命令，这样更准确。

我们使用 mkfile 10240M /opt/myswapfile 之类的命令创建了一个临时交换文件。然后我们使用命令 swap -a /opt/myswapfile 将它添加到服务器上的交换区域。

现在他们似乎合作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:48:28.070

操作系统处理交换空间，Java 不知道这些东西。在任何情况下，在交换空间中运行 Java 的任何部分都是一个非常糟糕的主意。

我会确保这两个程序运行后有足够的主内存（不仅仅是堆，还有这些进程使用的总内存）

# asp.net-mvc - 图像未在 asp.net mvc 4 中加载

> ID：14083703
> 
> 赞同：1
> 
> 时间：2012-12-29T16:37:12.507
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我真的很抱歉问这个问题。这是我试图解决一个问题的几个小时。我是 ASP.NET MVC 的新手。我有一个 css 文件，我在其中引用了两个图像。这是代码：

```
.white
{
    background-image: url("images/site/glyphicons-halflings-white.png");
}
.normal
{
    background-image: url("images/site/glyphicons-halflings.png");
} 
```

我还将这些图像添加到`Content\images\site`文件夹中。但它不加载图像并且 css 不起作用。我可以在 firebug 中看到这些错误消息：

> NetworkError: 404 Not Found -http://localhost:38544/Content/images/site/glyphicons-halflings.png"
> 
> 网络错误：404 未找到 -http://localhost:38544/Content/images/site/glyphicons-halflings-white.png"

提前感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T17:01:55.200

404 错误非常强烈地表明您在 CSS 中拼错了图像文件名或忘记实际复制指定文件夹中的图像。

# c# - 从 c# dll 调用/编组字符串到非托管代码

> ID：14083705
> 
> 赞同：0
> 
> 时间：2012-12-29T16:37:24.113
> 
> 标签：c#, string, metatrader4

我正在尝试从非托管的第 3 方应用程序调用 dll 中的 ac# 函数 - metatrader

我遵循了[从非托管代码调用 C# dll 的](http://www.mql5.com/en/articles/249 "这里")建议， 但是关于编组字符串的示例不起作用。

注意：我已经成功地从参考中调用了整数加法示例（函数“Add”），它端到端地工作没有问题，所以我知道问题与字符串有关。即，“ReplaceString”功能不起作用。我还查看了 RobertGisiecke 网站，但那里没有字符串示例，或者我太笨了，无法弄清楚。

我在 metatrader 中收到的错误消息是：

2009.11.10 00:01 15:27:40 MT4LibTest EURUSD，H1：从 040B031B 的 dll 'Testme.dll' 严重错误 c0000005 调用函数'ReplaceString'。

平台是 Windows Server 2012 (64bit) 我已经编译到 x86 因为 Metatrader 是一个 x86 程序

还有一件事：我对VS世界不是很有经验，所以我希望有人能提供帮助

谢谢

C#代码：

```
[DllExport("ReplaceString", CallingConvention = CallingConvention.StdCall)]
    public static int ReplaceString(
        [In, Out, MarshalAs(UnmanagedType.LPWStr)] StringBuilder str,
        [MarshalAs(UnmanagedType.LPWStr)]string a, 
        [MarshalAs(UnmanagedType.LPWStr)]string b)
    {
        str.Replace(a, b);

        if (str.ToString().Contains(a)) return 1;
        else 
            return 0;
    } 
```

调用函数（Metatrader）：

```
#import "MT4Lib.dll"
    int ReplaceString(string & str,string a,string b);
    int Add(int x, int y);
#import
    string str="A quick brown fox jumps over the lazy dog";
    string stra = "fox";
    string strb = "cat";        

    Print(str);
    Print(ReplaceString(str,stra,strb));
    Print(str); 
```

编辑：我应该明确一点，允许编写“脚本”的 metatrader API 不允许完整的 C++ 类型。所以没有 char，没有 wchar，当然也没有指向这些类型的指针。只有“字符串”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T16:09:24.707

找到解决方案！

首先，感谢所有回复的人。掌握新技术（对我来说）有点挑战）。@Jim：请参阅我添加的编辑。MQL（metatrader 语言）可能基于 C++，但已受到应用程序设计者的严重束缚。所以没有 wchar 类型。@Simon：添加对 NuGet 包“UnmanagedExports”的引用将为您放置包装器并处理 CIL 修复，因此您可以专注于您的代码。我在问题中包含的链接详细说明了这一点。

代码有两个问题：

1.  在给出的示例代码中，c# 函数中的字符串参数被声明为 LPWStr（宽字符串）。在调试器中查看它们显示它们中有中文字符。LPStr 工作正常。

    ```
    public static int ReplaceString(
        [In, Out, MarshalAs(UnmanagedType.LPStr)] StringBuilder str,
        [MarshalAs(UnmanagedType.LPStr)]string a, 
        [MarshalAs(UnmanagedType.LPStr)]string b) 
    ```

2.  示例代码还有一个指向在调用者（本机）代码中声明为参数的字符串的指针。删除它，并使用 StringBuilder 类更改托管 c# 代码中的字符串，工作正常。

    ```
    #import "MT4Lib.dll"
        int ReplaceString(string str,string a,string b);
        int Add(int x, int y);
    #import 
    ```

# c - 遍历具有非标准字符的 char 数组

> ID：14083706
> 
> 赞同：2
> 
> 时间：2012-12-29T16:37:35.470
> 
> 标签：c, arrays

**编辑：** 我只能使用 stdio.h 和 stdlib.h

我想遍历一个充满字符的字符数组。

然而，像 ä,ö 这样的字符占用了两倍的空间并使用了两个元素。这就是我的问题所在，我不知道如何访问那些特殊字符。

在我的示例中，字符“ä”将使用 hmm[0] 和 hmm[1]。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main()
{
  char* hmm = "äö";

  printf("%c\n", hmm[0]); //i want to print "ä"

  printf("%i\n", strlen(hmm));

  return 0;
} 
```

谢谢，我试图在 Eclipse 中运行我的附加代码，它在那里工作。我假设是因为它使用 64 位并且“ä”有足够的空间来容纳。strlen 确认每个“ä”仅计为一个元素。所以我想我可以以某种方式告诉它为每个字符分配更多空间（所以“ä”可以适合）？

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
 char* hmm = "äüö";

  printf("%c\n", hmm[0]);
  printf("%c\n", hmm[1]);
  printf("%c\n", hmm[2]);

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:43:00.370

一个字符总是使用一个字节。

在您的情况下，您认为“ä”是一个字符：错误。使用十六进制查看器打开您的 .c 源代码，您将看到 ä 使用 2 个字符，因为该文件以 UTF8 编码

现在的问题是你想使用宽字符吗？

```
#include <stdio.h>
#include <stdlib.h>
#include <wchar.h>
#include <locale.h>

int main()
{
    const wchar_t hmm[] = L"äö";

    setlocale(LC_ALL, "");
    wprintf(L"%ls\n", hmm);
    wprintf(L"%lc\n", hmm[0]);
    wprintf(L"%i\n", wcslen(hmm));

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:08:04.970

您的数据采用多字节编码。因此，您需要使用多字节字符处理技术来划分字符串。例如：

```
#include <stdio.h>
#include <string.h>
#include <locale.h>

int main(void)
{
    char* hmm = "äö";
    int off = 0;
    int len;
    int max = strlen(hmm);

    setlocale(LC_ALL, "");

    printf("<<%s>>\n", hmm);
    printf("%zi\n", strlen(hmm));

    while (hmm[off] != '\0' && (len = mblen(&hmm[off], max - off)) > 0)
    {
        printf("<<%.*s>>\n", len, &hmm[off]);
        off += len;
    }

    return 0;
} 
```

在我的 Mac 上，它产生了：

```
<<äö>>
4
<<ä>>
<<ö>> 
```

呼吁`setlocale()`至关重要；没有它，程序在“C”语言环境而不是我的`en_US.UTF-8`语言环境中运行，并且`mblen()`处理不当：

```
<<äö>>
4
<<?>>
<<?>>
<<?>>
<<?>> 
```

出现问号是因为就 UTF-8 终端而言，正在打印的字节是无效的单个字节。

您还可以使用宽字符和宽字符打印，如[benjarobin](https://stackoverflow.com/users/808101/benjarobin)的[答案](https://stackoverflow.com/a/14083757/15168)所示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-30T07:17:47.333

抱歉拖到这里。虽然我认为强调一些问题很重要。据我了解，OS-X 能够将默认 OS 代码页设置为 UTF-8，因此答案主要是关于在后台使用 UTF-16 的 Windows，其默认 ACP 代码页取决于指定的操作系统区域。

首先你可以打开Character Map，找到
äö

两者都位于代码页 1252（西部）中，因此这**不是**MBCS 问题。可能是 MBCS 问题的唯一方法是使用 MBCS（Shift-JIS、Big5、Korean、GBK）编码保存文件。

使用
setlocale( LC_ALL, "" )的答案

没有深入了解 äö 在命令提示符窗口中错误呈现的原因。

命令提示符确实使用自己的代码页，即 OEM 代码页。[这](http://msdn.microsoft.com/en-US/goglobal/bb964655.aspx)是对以下 (OEM) 代码页及其字符映射的参考。

进入命令提示符并键入以下命令 [(Chcp)](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/chcp.mspx?mfr=true)将显示命令提示符正在使用的当前 OEM 代码页。

通过使用 setlocal(LC_ALL,"") 遵循 Microsoft 文档，它详细说明了以下行为。

> 设置语言环境（LC_ALL，“”）；
> 将语言环境设置为默认值，即从操作系统获取的用户默认 ANSI 代码页。

您可以手动执行此操作，方法是使用 chcp 并传递您所需的代码页，然后运行您的应用程序，它应该可以完美地输出文本。

**如果**这是一个多字节字符集问题，那么将会有其他问题的完整列表：

> 在 MBCS 下，字符被编码为一个或两个字节。在双字节字符中，第一个或“前导字节”表示它和后面的字节都将被解释为一个字符。第一个字节来自保留用作前导字节的一系列代码。哪些字节范围可以是前导字节取决于使用的代码页。例如，日语代码页 932 使用 0x81 到 0x9F 范围作为前导字节，但韩语代码页 949 使用不同的范围。

看看情况，长度是 4 而不是 2。我会说文件格式已保存为 UTF-8（它实际上可以保存为 UTF-16，尽管您会很快遇到问题稍后与编译器一起使用）。您使用的字符不在 0 到 127 的 ASCII 范围内，UTF-8 将 Unicode 代码点编码为两个字节。您的编译器正在打开文件并假定它是您的默认操作系统代码页或 ANSI C。解析字符串时，它会将字符串解释为 ANSI C 字符串 1 字节 = 1 个字符。

为了解决这个问题，在 windows 下将 UTF-8 字符串转换为 UTF-16 并使用 wprintf 打印。目前没有对 Ascii/MBCS stdio 函数的原生 UTF-8 支持。

对于 Mac OS-X，它具有 UTF-8 的默认 OS 代码页，那么我建议遵循 Jonathan Leffler 解决问题的方法，因为它更优雅。虽然如果您稍后将其移植到 Windows，您会发现您需要使用下面的示例将字符串从 UTF-8 转换为 UTF-16。

在任一解决方案中，您仍然需要将命令提示符代码页更改为您的操作系统代码页，以正确打印 ASCII 以上的字符。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <Windows.h>
#include <locale>

// File saved as UTF-8, with characters outside the ASCII range
int main()
{
    // Set the OEM code page to be the default OS code page
    setlocale(LC_ALL, "");

    // äö reside outside of the ASCII range and in the Unicode code point Western Latin 1
    // Thus, requires a lead byte per unicode code point when saving as UTF-8
    char* hmm = "äö";

    printf("UTF-8 file string using Windows 1252 code page read as:%s\n",hmm);
    printf("Length:%d\n", strlen(hmm));

    // Convert the UTF-8 String to a wide character
    int nLen = MultiByteToWideChar(CP_UTF8, 0,hmm, -1, NULL, NULL);
    LPWSTR lpszW = new WCHAR[nLen];
    MultiByteToWideChar(CP_UTF8, 0, hmm, -1, lpszW, nLen);

    // Print it
    wprintf(L"wprintf wide character of UTF-8 string: %s\n", lpszW); 

    // Free the memory
    delete[] lpszW;

    int c = getchar();
    return 0;
}

UTF-8 file string using Windows 1252 code page read as:Ã¤Ã¶
Length:4
wprintf wide character of UTF-8 string: äö 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T16:48:12.210

我会检查您的命令提示符字体/代码页，以确保它可以显示您的操作系统单字节编码。注意命令提示符有自己的代码页，与您的文本编辑器不同。

# mysql - MySQL Load Data Infile 自动递增 ID 值

> ID：14083709
> 
> 赞同：8
> 
> 时间：2012-12-29T16:37:44.533
> 
> 标签：mysql, indexing, auto-increment, load-data-infile

我想在我的表中插入一个 ID 列并从文本文件中获取该表的数据。例如我的文本文件是这样的：

```
12    1212    4989    121
121   23      123     110
789   99      234     544
... 
```

它有大约 20M 行。我想将此数据插入到表中，并为其包含一个自动递增的 ID 值列。我将使用“加载数据文件”，但我想创建我的表，如下所示：

```
id    a     b       c       d
---   ---   ---     ---     ---  
1    12    1212    4989    121
2    121   23      123     110
3    789   99      234     544
... 
```

如何使用 mysql (workbench) 创建这种表

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-29T16:55:55.157

首先，创建具有列 ID 的表具有自动增量属性：

```
CREATE TABLE mytable (
     id MEDIUMINT NOT NULL AUTO_INCREMENT,
     a INT NULL,
     b INT NULL,
     c INT NULL,
     d INT NULL,
     PRIMARY KEY (id)
) ENGINE=MyISAM; 
```

那么您应该通过给出列名将数据加载到带有加载数据文件的表中：

```
LOAD DATA LOCAL INFILE 'C:/DATA/mydata.txt'
INTO TABLE test.mytable
FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n'
(a, b, c, d) SET ID = NULL; 
```

请参阅：[如何在 mysql 中加载数据输入文件，第一个列是自动增量？](https://stackoverflow.com/questions/6017032/how-to-load-data-infile-in-mysql-with-first-col-being-auto-increment)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T16:53:13.003

这可以为你做..

```
 load data local infile 'data.csv' into table tbl fields terminated by ','
     enclosed by '"'
     fields terminated by '\t'
     lines terminated by '\n'
     (a,b,c,d) 
```

如需更多参考，请参阅[此链接](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)

# eclipse - eclipse + maven + tomcat7 + wtp，选中“服务模块而不发布”时无法启动项目

> ID：14083711
> 
> 赞同：1
> 
> 时间：2012-12-29T16:37:48.980
> 
> 标签：eclipse, maven, tomcat7, eclipse-wtp

我在 github 上的项目：[https ://github.com/henryyan/kft-activiti-demo](https://github.com/henryyan/kft-activiti-demo)

一般不勾选“Serve modules without publishing”，项目就可以启动了。检查发生错误后（Tomcat6 没问题！！！）：

> 引起：java.io.FileNotFoundException：/Users/henryyan/work/projects/activiti/kft-activiti-demo/src/main/webapp/WEB-INF/classes/applicationContext.xml（没有这样的文件或目录）

**为什么要从“ src** ”中找到文件“applicationContext.xml” ，它应该是目标/类。

完整日志：[https ://gist.github.com/4407208](https://gist.github.com/4407208)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T21:03:43.977

我认为您需要在 maven-war-plugin 中将资源添加为 Web 资源：

```
<plugin>
   <artifactId>maven-war-plugin</artifactId>
   <version>2.1.1</version>
   <configuration>
      <webResources>
         <resource>                      
            <directory>src/main/resources</directory>
            <filtering>true</filtering>
         </resource>
      </webResources>
   </configuration>
</plugin> 
```

# android - 操作栏选项卡随平板电脑方向变化

> ID：14083712
> 
> 赞同：1
> 
> 时间：2012-12-29T16:37:51.430
> 
> 标签：android, tabs, android-fragments, screen-orientation

我有一个活动，里面有一些片段。

当将平板电脑的方向更改为垂直时，就会出现我的问题。操作栏选项卡更改，并且在更改方向时不保持不变。

当更改方向时，其他片段选项卡消失，我不知道为什么。我发两张图。更改前的第一个和更改后的第二个。

这是一些代码....

![在此处输入图像描述](../Images/658cd4cefc320f86b6e647bba57853a2.png)

![在此处输入图像描述](../Images/611b610a2435fa5788f127026dfd1a38.png)

```
 @Override
public void onTabSelected(CompatTab tab, FragmentTransaction ft) {
    Fragment fragment = tab.getFragment();
    //Fragment fragment = mActivity.getSupportFragmentManager().findFragmentByTag(TAB_MAIN);
    if(fragment==null){
        fragment = Fragment.instantiate(mActivity, mClass.getName());
        tab.setFragment(fragment);
        ft.add(android.R.id.tabcontent, fragment, tab.getTag());
    }else{
        ft.attach(fragment);
    }       
}

  Inside the manifest....
     <activity android:name="ClientEditActivity"
              android:configChanges="orientation|screenSize"
              android:screenOrientation="unspecified"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T11:47:11.473

因此，当您旋转屏幕时，Android 会销毁所有活动并重建它们。也许您需要检查您的代码以查看是否某些 Activity 创建/销毁 ActionBar 上的按钮。

你能把创建ActionBar的代码放上去吗？

# c# - 变量的初始化：直接还是在构造函数中？

> ID：14083714
> 
> 赞同：12
> 
> 时间：2012-12-29T16:37:56.637
> 
> 标签：c#, initialization

> **可能重复：**
> [最佳实践：在构造函数或声明中初始化类字段？](https://stackoverflow.com/questions/24551/best-practice-initialize-class-fields-in-constructor-or-at-declaration)

大多数时候，我看到像这样初始化变量的方式

```
public class Test
{
    private int myIntToInitalize;

    public Test()
    {
        myIntToInitalize = 10;
    }
} 
```

从我的角度来看，这是初始化变量的最通用方法。书籍、博客以及 .NET 的内部实现中的大多数代码都与我的示例等效。

最近看到有人直接做初始化，所以没有在构造函数中设置值。

```
public class Test
{
    private int myIntToInitalize = 10;
} 
```

从这个角度来看，初始化和声明变量或在构造函数中初始化变量没有区别。

除了最佳实践和代码行长度之外，直接初始化变量的好处在哪里，是否存在细微差别？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-29T16:49:46.507

在某些情况下，存在一个潜在的显着差异。

实例初始化程序在基类构造函数执行*之前执行。*因此，如果基类构造函数调用在派生类中被覆盖的任何虚拟方法，该方法将看到差异。*然而，通常*这不应该是一个明显的区别—​​—因为在构造函数中调用虚方法几乎总是一个坏主意。

就清晰而言，如果您在声明点初始化变量，则很清楚该值*不*依赖于任何构造函数参数。另一方面，将所有初始化放在一起也有助于可读性，IMO。我会*尽量*确保，如果您有多个构造函数，它们都委派给一个“主”构造函数，该构造函数会执行所有“真正的”初始化——这意味着无论哪种方式，您都只会将这些分配放在一个地方。

演示差异的示例代码：

```
using System;

class Base
{
    public Base()
    {
        Console.WriteLine(ToString());
    }
}

class Derived : Base
{
    private int x = 5;
    private int y;

    public Derived()
    {
        y = 5;
    }

    public override string ToString()
    {
        return string.Format("x={0}, y={1}", x, y);
    }
}

class Test
{
    static void Main()
    {
        // Prints x=5, y=0
        new Derived();
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-29T16:40:26.250

我不知道任何细微的差异。我通常喜欢将所有初始化都放在构造函数中，因为我认为它使代码更具可读性。但这更多是一种风格选择和个人喜好。我还没有听说过以一种或另一种方式证明它的技术原因。我怀疑对性能有任何影响。

静态常量和最终常量是另一回事。我在线初始化那些。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-29T16:41:14.443

构造实例时，在声明时初始化的任何变量都将在构造函数运行之前初始化。如果您不访问这些变量或在构造函数本身中使用它们的值，那么这两种方法之间没有功能差异。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-29T17:08:39.140

假设我们在发布和优化构建下编译以下代码

```
namespace ConsoleApplication4
{

    public class Test1
    {
        private int myIntToInitalize;

        public Test1()
        {
            myIntToInitalize = 10;
        }
    }

    public class Test2
    {
        private int myIntToInitalize = 10;
    }

    static class Program
    {

        private static void Main()
        {
        }

    }

} 
```

类 Test1 的 IL 说明

```
.class public auto ansi beforefieldinit Test1
    extends [mscorlib]System.Object
{
    .method public hidebysig specialname rtspecialname instance void .ctor() cil managed
    {
        .maxstack 8
        L_0000: ldarg.0 
        L_0001: call instance void [mscorlib]System.Object::.ctor()
        L_0006: ldarg.0 
        L_0007: ldc.i4.s 10
        L_0009: stfld int32 ConsoleApplication4.Test1::myIntToInitalize
        L_000e: ret 
    }

    .field private int32 myIntToInitalize

} 
```

类 Test2 的 IL 指令

```
.class public auto ansi beforefieldinit Test2
    extends [mscorlib]System.Object
{
    .method public hidebysig specialname rtspecialname instance void .ctor() cil managed
    {
        .maxstack 8
        L_0000: ldarg.0 
        L_0001: ldc.i4.s 10
        L_0003: stfld int32 ConsoleApplication4.Test2::myIntToInitalize
        L_0008: ldarg.0 
        L_0009: call instance void [mscorlib]System.Object::.ctor()
        L_000e: ret 
    }

    .field private int32 myIntToInitalize

} 
```

很明显，两个类都有相同数量的 IL 指令，唯一的区别是，

在调用 Test1 类中的 ::ctor() 之前初始化变量；并且变量在调用类 Test2 中的 ::ctor() 后被初始化；

**注意**：性能方面，两个类的性能相同，因为它们具有相同数量和类型的 IL 指令，只是 IL 指令的执行顺序不同

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-29T16:51:08.180

对于您的简单示例，这只是样式问题。

涉及继承时存在细微差别。对于实例字段初始化器，执行顺序是派生类字段初始化器、基类字段初始化器、基类构造器、派生类构造器。

拿这个样本：

```
public class Program
{
    public static void Main(string[] args)
    {
        new Derived();
    }
 }

 public class Base 
 {
     private int x = BaseInitializer();

     public Base()
     {
          Console.WriteLine("Base ctor");
     }

     private static int BaseInitializer()
     {
         Console.WriteLine("BaseInitializer");
         return 0;
     }
 }

 public class Derived : Base
 {
     private int x = DerivedInitializer();

     public Derived() : base()
     {
         Console.WriteLine("Derived ctor");
     }

     private static int DerivedInitializer()
     {
         Console.WriteLine("DerivedInitializer");
         return 0;
     }
 } 
```

它打印：

*   派生初始化器
*   基础初始化器
*   碱基
*   派生的ctor

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-29T16:54:30.187

```
public class Test
{
    private int myIntToInitalize = 10;
    public Test()
    {

    }

    public Test(string x)
    {
    }
}

public class Test2
{
    private int myIntToInitalize;
    public Test2()
    {
        this.myIntToInitalize = 10;
    }

    public Test2(string x)
    {
    }
} 
```

在 Test1 类上，每个对象实例都将 myIntToInitalize 设置为 10，但在 Test2 类上，当您调用需要 1 个参数的构造函数时，则不会。

# actionscript-3 - 查询组件是否在位置 X, Y

> ID：14083722
> 
> 赞同：0
> 
> 时间：2012-12-29T16:38:57.360
> 
> 标签：actionscript-3, apache-flex, flex4.5, flexbuilder

我在 15x15 的板上有一组盒子。

我只有一个事件监听器可以捕获触摸事件，一旦用户点击屏幕，我需要知道哪个框最接近事件给出的坐标 (x, y)。

获得它的更好方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:21:02.063

只需取 x 和 y 位置的差值并将它们平方。取最小的**d**。

```
dx = x1 - x2;
dy = y1 - y2;
d = dx^2 + dy^2; 
```

两个 x 和 y 将是框和当前接触点（使用`.localX`和`.localY`属性）。

这是一个示例代码，它可能拥有您所需要的一切：

```
board.addEventListener(TouchEvent.TOUCH_TAP,function(e) {

    var minVal:int = int.MAX_VALUE;     
    var minBox:Sprite = null;

    for(var i=0; i<board.numChildren; i++) {
        var box:Sprite = board.getChildAt(i);
        var d:int = Math.pow(box.x-e.localX ,2) + Math.pow(box.y-e.localY,2);  
        if(minVal > d) {minVal = d; minBox = box; }
    }

    // You have the minimum value & closest box reference here

}); 
```

# javascript - 主干删除视图删除el

> ID：14083724
> 
> 赞同：24
> 
> 时间：2012-12-29T16:39:14.383
> 
> 标签：javascript, jquery, backbone.js, backbone-views

我正在创建一个单页应用程序，而且我对骨干很陌生。我在创建使用相同 wrapper-div 的多个视图时遇到问题。

**我的设置：**

我为所有视图添加了关闭功能：

```
Backbone.View.prototype.close = function(){
    this.remove();
    this.off();
    if (this.onClose){
        this.onClose();
    } 
} 
```

我有一个 wrapper-div，我想在其中渲染视图、删除它们并渲染新视图。所以我的 SetupView 看起来像这样：

```
app.SetupView = Backbone.View.extend({
    el: '#my_view_wrapper',
    ...
}); 
```

从交换视图的功能中，我关闭当前（打开）视图，如下所示：

```
var v = this.model.get('view');
v.close(); 
```

**问题**

我的问题是我有多个视图使用相同的 wrapper-div。但是当我关闭一个视图时，这个 wrapper-div 似乎被删除了，我尝试创建的下一个视图找不到这个 div。

我想有一个简单的解决方案？我想重用相同的包装器，并且只删除其中的视图，而不是包装器本身。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-09-25T11:22:49.310

就像一个补充（供以后参考）：另一个选择是覆盖子视图`remove`，以便它只是清空`$el`而不是删除它。例如。

```
remove: function() {
      this.$el.empty().off(); /* off to unbind the events */
      this.stopListening();
      return this;
} 
```

我个人更喜欢这个，因为它消除了插入没有实际用途的包装元素的需要。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-29T17:24:23.077

在您的场景中，不要使用现有的 DOM 元素作为您的“el”值。Backbone 将为您创建元素。实例化视图时，您可以执行以下操作将其附加到现有的包装元素。

```
$(viewName.render().el).appendTo('#my_view_wrapper'); 
```

# jquery - 缩略图上的两个网格用于处理问题

> ID：14083725
> 
> 赞同：2
> 
> 时间：2012-12-29T16:39:32.127
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我想创建两个带有缩略图的网格，并且能够将缩略图从一个网格移动到另一个网格。但有一个问题。

看样本

[http://jsfiddle.net/4hBWv/](http://jsfiddle.net/4hBWv/)

```
$(function() {
    $( ".sortable" ).sortable({
        connectWith:'.sortable'
    });
    $( ".sortable" ).disableSelection();
}); 
```

```
 <table>
  <tr>
    <td class="sortable">
            <div class="ui-state-default">1</div>
            <div class="ui-state-default">2</div>
            <div class="ui-state-default">3</div>
            <div class="ui-state-default">4</div>
            <div class="ui-state-default">5</div>
            <div class="ui-state-default">6</div>
            <div class="ui-state-default">7</div>
            <div class="ui-state-default">8</div>
            <div class="ui-state-default">9</div>
            <div class="ui-state-default">10</div>
            <div class="ui-state-default">11</div>
            <div class="ui-state-default">12</div>
    </td>
    <td class="sortable">
            <div class="ui-state-default">1</div>
            <div class="ui-state-default">2</div>
            <div class="ui-state-default">3</div>
            <div class="ui-state-default">4</div>
            <div class="ui-state-default">5</div>
            <div class="ui-state-default">6</div>
            <div class="ui-state-default">7</div>
            <div class="ui-state-default">8</div>
            <div class="ui-state-default">9</div>
            <div class="ui-state-default">10</div>
            <div class="ui-state-default">11</div>
            <div class="ui-state-default">12</div>
    </td>
  </tr>
  </table> 
```

如果您尝试移动缩略图，您将看到令人不快的闪烁效果。

请告诉我为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:11:57.150

问题似乎出在 jQueryUI 代码处理排序和`margin`. 如果您更改 CSS 以`margin: 0px 0px 0px 0`使问题消失。

小提琴

[http://jsfiddle.net/XynWR/](http://jsfiddle.net/XynWR/)

可能应该作为一个错误提交给 UI 人员。

# cygwin - Cygwin 和 PuTTYCyg /bin/sh：没有这样的文件或目录

> ID：14083726
> 
> 赞同：1
> 
> 时间：2012-12-29T16:39:33.003
> 
> 标签：cygwin, reset

不知何故，我搞砸了我的 cygwin 安装，所以我无法使用 PuTTycyg 连接到它。我收到此错误：我该`/bin/sh: No such file or directory`怎么做才能解决此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T14:46:24.613

问题可能是 PuTTycyg 提供的 cygwin1.dll 文件与 Cygwin 自己的 cygwin1.dll 文件之间存在冲突。您可以尝试将 cygwin1.dll 文件从 c:\cygwin\bin\ 复制到放置 PuTTyCyg 的文件夹中。

# windows-runtime - WinRT 中 SecureString 的等价物是什么？

> ID：14083728
> 
> 赞同：6
> 
> 时间：2012-12-29T16:39:40.707
> 
> 标签：windows-runtime, windows-store-apps

在 Windows 应用商店应用程序的 .NET API 中，缺少 SecureString 类。此外，PasswordBox 不会将密码存储在安全字符串中。将字符串安全地存储在 Windows 应用商店应用程序中的等价物是什么？或者 Windows 8 是否有一些安全机制来防止其他人读取应用程序的内存（或故意崩溃后的内存转储）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:54:45.133

空无一人。用于商店应用程序的 .NET api 中的遗漏是因为某个类无法在 WinRT 应用程序中工作，因为它依赖于不可用的操作系统支持，因为有机会在框架中砍掉一些枯木，或者因为该类只是plain 在 Store 应用程序中没有意义。

SecureString 的省略极大地支持了“没有意义”的解释。任何攻击者都不会尝试从数 GB 的交换文件数据中挖掘出字符串。从商店下载您的应用程序并在自己舒适的家中使用调试器要容易**得多。**

# c++ - 在班级之间共享信息

> ID：14083733
> 
> 赞同：1
> 
> 时间：2012-12-29T16:40:06.627
> 
> 标签：c++, object

我正在尝试使用[此处](http://wiki.wxwidgets.org/Sharing_info_between_dialogs)的信息在类之间共享信息，但我无法让这两个类编译并因此相互通信。

所以，我想要的是`ClassB`获得对 的引用`ClassA`，并 `ClassB`在`ClassA`.

编译器错误（使用 g++）：

> 在成员函数中`'void ClassA::foo()'`：
> hello.cpp:9：错误：`'ClassB'`未在此范围内声明
> hello.cpp:9：错误：`'someB'`未在此范围内声明hello.cpp:9：错误： hello.cpp:9
> 之前的预期类型说明符`'ClassB'`
> : 错误:`';'`之前预期`'ClassB'`

所以我尝试`class ClassB;`在之前添加`ClassA`，

喜欢：

```
class ClassB; // just this here.

class ClassA; // all of classA here.

class ClassB; // all of classB here. 
```

我得到：

> hello.cpp：在成员函数'void ClassA::foo()'中：
> hello.cpp:11：错误：无效使用不完整类型'struct ClassB'
> hello.cpp:3：错误：'struct ClassB'的前向声明
> 你好.cpp:12：错误：不完整类型“struct ClassB”的无效使用
> hello.cpp:3：错误：“struct ClassB”的前向声明

* * *

这是我根据上面的网站尝试使用的代码：

```
include stdio.h

class ClassA {
    public:
        void foo() {
            ClassB *someB = new ClassB();
            someB->setRelative(this);
        }

        void bar() {
            printf("B is communicating with me =)\n");
        }
}; 
```

* * *

```
class ClassB {

    ClassA *m_relative;

    public:
        void setRelative(ClassA *other) {
            this->m_relative = other;
        }

        void foo() {
            m_relative->bar();
        }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-29T16:56:54.130

你显然在这里有一个循环依赖，你不能仅仅使用标题来解决这个问题（可能有一些宏技巧，但我不会担心）。

您应该做的是将代码拆分为声明（标头）和实现。

**啊**

```
// only include this file once per translation unit
#pragma once

// tell the compiler B is going to be a class,
// so B* is a pointer to a class - nothing more is needed for now.
class B;

// full declaration of A
class A {
    B *child;

public:
    A(void);
} 
```

**a.cpp**

```
#include "a.h" // included whenever the structure/size of A has to be known
#include "b.h" // same for B

A::A(void) : child(new B(this)) {
    // do something with child or...
    B * = new B(this);
} 
```

**bh**

```
// only include this file once per translation unit
#pragma once

// again, just tell the compiler A is going to be a class
class A;

class B {
    A *parent;
public:
    B(A *pparent);
} 
```

**b.cpp**

```
#include "a.h"
#include "b.h"

B::B(A *pparent) : parent(pparent) {
    // do something with parent
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T16:56:34.057

Like [This question](https://stackoverflow.com/questions/1837165/can-two-classes-see-each-other-using-c) 每个类（A 和 B）都应该有一个头文件和一个实现文件。

每个头文件（例如 Ah）不应包含另一个头文件（例如 Bh），但可以包含对另一个类的前向引用（例如，像 B 类的语句；），然后可以使用指针和/或对另一个的引用在其声明中的类（例如，类 A 可能包含 B* 作为数据成员和/或作为方法参数）。

每个 CPP 文件（例如 A.cpp）可能包括一个以上的头文件（例如 Ah 和 Bh）。建议每个 CPP 文件应首先包含其自己的头文件（例如 A.cpp 应包含 Ah 然后 Bh，而 B.cpp 应包含 Bh 然后 Ah）。

每个头文件应该只包含声明，而不是类的定义：例如，它将列出类方法的签名，但不列出方法体/实现（方法体/实现将在 .cpp 文件中，不在头文件中）。由于头文件不包含实现细节，因此它们不依赖（不需要查看）其他类的细节；最多他们需要知道，例如，B 是一个类的名称：它可以从前向声明中获得，而不是通过在另一个头文件中包含一个头文件。

例如：

> //啊B类; // 前向声明

```
lass A {
   void foo(B* b); // pointers and references to forward-declared classes are ok
};

// b.h
Class A; // forward declaration

Class B {
   void bar(A& a); // pointers and references to forward-declared classes are ok
};

// a.cpp
#include "a.h"
#include "b.h"

void A::foo(B* b) {
   b->bar(*this); // full declaration of B visible, ok to call members now
}

// b.cpp
#include "a.h"
#include "b.h"

void B::bar(A& a) {
   a.foo(this); // full declaration of A visible, ok to call members now
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T17:01:39.937

`class A`需要一个完整的定义`class B`才能创建它并调用`someB->setRelative(this)`. `class B`需要完整的定义`class A`才能调用`m_relative->bar()`。所以这是一个先有鸡还是先有蛋的问题。

您只能通过拆分头文件中的类和方法声明以及 cpp 文件中的方法定义来打破这个循环。

# javascript - 使用 JSON Rest 将 Javascript 结构与服务器端同步

> ID：14083760
> 
> 赞同：0
> 
> 时间：2012-12-29T16:43:24.883
> 
> 标签：javascript, ajax

我想找到使用 JSON、REST、ajax 将 Javascript 结构与服务器同步的框架或库。在服务器端，我使用 PHP 和 codeigniter。

基本上我有不同的Javascript“对象”，我想将它们序列化为JSON并发送到服务器以在数据库中更新，最好用很少的代码。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T16:45:35.000

这是 Douglas Crockford 的 JSON 官方字符串化器/解析器。 [https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)。

# ios - 选择器作为IOS中的参数

> ID：14083763
> 
> 赞同：13
> 
> 时间：2012-12-29T16:43:45.117
> 
> 标签：ios, selector

我想为每个创建的按钮提出不同的方法。我尝试在 viewDidLoad 中调用“FirstImage”方法，但它不起作用。

ViewDidLoad 中的选择器有问题。无法识别“FirstImage”，这是一个没有参数的 void 方法。

视图控制器.m

```
- (void)createFirstButton:(NSString *)myName: (SEL *)myAction{
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [btn        addTarget:self
                action:@selector(myAction)
                forControlEvents:UIControlEventTouchUpInside];
    [btn setTitle:myName forState:UIControlStateNormal];
    btn.frame = CGRectMake(20, 916, 120, 68);
    [self.view addSubview:btn];
}

- (void)viewDidLoad{
    [self createFirstButton:@"First" myAction:[self FirstImage]];
} 
```

我所做的（我将“CreateFirstButton”更改为“CreateButton”）：

视图控制器.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

@synthesize myHeight;
@synthesize myWidth;
@synthesize myX;
@synthesize myY;

- (void)createButton:(NSString *)myName:(SEL)myAction:(NSUInteger)my_x:(NSUInteger)my_y:(NSUInteger)my_width:(NSUInteger)my_height
{
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [btn    addTarget:self
            action:myAction
            forControlEvents:UIControlEventTouchUpInside];
    [btn setTitle:myName forState:UIControlStateNormal];
    btn.frame = CGRectMake(my_x, my_y, my_width, my_height);
    [self.view addSubview:btn];
}

- (void)myXcrementation{
    myX = myX + 150; 
}

- (void)viewDidLoad{
    myX = 20; myY = 916; myWidth = 120; myHeight = 68;
    [self createButton:@"First":@selector(FirstImage):myX:myY:myWidth:myHeight];
    [self myXcrementation];
    [self createButton:@"Previous":@selector(PreviousImage):myX:myY:myWidth:myHeight];
    [self myXcrementation];
    [self createButton:@"Pause":@selector(PauseImage):myX:myY:myWidth:myHeight];
    [self myXcrementation];
    [self createButton:@"Next":@selector(NextImage):myX:myY:myWidth:myHeight];
    [self myXcrementation];
    [self createButton:@"Last":@selector(LastImage):myX:myY:myWidth:myHeight];
}

- (void)FirstImage{
    current = 0;
    [self SetImage];
}

-(void)SetImage{
    [myImageView setImage: [myArray objectAtIndex:(current)]];
}

@end 
```

视图控制器.h

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController{
}

@property(assign, nonatomic) NSUInteger myHeight;
@property(assign, nonatomic) NSUInteger myWidth;
@property(assign, nonatomic) NSUInteger myX;
@property(assign, nonatomic) NSUInteger myY;

@end 
```

我再次编辑了这篇文章，没有更多的错误。特别感谢大家。我花了一些时间来理解:)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-29T16:48:27.180

你必须使用`@selector`如下

```
[self createFirstButton:@"First" myAction:@selector(FirstImage)]; 
```

那么你的签名是错误的，因为`SEL`不应该是一个指针。

改变

```
- (void)createFirstButton:(NSString *)myName: (SEL *)myAction{ 
```

到

```
- (void)createFirstButton:(NSString *)myName: (SEL)myAction{ 
```

finally`myAction`有类型`SEL`所以可以直接传给`UIButton`方法，如下

```
[btn addTarget:self
     action:myAction
     forControlEvents:UIControlEventTouchUpInside]; 
```

另外，我想补充一点，对方法使用大写名称是一种非常糟糕的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:50:16.747

你应该使用

```
- (void)viewDidLoad{
    [self createFirstButton:@"First" myAction:@selector(FirstImage)];
} 
```

或者

```
- (void)viewDidLoad{
    [self createFirstButton:@"First" myAction:NSSelectorFromString(@"FirstImage")];
} 
```

`@selector(myAction)`应该替换为`myAction`，并且`(SEL *)`应该替换为`SEL`。

在您的代码中，在`-createFirstButton:myAction:`调用之前，它的第二个参数`[self FirstImage]`将首先被评估（调用）。@selector() 接受一个名称并返回一个 SEL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T16:50:41.100

采用

```
[self createFirstButton:@"First" withAction:NSSelectorFromString(@"FirstImage")]; 
```

并将方法名称更改为：

```
- (void)createFirstButton:(NSString *)myName: withAction: (SEL) myAction{
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [btn        addTarget:self
                action:myAction
                forControlEvents:UIControlEventTouchUpInside];
    [btn setTitle:myName forState:UIControlStateNormal];
    btn.frame = CGRectMake(20, 916, 120, 68);
    [self.view addSubview:btn];
} 
```

还，

我想知道所有具有相同框架的按钮，如果可能的话，通过`frame`这个方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T18:51:01.633

更改方法文字，如下所示

```
- (void)createFirstButton: (NSString *)myName withAction: (SEL)myAction 
```

对于声明和定义。

还有为什么你声明了与公共和私有相同的方法？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-13T08:06:15.293

如果您希望将字符串作为方法名称传递给选择器，请使用 NSSelectorFromString。字符串应以 ':' 结尾示例-

```
 NSString *myName=@"aMethod:"; 
    [button addTarget:self 
               action:NSSelectorFromString(myName)
     forControlEvents:UIControlEventTouchDown]; 
```

# wpf - F# 可区分联合和 WPF 数据绑定

> ID：14083779
> 
> 赞同：5
> 
> 时间：2012-12-29T16:45:32.150
> 
> 标签：wpf, class, recursion, f#

我有一个带有视图模型类的 F# WPF 应用程序。这些类需要公开才能在 XAML 中用作数据类型。

问题在于，当使用 F# 类型递归（和）时，从属类型似乎不可访问——或者它们似乎不可访问。也就是说，给出这个例子：

```
type Foo () =

    member this.Bar = new Bar()

and Bar () =

    member this.Foo = new Foo() 
```

然后 Bar 在 XAML 中不可访问。

我也尝试在 Foo 前面加上 public 和 Bar 。我也尝试创建一个同义词。这些变化都没有解决问题。

这真的是它的工作原理还是我“做错了”？如果它是它的工作方式，那么我可以强制从属类型（在示例中为 Bar）公开吗？

谢谢！:-)

**更新 1**：仔细检查 (dotPeek) 似乎访问是相同的。F# 编译器创建一个静态外部类 Foo 和一个嵌套类 Foo。Bar 也是如此。它们都被标记为公开。现在我很困惑为什么不能从 XAML 中访问 Bar。

**更新 2**：已解决。WPF 不喜欢受歧视的工会。一种或多种从属类型使用有区别的联合，这会阻止它用于 XAML 数据绑定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T17:11:32.337

WPF 不喜欢受歧视的工会。一种或多种从属类型使用有区别的联合，这会阻止它用于 XAML 数据绑定。不是很明显，但这就是问题所在。

# java - 如果每次制作新游戏时都会在网格中生成这些按钮，我是否必须在 xml 中定义屏幕上的每个按钮？

> ID：14083789
> 
> 赞同：0
> 
> 时间：2012-12-29T16:46:53.693
> 
> 标签：java, android, xml

我正在做一个小型个人项目，将我制作的同一游戏版本移植到 android。我的大部分游戏都是用 java 编写的（仍在完成），但我正在阅读 android 开发（阅读文档并在 youtube 上观看 thenewboston）。我对 AndroidManifest.xml 很好奇。如果我理解正确，屏幕上的所有内容都在该 xml 文件中定义。但是，我的 java 游戏有自己的代码来创建棋盘：

```
 //game board
JFrame gameBoard = new JFrame();
gameBoard.setTitle("CrossGame");
gameBoard.setSize(400,400);

int numColors = 3;

//board grid
JPanel boardGrid = new JPanel(new GridLayout(gridSize, gridSize));

try {
  UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());
}
catch (Exception e) {
}
//A loop to add a new button to each section of the board grid.
for (int i = 0; i < gridSize; i++) {
  for (int j = 0; j < gridSize; j++) {

    gameButtons[i][j] = new JButton();
    gameButtons[i][j].addActionListener(new Listener());
    gameButtons[i][j].setBackground(colors[(int)(Math.random() * numColors)]);
    boardGrid.add(gameButtons[i][j]);

  }
}

//Adds the grid of buttons to the window.
gameBoard.add(boardGrid);
//Quits the program when the close window button is pressed.
gameBoard.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
gameBoard.setVisible(true); 
```

}

我在 Mac 上编程，这就是为什么我在那里有 setLookAndFeel 的原因。所有这些按钮都必须在 XML 中定义吗？还是我必须修改此代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:02:52.110

### Android 建议在 xml 中添加按钮以分离业务层和表示层。但这不是强制性的。所以你可以在你的代码中完全修改它们，就像 java 应用程序一样

```
 For Example::
 for(int i::n)//depend upon your loop requirement
  {
      layout = (LinearLayout) findViewById(R.id.statsviewlayout);
      Button bi = new Button(this);
      bi.setText(R.string.button_back);
      bi.setLayoutParams(new LayoutParams(
      ViewGroup.LayoutParams.WRAP_CONTENT,
      ViewGroup.LayoutParams.WRAP_CONTENT));
      layout.addView(bi);
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:50:20.703

您可以使用随机样式

### 数组.xml

```
<?xml version="1.0" encoding="utf-8"?>
<array name="color">
<item name="green">0000FF</item>
<item name="red">FF0000</item>
<item name="blue">00FF00</item>
</array> 
```

### 您可以随机使用这些数组文件来设置按钮样式

```
 Resources re=getResources();
  bi.setBackGroundColor(random(r.getArray(color))); 
```

希望这些可能对您的编程结构有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:25:30.347

您可以像当前一样动态生成界面，但是使用 XML 布局工具有几个优点。

首先，您需要明确一个 android 应用程序中涉及许多不同的 xml 文件。清单文件（通常）不围绕屏幕布局。

如果您要使用 xml 布局文件而不是动态创建按钮，那么 android 提供了出色的工具来为不同的设备尺寸和分辨率设计多个版本。

# php - 如何在 php 中访问 DOM 将回显之间的所有内容

> ID：14083798
> 
> 赞同：1
> 
> 时间：2012-12-29T16:47:48.400
> 
> 标签：php, dom, html-parsing

> **可能重复：**
> [将 DOMDocument 中的特定元素导出为字符串](https://stackoverflow.com/questions/7978822/export-particular-element-in-domdocument-to-string)

我知道如何根据 id 访问不同的元素，但不知道如何获取 html 开始标签到 html 结束标签之间的所有内容。谁能帮帮我吗。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:59:22.767

如果你想用 PHP 解析一个 html 页面，你可以使用 PHP 的 DOMDocument 扩展，例如：

```
// a new dom object
$dom = new domDocument;
// load the html into the object
$dom->loadHTML($html);
// keep white space
$dom->preserveWhiteSpace = true;
// nicely format output
$dom ->formatOutput   = true;
//get element by tag name
$htmlRootElement = $dom->getElementsByTagName('html');
echo htmlspecialchars($dom->saveHTML(), ENT_QUOTES); 
```

或者您可以在客户端使用 JavaScript 执行此操作：

```
var htmlRootElement = document.getElementsByTagName("html");
alert(htmlRootElement.innerHTML); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:01:56.370

`<html>`您可以使用DOMDocument 类访问标记中的每个元素。

例子

```
$htmlDoc = new DOMDocument;

$html = <<<HTML
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>My Site</title>
    <meta name="description" content="DOM test">
</head>
<body>
    <h1>Hello</h1>
    <p>This is a DOM test</p>
</body>
</html>
HTML;

$htmlDoc->loadHTML($html);
$htmlElement = $htmlDoc->getElementsByTagName("html");

foreach ($htmlElement->item(0)->childNodes as $element) {
    echo 'Element name: ' . $element->nodeName . PHP_EOL;
    echo 'Element value: '. $element->nodeValue . PHP_EOL;
} 
```

# objective-c - 将图像添加到 box2d 主体的问题

> ID：14083807
> 
> 赞同：0
> 
> 时间：2012-12-29T16:48:18.683
> 
> 标签：objective-c, cocos2d-iphone, box2d

我将此代码添加到我的文件中

```
CCSprite *_ball;
_ball = [CCSprite spriteWithFile:@"A.jpg" rect:CGRectMake(0, 0, 10, 10)];
_ball.position = ccp(20, 20);
[self addChild:_ball];

b2BodyDef ballBodyDef;
ballBodyDef.type = b2_dynamicBody;
ballBodyDef.position.Set(20/PTM_RATIO, 20/PTM_RATIO);
ballBodyDef.userData = _ball;
_body = world->CreateBody(&ballBodyDef);

b2CircleShape circle;
circle.m_radius = 30.0/PTM_RATIO;

b2FixtureDef ballShapeDef;
ballShapeDef.shape = &circle;
ballShapeDef.density = 1.0f;
ballShapeDef.friction = 0.2f;
ballShapeDef.restitution = 0.8f;
_body->CreateFixture(&ballShapeDef 
```

它运行但不显示图像 A.jpg。为什么这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:50:59.303

Box2D 与是否显示精灵无关。你在其他地方有一个错误。也许“自我”没有被绘制或_ball为零？

# sinatra - 如何使用 Rack/Protection 在 Sinatra 中指定源白名单选项

> ID：14083808
> 
> 赞同：16
> 
> 时间：2012-12-29T16:48:25.123
> 
> 标签：sinatra, rack, cors

我有一个网络应用程序，假设[http://web.example.com](http://web.example.com)向[http://api.example.com](http://api.example.com)发出 POST 请求。api 服务器正在运行启用了机架保护的最新版本的 Sinatra。我收到此错误“Rack::Protection::HttpOrigin 阻止了攻击”。

我可以做这样的事情：

```
set :protection, :except => [:http_origin] 
```

但我觉得我只是忽略了实际问题。

我试图这样做：

```
use Rack::Protection::HttpOrigin, :origin_whitelist => ['http://web.example.com'] 
```

但我仍然收到警告。

该请求没有被拒绝，但 Sinatra 清除了我的会话，[请参阅这篇文章](https://github.com/sinatra/sinatra/issues/508)，我需要 session_id。

任何有关如何为 HttpOrigin 类指定 option_whitelist 的帮助或示例将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-29T21:58:50.190

将您的选项作为哈希传递给`set :protection`：

```
set :protection, :origin_whitelist => ['http://web.example.com'] 
```

然后 Sinatra 将在设置时将它们传递给`Rack::Protection`它。

我怀疑它失败的原因是`use Rack::Protection::HttpOrigin, :origin_whitelist => ['http://web.example.com']`你仍然启用了保护，所以你最终得到了*两个*`HttpOrigin`. 你可以试试

```
set :protection, :except => [:http_origin]
use Rack::Protection::HttpOrigin, :origin_whitelist => ['http://web.example.com'] 
```

（即有你*一起*尝试过的两条线），但我认为第一个解决方案更干净。

# php - 使用php从html标签中提取数据到mysql

> ID：14083814
> 
> 赞同：0
> 
> 时间：2012-12-29T16:48:50.023
> 
> 标签：php, html, sql, curl, web-scraping

> **可能重复：**
> [PHP 简单 HTML DOM 解析器：访问自定义属性](https://stackoverflow.com/questions/9559796/php-simple-html-dom-parser-accessing-custom-attributes)

我正在寻找一种将数据从 html 标签导入到 sql 的方法。该网页位于外部服务器上。

我有一个带有这个字符串的网站；

```
<div class="item_1" value_1="1a" value_2="1b" value_3="1c">
  some text which i don't want to import into sql
</div>

<div class="item_2" value_1="2a" value_2="2b" value_3="2c">
  some text which i don't want to import into sql
</div> 
```

我想使用 php 脚本文件将类和 value_1、value_2 和 value_3 属性存储到 mySQL 数据库。

我已经设置了一个 cURL 脚本来将数据导出到一个文本文件，但这包括所有文本，而不仅仅是我需要的属性。而且我只能将结果回显为 HTML。

有人可以启发我如何做到这一点。如果有可能的话......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:51:27.323

您可以使用这样的 HTML 解析器：http: [//simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)

或者您可以像文本一样解析它（简单或 w.RegEx）

# eclipse - Eclipse Mac 中缺少 JRE

> ID：14083820
> 
> 赞同：0
> 
> 时间：2012-12-29T16:49:37.327
> 
> 标签：eclipse, java

使用 Eclipse 时出现此错误：

[![](../Images/b532c8942c80eb480e3054c0267d3580.png)](https://i.stack.imgur.com/OYgY1.jpg)

> ...工作区中没有安装 JRE...

任何人都知道我必须做什么？或者我需要哪个 JRE（不管这是什么）？刚从学校开始，所以我对 Eclipse 还不太了解。

（错误中的第一个词是“构建”）

编辑：
解决了！新版eclipse+JDK 7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:20:40.160

您需要[为 Mac 安装 JDK 7](http://docs.oracle.com/javase/7/docs/webnotes/install/mac/mac-jdk.html)。也请复习笔记。

安装后 JVM 应位于：/Library/Java/JavaVirtualMachines/ 路径。Apple 支持 Java 6，因此请尝试检查路径：/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home。假设在 Mac 上安装 Java 6 的具体方法取决于您的硬件和 Mac OS 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:03:17.977

JRE 是 Java 运行时环境。你有安装Java吗？它不再是 OSX 软件包的一部分。

# c++ - 是否可以从类创建多维数组？

> ID：14083829
> 
> 赞同：0
> 
> 时间：2012-12-29T16:50:32.487
> 
> 标签：c++, arrays, class, multidimensional-array

假设您有与此类似的代码：

```
#define maxX 80
#define maxZ 80

//Sector class
class Sect{
    ...
}

Sect sects[maxX][maxZ]; 
```

这会创建一个合理的二维 Sect 数组吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:52:25.327

它会创建一个二维类数组`Sect`，是的。我不确定您所说的“合理”是什么意思，所以我无法对此发表评论。

但请考虑：

*   `std::array`和`std::vector`
*   常量而不是宏

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T16:52:59.073

是的。

这个说法

```
Sect sects[maxX][maxZ]; 
```

创建一个 Sect 的二维数组，总大小（Sect 元素的数量）`maxX * maxZ`。您的元素的有效索引将是 from `sects[0][0]`to `sects[maxX-1][maxZ-1]`。尝试使用超出这些范围的索引访问数据是无效的，并且会导致未定义的行为。

# recursion - SML 中的尾递归不提供任何输出

> ID：14083833
> 
> 赞同：0
> 
> 时间：2012-12-29T16:50:57.573
> 
> 标签：recursion, programming-languages, functional-programming, sml, smlnj

在我之前的帖子之后[，](https://stackoverflow.com/questions/14071226/val-keyword-within-if-condition-wont-allow-reassignment-in-sml)我尝试按照建议进行操作，并将代码转换为带有`let`.

原始代码 -**不起作用**（由于使用`val`内部`if`条件）：

```
fun func() = 

val decimal = 0 (* the final result *)
val multiple = 0 (* keeps track of multiples, eg. In XXV, X would be a multiple *)
val current = 0 (* the digit currently being processed *)
val top = 0   (* value of the last element in the list *)
val last_add = 0 (* the last digit that wasn't a multiple, or subtraction operation *)
val last_sub = 0
val problem = 0 (* if value is 1 then there is a problem with the input *)
val myList = [1,2,3,4,5] (* the list has more values *)

while (myList <> [])    (* run while the list is not empty *)

    val current = tl(myList) (* grab the last element from the list *)
    val myList = tl(myList) (* remove the last element from the list *)
    val top = tl(myList) (* grab the value at the end of the list *)
    if ( myList <> []) andalso (current > top))
       then      

                val decimal = decimal + current - top
                val last_sub = top;
                val myList = tl(myList)
       else     
           if ( (myList = []) andalso (current = top))
              then val decimal = decimal + current
                   val multiple = multiple + 1
              else
                  if (last_sub = current)
                     then val problem = 1

                     else
                          val decimal = decimal + current
                          val multiple = 0
                          val last_add = current 
```

并将代码作为尾递归方法：

```
fun calc [] = 0
    |calc [x] = x
    |calc (head::tail) = 
       let 
          val decimal = 0
          val multiple = 0
          val current = 0
          val top = 0  
          val last_add = 0
          val last_sub = 0
          val problem = 0  
          val doNothing = 0
       in      

          let
              val current = hd(rev(head::tail))  (* grab the last element *) 
              val head::tail = rev(tl(rev(head::tail)))  (* POP action - remove the last element from the list *)
              val top = hd(rev(head::tail))      (* grab the new last element after removing *)
              in 
                if (current > top) then 
                    let 
                          val decimal = decimal + current - top
                          val last_sub = top 
                          val head::tail = rev(tl(rev(head::tail)))  (* POP action - remove the last element from the list *)
                    in
                    calc(head::tail)
                    end
                else
                 if ( (head::tail = []) andalso (current = top))
                   then let 
                          val decimal = decimal + current
                          val multiple = multiple + 1
                        in 
                          calc(head::tail)
                        end
                 else 
                     if (last_sub <> current)
                       then let 
                               val decimal = decimal + current
                               val multiple = 0
                               val last_add = current
                            in 
                               calc(head::tail)
                            end
                     else
                        (* do nothing *)    
                        val doNothing = 0
               end      

       end; 
```

但是，当我尝试输入时：

```
calc([0,100,20,30,4,50]); 
```

我得到：

```
uncaught exception Bind [nonexhaustive binding failure]
  raised at: stdIn:216.13-216.50 
```

我知道代码很难阅读而且很长，但如果有人能向我解释如何修复它，或者帮助我找到这个输出的原因，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:46:50.497

您的代码有一些问题。

首先，您可以使用`last`抓取列表的最后一个元素。有关详细信息，请参阅[列表文档](http://www.standardml.org/Basis/list.html)。但是除非你有一个非常好的理由这样做，否则简单地从列表的开头开始并在递归时从开头弹出元素会更容易和更有效。您已经`head`使用模式匹配在代码中绑定了第一个元素。

其次，除非您使用`ref`s（您可能不想这样做），否则标准 ML 中没有变量，只有值。这意味着如果你想在调用之间携带状态，任何累加器都需要成为你的函数的参数。使用辅助函数来初始化累加器是一种常见的模式。

第三，不要比较一个列表来`[]`测试它是否为空，而是使用该`null`函数。相信我。`=`由于微妙的类型推断问题，您会收到警告。更好的是，对函数的参数使用模式匹配或使用`case`语句。模式匹配允许编译器告诉你是否已经处理了所有可能的情况。

第四，SML 通常使用 camelCase，而不是 snake_case，作为变量名。这更具风格，但随着您编写更多代码和协作，您将希望符合约定。

第五，当你对一个列表进行递归时，不要试图查看列表中的多个值。这使事情复杂化。把它当作头元素和尾列表，一切都会变得简单得多。在我的代码中，我没有在列表中保持当前状态，而是通过将其拆分为单独的参数来做到这一点。有一个基本案例，您只需从其中一个累加器返回答案，还有一个递归案例，您使用更新的累加器值和从列表中弹出的单个值进行递归。这消除了问题场景。

我不确定这个逻辑是否正确，因为我不知道你要计算什么，但看看这段代码，它说明了我谈到的一些事情。

```
(* This is the helper function which takes accumulators as
   parameters. You shouldn't call this directly. *)
fun calc' decimal _ _ _ _ [] =
    (* We processed everything in the list.  Just return the accumulator. *)
    decimal
  | calc' decimal multiple lastAdd lastSub current (top::tail) =
    (* This case is for when there are 1 or more elements in the list. *)
    if current > top then
        calc' (decimal + current - top) multiple lastAdd top top tail
    else if current = top then
        calc' (decimal + current) (multiple + 1) lastAdd lastSub top tail
    else
        calc' (decimal + current) 0 current lastSub top tail

(* This is the function you should call. *)
fun calc [] = 0
  | calc [_] = 0 (* Given a single-element list. *)
  | calc (x::xs) =
    (* Apply the helper with correct initial values. *)
    calc' 0 0 0 0 x xs 
```

在函数式语言中，当您想要更改变量时，无需将其分配给变量，而是简单地递归并为正确的参数指定新值。这就是您使用递归在函数式语言中编写“循环”的方式。只要你只使用尾递归，它就和你最喜欢的命令式语言中的 while 循环一样高效。

# c++ - 被信号 11(SIGSEGV) 和/或 6(SIGABRT) 杀死

> ID：14083839
> 
> 赞同：0
> 
> 时间：2012-12-29T16:51:34.373
> 
> 标签：c++, shortest-path, sigabrt, segmentation-fault, maze

我的程序有这个小问题。在 Visual Studio 2012 中它运行良好，但如果我用 G++ 编译它（是的，出于上述原因，我必须使用它来编译），错误信号 11(SIGSEGV) 或 6(SIGABRT) 会根据输入触发. 这是一个编程练习，我有另一个程序（在在线服务器上）用 10 个不同的输入测试我的程序。正如我所说，该程序在使用 Visual Studio 2012 时编译并运行良好。

关于程序：它找到从起点 (x,y) 到多个出口的最短路径（出口的数量无关且不同。可能只有 1 个出口，也可能有 200 个）。输入如下：

```
7 12          // maze height and width
##########.#  //
#..........#  //
#.###.######  //
#..X#.#.....  // the maze blueprint
#.###.#.####  //
#..........#  //
############  // 
```

我的程序：

```
#include <iostream>
#include <vector>

typedef struct _laby_t {
    int h, w;
    char **pohja; // 'pohja' is finnish and means layout
} laby_t;

typedef std::vector<int> monovector;
typedef std::vector< std::vector<int> > bivector;

laby_t *laby_allocate (int r, int c)
{
    laby_t *laby;
    int i;

    laby = new laby_t[sizeof (laby_t)];
    laby->pohja = new char *[r];
    for (i = 0; i < r; i++)
    {
        laby->pohja[i] = new char[c];
    }
    laby->h = r;
    laby->w = c;

    return laby;
}

int wander(int y, int x, laby_t *&_laby, int goals)
{
    laby_t *laby = _laby;
    int found = 0, depth = 0, min_path = 1000000;
    bool b = 0;
    bivector openList;
    monovector start; start.push_back(y); start.push_back(x);
    bivector closedList;

    openList.push_back(start);

    while(found < goals)
    {

        y = openList.back()[0]; x = openList.back()[1];
        monovector r; r.push_back(y); r.push_back(x); closedList.push_back(r);
        openList.pop_back();
        if(laby->pohja[y][x] != '*') laby->pohja[y][x] = '-';
        depth++;

        if(y == 0 || y+1 == laby->h || x == 0 || x+1 == laby->w) {
            found++;
            if(depth < min_path) min_path = depth;
            if(found >= goals) {
                std::cout << min_path << std::endl;
                break;
            }
            laby->pohja[y][x] = '-';

            goto back_track;
        }
        else
        {
            b = 0;
            if(laby->pohja[y+1][x  ] == '.') { monovector r; r.push_back(y+1); r.push_back(x); openList.push_back(r); b=1; }
            if(laby->pohja[y  ][x+1] == '.') { monovector r; r.push_back(y); r.push_back(x+1); openList.push_back(r); b=1; }
            if(laby->pohja[y-1][x  ] == '.') { monovector r; r.push_back(y-1); r.push_back(x); openList.push_back(r); b=1; }
            if(laby->pohja[y  ][x-1] == '.') { monovector r; r.push_back(y); r.push_back(x-1); openList.push_back(r); b=1; }
            if(!b)
            {
back_track:     while(closedList.size() > 0)
                {
                    //std::cout << closedList.size() << std::endl;
                    int c_y = closedList.back()[0]; int c_x = closedList.back()[1];
                    int o_y = openList.back()[0];   int o_x = openList.back()[1];

                    laby->pohja[y][x] = '*';

                    y = c_y; x = c_x;

                    laby->pohja[y][x] = '*';

                    if( (c_y+1 == o_y && c_x   == o_x) ||
                        (c_y   == o_y && c_x+1 == o_x) ||
                        (c_y-1 == o_y && c_x   == o_x) ||
                        (c_y   == o_y && c_x-1 == o_x) )
                    {
                        laby->pohja[y][x] = '-';
                        y = o_y; x = o_x;
                        closedList.pop_back();
                        depth--;
                        break;
                    }
                    else {
                        closedList.pop_back();
                        depth--;
                    }
                }
            }
        }
    }

    return min_path;
}

int main()
{
    int h, w, goals = 0;
    std::cin >> h >> w;

    laby_t *laby;
    laby = laby_allocate(h, w);

    for(int i = 0; i < laby->h; i++)
        std::cin >> laby->pohja[i];

    for(int i = 1; i < laby->h-1; i++) {
        if(laby->pohja[i][0] == '.') goals++;
        if(laby->pohja[i][laby->w-1] == '.') goals++;
    }

    for(int i = 1; i < laby->w-1; i++) {
        if(laby->pohja[0][i] == '.') goals++;
        if(laby->pohja[laby->h-1][i] == '.') goals++;
    }

    for(int i = 0; i < laby->h; i++)
        for(int j = 0; j < laby->w; j++) {
            if(laby->pohja[i][j] == 'X') {
                wander(i, j, laby, goals);
                goto _exit;
            }
        }

_exit:

    //system("pause");
    return 0;
} 
```

我已经完成了关于错误信号的作业，如果你们不知道：[http ://www.yolinux.com/TUTORIALS/C++Signals.html](http://www.yolinux.com/TUTORIALS/C++Signals.html)

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T17:40:53.920

该代码可以在带有 G++ 4.7.1 的 Mac OS X 10.7.5 上干净地编译，这很好：

```
g++ -g -Wall -Wextra laby.cpp -o laby 
```

不幸的是，当结果在 下运行时`valgrind`，它会产生：

```
==15030== Invalid write of size 1
==15030==    at 0x306BE: std::basic_istream<char, std::char_traits<char> >& std::operator>><char, std::char_traits<char> >(std::basic_istream<char, std::char_traits<char> >&, char*) (in /usr/lib/libstdc++.6.0.9.dylib)
==15030==    by 0x10000117D: main (laby.cpp:113)
==15030==  Address 0x10001632c is 0 bytes after a block of size 12 alloc'd
==15030==    at 0xB823: malloc (vg_replace_malloc.c:266)
==15030==    by 0x5768D: operator new(unsigned long) (in /usr/lib/libstdc++.6.0.9.dylib)
==15030==    by 0x576DA: operator new[](unsigned long) (in /usr/lib/libstdc++.6.0.9.dylib)
==15030==    by 0x1000008C0: laby_allocate(int, int) (laby.cpp:21)
==15030==    by 0x100001146: main (laby.cpp:110) 
```

因此，函数中的内存分配存在问题`laby_allocate()`。或者几个...

```
laby_t *laby_allocate (int r, int c)
{
    laby_t *laby;
    int i;

    laby = new laby_t[sizeof (laby_t)]; 
```

这一行分配了一个数组`laby_t`；它在数组中分配与 a 中的字节数一样多的元素`laby_t`。这不是你需要的。

```
 laby = new laby_t; 
```

继续：

```
 laby->pohja = new char *[r];
    for (i = 0; i < r; i++)
    {
        laby->pohja[i] = new char[c];
    } 
```

这没有为数据末尾的 null 分配足够的空间......这就是为什么“写”是 1 个字节的原因。更改`c`为`c+1`并`valgrind`提供干净的健康单。

```
 laby->h = r;
    laby->w = c;

    return laby;
} 
```

给出的答案是`15`；我不相信这是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:30:20.150

此行溢出您的内存分配。如果用户输入*w*个字符，则需要*(w+1) 个*字符来保存以空字符结尾的字符串。

```
 std::cin >> laby->pohja[i]; 
```

这条线还分配了许多`laby_t`对象的数组，尽管您似乎只想要一个。也许您将 C++`new`与 C混淆了`malloc`。

```
laby = new laby_t[sizeof (laby_t)]; 
```

你可以用这个替换它。

```
laby = new laby_t; 
```

这似乎也是 C 的残余。这不是一个错误，但它不必要地用冗余符号污染了当前的命名空间。

```
typedef struct _laby_t { ... } laby_t; 
```

你可以用这个替换它。

```
struct laby_t { ... }; 
```

# c++ - 程序停止工作并退出

> ID：14083840
> 
> 赞同：0
> 
> 时间：2012-12-29T16:51:40.210
> 
> 标签：c++, multidimensional-array, readfile

我正在用 C++ 读取文件，这是我的代码：

```
#include <iostream>
#include <fstream>
#include <algorithm>
#include <climits>
using namespace std;

int main()
{
int row=0;
int col=0;
ifstream inputFile;
int arr[16][5];

    inputFile.open("hdtt4req.txt");

if(inputFile.is_open()) {
        inputFile >> arr[row][col];
        for (row = 0; row < 16; row++) {
            for (col = 0; col < 5; col++) {
                cout <<"hi"; //arr[row][col];
                cout << endl;
            }
        }
    }
    return 0;
} 
```

这是我要阅读的文件：

```
1 2 2 1 2 
2 1 1 1 2 
3 1 1 1 6 
4 2 2 3 2 
1 2 5 1 2 
2 0 4 3 2 
3 1 2 1 0 
4 2 2 1 2 
1 2 1 1 2 
2 0 0 5 1 
3 2 1 4 1 
4 6 1 2 1 
1 3 1 2 1 
2 1 4 1 4 
3 3 3 2 1 
4 2 0 1 1 
```

编译后，我得到了这种结果。谁能告诉我错误是什么？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T16:54:01.583

row 和 col 开始未定义，因此该语句`inputFile >> arr[row][col];`将为您提供未定义的行为。确保在执行任何操作之前将这些值设置为零

```
row = col = 0; 
```

# php - php中array_unique函数的背后是什么？

> ID：14083844
> 
> 赞同：1
> 
> 时间：2012-12-29T16:52:06.200
> 
> 标签：php

在问这个问题之前，
我探索了更多，但没有得到令人满意的结果。

人们通常会在 array_unique 函数中询问与他们的问题相关的问题。但是，在这里我想知道

**array_unique**函数如何在 php 中工作？我在哪里可以看到内置函数定义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T18:38:18.870

PHP 是开源的，所以如果你想知道它的一部分是如何工作的，你可以随时在这里查看：[http ://git.php.net/?p=php-src.git;a=summary](http://git.php.net/?p=php-src.git;a=summary)

在 PHP 源代码中浏览/搜索更友好的站点是[http://lxr.php.net/](http://lxr.php.net/)。

`array_unique`这里描述了背后的整个魔力：http: [//lxr.php.net/xref/PHP_5_4/ext/standard/array.c#2777](http://lxr.php.net/xref/PHP_5_4/ext/standard/array.c#2777)

# php - mySQL 表中的重音字符

> ID：14083847
> 
> 赞同：14
> 
> 时间：2012-12-29T16:52:22.817
> 
> 标签：php, mysql, unicode, utf-8, non-ascii-characters

我有一些法语文本（包含重音字符，例如“é”），存储在排序为 utf8_unicode_ci（表和列）的 MySQL 表中，我想在 HTML5 页面上输出。

HTML 页面字符集是 UTF-8 (< meta charset="utf-8" />)，PHP 文件本身被编码为“UTF-8 without BOM”（我在 Windows 上使用 Notepad++）。我使用 PHP5 请求数据库并生成 HTML。

但是，在输出页面上，特殊字符（例如“é”）出现乱码并被“�”替换。

当我浏览数据库（通过 phpMyAdmin）时，这些相同的重音字符显示得很好。

我在这里想念什么？

（注意：将页面编码（通过 Firefox 的“Web 开发人员”菜单）更改为 ISO-8859-1 可以解决问题……除了直接出现在 PHP 文件中的特殊字符，这些字符现在已损坏。但无论如何，我'宁愿理解为什么它不能作为 UTF-8 工作，也不愿在不理解它为什么工作的情况下更改编码。^^;)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-29T17:01:44.810

我之前遇到过同样的问题，我所做的如下

1）使用notepad++（几乎可以适应任何编码）或eclipse，并确保在**没有BOM的情况下以UTF-8保存或打开它**。

2) 在 PHP 标头中设置编码，使用`header('Content-type: text/html; charset=UTF-8');`

3) 删除我的 PHP 文件开头和结尾的任何多余空格。

4）将我所有的表和列编码设置为`utf8mb4_general_ci`或`utf8mb4_unicode_ci`通过 PhpMyAdmin 或您拥有的任何 mySQL 客户端。[此处](https://stackoverflow.com/questions/766809/whats-the-difference-between-utf8-general-ci-and-utf8-unicode-ci)提供了两种编码的比较

5）将mysql连接字符集设置为UTF-8（我使用PDO进行数据库连接）

```
 PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"
  PDO::MYSQL_ATTR_INIT_COMMAND => "SET CHARACTER SET utf8" 
```

或者在获取任何数据之前执行 SQL 查询

6）使用元标记`<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>`

7) 对法语使用某种语言代码 `<meta http-equiv="Content-language" content="fr" />`

8) 将 html 元素的 lang 属性更改为所需的语言

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr"> 
```

并且会更新更多，因为我之前真的很难解决这个问题，因为我在过去的项目中处理的是日文字符

9) 某些字体在客户端 PC 中不可用，您需要使用[Google 字体](https://www.google.com/fonts)将其包含在您的 CSS 中

10）不要结束你的PHP源文件`?>`

**笔记：**

但如果我上面所说的一切都不起作用，请尝试根据您真正想要显示的字符集调整您的编码，对我来说，我将所有内容设置`SHIFT-JIS`为显示我所有的日文字符，它真的很好用。但使用`UFT-8`必须是你的首要任务

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-29T17:01:27.627

这对我有用

1.  制作你的数据库`utf8_general_ci`
2.  将 N++ 中的文件另存为`UTF-8 without BOM`
3.  将`$mysqli->query('SET NAMES utf8');`连接到数据库后放在您的 PHP 文件中
4.  放入`< meta charset="utf-8" />`您的 HTML-s

完美运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T17:01:02.673

如果您`php.ini` `default_charset`未设置为 UTF-8，则需要使用 a`Content-type`来定义您的数据。在文件顶部应用以下标题：

```
header("Content-type: text/html; charset=utf-8"); 
```

如果您仍然遇到编码问题，原因可能是以下之一：

*   数据库服务器字符集问题（检查服务器的编码）
*   数据库客户端字符集问题（检查连接的编码）
*   数据库表字符集问题（检查表的编码）
*   一个php默认编码问题（检查`default_encoding`parameters.ini中的参数）
*   多字节配置错误（请参阅 parameters.ini 中的 mb_string 参数）
*   `<form>`字符集问题（检查它是否以 utf-8 格式发送）
*   `<html>`字符集问题（在您的 html 文件中未设置 enctype ）
*   一个`Content-encoding:`问题（Apache 发送了错误的编码）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-08T15:44:45.387

SET NAMES 为我工作。

我的问题是在我的一个编辑页面中，带有外来字符的字段不会显示，在生产网页上没有问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-25T04:49:55.060

我知道你已经有了答案。那太棒了。但奇怪的是，这些答案都没有解决我的问题。为了其他可能遇到相同问题的人的利益，我想分享我的答案。

关于多语言应用程序中的法语口音，我也遇到了与 OP 相同的问题。

但是当我不得不在 AJAX 调用中将（法语重音）数据作为段传递时，我第一次遇到了这个问题。

是的，我们必须将数据库设置为使用 UTF8。但事实上 AJAX 调用有查询字符串（在我的案例中，因为我使用的是 CodeIgniter），所以我不得不简单地对法语文本进行编码。

要在客户端执行此操作，请对您的数据使用 Javascript encodeURI() 函数。

而要在 PHP 中反转它，只需使用`urldecode($MyStr)`接收数据的位置作为参数。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-29T17:02:04.530

1.  在您的 (php) 文件中输入完整的法语符号

2.  将该文件另存为 UTF-8

3.  将下面的行粘贴到您的网站标题中

    `header('Content-Type: text/html; charset=utf-8');`

页面（文件）应该看起来不错。

如果看起来不错，请在 ( [SET_NAMES](https://stackoverflow.com/questions/14064083/incorrect-encoding-from-php) ) 之后查看 mysql 行为。

# django - 将 Django 从 MySQL 迁移到 PostgreSQL 后，具体基础模型的约束问题

> ID：14083848
> 
> 赞同：2
> 
> 时间：2012-12-29T16:52:23.747
> 
> 标签：django, postgresql

我正在尝试从 MySQL 迁移到 PostgreSQL，现在我遇到了具体基类的问题。我有类似这样的代码：

```
class BaseKlass(models.Model):
    name = CharField(max_length = 64)

class SomeKlass(BaseKlass):
    value = IntegerField() 
```

每当我创建 的实例时`SomeKlass`，都会收到如下错误：

```
IntegrityError: null value in column "baseklass_ptr_id" violates not-null constraint 
```

`baseklass_ptr_id`我查看了正在执行的 SQL，确实值为`null`.

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:25:49.053

为序列设置所有者`id`解决了这个问题：

```
ALTER SEQUENCE myapp_baseklass_id_seq OWNED BY myapp_baseklass.id; 
```

# javascript - JavaScript 持续执行然后停止

> ID：14083851
> 
> 赞同：1
> 
> 时间：2012-12-29T16:52:45.497
> 
> 标签：javascript, html, onload, onload-event

我创建了一个 js 文件并创建了一个函数，它应该做的是每次加载我的页面时更改一次图像..

```
function swapPic() {
    var imgSrc = [];
    imgSrc[0] = "/Content/Resources/cafe1.jpg";
    imgSrc[1] = "/Content/Resources/cafe2.jpg";
    imgSrc[2] = "/Content/Resources/cafe3.jpg";
    imgSrc[3] = "/Content/Resources/cafe4.jpg";
    imgSrc[4] = "/Content/Resources/cafe5.jpg";
    imgSrc[5] = "/Content/Resources/cafe6.jpg";

    var randomnumber = Math.floor(Math.random() * 5);
    var img = document.getElementById("imgContainer");
    img.setAttribute("src", imgSrc[randomnumber]);
    // alert("ok");
} 
```

在我的 html 代码中，在我的 img 标签中：

```
<img id="imgContainer"  src="~/Content/Resources/cafe3.jpg" onload="swapPic()"/> 
```

添加该`alert("ok")`行并重新加载页面一次，警报窗口不断弹出并且图像发生变化。我一直关闭窗口，它仍然弹出并且图像发生变化。它只是在一段时间后停止了。

所以我想，在我没有包括那条`alert("ok")`线的时间里，我的函数被连续调用并停止。它发生得如此之快，使它看起来很好。

我认为这是一个问题。你知道伙计们如何确保我的函数只被调用一次？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-29T16:57:03.930

您应该添加`onload`，`body`而不是`img`。

```
<body onload="swapPic();">
    <img id="imgContainer"  src="~/Content/Resources/cafe3.jpg"/>
</body> 
```

如果添加`onload`到`img`，则每次加载图像时都会调用该函数，从而导致无限循环。

如果您无法修改`body`标签，请将您当前的功能替换`swapPic()`为：

```
(function swapPic() {
    var imgSrc = [];
    imgSrc[0] = "/Content/Resources/cafe1.jpg";
    imgSrc[1] = "/Content/Resources/cafe2.jpg";
    imgSrc[2] = "/Content/Resources/cafe3.jpg";
    imgSrc[3] = "/Content/Resources/cafe4.jpg";
    imgSrc[4] = "/Content/Resources/cafe5.jpg";
    imgSrc[5] = "/Content/Resources/cafe6.jpg";

    var randomnumber = Math.floor(Math.random() * 5);
    var img = document.getElementById("imgContainer");
    img.setAttribute("src", imgSrc[randomnumber]);
    // alert("ok");
})(); 
```

这将只执行一次。无需在任何地方调用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-29T16:57:42.880

您已附加`onload`到图像。在这种情况下`swapPic()`，将在每次图像加载时调用。所以，发生的是一个无限循环——你调用`swapPic()`它，它会加载一个再次触发的新图像`swapPic()`。有关更多信息，请查看[W3Schools：Event - Img Onload](http://www.w3schools.com/jsref/event_img_onload.asp)。

你应该移动`swapPic()`到身体。`swapPic()`这将仅在加载主体时触发。

另一种方法是使用javascript：

```
// if you have jQuery
$(document).ready(function(){
    swapPic()
});

// ordinary javascript
window.onload = function() {
    swapPic();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-29T16:59:56.410

图像有自己的加载事件，指的是*图像*何时完成加载。因此，每次更新 src 时，浏览器当然会开始加载图像，并在完成加载后再次触发事件。循环重复。

您可以`window.onload`只调用一次函数，因为窗口的加载事件只能发生一次。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-29T17:11:45.947

使用选项卡中的 onload 功能。顺便说一句，根据您的代码，您`imgSrc[5] = "/Content/Resources/cafe6.jpg";`将永远不会显示，因为您的随机函数仅生成 0-4。它应该是 `var randomnumber = Math.floor(Math.random() * 6);`

# android - 多语言数据库

> ID：14083852
> 
> 赞同：0
> 
> 时间：2012-12-29T16:52:57.727
> 
> 标签：android, database, database-design, localization, multilingual

我正在开发一个支持阿拉伯语和英语的 Android 应用程序，但我仍然对数据库设计感到困惑：

我遵循的方法是

*   创建一个包含两条记录（阿拉伯语和英语）的语言表
*   创建一个包含普通数据的表（不是特定于语言的）
*   创建一个包含特定语言内容的翻译表

例如，为了实现（帮助），我创建了以下表格：

```
Language        (int id, text Code)
Help            (int id)
Help_translation(int id, int Help_id, int Language_id, text Question, text Answer) 
```

我已经阅读了这个解决方案很多次，但我仍然不知道为什么我们有一个单独的表（帮助），它什么都不做！

我的方法有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T22:02:52.160

从表面上看，语言表会在系统中出现一次。我建议根据 ISO 国家代码 (ISO 3166) 和 ISO 语言代码 (ISO 639-2) 对语言和地区使用“ll_tt”表示法。因此，您可能有`en_gb`英国英语、`en_us`美国英语、`ar_sa`沙特阿拉伯阿拉伯语和`ar_eg`埃及阿拉伯语。这可能比您当前需要的更强大，但会为您指明未来的方向。

因此，Language 表可能有列：

*   `id`整数（自动增量）主键。
*   `code`char(5) — 唯一的。

设计中的帮助表用于“文档”目的。它记录应用程序可以使用的有效帮助编号。该表的更完整版本可能包含有关消息的信息：它在应用程序中的使用位置；它是在哪个版本中引入的；哪个版本过时了（或者可能没有——我们有国际化的消息文件，这些文件必须能够在大约 10 年的时间内与版本一起使用）；与版本相关的日期——或日期而不是版本；和“给翻译者的注释”（如何翻译信息的指南，如果需要任何特殊指南）。

仅带有帮助 ID 号的帮助表的简约版本暂时可以：

*   `id`整数（自动增量）。首要的关键。

Help_Translation 表存储应用程序将显示的字符串。该`id`列在这里的价值最小；我会省略它（但如果你愿意，你可以保留它）。该`Help_ID`列是对帮助表的外键引用；该`Language_ID`列是对语言表的外键引用。对于您选择的应用程序，每个帮助项目似乎都有一个问题和一个答案。

因此，Help_Translation 表具有以下列：

*   `id`整数（自动增量，可选，不确定何时使用）。
*   `Help_ID`整数 — 外键引用 Help(ID)。
*   `Language_ID`整数 — 外键引用语言 (ID)。
*   `Question`text — 给定 Help_ID 的适当语言的问题。
*   `Answer`text — 给定 Help_ID 的相应语言的问题答案。
*   主键：`Help_ID`和`Language_ID`。

另一种设计将只是一个带有“消息 ID”和“语言 ID”的翻译表以及翻译后的字符串（消息 ID 和语言 ID 上的主键）。将有一个消息表，标识有效的消息 ID 以及先前类型大纲的支持数据。这可能包括在没有针对特定语言/地区的消息的翻译版本时使用的默认消息（未翻译）（或者您可以制定更复杂的方案来处理丢失的消息，以便在请求阿拉伯语但翻译因为，比如说，利比亚（LY）是不完整的，它回落到`ar_sa`然后才落到`en_gb`）。然后，您的帮助表可能包含一个帮助 ID，以及两个消息 ID 值，一个用于问题，一个用于答案。这种方案的优点是所有翻译的消息都在一个表中。

毫无疑问，还有其他可以设计的方案。

# java - APK 扩展文件和 APK 大小

> ID：14083855
> 
> 赞同：0
> 
> 时间：2012-12-29T16:53:04.657
> 
> 标签：java, android, apk

我正在开发具有以下属性的基于图像的应用程序：

*   apk 大小（不含图片）手机版约为 15MB，平板电脑版约为 25MB。
*   图像的总大小约为 30MB。
*   该应用程序将以 beta 状态发布，可能会频繁更新
*   图像包不太可能更新

我的问题是：我可以使用apk扩展文件系统吗？或者当我尝试上传 15MB 的 apk 和 30MB 的扩展（总共 45MB）时，Google 会给我带来问题？否则我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:16:32.920

45mb 在 apk 允许的 50mb 范围内。通常建议超过 50mb 限制的应用程序，因为在大多数设备上，扩展文件将在用户下载您的 apk [（参考）](http://developer.android.com/google/play/expansion-files.html)的同时下载，但是您完全可以按照您建议的方式使用它。

# struts-1 - Struts html标签不起作用

> ID：14083862
> 
> 赞同：5
> 
> 时间：2012-12-29T16:54:25.220
> 
> 标签：struts-1

我只是尝试在 jsp 页面中包含一个带有 struts 提供标签的文本框。但它的表现非常典型。

### 在职的

`<html:text property="name" value=""></html:text>`

### 不工作

`<html:text property="name"></html:text>`
所以，没有财产`'value'`，它就不起作用。请帮帮我。

注意：使用*tomcat 6.0*
bean，逻辑运行良好，并且在 html 中，大多数逻辑运行正常。广播、文本区域、文本是一些引起问题的原因。
*JSP文件*

`<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>`
`<%@ taglib uri="http://struts.apache.org/tags-bean" prefix="bean" %>`
`<%@ taglib uri="http://struts.apache.org/tags-html" prefix="html" %>`
`<%@ taglib uri="http://struts.apache.org/tags-logic" prefix="logic" %>`
`<%@ taglib uri="http://struts.apache.org/tags-tiles" prefix="tiles" %>`
`<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">`
`<html>`
`<head>`
`<title>Registration Form</title>`
`</head>`
`<body>`
`<html:text property="name"></html:text>`
`</body>`
`</html>`

```
type Exception report

message 

description The server encountered an internal error () that prevented it from fulfilling this request.

exception 

org.apache.jasper.JasperException: An exception occurred processing JSP page /index.jsp at line 14

11: <title>Registration Form</title>
12: </head>
13: <body>
14: <html:text property="name"></html:text>
15: </body>
16: </html>

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:505)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:398)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)

root cause 

javax.servlet.ServletException: javax.servlet.jsp.JspException: Cannot find bean: "org.apache.struts.taglib.html.BEAN" in any scope
    org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:852)
    org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:781)
    org.apache.jsp.index_jsp._jspService(index_jsp.java:79)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)

root cause 

javax.servlet.jsp.JspException: Cannot find bean: "org.apache.struts.taglib.html.BEAN" in any scope
    org.apache.struts.taglib.TagUtils.lookup(TagUtils.java:864)
    org.apache.struts.taglib.html.BaseFieldTag.prepareValue(BaseFieldTag.java:126)
    org.apache.struts.taglib.html.BaseFieldTag.renderInputElement(BaseFieldTag.java:102)
    org.apache.struts.taglib.html.BaseFieldTag.doStartTag(BaseFieldTag.java:80)
    org.apache.jsp.index_jsp._jspx_meth_html_005ftext_005f0(index_jsp.java:96)
    org.apache.jsp.index_jsp._jspService(index_jsp.java:69)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:374)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:342)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:267)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)

note The full stack trace of the root cause is available in the Apache Tomcat/6.0.18 logs.

--------------------------------------------------------------------------------

Apache Tomcat/6.0.18 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-29T16:59:29.257

该`<html:text>`标签应该包含在一个`<html:form>`标签内，该标签定义了动作，因此 ActionForm 实例从中`<html:text>`获取其值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-20T09:17:31.873

好吧，这`<Html:text>`是一种用户输入文本，它将从用户端获取值，并将被进一步分配，但值在此标签中不起作用。

假设是`<html:form>`因为那将具有动作实例，并且将调用动作。您可以为其分配一个隐藏变量值。

所以结构将是

```
<html:form>
    <html:text/>
</html:form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-29T22:40:30.000

万一其他人偶然发现这篇文章正在寻找钝的**javax.servlet.jsp.JspException的解决方案：在任何范围错误消息中找不到bean：“org.apache.struts.taglib.html.BEAN”**，我是由不小心将一个 Struts 插入另一个 Struts`<html:form>`内部`<html:form>`。错误消息 Struts 并未指出这一点。我通过查看我的页面生成的 HTML 发现了这一点。

# arrays - Matlab类递增静态数

> ID：14083868
> 
> 赞同：0
> 
> 时间：2012-12-29T16:55:09.537
> 
> 标签：arrays, matlab, object, static

我创建了一个具有 Id 属性的对象。我正在尝试创建一个数组，它将根据数组中的位置或从 1 开始的静态递增 int 自动填充 Id 属性。

我该如何实施？

我试图创建一个以 id 作为输入的构造函数，但编写 myArr(100) = myObj 会引发错误。我如何也用 id 初始化它（使用静态 id 或任何其他方式）。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T09:11:02.850

```
classdef a_class < handle    

properties
    id
end

methods
    function obj = a_class(size_of_matrix)   

        if nargin == 0 %default constructor
            %something constant. Do not try to place counter here.

        else
            if numel(size_of_matrix)==1 
                size_of_matrix = [size_of_matrix size_of_matrix];
            end;

            obj(size_of_matrix(:)) = a_class; % Preallocate object array

            id_cell = num2cell(1:prod(size_of_matrix));
            [obj(1:prod(size_of_matrix)).id] = id_cell{:};

        end
    end
end
end 
```

恐怕，这是最好的解决方案。

请注意，您不能在默认构造函数中定义一个计数器，然后分配一个数组，因为实际上它只会被调用一次。

[PS 他们在官方教程](http://www.mathworks.co.uk/help/matlab/matlab_oop/creating-object-arrays.html)中使用了更加幼稚的基于 for 的语法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T20:04:33.670

我知道这只是部分解决方案，但假设您有一个矩阵 M，其中第一个索引是 ID 值，那么您可以执行以下操作：

```
M(:,1) = 1:size(M,1) 
```

或者，如果您有一个矩阵 M，其中第一列需要添加 ID 值：

```
M = [1:size(M,1) M] 
```

# java - 在 Ubuntu 上安装 Oracle Java

> ID：14083869
> 
> 赞同：3
> 
> 时间：2012-12-29T16:55:14.487
> 
> 标签：java, javac, ubuntu-11.04

我一直在尝试在 Ubuntu 11.04 上安装 Oracle Java 7。我按照[这里给出的说明进行操作](http://www.wikihow.com/Install-Oracle-Java-on-Ubuntu-Linux)

一旦我按照所有步骤（信中），我尝试运行

```
java -version 
```

这给出了预期的输出。但是跑步

```
javac -version 
```

没有给出预期的输出。相反，我收到以下错误：

```
Error : Could not find libjava.so
Error : Could not find Java SE Runtime Environment 
```

环境变量 PATH 包含 /usr/local/java/jre/bin 和 /usr/local/java/jdk/bin，LD_LIBRARY_PATH 指向 /usr/local/lib，其中包含 libjava.so，该用户当前拥有我正在运行 javac。此外，JAVA_HOME 指向 jdk 文件夹。尽管如此，javac 还是找不到 libjava.so 文件。网上有多种解决方案，但似乎没有一个适合我。即使是直接运行

```
/usr/locale/java/jdk/bin/javac -version 
```

导致相同的错误。

非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T13:33:52.240

# .deb 包中的 Oracle Java 1.7.0

```
wget https://raw.github.com/flexiondotorg/oab-java6/master/oab-java.sh
chmod +x oab-java.sh
sudo ./oab-java.sh -7
sudo apt-get update
sudo sudo apt-get install oracle-java7-jdk oracle-java7-fonts oracle-java7-source 
sudo apt-get dist-upgrade 
```

## 1.7.0_51 的解决方法

OAB 中有一个[问题 123和一个](https://github.com/flexiondotorg/oab-java6/issues/123)[拉取请求](https://github.com/flexiondotorg/oab-java6/pull/125)

这是修补的版本：

```
wget https://raw.github.com/ladios/oab-java6/master/oab-java.sh
chmod +x oab-java.sh
sudo ./oab-java.sh -7
sudo apt-get update
sudo sudo apt-get install oracle-java7-jdk oracle-java7-fonts oracle-java7-source 
sudo apt-get dist-upgrade 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T01:53:53.327

事实证明，链接可能有一些错误。一个更好的链接是[这个](https://askubuntu.com/questions/55848/how-do-i-install-oracle-java-jdk-7)

希望有帮助。页面上的第一个答案就足够了。

# geocoding - 使用google geocoding api jquery从经度和纬度获取城市名称

> ID：14083871
> 
> 赞同：2
> 
> 时间：2012-12-29T16:55:29.827
> 
> 标签：geocoding, latitude-longitude

我想从经度和纬度中获取城市名称。我正在使用以下代码，但它会返回包含城市名称、邮政编码、省和国家/地区的整个地址。我只想要城市名称。

```
 $.ajax({ url:'http://maps.googleapis.com/maps/api/geocode/json?latlng='+position.coords.latitude+','+position.coords.longitude+'&sensor=true',
               success: function(data){
               alert(data.results[4].formatted_address);

               }
               }); 
```

请查看地理编码的结果

```
{
           "long_name" : "Vancouver",
           "short_name" : "Vancouver",
           "types" : [ "locality", "political" ]
        }, 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T18:37:01.223

由于 API 数据类型的性质，formatted_address 总是会返回一个完整的地址字符串。您需要直接引用 address_components 数组中的位置类型。

[谷歌地图地理编码 API](https://developers.google.com/maps/documentation/geocoding/#GeocodingResponses)

因此，例如，您需要在返回的 address_components 数组中搜索位置类型：

```
for (var i = 0; i < data.results[4].address_components.length; i++) {
    for (var j = 0; j < data.results[4].address_components[i].types.length; j++) {
        if(data.results[4].address_components[i].types[j] == 'locality') {
            var city_name = data.results[4].address_components[i].long_name;
            alert(city_name);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-03T05:40:03.517

我遇到了一个问题，并非所有地方都在结果中[4]，所以我遍历了所有地方。

```
url = "http://maps.googleapis.com/maps/api/geocode/json?latlng="+lat+","+lng+"&sensor=true";
$.ajax(url).done(function(data) {
    for (var i = 0; i < data.results.length; i++) {
        for (var j = 0; j < data.results[i].address_components.length; j++) {
            for (var k = 0; k < data.results[i].address_components[j].types.length; k++) {
                if (data.results[i].address_components[j].types[k] === 'locality') {
                    var city_name = data.results[i].address_components[j].long_name;
                }
            }
        }
    }
} 
```

注意：这也使用更新 jQuery AJAX 语法，因为原始帖子..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-05T16:12:58.270

您需要检查一些变量，以确保代码适用于每个职位，即使地点/城市不存在：

```
var url = 'http://maps.googleapis.com/maps/api/geocode/json?latlng='+latitude+','+longitude+'&sensor=false'

$.ajax({
    dataType: "json",
    url: url,
    async: false,
    scriptCharset: "utf-8",
    contentType: "application/json; charset=utf-8",
    success: function(json) 
    {
        var found_city = false;
        if (json && json.results.length > 0)
        {
            for (var k=0; k < json.results.length; k++ ) {                    
                if (json.results[k].address_components) {
                    for (var i = 0; i < json.results[k].address_components.length; i++) {
                        if (json.results[k].address_components[i]) {
                            for (var j = 0; j < json.results[k].address_components[i].types.length; j++) {
                                if(json.results[k].address_components[i].types[j] == 'locality') {
                                    var city_name = json.results[k].address_components[i].long_name;
                                    alert(city_name);
                                    found_city = true
                                }
                            }
                        }
                    }
                }
            }
         }
        if (!found_city) {
            alert("City not found!");
        }
    }
})
.fail(function( jqxhr, textStatus, error ) {
    var err = textStatus + ", " + error;
    alert("Request Failed: " + err );
}); 
```

# javascript - 无法获取未定义或空引用的属性

> ID：14083872
> 
> 赞同：3
> 
> 时间：2012-12-29T16:55:42.477
> 
> 标签：javascript, jquery, internet-explorer

这与我的上一个问题相似，但问题不同。我为我的所有 javascript 函数使用单独的 javascript 文件。该文件由我的主窗口调用，也由我的子窗口在单独的实例中调用。我的代码适用于除 IE 9 和 10 之外的所有浏览器。我没有测试过早期版本的 IE。

IE 说有问题的行是`window.opener.savetoparent($targetval);` 我以前的代码是`opener.savetoparent($targetval);`，在此之前我只是直接从孩子对父母进行了更改。我还进入了 IE 并按照另一篇文章中的建议启用了保护模式，但行为没有改变。 `Savetoparent()`对孩子和父母都可用，所以我必须用 opener 调用它才能在父母中运行。

我得到的错误是：`Unable to get property 'savetoparent' of undefined or null reference.` 这是代码：

```
function saveandclose($wintype, $propid) {

switch($wintype) {
    case 'ccdetail':
        var $targetval = $('#cc-total').val();
        var $fieldname = 'closingcoststotal';
        break;
}

window.opener.savetoparent($targetval);
closewindow();
} 
```

对父函数的安全是：

```
function savetoparent($targetval) {
    $('#' + $parentloc).val($targetval);
    var $name = $('#' + $parentloc).attr("name");
    var $rawtargetval = jsstrtonum($targetval);
    processrvsave($propertyid, $name, $rawtargetval);   
    calcrvtotals();
} 
```

您能对此有所了解的任何信息将不胜感激。

窗口是这样启动的

```
if(window.showModalDialog) { 
  window.showModalDialog($childname + '.php?ploc=' + $parentloc + '&propid=' + $propid, '', 'dialogWidth: ' + $winwidth + 'px; dialogHeight: ' + $winheight + 'px;') 
} 
else { 
  window.open($childname + '.php?ploc=' + $parentloc + '&propid=' + $propid, '', 'width=' + $winwidth + ', height=' + $winheight + ', modal=yes'); 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:10:47.913

showModalDialog 中没有开场白。使用返回值

多年来window.open上也没有模态参数..

以下是如何使用 returnValue

```
if(window.showModalDialog) { 
  $targetval = window.showModalDialog($childname + '.php?ploc=' + $parentloc + '&propid=' + $propid, 
    window,
    'dialogWidth: ' + $winwidth + 'px; dialogHeight: ' + $winheight + 'px;'))
  if(targetval) savetoparent($targetval);
} 
else { 
  window.open($childname + '.php?ploc=' + $parentloc + '&propid=' + $propid, '', 'width=' + $winwidth + ', height=' + $winheight + ', modal=yes'); 
} 
```

然后

```
function saveandclose($wintype, $propid) {
  var $targetval ="";
  switch($wintype) {
    case 'ccdetail':
      $targetval = $('#cc-total').val();
      // var $fieldname = 'closingcoststotal'; I do not see this used anywhere
      break;
  }

  if (window.opener) window.opener.savetoparent($targetval);
  else returnValue = $targetval;
  closewindow();
} 
```

# java - jTextArea 上的查找/替换对话框

> ID：14083875
> 
> 赞同：0
> 
> 时间：2012-12-29T16:56:04.483
> 
> 标签：java, netbeans

我有使用 NetBeans Java 制作记事本的任务。我已经完成了整个事情，我只是不知道如何实现查找/替换对话框，你能帮我解决这个问题吗？我正在使用 jTextArea。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T16:59:52.283

我假设您已经了解[Swing](http://docs.oracle.com/javase/tutorial/uiswing/)以及如何制作适当的对话框（因为您显然已经`JTextArea`为记事本制作了等效的对话框），并且您只想知道如何使其在后端工作。

我要做的是让一个`Scanner`对象通过您的文件来执行查找和替换。

```
String myAlteredText = "";
Scanner scanner = new Scanner(myText);

while(scanner.hasNext()) {
    String next = scanner.next();
    if(next.equals(userFindInput)) {
        myAlteredText += userReplaceInput;
    }
    else {
        myAlteredText += next;
    }
    myAlteredText += " ";
} 
```

`.equalsIgnoreCase()`如果大小写无关紧要，您可以使用。同样，您可以调整以适应您的用户参数（即，如果它不必匹配整个单词，请`.contains()`改用）。您可能需要做一些挑剔的其他事情来保持异常间距和换行符，但这是我会使用的一般方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T20:18:23.287

您可以使用 JTable，尽管这是非常规的。您可以将每个单词加载到一个新单元格中。这样，当您需要替换 1 个单词时，您不需要将整个 jtextarea 更新为 1 个字符，除非我弄错了。然而，这将需要大量工作才能使其正常工作

# java - 通过套接字传输 Java 对象，Byte[]

> ID：14083878
> 
> 赞同：-1
> 
> 时间：2012-12-29T16:56:37.110
> 
> 标签：java, sockets, byte

你会看一下这个吗？：

这是我的客户：

```
try {
        Socket socket = new Socket("127.0.0.1", 3000);
        OutputStream out = socket.getOutputStream();

        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(baos);
        oos.writeObject(mp3data);
        oos.close();

        byte[] bytes = baos.toByteArray();
        out.write(bytes);
        } 
        catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

这是我的服务器：

```
int port = 3000;
        try {
        ServerSocket clientConnect = new ServerSocket(port);
        System.out.println("SimpleServer running on port" + port);
        Socket clientSock = clientConnect.accept();
        InputStream is = clientSock.getInputStream();

    byte[] buffer = new byte[1024];
    int read = is.read(buffer);

    ObjectInputStream ois = new ObjectInputStream(is);
    MP3[] songs = (MP3[])ois.readObject();  

    clientSock.close();

    // HTML erzeugen
    Website site = new Website("index2.html",songs);

    } catch (Exception e) {
    System.out.println (e);
    } 
```

这行不通。我没有得到任何例外，但没有调用网站构造器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:05:04.043

您假设整个字节数组仅在一次调用中被读取`read()`，并且长度正好为 1024 字节。事实并非如此（除非你非常幸运）。此外，您的 ObjectInputStream 正在包装 InputStream ，您已经从中读取了构成消息的字节（或某些字节）。而且，发送方写入的字节不会被刷新。

不要忽略调用的结果`is.read()`：它告诉您实际读取了多少字节。直到它不是-1，你应该继续阅读，循环。

阅读有关[字节流](http://download.oracle.com/javase/tutorial/essential/io/bytestreams.html)的 Java 教程。

也就是说，你让事情变得困难。为什么不直接将对象写入socket输出流，直接从对方的socket输入流中读取对象呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T12:33:46.230

```
int port = 3000;
        try {
        ServerSocket clientConnect = new ServerSocket(port);
        System.out.println("SimpleServer running on port" + port);
        Socket clientSock = clientConnect.accept();
        InputStream is = clientSock.getInputStream();

        byte[] buffer = new byte[1024];

        for (int i = 0; i < buffer.length; i++) {
          int b = is.read();
          if (b  ==-1) break;
          buffer[i] = (byte) b;
        }

        ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(buffer));
        MP3[] songs = (MP3[])ois.readObject();;
        ois.close();

        clientSock.close(); 
```

# javascript - 重置引导模式

> ID：14083879
> 
> 赞同：2
> 
> 时间：2012-12-29T16:56:45.983
> 
> 标签：javascript, jquery, html, twitter-bootstrap

所以，我正在使用引导程序的模态。

我想制作一个向导风格的模态，并提出了以下解决方案：

div 片段：

```
<div class="modal-instance hide fade" id="step1">
 <div id="stepa">
  ...
 </div>
</div>

<div id="stepb" style="display: none;">
 ...
</div> 
```

在步骤-a 中按下按钮时，步骤-b 被加载。

javascript片段：

```
$("#stepa").replaceWith($('#stepb'));
document.getElementById('stepb').style.display = 'block'; 
```

这工作正常。

但是当我关闭模态时。div stepa 仍然被 stepb 取代。我的解决方案是在模态隐藏时构建一个替换回 stepa：

```
$("#myModal").on("hidden", function() { 
//replace the child
}); 
```

我试过了：

```
$('#step1').children().remove();
$('#step1').append($('#stepa')); 
```

和

```
$("#step1").children("div:first").replaceWith($('#stepa')); 
```

但是我很难选择 step-a 作为替换 div，可能是因为它不是一个单独的 div。我的问题是，这是向导样式模式的正确方法还是我应该采取另一种方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:45:18.787

仅仅隐藏前面和后面的步骤而不是复制它们要简单得多。

```
<button type="button" data-toggle="modal" data-target="#myModal">Launch modal</button>

<div id="myModal" class="modal hide fade" data-step="1">
 <div class="step step1">
  <h1>Step 1</h1>
  <button class="btn next">Next</button>
 </div>
 <div class="step step2">
  <h1>Step 2</h1>
  <button class="btn previous">Previous</button>
  <button class="btn next">Next</button>
 </div>
 <div class="step step3">
  <h1>Step 3</h1>
  <button class="btn previous">Previous</button>
  <button class="btn done" data-dismiss="modal">Done</button>
 </div>
</div>

<style type="text/css">
  #myModal > .step { display: none; }​
</style>

<script type="text/javascript">
 $(function() {
  showStep(parseInt($('#myModal').data('step')) || 1);

  $('#myModal .next').on('click', function () {
   showStep(parseInt($('#myModal').data('step')) + 1);
  });

  $('#myModal .previous').on('click', function () {
   showStep(parseInt($('#myModal').data('step')) - 1);
  });

  $('#myModal').on('hidden', function() {
   showStep(1);
  });

  function showStep(step) {
   $('#myModal').data('step', step);
   $('#myModal > .step').hide();
   $('#myModal > .step' + step).show();
  }
 });​
</script> 
```

[http://jsfiddle.net/7kg7z/5/](http://jsfiddle.net/7kg7z/5/)

# python - 配置 htaccess 以提供静态 django 文件

> ID：14083882
> 
> 赞同：8
> 
> 时间：2012-12-29T16:56:59.053
> 
> 标签：python, django, apache, .htaccess, mod-rewrite

我在设置 Apache 以提供静态 Django 文件时遇到问题。我在共享主机上，无权访问 Apache 配置文件。所有示例都`Alias`在 Apache 配置文件中使用，所以我试图弄清楚如何使用 .htaccess 中的 mod_rewrite 来做到这一点。

**我的 setup.py 看起来像这样：**

```
STATIC_ROOT = '/home2/usr/public_html/mydjangoproject/static'
STATIC_URL = '/static/' 
```

我`python manage.py collectstatic`在终端中运行，它完成了它的工作，所以现在我有一个文件夹，`/public_html/mydjangoproject/static`其中当前包含子文件夹`admin`及其内容。

现在我正在尝试将 apache 配置为仅提供静态文件而不是通过 mod_wsgi，正如它在[此处](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/#serving-files)的文档中所说：

> 我们强烈建议使用 django.contrib.staticfiles 来处理管理文件（以及上一节中概述的 Web 服务器；这意味着使用 collectstatic 管理命令来收集 STATIC_ROOT 中的静态文件，**然后配置您的 Web 服务器以提供服务STATIC_ROOT 在 STATIC_URL** )

为此，我在 .htaccess 文件中添加了第 3 行，如下所示。该文件位于`/home2/usr/public_html/mydjangoproject/.htaccess`

**我的 .htaccess 文件：**

```
AddHandler fcgid-script .fcgi
RewriteEngine On
RewriteRule /static/ /home2/usr/public_html/mydjangoproject/static
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ mysite.fcgi/$1 [QSA,L] 
```

请注意，我尝试使用和不使用斜杠的第 3 行，但没有效果。

当我访问 www.mysite.com/mydjangoproject/static/ 时，我收到 500 内部服务器错误。同样，管理页面仍然没有得到它需要的 css 文件。这是怎么回事？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-30T07:56:31.097

好吧，经过一整天的 .htaccess 正则表达式（yukk！），我终于找到了问题所在。

它实际上与 .htaccess 文件无关。问题出在我的**settings.py 中** `STATIC_URL`。原来我必须设置`STATIC_URL = '/mydjangoproject/static/'`才能与`STATIC_ROOT = '/home2/usr/public_html/mydjangoproject/static'`我正在使用的网格相结合。

因此，这里的教训是，如果您将静态文件放在 Apache DocumentRoot 以外的任何位置（`/home2/usr/public_html/`在我的情况下），您必须相应地设置`STATIC_URL`in **settings.py**，而不是使用默认的`/static/`.

希望这能帮助一些可怜的灵魂忍受我所做的一切！

# asp.net-mvc - BootstrapContext 在 ClaimsIdentity 上为空

> ID：14083885
> 
> 赞同：8
> 
> 时间：2012-12-29T16:57:21.383
> 
> 标签：asp.net-mvc, .net-4.5, wif, claims-based-identity, ws-federation

我用 .NET 4.5 创建了一个新的 ASP.NET MVC 应用程序。我已成功使用 STS 设置身份验证。身份验证流程运行良好，我能够在 Thread.CurrentPrincipal 上获取包含所需声明的 ClaimsIdentity。

现在我需要引导令牌来保护对我的服务层的调用。我已在 identityConfiguration 元素上将 saveBootstrapContext 设置为 true。

```
<system.identityModel>
    <identityConfiguration saveBootstrapContext="true"> 
```

但是，ClaimsIdentity 上的 BootstrapContext 属性始终为空。

```
var identity = Thread.CurrentPrincipal.Identity as ClaimsIdentity;
var context = identity.BootstrapContext; // context is always null 
```

我在这里错过了什么吗？这应该很简单:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-11-20T12:44:52.813

通过这些解决了它：

```
<system.identityModel>
    <identityConfiguration saveBootstrapContext="true" />
</system.identityModel> 
```

还需要设置`TokenValidationParameters.SaveSigninToken`，**这与 JwtBearerOptions.SaveTokens 不同**：

```
app.UseWindowsAzureActiveDirectoryBearerAuthentication(
    new WindowsAzureActiveDirectoryBearerAuthenticationOptions {
        Tenant = ConfigurationManager.AppSettings["ida:Tenant"],
        TokenValidationParameters = new TokenValidationParameters {
            SaveSigninToken = true,               
            ValidAudience = ConfigurationManager.AppSettings["ida:Audience"]
        }
    }
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T18:43:32.140

我在 IIS Express 中托管时遇到了这个问题。事实证明，问题出在我的浏览器上——我没有关闭所有浏览器窗口或清除 cookie，因此即使服务器已重新启动（现有的 FedAuth cookie 仍在从浏览器发送）。

一旦我通过关闭所有浏览器窗口、重新启动浏览器并再次执行我的请求来强制重新身份验证，就会出现 BootstrapContext。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-12T04:39:47.597

如果您使用消息处理程序来手动验证令牌，使用`JwtSecurityTokenHandler`提取声明主体并将其附加到当前线程，如[使用 JWT 处理程序实现“穷人”的委托/ActAs](http://www.cloudidentity.com/blog/2013/01/09/using-the-jwt-handler-for-implementing-poor-man-s-delegation-actas/)中所述，当您'正在使用 验证令牌`JwtSecurityTokenHandler.ValidateToken()`，其中一个设置`TokenValidationParameters`是 `SaveBootstrapContext`，设置可以`true`解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-16T10:33:55.753

我正在使用 Microsoft.AspNetCore.Authentication.OpenIdConnect，版本 = 5.0.4.0，设置是这样的：

```
.AddOpenIdConnect(o =>
{
    // . . .
    o.TokenValidationParameters.SaveSigninToken = true;
}) 
```

# ruby-on-rails-3 - 为什么即使设置了allow_unconfirmed_access_for，Devise也不允许未经确认的用户登录？

> ID：14083887
> 
> 赞同：14
> 
> 时间：2012-12-29T16:57:26.077
> 
> 标签：ruby-on-rails-3, devise, devise-confirmable

我们有一个现有的用户群，并且正在添加电子邮件确认。确认是可选的，但将允许附加功能。用户无需确认。我添加了可确认模块并运行了迁移。确认工作如广告。

但是，用户无法登录，因为他们没有得到确认。所有当前用户都有 nil 确认值，这是我们想要的（用户可以随时返回并确认他们的电子邮件）。我已经关注了所有的 Devise wiki 文章并在初始化程序中设置了 allow_unconfirmed_access_for ：

```
config.allow_unconfirmed_access_for = 10.years 
```

我也尝试在我们的用户模型中设置它：

```
devise :confirmable, allow_unconfirmed_access_for: 10.years 
```

我也尝试过使用其他值（1.year、500.days 等）

我的 SessionsController，与 Devise 的方法没有太大区别（[在 github 上](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/sessions_controller.rb)）

```
class Users::SessionsController < Devise::SessionsController
  respond_to :json

  def new
    redirect_to "/#login"
  end

  def create
    resource = warden.authenticate(auth_options)
    if !resource
      render json: {error: "Invalid email or password" }, status: 401 and return
    end

    sign_in(resource_name, resource)
    render "sign_in", formats: [:json], locals: { object: resource }
  end
end 
```

设计的回应：

{"error":"您必须在继续之前确认您的帐户。"}

使用 Rails 3.2.9 设计 2.1.2。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-08T11:39:03.673

Devise 团队发布了一个版本 (2.2.4)，它支持 nil 作为**allow_unconfirmed_access_for**的有效值，这意味着没有限制。问题：[https ://github.com/plataformatec/devise/issues/2275](https://github.com/plataformatec/devise/issues/2275)

您现在可以执行以下操作：

```
config.allow_unconfirmed_access_for = nil 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-17T17:57:01.863

我只需要在我的用户模型中执行此操作，而不是使用 allow_unconfirmed_access_for：

```
 protected
    def confirmation_required?
      false
    end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-05T10:19:32.337

我遇到了同样的问题：打开设计确认后，以前创建的帐户无法登录。

原因在这里：

```
def confirmation_period_valid?
  self.class.allow_unconfirmed_access_for.nil? || (confirmation_sent_at && confirmation_sent_at.utc >= self.class.allow_unconfirmed_access_for.ago)
end 
```

旧帐户的 Confirmation_sent_at 设置为 nil，这就是他们无法登录的原因。

一种解决方案是像这样强制confirmation_sent_at：

```
update users set confirmation_sent_at=created_at where confirmation_sent_at is NULL; 
```

您可以手动完成，也可以创建迁移。

# android - 使用 ArrayList Android 按条件输入排序

> ID：14083888
> 
> 赞同：0
> 
> 时间：2012-12-29T16:57:37.563
> 
> 标签：android

我有一个带有两个字段名称和年份的数组列表。我想用条件输入名称对这个数组进行排序（按名称输入排序）。如果名称相同，它将按年份排序。

```
Example
Name     Year
Ann      2000
Bech     2001
Bach     2013
Bach     2012
Chu      1999 
```

假设我创建的函数是排序，输入是巴赫。结果将显示

```
Name     Year
Bach     2013
Bach     2012
Ann      2000
Bech     2001
Chu      1999 
```

因为输入是巴赫，第一个我想用“巴赫”显示所有名称如果相同的名称，我将按年份（最大 - 最小）对其进行排序。如果不是相同的“Bach”名称，我将使用 compareTo() 按 AZ 排序这是我的代码，但我没有输入条件名称。请创建一个新函数帮助我相同的 sort_inputname(String inputname)

```
 //Class compare Name- Year
public class Search_Name_Year_Comparator implements Comparator<SearchListInformation>
{

            public int compare(SearchListInformation left,
                    SearchListInformation right) {
                // TODO Auto-generated method stub
                 int dateComparison;
                    int dataComparison = 0;
        if(left.getName().compareTo(right.getName())==0)
            {
             if(left.getYear().compareTo(right.getYear())>0)
             {
             return -1;
             }
             else if(left.getYear().compareTo(right.getYear())<0)
             {
                 return  1;
             }
             else 
                 return 0;

             }
        else
         return  left.getName().compareTo(right.getName()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T18:49:13.667

有点难以理解你的问题（我假设你不是以英语为母语的人，但你不能为此受到责备）。据我了解，您想要对具有 2 个属性的对象的 ArrayList 进行排序：名称和年份。让我们假设这些对象称为“SearchListInformation”，因此您尝试对 SearchListInformation 的 ArrayList 进行排序。

我在这里要做的是让 SearchListInformationclass 实现[Comparable](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html#compareTo%28T%29)（不是 Comparator）接口（有关更多信息，请参见链接）。然后您可以使用 Collections.sort 对 ArrayList 进行排序，例如：

```
 ArrayList<SearchListInformation> list = new ArrayList<SearchListInformation>();
    list.add(new Person("Bob", 2000));
    list.add(new Person("Lucy", 2010));
    Collections.sort(list); 
```

如果要使用 Comparator 接口，还可以使用 Collections.sort(List, Comparator)。然后你可以使用你发布的代码，但我会这样简化：

```
 @Override
    public int compare(SearchListInformation left, SearchListInformation right) {
        if(left.getName().compareTo(right.getName())==0)
             return -1*left.getYear().compareTo(right.getYear())
        else
            return  left.getName().compareTo(right.getName());
    } 
```

编辑：如果您希望能够指定应始终位于列表开头的名称，则应使用第二个选项：实现 Comparator 接口，如下所示：

```
 public MyComparator implements Comparator<SearchListInformation> {

        protected String _priorityName;

        public MyComparator(String priorityName) {
            _priorityName = priorityName;
        }

        @Override
        public int compare(SearchListInformation left, SearchListInformation right) {
            if(left.getName().compareTo(right.getName())==0)
                 return -1*left.getYear().compareTo(right.getYear())
            else if(left.getName().equals(_priorityName)
                return -1;
            else if(right.getName().equals(_priorityName)
                return 1;
            else
                return  left.getName().compareTo(right.getName());
        }

    } 
```

然后你可以使用：

```
 Collections.sort(list, new MyComparator("Bach")); 
```

# android - 在 ListFragment 中选择多个项目

> ID：14083890
> 
> 赞同：1
> 
> 时间：2012-12-29T16:57:47.707
> 
> 标签：android, listview, android-listview, android-fragments, android-listfragment

如何将 ListFragment 中的 ListView 设置为多项选择？在标准活动中，我将`android:choiceMode="multipleChoice"`在 xml 文件中指定，并`android.R.layout.simple_list_item_activated_1`在附加适配器时用作 textViewResourceId，一切正常，但在 ListFragment 中，选择的项目没有按应有`android.R.layout.simple_list_item_activated_1`的方式突出显示，选择模式为`singleChocie`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T17:03:43.667

> 如何将 ListFragment 中的 ListView 设置为多项选择？

`getListView().setChoiceMode(ListView.CHOICE_MODE_MULTIPLE)``android:choiceMode="multipleChoice"`来自 Java，或者提供您自己的在 中使用的布局文件，`ListView`除了您的适配器设置。

# jquery - 拆分字符串并在单词之间添加连字符

> ID：14083891
> 
> 赞同：3
> 
> 时间：2012-12-29T16:57:50.980
> 
> 标签：jquery, string, split, lowercase, hyphen

> **可能重复：**
> [用破折号替换空格并使用javascript使所有字母小写](https://stackoverflow.com/questions/1983648/replace-space-with-dash-and-make-all-letters-lower-case-using-javascript)

我需要能够拆分字符串并在单词之间添加连字符。此外，字符应为小写。我想最好的办法是在这里使用正则表达式，但我真的很讨厌正则表达式。有什么建议么？

```
var str = "Foo String"; 
```

**所需的输出：**

```
foo-string 
```

**笔记：**

该字符串始终包含两个单词！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-29T16:59:26.837

像这样的东西应该适用于大多数字符串：

```
str.toLowerCase().trim().split(/\s+/).join('-'); 
```

`.trim()`一些较旧的浏览器不支持，但您可以将其替换为（我认为）`.replace(/^\s+|\s+$/g, '')`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:00:29.287

您可以使用[替换](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)方法：

```
var str = "Foo String";
var result = str.replace(/\s/g, '-').toLowerCase()​​​​​​​; 
```

# asp.net - ASP.NET 在保存之前调整图像大小？

> ID：14083893
> 
> 赞同：0
> 
> 时间：2012-12-29T16:58:24.417
> 
> 标签：asp.net, image, file-upload

下面是我上传和图像并将其保存以供稍后在 GridView 中显示的代码，

如果图像太大，如何在保存之前将图像调整为小尺寸？

```
if (this.fuUpload.HasFile == true)
        {
            string path = Server.MapPath(@"~\images");
            string filename = this.fuUpload.FileName;
            this.fuUpload.SaveAs(path + @"\" + filename);
            this.image.ImageUrl = @"\images\" + filename;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:01:58.977

查看适用于 ASP.NET 的 ImageResizer：

[http://imageresizing.net/](http://imageresizing.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:29:36.183

您可以使用System.Web.Helpers 程序集中内置的[WebImage类。](http://msdn.microsoft.com/en-us/library/system.web.helpers.webimage%28v=vs.111%29.aspx)查看[ASP.NET 网页](http://www.asp.net/web-pages/tutorials/files,-images,-and-media/9-working-with-images)指南中的使用图像。

# ruby-on-rails-3.2 - ArgumentError：参数数量错误（2 比 1）

> ID：14083896
> 
> 赞同：1
> 
> 时间：2012-12-29T16:58:51.830
> 
> 标签：ruby-on-rails-3.2

我是 ROR 的新手，正在完成 Lynda.com 教程。我已经完成了有关身份验证的部分，`wrong number of arguments`当我尝试在 Rails 控制台中保存对用户配置文件的更改时遇到错误。

这是我从控制台得到的结果：

```
>Loading development environment (Rails 3.2.9)
>> user = AdminUser.find(1)
>  AdminUser Load (0.4ms)  SELECT `admin_users`.* FROM `admin_users` WHERE                 `admin_users`.`id` = 1 LIMIT 1
=> #<AdminUser id: 1, first_name: "Stuart", last_name: "Culpepper", email:     "stuart.culpepper@gmail.com", hashed_password: "962b8cf45f025b7e1d155529f8c4bf1c02782164",     created_at: "2012-12-20 22:12:43", updated_at: "2012-12-28 20:04:42", username: "stuartculpepper", salt: "f3e2b128c35f8ec163caed28c4addc9d8de2d186">
>> user.password = 'secret'
=> "secret"
>> user.save
   (0.1ms)  BEGIN
  AdminUser Exists (0.4ms)  SELECT 1 AS one FROM `admin_users` WHERE (`admin_users`.`username` = BINARY 'stuartculpepper' AND `admin_users`.`id` != 1) LIMIT 1
   (0.1ms)  ROLLBACK
ArgumentError: wrong number of arguments (2 for 1)
    from /Users/stuartculpepper/Sites/simple_cms/app/models/admin_user.rb:60:in `hash_with_salt'
    from /Users/stuartculpepper/Sites/simple_cms/app/models/admin_user.rb:60:in `create_hashed_password' 
```

这是来自我的 UserAdmin 模型的代码。第 60 行记录的错误是`self.hashed_password = AdminUser.hash_with_salt(password, salt)`：

```
require 'digest/sha1'

class AdminUser < ActiveRecord::Base

  # set_table_name("admin_users")

  has_and_belongs_to_many :pages
  has_many :section_edits
  has_many :sections, :through => :section_edits

  attr_accessor :password

  EMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i

  #validates_presence_of :first_name
  #validates_length_of :first_name, :maximum => 25
  #validates_presence_of :last_name
  #validates_length_of :last_name, :maximum => 50
  #validates_presence_of :username
  #validates_length_of :username, :within => 8..25
  #validates_uniqueness_of :username
  #validates_presence_of :email
  #validates_length_of :email, :maximum => 100
  #validates_format_of :email, :with => EMAIL_REGEX
  #validates_confirmation_of :email

  #sexy validations
  validates :first_name, :presence => true, :length => {:maximum => 25}
  validates :last_name, :presence => true, :length => {:maximum => 50}
  validates :username, :length => {:within => 8..25}, :uniqueness => true
  validates :email, :presence => true, :length => {:maximum => 100}, :format => EMAIL_REGEX, :confirmation => true 

  # only on create, so other aspects of this user can be updated
  validates_length_of :password, :within => 8..25, :on => :create

  before_save :create_hashed_password
  after_save :clear_password

  scope :named, lambda {|first,last| where(:first_name => first, :last_name => last)}

  attr_accessible :first_name, :last_name, :email, :username 
  attr_protected :hashed_password, :salt

  def self.make_salt(username="")
    Digest::SHA1.hexdigest("Use #{username} with #{Time.now} to make salt")
  end

  def self.hash_with_salt(password="")
    Digest::SHA1.hexdigest("Put #{salt} on the #{password}")
  end

   private

   def create_hashed_password
     # Whenever :password has a value hashing is needed
     unless password.blank?
       # alwys use "self" when assigning values
       self.salt = AdminUser.make_salt(username) if salt.blank?
       self.hashed_password = AdminUser.hash_with_salt(password, salt)
     end
   end

   def clear_password
     # for security and b/c hashing is not needed
     self.password = nil
   end

end 
```

欢迎任何想法，谢谢，如果错误就在我面前，我深表歉意。我已经查看了 stackoverflow 上的所有类似问题，但似乎无法理解我应该如何解决它，但我会继续尝试。;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:03:37.083

看起来您忘记添加第二个参数`salt`：

```
def self.hash_with_salt(password="")
                                  ^ 
```

这就是为什么您在调用时遇到错误的原因：

```
self.hashed_password = AdminUser.hash_with_salt(password, salt) 
```

# php - 在 PHP 中使用 GD 检测图像中的岛屿

> ID：14083899
> 
> 赞同：1
> 
> 时间：2012-12-29T16:59:14.717
> 
> 标签：php, image-processing, gd

我正在开发一个 PHP 图像处理库，该库处理来自游戏的渲染图像，在 PHP 网络主机上进行处理。为了处理图像，我需要找到红色岛屿（色调在 x 0 或 360 的范围内），并在其中找到一个点（不一定是中心，但最好靠近中心）。大约有 100 个这样的岛屿，大小不一。它们是梯形或接近梯形。由于图像是 PNG，并且未压缩且没有抗锯齿，因此边缘清晰到像素，但某些区域可能比其他区域更暗。

目前，我尝试`imagecolorat(`在 GD 中使用并在转换后测试 HSV 值，然后尝试围绕它的点，直到我到达非红色像素，但该过程似乎需要一些时间才能完成，并且似乎遇到 PHP 超时到 5 秒的限制，如果我正在处理一个大图像。有没有更有效的方法来检测所述岛屿并获得一个不一定在中心的点，但最好在附近？

我也尝试过，我知道梯形的大小，假设没有人进入一定的距离并跳过该距离以节省时间。

我不一定需要代码，只需要一个指向正确方向的指针。

我当前的代码：

```
function RGBToHSL($RGB) {
    $r = 0xFF & ($RGB >> 0x10);
    $g = 0xFF & ($RGB >> 0x8); 
```

//截图 }

```
$image=imagecreatefrompng($filename);
$redislands=[];
for($xpos=0; $xpos<=imagesx($image); $xpos++){
    for($ypos=0; $ypos<=imagesy($image); $ypos++){
        if (RGBToHSL(imagecolorat(xpos, ypos)->saturation<=20||RGBToHSL(imagecolorat(xpos, ypos)->saturation>=350){
            $redislands[]=[xpos, ypos]
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:33:21.977

我还没有真正使用过gd，但我只是简单地看了看，我明白了

`imagefilter()`带`IMG_FILTER_EDGEDETECT`标志。

似乎在那之后，您可以使用一个简单的循环识别所有对象（如果对象具有最小大小，您可以使循环使用此条带大小，并且仍然可以保证您会遇到每个对象）。只需寻找带有边缘颜色的像素，当你找到一个时，递归地探索带有边缘颜色的相邻像素。例如，如果一个对象保证至少有 7 个像素高，则在突出显示边缘后，您只需循环遍历第 0、7、14、21 行等中的像素...

一旦你通过使用它周围的边缘提取了组件，我认为你可以很容易地识别它的形状、颜色和中心。

如果边缘没有被可靠地检测到，您可能需要对图像进行阈值处理（gd 可以这样做）。

另一个需要认真考虑的选择是不使用 php，而是使用 php 的 exec() 函数执行外部程序。这开启了使用各种库（如 opencv）和用于这些东西的程序的可能性。它还可以让你用 c 之类的东西编写代码……你会惊讶于你可以在包含几百万个表示像素颜色的整数的 ac 数组上循环的速度有多快。但是，我觉得这对你来说不是一个可行的选择。

您可能会调查的其他事情是访问像素的 php 数组（或字符串）。函数调用开销很大，与像`$pixels[$i]`. 我对图像格式一无所知，但也许您可以保存为位图，然后将其加载到字符串中，然后只使用字符串偏移量。我敢打赌，如果位图具有合适的类似数组的二进制表示形式，那它就会飞起来。

# php - PHP如何将数组推入数组[key]？

> ID：14083914
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:00:11.623
> 
> 标签：php, arrays, sorting

这是我的代码：

```
$orders = Array();

foreach ($unassigned as $uorder) {
    $array = Array(
        "ordid"   => $uorder->idord,
        "fecha"   => $uorder->datorod,
        "cliente" => $uorder->idcli
    );

    array_push($orders[$uorder->user_id], $array);
}

print_r($orders); 
```

结果：

```
Array (
    [vendor1] => 
    [vendor2] => 
) 
```

我想做某种

所以我可以用它`$orders[vendor1][0][ordid]`来找到供应商下的第一个订单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:08:35.760

您必须先分配`$orders[$uorder->user_id]`为数组，否则将项目推送到它上面是没有意义的。此外，您可以使用速记附加符号：

```
if(!isset($orders[$uorder->user_id]))
    $orders[$uorder->user_id] = array();
$orders[$uorder->user_id][] = $array; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:07:41.930

在你的`foreach`循环中检查是否`$orders[$uorder->user_id]`是一个数组，如果不是创建一个。

```
foreach($unassigned as $uorder):

    if(! is_array($orders[$uorder->user_id]))
        $orders[$uorder->user_id] = array();

    array_push($orders[$uorder->user_id],Array("ordid" => $uorder->idord, "fecha" =>  $uorder->datorod, "cliente" => $uorder->idcli));
endforeach; 
```

# html - div在浏览器中导致x滚动的解决方案

> ID：14083915
> 
> 赞同：1
> 
> 时间：2012-12-29T17:00:18.063
> 
> 标签：html, css

请参见示例：http: [//jsfiddle.net/H5x9N/](http://jsfiddle.net/H5x9N/)

我有一个与中心对齐的页面，宽度为 1020 像素。然后，我希望它的左侧和右侧的广告包含在不会导致滚动的 div 中。

这是显示广告的部分代码：

```
.majorad-container {
height: 1px;
left: 50%;
margin: auto auto auto -1250px;
overflow: visible;
position: absolute;
width: 2500px;
z-index: 20;
}
.adscrollleft {
background: url("") repeat-y scroll right top #0A080B;
cursor: pointer;
float: left;
height: 120px;
margin-top: -20px;
width: 720px;
}
.adscrollright {
background: url("") repeat-y scroll left top #0A080B;
cursor: pointer;
float: right;
height: 120px;
margin-top: -20px;
width: 720px;
} 
```

如果我使用 position: fixed for .majorad-container - 没有 x 滚动，但我希望广告随页面向上滚动。

我希望这能很好地解释我的问题，有什么解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:05:31.440

制作广告的背景图片，而不是使用背景封面

```
#divname{
background: url(images/bg.jpg) no-repeat center center fixed; 
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    min-height:0%;
    max-height:100%;

} 
```

# android - Android Canvas 中的转换矩阵？

> ID：14083916
> 
> 赞同：1
> 
> 时间：2012-12-29T17:00:24.850
> 
> 标签：android, matrix, android-canvas, transformation

这个问题是我上一个问题的后续：[将 3D 形状的脸隐藏在另一个 Android 画布后面？](https://stackoverflow.com/q/13899774/1043882)

我有一个画布，我必须在通过一个由`graphics.Camera`. 从数学中，我们知道 的变换矩阵 `Translation`，是，并且`Rotation`保持[角度](https://math.stackexchange.com/a/265882/21779)。因此，当我通过 Camera 进行一些旋转并通过 获取它的矩阵时，我预计该矩阵一定是因为官方文件说：`Scaling``orthogonal``Camera.getMatrix(Matrix matrix)``orthogonal`

> public void getMatrix (Matrix matrix) 自：API 级别 1计算与当前**转换**
> 对应的矩阵并将其复制到提供的矩阵对象。

 **如果它真的是正交矩阵，我可以通过从相机获得的矩阵转换面部的法向量（在旋转之前），结果将与旋转后的面部法向量平行。但是当我将该矩阵乘以它的转置时，结果矩阵并不相同。现在我的问题是：

`getMatrix (Matrix matrix)`真的返回当前**变换**对应的矩阵吗？如果是真的，为什么当我将返回的矩阵乘以它的转置时，结果不一样？**

# java - java泛型比较成语

> ID：14083918
> 
> 赞同：1
> 
> 时间：2012-12-29T17:00:32.063
> 
> 标签：java, generics, comparable

我遇到了泛型类的以下定义：

```
public class binarysearchnode<T extends Comparable<T>> implements Comparable<binarysearchnode<T>>{
.............
} 
```

请帮助解释为什么一个类在实现可比较接口时将自己指定为可比较的类型参数？它与以下内容有何不同：

```
public class binarysearchnode<T extends Comparable<T>> implements Comparable<? super (or extends)T>{
.............
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T17:09:14.933

这使得可以相互比较`binarysearchnode`s。如果它实现`Comparable<T>`了，那将意味着该节点可以与该节点的**值**进行比较，这将是奇怪的。

在类中，您可能会发现如下内容：

```
T value;

public int compareTo(binarysearchnode<T> other) {
   return value.compareTo(other.value);
} 
```

为了能够`compareTo()`像这样实现，值类 ( `T`) 需要与其类的其他对象可比较 - 因此`<T extends Comparable<T>>`在类定义中声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-29T17:10:45.260

这是因为班级作者想要的是能够写：

```
b1.compareTo(b2) 
```

where`b1`和`b2`are`binarysearchnode`实例。开发人员还*添加了一个约束，`T`*以便`T`extends `Comparable<T>`。可能这样 for 的实现`Comparable`只能`binarysearchnode`依赖于`T`实例`Comparable`本身。

更一般地说，虽然一个类`C1`可以实现`Comparable<C2>`，但最终这样做是没有意义的：这并不意味着 的实例`C2`可以与 的实例相比较`C1`。并且由于类型擦除，例如，类不可能*同时*`C1`实现和。 *`Comparable<C1>``Comparable<C2>`*

 *此外，如果`binarysearchnode<T>`要`Comparable<T>`直接实施，您至少会遇到两个问题：

*   您将无法相互比较`binarysearchnode<T>`；
*   给定一个`binarysearchnote<T>`instance`b`和一个`T`instance `t`，你可以写`b.compareTo(t)`但不能`t.compareTo(b)`（因为`T`没有也不能实现`Comparable<binarysearchnode<T>>`），这违反了`Comparable`合同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T19:33:28.350

假设您有一个 superclass`A`和一个 subclass `B`。想象一下超类实现了`Comparable<A>`，那么`B`也会`Comparable<A>`通过继承来实现。

您的 binarysearchnode 类声明如下：

```
public class binarysearchnode<T extends Comparable<T>> 
```

将不能`B`作为`T`（`B`不实现`Comparable<B>`）的类型参数但是当这样定义时：

```
public class binarysearchnode<T extends Comparable<? super T>> 
```

它将能够`B`作为 的类型参数`T`，因为`B`实现`Comparable<A>`了`Comparable<? super T>`.*

# android - 如何读/写列表 到一个包裹？

> ID：14083941
> 
> 赞同：2
> 
> 时间：2012-12-29T17:03:26.550
> 
> 标签：android, date, serialization, parcelable, parcel

我有一个实现`Parcelable`. 将 a对象读/写到 a 的最佳方法`List`是什么？`Date``Parcel`

这是您可以为单个`Date`对象执行此操作的方法：

```
 date = new Date(parcel.readLong()); //read

    parcel.writeLong(date.getTime());   //write 
```

但是怎么做呢`List<Date>`？

我想写的笨拙的方法是遍历所有`Date`对象并构造 a `long[]`，如下所示：

```
long[] datesAsLongs = new long[dates.size()];
for (int i = 0; i < dates.size(); i++)
    datesAsLongs[i] = dates.get(i).getTime();
parcel.writeLongArray(datesAsLongs); 
```

要阅读，你可以这样做：

```
dates = new ArrayList<Date>();
for (long dateAsLong : parcel.createLongArray())
    dates.add(new Date(dateAsLong)); 
```

但我希望会有更好的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:41:51.080

由于 Date 是一个 Serializable 对象，您应该能够使用[`writeList()`](http://developer.android.com/reference/android/os/Parcel.html#writeList%28java.util.List%29)：

```
List<Date> list = new ArrayList<Date>();
parcel.writeList(list); 
```

ArrayList 还实现了 Serializable，因此您可以使用[`writeValue()`](http://developer.android.com/reference/android/os/Parcel.html#writeValue%28java.lang.Object%29)：

```
List<Date> list = new ArrayList<Date>();
parcel.writeValue(list); 
```

您可以使用的最坏情况[`writeSerializable()`](http://developer.android.com/reference/android/os/Parcel.html#writeSerializable%28java.io.Serializable%29)

# objective-c - 将扫描数据（即条形码）传递给 UIWebView？

> ID：14083942
> 
> 赞同：2
> 
> 时间：2012-12-29T17:03:29.503
> 
> 标签：objective-c, ios

我编写了一个本机应用程序，该应用程序利用 iPad2 的硬件附件扫描条形码并成功将其显示在屏幕上。如何发送该数据（条形码）并将其发送到加载带有表单元素的网页的 UIWebview？我希望能够扫描数据并将扫描的数据显示在网络表单上（扫描后用条形码自动填充网络元素/文本字段）。

一个简单的例子：按下屏幕上的扫描按钮，抓取条形码，设置控制器的变量，然后在 UIWebView（例如，加载 google.com）中，在搜索文本字段中自动输入该条形码。

我可以做所有事情来设置控制器的变量，只是不知道如何自动输入到像 google.com 这样的网站上的文本字段这样的 web 元素

# php - Twilio 短信 mysql 插入

> ID：14083943
> 
> 赞同：2
> 
> 时间：2012-12-29T17:03:34.013
> 
> 标签：php, mysql, twilio

我正在尝试将来自 Twilio 的短信中的内容插入 mysql。底部的响应正确返回，但数据未插入 mysql。我不确定我错过了什么。有什么帮助吗？

```
<?php
header("content-type: text/xml");
echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n";

$From = $_REQUEST['From'];
$To = $_REQUEST['To'];
$Body = $_REQUEST['Body'];

$host="host"; // Host name 
$username="user"; // Mysql username 
$password="password"; // Mysql password 
$db_name="database_name"; // Database name 
$tbl_name="table"; // Table name

mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$sql="INSERT INTO $tbl_name (From, To, Body) VALUES ('$From', '$To', '$Body')";
$result=mysql_query($sql);
?>

<Response>
<Sms><?php echo $From ?> has messaged <?php echo $To ?> with the message of <?php echo    $Body ?></Sms>
</Response> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:07:45.017

```
"INSERT INTO $tbl_name (From, To, Body) VALUES ('$From', '$To', '$Body')"; 
```

您在这里有以下问题。

1.  表名是`table`. 表名不能`table`。**`table`是一个 MySQL 关键字**。
2.  **`From`和`To`是mysql中的关键字**。

转义此查询中的关键字（带 `）以使其工作。像这样

```
"INSERT INTO `$tbl_name` (`From`, `To`, `Body`) VALUES ('$From', '$To', '$Body')"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:07:49.777

您没有检查 `mysql_error()`. `FROM`和都是[MySQL 保留关键字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)`TO`，必须在反引号中引用才能用作列名。

```
$sql = "INSERT INTO `$tbl_name` (`From`, `To`, `Body`) VALUES ('$From', '$To', '$Body')";
$result = mysql_query($sql);
if (!$result) {
   // Problem!
   echo mysql_error();
} 
```

除此之外，您的脚本容易受到 SQL 注入的攻击。至少，您必须调用`mysql_real_escape_string()`这些值中的每一个。考虑切换到支持预处理语句的 API，例如 PDO 或 MySQLi。

```
$From = mysql_real_escape_string($_REQUEST['From']);
$To = mysql_real_escape_string($_REQUEST['To']);
$Body = mysql_real_escape_string($_REQUEST['Body']); 
```

# sqlite - 如何在本地（在浏览器中）存储大量数据 - 或在本地 <-> 服务器之间启用最近的数据同步？

> ID：14083944
> 
> 赞同：3
> 
> 时间：2012-12-29T17:03:34.560
> 
> 标签：sqlite, local-storage, data-synchronization

我开发了一个应用程序，需要在本地（在浏览器中）和服务器保持数据同步。服务器数据是 mySQL，本地数据是任何可用的持久存储（localStorage、SQLite、IndexDB 等）的形式。但是所有这些本地存储的数据都有空间限制（有时5MB，有时更多）。我正在寻找可能没有任何限制的东西 - 或者可以为 1 个应用程序创建多个本地存储实例的定制设计系统。这可能吗 ？

另一种方式，我认为它可以工作（但我不知道可以做到这一点的系统/库）是只会将最新的数据量与本地存储同步 - 并将旧数据保留在服务器上并且只有在被调用时它才能自我更新。PHP/JS 中是否有一个库可以做到这一点（比如 facebook - 最新数据显示得很快，但是当我们滚动到旧数据时，它会在本地下载大块数据？

我希望这很清楚......提前感谢您的建议。

# plugins - CRM 插件注册工具错误 - 不安全或安全错误

> ID：14083948
> 
> 赞同：1
> 
> 时间：2012-12-29T17:03:58.913
> 
> 标签：plugins, registration, crm

我第一次尝试运行 CRM 插件注册工具，我收到以下错误：收到来自对方的不安全或安全错误。有关故障代码和详细信息，请参阅内部 FaultException。

我将以下内容用于发现 URL，因为它是基于 Web 的 CRM：[https](https://dev.crm.dynamics.com) ://dev.crm.dynamics.com 。

用户名和标签正确。

提前致谢。

# django - Django中的复合通用视图？

> ID：14083949
> 
> 赞同：1
> 
> 时间：2012-12-29T17:04:00.940
> 
> 标签：django, django-views, django-generic-views

我正在做我的第一个 Django 项目。我需要显示一个包含一对多数据库关系双方的复合页面。为了尽可能地成为 Django-y，我考虑了（基于类的）通用视图。由于没有一个内置的通用视图有任何相似之处，我使用`SingleObjectMixin`and组合了一个复合通用视图`MultipleObjectMixin`，这也意味着我必须扩展基`View`类。

回想起来，这似乎是一项（在我看来）应该是微不足道的事情，而且我认为我采取了错误的方式来解决这个问题。所以我转向 SO 社区寻求帮助：

*   这个问题的正确解决方案是什么？
*   你将如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:20:51.700

我会简单地使用`DetailView`（使用`SingleObjectMixin`），并通过模板中实例上的访问属性访问相关对象：

```
<h2>Main Object</h2>
<p>{{ object.some_field }}</p>
<h2>Related Object</h2>
{% with related=object.related_whatever %}
    <p>{{ related.some_field }}</p>
    <p>{{ related.other_fied }}</p>
{% endwith %} 
```

# android - ID、标签 null 或父 ID 与 com.google.android.gms.maps.MapFragment 的另一个片段重复

> ID：14083950
> 
> 赞同：340
> 
> 时间：2012-12-29T17:04:11.440
> 
> 标签：android, android-fragments, android-maps, illegalargumentexception

我有一个带有三个选项卡的应用程序。

每个选项卡都有自己的布局 .xml 文件。main.xml 有自己的地图片段。它是应用程序首次启动时出现的那个。

一切正常，除非我在选项卡之间切换。如果我尝试切换回地图片段选项卡，则会收到此错误。切换到其他选项卡和在其他选项卡之间切换效果很好。

这里有什么问题？

这是我的主类和我的 main.xml，以及我使用的一个相关类（您还会在底部找到错误日志）

**主班**

```
package com.nfc.demo;

import android.app.ActionBar;
import android.app.ActionBar.Tab;
import android.app.Activity;
import android.app.Fragment;
import android.app.FragmentTransaction;
import android.os.Bundle;
import android.widget.Toast;

public class NFCDemoActivity extends Activity {

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        ActionBar bar = getActionBar();
        bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);

        bar.addTab(bar
                .newTab()
                .setText("Map")
                .setTabListener(
                        new TabListener<MapFragment>(this, "map",
                                MapFragment.class)));
        bar.addTab(bar
                .newTab()
                .setText("Settings")
                .setTabListener(
                        new TabListener<SettingsFragment>(this, "settings",
                                SettingsFragment.class)));
        bar.addTab(bar
                .newTab()
                .setText("About")
                .setTabListener(
                        new TabListener<AboutFragment>(this, "about",
                                AboutFragment.class)));

        if (savedInstanceState != null) {
            bar.setSelectedNavigationItem(savedInstanceState.getInt("tab", 0));
        }
        // setContentView(R.layout.main);

    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putInt("tab", getActionBar().getSelectedNavigationIndex());
    }

    public static class TabListener<T extends Fragment> implements
            ActionBar.TabListener {
        private final Activity mActivity;
        private final String mTag;
        private final Class<T> mClass;
        private final Bundle mArgs;
        private Fragment mFragment;

        public TabListener(Activity activity, String tag, Class<T> clz) {
            this(activity, tag, clz, null);
        }

        public TabListener(Activity activity, String tag, Class<T> clz,
                Bundle args) {
            mActivity = activity;
            mTag = tag;
            mClass = clz;
            mArgs = args;

            // Check to see if we already have a fragment for this tab,
            // probably from a previously saved state. If so, deactivate
            // it, because our initial state is that a tab isn't shown.
            mFragment = mActivity.getFragmentManager().findFragmentByTag(mTag);
            if (mFragment != null && !mFragment.isDetached()) {
                FragmentTransaction ft = mActivity.getFragmentManager()
                        .beginTransaction();
                ft.detach(mFragment);
                ft.commit();
            }
        }

        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            if (mFragment == null) {
                mFragment = Fragment.instantiate(mActivity, mClass.getName(),
                        mArgs);
                ft.add(android.R.id.content, mFragment, mTag);
            } else {
                ft.attach(mFragment);
            }
        }

        public void onTabUnselected(Tab tab, FragmentTransaction ft) {
            if (mFragment != null) {
                ft.detach(mFragment);
            }
        }

        public void onTabReselected(Tab tab, FragmentTransaction ft) {
            Toast.makeText(mActivity, "Reselected!", Toast.LENGTH_SHORT)
                         .show();
        }
    }

} 
```

**主要的.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <fragment
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapFragment"
        android:name="com.google.android.gms.maps.MapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout> 
```

**相关类（ MapFragment.java ）**

```
package com.nfc.demo;

import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class MapFragment extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        super.onCreateView(inflater, container, savedInstanceState);
        return inflater.inflate(R.layout.main, container, false);
    }

    public void onDestroy() {
        super.onDestroy();
    }
} 
```

**错误**

```
android.view.InflateException: Binary XML file line #7: 
     Error inflating class fragment
   at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:704)
   at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
   at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
   at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
   at com.nfc.demo.MapFragment.onCreateView(MapFragment.java:15)
   at android.app.Fragment.performCreateView(Fragment.java:1695)
   at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:885)
   at android.app.FragmentManagerImpl.attachFragment(FragmentManager.java:1255)
   at android.app.BackStackRecord.run(BackStackRecord.java:672)
   at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1435)
   at android.app.FragmentManagerImpl$1.run(FragmentManager.java:441)
   at android.os.Handler.handleCallback(Handler.java:725)
   at android.os.Handler.dispatchMessage(Handler.java:92)
   at android.os.Looper.loop(Looper.java:137)
   at android.app.ActivityThread.main(ActivityThread.java:5039)
   at java.lang.reflect.Method.invokeNative(Native Method)
   at java.lang.reflect.Method.invoke(Method.java:511)
   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
   at dalvik.system.NativeStart.main(Native Method)

Caused by: java.lang.IllegalArgumentException: 
     Binary XML file line #7: Duplicate id 0x7f040005, tag null, or 
     parent id 0xffffffff with another fragment for 
     com.google.android.gms.maps.MapFragment
   at android.app.Activity.onCreateView(Activity.java:4722)
   at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:680)
   ... 19 more 
```

* * *

## 回答 #1

> 赞同：400
> 
> 时间：2013-02-04T20:50:11.770

马特建议的答案有效，但它会导致重新创建和重新绘制地图，这并不总是可取的。经过大量的试验和错误，我找到了一个适合我的解决方案：

```
private static View view;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    if (view != null) {
        ViewGroup parent = (ViewGroup) view.getParent();
        if (parent != null)
            parent.removeView(view);
    }
    try {
        view = inflater.inflate(R.layout.map, container, false);
    } catch (InflateException e) {
        /* map is already there, just return view as it is */
    }
    return view;
} 
```

为了更好地衡量，这里是带有 R.id.mapFragment (android:id="@+id/mapFragment") 的 "map.xml" (R.layout.map)：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mapLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />
</LinearLayout> 
```

我希望这会有所帮助，但我不能保证它不会产生任何不利影响。

**编辑：**有一些不利影响，例如退出应用程序并重新启动时。由于应用程序不一定完全关闭（而只是在后台进入睡眠状态），我之前提交的代码在重新启动应用程序时会失败。我已经将代码更新为适合我的东西，进出地图以及退出和重新启动应用程序，我对 try-catch 位不太满意，但它似乎工作得很好。~~在查看堆栈跟踪时，我突然想到我可以检查地图片段是否在 FragmentManager 中，不需要 try-catch 块，代码已更新。~~

**更多编辑：**事实证明你毕竟需要那个 try-catch。毕竟只是检查地图片段并不能很好地工作。布莱尔。

* * *

## 回答 #2

> 赞同：284
> 
> 时间：2013-11-06T14:53:58.873

问题是你试图做的事情不应该被做。您不应该在其他片段中膨胀片段。来自 Android 的[文档](http://developer.android.com/about/versions/android-4.2.html#NestedFragments)：

> 注意：当布局包含 <fragment> 时，您不能将布局扩展为片段。仅当动态添加到片段时才支持嵌套片段。

虽然您可以使用此处介绍的技巧来完成任务，但我强烈建议您不要这样做。当您尝试为包含另一个片段的片段扩展布局时，无法确定这些黑客将处理每个新的 Android 操作系统所做的事情。

将一个片段添加到另一个片段的唯一 Android 支持的方法是通过来自子片段管理器的事务。

只需将您的 XML 布局更改为一个空容器（如果需要，添加一个 ID）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mapFragmentContainer"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
</LinearLayout> 
```

然后在 Fragment`onViewCreated(View view, @Nullable Bundle savedInstanceState)`方法中：

```
@Override
public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    FragmentManager fm = getChildFragmentManager();
    SupportMapFragment mapFragment = (SupportMapFragment) fm.findFragmentByTag("mapFragment");
    if (mapFragment == null) {
        mapFragment = new SupportMapFragment();
        FragmentTransaction ft = fm.beginTransaction();
        ft.add(R.id.mapFragmentContainer, mapFragment, "mapFragment");
        ft.commit();
        fm.executePendingTransactions();
    }
    mapFragment.getMapAsync(callback);
} 
```

* * *

## 回答 #3

> 赞同：184
> 
> 时间：2013-01-23T16:35:09.340

我有同样的问题，并且能够通过手动删除类`MapFragment`的`onDestroy()`方法来解决它`Fragment`。`MapFragment`以下是在 XML中有效并引用 by ID 的代码：

```
@Override
public void onDestroyView() {
    super.onDestroyView();
    MapFragment f = (MapFragment) getFragmentManager()
                                         .findFragmentById(R.id.map);
    if (f != null) 
        getFragmentManager().beginTransaction().remove(f).commit();
} 
```

如果您不`MapFragment`手动删除它，它会挂起，这样就不会花费大量资源来重新创建/显示地图视图。似乎保留底层`MapView`对于在选项卡之间来回切换非常有用，但是当在片段中使用时，这种行为会导致`MapView`在每个`MapFragment`具有相同 ID 的新标签上创建一个副本。`MapFragment`解决方案是在每次片段膨胀时手动删除并重新创建底层地图。

我还在另一个答案 [ [1](https://stackoverflow.com/a/14466954/61594) ] 中注意到了这一点。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2014-04-09T10:16:43.810

这是我的回答：

1，创建一个布局xml，如下所示：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/map_container"
android:layout_width="match_parent"
android:layout_height="match_parent">
</FrameLayout> 
```

2、在Fragment类中，以编程方式添加谷歌地图。

```
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;
import android.app.Activity;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentTransaction;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

/**
 * A simple {@link android.support.v4.app.Fragment} subclass. Activities that
 * contain this fragment must implement the
 * {@link MapFragment.OnFragmentInteractionListener} interface to handle
 * interaction events. Use the {@link MapFragment#newInstance} factory method to
 * create an instance of this fragment.
 * 
 */
public class MapFragment extends Fragment {
    // TODO: Rename parameter arguments, choose names that match
    private GoogleMap mMap;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        View view = inflater.inflate(R.layout.fragment_map, container, false);
        SupportMapFragment mMapFragment = SupportMapFragment.newInstance();
        mMap = mMapFragment.getMap();
        FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
        transaction.add(R.id.map_container, mMapFragment).commit();
        return view;
    }

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        Log.d("Attach", "on attach");
    }

    @Override
    public void onDetach() {
        super.onDetach();
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-06-16T12:49:02.803

1.  正如@Justin Breitfeller 所提到的，@Vidar Wahlberg 解决方案是一种可能无法在未来版本的 Android 中运行的 hack。
2.  @Vidar Wahlberg 喜欢破解，因为其他解决方案可能“导致重新创建和重新绘制地图，这并不总是可取的”。可以通过维护旧地图片段来防止地图重绘，而不是每次都创建一个新实例。
3.  @Matt 解决方案对我不起作用（IllegalStateException）
4.  正如@Justin Breitfeller 所引用的那样，“当布局包含 . 时，您不能将布局膨胀到片段中。只有在动态添加到片段时才支持嵌套片段。”

我的解决方案：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,                              Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.fragment_map_list, container, false);

    // init
    //mapFragment = (SupportMapFragment)getChildFragmentManager().findFragmentById(R.id.map);
    // don't recreate fragment everytime ensure last map location/state are maintain
    if (mapFragment == null) {
        mapFragment = SupportMapFragment.newInstance();
        mapFragment.getMapAsync(this);
    }
    FragmentTransaction transaction = getChildFragmentManager().beginTransaction();
    // R.id.map is a layout
    transaction.replace(R.id.map, mapFragment).commit();

    return view;
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-06-28T09:32:05.273

全局声明 SupportMapFragment 对象

```
 private SupportMapFragment mapFragment; 
```

在 onCreateView() 方法中放入下面的代码

```
mapFragment = (SupportMapFragment) getChildFragmentManager()
            .findFragmentById(R.id.map);
 mapFragment.getMapAsync(this); 
```

在 onDestroyView() 放下面的代码

```
@Override
public void onDestroyView() {
   super.onDestroyView();

    if (mapFragment != null)
        getFragmentManager().beginTransaction().remove(mapFragment).commit();
} 
```

在您的 xml 文件中放入以下代码

```
 <fragment
    android:id="@+id/map"
    android:name="com.abc.Driver.fragment.FragmentHome"
    class="com.google.android.gms.maps.SupportMapFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    /> 
```

上面的代码解决了我的问题，它工作正常

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-15T00:22:05.390

我会推荐`replace()`而不是`attach()`/`detach()`在您的标签处理中。

或者，切换到`ViewPager`. [这是一个示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/MapsV2/Pager)，显示一个`ViewPager`带有选项卡的 10 个地图。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-07-10T21:30:43.030

另一种解决方案：

```
if (view == null) {
    view = inflater.inflate(R.layout.nearbyplaces, container, false);
} 
```

就是这样，如果不为空，则不需要重新初始化它从父级中删除是不必要的步骤。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-10-31T11:16:44.510

您要返回或膨胀布局两次，只需检查您是否只膨胀一次。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-12-08T20:45:24.993

我今天花了几个小时来寻找原因，幸运的是这个问题不是因为 MapFragment 实现，幸运的是，这不起作用，因为嵌套片段仅通过 rev 11 的支持库支持。

我的实现有一个带有操作栏的活动（在选项卡模式下），有两个选项卡（没有查看器），一个有地图，另一个有一个条目列表。当然，在我的选项卡片段中使用 MapFragment 时我非常天真，等等，每次我切换回地图选项卡时，应用程序都会崩溃。

（如果我的标签片段会膨胀包含任何其他片段的任何布局，我也会遇到同样的问题）。

一种选择是使用 MapView（而不是 MapFragment），尽管有一些开销（请参阅[MapView Docs](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/MapView) as drop-in replacement in layout.xml，另一种选择是使用 rev. 11 的支持库，然后采用编程方法因为嵌套片段既不支持通过布局。或者只是通过显式销毁片段以编程方式解决（如在 Matt / Vidar 的答案中），顺便说一句：使用 MapView （选项 1）实现相同的效果。

但实际上，我不想在每次 tab 离开时都松开地图，也就是说，我想将它保存在内存中并仅在活动关闭时进行清理，所以我决定在 tab 时简单地隐藏/显示地图，请参阅[FragmentTransaction / hide](http://developer.android.com/reference/android/app/FragmentTransaction.html#hide%28android.app.Fragment%29)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-07-11T01:15:46.007

对于那些仍然遇到此问题的人，确保在 Tab 中使用 Map 不会出现此错误的最佳方法是使 Fragment 扩展`SupportMapFragment`而不是在用于 Tab 的 Fragment 内嵌套 a `SupportMapFragment`。

我刚刚使用 a `ViewPager`with a`FragmentPagerAdapter`和第三个选项卡中的 SupportMapFragment 来完成这项工作。

这里是大体结构，注意不需要重写`onCreateView()`方法，也不需要膨胀任何布局xml：

```
public class MapTabFragment extends SupportMapFragment 
                                    implements OnMapReadyCallback {

    private GoogleMap mMap;
    private Marker marker;

    public MapTabFragment() {
    }

    @Override
    public void onResume() {
        super.onResume();

        setUpMapIfNeeded();
    }

    private void setUpMapIfNeeded() {

        if (mMap == null) {

            getMapAsync(this);
        }
    }

    @Override
    public void onMapReady(GoogleMap googleMap) {

        mMap = googleMap;
        setUpMap();
    }

    private void setUpMap() {

        mMap.setMyLocationEnabled(true);
        mMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
        mMap.getUiSettings().setMapToolbarEnabled(false);

        mMap.setOnMapClickListener(new GoogleMap.OnMapClickListener() {

            @Override
            public void onMapClick(LatLng point) {

                //remove previously placed Marker
                if (marker != null) {
                    marker.remove();
                }

                //place marker where user just clicked
                marker = mMap.addMarker(new MarkerOptions().position(point).title("Marker")
                        .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_MAGENTA)));

            }
        });

    }

} 
```

结果：

![在此处输入图像描述](../Images/64ee92c1779e583995202535ac59330a.png)

这是我用来测试的完整类代码，其中包括用于前两个选项卡的占位符片段和用于第三个选项卡的地图片段：

```
public class MainActivity extends AppCompatActivity implements ActionBar.TabListener{

    SectionsPagerAdapter mSectionsPagerAdapter;

    ViewPager mViewPager;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mSectionsPagerAdapter = new SectionsPagerAdapter(getSupportFragmentManager());

        // Set up the ViewPager with the sections adapter.
        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mSectionsPagerAdapter);

        final ActionBar actionBar = getSupportActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        mViewPager.setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
            @Override
            public void onPageSelected(int position) {
                actionBar.setSelectedNavigationItem(position);
            }
        });

        for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
            actionBar.addTab(actionBar.newTab().setText(mSectionsPagerAdapter.getPageTitle(i)).setTabListener(this));
        }

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.menu_main, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {

        int id = item.getItemId();

        if (id == R.id.action_settings) {
            return true;
        }

        return super.onOptionsItemSelected(item);
    }

    @Override
    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
        mViewPager.setCurrentItem(tab.getPosition());
    }

    @Override
    public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction ft) {

    }

    @Override
    public void onTabReselected(ActionBar.Tab tab, FragmentTransaction ft) {

    }

    public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {

            switch (position) {
                case 0:
                    return PlaceholderFragment.newInstance(position + 1);
                case 1:
                    return PlaceholderFragment.newInstance(position + 1);
                case 2:
                    return MapTabFragment.newInstance(position + 1);
            }

            return null;
        }

        @Override
        public int getCount() {
            // Show 3 total pages.
            return 3;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            Locale l = Locale.getDefault();

            switch (position) {
                case 0:
                    return getString(R.string.title_section1).toUpperCase(l);
                case 1:
                    return getString(R.string.title_section2).toUpperCase(l);
                case 2:
                    return getString(R.string.title_section3).toUpperCase(l);
            }
            return null;
        }
    }

    public static class PlaceholderFragment extends Fragment {

        private static final String ARG_SECTION_NUMBER = "section_number";

        TextView text;

        public static PlaceholderFragment newInstance(int sectionNumber) {
            PlaceholderFragment fragment = new PlaceholderFragment();
            Bundle args = new Bundle();
            args.putInt(ARG_SECTION_NUMBER, sectionNumber);
            fragment.setArguments(args);
            return fragment;
        }

        public PlaceholderFragment() {
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                                 Bundle savedInstanceState) {
            View rootView = inflater.inflate(R.layout.fragment_main, container, false);

            text = (TextView) rootView.findViewById(R.id.section_label);
            text.setText("placeholder");

            return rootView;
        }
    }

    public static class MapTabFragment extends SupportMapFragment implements
            OnMapReadyCallback {

        private static final String ARG_SECTION_NUMBER = "section_number";

        private GoogleMap mMap;
        private Marker marker;

        public static MapTabFragment newInstance(int sectionNumber) {
            MapTabFragment fragment = new MapTabFragment();
            Bundle args = new Bundle();
            args.putInt(ARG_SECTION_NUMBER, sectionNumber);
            fragment.setArguments(args);
            return fragment;
        }

        public MapTabFragment() {
        }

        @Override
        public void onResume() {
            super.onResume();

            Log.d("MyMap", "onResume");
            setUpMapIfNeeded();
        }

        private void setUpMapIfNeeded() {

            if (mMap == null) {

                Log.d("MyMap", "setUpMapIfNeeded");

                getMapAsync(this);
            }
        }

        @Override
        public void onMapReady(GoogleMap googleMap) {
            Log.d("MyMap", "onMapReady");
            mMap = googleMap;
            setUpMap();
        }

        private void setUpMap() {

            mMap.setMyLocationEnabled(true);
            mMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
            mMap.getUiSettings().setMapToolbarEnabled(false);

            mMap.setOnMapClickListener(new GoogleMap.OnMapClickListener() {

                @Override
                public void onMapClick(LatLng point) {

                    Log.d("MyMap", "MapClick");

                    //remove previously placed Marker
                    if (marker != null) {
                        marker.remove();
                    }

                    //place marker where user just clicked
                    marker = mMap.addMarker(new MarkerOptions().position(point).title("Marker")
                            .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_MAGENTA)));

                    Log.d("MyMap", "MapClick After Add Marker");

                }
            });

        }
    }
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-04-03T05:32:06.927

我尊重所有的答案，但我找到了一个线性解决方案：如果 n 是选项卡数，那么：

```
 mViewPager.setOffscreenPageLimit(n); 
```

示例：如果提到：

```
 mViewPager.setOffscreenPageLimit(2); 
```

View pager 实现了一个队列，因此您不必让它删除该片段。onCreateView 只被调用一次。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-01-19T20:50:12.317

我参加聚会有点晚了，但这些答案都没有帮助我。我在我的片段中都使用 Google 地图作为**SupportMapFragment**和**PlaceAutocompleteFragment 。**由于所有答案都指出问题在于 SupportMapFragment 是要重新创建和重绘的地图。但是在挖掘后发现我的问题实际上是**PlaceAutocompleteFragment**

因此，对于那些因**SupportMapFragment**和**SupportMapFragment而面临此问题的人来说，这是可行的解决方案**

```
 //Global SupportMapFragment mapFragment;
 mapFragment = (SupportMapFragment) getChildFragmentManager().findFragmentById(R.id.mapFragment);
    FragmentManager fm = getChildFragmentManager();

    if (mapFragment == null) {
        mapFragment = SupportMapFragment.newInstance();
        fm.beginTransaction().replace(R.id.mapFragment, mapFragment).commit();
        fm.executePendingTransactions();
    }

    mapFragment.getMapAsync(this);

    //Global PlaceAutocompleteFragment autocompleteFragment;

    if (autocompleteFragment == null) {
        autocompleteFragment = (PlaceAutocompleteFragment) getActivity().getFragmentManager().findFragmentById(R.id.place_autoCompleteFragment);

    } 
```

并在 onDestroyView 中清除 SupportMapFragment 和 SupportMapFragment

```
@Override
public void onDestroyView() {
    super.onDestroyView();

    if (getActivity() != null) {
        Log.e("res","place dlted");
        android.app.FragmentManager fragmentManager = getActivity().getFragmentManager();
        android.app.FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();
        fragmentTransaction.remove(autocompleteFragment);
        fragmentTransaction.commit(); 
       //Use commitAllowingStateLoss() if getting exception 

        autocompleteFragment = null;
    }

} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-01-13T20:50:24.570

当前不支持嵌套片段。尝试[支持包，修订版 11](http://developer.android.com/tools/extras/support-library.html#Downloading)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-10-11T10:16:55.993

您是否一直在尝试`MapFragment`在布局文件中引用您的自定义类？

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <fragment
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapFragment"
        android:name="com.nfc.demo.MapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent" />
</LinearLayout> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-20T13:59:03.737

如果您只使用 Vidar Wahlberg 答案，则在打开其他活动（例如）并返回地图时会出现错误。或者在我的情况下打开其他活动，然后从新活动再次打开地图（不使用后退按钮）。但是，当您结合 Vidar Wahlberg 解决方案和 Matt 解决方案时，您将不会有例外。

布局

```
<com.example.ui.layout.MapWrapperLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:id="@+id/map_relative_layout">

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:id="@+id/root">

        <fragment xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/map"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            class="com.google.android.gms.maps.SupportMapFragment" />
    </RelativeLayout>
</<com.example.ui.layout.MapWrapperLayout> 
```

分段

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    setHasOptionsMenu(true);
    if (view != null) {
        ViewGroup parent = (ViewGroup) view.getParent();
        if (parent != null){
            parent.removeView(view);
        }
    }
    try {
        view = inflater.inflate(R.layout.map_view, null);
        if(view!=null){
            ViewGroup root = (ViewGroup) view.findViewById(R.id.root);
...

@Override
public void onDestroyView() {
    super.onDestroyView();
    Fragment fragment = this.getSherlockActivity().getSupportFragmentManager().findFragmentById(R.id.map);
    if (fragment != null)
        getFragmentManager().beginTransaction().remove(fragment).commit();
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-11-20T09:44:25.510

我在 viewPager 中有这个，崩溃是因为任何片段都必须有自己的标签，不允许相同片段的重复标签或 ID。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-07-16T11:07:33.173

我认为以前的 App-Compat lib 中存在一些针对子片段的错误。我尝试了@Vidar Wahlberg 和@Matt 的答案，它们对我不起作用。更新 appcompat 库后，我的代码无需任何额外努力即可完美运行。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-12-18T03:08:08.810

**这里要注意的是，您的应用程序将在以下两种情况下严重崩溃：-**

> 1）为了再次使用 Maps 重用片段，当您的显示地图的片段在 onDestroyView 回调中被其他片段替换时，必须删除 MapView 片段。
> 
> 否则，当您尝试*使用 com.google.android.gms.maps.MapFragment 的另一个片段重复 ID、标记 null 或父 ID 时，*会发生两次膨胀相同的片段。
> 
> 2）其次，您不能将 app.Fragment 操作与 android.support.v4.app.Fragment API 操作混合使用，例如，不要使用 android.app.FragmentTransaction 来删除 v4.app.Fragment 类型的 MapView Fragment。混合这将再次导致片段方面的崩溃。

这是正确使用 MapView 的示例代码片段

```
import android.content.Context;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Toast;

import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.GoogleMap.OnMapClickListener;
import com.google.android.gms.maps.MapFragment;
import com.google.android.gms.maps.model.BitmapDescriptorFactory;
import com.google.android.gms.maps.model.CameraPosition;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;
import com.serveroverload.yago.R;

/**
 * @author 663918
 *
 */
public class HomeFragment extends Fragment implements LocationListener {
    // Class to do operations on the Map
    GoogleMap googleMap;
    private LocationManager locationManager;

    public static Fragment newInstance() {
        return new HomeFragment();
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View v = inflater.inflate(R.layout.home_fragment, container, false);
        Bundle bdl = getArguments();

        // setuping locatiomanager to perfrom location related operations
        locationManager = (LocationManager) getActivity().getSystemService(
                Context.LOCATION_SERVICE);

        // Requesting locationmanager for location updates
        locationManager.requestLocationUpdates(
                LocationManager.NETWORK_PROVIDER, 1, 1, this);

        // To get map from MapFragment from layout
        googleMap = ((MapFragment) getActivity().getFragmentManager()
                .findFragmentById(R.id.map)).getMap();

        // To change the map type to Satellite
        // googleMap.setMapType(GoogleMap.MAP_TYPE_SATELLITE);

        // To show our current location in the map with dot
        // googleMap.setMyLocationEnabled(true);

        // To listen action whenever we click on the map
        googleMap.setOnMapClickListener(new OnMapClickListener() {

            @Override
            public void onMapClick(LatLng latLng) {
                /*
                 * LatLng:Class will give us selected position lattigude and
                 * longitude values
                 */
                Toast.makeText(getActivity(), latLng.toString(),
                        Toast.LENGTH_LONG).show();
            }
        });

        changeMapMode(2);

        // googleMap.setSatellite(true);
        googleMap.setTrafficEnabled(true);
        googleMap.setBuildingsEnabled(true);
        googleMap.setMyLocationEnabled(true);

        return v;
    }

    private void doZoom() {
        if (googleMap != null) {
            googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(
                    new LatLng(18.520430, 73.856744), 17));
        }
    }

    private void changeMapMode(int mapMode) {

        if (googleMap != null) {
            switch (mapMode) {
            case 0:
                googleMap.setMapType(GoogleMap.MAP_TYPE_NONE);
                break;

            case 1:
                googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
                break;

            case 2:
                googleMap.setMapType(GoogleMap.MAP_TYPE_SATELLITE);
                break;

            case 3:
                googleMap.setMapType(GoogleMap.MAP_TYPE_TERRAIN);
                break;

            case 4:
                googleMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
                break;

            default:
                break;
            }
        }
    }

    private void createMarker(double latitude, double longitude) {
        // double latitude = 17.385044;
        // double longitude = 78.486671;

        // lets place some 10 random markers
        for (int i = 0; i < 10; i++) {
            // random latitude and logitude
            double[] randomLocation = createRandLocation(latitude, longitude);

            // Adding a marker
            MarkerOptions marker = new MarkerOptions().position(
                    new LatLng(randomLocation[0], randomLocation[1])).title(
                    "Hello Maps " + i);

            Log.e("Random", "> " + randomLocation[0] + ", " + randomLocation[1]);

            // changing marker color
            if (i == 0)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_AZURE));
            if (i == 1)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_BLUE));
            if (i == 2)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_CYAN));
            if (i == 3)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_GREEN));
            if (i == 4)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_MAGENTA));
            if (i == 5)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_ORANGE));
            if (i == 6)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_RED));
            if (i == 7)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_ROSE));
            if (i == 8)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_VIOLET));
            if (i == 9)
                marker.icon(BitmapDescriptorFactory
                        .defaultMarker(BitmapDescriptorFactory.HUE_YELLOW));

            googleMap.addMarker(marker);

            // Move the camera to last position with a zoom level
            if (i == 9) {
                CameraPosition cameraPosition = new CameraPosition.Builder()
                        .target(new LatLng(randomLocation[0], randomLocation[1]))
                        .zoom(15).build();

                googleMap.animateCamera(CameraUpdateFactory
                        .newCameraPosition(cameraPosition));
            }
        }

    }

    /*
     * creating random postion around a location for testing purpose only
     */
    private double[] createRandLocation(double latitude, double longitude) {

        return new double[] { latitude + ((Math.random() - 0.5) / 500),
                longitude + ((Math.random() - 0.5) / 500),
                150 + ((Math.random() - 0.5) * 10) };
    }

    @Override
    public void onLocationChanged(Location location) {

        if (null != googleMap) {
            // To get lattitude value from location object
            double latti = location.getLatitude();
            // To get longitude value from location object
            double longi = location.getLongitude();

            // To hold lattitude and longitude values
            LatLng position = new LatLng(latti, longi);

            createMarker(latti, longi);

            // Creating object to pass our current location to the map
            MarkerOptions markerOptions = new MarkerOptions();
            // To store current location in the markeroptions object
            markerOptions.position(position);

            // Zooming to our current location with zoom level 17.0f
            googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(position,
                    17f));

            // adding markeroptions class object to the map to show our current
            // location in the map with help of default marker
            googleMap.addMarker(markerOptions);
        }

    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onDestroyView() {
        // TODO Auto-generated method stub
        super.onDestroyView();

        locationManager.removeUpdates(this);

        android.app.Fragment fragment = getActivity().getFragmentManager()
                .findFragmentById(R.id.map);
        if (null != fragment) {
            android.app.FragmentTransaction ft = getActivity()
                    .getFragmentManager().beginTransaction();
            ft.remove(fragment);
            ft.commit();
        }
    }

} 
```

XML

```
 <fragment
        android:id="@+id/map"
        android:name="com.google.android.gms.maps.MapFragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
       /> 
```

结果如下所示：-[![在此处输入图像描述](../Images/cf74066eda80e1716a384904c78e16de.png)](https://i.stack.imgur.com/hEnfG.jpg)

希望它会帮助某人。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-09-30T14:08:14.750

在此解决方案中，您不需要使用静态变量；

```
Button nextBtn;

private SupportMapFragment mMapFragment;

@Nullable
@Override
public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
    super.onCreateView(inflater, container, savedInstanceState);

    if (mRootView != null) {
        ViewGroup parent = (ViewGroup) mRootView.getParent();
        Utility.log(0,"removeView","mRootView not NULL");
        if (parent != null) {
            Utility.log(0, "removeView", "view removeViewed");
            parent.removeAllViews();
        }
    }
    else {
        try {
            mRootView = inflater.inflate(R.layout.dummy_fragment_layout_one, container, false);//
        } catch (InflateException e) {
    /* map is already there, just return view as it is  */
            e.printStackTrace();
        }
    }

    return  mRootView;
}

@Override
public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    FragmentManager fm = getChildFragmentManager();
    SupportMapFragment mapFragment = (SupportMapFragment) fm.findFragmentById(R.id.mapView);
    if (mapFragment == null) {
        mapFragment = new SupportMapFragment();
        FragmentTransaction ft = fm.beginTransaction();
        ft.add(R.id.mapView, mapFragment, "mapFragment");
        ft.commit();
        fm.executePendingTransactions();
    }
    //mapFragment.getMapAsync(this);
    nextBtn = (Button) view.findViewById(R.id.nextBtn);
    nextBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Utility.replaceSupportFragment(getActivity(),R.id.dummyFragment,dummyFragment_2.class.getSimpleName(),null,new dummyFragment_2());
        }
    });

}` 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-10-24T17:34:26.640

尝试为您的 mapView 父布局设置一个 id (android:id="@+id/maps_dialog")。为我工作。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-11-20T13:33:22.643

现在来这里的任何人在使用 Google Places打开一个`Dialog`或其他时都会遇到这种类型的错误，试试这个单线（我不知道这有多安全，但它对我有用）：`Fragment``AutocompleteSupportFragment`

`autocompleteFragment.getFragmentManager().beginTransaction().remove(autocompleteFragment).commit();`

在您解雇/销毁您的片段之前。

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2014-01-28T05:57:12.150

```
<?xml version="1.0" encoding="utf-8"?>

  <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="match_parent"
   android:layout_height="match_parent" >

<com.google.android.gms.maps.MapView
    android:id="@+id/mapview"
    android:layout_width="100dip"
    android:layout_height="100dip"
    android:layout_alignParentTop="true"
    android:layout_alignRight="@+id/textView1"
    android:layout_marginRight="15dp" >
</com.google.android.gms.maps.MapView> 
```

为什么不使用 MapView 对象而不是 MapFragment 插入地图？我不确定 MapView 是否有任何限制，尽管我发现它很有帮助。

# java - java编译器如何知道jar中代码的泛型类型信息？

> ID：14083954
> 
> 赞同：3
> 
> 时间：2012-12-29T17:04:58.033
> 
> 标签：java

我有一个重新升级 java 泛型的问题。据我所知，通用信息仅在编译时可用，通过一个称为“类型擦除”的过程，一旦编译代码并生成 .class 文件，所有类型信息都会消失

也就是说，一旦 .java 文件被编译，List myList = new arrayList() 就是 .class 文件字节码所具有的，即使该列表在 .java 文件中被声明为字符串列表。

话虽如此，请考虑以下情况。

我有一个带有签名方法的罐子

```
public void check(List<String> p) 
```

当我从另一个代码调用这个方法时，编译器强制检查方法的参数应该是`List<String>`only，没有别的。

现在由于检查方法存在于 jar（.class 文件）中，编译器如何知道所需的 TYPE 信息`List<String>`，如果在制作 .class 文件时已经删除了 TYPE 信息？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-29T17:07:43.653

类型擦除不会擦除与泛型相关的所有信息。简而言之，所讨论的方法的签名 ( `public void check(List<String> p)`) 被完整保留。保留的信息可以在运行时使用反射 API（如 [`getGenericParameterTypes()`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#getGenericParameterTypes%28%29), [`getTypeParameters()`](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#getTypeParameters%28%29)& 其他方法）获得。

# php - 使用 PHP 或 BASH 文件从扫描仪获取图像？

> ID：14083959
> 
> 赞同：0
> 
> 时间：2012-12-29T17:05:39.703
> 
> 标签：php, bash

我可以使用 PHP 或 BASH 文件从扫描仪获取图像并进行处理吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:11:52.283

`scanadf`SANE 项目中的可用于从命令行驱动扫描仪。阅读[手册页](http://www.sane-project.org/man/scanadf.1.html)以获取可用选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T23:28:53.877

正如[Thomas](https://stackoverflow.com/a/14084010/352449)所提到的，[SANE PROJECT](http://www.sane-project.org/)使您能够通过调用`scanimage`几个参数来扫描命令行。

要实现扫描文档并将其移动到特定位置的目标：

```
<?php
$mode = 'gray';
$reso = 150;
$path = '/my/document/path/myFile.jpg';

/* scan the document in Gray Scale, with 150dpi of resolution
 * pipe a call to convert the resulting document to a JPEG
 * save the document to your desired location
 */ 
exec("scanimage --mode ".$mode." --resolution ".$reso." | pnmtojpeg > ".path);

// check if the document exists...
// save the contents of $path to the database...
?> 
```

# android - 如何从通知中离线使用 JellyBean 语音输入？

> ID：14083963
> 
> 赞同：1
> 
> 时间：2012-12-29T17:06:37.020
> 
> 标签：android, speech-recognition, offline, android-4.2-jelly-bean

我 [在离线模式下的 Android 上的 Voice to text](https://stackoverflow.com/questions/4734030/voice-to-text-on-android-in-offline-mode) 和其他一些帖子中找到了类似的内容，但找不到任何有关 JellyBean 离线语音输入的特定文档。也试过谷歌组，但没有运气。

我想做的是点击通知栏并开始收听语音（甚至离线），然后使用此语音启动一些动作或活动。

感谢您的关注和帮助。

# c# - WPF ComboBox中的级联上下文菜单

> ID：14083965
> 
> 赞同：2
> 
> 时间：2012-12-29T17:06:46.490
> 
> 标签：c#, .net, wpf, vb.net, xaml

我想创建一个`ComboBox`让用户以 Windows XP 开始菜单允许选择程序的方式选择项目的方法：

![](../Images/2fb565107b49fa3e9ea0cb33292c53e5.png)

`ContextMenu`有没有办法在a中插入级联`ComboBox`？

我试过了，但它不能正常工作：

```
<ComboBox>
        <MenuItem Header="Top Level 1">
            <MenuItem Header="Sub Level" />
            <MenuItem Header="Sub Level" />
        </MenuItem>
        <MenuItem Header="Top Level 2">
            <MenuItem Header="Sub Level" />
            <MenuItem Header="Sub Level" />
        </MenuItem>
</ComboBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T20:24:59.973

你会想尝试这样的事情，下一个级别必须在第一级内。

```
<Menu Margin="0,0,0,283">
    <MenuItem Header="Top Level 1">
        <MenuItem Header="Sub Level" />
        <MenuItem Header="Sub Level" />
        <MenuItem Header="Top Level 2">
            <MenuItem Header="Sub Level" />
            <MenuItem Header="Sub Level" />
            <MenuItem Header="Top Level 3">
                <MenuItem Header="Sub Level" />
                <MenuItem Header="Sub Level" />
            </MenuItem>
        </MenuItem>
    </MenuItem>
</Menu> 
```

![在此处输入图像描述](../Images/e34c5118067056f330890ace1be8fba4.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T18:12:26.927

你必须使用组合框吗？

使用该`Menu`控件将使您的 MenuItems 轻松工作......所以我会使用它：[http ://wpftutorial.net/Menus.html](http://wpftutorial.net/Menus.html)

你也可以随时改变它的外观。这里有一些例子：[http ://www.c-sharpcorner.com/uploadfile/mahesh/menus-in-wpf/](http://www.c-sharpcorner.com/uploadfile/mahesh/menus-in-wpf/)

否则，您是否尝试将菜单项简单地包装起来？

# c++ - 如何在 QPixmap 上应用深色遮罩层？

> ID：14083967
> 
> 赞同：2
> 
> 时间：2012-12-29T17:07:18.707
> 
> 标签：c++, qt, pyqt, pyside, qpixmap

我对 Qt 相当陌生，并且一直在做很多阅读和练习练习。我已经搜索了很多，但找不到任何示例。

我有一个加载 .png 图像的 QPixmap 对象。我需要创建一个应用了深色蒙版的 QPixmap 副本。

基本上我希望这个 QPixmap 的图像被一层纯黑色覆盖，其中不透明度设置为 50%。

我知道如何设置 QPixmap 图像的不透明度，但是如何在其上添加一层不透明度的纯黑色？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T17:25:32.877

您可以使用 a`QPainter`和您的半透明`QBrush`将暗层绘制到您的`QPixmap`.

假设加载了您的图像`pic`：`QPixmap`

```
QPainter p(&pic);
QBrush b(QColor(0,0,0,128)); // adjust color and alpha to taste
p.setBrush(b);
p.drawRect(0, 0, 200, 200); 
```

效果（之前/之后）：

> ![在此处输入图像描述](../Images/8efd10a44cf13b6eaa8e491d6bd7871b.png)    对比    ![在此处输入图像描述](../Images/07a370b3ea51eb1f87bf1b59b75d3b72.png)

不透明的黑色边框可以通过在绘画前设置半透明笔来去除。
如果要保留原始图像，请在应用“蒙版”之前复制像素图。

# python - Tweepy 跟踪术语和关注用户

> ID：14083968
> 
> 赞同：3
> 
> 时间：2012-12-29T17:07:22.043
> 
> 标签：python, twitter, twitter-oauth, tweepy

我正在尝试构建一个应用程序来跟踪使用流 twitter API 的特定用户的一些术语。

我根据本[教程](http://andrewbrobinson.com/2011/07/15/using-tweepy-to-access-the-twitter-stream/)使用 tweepy 为流 api 制作了一个工作 python 脚本。但是，只有当我按术语或用户 ID 跟踪推文时，它才有效，但现在两者都是。当我尝试同时使用它们进行搜索时，api 会返回来自任何用户的推文。我的代码在这里：

```
#Acessando a API do twitter com as chaves
auth = tweepy.OAuthHandler(consumer_key, consumer_secret)
auth.set_access_token(access_token_key, access_token_secret)

#Chamando o Listener com o tweepy
api = tweepy.API(auth)

#Chama o stream e passa o que buscar no twitter.
sapi = tweepy.streaming.Stream(auth, CustomStreamListener())
list_users = ['11111','22222']   #Some ids
list_terms = ['term1','term2']   #Some terms
sapi.filter(follow=list_users, track=list_terms) 
```

这两个变量（`list_users`, `list_terms`）分别是用户 ID 列表和术语列表。

如何按用户和条款过滤推文流？有没有办法用 tweepy 过滤器做到这一点？或者我应该在检索推文后进行验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-20T22:44:36.653

Twitter 流 API 使用逻辑评估不同的条件`OR`，即返回带有条款和来自用户的推文的联合。因此，您必须实现自定义`on_data`功能才能使用`AND`.

请注意，您的条件限制为最多[5000 个用户和 400 个术语](https://dev.twitter.com/discussions/4120)，并且由于速率限制可能是一个问题，因此您需要为 api 提供产生较低推文流的条件，并使用所有其他条件过滤传入数据在后期处理中。

> 您最多可以跟踪 5,000 个用户和 400 个关键字——速率限制确实在 Firehose 的 1% 处生效，因此，如果任何时候来自您的关键字和用户的联合的推文量上升到发生在所有推文中的 1% 以上在 Firehose 上“实时”，您将获得最多 1% 的推文，以及一个速率限制通知，通知您错过了多少推文。

# linux - Linux Yum 致命 Python 错误：pycurl：libcurl 链接时版本比编译时版本旧

> ID：14083969
> 
> 赞同：4
> 
> 时间：2012-12-29T17:07:32.543
> 
> 标签：linux, bash, centos, yum, pycurl

所以这个错误让我发疯，我已经多次搜索网络，运行了一些东西但没有结果。使用 yum 时出现以下错误。

```
[root@texas pycurl-7.19.0]# yum update
Fatal Python error: pycurl: libcurl link-time version is older than compile-timeversion
Aborted

[root@texas pycurl-7.19.0]# rpm -qa | grep pycurl
python-pycurl-7.19.0-8.el6.i686
[root@texas pycurl-7.19.0]# rpm -qa | grep curl
curl-7.19.7-26.el6_2.4.i686
libcurl-7.19.7-26.el6_2.4.i686
python-pycurl-7.19.0-8.el6.i686
[root@texas pycurl-7.19.0]# 

[root@texas /]# locate libcurl.so
/usr/lib/libcurl.so
/usr/lib/libcurl.so.4
/usr/lib/libcurl.so.4.1.1

[root@texas /]# locate pycurl
/usr/lib/python2.6/site-packages/pycurl-7.19.0-py2.6.egg-info
/usr/lib/python2.6/site-packages/pycurl.so
/usr/share/doc/python-pycurl-7.19.0 
```

我已经用 curl 重新编译了我的 directadmin 构建，之后也没有任何变化。（我之前已经有使用 curl 的 directadmin 工作正常）

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-05T16:11:38.033

我发现 VMWare Toolkit 在 CentOS VM 上引起了这个问题。

# vi /etc/ld.so.conf.d/vmware-tools-libraries.conf

并在顶部添加以下两行（假设您是 64 位）：

/lib64 /usr/lib64

保存，然后“ldconfig”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-25T15:20:07.750

我只是有同样的问题。有人刚刚玩过 LD_LIBRARY_PATH。

```
unset LD_LIBRARY_PATH; yum update 
```

或者

```
LD_LIBRARY_PATH='' yum update 
```

对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T05:07:02.303

在将一堆库添加到`ldconfig`路径后，我遇到了同样的问题。（我需要`RPostgreSQL`在我的本地 R 安装中安装，并且丢失了`libpq.so`和其他一些；我碰巧有一个包含所有这些的包 - 以及更多 - 并且只是通过`ldconfig`; 添加了该包的库，这完全搞砸`yum`了`pycurl`ETC。）

所以，我只是选择了我想要的**最小库集**并将它们`/usr/local/lib/rpostgresql-depend`添加到`ldconfig`. 现在，R 中的 RPostgreSQL 包都可以`yum`工作了。

您的问题可能是这种情况的变体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-26T13:52:03.403

我的错误很简单。

从 /etc/ld.so.conf 中删除 /usr/local/curl/lib/ 就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-02T09:17:09.493

从谷歌到达这里。因此，对于未来的观众，如果我在没有 root 权限的情况下使用 yum，我会收到此错误。使用`sudo yum`固定它。我正在使用 CentOS 7.9.2009。

# html - 在居中的固定位置 div/overlay-box 中居中和定位元素

> ID：14083972
> 
> 赞同：0
> 
> 时间：2012-12-29T17:07:41.647
> 
> 标签：html, css, positioning

我试图将元素放置在中心位置，并在一个固定的、居中的框内放置其他位置，该框覆盖（当用户滚动时，覆盖框保持不变）我的整个移动网站。

我附上了一张图片来展示我想要实现的目标： ![图表](../Images/425c162ac8e0521cd642f2a7d63b346b.png)

额外的细节包括：

*   “覆盖”的宽度和高度取决于用户移动设备的宽度和高度。即宽度：80%；高度：60%；。
*   我希望图表右上角的图像在我的网站上始终保持这种方式（尽可能在那个角落）。

任何帮助是极大的赞赏。干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T19:05:10.433

查看代码。这主要需要使用相对和绝对定位。您可以稍微调整一下以满足您的需求

**HTML**

```
<div class="body" style="position:relative">
<div class="box">
    <div class="box1"></div>
    <div style="clear:both;height:20px"></div>
    <div class="child"></div>  
    <div style="clear:both;height:20px"></div>
    <div class="child"></div>  
</div>
</div>​ 
```

**CSS**

```
.body{
width:400px;
height:250px;
background-color:#888;
}
.box{
width:80%;
height:150px;
border:1px solid #FFF;
position:relative;
margin:auto;
top:10%;
}
.child {
height:10px;
width:50px;
position:relative;
margin:auto;
background-color:red;
}
.box1{
width:10%;
height:10%;
border:1px solid #FFF;
position:absolute;
top:0;
right:0;
} 
```

​我也添加了小提琴。[http://jsfiddle.net/nQvEW/176/](http://jsfiddle.net/nQvEW/176/)

# facebook - Facebook 应用程序域设置错误

> ID：14083976
> 
> 赞同：0
> 
> 时间：2012-12-29T17:07:54.230
> 
> 标签：facebook, fbconnect

我在制作 facebook 应用程序时尝试进入域，但出现以下错误。

错误您已指定应用程序域但未指定有效的集成 URL。rankfrod.com 必须源自以下之一：站点 URL、移动站点 URL、画布 URL、安全画布 URL、页面选项卡 URL 或安全页面选项卡 URL。

这个错误说明了什么，我试图输入一个有效的网址，即 rankford.com，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:19:16.603

好吧，如果您在设置页面中向下滚动一下，您会看到，

> “选择您的应用如何与 Facebook 集成”

在此处输入您的集成 URL，应用程序域是从该 URL 派生的。

IE

您正在制作一个 IOS 应用程序，检查 IOS 本机应用程序，输入站点 URL 作为[http://www.rankfrod.com](http://www.rankfrod.com)，然后在您的应用程序域中您可以执行 appfrod.com。

祝你好运！

# java - 为什么 JPanel 不显示？

> ID：14083979
> 
> 赞同：1
> 
> 时间：2012-12-29T17:08:33.087
> 
> 标签：java, swing, jframe, awt

我正在学习一些 Java 中的 swing 和 awt 编程，所以我决定制作 Pong。Main 类是父 JFrame。它实例化一个 Ball 和一个 Paddle 并添加它们（它们是 JPanel）。但是，仅显示添加的最后一个。我该如何解决？

代码：

```
public class Main extends JFrame {

public Main() {
    super("Pong");
    add(new Ball());
    add(new Paddle());

    setSize(500, 500);
    setBackground(Color.orange);
    setLocationRelativeTo(null);
    setResizable(false);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
}

public static void main(String[] args) {
    new Main().setVisible(true);
} 
```

}

球类：

```
public class Ball extends JPanel implements ActionListener {

Timer timer;
private Vec2d position;
private Vec2d velocity;
private Dimension ballSize;

public Ball() {
    super();
    position = new Vec2d(50, 50);
    velocity = new Vec2d(2, 3);
    timer = new Timer(25, this);
    ballSize = new Dimension(40, 40);

    timer.start();
}    

@Override
public void actionPerformed(ActionEvent ae) {
    //Perform game frame logic
    bounceBall();
    repaint(); 
}

@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.fillArc((int)position.x, (int)position.y, ballSize.width, 
            ballSize.height, 0, 360);
    position.add(velocity);
}

private void bounceBall() {
    if(position.x < 0 || position.x > getWidth() - ballSize.width) {
        velocity.x *= -1;
    }

    if (position.y < 0|| position.y > getHeight() - ballSize.height) {
        velocity.y *= -1;
    }
} 
```

}

最后是 Paddle 类：

```
public class Paddle extends JPanel implements ActionListener {

private Vec2d position;
private double yVelocity;

private Rectangle rect;

private Timer timer;

public Paddle() {
    super();
    position = new Vec2d(30, 250);
    yVelocity = 0;

    timer = new Timer(25, this);
    timer.start();
}

@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.fillRect((int) position.x, (int) position.y, 20, 40);
}

@Override
public void actionPerformed(ActionEvent ae) {
    repaint();
} 
```

}

请注意，这`Vec2d`只是我放在一起的一个小的二维 Vector 类。此外，Pong 逻辑（桨与球之间的碰撞、得分等）未实现。我只想让它正确绘制

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:20:37.743

您将`Ball`and添加`Paddle`到同一`BorderLayout.CENTER`位置，因此仅显示添加的最后一个（即`Paddle`）。您可以使用 a `GridLayout`here 显示：

```
setLayout(new GridLayout(1, 2));
add(new Paddle());
add(new Ball()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T17:19:37.960

首先要做的是将`JPanel`s 添加到窗口的内容窗格中，而不是添加到窗口本身。我很惊讶您没有收到关于此的运行时警告。

此外，看起来您打算让每个面板都填满屏幕，但只绘制其中的一小部分。如果这确实是您想要的方式，那么您需要`setOpaque(false)`对它们进行操作，以便它们下方的面板可以显示出来。但可能更好的解决方案是有一个单一`JPanel`的绘图表面，并将其`paintComponent()`传递`Graphics`给每个游戏对象，让它们自己绘制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-29T17:19:40.610

```
add(new Ball());
add(new Paddle()); 
```

默认情况下，JFrame 的布局管理器是 BorderLayout。如果您没有指定要添加组件的位置（`BorderLayout.WEST`、 或`EAST`等），则会将其添加到中心。所以你在同一个地方添加两个组件：在中心。因此，仅显示其中之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-29T17:27:02.760

在 Paddle 类中，您永远不会像在球类中那样使用 position.add(velocity) 将速度添加到位置。

# java - 在 ActionBarSherlock 的 NavigationTab 示例中使用片段

> ID：14083982
> 
> 赞同：0
> 
> 时间：2012-12-29T17:08:47.780
> 
> 标签：java, android, actionbarsherlock

我正在尝试使 ActionBarSherlock 中的 TabNavigation 示例适用于转到不同的片段，而不仅仅是更改 textView 的文本（正如我们在此示例中所做的那样）。这是我的代码：

```
import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.ActionBar.Tab;
import com.actionbarsherlock.app.SherlockActivity;
import com.actionbarsherlock.app.SherlockFragment;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;

import android.os.Bundle;
import android.support.v4.app.FragmentTransaction;
import android.view.MenuItem;
import android.widget.Toast;

public class TestNavigation extends SherlockActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        setTheme(R.style.Theme_Sherlock);
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        for (int i = 1; i <= 3; i++) {
            ActionBar.Tab tab = getSupportActionBar().newTab();
            tab.setText("Tab " + i);
            SherlockFragment PlayerFragment = new PhotosActivity();
            tab.setTabListener(new MyTabsListener(PlayerFragment));
            getSupportActionBar().addTab(tab);
        }
    }

    class MyTabsListener implements ActionBar.TabListener {
        public SherlockFragment fragment;

        public MyTabsListener(SherlockFragment fragment) {
            this.fragment = fragment;
        }

        @Override
        public void onTabSelected(Tab tab, FragmentTransaction ft) {
            Toast.makeText(getApplicationContext(), "Reselected!", Toast.LENGTH_LONG).show();   
        }

        @Override
        public void onTabUnselected(Tab tab, FragmentTransaction ft) {
            ft.replace(R.id.fragment_container, fragment);
        }

        @Override
        public void onTabReselected(Tab tab, FragmentTransaction ft) {
            ft.remove(fragment);
        }   
     } 
```

和 main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent" android:layout_gravity="center">
    <LinearLayout
        android:id="@+id/fragment_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

 </LinearLayout>
</LinearLayout> 
```

而 photoActivity 非常简单：

```
public class PhotosActivity extends SherlockFragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.photos_layout, container, false);
    }   
} 
```

你可以帮帮我吗？

如果您认为我的方法不对，请给我一些我可以遵循的示例或教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T17:38:07.257

将您的活动更改为扩展 SherlockFragmentActivity 而不是 SherlockActivity，还有一件事是移动`ft.replace(R.id.fragment_container, fragment);`到`onTabSelected(Tab tab, FragmentTransaction ft)`方法，我认为您不需要`ft.remove(fragment);`在里面， `onTabReselected()`因为如果在选择选项卡时按下选项卡，它将删除您的片段

# java - @generated value - 获取 ID 的值

> ID：14083983
> 
> 赞同：-1
> 
> 时间：2012-12-29T17:08:48.007
> 
> 标签：java, hibernate, annotations

ID 是在将车辆对象持久化到数据库时自动生成的。如何在不持久化的情况下获得 ID 的值？

这是代码：

```
public class Vehicle{

    @Id
    @GeneratedValue
    int id;
    private int year;
    private String model;
    //getters, setters
} 
```

更新

```
 public void updateVehicle(Vehicle vehicle) {

        em.getTransaction().begin();
        Vehicle vehicleDB = em.find(Vehicle.class, vehicle.getId());
        vehicleDB.setYear(vehicle.getYear());
        vehicleDB.setModel(vehicle.getModel());
        em.getTransaction().commit();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-29T17:15:25.723

你不能，因为它是由数据库在持久化时生成的。在此之前，没有定义 id。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-29T17:22:22.767

我们无法在保存之前获取它，但简单的解决方案是在保存您的对象之前，您可以通过选择查询来获取它。

# .net - Windows Metro 内容框架导航和后退按钮可见性

> ID：14083985
> 
> 赞同：0
> 
> 时间：2012-12-29T17:08:52.450
> 
> 标签：.net, windows-8, microsoft-metro, winrt-xaml, windows-store-apps

我有一个 Win Metro 应用程序，它是一个用 C# 编写的 XAML/MonoGame 混合游戏，其 XAML 起始页包含一个加载有菜单按钮的框架。

将此提交到 Win Metro 商店后，我得到了一个测试协议，基本上只包含我的应用程序开始屏幕的屏幕截图，并显示“功能不起作用”，开始屏幕的两个按钮用红色圈出。在我的设置中使用这些按钮从来没有问题（两个不同的 Win 8 机器 + 模拟器）。

另一个奇怪的事情是后退按钮是可见的，这应该是不可能的，因为如果框架是开始框架，我将后退按钮的 IsEnabled 显式设置为 False（最初我在 XAML 中将 IsEnabled 属性绑定设置为内容的*CanGoBack*框架，但这也不起作用）。

这是在用户导航时设置后退按钮可见性的代码。

```
 public MainPage()
    {
        this.InitializeComponent();

        contentFrame.Navigate(typeof(MainFrame));

        Window.Current.SizeChanged += VisualStateChanged;
        contentFrame.Navigated += contentFrame_Navigated;
    }

    void contentFrame_Navigated(object sender, NavigationEventArgs e)
    {
        ApplicationViewState visualState = ApplicationView.Value;

        VisualStateManager.GoToState((Control)e.Content, 
               visualState.ToString(), false);

        if (e.Content is MainFrame)
            backButton.IsEnabled = false;
        else
            backButton.IsEnabled = contentFrame.CanGoBack;
    }

    private void backButton_Click(object sender, RoutedEventArgs e)
    {
        contentFrame.GoBack();
    }

    internal void GoHome()
    {
        while( contentFrame.CanGoBack )
            contentFrame.GoBack();
    } 
```

如果用户选择在那里退出游戏，则从游戏页面调用 GoHome() （从那里我也看不到开始页面中的任何后退按钮）：

```
 private void QuitGame(IUICommand command)
    {
        App.ClearGame();

        Window.Current.Content = App.MainPage;
        Window.Current.Activate();
        App.MainPage.GoHome();
    } 
```

这是 MainFrame 中按钮的代码：

```
 private void onePlayerButton_Click(object sender, RoutedEventArgs e)
    {
        this.Frame.Navigate(typeof(OnePlayerFrame));
    }

    private void twoPlayersButton_Click(object sender, RoutedEventArgs e)
    {
        this.Frame.Navigate(typeof(TwoPlayersFrame));
    } 
```

所以我的问题是：与台式机相比，Surface 设备上后退按钮的可见性处理方式是否不同，或者测试人员如何获得后退按钮可见的屏幕截图？并且 - 在将应用程序提交到 Windows Metro 商店时，你们中是否有人有类似的经历？

我真的希望微软能在测试协议中提供更多细节，从长远来看，它会为每个人节省时间......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T02:53:45.857

这是一个[关于常见 Windows 应用商店认证失败以及如何修复它们](http://blogs.msdn.com/b/jennifer/archive/2012/11/12/common-certification-errors-when-submitting-to-the-windows-store.aspx)可能会有所帮助的博客文章系列。具体来说，请查看有关[“应用程序必须功能齐全”](http://blogs.msdn.com/b/jennifer/archive/2012/11/13/common-windows-store-certification-errors-1-2-app-must-be-fully-functional.aspx)的文章。导致此故障的主要问题是：

*   似乎未完成
*   功能缺失/损坏
*   没有提供足够的信息

在您的场景中，可能发生的情况是测试人员导航到另一个页面，然后返回您的主页/起始页面（并且后退按钮似乎向后导航到他们所在的任何子页面）......取决于您的方式当然，实现了后退按钮。

您能否详细说明开始屏幕上用红色圈出的两个按钮的作用，或者提供点击处理程序中的代码示例？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T09:47:38.503

在没有解释的情况下投反对票？至少澄清什么对这个问题没有用......

无论如何，如果其他人面临类似问题，我想我会跟进最终使该应用程序正常工作的方法。

在提交通过认证获得应用程序之前，我进行了两项更改：我更改了顺序

```
 contentFrame.Navigated += contentFrame_Navigated; 
```

和

```
 contentFrame.Navigate(typeof(MainFrame)); 
```

（所以和上面一样，这意味着 backButton.IsEnabled 在启动时在事件处理程序中显式设置为 false）

我还删除了对

```
ApplicationData.Current.LocalFolder.CreateFileAsync("startuplog.txt", CreationCollisionOption.ReplaceExisting); 
```

在我在本地通过 WACK 进行调试时留下的 App.xaml.cs 中。

在这些更改之后，它起作用了。

# android - 另一个 AsyncTask 问题 - 内部类看不到 doInBackground 方法

> ID：14083988
> 
> 赞同：1
> 
> 时间：2012-12-29T17:09:04.293
> 
> 标签：android, json, class, android-asynctask

显然我在这里遗漏了一些东西——我已经阅读了关于 AsyncTasks 和线程的 developer.android 参考和指南材料——加上这里的大量帖子，这也不是我的第一个牛仔竞技表演。我有一个内部 AsyncTask 类，它从 url 中获取 JSON 并解析它。我一直遇到访问问题，似乎无法获得正确的组合。这是主要公共类中的一段代码，即“消费者”。我可以添加更多代码，但我相信这将证明需要什么。蒂亚！

```
// some method
if(arg1==b){
    b.setClickable(false);  
    a.setClickable(true); 
    // next, build the url
    srchStr = urla + "&q=upc:" + value1 + urlc;
    // execute the parser
    new JSONParser().execute(value1);
}

// ...

static class JSONParser extends AsyncTask<String, Void, JSONObject> {
    static InputStream is = null; 
    static JSONObject jObj = null; 
    static String json = "";      

    public JSONObject doInBackground(String url) {    //getJSONFromUrl
        // Making HTTP request 
        try { 
            // defaultHttpClient 
            DefaultHttpClient httpClient = new DefaultHttpClient(); 
            HttpPost httpPost = new HttpPost(url);    
            HttpResponse httpResponse = httpClient.execute(httpPost); 
            HttpEntity httpEntity = httpResponse.getEntity(); 
            is = httpEntity.getContent();            

        } catch (UnsupportedEncodingException e) { 
            e.printStackTrace(); 
        } catch (ClientProtocolException e) { 
            e.printStackTrace(); 
        } catch (IOException e) { 
            e.printStackTrace(); 
        } 

        try { 
            BufferedReader reader = new BufferedReader(new InputStreamReader( 
                    is, "iso-8859-1"), 8); 
            StringBuilder sb = new StringBuilder(); 
            String line = null; 
            while ((line = reader.readLine()) != null) { 
                sb.append(line + "\n"); 
            } 
            is.close(); 
            json = sb.toString(); 
        } catch (Exception e) { 
            Log.e("Buffer Error", "Error converting result " + e.toString()); 
        } 

        // try to parse the string to a JSON object 
        try { 
            jObj = new JSONObject(json); 
        } catch (JSONException e) { 
            Log.e("JSON Parser", "Error parsing data " + e.toString()); 
        } 

        // return JSON String 
        return jObj;      
    } 
    protected void onPostExecute(String result) {
        //TextView tv2 = (TextView) findViewById(R.id.tv2);
        tv2.setText("json"); // txt.setText(result);

    }       
} 
```

错误出现在行上：

```
static class JSONParser extends AsyncTask<String, Void, JSONObject> { 
```

这是：

> Consumer.JSONParser 类型必须实现继承的抽象方法 AsyncTask.doInBackground(String...)

....然而，doInBackground 方法在那里.....

我希望这是足够的信息来解决这个问题。我希望这是我一直想念的简单的东西......

更新：我进行了推荐的更改，因为它们确实有意义，但是它现在可以编译，但不会运行。请再看一下，如果我弄错了，或者这是另一个问题，请告诉我......这是更新的代码：

```
if(arg1==b){
    b.setClickable(false);  
    a.setClickable(true); 
    // next, build the url
    srchStr = urla + "&q=upc:" + value1 + urlc;
    // execute the parser
    new JSONParser().execute(value1);
    }   
}

    static class JSONParser extends AsyncTask<String, Void, JSONObject> {
    static InputStream is = null; 
    static JSONObject jObj = null; 
    static String json = "";      

     public JSONObject doInBackground(String... urls) {       //getJSONFromUrl
         Consumer.srchStr = urls[0];
        // Making HTTP request 
        try { 
            // defaultHttpClient 
            DefaultHttpClient httpClient = new DefaultHttpClient(); 
            HttpPost httpPost = new HttpPost(srchStr);    
            HttpResponse httpResponse = httpClient.execute(httpPost); 
            HttpEntity httpEntity = httpResponse.getEntity(); 
            is = httpEntity.getContent();            

        } catch (UnsupportedEncodingException e) { 
            e.printStackTrace(); 
        } catch (ClientProtocolException e) { 
            e.printStackTrace(); 
        } catch (IOException e) { 
            e.printStackTrace(); 
        } 

        try { 
            BufferedReader reader = new BufferedReader(new InputStreamReader( 
                    is, "iso-8859-1"), 8); 
            StringBuilder sb = new StringBuilder(); 
            String line = null; 
            while ((line = reader.readLine()) != null) { 
                sb.append(line + "\n"); 
            } 
            is.close(); 
            json = sb.toString(); 
        } catch (Exception e) { 
            Log.e("Buffer Error", "Error converting result " + e.toString()); 
        } 

        // try to parse the string to a JSON object 
        try { 
            jObj = new JSONObject(json); 
        } catch (JSONException e) { 
            Log.e("JSON Parser", "Error parsing data " + e.toString()); 
        } 

        // return JSON String 
        return jObj;      
    } 
    protected void onPostExecute(JSONObject result) {
        //TextView tv2 = (TextView) findViewById(R.id.tv2);
        result = jObj;
        tv2.setText("result"); // txt.setText(result);          
    }       
}
} 
```

和 logcat 文本：

```
12-29 21:35:25.530: W/dalvikvm(2237): threadid=7: thread exiting with uncaught exception (group=0x4001d800)
12-29 21:35:25.605: E/AndroidRuntime(2237): FATAL EXCEPTION: AsyncTask #1
12-29 21:35:25.605: E/AndroidRuntime(2237): java.lang.RuntimeException: An error occured while executing doInBackground()
12-29 21:35:25.605: E/AndroidRuntime(2237):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.lang.Thread.run(Thread.java:1096)
12-29 21:35:25.605: E/AndroidRuntime(2237): Caused by: java.lang.IllegalStateException: Target host must not be null, or set in parameters.
12-29 21:35:25.605: E/AndroidRuntime(2237):     at org.apache.http.impl.client.DefaultRequestDirector.determineRoute(DefaultRequestDirector.java:561)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:292)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at com.clicsys.pbuster.Consumer$JSONParser.doInBackground(Consumer.java:116)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at com.clicsys.pbuster.Consumer$JSONParser.doInBackground(Consumer.java:1)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
12-29 21:35:25.605: E/AndroidRuntime(2237):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
12-29 21:35:25.605: E/AndroidRuntime(2237):     ... 4 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T17:12:13.673

你需要改变你的方法签名，所以它是

```
public JSONObject doInBackground(String... url) 
```

这是因为[`doInBackground()`](http://developer.android.com/reference/android/os/AsyncTask.html#doInBackground%28Params...%29)接受无限数量的参数。要访问`String`您想要的，您可以执行以下操作

```
String currentUrl = url [0]; 
```

此外，您的 onPostExecute 需要 a`JSONObject`作为参数。这不会使用，`...`因为`onPostExecute()`只接受 1 个参数。

# php - HTML 操作：匹配前 X 个 HTML 标记并移动它们

> ID：14083989
> 
> 赞同：1
> 
> 时间：2012-12-29T17:09:09.907
> 
> 标签：php, html, regex, dom, html-parsing

假设我有这样的代码：

```
<img src="001">
<img src="002">

<p>Some content here.</p>

<img src="003"> 
```

我现在要做的是匹配前两个图像（001 和 002）并将那部分代码存储在变量中。我不想对第三张图片做任何事情。

Id 使用了类似的东西，`preg_match_all('/<img .*>/', $result);`但它显然与所有图像匹配。不仅仅是出现在代码顶部的那些。如何修改该正则表达式以仅选择代码顶部的图像。

我想做的就是到现在。我在一个变量中有`<h2>`带有标题的标签，在第二个变量中有上面的代码。我想在标签之前移动第一个 X 图像`<h2>`或*在*第一个 X 图像之后插入该`<h2>`标签。所有这些都在后端 PHP 中。使用 CSS 制作它会很有趣，但 flexbox 还没有出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T18:04:29.757

你需要划分问题来解决它。您在这里有两个主要部分：

1.  将 HTML 划分为顶部和底部部分。
2.  对（两个？）HTML 字符串进行 DOMDocument 操作。

让我们这样做：

第一部分实际上非常简单。假设所有行分隔符都是`"\n"`，而空行实际上是空行`"\n\n"`。那么这是一个简单的字符串操作：

```
list($top, $bottom) = explode("\n\n", $html, 2); 
```

这已经解决了第一部分。顶部`$top`的 html 保存在`$bottom`.

让我们继续第二部分。

例如，通过简单的`DOMDocument`操作，您现在可以获取所有图像的列表：

```
$topDoc = new DOMDocument();
$topDoc->loadHTML($top);
$topImages = $topDoc->getElementsByTagname('img'); 
```

您现在唯一需要做的就是从其父图像中删除每个图像：

```
$image->parentNode->removeChild($image); 
```

然后在`<h2>`元素之前插入它：

```
$anchor = $topDoc->getElementsByTagName('h2')->item(0);
$anchor->parentNode->insertBefore($image, $anchor); 
```

你很好。完整代码示例：

```
$html = <<<HTML
<h2>Title here</h2>
<img src="001">
<p>Some content here. (for testing purposes)</p>
<img src="002">

<h2>Second Title here (for testing purposes)</h2>
<p>Some content here.</p>

<img src="003">
HTML;

list($top, $bottom) = explode("\n\n", $html, 2);

$topDoc = new DOMDocument();
$topDoc->loadHTML($top);
$topImages = $topDoc->getElementsByTagname('img');
$anchor = $topDoc->getElementsByTagName('h2')->item(0);
foreach($topImages as $image) {
    $image->parentNode->removeChild($image);
    $anchor->parentNode->insertBefore($image, $anchor);
}

foreach($topDoc->getElementsByTagName('body')->item(0)->childNodes as $child)
    echo $topDoc->saveHTML($child);
echo $bottom; 
```

输出：

```
<img src="001"><img src="002"><h2>Title here</h2>
<p>Some content here. (for testing purposes)</p>
<h2>Second Title here (for testing purposes)</h2>
<p>Some content here.</p>

<img src="003"> 
```

# mysql - 使用 MySql 进行 EF5 数据库迁移

> ID：14083990
> 
> 赞同：0
> 
> 时间：2012-12-29T17:09:13.403
> 
> 标签：mysql

在对 MySql 数据库执行 Enable-Migrations 命令时遇到以下错误：

```
PM> Enable-Migrations -ContextTypeName CodeFirstEFMySqlA1.Models.DataContext
Checking if the context targets an existing database...
System.ArgumentOutOfRangeException: startIndex cannot be larger than length of string.
Parameter name: startIndex
   at System.String.InternalSubStringWithChecks(Int32 startIndex, Int32 length, Boolean fAlwaysCopy)
   at System.Data.Entity.Migrations.DbMigrator.ScaffoldInitialCreate(String namespace)
   at System.Data.Entity.Migrations.Design.MigrationScaffolder.ScaffoldInitialCreate()
   at   System.Data.Entity.Migrations.Design.ToolingFacade.InitialCreateScaffoldRunner.Scaffold(MigrationScaffolder scaffolder)
   at System.Data.Entity.Migrations.Design.ToolingFacade.ScaffoldRunner.RunCore()
   at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run()
startIndex cannot be larger than length of string.
Parameter name: startIndex 
```

该项目是使用以下内容创建的： - ASP.NET MVC4 - EF5 Code First - MySql 数据库服务器 - MySql.Data、MySql.Data.Entity - 使用 System.Data.Entity.IDatabaseInitializer 实现了自定义数据库初始化程序，用于创建迁移历史记录表。

模型：

```
public class Product
{
    [Key]
    public int Id { get; set; }

    [Required, MaxLength(100)]
    public string Name { get; set; }

    public int Rank { get; set; }

    [MaxLength(100)]
    public string Type { get; set; }
} 
```

执行命令“Enable-Migrations”后，生成了 Configuration.cs 类，但没有生成迁移类。如果我尝试执行“添加迁移”命令，则会引发相同的错误“startIndex 不能大于字符串长度”。

我的尝试是测试 EF5 Code First 和数据库迁移功能在 MySql 数据库服务器上的使用情况。正如我所见，可以使用自定义数据库初始化程序来完成数据库创建，但是我无法使数据库迁移正常工作。

对这个问题的任何想法都非常感谢提前谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T17:39:35.660

感谢 Kirk Woll，我能够找到解决上述问题的方法。

我使用了 MySQL Data Connector v.6.6.4，它内置了对 EF 5 的支持。现在，Database Migrations 可以正常使用 MySql。请注意，我必须删除以前的数据库并让 EF 使用 Update-Database 命令创建一个新数据库。

参考：[MySQL 5.5 + .NET 连接器 + 实体框架 + 迁移 = FormatException](https://stackoverflow.com/questions/12380147/mysql-5-5-net-connector-entity-framework-migrations-formatexception)

# javascript - 抛出错误时将响应重定向到 HTTP 500 错误处理程序

> ID：14083994
> 
> 赞同：0
> 
> 时间：2012-12-29T17:09:42.757
> 
> 标签：javascript, node.js, express

如果某个底层组件抛出错误，我如何通知 express.js 堆栈？我正在使用一个底层数据访问框架，它偶尔会引发特定错误（例如，当在数据库中找不到记录时）。

express.js 是否提供了一种直接跳转到 500 错误处理程序并将响应重定向到相应页面的方法？不幸的是，我看不到使用标准 express.js 方式（使用`next`中间件处理程序）的直接方法，除非我可能在任何地方都使用 try...catch，这也有点开销

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-24T02:37:54.907

对于那些仍在寻找像我这样的答案的人：

1- 使用 express 默认的 errorHandler 中间件

```
app.use(express.errorHandler()); 
```

或者

2-提供您自己的错误处理中间件：

```
app.use(function (error, req, res, next) {
            res.status(500);
            res.render("500.jade", {});
        }); 
```

理想情况下，您希望使用第一个选项`DEV`和第二个选项`PROD`

```
// development only
if ('development' == app.get('env')) {
  app.use(express.errorHandler());
}

app.use((function (error, req, res, next) {
  res.status(500);
  res.render("500.jade", {});
}); 
```

注意：错误处理程序应策略性地放置在 app.router*下方*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T17:15:34.840

通常您不会重定向到 500 页。您所做的是让异常传播，如果抛出异常，node.js 将为您执行 500。

我有一些我遵循的相关规则。也许你会发现它们很有用：

*   切勿在异步代码（如 node.js）中使用 try/catch。错误通常通过提供的回调的第一个参数传播。
*   如果我需要向用户返回错误，我会使用`res.send('Error', 500);`

# kendo-ui - 剑道 UI 分离器高度

> ID：14083996
> 
> 赞同：1
> 
> 时间：2012-12-29T17:10:15.697
> 
> 标签：kendo-ui, splitter

3 小时前发布（固定链接）

大家好，

我正在使用 Kendo UI 做一个 ASP.NET MVC 项目，但我遇到了一个小问题。

我有一个用于调整拆分器大小的 jquery 脚本。

```
window.onload = function () {
      $("#vertical").css("height", $(window).height());
}; 
```

但是当我加载布局时，我的尺寸很好，但显示效果不佳。

如果我隐藏我的底部拆分器，然后显示它，这是很好的显示 (2.png) 谢谢大家的回答:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T16:39:31.720

您是否尝试过以下 css #vertical{height:100%;} ？

# apache-flex - 在 flex 中监听自定义事件

> ID：14083997
> 
> 赞同：0
> 
> 时间：2012-12-29T17:10:17.623
> 
> 标签：apache-flex, events

我在 actionscript 中创建了一个带有自定义属性的自定义事件。我可以使用自定义属性调度自定义事件（在 Main.mxml 中），但我无法在我的应用程序的其他任何地方侦听此事件。我正在尝试在自定义组件中收听此事件。

当我调试时，我可以确认事件以正确的值正确分派。

Main.mxml 的片段：

```
var userid:String = result.charAt(4);
//dispatch a custom event in which we store the userid
var event_userid:MyEvent = new MyEvent(MyEvent.COMPLETE,userid);
dispatchEvent(event_userid); 
```

自定义事件类：

```
package ownASClass
{
    {
//http://stackoverflow.com/questions/1729470/attaching-a-property-to-an-event-in-flex-as3
    import flash.events.Event;

    public class MyEvent extends Event
    {

        public static const COMPLETE:String = "MyEventComplete";

        public var myCustomProperty:*;

        public function MyEvent(type:String, prop:*) :void
        {
            super(type,true);
            myCustomProperty = prop;

        }

        //override clone() so your event bubbles correctly
        override public function clone() :Event {

            return new MyEvent(this.type, this.myCustomProperty)

        }
    }
} 
```

}

我在自定义组件中收听此事件：

```
//init gets called as: initialize="init();
protected function init():void
        {
            //add evt listener for custom event to get userid
            this.parentApplication.addEventListener(MyEvent.COMPLETE,getUserid);
            //my custom component is part of a viewstack defined in main.mxml
        }

protected function getUserid(event:Event):void
        {
            //do something (but this never gets called)

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T08:31:24.317

```
protected function init():void
    {
        //add evt listener for custom event to get userid
        this.parentApplication.addEventListener(MyEvent.COMPLETE,getUserid);
        //my custom component is part of a viewstack defined in main.mxml
    } 
```

请尝试将上面的行更改如下 -

```
this.addEventListener(MyEvent.COMPLETE,getUserid); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T21:15:34.300

为此使用了一种解决方法，意识到我真的不需要调度自定义事件。在主应用程序中声明了我的用户 ID，并在我的组件中调用它：

```
public var userid:String = FlexGlobals.topLevelApplication.userid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-29T20:08:37.567

事件通常会“冒泡”从子窗口到父窗口再到应用程序（main.mxml）的链。

[http://livedocs.adobe.com/flex/3/html/help.html?content=events_08.html](http://livedocs.adobe.com/flex/3/html/help.html?content=events_08.html)

如果您尝试使用事件来向某个子对象发出信号，则需要将其定位到那里并注册一个事件侦听器。