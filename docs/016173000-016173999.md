# StackOverflow 问答 16173000-16173999

# javascript - 使用 javascript 在 Internet Explorer 8 上的选项卡中打开新页面

> ID：16173002
> 
> 赞同：0
> 
> 时间：2013-04-23T15:13:43.413
> 
> 标签：javascript, jquery, html, internet-explorer

在下面使用这个

```
window.open('aPage.aspx'); 
```

我可以使用每个浏览器在新选项卡中打开页面，除了 Internet Explorer 8。

我在这篇文章中看到 [如何在 Internet Explorer 的新选项卡中打开网页？](https://stackoverflow.com/questions/10709073/how-to-open-webpages-in-a-new-tab-in-internet-explorer) 我可以用标签'a'的'target'属性来做到这一点。

当另一个页面加载时，我需要有这种行为。所以我不点击链接/按钮，选项卡上的页面会自动打开，我需要使用 javascript。

有什么提示可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:19:15.227

As the answers to the example you posted suggest, you cannot change the settings of the browser. All you can do is add `target="_blank"` to links and `window.open(url,'_blank');` to the javascript open. This will tell the browser to open in a new window but the browser will honor the user's preference setting to open in a new tab or window.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:17:56.313

您可以使用 window.load 或 jquery $(window).load(function () {}); 并将您的代码放入函数中。您可以使用 window.open(url,'_blank'); 正如你提到的

# firefox-os - 在 FirefoxOS 中存储数据

> ID：16173004
> 
> 赞同：8
> 
> 时间：2013-04-23T15:13:51.923
> 
> 标签：firefox-os

我正在尝试做一些 FirefoxOS 应用程序，但我还没有看到任何简单的方法来存储本地数据。我听说过 IndexedDB，但它似乎太复杂了。还有其他选择吗？如果没有，是否有任何简单的教程？

我考虑过存储和恢复远程数据（执行 croos 域请求），但我遇到了一些权限问题。有没有关于 FirefoxOS 的 XHR 的教程？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T22:02:56.287

我能找到的最好的 IndexDB 文档是在 MDN中[使用 IndexDB 。](https://developer.mozilla.org/en-US/docs/IndexedDB/Using_IndexedDB)

并且有很多默认的 Firefox OS 应用程序 ( [gaia](https://github.com/mozilla-b2g/gaia) )，例如画廊、使用 IndexDB 的浏览器。你可以看到它在现实生活中是如何工作的。

或者您可以使用更轻量级的[window.localStorage](https://developer.mozilla.org/en-US/docs/DOM/Storage#localStorage) API，它的工作原理类似于字典。

```
localStorage.setItem(key, value); 
localStorage.getItem(key); 
```

编辑：请注意，不建议使用 localStorage，因为它会阻塞主线程。你应该`gaia/shared/asyncStorage`改用。

对于 XHR，您可以查看[Firefox-OS-Boilerplate-App](https://github.com/robnyman/Firefox-OS-Boilerplate-App)以获得有效的 XHR 演示

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-20T18:09:47.983

我建议你使用 asyncStorage 而不是 localStorage，它是 localStorage 的异步版本，具有相同的 api 和 IndexedDB 的优点。

您可以查看代码并通过阅读文件的注释了解如何使用它：

[https://github.com/mozilla-b2g/gaia/blob/master/shared/js/async_storage.js](https://github.com/mozilla-b2g/gaia/blob/master/shared/js/async_storage.js)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:41:00.977

播客参考应用程序讨论了 IndexedDB 和 SystemXHR，这是用于执行跨域请求的特权 API： [https ://marketplace.firefox.com/developers/docs/apps/podcasts](https://marketplace.firefox.com/developers/docs/apps/podcasts)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-03T11:59:53.037

您可以通过使用数据存储在 Firefox Os 中使用 DataStore，您还可以与其他应用程序共享该数据，您还可以授予其他应用程序在数据存储中写入或不写入的权限。

你可以点击这个链接。

[https://developer.mozilla.org/en-US/docs/Archive/Firefox_OS/API/Data_Store_API/Using_the_Data_Store_API](https://developer.mozilla.org/en-US/docs/Archive/Firefox_OS/API/Data_Store_API/Using_the_Data_Store_API)

只是为了使用数据存储，您的应用程序需要经过认证。

```
navigator.getDataStores('mystore').then((store)=>{
    store[0].getLength().then((ln)=> console.log(ln))
}) 
```

# c++ - 使用指针算法和指向该结构元素的指针释放结构

> ID：16173007
> 
> 赞同：0
> 
> 时间：2013-04-23T15:13:56.207
> 
> 标签：c++, structure, pointer-arithmetic

我在 C++ 中有以下结构：

```
struct wrapper 
{
    // Param constructor
    wrapper(unsigned int _id, const char* _string1, unsigned int _year, 
         unsigned int _value, unsigned int _usage, const char* _string2)
         :
         id(_id), year(_year), value(_value), usage(_usage)
         {
             int len = strlen(_string1);
             string1 = new char[len + 1]();
             strncpy(string1, _string1, len);

             len = strlen(_string2);
             string2 = new char[len + 1]();
             strncpy(string2, _string2, len);
         };
    // Destructor
    ~wrapper()
         {
             if(string1 != NULL) 
                delete [] string1;
             if(string2 != NULL) 
                delete [] string2;
         }

    // Elements
    unsigned int     id;         
    unsigned int     year;       
    unsigned int     value;     
    unsigned int     usage; 
    char*            string1;    
    char*            string2;   
}; 
```

在 main.cpp 中，假设我为此结构的一个对象分配内存：

```
wrapper* testObj = new wrapper(125600, "Hello", 2013, 300, 0, "bye bye"); 
```

我现在可以使用指针算术和指向结构元素之一的指针来删除整个对象吗？

像这样的东西：

```
void*  ptr = &(testObj->string2);

ptr -= 0x14;

delete (wrapper*)ptr; 
```

我已经测试了自己，显然它可以工作，但我不能 100% 确定这相当于`delete testObj`.

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:22:50.723

从技术上讲，这样的代码可以工作（忽略`wrapper testObj`应该是`wrapper* testObj`并且偏移量不一定是这样的事实`0x14`，例如调试构建有时会填充结构，也许我错过了一些其他细节），但这是一个可怕的、可怕的想法。我怎么强调都不为过，这有多可怕。

而不是`0x14`你可以使用[`offsetof`](http://www.cplusplus.com/reference/cstddef/offsetof/)宏。

如果你喜欢在调试器的陪伴下过夜，当然，随意这样做。

我假设这个问题的原因是纯粹好奇是否可以使用指针算法从成员导航到父级，而不是你想在生产代码中真正做到这一点。请告诉我我是对的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:29:45.717

> 我现在可以使用指针算术和指向结构元素之一的指针来删除整个对象吗？

理论上，是的。

您提供的指针`delete`需要具有正确的值，并且该值是来自现有的指针变量还是以这种方式“调整”一个并不重要。

您还需要考虑指针的*类型*；如果不出意外，您应该`char*`在执行算术之前强制转换，以便您以单字节为单位移动。您当前的代码将无法编译，因为`ISO C++ forbids incrementing a pointer of type 'void*'`（a 有多大`void`？）。

**但是**，我建议*根本不*要这样做。`0x14`考虑到对齐和填充以及结构改变形状的潜力，您的幻数是不可靠的。

相反，存储一个指向实际对象的指针。也停止所有可怕的记忆混乱，并使用`std::string`. 目前，您缺少复制构造函数正在呈现一个令人讨厌的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:43:17.193

你*可以*用指针算术来做这种事情。你是否*应该*是一个完全不同的故事。考虑一下这个宏（我知道...我知道...），它会给你一个结构的基地址，给定它的类型，结构成员的名称和指向该成员的指针：

```
#define ADDRESS_FROM_MEMBER(T, member, ptr) reinterpret_cast<T*>( \
  reinterpret_cast<unsigned char *>(ptr) - (ptrdiff_t)(&(reinterpret_cast<T*>(0))->member)) 
```

# xml - 如何从 Github 下载文本文件？

> ID：16173010
> 
> 赞同：2
> 
> 时间：2013-04-23T15:13:58.313
> 
> 标签：xml, url, github, download

使用什么链接从 GitHub 获取文本文件的自动文件下载？

此示例适用于二进制文件，但不适用于基于文本的文件，例如 xml

```
http://github.com/downloads/TheHolyWaffle/ChampionHelper/ChampionHelper-4.jar 
```

文件位于

```
https://raw.github.com/Nodeclipse/eclipse-node-ide/master/ENodeIDE.p2f 
```

[与使用 Java 从 Github 下载二进制文件](https://stackoverflow.com/questions/13441720)相关

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:48:24.147

火狐

`File` `Save Page As`

IE浏览器

`File` `Save as`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T18:53:06.683

我认为问题不在于 Github，问题在于您的浏览器：如果文件可以直接读取它会，但如果他不能（例如二进制文件），那么它将被下载。

# iphone - 旋转 UIView 不变形

> ID：16173011
> 
> 赞同：1
> 
> 时间：2013-04-23T15:14:01.520
> 
> 标签：iphone, ios, ios6, rotation, accelerometer

我正在根据加速度计数据旋转 UIView，它工作正常，只是 UIView 变形了。我不确定如何解决这个问题。这是我的 didAccelerate 方法中的代码：

```
float kFilteringFactor = 0.175;
CGFloat x = acceleration.x * kFilteringFactor + acceleration.x * (1.0 - kFilteringFactor);
CGFloat y = acceleration.y * kFilteringFactor + acceleration.y * (1.0 - kFilteringFactor);
float radians = M_PI - atan2(y, x);
[_horizonView setTransform:CGAffineTransformMakeRotation(radians)]; 
```

我是否错误地执行了旋转？我已经更改了 Xcode 中的原点，但这似乎没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:46:49.893

会发生什么样的变形？我认为轮换很好。

# javascript - jquery在文档加载时加载json

> ID：16173025
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:14:28.220
> 
> 标签：javascript, jquery, json

我很困惑为什么我的这个简单代码是错误的。

我只想在加载文档时在选择中列出 json 数据。这是我的jQuery代码：

```
<script>
$(document).ready(function(){
        $("#choose").load(function(event){
            $.getJSON('data/colors.json', function(jd) {
                $('#choose').html('<option value="' + jd.name'">' + jd.name + '</option>');
                $('#choose').append('<option value="' + jd.name'">' + jd.name + '</option>');
            });
        });
   });
</script> 
```

这是我的html：

```
<select id="choose" style="width:200px">

   </select> 
```

最后这是我的 json 文件：

```
[
{
"name": "Yoza",
"age" : "22",
"sex": "male"
},
{
"name": "nayla",
"age" : "18",
"sex": "female"
}
] 
```

如何加载每个json。所以我可以加载更多的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:18:15.973

尝试

```
$(function(){

    $.getJSON('data.json', function(jd) {
        $.each(jd, function(i, v){
            $('#choose').append('<option value="' + v.name + '">' + v.name + '</option>');
        })
    })

}); 
```

演示：[小提琴](http://plnkr.co/edit/z5QQOBPvvcIC4ULs9qsJ?p=preview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:20:00.890

Try this

```
 var data = [];

    $.getJSON( 'data/colors.json', function( jd ) {

          $.each( jd, function( k,v ){

              data.push('<option value="' + v.name'">' + v.name + '</option>');

             });
            $('#choose').append( data.join('') );
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:20:21.760

why do you wait for `$('#choose')` to be loading ? Your function is executed when `document` is ready, so `$('#choose')` is ready too.

# ios - CTFontGetAscent() 与 OSX 上匹配字体的上升有很大不同

> ID：16173026
> 
> 赞同：0
> 
> 时间：2013-04-23T15:14:28.923
> 
> 标签：ios, xcode, fonts, core-text

比较 CTFontGetAscent() 的输出和 OS X 上相同字体的上升值，我得到两个非常不同的值（考虑点大小）。

示例：Helvetica Neue 的上升率为 952，导致点数为 35 的上升率为 33。CTFontGetAscent 返回 16。Marker Felt（宽）的上升率为 800，导致点数为 35 的上升率为 27 点。CTFontGetAscent 返回37.

考虑 CTFontGetUnitsPerEm() 的值不会产生正确的值。

设备上的字体真的与“桌面字体”有很大不同，还是我遗漏了什么？还是 CoreText 返回了不正确的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T09:23:49.380

（回答我自己的问题）许多桌面应用程序报告了不同的上升值，可在字体的 Windows 兼容性表（“OS/2”表）中找到。

可以通过以下方式访问表的原始字节： CTFontCopyTable(myFontRef, 'OS/2', 0);

表中的所有字节都按网络顺序排列（参见[http://linux.about.com/library/cmd/blcmdl3_ntohs.htm](http://linux.about.com/library/cmd/blcmdl3_ntohs.htm)）

前 2 个字节构成版本号。每个表格版本的规范可以在[http://www.microsoft.com/typography/otspec/os2.htm](http://www.microsoft.com/typography/otspec/os2.htm)找到。请记住将每个字段的字节翻转到主机顺序。

表格的“sTypoAscent”字段给出了上升值。将它除以 CTFont (CTFontGetUnitsPerEm) 提供的 unitsPerEm 值，就可以得到字体的上升百分比。

# php - mysql_real_escape_string 没有转义所有类型的“

> ID：16173027
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:14:29.843
> 
> 标签：php, mysql

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:20:36.607

Yup. Never rely on black-listing mechanisms like that for safety. It's broken, and can result in some interesting SQL injections:

```
$query = "SELECT id, title, body FROM posts WHERE id = " . mysql_real_escape_string($_GET['id']); 
```

This can still be injected:

```
1 OR 1=1 
```

Resulting in:

```
SELECT id, title, body FROM posts WHERE id = 1 OR 1=1 
```

All results are returned. Not convinced this is bad? Ok...

```
1 OR 1=1 UNION SELECT id, username, password FROM users 
```

Whoops!

Why is this injectable? The developer just forgot to quote the numeric ID. If you can *ever* see yourself making this mistake, you should seek a better solution.

* * *

My advice? Stop using string concatenation, stop using the deprecated `mysql_` functions, and shift to MySQLi or PDO with parameterised queries, where content is explicitly separated from query language.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:15:11.693

花引号不需要转义，因为它们对 MySQL 没有特殊意义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T15:15:17.863

这是因为“智能”引号不会被 MySQL 引擎识别为引号，因此绝对不会造成注入攻击的风险。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T15:16:32.277

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T16:42:56.503

正如我所想的那样，事实证明这是一个复杂的问题。

在我的字符串上使用**utf8_encode** ( [http://php.net/manual/en/function.utf8-encode.php](http://php.net/manual/en/function.utf8-encode.php) ) 后一切正常。

谢谢大家的帮助（尤其是多项式）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T15:19:11.383

# php - 单元测试代码生成

> ID：16173032
> 
> 赞同：0
> 
> 时间：2013-04-23T15:14:37.627
> 
> 标签：php, unit-testing, phpunit, code-generation

我们有一个由 2 年开发的项目，其架构设计不佳。现在一天根本没有任何单元测试。

当前版本的系统运行良好，但我们迫切需要重构核心模块。

预算也有限，所以我们不能雇佣足够数量的开发人员来编写单元测试。

是否有可能为单元测试自动生成代码，例如与数据交互，假设现在系统工作正常并且当前系统的输出可以转换为 XML-fixtures 以进行单元测试？

这种方法使我们能够快速开始重构现有代码并在某些核心功能因更改而损坏时立即收到反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T05:14:07.257

我会警惕任何声称能够自动确定任意应用程序的需求并将其编码为良好的单元测试的工具。

相反，我会花一点时间设置至少一些高级功能测试。例如，这些可能在代码中，使用完整堆栈加载一组预定义的输入并检查已知结果。或者使用 Selenium 或 FitNesse 等自动化工具甚至更高级别（取决于您正在构建的应用程序类型）。首先专注于测试系统中最重要的部分，因为时间总是有限的。

展望未来，我建议获取一份 Michael Feathers 的《[有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)，它正好解决了您面临的问题：需要对大型、未经测试的代码库进行更新，同时确保您不会破坏现有的功能过程。

# php - php区分不同的表ID？

> ID：16173042
> 
> 赞同：0
> 
> 时间：2013-04-23T15:15:09.280
> 
> 标签：php, mysql, sql, complexity-theory, object-identity

我有不同的对象，有 id，所有的 id 都是唯一的。

对象

*   照片
*   喂养
*   事件
*   评论

所有的id都是独一无二的，再也不会重复了。

我想像这样在 url 中传递该 id：http: [//domain.com/](http://domain.com/) {object_id} 和对象 id 应该告诉我它属于哪个对象以及它的 id 是什么。也许通过php来做。

我在某处读到它可以通过带有前置文本或不同 ID 的 base_convert 来完成。没有把握。

**编辑：**

当前 id 和 url

*   照片 - [http://domain.com/654156165165](http://domain.com/654156165165)
*   饲料 - [http://domain.com/654156165164](http://domain.com/654156165164)
*   事件 - [http://domain.com/654156165163](http://domain.com/654156165163)
*   评论 - [http://domain.com/654156165110](http://domain.com/654156165110)

假设我们在此页面[http://domain.com/654156165165](http://domain.com/654156165165)上，我们怎么知道这是照片、提要、事件或评论的 id？

**解决方案1**我正在考虑

*   使用前置/附加一些整数重现 id，以识别它属于哪个对象
*   使用新 ID [http://domain.com/654646545412请求页面](http://domain.com/654646545412)
*   用 php 检查这个 id 属于哪个对象以及该对象的实际 id 是什么（在删除前置/附加整数之后）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:31:21.663

只需查询数据库以获取对象详细信息。我确定您在那里存储了对象类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T18:38:11.500

您应该在数据库中查询该对象。您提到这由于开销而令人望而却步，但是只要您`WHERE id = :objectID`在查询中包含正确的索引，这应该不会太糟糕。或者，您可以创建一个对象表，其中包含所有 ID 及其对象类型，查询该对象，然后仅查询适当的表。

# python - Python Primes 数组混淆

> ID：16173049
> 
> 赞同：1
> 
> 时间：2013-04-23T15:15:23.003
> 
> 标签：python, math, primes

我对这个 python 素数检查功能有一个小问题。这真的很愚蠢，但是`[2]`in the in the`for n in [2]`有什么作用呢？

我理解检查素数的公式，没问题，但不知道那`[2]`是什么。

来自：[http ://en.wikibooks.org/wiki/Python_and_Math](http://en.wikibooks.org/wiki/Python_and_Math)

```
from math import ceil
def prime(input):
    for n in [2] + range(3, int(ceil(input**0.5)), 2):
        if input%n == 0:
            return False
    return True 
```

感谢您回答我的愚蠢问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:16:42.970

这只是列表添加：

```
>>> range(3, 10, 2)
[3, 5, 7, 9]
>>> [2] + range(3, 10, 2)
[2, 3, 5, 7, 9] 
```

即他们想检查被 2 整除，但显然没有必要检查被 4、6、8 整除......所以通过这个操作，它是在奇数列表的开头“添加”一个 2。

顺便说一句，这个函数被破坏了——它返回`prime(2) == False`并且`prime(1) == True`都是错误的。

# excel - Excel 中的 VBA 代码

> ID：16173050
> 
> 赞同：0
> 
> 时间：2013-04-23T15:15:23.430
> 
> 标签：excel, vba

我有这个代码，虽然它声明有一个错误。我想要做的是从当前活动工作表中完成 csv 文件导出，并将其与当前单元格中的信息一起保存`A2`。

```
Sub exportCSV()
     ' export Macro

    Range("A:F").Select
    Selection.Copy
    Workbooks.Add
    ActiveSheet.Paste
    strName = AprilPayslips.Range("A2")
    ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & "\" & strName
    , FileFormat:=xlCSV, CreateBackup:=False
    Application.DisplayAlerts = False
    Application.DisplayAlerts = True
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:37:31.587

如果您想要将单元格的值作为字符串，请询问它:)

```
strName = Range("A2").Value 
```

这两行不会做任何事情，所以删除它们：

```
Application.DisplayAlerts = False
Application.DisplayAlerts = True 
```

路径应始终包含尾部斜杠，因此您无需将其添加到：

```
Sub exportCSV()
    strName = Range("A2").Value
    Range("A:F").Select
    Selection.Copy
    Workbooks.Add
    ActiveSheet.Paste
    ActiveWorkbook.SaveAs Filename:=ThisWorkbook.Path & strName, FileFormat:=xlCSV, CreateBackup:=False
End Sub 
```

应该对您有用，但是除非您可以确定 A2 的内容将始终是有效的文件名，否则您可能会遇到问题，除非您添加一些额外的验证。

# dependencies - 指定构建顺序依赖项

> ID：16173052
> 
> 赞同：0
> 
> 时间：2013-04-23T15:15:26.950
> 
> 标签：dependencies, gradle

我有模块`A`和`B`. `B`是 的子项目`A`。

在模块测试中，`A`我想使用来自`B`.

如何在不指定任何编译依赖项的情况下指定`A.tests`应该在之后执行？`B.build`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:39:00.327

您应该能够在 A 的 buildscript 中声明该依赖项：

```
tests.dependsOn(":B:build") 
```

其中 tests 是 A 中的测试任务（你的意思是“测试”吗？）

干杯，勒内

# c# - Xamarin Android 应用程序更新

> ID：16173054
> 
> 赞同：7
> 
> 时间：2013-04-23T15:15:33.517
> 
> 标签：c#, android, visual-studio-2010, xamarin, android-2.3-gingerbread

我已经在 Xamarin 上开发 Android 应用程序 3 个月了，但是当有新版本可用时，我面临更新应用程序的问题。该应用程序未发布到任何应用程序商店（因为我们在内部使用它），我知道 Play 商店可以进行自动更新，但我需要在我们的服务器上查找更新，我希望所有这些都可以静默完成（在的背景）。这是我当前的代码，这个副本是设备的应用程序：

```
intent.SetData(Android.Net.Uri.Parse(@"http://xxxxx/downloads/app.test-signed.apk"));
StartActivity(intent); 
```

这会将应用程序安装到设备上：

```
intent.SetDataAndType(Android.Net.Uri.FromFile(new Java.IO.File(Android.OS.Environment.ExternalStorageDirectory.Path + 
"/app.test-signed.apk")), "application/vnd.android.package-archive");
StartActivity(intent); 
```

但是这样它会要求安装（我认为这不是正确的方法），并且在安装后不会自动启动我的应用程序。而且我不确定如何等到应用程序完成下载后再尝试安装。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-12T15:28:41.947

我的一个应用程序也有类似的问题，该应用程序只在我公司内部使用。我不希望该应用程序进入广阔的世界，因为普通大众对它没有任何用处。

因此，我们所做的是在 Google Play 中将最终产品发布为“Alpha 版本”。您使用一组可以访问它的设备的电子邮件地址设置了一个 Google 群组，一旦下载了该应用程序，它就会像 Google Play 中的任何其他应用程序一样进行更新。

可以选择将其“升级”为 Beta 版或生产版，但鉴于它从未得到推广，因此永远无法在 Google Play 上搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-21T15:20:34.987

正如Corey Ogburn 提到的，没有root 就无法进行静默安装。

[尽管已经在Xamarin 的论坛](https://forums.xamarin.com/discussion/15658/xamarin-android-app-autoupdate)上发布了您的问题的答案。

另一方面，按照 Dave 的想法，您可以在 Google Play 上设置私人频道。如您所知，Google Play 提供简单的自动更新，并且通过私人频道，您将能够对*谁*可以访问您的应用程序给予特殊授权。

[在此处](https://support.google.com/a/answer/2494992?hl=en)阅读有关私人频道的更多信息。

# java - 如何使 Spring-MVC 输出 HTML

> ID：16173057
> 
> 赞同：0
> 
> 时间：2013-04-23T15:15:37.423
> 
> 标签：java, spring, spring-mvc

如何使 Spring-MVC 输出 HTML。现在我让 Spring-MVC 在如下列表中填充数据：

```
 <ul>
     <li><c:out value="${memberrequest.name}"/></li>
     <li><c:out value="${memberrequest.title}"/></li>
     <li>District: <c:out value="${memberrequest.district}"/></li>
     <li><c:out value="${memberrequest.school}"/></li>
     <li><c:out value="${memberrequest.requestor}"/></li>
 </ul> 
```

输出看起来像：

![在此处输入图像描述](https://i.stack.imgur.com/VhVLr.png)

但是如果数据是空白的，比如标题、学校等，我不想让一行空白，所以我想我可以在 spring 代码中创建这个列表，然后将 html 传递回 JSP 页面，但看起来 Spring 会不让你做

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:19:10.930

从你的控制器返回 HTML 违背了 MVC 的想法，因为你的控制器接管了视图的责任。

相反，请`<c:if>`在您的 JSP 中使用该标记。更多信息在这里：[http](http://docs.oracle.com/javaee/1.4/tutorial/doc/JSTL4.html#wp74001) ://docs.oracle.com/javaee/1.4/tutorial/doc/JSTL4.html#wp74001 （注意：这个解释的第一段似乎表明你应该使用一个scriptlet；它真的没有t，如果你仔细阅读，你会看到 JSTL 方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T15:42:15.883

如果你真的想这样做，你可以像这样使用`escapeXml="false"`属性`c:out`：

```
<c:out value="${myHtmlString}" escapeXml="false"/> 
```

但正如 parsifal 所说，如果可以的话，最好在视图中构建 HTML。

# asp.net - Where to put initializing code in an ASP.Net MVC app?

> ID：16173066
> 
> 赞同：6
> 
> 时间：2013-04-23T15:16:06.693
> 
> 标签：asp.net, .net

I have a ASP.NET MVC4 web app, and I want some code to be executed the first time an app starts. The code basically loads a bunch of data from the database and stores it in a cache, so that any future requests can look up the data from the cache.

Where is the correct place to put this code? Should I simply add my line of code to Global.asax, or is there a best practice for calling code once an app starts?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:22:14.427

有一个单独的类来进行数据初始化并从`Global.asax`. `Global.asax`基本上应该充当协调器。DI 容器初始化、缓存初始化、路由初始化等单独的初始化应该位于它们自己的类中，从而遵守单一职责原则。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:18:20.320

```
Global.asax.cs:Application_Start() 
```

你在同一个地方做注册路线之类的事情。

这正是我初始化缓存的地方。我还检查了每个 Application_BeginRequest() 上的缓存过期时间，以查看它是否需要更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:21:30.220

您可以将代码放在`Application_Start`Global.asax 中。

或者您可以[`Lazy`](http://msdn.microsoft.com/en-us/library/dd997286.aspx)在静态成员上使用该类型，并且它只会在第一次调用时初始化（并且只要应用程序运行，它就会一直保留在内存中）。这样做的好处是不会不必要地减慢应用程序的启动速度。

例如，这个例子是一个编译的正则表达式，但也可以通过加载数据来完成：

```
public static Lazy<Regex> LibraryTagsRegex = 
    new Lazy<Regex>(() => new Regex(@"^library/tagged/(?<Tags>.+)", RegexOptions.Compiled)); 
```

# android - Layout resizing wrong when keyboard is shown

> ID：16173067
> 
> 赞同：2
> 
> 时间：2013-04-23T15:16:09.497
> 
> 标签：android

When I click in my edit text and my keyboard shows up, everything seems to be ok as in the picture bellow:

![enter image description here](https://i.stack.imgur.com/0S2nG.jpg)

But when it has to shrink a little bit more my image is resized extending a invisible area, and my TextView still as big as in the begining, then my layout doesn't work anymore:

![enter image description here](https://i.stack.imgur.com/N67rw.jpg)

I've tried to create new images and dimensions for xhdpi resolution, but it didn't any effect

How can I fix it? How can I resize everything proportionaly. (I've tried to put a scrollview but i have a ListView inside my layout, as you can see in the code below)

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/login_background"
    android:descendantFocusability="beforeDescendants"
    android:clickable="true"
    android:focusableInTouchMode="true"
    tools:context=".LoginActivity"
    android:id="@+id/fundoLogin" >

  <RelativeLayout
      android:id="@+id/relativeLayout2"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:layout_centerHorizontal="true"
      android:layout_centerVertical="true" >

      <ImageView
          android:id="@+id/image_login_fields"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_below="@+id/image_logo"
          android:layout_centerHorizontal="true"
          android:contentDescription="@string/img_login_fields_desc"
          android:src="@drawable/login_fields">

      </ImageView>

      <ImageView
          android:id="@+id/image_logo"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_alignParentTop="true"
          android:layout_centerHorizontal="true"
          android:layout_marginBottom="@dimen/margin_logo_to_fields"
          android:contentDescription="@string/img_logo_desc"
          android:src="@drawable/logo" />

          <TextView
              android:id="@+id/labelLogin"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_alignTop="@id/image_login_fields"
              android:layout_alignLeft="@id/image_login_fields"
              android:layout_marginTop="@dimen/margin_top_label_login"
              android:layout_marginLeft="@dimen/margin_left_label_login"
              android:text="@string/login"
              android:textSize="@dimen/login_txt_size"
              />

          <EditText
              android:id="@+id/txtFieldLogin"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_marginLeft="@dimen/margin_left_txt_field_login"
              android:layout_alignTop="@id/image_login_fields"
              android:layout_toRightOf="@id/labelLogin"
              android:layout_alignRight="@id/image_login_fields"
              android:layout_marginRight="@dimen/margin_right_txt_field_login"
              android:layout_marginTop="@dimen/margin_top_txt_field_login"
              android:ems="10"
              android:textSize="@dimen/login_txt_size"
              android:hint="@string/txtFieldLoginHint"
              android:singleLine="true" >
          </EditText>

          <TextView
              android:id="@+id/labelSenha"
              android:layout_below="@id/labelLogin"
              android:layout_alignLeft="@id/image_login_fields"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_marginTop="@dimen/margin_top_label_senha"
              android:layout_marginLeft="@dimen/margin_left_label_senha"
              android:text="@string/senha"
              android:textSize="@dimen/senha_txt_size" />

          <EditText
              android:id="@+id/txtFieldSenha"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_below="@id/txtFieldLogin"
              android:layout_alignLeft="@id/txtFieldLogin"
              android:layout_alignRight="@id/txtFieldLogin"
              android:layout_marginTop="@dimen/margin_top_txt_field_senha"
              android:ems="10"
              android:hint="@string/txtFieldSenhaHint"
              android:singleLine="true"
              android:textSize="@dimen/senha_txt_size"></EditText>

          <ImageButton
              android:id="@+id/btnEntrar"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:layout_alignRight="@id/image_login_fields"
              android:layout_alignBottom="@id/image_login_fields"
              android:layout_marginRight="@dimen/margin_right_btn_entrar"
              android:layout_marginBottom="@dimen/margin_bottom_btn_entrar"
              android:background="@drawable/btn_entrar_clicked"
              android:contentDescription="@string/btn_entrar_desc"
              />

      <ListView
          android:id="@+id/listEmails"
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:layout_above="@id/image_login_fields"
          android:layout_alignRight="@id/image_login_fields"
          android:layout_alignLeft="@id/txtFieldLogin"
          android:background="@drawable/rounded_corner"
          android:visibility="invisible" >
      </ListView>

  </RelativeLayout>

   <Button
       android:id="@+id/btnTeste"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:layout_alignParentBottom="true"
       android:layout_alignParentRight="true"
       android:textSize="@dimen/btn_teste_txt_size"
       android:layout_marginRight="@dimen/margin_right_btn_teste"
       android:layout_marginBottom="@dimen/margin_bottom_btn_teste"
       android:text="@string/btnCredenciaisDeTesteTxt"
       android:textColor="@color/white" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T17:41:46.293

您正在寻找的`android:windowSoftInputMode`是`AndroidManifest`. 这控制您的屏幕如何响应显示的键盘。现在它似乎正在使用`adjustResize`，并且您希望在清单`adjustPan`中的`Activity`声明中添加：

```
<activity android:windowSoftInputMode="adjustPan" 
```

您可以在此处阅读有关您的选择的更多信息：

[http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)

如果你想调整屏幕大小，你需要重新考虑你的布局。

首先，将登录背景作为单独的 ImageView 是一种糟糕的形式。由于您希望它调整大小，您应该以最小的必要大小为图像创建一个 9 补丁。这使得容器定义图像的大小，而不是图像本身。

其次，将你的`TextViews`and单独包装起来`EditText`，`RelativeLayout`然后应用你创建的 9 补丁作为`RelativeLayout`. 现在，您将始终拥有一个登录框，它可以按照您设计的方式包装您的视图，即使在调整大小时也是如此。

# java - Framework for readable and maintainable acceptance tests

> ID：16173070
> 
> 赞同：0
> 
> 时间：2013-04-23T15:16:12.557
> 
> 标签：java, testing, cucumber, bdd, acceptance-testing

Im looking for an acceptance testing framework with readable syntax (like [Cucumber](http://cukes.info/)'s plain text specs) but as an internal domain specific language (DSL). First I was thinking about [ScalaTest](http://www.scalatest.org/getting_started_with_feature_spec) but non technical customers run screaming away if they see the syntax!

So is there an acceptance testing framework optimized for readability providing an **internal** (ideally typesafe) DSL and running on the JVM?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T13:16:32.417

好吧，对于在 JVM 上运行的类似 Cucumber 的框架，您可以使用[cucumber-jvm](https://github.com/cucumber/cucumber-jvm)。在 github 页面中，有各种 java 和基于 java 的语言的示例，例如 Groovy 和 Scala。

我不太明白您所说的“内部” dsl 是什么意思。Cucumber-jvm 功能是 .feature 文件中的简单 Given-When-Then 用户故事，为什么它们不符合您的定义？

我一直将它与 Java 和 Junit 一起使用，它几乎和 Cucumber 的 ruby​​ 实现一样简单。

# c++ - c++ - Call public function with private arguments

> ID：16173071
> 
> 赞同：0
> 
> 时间：2013-04-23T15:16:13.150
> 
> 标签：c++, class, function, member

In my class: I want to create a public function which has as argument a private member of the class. And be able to call this function from outside of the class.

Something like that:

```
class MailToTerm
{
    public:
        MailToTerm();
        int getPrivMax(intWithMax priv) {return priv.getMax();} //my public function
        void initPrivMax(intWithMax priv) {return priv.initMax();}
        void getMutexObjPriv(intWithMax priv) {return priv.GetMutexObj();}
        void relMutexObjPriv(intWithMax priv) {return priv.RelMutexObj();}

    private:
        intWithMax cnter_multi_busy ;
        intWithMax cnter_mono_busy ;
        intWithMax cnter_light_busy ;
}

int main(){
    MailToTerm* pt_MailToTerm = new MailToTerm();
    int multi = pt_MailToTerm->getPrivMax(MailToTerm::cnter_multi_busy);
    int mono=   pt_MailToTerm->getPrivMax(MailToTerm::cnter_mono_busy);
} 
```

It doesn't work because cnter_multi_busy is seen as "private", so I'm not allowed to access it. How should I do?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:22:48.723

我喜欢列举选项，像这样。它们可以很容易地用在 if/else 或 switch 语句中，如果以后添加更多选项，它们也很容易扩展。它还很好地隐藏了实现和私有成员。此外，如果需要，枚举可以用作带有`intWithMax`:s 的数组中的索引。

```
class MailToTerm
{
    public:
        enum Options { // or some better name, of course
            CENTER_MULTI_BUSY = 0,
            CENTER_MONO_BUSY
        };
        MailToTerm();
        int getPrivMax(Options o) {
            if (o == CENTER_MULTI_BUSY) return cnter_multi_busy.getMax();
            else if (o == CENTER_MONO_BUSY) return cnter_mono_busy.getMax();
            else // do some error handling
        }

    private:
        intWithMax cnter_multi_busy ;
        intWithMax cnter_mono_busy ;
}

int main() {
    MailToTerm* pt_MailToTerm = new MailToTerm();
    int multi = pt_MailToTerm->getPrivMax(MailToTerm::CENTER_MULTI_BUSY);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:26:37.583

因此，您希望有一个对成员变量执行某些操作的函数，但希望在参数中指定哪个函数。我的解决方案是使用数组：

```
class MailToTerm
{
    public:
        enum MemberIndex {
            CNTER_MULTI_BUSY = 0,
            CNTER_MONO_BUSY = 1
        };

        MailToTerm();
        int getPrivMax(MemberIndex index) {return cnter_busy[(int) index].getMax();}

    private:
        intWithMax cnter_busy[2];
}; 
```

然后像这样调用它：

```
pt_MailToTerm->getPrivMax(MailToTerm::CNTER_MULTI_BUSY); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:18:07.080

您可以将成员公开，也可以创建一个调用原始函数并传递私有成员的公共包装函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:23:22.287

我可能会创建一个返回您真正想要的函数的函数，例如：

```
class MailToTerm
{
    public:
        MailToTerm();
        int getPrivMaxMulti() { return cnter_multi_busy.getMax(); }
        // repeat for mono. 
    private:
        intWithMax cnter_multi_busy ;
        intWithMax cnter_mono_busy ;
} 
```

或者，您当然可以公开这些值，但这可能不是一个好主意。

另一种解决方案是为`cnter_ ...`私有成员提供访问功能，如下所示：

```
class MailToTerm
{
    public:
        MailToTerm();

        int getPrivMax(const intWithMax priv) {return priv.getMax();} //my public function

        const intWithMax getMulti() const { return cnter_multi_busy; }
        // ... as above for mono ... 
    private:
        intWithMax cnter_multi_busy ;
        intWithMax cnter_mono_busy ;
} 
```

接着

```
 int multi = pt_MailToTerm->getPrivMax(pt_MailToTerm->getMulti()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:19:17.317

```
class MailToTerm
{
    public:
        MailToTerm();
        int getPrivMax() {return cnter_multi_busy.getMax();} //my public function

    private:
        intWithMax cnter_multi_busy ;
        intWithMax cnter_mono_busy ;
}

int main(){
    MailToTerm* pt_MailToTerm = new MailToTerm();
    int multi = pt_MailToTerm->getPrivMax();
} 
```

# android - How to remove black cover on top of sliding menu?

> ID：16173075
> 
> 赞同：3
> 
> 时间：2013-04-23T15:16:21.263
> 
> 标签：android, slidingmenu

In my application i have a sliding menu which has been developed by [jfeinstein10](https://github.com/jfeinstein10/SlidingMenu). It's working fine in my application ;)

I have a Fragment which is host of MapView. This fragment like my other fragments extended from Fragment class. Just in this Fragment, there is black cover/layer on top of menu contents when I open sliding menu. There is no black cover when I open menu in other fragments. Also, the thing that I found is height of box is exactly as same height as fragment.

Have you seen this problem before? any comments or suggestion would be appreciated.

![enter image description here](https://i.stack.imgur.com/wqKa1.png)

=> **Update**

Based on what Selei suggested I set background to transparent. However, regardless of what color I'm assigning (transparent or other colors) it's still visible and black :( This is my code:

```
<?xml version="1.0" encoding="utf-8"?>

<com.google.android.gms.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:map="http://schemas.android.com/apk/res-auto"
    android:id="@+id/mapView"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:clickable="true"
    map:uiCompass="true"
    android:background="#00000000"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T08:59:23.570

我在这里尝试了所有方法，但没有一个效果很好。使用 GoogleOptions 将 zOrder 移动到顶部意味着基本的缩放控件隐藏在地图后面。
此链接的最后一个建议：[https](https://github.com/jfeinstein10/SlidingMenu/issues/168#issuecomment-17065660) ://github.com/jfeinstein10/SlidingMenu/issues/168#issuecomment-17065660 （ckakei）为我修复了它。
诀窍是在布局中添加一个空的透明视图：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<FrameLayout
    android:id="@+id/view_map"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
</FrameLayout>
<View
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/transparent" /> 
```

我在片段中夸大了这个视图。我用 SuppportMapFragment 替换了 view_map FrameLayout。

这是该课程的重要部分：

```
private GoogleMap googleMap;
private SupportMapFragment mapFragment;
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    return inflater.inflate(R.layout.view_map_layout, container,
            false);

}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    FragmentManager fm = getChildFragmentManager();
    if (mapFragment == null) {
        mapFragment = SupportMapFragment.newInstance();
    }
    if (savedInstanceState == null) {
        mapFragment.setRetainInstance(true);
    } else {
        googleMap = mapFragment.getMap();
    }
    fm.beginTransaction().replace(R.id.view_map, mapFragment).commit();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T03:50:54.370

解决方案是添加`map:zOrderOnTop="true"`到 XML。

有关更多信息，请参阅[此链接](https://code.google.com/p/gmaps-api-issues/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Type%20Status%20Introduced%20Fixed%20Summary%20Stars%20ApiType%20Internal&groupby=&sort=&id=4812)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:21:57.113

设置 MapView 背景透明 - android:background="#00000000"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-09T05:49:02.867

我刚刚制作了地图复制视图，当滑动菜单打开或关闭时复制地图

```
@SuppressWarnings("deprecation")
@SuppressLint("NewApi")
private void showMapCopy(boolean show) {

    View map = findViewById(R.id.map);
    View mapCopy = findViewById(R.id.map_copy);

    if (show) {
        map.setDrawingCacheEnabled(true);
        Bitmap bitmap = map.getDrawingCache();
        if (Build.VERSION.SDK_INT < Build.VERSION_CODES.JELLY_BEAN)
            mapCopy.setBackgroundDrawable(new BitmapDrawable(getResources(), bitmap));
        else
            mapCopy.setBackground(new BitmapDrawable(getResources(), bitmap));
        mapCopy.setVisibility(View.VISIBLE);
    } else {
        map.setDrawingCacheEnabled(false);
        mapCopy.setVisibility(View.GONE);
    }
} 
```

滑动菜单打开监听器

```
 mMenu.setOnClosedListener(new OnClosedListener() {
        @Override
        public void onClosed() {
            showMapCopy(false);
        }
    }); 
```

OnOptionItemSelected

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {

    switch (item.getItemId()) {
        case R.id.abs__home:
        case android.R.id.home:
                showMapCopy(true);
                mMenu.toggle();
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

# java - Unrecognized VM option 'UseTLAB' on amazon machine

> ID：16173079
> 
> 赞同：1
> 
> 时间：2013-04-23T15:16:26.093
> 
> 标签：java, amazon

I'm having no problems of running my java app in Eclipse using -XX:UseTLAB VM argument, but when I go on amazon virtual machine it says:

```
[ec2-user@ip-20-256-13-520 ~]$ java -cp '.:/home/ec2-user/libs/mylib.jar' -Xmx2048m -XX:UseTLAB amazon
Unrecognized VM option 'UseTLAB'
Could not create the Java virtual machine. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:31:43.553

尝试使用 +/- 前缀

```
-XX:+UseTLAB 
```

# ms-word - 是否有控制输出页面方向的选项（使用 knitr->pander->pandoc->docx）

> ID：16173081
> 
> 赞同：15
> 
> 时间：2013-04-23T15:16:27.437
> 
> 标签：ms-word, markdown, knitr, pandoc, pander

我正在玩[Tal 的](http://www.r-statistics.com/2013/03/write-ms-word-document-using-r-with-as-little-overhead-as-possible/)介绍，以在现实世界的情况下以尽可能少的开销生成单词表。（请参阅那里的可重现示例 - 谢谢，Tal！）在实际应用中，表格太宽以在面向纵向的页面上打印它们，但您可能不想拆分它们。

抱歉，如果我在 pandoc 或 pander 文档中忽略了这一点，但是从 R 写入 Word .docx 文件时如何控制页面方向（纵向/横向）？

我也许应该补充一点，我开始使用 knitr+markdown，但我还不熟悉 LaTex 语法。但我在完成我的工作的同时尽可能多地收拾东西。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-26T12:17:12.380

我很确定 docx 编写器没有实现分节符，据我所知，它`--reference-docx`允许自定义样式而不是页面布局（但我在这里也可能错了），这是来自 pandocs 指南`--reference-docx`：

> **--reference-docx=*文件***
> 
> 使用指定的文件作为生成 docx 文件的样式参考。为获得最佳结果，参考 docx 应该是使用 pandoc 生成的 docx 文件的修改版本。参考 docx 的内容被忽略，但其样式表在新 docx 中使用。如果在命令行上未指定参考 docx，pandoc 将在用户数据目录中查找文件 reference.docx（请参阅 --data-dir）。如果这也没有找到，将使用合理的默认值。pandoc 使用以下样式：[段落] 正常、标题、作者、日期、标题 1、标题 2、标题 3、标题 4、标题 5、块引用、定义术语、定义、正文文本、表格标题、图像标题; [字符] 默认段落字体、正文字符、逐字字符、脚注参考、链接。

哪些是保存在文档`/word/styles.xml`组件中的样式`docx`。另一方面，页面布局保存在标签中的`/word/document.xml`组件中`<w:sectPr>`，但据我所知，pandoc 的 docx writer 忽略了这部分。

**docx 编写器默认构建一个连续的文档，其中包含标题、段落、简单表格等元素……很像 html 输出。**

* * *

### 选项#1（不能解决页面方向问题）：

您可以通过样式定义的唯一页面布局选项是`pageBreakBefore`在特定样式之前添加分页符

### 选项 #2（看起来很优雅，但尚未经过测试）：

最近添加了允许自定义脚本的自**定义**`lua`编写器，您应该能够在其中定义某些 Pandoc 块将如何写入输出文件......这意味着您可以为特定块插入定义分节符和页面布局`sectPr`标记到文档中。我还没有尝试过，但值得研究。[在 pandoc github 上，您可以查看用于自定义 html 输出的示例 lua 脚本文件](https://github.com/jgm/pandoc/blob/master/data/sample.lua)。

但是，这意味着您必须安装 lua，学习该语言，如果您认为值得花时间投资，则取决于您。

### Optin #3（在 Word 中单击几下就可以了）：

因为您可能会花费相当多的时间来设置如何插入部分以及正确的大小、边距以及如何使表格适合这样的布局......我建议您使用 pandoc 来编写您的文档。 docx，您在 Word 中打开并手动进行布局：

> *   **在横向页面上选择**您想要的表格
> *   去**Layout > Margins**
>     **>**选择**Apply to: Selected text**
>     **>**选择**Page Setup >**选择**Landscape**

现在，您的桌子周围应该有一个横向的新部分。

无论如何，您可能还想做的是稍微设置表格和表格标题的样式（字体大小，...），以达到最佳效果（所有文本样式都可以在方便的地方使用 pandoc 应用`--reference-docx`）。

### 选项 #4（在您可以只使用 pdf 而不是 docx 的情况下）：

据我所知，pandoc 在`md -> docx`（对齐，样式，...）中的表格做得很好，`tex -> docx`有时会遇到一些麻烦。但是，如果您的选项允许**pdf**输出，乳胶将是您最好的朋友。例如，您的问题就像使用一样容易解决

```
\usepackage{pdflscape} 
```

并在你的桌子周围添加这个

```
\begin{landscape}
...
\end{landscape} 
```

这是目前我能想到的选项。

我总是建议使用 pdf 格式的报告，因为您可以使用乳胶对其进行样式设置，并且布局将保持您想要的方式。

然而，我也知道，由于各种原因，word 文档仍然是审查许多领域手稿的主要方式......所以我很可能会选择我建议的选项 3，主要是因为它是一个懒惰和快速的解决方案，因为我通常没有很多文档，其中包含大量放置和样式笨拙的巨型桌子。

祝你好运 ;-）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-12-30T11:04:45.713

根据 Taleb 的回答[和](https://stackoverflow.com/a/52131435/3888000)一些`officer`包[函数](https://github.com/davidgohel/officer/blob/master/R/docx_section.R)，我创建了一个可以像这样使用的小要点：

```
---
title: "Example"
author: "Dan Chaltiel"
output: 
  word_document:
    pandoc_args:
     '--lua-filter=page-break.lua'
---

I'm in portrait

\endLandscape

I'm in landscape

\endPortrait

I'm in portrait again 
```

将`page-breaks.lua`文件托管在这里：[https ://gist.github.com/DanChaltiel/e7505e62341093cfdc489265963b6c8f](https://gist.github.com/DanChaltiel/e7505e62341093cfdc489265963b6c8f)

这远非完美（例如，如果没有最后一个肖像部分，它将无法工作），但有时它非常有用。

# php - Jquery 没有从 php 文件中获取我的值

> ID：16173082
> 
> 赞同：0
> 
> 时间：2013-04-23T15:16:27.417
> 
> 标签：php, jquery, html, get

我需要你的帮助。在我的 php 代码中，我创建了一个日期倒计时，它可以正常工作，但是我在 jquery 中的代码有问题。我正在尝试获取 $json_result 值。这是我的 php 代码：

```
<?php
function addZero($addZero){
        return ($addZero < 10) ? '0'.$addZero : $addZero;
    }

header('Content-type: application/json');

$year_value = date('Y');
$end_month = $_GET['month'];
$end_day = $_GET['day'];
$end_hours = $_GET['hour'];

$date = strtotime("$year_value-$end_month-$end_day, $end_hours:00:00");
$remaining = $date - time();
$minutes = floor($remaining/60);
$hours = floor($remaining/3600);
$daysLeft = floor($remaining/86400);

if($daysLeft > 0){
        $remaining_hours = $hours - ($daysLeft * 24);
    }else{
        $remaining_hours = $hours;
    }

$remaining_minutes = floor(($remaining - ($hours * 3600))/60);
$remaining_seconds = floor($remaining - ($minutes * 60));

$result = 'Days left:&nbsp;'.$daysLeft.'&nbsp;'.addZero($remaining_hours).':'.addZero($remaining_minutes).':'.addZero($remaining_seconds);
$json_result = json_encode($result);
echo $json_result;
?> 
```

这是我的 html jquery php 代码：

```
<head>
<script type="application/javascript">
jQuery(document).ready(function(){
    $("#submit").click(countDown);
});

function countDown(e){
    setTimeout(function(){
        $.get('countdown.php',function(data){
        $("#countDown").html(data);
        e.preventDefault(); 
        });
        countDown();
    },1000);    
}
</script>
</head>
<body>
<?php
$monthsArray = array(0 => '0', 1 => 'Jan.', 2 => 'Feb.', 3 => 'Mar.', 4 => 'Apr.', 5 => 'May', 6 => 'Jun.', 7 => 'Jul.', 
8 => 'Aug.', 9 => 'Sep.', 10 => 'Oct.', 11 => 'Nov.', 12 => 'Dec.');
$months = array_slice($monthsArray, date('m'), 12, true);
?>
<label>Month:</label>
<select name="month" id="month">
    <?php
        foreach ($months as $values => $keys) {
            printf('<option value="%u">%s</option>', $values, $keys);        
        }
    ?>
</select>
<?php
$daysArray = array(0 => '0', 1 => '1', 2 => '2', 3 => '3', 4 => '4', 5 => '5', 6 => '6', 7 => '7', 8 => '8', 9 => '9', 10 => '10', 
11 => '11', 12 => '12', 13 => '13', 14 => '14', 15 => '15', 16 => '16', 17 => '17', 18 => '18', 19 => '19', 20 => '20', 21 => '21', 
22 => '22', 23 => '23', 24 => '24', 25 => '25', 26 => '26', 27 => '27', 28 => '28', 29 => '29', 30 => '30', 31 => '31');

    if(date('L') == 0 && (date('m') == 02 || date('m') == 2)){
        $days = array_slice($daysArray, date('d'), -3, true); // if it's not a leap year february has 28 days
    }elseif(date('L') == 1 && (date('m') == 02 || date('m') == 2)){
        $days = array_slice($daysArray, date('d'), -2, true); // if it's a leap year february has 29 days
    }elseif(date('m') % 2 == 0){
        $days = array_slice($daysArray, date('d'), -1, true); // even month
    }else{
        $days = array_slice($daysArray, date('d'), 31, true); // odd month
    }
?>
<label>Day:</label>
<select name="day" id="day">
    <?php
        foreach ($days as $values => $keys) {
            printf('<option value="%u">%s</option>', $values, $keys);        
        }
    ?>
</select>
<input type="submit" id="submit"  value="Submit">
<div id="countDown">
</div>
</body> 
```

有人可以告诉我我做错了什么吗？我正在使用 jquery 1.9.1 版。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:22:37.510

删除`header('Content-type: application/json');`，因为您已经在 json_encoding 您的返回字符串。

**更新**

在您的函数中替换`$.get`为：`$.post``countDown`

```
$.post('countdown.php',function(data){ 
```

发生的事情是，由于您使用的是 get 方法，因此表单值没有被传递给 PHP 脚本，这导致垃圾值被返回

在 countdown.php 更改`$_GET`为`$_POST`：

```
$end_month = $_POST['month'];
$end_day = $_POST['day'];
$end_hours = $_POST['hour']; 
```

您还需要将下拉列表包装在`form`with 中`method='POST'`。此外，您需要将下拉值`$.post`作为 json 传递给函数。请参阅[jquery post](http://api.jquery.com/jQuery.post/)函数以了解它是如何完成的。

当您发布时，必须像这样传递值：

```
$.post("countdown.php", { 
   month: document.forms[0].month.value, 
   day: document.forms[0].day.value } ) 
```

此外，在您的表单中没有小时下拉菜单，但您试图在 countdown.php 中获取它（这将给出垃圾值）。

那里有很多事情要纠正，但我认为你应该能够到达那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:01:27.653

在您的 php 代码中删除此行：

```
header('Content-type: application/json'); 
```

因此，您不必使用`json encode`来输出结果。

```
echo $json_result; 
```

# sorting - 在 OpenGL(LWJGL) 的 3D 世界中绘制透明精灵

> ID：16173085
> 
> 赞同：2
> 
> 时间：2013-04-23T15:16:31.887
> 
> 标签：sorting, opengl, 3d, transparency, sprite

我需要在 3D 世界中绘制透明的 2D 精灵。我尝试渲染一个 QUAD，对其进行纹理化（使用 slick_util）并旋转它以面对相机，但是当它们中有很多时，透明度并不能真正起作用。如果在它们之前渲染，最靠近相机的精灵将阻挡它后面的精灵。

我认为这是因为 OpenGL 只绘制离查看器最近的对象而不检查 alpha 值。这可以通过将它们从最远到最近进行排序来解决，但我不知道该怎么做，我不必使用 math.sqrt 来获得距离吗？（听说很慢）

我想知道是否有一种简单的方法可以让 3D 中的透明度正常工作。（在 OpenGL 中启用某些东西，例如）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:32:07.750

禁用深度测试并将透明几何体重新渲染到前面。

或者切换到添加剂混合，希望看起来不错。

或者使用[深度剥离](https://developer.nvidia.com/system/files/akamai/gamedev/docs/order_independent_transparency.pdf)。

# sharepoint - sharepiont 2010 sandboxed ItemUpdating event receiver triggered only on first 3 items

> ID：16173090
> 
> 赞同：1
> 
> 时间：2013-04-23T15:16:40.703
> 
> 标签：sharepoint, sharepoint-2010, event-receiver

I have 2 Lists:

**List A**

*   Title
*   Category (lookup to Category List) (choices A, B C)
*   Price (number field)
*   Category Total (number field)
*   ...Some other fields

**List B**

*   Title
*   CategoryA Price (number field)
*   CategoryB Price (number Field)
*   CategoryC Price (number field)
*   Changes Pending (bool / checkbox, default "no")
*   ...Some other fields

List B has itemUpdating event receiver that goes to List A, and gets the price, does some calculations and saves that price in the CategoryX Price field before setting "pending changes" to false. This works fine when triggered from List B.

List A also has itemUupdating and itemUpdated event receivers. When I change Price, itemUpdating loops through List A and sums up the Prices for the same category and saves it in Category Total for all items with the same category. ItemUpdated goes to List B and sets "Changes Pending=yes" on items with the same category. Event firing is enabled on purpose so that list B itemUpdating fires and refreshes itself with new Price from List A.

**Problem:** When I change the Price in list A, only the first 3 items in list B get updated properly. (there is around 15 items to be updated). How can I ensure that list B event receivers completed for all items? (additionally, when I attach debugger to list B itemUpdating and change Price in List A, debugger never fires off and none of the items in list B get updated)

**Environment** SP 2010 Server on VM. VS2010 Sandboxed solutions (can't use farm). All event receivers have default sequence number. -ing events are synchronous and -ed events are asynchronous.

# r - R - 与大小不等的数据集进行移动窗口比较

> ID：16173094
> 
> 赞同：2
> 
> 时间：2013-04-23T15:16:48.887
> 
> 标签：r, math, comparison, dataframe, zoo

我需要将一大组值与一小组值进行比较，并找到两者之间的最小差异。也许这是“移动窗口”的比较？我查看了几个时间序列包，但找不到（或识别）比较不同大小的数据集的函数。下面的文本示例。任何帮助是极大的赞赏。

```
 ----------1st comparison-----------

    Time     S1     S2     Diff     Mean Diff
    1        1.3    1.2    0.1
    2        1.7    1.6    0.1      0.10
    3        1.2     
    4        1.6

    ----------2nd comparison------------

    1        1.3    
    2        1.7    1.2    0.5
    3        1.2    1.6   -0.4      0.05
    4        1.6

    ----------3rd comparison------------     

    1        1.3     
    2        1.7
    3        1.2    1.2    0.0
    4        1.6    1.6    0.0      0.00     <- minimum difference 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:32:48.590

像这样的东西怎么样：

```
require(zoo)
S1 <- c(1.3,1.7,1.2,1.6)
S2 <- c(1.2,1.6) 
```

我们可以使用 rollapply 来应用沿向量滚动的函数。宽度设置为较小比较向量的大小。然后，我们使用匿名函数将大向量 S1 中的值作为变量传递，`x`然后从该变量中减去小向量中的值并取平均值。然后我们可以使用`min`返回最小值：

```
> min( rollapply( S1 , width = 2 , function(x) mean(x-S2) ) )
[1] 0 
```

如果没有数据结构，很难使其更具普遍性

# java - Pass real data to the Storms Spout using Non-JVM language in Twitter-Storm

> ID：16173096
> 
> 赞同：4
> 
> 时间：2013-04-23T15:16:51.590
> 
> 标签：java, python, subprocess, apache-storm

I'm having trouble to understand how to pass real data to the Spout, For example:

I have this two files (they are working fine):

```
#! /usr/bin/env python

import os, random, sys, time

for i in xrange(50):
    print("%s\t%s"%(os.getpid(), i))
    sys.stdout.flush()
    time.sleep(random.randint(0,5)) 
```

And

```
#! /usr/bin/env python

from __future__ import print_function
from select import select
from subprocess import Popen,PIPE

p = Popen(['./rand_lines.py'], stdout=PIPE, bufsize=1, close_fds=True,  universal_newlines=True) 

timeout = 0.1 # seconds
while p:
    # remove finished processes from the list 
    if p.poll() is not None: # process ended
        print(p.stdout.read(), end='') # read the rest
        p.stdout.close()
        processes.remove(p)

    # wait until there is something to read
    rlist = select([p.stdout], [],[], timeout)[0]

    # read a line from each process that has output ready
    for f in rlist:
        print(f.readline(), end='') #NOTE: it can block 
```

Now imagine that I want to pass those random lines to the spout for the future processing, I was trying this: from uuid import uuid4 from select import select from subprocess import Popen,PIPE import storm

```
class TwitterSpout(storm.Spout):

    def initialize(self, conf, context):
        self.pid = os.getpid()
        try:
            self.p= Popen(['./rand_lines.py'], stdout=PIPE, bufsize=1, close_fds=True,  universal_newlines=True)
        except OSError, e:
            self.log('%s'%e)
            sys.exit(1) 
```

and than in nextTuple():

```
def nextTuple(self):
    timeout = 0.1 # seconds
    while self.p:
        # remove finished processes from the list 
        if self.p.poll() is not None: # process ended
        self.log ("%s"%self.p.stdout.read()) # read the rest
        self.p.stdout.close()
        processes.remove(self.p)

        # wait until there is something to read
        rlist = select([self.p.stdout], [],[], timeout)[0]

        # read a line from each process that has output ready
        for f in rlist:
        self.log ("%s%s"%f.readline()) #NOTE: it can block
        msgId = random.randint(0,500)
        self.log('MSG IN SPOUT %s\n'%msgId)
        storm.emit([f.readline()], id=msgId) 
```

But this structure doesn't work, I'm always getting error `"Pipi seems to be broken..."` or if I try different variations of this code I am blocking the process, and Storm never riches the NextTuple. Please help me to solve my problem, or if someone can give me some example how to do similar thing, or just some advice. Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-25T06:07:25.337

可能有多个问题。

循环中没有中断`while`——无限循环。

你打`f.readline()`了两次电话。您可能打算在每个 之后只调用一次`select`。

为避免阻塞，请使用`data = os.read(f.fileno(), 1024)`after `select`。

我不知道`nextTuple()`在子进程退出之前阻塞是否可以接受。

如果您所做的只是从子进程中读取行，那么您不需要`select`：

```
def iter_lines(*args, DEVNULL=open(os.devnull, 'r+')):
    p = Popen(args, stdin=DEVNULL, stdout=PIPE, stderr=DEVNULL,
              bufsize=1, close_fds=True)
    for line in iter(p.stdout.readline, b''): # expect b'\n' newline
        yield line
    p.stdout.close()
    raise StopIteration(p.wait()) 
```

例子：

```
# ...
self.lines = iter_lines(sys.executable, '-u', 'rand_lines.py')

#...
def nextTuple(self):
    try:
        line = next(self.lines).decode('ascii', 'ignore')
    except StopIteration as e:
        self.exit_status = e.args[0]
    else:
        storm.emit([line.strip()]) 
```

# mediaelement.js - mediaelement.js does not start before download complete

> ID：16173099
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:17:02.557
> 
> 标签：mediaelement.js

MediaElement.js works fine, except for one little thing. The flash version does not start playing until the video has been completely downloaded. This is shown by its own progressbar that always "buffers" to 100% before starting to play. Before then, repeatedly hitting the play/pause button does nothing.

The HTML5 version starts playing right away, indicating it is not a server setting.

How to solve this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T10:28:04.913

可能，它在您的视频文件编码中......试试这个工具：QTIndexSwapper2

# javascript - Jquery .click() doesn't work in chrome

> ID：16173100
> 
> 赞同：0
> 
> 时间：2013-04-23T15:17:07.917
> 
> 标签：javascript, jquery, html

I have this strange problem, I never had before and it only occurs in Google Chrome browser. I have made a function to create a writebutton (that writes a value to my PLC true ajax). This is how it looks:

```
 function makeWriteButton(id, address, value, startRefresher){

            $("#" + id).click( function() {
                writeData(address, value, startRefresher);
            });
    } 
```

So you pass the id of your input button to that function and the function adds a click event handler, this function works perfect in IE, Firefox, Safari, Opera, but not in Chrome.

Does anyone have any suggestions or reasons why this doesn't work? and by the way this function used to work before on chrome but I don't know what I did so it's doesn't work anymore in chrome, really weird.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:22:00.180

我不认为您的问题出在那段代码中，这在 Chromium 上对我有用

```
<button id="but1">Button1</button>
<button id="but2">Button2</button>
<button id="but3">Button3</button>
<button id="but4">Button4</button>
<button id="but5">Button5</button>

function makeWriteButton(id, address, value, startRefresher) {
    $("#" + id).click(function () {
        alert(address + " " + value + " " + startRefresher);
    });
}

makeWriteButton("but3", 5, 6, 7); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/vKycg/)

# android - Cloning Android's tegra kernel, it's empty?

> ID：16173102
> 
> 赞同：0
> 
> 时间：2013-04-23T15:17:08.057
> 
> 标签：android, git, linux-kernel

I followed the steps on [http://source.android.com/source/building-kernels.html](http://source.android.com/source/building-kernels.html) in order to look at the kernel sources.

```
$ git clone https://android.googlesource.com/kernel/tegra.git
Cloning into 'tegra'...
remote: Total 2219519 (delta 1857594), reused 2219519 (delta 1857594)
Receiving objects: 100% (2219519/2219519), 436.09 MiB | 3.08 MiB/s, done.
Resolving deltas: 100% (1857594/1857594), done. 
```

Now, this is very strange... the project is **empty**

`git log` shows the following:

```
$ git log
commit a89a700fada233480530e4741cca876cfdd4eb9c
Author: Jean-Baptiste Queru <jbq@google.com>
Date:   Tue Nov 15 14:46:15 2011 -0800

    empty commit 
```

what's going on, where are the sources ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:41:50.717

好的，我正在回答我自己的问题。显然，主分支是空的，**内容在其他分支上可用。**

```
git branch -a 
```

显示很少的分支。我签出了其中一个，我得到了代码。

# mysql - Operand should contain 1 column(s)??? IT DOES but still error. Is this a bug?

> ID：16173103
> 
> 赞同：0
> 
> 时间：2013-04-23T15:17:14.297
> 
> 标签：mysql, sql, contain, operand, mysql-error-1241

I'm having a verry strange problem. I am certain I have done nothing wrong in this line of code:

```
INSERT INTO 
 oc_address     
  (`cust_id`, `firstname`, `lastname`, `address_1`, `city`, `postcode`, `country_id`)
SELECT          
  (`cust_id`, `first_name`, `last_name`, `address`, `city`, `postalcode`, `country`)
FROM    old_customer; 
```

Still I get the message "#1241 - Operand should contain 1 column(s)"

Does anybony see something I don't see? I was thinking it may be caused by the _1 at address_1\. But why would that be... I hope there is another explanation

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:18:55.580

删除`'`列名的符号`()`和`SELECT`.

```
 INSERT INTO 
  oc_address     
  (cust_id, firstname, lastname, address_1, city, postcode,country_id)
  SELECT          
  cust_id, first_name, last_name, address, city, postalcode, country
  FROM    old_customer; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:19:06.847

删除ststement`( )`上的列周围，`SELECT`

```
INSERT  INTO oc_address (cust_id, firstname, lastname, address_1, city, postcode, country_id)
SELECT cust_id, first_name, last_name, address, city, postalcode, country
FROM    old_customer; 
```

*   [SQLFiddle Demo（*包括两个语句*）](http://www.sqlfiddle.com/#!2/eef87/1)

# ruby-on-rails - oauth-twitter is returning undefined method 'gsub' for nil:NilClass

> ID：16173106
> 
> 赞同：2
> 
> 时间：2013-04-23T15:17:22.997
> 
> 标签：ruby-on-rails, omniauth

I have a production app on heroku that relies on devise/oauth for login though either Facebook or Twitter. Login was working fine last night, but as of this morning, I can't login through twitter (facebook is working fine.)

I get `'gsub' for nil:NilClass` both in development and in production on Heroku.

I did make a commit yesterday, but `git reset --hard HEAD@{"number before yesterday"}` does not fix the problem.

I'm not sure where to start with debugging this problem. Where should I be looking??

Here are my stack tace and bundled gems

**stack trace**

```
Started GET "/users/auth/twitter" for 127.0.0.1 at 2013-04-23 11:06:13 -0400

NoMethodError (undefined method `gsub' for nil:NilClass):
/Users/umezo/.rvm/rubies/ruby-1.9.3-p327/lib/ruby/1.9.1/cgi/util.rb:7:in `escape'
oauth (0.4.7) lib/oauth/tokens/request_token.rb:28:in `block in build_authorize_url'
oauth (0.4.7) lib/oauth/tokens/request_token.rb:28:in `each'
oauth (0.4.7) lib/oauth/tokens/request_token.rb:28:in `map'
oauth (0.4.7) lib/oauth/tokens/request_token.rb:28:in `build_authorize_url'
oauth (0.4.7) lib/oauth/tokens/request_token.rb:9:in `authorize_url'
omniauth-oauth (1.0.1) lib/omniauth/strategies/oauth.rb:36:in `request_phase'
omniauth-twitter (0.0.14) lib/omniauth/strategies/twitter.rb:63:in `request_phase'
omniauth (1.1.1) lib/omniauth/strategy.rb:207:in `request_call'
omniauth (1.1.1) lib/omniauth/strategy.rb:174:in `call!'
omniauth (1.1.1) lib/omniauth/strategy.rb:157:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.3) lib/rack/etag.rb:23:in `call'
rack (1.4.3) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.3) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.3) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__2832114944232593679__call__887588005576904267__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.3) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.3) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.3) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.3) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
thin (1.5.0) lib/thin/connection.rb:81:in `block in pre_process'
thin (1.5.0) lib/thin/connection.rb:79:in `catch'
thin (1.5.0) lib/thin/connection.rb:79:in `pre_process'
thin (1.5.0) lib/thin/connection.rb:54:in `process'
thin (1.5.0) lib/thin/connection.rb:39:in `receive_data'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run_machine'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run'
thin (1.5.0) lib/thin/backends/base.rb:63:in `start'
thin (1.5.0) lib/thin/server.rb:159:in `start'
rack (1.4.3) lib/rack/handler/thin.rb:13:in `run'
rack (1.4.3) lib/rack/server.rb:268:in `start'
railties (3.2.11) lib/rails/commands/server.rb:70:in `start'
railties (3.2.11) lib/rails/commands.rb:55:in `block in <top (required)>'
railties (3.2.11) lib/rails/commands.rb:50:in `tap'
railties (3.2.11) lib/rails/commands.rb:50:in `<top (required)>'
script/rails:6:in `require'
script/rails:6:in `<main>'

Rendered /Users/umezo/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.9ms)
Rendered /Users/umezo/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (1.3ms)
Rendered /Users/umezo/.rvm/gems/ruby-1.9.3-p327/gems/actionpack-3.2.11/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (18.4ms) 
```

**gems**

```
Using rake (10.0.4) 
Using i18n (0.6.1) 
Using multi_json (1.5.0) 
Using activesupport (3.2.11) 
Using builder (3.0.4) 
Using activemodel (3.2.11) 
Using erubis (2.7.0) 
Using journey (1.0.4) 
Using rack (1.4.3) 
Using rack-cache (1.2) 
Using rack-test (0.6.2) 
Using hike (1.2.1) 
Using tilt (1.3.3) 
Using sprockets (2.2.2) 
Using actionpack (3.2.11) 
Using mime-types (1.19) 
Using polyglot (0.3.3) 
Using treetop (1.4.12) 
Using mail (2.4.4) 
Using actionmailer (3.2.11) 
Using arel (3.0.2) 
Using tzinfo (0.3.35) 
Using activerecord (3.2.11) 
Using activerecord-reputation-system (2.0.0) 
Using activeresource (3.2.11) 
Using addressable (2.3.2) 
Using ancestry (1.3.0) 
Using annotate (2.5.0) 
Using multi_xml (0.5.1) 
Using httparty (0.9.0) 
Using json (1.7.6) 
Using nokogiri (1.5.6) 
Using uuidtools (2.1.3) 
Using aws-sdk (1.3.9) 
Using bcrypt-ruby (3.0.1) 
Using sass (3.2.5) 
Using bootstrap-sass (2.2.2.0) 
Using will_paginate (3.0.3) 
Using bootstrap-will_paginate (0.0.9) 
Using ffi (1.3.0) 
Using childprocess (0.3.6) 
Using websocket (1.0.6) 
Using libwebsocket (0.1.7.1) 
Using rubyzip (0.9.9) 
Using selenium-webdriver (2.27.2) 
Using xpath (0.1.4) 
Using capybara (1.1.2) 
Using chunky_png (1.2.7) 
Using orm_adapter (0.4.0) 
Using ckeditor (3.7.3) 
Using cocaine (0.3.2) 
Using coderay (1.0.8) 
Using coffee-script-source (1.4.0) 
Using execjs (1.4.0) 
Using coffee-script (2.2.0) 
Using rack-ssl (1.3.2) 
Using rdoc (3.12) 
Using thor (0.16.0) 
Using railties (3.2.11) 
Using coffee-rails (3.2.2) 
Using fssm (0.2.9) 
Using compass (0.12.2) 
Using compass-rails (1.0.3) 
Using daemons (1.1.9) 
Using dalli (2.6.2) 
Using warden (1.2.1) 
Using devise (2.2.0) 
Using diff-lcs (1.1.3) 
Using eventmachine (1.0.0) 
Using factory_girl (4.1.0) 
Using factory_girl_rails (4.1.0) 
Using faker (1.1.2) 
Using multipart-post (1.1.5) 
Using faraday (0.8.4) 
Using friendly_id (4.0.9) 
Using growl (1.0.3) 
Using listen (0.7.1) 
Using lumberjack (1.0.2) 
Using method_source (0.8.1) 
Using slop (3.3.3) 
Using pry (0.9.10) 
Using guard (1.6.1) 
Using guard-rspec (1.2.1) 
Using spork (0.9.2) 
Using sys-proctable (0.9.2) 
Using guard-spork (1.2.0) 
Using hashie (1.2.0) 
Using httpauth (0.2.0) 
Using jquery-rails (2.1.4) 
Using jquery-ui-rails (4.0.2) 
Using jwt (0.1.5) 
Using oauth (0.4.7) 
Using oauth2 (0.8.0) 
Using omniauth (1.1.1) 
Using omniauth-oauth2 (1.1.1) 
Using omniauth-facebook (1.4.1) 
Using omniauth-oauth (1.0.1) 
Using omniauth-twitter (0.0.14) 
Using paperclip (3.1.4) 
Using pg (0.14.1) 
Using bundler (1.2.1) 
Using rails (3.2.11) 
Using rb-fsevent (0.9.1) 
Using rspec-core (2.11.1) 
Using rspec-expectations (2.11.3) 
Using rspec-mocks (2.11.3) 
Using rspec (2.11.0) 
Using rspec-rails (2.11.0) 
Using sass-rails (3.2.5) 
Using simple_form (2.0.4) 
Using thin (1.5.0) 
Using uglifier (1.3.0) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T18:33:14.720

gem 的 GitHub 存储库页面上有一个未解决的问题。

见[https://github.com/arunagw/omniauth-twitter/issues/30](https://github.com/arunagw/omniauth-twitter/issues/30)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:46:54.910

没关系，它又开始工作了……；）

我假设这意味着这是 Twitter 的问题，而不是我的应用程序的问题。但是，我们将不胜感激有关如何诊断此类问题的任何意见。

# struts2-jquery - Grid error for only one record

> ID：16173108
> 
> 赞同：0
> 
> 时间：2013-04-23T15:17:29.863
> 
> 标签：struts2-jquery, struts2-jquery-grid

I have bug in struts2-grid-Jquery.Every time grid contains only one record ,grid disappear the record as in hyperlink but if there are more than one record it work fine. My code :

```
<sjg:grid id="gridtable" 
            dataType="json"
            href="%{remoteurl}" 
            gridModel="allCustomerRequests"
            pager="true"
              page="1"
            rowNum="10"
            pagerButtons="true"
                  pagerInput="true"
            gridview="true"
            rowTotal="true" 
            rownumbers="true" 
            rowList="10,20,30,40,40,50,60,70,80,90,100" 
            viewrecords="true"
            autowidth="true" 
            loadonce="true"
            viewrecords="true"
            > 

            <sjg:gridColumn  name="stRefID" formatter="formatViewLink"
                title="%{getText('COMMON_REFERENCE_NUMBER')}"  />

            <sjg:gridColumn name="requestType.stName" 
                title="%{getText('RequestTracking_Request_Type')}" />
            <sjg:gridColumn name="requestStatus.stStatus" 
                title="%{getText('RequestTracking_Request_Status')}" />

            <sjg:gridColumn name="requestStatus.tsDate" 
                          title="%{getText('DATE')}" 
                          formatoptions="{newformat : 'd/m/Y', 
                          srcformat : 'Y-m-d'}"   formatter="date" />

        </sjg:grid> 
```

Please help me to solve my bug

[enter link description here](https://code.google.com/p/struts2-jquery/issues/detail?id=971&thanks=971&ts=1366729966)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T05:32:06.050

我很确定您在使用 IE 时遇到了这个问题...？

它与网格插件无关，但 IE 在计算高度/宽度时包含滚动条大小的方式。

一种解决方法是`height`使用`<sjg:grid />`.

# asp.net - .net Mobile Detection Inconsistency

> ID：16173109
> 
> 赞同：1
> 
> 时间：2013-04-23T15:17:31.543
> 
> 标签：asp.net, .net

So, i'm trying to detect mobile requests in .net 4.

I discovered the Request.Browser.IsMobile and Request.Browser.MobileDeviceModel. This works great on my windows 7 laptop dev environment. Using my iPad: `IsMobile=true`, and `MobileDeviceModel="IPad"`.

But when I check this on Windows 2008 Server, I'm getting `IsMobile=false`, and `MobileDeviceModel="Unknown"`.

After digging around for a while, I discovered these properties are fueled by xml files in the .net framework folders: `C:\Windows\Microsoft.NET\Framework\v4.0.30319\Config\Browsers` And then, I noticed that my laptop's Browsers\iphone.xml has ipad info, while my server's same folder and same file does not contain ipad info.

```
<browsers>
    <gateway id="IPhone" parentID="Safari">
      ...
    </gateway>

    <gateway id="IPod" parentID="Safari">
      ...
    </gateway>

    <gateway id="IPad" parentID="Safari">
      <identification>
        <userAgent match="iPad" />
      </identification>

      <capabilities>
        <capability name="isMobileDevice"           value="true" />
        <capability name="mobileDeviceManufacturer" value="Apple" />
        <capability name="mobileDeviceModel"        value="IPad" />
      </capabilities>
    </gateway>
</browsers> 
```

My first though is to copy of my browser files over to the server. But I want to make sure it's safe and right to do so. Why would my laptop have these extra devices but not my server? It's the exact same .net version. And, is copying these files over the only thing I need to do?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:20:48.907

您确定您的笔记本电脑实际上没有安装 .NET 4.5？它安装在 C:\Windows\Microsoft.NET\Framework\v4.0.30313 中的同一位置，这有点误导。如果您使用的是 VS2012，那么您很可能安装了 .NET 4.5，它可能具有额外的浏览器配置。

无论如何，是的，您应该能够简单地将这个文件移动到您的服务器，或者如果您确定您实际上有不匹配的版本，则将您的服务器升级到 .NET 4.5。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-30T22:07:53.527

我们必须在生产服务器上执行此操作，因为我们还没有准备好升级到 .NET 4.5，但是浏览器检测问题导致 ASP.NET 认为 IE 10 和 11 不支持 JavaScript。修复方法是将 .browser 文件从 .NET 4.5 机器复制到生产 Web 服务器并重新编译 .browser 文件。请注意，重新编译不是免费的，因为它会导致 IIS 重置，从而影响任何用户。另请注意，在将其推送到生产环境之前，我们在较低集成环境中尝试过此操作。

# sql - In creating a new table in SQL Server 2005

> ID：16173115
> 
> 赞同：1
> 
> 时间：2013-04-23T15:17:52.327
> 
> 标签：sql, sql-server-2005

I have a table `Company`. Now I need to copy the contents of table `Company` in a new table `Employee` (that too while creating the `Employee` table). I just used the query shown below, but its showing an ERROR.

```
 Create Table Employee as (Select * from Company) 
```

Is there any other solution for this....?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:20:50.307

只需使用[`INTO`](http://msdn.microsoft.com/en-us/library/ms188029%28v=sql.90%29.aspx)：

```
Select * into Employee from Company 
```

# android - 让 textview 在触摸滚降时更改样式/属性

> ID：16173118
> 
> 赞同：0
> 
> 时间：2013-04-23T15:17:59.067
> 
> 标签：android, button, textview, touch

好吧，我这辈子都想不通。我创建了一个自定义文本视图，我基本上希望它是一个按钮。我的所有代码都在工作，只是我无法检测到何时被触摸，然后触摸事件滚出其边界。假设文本视图在触摸时亮起灰色，那么如果用户将手指向左或向右拖动，我想让灰色消失并重置为其正常的背景颜色。

我意识到我可以只使用标准的 android 按钮，但我不喜欢它如何延迟更改触摸事件的颜色。也许有人知道库存 Button.java 类代码在哪里，对于 android API，所以我可以查看它的提示？

我尝试使用 on 全局侦听器获取按钮的尺寸，然后跟踪用户触摸事件以使其处于这些尺寸内。并且尺寸和触摸位置被正确报告并且有时可以工作，但它根本不能可靠地工作，例如可能是由于用户移动得太快。即使我将触摸边界设置在实际边界内的几个像素处。

# python - “剪切”字符串变量并将新部分分配给相同的变量名时的内存使用情况

> ID：16173119
> 
> 赞同：3
> 
> 时间：2013-04-23T15:17:58.967
> 
> 标签：python, string, memory, indexing

这里的基本python问题：说我有一个字符串变量

```
x='sdfghjk' 
```

我只需要使用字符串的一些字符，并将它们分配给相同的名称，例如

```
x=x[x.index('g'):] 
```

就内存而言，新的`x`“代替”旧的，还是我创建了重复项并无缘无故地使用了额外的内存？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:24:35.813

> 就内存而言，新的 x 是否“代替”了旧的 x，还是我创建了重复项，并且无缘无故地使用了额外的内存。

Python 字符串是不可变的，因此您正在创建一个副本，这将需要更多内存。如果你改为...

```
>>> x = 'sdfghjk'
>>> x = buffer(x, x.index('g'))
>>> print x
ghjk 
```

...您会得到类似的结果，但该`x`变量现在指的是分配原始字符串的同一块内存，如果您正在处理大量字符串，这可能会更可取。

或者，如果您想要一个可变字符串，请尝试使用[`bytearray`](http://docs.python.org/2/library/functions.html#bytearray).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:22:18.817

变量指向不同的内存。正如你看到的，

```
>>> x='gewfsafg'
>>> id(x)
140290029218384
>>> x=x[x.index('f'):]
>>> x
'fsafg'
>>> id(x)
140290029218288 
```

x的id变了，旧的内存被清理了

# c# - ASP.Net DropDownList OnSelectedIndexChange 未触发

> ID：16173124
> 
> 赞同：7
> 
> 时间：2013-04-23T15:18:03.893
> 
> 标签：c#, asp.net

我有以下 DropDownList 控件：

```
<asp:label runat="server" text="Filter by state: "></asp:label>
<asp:dropdownlist runat="server" id="filterbystate" 
    OnSelectedIndexChanged="FilterByState">
    <asp:ListItem value="all" selected="True">All</asp:ListItem>
    <asp:ListItem value="ca" selected="False">California</asp:ListItem>
    <asp:ListItem value="co" selected="False">Colorado</asp:ListItem>
    <asp:ListItem value="id" selected="False">Idaho</asp:ListItem>
    <asp:ListItem value="ut" selected="False">Utah</asp:ListItem>
</asp:dropdownlist> 
```

这是方法：

```
protected void FilterByState(object sender, EventArgs e)
{
    var value = e;
} 
```

由于某种原因，该方法不会触发。我选择了一个不同的值，没有任何反应。我想要做的是重新加载传递状态值的页面，以便我可以通过它过滤结果。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-23T15:20:40.403

设置`AutoPostBack=True`为您的 DDL 的属性，它将自动回发选定的索引更改事件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:21:17.670

将此添加到下拉列表 aspx 中，它将导致将请求发送到服务器，并且您的事件将被触发。

```
AutoPostBack="true" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:22:26.473

你只需要设置`AutoPostBack = True`

来自[`ListControl.AutoPostBack`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.autopostback.aspx)财产；

> 获取或设置一个值，该值指示当用户更改列表选择时是否自动回发到服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-04T05:45:48.503

`AutoPostBack="true"`和

编写页面加载事件

```
if (!IsPostBack)
{
   DDL_Designation_Bind();   
} 
```

// 因为`autopostback`属性触发加载事件然后我们`dropdownlist`重新绑定并且总是选择索引 0 所以不重新绑定`dropDownlist`

# android - LayoutParams 将视图放置在奇怪的位置

> ID：16173128
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:18:10.477
> 
> 标签：android, android-layout, android-relativelayout

我目前在我的应用程序中有一个 RelativeLayout，我可以动态移动、调整大小和隐藏它。移动一次后，布局会重新定位到一个奇怪的位置。

这是我正在使用的布局。

```
<RelativeLayout ...>
    <RelativeLayout android:id="@+id/moveable_layout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:clickable="true"
        android:visibility="gone" />
</RelativeLayout> 
```

这是我用来重新定位它的代码

```
RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(newWidth, newHeight);
m_movingFrame.setEnabled(true);
m_movingFrame.setLayoutParams(layoutParams);
m_movingFrame.setX(newX);
m_movingFrame.setY(newY);
m_movingFrame.requestLayout();
m_movingFrame.bringToFront();
m_movingFrame.setVisibility(View.VISIBLE); 
```

这是用于隐藏布局的代码

```
m_movingFrame.setEnabled(false);
m_movingFrame.setVisibility(View.GONE); 
```

我第一次重新定位它时，它会移动到正确的位置，但每次后续的重新定位都会将它移动到错误的位置。谁能告诉我为什么它的行为如此不稳定？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:20:38.417

First get the layout of the existing layout and then modify it.

```
 RelativeLayout.LayoutParams layoutParams = (RelativeLayout.LayoutParams) m_movingFrame.getLayoutParams();

...

m_movingFrame.setLayoutParams(layoutParams); 
```

# jquery - JQuery Datepicker 日期范围和月份

> ID：16173138
> 
> 赞同：0
> 
> 时间：2013-04-23T15:18:53.617
> 
> 标签：jquery, jquery-ui, datepicker, uidatepicker

我想根据可选择的天数显示显示的月数。

例如，如果我有 15 天可供选择，并且日期从今天（2013 年 4 月 23 日）开始，我希望仅将 4 月和 5 月显示为可供选择的月份数。

同样，如果可选择的天数为 60，我想将四月、五月和六月显示为显示的月数。

所以本质上我如何使显示的月数取决于可选择的天数？

提前谢谢了。

我的插件

```
$.fn.showCalendar = function(options){
    var defaults ={
        selector : "#date-selector",
        calendarIcon : "./images/icons/calendar.gif",
        numberOfSelectableDays : "+60D",
        dateFormat: "dd/mm/yy",
        numberOfMonths : 3,
        daySelector : "#day",
        monthSelector : "#month",
        yearSelector : "#year"
    }

    var $this = $(this);
    var params = $.extend({},defaults, options);

    var getDateFromDropDowns = function(){
         var dateOnDropDowns =  new Date($(params.daySelector).val(),$(params.monthSelector).val(),$(params.yearSelector).val());
         return  dateOnDropDowns;
    }

    return $this.each(function(){
        $this.datepicker({
            showOn: "button",
            buttonImage: params.calendarIcon,
            minDate: 0,
            maxDate: params.numberOfSelectableDays,
            dateFormat: params.dateFormat,
            buttonImageOnly: true,
            numberOfMonths: params.numberOfMonths,
            setDate : getDateFromDropDowns,
            onClose: function(dateText, inst) {
                $(params.yearSelector).val(dateText.split('/')[2]);
                $(params.daySelector).val(dateText.split('/')[0]);
                $(params.monthSelector).val(dateText.split('/')[1]);
            }
        });
    });
}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:07:11.157

根据评论更新要更新在屏幕上一次显示的月数，
您可以使用此代码来计算月数

```
var d = new Date(); 
var n = d.getDate(); 
var total=n+60; 
var numberOfMonthsVal=Math.floor(total/30)+1; 
```

并在`$this.datepicker({`使用中`numberOfMonths:numberOfMonthsVal`

* * *

使用 JQuery UI 日期选择器

```
$(function() {
    $( "#datepicker" ).datepicker({ minDate: -20, maxDate: "+1M +10D" }); // Thiw will sow the dates Today -20 to today + 1 Month +10 days
}); 
```

在您的情况下，您想显示从今天起接下来的 60 天？

```
$(function() {
    var day=new Date();
    $( "#datepicker" ).datepicker({ minDate: day, maxDate: (day+60) }); 
}); 
```

[http://jqueryui.com/datepicker/#min-max](http://jqueryui.com/datepicker/#min-max)

因此，当您调用时，在您的插件中`$this.datepicker({`传递以下值

```
 minDate: myDate,
        maxDate: (myDate+60) 
```

在哪里`mydate is actual Date object like var mydate=new Date();`

# php - Redis PHP 会话不持久

> ID：16173143
> 
> 赞同：0
> 
> 时间：2013-04-23T15:19:02.957
> 
> 标签：php, session, cookies, redis, persistent

我正在使用这个包来替换 cookied 会话，以便我的 facebook 应用程序仍然可以工作。

[https://github.com/nicolasff/phpredis](https://github.com/nicolasff/phpredis)

我不需要将 cookie 用于会话，但即使使用 redis 解决方案，它也只会在启用 cookie 的情况下持续存在。

有没有办法在没有 cookie 的情况下持久化 redis 存储？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:40:38.130

大多数会话解决方案都需要 Cookie，因为浏览器必须向服务器发送一个唯一标识符，指示用户是谁。代替 cookie，每当用户单击链接/提交表单等时，您都必须将 URL 上的会话标识符作为查询字符串参数传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:02:16.973

我最终赶上了 session_id()，通过 Javascript 发送它。使用

```
$.ajaxSetup({ data: sessionId }); 
```

让每个 ajax 调用发送 sessionID

然后，使用

```
if(isset($_REQUEST['sessionId'])) session_id($_REQUEST['sessionId'])); 
```

设置会话。现在避免使用 Cookie。

# node.js - 用咖啡运行我的应用程序与编译它和作为 javascript 运行它有什么区别？

> ID：16173144
> 
> 赞同：1
> 
> 时间：2013-04-23T15:19:04.713
> 
> 标签：node.js, coffeescript

目前，我正在像这样运行我的应用程序，`coffee app.coffee`但我想知道将其编译为 javascript 然后像这样运行它是否是一个更好的选择`node app.js`。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:37:54.900

通过命令运行您的应用程序`coffee`很好，因为您的代码在传递给 Node.js 之前最初会转换为 JavaScript。重要的是要注意这是预先发生的，并且这些解析都不会在运行时发生。

# xslt - 后删除空格 xslt 中的节点

> ID：16173145
> 
> 赞同：0
> 
> 时间：2013-04-23T15:19:05.520
> 
> 标签：xslt

我有下面的 xml，其中在转换后需要删除空格。

```
<section level="sect1" number-type="manual" num="I.">
    <title>INTRODUCTION</title>
    <para>
        <phrase>14.001</phrase> When a company in financial difficulty is unable to discharge its debts when they are due, a creditor has the right to take actions to, for example, realise assets or to have the company wound up compulsorily. However, putting the company in liquidation at the first sign of financial difficulty may not be the optimal choice for every stakeholder in the firm. Employees will lose their jobs. The company will lose its productive capacity, especially if the business is to be sold piecemeal. Unsecured creditors may not be able to recoup a penny from their investment. On the other hand, if the company is given a respite or, better still, some assistance in other forms, such as injection of fresh capital, in addition to some breathing space, the company may be nurtured back to its financial health. Even where resuscitation of the company is impossible, rescue measures may yield better economic results for most, if not all, stakeholders in the company enterprise. "Corporate rescue" therefore is a favoured alternative to liquidation in most of the developed economies. </para>
    <para>This chapter provides an overview of the ways in which corporate rescue has been effected in Hong Kong, although the focus of the examination is on the mechanisms under the Companies Ordinance (Cap 32) which have been used to effect corporate rescues. The remainder of this Chapter is organised into five parts. Part II and III consider the meaning and significance of corporate rescue. Part IV outlines the methods of corporate rescue. Part V and VI examine various informal approaches and formal legal devices that have been adopted or employed to effect corporate rescue in Hong Kong. </para>
</section> 
```

当我使用下面的 xslt 时，它会正确显示输出，但我希望删除短语标签后第一个段落中的空格。

```
<xsl:template name="para" match="section/para">
            <div class="para">
            <xsl:apply-templates/>              
            </div>
</xsl:template> 
```

电流输出如下。

```
<div class="para"> When a company in financial difficulty is unable to discharge its debts when they are due, a creditor has the right to take actions to, for....</para> 
```

和预期的输出是

```
<div class="para">When a company in financial difficulty is unable to discharge its debts when they are due, a creditor has the right to take actions to, for...</para> 
```

我尝试使用下面的，但它没有用。

```
<xsl:strip-space elements="*"/> 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:30:43.717

请尝试将此模板添加到您现有的 XSLT：

```
<xsl:template match="para/text()">
  <xsl:value-of select="normalize-space()" />
</xsl:template> 
```

# c# - How to convert a child class into a parent class for saving in NHibernate?

> ID：16173160
> 
> 赞同：0
> 
> 时间：2013-04-23T15:19:43.557
> 
> 标签：c#, nhibernate, inheritance

I have the following classes called:

```
public class Parent
{
     public string Field1;
     public string Field2; 
}

public class Child : Parent
{
    public string Field3;
} 
```

I now have a list of Child objects and I need to pass then into a function that is looking for a Parent class.

What is the best way to convert Child class back to the Parent class (I don't care about field3 at this point)?

I am using NHibernate and when I pass in the child class and try to save it, I get this error:

> No persister for: ChildClass

even though the 'Parent' class has a persister.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T15:20:29.403

Instances of the child class *are* instances of the parent class.
You don't need to do anything special.

# javascript - jQuery创建的链接没有在IE中触发

> ID：16173165
> 
> 赞同：0
> 
> 时间：2013-04-23T15:19:54.213
> 
> 标签：javascript, jquery, html, internet-explorer, onclick

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:23:22.347

您不应该`onclick`以这种方式操纵属性。内联处理程序通常是一个坏主意，因此像这样使用它们更糟糕。

相反，您应该使用事件处理程序。在这种情况下：

```
a.click(highlightDynamicMenu); 
```

您可以保留`attr... 'onclick':props.onclick[i]`，因为看起来您正在传递一个字符串，但实际上您应该尝试将其设为匿名函数并通过它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:27:18.537

Defualt 在代码中没有问题大多数时候 IE 的行为与其他行为不同。msdn 上报告了类似的问题。

[http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/ec196223-248b-4483-ada8-93838f5c5249/](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/ec196223-248b-4483-ada8-93838f5c5249/)

像这样尝试假设按照您的示例`props.onclick[i]`使用 sarts`javascritp:``onclick="javascript:show('div1208', 'div1208', event);highlightDynamicMenu(this);"`

```
var onclick = props.onclick[i] + ';highlightDynamicMenu(this);';
    a.attr( {
        'class' : cssclass,
        'href' : onclick, // On Click variable value which will be something like javascript:show('div1208', 'div1208', event);highlightDynamicMenu(this);
         }
    );
    a.append(props.views[i]); 
```

# ruby-on-rails-3.2 - Benchmarking with existing data

> ID：16173167
> 
> 赞同：1
> 
> 时间：2013-04-23T15:20:01.073
> 
> 标签：ruby-on-rails-3.2, capybara, benchmarking

I'm new to Rails but not new to software development and so some of these may be elementary questions mixed in with head-scratching ones.

We are trying to get some benchmarking in our app and are having some frustrating moments getting Rails, Capybara, and the database to play well together.

We have a database already filled with data, so I decided to start with that. This is the script I wrote to create and db and run the test:

```
 #!/bin/bash

 RAILS_ENV=test

 RAILS_ENV=$RAILS_ENV rake db:drop

 RAILS_ENV=$RAILS_ENV rake db:create

 RAILS_ENV=$RAILS_ENV rake db:migrate

 RAILS_ENV=$RAILS_ENV rake demo:data:load

 RAILS_ENV=$RAILS_ENV  rake test:benchmark 
```

This is the simple test that I wrote:

```
require 'test_helper'
require 'rails/performance_test_help'

require 'capybara/rails'

# Profiling results for each test method are written to tmp/performance.
class BrowsingTest < ActionDispatch::PerformanceTest
  def setup
     sign_in "fred"
  end
  def test_dashboard
     get '/dashboard'
     get '/question_collections'
     get '/question_collections/5'
     get '/question_collections/5/questions/60'

     get '/message_collections'

   end

end 
```

And I get the following error:

```
 NoMethodError: undefined method `sign_in' for 
     test_dashboard(BrowsingTest):BrowsingTest.test/performance/browsing_test.rb:7:in `setup' 
```

So it seems that Capybara isn't found, which is odd since we use it in our functional tests quite a bit. Then I rolled my own version of the login and came up with:

```
require 'test_helper'
require 'rails/performance_test_help'

# Profiling results for each test method are written to tmp/performance.
class BrowsingTest < ActionDispatch::PerformanceTest
   def setup
     login_as
   end
  def test_dashboard
   .....
  end

def login_as
  open_session do |sess|

    user = {}
    user["username"]='fred'
    user["password"]='*****'
    sess.post "/users/sign_in", :user=>user

  end
  end

end 
```

And that, at least, ran and gave me metrics. But I see this in the log:

```
 Started POST "/users/sign_in" for 127.0.0.1 at 2013-04-23 10:09:54 -0500
 Processing by DualLoginController#create as HTML
   Parameters: {"user"=>{"username"=>"fred", "password"=>"[FILTERED]"}}
  Completed 401 Unauthorized in 24ms
  Processing by DualLoginController#new as HTML
 Parameters: {"user"=>{"username"=>"fred", "password"=>"[FILTERED]"}}
  Rendered devise/shared/_links.erb (1.5ms)
  Rendered devise/sessions/new.html.erb within layouts/application (79.6ms)
 Completed 200 OK in 277ms (Views: 189.2ms | ActiveRecord: 0.0ms)

 Started GET "/dashboard" for 127.0.0.1 at 2013-04-23 10:09:55 -0500
   Processing by DashboardController#index as HTML
 Completed 401 Unauthorized in 1ms 
```

It seems that the user logged in (maybe) but then wasn't able to get to "/dashboard". The other controllers are the same. If I simply run `rake demo:data:load && rails s` I can login with `fred` and it works fine.

I'm thinking that that the Capybara issue and the database issue is related -- that, for some reason, `rake test:benchmark` isn't running in the Test environment so the data isn't found and Capybara isn't loaded.

Anyone have any thoughts?

# string - 在 R 的不同列中查找字符串

> ID：16173169
> 
> 赞同：3
> 
> 时间：2013-04-23T15:20:06.387
> 
> 标签：string, r, variables, search, multiple-columns

我有一个包含数百行的 4 列数据集，这里有一个小示例：

```
A      B     C     D     
V1     V2    V100    V4
V15    V5    V6    V100 
V8     V3    V9    V10
V3     V11   V12   V13 
```

我想得到一个在 A 列中但不在其他列中的变量列表（如上例中的 V1），然后是另一个列 C 和 D 中但不在其他列中的变量列表（如示例中的 V100 ） 等等。任何简单的命令都可以做到这一点而不必进入复杂的 for 循环？

重要提示：我的名字太复杂了（并且它们包含括号、斜杠、反斜杠和取消标记）这只是我所拥有的简单表示。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:36:18.857

构建一个[可重现的例子](https://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example)：

```
set.seed(1)
d <- data.frame(replicate(4,paste0("V",sample(1:10,4,replace=TRUE))))
names(d) <- LETTERS[1:4]
#    A   B  C  D
#1  V3  V3 V7 V7
#2  V4  V9 V1 V4
#3  V6 V10 V3 V8
#4 V10  V7 V2 V5 
```

我相信你正在寻找`setdiff`.

```
with(d,setdiff(A,D)) 
```

如果您想进行多重比较，`Reduce`可能会有所帮助：

```
with(d,Reduce(setdiff,list(A,B,C,D))) 
```

如果要将一列与许多（或所有）其他列进行比较：

```
Reduce(setdiff,c(d[,"A",drop=FALSE],d[,setdiff(names(d),"A"),drop=FALSE])) 
```

# mysql - 带有非打印字符的 MySQL 查询（从左到右标记）

> ID：16173173
> 
> 赞同：2
> 
> 时间：2013-04-23T15:20:20.450
> 
> 标签：mysql, unicode

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T01:16:29.527

要获得一个 unicode char，这样的事情应该可以工作：

```
SELECT CHAR(<number> USING utf8); 
```

另外，不要使用`REGEXP`，因为 MySQL 使用的 regexp 库很旧，并且不支持多字节字符集。

# javascript - 提取字符串的中间或最后部分

> ID：16173178
> 
> 赞同：1
> 
> 时间：2013-04-23T15:20:34.717
> 
> 标签：javascript, regex

我只想从 Google Webfont Directory 的 URL 字符串中提取第一个字体名。以下是一些可能的字符串示例以及应返回的部分：

```
fonts.googleapis.com/css?family=Raleway              // "Raleway"
fonts.googleapis.com/css?family=Caesar+Dressing      // "Caesar Dressing"
fonts.googleapis.com/css?family=Raleway:300,400      // "Raleway"
fonts.googleapis.com/css?family=Raleway|Fondamento   // "Raleway"
fonts.googleapis.com/css?family=Caesar+Dressing|Raleway:300,400|Fondamento  // "Caesar Dressing" 
```

所以有时它只是一个字体名，有时它有一个用冒号 ( `:`) 表示的权重，有时还有更多的字体名用竖线 ( `|`) 分隔。

我已经尝试过`/family=(\S*)[:|]/`，但它只匹配带有`:`or的字符串`|`。我可以这样做，但这不是一个好的解决方案：

```
var fontUrl = "fonts.googleapis.com/css?family=Caesar+Dressing|Raleway:300,400|Fondamento";
var fontName = /family=(\S*)/.exec(fontUrl)[1].replace(/\+/, " ");
if (fontName.indexOf(':') != -1){
    fontName = fontName.split(':')[0];
}
if (fontName.indexOf('|') != -1){
    fontName = fontName.split('|')[0];
}
console.log(fontName); 
```

有一个很好的`regex`解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:25:34.507

而不是匹配（可能）跟随你想要的字符串的字符，只匹配你想要的字符串，*除了那些字符*：

```
/family=([^\s:|]*)/ 
```

或者，您可以像这样使用[前瞻](http://www.regular-expressions.info/lookaround.html)：

```
/family=(\S*?)(?=$|[:|])/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:25:22.280

那应该更好：

```
/family=([^:|]*)/ 
```

当然，对于这种`+`情况，您必须在之后（或之前）更换它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:29:50.253

您可以使用（在所有情况下都选择 i 和 m 修饰符）：

```
family=([a-z]+\+?[a-z]+) 
```

或更简单地说

```
family=([a-z+]+) 
```

或避免匹配 + 字符：

```
family=([a-z]+)\+?([a-z]+)? 
```

但这是使用第二种解决方案的一种更简单的方法，并将 + 字符替换为后面的空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:31:00.780

在这种情况下不需要正则表达式，除非您擅长正则表达式或彻底测试它们，否则您很可能会犯错误。

```
var fontUrls = [];

fontUrls.push("fonts.googleapis.com/css?family=Raleway");
fontUrls.push("fonts.googleapis.com/css?family=Caesar+Dressing");
fontUrls.push("fonts.googleapis.com/css?family=Raleway:300,400");
fontUrls.push("fonts.googleapis.com/css?family=Raleway|Fondamento");
fontUrls.push("fonts.googleapis.com/css?family=Caesar+Dressing|Raleway:300,400|Fondamento");

function getFirstFont(url) {
    return url.split("=")[1].split("|")[0].split(":")[0];
}

fontUrls.forEach(function (fontUrl) {
  console.log(getFirstFont(fontUrl));
}); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/PvTpN/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:25:54.397

尝试这个：

```
/family\=(\S+?)[\:\|,]{0,2}\S*/ims 
```

# java - 在外部函数中使用 for 循环中的值

> ID：16173181
> 
> 赞同：1
> 
> 时间：2013-04-23T15:20:36.790
> 
> 标签：java, swing, for-loop, jfreechart, listselectionlistener

我需要从 for 循环内找到的值用于不在循环内的函数中，但我不知道如何执行此操作。我希望完成的是从哈希图中的键中提取值，然后`JTable` *仅在选择该行时才*在 a 中绘制（使用 a `ListSelectionListener`）。这样，我可以避免绘制一百个表格，从而节省大量时间。我也在使用`DefaultTableModel`.

这是我的 for 循环：

```
tableMaker(model);
for(Map.Entry<String,NumberHolder> entry : entries)
{   
  //add rows for each entry of the hashmap to the table             

  double[] v = new double[entry.getValue().singleValues.size()];
  int i = 0;
  for(Long j : entry.getValue().singleValues)
  {
    v[i++] = j.doubleValue();
  }                  
  //right here I need to take "v" 
  //and use it in my tableMaker function for that specific row
} 
```

在我的`tableMaker`函数中，我创建`JTable`并添加了一个`ListSelectionListener`，我希望在选择一行时创建一个直方图并将其添加到我的 lowerPanel。这是部分代码。我需要`v`这样才能创建数据集。

```
public static void tableMaker(DefaultTableModel m)
{
   JPanel lowerPanel = new JPanel();

   //create table here

   frame.getContentPane().add(lowerPanel, BorderLayout.SOUTH);
   table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

    table.getSelectionModel().addListSelectionListener(
            new ListSelectionListener() {

            @Override
            public void valueChanged(ListSelectionEvent e) {
                if (!e.getValueIsAdjusting()) {
                    JFreeChart chart = ChartFactory.createHistogram(
                        plotTitle, xaxis, yaxis, dataset, orientation,
                        show, toolTips, urls);                      
                //  lowerPanel.add(chart);
                //  lowerPanel.revalidate();
                }
            }
        });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:08:31.263

我感觉到您正在尝试实施[此处](https://stackoverflow.com/q/16085734/230513)概述的方法。与其每次都尝试创建一个新图表，不如在 a 中创建一个图表`ChartPanel`并保留对其的引用`XYPlot`。在您的`ListSelectionListener`中，您可以使用`plot.setDataset()`来更新图表。在此[示例](https://stackoverflow.com/a/15207445/230513)中，a`ChangeListener`从现有的`List<XYDataset>`. 在此[示例](https://stackoverflow.com/a/11895709/230513)`ActionListener`中，每次调用按钮时都会生成数据集。

# c# - UserPrincipal.FindByIdentity 抛出 PrincipalServerDownException

> ID：16173184
> 
> 赞同：2
> 
> 时间：2013-04-23T15:20:39.250
> 
> 标签：c#, active-directory, directoryservices, account-management, userprincipal

我有一个应用程序需要绑定到远程客户的 Active Directory 以执行身份验证任务。

```
using (var ctx = new PrincipalContext(ContextType.Domain, "customer.org", "ou=people,dc=customer,dc=org", ContextOptions.SecureSocketLayer | ContextOptions.SimpleBind, "bindaccount@customer.org", "password"))
{
   var user = UserPrincipal.FindByIdentity(ctx, IdentityType.SamAccountName, username); // after several seconds, throws PrincipalServerDownException

   if (user == null) return null; // user doesn't exist

   // check if the account is locked out, etc. (omitted)   

   // quickly validate credentials
   if (!ctx.ValidateCredentials(username, password, ContextOptions.SecureSocketLayer | ContextOptions.SimpleBind)) return null; // bad credentials

   return user;   
} 
```

例外是：

> PrincipalServerDownException：服务器无法运行。

```
at System.DirectoryServices.AccountManagement.ADStoreCtx.GetAsPrincipal(Object storeObject, Object discriminant)
at System.DirectoryServices.AccountManagement.ADStoreCtx.FindPrincipalByIdentRefHelper(Type principalType, String urnScheme, String urnValue, DateTime referenceDate, Boolean useSidHistory)
at System.DirectoryServices.AccountManagement.ADStoreCtx.FindPrincipalByIdentRef(Type principalType, String urnScheme, String urnValue, DateTime referenceDate)
at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithTypeHelper(PrincipalContext context, Type principalType, Nullable`1 identityType, String identityValue, DateTime refDate)
at System.DirectoryServices.AccountManagement.Principal.FindByIdentityWithType(PrincipalContext context, Type principalType, IdentityType identityType, String identityValue)
at System.DirectoryServices.AccountManagement.UserPrincipal.FindByIdentity(PrincipalContext context, IdentityType identityType, String identityValue) 
```

直到今天，一切都很好。一个变化是运行此代码的应用程序从 4 升级到 4.5。我不能确定问题是在升级后立即发生的，还是只是巧合。

我一直在使用 AdFind 来测试与客户 AD 的绑定，它似乎工作正常。

另一个有趣的事情是`PrincipalContext`初始化很好（从而验证了它与远程存储的连接），如果我注释掉`FindByIdentity`调用`ctx.ValidateCredentials`，那么它也可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T18:51:42.593

实际上4.5很可能是问题所在。对“安全”UerPrincipal.FindByIdentity 进行了一些更改。他们倾向于在跨域和工作组 => 域场景中破坏代码。

你至少有两种可能：

*   恢复到 4.0
*   改用 DirectoryEntry

# android - 将 radioButton 添加到 radioGroup 会导致应用在 Android 中崩溃

> ID：16173191
> 
> 赞同：0
> 
> 时间：2013-04-23T15:20:54.713
> 
> 标签：android, radio-button, dynamically-generated, radio-group

我一直在尝试以编程方式在 android 的弹出窗口中将单选按钮添加到单选组，但没有成功。当我尝试将新创建的 radioButton 添加到 radioGroup 时，应用程序关闭。任何建议将不胜感激！这是代码：

```
 {
    RadioGroup rg = (RadioGroup) findViewById(R.id.food_group);
             for (int i = 0; i < matches.size(); i++) {
                 Log.v("AddFood", "i " + i);
             RadioButton radiobutton = new RadioButton(this);
           radiobutton.setText(matches.get(i));
            radiobutton.setId(i);
            Log.v("AddFood", "here1");
            rg.addView(radiobutton);
            Log.v("AddFood", "here2");

        }
        LayoutInflater layoutInflater = (LayoutInflater)getBaseContext().getSystemService(LAYOUT_INFLATER_SERVICE);  
       View popupView = layoutInflater.inflate(R.layout.popup_database_input, null); 
    popupWindow = new PopupWindow(popupView, LayoutParams.WRAP_CONTENT,  
                     LayoutParams.WRAP_CONTENT);  

        popupWindow.setFocusable(true);

        Button btnDismiss = (Button)popupView.findViewById(R.id.dismiss);
        btnDismiss.setOnClickListener(new Button.OnClickListener(){

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                popupWindow.dismiss();
            }});

        Button btnOK = (Button)popupView.findViewById(R.id.accept);
        btnOK.setOnClickListener(new Button.OnClickListener(){

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                popupWindow.dismiss();
            }});
    }

    popupWindow.showAtLocation(arg0, Gravity.CENTER, 0, 0); 
```

这是弹出窗口的xml：

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/background_light"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_margin="1dp"
        android:layout_weight="0.67"
        android:background="@android:color/darker_gray"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="20dp"
            android:orientation="vertical" >

            <TextView
                android:layout_width="258dp"
                android:layout_height="59dp"
                android:text="@string/found_match"
                android:textColor="@android:color/black" />

            <RadioGroup
                android:id="@+id/food_group"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content" >

            </RadioGroup>

            <Button
                android:id="@+id/dismiss"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/Cancel" />

            <Button
                android:id="@+id/accept"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:text="@string/ok" />
        </LinearLayout>
    </LinearLayout>

    </LinearLayout> 
```

这是日志猫：

```
04-23 15:04:15.142: D/gralloc_goldfish(2307): Emulator without GPU emulation detected.
04-23 15:04:27.802: D/Home(2307): switching activities...
04-23 15:04:28.912: D/dalvikvm(2307): GC_CONCURRENT freed 76K, 7% free 2711K/2908K,      paused 71ms+10ms, total 225ms
04-23 15:04:28.912: D/dalvikvm(2307): WAIT_FOR_CONCURRENT_GC blocked 137ms
04-23 15:04:28.922: I/dalvikvm-heap(2307): Grow heap (frag case) to 3.370MB for 635812-byte allocation
04-23 15:04:29.052: D/dalvikvm(2307): GC_FOR_ALLOC freed 4K, 6% free 3328K/3532K, paused 126ms, total 126ms
04-23 15:04:29.333: V/addSugar(2307): creating
04-23 15:04:29.952: I/Choreographer(2307): Skipped 89 frames!  The application may be doing too much work on its main thread.
04-23 15:04:32.002: V/addSugar(2307): searchFoodButton clicked. food is:
04-23 15:04:32.102: W/System.err(2307): java.lang.IllegalStateException: Target host must not be null, or set in parameters. scheme=null, host=null, path=ec2-50-17-119-232-compute-1.amazonaws.com/glucose/find_food/
04-23 15:04:32.111: V/AddFood(2307): i 0
04-23 15:04:32.222: V/AddFood(2307): here1
04-23 15:04:32.222: D/AndroidRuntime(2307): Shutting down VM
04-23 15:04:32.232: W/dalvikvm(2307): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
04-23 15:04:32.271: E/AndroidRuntime(2307): FATAL EXCEPTION: main
04-23 15:04:32.271: E/AndroidRuntime(2307): java.lang.IllegalStateException: Could not execute method of the activity
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.view.View$1.onClick(View.java:3599)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.view.View.performClick(View.java:4204)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.view.View$PerformClick.run(View.java:17355)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.os.Handler.handleCallback(Handler.java:725)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.os.Looper.loop(Looper.java:137)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at java.lang.reflect.Method.invokeNative(Native Method)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at java.lang.reflect.Method.invoke(Method.java:511)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at dalvik.system.NativeStart.main(Native Method)
04-23 15:04:32.271: E/AndroidRuntime(2307): Caused by: java.lang.reflect.InvocationTargetException
04-23 15:04:32.271: E/AndroidRuntime(2307):     at java.lang.reflect.Method.invokeNative(Native Method)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at java.lang.reflect.Method.invoke(Method.java:511)
04-23 15:04:32.271: E/AndroidRuntime(2307):     at android.view.View$1.onClick(View.java:3594)
04-23 15:04:32.271: E/AndroidRuntime(2307):     ... 11 more
04-23 15:04:32.271: E/AndroidRuntime(2307): Caused by: java.lang.NullPointerException
04-23 15:04:32.271: E/AndroidRuntime(2307):     at        com.insulinapp.AddSugar.searchFoodHandler(AddSugar.java:99)
04-23 15:04:32.271: E/AndroidRuntime(2307):     ... 14 more
04-23 15:04:34.592: I/Process(2307): Sending signal. PID: 2307 SIG: 9 
```

# sql - Row_Number() 超过 20 亿条记录 (Teradata)

> ID：16173192
> 
> 赞同：3
> 
> 时间：2013-04-23T15:20:57.393
> 
> 标签：sql, teradata

我正在使用 Teradata 仓库，并且在我的一个 sql 脚本中使用 row_number。我尝试在其上使用脚本的记录集大于整数值阈值的最大值。在这种情况下该怎么办？

（将“row_number() over (par..)”表达式转换为 bigint 不起作用）

如果您在另一个 DBMS 中找到了此问题的解决方案，那么我也欢迎您的解决方案，因为它也可能适用于 Teradata。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:40:43.527

仅转换值可能会起作用。

如果没有，试试这个：

```
select sum(cast(1 as bigint)) over (order by . . . Rows Unbounded Preceding) 
```

或者，或者，

```
select csum(cast(1 as bigint), <order by column here>) 
```

# java - 为什么我不能在 Android 的 SQLite 数据库中添加这些默认值？

> ID：16173196
> 
> 赞同：0
> 
> 时间：2013-04-23T15:21:07.733
> 
> 标签：java, android, debugging, android-sqlite, default-value

所以我正在构建一个警报应用程序。我想在首次安装应用程序时显示一些默认警报。例如，上午 7 点、上午 8 点和上午 9 点的 3 个警报。下面是我的代码。

`getAllAlarms()`调用以检索要显示的警报列表。在第一次加载时，数据库将为空，所以如果是这种情况，我想插入一些默认值。这可以`else`在我添加警报然后对其自身进行递归调用的语句中看到。我的理解是添加了3个警报后，我`getAllAlarms`再次调用，它应该正常进入if语句。`System.out.println`从调试语句中可以看出，情况似乎就是这样。警报列表按预期打印出来，但是，沿线某处再次调用该方法，这导致列表变为空，如上一个调试语句中所示。

你能看出问题出在哪里吗？我已经在项目中进行了文件搜索，我没有在任何地方调用 delete 方法，也没有`getAllAlarms`在方法本身内部和`ListActivity`. 问题必须定位在`getAllAlarms`我认为的方法中，但我找不到。是递归调用吗？

```
 // Getting All Alarms
public List<Alarm> getAllAlarms() {
    List<Alarm> alarmList = new ArrayList<Alarm>();
    // Select All Query
    String selectQuery = "SELECT  * FROM " + TABLE_ALARMS;

    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    // looping through all rows and adding to list
    if (cursor.moveToFirst()) {
        do {
            Alarm alarm = new Alarm();
            alarm.setID(cursor.getInt(0));
            alarm.setHour(cursor.getInt(1));
            alarm.setMinutes(cursor.getInt(2));
            // Adding alarm to list
            alarmList.add(alarm);
            System.out.println("inside loop");
            System.out.println(alarmList);

        } while (cursor.moveToNext());
    }
    else
    {           
        System.out.println("Adding default values...");
        addAlarm(new Alarm(7,0));
        addAlarm(new Alarm(8,0));
        addAlarm(new Alarm(9,0));
        System.out.println("Finished adding default values...");
        getAllAlarms();
    }

    System.out.println("before");
    System.out.println(alarmList);
    System.out.println("after");
    // return alarm list
    return alarmList;
} 
```

这是我的添加方法：

```
void addAlarm(Alarm alarm) {
    SQLiteDatabase db = this.getWritableDatabase();

    ContentValues values = new ContentValues();
    values.put(KEY_HOUR, alarm.getHour()); // Alarm Name
    values.put(KEY_MINUTES, alarm.getMinutes()); // Alarm Phone

    // Inserting Row
    db.insert(TABLE_ALARMS, null, values);
    db.close(); // Closing database connection
} 
```

调试输出：

```
04-23 16:17:49.261: I/System.out(10938): Adding default values...
04-23 16:17:49.291: I/System.out(10938): Finished adding default values...
04-23 16:17:49.291: I/System.out(10938): inside loop
04-23 16:17:49.291: I/System.out(10938): [07:00]
04-23 16:17:49.296: I/System.out(10938): inside loop
04-23 16:17:49.296: I/System.out(10938): [07:00, 08:00]
04-23 16:17:49.296: I/System.out(10938): inside loop
04-23 16:17:49.296: I/System.out(10938): [07:00, 08:00, 09:00]
04-23 16:17:49.296: I/System.out(10938): before
04-23 16:17:49.296: I/System.out(10938): [07:00, 08:00, 09:00]
04-23 16:17:49.296: I/System.out(10938): after
04-23 16:17:49.296: I/System.out(10938): before
04-23 16:17:49.296: I/System.out(10938): []
04-23 16:17:49.296: I/System.out(10938): after 
```

更新：：

我试过这个无济于事：

if (cursor.moveToFirst()) { 做 { 警报警报 = 新警报 (); alarm.setID(cursor.getInt(0)); alarm.setHour(cursor.getInt(1)); alarm.setMinutes(cursor.getInt(2)); // 添加警报到列表 alarmList.add(alarm); System.out.println("内部循环"); System.out.println(alarmList);

```
 } while (cursor.moveToNext());            
}
else
{           
    System.out.println("Adding default values...");
    addAlarm(new Alarm(7,0));
    addAlarm(new Alarm(8,0));
    addAlarm(new Alarm(9,0));
    System.out.println("Finished adding default values...");
}

if(alarmList.isEmpty() || alarmList == null)
{
    System.out.println("test"  + alarmList);
    getAllAlarms();
} 
```

但是，如果我删除 if 语句以检查空列表，然后我将检查添加到数据库外部和`ListActivity`. 这不是我想要的。我不想在 Database 类之外处理默认值插入。

else {
System.out.println("添加默认值..."); addAlarm（新警报（7,0））；addAlarm(新警报(8,0)); addAlarm（新警报（9,0））；System.out.println("完成添加默认值..."); }

和里面`ListActivity`：

```
protected void onCreate(Bundle savedInstanceState)
{
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_alarm_list);

Database db = new Database(AlarmListActivity.this);
list = db.getAllAlarms();
if(list.isEmpty())
{
    list = db.getAllAlarms();
}
....
.... 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:56:06.167

正如@umesh 建议的那样，使用getReadableDatabase()，不需要db.close()，但最重要的是把你写的东西包装在一个事务中：

```
db.beginTransaction();
// insert
db.setTransactionSuccessful();
db.endTransaction(); 
```

**更新：**单例（ish）模式

```
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DBOpenHelper extends SQLiteOpenHelper {

    private enum OpenHelperEnum {
        INSTANCE; // Singleton instance;

        // Instance of dbHelper for all DB access in threads
        private SQLiteOpenHelper dbHelper = null;
        private SQLiteDatabase database = null;

        public SQLiteDatabase getDB(final Context context) {
            if (dbHelper == null) {
                dbHelper = new DBOpenHelper(context);
            }
            if (database == null) {
                database = dbHelper.getReadableDatabase();
            }
            return database;
        }
    }

    public DBOpenHelper(final Context context) {
        super(context, "DBName", null, 1);
    }

    @Override
    public void onCreate(final SQLiteDatabase database) {
        // ...
    }

    @Override
    public void onUpgrade(final SQLiteDatabase database, final int oldVersion, final int newVersion) {
        // ...
    }

    @Override
    public void onDowngrade(final SQLiteDatabase database, final int oldVersion, final int newVersion) {
        // ...
    }

    public static SQLiteDatabase getDB(final Context context) {
        return DBOpenHelper.OpenHelperEnum.INSTANCE.getDB(context);
    }
} 
```

要获取数据库，请使用：

```
final SQLiteDatabase db = DBOpenHelper.getDB(this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:31:36.967

在`getAllAlarms`方法只是改变

```
getWritableDatabase 
```

到

```
getReadableDatabase 
```

像下面

```
String selectQuery = "SELECT  * FROM " + TABLE_ALARMS;

SQLiteDatabase db = this.getReadableDatabase();
Cursor cursor = db.rawQuery(selectQuery, null); 
```

# r - 编制一份按带有特殊字符的变量拆分的 PDF 报告 (å æ ø) - 编码问题

> ID：16173199
> 
> 赞同：7
> 
> 时间：2013-04-23T15:21:13.313
> 
> 标签：r, character-encoding, special-characters, knitr

我尝试根据分组变量生成一个 PDF 报告拆分部分，使用`brew`和`knitr`。我的分组变量可能包含特殊字符（变音符号），例如 å æ ø。

仅文档标题中的变音符号可以很好地处理`\usepackage[utf8]{inputenc}`（参见下面的示例）。但是，分组变量中的变音符号会产生错误`\usepackage[utf8]{inputenc}`。

另一方面，当我尝试时`\usepackage[T1]{fontenc}`，分组变量中的变音符号得到了正确处理。但是现在标题没有正确编码。

我正在努力在标题和分组变量中正确编码。

这是一个示例，我尝试生成一份 PDF 报告，其中包含 iris 数据集中每个物种的汇总统计小节。我希望它可以说明我的问题。

## 用于准备没有变音符号的数据的 R 代码

```
library(plyr)
library(xtable)
library(knitr)
library(brew)
library(stringr) 
```

为内置`iris`数据集中的每个物种创建一个汇总表。首先，使用原始`Species`名称，不要使用变音符号。仅文档中的变音`\title`符号（请参阅`.rnw`模板文件的代码）。将汇总表存储在列表中。

```
 data(iris)
 iris_tbl <- dlply(.data = iris, .variables = .(Species), function(x) xtable(summary(x))) 
```

定义函数`brew_knit_pdf`。该函数将模板乳胶文件酿造`xxx.rnw`成一个新`.rnw`文件`xxx_out.rnw`，该文件对于循环的每个项目/组都有一个部分。然后将`xxx_out.rnw`from`brew`用作输入文件`knit2pdf`并转换为 PDF。

```
brew_knit_pdf <- function(template, ...){
  brew_out <- str_replace(string = template, pattern = ".rnw", replacement = "_out.rnw")
  brew(file = template, output = brew_out)
  knit2pdf(input = brew_out, ...)
}

brew_knit_pdf("iris_umlaut_tbl.rnw") 
```

## .rnw 模板文件的代码

在我的示例中，我为以下代码命名了模板文件`iris_umlaut_tbl.rnw`。此文件用作`brew_knit_pdf`R 脚本中函数的输入。

```
\documentclass{article}

% \usepackage[T1]{fontenc}    
\usepackage[utf8]{inputenc}

\usepackage{geometry}
\geometry{tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}

\begin{document}

\begin{titlepage}

\title{Using brew and knitr to produce one PDF report split by a grouping variable.\\Problem with å æ ø in grouping variable}

\clearpage\maketitle
\thispagestyle{empty}

\tableofcontents

\end{titlepage}
\newpage

\section{Summary statistics for each species}

% R code loop wrapped in brew syntax, which brews the template file xxx.rnw to a new .rnw file xxx_out.rnw, which has one section for each group that is looped over, i.e. the names of the list iris_tbl produced in the R script.

<% for (Sp in names(iris_tbl)) { -%>

\subsection{<%= Sp %>}
<<sum-<%= Sp %>, echo=FALSE, results='asis'>>=
print(iris_tbl[["<%= Sp %>"]])
@
\newpage
<% } %>

\end{document} 
```

## 使用变音符号准备数据的 R 代码

为了模仿我的真实数据，我将虹膜数据中的物种名称替换为（无意义的）名称，而不是包含变音符号。

```
data(iris)
iris$Species <- as.character(iris$Species)

iris$Species[iris$Species == "setosa"] <- "åsetosa"
iris$Species[iris$Species == "versicolor"] <- "æversicolor"
iris$Species[iris$Species == "virginica"] <- "øvirginica"

# create a summary table for each species
iris_tbl <- dlply(.data = iris, .variables = .(Species), function(x) xtable(summary(x))) 
```

准备好 iris_tbl 的“变音变音版本”后，我在与上述相同的 .rnw 文件上运行 brew_knit_pdf 函数，除了我使用不同的编码包（inputenc 和/或 fontenc）。

## **结果**

这是迄今为止四次尝试的总结；使用不带或带变音符号的数据集，并在 .rnw 文件中使用不同的编码包。

1.  *   R 数据：iris_tbl 用非变音符号准备
    *   .rnw 文件： 中的变音符号`\title{ }`，`\usepackage[utf8]{inputenc}`

**在标题中**输出变音符号 OK****

 **2.  *   R 数据： iris_tbl 用变音变音版本的 Species 准备
    *   .rnw 文件： 中的变音符号`\title{ }`，`\usepackage[utf8]{inputenc}`

**输出**

> 错误：在“iris_umlaut_tbl_out.tex”上运行“texi2dvi”失败 LaTeX 错误：...Package inputenc 错误：Unicode char \u8:æve 未设置为与 LaTeX 一起使用。

3.  *   R 数据： iris_tbl 用变音变音版本的 Species 准备
    *   .rnw 文件：`umlauts in \title{ }`, `\usepackage[T1]{fontenc}`,`\usepackage[utf8]{inputenc}`

**输出**

> 错误：在“iris_umlaut_tbl_out.tex”上运行“texi2dvi”失败 LaTeX 错误：...Package inputenc 错误：Unicode char \u8:æve 未设置为与 LaTeX 一起使用。

4.  *   R 数据： iris_tbl 用变音变音版本的 Species 准备
    *   .rnw 文件： 中的变音符号`\title{ }`，`\usepackage[T1]{fontenc}`

**输出**

标题中的变音符号不正常，分组变量中的变音符号正常

* * *

谁能指出我正确的方向以在*标题*和*分组*变量中正确编码？非常感谢您抽出宝贵时间。

* * *

## 会话信息

我的 R Studio 0.97.336 中的默认文本编码：UTF-8

```
> sessionInfo()

R version 3.0.0 (2013-04-03)
Platform: x86_64-w64-mingw32/x64 (64-bit)

locale:
[1] LC_COLLATE=Norwegian (Bokmål)_Norway.1252  LC_CTYPE=Norwegian (Bokmål)_Norway.1252   
[3] LC_MONETARY=Norwegian (Bokmål)_Norway.1252 LC_NUMERIC=C                              
[5] LC_TIME=Norwegian (Bokmål)_Norway.1252    

attached base packages:
[1] splines   stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] Hmisc_3.10-1               survival_2.37-4            pastecs_1.3-13             boot_1.3-9                
 [5] pspline_1.0-15             ggplot2_0.9.3.1            lubridate_1.2.0            stringr_0.6.2             
 [9] brew_1.0-6                 knitr_1.1                  xtable_1.7-1               plyr_1.8                  
[13] PerformanceAnalytics_1.1.0 xts_0.9-3                  zoo_1.7-9                  gdata_2.12.0.2            

loaded via a namespace (and not attached):
 [1] cluster_1.14.4     colorspace_1.2-2   dichromat_2.0-0    digest_0.6.3       evaluate_0.4.3     formatR_0.7       
 [7] grid_3.0.0         gtable_0.1.2       gtools_2.7.1       labeling_0.1       lattice_0.20-15    MASS_7.3-26       
[13] memoise_0.1        munsell_0.4        proto_0.3-10       RColorBrewer_1.0-5 reshape2_1.2.2     scales_0.2.3      
[19] tools_3.0.0

> getOption("encoding")

[1] "native.enc" 
```

## 更新：

我非常感谢 brew 包维护者 Jeffrey Horner 的“off-SO”​​输入。在使用 Ubuntu 和命令行 R 运行我的脚本时，他没有遇到编码问题。这给了我一些新的希望。我没有机会自己运行Ubuntu，但是今天我更新了RStudio（0.97.449）并将默认编码设置为ISO8859-1（感谢易辉！）。`\usepackage[latin1]{inputenc}`现在，特殊字符在 .rnw 文件中的标题和分组变量中都已正确编码。也`\usepackage[ansinew]{inputenc}`有效。我不确定我最初的尝试出了什么问题。可能是 RStudio 没有将选项中设置的默认编码应用到我重新打开脚本文件时，我按照 Yihui 的建议更改了这些编码。但这只是一种猜测。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T09:36:21.680

由于您使用`UTF-8`的不是操作系统的本机编码，因此您需要明确告知`knitr`输入文档的编码。例如，您必须调用

```
knit2pdf(brew_out, encoding = "UTF-8") 
```

但我不确定是否`brew`可以处理非本地字符编码。如果没有，我建议您使用系统默认编码（`ISO8859-1`在这种情况下应该是），并且

```
\usepackage[latin9]{inputenc} 
```

或者`knitr`如果您必须使用，请执行所有操作`UTF-8`（这也使您可以单击按钮来编译文档）；有关示例，请参见[075-knit-expand.Rnw](https://github.com/yihui/knitr-examples)。**

# requirejs - 如何将必应地图 API 与 RequireJS 一起使用？

> ID：16173200
> 
> 赞同：3
> 
> 时间：2013-04-23T15:21:13.610
> 
> 标签：requirejs, bing-maps, amd

如何将 Bing Maps API 与最新版本的 RequireJS 一起使用？远程脚本 URL 为：

[http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0](http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0)

我可以像这样添加一个垫片吗？

```
require.config({
    /* ... */
    paths: {
        'Microsoft.Maps': 'http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0'
    },
    shim: {
        'Microsoft.Maps': {
            deps: [],
            exports: 'Microsoft'
        }
    }
}); 
```

然后像这样在我的模块中使用它：

```
define(['Microsoft.Maps'], function(Microsoft) {
    /* ... */
}); 
```

我想我的问题更多是关于如何在 RequireJS 中使用命名空间代码。文档没有涉及我能找到的任何示例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-08T14:32:02.023

事实证明，您可以使用[async](https://github.com/millermedeiros/requirejs-plugins)插件执行此操作，如下所示：

```
define([
    'async!http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0!onscriptload'
], function() {
    // Microsoft and Microsoft.Maps will be available here
}); 
```

该`async!`位告诉 RequireJS 使用`async`插件，并且该`!onscriptload`位告诉它在`onscriptload`URL 参数中发送自动生成的回调名称。当 Bing 加载完所有资产后，它将返回一个 JSONP 响应，该响应调用`async`插件在`onscriptload`参数中提供的任何回调，然后将其转换为异步加载的资源，然后可用于您的模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T20:41:42.893

在查看有关 RequireJS 的文档时，我看到了这一行：

> 不要在构建中混合 CDN 加载和 shim 配置。示例场景：您从 CDN 加载 jQuery，但使用 shim 配置加载依赖于 jQuery 的 Backbone 的库存版本。进行构建时，请确保在构建文件中内联 jQuery，并且不要从 CDN 加载它。否则，Backbone 将内联在构建的文件中，并在加载 CDN 的 jQuery 加载之前执行。这是因为 shim 配置只是延迟加载文件，直到加载依赖项，但不执行任何自动包装定义。构建后，依赖项已经内联，shim 配置不能延迟执行未定义（）的代码，直到以后。定义（）' d 模块在构建后确实与 CDN 加载的代码一起工作，因为它们正确地将其源代码包装在定义工厂函数中，该函数在加载依赖项之前不会执行。所以教训：shim config 是非模块化代码、遗留代码的权宜之计。定义（）的模块更好。

请参阅：[http ://requirejs.org/docs/api.html#config](http://requirejs.org/docs/api.html#config)

Microsoft 正在使用第一个脚本引用（延迟加载）加载多个元素，您应该清楚地避免通过 shim 以另一种方式使用它，因为它更像是 CDN 加载案例。

# android - Wifi Lock - 它会自动打开 WIFI 吗？

> ID：16173203
> 
> 赞同：0
> 
> 时间：2013-04-23T15:21:21.620
> 
> 标签：android, wifi

如果您尝试获取 WIFI 锁，如果 WIFI 已经关闭怎么办？是不是需要检查WIFI的状态，不开就开，然后获取WIFI锁，还是抓WIFI锁的行为会打开WIFI？

您是否有检查 WIFI 状态的源示例，如果关闭则将其打开。

谢谢

# c++ - 无法将 cin 与 back_insert_iterator 连接

> ID：16173205
> 
> 赞同：0
> 
> 时间：2013-04-23T15:21:27.860
> 
> 标签：c++, stl

我正在尝试连接 back_inserter_iterator 和 cin，我知道我可以将 copy 与 cin 和 back_inserter 一起使用，但想知道为什么我不能执行以下操作

```
list<string> name;
back_insert_iterator<list<string>> ins_it(name);

while (cin >> ins_it); 
```

以下是我收到的错误消息：

> 错误：无法将 'std::istream {aka std::basic_istream}' 左值绑定到 'std::basic_istream&&'</p>

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:26:49.810

规范的方法（如果有这样的事情）：

```
list<string> name{
    istream_iterator<string>{cin}, 
    istream_iterator<string>{}}; 
```

或者：

```
list<string> name;
copy(istream_iterator<string>{cin}, istream_iterator<string>{},
    back_inserter(name)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:23:55.687

> 想知道为什么我不能执行以下...

原因在于设计[`std::back_insert_iterator`](http://en.cppreference.com/w/cpp/iterator/back_insert_iterator)。

该类型仅在使用时执行反向插入[`operator =`](http://en.cppreference.com/w/cpp/iterator/back_insert_iterator/operator=)。这就是为什么`std::copy` *有效*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:50:15.787

运算符>>() 不是*插入*运算符，它是*提取*运算符。后插入器对象需要插入，而不是提取。总而言之，没有运算符>>（istream，插入器）。

# jquery - Jquery Ajax 调用适用于 Google Chrome，但不适用于 Firefox

> ID：16173214
> 
> 赞同：1
> 
> 时间：2013-04-23T15:21:46.967
> 
> 标签：jquery, jsonp

嗨伙计们，我正在用 jquery 进行一些测试，特别是 ajax 调用。

```
$('#jsonpbtn').click(function() {
        $('#text').html('AJAX Call executing......');
        $.ajax({
            url : 'http://zip.elevenbasetwo.com/v2/US/10010',
            type : 'GET',
            success : function(data) {
                console.log(data.city);
                $('#jsonparea').html(data.city);
                $('#text').html('Ajax Call ended');
            },
            error : function(xhr, status) {
                alert(status);
            },

        });

    }); 
```

json 响应是 {city: "New York City", state: "New York" ,country: "US"}

用google chrome 一切功能都很好，其实$('#jsonparea').html(data.city) 写的是纽约市的div 区。使用 firefox 我有一些问题，实际上没有写入 div 区域，调用 alert(data.city) 我有未定义的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:24:30.417

为您的 ajax 选项提供 dataType 以确保 jQuery 正确检测到 dataType。

```
$('#jsonpbtn').click(function() {
    $('#text').html('AJAX Call executing......');
    $.ajax({
        url : 'http://zip.elevenbasetwo.com/v2/US/10010',
        type : 'GET',
        dataType: "json", // <---- HERE
        success : function(data) {
            console.log(data.city);
            $('#jsonparea').html(data.city);
            $('#text').html('Ajax Call ended');
        },
        error : function(xhr, status) {
            alert(status);
        },

    });

}); 
```

现在，如果您的 json 与您在上面发布的完全一样，您将收到一个 parseError，因为它不是有效的 JSON，尽管我怀疑它实际上是有效的，因为它在 chrome 中工作。

# c - 使用 Linux POSIX IPC 消息队列

> ID：16173215
> 
> 赞同：2
> 
> 时间：2013-04-23T15:21:47.940
> 
> 标签：c, linux, posix, ipc

我必须创建单个服务器进程 A 和多个客户端进程。都应该使用 Linux POSIX IPC 消息队列进行数据传递。消息将双向流动。也有可能有时多个客户端进程可能已注册到服务器进程 A。

目前我只使用一个命名的消息队列，它由服务器进程 A 创建和打开，并由客户端进程（仅）使用/打开。这适用于两个进程场景（即一个服务器进程 A 和一个客户端进程 B），但不适用于多个客户端进程和一个服务器进程。

我在这里面临的问题是设计/逻辑。我应该如何将服务器进程 A 上的消息从其他客户端进程中解复用，以及从服务器进程 A 的回复应该只发送回各自的客户端进程，或者它可以发送回所有客户端进程，但它必须仅在各自的客户端进程中处理。

例如，我只给出一个场景。假设进程 A 已创建消息队列 X。进程 B 和 C 现在即将启动并打开消息队列 X。现在进程 B 将请求消息发送到消息队列 X，但这里的问题是进程 A 和进程 C 都将通过入队唤醒事件。在这里，进程 C 如何理解 Message 不属于它。

*   IPC 消息大小小于 128 字节。
*   IPc 消息是定义结构，包含整数和字节数组。结构中没有双/浮点数。
*   IPC 消息队列处于 NON_BLOCKING 模式。
*   对高性能没有要求。
*   语言：C
*   编译器：GCC
*   平台/操作系统：Linux
*   IPC 消息队列：仅 POSIX。
*   我不打算使用其他 IPC 机制，如 System V 消息或 Unix 本地套接字或管道等。

如果需要更多详细信息，请告诉我。

请建议我解决这个问题。

仅供参考：我已经在数据库中搜索过，但我找不到类似的问题已经被问到/回答过，所以请确保在将其标记为重复之前。如果您发现类似的问题已经被询问和回答，请提供链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:53:55.870

也许不是您怀疑的答案，但请考虑完全不使用 POSIX IPC。大约 15 年前，我使用 SysV IPC 设计了一个应用程序。这是我最糟糕的设计决定之一。

今天我将使用 TCP/UDP 和适当的协议。除了允许将来将单个组件移动到不同的计算机之外，IP 堆栈被大量使用并得到很好的支持。

使用 TCP，您可以建立良好的 1:1 和个人 1:many 面向连接的通信。使用 UDP，您可以进行 1:1、1:many 和 many:many 非面向连接的通信。您需要关注安全问题，但有很多有用的教程和支持库。

同样对于 TCP/UDP 的可移植性要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:44:37.167

如果我正确理解了场景，那么听起来您将需要多个消息队列。尝试使用单个消息队列在多个进程之间进行双向通信会变成一个复杂的情况。如果没有查看消息的能力，服务器进程甚至很难将特定消息发送到特定客户端。

*   拥有一个消息队列，它是客户端用来建立“私有”消息队列的通用消息队列。想要打开与服务器的通信通道的客户端可以在此队列上向服务器发送消息。也许让客户端发送队列的名称（例如，可能使用进程 ID）以供服务器打开。
*   然后，服务器可以专门为该客户端打开一个新的消息队列以进行双向通信（或者根据使用情况，打开两个队列可能有意义，一个用于客户端和服务器之间的每个方向）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:15:28.700

我在几年前构建了一个像这样的系统，但我真的记不住所有细节，但这个想法是在 msgrcv() 中使用一个参数来指示如何从队列中读取消息。

在服务器只想向一个客户端发送消息时的消息类型（msgbuf.type）中，我使用目标进程的 pid 作为消息的类型。客户端只读取类型等于他的 pid 的消息。

当然，客户端需要在初始化时将他的 pid 发送到服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-09T04:20:41.170

System V 在 msgrcv() 中有一个选项可以从队列中获取特定消息，这样每个客户端都可以读取服务器在单个队列中发布的自己的消息。因此我们可以有一个队列来进行全双工通信。在 POSIX 中没有这样的选项，所以我们必须使用两个单独的队列，一个用于服务器接收来自客户端的所有内容，并且每个客户端都应该有单独的队列来接收 frm 服务器。qid 应该是全局已知的所有进程。

# vb.net - 如何使用 vb.net 在 Web 浏览器中调用单击 div

> ID：16173219
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:21:57.097
> 
> 标签：vb.net

这是我的代码片段 VB.Net 代码：

```
Try
  Dim elements = browser.Document.GetElementsByTagName("div")
  For Each element As HtmlElement In elements
    If element.GetAttribute("className") = "next button" Then                    
      element.Focus()                    
      element.InvokeMember("click")
    End If
  Next
Catch ex As Exception
  MessageBox.Show(ex.Message)
End Try 
```

- 关于这个有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:42:04.573

在客户端尝试这一切：

HTML：

```
<div class="next button" style="float: left;" onclick="scroll()" title="Hold down to scroll through records faster.">»</div> 
```

Javascript：

```
function scroll() {
    //this is your div click event.
} 
```

使用 JQuery 而不是 vanilla Javascript：

```
<div id="divBtn" class="next button" style="float: left;" title="Hold down to scroll through records faster.">»</div> 
```

查询：

```
$('#divBtn').click(function () {
    //this is your div click event.
}); 
```

从服务器端调用 Div 点击事件：

对于这个例子，我使用了 asp.net 的内置 scriptmanager 类，但我知道 AJAX 控制工具包有自己的版本，所以你可以真正使用你喜欢的任何一个，但函数调用和参数可能不同。

拥有脚本管理器后，您将需要知道单击处理程序的名称。我假设您正在为单击处理程序使用 javascript 函数，因为您的 div 上没有`runat="server"`属性。

因此，一旦您分配了 div 的 click 功能并且您的脚本管理器已全部设置好，您将使用该`ScriptManager.RegisterStartupScript`功能。文档可以在[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)找到。

就像是：

```
 ScriptManager.RegisterStartupScript(Me.Page, Me.Page.GetType, "nameOfScript", "DivClickHandler", True) 
```

将告诉您的页面在页面加载时调用 div 点击处理程序。

您在 invokemember 中看到的问题是，当点击处理程序位于客户端（在 javascript 中）或未向服务器注册（因为您的 div 没有`runat="server"`设置属性时，您正在服务器端调用它。所以当你在你的 vb 中调用了 invokemember ，它没有做任何事情，因为就你的服务器而言，处理程序不存在。

# sql-server - 从文本文件创建 SQL Server 表

> ID：16173224
> 
> 赞同：1
> 
> 时间：2013-04-23T15:22:06.973
> 
> 标签：sql-server, sql-server-2008

我需要找到一种方法来从包含我的表结构应该是什么样子的字段定义（大约 100 个或更多）的文本文件中创建一个表。以下是带有大小和描述的字段名称示例：

```
da_ctat 1 样本的进度状态
vc_acct 6 分配的帐户
qc_bact 6 计费帐户 #1
lc_bac2 6 计费帐户 #2 用于拆分
...
...
zc_bar 12 z 代码
pc_wav 1 wai
oc_p1 1 ftp1
tc_df1 1 ftp2
kc_qq 1 ztp
mc_split 1 拆分计费

```

这是上面文字的意思

```
第 1-8 列字符是字段名称
第 9 列空间
第 10-11 列是字段名称的大小
第 12 列空间
第 13 - 80 列是字段注释

```

我需要创建一个存储过程或找到其他方法来创建一个包含上面显示的字段的表。例如，1 个字符长的字段名称 da_ctat 和描述“样本的进度状态”。表中的下一个字段名为 vc_acct，长度为 6 个字符，描述“分配的帐户”等...a

由于我有超过一百个字段要创建，有没有办法编写一个存储过程来创建这个表结构，而我不必手动为表创建字段？

感谢您的协助社区尼克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:19:04.087

可能最直接的方法是创建一个具有固定宽度平面文件的 SSIS 包作为数据源。我会将您的目的地设置为与您的最终表格明显不同的东西（即使用“原始数据”模式，甚至使用名为“原始数据”的单独数据库）。您可以使用此初始映射来创建具有建议数据类型的表（但您确实需要确保您了解您的数据）。

**SSIS**

完成此操作后，您可以在 SSIS 中创建一个 ForEach 循环容器，该容器遍历具有这些平面文件源和原始目标的特定文件夹。如果这是一次性的，您可以通过将 SQL Server Data Tools 安装到您当前的 Visual Studio 2010 安装（如果有）来完成此操作，或者安装程序将在 VS 2010 Shell 中安装 SSDT（如果您没有它） . 如果这不是一次性的，那么您将需要查看安装 SSIS 的许可，以便将其部署为可以安排定期运行的包。

如果失败了，您可以通过打开 SSMS、右键单击目标数据库、单击任务、导入数据、选择平面文件源、固定宽度目标、映射源来生成表模式（您将经历创建这些列，如果你真的有 > 100），然后生成一个创建表脚本。

但是，如果你真的只有那三列......

```
CREATE TABLE schema rawdata AUTHORIZATION <pick an owner here>;
CREATE TABLE rawdata.rawfields (
    fieldname varchar(8), -- i'm actually unclear here because 
                          -- the next column's name/purpose is unclear
    fieldsize int, -- or other numeric datatype 
    fieldcomment varchar(255)
); 
```

然后，您可以编写一个快速的 C# 或 PowerShell 脚本来迭代包含文件的目录。这看起来像：

**C＃**

```
string fieldname, fieldsize, fieldcomments;            
var files = System.IO.Directory.GetFiles("path", "*.ext");
foreach (var file in files)
{
    var lines = System.IO.File.ReadAllLines(file);
    foreach (var line in lines)
    {
        fieldname = line.Substring(0, 8);
        fieldsize = line.Substring(9, 1);
        fieldcomments = line.Substring(10, 73);
    }
} 
```

从这里开始，我将建立与 SQL Server 实例的连接，创建参数化插入命令并将数据插入变量中。

**批量插入**

创建格式文件：

```
<?xml version="1.0"?>
<BCPFORMAT
       xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <RECORD>
    <FIELD ID="1" xsi:type="CharFixed" LENGTH="8"/>
    <FIELD ID="2" xsi:type="CharFixed" LENGTH="2"/>
    <FIELD ID="3" xsi:type="CharFixed" LENGTH="68"/>
    <FIELD ID="4" xsi:type="CharTerm" TERMINATOR="\r\n"
  </RECORD>
  <ROW>
    <COLUMN SOURCE="1" NAME="fieldname" xsi:type="SQLCHAR" />
    <COLUMN SOURCE="2" NAME="fieldlength" xsi:type="SQLCHAR" />
    <COLUMN SOURCE="3" NAME="fieldcomments" xsi:type="SQLCHAR" />
  </ROW>
</BCPFORMAT> 
```

然后您可以编写 PowerShell 脚本或 C# 应用程序来迭代目录中的文件（如上）并调用（假设您可以获得受信任的连接）

```
bcp <<yourdatabase>>.rawdata.rawfiles in \\path\to\data\file.ext 
         -f \\path\to\format\file.Xml -T 
```

否则

```
bcp <<yourdatabase>>.rawdata.rawfiles in \\path\to\data\file.ext 
         -f \\path\to\format\file.Xml -U username -P password 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:33:31.230

这是一次性的工作，还是需要自动化的东西？

有一次，我会使用 excel 和大量的连接。100 行的手格式真的不多。

重复一遍，我会用你选择的脚本语言预处理这个文件，将它变成一个标准的 SQL 脚本。我的选择是 powershell，因为它很容易与 sql server 集成。

定义文件似乎不完整，因为没有指明字段类型。它们都是整数、浮点数、varchar 吗？

# spring - JdbcTemplate 理解

> ID：16173225
> 
> 赞同：2
> 
> 时间：2013-04-23T15:22:10.993
> 
> 标签：spring, jdbc, database-connection, datasource, connection-pooling

这是我最近遇到的一些事情。

我对 Spring 的 JdbcTemplate 的理解是可以调用：

```
JdbcTemplate template = new JdbcTemplate(dataSource);
Connection conn = template.getDataSource().getConnection(); 
```

它使用传入的数据源返回来自 JdbcTemplate 的连接。如果我这样做：

```
template.getDataSource().getConnection().close(); 
```

这只是获得另一个连接并关闭它，创建一个泄漏的资源，还是它让你得到它正在使用的连接？

编辑：

我在一个类中编写了 2 种方法，一种是编写 JDBC 语句的老式低级方法（使用连接、语句和结果集）：

```
public void execute(String tableName) {
    try {
        Class.forName("com.ibm.as400.access.AS400JDBCDriver");
        Connection con = DriverManager.getConnection("jdbc:as400://viper", "******", "******"); 
        Statement select = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);

        ResultSet rs = select.executeQuery ("SELECT * FROM ******." + tableName );
        logger.info("start clearing: " + tableName);

        while (rs.next ()) {
            rs.deleteRow();
        }
        logger.info("Step1 done clearing: " + tableName);

        ConnectionRecycler.recycleConnection(select, true, con);

        execute2(tableName);
    } catch (Exception eX) {
        logger.error(eX);
    }
} 
```

另一种方法：

```
public void execute2(String tableName) {

    String nameOS = System.getProperty("os.name");
    String sql = (nameOS.equals("OS/400")) ? "DELETE from " + tableName : 
        "DELETE from " + tableName + " with none";

    JdbcTemplate templateSNPJ;

    templateSNPJ = new JdbcTemplate(this.snpjDataSource);
    templateSNPJ.update(sql);

    logger.info("Finished clearing: " + tableName);
    getServiceManager().unregisterService(this);
} 
```

我以这种方式正确清理了资源。第二种方法是使用：

```
JdbcTemplate.update(sqlCommand); 
```

但似乎 JdbcTemplate 使连接保持活动的时间比配置池的时间长。

我在 SO： [Database connection management in Spring](https://stackoverflow.com/questions/2249993/database-connection-management-in-spring)上阅读了这篇文章，它避免了必须使用带有在 bean 中定义的 destroy-method=close 参数的 dataSource 配置，如下所示：

```
 <bean id="SnpjDataSource" class="com.atomikos.jdbc.nonxa.AtomikosNonXADataSourceBean" destroy-method="close">
      <property name="uniqueResourceName" value="@#$$datasource"/>
      <property name="driverClassName" value="com.ibm.as400.access.AS400JDBCDriver"/>
      <property name="url" value="jdbc:as400://VIPER/******"/>
      <property name="user" value="FuManChu"/>
      <property name="password" value="*%$@^%$*#^$@^$@"/>
      <property name="maxPoolSize" value="10"/>
      <property name="reapTimeout" value="40"/>
    </bean> 
```

编辑2：

ConnectionRecycler.recycleConnection 方法：

```
public static void recycleConnection(Statement state, boolean closeConnection, 
        Connection connect) {
    try {
        state.close();
        if (closeConnection) {
            connect.close();
        }
    } catch (SQLException sqlEx) {
        logger.error("Error closing resources!  ", sqlEx);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:30:22.690

这取决于您的数据源。如果您想确定使用相同的连接，请在`#getConnection`调用中保留对它的句柄或使用[SingleConnectionDataSource](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/jdbc/datasource/SingleConnectionDataSource.html)。请注意，您必须在线程安全的环境中操作才能使用此数据源。它本身不是线程安全的。

此外，您实际上不需要`Connection`直接访问。这就是`JdbcTemplate`. 它隐藏了 JDBC 内部......避免了泄漏连接等的风险。

# c# - 如何添加标签和文本框来填充水平面板？

> ID：16173227
> 
> 赞同：2
> 
> 时间：2013-04-23T15:22:12.110
> 
> 标签：c#, winforms

我已经设置了一些拆分容器和一个大约为文本框和标签高度的面板。我希望标签位于文本框的左侧，文本框的宽度基本上到面板的边缘（如向右拉伸）。

有没有一种简单的方法可以使用 flowlayoutpanel 或 tablepanel 或其他东西来做到这一点。我以编程方式添加控件（不使用表单编辑器）。

理想情况下，如果面板增长，文本框应该拉伸。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:27:43.000

您可能想要做的是根据面板尺寸计算标签和文本框的宽度和高度。

对于位置，您可能只需要给他们一个硬编码的起始位置，但同样，这可能基于一些计算。

如果它们被放置在 tablelayoutpanel 内的面板中，那么如果表单/容器控制器增长，它们应该自动调整自己的大小，但要确保您可以使用锚属性来确保这一点。

例如，将面板停靠在 tablelayoutpanel 单元格中以填充模式，然后假设您在左侧有标签，在右侧有文本框，将标签锚定在左侧，文本框在右侧。这应该确保控件的这些边缘粘在这些侧面的面板上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:35:50.623

当您偏离*表单设计器视图*时，您的代码将更加具体。当您使用设计器时，您可以通过拖放来实现这样的事情。但是为了在代码中做这样的事情，你会做一些事情，比如：

```
private void InitializeComponent()
    {
        this.panel1 = new System.Windows.Forms.Panel();
        this.label1 = new System.Windows.Forms.Label();
        this.textBox1 = new System.Windows.Forms.TextBox();
        this.panel1.SuspendLayout();
        this.SuspendLayout();
        // 
        // panel1
        // 
        this.panel1.Controls.Add(this.textBox1);
        this.panel1.Controls.Add(this.label1);
        this.panel1.Location = new System.Drawing.Point(12, 12);
        this.panel1.Name = "panel1";
        this.panel1.Size = new System.Drawing.Size(400, 358);
        this.panel1.TabIndex = 0;
        this.panel1.Paint += new System.Windows.Forms.PaintEventHandler(this.panel1_Paint);
        // 
        // label1
        // 
        this.label1.AutoSize = true;
        this.label1.Dock = System.Windows.Forms.DockStyle.Left;
        this.label1.Location = new System.Drawing.Point(0, 0);
        this.label1.Name = "label1";
        this.label1.Size = new System.Drawing.Size(35, 13);
        this.label1.TabIndex = 0;
        this.label1.Text = "label1";
        // 
        // textBox1
        // 
        this.textBox1.Dock = System.Windows.Forms.DockStyle.Right;
        this.textBox1.Location = new System.Drawing.Point(47, 0);
        this.textBox1.Name = "textBox1";
        this.textBox1.Size = new System.Drawing.Size(353, 20);
        this.textBox1.TabIndex = 1;
        this.textBox1.TextChanged += new System.EventHandler(this.textBox1_TextChanged);
        // 
        // Form1
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(424, 382);
        this.Controls.Add(this.panel1);
        this.Name = "Form1";
        this.Text = "Form1";
        this.Load += new System.EventHandler(this.Form1_Load);
        this.panel1.ResumeLayout(false);
        this.panel1.PerformLayout();
        this.ResumeLayout(false);

    } 
```

正如您在运行时看到的那样，组件已初始化；然后为所有属性分配适当的定位。您标记相对于*Form*和*Panel*的布局。通过定义点，您可以确保它们集中。

这应该让你开始；但绝不会是理想的。您可能需要对此类项目进行不同的配置，以确保它符合您的标准。但是使用 440 x 420 像素的*表单*。面板还停靠在整个布局的半英寸范围内。您的文本框和标签固定在屏幕的左上方和右上方。

请记住，如果您最大化此布局，它可能会以不利的方式调整设计，除非它们被锁定到这些特定位置。希望这会有所帮助。

# postgresql - OpenERP HR考勤影响表

> ID：16173235
> 
> 赞同：0
> 
> 时间：2013-04-23T15:22:39.963
> 
> 标签：postgresql, openerp

我想知道OpenERP ver 7中哪个表用来保存考勤和请假记录。我发现resource_resource表，res_users和hr_employee表是用来保存员工记录的。但是哪一个用来保存以上记录。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:28:05.700

```
select
h.id as employee_id,h.name as leave_reason,
e.resource_id,e.name_related,s.name,r.id as resource,r.name as res_name
from 
hr_holidays h,hr_employee e,hr_holidays_status s,
resource_resource r
where 
h.employee_id=e.id and 
h.holiday_status_id=s.id and
e.resource_id=r.id 
```

# php - PHP < 5.3，创建函数和使用变量

> ID：16173236
> 
> 赞同：5
> 
> 时间：2013-04-23T15:22:41.673
> 
> 标签：php

我正在尝试将一些 PHP 5.3 代码转换为 PHP 5.2（不支持匿名函数）。这是 PHP 5.3 代码：

```
$nr = 2;
$a = array(1,2,3,4,5,6,7,8,9,10);
$a = array_filter($a,function($e) use($nr) {
    return $e % $nr == 0;
}); 
```

我的转换是这样的：

```
array_filter($a,create_function('$e','return $e % $nr == 0;')); 
```

应该`use($nr)`放在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-05-25T11:04:33.847

### 选项 1：全球访问

`global`实际上会正常工作：[![代码链接](https://i.stack.imgur.com/hF2GB.png)](http://3v4l.org/YdeMv)

```
<?php
$nr = 2;
$a = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
$a = array_filter($a, create_function('$e', '
    global $nr;
    return $e % $nr == 0;
'));
var_dump($a); 
```

这有效地为我们提供了“JavaScript 风格”的访问权限，其中只有一个变量副本，对该变量的任何写入都将在其他任何地方看到：

```
<script> // javascript code:
var a = 1;
(function(){
    a = 2; 
})();
console.log(a); // javascript shows 2
</script> 
```

但是，请注意，“JavaScript 样式”访问提供的功能**与 不同**，`use`因为[`use`在定义函数时会复制值](https://stackoverflow.com/a/10304027/632951)。这意味着 via`use`有多个变量副本，修改一个不会影响另一个：

```
<?php
$a = 1;
call_user_func(function()use($a){
    $a = 2;
});
var_dump($a); // php shows 1 
```

为了实现这个功能（这样我们可以做一个“完美的垫片”），你**必须确保你没有**给全局变量分配新的值。如果您需要为变量分配新值，

如果您需要修改原始值，您可能需要先创建它的副本，然后将该副本全球化。这样，您的原始值不受限制并且可以修改：[![代码链接](https://i.stack.imgur.com/hF2GB.png)](http://3v4l.org/p0qYL)

```
<?php
$nr = 2;
$nr_copy = 2;
$a = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
$nr = 3; // you can freely modify $nr because the function below is using $nr_copy
$a = array_filter($a, create_function('$e', '
    global $nr_copy;
    return $e % $nr_copy == 0;
'));
var_dump($a); 
```

* * *

请注意，`global`如果您需要引用的变量在函数的范围内，则选项 1 ( ) 不起作用：

```
<?php
some_function();
function some_function(){
    $nr = 2;
    $a = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
    $a = array_filter($a, create_function('$e', '
        global $nr; // this will not work because $nr is undefined
        return $e % $nr == 0;
    '));
    var_dump($a);
} 
```

对于这种情况，您别无选择，只能使用选项 2。

* * *

### 选项 2：串联

您可以将值直接叠加到函数的定义中：[![代码链接](https://i.stack.imgur.com/hF2GB.png)](http://3v4l.org/8binh)

```
<?php
some_function();
function some_function(){
    $nr = 2;
    $a = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
    $a = array_filter($a, create_function('$e', '
        return $e % '.$nr.' == 0;
    '));
    var_dump($a);
} 
```

在简单连接不起作用的情况下（例如对于数组和对象），唯一的选择是序列化：[![代码链接](https://i.stack.imgur.com/hF2GB.png)](http://3v4l.org/kLrYc)

```
<?php
some_function();
function some_function(){
    $nr = 2;
    $a = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
    $a = array_filter($a, create_function('$e', '
        return $e % unserialize(\''.str_replace("'", "\'", serialize($nr)).'\') == 0;
    '));
    var_dump($a);
} 
```

这个想法只是将变量转换为可以插入到函数体中的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:25:36.957

PHP 5.2 不支持闭包。因此，您不能使用`use`关键字。

如果您需要您的代码与 5.2 兼容，最好只创建一个命名函数/方法并传入必要的参数，而不是使用`create_function`后者会导致内存泄漏（每次都会创建新函数并且 gc 不会捕获商场）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-14T20:51:42.253

您可以使用序列化/反序列化，如：

```
create_function('$e','return $e % unserialize(\''.serialize($nr).'\') == 0;') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:26:44.627

你可以`global`这样使用：

```
create_function('$e','global $nr; return $e % $nr == 0;') 
```

但是，您确实应该升级 PHP，而不是担心降级：p

# javascript - 未捕获的引用错误。在 jQuery 事件处理程序中找不到原型函数

> ID：16173244
> 
> 赞同：1
> 
> 时间：2013-04-23T15:22:54.787
> 
> 标签：javascript, jquery, html

按下提交按钮时出现以下错误：

```
Uncaught ReferenceError: addText is not defined 
```

*   为什么'click'处理函数找不到类原型函数'addText'？

*   我能做些什么来解决这个问题？

*   如果这是处理事件的不好方法？（我来自 java 背景，我有点不确定面向对象 javascript 的最佳实践）

这是代码：

```
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script src="js/jquery-1.9.1.js"></script>
    <script>
        //Class ctor
        function MyClass() {
            this.msg = "Hello World!";
        }
        //This method appends text to the given doc element
        MyClass.prototype.addText = function(doc) {
            $(doc).append('<br/>'+this.msg);
        };
       /*
        * This method adds a 'click' listener to the given element which 
        * calls the 'addText' method on its parent.
        */
        MyClass.prototype.listenToButton = function(btn) {
            $(btn).bind({
                click: function(event) {
                    addText($(this).parent());
                }
            });
        };

        $(document).ready(function() {
            //Create instance of class
            var c = new MyClass();
            //Listen to button
            c.listenToButton($("#mybutton"));
        });
    </script>
</head>
<body>
    <div>Button: <input id="mybutton" type="button" value="Submit"></div>
</body> 
```

显然我正在使用 jQuery。提前致谢！

**编辑**

这是我学到的：

*   “click”处理函数找不到函数“addText”，因为“this”不再引用类实例，而是事件的发送者。

*   为了解决这个问题，我应该将当前的“this”范围保存在处理函数之外的变量中。

*   我不确定以这种方式处理事件是否是不好的做法，但它有效，所以我会接受它。

*   另外，我应该使用“on”而不是“bind”，因为无论如何，“bind”似乎都调用了“on”。

感谢大家的快速回复！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:26:22.547

试试这个：

```
MyClass.prototype.listenToButton = function(btn) {
        var that = this;
        $(btn).bind({
            click: function(event) {
                that.addText($(this).parent());
            }
        });
    }; 
```

# php - 用 JS 下载一个用 PHP 创建的 ZIP 文件

> ID：16173246
> 
> 赞同：2
> 
> 时间：2013-04-23T15:23:00.910
> 
> 标签：php, javascript, ajax, zip

我想下载一个通过 PHP 方法创建的 zip 文件。当用户单击“下载”图标时，会创建 zip 并自动下载。

zip 创建工作正常。PHP 方法的结尾是这样的：

```
 header("Content-disposition: attachment;filename=\"archive.zip\"");
    header('Content-Type: application/zip');
    header('Content-Length: ' . filesize($path_archive));
    readfile($path_archive);
    return; 
```

这是我的 JS 文件中的 AJAX 方法。*我的函数需要路径*来创建存档。

```
 $.ajax({
        url: "url_of_PHP_method",
        data : { path : path },
        type: 'GET',
        success: function (data) { 
            var uriContent = "data:application/zip;" + data;
            var myWindow = window.open(uriContent, "archive.zip");
            myWindow.focus();
        }
    }); 
```

不幸的是，下载的文件被称为“下载”。它没有扩展名，即使我用 .zip 扩展名重命名它，打开它也会出错：

```
End-of-central-directory signature not found. 
```

哈你们遇到同样的问题吗？我在这个网站上发现了类似的问题，但没有人面临同样的情况。提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:28:45.427

由于安全问题，无法使用 Ajax 下载文件。您可以创建一个指向执行该操作的 php 脚本的常规超链接，并且浏览器将显示保存下载对话框，而无需离开您所在的当前页面。

**示例代码：**

```
<script type="text/javascript">
location.href = "url_of_PHP_method";
</script> 
```

# c# - 未创建 Log4net 日志文件？

> ID：16173248
> 
> 赞同：2
> 
> 时间：2013-04-23T15:23:18.427
> 
> 标签：c#, vsto, log4net

我们在 Outlook 加载项应用程序中使用 log4net，它运行良好。我们使用的是 VSTO 2010（它支持 Outlook 2007 和 2010）。

> 出于某种原因，我们更新了系统中的 VSTO 版本（它支持 Outlook 2007、2010 和 2013）。之后，我们的系统中不会创建日志文件。不知道是什么问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-22T13:08:16.153

最后我得到了我的问题的解决方案。

我们需要在声明 log4net 时指定配置文件名。

例如：

> [程序集：log4net.Config.DOMConfigurator(ConfigFile = "[ProjectName].dll.config", Watch = true)]

# javascript - 正则表达式仅替换某些逗号

> ID：16173253
> 
> 赞同：4
> 
> 时间：2013-04-23T15:23:23.590
> 
> 标签：javascript

我需要一个正则表达式来替换逗号在两个没有空格的字符之间。

文字：荷马、辛普森、杰克、丹尼尔斯、尼克、凯奇

期望的结果：本垒打、辛普森-杰克、丹尼尔斯-尼克、凯奇

这是我能想到的，但它取代了字母和逗号

```
/[a-zA-z],[a-zA-z]/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:25:50.693

```
"HOMER, Simpson,JACK, Daniels,NICK, Cage".replace(/(,(?!\s))/g, ' - '); 
```

[http://jsfiddle.net/samliew/sQKNN/](http://jsfiddle.net/samliew/sQKNN/)

如果您还需要检查逗号前的前导空格，

```
.replace(/((?!\s),(?!\s))/g, ' - ')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:30:22.453

在正则表达式中，[`\S`](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions#special-non-white-space)表示所有非空格字符。

```
var input  = "HOMER, Simpson,JACK, Daniels,NICK, Cage";

var output = input.replace(/(\S),(\S)/g, '$1 - $2'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:35:57.897

这并不难实现。

*   字符类代表`\S`所有非空白字符。
*   您可以使用括号`()`来捕获一个*组*。在替换字符串中，您可以使用`$0`（代表整个匹配）、`$1`（代表第一个组）、`$2`等来引用每个捕获的组`$3`，代表后续组。

以下代码执行您想要的操作：

```
var input = "HOMER, Simpson,JACK, Daniels,NICK, Cage"
,   output = input.replace(/(\S),(\S)/g, '$1 - $2'); 
```

请注意，since`\s`等价于`[ \t\r\n]`（即以下任何字符：空格、制表符、CR [回车]、LF [换行符]），并且`\S`是 的倒数`\s`，`\S`也不会匹配制表符或换行符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:33:09.217

尝试

```
'HOMER, Simpson,JACK, Daniels,NICK, Cage'.replace(/([^\s]),([^\s])/gi, '$1 - $2'); 
```

# zend-framework - 使用 phpunit 和 Zend Framework 选择 db 时出错

> ID：16173254
> 
> 赞同：0
> 
> 时间：2013-04-23T15:23:24.163
> 
> 标签：zend-framework, phpunit

我想在 ZF 项目中使用单元测试，所以我创建了测试类，但这里是错误：

> 致命错误：在 ...\CardMapper.php 中的非对象上调用成员函数 select()

相关线路是：

```
$this->db = Zend_Db_Table_Abstract::getDefaultAdapter();

$select = $this->db->select()->from(array('c' => 'cards')); 
```

当我使用浏览器时没有问题。

这是我的 phpunit.xml（来自另一个没有数据库的 zf 项目）：

```
<phpunit bootstrap="./bootstrap.php">
    <testsuite name="Application Test Suite">
        <directory>./application</directory>
    </testsuite>
    <testsuite name="Library Test Suite">
        <directory>./library</directory>
    </testsuite>

    <filter>
        <whitelist>
            <directory suffix=".php">../../library/Zend</directory>
        </whitelist>
    </filter>
</phpunit> 
```

bootstrap.php：

```
<?php

// Define path to application directory
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));

// Define application environment
defined('APPLICATION_ENV')
    || define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'testing'));

// Ensure library/ is on include_path
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path(),
)));

require_once 'Zend/Loader/Autoloader.php';
Zend_Loader_Autoloader::getInstance(); 
```

和测试类：

```
<?php

class CardControllerTest extends Zend_Test_PHPUnit_ControllerTestCase
{

    public function setUp()
    {
        $this->bootstrap = new Zend_Application(APPLICATION_ENV, APPLICATION_PATH . '/configs/application.ini');
        parent::setUp();
    }

    public function testList()
    {
        $this->dispatch('/card');
    }
} 
```

我尝试了很多东西，但都没有真正奏效。一些代码将错误更改为“未找到默认模块”。

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T08:22:37.510

好的，我发现了问题：

在 application.ini 中，我只放置了开发环境的数据库配置，而单元测试仍在使用测试环境配置。

所以问题解决了！

# combobox - 向 LightSwitch 组合框添加新行

> ID：16173256
> 
> 赞同：0
> 
> 时间：2013-04-23T15:23:30.043
> 
> 标签：combobox, visual-studio-lightswitch, screens

我在使用 LightSwitch（VS 2012 版本，Silverlight 客户端）屏幕设计时遇到问题。我有以下数据模型：

*   `Agent`桌子
*   `Training`桌子
*   `Participant``Training`与and具有一对多关系的表`Agent`

我已经为创建`Training`s 创建了新屏幕。屏幕布局包含参与者部分，我可以添加参与者并选择适当的关系，前提是表中`Agent`已经存在相应的行。`Agent`但我也希望有一个选项，可以即时创建新代理。因此，如果用户尝试输入不存在的代理，他将能够输入有关代理的新信息并在参与者部分选择他。

有办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T13:32:11.163

这是一个长期存在的问题，没有开箱即用的内置方法来处理它。它必须针对您希望能够添加记录的每个 ACB（自动完成框）进行编码。

这篇博文将向您展示实现它的方法。

[LightSwitch – 使用 AutoCompleteBox 添加不存在的记录](http://dotnettim.wordpress.com/2011/04/20/lightswitch-add-non-existent-records-using-autocompletebox/)

# ninject - Ninject solrnet 绑定疑惑

> ID：16173257
> 
> 赞同：0
> 
> 时间：2013-04-23T15:23:39.933
> 
> 标签：ninject, solrnet

我在我的项目中使用 Ninject 进行 DI。我正在将 solrnet 用于搜索功能，并且正在尝试将 Solr 合并到 Ninject。下面是我在**Global.asax中添加的代码**

```
 protected override IKernel CreateKernel()
    {
        return new StandardKernel(new ServiceModule(), new SolrNetModule(ConfigurationManager.AppSettings["SearchServer"]));
    } 
```

**SolrnetModule.cs**

```
public class SolrNetModule : NinjectModule 
{
    private readonly string serverURL;
    public IReadOnlyMappingManager Mapper { get; set; }

    public SolrNetModule(string serverURL)
    {
        this.serverURL = serverURL;
    }

    public override void Load()
    {
        var mapper = Mapper ?? new MemoizingMappingManager(new AttributesMappingManager());
        Bind<IReadOnlyMappingManager>().ToConstant(mapper);
        Bind<ISolrConnection>().ToConstant(new SolrConnection(serverURL));
        Bind(typeof(ISolrQueryResultParser<SolrSku>)).To(typeof(SolrQueryResultParser<SolrSku>));
        Bind(typeof(ISolrQueryExecuter<SolrSku>)).To(typeof(SolrQueryExecuter<SolrSku>));
        Bind(typeof(ISolrDocumentSerializer<SolrSku>)).To(typeof(SolrDocumentSerializer<SolrSku>));
        Bind(typeof(ISolrBasicOperations<SolrSku>)).To(typeof(SolrBasicServer<SolrSku>));
        Bind(typeof(ISolrOperations<SolrSku>)).To(typeof(SolrServer<SolrSku>));
        Bind(typeof(ISolrReadOnlyOperations<SolrSku>)).To(typeof(SolrServer<SolrSku>));
        Bind<ISolrService>().To<SolrService>();
    }
} 
```

**Solrservice.cs**

```
 public class SolrService : ISolrService
 {
    public readonly ISolrReadOnlyOperations<SolrSku> _solr;     

    public SolrService(ISolrReadOnlyOperations<SolrSku> solr)
    {
        _solr = solr;
    }

    public ISolrQueryResults<SolrSku> SearchAll(string query)
    {
        var qopts = BuildParameters();
        var results = _solr.Query(query, qopts);
        return results;
    }

    private QueryOptions BuildParameters()
    {
        var qopts = new QueryOptions();
        qopts.AddOrder(new SortOrder("dateAdded", Order.DESC));
        return qopts;
    }
 } 
```

运行应用程序时，我收到以下错误“激活 IsolrQuerySerializer 时出错

没有匹配的绑定可用，并且该类型不可自绑定。”

我在这里遗漏了什么或者我试图在 NInject 中使用 Solr 的方式是错误的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:06:41.987

由于您使用的是自定义 SolrNetModule 类，因此您似乎没有在 SolrNet 堆栈中连接所有必需的依赖项以使一切正常运行。我建议使用[SolrNet](https://github.com/mausch/SolrNet/blob/master/Ninject.Integration.SolrNet/SolrNetModule.cs)提供的 SolrNetModule。您可以从[源代码](https://github.com/mausch/SolrNet/)或通过[NuGet](http://nuget.org/packages/SolrNet.Ninject/0.3.1)获取此信息。或者，如果您仍想使用自己的自定义 NinjectModule，我会参考源中的那个进行比较。

**更新：**这可能是使用 ASP.NET WebForms 使用 Ninject 的最佳示例（我假设您正在使用基于您的代码结构的 ASP.NET WebForms）

*   [如何在 asp.net Web 窗体上实现 Ninject 或 DI？](https://stackoverflow.com/questions/4933695/how-can-i-implement-ninject-or-di-on-asp-net-web-forms)

# javascript - JavaScript 迷宫求解算法

> ID：16173259
> 
> 赞同：15
> 
> 时间：2013-04-23T15:23:44.273
> 
> 标签：javascript, html, maze

**HTML**

```
<div id="labirinth">
    <form style="text-align:center" name="forma1" autocomplete="on">
        <table style="margin:0 auto;">
            <tr>
                <td style="float:right;">Height:</td>
                <td><input type="text" id="height" name="height" autofocus="autofocus" maxlength="2" size="6" /></td>
            </tr>
            <tr>
                <td style="float:right;">Width:</td>
                <td><input type="text" id="width" name="width"  maxlength="2" size="6" /></td>
            </tr>
        </table>
    </form>
    <input type="button" alt="submit" onClick="datas();" value="New" style="margin-top:10px;" />
</div>
<pre id="out"></pre> 
```

**JavaScript**

```
function datas() {

    var height = parseInt(document.getElementById("height").value);
    var width = parseInt(document.getElementById("width").value);

    document.getElementById('out').innerHTML = display(maze(height,width));
}

function maze(x,y) {
    var n=x*y-1;
    if (n<0) {alert("Bad numbers!");return;}
    var horiz=[]; 
        for (var j= 0; j<x+1; j++) horiz[j]= [];
    var verti=[]; 
        for (var j= 0; j<y+1; j++) verti[j]= [];

    var here= [Math.floor(Math.random()*x), Math.floor(Math.random()*y)];
    var path= [here];
    var unvisited= [];
    for (var j= 0; j<x+2; j++) {
        unvisited[j]= [];
        for (var k= 0; k<y+1; k++)
            unvisited[j].push(j>0 && j<x+1 && k>0 && (j != here[0]+1 || k != here[1]+1));
    }
    while (0<n) {
        var potential= [[here[0]+1, here[1]], [here[0],here[1]+1],
            [here[0]-1, here[1]], [here[0],here[1]-1]];
        var neighbors= [];
        for (var j= 0; j < 4; j++)
            if (unvisited[potential[j][0]+1][potential[j][1]+1])
                neighbors.push(potential[j]);
        if (neighbors.length) {
            n= n-1;
            next= neighbors[Math.floor(Math.random()*neighbors.length)];
            unvisited[next[0]+1][next[1]+1]= false;
            if (next[0] == here[0])
                horiz[next[0]][(next[1]+here[1]-1)/2]= true;
            else 
                verti[(next[0]+here[0]-1)/2][next[1]]= true;
            path.push(here= next);
        } else 
            here= path.pop();
    }
    return ({x: x, y: y, horiz: horiz, verti: verti});
}

function display(m) {
    var text= [];
    for (var j= 0; j<m.x*2+1; j++) {
        var line= [];
        if (0 == j%2)
            for (var k=0; k<m.y*4+1; k++)
                if (0 == k%4) 
                    line[k]= 'X';
                else
                    if (j>0 && m.verti[j/2-1][Math.floor(k/4)])
                        line[k]= ' ';
                    else
                        line[k]= 'X';
        else
            for (var k=0; k<m.y*4+1; k++)
                if (0 == k%4)
                    if (k>0 && m.horiz[(j-1)/2][k/4-1])
                        line[k]= ' ';
                    else
                        line[k]= 'X';
                else
                    line[k]= ' ';
        if (0 == j) line[1]=line[3]=' ',line[2]= '1';
        if (m.x*2-1 == j) line[4*m.y]= '2';
        text.push(line.join('')+'\r\n');

    }
    return text.join('');
} 
```

我正在尝试在不使用 HTML 表格单元格的情况下在 JavaScript 中创建完全正常工作的迷宫生成器。现在我对这个迷宫的创建求解器有问题。

**问题**：我的代码需要使用哪种迷宫解决算法？我应该从什么开始？我不需要整个算法——我只需要关于是否有可能在这个迷宫生成器中有一个迷宫求解器的建议。

JSbin - [http://jsbin.com/uwoyon/1](http://jsbin.com/uwoyon/1)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-10-04T10:05:58.190

我对适用于您正在生成的迷宫的求解器的建议是 Dijkstra 算法。虽然我不确定 horiz 和 verti 参数如何定义迷宫结构，但 Dijkstra 的算法可以通过从“1”旁边的单元格开始并从那里开始构建来适应您的情况。

它的操作方式是用每个单元格与起始单元格之间的单元格数量来标记每个单元格。对于 3x3 迷宫，第一个单元格将是：

```
x 1 xxxxxxxxx
x 1         x
x   xxxxxxxxx
x           x
x   xxxxxxxxx
x           2
xxxxxxxxxxxxx 
```

从标记的单元格检查是否有一个空的相邻单元格（一个没有被墙挡住的单元格），将单元格值增加 1。对所有空单元格重复此过程：

```
x 1 xxxxxxxxx
x 1   2   3 x
x   xxxxxxxxx
x 2   3   4 x
x   xxxxxxxxx
x 3   4   5 2
xxxxxxxxxxxxx 
```

现在从与结尾“2”相邻的单元格向后工作。这说明解的路径长度为 5 步，所以从 5 开始，找到相邻的 4，然后是 3，以此类推回到 1。

注意：我推荐使用队列来标记单元格的递归解决方案：

1- 用“1”标记第一个单元并将其放入队列中。

2- 从队列中取出单元： - 检查合法邻居（未被墙壁阻挡的邻居）是否未标记。- 如果相邻单元格未标记，则将其标记为当前单元格+1。- 将相邻单元格添加到队列中。- 对所有 4 个潜在邻居重复

3- 重复步骤 1 和 2，直到没有更多未标记的细胞。

**编辑**：这是使用我建议的求解器的[小提琴](http://jsfiddle.net/5g7se8qL/7/)，它与问题中的迷宫生成器无关，所以除非被问到，否则我不会详细介绍它是如何操作的（它有点粗糙，但它的实现应该很容易理解）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T14:59:03.347

如果它是一个完美的迷宫（任何两个单元之间只有一条路径），那么你只需要一个递归的墙跟随器。从第一个单元格开始，按给定顺序检查所有周围的单元格，通常是顺时针或逆时针。如果单元格可以输入，请输入它。如果它是结束，你就完成了。如果不是，递归。当您检查了所有其他 3 条路径并且没有一条是结束时，只需返回。当你到达终点时，你的调用堆栈就有了解决方案:) 我通常做的是为“我在这里没有找到解决方案”返回“false”，或者为“这是解决方案”返回“true”。

您可以在 github 上查看我的迷宫算法是如何解决的：

[https://github.com/mdchaney/jsmaze](https://github.com/mdchaney/jsmaze)

如果您查看 jsmaze2.html，函数“find_depth”实际上是一个求解器。

jsmaze4.html 要复杂得多，但它实际上是在使用递归算法构建迷宫的同时构建解决方案。它通过在构建过程中“进入”单元格时跟踪哪个墙被击倒来做到这一点。由于还有其他算法，我还包括了“find_depth”，它为任何迷宫设置了入口墙。

这足以让你开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-06T17:06:41.083

非递归方式将为您解决迷宫。使用递归（回溯算法），您可能会碰运气。

请参阅本文档：- [http://cs.stanford.edu/people/eroberts/courses/cs106b/chapters/07-backtracking-algorithms.pdf](http://cs.stanford.edu/people/eroberts/courses/cs106b/chapters/07-backtracking-algorithms.pdf)

如果这个问题会一直开放到周末。我会发布一个编码的答案。

谢谢

# jquery - google chrome 和 jquery ui：可拖动对象正在远离鼠标光标

> ID：16173265
> 
> 赞同：2
> 
> 时间：2013-04-23T15:24:02.637
> 
> 标签：jquery, jquery-ui, google-chrome, draggable

此问题仅在 Google Chrome 中出现：

这是一个带有可拖动 div 的简单小提琴：http: [//jsfiddle.net/8kPXf/](http://jsfiddle.net/8kPXf/)

```
<div id="drag"></div>

$(document).ready(function () {
    $("#drag").draggable();
}); 
```

当你拖动它比如说 3 次时，**可拖动的 div 似乎从光标移开**。

还有另一个小提琴不会发生这种效果：http: [//jsfiddle.net/uBPs8/](http://jsfiddle.net/uBPs8/)

```
<div id='container'>
     <h3 class='title' id='titlebar'>My Title</h3>
</div>

$("#container").draggable({
        containment: 'window',
        scroll: false,
        handle: '#titlebar'
    }); 
```

不同之处在于有问题的小提琴使用的是 jQuery 1.7.2 而不是 1.4，因为当我在“好”的小提琴中将 jquery 更改为 1.7.2 时，问题就出现了。

在谷歌浏览器中是否有解决这个问题的方法，仍然允许使用 jQuery 1.7.2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:29:50.977

我没有看到问题，使用 Chrome for Mac。试试这个小家伙，它更轻量级：[http ://css-tricks.com/snippets/jquery/draggable-without-jquery-ui/](http://css-tricks.com/snippets/jquery/draggable-without-jquery-ui/)

# asp.net - 如何在 <%=value%> 类型的块中强制执行赋值

> ID：16173266
> 
> 赞同：0
> 
> 时间：2013-04-23T15:24:03.617
> 
> 标签：asp.net, default-value, execution, compiler-directives, page-directives

是否有指令或指令强制执行网页中 <%=value%> 类型的块？因为我有一个 Web 项目，其中我有一个该类型的块，它只是第一次评估（当值是“”），但如果我更改变量值的值，它是字符串类型的公共字段，在按钮内内容不计算，我正在使用值插入脚本。我将我的 aspx 副本上传到我的 Web 服务器并且代码工作正常，但我遇到的问题是它在我调试时不起作用，从未评估值并且从未插入脚本块。

我真的需要能够在运行脚本的情况下调试 Web 应用程序以保持编码。

问候。

PS 我真的需要使用这种方法，因为 ScriptManager 的 RegisterClientScriptBlock 和 RegisterStartupScript 对我来说在以前版本的 Internet Explorer 上是无用的。

…………

```
 public string value = "";

    protected void Button1_Click(object sender, EventArgs e)
    {
        //Just a silly example of a script.
        value = "<script type=\"text/javascript\">alert(Add(3,4));</script" + ">";

    } 
```

…………

```
<script type="text/javascript">
    function Add(number1, number2) {
        return (number1 + number2);
    }

 </script>

<%=value %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:43:38.900

aspx：

```
<asp:Literal ID="Literal1" runat="server"></asp:Literal> 
```

C＃：

```
Literal1.Text = "<script type=\"text/javascript\">alert(Add(3,4));</script" + ">"; 
```

那对你有用吗？

# php - 匹配 PHP 字符串中的 key=“value” 模式

> ID：16173267
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:24:04.553
> 
> 标签：php, regex, parsing

如何（最简单的方法）转换字符串

```
oneKey="value 1" key2="value 2" anotherKey="value 3" somekey="value containing spaces" 
```

到一个带有 PHP 的数组（正则表达式与否）？

我想检索这样的值：

```
$myArray['key'] 
```

所以

```
$myArray['oneKey'] == "value" 
```

**所有的键都不一样**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:40:16.943

匹配带引号的字符串总是很棘手。

假设您的数据从不包含转义的双引号（即作为实际值一部分的双引号，一个简单的

```
/(?<=^|\s)([^=]+)="([^"]*)"/ 
```

...可能会完成这项工作，但不太可能是这种情况。所以我们需要比这更复杂一点，这就是弗里德尔经典的“展开循环”的用武之地：

```
/(?<=^|\s)([^=\s]+)="((?:[^\\"]|\\.)*)"/ 
```

它是如何工作的？好吧，让我们分解一下：

首先，我们从后向检查开始，以验证匹配的开头是字符串开头还是空格字符：

```
(?<=^|\s) 
```

接下来，我们寻找非空白字符和非等号字符的任意组合（至少其中 1 个）。这是关键，所以我们把它放在一个捕获组中：

```
([^=\s]+) 
```

接下来我们有一个文字等号和双引号：

```
=" 
```

接下来是“展开循环”。一开始这可能有点难以理解，但它可以通过查找不是引号字符或转义字符的任何字符（我选择反斜杠作为转义字符，但实际上你可以使用任何字符）*或*转义字符来工作字符后跟任何其他字符。这会重复零次或多次。由于这是值，我们将其包装在一个捕获组中：

```
((?:[^\\"]|\\.)*) 
```

然后我们简单地用文字双引号结束：

```
" 
```

把它们放在 PHP 代码中，你会得到这样的东西：

```
$subject = 'key1="value 1" key2="value 2" key3="value 3" key4="value containing spaces"';

$expr = '/(?<=^|\\s)([^=\\s]+)="((?:[^\\\\"]|\\\\.)*)"/';
preg_match_all($expr, $subject, $matches);

$result = array();
foreach ($matches[1] as $i => $key) {
    $result[$key] = $matches[2][$i];
} 
```

[看到它工作](http://eval.in/17286)

* * *

但这有一个小问题。考虑[当](http://eval.in/17287)主题字符串是：

```
key1="value\" 1" 
```

应该很好很简单，这只是一个转义的引用，对吧？嗯，确实如此，上面的表达式可以轻松处理这种情况。但是看看输出：

```
Array
(
    [key1] => value\" 1
) 
```

转义字符仍以文字形式存在于结果字符串中。这不是我们想要的。但是上面的表达式只从主题字符串中提取了相关的组件，它根本没有对它们进行插值。为此，我们需要一个单独的过程——但现在它只是一个简单的搜索和替换，因为我们已经将字符串分解为我们想要的标记。

所以我们只是做这样的事情：

```
$result = preg_replace_callback('/\\\\./', function($match) {
    switch ($match[0][1]) { // inspect the second character
        // here we can define our special escape sequences, for example:
        case 'r': return "\r";
        case 'n': return "\n";

        // For anything that we don't handle as a special case, we just return
        // the second character in the match, effectively strip the escape
        default: return $match[0][1];
    }
}, $subject); 
```

所以当你把它和上面的代码放在一起时，你会得到一个更像这样的东西：

```
$subject = 'key1="value \" 1" key2="value \n 2" key3="value 3" key4="value containing spaces"';

$matchExpr = '/(?<=^|\\s)([^=\\s]+)="((?:[^\\\\"]|\\\\.)*)"/';
$replaceExpr = '/\\\\./';

$replaceCallback = function($match) {
    switch ($match[0][1]) {
        case 'r': return "\r";
        case 'n': return "\n";
        default: return $match[0][1];
    }
};

preg_match_all($matchExpr, $subject, $matches);

$result = array();
foreach ($matches[1] as $i => $key) {
    $result[$key] = preg_replace_callback($replaceExpr, $replaceCallback, $matches[2][$i]);
} 
```

[看到它工作](http://eval.in/17290)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:29:24.020

**用preg_match_all**试试这个正则表达式：

```
/(key[0-9]{0,})\="(.+?)"/ims 
```

并且返回的匹配项将具有键和值

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-23T15:31:26.580

```
$func = function($string) { $kv = preg_split(/="/, $string); $kv[1] = substr($kv[1], 0, length($kv[1]-1])); $myArray[$kv[0]] = $kv[1]; };
array_map($func, preg_split(/[[:space:]]+/, $string)); 
```

# symfony1 - Symfony 中表单的默认值

> ID：16173268
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:24:06.860
> 
> 标签：symfony1, symfony-1.4, symfony-forms

为了在我的表单中设置一个默认值，我喜欢这样：

```
 $def_volume = array(-1=>"Please select a volume");
   $def_issue = array(-1=>"Please select issue");

   $volumes = array_merge($def_volume,IssuePeer::getAllVolumesForListChoices());
   $issues = array_merge($def_issue,IssuePeer::getAllIssuesForListChoices());

   $this->setWidgets(array(
  'keyword'    => new sfWidgetFormInput(),
  'volume' => new sfWidgetFormSelect(array('choices' => $volumes)),
  'issue' => new sfWidgetFormSelect(array('choices' => $issues)),
));

   $this->setValidators(array(
  'keyword'    => new sfValidatorString(array('required' => true)),
  'volume' => new sfValidatorChoice(array('choices' => array_keys(IssuePeer::getAllVolumesForListChoices()))),
  'issue' => new sfValidatorChoice(array('choices' => array_keys(IssuePeer::getAllIssuesForListChoices()))),
)); 
```

输出 ：

```
<select id="filterSearch_volume" name="filterSearch[volume]">
<option value="0">Please select a volume</option>
....
</select> 
```

但我希望有这样的输出：

```
<select id="filterSearch_volume" name="filterSearch[volume]">
<option value="">Please select a volume</option>
....
</select> 
```

如果您说第一个值的值是`value="0"`，但我希望像这样返回“null” `value=""`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T04:13:11.823

$this->widgetSchema['employee_id']->setOption('add_empty', '请选择员工');

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:43:56.373

你有没有尝试过：

```
$def_volume = array('' => "Please select a volume"); 
```

这似乎对我有用。

# php - Stop infinite loop due to 24:00:00 (00:00:00) being less than 23:59:00 instead of more

> ID：16173274
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:24:23.197
> 
> 标签：php, datetime, loops, sql-server-2008-r2, infinite-loop

I have a database that has the startTime for a task, the endTime, and how often it runs (everyMinutes).

I am taking this data into php, and using a loop writing all expected times to a separate table. The problem is when a task starts at `00:00:00` and ends at `23:59:00`. Functionally this means it runs all day. If `everyMinutes` was 15, then it would start at `00:00:00` and then run again at `00:00:15`.

The problem with my code below is that `$latestRunTime` will be `23:45:00` which is less than `$endTime` so it iterates again. However, instead of being larger than `$endTime` at the end of the loop, it is set back to `00:00:00` and I am stuck in an infinite loop. How can I mitigate this?

```
$getTaskDetailQuery = "SELECT taskID, startTime, endTime, everyMinutes FROM frequencyTable WHERE everyMinutes != '00:00:00' ORDER BY taskID ASC";
$stmt = sqlsrv_query($conn, $getTaskDetailQuery);
if($stmt === FALSE){
    die(print_r(sqlsrv_errors(), true));
}
$insertQueryMulti = "INSERT INTO exactTimeScheduleTable (taskID, expectedTime) VALUES (?, ?)";
while($row = sqlsrv_fetch_array($stmt, SQLSRV_FETCH_ASSOC)){
    $taskID = $row['taskID'];
    $startTimeRaw = $row['startTime'];
    $endTimeRaw = $row['endTime'];
    $everyMinutesRaw = $row['everyMinutes'];
    $startTime = $startTimeRaw->format('H:i:s');
    $endTime = $endTimeRaw->format('H:i:s');
    $everyMinutes = $everyMinutesRaw->format('H:i:s');
    $secs = strtotime($everyMinutes)-strtotime("00:00:00");
    $latestRunTime = date("H:i:s",strtotime($startTime));
    while ($latestRunTime < $endTime){
        $timeToInsertRaw = strtotime($latestRunTime);
        $dataForInsert = array($taskID,$latestRunTime);
        $execute = sqlsrv_query($conn, $insertQueryMulti, $dataForInsert);
        $latestRunTime = date("H:i:s",strtotime($latestRunTime)+$secs);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:48:02.197

just add this as the last line inside your while loop:

```
if($latestRunTime == "00:00:00") break; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:36:32.747

You're currently checking wether the *last* run operation was within the accepted time limit, just change it to check if the *next* run operation is within the accepted time limit.

```
while (strtotime($latestRunTime)+$secs < $endTime); 
```

# .net - 检测安装 ClickOnce 应用程序的真实路径

> ID：16173279
> 
> 赞同：2
> 
> 时间：2013-04-23T15:24:34.180
> 
> 标签：.net, vb.net, clickonce

我想从另一个 C# 应用程序中按其名称执行 ClickOnce 应用程序。我当前的方法从卸载注册表项 (HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall\[PublicKeyToken]\ShortcutAppId.

我们有一个存储所有 ClickOnce 应用程序的网络文件夹。ClickOnce 应用程序的每个快捷方式都以该文件夹中的 .Application 文件为目标。

当应用程序部署到 Z:\ClickOnceApps\MyApp 但从 \\server\share\ClickOnceApps\MyApp\MyApp.application 安装时，我遇到了问题。在这种情况下，存储在注册表中的 ShortcutAppId 是 Z:\ClickOnceApps\MyApps\MyApps.Application#[...] 当我尝试使用此路径启动应用程序时，它让我安装它，这让我认为实际安装路径是应用程序标识的一部分。

所以基本上我只能从安装它的同一路径启动应用程序。

我的问题：如何检索安装应用程序的精确路径（而不是部署路径）？

这是我为感兴趣的人检索 ShortcutAppId 的代码：

```
Public Class ClickOnceApp

        Public Property DisplayName As String
        Public Property UninstallString As String
        Public Property PublicKeyToken As String
        Public Property DisplayVersion As Version
        Public Property ShortcutAppId As String

        Public ReadOnly Property ShortcutPath As String
            Get

                Dim pawnIndex = ShortcutAppId.IndexOf("#"c)
                If pawnIndex = -1 Then
                    Return ""
                Else
                    Return ShortcutAppId.Substring(0, pawnIndex)
                End If

            End Get
        End Property

        Public Sub New(appUninstallKey As RegistryKey)

            Me.DisplayName = appUninstallKey.GetValue("DisplayName")
            Me.UninstallString = appUninstallKey.GetValue("UninstallString")
            Me.PublicKeyToken = appUninstallKey.GetValue("PublicKeyToken")
            Me.DisplayVersion = New Version(appUninstallKey.GetValue("DisplayVersion"))
            Me.ShortcutAppId = appUninstallKey.GetValue("ShortcutAppId")

        End Sub

        Public Sub Launch()
            Process.Start(ShortcutPath)
        End Sub

    End Class

    Public Class ClickOnceHelper

        Public Shared Function GetInstalledClickOnceApps() As ClickOnceApp()

            Dim list As New List(Of ClickOnceApp)()

            Using uninstallKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall")

                For Each subKeyName In (From keyName In uninstallKey.GetSubKeyNames() _
                                    Where keyName.Length = 16)

                    Using appKey = uninstallKey.OpenSubKey(subKeyName)

                        If CStr(appKey.GetValue("UninstallString")).StartsWith("rundll32.exe dfshim.dll") Then

                            Dim app = New ClickOnceApp(appKey)
                            list.Add(app)

                        End If

                    End Using

                Next

            End Using

            Return list.ToArray()

        End Function

        Public Shared Function FindClickOnceAppByName(name As String) As ClickOnceApp

            Dim list = GetInstalledClickOnceApps()
            Return (From app In list _
                    Where app.DisplayName.ToLower() = name.ToLower()).FirstOrDefault()

        End Function

        Public Shared Function FindClickOnceAppByPublicKey(publicKeyToken As String) As ClickOnceApp

            Dim list = GetInstalledClickOnceApps()
            Return (From app In list _
                    Where app.PublicKeyToken = publicKeyToken).FirstOrDefault()
        End Function

End Class 
```

# java - PBE 中的最大密钥大小？

> ID：16173281
> 
> 赞同：0
> 
> 时间：2013-04-23T15:24:42.970
> 
> 标签：java, encryption, password-encryption

在 Java 中，我看到每种加密类型都有一个最大密钥大小，例如 AES-256、DES-128、3DES-128 等。在 PBE 中，我们正在输入密钥并对其进行了盐修改。我想知道 PBE 的最大密钥大小是多少？它依赖于盐吗？它依赖于迭代器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:48:09.963

PBE（password based encryption）用于使用密码对数据进行加密，基于底层加密算法（即AES、DES、Blowfish等）。所以你可以给它任何密码，它会被处理、散列、HMACed，以及其他任何东西，结果会被缩小以匹配底层加密算法的密钥大小。

# javascript - 附加 + 触发器（“创建”）在 Phonegap 中使用大型 DOM 真的很慢

> ID：16173288
> 
> 赞同：1
> 
> 时间：2013-04-23T15:25:07.217
> 
> 标签：javascript, cordova, jquery-mobile

我正在使用 Phonegap 和 JQuery Mobile 来创建 iPhone 移动应用程序。此应用程序解析外部 JSON，其内容在 Javascript 中“格式化”，附加相应的 HTML 标记，然后将所有这些添加到 DOM。这是通过以下方式完成的：

```
$('div#container').empty().append(output).trigger("create"); 
```

变量输出是一个字符串，其中包含所有带有附加 HTML 标记的 JSON。

当 JSON 中的数据很小并且输出变量中的内容也很小时，前面的代码可以完美运行，但是当数据很大并且输出变量定义了一个大字符串（大约 80 个 HTML 标记）时，该行需要在 iPhone 上执行几乎 30 秒（它在 Chrome、Firefox 和 Safari 上完美运行）。但是，如果我删除触发方法，信息会立即显示，但当然没有应用任何样式：

```
$('div#container').empty().append(output); 
```

有没有办法解决这个问题以减少执行时间？

# iphone - 在后台进程运行时更新 MBProgressHUD

> ID：16173290
> 
> 赞同：0
> 
> 时间：2013-04-23T15:25:09.030
> 
> 标签：iphone, ios, ipad, grand-central-dispatch, mbprogresshud

我在@interface ZxBancaD 中展示：UITableViewController 一个 MBProgressHUD，每次关闭模态视图时

```
- (void) disparaMa:(NSNotification *)notification {
   hudX                 = [MBProgressHUD showHUDAddedTo:self.splitViewController.view animated:YES];
   hudX.delegate        = self;
   hudX.mode            = MBProgressHUDModeAnnularDeterminate;
   hudX.labelText       = @"Pago Minimo...";
   hudX.dimBackground   = YES;
   [hudX showWhileExecuting:@selector(actEtiqueta) onTarget:self withObject:nil animated:YES];

   dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ^ (void) {
    [self miniAutomatico];
   });
} 
```

我用这个方法来更新我的 hudX

```
- (void) actEtiqueta {
   xP                       = 0.0f;
   while (xP < 1) {
     xT                     = [[NSUserDefaults standardUserDefaults] integerForKey:kVueltas];
     xP                     = ((double)xT)/24;
     hudX.detailsLabelText  = [NSString stringWithFormat:@"Vuelta%i", xT];
     hudX.progress          = xP;
     NSLog(@"AxTiempoB.actEtiqueta.progress %f | xP %f | xT %i", hudX.progress, xP, xT);
     usleep(50000);
   }
} 
```

后台进程为（此处计算xT变量）：

```
- (void) miniAutomatico                                {
    cwMonitorBz                                    = [[[CwMonitorBz alloc] init]autorelease];
    cwMonitorBz.persistentStoreCoordinator         = self.persistentStoreCoordinator;
    cwMonitorBz.managedObjectContextp              = self.managedObjectContextp;
    cwMonitorBz.gmCuenta                           = gmCuenta;
    cwMonitorBz.esCuentaCero                       = @"1";
    [self.cwMonitorBz monitorMinimoAuto];

    dispatch_async(dispatch_get_main_queue(), ^{
        NSLog(@"acabo..miniAutomatico");
        [MBProgressHUD hideHUDForView:self.splitViewController.view animated:YES];
    });
} 
```

由于某种原因，hudX 不会动态（实时）更新。它显示正确的值：来自后台进程的 (int) XT，但滞后。我猜我的主线程（UI）被阻塞了，但我不知道为什么或在哪里。

如何实时更新我的​​ hudX (UI)？非常感谢您的回复。

# maven - 通过 Maven 到达罗马

> ID：16173292
> 
> 赞同：3
> 
> 时间：2013-04-23T15:25:09.973
> 
> 标签：maven, rome

我正在与 Maven 合作，我希望开始将 Rome 用于一个项目。

当我在 Eclipse 的 m2 实例中查找“rome”时，我得到了一些结果：

1.  net.java.dev.rome:rome:1.0.0 (2010-04-17)
2.  org.rometools:rome-fetcher:1.2 (2011-03-11) <-- 最近的
3.  罗马：罗马：1.0（2010-05-10）

最重要的是，据我所知，罗马项目现在似乎在 rometools.jira.com 上。[这个页面](https://rometools.jira.com/wiki/display/ROME/ROME+and+Maven+2)似乎说要使用第三个选项，但是在*另一个存储库*（Maven 中心除外）上，即使同一页面声明它不是最新的。

所以我迷路了。如果我想要最新版本的罗马库，我应该使用什么 Maven 依赖项？毕竟我什至使用了正确的存储库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-01T20:33:24.327

如果有人现在正在寻找最新的罗马图书馆，[最新版本是 1.5.0](http://mvnrepository.com/artifact/com.rometools/rome/1.5.0)：

```
<dependency>
    <groupId>com.rometools</groupId>
    <artifactId>rome</artifactId>
     <version>1.5.0</version>
</dependency> 
```

更多信息请访问[http://rometools.github.io/rome/](http://rometools.github.io/rome/)

# excel - VBA - 代码执行非常慢

> ID：16173294
> 
> 赞同：3
> 
> 时间：2013-04-23T15:25:14.613
> 
> 标签：excel, vba, optimization

我有一段相当简单的代码，用于循环遍历 Excel 数据表。基本上，我有超过 150,000 行数据，我想删除每一行，除了其中包含“仪器故障”的行，在这种情况下，我想要该行以及紧接其上方和下方的行（可能包含与失败）。这是我的代码：

```
Sub UnsignedFailure()
Application.ScreenUpdating = False
'Start point
Set r = Range("E1")

'Loop, total rows is a function, executes quickly
For t = 3 To TotalRows
    'Check for a failure
    k = InStr(1, r.Cells(t, 1).Value, "Instrument Failure")
    'Verify that it corresponds to a GC
    b = InStr(1, r.Cells(t, 1).Offset(0, -3).Value, "GC")
    If k <> 0 And b <> 0 Then
    'Skip two rows if it is true
        t = t + 2
    Else
    'Delete the previous row since this row is not a failure
        r.Cells(t - 1, 1).EntireRow.Delete
    'Go back a row to account for the deleted row
        t = t - 1
    End If
Next t

Application.ScreenUpdating = True
End Sub 
```

我已经通过逐步检查了它并且它有效。然而，即使每次“IF”为真时代码中断，中断之间的时间似乎很长（检查 20,000 个单元格可能需要 5 分钟）。如果我让代码运行而不中断，我还没有完成它（计算机死机）。我的代码是否遗漏了什么或效率低下？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T15:35:34.123

我使用 excel 宏的经验告诉我，将符合条件的数据复制到新工作表中效率更高，而不是删除不匹配的行。

每次删除一行时，excel 需要几毫秒的时间来重新计算工作表（即使没有公式，它仍然会检查每个单元格以查看是否需要更新）并更新显示给用户。您已经禁用了屏幕更新，这肯定会减少一些时间。另一种方法是关闭 Excel Calculation，将其放在`Application.Calculation = xlCalculationManual`sub 的顶部以禁用重新计算，并`Application.Calculation = xlCalculationAutomatic`在底部再次启用它。 [这个网站](http://www.cpearson.com/excel/optimize.htm)有一些关于excel VBA代码优化的很好的指导。

正如我所说，我认为最有效的方法是在数据符合您的条件时将其移动到新工作表。

# php - Google Calendar API - (403) 访问未配置'

> ID：16173295
> 
> 赞同：3
> 
> 时间：2013-04-23T15:25:16.213
> 
> 标签：php, google-api, google-calendar-api

我开发了一个使用 Google Calendar API 的应用程序。

当我将它从我的开发环境转移到测试环境时，我在 Google API 控制台中为它创建了新条目，并将该信息复制到 config.php 中。

```
// The application_name is included in the User-Agent HTTP header.
'application_name' => 'Google Calendar PHP Starter Application',

// OAuth2 Settings, you can get these keys at https://code.google.com/apis/console
'oauth2_client_id' => '517034425134-503uog3i6pfXk15qq6mjsfbi48sabd50o.apps.googleusercontent.com',
'oauth2_client_secret' => '4p4go-aRXVcGx4YxcgC2wgvyV',
'oauth2_redirect_uri' => 'http://mydomain/admin/calendar_events.php',

// The developer key, you get this at https://code.google.com/apis/console
'developer_key' => 'AIzaSyCm9tj17rd-OepTl5XFxMwI9SQMH2BoQkKI', 
```

但是，我无权访问。我正进入（状态：

```
Uncaught exception 'Google_ServiceException' with message 'Error calling GET https://www.googleapis.com/calendar/v3/users/me/calendarList?key=AIzaSyCm9tj17rd-OepTl5XFxMwI9SQMH2BoQkKI: (403) Access Not Configured' 
```

我不确定这是为什么。我知道代码很好......我只需要在他们的 API 控制台和我的 config.php 之间同步一些东西，对吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T16:09:50.300

我不得不评论这一行：

// 'developer_key' => 'AIzaSyCm9tj17rd-OepTl5XFxMwI9SQMH2BoQkKI',

然后它起作用了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-31T13:39:02.950

打开服务后（在 Google Api 的“服务”选项卡下），我不得不等待几分钟才能成功启动身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-30T19:03:02.920

您需要转到[https://code.google.com/apis/console/](https://code.google.com/apis/console/)并启用日历 API 的开关。

这对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T16:52:49.860

您可以在“服务”选项卡中打开日历 API：http: [//screencast.com/t/DbfpznnOT](http://screencast.com/t/DbfpznnOT)

# python - 向字典添加算术值？

> ID：16173296
> 
> 赞同：1
> 
> 时间：2013-04-23T15:25:16.310
> 
> 标签：python

我有一本字典，如下图所示。

```
band1= {'channel1': 10564, 'channel2': 10589, 'channel3': 10612, 'channel4': 10637,'channel5': 10662, 'channel6': 10687,
'channel7': 10712, 'channel8': 10737, 'channel9': 10762, 'channel10': 10787,'channel11': 10812, 'channel12': 10837, } 
```

我想要一种编辑这本词典的好方法。对于每个条目，我希望添加另一个值是 value/5，而输入的第三个值是 value/5-190

然后字典看起来像（表达式实际上转换为它们的最终值）：

```
band1= {'channel1': [10564, 10564/5, 10564/5-190], 'channel2': [10589,10589/5,10589/5-190], 'channel3': [10612,10612/5,10612/5-190], 'channel4': [10637,10637/5,10637/5-190],
'channel5': [10662,10662/5,10662/5-190], 'channel6': [10687,10687/5,10687/5-190],
'channel7': [10712, 10712/5, 10712/5-190], 'channel8': [10737,10737/5,10737/5-190], 'channel9': [10762,10762/5,10762/5-190], 'channel10': [10787,10787/5,10787/5-190],'channel11': [10812,10812/5,10812/5-190], 'channel12': [10837,10837/5,10837/5-190]} 
```

我必须用很多条目来做到这一点，所以如果我可以以 python 的方式添加它们，这将比只输入它们要好。对于其他字典，5 或 190 也是可变的，因此能够轻松更改它会很好，这是不进行硬编码的另一个原因。例如，另一个字典可能具有我需要除以 4 并为第二个元素添加 200 的规则，然后对于第三个元素，我可能必须添加另一个变量编号。

```
band2= {'channel1': [10564, 10564/4+200, 10564/4+200+100] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:27:15.983

一个 dict 理解可以解决问题：

```
var1 = 5
var2 = -190
{k: [v, v/var1, v/var1+var2] for k, v in band1.iteritems()} 
```

对于 Python 3，替换`.iteritems()`为 just `.items()`，对于 Python 2.6 及之前的版本，使用生成器表达式生成 (key, value) 元组：

```
dict((k, [v, v/var1, v/var1+var2]) for k, v in band1.iteritems()) 
```

对于您的第二个字典`var1`，`var2`然后分别设置为`4`和`200`。

演示：

```
>>> {k: [v, v/var1, v/var1+var2] for k, v in band1.iteritems()}
{'channel11': [10812, 2162, 1972], 'channel10': [10787, 2157, 1967], 'channel3': [10612, 2122, 1932], 'channel2': [10589, 2117, 1927], 'channel1': [10564, 2112, 1922], 'channel7': [10712, 2142, 1952], 'channel6': [10687, 2137, 1947], 'channel5': [10662, 2132, 1942], 'channel4': [10637, 2127, 1937], 'channel9': [10762, 2152, 1962], 'channel8': [10737, 2147, 1957], 'channel12': [10837, 2167, 1977]} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:33:12.450

如果你想用这样的值从头开始构建字典，这些值可以采用不同的形式，我会选择小的辅助函数：

```
def manip1(k, a, b):
    return [k, k/a, k/a - b]

def manip2(k, a, b, c):
    return you_name_it(k, a, b, c)

# and then
band1['channel2'] = manip1(10564, 5, 190)
band1['channel3'] = manip2(10600, 5, 190, 200) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:28:16.743

我认为值得一提的其他选项是使用字符串：

```
band2= {'channel1': ['10564', '10564/4+200', '10564/4+200+100'] 
```

然后用 提取值`eval`：

```
>>> eval("10564/4+200")
2841 
```

# tortoisehg - 在 TortoiseHg Workbench 中创建两个用户

> ID：16173303
> 
> 赞同：2
> 
> 时间：2013-04-23T15:25:29.353
> 
> 标签：tortoisehg, workbench

我使用 TortoiseHg Workbench，我有两个不同的存储库，具有不同的登录名和密码。所以我对如何存储和绑定正确的登录名/密码与目标存储库很感兴趣？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T05:05:32.707

如果你真的说

> 我有两个本地存储库，从不同的（基于 http 的）源克隆，它们需要不同的身份验证凭据进行拉推

您必须阅读`hg help hgrc`（[auth] 设置部分）或[在线完成](http://www.selenic.com/mercurial/hgrc.5.html#auth)并添加到全局（或每个特定于 repo）的 hgrc`[auth]`部分（默认情况下缺少），并带有所需的 key=value 对

```
Example:

foo.prefix = hg.intevation.org/mercurial
foo.username = foo
foo.password = bar
foo.schemes = http https 
```

将通过[http://hg.intevation.org/mercurial](http://hg.intevation.org/mercurial) * 或[https://hg.intevation.org/mercurial * 上的密码栏](https://hg.intevation.org/mercurial)**默默地**授权您作为用户 foo 。您可以在单个资源的不同子树上为不同的身份验证设置相交前缀 -**最长匹配**前缀总是获胜

# wordpress - 如何在自定义主题中添加自定义字段

> ID：16173311
> 
> 赞同：0
> 
> 时间：2013-04-23T15:25:41.110
> 
> 标签：wordpress, custom-fields

我一直在寻找这个答案，但无法解决。

我为页面和帖子创建了两个自定义字段：一个用于背景图像，一个用于背景颜色。

然后我这样称呼我头脑中的变化：

```
<style type="text/css">
<?php
$image = get_post_meta($post->ID, 'background-image', true);
$bgcolor = get_post_meta($post->ID, 'background-color', true);?>

#wrapper {    background-image: url('<?php echo $image ?>');
background-size: 100% auto;
background-repeat: no-repeat;
background-color: <?php echo $bgcolor ?>;
}
</style>

</head>` 
```

我不想在使用此主题的每个站点中创建自定义字段，因此我想将自定义字段添加到主题（编码）。如何将它添加到我的 functions.php 或 page.php 或它必须在的任何地方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:53:57.997

在这里你可以找到你的答案：

[自定义帖子类型的 Wordpress 自定义字段](https://stackoverflow.com/questions/16130195/wordpress-custom-fields-for-custom-post-types/16130467#16130467)

或者你在这里：

[http://5wpthemes.com/blog/adding-and-displaying-custom-fields-and-values-in-wordpress/](http://5wpthemes.com/blog/adding-and-displaying-custom-fields-and-values-in-wordpress/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:51:54.670

你是在调用这个内部循环吗？

当然是的，因为您正在使用`get_post_meta($post->ID, 'background-image', true);`并且以这种方式尝试执行服务器端代码来更新客户端代码。我不知道先执行哪一个，但我只是想在你的脑海中触发这样一个问题，向你介绍我的做法。

我认为您应该考虑使用 jQuery 来管理此类问题：

想法：

*   获取自定义字段服务器端的值并将其作为背景 div 的变量属性（类或 id 或任何属性）。
*   创建外部 jQuery 文件，该文件将侦听文档并根据检索到的属性更改 CSS 属性。我确信 jQuery 有管理 CSS 的功能。使用插件`More fields`来轻松管理您的自定义字段并避免过多的编码。

其次，在代码中放入内联 CSS 确实不好，最好的方法是调用外部 CSS 文件。此规则也适用于 JS 脚本。

最重要的是要知道如何将服务器端与客户端分开。祝你好运

# windows - Windows 批处理文件无法始终如一地工作

> ID：16173315
> 
> 赞同：1
> 
> 时间：2013-04-23T15:25:50.713
> 
> 标签：windows, vbscript, batch-file, telnet

我有一个批处理文件，它启动一个 telnet 会话并使用 vbs 脚本执行一些命令：

```
start telnet.exe another.hostname
timeout /t 1 /nobreak > NUL
cscript c:\scripts\sendtelnet.vbs 1 
```

我的 vbs 脚本如下所示：

```
WScript.sleep 1000
arg = Wscript.Arguments.Item(0)
WScript.sleep 1000
cmd = "RUN CMD D "&arg&"{ENTER}"
WScript.sleep 1000
set OBJECT=WScript.CreateObject("WScript.Shell")
WScript.sleep 6000
OBJECT.SendKeys "administrator{ENTER}" 
WScript.sleep 200
OBJECT.SendKeys "mypass{ENTER}"
WScript.sleep 200
OBJECT.SendKeys cmd
WScript.sleep 5000
OBJECT.SendKeys "QUIT{ENTER}" 
WScript.sleep 500 
OBJECT.SendKeys "{ENTER}" 
WScript.sleep 100 
OBJECT.SendKeys " " 
```

我可以运行这个测试大约 10 次，但它只会在 10 次中运行大约 8 次。我目睹了测试失败，发生的情况是 telnet 窗口打开了，但它挂在“用户名”提示符上，最终 telnet 会话超时并且窗口永远不会关闭。

为什么这只有时会起作用？我是否需要增加睡眠时间？我试着睡了 6000 毫秒，它似乎足够长了。我一直在尝试很多东西，但我一直卡在这部分，我愿意在这一点上尝试任何东西，请任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:08:50.583

Telnet 本身就是不稳定的。手动登录交换机或路由器时，我不时会遇到类似的行为。尝试登录和退出 telnet 服务器 10-20 次，看看它是否在用户名提示下挂起。我不认为你的脚本应该受到责备，尽管 vbscript 中的 sendkeys 方法还是很糟糕。它仅在某些情况下和特定条件下有效。我建议把

```
object.appactivate ("C:\windows\system32\telnet.exe") 
```

在你的 vbscript 之前

```
cmd = "RUN CMD D "&arg&"{ENTER}" 
```

也是。这样，您至少知道击键将进入正确的窗口。您可能想看看[AutoIT](http://www.autoitscript.com/site/autoit/)。将密钥发送到 Windows 更加健壮。

# c# - ArgumentException：参数在 System.Drawing.Image.FromStream 中无效

> ID：16173318
> 
> 赞同：0
> 
> 时间：2013-04-23T15:25:58.640
> 
> 标签：c#, .net, wcf, bytearray

我需要一些帮助来解决这个异常：我正在尝试解析多部分格式数据并从中提取图像`byte[]`。

```
int startIndex = contentTypeMatch.Index + 
                 contentTypeMatch.Length + "\r\n\r\n".Length;

string contn = s.Substring(startIndex).TrimEnd(new char[] { '\r', '\n' }).Trim();
byte[] test = encoding.GetBytes(contn);
System.Drawing.Image img = 
    System.Drawing.Image.FromStream(new MemoryStream(test)); 
```

任何想法？

# http - 谷歌浏览器不会来回重新验证 etag

> ID：16173322
> 
> 赞同：12
> 
> 时间：2013-04-23T15:26:13.733
> 
> 标签：http, browser-cache, cache-control, etag

即使我发送“缓存控制：必须重新验证”谷歌浏览器在使用浏览器中的来回按钮时使用本地缓存页面。

这是原始回复的一部分：

```
HTTP/1.1 200 OK
cache-control: private, must-revalidate
etag: "c9239b5d4b98949f8469a05062e05bb999d7512e"
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: text/html; charset=utf-8 
```

如果我刷新页面，我会收到“HTTP/1.1 304 Not Modified”响应，但是当我使用后退按钮时，会收到以下响应：

```
Request URL:example.com
Request Method:GET
Status Code:200 OK (from cache) 
```

我正在寻找的响应是 304 或 200 OK，是否有可能实现这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-05-12T11:40:33.870

使用后退和前进按钮时，`Cache-Control`防止浏览器返回页面缓存副本的关键指令是`no-store`.

没有其他任何帮助，也不需要其他任何东西。您的`Cache-Control`标题可以简单地是：

```
Cache-Control: no-store 
```

不过这有两个例外。

1.  无论您设置什么标头（至少我测试过的版本），Opera 和 Safari 都不会重新验证。如果您在新选项卡中打开页面，该副本将是新鲜的，但在您刷新或重新输入网址之前，原始选项卡将在来回导航时继续显示陈旧版本。
2.  Firefox 似乎在打开的第一页的缓存中存在错误（即，当没有返回按钮时）。当您来回导航时，该页面的所有后续实例都会刷新，但是一旦您一直备份到最顶部的页面，它通常仍会显示其初始陈旧副本。

最后，我应该注意，一般不建议使用该指令，因为它显然会对带宽使用产生重大影响。浏览器甚至无法利用`Etags`来获取`304 Not Modified`响应，因为在收到响应的情况下它没有存储的副本可供使用`304`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-07T02:23:56.107

“必须重新验证”指令仅在响应过时后适用（[RFC2616，第 14.9.4 节](https://www.rfc-editor.org/rfc/rfc2616#section-14.9.4)）。由于响应既不包含“Expires”标头也不包含“max-age”指令，浏览器可能将响应视为仍然新鲜，并相应地返回缓存的副本。为了防止这种情况，您应该在 Cache-Control 标头中包含“max-age: 0”（可能还有一个包含过去日期的 Expires 标头），以便缓存的响应立即变得陈旧。或者，为了防止缓存，使用“no-cache”指令而不是“must-revalidate”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-05-12T04:38:58.033

缓存指令可`no-store`用于指示浏览器不要将页面写入磁盘缓存。结合`no-cache`这应该确保所有浏览器将从上游而不是从磁盘获取资源。

`Cache-Control: private, no-cache, no-store`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-16T10:45:58.093

缓存控件未设置，强制浏览器使用`default`. （在此处阅读有关缓存选项的更多信息：[https](https://developer.mozilla.org/en-US/docs/Web/API/Request/cache) ://developer.mozilla.org/en-US/docs/Web/API/Request/cache ）

为了重新评估缓存，您必须配置服务器以发送[`Cache-Control: no-cache`标头](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)；或通过设置[`Request.cache = 'no-cache'`选项](https://developer.mozilla.org/en-US/docs/Web/API/Request/cache)浏览器/客户端。仅此选项就足以正确使用 ETag。

# c++ - 将 Boost:Tuple 解析为 char*（带字节序）

> ID：16173323
> 
> 赞同：0
> 
> 时间：2013-04-23T15:26:20.673
> 
> 标签：c++, templates, c++11, boost-fusion, boost-tuples

我有许多类具有不同的私有成员实现，`boost::tuple<> structures`即。`<std::string, int>`或`<short, short, float>`。我现在需要将该元组解析为私有元组`const char* message`（因为我想通过 tcp 发送它），但不能不改变那些需要改变字节序的数据类型的字节序。

这是我到目前为止所拥有的：

```
struct parseTuple{
    template<typename T>
    void operator()(T& t) const{
        std::cout << ntohl(t) << "\n";
    }
};

void Base::createMessageFromTuple(){
    boost::fusion::for_each(this->structure, parseTuple());
} 
```

在继续之前，我认为我需要知道一些事情：

1.  如何跟踪元组成员，以便我可以`message`根据他们的数据类型（静态成员，也许？）分配空间

2.  如何在模板中区分符合`ntohl`要求的数据类型和需要不同处理的数据类型，即`std::string`

3.  这甚至是正确的方法吗？

# r - 以交互方式更改 selectInput 选项

> ID：16173325
> 
> 赞同：31
> 
> 时间：2013-04-23T15:26:24.457
> 
> 标签：r, search, user-interaction, shiny

最初我创建了这个带有参数“company id”和“date”的闪亮界面，但在这里我们遇到了一个问题：大多数人不知道他们的 id 与我们合作的公司，只知道他们的名字，即（McDonalds，Radioshack） .

所以我想理想地创建一个这样的搜索功能 ![在此处输入图像描述](https://i.stack.imgur.com/qkTxb.jpg)

我目前的想法是将包含我们所有合作伙伴公司的列表及其 ID 的表格传递给 global.R。然后传入 textInput 作为搜索变量并在服务器端执行搜索。但是，我迷失了如何将 searchResults 传递回 selectInput 面板上的 UI？

我当前的代码：

用户界面

```
library(shiny)

shinyUI(pageWithSidebar(

  sidebarPanel(

    textInput("nameSearch", "Or, Search for company name", 'McDonald'),
    selectInput("partnerName", "Select your choice", list( "searchResults" ),
    br(),
    submitButton("Update View"),
    br(),

  ), 
```

服务器.R

```
 shinyServer(function(input, output) {

  #subTable
  searchResult<- reactive({
    subset(partners, grepl(input$nameSearch, partners$name))
  })

  output$searchResults <- renderTable({ 
    searchResult[,1]
    }) 
```

全局.R

```
partners<- read.csv("partnersList.csv", fill=TRUE) 
```

合作伙伴列表就是这种格式

```
 name            id 
 ------------------
    McDonalds        1
    Wendy's          2
    Bestbuy          3 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-23T16:46:54.897

您需要使 UI 具有响应性。我还没有测试过这个（也错过了数据），但我认为应该可以工作。补充`server.R`：

```
output$selectUI <- renderUI({ 
selectInput("partnerName", "Select your choice", searchResult()[,1] ),
}) 
```

并将`ui.R`selectInput 替换为：

```
htmlOutput("selectUI") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-23T08:29:31.360

在 Shiny 0.8 版（我已经测试过）中，`server.R`添加以下内容：

```
shinyServer(function(input, output, session) {

  observe({
    # This will change the value of input$partnerName to searchResult()[,1]
    updateTextInput(session, "partnerName", 
                    label = "Select your choice", 
                    value = searchResult()[,1])
  })

}) 
```

现在里面的函数`shinyServer`有额外的参数`session`。

如果您不需要更改标签，您可以跳过它。

您无需更改`ui.R`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-25T17:26:26.177

来自 Rstudio 的 JC 的回复：

> 当然，只需使用 textInput 作为搜索字符串，并使用 renderUI/uiOutput 来制作动态 selectInput。然后你的代码的其余部分可以依赖于 selectInput 的值。（确保在读取 selectInput 值时检查 NULL 或其他内容，因为它会从没有值开始。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-16T11:10:16.433

如果我正确理解了这个问题，您需要做的就是向用户显示**公司名称**并将**公司 ID**传递给服务器。

我想这个功能在过去是不可用的（你必须按照上面的建议解决）但是现在 selectInput 函数中的参数选择完全接受命名列表来满足这个需要。希望下面的示例可以说明情况。

```
library(shiny)
library(tidyverse)

companies <- tribble(
    ~name, ~id,
    "McDonalds", 1,
    "Wendy's", 2,
    "Bestbuy", 3
)

ui <- fluidPage(
    uiOutput("select_company_ui"),
    textOutput("value")
)

server <- function(input, output) {
    output$select_company_ui <- renderUI({
        selectInput("select_company", "Select company", choices = deframe(companies))
    })

    output$value <- renderText(paste0("Value of the company filter is ", input$select_company))
}

# Run the application 
shinyApp(ui = ui, server = server) 
```

在这里您可以看到生成的应用程序：

[![在此处输入图像描述](https://i.stack.imgur.com/kBAtI.png)](https://i.stack.imgur.com/kBAtI.png)

旁注：为了方便起见，我使用包 tibble 中的函数 deframe 将 tibble 转换为命名列表，您可以通过编写来做到这一点

```
choices = c("McDonalds" = 1, "Wendy's" = 2, "Bestbuy" = 3) 
```

# java - 将过期的 SSL 证书导入 Java 密钥库

> ID：16173327
> 
> 赞同：1
> 
> 时间：2013-04-23T15:26:32.540
> 
> 标签：java, ssl, jmeter

我需要能够将 JMeter 指向具有过期 SSL 证书的测试服务器（我们需要一段时间才能更新它）。JMeter 在尝试连接时抛出异常是非常正确的：

```
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
    javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
    at sun.security.ssl.SSLSessionImpl.getPeerCertificates(Unknown Source)
    at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
    at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:572)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:180)
    at org.apache.http.impl.conn.ManagedClientConnectionImpl.open(ManagedClientConnectionImpl.java:294)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:640)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:479)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:906)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:805)
    at org.apache.jmeter.protocol.http.sampler.HTTPHC4Impl.sample(HTTPHC4Impl.java:284)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy.sample(HTTPSamplerProxy.java:62)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1075)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1064)
    at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:426)
    at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:255)
    at java.lang.Thread.run(Unknown Source) 
```

有谁知道我可以将所述证书导入密钥库并在此过程中更改到期日期（这甚至会有所帮助还是服务器证书已过期的事实仍会导致引发此异常）？

我试图将有效性设置为导入的一部分，但这被忽略了：

```
keytool -import ... -validity 100 
```

**PS** - 我知道我可以实现我自己的 TrustManager 忽略这些检查，但我的手指不允许我编写这种邪恶的代码，我更愿意得到一个无需修改 JMeter 就可以安装在服务器上的解决方案！

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:44:46.173

JMeter 不验证证书，因此这不是您的问题的原因。

您使用哪种实现，java、HC3 或 HC4？

您的问题可能来自 Socket 版本协商中的错误。尝试在 user.properties 中设置：

*   https.socket.protocols=SSLv2Hello SSLv3 TLSv1

根据您的服务器配置，您可能必须使用它们，例如只设置这个：

*   https.socket.protocols=SSLv3

# unicode - 散列时适合密码的 Unicode 规范化（和其他处理）是什么？

> ID：16173328
> 
> 赞同：17
> 
> 时间：2013-04-23T15:26:32.913
> 
> 标签：unicode, passwords, unicode-normalization, password-storage, homoglyph

如果我接受完整的 Unicode 密码，我应该如何在将字符串传递给哈希函数之前对其进行规范化？

## 目标

如果没有规范化，如果有人`ma\u00F1ana`在一台计算机`ma\u006E\u0303ana`上将他们的密码设置为“mañana”（这是在用户代理或其操作系统的控制之下。

*   我想确保这些哈希值相同。
*   我不关心诸如[Α、А 和 A](http://lab.brainonfire.net/whatchar/identify.php?data=%CE%91%D0%90A)（希腊语、西里尔语、拉丁语）之类的同形文字。

## 参考

Unicode 规范化形式：[http ://unicode.org/reports/tr15/#Norm_Forms](http://unicode.org/reports/tr15/#Norm_Forms)

## 注意事项

*   任何标准化过程都可能导致冲突，例如`"oﬃce" == "office"`。
*   规范化可以改变字符串中的字节数。

## 进一步的问题

*   如果服务器接收到无效的 UTF-8（或其他格式）的字节序列会发生什么？拒绝，因为它不能被规范化？
*   如果服务器接收到在其 Unicode 版本中未分配的字符会怎样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T15:26:32.913

在输入格式错误的情况下，规范化是未定义的，例如包含非法字节序列的所谓 UTF-8 文本。非法字节在不同的环境中可能会有不同的解释：拒绝、替换或遗漏。

**建议 #1**：如果可能，拒绝不符合预期编码的输入。（但是，这可能超出了应用程序的控制范围。）

当输入仅包含分配的字符时，Unicode 附件 15 保证规范化稳定性：

> 11.1 规范化形式的稳定性
> 
> 对于所有版本，甚至在 Unicode 4.1 之前，都遵循以下策略：
> 
> 规范化的字符串保证是稳定的；也就是说，一旦规范化，字符串就会根据所有未来的 Unicode 版本进行规范化。
> 
> 更准确地说，如果一个字符串已根据 Unicode 的特定版本进行了规范化，并且仅包含在该版本中分配的字符，则它将符合根据任何未来 Unicode 版本进行规范化的资格。

**建议#2**：无​​论使用哪种规范化形式，都必须使用[稳定字符串的规范化过程](http://unicode.org/reports/tr15/#Stabilized_Strings)，即拒绝任何包含未分配字符的密码输入，因为它们的规范化在服务器升级下不能保证稳定。

兼容性规范化形式似乎可以更好地处理日语，将几个分解分解为规范形式没有的相同输出。

规范警告：

> 规范化形式 KC 和 KD 不能盲目地应用于任意文本。因为它们消除了许多格式区别，它们将阻止往返于许多旧字符集的往返转换，除非被格式标记取代，否则它们可能会消除对文本语义很重要的区别。

但是，这里不关心语义和往返。

**建议 #3**：在散列之前应用 NFKC 或 NFKD。

# java - Listview 不会显示 stackmob 查询列表

> ID：16173334
> 
> 赞同：0
> 
> 时间：2013-04-23T15:26:39.750
> 
> 标签：java, android, android-listview, listadapter, stackmob

您好，我试图让 stackmob 向列表视图查询项目，除了出现在列表视图中的结果列表之外，一切正常，我尝试在整个互联网上进行搜索，但没有发现任何有效的结果。这是我使用 Log.i("Tagg", result.get(0).getAddress()); 时的代码 它完美地工作并显示地址，所以我不知道为什么它不会出现在列表视图中？

**结果Activity.java**

```
public class ResultsActivity extends ListActivity {

            double lon;
            double lat;
            ListAdapter adapter;
            List<RRData> RestR;
            @Override
            protected void onCreate(Bundle savedInstanceState) {
                super.onCreate(savedInstanceState);
                //setListAdapter(new ListAdapter(this, R.layout.resultslist, null));
                setListAdapter(adapter);
                Bundle extras = getIntent().getExtras();
                lon = extras.getDouble("Longitude");
                lat = extras.getDouble("Latitude");
                StackMobGeoPoint sarea = new StackMobGeoPoint(lon, lat);
                StackMobQuery q = new StackMobQuery().fieldIsNearWithinMi("location", sarea, 1110.0); //(lon, lat), distance (miles)
                RRData.query(RRData.class, q, new StackMobQueryCallback<RRData>() {
                      @Override
                      public void success(List<RRData> result) {
                          Log.i("Tagg", result.get(0).getAddress());
                          //adapter = new ListAdapter(ResultsActivity.this, R.layout.resultslist, result);
                          RestR = result;
                          ListAdapter adapter = new ListAdapter(ResultsActivity.this, R.layout.resultslist, RestR);

                        setListAdapter(adapter);
                        adapter.notifyDataSetChanged();
                      }

                      @Override
                      public void failure(StackMobException e) {
                          Log.i("TagError", e.getLocalizedMessage());
                      }
                  });
                setContentView(R.layout.activity_results);
            }

            @Override
            public boolean onCreateOptionsMenu(Menu menu) {
                // Inflate the menu; this adds items to the action bar if it is present.
                getMenuInflater().inflate(R.menu.activity_results, menu);
                return true;
            }

        } 
```

**RRData.java**

```
public class RRData extends StackMobModel {

    private String name;
    private StackMobGeoPoint location;
    private String Address;
    private String UserName;

    public RRData(String name, StackMobGeoPoint  location,String Address) {
        super(RRData.class);
        this.name = name;
        this.location = location;
        this.Address = Address;
    }
    public String getName() {
        return name;
    }
    public String getAddress(){
        return Address;
    }
    public void setName(String name){
        this.name = name;
    }
    public void setAddress(String address){
        this.Address = address;
    }
    public void setLocation(StackMobGeoPoint location){
        this.location = location;
    }
    public StackMobGeoPoint getLocation() {
        return location;
    }
} 
```

**ListAdapter.java** 公共类 ListAdapter 扩展 ArrayAdapter {

```
public ListAdapter(Context context, int textViewResourceId, List<RRData> tasks) {
    super(context, textViewResourceId, tasks);
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater)this.getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.resultslist, null);
    }
    RRData task = getItem(position);
    if (task != null) {
        ((TextView) v.findViewById(R.id.title)).setText(task.getName());
        ((TextView) v.findViewById(R.id.address)).setText(task.getAddress());
        ((TextView) v.findViewById(R.id.distance)).setText(task.getLocation().getQueryDistanceRadians().toString());
        this.notifyDataSetChanged();
    }
    return v;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T18:51:25.233

我为 StackMob 工作。

您的活动是 ListActivity 的子类，这要求您的布局包含一个 ID 为 @android:id/list 的 ListView。看起来您的 ListView 被称为结果列表；尝试更改名称。

有关更多信息，[请查看有关 ListViews 的本教程](http://www.vogella.com/articles/AndroidListView/article.html)。ListActivity 在第 3 节中介绍。

干杯，

卡尔

# java - 不使用文件的 Hadoop 自定义输入格式

> ID：16173337
> 
> 赞同：0
> 
> 时间：2013-04-23T15:26:41.193
> 
> 标签：java, hadoop, amazon-simpledb, elastic-map-reduce

我刚刚开始使用 Hadoop，我正在努力弄清楚如何使用不是文件的其他输入源，即从 AWS SimpleDB 读取所有行，或者从另一个系统上的 REST API 读取所有记录。一切在线仅显示如何处理文件或几个选定的数据库。

InputFormat 的 API 看起来相当复杂，所以我试图找出从任何非文件数据源读取数据的最快方法，然后可以使用 Amazon 的 Elastic MapReduce（基于 Hadoop）对其进行 MapReduce。我正在使用 JAVA 编写代码。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:11:05.537

“最快”的方法是使用一些数据聚合工具，如[Flume](http://flume.apache.org/)或[Chukwa](http://incubator.apache.org/chukwa/)。[你可以在这里](http://blog.cloudera.com/blog/2012/09/analyzing-twitter-data-with-hadoop/)找到一个关于如何使用 Twitter API 通过 Flume 收集 Twitter 数据的非常好的示例。它展示了如何使用 Flume 将 twitter 数据读入 Hadoop 集群，然后使用 Hive 对其进行处理。如果需要，您可以编写自己的 MR 作业来执行此操作。尝试为这些事情设计自定义 InputFormat 确实需要一些工作，我认为您不会在这方面找到太多帮助（除非有人已经这样做并准备与您分享）。

高温高压

# php - 尝试根据 $_GET 变量淡入隐藏的 div

> ID：16173342
> 
> 赞同：0
> 
> 时间：2013-04-23T15:26:57.237
> 
> 标签：php, javascript, jquery, jquery-animate

在用户单击删除链接后，我正在尝试使用 Jquery 显示一个确认框。单击删除链接时，它会将 post_id 发送到 url。只要设置了它并且它不为空，我就会触发动画，该动画将显示隐藏的确认框。

这是我目前没有工作的东西：

```
// if admin wants to delete a post check for post_id
if(isset($_GET['post_id']) && !empty($_GET['post_id'])){

    $delete_id = (int)$_GET['post_id'];
    $animate = true;

    echo '<script type="text/javascript">';
    echo 'var animate = '.$animate;
    echo '</script>';
} 
```

GET 变量设置正确。

在我的 jquery 文件中，我有：

```
$(document).ready(function(){
    if(animate == true){
        $("#delete_confirm").fadeIn('3000','swing');

    }
}); 
```

和确认框：

```
<div id="delete_confirm">
                <p>Please confirm you want to delete this post.</p>
                <input type="button" id="delete" name="delete" value="confirm" />
            </div> 
```

其中已`display:none;`在样式表中设置。

为什么`animate`变量设置为true时不显示？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:38:17.330

**更新：**

试试这个，测试和工作：

```
<?php

if(isset($_GET['post_id']) && !empty($_GET['post_id'])){
    $delete_id = (int)$_GET['post_id'];
    $animate = true;
}

?>
<html>
<head>
<title>Simulation</title>
</head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">

var prop = {
    animate: "<?php echo $animate; ?>"
};

$(document).ready(function(){

    if(prop.animate == 1){
        $("#delete_confirm").fadeIn('3000','swing');
    }

});
</script>
<body>
<div id="delete_confirm">
    <p>Please confirm you want to delete this post.</p>
    <input type="button" id="delete" name="delete" value="confirm" />
</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:55:17.507

您应该取消设置`display:none;`div 上的属性并`.fadeOut(0)`在页面加载时调用，或者`opacity:0.0;`在 CSS 文件中设置它。

此外，您可以使用`window.location`对象的`search`属性在客户端处理 GET 参数检查，然后检测是否使用正则表达式匹配设置了特定参数，而不是包括所有这些服务器端代码注入内容。这样您就不必使用任何内联 JavaScript。

```
var matches = window.location.search.match(/post_id/g);
if(matches && matches.length > 0)
{
// do animation
} else {
// do something else
} 
```

像这样的东西应该可以工作，而且我个人更喜欢这样做，而不是注入脚本标签和内联 JavaScript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:46:06.063

> php 检查是否设置了 GET 变量，如果是，则将 $animate 设置为 true。在此之后，Jquery 会检查 animate 变量，如果它设置为 true，那么应该会发生淡入淡出。

对我来说，这非常令人困惑。让我尝试对此进行更多研究。

*   您有一个带有确认框的页面。
*   当用户按下删除按钮时，确认框 ( `<div id="delete_confirm">`) 使用 jQuery 脚本显示。
*   用户按下页面上的“删除”按钮。这里会发生什么？有两种选择：
    *   你做 AJAX 请求。
    *   你做 HTTP GET 请求。

根据您的评论和代码，我可以猜测您执行 HTTP GET 请求。在这种情况下，您重新加载页面。是的，PHP 获得了正确的值，`$_GET['post_id']`并且帖子被删除。

但是你会得到全新的 HTML 页面。在这个页面上，div`<div id="delete_confirm">`从一开始就是不可见的。这就是它没有显示和隐藏的原因。

当您查看源代码时，您会发现您的 JS 脚本`<script type="text/javascript">...`，我请求代码也可以`$(document).ready(function(){...`正常工作。但是你在新加载的 HTML 页面上得到它。

如果我在这里弄错了，请纠正我。

我认为您想隐藏您可能想要使用 AJAX 的确认框。但是您可能还想通过更改页面从页面中删除帖子。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-23T15:51:40.470

~~引用 jQuery 文档：“ [.fadeIn() 方法为匹配元素的不透明度设置动画。](http://api.jquery.com/fadeIn/) ”~~

.fadeIn() 将有效地将元素的 css 不透明度从 0 更改为 1。

~~您已经说过，在 CSS 中，您的元素具有`display: none;`因此您实际上所做的只是将不透明度从`1`（假设您没有在 CSS 中设置）更改为`1`同时将显示设置为`none`... 所以它会永远不会显示。~~

这似乎适用于`.animate()`which**不允许**您“动画”显示类型（从“none”到“block” - 您将使用 opacity）......但不适用于`.fadeIn()`/ `.fadeOut()`which**确实**允许您淡化一个块使用 CSS`display`属性输入/输出。

我的错，我混淆了两者。

# c# - StatusBar 中的 WPF ProgressBar 不会拉伸

> ID：16173343
> 
> 赞同：4
> 
> 时间：2013-04-23T15:27:06.173
> 
> 标签：c#, wpf, progress-bar, statusbar

WPF 新手，我有以下 XAML

```
<Window x:Class="Wpf.RossKiosk.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Topmost="True" WindowStartupLocation="CenterScreen" WindowState="Maximized" ResizeMode="NoResize" WindowStyle="None">
<DockPanel LastChildFill="True">

    <StatusBar Name="StatusBarMain" Height="30"  DockPanel.Dock="Bottom">
        <StatusBarItem HorizontalContentAlignment="Left">
            <TextBlock x:Name="TextBlockStatus" Margin="5,0,0,0" />
        </StatusBarItem>
        <StatusBarItem HorizontalContentAlignment="Stretch">
            <ProgressBar x:Name="ProgressBarMain" IsIndeterminate="True" Height="15" />
        </StatusBarItem>
        <StatusBarItem HorizontalContentAlignment="Right">
            <TextBlock x:Name="TextBlockInfo" Margin="5,0,0,0" TextAlignment="Right" />
        </StatusBarItem>
    </StatusBar>

    <Grid Name="GridMain">

        <!-- Dynamically Created buttons -->

    </Grid>

</DockPanel> 
```

我希望 ProgressBar 填充 StatusBar 的中心部分，但它只显示几个像素的宽度。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T15:43:43.863

这是由于默认情况下`StatusBar`使用 a`DockPanel`来布置其子级。请[在此处](https://stackoverflow.com/questions/1373529/how-do-i-customize-the-wpf-statusbar-layout/1373531#1373531)查看我的问题和答案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-23T15:42:45.190

您将需要使用网格。DockPanel 或 StackPanel 不足以满足您的需求。尝试：

```
 <Grid>
    <StatusBar Name="StatusBarMain" Height="30" HorizontalAlignment="Stretch">
    <StatusBarItem HorizontalContentAlignment="Left">
        <TextBlock x:Name="TextBlockStatus" Margin="5,0,0,0" />
    </StatusBarItem>
    <StatusBarItem HorizontalContentAlignment="Stretch">
        <ProgressBar x:Name="ProgressBarMain" IsIndeterminate="True" Height="15" />
    </StatusBarItem>
    <StatusBarItem HorizontalContentAlignment="Right">
        <TextBlock x:Name="TextBlockInfo" Margin="5,0,0,0" TextAlignment="Right" />
    </StatusBarItem>
   </StatusBar>
    </Grid> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T16:48:17.557

这对我有帮助，但我需要添加网格行和列定义以使其正常工作。

```
<Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Height="Auto" ToolTip="abc213">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
        </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"></ColumnDefinition> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-07-23T18:14:14.243

这会将进度条拉伸到其容器

```
<StatusBarItem  Name="progressBarContainer">
    <ProgressBar Height="{Binding ElementName=progressBarContainer, Path=ActualHeight}" Width="{Binding ElementName=progressBarContainer, Path=ActualWidth}" Value="50" />
</StatusBarItem> 
```

# javascript - 如何在 CodeKit 中禁用 JavaScript Minifier？

> ID：16173344
> 
> 赞同：7
> 
> 时间：2013-04-23T15:27:13.583
> 
> 标签：javascript, codekit

在 CodeKit 中禁用 JavaScript 缩小的最佳方法是什么？它创建的所有这些`*-ck.js`文件都弄乱了我们存储库的子模块。

请注意，添加规则`.gitignore`不起作用，因为它的规则不被子模块继承。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-13T14:50:06.250

我相信菜单已经更新，但 immo 的答案仍然有效。在 Javascript 语言设置下，您可以单击输出样式的下拉菜单并将其从缩小到非缩小。

![在此处输入图像描述](https://i.stack.imgur.com/Cmkb6.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T10:52:11.640

在 CodeKit Preferences 中选择 Languages / JavaScript 以编辑 JavaScript 处理的默认设置。（可以为项目中的每个文件覆盖这些。）

将第二个处理步骤（标记为“然后：”）的设置从“连接 + minifiy”更改为“连接导入的文件”。对于项目中已经存在的任何脚本文件，检查它是否已经具有与这个新默认值不同的单独设置。

在这种情况下，`*-ck.js`只有在源文件导入另一个用于连接而不是普通脚本文件的情况下，才应创建“”-文件。

或者，您可以在 CodeKit Preferences / JavaScript / Output Paths 中为生成的 ck-Files 指定不同的输出路径，以免生成的文件弄乱源目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:45:07.597

`codekit-ignore`一种解决方法是将输出路径设置为类似于**Preferences** > **JavaScript** > **Output Paths**，相对于项目的根文件夹。

然后添加`/codekit-ignore`到`.gitignore`.

易于清理，感觉比`find . -iregex '.*-ck\.js' -delete`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-03T20:32:57.330

在首选项中，请参阅“常规”下的“跳过的项目”并将 *.js 添加到列表中。

![在此处输入图像描述](https://i.stack.imgur.com/3meg5.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-17T17:50:10.357

**有几种方法可以在Code Kit**中停止 javascript 缩小，但最简单和最简单的方法是在文件视图中导航到您不希望缩小的 javascript 文件，并将 Javascript 选项配置到右侧。

这种方法提供了诸如 JSHint 和 JSLint 之类的好处，而无需缩小，并且可以逐个站点、逐个文件地配置，从而为您提供更大的控制权。

如果您有任何进一步的问题，请告诉我，我很乐意提供帮助。

[![CodeKit：JavaScript 选项](https://i.stack.imgur.com/JttoO.png)](https://i.stack.imgur.com/JttoO.png)

# sql - 这种数据转换的最佳方法

> ID：16173345
> 
> 赞同：2
> 
> 时间：2013-04-23T15:27:15.210
> 
> 标签：sql, sql-server-2008-r2, data-mining, teradata

为了简单，我正在简化现实......

我有一张包含数百万个温度观测值的表：ObservationID、LocationID、Observation_Date、Temperature

我想写一个查询，但还要派生其他列，

ObservationID, LocationID, Observation_Date, Temperature, Temperature_At_Last_Observation, Temperature_2_observations_ago, Temperature_3_observations_ago, Temperature_4_observations_ago, ..etc..

实际上，这要复杂得多，而且我的表中确实有数百万行。所以我想知道*哪种方法最有效*。

我是否从递归的角度来攻击这个？或者因为我每行至少有 15 个新列，这是否意味着递归效率低下？

还是我坚持使用基于集合的方法，将观察结果划分为排序顺序，然后加入 LocationID？

有什么建议么？

幸运的是，我还可以选择将数据加载到 Teradata 平台或 SQL Server 2008R2 平台。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T19:58:02.677

坚持使用基于 SET 的方法。

在 SQL Server 中，请考虑将 LEAD() 和 LAG() 与 Window Aggregate 函数一起使用。

在 Teradata 中，您可以使用结合 ROW BETWEEN n PRECEDING 和 n PRECEDING 的窗口聚合函数来回溯“n”行。

有关 Teradata 中的示例，请查看对“[比较表中的 3 个连续行](https://stackoverflow.com/questions/13095338/compare-3-consecutive-rows-in-a-table/13110412#13110412)”问题的响应。

# python - 从包含许多元素的列表中删除重复项

> ID：16173347
> 
> 赞同：1
> 
> 时间：2013-04-23T15:27:16.940
> 
> 标签：python, python-2.x

我有一个包含多个元素的列表，我想删除重复的，这是一个列表示例：

```
list = [{'status': 'OK', 'mid': '6639'}, {'status': 'OK', 'mid': '6639'}, {'status': 'OK', 'mid': '6640'}, {'status': 'OK', 'mid': '6640'}, {'status': 'OK', 'mid': '6641'}, {'status': 'OK', 'mid': '6641'}, {'status': 'OK', 'mid': '6642'}, {'status': 'OK', 'mid': '6643'}] 
```

* * *

我试图使用函数集，但我有一个错误，它说列表是不可散列的，有人知道如何删除重复项吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:31:15.640

您仍然可以使用 a`set()`但您需要将每个列表变成一个元组；在这里，我们使用键和值的排序元组来准确查找重复项：

```
set(tuple(sorted(el.items())) for el in somelist) 
```

要保持列表有序并保持字典完整，您可以使用：

```
seen = set()
seen_add = seen.add
[x for x in somelist if tuple(sorted(x.items())) not in seen and not seen_add(tuple(sorted(x.items())))] 
```

后者的演示：

```
>>> seen = set()
>>> seen_add = seen.add
>>> [x for x in somelist if tuple(sorted(x.items())) not in seen and not seen_add(tuple(sorted(x.items())))]
[{'status': 'OK', 'mid': '6639'}, {'status': 'OK', 'mid': '6640'}, {'status': 'OK', 'mid': '6641'}, {'status': 'OK', 'mid': '6642'}, {'status': 'OK', 'mid': '6643'}] 
```

# opengl - 组织 VBO 并优化对 glDrawArrays() 的调用

> ID：16173351
> 
> 赞同：3
> 
> 时间：2013-04-23T15:27:19.623
> 
> 标签：opengl

我试图找出 OpenGL 中不同技术的优缺点。我正在阅读的教程表明渲染大量 VBO 会影响性能，我推断一种方法可能是将多个对象存储在单个 VBO 中。

关于如何/为什么组织和呈现数据有什么好的经验法则吗？对于现代电子游戏，例如“现代战争”，如果我正在看一个具有天空背景、几座静态建筑物、大量碎片和 10 个 NPC 的场景，你认为他们创造了多少 VBO，你认为他们打了多少次 glDrawArrays() 电话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:39:24.617

绘图调用不是最昂贵的东西。我相信每帧有 100 到 1000 个绘制调用是很常见的。

性能的一个重要方面是减少状态变化。IIRC 程序更改 > 纹理更改 > 缓冲区更改。对您的绘图调用进行排序，以便尽可能少地切换内容。

使用一个大型 VBO 而不是几个较小的 VBO 可能对性能有益，但可能不是我尝试的第一件事。

# sql-server-2008 - SQL Server 2008中如何编写基于姓名、企业名、大学名进行搜索的搜索存储过程

> ID：16173361
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:27:56.153
> 
> 标签：sql-server-2008

我想根据姓名、企业名称、大学名称、技能名称搜索表格。

假设我将按名称搜索一次，按企业名称搜索，再次按大学名称搜索，但是当我输入名称时，我单击搜索按钮我会显示正确。但是，当我输入企业名称或大学名称时，我无法正确输入企业名称列，就像 null 一样。

我写了一个这样的存储过程：

```
ALTER PROCEDURE [dbo].[SearchPeople_test]
(
      @FirstName nvarchar(255),
      @Location nvarchar(100),
      @MembershipUserID uniqueidentifier,
      @UniversityName nvarchar(255),
      @Postcode nvarchar(20),
      @BusinessName nvarchar(255),
      @AssociateMemberID uniqueidentifier,
      @SkillName nvarchar(255),
      @Debits int,
      @Gender int
  )
AS
BEGIN

    SET @SkillName = [dbo].[fnGetMemberskills](@AssociateMemberID)
    SET @Debits = [dbo].[fnGetMembersSpentCredits](@AssociateMemberID)
    SET NOCOUNT ON;

SELECT  DISTINCT  AssociateMember.ID AS ID       
        ,AssociateMember.Firstname AS FirstName        
        ,AssociateMember.Lastname AS LastName
        ,Address.Location AS Location
        ,Address.City AS City
        ,BusinessProfile.BusinessName
        ,EducationHistory.UniversityName
        ,AssociateMember.MembershipUserID AS MembershipUserID
        ,EmploymentHistory.JobTitle AS JobTitle
        ,AssociateMember.MemberPhotoUrl AS MemberPhotoUrl
        ,aspnet_Membership.Email AS Email
        ,AssociateMemberJourneyContent.JourneyContent AS JourneyContent
        ,([dbo].[fnGetMemberskills](AssociateMember.ID))  AS MemberSkillList
        ,([dbo].[fnGetMembersSpentCredits](AssociateMember.ID))  AS Debits              
FROM 
    AssociateMember 
INNER JOIN
    aspnet_Membership 
    ON AssociateMember.MembershipUserID=aspnet_Membership.UserId 
left outer join  MemberAddressLink      
    ON AssociateMember.ID=MemberAddressLink.MemberID

left outer join
    Address 
    ON Address.ID=MemberAddressLink.AddressID 

left outer join 
    EmploymentHistory 
    ON AssociateMember.ID=EmploymentHistory.MemberID     

left outer join   
    EducationHistory 
    ON EducationHistory.MemberID=AssociateMember.ID 

left outer join  
    MemberEmploymentHistory 
    ON AssociateMember.ID=MemberEmploymentHistory.MemberID

left outer join 
    BusinessProfile 
    ON BusinessProfile.ID=MemberEmploymentHistory.BusinessProfileID 

left outer join
    MemberSkill 
    ON MemberSkill.MemberID=AssociateMember.ID

left outer join 
    SkillType 
    ON SkillType.ID = MemberSkill.SkillID AND MemberSkill.MemberID=AssociateMember.ID
left outer join
    AssociateMemberJourneyContent
    ON AssociateMember.ID=AssociateMemberJourneyContent.AssociateMemberID

where
((Address.Location)=ISNULL(@Location,Address.Location) and (MemberAddressLink.IsDefault=1)
                 OR (Address.Location like '%'+ @Location+'%')or (Address.Location is null) ) and

 (AssociateMemberJourneyContent.JourneyContentTypeID=1 OR  AssociateMemberJourneyContent.JourneyContentTypeID IS NULL) AND

(((BusinessProfile.BusinessName)=ISNULL(@BusinessName,BusinessProfile.BusinessName) 
                             OR (BusinessProfile.BusinessName like '%'+@BusinessName+'%')or(BusinessProfile.BusinessName is null))
                              AND
                             ((MemberEmploymentHistory.StartDate)=(SELECT  MAX(StartDate) FROM MemberEmploymentHistory 
WHERE MemberEmploymentHistory.MemberID=AssociateMember.ID) OR (MemberEmploymentHistory.StartDate IS NULL))) AND

((AssociateMember.Firstname)=ISNULL(@FirstName,AssociateMember.Firstname) 
                          OR (AssociateMember.Firstname like '%'+@FirstName+'%')OR (AssociateMember.Firstname IS NULL)) AND 

((Address.Postcode)=ISNULL(@Postcode,Address.Postcode) 
                 OR (Address.Postcode like '%'+@Postcode+'%') OR (Address.Postcode IS NULL)) AND

(((EducationHistory.UniversityName)=ISNULL(@UniversityName,EducationHistory.UniversityName) 
                OR (EducationHistory.UniversityName like '%'+@UniversityName+'%') OR (EducationHistory.UniversityName IS NULL)) AND
            ((EducationHistory.StartDate)=(SELECT  MAX(StartDate) FROM EducationHistory 
WHERE EducationHistory.MemberID=AssociateMember.ID) OR (EducationHistory.StartDate IS NULL) ))AND

((AssociateMember.GenderID)=ISNULL(AssociateMember.GenderID,@Gender) 
                          OR (AssociateMember.GenderID IS NULL)) AND

((EmploymentHistory.StartDate)=(SELECT MAX(StartDate) FROM EmploymentHistory 
WHERE EmploymentHistory.MemberID=AssociateMember.ID)OR (EmploymentHistory.StartDate IS NULL)   ) 
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:51:51.943

与其试图一次性完成所有操作，不如将其分解，首先在列上编写查询，然后运行它。然后做下一个，运行它。等然后最后结合两个查询，运行，结合 3 个查询运行等。如果在任何时候你没有得到你期望的，分析你在做什么。

# java - OpenCV作为JBoss-作为全局模块

> ID：16173362
> 
> 赞同：5
> 
> 时间：2013-04-23T15:27:58.007
> 
> 标签：java, opencv, jboss, java-native-interface

# 问题介绍

我尝试将 OpenCV 安装为 JBoss-as 实例的全局模块。版本是：

*   JBoss-as：7.1.1 最终版
*   OpenCV：2.4.5（编译时支持 Java）

我从全新安装的 Ubuntu Server 12.04 64 位开始，只安装了 JBoss-as 和 OpenCV。

# 前言

OpenCV java 包装器使用 JNI 调用。因此需要两件事：

*   opencv-245.jar
*   libopencv_java245.so

并且可用于`/usr/share/OpenCV/java/`（关于安装）

我还指出一些观察：

1.  JBoss 的安装正确（应用程序可以部署并且正在运行）
2.  java支持的OpenCV的编译和安装是正确的（使用OpenCV的Java类正在工作）
3.  使用 OpenCV 并使用 maven 部署在 JBoss-as 上的基本 Web 应用程序（在`opencv-245.jar`中列为依赖项`pom.xml`，因此打包到 中`war`）

# 问题描述

一旦我将 OpenCV 定义为 JBoss 全局模块（`<scope>provided</scope>`在 pom.xml 中设置），就会引发此异常：

```
java.lang.UnsatisfiedLinkError: org.opencv.core.Mat.n_Mat()J
    org.opencv.core.Mat.n_Mat(Native Method)
    org.opencv.core.Mat.<init>(Mat.java:441)
    WS.printMessage(WS.java:15)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:616)
    org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:155)
    org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:257)
    org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:222)
    org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:211)
    org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:525)
    org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:502)
    org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119)
    org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher.java:208)
    org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55)
    org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:847) 
```

似乎`jar`找到了 OpenCV 库，因为它引发了异常。它也不会抱怨找不到某些库，例如（取自最后的第一个链接）：

```
java.lang.UnsatisfiedLinkError: no xxxx in java.library.path 
```

因此我想这`libopencv_java245.so`不是问题。精确的配置如下所述。

# 配置

我在以下位置定义了`org.opencv`模块`modules/org/opencv/main/module.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.0" name="org.opencv">
    <resources>
        <resource-root path="opencv-245.jar"/>
    </resources>
    <dependencies>
        <module name="javax.api"/>
    </dependencies>
</module> 
```

然后我放入同一个文件夹`opencv-245.jar`和子文件夹`libopencv_java245.so`中`lib/linux-x86_64/`（如[Native Library](https://docs.jboss.org/author/display/MODULES/Native+Libraries)中所述）

要将这个模块定义为全局，我修改了`standalone/configuration/standalone.xml`：

```
<subsystem xmlns="urn:jboss:domain:ee:1.0">
    <global-modules>
        <module name="org.opencv" slot="main"/>
    </global-modules>
</subsystem> 
```

最后使用我设置的全局模块`src/main/webapp/WEB-INF/jboss-deployment-structure.xml`：

```
<jboss-deployment-structure>
    <deployment>
        <dependencies>
            <module name="org.opencv" />
        </dependencies>
    </deployment>
</jboss-deployment-structure> 
```

我还提醒我已经放入`<scope>provided</scope>`了我的 maven `pom.xml`。

另外，放：

```
System.loadLibrary("opencv_java245"); 
```

或不在代码中不会改变任何东西。

# 额外的观察

我还注意到，对于`ear`由 one`war`和 one组成的应用程序`jar`，即使“序言”中第 3 点中描述的程序也不起作用，并给出与上述相同的异常。也许这些信息可以提供帮助。

有人有一些指示或解决方案吗？

# 相关问题

*   [JBOSS 7.1.1 中 DLL 的路径设置](https://stackoverflow.com/questions/12775827/path-setting-for-dlls-in-jboss-7-1-1)
*   [JBoss 7 正在尝试从 JBoss bin 加载模块库](https://stackoverflow.com/questions/12896950/jboss-7-is-trying-to-load-modules-libraries-from-jboss-bin)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-26T08:53:26.273

我终于解决了问题并在这里写下答案以帮助其他人。

问题不在于路径`libopencv_java245.so`，而在于 JBoss 类加载器。

对于序言第 3 点中描述的情况（有效），加载文件的 ClassLoader 与加载相同`war`（嵌入`opencv-245.jar`到包含此方法调用的类。所有都对同一个 ClassLoader 产生影响，并且一切正常。`war``System.loadLibrary("opencv_java245")`

现在它没有`ear`跟进的原因是一个`ear`有自己的类加载器，然后每个子部署都作为另一个子部署。第一个 ClassLoader 部署`ear`包含`opencv-245.jar`依赖项`war`的`ear`. 因为调用`System.loadLibrary("opencv_java245")`是在 中`war`，所以这个命令的效果对 的 ClassLoader 有影响`war`，但是`opencv-245.jar`是加载到`ear`ClassLoader 中的。因此，当尝试调用本机库时，java 找不到链接，因为它们位于不同的 ClassLoader 上。

最后，这里的兴趣点是 JBoss 模块。当描述我最初问题中配置的模块时，这是一个高级 JBoss ClassLoader，它加载`opencv-245.jar`. ClassLoader 还将自动知道在哪里搜索本地库：在`$MODULE_PATH/lib/linux-x86_64/`. 但问题是加载库。调用`System.loadLibrary("opencv_java245")`必须在已收费的同一个 ClassLoader 中完成`opencv-245.jar`。因此，不可能在您的代码中加载这样的库：

```
static {
    System.loadLibrary("opencv_java245");
} 
```

因为它会对加载你的类的 ClassLoader 产生影响，而不是对 JBoss 产生影响。解决方案是修改`opencv-245.jar`并添加一个`org.opencv.core.Loader`类，例如，它只有一个方法：

```
package org.opencv.core

class Loader
{
    public static void loadLibrary(String name)
    {
        System.loadLibrary(name);
    }
} 
```

然后在你的课堂上你可以放：

```
static {
    Loader.loadLibrary("opencv_java245");
} 
```

并且`System.loadLibrary`被放置的调用`opencv-245.jar`将对加载`opencv-245.jar`. 然后本地调用被正确链接，因为库`jar`和`so`都加载在同一个 ClassLoader 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-08T16:05:32.343

如果您使用 OpenCV（org.openpnp 包）3.4.2+ 而不是：

```
System.loadLibrary(Core.NATIVE_LIBRARY_NAME); 
```

您可以使用：

```
OpenCV.loadLocally(); 
```

我正在使用 jboss wildfly，并且在进行多次部署时遇到问题。本机类已经加载，但这解决了问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:36:19.213

将 libopencv_java245.so 文件添加到您为 OpenCV 模块创建的同一目录中。然后将其添加为资源，以便将其添加到类路径并在运行时可用。

所以你的 module.xml 现在看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<module xmlns="urn:jboss:module:1.0" name="org.opencv">
    <resources>
        <resource-root path="opencv-245.jar"/>
        <resource-root path="."/>
    </resources>
    <dependencies>
        <module name="javax.api"/>
    </dependencies>
</module> 
```

# ruby-on-rails - 控制器中未定义的方法“unread_messages”

> ID：16173364
> 
> 赞同：0
> 
> 时间：2013-04-23T15:28:08.320
> 
> 标签：ruby-on-rails

我正在为我的收件箱消息系统处理未读文件夹。我在转到 /users/1/messages?mailbox=unread 时收到了一个未定义的方法“unread_messages”，它指向消息控制器。但是我在 user.rb 中定义了 unread_messages 以便它在收件箱中显示未读消息，所以我假设代码也应该适用于未读文件夹。任何帮助，将不胜感激。

用户.rb：

```
class User < ActiveRecord::Base
  has_secure_password
  attr_accessible :role, :age, :age_end, :password_confirmation, :about_me, :feet, :inches, :password, :birthday, :career, :children, :education, :email, :ethnicity, :gender, :height, :name, :password_digest, :politics, :religion, :sexuality, :user_drink, :user_smoke, :username, :zip_code
  validates_uniqueness_of :email
  validates_format_of :email, with: /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i
  validates_presence_of :password, :on => :create
  has_many :galleries
  has_many :photos, :through => :galleries
  before_create { generate_token(:auth_token) }
  ROLES = %w[admin user guest banned]

  # models/user.rb
  after_create :setup_gallery

  def received_messages
      Message.received_by(self)
    end

 def unread_messages?
   unread_message_count > 0 ? true : false
 end

 def sent_messages
   Message.sent_by(self)
 end

 # Returns the number of unread messages for this user
 def unread_message_count
   eval 'messages.count(:conditions => ["recipient_id = ? AND read_at IS NULL", self.user_id])'
 end

  def to_s; username
  end

  def has_role?(role_name)
    role.present? && role.to_sym == role_name.to_sym
  end

  def send_password_reset
    generate_token(:password_reset_token)
    self.password_reset_sent_at = Time.zone.now
    save!
    UserMailer.password_reset(self).deliver
  end

  def generate_token(column)
    begin
      self[column] = SecureRandom.urlsafe_base64
    end while User.exists?(column => self[column])
  end

  private
  def setup_gallery
     self.galleries << Gallery.create
   end
end 
```

消息控制器：

```
 def index
    if params[:mailbox] == "sent"
      @messages = @user.sent_messages
    elsif params[:mailbox] == "inbox"
      @messages = @user.received_messages
    #elsif params[:mailbox] == "archieved"
     # @messages = @user.archived_messages
    end
    if params[:mailbox] == "unread"
    @messages = @user.unread_messages
  end
  end

  def new
    @message = Message.new
    if params[:reply_to]
      @reply_to = User.find_by_user_id(params[:reply_to])
      unless @reply_to.nil?
        @message.recipient_id = @reply_to.user_id
      end
    end
  end

  def create
    @message = Message.new(params[:message])
    @message.sender_id = @user.id
    if @message.save
      flash[:notice] = "Message has been sent"
      redirect_to user_messages_path(current_user, :mailbox=>:inbox)
    else
      render :action => :new
    end
  end

  def show
     @message = Message.find(params[:id])
     @message.readingmessage if @message.recipient == current_user
   end

   def destroy
     @message = Message.find(params[:id])
     @message.destroy
     flash[:notice] = "Successfully deleted message."
     redirect_to user_messages_path(@user, @messages)
   end

  def delete_multiple
      if params[:delete]
        params[:delete].each { |id|
          @message = Message.find(id)
          @message.mark_message_deleted(@message.id,@user.id) unless @message.nil?
        }
        flash[:notice] = "Messages deleted"
      end
      redirect_to user_messages_path(@user, @messages)
  end

  private
    def set_user
      @user = current_user
    end
end 
```

消息.rb：

```
attr_accessible :subject, :body, :sender_id, :recipient_id, :read_at,:sender_deleted,:recipient_deleted
validates_presence_of :subject, :message => "Please enter message title"

belongs_to :sender,
:class_name => 'User',
:foreign_key => 'sender_id'
belongs_to :recipient,
:class_name => 'User',
:foreign_key => 'recipient_id'

# marks a message as deleted by either the sender or the recipient, which ever the user that was passed is.
# When both sender and recipient marks it deleted, it is destroyed.
def mark_message_deleted(id,user_id)
     self.sender_deleted = true if self.sender_id == user_id
     self.recipient_deleted = true if self.recipient_id == user_id
     (self.sender_deleted && self.recipient_deleted) ? self.destroy : self.save!
 end
# Read message and if it is read by recipient then mark it is read
def readingmessage
  self.read_at ||= Time.now
  save
end

# Based on if a message has been read by it's recipient returns true or false.
def read?
    self.read_at.nil? ? false : true
end

def self.received_by(user)
   where(:recipient_id => user.id)
 end

 def self.not_recipient_deleted
   where("recipient_deleted = ?", false)
 end

 def self.sent_by(user)
    Message.where(:sender_id => user.id)
  end

end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:38:50.263

首先，您已经定义了`unread_messages?`方法，而不是`unread_messages`

其次，你不应该`? :`在`unread_messages?`方法中使用：

```
unread_messages_count > 0 
```

足够的。

`unread_messages`您应该在您的用户模型中定义方法。我无法在此方法中显示内部代码，因为我不知道您的模型关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:39:25.417

你定义了

```
unread_messages? # note the question mark 
```

然后将其称为

```
@user.unread_messages # no question mark 
```

你可能想要一个方法

```
def unread_messages ## which holds the actual unread messages and does not return boolean 
```

# xml - Aptana XML 验证

> ID：16173366
> 
> 赞同：2
> 
> 时间：2013-04-23T15:28:11.440
> 
> 标签：xml, validation, aptana

我希望 Aptana 对 xml 文件（不是 html，该文件没有 DTD）执行基本语法验证。

目前它没有，尽管它会正确识别匹配的开始和结束标签并将它们突出显示为一对，因此显然正在进行一些文件处理。

请告诉我我遗漏了一些明显的东西！

xmllint 将正确识别未丢失的标签、未识别的标签等。

Aptana Studio 3，内部版本：3.4.0.201304151603 操作系统：Linux Mint 14

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:35:44.063

我会把我的评论作为答案，这样我们就不会让这个问题四处奔波，看起来没有答案。

Ctrl + Shift + V 是 XML 验证的快捷方式，也可以在 Commands > XML > Validate Syntax 下找到。

# java - 带有日历的 TimeZone 令人困惑的结果

> ID：16173374
> 
> 赞同：4
> 
> 时间：2013-04-23T15:28:36.727
> 
> 标签：java, timezone

我最近一直在处理时区转换，并且对我得到的结果感到非常惊讶。基本上，我想将日期从一个时区转换为另一个时区。下面是代码，转换工作正常，但我在调试时观察到的是，除非我打电话，否则日期不会转换`Calendar#get(Calendar.FIELD)`。

```
 private static void convertTimeZone(String date, String time, TimeZone fromTimezone, TimeZone toTimeZone){
        Calendar cal = Calendar.getInstance(fromTimezone);
        String[] dateSplit = null;
        String[] timeSplit = null;
        if(time !=null){
            timeSplit = time.split(":");
        }
        if(date!=null){
            dateSplit = date.split("/");
        }
        if(dateSplit !=null){
            cal.set(Calendar.DATE, Integer.parseInt(dateSplit[0]));
            cal.set(Calendar.MONTH, Integer.parseInt(dateSplit[1])-1);
            cal.set(Calendar.YEAR, Integer.parseInt(dateSplit[2]));
        }
        if(timeSplit !=null){
            cal.set(Calendar.HOUR_OF_DAY, Integer.parseInt(timeSplit[0]));
            cal.set(Calendar.MINUTE, Integer.parseInt(timeSplit[1]));

        }
//      System.out.println("Time in " + fromTimezone.getDisplayName() + " : " + cal.get(Calendar.DATE) +"/"+ (cal.get(Calendar.MONTH)+1)+"/"+ cal.get(Calendar.YEAR) +" " + ((cal.get(Calendar.HOUR_OF_DAY)<10) ? ("0"+cal.get(Calendar.HOUR_OF_DAY) ): (cal.get(Calendar.HOUR_OF_DAY)))
//              +":" + (cal.get(Calendar.MINUTE)<10 ? "0"+cal.get(Calendar.MINUTE) : cal.get(Calendar.MINUTE)) );
        cal.setTimeZone(toTimeZone);
        System.out.println("Time in " + toTimeZone.getDisplayName() + " : " + cal.get(Calendar.DATE) +"/"+ (cal.get(Calendar.MONTH)+1)+"/"+ cal.get(Calendar.YEAR) +" " + ((cal.get(Calendar.HOUR_OF_DAY)<10) ? ("0"+cal.get(Calendar.HOUR_OF_DAY) ): (cal.get(Calendar.HOUR_OF_DAY)))
                +":" + (cal.get(Calendar.MINUTE)<10 ? "0"+cal.get(Calendar.MINUTE) : cal.get(Calendar.MINUTE)) );
}

public static void main(String[] args) throws ParseException {

        convertTimeZone("23/04/2013", "23:00", TimeZone.getTimeZone("EST5EDT"), TimeZone.getTimeZone("GB"));
    } 
```

**预期输出：** `Time in Greenwich Mean Time : 24/4/2013 04:00`

**当我评论 sysout 1 时得到的输出：** `Time in Greenwich Mean Time : 23/4/2013 23:00`

如果我取消注释 sysout1 我得到预期的有效输出。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:43:49.650

在真正需要之前，不会评估给定日期的内部表示，即直到您尝试通过这些 getter 访问它。然而，解析日期的最佳方式是通过 SimpleDateFormat。

* * *

**编辑**（添加以总结下面的评论并更好地澄清我的答案）。

日历以这种方式工作以提高效率：每次调用 setter 时都不会重新计算，而是等到调用 getter 时才重新计算。

Calendar 应该主要用于日期计算（请参阅[`add()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#add%28int,%20int%29)和[`roll()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#roll%28int,%20int%29)），但您将它用于解析和格式化：这些任务最好使用 SimpleDateFormat 完成，这就是为什么我说您对 Calendar 的使用并不优雅。

看这个例子：

```
private static void convertTimeZone(String date, String time,
            TimeZone fromTimezone, TimeZone toTimeZone) throws ParseException {
    SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy HH:mm");
    df.setTimeZone(fromTimezone);
    Date d = df.parse(date + " " + time);
    df.setTimeZone(toTimeZone);
    System.out.println("Time in " + toTimeZone.getDisplayName() + " : " +
                       df.format(d));
} 
```

我只使用 SimpleDateFormat 重新实现了您的方法。我的方法更小，没有拆分逻辑（隐藏在 中`parse()`），输出处理也更简单。此外，日期格式以紧凑和标准的方式表示，可以使用 ResourceBundle 轻松国际化。

另请注意，时区转换只是一项格式化任务：解析日期的内部表示**不会**改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:58:17.173

答案在[以下评论部分中得到了`setTimeZone()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Calendar.java#Calendar.setTimeZone%28java.util.TimeZone%29)部分解释：

> *考虑调用顺序： cal.setTimeZone(EST); cal.set(HOUR, 1); cal.setTimeZone(PST)。cal 设置为 1 点 EST 还是 1 点 PST？答案：太平洋标准时间。更一般地，对 setTimeZone() 的调用会影响对 set() 之前和之后的调用，直到下一次调用 complete()。*

换句话说，序列

1.  设置日历时间
2.  更改时区

被解释为“在这个新时区使用这个时间”，而序列

1.  设置日历时间
2.  获得时间（或其中的一部分）
3.  更改时区

将被解释为“在旧时区使用此时间，然后更改它”。

因此，在您的情况下，要获得您希望的行为，您需要在更改时区之前调用 或内部`get()`调用的任何其他方法。`complete()``Calendar`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:47:23.967

您是否仅限于使用 TimeZone 和 Calendar？如果不是，我建议使用出色的 Library [JodaTime](http://joda-time.sourceforge.net/)，它可以更轻松地处理时区。

您的示例将如下所示：

```
public static void convertTimeZoneJoda(String date, String time, DateTimeZone fromTimezone, DateTimeZone toTimeZone) {
    DateTimeFormatter dtf = DateTimeFormat.forPattern("dd/MM/yyyyHH:mm").withZone(fromTimezone);
    DateTime dt = dtf.parseDateTime(date+time).withZone(toTimeZone);

    System.out.println("Time in " + toTimeZone.getID() + " : " + dt.toString());
}

public static void main(String[] args) {
    convertTimeZoneJoda("23/04/2013", "23:00", DateTimeZone.forID("EST5EDT"), DateTimeZone.forID("GMT"));
} 
```

JodaTime 还允许在 TimeZone 和 DateTimeZone 之间进行方便的对话。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T16:00:54.767

要添加到[@Pino](https://stackoverflow.com/users/685806/pino)的答案，`get()`不返回更新时间的原因是因为`setTimeZone()`根本不更新字段，只是设置`areAllFieldsSet`为 false，这是无用的，因为`get()`不检查它。如果你问我，这是 SUN 部分的代码非常糟糕。这是来自的主管代码[`Calendar`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/Calendar.java#Calendar)：

**`setTimeZone()`**：

```
 public void  setTimeZone(TimeZone value){
        zone = value;
        sharedZone = false;
        areAllFieldsSet = areFieldsSet = false;

    } 
```

**`get()`**：

```
protected final int internalGet(int field){
    return fields[field];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-21T23:10:27.487

此代码适用于我转换为 UTC：

1.  创建一个带有 UTC 时区的日历对象

    ```
    Calendar utcTime = Calendar.getInstance(TimeZone.getTimeZone("GMT")); 
    ```

2.  从“任何时区”日历对象中设置 UTC 日历对象中的时间点

    ```
    utcTime.setTimeInMillis(myCalendarObjectInSomeOtherTimeZone.getTimeInMillis()); 
    ```

3.  `utcTime``myCalendarObjectInSomeOtherTimeZone`现在将包含与转换为 UTC相同的时间点。

# ruby-on-rails - Rails，没有路线匹配 {:action=>"show"

> ID：16173376
> 
> 赞同：3
> 
> 时间：2013-04-23T15:28:43.400
> 
> 标签：ruby-on-rails, routes

这难倒我，做了一个新的控制器

```
class ScorecardsReviewController < ApplicationController
  before_filter :require_staff_user

  layout 'unbranded'

  def index
    @scorecards = Scorecard.in_review
  end
end 
```

将此添加到路线中

```
 resources :scorecards_review 
```

在主页上添加了一个链接

```
.left
  = link_to 'Home', root_path
  = link_to 'About', about_home_path
  = link_to 'Legal', disclaimer_home_path
.right
  - if current_user.try(:admin?)
    = link_to 'Agencies', agencies_path
    = link_to 'Inaccurate scorecards', reported_scorecards_path
    = link_to 'Reviews', scorecards_review_path 
  - if current_user
    = link_to 'Logout', logout_path
.clear 
```

刷新了应用程序，我得到以下信息

```
No route matches {:action=>"show", :controller=>"scorecards_review"} 
```

当我收集资产时，我发现一切都在那里

```
 POST   /scorecards_review(.:format)                                  {:action=>"create", :controller=>"scorecards_review"}
      new_scorecards_review GET    /scorecards_review/new(.:format)                              {:action=>"new", :controller=>"scorecards_review"}
     edit_scorecards_review GET    /scorecards_review/:id/edit(.:format)                         {:action=>"edit", :controller=>"scorecards_review"}
          scorecards_review GET    /scorecards_review/:id(.:format)                              {:action=>"show", :controller=>"scorecards_review"}
                            PUT    /scorecards_review/:id(.:format)                              {:action=>"update", :controller=>"scorecards_review"}
                            DELETE /scorecards_review/:id(.:format)                              {:action=>"destroy", :controller=>"scorecards_review"} 
```

我不知道它可能是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:31:21.720

您可能需要将 scorecards_review_path 更改为 scorecards_reviews_path（评论末尾带有 s）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:37:14.343

我想你可能想要

```
resources :scorecards_reviews # plural 
```

这将为您提供通往索引操作的路线，我认为这是您正在寻找的。

# c# - 复杂匿名对象到动态公共属性

> ID：16173378
> 
> 赞同：1
> 
> 时间：2013-04-23T15:28:49.313
> 
> 标签：c#, dynamic, anonymous-types

如何在对象内部公开*匿名对象*`dynamic`的复杂结构？

匿名对象被标记为`internal`，所以我正在寻找一种**创造性的方法来解决这个问题**。

```
// This is the library I control
public void SendObject() {
    var anonymous = new {
        Text = "Test",
        SubItem = new {
            SubText = "Bla",
            SubSub = new {
                SubSubText = "Baha"
            }
        }
    };
}

dynamic dyn = ExposeAnonymous(anonymous); // Perform voodoo

var result = ExternalLibrary.GetSpecialProperty(dyn);

// External library I don't control
public object GetSpecialProperty(dynamic dyn) {
    return dyn.SubItem.SubSub.SubSubText;
} 
```

问题是当发送`dynamic`到***我无法控制*****的其他外部库时***，您会收到如下错误：*

 *> *“object”不包含“SubItem”的定义。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:35:15.550

> 问题是在将动态发送到其他库时，

......还有问题。匿名类型`internal`由 C# 编译器声明为，这意味着其他程序集无权访问它们。

要么停止使用匿名类型，要么使用[`[InternalsVisibleToAttribute]`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)使该类型对其他程序集可见。在包含*创建*匿名类型实例的类型的程序集中，使用：

```
[InternalsVisibleTo("ExternalLibrary")] 
```

（我实际上希望这个问题会出现`SubItem`而不是`SubSub`......）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T15:54:05.730

匿名类型`internal`和 DLR 在运行时执行与编译器在编译时执行相同的可访问性分析。因此，您不能使用`dynamic`.

一种选择可能是使用`ExpandoObject`：

```
 dynamic a = new ExpandoObject();
        a.Text = "Test";
        a.SubItem = new ExpandoObject();
        a.SubItem.SubText = "Blah";
        a.SubItem.SubSub = new ExpandoObject();
        a.SubItem.SubSub.Text = "Baha"; 
```

这有点难看，所以您可以保留匿名类型并使用辅助方法递归转换为`ExpandoObject`：

```
 public static dynamic ConvertToExpando(object obj)
    {
        IDictionary<string, object> expando = new ExpandoObject();
            foreach(var pi in obj.GetType().GetProperties())
            {
                // there doesn't seem to be a way to know if it is an anonymous type directly. So I use IsPublic here.
                if (pi.PropertyType.IsPublic)
                {
                    expando[pi.Name] = pi.GetValue(obj);                    
                }
                else
                {
                    expando[pi.Name] = ConvertToExpando(pi.GetValue(obj));
                }
            }
        return expando;
    } 
```

这会执行您需要的“执行巫术”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-02T12:48:26.287

使用我的开源框架 ImpromptuInterface（在 nuget 中），您可以使用[内联语法](https://github.com/ekonbenefits/impromptu-interface/wiki/UsageBuilder)创建复杂的扩展图。

```
dynamic New = Builder.New<ExpandoObject>();

dynamic dyn = New.Obj(
        Text: "Test",
        SubItem: New.Obj(
            SubText: "Bla",
            SubSub: New.Obj(
                SubSubText: "Baha"
            )
        )
    ); 
```*

# python - 使用 Google Drive（可能是 Google App Engine）保护 Python 脚本

> ID：16173382
> 
> 赞同：0
> 
> 时间：2013-04-23T15:29:09.167
> 
> 标签：python, security, exe, google-drive-api

**我很难理解是否可以通过将 python 制作的程序上传到 Google Drive**来保护 python 脚本不被窃取（我知道这实际上是不可能的，但至少让我们尽可能地保护它）。我进行了研究，例如如何保护我的 python 代码？或[存储 Python 脚本并在线运行它们？](https://stackoverflow.com/questions/904977/somewhere-to-store-python-scripts-run-them-online)以及许多或多或少相关的链接。但他们都没有真正回答我。

假设**我有一个 python 项目使用 GUI2Exe 制作了一个 Windows 可执行文件 (.exe)**。它具有从特定文件夹等**加载图像的GUI。**

**我将所有这些上传到 Google Drive。**

**以某种方式从 Google Drive 运行该程序**，如果你能让用户不知道它来自 Google Drive，那就更好了（登录界面等）

我想知道**下一个解决方案是否可行**或有另一种方法：

*   直接从 Google Drive 运行 exe（哦，天真，或者可能有一些我看不到的东西）
*   在另一个 python 代码的帮助下从 Google Drive 运行 exe，该代码可以在您的计算机上，但除了登录到 Google 并从正确的文件夹运行 exe 或将其下载到临时文件夹并从那里自动运行它之外，什么也不做。
*   将 Google Drive 用作 Windows 服务，所以我想您可以将其用作计算机的简单分区并从那里运行程序[这是一个更好的描述](http://www.coretechnologies.com/products/AlwaysUp/Apps/RunGoogleDriveAsAService.html)
*   也许避免使用谷歌并使用某种加密（尽管我知道这不是真正的python）

因为我的 python 程序已经有超过 20000 行代码并且使用了大约 20 个 python 库并且需要加载格式为 jpg、png、csv（电子表格）（等）我认为 Google App Engine 是不够的。虽然我在这里很菜鸟，所以我可能会非常非常错误。

我希望我说清楚了，如果可以的话，**请给我一个领导。**做这件事的正确方法，我做我的功课。我真的很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:33:04.423

考虑租用 EC2 Windows 实例。使用您需要的所有库进行设置。

# python - 为什么我不能（动态地）向数据存储对象添加属性并将其存储在会话中？

> ID：16173385
> 
> 赞同：0
> 
> 时间：2013-04-23T15:29:24.347
> 
> 标签：python, google-app-engine, session, google-cloud-datastore, webapp2

我无法在会话中检索已动态添加到数据存储对象的属性。这是一个（简化的）示例...为了节省建议时间，我不想将属性实际硬编码到数据存储对象。

```
Class User(ndb.Model):
   email = ndb.String...

// I use a handler to get the user object from the datastore 
// and store the object in session
user = function_to_get_user_by_key(key)

// Add an temporary attribute
user.temp_var = 'test'

// Store in session
self.session['user'] = user

// Get the user in the same script to test the attribute
user = self.session.get('user')

print user.temp_var // Works - I see the result

// Redirect to a new script (By the way, assume these scripts are in separate methods       within a handler class)

user = self.session.get('user')
print user.temp_var // Gives an attribute error - basically saying the class does not have this attribute 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:43:01.047

当您重定向到一个新脚本时，我假设它是另一个 HTTP 请求？

在新请求中，您将使用会话对象的新实例。在您的请求之间，您的会话将被序列化并保存到内存缓存或数据存储中。根据您的新请求，您将反序列化您的会话。

您可能想检查序列化的过程以及您的用户对象未按预期序列化的原因。User 类很可能有自己的基于 Kind 属性的序列化代码，并且 temp_var 可能会被序列化忽略，因为它不是类的一部分。

您也可以将 temp_var 直接放在会话中，在这种情况下，它应该正确序列化。

# android - Android：父进程（app）死亡后子进程（logcat）继续运行

> ID：16173387
> 
> 赞同：7
> 
> 时间：2013-04-23T15:29:32.780
> 
> 标签：android, process, logcat

我们的 Android 应用会生成一个 logcat shell 进程，然后读取其结果进行处理。但是，当应用程序停止时（例如，在开发过程中重新编译后重新启动时），logcat 进程将继续运行。这是此行为的示例：

```
processes = new ArrayList<Process>();

try {
  processes.add(Runtime.getRuntime().exec("logcat -v time"));
  processes.add(Runtime.getRuntime().exec("logcat -v time"));
  processes.add(Runtime.getRuntime().exec("logcat -v time"));
  processes.add(Runtime.getRuntime().exec("logcat -v time"));
} catch (IOException e) {
  // oh no!
}

Runtime.getRuntime().addShutdownHook(new Thread() {
  public void run() {
    for (Process p : processes) {
      p.destroy();
    }
  };
}); 
```

将此添加到测试应用程序的 onCreate() 方法中，启动它，然后使用设置管理器强制停止它。子进程将继续运行，现在其父 ID 为 1。

在[如何杀死 Android 应用程序启动的 logcat 进程？](https://stackoverflow.com/questions/12940827/how-to-kill-logcat-process-initiated-by-android-application)有人建议使用 ProcessBuilder，但这不是一个解决方案，该过程也将继续运行。

在[父进程停止时停止子进程中，](https://stackoverflow.com/questions/13243415/stop-child-process-when-parent-process-stops)建议使用关闭挂钩 - 如上所示，这也不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-26T23:37:39.067

您*可以*做的是生成另一个脚本，其唯一目的是监视您的 Java 程序。每当它死去时，也要杀死它所有的孩子。

一个脆弱的例子：

```
int pid = android.os.Process.myPid();
String script = "while [ -d /proc/" + pid + " ];do sleep 1;done; killall logcat";
Process p = Runtime.getRuntime().exec("/system/bin/sh", "-c", script); 
```

这假设您的进程没有以 root 身份运行，因此只会杀死它自己的 logcat 进程。在您的关闭函数中，您应该首先终止其他进程 ( `logcat`)，然后运行`p.destroy();`以停止此杀手脚本。

上面的脚本可以通过删除`killall`. 相反，`logcat`使用反射获取进程的进程 ID（[此答案](https://stackoverflow.com/a/5578924/427545)指向[http://www.golesny.de/p/code/javagetpid](http://www.golesny.de/p/code/javagetpid)）并将它们传递给`kill`.

# c# - 在 WebBrowser 控件错误中设置 TextArea 的值

> ID：16173391
> 
> 赞同：0
> 
> 时间：2013-04-23T15:29:43.603
> 
> 标签：c#

所以有以下文本区域：

```
<textarea class="profile" name="message"></textarea> 
```

我想使用 C# 中的代码设置这个 textarea 的值。当我使用以下代码时

```
 private void messageToolStripMenuItem_Click(object sender, EventArgs e)
  {
     webBrowser1.Document
     .GetElementsByTagName("textarea")
     .GetElementsByName("message")[0]
     .SetAttribute("value", "Something");

  } 
```

我得到错误：

```
Value of '0' is not valid for 'index'. 'index' should be between 0 and -1.

Parameter name: index 
```

如何设置此文本区域的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:31:25.057

当`GetElementsByName()`返回一个空时会发生这种情况`HtmlElementCollection`。

# jquery - jquery ui 对话栈

> ID：16173405
> 
> 赞同：0
> 
> 时间：2013-04-23T15:30:33.077
> 
> 标签：jquery, jquery-ui, jquery-ui-dialog

如何在屏幕右上角堆叠动态生成的 ui 对话。类似[notify](http://needim.github.io/noty/) .Notify 只是添加文本描述，我需要在窗口中显示类似表单的内容。

**目标**是在以前的对话之上自动堆叠新生成的对话。

**替代方案：**我想知道是否有替代通知可以显示 html 而不是纯文本。Html 渲染可以是 div 和进度条等

**jsfiddle：http:** [//jsfiddle.net/bababalcksheep/b5czz/2/](http://jsfiddle.net/bababalcksheep/b5czz/2/)

**HTML：**

```
<div id="dialog" title="Basic dialog1">
    <p>This is the default dialog </p>
</div>
<div id="dialog2" title="Basic dialog2">
    <p>This is the default dialog </p>
</div>
... more dialogues generated dynamically 
```

**爪哇：**

```
$(function(){
        var dialogOpts = { position: ["right", "bottom"],stack:true, };
        $("#dialog").dialog(dialogOpts);

        $("#dialog2").dialog(dialogOpts);

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:40:44.427

看看[http://pinesframework.org/pnotify](http://pinesframework.org/pnotify)。这是通知的替代方案，您可以使用 HTML，您已经有了带有进度条的简单程序等......有很多替代方案，请尝试谷歌“jquery notify”。

# javascript - 有没有办法在使用 javascript 操作 90 秒后更改 html 中的对象？

> ID：16173410
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:30:47.340
> 
> 标签：javascript, html, timeout

有没有办法在使用 javascript 操作 90 秒后更改 html 中的对象？我有一个下载按钮，一旦按下，我希望在 90 秒后将其替换为其他两个按钮。基本上是给下载时间来处理，然后让用户有机会分享他们在 Facebook 或 Google+ 上所做的事情。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:32:32.470

`setTimeout()`在所述操作后使用。

```
function buttonClicked() {    
   setTimeout(dosomething, 90000);
}

function dosomething() {
     // implementation of delayed action here
} 
```

# android - Android：实现可重用的 HTTP 异步方法

> ID：16173416
> 
> 赞同：0
> 
> 时间：2013-04-23T15:31:02.917
> 
> 标签：android, post, methods, android-asynctask, code-reuse

我一直在搜索，但我没有找到任何方法的实现，它允许发出 HTTP 发布请求，同时接收 URL 和数据作为函数的参数。

我的意思是，我找到的所有示例都是为一组特定的参数量身定制的，我需要的是在 AsyncTask 方法中获取一个 URL 和一个包含数据的数组，但是如何传递 url（字符串）参数和发布数据（数组）参数？

任何帮助或链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:46:58.147

对于类似的情况，我使用以下模式：

```
import java.util.List;
import org.apache.http.NameValuePair;
import android.os.AsyncTask;

public class AsyncHttpPostTask extends AsyncTask<Void, Void, Boolean> {

    private List<NameValuePair> httpPostParams;
    private String postHref;
    private String someOtherValue;

    public AsyncHttpPostTask(final String postHref, final List<NameValuePair> httpPostParams, final String someOtherValue) {
        super();
        this.postHref = postHref;
        this.httpPostParams = httpPostParams;
        this.someOtherValue = someOtherValue;
    }

    @Override
    protected Boolean doInBackground(final Void... params) {
        // Use httpPostParams (or any other values you supplied to a constructor) in your actual Http post here
        // ...
        return true;
    }
} 
```

要使用 AsyncTask，请创建一个实例，为构造函数和调用 execute() 提供所需的参数：

```
new AsyncHttpPostTask("http://example.com/post", httpPostParams, otherValue).execute(); 
```

# javascript - 如何在画布上拖动多个形状？[动力学]

> ID：16173424
> 
> 赞同：1
> 
> 时间：2013-04-23T15:31:29.380
> 
> 标签：javascript, kineticjs, multi-touch

例如：一键移动一个形状。另一个水龙头同时移动另一个形状。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:53:26.513

您可以像这样设置动力学组：

[http://www.html5canvastutorials.com/kineticjs/html5-canvas-complex-shapes-using-groups-with-kineticjs/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-complex-shapes-using-groups-with-kineticjs/)

以下是如何声明一个空组并使其可拖动：

```
 var group = new Kinetic.Group({
    x: 220,
    y: 40,
    draggable:true
  }); 
```

因此，在形状的点击处理程序中，您可以将点击的对象添加到组中。

```
 circle.on('tap', function() {
    group.add(circle);
  }); 
```

然后，您可以根据需要拖动组装的组。

如果您需要多个组，您可以像这样在不同组之间移动单个形状：

[http://www.html5canvastutorials.com/kineticjs/html5-canvas-move-shape-to-another-container-with-kineticjs/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-move-shape-to-another-container-with-kineticjs/)

```
 circle.moveTo(someOtherGroup); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T18:28:39.057

在同时拖动两个形状的情况下，您将不得不从浏览器中抓取触摸事件并将其读取为

```
touches[0] and touches[1] events 
```

这就是您区分同时发生的单独触摸事件的方式

官方 kineticjs 示例：
[http ://www.html5canvastutorials.com/labs/html5-canvas-multi-touch-scale-stage-with-kineticjs/](http://www.html5canvastutorials.com/labs/html5-canvas-multi-touch-scale-stage-with-kineticjs/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-22T17:14:02.067

[我在这里](https://github.com/atomictag/Kinetic.MultiTouch)分享了我在 Kinetic + Multi Touch 上所做的一个小实验。看看 - 也许它可以帮助直到“真正的”多点触控在 Kinetic 中可用

# css - 在样式属性（不是标签，而是属性）中应用媒体查询？

> ID：16173425
> 
> 赞同：2
> 
> 时间：2013-04-23T15:31:36.860
> 
> 标签：css, svg, media-queries, inline-styles

我正在尝试使用响应式 SVG 文件，并且真的想独立于 HTML 页面选择合适的图像。

我想要一个设置，我可以在其中将 SVG 传递给**img**标签，而无需任何进一步的依赖。然后在返回之前渲染 SVG 以便显示。

据我所知，如果我将**样式**标签放入 SVG，那么它会在页面加载后进行评估，并且只能访问页面的 DOM 元素，而不是封装的“in-SVG-only”元素。在加载页面之前评估样式的唯一方法是将 CSS 放入整个**svg**标签的样式属性中。并且在那里进行媒体查询会很棒。

你能理解这个吗？有可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:37:42.300

内联`style`属性不支持媒体查询。

# php - FOSRestBundle 和 JMS 序列化器，获取 JSON 时出错

> ID：16173429
> 
> 赞同：4
> 
> 时间：2013-04-23T15:31:40.833
> 
> 标签：php, mongodb, symfony, doctrine-odm, fosrestbundle

我一直在尝试 Symfony 2.2、FOSRest Bundle（使用 JMS Serializer）和使用 MongoDB 的 Doctrine ODM。

经过数小时试图弄清楚如何正确设置 FOSRest Bundle 后，我仍然遇到了一些麻烦：我有一个非常简单的路线，可以返回产品和价格列表。**每当我请求 HTML 格式时，我都会得到正确的响应，但如果我请求任何其他格式（JSON、XML），我会收到错误消息：**

```
[{"message": "Resources are not supported in serialized data. Path: Monolog\\Handler\\StreamHandler -> Symfony\\Bridge\\Monolog\\Logger -> Doctrine\\Bundle\\MongoDBBundle\\Logger\\Logger -> Doctrine\\Bundle\\MongoDBBundle\\Logger\\AggregateLogger -> Doctrine\\ODM\\MongoDB\\Configuration -> Doctrine\\MongoDB\\Connection -> Doctrine\\ODM\\MongoDB\\LoggableCursor",
    "class": "JMS\\Serializer\\Exception\\RuntimeException",... 
```

你可以在**[这里](http://d.pr/n/iLLZ)****看到完整的错误信息**

我当前的设置非常简单：我创建了一个到控制器的路由，该控制器返回产品列表和价格（我按照[这个示例](http://symfony.com/doc/current/bundles/DoctrineMongoDBBundle/index.html)创建了产品文档）。

这是路线：

```
rest_product:
    type: rest
    resource: Onema\RestApiBundle\Controller\ProductController 
```

这是控制器：

```
<?php
namespace Onema\RestApiBundle\Controller;
use Symfony\Component\HttpKernel\Exception\NotFoundHttpException;
use FOS\RestBundle\Controller\FOSRestController;
use FOS\RestBundle\Routing\ClassResourceInterface;
use FOS\Rest\Util\Codes;
use JMS\Serializer\SerializationContext;
use Onema\RestApiBundle\Document\Product;

class ProductController extends FOSRestController implements ClassResourceInterface
{
    public function getAction()
    {
        $dm = $this->get('doctrine_mongodb')->getManager();
        $products = $dm->getRepository('RestApiBundle:Product')->findAll();

        if(!$products)
        {
            throw $this->createNotFoundException('No product found.');
        }

        $data = array('documents' => $products);         
        $view = $this->view($data, 200);
        $view->setTemplate("RestApiBundle:Product:get.html.twig");
        return $this->handleView($view);
    }
} 
```

这是从控制器 Resources/Product/get.html.twig 调用的视图：

```
<ul>
{% for document in documents %}
<li>
    {{ document.name }}<br />
    {{ document.price }}
</li>
{% endfor %}
</ul> 
```

**有什么想法为什么这对一种格式可以正常工作，而其他格式不能正常工作？我应该设置什么额外的东西吗？**

**更新：** 这是我一直在使用的配置值。在 app/config/config.yml 结束时，我有这个：

```
sensio_framework_extra:
    view:    { annotations: false }
    router:  { annotations: true }

fos_rest:
    param_fetcher_listener: true
    body_listener: true
    format_listener: true
    view:
        formats:
            json: true
        failed_validation: HTTP_BAD_REQUEST
        default_engine: twig
        view_response_listener: 'force' 
```

**解决方法：**

做更多的研究我遇到了另一个错误，这导致我提出这个问题和答案：

[https://stackoverflow.com/a/14030646/155248](https://stackoverflow.com/a/14030646/155248)

`Doctrine\ODM\MongoDB\LoggableCursor`一旦我通过将每个结果添加到这样的数组中来摆脱它：

```
$productsQ = $dm->getRepository('RestApiBundle:Product')->findAll();

foreach ($productsQ as $product) {
    $products[] = $product;
}

return $products; 
```

我开始以正确的格式获得结果。这是一种蹩脚的解决方案，仍然希望找到更好的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-16T14:30:05.830

如果要获取 RestApiBundle:Product 文档的集合，则必须在从存储库调用 find 方法或从查询构建器调用 getQuery 方法后调用方法“toArray”

```
/**
 * @Route("/products.{_format}", defaults={"_format" = "json"})
 * @REST\View()
 */
public function getProductsAction($_format){
    $products = $this->get('doctrine_mongodb')->getManager()
        ->getRepository('RestApiBundle:Product')
        ->findAll()->toArray();

    return $products;
} 
```

您也可以调用 array_values($products) 来正确序列化排除策略

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-26T07:14:38.887

最有可能的错误在于您的配置文件中的某个地方，或者可能缺少？添加您的配置，如果可以，我将更新我的答案。

现在我将引导您完成一个简单的实现。

首先让我们从配置开始：

注意：我将为某些设置使用注释，请参阅[SensioFrameworkExtraBundle](http://symfony.com/doc/current/bundles/SensioFrameworkExtraBundle/index.html)。

```
#app/config/config.yml
sensio_framework_extra:
    view:
        annotations: false

fos_rest:
    param_fetcher_listener: true
    body_listener: true
    format_listener: true
    view:
        view_response_listener: 'force' 
```

首先我们设置 sensio extra bundle。[默认配置](http://symfony.com/doc/current/bundles/SensioFrameworkExtraBundle/index.html#configuration)启用注释设置为 true 。我禁用了视图的注释（我不会在这里使用它们）。

对于 fos_rest，我们正在设置[Listeners](https://github.com/FriendsOfSymfony/FOSRestBundle/blob/master/Resources/doc/3-listener-support.md#step-3-listener-support)，我们保持简单，因此我们将使用他们文档中的示例。

我们将创建实体：

```
<?php

namespace Demo\DataBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Validator\Constraints;
use JMS\Serializer\Annotation\ExclusionPolicy;  //Ver 0.11+ the namespace has changed from JMS\SerializerBundle\* to JMS\Serializer\*
use JMS\Serializer\Annotation\Expose;  //Ver 0.11+ the namespace has changed from JMS\SerializerBundle\* to JMS\Serializer\*

/**
 * Demo\DataBundle\Entity\Attributes
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="Demo\DataBundle\Entity\AttributesRepository")
 * 
 * @ExclusionPolicy("all")
 */
class Attributes
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     * 
     * @Expose
     */
    private $id;

    /**
     * @var string $attributeName
     *
     * @ORM\Column(name="attribute_name", type="string", length=255)
     * 
     * @Expose
     */
    private $attributeName;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set attributeName
     *
     * @param string $attributeName
     * @return Attributes
     */
    public function setAttributeName($attributeName)
    {
        $this->attributeName = $attributeName;

        return $this;
    }

    /**
     * Get attributeName
     *
     * @return string 
     */
    public function getAttributeName()
    {
        return $this->attributeName;
    }
} 
```

您会注意到几个注释设置。首先我们设置@ExclusionPolicy("all") 然后我们手动设置我们想要@Expose 给API 的对象。[您可以在此处](http://jmsyst.com/libs/serializer/master/cookbook/exclusion_strategies)找到有关此内容的更多信息以及[JMS Serializer 注释列表](http://jmsyst.com/libs/serializer/master/reference/annotations)

现在让我们转到一个简单的控制器：

```
<?php

namespace Demo\DataBundle\Controller;

use FOS\RestBundle\Controller\FOSRestController;
use FOS\RestBundle\Controller\Annotations as Rest;   //Lets use annotations for our FOSRest config
use FOS\RestBundle\Routing\ClassResourceInterface;   
use FOS\Rest\Util\Codes;
use Symfony\Component\HttpFoundation\Request;
use Demo\DataBundle\Entity\Attributes;

class AttributesController extends FOSRestController implements ClassResourceInterface
{
    /**
     * Collection get action
     * @var Request $request
     * @return array
     *
     * @Rest\View()
     */
    public function cgetAction(Request $request)
    {
        $em = $this->getDoctrine()->getManager();

        $entities = $em->getRepository('DemoDataBundle:Attributes')->findAll();

        return array(
                'entities' => $entities,
        );
    }
} 
```

这是一个简单的控制器，它将返回所有内容。

希望这有帮助。我认为您的错误来自与序列化程序相关的错误设置。确保您公开一些数据。

# java - 我的自定义访问器从未使用过，并且休眠验证器仅使用字段默认值

> ID：16173431
> 
> 赞同：0
> 
> 时间：2013-04-23T15:31:45.037
> 
> 标签：java, spring, spring-roo, bean-validation, hibernate-validator

我在 javabean 中有以下代码：

```
@AssertTrue
private boolean addressReferenceValid;

public boolean isAddressReferenceValid() {
    if (addressType.equals(AddressType.ON_THE_FLY_ADDRESS) && StringUtils.isEmpty(addressReference)) {
        return false;
    }
    return true;
} 
```

我遇到的问题是从未使用过**isAddressReferenceValid**访问器，而且似乎只使用了**addressReferenceValid**的默认值（即`false`）。

我仔细检查了 Spring Roo 没有为该变量生成自己的访问器。

有人可以帮忙吗？

***PS**我不能将@AssertTrue 注释直接放在方法上，因为这样`ValidationMessages.properties`文件中的以下键将无法解析：`AssertTrue.familyAdvertisementSearchCriteriaInfo.addressReferenceValid`*

**编辑1**：

全豆：

```
@RooEquals
@RooJavaBean
public class FamilyAdvertisementSearchCriteriaInfo {

    @Valid
    private FamilyAdvertisementSearchCriteria searchCriteria;

    private Address currentAddress;

    private String addressReference;

    @NotNull
    private AddressType addressType;

    @AssertTrue(groups=Default.class)
    private boolean addressReferenceValid;

    public boolean isAddressReferenceValid() {
        if (addressType.equals(AddressType.ON_THE_FLY_ADDRESS) && StringUtils.isEmpty(addressReference)) {
            return false;
        }
        return true;
    }
} 
```

验证发生在以下控制器中：

```
@RequestMapping(value = "/familyAdvertisementSearch", method = RequestMethod.POST, produces = "text/html")
public String familyAdvertisementSearchResults(@ModelAttribute @Validated(Default.class) FamilyAdvertisementSearchCriteriaInfo familyAdvertisementSearchCriteriaInfo, BindingResult bindingResult, Model model) {
        if(bindingResult.hasErrors()){
            populateModel(model);
            familyAdvertisementSearchCriteriaInfo.setCurrentAddress(memberService.retrieveCurrentMemberAddress());
            return "search/familyAdvertisementSearchForm";
        }
... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:29:53.560

我想我现在明白你想要做什么了。您想在字段上放置约束，但在验证期间您希望调用/使用方法 isAddressReferenceValid。那是行不通的。如果您在字段上放置约束，则访问用于获取要验证的属性（使用反射）。如果将它放在方法/getter 方法上，则使用访问。因此，注释的位置很重要。正如您似乎已经发现将注释放在方法上工作。当然，这会导致注释的位置不一致。你可以：

*   只需放置此单个约束的注释
*   完全切换到方法注释
*   每次地址类型更改时更新布尔值（并摆脱 isAddressReferenceType 方法）
*   创建用于验证 addressReference 的自定义约束

只是一些想法。这完全取决于您的用例和个人喜好。

# html - IE9表格单元全宽无浮动

> ID：16173432
> 
> 赞同：0
> 
> 时间：2013-04-23T15:31:48.067
> 
> 标签：html, css, internet-explorer-9, media-queries

有没有办法让 IE9 表格单元格的宽度达到 100%，而无需使用浮点数。在其他浏览器上使用`display:block`就足够了，但对于 IE9 来说，浮点数确实可以工作，但对于复杂的嵌套表，它会导致 IE9 在媒体查询之间切换时崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:52:07.570

我无法在 IE9 上进行测试，但您**还**应该设置`display: block`与表格相关的元素，例如`table`,`tbody`和`tr`.
这应该会有所帮助，如果没有，请提供反馈:)

编辑： http: [//jsfiddle.net/NAqLX/1/embedded/result/](http://jsfiddle.net/NAqLX/1/embedded/result/)和[http://jsfiddle.net/NAqLX/embedded/result/](http://jsfiddle.net/NAqLX/embedded/result/)在 IE8 上失败（至少在 Firefow 上工作时）所以也许它没有不能在 IE9 上工作
EDIT2：在询问了我的同事想要几个`tr`或`tbody`继续（显示为内联块）之后，在 IE8/9 上似乎是一个很大的问题

# php - 如何在不使用 Flash 服务器或 Red5 的情况下使用 Adob e flex 流式传输实时网络摄像头视频？

> ID：16173440
> 
> 赞同：0
> 
> 时间：2013-04-23T15:32:08.133
> 
> 标签：php, html, actionscript-3, apache-flex, red5

我的托管服务不允许在共享主机帐户上使用 Flash 服务器或 Red5，只能使用 VPS 帐户。这是东西，我不想付钱。我设法创建了一个 MXML 应用程序并成功地将其编译成一个 .SWF 文件，该文件将抓取用户的实时摄像头。现在我遇到的问题是向其他用户显示该网络摄像头。所以我假设我需要某种服务器来发送该视频，以便我可以连接到它，然后显示流。现在我的问题是，是否有不需要其他服务器（例如 Red5 或 Flash 服务器）的解决方法？为什么我不能自己处理实时网络摄像头并使用 ActionScript3.0 显示实时流？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T13:20:47.860

如 Reboog711 所述，选择Adob​​e **[Cirrus 。](http://labs.adobe.com/technologies/cirrus/)****它是一个点对点协议。**

很好回答你的问题。。

> 是否有不需要其他服务器（例如 Red5 或 Flash 服务器）的解决方法？

*   是的，**您不需要这里涉及的任何服务器**。只需连接到服务并获取令牌 ID。与您的远程最终用户交换该令牌 ID，反之亦然，这样你们两个都可以看到自己。

> 为什么我不能自己处理实时网络摄像头并使用 ActionScript3.0 显示实时流？

*   谁说你不能;)？您可以使用您的 actionscript 3.0 很好地控制设置，包括网络摄像头视频大小、纵横比、质量、带宽等。

# html - 根据兄弟宽度确定div的宽度

> ID：16173441
> 
> 赞同：1
> 
> 时间：2013-04-23T15:32:19.540
> 
> 标签：html, css

我有两个`<div/>`s 以“A 列”和“B 列”的方式排列。B 列是一个设定的宽度，我希望 A 列占据剩余空间。有没有办法在 CSS 中实现这一点？或者也许是我正在做的更好的选择？

这是结构：

```
<div>
  <div id='colA'>style is float right</div>
  <div id='colB'>this has a set width of 50px</div>
<div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:37:10.953

使用`display: table-cell`.

```
#container{
    display: table;
    width: 100%;
}

#colA {
    display: table-cell;
}

#colB {
    display: table-cell;
    width: 50px;
} 
```

见[演示](http://jsfiddle.net/urnur/5/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:41:26.733

在其中一个上使用`float`并向另一个添加边距，该边距等于该方向上浮动的宽度..

```
<div>
  <div id='colA'>this has a set width of 50px and is floated</div>
  <div id='colB'>style has margin equal to floated width</div>
</div> 
```

和

```
#colA {
    width:50px;
    float:left;
    background-color:red;
}
#colB {
    margnin-left:50px;
    background-color:green;
} 
```

**演示在** [http://jsfiddle.net/C3caq/1/](http://jsfiddle.net/C3caq/1/)

# eclipse - STS/Eclipse 中的软换行符

> ID：16173443
> 
> 赞同：1
> 
> 时间：2013-04-23T15:32:25.097
> 
> 标签：eclipse, sts-springsourcetoolsuite

有谁知道是否可以进行软（无空格字符）中断，这样我就可以提高可读性，而无需在我正在处理的 JSP 页面中引入换行符？

使用 Springsource Tool Suite（基于 Eclipse）。

谢谢！

# php - PHP MYSQL SUM 总计但显示行

> ID：16173444
> 
> 赞同：1
> 
> 时间：2013-04-23T15:32:26.507
> 
> 标签：php, mysql, sum

我想要做的是在顶部显示最后一个条目的页面上显示收入。但它仍然需要将总数增加到每一行。

所以第一页可能看起来像这样：

```
Date      Amount    Balance
1/9/2013   10.00    80.00
1/7/2013   10.00    70.00
1/6/2013   10.00    60.00 
```

第 2 页可能如下所示：

```
Date      Amount    Balance
1/5/2013   10.00    50.00
1/4/2013   10.00    40.00
1/3/2013   10.00    30.00
1/2/2013   10.00    20.00
1/1/2013   10.00    10.00 
```

但这就是我得到的：

```
Date      Amount    Balance
1/9/2013   10.00    60.00
1/7/2013   10.00    70.00
1/6/2013   10.00    80.00 
```

第 2 页如下所示：

```
Date      Amount    Balance
1/5/2013   10.00    10.00
1/4/2013   10.00    20.00
1/3/2013   10.00    30.00
1/2/2013   10.00    40.00
1/1/2013   10.00    50.00 
```

请注意，天平是向后的。但即使我的示例没有显示，金额的顺序也是正确的。这是我的代码：

```
SELECT *,
@total:= @total+ `companyearned` AS `total`
FROM `recordedhours`, (SELECT @total:=0) r WHERE `group` = '$uid'
ORDER BY `unixdate` DESC, `idnum` DESC
LIMIT $from, $max_results

 while ($rowb = mysql_fetch_array($result2)) {
//CREATE ROWS HERE
} 
```

非常感激你的帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:50:08.143

尝试这个`SQL`

```
SELECT * FROM
(
    SELECT *, @total:= @total+ `companyearned` AS `total`
    FROM `recordedhours`, (SELECT @total:=0) r WHERE `group` = '$uid'
    ORDER BY `unixdate` ASC, `idnum` DESC
    LIMIT $from, $max_results
) tab ORDER BY `unixdate` DESC 
```

# javascript - Angularjs 控制器

> ID：16173450
> 
> 赞同：3
> 
> 时间：2013-04-23T15:32:34.977
> 
> 标签：javascript, angularjs, controller

我有一个问题，我找不到正确的答案。

好的，例如，我有从 api 收集的数据

行政

用户

用户资料

用户统计

**为此我有**

管理员Ctrl

用户控制

用户配置文件Ctrl

用户统计Ctrl

问题是当我在我的控制器中时，如果我想查看 userprofile 然后 userprofileCtrl 从 admins/:admin_id/users/:user_id/profile 之类的 url 获取路由，我必须收集所有数据，如管理员、用户和配置文件每个控制器都能够在我的视图中打印有关用户的所有详细信息。

我可以以某种方式嵌套控制器吗？这会导致控制器出现大量干燥现象。

还想知道打印错误消息的最佳做法是什么，我有 apiservice，它向我的 api 发出所有请求，我应该在服务中设置消息如何，rootScope？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T08:49:51.030

我认为您需要查看 angular-ui 的 ui-router 指令。

它专为嵌套路由而设计。

[https://github.com/angular-ui/ui-router](https://github.com/angular-ui/ui-router)

[http://angular-ui.github.io/ui-router/sample/#/](http://angular-ui.github.io/ui-router/sample/#/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T11:17:47.200

如前所述，您可以在应用程序中嵌套控制器 - 即；

```
<div ng-controller='outercontroller'>
     <div ng-controller='innercontroller'>
     </div>
</div> 
```

内部控制器可以访问您在外部控制器范围内定义的任何内容 - 它会隐藏外部控制器的值。您还可以通过 $scope.$parent 从内部控制器的范围访问外部控制器中的值。这可能会有所帮助：[AngularJS 中范围的继承](https://stackoverflow.com/questions/14232397/scope-inheritance-in-angularjs)

理想情况下，您应该使用服务来检索和存储数据。然后，您可以从服务中检索它。另一个优势是，您可以将服务设计为仅在服务发生任何更改时才刷新其数据，从而避免您进行可能的冗余调用。Socket.io 可能用于此目的，或者您可以定义一个计时器，使其仅在设定的时间后刷新。

至于错误信息；我可能会在必要的地方创建 try/catch（或您打算用于错误的任何逻辑）块并将错误代码传递给 errorMessageService。在我看来，我会将错误参数绑定到服务上。如果服务中存在错误，它将在视图中显示错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-14T14:13:46.933

# 1

在我看来，控制器应该只用于启动范围状态，数据加载任务应该移至`angular.factory`或`angular.service`取决于您的需要。好处是：

1.  服务对象存在于应用程序生命周期中。您将一直处理同一个对象，这样即使您路由到另一个 url 或控制器，您也可以保留数据。
2.  您的数据将在任何地方可用
3.  您不必担心弄乱范围继承。

在某些情况下你想`ng-repeat`在你的 html 中使用，你可以这样做：

```
app.run(function($rootScope) {
    $rootScope.yourDataService = yourDataService
} 
```

所以你`ng-repeat`会变成：

```
<li ng-repeat="item in yourDataService.items"></li> 
```

# 2

您可以在服务对象中访问 $rootScope ，但是如果您按照我的第一个答案进行操作，则不必担心。您可以将错误消息附加到您的服务对象中，`app.service`然后它将作为`$rootScope.yourDataService.errorMessage`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-08T05:12:49.837

您可以在视图中嵌套控制器，因此每个子控制器都会继承父控制器的模型。

查看“控制器继承示例”中的角度文档：http: [//docs.angularjs.org/guide/dev_guide.mvc.understanding_controller](http://docs.angularjs.org/guide/dev_guide.mvc.understanding_controller)

控制器：

```
angular.module('App', [])
.controller('MainCtrl', ['$scope', function($scope){
    $scope.foo = 'foo';
}])
.controller('CtrlOne', ['$scope', function($scope){

}])
.controller('CtrlTwo', ['$scope', function($scope){
    $scope.foo = 'bar';
}]); 
```

然后您的视图将如下所示：

```
<div ng-app='App'>
    <div ng-controller='MainCtrl'>
        <div ng-controller='CtrlOne'>
            CtrlOne: {{foo}}
        </div>
        <div ng-controller='CtrlTwo'>
            CtrlTwo: {{foo}}
        </div>
    </div>
</div> 
```

jsFiddle 上面的例子：http: [//jsfiddle.net/guilhermenagatomo/pAHR8/](http://jsfiddle.net/guilhermenagatomo/pAHR8/)

更复杂的方法是使用服务在控制器之间共享数据。

# php - 在表单提交期间，在链配置的命名空间中找不到类“Symfony\Component\Form\Form”

> ID：16173451
> 
> 赞同：1
> 
> 时间：2013-04-23T15:32:39.723
> 
> 标签：php, forms, symfony

我正在构建一个界面，允许办公室中的人员编辑特定记录的详细信息。目前我有这样的表格：

**view.html.twig**

```
<!-- Modal Windows: Edit Instructor Personal Details -->
<div id="editPersonal" style="display:none;">
    <div class="modal-head">
        <h2>Edit Personal Details For: <font-color="red !important">{{instructor.firstName}} {{instructor.surname}}</font></h2>
    </div>
    <div class="modal-body">
        <form action="#" method="post" {{ form_enctype(ipde) }} id="editPersonalDetails" class="modaledit">
        <table class="modalform-col1">
            <tbody>
                <tr class="hidden">
                    <th>{{ form_label(ipde.id, 'ID*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.id) }}
                        {{ form_widget(ipde.id, { 'attr': {'class': 'textfield'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.firstName, 'First Name*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.firstName) }}
                        {{ form_widget(ipde.firstName, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.surname, 'Surname*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.surname) }}
                        {{ form_widget(ipde.surname, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.address1, 'Address Line 1*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.address1) }}
                        {{ form_widget(ipde.address1, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.address2, 'Address Line 2', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.address2) }}
                        {{ form_widget(ipde.address2, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.town, 'Town*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.town) }}
                        {{ form_widget(ipde.town, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.county, 'County*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.county) }}
                        {{ form_widget(ipde.county, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.postcode, 'Postcode*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.postcode) }}
                        {{ form_widget(ipde.postcode, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
                <tr>
                    <th>{{ form_label(ipde.email, 'Email*', { 'attr': {'class': 'title'} }) }}</th>
                    <td>
                        {{ form_errors(ipde.email) }}
                        {{ form_widget(ipde.email, { 'attr': {'class': 'text'}}) }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="modal-footer">
        <div class="modal-placeright">
            <a href="#close" rel="modal:close" class="closebutton">Close Without Saving</a>
            <input type="submit" value="Save Changes" id="savebuttonpr" class="savebutton" />
            {{ form_rest(ipde) }} 
        </div>
    </div>
</div> 
```

我的控制器看起来像这样：

**DefaultController.php**

```
<?php

namespace PCUK\InstructorBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use PCUK\InstructorBundle\Form\IpdeType;
use PCUK\InstructorBundle\Form\IrType;
use PCUK\InstructorBundle\Form\BaType;
use Symfony\Component\HttpFoundation\Request;

class DefaultController extends Controller
{

    public function viewAction($instructor, Request $request)
    {
        // Database connection
        $insrep = $this->getDoctrine()->getManager();

        // Get Instructor from Entity for Form use
        $instructorQ = $insrep->getRepository('InstructorBundle:MapInstructors')->find($instructor);

        // Get Shared Branches from Entity for Form use
        $instructorS = $insrep->getRepository('InstructorBundle:MapInstructorShared')->find($instructor);

        // Generate Form to edit Instructor Personal Details
        $ipde = $this->createForm( new IpdeType(), $instructorQ);

        // Handle Form submission to edit Instructor Personal Details
        if ($request->getMethod() == 'POST') {
            $ipde->bind($request);

            if ($ipde->isValid()) {
                // perform some action, such as saving the task to the database

                //if ($this->request->isXmlHttpRequest()){
                       //return data ajax requires.
                //}
                $em = $this->getDoctrine()->getManager();
                $em->persist($ipde);
                $em->flush();

                return $this->redirect($this->generateUrl('task_success'));
            }
        }

        // Generate Form to edit Instructor Records
        $ir = $this->createForm( new IrType(), $instructorQ);

        // Generate Form to edit Instructor Records
        $ba = $this->createForm( new BaType(), $instructorS);

        // Return data to view
        return $this->render('InstructorBundle:Default:view.html.twig', array(
            'ipde' => $ipde->createView(),
            'ir' => $ir->createView(),
            'ba' => $ba->createView()
        ));
    }
} 
```

但是，当我提交表单时，出现以下错误：

> “在链配置的命名空间 PCUK\InstructorBundle\Entity 中找不到类 'Symfony\Component\Form\Form'”

我之前已经构建了一个 Symfony2 项目，并且我已经针对当前项目引用了它，以查看我是否包含了`Symfony\Component\Form\Form`，如果这实际上是问题所在。

发生了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-23T22:04:45.557

你坚持`$ipde`它恰好是一种形式而不是一个实体！

这可能是错误的根源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T17:51:48.300

您的所有 *Type() 类中是否都有“使用”语句？我想应该是这样的

```
use Symfony\Component\Form\AbstractType; 
```

AbstractType 使用了 Form 命名空间。

# rest - MongoHQ Rest API 日期查询

> ID：16173453
> 
> 赞同：0
> 
> 时间：2013-04-23T15:32:56.340
> 
> 标签：rest, date, mongohq

我有一个充满这样的文件的集合：

```
{
  _id: ObjectId("51715ade030112703e4c1fd3"),
  gas_price: 78,
  elec_usage: 110,
  elec_price: 88,
  gas_usage: 146,
  user: "test_user",
  timestamp: ISODate("2013-04-19T15:55:26.813Z")
} 
```

我想向他们查询“时间戳是今天”。我的查询 JSON 如下所示：

```
{"timestamp" : { $gte : new Date('2013-4-23')}} 
```

如果我手动运行此查询，它可以工作：

```
find({"timestamp" : { $gte : new Date('2013-4-23')}}).limit(100)

[{ _id: ObjectId("51763f708b26fe92e77d7898"), gas_price: 98, elec_usage: 146, elec_price: 82, gas_usage: 120, user: "test_user", timestamp: ISODate("2013-04-23T08:59:44.587Z") }
 { _id: ObjectId("517646798b26fe92e77d7899"), gas_price: 76, elec_usage: 84, elec_price: 91, gas_usage: 117, user: "test_user", timestamp: ISODate("2013-04-23T09:29:45.693Z") }
 { _id: ObjectId("51764d858b26fe92e77d789a"), gas_price: 90, elec_usage: 69, elec_price: 87, gas_usage: 30, user: "test_user", timestamp: ISODate("2013-04-23T09:59:49.702Z") }
 { _id: ObjectId("517663058b26fe9629162cfe"), gas_price: 100, elec_usage: 38, elec_price: 80, gas_usage: 68, user: "test_user", timestamp: ISODate("2013-04-23T11:31:33.800Z") }
 { _id: ObjectId("517663868b26fe9637611ca4"), gas_price: 95, elec_usage: 147, elec_price: 93, gas_usage: 117, user: "test_user", timestamp: ISODate("2013-04-23T11:33:42.693Z") }] 
```

但如果我在 URL 中进行查询：

```
https://api.mongohq.com/databases/vIHD_Development/collections/hourly_usage/documents?_apikey=xxxxxxxxxxxx&q=%7B%22timestamp%22%20:%20%7B%20$gte%20:%20new%20Date('2013-4-23')%7D%7D 
```

（未编码的是 " `https://api.mongohq.com/databases/vIHD_Development/collections/hourly_usage/documents?_apikey=xxxxxxxxxxxx&q={"reading_time" : { $gte : new Date('2013-4-23')}}`" ）

我得到一个空数组。我尝试了不同的编码（此 URL 包含用于 $ 的 %24）和不同的结构（ISODate 而不是 Date，不同的日期格式），但似乎没有任何效果。如果我进行更简单的查询 {"user" : "test_user"} 我确实会取回文档，例如：

```
https://api.mongohq.com/databases/vIHD_Development/collections/hourly_usage/documents?_apikey=xxxxxxxxxxxx&q=%7Bgas_price:%20%7B%20$gte:%2070%7D%20%7D 
```

我最近更改了时间戳字段名称，使其远离可能发生冲突的时间戳，而对检索没有任何影响。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-03T13:44:58.450

似乎 MongoHQ 在其 REST API 中的 $date 实现并不完整。

我通过将日期存储为自纪元以来的时间戳秒数并对此进行查询来解决此问题。它不仅工作，而且代码更简单。

# javascript - 加载重 png 图像时的 Gif 加载器

> ID：16173460
> 
> 赞同：0
> 
> 时间：2013-04-23T15:33:14.690
> 
> 标签：javascript, jquery

`<img id="chart">`我使用以下 JS 代码将服务器端 PHP 脚本（图表）生成的 png 图像加载到 HTML IMG 元素：

`$('#chart').attr('src', 'chart.php');`

PNG 图像的生成和下载大约需要 1 秒，所以我想在图像加载时显示 gif 加载器。如何用 JS 实现这个功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:49:22.920

为了平衡，这在纯 JS 中非常简单：

```
var preload = function(element, src) {

   var img = new Image();

   // Apply onload before applying src attribute to avoid IE prematurely firing
   img.onload = function() {
       // Replace #chart with image
       element.parentNode.replaceChild(img, element);
   };

   img.src = src;
}

preload(document.getElementById('chart'), 'chart.php?_...'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:35:13.193

```
$('#chart').attr('src', 'chart.php').load(function(){
    //something
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:39:20.217

如果浏览器缓存了它，你可以在查询字符串中添加一些东西来打破它。无论哪种方式，您都需要侦听图像的`load`事件，该事件应在设置*之前*`src`绑定（以防它被缓存）：

```
var target_url = 'chart.php?_=' + (new Date()).getTime();
// Show "loading"
$('#chart').on("load", function () {
    // Hide "loading"
}).attr('src', target_url); 
```

参考：

*   [http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

请注意该参考底部附近的警告，指的是使用图像时的事件：

*   它不能始终如一地工作，也不能可靠地跨浏览器
*   如果图像 src 设置为与以前相同的 src，它不会在 WebKit 中正确触发
*   它没有正确地冒泡 DOM 树
*   可以停止对已经存在于浏览器缓存中的图像进行触发

# android - Android：访问返回 JSON 的 SOAP Webside

> ID：16173462
> 
> 赞同：0
> 
> 时间：2013-04-23T15:33:15.320
> 
> 标签：android, json, soap, webservices-client

我正在尝试使用 SOAP 连接到网站并以 JSON 格式返回结果。但是我对这个主题真的很黑，真的需要一些指导..

**我的肥皂访问代码：**

```
 public SoapAccess (){
        this.user_id = "MYID";
        this.password = "MYPASSWORD";
        this.busstop_id = "16010366";

    Thread networkThread = new Thread() {
    @Override
     public void run() {
          try {

    //Initialize soap request + add parameters
    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);        

    request.addProperty("user", user_id);
    request.addProperty("password",password);
    request.addPropertyIfValue("busStopId", busstop_id);

    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true; 
    envelope.setOutputSoapObject(request);

    // Make the soap call.
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

        androidHttpTransport.call(SOAP_ACTION, envelope);     

        SoapPrimitive result = (SoapPrimitive)envelope.getResponse();
        Log.i("myapp",result.toString());
        System.out.println(" --- response ---- " + result); 
             }
             catch (Exception e) {
                 e.printStackTrace();
             }

            }
        };
    networkThread.start();
    } 
```

**SOAP 如下所示：**

```
 POST /InfoTransit/userservices.asmx HTTP/1.1
Host: 10.0.2.52
Content-Type: text/xml; charset=utf-8
Content-Length: length
SOAPAction: "http://miz.it/infotransit/getUserRealTimeForecastByStop"

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <getUserRealTimeForecastByStop xmlns="http://miz.it/infotransit">
      <auth>
        <user>string</user>
        <password>string</password>
      </auth>
      <handShakeUser>
        <userIdentifier>string</userIdentifier>
        <token>string</token>
        <response>NONE or Success or GenericError or NotValidToken or NoExistingUser or WsAuthenticationError</response>
      </handShakeUser>
      <busStopId>string</busStopId>
    </getUserRealTimeForecastByStop>
  </soap:Body>
</soap:Envelope>
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <getUserRealTimeForecastByStopResponse xmlns="http://miz.it/infotransit">
      <getUserRealTimeForecastByStopResult>string</getUserRealTimeForecastByStopResult>
    </getUserRealTimeForecastByStopResponse>
  </soap:Body>
</soap:Envelope> 
```

**LogCat 中的系统错误：**

```
04-23 17:31:50.819: W/System.err(11156): SoapFault - faultcode: 'soap:Server' faultstring: 'System.Web.Services.Protocols.SoapException: Server was unable to process request. ---> System.NullReferenceException: Object reference not set to an instance of an object.
04-23 17:31:50.819: W/System.err(11156):    at UserServices.isWsAuthenticatedPUB(WsAuthentication _wsAuth) in c:\DISK_E\SAE\Infotransit\App_Code\UserServices.cs:line 609
04-23 17:31:50.819: W/System.err(11156):    at UserServices.getUserRealTimeForecastByStop(WsAuthentication auth, HandShake handShakeUser, String busStopId) in c:\DISK_E\SAE\Infotransit\App_Code\UserServices.cs:line 460
04-23 17:31:50.819: W/System.err(11156):    --- End of inner exception stack trace ---' faultactor: 'null' detail: org.kxml2.kdom.Node@41b00dc0
04-23 17:31:50.819: W/System.err(11156):    at org.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:141)
04-23 17:31:50.823: W/System.err(11156):    at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:140)
04-23 17:31:50.823: W/System.err(11156):    at org.ksoap2.transport.Transport.parseResponse(Transport.java:116)
04-23 17:31:50.823: W/System.err(11156):    at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:259)
04-23 17:31:50.823: W/System.err(11156):    at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:114)
04-23 17:31:50.823: W/System.err(11156):    at com.mso.master.SoapAccess$1.run(SoapAccess.java:58) 
```

有没有人可以告诉我如何连接到这个网站并得到一些结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T00:38:05.677

如果您只是想连接到网站并获取内容（JSON），我建议您使用 java httpconnection 类。您可以获得文件内容的输入流。

# python - 如何在 mako 模板中设置变量？

> ID：16173463
> 
> 赞同：4
> 
> 时间：2013-04-23T15:33:17.750
> 
> 标签：python, mako

我希望能够创建一个变量“hasBannana”，它只存在于检查某些事情的 mako 模板 html 中。假设从生成模板的函数传入了grocery and and store。

```
%for customer in store:

hasBannana = false // Invalid syntax
%for item in grocery:

%if item == 'Bannana':
  hasBannana = true  // Invalid syntax
%endif

%if hasBannana: // Invalid syntax
  <span>Bought a Bannana</span>
%endif
%end for 
```

如何更正此语法？这甚至可能是我想做的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T15:47:54.607

你的结束`%endfor`标签有问题，应该有两个。

if标签之间的代码将被输出，`<% blah %>`然后代码将被执行。

```
% for item in ('apple', 'banana'):
    <%
        isBanana = False
    %>
    % if item == 'banana':
    <%
        isBanana = True
    %>
    %endif
    % if isBanana:
        <span> Bought a banana</span>
    %endif
%endfor 
```

# jquery - 除非您摆弄安全设置，否则 Ajax 调用在 IE 中不起作用

> ID：16173464
> 
> 赞同：2
> 
> 时间：2013-04-23T15:33:19.093
> 
> 标签：jquery, ajax, internet-explorer, activex

IE有时很糟糕。直到 IE 10，IE 才提供对 XMLHttpRequest 对象的支持。相反，您必须使用 XActiveXObject 对象来运行 AJAX 调用。默认情况下，JQuery 会启动这个对象，并在它存在的情况下在整个三元函数中维护它（本质上，如果你的浏览器是 IE，那么它一直都是如此）。

但是，您已经可以看到问题所在。为了使用这个 ActiveX 对象，您必须调整 IE 中的安全设置，以允许 scriplet、未签名的 ActiveX schtuff 等。

有没有办法绕过这些安全设置（比如安装 CAB 文件来签署该死的东西），以便最终用户不必摆弄他们的浏览器设置，一切都可以开箱即用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:07:07.190

jQuery 不像您建议的那样在 Internet Explorer 中偏爱 ActiveX 而不是 XMLHttpRequest。相反，它检查它的存在，然后继续检查文件 a 是否是本地文件。如果不满足其中任何一个条件，则会发出标准 XHR 请求。

```
jQuery.ajaxSettings.xhr = window.ActiveXObject 
    // If ActiveXObject exists, and the file is not local, return Standard XHR
    // If ActiveXObject exists, and the file is local, return ActiveXHR
    ? function() {
        return !this.isLocal && createStandardXHR() || createActiveXHR(); } 
    // If ActiveXObject doesn't exist, use StandardXHR
    : createStandardXHR; 
```

同样的事情几乎可以这样写：

```
jQuery.ajaxSettings.xhr = (window.ActiveXObject && this.isLocal) 
    ? createActiveXHR() 
    : createStandardXHR(); 
```

希望这更容易理解。

我应该注意到这在 jQuery 2.0 中发生了巨大的变化：

```
jQuery.ajaxSettings.xhr = function() {
    try {
        return new XMLHttpRequest();
    } catch( e ) {}
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T17:46:05.883

所以，这就是我为纠正这种情况所做的事情。我原来的问题如下：

如何在 IE 中进行 Ajax 调用并强制它绕过 ActiveX 安全设置。

正如我们在上面的评论中所讨论的，在 JQuery 1.8.2 中，ActiveXObject 仅在 ajaxsettings.isLocal 为真时才用于 IE，在本例中是这样。我们不支持 IE8 以下的任何东西，它具有 XMLHttpRequest 的完整实现（当然，它不使用 ActiveX），因此我想确保 Ajax 总是使用 XMLHttpRequest。

因此，我在全局级别进行了以下设置更改：

```
$ajaxSetup({
    isLocal: false
}); 
```

这导致 IE 总是认为 Ajax 调用是跨域的，迫使 JQuery 使用 XMLHttpRequest 对象，完全绕过了识别甚至关心 IE 的 ActiveX 安全设置的需要。

结案。

# django - 每次我部署到 heroku 我都会收到超时错误

> ID：16173467
> 
> 赞同：2
> 
> 时间：2013-04-23T15:33:25.593
> 
> 标签：django, heroku

我已经使用 Heroku 一年多了来部署我的 Django 应用程序。

突然，每次我推送到 Heroku 时（没有任何重大更改），我都会收到错误消息，`(Utils::TimeoutError)`

```
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:appname.git' 
```

它每次都会发生，但在我的`requirements.txt`文件中安装所有软件包的不同阶段。

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:48:15.983

python构建包的文档讨论了这个

> 构建超时
> 
> 这通常是由同时安装的大量依赖项引起的。
> 
> 有时，这是由 Python 解释器升级引起的。在这种情况下，您有两个选择：
> 
> 将runtime.txt 文件添加到您的存储库，该文件指定您正在使用的python 的现有版本（例如python-2.7.3）。学到更多。
> 
> 再次安装所有依赖项。我建议只用一半的依赖项推送一次，然后再用所有的依赖项推送一次。这样你就不会超时。
> 
> 一旦安装它们，它们就会被缓存，所以你不应该再次遇到这种情况。

你可以在这里看到更多[https://github.com/heroku/heroku-buildpack-python/wiki/Troubleshooting#build-timeout](https://github.com/heroku/heroku-buildpack-python/wiki/Troubleshooting#build-timeout)。

# javascript - 什么是 JavaScript 的服务器端渲染？

> ID：16173469
> 
> 赞同：27
> 
> 时间：2013-04-23T15:33:30.967
> 
> 标签：javascript, rendering, client-side, dust.js

Dust.js 等一些 javascript 框架声称它们也支持服务器端渲染（除了客户端渲染）。有人可以解释这是如何工作的吗？我的理解是 JS 总是在浏览器运行时执行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-23T15:39:43.970

JavaScript 可以在使用[Node.js](http://nodejs.org/)等系统的服务器上运行。

关于[Dust.js](http://akdubya.github.io/dustjs/#guide)，一个模板引擎，它可以在服务器上生成超文本和 HTML，并将这些内容直接发送到客户端的浏览器。这通常用于避免由于浏览器需要瞬间通过 Dust.js 之类的框架填充视图的模板而导致临时空模板的闪烁。缺点是页面的加载时间会稍长一些，因为在将数据发送到客户端之前，必须在服务器上完成更多的工作。

查看[这个问题](https://stackoverflow.com/questions/8372099/should-i-render-this-template-using-javascript-or-the-server)，了解服务器端渲染的优缺点。必须在缓慢的后处理（需要用户的浏览器来完成工作）或缓慢的预处理（让服务器在用户看到任何东西之前完成工作）之间做出选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-10-13T19:50:35.957

3个主要的渲染方法是：

**客户端渲染 (CSR)**

是 ReactJS 等现代前端框架的默认渲染过程，服务器只返回一个几乎为空的 index.html 文件，然后使用 Javascript 的用户浏览器加载并构建所有内容。

**服务器端渲染（SSR）**：

指在服务器中生成HTML内容的过程，**按需**为每个请求。通常，您将通过设置一个运行诸如 Express 或 Next.js（使用 NodeJS）之类的服务器来完成此操作，该服务器会根据每个请求呈现您的 React 应用程序——就像使用更传统的基于 PHP 或 Rails 的网站一样。

**静态站点生成器 (SSG)**：

服务器端渲染和静态站点生成器都涉及为每个站点的 URL 生成 HTML。不同之处在于静态渲染**在构建时发生一次**，而服务器渲染在用户请求每个文件时按需发生。

使用静态渲染，您需要提前为每个可能的请求生成响应。但是，如果您正在构建无法预测所有可能请求的东西，例如搜索页面，该怎么办？或者，如果您有很多用户生成的内容，并且每次请求的响应都会发生变化怎么办？在这种情况下，您将需要服务器端渲染。

*****那么你应该使用哪个？*****

这取决于。

如果 SEO 无关紧要——例如，一个登录屏幕后面的应用程序——那么 CSR 很好，你只需要像 ReactJS 这样的东西

如果你需要一个好的 SEO：

a）如果您可以预测内容（在构建时生成它），那么您需要 SSG 并且应该选择 NextJS 之类的东西

b）如果您无法预测内容/可能的请求，服务器将需要按需生成页面，因此您需要 SSR 并且应该选择 NextJS 之类的东西。

注意：NextJS 允许您在同一个项目中选择性地混合 3 种主要呈现形式。它们也是市场上其他很好的解决方案，例如 Gatsby。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-13T15:35:28.153

服务器端渲染是将 JavaScript 转换为静态 html 和 css。早期的 JS 倾向于最后加载以优化网站性能。但问题是它影响了搜索引擎优化。所以服务器端渲染成为解决这个问题的解决方案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-02-18T13:39:24.827

服务器端渲染 (SSR) 在服务器端执行 JavaScript [SPA 应用程序]。

与在客户端执行 JavaScript 时的客户端呈现相反。

服务器端渲染是一种相对较新的技术/热力，它允许像 React 或 Angular 这样的 SPA 框架变得对 SEO 更友好。由于服务器上的额外工作，技术效率相当低。相反，创建 SPA（单页应用程序）然后在服务器上执行它，应该首先考虑创建多页应用程序。

SSR 术语在某种程度上是模棱两可和令人困惑的，因为有些人使用它来指代传统的多页面网站，例如那些基于 Wordpress 构建的网站，或者由服务器生成 HTML 页面的任何 PHP 或 Java 后端，有些人仅将其用于 SPA呈现在服务器上。

后者，恕我直言，“更正确”，因为它产生的混乱更少。

# android - 将列中的所有行更新为新值

> ID：16173473
> 
> 赞同：4
> 
> 时间：2013-04-23T15:33:40.327
> 
> 标签：android, sqlite, android-sqlite

抱歉，我相信这已经被问过很多次了，但我已经四处寻找一个很好的例子，但一直找不到。

我想运行一种方法来将值插入到表中所有行的特定列中。为了让您了解我正在使用的方法和查询，这是我的学生表的工作更新方法：

```
public void updateStudent(long id,String name, String age, String points,
        String teachernote,byte[] blob) {
    ContentValues cv = new ContentValues();
    cv.put(Students.STUDENT_NAME, name);
    cv.put(Students.STUDENT_AGE, age);
    cv.put(Students.STUDENT_POINTS, points);
    cv.put(Students.TEACHERNOTE, teachernote);
    cv.put(Students.IMAGE,blob);

    db = sqlHp.getWritableDatabase();
    db.update(Students.TABLE, cv, Students.STUDENT_ID+"="+ id, null);
    db.close();
} 
```

我正在查询更新所有行的 STUDENT_POINTS。任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:53:02.103

如果要更新所有行，则必须删除该`where`子句。在您的示例中，您应该`Students.STUDENT_ID+"="+ id`从 `db.update(Students.TABLE, cv, Students.STUDENT_ID+"="+ id, null);`

# javascript - ExtJS 4 Form.submit() 没有成功：答案为真

> ID：16173474
> 
> 赞同：4
> 
> 时间：2013-04-23T15:33:59.033
> 
> 标签：javascript, extjs, extjs4

我有一个[表单](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.form.Panel)，它是这样提交的：

```
form.submit({
                url: '/postme',
                waitMsg: 'Loading...',
                method: 'POST',
                success: function (form, action) {
                   console.log(action.response.responseText);                                   
                }
            }); 
```

但！在回答我没有财产`success: true`并且无法设法添加它的主要事情。有没有办法在[Ext.Ajax.request](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.Ajax-method-request)`callback`中制作类似参数的东西， 而不是？或者也许有办法告诉 form.submit() 它必须在其他响应参数中检测到成功？`success`

顺便说一句：a 不能使用 Ext.Ajax.request 因为我必须从表单（文件上传）传递多部分数据。

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T15:36:55.730

[API](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.form.Basic)解释说，您必须通过才能`success: true`调用成功处理程序。这是该`submit`方法的文档

> @param {Object} options 传递给动作的选项（详见 Ext.form.Basic.submit 和 Ext.form.Basic.doAction ）

```
if (form.isValid()) {
    // Submit the Ajax request and handle the response
    form.submit({
        success: function(form, action) {
            Ext.Msg.alert('Success', action.result.message);
        },

        // If you don't pass success:true, it will always go here
        failure: function(form, action) {
            Ext.Msg.alert('Failed', action.result ? action.result.message : 'No response');
        }
    });
} 
```

如果您想使用不同的属性来指示错误，您应该查看[http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.form.Basic-cfg-errorReader](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.form.Basic-cfg-errorReader)，您可以配置 errorReader 以根据需要读取您的属性。

您还可以将成功和失败处理程序都路由到同一个地方，并从处理程序中确定它

一定要设置`standardSubmit:true`它不会被 AJAX 提交

**让您的代码感觉不那么脏的示例解决方案**

```
Ext.define('ns.my.CustomReader', {
    extend: 'Ext.data.reader.Reader', 
    alias: 'reader.ns-customreader',
    read: function(xhr) 
         var resp = Ext.JSON.decode(response.responseText, true);
         // Handle the case where response is not JSON too (unhandled server errror?)
         return {success: resp ? !!resp.id : false};
    }
}); 
```

然后，当您创建表单时，您可以使用

```
 form : {
     errorReader: 'ns-customreader'
 } 
```

我还注意到您没有返回记录，读者应该根据文档执行此操作，可能只是您不需要它，但最好满足接口以使您的代码保持一致使用 Ext-JS

> errorReader 不必是 Reader 的完整实现。它只需要实现一个 read(xhr) 函数，该函数在具有以下结构的对象中返回一个记录数组：

```
{ records: recordArray } // I think it needs success: boolean also. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T13:34:58.097

如果你不发送`success: true`它显然会失败。因此，在类似于此的失败回调函数中处理您的参数，您的替代方法`success`是`status`：

```
form.submit({
    url: '/postme',
    waitMsg: 'Loading...',
    method: 'POST',
    success: function (form, action) {
        console.log(action.response.responseText);                                   
    },
    failure: function(form, action) {
        if (action.result.status == true) {
            console.log('success!');
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-23T15:21:03.427

除了@Juan Mendes 的回答，我发现以下条件必须为真：

在服务器端

*   正确的 json 需要有一个**成功** *true* : {"success":true}
*   返回的 contentType 必须设置为**text/html**

这适用于 extjs-3.4.0 版本

请看：[为什么extjs表单提交中没有调用成功回调？](https://stackoverflow.com/questions/14110084/why-success-callback-is-not-called-in-extjs-form-submission)

这节省了我很多时间，我希望它可以帮助别人。

# java - Java：包含（）方法

> ID：16173475
> 
> 赞同：0
> 
> 时间：2013-04-23T15:34:04.300
> 
> 标签：java, algorithm, contains

尝试在`contains()`不使用内置方法的情况下实现方法`contains()`。

这是我的代码：

```
public static boolean containsCS(String str, CharSequence cs) {
    //char[] chs = str.toCharArray();
    boolean result = false;

    int i=0;
    while(i<str.length()) {
        int j=0;
        while(j<cs.length()) {
            if(NEED TO CHECK IF THERE IS AN INDEX OUT OF BOUNDS EXCEPTION) {
                result = false;
                break;
            }
            if(str.charAt(i+j)==cs.charAt(j)) {
                result|=true; //result = false or true ->>>>> which is true.
                j++;
            } else {
                result = false;
                break;
            }
        }
        i++;
    }
    return false;
} 
```

比方说：

```
String   str = "llpll"
Charsequence cs = "llo" 
```

我想确保此方法在上述`Charsequence`有一个或多个`char`要检查但`String`用完长度的情况下正常工作。我应该如何写第一个`if`语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:39:15.053

```
if (i+cs.length() > str.length()){
   OUT OF BOUNDS
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T16:08:10.687

好吧，如果是我，我首先要检查的是我的 char 序列的长度 <= 到我的字符串的长度。

一旦你砍掉那个逻辑路径。如果长度相等，您可以使用 == 那么如果您将 str 切成 cs 长度部分，您也可以在那里进行直接比较。

例如，TonyJ 的 str 和搜索三个字符的序列会堆积如山

托尼·纽约

一个循环，一个 if 语句，而且更加清晰。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:36:34.060

我建议使用[它](http://commons.apache.org/proper/commons-lang/)并在其中使用[contains](http://commons.apache.org/proper/commons-lang/javadocs/api-release/org/apache/commons/lang3/StringUtils.html#contains%28java.lang.CharSequence,%20java.lang.CharSequence%29)方法。

编辑 - 对于阅读障碍：链接的方法**不是**来自 java.lang.String 或 java.lang.Object

如果您不屑于实际查看链接，您会发现它是我引用的 Apache Commons-Lang API 和 StringUtils.contains(...) 方法，它非常清楚地回答了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:49:59.003

如果这是为了你的家庭作业，我怀疑是这样，那么我建议你看一下[String 类的 API，](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html)看看还有哪些其他方法可以帮助找到一个 String 在另一个 String 中的位置。

还可以考虑查看 String 的源代码以了解它是如何实现的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T16:00:49.947

我相信你已经知道这一点，但实际上可以看到内置类和方法的实际源代码。所以我先看看那里。IMO，String 类特别有趣。

# firewall - 传输中超过 ICMP 时间

> ID：16173476
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:34:04.540
> 
> 标签：firewall, freebsd, icmp, ddos

最近几天我的服务器遭受了这种攻击：（带宽> 60MBit / s，XXX.XXX.XXX.XXX是多个IP）

```
 tcpdump -n proto ICMP    
    17:15:19.267464 IP XXX.XXX.XXX.XXX > my_ip: ICMP time exceeded in-transit, length 36
    17:15:19.325217 IP XXX.XXX.XXX.XXX > my_ip: ICMP time exceeded in-transit, length 36
    17:15:19.345561 IP XXX.XXX.XXX.XXX > my_ip: ICMP time exceeded in-transit, length 56
    17:15:19.484865 IP XXX.XXX.XXX.XXX > my_ip: ICMP time exceeded in-transit, length 36
    17:15:19.529616 IP XXX.XXX.XXX.XXX > my_ip: ICMP time exceeded in-transit, length 36
    17:15:19.957058 IP XXX.XXX.XXX.XXX > my_ip: ICMP YYY.YYY.YYY.YYY tcp port 39692 unreachable, length 36
    17:15:19.968957 IP XXX.XXX.XXX.XXX > my_ip: ICMP host YYY.YYY.YYY.YYY unreachable, length 56
    17:15:20.112520 IP XXX.XXX.XXX.XXX > my_ip: ICMP host YYY.YYY.YYY.YYY unreachable, length 56
    17:15:20.203199 IP XXX.XXX.XXX.XXX > my_ip: ICMP host YYY.YYY.YYY.YYY unreachable, length 36
    17:15:20.204803 IP XXX.XXX.XXX.XXX > my_ip: ICMP host YYY.YYY.YYY.YYY unreachable, length 36 
```

我有 FreeBSD 9.1，我的 pf.conf 是

```
ext_if="em0"
table <blockedips> persist file "/etc/pf-blocked-ips.conf"

set skip on lo0

block drop in log (all) quick on $ext_if from <blockedips> to any

block in
pass out flags S/SA keep state

pass in on $ext_if proto tcp to port 80 flags S/SA keep state
pass in on $ext_if proto tcp to port ssh flags S/SA synproxy state 
```

有什么我可以用 pf 做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:45:16.447

看起来您可能会收到来自 ddos​​ 攻击的一些反向散射（[http://blog.usu.edu/security/2010/08/24/backscatters-the-name-dos-the-game/](http://blog.usu.edu/security/2010/08/24/backscatters-the-name-dos-the-game/)）。

除非您可以在它们到达您的服务器之前在交换机中过滤它们，否则您对此无能为力；它们已经作为网络异常被丢弃在内核中。

# scala - Scala 中 Null / Nothing / Unit 的用法

> ID：16173477
> 
> 赞同：97
> 
> 时间：2013-04-23T15:34:07.523
> 
> 标签：scala

我刚刚读过： http: [//oldfashionedsoftware.com/2008/08/20/a-post-about-nothing/](http://oldfashionedsoftware.com/2008/08/20/a-post-about-nothing/)

据我了解，`Null`是一个特征，它的唯一实例是`null`.

当一个方法接受一个 Null 参数时，我们只能将一个`Null`引用或`null`直接传递给它，而不能传递任何其他引用，即使它是 null （`nullString: String = null`例如）。

我只是想知道在哪些情况下使用此`Null`特征可能有用。还有一个 Nothing 特质，我真的没有看到更多的例子。

* * *

我也不明白使用 Nothing 和 Unit 作为返回类型有什么区别，因为两者都不返回任何结果，例如当我有一个执行日志记录的方法时如何知道使用哪一个？

* * *

除了返回类型之外，您是否有 Unit / Null / Nothing 的用法？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-04-23T15:40:30.263

只有在方法永远不会返回时才使用 Nothing（这意味着它无法通过返回正常完成，它可能会引发异常）。没有什么是永远不会被实例化的，并且是为了类型系统的利益而存在的（引用 James Iry 的话：[“Scala 拥有底层类型的原因与它表达类型参数变化的能力有关。”](http://james-iry.blogspot.com/2009/08/getting-to-bottom-of-nothing-at-all.html)）。从您链接到的文章中：

> Nothing 的另一种用途是作为从不返回的方法的返回类型。如果您考虑一下，这是有道理的。如果一个方法的返回类型是 Nothing，并且绝对不存在 Nothing 的实例，那么这样的方法绝对不能返回。

您的日志记录方法将返回 Unit。有一个值 Unit 所以它实际上可以被返回。从[API 文档](http://www.scala-lang.org/api/current/index.html#scala.Unit)：

> Unit 是 scala.AnyVal 的子类型。Unit 类型的值只有一个，()，并且它不被底层运行时系统中的任何对象表示。具有返回类型 Unit 的方法类似于声明为 void 的 Java 方法。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-23T16:40:46.420

您引用的文章可能具有误导性。该`Null`类型的存在是为了与*Java 虚拟机*，尤其是 Java 兼容。

我们必须考虑*Scala*：

*   完全面向对象：每个值都是一个对象
*   是强类型的：每个值都必须有一个类型
*   需要处理`null`对访问的引用，例如 Java 库和代码

因此，有必要为该`null`值定义一个类型，即`Null`特征，并`null`作为其唯一实例。

`Null`除非您是类型系统或正在编译器上开发，否则类型中没有什么特别有用的。特别是我看不出任何合理的理由来`Null`为方法定义类型参数，因为除了`null`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-04-23T16:40:46.820

> 除了返回类型之外，您是否有 Unit / Null / Nothing 的用法？

* * *

`Unit`可以这样使用：

```
def execute(code: => Unit):Unit = {
  // do something before
  code
  // do something after
} 
```

这允许您传入要执行的任意代码块。

* * *

`Null`可以用作任何可为空的值的底部类型。一个例子是这样的：

```
implicit def zeroNull[B >: Null] =
    new Zero[B] { def apply = null } 
```

* * *

`Nothing`用于定义`None`

```
object None extends Option[Nothing] 
```

这允许您将 a 分配`None`给任何类型，`Option`因为`Nothing`“扩展”所有内容。

```
val x:Option[String] = None 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-04-07T04:35:29.627

如果您使用`Nothing`，则无事可做（包括打印控制台） 如果您做某事，请使用输出类型`Unit`

```
object Run extends App {
  //def sayHello(): Nothing = println("hello?")
  def sayHello(): Unit = println("hello?")
  sayHello()
} 
```

……那怎么用`Nothing`？

```
trait Option[E]
case class Some[E](value: E) extends Option[E]
case object None extends Option[Nothing] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-23T15:50:38.023

我从来没有真正使用过这个`Null`类型，但是你使用`Unit`，你会在 java 上使用`void`. `Nothing`是一种特殊类型，因为正如 Nathan 已经提到的，不能有`Nothing`. `Nothing`是所谓的底部类型，这意味着它是任何其他类型的子类型。这（和逆变类型参数）就是为什么您可以将任何值添加到`Nil`- 这是一个`List[Nothing]`- 并且列表将属于此元素类型。`None`也是 if 类型`Option[Nothing]`。每次尝试访问此类容器中的值都会引发异常，因为这是从 type 方法返回的唯一有效方式`Nothing`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-06-29T23:34:43.790

**没有什么**经常被隐式使用。`val b: Boolean =` `if (1 > 2) false` `else throw new RuntimeException("error")` 在下面的代码中， **else**子句的类型是**Nothing**，它是 Boolean（以及任何其他 AnyVal）的子类。因此，整个赋值对编译器是有效的，尽管**else**子句并没有真正返回任何东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-06-06T22:09:19.430

`Nothing`以下是from的示例`scala.predef`：

```
 def ??? : Nothing = throw new NotImplementedError 
```

如果您不熟悉（并且搜索引擎无法搜索）`???`，Scala 的占位符函数可用于尚未实现的任何内容。就像 Kotlin 的`TODO`.

您可以在创建模拟对象时使用相同的技巧：使用自定义方法覆盖未使用的`notUsed`方法。不使用的好处`???`是你不会得到你从未打算实现的东西的编译警告。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-05T16:48:50.747

就范畴论而言，**Nothing**是**初始对象**，**Unit**是**终端对象**。

[https://en.wikipedia.org/wiki/Initial_and_terminal_objects](https://en.wikipedia.org/wiki/Initial_and_terminal_objects)

**初始对象**也称为**共同**终端或**通用**，**终端对象**也称为**最终**对象。

如果一个对象既是**初始**对象又是**终结**对象，则称**为零对象**或**空**对象。

# c# - 移至对象内的自定义 IEnumerable 中的下一项

> ID：16173479
> 
> 赞同：-3
> 
> 时间：2013-04-23T15:34:10.080
> 
> 标签：c#, linq, inheritance

我有一个继承自`IEnumerable`. 我需要这个类中的一个方法，它将导航到列表中的下一个项目，并相应地循环回到开头。

一些示例代码如下：

```
public class Enrolments : IEnumerable<IEnrolment>
{
    public IEnrolment GetNextEnrolment()
    {

    }
} 
```

我需要以下测试才能有效

```
 IEnrolment enrolment1 = new Enrolment();
        IEnrolment enrolment2 = new Enrolment();

        Enrolments enrolments = new Enrolments {enrolment1, enrolment2};

        IEnrolment current;
        Assert.That(current, Is.EqualTo(enrolment1));

        current = enrolments.GetNextEnrolment();
        Assert.That(current, Is.EqualTo(enrolment2));

        current = enrolments.GetNextEnrolment();
        Assert.That(current, Is.EqualTo(enrolment1));

        current = enrolments.GetNextEnrolment();
        Assert.That(current, Is.EqualTo(enrolment2)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:38:55.910

听起来您想使用[IEnumerator](http://msdn.microsoft.com/en-us/library/1t2267t6.aspx)接口。这将起作用：

```
IEnrollment enrollment1 = new Enrollment();
IEnrollment enrollment2 = new Enrollment();

Enrollments enrollments = new Enrollments(enrollment1, enrollment2);
IEnumerator<IEnrollment> enumerator = enrollment.GetEnumerator();

enumerator.MoveNext();
Assert.That(enumerator.Current, Is.EqualTo(enrollment1));

enumerator.MoveNext();
Assert.That(enumerator.Current, Is.EqualTo(enrollment2));

enumerator.Reset(); // Move back to the beginning of the list

enumerator.MoveNext();
Assert.That(enumerator.Current, Is.EqualTo(enrollment1));

enumerator.MoveNext();
Assert.That(enumerator.Current, Is.EqualTo(enrollment2)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:39:20.143

您可以为此使用产量

检查[此](http://msdn.microsoft.com/en-us/library/9k7k7cf0%28v=vs.80%29.aspx)链接以获取说明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:01:49.733

如果您有一个列表或其他索引集合作为私有字段，那么要实现此方法，您只需存储一个表示当前（或下一个）索引的整数。这样，该方法的实现就像增加索引一样简单，通过集合长度对其进行修改（以获得所需的包装行为），然后返回该索引处的项目：

```
public class Enrolments : IEnumerable<IEnrolment>
{
    private List<IEnrolment> list = new List<IEnrolment>();
    private int currentIndex;

    public IEnrolment GetNextEnrolment()
    {
        currentIndex = (currentIndex + 1) % list.Count;
        return list[currentIndex];
    }

    //TODO implementations of Add and GetEnumerator
} 
```

请注意，与其拥有自己的`GetNextEnrolment`方法，不如拥有一个`IEnumerable<IEnrolment>`简单地永远持续下去、反复迭代自身的方法，而不是这种自定义方法。您可以使用一种通用方法永远重复任何序列，而不是为此专门设置它：

```
public static IEnumerable<T> Repeat<T>(IEnumerable<T> sequence)
{
    while (true)
    {
        foreach (var item in sequence)
            yield return item;
    }
} 
```

使用它，因为您的序列`IEnumerable<IEnrolment>`已经实现，您可以这样做：

```
Enrollments enrollments = new Enrollments(enrollment1, enrollment2);

IEnumerable<IEnrolment> repeatingSequence = Repeat(enrollments); 
```

这里的好处是你可以`foreach`超越那个重复序列（尽管`break`如果你这样做，你会在某些情况下想要一个，除非你打算永远去），在它上面使用 LINQ 操作，或者依赖其他基于周围的通用帮助器方法`IEnumerable<T>`

# wpf - wpf 绑定到数组索引时，fallbackvalue 似乎不起作用

> ID：16173488
> 
> 赞同：2
> 
> 时间：2013-04-23T15:34:46.237
> 
> 标签：wpf, binding, fallbackvalue

我有一个简单的网格，我在其中将行高绑定到一个数组成员。但是如果用户输入错误，则内容可能会被清除，即数组索引变得无效。因此，我将 FallbackValue 设置为默认值。但这似乎不起作用。在绑定中，我使用了一个转换器，它将自定义类型转换为所需的 Double。但这不应该是问题的根源。

```
<RowDefinition Name="Row1" Height="{Binding Path=item[0].value, Converter={conv:ItemValueToRowHeight}, FallbackValue=20}"/> 
```

调试输出显示 wpf 绑定系统仍然需要数组项，即使没有项：

```
System.Windows.Data Warning: 17 : Cannot get 'Item[]' value ... 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T19:14:18.337

评论

在以下情况下，绑定成功返回值：

```
The path to the binding source resolves successfully.

The value converter, if any, is able to convert the resulting value.

The resulting value is valid for the binding target (target) property. 
```

[http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.fallbackvalue.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.fallbackvalue.aspx)

让您的转换器返回 DependencyProperty.UnsetValue

# d3.js - d3js 强制扩展工具提示的对象

> ID：16173492
> 
> 赞同：0
> 
> 时间：2013-04-23T15:34:51.087
> 
> 标签：d3.js, tooltip

伙计们-

我一直在尝试向基于 Mike Bostock 的“Mobile Patent Suits”的可视化添加工具提示

[http://bl.ocks.org/mbostock/1153292](http://bl.ocks.org/mbostock/1153292)

我扩展了对象：

{来源：“诺基亚”，目标：“高通”，类型：“套装”}

{来源：“诺基亚”，目标：“高通”，类型：“西装”，工具提示：“我的评论”}

在脚本中添加了[https://gist.github.com/milroc/2975255](https://gist.github.com/milroc/2975255) d3 helper tooltip JS

创建了一个工具提示对象：

```
var tooltip = d3.select("body")
.append("div")
.style("position", "absolute")
.style("z-index", "70")
.style("visibility", "hidden"); 
```

并称之为：

```
var circle = svg.append("svg:g").selectAll("circle")
  .data(force.nodes())
  .enter().append("svg:circle")
  .call(d3.helper.tooltip(function(d,i){return d.name;}))
  .attr("r", 6)
  .call(force.drag); 
```

效果很好，但是如果我将其更改为：

```
 .call(d3.helper.tooltip(function(d,i){return d.tooltip;})) 
```

我得到“未定义”。我之前设法将属性添加到 d3 对象，并将它们称为工具提示，并带有树形图。我不确定我需要在这里做些什么不同的事情。

谢谢，

拉尔夫

编辑：

（首先感谢拉斯！）

尝试添加第二组工具提示，但它似乎是对象“链接”而不是“节点”的结构，这使得滚动一个圆圈是否会产生“源”或“目标”的“nameLabel”工具提示'

扩展对象：

```
{source: "First", target: "Second", type: "dependency", tooltip: "tip for rollover of path", nameLabel: "tip for rollover of circle"} 
```

工作路径提示：

```
var path = svg.append("svg:g").selectAll("path")
.data(force.links())
.enter().append("svg:path")
.attr("class", function(d) { return "link " + d.type; })
.attr("marker-end", function(d) { return "url(#" + d.type + ")"; })
.call(d3.helper.tooltip(function(d,i){return d.tooltip;})); 
```

狡猾的圆圈工具提示：

```
var circle = svg.append("svg:g").selectAll("circle")
.data(force.nodes())
.enter().append("svg:circle")
.call(d3.helper.tooltip(function(d,i){return d.nameLabel;}))
.attr("r", 12)
.call(force.drag); 
```

现在，工具提示确实可以识别圆圈，因为这样可以：

```
.call(d3.helper.tooltip(function(d,i){return d.name;})) 
```

所以我构建了一个我认为可以将名称传递给的函数：

```
function whatTip(theName) {
var fullArray = new Array;
var fullArray = (("FIRST","first tooltip"),("SECOND","second tooltip"),("THIRD","THIRD tooltip"),("FIFTH","FIFTH tooltip"),("SIXTH","sixth tooltip"),("FOURTH","FOURTH tooltip") );
for(var i=0;i<fullArray.length;i++){
if (fullArray[i][0] == theName) {
return fullArray[i][1];
}}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:26:58.633

您还需要在计算节点时添加该属性。假设您使用的代码与您链接到的示例中的代码相同，则需要更改

```
links.forEach(function(link) {
  link.source = nodes[link.source] || (nodes[link.source] = {name: link.source});
  link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
}); 
```

到

```
links.forEach(function(link) {
  link.source = nodes[link.source] || (nodes[link.source] = {name: link.source, tooltip: link.tooltip});
  link.target = nodes[link.target] || (nodes[link.target] = {name: link.target, tooltip: link.tooltip});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-16T20:11:06.990

好吧，伙计们，我想通了：

我最终做的是添加两个属性：sourceTip 和 destTip（因为有些节点只是目的地）。

```
{source: "Forms", target: "AO/TOA", type: "dependency", tooltip: "Forms tooltip here", sourceTip: "Forms tip", destTip: "AO/TOA tip"}, 
```

然后我创建了节点：

```
var mylinks = links.forEach(function(link){
link.source = nodes[link.source] || (nodes[link.source] = {name: link.source, tooltip: link.tooltip, nameTip: link.sourceTip});
link.target = nodes[link.target] || (nodes[link.target] = {name: link.target, tooltip: link.tooltip, nameTip: link.destTip});
}); 
```

唯一的技巧是我将属性“nameTip”设置为sourceTip/destTip，分别用于源和目标。

这意味着我可以使用 nameTip 属性从工具提示中调用它：

```
.append("svg:circle")
         .call(d3.helper.tooltip()
            .attr({class: function(d, i) { return d + ' ' +  i + ' A'; }})
            .style({color: '#a1d373'})
            .text(function(d, i){ return d.nameTip; })
        ) 
```

# c# - OleDbDataAdapter 零星丢失记录

> ID：16173494
> 
> 赞同：2
> 
> 时间：2013-04-23T15:35:03.207
> 
> 标签：c#, ms-access, oledb

在我的应用程序中，我从本地 MS Access 数据库文件中获取了一些数据。我对一个零星的问题感到困惑，我对特定表的所有记录的查询有时会返回所有记录，有时会返回除最后一条记录之外的所有记录。我正在使用以下代码

```
string resourceConStr = @"Provider=Microsoft.ACE.OLEDB.12.0;Data source = C:/FileName.mdb";
OleDbConnection resourceCon = new OleDbConnection(resourceConStr);
OleDbDataAdapter personnelAdapter = new OleDbDataAdapter("Select * From Personnel", resourceCon);
DataTable personnel = new DataTable();
personnelAdapter.Fill(personnel); 
```

当我查看`personnel`DataTable 时，有时我的记录数是正确的，有时我会丢失 Access 表中的最后一条记录。我无法找到任何关于它何时成功以及何时不成功的模式。任何想法可能是什么原因或建议或验证所有记录已成功复制到 DataTable 中的方法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:42:39.110

> 任何...建议或验证所有记录是否已成功复制到 DataTable 中的方法？

一种方法是执行 a `SELECT COUNT(*) AS n FROM Personnel`，并将该数字（假设您返回一个）与`DataTable`填充后的行数进行比较。

# php - 将符号转换为可读

> ID：16173501
> 
> 赞同：0
> 
> 时间：2013-04-23T15:35:33.327
> 
> 标签：php, decode

`echo $title`给了我类似的东西`\u00ca\u00e0\u00f7\u00e5\u00eb\u00e8`。

它应该是可读的文本。如何正确解码？

我试过`html_entity_decode($title, 0, 'UTF-8')`了，但它不适用于非英语语言。我得到类似的东西`Êà÷åëè`而不是真实的文字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:54:21.217

尝试这个

```
$title = mb_convert_encoding($title,'HTML-ENTITIES','utf-8'); 
```

希望这对你有用。编辑：试试这个，如果它有效

```
$title = iconv(mb_detect_encoding($text, mb_detect_order(), true), "UTF-8", $title); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:41:16.390

尝试`echo htmlentities($str, ENT_QUOTES | ENT_IGNORE, "UTF-8");`

# php - 如果在 wordpress 中选择，则显示来自特定类别的 1 个帖子

> ID：16173509
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:00.493
> 
> 标签：php, wordpress, loops

我正在尝试在 wordpress 中创建一个循环，在选择时从 1 个类别中提取 1 个帖子，但如果不是，它应该显示我正在调用的自定义帖子类型的最新帖子。例如推荐、最新消息、案例研究。

这就是我所拥有的，我需要一个ifelse吗？查询猫是否不存在的语句，然后显示该 CPT 中的最新帖子。

这是我的代码。

```
 <?php
                $query = new WP_Query('post_type=testimonial&catergory_name=home&showposts=1&paged=' . $paged);
                $postcount = 0;
            ?>
            <?php if ($query->have_posts()) : ?>
                <?php while ($query->have_posts()) : $query->the_post(); ?>
                    <?php $postcount++; ?>
                    <li> 
                     <A HREF="<?php the_permalink(); ?>"></A>
 <a href="<?php the_permalink(); ?>">
                        <?php
                            if (has_post_thumbnail()) {
                                // check if the post has a Post Thumbnail assigned to it.
                                the_post_thumbnail('thumb-casestudy');
                            }else {
                            ?>
                            <img src="<?php bloginfo('template_url'); ?>/assets/images/default.jpg" alt="<?php the_title(); ?>"/>
                            <?php } ?>
 </a>
                        <h4><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h4>
                        <p class="hm_text"><?php 
                                //the_excerpt(); 
                                echo get_post_meta($query->post->ID, 'wpld_cf_home_page_text', true) 
                        ?></p>

                    </li>
                    <?php endwhile; ?>
                <?php else : ?>
                <?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T20:13:32.173

如果我对您的理解正确：

```
$query->post_count 
```

应该允许您检查查询是否返回任何帖子，如果没有，则可以调用另一个查询。

# ajax - jQuery Mobile - 下一页仍然有前一页网格在新页面内容之上

> ID：16173511
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:03.680
> 
> 标签：ajax, asp.net-mvc-4, jquery-mobile

是的，我真的不知道如何解释这一点，但我会尽力提供一个场景：主页 - > 联系页面 主页元素和文本显示在联系页面文本的顶部。

任何人都知道为什么会发生这种情况？或者过去是否有过类似的问题？

帮助和建议将不胜感激

编辑：还有嵌套菜单，它始终是显示在内容顶部的主页。url 似乎先变成了二级页面 url，然后突然变成了主页 url。它也会闪烁，但我认为这是 jQuery mobile 尚未使用 jQuery mobile 1.2.0 修复的问题

# html - HTML 中 "> 或 " /> 的区别

> ID：16173514
> 
> 赞同：19
> 
> 时间：2013-04-23T15:36:18.743
> 
> 标签：html, tags

<...> 和 <.../> 之间有什么区别吗？

非常直截了当：

```
<meta charset="utf-8">
<meta charset="utf-8" /> 
```

在执行、功能等方面有什么不同吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-23T15:40:13.040

XHTML 要求 ("br"、"input"、"img") 等元素使用尾部斜杠，而在 HTML5 中它们是可选的。

请参阅：[我应该删除元标记中的尾部斜杠吗？](https://stackoverflow.com/questions/3310921/should-i-remove-trailing-slashes-in-meta-tags)

另请参阅：[HTML 5 是否使用尾部斜杠](http://webdesign.about.com/od/html5tags/f/html5-use-trailing-slash.htm)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-23T15:40:47.120

HTML 中没有结束标签的标签（如`<br>`和`<meta>`）称为*自*关闭标签。 `<br>`并且`<br />`在 HTML 中同样有效。

但是，XML 不允许省略结束标记。`<head><meta></head>`是无效的 XML！`/`前面的字符`>`向 XML 指示该标记应立即关闭。也就是说，`<x></x>`在语义上等同`<x />`于 XML。

在编写 HTML 代码时，您应该更喜欢这种形式`<br />`，您也希望它是有效的 XHTML。如果您不关心 XML 或 XHTML，您可以选择您喜欢的语法。

* * *

请注意，它`<br/>`是具有与 相同含义的有效 XML `<br />`，但具有解析错误的旧浏览器会将该标记解析为具有名称的标记`br/`。在标签名称和字符之间添加一个空格`/`可以满足有缺陷的浏览器的解析器（然后将其`/`视为属性名称），同时仍然生成格式良好的 XML。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-23T15:44:10.907

```
<meta charset="utf-8"> 
```

和

```
<meta charset="utf-8" /> 
```

在 HTML5 中都是有效的空标签，而：

```
<meta charset="utf-8"> 
```

在 XHTML 中无效，因为这样的空标记`<br />`必须在 XML中用`/` *（斜杠）关闭，例如：*

```
<meta charset="utf-8" /> 
```

请记住，始终通过以下方式验证您的网站：http: [//validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:39:06.977

```
<meta charset="utf-8"> 
```

打开标签

```
<meta charset="utf-8" /> 
```

是的缩写

```
<meta charset="utf-8"></meta> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-23T15:38:37.790

HTML 中的一些标签称为*自闭合标签*，这些标签是使用的正确代码`</>`。

自闭标签的一个例子是输入：

```
<input type="text value="someval" /> 
```

非自我结束标签将是一个段落，例如：

```
<p> some text </p> 
```

然而，在某些声明下，*必须*对某些元素使用自闭合标签，在使用*xhtml 严格*声明时就是这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T15:39:02.953

“/>”表示这是一个元素的开始和结束标记，即它不包含空格或其他元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-23T15:40:26.387

没有内容（只有属性）的元素可以使用`/>`. 因此，例如，具有内容的元素如下所示：

```
<p>This is some content</p> 
```

随着`</p>`关闭标签。另一方面，没有内容的元素不需要结束标签；您可以使用`/>`速记一次打开和关闭它：

```
<img src="myimg.png"/> 
```

没有结束标签。结束标签在 HTML5 中是可选的，但在基于 XML 的格式（如 XHTML）中是必需的。如果您愿意，您可以关闭常规 HTML5 中的标签；这通常是一个好主意，因为它允许 XML 处理器解析您的 HTML。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-23T15:41:42.227

自闭合标签在 XHTML 中是强制性的，但 HTML（尤其是 HTML5）对它们的规定要宽松得多。

# regex - 如何从正则表达式中排除前导单引号或双引号

> ID：16173517
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:24.500
> 
> 标签：regex, visual-studio-2010

如何在没有单引号或双引号的前导字符和尾随字符的情况下获取目标单词？目前，下面的表达式匹配所有。我尝试插入 [^'] 但它不起作用。

```
[\b(?i)Test\b]

test - match
Test - match
TEST - match
'test' - I do not want this to match
"test" - I do not want this to match 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:44:25.100

你可以使用这个正则表达式

```
(^|[^'"])test([^'"]|$) 
```

# python - QooxDoo FrontEnd + Python BackEnd (SimpleXMLRPCServer) 问题

> ID：16173519
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:31.937
> 
> 标签：python, rpc, qooxdoo, simplexmlrpcserver

我已经尝试过 Qooxdoo 并使用 SimpleXMLRPCServer 制作了一个简单的 Python 服务器，通过 Python 测试我可以毫无问题地获取数据，但是我可以从 Qooxdoo 获取这些数据吗？我迷路了，我已经搜索了 3 天，但没有得到解决方案。

我试试这个：

```
var JSON_lista_empresas = 1000
button1.addListener("execute", function(e) 
{
    var rpc = new qx.io.remote.Rpc();
    rpc.setServiceName("get_data");
    //rpc.setCrossDomain(true);
    rpc.setUrl("http://192.168.1.54:46000");
    rpc.addListener("completed", function(event)
    {
        console.log(event.getData());
    });
    rpc.callAsync( JSON_lista_empresas, '');
}); 
```

我尝试了其他选择，但一无所获:(

文件链接：

[http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo](http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo)

我尝试并阅读了所有 qooxdoo-contrib。

* * *

出色地，

RpcPython --> 好的

并在 class/qooxdoo -> test.py

运行服务器 [start-server.py] 并从 webroser 查询：

```
http://127.0.0.1:8000//?_ScriptTransport_id=1&nocache=1366909868006&_ScriptTransport_data={%22service%22%3A%22qooxdoo.test%22%2C%22method%22%3A%22echo%22%2C%22id%22%3A1%2C%22params%22%3A[%22Por%20fin%22]} 
```

webroser 中的回复是：

qx.io.remote.ScriptTransport._requestFinished(1,{"error": null, "id": 1, "result": "客户说：[Por fin]"});

但是如果我从 qooxdoo 查询，比如回复是 [error.png]

qooxdoo 的代码：

```
var rpc = new qx.io.remote.Rpc( "http://127.0.0.1:8000/");
    rpc.setCrossDomain( true);
    rpc.setServiceName( 'qooxdoo.test');
// asynchronous call
    var handler = function(result, exc) {
        if (exc == null) {
            alert("Result of async call: " + result);
        } else {
            alert("Exception during async call: " + exc+ result);
        }
    };
rpc.callAsync(handler, "echo", "Por fin"); 
```

我输了 ：（（

文件在：

[http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo](http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo)

好吧，使用 Firebug，owncloud qx.io.remote.ScriptTransport 中的这个错误......被检测到

¿?................

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:09:27.497

我猜您将 XML-RPC 与 JSON-RPC 混淆了，而 qooxdoo 仅支持后者。这些协议相似，但数据交换格式不同（XML 或 JSON）。而不是`SimpleXMLRPCServer`您可以在服务器端使用“RpcPython”，这是一个 qooxdoo contrib 项目。

看：

*   [http://qooxdoo.org/contrib/project/rpcpython](http://qooxdoo.org/contrib/project/rpcpython)
*   [http://sourceforge.net/p/qooxdoo-contrib/code/HEAD/tree/trunk/qooxdoo-contrib/RpcPython/](http://sourceforge.net/p/qooxdoo-contrib/code/HEAD/tree/trunk/qooxdoo-contrib/RpcPython/)

启动并运行此服务器后，您应该能够对其进行测试：

*   [http://manual.qooxdoo.org/2.1.1/pages/communication/rpc_server_writer_guide.html#testing-a-new-server](http://manual.qooxdoo.org/2.1.1/pages/communication/rpc_server_writer_guide.html#testing-a-new-server)
*   [http://sourceforge.net/p/qooxdoo-contrib/code/HEAD/tree/trunk/qooxdoo-contrib/RpcPython/trunk/services/class/qooxdoo/test.py](http://sourceforge.net/p/qooxdoo-contrib/code/HEAD/tree/trunk/qooxdoo-contrib/RpcPython/trunk/services/class/qooxdoo/test.py)

之后，您的 qooxdoo（客户端）代码也有望正常工作。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T06:07:02.130

好的，

在第 66 行的 qxjsonrc 模块的文件 http.py 中更改

```
response='qx.io.remote.ScriptTransport._requestFinished(%s,%s);'%(scriptTransportID,response) 
```

为了

```
response='qx.io.remote.transport.Script._requestFinished(%s,%s);'%(scriptTransportID,response) 
```

并且运行良好:))

这个包修改的链接：

[http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo](http://mieresdelcamin.es/owncloud/public.php?service=files&dir=%2Fjesus%2Ffiles%2FQooxdoo)

最好的问候和感谢！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-16T14:09:40.740

正如 Richard 已经指出的那样，Qooxdoo 只支持它的 JSON-RPC 风格。

我维护了一个名为[QooxdooCherrypyJsonRpc的原始](https://pypi.python.org/pypi/QooxdooCherrypyJsonRpc)*rpcpython*的分支。主要目标是将传输协议交给一些健壮的框架，只留下 JSON RPC 的东西。CherryPy 显然是一个健壮的框架，允许 HTTP、WSGI 和 FastCGI 部署。代码被重构并被测试覆盖。后来我添加了上传/下载支持和一致的时区日期时间交换。

至少你的 Python 后端可能看起来像（称之为 test.py）：

```
import cherrypy
import qxcpjsonrpc as rpc

class Test(rpc.Service):

  @rpc.public
  def add(self, x, y):
    return x + y

config = {
  '/service' : {
    'tools.jsonrpc.on' : True
  },
  '/resource' : {
    'tools.staticdir.on'  : True,
    'tools.staticdir.dir' : '/path/to/your/built/qooxdoo/app'
  }
}
cherrypy.tools.jsonrpc = rpc.ServerTool()

if __name__ == '__main__':
  cherrypy.quickstart(config = config) 
```

然后您可以在您的 qooxdoo 代码中执行以下操作：

```
var rpc = new qx.io.remote.Rpc();
rpc.setServiceName('test.Test');
rpc.setUrl('http://127.0.0.1:8080/service');
rpc.setCrossDomain(true); // you need this for opening app from file://
rpc.addListener("completed", function(event)
{
  console.log(event.getData());
});
rpc.callAsyncListeners(this, 'add', 5, 7); 
```

或者直接打开链接：

```
http://127.0.0.1:8080/service?_ScriptTransport_id=1&_ScriptTransport_data=%7B%22params%22%3A+%5B12%2C+13%5D%2C+%22id%22%3A+1%2C+%22service%22%3A+%22test.Test%22%2C+%22method%22%3A+%22add%22%7D 
```

有关更多信息，请查看我在上面发布的包页面。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-25T11:57:16.590

Richard Sternagel 写了关于 rpcpython 的文章。此版本的 rpcpython 不适用于当前版本的 simplejson。因为在 json.py 有不正确的导入：

```
 from simplejson.decoder import ANYTHING
    from simplejson.scanner import Scanner, pattern 
```

改进 rpcpython 或使用其他服务器，例如 CherryPy。

# regex - N++ 正则表达式 - 交换订单

> ID：16173521
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:33.183
> 
> 标签：regex, notepad++

我有任务交换顺序块订单，我需要交换订单：

```
 <!--Validate first group-->
     <lookupGroup name='Get 1st  value '>
        <Properties>
            <select property='A' field='B[0]'/>
        </Properties>
    </lookupGroup>
    <Include>..\Value\Test1.xml</Include>
    <Include>..\Value\Test2.xml</Include>
    <Include>..\Value\Test3.xml</Include>
    <Include>..\Value\Test4.xml</Include> 
```

所以上面写的需要倒序：

```
 <Include>..\Value\Test2.xml</Include>
    <Include>..\Value\Test3.xml</Include>
    <Include>..\Value\Test4.xml</Include>

    <!--Validate first group-->
     <lookupGroup name='Get 1st  value '>
        <Properties>
            <select property='A' field='B[0]'/>
        </Properties>
    </lookupGroup>
    <Include>..\Value\Test1.xml</Include> 
```

它的正确语法是什么？任何帮助，将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:41:13.000

此正则表达式适用于您的示例数据，并且每次您点击替换时，都会一次将包含元素移动到 lookupGroup 上方。希望这可以帮助。

找什么：`( *<lookupGroup.*lookupGroup>.*\n)([^\n]*<Include>.*<.Include>)\n?`

用。。。来代替：`\2\n\1`

为此，您必须拥有“。” 设置为匹配换行符。

# android - 从mysql表解析数据时出错

> ID：16173525
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:39.963
> 
> 标签：android, mysql, json

我有我的安卓应用程序。假设让用户进入一个区域，然后它会拉动我的 myqsl 表中的所有组织并将其显示在手机上，但是当我运行应用程序时，我收到了这个错误：

```
Error parsing data org.json.JSONException: 
  Value <?xml of type java.lang.String cannot be converted to JSONArray 
```

这是我的代码：

JSON解析器

```
 package com.example.islamicorg;

import java.util.ArrayList;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import android.app.Activity;
import android.os.Bundle;
import android.os.StrictMode;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class JSONUseActivity extends Activity {

EditText byear;   // To take birthyear as input from user
Button submit;    
TextView tv;      // TextView to show the result of MySQL query 

String returnString;   // to store the result of MySQL query after decoding JSON

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
/* StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder()
.detectDiskReads().detectDiskWrites().detectNetwork() // StrictMode is most commonly used to catch accidental disk or network access on the application's main thread
.penaltyLog().build());*/
super.onCreate(savedInstanceState);
setContentView(R.layout.main);

byear = (EditText) findViewById(R.id.editText1);
submit = (Button) findViewById(R.id.submitbutton);
tv = (TextView) findViewById(R.id.showresult);

// define the action when user clicks on submit button
submit.setOnClickListener(new View.OnClickListener(){        
public void onClick(View v) {
// declare parameters that are passed to PHP script i.e. the name "birthyear" and its value submitted by user   
ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();

// define the parameter
postParameters.add(new BasicNameValuePair("state",byear.getText().toString()));
String response = null;

// call executeHttpPost method passing necessary parameters 
try {
response = CustomHttpClient.executeHttpPost(
//"http://129.107.187.135/CSE5324/jsonscript.php", // your ip address if using localhost server
"http://10.0.2.2/android_login_api/include/islam.php",  // in case of a remote server
postParameters);

// store the result returned by PHP script that runs MySQL query
String result = response.toString();  

//parse json data
try{
returnString = "";
JSONArray jArray = new JSONArray(result);
for(int i=0;i<jArray.length();i++){

JSONObject json_data = jArray.getJSONObject(i);
Log.i("log_tag","id: "+json_data.getInt("ID")+
", name: "+json_data.getString("Name")+
", phone: "+json_data.getInt("Telephone")+
", fax: "+json_data.getInt("Fax")+
", web: "+json_data.getString("WebAddress")+
", state: "+json_data.getString("state")+
", address: "+json_data.getString("Address")+
", mailing: "+json_data.getString("MailingAddress"));
//Get an output to the screen
returnString += "\n" + json_data.getString("Name") + "\n"+ json_data.getInt("Telephone")+ "\n"+ json_data.getInt("Fax")+ "\n"+ json_data.getString("WebAddress")+ "\n"+ json_data.getString("state")+ "\n"+ json_data.getString("Address")+ "\n"+ json_data.getString("MailingAddress");
}
}
catch(JSONException e){
Log.e("log_tag", "Error parsing data "+e.toString());
}

try{
tv.setText(returnString);
}
catch(Exception e){
Log.e("log_tag","Error in Display!" + e.toString());;          
}   
}
catch (Exception e) {
Log.e("log_tag","Error in http connection!!" + e.toString());     
}
}         
});
}
} 
```

这是http客户端

```
package com.example.islamicorg;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URI;
import java.util.ArrayList;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.conn.params.ConnManagerParams;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;

import android.util.Log;

public class CustomHttpClient {

/** The time it takes for our client to timeout */

public static final int HTTP_TIMEOUT = 30 * 1000; // milliseconds

/** Single instance of our HttpClient */

private static HttpClient mHttpClient;

/**

* Get our single instance of our HttpClient object.

* 

* @return an HttpClient object with connection parameters set

*/

private static HttpClient getHttpClient() {

if (mHttpClient == null) {

mHttpClient = new DefaultHttpClient();

final HttpParams params = mHttpClient.getParams();

HttpConnectionParams.setConnectionTimeout(params, HTTP_TIMEOUT);

HttpConnectionParams.setSoTimeout(params, HTTP_TIMEOUT);

ConnManagerParams.setTimeout(params, HTTP_TIMEOUT);

}

return mHttpClient;

}

/**

* Performs an HTTP Post request to the specified url with the specified

* parameters.

* 

* @param url

*            The web address to post the request to

* @param postParameters

*            The parameters to send via the request

* @return The result of the request

* @throws Exception

*/

public static String executeHttpPost(String url,

ArrayList<NameValuePair> postParameters) throws Exception {

BufferedReader in = null;

try {

HttpClient client = getHttpClient();

HttpPost request = new HttpPost(url);

UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(

postParameters);

request.setEntity(formEntity);

HttpResponse response = client.execute(request);

in = new BufferedReader(new InputStreamReader(response.getEntity()

.getContent()));

StringBuffer sb = new StringBuffer("");

String line = "";

String NL = System.getProperty("line.separator");

while ((line = in.readLine()) != null) {

sb.append(line + NL);

}

in.close();

String result = sb.toString();

return result;

} finally {

if (in != null) {

try {

in.close();

} catch (IOException e) {

Log.e("log_tag", "Error converting result "+e.toString()); 

e.printStackTrace();

}

}

}

}

/**

* Performs an HTTP GET request to the specified url.

* 

* @param url

*            The web address to post the request to

* @return The result of the request

* @throws Exception

*/

public static String executeHttpGet(String url) throws Exception {

BufferedReader in = null;

try {

HttpClient client = getHttpClient();

HttpGet request = new HttpGet();

request.setURI(new URI(url));

HttpResponse response = client.execute(request);

in = new BufferedReader(new InputStreamReader(response.getEntity()

.getContent()));

StringBuffer sb = new StringBuffer("");

String line = "";

String NL = System.getProperty("line.separator");

while ((line = in.readLine()) != null) {

sb.append(line + NL);

}

in.close();

String result = sb.toString();

return result;

} finally {

if (in != null) {

try {

in.close();

} catch (IOException e) {

Log.e("log_tag", "Error converting result "+e.toString()); 

e.printStackTrace();

}

}

}

}

} 
```

这是我的 php 脚本：

```
<?php
// PHP variable to store the host address
$db_host  = "localhost";
// PHP variable to store the username
$db_uid  = "admin";
// PHP variable to store the password
$db_pass = "123";
// PHP variable to store the Database name  
$db_name  = "android_app"; 
// PHP variable to store the result of the PHP function 'mysql_connect()' which establishes the PHP & MySQL connection  
$db_con = mysql_connect($db_host,$db_uid,$db_pass) or die('could not connect');
mysql_select_db($db_name);
$sql = "SELECT * FROM islamic_organisation WHERE  state > '". $_POST["state"]."'";
$result = mysql_query($sql);
while($row=mysql_fetch_assoc($result))
$output[]=$row;
$myFile = "testFile.txt"; $fh = fopen($myFile, 'w') or die("can't open file"); fwrite($fh, print_r($output,true)); fclose($fh);
print(json_encode($output));

mysql_close();   
?> 
```

关于如何解决的任何想法，我将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:44:43.603

查看创建返回的 json 结果的 php 代码会很有帮助...... json 格式是否正确？看起来您正在返回一个字符串而不是一个数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:46:17.063

哪一行抛出异常？我认为是

```
JSONArray jArray = new JSONArray(result); 
```

如果是这样，在我看来，服务器正在为您的应用程序提供 XML 数据。

# android - 使用多点触控控制器在画布翻译后查找图像

> ID：16173526
> 
> 赞同：1
> 
> 时间：2013-04-23T15:36:41.393
> 
> 标签：android, draggable, drawable, multi-touch

我正在使用由 Luke Hutchison 制造的多点触控控制器，可在此处找到 [https://code.google.com/p/android-multitouch-controller/](https://code.google.com/p/android-multitouch-controller/)

我的问题是这个。我可以将图像放在画布上。我可以选择它、移动它、旋转它并完美地缩放它。问题是我还允许用户通过拖动来移动画布。在整个画布平移后，屏幕上的图像似乎出现在正确的位置。问题是试图在之后选择它们。

我不知道画布翻译后的接触点是否有问题，没有考虑新的画布位置/偏移量，或者图像的位置没有使用画布翻译进行更新。有没有人有这方面的经验或能够指出我正确的方向！？

# ios - 具有自定义视图和弱引用的 UIViewController

> ID：16173529
> 
> 赞同：0
> 
> 时间：2013-04-23T15:36:58.980
> 
> 标签：ios, objective-c

我更喜欢为我的所有视图控制器创建自定义视图。我在代码中通过对自定义视图使用弱引用来定义它，如下所示：

```
#import "MyViewController.h"
#import "MyCustomView.h"

@interface MyViewController ()
@property (nonatomic, weak) MyCustomView *customView;
@end

@implementation MyViewController
- (void) loadView
{
    MyCustomView *view = [MyCustomView new];
    self.view = view;
    self.customView = view;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // work with custom view
    self.customView.tableView.delegate = self;
    ....
}

@end 
```

这是弱引用的正确使用吗？应用程序会崩溃或泄漏，还是会出现其他问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:46:24.127

在这种情况下`weak`很好。您将`CustomView`标题中`self.view`定义为的分配给`UIViewController`

```
@property(nonatomic,retain) UIView *view; 
```

因此该`view`属性具有保留参考。

您的`view`and`customView`有可能不同步 - 所以我很想将 getter 定义`customView`为`readonly`并将 getter 实现为

```
- (CustomView *)customView
{
  return (id)self.view;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:44:51.787

正如您在[UIViewController 的文档中](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926)看到的那样，视图控制器的视图属性对视图有很强的引用。因此，只要您不将视图属性设置为其他内容，自定义视图对象就会被保留。简而言之，您的方法有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:40:56.753

当您以编程方式在此控制器中创建实例时，您应该使用强引用来清楚地设置此控制器的所有权。

如果您分别在 IB 或 soryboard 中创建视图对象，那么对相关对象的弱引用`IBOutlet`就可以了。

# loops - 批处理 For 循环数组

> ID：16173530
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:36:59.033
> 
> 标签：loops, for-loop, batch-file, cmd

好的，这就是我所拥有的。

```
@echo off
setLocal EnableDelayedExpansion
:begin
set /a M=0
set /a number=0
set /p Input=You: 
echo %Input% >> UIS
for /F "tokens=1 delims= " %%i in ("%Input%") do (
    set /a M+=1
    set i!M!=%%i
)
del UIS 1>nul 2>nul
:loop
set /a number+=1
set invar=!i%number%!
echo %invar%
pause > nul
goto loop 
```

例如，输入字符串是“Lol 这是我的输入字符串”，我希望 for 循环设置 i!M! 其中 M = 1 到“Lol”，其中 M = 2 i!M! 是“这个”，其中 M = 3 i!M! 是“是”等等。现在，当然，这不能永远持续下去，所以即使我必须在 M = 25 时停止，并说字符串只有 23 个字长。然后当 M = 24 和 25 时 i!M! 只是 null 或未定义。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:15:35.540

`for /f`逐行阅读，而不是逐字阅读。

这是在[如何拆分 Windows 批处理文件中的字符串？](https://stackoverflow.com/questions/1707058/how-to-split-a-string-in-a-windows-batch-file)并针对您的情况进行了修改：

```
@echo off
setlocal ENABLEDELAYEDEXPANSION

REM Set a string with an arbitrary number of substrings separated by semi colons
set teststring=Lol this is my input string
set M=0

REM Do something with each substring
:stringLOOP
    REM Stop when the string is empty
    if "!teststring!" EQU "" goto displayloop

    for /f "delims= " %%a in ("!teststring!") do set substring=%%a

    set /a M+=1
    set i!M!=!substring!

    REM Now strip off the leading substring
    :striploop
        set stripchar=!teststring:~0,1!
        set teststring=!teststring:~1!

        if "!teststring!" EQU "" goto stringloop

        if "!stripchar!" NEQ " " goto striploop

        goto stringloop

:displayloop
set /a number+=1
set invar=!i%number%!
echo %invar%
pause > nul
goto displayloop

endlocal 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:40:58.483

`for /F`命令将一行分成*一定数量*的标记，这些标记必须通过不同的可替换参数（%%i、%%j 等）一次处理。普通`for`命令将一行分割成*未定义*数量的单词（由空格、逗号、分号或等号分隔），这些单词在迭代循环中逐个处理。这样，您只需将其更改为：

```
for /F "tokens=1 delims= " %%i in ("%Input%") do ( 
```

通过这个：

```
for %%i in (%Input%) do ( 
```

PS - 我建议你把数组写成标准格式，将下标括在方括号中；这样更清楚：

```
set i[!M!]=%%i 
```

或者

```
set invar=!i[%number%]! 
```

# magento - Magento Enterprise 订单错误

> ID：16173542
> 
> 赞同：1
> 
> 时间：2013-04-23T15:37:30.817
> 
> 标签：magento

关于为什么 magento 订单中可能没有价格标题的任何想法？SKU 似乎是唯一出现的与产品相关的东西。客户为订单支付的费用为零。我们似乎每月两次遇到这种类型的订单。

我们正在使用 Magento Enterprise 版本 1.10.0.1

在此处查看错误： ![在此处输入图像描述](https://i.stack.imgur.com/K0e4V.gif)

# linux - 查看我的程序在终端中使用了多少内存

> ID：16173543
> 
> 赞同：0
> 
> 时间：2013-04-23T15:37:35.397
> 
> 标签：linux, memory-management, terminal, runtime

我知道当我`time ./myProgram <input.txt >output.txt` 在终端上键入时，一旦我的程序运行完毕，我就可以方便地看到运行时。必须有一些类似的命令才能查看程序的内存使用情况对吗？请简明扼要地告诉我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:49:10.770

*判断终端在任何时候*使用多少内存的一种方法是使用`top`和：

*   找到对应于终端进程的行。
*   找到与内存使用情况相对应的列（`man top`可能会告诉你——我现在在 Windows 机器上，无法轻松查找。）

也许试试这个命令：

`top | grep terminal`

（“终端”可以替换为“xterm”或您使用的任何终端程序）

同样，这将告诉您程序*在特定时间*的内存使用情况。

# sql - 触发器中的事务处理（TRY/CATCH....XACT_ABORT ON）

> ID：16173544
> 
> 赞同：4
> 
> 时间：2013-04-23T15:37:35.660
> 
> 标签：sql, triggers, sql-server-2008-r2, sqltransaction, xact-abort

我在 SQL Server 2008R2 上有流程场景：

• 一个usp 收集数据，然后在两个SQL Server 之间传输数据

此过程将在流程的所有级别（usp、SSIS 和触发器）的事务中完成

![在此处输入图像描述](https://i.stack.imgur.com/c2t6Q.jpg)

在将数据传输到 DB7.dbo.Dest 的数据流中，该表有一个 AFTER INSERT 触发器，它将刚刚通过的数据插入到最终表 DB7.dbo.FinalDestination 中：

```
CREATE TRIGGER [dbo].[Insert_OnStaging] ON [dbo].[Dest]
AFTER INSERT, UPDATE
AS
    BEGIN

SET NOCOUNT ON;    
SET XACT_ABORT ON;  --Rollsback complete transaction if there are any errors

BEGIN TRY

BEGIN TRANSACTION

INSERT INTO [DB7].[dbo].[FinalDestination] WITH (TABLOCK)
       (Column1
       ,Column2
       )
SELECT I.Column1, I.Column2 
FROM INSERTED I
INNER JOIN [DB7].[dbo].[Dest] PR
ON I.IDcol = PR.IDcol

COMMIT TRANSACTION

END TRY

BEGIN CATCH
IF @@TRANCOUNT > 0 AND XACT_STATE() <> 0
    ROLLBACK TRANSACTION;

DECLARE @ErrorMessage NVARCHAR(4000);
DECLARE @ErrorSeverity INT;
DECLARE @ErrorState INT;
DECLARE @ErrorLine INT;

SELECT 
@ErrorMessage = ERROR_MESSAGE(),
@ErrorSeverity = ERROR_SEVERITY(),
@ErrorState = ERROR_STATE(),
@ErrorLine = ERROR_LINE()
;

RAISERROR (@ErrorMessage, -- Message text.
           @ErrorSeverity, -- Severity.
           @ErrorState, -- State.
           @ErrorLine  --Error Line
           );    
END CATCH;
END 
```

在每个级别，由于数据的敏感性正确并完全进入决赛桌，我都试图对数据进行防御。

关于 SSIS，从我阅读和测试的内容来看，它似乎工作正常。

我最担心的是我在上面编写的触发器。根据我的阅读和理解，设置 XACT_ABORT ON 将在出现任何错误时回滚 TRY 块内的事务（换句话说，存在不可提交的事务）。在这种情况下，我继续在 CATCH 块中添加回滚事务部分作为一个想法，因为它永远不会到达（根据我的理解）。同时，我添加了 WITH (TABLOCK) 选项，以便在执行 INSERT 时锁定表。

在触发器的情况下，在 XACT_ABORT 为 ON 的情况下，TRY...CATCH 是否必要？TRY 块内是否需要 COMMIT TRANSACTION？正如我也看到它在基于 @@TRANCOUNT 的 CATCH 块之后提交

```
BEGIN TRY
BEGIN TRANSACTION
[Tsql here]
END TRY
BEGIN CATCH
[Error Handling]
END CATCH
IF @@TRANCOUNT > 0
COMMIT TRANSACTION
END 
```

欢迎回答和批评，并在此先感谢您。当我试图概括名称时，请原谅任何错别字......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:49:14.877

`TRY..CATCH`即使您使用的是`XACT_ABORT`. `XACT_ABORT`中止 tran 但继续运行批处理/过程！这是非常非常恶劣的行为。这意味着 DML/DDL 在发生错误后仍然可以运行，但在事务之外，因此您永远无法回滚它。

SQL Server 没有任何机制来避免这种情况，除了`TRY..CATCH`. 我不确定什么`XACT_ABORT`是好的。在你的例子中，它也没有帮助，也没有伤害。

是的，如果你愿意，你可以移动`COMIT`外面。`TRY`只需确保将其与`BEGIN TRAN`.

# ruby-on-rails - 将 edit_object_path 和 new_object_path 融合到一个路径中

> ID：16173545
> 
> 赞同：1
> 
> 时间：2013-04-23T15:37:35.820
> 
> 标签：ruby-on-rails, ruby

为了编辑和创建一个新对象，我希望只有一个路径（比如 */admin/edit）。作为`new_object_path`和`edit_object_path`渲染相同的 _form.html.erb 页面是否可以融合编辑和新建？我希望很清楚我的问题是什么..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:53:57.533

我不确定你为什么要这样做？

阅读有关 REST 架构的信息。`new`和`edit`动作有不同的含义。是的，它们使用相同的局部视图 (_form)，但它们在控制器端具有不同的逻辑。在新操作中，您创建一个非常新的（在大多数情况下几乎是空的）对象，但在呈现编辑操作视图之前，您需要通过给定（在 URL 中）对象的 ID 从数据库中获取对象。

我不明白为什么你需要融合两种不同的意义（和逻辑）动作？

您应该为`new`和`edit`操作使用不同的视图，并在其中渲染部分视图 (_form)（可能您已经在自动生成的脚手架中看到过这种视图）。

# javascript - 使用本地存储保存应用程序状态

> ID：16173550
> 
> 赞同：3
> 
> 时间：2013-04-23T15:37:46.733
> 
> 标签：javascript, performance

只是一个关于使用本地存储保存应用程序状态的快速问题。我即将开始开发 iOS 网络应用程序，我想知道这些模型中的任何一个是否有任何优点或缺点。此外，将应用程序状态的每一个微小变化都保存到本地存储中是否会对性能造成重大影响？

### 1号

将整个应用状态对象作为 JSON 字符串保存到单个本地存储键值对。

```
var appstate = {
    string: 'string of text',
    somebool: true,
    someint: 16
}
localStorage.setItem('appState', JSON.stringify(appstate)); 
```

### 2号

将应用程序状态的每个变量保存到本地存储中它自己的键值对。

```
var appstate = {
    string: 'string of text',
    somebool: true,
    someint: 16
}
localStorage.setItem('string', appstate.string);
localStorage.setItem('bool', appstate.somebool);
localStorage.setItem('int', appstate.someint); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:50:41.480

我认为单独存储值可能更有效的唯一原因是，如果您预期值彼此独立变化。如果它们分开存储，您可以刷新一组值而不接触另一组值，因此可以更好地处理值过期。例如，如果`somebool`经常更改但其余部分没有更改，则最好将其单独存储。将具有相似到期和波动性的数据组合在一起。

否则，如果您只想保存整个应用程序状态，我认为单个字符串就可以了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:59:18.863

考虑读取与写入（更改）。对于频繁读取，这并不重要，因为 JavaScript 对象是具有恒定 (O(1)) 响应时间的哈希（请参阅[Javascript big-O 属性访问性能](https://stackoverflow.com/questions/7374171/javascript-big-o-property-access-performance)）。对于写入，正如可空性所说，存在差异。对于单对象设计，如果对象中包含大量（或大型）属性，频繁写入可能会变慢。

# asp.net - URL 更改正在更改会话

> ID：16173557
> 
> 赞同：0
> 
> 时间：2013-04-23T15:38:14.953
> 
> 标签：asp.net, session

我们的**ASP.NET**网站在内部非常一致地使用相同的 URL 结构来更改页面。

例如：`https://mysite.org/page1.aspx`对`http://mysite.org/page2.aspx`。

我们使用`Session`变量来跟踪用户的登录状态。我们的具体问题是用户将指向登录页面的快捷方式设置为`https://www.mysite.org/LoginPage.aspx`. `Session`变量设置`LoggedIn=True`为。

然后登录页面将用户发送到主页`http://mysite.org/homepage.aspx`。

服务器创建一个新会话，并且登录的会话变量不再可用于新会话。我们如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:39:29.327

您应该配置您的网络服务器以将所有请求重定向`www.example.com`到`example.com`（或反之亦然）。
这首先防止了这种情况的发生。

# mule - 为什么 Mule 有效载荷会丢失 对于 java.net.ConnectException

> ID：16173561
> 
> 赞同：1
> 
> 时间：2013-04-23T15:38:17.433
> 
> 标签：mule

我正在测试我的 Mule(3.3.1) 流，该流向外部供应商发送 Web 服务调用。我的目标是捕获`java.net.ConnectException`并应用于`XSLT`原始有效负载并将其发送给调用者。

但是收到的有效载荷`<catch-exception-strategy>`是 type`org.apache.commons.httpclient.methods.PostMethod@12b13004`而不是 original `XML`。尝试使用`<objexct-to-string-transformer>`但没有帮助。

任何建议如何检索`catch`块中的原始有效负载？

部分`mule-config.xml`如下：

```
 <flow name="orderRequirementsToVendor">
        <jms:inbound-endpoint queue="order.vendor" />   

        <set-property propertyName="SOAPAction" value="http://vendor.com/services/InterfacePoint/Call" /> 

        <cxf:proxy-client payload="body" enableMuleSoapHeaders="false">
            <cxf:inInterceptors>
                <spring:bean class="org.apache.cxf.interceptor.LoggingInInterceptor" />                  
            </cxf:inInterceptors>
            <cxf:outInterceptors>
                <spring:bean class="org.apache.cxf.interceptor.LoggingOutInterceptor" />
            </cxf:outInterceptors>
        </cxf:proxy-client>
        <outbound-endpoint address="${vendor.ws.url}" mimeType="text/xml" connector-ref="https.connector" />
        <byte-array-to-string-transformer />

         <choice-exception-strategy>
            <catch-exception-strategy when="#[exception.causedBy(java.net.ConnectException)]">
                <logger message="#[exception.causeException]" level="ERROR" />
                <object-to-string-transformer/>
                <transformer ref="vendorConnectExceptionTransformer" />
             </catch-exception-strategy>
            <catch-exception-strategy>
                <logger message="#[exception.causeException]" level="ERROR" />
                <transformer ref="generalErrorTransformer" />
            </catch-exception-strategy>
        </choice-exception-strategy> 

    </flow> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T17:03:46.380

*   `jms:inbound-endpoint`在with之后将原始有效负载存储在流变量中

    ```
    <set-variable variableName="originalPayload" value="#[message.payload]" /> 
    ```

*   使用 MEL 表达式在您的异常策略中访问它，例如：`#[flowVars.originalPayload]`。

# visual-studio - 自动构建 NuGet 包，包括引用的依赖项

> ID：16173568
> 
> 赞同：100
> 
> 时间：2013-04-23T15:38:38.127
> 
> 标签：visual-studio, build-automation, nuget, nuget-package

我想[运行本地/内部 NuGet 存储库](http://haacked.com/archive/2011/03/31/hosting-simple-nuget-package-feed.aspx)。我想我已经想出了如何“重用”现有的 NuGet 包，方法是使用 NuGet 将它们包含在一个虚拟项目中并扫描包文件以[获取我的本地缓存`.nupkg`文件](http://www.hanselman.com/blog/HowToAccessNuGetWhenNuGetorgIsDownOrYoureOnAPlane.aspx)，但是......

## 如何`.nupkg`从项目创建一个 nuget 包 ()，自动包含**所有** `dll`依赖项，而不仅仅是通过 NuGet 获取的那些？

具体来说：

1.  创建解决方案
2.  添加新项目
3.  添加对各种`.dll`文件/其他项目的引用*<-这是缺少的部分*
4.  通过包管理器 / cmdline / 随便添加 NuGet 包
5.  *有些东西*会自动创建`.nupkg`

根据我的发现，你应该做类似的事情

*   手动编辑您的`.csproj`文件以添加`<BuildPackage>true</BuildPackage>`以包含依赖项
*   手动创建`.nuspec`文件并手动[列出您的依赖项](http://docs.nuget.org/docs/reference/nuspec-reference#Specifying_Dependencies_in_version_2.0_and_above)（[类似？](https://stackoverflow.com/questions/12819868/nuget-packaging-and-referencing-dlls)）
*   手动`nuget pack`在您的`.nuspec`文件上运行

但是一切都是手动的，这很愚蠢。即使是半自动的解决方案仍然很笨拙或半手动：

*   [创建`.nuspec`模板](http://www.xavierdecoster.com/post/2012/04/27/install-package-nuspec-aspx)- 似乎不包括依赖项，只是元数据
*   [通过 build-event 进行 nuget pack](https://stackoverflow.com/questions/9180904/automating-creating-nuget-package-as-part-of-build-process)（步骤 #5），您需要手动将其添加到每个项目中，并且它有[自己的怪癖](https://stackoverflow.com/questions/14982266/the-replacement-token-description-has-no-value)：

    ```
    "$(SolutionDir).nuget\NuGet.exe" pack "$(ProjectPath)" -Properties Configuration=Release
    move /Y *.nupkg "$(TargetDir)" 
    ```

`.nuspec`我将满足于从项目引用中自动创建清单的东西。然后理论上 + nuget build-event 可以汇总到 build-project/nuget 包中，这是我真正想看到的。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-04-30T22:43:12.403

您的第 3 点（*添加对各种 .dll 文件/其他项目的引用<-这是缺少的部分*）确实包含两个不同的问题：（1）添加对各种 dll 文件的引用，以及（2）添加对其他项目的引用相同的解决方案。

[从NuGet 2.5](http://docs.nuget.org/docs/release-notes/nuget-2.5#Improved_project_reference_support_for_NuGet.exe_Pack)开始，这里的数字 (2) 得到了一些额外的支持。在为项目创建 NuGet 包时，您可以添加一个选项以在同一解决方案中包含对其他项目的引用：

```
nuget pack projectfile.csproj -IncludeReferencedProjects 
```

*   如果`projectfile.csproj`在您的解决方案中引用任何其他也作为 NuGet 包公开的项目，这些项目的**NuGet 包**将作为依赖项添加。
*   如果它引用了您的解决方案中*不*将自身公开为 NuGet 包的项目，则它们的**dll**将包含在此 NuGet 包中。

至于 (1)，如果您发现自己经常向项目中添加不能作为 NuGet 包使用的 dll，您可以使用这些文件创建自己的（内部）NuGet 包。如果您随后将这些 dll 添加为 NuGet 包而不是直接添加文件，则此 NuGet 包将成为您项目的 NuGet 包中的依赖项。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2020-10-29T00:54:45.470

我找到了一篇关于这个主题的写得很好的文章。我对某些具有依赖关系层次结构的包有同样的问题，到目前为止，我一直将每个包作为单独的 NuGet 包上传（浪费时间）

我刚刚测试了这里找到的解决方案：[https ://dev.to/wabbbit/include-both-nuget-package-references-and-project-reference-dll-using-dotnet-pack-2d8p](https://dev.to/wabbbit/include-both-nuget-package-references-and-project-reference-dll-using-dotnet-pack-2d8p)

在使用 NuGet 包资源管理器检查 NuGet 包后，确实存在引用项目生成的 DLL。我将通过实际将此包提交给 NuGet 并对其进行测试来进行测试。

如果对您有帮助，这是我的来源：[https ://github.com/jchristn/NuGetPackTest](https://github.com/jchristn/NuGetPackTest)

以及测试 NuGet 包：[https ://www.nuget.org/packages/NuGetPackTest/1.0.0](https://www.nuget.org/packages/NuGetPackTest/1.0.0)

该解决方案似乎运作良好。我不知道当有多层参考时它会是什么样子，我敢肯定它会变得非常毛茸茸而且非常快。

[![在此处输入图像描述](https://i.stack.imgur.com/xm4yN.png)](https://i.stack.imgur.com/xm4yN.png)

来自 NuGetPackTest 库的 .csproj，它引用了项目 TestLibrary（为简洁起见删除了部分）

```
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFrameworks>netstandard2.0;netcoreapp3.0;netcoreapp3.1;net461</TargetFrameworks>
    ...
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>

    <!-- added this line -->
    <TargetsForTfmSpecificBuildOutput>$(TargetsForTfmSpecificBuildOutput);CopyProjectReferencesToPackage</TargetsForTfmSpecificBuildOutput>
  </PropertyGroup>

  <ItemGroup>

    <!-- modified this ProjectReference to include the children ReferenceOutputAssembly and IncludeAssets -->
    <ProjectReference Include="..\TestLibrary\TestLibrary.csproj">
      <ReferenceOutputAssembly>true</ReferenceOutputAssembly>
      <IncludeAssets>TestLibrary.dll</IncludeAssets>
    </ProjectReference>
  </ItemGroup>

  <!-- added this section -->
  <Target DependsOnTargets="ResolveReferences" Name="CopyProjectReferencesToPackage">
    <ItemGroup>
      <BuildOutputInPackage Include="@(ReferenceCopyLocalPaths->WithMetadataValue('ReferenceSourceTarget', 'ProjectReference'))"/>
    </ItemGroup>
  </Target>

</Project> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-21T18:14:50.817

对于其他 Google 员工，如果您使用 NuGet.targets 文件运行 NuGet Pack，则可以使用此功能：

```
<Target Name="PrePackage" BeforeTargets="BuildPackage">
  <PropertyGroup>
    <BuildCommand>$(BuildCommand) -IncludeReferencedProjects</BuildCommand>
  </PropertyGroup>
</Target> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-19T10:26:41.977

看一下这个！

我找到的解决方案是 Visual Studio 的扩展： [https ://visualstudiogallery.msdn.microsoft.com/fbe9b9b8-34ae-47b5-a751-cb71a16f7e96/view/Reviews](https://visualstudiogallery.msdn.microsoft.com/fbe9b9b8-34ae-47b5-a751-cb71a16f7e96/view/Reviews)

您只需添加名为 NuGet 包的新项目： ![NuGet 包](https://i.stack.imgur.com/dAtYk.png)

然后，您将有趣的项目添加到参考和 BOOOM 中！所有依赖项和文件目录都会自动添加。如果要修改 NuSpec 数据，请在项目上单击鼠标右键并转到 Properties，然后修改所需的内容。生成的 NuSpec 和 nupkg 将位于新项目的文件夹**obj中。**我希望它有所帮助；）。

# bash - 如果字符串变量包含通配符，如何签入shell脚本？

> ID：16173569
> 
> 赞同：2
> 
> 时间：2013-04-23T15:38:41.383
> 
> 标签：bash, shell, wildcard

我正在尝试检查字符串是否包含任何通配符。这是我失败的尝试：

```
#!/bin/bash
WILDCARDS='* . ? !  ] [' 
a="foo*bar"
for x in $REJECTED_WILDCARDS
do 
    if [[ "$a" == *"$x"* ]]
    then 
            echo "It's there!";
    fi 
done 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T18:55:31.307

略短且没有循环：

```
if [ "$a" != "${a//[\[\]|.? +*]/}"  ] ; then
  echo "wildcard found"
fi 
```

参数替换删除所有通配符。字符串不再相等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:56:17.557

将通配符设置为 bash 数组，如下所示

```
wildcards=( '*' '.' '?' '|' ']' '[' ) 
```

然后

```
a="foo*bar"
for wildcard in "${wildcards[@]}";
do
  if [[ $a == *"${wildcard}"* ]];
  then
    echo 'yes';
  fi;
 done 
```

# python - if 语句未在 while 循环中执行

> ID：16173571
> 
> 赞同：0
> 
> 时间：2013-04-23T15:38:54.457
> 
> 标签：python, if-statement, python-3.x

我必须编写一个程序，该程序一个接一个地获取多个字符串，该字符串由标记 DONE 终止，然后打印此字符串列表，该列表右对齐为最大字符串的长度。这是我的代码：

```
user = input("Enter strings (end with DONE):\n")
totalString = ""

while True:
    if user.lower() == 'done':
        break
    else:
        totalString = totalString + user + " "
        user = input("")

lst = totalString.split(" ")
max = 0

for i in range(len(lst)):
    if len(lst[i]) > max:
        max = len(lst[i])

for i in range(len(lst)):
    print("{:>{derp}}".format(lst[i],derp=max)) 
```

我遇到的问题是 while 循环中的 if 语句永远不会执行，所以它只会卡在那个循环中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:47:52.400

**注意**：假设代码是针对 Python 2.x 的，但情况可能并非如此。

首先使用 input()，您期望的是一个**数值**而不是一个**字符串**。只需将您的 input() 更改为 raw_input() 就可以了。正如评论中所指出的，也许 OP 正在使用 Python 3。

[这个](https://stackoverflow.com/questions/4915361/whats-the-difference-between-raw-input-and-input-in-python3-x)关于 SO 的问题解释了 Python 2.x 和 3.x wrt input() 和 raw_input() 的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:27:19.223

当您使用 cmd 运行代码时，返回的字符串也`input`包含返回字符（`\r`）。

所以当用户进入时`"done"`，`input()`实际上是返回`"done\r"`。

一个简单的解决方案是在[`str.strip`](http://docs.python.org/2/library/stdtypes.html#str.strip)这里使用：

`user = input("").strip("\r")`

# google-cloud-endpoints - 用于 Servlet 的 Google Endpoints 和 Oauth

> ID：16173572
> 
> 赞同：0
> 
> 时间：2013-04-23T15:38:54.433
> 
> 标签：google-cloud-endpoints

如何保护我的 Google 端点。我需要对端点服务进行 java 客户端调用（servlet，而不是 android）。

有适用于 iOS、Javascript 和 Android 客户端的文档，但没有适用于 java 客户端的文档。

帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T03:49:47.913

查看[适用于 Java 的 Google API 客户端库](http://code.google.com/p/google-api-java-client/)。

编辑：这是关于[OAuth](https://code.google.com/p/google-api-java-client/wiki/OAuth2)的部分。

# google-app-engine - 如何在代理后面使用带有 GAE 1.7.7 的任务队列

> ID：16173579
> 
> 赞同：1
> 
> 时间：2013-04-23T15:39:18.637
> 
> 标签：google-app-engine

我今天升级到 GAE 1.7.7，发现任务队列在我的开发设置中停止工作。

我在我的开发环境中使用 https 通过一个 nginx 设置来代理从 fakedomain.local:80 和 fakedomain.local:443 到 localhost:8080 的连接（GAE 监听的地方）。

通过此设置，最终创建任务队列以在 fakedomain.local:80 处执行。这曾经有效，因为请求将被 nginx 接收，但开发服务器的 1.7.7 版本似乎有一个端口注册表，除非端口已知（如果我了解 google.appengine. tools.devappserver2.Dispatcher._resolve_target 正确）。当然，GAE 侦听端口 8080，我标记为在 fakedomain.local:80 上运行的任务永远不会被执行（GAE 记录此错误：在队列中发送任务“task1”（Url：“...”）时发生错误...）。

我尝试修补 dispatcher.py:577，所以当端口未知时，它不会引发 ServerDoesNotExistError，而是使用默认服务器。通过此修改，我可以让任务队列再次运行，但我宁愿使用不涉及更改 GAE 代码的解决方案。

如何让 GAE 在 1.7.7 版本中注册 80 和 443 端口？或者，有没有办法可以为任务指定完整的目标 URL？（即 fakedomain.local:8080/my_task，而不仅仅是 /mytask）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-15T16:15:30.613

`taskqueue.add(target=taskqueue.DEFAULT_APP_VERSION, ...)` 将在您的默认应用程序上运行它，它应该完全符合您的要求。

`taskqueue.DEFAULT_APP_VERSION`=> `app_identity.get_default_version_hostname()`=> `environ['DEFAULT_VERSION_HOSTNAME']`=> `'%s:%s' % (environ['SERVER_NAME'], server_port)`

# haskell - Haskell：重载 == 用于图 ADT

> ID：16173592
> 
> 赞同：2
> 
> 时间：2013-04-23T15:39:40.920
> 
> 标签：haskell, overloading

我有一个图表声明，我需要在 Haskell 中重载“==”运算符（书中的问题）。

```
data Node a = Node {
label :: a,
adjacent :: [(a,Int)]
} deriving Show

data Network a = Graph [Node a] deriving Show 
```

基本上，如果两个图具有相同的顶点和边，则它们是相等的（但节点在网络数据类型中的顺序以及在节点数据类型中的相邻顶点列表可能不同）。有一些困难，任何帮助将不胜感激。

提前致谢。

注意：我的问题是相等性检查，而不是创建类型类实例的语法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:47:13.193

如果你不能只使用`deriving (Eq, Show)`，那么你必须手动实现它。

```
instance (Eq a) => Eq (Node a) where
    n1 == n2 = (* Implement the equality check here *)

instance (Eq a) => Eq (Network a) where
    g1 == g2 = (* Implement the equality check here *) 
```

这实际上是派生语句自动为您所做的。

如果您想了解更多关于类型类的信息，我喜欢向您学习 Haskell 的解释。

如果您需要有关实际相等性检查的帮助，请使用`Data.Map`该`fromList`函数。

至于节点，这个片段应该这样做

```
(==) = (==) `on` label 
```

或更明确地说

```
n1 == n2 = label n1 == label n2 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T15:57:56.517

这是你要找的吗？

```
import Data.Function (on)
import qualified Data.Map as M

instance Ord a => Eq (Network a) where
    (==) = (==) `on` f where
        f :: Ord a => Network a -> M.Map a (M.Map a Int)
        f (Graph nodes) = M.fromList $ map g nodes
        g :: Ord a => Node a -> (a, M.Map a Int)
        g node = (label node, M.fromList $ adjacent node) 
```

这个实现的作用：

*   将每个网络转换为地图
*   测试这些地图是否相等

因为地图是无序的（并且原始列表不包含重复项），原始列表的顺序不会影响输出。

您甚至可能会更好地将您的`Node`和`Network`表示更改为使用`Map`s。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:47:00.690

您必须为网络实现 Eq 实例：

```
instance Eq (Network a) where
    n1 == n2 = ... 
```

更多在这里：

[http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101](http://learnyouahaskell.com/types-and-typeclasses#typeclasses-101)

[https://en.wikibooks.org/wiki/Haskell/Classes_and_types](https://en.wikibooks.org/wiki/Haskell/Classes_and_types)

# java - 多个项目使用的异常应该放在哪里？

> ID：16173593
> 
> 赞同：7
> 
> 时间：2013-04-23T15:39:41.240
> 
> 标签：java, exception

我需要将具有两个数据模型的项目重构为两个单独的项目。两个项目都使用相同的异常。我应该只为这些例外创建第三个项目吗？克隆听起来是不可能的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:53:31.373

是的，您应该在单独的项目中创建它，并将其用作对其他项目的依赖项。看到只有在您使用的模块中使用的异常的项目/jar 并不少见。恕我直言，这是保持事情井井有条的好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:57:06.353

恕我直言，正如@harsha 在现有评论中提到的那样，最简单的解决方案是将共享代码放入 **库或 .jar 文件** 中，并将 .jar 文件放入您的项目库中。

现在您有了一个有价值的 api，可以使用您的版本轻松维护每个构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T16:03:46.147

作为其他两个共享依赖项的单独项目可能是最好的。如果两个数据模型一起使用，复制对象会使事情变得困难，您必须通过例如不同的包名称来解决这个问题，这会造成维护上的麻烦。除了您的异常之外，共享项目可能是未来共享代码的良好存储库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T17:22:01.413

有没有共同点的例外？听起来很奇怪。

这些项目之间是否存在依赖关系？一个是别人的客户吗？

我相信也应该有一些共同的接口，其中一些在他们的方法签名中声明了这些异常。一些在您的一个项目中实现，并在其他项目中被调用。

如果根本没有这样的东西，那么您的常见例外似乎只是它们的名字相同！它们并不是真正相同的类，它们只是具有相同的名称，并且由于许多用户定义的异常只是具有调用`super`构造函数的构造函数，因此它们似乎是相同的。

如果这是你的情况，我不会费心提取类，我会保留重复项，因为重构没有任何收获。

# symfony - 如何在不编辑 htaccess 的情况下访问 Symfony 中的多个环境？

> ID：16173599
> 
> 赞同：1
> 
> 时间：2013-04-23T15:40:07.610
> 
> 标签：symfony, symfony-2.1

Symfony 似乎提供了一种简单的方法来进行不同的开发设置，并且默认带有生产和开发环境模板——可以通过分别访问 app.php 和 app_dev.php 来访问这些模板。他们似乎也选择了适当的配置文件。

我正在尝试创建自己的环境，因此我创建了 app_dev_local.php 并且还创建了 config_dev_local.xml。但是，除了 htaccess 文件之外，我无法指定我的前端控制器是 app_dev_local.php。问题是这个 htaccess 文件受源代码控制，因此我无法真正编辑它。这是否意味着我无法拥有与队友不同的环境？还是我把一切都弄错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:39:57.047

以下是我们解决它的方法：

在 /etc/httpd 的 conf.d 目录中： 文件：application.conf

```
Alias /application/debug  /var/www/symfony/application/debug/
Alias /application/dev    /var/www/symfony/application/dev/
Alias /application/test   /var/www/symfony/application/test/
Alias /application        /var/www/symfony/application/web/

<Directory "/var/www/symfony/application/web">
  <IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /application/app.php [QSA,L]
  </IfModule>
</Directory>

<Directory "/var/www/symfony/application/debug/">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ /application/debug/debug.php [QSA,L]
    </IfModule>
</Directory>

<Directory "/var/www/symfony/application/dev/">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ /application/dev/dev.php [QSA,L]
    </IfModule>
</Directory>

<Directory "/var/www/symfony/application/test/">
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ /application/test/test.php [QSA,L]
    </IfModule>
</Directory> 
```

然后在根应用程序目录中

```
ln -s web test
ln -s web debug
ln -s web dev 
```

然后在应用程序/网络中

根据您的需要制作自定义的 test.php、debug.php 或 dev.php（我们已在我们的商店中将 app_dev.php 重命名为 dev.php）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-30T00:24:52.227

我们想轻松地在本地开发多个站点，致力于源代码控制，部署到生产服务器，并让它们在生产模式下自动运行。谢天谢地，app.php 和 app_dev.php 之间没有太大区别，所以我们只是合并了这两个文件，并使用环境变量来设置环境。生成的文件最终如下所示：

```
<?php

use Symfony\Component\ClassLoader\ApcClassLoader;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\Debug\Debug;

// get our web environment from an environment variable
$env = getenv('environment');

$loader = require_once __DIR__ . '/../app/bootstrap.php.cache';

if( $env == 'prod' )
{
    // Possibly add APC caching here
}
if( $env == 'dev' )
{
    Debug::enable();
}

require_once __DIR__ . '/../app/AppKernel.php';

$kernel = new AppKernel($env, true);
$kernel->loadClassCache();
$request = Request::createFromGlobals();
$response = $kernel->handle($request);
$response->send();
$kernel->terminate($request, $response); 
```

# smalltalk - 在smalltalk中新建和初始化-如何传递参数进行初始化

> ID：16173604
> 
> 赞同：7
> 
> 时间：2013-04-23T15:40:24.847
> 
> 标签：smalltalk

在 smalltalk 中，当我们通过调用 new 创建对象时，调用 initialize 。我想初始化但使用我自己的参数（在运行时传递）。我怎样才能做到这一点。

例如`Myobjcet new`

但是我如何将参数传递给它，以便它们被传递给初始化。我正在使用Pharo。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:52:06.680

如果我记得，应该避免重新实现类`new`方法`initialize`。

相反，您可以创建自己的带参数的类方法（除了 new 或 initialize），并在创建新实例时使用这些方法。例如，`Squeak`查看 class 的类`with:`方法`Collection`。它首先创建一个集合实例，然后将作为参数传递的对象添加到该实例中。

```
with: anObject 
    "Answer an instance of me containing anObject."

    ^ self new
        add: anObject;
        yourself 
```

您`Pharo`可能基于 Squeak，因此您应该`Collection`在图像中找到相同或类似的类方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T16:57:17.620

在 Smalltalk 中正确编写复杂对象层次结构的实例化和初始化代码是很棘手的。`Object`更重要的是，在不同的 Smalltalk 方言中实现的默认初始化逻辑是不同的（即 Pharo 决定引入默认初始化器，这让事情变得更糟）。

为了避免混淆并制定清晰一致的规则，Seaside 团队决定对其所有代码应用以下规则：

[Seaside 的对象初始化](https://github.com/SeasideSt/Seaside/wiki/Object-Initialization)

此外，Seaside 代码还包括 Code Critic 规则，用于检查建议的初始化模式使用中的错误。

# php - 转换多语言功能

> ID：16173614
> 
> 赞同：0
> 
> 时间：2013-04-23T15:40:44.480
> 
> 标签：php

这是我在这里的第一个问题，所以如果我发布错误，请不要评判我。

我有这个功能来支持我的多语言

```
<?
header('Cache-control: private'); // IE 6 FIX
if(isSet($_GET['lang']))
{
    $lang = $_GET['lang'];
    // register the session and set the cookie
    $_SESSION['lang'] = $lang;
    setcookie('lang', $lang, time() + (3600 * 24 * 30));
}
else if(isSet($_SESSION['lang']))
{
    $lang = $_SESSION['lang'];
}
else if(isSet($_COOKIE['lang']))
{
    $lang = $_COOKIE['lang'];
}
else
{
    $lang = 'en';
}
switch ($lang) {
    case 'bg':
    $lang_file = 'bg.php';
    break;
    default:
    $lang_file = 'en.php';
}
define('IN_VALID',true);
include_once '_src/lang/'.$lang_file;
?> 
```

它通过 &lang=en 或 &lang=bg 获取语言。

我如何将其转换为 &lang:en 而不是 &lang=en （如果可能的话）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:44:36.027

`?key1=value1&key2=value2`是标准`application/x-www-form-urlencoded`格式。

要使用您的格式，您应该自己解析它，我不建议这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:46:10.173

你可以检查一下`isset($_GET["lang:en"])`。

但这不是建议。`=`是键和值的标准分隔符。没有必要改变它。

# ios - iOS exec 函数在后台

> ID：16173616
> 
> 赞同：0
> 
> 时间：2013-04-23T15:40:46.533
> 
> 标签：ios, multithreading, background, nsthread

我是多线程新手，想知道如何在后台运行这个函数？该函数只返回一个用于 XML 解析并从另一个函数调用的 NSURL。或者在后台运行是否值得，因为调用它的函数在该函数返回其 NSURL 之前不会继续。基本上，我只是想弄清楚如何加快速度，因为它需要一点时间才能完成！

```
+ (NSURL *)parserURL {

    NSURL *theURL = [NSURL URLWithString:@"http://www.wccca.com/PITS/"];
    NSData *data = [[NSData alloc] initWithContentsOfURL:theURL];
    TFHpple *xpathParser = [[TFHpple alloc] initWithHTMLData:data];
    NSArray *elements = [xpathParser searchWithXPathQuery:@"//input[@id='hidXMLID']//@value"];
    if (elements.count >= 1) {

        TFHppleElement *element = [elements objectAtIndex:0];
        TFHppleElement *child = [element.children objectAtIndex:0];
        NSString *idValue = [child content];

        NSString *stg = [NSString stringWithFormat:@"http://www.wccca.com/PITS/xml/fire_data_%@.xml", idValue];
        NSURL *url = [NSURL URLWithString:stg];

        return url;
    }
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:14:56.040

您的代码的主要问题是您正在使用阻止操作从网站获取数据。您肯定想在后台线程中执行此操作。但是，我建议您查看可帮助您非常轻松地执行此类操作的网络框架，即[AFNetworking](https://github.com/AFNetworking/AFNetworking)，

无论如何，我将遵循多线程该操作或类似操作的策略如下：它分解为使用[GDC](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)调度它，然后在主线程中执行接收完成块并返回结果。

这是代码：

*描述*

首先声明你的函数接收一个块。一旦您完成检索和解析数据，该块将在最后执行。代码的下一件事就是要求 GDC 在后台队列中执行一段代码。完成后，我们要求代码执行在主线程中作为函数参数提供的完成块，将解析后的字符串提供给它。

```
+(void) parserURL:(NSURL *) theURL completion:(void (^) (NSURL *finalURL))completionBlock{
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    NSData *data = [[NSData alloc] initWithContentsOfURL:theURL];
    TFHpple *xpathParser = [[TFHpple alloc] initWithHTMLData:data];
    NSArray *elements = [xpathParser searchWithXPathQuery:@"//input[@id='hidXMLID']//@value"];
    NSURL *url;
    if (elements.count >= 1) {

        TFHppleElement *element = [elements objectAtIndex:0];
        TFHppleElement *child = [element.children objectAtIndex:0];
        NSString *idValue = [child content];

        NSString *stg = [NSString stringWithFormat:@"http://www.wccca.com/PITS/xml/fire_data_%@.xml", idValue];
        url = [NSURL URLWithString:stg];
    }else{
        url = nil;
    }
        dispatch_async(dispatch_get_main_queue(), ^{
            completionBlock(url);
        });
    }); 
```

}

您可以通过以下方式调用该方法：

```
[URLParser parserURL:[NSURL URLWithString:@"http://www.wccca.com/PITS/"] completion:^(NSURL *finalURL) {
        NSLog(@"Parsed string %@", [finalURL absoluteString]);
    }]; 
```

# ajax - 无法从数据表primefaces内的overlaypanel内部更新组件

> ID：16173627
> 
> 赞同：0
> 
> 时间：2013-04-23T15:41:23.117
> 
> 标签：ajax, jsf-2, primefaces, updating

我想从内部的另一个组件更新一个`p:overlayPanel`组件`p:datatable`

这是代码：

```
 <p:tabView id="monpanel">
<p:tab id="tab1" title=".....">
.....
</p:tab>
<p:tab id="tab2" title=".....">
.....
</p:tab>
<p:tab id="tab3" title="Stock et fournisseurs">

                    <h:panelGrid>
                        <h:outputLabel value="Stock : "
                            style="text-decoration: underline;font-weight: 900;" />

                        <p:commandButton id="carBtn" value="Ajouter" type="button" />
                        <p:outputLabel id="nombref"
                            value="#{articlesMB.NBF} fournisseurs séléctionnés." />

                        <p:overlayPanel appendToBody="true"  widgetVar="overlayp"
                            id="carPanel" for="carBtn" hideEffect="fade" dynamic="true">
                            <p:dataTable id="table" var="car" rowKey="#{car.fournisseurId}"
                                value="#{articlesMB.listfournisseurs}"
                                selection="#{articlesMB.selectedFournisseurs}" rows="10"
                                paginator="true">

                                <p:column selectionMode="multiple" style="width:20px" />
                                <p:column headerText="Id">
                                    <h:outputText value="#{car.fournisseurId}" />
                                </p:column>

                                <p:column headerText="Nom">
                                    <h:outputText value="#{car.personne.nom}" />
                                </p:column>
                                <f:facet name="footer">
                                    <p:commandButton id="multiViewButton" value="View"
                                        icon="ui-icon-search" update=":nombref"
                                        oncomplete="multiCarDialog.show()" />
                                </f:facet>

                            </p:dataTable>
                        </p:overlayPanel>
                        </p:tab>
                        <p:tabview> 
```

我测试过，`update=":nombref"` 但总是有这个错误：`update="monpanel:nombref"``update=":monpanel:nombref"`

```
 com.sun.faces.context.PartialViewContextImpl$PhaseAwareVisitCallback visit
GRAVE: javax.faces.FacesException: Cannot find component with identifier ":nombref" referenced from "monpanel:table:multiViewButton". 
```

我该如何解决这个错误？

# c# - RemotingServices.Marshal(foo, uri) 仅在短时间内有效。如何保持工作？

> ID：16173631
> 
> 赞同：0
> 
> 时间：2013-04-23T15:41:31.983
> 
> 标签：c#, .net, marshalling, remoting

当我做

```
RemotingServices.Marshal(foo, uri); 
```

客户端连接，一切正常。当我等待几分钟然后尝试连接客户端时，客户端会抛出 RemotingException：对象“{服务名称}”已断开连接或在服务器上不存在。

这里会发生什么？是否有某种超时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:44:11.410

为避免超时，您可以向远程对象添加以下重写方法：

```
public override object InitializeLifetimeService(){
  return null;
} 
```

# java - JavaFX2.x 矩形圆角不显示

> ID：16173636
> 
> 赞同：0
> 
> 时间：2013-04-23T15:41:48.623
> 
> 标签：java, javafx-2, javafx, rectangles

只是一个小问题，但我不知道如何解决它，Papa google 也无能为力。我正在绘制一个矩形，`javafx2`并且我想要圆角。但是，矩形显示了所有属性，圆角除外。这是我的代码：

```
 rectPasse = new Rectangle();
   rectPasse.setTranslateX(-160);
   rectPasse.setTranslateY(-160);
   rectPasse.setWidth(54);
   rectPasse.setHeight(140);
   rectPasse.setArcWidth(5);
   rectPasse.setArcWidth(5);
   rectPasse.setFill(Color.RED); 
```

稍后我将矩形添加到舞台：

```
 screensController.getChildren().add(rectPasse); 
```

就像我说的，它显示得非常完美，只是没有圆角。
如果你知道为什么，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:19:20.003

更换第二个

```
rectPasse.setArcWidth(5); 
```

和

```
rectPasse.setArcHeight(5); 
```

`5`值太小无法注意到，`10`否则更多会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T21:25:38.653

这只是一个简单的错字，您将弧宽设置了两次：

```
rectPasse.setArcWidth(5);
rectPasse.setArcWidth(5); 
```

相反，您应该同时设置弧宽和高度：

```
rectPasse.setArcWidth(5);
rectPasse.setArcHeight(5); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-26T19:11:30.657

我用这个：

```
 // bevel
    rect.setArcHeight(15);
    rect.setArcWidth(15); 
```

# ios - 无法将子视图添加到我的 UIView

> ID：16173638
> 
> 赞同：0
> 
> 时间：2013-04-23T15:41:52.000
> 
> 标签：ios, objective-c, uiview, subclass, subview

我`UIView`在屏幕上有一个元素。它由一个`IBOutlet` `radioButtonGroupView`. 我正在尝试向该元素添加一个子视图，但它不起作用。永远不会添加子视图。

这是我的代码：

```
-(id) initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];

    UIView *subView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
    subView.backgroundColor = [UIColor yellowColor];

    [self.radioButtonGroupView addSubview:subView];

    return self;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:53:05.110

如果您将此元素设为 a 的子类`UIViewController`（而不是 a `UIView`），您可能会过得更好。

然后将子视图加载代码放入`viewDidLoad`方法中。

```
 - (void)viewDidLoad
    {
        [super viewDidLoad]; //not really needed but it doesn't hurt

        UIView *subView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 100, 100)];
        subView.backgroundColor = [UIColor yellowColor];

        [self.radioButtonGroupView addSubview:subView];
    } 
```

**编辑：**

您说`self.radioButtonGroupView`您的`viewDidLoad`. 这几乎是一个迹象，表明您`IBOutlet`没有正确连接到 InterfaceBuilder 中的元素。你总是可以做一个简单的测试：

```
- (void)viewDidLoad
{
    [super viewDidLoad]; //not really needed but it doesn't hurt

    NSLog (@"self.radioButtonGroupView: %@",self.radioButtonGroupView);

    [self.radioButtonGroupView setHidden:YES];
} 
```

如果它仍然显示 - 那么它根本没有正确连接。IB有它的方法。简单地删除`IBOutlet`连接并重新连接它可能会奏效。另外：它`radioButtonGroupView`不是`UIView`的子类`UIView`，请确保它的头文件已导入到您的`MyViewController.m`文件中，并且在`.xib`.

# c# - WP8 电话和短信事件

> ID：16173640
> 
> 赞同：0
> 
> 时间：2013-04-23T15:41:58.323
> 
> 标签：c#, windows-phone-8

我有一个后台代理，它需要监听操作系统环境并在我收到电话或短信时做出反应。

收到电话或短信后，我需要查看来电者的电话号码。

有没有办法做到这一点？WP8 是否提供对此类 API 功能的访问？

我所有的谷歌搜索都返回了否定结果，所以我只对遇到这个问题的人的回复感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:37:30.290

这曾经可以通过 Windows Mobile（带有拦截器）实现。但是，此功能在所有版本的 Windows Phone（7 和 8）中都受到保护。我假设 MS 这样做是为了让您的应用程序不会（也不能）干扰来电。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:47:07.410

不，这是不可能的。您无法使用当前 SDK 访问所需的电话或 SMS 属性或事件。

# c# - 带有 MTGOX api 的内部服务器

> ID：16173642
> 
> 赞同：0
> 
> 时间：2013-04-23T15:42:08.127
> 
> 标签：c#, api, httpwebrequest, hmac, bitcoin

我在调用 MTGox HTTP api v2 时遇到问题。我写了一个 sendrequest 函数来处理我所有的请求。它适用于 MONEY/INFO 或 MONEY/ORDERS，但是当我尝试 MONEY/ORDER/QUOTE 或 MONEY/ORDER/ADD 方法时，我收到 500 个内部服务器错误。

似乎当 post_data 包含除了 nonce 之外的任何内容时，它会出错。我该怎么做才能解决这个问题？

发送请求函数：

```
private string sendRequest(string action, NameValueCollection query)
    {

        NameValueCollection nvc = new NameValueCollection();
        nvc.Add("nonce", DateTime.Now.Ticks.ToString());
        nvc.Add(query);

        String post_data = "";
        for (int i = 0; i < nvc.Count; i++)
        {
            post_data += "&";
            post_data += nvc.Keys[i];
            post_data += "=";
            post_data += nvc[i];
        }
        post_data = post_data.Substring(1);

        action = "BTCEUR/money/" + action;
        HttpWebRequest req = (HttpWebRequest)WebRequest.Create(sBasePath + action);
        action += "\0"+post_data;
        req.Method = "POST";

        HMACSHA512 hmac = new HMACSHA512(GetBytes(action));
        hmac.Key = Convert.FromBase64String(secret);
        String sign = Convert.ToBase64String(hmac.ComputeHash(Encoding.UTF8.GetBytes(action)), Base64FormattingOptions.None);

        req.Headers.Add("Rest-Key", apikey);
        req.Headers.Add("Rest-Sign", sign);

        req.UserAgent = "Mozilla/4.0 (compatible; MtGoxTradeCLI)";
        req.ContentType = "application/x-www-form-urlencoded";

        StreamWriter reqStream = new StreamWriter(req.GetRequestStream());
        reqStream.Write(post_data);
        reqStream.Close();

        HttpWebResponse resp = (HttpWebResponse)req.GetResponse();

        StreamReader respStream = new StreamReader(resp.GetResponseStream());
        String response = respStream.ReadToEnd();
        respStream.Close();

        return response;
    } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-24T02:29:00.627

对于任何需要参数的请求，请确保您签名中的 nonce 在您的签名中排在最后，例如对于货币 USD 的货币/钱包/历史记录，您的签名应该是：

```
money/wallet/history\0currency=USD&nonce=xxxxxxxxxx 
```

（\0 是一个空字符，以防万一您想知道）

此外，MtGox 的 API 现在似乎在不断变化——例如，对于上面的钱包历史，我们曾经调用：

```
BTCUSD/money/wallet/history 
```

作为 API 端点，但这似乎不再起作用。现在我们调用：

```
money/wallet/history 
```

因此，如果曾经为您工作的呼叫现在失败了，也请看一下。但我可以肯定地告诉你，将你的 nonce 作为你签名的 QS 中的最后一个参数是至关重要的，否则你的 API 调用将不再有效。

我还建议在 MtGox 中重新创建一个新的 API 密钥——我们必须这样做才能使我们的代码也能正常工作。我有一种预感，这是因为 MtGox 最近的 API 更改已使旧密钥无效（可能会阻止交易机器人在他们弄清楚如何在不让机器人杀死他们的 API 的情况下处理它们时）

# java - Android 和 SQLite 交互：使用多个意图更新行

> ID：16173646
> 
> 赞同：0
> 
> 时间：2013-04-23T15:42:40.770
> 
> 标签：java, android, sqlite

我有一个主要活动的程序，它产生 4 个不同的意图，每个意图都有列表。有一个数据库用于跟踪这些列表中的所有选择。目前以这种`startActivityForResult()`工作方式，我让程序发回一个逗号分隔的字符串，该字符串保存在主要活动的数组中，并在主要“提交”时将其全部保存到数据库中。这些列表代表每天做出的选择，但每个列表对应于同一天。我正在使用`putExtra()`将正确的列表发送到活动。

如果用户关闭程序或 android 杀死应用程序，这可能是一个问题，数组可能会丢失。我想从每个产生的意图更新当前日期数据，但是当我这样做时，它会创建一个新条目。

**主要问题：**我可以设置一个全局日期值（用户在 main 中设置），每个意图都可以引用以`update`用于我的 sql 语句。我想确保数据没有丢失。目前写入数据库仅在提交时在主要活动中完成，但我希望应用程序从每个意图写入数据库。

这个问题在我的脑海中非常抽象，如果需要澄清，我会尽力而为。（我在学校，回家后头脑风暴想尝试的事情）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:11:29.527

在 onPause() 和 onTerminate() 中将数组写入 Shared Preferences。您可以将数组元素编号用作键，并将该数组元素中的任何内容用作值。

我无法完全确定您将使用全局日期/时间戳记在哪里，但如果重点是防止数据丢失，共享首选项可以非常方便。

# string - 使用 .htaccees 从 URL 中删除字符串

> ID：16173653
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:43:05.160
> 
> 标签：string, .htaccess, url, mod-rewrite, bit.ly

我建立了一个 bit.ly 链接并将其打印在 1000 份传单上。不知何故，bit.ly 目标链接包含一些不应该存在的字符串（[https://example.com/page/%E2%80%8E](https://example.com/page/%E2%80%8E)而不是[https://example.com/page/](https://example.com/page/)）

我可以使用重写规则摆脱这个字符串`.htaccess`吗？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T17:35:37.203

当您`%20%E2%80%8E`在创建短链接时不小心添加了字符串，那么您可以得到另一个短链接，而不会再次意外添加字符串。

无论如何，我认为这些`.htaccess`指令是你想要的：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} ^/([a-zA-Z0-9_-]+)\%20\%E2\%80\%8E$
RewriteRule ^(.*) https://example.com/%1 [R,L] 
```

它将重定向`example.com/$anything%20%E2%80%8E`到`example.com/$anything`

只需确保`mod_rewrite`您的网络托管帐户上有 Apache HTTP Server。并考虑了这个关于`[R=301]`标志的链接：[https](https://stackoverflow.com/a/15999177/2007055) ://stackoverflow.com/a/15999177/2007055 。

* * *

这段代码：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} ^/([a-zA-Z0-9_-]+)/\%20\%E2\%80\%8E$
RewriteRule ^(.*) https://example.com/%1/ [R,L] 
```

是重定向`example.com/$anything/%20%E2%80%8E`到`example.com/$anything/`.

# jsf - 在 JSF 中，如何循环遍历值列表并将它们连接到变量/参数中？

> ID：16173654
> 
> 赞同：0
> 
> 时间：2013-04-23T15:43:05.213
> 
> 标签：jsf, loops, concatenation, jsf-2.2

我有可用的数据作为 JSF 页面上的地图和列表。这是一个例子：

```
 [ 
    {
       word: "word1"
       altWord : "altWord1"
    },
    {
       word: "word2"
       altWord : "altWord2"
    },
    {
       word: "word3"
       altWord : "altWord3"
    }
   ] 
```

我想遍历这个列表：

```
 <ui:param name="phrase" value="" />
    <ui:repeat value="wordList" var="wordEntry">
       <ui:param name="phrase" value="#{concat(wordEntry.word)}" />
    </ui:repeat>

<!--Show phrase -->
    #{phrase} 
```

我怎样才能在 JSF 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:39:54.083

我不是 100% 确定你想要实现什么，但让我试试。您的意思是您在托管 bean 中有一个映射列表，如下所示：

```
@SessionScoped
@ManagedBean
public class TestBean {
  private List<Map<String, String>> wordList = new ArrayList<Map<String, String>>();

  @PostConstruct
  public void init() {
    Map<String, String> wordEntry = new HashMap<String, String>();
    wordEntry.put("word", "word1");
    wordEntry.put("altWord", "altWord1");
    wordList.add(wordEntry);
    wordEntry = new HashMap<String, String>();
    wordEntry.put("word", "word2");
    wordEntry.put("altWord", "altWord2");
    wordList.add(wordEntry);
  }

  public List<Map<String, String>> getWordList() {
    return wordList;
  }
} 
```

如果是，那么将视图中的值连接起来`ui:repeat`很容易：

```
<ui:repeat var="wordEntry" value="#{testBean.wordList}" varStatus="status">
    <h:outputText value="#{wordEntry['word']}"/>
    <h:outputText value=" (#{wordEntry['altWord']})"/>
    <h:outputText value=", " rendered="#{not status.last}"/>
</ui:repeat> 
```

这将输出以下字符串：

```
word1 (altWord1), word2 (altWord2) 
```

# wordpress - Wordpress 创建菜单

> ID：16173655
> 
> 赞同：0
> 
> 时间：2013-04-23T15:43:08.973
> 
> 标签：wordpress, drop-down-menu

我创建了一个新菜单，它显示完美，但问题出在选择上，它将我发送到不存在的页面或帖子，问题，我想，.....更改格式输出，我不知道我怎么能解决这个问题。

我的代码：

```
<?php

wp_create_nav_menu( 'Mobil Menu', array( 'slug' => 'theme_footer_mobil_menu' ) );

class Walker_Nav_Menu_Dropdown extends Walker_Nav_Menu
{
// don't output children opening tag (`<ul>`)
public function start_lvl(&$output, $depth){}
// don't output children closing tag    
public function end_lvl(&$output, $depth){}

public function start_el(&$output, $item, $depth, $args){

// add spacing to the title based on the current depth
$item->title = str_repeat("&nbsp;", $depth * 4) . $item->title;
// call the prototype and replace the <li> tag
// from the generated markup...
parent::start_el(&$output, $item, $depth, $args);

$output = str_replace('<li', '<option', $output);
}
// replace closing </li> with the closing option tag
public function end_el(&$output, $item, $depth){
$output .= "</option>\n";
}
}

wp_nav_menu(array(
"menu"=>"Mobil Menu",
'theme_location' => 'primary', 
'walker'         => new Walker_Nav_Menu_Dropdown(),
'items_wrap'     => '<select class="footer_menu_mobile" onChange="if(this.selectedIndex!=0) self.location=this.options[this.selectedIndex].value">%3$s</select>',
));

?> 
```

显示完美的下拉菜单，但真正的问题是从选定的菜单启动 URL，此 URL 显示有空格且没有权限

感谢和问候 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:07:42.487

为什么不使用简单的 css drop-dwo 菜单？

这是一个工作示例：

```
 .menu{
    border:none;
    border:0px;
    margin:0px;
    padding:0px 0px 0px 20px;
    font-family:"Arial";
    font-size:12px;
    font-weight:bold;
    list-style-type:none;

    }
.menu ul{
    height:35px;
    list-style:none;
    margin:0;
    padding:0;

     }
.menu li{
    float:left;
    padding:0px;
    list-style-type:none;

    }
.menu li a{
    background-color:#CC0000;
    color:#fff;
    display:block;
    font-weight:bold;
    line-height:35px;
    margin:0px;
    padding:0px 13px;
    text-align:center;
    text-decoration:none;
    list-style-type:none;
    }

    .menu li a:hover {
background-color:#000;
border-radius:3px;
    color:#fff;
    text-decoration:none;
    list-style-type:none;
    }
.menu ul li:hover a{
background-color:#000;
border-radius:-3px;
    color:#fff;
    text-decoration:none;
    list-style-type:none;
    }
.menu li ul{
background-color:#ccc;
color:#FFFFFF;
    display:none;
    height:auto;
    padding:0px;
    margin:0px;
    border:0px;
    position:absolute;
    width:150px;
    z-index:230;
    /*top:1em;*/
    }

.menu li ul li ul {
   margin-left:150px;
   margin-top:-35px;    
}

.menu li:hover > ul{
    display:block;

    }
.menu li li {
background:#000000;
    display:block;
    float:none;
    margin:0px;
    padding:0px;
    width:150px;
    }
.menu li:hover li a{
    background:none;

    }
.menu li ul a{
    display:block;
    height:35px;
    font-size:12px;
    font-style:normal;
    margin:0px;
    padding:0px 10px 0px 15px;
    text-align:left;
    }

.menu li ul li:hover {
    background:#CC0000;
    border:0px;
    color:#ffffff;
    text-decoration:none;
    }
.menu p {
    clear:left;
    } 
```

这是php

```
<?php $defaults = array(
    'theme_location'  => 'Primary',
    'menu'            => 'your menu name', 
    'container'       => 'ul', 
    'container_class' => 'menu-{menu slug}-container', 
    'container_id'    => 'menu',
    'menu_class'      => 'menu', 
    'menu_id'         => 'menu-{menuslug}[-{increment}]',
    'echo'            => true,
    'fallback_cb'     => 'wp_page_menu',
    'before'          => '',
    'after'           => '',
    'link_before'     => '',
    'link_after'      => '',
    'items_wrap'      => '<ul id="%1$s" class="%2$s">%3$s</ul>',
    'depth'           => 0,
    'walker'          => ''
); ?>
              <?php wp_nav_menu( $defaults ); ?> 
```

# java - Java 集合

> ID：16173656
> 
> 赞同：0
> 
> 时间：2013-04-23T15:43:11.097
> 
> 标签：java, collections, arraylist, hashtable

我需要创建一个 Hallway 类，其中包含 2`ArrayLists`个 Stand 对象，一个用于右侧的支架，另一个用于左侧的支架。

我的意图是将这些`ArrayLists`放在这个类的另一个集合中。

我不知道我是否应该使用哈希表、地图等。

更重要的是，我的意图是使用以下方法访问这些 ArrayList：

> TheHashTable["Right"].add(standObject); // 在 Hashtable 内的 Right Stands ArrayList 中添加一个 Stand。

例子：

```
 public class Hallway {       

      private Hashtable< String, ArrayList<<Stand> > stands;

      Hallway(){
         // Create 2 ArrayList<Stand>)
         this.stands.put("Right", RightStands);
         this.stands.put("Left", LeftStands);
      }      

      public void addStand(Stand s){
         this.stands["Right"].add(s);
      }
} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:53:11.733

这是可能的，但我建议不要这样做。如果您只有两个展台位置，那么简单地拥有两个类型的变量会更加清晰`List<Stand>`：`leftStands`和`rightStands`，并具有相应的方法：`addLeftStand(Stand)`，`addRightStand(Stand)`等。代码会更清晰，更简单，更安全。

如果您真的想按自己的方式行事，则地图的键不应该是字符串。调用者不知道将哪个键传递给您的方法（有无限的字符串），即使他知道键是“右”和“左”，他也可能会打错字，而不会被编译器。您应该改用枚举，这将使代码自我记录且更安全：

```
public enum Location {
    LEFT, RIGHT
}

private Map<Location, List<Stand>> stands = new HashMap<Location, List<Stand>>();

public Hallway() {
    for (Location location : Location.values()) {
        stands.put(location, new ArrayList<Stand>());
    }
}

public void addStand(Location location, Stand stand) {
    stands.get(location).add(stand);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:50:27.170

如果您只有左右，例如，您可以创建 2 个数组列表。

```
private ArrayList<Stand> rightStands;
private ArrayList<Stand> leftStands; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:48:39.360

如果我清楚地理解了您的问题，那么这就是您想要的：

```
public void addStand(Stand s){
 this.stand.get("Right").add(s);
} 
```

但更好的方法是使用[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)而不是[Hashtable](http://docs.oracle.com/javase/6/docs/api/java/util/Hashtable.html)。

```
public class Hallway {

 private Map< String, ArrayList<<Stand> > stands;
 private List<Stand> RightStands;
 private List<Stand> LeftStands;

 Hallway(){
    stands = new HashMap();
    RightStands = new ArrayList();
    LeftStands = new ArrayList();
    this.stands.put("Right", RightStands);
    this.stands.put("Left", LeftStands);
  }      

  public void addStand(Stand s){
     this.stands.get("Right").add(s);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-20T11:08:22.920

不要使用哈希表。很久以前它就被弃用了。使用 TreeMap 或 HashMap。

```
List<Stand> right=new ArrayList<Stand>(),left=new ArrayList<Stand>();
Map<String,List<Stand> > stands= new HashMap<String, List<Stand> >();
stands.put("right",right);
stands.put("left",left); 
```

要了解地图并确定最适合您的地图，请阅读[Precisely Concise：Java Maps](http://preciselyconcise.com/java/collections/h_map.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:52:03.303

您需要一个多地图，例如来自[Commons Collections](http://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections/MultiMap.html)或[Guava](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multimap.html)。

这些将允许您将多个值（Stand1、Stand2、...）映射到单个键（例如“right”）。

例如（使用 Commons Collections）：

```
MultiMap stands = new MultiHashMap();
stands.put("left", new Stand());
stands.put("left", new Stand());
stands.put("right", new Stand());
stands.put("right", new Stand());
stands.put("right", new Stand());
Collection standsOnLeftSide = (Collection) stands.get("left"); 
```

我认为虽然 Guava 更可取，因为它支持泛型。

# r - 动态生成引用类

> ID：16173658
> 
> 赞同：13
> 
> 时间：2013-04-23T15:43:12.407
> 
> 标签：r, reference-class

我试图在 R 包中动态生成引用类，事实证明这相当困难。以下是我采用的方法和遇到的问题：

我正在创建一个包，希望能够在其中动态读取模式并自动生成关联的引用类（想想 SOAP）。当然，这意味着我将无法在包源中预先定义我的参考类。

我最初尝试使用一个简单的方法创建一个新类：

```
myClass <- setRefClass("NewClassName", fields=list(fieldA="character")) 
```

当然，在交互执行时可以正常工作，但是当包含在包源中时，我得到一个`locked binding`错误。从我的阅读来看，发生这种情况是因为在交互运行时，类信息存储在未锁定的全局环境中，而我的包的基本环境被锁定。

然后我发现了一个线程，它建议使用一些东西来达到以下效果：

```
myClass <- setRefClass("NewClassName", fields=list(fieldA="character"), where=globalenv()) 
```

当我尝试构建包时，这实际上使 R/Studio 崩溃，所以很遗憾，我没有它生成的错误的日志，但它肯定没有工作。

接下来我尝试在我的包中创建一个新环境，我可以使用它来存储这些引用类。所以我`.classEnv <- new.env()`在我的包源中添加了一行（不在任何函数内部），然后在创建新的引用类时尝试使用这个类：

```
myClass <- setRefClass("NewClassName", fields=list(fieldA="character"), where=.classEnv) 
```

这实际上似乎工作正常，但会产生以下警告：

```
> myClass <- setRefClass("NewClassName", where=.classEnv)
Warning message:
In getPackageName(where) :
  Created a package name, ‘2013-04-23 10:19:14’, when none found 
```

那么，由于某种原因，`methods::getPackageName()`无法确定我的新环境在哪个包中？

有没有办法以不同的方式创建我的新环境，以便`getPackageName()`正确识别包？我可以添加一些功能来帮助`getPackageName()`检测包裹吗？如果我可以处理警告，这甚至会起作用，还是我通过尝试动态创建引用类来滥用引用类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:55:46.673

为了进行对话，我发现`getpackageName`将包名称存储在`.packageName`指定环境中的隐藏变量中。

所以你实际上可以绕过警告

```
assign(".packageName", "MyPkg", envir=.classEnv)    
myClass <- setRefClass("NewClassName", fields=classFields, where=.classEnv) 
```

这解决了警告，但文档说不要`.packageName`无限期地信任变量，我仍然觉得我正在破解它，并且可能误解了关于参考类及其与环境的关系的重要内容。

文档中的完整详细信息：

> 包名通常在加载包的过程中通过安装脚本或库函数安装。（目前，名称存储为对象 .packageName 但以后不要相信它。）

* * *

**编辑**：

在进一步阅读之后，该`setPackageName`方法可能是为环境设置包名称的更可靠的方法。根据文档：

> `setPackageName`可用于在没有包名的环境中建立包名。这允许您在任意环境中创建类和/或方法，但通常最好通过标准 R 编程工具（package.skeleton 等）创建包

所以看起来一个有效的解决方案如下：

```
setPackageName("MyPkg", .classEnv)
myClass <- setRefClass("NewClassName", fields=classFields, where=.classEnv) 
```

这消除了警告消息，并且不依赖于任何记录为不稳定的内容。我仍然不清楚为什么它是必要的，但是......

# ios - 将点击行为重定向到 UICollectionViewCell 中的另一层

> ID：16173664
> 
> 赞同：1
> 
> 时间：2013-04-23T15:43:20.573
> 
> 标签：ios, objective-c, cocoa-touch, uicollectionview, uicollectionviewcell

我试图弄清楚如何更改`UICollectionViewCell`触发`UICollectionView`'s的视图`didSelectCellAtIndexPath`。我想要一个顶层，可以点击以激活，或平移以显示较低层的按钮。

我可以在顶部添加一个视图，并实现平移显示手势，但我必须点击底层视图才能触发`didSelect`。

另外，我没有使用 xib 或故事板，这都是代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:52:47.800

感谢@peko，我想通了。

```
- (void)selectCell {
    UICollectionView *collectionView = (UICollectionView *)self.superview;
    NSIndexPath *indexPath = [collectionView indexPathForCell:self];
    [collectionView.delegate collectionView:collectionView didSelectItemAtIndexPath:indexPath];
} 
```

这允许我从视图控制器中模拟单元格的选择。

# html - 单击div时出现随机线

> ID：16173665
> 
> 赞同：-8
> 
> 时间：2013-04-23T15:43:20.410
> 
> 标签：html, css

我想知道为什么当我双击我的 div 时会出现一条随机线

![在此处输入图像描述](https://i.stack.imgur.com/JBHWi.jpg)

当我双击中间的黑色按钮时，会发生这种情况： ![在此处输入图像描述](https://i.stack.imgur.com/tR9C6.jpg)

为什么会这样？我猜那是 div 边界？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:45:36.247

这实际上是被选中的元素。双击文本是“选择这个词”的快捷方式。

# matplotlib - 为什么我的颜色条没有出现在这个 ImageGrid 图中？

> ID：16173666
> 
> 赞同：0
> 
> 时间：2013-04-23T15:43:24.070
> 
> 标签：matplotlib, colorbar

我已经设法使用下面的代码制作了一组子`hist2d`图`ImageGrid`：

```
from mpl_toolkits.axes_grid1 import ImageGrid

fig = figure(figsize(20, 60))
grid = ImageGrid(fig, 111, nrows_ncols=(1, 3), axes_pad=0.25)
for soa, ax in zip(soalist, grid):
    # grab my data from pandas DataFrame...
    samps = allsubs[allsubs['soa'] == soa]
    x, y = samps['x'], samps['y']

    # calls hist2d and returns the Image returned by hist2d
    img = gazemap(x, y, ax, std=True, mean=True)
    ax.set_title("{0} ms".format(soa * 1000))

# attempt to show a colorbar for that image       
grid.cbar_axes[-1].colorbar(img)

show()  # threw this in for good measure, but doesn't help! 
```

我没有得到明确的错误（这很好，因为我传递了`Image`to `colorbar`），但我的颜色**条没有出现**。是什么赋予了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:51:03.793

好的，我修好了！

我所要做的就是将`cbar_mode`and `cbar_location`kwargs 传递给`ImageGrid`！

# jquery - Anchor plus href 和 onclick 事件（跟踪）

> ID：16173667
> 
> 赞同：0
> 
> 时间：2013-04-23T15:43:26.543
> 
> 标签：jquery, url, onclick, statistics, href

我得到了以下锚点来访问目标站点并跟踪用户的统计信息：

```
<a href="http://target.tld" target="_blank" onclick="$('<img></img>').attr({src: 'stats.php?my_param=value'}); return true;">Foo</a>

<a href="http://target.tld" target="_self" onclick="$('<img></img>').attr({src: 'stats.php?my_param=value'}); return true;">Foo</a> 
```

第一个为 img (_blank) 生成*200 Ok*的状态，但第二个 (_self) 的状态为*(canceled)*。

有人能告诉我为什么吗，有没有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:50:30.860

首先，避免`on*`事件属性。如果你有 jQuery，用它来绑定你的事件。其次，看起来您创建`img`元素的目的是发出 GET 请求来跟踪点击。相反，只需使用 jQuery 来触发请求。

```
<a href="http://target.tld" target="_blank" class="track-link" data-value="foo">Foo</a>    
<a href="http://target.tld" target="_self" class="track-link" data-value="bar">Foo</a> 
```

```
$('.track-link').click(function() {
    var trackValue = $(this).data('value');
    $.get('/stats.php', { my_param: trackValue });
}); 
```

**更新**

尝试使用该`mousedown`事件来确保在页面传输之前发送请求：

```
$('.track-link').mousedown(function() {
    var $link = $(this);

    if (!$link.data('request-sent')) {
        $.get(
            '/stats.php', 
            { my_param: $link.data('value') },
            function() {
                $link.data('request-sent', true);
            }
        );
    }
}); 
```

**更新#3**

```
$('.track-link').click(function(e) {
    e.preventDefault();
    var $link = $(this);
    $.get(
        '/stats.php', 
        { my_param: $link.data('value') },
        function() {
            window.location.assign($link.prop('href'));
        }
    );
}); 
```

# sql - Doctrine DQL 每组最大 n

> ID：16173669
> 
> 赞同：3
> 
> 时间：2013-04-23T15:43:27.907
> 
> 标签：sql, symfony, doctrine-orm, greatest-n-per-group, dql

这是我的 Symfony2 项目的 2 个表：

```
+-----------+     +----------------------------+ 
|  EVENT    |     |         PHOTO              |
+-----------+     +------+-----------+---------+
|    id     |     | id   | event_id  |  likes  |
+-----------+     +------+-----------+---------+
|     1     |     |  1   |    1      |   90    |
|     2     |     |  2   |    1      |   50    |
+-----------+     |  3   |    2      |   20    |
                  |  4   |    2      |   10    |
                  +------+-----------+---------+ 
```

我想选择最喜欢的照片的 2 个事件，看起来像：

```
+------------+------------+---------+  
|  event_id  |  photo_id  |  likes  |  
+------------+------------+---------+
|     1      |     1      |    90   |
+------------+----------------------+
|     2      |     3      |    20   |
+------------+----------------------+ 
```

此处解释了 SQL 解决方案（[SQL Select only rows with Max Value on a Column](https://stackoverflow.com/questions/7745609/sql-select-only-rows-with-max-value-on-a-column)）并且可能是：

```
SELECT p.event_id, p.likes, p.id
FROM photo p
INNER JOIN(
    SELECT event_id, max(likes) likes
    FROM photo
    GROUP BY event_id
) ss on p.event_id = ss.event_id and p.likes = ss.likes 
```

**什么是 DQL 查询？我尝试了很多东西，但总是出错。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:34:35.793

我没有设法使用 DQL 找到合适的答案，但是通过学说，有一种方法可以使用他们所谓的 Native Query 来处理 SQL 查询。

我设法使用 Native Query 模块和 Symfony 2 创建了您的 SQL 示例的工作示例

```
use Doctrine\ORM\EntityRepository;
use Doctrine\ORM\Query\ResultSetMapping;

class PhotoRepository extends EntityRepository
{
    public function findSomeByEvent()
    {
        $rsm = new ResultSetMapping;
        $rsm->addEntityResult('theNameOfYourBundle:Photo', 'p');
        $rsm->addFieldResult('p', 'id', 'id');
        $rsm->addFieldResult('p', 'likes', 'likes');
        $rsm->addFieldResult('p', 'event', 'event');

        $sql = 'SELECT p.event_id, p.likes, p.id
                FROM Photo p
                INNER JOIN(
                    SELECT event_id, max(likes) likes
                    FROM Photo
                    GROUP BY event_id
                ) ss on p.event_id = ss.event_id and p.likes = ss.likes';
        $query = $this->_em->createNativeQuery($sql, $rsm);

        $resultats = $query->getArrayResult();

        return $resultats;
    }
} 
```

这是文档的链接：[Native Query](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/native-sql.html)，如果答案没有按预期工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-15T06:57:37.050

要使用 DQL 执行此操作，您可以使用以下方法，使用子查询方法处理相同的方法很难用教义做，所以我使用[best-n-per-group](/questions/tagged/greatest-n-per-group "显示标记为“每组最大数”的问题")方法而不使用聚合函数

[SQL 演示](http://sqlfiddle.com/#!9/f1d0e/4)

```
$DM      = $this->get( 'Doctrine' )->getManager();
$DQL     = 'SELECT a 
        FROM AppBundle\Entity\Photo a
        LEFT JOIN AppBundle\Entity\Photo b WITH a.event = b.event AND a.likes < b.likes
        WHERE b.id IS NULL
        ORDER BY a.likes DESC
        ';
$query   = $DM->createQuery( $DQL );
$results = $query->getResult();
foreach ( $results as $result ) {
    echo '<pre>';
    print_r($result->getEvent()->getId().' - photo'.$result->getId().' - '. $result->getLikes() );
    echo '</pre>';
} 
```

请注意，我已经用学说 2 和 symfony 2.8 对此进行了测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:51:02.190

在您的查询中，您要加入 ss.Id 但您尚未在子查询中选择该列，因此 ss.id 不存在。此外，您的内部联接是您称为 p2.event e2 的表。我认为您只打算用于“事件 e2”

```
SELECT p.id
FROM Photo p
INNER JOIN (
            SELECT p2.likes, e2.id
            FROM Photo p2
            INNER JOIN event e2
            GROUP BY e2.id
           ) ss ON ( p.event_id = ss.id AND p.likes = ss.likes ) 
```

这里唯一的变化是我将 e2.id 添加到您的子查询选择中。此查询仍然无法解决您的问题。你想要最喜欢的那个。所以你应该把 p2.likes 变成 MAX(p2.likes)

```
SELECT p.id
FROM Photo p
INNER JOIN (
            SELECT MAX(p2.likes) AS Likes, e2.id
            FROM Photo p2
            INNER JOIN event e2
            GROUP BY e2.id
           ) ss ON ( p.event_id = ss.id AND p.likes = ss.likes ) 
```

此外，考虑如果两张图片与喜欢相关，您将使用此查询返回两个结果。您可能会考虑使用 CROSS APPLY（假设 DQL 有它）来避免这样的事情。

```
SELECT e.id, p.id
FROM Events E
CROSS APPLY (
              SELECT TOP 1 p.id
              FROM photos p 
              WHERE p.event_id = e.id
              ORDER BY Likes DESC 
            ) p 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:55:26.383

不是 DQL 专家，但如果您避免使用聚合函数，则始终可以使用[SQL Select only rows with Max Value on a Column](https://stackoverflow.com/questions/7745609/sql-select-only-rows-with-max-value-on-a-column)中描述的第二种方法：

```
select p1.*
from photos p1
left outer join photos p2
on (p1.event_id = p2.event_id and p1.likes < p2.likes)
where p2.event_id is null; 
```

# android - Android：这是什么菜单布局？

> ID：16173671
> 
> 赞同：1
> 
> 时间：2013-04-23T15:43:42.633
> 
> 标签：android, android-layout, user-interface, menu, menuitem

我想为我的应用程序制作一个菜单，就像这张来自 Instapaper 应用程序 [http://i.stack.imgur.com/KwLrx.jpg的图片一样](https://lh3.ggpht.com/PjOttZyCLZK2eGvQCshWOjwdfRaK9iOUCqqgWgGeg9g4ygaN_BY6i8c6PeFoSl5Mt1w_)

所以菜单覆盖了当前活动的一部分，当从菜单中采取行动时，会立即看到效果，并且在应用单个操作后菜单不会关闭。

这是什么布局？我该如何实施？或者它是某种图书馆？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:52:57.387

这当然是开发人员的自定义实现。

当您调用菜单时，很可能是一个 XML 布局膨胀和动画。

# linq-to-sql - 由于FK约束，linq to sql插入失败，如何同时提交所有相关对象？

> ID：16173674
> 
> 赞同：1
> 
> 时间：2013-04-23T15:43:51.857
> 
> 标签：linq-to-sql

我正在使用 linq to sql 并尝试插入新对象。这是我的代码示例：

```
public class Farm(){
    public List<FarmAnimals> FarmAnimals ();
    public string FarmName;
}

Public class FarmAnimal(){
    public string name;
}

public void Insert(FarmModel farm)
    {
        using (var context = new FarmDataClassesDataContext())
        {
            context.Farms.InsertOnSubmit(new Farm { FarmName = farm.FarmName });
            foreach (var animal in farm.FarmAnimals)
            {
                context.Responses.InsertOnSubmit(new FarmAnimal {name = animal.name, farmID = farm.Id });

            }
            context.SubmitChanges();
        }
    } 
```

当它尝试插入农场动物时，我得到一个 FK 约束错误，引用农场 ID（等于 0）。由于尚未插入农场，因此它没有可供农场动物参考的 ID。如何提交农场以便正确设置农场动物 FK？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T19:26:21.627

问题是您正在考虑 SQL 方式，而不是 ORM 方式。

SQL方式分配一个外键：

```
 InsertOnSubmit(new FarmAnimal {name = animal.name, farmID = farm.Id }); 
```

ORM 方式分配**实体**。请注意以下代码示例中 ** ** 之间的部分。

```
 var myFarm = new Farm { FarmName = farm.FarmName };
 Con...InsertOnSubmit(myFarm)
 Con...InsertOnSubmit(new FarmAnimal {name = animal.name, **farm = myFarm**}); 
```

因为您分配了实体，所以将处理正确的插入，并将其作为一笔交易的奖励。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T01:44:44.787

要扩展 Pleun 的答案：您需要分配实体而不是 ID。您尝试分配的属性映射到具有外键约束的列，因此它不适用于分配实体 - 为此，您需要一个映射到两个表之间*关系*的属性. 你如何做到这一点因你使用的工具而异。

出于解释的目的，我假设您有一个`Farm`表，其中一个主键列称为;`ID`另一个列称为`Name`; 和一个`FarmAnimal`表，其中一个名为 的外键列`FarmFK`指向该`Farm`表，另一列名为`Name`.

根据`DataContext`名称的一部分，我假设您使用的是 Visual Studio 中内置的 O/R Designer 工具，对吧？如果是这样，通过打开文件转到 O/R 设计器，选择和`dbml`之间的关联（表示为箭头）（如果还没有箭头，请从工具箱中选择关联工具并从`Farm``FarmAnimal``Farm``FarmAnimal`)，并查看关联的属性。您将看到名为“子属性”和“父属性”的属性。（父表是关系中具有主键的表。）展开这些以查看每个的“名称”子属性。这些是您在代码中用于访问关系两端的属性名称。通常，根据自动生成，它们的名称选择不当，因此请根据需要重命名它们。在这种情况下，我们将父属性的名称重命名`Animals`为“Farm”，子属性的名称重命名为“Farm”。然后，您可以在代码中执行以下操作：

```
public void Insert(FarmModel farmModel)
{
    using (var context = new FarmDataClassesDataContext())
    {
        var farm = new Farm 
            {
                Name = farmModel.FarmName
            };
        context.Farms.InsertOnSubmit(farm);

        foreach (var animalModel in farmModel.FarmAnimals)
        {
            var critter = new FarmAnimal
                {
                    Name = animalModel.name,
                    Farm = farm
                }
            context.Responses.InsertOnSubmit(critter);
        }

        context.SubmitChanges();
    }
} 
```

这能满足您的需求吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T17:32:13.737

您必须在插入 FarmAnimals 之前提交更改，并且您需要让列自动创建具有自动增量的键。还要确保 DBML 文件中表对象中的列在插入时自动更新。

```
public class Farm(){
    public List<FarmAnimals> FarmAnimals ();
    public string FarmName;
}

Public class FarmAnimal(){
    public string name;
}

public void Insert(FarmModel farm)
    {
        using (var context = new FarmDataClassesDataContext())
        {
            Farm newFarm = new Farm { FarmName = farm.FarmName }; <--- New

            context.Farms.InsertOnSubmit(newFarm); <---Edited

            context.SubmitChanges();  <--- New

            foreach (var animal in farm.FarmAnimals)
            {
                context.Responses.InsertOnSubmit(new FarmAnimal {name = animal.name, farmID = newFarm.Id }); <--- Edited

            }
            context.SubmitChanges();
        }
    } 
```

# c# - 从具有 1 个表和 0 行的 XML 创建一个数据集

> ID：16173681
> 
> 赞同：1
> 
> 时间：2013-04-23T15:44:13.430
> 
> 标签：c#, xml, dataset

我目前正在`DataSet`使用这个从 XML 流创建一个

```
DataSet dataSet = new DataSet();
dataSet.ReadXml(xml); 
```

我试过这个，

```
<?xml version="1.0" standalone="yes"?>
<NewDataSet>
  <Table>
  </Table>
</NewDataSet> 
```

它创建了一个名为“NewDataSet”的表，`DataSet`其中`Tables[0]`1 列名为“表”，1 行的“表”值为“”。然后我尝试了这个，

```
<?xml version="1.0" standalone="yes"?>
<NewDataSet>
</NewDataSet> 
```

但这会创建一个没有表的 DataSet。如何创建一个数据集，其中包含 1 个名为“表”的表，其中包含 1 列，但现在为行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:38:29.743

你不能。ReadXml 和 WriteXml 仅读取/写入数据，而不是整个数据集/数据表/列/等模式的结构。

[我的建议是首先使用函数ReadXmlSchema](https://msdn.microsoft.com/en-us/library/system.data.dataset.readxmlschema(v=vs.110).aspx)从单独的模式文件中读取模式，然后读取数据文件。

您的架构可能如下所示：

```
<?xml version="1.0" standalone="yes"?>
<xs:schema id="MyDataSet" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
  <xs:element name="MyDataSet" msdata:IsDataSet="true" msdata:UseCurrentLocale="true">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="MyDataTable">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="MyDataColumn" type="xs:string" minOccurs="0" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

# android - 如何设置图像之间的边距

> ID：16173682
> 
> 赞同：0
> 
> 时间：2013-04-23T15:44:20.463
> 
> 标签：android

我在安多里德工作。我设计了一些图像的菜单。当显示为纵向时，此菜单很好，如下所示：_

![在此处输入图像描述](https://i.stack.imgur.com/WCpXC.png)

但是当在横向模式下看到这个程序时，图像会被拉伸。
像这样 ：-

![在此处输入图像描述](https://i.stack.imgur.com/aqpPw.png)

但我想看到与纵向模式相同大小的图像，即使图像之间的空间可能会改变。这是我的代码：-

```
 <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:layout_centerVertical="true" >

        <ImageButton
            android:id="@+id/btnMediaMenu"
            android:scaleType="fitXY"
            android:background="@null"
            android:onClick="menuClicked"
            android:layout_width="32px"

            android:layout_marginRight="10dip"
            android:layout_height="32px"
            android:src="@drawable/media" />
            <same code for other images...   /> 
```

请建议我应该怎么做，这样这些图像不能被拉伸，图像之间的空间可能会增加以填满屏幕。

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:45:32.107

尝试使用 android:scaleType="centerInside"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:48:49.020

使用以下内容

```
android:scaleType="centerinside"
android:layout_weight=1 // for all button
android:layout_width = "0dip" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T16:00:21.170

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/linearLayout1"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_centerHorizontal="true"
android:layout_centerVertical="true"
android:orientation="horizontal"
android:paddingLeft="10dp"
android:paddingRight="10dp" >

<ImageButton
    android:layout_width="0dp"
    android:layout_height="32dp"
    android:layout_weight="1"
    android:background="@null"
    android:onClick="menuClicked"
    android:scaleType="fitCenter"
    android:src="@drawable/ic_launcher" />

<ImageButton
    android:layout_width="0dp"
    android:layout_height="32dp"
    android:layout_weight="1"
    android:background="@null"
    android:onClick="menuClicked"
    android:scaleType="fitCenter"
    android:src="@drawable/ic_launcher" />

<ImageButton
    android:layout_width="0dp"
    android:layout_height="32dp"
    android:layout_weight="1"
    android:background="@null"
    android:onClick="menuClicked"
    android:scaleType="fitCenter"
    android:src="@drawable/ic_launcher" />

<ImageButton
    android:layout_width="0dp"
    android:layout_height="32dp"
    android:layout_weight="1"
    android:background="@null"
    android:onClick="menuClicked"
    android:scaleType="fitCenter"
    android:src="@drawable/ic_launcher" />

</LinearLayout> 
```

# git - Gitolite克隆失败

> ID：16173685
> 
> 赞同：2
> 
> 时间：2013-04-23T15:44:29.410
> 
> 标签：git, gitolite, tortoisegit

每当我尝试克隆笔记本电脑上的任何存储库时，我都会收到以下消息：

```
Unable to open connection:
Host does not existfatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists. 
```

但是，当我在桌面上使用相同的私钥时，我可以毫无问题地克隆。

客户端都是 Windows 上的 TortoiseGit。

我以为我一定做错了什么，但我不知道为什么，所以我试图将克隆的 git 存储库从我的桌面复制到我的笔记本电脑，现在我可以从我的笔记本电脑修改（推/拉/提交）到该存储库.

所以在某处身份验证有效，但我无法克隆。

最糟糕的是，这也突然发生在我们团队的另一位成员身上。

我做了什么：

1.  安装 TortoiseGit
2.  安装 msysgit
3.  使用私钥在腻子中设置 ssh 会话
4.  使用该会话执行 git clone （失败）

和我在台式机上做的一样，但它在那里工作，在笔记本电脑上它失败了。

但是手动复制存储库并进行更改确实有效，就像只有 git clone 被拒绝一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T17:39:31.373

[您可以尝试“ git push to remote repository “Could not read from remote repository”</a>](https://stackoverflow.com/questions/16118797/git-push-to-remote-repository-could-not-read-from-remote-repository/16119444#16119444)中提到的各种调试技巧。

[](https://stackoverflow.com/questions/16118797/git-push-to-remote-repository-could-not-read-from-remote-repository/16119444#16119444)

[但首先，检查使用`openssh`而不是`plink.exe`用于 ssh 通信时问题是否仍然存在（如](https://stackoverflow.com/questions/16118797/git-push-to-remote-repository-could-not-read-from-remote-repository/16119444#16119444)[本问题](https://stackoverflow.com/q/15476497/6309)中所述）。

您可以在 TortoiseGit 中更改设置`Settings>Network>SSH`：

![网络](https://i.stack.imgur.com/4TmLP.png)

# spring - Spring Data Mongo 无法正确处理实体继承

> ID：16173686
> 
> 赞同：1
> 
> 时间：2013-04-23T15:44:31.550
> 
> 标签：spring, mongodb, spring-data-mongodb

我在我的项目中使用 Spring Data Mongo，如下所示：

1.  Spring Data MongoDB 1.2/ Spring Data Commons 1.5
2.  春季 3.2.2 发布
3.  MongoDB / QueryDSL 2.9/ Mongo Java 驱动程序 2.10.1

**案例一：** @Id 来自 Spring Data Commons，@Document 来自 Spring Data Mongo。

```
@Document
class User{
    @Id String id;
}

@Document
class Picture{
    @Id String id;
}

@Document 
class Avatar extends Picture{
    @DBref User user;
} 
```

我没有使用 Spring Data Repostory api 或 QueryDSL 之一，我无法按用户获取头像数据。

```
//decalred in repository
List<Avatar> findByUser(User user);

// or from the QueryDSL executor
List<Avatar> avatars=rep.findAll(QAvatar.avatar.user.eq(user)); 
```

全部返回空集合（当然里面有一些数据）。

**案例2**：如果我第一次删除@DBRef，在我插入头像和用户后，它可以工作，但是当我更新用户中的数据时，然后按用户获取头像，返回空列表。

```
@Document 
class Avatar extends Picture{
    User user;
} 
```

**案例3**：将用户更改为字符串（用户id），它可以工作。

```
@Document 
class Avatar extends Picture{
    String userId;
} 
```

这里对 MongoDB 的 java 建模有什么建议吗？谢谢。

# c++ - C++ 粒子系统 Allegro 5

> ID：16173687
> 
> 赞同：0
> 
> 时间：2013-04-23T15:44:33.533
> 
> 标签：c++, system, allegro5, particles

我目前正在制作一个粒子系统，一个基本的，也使用 Allegro 5 库。

这是我想出的：

```
int main()
{

    int mouseX = 0, mouseY = 0;
    int randNum = 0;

    std::vector <Particle *> Particles;
    bool running = false, redraw =  false, mouseHold = false;
    int particleCount = 0;

    al_init();
    al_init_image_addon();
    al_install_mouse();
    al_init_font_addon();
    al_init_ttf_addon();

    ALLEGRO_DISPLAY* display = al_create_display(800, 600);
    ALLEGRO_EVENT_QUEUE* event_queue = al_create_event_queue();
    ALLEGRO_TIMER* myTimer = al_create_timer(1.0 / 60);
    ALLEGRO_TIMER* pTimer = al_create_timer(1.0 / 120);
    ALLEGRO_FONT* myFont = al_load_ttf_font("MyFont.ttf", 20, NULL);

    al_register_event_source(event_queue, al_get_display_event_source(display));
    al_register_event_source(event_queue, al_get_timer_event_source(myTimer));
    al_register_event_source(event_queue, al_get_timer_event_source(pTimer));
    al_register_event_source(event_queue, al_get_mouse_event_source());

    running = true;
    al_start_timer(myTimer);
    while(running)
    {
        ALLEGRO_EVENT ev;
        al_wait_for_event(event_queue, &ev);

        if(ev.type == ALLEGRO_EVENT_DISPLAY_CLOSE)
            running = false;

        if(ev.type == ALLEGRO_EVENT_MOUSE_AXES)
        {
            mouseX = ev.mouse.x;
            mouseY = ev.mouse.y;
        }

        if(ev.type == ALLEGRO_EVENT_MOUSE_BUTTON_DOWN)
        {
            if(ev.mouse.button == 1)
                mouseHold = true;
        }

        if(ev.type == ALLEGRO_EVENT_MOUSE_BUTTON_UP)
        {
            if(ev.mouse.button == 1)
                mouseHold = false;
        }

        if(ev.type == ALLEGRO_EVENT_TIMER)
        {
            randNum = (std::rand()+1 * ev.timer.count) % 50;
            std::cout << randNum << std::endl;

            if(mouseHold)
            {
                Particle* particle = new Particle(mouseX + randNum, mouseY + randNum);
                Particles.push_back(particle);
            }

            particleCount = Particles.size();
            for(auto i : Particles)
                i->Update();

            redraw = true;
        }

        for(auto iter = Particles.begin(); iter != Particles.end(); )
            {
                if(!(*iter)->GetAlive())
                {
                    delete (*iter);
                    iter = Particles.erase(iter);
                }
                else
                    iter++;
            }

        if(redraw && al_event_queue_is_empty(event_queue))
        {
            for(auto i : Particles)
                i->Draw();

            al_draw_textf(myFont, al_map_rgb(0,200,0), 0, 10, NULL, "Mouse X: %i", mouseX);
            al_draw_textf(myFont, al_map_rgb(0,200,0), 0, 30, NULL, "Mouse Y: %i", mouseY);
            al_draw_textf(myFont, al_map_rgb(0,200,0), 0, 60, NULL, "Particle Count: %i", particleCount);

            al_flip_display();
            al_clear_to_color(al_map_rgb(0,0,0));
            redraw = false;
        } 
    }

    al_destroy_display(display);
    al_destroy_event_queue(event_queue);
    al_destroy_timer(myTimer);
    for(auto i : Particles)
        delete i;
    Particles.clear();

    return 0;
} 
```

是的，代码很糟糕。似乎我对 C++ 背后的理论了解比实际实现它更多。但我猜我正在学习。

问题：

有人说我不能多次调用“新”和“删除”，因为这非常糟糕。

粒子的创建受到计时器的限制——我不能/不知道如何制作它，所以我可以控制粒子创建的速度。

我不希望有人为我创造，如果我可以阅读一些东西来帮助我理解或有人发布一些代码来学习/让我思考，那将很有用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T17:39:31.787

您的粒子生成确实受到您的计时器的限制。您是在告诉 Allegro，如果在触发计时器事件时按下鼠标按钮，则生成一个粒子。您可以通过在每个计时器滴答声中创建多个粒子来提高粒子创建速率。

```
 for(int i = 0; i < rate; rate++)
    {
            randNum = (std::rand()+1 * ev.timer.count) % 50;
            std::cout << randNum << std::endl;

            if(mouseHold)
            {
                Particle* particle = new Particle(mouseX + randNum, mouseY + randNum);
                Particles.push_back(particle);
            }
    } 
```

然后只需使用可变速率来控制生成粒子的“速度”。这样做的缺点是绘制具有相同原始 X 和 Y 位置的多个粒子，但由于您还使用了 randNum，所以应该没问题。

另一种选择可能更适合您的需求，具体取决于这些粒子正在做什么，它是使用计时器以更快的速度滴答作响来生成粒子。当您检查 ALLEGRO_EVENT_TIMER 时

```
if(ev.timer.source == timer)
{
    redraw = true;
}
if (ev.timer.source == fasterTimer)
{
    randNum = (std::rand()+1 * ev.timer.count) % 50;
    std::cout << randNum << std::endl;

    if(mouseHold)
    {
        Particle* particle = new Particle(mouseX + randNum, mouseY + randNum);
        Particles.push_back(particle);
    }
} 
```

# java - 如何持久化 Http Session

> ID：16173692
> 
> 赞同：1
> 
> 时间：2013-04-23T15:44:45.420
> 
> 标签：java, tomcat, xstream, serializable

我有带有 Spring MVC 和 Webflow 的 Web 应用程序。我正在实现“快照”机制：开发人员通过 URL 中的特殊参数可以保存他们当前的状态（页面、组件状态等），然后在将来回到这个状态。

状态存储在他们的磁盘中。为了实现这一点，我需要存储整个 HttpSession - 不幸的是，并非所有对象都被序列化。我使用 XStream，但它会生成巨大的 XML (300MB)，这会使我的 tomcat 在反序列化期间崩溃。

您能否建议其他库或使用未实现可序列化的对象序列化/保存 http 会话的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:02:23.367

第一种方法 - 为需要序列化的对象创建中间“会话 DTO”层。所有“会话 DTO”都将是可序列化的，并且仅用于序列化会话。显然，这意味着相当多的代码会将属性从会话 DTO 对象复制到应用程序中使用的真实对象，但是有大量的属性对象复制器。

第二种方法 - 创建将所有对象及其属性存储为键值对的 Java 映射（每个对象将是另一个映射，可以嵌入到另一个映射中）。然后该地图将被序列化。显然，将映射结构复制到应用程序中使用的实际对象会涉及很多工作。这或多或少是“基于 JSON 格式的手工制作 Java 地图”。

第三种方法 - 尝试使用 JSON 而不是 XML，解析应该减少资源消耗。我会从那个开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T17:14:56.023

您可以查看[memcached-session-manager](https://github.com/magro/memcached-session-manager)的不同序列化策略。

# c++ - 检测 C++ Windows 应用程序中的内存泄漏

> ID：16173703
> 
> 赞同：1
> 
> 时间：2013-04-23T15:45:08.483
> 
> 标签：c++, windows

我有一个 C++ windows 应用程序，它有一些内存泄漏问题。是否可以使用 NTSD 分析转储中的内存泄漏？如果是这样，请指导我如何做到这一点？

我还听说我们可以使用用户模式转储来做到这一点。我对在 Windows 中发现泄漏不是很熟悉。在 Linux 中使用 Valgrind 非常容易。

有没有其他更好的选择来检查这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:09:44.667

[有关 Visual Leak Detector 的详细信息，请参见此处](http://vld.codeplex.com/)。我在 Windows 上使用过它。你在申请中所做的就是

```
#include <vld.h> 
```

调试程序时，您将在终端中看到有关检测到泄漏的报告，如下所示：

```
---------- Block 1199 at 0x04BE1058: 136 bytes ----------
Call Stack:
d:\Foobar\FooLog.cpp (26): FooLog::getInstance
d:\Foobar\FooMain.cpp (75): FooMain::init
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (578): __tmainCRTStartup
f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c (403): WinMainCRTStartup
0x759A3677 (File and line number not available): BaseThreadInitThunk
0x770C9D42 (File and line number not available): RtlInitializeExceptionChain
0x770C9D15 (File and line number not available): RtlInitializeExceptionChain
Data:
9C 33 2D 6B    74 2A 2D 6B    C8 11 BE 04    00 00 00 00     .3-kt*-k ........
00 00 00 00    70 14 BB 6C    70 14 BB 6C    00 00 00 00     ....p..l p..l....
00 00 00 00    68 14 BB 6C    68 14 BB 6C    00 00 00 00     ....h..l h..l....
00 00 00 00    6C 14 BB 6C    6C 14 BB 6C    20 12 BE 04     ....l..l l..l....
00 00 00 00    CD 00 CD CD    00 00 00 00    01 CD CD CD     ........ ........
68 14 BB 6C    78 33 2D 6B    00 00 00 00    00 00 00 00     h..lx3-k ........ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:50:15.280

[我使用DrMemory](http://www.drmemory.org/)追踪内存和资源泄漏取得了巨大成功。它适用于 GCC 和 MSVC，使用起来非常简单。

# android - Android - 活动完成（）时位图会自动回收吗？

> ID：16173704
> 
> 赞同：3
> 
> 时间：2013-04-23T15:45:10.730
> 
> 标签：android, bitmap, android-memory

活动时位图会自动回收`finish()`吗？

还是我们必须调用`recycle()`位图`onDestroy()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:58:38.500

在 Pre Android 3.0 中你需要`recycle`它，因为位图存储在`native heap`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:51:00.217

只要您没有通过任何仍然存在的对象引用它们：它们会被 GC 收集垃圾，而无需进一步交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:09:39.103

在 Pre-honeycomb 设备上

*   在 Dalvik 堆上分配的位图对象引用
*   存储在 Native 层的像素信息
*   `recycle()`或`finalizer()`需要恢复记忆

在 Post honeycomb 上，它的标准就像任何 java 对象一样

# facebook - 让朋友的 Facebook 签到到一个地方

> ID：16173706
> 
> 赞同：0
> 
> 时间：2013-04-23T15:45:18.770
> 
> 标签：facebook, facebook-graph-api, facebook-checkins

我试图**找出我的哪些朋友以前去过[巴黎](https://www.facebook.com/pages/Paris/110774245616525)**。我正在尝试使用 Graph API 来执行此操作。

所以基本上有地点 ID（对于巴黎，它是*110774245616525*），我可以使用端点**[https://graph.facebook.com/110774245616525/](https://graph.facebook.com/110774245616525/)**来获取基本信息。然后，我获得了一个具有 friends_status 和 user_status 权限的 access_token（使用[Graph Explorer](https://developers.facebook.com/tools/explorer/?method=GET&path=110774245616525/checkins)），并且我正在使用这个访问令牌来获取签到。所以我正在做一个**GET [https://graph.facebook.com/110774245616525/checkins?access_token=my_access_token](https://graph.facebook.com/110774245616525/checkins?access_token=my_access_token)**调用，我得到的只是这个错误消息：

> page_id 不是签入表的成员

虽然，阅读[文档](https://developers.facebook.com/docs/reference/api/page/)我看到了与 checkins 的联系：

> 当前用户和当前用户的朋友对该地点页面的签到。

这是 Graph API 的错误还是我的方式错误？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:57:42.410

在 7 月发布的[https://developers.facebook.com/roadmap/](https://developers.facebook.com/roadmap/)中对签入进行了重大更改，它提到将 page_id 重命名为 target_id，因此这可能是导致它的原因。但是，以下 fql 查询可能是您的起点

```
 select author_uid from checkin where target_id = 110774245616525 
```

author_uid 应该是签入[https://developers.facebook.com/docs/reference/fql/checkin的人](https://developers.facebook.com/docs/reference/fql/checkin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:35:37.497

我得到了以下 fql 来显示在特定位置签到的所有朋友的姓名。只在 Graph API Explorer 中尝试过，它相当慢：/ 如果它有帮助，请告诉我：)
从用户中选择名称，其中 uid 在（从签入中选择 author_uid where author_uid in（从朋友那里选择 uid2，其中 uid1=me()）和 target_id=110774245616525)

附加说明：我注意到我的许多朋友出现在“访问过法国巴黎的朋友”框中，但他们没有任何实际的签到。我认为该框还会检查您的朋友是否有任何来自巴黎的照片..只是一个想法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T17:22:59.090

在 asifrc 和 TommyBs 的帮助下，我找到了一种使用以下查询在 FQL 中执行此操作的方法：

```
SELECT name 
  FROM user 
 WHERE uid IN (
       SELECT author_uid 
         FROM location_post 
        WHERE distance(latitude, longitude, "48.856614", "2.3522219") < 5000 
          AND author_uid IN (SELECT uid2 FROM friend WHERE uid1=me())) 
```

它几乎让我所有的朋友都在巴黎市中心附近搜索他们所有的帖子，然后得到他们的名字。

如果有人知道如何在 Graph API 中执行此操作，请告诉我，因为我认为依赖 FQL 仍然不是一个好主意。

# azure - 从 Azure 下载 BLOB

> ID：16173710
> 
> 赞同：1
> 
> 时间：2013-04-23T15:45:29.907
> 
> 标签：azure, azure-blob-storage

从 Azure 存储下载大型 BLOB 的最佳方式和最佳实践是什么？

*   我想使用共享访问签名或共享访问策略来制作 BLOB 的**本地副本**。

*   估计的 BLOB 大小为 500 MB 到 1 GB

*   互联网连接从 250Kb 到 4Mb 不等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-02T12:02:17.607

如果是 REST API，请使用[HTTP 请求标头](http://www.vic.ms/microsoft/windows-azure/windows-azure-blob-storage-resuming-and-progressive-downloads-support/)

对于 .NET 的存储客户端库，请使用[DownloadRangeToStream](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.windowsazure.storage.blob.cloudblockblob.downloadrangetostream.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T17:50:01.920

最好的方法取决于你的情况。是否有特定原因阻止您不按照以下内容（Java 代码）做某事？我见过这样的例子，但有兴趣了解为什么你认为它可能不适合你。

```
 public class SASread 
{
    public static void main(String[] args) throws URISyntaxException, FileNotFoundException, StorageException, IOException 
    {                       
    URI baseuri = new URI("http://greengrass.blob.core.windows.net");
    CloudBlobClient blobclient = new CloudBlobClient(baseuri);
    MyDownloadBlob("container1",
           "sr=c&sv=2012-02-12&sig=ADsFalIpE1XkaneQpWwtpM3AhY%2BAwiUtbbo1ANbIoJA%3D&si=r",
           blobclient);         
    }

    public static void MyDownloadBlob(String containerName, String containerSAS, CloudBlobClient blobClient) throws URISyntaxException, StorageException, FileNotFoundException, IOException
    {   
    String blobName = "image3.jpg";  
    String localFileName = "c:\\myoutputimages\\image3.jpg";  
    URI uri = new URI(blobClient.getEndpoint().toString() + "/" +
                      containerName + "/" + 
                      blobName + 
                      "?" + 
                      containerSAS);   
    CloudBlockBlob sasBlob = new CloudBlockBlob(uri, blobClient);   
    File fileTarget = new File(localFileName); 
    sasBlob.download(new FileOutputStream(fileTarget));
    System.out.println("The blob at:\n"  + uri + "\nwas downloaded from the cloud to local file:\n" + localFileName);   
    }
} 
```

# ios - 禁用 UIImagePickerController 的自动旋转

> ID：16173719
> 
> 赞同：1
> 
> 时间：2013-04-23T15:45:41.860
> 
> 标签：ios, uiimagepickercontroller, autorotate

我想禁用 UIImagePickerView 的自动旋转。所以我使用了以下代码：

```
UIDevice *currentDevice = [UIDevice currentDevice];

        [parentViewController presentViewController:imagePicker animated:YES completion:nil];

        while ([currentDevice isGeneratingDeviceOrientationNotifications])
            [currentDevice endGeneratingDeviceOrientationNotifications]; 
```

它禁用了 ImagePickerView，但它也禁用了根视图的旋转。但我想要我的根视图控制器中的自动旋转功能（或者我只想在我的 ImagePickerController 中禁用自动旋转）。为了澄清起见，在禁用 UIImagePickerController 自动旋转之前，自动旋转在我的根视图中处于活动状态。

**更新和回答::**

我找到了答案。编写以下代码以启用自动旋转：

```
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications]; 
```

如果您有任何图像处理（实际上我有），请在完成所有图像处理任务后调用此方法。就我而言，我在图像处理之前调用了它，但它没有启用方向。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-04-24T09:04:22.363

我就是这样做的。UIImageViewController 是一个 UIViewController，它有一个名为 -(BOOL)shouldAutorotate 的方法；

我们可以做的是创建一个 UIImageViewController 的 SubClass 并重写 shouldAutorotate 方法。假设我们的子类名称是 MyImageViewController。

然后 MyImageViewController.h 看起来像 -

```
#import <UIKit/UIKit.h>

@interface MyImageViewController : UIImagePickerController

@end 
```

MyImageViewController.m 文件应该看起来像 -

```
#import "MyImagePickerViewController.h"

@interface MyImagePickerViewController ()

@end

@implementation MyImagePickerViewController

- (void)viewDidLoad {
    [super viewDidLoad];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
}

-(BOOL)shouldAutorotate{
    return NO;
}
@end 
```

现在我们可以走了！我们可以在 parentViewController 中创建 MyImagePickerViewController，而不是创建 UIImagePickerViewController，例如 -

```
MyImagePickerViewController *imagePicker = [[MyImagePickerViewController alloc] init];
[parentViewController presentViewController:imagePicker animated:YES completion:nil]; 
```

当您将 shouldAutoRotate 设置为 NO 时，它不会自动旋转；

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-06-22T14:46:56.027

**尝试这个 ：**

```
@interface UIImagePickerController(addition)

@end
@implementation UIImagePickerController(addition)

-(BOOL)shouldAutorotate{
    return NO;
}

@end 
```

# c - C中动态数组和指针的问题

> ID：16173723
> 
> 赞同：1
> 
> 时间：2013-04-23T15:45:44.090
> 
> 标签：c, arrays, pointers, malloc

我想从 STDIN 读取以下行并将值保存在 c 中：

```
A:2
B:3
C:AAAA1
C:AASC2
C:aade3
D:1
D:199 
```

这是我的c程序：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include <time.h>
#include <sys/time.h>

int main(int argc, char **argv)
{

    char buf[BUFSIZ];
    short a = 0;
    short b = 0;
    short anzb=0;
    short anza=0;
    char *c
    short *d;

    short i;

    while (fgets(buf, BUFSIZ, stdin) != NULL)
    {
        if (buf[strlen(buf)-1] == '\n') {
            char *isa = strstr(buf, "A:");
            char *isb = strstr(buf, "B:");
            char *isc = strstr(buf, "C:");
            char *isd = strstr(buf, "D:");
            if(isa){
                char *sep = substring(isa,3,strlen(isa));
                a = atoi(sep);
                d = malloc(a * sizeof(short));
            }else if(isb){
                char *sep = substring(isb,3,strlen(isb));
                b = atoi(sep);
                c = malloc(b * sizeof(char));
            }else if(isc){
                char *sep = substring(isc,3,strlen(isc));
                c[anzc] = sep;
                anzc++;
            }else if(isd){
                char *sep = substring(isd,3,strlen(isd));
                d[anzd] = sep;
                anzd++;
            }
        }
    }

    printf("%i\n", a);
    printf("%i\n", b);

    for(i=0; i<=anzc-1;i++){
        printf("%c", c[i]);
    }

    return 0;
} 
```

我是c新手，所以我对指针和数组知之甚少，所以我希望你能帮助我。

在值 A: 和 B: 被读取并存储在 a 和 bi 之后，可以为 c 和 d 的行创建我的数组。我认为这是我的问题。我不知道此时如何在我的程序中创建一个数组。我尝试了 malloc 和其他东西，但我的知识很少。

如果我已经读取了 c 和 d（A 和 B）的值（大小），我只想创建一个数组。

然后我想将值保存在数组中。

我希望你能帮助我修复我的代码。这一天我尝试了很多，但没有任何效果，我现在非常无助。

编辑：

我得到分段错误的新尝试 11：

```
 else if(isb){
        char *sep = substring(isb,8,strlen(isb));
        b = atoi(sep);
        c = malloc(b * sizeof(char*));
        int i;
        for (i = 0; i < subst; i++)
        {
          c[i] = malloc(13);
        }
    }else if(isc){
        char *sep = substring(isc,8,strlen(isc));
        strcpy(c[anzc], &buf[3]);
        anzc++;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:54:42.017

您的分配或多或少是正确的，但是您忽略了一些细节。B 为您提供值 3，即 C 的条目数，而不是每个条目的长度。然后，当您实际上需要一个应该是类型的二维数组时，您分配了一个数组，`char*`该数组将指向其他 3 个数组，这些数组将包含 C 行上的每个值。所以;

这条线`c = malloc(b * sizeof(char));`需要`c = malloc(b * sizeof(char*));` 然后你需要做；

```
 int i;
 for (i = 0; i < b; i++)
 {
     c[i] = malloc(length); // where length is some arbitrary buffer length
     // because you have no way of knowing the length of the individual strings.
 } 
```

在此之后，您可以使用`strcpy`将这些行复制到您在 for 循环中分配的每个 char 数组中。

因此，要完成副本，您需要执行以下操作；

```
 int iC = 0;
         // outside of the while loop we need a control var track the index
         // of the c array. it needs to work independent of the normal iteration.
         //inside the while loop
         else if(isc){
            strcpy(c[iC], &buf[3]) 
            iC++;
        } 
```

# php - 清理/转义用户输入和输出

> ID：16173724
> 
> 赞同：1
> 
> 时间：2013-04-23T15:45:48.880
> 
> 标签：php, mysql, input, output

我知道我已经[问](https://stackoverflow.com/questions/16134260/do-i-sanitize-escape-correctly)过一个关于消毒和逃生的问题，但我有一个问题没有得到回答。

好的，就到这里。如果我有一个 PHP 脚本并且我`GET`的用户输入和`SELECT`它来自一个 mySQL 数据库，如果我没有逃避`<`并`>`通过使用其中一个`htmlspecialchars`，`htmlentities`或者`strip_tags`因此允许 HTML 标记成为从数据库中选择/搜索？因为输入已经通过使用`trim()`,`mysql_real_escape_string`和`addcslashes`(\%_) 进行了清理。

使用的问题`htmlspecialchars`是它转义了＆符号（＆），用户输入应该允许（我猜这同样适用于`htmlentities`？）。使用 时，“ **John**`strip_tags` ”之类的东西会导致 PHP 脚本为 John 选择和显示结果，这是不应该的。

 **这是我在从数据库中选择之前对输入进行清理的 PHP 代码：

```
if(isset($_GET['query'])) {
  if(strlen(trim($_GET['query'])) >= 3) {
      $search = mysql_real_escape_string(addcslashes(trim($_GET['search']), '\%_'));
      $sql = "SELECT name, age, address WHERE name LIKE '%".$search."%'";
      [...]
  }
} 
```

这是我用于显示“x 匹配 y 结果”的输出。

```
echo htmlspecialchars(strip_tags($_GET['search']), ENT_QUOTES, 'UTF-8')." matched y results."; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:52:55.853

解决这个问题的一个好方法是使用 MySQLi，它使用准备好的语句，基本上为您在后端转义所有内容，并提供强大的 SQL 注入保护。不转义 GET 数据与不转义任何其他输入一样危险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:04:43.093

您已经确定了两个不同的问题。

**SQL 语句中的用户数据**

无论何时构建查询，您都需要绝对确定不会出现任意用户数据。这些错误称为[SQL 注入错误](http://bobby-tables.com/)，是未能正确转义数据的结果。作为一般规则，您永远不应该使用字符串连接来组成查询。尽可能使用[占位符](http://bobby-tables.com/php)来确保您的数据被正确转义。

**HTML 文档中的用户数据**

当您呈现包含用户提交内容的页面时，您需要对其进行转义，以便用户无法引入任意 HTML 标记或脚本元素。这是避免[XSS 问题](https://en.wikipedia.org/wiki/Cross-site_scripting)，意味着字符喜欢`&`并且`<`不会被错误地解释。“x < y”的用户数据最终不会破坏您的页面。

对于将用户数据渲染到的任何上下文，您总是需要转义。还有其他的，比如在脚本标签中或在 URL 中，但这是最常见的两个。**

# c# - 如何根据 ASP.NET C# 中服务器端的条件克隆 WebControls？

> ID：16173725
> 
> 赞同：0
> 
> 时间：2013-04-23T15:45:51.483
> 
> 标签：c#, html, asp.net, html-table, clone

我有以下 aspx 和 cs

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="cardPrintingBarcode.aspx.cs" Inherits="Reports_cardPrintingBarcode" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
    <head id="Head1" runat="server">
        <title>
            Impresión de Tarjeta
        </title>

        <style type="text/css">
            .style2
            {
                font-size: xx-small;
            }
        </style>
    </head>

    <body>
        <form id="form1" runat="server">
            <div id="Card">
                <table>
                    <tr>
                        <td width="85px" align="center" valign="bottom">
                            <image ID="imgBarcode" Width="85px" Height="20px" />
                            <br />

                            <label ID="lblCardcode" Font-Bold="True" Font-Names="Arial" Font-Size="5pt" >
                            </label>
                        </td>

                        <td width="30px" />

                        <td width="40px" align="center" valign="bottom">
                            <label ID="lblCN" Font-Bold="True" Font-Names="Arial" Font-Size="7pt">
                            </label>

                            <br />
                            <image ID="imgQR" Width="37px" Height="37px" />
                        </td>
                    </tr>
                </table>
            </div>
        </form>
    </body>
</html>

using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Collections.Generic;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using ClubCard.Core;

public partial class Reports_cardPrintingBarcode : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (ViewState["CHECKED_CARDS_ITEMS"] != null)
        {
            if (((List<int>)ViewState["CHECKED_CARDS_ITEMS"]).Count > 0)
            {
                LoadCards();
            }

            else
            {
                this.Response.Redirect("~/default.aspx");
                //GET ME OUT OF HERE
            }
        }
    }

    private void LoadCards()
    {
        List<int> lstIdCards = (List<int>)ViewState["CHECKED_CARDS_ITEMS"];

        foreach (int intIdCard in lstIdCards)
        {
            //Process Where I Want To Assign Data To 2 Labels and 2 images
            ClubCard.Core.Card card = new ClubCard.Core.Card(intIdCard);
            ClubCard.Core.Client client = new ClubCard.Core.Client(card.idClient);
            Byte[] bcQR = QR.GetQRByteArray(card.cardCode);
            string strBase64 = Convert.ToBase64String(bcQR, 0, bcQR.Length);

            //lblCN.Text = client.number;
            //lblCardCode.Text = card.number;
            //imgBarcode.ImageUrl = "SOME URL";
            //imgQR.ImageUrl = "SOME URL";

            //PROBABLY HERE'S WHERE I HAVE TO CREATE ALL WEBCONTROLS...
            //THEN WHEN THE FOREACH STARTS AGAIN, CREATE ANOTHER ONE...
        }
    }
} 
```

这里的重点是创建在 aspx 中看到的表的次数与 (List)ViewState["CHECKED_CARDS_ITEMS"]).Count 一样多。

例如...如果 (List)ViewState["CHECKED_CARDS_ITEMS"]).Count = 5，那么我想查看表格及其所有内容 5 次（显然，每个都会不同，因为我分配的服务器端不同数据到每个，因此，使用 foreach）

如何克隆那些 WebControls？我听说我不能在这些控件上使用 runat="server" （但是我不确定在这个例子中是否可以工作），其他一些消息来源声称它应该在一个 div 内，并克隆 div。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:52:01.950

您可能需要一个 ListControl 例如`<asp:DataList />`等`<asp:GridView`。

创建您的卡片列表

```
List<ClubCard.Core.Card> cards = new List<ClubCard.Core.Card>();
//cards.Add(...some cards...);
//cards.Add(...some cards...);
//cards.Add(...some cards...); 
```

将您的列表绑定到 ListControl

```
cardListControl.DataSource = cards;
cardListControl.DataBind(); 
```

用 DataList 实现它：

```
<asp:DataList runat="server" ID="cardListControl">
<ItemTemplate>
    <!-- Layout to display card here -->
    <img src='<%# Eval("CardImageUrl")>' />
    <span><%# Eval("CardName") %></span>
    <!-- other card information -->
</ItemTemplate>
</asp:DataList> 
```

DataList 有一个`RepeatDirection`属性，可让您水平或垂直显示卡片

# python - 平均多个numpy数组时的总和不正确

> ID：16173728
> 
> 赞同：2
> 
> 时间：2013-04-23T15:45:59.007
> 
> 标签：python, numpy, netcdf

我正在尝试从多个 numpy 数组中创建元素的平均值并对其进行数组。将两个数组加在一起（使用`numpy.add()`或通过广播`a1 + a2`）时，生成的总和似乎不正确。

**代码**

```
from netCDF4 import Dataset
import numpy
import os

data_dir = /my_data/
data_files = np.asarray(os.listdir(data_dir))
dataset = Dataset(os.path.join(data_dir,data_files[0]),'r')
vals_sum = np.zeros_like(dataset.variables["vals"][:][:])

for data_file in data_files:
    current_file = os.path.join(data_dir,data_file)
    dataset = Dataset(current_file,'r')
    vals = dataset.variables["vals"][:][:]

    print '1: sum', np.sum(vals)
    print '1: total sum', np.sum(vals_sum)

    vals_sum = np.add(vals, vals_sum)

    print '2: sum', np.sum(vals)
    print '2: total sum', np.sum(vals_sum)
    print '\n' 
```

**输出**（目录中有两个数据文件）

```
1: sum 29231.2
1: total sum 0.0
2: sum 29231.2
2: total sum 8249.65

1: sum 25840.5
1: total sum 8249.65
2: sum 25840.5
2: total sum 7055.33 
```

我希望对于第一个文件，第一个数组的总和和运行总和应该相同。两个数据集中都没有负值，那怎么可能呢？

**更新 1：** 在尝试之后`vals = np.copy(dataset.variables["vals"])`，它似乎已将缺失值传输为`-999`，而其他初始化数组的方法并未发生这种情况。但是，它仍然产生不正确的总和：

```
1: sum -9.24455e+08
1: total sum 0.0
2: sum -9.24455e+08
2: total sum -8.10467e+07

1: sum -9.31734e+08
1: total sum -8.10467e+07
2: sum -9.31734e+08
2: total sum -1.57788e+08 
```

**更新 2：** Soooo ......当 netCDF 数据集中缺少值时，它似乎会`netCDF4`自动创建一个掩码的 numpy 数组。执行 a 时`np.zeros_like()`，将复制掩码值。这意味着我从我的第一个数据文件创建的零数组，尽管它具有相同数量的元素，但会使用该文件缺少数据的掩码创建。当掩码数组加在一起时，它们的掩码也会加在一起，这将给出不同的总和。

```
import numpy.ma as ma
import numpy as np

x = np.array([1,5,7,-999,45,2,-999])
y = np.array([-999,89,-999,80,34,31,1])
mx = ma.masked_less(x,0)
my = ma.masked_less(y,0)
x0 = np.zeros_like(mx)
np.sum(my) # yields 235
np.sum(my+x0) # yields 154 
```

现在的问题是，

## 您如何有效地为给定的文件/日期范围创建累积掩码，而无需处理两次初始化所有数据？

# curl - 在 Fiddler 上使用 cURL 会有什么好处？

> ID：16173730
> 
> 赞同：4
> 
> 时间：2013-04-23T15:46:01.113
> 
> 标签：curl, fiddler

我对 Fiddler 非常熟悉，但没有使用过 cURL，我想知道是否有人可以指出使用 cURL 而不是 fiddler 来测试 Web 请求的特定优势。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:35:51.230

CURL 和 Fiddler 完全不同。cURL 纯粹是一个命令行工具，它可以在 Mac 和 Linux 以及 Windows 上运行。

Fiddler 是一个基于 GUI 的工具，仅当它在 Windows 上运行并且这些客户端指向 Fiddler 时，它才能自动化和调试*来自Mac/Linux 的流量。*

# svg - 通过使用 SVG 和 d3 展开来将圆转换为线

> ID：16173731
> 
> 赞同：3
> 
> 时间：2013-04-23T15:46:02.470
> 
> 标签：svg, d3.js

对于一个项目，我们试图在它沿着线性路径旋转时将一个圆圈变成一条线（然后再返回），就像轮胎在道路上滚动时旋转和平移，或者卷曲的食指伸展并重新卷曲成手掌。

在这个[Fiddle](http://jsfiddle.net/chrisfrisina/cHXZZ/)中，我有一个静态 SVG（顶部圆圈），它沿着 HTML 中定义的线性黑色路径（在圆圈上方，模仿手指延伸）旋转。

我还使用 d3 生成一个由连接点组成的“圆圈”（如果您单击/在圆圈中可以展开，感谢@ChrisJamesC [here](https://stackoverflow.com/questions/16120949/transition-between-a-circle-and-a-line-with-d3)），并在您单击时在函数 moveAlongLine 中平移和旋转紫线：

```
function moveAlongLine() {
  circle.data([lineData])
  .attr("transform", "translate(78.5,0) rotate(-90, 257.08 70) ")
  .duration(1000)
  circle.on("click", transitionToCircle)
} 
```

第一个问题是`.duration(1000)`无法识别并`Uncaught TypeError: Object [object Array] has no method 'duration'`在控制台中抛出a，因此SVG中的静态定义和JS/D3中的动态设置之间存在差异`dur`，但这是次要的。

另一个是变换属性是否应该像在静态循环中那样相互抽象？在静态圆中，平移是一个动画，旋转是另一个，它们只是具有相同的星号和持续时间，因此它们一起动画。您将如何在 d3 中同时应用两者？

我无法得到的挑战是如何让它向上展开（并重新回滚），静态点是圆的顶部中心，也与线上最左边的点相同。

这些似乎更好：

*   我应该尝试在旋转的同时发生展开动画吗？这似乎需要逐步/基于顺序......
*   或者考虑一个八边形（定义为路径），如果它要旋转 7 个边，然后是 6 个，然后是 5.... 对多面体上的大量点执行此操作？（圆圈只需要大约 50 个像素左右，所以 100 个点就足够了）这是小提琴中的中间示例。也许以编程方式执行此操作？
*   或者这让我想到了一种不同的方式：（在八角形的情况下），我可以有 8 条线路径（没有 Z，只是一个额外的关闭点），并在它们之间转换？就像这个[小提琴](http://jsfiddle.net/chrisfrisina/PafRU/)
*   或者与关键帧有关的任何事情？我在 Synfig 中制作了动画，但不确定是否可以将其用于 SVG。如果您可以转换为 SVG，则synfig 文件位于[http://specialorange.org/filedrop/unroll.sifz ，但](http://specialorange.org/filedrop/unroll.sifz)[此处](http://linkmauve.fr/dev/synfig/sif2svg/)的 xsl 文件无法正确转换为我使用`xsltproc`.

这看起来很复杂但很有潜力：

*   定义点遵循的路径（可能是具有相同数量参考点的贝塞尔曲线），并让参考点也动态平移...有关概念示例，请参见[this](http://www.jasondavies.com/animated-bezier/)

这看起来既复杂又笨重：

*   做一个真正的圆圈滚动，前面有一个不断增长的面具，同时一条线的长度也在增长

几点注意事项：

*   d3 圆中的点数可以在 JS 中调整，目前设置得较低，以便您可以在渲染中看到一点点来验证是否发生了旋转（很像渐变在顶部圆中） .
*   这是为了帮助学生学习在数轴和圆之间守恒的内容，特别是帮助学习分数。对于概念应用，请查看[compthink.cs.vt.edu:3000](http://compthink.cs.vt.edu:3000)以查看我们的原型，这将有助于切换表示，帮助您获得更好的想法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T04:55:05.340

我最终使用了与问题中生成圆圈相同的函数，并做了一些思考，似乎我想要一个看起来像手指展开的动画，就像这个[小提琴](http://jsfiddle.net/chrisfrisina/PafRU/)一样。[这使我想到了在这个小提琴](http://jsfiddle.net/chrisfrisina/6sYAY/)中实现它所需的数学和想法。

答案是一个数组数组，每个嵌套数组都是处于不同状态的一条线，然后通过在点之间进行插值来进行动画处理。

```
var circleStates = [];
for (i=0; i<totalPoints; i++){
    //circle portion
    var circleState = $.map(Array(numberOfPoints), function (d, j) {
      var x = marginleft + radius + lineDivision*i + radius * Math.sin(2 * j * Math.PI / (numberOfPoints - 1));
      var y =  margintop + radius - radius * Math.cos(2 * j * Math.PI / (numberOfPoints - 1));
      return { x: x, y: y};
    })
    circleState.splice(numberOfPoints-i);
    //line portion
    var lineState = $.map(Array(numberOfPoints), function (d, j) {
      var x = marginleft + radius + lineDivision*j;
      var y =  margintop;
      return { x: x, y: y};
    })
    lineState.splice(i);
    //together
    var individualState = lineState.concat(circleState);
    circleStates.push(individualState);
} 
```

和动画

```
function all() {
    for(i=0; i<numberOfPoints; i++){
      circle.data([circleStates[i]])
        .transition()
        .delay(dur*i)
        .duration(dur)
        .ease("linear")
        .attr('d', pathFunction)            
    }
}
function reverse() {
    for(i=0; i<numberOfPoints; i++){
      circle.data([circleStates[numberOfPoints-1-i]])
        .transition()
        .delay(dur*i)
        .duration(dur)
        .ease("linear")
        .attr('d', pathFunction)            
     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T17:58:32.797

（注意：这应该在注释中但没有足够的间距）

1.  **圆形动画** 尝试 SO 的[径向擦除](https://stackoverflow.com/questions/15591614/svg-radial-wipe-animation-using-css3-js)。需要调整它，使角度从 180 开始并在同一位置结束（线#4-6,19）并在每次交互时沿 X 轴（线#11）移动。更改`<path...`属性以适合您的口味。
2.  **线动画**从单点到圆的长度（周长）增长一条线。
3.  同步两个动画，使其在所有浏览器上看起来都很好（很头疼！）。

# proxy - Apache 如何为同一代理上的多个客户端处理保持活动连接？

> ID：16173737
> 
> 赞同：4
> 
> 时间：2013-04-23T15:46:17.293
> 
> 标签：proxy, apache2, keep-alive, persistent-connection

我正在处理性能问题，并且无法围绕 Apache keep-alive 连接解决问题。我了解 Apache 能够为多个请求维护 TCP 连接，但我不知道客户端代理如何影响该连接。我的公司通过代理汇集所有流量，以便我们的请求都使用一系列 IP 地址中的一个到达服务器。对于不同请求的多个用户，这些 IP 可能相同。

Apache 如何保持保持连接？是基于IP地址吗？

如果我的代理正在重用 IP 地址，当不同的客户端被分配相同的 IP 时，持久连接是否可以从客户端传递到客户端？

如果我们有几十个 IP 被代理使用，它们是否都会保持持久连接并最终损害性能？

我希望有关于这个主题的文档我可以查阅，但到目前为止我发现的所有内容都解释了保持活动连接尝试做什么，而没有太多解释它们如何实现这些目标。

谢谢

# c# - 如何在包含 LINQ 表达式中使用属性访问器 LINQ 表达式中的值？

> ID：16173740
> 
> 赞同：0
> 
> 时间：2013-04-23T15:46:22.220
> 
> 标签：c#, linq, linq-expressions

我目前有一个用于访问对象属性的属性访问器的 LINQ 表达式。我现在需要构建一个 LINQ 表达式，该表达式将评估谓词以查看属性访问器的结果是否包含在列表中。

我已经看到，在大多数情况下，这种事情是使用 Expression 上的静态方法完成的，但是没有 Contains 或 In 可用作 Expression 上的静态方法，所以我不确定如何继续。

```
// A data object
internal class PersonDAL
{
    public int Age ( get; set; }
}

// A business object
public class Person
{
    private PersonDAL root { get; set; }

    public static Expression<Func<PersonDAL, int>> AgeExpression
    {
        get
        {
            return (root) => (root.Age);
        }
    }
} 
```

现在我希望能够检查 AgeExpression 的值是否包含在年龄列表中。通常这就像编写一个表达式来查看值列表是否包含我要检查的值，但我看不到如何将表达式的结果作为要搜索的值输入。

为了澄清一点，我试图弄清楚如何获取具有所有 Persons 的可查询对象，并仅获取未知表达式基于另一个表达式的值评估为 true 的 Persons。在我的示例案例中，未知访问器表达式正在查看一个人的年龄，它需要能够评估它是否包含在另一个可接受的年龄列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:03:16.557

我不确定你为什么要使用表达式。我看不出你从他们那里得到了什么。但是如果修改了`AgeExpression`to be的签名，就`Expression<Func<PersonDAL, int>>`可以编译执行：

```
void Main()
{
    var pDal = new PersonDAL { Age = 3 };

    var ageFunc = Person.AgeExpression.Compile();
    var age = ageFunc(pDal);
    // age is 3
}

// Define other methods and classes here

// A data object
public class PersonDAL
{
    public int Age { get; set; }
}

// A business object
public class Person
{
    public Person(PersonDAL dal)
    {
        this.dal = dal;
    }

    private PersonDAL dal { get; set; }

    public static Expression<Func<PersonDAL, int>> AgeExpression
    {
        get
        {
            return (root) => (root.Age);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:52:49.850

这种问题也困扰了我很多..请记住，您可以在 LINQ/lambda 表达式中访问局部变量：所以一个简单的`.where(x => x.value == AgeExpression)`应该指向正确的方向

# bash - 使用 awk 逐一处理 CSV 项目

> ID：16173741
> 
> 赞同：1
> 
> 时间：2013-04-23T15:46:24.297
> 
> 标签：bash, csv, awk

使用以下脚本访问 CSV 项目。

```
#!/bin/bash
awk -F "|" 'NR > 0 {print $1}' UserAgents.csv 
```

运行脚本时，我得到了正确的输出，即 CSV 的第一个“列”中的整个值集都打印到终端。我想添加的是一个一个地读取这些项目并对它们执行一些操作，比如将它与一个字符串连接起来，然后将它们一个一个地输出（到文件、管道或终端）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:24:26.157

这应该清楚您的 awk 脚本在做什么：

```
awk -F '|' '{
   print NR, NF, $1, "with some trailing text"
}' UserAgents.csv 
```

# javascript - 如何通过拖放更改表单的值？

> ID：16173744
> 
> 赞同：0
> 
> 时间：2013-04-23T15:46:32.490
> 
> 标签：javascript, jquery, drag-and-drop

我的网络应用程序中有一个拖放功能，如下所示。我正在尝试将拖入#contributors div 的项目放入名为personalassessment_set3 的文本框中，但我无法这样做。有什么建议吗？

形式

```
<p>
    <label for="personalassessment_set3">Set3</label><br />
    <input id="personalassessment_set3" name="personalassessment[set3]" type="text" />
</p>

<input type="button" value="Set Value" onclick="$('#personalassessment_set3').val( $('#contributors').val() )" /> 
```

拖放

```
<script>
function dragUser(user, event) {
    event.dataTransfer.setData('User', user.id);
}
function dropUser(target, event) {
    var user = event.dataTransfer.getData('User');
    target.appendChild(document.getElementById(user));
}
</script>

<section id="user-levels">
    <div id="unassigned" ondrop="dropUser(this, event)" ondragenter="return false" ondragover="return false">

        <a draggable="true" class="user" id="leonardo" ondragstart="dragUser(this, event)">Compensation</a>
        <a draggable="true" class="user" id="raphael" ondragstart="dragUser(this, event)">Benefits</a>

    </div>

    <div id="contributors" ondrop="dropUser(this, event)" ondragenter="return false" ondragover="return false">
        Ranking
    </div>
    <div class="clear"></div>
</section> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:52:25.900

您正在滥用不接受任何基于 jquery 的方法或包装对象的 onclick。你应该试试这个：

```
<input id="test" type="button" value="Set Value" />
<script>
   $(function(){
       $('#test').on('click',function(){
          $('#personalassessment_set3').val( $('#contributors').val() )
       });
   });
</script> 
```

# ios - 重新排列 UITableView 时如何更新视图的内容？

> ID：16173746
> 
> 赞同：1
> 
> 时间：2013-04-23T15:46:33.540
> 
> 标签：ios, objective-c, uitableview

这是我想要完成的事情的简要说明：

*   主要`UIViewController`是一个`UITableViewController`
*   点击一个单元格将用户带到一个新的`UIViewController`地方，他们可以在其中输入文本并保存它
*   用户可以预览保存在另一个上的所有文本`UIViewController`
*   当用户在 Main 中重新排列表格时`UIViewController`，用户可以在 Preview 中看到更改

重新排列 后如何更改/移动预览上的文本`UIViewController`？`UITableViewController`

非常感谢任何一般方法、提示、教程、示例！

谢谢！

编辑，这是我的代码：

单例.h

```
 #import <Foundation/Foundation.h>

 @interface MyInformation : NSObject
 {
     NSMutableArray * informationArray;
     NSMutableString * nameString;
     NSMutableString * jobString;
 }

 @property (nonatomic, retain) NSMutableArray * informationArray;
 @property (nonatomic, retain) NSMutableString * nameString;
 @property (nonatomic, retain) NSMutableString * jobString;

 + (id)sharedInformation;

 @end 
```

单例.m

```
 #import "MyInformation.h"

 @implementation MyInformation

 static MyInformation * _sharedMyInformation = nil;

 @synthesize informationArray = _informationArray;
 @synthesize nameString = _nameString;
 @synthesize jobString = _jobString;

 #pragma mark Singleton Methods

 + (id)sharedInformation
 {
     @synchronized(self)
     {
         if (_sharedMyInformation == nil)
         {
             _sharedMyInformation = [[self alloc] init];
         }   
     }
     return _sharedMyInformation;
 }

 - (id)init
 {
     if (self = [super init])
     {
         _nameString = [[NSMutableString alloc] init];
         _jobString = [[NSMutableString alloc] init];
         _informationArray = [[NSMutableArray alloc] initWithObjects:_nameString, _jobString, nil];

     }
     return self;
 }

 @end 
```

视图控制器.m

```
 - (void)viewDidLoad
 {
     [super viewDidLoad];

     if ([[UIScreen mainScreen] bounds].size.height == 568)
     {
         self.aTableView = [[UITableView alloc] initWithFrame:CGRectMake(0, 0, 320, 1136) style:UITableViewStyleGrouped];
         self.aTableView.delegate = self;
         self.aTableView.dataSource = self;
         [self.view addSubview:self.aTableView];

         self.editBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Edit" style:UIBarButtonItemStylePlain target:self action:@selector(editButtonTapped)];
         self.navigationItem.rightBarButtonItem = self.editBarButtonItem;
     }
 }

 - (void)viewWillAppear:(BOOL)animated
 {
     [super viewWillAppear:animated];

     [self.aTableView reloadData];
 }

 - (void)editButtonTapped
 {
      if (self.editing)
      {
          [super setEditing:NO animated:NO];
          [self.aTableView setEditing:NO animated:NO];
          [self.aTableView reloadData];
          [self.editBarButtonItem setTitle:@"Edit"];
          [self.navigationItem.rightBarButtonItem setStyle:UIBarButtonItemStylePlain];
       }
       else
       {
          [super setEditing:YES animated:YES];
          [self.aTableView setEditing:YES animated:YES];
          [self.aTableView reloadData];
          [self.editBarButtonItem setTitle:@"Done"];
          [self.editBarButtonItem setStyle:UIBarButtonItemStyleDone];
       }
   }

  - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
  {
      return 2;
  }

  - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
  {
      MyInformation * myInformation = [MyInformation sharedInformation];
      int count = [myInformation.informationArray count];

      if (section == 0)
      {
          return count;
      }
      else if (section == 1)
      {
          return 1;
      }

      return count;
  }

  - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
  {
      static NSString * CellIdentifier = @"CellIdentifier";

     UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

      if (cell == nil)
      {
          cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
      }

     MyInformation * myInformation = [MyInformation sharedInformation];

     if (indexPath.section == 0 && indexPath.row == 0)
     {
         cell.textLabel.text = [NSString stringWithFormat:@"%@", myInformation.nameString];
         cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
     }

     if (indexPath.section == 0 && indexPath.row == 1)
     {
         cell.textLabel.text = [NSString stringWithFormat:@"%@", myInformation.jobString];
         cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
     }

     if (indexPath.section == 1 && indexPath.row == 0)
     {
         cell.textLabel.text = @"Preview";
         cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
     }

     return cell;
 }

 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
 {
     [tableView deselectRowAtIndexPath:indexPath animated:YES];

      if (indexPath.section == 0 && indexPath.row == 0)
      {
         NameViewController * name = [[NameViewController alloc] initWithNibName:@"NameViewController" bundle:nil];
         [self.navigationController pushViewController:name animated:YES];
      }

     if (indexPath.section == 0 && indexPath.row == 1)
     {
         JobViewController * job = [[JobViewController alloc] initWithNibName:@"JobViewController" bundle:nil];
         [self.navigationController pushViewController:job animated:YES];    
     }

     if (indexPath.section == 1 && indexPath.row == 0)
     {
         PreviewViewController * preview = [[PreviewViewController alloc] initWithNibName:@"PreviewViewController" bundle:nil];
          [self.navigationController pushViewController:preview animated:YES];
    }
 }

 - (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath
 {
     MyInformation * myInformation = [MyInformation sharedInformation];

     NSString * item = [myInformation.informationArray objectAtIndex:sourceIndexPath.row];
     [myInformation.informationArray removeObjectAtIndex:sourceIndexPath.row];
     [myInformation.informationArray insertObject:item atIndex:destinationIndexPath.row];
 }

 - (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
 {
     if (indexPath.section == 0 )
     {
         return YES;
     }   
     else
     {
         return NO;  
     }
 }
 @end 
```

编辑2：

我不相信我的阵列正在更新。

这是我的保存代码的示例：

```
 - (IBAction)saveButtonTapped
 {
     MyInformation * myInformation = [MyInformation sharedInformation];

     if (_nameTextField.text == nil)
     {
         myInformation.nameString = @"";
     } 
     else
     {
         [myInformation.nameString setString:@""];
         [myInformation.nameString appendFormat:@"%@", _nameTextField.text];
     }

     [self.navigationController popToRootViewControllerAnimated:YES];
 } 
```

在此日志中，nameString 确实会更新为我输入并保存的任何文本。

但是我的 informationArray 总是返回为 ("", "")

编辑 3 和 4：

使用设置的字符对单例中的字符串进行硬编码。

现在我可以重新安排我的桌子，这很好。

以下是更新后的代码。当我重新排列表格时，预览页面上的标签会重新排列。

这是代码：

```
 - (void)viewDidLoad
 {
     [super viewDidLoad];

     MyInformation * myInformation = [MyInformation sharedInformation];

     _nameLabel = [[UILabel alloc] init];
     _nameLabel.frame = CGRectMake(20, 20, 300, 44);
     _nameLabel.text = [NSString stringWithFormat:@"%@", [myInformation.informationArray objectAtIndex:0]];

     _jobLabel = [[UILabel alloc] init];
     _jobLabel.frame = CGRectMake(50, 50, 300, 44);
     _jobLabel.text = [NSString stringWithFormat:@"%@", [myInformation.informationArray objectAtIndex:1]];

     [self.view addSubview:_nameLabel];
     [self.view addSubview:_jobLabel];
 } 
```

编辑 5：

剩下要做的唯一事情是如何更新单例和 UITableViewCells 中的字符串中的文本？

编辑 6：

我解决了这个问题。我不得不将 Singleton 中的字符串更改为 NSMutableStrings。我修改了我的保存按钮代码以将字符串设置为空值并将其附加到文本字段文本中。在此之后，它现在按预期工作！

感谢您的帮助和建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T18:16:44.543

我假设您有支持`NSMutableArray`，但答案应该推广到任何数据存储方案。

1.  用于[`tableView:moveRowAtIndexPath:toIndexPath:`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/UITableViewDataSource/tableView%3amoveRowAtIndexPath%3atoIndexPath%3a)检测用户何时重新排序第一个表并通过删除对象`fromIndexPath.row`并将其插入到来更新支持数组`toIndexPath.row`。这可以确保您的支持模型准确地反映用户刚刚在 UI 中所做的更改。

2.  当用户移动到预览视图时，该视图要么需要从同一个共享数据源（我们在 #1 中修改的那个）中提取，要么得到刚刚重新排列的数组的副本。后一种情况更简单，可以通过`NSArray`在预览控制器上添加一个属性来完成：`@property(nonatomic, copy) NSArray *itemsToPreview`. 然后确保预览控制器使用该数组而不是原始数组。

[Apple 关于重新排序表视图的文档](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/ManageReorderRow/ManageReorderRow.html)是一个很好的资源。

# c# - Mvvmcross 支持 NotifyPropertyChanged 事件，其中事件参数包含旧值？

> ID：16173747
> 
> 赞同：0
> 
> 时间：2013-04-23T15:46:35.477
> 
> 标签：c#, mvvmcross

有一个 UIHealthBar 绑定到从 5 更改为 10 的 viewmodel 属性。我想用填充颜色从旧值 (5) 到新值 (10) 对其进行动画处理。我怎样才能用更好的方法在 mvvmcross 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:58:29.987

这听起来像是可以用一对视图模型属性来完成——也许是一个总是一起改变的元组——例如

```
public class MyViewModel : MvxViewModel
{
    public MyViewModel()
    {
        // subscribe for health updates here
    }

    public class HealthTuple
    {
        public double Old {get;set;}
        public double New {get;set;}
    }

    private HealthTuple _health; 
    public HealthTuple Health 
    {
       get { return _health; }
       set { _health = value; RaisePropertyChanged(() => Health); }
    } 

    private void OnNewHealth(HealthMessage message)
    {
        Health = new HealthTuple() { Old = _health.New, New = message.Value };
    }
} 
```

您的自定义 UIView -`UIHealthBar`然后可以公开单个属性或两个属性，您可以将它们绑定到 ViewModel 的 Health 值。绘制/动画显示然后是“正常的 UI 工具包工作”

# javascript - 有没有办法限制节点的 --trace 选项的输出？

> ID：16173748
> 
> 赞同：1
> 
> 时间：2013-04-23T15:46:37.063
> 
> 标签：javascript, node.js, debugging, v8, trace

节点有这个很好的选择：

--trace（跟踪函数调用）

它为您提供了大量关于程序运行方式的确切输出。

当你有一个错误导致节点在没有任何堆栈跟踪的情况下崩溃时，这个选项将在它死之前向你显示堆栈跟踪。

当我的程序启动后发生错误时，它对我很有用。我得到了大约 5 分钟的输出，然后是错误。

但是现在我有一个错误，除非我对我的应用程序进行压力测试，使 --trace 选项生成方式太多的输出，否则该错误不会显示。即使我将输出通过管道传输到文件或 grep 也无济于事。由于它正在执行的所有 IO，Node 需要很长时间才能达到我的错误。从所有 IO 中发现我的错误实际上需要几天（几个月？）。

有没有办法限制 --trace 输出并在它崩溃时只在最后获取堆栈跟踪？

# ios - 如何填充 Quartz 2D 中路径下方的区域？

> ID：16173749
> 
> 赞同：4
> 
> 时间：2013-04-23T15:46:42.393
> 
> 标签：ios, quartz-2d, fill, area, bezier

我在 UIView 对象中使用 Quartz 2D 来绘制多条曲线，如下例所示：

![使用 Quartz 2D 和 <code>CGContextStrokePath</code> 绘制的两条曲线](https://i.stack.imgur.com/TmEmM.png)

这是我现在的代码（我省略了控制点和其他东西的计算）：

```
for (int i = 1; i < points.count; ++i) {
  CGContextMoveToPoint(context, previousXValue, previousYValue);
  CGContextAddCurveToPoint(context,
    firstControlPointXValue, firstControlPointYValue,
    secondControlPointXValue, secondControlPointYValue,
    xValue, yValue
  );

  // CGContextFillPath(context);
  CGContextStrokePath(context);
} 
```

现在我想填充曲线下方的区域，但如果我使用`CGContextFillPath`结果如下：

![使用 Quartz 2D 和 <code>CGContextFillPath</code> 填充两条曲线](https://i.stack.imgur.com/NTyKo.png)

这是有道理的，因为根据[Quartz 2D 文档](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_paths/dq_paths.html)：

> *当您填充当前路径时，Quartz 就像路径中包含的每个子路径都已关闭一样。然后它使用这些封闭的子路径并计算要填充的像素。*

然后我尝试将路径移动到右下角并关闭路径，但是填充方法没有任何效果：

```
CGContextMoveToPoint(context, rect.size.width, rect.size.height);
CGContextClosePath(context);
CGContextFillPath(context); 
```

如何填充曲线下方的整个区域，而不仅仅是每个子路径中封闭的子区域？

### 编辑：

我找到了一个临时解决方案：在每个子路径上使用曲线和两条垂直线绘制形状：

```
for (int i = 1; i < points.count; ++i) {
  // Draw the curve
  CGContextMoveToPoint(context, previousXValue, previousYValue);
  CGContextAddCurveToPoint(context,
    firstControlPointXValue, firstControlPointYValue,
    secondControlPointXValue, secondControlPointYValue,
    xValue, yValue
  );
  CGContextStrokePath(context);

  // Draw a shape using curve's initial and final points
  CGContextMoveToPoint(context, previousXValue, rect.size.height);
  CGContextAddLineToPoint(context, previousXValue, previousYValue);
  CGContextAddCurveToPoint(context,
    firstControlPointXValue, firstControlPointYValue,
    secondControlPointXValue, secondControlPointYValue,
    xValue, yValue
  );
  CGContextAddLineToPoint(context, xValue, rect.size.height);
  CGContextFillPath(context);
} 
```

我不知道这是否矫枉过正，因此也欢迎改进。此外，我得到了这个结果：

![使用 Quartz 2D 绘制的两条曲线，并填充了它们下方的区域](https://i.stack.imgur.com/Ip7A8.png)

请注意，垂直线是由于绘制相邻的子区域而出现的。怎么能避免呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:47:06.727

这个想法是正确的，但您不应该填充单个曲线，而是创建一条路径然后填充它。所以，从`CGContextMoveToPoint`左下角开始，`CGContextAddLineToPoint`到你的第一个点，`CGContextAddCurveToPoint`对所有的曲线做一个，最后，`CGContextAddLineToPoint`对右下角做一个（你也可以做一个`CGContextClosePath`好的测量）。

这是一个简化的示例，其中我只有一个点数组，但它说明了这个想法：

```
- (void)drawRect:(CGRect)rect
{
    if (!self.points)
        [self configurePoints];

    DataPoint *point;

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGColorRef color = [[UIColor redColor] CGColor];
    CGContextSetStrokeColorWithColor(context, color);
    CGContextSetFillColorWithColor(context, color);

    point = self.points[0];

    CGContextMoveToPoint(context, point.x, self.bounds.size.height);
    CGContextAddLineToPoint(context, point.x, point.y);

    for (point in self.points)
    {
        // you'd do your CGContextAddCurveToPoint here; I'm just adding lines
        CGContextAddLineToPoint(context, point.x, point.y);
    }

    point = [self.points lastObject];
    CGContextAddLineToPoint(context, point.x, self.bounds.size.height);
    CGContextClosePath(context);

    CGContextDrawPath(context, kCGPathFillStroke);
} 
```

# asp.net - 需要在 asp.net 中设计网页的技巧

> ID：16173750
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:46:45.300
> 
> 标签：asp.net, html, user-interface

我在 asp.net/html 中的 UI 设计有点太糟糕了。我正在尝试使用 asp.net/html/visual studio 2012 构建一个新网站（只是为了恢复开发 UI 设计的技能）。我有带有母版页/css 的 UI，我正在使用 div 来获取元素到位（我在css宽度/高度中使用px）。当我的浏览器处于最大化视图时，一切看起来都很好。当我调整浏览器的大小时，页面中的所有内容都非常混乱，我什至没有在浏览器底部看到滚动条。

我检查了几个网站，发现我做错了什么。当您访问 amazon.com 并调整浏览器大小时，它不会乱码，一切都保持原位。我怎么能得到那个？我究竟做错了什么？请指教。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:55:54.677

听起来您有未清除的浮动元素。[您（](http://css-tricks.com/all-about-floats/)也许）可以通过使用`clear`.

由于您缺乏经验，因此使用样板文件可能会更好地为您服务，这将为您提供一个很好的框架来构建。这里有一些：

1.  [ASP.NET MVC4 的 HTML5 样板](http://nuget.org/packages/Html5Boilerplate.Mvc4.Razor/)
2.  [用于 ASP.NET MVC4 的 Twitter 引导程序](http://nuget.org/packages/twitter.bootstrap.mvc4/)
3.  [亚马逊](http://www.amazium.co.uk/)
4.  [或者只是在NuGet](http://nuget.org/)上搜索“引导程序”

# c++ - 具有智能数组对象的类

> ID：16173757
> 
> 赞同：0
> 
> 时间：2013-04-23T15:47:04.753
> 
> 标签：c++, arrays, class

所以我有以下课程：

```
class smartA
{
public:

int *p;
int size;

smartA(){size=10; p = new int [size];}
smartA (int x){size=x; p = new int [x];}
smartA(int y[], int x ){size=x; p = new int [x]; for (int i=0 ; i<x ; i++) p[i]=y[i];}
smartA(const smartA &a) {*this=a;}
~smartA(){delete [] p;}

void displayA()
{
for (int i=0; i<size; i++)
{   cout<<setw(4)<<p[i];
if (((i+1)%5)==0 && i!=0)
cout<<endl;}
    cout<<endl<<endl;
}

void setsmartA(const int a[], int sizea) 
{size=sizea; p = new int[size]; for (int i=0 ; i<size ; i++) p[i]=a[i];}

}; 
```

如何编写将两个智能数组对象合并为第三个智能数组对象的函数。我无法访问每个智能数组的元素，因为它必须是动态数组。

例如，添加以下成员函数会给我一个错误：

```
smartA add(smartA a)
{
smartA c(a.size+size);

int i=0;
for ( ; i<a.size ;i++)
c.p[i]=a.p[i];

for (int j=0; j<a.size+size; j++, i++)
c.p[i]=p[j];

return c;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:07:15.597

> 如何编写将两个智能数组对象合并为第三个智能数组对象的函数。[...]添加以下成员函数给我一个错误。

除非在类定义中内联，否则`smartA add(smartA a)`应该是`smartA smartA::add(smartA const& a)`. 这是因为否则`add`将被视为类外的通用函数。`add`请注意，传递引用而不是副本是有意义的。

`operator+`此外，在数组的上下文中，重载而不是调用方法是有意义的`add`。因此，您可能希望在以下位置实现`add`：

```
friend smartA smartA::operator+(smartA const&, smartA const&); 
```

最后，您的复制构造函数中有一个非常**大的问题：**

```
smartA(const smartA &a) {*this=a;} 
```

这可能会导致[*混叠*](http://en.wikipedia.org/wiki/Aliasing_%28computing%29)并导致崩溃或内存问题。你想看看*深拷贝*和[*三法则*](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:54:38.897

通过引用`friend`函数传递参数。按值返回。

```
class smartA
{
  int *p;
  int size;

public:
....
  friend smartA operator+ (const SmartA& sa1, const SmartA& sa2);
};

smartA operator+ (const SmartA& sa1, const SmartA& sa2)
{
  SmartA res(sa1.size + sa2.size);

  for(int i = 0; i < sa1.size; i++)
    res.p[i] = sa1.p[i];

  for(int i = sa1.size, j = 0; i < sa1.size + sa2.size; i++, j++)
    res.p[i] = sa2.p[j];

  return res;
} 
```

与您的代码片段不同，我将成员设为私有。最好从封装信息开始并在需要时公开它，而不是相反。

此外，您不必将函数变为`operator+`，或者为此添加好友。我只是喜欢它提供的对称性。（以及与类型转换无缝工作的运算符的灵活性`smartA`，你应该添加这些）。

# database - 带有子菜单的 DB 中的经典 asp 构建菜单

> ID：16173758
> 
> 赞同：0
> 
> 时间：2013-04-23T15:47:04.857
> 
> 标签：database, asp-classic, menu, submenu

嗨，我完全迷路了，我有一个使用用户安全级别自行创建的菜单

但是我不知道如何显示子菜单我的桌子上有一个 parentid 但不知道如何在代码中实现有人可以帮助我输入我的模板代码

```
Dim CurrentSecLev                   'security level of the requested menu item
Dim MenuLink                        'filename or url of the menu item
Dim MenuText                        'display text of the menu item

'build sql query string, open database, and execute the query
strSQL = "SELECT * FROM dbo.tblMenus where mnuParentID = 0 ORDER BY mnuOrder"
objConn.Open
set objResults=objConn.Execute(strsql)

'loop through the records and build the menu
do while not objResults.eof
CurrentSecLev=objResults("mnuSecLev")
MenuLink=objResults("mnuLink")
MenuText=objResults("mnuText")

'check to ensure that the users security level meets or exceeds the required
'security level of the current menu item.  This ensures that only authorized
'users see certain menu items, such as 'Site Admin'.
if MySecLev => CurrentSecLev then
    response.write "<li><a href='" & MenuLink & "'>" & MenuText & "</a></li>" & vbcrlf
        end if
'rock on
objResults.Movenext
Loop

'close and destroy the recordset, close the database.
objResults.Close
set objResults=Nothing
objConn.Close

'check to see if the user is logged in.  if they are, display the logout
'option.  if they are not logged in, display the login option.
If LoggedIn="Yes" Then 
response.write "<li><a href='logout.asp'>Logout</a></li>" & vbcrlf
Else
response.write "<li><a href='login.asp'>Login</a></li>" & vbcrlf
End if
%></ul><Form Action="searchresults.asp" method=post id=form3 name=form3><p><input   name="searchquery" id="searchquery" size="10"/><input name="Submit" id="Submit" type="submit" value="Search!" /></p></form>
<p>&nbsp;</p>
<%
Dim rsArray 
Dim rs
objConn.Open
strSQL = "SELECT * FROM tblKBMain where title <> '' or [content] <> ''"
Set rs = objconn.execute(strSQL) 
if not rs.eof then 
rsArray = rs.GetRows() 
nr = UBound(rsArray, 2) + 1 
Response.write "<p>" & nr & " articles</p>" 
end if 
rs.close
set rs = nothing 
objConn.Close
%>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T20:17:27.787

好的，快速查看您的代码。但我只会为您提供子菜单的基本指南。

如果您使用的是子菜单，那么您需要在表中设置一个您已经拥有的 parentID。parentID 将等于其“父级”的 menuID。即，如果“文件”的 menuID 为 1，则“打开”的 parentID 为 1。所有顶级菜单的 parentID 为 0。

然后查询 parentID=0 的菜单表。

```
For each menu item, 
  you first display it,
  Then you do another query on the same table where parentID={the menuID of the item you just displayed},
  Then for each one of those, 
    you again display it.
    If you have 3 levels of menus, do yet another query for those.  
      ...  
    end loop of level 3  
  end loop of level 2  
end loop of level 1 
```

菜单项的显示因您使用的方法而异。大多数使用

```
<ul><li> 
```

谷歌搜索 CSS 菜单。

# git - 如何在没有结帐的情况下放弃分支？

> ID：16173761
> 
> 赞同：2
> 
> 时间：2013-04-23T15:47:08.143
> 
> 标签：git

我在一个分支上做了一些愚蠢的改变。

我可以删除分支，没问题。

但是我不能这样做。

所以，我不再想要这些变化了。

如果我**不这样做** `commit`，并且我`checkout`对我的“好分支”，修改后的引用将通过。

我不希望那样发生。

我怎样才能正确地删除和忽略这些更改？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:49:13.643

你可以做

```
git reset --hard 
```

它将还原对已修改文件的更改。

此外，如果您想删除所有未跟踪的文件和目录，请执行

```
git clean -fd 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:50:19.517

执行以下操作，以达到干净状态并删除您的分支：

```
git reset --hard # resets git staging and your tracked files to the last commit
git clean -fd    # deletes untracked files (this is optional)
git checkout master
git branch -D <branch to remove> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:49:25.490

跑

```
git checkout . 
```

然后切换到您想要的任何分支。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:52:08.047

您可以`git reset --hard`丢弃分支上的所有当前更改（如果您有未跟踪的文件，您也可以这样做`git clean -f`）。

之后，您可以使用`git checkout`任何其他分支，然后删除有问题的分支。（提交本身将在存储库中保留一段时间，但很难找到它们。）

# c# - 实体框架：Table Per Hierarchy 是适合这种情况的正确继承模式吗？

> ID：16173762
> 
> 赞同：0
> 
> 时间：2013-04-23T15:47:12.373
> 
> 标签：c#, entity-framework, entity-framework-4.1, table-per-hierarchy

想象一下，我有一个要存储在 Entity Framework 4.1 数据存储中的对象层次结构。我正在使用 Code First 创建它们。它们看起来像这样：

```
BasicState
  has many -> StatefulEntities
  has a -> CreationDate

ReceivedState 
  has a -> EntityLocation

ApprovedState
  has a -> EntityLocation

OrderedState
  has a -> Order

DispatchedState 
  has a -> Order
  has a -> DispatchNumber 
```

`BasicState`是所有其他状态的父级，其他所有状态共享这两个字段/关系。

我最初的想法以及我实现这一点的方式是使用 Table Per Hierarchy 继承，因为我似乎可以从`BasicState`这些公共属性继承并让我的其他状态参与其中。

然而，这导致了一个问题，因为当不同的状态共享一个字段时，底层数据模型不会，例如，我的数据库将来自`EntityLocation_Id`一个`ReceivedState`和另一个。这使得创建测试数据变得困难，因为您不知道哪些字段属于哪些模型。[我之前问过这个问题。](https://stackoverflow.com/questions/16103518/entity-framework-code-first-tph-inheritance-can-different-child-classes-share)`ApprovedState``EntityLocation_Id1`

我寻求的解决方案是这样的：

```
public abstract class BaseState
{
     public DateTime CreatedDate { get; set; }

     public ICollection<StatefulEntity> StatefulEntities{get;set;}
}

public abstract class LocationState : BaseState
{
     public Location EntityLocation { get; set; }
}

public class ReceivedState : LocationState
{

}

public class ApprovedState : LocationState
{

} 
```

这部分工作，但是尽管它创建了一个，但`EntityLocation_Id`它仍然`Order_Ids`为`OrderedState`and创建了两个`DispatchedState`，即使它们的行为方式相同并且实现无法区分。

几乎解决了一半，我现在遇到了另一个问题，这导致我问这个问题：

鉴于我 和 之间的关系`BasicState`在`StatefulEntities`两个方向上是多对多的，我需要能够`OrderedStates`从属于 a中找到订单详细信息`StatefulEntity`。

问题是，虽然这在 SQL 中很容易表示，但所涉及的继承意味着 Entity Framework 不知道任何给定是否`BasicState`为 an `OrderedState`，因此似乎无法单次访问数据库以包含`OrderedState.Order`.

所以我不能做的是这样的：

```
statefulEntityRepository.Get().Where( x => x.Id == 1 ).Include( x => x.BasicStates ).Include( x.BasicStates.Order ); 
```

显然，这不是可以运行的代码，但它显示了问题所在 - Order 仅属于的某些子类型，`BasicState`因此 EF 不会预加载它，即使我正在使用某种类型的演员表。

如果我尝试投影，我会得到这样的结果：

```
statefulEntityRepository.Get().Select( x=> new { 
             StatefulEntity = x,
             EntityLocation = ( from state in x.BaseStates where state is ReceivedState select state.EntityLocation )
          } 
```

但是，我需要找到从投影返回的匿名类型返回到我的 StatefulEntity 的方法，以便我的其余代码能够处理它，这感觉像是一个重要的长切。

我已经尝试这样定义我的基类和继承者：

```
public abstract class BaseState
{
     public DateTime CreatedDate { get; set; }

     public ICollection<StatefulEntity> StatefulEntities{get;set;}

     public long EntitytLocationId { get; set; }
}

public abstract class LocationState : BaseState
{
     [Column(name="EntityLocationId")]
     public Location EntityLocation { get; set; }
} 
```

依此类推，但我似乎打破了首先拥有 TPH 的基本点，我觉得我还不如在通用数据类上滚动我自己的对象模型。

编辑：我想我现在对此有了更多的了解-从尝试将 ForeignKey 设置在该关系的远端（即 Location 和 LocationState 之间的关系），它看起来好像 Order 或 Location 上的反向集合可以'不要与不在基础对象上的属性交谈，所以我必须使用上面的版本。这在我如何管理没有 EntityLocationId 或 OrderId 的案例时产生了一个新问题——如果我将这些字段设为可为空，则会引发一个错误，即在数据库创建期间引用字段不能为空，并且默认情况下无法在代码优先中的字段。

任何人都可以推荐一种更好的方法来表示可以与实体框架一起使用的这种类型的模型吗？

# graphviz - 使用graphvis绘制大图的最佳方法是什么

> ID：16173764
> 
> 赞同：1
> 
> 时间：2013-04-23T15:47:17.993
> 
> 标签：graphviz, graph-visualization, neato

我需要在图像上绘制大型数据集，我使用带有所有可用工具（dot、neato、twopi .. 等）的 graphvis 命令行，但结果不可读并且包含重叠。

我需要的是在边缘显示带有标签的节点，重叠最少，这样图形就可以阅读，也可以打印在 A4 或 A3 纸上。

我在neato 中使用了选项overlap=false、splines=true 和相同的重叠结果。

这是数据集：

```
graph {
    graph [ bgcolor=ivory2, overlap=false, splines=true, ranksep ="2.75"]
    {node [width=1,height=1,shape=circle,style=filled,color=skyblue] "ECNY" }
    edge [ len=2, sep=5] 
    "DANA" -- "HMRN" -- "ECNY" -- "NORI" -- "MAJZ" -- "RSFH" -- "DANA" [label ="LD1-25-A01",  penwidth =3 , color="#156163"]
    "DANA" -- "HMRN" -- "ECNY" -- "NORI" -- "MAJZ" -- "RSFH" -- "DANA" [label ="LD1-25-A02",  penwidth =3 , color="#30a1f9"]
    "DANA" -- "MAJZ" -- "ECNY" -- "HMRN" -- "DANA" [label ="LD1-25-A03",  penwidth =3 , color="#ec591d"]
    "DANA" -- "MAJZ" -- "ECNY" -- "HMRN" -- "DANA" [label ="LD1-25-A04",  penwidth =3 , color="#263a5f"]
    "DANA" -- "ECNY" -- "DANA" [label ="LD3-25-A02",  penwidth =3 , color="#a3517c"]
    "HMRN" -- "ECNY" -- "MAJZ" -- "DANA" -- "HMRN" [label ="LD1-25-H01",  penwidth =3 , color="#800d83"]
    "HMRN" -- "ECNY" -- "MAJZ" -- "DANA" -- "TWRN" -- "HMRN" [label ="LD1-25-H02",  penwidth =3 , color="#89e15a"]
    "HMRN" -- "ECNY" -- "MAJZ" -- "DANA" -- "TWRN" -- "HMRN" [label ="LD3-25-H03",  penwidth =3 , color="#74ed0e"]
    "HMRN" -- "ECNY" -- "HMRN" [label ="JED-10-H08",  penwidth =3 , color="#e8e786"]
    "HMRN" -- "ECNY" -- "MAJZ" -- "DANA" -- "HMRN" [label ="LD1-25-H04",  penwidth =3 , color="#e1f559"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-10-A02",  penwidth =3 , color="#8f7964"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-10-A03",  penwidth =3 , color="#9058f0"]
    "ECNY" -- "HMRN" -- "SBCB" -- "ECNY" [label ="JED-10-A04",  penwidth =3 , color="#b537b7"]
    "ECNY" -- "HMRN" -- "SBCB" -- "ECNY" [label ="JED-10-A05",  penwidth =3 , color="#fc2c2a"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-10-A06",  penwidth =3 , color="#36309c"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-10-A07",  penwidth =3 , color="#25a571"]
    "ECNY" -- "OBHR" -- "ECNY" [label ="JED-10-A26",  penwidth =3 , color="#1a6077"]
    "ECNY" -- "2820" -- "ECNY" [label ="JED-25-A03",  penwidth =3 , color="#8bce8c"]
    "ECNY" -- "2138" -- "2129" -- "ECNY" [label ="JED-25-A04",  penwidth =3 , color="#9b9afa"]
    "ECNY" -- "2017" -- "2013" -- "ECNY" [label ="JED-25-A05",  penwidth =3 , color="#5ea9aa"]
    "ECNY" -- "2027" -- "2128" -- "ECNY" [label ="JED-25-A22",  penwidth =3 , color="#c0c4d4"]
    "ECNY" -- "2130" -- "2137" -- "ECNY" [label ="JED-25-A27",  penwidth =3 , color="#781ce0"]
    "ECNY" -- "DANA" -- "ECNY" [label ="LD3-25-A01",  penwidth =3 , color="#fd5c5a"]
    "ECNY" -- "HMRN" -- "ZJ01" -- "ECNY" [label ="JED-10-H03",  penwidth =3 , color="#32e13b"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-10-H04",  penwidth =3 , color="#487f94"]
    "ECNY" -- "2341" -- "2235" -- "2233" -- "ECNY" [label ="JED-10-H05",  penwidth =3 , color="#82ae2d"]
    "ECNY" -- "HMRN" -- "SBCB" -- "ECNY" [label ="JED-10-H06",  penwidth =3 , color="#f4651c"]
    "ECNY" -- "HMRN" -- "SBCB" -- "ECNY" [label ="JED-10-H07",  penwidth =3 , color="#23dd41"]
    "ECNY" -- "HMRN" -- "OBHR" -- "ECNY" [label ="JED-10-H37",  penwidth =3 , color="#521f43"]
    "ECNY" -- "PROJECT" -- "ECNY" [label ="JED-10-H49",  penwidth =3 , color="#0a4bf1"]
    "ECNY" -- "2234" -- "2246" -- "2245" -- "2320" -- "ECNY" [label ="JED-25-H01",  penwidth =3 , color="#6127e4"]
    "ECNY" -- "2842" -- "2030" -- "ECNY" [label ="JED-25-H03",  penwidth =3 , color="#ce1f98"]
    "ECNY" -- "2170" -- "2166" -- "ECNY" [label ="JED-25-H06",  penwidth =3 , color="#aeb0ce"]
    "ECNY" -- "2158" -- "2144" -- "ECNY" [label ="JED-25-H11",  penwidth =3 , color="#9ef618"]
    "ECNY" -- "5824" -- "2011" -- "ECNY" [label ="JED-25-H15",  penwidth =3 , color="#b2d524"]
    "ECNY" -- "2010" -- "2830" -- "2198" -- "ECNY" [label ="JED-25-H16",  penwidth =3 , color="#53e7ae"]
    "ECNY" -- "2179" -- "ECNY" [label ="JED-25-H17",  penwidth =3 , color="#149169"]
    "ECNY" -- "2211" -- "ECNY" [label ="JED-25-H19",  penwidth =3 , color="#15a51b"]
    "ECNY" -- "2316" -- "ECNY" [label ="JED-25-H20",  penwidth =3 , color="#e91d18"]
    "ECNY" -- "2203" -- "ECNY" [label ="JED-25-H22",  penwidth =3 , color="#38a23a"]
    "ECNY" -- "SBCB" -- "JFCC" -- "ECNY" [label ="JED-25-H33",  penwidth =3 , color="#a1abf4"]
    "ECNY" -- "HMRN" -- "ECNY" [label ="JED-25-H41",  penwidth =3 , color="#c14ff8"]
    "ECNY" -- "TAIF" -- "SNFN" -- "NORI" -- "ECNY" [label ="LD1-10-H04",  penwidth =3 , color="#75fb4f"]
    "ECNY" -- "MAJZ" -- "DANA" -- "TWRN" -- "HMRN" -- "ECNY" [label ="LD1-25-H03",  penwidth =3 , color="#52d1c8"]
    "ECNY" -- "DANA" -- "ECNY" [label ="LD3-25-H01",  penwidth =3 , color="#498a16"]
    "ECNY" -- "DANA" -- "ECNY" [label ="LD3-25-H02",  penwidth =3 , color="#70f831"]
    "ECNY" -- "2310" -- "5880" -- "5301" -- "2248" -- "ECNY" [label ="JED-10-H17",  penwidth =3 , color="#ebb4e1"]
    "SBCB" -- "ECNY" -- "HMRN" -- "JELS" -- "ROMN" -- "OBHR" -- "SAFA" -- "SBCB" [label ="JED-W40-A01",  penwidth =3 , color="#7ff59c"]
    "SBCB" -- "SAFA" -- "OBHR" -- "HMRN" -- "ECNY" -- "SBCB" [label ="JED-10-H35",  penwidth =3 , color="#e817b9"]
    "2171" -- "ECNY" -- "2171" [label ="JED-10-H19",  penwidth =3 , color="#bf1252"]
    "ABHA" -- "ECNY" -- "DANA" -- "ABHA" [label ="LD3-10-H01",  penwidth =3 , color="#8b60ae"]
    "MAJZ" -- "ECNY" -- "DANA" -- "2510" -- "MAJZ" [label ="LD1-10-H02",  penwidth =3 , color="#1e3c55"]
    "2209" -- "2206" -- "ECNY" -- "2209" [label ="JED-25-H02",  penwidth =3 , color="#1b6092"]
    } 
```

这是使用这些选项时的输出之一（在neato中）：

> 图 [ bgcolor=ivory2，重叠=假，样条线=真，rankep =“2.75”]
> 
> {节点 [width=1,height=1,shape=circle,style=filled,color=skyblue] "ECNY" }
> 
> 边缘 [len=2, sep=5]

![在此处输入图像描述](https://i.stack.imgur.com/cNtxG.png)

当使重叠=缩放但图像仍然不可读时也是如此！

> 重叠=比例，sep=\"+25,25\"，样条线=true，rankdir=\"TB\"

![在此处输入图像描述](https://i.stack.imgur.com/BcJ1q.jpg)

那么还有哪些其他属性可以增强此图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-01T02:22:51.623

不可避免地，随着节点和边数的增加，我们最终将没有足够的空间来拥有一个紧凑但清晰的图。但是，我认为我们可以做一些事情来改善问题。在这种情况下，我们可以利用所有边序列形成返回“ECNY”的循环这一事实。

首先，我对更接近“ECNY”的边缘进行加权（使它们更具弹性）并在默认情况下使它们更长（使图形的中间更加分散），反之，与更远的边缘相反来自“ECNY”。

其次，我只标记了每个循环一次，标签位于循环中尽可能远离“ECNY”的边缘。

我使用 Python 脚本以编程方式进行了这些更改`adjweight.py`，如下所示：

```
import sys, re, math

for line in sys.stdin:
    line = line.rstrip()
    if re.match(' +"',line):
        loop, attr = line.split(" [")
        loopli = loop.split(" -- ")[1:] 
        # We take all but the first node, to eliminate repeats
        # then we put the list of edges together with "ECNY" first and last.
        i = loopli.index('"ECNY"')
        loopli = loopli[i:] + loopli[:i] + [loopli[i]]
        n = len(loopli)

        # Now we write the multi-edge lines as individual lines so that we can 
        # give each edge an individual weight and length

        for i in range(n-1):
            # We weight edges that are furthest from the center (i.e. those with 
            # numbers closest to n/2) highest and those that are closest to the
            # center are weighted lowest.
            wt = (n/2)/(abs(n/2 - (i+1))+1)
            edgelength = 1/wt
            if i - n//2 + 1 != 0:
                # This edge is the furthest from the center in this loop, so we 
                # label this edge (but not the other edges in the loop)
                attr = ",".join(attr.split(",")[1:])
            # We raise the weights and edge lengths to different powers to adjust
            # the distribution of nodes across the "diameter" of the graph
            print ("    %s -- %s [weight = %f, len = %f, %s" % (
                loopli[i],loopli[i+1],wt**3,edgelength**2,attr))
    else:
        print (line) 
```

...可以运行，问题中显示的文件在`python adjweight.py <large.dot >large3.dot`哪里。`large.dot``.dot`

将边缘的字体大小更改为 10（与默认值 14 相比）并运行`large3.dot`给`neato`我以下图表： ![在此处输入图像描述](https://i.stack.imgur.com/Z1RoL.jpg)

这使得节点在页面周围分布得更均匀，边缘标签也少了很多，所以这对我来说似乎是一种改进。边缘标签仍然与一些节点和（特别是在图的右上角）其他边缘标签重叠，因为该`overlap`参数仅影响节点和边缘线，而不影响边缘标签。

调整与“ECNY”的距离相关的边的相对长度和权重可能有助于进一步改进图形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-04T11:36:52.567

我需要可视化从某个节点到其他节点的所有路径，所以我关于可视化节点的问题不是简化。 **好吧** ，您已经可视化了从某个节点到其他节点的所有路径但是正如您所说的**结果不可读并且包含重叠**。我认为您需要的是使这个可视化清晰我的下一个建议是尝试使用（3维图）在小数据上手动可视化您的图表，然后对其进行编码或尝试找到属性以在 3d 上可视化它，如果它在小数据上运行良好数据。

我只是试着思考如何帮助解决这个问题，所以所有这些只是建议和开放式问题，让您找到问题的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T19:48:06.400

我建议使用具有流行的力导向布局算法（[http://en.wikipedia.org/wiki/Force-directed_graph_drawing](http://en.wikipedia.org/wiki/Force-directed_graph_drawing)）的软件/框架，其中最受欢迎的是 Fruchterman-Reingold 和 Kamada-Kawai。我在[igraph 包中使用了 R (](http://igraph.sourceforge.net/) [http://www.r-project.org/](http://www.r-project.org/) ) 。我知道这有点不回答你的问题，因为你说你使用的是 graphvis，但使用力导向算法是你最好的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-04T11:01:27.060

为什么你不首先尝试减少图表上的数据（即：即使你得到了实现 - 很难遵循图表）并且在图表上表示数据的主要思想是**简化**并且你会丢失它）所以我的建议尝试减少图表上的数据。

# css - 过滤器：progid:DXImageTransform.Microsoft.gradient CSS 属性在 IE 中不起作用

> ID：16173767
> 
> 赞同：0
> 
> 时间：2013-04-23T15:47:27.517
> 
> 标签：css, internet-explorer, twitter-bootstrap

`bootstrap`我正在为我们的导航栏使用 twitter 的css。当然，在 Chrome 和 Firefox 中一切看起来都很棒，但在 IE 中完全是废话。我很困惑，因为他们在 IE 中对渐变有正确的 css 过滤器命令，并且在做了一些研究之后，我发现 IE 偶尔会出现颜色代码不是 3 位十六进制的问题，所以我改变了一切仍然有同样的问题。

这是渐变的外观

铬合金

![在此处输入图像描述](https://i.stack.imgur.com/bpGeG.png)

和 IE

![在此处输入图像描述](https://i.stack.imgur.com/qorMC.png)

这是CSS

```
.navbar-inner {
  padding-left: 20px;
  padding-right: 20px;
  background-color: #36C;
  background-image: -moz-linear-gradient(top,       #33C, #69C);
  background-image: -ms-linear-gradient(top,    #33C, #69C);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from( #33C), to(#69C));
  background-image: -webkit-linear-gradient(top,    #33C, #69C);
  background-image: -o-linear-gradient(top,     #33C, #69C);
  background-image: linear-gradient(top,    #33C, #69C);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='    #33C', endColorstr='#69C', GradientType=0);
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25), inset 0 -1px 0 rgba(0, 0, 0, 0.1);
  -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25), inset 0 -1px 0 rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25), inset 0 -1px 0 rgba(0, 0, 0, 0.1);
}
.btn-navbar {
  display: none;
  float: right;
  padding: 7px 10px;
  margin-left: 5px;
  margin-right: 5px;
  background-color: #36C;
  background-image: -moz-linear-gradient(top,   #33C, #66C);
  background-image: -ms-linear-gradient(top,    #33C, #66C);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from( #33C), to(#66C));
  background-image: -webkit-linear-gradient(top,    #33C, #66C);
  background-image: -o-linear-gradient(top,     #33C, #66C);
  background-image: linear-gradient(top,    #33C, #66C);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='    #33C', endColorstr='#66C', GradientType=0);
  border-color: #66C #66C #000000;
  border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.075);
  -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.075);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1), 0 1px 0 rgba(255, 255, 255, 0.075);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:50:53.133

我相信渐变滤镜需要全`#AARRGGBB`彩色代码。就是`#33C`不行。试试`#003333CC`吧。如果结果是透明的，请尝试`#7F3333CC`-我永远记不起它的走向。

PS。试试IE10。却摆脱了`-ms-linear-gradient`自不存在以来，便直奔而去`linear-gradient`。

# asp.net-mvc-4 - ASP.NET 4.5 和 Web API 中的 URL 重写

> ID：16173771
> 
> 赞同：5
> 
> 时间：2013-04-23T15:47:39.023
> 
> 标签：asp.net-mvc-4, asp.net-mvc-routing, asp.net-web-api

我们有一个长期运行的 ASP.NET Web 表单应用程序，它诞生于 .NET 1.1/IIS6 时代。我们现在在 .NET4.5/IIS7 上，但我们没有对 MVC 做任何事情。

我们向客户提供目录并为他们提供可以使用的 URL：

```
www.ourhost.com/customername 
```

使用我们开发的自定义 IHttpModule，我们将“客户名”从 URL 中提取出来，以便在数据库中查找客户。该客户的 ID 然后存储在页面的上下文中*，并由站点上的几乎所有页面用于为该客户定制内容。在这个过程之后，上面的 URL 将被重写并处理为

```
www.ourhost.com/index.aspx 
```

index.aspx 可以通过其上下文访问客户的 ID，它可以做它的事情。

这很好用，我们支持数千名客户。重写逻辑相当复杂，因为它验证客户帐户，如果客户无效，则重定向到“哦”页面，如果客户没有付款，则重定向到不同的“查找经销商”页面，等等。

现在我想构建一些 Web API 控制器，而 MVC 风格的重写让我很担心。我看到许多示例，其中重写恰好使 URL 像这样工作：

```
www.ourhost.com/api/{controller} 
```

但我仍然需要在客户的上下文中发生这些 web api“调用”。我们的页面使用 JSON/AJAX 异步调用变得更加复杂，但在应答这些调用时，我仍然需要客户上下文。我希望网址是

```
www.ourhost.com/customername/api/{controller} 
```

但是对于如何配置路由来做到这一点并让它与我们的 IHttpModule 很好地配合，我感到很困惑。

这甚至可能吗？

*更新：当我说“存储在页面上下文中”时，我的意思是与每个 Web 请求相关联的 HttpContext，其中包括一个字典，我可以在其中存储一些页面/请求特定的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-16T22:25:11.943

我可以看到您的问题的答案有两个部分。

**跨多个请求维护用户信息** 通常，MVC API 应用程序将是无状态的，即您不保留请求之间的当前用户会话状态。嗯，这就是我在编写 RESTFul API 时学到或被多次宣扬的。

话虽如此，您可以通过将以下内容添加到 global.asax.cs 来启用 MVC Web API 中的会话状态

```
 protected void Application_PostAuthorizeRequest()
    {
        // To enable session state in the WebAPI.
        System.Web.HttpContext.Current.SetSessionStateBehavior(System.Web.SessionState.SessionStateBehavior.Required);
    } 
```

**在请求中授权客户** 正如您在请求 URL 中所示，您可以添加客户名称，然后捕获该名称并将其传递给当前 http 模块调用以根据请求进行授权的同一例程。您可以使用 MVC 过滤器来做到这一点。

首先做一个类似的 URL 模式来在 WebApiConfig.cs 中捕获您的客户名称，类似这样；

```
 config.Routes.MapHttpRoute(
            name: "WithCustomerApi",
            routeTemplate: "api/{customername}/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        ); 
```

然后将 ActionFilter 添加到您的 API 控制器，该控制器处理每个请求，检查当前会话信息，并在需要时调用您的授权/客户查找代码，然后保存到会话状态以供以后使用。或者如果客户没有好的信息可以发送到新的 MVC 路由

因此，您将添加一个类似这样的属性；

```
[WebApiAuthentication]
public class BaseApiController : ApiController
{
} 
```

然后创建一个可能看起来像这样的操作过滤器（注意我没有测试过这个，只是为了一个如何做的模式）。

```
public class WebApiAuthenticationAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var routeData = actionContext.ControllerContext.Request.GetRouteData();
        var currentContext = HttpContext.Current;

        if (routeData.Route.RouteTemplate.Contains("customername"))
        {
            try
            {
                var authenticated = currentContext.Request.IsAuthenticated;
                if (!authenticated)
                {
                    var customer = routeData.Values["customername"];
                    // do something with customer here and then put into session or cache
                    currentContext.Session.Add("CustomerName", customer);
                }
            }
            catch (Exception exception)
            {
                var error = exception.Message;
                // We dont like the request
                actionContext.Response = new HttpResponseMessage(HttpStatusCode.BadRequest);
            }
        }
        else
        {
            // No customer name specified, send bad request, not found, what have you ... you *could* potentially redirect but we are in API so it probably a service request rather than a user
            actionContext.Response = new HttpResponseMessage(HttpStatusCode.NotFound);
        }

    }
} 
```

如果您创建一个新的 MVC 5 Web API 应用程序并添加这些附加功能并将过滤器放在默认值控制器上，那么您应该能够看到它作为可能解决方案的演示运行。

如果一切正常，这将回显客户名称。

```
[WebApiAuthentication]
public class ValuesController : ApiController
{
    // GET api/values
    public IEnumerable<string> Get()
    {
        var session = HttpContext.Current.Session;

        if (session != null)
        {
            return new string[] {"session is present", "customer is", session["CustomerName"].ToString()};
        }

        return new string[] { "value1", "value2" };
    }

} 
```

正如我所说，我将其作为一种可能的解决方案提供，关于在 API 中存储会话和授权存在宗教争论，但这些不是问题所在。希望有帮助，史蒂夫

# javascript - 在 jquerymobile 中使用 data-rel="back" 时是否可以向我的 url 添加其他参数

> ID：16173775
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:00.167
> 
> 标签：javascript, jquery, navigation

我有一个带有按钮的页面，可将用户引导至上一页：

```
<div class="ui-block-b"><a data-role="button" data-rel="back">Cancel</a></div> 
```

这很好用，但是我还想在页面导航回后将此字符串附加到 url 的末尾（此字符串仅导航到该页面上的特定选项卡）：

```
"?tab=tab-messages" 
```

是否有任何类型的 jquery 函数可以用来附加它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:18:58.740

你可以尝试这样的事情（尽管它可能需要一些修补才能让它完全按照你的意愿工作）。这是未经测试的。

```
$(document).bind('pageshow', function() {
    $(body).on('click', '#id-of-back-button', function(){
      parent.history.back() + '?tab=tab-messages';
      return false;
  });
}); 
```

如果这不能引导您到任何地方，请参阅[如何在 JQuery Mobile 中更改页面时传递参数？](https://stackoverflow.com/questions/12058248/how-to-pass-parameters-while-changing-the-page-in-jquery-mobile/#answer-12059780)

这也可能有帮助：[Get param value from a URL in jquery mobile](https://stackoverflow.com/questions/11260792/get-param-value-from-a-url-in-jquery-mobile/#answer-11262942)

# javascript - turn.js 中的元素数量

> ID：16173778
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:05.607
> 
> 标签：javascript, jquery, turnjs

我有许多带有“附加”类的div。问题是当我使用插件 turn.js 时，函数 .size() 返回错误的结果 这是我的 HTML

```
 <div id="book">
            <div class="folhas" id="0"> 
                <div class="back_img" ></div>
                <div class='append' id="foto0"></div> 
                <div class="legenda_div" id="legenda0">
                    <textarea class='legenda'></textarea>
                </div>
            </div>
            <div class="folhas" id="1"> 
                <div class='append' id="foto2"></div>
                <div class="legenda_div">
                    <textarea class='legenda'></textarea>
                </div>
            </div>
            <div class="folhas" id="2"> 
                <img class="back_img_fixo" src="imagens/back1.png" width="100%"/>
                <div class='append' id="foto2"></div> 
                <div class="legenda_div">
                    <textarea class='legenda'></textarea>
                </div>
            </div>
            <div class="folhas" id="3">
                <img class="back_img_fixo" src="imagens/back2.png" />
                <div class='append' id="foto3"></div> 
                <div class="legenda_div">
                    <textarea class='legenda'></textarea>
                </div>
            </div>
            <div class="folhas" id="4">
                <div class="back_img" ></div>
                <div class='append' id="foto4"></div> 
                <div class="legenda_div">
                    <textarea class='legenda'></textarea>
                </div>
            </div>
            <div class="folhas" id="5">
                <div class="back_img" ></div>
                <div class='append' id="foto5"></div> 
                <div class='append' id="foto6"></div> 
                <div class='append' id="foto7"></div> 
                <div class='append' id="foto8"></div> 
                <div class='append' id="foto9"></div>                     
            </div>
            <div class="folhas" id="6">
                <div class="back_img" ></div>
                <div class='append' id="foto10"></div> 
                <div class='append' id="foto11"></div> 
            </div>
            <div class="folhas" id="7">
                <div class="back_img" ></div>
                <div class='append' id="foto12"></div> 
                <div class='append' id="foto13"></div> 
                <div class='append' id="foto14"></div> 
            </div>
            <div class="folhas" id="8">
                <div class="back_img" ></div>
                <div class='append' id="foto15"></div> 
                <div class='append' id="foto16"></div> 
                <div class='append' id="foto17"></div> 
                <div class='append' id="foto18"></div> 
            </div>
            <div class="folhas" id="9">
                <div class="back_img" ></div>
                <div class='append' id="foto19"></div> 
                <div class='append' id="foto20"></div>
            </div>
            <div class="folhas" id="10">
                <div class="back_img" ></div>
                <div class='append' id="foto21"></div>
            </div>
        </div> 
```

这是我的 js

```
$(window).load(function(){  

    alert($(".append").size());
    $('#book').turn({
        gradients: true, 
            acceleration: true
    }); 
    alert($(".append").size());

}) 
```

第一个警报给了我正确的答案，22。但第二个警报输出 10！当我需要与索引 10 以上的元素交互时，jquery 函数就不起作用

最大的问题是我无法操作 10 以上的 de DOM 元素！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:13:29.520

看看我设置的这个小提琴[http://jsfiddle.net/y8xaX/](http://jsfiddle.net/y8xaX/)

```
$( window ).load( function(){  

var item = $( '#book' ).find('.append');
var len  = item.length; 
alert(len);

$('#book').turn({
    gradients: true, 
        acceleration: true
}); 
alert(len);

}); 
```

# sql - 使用 wix 从远程位置将图像上传到 sql

> ID：16173779
> 
> 赞同：1
> 
> 时间：2013-04-23T15:48:07.493
> 
> 标签：sql, wix

我们计划将报表服务器上使用的图像移动到数据库中，因为目前我们必须在每个报表服务器上运行安装程序才能将图像添加到该服务器。但是我们的问题是安装程序也可能从远程位置运行（即不是将图像保存在数据库中的数据库服务器）。在这种情况下，Openrowset 将无法将我们的图像作为其上传到我们的本地服务器上，而 db 服务器是远程的。

有没有办法使用我们用 wix 编写的安装程序从另一台服务器上传图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:13:31.163

我最近在使用 BCP 时遇到了一个非常相似的问题。最后，我在安装目录上创建了一个共享：

```
<CustomAction Id="SetDatafileSharePath"
              Property="DATAFILE_SHARE"
              Value="\\[ComputerName]\DataLocation" />

<util:User Id="EveryoneUser"
           Name="Everyone" />

<util:FileShare Id="DataShare"
                Name="DataLocation"
                Description="Share of the datafiles.">
    <util:FileSharePermission Read="yes"
                              ReadAttributes="yes"
                              ReadPermission="yes"
                              CreateChild="yes"
                              CreateFile="yes"
                              GenericAll="yes"
                              User="EveryoneUser" />
  </util:FileShare> 
```

然后使用该`DATAFILE_SHARE`属性运行 BCP 命令。我遇到的最大问题是共享权限，因此您可能需要更改一些`FileSharePermission`设置才能让它为您工作。

如果没有太多图像并且它们不太可能更改，您可以使用的另一个选项是将它们插入到本地 sql 服务器，然后使用[SSMS 工具](http://www.ssmstoolspack.com/Features#GIS)的“生成插入脚本”功能来创建带有图像 blob 的 sql 插入作为base64字符串。不幸的是，我无法做到这一点，因为我的数据每个月都在变化。

# java - Quartz 无法删除作业，现在怎么办？

> ID：16173785
> 
> 赞同：8
> 
> 时间：2013-04-23T15:48:28.097
> 
> 标签：java, quartz-scheduler

给定一个 Quartz 作业和以下命令

```
boolean deleted = scheduler.deleteJob(event.getName(), "some group name") 
```

假设`deleted`回来`false`，据我了解，这意味着从 JVM 的角度来看，工作仍然存在。

带着这2个问题：

1.  是否可以强制删除作业？
2.  什么事件阻止 Quartz 删除作业？

如果没有抛出异常，假设没有找到工作是否安全？什么会导致这个？发生这种情况的唯一方法不是首先删除作业吗？

我在用

```
 <dependency>
        <groupId>org.quartz-scheduler</groupId>
        <artifactId>quartz</artifactId>
        <version>1.8.0</version>
    </dependency> 
```

这让你觉得这是一种正确的处理方式吗？我的推理正确吗？

```
 boolean deleted;
    try {
        deleted = scheduler.deleteJob(event.getName(), "some group name");
        if (!deleted) {
            logger.warn("Quartz failed to delete the job!" + event.getName() + ". Job not found");
        }
    } catch (SchedulerException e) {
        logger.error("There is an internal Scheduler error", e);
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T17:50:03.700

1.  是的，你已经在这样做了。
2.  作业当前正在运行。

如果您需要在运行时删除作业，请确保您的作业实现 org.quartz.InterruptableJob。然后你可以`org.quartz.Scheduler.interrupt(JobKey)`在它运行时调用它来停止它。

尝试在 SchedulerException 之后为一般异常添加一个 catch（这是更好的异常处理，如果您不确定可能会遇到的错误，它将对您有所帮助）。

另请记住，当您构建石英作业时，您可以使用`jobBuilder.storeDurably(false)`，这将导致您的石英作业在不再有关联的活动触发器时被自动删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-06T15:36:58.033

在安排作业时设置以下一个

```
job.getJobDataMap().put("JOB_NUMBER",input);
            job.getJobDataMap().put("TRIGGER_NAME",input); 
```

# 在执行作业操作

```
TriggerKey triggerKey = new TriggerKey(jobCtx.getMergedJobDataMap().get("TRIGGER_NAME").toString(),jobCtx.getMergedJobDataMap().get("TRIGGER_NAME").toString());
//condition
scheduler.unscheduleJob(triggerKey);
scheduler.deleteJob(JobKey.jobKey(jobCtx.getMergedJobDataMap().get("JOB_NUMBER").toString(),jobCtx.getMergedJobDataMap().get("JOB_NUMBER").toString()) ); 
```

# php - 使用地名查找附近的大城市

> ID：16173788
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:38.713
> 
> 标签：php, json, coordinates, geonames

我有一个简单的 php 函数，它可以从给定的纬度和经度获取最近的附近城市：

```
function findCity($lat, $lng, $username) {
        $json_url = "http://api.geonames.org/findNearbyPlaceNameJSON?lat=" . $lat . "&lng=" . $lng . "&username=" . $username;
        $json = file_get_contents($json_url);
        $json = str_replace('},

            ]', "}

            ]", $json);
        $data = json_decode($json);

        echo "<pre>";
    print_r($data);
    echo "</pre>";
    } 
```

此方法返回以下内容，lat：51.992 和 long：4.89

```
stdClass Object
(
    [geonames] => Array
        (
            [0] => stdClass Object
                (
                    [countryName] => Netherlands
                    [adminCode1] => 11
                    [fclName] => city, village,...
                    [countryCode] => NL
                    [lng] => 4.876389
                    [fcodeName] => populated place
                    [distance] => 1.42349
                    [toponymName] => Langerak
                    [fcl] => P
                    [name] => Langerak
                    [fcode] => PPL
                    [geonameId] => 2751924
                    [lat] => 51.931667
                    [adminName1] => South Holland
                    [population] => 0
                )

        )

) 
```

这将返回最近的城市，但我正在寻找这样的[东西](http://www.geonames.org/NL/largest-cities-in-netherlands.html)。只返回最近的大城市。这可能吗？或者是否有其他方法可以解决这个问题。我已经阅读了有关 Google Geocoding API 的信息，但我们不能使用它，因为我们没有使用 Google 地图来显示结果。（注意：Geocoding API 只能与谷歌地图一起使用；禁止在地图上不显示的地理编码结果。 [来源](https://developers.google.com/maps/documentation/geocoding/)）

我知道这不是一个真正的程序员问题，但由于 geonames 论坛并不活跃，我想我会在这里发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T22:21:39.390

你需要一个最大城市的列表。我没有找到关于地理名称的 api 调用（也许可以尝试使用 [freebase api 来按城市相关性进行排序](https://stackoverflow.com/questions/9989727/freebase-api-for-sorting-by-city-relevance)）。因为您显示的示例列表很短，您可以对其进行硬编码吗？如果是这样，您可以使用如下所示的内容：

```
/*
* Haversine formula
* from: http://rosettacode.org/wiki/Haversine_formula#PHP
*/ 

class POI {
    private $latitude;
    private $longitude;
    public function __construct($latitude, $longitude) {
        $this->latitude = deg2rad($latitude);
        $this->longitude = deg2rad($longitude);
    }
    public function getLatitude() {return $this->latitude;}
    public function getLongitude(){return $this->longitude;}
    public function getDistanceInMetersTo(POI $other) {
        $radiusOfEarth = 6371000;// Earth's radius in meters.
        $diffLatitude = $other->getLatitude() - $this->latitude;
        $diffLongitude = $other->getLongitude() - $this->longitude;
        $a = sin($diffLatitude / 2) * sin($diffLatitude / 2) +
            cos($this->latitude) * cos($other->getLatitude()) *
            sin($diffLongitude / 2) * sin($diffLongitude / 2);
        $c = 2 * asin(sqrt($a));
        $distance = $radiusOfEarth * $c;
        return $distance;
    }
}

class bigcity
{
    public $name;
    public $lat;
    public $long;

    function __construct($name,$lat,$long)
    {
        $this->name=$name;
        $this->lat=$lat;
        $this->long=$long;
    }       
}   

function getbigcities()
{
    $bigcities = array();
    $bigcities[] = new bigcity('Amsterdam',52.374 ,4.89);
    $bigcities[] = new bigcity('Eindhoven',51.441 ,5.478);
    $bigcities[] = new bigcity('Groningen',53.219 ,6.567);
    return $bigcities;
}   

function findCity($lat, $lng)
{
    $userinput = new POI($lat,$lng);
    $bigcities = getbigcities();
    $distance = 1000000000;
    $result = '';
    foreach ($bigcities as $bigcity)
    {

        $delta = $userinput->getDistanceInMetersTo(new POI($bigcity->lat,$bigcity->long));
        if($delta<$distance)
        {
            $result = $bigcity->name;
            $distance = $delta;
        }   
    }   

    return ($result);
}   

echo findcity(51.556,5.091); //tilburg
echo findcity(52.55,6.15); //leeuwaarden
echo findcity(52.091,5.122); //utrecht
exit; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T23:03:43.193

对于那些在同样问题上苦苦挣扎的人，我编写了一些 Java 代码，这些代码可以从网站上抓取大陆、国家、城市、纬度和经度坐标。代码并不漂亮，因为我匆忙完成了它，但它完成了它应该做的事情：

```
public class Main {

private static String title;
private static String land;
private static Document docu;
private static String continent = "Africa";

public static void main(String[] args) throws IOException {
    String url = "http://www.timegenie.com/latitude_and_longitude/";

    Document doc = Jsoup.connect(url).get();
    Elements links = doc.select("a[href]");

    //print("\nLinks: (%d)", links.size());
    for (Element link : links) {
        if (link.attr("abs:href").contains("country_coordinates")) {
            try {
                docu = Jsoup.connect(link.attr("abs:href")).get();
                title = docu.title();
                land = (trim(link.text(), 50));

                if (land.equals("Algeria")) {
                    continent = "Africa";
                } else if (land.equals("Antarctica")) {
                    continent = "Antarctica";
                } else if (land.equals("Afghanistan")) {
                    continent = "Asia";
                } else if (land.equals("Bouvet Island")) {
                    continent = "Antartica";
                } else if (land.equals("Anguilla")) {
                    continent = "North America";
                } else if (land.equals("Belize")) {
                    continent = "North America";
                } else if (land.equals("Armenia")) {
                    continent = "Asia";
                } else if (land.equals("Åland Islands") || land.equals("Aland Islands")) {
                    continent = "Europe";
                } else if (land.equals("Bassas da India")) {
                    continent = "Africa";
                } else if (land.equals("Akrotiri")) {
                    continent = "Asia";
                } else if (land.equals("Bermuda")) {
                    continent = "North America";
                } else if (land.equals("Clipperton Island")) {
                    continent = "North America";
                } else if (land.equals("Argentina")) {
                    continent = "South America";
                } else if (land.equals("American Samoa")) {
                    continent = "Oceania";
                }

                Element table = docu.select("table.times").get(0);
                Elements trs = table.select("tr");
                Iterator trIter = trs.iterator();
                boolean firstRow = true;
                while (trIter.hasNext()) {

                    Element tr = (Element) trIter.next();
                    if (firstRow) {
                        firstRow = false;
                        continue;
                    }
                    Elements tds = tr.select("td");
                    Iterator tdIter = tds.iterator();
                    int tdCount = 1;
                    String city = null;
                    String longgr = null;
                    String latgr= null;

                    while (tdIter.hasNext()) {

                        Element td = (Element) tdIter.next();
                        switch (tdCount++) {
                            case 1:
                                city = td.select("a").text();
                                break;
                            case 4:
                                latgr= td.text();
                                break;
                            case 6:
                                longgr = td.text();
                                break;
                        }
                    }

                    System.out.println(continent + "|" + land + "|" + city + "|" + latgr+ "|" + longgr+ "|");
                }
            } catch (Exception ex) {
                Elements links2 = docu.select("a[href]");

                for (Element link2 : links2) {
                    if (link2.attr("abs:href").contains("state_coordinates")) {
                        try {
                            try {
                                docu = Jsoup.connect(link2.attr("abs:href")).get();
                                title = docu.title();

                                Element table = docu.select("table.times").get(0);
                                Elements trs = table.select("tr");
                                Iterator trIter = trs.iterator();
                                boolean firstRow = true;
                                while (trIter.hasNext()) {

                                    Element tr = (Element) trIter.next();
                                    if (firstRow) {
                                        firstRow = false;
                                        continue;
                                    }
                                    Elements tds = tr.select("td");
                                    Iterator tdIter = tds.iterator();
                                    int tdCount = 1;
                                    String city = null;
                                    String longgr = null;
                                    String latgr= null;

                                    while (tdIter.hasNext()) {

                                        Element td = (Element) tdIter.next();
                                        switch (tdCount++) {
                                            case 1:
                                                city = td.select("a").text();
                                                break;
                                            case 4:
                                                latgr= td.text();
                                                break;
                                            case 6:
                                                longgr= td.text();
                                                break;
                                        }
                                    }

                                    System.out.println(continent + "|" + land + "|" + city + "|" + latgr+ "|" + longgr+ "|");
                                }
                            } catch (Exception e) {
                                e.printStackTrace();
                            }
                        } catch (Exception x) {
                            x.printStackTrace();
                        }
                    }
                }
            }
        }
    }
}

private static void print(String msg, Object... args) {
    System.out.println(String.format(msg, args));
}

private static String trim(String s, int width) {
    if (s.length() > width) {
        return s.substring(0, width - 1) + ".";
    } else {
        return s;
    }
}
} 
```

我用过[Jsoup](http://jsoup.org/)库。

运行这段代码需要一段时间（大约 3 分钟），它会返回很多行（用 word 粘贴：146 页），格式如下：`continent|country|city|lat|long|`所以很容易将它们插入数据库。

干杯

# android - 在 hmtl5 中使用 localstorage 来存储动态创建的 div 而不使用数据库

> ID：16173790
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:47.103
> 
> 标签：android, html, cordova, mobile, local-storage

我正在尝试使用 Html5 css3 jquery、jquery mobile phonegap 和 Dreamweaver cs6 开发一个 Web 应用程序（混合应用程序）。

在我的应用程序中，我有三个带有不同选项的选择框和一个按钮。当用户在选择所有三个选择框的选项后单击按钮时，将创建一个 div。到这里还不错，但是一旦应用程序被刷新或移动到另一个页面，我就会失去创建的 div。这个应用程序是一个演示应用程序，所以我没有使用任何数据库。有没有一种方法可以使用本地存储来保存这个 div，这样当我回到应用程序时我可以检索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:54:43.813

你当然可以

保存

```
if (('localStorage' in window) && window['localStorage'] !== null) {
        var divtosave = $("#divtosave").html();
        localStorage.setItem('saveddiv', divtosave);
}); 
```

用它

```
if ('saveddiv' in localStorage) {
        $("#div").html(localStorage.getItem('saveddiv'));
} 
```

清除它

```
localStorage.clear(); //release it 
```

# excel - SSIS从excel导入，第一列中的列名

> ID：16173792
> 
> 赞同：1
> 
> 时间：2013-04-23T15:48:49.150
> 
> 标签：excel, sql-server-2005, import, ssis

我有一个excel工作簿，里面有很多工作表。每个工作表都有代表模式的数据。问题是数据没有用标题行布局，而是有一个标题**“列”**。此外，数据仅包含在工作表的第 7 到第 13 行，即：

```
Field Name  | Swap ID     | Allocation ID | Description | Broker ID ...
Field Type  | Alphanumeric| Alphanumeric  | Alphanumeric| Alphanumeric ...
Field Length| char(40)    | char(40)      | char(100)   | char(50) ....
... 
```

我将如何将这些工作表之一导入具有以下结构的数据库表？

```
Field Name | Field Type | Field Length | ... 
```

**注意：**我的问题不仅仅是跳过行内容，而是如何“透视”数据，使按列排列的数据改为按行排列。

**编辑：**感谢 praveen 的回答，我能够使用`Select * from [Sheet$A7:AZ13]`语法处理使用特定范围的单元格的要求，但是导入数据的主要问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:05:00.150

尝试这个 ：-

第 1 步：在创建时`Excel Connection Manager`选择选项`First Rows as Column name`

第 2 步：在 excel 源代码中使用`SQL Command`for`Data access mode`并编写查询以跳过初始行

```
SELECT * FROM [Sheet1$A7:B] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T19:29:09.777

您也可以对此进行试验：（将 Excel 工作表加载到临时表后，从 SSMS 运行以下脚本：

```
SELECT * FROM [dbo].[STG_Sheet1] 
SELECT * FROM [dbo].[Sheet1]  

DECLARE @CETList2 varchar(300); DECLARE @CETList3 varchar(300);
DECLARE @CETList4 varchar(300); DECLARE @CETList5 varchar(300);
DECLARE @INSERT varchar(1000) DECLARE @EXEC_INSERT varchar(1000);

SET @INSERT = 'INSERT INTO dbo.SHEET1 ([Field Name], [Field Type],[Field Length])  VALUES';

SELECT        
    @CETList2 = COALESCE(@CETList2 + ',', '') + '''' + LTRIM(RTRIM(CAST(CETL.[F2] AS Varchar))) + '''' 
  , @CETList3 = COALESCE(@CETList3 + ',', '') + '''' + LTRIM(RTRIM(CAST(CETL.[F3] AS varchar))) + ''''  
  , @CETList4 = COALESCE(@CETList4 + ',', '') + '''' + LTRIM(RTRIM(CAST(CETL.[F4] AS varchar))) + ''''
  , @CETList5 = COALESCE(@CETList5 + ',', '') + '''' + LTRIM(RTRIM(CAST(CETL.[F5] AS varchar))) + '''' 
FROM [dbo].[STG_Sheet1] CETL 

SET  @EXEC_INSERT = @INSERT + '(' + @CETList2 + ')';
EXECUTE (@EXEC_INSERT)

SET  @EXEC_INSERT = @INSERT + '(' + @CETList3 + ')'; 
EXECUTE (@EXEC_INSERT)

SET  @EXEC_INSERT = @INSERT + '(' + @CETList4 + ')';
EXECUTE (@EXEC_INSERT)

SET  @EXEC_INSERT = @INSERT + '(' + @CETList5 + ')'; 
EXECUTE (@EXEC_INSERT)

SELECT * FROM [dbo].[Sheet1] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T19:20:15.577

在一张 Excel 工作表和另一张 Excel 表格之间可能会有很多事情发生变化。因此，仅将此解决方案用作起点。如果您有任何问题，请告诉我们。(-; 免责声明 ;-)

我创建了一个如下所示的 Excel 文件：

> 字段名称 | 交换ID | 分配编号 | 说明 | 经纪人编号
> 
> 字段类型 | 字母数字| 字母数字 | 字母数字| 字母数字
> 
> 字段长度| 字符(40) | 字符(40) | 字符(100) | 字符（50）

1.  将您的 Excel 文件加载到临时表 (STG_Sheet1) 中。

> 创建表 [dbo].[STG_Sheet1] (
> [F1] varchar NULL , [F2] varchar NULL , [F3] varchar NULL , [F4] varchar NULL , [F5] varchar NULL ) ON [PRIMARY]

现在，创建一个新的 SSIS 包。

2.1 创建以下变量：

```
2.1.1 oFieldList; Data type: Object
2.1.2 sColumn; Data type: String, Value: F2
2.1.3 sSql; Data type: String, Value: "SELECT " + @[User::sColumn] + " AS COL FROM [dbo].[STG_Sheet1]"
2.1.4 sSQLInsert; Data type: String
2.1.5 sValues; Data type: String 
```

2.2 放置一个脚本任务。

```
2.2.1 Result Set: Full result set
2.2.2 SQL Statement:
    SELECT sac.name as ColumnName FROM sys.all_columns sac 
        INNER JOIN sys.all_objects sao ON sao.object_id = sac.object_id
        WHERE sao.name = 'STG_Sheet1' AND sac.name <> 'F1'

2.2.3 Result Set: Result Name: 0; Variable Name: User::oFieldList 
```

2.3 放置一个 ForEach 循环容器

```
2.3.1 Enumerator: Foreach ADO Enumerator
2.3.2 ADO object source variable: User::oFieldList
2.3.3 Variable Mappings: User::sColumn: 0 
```

现在，在 ForEach 循环容器内

2.4 放置一个 DFT

```
2.4.1 Place an OLE DB Source
    2.4.1.1 Data access mode: SQL Command from variable
    2.4.1.2 Variable name: sSQL
    2.4.1.3 Columns: COL

2.4.2 Place a Script component as Transformation
    2.4.2.1 Input Columns: COL : ReadOnly
    2.4.2.2 Script: ReadWrite Variables:User::sValues
    2.4.2.3 Edit Script : Code below

    public class ScriptMain : UserComponent
    {
        string colValue = string.Empty;

        public override void PreExecute()
        {
            base.PreExecute();
        }

        public override void PostExecute()
        {
            base.PostExecute();

            string x = Variables.sValues;
            int iFirstCommaAt = colValue.IndexOf (',');
            colValue = colValue.Substring(iFirstCommaAt + 1);
            Variables.sValues = colValue;
        }

        public override void Input0_ProcessInputRow(Input0Buffer Row)
        {
            string x = Row.COL;
            colValue = string.Format("{0},'{1}'", colValue, x);
        }
    } 
```

2.5 放置脚本任务：

```
2.5.1 ReadOnlyVariables: User::sValues
2.5.2 ReadWriteVariables: User::sSQLInsert
2.5.3 Edit Script: Code below

    public void Main()
    {
        string s = "INSERT INTO dbo.SHEET1 ([Field Name], [Field Type], [Field Length])  VALUES ";

        string sValue = Dts.Variables["User::sValues"].Value.ToString();
        string sSQLInsert = string.Empty;

        Dts.Variables["User::sSQLInsert"].Value = string.Format("{0} ({1})", s, sValue);

        Dts.TaskResult = (int)ScriptResults.Success;
    } 
```

2.6 放置执行SQL任务

```
2.6.1 SQLSourceTyoe: Variable
2.6.2 SourceVariable: User::sSQLInsert 
```

# javascript - 防止 QTip 工具提示离开屏幕？（绑定到身体？）

> ID：16173793
> 
> 赞同：1
> 
> 时间：2013-04-23T15:48:50.377
> 
> 标签：javascript, jquery

我有QTips：

```
eventRender: function (event, element, view) {
    element.qtip({
        content: event.title + event.hours,
        position:{
            target: 'mouse'
        },
        //  show: { event: 'click' },
        hide: { event: 'mousedown mouseleave' },
        style: { 
            width: 200,
            padding: 5,
            color: 'black',
            textAlign: 'left',
            border: {
                width: 1,
                radius: 3
            },
            classes: 'custSideTip'
        } 
    });
} 
```

CSS：

```
.custSideTip
{
    position:fixed !important;
    right:0 !important;
    max-width:200px !important;
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/oFl5q.png)

但他们离开了页面......

我尝试了正确和固定的位置，但似乎没有任何效果......

提示的正确坐标不应超过 body.right / page.right ...如果有意义的话..

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T16:00:53.720

取自[**这里**](http://craigsworks.com/projects/forums/thread-solved-how-to-keep-qtip-from-drawing-off-screen)。

您可以尝试使用[**视口**](http://qtip2.com/plugins#viewport)配置：

```
position: { viewport: $(window) } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-17T20:44:54.537

这对我有用，其他示例在 jQuery 代码中没有一些错误。也许有些版本差异？

```
position: { viewport: $(document.body) } 
```

# sql - 在 SQL SELECT 语句中使用引号分隔符来转义单引号

> ID：16173794
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:53.170
> 
> 标签：sql, oracle, oracle10g

当用户在用 C# (.NET) 开发的表单条目中输入诸如“Sam 的项目可交付成果”之类的输入文本时，我想转义单引号。数据库是ORACLE 10g。

我遇到了 ORACLE 10g [http://www.orafaq.com/wiki/SQL_FAQ#How_does_one_escape_special_characters_when_writing_SQL_queries.3F](http://www.orafaq.com/wiki/SQL_FAQ#How_does_one_escape_special_characters_when_writing_SQL_queries.3F)提供的引号分隔符功能，但我不确定是否使用这样的引号分隔符**q'[ some text with single quote]'**作为一部分一个 SELECT 语句会**阻止 SQL 注入攻击**吗？

引号分隔符 q'[ 带单引号的文本 ]' 的示例用法：

```
SQL> SELECT q'[Frank's Oracle site]' AS text FROM DUAL;
 TEXT
 -------------------
 Frank's Oracle site

 SQL> SELECT q'[A 'quoted' word.]' AS text FROM DUAL;
 TEXT
 ----------------
 A 'quoted' word.

 SQL> SELECT q'[A ''double quoted'' word.]' AS text FROM DUAL;
 TEXT
 -------------------------
 A ''double quoted'' word. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T16:15:09.653

如果您的查询看起来像这样......

```
query = "SELECT * FROM Users WHERE name = q'[" + <what the user entered> + "]'"; 
```

...并且用户输入了这样的内容...

```
abc]';<harmful statement>;SELECT * FROM DUAL WHERE '1'=q'[1 
```

...他们将成功注射。

与您一起使用的分隔符无关紧要`q`- 坚定的攻击者会尝试所有分隔符。准备好的陈述是你最好的辩护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:52:18.320

在执行 SQL 之前，尝试用 2 个单引号替换所有单引号。即在执行SQL命令之前将'替换为''。

在 C# 中：

```
string sql = originalString.Replace("'", "''"); 
```

# jquery - 使用 jQueryUI 在 DatePicker 日历上禁用工作日

> ID：16173797
> 
> 赞同：0
> 
> 时间：2013-04-23T15:48:58.580
> 
> 标签：jquery, datepicker, jquery-ui-datepicker

我正在使用来自 jQuery-UI 的日期选择器，我想知道是否有任何方法可以禁用/修改日历，使其仅显示月份和年份，仅此而已。

我在这里尝试了答案[jQuery UI Datepicker - Disable specific days](https://stackoverflow.com/questions/677976/jquery-ui-datepicker-disable-specific-days)，但它并没有达到我想要的效果。它并没有真正起作用，我想禁用特定的日期选择器而不是全部。

有人可以帮忙吗？

提前致谢。

**PS：**到目前为止，我的代码如下所示：

```
$(".crud_date_picker_month").datepicker({
    changeMonth: true,
    changeYear: true,
    showButtonPanel: true,
    dateFormat: 'yy-mm'
}); 
```

jQuery UI 版本 1.8.21

可以在这里看到代码：http: [//jsfiddle.net/VJADH/](http://jsfiddle.net/VJADH/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:56:22.870

> 我想知道是否有任何方法可以禁用/修改日历，使其仅显示月份和年份，仅此而已。

使用 CSS 仅显示月份和年份：

```
.ui-datepicker-calendar{
    display:none;    
} 
```

* * *

[**演示**](http://jsfiddle.net/ANF2y/)- 仅使用 CSS 显示月/年

* * *

如果您需要以编程方式执行此操作，可以添加以下代码：

```
$(".date-picker").focus(function () {
    $(".ui-datepicker-calendar").hide();
}); 
```

* * *

[**演示**](http://jsfiddle.net/tdjUn/)- 仅以编程方式显示月/年

* * *

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:52:25.917

要禁用月份和年份（根据您的提交标题！！），隐藏标题：

```
.ui-datepicker-header {
    display: none;
} 
```

[http://jsfiddle.net/VJADH/1/](http://jsfiddle.net/VJADH/1/)

# linq-to-sql - 如果没有数据发生变化，行为存储过程将不会执行

> ID：16173803
> 
> 赞同：0
> 
> 时间：2013-04-23T15:49:15.723
> 
> 标签：linq-to-sql

我有`.dbml`一个表，并且该表具有更新/删除/插入的相关行为，这些行为是存储过程。

如果我查询一行并且我没有修改它，或者我设置了相同的值并且我调用`datacontext.save()`了 ，它将不会执行存储过程。

有没有办法知道它不会被执行或强制执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:22:28.463

您可以通过欺骗 linq2sql 认为列总是“脏”来强制执行存储过程。这个问题的答案可能会有所帮助：

[你能说服 DataContext 将列视为总是脏的吗？](https://stackoverflow.com/questions/1560513/can-you-convince-a-datacontext-to-treat-a-column-as-always-dirty/1563751#1563751)

# c# - 如何获取使用 C# 中的流生成的文件的名称？

> ID：16173805
> 
> 赞同：10
> 
> 时间：2013-04-23T15:49:17.517
> 
> 标签：c#, filestream

我正在使用 XAML/C# 构建 Windows 8 Metro 应用程序。我正在使用流保存我的数据结构的 .xml 文件，如下所示：

```
XmlSerializer serializer = new XmlSerializer(typeof(MyObjectType));

using (var stream = await App.LocalStorage.OpenStreamForWriteAsync(MyObject.Title + ".xml", Windows.Storage.CreationCollisionOption.GenerateUniqueName))
    serializer.Serialize(stream, MyObject); 
```

在哪里：

```
App.LocalStorage 
```

显然是一个 StorageFolder 对象设置为

```
Windows.Storage.ApplicationData.Current.LocalFolder 
```

设置 GenerateUniqueName 选项是为了避免冲突，因为我的对象可以具有相同的标题。现在，我需要获取我的流生成的文件名，我该如何获取呢？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T16:04:48.987

尝试先创建文件。

```
var sourceFileName = MyObject.Title + ".xml";
StorageFile storageFile = await App.LocalStorage.CreateFileAsync(sourceFileName, Windows.Storage.CreationCollisionOption.GenerateUniqueName);

using (var stream = await storageFile.OpenAsync(FileAccessMode.ReadWrite))
{
    serializer.Serialize(stream, MyObject);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T16:05:42.437

该`OpenStreamForWriteAsync`方法似乎没有为您提供任何简单的方法来访问此信息。您可以切换到以另一种方式访问​​它：

```
StorageFile file = await App.LocalStorage.CreateFileAsync(...);
using (var stream = await file.OpenAsync(FileAccessMode.ReadWrite))
    // do stuff, file name is at file.Name 
```

# python - 在 Python 中访问嵌套的字典项

> ID：16173809
> 
> 赞同：8
> 
> 时间：2013-04-23T15:49:41.153
> 
> 标签：python, dictionary, python-3.3

我正在尝试使用嵌套字典中的项目格式化字符串（下）

```
 people = {
        'Alice': {
            'phone': '2341',
            'addr': '87 Eastlake Court'
            },

        'Beth': {
            'phone': '9102',
            'addr': '563 Hartford Drive'
            },

        'Randy': {
            'phone': '4563',
            'addr': '93 SW 43rd'
            }

        } 
```

从上面的（简单）字典中，我想格式化一个字符串以打印出 Randy 的电话分机。

我可以使用以下方式访问他的所有详细信息：

```
 print("Randy's phone # is %(Randy)s" % people) 
```

但我不确定如何深入字典以从字典中挑选出电话号码。

顺便说一句，我正在使用 Python 3.3。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-23T15:51:57.757

使用[新的字符串格式](http://docs.python.org/3.3/library/string.html#format-string-syntax)：

```
print("Randy's phone # is {0[Randy][phone]}".format(people)) 
```

或者

```
print("Randy's phone # is {Randy[phone]}".format(**people)) 
```

如果您只使用一个值，则传递整个字典是没有意义的。

```
print("Randy's phone # is {}".format(people['Randy']['phone'])) 
```

或者

```
print("Randy's phone # is %s" % people['Randy']['phone']) 
```

也将工作。

如果您有很多这些格式字符串并且不知道它们使用哪些值，并且希望它们能够访问任何值，则传递 dict 是有意义的。

或者，如果您在格式字符串中使用许多值并单独传递它们就太冗长了。

# jsf - 无法在 Primefaces RequestContext.execute() 调用中显示对话框

> ID：16173811
> 
> 赞同：0
> 
> 时间：2013-04-23T15:49:50.483
> 
> 标签：jsf, jsf-2, primefaces

我有一个选项卡视图，每当用户选择该选项卡时，我想在其中刷新一个特定选项卡的内容。我还希望在刷新选项卡时弹出模式对话框。

这是带有 tabChange ajax 事件处理程序的 tabView

```
<p:dialog widgetVar="statusDialog" modal="true" draggable="false" minimizable="false" appendToBody="true"   closable="false" header="Processing..." resizable="false" maximizable="false">  
     <p:graphicImage library="assets" name="ajax-loader.gif"></p:graphicImage> 
</p:dialog>

<p:tabView id="tabview" orientation="top" dynamic="false">
    <p:ajax event="tabChange" listener="#{bean.tabChangeListener}"></p:ajax>
    <p:tab title="tab1">
        <ui:include src="/WEB-INF/views/tab1.xhtml"/>
    </p:tab>
    <p:tab title="tab2">
        <p:remoteCommand actionListener="#{bean.refreshData}" update="someTab2ElementID" name="refresh" global="true" onstart="statusDialog.show()" oncomplete="statusDialog.hide()"/>
        <ui:include src="/WEB-INF/views/tab2.xhtml"/>
    </p:tab>
</p:tabView> 
```

这是tabChangeListener：

```
public void tabChangeListener(TabChangeEvent event) {
    if ( event.getTab().getId().equalsIgnoreCase("tab2") ) {
                RequestContext.getCurrentInstance().execute("refresh()");
    }
} 
```

刷新 remoteCommand 正在按预期调用，但我的 statusDialog 从未显示。如果按钮触发了相同的 remoteCommand，则单击 statusDialog 会出现。JavaScript 控制台中没有错误。

为什么在 RequestContext.execute() 触发 remoteCommand 时不显示 statusDialog，我怎样才能让它出现？我什至尝试将 statusDialog.show() 添加到 execute() 但它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T15:16:38.017

我想到了。这是解决方案：

```
<h:outputScript>
var blockCount=0;
function showStatus() {
 if (blockCount==0) statusDialog.show();
 blockCount++;
};
function hideStatus() {
 blockCount--;
 if (blockCount==0) statusDialog.hide();
};
</h:outputScript>

<p:ajaxStatus onstart="showStatus();" onsuccess="hideStatus();" onerror="blockCount=0;statusDialog.hide();errorDialog.show();"/>  

<p:remoteCommand actionListener="#{bean.refreshData}" update="someTab2ElementID" name="refresh" global="true" onstart="showStatus()" oncomplete="hideStatus()"/> 
```

显然，我的状态对话框没有显示的原因是另一个 Ajax 调用完成并调用了 statusDialog.hide() 而我的 refresh() 事情正在进行。上面的 JS 代码维护了多少 Ajax 调用正在进行的计数器，并且只有在所有调用都完成后才会隐藏状态对话框。现在按预期工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:28:12.373

如果要在更改特定选项卡时显示对话框，可以通过 ajax 响应添加回调参数来通知 js 函数，选项卡选择控件是否为 2：

```
public void tabChangeListener(TabChangeEvent event) {
    if ( event.getTab().getId().equalsIgnoreCase("tab2") ) {
                RequestContext.getCurrentInstance().addCallbackParam("index", 2);
    }
} 
```

并使用：

```
 <p:ajax event="tabChange" listener="#{bean.tabChangeListener}"
     oncomplete="showOrNot(xhr,status,args)"></p:ajax> 
```

这将调用 js 函数，它将控制更改的选项卡是否为 2：

```
function showOrNot(xhr,status,args) {
    if(args.index==2) {
        statusDialog.show();
    } 
} 
```

或者不同的方法是定义一个值并使用`visible`以下属性`p:dialog`：

```
public void tabChangeListener(TabChangeEvent event) {
        if ( event.getTab().getId().equalsIgnoreCase("tab2") ) {
                    this.condition=true;
        }
    } 
```

和`<p:dialog visible="#{bean.condition}"/>`。也许您需要专注于您的第一种方法，您可以`p:dialog`通过以下方式提供 ID 并更新它`p:remoteCommand`：

```
<p:remoteCommand actionListener="#{bean.refreshData}" update="someTab2ElementID dialog" name="refresh" global="true" onstart="statusDialog.show()" oncomplete="statusDialog.hide()"/> 
```

不要忘记在 的更新属性中提供对话框的确切客户端 ID `p:remoteCommand`。

# algorithm - 算法的时间复杂度

> ID：16173812
> 
> 赞同：0
> 
> 时间：2013-04-23T15:49:58.040
> 
> 标签：algorithm, big-o, time-complexity, binary-search

我编写了一个算法，用于在无限整数的排序数组中查找键。

```
 findKey(int k, int start, int end)
     int mid = (start + end)/2

     if (k < array[mid])
         findKey(k, start, mid)
     else if (k > array[mid])
         findKey(k, mid+1, end)
     else 
         return mid 
```

我想知道这个算法的时间复杂度。是o（logn）吗？我真的很困惑，谁能解释一下？也让我知道这里是否有任何缺陷。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:52:39.263

让我们有存储值的数组 ![在此处输入图像描述](https://i.stack.imgur.com/5Ajz2.jpg)

假设我们要找到key=20，我们调用findkey(20,1,8)，参数k=20，start=1，end=8

**一系列函数调用**

![在此处输入图像描述](https://i.stack.imgur.com/kv75J.jpg)

```
Recurrence relation :

T(n)  = T(n/2)+c
 expanding…
          =T(n/2^2)+c+c
          =T(n/2^3)+c+c+c

Kth time expanding…

          = c+c+c+c+c . .. .. . .. . . .  .T(n/2^k)

Let at kth time array size become 1,
we assume it as a base condition for recurrence.
Thus , 
   n/2^k = 1
      n  = 2^k
Taking log both sides ..
    log n = k

 time complexity of recurrence..

   T(n) = c* log n 
        = O(log n) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:53:52.183

你所做的是[二分搜索算法](http://en.wikipedia.org/wiki/Binary_search_algorithm)，或者接近它的东西。该算法为 O(log n)。

# sql-server - 使用 SQL Server 进行慢速 SQL 查询

> ID：16173816
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:50:06.437
> 
> 标签：sql-server, performance

我有两个 SQL 查询来计算不同 id1 值中 id2 值之间的共现。示例表看起来像

```
id1 | id2
101 | 1
101 | 2
101 | 3
102 | 2
102 | 3
102 | 4
103 | 15
103 | 3
103 | 4 
```

所需的输出是：

```
A  B Count
1  2 1
1  3 2
2  3 4
1  4 2
2  4 3
3  4 4
1 15 1
2 15 2
3 15 2
4 15 1 
```

两种解决方案都粘贴在下面。

```
-- Solution 1
SELECT bar.id2 AS A, foo.id2 AS B, COUNT(*) AS Count
FROM
  (SELECT * FROM TestTab) AS bar,
  (SELECT * FROM TestTab) AS foo
WHERE bar.id1 <> foo.id1
  AND bar.id2 < foo.id2
GROUP BY bar.id2, foo.id2

-- Solution 2
SELECT bar.id2 AS A, foo.id2 AS B, COUNT(*) AS Count
FROM TestTab AS bar
JOIN TestTab AS foo
  ON bar.id1 <> foo.id1
WHERE bar.id2 < foo.id2
GROUP BY bar.id2, foo.id2 
```

这两个查询都适用于小表（即 100 - 1000 行），但我需要查询更大的表（例如 100.000 行）。我想知道如何加快查询速度并提高性能。在此先感谢您的任何指点。

```
- Create table TestTab and insert dummy data
CREATE TABLE TestTab
INSERT INTO TestTab VALUES
  (101,1),
  (101,2),
  (101,3),
  (102,2),
  (102,3),
  (102,4),
  (103,15),
  (103,3),
  (103,4) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:52:49.980

我建议在`id2`TestTab 上添加一个索引（如果尚不存在），然后尝试运行以下命令：

```
select distinct id2 into #id2 from TestTab;

SELECT bar.id2 AS A, foo.id2 AS B, COUNT(*) AS Count
FROM #id2 AS bar
JOIN #id2 AS foo ON bar.id2 < foo.id2
JOIN TestTab AS buz ON bar.id2 = buz.id2
JOIN TestTab AS fuz ON foo.id2 = fuz.id2
WHERE buz.id1 <> fuz.id1
GROUP BY bar.id2, foo.id2; 
```

（如果您已经有一个具有不同 id2 值的表，请跳过创建临时表并改用它。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:02:10.397

这两个查询都是连接和等价的。

第一个是带有附加子选择的隐式连接。如果 SQL Server 不优化子选择，它可能会更慢。

正如其他人已经观察到的那样，将索引添加到连接条件列`id1`和 where 子句列`id2`（如果您还没有这样做的话）。

# asp.net - VB.NET mailto：运行时错误“91”

> ID：16173832
> 
> 赞同：1
> 
> 时间：2013-04-23T15:50:54.213
> 
> 标签：asp.net, vb.net, visual-studio-2012, mailto, visual-web-developer

任何人都可以看看我下面的代码并推荐我如何停止接收可怕的错误 91。错误：对象变量或未设置块变量。我正在使用 mailto: 函数使用本机电子邮件客户端发送电子邮件并从 gridview 填充带有数据的电子邮件。弹出错误后，我只需单击确定，电子邮件就会加载我想要的确切数据！

```
Protected Sub GridView2_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles GridView2.SelectedIndexChanged, GridView1.SelectedIndexChanged
    Dim MailFormat, Number, BodyOfEmail, FullName As String
    Dim RowValue As Double

    RowValue = GridView1.SelectedDataKey.Value - 1
    Number = GridView1.Rows(RowValue).Cells(5).Text.ToString
    FullName = GridView1.Rows(RowValue).Cells(25).Text.ToString
    BodyOfEmail = “SomeTextInTheBody”
    MailFormat = "mailto:" & Number & "?" & "subject= A subject here" & "&body=" & BodyOfEmail
    System.Diagnostics.Process.Start(MailFormat)
End Sub 
```

我可以从 .aspx 页面执行以下代码就好了：

```
a href="mailto:someone@example.com?Subject=Hello%20again" 
```

并且前景打开没有问题。当执行顶部的 aspx.vb 代码时，这似乎只是一个问题......

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:28:18.557

`<a href="mailto:xxx"/>`工作正常，因为它在用户的浏览器中执行，并且将使用用户本地安装的交互式电子邮件应用程序，无论它碰巧是什么。

`Process.Start("mailto:xxx")`总是会失败，因为它在 Web 服务器上执行，可能没有本地安装的交互式电子邮件应用程序可用，即使有，您也无法在不存在的桌面上以交互方式启动它。它碰巧在您的测试环境中抛出错误 91 的事实是无关紧要的。不要这样做，完全停止。

您需要做的是安排一些 JavaScript 在服务器端事件完成后在页面渲染上执行。类似的东西`location.href = "mailto:xxx"`可能会奏效。您应该将其插入的确切位置取决于您的页面设计。

或者，如果您想将电子邮件生成代码完全保留在服务器端，并且您知道您的用户将始终使用 Outlook，您可以考虑直接调用 Exchange Server。请参阅[此处](http://msdn.microsoft.com/en-us/library/exchange/dd633710.aspx)作为起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:01:42.060

您是否考虑过使用[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)类？

```
Dim SmtpServer As New SmtpClient()
Dim mail As New MailMessage()
SmtpServer.Credentials = New Net.NetworkCredential("sender address", "sender password")
SmtpServer.Port = 587              'If sending from gmail...
SmtpServer.Host = "smtp.gmail.com" 'If sending from gmail...
mail = New MailMessage()
mail.From = New MailAddress("sender address")
mail.To.Add("recipient address")
mail.Subject = ""
mail.Body = ""
SmtpServer.Send(mail) 
```

# matlab - Matlab：读取部分二进制数据

> ID：16173833
> 
> 赞同：0
> 
> 时间：2013-04-23T15:50:56.633
> 
> 标签：matlab, binary, fread

我有一个数据集（二进制文件），我只想读取保存到 4D 矩阵的 X（和相应的 Y）数据的前半部分：

```
 for i = 1:vols
    for j = 1:cols
       XY(i,:,:,j) = fread(fid,[X Y],'int16');
    end
 end 
```

如何修改上述循环，以便为每个 vols 和 cols 读取第一个例如 10 X 数据（和相应的 Y）？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:58:35.697

您将需要按以下顺序为每个 vols 和 cols 实现读取：为第一个输入 X 读取 Y 的一部分，然后跳过该行的其余部分，为第二个输入 X 读取 Y 的一部分，等等。

在读取请求的 X 行数后，您需要在读取下一个 (vols, cols) 对之前跳过矩阵的其余部分。

要跳过矩阵的一部分，您可以使用 fseek 函数。

设 X_count 和 Y_cound 为子矩阵的维数；X_total 和 Y_total 是总矩阵的维度。您需要以下内容：

```
for i = 1:vols
   for j = 1:cols
      for k=1:X_count
          XY(i,k,:,j) = fread(fid,Y_count,'int16');
          fseek(fid,(Y_total-Y_count)*2,'cof');
      end
      fseek(fid,(X_total-X_count)*Y_total*2,'cof');
   end
end 
```

# wcf - WCF 错误：服务器没有提供有意义的回复；

> ID：16173835
> 
> 赞同：23
> 
> 时间：2013-04-23T15:51:00.420
> 
> 标签：wcf

请有人可以帮我找出发生了什么。我的 WCF 服务运行良好，现在突然出现此错误：

> **服务器没有提供有意义的回复；这可能是由合同不匹配、会话过早关闭或内部服务器错误引起的**

我必须告诉我，当我选择数千条记录时它仍然有效，但是当数据很大时，我收到这个错误，虽然之前它工作正常！

```
 private static string ConnString = "Server=127.0.0.1; Port=5432; Database=DBname; User Id=UName; Password=MyPassword;"
    DataTable myDT = new DataTable();

                NpgsqlConnection myAccessConn = new NpgsqlConnection(ConnString);
                myAccessConn.Open();
        string query = "SELECT * FROM Twitter";

                NpgsqlDataAdapter myDataAdapter = new NpgsqlDataAdapter(query, myAccessConn);

                myDataAdapter.Fill(myDT);
                foreach (DataRow dr in myDT.Rows)
                {
   **WHEN I HAVE TOO MANY RECORDS IT STOPS HERE**
        ... 
```

**网络配置**

```
<configuration>
    <system.web>
        <compilation debug="false" targetFramework="4.0" />
      <httpRuntime maxRequestLength="2147483647" executionTimeout="100000" />
    </system.web>
  <system.diagnostics>
    <trace autoflush="true" />
    <sources>
      <source name="System.ServiceModel"
              switchValue="Information, ActivityTracing"
              propagateActivity="true">
        <listeners>
          <add name="traceListener" type="System.Diagnostics.XmlWriterTraceListener" initializeData="Traces4.svclog"/>
        </listeners>
      </source>
    </sources>
  </system.diagnostics>
  <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IDBService" closeTimeout="00:30:00"
                    openTimeout="00:30:00" receiveTimeout="00:30:00" sendTimeout="00:30:00"
                    allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferSize="2147483647" maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647"
                    messageEncoding="Text" textEncoding="utf-8" transferMode="Streamed"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647"
                        maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
    <client>
      <endpoint address="" binding="basicHttpBinding" 
          bindingConfiguration="BasicHttpBinding_IDBService" contract="DBServiceReference.IDBService"
          name="BasicHttpBinding_IDBService" />
    </client>
        <behaviors>
            <serviceBehaviors>
                <behavior name="">
                  <serviceMetadata httpGetEnabled="true" />
                  <serviceDebug includeExceptionDetailInFaults="true" />
                  <dataContractSerializer maxItemsInObjectGraph="2147483646" />
                </behavior>
            </serviceBehaviors>
        </behaviors>
        <serviceHostingEnvironment aspNetCompatibilityEnabled="false" multipleSiteBindingsEnabled="true" />
    </system.serviceModel>
</configuration> 
```

**客户端配置**（已编辑）

```
<configuration>
        <system.serviceModel>
            <bindings>
                <basicHttpBinding>
                    <binding name="BasicHttpBinding_IRouteService" maxBufferSize="2147483647"
                        maxReceivedMessageSize="2147483647">
                        <security mode="None" />
                    </binding>
                    <binding name="BasicHttpBinding_IDBService" closeTimeout="00:30:00"
                        openTimeout="00:30:00" receiveTimeout="00:30:00" sendTimeout="00:30:00"
                        maxBufferSize="2147483647" maxReceivedMessageSize="2147483647"
                        transferMode="Buffered" >

                        <security mode="None" />
                    </binding>
                </basicHttpBinding>
                <customBinding>
                    <binding name="CustomBinding_IRouteService">
                        <binaryMessageEncoding />
                        <httpTransport maxReceivedMessageSize="2147483647"
                            maxBufferSize="2147483647" />
                    </binding>
                </customBinding>
            </bindings>

            <client>
                <endpoint address="http://dev.virtualearth.net/webservices/v1/routeservice/routeservice.svc"
                    binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IRouteService"
                    contract="BingRoutingService.IRouteService" name="BasicHttpBinding_IRouteService" />
                <endpoint address="http://dev.virtualearth.net/webservices/v1/routeservice/routeservice.svc/binaryHttp"
                    binding="customBinding" bindingConfiguration="CustomBinding_IRouteService"
                    contract="BingRoutingService.IRouteService" name="CustomBinding_IRouteService" />
                <endpoint address="" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_IDBService"
                    contract="DBServiceReference.IDBService" name="BasicHttpBinding_IDBService" />
            </client>
        </system.serviceModel>
    </configuration> 
```

在我的文件**scvlog 中**，我没有得到任何异常！我不知道我还能做些什么来了解问题出在哪里。**请有人帮助我！！！**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-04-14T18:27:31.267

一个不同的答案，以防万一有人像我一样来到这里寻找问题的一般答案。

似乎完成驴工作的 DataContractSerializer 非常挑剔，但并不总是将真正的错误传递给客户端。服务器进程在失败后直接死亡 - 因此找不到错误。在我的情况下，问题是一个用作标志的枚举，但没有用 [Flags] 属性装饰（挑剔或什么！）。

为了解决这个问题，我创建了一个序列化程序的实例并检查了调试器中的错误；这是一个代码片段，因为我手头有它。

**编辑：**响应评论中的请求...

修改了代码片段以显示我现在使用的辅助方法。和以前一样，但在一个方便的通用包装器中。

```
public static T CheckCanSerialize<T>(this T returnValue) {
    var lDCS = new System.Runtime.Serialization.DataContractSerializer(typeof(T));

    Byte[] lBytes;
    using (var lMem1 = new IO.MemoryStream()) {
        lDCS.WriteObject(lMem1, returnValue);
        lBytes = lMem1.ToArray();
    }

    T lResult;
    using (var lMem2 = new IO.MemoryStream(lBytes)) {
        lResult = (T)lDCS.ReadObject(lMem2);
    }

    return lResult;
} 
```

而要使用这个，不是返回一个对象，而是在调用辅助方法后返回对象，所以

```
public MyDodgyObject MyService() {
    ... do lots of work ...
    return myResult;
} 
```

变成

```
public MyDodgyObject MyService() {
    ... do lots of work ...
    return CheckCanSerialize(myResult);
} 
```

然后在服务停止关注*之前*抛出序列化中的任何错误，因此可以在调试器中进行分析。

笔记; 我不建议将调用留在生产代码中，它具有序列化和反序列化对象的开销，一旦调试代码就没有任何真正的好处。

希望这对某人有所帮助-我已经浪费了大约 3 个小时来尝试追踪它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-24T07:21:46.767

我不知道这是否真的可以成为答案，但我试图将**web.config**从`<security mode="None" />`to更改为`<security mode="Transport" />`它工作！

我想注意这部分应该只在**web.config**和客户端配置中更改`<security mode="None" />`，因为在这两个中都有 Transport 它不起作用！

所以在那之后，我决定尝试再次回到`None security`它，它工作了几分钟，然后又停止了，它又出现了错误：

***服务器没有提供有意义的回复；这可能是由合同不匹配、会话过早关闭或内部服务器错误引起的***

## 所以看来我的解决方案是在 web.config 中设置

## `security mode to Transport`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-03T10:26:06.670

就我而言，我正在开发一个与 WCF Web 服务通信的 Windows 应用程序项目。使用 netTcpBinding 的 Web 服务正在返回一个 Stream 对象（图片）。

由于 windows 应用程序没有配置文件，因此使用默认值进行绑定。只需在客户端后端代码上扩展 MaxReceivedMessageSize 即可解决我的问题。

```
var API = new StreamService.StreamServiceClient(
  new System.ServiceModel.NetTcpBinding(System.ServiceModel.SecurityMode.None)
  {
    MaxReceivedMessageSize = 2147483647
  },
  new System.ServiceModel.EndpointAddress("net.tcp://machine/app/service.svc")
); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-29T07:50:14.650

有时，此问题是由由于绑定中的默认值而被剪切的过大消息引起的。

您应该在 app.config 文件中的绑定中添加具有足够大值的**maxReceivedMessageSize、maxBufferPoolSize 和 maxBufferSize - 这应该可以解决问题:)**

例子：

```
<bindings>
<netTcpBinding>
<binding 
name="ExampleBinding" closeTimeout="00:01:00"
maxReceivedMessageSize="73400320"
maxBufferPoolSize="70000000"
maxBufferSize="70000000"/>
</netTcpBinding>
</bindings> 
```

祝你好运！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-28T19:15:58.870

就我而言，我正在开发一个 MVC 应用程序并且我已经改变了

```
maxReceivedMessageSize ="10000000" 
```

至

```
maxReceivedMessageSize ="70000000" 
```

它奏效了！是因为来自网络服务器的响应超过了`maxReceivedMessageSize ="10000000"`，
所以我增加 `maxReceivedMessageSize`了`maxReceivedMessageSize ="70000000"`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-03T15:26:39.923

根据我对这个错误的经验，只需检查服务主机的事件日志，看看实际的根异常是什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-05T16:38:12.463

对我来说，这是一个从数据库中检索到的项目的延迟加载列表。

WCF 接收器将尝试迭代它们，这将尝试转到数据库，这显然无法工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-16T16:13:33.253

在 BizTalk 中，我们使用来解决此问题。

大多数情况下，由于来自服务的消息的大小，会发生此问题。所以我们需要将接收消息的大小从 65,356 增加到 2,365,60。它对我有用。

[在此处输入图像描述](https://i.stack.imgur.com/uD6zm.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-29T00:43:29.347

就我而言，从 .NET Framework 4.5 升级到 .NET Framework 4.8 后，我必须删除用 DataMemberAttribute 修饰的属性*的只读修饰符。*

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-23T07:55:42.107

ASP.NET 应用程序可以使用发出请求的用户的 Windows 身份（用户帐户）执行。模拟通常用于依赖 Microsoft Internet 信息服务 (IIS) 对用户进行身份验证的应用程序中。默认情况下禁用 ASP.NET 模拟。

启用此功能，您的 API 将开始工作 - 它在 IIS 身份验证中

# c# - Richtextbox - 撤消？

> ID：16173839
> 
> 赞同：2
> 
> 时间：2013-04-23T15:51:15.213
> 
> 标签：c#, .net, wpf, richtextbox

我需要能够检测是否触发了“撤消”，以及它是否对我的`RichTextBox`.

我在此刻输入内容`RichTextBox`，然后按`Ctrl+Z`，windows 似乎为我处理了撤消操作。我希望能够编写在此之后立即触发的代码。我一直在四处寻找，找不到任何东西。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-15T07:09:53.543

从 .Net 3.0 开始，有一种简单的内置方法可以在执行撤消命令（以及其他命令）时获得通知：

```
CommandManager.RegisterClassCommandBinding(typeof(MyClass),
    new CommandBinding(ApplicationCommands.Undo, OnUndo)); 
```

只需在静态构造函数（或其他地方）中调用这行代码并添加一个静态方法：

```
private static void OnUndo(object sender, ExecutedRoutedEventArgs e)
{
    //your code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:13:52.747

**WINFORM**：

您可以利用该[`KeyDown`](http://msdn.microsoft.com/en-gb/library/system.windows.forms.control.keydown.aspx)事件并检测是否按下了`Ctrl`+ ：`Z`

```
richTextBox.KeyDown += new KeyEventHandler(richTextBox_KeyDown); 
```

* * *

```
private void richTextBox_KeyDown(object sender, KeyEventArgs e){
    if (e.Modifiers == Keys.Control && e.KeyCode == Keys.Z){
        //undo detected, do something
    }
} 
```

**WPF**：

```
richTextBox.KeyUp += new KeyEventHandler(richTextBox_KeyUp); 
```

* * *

```
void richTextBox_KeyUp(object sender, KeyEventArgs e) {
    if (Keyboard.Modifiers == ModifierKeys.Control && e.Key == Key.Z) {
        //undo detected, do something
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:08:00.717

我认为您将不得不[自己实施](http://wpftutorial.net/UndoRedo.html)。我不知道有什么开箱即用的活动可以满足您的需求。

您可能还想看看[Monitored Undo Framework](http://muf.codeplex.com/)。[在这里](http://www.codeproject.com/Articles/33371/Multilevel-Undo-and-Redo-Implementation-in-C-Part)
额外阅读。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T09:34:14.730

如果我很了解你，你想比较`Ctr+Z`.

那么你应该这样做：

在 XAML 文件中：

```
<RichTextBox PreviewKeyDown="RichTextBox_PreviewKeyDown" KeyUp="RichTextBox_KeyUp" /> 
```

在 CS 文件中：

```
private void RichTextBox_KeyUp(object sender, KeyEventArgs e)
{
    if (Keyboard.Modifiers == ModifierKeys.Control && e.Key == Key.Z)
    {
        Console.WriteLine("After : " + new TextRange(((RichTextBox)sender).Document.ContentStart, ((RichTextBox)sender).Document.ContentEnd).Text);
    }
}

private void RichTextBox_PreviewKeyDown(object sender, KeyEventArgs e)
{
    if (Keyboard.Modifiers == ModifierKeys.Control && e.Key == Key.Z)
    {
        Console.WriteLine("Before : " + new TextRange(((RichTextBox)sender).Document.ContentStart, ((RichTextBox)sender).Document.ContentEnd).Text);
    }
} 
```

然后，您将在应用程序的输出中看到 RichTextBox 之前的`Ctrl+Z`内容和之后的内容。

我试过了，效果很好！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-26T14:00:26.327

如前所述，`CommandBindings`可以使用。我更喜欢绑定到每个`control`而不是绑定到特定类的所有控件。这可以通过以下方式完成：

```
this.richTextBox.CommandBindings.Add(
    new CommandBinding(ApplicationCommands.Undo, this.RichTextBoxUndoEvent));

private void RichTextBoxUndoEvent(object sender, ExecutedRoutedEventArgs e)
{
    e.Handled = true;
    this.richTextBox.Undo();
} 
```

# visual-c++ - 在 MFC 应用程序的 CStatusBar 中添加 CSliderCtrl

> ID：16173842
> 
> 赞同：0
> 
> 时间：2013-04-23T15:51:26.983
> 
> 标签：visual-c++, mfc

我正在尝试添加`CSliderCtrl`到`CStatusBar`. 为此 - 在 CMainFrame 类中创建了 CSliderCtrl -`CMainFrame::OnCreate()`添加了用于创建状态栏和滑块栏控件的代码

```
 bStatus =  m_ZoomSlider.Create(
    WS_CHILD | WS_VISIBLE,
    CRect(0, 0, 100, 30),
    &m_StatusBar,
    56666); 
```

一切正常。

现在我希望这个滑块位于状态栏的右侧。为此，我在状态栏中添加了一个 INDICATOR，我试图获取该指标的矩形并将滑块放在该矩形上。

```
CRect rectSlider;
m_StatusBar.GetItemRect(1, &rectSlider);
bStatus =  m_ZoomSlider.Create(
    WS_CHILD | WS_VISIBLE,
    rectSlider,
    &m_StatusBar,
    56666); 
```

这里的 rectSlider 具有负值，导致滑块不可见。

我需要知道这是执行此操作的正确方法。任何建议都会非常有帮助。

我正在使用 Visual Studio 2005。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T15:22:33.943

我认为你应该使用 GetRect 而不是 GetItemRect

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-23T07:37:29.893

滑块控件无法显示，因为它的 Z 顺序不正确。因此，覆盖调整大小以正确重新定位滑块。&CWnd::wndTop 表示将窗口放在Z-order 的顶部

首先，在MainFrame.h 中定义CSliderCtrl *m_pZoomSlider 下面的代码使用了惰性初始化模式：需要时初始化，当frame 被销毁时释放分配的内存。

```
BEGIN_MESSAGE_MAP(CMainFrame, CFrameWnd)
   ...
   ON_WM_SIZE()
END_MESSAGE_MAP()

   void CMainFrame::SetSliderPosition(int pos)
   {    
        if (!m_pZoomSlider) {
            CRect rectSlider;
            m_wndStatusBar.GetItemRect(1, &rectSlider);
            rectSlider.DeflateRect(1, 1);       // 1 pixel border...
            m_pZoomSlider = new CSliderCtrl();
            m_pZoomSlider->Create(WS_CHILD | WS_VISIBLE, rectSlider, &m_wndStatusBar, ID_INDICATOR_SCALE_SLIDER);
            m_pZoomSlider->SetRange(1, 100);
        }

            RECT rc;
            m_wndStatusBar.GetItemRect(pos, &rc);
            // Reposition the slider control correctly!
            m_pZoomSlider->SetWindowPos(&CWnd::wndTop, rc.left, rc.top, rc.right - rc.left, rc.bottom - rc.top, 0);

    }

    void CMainFrame::OnSize(UINT nType, int cx, int cy)
    {
        CFrameWnd::OnSize(nType, cx, cy);
        SetSliderPosition(1); //index of indicator of status bar
    }

    BOOL CMainFrame::DestroyWindow()
    {   
        if (m_pZoomSlider) {
            m_pZoomSlider->DestroyWindow();
            delete m_pZoomSlider;
        }
        return CFrameWnd::DestroyWindow();
    } 
```

# sql - SQLPLUS 在同一个 SELECT 语句中选择一列并计数

> ID：16173844
> 
> 赞同：0
> 
> 时间：2013-04-23T15:51:38.927
> 
> 标签：sql, oracle, select, count, sqlplus

我创建了这个简单的库签出表，其中插入了以下列和值：

```
insert into CHECKOUT (MemID, Cat#, DateChkOut, DateDue, DateRet) 
    values (4, 'T 430.98 1956', '15-Mar-2011', '14-Jun-2011', '31-May-2011');
insert into CHECKOUT (MemID, Cat#, DateChkOut, DateDue, DateRet) 
    values (12, 'B 125.2 2013', '15-Mar-2011', '14-Jun-2011', NULL);
insert into CHECKOUT (MemID, Cat#, DateChkOut, DateDue, DateRet) 
    values (4, 'T 430.98 1956', '27-Dec-2012', '25-Mar-2013', NULL); 
```

对于每个成员，我需要列出成员 ID 和曾经签出的书籍数量。我尝试使用：

```
select distinct MemID, count(distinct Cat#) from CHECKOUT; 
```

但收到错误：不是单组组功能。显然我不能同时选择要显示的列和计数，但我可能是错的。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:53:18.763

你需要一个`group by`声明，而不是一个`select distinct`：

```
select MemID, count(distinct Cat#)
from CHECKOUT
group by MemId 
```

如果您想要从未借过书的会员，那么您需要`left outer join`：

```
select memID, count(distinct Cat#)
from Members m left outer join
     Checkout co
group by m.MemId 
```

背后的想法`left outer join`是保留第一个表中的所有行，以及第二个表中的匹配项。这允许您查找没有匹配行的成员。

看来您正在学习 SQL。你应该做一些学习来更好地理解语言。

# mongodb - NoSQL 中的博客和博客评论关系

> ID：16173848
> 
> 赞同：3
> 
> 时间：2013-04-23T15:51:48.623
> 
> 标签：mongodb, relationship, nosql

在此处接受的答案中举一个例子：

*   [对象之间的 Mongo DB 关系](https://stackoverflow.com/questions/3128200/mongo-db-relations-between-objects)

对于博客系统，“帖子应该是一个集合。帖子作者可能是一个单独的集合，或者只是帖子中的一个字段，如果只是一个电子邮件地址。评论应该是帖子中的嵌入对象以提高性能。”

如果是这种情况，这是否意味着每次我的应用程序显示博客文章时，我都会加载对该文章发表的每条评论？如果有 3,729 条评论怎么办？这不会破坏数据库连接、SQL 或 NoSQL 吗？还有一个明显的场景，当我加载博客文章时，我最初只想显示前 10 条评论。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T21:02:56.723

文档数据库不是关系数据库。您不能先构建数据库模型，然后再决定各种有趣的查询方式。相反，您应该首先确定要支持的访问模式，然后相应地设计文档模式。

因此，为了回答您的问题，我们真正需要知道的是您打算如何使用这些数据。显示与帖子相关联的评论与显示来自特定作者的所有评论截然不同。这些要求中的每一个都将决定不同的设计，同时支持它们。

这本身对您来说可能是有用的信息（？），但我怀疑您想要更具体的答案:) 所以请添加一些关于您的预期用途的额外细节。

添加更多信息：在决定策略时有一些“做”和“不做”：

1.  DO：针对常见用例进行优化。通常有 20/80 的细分，其中 20% 的 UX 驱动 80% 的负载 - 主页/登陆页面是一个典型的例子。首要任务是确保这些尽可能高效。确保您的数据模型允许 A) 在单个 IO 请求中加载它们或 B) 对缓存友好

2.  不要：不要落入可怕的“N+1”陷阱。当您的数据模型强制您进行 N 次调用以加载 N 个实体时，就会出现这种模式，通常在此之前还有一个额外的调用以获取 N 个 ID 的列表。这是一个杀手，尤其是与#3...

3.  做：总是限制（通过用户体验）你愿意获取的数据量。如果用户有 3729 条评论，您显然不会一次获取所有评论。即使从数据库的角度来看它是可行的，用户体验也会很糟糕。这就是搜索引擎使用“下一个 20 个结果”范式的原因。因此，您可以（例如）将数据库结构与 UX 对齐并将评论保存为 20 块。然后每次页面刷新都涉及一个 DB 获取。

4.  DO：平衡读取和写入要求。某些类型的系统是读取繁重的，您可以假设每次写入都会有很多读取（StackOverflow 就是一个很好的例子）。因此，为了提高读取性能，提高写入成本是有意义的。例如，数据非规范化和复制。其他系统均衡甚至写入繁重，需要其他方法

5.  做：利用时间维度来发挥你的优势。Twitter 是一个典型的例子：99.99% 的推文在第一个小时/天/周/任何时间之后将永远不会被访问。这在您的数据模式中打开了各种有趣的优化可能性。

这只是冰山一角。我建议阅读一下基于列的 NoSQL 系统（例如 Cassandra）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T20:33:36.163

不确定这是否能回答您的问题，但无论如何您可以通过两种方式限制博客评论的数量：

*   `$slice`使用运算符仅加载最后 10 条或博客评论范围

`db.blogs.find( {_id : someValue}, { comments: { $slice: -10 } } )`

将返回最后 10 条评论

`db.blogs.find( {_id : someValue}, { comments: { $slice: [-10, 10] } } )`

将返回接下来的 10 条评论

*   使用 capped array 使用[capped arrays只保存最后 n 篇博客文章](http://docs.mongodb.org/manual/tutorial/limit-number-of-elements-in-updated-array/)

# foursquare - Foursquare & 403 禁止错误

> ID：16173853
> 
> 赞同：0
> 
> 时间：2013-04-23T15:52:02.440
> 
> 标签：foursquare, http-status-code-403

我目前正在开发使用场地服务的应用程序之一。为了向我提出请求，`FourSquare`我创建了一个帐户并使用`OAuthToken`为该特定帐户提供的。

根据 FourSquare，除非 Four Square 团队在到期时做出任何更改，否则 oauthtoken 将终生保持不变。因此，除非 API 发生任何变化，否则它不会过期。

我正在使用所需参数将 HTTPRequest 从 .NET 窗口服务发送到“四方”。

```
https://api.foursquare.com/v2/venues/search?ll=37.785835,-122.406418&intent=browse&radius=5&limit=50&oauth_token=[OAUTHTOKEN HERE]&&v=20130422 
```

在某些情况下，应用程序的行为很奇怪，因为它返回如下响应：

1) 远程服务器返回错误：(403) Forbidden。

2) 远程服务器返回错误：(400) Bad Request。

然而，行为是随机的，它给应用程序带来了问题。

我想知道什么是发送请求的最佳方式，然后是我从申请中获取场地的方法。另外我想知道“oauthtoken”是否最适合我？

如果有人可以帮助我知道上述错误的原因以及如何克服它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:38:42.447

一般来说，您可以在此处查看我们的错误消息及其含义：[https](https://developer.foursquare.com/overview/responses) ://developer.foursquare.com/overview/responses 。当您的某个参数丢失或存在问题时，通常会发生 400。我没有看到您提供的示例 URL 有任何问题，但也许其他的可能有错误？

403 有点棘手，您是否总是调用场所/搜索端点？您对 OAuth 令牌生命周期的理解是正确的。

您当前正在向 Foursquare 发出经过**身份验证**的请求，这意味着将为 OAuth 令牌所属的用户个性化搜索结果。还有一个替代的[**无用户请求**](https://developer.foursquare.com/overview/auth#userless)，它只需要您的应用程序的客户端 ID/秘密，并且不需要您的用户通过 Foursquare 进行身份验证。根据您的应用程序的需求（某些端点需要身份验证），您可能会发现无用户请求是可行的方法。

# python - 嵌入式python解释器，生成自动补全的stub源代码

> ID：16173857
> 
> 赞同：1
> 
> 时间：2013-04-23T15:52:05.810
> 
> 标签：python, mocking

我有一个嵌入 python 并将其内部对象模型公开为 python 对象/类的应用程序。

出于自动完成/脚本编写的目的，我想提取一个内部对象模型的模拟，其中包含文档标签、结构、函数等，以便我可以将它用作 IDE 自动完成的库源。

有人知道一个库，或者有一些代码片段可以用来将这些类转储到源代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T20:01:33.373

使用[dir()](http://docs.python.org/2/library/functions.html#dir)或[globals()](http://docs.python.org/2/library/functions.html#globals)函数来获取已经定义的列表。然后，过滤和浏览你的类使用[检查](http://docs.python.org/2/library/inspect.html)模块

示例 toto.py：

```
class Example(object):
    """class docstring"""

    def hello(self):
        """hello doctring"""
        pass 
```

示例浏览.py：

```
import inspect
import toto

for name, value in inspect.getmembers(toto):
    # First ignore python defined variables
    if name.startswith('__'):
        continue

    # Now only browse classes
    if not inspect.isclass(value):
        continue
    print "Found class %s with doctring \"%s\"" % (name, inspect.getdoc(value))

    # Only browse functions in the current class
    for sub_name, sub_value in inspect.getmembers(value):
        if not inspect.ismethod(sub_value):
            continue
        print "  Found method %s with docstring \"%s\"" % \
            (sub_name, inspect.getdoc(sub_value)) 
```

蟒蛇浏览.py：

```
Found class Example with doctring "class docstring"
  Found method hello with docstring "hello doctring" 
```

此外，这并不能真正回答您的问题，但如果您正在编写一种 IDE，您还可以使用[ast](http://docs.python.org/2/library/ast.html)模块来解析 python 源文件并获取有关它们的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T06:34:52.313

Python 数据结构是可变的（请参阅[什么是猴子补丁？](https://stackoverflow.com/questions/5626193/what-is-monkey-patching)），因此提取模拟是不够的。[您可以改为使用内置函数动态地](http://docs.python.org/2/library/functions.html#dir)[向`dir()`](http://docs.python.org/2/library/functions.html#dir)解释器询问可能的自动完成字符串。

# facebook - 点赞按钮指向的网站和页面是否必须具有相同的 App ID？

> ID：16173858
> 
> 赞同：0
> 
> 时间：2013-04-23T15:52:06.457
> 
> 标签：facebook, facebook-graph-api, dom-events, facebook-like

我有一个快速的问题。我有一个网站，其设计会在用户单击“赞”按钮时做出响应。因此，我使用该`edge.subscribe`方法在单击按钮时列出。

为此，我必须创建一个 Facebook 应用程序，具有自己的 Facebook 应用程序 ID，并使用 Javascript API 嵌入点赞按钮。问题是，点赞按钮指向的是 Facebook 页面，而不是网站（网站有 0 个赞，Facebook 页面有 20 万个赞）。

问题是，除非我登录到 Facebook，否则我的点赞按钮不会出现——这似乎是我之前通过拥有我喜欢的页面和我正在点击的页面在另一个网站上解决的问题点赞按钮共享同一个 App ID。

即使在技术上它没有指向我的应用程序中的页面，我仍然可以显示 Facebook 喜欢按钮吗？我在 Facebook 中的页面是否需要成为应用程序？

# python - Python 计数器结果到 csv 文件

> ID：16173865
> 
> 赞同：5
> 
> 时间：2013-04-23T15:52:18.863
> 
> 标签：python, csv, counter

这个问题是基于我以前的问题：[Python list help (incrementing count, appending)](https://stackoverflow.com/questions/16172268/python-list-help-incrementing-count-appending)

当我打印 c 时，我能够创建以下输出；

```
Counter({(u'New Zealand', 174.885971, -40.900557): 1, (u'Ohio, USA', -82.90712300000001, 40.4172871): 1}) 
```

这正是我想要的，现在我想知道如何将其写入 csv 文件。每行将代表一个新位置，经度/纬度，计数。

我想遍历计数器并访问这些部分： writer.writerow(["A", "B", "C"]);

A是新西兰的位置，B是纬度/经度，C是出现次数，

如何访问 count 的结果并获得所需的部分？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T15:54:21.020

A`Counter`是标准类的子`dict`类；`.iteritems()`您可以使用（python 2）或仅使用（python 3）遍历字典中的项目`.items()`：

```
for key, count in your_counter.iteritems():
    location, lat, long = key
    writer.writerow([location, lat, long, count]) 
```

这将写入*四*列，其中纬度和经度有 2 个单独的列。如果要将它们组合成一列，例如，作为两个坐标之间带有斜线的字符串，只需使用字符串格式：

```
for key, count in your_counter.iteritems():
    location, lat, long = key
    writer.writerow([location, '{}/{}'.format(lat, long), count]) 
```

# jquery - 数据表水平滚动问题

> ID：16173866
> 
> 赞同：3
> 
> 时间：2013-04-23T15:52:19.577
> 
> 标签：jquery, html, datatables

[从这里](http://datatables.net)下载了新的数据表，它工作正常，但问题与滚动有关。

我有最新版本的 java 脚本但是当我水平滚动有一个日志我可以

观察表格主体和标题之间的时刻。我不确定它为什么会发生。

当我部署到 IIS Web 服务器时会出现这个问题。

我在 IIS 服务器中发现的另一个问题是搜索标签和

数据表中的搜索框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:48:14.707

标题实际上是一个单独的 HTML 表，它们相对于数据列的位置由 javascript 维护。

如果您查看页面的源代码，您可以看到标题表在`dataTables_scrollHead`元素中，而数据在`dataTables_scrollBody`元素的表中。当您在数据表的正文中水平滚动时，可能通过监听`scroll`事件并更新标题的滚动位置来通过 javascript 滚动标题。

我怀疑是否有办法让这更顺畅，因为响应能力在很大程度上取决于客户端。

# ruby - Rspec 包括 matcher、beetwen Hash 和 String 对象

> ID：16173868
> 
> 赞同：2
> 
> 时间：2013-04-23T15:52:22.850
> 
> 标签：ruby, json, unit-testing, testing, rspec

如果哈希对象中的所有字段，我如何检查 Rspec：

```
{"id"=>5392501, "owner"=>"cainlevy", "name"=>"photor", "url"=>"https://api.github.com/repos/cainlevy/photor", "description"=>"Photo Organizer (in Ruby)", "created_at"=>"2012-08-12T22:26:08Z", "pushed_at"=>"2013-02-19T03:11:10Z", "organization"=>"User", "full_name"=>"cainlevy/photor", "language"=>"Ruby", "updated_at"=>"2013-03-13T02:05:33Z"} 
```

包含在作为字符串对象的字段超集中**：**

```
{"id":5392501,"name":"photor","full_name":"cainlevy/photor","owner":{"login":"cainlevy","id":4449,"avatar_url":"https://secure.gravatar.com/avatar/2573ddee29779e76b7da7d3c2c9ff18d?d=https://a248.e.akamai.net},"private":false,"html_url":"https://github.com/cainlevy/photor","description":"Photo Organizer (in Ruby)","fork":false,"created_at":"2012-08-12T22:26:08Z","updated_at":"2013-03-13T02:05:33Z","pushed_at":"2013-02-19T03:11:10Z","git_url":"git://github.com/cainlevy/photor.git","ssh_url":"git@github.com:cainlevy/photor.git","clone_url":"https://github.com/cainlevy/photor.git","svn_url":"https://github.com/cainlevy/photor","homepage":null,"size":312,"watchers_count":4,"language":"Ruby","has_issues":true,"has_downloads":true,"has_wiki":true,"forks_count":0,"mirror_url":null,"open_issues_count":0,"forks":0,"open_issues":0,"watchers":4,"master_branch":"master","default_branch":"master"} 
```

目前我要去`fixture_repos[0].to_json.should include compared`哪里

```
fixture_repos[0].to_json.class: String 
```

和

```
compared.class: Hash 
```

我得到以下失败：

```
no implicit conversion of Hash into String 
```

显然我无法通过将字符串赋予 hash 来摆脱它：

```
fixture_repos[0].to_json.to_h 
```

或相反亦然

```
compared.to_s 
```

**更新**，这里是完整的规范：

```
require "spec_helper"
  describe Elasticrepo::Extractor do
    let(:fixture_repos)  { Yajl::Parser.parse(fixture("repositories.json").read) }

    context "GET /users/:user/starred" do
      describe "#extract" do 
          let(:compared ) {Yajl::Parser.parse(fixture("live_extracted.repos[0].to_json").read) }

          it "includes compared fields" do
            fixture_repos[0].to_json.should include compared
          end
      end
    end 
  end 
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:01:34.153

您无法将哈希与字符串进行比较。但它不是真正的字符串，是吗？它是一个 JSON 对象。您*可以*比较 JSON 对象。

由于您使用的是 rspec，我建议您使用[json_spec](https://github.com/collectiveidea/json_spec)。它有一个`include_json`匹配器，可以解决你的问题。它还有其他你可能会觉得有用的匹配器。

# c# - WPF 错误 40 BindingExpression 路径错误：在“对象”上找不到属性

> ID：16173869
> 
> 赞同：59
> 
> 时间：2013-04-23T15:52:24.547
> 
> 标签：c#, wpf, xaml, binding

我用这个绑定错误把我的头撞在我的桌子上。我已经检查了几个帖子的`BindingExpression`路径错误并且看不到任何适合我的情况的东西。

无论如何，我有一个名为`IncrementingTextBox`. 每当用户“检查”上面的内容时，我都会尝试禁用`CheckBox`它。

我有一个`CheckBox` `IsChecked`工作正常的属性绑定，并且在它应该触发的时候触发。它正确设置`UseSensorLength`了 ConfigurationModel 上的属性。

但是，`IncrementingTextBox` `IsEnabled`属性上的绑定会导致`BindingExpression`路径错误，因此根本不会更新。

作为测试，我尝试在后面的代码中启用和禁用控件，它工作得很好，但我似乎无法让绑定工作。

这是我的 xaml 的一个片段：

```
...

DataContext="{Binding RelativeSource={RelativeSource Self}}"

...
...

<CheckBox Content="Use Sensor Length" Margin="30,6,0,0" 
          IsChecked="{Binding ConfigurationModel.UseSensorLength, Mode=TwoWay}"/>

<local:IncrementingTextBox x:Name="video_length_textbox" Margin="0,0,0,5" 
                           IsTextEnabled="False" 
                           IsEnabled="{Binding ConfigurationModel.DontUseSensorLength}" 
                           ValueChanged="VideoEventValueChanged"/> 
```

这是我的 ConfigurationModel 的一个片段：

```
public bool DontUseSensorLength
{
    get { return !UseSensorLength; }
}

public bool UseSensorLength
{
   get { return _useSensorLength; }
   set 
   { 
      _useSensorLength = value; 
      OnPropertyChanged("UseSensorLength"); 
      OnPropertyChanged("DontUseSensorLength");
   }
} 
```

这是我在运行应用程序时在输出窗口中收到的错误消息：

> System.Windows.Data 错误：40：BindingExpression 路径错误：在“对象”“IncrementingTextBox”（名称=“video_length_textbox”）上找不到“ConfigurationModel”属性。BindingExpression:Path=ConfigurationModel.DontUseSensorLength; DataItem='IncrementingTextBox' (Name='video_length_textbox'); 目标元素是'IncrementingTextBox'（名称='video_length_textbox'）；目标属性是“IsEnabled”（类型“布尔”）

请记住，“UseSensorLength”属性绑定工作正常，但“DontUseSensorLength”绑定导致上述“BindingExpression 路径错误”。

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2013-04-23T16:20:16.803

我最近写了一些关于如何阅读绑定错误的其他 SO[答案](https://stackoverflow.com/a/14523290/302677)，以便它们更有意义。总而言之，在冒号和分号上的错误消息中添加换行符，并从下往上阅读。

您的错误信息是：

*   System.Windows.Data 错误：40：
    *   BindingExpression 路径错误：在“对象”“IncrementingTextBox”（名称=“video_length_textbox”）上找不到“ConfigurationModel”属性。
    *   BindingExpression:Path=ConfigurationModel.DontUseSensorLength;
*   DataItem='IncrementingTextBox' (Name='video_length_textbox');
*   目标元素是'IncrementingTextBox'（名称='video_length_textbox'）；
*   目标属性是“IsEnabled”（类型“布尔”）

这可以从下往上解读为：

*   绑定失败是`IsEnabled`类型元素的属性`IncrementingTextBox`（名为 video_length_textbox）。

*   元素的`DataItem`( `DataContext`) 是一个`IncrementingTextBox`名为 video_length_textbox的对象

*   它试图找到的绑定表达式是`ConfigurationModel.DontUseSensorLength`

*   绑定的问题是`ConfigurationModel`在数据上下文对象上找不到该属性`IncrementingTextBox`

因此，您的`DataContext`for "video_length_textbox" 设置为自身，并且您的`IncrementingTextBox`类没有名为的公共属性`ConfigurationModel`

由于我没有看到您在 XAML 中`DataContext`为您的任何位置设置，请查看您的课程的代码。最可能的情况是您在构造函数中将 DataContext 设置为自身`IncrementingTextBox``IncrementingTextBox`

```
this.DataContext = this; 
```

或 XAML

```
DataContext="{Binding RelativeSource={RelativeSource Self}}" 
```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2016-04-27T18:00:13.943

我遇到了同样的问题，因为我从中提取数据的对象类没有得到；并设置；关于它的属性。

这没有用：

```
public string Name; 
```

但这有效：

```
public string Name{ get; set; } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-01-08T09:03:27.710

我有类似的经历，Combobox 上的 ItemsSource 绑定不起作用。

就我而言，这是一个小错误，但在我启用跟踪消息之前很难跟踪。

我只是忘记将我的列表变成一个属性:(

```
// NOPE:
public List<string> Versions;
// YEP:
public List<string> Versions { get; set; } 
```

也许这可以帮助某人...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-01-20T22:28:39.837

```
public Window()
{
      this.DataContext = this;
      InitializeComponent();
}
public string Name {get;}
//xaml
<TextBlock Text="{Binding Name}"/> 
```

属性`Name`应该是`public`和`{ get; }`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-22T22:10:06.367

几件事情要检查

1.在构造函数中InitializeComponent之前的属性中赋值

```
 public partial class SampleClass: UserControl
{
    public SampleClass()
    {
        ScenarioHeight = System.Windows.SystemParameters.WorkArea.Height - 350;
        InitializeComponent();           

    }

    public double ScenarioHeight  { get;set;} 
```

2.如果它是用户控件，请确保将 userControl 添加为绑定中的元素

```
 <ScrollViewer Name="sv" Height="{Binding Path=ScenarioHeight, ElementName=ucSampleClass}" > 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-17T13:07:24.097

我遇到了同样的问题，就我而言，我使用`bool`的是`Boolean`. 我一更改它，它就按预期工作。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-11T18:58:46.277

当您之前尝试使用 XAML 属性绑定不可访问或不存在的 Enumerable 实例时，也可能会发生此错误`<ItemsSource>`

当您`ItemsSource`使用正确的值更正 时，XAML 不会自动重新初始化项目集合。

因此，当我使用`ListBox`UI - 列表表示时，我在属性中遇到了这个问题：

[![在此处输入图像描述](https://i.stack.imgur.com/lqGpd.png)](https://i.stack.imgur.com/lqGpd.png)

删除集合中的所有项目并更正`ItemSource`价值是关键。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-30T19:01:44.897

在查看了 Shahid 的答案后，我注意到在我的案例中，我将 设置为事件`DataContext`中的引用`Loaded`而不是构造函数中的引用。将其移至构造函数解决了该问题。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-07-17T18:39:41.440

我遇到了这个错误，我的情况就像将我绑定的字符串从私有设置为公共一样简单。

写我的支持字段的粗心错误。

# javascript - 单击气泡以按顺序显示列表项 - 在 IE8 中不起作用

> ID：16173873
> 
> 赞同：0
> 
> 时间：2013-04-23T15:52:29.490
> 
> 标签：javascript, jquery, html, internet-explorer-8

我的 HTML 中有一个带有多个引号的列表。我还有一个名为“speech”的 div，它的样式看起来像一个气泡。

当程序运行时，第一个引号显示在气泡中，当它被单击时，它会跳过引号列表。

我的问题是，在 IE8 中，气泡中没有显示任何内容，我无法弄清楚原因。有人可以告诉我我是否做错了什么，或者建议我如何做得更好。

这是清单...

```
<ul class="facts">
        <li>
            <span>What goes ho-ho whoosh, ho-ho whoosh?<br/>Santa caught in a revolving door.</span>
        </li>
        <li>
            <span>Whats white and goes up? <br/> A confused snowflake.</span>
        </li>
        <li>
            <span>Which Christmas carols do parents like best? <br/> Silent Night.</span>
        </li>
        <li>
            <span>How did the snowman get to school?<br/>On his icicle.</span>
        </li>
        <li>
            <span>What do you call a three-legged donkey?<br/> A wonkey.</span>
        </li>
</ul> 
```

这是脚本...

```
jQuery.fn.extend({
rnditem : function(l) {
    var a = [],
        current = jQuery(this).html().trim(),
        index,
        next;

   Array.prototype.forEach.call(l, function(item) {
        a.push(jQuery(item).html()
               jQuery.trim();
   });

   index = a.indexOf(current) + 1;
   if (index < 0 ||  index >= l.length) {
       index = 0;
   }

   next = (l.eq(index).html());

   jQuery(this).html(next);

  return this;
   }
});

    jQuery(document).ready(function () {

var list = jQuery(".facts").find("li");

jQuery(document.body).on('click','.speech', function () {

jQuery(this).rnditem(list);
});

jQuery(".speech").trigger("click");

}); 
```

小提琴：http: [//jsfiddle.net/S79qp/425/](http://jsfiddle.net/S79qp/425/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:57:18.533

看着小提琴，我看到的代码与上面发布的不同。

下面的行

```
current = jQuery(this).html().trim(), 
```

和

```
a.push(jQuery(item).html().trim()); 
```

会抛出一个类似的错误

> 对象不支持属性或方法“修剪”

因为IE8没有内置trim，所以使用[`jQuery.trim()`](http://api.jquery.com/jQuery.trim/)

# delphi - 汇编中的GetThreadID

> ID：16173878
> 
> 赞同：11
> 
> 时间：2013-04-23T15:52:44.310
> 
> 标签：delphi, x86, inline-assembly, fastmm

我阅读了 FastMM4 的源代码，并注意到了这个有趣的功能

```
function GetThreadID: Cardinal;
{$ifdef 32Bit}
asm
  mov eax, FS:[$24]
end;
{$else}
begin
  Result := GetCurrentThreadID;
end;
{$endif} 
```

我已经对其进行了测试，并且它有效，所以我的问题是任何解释它为什么有效？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T16:05:35.550

x86 寄存器 FS 指向 Windows 中的[线程信息块](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)。TIB 中地址 FS+0x24 的值包含当前线程的 ID。通过将值移动到用于传递函数返回值的eax，GetThreadID返回当前线程ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:02:18.767

此方法使用存储在[线程环境块中的信息](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)

# php - 基于 SRC 属性的唯一文件名

> ID：16173880
> 
> 赞同：0
> 
> 时间：2013-04-23T15:52:48.920
> 
> 标签：php, md5, unique

在我的项目中，我有从其他域链接的图像

```
<img src="http://www.somewhere.com/images/whatever-image.jpg"> 
```

我想使用**基于其原始 src 属性**的某个名称在本地重新保存它，以便稍后检查我是否已经在本地保存了此图像。我的问题是，当我在*src* -attribute上使用*md5()时，它是唯一的吗？*例子：

 *```
$src = "http://www.somewhere.com/images/whatever-image.jpg"
if (file_exists('local_path'.md5($src)) {
...
} 
```

在这种情况下我可以依靠*md5()吗？*如果没有，如何正确完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:19:46.673

在这种情况下使用 MD5 是相当安全的。快速散列时间，这使得它对于加密目的不安全，实际上是这里的一个奖励。

对于冲突的概率，例如阅读：[在 MD5 产生冲突之前有多少随机元素？](https://stackoverflow.com/questions/201705/how-many-random-elements-before-md5-produces-collisions)

另一方面，出于您的目的，只需从源属性值中删除文件路径中不允许的那些字符就足够了，即

`$localFileName = str_replace(array('/', ':'), '', $src); //may need to strip '&', too..`

这样，如果需要，文件名更易于人类阅读并且更容易进一步处理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:56:33.350

我想你可以。碰撞仍然可能发生，但这是非常罕见的可能性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:58:03.783

试一试`SHA1()`，它会碰撞不到`MD5()`。但是，除非您需要对 URL 进行模糊处理，否则您根本不需要使用这些哈希值。只需将字符串保存到数据库中的文本字段中，`url_encode()`如果需要可以运行。通过这种方式，您可以无限扩展而无需担心碰撞。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:58:46.443

将当前时间戳添加到路径。这将确保路径是唯一的。*

# php - 在子文件夹中声明文档根目录

> ID：16173884
> 
> 赞同：3
> 
> 时间：2013-04-23T15:52:56.167
> 
> 标签：php

任何人都可以帮助我使用正确的做法包括。而不是： `include('header.php');`

这是一个多页站点，我想将文件添加到其他文件夹中，例如信息文件夹。

在此信息文件夹中，我有一个名为的文件`aboutus.php`，其中包含上一个目录中的标题。

我考虑过使用该`$_SERVER['DOCUMENT_ROOT']`方法，但它似乎有点笨重，而且我的网站位于根目录的子文件夹中。所以我必须手动对子目录进行硬编码。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T16:04:41.593

这可能有点令人困惑，因为`$_SERVER['DOCUMENT_ROOT']`它由 PHP 基于 Web 服务器`Web Root`设置，由 Web 服务器（Apache 或 IIS）设置，并且`URL`在浏览器中传递和访问文件时使用与两者类似的符号。如果 web 根目录位于文件夹中的域名之上，那么如果您使用单一目录`/`来访问`root`HTML 中的目录，则可能会造成混淆。

我不会进入这些服务器配置文件，只有客户端代码中的 PHP 和 URL。

**PHP 包括**

因为 [web] 主机可以通过将您的 web 目录移动到新服务器（想想共享主机）来更改您的目录结构，或者因为您可能需要在与生产服务器不同的环境中使用开发服务器，链接到files 是使用文件的完整“硬编码”路径。

```
//Example of WORST METHOD
include('/usr/local/etc/www/html/includes/config.php'); 
```

只要您的所有文件都在文档根目录之上，或者将保留在不同服务器上的相同常规位置，您*可以*`include()`使用以前的目录表示法。**当您使用点符号设置`include()`or`require()`时，点是相对于使用符号的文件的**，因此遵循起来可能会有些棘手。

```
include('../header.php'); 
```

如果在标题内您在上一个目录中包含“config.php”，它会说：

```
include('../config.php'); 
```

实际上，真正的文件路径可能是：

```
$_SERVER['DOCUMENT_ROOT'].'/some_folder/header.php';
$_SERVER['DOCUMENT_ROOT'].'/config.php'; 
```

**最佳实践**

将包含的内容直观地保存在一个地方。如果标题位于文档根目录内的“includes”文件夹中，您可以执行以下操作：

```
$root = $_SERVER['DOCUMENT_ROOT'];
//folder for functions, headers and so forth
$includes = $root.'/includes/';
//For database passwords and other code that should
//not be above the document root.
$safe = $root.'/../safe/';

require_once($safe.'db_connect.php');
require_once($includes.'config.php');
require_once($includes.'header.php'); 
```

任何时候你需要包含一些其他文件，你只会使用`$includes`var.

以前目录表示法的另一个问题是，当您制作嵌套目录并包含相同的文件时，移动文件夹或遵循代码变得有点困难。

我一直在编辑具有以下代码的网站：

```
include ('../../../shell.php'); 
```

shell 页面不是问题......但如果你有多个配置（我也遇到过这个）。与多个开发人员一起工作可能会失控，因为在文本编辑器中打开的所有文件都说`config.php`最终会被覆盖。

```
//Site Config
include('../../config.php');

//Project Config
include('../config.php'); 
```

**客户端代码中的链接路径和 URL**

[URL](http://en.wikipedia.org/wiki/Uniform_resource_locator)和[File Path](http://en.wikipedia.org/wiki/Path_%28computing%29)是有区别的。当您使用 PHP 访问本地计算机上的文件时，最好使用文件路径。

```
$path = $_SERVER['DOCUMENT_ROOT'].'/includes/header.php'; //or
$path = '../includes/header.php';

/*or if you're on Windows*/
$path = $_SERVER['DOCUMENT_ROOT'].'\includes\header.php\; 
```

当您使用 HTML、CSS 或 Javascript 等客户端语言时，您希望使用 URL。也可以在不写出根目录上方的完整 URL 的情况下访问 URL，它看起来很相似：

```
$link = 'http://www.domain.com/css/site.css'; /*or*/
$link = '/css/site.css'; 
```

HTML、CSS 和 Javascript 中的文档根只是一个`/`字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-24T06:11:32.613

请在标题中添加以下代码行：

```
<?php $root= $_SERVER['DOCUMENT_ROOT']."../../../../";?> 
```

然后，您可以使用**$root**变量作为站点路径，以在您的站点上显示任何图像，

## 例子

如果您将图像存储在 dir (www.websit.com/data/images) 中，那么您可以使用以下代码行获取数据。

```
<img src="<?php echo $root;?>data/images" alt="your alt"/> 
```

谢谢！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-24T12:40:29.810

不久，将“持久替代”作为“W:”驱动器添加到 C:\Inetpub\wwwroot。然后将 W: 设置为“doc_root”并将其添加到 php.ini 中的“include_path”

请参阅我在根路径的完整答案[不适用于 php include](https://stackoverflow.com/questions/1400795/root-path-doesnt-work-with-php-include)。对驱动器进行 SUBSTing 还有助于调试仅客户端代码。

# c++ - 从向量中删除元素时如何减小向量的大小？

> ID：16173887
> 
> 赞同：3
> 
> 时间：2013-04-23T15:52:59.757
> 
> 标签：c++, vector, c++11, resize, splice

我正在编写一个基于输入大小限制内存的程序。假设输入大小为 1000，然后我将它们存储在大小为 1000 的向量中。稍后当我处理此向量中的数据时，每当处理完一个元素时，我将其推入我的第二个向量并使用 vector.erase从原始向量中删除它。所以我认为我总是使用 1000 大小的内存，因为这两个向量中总共存储了 1000 个元素。

但我错了，事实证明我使用了 2000 内存，因为`erase`在删除元素时不会减少向量的大小......我想它是一样的`splice`吗？

那么有没有办法让我的程序只使用 1000 个内存？我可以通过添加属性并标记元素是否已处理来解决它，但我觉得这不是最好的方法。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T17:56:39.837

这种尝试缩小容量的技术可以在 C++03 和 C++11 中使用：

```
std::vector<int> v;
// ...
std::vector<int>(v.begin(), v.end()).swap(v); 
```

这个[实时示例](http://ideone.com/S79545)包含一个演示。该技术是否有效取决于实现在使用 的元素初始化临时向量时分配了多少内存`v`。

在 C++11 中，[`shrink_to_fit()`](http://en.cppreference.com/w/cpp/container/vector/shrink_to_fit)可以调用成员函数来执行非绑定请求，以将向量的容量缩小到容纳当前容器中的元素所需的大小。

请注意，“*非约束性*”意味着标准不要求实现实际满足此要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:00:11.950

`C++11``shrink_to_fit()`为.添加了一个功能`std::vector`。如果您正在寻找一种方法来减少向量的大小，在从中删除元素之后，那将是您的选择。[这是有关它的更多信息。](http://www.cplusplus.com/reference/vector/vector/shrink_to_fit/)

# html - CSS。如何排除标签做某事？

> ID：16173891
> 
> 赞同：2
> 
> 时间：2013-04-23T15:53:07.350
> 
> 标签：html, css

每当我将鼠标悬停在它们上方时，我都会让所有图像向左移动一点。但我想排除我设置的具有特定 ID 或类的图像。我怎么做？

我的悬停代码：

```
a:hover
{
    margin-left: 6px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:54:15.813

```
.myclass:hover {
    margin-left: 0px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:54:26.907

查看`:not()`选择器[https://developer.mozilla.org/en/docs/CSS/:not](https://developer.mozilla.org/en/docs/CSS/:not)

# javascript - xsl 的 GET 请求适用于 Firefox/Opera/GoogleChrome/Safari/ 甚至 IE9，但不适用于 IE 8 或 IE10

> ID：16173892
> 
> 赞同：0
> 
> 时间：2013-04-23T15:53:11.077
> 
> 标签：javascript, xslt, html, internet-explorer-8

我正在尝试在 GET 请求中通过 JS/XSLT 填充 div。请参见下面的代码：

```
function loadXMLDoc(dname)
{
if (window.XMLHttpRequest)
  {
  xhttp=new XMLHttpRequest();
  }
else
  {
  xhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xhttp.open("GET",dname,false);
xhttp.send("");
return xhttp.responseXML;
}
    function displayResult()
    {
    xml=loadXMLDoc("Folder/data.xml");
    xsl=loadXMLDoc("Folder/data.xsl");
    // code for IE
    if (window.ActiveXObject)
      {
      ex=xml.transformNode(xsl);
      document.getElementById("reps").innerHTML=ex;
      }
    // code for Mozilla, Firefox, Opera, etc.
    else if (document.implementation && document.implementation.createDocument)
      {
      xsltProcessor=new XSLTProcessor();
      xsltProcessor.importStylesheet(xsl);
      resultDocument = xsltProcessor.transformToFragment(xml,document);
      document.getElementById("reps").appendChild(resultDocument);
      }
    } 
```

这在 Firefox/Opera/Chrome/Safari/IE9 中运行良好，但在 IExplorer 8&10 中运行良好

当我检查它在 Explorer 8 和 10 中的显示方式时，它完全忽略了代码，就好像它不存在一样，就像这样：`<div id="reps" /></div>`但在所有其他浏览器中，整个列表/表格都填充在这个 div 中就好了

现在，当我在资源管理器中单独检查 xslt 时，它工作正常并且列表就在那里。所以这似乎是一个问题，这个 JS 把它拉到 IE/S 的 div 中

有什么建议么？

提前致谢！

# javascript - 在构造函数中分配原型

> ID：16173901
> 
> 赞同：10
> 
> 时间：2013-04-23T15:53:38.380
> 
> 标签：javascript

我有这个代码：

```
var MyClass = function(b) {
    this.a = b;
    this.getA = function() {
        return that.a;
    }
}

var SecondClass = function(b) {
    this.prototype = new MyClass(b);
    this.getB = function() {
        return 6;
    }
}

var a = new SecondClass(2);
console.log(a.getA()); 
```

输出告诉我 a 没有名为 getA() 的方法

我假设在 SecondClass 的构造函数中执行 this.prototype = new MyClass() 会导致它从 MyClass 继承方法？

我确信有更好的方法可以做到这一点，但我试图了解原型关键字的行为。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-23T16:01:37.390

`prototype`是**构造函数**的特殊属性，而不是**实例**的。

当您使用 调用构造函数时`new Func()`，引擎将创建一个新对象，该对象继承自`Func.prototype`并`this`在构造函数内部设置以引用新对象。

因此，除了`this.prototype`作为普通属性之外，在分配发生时继承已经发生。

由于您没有为 分配任何方法`MyClass.prototype`，因此您不必在此处对原型继承做任何事情。您所要做的就是使用[*^([MDN])*](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Function/call)`MyClass`应用到新创建的实例：[`.call`](https://developer.mozilla.org/en/docs/JavaScript/Reference/Global_Objects/Function/call)

```
var SecondClass = function(b) {
    MyClass.call(this, b);
    this.getB = function() {
        return 6;
    }
}; 
```

* * *

但是，您应该[将实例共享的所有方法添加到原型中](https://stackoverflow.com/q/310870/218196)，然后让每个实例都`SecondClass`继承它。完整的设置如下所示：

```
var MyClass = function(b) {
    this.a = b;
}
MyClass.prototype.getA = function() {
    return this.a;
};

var SecondClass = function(b) {
    // call parent constructor (like 'super()' in other languages)
    MyClass.call(this, b);
}
// Setup inheritance - add 'MyClass.prototype' to the prototype chain
SecondClass.prototype = Object.create(MyClass.prototype);
SecondClass.prototype.getB = function() {
    return 6;
};

var a = new SecondClass(2);
console.log(a.getA()); 
```

* * *

所有这些[在 ES6 中都会变得更容易](http://wiki.ecmascript.org/doku.php?id=strawman:maximally_minimal_classes)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:57:40.747

一个名为“原型”的属性只对作为函数的对象感兴趣。在构造函数中为“原型”属性赋值无效（在这种情况下）；重要的是构造函数本身的“原型”属性。

```
SecondClass.prototype = new MyClass(); 
```

或者其他的东西。构造函数的原型对象在所有构造的实例之间共享，因此使原型因构造函数参数而异也没有多大意义。

您可以做的另一件事是从“SecondClass”内部调用“MyClass”构造函数：

```
function SecondClass(b) {
  MyClass.call(this, b);
  this.getB = function() {
    return 6;
  };
} 
```

这将具有使调用中`this`构造的 that`new SecondClass()`被“MyClass”构造函数修饰的效果。它不会真的是继承，但你会得到一个“getA”函数。

# c++ - 在类上启用 std::get 支持

> ID：16173902
> 
> 赞同：10
> 
> 时间：2013-04-23T15:53:50.153
> 
> 标签：c++, c++11, stdtuple

我必须专门使用哪些模板来支持 std::get？

```
struct MyClass {
  int a;
};

template <const size_t I>
struct MyContainer {
  MyClass array[I];
}; 
```

我必须专攻什么才能做到：

```
MyContainer<16> mc;
std::get<0>(mc); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-23T16:43:11.017

`std::get`不是标准库的定制点；三个函数模板重载（for`pair`和）不明确允许用户定义的重载，因此 17.6.4.2.1p1 适用并且添加您自己的函数模板重载的声明是未定义的行为`tuple`。`array`

请注意，`get`作为非**限定**名称*是*C++17 的自定义点；[结构化绑定声明](http://eel.is/c++draft/dcl.struct.bind#3)协议使用它来访问类似元组的元素；但这是一个非限定名称，而不是限定名称`std::get`。

也就是说，如果你*要写*：

```
namespace std {
   template<size_t I, size_t N> MyClass &get(MyContainer<N> &c) { return c.array[I]; }
} 
```

同样对于 rvalue 引用和 const 引用重载，您的程序可能会按您的预期工作。

但是，由于标准已经提供，因此没有什么意义`array`：

```
template<size_t N> using MyContainer = std::array<MyClass, N>; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T08:30:42.273

我猜你想实现一些算法，这些算法需要使用编译时索引访问任意*类似数组的*容器，因此旨在使用一些函数（如`std::get`）来统一执行该任务？！在这种情况下，它与为您的班级制作`begin`和提供相同的业务。`end`您只需`get`在声明容器类的命名空间中声明一个函数，然后让 ADL 完成它的工作。

```
 template <unsigned I, unsigned N>
    MyClass& get (MyContainer<N>& c) { return c.array[I]; }

    template <unsigned I, unsigned N>
    MyClass const& get (MyContainer<N> const& c) { return c.array[I]; } 
```

在您的算法中，您只需使用`get`（没有`std`命名空间前缀），ADL 就会调用正确的函数。因此，对于标准结构，如`array`,`tuple`和`pair` `std::get`被调用，对于您的容器`get`，您提供的函数。

```
 int main(){
        std::array<int, 3> a {{0,1,2}};
        auto t = std::make_tuple(0.0, 1.0f, 2);
        auto p = std::make_pair('0', 4.4);
        MyContainer<3> c;

        std::cout << get<1>(a) << std::endl;
        std::cout << get<1>(t) << std::endl;
        std::cout << get<1>(p) << std::endl;
        std::cout << get<1>(c).a << std::endl;

        return 0;
    } 
```

[例子](http://ideone.com/23b7iJ)

# javascript - jQuery：使用 Amount-Slider 对变化的影响

> ID：16173903
> 
> 赞同：0
> 
> 时间：2013-04-23T15:53:51.307
> 
> 标签：javascript, jquery, html, forms

我有一个表单设置，当我选择某些值时，我的项目值列表会更改。

I have a form with the values of 1 to 4 Years and when these options are selected the values in the result field change with adapted prices. 当我使用这个菜单时，它一切正常。

现在我已经安装了一个滑块（[http://jqueryui.com/slider/#hotelrooms](http://jqueryui.com/slider/#hotelrooms)）并让它与菜单一起工作，但是 jQuery 的 .change 并没有接收到滑块所做的更改。

正如您在这段脚本中看到的：

```
<script>
  $(function() {
    var select = $( "#minbeds" );
    var slider = $( "<div id='slider' style='margin-left:30px;'></div>" ).insertAfter( "#reserverer" ).slider({
     min: 1,
     max: 4,
     range: "min",
     value: select[ 0 ].selectedIndex + 1,
     slide: function( event, ui ) {
       select[ 0 ].selectedIndex = ui.value - 1;
      }
    });
    $( "#minbeds" ).change(function() {
      slider.slider( "value", this.selectedIndex + 1 );
    });
  });
 </script> 
```

它说的位：`selectedIndex + 1,`更改菜单，但这不会激活以下jQuery代码：

```
<script>
$('#minbeds').change(function(){
    if($(#minbeds).val() == '2 Years'){ 
      $("#t_1_y_1").hide('slow');
      $("#t_1_y_2").show('slow');
      $("#t_1_y_3").hide('slow');
      $("#t_1_y_4").hide('slow');
    }
   });
</script> 
```

滑块工作，菜单工作，但我怎样才能让滑块运行 jQuery 脚本？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:13:58.873

请试试这个：

```
 <script>
      $(function() {
        var select = $( "#minbeds" );
        var slider = $( "<div id='slider' style='margin-left:30px;'></div>" ).insertAfter( "#reserverer" ).slider({
         min: 1,
         max: 4,
         range: "min",
         value: select[ 0 ].selectedIndex + 1,
         slide: function( event, ui ) {
           select[ 0 ].selectedIndex = ui.value - 1;
            if(ui.value == '2') { 
              $("#t_1_y_1").hide('slow');
              $("#t_1_y_2").show('slow');
              $("#t_1_y_3").hide('slow');
              $("#t_1_y_4").hide('slow');
            }
          }
        });
        $( "#minbeds" ).change(function() {
          slider.slider( "value", this.selectedIndex + 1 );
           if($(this).val() == '2'){ 
             $("#t_1_y_1").hide('slow');
             $("#t_1_y_2").show('slow');
             $("#t_1_y_3").hide('slow');
             $("#t_1_y_4").hide('slow');
           }
        });

      });
     </script> 
```

# html - 使用灵活框布局创建通用 HTML5/CSS3 网页

> ID：16173906
> 
> 赞同：0
> 
> 时间：2013-04-23T15:53:57.200
> 
> 标签：html, css, layout, webkit

最近，我一直在阅读一些 HTML5/CSS3 教程。在其中一个教程中，他介绍了灵活盒模型。要使用它的功能，我们键入`display:-webkit-box; -webkit-box-pack:center; -webkit-box-flex:1` 我的问题是我只能在 Chrome 中使用它，但我想写一个通用的在 IE 和 Firefox 中使用此功能和其他（阴影、渐变）的 HTML5/CSS3 代码也是如此。

我尝试在网上查找，但无法为我的问题找到满意的解决方案。

有人可以提出任何建议。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:02:03.240

> 我的问题是我只能在 Chrome 中使用它

和野生动物园！哎呀。

IE 显然`-ms-box`从版本 10 开始，Firefox 支持[`display: -moz-box`](https://developer.mozilla.org/en-US/docs/CSS/-moz-box-flex)，但 MDN 文章提到弹性盒规范预计将被其他东西取代。

我认为早期浏览器版本没有任何等价物。

这是一篇关于它的旧 Mozilla hacks 文章：

*   [http://hacks.mozilla.org/2010/04/the-css-3-flexible-box-model/](http://hacks.mozilla.org/2010/04/the-css-3-flexible-box-model/)

这是我可以使用的页面：

*   [http://caniuse.com/#feat=flexbox](http://caniuse.com/#feat=flexbox)

总的来说，flexbox 对于日常使用来说似乎是个废话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:59:29.927

并非所有浏览器都支持 Flexbox。您可以使用 Flexie 作为临时解决方案：http: [//flexiejs.com/](http://flexiejs.com/)。Flexie 使用 Flexbox 的旧 (2009) 语法。

在这里可以看到浏览器对 flexbox 的支持：http: [//caniuse.com/flexbox](http://caniuse.com/flexbox)

# ruby - 如何处理具有自定义 html 属性的多选列表？

> ID：16173915
> 
> 赞同：3
> 
> 时间：2013-04-23T15:54:16.043
> 
> 标签：ruby, rubygems, cucumber, watir, watir-webdriver

```
<select class="business_group" multiple="multiple" name="SelectedBusinessGroups">
  <option value="Partners">Partners</option>
  <option value="Press">Press</option>
  <option value="ProductToolbox">Product Toolbox</option>
  <option selected="selected" value="Promotional">Promotional</option>
  <option value="Sponsors">Sponsors</option>
</select> 
```

由于命名的属性`:selected`意味着单击该选项。我想检查是否从选项列表中选择了“促销”。我怎样才能做到这一点？

我试过

```
assert @browser.option(:text => "Promotional").attribute_value("selected").exists? == true 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:32:13.793

您有几个选项可以检查所选选项。

**使用选项#selected？**

选项有一个内置方法可以告诉您它们是否被选中 - 请参阅[`Option#selected?`](http://rubydoc.info/gems/watir-webdriver/Watir/Option#selected?-instance_method)。

```
@browser.option(:text => "Promotional").selected?
#=> true

@browser.option(:text => "Press").selected?
#=> false 
```

**使用 Select#selected?**

选择列表具有用于检查是否选择了选项的内置方法 - [`Select#selected?`](http://rubydoc.info/gems/watir-webdriver/Watir/Select#selected?-instance_method)。请注意，这仅根据其文本检查选项。

```
ddl = @browser.select(:class => 'business_group')

ddl.selected?('Promotional')
#=> true

ddl.selected?('Press')
#=> false 
```

**使用 Select#selected_options**

该[`Select#selected_options`](http://rubydoc.info/gems/watir-webdriver/Watir/Select#selected_options-instance_method)方法将返回选定选项的集合。您遍历此集合以查看是否包含您想要的选项。这使您可以通过文本以外的方式检查选项。

```
selected = @browser.select(:class => 'business_group').selected_options
selected.any?{ |o| o.text == 'Promotional' }
#=> true 
```

**使用元素#attribute_value**

如果属性存在，该`attribute_value`方法将属性值作为字符串返回。如果属性不存在，则返回 nil。

```
#Compare the attribute value
@browser.option(:text => "Promotional").attribute_value("selected") == 'true'
#=> true

#Compare the attribute value presence
@browser.option(:text => "Promotional").attribute_value("selected").nil? == false
#=> true 
```

# amazon-web-services - 网站如何拥有 Amazon Nameserver 但托管在不同的服务器中

> ID：16173921
> 
> 赞同：1
> 
> 时间：2013-04-23T15:54:22.457
> 
> 标签：amazon-web-services, amazon-ec2, hosting, web-hosting, cloud-hosting

以此为例

[Zomato.com](http://zomato.com)

本站由

> NETMAGIC 数据中心

但是这个网站的NameServers如下。

```
ns-807.awsdns-36.net, ns-1061.awsdns-04.org, ns-1737.awsdns-25.co.uk, ns-496.awsdns-62.com 
```

AWS 是亚马逊网络服务。我已经知道这一点，因此我要问这个问题。

我曾经有一个带有 JustHost 的网站，并且该域的名称服务器应该是 NS1.JUSTHOST.com。（Hosting Name 和 NameServers 类似）

但是在示例案例中，网站如何使用 NetMagic Hosting 和 Amazon NameServers？

如果使用任何CDN或任何其他东西，请清楚地解释我。我对此完全陌生！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T16:10:35.800

AWS 提供其路由 53 域名服务。它不关心主机在哪里——你设置 DNS 记录，它会指向它们。

我碰巧在 AWS 路由 53 上有我的 DNS 和 Web 服务器，但你不必这样做。

事实上，你的域名可以在“A”公司注册，域名服务器由“B”公司处理，网站可以在“C”公司——不需要它们在一起，事实上有很多好的不把所有鸡蛋放在一个篮子里的理由。

[http://aws.amazon.com/route53/](http://aws.amazon.com/route53/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-22T01:06:03.010

就是这么简单。最大的 vps 托管提供商提供为用户创建自定义名称服务器，用户可以创建他们想要的任何内容。

例如：Digitalocean.com 是一家 VPS 托管服务提供商，他们的域名服务器为 ns1.digitalocean.com、ns2.digitalocean.com、ns3.digitalocean.com、ns4.digitalocean.com

但他们提供创建自定义名称服务器，您可以创建类似 ns1.yourname.com、ns-xx.yourname.com

希望您的查询现在很清楚。

# emacs - 如何在编译模式下从包跳转到堆栈跟踪错误

> ID：16173923
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:30.053
> 
> 标签：emacs, dart

我正在尝试使用*编译模式*来正确识别 Dart 中存在错误的源文件。这是一个示例堆栈跟踪。

```
Illegal argument(s): Id has invalid characters sample.xmi
#0      Id.Id (package:ebisu/src/ebisu_id/id.dart:23:7)
#1      id (package:ebisu/src/ebisu_dart_meta/meta.dart:1104:22)
#2      library (package:ebisu/src/ebisu_dart_meta/meta.dart:1108:46)
#3      Converter.convert (file:///home/user/open_source/codegen/dart/xmi/lib/xmi_to_dart.dart:44:30)
#4      main (file:///home/user/open_source/codegen/dart/xmi/lib/xmi_to_dart.dart:164:20) 
```

首先，我不确定要使用的最佳飞镖模式。我找到了这两个：

*   [https://github.com/nex3/dart-mode/blob/master/dart-mode.el](https://github.com/nex3/dart-mode/blob/master/dart-mode.el)
*   [http://dart.googlecode.com/svn/trunk/dart/tools/utils/elisp/dart-mode.el](http://dart.googlecode.com/svn/trunk/dart/tools/utils/elisp/dart-mode.el)

不确定推荐哪个？我正在尝试使用第一个，但我没有看到与编译错误支持相关的任何内容。后者有一些东西，但它不匹配（可能随着编译器消息/堆栈跟踪的发展而过时）。在这里，在我的尝试中，我将这些行添加到第一个飞镖模式文件中：

```
(require 'compile)
(add-to-list 'compilation-error-regexp-alist 'dart)
(add-to-list 'compilation-error-regexp-alist-alist 
             '(dart "(file://\\([^:]*\\):\\([0-9]*\\):\\([0-9]*\\))" 1 2 3)) 
```

因此，这确实与列为“...（file:///...）”的行匹配，并正确跳转到错误。它（或其他一些表达式）错误地识别示例'...（package：ebisu/src/...）'中的＃0堆栈帧之类的行，并留下错误类型消息“在...中查找此错误" 在 minibuffer 中要求我输入要跳转到的文件名。我想解决这个问题。所以，真的有两个问题，我不确定它是如何匹配包的，也许是其他匹配算法？其次，有没有办法匹配“#0”堆栈帧，以便它只在当前目录（CWD）中查找文件并处理文本

```
(package:ebisu/src/ebisu_id/id.dart:23:7) 
```

相当于

```
(file://CWD/packages/ebisu/src/ebisu_id/id.dart:23:7) 
```

CWD 在哪里用当前工作目录替换文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:23:05.237

如果您将[Emacs 错误 11777](http://debbugs.gnu.org/cgi/bugreport.cgi?bug=11777)中的补丁应用到 compile.el，您应该能够执行以下操作：

```
(add-to-list 'compilation-error-regexp-alist 'dart-package)
(add-to-list 'compilation-error-regexp-alist-alist 
             '(dart-package "(package:\\([^:]*\\):\\([0-9]*\\):\\([0-9]*\\))"
                            (1 "packages/%s") 2 3)) 
```

文档字符串`compilation-error-regexp-alist`提到了这种格式字符串技巧，但如果没有补丁，它似乎无法正常工作。

# powershell - Powershell用通配符重命名文件

> ID：16173927
> 
> 赞同：2
> 
> 时间：2013-04-23T15:54:34.590
> 
> 标签：powershell, rename

我怎样才能重命名这样的文件？

```
Cf.EL#131.csv.[daily_report+cf.com] 
```

其中 .com] 是扩展名。

当我尝试这个时：

```
 $file='Cf.EL#131.csv.[daily_report+cf.com]'
 Rename-Item $file pippo.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:41:22.340

在这种情况下， `Rename-Item`cmdlet 没有`LiteralPath`您需要的参数，因为文件路径中有方括号，这些方括号用于根据 POSIX 标准的字符类。因此，作为一种解决方法`Move-Item`：

```
Move-Item -LiteralPath $file -Destination pippo.txt 
```

# javascript - 尝试修复 Javascript 倒计时。我不知道我在做什么

> ID：16173928
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:37.750
> 
> 标签：javascript, timer, countdown

**帮助我 StackOVERFLOW KENOBI，你是我唯一的希望。**

所以上周我问了这个问题：

> 我需要做一个倒计时到下午 4:30 的计时器。到目前为止，我可以把它弄到下午 4 点或 5 点，但中间不能有任何分钟。我已经设法弄清楚了：

```
<script type="text/javascript">

var currentTime = new Date();
var hours = currentTime.getHours();
var minutes = currentTime.getMinutes();
var d = new Date();
var weekday = new Array(7);
weekday[0] = "Sunday";
weekday[1] = "Monday";
weekday[2] = "Tuesday";
weekday[3] = "Wednesday";
weekday[4] = "Thursday";
weekday[5] = "Friday";
weekday[6] = "Saturday";

var n = weekday[d.getDay()];

var suffix = "AM";

var hoursLeft = 16 - hours;
var minsLeft = 60 - minutes;

if (minutes < 10){ 
minutes = "0" + minutes;
 }

if (hours >= 18)
{
 document.write("Same day shipping has ended for today.");
} else

if ((n === "Saturday") || (n === "Sunday"))
{
document.write("Same day shipping is not available today.");
} else {

if (hoursLeft === 0) {
    document.write(minsLeft + " minutes left to have your order shipped today!");
} else {
    if (hoursLeft === 1) {
        document.write(hoursLeft + " hour and " + minsLeft + " minutes left to have your order shipped today!");
    } else {
    if ((hoursLeft === 0) && (minsLeft <= 30)){
    document.write(minsLeft + " minute left to have your order shipped today!");
    } else {

    if (minsLeft ===1) {
    document.write (hoursLeft + " hours and " + minsLeft + " minute left to have your order shipped today!");
    } else {

if(minsLeft===60){
minsLeft=0;
hoursLeft++;
n === "Monday";
n === "Tuesday";
n === "Wednesday";
n === "Thursday";
n === "Friday";
}

document.write(hoursLeft  + " hours and " + minsLeft + " minutes left to have your order shipped today!");
}
}
}
}
}

</script> 
```

> 我需要时间倒计时到下午 4 点 30 分，但我只知道如何更改“var hoursLeft”以将其设置为“16 小时”，这让我到下午 4 点，但不知道如何到下午 4 点 30 分。我以为我会调整“var minsLeft”，但遇到了一个奇怪的错误，开始说“还剩 2 小时 -15 分钟”之类的东西。
> 
> 有人有想法么？

幸运的是，出色的 UtopiaLtd 对此做出了回应：

> 正如上述评论者所建议的那样，在几分钟内完成您的计算。将您的小时数转换为总分钟数，并确保分钟数在您的参数范围内。
> 
> 要显示分钟，只需使用模运算符即可获取当前小时之上的分钟数。
> 
> 例如，如果还剩 185 分钟，您想显示“还剩 3 小时 5 分钟”，

```
var minutesLeft = 185;
var hours = Math.floor(minutesLeft/60);
var minStr = minutesLeft % 60;
var timeLeft = hours + " hours and " + minStr + " minutes left"; 
```

> 当然，您需要使用自己的逻辑来避免说出“1 小时”之类的话。

但问题来了，*我不知道我在做什么*，我们的技术人员离开了，而他的替代者甚至在他开始之前就辞职了。作为办公室里最书呆子的人，这已经落在了我的腿上，但我以前没有使用过 javascript。

如何将 UtopiaLtd 的解决方案插入到我的原始脚本中？讨厌成为负担，但我在这里已经脱离了我的元素。我觉得我的无能正在污染网站，但需要帮助，你们是我唯一能想到的。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:15:01.243

好的，所以......作为序言，这不是一个非常优雅的解决方案。它没有考虑时区或任何处理时间的警告。您应该研究某种可以帮助您解决此问题的插件。

不过，这应该同时对您有所帮助。将所有时间计算转换为分钟，然后进行数学运算，然后转换回小时和分钟。

```
var hours = currentTime.getHours();
var minutes = currentTime.getMinutes() + (hours * 60); //Convert current time to minutes
var d = new Date();
var weekday = new Array(7);
weekday[0] = "Sunday";
weekday[1] = "Monday";
weekday[2] = "Tuesday";
weekday[3] = "Wednesday";
weekday[4] = "Thursday";
weekday[5] = "Friday";
weekday[6] = "Saturday";

var n = weekday[d.getDay()];

var suffix = "AM";

var minsLeft = (16.5 * 60) - minutes //get total minutes remaining until 16.5 (4:30 pm)
var hoursLeft = Math.floor(minsLeft / 60); //Get how many hours are in our minsLeft
var minsLeft = minsLeft % 60; //remove the hours from the minsLeft 
```

# c++ - 如何使用在标头中定义的输出流运算符

> ID：16173929
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:38.453
> 
> 标签：c++, string, stl, log4cxx

我希望能够将任何内容附加`std::vector<T>`到输出流。我找到了这段代码：

```
#ifndef DEBUG_H_
#define DEBUG_H_

#include <vector>

template < class T >
std::ostream& operator << (std::ostream& os, const std::vector<T>& v)
{
    os << "[";
    for (typename std::vector<T>::const_iterator ii = v.begin(); ii != v.end(); ++ii)
    {
        os << " " << *ii;
    }
    os << "]";
    return os;
}

#endif /* DEBUG_H_ */ 
```

并放入标题中`Debug.h`。如何在整个项目中使用此运算符？

编辑：我已经验证这在单元测试中有效：

```
#include "Debug.h"

TEST_F(AuxGTest, testVectorDebug) {
    std::vector<int> vec(10, 42);
    std::cout << "vec: " << vec << std::endl;
} 
```

但是将它与 log4cxx 的日志语句一起使用是行不通的：

```
#include <log4cxx>
#include "Debug.h"

namespace Foo {
    class Bar { 
        void foo() {
            std::vector<int> vec(10, 42);
            DEBUG("vec: " << vec);
        }

    }

} 
```

这将导致以下编译器消息：

```
/usr/local/Cellar/log4cxx/0.10.0/include/log4cxx/helpers/messagebuffer.h:190:47: error: cannot bind 'std::basic_ostream<char>' lvalue to 'std::basic_ostream<char>&&' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:07:35.893

你想在哪里使用它？正如声明的那样，它位于全局命名空间中，因此 ADL 不会找到它，除非`T`它是在全局命名空间中定义的类型。如果您在全局命名空间以外的命名空间中，并且`operator<<`该命名空间中有一个（这会隐藏它），则不会通过正常查找找到它。如果在模板中调用它也不会找到它，如果任何参数是依赖的，因为依赖名称查找只使用 ADL。

当然，除了玩具程序，你真的不想这样做。的不同用途`std::vector`需要不同的输出格式；最好将 包装 `std::vector`在一个类中，并`operator<<`为该类定义每个不同的语义用途。（对于玩具程序，您可以在命名空间中定义运算符`std`。未定义的行为，但由于没有其他人会看到代码，或者必须维护它，如果它不起作用，它也不是世界末日...... )

## 编辑：

因为您似乎将它用于某种跟踪或调试：这是支持统一输出的一种情况`std::vector`，因为它用于输出*内部*状态。另一方面，在这种情况下，通常`ostream`会被包裹起来，例如：

```
class Logger
{
    std::ostream* myDest;
public:
    Logger( std::ostream* dest )
        : myDest( dest )
    {
    }

    template <typename T>
    Logger& operator<<( T const& value )
    {
        if ( myDest != NULL ) {
            *myDest << value;
        }
        return *this;
    }
}; 
```

这允许运行时配置日志记录（加上自动插入和之类的东西`__FILE__`，`__LINE__`如果您使用宏来获取 的实例`Logger`）；您的宏`DEBUG` 可能类似于：

```
#define DEBUG getLogger( TRACELEVEL_DEBUG, __FILE__, __LINE__ ) 
```

where`getLogger`是一个全局函数，它返回一个使用正确（或空指针，如果该级别的日志记录不是活动的）`Logger` 初始化的值。`ostream`完成此操作后，您可以添加特殊功能，例如：

```
template <typename T>
Logger& Logger::operator<<( std::vector<T> const& value )
{
    if ( myDest != NULL ) {
        //  your code here...
    }
    return *this;
} 
```

由于`<<`运算符的参数之一将是 的实例`Logger`，因此 ADL 将找到运算符，无论如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T05:39:48.550

关于 log4cxx 的用户定义运算符有一个类似的[问题。](https://stackoverflow.com/questions/5990898/how-to-overload-the-ostream-operator-to-make-it-work-with-log4cxx-in-c)我通过建议将运算符放在命名空间中来[回答](https://stackoverflow.com/a/21036353/3154588)`log4cxx::helpers`这个问题。看 。

# java - 在Java（Android）中连接具有多个值的字符串

> ID：16173934
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:42.910
> 
> 标签：java, android, concatenation

我创建了一个填充有 XMLParser 的 ListView，并且允许用户使用复选框从列表中选择多个值，然后可以通过按下按钮进入下一个活动。在活动 2 上，我想检索所有被选中的值。

要获取我使用的所有选定值：`String selected += "\n- " +c.getName();` 其中 c 是`final ConfigOptions c = options.get(position);`

我也像这样在 onCreate 方法之外声明它

```
public static String selected = null; 
```

但我有同样的问题

问题是，在活动 2 上，我得到了所有选定的值，但其中一个值为 null

> EX: null \n -Servotronic \n - 停车距离控制 \n - 限速信息

此外，如果我尝试重新打开活动 1 并再次选择新项目，则在第二个活动中，之前选择的旧活动也在那里。即使我将字符串的值设置为 null，我仍然可以将它们全部放在那里。

那么如何连接该字符串的值，以便在下一个活动中不再获得空值，并且还能够重置该值以便再次进行选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:10:17.657

您可以使用[Android`Bundle`](http://developer.android.com/reference/android/os/Bundle.html)以更好的方式完成任务。创建要传递的项目的 ArrayList，将 ArrayList 添加到`Bundle`并`Bundle`在`Intent`调用中发送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:19:32.557

当用户想去活动 2 时，制作一个字符串数组来保存所选项目的数量。将其作为额外内容添加到您启动 Activity 2 的意图中。

```
int count = // get number of selections
String[] options = new String[count];
for (int i = 0; i < count; i++) {
    options[i] = // ith selection
}
Intent intent = new Intent(this, Activity2.class);
intent.putExtra("options", options);
startActivity(intent); 
```

在 Activity 2 的 onCreate 中：

```
String[] options = getIntent.getStringArrayExtra("options");
if (options != null) {
    // process the strings here.
} 
```

# grails - 如何通过 GORM 中的“in”子句计算记录数

> ID：16173937
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:49.803
> 
> 标签：grails, grails-orm

我想运行类似于以下的 sql 查询：

`SELECT count(*) from WORDS where wordId in (4,5,6)`

我怎样才能在 Gorm 中写这个？我知道 grails 有`countBy*`，但我不能将多个值传递`[4,5,6]`给它。

我应该使用`execute`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T03:34:09.130

您还可以`rowCount`在计算结果行数的预测中使用。注意`id`为`Long`

```
Words.createCriteria().get {
  'in'('id', [4,5,6]*.toLong()) //or [4L, 5L, 6L]
  projections {
    rowCount()
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:02:23.033

您可以使用[投影](http://grails.org/doc/latest/ref/Domain%20Classes/createCriteria.html)。

```
Words.createCriteria().get {
  'in'('id', [4,5,6])
  projections {
    count('id')
  }
} 
```

# spring - cvc-complex-type.2.4.c：匹配通配符是严格的，但找不到元素“util:properties”的声明

> ID：16173940
> 
> 赞同：0
> 
> 时间：2013-04-23T15:54:52.773
> 
> 标签：spring, xsd

我的弹簧配置文件是这样的

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">
.
.
.
<util:properties id="mailProperties">
        <prop key="mail.smtp.auth">${mail.smtp.auth}</prop>
        <prop key="mail.smtp.starttls.enable">${mail.smtp.starttls.enable}</prop>
        <prop key="mail.smtp.quitwait">${mail.smtp.quitwait}</prop>
        <prop key="mail.smtp.debug">${mail.smtp.debug}</prop>
    </util:properties> 
```

我在配置 xml 文件中遇到以下错误

```
schema_reference.4: Failed to read schema document 'http://www.springframework.org/schema/util/spring-util-3.0.xsd', because 1) could not find the document; 2) the document could not be read; 3) the root element of the document is not <xsd:schema>. 
```

让我知道需要做什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T18:54:44.910

尝试去掉所有 .xsd 前面的 -3.0。我遇到了这个愚蠢的错误，删除版本有效 版本号对我有用。

我不能告诉你为什么会这样。如果您查看 org.springframework.beans-3.1.2.jar（例如）并找到 META-INF/spring.schemas，您会发现所有这些

```
 http\://www.springframework.org/schema/util/spring-util-2.0.xsd=org/springframework/beans/factory/xml/spring-util-2.0.xsd
http\://www.springframework.org/schema/util/spring-util-2.5.xsd=org/springframework/beans/factory/xml/spring-util-2.5.xsd
http\://www.springframework.org/schema/util/spring-util-3.0.xsd=org/springframework/beans/factory/xml/spring-util-3.0.xsd
http\://www.springframework.org/schema/util/spring-util-3.1.xsd=org/springframework/beans/factory/xml/spring-util-3.1.xsd
http\://www.springframework.org/schema/util/spring-util.xsd=org/springframework/beans/factory/xml/spring-util-3.1.xsd 
```

您会在那里找到模式，所以 XML 解析器为什么会抱怨对我来说是个谜。

# time - 如何在 FQL where 子句中使用时间

> ID：16173941
> 
> 赞同：1
> 
> 时间：2013-04-23T15:54:59.033
> 
> 标签：time, facebook-fql, where, status

我有以下查询来选择上周用户朋友的状态：

```
SELECT status_id, uid, message, time from status where uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND time > 1366038021 
```

（1366038021 是一周前我进行查询的时间）

这将返回 7 个结果，但它缺少我的一位朋友的两个最新结果（发生在我过滤时间之后。）如果我删除 time 子句，我会得到我缺少的两个结果，总共 9 个结果. 他们的时间是**1366660761**和**1366662471**，它们**> 1366038021**所以他们应该总是出现，但他们没有。如果我将子句更改为`time > 0`它也会返回 9 个结果。如果我更改为，`time > 1`我会得到一个空的结果集。如果我将其更改为`time > 1366138021`我得到所需的 9 个结果...

现在，我阅读了许多其他帖子，解释了 FB 过滤结果的方式。我知道如果我在那里有一个限制 X，它会抓取 X 结果，通过可见性过滤并返回 Y 结果而不是 X。我看不出这里是怎么发生的。我对一件事没有限制（甚至将一个大量放入其中也不会改变任何事情。）另外，我为此使用了一个测试帐户，而且我只有 2-3 个朋友，每个朋友都有几个状态. 因此，我没有一些被过滤的大型结果集。

有没有人遇到过这样的事情？我错过了什么吗？

# php - 下载文件 php

> ID：16173944
> 
> 赞同：2
> 
> 时间：2013-04-23T15:55:05.690
> 
> 标签：php, codeigniter

我有一个 Codeigniter 函数，它将一些数据放入要下载的文件中。

```
$data= "test";

header('Content-Disposition: attachment; filename=test.file');

echo $data; 
```

但是，内容包括我单击以激活该功能的那个视图的 HTML。如何删除文件中 HTML 的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:02:32.380

仅为文件创建一个单独的控制器/视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T08:32:59.423

在控制器中创建方法

示例代码：

```
 public function download_file($name)
    {
        $data = file_get_contents(FCPATH . 'storage' . DIRECTORY_SEPARATOR. $name); // Read the file's contents

        force_download($name, $data);
        redirect('index/index');
    } 
```

从视图页面调用上述方法

# objective-c - Xcode 约束？

> ID：16173945
> 
> 赞同：1
> 
> 时间：2013-04-23T15:55:05.990
> 
> 标签：objective-c, xcode, constraints

我正在尝试理解和使用 Xcode 的约束功能。如果您有几个视图，我可以看到它是如何真正有用的，因为您可以真正指定每个视图应该如何对齐。

但是，如果您有很多视图，这将成为一项乏味的任务，尤其是如果您开始以编程方式处理它们（例如移动它们）。例如下图：

![风景](https://i.stack.imgur.com/34JYQ.png)

当我扩大和缩小屏幕时，我希望它看起来像这样，但唉，事实并非如此。此外，由于它们不断对齐以彼此相邻，因此如果我以编程方式移动一个（就像我正在制作游戏一样），另一个会无意中随之移动。

所以基本上，当在屏幕上显示相当多的视图对象+在代码中移动它们时，我到底应该如何处理约束？非常感谢任何提示！（是的，我尝试一次为每个视图添加/删除约束，首先，这是一项乏味的任务，其次，它不断为视图添加约束以使它们彼此对齐，而你很少想要那个在你移动它们的游戏中）。

提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-09T14:19:57.497

您可以尝试更新约束，而不是一直删除和添加它们。您可以创建`IBOutlets`所有需要更改的约束，然后可以通过更改`constant`值来更新它们

```
[self.heightConstraint setConstant:newValue]; 
```

然后，您可能需要在动画块中调用`[self layoutIfNeeded]`，以查看更新约束后的更改：

```
[UIView animateWithDuration:0.5 animations:^{
    [self layoutIfNeeded];
}]; 
```

我真的不知道你的应用程序的细节，但也许如果你从视图如何相互关联的角度考虑约束，也许移动它们不会那么困难。

另一个想法是将视图组合在一个`UIView`子类中。也许像`RowView`这样的东西有 3 个图像并只为这些图像处理约束。

我的意思是类似于“分而治之”，不是在一个视图中处理所有约束，而是将它们组合在一起，以一种对您的应用程序有意义的方式。

希望这可以帮助！祝你的项目好运。

# joomla - 在 Joomla 中按文章或组件创建表单！3

> ID：16173949
> 
> 赞同：1
> 
> 时间：2013-04-23T15:55:22.507
> 
> 标签：joomla, components, article

我是 Joomla 的新手。我知道我们可以在 joomla 中创建类似“创建文章”的表单！. 但是，我们也可以通过使用 MVC 方法创建组件来创建表单。有什么不同？如果我们可以在 Joomla 的文章上编写代码，有人可以向我解释为什么我们需要一个组件！?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:07:37.063

如果您需要 Joomla 中的表单，则不能将其作为标准内容项。编辑不允许这样做，填写表格也无济于事。如果您只是在谈论简单地编写一个平面 html 文件并链接到它，那么您有点错过了使用 CMS 的全部意义，并且将来维护它会很麻烦。

如果您只需要在人们填写表单时发送一封电子邮件，那么您应该能够使用以下表单构建器之一：

[http://extensions.joomla.org/extensions/contacts-and-feedback/forms](http://extensions.joomla.org/extensions/contacts-and-feedback/forms)

如果您需要存储和使用输入的数据，您可能需要构建自己的组件。如果您有 PHP 开发经验，则可以使用 Component Creator：

[http://www.notwebdesign.com/joomla-component-creator/](http://www.notwebdesign.com/joomla-component-creator/)

# meteor - 在 Meteor 中，在一切之前立即执行 JS

> ID：16173956
> 
> 赞同：0
> 
> 时间：2013-04-23T15:55:50.663
> 
> 标签：meteor

我在 IE7 中使用 Meteor 应用程序时遇到了很多问题。这可能是由于至少一个 Meteorite 包（尤其是我怀疑的路由器，它特别不支持 IE7）。我收到了几个 JavaScript 错误，并且加载了一个带有空标签的空白页面。

IE7 错误仅影响 1% 的用户，但我只是讨厌某些人会访问该站点并看到一个空白页面而没有其他内容的想法，并认为这是一个糟糕的或一夜之间的项目。

我试图显示一个我写的简短页面，解释不支持 IE7 及更低版本，用户可以升级她的浏览器，或使用 Chrome Frame。如果您点击`<myapp>/noie.html`，您可以看到它，因为它保存在`public/`文件夹中。

但是，在应用程序的其余部分崩溃之前，我找不到任何方法来重定向到该页面，因此我的重定向代码永远不会运行（无论如何在生产中，它在我的机器上运行）。我试过把它放在一个文件中`lib/`，我试过使用`Meteor.startup()`*，我同时做了两个！但最终，当您在浏览器中点击 url 时，Meteor 开始行动，开始加载依赖项，并且沿线的某个地方，一切都中断了。

如果我可以让重定向代码成为最先运行的东西之一，那么一切都会好起来的。

*this 似乎是从 调用的`client_startup.js`，它专门等待 DOM 在这样做之前准备好。它在获取我的代码之前进行路由、渲染模板等，这对我来说太晚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T14:35:43.450

我想我知道该怎么做了。您可以通过单击 Meteor 页面（在开发模式下提供）上的“查看源代码”来查看脚本的加载顺序。一般来说，它似乎是：

1) Meteor 自带的包

2) 你的包裹，即那些在`smart.json`

3) 已在 .js/.coffee 文件中某处传递给 Meteor.startup() 的函数

4) 其余的 .js/.coffee 文件，按照[Structuring Your App中记录的顺序](http://docs.meteor.com/#structuringyourapp)

对我来说最关键的是，`smart.json`文件和生成`.meteor/packages`文件的顺序似乎也决定[了包的加载顺序](https://github.com/tmeasday/meteor-router#internet-explorer-8-support)。

我现在的计划是编写我自己的小智能包，它可以检测 IE7 或更低版本并进行重定向。我会将它`packages`作为第一项放入，因此它会在路由器或其他任何可能导致应用程序在 IE7 上崩溃的东西之前运行。将更新说是否可行。

更新：成功了！我已经在 Atmosphere 上[发布了这个包，虽然很简单。](https://atmosphere.meteor.com/package/redirect-ie-7-lower)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T22:01:36.460

如果你愿意改变你的 Meteor 源，你可以去这里

[https://github.com/meteor/meteor/blob/release/0.6.2/tools/server/server.js#L304](https://github.com/meteor/meteor/blob/release/0.6.2/tools/server/server.js#L304)

并检查`request.browser`，然后如果不支持浏览器，则返回您自己的“抱歉，不支持此浏览器”HTML 而不是常规应用程序 html。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-20T14:13:16.720

相关问题在这里：[Meteor Script Loading Order](https://groups.google.com/forum/#!topic/meteor-talk/T5faBwYCBDE)。解决方案是使用[Inject-initial](https://github.com/gadicc/meteor-inject-initial/)。（您的脚本/内容将绝对是一开始，甚至在流星核心之前）

# grails - 使用 Ember.js 和 Handlebars.js 实现 Grails 国际化

> ID：16173957
> 
> 赞同：2
> 
> 时间：2013-04-23T15:55:52.087
> 
> 标签：grails, internationalization, ember.js, handlebars.js

我正在开发一个 Web 应用程序，我需要一些关于如何解决以下国际化“问题”的建议。

我使用`Grails 2.2.0`with `Ember.js`and`Handlebars.js`而前端（通过 JavaScript 和前面提到的框架实现）驻留在项目中，其中包含用于编译整个事物`Sass`的样式文件。`Grunt.js`

在这个“前端项目”中，我创建了`handlebars`我想要`Grails`按需交付的模板，模板的全文`Grails`根据登录用户的语言环境通过服务器端 ( ) 进行国际化。因此，工作流程将类似于以下内容：

1.  客户端 (JS) -> 请求后端 (Grails)

2.  后端控制器检查用户是否有权访问此方法，检查`locale`用户的集合，使用正确的文件预编译相应的`template`（车把）`i18n`，获取所需的`data`并返回一个`JSON`带有`data`和`tmpl`值的对象

3.  后端 (Grails) 对客户端 (JS) 的响应

4.  客户端获取模板，如果可能，将其缓存并使用给定的数据集对其进行编译以放置

这个问题有合适的`Grails`插件吗？如果我在 Grails 插件页面上搜索“车把”，我会得到 3 个匹配项：

*   车把插件
*   车把资源插件
*   EmberJS 模板预编译器插件

我通读了所有这些插件的文档，但我仍然不确定这些插件中的任何一个是否可以用于我正在寻找的东西。我想这样做的原因是，我有`i18n`至少 12 种不同语言的非常大（我的意思是非常大）的文件，我不想发送给客户本身......

有没有人有同样的问题/问题/挑战，可以为我提供一些关于这个话题的信息？还是我的方法完全是胡说八道，我应该尝试另一种方法？

# grails - Grails GORM 一对多问题

> ID：16173958
> 
> 赞同：0
> 
> 时间：2013-04-23T15:55:54.400
> 
> 标签：grails, grails-orm

我有 2 个域模型

```
class Project {
    static hasMany = [quotes:Quote]
}

class Quote {

} 
```

问题：

当我删除项目时，我需要删除与该项目关联的所有引号。我怎样才能实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:59:38.573

在您的 Quote 课程中，我会添加：

```
static belongsTo = [project: Project] 
```

# regex - Sed 使用正则表达式从文件中删除时间戳

> ID：16173962
> 
> 赞同：1
> 
> 时间：2013-04-23T15:55:59.977
> 
> 标签：regex, linux, bash, sed

我正在尝试使用 sed 从 html 文件中删除模式。时间戳由一个 1-2 位数字、一个四个字母的单词和前一个单词组成

例子：

```
25 mins ago 
```

或者：

```
1 hour ago 
```

等等。我试过像这样使用 sed：

```
sed -i "s/([0-9]{1,2}) [a-z]* ago//g" 
```

Sed 什么都不做，我不确定我的正则表达式是否错误，或者我是否没有以正确的方式转义字符。

编辑：我通过删除额外的空格来修复该表达式，谢谢 choroba。现在 sed 从文件中删除大部分文本。表达式需要不那么贪婪吗？还应该提到，时间戳被`> <` 示例包围：

```
>1 hour ago< 
```

编辑：这对我有用。谢谢拉沃里。

```
sed -i 's/[0-9]\{,2\} [[:alpha:]]\{4,5\} ago//g' 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:12:04.407

试试下面的。您需要转义量词元字符`{`并`}`使用`sed`

```
echo "1 hour ago" | sed  's/[0-9]\{,2\} [[:alpha:]]\{4\} ago//g' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:59:51.123

```
 echo "1 hour ago" | sed -e 's/.*ago$//g' 
```

或者

```
 sed -e 's/.*ago$//g' <filename> 
```

`ago`这应该删除任何以in结尾的行`filename`

如果除了以 .结尾的时间戳之外还有其他行，您可能不想使用它`ago`。你没有具体说明。

# php - AJAX 联系表单上的错误检查

> ID：16173964
> 
> 赞同：0
> 
> 时间：2013-04-23T15:56:04.447
> 
> 标签：php, ajax, forms, contact

我的网站上有一个 ajax 驱动的联系表，链接[在这里](http://daniloportal.com/NPC1/contact.html)

我有两个问题。

首先，我不确定为什么名称字段的错误检查不起作用，我的代码似乎是正确的（逻辑明智）但它仍然没有触发。

其次，我不知道如何在表单中添加更多字段。例如，添加`Company Name`用户输入和发送电子邮件。我尝试添加像`$company`下面的代码这样的值，但我得到这个错误，我无法将这么多变量传递到`$mail`：/尝试通过反复试验学习，感谢任何帮助！

这是我的代码：

```
<?php

include dirname(dirname(__FILE__)).'/mail.php';

error_reporting (E_ALL ^ E_NOTICE);

$post = (!empty($_POST)) ? true : false;

if($post)
{
  include 'email_validation.php';

  $name = stripslashes($_POST['name']);
  $email = trim($_POST['email']);
  $subject = 'Contact Form: Inquiry from corporate website';
  $message = stripslashes($_POST['message']);

  $error = '';

  // Check name

  if(!$name || strlen($name) < 1)
  {
    $error .= 'Please enter your name.<br />';
  }

  // Check email

  if(!$email)
  {
    $error .= 'Please enter an e-mail address.<br />';
  }

  if($email && !ValidateEmail($email))
  {
    $error .= 'Please enter a valid e-mail address.<br />';
  }

  // Check message (length)

  if(!$message || strlen($message) < 10)
  {
    $error .= "Please enter your message. It should have at least 10 characters.<br />";
  }

  if(!$error)
  {
    $mail = mail(CONTACT_FORM, $subject, $message,
     "From: ".$name." <".$email.">\r\n"
    ."Reply-To: ".$email."\r\n"
    ."X-Mailer: PHP/" . phpversion());

    if($mail)
    {
      echo 'OK';
    }

  }
  else
  {
    echo '<div class="notification_error">'.$error.'</div>';
  }

}
?> 
```

这是我连接到 php 的 html 表单：

```
<form id="contactForm" action="">
  <input type="text" name="name" value="Name *" title="Name *" />
  <input type="text" name="email" value="Email *" title="Email *" />

  <textarea name="message" id="message" title="Message *">Message *</textarea>

  <div class="clear"></div>

  <input type="reset" class="btn btn_clear" value="Clear form" />
  <input type="submit" class="btn btn_blue btn_send" value="Send message!" />
  <div class="clear"></div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:01:13.183

关于名称的验证：

不要做

```
if(!$name || strlen($name) < 1)
{
    $error .= 'Please enter your name.<br />';
} 
```

改为这样做：

```
if((!(isset($_POST['name'])) || strlen($name) < 1)
{
    $error .= 'Please enter your name.<br />';
} 
```

如果 $name 未定义，strlen 不会做太多事情。但是在尝试对发布的名称执行 strlen 之前，您实际上应该这样做。

另外，你不能添加

```
$company 
```

进入

```
$mail 
```

函数，因为您很可能将其用作 mail 函数的参数，而不是将其附加到 $message 变量中。

你也应该缩进你的代码，这太可怕了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:04:27.513

这就是放入 mail.php 的内容，这就是为什么有一个 CONTACT_FORM

```
<?php
   // Where will you get the forms' results?
      define("CONTACT_FORM", 'dannyisaninja@gmail.com');
?> 
```

# javascript - 为浏览器的窗口最小化设置最小大小限制？

> ID：16173965
> 
> 赞同：22
> 
> 时间：2013-04-23T15:56:05.577
> 
> 标签：javascript, html, css, browser, cross-browser

有没有办法在所有浏览器中手动设置浏览器窗口的最小尺寸？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-23T16:03:42.647

你可以试试

```
body {  min-width:600px; } 
```

一旦视口小于 600 像素，您将获得一个水平滚动条。这仅适用于支持 min-width CSS 属性的现代浏览器。

我认为不可能限制用户调整大小，也不应该！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-04-23T16:07:42.467

您必须使用 Javascript 并创建有问题的窗口才能在大多数情况下工作，因为选项卡式浏览器不会让您重新定义包含其他选项卡的窗口的大小。即使那样，一些浏览器也不会让你这样做。

使用[`window.open`](https://developer.mozilla.org/en/docs/DOM/window.open)，您可以通过指定来制作大小为 640 * 480 的给定窗口：

```
window.open('http://www.your.url/','yourWindowsName','width=640,height=480'); 
```

在窗口中，您可以尝试[`resizeTo`](https://developer.mozilla.org/en-US/docs/DOM/window.resizeTo)由事件处理程序触发的高度和宽度`resize`，如下所示：

```
function resizeToMinimum(){
  var minimum    = [640, 480];
  var current    = [window.outerWidth, window.outerHeight];
  var restricted = [];
  var i          = 2;

  while(i-- > 0){
    restricted[i] = minimum[i] > current[i] ? minimum[i] : current[i];
  }

  window.resizeTo(current[0], current[1]);
}

window.addEventListener('resize', resizeToMinimum, false) 
```

您应该考虑到上述两种行为都是有争议的，并且您所描述的内容有效地限制了用户使用他们认为合适的浏览器的自由。因此，我不希望它在任何地方都能工作——但在它工作的地方，这是允许你这样做的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-13T10:41:03.657

```
function resizeToMinimum(w,h){
    w=w>window.outerWidth?w:window.outerWidth;
    h=h>window.outerHeight?h:window.outerHeight;
    window.resizeTo(w, h);
};
window.addEventListener('resize', function(){resizeToMinimum(100,100)}, false) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-03T06:05:14.067

这是我确保实际最小内容宽度和高度的解决方案，其中包括处理不同浏览器的“chrome”尺寸。这不适用于 Firefox，但我已经在 Edge 和 Chrome 中对其进行了测试。

```
function ensureMinimumWindowSize(width, height) {
    var tooThin = (width > window.innerWidth);
    var tooShort = (height > window.innerHeight);

    if (tooThin || tooShort) {
        var deltaWidth = window.outerWidth - window.innerWidth;
        var deltaHeight = window.outerHeight - window.innerHeight;

        width = tooThin ? width + deltaWidth : window.outerWidth;
        height = tooShort ? height + deltaHeight : window.outerHeight;

        // Edge not reporting window outer size correctly
        if (/Edge/i.test(navigator.userAgent)) {
            width -= 16;
            height -= 8;
        }

        window.resizeTo(width, height);
    }
}

var resizeTimer;
window.addEventListener('resize', function(event) {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function () {
        ensureMinimumWindowSize(<width>,<height>);
    }, 250);
}, false); 
```

# database - 如何将某些值（包括从另一个表中提取的客户 ID）插入到单独的表中

> ID：16173969
> 
> 赞同：0
> 
> 时间：2013-04-23T15:56:21.287
> 
> 标签：database, vb.net, ms-access, insert

好的，所以我正在为 VB.net II 做我的最后一个项目。我为酒店住宿情况创建了一个项目，并且一切正常。但是，我需要帮助来添加一些东西。

我把它送到你的新客人/客户或回头客的地方。如果您是新的，当您提交表单时，它会将客户信息添加到数据库中。我的 Access 数据库有 2 个表：**Customer**和**CustomerStays**。

现在，它们的主键是一个名为：**CustomerID**的字段 ，它们在数据库本身中具有联系在一起的关系。

**Customer 表**的字段包括：**CustomerID**、**CustomerName**、**CustomerAddress**、**CustomerZipcode**和**CustomerTagNumber**

**CustomerStays 表**的字段包括：**CustomerID**、**CustomerDateIn**、**CustomerDateOut**和**TotalDays**

这是我的主要形式的图像：![主表格](https://i.stack.imgur.com/GRLtR.jpg)

当他们点击total for stay时，这里是通过它的代码

```
 Private Sub TotalForStayBtn_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles TotalForStayBtn.Click

    ErrorChecking() 'Sub routine that checks for errors

    If YourGood = True Then 'Only good if you pass the error check

        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
        ''''''''''''''''ADDING CUSTOMER INFORMATION TO THE DATABASE''''''''''''''''
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        If ExistingCustomer = False Then

            Try

                myconnection.Open()

                Dim str As String

                str = "SELECT * FROM Customer WHERE CustomerTagNumber='" & CustomerTagNumbertxt.Text & "'"

                Dim cmd As OleDbCommand = New OleDbCommand(str, myconnection)

                dr = cmd.ExecuteReader

                If dr.Read Then

                    If MsgBox("That license plate tag number already exists. Are you an existing customer?", MsgBoxStyle.YesNo) = MsgBoxResult.Yes Then

                        ReturningCustomerLookup.Show()
                        Me.Close()

                    ElseIf MsgBoxResult.No Then

                        MessageBox.Show("Please re-enter your own license plate tag number and verify that it is entered correctly.")

                    End If

                Else

                    str = "INSERT INTO Customer (CustomerName, CustomerAddress, CustomerZip, CustomerTagNumber)" _
                        & " VALUES ('" & CustomerNametxt.Text & "','" _
                        & CustomerAddresstxt.Text & "','" _
                        & CustomerZipCodetxt.Text & "','" _
                        & CustomerTagNumbertxt.Text & "')"

                    cmd = New OleDbCommand(str, myconnection)
                    cmd.ExecuteNonQuery()
                    MessageBox.Show("Your information has been successfully added to the database", "Successful")

                    '''''''CALCULATING THE TOTAL'''''''
                    CalculateTotal()
                    '''''END CALCULATING THE TOTAL'''''

                    '''''''ADDING DATES INFO TO DATABASE'''''''
                    **CustomerStaysInsertion()**
                    '''''END ADDING DATES INFO TO DATABASE'''''

                End If

            Catch ex As Exception
                MessageBox.Show("There was an error inserting your information into the database" _
                                & vbCrLf & vbCrLf & "Original Error: " & ex.ToString, _
                                "Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
            Finally
                myconnection.Close()
            End Try

            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
            ''''''''''''''END ADDING CUSTOMER INFORMATION TO THE DATABASE''''''''''''''
            '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

        Else

            '''''''CALCULATING THE TOTAL'''''''
            CalculateTotal()
            '''''END CALCULATING THE TOTAL'''''

        End If

    End If

End Sub 
```

现在我的问题是**CustomerStays**信息。它运行子例程，我想要它做的是使用客户的信息来获取**Customer**表中的**CustomerID**，并将 AS **CustomerID**连同他们签入和签出的日期以及总数一起放在**CustomerStays**表中停留的天数。

基本上，我需要它将所有这些信息与属于当前住在酒店的客户的 CustomerID 一起插入。

附加信息：

一些控件的名称：

日期输入 - DateInPicker

约会 - DateOutPicker

总天数 - TotalDayslbl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:39:57.007

首先，如果尚未设置，则需要将表`CustomerID`上的设置为，因此它的值会自动为您生成。`Customer``Autonumber`

然后，假设您的 Customer 表中没有并发插入，您可以在插入新客户的 ExecuteNonQuery 之后获取执行以下 OleDbCommand 的最后插入的自动编号，

```
 cmd.ExecuteNonQuery()
    cmd.CommandText = "SELECT @@IDENTITY"
    Dim result = Convert.ToInt32(cmd.ExecuteScalar()) 
```

那么该变量`result`应该在 Customer 表的 CustomerID 列中具有最后插入的值。

话虽如此，请接受建议以更改向数据库发出 sql 命令的方式。字符串连接确实是一种不好的做法，应该不惜一切代价避免。
举个例子，如果调用了 Customer，你的代码会发生什么`John O'Hara`？注意到单引号了吗？当您连接文本框中的字符串时，您的查询文本将导致错误的 sql 语句。但这只是语法错误，最糟糕的是[这里描述的 Sql Injection 场景](https://stackoverflow.com/questions/332365/how-does-the-sql-injection-from-the-bobby-tables-xkcd-comic-work)

这是一个如何编写插入查询的示例（但它适用于您需要使用`malicious`用户键入的文本的每个查询）

```
str = "INSERT INTO Customer (CustomerName, CustomerAddress, CustomerZip, CustomerTagNumber)" _
                    & " VALUES (?,?,?,?)"
cmd = New OleDbCommand(str, myconnection)
cmd.Parameters.AddWithValue("@p1", CustomerNametxt.Text)
cmd.Parameters.AddWithValue("@p2", CustomerAddresstxt.Text)
cmd.Parameters.AddWithValue("@p3", CustomerZipCodetxt.Text)
cmd.Parameters.AddWithValue("@p4", CustomerTagNumbertxt.Text)
cmd.ExecuteNonQuery() 
```

通过这种方式，单引号的问题由框架代码解决，这也避免了 Sql Injection 的混乱。

**编辑**
对于 CustomerStays 字段（日期时间），请改用此

```
 Dim str As String
        str = "INSERT INTO CustomerStays (CustomerID, CustomerDateIn, CustomerDateOut, TotalDays)" _
                        & " VALUES (?,?,?,?)"

        Dim cmd As OleDbCommand = New OleDbCommand(str, myconnection)
        cmd.Parameters.AddWithValue("@p1", result)
        cmd.Parameters.AddWithValue("@p2", Convert.ToDateTime(DateInPicker.Value)
        cmd.Parameters.AddWithValue("@p3", Convert.ToDateTime(DateOutPicker.Value)
        cmd.Parameters.AddWithValue("@p4", TotalDayslbl.Text)
        cmd.ExecuteNonQuery() 
```

如果 TotalDays 是数字 Convert.ToInt32(TotalDayslbl.Text) .....

# c++ - ShellExecute 是否有内存泄漏？

> ID：16173973
> 
> 赞同：0
> 
> 时间：2013-04-23T15:56:32.010
> 
> 标签：c++, memory-leaks, shellexecute

我正在学习 C++。当我打电话时`_run_file("otherapp.exe","")`，当前应用程序的内存增加了 1MB。这里有内存泄漏吗？如果有，如何解决？非常感谢！

```
void _run_file(LPSTR file, LPSTR params)
{
    ShellExecute(NULL,NULL,file,params,NULL,NULL);
} 
```

# sql-server - 选中另一个复选框时自动选择datagridview中的复选框

> ID：16173976
> 
> 赞同：1
> 
> 时间：2013-04-23T15:56:38.553
> 
> 标签：sql-server, vb.net, datagridview

一点帮助将不胜感激，我正在设计一个自行车租赁/预订程序，作为使用 MS Sql DB 的 VB 中当前项目的扩展。

我有一个数据网格视图，它显示了从我的数据库中提取的几行数据，我手动添加了另外两列，以便有几个复选框列。

这个想法是，如果有人使用第一个复选框列选择自行车，那么第二个复选框列（用于选择头盔）将自动被选中。如果该人不想要头盔，则用户可以取消选择该选项。这样一来，除非他们决定不戴头盔，否则用户将自动获得头盔，而不必选择戴头盔。

如何使第一个复选框的选择启用第二个复选框？当用户单击单元格时，我有一个事件处理程序：

```
 Private Sub dgvBikeAvailability_CellContentClick(sender As System.Object, e As System.Windows.Forms.DataGridViewCellEventArgs) Handles dgvBikeAvailability.CellContentClick
    drBikeAvailability = dvBikeAvailability(e.RowIndex).Row 

    'MsgBox to test data pass through
    MsgBox(drBikeAvailability("bikeName")) 

End Sub 
```

我一直在尝试访问已添加到 datagridview 的额外列，但由于它们不存在于数据表中，因此我无法在偶数处理程序中这样做。

非常感谢任何想法和建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:29:52.463

假设第一个复选框位于列索引 0 处，第二个位于索引 2 处（我认为您可以将索引替换为列名）。您需要自己处理复选框的值，因为该事件似乎禁用了正常的点击行为。

```
Private Sub dgvBikeAvailability_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgvBikeAvailability.CellContentClick
    If e.ColumnIndex = 0 Then
        dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value = Not dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value
        dgvBikeAvailability.Rows(e.RowIndex).Cells(2).Value = dgvBikeAvailability.Rows(e.RowIndex).Cells(0).Value
    End If
End Sub 
```

让我知道它是否有效。

# prolog - Prolog，查询错误语句时出错

> ID：16173977
> 
> 赞同：0
> 
> 时间：2013-04-23T15:56:42.273
> 
> 标签：prolog, dcg

```
input :-
read_line_to_codes(user_input, Input),
string_to_atom(Input,Atoms),
atomic_list_concat(Alist, ' ', Atoms),
phrase(sentence(S), Alist),
action(S).

statement(Rule) --> [Noun, 'is', 'a', Object], { Rule =.. [Object, Noun]}.
statement1(Rule) --> ['A', Noun, 'is', 'a', Object], { Rule =.. [Object, Noun]}.
query(Fact) --> ['Is', Noun, 'a', Object], { Fact =.. [Object, Noun]}.

sentence(statement(S)) --> statement(S).
sentence(statement1(S))--> statement1(S).
sentence(query(Q)) --> query(Q).

action(statement(S)) :- asserta(S) -> write(ok).
action(statement1(S)) :- asserta(S) -> write(ok).
action(query(Q)) :-( Q -> write(yes); write(unknown)), nl. 
```

任务是根据用户输入以“_ 是 _”的形式创建规则。或“一个_是一个_。” 这应该以“ok”响应。

然后能够查询“Is _ a _？” 并回答“是”或“未知”。我不知道为什么如果谓词（我认为这就是所谓的“火腿”）不在数据库中，它为什么会出错，但如果另一部分不在数据库中就可以了。关于我做错了什么的任何想法？对不起，如果我第一次用序言做一些愚蠢的事情。如果这很重要，我正在使用 SWI-Prolog V.6.2.6。我将如何在输出中省略 true 或 false 回报

```
 11 ?- input.
   |: john is a dog
   ok
   true .

   12 ?- input.
   |: Is john a dog
   yes
   true.

   13 ?- input.
   |: Is abraham a dog
   unknown
   false.

   14 ?- input.
   |: Is john a ham
   ERROR: action/1: Undefined procedure: ham/1
   Exception: (8) ham(john) ? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:48:06.293

首先，Prolog 响应的实际上是一个实现细节。SWI 响应“true”，但其他一些实现响应“ok”。因此，只要您在应该得到肯定和否定时，您的代码就没有什么可以改变的。

其次，您的狗和火腿示例之间存在差异。处理完样本输入后查看数据库：

```
?- listing.
⋮ 
:- dynamic dog/1.

dog(john).
⋮ 
```

在哪里`ham/1`？无处。当你 时`asserta(dog(john))`，Prolog 会意识到 that`dog/1`是一个谓词，但这从未发生在`ham/1`. 因此，您必须确定该查询是否格式正确，在这种情况下您要捕获异常，或者使用 预先声明所有可能的谓词`dynamic/1`，或者对它的格式不正确感到高兴。您的使用场景将确定哪个是合适的。例如，您可以这样做：

```
?- [user].
|: :- dynamic ham/1.
|: % user://2 compiled 0.00 sec, 1 clauses
true.

?- input.
|: Is john a ham
false. 
```

我怀疑你会想要对所有事情都这样做，所以你可能想看看 SWI-Prolog 的[catch facility](http://www.swi-prolog.org/pldoc/man?predicate=catch/3)。有关如何处理它的示例，请参阅此答案底部的编辑。

此外，我可能会稍微修改 DCG 以使其更通用和更简单：

```
article --> [a].
article --> [the].
article --> [].

noun(Noun) --> article, [Noun].

statement(Rule) --> noun(Noun), [is], noun(Object), { Rule =.. [Object, Noun] }.
query(Fact) --> ['Is'], noun(Noun), noun(Object), { Fact =.. [Object, Noun]}.

sentence(statement(S)) --> statement(S).
sentence(query(Q)) --> query(Q).

action(statement(S)) :- asserta(S).
action(query(Q)) :- Q. 
```

此外，没有真正需要制作`statement1`. 您可以拥有一个包含多个实体的 DCG 规则；即使您确实需要两个主体，也可以让它们都生成`statement/1`匹配的结构`action/1`；您当然不需要将`statement1/1`那么远的内容传播到其余代码中。

最后一句话，你不需要引用小写的原子。:)

总的来说，我认为你在这里做得很好！这东西很难学，网上的资料也很少。我希望你坚持下去，你可能已经开始看到你可以用 Prolog 和 DCG 做的很酷的事情了！

**编辑**：您可以通过将最后一个`action/1`子句替换为以下内容来捕获错误并正确处理它：

```
action(query(Q)) :- 
    catch((Q -> write(yes) ; write(unknown)), 
          error(existence_error(procedure, _), _), 
          write(unknown)), 
    nl. 
```

# ruby-on-rails - 自定义验证器不会在 Ruby on Rails 中加载

> ID：16173978
> 
> 赞同：5
> 
> 时间：2013-04-23T15:56:44.433
> 
> 标签：ruby-on-rails, validation, model

我正在尝试将自定义验证器应用于我的模型 issue.rb：

```
class Issue < ActiveRecord::Base
  attr_accessible :description, :no_followers, :title
  validates_presence_of :title
  validates_uniqueness_of :title, message: "Title should be unique!"

  validates_length_of :description, minimum: 10, maximum: 50
  validates_numericality_of :no_followers, allow_blank: true

  validates_with YesNoValidator

end 
```

验证器是一个位于 app/validators 的文件，包含以下内容：

```
class YesNoValidator < ActiveModel::Validator
    def validate record
        if record.title.include? "yes" && record.description.include? "No"
            record.errors[:title] << "Title has the word yes and description has the word no"
        end 
    end
end 
```

我也尝试将它放在 lib 文件夹中，但这也给出了这个错误：

```
Routing Error

uninitialized constant Issue::YesNoValidator 
```

随机 F5'ing 我有时会收到此错误：

```
NoMethodError in IssuesController#new

undefined method `key?' for nil:NilClass 
```

因此，似乎未加载具有该类的文件，因此我尝试将 lib 以及 app/validators 文件夹添加到 application.rb 中的 autoload_paths 中。但这也不起作用..

有谁之前经历过这个吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T16:05:11.963

在您的 application.rb 中，将 app/validators 路径添加到自动加载路径

```
config.autoload_paths += [Rails.root.join('app', 'validators').to_s] 
```

或手动要求 Issue.rb 文件中的验证器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-09T22:37:18.933

如果您还没有，请尝试重新启动 Rails 服务器，以便您在 application.rb 中的更改可能会被考虑在内。

# objective-c - CFUUIDCreate 是否均匀分布在它的所有位上？

> ID：16173980
> 
> 赞同：0
> 
> 时间：2013-04-23T15:56:56.653
> 
> 标签：objective-c, core-foundation

如果有人知道从 CFUUIDCreate... 返回的 ID 是否均匀分布在其所有位上，我很感兴趣。更具体地说：如果您从中截断一些位，它仍然会均匀分布吗？

例如，我要求它知道它是否可以用作散列函数，以及如果我去掉它的一些位，它将有多少冲突。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:07:26.550

它高度依赖于生成的 UUID 的版本，从文档看来 Apple 使用的是[版本 1 （您可以在](http://en.wikipedia.org/wiki/Uuid#Version_1_.28MAC_address.29)[opensource.apple.com](http://opensource.apple.com)查看实际实现，它应该在 Core Foundation 框架中）。版本 1（和 2）没有均匀分布的位，因此当您开始切割它的位时，您将失去唯一性。您可以做的是使用 SHA256 或类似具有均匀分布位的东西对 UUID 进行散列。

编辑：我刚刚从最新的 Core Foundation 版本（撰写本文时为 744.18）检查了[CFUUID.c](http://www.opensource.apple.com/source/CF/CF-744.18/CFUUID.c)`CFUUIDRef CFUUIDCreate(CFAllocatorRef alloc)` ，并且似乎[`uuid_generate_random`](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/uuid_generate_random.3.html)在所有情况下都在使用（有一个分支检查名为的布尔值`useV1UUIDs`，它始终为假）。根据手册页，`uuid_generate_random`将使用`/dev/urandom/`创建 UUID，这将使生成的 UUID 均匀分布的位。不确定我是否会指望它总是随机的，但未来的实现可能会发生变化。

# magento - 为可配置产品显示标签“库存不足”

> ID：16173982
> 
> 赞同：0
> 
> 时间：2013-04-23T15:57:05.390
> 
> 标签：magento, magento-1.7, magento-1.6

大家好，我使用的版本是 Magento 1.7.0.2，

我想为可配置产品创建一个标签，当总数量低于 5 时会显示该标签。标签将是“库存不足”，并将出现在图像的类别页面上，就像在本示例中一样。

现在我正在使用扩展 EM 产品标签，但这仅适用于简单产品，因为简单产品只有一种类型的库存数量。

您可以在此链接上找到示例：

[http://i.stack.imgur.com/fELmf.png](http://i.stack.imgur.com/fELmf.png)

基本上我需要：当可配置产品的数量低于 5 个显示标签时：）

# javascript - 无法拉取对象Javascript

> ID：16173984
> 
> 赞同：0
> 
> 时间：2013-04-23T15:57:06.970
> 
> 标签：javascript, jquery

对 JS 来说很新，我读过的关于对象的所有内容都没有解释如何将对象拉出来，例如，这里有一个简单的例子：

```
$('#ABtn').click({
    function(){
        runAlert({
            message: "hello world"
        });
    }
});

function runAlert(parameters){
    alert(parameters.message);
} 
```

当它运行“runAlert()”时，如何将对象“消息”作为变量提取并使用它来显示“hello world”的警报？我已经用谷歌搜索并阅读了，但我似乎无法理解它。我做了一个小提琴，如果有人能告诉我怎么做，这样我就可以理解了，那就太棒了：http: [//jsfiddle.net/WEZ9V/4/](http://jsfiddle.net/WEZ9V/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:01:36.613

你有一个语法错误，你在应该使用括号的地方使用大括号。

```
 $('#ABtn').click( //use parens here
    function(){

        runAlert({
            message: "hello"
        });
    }
); // and here

function runAlert(parameters){
    alert(parameters.message);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:02:53.737

首先，您指定单击功能的语法错误。它必须是形式

```
$('#ABtn').click(function(){
    your code
}); 
```

这使您更容易看到您做错了什么。你需要的是

```
$('#ABtn').click(function(){
    runAlert({message:"hello"});
});
function runAlert(parameters){
    alert(parameters.message);
} 
```

这是小提琴：http: [//jsfiddle.net/uq8Vt/1/](http://jsfiddle.net/uq8Vt/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T16:00:12.773

你所做的很好，你只是有一个语法错误：

```
$('#ABtn').click(function(){
        runAlert({
            message: "hello world"
        });
    }
);

function runAlert(parameters){
    alert(parameters.message);
} 
```

***现场演示：http:** [//jsfiddle.net/rt3J2/](http://jsfiddle.net/rt3J2/)*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T16:00:46.790

你有一个语法错误：

```
$('#ABtn').click({
    //           ^--------this { should not be there.
    function(){
        runAlert({
            message: "hello world"
        });
    });

function runAlert(parameters){
    alert(parameters.message);
} 
```

一旦删除，它就可以正常工作：[JS Fiddle demo](http://jsfiddle.net/WEZ9V/5/)。

顺便说一句，如果您查看了浏览器的 JavaScript 或错误控制台（`F12`在大多数浏览器中），错误“未捕获的语法错误：意外令牌（”会引起您对这种情况的注意。尤其是在 JS Fiddle 中，单击`JS Hint`按钮将突出显示它认为错误所在的行（始终检查第*一个*错误之前的行）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-23T16:01:17.080

您的源代码中有错误（在对脚本进行故障排除时**始终检查 JavaScript 控制台是否有错误**`click`！）是一个函数，因此您应该使用括号，而不是花括号：

```
$('#ABtn').click(
    function(){
        runAlert({
            message: "hello world"
        });
    }
); 
```

# html - 确定重叠元素顺序

> ID：16173988
> 
> 赞同：0
> 
> 时间：2013-04-23T15:57:19.920
> 
> 标签：html, gwt, dom, drag-and-drop, z-index

我正在使用 gwt 和 gwt-dnd（一个很棒的拖放库）。

我有一个与另一个重叠的 dropTarget （一个 div），并且库选择了下面的一个用于放置操作。原因是选择是按照以下标准完成的：

> 确定哪个 DropController 代表位于所提供位置的最深 DOM 后代放置目标`(x, y)`。

这适用于下降 DropTargets，但不适用于这样的层次结构：

```
<body>
    <div id="a">
        <div id="b">
            <div id="c">
                <div id="DropTarget_D"></div>
            </div>
        </div>
    </div>
    <div id="1" style="position:absolute; z-index: 1; top:0; left:0">
         <div id="DropTarget_2"></div>
    </div>
</body> 
```

演示：http: [//jsfiddle.net/rxwMB/](http://jsfiddle.net/rxwMB/)

正如您从代码中看到的（在帖子末尾），在这种情况下使用 DropTarget_C（因为它是“最深的”），即使 DropTarget_2 显示在上面。

**给定两个组件，我怎么知道哪一个是最上面的？**

这是做出选择的代码：

```
private int compareElement(Element myElement, Element otherElement) {
  if (myElement == otherElement) {
    return 0;
  } else if (DOM.isOrHasChild(myElement, otherElement)) {
    return -1;
  } else if (DOM.isOrHasChild(otherElement, myElement)) {
    return 1;
  } else {
    // check parent ensuring global candidate sorting is correct
    Element myParentElement = myElement.getParentElement().cast();
    Element otherParentElement = otherElement.getParentElement().cast();
    if (myParentElement != null && otherParentElement != null) {
      return compareElement(myParentElement, otherParentElement);
    }
    return 0;
  }
} 
```

dropTarget 是从使用此函数排序的有序列表中挑选的。如果列表只包含 DropTarget_D 和 DropTarget_2 并且都满足条件，则选择第一个（即使它被 DropTarget_2 覆盖）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T12:44:16.367

Here's my solution:

(for gwt-dnd : [https://code.google.com/p/gwt-dnd/issues/detail?id=169](https://code.google.com/p/gwt-dnd/issues/detail?id=169) )

```
package com.allen_sauer.gwt.dnd.client;

import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.LinkedList;
import java.util.ListIterator;
import java.util.Queue;
import java.util.logging.Level;
import java.util.logging.Logger;

import com.allen_sauer.gwt.dnd.client.DropControllerCollection.Candidate;
import com.google.gwt.dom.client.Element;
import com.google.gwt.user.client.ui.RootPanel;

public class OverlappingDropTargetsHandler {

    private static class StackingContext{
        private Element element;
        private LinkedList<Object> childrens;

        public StackingContext(Element element) {
            if(element == null){
                throw new RuntimeException();
            }
            this.element = element;
            this.childrens = new LinkedList<Object>();
        }

        public Element getElement() {
            return element;
        }

        public void addChildren(Candidate candidate) {
            this.childrens.add(candidate);
        }

        public void addChildren(StackingContext stackingContext) {
            this.childrens.add(stackingContext);            
        }

        public LinkedList<Object> getChildrens() {
            return this.childrens;
        }

        public int getZIndex(){
            return this.element.getPropertyInt("z-index");
        }

        @Override
        public int hashCode() {
            return element.hashCode();
        }

        @Override
        public boolean equals(Object obj) {
            if(obj instanceof StackingContext){
                return this.element.equals(((StackingContext)obj).element);
            }else{
                return false;
            }
        }
    }

    public static void sort(Candidate[] candidates) {       
        HashMap<Element, OverlappingDropTargetsHandler.StackingContext> cache = new HashMap<Element, OverlappingDropTargetsHandler.StackingContext>();

        initStackingContextsList(candidates, cache);

        StackingContext rootStackingContext = resolveStackingContextsHierarcy(cache);

        cache = null; //non mi serve piu

        assert rootStackingContext != null;

        Comparator<Object> comparator = new Comparator<Object>() {
            @Override
            public int compare(Object a, Object b) {
                assert a instanceof StackingContext || a instanceof Candidate;
                assert b instanceof StackingContext || b instanceof Candidate;

                boolean aInstanceOfStackingContext = a instanceof StackingContext;
                boolean bInstanceOfStackingContext = b instanceof StackingContext;

                if(aInstanceOfStackingContext && bInstanceOfStackingContext){
                    int ai = ((StackingContext)a).getZIndex();
                    int bi = ((StackingContext)b).getZIndex();
                    if(ai<bi){  return -1;
                    }else if(ai>bi){  return 1;
                    }else{  return 0;}
                }else if(aInstanceOfStackingContext && !bInstanceOfStackingContext){
                    return ((StackingContext)a).getZIndex()<0? -1: 1;
                }else if(!aInstanceOfStackingContext && bInstanceOfStackingContext){
                    return ((StackingContext)b).getZIndex()<0? 1: -1;
                }else /* if(!aInstanceOfStackingContext && !bInstanceOfStackingContext) */{
                    return ((Candidate)a).compareTo((Candidate)b);
                }
            }           
        };

        Queue<Object> queue = new LinkedList<Object>();
        queue.add(rootStackingContext);
        Object o;
        int i = 0;
        while((o = queue.poll()) != null){
            if(o instanceof StackingContext){
                Collections.sort(((StackingContext)o).getChildrens(), comparator);
                //reverse iterator
                ListIterator<Object> it = ((StackingContext)o).getChildrens().listIterator(((StackingContext)o).getChildrens().size());
                while(it.hasPrevious()){
                    queue.offer(it.previous());
                }
            }else /* if(o instanceof Candidate) */{
                candidates[i++] = (Candidate)o;
            }
        }

//      if(DOMUtil.DEBUG == true){
//          printTree(rootStackingContext, 0);      
//          printArray(candidates);
//      }
    }

    private static void initStackingContextsList(Candidate[] candidates, HashMap<Element, OverlappingDropTargetsHandler.StackingContext> cache){
        for(Candidate candidate : candidates) {
            Element stackingContextElement = findNearestStackingContextParentElement(candidate.getDropTarget().getElement());
            if(stackingContextElement != null){
                StackingContext stackingContext = cache.get(stackingContextElement);
                if(stackingContext == null){
                    stackingContext = new StackingContext(stackingContextElement);
                    cache.put(stackingContextElement, stackingContext);
                }
                stackingContext.addChildren(candidate);
            }
        }
    }

    /**
     * 
     * @param cache
     * @return the root StackingContext
     */
    private static StackingContext resolveStackingContextsHierarcy(HashMap<Element, OverlappingDropTargetsHandler.StackingContext> cache) {
        Queue<StackingContext> queue = new LinkedList<OverlappingDropTargetsHandler.StackingContext>(cache.values());

        StackingContext stackingContext;
        StackingContext rootStackingContext = null;
        while((stackingContext = queue.poll()) != null){
            Element parentElement = findNearestStackingContextParentElement(stackingContext.getElement());
            if(parentElement != null){
                StackingContext parentStackingContext = cache.get(parentElement);
                if(parentStackingContext == null){
                    parentStackingContext = new StackingContext(parentElement);
                    cache.put(parentElement, parentStackingContext);
                    queue.offer(parentStackingContext);
                }
                parentStackingContext.addChildren(stackingContext);
            }else{
                //this stackingContext is the root
                assert rootStackingContext == null || rootStackingContext == stackingContext;
                rootStackingContext = stackingContext;
            }
        }

        return rootStackingContext;
    }

    /**
     * @param element
     * @return the first parent that create a StackingContext or null if element is the root
     */
    private static Element findNearestStackingContextParentElement(Element element) {
        assert element != null;
        Element parentElement = element;
        while((parentElement = parentElement.getParentElement()) != null){
//          if(DOMUtil.DEBUG == true){
//              parentElement.getStyle().setProperty("border", "2px solid " + "orange");
//          }
            if(isStackingContext(parentElement)){
                return parentElement;
            }
//          if(DOMUtil.DEBUG == true){
//              parentElement.getStyle().setProperty("border", "2px solid " + "white");
//          }
        }
        return null;
    }

    private static native String getComputedProperty(Element e, String property)  /*-{
        return window.getComputedStyle(e).getPropertyValue(property);
     }-*/;  

    private static boolean isStackingContext(Element element) {
        String position = getComputedProperty(element, "position");
        String zindex = getComputedProperty(element, "z-index");

         if((!position.equals("static")) && (!zindex.equals("") && !zindex.equals("0"))){
            return true;
        }else if(RootPanel.get().getElement() == element){
            return true;
        }else{
            return false;
        }
        //TODO: gestire gli altri casi in cui viene creata un stacking context:

//      The root element always holds a root stacking context.
//
//      Setting z-index to anything other than 1 on an element that is positioned (i.e. an element with position that isn't static).
//
//      Note that this behavior is slated to be changed for elements with position: fixed such that they will always establish stacking contexts regardless of their z-index value. Some browsers have begun to adopt this behavior, however the change has not been reflected in either CSS2.1 or the new CSS Positioned Layout Module yet, so it may not be wise to rely on this behavior for now.
//
//      This change in behavior is explored in another answer of mine, which in turn links to this article and this set of CSSWG telecon minutes.
//
//      Another exception to this is with a flex item. Setting z-index on a flex item will always cause it to establish a stacking context even if it isn't positioned.
//
//      Setting opacity to anything less than 1.
//
//      Transforming the element:
//
//      Setting transform to anything other than none.
//
//      Setting transform-style to preserve-3d.
//
//      Setting perspective to anything other than none.
//
//      Creating a CSS region: setting flow-from to anything other than none on an element whose content is anything other than normal.
//
//      In paged media, each page-margin box establishes its own stacking context.
    }

    private static void printTree(StackingContext stackingContext, int level){  

        String s = "";
        for(int i = 0; i < level; i++) {
            s += "_";
        }

        for(Object o : stackingContext.getChildrens()){
            if(o instanceof StackingContext){
                Logger.getLogger("test").log(Level.WARNING, s + "(s) "+((StackingContext)o).getElement().getClassName()+" z-index="+ ((StackingContext)o).getZIndex());
                printTree((StackingContext)o, level+1);
            }else /* if(o instanceof Candidate) */{
                Logger.getLogger("test").log(Level.WARNING, s + "(c) "+((Candidate)o).getDropTarget().getElement().getClassName());
            }
        }
    }

    private static void printArray(Candidate[] candidates) {
        String s = "[";
        for(int i = 0; i < candidates.length; i++) {
            s+=candidates[i].getDropTarget().getElement().getNodeName();
            if(i < candidates.length-1){
                s += ", ";
            }
        }
        Logger.getLogger("test").log(Level.WARNING, s +"]");
    }
} 
```

# html - OpenLayers Hello World 示例不适用于 HTML5？

> ID：16173989
> 
> 赞同：2
> 
> 时间：2013-04-23T15:57:22.947
> 
> 标签：html, openlayers, openstreetmap

我正在尝试开始在我的网站上使用地图 API。我最初是在看openstreetmap，但很快意识到如果我想显示地图，我需要使用openlayers。我对这两者之间的关系仍然很模糊，所以我会标记它们。我只是想让一个 hello world 示例运行。

OpenLayers 有[这个页面](http://docs.openlayers.org/library/introduction.html)来引导你完成你的第一个实现。入门页面声明将以下代码用于您的第一个示例：

```
<html>
<head>
  <title>OpenLayers Example</title>
    <script src="http://openlayers.org/api/OpenLayers.js"></script>
    </head>
    <body>
      <div style="width:100%; height:100%" id="map"></div>
      <script defer="defer" type="text/javascript">
        var map = new OpenLayers.Map('map');
        var wms = new OpenLayers.Layer.WMS( "OpenLayers WMS",
            "http://vmap0.tiles.osgeo.org/wms/vmap0", {layers: 'basic'} );
        map.addLayer(wms);
        map.zoomToMaxExtent();
      </script>

</body>
</html> 
```

如果您将页面声明为 html5，则此代码不起作用。添加此标头后，示例将立即停止工作：

```
<!DOCTYPE html>
<meta charset='utf-8'> 
```

我不明白为什么会这样。该页面非常简单，不幸的是我对 html5 和 openlayers 了解不足，无法知道问题可能是什么，但已经缩小了问题的范围。谁能解释解决方案是什么以及为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T16:17:05.640

只需将其添加到该`<head>`部分：

```
<style>html, head, body { width: 100%; height: 100% }</style> 
```

问题是在标准模式下，元素默认只与它们包含的元素一样大。`<div>`宽度和高度为 100% 的结果是 100% 什么都没有；所以地图没有大小。确保备份到该`<html>`元素的所有元素都是其容器的 100% 意味着它们将实际填充显示，而不是没有大小。

请注意，从技术上讲，只有高度为 0；元素的宽度默认包含元素的宽度（以及顶级`<html>`元素的视口），而元素的高度取决于其子元素的高度。100% 的高度，当父母没有指定高度时，最终只会被视为高度`auto`，这意味着它基于其孩子的高度。由于它没有孩子，因此高度最终为 0。

如果您想了解更多详细信息，请查看[CSS 视觉格式模型](http://www.w3.org/TR/CSS2/visudet.html)规范。添加 HTML5 文档类型（或许多其他文档类型中的任何一种，尽管确切的列表因浏览器而异），使浏览器进入标准模式，在这种模式下，它们试图尽可能地遵循 CSS 规范。没有它，您将在怪癖模式下工作，其中各种浏览器实现各种非标准行为（主要基于旧浏览器，如 Netscape 4 或 IE 5.5 的工作方式）。[以下是](https://bugzilla.mozilla.org/show_bug.cgi?id=33443#c9)基于 Netscape 4 如何实现百分比高度在 quirks 模式下如何工作的描述。这是在各种浏览器上[以怪癖模式变化的各种行为的列表，这是](http://www.cs.tut.fi/~jkorpela/quirks-mode.html)[Mozilla 的怪癖模式在 Gecko 中如何变化的列表](https://developer.mozilla.org/en-US/docs/Mozilla_Quirks_Mode_Behavior)（Firefox 背后的引擎）。

# r - R：Gephi：操作数据框以与 write.gexf 一起使用

> ID：16173990
> 
> 赞同：2
> 
> 时间：2013-04-23T15:57:25.573
> 
> 标签：r, gephi

我正在尝试操作数据框。举个例子：假设我有一个包含客户和他们访问的商店的数据框：

```
df = data.frame(customers = c("a", "b", "b", "c", "c"),
                shop_visited = c("X", "X", "Y", "X", "Z"))
customers shop_visited
        a            X
        b            X
        b            Y
        c            X
        c            Z 
```

总结这个数据框：

*   一位顾客 ( ) 在和`b`购物；`X``Y`
*   一位顾客 ( ) 在和`b`购物；`Y``X`
*   一位顾客 ( ) 在和`c`购物；`X``Z`
*   一位顾客 ( `c`)`Z`在`X`

或者，更简洁地说：

```
relations = data.frame(source = c("X","Y", "X", "Z"), 
                       target = c("Y","X","Z","X"))
 source target
      X      Y
      Y      X
      X      Z
      Z      X 
```

我正在寻找一种能够进行转换的方法`df -> relations`。`relations`这背后的动机是我可以`edges`在`write.gexf`. 为任何帮助而欢呼。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T19:28:04.200

```
df <- data.frame(customers = c("a", "b", "b", "c", "c"),
                 shop_visited = c("X", "X", "Y", "X", "Z"))

#create an identifier df
dfnames <- data.frame(i = as.numeric(df$shop_visited), 
                      shop_visited = df$shop_visited)

library(tnet)
tdf       <- as.tnet( cbind(df[,2],df[,1]),type =  "binary two-mode tnet" )
relations <- projecting_tm(tdf, method = "sum")

# match original names
relations[["i"]] <- dfnames[ match(relations[['i']], dfnames[['i']] ) , 'shop_visited']
relations[["j"]] <- dfnames[ match(relations[['j']], dfnames[['i']] ) , 'shop_visited']

# clean up names
names(relations) <- c("source" , "target", "weight")

#> relations
#  source target weight
#1      X      Y      1
#2      X      Z      1
#3      Y      X      1
#4      Z      X      1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-06T18:16:27.830

请看一下（[http://www.inside-r.org/packages/cran/rgexf/docs/edge.list](http://www.inside-r.org/packages/cran/rgexf/docs/edge.list)）的功能`edge.list`。使用您的示例将是这样的`rgexf`

库（rgexf）

```
# Your data
df = data.frame(customers = c("a", "b", "b", "c", "c"),
                shop_visited = c("X", "X", "Y", "X", "Z"))

# Getting nodes and edges
df2 <- edge.list(df) 
```

看起来像这样

```
> df2
$nodes
  id label
1  1     1
2  2     2
3  3     3

$edges
     [,1] [,2]
[1,]    1    1
[2,]    2    1
[3,]    2    2
[4,]    3    1
[5,]    3    3 
```

最后，您可以使用它来编写 GEXF 图

```
# Building the graph
write.gexf(nodes=df2$nodes, edges=df2$edges)

<?xml version="1.0" encoding="UTF-8"?>
<gexf xmlns="http://www.gexf.net/1.2draft" xmlns:viz="http://www.gexf.net/1.1draft/viz" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd" version="1.2">
  <meta lastmodifieddate="2013-08-06">
    <creator>NodosChile</creator>
    <description>A graph file writing in R using "rgexf"</description>
    <keywords>gexf graph, NodosChile, R, rgexf</keywords>
  </meta>
  <graph mode="static">
    <nodes>
      <node id="1" label="1"/>
      <node id="2" label="2"/>
      <node id="3" label="3"/>
    </nodes>
    <edges>
      <edge id="0" source="1" target="1" weight="1.0"/>
      <edge id="1" source="2" target="1" weight="1.0"/>
      <edge id="2" source="2" target="2" weight="1.0"/>
      <edge id="3" source="3" target="1" weight="1.0"/>
      <edge id="4" source="3" target="3" weight="1.0"/>
    </edges>
  </graph>
</gexf> 
```

如果您对 nodoschile.org 上的 George dot vega 有任何疑问，请告诉我

最好的！

乔治（创造者`rgexf`）

# r - knitr/Rmd：n 行/n 距离后的分页符

> ID：16173995
> 
> 赞同：69
> 
> 时间：2013-04-23T15:57:40.953
> 
> 标签：r, knitr, r-markdown

***让我提醒一下，这可能更适合作为 html/css 问题，但是（a）我对这些技术不太熟悉，并且（b）如果可能的话，我想把它全部放在家庭（R 系列）中。***

我想使用 Rmarkdown`knitr`编写学术风格报告（**APA 6 类型指南）。**我已经解决了大多数方面，但没有分页。我可以手动设置分页符，例如：

```
# report

```{r setup, include=FALSE}
# set global chunk options
opts_chunk$set(cache=TRUE)
```
------
## Page 1

```{r plot1}
plot(1:10, 1:10)
```
------
## Page 2 
```

在下面的 .Rmd 中，我想在 n 行/n 距离之后以编程方式设置这些中断。因此，假设在 8 英寸或 140 行之后。

```
# report

```{r setup, include=FALSE}
# set global chunk options
opts_chunk$set(cache=TRUE)
```
Initial Text. Yay!

```{r plot1}
plot(1:10, 1:10)
```

More Text.  Outstanding.  What Hadley's not calling it plyr2?

```{r plot2, fig.width=4, fig.height=4}
plot(1:10, 1:10)
```

`r paste(rep("So much text so little time!", 10000))` 
```

如何在 n 距离后以编程方式设置分页符。这类似于如何`LaTeX`将文件分成页面，所以如果一个图形占用太多空间，它将被强制到下一页。

**编辑**从朋友那里找到这个：http: [//www.w3.org/TR/css3-page/](http://www.w3.org/TR/css3-page/) 可能会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-13T08:22:58.733

以编程方式。创建一个 HTML div。将此 div 的宽度和高度设置为固定量，并且溢出以滚动。

```
<div style="height:1000px; width: 500px; overflow-y: scroll;">
    ...
</div> 
```

将您的降价处理成 HTML 元素。我有 5 个`h1`标签，每个标签高 300 像素。

```
<h1 style="height:300px;">First</h1>
<h1 style="height:300px;">Second</h1>
<h1 style="height:300px;">Third</h1>
<h1 style="height:300px;">Fourth</h1>
<h1 style="height:300px;">Fifth</h1> 
```

这 5 个`h1`不会都放在同一页上。页面只有 1,000 像素高。`h1`此页面仅适合 3 个标签。我们需要在第三个元素之后插入分页符。

以增量方式将每个新项目添加到 DOM 中。插入每个项目后，检查浏览器的滚动条是否存在。如果是，那么我们知道我们刚刚插入的项目对于这个页面来说太大了；删除该项目并插入分页符。

前：

```
### First
### Second
### Third
### Fourth
### Fifth 
```

后：

```
### First
### Second
### Third
------
### Fourth
### Fifth 
```

这适用于任何元素，您不必担心项目的高度。因为，如果您刚刚插入的项目使 HTML div 滚动，那么我们需要一个分页符。图片、视频、h1、h2、p、自定义/动态 css，任何东西。

**更新**

您还可以计算每个 div 元素的高度。[http://api.jquery.com/height/](http://api.jquery.com/height/)这样重新计算一个 54 页的文档会容易得多。

# c# - 该进程无法访问该文件，因为它正被另一个进程使用：正确读取\写入文件的方法：大量使用的应用程序-第二部分

> ID：16173997
> 
> 赞同：1
> 
> 时间：2013-04-23T15:57:41.170
> 
> 标签：c#, asp.net, .net

我们有一个大量使用的 .Net 3.5 应用程序，它读取“创建成本高”的数据并将其缓存。但是，我们在读取缓存文件和写入缓存文件时遇到了很多错误。我从 StackOverflow 论坛得到的一些建议是：

*   一个。以“FileShare.Read”模式读取文件并以“FileShare.ReadWrite”模式写入文件。（系统在进行读\写操作时应该使用什么“文件访问”模式。）
*   湾。在每次读写操作后使用“GC.Collect”。（在每次读写操作后执行此操作对性能有何影响。）

这是读写文件的正确方法吗？请指教。

```
private XmlDocument ReadFromFile(string siteID, Type StuffType)
{
   XmlDocument result = null;
   var fsPath = FileSystemPath(siteID, StuffType.Name);
   result = new XmlDocument();
   using (var streamReader = new StreamReader(fsPath))
   //using (var fileStream = new FileStream(fsPath, FileMode.Open, FileAccess.Read, FileShare.Read))
   {
      result.Load(streamReader);
   }
   //GC.Collect();                
   return result;
}

private readonly object thisObject = new object();
private void WriteToFile(string siteID, XmlDocument stuff, string fileName)
{
   var fsPath = FileSystemPath(siteID, fileName);
   lock (thisObject)
   {
      //using (var fileStream = new FileStream(fsPath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
      using (var streamWriter = new StreamWriter(fsPath))
      {
         stuff.Save(streamWriter);
      }
      //GC.Collect();
    }
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T16:14:43.160

如果您想同步对资源的访问，有几个选项，具体取决于上下文。有几种（一般）情况：

1.  **单进程，单线程**

    无需同步。

2.  **单进程，多线程**

    使用简单的锁定机制，例如`lock`or [`ReaderWriterLockSlim`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)。

3.  **多工序，单机**

    使用 (命名) [`Mutex`](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)。互斥锁不是很快。更多关于底部的性能。

4.  **多进程，多台机器**

    现在它开始感兴趣了。.NET 对此没有现成的解决方案。我可以想到两个解决方案：

    *   try-again-method：创建一个带有 try-catch 的 while 循环。让他做try-scope中的资源操作。如果成功，则返回成功结果。如果失败，请等待几毫秒，然后再试一次……再试一次……再试一次。
    *   同步主机：使 web 服务在网络的中心位置运行。所有想要访问资源的进程首先必须向服务请求许可。如果资源被“锁定”，服务将等待，导致进程等待。一旦资源被释放，服务就会被通知并允许下一个进程访问该资源。

**在这种情况下**
，当然最后一个解决方案是通用解决方案。在 Ajit Goel 的情况下，它就像创建一个集中式服务来读/写文件一样简单。然后你有一个文件管理员可以控制 iets 文件。

另一种解决方案可能是将所有文件存储在中央数据库中，并让他进行所有同步。

**性能**
如果性能开始成为问题，您可以尝试创建缓存。

1.  您可以在内存中创建缓存（但有很多文件或大文件，这可能会成为内存问题）。
2.  您可以在本地文件夹中创建一个缓存（每个进程一个）。一旦修改了集中位置（只需验证日期），您就可以将该文件（使用互斥锁）复制到您自己的本地文件夹中。在那里，您可以一遍又一遍地读取文件，而无需锁定读取访问和读取共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T16:22:28.850

我认为[ReaderWriterLock](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)与 FileShare.ReadWrite 结合使用是您的解决方案。（请注意，我链接到您的文档页面将您引向一个更好的版本，称为[ReaderWriterLockSlim](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)，它至少应该一样好。）

您需要在每个线程上使用 FileShare.ReadWrite，因此他们都可以根据需要访问它。任何时候线程需要读取，都拥有它`AcquireReaderLock`（以及`ReleaseReaderLock`读取完成时）。

当你想写时，只需使用`UpgradeToWriterLock`，当你完成时，`DowngradeFromWriterLock`。

这应该让您的所有线程始终以只读方式访问文件，并让任何一个线程在必要时获取写入权限。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:08:35.500

我相信每个人都必须以 FileShare.ReadWrite 模式打开文件。

如果有人在 FileShare.Read 模式下打开它，而其他人试图写入它，它将失败。我认为它们不兼容，因为一个说“只读共享”，但另一个想写。您可能需要在所有这些上使用 FileShare.ReadWrite，或者尽量减少写入量以最大限度地减少冲突。

[http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)

另一种选择是使用 FileShare.Read，并在进行修改时复制文件。如果所有修改都有一个入口点，那么它可以使用 FileShare.Read 来复制文件。修改副本，然后更新某种指示当前文件路径的变量/属性。一旦更新，从文件中读取的所有其他进程都将使用该新位置。这将允许修改发生并完成，然后使所有读者都知道新修改的文​​件。同样，仅当您可以集中修改时才可行。如有必要，可能通过某种修改请求队列。